This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-09.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-01.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-18.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-19.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-27.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-23.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-25.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-26.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-09-17.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-03.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-02.csv
training model: results/XRAY/W7/deepLOB_L1/h10
Epoch 1/50
381/381 - 37s - loss: 3.2573 - accuracy10: 0.3976 - val_loss: 3.4526 - val_accuracy10: 0.3401 - 37s/epoch - 96ms/step
Epoch 2/50
381/381 - 8s - loss: 3.1924 - accuracy10: 0.4249 - val_loss: 3.4685 - val_accuracy10: 0.3336 - 8s/epoch - 22ms/step
Epoch 3/50
381/381 - 8s - loss: 3.1540 - accuracy10: 0.4442 - val_loss: 3.4913 - val_accuracy10: 0.3396 - 8s/epoch - 21ms/step
Epoch 4/50
381/381 - 8s - loss: 3.1396 - accuracy10: 0.4484 - val_loss: 3.4169 - val_accuracy10: 0.3691 - 8s/epoch - 20ms/step
Epoch 5/50
381/381 - 7s - loss: 3.1235 - accuracy10: 0.4565 - val_loss: 3.4352 - val_accuracy10: 0.3687 - 7s/epoch - 19ms/step
Epoch 6/50
381/381 - 7s - loss: 3.1071 - accuracy10: 0.4607 - val_loss: 3.3933 - val_accuracy10: 0.3731 - 7s/epoch - 20ms/step
Epoch 7/50
381/381 - 8s - loss: 3.0951 - accuracy10: 0.4645 - val_loss: 3.5479 - val_accuracy10: 0.3514 - 8s/epoch - 20ms/step
Epoch 8/50
381/381 - 7s - loss: 3.0845 - accuracy10: 0.4696 - val_loss: 3.4735 - val_accuracy10: 0.3530 - 7s/epoch - 19ms/step
Epoch 9/50
381/381 - 7s - loss: 3.0737 - accuracy10: 0.4733 - val_loss: 3.6320 - val_accuracy10: 0.3412 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.0688 - accuracy10: 0.4748 - val_loss: 3.4704 - val_accuracy10: 0.3493 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 7s - loss: 3.0611 - accuracy10: 0.4775 - val_loss: 3.4634 - val_accuracy10: 0.3455 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 7s - loss: 3.0532 - accuracy10: 0.4798 - val_loss: 3.3239 - val_accuracy10: 0.3732 - 7s/epoch - 18ms/step
Epoch 13/50
381/381 - 7s - loss: 3.0478 - accuracy10: 0.4831 - val_loss: 3.4583 - val_accuracy10: 0.3492 - 7s/epoch - 19ms/step
Epoch 14/50
381/381 - 7s - loss: 3.0395 - accuracy10: 0.4835 - val_loss: 3.3792 - val_accuracy10: 0.3608 - 7s/epoch - 19ms/step
Epoch 15/50
381/381 - 7s - loss: 3.0351 - accuracy10: 0.4859 - val_loss: 3.4945 - val_accuracy10: 0.3488 - 7s/epoch - 18ms/step
Epoch 16/50
381/381 - 7s - loss: 3.0265 - accuracy10: 0.4889 - val_loss: 3.3994 - val_accuracy10: 0.3595 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 7s - loss: 3.0193 - accuracy10: 0.4893 - val_loss: 3.3525 - val_accuracy10: 0.3742 - 7s/epoch - 19ms/step
Epoch 18/50
381/381 - 7s - loss: 3.0177 - accuracy10: 0.4883 - val_loss: 3.3657 - val_accuracy10: 0.3674 - 7s/epoch - 19ms/step
Epoch 19/50
381/381 - 7s - loss: 3.0132 - accuracy10: 0.4914 - val_loss: 3.3586 - val_accuracy10: 0.3684 - 7s/epoch - 18ms/step
Epoch 20/50
381/381 - 7s - loss: 3.0097 - accuracy10: 0.4906 - val_loss: 3.3747 - val_accuracy10: 0.3634 - 7s/epoch - 18ms/step
Epoch 21/50
381/381 - 7s - loss: 3.0017 - accuracy10: 0.4943 - val_loss: 3.4842 - val_accuracy10: 0.3493 - 7s/epoch - 18ms/step
Epoch 22/50
381/381 - 7s - loss: 2.9987 - accuracy10: 0.4948 - val_loss: 3.4213 - val_accuracy10: 0.3544 - 7s/epoch - 19ms/step
testing model: results/XRAY/W7/deepLOB_L1/h10
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1004574
{'0': {'precision': 0.3355639959004039, 'recall': 0.4787956989247312, 'f1-score': 0.39458386502197645, 'support': 69750}, '1': {'precision': 0.40824795549205, 'recall': 0.5600575551570255, 'f1-score': 0.47225250571478816, 'support': 95908}, '2': {'precision': 0.37936067727339073, 'recall': 0.03595390595819442, 'f1-score': 0.06568273143117087, 'support': 72287}, 'accuracy': 0.3770156969047469, 'macro avg': {'precision': 0.37439087622194817, 'recall': 0.3582690533466503, 'f1-score': 0.31083970072264516, 'support': 237945}, 'weighted avg': {'precision': 0.37816587407781754, 'recall': 0.3770156969047469, 'f1-score': 0.32597039446234133, 'support': 237945}}
[[33396 34806  1548]
 [39490 53714  2704]
 [26636 43052  2599]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0975142
{'0': {'precision': 0.3820387742338962, 'recall': 0.4859670336663909, 'f1-score': 0.4277811235136763, 'support': 31426}, '1': {'precision': 0.3735176733438998, 'recall': 0.5594965675057209, 'f1-score': 0.4479714177745714, 'support': 34960}, '2': {'precision': 0.4649546244448735, 'recall': 0.07734061345752369, 'f1-score': 0.13262102770281434, 'support': 31135}, 'accuracy': 0.3818664697859948, 'macro avg': {'precision': 0.4068370240075565, 'recall': 0.3742680715432118, 'f1-score': 0.33612452299702067, 'support': 97521}, 'weighted avg': {'precision': 0.4054561644288748, 'recall': 0.3818664697859948, 'f1-score': 0.34078491863769783, 'support': 97521}}
[[15272 14991  1163]
 [13792 19560  1608]
 [10911 17816  2408]]
Evaluating performance on  val set...
114/114 - 1s - 860ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.097022
{'0': {'precision': 0.40022815857020627, 'recall': 0.4315735520246028, 'f1-score': 0.4153102495807438, 'support': 9755}, '1': {'precision': 0.35313010978743287, 'recall': 0.6205233453052847, 'f1-score': 0.4501097919535524, 'support': 9745}, '2': {'precision': 0.4525801952580195, 'recall': 0.06776652396366294, 'f1-score': 0.11788211788211789, 'support': 9577}, 'accuracy': 0.37507308181724386, 'macro avg': {'precision': 0.40197948787188625, 'recall': 0.3732878070978501, 'f1-score': 0.32776738647213804, 'support': 29077}, 'weighted avg': {'precision': 0.4016865266952213, 'recall': 0.37507308181724386, 'f1-score': 0.32901016095899044, 'support': 29077}}
[[4210 5181  364]
 [3277 6047  421]
 [3032 5896  649]]
training model: results/XRAY/W7/deepLOB_L1/h20
Epoch 1/50
381/381 - 9s - loss: 3.2863 - accuracy20: 0.3863 - val_loss: 3.4485 - val_accuracy20: 0.3355 - 9s/epoch - 23ms/step
Epoch 2/50
381/381 - 7s - loss: 3.2262 - accuracy20: 0.4113 - val_loss: 3.4502 - val_accuracy20: 0.3446 - 7s/epoch - 17ms/step
Epoch 3/50
381/381 - 7s - loss: 3.1983 - accuracy20: 0.4271 - val_loss: 3.4918 - val_accuracy20: 0.3259 - 7s/epoch - 18ms/step
Epoch 4/50
381/381 - 7s - loss: 3.1802 - accuracy20: 0.4352 - val_loss: 3.4282 - val_accuracy20: 0.3331 - 7s/epoch - 17ms/step
Epoch 5/50
381/381 - 7s - loss: 3.1646 - accuracy20: 0.4392 - val_loss: 3.3641 - val_accuracy20: 0.3575 - 7s/epoch - 17ms/step
Epoch 6/50
381/381 - 6s - loss: 3.1497 - accuracy20: 0.4471 - val_loss: 3.4285 - val_accuracy20: 0.3456 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.1433 - accuracy20: 0.4492 - val_loss: 3.4602 - val_accuracy20: 0.3436 - 7s/epoch - 17ms/step
Epoch 8/50
381/381 - 6s - loss: 3.1353 - accuracy20: 0.4535 - val_loss: 3.4663 - val_accuracy20: 0.3389 - 6s/epoch - 17ms/step
Epoch 9/50
381/381 - 6s - loss: 3.1288 - accuracy20: 0.4557 - val_loss: 3.5142 - val_accuracy20: 0.3383 - 6s/epoch - 17ms/step
Epoch 10/50
381/381 - 6s - loss: 3.1256 - accuracy20: 0.4560 - val_loss: 3.3968 - val_accuracy20: 0.3478 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 7s - loss: 3.1194 - accuracy20: 0.4582 - val_loss: 3.3982 - val_accuracy20: 0.3512 - 7s/epoch - 17ms/step
Epoch 12/50
381/381 - 7s - loss: 3.1134 - accuracy20: 0.4602 - val_loss: 3.4801 - val_accuracy20: 0.3430 - 7s/epoch - 17ms/step
Epoch 13/50
381/381 - 7s - loss: 3.1109 - accuracy20: 0.4618 - val_loss: 3.4511 - val_accuracy20: 0.3354 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.1028 - accuracy20: 0.4648 - val_loss: 3.4739 - val_accuracy20: 0.3350 - 7s/epoch - 17ms/step
Epoch 15/50
381/381 - 6s - loss: 3.0984 - accuracy20: 0.4662 - val_loss: 3.4423 - val_accuracy20: 0.3385 - 6s/epoch - 17ms/step
testing model: results/XRAY/W7/deepLOB_L1/h20
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1153475
{'0': {'precision': 0.34491496383934206, 'recall': 0.52072754005963, 'f1-score': 0.4149674255615768, 'support': 73453}, '1': {'precision': 0.3903177130661687, 'recall': 0.5284371155430648, 'f1-score': 0.44899544473747305, 'support': 88599}, '2': {'precision': 0.36140845070422534, 'recall': 0.03381075988562845, 'f1-score': 0.0618365404311207, 'support': 75893}, 'accuracy': 0.36829519426758284, 'macro avg': {'precision': 0.3655470425365787, 'recall': 0.36099180516277446, 'f1-score': 0.3085998035767235, 'support': 237945}, 'weighted avg': {'precision': 0.3670813400077179, 'recall': 0.36829519426758284, 'f1-score': 0.3150060319864209, 'support': 237945}}
[[38249 33350  1854]
 [39100 46819  2680]
 [33545 39782  2566]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1087445
{'0': {'precision': 0.375966049562966, 'recall': 0.5920782366105644, 'f1-score': 0.45989903319521835, 'support': 32619}, '1': {'precision': 0.36242879403274836, 'recall': 0.43564234831736676, 'f1-score': 0.39567733389109666, 'support': 32568}, '2': {'precision': 0.4174161313347609, 'recall': 0.0904311251314406, 'f1-score': 0.14865654948015963, 'support': 32334}, 'accuracy': 0.373509295433804, 'macro avg': {'precision': 0.38527032497682506, 'recall': 0.3727172366864573, 'f1-score': 0.3347443055221582, 'support': 97521}, 'weighted avg': {'precision': 0.38518832585116125, 'recall': 0.373509295433804, 'f1-score': 0.3352562714169414, 'support': 97521}}
[[19313 11447  1859]
 [16158 14188  2222]
 [15898 13512  2924]]
Evaluating performance on  val set...
114/114 - 1s - 853ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1177441
{'0': {'precision': 0.37622012143570827, 'recall': 0.4947442894683647, 'f1-score': 0.4274175944117005, 'support': 9894}, '1': {'precision': 0.3364623843368647, 'recall': 0.5379502572898799, 'f1-score': 0.4139922448642851, 'support': 9328}, '2': {'precision': 0.4071180555555556, 'recall': 0.047590055809233894, 'f1-score': 0.08521849731988734, 'support': 9855}, 'accuracy': 0.35705196547099083, 'macro avg': {'precision': 0.37326685377604285, 'recall': 0.36009486752249287, 'f1-score': 0.3088761121986243, 'support': 29077}, 'weighted avg': {'precision': 0.37393786979671806, 'recall': 0.35705196547099083, 'f1-score': 0.3071299525498128, 'support': 29077}}
[[4895 4701  298]
 [3925 5018  385]
 [4191 5195  469]]
training model: results/XRAY/W7/deepLOB_L1/h30
Epoch 1/50
381/381 - 10s - loss: 3.3002 - accuracy30: 0.3783 - val_loss: 3.4046 - val_accuracy30: 0.3389 - 10s/epoch - 26ms/step
Epoch 2/50
381/381 - 7s - loss: 3.2470 - accuracy30: 0.4000 - val_loss: 3.4375 - val_accuracy30: 0.3181 - 7s/epoch - 18ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2278 - accuracy30: 0.4134 - val_loss: 3.4013 - val_accuracy30: 0.3557 - 7s/epoch - 17ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2120 - accuracy30: 0.4213 - val_loss: 3.2855 - val_accuracy30: 0.3794 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2039 - accuracy30: 0.4244 - val_loss: 3.3322 - val_accuracy30: 0.3621 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.1925 - accuracy30: 0.4303 - val_loss: 3.3768 - val_accuracy30: 0.3325 - 7s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.1851 - accuracy30: 0.4333 - val_loss: 3.3613 - val_accuracy30: 0.3386 - 7s/epoch - 17ms/step
Epoch 8/50
381/381 - 6s - loss: 3.1803 - accuracy30: 0.4341 - val_loss: 3.4159 - val_accuracy30: 0.3306 - 6s/epoch - 17ms/step
Epoch 9/50
381/381 - 6s - loss: 3.1748 - accuracy30: 0.4360 - val_loss: 3.4610 - val_accuracy30: 0.3254 - 6s/epoch - 16ms/step
Epoch 10/50
381/381 - 6s - loss: 3.1698 - accuracy30: 0.4405 - val_loss: 3.3264 - val_accuracy30: 0.3433 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 7s - loss: 3.1650 - accuracy30: 0.4427 - val_loss: 3.3844 - val_accuracy30: 0.3366 - 7s/epoch - 17ms/step
Epoch 12/50
381/381 - 7s - loss: 3.1602 - accuracy30: 0.4420 - val_loss: 3.3221 - val_accuracy30: 0.3516 - 7s/epoch - 18ms/step
Epoch 13/50
381/381 - 7s - loss: 3.1561 - accuracy30: 0.4442 - val_loss: 3.3666 - val_accuracy30: 0.3303 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.1518 - accuracy30: 0.4452 - val_loss: 3.3718 - val_accuracy30: 0.3471 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepLOB_L1/h30
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0976816
{'0': {'precision': 0.36314081160410616, 'recall': 0.3101810705047423, 'f1-score': 0.33457818223443225, 'support': 75385}, '1': {'precision': 0.3729143849843272, 'recall': 0.5850594871308716, 'f1-score': 0.45549697162600383, 'support': 84388}, '2': {'precision': 0.4293350178575767, 'recall': 0.22605280663153046, 'f1-score': 0.29616780216372945, 'support': 78172}, 'accuracy': 0.38002899829792597, 'macro avg': {'precision': 0.38846340481533675, 'recall': 0.3737644547557148, 'f1-score': 0.3620809853413885, 'support': 237945}, 'weighted avg': {'precision': 0.38835380537012937, 'recall': 0.38002899829792597, 'f1-score': 0.3648434896302126, 'support': 237945}}
[[23383 41427 10575]
 [22103 49372 12913]
 [18905 41596 17671]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1034328
{'0': {'precision': 0.38305998651988316, 'recall': 0.41384750750932975, 'f1-score': 0.39785902839558385, 'support': 32959}, '1': {'precision': 0.3471954510408635, 'recall': 0.4542445544242348, 'f1-score': 0.39357067748234936, 'support': 31723}, '2': {'precision': 0.4220196971924151, 'recall': 0.26227960656536436, 'f1-score': 0.3235051081730769, 'support': 32839}, 'accuracy': 0.3759497954286769, 'macro avg': {'precision': 0.3840917115843872, 'recall': 0.37679055616630963, 'f1-score': 0.3716449380170033, 'support': 97521}, 'weighted avg': {'precision': 0.3845126713751896, 'recall': 0.3759497954286769, 'f1-score': 0.3714262832206221, 'support': 97521}}
[[13640 13620  5699]
 [11216 14410  6097]
 [10752 13474  8613]]
Evaluating performance on  val set...
114/114 - 1s - 819ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0980469
{'0': {'precision': 0.3815081608461749, 'recall': 0.42134944612286, 'f1-score': 0.4004402545819974, 'support': 9930}, '1': {'precision': 0.33384615384615385, 'recall': 0.4059198943661972, 'f1-score': 0.36637203297248977, 'support': 9088}, '2': {'precision': 0.4330028328611898, 'recall': 0.3039069490008947, 'f1-score': 0.35714702961621597, 'support': 10059}, 'accuracy': 0.375898476459057, 'macro avg': {'precision': 0.3827857158511729, 'recall': 0.3770587631633173, 'f1-score': 0.37465310572356775, 'support': 29077}, 'weighted avg': {'precision': 0.38442567593311106, 'recall': 0.375898476459057, 'f1-score': 0.37481524003723693, 'support': 29077}}
[[4184 3835 1911]
 [3307 3689 2092]
 [3476 3526 3057]]
training model: results/XRAY/W7/deepLOB_L1/h50
Epoch 1/50
381/381 - 9s - loss: 3.3197 - accuracy50: 0.3670 - val_loss: 3.6249 - val_accuracy50: 0.3325 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 6s - loss: 3.2768 - accuracy50: 0.3841 - val_loss: 3.3381 - val_accuracy50: 0.3412 - 6s/epoch - 17ms/step
Epoch 3/50
381/381 - 6s - loss: 3.2547 - accuracy50: 0.3927 - val_loss: 3.3244 - val_accuracy50: 0.3563 - 6s/epoch - 17ms/step
Epoch 4/50
381/381 - 6s - loss: 3.2464 - accuracy50: 0.3983 - val_loss: 3.3922 - val_accuracy50: 0.3502 - 6s/epoch - 17ms/step
Epoch 5/50
381/381 - 6s - loss: 3.2382 - accuracy50: 0.4018 - val_loss: 3.3560 - val_accuracy50: 0.3469 - 6s/epoch - 17ms/step
Epoch 6/50
381/381 - 6s - loss: 3.2375 - accuracy50: 0.4007 - val_loss: 3.3581 - val_accuracy50: 0.3562 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2296 - accuracy50: 0.4045 - val_loss: 3.3393 - val_accuracy50: 0.3569 - 7s/epoch - 17ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2214 - accuracy50: 0.4107 - val_loss: 3.3515 - val_accuracy50: 0.3566 - 7s/epoch - 17ms/step
Epoch 9/50
381/381 - 6s - loss: 3.2163 - accuracy50: 0.4137 - val_loss: 3.3649 - val_accuracy50: 0.3542 - 6s/epoch - 17ms/step
Epoch 10/50
381/381 - 6s - loss: 3.2101 - accuracy50: 0.4149 - val_loss: 3.4079 - val_accuracy50: 0.3464 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2056 - accuracy50: 0.4162 - val_loss: 3.4236 - val_accuracy50: 0.3447 - 7s/epoch - 17ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2046 - accuracy50: 0.4173 - val_loss: 3.4469 - val_accuracy50: 0.3455 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2025 - accuracy50: 0.4191 - val_loss: 3.4457 - val_accuracy50: 0.3428 - 6s/epoch - 17ms/step
testing model: results/XRAY/W7/deepLOB_L1/h50
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1159809
{'0': {'precision': 0.3222386705505945, 'recall': 0.6561466870398667, 'f1-score': 0.4322138193863032, 'support': 71990}, '1': {'precision': 0.4023372287145242, 'recall': 0.19941086913351427, 'f1-score': 0.2666578149549669, 'support': 90642}, '2': {'precision': 0.34550858225830766, 'recall': 0.2130176729117151, 'f1-score': 0.26354869975194256, 'support': 75313}, 'accuracy': 0.3419025405030574, 'macro avg': {'precision': 0.3566948271744755, 'recall': 0.35619174302836537, 'f1-score': 0.3208067780310709, 'support': 237945}, 'weighted avg': {'precision': 0.3601164169606385, 'recall': 0.3419025405030574, 'f1-score': 0.3157625238823515, 'support': 237945}}
[[47236 12178 12576]
 [54753 18075 17814]
 [44598 14672 16043]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108861
{'0': {'precision': 0.34944363268517475, 'recall': 0.6727564994281121, 'f1-score': 0.4599695650336053, 'support': 32349}, '1': {'precision': 0.3779874647014257, 'recall': 0.16902796599728964, 'f1-score': 0.23359652669887415, 'support': 32468}, '2': {'precision': 0.3766829127056893, 'recall': 0.23868639921722112, 'f1-score': 0.29221180302094446, 'support': 32704}, 'accuracy': 0.3594815475641144, 'macro avg': {'precision': 0.3680380033640966, 'recall': 0.3601569548808743, 'f1-score': 0.32859263158447466, 'support': 97521}, 'weighted avg': {'precision': 0.36808161375278625, 'recall': 0.3594815475641144, 'f1-score': 0.3283442775825526, 'support': 97521}}
[[21763  4188  6398]
 [20461  5488  6519]
 [20055  4843  7806]]
Evaluating performance on  val set...
114/114 - 1s - 828ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1069856
{'0': {'precision': 0.3460039536853996, 'recall': 0.6410632063624948, 'f1-score': 0.4494332563002091, 'support': 9556}, '1': {'precision': 0.3587151841868823, 'recall': 0.16599106122024737, 'f1-score': 0.22695942585092022, 'support': 9621}, '2': {'precision': 0.3722543352601156, 'recall': 0.2602020202020202, 'f1-score': 0.30630202140309154, 'support': 9900}, 'accuracy': 0.35419747566805376, 'macro avg': {'precision': 0.35899115771079915, 'recall': 0.3557520959282541, 'f1-score': 0.3275649011847403, 'support': 29077}, 'weighted avg': {'precision': 0.35914745288560784, 'recall': 0.35419747566805376, 'f1-score': 0.3270884494688966, 'support': 29077}}
[[6126 1342 2088]
 [5768 1597 2256]
 [5811 1513 2576]]
training model: results/XRAY/W7/deepLOB_L1/h100
Epoch 1/50
381/381 - 8s - loss: 3.3510 - accuracy100: 0.3452 - val_loss: 3.4696 - val_accuracy100: 0.3317 - 8s/epoch - 22ms/step
Epoch 2/50
381/381 - 6s - loss: 3.3084 - accuracy100: 0.3532 - val_loss: 3.3930 - val_accuracy100: 0.3327 - 6s/epoch - 17ms/step
Epoch 3/50
381/381 - 6s - loss: 3.2922 - accuracy100: 0.3621 - val_loss: 3.3605 - val_accuracy100: 0.3408 - 6s/epoch - 17ms/step
Epoch 4/50
381/381 - 6s - loss: 3.2843 - accuracy100: 0.3669 - val_loss: 3.4250 - val_accuracy100: 0.3218 - 6s/epoch - 17ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2755 - accuracy100: 0.3717 - val_loss: 3.4168 - val_accuracy100: 0.3171 - 7s/epoch - 17ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2703 - accuracy100: 0.3768 - val_loss: 3.3856 - val_accuracy100: 0.3188 - 7s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2662 - accuracy100: 0.3814 - val_loss: 3.3545 - val_accuracy100: 0.3341 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 6s - loss: 3.2610 - accuracy100: 0.3858 - val_loss: 3.3758 - val_accuracy100: 0.3295 - 6s/epoch - 17ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2574 - accuracy100: 0.3899 - val_loss: 3.3623 - val_accuracy100: 0.3260 - 7s/epoch - 17ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2539 - accuracy100: 0.3916 - val_loss: 3.3607 - val_accuracy100: 0.3254 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2511 - accuracy100: 0.3946 - val_loss: 3.4165 - val_accuracy100: 0.3240 - 7s/epoch - 17ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2492 - accuracy100: 0.3949 - val_loss: 3.3602 - val_accuracy100: 0.3253 - 6s/epoch - 16ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2452 - accuracy100: 0.3998 - val_loss: 3.3892 - val_accuracy100: 0.3310 - 6s/epoch - 16ms/step
Epoch 14/50
381/381 - 6s - loss: 3.2417 - accuracy100: 0.4000 - val_loss: 3.4105 - val_accuracy100: 0.3320 - 6s/epoch - 17ms/step
Epoch 15/50
381/381 - 6s - loss: 3.2385 - accuracy100: 0.4023 - val_loss: 3.3679 - val_accuracy100: 0.3289 - 6s/epoch - 17ms/step
Epoch 16/50
381/381 - 6s - loss: 3.2355 - accuracy100: 0.4042 - val_loss: 3.3802 - val_accuracy100: 0.3340 - 6s/epoch - 16ms/step
Epoch 17/50
381/381 - 6s - loss: 3.2320 - accuracy100: 0.4054 - val_loss: 3.3695 - val_accuracy100: 0.3281 - 6s/epoch - 16ms/step
testing model: results/XRAY/W7/deepLOB_L1/h100
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.122749
{'0': {'precision': 0.3371746536093393, 'recall': 0.5405758167118635, 'f1-score': 0.41530815399668014, 'support': 78914}, '1': {'precision': 0.3207937002962732, 'recall': 0.3146604466197614, 'f1-score': 0.3176974750984479, 'support': 78456}, '2': {'precision': 0.33675659994197854, 'recall': 0.1440645361464474, 'f1-score': 0.20179929592768048, 'support': 80575}, 'accuracy': 0.3318161760070605, 'macro avg': {'precision': 0.3315749846158637, 'recall': 0.33310026649269076, 'f1-score': 0.3116016416742695, 'support': 237945}, 'weighted avg': {'precision': 0.3316319073974941, 'recall': 0.3318161760070605, 'f1-score': 0.31082342154779763, 'support': 237945}}
[[42659 24596 11659]
 [42566 24687 11203]
 [41294 27673 11608]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1204194
{'0': {'precision': 0.3416760507101602, 'recall': 0.5798119895207274, 'f1-score': 0.429973829468704, 'support': 32445}, '1': {'precision': 0.3336835327210492, 'recall': 0.30529285913615084, 'f1-score': 0.31885747595453223, 'support': 32251}, '2': {'precision': 0.3441648656992899, 'recall': 0.13584158415841585, 'f1-score': 0.19479696817457026, 'support': 32825}, 'accuracy': 0.33958839634540255, 'macro avg': {'precision': 0.33984148304349976, 'recall': 0.34031547760509806, 'f1-score': 0.3145427578659355, 'support': 97521}, 'weighted avg': {'precision': 0.3398705796254848, 'recall': 0.33958839634540255, 'f1-score': 0.314067573491371, 'support': 97521}}
[[18812  9387  4246]
 [18154  9846  4251]
 [18092 10274  4459]]
Evaluating performance on  val set...
114/114 - 1s - 803ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1200786
{'0': {'precision': 0.33821740572818754, 'recall': 0.6337546622461666, 'f1-score': 0.44105559160718144, 'support': 9652}, '1': {'precision': 0.3207523510971787, 'recall': 0.2754387853989448, 'f1-score': 0.2963735372494497, 'support': 9287}, '2': {'precision': 0.34781167108753314, 'recall': 0.10347208522391003, 'f1-score': 0.15949521058233238, 'support': 10138}, 'accuracy': 0.33442239570794785, 'macro avg': {'precision': 0.33559380930429983, 'recall': 0.3375551776230071, 'f1-score': 0.29897477981298787, 'support': 29077}, 'weighted avg': {'precision': 0.3359843245937812, 'recall': 0.33442239570794785, 'f1-score': 0.2966761376865509, 'support': 29077}}
[[6117 2546  989]
 [5751 2558  978]
 [6218 2871 1049]]
training model: results/XRAY/W7/deepLOB_L1/h200
Epoch 1/50
381/381 - 9s - loss: 3.3543 - accuracy200: 0.3492 - val_loss: 3.3994 - val_accuracy200: 0.3316 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3076 - accuracy200: 0.3634 - val_loss: 3.4294 - val_accuracy200: 0.3332 - 7s/epoch - 18ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2941 - accuracy200: 0.3638 - val_loss: 3.3843 - val_accuracy200: 0.3326 - 7s/epoch - 17ms/step
Epoch 4/50
381/381 - 6s - loss: 3.2740 - accuracy200: 0.3754 - val_loss: 3.3977 - val_accuracy200: 0.3262 - 6s/epoch - 17ms/step
Epoch 5/50
381/381 - 6s - loss: 3.2625 - accuracy200: 0.3869 - val_loss: 3.3603 - val_accuracy200: 0.3359 - 6s/epoch - 17ms/step
Epoch 6/50
381/381 - 6s - loss: 3.2593 - accuracy200: 0.3896 - val_loss: 3.3963 - val_accuracy200: 0.3293 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 6s - loss: 3.2514 - accuracy200: 0.3951 - val_loss: 3.3821 - val_accuracy200: 0.3300 - 6s/epoch - 17ms/step
Epoch 8/50
381/381 - 6s - loss: 3.2449 - accuracy200: 0.4019 - val_loss: 3.3982 - val_accuracy200: 0.3312 - 6s/epoch - 16ms/step
Epoch 9/50
381/381 - 6s - loss: 3.2425 - accuracy200: 0.4016 - val_loss: 3.3816 - val_accuracy200: 0.3300 - 6s/epoch - 16ms/step
Epoch 10/50
381/381 - 6s - loss: 3.2310 - accuracy200: 0.4088 - val_loss: 3.3645 - val_accuracy200: 0.3347 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 6s - loss: 3.2286 - accuracy200: 0.4096 - val_loss: 3.3835 - val_accuracy200: 0.3345 - 6s/epoch - 16ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2221 - accuracy200: 0.4157 - val_loss: 3.3673 - val_accuracy200: 0.3340 - 6s/epoch - 16ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2157 - accuracy200: 0.4188 - val_loss: 3.3395 - val_accuracy200: 0.3426 - 6s/epoch - 16ms/step
Epoch 14/50
381/381 - 6s - loss: 3.2097 - accuracy200: 0.4208 - val_loss: 3.3834 - val_accuracy200: 0.3363 - 6s/epoch - 17ms/step
Epoch 15/50
381/381 - 7s - loss: 3.2108 - accuracy200: 0.4202 - val_loss: 3.3722 - val_accuracy200: 0.3416 - 7s/epoch - 17ms/step
Epoch 16/50
381/381 - 7s - loss: 3.2075 - accuracy200: 0.4213 - val_loss: 3.3727 - val_accuracy200: 0.3351 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 7s - loss: 3.2025 - accuracy200: 0.4245 - val_loss: 3.3588 - val_accuracy200: 0.3398 - 7s/epoch - 19ms/step
Epoch 18/50
381/381 - 6s - loss: 3.1990 - accuracy200: 0.4272 - val_loss: 3.3483 - val_accuracy200: 0.3467 - 6s/epoch - 17ms/step
Epoch 19/50
381/381 - 6s - loss: 3.1961 - accuracy200: 0.4291 - val_loss: 3.3937 - val_accuracy200: 0.3301 - 6s/epoch - 17ms/step
Epoch 20/50
381/381 - 6s - loss: 3.1919 - accuracy200: 0.4305 - val_loss: 3.3938 - val_accuracy200: 0.3371 - 6s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.1893 - accuracy200: 0.4314 - val_loss: 3.6105 - val_accuracy200: 0.3325 - 7s/epoch - 18ms/step
Epoch 22/50
381/381 - 7s - loss: 3.1884 - accuracy200: 0.4311 - val_loss: 3.4790 - val_accuracy200: 0.3274 - 7s/epoch - 17ms/step
Epoch 23/50
381/381 - 7s - loss: 3.1843 - accuracy200: 0.4332 - val_loss: 3.5096 - val_accuracy200: 0.3330 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepLOB_L1/h200
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234758
{'0': {'precision': 0.3312035876169351, 'recall': 0.7117247810994249, 'f1-score': 0.45204600424502694, 'support': 77204}, '1': {'precision': 0.3683186582809224, 'recall': 0.2650278169991432, 'f1-score': 0.30825051934197967, 'support': 82863}, '2': {'precision': 0.32635309278350516, 'recall': 0.052030098358971724, 'f1-score': 0.08975125700489513, 'support': 77878}, 'accuracy': 0.3402508983168379, 'macro avg': {'precision': 0.34195844622712085, 'recall': 0.3429275654858466, 'f1-score': 0.2833492601973006, 'support': 237945}, 'weighted avg': {'precision': 0.34254116253463507, 'recall': 0.3402508983168379, 'f1-score': 0.28339309877910757, 'support': 237945}}
[[54948 18149  4107]
 [56645 21961  4257]
 [54311 19515  4052]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1230005
{'0': {'precision': 0.33028563571993264, 'recall': 0.5940465518840221, 'f1-score': 0.4245336160906591, 'support': 32351}, '1': {'precision': 0.31968456172277826, 'recall': 0.2950085523246773, 'f1-score': 0.3068512647991201, 'support': 32155}, '2': {'precision': 0.3632788242599876, 'recall': 0.10631531122217174, 'f1-score': 0.16449141223609906, 'support': 33015}, 'accuracy': 0.3303288522472083, 'macro avg': {'precision': 0.33774967390089944, 'recall': 0.33179013847695704, 'f1-score': 0.29862543104195943, 'support': 97521}, 'weighted avg': {'precision': 0.3379598042095032, 'recall': 0.3303288522472083, 'f1-score': 0.29769560821504526, 'support': 97521}}
[[19218  9940  3193]
 [19710  9486  2959]
 [19258 10247  3510]]
Evaluating performance on  val set...
114/114 - 1s - 868ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154763
{'0': {'precision': 0.3355337222392795, 'recall': 0.6890500210172341, 'f1-score': 0.45130428797577254, 'support': 9516}, '1': {'precision': 0.348893166506256, 'recall': 0.23059796437659033, 'f1-score': 0.2776713902719265, 'support': 9432}, '2': {'precision': 0.3477734019993941, 'recall': 0.11333794056668971, 'f1-score': 0.17096053611317943, 'support': 10129}, 'accuracy': 0.3397874608797331, 'macro avg': {'precision': 0.34406676358164323, 'recall': 0.34432864198683805, 'f1-score': 0.2999787381202928, 'support': 29077}, 'weighted avg': {'precision': 0.34413096386036574, 'recall': 0.3397874608797331, 'f1-score': 0.29732322549481227, 'support': 29077}}
[[6557 1880 1079]
 [6183 2175 1074]
 [6802 2179 1148]]
training model: results/XRAY/W7/deepLOB_L1/h300
Epoch 1/50
381/381 - 10s - loss: 3.3560 - accuracy300: 0.3466 - val_loss: 3.4176 - val_accuracy300: 0.3311 - 10s/epoch - 27ms/step
Epoch 2/50
381/381 - 8s - loss: 3.3272 - accuracy300: 0.3461 - val_loss: 3.3627 - val_accuracy300: 0.3409 - 8s/epoch - 20ms/step
Epoch 3/50
381/381 - 8s - loss: 3.3017 - accuracy300: 0.3542 - val_loss: 3.3422 - val_accuracy300: 0.3323 - 8s/epoch - 20ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2941 - accuracy300: 0.3631 - val_loss: 3.3648 - val_accuracy300: 0.3308 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2856 - accuracy300: 0.3656 - val_loss: 3.5016 - val_accuracy300: 0.3320 - 7s/epoch - 19ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2786 - accuracy300: 0.3761 - val_loss: 3.3623 - val_accuracy300: 0.3337 - 7s/epoch - 18ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2675 - accuracy300: 0.3866 - val_loss: 3.3644 - val_accuracy300: 0.3320 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2643 - accuracy300: 0.3855 - val_loss: 3.4276 - val_accuracy300: 0.3271 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2559 - accuracy300: 0.3953 - val_loss: 3.3446 - val_accuracy300: 0.3398 - 7s/epoch - 19ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2527 - accuracy300: 0.3944 - val_loss: 3.4125 - val_accuracy300: 0.3250 - 7s/epoch - 19ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2459 - accuracy300: 0.4011 - val_loss: 3.4103 - val_accuracy300: 0.3247 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 7s - loss: 3.2354 - accuracy300: 0.4087 - val_loss: 3.4244 - val_accuracy300: 0.3270 - 7s/epoch - 19ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2311 - accuracy300: 0.4097 - val_loss: 3.4182 - val_accuracy300: 0.3332 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepLOB_L1/h300
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1298064
{'0': {'precision': 0.33136416266925023, 'recall': 0.36004416144603063, 'f1-score': 0.34510933097075075, 'support': 77896}, '1': {'precision': 0.3462939190132001, 'recall': 0.6147282117335249, 'f1-score': 0.4430213098292982, 'support': 80743}, '2': {'precision': 0.32972431077694236, 'recall': 0.041472271959246465, 'f1-score': 0.07367749017148106, 'support': 79306}, 'accuracy': 0.34028872218369793, 'macro avg': {'precision': 0.3357941308197976, 'recall': 0.3387482150462673, 'f1-score': 0.28726937699051003, 'support': 237945}, 'weighted avg': {'precision': 0.33588379208910857, 'recall': 0.34028872218369793, 'f1-score': 0.2878672512571565, 'support': 237945}}
[[28046 46523  3327]
 [27749 49635  3359]
 [28843 47174  3289]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279284
{'0': {'precision': 0.32668596237337194, 'recall': 0.34997364422808597, 'f1-score': 0.3379290729180701, 'support': 32251}, '1': {'precision': 0.33196042957773586, 'recall': 0.5363684423298193, 'f1-score': 0.4101052131011116, 'support': 32157}, '2': {'precision': 0.34068827749023883, 'recall': 0.11330897230694893, 'f1-score': 0.1700584689298826, 'support': 33113}, 'accuracy': 0.33107740896832477, 'macro avg': {'precision': 0.33311155648044893, 'recall': 0.33321701962161804, 'f1-score': 0.3060309183163548, 'support': 97521}, 'weighted avg': {'precision': 0.3331796376059428, 'recall': 0.33107740896832477, 'f1-score': 0.3047287245828932, 'support': 97521}}
[[11287 17209  3755]
 [11403 17248  3506]
 [11860 17501  3752]]
Evaluating performance on  val set...
114/114 - 1s - 858ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1177969
{'0': {'precision': 0.31677231454514304, 'recall': 0.4002164502164502, 'f1-score': 0.35363871091135124, 'support': 9240}, '1': {'precision': 0.3341690774670524, 'recall': 0.5288432190456811, 'f1-score': 0.40954932240781594, 'support': 9829}, '2': {'precision': 0.35119047619047616, 'recall': 0.06484812150279776, 'f1-score': 0.1094804318488529, 'support': 10008}, 'accuracy': 0.32826632733775835, 'macro avg': {'precision': 0.33404395606755716, 'recall': 0.33130259692164304, 'f1-score': 0.29088948838934003, 'support': 29077}, 'weighted avg': {'precision': 0.3344993752634407, 'recall': 0.32826632733775835, 'f1-score': 0.28850163843280346, 'support': 29077}}
[[3698 4935  607]
 [4039 5198  592]
 [3937 5422  649]]
training model: results/XRAY/W7/deepLOB_L1/h500
Epoch 1/50
381/381 - 10s - loss: 3.3373 - accuracy500: 0.3559 - val_loss: 3.5054 - val_accuracy500: 0.3330 - 10s/epoch - 26ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3154 - accuracy500: 0.3619 - val_loss: 3.3549 - val_accuracy500: 0.3406 - 7s/epoch - 19ms/step
Epoch 3/50
381/381 - 7s - loss: 3.3012 - accuracy500: 0.3658 - val_loss: 3.3115 - val_accuracy500: 0.3508 - 7s/epoch - 19ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2766 - accuracy500: 0.3794 - val_loss: 3.3498 - val_accuracy500: 0.3260 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2764 - accuracy500: 0.3809 - val_loss: 3.4721 - val_accuracy500: 0.3339 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2695 - accuracy500: 0.3826 - val_loss: 3.3755 - val_accuracy500: 0.3296 - 7s/epoch - 18ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2596 - accuracy500: 0.3891 - val_loss: 3.3586 - val_accuracy500: 0.3218 - 7s/epoch - 19ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2444 - accuracy500: 0.4011 - val_loss: 3.4171 - val_accuracy500: 0.3261 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2357 - accuracy500: 0.4048 - val_loss: 3.4291 - val_accuracy500: 0.3177 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2262 - accuracy500: 0.4115 - val_loss: 3.4101 - val_accuracy500: 0.3135 - 7s/epoch - 19ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2136 - accuracy500: 0.4184 - val_loss: 3.5213 - val_accuracy500: 0.3143 - 7s/epoch - 19ms/step
Epoch 12/50
381/381 - 7s - loss: 3.2076 - accuracy500: 0.4214 - val_loss: 3.4575 - val_accuracy500: 0.3182 - 7s/epoch - 19ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2000 - accuracy500: 0.4254 - val_loss: 3.4585 - val_accuracy500: 0.3186 - 7s/epoch - 19ms/step
testing model: results/XRAY/W7/deepLOB_L1/h500
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129321
{'0': {'precision': 0.3198172930523279, 'recall': 0.2580699394754539, 'f1-score': 0.28564475840794734, 'support': 77324}, '1': {'precision': 0.3545785282811642, 'recall': 0.38066053378204107, 'f1-score': 0.3671569121052912, 'support': 81419}, '2': {'precision': 0.33388169090785325, 'recall': 0.3715688997752582, 'f1-score': 0.35171861554641937, 'support': 79202}, 'accuracy': 0.33779654962281197, 'macro avg': {'precision': 0.3360925040804485, 'recall': 0.3367664576775844, 'f1-score': 0.33484009535321935, 'support': 237945}, 'weighted avg': {'precision': 0.33639319693788944, 'recall': 0.33779654962281197, 'f1-score': 0.3355294783010542, 'support': 237945}}
[[19955 28742 28627]
 [20340 30993 30086]
 [22100 27673 29429]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095519
{'0': {'precision': 0.34071370087336245, 'recall': 0.31095681414827037, 'f1-score': 0.32515587100555104, 'support': 32117}, '1': {'precision': 0.3398585539076721, 'recall': 0.3534761018001241, 'f1-score': 0.3465335990628471, 'support': 32220}, '2': {'precision': 0.3449478356101216, 'recall': 0.3606858727097396, 'f1-score': 0.3526413482219145, 'support': 33184}, 'accuracy': 0.3419263543236841, 'macro avg': {'precision': 0.3418400301303854, 'recall': 0.3417062628860447, 'f1-score': 0.34144360609677094, 'support': 97521}, 'weighted avg': {'precision': 0.3418719405537398, 'recall': 0.3419263543236841, 'f1-score': 0.34157149916721763, 'support': 97521}}
[[ 9987 10802 11328]
 [ 9430 11389 11401]
 [ 9895 11320 11969]]
Evaluating performance on  val set...
114/114 - 1s - 935ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035088
{'0': {'precision': 0.32295357076263287, 'recall': 0.19760410724472333, 'f1-score': 0.24518686296715744, 'support': 8765}, '1': {'precision': 0.3554049640757675, 'recall': 0.4315883402736466, 'f1-score': 0.38980925942509176, 'support': 10086}, '2': {'precision': 0.3545264259549974, 'recall': 0.39751613534128694, 'f1-score': 0.3747925502489397, 'support': 10226}, 'accuracy': 0.34907315060013067, 'macro avg': {'precision': 0.34429498693113264, 'recall': 0.3422361942865522, 'f1-score': 0.33659622421372964, 'support': 29077}, 'weighted avg': {'precision': 0.3453138132275844, 'recall': 0.34907315060013067, 'f1-score': 0.3409329594976878, 'support': 29077}}
[[1732 3540 3493]
 [1825 4353 3908]
 [1806 4355 4065]]
training model: results/XRAY/W7/deepLOB_L1/h1000
Epoch 1/50
381/381 - 9s - loss: 3.3268 - accuracy1000: 0.3718 - val_loss: 3.4676 - val_accuracy1000: 0.3101 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3128 - accuracy1000: 0.3671 - val_loss: 3.6397 - val_accuracy1000: 0.3113 - 7s/epoch - 18ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2865 - accuracy1000: 0.3882 - val_loss: 3.4894 - val_accuracy1000: 0.3087 - 7s/epoch - 19ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2680 - accuracy1000: 0.3916 - val_loss: 3.5799 - val_accuracy1000: 0.3062 - 7s/epoch - 19ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2358 - accuracy1000: 0.4057 - val_loss: 3.4752 - val_accuracy1000: 0.3236 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2216 - accuracy1000: 0.4125 - val_loss: 3.6169 - val_accuracy1000: 0.3128 - 7s/epoch - 19ms/step
Epoch 7/50
381/381 - 7s - loss: 3.1935 - accuracy1000: 0.4283 - val_loss: 3.8280 - val_accuracy1000: 0.3041 - 7s/epoch - 19ms/step
Epoch 8/50
381/381 - 7s - loss: 3.1844 - accuracy1000: 0.4280 - val_loss: 4.0995 - val_accuracy1000: 0.3035 - 7s/epoch - 19ms/step
Epoch 9/50
381/381 - 8s - loss: 3.1594 - accuracy1000: 0.4432 - val_loss: 3.9737 - val_accuracy1000: 0.3025 - 8s/epoch - 20ms/step
Epoch 10/50
381/381 - 7s - loss: 3.1521 - accuracy1000: 0.4485 - val_loss: 4.1370 - val_accuracy1000: 0.3036 - 7s/epoch - 19ms/step
Epoch 11/50
381/381 - 7s - loss: 3.1275 - accuracy1000: 0.4597 - val_loss: 4.5997 - val_accuracy1000: 0.3026 - 7s/epoch - 19ms/step
testing model: results/XRAY/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1476177
{'0': {'precision': 0.31732456644519547, 'recall': 0.5400879103679453, 'f1-score': 0.39976829503765204, 'support': 76669}, '1': {'precision': 0.3326062914721062, 'recall': 0.26131344580406923, 'f1-score': 0.2926809488409813, 'support': 82866}, '2': {'precision': 0.32290436835891384, 'recall': 0.1744037750286953, 'f1-score': 0.2264822789002981, 'support': 78410}, 'accuracy': 0.3224988968038833, 'macro avg': {'precision': 0.3242784087587385, 'recall': 0.3252683770669033, 'f1-score': 0.3063105075929771, 'support': 237945}, 'weighted avg': {'precision': 0.32448524514882293, 'recall': 0.3224988968038833, 'f1-score': 0.3053714530982827, 'support': 237945}}
[[41408 21735 13526]
 [46063 21654 15149]
 [43020 21715 13675]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1461253
{'0': {'precision': 0.32681500434047606, 'recall': 0.44597543487748614, 'f1-score': 0.3772082476401413, 'support': 32078}, '1': {'precision': 0.3234896365191952, 'recall': 0.36393839657206734, 'f1-score': 0.34252399947398415, 'support': 32206}, '2': {'precision': 0.34081306383464655, 'recall': 0.17958901224538917, 'f1-score': 0.2352268920809442, 'support': 33237}, 'accuracy': 0.328093436285518, 'macro avg': {'precision': 0.3303725682314393, 'recall': 0.32983428123164754, 'f1-score': 0.3183197130650232, 'support': 97521}, 'weighted avg': {'precision': 0.3304876154432701, 'recall': 0.328093436285518, 'f1-score': 0.31736395552705504, 'support': 97521}}
[[14306 12031  5741]
 [14681 11721  5804]
 [14787 12481  5969]]
Evaluating performance on  val set...
114/114 - 1s - 853ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.158784
{'0': {'precision': 0.2870948929434308, 'recall': 0.39163541311512673, 'f1-score': 0.33131429670224016, 'support': 8799}, '1': {'precision': 0.309657600959017, 'recall': 0.43509843141383303, 'f1-score': 0.3618138842685809, 'support': 9499}, '2': {'precision': 0.3547088811376442, 'recall': 0.12264588551813711, 'f1-score': 0.1822694057631325, 'support': 10779}, 'accuracy': 0.30611823778243974, 'macro avg': {'precision': 0.31715379168003066, 'recall': 0.316459910015699, 'f1-score': 0.29179919557798456, 'support': 29077}, 'weighted avg': {'precision': 0.3195306442996739, 'recall': 0.30611823778243974, 'f1-score': 0.2860262925360617, 'support': 29077}}
[[3446 4252 1101]
 [4062 4133 1304]
 [4495 4962 1322]]
training model: results/XRAY/W7/deepOF_L1/h10
Epoch 1/50
381/381 - 10s - loss: 3.2928 - accuracy10: 0.3738 - val_loss: 3.2990 - val_accuracy10: 0.3864 - 10s/epoch - 26ms/step
Epoch 2/50
381/381 - 7s - loss: 3.2479 - accuracy10: 0.3949 - val_loss: 3.2836 - val_accuracy10: 0.3877 - 7s/epoch - 19ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2309 - accuracy10: 0.4022 - val_loss: 3.2709 - val_accuracy10: 0.3910 - 7s/epoch - 18ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2250 - accuracy10: 0.4032 - val_loss: 3.2695 - val_accuracy10: 0.3956 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2158 - accuracy10: 0.4084 - val_loss: 3.2627 - val_accuracy10: 0.3951 - 7s/epoch - 19ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2128 - accuracy10: 0.4077 - val_loss: 3.2577 - val_accuracy10: 0.3958 - 7s/epoch - 18ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2061 - accuracy10: 0.4119 - val_loss: 3.2510 - val_accuracy10: 0.3987 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2038 - accuracy10: 0.4109 - val_loss: 3.2534 - val_accuracy10: 0.3970 - 7s/epoch - 17ms/step
Epoch 9/50
381/381 - 7s - loss: 3.1993 - accuracy10: 0.4128 - val_loss: 3.2451 - val_accuracy10: 0.4004 - 7s/epoch - 17ms/step
Epoch 10/50
381/381 - 6s - loss: 3.1991 - accuracy10: 0.4121 - val_loss: 3.2487 - val_accuracy10: 0.3986 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 7s - loss: 3.1943 - accuracy10: 0.4153 - val_loss: 3.2438 - val_accuracy10: 0.3997 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 7s - loss: 3.1927 - accuracy10: 0.4159 - val_loss: 3.2451 - val_accuracy10: 0.3983 - 7s/epoch - 18ms/step
Epoch 13/50
381/381 - 7s - loss: 3.1887 - accuracy10: 0.4197 - val_loss: 3.2427 - val_accuracy10: 0.4012 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.1866 - accuracy10: 0.4186 - val_loss: 3.2465 - val_accuracy10: 0.3996 - 7s/epoch - 17ms/step
Epoch 15/50
381/381 - 6s - loss: 3.1822 - accuracy10: 0.4221 - val_loss: 3.2421 - val_accuracy10: 0.3988 - 6s/epoch - 17ms/step
Epoch 16/50
381/381 - 6s - loss: 3.1802 - accuracy10: 0.4219 - val_loss: 3.2455 - val_accuracy10: 0.3987 - 6s/epoch - 16ms/step
Epoch 17/50
381/381 - 7s - loss: 3.1776 - accuracy10: 0.4246 - val_loss: 3.2432 - val_accuracy10: 0.4005 - 7s/epoch - 18ms/step
Epoch 18/50
381/381 - 7s - loss: 3.1741 - accuracy10: 0.4252 - val_loss: 3.2481 - val_accuracy10: 0.3997 - 7s/epoch - 18ms/step
Epoch 19/50
381/381 - 7s - loss: 3.1712 - accuracy10: 0.4263 - val_loss: 3.2462 - val_accuracy10: 0.3995 - 7s/epoch - 19ms/step
Epoch 20/50
381/381 - 6s - loss: 3.1691 - accuracy10: 0.4281 - val_loss: 3.2458 - val_accuracy10: 0.4009 - 6s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.1662 - accuracy10: 0.4292 - val_loss: 3.2475 - val_accuracy10: 0.3989 - 7s/epoch - 18ms/step
Epoch 22/50
381/381 - 6s - loss: 3.1638 - accuracy10: 0.4286 - val_loss: 3.2523 - val_accuracy10: 0.3992 - 6s/epoch - 17ms/step
Epoch 23/50
381/381 - 6s - loss: 3.1608 - accuracy10: 0.4315 - val_loss: 3.2516 - val_accuracy10: 0.3975 - 6s/epoch - 17ms/step
Epoch 24/50
381/381 - 7s - loss: 3.1571 - accuracy10: 0.4322 - val_loss: 3.2573 - val_accuracy10: 0.3999 - 7s/epoch - 18ms/step
Epoch 25/50
381/381 - 7s - loss: 3.1537 - accuracy10: 0.4353 - val_loss: 3.2570 - val_accuracy10: 0.3978 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepOF_L1/h10
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1052277
{'0': {'precision': 0.33866061384649176, 'recall': 0.7294546080174342, 'f1-score': 0.46256722171460257, 'support': 69748}, '1': {'precision': 0.44256868586560744, 'recall': 0.027881176556455733, 'f1-score': 0.052457601349694453, 'support': 95907}, '2': {'precision': 0.3914283964978877, 'recall': 0.4422217610845957, 'f1-score': 0.4152776875608964, 'support': 72285}, 'accuracy': 0.35940993527780113, 'macro avg': {'precision': 0.3908858987366623, 'recall': 0.3998525152194952, 'f1-score': 0.31010083687506446, 'support': 237940}, 'weighted avg': {'precision': 0.3965736618085557, 'recall': 0.35940993527780113, 'f1-score': 0.2828971059852679, 'support': 237940}}
[[50878  1397 17473]
 [61007  2674 32226]
 [38348  1971 31966]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0806062
{'0': {'precision': 0.3818665393664541, 'recall': 0.7134029812714996, 'f1-score': 0.4974569683509162, 'support': 31396}, '1': {'precision': 0.5170526315789473, 'recall': 0.035060670949321915, 'f1-score': 0.06566844919786098, 'support': 35025}, '2': {'precision': 0.4138006631772218, 'recall': 0.4855461590404836, 'f1-score': 0.4468116585293682, 'support': 31099}, 'accuracy': 0.39710828547990157, 'macro avg': {'precision': 0.43757327804087437, 'recall': 0.4113366037537684, 'f1-score': 0.3366456920260485, 'support': 97520}, 'weighted avg': {'precision': 0.44060333383049877, 'recall': 0.39710828547990157, 'f1-score': 0.32622633490673986, 'support': 97520}}
[[22398   507  8491]
 [20897  1228 12900]
 [15359   640 15100]]
Evaluating performance on  val set...
114/114 - 1s - 811ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0846974
{'0': {'precision': 0.3890477237739169, 'recall': 0.7294845360824742, 'f1-score': 0.5074584050487665, 'support': 9700}, '1': {'precision': 0.41304347826086957, 'recall': 0.02135704067034539, 'f1-score': 0.04061406917994559, 'support': 9786}, '2': {'precision': 0.42271019936434556, 'recall': 0.45761651548326554, 'f1-score': 0.43947131270651846, 'support': 9591}, 'accuracy': 0.4014857103552636, 'macro avg': {'precision': 0.40826713379971064, 'recall': 0.40281936407869506, 'f1-score': 0.32918126231174355, 'support': 29077}, 'weighted avg': {'precision': 0.4082271183743612, 'recall': 0.4014857103552636, 'f1-score': 0.32791433676569803, 'support': 29077}}
[[7076  108 2516]
 [6099  209 3478]
 [5013  189 4389]]
training model: results/XRAY/W7/deepOF_L1/h20
Epoch 1/50
381/381 - 10s - loss: 3.2997 - accuracy20: 0.3676 - val_loss: 3.2997 - val_accuracy20: 0.3945 - 10s/epoch - 26ms/step
Epoch 2/50
381/381 - 6s - loss: 3.2583 - accuracy20: 0.3909 - val_loss: 3.2934 - val_accuracy20: 0.4034 - 6s/epoch - 16ms/step
Epoch 3/50
381/381 - 6s - loss: 3.2420 - accuracy20: 0.3982 - val_loss: 3.2805 - val_accuracy20: 0.4042 - 6s/epoch - 16ms/step
Epoch 4/50
381/381 - 6s - loss: 3.2358 - accuracy20: 0.3998 - val_loss: 3.2651 - val_accuracy20: 0.4048 - 6s/epoch - 16ms/step
Epoch 5/50
381/381 - 6s - loss: 3.2288 - accuracy20: 0.4030 - val_loss: 3.2613 - val_accuracy20: 0.4077 - 6s/epoch - 17ms/step
Epoch 6/50
381/381 - 6s - loss: 3.2237 - accuracy20: 0.4045 - val_loss: 3.2613 - val_accuracy20: 0.4073 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 6s - loss: 3.2191 - accuracy20: 0.4058 - val_loss: 3.2547 - val_accuracy20: 0.4078 - 6s/epoch - 17ms/step
Epoch 8/50
381/381 - 6s - loss: 3.2165 - accuracy20: 0.4075 - val_loss: 3.2503 - val_accuracy20: 0.4061 - 6s/epoch - 17ms/step
Epoch 9/50
381/381 - 6s - loss: 3.2127 - accuracy20: 0.4095 - val_loss: 3.2487 - val_accuracy20: 0.4118 - 6s/epoch - 17ms/step
Epoch 10/50
381/381 - 6s - loss: 3.2087 - accuracy20: 0.4123 - val_loss: 3.2467 - val_accuracy20: 0.4105 - 6s/epoch - 16ms/step
Epoch 11/50
381/381 - 6s - loss: 3.2081 - accuracy20: 0.4117 - val_loss: 3.2448 - val_accuracy20: 0.4104 - 6s/epoch - 16ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2059 - accuracy20: 0.4134 - val_loss: 3.2520 - val_accuracy20: 0.4092 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2013 - accuracy20: 0.4145 - val_loss: 3.2478 - val_accuracy20: 0.4098 - 7s/epoch - 17ms/step
Epoch 14/50
381/381 - 6s - loss: 3.2002 - accuracy20: 0.4162 - val_loss: 3.2499 - val_accuracy20: 0.4095 - 6s/epoch - 17ms/step
Epoch 15/50
381/381 - 7s - loss: 3.1969 - accuracy20: 0.4188 - val_loss: 3.2473 - val_accuracy20: 0.4116 - 7s/epoch - 17ms/step
Epoch 16/50
381/381 - 7s - loss: 3.1944 - accuracy20: 0.4195 - val_loss: 3.2480 - val_accuracy20: 0.4115 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 7s - loss: 3.1925 - accuracy20: 0.4204 - val_loss: 3.2529 - val_accuracy20: 0.4079 - 7s/epoch - 18ms/step
Epoch 18/50
381/381 - 7s - loss: 3.1888 - accuracy20: 0.4216 - val_loss: 3.2525 - val_accuracy20: 0.4117 - 7s/epoch - 18ms/step
Epoch 19/50
381/381 - 7s - loss: 3.1858 - accuracy20: 0.4226 - val_loss: 3.2524 - val_accuracy20: 0.4102 - 7s/epoch - 18ms/step
Epoch 20/50
381/381 - 7s - loss: 3.1848 - accuracy20: 0.4224 - val_loss: 3.2490 - val_accuracy20: 0.4095 - 7s/epoch - 18ms/step
Epoch 21/50
381/381 - 7s - loss: 3.1833 - accuracy20: 0.4234 - val_loss: 3.2523 - val_accuracy20: 0.4102 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepOF_L1/h20
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0953635
{'0': {'precision': 0.36654023942159536, 'recall': 0.6736555479918311, 'f1-score': 0.47476036499361934, 'support': 73450}, '1': {'precision': 0.40133309945623574, 'recall': 0.02582421923498008, 'f1-score': 0.048525980911983034, 'support': 88599}, '2': {'precision': 0.39603278250228796, 'recall': 0.5074778300457234, 'f1-score': 0.4448821171551017, 'support': 75891}, 'accuracy': 0.37942758678658484, 'macro avg': {'precision': 0.3879687071267064, 'recall': 0.40231919909084485, 'f1-score': 0.3227228210202347, 'support': 237940}, 'weighted avg': {'precision': 0.3889023105031535, 'recall': 0.37942758678658484, 'f1-score': 0.30651866413642076, 'support': 237940}}
[[49480  1470 22500]
 [50077  2288 36234]
 [35435  1943 38513]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0772734
{'0': {'precision': 0.40073099686450586, 'recall': 0.662769646199638, 'f1-score': 0.4994681343076497, 'support': 32589}, '1': {'precision': 0.48627654065251164, 'recall': 0.028807215609277213, 'f1-score': 0.05439221478842646, 'support': 32596}, '2': {'precision': 0.4139841688654354, 'recall': 0.5337559919591773, 'f1-score': 0.4663019250253293, 'support': 32335}, 'accuracy': 0.4080906480721903, 'macro avg': {'precision': 0.43366390212748424, 'recall': 0.40844428458936416, 'f1-score': 0.3400540913738019, 'support': 97520}, 'weighted avg': {'precision': 0.433718936384234, 'recall': 0.4080906480721903, 'f1-score': 0.33970476218098405, 'support': 97520}}
[[21599   430 10560]
 [17786   939 13871]
 [14514   562 17259]]
Evaluating performance on  val set...
114/114 - 1s - 835ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0818027
{'0': {'precision': 0.40085147208730587, 'recall': 0.6775108949021993, 'f1-score': 0.5036919831223629, 'support': 9867}, '1': {'precision': 0.3587570621468927, 'recall': 0.013556789069171649, 'f1-score': 0.02612631145854763, 'support': 9368}, '2': {'precision': 0.42346006973269135, 'recall': 0.5182889656573867, 'f1-score': 0.4661001461988304, 'support': 9842}, 'accuracy': 0.4097052653299859, 'macro avg': {'precision': 0.3943562013222966, 'recall': 0.40311888320958583, 'f1-score': 0.33197281359324693, 'support': 29077}, 'weighted avg': {'precision': 0.39494210680560876, 'recall': 0.4097052653299859, 'f1-score': 0.3371062256113394, 'support': 29077}}
[[6685   88 3094]
 [5390  127 3851]
 [4602  139 5101]]
training model: results/XRAY/W7/deepOF_L1/h30
Epoch 1/50
381/381 - 9s - loss: 3.3054 - accuracy30: 0.3629 - val_loss: 3.3048 - val_accuracy30: 0.3927 - 9s/epoch - 23ms/step
Epoch 2/50
381/381 - 6s - loss: 3.2677 - accuracy30: 0.3838 - val_loss: 3.2860 - val_accuracy30: 0.3982 - 6s/epoch - 17ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2530 - accuracy30: 0.3926 - val_loss: 3.2788 - val_accuracy30: 0.4009 - 7s/epoch - 17ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2451 - accuracy30: 0.3939 - val_loss: 3.2717 - val_accuracy30: 0.4035 - 7s/epoch - 17ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2379 - accuracy30: 0.3996 - val_loss: 3.2652 - val_accuracy30: 0.4048 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 6s - loss: 3.2332 - accuracy30: 0.4005 - val_loss: 3.2618 - val_accuracy30: 0.4070 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2284 - accuracy30: 0.4046 - val_loss: 3.2591 - val_accuracy30: 0.4081 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2267 - accuracy30: 0.4039 - val_loss: 3.2530 - val_accuracy30: 0.4103 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2219 - accuracy30: 0.4083 - val_loss: 3.2523 - val_accuracy30: 0.4112 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2204 - accuracy30: 0.4090 - val_loss: 3.2533 - val_accuracy30: 0.4087 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2180 - accuracy30: 0.4102 - val_loss: 3.2521 - val_accuracy30: 0.4076 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2148 - accuracy30: 0.4121 - val_loss: 3.2543 - val_accuracy30: 0.4062 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2122 - accuracy30: 0.4138 - val_loss: 3.2505 - val_accuracy30: 0.4074 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.2100 - accuracy30: 0.4154 - val_loss: 3.2515 - val_accuracy30: 0.4099 - 7s/epoch - 18ms/step
Epoch 15/50
381/381 - 7s - loss: 3.2084 - accuracy30: 0.4157 - val_loss: 3.2492 - val_accuracy30: 0.4078 - 7s/epoch - 18ms/step
Epoch 16/50
381/381 - 7s - loss: 3.2055 - accuracy30: 0.4179 - val_loss: 3.2511 - val_accuracy30: 0.4089 - 7s/epoch - 17ms/step
Epoch 17/50
381/381 - 6s - loss: 3.2037 - accuracy30: 0.4179 - val_loss: 3.2527 - val_accuracy30: 0.4078 - 6s/epoch - 17ms/step
Epoch 18/50
381/381 - 6s - loss: 3.2016 - accuracy30: 0.4197 - val_loss: 3.2544 - val_accuracy30: 0.4078 - 6s/epoch - 17ms/step
Epoch 19/50
381/381 - 6s - loss: 3.1989 - accuracy30: 0.4199 - val_loss: 3.2546 - val_accuracy30: 0.4074 - 6s/epoch - 16ms/step
Epoch 20/50
381/381 - 6s - loss: 3.1956 - accuracy30: 0.4230 - val_loss: 3.2534 - val_accuracy30: 0.4099 - 6s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.1939 - accuracy30: 0.4233 - val_loss: 3.2578 - val_accuracy30: 0.4086 - 7s/epoch - 17ms/step
Epoch 22/50
381/381 - 6s - loss: 3.1898 - accuracy30: 0.4251 - val_loss: 3.2611 - val_accuracy30: 0.4040 - 6s/epoch - 17ms/step
Epoch 23/50
381/381 - 7s - loss: 3.1875 - accuracy30: 0.4272 - val_loss: 3.2632 - val_accuracy30: 0.4064 - 7s/epoch - 17ms/step
Epoch 24/50
381/381 - 7s - loss: 3.1838 - accuracy30: 0.4274 - val_loss: 3.2608 - val_accuracy30: 0.4076 - 7s/epoch - 17ms/step
Epoch 25/50
381/381 - 6s - loss: 3.1831 - accuracy30: 0.4278 - val_loss: 3.2623 - val_accuracy30: 0.4080 - 6s/epoch - 16ms/step
testing model: results/XRAY/W7/deepOF_L1/h30
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915201
{'0': {'precision': 0.3633767100433767, 'recall': 0.72233792764947, 'f1-score': 0.48351706899077834, 'support': 75383}, '1': {'precision': 0.369659788064696, 'recall': 0.039271917142653996, 'f1-score': 0.07100084626838492, 'support': 84386}, '2': {'precision': 0.41985466034755137, 'recall': 0.42497857261644345, 'f1-score': 0.422401078221951, 'support': 78171}, 'accuracy': 0.38239472135832564, 'macro avg': {'precision': 0.3842970528185414, 'recall': 0.39552947246952247, 'f1-score': 0.32563966449370474, 'support': 237940}, 'weighted avg': {'precision': 0.3841598556899039, 'recall': 0.38239472135832564, 'f1-score': 0.3171386034740855, 'support': 237940}}
[[54452  2603 18328]
 [53496  3314 27576]
 [41902  3048 33221]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0736583
{'0': {'precision': 0.39707671481690915, 'recall': 0.7041966754793813, 'f1-score': 0.5078123287971424, 'support': 32907}, '1': {'precision': 0.4656028368794326, 'recall': 0.04128671152757688, 'f1-score': 0.07584772687886315, 'support': 31802}, '2': {'precision': 0.43204644891444927, 'recall': 0.47852854225716984, 'f1-score': 0.45410111059694586, 'support': 32811}, 'accuracy': 0.41208982772764563, 'macro avg': {'precision': 0.43157533353693034, 'recall': 0.40800397642137604, 'f1-score': 0.3459203887576505, 'support': 97520}, 'weighted avg': {'precision': 0.4311893038171835, 'recall': 0.41208982772764563, 'f1-score': 0.3488740899684738, 'support': 97520}}
[[23173   698  9036]
 [18885  1313 11604]
 [16301   809 15701]]
Evaluating performance on  val set...
114/114 - 1s - 861ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0832169
{'0': {'precision': 0.39260689655172415, 'recall': 0.716472009665727, 'f1-score': 0.50725309192002, 'support': 9932}, '1': {'precision': 0.35159010600706714, 'recall': 0.021981663536949077, 'f1-score': 0.04137644245763593, 'support': 9053}, '2': {'precision': 0.4365492008472944, 'recall': 0.44926674593737614, 'f1-score': 0.4428166813165348, 'support': 10092}, 'accuracy': 0.4075042129518176, 'macro avg': {'precision': 0.3935820678020286, 'recall': 0.39590680638001735, 'f1-score': 0.3304820718980636, 'support': 29077}, 'weighted avg': {'precision': 0.39508792039015717, 'recall': 0.4075042129518176, 'f1-score': 0.3398398937429957, 'support': 29077}}
[[7116  153 2663]
 [5665  199 3189]
 [5344  214 4534]]
training model: results/XRAY/W7/deepOF_L1/h50
Epoch 1/50
381/381 - 9s - loss: 3.3121 - accuracy50: 0.3610 - val_loss: 3.3092 - val_accuracy50: 0.3750 - 9s/epoch - 23ms/step
Epoch 2/50
381/381 - 7s - loss: 3.2801 - accuracy50: 0.3767 - val_loss: 3.2995 - val_accuracy50: 0.3754 - 7s/epoch - 17ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2690 - accuracy50: 0.3834 - val_loss: 3.2882 - val_accuracy50: 0.3830 - 7s/epoch - 18ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2615 - accuracy50: 0.3863 - val_loss: 3.2831 - val_accuracy50: 0.3848 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2553 - accuracy50: 0.3900 - val_loss: 3.2810 - val_accuracy50: 0.3831 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2506 - accuracy50: 0.3916 - val_loss: 3.2760 - val_accuracy50: 0.3870 - 7s/epoch - 18ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2468 - accuracy50: 0.3943 - val_loss: 3.2753 - val_accuracy50: 0.3877 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2453 - accuracy50: 0.3955 - val_loss: 3.2754 - val_accuracy50: 0.3872 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 6s - loss: 3.2413 - accuracy50: 0.3965 - val_loss: 3.2712 - val_accuracy50: 0.3924 - 6s/epoch - 17ms/step
Epoch 10/50
381/381 - 6s - loss: 3.2397 - accuracy50: 0.3979 - val_loss: 3.2726 - val_accuracy50: 0.3905 - 6s/epoch - 17ms/step
Epoch 11/50
381/381 - 6s - loss: 3.2387 - accuracy50: 0.3976 - val_loss: 3.2694 - val_accuracy50: 0.3913 - 6s/epoch - 16ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2352 - accuracy50: 0.4016 - val_loss: 3.2690 - val_accuracy50: 0.3911 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2349 - accuracy50: 0.4010 - val_loss: 3.2697 - val_accuracy50: 0.3904 - 6s/epoch - 17ms/step
Epoch 14/50
381/381 - 6s - loss: 3.2317 - accuracy50: 0.4023 - val_loss: 3.2695 - val_accuracy50: 0.3914 - 6s/epoch - 16ms/step
Epoch 15/50
381/381 - 6s - loss: 3.2293 - accuracy50: 0.4043 - val_loss: 3.2708 - val_accuracy50: 0.3903 - 6s/epoch - 17ms/step
Epoch 16/50
381/381 - 7s - loss: 3.2260 - accuracy50: 0.4062 - val_loss: 3.2696 - val_accuracy50: 0.3915 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 6s - loss: 3.2254 - accuracy50: 0.4067 - val_loss: 3.2689 - val_accuracy50: 0.3918 - 6s/epoch - 17ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2216 - accuracy50: 0.4105 - val_loss: 3.2710 - val_accuracy50: 0.3926 - 7s/epoch - 19ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2184 - accuracy50: 0.4111 - val_loss: 3.2747 - val_accuracy50: 0.3915 - 7s/epoch - 18ms/step
Epoch 20/50
381/381 - 7s - loss: 3.2168 - accuracy50: 0.4126 - val_loss: 3.2702 - val_accuracy50: 0.3901 - 7s/epoch - 18ms/step
Epoch 21/50
381/381 - 7s - loss: 3.2137 - accuracy50: 0.4159 - val_loss: 3.2745 - val_accuracy50: 0.3906 - 7s/epoch - 17ms/step
Epoch 22/50
381/381 - 7s - loss: 3.2117 - accuracy50: 0.4147 - val_loss: 3.2761 - val_accuracy50: 0.3877 - 7s/epoch - 17ms/step
Epoch 23/50
381/381 - 7s - loss: 3.2100 - accuracy50: 0.4174 - val_loss: 3.2783 - val_accuracy50: 0.3872 - 7s/epoch - 19ms/step
Epoch 24/50
381/381 - 7s - loss: 3.2050 - accuracy50: 0.4188 - val_loss: 3.2841 - val_accuracy50: 0.3865 - 7s/epoch - 18ms/step
Epoch 25/50
381/381 - 6s - loss: 3.2022 - accuracy50: 0.4205 - val_loss: 3.2807 - val_accuracy50: 0.3903 - 6s/epoch - 17ms/step
Epoch 26/50
381/381 - 7s - loss: 3.2000 - accuracy50: 0.4215 - val_loss: 3.2846 - val_accuracy50: 0.3868 - 7s/epoch - 17ms/step
Epoch 27/50
381/381 - 6s - loss: 3.1972 - accuracy50: 0.4229 - val_loss: 3.2883 - val_accuracy50: 0.3874 - 6s/epoch - 17ms/step
testing model: results/XRAY/W7/deepOF_L1/h50
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0990065
{'0': {'precision': 0.34717334227138147, 'recall': 0.6906620731808962, 'f1-score': 0.4620760801881093, 'support': 71986}, '1': {'precision': 0.40250498149729574, 'recall': 0.046800013239041933, 'f1-score': 0.08385056335244119, 'support': 90641}, '2': {'precision': 0.3857209031629708, 'recall': 0.43120045676045304, 'f1-score': 0.4071947136784823, 'support': 75313}, 'accuracy': 0.36326384802891487, 'macro avg': {'precision': 0.37846640897721606, 'recall': 0.3895541810601304, 'f1-score': 0.31770711907301097, 'support': 237940}, 'weighted avg': {'precision': 0.38045252006622204, 'recall': 0.36326384802891487, 'f1-score': 0.30062353153113136, 'support': 237940}}
[[49718  2686 19582]
 [54263  4242 32136]
 [39227  3611 32475]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799658
{'0': {'precision': 0.3886536984441705, 'recall': 0.6716053955613174, 'f1-score': 0.49237384023534736, 'support': 32397}, '1': {'precision': 0.44599514563106796, 'recall': 0.04531442663378545, 'f1-score': 0.08226997985224983, 'support': 32440}, '2': {'precision': 0.4173269527470516, 'recall': 0.48829666799253435, 'f1-score': 0.450031019119057, 'support': 32683}, 'accuracy': 0.4018355209187859, 'macro avg': {'precision': 0.41732526560743, 'recall': 0.40173883006254574, 'f1-score': 0.3415582797355514, 'support': 97520}, 'weighted avg': {'precision': 0.4173379121144332, 'recall': 0.4018355209187859, 'f1-score': 0.3417620718455668, 'support': 97520}}
[[21758   832  9807]
 [18495  1470 12475]
 [15730   994 15959]]
Evaluating performance on  val set...
114/114 - 1s - 799ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0900179
{'0': {'precision': 0.3782106533356318, 'recall': 0.6869129618033814, 'f1-score': 0.4878265703168428, 'support': 9582}, '1': {'precision': 0.3560500695410292, 'recall': 0.02670282674454991, 'f1-score': 0.04967979817581991, 'support': 9587}, '2': {'precision': 0.41460520310360566, 'recall': 0.4584174404521599, 'f1-score': 0.43541197334994963, 'support': 9908}, 'accuracy': 0.39137462599305295, 'macro avg': {'precision': 0.3829553086600889, 'recall': 0.3906777430000304, 'f1-score': 0.32430611394753744, 'support': 29077}, 'weighted avg': {'precision': 0.3833055284005364, 'recall': 0.39137462599305295, 'f1-score': 0.3255045655961369, 'support': 29077}}
[[6582  198 2802]
 [5720  256 3611]
 [5101  265 4542]]
training model: results/XRAY/W7/deepOF_L1/h100
Epoch 1/50
381/381 - 10s - loss: 3.3263 - accuracy100: 0.3489 - val_loss: 3.3298 - val_accuracy100: 0.3541 - 10s/epoch - 25ms/step
Epoch 2/50
381/381 - 7s - loss: 3.2995 - accuracy100: 0.3583 - val_loss: 3.3104 - val_accuracy100: 0.3626 - 7s/epoch - 19ms/step
Epoch 3/50
381/381 - 7s - loss: 3.2872 - accuracy100: 0.3686 - val_loss: 3.3074 - val_accuracy100: 0.3617 - 7s/epoch - 19ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2799 - accuracy100: 0.3706 - val_loss: 3.3020 - val_accuracy100: 0.3645 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2756 - accuracy100: 0.3759 - val_loss: 3.2986 - val_accuracy100: 0.3686 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2718 - accuracy100: 0.3781 - val_loss: 3.2964 - val_accuracy100: 0.3684 - 7s/epoch - 19ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2689 - accuracy100: 0.3790 - val_loss: 3.2964 - val_accuracy100: 0.3692 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2660 - accuracy100: 0.3832 - val_loss: 3.2933 - val_accuracy100: 0.3708 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2643 - accuracy100: 0.3840 - val_loss: 3.2901 - val_accuracy100: 0.3741 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2619 - accuracy100: 0.3843 - val_loss: 3.2922 - val_accuracy100: 0.3696 - 7s/epoch - 17ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2606 - accuracy100: 0.3853 - val_loss: 3.2920 - val_accuracy100: 0.3697 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 7s - loss: 3.2583 - accuracy100: 0.3882 - val_loss: 3.2928 - val_accuracy100: 0.3715 - 7s/epoch - 17ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2546 - accuracy100: 0.3895 - val_loss: 3.2919 - val_accuracy100: 0.3709 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.2555 - accuracy100: 0.3892 - val_loss: 3.2941 - val_accuracy100: 0.3714 - 7s/epoch - 18ms/step
Epoch 15/50
381/381 - 7s - loss: 3.2521 - accuracy100: 0.3903 - val_loss: 3.2934 - val_accuracy100: 0.3737 - 7s/epoch - 17ms/step
Epoch 16/50
381/381 - 6s - loss: 3.2513 - accuracy100: 0.3915 - val_loss: 3.2930 - val_accuracy100: 0.3717 - 6s/epoch - 17ms/step
Epoch 17/50
381/381 - 6s - loss: 3.2493 - accuracy100: 0.3916 - val_loss: 3.2933 - val_accuracy100: 0.3713 - 6s/epoch - 17ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2494 - accuracy100: 0.3922 - val_loss: 3.2953 - val_accuracy100: 0.3728 - 7s/epoch - 17ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2463 - accuracy100: 0.3934 - val_loss: 3.2945 - val_accuracy100: 0.3732 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepOF_L1/h100
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977281
{'0': {'precision': 0.35875519095054903, 'recall': 0.7138095781216338, 'f1-score': 0.4775150161288272, 'support': 78909}, '1': {'precision': 0.3357763300760043, 'recall': 0.04730039767513001, 'f1-score': 0.08291996246145597, 'support': 78456}, '2': {'precision': 0.3969864346631561, 'recall': 0.34431275209432205, 'f1-score': 0.3687782053582704, 'support': 80575}, 'accuracy': 0.36891653357989407, 'macro avg': {'precision': 0.3638393185632365, 'recall': 0.368474242630362, 'f1-score': 0.3097377279828512, 'support': 237940}, 'weighted avg': {'precision': 0.36412483436220755, 'recall': 0.36891653357989407, 'f1-score': 0.31058294057043057, 'support': 237940}}
[[56326  3239 19344]
 [51948  3711 22797]
 [48730  4102 27743]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918745
{'0': {'precision': 0.3654428730634604, 'recall': 0.7175836030204962, 'f1-score': 0.4842648251762797, 'support': 32445}, '1': {'precision': 0.39882854100106496, 'recall': 0.04646113764654798, 'f1-score': 0.08322684593588532, 'support': 32242}, '2': {'precision': 0.39983363832972885, 'recall': 0.3660037157737642, 'f1-score': 0.38217147945554, 'support': 32833}, 'accuracy': 0.3773277276456112, 'macro avg': {'precision': 0.3880350174647514, 'recall': 0.3766828188136028, 'f1-score': 0.3165543835225683, 'support': 97520}, 'weighted avg': {'precision': 0.38805949223523684, 'recall': 0.3773277276456112, 'f1-score': 0.3173011526299524, 'support': 97520}}
[[23282  1010  8153]
 [20859  1498  9885]
 [19568  1248 12017]]
Evaluating performance on  val set...
114/114 - 1s - 858ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978757
{'0': {'precision': 0.3579803901748711, 'recall': 0.7353612956810631, 'f1-score': 0.4815419131144198, 'support': 9632}, '1': {'precision': 0.33370165745856356, 'recall': 0.0324591573516767, 'f1-score': 0.059163483201097065, 'support': 9304}, '2': {'precision': 0.4034104459813976, 'recall': 0.33359629227886795, 'f1-score': 0.36519673989312895, 'support': 10141}, 'accuracy': 0.37032706262681847, 'macro avg': {'precision': 0.3650308312049441, 'recall': 0.36713891510386926, 'f1-score': 0.30196737873621526, 'support': 29077}, 'weighted avg': {'precision': 0.3660560811588605, 'recall': 0.37032706262681847, 'f1-score': 0.3058131476451257, 'support': 29077}}
[[7083  269 2280]
 [6279  302 2723]
 [6424  334 3383]]
training model: results/XRAY/W7/deepOF_L1/h200
Epoch 1/50
381/381 - 9s - loss: 3.3377 - accuracy200: 0.3407 - val_loss: 3.3486 - val_accuracy200: 0.3372 - 9s/epoch - 23ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3117 - accuracy200: 0.3482 - val_loss: 3.3313 - val_accuracy200: 0.3435 - 7s/epoch - 19ms/step
Epoch 3/50
381/381 - 7s - loss: 3.3004 - accuracy200: 0.3521 - val_loss: 3.3281 - val_accuracy200: 0.3410 - 7s/epoch - 18ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2946 - accuracy200: 0.3556 - val_loss: 3.3209 - val_accuracy200: 0.3422 - 7s/epoch - 19ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2889 - accuracy200: 0.3606 - val_loss: 3.3180 - val_accuracy200: 0.3435 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2864 - accuracy200: 0.3619 - val_loss: 3.3148 - val_accuracy200: 0.3457 - 7s/epoch - 19ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2825 - accuracy200: 0.3657 - val_loss: 3.3104 - val_accuracy200: 0.3451 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2814 - accuracy200: 0.3656 - val_loss: 3.3087 - val_accuracy200: 0.3462 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2789 - accuracy200: 0.3683 - val_loss: 3.3073 - val_accuracy200: 0.3483 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2769 - accuracy200: 0.3692 - val_loss: 3.3057 - val_accuracy200: 0.3493 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2759 - accuracy200: 0.3696 - val_loss: 3.3058 - val_accuracy200: 0.3452 - 7s/epoch - 18ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2737 - accuracy200: 0.3716 - val_loss: 3.3087 - val_accuracy200: 0.3463 - 6s/epoch - 16ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2723 - accuracy200: 0.3753 - val_loss: 3.3042 - val_accuracy200: 0.3507 - 7s/epoch - 18ms/step
Epoch 14/50
381/381 - 7s - loss: 3.2695 - accuracy200: 0.3753 - val_loss: 3.3091 - val_accuracy200: 0.3467 - 7s/epoch - 18ms/step
Epoch 15/50
381/381 - 7s - loss: 3.2675 - accuracy200: 0.3765 - val_loss: 3.3083 - val_accuracy200: 0.3462 - 7s/epoch - 18ms/step
Epoch 16/50
381/381 - 7s - loss: 3.2659 - accuracy200: 0.3776 - val_loss: 3.3075 - val_accuracy200: 0.3500 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 7s - loss: 3.2646 - accuracy200: 0.3785 - val_loss: 3.3114 - val_accuracy200: 0.3481 - 7s/epoch - 17ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2617 - accuracy200: 0.3814 - val_loss: 3.3090 - val_accuracy200: 0.3491 - 7s/epoch - 18ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2600 - accuracy200: 0.3840 - val_loss: 3.3082 - val_accuracy200: 0.3502 - 7s/epoch - 18ms/step
Epoch 20/50
381/381 - 7s - loss: 3.2584 - accuracy200: 0.3832 - val_loss: 3.3138 - val_accuracy200: 0.3484 - 7s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.2582 - accuracy200: 0.3849 - val_loss: 3.3122 - val_accuracy200: 0.3507 - 7s/epoch - 17ms/step
Epoch 22/50
381/381 - 7s - loss: 3.2552 - accuracy200: 0.3867 - val_loss: 3.3160 - val_accuracy200: 0.3475 - 7s/epoch - 18ms/step
Epoch 23/50
381/381 - 7s - loss: 3.2535 - accuracy200: 0.3870 - val_loss: 3.3152 - val_accuracy200: 0.3508 - 7s/epoch - 19ms/step
testing model: results/XRAY/W7/deepOF_L1/h200
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024418
{'0': {'precision': 0.33932198282356485, 'recall': 0.7292910713591793, 'f1-score': 0.46315079423837846, 'support': 77201}, '1': {'precision': 0.36294555816627505, 'recall': 0.08761661095086953, 'f1-score': 0.14115725618292116, 'support': 82861}, '2': {'precision': 0.36778051218949476, 'recall': 0.2456277767790647, 'f1-score': 0.29454153514512277, 'support': 77878}, 'accuracy': 0.3475287887702782, 'macro avg': {'precision': 0.3566826843931115, 'recall': 0.3541784863630378, 'f1-score': 0.2996165285221408, 'support': 237940}, 'weighted avg': {'precision': 0.3568632387134203, 'recall': 0.3475287887702782, 'f1-score': 0.29583273743213395, 'support': 237940}}
[[56302  6114 14785]
 [57503  7260 18098]
 [52120  6629 19129]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924524
{'0': {'precision': 0.35462212519065706, 'recall': 0.7331210584889328, 'f1-score': 0.4780189877244965, 'support': 32348}, '1': {'precision': 0.3962041884816754, 'recall': 0.0942374147753806, 'f1-score': 0.15225975201830938, 'support': 32121}, '2': {'precision': 0.39667912718421283, 'recall': 0.2761187256058818, 'f1-score': 0.3255971600335373, 'support': 33051}, 'accuracy': 0.3678014766201805, 'macro avg': {'precision': 0.38250181361884844, 'recall': 0.36782573295673177, 'f1-score': 0.31862529992544775, 'support': 97520}, 'weighted avg': {'precision': 0.38257211932375607, 'recall': 0.3678014766201805, 'f1-score': 0.31906281220016997, 'support': 97520}}
[[23715  2199  6434]
 [21648  3027  7446]
 [21511  2414  9126]]
Evaluating performance on  val set...
114/114 - 1s - 921ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1018409
{'0': {'precision': 0.3400286944045911, 'recall': 0.7476340694006309, 'f1-score': 0.46745562130177515, 'support': 9510}, '1': {'precision': 0.3313953488372093, 'recall': 0.06637027627818355, 'f1-score': 0.11059176294205839, 'support': 9447}, '2': {'precision': 0.3783266932270916, 'recall': 0.23458498023715416, 'f1-score': 0.2896004879536444, 'support': 10120}, 'accuracy': 0.3477318843071844, 'macro avg': {'precision': 0.34991691215629733, 'recall': 0.34952977530532287, 'f1-score': 0.2892159573991593, 'support': 29077}, 'weighted avg': {'precision': 0.35055304466454396, 'recall': 0.3477318843071844, 'f1-score': 0.28961104244538255, 'support': 29077}}
[[7110  580 1820]
 [6739  627 2081]
 [7061  685 2374]]
training model: results/XRAY/W7/deepOF_L1/h300
Epoch 1/50
381/381 - 9s - loss: 3.3399 - accuracy300: 0.3364 - val_loss: 3.3524 - val_accuracy300: 0.3258 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3178 - accuracy300: 0.3427 - val_loss: 3.3347 - val_accuracy300: 0.3331 - 7s/epoch - 18ms/step
Epoch 3/50
381/381 - 7s - loss: 3.3061 - accuracy300: 0.3462 - val_loss: 3.3300 - val_accuracy300: 0.3309 - 7s/epoch - 19ms/step
Epoch 4/50
381/381 - 7s - loss: 3.2998 - accuracy300: 0.3480 - val_loss: 3.3259 - val_accuracy300: 0.3314 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2951 - accuracy300: 0.3523 - val_loss: 3.3240 - val_accuracy300: 0.3325 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2922 - accuracy300: 0.3574 - val_loss: 3.3186 - val_accuracy300: 0.3307 - 7s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2892 - accuracy300: 0.3575 - val_loss: 3.3162 - val_accuracy300: 0.3334 - 7s/epoch - 17ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2862 - accuracy300: 0.3623 - val_loss: 3.3151 - val_accuracy300: 0.3338 - 7s/epoch - 17ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2851 - accuracy300: 0.3635 - val_loss: 3.3139 - val_accuracy300: 0.3351 - 7s/epoch - 17ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2832 - accuracy300: 0.3634 - val_loss: 3.3142 - val_accuracy300: 0.3355 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 7s - loss: 3.2818 - accuracy300: 0.3640 - val_loss: 3.3139 - val_accuracy300: 0.3326 - 7s/epoch - 17ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2797 - accuracy300: 0.3666 - val_loss: 3.3129 - val_accuracy300: 0.3363 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2771 - accuracy300: 0.3698 - val_loss: 3.3121 - val_accuracy300: 0.3345 - 6s/epoch - 17ms/step
Epoch 14/50
381/381 - 6s - loss: 3.2760 - accuracy300: 0.3693 - val_loss: 3.3164 - val_accuracy300: 0.3341 - 6s/epoch - 17ms/step
Epoch 15/50
381/381 - 6s - loss: 3.2733 - accuracy300: 0.3741 - val_loss: 3.3151 - val_accuracy300: 0.3338 - 6s/epoch - 16ms/step
Epoch 16/50
381/381 - 6s - loss: 3.2725 - accuracy300: 0.3728 - val_loss: 3.3154 - val_accuracy300: 0.3378 - 6s/epoch - 17ms/step
Epoch 17/50
381/381 - 7s - loss: 3.2711 - accuracy300: 0.3736 - val_loss: 3.3153 - val_accuracy300: 0.3368 - 7s/epoch - 17ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2698 - accuracy300: 0.3750 - val_loss: 3.3161 - val_accuracy300: 0.3351 - 7s/epoch - 17ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2677 - accuracy300: 0.3786 - val_loss: 3.3177 - val_accuracy300: 0.3334 - 7s/epoch - 17ms/step
Epoch 20/50
381/381 - 6s - loss: 3.2664 - accuracy300: 0.3787 - val_loss: 3.3202 - val_accuracy300: 0.3358 - 6s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.2642 - accuracy300: 0.3804 - val_loss: 3.3170 - val_accuracy300: 0.3386 - 7s/epoch - 17ms/step
Epoch 22/50
381/381 - 7s - loss: 3.2637 - accuracy300: 0.3811 - val_loss: 3.3198 - val_accuracy300: 0.3356 - 7s/epoch - 17ms/step
Epoch 23/50
381/381 - 6s - loss: 3.2598 - accuracy300: 0.3849 - val_loss: 3.3215 - val_accuracy300: 0.3340 - 6s/epoch - 17ms/step
testing model: results/XRAY/W7/deepOF_L1/h300
Evaluating performance on  test set...
930/930 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039579
{'0': {'precision': 0.3360053478380108, 'recall': 0.7549972398033199, 'f1-score': 0.46504584507961105, 'support': 77893}, '1': {'precision': 0.3508579272477694, 'recall': 0.06331277402095564, 'f1-score': 0.10726875944267249, 'support': 80742}, '2': {'precision': 0.35930583709096925, 'recall': 0.21904041359308996, 'f1-score': 0.27216394701177427, 'support': 79305}, 'accuracy': 0.3416491552492225, 'macro avg': {'precision': 0.3487230373922498, 'recall': 0.3457834758057885, 'f1-score': 0.2814928505113526, 'support': 237940}, 'weighted avg': {'precision': 0.348811400905627, 'recall': 0.3416491552492225, 'f1-score': 0.2793513995270873, 'support': 237940}}
[[58809  4595 14489]
 [59144  5112 16486]
 [57071  4863 17371]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095003
{'0': {'precision': 0.3477534634981682, 'recall': 0.7685030088715181, 'f1-score': 0.47883186285405044, 'support': 32238}, '1': {'precision': 0.40236898779612346, 'recall': 0.0696316541400087, 'f1-score': 0.11871855970346837, 'support': 32198}, '2': {'precision': 0.39459067858005314, 'recall': 0.24694716479264903, 'f1-score': 0.30377958318615333, 'support': 33084}, 'accuracy': 0.360818293683347, 'macro avg': {'precision': 0.3815710432914483, 'recall': 0.3616939426013919, 'f1-score': 0.30044333524789074, 'support': 97520}, 'weighted avg': {'precision': 0.38167545975652184, 'recall': 0.360818293683347, 'f1-score': 0.30054681614183604, 'support': 97520}}
[[24775  1570  5893]
 [23314  2242  6642]
 [23154  1760  8170]]
Evaluating performance on  val set...
114/114 - 1s - 965ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048918
{'0': {'precision': 0.3280817253121453, 'recall': 0.7839861126179885, 'f1-score': 0.4625824210998015, 'support': 9217}, '1': {'precision': 0.33914863921842286, 'recall': 0.04945558156100539, 'f1-score': 0.08632326820603908, 'support': 9827}, '2': {'precision': 0.36768108204306815, 'recall': 0.20592046247383633, 'f1-score': 0.26399182213135697, 'support': 10033}, 'accuracy': 0.3362795336520274, 'macro avg': {'precision': 0.3449704821912121, 'recall': 0.34645405221761005, 'f1-score': 0.2709658371457325, 'support': 29077}, 'weighted avg': {'precision': 0.3454856840781232, 'recall': 0.3362795336520274, 'f1-score': 0.2668965465275483, 'support': 29077}}
[[7226  412 1579]
 [7367  486 1974]
 [7432  535 2066]]
training model: results/XRAY/W7/deepOF_L1/h500
Epoch 1/50
381/381 - 9s - loss: 3.3424 - accuracy500: 0.3367 - val_loss: 3.3621 - val_accuracy500: 0.3164 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 7s - loss: 3.3205 - accuracy500: 0.3409 - val_loss: 3.3463 - val_accuracy500: 0.3144 - 7s/epoch - 18ms/step
Epoch 3/50
381/381 - 7s - loss: 3.3108 - accuracy500: 0.3428 - val_loss: 3.3361 - val_accuracy500: 0.3147 - 7s/epoch - 18ms/step
Epoch 4/50
381/381 - 7s - loss: 3.3047 - accuracy500: 0.3443 - val_loss: 3.3305 - val_accuracy500: 0.3154 - 7s/epoch - 18ms/step
Epoch 5/50
381/381 - 7s - loss: 3.2983 - accuracy500: 0.3501 - val_loss: 3.3271 - val_accuracy500: 0.3159 - 7s/epoch - 18ms/step
Epoch 6/50
381/381 - 7s - loss: 3.2962 - accuracy500: 0.3511 - val_loss: 3.3233 - val_accuracy500: 0.3169 - 7s/epoch - 18ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2932 - accuracy500: 0.3551 - val_loss: 3.3206 - val_accuracy500: 0.3187 - 7s/epoch - 18ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2910 - accuracy500: 0.3560 - val_loss: 3.3186 - val_accuracy500: 0.3170 - 7s/epoch - 18ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2891 - accuracy500: 0.3559 - val_loss: 3.3172 - val_accuracy500: 0.3206 - 7s/epoch - 18ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2882 - accuracy500: 0.3584 - val_loss: 3.3156 - val_accuracy500: 0.3202 - 7s/epoch - 17ms/step
Epoch 11/50
381/381 - 6s - loss: 3.2866 - accuracy500: 0.3599 - val_loss: 3.3155 - val_accuracy500: 0.3194 - 6s/epoch - 17ms/step
Epoch 12/50
381/381 - 7s - loss: 3.2847 - accuracy500: 0.3623 - val_loss: 3.3152 - val_accuracy500: 0.3210 - 7s/epoch - 17ms/step
Epoch 13/50
381/381 - 6s - loss: 3.2831 - accuracy500: 0.3642 - val_loss: 3.3145 - val_accuracy500: 0.3191 - 6s/epoch - 17ms/step
Epoch 14/50
381/381 - 7s - loss: 3.2823 - accuracy500: 0.3636 - val_loss: 3.3123 - val_accuracy500: 0.3263 - 7s/epoch - 17ms/step
Epoch 15/50
381/381 - 7s - loss: 3.2811 - accuracy500: 0.3648 - val_loss: 3.3139 - val_accuracy500: 0.3223 - 7s/epoch - 17ms/step
Epoch 16/50
381/381 - 6s - loss: 3.2775 - accuracy500: 0.3667 - val_loss: 3.3123 - val_accuracy500: 0.3271 - 6s/epoch - 16ms/step
Epoch 17/50
381/381 - 6s - loss: 3.2774 - accuracy500: 0.3680 - val_loss: 3.3165 - val_accuracy500: 0.3222 - 6s/epoch - 16ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2760 - accuracy500: 0.3675 - val_loss: 3.3156 - val_accuracy500: 0.3224 - 7s/epoch - 18ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2745 - accuracy500: 0.3728 - val_loss: 3.3171 - val_accuracy500: 0.3221 - 7s/epoch - 18ms/step
Epoch 20/50
381/381 - 7s - loss: 3.2728 - accuracy500: 0.3739 - val_loss: 3.3164 - val_accuracy500: 0.3237 - 7s/epoch - 17ms/step
Epoch 21/50
381/381 - 7s - loss: 3.2718 - accuracy500: 0.3741 - val_loss: 3.3201 - val_accuracy500: 0.3223 - 7s/epoch - 18ms/step
Epoch 22/50
381/381 - 7s - loss: 3.2699 - accuracy500: 0.3760 - val_loss: 3.3188 - val_accuracy500: 0.3243 - 7s/epoch - 18ms/step
Epoch 23/50
381/381 - 7s - loss: 3.2665 - accuracy500: 0.3773 - val_loss: 3.3188 - val_accuracy500: 0.3229 - 7s/epoch - 18ms/step
Epoch 24/50
381/381 - 7s - loss: 3.2655 - accuracy500: 0.3776 - val_loss: 3.3216 - val_accuracy500: 0.3245 - 7s/epoch - 18ms/step
testing model: results/XRAY/W7/deepOF_L1/h500
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032453
{'0': {'precision': 0.3301610457636464, 'recall': 0.7434590861473597, 'f1-score': 0.45725899146094584, 'support': 77321}, '1': {'precision': 0.35523624207952903, 'recall': 0.08744994964258518, 'f1-score': 0.14034949389420565, 'support': 81418}, '2': {'precision': 0.3542765787370104, 'recall': 0.19585611292786706, 'f1-score': 0.25225635438179955, 'support': 79201}, 'accuracy': 0.33671093552996556, 'macro avg': {'precision': 0.34655795552672863, 'recall': 0.342255049572604, 'f1-score': 0.28328827991231703, 'support': 237940}, 'weighted avg': {'precision': 0.34676836971367553, 'recall': 0.33671093552996556, 'f1-score': 0.2805818823906158, 'support': 237940}}
[[57485  6411 13425]
 [59450  7120 14848]
 [57177  6512 15512]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096053
{'0': {'precision': 0.34310411702776084, 'recall': 0.7709163346613546, 'f1-score': 0.47486483377430116, 'support': 32128}, '1': {'precision': 0.40104696815471863, 'recall': 0.08566813691992296, 'f1-score': 0.14117887947582605, 'support': 32194}, '2': {'precision': 0.38352749932267677, 'recall': 0.21320561479607206, 'f1-score': 0.2740595899560529, 'support': 33198}, 'accuracy': 0.3548400328137818, 'macro avg': {'precision': 0.37589286150171874, 'recall': 0.3565966954591165, 'f1-score': 0.29670110106872666, 'support': 97520}, 'weighted avg': {'precision': 0.37599365347780084, 'recall': 0.3548400328137818, 'f1-score': 0.29634742096704814, 'support': 97520}}
[[24768  1989  5371]
 [23430  2758  6006]
 [23990  2130  7078]]
Evaluating performance on  val set...
114/114 - 1s - 923ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055928
{'0': {'precision': 0.3090046120091345, 'recall': 0.7879652888787394, 'f1-score': 0.4439226785886591, 'support': 8758}, '1': {'precision': 0.3716497915425849, 'recall': 0.06169055857637173, 'f1-score': 0.10581651687298627, 'support': 10115}, '2': {'precision': 0.3776900296150049, 'recall': 0.18747549980399844, 'f1-score': 0.2505730565197459, 'support': 10204}, 'accuracy': 0.3245864428930082, 'macro avg': {'precision': 0.3527814777222414, 'recall': 0.34571044908636983, 'f1-score': 0.26677075066046374, 'support': 29077}, 'weighted avg': {'precision': 0.3549007495828578, 'recall': 0.3245864428930082, 'f1-score': 0.25845363538113353, 'support': 29077}}
[[6901  456 1401]
 [7740  624 1751]
 [7692  599 1913]]
training model: results/XRAY/W7/deepOF_L1/h1000
Epoch 1/50
381/381 - 9s - loss: 3.3424 - accuracy1000: 0.3424 - val_loss: 3.3733 - val_accuracy1000: 0.3166 - 9s/epoch - 24ms/step
Epoch 2/50
381/381 - 6s - loss: 3.3219 - accuracy1000: 0.3452 - val_loss: 3.3654 - val_accuracy1000: 0.3126 - 6s/epoch - 17ms/step
Epoch 3/50
381/381 - 7s - loss: 3.3111 - accuracy1000: 0.3469 - val_loss: 3.3479 - val_accuracy1000: 0.3132 - 7s/epoch - 17ms/step
Epoch 4/50
381/381 - 6s - loss: 3.3059 - accuracy1000: 0.3526 - val_loss: 3.3374 - val_accuracy1000: 0.3131 - 6s/epoch - 16ms/step
Epoch 5/50
381/381 - 6s - loss: 3.3004 - accuracy1000: 0.3531 - val_loss: 3.3291 - val_accuracy1000: 0.3151 - 6s/epoch - 17ms/step
Epoch 6/50
381/381 - 6s - loss: 3.2972 - accuracy1000: 0.3555 - val_loss: 3.3235 - val_accuracy1000: 0.3147 - 6s/epoch - 17ms/step
Epoch 7/50
381/381 - 7s - loss: 3.2953 - accuracy1000: 0.3584 - val_loss: 3.3194 - val_accuracy1000: 0.3171 - 7s/epoch - 17ms/step
Epoch 8/50
381/381 - 7s - loss: 3.2927 - accuracy1000: 0.3582 - val_loss: 3.3125 - val_accuracy1000: 0.3202 - 7s/epoch - 17ms/step
Epoch 9/50
381/381 - 7s - loss: 3.2902 - accuracy1000: 0.3627 - val_loss: 3.3131 - val_accuracy1000: 0.3203 - 7s/epoch - 17ms/step
Epoch 10/50
381/381 - 7s - loss: 3.2894 - accuracy1000: 0.3613 - val_loss: 3.3119 - val_accuracy1000: 0.3233 - 7s/epoch - 18ms/step
Epoch 11/50
381/381 - 6s - loss: 3.2876 - accuracy1000: 0.3618 - val_loss: 3.3104 - val_accuracy1000: 0.3216 - 6s/epoch - 17ms/step
Epoch 12/50
381/381 - 6s - loss: 3.2866 - accuracy1000: 0.3623 - val_loss: 3.3107 - val_accuracy1000: 0.3231 - 6s/epoch - 17ms/step
Epoch 13/50
381/381 - 7s - loss: 3.2844 - accuracy1000: 0.3646 - val_loss: 3.3084 - val_accuracy1000: 0.3213 - 7s/epoch - 17ms/step
Epoch 14/50
381/381 - 7s - loss: 3.2828 - accuracy1000: 0.3670 - val_loss: 3.3111 - val_accuracy1000: 0.3234 - 7s/epoch - 17ms/step
Epoch 15/50
381/381 - 6s - loss: 3.2819 - accuracy1000: 0.3665 - val_loss: 3.3094 - val_accuracy1000: 0.3264 - 6s/epoch - 17ms/step
Epoch 16/50
381/381 - 7s - loss: 3.2800 - accuracy1000: 0.3704 - val_loss: 3.3110 - val_accuracy1000: 0.3250 - 7s/epoch - 18ms/step
Epoch 17/50
381/381 - 7s - loss: 3.2781 - accuracy1000: 0.3712 - val_loss: 3.3119 - val_accuracy1000: 0.3233 - 7s/epoch - 17ms/step
Epoch 18/50
381/381 - 7s - loss: 3.2766 - accuracy1000: 0.3715 - val_loss: 3.3118 - val_accuracy1000: 0.3257 - 7s/epoch - 18ms/step
Epoch 19/50
381/381 - 7s - loss: 3.2760 - accuracy1000: 0.3727 - val_loss: 3.3110 - val_accuracy1000: 0.3285 - 7s/epoch - 19ms/step
Epoch 20/50
381/381 - 7s - loss: 3.2736 - accuracy1000: 0.3763 - val_loss: 3.3129 - val_accuracy1000: 0.3266 - 7s/epoch - 18ms/step
Epoch 21/50
381/381 - 7s - loss: 3.2724 - accuracy1000: 0.3756 - val_loss: 3.3124 - val_accuracy1000: 0.3279 - 7s/epoch - 18ms/step
Epoch 22/50
381/381 - 7s - loss: 3.2694 - accuracy1000: 0.3785 - val_loss: 3.3155 - val_accuracy1000: 0.3268 - 7s/epoch - 18ms/step
Epoch 23/50
381/381 - 7s - loss: 3.2691 - accuracy1000: 0.3774 - val_loss: 3.3171 - val_accuracy1000: 0.3230 - 7s/epoch - 19ms/step
testing model: results/XRAY/W7/deepOF_L1/h1000
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027708
{'0': {'precision': 0.3263154110697039, 'recall': 0.7103969113177768, 'f1-score': 0.4472088449869238, 'support': 76667}, '1': {'precision': 0.3656468431305145, 'recall': 0.11552385779451162, 'f1-score': 0.17557566920685574, 'support': 82866}, '2': {'precision': 0.34494905580451696, 'recall': 0.1973293200862168, 'f1-score': 0.25104656822975824, 'support': 78407}, 'accuracy': 0.3341556694965117, 'macro avg': {'precision': 0.34563710333491177, 'recall': 0.34108336306616843, 'f1-score': 0.2912770274745126, 'support': 237940}, 'weighted avg': {'precision': 0.3461533812801503, 'recall': 0.3341556694965117, 'f1-score': 0.2879684886874777, 'support': 237940}}
[[54464  8343 13860]
 [57772  9573 15521]
 [54670  8265 15472]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957637
{'0': {'precision': 0.34260891821180756, 'recall': 0.7508101707590676, 'f1-score': 0.4705135715680531, 'support': 32092}, '1': {'precision': 0.40755566675006255, 'recall': 0.10114557138865606, 'f1-score': 0.16206939435393608, 'support': 32211}, '2': {'precision': 0.3831649130117721, 'recall': 0.2214528705181082, 'f1-score': 0.280683010588572, 'support': 33217}, 'accuracy': 0.3559167350287121, 'macro avg': {'precision': 0.3777764993245474, 'recall': 0.3578028708886107, 'f1-score': 0.3044219921701871, 'support': 97520}, 'weighted avg': {'precision': 0.3778749989792004, 'recall': 0.3559167350287121, 'f1-score': 0.30397442948130843, 'support': 97520}}
[[24095  2337  5660]
 [22771  3258  6182]
 [23462  2399  7356]]
Evaluating performance on  val set...
114/114 - 1s - 929ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042084
{'0': {'precision': 0.310117472257046, 'recall': 0.7588910351096466, 'f1-score': 0.4403058870063946, 'support': 8801}, '1': {'precision': 0.35148042024832854, 'recall': 0.07747368421052632, 'f1-score': 0.1269622218388822, 'support': 9500}, '2': {'precision': 0.38578773411678297, 'recall': 0.19497030438010393, 'f1-score': 0.25903094562939216, 'support': 10776}, 'accuracy': 0.3272689754789008, 'macro avg': {'precision': 0.3491285422073858, 'recall': 0.34377834123342565, 'f1-score': 0.27543301815822296, 'support': 29077}, 'weighted avg': {'precision': 0.3516750864441255, 'recall': 0.3272689754789008, 'f1-score': 0.27074975716597277, 'support': 29077}}
[[6679  598 1524]
 [6943  736 1821]
 [7915  760 2101]]
training model: results/XRAY/W7/deepLOB_L2/h10
Epoch 1/50
381/381 - 20s - loss: 3.3246 - accuracy10: 0.3636 - val_loss: 3.4089 - val_accuracy10: 0.3503 - 20s/epoch - 51ms/step
Epoch 2/50
381/381 - 16s - loss: 3.2486 - accuracy10: 0.3976 - val_loss: 3.3727 - val_accuracy10: 0.3696 - 16s/epoch - 43ms/step
Epoch 3/50
381/381 - 16s - loss: 3.1593 - accuracy10: 0.4404 - val_loss: 3.5326 - val_accuracy10: 0.3659 - 16s/epoch - 43ms/step
Epoch 4/50
381/381 - 16s - loss: 3.1189 - accuracy10: 0.4573 - val_loss: 3.4843 - val_accuracy10: 0.3642 - 16s/epoch - 43ms/step
Epoch 5/50
381/381 - 16s - loss: 3.0947 - accuracy10: 0.4648 - val_loss: 3.5247 - val_accuracy10: 0.3804 - 16s/epoch - 43ms/step
Epoch 6/50
381/381 - 16s - loss: 3.0723 - accuracy10: 0.4712 - val_loss: 3.5622 - val_accuracy10: 0.3779 - 16s/epoch - 43ms/step
Epoch 7/50
381/381 - 16s - loss: 3.0594 - accuracy10: 0.4754 - val_loss: 3.5003 - val_accuracy10: 0.3816 - 16s/epoch - 43ms/step
Epoch 8/50
381/381 - 17s - loss: 3.0448 - accuracy10: 0.4812 - val_loss: 3.3983 - val_accuracy10: 0.3919 - 17s/epoch - 45ms/step
Epoch 9/50
381/381 - 17s - loss: 3.0367 - accuracy10: 0.4826 - val_loss: 3.3290 - val_accuracy10: 0.3943 - 17s/epoch - 44ms/step
Epoch 10/50
381/381 - 17s - loss: 3.0257 - accuracy10: 0.4867 - val_loss: 3.3165 - val_accuracy10: 0.3982 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 16s - loss: 3.0178 - accuracy10: 0.4879 - val_loss: 3.3589 - val_accuracy10: 0.3926 - 16s/epoch - 43ms/step
Epoch 12/50
381/381 - 16s - loss: 3.0094 - accuracy10: 0.4910 - val_loss: 3.2954 - val_accuracy10: 0.3970 - 16s/epoch - 43ms/step
Epoch 13/50
381/381 - 16s - loss: 2.9982 - accuracy10: 0.4952 - val_loss: 3.3719 - val_accuracy10: 0.3980 - 16s/epoch - 43ms/step
Epoch 14/50
381/381 - 17s - loss: 2.9914 - accuracy10: 0.4959 - val_loss: 3.2664 - val_accuracy10: 0.4031 - 17s/epoch - 43ms/step
Epoch 15/50
381/381 - 17s - loss: 2.9843 - accuracy10: 0.4986 - val_loss: 3.4612 - val_accuracy10: 0.3820 - 17s/epoch - 43ms/step
Epoch 16/50
381/381 - 16s - loss: 2.9748 - accuracy10: 0.5003 - val_loss: 3.4103 - val_accuracy10: 0.3908 - 16s/epoch - 43ms/step
Epoch 17/50
381/381 - 16s - loss: 2.9695 - accuracy10: 0.5039 - val_loss: 3.3862 - val_accuracy10: 0.3888 - 16s/epoch - 43ms/step
Epoch 18/50
381/381 - 16s - loss: 2.9606 - accuracy10: 0.5052 - val_loss: 3.3549 - val_accuracy10: 0.3963 - 16s/epoch - 43ms/step
Epoch 19/50
381/381 - 17s - loss: 2.9555 - accuracy10: 0.5060 - val_loss: 3.3599 - val_accuracy10: 0.3932 - 17s/epoch - 43ms/step
Epoch 20/50
381/381 - 17s - loss: 2.9449 - accuracy10: 0.5099 - val_loss: 3.3276 - val_accuracy10: 0.4011 - 17s/epoch - 44ms/step
Epoch 21/50
381/381 - 17s - loss: 2.9367 - accuracy10: 0.5116 - val_loss: 3.3254 - val_accuracy10: 0.4022 - 17s/epoch - 43ms/step
Epoch 22/50
381/381 - 17s - loss: 2.9297 - accuracy10: 0.5123 - val_loss: 3.3089 - val_accuracy10: 0.3966 - 17s/epoch - 46ms/step
Epoch 23/50
381/381 - 17s - loss: 2.9205 - accuracy10: 0.5155 - val_loss: 3.4526 - val_accuracy10: 0.3863 - 17s/epoch - 45ms/step
Epoch 24/50
381/381 - 17s - loss: 2.9189 - accuracy10: 0.5171 - val_loss: 3.5115 - val_accuracy10: 0.3886 - 17s/epoch - 44ms/step
testing model: results/XRAY/W7/deepLOB_L2/h10
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0830265
{'0': {'precision': 0.358246797780441, 'recall': 0.7414193548387097, 'f1-score': 0.48307590271971895, 'support': 69750}, '1': {'precision': 0.47788975163830605, 'recall': 0.36193018309212993, 'f1-score': 0.41190430985380666, 'support': 95908}, '2': {'precision': 0.45070624164916967, 'recall': 0.13065973134865191, 'f1-score': 0.20258893428997354, 'support': 72287}, 'accuracy': 0.4029124377482191, 'macro avg': {'precision': 0.4289475970226389, 'recall': 0.4113364230931638, 'f1-score': 0.36585638228783307, 'support': 237945}, 'weighted avg': {'precision': 0.4345599467751201, 'recall': 0.4029124377482191, 'f1-score': 0.3691777892251512, 'support': 237945}}
[[51714 14072  3964]
 [53649 34712  7547]
 [38990 23852  9445]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0721983
{'0': {'precision': 0.3936126863390947, 'recall': 0.7377012664672564, 'f1-score': 0.513329790531863, 'support': 31426}, '1': {'precision': 0.4454468373749364, 'recall': 0.3756864988558352, 'f1-score': 0.40760338272945923, 'support': 34960}, '2': {'precision': 0.4736266141387612, 'recall': 0.139007547775815, 'f1-score': 0.2149330817172796, 'support': 31135}, 'accuracy': 0.41678202643533185, 'macro avg': {'precision': 0.4375620459509308, 'recall': 0.41746510436630224, 'f1-score': 0.37862208499286726, 'support': 97521}, 'weighted avg': {'precision': 0.4377401620854021, 'recall': 0.41678202643533185, 'f1-score': 0.3801607628792129, 'support': 97521}}
[[23183  6149  2094]
 [19110 13134  2716]
 [16605 10202  4328]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0834085
{'0': {'precision': 0.40374561957833055, 'recall': 0.7204510507432086, 'f1-score': 0.5174876665930344, 'support': 9755}, '1': {'precision': 0.3915172988745311, 'recall': 0.38553104155977425, 'f1-score': 0.38850111162814743, 'support': 9745}, '2': {'precision': 0.45901639344262296, 'recall': 0.09940482405763809, 'f1-score': 0.16341944897433697, 'support': 9577}, 'accuracy': 0.403652371290023, 'macro avg': {'precision': 0.4180931039651616, 'recall': 0.4017956387868737, 'f1-score': 0.35646940906517294, 'support': 29077}, 'weighted avg': {'precision': 0.41785172461116754, 'recall': 0.403652371290023, 'f1-score': 0.3576401823867171, 'support': 29077}}
[[7028 2242  485]
 [5351 3757  637]
 [5028 3597  952]]
training model: results/XRAY/W7/deepLOB_L2/h20
Epoch 1/50
381/381 - 19s - loss: 3.3252 - accuracy20: 0.3608 - val_loss: 3.3976 - val_accuracy20: 0.3424 - 19s/epoch - 50ms/step
Epoch 2/50
381/381 - 16s - loss: 3.2640 - accuracy20: 0.3887 - val_loss: 3.4053 - val_accuracy20: 0.3346 - 16s/epoch - 43ms/step
Epoch 3/50
381/381 - 16s - loss: 3.2107 - accuracy20: 0.4189 - val_loss: 3.4075 - val_accuracy20: 0.3369 - 16s/epoch - 43ms/step
Epoch 4/50
381/381 - 17s - loss: 3.1698 - accuracy20: 0.4409 - val_loss: 3.3847 - val_accuracy20: 0.3404 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.1408 - accuracy20: 0.4508 - val_loss: 3.5214 - val_accuracy20: 0.3369 - 17s/epoch - 44ms/step
Epoch 6/50
381/381 - 17s - loss: 3.1228 - accuracy20: 0.4581 - val_loss: 3.3656 - val_accuracy20: 0.3628 - 17s/epoch - 43ms/step
Epoch 7/50
381/381 - 17s - loss: 3.1087 - accuracy20: 0.4621 - val_loss: 3.4335 - val_accuracy20: 0.3389 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.0978 - accuracy20: 0.4671 - val_loss: 3.3591 - val_accuracy20: 0.3578 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 16s - loss: 3.0906 - accuracy20: 0.4678 - val_loss: 3.4246 - val_accuracy20: 0.3783 - 16s/epoch - 43ms/step
Epoch 10/50
381/381 - 17s - loss: 3.0800 - accuracy20: 0.4719 - val_loss: 3.2729 - val_accuracy20: 0.3918 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.0725 - accuracy20: 0.4742 - val_loss: 3.2835 - val_accuracy20: 0.3934 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 3.0647 - accuracy20: 0.4764 - val_loss: 3.2784 - val_accuracy20: 0.3922 - 17s/epoch - 43ms/step
Epoch 13/50
381/381 - 17s - loss: 3.0564 - accuracy20: 0.4789 - val_loss: 3.3019 - val_accuracy20: 0.3826 - 17s/epoch - 44ms/step
Epoch 14/50
381/381 - 17s - loss: 3.0481 - accuracy20: 0.4803 - val_loss: 3.2897 - val_accuracy20: 0.3920 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 17s - loss: 3.0410 - accuracy20: 0.4840 - val_loss: 3.4032 - val_accuracy20: 0.3694 - 17s/epoch - 44ms/step
Epoch 16/50
381/381 - 16s - loss: 3.0336 - accuracy20: 0.4860 - val_loss: 3.2949 - val_accuracy20: 0.3937 - 16s/epoch - 43ms/step
Epoch 17/50
381/381 - 16s - loss: 3.0243 - accuracy20: 0.4894 - val_loss: 3.3821 - val_accuracy20: 0.3722 - 16s/epoch - 42ms/step
Epoch 18/50
381/381 - 16s - loss: 3.0173 - accuracy20: 0.4908 - val_loss: 3.3239 - val_accuracy20: 0.3823 - 16s/epoch - 43ms/step
Epoch 19/50
381/381 - 16s - loss: 3.0104 - accuracy20: 0.4933 - val_loss: 3.3752 - val_accuracy20: 0.3737 - 16s/epoch - 43ms/step
Epoch 20/50
381/381 - 16s - loss: 3.0032 - accuracy20: 0.4962 - val_loss: 3.3019 - val_accuracy20: 0.3867 - 16s/epoch - 43ms/step
testing model: results/XRAY/W7/deepLOB_L2/h20
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084469
{'0': {'precision': 0.36846359563508785, 'recall': 0.5833526200427485, 'f1-score': 0.4516506450796864, 'support': 73453}, '1': {'precision': 0.4128148109841237, 'recall': 0.4504904118556643, 'f1-score': 0.43083050884048274, 'support': 88599}, '2': {'precision': 0.4493972525932156, 'recall': 0.1478528981592505, 'f1-score': 0.2225020324800222, 'support': 75893}, 'accuracy': 0.3949778310113682, 'macro avg': {'precision': 0.41022521973747567, 'recall': 0.3938986433525544, 'f1-score': 0.36832772880006376, 'support': 237945}, 'weighted avg': {'precision': 0.4107917443931303, 'recall': 0.3949778310113682, 'f1-score': 0.3708108757771857, 'support': 237945}}
[[42849 24743  5861]
 [40799 39913  7887]
 [32643 32029 11221]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0761254
{'0': {'precision': 0.41064325881223424, 'recall': 0.5507219718568932, 'f1-score': 0.4704773129051267, 'support': 32619}, '1': {'precision': 0.3873278939316675, 'recall': 0.4664394497666421, 'f1-score': 0.4232183651863821, 'support': 32568}, '2': {'precision': 0.44500171762281004, 'recall': 0.20031545741324921, 'f1-score': 0.27626948751306274, 'support': 32334}, 'accuracy': 0.40639452015463334, 'macro avg': {'precision': 0.41432429012223726, 'recall': 0.4058256263455949, 'f1-score': 0.3899883885348572, 'support': 97521}, 'weighted avg': {'precision': 0.41424875510278564, 'recall': 0.40639452015463334, 'f1-score': 0.39030334795879645, 'support': 97521}}
[[17964 10673  3982]
 [13281 15191  4096]
 [12501 13356  6477]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899733
{'0': {'precision': 0.4095525230085687, 'recall': 0.5217303416211846, 'f1-score': 0.45888523424304384, 'support': 9894}, '1': {'precision': 0.36047895284843073, 'recall': 0.5196183533447685, 'f1-score': 0.42566084131026616, 'support': 9328}, '2': {'precision': 0.4572183680211431, 'recall': 0.1404363267376966, 'f1-score': 0.21487346685297312, 'support': 9855}, 'accuracy': 0.3918217147573684, 'macro avg': {'precision': 0.40908328129271415, 'recall': 0.39392834056788323, 'f1-score': 0.3664731808020944, 'support': 29077}, 'weighted avg': {'precision': 0.4099648296476702, 'recall': 0.3918217147573684, 'f1-score': 0.36552439561092576, 'support': 29077}}
[[5162 3909  823]
 [3661 4847  820]
 [3781 4690 1384]]
training model: results/XRAY/W7/deepLOB_L2/h30
Epoch 1/50
381/381 - 19s - loss: 3.3424 - accuracy30: 0.3503 - val_loss: 3.4310 - val_accuracy30: 0.3269 - 19s/epoch - 51ms/step
Epoch 2/50
381/381 - 17s - loss: 3.2831 - accuracy30: 0.3746 - val_loss: 3.3532 - val_accuracy30: 0.3543 - 17s/epoch - 43ms/step
Epoch 3/50
381/381 - 17s - loss: 3.2330 - accuracy30: 0.4039 - val_loss: 3.3361 - val_accuracy30: 0.3546 - 17s/epoch - 44ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2000 - accuracy30: 0.4227 - val_loss: 3.3249 - val_accuracy30: 0.3648 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.1776 - accuracy30: 0.4343 - val_loss: 3.3271 - val_accuracy30: 0.3675 - 17s/epoch - 43ms/step
Epoch 6/50
381/381 - 17s - loss: 3.1638 - accuracy30: 0.4393 - val_loss: 3.3365 - val_accuracy30: 0.3485 - 17s/epoch - 44ms/step
Epoch 7/50
381/381 - 17s - loss: 3.1526 - accuracy30: 0.4428 - val_loss: 3.3684 - val_accuracy30: 0.3560 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.1459 - accuracy30: 0.4457 - val_loss: 3.3343 - val_accuracy30: 0.3663 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 3.1344 - accuracy30: 0.4503 - val_loss: 3.3118 - val_accuracy30: 0.3667 - 17s/epoch - 44ms/step
Epoch 10/50
381/381 - 17s - loss: 3.1270 - accuracy30: 0.4538 - val_loss: 3.3203 - val_accuracy30: 0.3728 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.1216 - accuracy30: 0.4557 - val_loss: 3.3300 - val_accuracy30: 0.3662 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 3.1138 - accuracy30: 0.4585 - val_loss: 3.3491 - val_accuracy30: 0.3642 - 17s/epoch - 44ms/step
Epoch 13/50
381/381 - 17s - loss: 3.1076 - accuracy30: 0.4612 - val_loss: 3.3419 - val_accuracy30: 0.3600 - 17s/epoch - 43ms/step
Epoch 14/50
381/381 - 17s - loss: 3.1003 - accuracy30: 0.4634 - val_loss: 3.3051 - val_accuracy30: 0.3777 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 17s - loss: 3.0937 - accuracy30: 0.4667 - val_loss: 3.3096 - val_accuracy30: 0.3704 - 17s/epoch - 44ms/step
Epoch 16/50
381/381 - 16s - loss: 3.0858 - accuracy30: 0.4684 - val_loss: 3.3199 - val_accuracy30: 0.3667 - 16s/epoch - 43ms/step
Epoch 17/50
381/381 - 17s - loss: 3.0789 - accuracy30: 0.4713 - val_loss: 3.3435 - val_accuracy30: 0.3625 - 17s/epoch - 44ms/step
Epoch 18/50
381/381 - 17s - loss: 3.0706 - accuracy30: 0.4752 - val_loss: 3.3583 - val_accuracy30: 0.3591 - 17s/epoch - 44ms/step
Epoch 19/50
381/381 - 17s - loss: 3.0603 - accuracy30: 0.4776 - val_loss: 3.3416 - val_accuracy30: 0.3670 - 17s/epoch - 44ms/step
Epoch 20/50
381/381 - 17s - loss: 3.0530 - accuracy30: 0.4803 - val_loss: 3.3340 - val_accuracy30: 0.3746 - 17s/epoch - 44ms/step
Epoch 21/50
381/381 - 17s - loss: 3.0446 - accuracy30: 0.4828 - val_loss: 3.3341 - val_accuracy30: 0.3716 - 17s/epoch - 44ms/step
Epoch 22/50
381/381 - 17s - loss: 3.0365 - accuracy30: 0.4868 - val_loss: 3.3409 - val_accuracy30: 0.3704 - 17s/epoch - 44ms/step
Epoch 23/50
381/381 - 17s - loss: 3.0252 - accuracy30: 0.4896 - val_loss: 3.3305 - val_accuracy30: 0.3758 - 17s/epoch - 43ms/step
Epoch 24/50
381/381 - 17s - loss: 3.0174 - accuracy30: 0.4924 - val_loss: 3.3988 - val_accuracy30: 0.3607 - 17s/epoch - 44ms/step
testing model: results/XRAY/W7/deepLOB_L2/h30
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1125178
{'0': {'precision': 0.34264893530709034, 'recall': 0.6162499170922597, 'f1-score': 0.44041637435771036, 'support': 75385}, '1': {'precision': 0.40520739075863277, 'recall': 0.3290041238090724, 'f1-score': 0.36315121708762244, 'support': 84388}, '2': {'precision': 0.4169227133065469, 'recall': 0.18052499616230874, 'f1-score': 0.2519550080342796, 'support': 78172}, 'accuracy': 0.37122864527516863, 'macro avg': {'precision': 0.3882596797907567, 'recall': 0.37525967902121365, 'f1-score': 0.3518408664932042, 'support': 237945}, 'weighted avg': {'precision': 0.38923664554440685, 'recall': 0.37122864527516863, 'f1-score': 0.35109886812751673, 'support': 237945}}
[[46456 19522  9407]
 [46295 27764 10329]
 [42828 21232 14112]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.097227
{'0': {'precision': 0.3814046394180941, 'recall': 0.6140963014654571, 'f1-score': 0.4705554134796457, 'support': 32959}, '1': {'precision': 0.3931776149051305, 'recall': 0.36188254578696843, 'f1-score': 0.3768815351028381, 'support': 31723}, '2': {'precision': 0.4332066072364971, 'recall': 0.20125460580407442, 'f1-score': 0.27483106352011644, 'support': 32839}, 'accuracy': 0.3930332953927872, 'macro avg': {'precision': 0.40259628718657386, 'recall': 0.39241115101883334, 'f1-score': 0.3740893373675334, 'support': 97521}, 'weighted avg': {'precision': 0.4026779951318767, 'recall': 0.3930332953927872, 'f1-score': 0.3741760862366063, 'support': 97521}}
[[20240  8486  4233]
 [15829 11480  4414]
 [16998  9232  6609]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1033566
{'0': {'precision': 0.38059922871551466, 'recall': 0.5168177240684794, 'f1-score': 0.438370205859742, 'support': 9930}, '1': {'precision': 0.35837552960628294, 'recall': 0.3816021126760563, 'f1-score': 0.3696243005595524, 'support': 9088}, '2': {'precision': 0.4092292089249493, 'recall': 0.24067998807038474, 'f1-score': 0.3030985915492958, 'support': 10059}, 'accuracy': 0.37902809780926505, 'macro avg': {'precision': 0.3827346557489156, 'recall': 0.3796999416049735, 'f1-score': 0.3703643659895301, 'support': 29077}, 'weighted avg': {'precision': 0.3835575804513198, 'recall': 0.37902809780926505, 'f1-score': 0.3700873721521071, 'support': 29077}}
[[5132 3049 1749]
 [3874 3468 1746]
 [4478 3160 2421]]
training model: results/XRAY/W7/deepLOB_L2/h50
Epoch 1/50
381/381 - 19s - loss: 3.3367 - accuracy50: 0.3546 - val_loss: 3.5860 - val_accuracy50: 0.3323 - 19s/epoch - 49ms/step
Epoch 2/50
381/381 - 17s - loss: 3.2841 - accuracy50: 0.3739 - val_loss: 3.4553 - val_accuracy50: 0.3377 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 17s - loss: 3.2545 - accuracy50: 0.3941 - val_loss: 3.4039 - val_accuracy50: 0.3418 - 17s/epoch - 44ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2376 - accuracy50: 0.4028 - val_loss: 3.4064 - val_accuracy50: 0.3420 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.2242 - accuracy50: 0.4104 - val_loss: 3.3968 - val_accuracy50: 0.3458 - 17s/epoch - 44ms/step
Epoch 6/50
381/381 - 17s - loss: 3.2111 - accuracy50: 0.4156 - val_loss: 3.4838 - val_accuracy50: 0.3394 - 17s/epoch - 43ms/step
Epoch 7/50
381/381 - 17s - loss: 3.2009 - accuracy50: 0.4231 - val_loss: 3.4160 - val_accuracy50: 0.3574 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.1920 - accuracy50: 0.4281 - val_loss: 3.4182 - val_accuracy50: 0.3539 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 16s - loss: 3.1860 - accuracy50: 0.4306 - val_loss: 3.4008 - val_accuracy50: 0.3571 - 16s/epoch - 43ms/step
Epoch 10/50
381/381 - 17s - loss: 3.1797 - accuracy50: 0.4318 - val_loss: 3.4207 - val_accuracy50: 0.3536 - 17s/epoch - 43ms/step
Epoch 11/50
381/381 - 16s - loss: 3.1736 - accuracy50: 0.4349 - val_loss: 3.4243 - val_accuracy50: 0.3531 - 16s/epoch - 43ms/step
Epoch 12/50
381/381 - 17s - loss: 3.1676 - accuracy50: 0.4376 - val_loss: 3.5104 - val_accuracy50: 0.3420 - 17s/epoch - 43ms/step
Epoch 13/50
381/381 - 17s - loss: 3.1644 - accuracy50: 0.4392 - val_loss: 3.5035 - val_accuracy50: 0.3405 - 17s/epoch - 44ms/step
Epoch 14/50
381/381 - 17s - loss: 3.1558 - accuracy50: 0.4431 - val_loss: 3.4945 - val_accuracy50: 0.3451 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 17s - loss: 3.1464 - accuracy50: 0.4459 - val_loss: 3.5087 - val_accuracy50: 0.3476 - 17s/epoch - 43ms/step
testing model: results/XRAY/W7/deepLOB_L2/h50
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1148114
{'0': {'precision': 0.3247649958663768, 'recall': 0.29466592582303097, 'f1-score': 0.3089841815480525, 'support': 71990}, '1': {'precision': 0.39074675032541734, 'recall': 0.7186624302199863, 'f1-score': 0.5062424470858866, 'support': 90642}, '2': {'precision': 0.3386279148360933, 'recall': 0.02660895197376283, 'f1-score': 0.04934076891827011, 'support': 75313}, 'accuracy': 0.37133791422387524, 'macro avg': {'precision': 0.35137988700929584, 'recall': 0.3466457693389267, 'f1-score': 0.2881891325174031, 'support': 237945}, 'weighted avg': {'precision': 0.354287684740035, 'recall': 0.37133791422387524, 'f1-score': 0.30194624996509656, 'support': 237945}}
[[21213 48867  1910]
 [23497 65141  2004]
 [20608 52701  2004]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1236941
{'0': {'precision': 0.36840547296408366, 'recall': 0.3462549074159943, 'f1-score': 0.35698691696014534, 'support': 32349}, '1': {'precision': 0.3544630244094747, 'recall': 0.6646236294197364, 'f1-score': 0.4623443961176697, 'support': 32468}, '2': {'precision': 0.38852380189132874, 'recall': 0.07411937377690803, 'f1-score': 0.12448963870271935, 'support': 32704}, 'accuracy': 0.36098891520800647, 'macro avg': {'precision': 0.37046409975496236, 'recall': 0.36166597020421287, 'f1-score': 0.3146069839268448, 'support': 97521}, 'weighted avg': {'precision': 0.3705103161216147, 'recall': 0.36098891520800647, 'f1-score': 0.31409518743681847, 'support': 97521}}
[[11201 18969  2179]
 [ 9253 21579  1636]
 [ 9950 20330  2424]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1317093
{'0': {'precision': 0.3642465995407172, 'recall': 0.2157806613645877, 'f1-score': 0.27101268318328187, 'support': 9556}, '1': {'precision': 0.3405197219885785, 'recall': 0.7995010913626442, 'f1-score': 0.4776156473144986, 'support': 9621}, '2': {'precision': 0.40386940749697703, 'recall': 0.03373737373737374, 'f1-score': 0.06227276964668594, 'support': 9900}, 'accuracy': 0.34694088110878013, 'macro avg': {'precision': 0.3695452430087576, 'recall': 0.3496730421548686, 'f1-score': 0.27030036671482216, 'support': 29077}, 'weighted avg': {'precision': 0.36988643548795547, 'recall': 0.34694088110878013, 'f1-score': 0.26830270532773065, 'support': 29077}}
[[2062 7237  257]
 [1693 7692  236]
 [1906 7660  334]]
training model: results/XRAY/W7/deepLOB_L2/h100
Epoch 1/50
381/381 - 19s - loss: 3.3526 - accuracy100: 0.3419 - val_loss: 3.5257 - val_accuracy100: 0.3246 - 19s/epoch - 50ms/step
Epoch 2/50
381/381 - 17s - loss: 3.3096 - accuracy100: 0.3523 - val_loss: 3.3896 - val_accuracy100: 0.3312 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 16s - loss: 3.2872 - accuracy100: 0.3632 - val_loss: 3.3851 - val_accuracy100: 0.3376 - 16s/epoch - 43ms/step
Epoch 4/50
381/381 - 16s - loss: 3.2759 - accuracy100: 0.3725 - val_loss: 3.4022 - val_accuracy100: 0.3349 - 16s/epoch - 43ms/step
Epoch 5/50
381/381 - 17s - loss: 3.2646 - accuracy100: 0.3808 - val_loss: 3.5257 - val_accuracy100: 0.3262 - 17s/epoch - 44ms/step
Epoch 6/50
381/381 - 16s - loss: 3.2561 - accuracy100: 0.3853 - val_loss: 3.6344 - val_accuracy100: 0.3222 - 16s/epoch - 43ms/step
Epoch 7/50
381/381 - 17s - loss: 3.2476 - accuracy100: 0.3928 - val_loss: 3.6814 - val_accuracy100: 0.3379 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 18s - loss: 3.2442 - accuracy100: 0.3942 - val_loss: 3.7218 - val_accuracy100: 0.3395 - 18s/epoch - 46ms/step
Epoch 9/50
381/381 - 17s - loss: 3.2364 - accuracy100: 0.3997 - val_loss: 3.6635 - val_accuracy100: 0.3402 - 17s/epoch - 45ms/step
Epoch 10/50
381/381 - 17s - loss: 3.2294 - accuracy100: 0.4028 - val_loss: 3.6198 - val_accuracy100: 0.3382 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.2219 - accuracy100: 0.4078 - val_loss: 3.4849 - val_accuracy100: 0.3439 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 16s - loss: 3.2157 - accuracy100: 0.4096 - val_loss: 3.4473 - val_accuracy100: 0.3423 - 16s/epoch - 43ms/step
Epoch 13/50
381/381 - 17s - loss: 3.2070 - accuracy100: 0.4164 - val_loss: 3.7229 - val_accuracy100: 0.3400 - 17s/epoch - 43ms/step
testing model: results/XRAY/W7/deepLOB_L2/h100
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1369184
{'0': {'precision': 0.33842577588037415, 'recall': 0.38373419165167144, 'f1-score': 0.3596586556448308, 'support': 78914}, '1': {'precision': 0.334422635421622, 'recall': 0.4121800754563067, 'f1-score': 0.3692522009203329, 'support': 78456}, '2': {'precision': 0.34469170143718125, 'recall': 0.2214582686937636, 'f1-score': 0.2696629213483146, 'support': 80575}, 'accuracy': 0.3381621803357919, 'macro avg': {'precision': 0.3391800375797258, 'recall': 0.3391241786005806, 'f1-score': 0.33285792597115943, 'support': 237945}, 'weighted avg': {'precision': 0.33922766944362565, 'recall': 0.3381621803357919, 'f1-score': 0.3323467343907301, 'support': 237945}}
[[30282 31836 16796]
 [28990 32338 17128]
 [30207 32524 17844]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1295524
{'0': {'precision': 0.34269336213342194, 'recall': 0.3814147018030513, 'f1-score': 0.3610187292140732, 'support': 32445}, '1': {'precision': 0.3439263281166826, 'recall': 0.4006697466745217, 'f1-score': 0.370135915099609, 'support': 32251}, '2': {'precision': 0.3417232989344744, 'recall': 0.24816450875856816, 'f1-score': 0.2875244868785628, 'support': 32825}, 'accuracy': 0.34293126608627883, 'macro avg': {'precision': 0.34278099639485965, 'recall': 0.3434163190787138, 'f1-score': 0.33955971039741506, 'support': 97521}, 'weighted avg': {'precision': 0.34277459654878567, 'recall': 0.34293126608627883, 'f1-score': 0.33929612441440227, 'support': 97521}}
[[12375 12224  7846]
 [11483 12922  7846]
 [12253 12426  8146]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1300279
{'0': {'precision': 0.3403257440095506, 'recall': 0.4134894322420224, 'f1-score': 0.37335703260208614, 'support': 9652}, '1': {'precision': 0.328430423843623, 'recall': 0.3654570905566922, 'f1-score': 0.34595586361551395, 'support': 9287}, '2': {'precision': 0.342502850627138, 'recall': 0.23702899980272243, 'f1-score': 0.2801678908709339, 'support': 10138}, 'accuracy': 0.33662344808611616, 'macro avg': {'precision': 0.3370863394934372, 'recall': 0.3386585075338124, 'f1-score': 0.3331602623628447, 'support': 29077}, 'weighted avg': {'precision': 0.3372855290117218, 'recall': 0.33662344808611616, 'f1-score': 0.33211391346157243, 'support': 29077}}
[[3991 3310 2351]
 [3631 3394 2262]
 [4105 3630 2403]]
training model: results/XRAY/W7/deepLOB_L2/h200
Epoch 1/50
381/381 - 20s - loss: 3.3483 - accuracy200: 0.3487 - val_loss: 3.9341 - val_accuracy200: 0.3262 - 20s/epoch - 52ms/step
Epoch 2/50
381/381 - 17s - loss: 3.3023 - accuracy200: 0.3624 - val_loss: 3.3785 - val_accuracy200: 0.3392 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 16s - loss: 3.2772 - accuracy200: 0.3745 - val_loss: 3.4522 - val_accuracy200: 0.3323 - 16s/epoch - 43ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2632 - accuracy200: 0.3842 - val_loss: 3.3989 - val_accuracy200: 0.3416 - 17s/epoch - 43ms/step
Epoch 5/50
381/381 - 16s - loss: 3.2529 - accuracy200: 0.3846 - val_loss: 3.4031 - val_accuracy200: 0.3351 - 16s/epoch - 43ms/step
Epoch 6/50
381/381 - 16s - loss: 3.2392 - accuracy200: 0.3973 - val_loss: 3.5755 - val_accuracy200: 0.3283 - 16s/epoch - 43ms/step
Epoch 7/50
381/381 - 17s - loss: 3.2253 - accuracy200: 0.4021 - val_loss: 3.3677 - val_accuracy200: 0.3501 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.2195 - accuracy200: 0.4063 - val_loss: 3.4212 - val_accuracy200: 0.3545 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 3.2058 - accuracy200: 0.4151 - val_loss: 3.5113 - val_accuracy200: 0.3373 - 17s/epoch - 45ms/step
Epoch 10/50
381/381 - 17s - loss: 3.1984 - accuracy200: 0.4184 - val_loss: 3.4947 - val_accuracy200: 0.3436 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.1880 - accuracy200: 0.4242 - val_loss: 3.5442 - val_accuracy200: 0.3419 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 3.1724 - accuracy200: 0.4319 - val_loss: 3.4820 - val_accuracy200: 0.3407 - 17s/epoch - 44ms/step
Epoch 13/50
381/381 - 17s - loss: 3.1629 - accuracy200: 0.4364 - val_loss: 3.5451 - val_accuracy200: 0.3427 - 17s/epoch - 45ms/step
Epoch 14/50
381/381 - 17s - loss: 3.1520 - accuracy200: 0.4398 - val_loss: 3.5643 - val_accuracy200: 0.3496 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 17s - loss: 3.1395 - accuracy200: 0.4445 - val_loss: 3.6040 - val_accuracy200: 0.3374 - 17s/epoch - 44ms/step
Epoch 16/50
381/381 - 17s - loss: 3.1328 - accuracy200: 0.4461 - val_loss: 3.6722 - val_accuracy200: 0.3455 - 17s/epoch - 44ms/step
Epoch 17/50
381/381 - 17s - loss: 3.1316 - accuracy200: 0.4484 - val_loss: 3.6633 - val_accuracy200: 0.3454 - 17s/epoch - 44ms/step
testing model: results/XRAY/W7/deepLOB_L2/h200
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175805
{'0': {'precision': 0.3420914345769837, 'recall': 0.6408476244754158, 'f1-score': 0.44606729416856006, 'support': 77204}, '1': {'precision': 0.4049571155163859, 'recall': 0.41367075775677925, 'f1-score': 0.40926756174295115, 'support': 82863}, '2': {'precision': 0.32556798523815017, 'recall': 0.0362490048537456, 'f1-score': 0.06523472252712337, 'support': 77878}, 'accuracy': 0.36385299123747084, 'macro avg': {'precision': 0.3575388451105066, 'recall': 0.3635891290286469, 'f1-score': 0.30685652614621156, 'support': 237945}, 'weighted avg': {'precision': 0.35857602442788206, 'recall': 0.36385299123747084, 'f1-score': 0.30860773316801354, 'support': 237945}}
[[49476 25306  2422]
 [45159 34278  3426]
 [49993 25062  2823]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227725
{'0': {'precision': 0.3373874045076204, 'recall': 0.5487929275756546, 'f1-score': 0.41787391288997683, 'support': 32351}, '1': {'precision': 0.34948892258032965, 'recall': 0.4444720883221894, 'f1-score': 0.3912989910881737, 'support': 32155}, '2': {'precision': 0.35480649188514357, 'recall': 0.0430410419506285, 'f1-score': 0.0767693138843868, 'support': 33015}, 'accuracy': 0.34317736692609796, 'macro avg': {'precision': 0.3472276063243645, 'recall': 0.3454353526161575, 'f1-score': 0.2953140726208458, 'support': 97521}, 'weighted avg': {'precision': 0.3472746645172275, 'recall': 0.34317736692609796, 'f1-score': 0.2936331345273008, 'support': 97521}}
[[17754 13281  1316]
 [16595 14292  1268]
 [18273 13321  1421]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241794
{'0': {'precision': 0.3407878017789072, 'recall': 0.7046027742749055, 'f1-score': 0.45938816758589973, 'support': 9516}, '1': {'precision': 0.3724202626641651, 'recall': 0.33672603901611536, 'f1-score': 0.3536748329621381, 'support': 9432}, '2': {'precision': 0.35354691075514877, 'recall': 0.030506466581103762, 'f1-score': 0.056166500045442144, 'support': 10129}, 'accuracy': 0.3504488083364859, 'macro avg': {'precision': 0.35558499173274033, 'recall': 0.35727842662404147, 'f1-score': 0.2897431668644933, 'support': 29077}, 'weighted avg': {'precision': 0.35549338990320145, 'recall': 0.3504488083364859, 'f1-score': 0.28463422313878983, 'support': 29077}}
[[6705 2576  235]
 [5926 3176  330]
 [7044 2776  309]]
training model: results/XRAY/W7/deepLOB_L2/h300
Epoch 1/50
381/381 - 19s - loss: 3.3456 - accuracy300: 0.3511 - val_loss: 3.3665 - val_accuracy300: 0.3434 - 19s/epoch - 51ms/step
Epoch 2/50
381/381 - 17s - loss: 3.3119 - accuracy300: 0.3629 - val_loss: 3.4669 - val_accuracy300: 0.3286 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 17s - loss: 3.2991 - accuracy300: 0.3634 - val_loss: 3.3377 - val_accuracy300: 0.3313 - 17s/epoch - 44ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2765 - accuracy300: 0.3816 - val_loss: 3.3353 - val_accuracy300: 0.3327 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.2598 - accuracy300: 0.3908 - val_loss: 3.3655 - val_accuracy300: 0.3360 - 17s/epoch - 43ms/step
Epoch 6/50
381/381 - 17s - loss: 3.2457 - accuracy300: 0.4006 - val_loss: 3.3863 - val_accuracy300: 0.3358 - 17s/epoch - 43ms/step
Epoch 7/50
381/381 - 17s - loss: 3.2369 - accuracy300: 0.4032 - val_loss: 3.3695 - val_accuracy300: 0.3373 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.2303 - accuracy300: 0.4093 - val_loss: 3.4053 - val_accuracy300: 0.3382 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 3.2143 - accuracy300: 0.4179 - val_loss: 3.4464 - val_accuracy300: 0.3377 - 17s/epoch - 44ms/step
Epoch 10/50
381/381 - 17s - loss: 3.2027 - accuracy300: 0.4230 - val_loss: 3.4155 - val_accuracy300: 0.3357 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.1941 - accuracy300: 0.4277 - val_loss: 3.4883 - val_accuracy300: 0.3281 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 3.1778 - accuracy300: 0.4353 - val_loss: 3.4652 - val_accuracy300: 0.3315 - 17s/epoch - 45ms/step
Epoch 13/50
381/381 - 17s - loss: 3.1663 - accuracy300: 0.4400 - val_loss: 3.4554 - val_accuracy300: 0.3533 - 17s/epoch - 44ms/step
Epoch 14/50
381/381 - 17s - loss: 3.1504 - accuracy300: 0.4464 - val_loss: 3.4811 - val_accuracy300: 0.3397 - 17s/epoch - 45ms/step
testing model: results/XRAY/W7/deepLOB_L2/h300
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1107905
{'0': {'precision': 0.335354798374492, 'recall': 0.4820273184759166, 'f1-score': 0.39553146775799136, 'support': 77896}, '1': {'precision': 0.3541383197916262, 'recall': 0.45128370261199113, 'f1-score': 0.3968524518746427, 'support': 80743}, '2': {'precision': 0.34121621621621623, 'recall': 0.09933674627392632, 'f1-score': 0.1538762036838096, 'support': 79306}, 'accuracy': 0.3440458929584568, 'macro avg': {'precision': 0.34356977812744477, 'recall': 0.3442159224539447, 'f1-score': 0.3154200411054812, 'support': 237945}, 'weighted avg': {'precision': 0.34368228360485803, 'recall': 0.3440458929584568, 'f1-score': 0.31543710917875545, 'support': 237945}}
[[37548 32744  7604]
 [36699 36438  7606]
 [37718 33710  7878]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115702
{'0': {'precision': 0.33546179207879473, 'recall': 0.49846516387088774, 'f1-score': 0.4010327666421364, 'support': 32251}, '1': {'precision': 0.3471009626147302, 'recall': 0.38573249992225644, 'f1-score': 0.36539849469017427, 'support': 32157}, '2': {'precision': 0.3437928298348121, 'recall': 0.14393138646453055, 'f1-score': 0.20291212534059946, 'support': 33113}, 'accuracy': 0.3409111883594303, 'macro avg': {'precision': 0.3421185281761123, 'recall': 0.3427096834192249, 'f1-score': 0.32311446222430334, 'support': 97521}, 'weighted avg': {'precision': 0.3421285249890303, 'recall': 0.3409111883594303, 'f1-score': 0.3220112217587058, 'support': 97521}}
[[16076 11481  4694]
 [15350 12404  4403]
 [16496 11851  4766]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137472
{'0': {'precision': 0.31876314443244474, 'recall': 0.606926406926407, 'f1-score': 0.41799277009652297, 'support': 9240}, '1': {'precision': 0.34890047608252095, 'recall': 0.3131549496388239, 'f1-score': 0.330062731220846, 'support': 9829}, '2': {'precision': 0.34259954921111946, 'recall': 0.09112709832134293, 'f1-score': 0.14396211523283348, 'support': 10008}, 'accuracy': 0.330089073838429, 'macro avg': {'precision': 0.3367543899086951, 'recall': 0.3370694849621913, 'f1-score': 0.29733920551673415, 'support': 29077}, 'weighted avg': {'precision': 0.3371548138554793, 'recall': 0.330089073838429, 'f1-score': 0.29395097947215204, 'support': 29077}}
[[5608 2769  863]
 [5864 3078  887]
 [6121 2975  912]]
training model: results/XRAY/W7/deepLOB_L2/h500
Epoch 1/50
381/381 - 19s - loss: 3.3527 - accuracy500: 0.3497 - val_loss: 3.3866 - val_accuracy500: 0.3436 - 19s/epoch - 51ms/step
Epoch 2/50
381/381 - 17s - loss: 3.3159 - accuracy500: 0.3551 - val_loss: 3.3902 - val_accuracy500: 0.3474 - 17s/epoch - 44ms/step
Epoch 3/50
381/381 - 17s - loss: 3.2972 - accuracy500: 0.3639 - val_loss: 3.3696 - val_accuracy500: 0.3444 - 17s/epoch - 44ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2833 - accuracy500: 0.3726 - val_loss: 3.3594 - val_accuracy500: 0.3374 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.2676 - accuracy500: 0.3850 - val_loss: 3.4096 - val_accuracy500: 0.3322 - 17s/epoch - 44ms/step
Epoch 6/50
381/381 - 17s - loss: 3.2530 - accuracy500: 0.3956 - val_loss: 3.3762 - val_accuracy500: 0.3379 - 17s/epoch - 44ms/step
Epoch 7/50
381/381 - 17s - loss: 3.2303 - accuracy500: 0.4132 - val_loss: 3.4141 - val_accuracy500: 0.3276 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.2190 - accuracy500: 0.4152 - val_loss: 3.5470 - val_accuracy500: 0.3122 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 3.2012 - accuracy500: 0.4258 - val_loss: 3.4900 - val_accuracy500: 0.3128 - 17s/epoch - 44ms/step
Epoch 10/50
381/381 - 16s - loss: 3.1801 - accuracy500: 0.4365 - val_loss: 3.4965 - val_accuracy500: 0.3174 - 16s/epoch - 43ms/step
Epoch 11/50
381/381 - 16s - loss: 3.1694 - accuracy500: 0.4394 - val_loss: 3.6104 - val_accuracy500: 0.3154 - 16s/epoch - 43ms/step
Epoch 12/50
381/381 - 17s - loss: 3.1516 - accuracy500: 0.4477 - val_loss: 3.5438 - val_accuracy500: 0.3149 - 17s/epoch - 43ms/step
Epoch 13/50
381/381 - 17s - loss: 3.1338 - accuracy500: 0.4554 - val_loss: 3.5291 - val_accuracy500: 0.3127 - 17s/epoch - 44ms/step
Epoch 14/50
381/381 - 17s - loss: 3.1137 - accuracy500: 0.4620 - val_loss: 3.5553 - val_accuracy500: 0.3143 - 17s/epoch - 43ms/step
testing model: results/XRAY/W7/deepLOB_L2/h500
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1363581
{'0': {'precision': 0.3193145455219363, 'recall': 0.33424292587036364, 'f1-score': 0.3266082407132431, 'support': 77324}, '1': {'precision': 0.34493687327895256, 'recall': 0.4892469816627569, 'f1-score': 0.40460942300953273, 'support': 81419}, '2': {'precision': 0.3275695983045949, 'recall': 0.1717380874220348, 'f1-score': 0.22533671288703344, 'support': 79202}, 'accuracy': 0.33319044316964, 'macro avg': {'precision': 0.33060700570182794, 'recall': 0.3317426649850518, 'f1-score': 0.31885145886993643, 'support': 237945}, 'weighted avg': {'precision': 0.3308296477268182, 'recall': 0.33319044316964, 'f1-score': 0.31958926874278837, 'support': 237945}}
[[25845 37822 13657]
 [27320 39834 14265]
 [27774 37826 13602]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1266322
{'0': {'precision': 0.33292697431018076, 'recall': 0.34863156583740695, 'f1-score': 0.34059833609636647, 'support': 32117}, '1': {'precision': 0.33641839283090935, 'recall': 0.49751707014276847, 'f1-score': 0.401407304461055, 'support': 32220}, '2': {'precision': 0.33232758620689656, 'recall': 0.16263862102217935, 'f1-score': 0.2183959210100356, 'support': 33184}, 'accuracy': 0.33453307492745155, 'macro avg': {'precision': 0.3338909844493289, 'recall': 0.33626241900078496, 'f1-score': 0.320133853855819, 'support': 97521}, 'weighted avg': {'precision': 0.333876548349808, 'recall': 0.33453307492745155, 'f1-score': 0.3191065550285499, 'support': 97521}}
[[11197 15509  5411]
 [10758 16030  5432]
 [11677 16110  5397]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234988
{'0': {'precision': 0.30267596132223973, 'recall': 0.30713063320022815, 'f1-score': 0.3048870264454386, 'support': 8765}, '1': {'precision': 0.3471509971509972, 'recall': 0.4832441007336903, 'f1-score': 0.4040454281687806, 'support': 10086}, '2': {'precision': 0.352108090509523, 'recall': 0.2115196557793859, 'f1-score': 0.26428004154193907, 'support': 10226}, 'accuracy': 0.3345943529249923, 'macro avg': {'precision': 0.33397834966091994, 'recall': 0.33396479657110145, 'f1-score': 0.3244041653853861, 'support': 29077}, 'weighted avg': {'precision': 0.3354877426077233, 'recall': 0.3345943529249923, 'f1-score': 0.32500136465634216, 'support': 29077}}
[[2692 4271 1802]
 [3034 4874 2178]
 [3168 4895 2163]]
training model: results/XRAY/W7/deepLOB_L2/h1000
Epoch 1/50
381/381 - 19s - loss: 3.3184 - accuracy1000: 0.3763 - val_loss: 3.5161 - val_accuracy1000: 0.3211 - 19s/epoch - 50ms/step
Epoch 2/50
381/381 - 17s - loss: 3.2992 - accuracy1000: 0.3844 - val_loss: 3.5475 - val_accuracy1000: 0.3171 - 17s/epoch - 43ms/step
Epoch 3/50
381/381 - 17s - loss: 3.2672 - accuracy1000: 0.4007 - val_loss: 3.5195 - val_accuracy1000: 0.3239 - 17s/epoch - 45ms/step
Epoch 4/50
381/381 - 17s - loss: 3.2658 - accuracy1000: 0.3975 - val_loss: 3.4989 - val_accuracy1000: 0.3203 - 17s/epoch - 44ms/step
Epoch 5/50
381/381 - 17s - loss: 3.2243 - accuracy1000: 0.4182 - val_loss: 3.4197 - val_accuracy1000: 0.3194 - 17s/epoch - 44ms/step
Epoch 6/50
381/381 - 17s - loss: 3.2133 - accuracy1000: 0.4249 - val_loss: 3.5862 - val_accuracy1000: 0.3061 - 17s/epoch - 44ms/step
Epoch 7/50
381/381 - 17s - loss: 3.1745 - accuracy1000: 0.4386 - val_loss: 3.6150 - val_accuracy1000: 0.3102 - 17s/epoch - 44ms/step
Epoch 8/50
381/381 - 17s - loss: 3.1471 - accuracy1000: 0.4483 - val_loss: 3.7991 - val_accuracy1000: 0.3100 - 17s/epoch - 44ms/step
Epoch 9/50
381/381 - 17s - loss: 3.1206 - accuracy1000: 0.4606 - val_loss: 3.6225 - val_accuracy1000: 0.3133 - 17s/epoch - 44ms/step
Epoch 10/50
381/381 - 17s - loss: 3.0948 - accuracy1000: 0.4711 - val_loss: 3.7665 - val_accuracy1000: 0.3069 - 17s/epoch - 44ms/step
Epoch 11/50
381/381 - 17s - loss: 3.0800 - accuracy1000: 0.4759 - val_loss: 3.8588 - val_accuracy1000: 0.3110 - 17s/epoch - 44ms/step
Epoch 12/50
381/381 - 17s - loss: 3.0628 - accuracy1000: 0.4806 - val_loss: 3.8739 - val_accuracy1000: 0.3088 - 17s/epoch - 44ms/step
Epoch 13/50
381/381 - 16s - loss: 3.0606 - accuracy1000: 0.4823 - val_loss: 3.9135 - val_accuracy1000: 0.3061 - 16s/epoch - 43ms/step
Epoch 14/50
381/381 - 17s - loss: 3.0377 - accuracy1000: 0.4874 - val_loss: 3.8964 - val_accuracy1000: 0.3091 - 17s/epoch - 44ms/step
Epoch 15/50
381/381 - 16s - loss: 3.0079 - accuracy1000: 0.4957 - val_loss: 3.9448 - val_accuracy1000: 0.3095 - 16s/epoch - 43ms/step
testing model: results/XRAY/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.132678
{'0': {'precision': 0.3194100575513617, 'recall': 0.5081714904328999, 'f1-score': 0.39226366368482785, 'support': 76669}, '1': {'precision': 0.3424300789409435, 'recall': 0.3046605362875003, 'f1-score': 0.3224430366813119, 'support': 82866}, '2': {'precision': 0.33408299992897894, 'recall': 0.17997704374442036, 'f1-score': 0.23393092473332172, 'support': 78410}, 'accuracy': 0.3291474920674946, 'macro avg': {'precision': 0.33197437880709474, 'recall': 0.3309363568216068, 'f1-score': 0.3162125416998205, 'support': 237945}, 'weighted avg': {'precision': 0.332262113716854, 'recall': 0.3291474920674946, 'f1-score': 0.31577276814820826, 'support': 237945}}
[[38961 23994 13714]
 [43205 25246 14415]
 [39812 24486 14112]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1342968
{'0': {'precision': 0.33120829951097824, 'recall': 0.5215100692063096, 'f1-score': 0.40512429316962717, 'support': 32078}, '1': {'precision': 0.3387749502709376, 'recall': 0.3067130348382289, 'f1-score': 0.3219477217912783, 'support': 32206}, '2': {'precision': 0.349277472835219, 'recall': 0.18762222823961247, 'f1-score': 0.2441134446379989, 'support': 33237}, 'accuracy': 0.33677874509080097, 'macro avg': {'precision': 0.3397535742057116, 'recall': 0.3386151107613837, 'f1-score': 0.3237284865329681, 'support': 97521}, 'weighted avg': {'precision': 0.33986547763828456, 'recall': 0.33677874509080097, 'f1-score': 0.32277995471476273, 'support': 97521}}
[[16729  9479  5870]
 [16580  9878  5748]
 [17200  9801  6236]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1431351
{'0': {'precision': 0.29904636632686615, 'recall': 0.5167632685532447, 'f1-score': 0.3788535244125979, 'support': 8799}, '1': {'precision': 0.32149594939518367, 'recall': 0.3049794715233182, 'f1-score': 0.31301998919502966, 'support': 9499}, '2': {'precision': 0.36576836041966676, 'recall': 0.1649503664532888, 'f1-score': 0.22736572890025575, 'support': 10779}, 'accuracy': 0.3171578911166902, 'macro avg': {'precision': 0.32877022538057216, 'recall': 0.32889770217661723, 'f1-score': 0.3064130808359611, 'support': 29077}, 'weighted avg': {'precision': 0.33111449453446135, 'recall': 0.3171578911166902, 'f1-score': 0.30118940160559515, 'support': 29077}}
[[4547 2760 1492]
 [5011 2897 1591]
 [5647 3354 1778]]
training model: results/XRAY/W7/deepOF_L2/h10
Epoch 1/50
381/381 - 13s - loss: 3.2706 - accuracy10: 0.3867 - val_loss: 3.2525 - val_accuracy10: 0.3950 - 13s/epoch - 34ms/step
Epoch 2/50
381/381 - 10s - loss: 3.1688 - accuracy10: 0.4258 - val_loss: 3.1949 - val_accuracy10: 0.4125 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 9s - loss: 3.1267 - accuracy10: 0.4442 - val_loss: 3.1645 - val_accuracy10: 0.4236 - 9s/epoch - 25ms/step
Epoch 4/50
381/381 - 9s - loss: 3.0959 - accuracy10: 0.4559 - val_loss: 3.1457 - val_accuracy10: 0.4330 - 9s/epoch - 25ms/step
Epoch 5/50
381/381 - 10s - loss: 3.0692 - accuracy10: 0.4682 - val_loss: 3.1323 - val_accuracy10: 0.4443 - 10s/epoch - 26ms/step
Epoch 6/50
381/381 - 10s - loss: 3.0460 - accuracy10: 0.4783 - val_loss: 3.1163 - val_accuracy10: 0.4485 - 10s/epoch - 26ms/step
Epoch 7/50
381/381 - 10s - loss: 3.0238 - accuracy10: 0.4856 - val_loss: 3.1083 - val_accuracy10: 0.4552 - 10s/epoch - 25ms/step
Epoch 8/50
381/381 - 10s - loss: 3.0078 - accuracy10: 0.4929 - val_loss: 3.1021 - val_accuracy10: 0.4585 - 10s/epoch - 25ms/step
Epoch 9/50
381/381 - 10s - loss: 2.9951 - accuracy10: 0.4963 - val_loss: 3.0895 - val_accuracy10: 0.4641 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 2.9780 - accuracy10: 0.5026 - val_loss: 3.0888 - val_accuracy10: 0.4646 - 10s/epoch - 27ms/step
Epoch 11/50
381/381 - 10s - loss: 2.9644 - accuracy10: 0.5047 - val_loss: 3.0784 - val_accuracy10: 0.4689 - 10s/epoch - 26ms/step
Epoch 12/50
381/381 - 10s - loss: 2.9535 - accuracy10: 0.5077 - val_loss: 3.0829 - val_accuracy10: 0.4675 - 10s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 2.9405 - accuracy10: 0.5115 - val_loss: 3.0769 - val_accuracy10: 0.4690 - 10s/epoch - 25ms/step
Epoch 14/50
381/381 - 10s - loss: 2.9335 - accuracy10: 0.5126 - val_loss: 3.0806 - val_accuracy10: 0.4672 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 2.9245 - accuracy10: 0.5147 - val_loss: 3.0746 - val_accuracy10: 0.4694 - 10s/epoch - 26ms/step
Epoch 16/50
381/381 - 10s - loss: 2.9127 - accuracy10: 0.5186 - val_loss: 3.0802 - val_accuracy10: 0.4687 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 2.9026 - accuracy10: 0.5219 - val_loss: 3.0800 - val_accuracy10: 0.4692 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 2.8961 - accuracy10: 0.5241 - val_loss: 3.0850 - val_accuracy10: 0.4671 - 10s/epoch - 25ms/step
Epoch 19/50
381/381 - 10s - loss: 2.8901 - accuracy10: 0.5238 - val_loss: 3.0888 - val_accuracy10: 0.4667 - 10s/epoch - 25ms/step
Epoch 20/50
381/381 - 10s - loss: 2.8817 - accuracy10: 0.5266 - val_loss: 3.0923 - val_accuracy10: 0.4663 - 10s/epoch - 25ms/step
Epoch 21/50
381/381 - 9s - loss: 2.8712 - accuracy10: 0.5294 - val_loss: 3.0966 - val_accuracy10: 0.4625 - 9s/epoch - 25ms/step
Epoch 22/50
381/381 - 9s - loss: 2.8653 - accuracy10: 0.5312 - val_loss: 3.0965 - val_accuracy10: 0.4655 - 9s/epoch - 25ms/step
Epoch 23/50
381/381 - 10s - loss: 2.8558 - accuracy10: 0.5344 - val_loss: 3.0975 - val_accuracy10: 0.4672 - 10s/epoch - 25ms/step
Epoch 24/50
381/381 - 10s - loss: 2.8476 - accuracy10: 0.5346 - val_loss: 3.1047 - val_accuracy10: 0.4652 - 10s/epoch - 26ms/step
Epoch 25/50
381/381 - 10s - loss: 2.8412 - accuracy10: 0.5377 - val_loss: 3.0920 - val_accuracy10: 0.4681 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepOF_L2/h10
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0330921
{'0': {'precision': 0.4038931261990548, 'recall': 0.6187704306933532, 'f1-score': 0.48875726912906353, 'support': 69748}, '1': {'precision': 0.5744830432058199, 'recall': 0.3919317672328401, 'f1-score': 0.46596586049163863, 'support': 95907}, '2': {'precision': 0.45109208882931734, 'recall': 0.4097115584146088, 'f1-score': 0.42940720173409985, 'support': 72285}, 'accuracy': 0.4638270152139195, 'macro avg': {'precision': 0.47648941941139733, 'recall': 0.4734712521136008, 'f1-score': 0.46137677711826736, 'support': 237940}, 'weighted avg': {'precision': 0.4869919922329135, 'recall': 0.4638270152139195, 'f1-score': 0.46154042769914655, 'support': 237940}}
[[43158 12888 13702]
 [35982 37589 22336]
 [27715 14954 29616]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98320144
{'0': {'precision': 0.4703605476309942, 'recall': 0.6270225506433941, 'f1-score': 0.5375090444920749, 'support': 31396}, '1': {'precision': 0.5689163326472394, 'recall': 0.4498215560314061, 'f1-score': 0.502407602283236, 'support': 35025}, '2': {'precision': 0.5043254450561235, 'recall': 0.4536480272677578, 'f1-score': 0.47764630203307773, 'support': 31099}, 'accuracy': 0.5080906480721903, 'macro avg': {'precision': 0.5145341084447858, 'recall': 0.5101640446475194, 'f1-score': 0.5058543162694629, 'support': 97520}, 'weighted avg': {'precision': 0.5165889183776932, 'recall': 0.5080906480721903, 'f1-score': 0.5058119624463722, 'support': 97520}}
[[19686  5660  6050]
 [11454 15755  7816]
 [10713  6278 14108]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0255924
{'0': {'precision': 0.4497865648168951, 'recall': 0.6191752577319588, 'f1-score': 0.5210601657051144, 'support': 9700}, '1': {'precision': 0.5069206727191546, 'recall': 0.34804823216840386, 'f1-score': 0.4127234171463193, 'support': 9786}, '2': {'precision': 0.4714047751249306, 'recall': 0.44260243978730057, 'f1-score': 0.4565497956549796, 'support': 9591}, 'accuracy': 0.4696839426350724, 'macro avg': {'precision': 0.4760373375536601, 'recall': 0.4699419765625544, 'f1-score': 0.4634444595021378, 'support': 29077}, 'weighted avg': {'precision': 0.4761460460218295, 'recall': 0.4696839426350724, 'f1-score': 0.46332028949549126, 'support': 29077}}
[[6006 1574 2120]
 [3740 3406 2640]
 [3607 1739 4245]]
training model: results/XRAY/W7/deepOF_L2/h20
Epoch 1/50
381/381 - 12s - loss: 3.2982 - accuracy20: 0.3673 - val_loss: 3.2779 - val_accuracy20: 0.3963 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 10s - loss: 3.2173 - accuracy20: 0.4084 - val_loss: 3.2351 - val_accuracy20: 0.4098 - 10s/epoch - 27ms/step
Epoch 3/50
381/381 - 10s - loss: 3.1805 - accuracy20: 0.4257 - val_loss: 3.2149 - val_accuracy20: 0.4194 - 10s/epoch - 26ms/step
Epoch 4/50
381/381 - 10s - loss: 3.1597 - accuracy20: 0.4375 - val_loss: 3.2043 - val_accuracy20: 0.4191 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 3.1402 - accuracy20: 0.4467 - val_loss: 3.1910 - val_accuracy20: 0.4268 - 10s/epoch - 26ms/step
Epoch 6/50
381/381 - 10s - loss: 3.1217 - accuracy20: 0.4542 - val_loss: 3.1819 - val_accuracy20: 0.4303 - 10s/epoch - 26ms/step
Epoch 7/50
381/381 - 10s - loss: 3.1075 - accuracy20: 0.4595 - val_loss: 3.1803 - val_accuracy20: 0.4306 - 10s/epoch - 25ms/step
Epoch 8/50
381/381 - 10s - loss: 3.0951 - accuracy20: 0.4646 - val_loss: 3.1803 - val_accuracy20: 0.4319 - 10s/epoch - 26ms/step
Epoch 9/50
381/381 - 10s - loss: 3.0866 - accuracy20: 0.4683 - val_loss: 3.1726 - val_accuracy20: 0.4353 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 3.0740 - accuracy20: 0.4727 - val_loss: 3.1705 - val_accuracy20: 0.4347 - 10s/epoch - 26ms/step
Epoch 11/50
381/381 - 10s - loss: 3.0635 - accuracy20: 0.4771 - val_loss: 3.1682 - val_accuracy20: 0.4384 - 10s/epoch - 26ms/step
Epoch 12/50
381/381 - 10s - loss: 3.0535 - accuracy20: 0.4810 - val_loss: 3.1686 - val_accuracy20: 0.4382 - 10s/epoch - 26ms/step
Epoch 13/50
381/381 - 10s - loss: 3.0431 - accuracy20: 0.4827 - val_loss: 3.1656 - val_accuracy20: 0.4387 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.0341 - accuracy20: 0.4853 - val_loss: 3.1670 - val_accuracy20: 0.4389 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 3.0240 - accuracy20: 0.4887 - val_loss: 3.1654 - val_accuracy20: 0.4415 - 10s/epoch - 25ms/step
Epoch 16/50
381/381 - 10s - loss: 3.0167 - accuracy20: 0.4923 - val_loss: 3.1669 - val_accuracy20: 0.4400 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 3.0096 - accuracy20: 0.4931 - val_loss: 3.1715 - val_accuracy20: 0.4401 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 2.9983 - accuracy20: 0.4972 - val_loss: 3.1642 - val_accuracy20: 0.4426 - 10s/epoch - 26ms/step
Epoch 19/50
381/381 - 10s - loss: 2.9923 - accuracy20: 0.4991 - val_loss: 3.1691 - val_accuracy20: 0.4422 - 10s/epoch - 25ms/step
Epoch 20/50
381/381 - 10s - loss: 2.9840 - accuracy20: 0.5022 - val_loss: 3.1703 - val_accuracy20: 0.4443 - 10s/epoch - 26ms/step
Epoch 21/50
381/381 - 10s - loss: 2.9775 - accuracy20: 0.5039 - val_loss: 3.1719 - val_accuracy20: 0.4424 - 10s/epoch - 26ms/step
Epoch 22/50
381/381 - 10s - loss: 2.9665 - accuracy20: 0.5072 - val_loss: 3.1752 - val_accuracy20: 0.4437 - 10s/epoch - 27ms/step
Epoch 23/50
381/381 - 10s - loss: 2.9611 - accuracy20: 0.5080 - val_loss: 3.1787 - val_accuracy20: 0.4415 - 10s/epoch - 26ms/step
Epoch 24/50
381/381 - 10s - loss: 2.9502 - accuracy20: 0.5110 - val_loss: 3.1918 - val_accuracy20: 0.4402 - 10s/epoch - 27ms/step
Epoch 25/50
381/381 - 10s - loss: 2.9446 - accuracy20: 0.5128 - val_loss: 3.1871 - val_accuracy20: 0.4387 - 10s/epoch - 27ms/step
Epoch 26/50
381/381 - 10s - loss: 2.9375 - accuracy20: 0.5151 - val_loss: 3.2062 - val_accuracy20: 0.4377 - 10s/epoch - 27ms/step
Epoch 27/50
381/381 - 10s - loss: 2.9288 - accuracy20: 0.5180 - val_loss: 3.2038 - val_accuracy20: 0.4404 - 10s/epoch - 25ms/step
Epoch 28/50
381/381 - 10s - loss: 2.9169 - accuracy20: 0.5214 - val_loss: 3.2186 - val_accuracy20: 0.4387 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepOF_L2/h20
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0539702
{'0': {'precision': 0.4082264055786707, 'recall': 0.5730565010211028, 'f1-score': 0.47679786131391, 'support': 73450}, '1': {'precision': 0.5036232513684942, 'recall': 0.32710301470671227, 'f1-score': 0.39660882417341803, 'support': 88599}, '2': {'precision': 0.4332367249767105, 'recall': 0.441211737887233, 'f1-score': 0.43718786517734154, 'support': 75891}, 'accuracy': 0.4394217029503236, 'macro avg': {'precision': 0.4483621273079585, 'recall': 0.4471237512050161, 'f1-score': 0.43686485022155647, 'support': 237940}, 'weighted avg': {'precision': 0.451725284664025, 'recall': 0.4394217029503236, 'f1-score': 0.4343051710625409, 'support': 237940}}
[[42091 13370 17989]
 [33803 28981 25815]
 [27213 15194 33484]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0078907
{'0': {'precision': 0.47602765368008587, 'recall': 0.5852588296664518, 'f1-score': 0.5250220215811495, 'support': 32589}, '1': {'precision': 0.5043082622000322, 'recall': 0.3842496011780587, 'f1-score': 0.43616798997074807, 'support': 32596}, '2': {'precision': 0.4907563540485023, 'recall': 0.4950363383330756, 'f1-score': 0.4928870550560414, 'support': 32335}, 'accuracy': 0.488156275635767, 'macro avg': {'precision': 0.4903640899762068, 'recall': 0.48818158972586206, 'f1-score': 0.48469235553597967, 'support': 97520}, 'weighted avg': {'precision': 0.49036406920232667, 'recall': 0.488156275635767, 'f1-score': 0.4846675285852306, 'support': 97520}}
[[19073  5927  7589]
 [11050 12525  9021]
 [ 9944  6384 16007]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554034
{'0': {'precision': 0.43167559296097935, 'recall': 0.5718050065876152, 'f1-score': 0.4919562279286743, 'support': 9867}, '1': {'precision': 0.41895093062605754, 'recall': 0.26430401366353545, 'f1-score': 0.3241261945280796, 'support': 9368}, '2': {'precision': 0.4627116965435278, 'recall': 0.4747002641739484, 'f1-score': 0.4686293194242439, 'support': 9842}, 'accuracy': 0.43986656119957357, 'macro avg': {'precision': 0.4377794067101883, 'recall': 0.4369364281416997, 'f1-score': 0.4282372472936659, 'support': 29077}, 'weighted avg': {'precision': 0.4380810919707085, 'recall': 0.43986656119957357, 'f1-score': 0.4299892029124286, 'support': 29077}}
[[5642 1699 2526]
 [3993 2476 2899]
 [3435 1735 4672]]
training model: results/XRAY/W7/deepOF_L2/h30
Epoch 1/50
381/381 - 12s - loss: 3.3125 - accuracy30: 0.3578 - val_loss: 3.2845 - val_accuracy30: 0.3925 - 12s/epoch - 31ms/step
Epoch 2/50
381/381 - 10s - loss: 3.2451 - accuracy30: 0.3957 - val_loss: 3.2492 - val_accuracy30: 0.4075 - 10s/epoch - 26ms/step
Epoch 3/50
381/381 - 10s - loss: 3.2195 - accuracy30: 0.4100 - val_loss: 3.2363 - val_accuracy30: 0.4157 - 10s/epoch - 27ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2019 - accuracy30: 0.4194 - val_loss: 3.2286 - val_accuracy30: 0.4145 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 3.1882 - accuracy30: 0.4277 - val_loss: 3.2160 - val_accuracy30: 0.4207 - 10s/epoch - 26ms/step
Epoch 6/50
381/381 - 10s - loss: 3.1738 - accuracy30: 0.4351 - val_loss: 3.2107 - val_accuracy30: 0.4211 - 10s/epoch - 26ms/step
Epoch 7/50
381/381 - 10s - loss: 3.1635 - accuracy30: 0.4392 - val_loss: 3.2075 - val_accuracy30: 0.4219 - 10s/epoch - 26ms/step
Epoch 8/50
381/381 - 10s - loss: 3.1540 - accuracy30: 0.4442 - val_loss: 3.2013 - val_accuracy30: 0.4226 - 10s/epoch - 26ms/step
Epoch 9/50
381/381 - 10s - loss: 3.1447 - accuracy30: 0.4462 - val_loss: 3.2020 - val_accuracy30: 0.4230 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 3.1377 - accuracy30: 0.4515 - val_loss: 3.2005 - val_accuracy30: 0.4220 - 10s/epoch - 25ms/step
Epoch 11/50
381/381 - 10s - loss: 3.1312 - accuracy30: 0.4539 - val_loss: 3.1995 - val_accuracy30: 0.4220 - 10s/epoch - 26ms/step
Epoch 12/50
381/381 - 10s - loss: 3.1224 - accuracy30: 0.4570 - val_loss: 3.2008 - val_accuracy30: 0.4207 - 10s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.1134 - accuracy30: 0.4594 - val_loss: 3.1982 - val_accuracy30: 0.4253 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.1069 - accuracy30: 0.4642 - val_loss: 3.2006 - val_accuracy30: 0.4232 - 10s/epoch - 26ms/step
Epoch 15/50
381/381 - 9s - loss: 3.0991 - accuracy30: 0.4658 - val_loss: 3.2002 - val_accuracy30: 0.4255 - 9s/epoch - 25ms/step
Epoch 16/50
381/381 - 10s - loss: 3.0918 - accuracy30: 0.4692 - val_loss: 3.2040 - val_accuracy30: 0.4250 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 3.0834 - accuracy30: 0.4705 - val_loss: 3.2053 - val_accuracy30: 0.4246 - 10s/epoch - 27ms/step
Epoch 18/50
381/381 - 10s - loss: 3.0748 - accuracy30: 0.4752 - val_loss: 3.1994 - val_accuracy30: 0.4269 - 10s/epoch - 27ms/step
Epoch 19/50
381/381 - 10s - loss: 3.0666 - accuracy30: 0.4780 - val_loss: 3.2045 - val_accuracy30: 0.4267 - 10s/epoch - 26ms/step
Epoch 20/50
381/381 - 10s - loss: 3.0596 - accuracy30: 0.4795 - val_loss: 3.2114 - val_accuracy30: 0.4241 - 10s/epoch - 25ms/step
Epoch 21/50
381/381 - 10s - loss: 3.0511 - accuracy30: 0.4830 - val_loss: 3.2075 - val_accuracy30: 0.4282 - 10s/epoch - 25ms/step
Epoch 22/50
381/381 - 10s - loss: 3.0421 - accuracy30: 0.4868 - val_loss: 3.2154 - val_accuracy30: 0.4301 - 10s/epoch - 25ms/step
Epoch 23/50
381/381 - 10s - loss: 3.0334 - accuracy30: 0.4878 - val_loss: 3.2216 - val_accuracy30: 0.4232 - 10s/epoch - 25ms/step
testing model: results/XRAY/W7/deepOF_L2/h30
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0621301
{'0': {'precision': 0.4094818395052953, 'recall': 0.5349614634599312, 'f1-score': 0.4638859811579032, 'support': 75383}, '1': {'precision': 0.44098900558732446, 'recall': 0.3189391605242576, 'f1-score': 0.370163048336852, 'support': 84386}, '2': {'precision': 0.4332236758217938, 'recall': 0.43463688580164, 'f1-score': 0.43392913018767915, 'support': 78171}, 'accuracy': 0.4253887534672606, 'macro avg': {'precision': 0.4278981736381378, 'recall': 0.42951250326194296, 'f1-score': 0.4226593865608114, 'support': 237940}, 'weighted avg': {'precision': 0.428455895165105, 'recall': 0.4253887534672606, 'f1-score': 0.42080511872943127, 'support': 237940}}
[[40327 16503 18553]
 [31575 26914 25897]
 [26581 17614 33976]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0437524
{'0': {'precision': 0.45630967741935485, 'recall': 0.5373324824505424, 'f1-score': 0.4935177302985054, 'support': 32907}, '1': {'precision': 0.43498798375735476, 'recall': 0.33010502484120496, 'f1-score': 0.37535755148741423, 'support': 31802}, '2': {'precision': 0.45646148515994917, 'recall': 0.4818505988845204, 'f1-score': 0.46881254911263653, 'support': 32811}, 'accuracy': 0.45108695652173914, 'macro avg': {'precision': 0.4492530487788862, 'recall': 0.44976270205875596, 'f1-score': 0.445895943632852, 'support': 97520}, 'weighted avg': {'precision': 0.44940759027761684, 'recall': 0.45108695652173914, 'f1-score': 0.4466726553760293, 'support': 97520}}
[[17682  6737  8488]
 [10966 10498 10338]
 [10102  6899 15810]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.067111
{'0': {'precision': 0.4286286767652481, 'recall': 0.5384615384615384, 'f1-score': 0.4773082243741354, 'support': 9932}, '1': {'precision': 0.371334431630972, 'recall': 0.24897823925770463, 'f1-score': 0.29808900350459566, 'support': 9053}, '2': {'precision': 0.45042735042735044, 'recall': 0.4699762187871581, 'f1-score': 0.4599941809717777, 'support': 10092}, 'accuracy': 0.424562368882622, 'macro avg': {'precision': 0.41679681960785686, 'recall': 0.4191386655021337, 'f1-score': 0.41179713628350295, 'support': 29077}, 'weighted avg': {'precision': 0.41835620757645064, 'recall': 0.424562368882622, 'f1-score': 0.4154997526422326, 'support': 29077}}
[[5348 1919 2665]
 [3677 2254 3122]
 [3452 1897 4743]]
training model: results/XRAY/W7/deepOF_L2/h50
Epoch 1/50
381/381 - 12s - loss: 3.3208 - accuracy50: 0.3530 - val_loss: 3.3097 - val_accuracy50: 0.3691 - 12s/epoch - 31ms/step
Epoch 2/50
381/381 - 9s - loss: 3.2713 - accuracy50: 0.3797 - val_loss: 3.2789 - val_accuracy50: 0.3858 - 9s/epoch - 24ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2509 - accuracy50: 0.3917 - val_loss: 3.2627 - val_accuracy50: 0.3896 - 9s/epoch - 24ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2388 - accuracy50: 0.3999 - val_loss: 3.2598 - val_accuracy50: 0.3920 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 3.2284 - accuracy50: 0.4063 - val_loss: 3.2534 - val_accuracy50: 0.3927 - 10s/epoch - 25ms/step
Epoch 6/50
381/381 - 10s - loss: 3.2195 - accuracy50: 0.4115 - val_loss: 3.2466 - val_accuracy50: 0.3956 - 10s/epoch - 25ms/step
Epoch 7/50
381/381 - 10s - loss: 3.2118 - accuracy50: 0.4146 - val_loss: 3.2426 - val_accuracy50: 0.3975 - 10s/epoch - 25ms/step
Epoch 8/50
381/381 - 10s - loss: 3.2068 - accuracy50: 0.4183 - val_loss: 3.2411 - val_accuracy50: 0.4009 - 10s/epoch - 25ms/step
Epoch 9/50
381/381 - 9s - loss: 3.1995 - accuracy50: 0.4237 - val_loss: 3.2364 - val_accuracy50: 0.3990 - 9s/epoch - 25ms/step
Epoch 10/50
381/381 - 9s - loss: 3.1941 - accuracy50: 0.4262 - val_loss: 3.2359 - val_accuracy50: 0.4021 - 9s/epoch - 25ms/step
Epoch 11/50
381/381 - 9s - loss: 3.1869 - accuracy50: 0.4278 - val_loss: 3.2383 - val_accuracy50: 0.4007 - 9s/epoch - 25ms/step
Epoch 12/50
381/381 - 10s - loss: 3.1822 - accuracy50: 0.4315 - val_loss: 3.2384 - val_accuracy50: 0.3986 - 10s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.1757 - accuracy50: 0.4347 - val_loss: 3.2392 - val_accuracy50: 0.4018 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.1721 - accuracy50: 0.4338 - val_loss: 3.2365 - val_accuracy50: 0.4017 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 3.1665 - accuracy50: 0.4386 - val_loss: 3.2442 - val_accuracy50: 0.3988 - 10s/epoch - 26ms/step
Epoch 16/50
381/381 - 10s - loss: 3.1589 - accuracy50: 0.4422 - val_loss: 3.2449 - val_accuracy50: 0.3999 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 3.1565 - accuracy50: 0.4412 - val_loss: 3.2453 - val_accuracy50: 0.3999 - 10s/epoch - 26ms/step
Epoch 18/50
381/381 - 10s - loss: 3.1477 - accuracy50: 0.4467 - val_loss: 3.2499 - val_accuracy50: 0.4007 - 10s/epoch - 28ms/step
Epoch 19/50
381/381 - 10s - loss: 3.1416 - accuracy50: 0.4498 - val_loss: 3.2521 - val_accuracy50: 0.4013 - 10s/epoch - 26ms/step
Epoch 20/50
381/381 - 10s - loss: 3.1357 - accuracy50: 0.4526 - val_loss: 3.2589 - val_accuracy50: 0.4011 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepOF_L2/h50
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805435
{'0': {'precision': 0.36784135229276516, 'recall': 0.5882671630594838, 'f1-score': 0.4526452495604167, 'support': 71986}, '1': {'precision': 0.4642249148808332, 'recall': 0.20457629549541598, 'f1-score': 0.28399892790136694, 'support': 90641}, '2': {'precision': 0.3907665946689513, 'recall': 0.4299921660271135, 'f1-score': 0.40944204923318117, 'support': 75313}, 'accuracy': 0.39200638816508365, 'macro avg': {'precision': 0.40761095394751656, 'recall': 0.40761187486067113, 'f1-score': 0.3820287422316549, 'support': 237940}, 'weighted avg': {'precision': 0.4118140818700653, 'recall': 0.39200638816508365, 'f1-score': 0.3747263041634972, 'support': 237940}}
[[42347 10126 19513]
 [41122 18543 30976]
 [31654 11275 32384]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0666212
{'0': {'precision': 0.41580065064160493, 'recall': 0.5681081581627928, 'f1-score': 0.4801659253075227, 'support': 32397}, '1': {'precision': 0.4142907426962337, 'recall': 0.21769420468557338, 'f1-score': 0.2854140565008286, 'support': 32440}, '2': {'precision': 0.42540734603700636, 'recall': 0.47131536272679986, 'f1-score': 0.4471862163064463, 'support': 32683}, 'accuracy': 0.41910377358490564, 'macro avg': {'precision': 0.41849957979161506, 'recall': 0.41903924185838864, 'f1-score': 0.4042553993715992, 'support': 97520}, 'weighted avg': {'precision': 0.41851798259259, 'recall': 0.41910377358490564, 'f1-score': 0.40432890261093396, 'support': 97520}}
[[18405  4871  9121]
 [13693  7062 11685]
 [12166  5113 15404]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0791762
{'0': {'precision': 0.3961577645175375, 'recall': 0.5681486119807974, 'f1-score': 0.46681529754759044, 'support': 9582}, '1': {'precision': 0.37596132718083936, 'recall': 0.17847084593720663, 'f1-score': 0.24204272174282082, 'support': 9587}, '2': {'precision': 0.41774851632047477, 'recall': 0.4546830843762616, 'f1-score': 0.43543398414846324, 'support': 9908}, 'accuracy': 0.4010042301475393, 'macro avg': {'precision': 0.3966225360062839, 'recall': 0.4004341807647552, 'f1-score': 0.3814306678129582, 'support': 29077}, 'weighted avg': {'precision': 0.39685583942611047, 'recall': 0.4010042301475393, 'f1-score': 0.3820121632008945, 'support': 29077}}
[[5444 1379 2759]
 [4356 1711 3520]
 [3942 1461 4505]]
training model: results/XRAY/W7/deepOF_L2/h100
Epoch 1/50
381/381 - 12s - loss: 3.3300 - accuracy100: 0.3405 - val_loss: 3.3220 - val_accuracy100: 0.3485 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 10s - loss: 3.2947 - accuracy100: 0.3623 - val_loss: 3.2983 - val_accuracy100: 0.3606 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2778 - accuracy100: 0.3723 - val_loss: 3.2961 - val_accuracy100: 0.3624 - 9s/epoch - 25ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2650 - accuracy100: 0.3820 - val_loss: 3.2926 - val_accuracy100: 0.3665 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 3.2575 - accuracy100: 0.3882 - val_loss: 3.2887 - val_accuracy100: 0.3742 - 10s/epoch - 26ms/step
Epoch 6/50
381/381 - 10s - loss: 3.2497 - accuracy100: 0.3928 - val_loss: 3.2870 - val_accuracy100: 0.3740 - 10s/epoch - 26ms/step
Epoch 7/50
381/381 - 10s - loss: 3.2433 - accuracy100: 0.3972 - val_loss: 3.2828 - val_accuracy100: 0.3762 - 10s/epoch - 26ms/step
Epoch 8/50
381/381 - 10s - loss: 3.2402 - accuracy100: 0.4008 - val_loss: 3.2835 - val_accuracy100: 0.3756 - 10s/epoch - 28ms/step
Epoch 9/50
381/381 - 10s - loss: 3.2343 - accuracy100: 0.4036 - val_loss: 3.2824 - val_accuracy100: 0.3766 - 10s/epoch - 27ms/step
Epoch 10/50
381/381 - 10s - loss: 3.2295 - accuracy100: 0.4060 - val_loss: 3.2805 - val_accuracy100: 0.3749 - 10s/epoch - 26ms/step
Epoch 11/50
381/381 - 10s - loss: 3.2247 - accuracy100: 0.4094 - val_loss: 3.2823 - val_accuracy100: 0.3788 - 10s/epoch - 25ms/step
Epoch 12/50
381/381 - 10s - loss: 3.2208 - accuracy100: 0.4098 - val_loss: 3.2867 - val_accuracy100: 0.3716 - 10s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2157 - accuracy100: 0.4136 - val_loss: 3.2850 - val_accuracy100: 0.3783 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.2104 - accuracy100: 0.4158 - val_loss: 3.2871 - val_accuracy100: 0.3779 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 3.2057 - accuracy100: 0.4190 - val_loss: 3.2899 - val_accuracy100: 0.3771 - 10s/epoch - 26ms/step
Epoch 16/50
381/381 - 10s - loss: 3.2006 - accuracy100: 0.4222 - val_loss: 3.2876 - val_accuracy100: 0.3792 - 10s/epoch - 26ms/step
Epoch 17/50
381/381 - 10s - loss: 3.1963 - accuracy100: 0.4237 - val_loss: 3.2966 - val_accuracy100: 0.3752 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 3.1915 - accuracy100: 0.4257 - val_loss: 3.2951 - val_accuracy100: 0.3768 - 10s/epoch - 25ms/step
Epoch 19/50
381/381 - 10s - loss: 3.1847 - accuracy100: 0.4295 - val_loss: 3.3005 - val_accuracy100: 0.3758 - 10s/epoch - 26ms/step
Epoch 20/50
381/381 - 10s - loss: 3.1791 - accuracy100: 0.4320 - val_loss: 3.3079 - val_accuracy100: 0.3748 - 10s/epoch - 25ms/step
testing model: results/XRAY/W7/deepOF_L2/h100
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938554
{'0': {'precision': 0.3655903919635597, 'recall': 0.6438429076531195, 'f1-score': 0.46636618994290335, 'support': 78909}, '1': {'precision': 0.3768474259656063, 'recall': 0.1748495972264709, 'f1-score': 0.23886886416270528, 'support': 78456}, '2': {'precision': 0.408000511419028, 'recall': 0.3168352466645982, 'f1-score': 0.3566847833680299, 'support': 80575}, 'accuracy': 0.37846515928385305, 'macro avg': {'precision': 0.38347944311606463, 'recall': 0.37850925051472956, 'f1-score': 0.3539732791578795, 'support': 237940}, 'weighted avg': {'precision': 0.38366376018575404, 'recall': 0.37846515928385316, 'f1-score': 0.3542114050131662, 'support': 237940}}
[[50805 10815 17289]
 [44985 13718 19753]
 [43177 11869 25529]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0800477
{'0': {'precision': 0.38350330606298333, 'recall': 0.6328247803975959, 'f1-score': 0.47758277799099824, 'support': 32445}, '1': {'precision': 0.4079056635110447, 'recall': 0.22852180385832144, 'f1-score': 0.2929331080409502, 'support': 32242}, '2': {'precision': 0.42671399359543194, 'recall': 0.33685621173819025, 'f1-score': 0.3764978213507625, 'support': 32833}, 'accuracy': 0.39950779327317476, 'macro avg': {'precision': 0.4060409877231533, 'recall': 0.3994009319980359, 'f1-score': 0.38233790246090366, 'support': 97520}, 'weighted avg': {'precision': 0.40611935725856657, 'recall': 0.39950779327317476, 'f1-score': 0.3825007738903183, 'support': 97520}}
[[20532  5035  6878]
 [16893  7368  7981]
 [16113  5660 11060]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0941823
{'0': {'precision': 0.3665514942110687, 'recall': 0.6278031561461794, 'f1-score': 0.46285736155229823, 'support': 9632}, '1': {'precision': 0.3702840186519712, 'recall': 0.18776870163370593, 'f1-score': 0.24917986021965485, 'support': 9304}, '2': {'precision': 0.4091834138895955, 'recall': 0.31722709791933734, 'f1-score': 0.3573848802977282, 'support': 10141}, 'accuracy': 0.37868418337517623, 'macro avg': {'precision': 0.38200630891754517, 'recall': 0.3775996518997409, 'f1-score': 0.3564740340232271, 'support': 29077}, 'weighted avg': {'precision': 0.3826142828363773, 'recall': 0.37868418337517623, 'f1-score': 0.3577002991042634, 'support': 29077}}
[[6047 1369 2216]
 [5128 1747 2429]
 [5322 1602 3217]]
training model: results/XRAY/W7/deepOF_L2/h200
Epoch 1/50
381/381 - 12s - loss: 3.3331 - accuracy200: 0.3446 - val_loss: 3.3317 - val_accuracy200: 0.3367 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 9s - loss: 3.2996 - accuracy200: 0.3601 - val_loss: 3.3111 - val_accuracy200: 0.3435 - 9s/epoch - 24ms/step
Epoch 3/50
381/381 - 10s - loss: 3.2827 - accuracy200: 0.3705 - val_loss: 3.3078 - val_accuracy200: 0.3493 - 10s/epoch - 25ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2705 - accuracy200: 0.3786 - val_loss: 3.3040 - val_accuracy200: 0.3498 - 10s/epoch - 25ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2630 - accuracy200: 0.3842 - val_loss: 3.2925 - val_accuracy200: 0.3557 - 9s/epoch - 25ms/step
Epoch 6/50
381/381 - 10s - loss: 3.2558 - accuracy200: 0.3883 - val_loss: 3.2913 - val_accuracy200: 0.3609 - 10s/epoch - 25ms/step
Epoch 7/50
381/381 - 10s - loss: 3.2492 - accuracy200: 0.3917 - val_loss: 3.2931 - val_accuracy200: 0.3619 - 10s/epoch - 26ms/step
Epoch 8/50
381/381 - 10s - loss: 3.2450 - accuracy200: 0.3967 - val_loss: 3.2917 - val_accuracy200: 0.3621 - 10s/epoch - 25ms/step
Epoch 9/50
381/381 - 10s - loss: 3.2414 - accuracy200: 0.3963 - val_loss: 3.2911 - val_accuracy200: 0.3620 - 10s/epoch - 25ms/step
Epoch 10/50
381/381 - 10s - loss: 3.2369 - accuracy200: 0.4004 - val_loss: 3.2907 - val_accuracy200: 0.3664 - 10s/epoch - 25ms/step
Epoch 11/50
381/381 - 9s - loss: 3.2325 - accuracy200: 0.4036 - val_loss: 3.2952 - val_accuracy200: 0.3638 - 9s/epoch - 25ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2269 - accuracy200: 0.4066 - val_loss: 3.2961 - val_accuracy200: 0.3660 - 9s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2257 - accuracy200: 0.4062 - val_loss: 3.2968 - val_accuracy200: 0.3625 - 10s/epoch - 25ms/step
Epoch 14/50
381/381 - 9s - loss: 3.2206 - accuracy200: 0.4095 - val_loss: 3.2996 - val_accuracy200: 0.3686 - 9s/epoch - 25ms/step
Epoch 15/50
381/381 - 9s - loss: 3.2168 - accuracy200: 0.4130 - val_loss: 3.3015 - val_accuracy200: 0.3627 - 9s/epoch - 25ms/step
Epoch 16/50
381/381 - 9s - loss: 3.2125 - accuracy200: 0.4136 - val_loss: 3.2983 - val_accuracy200: 0.3665 - 9s/epoch - 25ms/step
Epoch 17/50
381/381 - 9s - loss: 3.2089 - accuracy200: 0.4156 - val_loss: 3.3061 - val_accuracy200: 0.3631 - 9s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 3.2025 - accuracy200: 0.4201 - val_loss: 3.3057 - val_accuracy200: 0.3659 - 10s/epoch - 25ms/step
Epoch 19/50
381/381 - 9s - loss: 3.1997 - accuracy200: 0.4188 - val_loss: 3.3106 - val_accuracy200: 0.3645 - 9s/epoch - 24ms/step
Epoch 20/50
381/381 - 10s - loss: 3.1947 - accuracy200: 0.4218 - val_loss: 3.3152 - val_accuracy200: 0.3630 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepOF_L2/h200
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910679
{'0': {'precision': 0.35760347794583824, 'recall': 0.5114311990777322, 'f1-score': 0.42090282552728786, 'support': 77201}, '1': {'precision': 0.4082646395520647, 'recall': 0.506860887510409, 'f1-score': 0.4522513500562636, 'support': 82861}, '2': {'precision': 0.3866088085002839, 'recall': 0.12240940958935771, 'f1-score': 0.1859444487789654, 'support': 77878}, 'accuracy': 0.3825123980835505, 'macro avg': {'precision': 0.38415897533272897, 'recall': 0.38023383205916633, 'f1-score': 0.3530328747875056, 'support': 237940}, 'weighted avg': {'precision': 0.3847393594486232, 'recall': 0.3825123980835505, 'f1-score': 0.35491762600887816, 'support': 237940}}
[[39483 30479  7239]
 [32976 41999  7886]
 [37951 30394  9533]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0864267
{'0': {'precision': 0.383287963072553, 'recall': 0.5005564486212439, 'f1-score': 0.4341426139181961, 'support': 32348}, '1': {'precision': 0.3829000256563756, 'recall': 0.5575480215435384, 'f1-score': 0.4540073263787662, 'support': 32121}, '2': {'precision': 0.4329060331647654, 'recall': 0.11137333212308251, 'f1-score': 0.1771670597295086, 'support': 33051}, 'accuracy': 0.387428219852338, 'macro avg': {'precision': 0.399698007297898, 'recall': 0.38982593409595495, 'f1-score': 0.3551056666754903, 'support': 97520}, 'weighted avg': {'precision': 0.39997649770004146, 'recall': 0.387428219852338, 'f1-score': 0.3535927306886602, 'support': 97520}}
[[16192 13764  2392]
 [11782 17909  2430]
 [14271 15099  3681]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985057
{'0': {'precision': 0.3542919628212138, 'recall': 0.5451104100946372, 'f1-score': 0.42945903404854613, 'support': 9510}, '1': {'precision': 0.37134552915028207, 'recall': 0.4598285169895205, 'f1-score': 0.41087727595176166, 'support': 9447}, '2': {'precision': 0.39679650527848565, 'recall': 0.10770750988142293, 'f1-score': 0.16942566254760238, 'support': 10120}, 'accuracy': 0.3651683461154865, 'macro avg': {'precision': 0.37414466574999383, 'recall': 0.37088214565519356, 'f1-score': 0.33658732418263676, 'support': 29077}, 'weighted avg': {'precision': 0.3746259384988387, 'recall': 0.3651683461154865, 'f1-score': 0.3329195152422775, 'support': 29077}}
[[5184 3497  829]
 [4275 4344  828]
 [5173 3857 1090]]
training model: results/XRAY/W7/deepOF_L2/h300
Epoch 1/50
381/381 - 12s - loss: 3.3373 - accuracy300: 0.3369 - val_loss: 3.3384 - val_accuracy300: 0.3281 - 12s/epoch - 33ms/step
Epoch 2/50
381/381 - 10s - loss: 3.3084 - accuracy300: 0.3509 - val_loss: 3.3233 - val_accuracy300: 0.3311 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 10s - loss: 3.2961 - accuracy300: 0.3560 - val_loss: 3.3170 - val_accuracy300: 0.3312 - 10s/epoch - 25ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2854 - accuracy300: 0.3635 - val_loss: 3.3135 - val_accuracy300: 0.3314 - 10s/epoch - 26ms/step
Epoch 5/50
381/381 - 10s - loss: 3.2768 - accuracy300: 0.3680 - val_loss: 3.3055 - val_accuracy300: 0.3409 - 10s/epoch - 25ms/step
Epoch 6/50
381/381 - 10s - loss: 3.2722 - accuracy300: 0.3722 - val_loss: 3.3006 - val_accuracy300: 0.3463 - 10s/epoch - 25ms/step
Epoch 7/50
381/381 - 10s - loss: 3.2652 - accuracy300: 0.3779 - val_loss: 3.2994 - val_accuracy300: 0.3516 - 10s/epoch - 25ms/step
Epoch 8/50
381/381 - 10s - loss: 3.2602 - accuracy300: 0.3826 - val_loss: 3.2980 - val_accuracy300: 0.3523 - 10s/epoch - 25ms/step
Epoch 9/50
381/381 - 10s - loss: 3.2565 - accuracy300: 0.3849 - val_loss: 3.2966 - val_accuracy300: 0.3527 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 3.2517 - accuracy300: 0.3874 - val_loss: 3.2981 - val_accuracy300: 0.3558 - 10s/epoch - 25ms/step
Epoch 11/50
381/381 - 10s - loss: 3.2476 - accuracy300: 0.3904 - val_loss: 3.2973 - val_accuracy300: 0.3565 - 10s/epoch - 25ms/step
Epoch 12/50
381/381 - 10s - loss: 3.2433 - accuracy300: 0.3920 - val_loss: 3.2970 - val_accuracy300: 0.3555 - 10s/epoch - 26ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2400 - accuracy300: 0.3943 - val_loss: 3.2984 - val_accuracy300: 0.3585 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.2364 - accuracy300: 0.3969 - val_loss: 3.3007 - val_accuracy300: 0.3559 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 3.2321 - accuracy300: 0.3999 - val_loss: 3.3026 - val_accuracy300: 0.3609 - 10s/epoch - 26ms/step
Epoch 16/50
381/381 - 9s - loss: 3.2272 - accuracy300: 0.4017 - val_loss: 3.3020 - val_accuracy300: 0.3584 - 9s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 3.2230 - accuracy300: 0.4051 - val_loss: 3.3001 - val_accuracy300: 0.3588 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 9s - loss: 3.2187 - accuracy300: 0.4082 - val_loss: 3.3073 - val_accuracy300: 0.3600 - 9s/epoch - 24ms/step
Epoch 19/50
381/381 - 9s - loss: 3.2142 - accuracy300: 0.4091 - val_loss: 3.3134 - val_accuracy300: 0.3546 - 9s/epoch - 25ms/step
testing model: results/XRAY/W7/deepOF_L2/h300
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991485
{'0': {'precision': 0.34064822811252093, 'recall': 0.5924794269061405, 'f1-score': 0.4325818999859399, 'support': 77893}, '1': {'precision': 0.3839742375449896, 'recall': 0.35146516063510935, 'f1-score': 0.36700118979876883, 'support': 80742}, '2': {'precision': 0.3613474804776412, 'recall': 0.13011789924973205, 'f1-score': 0.19133707886002485, 'support': 79305}, 'accuracy': 0.3565898966125914, 'macro avg': {'precision': 0.36198998204505056, 'recall': 0.3580208289303273, 'f1-score': 0.33030672288157786, 'support': 237940}, 'weighted avg': {'precision': 0.3622494000987875, 'recall': 0.3565898966125914, 'f1-score': 0.32992140472947495, 'support': 237940}}
[[46150 22861  8882]
 [43008 28378  9356]
 [46319 22667 10319]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088301
{'0': {'precision': 0.3639680729760547, 'recall': 0.5940815187046343, 'f1-score': 0.45138937990525346, 'support': 32238}, '1': {'precision': 0.3881342157204226, 'recall': 0.4153052984657432, 'f1-score': 0.40126031507876964, 'support': 32198}, '2': {'precision': 0.4162519142419602, 'recall': 0.1314532704630637, 'f1-score': 0.19980703850041348, 'support': 33084}, 'accuracy': 0.3781070549630845, 'macro avg': {'precision': 0.38945140097947917, 'recall': 0.38028002921114706, 'f1-score': 0.35081891116147884, 'support': 97520}, 'weighted avg': {'precision': 0.3896844395523916, 'recall': 0.3781070549630845, 'f1-score': 0.3494881718215696, 'support': 97520}}
[[19152 10018  3068]
 [15795 13372  3031]
 [17673 11062  4349]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002741
{'0': {'precision': 0.3316600311580405, 'recall': 0.6236302484539438, 'f1-score': 0.4330269700165738, 'support': 9217}, '1': {'precision': 0.3844464987289115, 'recall': 0.33855703673552456, 'f1-score': 0.3600454520859261, 'support': 9827}, '2': {'precision': 0.3670763260025873, 'recall': 0.11312668194956643, 'f1-score': 0.17295238095238097, 'support': 10033}, 'accuracy': 0.3511366372046635, 'macro avg': {'precision': 0.3610609519631798, 'recall': 0.35843798904634494, 'f1-score': 0.32200826768496027, 'support': 29077}, 'weighted avg': {'precision': 0.36172036417019054, 'recall': 0.3511366372046635, 'f1-score': 0.31862322379841096, 'support': 29077}}
[[5748 2497  972]
 [5515 3327  985]
 [6068 2830 1135]]
training model: results/XRAY/W7/deepOF_L2/h500
Epoch 1/50
381/381 - 12s - loss: 3.3383 - accuracy500: 0.3394 - val_loss: 3.3508 - val_accuracy500: 0.3141 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 10s - loss: 3.3134 - accuracy500: 0.3477 - val_loss: 3.3348 - val_accuracy500: 0.3166 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 10s - loss: 3.3019 - accuracy500: 0.3510 - val_loss: 3.3240 - val_accuracy500: 0.3192 - 10s/epoch - 26ms/step
Epoch 4/50
381/381 - 9s - loss: 3.2934 - accuracy500: 0.3557 - val_loss: 3.3194 - val_accuracy500: 0.3182 - 9s/epoch - 24ms/step
Epoch 5/50
381/381 - 10s - loss: 3.2845 - accuracy500: 0.3621 - val_loss: 3.3139 - val_accuracy500: 0.3282 - 10s/epoch - 25ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2803 - accuracy500: 0.3670 - val_loss: 3.3064 - val_accuracy500: 0.3376 - 9s/epoch - 25ms/step
Epoch 7/50
381/381 - 10s - loss: 3.2747 - accuracy500: 0.3696 - val_loss: 3.3021 - val_accuracy500: 0.3438 - 10s/epoch - 25ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2716 - accuracy500: 0.3724 - val_loss: 3.3004 - val_accuracy500: 0.3449 - 9s/epoch - 25ms/step
Epoch 9/50
381/381 - 10s - loss: 3.2671 - accuracy500: 0.3755 - val_loss: 3.3014 - val_accuracy500: 0.3431 - 10s/epoch - 26ms/step
Epoch 10/50
381/381 - 10s - loss: 3.2635 - accuracy500: 0.3771 - val_loss: 3.3002 - val_accuracy500: 0.3454 - 10s/epoch - 26ms/step
Epoch 11/50
381/381 - 10s - loss: 3.2597 - accuracy500: 0.3795 - val_loss: 3.3026 - val_accuracy500: 0.3497 - 10s/epoch - 25ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2551 - accuracy500: 0.3846 - val_loss: 3.3003 - val_accuracy500: 0.3507 - 9s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2528 - accuracy500: 0.3847 - val_loss: 3.3012 - val_accuracy500: 0.3533 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.2473 - accuracy500: 0.3886 - val_loss: 3.3025 - val_accuracy500: 0.3515 - 10s/epoch - 26ms/step
Epoch 15/50
381/381 - 10s - loss: 3.2453 - accuracy500: 0.3900 - val_loss: 3.3043 - val_accuracy500: 0.3552 - 10s/epoch - 25ms/step
Epoch 16/50
381/381 - 9s - loss: 3.2403 - accuracy500: 0.3928 - val_loss: 3.3062 - val_accuracy500: 0.3548 - 9s/epoch - 24ms/step
Epoch 17/50
381/381 - 10s - loss: 3.2356 - accuracy500: 0.3959 - val_loss: 3.3081 - val_accuracy500: 0.3522 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 3.2318 - accuracy500: 0.3989 - val_loss: 3.3075 - val_accuracy500: 0.3570 - 10s/epoch - 25ms/step
Epoch 19/50
381/381 - 10s - loss: 3.2283 - accuracy500: 0.4016 - val_loss: 3.3117 - val_accuracy500: 0.3549 - 10s/epoch - 25ms/step
Epoch 20/50
381/381 - 10s - loss: 3.2242 - accuracy500: 0.4029 - val_loss: 3.3198 - val_accuracy500: 0.3521 - 10s/epoch - 26ms/step
testing model: results/XRAY/W7/deepOF_L2/h500
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970067
{'0': {'precision': 0.33272167852906287, 'recall': 0.464324051680656, 'f1-score': 0.38765825347550276, 'support': 77321}, '1': {'precision': 0.38400535065927766, 'recall': 0.49362548822127783, 'f1-score': 0.43196938918088107, 'support': 81418}, '2': {'precision': 0.36743379571248425, 'recall': 0.11772578629057714, 'f1-score': 0.17831836828365702, 'support': 79201}, 'accuracy': 0.35898125577876777, 'macro avg': {'precision': 0.36138694163360824, 'recall': 0.3585584420641703, 'f1-score': 0.33264867031334694, 'support': 237940}, 'weighted avg': {'precision': 0.361824176682135, 'recall': 0.35898125577876777, 'f1-score': 0.33313944957443997, 'support': 237940}}
[[35902 33309  8110]
 [33286 40190  7942]
 [38716 31161  9324]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0906074
{'0': {'precision': 0.3624431859611599, 'recall': 0.4641434262948207, 'f1-score': 0.4070368904477897, 'support': 32128}, '1': {'precision': 0.3722519625060832, 'recall': 0.5464682860160278, 'f1-score': 0.44284186017242455, 'support': 32194}, '2': {'precision': 0.4131197893813076, 'recall': 0.11344056870895837, 'f1-score': 0.17800255234674103, 'support': 33198}, 'accuracy': 0.37193396226415093, 'macro avg': {'precision': 0.38260497928285025, 'recall': 0.37468409367326894, 'f1-score': 0.34262710098898513, 'support': 97520}, 'weighted avg': {'precision': 0.38293278432487327, 'recall': 0.37193396226415093, 'f1-score': 0.3408886463854054, 'support': 97520}}
[[14912 14419  2797]
 [12048 17593  2553]
 [14183 15249  3766]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010733
{'0': {'precision': 0.3159584795758345, 'recall': 0.48310116464946334, 'f1-score': 0.38204885096392616, 'support': 8758}, '1': {'precision': 0.37363834422657954, 'recall': 0.47474048442906575, 'f1-score': 0.41816519353855536, 'support': 10115}, '2': {'precision': 0.37191249117854625, 'recall': 0.10329282634261074, 'f1-score': 0.16168123945390397, 'support': 10204}, 'accuracy': 0.34690648966537124, 'macro avg': {'precision': 0.35383643832698675, 'recall': 0.3537114918070466, 'f1-score': 0.32063176131879517, 'support': 29077}, 'weighted avg': {'precision': 0.35565949980957107, 'recall': 0.34690648966537124, 'f1-score': 0.31727895370128245, 'support': 29077}}
[[4231 3680  847]
 [4380 4802  933]
 [4780 4370 1054]]
training model: results/XRAY/W7/deepOF_L2/h1000
Epoch 1/50
381/381 - 12s - loss: 3.3390 - accuracy1000: 0.3455 - val_loss: 3.3656 - val_accuracy1000: 0.3098 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 10s - loss: 3.3120 - accuracy1000: 0.3540 - val_loss: 3.3468 - val_accuracy1000: 0.3108 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 10s - loss: 3.2963 - accuracy1000: 0.3610 - val_loss: 3.3322 - val_accuracy1000: 0.3157 - 10s/epoch - 25ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2889 - accuracy1000: 0.3674 - val_loss: 3.3241 - val_accuracy1000: 0.3160 - 10s/epoch - 25ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2814 - accuracy1000: 0.3697 - val_loss: 3.3143 - val_accuracy1000: 0.3215 - 9s/epoch - 25ms/step
Epoch 6/50
381/381 - 10s - loss: 3.2780 - accuracy1000: 0.3734 - val_loss: 3.3089 - val_accuracy1000: 0.3275 - 10s/epoch - 25ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2737 - accuracy1000: 0.3760 - val_loss: 3.3018 - val_accuracy1000: 0.3352 - 9s/epoch - 25ms/step
Epoch 8/50
381/381 - 10s - loss: 3.2695 - accuracy1000: 0.3777 - val_loss: 3.3021 - val_accuracy1000: 0.3369 - 10s/epoch - 25ms/step
Epoch 9/50
381/381 - 9s - loss: 3.2662 - accuracy1000: 0.3814 - val_loss: 3.3008 - val_accuracy1000: 0.3402 - 9s/epoch - 25ms/step
Epoch 10/50
381/381 - 10s - loss: 3.2632 - accuracy1000: 0.3813 - val_loss: 3.2983 - val_accuracy1000: 0.3389 - 10s/epoch - 25ms/step
Epoch 11/50
381/381 - 10s - loss: 3.2596 - accuracy1000: 0.3844 - val_loss: 3.2983 - val_accuracy1000: 0.3392 - 10s/epoch - 26ms/step
Epoch 12/50
381/381 - 10s - loss: 3.2559 - accuracy1000: 0.3865 - val_loss: 3.2994 - val_accuracy1000: 0.3432 - 10s/epoch - 25ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2528 - accuracy1000: 0.3889 - val_loss: 3.2987 - val_accuracy1000: 0.3441 - 10s/epoch - 26ms/step
Epoch 14/50
381/381 - 10s - loss: 3.2496 - accuracy1000: 0.3908 - val_loss: 3.2985 - val_accuracy1000: 0.3435 - 10s/epoch - 25ms/step
Epoch 15/50
381/381 - 10s - loss: 3.2459 - accuracy1000: 0.3929 - val_loss: 3.3013 - val_accuracy1000: 0.3440 - 10s/epoch - 25ms/step
Epoch 16/50
381/381 - 10s - loss: 3.2427 - accuracy1000: 0.3936 - val_loss: 3.2998 - val_accuracy1000: 0.3452 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 10s - loss: 3.2404 - accuracy1000: 0.3962 - val_loss: 3.3026 - val_accuracy1000: 0.3464 - 10s/epoch - 25ms/step
Epoch 18/50
381/381 - 10s - loss: 3.2356 - accuracy1000: 0.3974 - val_loss: 3.3058 - val_accuracy1000: 0.3424 - 10s/epoch - 26ms/step
Epoch 19/50
381/381 - 9s - loss: 3.2319 - accuracy1000: 0.3992 - val_loss: 3.3062 - val_accuracy1000: 0.3448 - 9s/epoch - 25ms/step
Epoch 20/50
381/381 - 9s - loss: 3.2275 - accuracy1000: 0.4030 - val_loss: 3.3124 - val_accuracy1000: 0.3395 - 9s/epoch - 25ms/step
testing model: results/XRAY/W7/deepOF_L2/h1000
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969132
{'0': {'precision': 0.33266903552438537, 'recall': 0.5116673405767801, 'f1-score': 0.4031944744226203, 'support': 76667}, '1': {'precision': 0.4025641025641026, 'recall': 0.46228851398643594, 'f1-score': 0.430364104119623, 'support': 82866}, '2': {'precision': 0.35722617754716224, 'recall': 0.11326794801484562, 'f1-score': 0.1719990703799822, 'support': 78407}, 'accuracy': 0.363188198705556, 'macro avg': {'precision': 0.36415310521188343, 'recall': 0.3624079341926872, 'f1-score': 0.3351858829740751, 'support': 237940}, 'weighted avg': {'precision': 0.36510316370751167, 'recall': 0.363188198705556, 'f1-score': 0.33647219355223573, 'support': 237940}}
[[39228 29755  7684]
 [36262 38308  8296]
 [42429 27097  8881]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0882256
{'0': {'precision': 0.3680280876405493, 'recall': 0.5160787735261124, 'f1-score': 0.42965730147612, 'support': 32092}, '1': {'precision': 0.38857017308302616, 'recall': 0.49414796187637766, 'f1-score': 0.4350452346461859, 'support': 32211}, '2': {'precision': 0.39619212462137604, 'recall': 0.13782099527350453, 'f1-score': 0.2045028142589118, 'support': 33217}, 'accuracy': 0.3799938474159147, 'macro avg': {'precision': 0.3842634617816505, 'recall': 0.3826825768919982, 'f1-score': 0.3564017834604059, 'support': 97520}, 'weighted avg': {'precision': 0.3844063272896443, 'recall': 0.3799938474159147, 'f1-score': 0.3547454281521556, 'support': 97520}}
[[16562 12011  3519]
 [12836 15917  3458]
 [15604 13035  4578]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007074
{'0': {'precision': 0.31687163720215217, 'recall': 0.5620952164526758, 'f1-score': 0.4052758776061934, 'support': 8801}, '1': {'precision': 0.3567567567567568, 'recall': 0.3751578947368421, 'f1-score': 0.36572601334017446, 'support': 9500}, '2': {'precision': 0.3697841726618705, 'recall': 0.11924647364513734, 'f1-score': 0.18033822187916637, 'support': 10776}, 'accuracy': 0.3368985796333872, 'macro avg': {'precision': 0.34780418887359316, 'recall': 0.3521665282782184, 'f1-score': 0.3171133709418447, 'support': 29077}, 'weighted avg': {'precision': 0.3495123538470147, 'recall': 0.3368985796333872, 'f1-score': 0.30899180811341137, 'support': 29077}}
[[4947 2811 1043]
 [4789 3564 1147]
 [5876 3615 1285]]
training model: results/XRAY/W7/deepVOL_L2/h10
Epoch 1/50
381/381 - 12s - loss: 3.2859 - accuracy10: 0.3896 - val_loss: 3.2557 - val_accuracy10: 0.4105 - 12s/epoch - 31ms/step
Epoch 2/50
381/381 - 9s - loss: 3.1476 - accuracy10: 0.4466 - val_loss: 3.1837 - val_accuracy10: 0.4406 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 8s - loss: 3.0880 - accuracy10: 0.4671 - val_loss: 3.1468 - val_accuracy10: 0.4569 - 8s/epoch - 22ms/step
Epoch 4/50
381/381 - 9s - loss: 3.0567 - accuracy10: 0.4778 - val_loss: 3.1294 - val_accuracy10: 0.4582 - 9s/epoch - 22ms/step
Epoch 5/50
381/381 - 9s - loss: 3.0381 - accuracy10: 0.4857 - val_loss: 3.1297 - val_accuracy10: 0.4604 - 9s/epoch - 23ms/step
Epoch 6/50
381/381 - 8s - loss: 3.0243 - accuracy10: 0.4893 - val_loss: 3.1137 - val_accuracy10: 0.4642 - 8s/epoch - 22ms/step
Epoch 7/50
381/381 - 9s - loss: 3.0135 - accuracy10: 0.4920 - val_loss: 3.1167 - val_accuracy10: 0.4638 - 9s/epoch - 24ms/step
Epoch 8/50
381/381 - 9s - loss: 3.0035 - accuracy10: 0.4968 - val_loss: 3.1071 - val_accuracy10: 0.4666 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 8s - loss: 2.9954 - accuracy10: 0.4979 - val_loss: 3.1064 - val_accuracy10: 0.4652 - 8s/epoch - 22ms/step
Epoch 10/50
381/381 - 9s - loss: 2.9854 - accuracy10: 0.5017 - val_loss: 3.1118 - val_accuracy10: 0.4688 - 9s/epoch - 22ms/step
Epoch 11/50
381/381 - 9s - loss: 2.9792 - accuracy10: 0.5043 - val_loss: 3.1046 - val_accuracy10: 0.4658 - 9s/epoch - 23ms/step
Epoch 12/50
381/381 - 8s - loss: 2.9720 - accuracy10: 0.5059 - val_loss: 3.0970 - val_accuracy10: 0.4684 - 8s/epoch - 22ms/step
Epoch 13/50
381/381 - 8s - loss: 2.9681 - accuracy10: 0.5072 - val_loss: 3.1019 - val_accuracy10: 0.4679 - 8s/epoch - 22ms/step
Epoch 14/50
381/381 - 8s - loss: 2.9616 - accuracy10: 0.5082 - val_loss: 3.0986 - val_accuracy10: 0.4708 - 8s/epoch - 22ms/step
Epoch 15/50
381/381 - 8s - loss: 2.9533 - accuracy10: 0.5118 - val_loss: 3.0985 - val_accuracy10: 0.4709 - 8s/epoch - 22ms/step
Epoch 16/50
381/381 - 8s - loss: 2.9482 - accuracy10: 0.5122 - val_loss: 3.1026 - val_accuracy10: 0.4697 - 8s/epoch - 22ms/step
Epoch 17/50
381/381 - 8s - loss: 2.9434 - accuracy10: 0.5145 - val_loss: 3.0949 - val_accuracy10: 0.4712 - 8s/epoch - 22ms/step
Epoch 18/50
381/381 - 8s - loss: 2.9365 - accuracy10: 0.5154 - val_loss: 3.0937 - val_accuracy10: 0.4712 - 8s/epoch - 22ms/step
Epoch 19/50
381/381 - 8s - loss: 2.9303 - accuracy10: 0.5168 - val_loss: 3.0933 - val_accuracy10: 0.4726 - 8s/epoch - 22ms/step
Epoch 20/50
381/381 - 8s - loss: 2.9250 - accuracy10: 0.5169 - val_loss: 3.0960 - val_accuracy10: 0.4730 - 8s/epoch - 22ms/step
Epoch 21/50
381/381 - 8s - loss: 2.9204 - accuracy10: 0.5194 - val_loss: 3.0839 - val_accuracy10: 0.4747 - 8s/epoch - 22ms/step
Epoch 22/50
381/381 - 8s - loss: 2.9129 - accuracy10: 0.5219 - val_loss: 3.1037 - val_accuracy10: 0.4706 - 8s/epoch - 21ms/step
Epoch 23/50
381/381 - 8s - loss: 2.9096 - accuracy10: 0.5230 - val_loss: 3.1046 - val_accuracy10: 0.4730 - 8s/epoch - 22ms/step
Epoch 24/50
381/381 - 9s - loss: 2.9060 - accuracy10: 0.5240 - val_loss: 3.0950 - val_accuracy10: 0.4744 - 9s/epoch - 23ms/step
Epoch 25/50
381/381 - 9s - loss: 2.9008 - accuracy10: 0.5233 - val_loss: 3.1056 - val_accuracy10: 0.4695 - 9s/epoch - 23ms/step
Epoch 26/50
381/381 - 9s - loss: 2.8951 - accuracy10: 0.5267 - val_loss: 3.1060 - val_accuracy10: 0.4722 - 9s/epoch - 23ms/step
Epoch 27/50
381/381 - 9s - loss: 2.8938 - accuracy10: 0.5257 - val_loss: 3.1008 - val_accuracy10: 0.4719 - 9s/epoch - 23ms/step
Epoch 28/50
381/381 - 9s - loss: 2.8868 - accuracy10: 0.5273 - val_loss: 3.1114 - val_accuracy10: 0.4676 - 9s/epoch - 23ms/step
Epoch 29/50
381/381 - 9s - loss: 2.8823 - accuracy10: 0.5285 - val_loss: 3.1112 - val_accuracy10: 0.4731 - 9s/epoch - 23ms/step
Epoch 30/50
381/381 - 9s - loss: 2.8770 - accuracy10: 0.5311 - val_loss: 3.1154 - val_accuracy10: 0.4714 - 9s/epoch - 23ms/step
Epoch 31/50
381/381 - 9s - loss: 2.8723 - accuracy10: 0.5312 - val_loss: 3.1149 - val_accuracy10: 0.4723 - 9s/epoch - 23ms/step
testing model: results/XRAY/W7/deepVOL_L2/h10
Evaluating performance on  test set...
930/930 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0601275
{'0': {'precision': 0.37836420831876966, 'recall': 0.6828673835125448, 'f1-score': 0.4869296748009037, 'support': 69750}, '1': {'precision': 0.6024656502917373, 'recall': 0.33374692413562995, 'f1-score': 0.429541459225164, 'support': 95908}, '2': {'precision': 0.46815767592608304, 'recall': 0.38165921950004844, 'f1-score': 0.4205063329726105, 'support': 72287}, 'accuracy': 0.45064195507365146, 'macro avg': {'precision': 0.48299584484553, 'recall': 0.46609117571607445, 'f1-score': 0.4456591556662261, 'support': 237945}, 'weighted avg': {'precision': 0.4959713086557099, 'recall': 0.45064195507365146, 'f1-score': 0.4436191068537736, 'support': 237945}}
[[47630 10253 11867]
 [44424 32009 19475]
 [33830 10868 27589]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9964669
{'0': {'precision': 0.4548667932185639, 'recall': 0.6633679119200662, 'f1-score': 0.5396792523654814, 'support': 31426}, '1': {'precision': 0.6229822292474972, 'recall': 0.37202517162471394, 'f1-score': 0.46585597363755216, 'support': 34960}, '2': {'precision': 0.49693311264725926, 'recall': 0.49179380118837324, 'f1-score': 0.49435010008394137, 'support': 31135}, 'accuracy': 0.5041478245711181, 'macro avg': {'precision': 0.5249273783711068, 'recall': 0.5090622949110511, 'f1-score': 0.49996177536232506, 'support': 97521}, 'weighted avg': {'precision': 0.5285642583694948, 'recall': 0.5041478245711181, 'f1-score': 0.4987425825137146, 'support': 97521}}
[[20847  3763  6816]
 [13269 13006  8685]
 [11715  4108 15312]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0329926
{'0': {'precision': 0.44671636492722755, 'recall': 0.6450025627883137, 'f1-score': 0.5278523489932886, 'support': 9755}, '1': {'precision': 0.5524714828897338, 'recall': 0.29820420728578756, 'f1-score': 0.3873375541486171, 'support': 9745}, '2': {'precision': 0.468557336621455, 'recall': 0.476140753889527, 'f1-score': 0.47231860790305036, 'support': 9577}, 'accuracy': 0.4731574784193693, 'macro avg': {'precision': 0.48924839481280546, 'recall': 0.4731158413212094, 'f1-score': 0.46250283701498535, 'support': 29077}, 'weighted avg': {'precision': 0.48935331545376876, 'recall': 0.4731574784193693, 'f1-score': 0.46246859846254146, 'support': 29077}}
[[6292 1120 2343]
 [4010 2906 2829]
 [3783 1234 4560]]
training model: results/XRAY/W7/deepVOL_L2/h20
Epoch 1/50
381/381 - 11s - loss: 3.2997 - accuracy20: 0.3808 - val_loss: 3.2875 - val_accuracy20: 0.3929 - 11s/epoch - 29ms/step
Epoch 2/50
381/381 - 9s - loss: 3.1986 - accuracy20: 0.4259 - val_loss: 3.2471 - val_accuracy20: 0.4136 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 9s - loss: 3.1547 - accuracy20: 0.4438 - val_loss: 3.2204 - val_accuracy20: 0.4257 - 9s/epoch - 22ms/step
Epoch 4/50
381/381 - 9s - loss: 3.1386 - accuracy20: 0.4503 - val_loss: 3.2114 - val_accuracy20: 0.4279 - 9s/epoch - 22ms/step
Epoch 5/50
381/381 - 9s - loss: 3.1263 - accuracy20: 0.4564 - val_loss: 3.1954 - val_accuracy20: 0.4342 - 9s/epoch - 22ms/step
Epoch 6/50
381/381 - 8s - loss: 3.1125 - accuracy20: 0.4610 - val_loss: 3.1985 - val_accuracy20: 0.4351 - 8s/epoch - 22ms/step
Epoch 7/50
381/381 - 8s - loss: 3.1011 - accuracy20: 0.4677 - val_loss: 3.1814 - val_accuracy20: 0.4387 - 8s/epoch - 22ms/step
Epoch 8/50
381/381 - 9s - loss: 3.0940 - accuracy20: 0.4710 - val_loss: 3.1830 - val_accuracy20: 0.4378 - 9s/epoch - 22ms/step
Epoch 9/50
381/381 - 9s - loss: 3.0860 - accuracy20: 0.4730 - val_loss: 3.1757 - val_accuracy20: 0.4409 - 9s/epoch - 23ms/step
Epoch 10/50
381/381 - 9s - loss: 3.0788 - accuracy20: 0.4752 - val_loss: 3.1824 - val_accuracy20: 0.4387 - 9s/epoch - 24ms/step
Epoch 11/50
381/381 - 9s - loss: 3.0771 - accuracy20: 0.4761 - val_loss: 3.1830 - val_accuracy20: 0.4373 - 9s/epoch - 22ms/step
Epoch 12/50
381/381 - 9s - loss: 3.0716 - accuracy20: 0.4788 - val_loss: 3.1810 - val_accuracy20: 0.4415 - 9s/epoch - 23ms/step
Epoch 13/50
381/381 - 9s - loss: 3.0638 - accuracy20: 0.4829 - val_loss: 3.1737 - val_accuracy20: 0.4435 - 9s/epoch - 23ms/step
Epoch 14/50
381/381 - 9s - loss: 3.0588 - accuracy20: 0.4844 - val_loss: 3.1817 - val_accuracy20: 0.4411 - 9s/epoch - 23ms/step
Epoch 15/50
381/381 - 9s - loss: 3.0534 - accuracy20: 0.4841 - val_loss: 3.1726 - val_accuracy20: 0.4432 - 9s/epoch - 23ms/step
Epoch 16/50
381/381 - 9s - loss: 3.0478 - accuracy20: 0.4867 - val_loss: 3.1707 - val_accuracy20: 0.4446 - 9s/epoch - 24ms/step
Epoch 17/50
381/381 - 9s - loss: 3.0435 - accuracy20: 0.4881 - val_loss: 3.1731 - val_accuracy20: 0.4432 - 9s/epoch - 23ms/step
Epoch 18/50
381/381 - 9s - loss: 3.0393 - accuracy20: 0.4880 - val_loss: 3.1784 - val_accuracy20: 0.4418 - 9s/epoch - 24ms/step
Epoch 19/50
381/381 - 9s - loss: 3.0356 - accuracy20: 0.4906 - val_loss: 3.1772 - val_accuracy20: 0.4423 - 9s/epoch - 23ms/step
Epoch 20/50
381/381 - 9s - loss: 3.0283 - accuracy20: 0.4910 - val_loss: 3.1733 - val_accuracy20: 0.4440 - 9s/epoch - 23ms/step
Epoch 21/50
381/381 - 9s - loss: 3.0236 - accuracy20: 0.4937 - val_loss: 3.1766 - val_accuracy20: 0.4445 - 9s/epoch - 22ms/step
Epoch 22/50
381/381 - 9s - loss: 3.0163 - accuracy20: 0.4956 - val_loss: 3.1824 - val_accuracy20: 0.4431 - 9s/epoch - 23ms/step
Epoch 23/50
381/381 - 9s - loss: 3.0135 - accuracy20: 0.4981 - val_loss: 3.1814 - val_accuracy20: 0.4433 - 9s/epoch - 23ms/step
Epoch 24/50
381/381 - 9s - loss: 3.0093 - accuracy20: 0.4979 - val_loss: 3.1861 - val_accuracy20: 0.4434 - 9s/epoch - 23ms/step
Epoch 25/50
381/381 - 9s - loss: 3.0059 - accuracy20: 0.4990 - val_loss: 3.1793 - val_accuracy20: 0.4412 - 9s/epoch - 23ms/step
Epoch 26/50
381/381 - 9s - loss: 2.9984 - accuracy20: 0.5017 - val_loss: 3.1807 - val_accuracy20: 0.4452 - 9s/epoch - 23ms/step
testing model: results/XRAY/W7/deepVOL_L2/h20
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0679101
{'0': {'precision': 0.38159739201303994, 'recall': 0.6374416293412114, 'f1-score': 0.47740284369854147, 'support': 73453}, '1': {'precision': 0.5259347490275632, 'recall': 0.31895393853203763, 'f1-score': 0.3970912667743975, 'support': 88599}, '2': {'precision': 0.46061059271060245, 'recall': 0.37334141488674844, 'f1-score': 0.4124098481154526, 'support': 75893}, 'accuracy': 0.4346172434806363, 'macro avg': {'precision': 0.45604757791706857, 'recall': 0.4432456609199991, 'f1-score': 0.42896798619613047, 'support': 237945}, 'weighted avg': {'precision': 0.4605429228486106, 'recall': 0.4346172434806363, 'f1-score': 0.4267691307914007, 'support': 237945}}
[[46822 12947 13684]
 [40844 28259 19496]
 [35034 12525 28334]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0268066
{'0': {'precision': 0.4482349059716265, 'recall': 0.6247585762898924, 'f1-score': 0.5219763331796526, 'support': 32619}, '1': {'precision': 0.5387126194019104, 'recall': 0.34460206337509214, 'f1-score': 0.42032920731821505, 'support': 32568}, '2': {'precision': 0.4719597732440829, 'recall': 0.4557431805529783, 'f1-score': 0.46370974086253286, 'support': 32334}, 'accuracy': 0.475159196480758, 'macro avg': {'precision': 0.48630243287254, 'recall': 0.47503460673932096, 'f1-score': 0.46867176045346687, 'support': 97521}, 'weighted avg': {'precision': 0.4863169398862202, 'recall': 0.475159196480758, 'f1-score': 0.4687115431237975, 'support': 97521}}
[[20379  4581  7659]
 [12517 11223  8828]
 [12569  5029 14736]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0568733
{'0': {'precision': 0.4308823529411765, 'recall': 0.6218920557913887, 'f1-score': 0.5090593199305039, 'support': 9894}, '1': {'precision': 0.46843532145623545, 'recall': 0.2593267581475129, 'f1-score': 0.3338393596467017, 'support': 9328}, '2': {'precision': 0.456347970518011, 'recall': 0.4460679857940132, 'f1-score': 0.45114942528735635, 'support': 9855}, 'accuracy': 0.4459882381263542, 'macro avg': {'precision': 0.45188854830514097, 'recall': 0.442428933244305, 'f1-score': 0.4313493682881873, 'support': 29077}, 'weighted avg': {'precision': 0.45156047487700807, 'recall': 0.4459882381263542, 'f1-score': 0.43322089776743594, 'support': 29077}}
[[6153 1320 2421]
 [4093 2419 2816]
 [4034 1425 4396]]
training model: results/XRAY/W7/deepVOL_L2/h30
Epoch 1/50
381/381 - 11s - loss: 3.3212 - accuracy30: 0.3659 - val_loss: 3.2947 - val_accuracy30: 0.3766 - 11s/epoch - 29ms/step
Epoch 2/50
381/381 - 9s - loss: 3.2492 - accuracy30: 0.3984 - val_loss: 3.2686 - val_accuracy30: 0.3907 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2122 - accuracy30: 0.4174 - val_loss: 3.2662 - val_accuracy30: 0.3987 - 9s/epoch - 24ms/step
Epoch 4/50
381/381 - 8s - loss: 3.1938 - accuracy30: 0.4275 - val_loss: 3.2592 - val_accuracy30: 0.4035 - 8s/epoch - 22ms/step
Epoch 5/50
381/381 - 9s - loss: 3.1826 - accuracy30: 0.4355 - val_loss: 3.2483 - val_accuracy30: 0.4083 - 9s/epoch - 22ms/step
Epoch 6/50
381/381 - 9s - loss: 3.1739 - accuracy30: 0.4388 - val_loss: 3.2463 - val_accuracy30: 0.4156 - 9s/epoch - 22ms/step
Epoch 7/50
381/381 - 9s - loss: 3.1672 - accuracy30: 0.4431 - val_loss: 3.2410 - val_accuracy30: 0.4155 - 9s/epoch - 22ms/step
Epoch 8/50
381/381 - 9s - loss: 3.1611 - accuracy30: 0.4455 - val_loss: 3.2456 - val_accuracy30: 0.4167 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 8s - loss: 3.1535 - accuracy30: 0.4461 - val_loss: 3.2386 - val_accuracy30: 0.4177 - 8s/epoch - 22ms/step
Epoch 10/50
381/381 - 8s - loss: 3.1504 - accuracy30: 0.4493 - val_loss: 3.2473 - val_accuracy30: 0.4168 - 8s/epoch - 21ms/step
Epoch 11/50
381/381 - 8s - loss: 3.1443 - accuracy30: 0.4524 - val_loss: 3.2389 - val_accuracy30: 0.4200 - 8s/epoch - 21ms/step
Epoch 12/50
381/381 - 8s - loss: 3.1368 - accuracy30: 0.4554 - val_loss: 3.2317 - val_accuracy30: 0.4226 - 8s/epoch - 22ms/step
Epoch 13/50
381/381 - 8s - loss: 3.1316 - accuracy30: 0.4568 - val_loss: 3.2226 - val_accuracy30: 0.4241 - 8s/epoch - 22ms/step
Epoch 14/50
381/381 - 8s - loss: 3.1259 - accuracy30: 0.4590 - val_loss: 3.2293 - val_accuracy30: 0.4237 - 8s/epoch - 22ms/step
Epoch 15/50
381/381 - 9s - loss: 3.1212 - accuracy30: 0.4607 - val_loss: 3.2253 - val_accuracy30: 0.4247 - 9s/epoch - 23ms/step
Epoch 16/50
381/381 - 10s - loss: 3.1148 - accuracy30: 0.4628 - val_loss: 3.2293 - val_accuracy30: 0.4244 - 10s/epoch - 25ms/step
Epoch 17/50
381/381 - 9s - loss: 3.1109 - accuracy30: 0.4645 - val_loss: 3.2289 - val_accuracy30: 0.4241 - 9s/epoch - 24ms/step
Epoch 18/50
381/381 - 9s - loss: 3.1049 - accuracy30: 0.4655 - val_loss: 3.2314 - val_accuracy30: 0.4244 - 9s/epoch - 24ms/step
Epoch 19/50
381/381 - 9s - loss: 3.1004 - accuracy30: 0.4668 - val_loss: 3.2306 - val_accuracy30: 0.4270 - 9s/epoch - 23ms/step
Epoch 20/50
381/381 - 9s - loss: 3.0969 - accuracy30: 0.4690 - val_loss: 3.2278 - val_accuracy30: 0.4251 - 9s/epoch - 24ms/step
Epoch 21/50
381/381 - 9s - loss: 3.0918 - accuracy30: 0.4700 - val_loss: 3.2339 - val_accuracy30: 0.4217 - 9s/epoch - 24ms/step
Epoch 22/50
381/381 - 9s - loss: 3.0853 - accuracy30: 0.4725 - val_loss: 3.2418 - val_accuracy30: 0.4215 - 9s/epoch - 23ms/step
Epoch 23/50
381/381 - 9s - loss: 3.0797 - accuracy30: 0.4733 - val_loss: 3.2359 - val_accuracy30: 0.4222 - 9s/epoch - 25ms/step
testing model: results/XRAY/W7/deepVOL_L2/h30
Evaluating performance on  test set...
930/930 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0851593
{'0': {'precision': 0.3722989420281863, 'recall': 0.6269151688001592, 'f1-score': 0.4671668495398515, 'support': 75385}, '1': {'precision': 0.4584455523083682, 'recall': 0.28441247570744654, 'f1-score': 0.3510432130816653, 'support': 84388}, '2': {'precision': 0.46053775724199075, 'recall': 0.34553292739088165, 'f1-score': 0.3948312783669412, 'support': 78172}, 'accuracy': 0.41300300489608943, 'macro avg': {'precision': 0.43042741719284844, 'recall': 0.4189535239661624, 'f1-score': 0.40434711366281934, 'support': 237945}, 'weighted avg': {'precision': 0.43184020076956564, 'recall': 0.41300300489608943, 'f1-score': 0.4022188249830751, 'support': 237945}}
[[47260 14623 13502]
 [42249 24001 18138]
 [37432 13729 27011]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0521189
{'0': {'precision': 0.4317880506835322, 'recall': 0.6027792105343002, 'f1-score': 0.5031530961124477, 'support': 32959}, '1': {'precision': 0.47968867687672606, 'recall': 0.30113797560129874, 'f1-score': 0.3699988380649909, 'support': 31723}, '2': {'precision': 0.45747744896344356, 'recall': 0.44014738573038154, 'f1-score': 0.4486451252444361, 'support': 32839}, 'accuracy': 0.4498928435926621, 'macro avg': {'precision': 0.45631805884123394, 'recall': 0.44802152395532685, 'f1-score': 0.44059901980729155, 'support': 97521}, 'weighted avg': {'precision': 0.4560204284774504, 'recall': 0.4498928435926621, 'f1-score': 0.44148391938770026, 'support': 97521}}
[[19867  5252  7840]
 [12869  9553  9301]
 [13275  5110 14454]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0736934
{'0': {'precision': 0.41186951754385964, 'recall': 0.6052366565961732, 'f1-score': 0.4901720903678329, 'support': 9930}, '1': {'precision': 0.42218543046357615, 'recall': 0.2244718309859155, 'f1-score': 0.2931034482758621, 'support': 9088}, '2': {'precision': 0.4449393970786284, 'recall': 0.42698081320210757, 'f1-score': 0.43577516233766234, 'support': 10059}, 'accuracy': 0.424562368882622, 'macro avg': {'precision': 0.42633144836202136, 'recall': 0.4188964335947321, 'f1-score': 0.40635023366045236, 'support': 29077}, 'weighted avg': {'precision': 0.4265340611644059, 'recall': 0.424562368882622, 'f1-score': 0.4097601318305933, 'support': 29077}}
[[6010 1406 2514]
 [4204 2040 2844]
 [4378 1386 4295]]
training model: results/XRAY/W7/deepVOL_L2/h50
Epoch 1/50
381/381 - 12s - loss: 3.3332 - accuracy50: 0.3553 - val_loss: 3.3310 - val_accuracy50: 0.3442 - 12s/epoch - 31ms/step
Epoch 2/50
381/381 - 10s - loss: 3.2782 - accuracy50: 0.3784 - val_loss: 3.3049 - val_accuracy50: 0.3664 - 10s/epoch - 25ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2530 - accuracy50: 0.3959 - val_loss: 3.2904 - val_accuracy50: 0.3652 - 9s/epoch - 23ms/step
Epoch 4/50
381/381 - 8s - loss: 3.2373 - accuracy50: 0.4026 - val_loss: 3.2976 - val_accuracy50: 0.3691 - 8s/epoch - 22ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2292 - accuracy50: 0.4079 - val_loss: 3.2993 - val_accuracy50: 0.3725 - 9s/epoch - 22ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2200 - accuracy50: 0.4137 - val_loss: 3.3037 - val_accuracy50: 0.3672 - 9s/epoch - 22ms/step
Epoch 7/50
381/381 - 8s - loss: 3.2103 - accuracy50: 0.4203 - val_loss: 3.3058 - val_accuracy50: 0.3718 - 8s/epoch - 22ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2073 - accuracy50: 0.4210 - val_loss: 3.3085 - val_accuracy50: 0.3782 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 8s - loss: 3.2018 - accuracy50: 0.4244 - val_loss: 3.2977 - val_accuracy50: 0.3795 - 8s/epoch - 22ms/step
Epoch 10/50
381/381 - 8s - loss: 3.1949 - accuracy50: 0.4288 - val_loss: 3.2979 - val_accuracy50: 0.3842 - 8s/epoch - 22ms/step
Epoch 11/50
381/381 - 9s - loss: 3.1918 - accuracy50: 0.4300 - val_loss: 3.3025 - val_accuracy50: 0.3788 - 9s/epoch - 22ms/step
Epoch 12/50
381/381 - 9s - loss: 3.1869 - accuracy50: 0.4331 - val_loss: 3.3092 - val_accuracy50: 0.3812 - 9s/epoch - 23ms/step
Epoch 13/50
381/381 - 8s - loss: 3.1838 - accuracy50: 0.4355 - val_loss: 3.2986 - val_accuracy50: 0.3799 - 8s/epoch - 22ms/step
testing model: results/XRAY/W7/deepVOL_L2/h50
Evaluating performance on  test set...
930/930 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1109434
{'0': {'precision': 0.33337316796271477, 'recall': 0.5425059035977219, 'f1-score': 0.4129723328099143, 'support': 71990}, '1': {'precision': 0.4312713780509015, 'recall': 0.08207012201849033, 'f1-score': 0.13789843453114717, 'support': 90642}, '2': {'precision': 0.3460041527838138, 'recall': 0.4757080450918168, 'f1-score': 0.4006194858491094, 'support': 75313}, 'accuracy': 0.34596650486456954, 'macro avg': {'precision': 0.3702162329324767, 'recall': 0.36676135690267636, 'f1-score': 0.3171634177300569, 'support': 237945}, 'weighted avg': {'precision': 0.3746640835887832, 'recall': 0.34596650486456954, 'f1-score': 0.3042767172225176, 'support': 237945}}
[[39055  5458 27477]
 [42962  7439 40241]
 [35134  4352 35827]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909729
{'0': {'precision': 0.3836713542034721, 'recall': 0.503508609230579, 'f1-score': 0.4354963771022165, 'support': 32349}, '1': {'precision': 0.3988549618320611, 'recall': 0.12230503880744117, 'f1-score': 0.18720535545917405, 'support': 32468}, '2': {'precision': 0.37342613938641606, 'recall': 0.5151051859099804, 'f1-score': 0.43297008327336284, 'support': 32704}, 'accuracy': 0.3804821525620123, 'macro avg': {'precision': 0.38531748514064973, 'recall': 0.38030627798266686, 'f1-score': 0.3518906052782511, 'support': 97521}, 'weighted avg': {'precision': 0.38529071687518407, 'recall': 0.3804821525620123, 'f1-score': 0.3519847969903931, 'support': 97521}}
[[16288  3096 12965]
 [13196  3971 15301]
 [12969  2889 16846]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0971427
{'0': {'precision': 0.3672151799070939, 'recall': 0.4880703223105902, 'f1-score': 0.4191041020802444, 'support': 9556}, '1': {'precision': 0.36532286835533356, 'recall': 0.10643384263590064, 'f1-score': 0.16484224082421123, 'support': 9621}, '2': {'precision': 0.36381050615191923, 'recall': 0.4987878787878788, 'f1-score': 0.4207387210837984, 'support': 9900}, 'accuracy': 0.36544347766275753, 'macro avg': {'precision': 0.3654495181381156, 'recall': 0.3644306812447899, 'f1-score': 0.334895021329418, 'support': 29077}, 'weighted avg': {'precision': 0.3654298444317795, 'recall': 0.36544347766275753, 'f1-score': 0.335530465219182, 'support': 29077}}
[[4664  918 3974]
 [3936 1024 4661]
 [4101  861 4938]]
training model: results/XRAY/W7/deepVOL_L2/h100
Epoch 1/50
381/381 - 11s - loss: 3.3467 - accuracy100: 0.3482 - val_loss: 3.3194 - val_accuracy100: 0.3488 - 11s/epoch - 30ms/step
Epoch 2/50
381/381 - 8s - loss: 3.3010 - accuracy100: 0.3562 - val_loss: 3.3019 - val_accuracy100: 0.3501 - 8s/epoch - 22ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2851 - accuracy100: 0.3670 - val_loss: 3.3019 - val_accuracy100: 0.3529 - 9s/epoch - 23ms/step
Epoch 4/50
381/381 - 8s - loss: 3.2719 - accuracy100: 0.3772 - val_loss: 3.3060 - val_accuracy100: 0.3515 - 8s/epoch - 22ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2645 - accuracy100: 0.3840 - val_loss: 3.3198 - val_accuracy100: 0.3532 - 9s/epoch - 22ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2621 - accuracy100: 0.3838 - val_loss: 3.3170 - val_accuracy100: 0.3475 - 9s/epoch - 23ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2561 - accuracy100: 0.3892 - val_loss: 3.3093 - val_accuracy100: 0.3508 - 9s/epoch - 23ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2508 - accuracy100: 0.3915 - val_loss: 3.3053 - val_accuracy100: 0.3536 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 9s - loss: 3.2468 - accuracy100: 0.3945 - val_loss: 3.3196 - val_accuracy100: 0.3555 - 9s/epoch - 23ms/step
Epoch 10/50
381/381 - 8s - loss: 3.2438 - accuracy100: 0.3969 - val_loss: 3.3137 - val_accuracy100: 0.3532 - 8s/epoch - 22ms/step
Epoch 11/50
381/381 - 8s - loss: 3.2398 - accuracy100: 0.4013 - val_loss: 3.3091 - val_accuracy100: 0.3594 - 8s/epoch - 22ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2348 - accuracy100: 0.4018 - val_loss: 3.3066 - val_accuracy100: 0.3584 - 9s/epoch - 23ms/step
testing model: results/XRAY/W7/deepVOL_L2/h100
Evaluating performance on  test set...
930/930 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060461
{'0': {'precision': 0.341389670283407, 'recall': 0.45213777023088425, 'f1-score': 0.389035479861308, 'support': 78914}, '1': {'precision': 0.36083949439542096, 'recall': 0.15427755684715, 'f1-score': 0.2161428571428572, 'support': 78456}, '2': {'precision': 0.33894300559632384, 'recall': 0.42017995656220913, 'f1-score': 0.375214726646053, 'support': 80575}, 'accuracy': 0.3431044989388304, 'macro avg': {'precision': 0.34705739009171727, 'recall': 0.34219842788008115, 'f1-score': 0.3267976878834061, 'support': 237945}, 'weighted avg': {'precision': 0.34697421878566775, 'recall': 0.3431044989388304, 'f1-score': 0.3273486581238563, 'support': 237945}}
[[35680 10736 32498]
 [32819 12104 33533]
 [36015 10704 33856]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005093
{'0': {'precision': 0.3580851973215558, 'recall': 0.387332408691632, 'f1-score': 0.3721350310926858, 'support': 32445}, '1': {'precision': 0.36216776396000977, 'recall': 0.1842113422839602, 'f1-score': 0.24420922823964647, 'support': 32251}, '2': {'precision': 0.34546521228977445, 'recall': 0.48435643564356434, 'f1-score': 0.40328737935495323, 'support': 32825}, 'accuracy': 0.35281631648568, 'macro avg': {'precision': 0.3552393911904466, 'recall': 0.35196672887305214, 'f1-score': 0.33987721289576184, 'support': 97521}, 'weighted avg': {'precision': 0.3551875224411563, 'recall': 0.35281631648568, 'f1-score': 0.3403146105052796, 'support': 97521}}
[[12567  5251 14627]
 [10814  5941 15496]
 [11714  5212 15899]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10048
{'0': {'precision': 0.3532689819882575, 'recall': 0.3677994198093659, 'f1-score': 0.36038779757372724, 'support': 9652}, '1': {'precision': 0.3393387028401865, 'recall': 0.1723915150209971, 'f1-score': 0.22863263120314176, 'support': 9287}, '2': {'precision': 0.35485674353598884, 'recall': 0.5008877490629315, 'f1-score': 0.4154123036649215, 'support': 10138}, 'accuracy': 0.3517900746294322, 'macro avg': {'precision': 0.349154809454811, 'recall': 0.34702622796443156, 'f1-score': 0.33481091081393016, 'support': 29077}, 'weighted avg': {'precision': 0.34937333333546544, 'recall': 0.3517900746294322, 'f1-score': 0.3374909448265009, 'support': 29077}}
[[3550 1539 4563]
 [3017 1601 4669]
 [3482 1578 5078]]
training model: results/XRAY/W7/deepVOL_L2/h200
Epoch 1/50
381/381 - 11s - loss: 3.3376 - accuracy200: 0.3547 - val_loss: 3.3185 - val_accuracy200: 0.3416 - 11s/epoch - 30ms/step
Epoch 2/50
381/381 - 9s - loss: 3.2880 - accuracy200: 0.3679 - val_loss: 3.3104 - val_accuracy200: 0.3346 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2683 - accuracy200: 0.3799 - val_loss: 3.2842 - val_accuracy200: 0.3590 - 9s/epoch - 24ms/step
Epoch 4/50
381/381 - 9s - loss: 3.2585 - accuracy200: 0.3843 - val_loss: 3.2785 - val_accuracy200: 0.3669 - 9s/epoch - 23ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2587 - accuracy200: 0.3848 - val_loss: 3.2720 - val_accuracy200: 0.3703 - 9s/epoch - 23ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2537 - accuracy200: 0.3860 - val_loss: 3.2697 - val_accuracy200: 0.3713 - 9s/epoch - 23ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2484 - accuracy200: 0.3927 - val_loss: 3.2700 - val_accuracy200: 0.3741 - 9s/epoch - 23ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2461 - accuracy200: 0.3938 - val_loss: 3.2784 - val_accuracy200: 0.3714 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 9s - loss: 3.2400 - accuracy200: 0.3970 - val_loss: 3.2798 - val_accuracy200: 0.3739 - 9s/epoch - 23ms/step
Epoch 10/50
381/381 - 9s - loss: 3.2352 - accuracy200: 0.4022 - val_loss: 3.2785 - val_accuracy200: 0.3733 - 9s/epoch - 22ms/step
Epoch 11/50
381/381 - 9s - loss: 3.2331 - accuracy200: 0.4022 - val_loss: 3.2778 - val_accuracy200: 0.3741 - 9s/epoch - 23ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2251 - accuracy200: 0.4074 - val_loss: 3.2840 - val_accuracy200: 0.3752 - 9s/epoch - 23ms/step
Epoch 13/50
381/381 - 9s - loss: 3.2254 - accuracy200: 0.4064 - val_loss: 3.2932 - val_accuracy200: 0.3746 - 9s/epoch - 22ms/step
Epoch 14/50
381/381 - 8s - loss: 3.2228 - accuracy200: 0.4070 - val_loss: 3.2835 - val_accuracy200: 0.3762 - 8s/epoch - 22ms/step
Epoch 15/50
381/381 - 8s - loss: 3.2188 - accuracy200: 0.4093 - val_loss: 3.2866 - val_accuracy200: 0.3793 - 8s/epoch - 22ms/step
Epoch 16/50
381/381 - 8s - loss: 3.2174 - accuracy200: 0.4108 - val_loss: 3.2927 - val_accuracy200: 0.3708 - 8s/epoch - 22ms/step
testing model: results/XRAY/W7/deepVOL_L2/h200
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096607
{'0': {'precision': 0.3399370124015002, 'recall': 0.6738770011916481, 'f1-score': 0.45190879478827356, 'support': 77204}, '1': {'precision': 0.4456057214291944, 'recall': 0.36994798643544163, 'f1-score': 0.4042675247433353, 'support': 82863}, '2': {'precision': 0.34157094070164545, 'recall': 0.07063612316700481, 'f1-score': 0.1170637242905632, 'support': 77878}, 'accuracy': 0.3705982474941688, 'macro avg': {'precision': 0.3757045581774467, 'recall': 0.3714870369313648, 'f1-score': 0.324413347940724, 'support': 237945}, 'weighted avg': {'precision': 0.3772703175952237, 'recall': 0.3705982474941688, 'f1-score': 0.32572516848826966, 'support': 237945}}
[[52026 20393  4785]
 [46389 30655  5819]
 [54631 17746  5501]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089409
{'0': {'precision': 0.3552804845930998, 'recall': 0.6671818490927638, 'f1-score': 0.4636585287262494, 'support': 32351}, '1': {'precision': 0.4171596676688326, 'recall': 0.4013061732234489, 'f1-score': 0.40907938118184123, 'support': 32155}, '2': {'precision': 0.363262508567512, 'recall': 0.06421323640769347, 'f1-score': 0.10913490000257393, 'support': 33015}, 'accuracy': 0.37538581433742474, 'macro avg': {'precision': 0.3785675536098148, 'recall': 0.3775670862413021, 'f1-score': 0.3272909366368882, 'support': 97521}, 'weighted avg': {'precision': 0.3783857814349637, 'recall': 0.37538581433742474, 'f1-score': 0.3256411776777307, 'support': 97521}}
[[21584  8904  1863]
 [17398 12904  1853]
 [21770  9125  2120]]
Evaluating performance on  val set...
114/114 - 1s - 958ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912443
{'0': {'precision': 0.3499073338628541, 'recall': 0.6944094157208911, 'f1-score': 0.46533572761522485, 'support': 9516}, '1': {'precision': 0.4232810615199035, 'recall': 0.37203138252756573, 'f1-score': 0.3960049655795057, 'support': 9432}, '2': {'precision': 0.3617245005257624, 'recall': 0.06792378319676178, 'f1-score': 0.11437120771340703, 'support': 10129}, 'accuracy': 0.371599546032947, 'macro avg': {'precision': 0.3783042986361733, 'recall': 0.3781215271484062, 'f1-score': 0.32523730030271253, 'support': 29077}, 'weighted avg': {'precision': 0.3778248315548405, 'recall': 0.371599546032947, 'f1-score': 0.32058739148679294, 'support': 29077}}
[[6608 2346  562]
 [5271 3509  652]
 [7006 2435  688]]
training model: results/XRAY/W7/deepVOL_L2/h300
Epoch 1/50
381/381 - 11s - loss: 3.3489 - accuracy300: 0.3483 - val_loss: 3.3788 - val_accuracy300: 0.3345 - 11s/epoch - 28ms/step
Epoch 2/50
381/381 - 9s - loss: 3.3041 - accuracy300: 0.3583 - val_loss: 3.3369 - val_accuracy300: 0.3339 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2903 - accuracy300: 0.3636 - val_loss: 3.3280 - val_accuracy300: 0.3416 - 9s/epoch - 23ms/step
Epoch 4/50
381/381 - 9s - loss: 3.2783 - accuracy300: 0.3725 - val_loss: 3.3021 - val_accuracy300: 0.3501 - 9s/epoch - 23ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2676 - accuracy300: 0.3796 - val_loss: 3.3110 - val_accuracy300: 0.3513 - 9s/epoch - 23ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2611 - accuracy300: 0.3828 - val_loss: 3.2990 - val_accuracy300: 0.3590 - 9s/epoch - 23ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2552 - accuracy300: 0.3885 - val_loss: 3.2939 - val_accuracy300: 0.3617 - 9s/epoch - 24ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2505 - accuracy300: 0.3911 - val_loss: 3.2942 - val_accuracy300: 0.3635 - 9s/epoch - 23ms/step
Epoch 9/50
381/381 - 9s - loss: 3.2438 - accuracy300: 0.3951 - val_loss: 3.2968 - val_accuracy300: 0.3606 - 9s/epoch - 23ms/step
Epoch 10/50
381/381 - 8s - loss: 3.2385 - accuracy300: 0.3998 - val_loss: 3.3010 - val_accuracy300: 0.3571 - 8s/epoch - 22ms/step
Epoch 11/50
381/381 - 9s - loss: 3.2316 - accuracy300: 0.4037 - val_loss: 3.3065 - val_accuracy300: 0.3549 - 9s/epoch - 23ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2266 - accuracy300: 0.4075 - val_loss: 3.3056 - val_accuracy300: 0.3564 - 9s/epoch - 23ms/step
Epoch 13/50
381/381 - 9s - loss: 3.2229 - accuracy300: 0.4067 - val_loss: 3.3166 - val_accuracy300: 0.3557 - 9s/epoch - 23ms/step
Epoch 14/50
381/381 - 9s - loss: 3.2220 - accuracy300: 0.4088 - val_loss: 3.3202 - val_accuracy300: 0.3556 - 9s/epoch - 23ms/step
Epoch 15/50
381/381 - 9s - loss: 3.2159 - accuracy300: 0.4126 - val_loss: 3.3172 - val_accuracy300: 0.3558 - 9s/epoch - 23ms/step
Epoch 16/50
381/381 - 8s - loss: 3.2086 - accuracy300: 0.4144 - val_loss: 3.3235 - val_accuracy300: 0.3533 - 8s/epoch - 22ms/step
Epoch 17/50
381/381 - 9s - loss: 3.2019 - accuracy300: 0.4194 - val_loss: 3.3326 - val_accuracy300: 0.3516 - 9s/epoch - 23ms/step
testing model: results/XRAY/W7/deepVOL_L2/h300
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080244
{'0': {'precision': 0.3300336628840161, 'recall': 0.6783917017561878, 'f1-score': 0.44404297244268176, 'support': 77896}, '1': {'precision': 0.4081973363346464, 'recall': 0.269509431158119, 'f1-score': 0.324662633436029, 'support': 80743}, '2': {'precision': 0.3151969981238274, 'recall': 0.09744533830983784, 'f1-score': 0.1488673139158576, 'support': 79306}, 'accuracy': 0.3460169366870495, 'macro avg': {'precision': 0.3511426657808299, 'recall': 0.3484488237413816, 'f1-score': 0.30585763993152276, 'support': 237945}, 'weighted avg': {'precision': 0.35161231740482013, 'recall': 0.3460169366870495, 'f1-score': 0.30515235701666954, 'support': 237945}}
[[52844 16965  8087]
 [50279 21761  8703]
 [56994 14584  7728]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092065
{'0': {'precision': 0.358440864999555, 'recall': 0.6244457536200428, 'f1-score': 0.4554480075987154, 'support': 32251}, '1': {'precision': 0.40655968288472605, 'recall': 0.3954970923904593, 'f1-score': 0.40095209571399304, 'support': 32157}, '2': {'precision': 0.3691068231549632, 'recall': 0.11207078790807236, 'f1-score': 0.17193689624018346, 'support': 33113}, 'accuracy': 0.37497564627105956, 'macro avg': {'precision': 0.3780357903464147, 'recall': 0.3773378779728582, 'f1-score': 0.342778999850964, 'support': 97521}, 'weighted avg': {'precision': 0.37792937208144994, 'recall': 0.37497564627105956, 'f1-score': 0.3412128329297509, 'support': 97521}}
[[20139  9046  3066]
 [16162 12718  3277]
 [19884  9518  3711]]
Evaluating performance on  val set...
114/114 - 1s - 946ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994427
{'0': {'precision': 0.3417919981418036, 'recall': 0.637012987012987, 'f1-score': 0.44488114583726995, 'support': 9240}, '1': {'precision': 0.40942958348601444, 'recall': 0.341031641062163, 'f1-score': 0.372113676731794, 'support': 9829}, '2': {'precision': 0.35431997819569366, 'recall': 0.1298960831334932, 'f1-score': 0.19010016816553338, 'support': 10008}, 'accuracy': 0.3624170306427761, 'macro avg': {'precision': 0.36851385327450387, 'recall': 0.3693135704028811, 'f1-score': 0.3356983302448658, 'support': 29077}, 'weighted avg': {'precision': 0.36896776767537237, 'recall': 0.3624170306427761, 'f1-score': 0.33259034973119084, 'support': 29077}}
[[5886 2256 1098]
 [5206 3352 1271]
 [6129 2579 1300]]
training model: results/XRAY/W7/deepVOL_L2/h500
Epoch 1/50
381/381 - 12s - loss: 3.3529 - accuracy500: 0.3497 - val_loss: 3.3378 - val_accuracy500: 0.3501 - 12s/epoch - 31ms/step
Epoch 2/50
381/381 - 9s - loss: 3.3129 - accuracy500: 0.3527 - val_loss: 3.3443 - val_accuracy500: 0.3269 - 9s/epoch - 23ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2924 - accuracy500: 0.3602 - val_loss: 3.3310 - val_accuracy500: 0.3304 - 9s/epoch - 24ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2809 - accuracy500: 0.3723 - val_loss: 3.3332 - val_accuracy500: 0.3350 - 10s/epoch - 25ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2734 - accuracy500: 0.3762 - val_loss: 3.3145 - val_accuracy500: 0.3423 - 9s/epoch - 24ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2678 - accuracy500: 0.3791 - val_loss: 3.3123 - val_accuracy500: 0.3364 - 9s/epoch - 24ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2582 - accuracy500: 0.3840 - val_loss: 3.3135 - val_accuracy500: 0.3414 - 9s/epoch - 24ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2523 - accuracy500: 0.3907 - val_loss: 3.3264 - val_accuracy500: 0.3400 - 9s/epoch - 24ms/step
Epoch 9/50
381/381 - 9s - loss: 3.2477 - accuracy500: 0.3950 - val_loss: 3.3235 - val_accuracy500: 0.3413 - 9s/epoch - 24ms/step
Epoch 10/50
381/381 - 9s - loss: 3.2415 - accuracy500: 0.3980 - val_loss: 3.3232 - val_accuracy500: 0.3457 - 9s/epoch - 23ms/step
Epoch 11/50
381/381 - 9s - loss: 3.2332 - accuracy500: 0.4035 - val_loss: 3.3272 - val_accuracy500: 0.3449 - 9s/epoch - 22ms/step
Epoch 12/50
381/381 - 8s - loss: 3.2275 - accuracy500: 0.4078 - val_loss: 3.3276 - val_accuracy500: 0.3458 - 8s/epoch - 22ms/step
Epoch 13/50
381/381 - 10s - loss: 3.2211 - accuracy500: 0.4112 - val_loss: 3.3310 - val_accuracy500: 0.3412 - 10s/epoch - 25ms/step
Epoch 14/50
381/381 - 9s - loss: 3.2178 - accuracy500: 0.4122 - val_loss: 3.3263 - val_accuracy500: 0.3422 - 9s/epoch - 23ms/step
Epoch 15/50
381/381 - 9s - loss: 3.2082 - accuracy500: 0.4163 - val_loss: 3.3278 - val_accuracy500: 0.3486 - 9s/epoch - 23ms/step
Epoch 16/50
381/381 - 9s - loss: 3.2012 - accuracy500: 0.4206 - val_loss: 3.3277 - val_accuracy500: 0.3490 - 9s/epoch - 23ms/step
testing model: results/XRAY/W7/deepVOL_L2/h500
Evaluating performance on  test set...
930/930 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059439
{'0': {'precision': 0.3223139105020167, 'recall': 0.7430551963167968, 'f1-score': 0.4496038499911966, 'support': 77324}, '1': {'precision': 0.4219508778483377, 'recall': 0.22197521463049166, 'f1-score': 0.29091113954817266, 'support': 81419}, '2': {'precision': 0.34156183242345123, 'recall': 0.07267493245120073, 'f1-score': 0.1198492514627189, 'support': 79202}, 'accuracy': 0.3416125575237975, 'macro avg': {'precision': 0.3619422069246019, 'recall': 0.34590178113282977, 'f1-score': 0.28678808033402936, 'support': 237945}, 'weighted avg': {'precision': 0.36281409397463243, 'recall': 0.3416125575237975, 'f1-score': 0.28554145950510507, 'support': 237945}}
[[57456 14549  5319]
 [57569 18073  5777]
 [63236 10210  5756]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969774
{'0': {'precision': 0.3457255466232913, 'recall': 0.6882647818912102, 'f1-score': 0.46025714434438597, 'support': 32117}, '1': {'precision': 0.38884989101119444, 'recall': 0.3266604593420236, 'f1-score': 0.3550525410292307, 'support': 32220}, '2': {'precision': 0.3571209330877839, 'recall': 0.070124156219865, 'f1-score': 0.11722921914357681, 'support': 33184}, 'accuracy': 0.35845612739820143, 'macro avg': {'precision': 0.3638987902407565, 'recall': 0.3616831324843662, 'f1-score': 0.31084630150573117, 'support': 97521}, 'weighted avg': {'precision': 0.36385098504799945, 'recall': 0.35845612739820143, 'f1-score': 0.3087745817304059, 'support': 97521}}
[[22105  7965  2047]
 [19553 10525  2142]
 [22280  8577  2327]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050783
{'0': {'precision': 0.3167925206760158, 'recall': 0.703593839132915, 'f1-score': 0.43688013601586845, 'support': 8765}, '1': {'precision': 0.38677662845960303, 'recall': 0.27434067023597064, 'f1-score': 0.32099767981438515, 'support': 10086}, '2': {'precision': 0.33916938110749184, 'recall': 0.08145902601212596, 'f1-score': 0.13136729222520108, 'support': 10226}, 'accuracy': 0.3359012277745297, 'macro avg': {'precision': 0.3475795100810369, 'recall': 0.3531311784603372, 'f1-score': 0.2964150360184849, 'support': 29077}, 'weighted avg': {'precision': 0.3489377036686745, 'recall': 0.3359012277745297, 'f1-score': 0.28923888025181005, 'support': 29077}}
[[6167 1905  693]
 [6389 2767  930]
 [6911 2482  833]]
training model: results/XRAY/W7/deepVOL_L2/h1000
Epoch 1/50
381/381 - 12s - loss: 3.3455 - accuracy1000: 0.3642 - val_loss: 3.3755 - val_accuracy1000: 0.3348 - 12s/epoch - 32ms/step
Epoch 2/50
381/381 - 9s - loss: 3.3100 - accuracy1000: 0.3588 - val_loss: 3.3410 - val_accuracy1000: 0.3113 - 9s/epoch - 24ms/step
Epoch 3/50
381/381 - 9s - loss: 3.2935 - accuracy1000: 0.3587 - val_loss: 3.3064 - val_accuracy1000: 0.3221 - 9s/epoch - 25ms/step
Epoch 4/50
381/381 - 10s - loss: 3.2848 - accuracy1000: 0.3674 - val_loss: 3.2892 - val_accuracy1000: 0.3464 - 10s/epoch - 25ms/step
Epoch 5/50
381/381 - 9s - loss: 3.2762 - accuracy1000: 0.3738 - val_loss: 3.2890 - val_accuracy1000: 0.3542 - 9s/epoch - 24ms/step
Epoch 6/50
381/381 - 9s - loss: 3.2690 - accuracy1000: 0.3832 - val_loss: 3.2937 - val_accuracy1000: 0.3441 - 9s/epoch - 23ms/step
Epoch 7/50
381/381 - 9s - loss: 3.2613 - accuracy1000: 0.3846 - val_loss: 3.2893 - val_accuracy1000: 0.3542 - 9s/epoch - 25ms/step
Epoch 8/50
381/381 - 9s - loss: 3.2536 - accuracy1000: 0.3900 - val_loss: 3.2939 - val_accuracy1000: 0.3482 - 9s/epoch - 25ms/step
Epoch 9/50
381/381 - 10s - loss: 3.2499 - accuracy1000: 0.3937 - val_loss: 3.2892 - val_accuracy1000: 0.3564 - 10s/epoch - 25ms/step
Epoch 10/50
381/381 - 9s - loss: 3.2458 - accuracy1000: 0.3944 - val_loss: 3.2897 - val_accuracy1000: 0.3573 - 9s/epoch - 23ms/step
Epoch 11/50
381/381 - 9s - loss: 3.2324 - accuracy1000: 0.4029 - val_loss: 3.3142 - val_accuracy1000: 0.3529 - 9s/epoch - 24ms/step
Epoch 12/50
381/381 - 9s - loss: 3.2262 - accuracy1000: 0.4057 - val_loss: 3.3223 - val_accuracy1000: 0.3501 - 9s/epoch - 24ms/step
Epoch 13/50
381/381 - 9s - loss: 3.2220 - accuracy1000: 0.4092 - val_loss: 3.3204 - val_accuracy1000: 0.3540 - 9s/epoch - 25ms/step
Epoch 14/50
381/381 - 9s - loss: 3.2130 - accuracy1000: 0.4149 - val_loss: 3.3175 - val_accuracy1000: 0.3510 - 9s/epoch - 24ms/step
Epoch 15/50
381/381 - 9s - loss: 3.2026 - accuracy1000: 0.4220 - val_loss: 3.3301 - val_accuracy1000: 0.3480 - 9s/epoch - 24ms/step
testing model: results/XRAY/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
930/930 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975957
{'0': {'precision': 0.3219543270229473, 'recall': 0.6064511080097562, 'f1-score': 0.4206126999778368, 'support': 76669}, '1': {'precision': 0.43007786075260973, 'recall': 0.3912823112012164, 'f1-score': 0.409763865105493, 'support': 82866}, '2': {'precision': 0.32724966916629905, 'recall': 0.07569187603621987, 'f1-score': 0.12294657468978518, 'support': 78410}, 'accuracy': 0.35661602471159304, 'macro avg': {'precision': 0.3597606189806187, 'recall': 0.3578084317490642, 'f1-score': 0.3177743799243717, 'support': 237945}, 'weighted avg': {'precision': 0.36135407286128146, 'recall': 0.35661602471159304, 'f1-score': 0.31874461939464416, 'support': 237945}}
[[46496 23871  6302]
 [44543 32424  5899]
 [53379 19096  5935]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0919204
{'0': {'precision': 0.3558236108364643, 'recall': 0.560945196084544, 'f1-score': 0.4354370341690059, 'support': 32078}, '1': {'precision': 0.39244598196563263, 'recall': 0.4297335900142831, 'f1-score': 0.4102442494664454, 'support': 32206}, '2': {'precision': 0.37886178861788616, 'recall': 0.1331949333574029, 'f1-score': 0.1970971906860781, 'support': 33237}, 'accuracy': 0.3718276063617067, 'macro avg': {'precision': 0.3757104604733277, 'recall': 0.3746245731520767, 'f1-score': 0.3475928247738431, 'support': 97521}, 'weighted avg': {'precision': 0.37576987881471624, 'recall': 0.3718276063617067, 'f1-score': 0.34588647375665643, 'support': 97521}}
[[17994 10556  3528]
 [14636 13840  3730]
 [17940 10870  4427]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983154
{'0': {'precision': 0.32590585844903486, 'recall': 0.5468803273099215, 'f1-score': 0.4084196231539637, 'support': 8799}, '1': {'precision': 0.3756764734822395, 'recall': 0.4019370460048426, 'f1-score': 0.38836334045366694, 'support': 9499}, '2': {'precision': 0.38925042178838276, 'recall': 0.14982836997866222, 'f1-score': 0.21637191854233656, 'support': 10779}, 'accuracy': 0.3523403377239743, 'macro avg': {'precision': 0.36361091790655237, 'recall': 0.3662152477644754, 'f1-score': 0.33771829404998904, 'support': 29077}, 'weighted avg': {'precision': 0.36564730771942877, 'recall': 0.3523403377239743, 'f1-score': 0.3306744349509562, 'support': 29077}}
[[4812 2786 1201]
 [4348 3818 1333]
 [5605 3559 1615]]
training model: results/XRAY/W7/deepVOL_L3/h10
Epoch 1/50
381/381 - 17s - loss: 3.3304 - accuracy10: 0.3542 - val_loss: 3.3169 - val_accuracy10: 0.3400 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 14s - loss: 3.2601 - accuracy10: 0.3876 - val_loss: 3.3022 - val_accuracy10: 0.3693 - 14s/epoch - 37ms/step
Epoch 3/50
381/381 - 14s - loss: 3.2097 - accuracy10: 0.4140 - val_loss: 3.2458 - val_accuracy10: 0.3962 - 14s/epoch - 37ms/step
Epoch 4/50
381/381 - 14s - loss: 3.1673 - accuracy10: 0.4382 - val_loss: 3.2194 - val_accuracy10: 0.4246 - 14s/epoch - 37ms/step
Epoch 5/50
381/381 - 14s - loss: 3.1106 - accuracy10: 0.4614 - val_loss: 3.1637 - val_accuracy10: 0.4409 - 14s/epoch - 36ms/step
Epoch 6/50
381/381 - 13s - loss: 3.0615 - accuracy10: 0.4769 - val_loss: 3.1612 - val_accuracy10: 0.4483 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 14s - loss: 3.0379 - accuracy10: 0.4850 - val_loss: 3.1159 - val_accuracy10: 0.4610 - 14s/epoch - 36ms/step
Epoch 8/50
381/381 - 14s - loss: 3.0224 - accuracy10: 0.4913 - val_loss: 3.1597 - val_accuracy10: 0.4493 - 14s/epoch - 36ms/step
Epoch 9/50
381/381 - 14s - loss: 3.0104 - accuracy10: 0.4951 - val_loss: 3.1231 - val_accuracy10: 0.4590 - 14s/epoch - 36ms/step
Epoch 10/50
381/381 - 14s - loss: 3.0022 - accuracy10: 0.4977 - val_loss: 3.1055 - val_accuracy10: 0.4659 - 14s/epoch - 36ms/step
Epoch 11/50
381/381 - 14s - loss: 2.9912 - accuracy10: 0.5001 - val_loss: 3.1121 - val_accuracy10: 0.4612 - 14s/epoch - 35ms/step
Epoch 12/50
381/381 - 14s - loss: 2.9829 - accuracy10: 0.5025 - val_loss: 3.1135 - val_accuracy10: 0.4593 - 14s/epoch - 37ms/step
Epoch 13/50
381/381 - 14s - loss: 2.9763 - accuracy10: 0.5049 - val_loss: 3.0989 - val_accuracy10: 0.4668 - 14s/epoch - 36ms/step
Epoch 14/50
381/381 - 13s - loss: 2.9678 - accuracy10: 0.5070 - val_loss: 3.0982 - val_accuracy10: 0.4699 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 13s - loss: 2.9649 - accuracy10: 0.5078 - val_loss: 3.0855 - val_accuracy10: 0.4723 - 13s/epoch - 35ms/step
Epoch 16/50
381/381 - 14s - loss: 2.9575 - accuracy10: 0.5108 - val_loss: 3.0835 - val_accuracy10: 0.4726 - 14s/epoch - 36ms/step
Epoch 17/50
381/381 - 13s - loss: 2.9527 - accuracy10: 0.5105 - val_loss: 3.0939 - val_accuracy10: 0.4681 - 13s/epoch - 35ms/step
Epoch 18/50
381/381 - 13s - loss: 2.9487 - accuracy10: 0.5114 - val_loss: 3.0993 - val_accuracy10: 0.4690 - 13s/epoch - 35ms/step
Epoch 19/50
381/381 - 14s - loss: 2.9453 - accuracy10: 0.5136 - val_loss: 3.1112 - val_accuracy10: 0.4655 - 14s/epoch - 35ms/step
Epoch 20/50
381/381 - 14s - loss: 2.9408 - accuracy10: 0.5156 - val_loss: 3.1050 - val_accuracy10: 0.4688 - 14s/epoch - 36ms/step
Epoch 21/50
381/381 - 13s - loss: 2.9368 - accuracy10: 0.5160 - val_loss: 3.1014 - val_accuracy10: 0.4700 - 13s/epoch - 35ms/step
Epoch 22/50
381/381 - 14s - loss: 2.9329 - accuracy10: 0.5174 - val_loss: 3.1186 - val_accuracy10: 0.4640 - 14s/epoch - 36ms/step
Epoch 23/50
381/381 - 13s - loss: 2.9285 - accuracy10: 0.5188 - val_loss: 3.1088 - val_accuracy10: 0.4700 - 13s/epoch - 35ms/step
Epoch 24/50
381/381 - 14s - loss: 2.9229 - accuracy10: 0.5197 - val_loss: 3.1039 - val_accuracy10: 0.4703 - 14s/epoch - 36ms/step
Epoch 25/50
381/381 - 14s - loss: 2.9234 - accuracy10: 0.5204 - val_loss: 3.1044 - val_accuracy10: 0.4729 - 14s/epoch - 37ms/step
Epoch 26/50
381/381 - 13s - loss: 2.9171 - accuracy10: 0.5214 - val_loss: 3.1028 - val_accuracy10: 0.4720 - 13s/epoch - 35ms/step
testing model: results/XRAY/W7/deepVOL_L3/h10
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0666152
{'0': {'precision': 0.38309204589917834, 'recall': 0.6878136200716846, 'f1-score': 0.4920992301814023, 'support': 69750}, '1': {'precision': 0.6578236454697223, 'recall': 0.2259665512783084, 'f1-score': 0.33638332052804365, 'support': 95908}, '2': {'precision': 0.44192606150258873, 'recall': 0.4876672154052596, 'f1-score': 0.4636712790024728, 'support': 72287}, 'accuracy': 0.4408539788606611, 'macro avg': {'precision': 0.4942805842904964, 'recall': 0.4671491289184175, 'f1-score': 0.4307179432373063, 'support': 237945}, 'weighted avg': {'precision': 0.5117011477400888, 'recall': 0.4408539788606611, 'f1-score': 0.42069881088322164, 'support': 237945}}
[[47975  4843 16932]
 [46651 21672 27585]
 [30605  6430 35252]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0083541
{'0': {'precision': 0.4448212279846555, 'recall': 0.6678546426525807, 'f1-score': 0.5339846582452391, 'support': 31426}, '1': {'precision': 0.6579923461878128, 'recall': 0.3196796338672769, 'f1-score': 0.43030128020021174, 'support': 34960}, '2': {'precision': 0.47698857673972356, 'recall': 0.5109683635779669, 'f1-score': 0.49339411983624865, 'support': 31135}, 'accuracy': 0.49295023635934826, 'macro avg': {'precision': 0.5266007169707306, 'recall': 0.4995008800326082, 'f1-score': 0.4858933527605665, 'support': 97521}, 'weighted avg': {'precision': 0.5315101739129316, 'recall': 0.49295023635934826, 'f1-score': 0.4838564057681513, 'support': 97521}}
[[20988  2612  7826]
 [14166 11176  9618]
 [12029  3197 15909]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0324409
{'0': {'precision': 0.4393529217563552, 'recall': 0.6821117375704767, 'f1-score': 0.5344578313253012, 'support': 9755}, '1': {'precision': 0.5954948478312965, 'recall': 0.2550025654181632, 'f1-score': 0.35709153614025013, 'support': 9745}, '2': {'precision': 0.46828568500870993, 'recall': 0.4771849222094602, 'f1-score': 0.4726934215970211, 'support': 9577}, 'accuracy': 0.4714722976923342, 'macro avg': {'precision': 0.5010444848654538, 'recall': 0.4714330750660334, 'f1-score': 0.4547475963541909, 'support': 29077}, 'weighted avg': {'precision': 0.501212540811557, 'recall': 0.4714722976923342, 'f1-score': 0.45467132313855363, 'support': 29077}}
[[6654  729 2372]
 [4443 2485 2817]
 [4048  959 4570]]
training model: results/XRAY/W7/deepVOL_L3/h20
Epoch 1/50
381/381 - 16s - loss: 3.3386 - accuracy20: 0.3499 - val_loss: 3.3257 - val_accuracy20: 0.3457 - 16s/epoch - 43ms/step
Epoch 2/50
381/381 - 15s - loss: 3.2972 - accuracy20: 0.3671 - val_loss: 3.3109 - val_accuracy20: 0.3647 - 15s/epoch - 38ms/step
Epoch 3/50
381/381 - 14s - loss: 3.2571 - accuracy20: 0.3875 - val_loss: 3.2737 - val_accuracy20: 0.3806 - 14s/epoch - 37ms/step
Epoch 4/50
381/381 - 14s - loss: 3.2150 - accuracy20: 0.4142 - val_loss: 3.2400 - val_accuracy20: 0.4057 - 14s/epoch - 36ms/step
Epoch 5/50
381/381 - 14s - loss: 3.1763 - accuracy20: 0.4334 - val_loss: 3.2263 - val_accuracy20: 0.4116 - 14s/epoch - 36ms/step
Epoch 6/50
381/381 - 13s - loss: 3.1520 - accuracy20: 0.4440 - val_loss: 3.2138 - val_accuracy20: 0.4138 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 14s - loss: 3.1266 - accuracy20: 0.4552 - val_loss: 3.1993 - val_accuracy20: 0.4230 - 14s/epoch - 37ms/step
Epoch 8/50
381/381 - 14s - loss: 3.1119 - accuracy20: 0.4604 - val_loss: 3.1881 - val_accuracy20: 0.4318 - 14s/epoch - 36ms/step
Epoch 9/50
381/381 - 14s - loss: 3.1020 - accuracy20: 0.4637 - val_loss: 3.1979 - val_accuracy20: 0.4248 - 14s/epoch - 37ms/step
Epoch 10/50
381/381 - 14s - loss: 3.0942 - accuracy20: 0.4683 - val_loss: 3.1865 - val_accuracy20: 0.4320 - 14s/epoch - 36ms/step
Epoch 11/50
381/381 - 14s - loss: 3.0856 - accuracy20: 0.4688 - val_loss: 3.1902 - val_accuracy20: 0.4283 - 14s/epoch - 37ms/step
Epoch 12/50
381/381 - 14s - loss: 3.0799 - accuracy20: 0.4718 - val_loss: 3.1888 - val_accuracy20: 0.4289 - 14s/epoch - 36ms/step
Epoch 13/50
381/381 - 14s - loss: 3.0730 - accuracy20: 0.4760 - val_loss: 3.1965 - val_accuracy20: 0.4256 - 14s/epoch - 36ms/step
Epoch 14/50
381/381 - 13s - loss: 3.0656 - accuracy20: 0.4758 - val_loss: 3.2050 - val_accuracy20: 0.4258 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 14s - loss: 3.0611 - accuracy20: 0.4784 - val_loss: 3.1886 - val_accuracy20: 0.4345 - 14s/epoch - 37ms/step
Epoch 16/50
381/381 - 13s - loss: 3.0535 - accuracy20: 0.4811 - val_loss: 3.1888 - val_accuracy20: 0.4331 - 13s/epoch - 35ms/step
Epoch 17/50
381/381 - 14s - loss: 3.0477 - accuracy20: 0.4824 - val_loss: 3.1881 - val_accuracy20: 0.4359 - 14s/epoch - 36ms/step
Epoch 18/50
381/381 - 13s - loss: 3.0416 - accuracy20: 0.4847 - val_loss: 3.1749 - val_accuracy20: 0.4395 - 13s/epoch - 35ms/step
Epoch 19/50
381/381 - 14s - loss: 3.0368 - accuracy20: 0.4862 - val_loss: 3.1884 - val_accuracy20: 0.4364 - 14s/epoch - 37ms/step
Epoch 20/50
381/381 - 14s - loss: 3.0317 - accuracy20: 0.4882 - val_loss: 3.1733 - val_accuracy20: 0.4414 - 14s/epoch - 36ms/step
Epoch 21/50
381/381 - 14s - loss: 3.0272 - accuracy20: 0.4891 - val_loss: 3.1848 - val_accuracy20: 0.4384 - 14s/epoch - 37ms/step
Epoch 22/50
381/381 - 13s - loss: 3.0208 - accuracy20: 0.4921 - val_loss: 3.1678 - val_accuracy20: 0.4465 - 13s/epoch - 35ms/step
Epoch 23/50
381/381 - 14s - loss: 3.0177 - accuracy20: 0.4936 - val_loss: 3.1736 - val_accuracy20: 0.4441 - 14s/epoch - 36ms/step
Epoch 24/50
381/381 - 13s - loss: 3.0120 - accuracy20: 0.4944 - val_loss: 3.1594 - val_accuracy20: 0.4497 - 13s/epoch - 35ms/step
Epoch 25/50
381/381 - 14s - loss: 3.0060 - accuracy20: 0.4953 - val_loss: 3.1632 - val_accuracy20: 0.4500 - 14s/epoch - 37ms/step
Epoch 26/50
381/381 - 14s - loss: 3.0025 - accuracy20: 0.4953 - val_loss: 3.1606 - val_accuracy20: 0.4516 - 14s/epoch - 36ms/step
Epoch 27/50
381/381 - 14s - loss: 2.9968 - accuracy20: 0.4993 - val_loss: 3.1605 - val_accuracy20: 0.4505 - 14s/epoch - 37ms/step
Epoch 28/50
381/381 - 13s - loss: 2.9891 - accuracy20: 0.5012 - val_loss: 3.1671 - val_accuracy20: 0.4476 - 13s/epoch - 35ms/step
Epoch 29/50
381/381 - 14s - loss: 2.9874 - accuracy20: 0.5003 - val_loss: 3.1580 - val_accuracy20: 0.4521 - 14s/epoch - 37ms/step
Epoch 30/50
381/381 - 14s - loss: 2.9816 - accuracy20: 0.5030 - val_loss: 3.1647 - val_accuracy20: 0.4496 - 14s/epoch - 36ms/step
Epoch 31/50
381/381 - 14s - loss: 2.9762 - accuracy20: 0.5037 - val_loss: 3.1594 - val_accuracy20: 0.4506 - 14s/epoch - 36ms/step
Epoch 32/50
381/381 - 13s - loss: 2.9691 - accuracy20: 0.5050 - val_loss: 3.1721 - val_accuracy20: 0.4504 - 13s/epoch - 35ms/step
Epoch 33/50
381/381 - 14s - loss: 2.9649 - accuracy20: 0.5078 - val_loss: 3.1607 - val_accuracy20: 0.4467 - 14s/epoch - 37ms/step
Epoch 34/50
381/381 - 14s - loss: 2.9578 - accuracy20: 0.5099 - val_loss: 3.1673 - val_accuracy20: 0.4495 - 14s/epoch - 35ms/step
Epoch 35/50
381/381 - 14s - loss: 2.9555 - accuracy20: 0.5104 - val_loss: 3.1807 - val_accuracy20: 0.4483 - 14s/epoch - 35ms/step
Epoch 36/50
381/381 - 13s - loss: 2.9519 - accuracy20: 0.5098 - val_loss: 3.1774 - val_accuracy20: 0.4484 - 13s/epoch - 35ms/step
Epoch 37/50
381/381 - 14s - loss: 2.9413 - accuracy20: 0.5143 - val_loss: 3.1845 - val_accuracy20: 0.4462 - 14s/epoch - 36ms/step
Epoch 38/50
381/381 - 13s - loss: 2.9379 - accuracy20: 0.5145 - val_loss: 3.1841 - val_accuracy20: 0.4449 - 13s/epoch - 35ms/step
Epoch 39/50
381/381 - 14s - loss: 2.9334 - accuracy20: 0.5168 - val_loss: 3.1876 - val_accuracy20: 0.4467 - 14s/epoch - 36ms/step
testing model: results/XRAY/W7/deepVOL_L3/h20
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774033
{'0': {'precision': 0.3839393098343973, 'recall': 0.6214858480933386, 'f1-score': 0.4746506404924305, 'support': 73453}, '1': {'precision': 0.5720502762905488, 'recall': 0.2255104459418278, 'f1-score': 0.32349464889982676, 'support': 88599}, '2': {'precision': 0.4362153615711076, 'recall': 0.48349650165364394, 'f1-score': 0.45864060195485334, 'support': 75893}, 'accuracy': 0.430032150286831, 'macro avg': {'precision': 0.4640683158986845, 'recall': 0.4434975985629368, 'f1-score': 0.4189286304490369, 'support': 237945}, 'weighted avg': {'precision': 0.47065611376598954, 'recall': 0.430032150286831, 'f1-score': 0.4132611616051018, 'support': 237945}}
[[45650  7902 19901]
 [41095 19980 27524]
 [32154  7045 36694]]
Evaluating performance on  train set...
381/381 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0154582
{'0': {'precision': 0.4572948753850462, 'recall': 0.6007541616849076, 'f1-score': 0.5192988035139325, 'support': 32619}, '1': {'precision': 0.5623164928622051, 'recall': 0.34107098992876445, 'f1-score': 0.42460150605863684, 'support': 32568}, '2': {'precision': 0.4745811255907203, 'recall': 0.5124636605430816, 'f1-score': 0.4927954319023331, 'support': 32334}, 'accuracy': 0.4847571292337035, 'macro avg': {'precision': 0.4980641646126571, 'recall': 0.48476293738558446, 'f1-score': 0.47889858049163414, 'support': 97521}, 'weighted avg': {'precision': 0.49809919088782384, 'recall': 0.4847571292337035, 'f1-score': 0.478886363104036, 'support': 97521}}
[[19596  4339  8684]
 [11799 11108  9661]
 [11457  4307 16570]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0535893
{'0': {'precision': 0.43044012430440126, 'recall': 0.601980998585001, 'f1-score': 0.5019594623066874, 'support': 9894}, '1': {'precision': 0.5003039513677812, 'recall': 0.2646869639794168, 'f1-score': 0.346210474654701, 'support': 9328}, '2': {'precision': 0.45550703541969917, 'recall': 0.4763064434297311, 'f1-score': 0.4656746031746032, 'support': 9855}, 'accuracy': 0.451181346081095, 'macro avg': {'precision': 0.46208370369729385, 'recall': 0.44765813533138293, 'f1-score': 0.4379481800453305, 'support': 29077}, 'weighted avg': {'precision': 0.4613485463523591, 'recall': 0.451181346081095, 'f1-score': 0.43969671705908897, 'support': 29077}}
[[5956 1217 2721]
 [3969 2469 2890]
 [3912 1249 4694]]
training model: results/XRAY/W7/deepVOL_L3/h30
Epoch 1/50
381/381 - 17s - loss: 3.3427 - accuracy30: 0.3473 - val_loss: 3.3177 - val_accuracy30: 0.3486 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 13s - loss: 3.2936 - accuracy30: 0.3606 - val_loss: 3.2850 - val_accuracy30: 0.3643 - 13s/epoch - 35ms/step
Epoch 3/50
381/381 - 13s - loss: 3.2710 - accuracy30: 0.3769 - val_loss: 3.2850 - val_accuracy30: 0.3679 - 13s/epoch - 35ms/step
Epoch 4/50
381/381 - 13s - loss: 3.2517 - accuracy30: 0.3894 - val_loss: 3.2818 - val_accuracy30: 0.3755 - 13s/epoch - 35ms/step
Epoch 5/50
381/381 - 14s - loss: 3.2269 - accuracy30: 0.4099 - val_loss: 3.2543 - val_accuracy30: 0.3995 - 14s/epoch - 37ms/step
Epoch 6/50
381/381 - 14s - loss: 3.2049 - accuracy30: 0.4202 - val_loss: 3.2420 - val_accuracy30: 0.4077 - 14s/epoch - 36ms/step
Epoch 7/50
381/381 - 14s - loss: 3.1879 - accuracy30: 0.4284 - val_loss: 3.2436 - val_accuracy30: 0.4055 - 14s/epoch - 36ms/step
Epoch 8/50
381/381 - 15s - loss: 3.1739 - accuracy30: 0.4366 - val_loss: 3.2425 - val_accuracy30: 0.4110 - 15s/epoch - 39ms/step
Epoch 9/50
381/381 - 15s - loss: 3.1656 - accuracy30: 0.4401 - val_loss: 3.2352 - val_accuracy30: 0.4124 - 15s/epoch - 39ms/step
Epoch 10/50
381/381 - 14s - loss: 3.1578 - accuracy30: 0.4438 - val_loss: 3.2305 - val_accuracy30: 0.4164 - 14s/epoch - 35ms/step
Epoch 11/50
381/381 - 14s - loss: 3.1522 - accuracy30: 0.4459 - val_loss: 3.2268 - val_accuracy30: 0.4201 - 14s/epoch - 36ms/step
Epoch 12/50
381/381 - 14s - loss: 3.1440 - accuracy30: 0.4473 - val_loss: 3.2256 - val_accuracy30: 0.4190 - 14s/epoch - 36ms/step
Epoch 13/50
381/381 - 14s - loss: 3.1398 - accuracy30: 0.4503 - val_loss: 3.2202 - val_accuracy30: 0.4235 - 14s/epoch - 36ms/step
Epoch 14/50
381/381 - 14s - loss: 3.1349 - accuracy30: 0.4514 - val_loss: 3.2253 - val_accuracy30: 0.4203 - 14s/epoch - 36ms/step
Epoch 15/50
381/381 - 13s - loss: 3.1285 - accuracy30: 0.4545 - val_loss: 3.2226 - val_accuracy30: 0.4234 - 13s/epoch - 35ms/step
Epoch 16/50
381/381 - 14s - loss: 3.1227 - accuracy30: 0.4572 - val_loss: 3.2176 - val_accuracy30: 0.4233 - 14s/epoch - 36ms/step
Epoch 17/50
381/381 - 14s - loss: 3.1196 - accuracy30: 0.4567 - val_loss: 3.2175 - val_accuracy30: 0.4244 - 14s/epoch - 36ms/step
Epoch 18/50
381/381 - 14s - loss: 3.1139 - accuracy30: 0.4601 - val_loss: 3.2202 - val_accuracy30: 0.4237 - 14s/epoch - 36ms/step
Epoch 19/50
381/381 - 13s - loss: 3.1075 - accuracy30: 0.4636 - val_loss: 3.2205 - val_accuracy30: 0.4232 - 13s/epoch - 35ms/step
Epoch 20/50
381/381 - 14s - loss: 3.1040 - accuracy30: 0.4644 - val_loss: 3.2293 - val_accuracy30: 0.4213 - 14s/epoch - 36ms/step
Epoch 21/50
381/381 - 14s - loss: 3.0972 - accuracy30: 0.4663 - val_loss: 3.2247 - val_accuracy30: 0.4208 - 14s/epoch - 36ms/step
Epoch 22/50
381/381 - 14s - loss: 3.0943 - accuracy30: 0.4672 - val_loss: 3.2242 - val_accuracy30: 0.4251 - 14s/epoch - 36ms/step
Epoch 23/50
381/381 - 14s - loss: 3.0893 - accuracy30: 0.4679 - val_loss: 3.2379 - val_accuracy30: 0.4202 - 14s/epoch - 37ms/step
Epoch 24/50
381/381 - 14s - loss: 3.0861 - accuracy30: 0.4698 - val_loss: 3.2357 - val_accuracy30: 0.4239 - 14s/epoch - 36ms/step
Epoch 25/50
381/381 - 13s - loss: 3.0804 - accuracy30: 0.4717 - val_loss: 3.2377 - val_accuracy30: 0.4215 - 13s/epoch - 35ms/step
Epoch 26/50
381/381 - 14s - loss: 3.0752 - accuracy30: 0.4740 - val_loss: 3.2473 - val_accuracy30: 0.4205 - 14s/epoch - 36ms/step
Epoch 27/50
381/381 - 14s - loss: 3.0697 - accuracy30: 0.4768 - val_loss: 3.2563 - val_accuracy30: 0.4187 - 14s/epoch - 36ms/step
testing model: results/XRAY/W7/deepVOL_L3/h30
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0896283
{'0': {'precision': 0.3745990680222706, 'recall': 0.6568813424421304, 'f1-score': 0.4771145165408499, 'support': 75385}, '1': {'precision': 0.5364598434328791, 'recall': 0.08770204294449448, 'f1-score': 0.15075776093864582, 'support': 84388}, '2': {'precision': 0.4226431919266614, 'recall': 0.497172900782889, 'f1-score': 0.45688859630045436, 'support': 78172}, 'accuracy': 0.40255100968711255, 'macro avg': {'precision': 0.444567367793937, 'recall': 0.41391876205650463, 'f1-score': 0.36158695792665, 'support': 237945}, 'weighted avg': {'precision': 0.4477874618494343, 'recall': 0.40255100968711255, 'f1-score': 0.354726172474822, 'support': 237945}}
[[49519  2952 22914]
 [46809  7401 30178]
 [35864  3443 38865]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0539641
{'0': {'precision': 0.41839546510254694, 'recall': 0.6449528201705149, 'f1-score': 0.507538948248075, 'support': 32959}, '1': {'precision': 0.5454699694604682, 'recall': 0.20269205308451282, 'f1-score': 0.29555744524373145, 'support': 31723}, '2': {'precision': 0.44458441893091305, 'recall': 0.4728524011084381, 'f1-score': 0.4582829147360033, 'support': 32839}, 'accuracy': 0.44313532469929556, 'macro avg': {'precision': 0.469483284497976, 'recall': 0.44016575812115527, 'f1-score': 0.42045976940926993, 'support': 97521}, 'weighted avg': {'precision': 0.46855085272691555, 'recall': 0.44313532469929556, 'f1-score': 0.42199626406405605, 'support': 97521}}
[[21257  2573  9129]
 [15023  6430 10270]
 [14526  2785 15528]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719563
{'0': {'precision': 0.40821227038059793, 'recall': 0.6847935548841894, 'f1-score': 0.5115089514066496, 'support': 9930}, '1': {'precision': 0.47919143876337694, 'recall': 0.13303257042253522, 'f1-score': 0.20825079665834126, 'support': 9088}, '2': {'precision': 0.444624090541633, 'recall': 0.43741922656327664, 'f1-score': 0.44099223252317715, 'support': 10059}, 'accuracy': 0.4267634212607903, 'macro avg': {'precision': 0.4440092665618693, 'recall': 0.4184151172900004, 'f1-score': 0.3869173268627227, 'support': 29077}, 'weighted avg': {'precision': 0.442993203119964, 'recall': 0.4267634212607903, 'f1-score': 0.39233098306048336, 'support': 29077}}
[[6800  546 2584]
 [4967 1209 2912]
 [4891  768 4400]]
training model: results/XRAY/W7/deepVOL_L3/h50
Epoch 1/50
381/381 - 16s - loss: 3.3465 - accuracy50: 0.3466 - val_loss: 3.3238 - val_accuracy50: 0.3379 - 16s/epoch - 43ms/step
Epoch 2/50
381/381 - 14s - loss: 3.3069 - accuracy50: 0.3495 - val_loss: 3.3210 - val_accuracy50: 0.3341 - 14s/epoch - 36ms/step
Epoch 3/50
381/381 - 14s - loss: 3.2944 - accuracy50: 0.3562 - val_loss: 3.3106 - val_accuracy50: 0.3371 - 14s/epoch - 36ms/step
Epoch 4/50
381/381 - 14s - loss: 3.2806 - accuracy50: 0.3683 - val_loss: 3.3029 - val_accuracy50: 0.3475 - 14s/epoch - 36ms/step
Epoch 5/50
381/381 - 13s - loss: 3.2688 - accuracy50: 0.3776 - val_loss: 3.2848 - val_accuracy50: 0.3601 - 13s/epoch - 35ms/step
Epoch 6/50
381/381 - 13s - loss: 3.2589 - accuracy50: 0.3864 - val_loss: 3.2837 - val_accuracy50: 0.3652 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 14s - loss: 3.2477 - accuracy50: 0.3969 - val_loss: 3.2838 - val_accuracy50: 0.3696 - 14s/epoch - 35ms/step
Epoch 8/50
381/381 - 14s - loss: 3.2408 - accuracy50: 0.3993 - val_loss: 3.2796 - val_accuracy50: 0.3721 - 14s/epoch - 35ms/step
Epoch 9/50
381/381 - 13s - loss: 3.2322 - accuracy50: 0.4069 - val_loss: 3.2724 - val_accuracy50: 0.3761 - 13s/epoch - 35ms/step
Epoch 10/50
381/381 - 14s - loss: 3.2238 - accuracy50: 0.4094 - val_loss: 3.2751 - val_accuracy50: 0.3776 - 14s/epoch - 36ms/step
Epoch 11/50
381/381 - 14s - loss: 3.2144 - accuracy50: 0.4163 - val_loss: 3.2677 - val_accuracy50: 0.3806 - 14s/epoch - 36ms/step
Epoch 12/50
381/381 - 13s - loss: 3.2085 - accuracy50: 0.4195 - val_loss: 3.2768 - val_accuracy50: 0.3813 - 13s/epoch - 35ms/step
Epoch 13/50
381/381 - 13s - loss: 3.2024 - accuracy50: 0.4224 - val_loss: 3.2722 - val_accuracy50: 0.3810 - 13s/epoch - 35ms/step
Epoch 14/50
381/381 - 13s - loss: 3.1966 - accuracy50: 0.4250 - val_loss: 3.2683 - val_accuracy50: 0.3791 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 13s - loss: 3.1908 - accuracy50: 0.4273 - val_loss: 3.2691 - val_accuracy50: 0.3818 - 13s/epoch - 35ms/step
Epoch 16/50
381/381 - 13s - loss: 3.1866 - accuracy50: 0.4303 - val_loss: 3.2690 - val_accuracy50: 0.3800 - 13s/epoch - 35ms/step
Epoch 17/50
381/381 - 14s - loss: 3.1805 - accuracy50: 0.4333 - val_loss: 3.2667 - val_accuracy50: 0.3853 - 14s/epoch - 36ms/step
Epoch 18/50
381/381 - 13s - loss: 3.1756 - accuracy50: 0.4329 - val_loss: 3.2810 - val_accuracy50: 0.3795 - 13s/epoch - 35ms/step
Epoch 19/50
381/381 - 13s - loss: 3.1689 - accuracy50: 0.4363 - val_loss: 3.2848 - val_accuracy50: 0.3767 - 13s/epoch - 35ms/step
Epoch 20/50
381/381 - 13s - loss: 3.1638 - accuracy50: 0.4378 - val_loss: 3.2822 - val_accuracy50: 0.3819 - 13s/epoch - 35ms/step
Epoch 21/50
381/381 - 14s - loss: 3.1605 - accuracy50: 0.4395 - val_loss: 3.2853 - val_accuracy50: 0.3821 - 14s/epoch - 36ms/step
Epoch 22/50
381/381 - 13s - loss: 3.1564 - accuracy50: 0.4399 - val_loss: 3.2875 - val_accuracy50: 0.3803 - 13s/epoch - 35ms/step
Epoch 23/50
381/381 - 13s - loss: 3.1504 - accuracy50: 0.4449 - val_loss: 3.2964 - val_accuracy50: 0.3782 - 13s/epoch - 35ms/step
Epoch 24/50
381/381 - 14s - loss: 3.1450 - accuracy50: 0.4464 - val_loss: 3.2990 - val_accuracy50: 0.3766 - 14s/epoch - 36ms/step
Epoch 25/50
381/381 - 13s - loss: 3.1408 - accuracy50: 0.4469 - val_loss: 3.3126 - val_accuracy50: 0.3746 - 13s/epoch - 34ms/step
Epoch 26/50
381/381 - 13s - loss: 3.1375 - accuracy50: 0.4479 - val_loss: 3.3069 - val_accuracy50: 0.3754 - 13s/epoch - 35ms/step
Epoch 27/50
381/381 - 13s - loss: 3.1290 - accuracy50: 0.4510 - val_loss: 3.3026 - val_accuracy50: 0.3773 - 13s/epoch - 35ms/step
testing model: results/XRAY/W7/deepVOL_L3/h50
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000936
{'0': {'precision': 0.3419884472014341, 'recall': 0.667787192665648, 'f1-score': 0.4523292027737789, 'support': 71990}, '1': {'precision': 0.4879393521709166, 'recall': 0.1093532799364533, 'f1-score': 0.17866541692202312, 'support': 90642}, '2': {'precision': 0.3967609234482669, 'recall': 0.4059591305617888, 'f1-score': 0.40130732680544984, 'support': 75313}, 'accuracy': 0.37218684990228834, 'macro avg': {'precision': 0.4088962409402059, 'recall': 0.3943665343879634, 'f1-score': 0.34410064883375063, 'support': 237945}, 'weighted avg': {'precision': 0.4149227867833608, 'recall': 0.37218684990228834, 'f1-score': 0.33193144941910613, 'support': 237945}}
[[48074  4797 19119]
 [53364  9912 27366]
 [39134  5605 30574]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0717498
{'0': {'precision': 0.39555916049883405, 'recall': 0.6030170948097313, 'f1-score': 0.4777380485893417, 'support': 32349}, '1': {'precision': 0.4631955822562049, 'recall': 0.23509301466058888, 'f1-score': 0.31188836905224016, 'support': 32468}, '2': {'precision': 0.4206511803826394, 'recall': 0.40808463796477495, 'f1-score': 0.41427263273889897, 'support': 32704}, 'accuracy': 0.41515160837153026, 'macro avg': {'precision': 0.4264686410458928, 'recall': 0.4153982491450317, 'f1-score': 0.4012996834601603, 'support': 97521}, 'weighted avg': {'precision': 0.42649228013356183, 'recall': 0.41515160837153026, 'f1-score': 0.4012378039734796, 'support': 97521}}
[[19507  4040  8802]
 [15256  7633  9579]
 [14552  4806 13346]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0895921
{'0': {'precision': 0.3741174987392839, 'recall': 0.6210757639179573, 'f1-score': 0.466955153422502, 'support': 9556}, '1': {'precision': 0.41076294277929154, 'recall': 0.1880261927034612, 'f1-score': 0.2579679144385027, 'support': 9621}, '2': {'precision': 0.3899421046656828, 'recall': 0.346969696969697, 'f1-score': 0.3672029504516543, 'support': 9900}, 'accuracy': 0.3844619458678681, 'macro avg': {'precision': 0.39160751539475275, 'recall': 0.3853572178637052, 'f1-score': 0.3640420061042196, 'support': 29077}, 'weighted avg': {'precision': 0.3916306333742277, 'recall': 0.3844619458678681, 'f1-score': 0.3638422794782694, 'support': 29077}}
[[5935 1101 2520]
 [4958 1809 2854]
 [4971 1494 3435]]
training model: results/XRAY/W7/deepVOL_L3/h100
Epoch 1/50
381/381 - 16s - loss: 3.3556 - accuracy100: 0.3423 - val_loss: 3.3476 - val_accuracy100: 0.3350 - 16s/epoch - 43ms/step
Epoch 2/50
381/381 - 14s - loss: 3.3129 - accuracy100: 0.3461 - val_loss: 3.3220 - val_accuracy100: 0.3403 - 14s/epoch - 36ms/step
Epoch 3/50
381/381 - 14s - loss: 3.2969 - accuracy100: 0.3542 - val_loss: 3.3113 - val_accuracy100: 0.3462 - 14s/epoch - 36ms/step
Epoch 4/50
381/381 - 14s - loss: 3.2854 - accuracy100: 0.3666 - val_loss: 3.3028 - val_accuracy100: 0.3434 - 14s/epoch - 36ms/step
Epoch 5/50
381/381 - 13s - loss: 3.2786 - accuracy100: 0.3706 - val_loss: 3.2916 - val_accuracy100: 0.3508 - 13s/epoch - 35ms/step
Epoch 6/50
381/381 - 13s - loss: 3.2733 - accuracy100: 0.3738 - val_loss: 3.2916 - val_accuracy100: 0.3560 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 13s - loss: 3.2704 - accuracy100: 0.3772 - val_loss: 3.2950 - val_accuracy100: 0.3576 - 13s/epoch - 35ms/step
Epoch 8/50
381/381 - 13s - loss: 3.2654 - accuracy100: 0.3835 - val_loss: 3.2962 - val_accuracy100: 0.3533 - 13s/epoch - 35ms/step
Epoch 9/50
381/381 - 13s - loss: 3.2602 - accuracy100: 0.3875 - val_loss: 3.2915 - val_accuracy100: 0.3600 - 13s/epoch - 35ms/step
Epoch 10/50
381/381 - 13s - loss: 3.2539 - accuracy100: 0.3918 - val_loss: 3.2922 - val_accuracy100: 0.3595 - 13s/epoch - 35ms/step
Epoch 11/50
381/381 - 13s - loss: 3.2498 - accuracy100: 0.3952 - val_loss: 3.2982 - val_accuracy100: 0.3576 - 13s/epoch - 35ms/step
Epoch 12/50
381/381 - 14s - loss: 3.2453 - accuracy100: 0.3973 - val_loss: 3.2975 - val_accuracy100: 0.3610 - 14s/epoch - 36ms/step
Epoch 13/50
381/381 - 14s - loss: 3.2385 - accuracy100: 0.4025 - val_loss: 3.3087 - val_accuracy100: 0.3624 - 14s/epoch - 36ms/step
Epoch 14/50
381/381 - 13s - loss: 3.2324 - accuracy100: 0.4066 - val_loss: 3.2956 - val_accuracy100: 0.3680 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 14s - loss: 3.2262 - accuracy100: 0.4082 - val_loss: 3.3087 - val_accuracy100: 0.3622 - 14s/epoch - 36ms/step
Epoch 16/50
381/381 - 14s - loss: 3.2223 - accuracy100: 0.4106 - val_loss: 3.3078 - val_accuracy100: 0.3662 - 14s/epoch - 37ms/step
Epoch 17/50
381/381 - 13s - loss: 3.2166 - accuracy100: 0.4140 - val_loss: 3.3056 - val_accuracy100: 0.3683 - 13s/epoch - 35ms/step
Epoch 18/50
381/381 - 13s - loss: 3.2090 - accuracy100: 0.4164 - val_loss: 3.3117 - val_accuracy100: 0.3668 - 13s/epoch - 35ms/step
Epoch 19/50
381/381 - 13s - loss: 3.2018 - accuracy100: 0.4213 - val_loss: 3.3182 - val_accuracy100: 0.3674 - 13s/epoch - 35ms/step
testing model: results/XRAY/W7/deepVOL_L3/h100
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1001258
{'0': {'precision': 0.34806583393574636, 'recall': 0.2623615581519122, 'f1-score': 0.2991972369343266, 'support': 78914}, '1': {'precision': 0.3608896539228121, 'recall': 0.3046420923829917, 'f1-score': 0.3303889856514887, 'support': 78456}, '2': {'precision': 0.35676354758807494, 'recall': 0.4969407384424449, 'f1-score': 0.415343682089529, 'support': 80575}, 'accuracy': 0.3557376704700666, 'macro avg': {'precision': 0.3552396784822111, 'recall': 0.35464812965911624, 'f1-score': 0.34830996822511473, 'support': 237945}, 'weighted avg': {'precision': 0.35523944085516723, 'recall': 0.3557376704700666, 'f1-score': 0.3488123986554559, 'support': 237945}}
[[20704 20690 37520]
 [19882 23901 34673]
 [18897 21637 40041]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091469
{'0': {'precision': 0.3748211731044349, 'recall': 0.25840653413468945, 'f1-score': 0.3059128308977797, 'support': 32445}, '1': {'precision': 0.3794058086180821, 'recall': 0.45893150599981397, 'f1-score': 0.41539670511633126, 'support': 32251}, '2': {'precision': 0.3709257927065464, 'recall': 0.40840822543792843, 'f1-score': 0.388765641538707, 'support': 32825}, 'accuracy': 0.37521149290921957, 'macro avg': {'precision': 0.3750509248096878, 'recall': 0.37524875519081063, 'f1-score': 0.37002505918427264, 'support': 97521}, 'weighted avg': {'precision': 0.37502618759762046, 'recall': 0.37521149290921957, 'f1-score': 0.37000782517297115, 'support': 97521}}
[[ 8384 11737 12324]
 [ 7038 14801 10412]
 [ 6946 12473 13406]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973924
{'0': {'precision': 0.35221606648199444, 'recall': 0.2634687111479486, 'f1-score': 0.3014461830251304, 'support': 9652}, '1': {'precision': 0.35281247151062084, 'recall': 0.41671153224938084, 'f1-score': 0.38210900473933646, 'support': 9287}, '2': {'precision': 0.36746877296105807, 'recall': 0.3946537778654567, 'f1-score': 0.38057642918291634, 'support': 10138}, 'accuracy': 0.35815249166007496, 'macro avg': {'precision': 0.35749910365122445, 'recall': 0.35827800708759533, 'f1-score': 0.354710538982461, 'support': 29077}, 'weighted avg': {'precision': 0.35772456982778666, 'recall': 0.35815249166007496, 'f1-score': 0.35479893815143176, 'support': 29077}}
[[2543 3335 3774]
 [2304 3870 3113]
 [2373 3764 4001]]
training model: results/XRAY/W7/deepVOL_L3/h200
Epoch 1/50
381/381 - 17s - loss: 3.3522 - accuracy200: 0.3433 - val_loss: 3.3225 - val_accuracy200: 0.3430 - 17s/epoch - 45ms/step
Epoch 2/50
381/381 - 14s - loss: 3.3096 - accuracy200: 0.3509 - val_loss: 3.3095 - val_accuracy200: 0.3488 - 14s/epoch - 36ms/step
Epoch 3/50
381/381 - 13s - loss: 3.2940 - accuracy200: 0.3600 - val_loss: 3.2997 - val_accuracy200: 0.3448 - 13s/epoch - 35ms/step
Epoch 4/50
381/381 - 13s - loss: 3.2783 - accuracy200: 0.3703 - val_loss: 3.3102 - val_accuracy200: 0.3498 - 13s/epoch - 34ms/step
Epoch 5/50
381/381 - 13s - loss: 3.2693 - accuracy200: 0.3779 - val_loss: 3.2976 - val_accuracy200: 0.3535 - 13s/epoch - 35ms/step
Epoch 6/50
381/381 - 13s - loss: 3.2649 - accuracy200: 0.3837 - val_loss: 3.2791 - val_accuracy200: 0.3742 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 14s - loss: 3.2555 - accuracy200: 0.3889 - val_loss: 3.2803 - val_accuracy200: 0.3699 - 14s/epoch - 36ms/step
Epoch 8/50
381/381 - 14s - loss: 3.2493 - accuracy200: 0.3933 - val_loss: 3.2755 - val_accuracy200: 0.3705 - 14s/epoch - 36ms/step
Epoch 9/50
381/381 - 14s - loss: 3.2471 - accuracy200: 0.3982 - val_loss: 3.2779 - val_accuracy200: 0.3706 - 14s/epoch - 36ms/step
Epoch 10/50
381/381 - 13s - loss: 3.2375 - accuracy200: 0.4035 - val_loss: 3.2876 - val_accuracy200: 0.3703 - 13s/epoch - 35ms/step
Epoch 11/50
381/381 - 14s - loss: 3.2317 - accuracy200: 0.4102 - val_loss: 3.2773 - val_accuracy200: 0.3718 - 14s/epoch - 36ms/step
Epoch 12/50
381/381 - 13s - loss: 3.2255 - accuracy200: 0.4117 - val_loss: 3.2814 - val_accuracy200: 0.3713 - 13s/epoch - 35ms/step
Epoch 13/50
381/381 - 13s - loss: 3.2219 - accuracy200: 0.4146 - val_loss: 3.2824 - val_accuracy200: 0.3724 - 13s/epoch - 34ms/step
Epoch 14/50
381/381 - 13s - loss: 3.2139 - accuracy200: 0.4182 - val_loss: 3.2810 - val_accuracy200: 0.3732 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 13s - loss: 3.2083 - accuracy200: 0.4209 - val_loss: 3.2885 - val_accuracy200: 0.3666 - 13s/epoch - 35ms/step
Epoch 16/50
381/381 - 14s - loss: 3.2228 - accuracy200: 0.4159 - val_loss: 3.2843 - val_accuracy200: 0.3689 - 14s/epoch - 36ms/step
Epoch 17/50
381/381 - 13s - loss: 3.2124 - accuracy200: 0.4192 - val_loss: 3.2871 - val_accuracy200: 0.3659 - 13s/epoch - 35ms/step
Epoch 18/50
381/381 - 13s - loss: 3.2095 - accuracy200: 0.4214 - val_loss: 3.2909 - val_accuracy200: 0.3666 - 13s/epoch - 35ms/step
testing model: results/XRAY/W7/deepVOL_L3/h200
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.111702
{'0': {'precision': 0.335930944235475, 'recall': 0.7415030309310399, 'f1-score': 0.4623834389399759, 'support': 77204}, '1': {'precision': 0.4872393606525028, 'recall': 0.17878908559912143, 'f1-score': 0.2615896670757224, 'support': 82863}, '2': {'precision': 0.3228734579539945, 'recall': 0.15392023421248618, 'f1-score': 0.2084623143542833, 'support': 77878}, 'accuracy': 0.3532286873016874, 'macro avg': {'precision': 0.3820145876139907, 'recall': 0.3580707835808825, 'f1-score': 0.31081180678999387, 'support': 237945}, 'weighted avg': {'precision': 0.3843496056611617, 'recall': 0.3532286873016874, 'f1-score': 0.3093512522646005, 'support': 237945}}
[[57247  8217 11740]
 [54649 14815 13399]
 [58517  7374 11987]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0899023
{'0': {'precision': 0.3603504928806134, 'recall': 0.6610305709251646, 'f1-score': 0.46643255976269415, 'support': 32351}, '1': {'precision': 0.4426414439430753, 'recall': 0.3172756958482351, 'f1-score': 0.36961759324674387, 'support': 32155}, '2': {'precision': 0.3664727657324167, 'recall': 0.16792367105860972, 'f1-score': 0.23031385663544027, 'support': 33015}, 'accuracy': 0.38074876180514966, 'macro avg': {'precision': 0.3898215675187018, 'recall': 0.3820766459440031, 'f1-score': 0.3554546698816261, 'support': 97521}, 'weighted avg': {'precision': 0.38955643180264815, 'recall': 0.38074876180514966, 'f1-score': 0.35457414739954496, 'support': 97521}}
[[21385  6318  4648]
 [17017 10202  4936]
 [20943  6528  5544]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922574
{'0': {'precision': 0.3537396716385878, 'recall': 0.692833123160992, 'f1-score': 0.4683526319528309, 'support': 9516}, '1': {'precision': 0.4472815702622894, 'recall': 0.2730067854113656, 'f1-score': 0.33906116268352093, 'support': 9432}, '2': {'precision': 0.355403673643742, 'recall': 0.16428077796426102, 'f1-score': 0.22469785969887243, 'support': 10129}, 'accuracy': 0.3725281150049868, 'macro avg': {'precision': 0.3854749718482064, 'recall': 0.3767068955122062, 'f1-score': 0.3440372181117414, 'support': 29077}, 'weighted avg': {'precision': 0.3846624581753336, 'recall': 0.3725281150049868, 'f1-score': 0.3415356863838768, 'support': 29077}}
[[6593 1501 1422]
 [5261 2575 1596]
 [6784 1681 1664]]
training model: results/XRAY/W7/deepVOL_L3/h300
Epoch 1/50
381/381 - 17s - loss: 3.3482 - accuracy300: 0.3421 - val_loss: 3.3151 - val_accuracy300: 0.3519 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 15s - loss: 3.3050 - accuracy300: 0.3520 - val_loss: 3.3036 - val_accuracy300: 0.3478 - 15s/epoch - 39ms/step
Epoch 3/50
381/381 - 14s - loss: 3.2827 - accuracy300: 0.3673 - val_loss: 3.2902 - val_accuracy300: 0.3593 - 14s/epoch - 36ms/step
Epoch 4/50
381/381 - 14s - loss: 3.2731 - accuracy300: 0.3731 - val_loss: 3.2806 - val_accuracy300: 0.3665 - 14s/epoch - 37ms/step
Epoch 5/50
381/381 - 14s - loss: 3.2668 - accuracy300: 0.3754 - val_loss: 3.2809 - val_accuracy300: 0.3689 - 14s/epoch - 36ms/step
Epoch 6/50
381/381 - 14s - loss: 3.2604 - accuracy300: 0.3797 - val_loss: 3.2829 - val_accuracy300: 0.3629 - 14s/epoch - 37ms/step
Epoch 7/50
381/381 - 14s - loss: 3.2572 - accuracy300: 0.3842 - val_loss: 3.2840 - val_accuracy300: 0.3651 - 14s/epoch - 36ms/step
Epoch 8/50
381/381 - 14s - loss: 3.2506 - accuracy300: 0.3888 - val_loss: 3.2855 - val_accuracy300: 0.3648 - 14s/epoch - 38ms/step
Epoch 9/50
381/381 - 13s - loss: 3.2459 - accuracy300: 0.3945 - val_loss: 3.2942 - val_accuracy300: 0.3588 - 13s/epoch - 35ms/step
Epoch 10/50
381/381 - 14s - loss: 3.2418 - accuracy300: 0.3954 - val_loss: 3.3014 - val_accuracy300: 0.3586 - 14s/epoch - 37ms/step
Epoch 11/50
381/381 - 13s - loss: 3.2387 - accuracy300: 0.4008 - val_loss: 3.3105 - val_accuracy300: 0.3484 - 13s/epoch - 35ms/step
Epoch 12/50
381/381 - 13s - loss: 3.2344 - accuracy300: 0.4038 - val_loss: 3.3000 - val_accuracy300: 0.3589 - 13s/epoch - 35ms/step
Epoch 13/50
381/381 - 13s - loss: 3.2271 - accuracy300: 0.4083 - val_loss: 3.3173 - val_accuracy300: 0.3501 - 13s/epoch - 35ms/step
Epoch 14/50
381/381 - 14s - loss: 3.2213 - accuracy300: 0.4116 - val_loss: 3.3253 - val_accuracy300: 0.3486 - 14s/epoch - 36ms/step
testing model: results/XRAY/W7/deepVOL_L3/h300
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958165
{'0': {'precision': 0.33764631518022376, 'recall': 0.569169148608401, 'f1-score': 0.42385220238522026, 'support': 77896}, '1': {'precision': 0.40549308457826316, 'recall': 0.4349974610802175, 'f1-score': 0.419727415586666, 'support': 80743}, '2': {'precision': 0.3817564192226996, 'recall': 0.09636093107709379, 'f1-score': 0.15388023035721474, 'support': 79306}, 'accuracy': 0.3660551808190968, 'macro avg': {'precision': 0.3749652729937289, 'recall': 0.36684251358857073, 'f1-score': 0.3324866161097003, 'support': 237945}, 'weighted avg': {'precision': 0.37537077929041096, 'recall': 0.3660551808190968, 'f1-score': 0.3324720730522707, 'support': 237945}}
[[44336 26793  6767]
 [40011 35123  5609]
 [46962 24702  7642]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907899
{'0': {'precision': 0.36029645314981473, 'recall': 0.5275805401382903, 'f1-score': 0.428179576224269, 'support': 32251}, '1': {'precision': 0.39484750227986626, 'recall': 0.48471561401872065, 'f1-score': 0.4351904848324097, 'support': 32157}, '2': {'precision': 0.3743992606284658, 'recall': 0.12233865853290249, 'f1-score': 0.18441718070698565, 'support': 33113}, 'accuracy': 0.3758472534120856, 'macro avg': {'precision': 0.37651440535271563, 'recall': 0.3782116042299711, 'f1-score': 0.3492624139212214, 'support': 97521}, 'weighted avg': {'precision': 0.3764780381511544, 'recall': 0.3758472534120856, 'f1-score': 0.3477225011875915, 'support': 97521}}
[[17015 11640  3596]
 [13397 15587  3173]
 [16813 12249  4051]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938722
{'0': {'precision': 0.34187218967161737, 'recall': 0.543073593073593, 'f1-score': 0.41960030102851403, 'support': 9240}, '1': {'precision': 0.4056343390120872, 'recall': 0.43361481330755924, 'f1-score': 0.4191581431943352, 'support': 9829}, '2': {'precision': 0.35303186022610483, 'recall': 0.13729016786570744, 'f1-score': 0.19769784172661872, 'support': 10008}, 'accuracy': 0.36640643807820616, 'macro avg': {'precision': 0.3668461296366032, 'recall': 0.3713261914156199, 'f1-score': 0.3454854286498226, 'support': 29077}, 'weighted avg': {'precision': 0.36726697416715637, 'recall': 0.36640643807820616, 'f1-score': 0.34307432578878805, 'support': 29077}}
[[5018 2913 1309]
 [4358 4262 1209]
 [5302 3332 1374]]
training model: results/XRAY/W7/deepVOL_L3/h500
Epoch 1/50
381/381 - 17s - loss: 3.3399 - accuracy500: 0.3508 - val_loss: 3.3163 - val_accuracy500: 0.3526 - 17s/epoch - 44ms/step
Epoch 2/50
381/381 - 14s - loss: 3.3051 - accuracy500: 0.3593 - val_loss: 3.3140 - val_accuracy500: 0.3479 - 14s/epoch - 36ms/step
Epoch 3/50
381/381 - 13s - loss: 3.3051 - accuracy500: 0.3465 - val_loss: 3.3373 - val_accuracy500: 0.3036 - 13s/epoch - 34ms/step
Epoch 4/50
381/381 - 13s - loss: 3.2898 - accuracy500: 0.3560 - val_loss: 3.3274 - val_accuracy500: 0.3141 - 13s/epoch - 35ms/step
Epoch 5/50
381/381 - 13s - loss: 3.2844 - accuracy500: 0.3647 - val_loss: 3.3223 - val_accuracy500: 0.3288 - 13s/epoch - 35ms/step
Epoch 6/50
381/381 - 13s - loss: 3.2771 - accuracy500: 0.3722 - val_loss: 3.3096 - val_accuracy500: 0.3428 - 13s/epoch - 35ms/step
Epoch 7/50
381/381 - 13s - loss: 3.2684 - accuracy500: 0.3837 - val_loss: 3.3375 - val_accuracy500: 0.3311 - 13s/epoch - 35ms/step
Epoch 8/50
381/381 - 14s - loss: 3.2654 - accuracy500: 0.3852 - val_loss: 3.3025 - val_accuracy500: 0.3518 - 14s/epoch - 36ms/step
Epoch 9/50
381/381 - 13s - loss: 3.2544 - accuracy500: 0.3930 - val_loss: 3.3351 - val_accuracy500: 0.3343 - 13s/epoch - 35ms/step
Epoch 10/50
381/381 - 13s - loss: 3.2473 - accuracy500: 0.3984 - val_loss: 3.3351 - val_accuracy500: 0.3366 - 13s/epoch - 35ms/step
Epoch 11/50
381/381 - 13s - loss: 3.2402 - accuracy500: 0.4037 - val_loss: 3.3340 - val_accuracy500: 0.3423 - 13s/epoch - 35ms/step
Epoch 12/50
381/381 - 14s - loss: 3.2383 - accuracy500: 0.4035 - val_loss: 3.3252 - val_accuracy500: 0.3483 - 14s/epoch - 35ms/step
Epoch 13/50
381/381 - 13s - loss: 3.2285 - accuracy500: 0.4084 - val_loss: 3.3582 - val_accuracy500: 0.3420 - 13s/epoch - 35ms/step
Epoch 14/50
381/381 - 13s - loss: 3.2274 - accuracy500: 0.4090 - val_loss: 3.3549 - val_accuracy500: 0.3427 - 13s/epoch - 35ms/step
Epoch 15/50
381/381 - 13s - loss: 3.2185 - accuracy500: 0.4129 - val_loss: 3.3445 - val_accuracy500: 0.3475 - 13s/epoch - 34ms/step
Epoch 16/50
381/381 - 13s - loss: 3.2088 - accuracy500: 0.4184 - val_loss: 3.3545 - val_accuracy500: 0.3408 - 13s/epoch - 35ms/step
Epoch 17/50
381/381 - 13s - loss: 3.2020 - accuracy500: 0.4223 - val_loss: 3.3508 - val_accuracy500: 0.3509 - 13s/epoch - 35ms/step
Epoch 18/50
381/381 - 13s - loss: 3.1923 - accuracy500: 0.4268 - val_loss: 3.3582 - val_accuracy500: 0.3396 - 13s/epoch - 34ms/step
testing model: results/XRAY/W7/deepVOL_L3/h500
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098921
{'0': {'precision': 0.3392917597670797, 'recall': 0.5184418809166623, 'f1-score': 0.4101577687286419, 'support': 77324}, '1': {'precision': 0.4044320743335485, 'recall': 0.4693744703324777, 'f1-score': 0.4344899722588567, 'support': 81419}, '2': {'precision': 0.376798418972332, 'recall': 0.12036312214338021, 'f1-score': 0.1824462689709288, 'support': 79202}, 'accuracy': 0.3691483325978693, 'macro avg': {'precision': 0.3735074176909867, 'recall': 0.36939315779750675, 'f1-score': 0.34236466998614246, 'support': 237945}, 'weighted avg': {'precision': 0.37406560117606796, 'recall': 0.3691483325978693, 'f1-score': 0.3426879646790345, 'support': 237945}}
[[40088 29625  7611]
 [35047 38216  8156]
 [43017 26652  9533]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.090673
{'0': {'precision': 0.3693141748942172, 'recall': 0.5217797428153315, 'f1-score': 0.4325035809686036, 'support': 32117}, '1': {'precision': 0.39165849611584586, 'recall': 0.4835195530726257, 'f1-score': 0.43276803200133335, 'support': 32220}, '2': {'precision': 0.41283958602846055, 'recall': 0.15386933461909355, 'f1-score': 0.2241833508956797, 'support': 33184}, 'accuracy': 0.3839480727227982, 'macro avg': {'precision': 0.39127075234617453, 'recall': 0.3863895435023503, 'f1-score': 0.3631516546218722, 'support': 97521}, 'weighted avg': {'precision': 0.3915071515129927, 'recall': 0.3839480727227982, 'f1-score': 0.36170469762588403, 'support': 97521}}
[[16758 11759  3600]
 [12979 15579  3662]
 [15639 12439  5106]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024858
{'0': {'precision': 0.31597633136094677, 'recall': 0.5178551055333713, 'f1-score': 0.3924773022049287, 'support': 8765}, '1': {'precision': 0.393647828117702, 'recall': 0.41780686099543923, 'f1-score': 0.4053677071809918, 'support': 10086}, '2': {'precision': 0.38033441477414526, 'recall': 0.14903187952278507, 'f1-score': 0.2141502142907328, 'support': 10226}, 'accuracy': 0.35344086391305846, 'macro avg': {'precision': 0.3633195247509313, 'recall': 0.36156461535053186, 'f1-score': 0.33733174122555115, 'support': 29077}, 'weighted avg': {'precision': 0.3655523012777883, 'recall': 0.35344086391305846, 'f1-score': 0.33423332323797905, 'support': 29077}}
[[4539 2912 1314]
 [4703 4214 1169]
 [5123 3579 1524]]
training model: results/XRAY/W7/deepVOL_L3/h1000
Epoch 1/50
381/381 - 16s - loss: 3.3419 - accuracy1000: 0.3555 - val_loss: 3.3329 - val_accuracy1000: 0.3214 - 16s/epoch - 42ms/step
Epoch 2/50
381/381 - 14s - loss: 3.3026 - accuracy1000: 0.3605 - val_loss: 3.3037 - val_accuracy1000: 0.3453 - 14s/epoch - 36ms/step
Epoch 3/50
381/381 - 13s - loss: 3.2997 - accuracy1000: 0.3567 - val_loss: 3.3156 - val_accuracy1000: 0.3109 - 13s/epoch - 35ms/step
Epoch 4/50
381/381 - 14s - loss: 3.2972 - accuracy1000: 0.3556 - val_loss: 3.2945 - val_accuracy1000: 0.3283 - 14s/epoch - 36ms/step
Epoch 5/50
381/381 - 13s - loss: 3.2882 - accuracy1000: 0.3643 - val_loss: 3.3135 - val_accuracy1000: 0.3268 - 13s/epoch - 35ms/step
Epoch 6/50
381/381 - 14s - loss: 3.2792 - accuracy1000: 0.3764 - val_loss: 3.3220 - val_accuracy1000: 0.3330 - 14s/epoch - 36ms/step
Epoch 7/50
381/381 - 14s - loss: 3.2772 - accuracy1000: 0.3764 - val_loss: 3.3233 - val_accuracy1000: 0.3345 - 14s/epoch - 36ms/step
Epoch 8/50
381/381 - 13s - loss: 3.2709 - accuracy1000: 0.3857 - val_loss: 3.3123 - val_accuracy1000: 0.3422 - 13s/epoch - 35ms/step
Epoch 9/50
381/381 - 13s - loss: 3.2670 - accuracy1000: 0.3864 - val_loss: 3.3139 - val_accuracy1000: 0.3432 - 13s/epoch - 35ms/step
Epoch 10/50
381/381 - 13s - loss: 3.2611 - accuracy1000: 0.3921 - val_loss: 3.3179 - val_accuracy1000: 0.3425 - 13s/epoch - 35ms/step
Epoch 11/50
381/381 - 13s - loss: 3.2511 - accuracy1000: 0.3973 - val_loss: 3.3270 - val_accuracy1000: 0.3445 - 13s/epoch - 35ms/step
Epoch 12/50
381/381 - 13s - loss: 3.2454 - accuracy1000: 0.4023 - val_loss: 3.3244 - val_accuracy1000: 0.3490 - 13s/epoch - 35ms/step
Epoch 13/50
381/381 - 13s - loss: 3.2401 - accuracy1000: 0.4048 - val_loss: 3.3322 - val_accuracy1000: 0.3485 - 13s/epoch - 35ms/step
Epoch 14/50
381/381 - 13s - loss: 3.2341 - accuracy1000: 0.4074 - val_loss: 3.3278 - val_accuracy1000: 0.3507 - 13s/epoch - 34ms/step
testing model: results/XRAY/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006693
{'0': {'precision': 0.32570234196277215, 'recall': 0.7743677366341024, 'f1-score': 0.45854057894899436, 'support': 76669}, '1': {'precision': 0.42999788449333615, 'recall': 0.12264378635387252, 'f1-score': 0.19085266805006526, 'support': 82866}, '2': {'precision': 0.33746526368376684, 'recall': 0.1378395612804489, 'f1-score': 0.19573150302887618, 'support': 78410}, 'accuracy': 0.33764525415537205, 'macro avg': {'precision': 0.36438849671329177, 'recall': 0.34495036142280794, 'f1-score': 0.28170825000931193, 'support': 237945}, 'weighted avg': {'precision': 0.3659002243283646, 'recall': 0.33764525415537205, 'f1-score': 0.2787129462294704, 'support': 237945}}
[[59370  7660  9639]
 [61123 10163 11580]
 [61790  5812 10808]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971098
{'0': {'precision': 0.33891607858360945, 'recall': 0.7620487561568676, 'f1-score': 0.46917134494506024, 'support': 32078}, '1': {'precision': 0.3999152901313003, 'recall': 0.14658759237409177, 'f1-score': 0.214537274772216, 'support': 32206}, '2': {'precision': 0.3591875781882405, 'recall': 0.14685440924271143, 'f1-score': 0.20847392474266435, 'support': 33237}, 'accuracy': 0.3491248038883933, 'macro avg': {'precision': 0.3660063156343834, 'recall': 0.3518302525912236, 'f1-score': 0.29739418148664687, 'support': 97521}, 'weighted avg': {'precision': 0.36596978434405136, 'recall': 0.3491248038883933, 'f1-score': 0.2962286452265006, 'support': 97521}}
[[24445  3658  3975]
 [22752  4721  4733]
 [24930  3426  4881]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996499
{'0': {'precision': 0.3084170573788792, 'recall': 0.7849755654051597, 'f1-score': 0.44284157209719816, 'support': 8799}, '1': {'precision': 0.38220805563604754, 'recall': 0.1388567217601853, 'f1-score': 0.20370656370656373, 'support': 9499}, '2': {'precision': 0.39337666357164963, 'recall': 0.11791446330828463, 'f1-score': 0.1814418272662384, 'support': 10779}, 'accuracy': 0.3266155380541321, 'macro avg': {'precision': 0.3613339255288588, 'recall': 0.3472489168245432, 'f1-score': 0.27599665435666676, 'support': 29077}, 'weighted avg': {'precision': 0.36401840165774957, 'recall': 0.3266155380541321, 'f1-score': 0.2678176255334002, 'support': 29077}}
[[6907  933  959]
 [7179 1319 1001]
 [8309 1199 1271]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)   8.83 (ave)

============================================
