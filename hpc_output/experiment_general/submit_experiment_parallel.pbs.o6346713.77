This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-10-09.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-01.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-18.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-19.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-27.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-23.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-25.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-20.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-11.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-24.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-07.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-26.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-17.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-03.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-02.csv
training model: results/WBA/W7/deepLOB_L1/h10
Epoch 1/50
1230/1230 - 45s - loss: 3.1447 - accuracy10: 0.4137 - val_loss: 3.4965 - val_accuracy10: 0.4010 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.0791 - accuracy10: 0.4229 - val_loss: 3.2519 - val_accuracy10: 0.4568 - 19s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.0220 - accuracy10: 0.4512 - val_loss: 3.1931 - val_accuracy10: 0.4460 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 19s - loss: 2.9880 - accuracy10: 0.4641 - val_loss: 3.2552 - val_accuracy10: 0.4890 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 2.9648 - accuracy10: 0.4732 - val_loss: 3.2391 - val_accuracy10: 0.4815 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 2.9474 - accuracy10: 0.4800 - val_loss: 3.2210 - val_accuracy10: 0.4610 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 2.9334 - accuracy10: 0.4847 - val_loss: 3.2114 - val_accuracy10: 0.4619 - 18s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 2.9213 - accuracy10: 0.4900 - val_loss: 3.1548 - val_accuracy10: 0.4643 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 2.9086 - accuracy10: 0.4942 - val_loss: 3.1972 - val_accuracy10: 0.4781 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 2.8983 - accuracy10: 0.4974 - val_loss: 3.2062 - val_accuracy10: 0.4715 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 2.8901 - accuracy10: 0.4992 - val_loss: 3.2295 - val_accuracy10: 0.4636 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 19s - loss: 2.8803 - accuracy10: 0.5022 - val_loss: 3.2483 - val_accuracy10: 0.4782 - 19s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 2.8714 - accuracy10: 0.5046 - val_loss: 3.2438 - val_accuracy10: 0.4664 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 2.8653 - accuracy10: 0.5048 - val_loss: 3.2917 - val_accuracy10: 0.4647 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 19s - loss: 2.8591 - accuracy10: 0.5075 - val_loss: 3.2862 - val_accuracy10: 0.4760 - 19s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 19s - loss: 2.8525 - accuracy10: 0.5079 - val_loss: 3.3101 - val_accuracy10: 0.4697 - 19s/epoch - 15ms/step
Epoch 17/50
1230/1230 - 19s - loss: 2.8441 - accuracy10: 0.5108 - val_loss: 3.3449 - val_accuracy10: 0.4792 - 19s/epoch - 15ms/step
Epoch 18/50
1230/1230 - 18s - loss: 2.8395 - accuracy10: 0.5119 - val_loss: 3.3464 - val_accuracy10: 0.4928 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h10
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0039861
{'0': {'precision': 0.31682439537329127, 'recall': 0.6707748752176178, 'f1-score': 0.430372622987583, 'support': 224591}, '1': {'precision': 0.7112978932967192, 'recall': 0.4599083010280004, 'f1-score': 0.5586237627773202, 'support': 629669}, '2': {'precision': 0.39245542486130136, 'recall': 0.34159166704737537, 'f1-score': 0.3652613144248688, 'support': 218890}, 'accuracy': 0.4799058845454969, 'macro avg': {'precision': 0.47352590451043736, 'recall': 0.4907582810976645, 'f1-score': 0.4514192333965907, 'support': 1073150}, 'weighted avg': {'precision': 0.5637075049186274, 'recall': 0.4799058845454969, 'f1-score': 0.4923430396199005, 'support': 1073150}}
[[150650  52120  21821]
 [246150 289590  93929]
 [ 78700  65419  74771]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0225637
{'0': {'precision': 0.3554995208351741, 'recall': 0.675243025522521, 'f1-score': 0.46577794400512934, 'support': 77461}, '1': {'precision': 0.6375851247038665, 'recall': 0.4534145659134003, 'f1-score': 0.5299550220529999, 'support': 160855}, '2': {'precision': 0.44022869997188113, 'recall': 0.3067758749069248, 'f1-score': 0.3615815729506683, 'support': 76551}, 'accuracy': 0.47233593866616697, 'macro avg': {'precision': 0.47777111517030724, 'recall': 0.4784778221142821, 'f1-score': 0.45243817966959926, 'support': 314867}, 'weighted avg': {'precision': 0.5202071059501356, 'recall': 0.47233593866616697, 'f1-score': 0.4732314640272345, 'support': 314867}}
[[52305 17869  7287]
 [65347 72934 22574]
 [29479 23588 23484]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0340532
{'0': {'precision': 0.3482295482295482, 'recall': 0.6798569725864124, 'f1-score': 0.46055712555510697, 'support': 25170}, '1': {'precision': 0.6376588909065511, 'recall': 0.44471505114466636, 'f1-score': 0.523989898989899, 'support': 51325}, '2': {'precision': 0.4415944540727903, 'recall': 0.2968543689320388, 'f1-score': 0.35503947979563394, 'support': 25750}, 'accuracy': 0.46536260941855345, 'macro avg': {'precision': 0.4758276310696299, 'recall': 0.47380879755437255, 'f1-score': 0.44652883478021327, 'support': 102245}, 'weighted avg': {'precision': 0.5170310283836942, 'recall': 0.46536260941855345, 'f1-score': 0.46582494029650523, 'support': 102245}}
[[17112  5508  2550]
 [21384 22825  7116]
 [10644  7462  7644]]
training model: results/WBA/W7/deepLOB_L1/h20
Epoch 1/50
1230/1230 - 21s - loss: 3.1827 - accuracy20: 0.4253 - val_loss: 3.4166 - val_accuracy20: 0.3736 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.1271 - accuracy20: 0.4446 - val_loss: 3.3531 - val_accuracy20: 0.3813 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.0860 - accuracy20: 0.4603 - val_loss: 3.2739 - val_accuracy20: 0.4208 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.0559 - accuracy20: 0.4725 - val_loss: 3.2518 - val_accuracy20: 0.4311 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 3.0386 - accuracy20: 0.4775 - val_loss: 3.2493 - val_accuracy20: 0.4448 - 19s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.0257 - accuracy20: 0.4818 - val_loss: 3.3162 - val_accuracy20: 0.4375 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.0134 - accuracy20: 0.4858 - val_loss: 3.3317 - val_accuracy20: 0.4329 - 18s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.0049 - accuracy20: 0.4876 - val_loss: 3.3716 - val_accuracy20: 0.4236 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 2.9953 - accuracy20: 0.4903 - val_loss: 3.4100 - val_accuracy20: 0.4278 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 2.9877 - accuracy20: 0.4927 - val_loss: 3.4258 - val_accuracy20: 0.4218 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 2.9796 - accuracy20: 0.4944 - val_loss: 3.3911 - val_accuracy20: 0.4275 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 19s - loss: 2.9720 - accuracy20: 0.4963 - val_loss: 3.4308 - val_accuracy20: 0.4148 - 19s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 19s - loss: 2.9656 - accuracy20: 0.4985 - val_loss: 3.4696 - val_accuracy20: 0.4140 - 19s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 2.9605 - accuracy20: 0.4993 - val_loss: 3.4459 - val_accuracy20: 0.4155 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 19s - loss: 2.9530 - accuracy20: 0.5014 - val_loss: 3.4563 - val_accuracy20: 0.4116 - 19s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h20
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0205507
{'0': {'precision': 0.38638699989011926, 'recall': 0.550683835044371, 'f1-score': 0.45413231738378645, 'support': 287350}, '1': {'precision': 0.5549202815140658, 'recall': 0.6096242821465747, 'f1-score': 0.5809874328951301, 'support': 505326}, '2': {'precision': 0.4733300145657024, 'recall': 0.1830615315501615, 'f1-score': 0.26401472690436767, 'support': 280474}, 'accuracy': 0.48235754554349347, 'macro avg': {'precision': 0.4715457653232958, 'recall': 0.4477898829137024, 'f1-score': 0.4330448257277615, 'support': 1073150}, 'weighted avg': {'precision': 0.48846919172539105, 'recall': 0.48235754554349347, 'f1-score': 0.46417764844539083, 'support': 1073150}}
[[158239 112291  16820]
 [156957 308059  40310]
 [ 94339 134791  51344]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0560513
{'0': {'precision': 0.4173153353145476, 'recall': 0.6009321894076886, 'f1-score': 0.4925682843027457, 'support': 96976}, '1': {'precision': 0.47643583451471994, 'recall': 0.5423387261929142, 'f1-score': 0.5072557041940575, 'support': 122075}, '2': {'precision': 0.504288353878823, 'recall': 0.1908449528262503, 'f1-score': 0.27689908159634147, 'support': 95816}, 'accuracy': 0.45342319137921727, 'macro avg': {'precision': 0.4660131745693635, 'recall': 0.44470528947561766, 'f1-score': 0.4255743566977149, 'support': 314867}, 'weighted avg': {'precision': 0.4667029868836725, 'recall': 0.45342319137921727, 'f1-score': 0.4326331575880219, 'support': 314867}}
[[58276 31648  7052]
 [44946 66206 10923]
 [36423 41107 18286]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684325
{'0': {'precision': 0.4039595976743199, 'recall': 0.6091645067357845, 'f1-score': 0.4857802671702157, 'support': 31251}, '1': {'precision': 0.46935840707964605, 'recall': 0.5404820136553551, 'f1-score': 0.5024155733434377, 'support': 39252}, '2': {'precision': 0.5106361528379877, 'recall': 0.1595677651061685, 'f1-score': 0.24315306881735918, 'support': 31742}, 'accuracy': 0.44321971734559146, 'macro avg': {'precision': 0.4613180525306512, 'recall': 0.43640476183243604, 'f1-score': 0.4104496364436709, 'support': 102245}, 'weighted avg': {'precision': 0.4621840710547591, 'recall': 0.44321971734559146, 'f1-score': 0.4168428766650071, 'support': 102245}}
[[19037 10276  1938]
 [15121 21215  2916]
 [12968 13709  5065]]
training model: results/WBA/W7/deepLOB_L1/h30
Epoch 1/50
1230/1230 - 21s - loss: 3.2123 - accuracy30: 0.4219 - val_loss: 3.3603 - val_accuracy30: 0.3452 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.1675 - accuracy30: 0.4419 - val_loss: 3.3339 - val_accuracy30: 0.3898 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.1297 - accuracy30: 0.4557 - val_loss: 3.3795 - val_accuracy30: 0.3888 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.1040 - accuracy30: 0.4641 - val_loss: 3.2948 - val_accuracy30: 0.4068 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.0892 - accuracy30: 0.4678 - val_loss: 3.2973 - val_accuracy30: 0.4194 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.0788 - accuracy30: 0.4714 - val_loss: 3.2671 - val_accuracy30: 0.4235 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.0697 - accuracy30: 0.4746 - val_loss: 3.2654 - val_accuracy30: 0.4270 - 18s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 19s - loss: 3.0619 - accuracy30: 0.4768 - val_loss: 3.2495 - val_accuracy30: 0.4308 - 19s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.0548 - accuracy30: 0.4786 - val_loss: 3.2473 - val_accuracy30: 0.4303 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.0487 - accuracy30: 0.4802 - val_loss: 3.2620 - val_accuracy30: 0.4230 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.0415 - accuracy30: 0.4825 - val_loss: 3.2852 - val_accuracy30: 0.4194 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.0359 - accuracy30: 0.4838 - val_loss: 3.2823 - val_accuracy30: 0.4192 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.0315 - accuracy30: 0.4847 - val_loss: 3.2753 - val_accuracy30: 0.4186 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 3.0265 - accuracy30: 0.4866 - val_loss: 3.2628 - val_accuracy30: 0.4270 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.0219 - accuracy30: 0.4875 - val_loss: 3.2695 - val_accuracy30: 0.4247 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 18s - loss: 3.0168 - accuracy30: 0.4890 - val_loss: 3.2413 - val_accuracy30: 0.4345 - 18s/epoch - 15ms/step
Epoch 17/50
1230/1230 - 18s - loss: 3.0111 - accuracy30: 0.4901 - val_loss: 3.2714 - val_accuracy30: 0.4241 - 18s/epoch - 15ms/step
Epoch 18/50
1230/1230 - 18s - loss: 3.0082 - accuracy30: 0.4911 - val_loss: 3.2428 - val_accuracy30: 0.4320 - 18s/epoch - 15ms/step
Epoch 19/50
1230/1230 - 18s - loss: 3.0042 - accuracy30: 0.4918 - val_loss: 3.2437 - val_accuracy30: 0.4262 - 18s/epoch - 15ms/step
Epoch 20/50
1230/1230 - 18s - loss: 2.9998 - accuracy30: 0.4928 - val_loss: 3.2076 - val_accuracy30: 0.4339 - 18s/epoch - 15ms/step
Epoch 21/50
1230/1230 - 19s - loss: 2.9948 - accuracy30: 0.4934 - val_loss: 3.2021 - val_accuracy30: 0.4352 - 19s/epoch - 15ms/step
Epoch 22/50
1230/1230 - 18s - loss: 2.9918 - accuracy30: 0.4952 - val_loss: 3.1978 - val_accuracy30: 0.4373 - 18s/epoch - 15ms/step
Epoch 23/50
1230/1230 - 18s - loss: 2.9883 - accuracy30: 0.4961 - val_loss: 3.2125 - val_accuracy30: 0.4307 - 18s/epoch - 15ms/step
Epoch 24/50
1230/1230 - 18s - loss: 2.9843 - accuracy30: 0.4974 - val_loss: 3.1961 - val_accuracy30: 0.4341 - 18s/epoch - 15ms/step
Epoch 25/50
1230/1230 - 18s - loss: 2.9801 - accuracy30: 0.4980 - val_loss: 3.2319 - val_accuracy30: 0.4252 - 18s/epoch - 15ms/step
Epoch 26/50
1230/1230 - 18s - loss: 2.9785 - accuracy30: 0.4982 - val_loss: 3.2489 - val_accuracy30: 0.4171 - 18s/epoch - 15ms/step
Epoch 27/50
1230/1230 - 19s - loss: 2.9752 - accuracy30: 0.4996 - val_loss: 3.2236 - val_accuracy30: 0.4287 - 19s/epoch - 15ms/step
Epoch 28/50
1230/1230 - 18s - loss: 2.9720 - accuracy30: 0.5007 - val_loss: 3.2398 - val_accuracy30: 0.4298 - 18s/epoch - 15ms/step
Epoch 29/50
1230/1230 - 19s - loss: 2.9679 - accuracy30: 0.5015 - val_loss: 3.2491 - val_accuracy30: 0.4237 - 19s/epoch - 15ms/step
Epoch 30/50
1230/1230 - 19s - loss: 2.9654 - accuracy30: 0.5011 - val_loss: 3.2476 - val_accuracy30: 0.4197 - 19s/epoch - 15ms/step
Epoch 31/50
1230/1230 - 19s - loss: 2.9627 - accuracy30: 0.5025 - val_loss: 3.2503 - val_accuracy30: 0.4201 - 19s/epoch - 15ms/step
Epoch 32/50
1230/1230 - 19s - loss: 2.9603 - accuracy30: 0.5026 - val_loss: 3.2727 - val_accuracy30: 0.4215 - 19s/epoch - 15ms/step
Epoch 33/50
1230/1230 - 18s - loss: 2.9571 - accuracy30: 0.5036 - val_loss: 3.2758 - val_accuracy30: 0.4180 - 18s/epoch - 15ms/step
Epoch 34/50
1230/1230 - 18s - loss: 2.9553 - accuracy30: 0.5044 - val_loss: 3.3060 - val_accuracy30: 0.4060 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h30
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669298
{'0': {'precision': 0.3740938949258116, 'recall': 0.6886263710472376, 'f1-score': 0.48481416896254304, 'support': 319555}, '1': {'precision': 0.4973848602806426, 'recall': 0.3383787251759214, 'f1-score': 0.40275613312735, 'support': 439543}, '2': {'precision': 0.44179891333584376, 'recall': 0.2615044642288538, 'f1-score': 0.3285421108848627, 'support': 314052}, 'accuracy': 0.4201761170386246, 'macro avg': {'precision': 0.4377592228474327, 'recall': 0.42950318681733757, 'f1-score': 0.4053708043249186, 'support': 1073150}, 'weighted avg': {'precision': 0.4444052001736017, 'recall': 0.4201761170386246, 'f1-score': 0.4054724295705476, 'support': 1073150}}
[[220054  59706  39795]
 [226842 148732  63969]
 [141336  90590  82126]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0659591
{'0': {'precision': 0.4346590909090909, 'recall': 0.5694002148146753, 'f1-score': 0.49298876734454156, 'support': 106138}, '1': {'precision': 0.414290128686915, 'recall': 0.40062462045631997, 'f1-score': 0.4073427944174377, 'support': 103743}, '2': {'precision': 0.466678144783196, 'recall': 0.3356352275541501, 'f1-score': 0.39045497861401063, 'support': 104986}, 'accuracy': 0.4358475165704885, 'macro avg': {'precision': 0.43854245479306736, 'recall': 0.43522002094171514, 'f1-score': 0.43026218012532996, 'support': 314867}, 'weighted avg': {'precision': 0.4386239876502915, 'recall': 0.4358475165704885, 'f1-score': 0.4305821559402342, 'support': 314867}}
[[60435 26144 19559]
 [41471 41562 20710]
 [37134 32615 35237]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0644335
{'0': {'precision': 0.42614102774585455, 'recall': 0.6104839183865467, 'f1-score': 0.5019216359285489, 'support': 34014}, '1': {'precision': 0.4328492020799713, 'recall': 0.35578481945467944, 'f1-score': 0.39055169066494094, 'support': 33925}, '2': {'precision': 0.4537297128589263, 'recall': 0.33900775374570047, 'f1-score': 0.3880676699255898, 'support': 34306}, 'accuracy': 0.4348867915301482, 'macro avg': {'precision': 0.43757331422825074, 'recall': 0.43509216386230887, 'f1-score': 0.42684699883969324, 'support': 102245}, 'weighted avg': {'precision': 0.43762356719300555, 'recall': 0.4348867915301482, 'f1-score': 0.42676784307055665, 'support': 102245}}
[[20765  6775  6474]
 [14327 12070  7528]
 [13636  9040 11630]]
training model: results/WBA/W7/deepLOB_L1/h50
Epoch 1/50
1230/1230 - 22s - loss: 3.2512 - accuracy50: 0.3990 - val_loss: 3.3407 - val_accuracy50: 0.3501 - 22s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2157 - accuracy50: 0.4152 - val_loss: 3.3825 - val_accuracy50: 0.3761 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.1890 - accuracy50: 0.4270 - val_loss: 3.4177 - val_accuracy50: 0.3723 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 19s - loss: 3.1735 - accuracy50: 0.4347 - val_loss: 3.4145 - val_accuracy50: 0.3805 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 3.1634 - accuracy50: 0.4382 - val_loss: 3.4173 - val_accuracy50: 0.3816 - 19s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.1558 - accuracy50: 0.4412 - val_loss: 3.4049 - val_accuracy50: 0.3709 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.1506 - accuracy50: 0.4436 - val_loss: 3.4184 - val_accuracy50: 0.3712 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.1464 - accuracy50: 0.4450 - val_loss: 3.3987 - val_accuracy50: 0.3735 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 19s - loss: 3.1422 - accuracy50: 0.4465 - val_loss: 3.3799 - val_accuracy50: 0.3749 - 19s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.1381 - accuracy50: 0.4489 - val_loss: 3.4255 - val_accuracy50: 0.3734 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 19s - loss: 3.1355 - accuracy50: 0.4493 - val_loss: 3.4114 - val_accuracy50: 0.3666 - 19s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h50
Evaluating performance on  test set...
4192/4192 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1208575
{'0': {'precision': 0.3063879418625516, 'recall': 0.7687385712215263, 'f1-score': 0.43814793105842176, 'support': 324291}, '1': {'precision': 0.4058322929956695, 'recall': 0.20974477629224875, 'f1-score': 0.2765574214939903, 'support': 423119}, '2': {'precision': 0.30147257001445615, 'recall': 0.03777245656044698, 'f1-score': 0.06713353866971489, 'support': 325740}, 'accuracy': 0.32646507943903463, 'macro avg': {'precision': 0.3378976016242257, 'recall': 0.33875193469140735, 'f1-score': 0.260612963740709, 'support': 1073150}, 'weighted avg': {'precision': 0.3441046274901853, 'recall': 0.32646507943903463, 'f1-score': 0.26182007102665544, 'support': 1073150}}
[[249295  63131  11865]
 [317728  88747  16644]
 [246635  66801  12304]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1102166
{'0': {'precision': 0.3581869752567348, 'recall': 0.7746087382574366, 'f1-score': 0.48985842310992467, 'support': 106131}, '1': {'precision': 0.3348937855344667, 'recall': 0.22794131803392312, 'f1-score': 0.2712557564093752, 'support': 103882}, '2': {'precision': 0.39360830374214695, 'recall': 0.054971674900337615, 'f1-score': 0.09647023381144454, 'support': 104854}, 'accuracy': 0.35460368981188883, 'macro avg': {'precision': 0.36222968817778284, 'recall': 0.3525072437305658, 'f1-score': 0.2858614711102481, 'support': 314867}, 'weighted avg': {'precision': 0.3622976786403245, 'recall': 0.35460368981188883, 'f1-score': 0.2867339057013385, 'support': 314867}}
[[82210 19682  4239]
 [75562 23679  4641]
 [71745 27345  5764]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1126738
{'0': {'precision': 0.35229985342360576, 'recall': 0.7370619158878504, 'f1-score': 0.47673199527744986, 'support': 34240}, '1': {'precision': 0.34211136890951277, 'recall': 0.2611660516605166, 'f1-score': 0.2962082531179376, 'support': 33875}, '2': {'precision': 0.3391578947368421, 'recall': 0.047201875183123354, 'f1-score': 0.08287037037037037, 'support': 34130}, 'accuracy': 0.34911242603550297, 'macro avg': {'precision': 0.3445230390233202, 'recall': 0.3484766142438301, 'f1-score': 0.2852702062552526, 'support': 102245}, 'weighted avg': {'precision': 0.344537420415692, 'recall': 0.34911242603550297, 'f1-score': 0.2854489102979193, 'support': 102245}}
[[25237  7519  1484]
 [23373  8847  1655]
 [23025  9494  1611]]
training model: results/WBA/W7/deepLOB_L1/h100
Epoch 1/50
1230/1230 - 21s - loss: 3.2723 - accuracy100: 0.3853 - val_loss: 3.5000 - val_accuracy100: 0.3559 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2432 - accuracy100: 0.3972 - val_loss: 3.4569 - val_accuracy100: 0.3610 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.2374 - accuracy100: 0.3985 - val_loss: 3.4955 - val_accuracy100: 0.3596 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2291 - accuracy100: 0.4045 - val_loss: 3.4999 - val_accuracy100: 0.3561 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.2218 - accuracy100: 0.4089 - val_loss: 3.4913 - val_accuracy100: 0.3594 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.2175 - accuracy100: 0.4121 - val_loss: 3.4171 - val_accuracy100: 0.3404 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.2136 - accuracy100: 0.4136 - val_loss: 3.4007 - val_accuracy100: 0.3453 - 18s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.2131 - accuracy100: 0.4138 - val_loss: 3.4258 - val_accuracy100: 0.3620 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.2079 - accuracy100: 0.4170 - val_loss: 3.3946 - val_accuracy100: 0.3663 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 19s - loss: 3.2047 - accuracy100: 0.4186 - val_loss: 3.4113 - val_accuracy100: 0.3597 - 19s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.2006 - accuracy100: 0.4211 - val_loss: 3.3844 - val_accuracy100: 0.3606 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.1989 - accuracy100: 0.4225 - val_loss: 3.4109 - val_accuracy100: 0.3468 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 19s - loss: 3.1952 - accuracy100: 0.4228 - val_loss: 3.3845 - val_accuracy100: 0.3386 - 19s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 3.1930 - accuracy100: 0.4249 - val_loss: 3.3530 - val_accuracy100: 0.3411 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.1910 - accuracy100: 0.4248 - val_loss: 3.4048 - val_accuracy100: 0.3395 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 19s - loss: 3.1897 - accuracy100: 0.4252 - val_loss: 3.4014 - val_accuracy100: 0.3390 - 19s/epoch - 15ms/step
Epoch 17/50
1230/1230 - 19s - loss: 3.1868 - accuracy100: 0.4271 - val_loss: 3.3603 - val_accuracy100: 0.3404 - 19s/epoch - 15ms/step
Epoch 18/50
1230/1230 - 19s - loss: 3.1839 - accuracy100: 0.4282 - val_loss: 3.3709 - val_accuracy100: 0.3550 - 19s/epoch - 15ms/step
Epoch 19/50
1230/1230 - 18s - loss: 3.1819 - accuracy100: 0.4286 - val_loss: 3.3459 - val_accuracy100: 0.3473 - 18s/epoch - 15ms/step
Epoch 20/50
1230/1230 - 18s - loss: 3.1808 - accuracy100: 0.4298 - val_loss: 3.3860 - val_accuracy100: 0.3507 - 18s/epoch - 15ms/step
Epoch 21/50
1230/1230 - 18s - loss: 3.1789 - accuracy100: 0.4299 - val_loss: 3.3566 - val_accuracy100: 0.3514 - 18s/epoch - 15ms/step
Epoch 22/50
1230/1230 - 18s - loss: 3.1770 - accuracy100: 0.4310 - val_loss: 3.4112 - val_accuracy100: 0.3518 - 18s/epoch - 15ms/step
Epoch 23/50
1230/1230 - 18s - loss: 3.1747 - accuracy100: 0.4326 - val_loss: 3.3821 - val_accuracy100: 0.3538 - 18s/epoch - 15ms/step
Epoch 24/50
1230/1230 - 18s - loss: 3.1733 - accuracy100: 0.4329 - val_loss: 3.3947 - val_accuracy100: 0.3589 - 18s/epoch - 15ms/step
Epoch 25/50
1230/1230 - 19s - loss: 3.1725 - accuracy100: 0.4334 - val_loss: 3.3998 - val_accuracy100: 0.3565 - 19s/epoch - 15ms/step
Epoch 26/50
1230/1230 - 19s - loss: 3.1692 - accuracy100: 0.4350 - val_loss: 3.4028 - val_accuracy100: 0.3518 - 19s/epoch - 15ms/step
Epoch 27/50
1230/1230 - 19s - loss: 3.1687 - accuracy100: 0.4352 - val_loss: 3.3985 - val_accuracy100: 0.3509 - 19s/epoch - 15ms/step
Epoch 28/50
1230/1230 - 18s - loss: 3.1684 - accuracy100: 0.4348 - val_loss: 3.3728 - val_accuracy100: 0.3543 - 18s/epoch - 15ms/step
Epoch 29/50
1230/1230 - 18s - loss: 3.1669 - accuracy100: 0.4361 - val_loss: 3.3686 - val_accuracy100: 0.3568 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h100
Evaluating performance on  test set...
4192/4192 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0996436
{'0': {'precision': 0.3157838223317139, 'recall': 0.4938423762376238, 'f1-score': 0.3852331692656747, 'support': 315625}, '1': {'precision': 0.4005343754046069, 'recall': 0.4740680543784901, 'f1-score': 0.43420998065796934, 'support': 430685}, '2': {'precision': 0.3596888341308272, 'recall': 0.0768174030106474, 'f1-score': 0.1265977884339026, 'support': 326840}, 'accuracy': 0.3588967059590924, 'macro avg': {'precision': 0.3586690106223827, 'recall': 0.34824261120892047, 'f1-score': 0.31534697945251555, 'support': 1073150}, 'weighted avg': {'precision': 0.36316835012989784, 'recall': 0.3588967059590924, 'f1-score': 0.32611859082224554, 'support': 1073150}}
[[155869 141882  17874]
 [199690 204174  26821]
 [138035 163698  25107]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050088
{'0': {'precision': 0.3556602528700803, 'recall': 0.6821010797840432, 'f1-score': 0.4675376406605868, 'support': 106688}, '1': {'precision': 0.35647274380415767, 'recall': 0.25131357866418036, 'f1-score': 0.29479584396646014, 'support': 102963}, '2': {'precision': 0.39243900496455786, 'recall': 0.1404919403892944, 'f1-score': 0.20691054919059654, 'support': 105216}, 'accuracy': 0.36024734252875024, 'macro avg': {'precision': 0.368190667212932, 'recall': 0.3579688662791727, 'f1-score': 0.3230813446058811, 'support': 314867}, 'weighted avg': {'precision': 0.36821593410824743, 'recall': 0.36024734252875024, 'f1-score': 0.32395907044165667, 'support': 314867}}
[[72772 22714 11202]
 [65404 25876 11683]
 [66435 23999 14782]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115708
{'0': {'precision': 0.37412060717419016, 'recall': 0.6217093499848706, 'f1-score': 0.46713653838204294, 'support': 36353}, '1': {'precision': 0.29636321249562886, 'recall': 0.3444305212178684, 'f1-score': 0.3185940510314365, 'support': 29527}, '2': {'precision': 0.38520883213620644, 'recall': 0.07963701361198955, 'f1-score': 0.131987329945537, 'support': 36365}, 'accuracy': 0.3488385740133992, 'macro avg': {'precision': 0.3518975506020085, 'recall': 0.3485922949382428, 'f1-score': 0.3059059731196721, 'support': 102245}, 'weighted avg': {'precision': 0.35560899983955124, 'recall': 0.3488385740133992, 'f1-score': 0.3050384896872912, 'support': 102245}}
[[22601 11703  2049]
 [16784 10170  2573]
 [21026 12443  2896]]
training model: results/WBA/W7/deepLOB_L1/h200
Epoch 1/50
1230/1230 - 21s - loss: 3.3114 - accuracy200: 0.3612 - val_loss: 3.3524 - val_accuracy200: 0.3440 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 18s - loss: 3.2848 - accuracy200: 0.3690 - val_loss: 3.4521 - val_accuracy200: 0.3318 - 18s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.2751 - accuracy200: 0.3777 - val_loss: 3.3803 - val_accuracy200: 0.3410 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2649 - accuracy200: 0.3840 - val_loss: 3.4084 - val_accuracy200: 0.3325 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 3.2583 - accuracy200: 0.3883 - val_loss: 3.4207 - val_accuracy200: 0.3322 - 19s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.2534 - accuracy200: 0.3915 - val_loss: 3.4521 - val_accuracy200: 0.3345 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.2499 - accuracy200: 0.3945 - val_loss: 3.4669 - val_accuracy200: 0.3324 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.2475 - accuracy200: 0.3954 - val_loss: 3.4757 - val_accuracy200: 0.3360 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.2446 - accuracy200: 0.3981 - val_loss: 3.4694 - val_accuracy200: 0.3355 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.2418 - accuracy200: 0.3999 - val_loss: 3.4692 - val_accuracy200: 0.3342 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.2390 - accuracy200: 0.4024 - val_loss: 3.4408 - val_accuracy200: 0.3367 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h200
Evaluating performance on  test set...
4192/4192 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1169773
{'0': {'precision': 0.3232743338696921, 'recall': 0.6300454455524485, 'f1-score': 0.4273015752218238, 'support': 338647}, '1': {'precision': 0.3520429364614468, 'recall': 0.3686387585519935, 'f1-score': 0.3601497636254681, 'support': 381490}, '2': {'precision': 0.3544257498171178, 'recall': 0.013724707022120999, 'f1-score': 0.026426095564833933, 'support': 353013}, 'accuracy': 0.3343800959791269, 'macro avg': {'precision': 0.34324767338275225, 'recall': 0.33746963704218763, 'f1-score': 0.2712924781373753, 'support': 1073150}, 'weighted avg': {'precision': 0.3437484418700435, 'recall': 0.3343800959791269, 'f1-score': 0.27156192996622425, 'support': 1073150}}
[[213363 121068   4216]
 [236249 140632   4609]
 [210394 137774   4845]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145927
{'0': {'precision': 0.3530137951516069, 'recall': 0.561003146400148, 'f1-score': 0.4333439366375135, 'support': 108060}, '1': {'precision': 0.3340467830021251, 'recall': 0.43380549180976496, 'f1-score': 0.37744585447300355, 'support': 101096}, '2': {'precision': 0.32827132371551504, 'recall': 0.03680790078610551, 'f1-score': 0.06619373277533938, 'support': 105711}, 'accuracy': 0.34417388929293957, 'macro avg': {'precision': 0.338443967289749, 'recall': 0.3438721796653395, 'f1-score': 0.2923278412952855, 'support': 314867}, 'weighted avg': {'precision': 0.338617111922673, 'recall': 0.34417388929293957, 'f1-score': 0.29213228945004205, 'support': 314867}}
[[60622 43523  3915]
 [53193 43856  4047]
 [57912 43908  3891]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161394
{'0': {'precision': 0.3439491351843423, 'recall': 0.7073777205710274, 'f1-score': 0.46284740831483046, 'support': 34184}, '1': {'precision': 0.34471985718209286, 'recall': 0.2974846680295085, 'f1-score': 0.3193651500453238, 'support': 33753}, '2': {'precision': 0.354070387486669, 'recall': 0.029031129765652326, 'f1-score': 0.053662347458312006, 'support': 34308}, 'accuracy': 0.344447161230378, 'macro avg': {'precision': 0.34757979328436805, 'recall': 0.3446311727887294, 'f1-score': 0.27862496860615543, 'support': 102245}, 'weighted avg': {'precision': 0.34759972057803684, 'recall': 0.344447161230378, 'f1-score': 0.27818040522190574, 'support': 102245}}
[[24181  9132   871]
 [22766 10041   946]
 [23357  9955   996]]
training model: results/WBA/W7/deepLOB_L1/h300
Epoch 1/50
1230/1230 - 21s - loss: 3.2743 - accuracy300: 0.3927 - val_loss: 3.4205 - val_accuracy300: 0.3274 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2527 - accuracy300: 0.4007 - val_loss: 3.5652 - val_accuracy300: 0.3247 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.2400 - accuracy300: 0.4066 - val_loss: 3.4857 - val_accuracy300: 0.3227 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2360 - accuracy300: 0.4082 - val_loss: 3.4121 - val_accuracy300: 0.3246 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.2238 - accuracy300: 0.4172 - val_loss: 3.4077 - val_accuracy300: 0.3231 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.2151 - accuracy300: 0.4199 - val_loss: 3.4667 - val_accuracy300: 0.3265 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.2083 - accuracy300: 0.4238 - val_loss: 3.4117 - val_accuracy300: 0.3255 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 19s - loss: 3.2014 - accuracy300: 0.4270 - val_loss: 3.4148 - val_accuracy300: 0.3238 - 19s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.1973 - accuracy300: 0.4283 - val_loss: 3.4292 - val_accuracy300: 0.3293 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.1922 - accuracy300: 0.4314 - val_loss: 3.4177 - val_accuracy300: 0.3292 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.1868 - accuracy300: 0.4337 - val_loss: 3.4925 - val_accuracy300: 0.3271 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.1871 - accuracy300: 0.4339 - val_loss: 3.5012 - val_accuracy300: 0.3295 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.1799 - accuracy300: 0.4376 - val_loss: 3.5432 - val_accuracy300: 0.3284 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 3.1765 - accuracy300: 0.4383 - val_loss: 3.6144 - val_accuracy300: 0.3284 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.1721 - accuracy300: 0.4400 - val_loss: 3.4677 - val_accuracy300: 0.3286 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h300
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.165682
{'0': {'precision': 0.2664730020435441, 'recall': 0.7930377476131262, 'f1-score': 0.39890704159216606, 'support': 287091}, '1': {'precision': 0.4367816091954023, 'recall': 0.1118483881547058, 'f1-score': 0.17809204454764305, 'support': 484817}, '2': {'precision': 0.28222149403295876, 'recall': 0.08862973954495057, 'f1-score': 0.13489623463729492, 'support': 301242}, 'accuracy': 0.2875637142990262, 'macro avg': {'precision': 0.32849203509063507, 'recall': 0.33117195843759417, 'f1-score': 0.23729844025903468, 'support': 1073150}, 'weighted avg': {'precision': 0.34783405615286495, 'recall': 0.2875637142990262, 'f1-score': 0.22503944812356072, 'support': 1073150}}
[[227674  33703  25714]
 [388401  54226  42190]
 [238323  36220  26699]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1180128
{'0': {'precision': 0.34821552292744035, 'recall': 0.5808754183848956, 'f1-score': 0.43541450804134857, 'support': 108154}, '1': {'precision': 0.33422521878561906, 'recall': 0.3394251520502256, 'f1-score': 0.3368051161749389, 'support': 101940}, '2': {'precision': 0.3345944897167249, 'recall': 0.09875635898561652, 'f1-score': 0.15250152914213286, 'support': 104773}, 'accuracy': 0.3422778506480514, 'macro avg': {'precision': 0.33901174380992805, 'recall': 0.3396856431402459, 'f1-score': 0.3082403844528068, 'support': 314867}, 'weighted avg': {'precision': 0.3391536392851293, 'recall': 0.3422778506480514, 'f1-score': 0.3093489535530429, 'support': 314867}}
[[62824 34845 10485]
 [57247 34601 10092]
 [60346 34080 10347]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1341548
{'0': {'precision': 0.32046979865771813, 'recall': 0.5671735804913165, 'f1-score': 0.4095383515805205, 'support': 33339}, '1': {'precision': 0.32252038547071904, 'recall': 0.3101865054468716, 'f1-score': 0.3162332281839194, 'support': 35066}, '2': {'precision': 0.33081126523749477, 'recall': 0.09302600472813238, 'f1-score': 0.145216348371621, 'support': 33840}, 'accuracy': 0.32210866057019905, 'macro avg': {'precision': 0.3246004831219773, 'recall': 0.3234620302221068, 'f1-score': 0.290329309378687, 'support': 102245}, 'weighted avg': {'precision': 0.3245957814074304, 'recall': 0.32210866057019905, 'f1-score': 0.29005579453015745, 'support': 102245}}
[[18909 11309  3121]
 [20942 10877  3247]
 [19153 11539  3148]]
training model: results/WBA/W7/deepLOB_L1/h500
Epoch 1/50
1230/1230 - 21s - loss: 3.2950 - accuracy500: 0.3798 - val_loss: 3.3887 - val_accuracy500: 0.3301 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2613 - accuracy500: 0.3922 - val_loss: 3.3475 - val_accuracy500: 0.3346 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.2331 - accuracy500: 0.4103 - val_loss: 3.3300 - val_accuracy500: 0.3391 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2104 - accuracy500: 0.4230 - val_loss: 3.3987 - val_accuracy500: 0.3232 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.1978 - accuracy500: 0.4294 - val_loss: 3.4560 - val_accuracy500: 0.3208 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.1864 - accuracy500: 0.4339 - val_loss: 3.5115 - val_accuracy500: 0.3197 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.1775 - accuracy500: 0.4386 - val_loss: 3.5321 - val_accuracy500: 0.3196 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.1710 - accuracy500: 0.4412 - val_loss: 3.5100 - val_accuracy500: 0.3210 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 19s - loss: 3.1657 - accuracy500: 0.4428 - val_loss: 3.5492 - val_accuracy500: 0.3208 - 19s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 19s - loss: 3.1590 - accuracy500: 0.4454 - val_loss: 3.5860 - val_accuracy500: 0.3206 - 19s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.1525 - accuracy500: 0.4487 - val_loss: 3.5515 - val_accuracy500: 0.3242 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 19s - loss: 3.1510 - accuracy500: 0.4485 - val_loss: 3.5965 - val_accuracy500: 0.3235 - 19s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.1441 - accuracy500: 0.4510 - val_loss: 3.5265 - val_accuracy500: 0.3213 - 18s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h500
Evaluating performance on  test set...
4192/4192 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099613
{'0': {'precision': 0.28987950984742467, 'recall': 0.2737940950796629, 'f1-score': 0.281607289704751, 'support': 310182}, '1': {'precision': 0.4007869072035495, 'recall': 0.6678585959568952, 'f1-score': 0.5009499976021171, 'support': 430115}, '2': {'precision': 0.3098029944838456, 'recall': 0.05905609983986925, 'f1-score': 0.09920187331410563, 'support': 332853}, 'accuracy': 0.36512975818851046, 'macro avg': {'precision': 0.3334898038449399, 'recall': 0.3335695969588091, 'f1-score': 0.29391972020699125, 'support': 1073150}, 'weighted avg': {'precision': 0.3405103879590738, 'recall': 0.36512975818851046, 'f1-score': 0.31294344843875843, 'support': 1073150}}
[[ 84926 206907  18349]
 [117415 287256  25444]
 [ 90629 222567  19657]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102792
{'0': {'precision': 0.33644110893652435, 'recall': 0.20694819659699512, 'f1-score': 0.25626518610683974, 'support': 105495}, '1': {'precision': 0.3392791528877309, 'recall': 0.761358631998126, 'f1-score': 0.46938804982944415, 'support': 106725}, '2': {'precision': 0.35658396946564885, 'recall': 0.03640632458815163, 'f1-score': 0.06606734024591832, 'support': 102647}, 'accuracy': 0.33927023155808644, 'macro avg': {'precision': 0.344101410429968, 'recall': 0.3349043843944243, 'f1-score': 0.2639068587274008, 'support': 314867}, 'weighted avg': {'precision': 0.34396966685280506, 'recall': 0.33927023155808644, 'f1-score': 0.2664990287982268, 'support': 314867}}
[[21832 80395  3268]
 [21994 81256  3475]
 [21065 77845  3737]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081048
{'0': {'precision': 0.32052056891897335, 'recall': 0.2444758597375457, 'f1-score': 0.2773806618082918, 'support': 32539}, '1': {'precision': 0.34738633269806696, 'recall': 0.7145377163017305, 'f1-score': 0.4674922600619195, 'support': 35714}, '2': {'precision': 0.31316187594553707, 'recall': 0.03653800894328077, 'f1-score': 0.06544075030296644, 'support': 33992}, 'accuracy': 0.3395373856912318, 'macro avg': {'precision': 0.3270229258541924, 'recall': 0.331850528327519, 'f1-score': 0.27010455739105926, 'support': 102245}, 'weighted avg': {'precision': 0.32745828906229096, 'recall': 0.3395373856912318, 'f1-score': 0.2733255407572971, 'support': 102245}}
[[ 7955 23281  1303]
 [ 8774 25519  1421]
 [ 8090 24660  1242]]
training model: results/WBA/W7/deepLOB_L1/h1000
Epoch 1/50
1230/1230 - 21s - loss: 3.2938 - accuracy1000: 0.3835 - val_loss: 3.7347 - val_accuracy1000: 0.3261 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2312 - accuracy1000: 0.4102 - val_loss: 3.6645 - val_accuracy1000: 0.3263 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.1964 - accuracy1000: 0.4259 - val_loss: 3.6477 - val_accuracy1000: 0.3291 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 19s - loss: 3.1746 - accuracy1000: 0.4394 - val_loss: 3.7152 - val_accuracy1000: 0.3316 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.1610 - accuracy1000: 0.4449 - val_loss: 3.7057 - val_accuracy1000: 0.3292 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.1451 - accuracy1000: 0.4513 - val_loss: 3.6123 - val_accuracy1000: 0.3248 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.1331 - accuracy1000: 0.4553 - val_loss: 3.8107 - val_accuracy1000: 0.3313 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.1239 - accuracy1000: 0.4583 - val_loss: 3.7879 - val_accuracy1000: 0.3297 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.1115 - accuracy1000: 0.4639 - val_loss: 4.3449 - val_accuracy1000: 0.3247 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 19s - loss: 3.1025 - accuracy1000: 0.4665 - val_loss: 4.4432 - val_accuracy1000: 0.3239 - 19s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.0976 - accuracy1000: 0.4677 - val_loss: 4.3456 - val_accuracy1000: 0.3251 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.0908 - accuracy1000: 0.4694 - val_loss: 4.2858 - val_accuracy1000: 0.3250 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.0830 - accuracy1000: 0.4723 - val_loss: 4.4263 - val_accuracy1000: 0.3241 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 19s - loss: 3.0763 - accuracy1000: 0.4735 - val_loss: 4.3875 - val_accuracy1000: 0.3225 - 19s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.0685 - accuracy1000: 0.4752 - val_loss: 4.5077 - val_accuracy1000: 0.3236 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 19s - loss: 3.0658 - accuracy1000: 0.4769 - val_loss: 4.5012 - val_accuracy1000: 0.3236 - 19s/epoch - 15ms/step
testing model: results/WBA/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
4192/4192 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.179398
{'0': {'precision': 0.2924411031300011, 'recall': 0.7527037598786621, 'f1-score': 0.4212268091436638, 'support': 313175}, '1': {'precision': 0.390524313959702, 'recall': 0.23897169319102587, 'f1-score': 0.29650468145659903, 'support': 415907}, '2': {'precision': 0.30192430025445294, 'recall': 0.011035609240033948, 'f1-score': 0.021292941981359566, 'support': 344068}, 'accuracy': 0.31581326002888693, 'macro avg': {'precision': 0.328296572448052, 'recall': 0.3342370207699073, 'f1-score': 0.24634147752720745, 'support': 1073150}, 'weighted avg': {'precision': 0.3334944122058659, 'recall': 0.31581326002888693, 'f1-score': 0.24466505005430653, 'support': 1073150}}
[[235728  73855   3592]
 [311330  99390   5187]
 [259012  81259   3797]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1846855
{'0': {'precision': 0.34664807440955653, 'recall': 0.8391817437614401, 'f1-score': 0.49062813415037476, 'support': 108719}, '1': {'precision': 0.3342724711442334, 'recall': 0.14359474891415744, 'f1-score': 0.20089166843043144, 'support': 102455}, '2': {'precision': 0.38992561659924313, 'recall': 0.028815831348307022, 'f1-score': 0.05366572075146377, 'support': 103693}, 'accuracy': 0.3459714736698352, 'macro avg': {'precision': 0.35694872071767764, 'recall': 0.33719744134130153, 'f1-score': 0.24839517444409, 'support': 314867}, 'weighted avg': {'precision': 0.3568734576657457, 'recall': 0.3459714736698352, 'f1-score': 0.2524485436314888, 'support': 314867}}
[[91235 15149  2335]
 [85403 14712  2340]
 [86554 14151  2988]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1966673
{'0': {'precision': 0.3217773086058396, 'recall': 0.8141066496707032, 'f1-score': 0.4612461418094591, 'support': 32949}, '1': {'precision': 0.34885671157824116, 'recall': 0.18095348567451572, 'f1-score': 0.23829982242080539, 'support': 34484}, '2': {'precision': 0.3142570281124498, 'recall': 0.008991152476157647, 'f1-score': 0.017482126899016976, 'support': 34812}, 'accuracy': 0.32644139077705514, 'macro avg': {'precision': 0.32829701609884354, 'recall': 0.3346837626071255, 'f1-score': 0.23900936370976048, 'support': 102245}, 'weighted avg': {'precision': 0.32834985618825835, 'recall': 0.32644139077705514, 'f1-score': 0.2349622769274537, 'support': 102245}}
[[26824  5787   338]
 [27899  6240   345]
 [28639  5860   313]]
training model: results/WBA/W7/deepOF_L1/h10
Epoch 1/50
1230/1230 - 19s - loss: 3.2413 - accuracy10: 0.3833 - val_loss: 3.2798 - val_accuracy10: 0.4781 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2045 - accuracy10: 0.3912 - val_loss: 3.2414 - val_accuracy10: 0.4563 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 16s - loss: 3.1905 - accuracy10: 0.3962 - val_loss: 3.2306 - val_accuracy10: 0.4424 - 16s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 16s - loss: 3.1808 - accuracy10: 0.3991 - val_loss: 3.2216 - val_accuracy10: 0.4335 - 16s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.1744 - accuracy10: 0.4015 - val_loss: 3.2175 - val_accuracy10: 0.4100 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.1696 - accuracy10: 0.4043 - val_loss: 3.2158 - val_accuracy10: 0.4133 - 17s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.1651 - accuracy10: 0.4059 - val_loss: 3.2157 - val_accuracy10: 0.4202 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.1606 - accuracy10: 0.4084 - val_loss: 3.2125 - val_accuracy10: 0.4112 - 17s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.1571 - accuracy10: 0.4110 - val_loss: 3.2123 - val_accuracy10: 0.4230 - 17s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.1544 - accuracy10: 0.4120 - val_loss: 3.2139 - val_accuracy10: 0.4312 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.1506 - accuracy10: 0.4127 - val_loss: 3.2156 - val_accuracy10: 0.4302 - 16s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.1483 - accuracy10: 0.4149 - val_loss: 3.2150 - val_accuracy10: 0.4257 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 16s - loss: 3.1449 - accuracy10: 0.4164 - val_loss: 3.2147 - val_accuracy10: 0.4369 - 16s/epoch - 13ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.1412 - accuracy10: 0.4185 - val_loss: 3.2184 - val_accuracy10: 0.4474 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.1388 - accuracy10: 0.4187 - val_loss: 3.2202 - val_accuracy10: 0.4459 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.1358 - accuracy10: 0.4204 - val_loss: 3.2206 - val_accuracy10: 0.4486 - 17s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.1330 - accuracy10: 0.4222 - val_loss: 3.2220 - val_accuracy10: 0.4443 - 17s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 16s - loss: 3.1299 - accuracy10: 0.4243 - val_loss: 3.2241 - val_accuracy10: 0.4505 - 16s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.1265 - accuracy10: 0.4251 - val_loss: 3.2311 - val_accuracy10: 0.4513 - 17s/epoch - 14ms/step
testing model: results/WBA/W7/deepOF_L1/h10
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0406597
{'0': {'precision': 0.30775875258178853, 'recall': 0.4299186514032299, 'f1-score': 0.358723819254168, 'support': 224589}, '1': {'precision': 0.6289009450554058, 'recall': 0.42876404708513055, 'f1-score': 0.5098970211198776, 'support': 629668}, '2': {'precision': 0.29675695651910505, 'recall': 0.4475622236029385, 'f1-score': 0.3568823882989381, 'support': 218888}, 'accuracy': 0.43283992377544506, 'macro avg': {'precision': 0.4111388847187665, 'recall': 0.43541497403043294, 'f1-score': 0.4085010762243279, 'support': 1073145}, 'weighted avg': {'precision': 0.49394496312547925, 'recall': 0.43283992377544506, 'f1-score': 0.4470491252784697, 'support': 1073145}}
[[ 96555  80573  47461]
 [174994 269979 184695]
 [ 42187  78735  97966]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0473732
{'0': {'precision': 0.3529009016600657, 'recall': 0.4307294746856599, 'f1-score': 0.38795030048981577, 'support': 77782}, '1': {'precision': 0.5582158766039492, 'recall': 0.41783719223160853, 'f1-score': 0.4779317067617279, 'support': 160754}, '2': {'precision': 0.3409937451683182, 'recall': 0.4449568327416122, 'f1-score': 0.3860993327043096, 'support': 76331}, 'accuracy': 0.4275964137238898, 'macro avg': {'precision': 0.41737017447744434, 'recall': 0.4311744998862936, 'f1-score': 0.41732711331861777, 'support': 314867}, 'weighted avg': {'precision': 0.454837015384138, 'recall': 0.4275964137238898, 'f1-score': 0.4334412054172914, 'support': 314867}}
[[33503 26768 17511]
 [45457 67169 48128]
 [15976 26391 33964]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0535259
{'0': {'precision': 0.34369339307846314, 'recall': 0.43013960147953706, 'f1-score': 0.3820879703232644, 'support': 25143}, '1': {'precision': 0.5495348955421135, 'recall': 0.4209399213487521, 'f1-score': 0.47671752359114555, 'support': 51366}, '2': {'precision': 0.3442669890557394, 'recall': 0.4204616101958346, 'f1-score': 0.37856842989084805, 'support': 25736}, 'accuracy': 0.4230818132916035, 'macro avg': {'precision': 0.4124984258921054, 'recall': 0.4238470443413746, 'f1-score': 0.41245797460175265, 'support': 102245}, 'weighted avg': {'precision': 0.44724874230452843, 'recall': 0.4230818132916035, 'f1-score': 0.42874221004735186, 'support': 102245}}
[[10815  8526  5802]
 [14935 21622 14809]
 [ 5717  9198 10821]]
training model: results/WBA/W7/deepOF_L1/h20
Epoch 1/50
1230/1230 - 18s - loss: 3.2699 - accuracy20: 0.3831 - val_loss: 3.2725 - val_accuracy20: 0.4059 - 18s/epoch - 15ms/step
Epoch 2/50
1230/1230 - 16s - loss: 3.2362 - accuracy20: 0.3893 - val_loss: 3.2410 - val_accuracy20: 0.4000 - 16s/epoch - 13ms/step
Epoch 3/50
1230/1230 - 16s - loss: 3.2227 - accuracy20: 0.3936 - val_loss: 3.2344 - val_accuracy20: 0.3886 - 16s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2153 - accuracy20: 0.3980 - val_loss: 3.2296 - val_accuracy20: 0.3820 - 17s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2090 - accuracy20: 0.4013 - val_loss: 3.2272 - val_accuracy20: 0.3851 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 16s - loss: 3.2055 - accuracy20: 0.4021 - val_loss: 3.2279 - val_accuracy20: 0.3835 - 16s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 16s - loss: 3.2019 - accuracy20: 0.4042 - val_loss: 3.2290 - val_accuracy20: 0.3866 - 16s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.1990 - accuracy20: 0.4070 - val_loss: 3.2235 - val_accuracy20: 0.3879 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 16s - loss: 3.1948 - accuracy20: 0.4079 - val_loss: 3.2245 - val_accuracy20: 0.3915 - 16s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.1921 - accuracy20: 0.4095 - val_loss: 3.2235 - val_accuracy20: 0.3932 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.1893 - accuracy20: 0.4123 - val_loss: 3.2221 - val_accuracy20: 0.3959 - 16s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 16s - loss: 3.1862 - accuracy20: 0.4140 - val_loss: 3.2231 - val_accuracy20: 0.3986 - 16s/epoch - 13ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.1841 - accuracy20: 0.4148 - val_loss: 3.2225 - val_accuracy20: 0.4025 - 17s/epoch - 13ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.1813 - accuracy20: 0.4159 - val_loss: 3.2224 - val_accuracy20: 0.4017 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 16s - loss: 3.1787 - accuracy20: 0.4170 - val_loss: 3.2238 - val_accuracy20: 0.4030 - 16s/epoch - 13ms/step
Epoch 16/50
1230/1230 - 16s - loss: 3.1766 - accuracy20: 0.4186 - val_loss: 3.2259 - val_accuracy20: 0.4042 - 16s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 16s - loss: 3.1736 - accuracy20: 0.4207 - val_loss: 3.2219 - val_accuracy20: 0.4058 - 16s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.1716 - accuracy20: 0.4219 - val_loss: 3.2259 - val_accuracy20: 0.4058 - 17s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.1682 - accuracy20: 0.4229 - val_loss: 3.2313 - val_accuracy20: 0.4118 - 17s/epoch - 13ms/step
Epoch 20/50
1230/1230 - 16s - loss: 3.1659 - accuracy20: 0.4246 - val_loss: 3.2284 - val_accuracy20: 0.4107 - 16s/epoch - 13ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.1628 - accuracy20: 0.4266 - val_loss: 3.2327 - val_accuracy20: 0.4138 - 17s/epoch - 13ms/step
Epoch 22/50
1230/1230 - 17s - loss: 3.1606 - accuracy20: 0.4274 - val_loss: 3.2344 - val_accuracy20: 0.4119 - 17s/epoch - 13ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.1586 - accuracy20: 0.4287 - val_loss: 3.2310 - val_accuracy20: 0.4127 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 17s - loss: 3.1554 - accuracy20: 0.4310 - val_loss: 3.2359 - val_accuracy20: 0.4161 - 17s/epoch - 14ms/step
Epoch 25/50
1230/1230 - 16s - loss: 3.1530 - accuracy20: 0.4313 - val_loss: 3.2361 - val_accuracy20: 0.4175 - 16s/epoch - 13ms/step
Epoch 26/50
1230/1230 - 17s - loss: 3.1518 - accuracy20: 0.4314 - val_loss: 3.2407 - val_accuracy20: 0.4200 - 17s/epoch - 13ms/step
Epoch 27/50
1230/1230 - 16s - loss: 3.1483 - accuracy20: 0.4339 - val_loss: 3.2393 - val_accuracy20: 0.4202 - 16s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h20
Evaluating performance on  test set...
4192/4192 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0530107
{'0': {'precision': 0.3621107756312675, 'recall': 0.44951226217778506, 'f1-score': 0.40110550423103797, 'support': 287347}, '1': {'precision': 0.5132993487776236, 'recall': 0.3805926878741404, 'f1-score': 0.437095243777024, 'support': 505325}, '2': {'precision': 0.36004295386848156, 'recall': 0.43871959154713647, 'f1-score': 0.3955065208482326, 'support': 280473}, 'accuracy': 0.4142385232191363, 'macro avg': {'precision': 0.4118176927591242, 'recall': 0.422941513866354, 'f1-score': 0.4112357562854316, 'support': 1073145}, 'weighted avg': {'precision': 0.43276236283701186, 'recall': 0.4142385232191363, 'f1-score': 0.416589107536975, 'support': 1073145}}
[[129166  93367  64814]
 [159103 192323 153899]
 [ 68434  88990 123049]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0616438
{'0': {'precision': 0.40701626947540953, 'recall': 0.4503998516014675, 'f1-score': 0.42761049825110686, 'support': 97036}, '1': {'precision': 0.4298273335823254, 'recall': 0.36765537070257787, 'f1-score': 0.396317880794702, 'support': 122079}, '2': {'precision': 0.4047852367877206, 'recall': 0.4357089146962988, 'f1-score': 0.4196781997696397, 'support': 95752}, 'accuracy': 0.4138509275344828, 'macro avg': {'precision': 0.41387627994848514, 'recall': 0.4179213790001148, 'f1-score': 0.4145355262718162, 'support': 314867}, 'weighted avg': {'precision': 0.4151820221684405, 'recall': 0.4138509275344828, 'f1-score': 0.413065611392027, 'support': 314867}}
[[43705 30110 23221]
 [39070 44883 38126]
 [24604 29428 41720]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0694535
{'0': {'precision': 0.3902003570720095, 'recall': 0.4406926129816925, 'f1-score': 0.4139123115540124, 'support': 31244}, '1': {'precision': 0.42462763604188175, 'recall': 0.36668109925375036, 'f1-score': 0.39353269188716383, 'support': 39263}, '2': {'precision': 0.40307990197561494, 'recall': 0.4197807045182431, 'f1-score': 0.41126082326249014, 'support': 31738}, 'accuracy': 0.40578023375226174, 'macro avg': {'precision': 0.4059692983631688, 'recall': 0.4090514722512286, 'f1-score': 0.4062352755678888, 'support': 102245}, 'weighted avg': {'precision': 0.40741869782554, 'recall': 0.40578023375226174, 'f1-score': 0.4052633023860745, 'support': 102245}}
[[13769  9603  7872]
 [13008 14397 11858]
 [ 8510  9905 13323]]
training model: results/WBA/W7/deepOF_L1/h30
Epoch 1/50
1230/1230 - 20s - loss: 3.2841 - accuracy30: 0.3812 - val_loss: 3.2726 - val_accuracy30: 0.3753 - 20s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2512 - accuracy30: 0.3918 - val_loss: 3.2520 - val_accuracy30: 0.3926 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2396 - accuracy30: 0.3975 - val_loss: 3.2469 - val_accuracy30: 0.3946 - 17s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 16s - loss: 3.2335 - accuracy30: 0.4016 - val_loss: 3.2439 - val_accuracy30: 0.3962 - 16s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2284 - accuracy30: 0.4033 - val_loss: 3.2420 - val_accuracy30: 0.3978 - 17s/epoch - 14ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2248 - accuracy30: 0.4056 - val_loss: 3.2421 - val_accuracy30: 0.3973 - 17s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2223 - accuracy30: 0.4070 - val_loss: 3.2401 - val_accuracy30: 0.3998 - 17s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2190 - accuracy30: 0.4088 - val_loss: 3.2387 - val_accuracy30: 0.3995 - 17s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2163 - accuracy30: 0.4106 - val_loss: 3.2365 - val_accuracy30: 0.4000 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2141 - accuracy30: 0.4109 - val_loss: 3.2371 - val_accuracy30: 0.3996 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2121 - accuracy30: 0.4127 - val_loss: 3.2357 - val_accuracy30: 0.4001 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2097 - accuracy30: 0.4125 - val_loss: 3.2345 - val_accuracy30: 0.4033 - 17s/epoch - 13ms/step
Epoch 13/50
1230/1230 - 16s - loss: 3.2071 - accuracy30: 0.4148 - val_loss: 3.2353 - val_accuracy30: 0.4021 - 16s/epoch - 13ms/step
Epoch 14/50
1230/1230 - 16s - loss: 3.2056 - accuracy30: 0.4165 - val_loss: 3.2332 - val_accuracy30: 0.4017 - 16s/epoch - 13ms/step
Epoch 15/50
1230/1230 - 16s - loss: 3.2030 - accuracy30: 0.4177 - val_loss: 3.2329 - val_accuracy30: 0.4026 - 16s/epoch - 13ms/step
Epoch 16/50
1230/1230 - 16s - loss: 3.2013 - accuracy30: 0.4173 - val_loss: 3.2332 - val_accuracy30: 0.4009 - 16s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.1989 - accuracy30: 0.4186 - val_loss: 3.2329 - val_accuracy30: 0.4013 - 17s/epoch - 14ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.1964 - accuracy30: 0.4208 - val_loss: 3.2337 - val_accuracy30: 0.4027 - 17s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.1943 - accuracy30: 0.4214 - val_loss: 3.2365 - val_accuracy30: 0.4015 - 17s/epoch - 13ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.1915 - accuracy30: 0.4234 - val_loss: 3.2346 - val_accuracy30: 0.4023 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.1893 - accuracy30: 0.4235 - val_loss: 3.2348 - val_accuracy30: 0.4005 - 17s/epoch - 14ms/step
Epoch 22/50
1230/1230 - 17s - loss: 3.1877 - accuracy30: 0.4252 - val_loss: 3.2386 - val_accuracy30: 0.3987 - 17s/epoch - 13ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.1859 - accuracy30: 0.4255 - val_loss: 3.2405 - val_accuracy30: 0.3980 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 16s - loss: 3.1830 - accuracy30: 0.4266 - val_loss: 3.2396 - val_accuracy30: 0.3978 - 16s/epoch - 13ms/step
Epoch 25/50
1230/1230 - 17s - loss: 3.1810 - accuracy30: 0.4283 - val_loss: 3.2398 - val_accuracy30: 0.3979 - 17s/epoch - 13ms/step
Epoch 26/50
1230/1230 - 17s - loss: 3.1793 - accuracy30: 0.4291 - val_loss: 3.2421 - val_accuracy30: 0.3971 - 17s/epoch - 14ms/step
Epoch 27/50
1230/1230 - 17s - loss: 3.1765 - accuracy30: 0.4304 - val_loss: 3.2442 - val_accuracy30: 0.3971 - 17s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h30
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0666877
{'0': {'precision': 0.37872012806700045, 'recall': 0.504909998998598, 'f1-score': 0.432804572017184, 'support': 319552}, '1': {'precision': 0.4553707795795015, 'recall': 0.25504957432964315, 'f1-score': 0.3269673309747625, 'support': 439542}, '2': {'precision': 0.3828485486389281, 'recall': 0.488764563717358, 'f1-score': 0.42937124555060596, 'support': 314051}, 'accuracy': 0.39784651654715814, 'macro avg': {'precision': 0.4056464854284767, 'recall': 0.4162413790151997, 'f1-score': 0.3963810495141842, 'support': 1073145}, 'weighted avg': {'precision': 0.411323099031914, 'recall': 0.39784651654715814, 'f1-score': 0.3884506848794502, 'support': 1073145}}
[[161345  68801  89406]
 [169406 112105 158031]
 [ 95276  65278 153497]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0712746
{'0': {'precision': 0.4205808090557413, 'recall': 0.5134564444821508, 'f1-score': 0.4624011002071378, 'support': 106083}, '1': {'precision': 0.3737872826119605, 'recall': 0.2392046055223981, 'f1-score': 0.29172209687344336, 'support': 104049}, '2': {'precision': 0.4234583908665342, 'recall': 0.4802119635269967, 'f1-score': 0.45005301847369433, 'support': 104735}, 'accuracy': 0.4117706841301248, 'macro avg': {'precision': 0.4059421608447453, 'recall': 0.41095767117718185, 'f1-score': 0.40139207185142517, 'support': 314867}, 'weighted avg': {'precision': 0.406074887183981, 'recall': 0.4117706841301248, 'f1-score': 0.4018921997564085, 'support': 314867}}
[[54469 21191 30423]
 [41106 24889 38054]
 [33934 20506 50295]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0775158
{'0': {'precision': 0.4027524418685201, 'recall': 0.512547751983544, 'f1-score': 0.4510648202024904, 'support': 34030}, '1': {'precision': 0.3685327547988492, 'recall': 0.23075332959277087, 'f1-score': 0.2838048886790397, 'support': 33863}, '2': {'precision': 0.42088246985557176, 'recall': 0.4623311597578016, 'f1-score': 0.4406342336343585, 'support': 34352}, 'accuracy': 0.40234730304660377, 'macro avg': {'precision': 0.39738922217431366, 'recall': 0.40187741377803876, 'f1-score': 0.39183464750529623, 'support': 102245}, 'weighted avg': {'precision': 0.39751034160123006, 'recall': 0.40234730304660377, 'f1-score': 0.3921647803866845, 'support': 102245}}
[[17442  6590  9998]
 [14194  7814 11855]
 [11671  6799 15882]]
training model: results/WBA/W7/deepOF_L1/h50
Epoch 1/50
1230/1230 - 19s - loss: 3.2846 - accuracy50: 0.3767 - val_loss: 3.2729 - val_accuracy50: 0.3721 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 16s - loss: 3.2571 - accuracy50: 0.3886 - val_loss: 3.2611 - val_accuracy50: 0.3860 - 16s/epoch - 13ms/step
Epoch 3/50
1230/1230 - 16s - loss: 3.2481 - accuracy50: 0.3929 - val_loss: 3.2581 - val_accuracy50: 0.3898 - 16s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2429 - accuracy50: 0.3966 - val_loss: 3.2566 - val_accuracy50: 0.3913 - 17s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2383 - accuracy50: 0.3987 - val_loss: 3.2562 - val_accuracy50: 0.3926 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 16s - loss: 3.2362 - accuracy50: 0.4000 - val_loss: 3.2570 - val_accuracy50: 0.3937 - 16s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2340 - accuracy50: 0.4010 - val_loss: 3.2557 - val_accuracy50: 0.3926 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 16s - loss: 3.2311 - accuracy50: 0.4025 - val_loss: 3.2534 - val_accuracy50: 0.3952 - 16s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 16s - loss: 3.2296 - accuracy50: 0.4040 - val_loss: 3.2544 - val_accuracy50: 0.3943 - 16s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.2277 - accuracy50: 0.4051 - val_loss: 3.2531 - val_accuracy50: 0.3941 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2251 - accuracy50: 0.4075 - val_loss: 3.2529 - val_accuracy50: 0.3959 - 17s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 16s - loss: 3.2231 - accuracy50: 0.4074 - val_loss: 3.2522 - val_accuracy50: 0.3938 - 16s/epoch - 13ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.2220 - accuracy50: 0.4084 - val_loss: 3.2508 - val_accuracy50: 0.3947 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.2192 - accuracy50: 0.4103 - val_loss: 3.2511 - val_accuracy50: 0.3944 - 17s/epoch - 13ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.2180 - accuracy50: 0.4121 - val_loss: 3.2510 - val_accuracy50: 0.3950 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.2169 - accuracy50: 0.4119 - val_loss: 3.2529 - val_accuracy50: 0.3933 - 17s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 16s - loss: 3.2142 - accuracy50: 0.4137 - val_loss: 3.2517 - val_accuracy50: 0.3933 - 16s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 16s - loss: 3.2127 - accuracy50: 0.4139 - val_loss: 3.2518 - val_accuracy50: 0.3935 - 16s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2107 - accuracy50: 0.4153 - val_loss: 3.2516 - val_accuracy50: 0.3938 - 17s/epoch - 13ms/step
Epoch 20/50
1230/1230 - 16s - loss: 3.2088 - accuracy50: 0.4171 - val_loss: 3.2532 - val_accuracy50: 0.3938 - 16s/epoch - 13ms/step
Epoch 21/50
1230/1230 - 16s - loss: 3.2066 - accuracy50: 0.4182 - val_loss: 3.2531 - val_accuracy50: 0.3934 - 16s/epoch - 13ms/step
Epoch 22/50
1230/1230 - 17s - loss: 3.2046 - accuracy50: 0.4190 - val_loss: 3.2535 - val_accuracy50: 0.3936 - 17s/epoch - 14ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.2034 - accuracy50: 0.4188 - val_loss: 3.2587 - val_accuracy50: 0.3914 - 17s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h50
Evaluating performance on  test set...
4192/4192 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0819443
{'0': {'precision': 0.363553602088769, 'recall': 0.615722395764272, 'f1-score': 0.4571705941074651, 'support': 324289}, '1': {'precision': 0.46438132929810266, 'recall': 0.05657300462992505, 'f1-score': 0.10085892517428154, 'support': 423117}, '2': {'precision': 0.37674437312649245, 'recall': 0.5463423170084024, 'f1-score': 0.4459633010280473, 'support': 325739}, 'accuracy': 0.3742029269110884, 'macro avg': {'precision': 0.4015597681711214, 'recall': 0.4062125724675332, 'f1-score': 0.33466427343659794, 'support': 1073145}, 'weighted avg': {'precision': 0.4073115975327105, 'recall': 0.3742029269110884, 'f1-score': 0.31328307018069074, 'support': 1073145}}
[[199672  14440 110177]
 [214946  23937 184234]
 [134605  13169 177965]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780367
{'0': {'precision': 0.40015453035548065, 'recall': 0.619786660635872, 'f1-score': 0.48632301998957445, 'support': 106122}, '1': {'precision': 0.41541457985531444, 'recall': 0.04307393445145407, 'f1-score': 0.07805447606433961, 'support': 103984}, '2': {'precision': 0.40457070056400124, 'recall': 0.5395614780309467, 'f1-score': 0.4624156873652736, 'support': 104761}, 'accuracy': 0.4026366688157222, 'macro avg': {'precision': 0.4067132702582654, 'recall': 0.4008073577060909, 'f1-score': 0.34226439447306256, 'support': 314867}, 'weighted avg': {'precision': 0.40666344807123217, 'recall': 0.4026366688157222, 'f1-score': 0.3435390751983578, 'support': 314867}}
[[65773  3339 37010]
 [53324  4479 46181]
 [45272  2964 56525]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0834448
{'0': {'precision': 0.38725355844250764, 'recall': 0.6192730247779337, 'f1-score': 0.4765213090058795, 'support': 34224}, '1': {'precision': 0.40663121676571784, 'recall': 0.03839678648433116, 'f1-score': 0.07016786311869165, 'support': 33857}, '2': {'precision': 0.4033710146889596, 'recall': 0.5232701088865472, 'f1-score': 0.4555636252436834, 'support': 34164}, 'accuracy': 0.3948457137268326, 'macro avg': {'precision': 0.39908526329906163, 'recall': 0.3936466400496041, 'f1-score': 0.33408426578941813, 'support': 102245}, 'weighted avg': {'precision': 0.3990556627317415, 'recall': 0.3948457137268326, 'f1-score': 0.33496028474597256, 'support': 102245}}
[[21194   994 12036]
 [18151  1300 14406]
 [15384   903 17877]]
training model: results/WBA/W7/deepOF_L1/h100
Epoch 1/50
1230/1230 - 19s - loss: 3.2870 - accuracy100: 0.3720 - val_loss: 3.2866 - val_accuracy100: 0.3828 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2637 - accuracy100: 0.3804 - val_loss: 3.2860 - val_accuracy100: 0.3869 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2587 - accuracy100: 0.3812 - val_loss: 3.2860 - val_accuracy100: 0.3897 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 16s - loss: 3.2565 - accuracy100: 0.3833 - val_loss: 3.2838 - val_accuracy100: 0.3902 - 16s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2545 - accuracy100: 0.3850 - val_loss: 3.2826 - val_accuracy100: 0.3912 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 16s - loss: 3.2532 - accuracy100: 0.3856 - val_loss: 3.2810 - val_accuracy100: 0.3940 - 16s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2524 - accuracy100: 0.3874 - val_loss: 3.2793 - val_accuracy100: 0.3956 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2505 - accuracy100: 0.3890 - val_loss: 3.2788 - val_accuracy100: 0.3961 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2504 - accuracy100: 0.3888 - val_loss: 3.2782 - val_accuracy100: 0.3958 - 17s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.2495 - accuracy100: 0.3893 - val_loss: 3.2766 - val_accuracy100: 0.3985 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2481 - accuracy100: 0.3903 - val_loss: 3.2754 - val_accuracy100: 0.3985 - 17s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2477 - accuracy100: 0.3912 - val_loss: 3.2748 - val_accuracy100: 0.3986 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.2460 - accuracy100: 0.3922 - val_loss: 3.2756 - val_accuracy100: 0.3987 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.2449 - accuracy100: 0.3932 - val_loss: 3.2758 - val_accuracy100: 0.3973 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.2440 - accuracy100: 0.3927 - val_loss: 3.2755 - val_accuracy100: 0.3974 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 16s - loss: 3.2426 - accuracy100: 0.3944 - val_loss: 3.2752 - val_accuracy100: 0.3981 - 16s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 16s - loss: 3.2415 - accuracy100: 0.3953 - val_loss: 3.2740 - val_accuracy100: 0.3991 - 16s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 16s - loss: 3.2401 - accuracy100: 0.3958 - val_loss: 3.2749 - val_accuracy100: 0.3974 - 16s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 16s - loss: 3.2388 - accuracy100: 0.3971 - val_loss: 3.2753 - val_accuracy100: 0.3960 - 16s/epoch - 13ms/step
Epoch 20/50
1230/1230 - 16s - loss: 3.2374 - accuracy100: 0.3974 - val_loss: 3.2749 - val_accuracy100: 0.3976 - 16s/epoch - 13ms/step
Epoch 21/50
1230/1230 - 16s - loss: 3.2364 - accuracy100: 0.3997 - val_loss: 3.2761 - val_accuracy100: 0.3967 - 16s/epoch - 13ms/step
Epoch 22/50
1230/1230 - 16s - loss: 3.2350 - accuracy100: 0.3996 - val_loss: 3.2762 - val_accuracy100: 0.3962 - 16s/epoch - 13ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.2336 - accuracy100: 0.4007 - val_loss: 3.2783 - val_accuracy100: 0.3956 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 17s - loss: 3.2324 - accuracy100: 0.4022 - val_loss: 3.2765 - val_accuracy100: 0.3963 - 17s/epoch - 14ms/step
Epoch 25/50
1230/1230 - 16s - loss: 3.2310 - accuracy100: 0.4025 - val_loss: 3.2776 - val_accuracy100: 0.3939 - 16s/epoch - 13ms/step
Epoch 26/50
1230/1230 - 17s - loss: 3.2293 - accuracy100: 0.4035 - val_loss: 3.2791 - val_accuracy100: 0.3952 - 17s/epoch - 14ms/step
Epoch 27/50
1230/1230 - 16s - loss: 3.2274 - accuracy100: 0.4048 - val_loss: 3.2803 - val_accuracy100: 0.3945 - 16s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h100
Evaluating performance on  test set...
4192/4192 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1270102
{'0': {'precision': 0.33326041494913944, 'recall': 0.6467874647918561, 'f1-score': 0.4398737313883084, 'support': 315623}, '1': {'precision': 0.5755813953488372, 'recall': 0.0020688021844322054, 'f1-score': 0.004122785911269873, 'support': 430684}, '2': {'precision': 0.3598880271871732, 'recall': 0.5054583616348161, 'f1-score': 0.42042912513138175, 'support': 326838}, 'accuracy': 0.34499997670398685, 'macro avg': {'precision': 0.4229099458283833, 'recall': 0.38477154287036813, 'f1-score': 0.28814188081032, 'support': 1073145}, 'weighted avg': {'precision': 0.43862053371325604, 'recall': 0.34499997670398685, 'f1-score': 0.2590722586873833, 'support': 1073145}}
[[204141    309 111173]
 [247129    891 182664]
 [161287    348 165203]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994269
{'0': {'precision': 0.38297322471746775, 'recall': 0.6662607718246534, 'f1-score': 0.48637393971096543, 'support': 106760}, '1': {'precision': 0.5082508250825083, 'recall': 0.0014965986394557824, 'f1-score': 0.00298440936794473, 'support': 102900}, '2': {'precision': 0.39337747316293187, 'recall': 0.4817169960173753, 'f1-score': 0.4330883609639378, 'support': 105207}, 'accuracy': 0.38735084972385164, 'macro avg': {'precision': 0.4282005076543027, 'recall': 0.3831581221604948, 'f1-score': 0.3074822366809493, 'support': 314867}, 'weighted avg': {'precision': 0.42739091486525904, 'recall': 0.38735084972385164, 'f1-score': 0.310595599791141, 'support': 314867}}
[[71130    81 35549]
 [60142   154 42604]
 [54459    68 50680]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0900366
{'0': {'precision': 0.38864424550366966, 'recall': 0.6630159603742433, 'f1-score': 0.4900391518787817, 'support': 36340}, '1': {'precision': 0.47, 'recall': 0.0015914400839738597, 'f1-score': 0.0031721391691695066, 'support': 29533}, '2': {'precision': 0.41235367372353676, 'recall': 0.45518530737930274, 'f1-score': 0.4327121612085413, 'support': 36372}, 'accuracy': 0.39803413369846935, 'macro avg': {'precision': 0.42366597307573545, 'recall': 0.37326423594583996, 'f1-score': 0.3086411507521642, 'support': 102245}, 'weighted avg': {'precision': 0.4205777270504752, 'recall': 0.39803413369846935, 'f1-score': 0.3290166980569717, 'support': 102245}}
[[24094    36 12210]
 [18102    47 11384]
 [19799    17 16556]]
training model: results/WBA/W7/deepOF_L1/h200
Epoch 1/50
1230/1230 - 19s - loss: 3.3159 - accuracy200: 0.3505 - val_loss: 3.3084 - val_accuracy200: 0.3356 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2951 - accuracy200: 0.3578 - val_loss: 3.2979 - val_accuracy200: 0.3396 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2885 - accuracy200: 0.3616 - val_loss: 3.2942 - val_accuracy200: 0.3481 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2859 - accuracy200: 0.3647 - val_loss: 3.2911 - val_accuracy200: 0.3526 - 17s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2835 - accuracy200: 0.3655 - val_loss: 3.2903 - val_accuracy200: 0.3555 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 16s - loss: 3.2820 - accuracy200: 0.3670 - val_loss: 3.2897 - val_accuracy200: 0.3569 - 16s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 16s - loss: 3.2807 - accuracy200: 0.3694 - val_loss: 3.2894 - val_accuracy200: 0.3610 - 16s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 16s - loss: 3.2792 - accuracy200: 0.3706 - val_loss: 3.2886 - val_accuracy200: 0.3603 - 16s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2788 - accuracy200: 0.3718 - val_loss: 3.2893 - val_accuracy200: 0.3597 - 17s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2777 - accuracy200: 0.3720 - val_loss: 3.2893 - val_accuracy200: 0.3606 - 17s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.2766 - accuracy200: 0.3736 - val_loss: 3.2881 - val_accuracy200: 0.3631 - 16s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 16s - loss: 3.2759 - accuracy200: 0.3750 - val_loss: 3.2889 - val_accuracy200: 0.3612 - 16s/epoch - 13ms/step
Epoch 13/50
1230/1230 - 16s - loss: 3.2750 - accuracy200: 0.3749 - val_loss: 3.2885 - val_accuracy200: 0.3615 - 16s/epoch - 13ms/step
Epoch 14/50
1230/1230 - 16s - loss: 3.2741 - accuracy200: 0.3776 - val_loss: 3.2887 - val_accuracy200: 0.3608 - 16s/epoch - 13ms/step
Epoch 15/50
1230/1230 - 16s - loss: 3.2730 - accuracy200: 0.3777 - val_loss: 3.2895 - val_accuracy200: 0.3593 - 16s/epoch - 13ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.2725 - accuracy200: 0.3781 - val_loss: 3.2895 - val_accuracy200: 0.3601 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 16s - loss: 3.2714 - accuracy200: 0.3791 - val_loss: 3.2894 - val_accuracy200: 0.3596 - 16s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.2707 - accuracy200: 0.3806 - val_loss: 3.2906 - val_accuracy200: 0.3576 - 17s/epoch - 13ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2694 - accuracy200: 0.3813 - val_loss: 3.2914 - val_accuracy200: 0.3564 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.2683 - accuracy200: 0.3810 - val_loss: 3.2911 - val_accuracy200: 0.3571 - 17s/epoch - 13ms/step
Epoch 21/50
1230/1230 - 16s - loss: 3.2679 - accuracy200: 0.3832 - val_loss: 3.2923 - val_accuracy200: 0.3579 - 16s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h200
Evaluating performance on  test set...
4192/4192 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930994
{'0': {'precision': 0.35107058735337865, 'recall': 0.5255178726985487, 'f1-score': 0.42093611002373565, 'support': 338645}, '1': {'precision': 0.3589734004552327, 'recall': 0.22654650592808706, 'f1-score': 0.2777844739612211, 'support': 381489}, '2': {'precision': 0.3763468941933383, 'recall': 0.3469863545328616, 'f1-score': 0.36107074321794835, 'support': 353011}, 'accuracy': 0.36050953039896755, 'macro avg': {'precision': 0.3621302940006499, 'recall': 0.36635024438649905, 'f1-score': 0.35326377573430173, 'support': 1073145}, 'weighted avg': {'precision': 0.36219457397335464, 'recall': 0.36050953039896755, 'f1-score': 0.35035486751565853, 'support': 1073145}}
[[177964  72412  88269]
 [180352  86425 114712]
 [148602  81919 122490]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926007
{'0': {'precision': 0.3819750343114829, 'recall': 0.5412067560560041, 'f1-score': 0.4478586370985662, 'support': 107992}, '1': {'precision': 0.33175286731335274, 'recall': 0.22607131917752724, 'f1-score': 0.2689012422579243, 'support': 101207}, '2': {'precision': 0.3843040155022069, 'recall': 0.3378316992845516, 'f1-score': 0.35957251785372535, 'support': 105668}, 'accuracy': 0.3716616857276247, 'macro avg': {'precision': 0.3660106390423475, 'recall': 0.368369924839361, 'f1-score': 0.3587774657367386, 'support': 314867}, 'weighted avg': {'precision': 0.3666138307845387, 'recall': 0.3716616857276247, 'f1-score': 0.360708320590324, 'support': 314867}}
[[58446 22191 27355]
 [48490 22880 29837]
 [46074 23896 35698]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095325
{'0': {'precision': 0.3643558951965066, 'recall': 0.5467630108533481, 'f1-score': 0.43730038956936795, 'support': 34183}, '1': {'precision': 0.3319005627686445, 'recall': 0.22174196222393275, 'f1-score': 0.2658620995651788, 'support': 33778}, '2': {'precision': 0.3756958635755056, 'recall': 0.3110197176525493, 'f1-score': 0.3403121309801168, 'support': 34284}, 'accuracy': 0.36034035894175753, 'macro avg': {'precision': 0.35731744051355224, 'recall': 0.35984156357661007, 'f1-score': 0.3478248733715545, 'support': 102245}, 'weighted avg': {'precision': 0.35743627328010263, 'recall': 0.36034035894175753, 'f1-score': 0.3481421127124519, 'support': 102245}}
[[18690  7181  8312]
 [16881  7490  9407]
 [15725  7896 10663]]
training model: results/WBA/W7/deepOF_L1/h300
Epoch 1/50
1230/1230 - 19s - loss: 3.2986 - accuracy300: 0.3754 - val_loss: 3.3241 - val_accuracy300: 0.3381 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2828 - accuracy300: 0.3782 - val_loss: 3.3271 - val_accuracy300: 0.3387 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2821 - accuracy300: 0.3768 - val_loss: 3.3289 - val_accuracy300: 0.3435 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2823 - accuracy300: 0.3742 - val_loss: 3.3295 - val_accuracy300: 0.3433 - 17s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2823 - accuracy300: 0.3715 - val_loss: 3.3287 - val_accuracy300: 0.3445 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2818 - accuracy300: 0.3712 - val_loss: 3.3275 - val_accuracy300: 0.3448 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2813 - accuracy300: 0.3714 - val_loss: 3.3276 - val_accuracy300: 0.3465 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 16s - loss: 3.2808 - accuracy300: 0.3719 - val_loss: 3.3283 - val_accuracy300: 0.3454 - 16s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2801 - accuracy300: 0.3730 - val_loss: 3.3281 - val_accuracy300: 0.3457 - 17s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.2792 - accuracy300: 0.3730 - val_loss: 3.3291 - val_accuracy300: 0.3463 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.2784 - accuracy300: 0.3742 - val_loss: 3.3282 - val_accuracy300: 0.3456 - 16s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h300
Evaluating performance on  test set...
4192/4192 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1198401
{'0': {'precision': 0.2782798484452714, 'recall': 0.7199126403310472, 'f1-score': 0.4013998957069929, 'support': 287089}, '1': {'precision': 0.48467569493941554, 'recall': 0.01823368404985799, 'f1-score': 0.03514519258293311, 'support': 484817}, '2': {'precision': 0.30152720657006316, 'recall': 0.31250269719392243, 'f1-score': 0.3069168610612559, 'support': 301239}, 'accuracy': 0.2885509413918902, 'macro avg': {'precision': 0.3548275833182501, 'recall': 0.35021634052494255, 'f1-score': 0.24782064978372728, 'support': 1073145}, 'weighted avg': {'precision': 0.3780494285336151, 'recall': 0.2885509413918902, 'f1-score': 0.2094142075864272, 'support': 1073145}}
[[206679   4582  75828]
 [333739   8840 142238]
 [202284   4817  94138]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997969
{'0': {'precision': 0.3544133500833044, 'recall': 0.7353476721723619, 'f1-score': 0.4783012544000193, 'support': 108191}, '1': {'precision': 0.3400610185402488, 'recall': 0.014219265190767782, 'f1-score': 0.027297131823105548, 'support': 101904}, '2': {'precision': 0.3578975478357793, 'recall': 0.2942102851906998, 'f1-score': 0.32294394971189105, 'support': 104772}, 'accuracy': 0.3551721838109424, 'macro avg': {'precision': 0.35079063881977746, 'recall': 0.34792574085127653, 'f1-score': 0.2761807786450053, 'support': 314867}, 'weighted avg': {'precision': 0.35092770812450513, 'recall': 0.3551721838109424, 'f1-score': 0.28064249805571395, 'support': 314867}}
[[79558  1409 27224]
 [72376  1449 28079]
 [72544  1403 30825]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046579
{'0': {'precision': 0.3321418973394249, 'recall': 0.7412583218377017, 'f1-score': 0.4587346658500826, 'support': 33346}, '1': {'precision': 0.36475409836065575, 'recall': 0.012694699606321675, 'f1-score': 0.02453547995809671, 'support': 35054}, '2': {'precision': 0.356624694606277, 'recall': 0.2803368296646477, 'f1-score': 0.3139123242349049, 'support': 33845}, 'accuracy': 0.33890165778277664, 'macro avg': {'precision': 0.35117356343545253, 'recall': 0.3447632837028903, 'f1-score': 0.2657274900143614, 'support': 102245}, 'weighted avg': {'precision': 0.35142702979670726, 'recall': 0.33890165778277664, 'f1-score': 0.26193354682985315, 'support': 102245}}
[[24718   387  8241]
 [25733   445  8876]
 [23969   388  9488]]
training model: results/WBA/W7/deepOF_L1/h500
Epoch 1/50
1230/1230 - 19s - loss: 3.3274 - accuracy500: 0.3453 - val_loss: 3.3042 - val_accuracy500: 0.3407 - 19s/epoch - 15ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.3049 - accuracy500: 0.3467 - val_loss: 3.3025 - val_accuracy500: 0.3348 - 17s/epoch - 13ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2982 - accuracy500: 0.3490 - val_loss: 3.3051 - val_accuracy500: 0.3300 - 17s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2951 - accuracy500: 0.3508 - val_loss: 3.3067 - val_accuracy500: 0.3304 - 17s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 16s - loss: 3.2933 - accuracy500: 0.3512 - val_loss: 3.3071 - val_accuracy500: 0.3305 - 16s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 16s - loss: 3.2921 - accuracy500: 0.3520 - val_loss: 3.3051 - val_accuracy500: 0.3327 - 16s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 16s - loss: 3.2909 - accuracy500: 0.3535 - val_loss: 3.3063 - val_accuracy500: 0.3322 - 16s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 16s - loss: 3.2904 - accuracy500: 0.3535 - val_loss: 3.3056 - val_accuracy500: 0.3320 - 16s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 16s - loss: 3.2899 - accuracy500: 0.3545 - val_loss: 3.3055 - val_accuracy500: 0.3317 - 16s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.2890 - accuracy500: 0.3556 - val_loss: 3.3052 - val_accuracy500: 0.3316 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2883 - accuracy500: 0.3555 - val_loss: 3.3052 - val_accuracy500: 0.3334 - 17s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2878 - accuracy500: 0.3569 - val_loss: 3.3057 - val_accuracy500: 0.3323 - 17s/epoch - 14ms/step
testing model: results/WBA/W7/deepOF_L1/h500
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027694
{'0': {'precision': 0.2978557781751138, 'recall': 0.6895856908430293, 'f1-score': 0.4160187494833681, 'support': 310179}, '1': {'precision': 0.40201773607659164, 'recall': 0.06355524349358542, 'f1-score': 0.10975866824864337, 'support': 430114}, '2': {'precision': 0.33299771454053906, 'recall': 0.2871576556547655, 'f1-score': 0.30838350401042774, 'support': 332852}, 'accuracy': 0.3138550708431759, 'macro avg': {'precision': 0.3442904095974148, 'recall': 0.3467661966637934, 'f1-score': 0.2780536405808131, 'support': 1073145}, 'weighted avg': {'precision': 0.3505034447662462, 'recall': 0.3138550708431759, 'f1-score': 0.2598857429405882, 'support': 1073145}}
[[213895  19284  77000]
 [288327  27336 114451]
 [215894  21377  95581]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980144
{'0': {'precision': 0.34663762339528204, 'recall': 0.7087799099739398, 'f1-score': 0.46557836256399876, 'support': 105525}, '1': {'precision': 0.35278244488569827, 'recall': 0.0649500384319754, 'f1-score': 0.10970290445920378, 'support': 106682}, '2': {'precision': 0.35355416834474424, 'recall': 0.27364114552893043, 'f1-score': 0.30850666608095934, 'support': 102660}, 'accuracy': 0.3487663045031712, 'macro avg': {'precision': 0.3509914122085749, 'recall': 0.3491236979782819, 'f1-score': 0.2945959777013873, 'support': 314867}, 'weighted avg': {'precision': 0.3509746747558641, 'recall': 0.3487663045031712, 'f1-score': 0.2937900011844812, 'support': 314867}}
[[74794  6391 24340]
 [72729  6929 27024]
 [68247  6321 28092]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005937
{'0': {'precision': 0.32564712466769274, 'recall': 0.7156386446098026, 'f1-score': 0.44761135471959385, 'support': 32522}, '1': {'precision': 0.35895018073235896, 'recall': 0.06386667412337117, 'f1-score': 0.10843916913946587, 'support': 35762}, '2': {'precision': 0.3500737342290677, 'recall': 0.2516415888813639, 'f1-score': 0.2928066057937745, 'support': 33961}, 'accuracy': 0.3335517629223923, 'macro avg': {'precision': 0.3448903465430398, 'recall': 0.3437156358715126, 'f1-score': 0.28295237655094474, 'support': 102245}, 'weighted avg': {'precision': 0.3454088340744945, 'recall': 0.3335517629223923, 'f1-score': 0.2775609876699945, 'support': 102245}}
[[23274  1947  7301]
 [24913  2284  8565]
 [23283  2132  8546]]
training model: results/WBA/W7/deepOF_L1/h1000
Epoch 1/50
1230/1230 - 18s - loss: 3.3300 - accuracy1000: 0.3440 - val_loss: 3.3128 - val_accuracy1000: 0.3356 - 18s/epoch - 15ms/step
Epoch 2/50
1230/1230 - 16s - loss: 3.3085 - accuracy1000: 0.3442 - val_loss: 3.3166 - val_accuracy1000: 0.3285 - 16s/epoch - 13ms/step
Epoch 3/50
1230/1230 - 16s - loss: 3.3022 - accuracy1000: 0.3444 - val_loss: 3.3180 - val_accuracy1000: 0.3259 - 16s/epoch - 13ms/step
Epoch 4/50
1230/1230 - 16s - loss: 3.2987 - accuracy1000: 0.3449 - val_loss: 3.3184 - val_accuracy1000: 0.3268 - 16s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2975 - accuracy1000: 0.3456 - val_loss: 3.3166 - val_accuracy1000: 0.3267 - 17s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2964 - accuracy1000: 0.3467 - val_loss: 3.3155 - val_accuracy1000: 0.3272 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 16s - loss: 3.2957 - accuracy1000: 0.3468 - val_loss: 3.3145 - val_accuracy1000: 0.3268 - 16s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 16s - loss: 3.2953 - accuracy1000: 0.3482 - val_loss: 3.3148 - val_accuracy1000: 0.3273 - 16s/epoch - 13ms/step
Epoch 9/50
1230/1230 - 16s - loss: 3.2948 - accuracy1000: 0.3478 - val_loss: 3.3137 - val_accuracy1000: 0.3280 - 16s/epoch - 13ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.2941 - accuracy1000: 0.3482 - val_loss: 3.3139 - val_accuracy1000: 0.3275 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.2937 - accuracy1000: 0.3496 - val_loss: 3.3140 - val_accuracy1000: 0.3283 - 16s/epoch - 13ms/step
testing model: results/WBA/W7/deepOF_L1/h1000
Evaluating performance on  test set...
4192/4192 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102806
{'0': {'precision': 0.29502082596030815, 'recall': 0.519058156354475, 'f1-score': 0.3762115699725054, 'support': 313173}, '1': {'precision': 0.3829649621755911, 'recall': 0.3046649964174597, 'f1-score': 0.3393569968009192, 'support': 415906}, '2': {'precision': 0.33243586593405444, 'recall': 0.1848133788284806, 'f1-score': 0.23755895730790427, 'support': 344066}, 'accuracy': 0.3288045883827442, 'macro avg': {'precision': 0.3368072180233179, 'recall': 0.33617884386680513, 'f1-score': 0.3177091746937763, 'support': 1073145}, 'weighted avg': {'precision': 0.34110009489447873, 'recall': 0.3288045883827442, 'f1-score': 0.31747422512296464, 'support': 1073145}}
[[162555  97153  53465]
 [214968 126712  74226]
 [173472 107006  63588]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001103
{'0': {'precision': 0.3525683190815045, 'recall': 0.5424302642231544, 'f1-score': 0.42736095909772903, 'support': 108696}, '1': {'precision': 0.32966145563722954, 'recall': 0.31061729358514123, 'f1-score': 0.31985615413205293, 'support': 102512}, '2': {'precision': 0.3425274746801967, 'recall': 0.16867806943921898, 'f1-score': 0.22604165320026373, 'support': 103659}, 'accuracy': 0.3439134618743787, 'macro avg': {'precision': 0.34158574979964357, 'recall': 0.3405752090825049, 'f1-score': 0.32441958881001526, 'support': 314867}, 'weighted avg': {'precision': 0.34180487840593454, 'recall': 0.34391346187437866, 'f1-score': 0.326082989362359, 'support': 314867}}
[[58960 32903 16833]
 [53941 31842 16729]
 [54329 31845 17485]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102295
{'0': {'precision': 0.3280460106967543, 'recall': 0.5434518752275762, 'f1-score': 0.40912828947368424, 'support': 32956}, '1': {'precision': 0.33938140453135285, 'recall': 0.31445079991870156, 'f1-score': 0.32644080057873165, 'support': 34441}, '2': {'precision': 0.3509340449866565, 'recall': 0.15848829201101927, 'f1-score': 0.21836081129166168, 'support': 34848}, 'accuracy': 0.3351068511907673, 'macro avg': {'precision': 0.3394538200715879, 'recall': 0.33879698905243233, 'f1-score': 0.3179766337813592, 'support': 102245}, 'weighted avg': {'precision': 0.3396652049653437, 'recall': 0.3351068511907673, 'f1-score': 0.3162562186172298, 'support': 102245}}
[[17910 10158  4888]
 [18284 10830  5327]
 [18402 10923  5523]]
training model: results/WBA/W7/deepLOB_L2/h10
Epoch 1/50
1230/1230 - 53s - loss: 3.1608 - accuracy10: 0.4275 - val_loss: 3.3756 - val_accuracy10: 0.3751 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 51s - loss: 2.9806 - accuracy10: 0.4744 - val_loss: 3.1282 - val_accuracy10: 0.3988 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 2.9253 - accuracy10: 0.4907 - val_loss: 3.0513 - val_accuracy10: 0.4406 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 2.8909 - accuracy10: 0.5041 - val_loss: 3.0260 - val_accuracy10: 0.4494 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 2.8676 - accuracy10: 0.5143 - val_loss: 3.0718 - val_accuracy10: 0.4361 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 2.8482 - accuracy10: 0.5196 - val_loss: 3.0516 - val_accuracy10: 0.4418 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 51s - loss: 2.8316 - accuracy10: 0.5256 - val_loss: 3.0458 - val_accuracy10: 0.4383 - 51s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 2.8178 - accuracy10: 0.5287 - val_loss: 3.0265 - val_accuracy10: 0.4504 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 2.8045 - accuracy10: 0.5319 - val_loss: 2.9951 - val_accuracy10: 0.4583 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 2.7919 - accuracy10: 0.5347 - val_loss: 3.0341 - val_accuracy10: 0.4371 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 2.7813 - accuracy10: 0.5366 - val_loss: 3.0358 - val_accuracy10: 0.4429 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.7711 - accuracy10: 0.5388 - val_loss: 3.0196 - val_accuracy10: 0.4509 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.7626 - accuracy10: 0.5394 - val_loss: 3.0326 - val_accuracy10: 0.4438 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 50s - loss: 2.7534 - accuracy10: 0.5429 - val_loss: 3.0363 - val_accuracy10: 0.4469 - 50s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 50s - loss: 2.7461 - accuracy10: 0.5428 - val_loss: 3.0631 - val_accuracy10: 0.4359 - 50s/epoch - 41ms/step
Epoch 16/50
1230/1230 - 50s - loss: 2.7368 - accuracy10: 0.5444 - val_loss: 3.0645 - val_accuracy10: 0.4284 - 50s/epoch - 41ms/step
Epoch 17/50
1230/1230 - 50s - loss: 2.7302 - accuracy10: 0.5455 - val_loss: 3.0086 - val_accuracy10: 0.4448 - 50s/epoch - 41ms/step
Epoch 18/50
1230/1230 - 51s - loss: 2.7240 - accuracy10: 0.5465 - val_loss: 3.0375 - val_accuracy10: 0.4401 - 51s/epoch - 41ms/step
Epoch 19/50
1230/1230 - 50s - loss: 2.7161 - accuracy10: 0.5485 - val_loss: 3.0685 - val_accuracy10: 0.4257 - 50s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h10
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9788152
{'0': {'precision': 0.3141863935730052, 'recall': 0.7827205898722567, 'f1-score': 0.44838835565599555, 'support': 224591}, '1': {'precision': 0.7525063477419877, 'recall': 0.42878242378138354, 'f1-score': 0.5462872474096016, 'support': 629669}, '2': {'precision': 0.44832284979915527, 'recall': 0.31715016675042257, 'f1-score': 0.37149752766658817, 'support': 218890}, 'accuracy': 0.4800857289288543, 'macro avg': {'precision': 0.5050051970380495, 'recall': 0.5095510601346877, 'f1-score': 0.4553910435773951, 'support': 1073150}, 'weighted avg': {'precision': 0.5987296690936417, 'recall': 0.4800857289288543, 'f1-score': 0.49014697647601135, 'support': 1073150}}
[[175792  32742  16057]
 [290310 269991  69368]
 [ 93413  56056  69421]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0183927
{'0': {'precision': 0.34360158931678186, 'recall': 0.7546894566297879, 'f1-score': 0.4722108910851101, 'support': 77461}, '1': {'precision': 0.7104680660565061, 'recall': 0.3551832395635821, 'f1-score': 0.4736002254726014, 'support': 160855}, '2': {'precision': 0.45813573816372544, 'recall': 0.3849067941633682, 'f1-score': 0.41834083455198556, 'support': 76551}, 'accuracy': 0.4606929274900196, 'macro avg': {'precision': 0.5040684645123378, 'recall': 0.4982598301189127, 'f1-score': 0.45471731703656565, 'support': 314867}, 'weighted avg': {'precision': 0.5588671164896857, 'recall': 0.4606929274900196, 'f1-score': 0.4598236758013004, 'support': 314867}}
[[58459  8975 10027]
 [78899 57133 24823]
 [32778 14308 29465]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0162976
{'0': {'precision': 0.3382791411584129, 'recall': 0.7617798967024235, 'f1-score': 0.4685098532699662, 'support': 25170}, '1': {'precision': 0.7063386944181647, 'recall': 0.3636629322942036, 'f1-score': 0.48012861736334406, 'support': 51325}, '2': {'precision': 0.4723862270756048, 'recall': 0.35110679611650486, 'f1-score': 0.4028158346142708, 'support': 25750}, 'accuracy': 0.4585065284365984, 'macro avg': {'precision': 0.5056680208840608, 'recall': 0.492183208371044, 'f1-score': 0.4504847684158603, 'support': 102245}, 'weighted avg': {'precision': 0.556812214007202, 'recall': 0.4585065284365984, 'f1-score': 0.4577974672042267, 'support': 102245}}
[[19174  2881  3115]
 [25677 18665  6983]
 [11830  4879  9041]]
training model: results/WBA/W7/deepLOB_L2/h20
Epoch 1/50
1230/1230 - 52s - loss: 3.1786 - accuracy20: 0.4323 - val_loss: 3.2915 - val_accuracy20: 0.3885 - 52s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.0443 - accuracy20: 0.4715 - val_loss: 3.3529 - val_accuracy20: 0.3422 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.0115 - accuracy20: 0.4823 - val_loss: 3.3180 - val_accuracy20: 0.3415 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 2.9873 - accuracy20: 0.4897 - val_loss: 3.3033 - val_accuracy20: 0.3479 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 2.9729 - accuracy20: 0.4944 - val_loss: 3.1232 - val_accuracy20: 0.4166 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 2.9594 - accuracy20: 0.4978 - val_loss: 3.2709 - val_accuracy20: 0.3721 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 51s - loss: 2.9489 - accuracy20: 0.5010 - val_loss: 3.2651 - val_accuracy20: 0.3681 - 51s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 2.9381 - accuracy20: 0.5043 - val_loss: 3.2604 - val_accuracy20: 0.3746 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 2.9279 - accuracy20: 0.5076 - val_loss: 3.3023 - val_accuracy20: 0.3599 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 2.9180 - accuracy20: 0.5103 - val_loss: 3.2366 - val_accuracy20: 0.3849 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 2.9096 - accuracy20: 0.5124 - val_loss: 3.2684 - val_accuracy20: 0.3840 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.9006 - accuracy20: 0.5149 - val_loss: 3.2817 - val_accuracy20: 0.3809 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 51s - loss: 2.8929 - accuracy20: 0.5170 - val_loss: 3.2920 - val_accuracy20: 0.3810 - 51s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 51s - loss: 2.8839 - accuracy20: 0.5198 - val_loss: 3.2857 - val_accuracy20: 0.3810 - 51s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 51s - loss: 2.8783 - accuracy20: 0.5211 - val_loss: 3.3079 - val_accuracy20: 0.3779 - 51s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h20
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0533129
{'0': {'precision': 0.32643356757595643, 'recall': 0.8344771184966069, 'f1-score': 0.46928906094042955, 'support': 287350}, '1': {'precision': 0.6207301961878904, 'recall': 0.2904580409478238, 'f1-score': 0.39573837631760234, 'support': 505326}, '2': {'precision': 0.4953734076199242, 'recall': 0.18037679071856927, 'f1-score': 0.26445827376300635, 'support': 280474}, 'accuracy': 0.40735591483017286, 'macro avg': {'precision': 0.4808457237945903, 'recall': 0.43510398338766665, 'f1-score': 0.37649523700701276, 'support': 1073150}, 'weighted avg': {'precision': 0.5091656840987594, 'recall': 0.40735591483017286, 'f1-score': 0.3811217185740172, 'support': 1073150}}
[[239787  31425  16138]
 [323152 146776  35398]
 [171627  58256  50591]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0598899
{'0': {'precision': 0.3704930514013378, 'recall': 0.772768520046197, 'f1-score': 0.5008571514501399, 'support': 96976}, '1': {'precision': 0.5535714285714286, 'recall': 0.23235715748515257, 'f1-score': 0.327323082249084, 'support': 122075}, '2': {'precision': 0.48107764521807156, 'recall': 0.3080591967938549, 'f1-score': 0.3756012521314229, 'support': 95816}, 'accuracy': 0.4218352510742631, 'macro avg': {'precision': 0.468380708396946, 'recall': 0.4377282914417348, 'f1-score': 0.4012604952768823, 'support': 314867}, 'weighted avg': {'precision': 0.4751247413980126, 'recall': 0.4218352510742631, 'f1-score': 0.3954612517628399, 'support': 314867}}
[[74940  9259 12777]
 [74648 28365 19062]
 [52683 13616 29517]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0493222
{'0': {'precision': 0.3612946205518237, 'recall': 0.8329973440849893, 'f1-score': 0.5039931076541825, 'support': 31251}, '1': {'precision': 0.6033949507300582, 'recall': 0.21372159380413736, 'f1-score': 0.3156429310507008, 'support': 39252}, '2': {'precision': 0.49797421731123387, 'recall': 0.2555604561779346, 'f1-score': 0.33777481678880744, 'support': 31742}, 'accuracy': 0.415991002004988, 'macro avg': {'precision': 0.48755459619770525, 'recall': 0.43409313135568706, 'f1-score': 0.38580361849789696, 'support': 102245}, 'weighted avg': {'precision': 0.4966695134120443, 'recall': 0.415991002004988, 'f1-score': 0.3800826756458829, 'support': 102245}}
[[26032  1808  3411]
 [26096  8389  4767]
 [19924  3706  8112]]
training model: results/WBA/W7/deepLOB_L2/h30
Epoch 1/50
1230/1230 - 52s - loss: 3.2290 - accuracy30: 0.4095 - val_loss: 3.3277 - val_accuracy30: 0.3795 - 52s/epoch - 42ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.1037 - accuracy30: 0.4542 - val_loss: 3.3000 - val_accuracy30: 0.3939 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.0659 - accuracy30: 0.4682 - val_loss: 3.5033 - val_accuracy30: 0.3602 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 3.0442 - accuracy30: 0.4756 - val_loss: 3.2976 - val_accuracy30: 0.4085 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 51s - loss: 3.0286 - accuracy30: 0.4804 - val_loss: 3.2983 - val_accuracy30: 0.4080 - 51s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 3.0171 - accuracy30: 0.4839 - val_loss: 3.3361 - val_accuracy30: 0.3929 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.0069 - accuracy30: 0.4869 - val_loss: 3.3066 - val_accuracy30: 0.4024 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 2.9989 - accuracy30: 0.4901 - val_loss: 3.3691 - val_accuracy30: 0.3902 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 2.9908 - accuracy30: 0.4921 - val_loss: 3.4077 - val_accuracy30: 0.3875 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 2.9830 - accuracy30: 0.4950 - val_loss: 3.3807 - val_accuracy30: 0.3965 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 51s - loss: 2.9762 - accuracy30: 0.4965 - val_loss: 3.3573 - val_accuracy30: 0.3947 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.9689 - accuracy30: 0.4994 - val_loss: 3.3263 - val_accuracy30: 0.4137 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.9627 - accuracy30: 0.5015 - val_loss: 3.5038 - val_accuracy30: 0.3877 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 51s - loss: 2.9556 - accuracy30: 0.5036 - val_loss: 3.3998 - val_accuracy30: 0.4010 - 51s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h30
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1182058
{'0': {'precision': 0.3464043263145783, 'recall': 0.7065919794714525, 'f1-score': 0.46489530358870884, 'support': 319555}, '1': {'precision': 0.5267444365567928, 'recall': 0.3393160623647743, 'f1-score': 0.41274910542061144, 'support': 439543}, '2': {'precision': 0.40270802275260165, 'recall': 0.1771904015895457, 'f1-score': 0.2460982588659853, 'support': 314052}, 'accuracy': 0.4012356147789219, 'macro avg': {'precision': 0.42528559520799086, 'recall': 0.4076994811419241, 'f1-score': 0.3745808892917685, 'support': 1073150}, 'weighted avg': {'precision': 0.43674539843865023, 'recall': 0.4012356147789219, 'f1-score': 0.3795072908498925, 'support': 1073150}}
[[225795  58927  34833]
 [242697 149144  47702]
 [183333  75072  55647]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.117185
{'0': {'precision': 0.37813887550238384, 'recall': 0.7614614935272946, 'f1-score': 0.5053318702343772, 'support': 106138}, '1': {'precision': 0.4551589415734328, 'recall': 0.2223475318816691, 'f1-score': 0.298752768387924, 'support': 103743}, '2': {'precision': 0.44747012307509365, 'recall': 0.21505724572800183, 'f1-score': 0.2904987680371583, 'support': 104986}, 'accuracy': 0.40164577424753944, 'macro avg': {'precision': 0.42692264671697006, 'recall': 0.3996220903789885, 'f1-score': 0.3648611355531532, 'support': 314867}, 'weighted avg': {'precision': 0.4266326937560508, 'recall': 0.40164577424753944, 'f1-score': 0.3656360499987418, 'support': 314867}}
[[80820 12353 12965]
 [65762 23067 14914]
 [67149 15259 22578]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0970955
{'0': {'precision': 0.3738956538414125, 'recall': 0.8025224907391074, 'f1-score': 0.5101241812354584, 'support': 34014}, '1': {'precision': 0.5365769969805105, 'recall': 0.23047899778924097, 'f1-score': 0.3224529352331072, 'support': 33925}, '2': {'precision': 0.44013364243829267, 'recall': 0.18815950562583805, 'f1-score': 0.26362002777097115, 'support': 34306}, 'accuracy': 0.40658222895985136, 'macro avg': {'precision': 0.4502020977534052, 'recall': 0.4070536647180622, 'f1-score': 0.36539904807984563, 'support': 102245}, 'weighted avg': {'precision': 0.45009815765869915, 'recall': 0.40658222895985136, 'f1-score': 0.3651457616610786, 'support': 102245}}
[[27297  2763  3954]
 [21849  7819  4257]
 [23861  3990  6455]]
training model: results/WBA/W7/deepLOB_L2/h50
Epoch 1/50
1230/1230 - 52s - loss: 3.2522 - accuracy50: 0.3999 - val_loss: 3.4523 - val_accuracy50: 0.3455 - 52s/epoch - 42ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.1806 - accuracy50: 0.4292 - val_loss: 3.3899 - val_accuracy50: 0.3841 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.1552 - accuracy50: 0.4399 - val_loss: 3.4031 - val_accuracy50: 0.4006 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.1424 - accuracy50: 0.4453 - val_loss: 3.4804 - val_accuracy50: 0.3902 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.1326 - accuracy50: 0.4489 - val_loss: 3.4208 - val_accuracy50: 0.3916 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.1252 - accuracy50: 0.4511 - val_loss: 3.4663 - val_accuracy50: 0.3838 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.1171 - accuracy50: 0.4544 - val_loss: 3.4299 - val_accuracy50: 0.3842 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 51s - loss: 3.1099 - accuracy50: 0.4567 - val_loss: 3.4718 - val_accuracy50: 0.3892 - 51s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.1031 - accuracy50: 0.4597 - val_loss: 3.3981 - val_accuracy50: 0.3948 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.0966 - accuracy50: 0.4616 - val_loss: 3.4377 - val_accuracy50: 0.3906 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 51s - loss: 3.0914 - accuracy50: 0.4636 - val_loss: 3.4030 - val_accuracy50: 0.3858 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 3.0860 - accuracy50: 0.4663 - val_loss: 3.3986 - val_accuracy50: 0.3855 - 50s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h50
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1071649
{'0': {'precision': 0.3522887801931841, 'recall': 0.7482384648355952, 'f1-score': 0.47903587532475733, 'support': 324291}, '1': {'precision': 0.46168410447631564, 'recall': 0.37690106093084924, 'f1-score': 0.41500669453780364, 'support': 423119}, '2': {'precision': 0.46181883518570804, 'recall': 0.055234235893657516, 'f1-score': 0.09866766840600055, 'support': 325740}, 'accuracy': 0.39147649443227883, 'macro avg': {'precision': 0.4252639066184026, 'recall': 0.3934579205533673, 'f1-score': 0.3309034127561872, 'support': 1073150}, 'weighted avg': {'precision': 0.4286672550835714, 'recall': 0.39147649443227883, 'f1-score': 0.3383350388460629, 'support': 1073150}}
[[242647  72702   8942]
 [251620 159474  12025]
 [194506 113242  17992]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.115739
{'0': {'precision': 0.40918645042812574, 'recall': 0.522769030726178, 'f1-score': 0.4590562712537543, 'support': 106131}, '1': {'precision': 0.38725977953370405, 'recall': 0.5732176893013227, 'f1-score': 0.4622370918349525, 'support': 103882}, '2': {'precision': 0.4576849202304888, 'recall': 0.11135483624849792, 'f1-score': 0.17912783339086408, 'support': 104854}, 'accuracy': 0.40240800083844924, 'macro avg': {'precision': 0.4180437167307729, 'recall': 0.40244718542533287, 'f1-score': 0.3668070654931903, 'support': 314867}, 'weighted avg': {'precision': 0.4181028250459887, 'recall': 0.40240800083844924, 'f1-score': 0.3668866046324207, 'support': 314867}}
[[55482 42602  8047]
 [38547 59547  5788]
 [41562 51616 11676]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1294132
{'0': {'precision': 0.3887430325551337, 'recall': 0.562178738317757, 'f1-score': 0.4596446821720235, 'support': 34240}, '1': {'precision': 0.3752837618716701, 'recall': 0.4782583025830258, 'f1-score': 0.4205594133298721, 'support': 33875}, '2': {'precision': 0.41290930013599747, 'recall': 0.11564605918546733, 'f1-score': 0.1806862139211243, 'support': 34130}, 'accuracy': 0.38531957552936574, 'macro avg': {'precision': 0.3923120315209337, 'recall': 0.3853610333620834, 'f1-score': 0.3536301031410067, 'support': 102245}, 'weighted avg': {'precision': 0.3923506604893363, 'recall': 0.38531957552936574, 'f1-score': 0.35357723629759374, 'support': 102245}}
[[19249 12162  2829]
 [14891 16201  2783]
 [15376 14807  3947]]
training model: results/WBA/W7/deepLOB_L2/h100
Epoch 1/50
1230/1230 - 52s - loss: 3.2802 - accuracy100: 0.3813 - val_loss: 3.3790 - val_accuracy100: 0.3574 - 52s/epoch - 42ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.2282 - accuracy100: 0.4041 - val_loss: 3.3715 - val_accuracy100: 0.3616 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2104 - accuracy100: 0.4143 - val_loss: 3.4634 - val_accuracy100: 0.3601 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.1989 - accuracy100: 0.4205 - val_loss: 3.4290 - val_accuracy100: 0.3640 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.1911 - accuracy100: 0.4232 - val_loss: 3.4587 - val_accuracy100: 0.3596 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.1832 - accuracy100: 0.4274 - val_loss: 3.4846 - val_accuracy100: 0.3647 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 51s - loss: 3.1783 - accuracy100: 0.4295 - val_loss: 3.4623 - val_accuracy100: 0.3631 - 51s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.1723 - accuracy100: 0.4316 - val_loss: 3.4966 - val_accuracy100: 0.3638 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 51s - loss: 3.1665 - accuracy100: 0.4347 - val_loss: 3.4778 - val_accuracy100: 0.3596 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1604 - accuracy100: 0.4372 - val_loss: 3.5024 - val_accuracy100: 0.3638 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.1535 - accuracy100: 0.4402 - val_loss: 3.5013 - val_accuracy100: 0.3620 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 51s - loss: 3.1477 - accuracy100: 0.4429 - val_loss: 3.5280 - val_accuracy100: 0.3626 - 51s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h100
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1260259
{'0': {'precision': 0.29638471854489806, 'recall': 0.8983699009900991, 'f1-score': 0.44572016027490063, 'support': 315625}, '1': {'precision': 0.42876564222786, 'recall': 0.0930006849553618, 'f1-score': 0.15284810971910048, 'support': 430685}, '2': {'precision': 0.3266360006943239, 'recall': 0.023029616937951292, 'f1-score': 0.043025688513907465, 'support': 326840}, 'accuracy': 0.30855798350649954, 'macro avg': {'precision': 0.3505954538223606, 'recall': 0.3381334009611374, 'f1-score': 0.21386465283596953, 'support': 1073150}, 'weighted avg': {'precision': 0.35872624319114027, 'recall': 0.30855798350649954, 'f1-score': 0.20553727787822934, 'support': 1073150}}
[[283548  25861   6216]
 [381330  40054   9301]
 [291811  27502   7527]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1141357
{'0': {'precision': 0.34505112096575513, 'recall': 0.8401694661067787, 'f1-score': 0.4891940272441495, 'support': 106688}, '1': {'precision': 0.3904536355690885, 'recall': 0.13450462787603315, 'f1-score': 0.20008379565418402, 'support': 102963}, '2': {'precision': 0.4170319029660585, 'recall': 0.07777334245742093, 'f1-score': 0.13109790288213524, 'support': 105216}, 'accuracy': 0.3546513289738207, 'macro avg': {'precision': 0.3841788865003007, 'recall': 0.35081581214674423, 'f1-score': 0.2734585752601562, 'support': 314867}, 'weighted avg': {'precision': 0.38395106624438685, 'recall': 0.3546513289738207, 'f1-score': 0.2749921623422344, 'support': 314867}}
[[89636 10457  6595]
 [84270 13849  4844]
 [85870 11163  8183]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1245487
{'0': {'precision': 0.36268723451822044, 'recall': 0.892526063873683, 'f1-score': 0.5157813580472606, 'support': 36353}, '1': {'precision': 0.3442733397497594, 'recall': 0.12114336031428861, 'f1-score': 0.17922188541223036, 'support': 29527}, '2': {'precision': 0.37160751565762007, 'recall': 0.024474082221916677, 'f1-score': 0.04592363261093911, 'support': 36365}, 'accuracy': 0.36102498899701696, 'macro avg': {'precision': 0.3595226966418667, 'recall': 0.34604783546996276, 'f1-score': 0.24697562535681003, 'support': 102245}, 'weighted avg': {'precision': 0.36054218050879133, 'recall': 0.36102498899701696, 'f1-score': 0.25147535057514586, 'support': 102245}}
[[32446  3185   722]
 [25167  3577   783]
 [31847  3628   890]]
training model: results/WBA/W7/deepLOB_L2/h200
Epoch 1/50
1230/1230 - 53s - loss: 3.3069 - accuracy200: 0.3618 - val_loss: 3.3815 - val_accuracy200: 0.3247 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.2780 - accuracy200: 0.3729 - val_loss: 3.3812 - val_accuracy200: 0.3413 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 51s - loss: 3.2624 - accuracy200: 0.3827 - val_loss: 3.5076 - val_accuracy200: 0.3354 - 51s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 3.2514 - accuracy200: 0.3899 - val_loss: 3.4862 - val_accuracy200: 0.3424 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 51s - loss: 3.2448 - accuracy200: 0.3942 - val_loss: 3.5007 - val_accuracy200: 0.3448 - 51s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.2380 - accuracy200: 0.3994 - val_loss: 3.5249 - val_accuracy200: 0.3381 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.2316 - accuracy200: 0.4026 - val_loss: 3.4636 - val_accuracy200: 0.3433 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 51s - loss: 3.2243 - accuracy200: 0.4071 - val_loss: 3.4755 - val_accuracy200: 0.3469 - 51s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 51s - loss: 3.2185 - accuracy200: 0.4099 - val_loss: 3.4723 - val_accuracy200: 0.3402 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.2148 - accuracy200: 0.4129 - val_loss: 3.4150 - val_accuracy200: 0.3442 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.2066 - accuracy200: 0.4162 - val_loss: 3.4073 - val_accuracy200: 0.3451 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 51s - loss: 3.2007 - accuracy200: 0.4188 - val_loss: 3.4808 - val_accuracy200: 0.3367 - 51s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h200
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1398395
{'0': {'precision': 0.3153325044154827, 'recall': 0.9653208207956958, 'f1-score': 0.47537772478078155, 'support': 338647}, '1': {'precision': 0.30742176932094867, 'recall': 0.026808042150515087, 'f1-score': 0.0493156233650065, 'support': 381490}, '2': {'precision': 0.31974921630094044, 'recall': 0.002889412004657052, 'f1-score': 0.005727071360993591, 'support': 353013}, 'accuracy': 0.3151004053487397, 'macro avg': {'precision': 0.31416783001245724, 'recall': 0.33167275831695603, 'f1-score': 0.17680680650226055, 'support': 1073150}, 'weighted avg': {'precision': 0.313973226012284, 'recall': 0.3151004053487397, 'f1-score': 0.16942681653423294, 'support': 1073150}}
[[326903  10722   1022]
 [370115  10227   1148]
 [339675  12318   1020]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223017
{'0': {'precision': 0.3485062544009544, 'recall': 0.7190819914862113, 'f1-score': 0.4694779516831157, 'support': 108060}, '1': {'precision': 0.3347354715941811, 'recall': 0.2644812851151381, 'f1-score': 0.2954899598837402, 'support': 101096}, '2': {'precision': 0.35747546981539996, 'recall': 0.040667480205465845, 'f1-score': 0.07302717072797846, 'support': 105711}, 'accuracy': 0.34535534050884975, 'macro avg': {'precision': 0.34690573193684515, 'recall': 0.3414102522689384, 'f1-score': 0.2793316940982781, 'support': 314867}, 'weighted avg': {'precision': 0.34709605159165047, 'recall': 0.34535534050884975, 'f1-score': 0.28051340943353675, 'support': 314867}}
[[77704 26337  4019]
 [70650 26738  3708]
 [74609 26803  4299]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1262411
{'0': {'precision': 0.3409198672356567, 'recall': 0.8413292768546689, 'f1-score': 0.4852206775543258, 'support': 34184}, '1': {'precision': 0.3396156230626162, 'recall': 0.1622966847391343, 'f1-score': 0.21963394342762063, 'support': 33753}, '2': {'precision': 0.28717948717948716, 'recall': 0.014690451206715634, 'f1-score': 0.027951085600199647, 'support': 34308}, 'accuracy': 0.3397916768546139, 'macro avg': {'precision': 0.3225716591592534, 'recall': 0.33943880426683964, 'f1-score': 0.24426856886071535, 'support': 102245}, 'weighted avg': {'precision': 0.3224568899503156, 'recall': 0.3397916768546139, 'f1-score': 0.24411006874469365, 'support': 102245}}
[[28760  4938   486]
 [27510  5478   765]
 [28090  5714   504]]
training model: results/WBA/W7/deepLOB_L2/h300
Epoch 1/50
1230/1230 - 53s - loss: 3.2735 - accuracy300: 0.3923 - val_loss: 3.5887 - val_accuracy300: 0.3318 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.2429 - accuracy300: 0.4032 - val_loss: 3.4123 - val_accuracy300: 0.3374 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2143 - accuracy300: 0.4195 - val_loss: 3.3206 - val_accuracy300: 0.3470 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.2088 - accuracy300: 0.4218 - val_loss: 3.4540 - val_accuracy300: 0.3424 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.1965 - accuracy300: 0.4287 - val_loss: 3.3836 - val_accuracy300: 0.3503 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.1834 - accuracy300: 0.4353 - val_loss: 3.4295 - val_accuracy300: 0.3468 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 51s - loss: 3.1723 - accuracy300: 0.4399 - val_loss: 3.3740 - val_accuracy300: 0.3445 - 51s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.1632 - accuracy300: 0.4445 - val_loss: 3.4347 - val_accuracy300: 0.3424 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.1533 - accuracy300: 0.4472 - val_loss: 3.3615 - val_accuracy300: 0.3351 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1446 - accuracy300: 0.4512 - val_loss: 3.3661 - val_accuracy300: 0.3451 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.1358 - accuracy300: 0.4541 - val_loss: 3.3719 - val_accuracy300: 0.3475 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 3.1290 - accuracy300: 0.4571 - val_loss: 3.3953 - val_accuracy300: 0.3402 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 3.1204 - accuracy300: 0.4593 - val_loss: 3.4185 - val_accuracy300: 0.3432 - 50s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h300
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970978
{'0': {'precision': 0.26882006154910953, 'recall': 0.30304676914288503, 'f1-score': 0.2849091668235815, 'support': 287091}, '1': {'precision': 0.4529300847283177, 'recall': 0.5672965263181778, 'f1-score': 0.5037031203642318, 'support': 484817}, '2': {'precision': 0.28220087017030876, 'recall': 0.13327822813551896, 'f1-score': 0.181049935402119, 'support': 301242}, 'accuracy': 0.37477146717607046, 'macro avg': {'precision': 0.33465033881591194, 'recall': 0.33454050786552725, 'f1-score': 0.32322074086331076, 'support': 1073150}, 'weighted avg': {'precision': 0.35575155356638716, 'recall': 0.37477146717607046, 'f1-score': 0.35459957877144826, 'support': 1073150}}
[[ 87002 162112  37977]
 [145637 275035  64145]
 [ 91005 170088  40149]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041503
{'0': {'precision': 0.3545313107740179, 'recall': 0.4719566544002071, 'f1-score': 0.40490223297505257, 'support': 108154}, '1': {'precision': 0.3487070331223749, 'recall': 0.42105159897979205, 'f1-score': 0.38147972039159395, 'support': 101940}, '2': {'precision': 0.3440232626249948, 'recall': 0.15695837668101514, 'f1-score': 0.21556611502539733, 'support': 104773}, 'accuracy': 0.35065916720393053, 'macro avg': {'precision': 0.34908720217379585, 'recall': 0.3499888766870048, 'f1-score': 0.3339826894640146, 'support': 314867}, 'weighted avg': {'precision': 0.3491490808403441, 'recall': 0.35065916720393053, 'f1-score': 0.334316861949518, 'support': 314867}}
[[51044 40748 16362]
 [44023 42922 14995]
 [48909 39419 16445]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055577
{'0': {'precision': 0.333136951665562, 'recall': 0.4070607996640571, 'f1-score': 0.3664074734056914, 'support': 33339}, '1': {'precision': 0.3587626273211217, 'recall': 0.4881651742428563, 'f1-score': 0.4135781589755979, 'support': 35066}, '2': {'precision': 0.33449325793823403, 'recall': 0.13634751773049644, 'f1-score': 0.193727169668724, 'support': 33840}, 'accuracy': 0.3452784977260502, 'macro avg': {'precision': 0.34213094564163926, 'recall': 0.3438578305458033, 'f1-score': 0.3245709340166711, 'support': 102245}, 'weighted avg': {'precision': 0.3423744434432047, 'recall': 0.3452784977260502, 'f1-score': 0.3254332035806179, 'support': 102245}}
[[13571 15259  4509]
 [13277 17118  4671]
 [13889 15337  4614]]
training model: results/WBA/W7/deepLOB_L2/h500
Epoch 1/50
1230/1230 - 54s - loss: 3.2950 - accuracy500: 0.3805 - val_loss: 3.4824 - val_accuracy500: 0.3407 - 54s/epoch - 44ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.2657 - accuracy500: 0.3879 - val_loss: 3.3564 - val_accuracy500: 0.3477 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2262 - accuracy500: 0.4164 - val_loss: 3.4946 - val_accuracy500: 0.3426 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 3.2032 - accuracy500: 0.4265 - val_loss: 3.3385 - val_accuracy500: 0.3533 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 51s - loss: 3.1883 - accuracy500: 0.4351 - val_loss: 3.3938 - val_accuracy500: 0.3554 - 51s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.1708 - accuracy500: 0.4420 - val_loss: 3.4966 - val_accuracy500: 0.3531 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 51s - loss: 3.1616 - accuracy500: 0.4457 - val_loss: 3.4620 - val_accuracy500: 0.3558 - 51s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 51s - loss: 3.1486 - accuracy500: 0.4519 - val_loss: 3.5050 - val_accuracy500: 0.3530 - 51s/epoch - 42ms/step
Epoch 9/50
1230/1230 - 51s - loss: 3.1385 - accuracy500: 0.4548 - val_loss: 3.6075 - val_accuracy500: 0.3521 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1301 - accuracy500: 0.4573 - val_loss: 3.5102 - val_accuracy500: 0.3548 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 51s - loss: 3.1242 - accuracy500: 0.4594 - val_loss: 3.4953 - val_accuracy500: 0.3502 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 3.1128 - accuracy500: 0.4648 - val_loss: 3.5533 - val_accuracy500: 0.3489 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 3.1036 - accuracy500: 0.4673 - val_loss: 3.5749 - val_accuracy500: 0.3465 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 50s - loss: 3.0934 - accuracy500: 0.4709 - val_loss: 3.5243 - val_accuracy500: 0.3354 - 50s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h500
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1156334
{'0': {'precision': 0.29006898917517915, 'recall': 0.5888349420662707, 'f1-score': 0.38867218671995196, 'support': 310182}, '1': {'precision': 0.40811820970702106, 'recall': 0.3541471466933262, 'f1-score': 0.379222007842161, 'support': 430115}, '2': {'precision': 0.3136325461559266, 'recall': 0.06619438611038507, 'f1-score': 0.10931670238945781, 'support': 332853}, 'accuracy': 0.3326683129105903, 'macro avg': {'precision': 0.3372732483460423, 'recall': 0.336392158289994, 'f1-score': 0.29240363231719024, 'support': 1073150}, 'weighted avg': {'precision': 0.34469130769613704, 'recall': 0.3326683129105903, 'f1-score': 0.2982384405391953, 'support': 1073150}}
[[182646 106144  21392]
 [250965 152324  26826]
 [196053 114767  22033]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091408
{'0': {'precision': 0.349293100940746, 'recall': 0.4325513057490876, 'f1-score': 0.386489141850459, 'support': 105495}, '1': {'precision': 0.36855576736921497, 'recall': 0.5814944951979386, 'f1-score': 0.451161708685917, 'support': 106725}, '2': {'precision': 0.3620809394532483, 'recall': 0.055871092189737646, 'f1-score': 0.09680468578566245, 'support': 102647}, 'accuracy': 0.36023781469636385, 'macro avg': {'precision': 0.35997660258773645, 'recall': 0.35663896437892134, 'f1-score': 0.3114851787740128, 'support': 314867}, 'weighted avg': {'precision': 0.3599910824198187, 'recall': 0.36023781469636385, 'f1-score': 0.31397261688541367, 'support': 314867}}
[[45632 54470  5393]
 [39954 62060  4711]
 [45055 51857  5735]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097034
{'0': {'precision': 0.33314834660134723, 'recall': 0.5350195150434863, 'f1-score': 0.4106138333628162, 'support': 32539}, '1': {'precision': 0.3812898337567411, 'recall': 0.47908383267066135, 'f1-score': 0.424628977018911, 'support': 35714}, '2': {'precision': 0.34545454545454546, 'recall': 0.0519828194869381, 'f1-score': 0.09036745339709003, 'support': 33992}, 'accuracy': 0.3548926597877647, 'macro avg': {'precision': 0.35329757527087796, 'recall': 0.3553620557336952, 'f1-score': 0.3085367545929391, 'support': 102245}, 'weighted avg': {'precision': 0.3540553580315947, 'recall': 0.3548926597877647, 'f1-score': 0.3090413544419771, 'support': 102245}}
[[17409 13427  1703]
 [16959 17110  1645]
 [17888 14337  1767]]
training model: results/WBA/W7/deepLOB_L2/h1000
Epoch 1/50
1230/1230 - 53s - loss: 3.2867 - accuracy1000: 0.3889 - val_loss: 3.4790 - val_accuracy1000: 0.3300 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.2164 - accuracy1000: 0.4196 - val_loss: 3.5095 - val_accuracy1000: 0.3245 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.1870 - accuracy1000: 0.4332 - val_loss: 3.5192 - val_accuracy1000: 0.3234 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 3.1668 - accuracy1000: 0.4416 - val_loss: 3.4920 - val_accuracy1000: 0.3266 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.1507 - accuracy1000: 0.4484 - val_loss: 3.5591 - val_accuracy1000: 0.3264 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 3.1371 - accuracy1000: 0.4535 - val_loss: 3.5314 - val_accuracy1000: 0.3257 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.1293 - accuracy1000: 0.4562 - val_loss: 3.6920 - val_accuracy1000: 0.3278 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.1127 - accuracy1000: 0.4623 - val_loss: 3.8760 - val_accuracy1000: 0.3280 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.1001 - accuracy1000: 0.4671 - val_loss: 3.8622 - val_accuracy1000: 0.3270 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.0919 - accuracy1000: 0.4704 - val_loss: 3.9239 - val_accuracy1000: 0.3292 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.0824 - accuracy1000: 0.4748 - val_loss: 3.8930 - val_accuracy1000: 0.3261 - 50s/epoch - 41ms/step
testing model: results/WBA/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1483477
{'0': {'precision': 0.2910164451597088, 'recall': 0.43594156621697133, 'f1-score': 0.349032992036405, 'support': 313175}, '1': {'precision': 0.3870612543760445, 'recall': 0.4995034947716677, 'f1-score': 0.43615189852157593, 'support': 415907}, '2': {'precision': 0.32330648277502005, 'recall': 0.0632258739551484, 'f1-score': 0.1057677815215119, 'support': 344068}, 'accuracy': 0.341077202627778, 'macro avg': {'precision': 0.33379472743692445, 'recall': 0.3328903116479292, 'f1-score': 0.2969842240264976, 'support': 1073150}, 'weighted avg': {'precision': 0.3385919724662022, 'recall': 0.341077202627778, 'f1-score': 0.3048020723961774, 'support': 1073150}}
[[136526 156673  19976]
 [182604 207747  25556]
 [150005 172309  21754]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1496406
{'0': {'precision': 0.34637668039650565, 'recall': 0.4223272840993755, 'f1-score': 0.38059989141111666, 'support': 108719}, '1': {'precision': 0.3238500511491922, 'recall': 0.5221902298570104, 'f1-score': 0.3997713500063514, 'support': 102455}, '2': {'precision': 0.34981877703729686, 'recall': 0.0577088135168237, 'f1-score': 0.09907366782837605, 'support': 103693}, 'accuracy': 0.33474451117455944, 'macro avg': {'precision': 0.3400151695276649, 'recall': 0.33407544249106985, 'f1-score': 0.293148303081948, 'support': 314867}, 'weighted avg': {'precision': 0.34018027215886903, 'recall': 0.33474451117455944, 'f1-score': 0.29412500864604335, 'support': 314867}}
[[45915 57220  5584]
 [43416 53501  5538]
 [43227 54482  5984]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.157857
{'0': {'precision': 0.3196583495863878, 'recall': 0.4327597195666029, 'f1-score': 0.3677084945071948, 'support': 32949}, '1': {'precision': 0.3339787763160393, 'recall': 0.5101786335691915, 'f1-score': 0.40368972361491956, 'support': 34484}, '2': {'precision': 0.34327756500705503, 'recall': 0.048919912673790644, 'f1-score': 0.08563598421039398, 'support': 34812}, 'accuracy': 0.3281823072032862, 'macro avg': {'precision': 0.3323048969698274, 'recall': 0.3306194219365284, 'f1-score': 0.28567806744416946, 'support': 102245}, 'weighted avg': {'precision': 0.33252995917677924, 'recall': 0.3281823072032862, 'f1-score': 0.28380481683198866, 'support': 102245}}
[[14259 17154  1536]
 [15169 17593  1722]
 [15179 17930  1703]]
training model: results/WBA/W7/deepOF_L2/h10
Epoch 1/50
1230/1230 - 30s - loss: 3.0911 - accuracy10: 0.4399 - val_loss: 3.1169 - val_accuracy10: 0.5475 - 30s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 29s - loss: 2.9165 - accuracy10: 0.5045 - val_loss: 3.1282 - val_accuracy10: 0.5594 - 29s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 28s - loss: 2.8552 - accuracy10: 0.5221 - val_loss: 3.0644 - val_accuracy10: 0.5659 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 28s - loss: 2.8190 - accuracy10: 0.5305 - val_loss: 3.0276 - val_accuracy10: 0.5706 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 28s - loss: 2.7972 - accuracy10: 0.5346 - val_loss: 2.9972 - val_accuracy10: 0.5716 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 28s - loss: 2.7803 - accuracy10: 0.5380 - val_loss: 2.9849 - val_accuracy10: 0.5727 - 28s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.7694 - accuracy10: 0.5404 - val_loss: 2.9543 - val_accuracy10: 0.5699 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.7594 - accuracy10: 0.5416 - val_loss: 2.9575 - val_accuracy10: 0.5734 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.7508 - accuracy10: 0.5441 - val_loss: 2.9553 - val_accuracy10: 0.5737 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 28s - loss: 2.7416 - accuracy10: 0.5453 - val_loss: 2.9300 - val_accuracy10: 0.5707 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 28s - loss: 2.7346 - accuracy10: 0.5475 - val_loss: 2.9347 - val_accuracy10: 0.5721 - 28s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 28s - loss: 2.7273 - accuracy10: 0.5483 - val_loss: 2.9182 - val_accuracy10: 0.5705 - 28s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 2.7208 - accuracy10: 0.5499 - val_loss: 2.9163 - val_accuracy10: 0.5703 - 28s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.7157 - accuracy10: 0.5509 - val_loss: 2.9087 - val_accuracy10: 0.5696 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.7105 - accuracy10: 0.5521 - val_loss: 2.9146 - val_accuracy10: 0.5698 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.7023 - accuracy10: 0.5532 - val_loss: 2.8991 - val_accuracy10: 0.5692 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.6991 - accuracy10: 0.5539 - val_loss: 2.9005 - val_accuracy10: 0.5670 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 28s - loss: 2.6935 - accuracy10: 0.5545 - val_loss: 2.9093 - val_accuracy10: 0.5676 - 28s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.6891 - accuracy10: 0.5552 - val_loss: 2.9028 - val_accuracy10: 0.5670 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.6826 - accuracy10: 0.5569 - val_loss: 2.8996 - val_accuracy10: 0.5702 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 28s - loss: 2.6786 - accuracy10: 0.5583 - val_loss: 2.9014 - val_accuracy10: 0.5671 - 28s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 28s - loss: 2.6728 - accuracy10: 0.5592 - val_loss: 2.9009 - val_accuracy10: 0.5620 - 28s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.6691 - accuracy10: 0.5601 - val_loss: 2.8892 - val_accuracy10: 0.5623 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 27s - loss: 2.6638 - accuracy10: 0.5602 - val_loss: 2.8956 - val_accuracy10: 0.5641 - 27s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 28s - loss: 2.6600 - accuracy10: 0.5605 - val_loss: 2.8878 - val_accuracy10: 0.5622 - 28s/epoch - 22ms/step
Epoch 26/50
1230/1230 - 28s - loss: 2.6565 - accuracy10: 0.5612 - val_loss: 2.8720 - val_accuracy10: 0.5574 - 28s/epoch - 22ms/step
Epoch 27/50
1230/1230 - 27s - loss: 2.6515 - accuracy10: 0.5627 - val_loss: 2.8832 - val_accuracy10: 0.5620 - 27s/epoch - 22ms/step
Epoch 28/50
1230/1230 - 27s - loss: 2.6479 - accuracy10: 0.5632 - val_loss: 2.8832 - val_accuracy10: 0.5562 - 27s/epoch - 22ms/step
Epoch 29/50
1230/1230 - 27s - loss: 2.6453 - accuracy10: 0.5633 - val_loss: 2.8894 - val_accuracy10: 0.5608 - 27s/epoch - 22ms/step
Epoch 30/50
1230/1230 - 27s - loss: 2.6405 - accuracy10: 0.5641 - val_loss: 2.8851 - val_accuracy10: 0.5628 - 27s/epoch - 22ms/step
Epoch 31/50
1230/1230 - 27s - loss: 2.6372 - accuracy10: 0.5644 - val_loss: 2.8968 - val_accuracy10: 0.5628 - 27s/epoch - 22ms/step
Epoch 32/50
1230/1230 - 28s - loss: 2.6307 - accuracy10: 0.5666 - val_loss: 2.8943 - val_accuracy10: 0.5567 - 28s/epoch - 23ms/step
Epoch 33/50
1230/1230 - 28s - loss: 2.6276 - accuracy10: 0.5665 - val_loss: 2.8805 - val_accuracy10: 0.5560 - 28s/epoch - 23ms/step
Epoch 34/50
1230/1230 - 28s - loss: 2.6238 - accuracy10: 0.5676 - val_loss: 2.8899 - val_accuracy10: 0.5537 - 28s/epoch - 22ms/step
Epoch 35/50
1230/1230 - 27s - loss: 2.6195 - accuracy10: 0.5682 - val_loss: 2.8870 - val_accuracy10: 0.5552 - 27s/epoch - 22ms/step
Epoch 36/50
1230/1230 - 27s - loss: 2.6145 - accuracy10: 0.5686 - val_loss: 2.8985 - val_accuracy10: 0.5500 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h10
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84374624
{'0': {'precision': 0.4588523873744755, 'recall': 0.4347808663825922, 'f1-score': 0.44649242334177724, 'support': 224589}, '1': {'precision': 0.7308869922517413, 'recall': 0.6994527274690789, 'f1-score': 0.7148244478618466, 'support': 629668}, '2': {'precision': 0.4304192806235475, 'recall': 0.5068391140674683, 'f1-score': 0.4655137326152497, 'support': 218888}, 'accuracy': 0.6047747508491397, 'macro avg': {'precision': 0.5400528867499214, 'recall': 0.5470242359730465, 'f1-score': 0.5422768679396245, 'support': 1073145}, 'weighted avg': {'precision': 0.6126692711258428, 'recall': 0.6047747508491397, 'f1-score': 0.6078160334408366, 'support': 1073145}}
[[ 97647  88955  37987]
 [ 80422 440423 108823]
 [ 34738  73209 110941]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.882628
{'0': {'precision': 0.4975644909452444, 'recall': 0.4793396929880949, 'f1-score': 0.48828209409684703, 'support': 77782}, '1': {'precision': 0.672279313206102, 'recall': 0.6551998706097516, 'f1-score': 0.6636297192398811, 'support': 160754}, '2': {'precision': 0.4722208877786318, 'recall': 0.5151118156450197, 'f1-score': 0.49273473479745605, 'support': 76331}, 'accuracy': 0.5777963394067972, 'macro avg': {'precision': 0.5473548973099928, 'recall': 0.5498837930809555, 'f1-score': 0.5482155160447281, 'support': 314867}, 'weighted avg': {'precision': 0.5806205240144806, 'recall': 0.5777963394067972, 'f1-score': 0.5788844965383906, 'support': 314867}}
[[ 37284  27555  12943]
 [ 24426 105326  31002]
 [ 13223  23789  39319]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9111646
{'0': {'precision': 0.465989263803681, 'recall': 0.48335520820904426, 'f1-score': 0.47451340218261323, 'support': 25143}, '1': {'precision': 0.6723449840362964, 'recall': 0.6231553946190087, 'f1-score': 0.6468163356032899, 'support': 51366}, '2': {'precision': 0.453233883110971, 'recall': 0.5029142057817843, 'f1-score': 0.47678337907280866, 'support': 25736}, 'accuracy': 0.5585114186512788, 'macro avg': {'precision': 0.5305227103169828, 'recall': 0.536474936203279, 'f1-score': 0.5327043722862372, 'support': 102245}, 'weighted avg': {'precision': 0.5664479214198083, 'recall': 0.5585114186512788, 'f1-score': 0.5616465881900713, 'support': 102245}}
[[12153  8104  4886]
 [ 8629 32009 10728]
 [ 5298  7495 12943]]
training model: results/WBA/W7/deepOF_L2/h20
Epoch 1/50
1230/1230 - 29s - loss: 3.1512 - accuracy20: 0.4313 - val_loss: 3.2080 - val_accuracy20: 0.4612 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.0014 - accuracy20: 0.4881 - val_loss: 3.2395 - val_accuracy20: 0.4683 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.9459 - accuracy20: 0.5050 - val_loss: 3.1432 - val_accuracy20: 0.4838 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 2.9116 - accuracy20: 0.5157 - val_loss: 3.1178 - val_accuracy20: 0.4900 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.8941 - accuracy20: 0.5192 - val_loss: 3.0788 - val_accuracy20: 0.4989 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 2.8796 - accuracy20: 0.5233 - val_loss: 3.0917 - val_accuracy20: 0.4969 - 28s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.8677 - accuracy20: 0.5256 - val_loss: 3.0511 - val_accuracy20: 0.5032 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.8591 - accuracy20: 0.5275 - val_loss: 3.0506 - val_accuracy20: 0.5050 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 2.8503 - accuracy20: 0.5298 - val_loss: 3.0360 - val_accuracy20: 0.5067 - 28s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 28s - loss: 2.8426 - accuracy20: 0.5314 - val_loss: 3.0145 - val_accuracy20: 0.5099 - 28s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 28s - loss: 2.8360 - accuracy20: 0.5334 - val_loss: 3.0191 - val_accuracy20: 0.5098 - 28s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.8289 - accuracy20: 0.5351 - val_loss: 3.0193 - val_accuracy20: 0.5117 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.8229 - accuracy20: 0.5359 - val_loss: 3.0083 - val_accuracy20: 0.5132 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.8176 - accuracy20: 0.5373 - val_loss: 3.0066 - val_accuracy20: 0.5147 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.8124 - accuracy20: 0.5383 - val_loss: 2.9989 - val_accuracy20: 0.5142 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.8079 - accuracy20: 0.5389 - val_loss: 2.9939 - val_accuracy20: 0.5154 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.8038 - accuracy20: 0.5400 - val_loss: 2.9931 - val_accuracy20: 0.5158 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.7975 - accuracy20: 0.5421 - val_loss: 3.0023 - val_accuracy20: 0.5166 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 28s - loss: 2.7938 - accuracy20: 0.5429 - val_loss: 2.9970 - val_accuracy20: 0.5153 - 28s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.7881 - accuracy20: 0.5439 - val_loss: 3.0032 - val_accuracy20: 0.5159 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 28s - loss: 2.7844 - accuracy20: 0.5450 - val_loss: 3.0062 - val_accuracy20: 0.5162 - 28s/epoch - 23ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.7796 - accuracy20: 0.5452 - val_loss: 2.9948 - val_accuracy20: 0.5164 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.7761 - accuracy20: 0.5467 - val_loss: 3.0079 - val_accuracy20: 0.5161 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 28s - loss: 2.7725 - accuracy20: 0.5461 - val_loss: 3.0017 - val_accuracy20: 0.5176 - 28s/epoch - 23ms/step
Epoch 25/50
1230/1230 - 28s - loss: 2.7679 - accuracy20: 0.5480 - val_loss: 2.9931 - val_accuracy20: 0.5175 - 28s/epoch - 22ms/step
Epoch 26/50
1230/1230 - 28s - loss: 2.7629 - accuracy20: 0.5487 - val_loss: 2.9887 - val_accuracy20: 0.5176 - 28s/epoch - 23ms/step
Epoch 27/50
1230/1230 - 27s - loss: 2.7588 - accuracy20: 0.5506 - val_loss: 3.0048 - val_accuracy20: 0.5166 - 27s/epoch - 22ms/step
Epoch 28/50
1230/1230 - 28s - loss: 2.7553 - accuracy20: 0.5509 - val_loss: 3.0077 - val_accuracy20: 0.5158 - 28s/epoch - 22ms/step
Epoch 29/50
1230/1230 - 27s - loss: 2.7515 - accuracy20: 0.5521 - val_loss: 3.0173 - val_accuracy20: 0.5156 - 27s/epoch - 22ms/step
Epoch 30/50
1230/1230 - 27s - loss: 2.7466 - accuracy20: 0.5527 - val_loss: 2.9974 - val_accuracy20: 0.5153 - 27s/epoch - 22ms/step
Epoch 31/50
1230/1230 - 28s - loss: 2.7425 - accuracy20: 0.5545 - val_loss: 3.0084 - val_accuracy20: 0.5156 - 28s/epoch - 22ms/step
Epoch 32/50
1230/1230 - 27s - loss: 2.7388 - accuracy20: 0.5553 - val_loss: 3.0159 - val_accuracy20: 0.5130 - 27s/epoch - 22ms/step
Epoch 33/50
1230/1230 - 27s - loss: 2.7334 - accuracy20: 0.5561 - val_loss: 3.0096 - val_accuracy20: 0.5117 - 27s/epoch - 22ms/step
Epoch 34/50
1230/1230 - 28s - loss: 2.7301 - accuracy20: 0.5574 - val_loss: 3.0243 - val_accuracy20: 0.5089 - 28s/epoch - 23ms/step
Epoch 35/50
1230/1230 - 27s - loss: 2.7261 - accuracy20: 0.5591 - val_loss: 3.0263 - val_accuracy20: 0.5115 - 27s/epoch - 22ms/step
Epoch 36/50
1230/1230 - 28s - loss: 2.7221 - accuracy20: 0.5589 - val_loss: 3.0244 - val_accuracy20: 0.5110 - 28s/epoch - 23ms/step
testing model: results/WBA/W7/deepOF_L2/h20
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92041457
{'0': {'precision': 0.4853647072756409, 'recall': 0.45640636582250727, 'f1-score': 0.4704403192538786, 'support': 287347}, '1': {'precision': 0.6072499714951889, 'recall': 0.7272230742591401, 'f1-score': 0.6618435531830208, 'support': 505325}, '2': {'precision': 0.5226740687932613, 'recall': 0.36857380211285934, 'f1-score': 0.4323016639693552, 'support': 280473}, 'accuracy': 0.5609735869803242, 'macro avg': {'precision': 0.5384295825213637, 'recall': 0.5174010807315023, 'f1-score': 0.5215285121354182, 'support': 1073145}, 'weighted avg': {'precision': 0.5525093519365905, 'recall': 0.5609735869803242, 'f1-score': 0.5506009463095213, 'support': 1073145}}
[[131147 117955  38245]
 [ 81680 367484  56161]
 [ 57376 119722 103375]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95503813
{'0': {'precision': 0.5220559818914592, 'recall': 0.48724184838616597, 'f1-score': 0.5040484858822714, 'support': 97036}, '1': {'precision': 0.5345918386929627, 'recall': 0.6845485300502134, 'f1-score': 0.6003476986515902, 'support': 122079}, '2': {'precision': 0.5534503302490476, 'recall': 0.392921296683098, 'f1-score': 0.4595708815068619, 'support': 95752}, 'accuracy': 0.5350576592656582, 'macro avg': {'precision': 0.5366993836111565, 'recall': 0.5215705583731591, 'f1-score': 0.5213223553469079, 'support': 314867}, 'weighted avg': {'precision': 0.5364634507796137, 'recall': 0.5350576592656582, 'f1-score': 0.5278594664598215, 'support': 314867}}
[[47280 35674 14082]
 [22236 83569 16274]
 [21049 37080 37623]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97844505
{'0': {'precision': 0.48696980303560633, 'recall': 0.4898220458327999, 'f1-score': 0.48839176014424535, 'support': 31244}, '1': {'precision': 0.5352305521033008, 'recall': 0.6471487150752617, 'f1-score': 0.5858928242021768, 'support': 39263}, '2': {'precision': 0.5200685371599915, 'recall': 0.38253828218539293, 'f1-score': 0.4408256630902456, 'support': 31738}, 'accuracy': 0.5169348134383099, 'macro avg': {'precision': 0.5140896307662995, 'recall': 0.5065030143644849, 'f1-score': 0.505036749145556, 'support': 102245}, 'weighted avg': {'precision': 0.5157765849250349, 'recall': 0.5169348134383099, 'f1-score': 0.5110679936012037, 'support': 102245}}
[[15304 10487  5453]
 [ 8103 25409  5751]
 [ 8020 11577 12141]]
training model: results/WBA/W7/deepOF_L2/h30
Epoch 1/50
1230/1230 - 30s - loss: 3.1904 - accuracy30: 0.4186 - val_loss: 3.2137 - val_accuracy30: 0.4157 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.0653 - accuracy30: 0.4708 - val_loss: 3.2626 - val_accuracy30: 0.4219 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.0213 - accuracy30: 0.4836 - val_loss: 3.2002 - val_accuracy30: 0.4338 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 28s - loss: 2.9900 - accuracy30: 0.4939 - val_loss: 3.1547 - val_accuracy30: 0.4443 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.9676 - accuracy30: 0.5013 - val_loss: 3.1229 - val_accuracy30: 0.4540 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.9538 - accuracy30: 0.5055 - val_loss: 3.1060 - val_accuracy30: 0.4611 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.9434 - accuracy30: 0.5074 - val_loss: 3.0855 - val_accuracy30: 0.4679 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 28s - loss: 2.9351 - accuracy30: 0.5110 - val_loss: 3.0833 - val_accuracy30: 0.4704 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 28s - loss: 2.9266 - accuracy30: 0.5117 - val_loss: 3.0620 - val_accuracy30: 0.4749 - 28s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.9208 - accuracy30: 0.5136 - val_loss: 3.0465 - val_accuracy30: 0.4796 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.9144 - accuracy30: 0.5152 - val_loss: 3.0565 - val_accuracy30: 0.4788 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.9088 - accuracy30: 0.5175 - val_loss: 3.0493 - val_accuracy30: 0.4782 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 2.9030 - accuracy30: 0.5181 - val_loss: 3.0602 - val_accuracy30: 0.4785 - 28s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 28s - loss: 2.8972 - accuracy30: 0.5201 - val_loss: 3.0505 - val_accuracy30: 0.4829 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 28s - loss: 2.8933 - accuracy30: 0.5213 - val_loss: 3.0403 - val_accuracy30: 0.4853 - 28s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 28s - loss: 2.8876 - accuracy30: 0.5226 - val_loss: 3.0330 - val_accuracy30: 0.4863 - 28s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.8830 - accuracy30: 0.5246 - val_loss: 3.0449 - val_accuracy30: 0.4858 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 28s - loss: 2.8783 - accuracy30: 0.5257 - val_loss: 3.0432 - val_accuracy30: 0.4857 - 28s/epoch - 23ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.8762 - accuracy30: 0.5260 - val_loss: 3.0408 - val_accuracy30: 0.4866 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 28s - loss: 2.8702 - accuracy30: 0.5270 - val_loss: 3.0367 - val_accuracy30: 0.4877 - 28s/epoch - 23ms/step
Epoch 21/50
1230/1230 - 27s - loss: 2.8662 - accuracy30: 0.5284 - val_loss: 3.0444 - val_accuracy30: 0.4860 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.8606 - accuracy30: 0.5304 - val_loss: 3.0686 - val_accuracy30: 0.4820 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.8573 - accuracy30: 0.5308 - val_loss: 3.0460 - val_accuracy30: 0.4873 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 28s - loss: 2.8540 - accuracy30: 0.5323 - val_loss: 3.0639 - val_accuracy30: 0.4847 - 28s/epoch - 23ms/step
Epoch 25/50
1230/1230 - 28s - loss: 2.8494 - accuracy30: 0.5332 - val_loss: 3.0676 - val_accuracy30: 0.4846 - 28s/epoch - 22ms/step
Epoch 26/50
1230/1230 - 27s - loss: 2.8435 - accuracy30: 0.5346 - val_loss: 3.0588 - val_accuracy30: 0.4839 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h30
Evaluating performance on  test set...
4192/4192 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9675986
{'0': {'precision': 0.4952510224985495, 'recall': 0.43274021129581414, 'f1-score': 0.4618902082602669, 'support': 319552}, '1': {'precision': 0.5391421762208434, 'recall': 0.7112881135363629, 'f1-score': 0.613365534397721, 'support': 439542}, '2': {'precision': 0.5199985049593302, 'recall': 0.3544042209704793, 'f1-score': 0.4215212500852124, 'support': 314051}, 'accuracy': 0.5239040390627548, 'macro avg': {'precision': 0.5181305678929077, 'recall': 0.4994775152675521, 'f1-score': 0.4989256642477334, 'support': 1073145}, 'weighted avg': {'precision': 0.5204703331263726, 'recall': 0.5239040390627548, 'f1-score': 0.5121181421529607, 'support': 1073145}}
[[138283 131052  50217]
 [ 74378 312641  52523]
 [ 66557 136193 111301]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0038897
{'0': {'precision': 0.5160055370506553, 'recall': 0.4497798893319382, 'f1-score': 0.4806221071664207, 'support': 106083}, '1': {'precision': 0.46313082741639555, 'recall': 0.6525867620063623, 'f1-score': 0.541773384078959, 'support': 104049}, '2': {'precision': 0.533014013142269, 'recall': 0.3856876879744116, 'f1-score': 0.4475379595725705, 'support': 104735}, 'accuracy': 0.4954790435326662, 'macro avg': {'precision': 0.5040501258697733, 'recall': 0.4960181131042374, 'f1-score': 0.48997781693931675, 'support': 314867}, 'weighted avg': {'precision': 0.5041904598298607, 'recall': 0.4954790435326662, 'f1-score': 0.4898249166486173, 'support': 314867}}
[[47714 38873 19496]
 [20253 67901 15895]
 [24501 39839 40395]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0114077
{'0': {'precision': 0.49144417283088354, 'recall': 0.4548927416985013, 'f1-score': 0.47246257382227713, 'support': 34030}, '1': {'precision': 0.47035948451277415, 'recall': 0.6143578537046334, 'f1-score': 0.5328006351401534, 'support': 33863}, '2': {'precision': 0.507882033489214, 'recall': 0.3920295761527713, 'f1-score': 0.44249852139055007, 'support': 34352}, 'accuracy': 0.48658614113159565, 'macro avg': {'precision': 0.4898952302776239, 'recall': 0.48709339051863526, 'f1-score': 0.4825872434509935, 'support': 102245}, 'weighted avg': {'precision': 0.4899837844384813, 'recall': 0.48658614113159565, 'f1-score': 0.48237897698402155, 'support': 102245}}
[[15480 11167  7383]
 [ 7393 20804  5666]
 [ 8626 12259 13467]]
training model: results/WBA/W7/deepOF_L2/h50
Epoch 1/50
1230/1230 - 30s - loss: 3.2405 - accuracy50: 0.3986 - val_loss: 3.2311 - val_accuracy50: 0.3945 - 30s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.1642 - accuracy50: 0.4375 - val_loss: 3.2399 - val_accuracy50: 0.3960 - 28s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.1370 - accuracy50: 0.4480 - val_loss: 3.2292 - val_accuracy50: 0.4022 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.1216 - accuracy50: 0.4535 - val_loss: 3.2129 - val_accuracy50: 0.4103 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.1077 - accuracy50: 0.4589 - val_loss: 3.2067 - val_accuracy50: 0.4145 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.0979 - accuracy50: 0.4626 - val_loss: 3.1930 - val_accuracy50: 0.4205 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 28s - loss: 3.0872 - accuracy50: 0.4659 - val_loss: 3.1781 - val_accuracy50: 0.4266 - 28s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.0794 - accuracy50: 0.4694 - val_loss: 3.1640 - val_accuracy50: 0.4328 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.0736 - accuracy50: 0.4711 - val_loss: 3.1582 - val_accuracy50: 0.4343 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.0683 - accuracy50: 0.4724 - val_loss: 3.1464 - val_accuracy50: 0.4394 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.0600 - accuracy50: 0.4744 - val_loss: 3.1485 - val_accuracy50: 0.4388 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.0543 - accuracy50: 0.4772 - val_loss: 3.1376 - val_accuracy50: 0.4430 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.0492 - accuracy50: 0.4798 - val_loss: 3.1432 - val_accuracy50: 0.4452 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.0433 - accuracy50: 0.4813 - val_loss: 3.1356 - val_accuracy50: 0.4492 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.0388 - accuracy50: 0.4826 - val_loss: 3.1307 - val_accuracy50: 0.4507 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 28s - loss: 3.0348 - accuracy50: 0.4844 - val_loss: 3.1412 - val_accuracy50: 0.4447 - 28s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.0301 - accuracy50: 0.4856 - val_loss: 3.1380 - val_accuracy50: 0.4481 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 28s - loss: 3.0256 - accuracy50: 0.4881 - val_loss: 3.1389 - val_accuracy50: 0.4497 - 28s/epoch - 23ms/step
Epoch 19/50
1230/1230 - 28s - loss: 3.0211 - accuracy50: 0.4892 - val_loss: 3.1475 - val_accuracy50: 0.4473 - 28s/epoch - 23ms/step
Epoch 20/50
1230/1230 - 28s - loss: 3.0156 - accuracy50: 0.4913 - val_loss: 3.1390 - val_accuracy50: 0.4476 - 28s/epoch - 23ms/step
Epoch 21/50
1230/1230 - 28s - loss: 3.0119 - accuracy50: 0.4919 - val_loss: 3.1436 - val_accuracy50: 0.4488 - 28s/epoch - 23ms/step
Epoch 22/50
1230/1230 - 28s - loss: 3.0067 - accuracy50: 0.4934 - val_loss: 3.1477 - val_accuracy50: 0.4489 - 28s/epoch - 23ms/step
Epoch 23/50
1230/1230 - 28s - loss: 3.0010 - accuracy50: 0.4961 - val_loss: 3.1611 - val_accuracy50: 0.4467 - 28s/epoch - 23ms/step
Epoch 24/50
1230/1230 - 27s - loss: 2.9955 - accuracy50: 0.4972 - val_loss: 3.1622 - val_accuracy50: 0.4449 - 27s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 28s - loss: 2.9907 - accuracy50: 0.4987 - val_loss: 3.1770 - val_accuracy50: 0.4444 - 28s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h50
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.013554
{'0': {'precision': 0.4679434781950562, 'recall': 0.3813111144688842, 'f1-score': 0.4202086175814429, 'support': 324289}, '1': {'precision': 0.49202362158240226, 'recall': 0.6106301566706136, 'f1-score': 0.5449479556647648, 'support': 423117}, '2': {'precision': 0.46114948199309325, 'recall': 0.4017480252594869, 'f1-score': 0.4294041695172751, 'support': 325739}, 'accuracy': 0.47792982309007637, 'macro avg': {'precision': 0.4737055272568506, 'recall': 0.46456309879966157, 'f1-score': 0.46485358092116097, 'support': 1073145}, 'weighted avg': {'precision': 0.4753755106797554, 'recall': 0.47792982309007637, 'f1-score': 0.47218172876756126, 'support': 1073145}}
[[123655 133638  66996]
 [ 78830 258368  85919]
 [ 61767 133107 130865]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0402781
{'0': {'precision': 0.489042235938692, 'recall': 0.3986826482727427, 'f1-score': 0.43926368903008783, 'support': 106122}, '1': {'precision': 0.42790946219321346, 'recall': 0.5390637021080166, 'f1-score': 0.47709795343413663, 'support': 103984}, '2': {'precision': 0.47389017851640336, 'recall': 0.44040243983925315, 'f1-score': 0.45653303252044586, 'support': 104761}, 'accuracy': 0.4589239266102831, 'macro avg': {'precision': 0.46361395888276963, 'recall': 0.45938293007333747, 'f1-score': 0.4576315583282235, 'support': 314867}, 'weighted avg': {'precision': 0.46381197988529094, 'recall': 0.4589239266102831, 'f1-score': 0.45750412655826317, 'support': 314867}}
[[42309 38556 25257]
 [21966 56054 25964]
 [22239 36385 46137]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0432539
{'0': {'precision': 0.4660014159053366, 'recall': 0.40389784946236557, 'f1-score': 0.43273279383912217, 'support': 34224}, '1': {'precision': 0.43924102775346274, 'recall': 0.5039135186224415, 'f1-score': 0.4693599636858829, 'support': 33857}, '2': {'precision': 0.45411973918197984, 'recall': 0.44848378410022244, 'f1-score': 0.4512841658812441, 'support': 34164}, 'accuracy': 0.45191451904738617, 'macro avg': {'precision': 0.45312072761359307, 'recall': 0.4520983840616765, 'f1-score': 0.45112564113541637, 'support': 102245}, 'weighted avg': {'precision': 0.45316996140648824, 'recall': 0.45191451904738617, 'f1-score': 0.451060097511173, 'support': 102245}}
[[13823 11074  9327]
 [ 7705 17061  9091]
 [ 8135 10707 15322]]
training model: results/WBA/W7/deepOF_L2/h100
Epoch 1/50
1230/1230 - 30s - loss: 3.2644 - accuracy100: 0.3873 - val_loss: 3.2584 - val_accuracy100: 0.3966 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2206 - accuracy100: 0.4098 - val_loss: 3.2440 - val_accuracy100: 0.4002 - 28s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2045 - accuracy100: 0.4181 - val_loss: 3.2378 - val_accuracy100: 0.4027 - 28s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.1960 - accuracy100: 0.4223 - val_loss: 3.2344 - val_accuracy100: 0.4034 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.1903 - accuracy100: 0.4253 - val_loss: 3.2287 - val_accuracy100: 0.4060 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.1859 - accuracy100: 0.4289 - val_loss: 3.2267 - val_accuracy100: 0.4071 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 28s - loss: 3.1820 - accuracy100: 0.4301 - val_loss: 3.2232 - val_accuracy100: 0.4101 - 28s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 28s - loss: 3.1770 - accuracy100: 0.4312 - val_loss: 3.2236 - val_accuracy100: 0.4070 - 28s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.1745 - accuracy100: 0.4324 - val_loss: 3.2192 - val_accuracy100: 0.4121 - 28s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 28s - loss: 3.1699 - accuracy100: 0.4347 - val_loss: 3.2190 - val_accuracy100: 0.4113 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 28s - loss: 3.1661 - accuracy100: 0.4361 - val_loss: 3.2203 - val_accuracy100: 0.4107 - 28s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.1630 - accuracy100: 0.4384 - val_loss: 3.2192 - val_accuracy100: 0.4102 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 3.1588 - accuracy100: 0.4398 - val_loss: 3.2163 - val_accuracy100: 0.4112 - 28s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 28s - loss: 3.1554 - accuracy100: 0.4413 - val_loss: 3.2169 - val_accuracy100: 0.4133 - 28s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 28s - loss: 3.1512 - accuracy100: 0.4428 - val_loss: 3.2153 - val_accuracy100: 0.4132 - 28s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 28s - loss: 3.1470 - accuracy100: 0.4452 - val_loss: 3.2185 - val_accuracy100: 0.4123 - 28s/epoch - 23ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.1445 - accuracy100: 0.4463 - val_loss: 3.2203 - val_accuracy100: 0.4123 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 28s - loss: 3.1383 - accuracy100: 0.4494 - val_loss: 3.2305 - val_accuracy100: 0.4071 - 28s/epoch - 23ms/step
Epoch 19/50
1230/1230 - 28s - loss: 3.1345 - accuracy100: 0.4509 - val_loss: 3.2252 - val_accuracy100: 0.4098 - 28s/epoch - 23ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.1287 - accuracy100: 0.4530 - val_loss: 3.2371 - val_accuracy100: 0.4060 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 3.1254 - accuracy100: 0.4553 - val_loss: 3.2493 - val_accuracy100: 0.4049 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 3.1191 - accuracy100: 0.4589 - val_loss: 3.2529 - val_accuracy100: 0.4007 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 28s - loss: 3.1156 - accuracy100: 0.4606 - val_loss: 3.2720 - val_accuracy100: 0.3949 - 28s/epoch - 23ms/step
Epoch 24/50
1230/1230 - 27s - loss: 3.1062 - accuracy100: 0.4634 - val_loss: 3.2747 - val_accuracy100: 0.3950 - 27s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 27s - loss: 3.1027 - accuracy100: 0.4650 - val_loss: 3.2913 - val_accuracy100: 0.3923 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h100
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.078175
{'0': {'precision': 0.36257317033731123, 'recall': 0.5683299379322799, 'f1-score': 0.4427124274549922, 'support': 315623}, '1': {'precision': 0.45697152880197617, 'recall': 0.17481958930445524, 'f1-score': 0.25289236489561623, 'support': 430684}, '2': {'precision': 0.3830255822611605, 'recall': 0.4847569744032212, 'f1-score': 0.4279282199210246, 'support': 326838}, 'accuracy': 0.38494984368375196, 'macro avg': {'precision': 0.400856760466816, 'recall': 0.4093021672133188, 'f1-score': 0.37451100409054433, 'support': 1073145}, 'weighted avg': {'precision': 0.4066869555437491, 'recall': 0.38494984368375196, 'f1-score': 0.36202947720566975, 'support': 1073145}}
[[179378  42693  93552]
 [193735  75292 161657]
 [121623  46778 158437]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0702145
{'0': {'precision': 0.4141730303009131, 'recall': 0.5552735106781567, 'f1-score': 0.4744548623199715, 'support': 106760}, '1': {'precision': 0.39692447887003074, 'recall': 0.16931972789115646, 'f1-score': 0.23737865731121627, 'support': 102900}, '2': {'precision': 0.4130286840684913, 'recall': 0.5018867565846379, 'f1-score': 0.4531427002162644, 'support': 105207}, 'accuracy': 0.4113038203431925, 'macro avg': {'precision': 0.40804206441314506, 'recall': 0.40882666505131704, 'f1-score': 0.38832540661581744, 'support': 314867}, 'weighted avg': {'precision': 0.408153761287926, 'recall': 0.4113038203431925, 'f1-score': 0.3898561900747199, 'support': 314867}}
[[59281 13088 34391]
 [44829 17423 40648]
 [39021 13384 52802]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0729984
{'0': {'precision': 0.4163013612433668, 'recall': 0.5461750137589433, 'f1-score': 0.47247580846733395, 'support': 36340}, '1': {'precision': 0.36475247524752474, 'recall': 0.15592726780211966, 'f1-score': 0.21846387399781775, 'support': 29533}, '2': {'precision': 0.4200224113678087, 'recall': 0.48435609809743757, 'f1-score': 0.44990104066909276, 'support': 36372}, 'accuracy': 0.41146266321091496, 'macro avg': {'precision': 0.40035874928623344, 'recall': 0.3954861265528335, 'f1-score': 0.3802802410447481, 'support': 102245}, 'weighted avg': {'precision': 0.40273540481528713, 'recall': 0.41146266321091496, 'f1-score': 0.3910750170834438, 'support': 102245}}
[[19848  3876 12616]
 [13218  4605 11710]
 [14611  4144 17617]]
training model: results/WBA/W7/deepOF_L2/h200
Epoch 1/50
1230/1230 - 30s - loss: 3.3054 - accuracy200: 0.3587 - val_loss: 3.2993 - val_accuracy200: 0.3463 - 30s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2743 - accuracy200: 0.3788 - val_loss: 3.2971 - val_accuracy200: 0.3452 - 28s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2613 - accuracy200: 0.3867 - val_loss: 3.2922 - val_accuracy200: 0.3472 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2553 - accuracy200: 0.3900 - val_loss: 3.2951 - val_accuracy200: 0.3466 - 28s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.2518 - accuracy200: 0.3921 - val_loss: 3.2939 - val_accuracy200: 0.3483 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.2481 - accuracy200: 0.3937 - val_loss: 3.2949 - val_accuracy200: 0.3462 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2457 - accuracy200: 0.3960 - val_loss: 3.2939 - val_accuracy200: 0.3474 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2434 - accuracy200: 0.3970 - val_loss: 3.2927 - val_accuracy200: 0.3499 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.2416 - accuracy200: 0.3977 - val_loss: 3.2961 - val_accuracy200: 0.3488 - 28s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2396 - accuracy200: 0.3976 - val_loss: 3.2946 - val_accuracy200: 0.3485 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2364 - accuracy200: 0.4007 - val_loss: 3.2933 - val_accuracy200: 0.3491 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2352 - accuracy200: 0.4008 - val_loss: 3.2957 - val_accuracy200: 0.3506 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.2319 - accuracy200: 0.4038 - val_loss: 3.2933 - val_accuracy200: 0.3523 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h200
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920087
{'0': {'precision': 0.3767774191262217, 'recall': 0.1726882133207341, 'f1-score': 0.2368301691181235, 'support': 338645}, '1': {'precision': 0.36075243535334467, 'recall': 0.8063980874940038, 'f1-score': 0.49849624060150377, 'support': 381489}, '2': {'precision': 0.3993525919334796, 'recall': 0.07373991178745139, 'f1-score': 0.12449246043702206, 'support': 353011}, 'accuracy': 0.36541473892158094, 'macro avg': {'precision': 0.37896081547101534, 'recall': 0.3509420708673964, 'f1-score': 0.28660629005221644, 'support': 1073145}, 'weighted avg': {'precision': 0.37850684925293504, 'recall': 0.36541473892158094, 'f1-score': 0.2928955480416604, 'support': 1073145}}
[[ 58480 261508  18657]
 [ 53362 307632  20495]
 [ 43369 283611  26031]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002132
{'0': {'precision': 0.4148815679322401, 'recall': 0.1560300763019483, 'f1-score': 0.22677415447559318, 'support': 107992}, '1': {'precision': 0.32916067563083634, 'recall': 0.8233521396741332, 'f1-score': 0.4703030508264125, 'support': 101207}, '2': {'precision': 0.40811489785277527, 'recall': 0.08148162168300715, 'f1-score': 0.13584191219973968, 'support': 105668}, 'accuracy': 0.34550778582703173, 'macro avg': {'precision': 0.3840523804719506, 'recall': 0.3536212792196962, 'f1-score': 0.2776397058339151, 'support': 314867}, 'weighted avg': {'precision': 0.3850576268996611, 'recall': 0.34550778582703173, 'f1-score': 0.27453464012881335, 'support': 314867}}
[[16850 84377  6765]
 [12156 83329  5722]
 [11608 85450  8610]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997021
{'0': {'precision': 0.39088820826952525, 'recall': 0.14934324079220665, 'f1-score': 0.2161166733695997, 'support': 34183}, '1': {'precision': 0.3364596980568378, 'recall': 0.8135176742258274, 'f1-score': 0.476037037999463, 'support': 33778}, '2': {'precision': 0.388607931860527, 'recall': 0.08517092521292731, 'f1-score': 0.13971960380879467, 'support': 34284}, 'accuracy': 0.3472443640275808, 'macro avg': {'precision': 0.37198527939563003, 'recall': 0.3493439467436538, 'f1-score': 0.2772911050592858, 'support': 102245}, 'weighted avg': {'precision': 0.3721424190928393, 'recall': 0.3472443640275808, 'f1-score': 0.27636796138999076, 'support': 102245}}
[[ 5105 26657  2421]
 [ 4126 27479  2173]
 [ 3829 27535  2920]]
training model: results/WBA/W7/deepOF_L2/h300
Epoch 1/50
1230/1230 - 30s - loss: 3.2822 - accuracy300: 0.3804 - val_loss: 3.3067 - val_accuracy300: 0.3469 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2479 - accuracy300: 0.3935 - val_loss: 3.2985 - val_accuracy300: 0.3502 - 28s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2367 - accuracy300: 0.3988 - val_loss: 3.2926 - val_accuracy300: 0.3537 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2314 - accuracy300: 0.4016 - val_loss: 3.2925 - val_accuracy300: 0.3547 - 28s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.2286 - accuracy300: 0.4045 - val_loss: 3.2877 - val_accuracy300: 0.3578 - 28s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.2268 - accuracy300: 0.4061 - val_loss: 3.2860 - val_accuracy300: 0.3599 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 28s - loss: 3.2255 - accuracy300: 0.4070 - val_loss: 3.2854 - val_accuracy300: 0.3602 - 28s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 28s - loss: 3.2247 - accuracy300: 0.4068 - val_loss: 3.2862 - val_accuracy300: 0.3603 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2241 - accuracy300: 0.4073 - val_loss: 3.2842 - val_accuracy300: 0.3655 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2240 - accuracy300: 0.4074 - val_loss: 3.2829 - val_accuracy300: 0.3641 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 28s - loss: 3.2218 - accuracy300: 0.4092 - val_loss: 3.2824 - val_accuracy300: 0.3652 - 28s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 28s - loss: 3.2214 - accuracy300: 0.4092 - val_loss: 3.2807 - val_accuracy300: 0.3696 - 28s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 3.2201 - accuracy300: 0.4108 - val_loss: 3.2781 - val_accuracy300: 0.3678 - 28s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 28s - loss: 3.2187 - accuracy300: 0.4108 - val_loss: 3.2794 - val_accuracy300: 0.3674 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 28s - loss: 3.2175 - accuracy300: 0.4112 - val_loss: 3.2767 - val_accuracy300: 0.3732 - 28s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 28s - loss: 3.2169 - accuracy300: 0.4116 - val_loss: 3.2785 - val_accuracy300: 0.3719 - 28s/epoch - 23ms/step
Epoch 17/50
1230/1230 - 28s - loss: 3.2155 - accuracy300: 0.4126 - val_loss: 3.2776 - val_accuracy300: 0.3718 - 28s/epoch - 23ms/step
Epoch 18/50
1230/1230 - 27s - loss: 3.2135 - accuracy300: 0.4140 - val_loss: 3.2813 - val_accuracy300: 0.3694 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 28s - loss: 3.2122 - accuracy300: 0.4150 - val_loss: 3.2816 - val_accuracy300: 0.3705 - 28s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.2104 - accuracy300: 0.4152 - val_loss: 3.2807 - val_accuracy300: 0.3713 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 28s - loss: 3.2085 - accuracy300: 0.4170 - val_loss: 3.2821 - val_accuracy300: 0.3701 - 28s/epoch - 23ms/step
Epoch 22/50
1230/1230 - 27s - loss: 3.2070 - accuracy300: 0.4173 - val_loss: 3.2819 - val_accuracy300: 0.3706 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 28s - loss: 3.2063 - accuracy300: 0.4189 - val_loss: 3.2831 - val_accuracy300: 0.3693 - 28s/epoch - 23ms/step
Epoch 24/50
1230/1230 - 28s - loss: 3.2035 - accuracy300: 0.4201 - val_loss: 3.2917 - val_accuracy300: 0.3642 - 28s/epoch - 23ms/step
Epoch 25/50
1230/1230 - 27s - loss: 3.2013 - accuracy300: 0.4215 - val_loss: 3.2898 - val_accuracy300: 0.3665 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h300
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0785054
{'0': {'precision': 0.30496065872082656, 'recall': 0.3514171563522113, 'f1-score': 0.3265448801771126, 'support': 287089}, '1': {'precision': 0.4804132879283282, 'recall': 0.5549104094947166, 'f1-score': 0.5149816139523399, 'support': 484817}, '2': {'precision': 0.3377814342520225, 'recall': 0.20444231988553938, 'f1-score': 0.2547170591690035, 'support': 301239}, 'accuracy': 0.4020929138187291, 'macro avg': {'precision': 0.37438512696705906, 'recall': 0.3702566285774891, 'f1-score': 0.365414517766152, 'support': 1073145}, 'weighted avg': {'precision': 0.39343827818020555, 'recall': 0.4020929138187291, 'f1-score': 0.3915127931674751, 'support': 1073145}}
[[100888 137096  49105]
 [144153 269030  71634]
 [ 85782 153871  61586]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0903069
{'0': {'precision': 0.3922308383671593, 'recall': 0.3468957676701389, 'f1-score': 0.368172967034045, 'support': 108191}, '1': {'precision': 0.354359414443477, 'recall': 0.5551401318888366, 'f1-score': 0.4325876419916879, 'support': 101904}, '2': {'precision': 0.391951358796063, 'recall': 0.22273126407818883, 'f1-score': 0.2840484450124764, 'support': 104772}, 'accuracy': 0.3729765265969441, 'macro avg': {'precision': 0.37951387053556646, 'recall': 0.3749223878790548, 'f1-score': 0.3616030180127365, 'support': 314867}, 'weighted avg': {'precision': 0.37988108047845764, 'recall': 0.3729765265969441, 'f1-score': 0.36102778705532335, 'support': 314867}}
[[37531 51156 19504]
 [28635 56571 16698]
 [29520 51916 23336]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0917177
{'0': {'precision': 0.3605081555834379, 'recall': 0.3446590295687639, 'f1-score': 0.35240548247631315, 'support': 33346}, '1': {'precision': 0.3723510396296444, 'recall': 0.5323215610201404, 'f1-score': 0.4381927484501221, 'support': 35054}, '2': {'precision': 0.3799318552170263, 'recall': 0.22733047717535826, 'f1-score': 0.2844572611653357, 'support': 33845}, 'accuracy': 0.3701599100200499, 'macro avg': {'precision': 0.37093035014336956, 'recall': 0.36810368925475423, 'f1-score': 0.358351830697257, 'support': 102245}, 'weighted avg': {'precision': 0.3709980139770466, 'recall': 0.3701599100200499, 'f1-score': 0.35932493351231365, 'support': 102245}}
[[11493 15429  6424]
 [10261 18660  6133]
 [10126 16025  7694]]
training model: results/WBA/W7/deepOF_L2/h500
Epoch 1/50
1230/1230 - 30s - loss: 3.3053 - accuracy500: 0.3643 - val_loss: 3.3053 - val_accuracy500: 0.3677 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2561 - accuracy500: 0.3915 - val_loss: 3.3446 - val_accuracy500: 0.3655 - 28s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2438 - accuracy500: 0.3979 - val_loss: 3.3332 - val_accuracy500: 0.3670 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2373 - accuracy500: 0.4012 - val_loss: 3.3332 - val_accuracy500: 0.3661 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.2341 - accuracy500: 0.4035 - val_loss: 3.3198 - val_accuracy500: 0.3688 - 28s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.2313 - accuracy500: 0.4044 - val_loss: 3.3152 - val_accuracy500: 0.3696 - 28s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2283 - accuracy500: 0.4066 - val_loss: 3.3113 - val_accuracy500: 0.3707 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2264 - accuracy500: 0.4068 - val_loss: 3.3132 - val_accuracy500: 0.3703 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.2241 - accuracy500: 0.4082 - val_loss: 3.3067 - val_accuracy500: 0.3726 - 28s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 28s - loss: 3.2220 - accuracy500: 0.4101 - val_loss: 3.3096 - val_accuracy500: 0.3707 - 28s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2206 - accuracy500: 0.4106 - val_loss: 3.3113 - val_accuracy500: 0.3710 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h500
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860282
{'0': {'precision': 0.33833237715846376, 'recall': 0.13498979621444393, 'f1-score': 0.19298237528114745, 'support': 310179}, '1': {'precision': 0.4176806092408906, 'recall': 0.8431299608940885, 'f1-score': 0.5586232287024527, 'support': 430114}, '2': {'precision': 0.36187777230162643, 'recall': 0.0882374148270102, 'f1-score': 0.14187994550882582, 'support': 332852}, 'accuracy': 0.4043097624272582, 'macro avg': {'precision': 0.3726302529003269, 'recall': 0.3554523906451809, 'f1-score': 0.2978285164974754, 'support': 1073145}, 'weighted avg': {'precision': 0.37743791961367057, 'recall': 0.4043097624272582, 'f1-score': 0.3236801878543547, 'support': 1073145}}
[[ 41871 242727  25581]
 [ 41263 362642  26209]
 [ 40623 262859  29370]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017498
{'0': {'precision': 0.3814077479945216, 'recall': 0.14778488509831794, 'f1-score': 0.21302753170824992, 'support': 105525}, '1': {'precision': 0.3572226976256669, 'recall': 0.8178230629347031, 'f1-score': 0.49724865282301617, 'support': 106682}, '2': {'precision': 0.3736803173962746, 'recall': 0.10826027664134034, 'f1-score': 0.16788266038277366, 'support': 102660}, 'accuracy': 0.3619178891404942, 'macro avg': {'precision': 0.370770254338821, 'recall': 0.3579560748914538, 'f1-score': 0.2927196149713466, 'support': 314867}, 'weighted avg': {'precision': 0.37069399403279746, 'recall': 0.3619178891404942, 'f1-score': 0.2946070721252898, 'support': 314867}}
[[15595 79449 10481]
 [11288 87247  8147]
 [14005 77541 11114]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003017
{'0': {'precision': 0.35093385760426904, 'recall': 0.15368058544984933, 'f1-score': 0.21375416987426224, 'support': 32522}, '1': {'precision': 0.3690276017280182, 'recall': 0.797802136345842, 'f1-score': 0.5046340514344334, 'support': 35762}, '2': {'precision': 0.3777715408363738, 'recall': 0.11890109242955155, 'f1-score': 0.18087346024636058, 'support': 33961}, 'accuracy': 0.3674213897990122, 'macro avg': {'precision': 0.3659110000562203, 'recall': 0.3567946047417476, 'f1-score': 0.29975389385168544, 'support': 102245}, 'weighted avg': {'precision': 0.36617668647217483, 'recall': 0.3674213897990122, 'f1-score': 0.3045731296735842, 'support': 102245}}
[[ 4998 23861  3663]
 [ 4243 28531  2988]
 [ 5001 24922  4038]]
training model: results/WBA/W7/deepOF_L2/h1000
Epoch 1/50
1230/1230 - 30s - loss: 3.3167 - accuracy1000: 0.3564 - val_loss: 3.3040 - val_accuracy1000: 0.3479 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2814 - accuracy1000: 0.3713 - val_loss: 3.2989 - val_accuracy1000: 0.3528 - 28s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2703 - accuracy1000: 0.3764 - val_loss: 3.2990 - val_accuracy1000: 0.3554 - 28s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2662 - accuracy1000: 0.3784 - val_loss: 3.2981 - val_accuracy1000: 0.3553 - 28s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2629 - accuracy1000: 0.3800 - val_loss: 3.2978 - val_accuracy1000: 0.3559 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2612 - accuracy1000: 0.3808 - val_loss: 3.2987 - val_accuracy1000: 0.3548 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2602 - accuracy1000: 0.3813 - val_loss: 3.2971 - val_accuracy1000: 0.3566 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2582 - accuracy1000: 0.3815 - val_loss: 3.2980 - val_accuracy1000: 0.3562 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2570 - accuracy1000: 0.3831 - val_loss: 3.2982 - val_accuracy1000: 0.3567 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2558 - accuracy1000: 0.3840 - val_loss: 3.2983 - val_accuracy1000: 0.3557 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2548 - accuracy1000: 0.3846 - val_loss: 3.2985 - val_accuracy1000: 0.3572 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2530 - accuracy1000: 0.3859 - val_loss: 3.3005 - val_accuracy1000: 0.3561 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.2518 - accuracy1000: 0.3867 - val_loss: 3.2996 - val_accuracy1000: 0.3558 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.2504 - accuracy1000: 0.3878 - val_loss: 3.2999 - val_accuracy1000: 0.3568 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.2493 - accuracy1000: 0.3887 - val_loss: 3.3015 - val_accuracy1000: 0.3553 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 3.2481 - accuracy1000: 0.3890 - val_loss: 3.3012 - val_accuracy1000: 0.3542 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.2467 - accuracy1000: 0.3898 - val_loss: 3.3023 - val_accuracy1000: 0.3560 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepOF_L2/h1000
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0912532
{'0': {'precision': 0.3206505573396924, 'recall': 0.20308902747043966, 'f1-score': 0.2486755316445303, 'support': 313173}, '1': {'precision': 0.40005610496685473, 'recall': 0.7989329319605872, 'f1-score': 0.5331458204304559, 'support': 415906}, '2': {'precision': 0.37130706238972083, 'recall': 0.0477059633907448, 'f1-score': 0.08454897597560473, 'support': 344066}, 'accuracy': 0.3841950528586538, 'macro avg': {'precision': 0.364004574898756, 'recall': 0.34990930760725725, 'f1-score': 0.28879010935019694, 'support': 1073145}, 'weighted avg': {'precision': 0.3676660349852721, 'recall': 0.3841950528586538, 'f1-score': 0.3063029095151951, 'support': 1073145}}
[[ 63602 235412  14159]
 [ 69992 332281  13633]
 [ 64759 262893  16414]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985128
{'0': {'precision': 0.39042661695916714, 'recall': 0.2042577463752116, 'f1-score': 0.2682016404730554, 'support': 108696}, '1': {'precision': 0.3424782901324753, 'recall': 0.8140607928827844, 'f1-score': 0.48212490611820435, 'support': 102512}, '2': {'precision': 0.3919626037814833, 'recall': 0.054196934178411905, 'f1-score': 0.09522679503695165, 'support': 103659}, 'accuracy': 0.3533904791546907, 'macro avg': {'precision': 0.37495583695770857, 'recall': 0.357505157812136, 'f1-score': 0.2818511138760705, 'support': 314867}, 'weighted avg': {'precision': 0.3753216360572519, 'recall': 0.3533904791546907, 'f1-score': 0.28090320114710005, 'support': 314867}}
[[22202 81337  5157]
 [15503 83451  3558]
 [19161 78880  5618]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983572
{'0': {'precision': 0.3544683229182543, 'recall': 0.21170651778128413, 'f1-score': 0.26508862250422693, 'support': 32956}, '1': {'precision': 0.35371710398570894, 'recall': 0.7933857901919225, 'f1-score': 0.48929198152061026, 'support': 34441}, '2': {'precision': 0.403125588401431, 'recall': 0.06143824609733701, 'f1-score': 0.10662616100998532, 'support': 34848}, 'accuracy': 0.356428187197418, 'macro avg': {'precision': 0.37043700510179806, 'recall': 0.3555101846901812, 'f1-score': 0.28700225501160753, 'support': 102245}, 'weighted avg': {'precision': 0.37079905455600626, 'recall': 0.356428187197418, 'f1-score': 0.2866025158949251, 'support': 102245}}
[[ 6977 24146  1833]
 [ 5779 27325  1337]
 [ 6927 25780  2141]]
training model: results/WBA/W7/deepVOL_L2/h10
Epoch 1/50
1230/1230 - 30s - loss: 3.1806 - accuracy10: 0.4219 - val_loss: 3.2598 - val_accuracy10: 0.5110 - 30s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 26s - loss: 2.9970 - accuracy10: 0.4714 - val_loss: 3.2150 - val_accuracy10: 0.4987 - 26s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 2.9424 - accuracy10: 0.4909 - val_loss: 3.1906 - val_accuracy10: 0.5128 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 26s - loss: 2.9112 - accuracy10: 0.5015 - val_loss: 3.1564 - val_accuracy10: 0.5213 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 26s - loss: 2.8883 - accuracy10: 0.5091 - val_loss: 3.1545 - val_accuracy10: 0.5291 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 26s - loss: 2.8653 - accuracy10: 0.5154 - val_loss: 3.1548 - val_accuracy10: 0.5257 - 26s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 26s - loss: 2.8482 - accuracy10: 0.5203 - val_loss: 3.1105 - val_accuracy10: 0.5304 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.8353 - accuracy10: 0.5239 - val_loss: 3.1166 - val_accuracy10: 0.5293 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 2.8219 - accuracy10: 0.5264 - val_loss: 3.1094 - val_accuracy10: 0.5311 - 28s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.8106 - accuracy10: 0.5296 - val_loss: 3.0889 - val_accuracy10: 0.5306 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 28s - loss: 2.8026 - accuracy10: 0.5308 - val_loss: 3.0977 - val_accuracy10: 0.5342 - 28s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.7922 - accuracy10: 0.5334 - val_loss: 3.0643 - val_accuracy10: 0.5309 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 2.7849 - accuracy10: 0.5348 - val_loss: 3.0681 - val_accuracy10: 0.5301 - 28s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.7779 - accuracy10: 0.5364 - val_loss: 3.0703 - val_accuracy10: 0.5345 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.7715 - accuracy10: 0.5377 - val_loss: 3.0722 - val_accuracy10: 0.5325 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.7665 - accuracy10: 0.5385 - val_loss: 3.0653 - val_accuracy10: 0.5335 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 28s - loss: 2.7609 - accuracy10: 0.5403 - val_loss: 3.0647 - val_accuracy10: 0.5369 - 28s/epoch - 23ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.7550 - accuracy10: 0.5415 - val_loss: 3.0516 - val_accuracy10: 0.5357 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.7504 - accuracy10: 0.5422 - val_loss: 3.0624 - val_accuracy10: 0.5313 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.7455 - accuracy10: 0.5436 - val_loss: 3.0470 - val_accuracy10: 0.5318 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 28s - loss: 2.7404 - accuracy10: 0.5452 - val_loss: 3.0478 - val_accuracy10: 0.5341 - 28s/epoch - 23ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.7363 - accuracy10: 0.5449 - val_loss: 3.0482 - val_accuracy10: 0.5370 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.7319 - accuracy10: 0.5460 - val_loss: 3.0551 - val_accuracy10: 0.5319 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 28s - loss: 2.7271 - accuracy10: 0.5465 - val_loss: 3.0255 - val_accuracy10: 0.5362 - 28s/epoch - 23ms/step
Epoch 25/50
1230/1230 - 29s - loss: 2.7225 - accuracy10: 0.5474 - val_loss: 3.0487 - val_accuracy10: 0.5346 - 29s/epoch - 23ms/step
Epoch 26/50
1230/1230 - 27s - loss: 2.7199 - accuracy10: 0.5482 - val_loss: 3.0492 - val_accuracy10: 0.5344 - 27s/epoch - 22ms/step
Epoch 27/50
1230/1230 - 28s - loss: 2.7158 - accuracy10: 0.5492 - val_loss: 3.0371 - val_accuracy10: 0.5376 - 28s/epoch - 23ms/step
Epoch 28/50
1230/1230 - 28s - loss: 2.7113 - accuracy10: 0.5501 - val_loss: 3.0384 - val_accuracy10: 0.5347 - 28s/epoch - 23ms/step
Epoch 29/50
1230/1230 - 29s - loss: 2.7074 - accuracy10: 0.5517 - val_loss: 3.0268 - val_accuracy10: 0.5368 - 29s/epoch - 24ms/step
Epoch 30/50
1230/1230 - 26s - loss: 2.7041 - accuracy10: 0.5515 - val_loss: 3.0471 - val_accuracy10: 0.5344 - 26s/epoch - 21ms/step
Epoch 31/50
1230/1230 - 26s - loss: 2.6990 - accuracy10: 0.5524 - val_loss: 3.0360 - val_accuracy10: 0.5353 - 26s/epoch - 21ms/step
Epoch 32/50
1230/1230 - 26s - loss: 2.6968 - accuracy10: 0.5527 - val_loss: 3.0493 - val_accuracy10: 0.5349 - 26s/epoch - 21ms/step
Epoch 33/50
1230/1230 - 28s - loss: 2.6911 - accuracy10: 0.5540 - val_loss: 3.0420 - val_accuracy10: 0.5378 - 28s/epoch - 22ms/step
Epoch 34/50
1230/1230 - 27s - loss: 2.6890 - accuracy10: 0.5545 - val_loss: 3.0621 - val_accuracy10: 0.5354 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepVOL_L2/h10
Evaluating performance on  test set...
4192/4192 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85824424
{'0': {'precision': 0.4123903323142496, 'recall': 0.553152174397015, 'f1-score': 0.47251075418091365, 'support': 224591}, '1': {'precision': 0.7284935650297674, 'recall': 0.6992054555647491, 'f1-score': 0.7135490991658989, 'support': 629669}, '2': {'precision': 0.46309946581515415, 'recall': 0.35447028187674173, 'f1-score': 0.4015681809359918, 'support': 218890}, 'accuracy': 0.598323626706425, 'macro avg': {'precision': 0.5346611210530571, 'recall': 0.5356093039461686, 'f1-score': 0.5292093447609347, 'support': 1073150}, 'weighted avg': {'precision': 0.60820650775362, 'recall': 0.598323626706425, 'f1-score': 0.5994694773703745, 'support': 1073150}}
[[124233  71345  29013]
 [128459 440268  60942]
 [ 48559  92741  77590]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93874073
{'0': {'precision': 0.4300970222873507, 'recall': 0.5797239901369722, 'f1-score': 0.4938252598009567, 'support': 77461}, '1': {'precision': 0.6657973962848931, 'recall': 0.6063100307730565, 'f1-score': 0.6346628142305865, 'support': 160855}, '2': {'precision': 0.4650254005470887, 'recall': 0.38862980235398625, 'f1-score': 0.42340919118170306, 'support': 76551}, 'accuracy': 0.5468467638717299, 'macro avg': {'precision': 0.5203066063731109, 'recall': 0.524887941088005, 'f1-score': 0.5172990884044154, 'support': 314867}, 'weighted avg': {'precision': 0.5590002923776932, 'recall': 0.5468467638717299, 'f1-score': 0.5486547730522837, 'support': 314867}}
[[44906 21003 11552]
 [40654 97528 22673]
 [18849 27952 29750]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9555901
{'0': {'precision': 0.42253189862997587, 'recall': 0.5709972189114024, 'f1-score': 0.4856718031900513, 'support': 25170}, '1': {'precision': 0.6597255292436902, 'recall': 0.5938236726741354, 'f1-score': 0.6250422977143854, 'support': 51325}, '2': {'precision': 0.4485090545999183, 'recall': 0.38376699029126216, 'f1-score': 0.41361990666136494, 'support': 25750}, 'accuracy': 0.5353024597779843, 'macro avg': {'precision': 0.5102554941578615, 'recall': 0.5161959606256, 'f1-score': 0.5081113358552671, 'support': 102245}, 'weighted avg': {'precision': 0.5481407289637321, 'recall': 0.5353024597779843, 'f1-score': 0.5374870928946605, 'support': 102245}}
[[14372  6466  4332]
 [13028 30478  7819]
 [ 6614  9254  9882]]
training model: results/WBA/W7/deepVOL_L2/h20
Epoch 1/50
1230/1230 - 29s - loss: 3.1866 - accuracy20: 0.4320 - val_loss: 3.2953 - val_accuracy20: 0.4382 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.0428 - accuracy20: 0.4799 - val_loss: 3.2956 - val_accuracy20: 0.4528 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.9996 - accuracy20: 0.4921 - val_loss: 3.3016 - val_accuracy20: 0.4609 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 28s - loss: 2.9758 - accuracy20: 0.4986 - val_loss: 3.2243 - val_accuracy20: 0.4742 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.9558 - accuracy20: 0.5035 - val_loss: 3.2205 - val_accuracy20: 0.4775 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.9393 - accuracy20: 0.5076 - val_loss: 3.2280 - val_accuracy20: 0.4808 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 29s - loss: 2.9269 - accuracy20: 0.5114 - val_loss: 3.2388 - val_accuracy20: 0.4814 - 29s/epoch - 24ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.9138 - accuracy20: 0.5144 - val_loss: 3.2303 - val_accuracy20: 0.4826 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.9051 - accuracy20: 0.5164 - val_loss: 3.2557 - val_accuracy20: 0.4850 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.8966 - accuracy20: 0.5188 - val_loss: 3.2277 - val_accuracy20: 0.4841 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 26s - loss: 2.8893 - accuracy20: 0.5206 - val_loss: 3.1950 - val_accuracy20: 0.4885 - 26s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.8834 - accuracy20: 0.5214 - val_loss: 3.2112 - val_accuracy20: 0.4890 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.8774 - accuracy20: 0.5232 - val_loss: 3.2150 - val_accuracy20: 0.4885 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 26s - loss: 2.8725 - accuracy20: 0.5245 - val_loss: 3.1982 - val_accuracy20: 0.4897 - 26s/epoch - 21ms/step
Epoch 15/50
1230/1230 - 28s - loss: 2.8662 - accuracy20: 0.5263 - val_loss: 3.1857 - val_accuracy20: 0.4925 - 28s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 29s - loss: 2.8618 - accuracy20: 0.5266 - val_loss: 3.1876 - val_accuracy20: 0.4885 - 29s/epoch - 24ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.8570 - accuracy20: 0.5284 - val_loss: 3.1783 - val_accuracy20: 0.4922 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.8537 - accuracy20: 0.5283 - val_loss: 3.1761 - val_accuracy20: 0.4936 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.8498 - accuracy20: 0.5294 - val_loss: 3.1570 - val_accuracy20: 0.4948 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 28s - loss: 2.8456 - accuracy20: 0.5303 - val_loss: 3.1544 - val_accuracy20: 0.4938 - 28s/epoch - 23ms/step
Epoch 21/50
1230/1230 - 27s - loss: 2.8428 - accuracy20: 0.5312 - val_loss: 3.1576 - val_accuracy20: 0.4952 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 26s - loss: 2.8390 - accuracy20: 0.5318 - val_loss: 3.1444 - val_accuracy20: 0.4978 - 26s/epoch - 21ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.8359 - accuracy20: 0.5317 - val_loss: 3.1635 - val_accuracy20: 0.4951 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 26s - loss: 2.8316 - accuracy20: 0.5330 - val_loss: 3.1501 - val_accuracy20: 0.4956 - 26s/epoch - 21ms/step
Epoch 25/50
1230/1230 - 28s - loss: 2.8278 - accuracy20: 0.5344 - val_loss: 3.1577 - val_accuracy20: 0.4962 - 28s/epoch - 23ms/step
Epoch 26/50
1230/1230 - 28s - loss: 2.8251 - accuracy20: 0.5341 - val_loss: 3.1695 - val_accuracy20: 0.4939 - 28s/epoch - 23ms/step
Epoch 27/50
1230/1230 - 28s - loss: 2.8229 - accuracy20: 0.5355 - val_loss: 3.1524 - val_accuracy20: 0.4973 - 28s/epoch - 23ms/step
Epoch 28/50
1230/1230 - 29s - loss: 2.8189 - accuracy20: 0.5359 - val_loss: 3.1492 - val_accuracy20: 0.4975 - 29s/epoch - 23ms/step
Epoch 29/50
1230/1230 - 27s - loss: 2.8151 - accuracy20: 0.5361 - val_loss: 3.1483 - val_accuracy20: 0.4975 - 27s/epoch - 22ms/step
Epoch 30/50
1230/1230 - 28s - loss: 2.8129 - accuracy20: 0.5377 - val_loss: 3.1592 - val_accuracy20: 0.4973 - 28s/epoch - 23ms/step
Epoch 31/50
1230/1230 - 29s - loss: 2.8089 - accuracy20: 0.5385 - val_loss: 3.1757 - val_accuracy20: 0.4944 - 29s/epoch - 24ms/step
Epoch 32/50
1230/1230 - 26s - loss: 2.8070 - accuracy20: 0.5388 - val_loss: 3.1626 - val_accuracy20: 0.4968 - 26s/epoch - 21ms/step
testing model: results/WBA/W7/deepVOL_L2/h20
Evaluating performance on  test set...
4192/4192 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9555156
{'0': {'precision': 0.476615801260351, 'recall': 0.4458708891595615, 'f1-score': 0.4607310074006948, 'support': 287350}, '1': {'precision': 0.5959958353287688, 'recall': 0.7215896272901058, 'f1-score': 0.652806857517283, 'support': 505326}, '2': {'precision': 0.49566025877427633, 'recall': 0.3402311800737323, 'f1-score': 0.40349515958875004, 'support': 280474}, 'accuracy': 0.5480920654149001, 'macro avg': {'precision': 0.5227572984544654, 'recall': 0.5025638988411332, 'f1-score': 0.5056776748355759, 'support': 1073150}, 'weighted avg': {'precision': 0.5378069770255449, 'recall': 0.5480920654149001, 'f1-score': 0.536216963564146, 'support': 1073150}}
[[128121 113353  45876]
 [ 89467 364638  51221]
 [ 51226 133822  95426]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.020285
{'0': {'precision': 0.49796163202737076, 'recall': 0.462258703184293, 'f1-score': 0.4794464141519473, 'support': 96976}, '1': {'precision': 0.5131821049311324, 'recall': 0.6397214826950645, 'f1-score': 0.5695074949589973, 'support': 122075}, '2': {'precision': 0.4959404414597897, 'recall': 0.37612716039074895, 'f1-score': 0.4278032335414639, 'support': 95816}, 'accuracy': 0.5048512546567281, 'macro avg': {'precision': 0.5023613928060976, 'recall': 0.49270244875670216, 'f1-score': 0.49225238088413614, 'support': 314867}, 'weighted avg': {'precision': 0.5032475998623721, 'recall': 0.5048512546567281, 'f1-score': 0.49864805626162073, 'support': 314867}}
[[44828 34156 17992]
 [25344 78094 18637]
 [19851 39926 36039]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0276601
{'0': {'precision': 0.492137549680318, 'recall': 0.4556654187066014, 'f1-score': 0.473199747449573, 'support': 31251}, '1': {'precision': 0.5092395680630974, 'recall': 0.6283501477631713, 'f1-score': 0.562559160631807, 'support': 39252}, '2': {'precision': 0.48048398118744223, 'recall': 0.37656732405015436, 'f1-score': 0.4222257546053445, 'support': 31742}, 'accuracy': 0.49740329600469463, 'macro avg': {'precision': 0.4939536996436192, 'recall': 0.4868609635066424, 'f1-score': 0.4859948875622415, 'support': 102245}, 'weighted avg': {'precision': 0.4950851838380763, 'recall': 0.49740329600469463, 'f1-score': 0.4916800565636377, 'support': 102245}}
[[14240 10545  6466]
 [ 8130 24664  6458]
 [ 6565 13224 11953]]
training model: results/WBA/W7/deepVOL_L2/h30
Epoch 1/50
1230/1230 - 29s - loss: 3.2353 - accuracy30: 0.4092 - val_loss: 3.3123 - val_accuracy30: 0.3644 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.0963 - accuracy30: 0.4640 - val_loss: 3.2210 - val_accuracy30: 0.4364 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 29s - loss: 3.0579 - accuracy30: 0.4772 - val_loss: 3.2276 - val_accuracy30: 0.4467 - 29s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.0384 - accuracy30: 0.4836 - val_loss: 3.2155 - val_accuracy30: 0.4567 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 26s - loss: 3.0249 - accuracy30: 0.4864 - val_loss: 3.2061 - val_accuracy30: 0.4595 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.0130 - accuracy30: 0.4902 - val_loss: 3.2133 - val_accuracy30: 0.4614 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 3.0031 - accuracy30: 0.4918 - val_loss: 3.2120 - val_accuracy30: 0.4642 - 26s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.9929 - accuracy30: 0.4942 - val_loss: 3.2272 - val_accuracy30: 0.4648 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 26s - loss: 2.9849 - accuracy30: 0.4967 - val_loss: 3.2195 - val_accuracy30: 0.4664 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 28s - loss: 2.9775 - accuracy30: 0.4987 - val_loss: 3.2215 - val_accuracy30: 0.4652 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.9720 - accuracy30: 0.5003 - val_loss: 3.2196 - val_accuracy30: 0.4649 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 26s - loss: 2.9666 - accuracy30: 0.5008 - val_loss: 3.2377 - val_accuracy30: 0.4662 - 26s/epoch - 21ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.9602 - accuracy30: 0.5025 - val_loss: 3.2058 - val_accuracy30: 0.4698 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 28s - loss: 2.9555 - accuracy30: 0.5043 - val_loss: 3.2020 - val_accuracy30: 0.4675 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 26s - loss: 2.9503 - accuracy30: 0.5057 - val_loss: 3.2161 - val_accuracy30: 0.4685 - 26s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 29s - loss: 2.9464 - accuracy30: 0.5061 - val_loss: 3.2072 - val_accuracy30: 0.4691 - 29s/epoch - 23ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.9413 - accuracy30: 0.5075 - val_loss: 3.2063 - val_accuracy30: 0.4697 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.9382 - accuracy30: 0.5084 - val_loss: 3.2032 - val_accuracy30: 0.4692 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 26s - loss: 2.9339 - accuracy30: 0.5099 - val_loss: 3.2068 - val_accuracy30: 0.4693 - 26s/epoch - 21ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.9315 - accuracy30: 0.5101 - val_loss: 3.2069 - val_accuracy30: 0.4676 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 26s - loss: 2.9282 - accuracy30: 0.5111 - val_loss: 3.1978 - val_accuracy30: 0.4682 - 26s/epoch - 21ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.9250 - accuracy30: 0.5107 - val_loss: 3.2132 - val_accuracy30: 0.4665 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 30s - loss: 2.9216 - accuracy30: 0.5124 - val_loss: 3.2061 - val_accuracy30: 0.4687 - 30s/epoch - 24ms/step
Epoch 24/50
1230/1230 - 26s - loss: 2.9182 - accuracy30: 0.5136 - val_loss: 3.2099 - val_accuracy30: 0.4672 - 26s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 29s - loss: 2.9148 - accuracy30: 0.5142 - val_loss: 3.2183 - val_accuracy30: 0.4651 - 29s/epoch - 23ms/step
Epoch 26/50
1230/1230 - 28s - loss: 2.9120 - accuracy30: 0.5149 - val_loss: 3.2078 - val_accuracy30: 0.4688 - 28s/epoch - 23ms/step
Epoch 27/50
1230/1230 - 28s - loss: 2.9081 - accuracy30: 0.5163 - val_loss: 3.2253 - val_accuracy30: 0.4640 - 28s/epoch - 23ms/step
Epoch 28/50
1230/1230 - 27s - loss: 2.9060 - accuracy30: 0.5154 - val_loss: 3.1988 - val_accuracy30: 0.4705 - 27s/epoch - 22ms/step
Epoch 29/50
1230/1230 - 28s - loss: 2.9029 - accuracy30: 0.5164 - val_loss: 3.2298 - val_accuracy30: 0.4680 - 28s/epoch - 23ms/step
Epoch 30/50
1230/1230 - 27s - loss: 2.9005 - accuracy30: 0.5175 - val_loss: 3.2143 - val_accuracy30: 0.4690 - 27s/epoch - 22ms/step
Epoch 31/50
1230/1230 - 26s - loss: 2.8964 - accuracy30: 0.5182 - val_loss: 3.2289 - val_accuracy30: 0.4678 - 26s/epoch - 21ms/step
testing model: results/WBA/W7/deepVOL_L2/h30
Evaluating performance on  test set...
4192/4192 - 41s - 41s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0079324
{'0': {'precision': 0.4846310637253565, 'recall': 0.44494062055045297, 'f1-score': 0.46393849958968186, 'support': 319555}, '1': {'precision': 0.5284941859180402, 'recall': 0.7073710649470017, 'f1-score': 0.604987469061814, 'support': 439543}, '2': {'precision': 0.5131964503037298, 'recall': 0.3128558327920217, 'f1-score': 0.38873206001918875, 'support': 314052}, 'accuracy': 0.5137734706238644, 'macro avg': {'precision': 0.5087738999823755, 'recall': 0.4883891727631588, 'f1-score': 0.48588600955689487, 'support': 1073150}, 'weighted avg': {'precision': 0.5109561302152694, 'recall': 0.5137734706238644, 'f1-score': 0.499700838897977, 'support': 1073150}}
[[142183 126288  51084]
 [ 86507 310920  42116]
 [ 64694 151105  98253]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0608948
{'0': {'precision': 0.5026240140765823, 'recall': 0.4629067817369839, 'f1-score': 0.48194851119972143, 'support': 106138}, '1': {'precision': 0.4456126830342398, 'recall': 0.624234888137031, 'f1-score': 0.5200123659518772, 'support': 103743}, '2': {'precision': 0.5064495458851062, 'recall': 0.34630331663269387, 'f1-score': 0.41133877153880094, 'support': 104986}, 'accuracy': 0.47718242940670186, 'macro avg': {'precision': 0.4848954143319761, 'recall': 0.4778149955022362, 'f1-score': 0.4710998828967998, 'support': 314867}, 'weighted avg': {'precision': 0.4851153541221379, 'recall': 0.47718242940670186, 'f1-score': 0.4709464829005078, 'support': 314867}}
[[49132 37280 19726]
 [23278 64760 15705]
 [25341 43288 36357]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0671451
{'0': {'precision': 0.4873682913303346, 'recall': 0.46507320515082023, 'f1-score': 0.4759598026236611, 'support': 34014}, '1': {'precision': 0.44574896991715035, 'recall': 0.5931319086219602, 'f1-score': 0.5089860498058608, 'support': 33925}, '2': {'precision': 0.48358693446946643, 'recall': 0.347402786684545, 'f1-score': 0.40433580431205585, 'support': 34306}, 'accuracy': 0.4680815687808695, 'macro avg': {'precision': 0.4722347319056504, 'recall': 0.4685359668191085, 'f1-score': 0.46309388558052594, 'support': 102245}, 'weighted avg': {'precision': 0.4722902072439615, 'recall': 0.4680815687808695, 'f1-score': 0.46288613202439655, 'support': 102245}}
[[15819 11267  6928]
 [ 8004 20122  5799]
 [ 8635 13753 11918]]
training model: results/WBA/W7/deepVOL_L2/h50
Epoch 1/50
1230/1230 - 29s - loss: 3.2640 - accuracy50: 0.3942 - val_loss: 3.2778 - val_accuracy50: 0.3789 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.1899 - accuracy50: 0.4262 - val_loss: 3.2759 - val_accuracy50: 0.3855 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.1636 - accuracy50: 0.4385 - val_loss: 3.2460 - val_accuracy50: 0.4029 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.1496 - accuracy50: 0.4456 - val_loss: 3.2382 - val_accuracy50: 0.4092 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.1403 - accuracy50: 0.4483 - val_loss: 3.2254 - val_accuracy50: 0.4240 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.1328 - accuracy50: 0.4518 - val_loss: 3.2297 - val_accuracy50: 0.4258 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.1266 - accuracy50: 0.4539 - val_loss: 3.2270 - val_accuracy50: 0.4296 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 29s - loss: 3.1209 - accuracy50: 0.4558 - val_loss: 3.2196 - val_accuracy50: 0.4319 - 29s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.1154 - accuracy50: 0.4581 - val_loss: 3.2242 - val_accuracy50: 0.4314 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 29s - loss: 3.1118 - accuracy50: 0.4597 - val_loss: 3.2364 - val_accuracy50: 0.4309 - 29s/epoch - 24ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.1068 - accuracy50: 0.4604 - val_loss: 3.2547 - val_accuracy50: 0.4293 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 28s - loss: 3.1040 - accuracy50: 0.4618 - val_loss: 3.2398 - val_accuracy50: 0.4339 - 28s/epoch - 23ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.0998 - accuracy50: 0.4636 - val_loss: 3.2313 - val_accuracy50: 0.4335 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 28s - loss: 3.0960 - accuracy50: 0.4646 - val_loss: 3.2292 - val_accuracy50: 0.4340 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 26s - loss: 3.0920 - accuracy50: 0.4654 - val_loss: 3.2376 - val_accuracy50: 0.4349 - 26s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 27s - loss: 3.0891 - accuracy50: 0.4670 - val_loss: 3.2492 - val_accuracy50: 0.4328 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 26s - loss: 3.0850 - accuracy50: 0.4686 - val_loss: 3.2431 - val_accuracy50: 0.4368 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 26s - loss: 3.0825 - accuracy50: 0.4693 - val_loss: 3.2524 - val_accuracy50: 0.4342 - 26s/epoch - 21ms/step
testing model: results/WBA/W7/deepVOL_L2/h50
Evaluating performance on  test set...
4192/4192 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0496091
{'0': {'precision': 0.4245781499818719, 'recall': 0.44055493368610293, 'f1-score': 0.4324190167755019, 'support': 324291}, '1': {'precision': 0.4776694045174538, 'recall': 0.6509468967359064, 'f1-score': 0.5510064247539579, 'support': 423119}, '2': {'precision': 0.458924822553234, 'recall': 0.22548658439246025, 'f1-score': 0.30239528353932166, 'support': 325740}, 'accuracy': 0.4582267157433723, 'macro avg': {'precision': 0.4537241256841866, 'recall': 0.4389961382714899, 'f1-score': 0.4286069083562605, 'support': 1073150}, 'weighted avg': {'precision': 0.4559363046212386, 'recall': 0.4582267157433723, 'f1-score': 0.4397084493917093, 'support': 1073150}}
[[142868 136601  44822]
 [105915 275428  41776]
 [ 87711 164579  73450]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0798355
{'0': {'precision': 0.4382263876435858, 'recall': 0.48815143549010187, 'f1-score': 0.4618436125213391, 'support': 106131}, '1': {'precision': 0.4128858781234216, 'recall': 0.5350878881808205, 'f1-score': 0.46611043562114796, 'support': 103882}, '2': {'precision': 0.460260896205879, 'recall': 0.2722261430179106, 'f1-score': 0.34210857488718827, 'support': 104854}, 'accuracy': 0.4317314929795755, 'macro avg': {'precision': 0.4371243873242954, 'recall': 0.431821822229611, 'f1-score': 0.4233542076765584, 'support': 314867}, 'weighted avg': {'precision': 0.43720368139242893, 'recall': 0.4317314929795755, 'f1-score': 0.4233783191789535, 'support': 314867}}
[[51808 36590 17733]
 [32556 55586 15740]
 [33858 42452 28544]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0730689
{'0': {'precision': 0.4330203683751475, 'recall': 0.4929906542056075, 'f1-score': 0.4610636147605911, 'support': 34240}, '1': {'precision': 0.4213795594077284, 'recall': 0.5166642066420665, 'f1-score': 0.4641824691685453, 'support': 33875}, '2': {'precision': 0.45061671575846834, 'recall': 0.2868737181365368, 'f1-score': 0.35056751047298507, 'support': 34130}, 'accuracy': 0.4320309061567803, 'macro avg': {'precision': 0.4350055478471148, 'recall': 0.4321761929947369, 'f1-score': 0.42527119813404046, 'support': 102245}, 'weighted avg': {'precision': 0.4350373954417172, 'recall': 0.4320309061567803, 'f1-score': 0.4252126602272003, 'support': 102245}}
[[16880 11126  6234]
 [10670 17502  5703]
 [11432 12907  9791]]
training model: results/WBA/W7/deepVOL_L2/h100
Epoch 1/50
1230/1230 - 29s - loss: 3.2781 - accuracy100: 0.3810 - val_loss: 3.2796 - val_accuracy100: 0.3823 - 29s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2389 - accuracy100: 0.3967 - val_loss: 3.2991 - val_accuracy100: 0.3771 - 28s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 29s - loss: 3.2307 - accuracy100: 0.4040 - val_loss: 3.2618 - val_accuracy100: 0.3899 - 29s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.2235 - accuracy100: 0.4089 - val_loss: 3.2710 - val_accuracy100: 0.3904 - 26s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2197 - accuracy100: 0.4109 - val_loss: 3.2729 - val_accuracy100: 0.3921 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 26s - loss: 3.2163 - accuracy100: 0.4134 - val_loss: 3.2590 - val_accuracy100: 0.3965 - 26s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2127 - accuracy100: 0.4149 - val_loss: 3.2604 - val_accuracy100: 0.3967 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2083 - accuracy100: 0.4167 - val_loss: 3.2600 - val_accuracy100: 0.3972 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.2061 - accuracy100: 0.4170 - val_loss: 3.2557 - val_accuracy100: 0.3990 - 28s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2032 - accuracy100: 0.4184 - val_loss: 3.2554 - val_accuracy100: 0.4004 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 28s - loss: 3.1995 - accuracy100: 0.4205 - val_loss: 3.2550 - val_accuracy100: 0.4010 - 28s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 26s - loss: 3.1973 - accuracy100: 0.4215 - val_loss: 3.2581 - val_accuracy100: 0.3972 - 26s/epoch - 21ms/step
Epoch 13/50
1230/1230 - 28s - loss: 3.1954 - accuracy100: 0.4228 - val_loss: 3.2592 - val_accuracy100: 0.3976 - 28s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 28s - loss: 3.1930 - accuracy100: 0.4233 - val_loss: 3.2596 - val_accuracy100: 0.3970 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.1901 - accuracy100: 0.4245 - val_loss: 3.2619 - val_accuracy100: 0.3972 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 28s - loss: 3.1874 - accuracy100: 0.4258 - val_loss: 3.2673 - val_accuracy100: 0.3986 - 28s/epoch - 23ms/step
Epoch 17/50
1230/1230 - 30s - loss: 3.1853 - accuracy100: 0.4275 - val_loss: 3.2734 - val_accuracy100: 0.3979 - 30s/epoch - 24ms/step
Epoch 18/50
1230/1230 - 26s - loss: 3.1820 - accuracy100: 0.4289 - val_loss: 3.2724 - val_accuracy100: 0.3982 - 26s/epoch - 21ms/step
Epoch 19/50
1230/1230 - 28s - loss: 3.1789 - accuracy100: 0.4302 - val_loss: 3.2741 - val_accuracy100: 0.3982 - 28s/epoch - 23ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.1759 - accuracy100: 0.4319 - val_loss: 3.2773 - val_accuracy100: 0.3989 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 28s - loss: 3.1735 - accuracy100: 0.4319 - val_loss: 3.2908 - val_accuracy100: 0.3980 - 28s/epoch - 23ms/step
testing model: results/WBA/W7/deepVOL_L2/h100
Evaluating performance on  test set...
4192/4192 - 41s - 41s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025906
{'0': {'precision': 0.3287648949359192, 'recall': 0.6595453465346535, 'f1-score': 0.43880018127970827, 'support': 315625}, '1': {'precision': 0.4680297234313855, 'recall': 0.12357523480037615, 'f1-score': 0.1955253490080823, 'support': 430685}, '2': {'precision': 0.38300689655172415, 'recall': 0.38231550605801, 'f1-score': 0.38266088900457823, 'support': 326840}, 'accuracy': 0.36001211387038157, 'macro avg': {'precision': 0.3932671716396763, 'recall': 0.38847869579767985, 'f1-score': 0.33899547309745626, 'support': 1073150}, 'weighted avg': {'precision': 0.40117576803723737, 'recall': 0.36001211387038157, 'f1-score': 0.3240693538798958, 'support': 1073150}}
[[208169  26118  81338]
 [257507  53222 119956]
 [167509  34375 124956]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0919917
{'0': {'precision': 0.37360229098580156, 'recall': 0.640756223755249, 'f1-score': 0.4719987848073298, 'support': 106688}, '1': {'precision': 0.4141903914590747, 'recall': 0.09043054301059604, 'f1-score': 0.14844989357716254, 'support': 102963}, '2': {'precision': 0.4000859161494941, 'recall': 0.4160298813868613, 'f1-score': 0.4079021549213745, 'support': 105216}, 'accuracy': 0.3857025347210092, 'macro avg': {'precision': 0.3959595328647901, 'recall': 0.3824055493842355, 'f1-score': 0.3427836111019556, 'support': 314867}, 'weighted avg': {'precision': 0.3957245638637237, 'recall': 0.3857025347210092, 'f1-score': 0.34477822661033747, 'support': 314867}}
[[68361  6160 32167]
 [60183  9311 33469]
 [54434  7009 43773]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0846447
{'0': {'precision': 0.39283766278039134, 'recall': 0.633977938547025, 'f1-score': 0.48509276896685993, 'support': 36353}, '1': {'precision': 0.3771961932650073, 'recall': 0.06980052155654147, 'f1-score': 0.11780172044239948, 'support': 29527}, '2': {'precision': 0.41300868470075824, 'recall': 0.43286126770246114, 'f1-score': 0.422702005961492, 'support': 36365}, 'accuracy': 0.3995207589613184, 'macro avg': {'precision': 0.3943475135820523, 'recall': 0.3788799092686759, 'f1-score': 0.3418654984569171, 'support': 102245}, 'weighted avg': {'precision': 0.3954947466647221, 'recall': 0.3995207589613184, 'f1-score': 0.35683375496644965, 'support': 102245}}
[[23047  1586 11720]
 [16814  2061 10652]
 [18807  1817 15741]]
training model: results/WBA/W7/deepVOL_L2/h200
Epoch 1/50
1230/1230 - 28s - loss: 3.3117 - accuracy200: 0.3557 - val_loss: 3.3085 - val_accuracy200: 0.3351 - 28s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 28s - loss: 3.2824 - accuracy200: 0.3657 - val_loss: 3.3134 - val_accuracy200: 0.3399 - 28s/epoch - 23ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2740 - accuracy200: 0.3730 - val_loss: 3.3009 - val_accuracy200: 0.3430 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2687 - accuracy200: 0.3770 - val_loss: 3.2983 - val_accuracy200: 0.3409 - 28s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2652 - accuracy200: 0.3784 - val_loss: 3.3011 - val_accuracy200: 0.3399 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 29s - loss: 3.2612 - accuracy200: 0.3816 - val_loss: 3.2989 - val_accuracy200: 0.3435 - 29s/epoch - 24ms/step
Epoch 7/50
1230/1230 - 28s - loss: 3.2583 - accuracy200: 0.3838 - val_loss: 3.3079 - val_accuracy200: 0.3443 - 28s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2550 - accuracy200: 0.3863 - val_loss: 3.3053 - val_accuracy200: 0.3449 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2520 - accuracy200: 0.3888 - val_loss: 3.3140 - val_accuracy200: 0.3472 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2493 - accuracy200: 0.3904 - val_loss: 3.3189 - val_accuracy200: 0.3442 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2472 - accuracy200: 0.3925 - val_loss: 3.3173 - val_accuracy200: 0.3461 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2440 - accuracy200: 0.3943 - val_loss: 3.3226 - val_accuracy200: 0.3428 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 29s - loss: 3.2415 - accuracy200: 0.3957 - val_loss: 3.3339 - val_accuracy200: 0.3456 - 29s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 26s - loss: 3.2379 - accuracy200: 0.3984 - val_loss: 3.3447 - val_accuracy200: 0.3484 - 26s/epoch - 21ms/step
testing model: results/WBA/W7/deepVOL_L2/h200
Evaluating performance on  test set...
4192/4192 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979462
{'0': {'precision': 0.3608673205988642, 'recall': 0.14861492941027088, 'f1-score': 0.21052851743632753, 'support': 338647}, '1': {'precision': 0.3564044772128204, 'recall': 0.855949041914598, 'f1-score': 0.503259265538247, 'support': 381490}, '2': {'precision': 0.38785661197187127, 'recall': 0.019217422587836708, 'f1-score': 0.03662038736423898, 'support': 353013}, 'accuracy': 0.3574970880119275, 'macro avg': {'precision': 0.3683761365945187, 'recall': 0.34126046463756854, 'f1-score': 0.2501360567796045, 'support': 1073150}, 'weighted avg': {'precision': 0.36815897655760016, 'recall': 0.3574970880119275, 'f1-score': 0.2573831252472235, 'support': 1073150}}
[[ 50328 282205   6114]
 [ 50361 326536   4593]
 [ 38775 307454   6784]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022199
{'0': {'precision': 0.39969078363443755, 'recall': 0.1291874884323524, 'f1-score': 0.19526250638169904, 'support': 108060}, '1': {'precision': 0.32471463637464365, 'recall': 0.8754055551159294, 'f1-score': 0.47371421383513146, 'support': 101096}, '2': {'precision': 0.4141755714865413, 'recall': 0.028965765152160136, 'f1-score': 0.054144857829961805, 'support': 105711}, 'accuracy': 0.3351319763582719, 'macro avg': {'precision': 0.37952699716520755, 'recall': 0.3445196029001473, 'f1-score': 0.24104052601559744, 'support': 314867}, 'weighted avg': {'precision': 0.38048080870933465, 'recall': 0.3351319763582719, 'f1-score': 0.23728871449706052, 'support': 314867}}
[[13960 91506  2594]
 [10859 88500  1737]
 [10108 92541  3062]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1007192
{'0': {'precision': 0.3809329802403748, 'recall': 0.10940791013339574, 'f1-score': 0.16999227307849643, 'support': 34184}, '1': {'precision': 0.3354558126568163, 'recall': 0.891239297247652, 'f1-score': 0.48744207149107177, 'support': 33753}, '2': {'precision': 0.4095203488372093, 'recall': 0.03284948117057246, 'f1-score': 0.06082029141932002, 'support': 34308}, 'accuracy': 0.34181622573230963, 'macro avg': {'precision': 0.37530304724480007, 'recall': 0.34449889618387336, 'f1-score': 0.23941821199629607, 'support': 102245}, 'weighted avg': {'precision': 0.37551251571274363, 'recall': 0.34181622573230963, 'f1-score': 0.23815610210736465, 'support': 102245}}
[[ 3740 29445   999]
 [ 3045 30082   626]
 [ 3033 30148  1127]]
training model: results/WBA/W7/deepVOL_L2/h300
Epoch 1/50
1230/1230 - 28s - loss: 3.2845 - accuracy300: 0.3829 - val_loss: 3.3199 - val_accuracy300: 0.3372 - 28s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.2578 - accuracy300: 0.3825 - val_loss: 3.3076 - val_accuracy300: 0.3353 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 26s - loss: 3.2501 - accuracy300: 0.3862 - val_loss: 3.3128 - val_accuracy300: 0.3373 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2520 - accuracy300: 0.3840 - val_loss: 3.3298 - val_accuracy300: 0.3246 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2501 - accuracy300: 0.3869 - val_loss: 3.3027 - val_accuracy300: 0.3442 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2499 - accuracy300: 0.3876 - val_loss: 3.3026 - val_accuracy300: 0.3426 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 3.2446 - accuracy300: 0.3903 - val_loss: 3.3030 - val_accuracy300: 0.3449 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 28s - loss: 3.2401 - accuracy300: 0.3920 - val_loss: 3.3017 - val_accuracy300: 0.3486 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.2345 - accuracy300: 0.3967 - val_loss: 3.3042 - val_accuracy300: 0.3465 - 28s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 28s - loss: 3.2324 - accuracy300: 0.3977 - val_loss: 3.3048 - val_accuracy300: 0.3452 - 28s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2295 - accuracy300: 0.4000 - val_loss: 3.3040 - val_accuracy300: 0.3466 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2248 - accuracy300: 0.4027 - val_loss: 3.3106 - val_accuracy300: 0.3430 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 3.2225 - accuracy300: 0.4034 - val_loss: 3.3122 - val_accuracy300: 0.3432 - 28s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.2210 - accuracy300: 0.4039 - val_loss: 3.3167 - val_accuracy300: 0.3439 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 28s - loss: 3.2168 - accuracy300: 0.4080 - val_loss: 3.3212 - val_accuracy300: 0.3428 - 28s/epoch - 23ms/step
Epoch 16/50
1230/1230 - 28s - loss: 3.2149 - accuracy300: 0.4089 - val_loss: 3.3268 - val_accuracy300: 0.3435 - 28s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 26s - loss: 3.2120 - accuracy300: 0.4106 - val_loss: 3.3318 - val_accuracy300: 0.3401 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 28s - loss: 3.2090 - accuracy300: 0.4130 - val_loss: 3.3431 - val_accuracy300: 0.3404 - 28s/epoch - 23ms/step
testing model: results/WBA/W7/deepVOL_L2/h300
Evaluating performance on  test set...
4192/4192 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950282
{'0': {'precision': 0.2700181455210188, 'recall': 0.5587566311726944, 'f1-score': 0.3640903019484167, 'support': 287091}, '1': {'precision': 0.4727227491624434, 'recall': 0.2860935156976756, 'f1-score': 0.35645760250825587, 'support': 484817}, '2': {'precision': 0.3375581063393141, 'recall': 0.20803208051998062, 'f1-score': 0.25742000809212706, 'support': 301242}, 'accuracy': 0.3371243535386479, 'macro avg': {'precision': 0.36009966700759205, 'recall': 0.3509607424634502, 'f1-score': 0.3259893041829332, 'support': 1073150}, 'weighted avg': {'precision': 0.38055302946124103, 'recall': 0.3371243535386479, 'f1-score': 0.33069885144630906, 'support': 1073150}}
[[160414  72826  53851]
 [276982 138703  69132]
 [156690  81884  62668]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966202
{'0': {'precision': 0.35537854022086407, 'recall': 0.5317140373911274, 'f1-score': 0.42602037981575935, 'support': 108154}, '1': {'precision': 0.3523113052577784, 'recall': 0.28402982146360606, 'f1-score': 0.3145071501116102, 'support': 101940}, '2': {'precision': 0.37364001975587385, 'recall': 0.25271778034417264, 'f1-score': 0.30150650770334436, 'support': 104773}, 'accuracy': 0.35868795396151393, 'macro avg': {'precision': 0.3604432884115054, 'recall': 0.3561538797329687, 'f1-score': 0.3473446792102379, 'support': 314867}, 'weighted avg': {'precision': 0.36046207092806626, 'recall': 0.35868795396151393, 'f1-score': 0.3484849424441865, 'support': 314867}}
[[57507 26381 24266]
 [52865 28954 20121]
 [51447 26848 26478]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990309
{'0': {'precision': 0.33583009015704146, 'recall': 0.5150724376855934, 'f1-score': 0.40657259210152474, 'support': 33339}, '1': {'precision': 0.3630628499329706, 'recall': 0.2625905435464553, 'f1-score': 0.3047593830674522, 'support': 35066}, '2': {'precision': 0.3599223300970874, 'recall': 0.2738770685579196, 'f1-score': 0.3110589025004195, 'support': 33840}, 'accuracy': 0.34865274585554307, 'macro avg': {'precision': 0.3529384233956998, 'recall': 0.35051334992998945, 'f1-score': 0.34079695922313213, 'support': 102245}, 'weighted avg': {'precision': 0.35314365418338883, 'recall': 0.34865274585554307, 'f1-score': 0.34004253934500667, 'support': 102245}}
[[17172  7784  8383]
 [17759  9208  8099]
 [16202  8370  9268]]
training model: results/WBA/W7/deepVOL_L2/h500
Epoch 1/50
1230/1230 - 29s - loss: 3.3001 - accuracy500: 0.3749 - val_loss: 3.3241 - val_accuracy500: 0.3533 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 30s - loss: 3.2558 - accuracy500: 0.3911 - val_loss: 3.3600 - val_accuracy500: 0.3495 - 30s/epoch - 24ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2445 - accuracy500: 0.3954 - val_loss: 3.3665 - val_accuracy500: 0.3498 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2387 - accuracy500: 0.3980 - val_loss: 3.3492 - val_accuracy500: 0.3495 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 28s - loss: 3.2343 - accuracy500: 0.3997 - val_loss: 3.3731 - val_accuracy500: 0.3488 - 28s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.2296 - accuracy500: 0.4008 - val_loss: 3.3542 - val_accuracy500: 0.3486 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 28s - loss: 3.2272 - accuracy500: 0.4034 - val_loss: 3.3565 - val_accuracy500: 0.3494 - 28s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 26s - loss: 3.2249 - accuracy500: 0.4046 - val_loss: 3.3693 - val_accuracy500: 0.3490 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2228 - accuracy500: 0.4076 - val_loss: 3.3460 - val_accuracy500: 0.3508 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 29s - loss: 3.2183 - accuracy500: 0.4102 - val_loss: 3.3564 - val_accuracy500: 0.3533 - 29s/epoch - 24ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2155 - accuracy500: 0.4111 - val_loss: 3.3652 - val_accuracy500: 0.3549 - 27s/epoch - 22ms/step
testing model: results/WBA/W7/deepVOL_L2/h500
Evaluating performance on  test set...
4192/4192 - 41s - 41s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0882069
{'0': {'precision': 0.35897044222103414, 'recall': 0.015152394400706683, 'f1-score': 0.02907741087309566, 'support': 310182}, '1': {'precision': 0.4034489056997224, 'recall': 0.9860037431849622, 'f1-score': 0.5726026453987035, 'support': 430115}, '2': {'precision': 0.36203985140155354, 'recall': 0.009661922830799181, 'f1-score': 0.01882154645691411, 'support': 332853}, 'accuracy': 0.40256348133998043, 'macro avg': {'precision': 0.3748197331074367, 'recall': 0.33693935347215603, 'f1-score': 0.20683386757623778, 'support': 1073150}, 'weighted avg': {'precision': 0.3777492861599983, 'recall': 0.40256348133998043, 'f1-score': 0.24373953733208328, 'support': 1073150}}
[[  4700 302390   3092]
 [  3445 424095   2575]
 [  4948 324689   3216]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1100268
{'0': {'precision': 0.36572603251728647, 'recall': 0.018550642210531303, 'f1-score': 0.03531025025711347, 'support': 105495}, '1': {'precision': 0.34145240727053916, 'recall': 0.9783087374092293, 'f1-score': 0.5062217126012408, 'support': 106725}, '2': {'precision': 0.3776111408677022, 'recall': 0.013736397556674818, 'f1-score': 0.02650849305797088, 'support': 102647}, 'accuracy': 0.34229373036869537, 'macro avg': {'precision': 0.36159652688517596, 'recall': 0.33686525905881176, 'f1-score': 0.18934681863877503, 'support': 314867}, 'weighted avg': {'precision': 0.3613729820622881, 'recall': 0.34229373036869537, 'f1-score': 0.19205754942614867, 'support': 314867}}
[[  1957 102163   1375]
 [  1366 104410    949]
 [  2028  99209   1410]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062269
{'0': {'precision': 0.37577962577962576, 'recall': 0.02221949045760472, 'f1-score': 0.04195804195804196, 'support': 32539}, '1': {'precision': 0.3523456366006204, 'recall': 0.9764238113904912, 'f1-score': 0.5178304933734269, 'support': 35714}, '2': {'precision': 0.36518518518518517, 'recall': 0.01450341256766298, 'f1-score': 0.02789881727123536, 'support': 33992}, 'accuracy': 0.3529561347743166, 'macro avg': {'precision': 0.3644368158551437, 'recall': 0.3377155714719196, 'f1-score': 0.1958957842009014, 'support': 102245}, 'weighted avg': {'precision': 0.3640719851690803, 'recall': 0.3529561347743166, 'f1-score': 0.20350537986498243, 'support': 102245}}
[[  723 31328   488]
 [  473 34872   369]
 [  728 32771   493]]
training model: results/WBA/W7/deepVOL_L2/h1000
Epoch 1/50
1230/1230 - 29s - loss: 3.3096 - accuracy1000: 0.3664 - val_loss: 3.3102 - val_accuracy1000: 0.3296 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.2826 - accuracy1000: 0.3700 - val_loss: 3.3053 - val_accuracy1000: 0.3359 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 26s - loss: 3.2752 - accuracy1000: 0.3755 - val_loss: 3.3039 - val_accuracy1000: 0.3389 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 28s - loss: 3.2700 - accuracy1000: 0.3777 - val_loss: 3.3053 - val_accuracy1000: 0.3348 - 28s/epoch - 23ms/step
Epoch 5/50
1230/1230 - 26s - loss: 3.2651 - accuracy1000: 0.3801 - val_loss: 3.3073 - val_accuracy1000: 0.3372 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2633 - accuracy1000: 0.3827 - val_loss: 3.3041 - val_accuracy1000: 0.3414 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 29s - loss: 3.2620 - accuracy1000: 0.3837 - val_loss: 3.3046 - val_accuracy1000: 0.3408 - 29s/epoch - 23ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2588 - accuracy1000: 0.3846 - val_loss: 3.3060 - val_accuracy1000: 0.3409 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 28s - loss: 3.2553 - accuracy1000: 0.3865 - val_loss: 3.3098 - val_accuracy1000: 0.3398 - 28s/epoch - 23ms/step
Epoch 10/50
1230/1230 - 28s - loss: 3.2513 - accuracy1000: 0.3894 - val_loss: 3.3104 - val_accuracy1000: 0.3375 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2487 - accuracy1000: 0.3907 - val_loss: 3.3097 - val_accuracy1000: 0.3377 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2443 - accuracy1000: 0.3932 - val_loss: 3.3094 - val_accuracy1000: 0.3398 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 26s - loss: 3.2435 - accuracy1000: 0.3928 - val_loss: 3.3120 - val_accuracy1000: 0.3412 - 26s/epoch - 21ms/step
testing model: results/WBA/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
4192/4192 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943186
{'0': {'precision': 0.3167098276177771, 'recall': 0.0773209866687954, 'f1-score': 0.12429645332915847, 'support': 313175}, '1': {'precision': 0.3897997880203275, 'recall': 0.9302440208989029, 'f1-score': 0.5493892243628657, 'support': 415907}, '2': {'precision': 0.3511100386100386, 'recall': 0.0042288152341978915, 'f1-score': 0.008356977932983355, 'support': 344068}, 'accuracy': 0.3844429949214928, 'macro avg': {'precision': 0.352539884749381, 'recall': 0.33726460760063204, 'f1-score': 0.22734755187500255, 'support': 1073150}, 'weighted avg': {'precision': 0.3560655914502599, 'recall': 0.3844429949214928, 'f1-score': 0.2518722774932594, 'support': 1073150}}
[[ 24215 287609   1351]
 [ 27674 386895   1338]
 [ 24569 318044   1455]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007062
{'0': {'precision': 0.3653925195232224, 'recall': 0.0817704357104094, 'f1-score': 0.13363497658757298, 'support': 108719}, '1': {'precision': 0.32713725055892795, 'recall': 0.9226001659265043, 'f1-score': 0.48300847468453073, 'support': 102455}, '2': {'precision': 0.382149591451917, 'recall': 0.005863462335933959, 'f1-score': 0.011549713156794957, 'support': 103693}, 'accuracy': 0.3303712361092144, 'macro avg': {'precision': 0.3582264538446891, 'recall': 0.3367446879909492, 'f1-score': 0.20939772147629956, 'support': 314867}, 'weighted avg': {'precision': 0.35846307781534364, 'recall': 0.3303712361092144, 'f1-score': 0.20711258626593287, 'support': 314867}}
[[ 8890 99288   541]
 [ 7488 94525   442]
 [ 7952 95133   608]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005203
{'0': {'precision': 0.32809885442141845, 'recall': 0.07736198367173511, 'f1-score': 0.1252026130949457, 'support': 32949}, '1': {'precision': 0.33964997496777766, 'recall': 0.9246607122143603, 'f1-score': 0.49680982837733617, 'support': 34484}, '2': {'precision': 0.4103852596314908, 'recall': 0.007037803056417327, 'f1-score': 0.013838289700358665, 'support': 34812}, 'accuracy': 0.33918529023424127, 'macro avg': {'precision': 0.3593780296735623, 'recall': 0.3363534996475042, 'f1-score': 0.21195024372421353, 'support': 102245}, 'weighted avg': {'precision': 0.3600112528672465, 'recall': 0.33918529023424127, 'f1-score': 0.2126170430014017, 'support': 102245}}
[[ 2549 30185   215]
 [ 2461 31886   137]
 [ 2759 31808   245]]
training model: results/WBA/W7/deepVOL_L3/h10
Epoch 1/50
1230/1230 - 43s - loss: 3.3054 - accuracy10: 0.3712 - val_loss: 3.4153 - val_accuracy10: 0.5011 - 43s/epoch - 35ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2574 - accuracy10: 0.4106 - val_loss: 3.2719 - val_accuracy10: 0.4929 - 41s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 40s - loss: 3.0578 - accuracy10: 0.4520 - val_loss: 3.1091 - val_accuracy10: 0.4724 - 40s/epoch - 33ms/step
Epoch 4/50
1230/1230 - 40s - loss: 2.9446 - accuracy10: 0.4833 - val_loss: 3.0372 - val_accuracy10: 0.4812 - 40s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 42s - loss: 2.8967 - accuracy10: 0.4991 - val_loss: 3.0022 - val_accuracy10: 0.4806 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 2.8654 - accuracy10: 0.5101 - val_loss: 2.9483 - val_accuracy10: 0.4980 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 2.8421 - accuracy10: 0.5192 - val_loss: 2.9414 - val_accuracy10: 0.5067 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 2.8246 - accuracy10: 0.5229 - val_loss: 2.9416 - val_accuracy10: 0.5068 - 40s/epoch - 32ms/step
Epoch 9/50
1230/1230 - 41s - loss: 2.8109 - accuracy10: 0.5262 - val_loss: 2.9190 - val_accuracy10: 0.5109 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 2.8004 - accuracy10: 0.5292 - val_loss: 2.9199 - val_accuracy10: 0.5085 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 44s - loss: 2.7905 - accuracy10: 0.5305 - val_loss: 2.9172 - val_accuracy10: 0.5173 - 44s/epoch - 36ms/step
Epoch 12/50
1230/1230 - 41s - loss: 2.7829 - accuracy10: 0.5331 - val_loss: 2.9117 - val_accuracy10: 0.5126 - 41s/epoch - 34ms/step
Epoch 13/50
1230/1230 - 41s - loss: 2.7752 - accuracy10: 0.5356 - val_loss: 2.9087 - val_accuracy10: 0.5145 - 41s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 41s - loss: 2.7689 - accuracy10: 0.5367 - val_loss: 2.9092 - val_accuracy10: 0.5195 - 41s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 41s - loss: 2.7615 - accuracy10: 0.5383 - val_loss: 2.8974 - val_accuracy10: 0.5191 - 41s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 41s - loss: 2.7556 - accuracy10: 0.5396 - val_loss: 2.8969 - val_accuracy10: 0.5224 - 41s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 41s - loss: 2.7505 - accuracy10: 0.5402 - val_loss: 2.9019 - val_accuracy10: 0.5247 - 41s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 40s - loss: 2.7461 - accuracy10: 0.5412 - val_loss: 2.8973 - val_accuracy10: 0.5222 - 40s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 40s - loss: 2.7399 - accuracy10: 0.5418 - val_loss: 2.8977 - val_accuracy10: 0.5234 - 40s/epoch - 33ms/step
Epoch 20/50
1230/1230 - 41s - loss: 2.7357 - accuracy10: 0.5431 - val_loss: 2.8920 - val_accuracy10: 0.5274 - 41s/epoch - 33ms/step
Epoch 21/50
1230/1230 - 40s - loss: 2.7314 - accuracy10: 0.5438 - val_loss: 2.9144 - val_accuracy10: 0.5260 - 40s/epoch - 33ms/step
Epoch 22/50
1230/1230 - 41s - loss: 2.7266 - accuracy10: 0.5444 - val_loss: 2.9244 - val_accuracy10: 0.5276 - 41s/epoch - 33ms/step
Epoch 23/50
1230/1230 - 41s - loss: 2.7237 - accuracy10: 0.5457 - val_loss: 2.9164 - val_accuracy10: 0.5260 - 41s/epoch - 33ms/step
Epoch 24/50
1230/1230 - 41s - loss: 2.7182 - accuracy10: 0.5465 - val_loss: 2.8991 - val_accuracy10: 0.5313 - 41s/epoch - 33ms/step
Epoch 25/50
1230/1230 - 41s - loss: 2.7147 - accuracy10: 0.5468 - val_loss: 2.8846 - val_accuracy10: 0.5274 - 41s/epoch - 33ms/step
Epoch 26/50
1230/1230 - 41s - loss: 2.7114 - accuracy10: 0.5479 - val_loss: 2.8804 - val_accuracy10: 0.5319 - 41s/epoch - 33ms/step
Epoch 27/50
1230/1230 - 40s - loss: 2.7088 - accuracy10: 0.5480 - val_loss: 2.8857 - val_accuracy10: 0.5288 - 40s/epoch - 33ms/step
Epoch 28/50
1230/1230 - 41s - loss: 2.7042 - accuracy10: 0.5496 - val_loss: 2.8938 - val_accuracy10: 0.5307 - 41s/epoch - 34ms/step
Epoch 29/50
1230/1230 - 41s - loss: 2.7000 - accuracy10: 0.5513 - val_loss: 2.9066 - val_accuracy10: 0.5279 - 41s/epoch - 33ms/step
Epoch 30/50
1230/1230 - 40s - loss: 2.6951 - accuracy10: 0.5511 - val_loss: 2.8955 - val_accuracy10: 0.5293 - 40s/epoch - 33ms/step
Epoch 31/50
1230/1230 - 41s - loss: 2.6935 - accuracy10: 0.5517 - val_loss: 2.8960 - val_accuracy10: 0.5306 - 41s/epoch - 33ms/step
Epoch 32/50
1230/1230 - 40s - loss: 2.6885 - accuracy10: 0.5519 - val_loss: 2.8991 - val_accuracy10: 0.5275 - 40s/epoch - 33ms/step
Epoch 33/50
1230/1230 - 40s - loss: 2.6854 - accuracy10: 0.5535 - val_loss: 2.9103 - val_accuracy10: 0.5300 - 40s/epoch - 33ms/step
Epoch 34/50
1230/1230 - 41s - loss: 2.6813 - accuracy10: 0.5540 - val_loss: 2.8993 - val_accuracy10: 0.5240 - 41s/epoch - 33ms/step
Epoch 35/50
1230/1230 - 41s - loss: 2.6783 - accuracy10: 0.5548 - val_loss: 2.8961 - val_accuracy10: 0.5290 - 41s/epoch - 33ms/step
Epoch 36/50
1230/1230 - 41s - loss: 2.6750 - accuracy10: 0.5546 - val_loss: 2.9102 - val_accuracy10: 0.5265 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h10
Evaluating performance on  test set...
4192/4192 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86606425
{'0': {'precision': 0.39109185985210093, 'recall': 0.6110663383661856, 'f1-score': 0.47693681733987137, 'support': 224591}, '1': {'precision': 0.7529534610752885, 'recall': 0.6275614648331107, 'f1-score': 0.6845627933687722, 'support': 629669}, '2': {'precision': 0.45408682702973757, 'recall': 0.40956188039654623, 'f1-score': 0.43067662382271205, 'support': 218890}, 'accuracy': 0.5796440385780179, 'macro avg': {'precision': 0.532710715985709, 'recall': 0.5493965611986141, 'f1-score': 0.5307254115104519, 'support': 1073150}, 'weighted avg': {'precision': 0.6162626197142973, 'recall': 0.5796440385780179, 'f1-score': 0.5893253435861286, 'support': 1073150}}
[[137240  53821  33530]
 [160265 395156  74248]
 [ 53410  75831  89649]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92593205
{'0': {'precision': 0.42175634508853715, 'recall': 0.6201959695846943, 'f1-score': 0.5020797625517328, 'support': 77461}, '1': {'precision': 0.6982723353368788, 'recall': 0.5517764446240403, 'f1-score': 0.6164403065671632, 'support': 160855}, '2': {'precision': 0.4575773167957537, 'recall': 0.44144426591422714, 'f1-score': 0.44936603658171714, 'support': 76551}, 'accuracy': 0.5417843089304373, 'macro avg': {'precision': 0.5258686657403899, 'recall': 0.5378055600409873, 'f1-score': 0.5226287019002044, 'support': 314867}, 'weighted avg': {'precision': 0.5717279547413624, 'recall': 0.5417843089304373, 'f1-score': 0.5476868819731755, 'support': 314867}}
[[48041 15996 13424]
 [45464 88756 26635]
 [20402 22356 33793]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93791157
{'0': {'precision': 0.4150298889837746, 'recall': 0.5985697258641239, 'f1-score': 0.49018236241479723, 'support': 25170}, '1': {'precision': 0.6945856409478289, 'recall': 0.5351388212372138, 'f1-score': 0.6045252454109257, 'support': 51325}, '2': {'precision': 0.4464603613499489, 'recall': 0.45774757281553397, 'f1-score': 0.45203351805334513, 'support': 25750}, 'accuracy': 0.5312631424519536, 'macro avg': {'precision': 0.5186919637605175, 'recall': 0.530485373305624, 'f1-score': 0.5155803752930227, 'support': 102245}, 'weighted avg': {'precision': 0.5632770759658674, 'recall': 0.5312631424519536, 'f1-score': 0.537972628222112, 'support': 102245}}
[[15066  4929  5175]
 [14420 27466  9439]
 [ 6815  7148 11787]]
training model: results/WBA/W7/deepVOL_L3/h20
Epoch 1/50
1230/1230 - 45s - loss: 3.2920 - accuracy20: 0.3752 - val_loss: 3.3363 - val_accuracy20: 0.3906 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 46s - loss: 3.2484 - accuracy20: 0.4073 - val_loss: 3.2186 - val_accuracy20: 0.4233 - 46s/epoch - 37ms/step
Epoch 3/50
1230/1230 - 42s - loss: 3.1859 - accuracy20: 0.4257 - val_loss: 3.1688 - val_accuracy20: 0.4422 - 42s/epoch - 34ms/step
Epoch 4/50
1230/1230 - 42s - loss: 3.0751 - accuracy20: 0.4643 - val_loss: 3.0757 - val_accuracy20: 0.4749 - 42s/epoch - 34ms/step
Epoch 5/50
1230/1230 - 42s - loss: 2.9906 - accuracy20: 0.4903 - val_loss: 2.9979 - val_accuracy20: 0.4892 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 42s - loss: 2.9565 - accuracy20: 0.5006 - val_loss: 2.9947 - val_accuracy20: 0.4943 - 42s/epoch - 35ms/step
Epoch 7/50
1230/1230 - 44s - loss: 2.9394 - accuracy20: 0.5055 - val_loss: 2.9817 - val_accuracy20: 0.4949 - 44s/epoch - 36ms/step
Epoch 8/50
1230/1230 - 46s - loss: 2.9259 - accuracy20: 0.5096 - val_loss: 2.9846 - val_accuracy20: 0.4931 - 46s/epoch - 37ms/step
Epoch 9/50
1230/1230 - 42s - loss: 2.9134 - accuracy20: 0.5121 - val_loss: 2.9785 - val_accuracy20: 0.4952 - 42s/epoch - 34ms/step
Epoch 10/50
1230/1230 - 43s - loss: 2.9034 - accuracy20: 0.5156 - val_loss: 2.9641 - val_accuracy20: 0.4992 - 43s/epoch - 35ms/step
Epoch 11/50
1230/1230 - 41s - loss: 2.8949 - accuracy20: 0.5172 - val_loss: 2.9580 - val_accuracy20: 0.4995 - 41s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 42s - loss: 2.8857 - accuracy20: 0.5200 - val_loss: 2.9766 - val_accuracy20: 0.4949 - 42s/epoch - 34ms/step
Epoch 13/50
1230/1230 - 41s - loss: 2.8795 - accuracy20: 0.5219 - val_loss: 2.9530 - val_accuracy20: 0.4996 - 41s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 46s - loss: 2.8716 - accuracy20: 0.5235 - val_loss: 2.9729 - val_accuracy20: 0.4985 - 46s/epoch - 37ms/step
Epoch 15/50
1230/1230 - 42s - loss: 2.8672 - accuracy20: 0.5242 - val_loss: 2.9672 - val_accuracy20: 0.4977 - 42s/epoch - 34ms/step
Epoch 16/50
1230/1230 - 41s - loss: 2.8614 - accuracy20: 0.5262 - val_loss: 2.9674 - val_accuracy20: 0.4979 - 41s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 41s - loss: 2.8554 - accuracy20: 0.5275 - val_loss: 2.9572 - val_accuracy20: 0.4987 - 41s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 42s - loss: 2.8511 - accuracy20: 0.5280 - val_loss: 2.9609 - val_accuracy20: 0.4989 - 42s/epoch - 34ms/step
Epoch 19/50
1230/1230 - 40s - loss: 2.8469 - accuracy20: 0.5294 - val_loss: 2.9766 - val_accuracy20: 0.5006 - 40s/epoch - 32ms/step
Epoch 20/50
1230/1230 - 41s - loss: 2.8436 - accuracy20: 0.5295 - val_loss: 2.9600 - val_accuracy20: 0.5004 - 41s/epoch - 34ms/step
Epoch 21/50
1230/1230 - 40s - loss: 2.8393 - accuracy20: 0.5301 - val_loss: 2.9517 - val_accuracy20: 0.5025 - 40s/epoch - 33ms/step
Epoch 22/50
1230/1230 - 41s - loss: 2.8358 - accuracy20: 0.5308 - val_loss: 2.9394 - val_accuracy20: 0.5036 - 41s/epoch - 33ms/step
Epoch 23/50
1230/1230 - 44s - loss: 2.8299 - accuracy20: 0.5334 - val_loss: 2.9386 - val_accuracy20: 0.5043 - 44s/epoch - 36ms/step
Epoch 24/50
1230/1230 - 41s - loss: 2.8257 - accuracy20: 0.5330 - val_loss: 2.9497 - val_accuracy20: 0.5030 - 41s/epoch - 34ms/step
Epoch 25/50
1230/1230 - 41s - loss: 2.8223 - accuracy20: 0.5341 - val_loss: 2.9487 - val_accuracy20: 0.5019 - 41s/epoch - 33ms/step
Epoch 26/50
1230/1230 - 42s - loss: 2.8174 - accuracy20: 0.5354 - val_loss: 2.9589 - val_accuracy20: 0.5026 - 42s/epoch - 34ms/step
Epoch 27/50
1230/1230 - 40s - loss: 2.8155 - accuracy20: 0.5357 - val_loss: 2.9392 - val_accuracy20: 0.5049 - 40s/epoch - 33ms/step
Epoch 28/50
1230/1230 - 45s - loss: 2.8111 - accuracy20: 0.5371 - val_loss: 2.9621 - val_accuracy20: 0.5015 - 45s/epoch - 37ms/step
Epoch 29/50
1230/1230 - 43s - loss: 2.8076 - accuracy20: 0.5375 - val_loss: 2.9560 - val_accuracy20: 0.5036 - 43s/epoch - 35ms/step
Epoch 30/50
1230/1230 - 42s - loss: 2.8036 - accuracy20: 0.5385 - val_loss: 2.9401 - val_accuracy20: 0.5068 - 42s/epoch - 34ms/step
Epoch 31/50
1230/1230 - 41s - loss: 2.8004 - accuracy20: 0.5391 - val_loss: 2.9534 - val_accuracy20: 0.5017 - 41s/epoch - 33ms/step
Epoch 32/50
1230/1230 - 42s - loss: 2.7970 - accuracy20: 0.5398 - val_loss: 2.9626 - val_accuracy20: 0.5030 - 42s/epoch - 34ms/step
Epoch 33/50
1230/1230 - 41s - loss: 2.7958 - accuracy20: 0.5401 - val_loss: 2.9727 - val_accuracy20: 0.5023 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h20
Evaluating performance on  test set...
4192/4192 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94473106
{'0': {'precision': 0.4347365549968091, 'recall': 0.5713241691317209, 'f1-score': 0.4937584682870638, 'support': 287350}, '1': {'precision': 0.6630930736383078, 'recall': 0.5651144013963263, 'f1-score': 0.6101956762127597, 'support': 505326}, '2': {'precision': 0.4750736238012535, 'recall': 0.44862625412694224, 'f1-score': 0.4614713184947207, 'support': 280474}, 'accuracy': 0.5363322927829287, 'macro avg': {'precision': 0.5243010841454567, 'recall': 0.5283549415516631, 'f1-score': 0.5218084876648481, 'support': 1073150}, 'weighted avg': {'precision': 0.5528076402830149, 'recall': 0.5363322927829287, 'f1-score': 0.5401481085809673, 'support': 1073150}}
[[164170  59568  63612]
 [144339 285567  75420]
 [ 69122  85524 125828]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97343946
{'0': {'precision': 0.4721191173465913, 'recall': 0.5718631413958093, 'f1-score': 0.5172262637567618, 'support': 96976}, '1': {'precision': 0.6103498091012279, 'recall': 0.48453000204792135, 'f1-score': 0.5402105167020571, 'support': 122075}, '2': {'precision': 0.48216293672196076, 'recall': 0.505698421975453, 'f1-score': 0.49365031659271863, 'support': 95816}, 'accuracy': 0.517869449640642, 'macro avg': {'precision': 0.5215439543899266, 'recall': 0.5206971884730612, 'f1-score': 0.5170290323505126, 'support': 314867}, 'weighted avg': {'precision': 0.5287680208303405, 'recall': 0.517869449640642, 'f1-score': 0.5189630279296569, 'support': 314867}}
[[55457 15899 25620]
 [36507 59149 26419]
 [25500 21862 48454]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98592013
{'0': {'precision': 0.4564959227297918, 'recall': 0.5535182874148027, 'f1-score': 0.5003471017007983, 'support': 31251}, '1': {'precision': 0.6144722066254913, 'recall': 0.4460919188831142, 'f1-score': 0.5169156285056385, 'support': 39252}, '2': {'precision': 0.4669511378848728, 'recall': 0.5274714888790877, 'f1-score': 0.4953696854936537, 'support': 31742}, 'accuracy': 0.5041909139811238, 'macro avg': {'precision': 0.5126397557467186, 'recall': 0.5090272317256682, 'f1-score': 0.5042108052333635, 'support': 102245}, 'weighted avg': {'precision': 0.5203890669904068, 'recall': 0.5041909139811238, 'f1-score': 0.5051625417604237, 'support': 102245}}
[[17298  4474  9479]
 [12108 17510  9634]
 [ 8487  6512 16743]]
training model: results/WBA/W7/deepVOL_L3/h30
Epoch 1/50
1230/1230 - 44s - loss: 3.3044 - accuracy30: 0.3701 - val_loss: 3.2903 - val_accuracy30: 0.3540 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 45s - loss: 3.2371 - accuracy30: 0.3946 - val_loss: 3.3138 - val_accuracy30: 0.3633 - 45s/epoch - 37ms/step
Epoch 3/50
1230/1230 - 45s - loss: 3.1070 - accuracy30: 0.4565 - val_loss: 3.1956 - val_accuracy30: 0.4133 - 45s/epoch - 37ms/step
Epoch 4/50
1230/1230 - 42s - loss: 3.0420 - accuracy30: 0.4792 - val_loss: 3.1298 - val_accuracy30: 0.4565 - 42s/epoch - 34ms/step
Epoch 5/50
1230/1230 - 41s - loss: 3.0154 - accuracy30: 0.4873 - val_loss: 3.0946 - val_accuracy30: 0.4703 - 41s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 42s - loss: 3.0019 - accuracy30: 0.4919 - val_loss: 3.0980 - val_accuracy30: 0.4665 - 42s/epoch - 34ms/step
Epoch 7/50
1230/1230 - 41s - loss: 2.9882 - accuracy30: 0.4951 - val_loss: 3.1037 - val_accuracy30: 0.4659 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 2.9822 - accuracy30: 0.4966 - val_loss: 3.1146 - val_accuracy30: 0.4634 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 40s - loss: 2.9725 - accuracy30: 0.4990 - val_loss: 3.1211 - val_accuracy30: 0.4657 - 40s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 2.9661 - accuracy30: 0.5008 - val_loss: 3.1150 - val_accuracy30: 0.4675 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 40s - loss: 2.9609 - accuracy30: 0.5023 - val_loss: 3.1163 - val_accuracy30: 0.4675 - 40s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 2.9526 - accuracy30: 0.5046 - val_loss: 3.1152 - val_accuracy30: 0.4706 - 41s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 41s - loss: 2.9494 - accuracy30: 0.5061 - val_loss: 3.0803 - val_accuracy30: 0.4774 - 41s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 41s - loss: 2.9445 - accuracy30: 0.5073 - val_loss: 3.0908 - val_accuracy30: 0.4708 - 41s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 41s - loss: 2.9396 - accuracy30: 0.5079 - val_loss: 3.0808 - val_accuracy30: 0.4774 - 41s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 41s - loss: 2.9351 - accuracy30: 0.5090 - val_loss: 3.0809 - val_accuracy30: 0.4757 - 41s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 41s - loss: 2.9318 - accuracy30: 0.5097 - val_loss: 3.1105 - val_accuracy30: 0.4709 - 41s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 40s - loss: 2.9271 - accuracy30: 0.5111 - val_loss: 3.1069 - val_accuracy30: 0.4710 - 40s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 41s - loss: 2.9237 - accuracy30: 0.5120 - val_loss: 3.1046 - val_accuracy30: 0.4741 - 41s/epoch - 33ms/step
Epoch 20/50
1230/1230 - 44s - loss: 2.9207 - accuracy30: 0.5123 - val_loss: 3.0978 - val_accuracy30: 0.4711 - 44s/epoch - 36ms/step
Epoch 21/50
1230/1230 - 45s - loss: 2.9171 - accuracy30: 0.5142 - val_loss: 3.1324 - val_accuracy30: 0.4705 - 45s/epoch - 36ms/step
Epoch 22/50
1230/1230 - 41s - loss: 2.9148 - accuracy30: 0.5146 - val_loss: 3.1142 - val_accuracy30: 0.4735 - 41s/epoch - 33ms/step
Epoch 23/50
1230/1230 - 44s - loss: 2.9114 - accuracy30: 0.5160 - val_loss: 3.1270 - val_accuracy30: 0.4673 - 44s/epoch - 36ms/step
testing model: results/WBA/W7/deepVOL_L3/h30
Evaluating performance on  test set...
4192/4192 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99574524
{'0': {'precision': 0.4260731701458118, 'recall': 0.6105584328206412, 'f1-score': 0.5018997419849409, 'support': 319555}, '1': {'precision': 0.5930860145580862, 'recall': 0.5492545666749328, 'f1-score': 0.5703293873626568, 'support': 439543}, '2': {'precision': 0.49457660011913224, 'recall': 0.327834244010546, 'f1-score': 0.3943020619504274, 'support': 314052}, 'accuracy': 0.502711643293109, 'macro avg': {'precision': 0.5045785949410101, 'recall': 0.49588241450203996, 'f1-score': 0.488843730432675, 'support': 1073150}, 'weighted avg': {'precision': 0.5145258243521069, 'recall': 0.502711643293109, 'f1-score': 0.49843937298532137, 'support': 1073150}}
[[195107  72855  51593]
 [144500 241421  53622]
 [118312  92783 102957]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0207384
{'0': {'precision': 0.4540406155841699, 'recall': 0.6332133637340067, 'f1-score': 0.5288637079005352, 'support': 106138}, '1': {'precision': 0.5379736836165843, 'recall': 0.4595201603963641, 'f1-score': 0.49566171233695683, 'support': 103743}, '2': {'precision': 0.48862982705065766, 'recall': 0.3641056902825139, 'f1-score': 0.41727568948296284, 'support': 104986}, 'accuracy': 0.48625610178265743, 'macro avg': {'precision': 0.49354804208380393, 'recall': 0.4856130714709616, 'f1-score': 0.48060036990681826, 'support': 314867}, 'weighted avg': {'precision': 0.49322811771017055, 'recall': 0.48625610178265743, 'f1-score': 0.48071749274512177, 'support': 314867}}
[[67208 18168 20762]
 [36828 47672 19243]
 [43986 22774 38226]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0266796
{'0': {'precision': 0.44155896771057, 'recall': 0.6408537660963133, 'f1-score': 0.5228591988486446, 'support': 34014}, '1': {'precision': 0.5557087252675965, 'recall': 0.40400884303610907, 'f1-score': 0.4678693952789773, 'support': 33925}, '2': {'precision': 0.4636895268474216, 'recall': 0.3813618608989681, 'f1-score': 0.4185153788327122, 'support': 34306}, 'accuracy': 0.4752017213555675, 'macro avg': {'precision': 0.48698573994186267, 'recall': 0.4754081566771302, 'f1-score': 0.46974799098677805, 'support': 102245}, 'weighted avg': {'precision': 0.48685938814062485, 'recall': 0.4752017213555675, 'f1-score': 0.4696033117581508, 'support': 102245}}
[[21798  4642  7574]
 [12661 13706  7558]
 [14907  6316 13083]]
training model: results/WBA/W7/deepVOL_L3/h50
Epoch 1/50
1230/1230 - 44s - loss: 3.3051 - accuracy50: 0.3608 - val_loss: 3.3092 - val_accuracy50: 0.3339 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2862 - accuracy50: 0.3673 - val_loss: 3.2594 - val_accuracy50: 0.3897 - 41s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 43s - loss: 3.2387 - accuracy50: 0.3964 - val_loss: 3.2589 - val_accuracy50: 0.3762 - 43s/epoch - 35ms/step
Epoch 4/50
1230/1230 - 41s - loss: 3.1817 - accuracy50: 0.4282 - val_loss: 3.2521 - val_accuracy50: 0.3848 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 41s - loss: 3.1588 - accuracy50: 0.4384 - val_loss: 3.1885 - val_accuracy50: 0.4196 - 41s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 3.1410 - accuracy50: 0.4457 - val_loss: 3.1741 - val_accuracy50: 0.4300 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.1308 - accuracy50: 0.4504 - val_loss: 3.1729 - val_accuracy50: 0.4327 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 41s - loss: 3.1224 - accuracy50: 0.4534 - val_loss: 3.1712 - val_accuracy50: 0.4304 - 41s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.1167 - accuracy50: 0.4556 - val_loss: 3.1710 - val_accuracy50: 0.4303 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.1116 - accuracy50: 0.4574 - val_loss: 3.1853 - val_accuracy50: 0.4285 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 43s - loss: 3.1066 - accuracy50: 0.4598 - val_loss: 3.1737 - val_accuracy50: 0.4324 - 43s/epoch - 35ms/step
Epoch 12/50
1230/1230 - 41s - loss: 3.1009 - accuracy50: 0.4615 - val_loss: 3.1854 - val_accuracy50: 0.4308 - 41s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 41s - loss: 3.0965 - accuracy50: 0.4635 - val_loss: 3.1698 - val_accuracy50: 0.4334 - 41s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 41s - loss: 3.0928 - accuracy50: 0.4655 - val_loss: 3.1747 - val_accuracy50: 0.4357 - 41s/epoch - 34ms/step
Epoch 15/50
1230/1230 - 41s - loss: 3.0891 - accuracy50: 0.4655 - val_loss: 3.1688 - val_accuracy50: 0.4355 - 41s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 42s - loss: 3.0840 - accuracy50: 0.4686 - val_loss: 3.1734 - val_accuracy50: 0.4361 - 42s/epoch - 34ms/step
Epoch 17/50
1230/1230 - 42s - loss: 3.0803 - accuracy50: 0.4693 - val_loss: 3.1664 - val_accuracy50: 0.4385 - 42s/epoch - 34ms/step
Epoch 18/50
1230/1230 - 41s - loss: 3.0764 - accuracy50: 0.4703 - val_loss: 3.1664 - val_accuracy50: 0.4400 - 41s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 41s - loss: 3.0733 - accuracy50: 0.4711 - val_loss: 3.1634 - val_accuracy50: 0.4406 - 41s/epoch - 33ms/step
Epoch 20/50
1230/1230 - 40s - loss: 3.0689 - accuracy50: 0.4732 - val_loss: 3.1671 - val_accuracy50: 0.4397 - 40s/epoch - 33ms/step
Epoch 21/50
1230/1230 - 42s - loss: 3.0666 - accuracy50: 0.4747 - val_loss: 3.1703 - val_accuracy50: 0.4392 - 42s/epoch - 34ms/step
Epoch 22/50
1230/1230 - 40s - loss: 3.0633 - accuracy50: 0.4752 - val_loss: 3.1629 - val_accuracy50: 0.4405 - 40s/epoch - 33ms/step
Epoch 23/50
1230/1230 - 41s - loss: 3.0605 - accuracy50: 0.4767 - val_loss: 3.1673 - val_accuracy50: 0.4417 - 41s/epoch - 33ms/step
Epoch 24/50
1230/1230 - 41s - loss: 3.0562 - accuracy50: 0.4776 - val_loss: 3.1694 - val_accuracy50: 0.4406 - 41s/epoch - 33ms/step
Epoch 25/50
1230/1230 - 41s - loss: 3.0532 - accuracy50: 0.4787 - val_loss: 3.1658 - val_accuracy50: 0.4422 - 41s/epoch - 33ms/step
Epoch 26/50
1230/1230 - 40s - loss: 3.0488 - accuracy50: 0.4798 - val_loss: 3.1649 - val_accuracy50: 0.4426 - 40s/epoch - 33ms/step
Epoch 27/50
1230/1230 - 41s - loss: 3.0467 - accuracy50: 0.4810 - val_loss: 3.1642 - val_accuracy50: 0.4413 - 41s/epoch - 33ms/step
Epoch 28/50
1230/1230 - 42s - loss: 3.0438 - accuracy50: 0.4818 - val_loss: 3.1598 - val_accuracy50: 0.4427 - 42s/epoch - 34ms/step
Epoch 29/50
1230/1230 - 41s - loss: 3.0404 - accuracy50: 0.4828 - val_loss: 3.1688 - val_accuracy50: 0.4416 - 41s/epoch - 33ms/step
Epoch 30/50
1230/1230 - 42s - loss: 3.0363 - accuracy50: 0.4842 - val_loss: 3.1626 - val_accuracy50: 0.4416 - 42s/epoch - 34ms/step
Epoch 31/50
1230/1230 - 41s - loss: 3.0345 - accuracy50: 0.4853 - val_loss: 3.1684 - val_accuracy50: 0.4392 - 41s/epoch - 34ms/step
Epoch 32/50
1230/1230 - 40s - loss: 3.0320 - accuracy50: 0.4866 - val_loss: 3.1537 - val_accuracy50: 0.4414 - 40s/epoch - 33ms/step
Epoch 33/50
1230/1230 - 40s - loss: 3.0286 - accuracy50: 0.4867 - val_loss: 3.1561 - val_accuracy50: 0.4414 - 40s/epoch - 33ms/step
Epoch 34/50
1230/1230 - 41s - loss: 3.0269 - accuracy50: 0.4875 - val_loss: 3.1518 - val_accuracy50: 0.4442 - 41s/epoch - 33ms/step
Epoch 35/50
1230/1230 - 40s - loss: 3.0234 - accuracy50: 0.4881 - val_loss: 3.1541 - val_accuracy50: 0.4437 - 40s/epoch - 33ms/step
Epoch 36/50
1230/1230 - 41s - loss: 3.0196 - accuracy50: 0.4889 - val_loss: 3.1554 - val_accuracy50: 0.4419 - 41s/epoch - 34ms/step
Epoch 37/50
1230/1230 - 41s - loss: 3.0159 - accuracy50: 0.4913 - val_loss: 3.1599 - val_accuracy50: 0.4433 - 41s/epoch - 33ms/step
Epoch 38/50
1230/1230 - 42s - loss: 3.0149 - accuracy50: 0.4910 - val_loss: 3.1643 - val_accuracy50: 0.4433 - 42s/epoch - 34ms/step
Epoch 39/50
1230/1230 - 40s - loss: 3.0117 - accuracy50: 0.4915 - val_loss: 3.1541 - val_accuracy50: 0.4448 - 40s/epoch - 32ms/step
Epoch 40/50
1230/1230 - 40s - loss: 3.0103 - accuracy50: 0.4924 - val_loss: 3.1613 - val_accuracy50: 0.4446 - 40s/epoch - 33ms/step
Epoch 41/50
1230/1230 - 42s - loss: 3.0065 - accuracy50: 0.4936 - val_loss: 3.1647 - val_accuracy50: 0.4425 - 42s/epoch - 35ms/step
Epoch 42/50
1230/1230 - 40s - loss: 3.0041 - accuracy50: 0.4942 - val_loss: 3.1796 - val_accuracy50: 0.4390 - 40s/epoch - 33ms/step
Epoch 43/50
1230/1230 - 42s - loss: 3.0005 - accuracy50: 0.4954 - val_loss: 3.1625 - val_accuracy50: 0.4448 - 42s/epoch - 34ms/step
Epoch 44/50
1230/1230 - 41s - loss: 2.9985 - accuracy50: 0.4963 - val_loss: 3.1691 - val_accuracy50: 0.4426 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h50
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0381501
{'0': {'precision': 0.40840893619654683, 'recall': 0.5087621919818928, 'f1-score': 0.453095434909772, 'support': 324291}, '1': {'precision': 0.5450276386698781, 'recall': 0.4460163689174913, 'f1-score': 0.4905760924805003, 'support': 423119}, '2': {'precision': 0.43488035773455425, 'recall': 0.43111684165285197, 'f1-score': 0.43299042180738473, 'support': 325740}, 'accuracy': 0.4604547360574011, 'macro avg': {'precision': 0.46277231086699305, 'recall': 0.4619651341840787, 'f1-score': 0.45888731639921904, 'support': 1073150}, 'weighted avg': {'precision': 0.47030966733721125, 'recall': 0.4604547360574011, 'f1-score': 0.46177061674147996, 'support': 1073150}}
[[164987  68716  90588]
 [142500 188718  91901]
 [ 96488  88820 140432]]
Evaluating performance on  train set...
1230/1230 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0428802
{'0': {'precision': 0.4470348024735781, 'recall': 0.503359056260659, 'f1-score': 0.47352792575587016, 'support': 106131}, '1': {'precision': 0.5052109794444368, 'recall': 0.3541807050307079, 'f1-score': 0.41642474350485825, 'support': 103882}, '2': {'precision': 0.4406505790087892, 'recall': 0.5149636637610392, 'f1-score': 0.47491765285345505, 'support': 104854}, 'accuracy': 0.4580060787570625, 'macro avg': {'precision': 0.4642987869756014, 'recall': 0.4575011416841354, 'f1-score': 0.4549567740380612, 'support': 314867}, 'weighted avg': {'precision': 0.4641024731056538, 'recall': 0.4580060787570625, 'f1-score': 0.45515104175878746, 'support': 314867}}
[[53422 16302 36407]
 [34955 36793 32134]
 [31126 19732 53996]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0508581
{'0': {'precision': 0.42995390531489547, 'recall': 0.49307827102803736, 'f1-score': 0.4593576122001986, 'support': 34240}, '1': {'precision': 0.5145655324039374, 'recall': 0.304, 'f1-score': 0.38220011876484566, 'support': 33875}, '2': {'precision': 0.42241359245897825, 'recall': 0.5317609141517726, 'f1-score': 0.4708217134703937, 'support': 34130}, 'accuracy': 0.4433468629272825, 'macro avg': {'precision': 0.4556443433926037, 'recall': 0.44294639505993666, 'f1-score': 0.4374598148118127, 'support': 102245}, 'weighted avg': {'precision': 0.4554697544015876, 'recall': 0.4433468629272825, 'f1-score': 0.4376211917026601, 'support': 102245}}
[[16883  4261 13096]
 [11857 10298 11720]
 [10527  5454 18149]]
training model: results/WBA/W7/deepVOL_L3/h100
Epoch 1/50
1230/1230 - 44s - loss: 3.2906 - accuracy100: 0.3686 - val_loss: 3.2925 - val_accuracy100: 0.3534 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 42s - loss: 3.2660 - accuracy100: 0.3763 - val_loss: 3.2732 - val_accuracy100: 0.3652 - 42s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 41s - loss: 3.2497 - accuracy100: 0.3901 - val_loss: 3.2720 - val_accuracy100: 0.3690 - 41s/epoch - 33ms/step
Epoch 4/50
1230/1230 - 41s - loss: 3.2336 - accuracy100: 0.4018 - val_loss: 3.2692 - val_accuracy100: 0.3778 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 42s - loss: 3.2267 - accuracy100: 0.4045 - val_loss: 3.2941 - val_accuracy100: 0.3652 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 3.2235 - accuracy100: 0.4073 - val_loss: 3.2745 - val_accuracy100: 0.3852 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.2157 - accuracy100: 0.4097 - val_loss: 3.3026 - val_accuracy100: 0.3704 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 3.2137 - accuracy100: 0.4111 - val_loss: 3.3033 - val_accuracy100: 0.3755 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2089 - accuracy100: 0.4142 - val_loss: 3.2951 - val_accuracy100: 0.3767 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 40s - loss: 3.2064 - accuracy100: 0.4150 - val_loss: 3.2829 - val_accuracy100: 0.3802 - 40s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 40s - loss: 3.2027 - accuracy100: 0.4177 - val_loss: 3.2773 - val_accuracy100: 0.3841 - 40s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 3.2038 - accuracy100: 0.4174 - val_loss: 3.2578 - val_accuracy100: 0.3868 - 41s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 41s - loss: 3.1991 - accuracy100: 0.4194 - val_loss: 3.2711 - val_accuracy100: 0.3858 - 41s/epoch - 34ms/step
Epoch 14/50
1230/1230 - 40s - loss: 3.1967 - accuracy100: 0.4211 - val_loss: 3.2679 - val_accuracy100: 0.3902 - 40s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 41s - loss: 3.1923 - accuracy100: 0.4235 - val_loss: 3.2594 - val_accuracy100: 0.3902 - 41s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 40s - loss: 3.1906 - accuracy100: 0.4244 - val_loss: 3.2564 - val_accuracy100: 0.3947 - 40s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 40s - loss: 3.1893 - accuracy100: 0.4248 - val_loss: 3.2566 - val_accuracy100: 0.3912 - 40s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 40s - loss: 3.1843 - accuracy100: 0.4266 - val_loss: 3.2745 - val_accuracy100: 0.3878 - 40s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 41s - loss: 3.1820 - accuracy100: 0.4282 - val_loss: 3.2704 - val_accuracy100: 0.3900 - 41s/epoch - 33ms/step
Epoch 20/50
1230/1230 - 40s - loss: 3.1777 - accuracy100: 0.4302 - val_loss: 3.2727 - val_accuracy100: 0.3921 - 40s/epoch - 33ms/step
Epoch 21/50
1230/1230 - 40s - loss: 3.1771 - accuracy100: 0.4291 - val_loss: 3.2732 - val_accuracy100: 0.3950 - 40s/epoch - 33ms/step
Epoch 22/50
1230/1230 - 40s - loss: 3.1742 - accuracy100: 0.4310 - val_loss: 3.2902 - val_accuracy100: 0.3920 - 40s/epoch - 33ms/step
Epoch 23/50
1230/1230 - 41s - loss: 3.1726 - accuracy100: 0.4323 - val_loss: 3.3008 - val_accuracy100: 0.3912 - 41s/epoch - 33ms/step
Epoch 24/50
1230/1230 - 40s - loss: 3.1746 - accuracy100: 0.4310 - val_loss: 3.2815 - val_accuracy100: 0.3931 - 40s/epoch - 33ms/step
Epoch 25/50
1230/1230 - 40s - loss: 3.1685 - accuracy100: 0.4338 - val_loss: 3.2876 - val_accuracy100: 0.3913 - 40s/epoch - 33ms/step
Epoch 26/50
1230/1230 - 40s - loss: 3.1647 - accuracy100: 0.4365 - val_loss: 3.2804 - val_accuracy100: 0.3933 - 40s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h100
Evaluating performance on  test set...
4192/4192 - 69s - 69s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1126174
{'0': {'precision': 0.3284691433449145, 'recall': 0.7290708910891089, 'f1-score': 0.4528949888160348, 'support': 315625}, '1': {'precision': 0.48053422847552046, 'recall': 0.15622090390888932, 'f1-score': 0.23578762922726473, 'support': 430685}, '2': {'precision': 0.38183710060927106, 'recall': 0.2717078692938441, 'f1-score': 0.31749351552430854, 'support': 326840}, 'accuracy': 0.3598751339514513, 'macro avg': {'precision': 0.3969468241432354, 'recall': 0.38566655476394746, 'f1-score': 0.335392044522536, 'support': 1073150}, 'weighted avg': {'precision': 0.40575091601579677, 'recall': 0.3598751339514513, 'f1-score': 0.32452570148886034, 'support': 1073150}}
[[230113  29327  56185]
 [275820  67282  87583]
 [194629  43406  88805]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0948794
{'0': {'precision': 0.37264637510919835, 'recall': 0.7076990851829634, 'f1-score': 0.48821697957652904, 'support': 106688}, '1': {'precision': 0.42391763782380293, 'recall': 0.1363693754066995, 'f1-score': 0.20635632141676158, 'support': 102963}, '2': {'precision': 0.3970201688318253, 'recall': 0.2985952706812652, 'f1-score': 0.3408444897693492, 'support': 105216}, 'accuracy': 0.3841653777626744, 'macro avg': {'precision': 0.39786139392160885, 'recall': 0.3808879104236427, 'f1-score': 0.3451392635875466, 'support': 314867}, 'weighted avg': {'precision': 0.3975570710640102, 'recall': 0.3841653777626744, 'f1-score': 0.34680119820326233, 'support': 314867}}
[[75503  8424 22761]
 [63968 14041 24954]
 [63142 10657 31417]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.083574
{'0': {'precision': 0.388794489789726, 'recall': 0.704948697494017, 'f1-score': 0.5011782882063618, 'support': 36353}, '1': {'precision': 0.4036683785766691, 'recall': 0.09316896399905171, 'f1-score': 0.1513950800726432, 'support': 29527}, '2': {'precision': 0.4086597099878032, 'recall': 0.33169256152894266, 'f1-score': 0.3661753768157739, 'support': 36365}, 'accuracy': 0.39552056335273117, 'macro avg': {'precision': 0.4003741927847328, 'recall': 0.37660340767400385, 'f1-score': 0.339582915031593, 'support': 102245}, 'weighted avg': {'precision': 0.4001552413835951, 'recall': 0.39552056335273117, 'f1-score': 0.3521496837828395, 'support': 102245}}
[[25627  1744  8982]
 [18304  2751  8472]
 [21983  2320 12062]]
training model: results/WBA/W7/deepVOL_L3/h200
Epoch 1/50
1230/1230 - 45s - loss: 3.3085 - accuracy200: 0.3605 - val_loss: 3.3162 - val_accuracy200: 0.3298 - 45s/epoch - 37ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2889 - accuracy200: 0.3582 - val_loss: 3.2953 - val_accuracy200: 0.3508 - 41s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 40s - loss: 3.2793 - accuracy200: 0.3664 - val_loss: 3.3061 - val_accuracy200: 0.3404 - 40s/epoch - 32ms/step
Epoch 4/50
1230/1230 - 40s - loss: 3.2726 - accuracy200: 0.3695 - val_loss: 3.3013 - val_accuracy200: 0.3427 - 40s/epoch - 32ms/step
Epoch 5/50
1230/1230 - 42s - loss: 3.2674 - accuracy200: 0.3740 - val_loss: 3.2987 - val_accuracy200: 0.3476 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 40s - loss: 3.2630 - accuracy200: 0.3783 - val_loss: 3.3033 - val_accuracy200: 0.3515 - 40s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.2588 - accuracy200: 0.3805 - val_loss: 3.3040 - val_accuracy200: 0.3469 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 3.2550 - accuracy200: 0.3841 - val_loss: 3.3054 - val_accuracy200: 0.3491 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 40s - loss: 3.2511 - accuracy200: 0.3873 - val_loss: 3.3108 - val_accuracy200: 0.3543 - 40s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.2471 - accuracy200: 0.3890 - val_loss: 3.3079 - val_accuracy200: 0.3543 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 41s - loss: 3.2446 - accuracy200: 0.3904 - val_loss: 3.3060 - val_accuracy200: 0.3563 - 41s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 3.2408 - accuracy200: 0.3947 - val_loss: 3.3117 - val_accuracy200: 0.3576 - 41s/epoch - 34ms/step
testing model: results/WBA/W7/deepVOL_L3/h200
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968038
{'0': {'precision': 0.33073724683685785, 'recall': 0.10922287810020463, 'f1-score': 0.16421521836610564, 'support': 338647}, '1': {'precision': 0.3701201780324597, 'recall': 0.7923641510917717, 'f1-score': 0.5045572715626422, 'support': 381490}, '2': {'precision': 0.3603208630108568, 'recall': 0.1476036293280984, 'f1-score': 0.20941958068658403, 'support': 353013}, 'accuracy': 0.3646955225271397, 'macro avg': {'precision': 0.3537260959600581, 'recall': 0.3497302195066916, 'f1-score': 0.2927306902051106, 'support': 1073150}, 'weighted avg': {'precision': 0.35446887383983233, 'recall': 0.3646955225271397, 'f1-score': 0.30007210457007133, 'support': 1073150}}
[[ 36988 251940  49719]
 [ 36426 302279  42785]
 [ 38421 262486  52106]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998443
{'0': {'precision': 0.3586208693839258, 'recall': 0.1273459189339256, 'f1-score': 0.18795072115384617, 'support': 108060}, '1': {'precision': 0.3388851168152965, 'recall': 0.7356176307667959, 'f1-score': 0.46400973342276436, 'support': 101096}, '2': {'precision': 0.3664235879816289, 'recall': 0.19773722696786522, 'f1-score': 0.2568614560356851, 'support': 105711}, 'accuracy': 0.3462795402503279, 'macro avg': {'precision': 0.35464319139361705, 'recall': 0.35356692555619557, 'f1-score': 0.3029406368707652, 'support': 314867}, 'weighted avg': {'precision': 0.3549038318538056, 'recall': 0.3462795402503279, 'f1-score': 0.2997219915614552, 'support': 314867}}
[[13761 73568 20731]
 [11316 74368 15412]
 [13295 71513 20903]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992926
{'0': {'precision': 0.3420631899505139, 'recall': 0.13143575941961153, 'f1-score': 0.18990257613220907, 'support': 34184}, '1': {'precision': 0.3491658402846643, 'recall': 0.7093591680739489, 'f1-score': 0.46797947715612015, 'support': 33753}, '2': {'precision': 0.36561495763949753, 'recall': 0.21887023434767403, 'f1-score': 0.27382124494037857, 'support': 34308}, 'accuracy': 0.3515575333757152, 'macro avg': {'precision': 0.3522813292915586, 'recall': 0.35322172061374485, 'f1-score': 0.3105677660762359, 'support': 102245}, 'weighted avg': {'precision': 0.35231063288270836, 'recall': 0.3515575333757152, 'f1-score': 0.3098596530526526, 'support': 102245}}
[[ 4493 22392  7299]
 [ 4080 23943  5730]
 [ 4562 22237  7509]]
training model: results/WBA/W7/deepVOL_L3/h300
Epoch 1/50
1230/1230 - 44s - loss: 3.2817 - accuracy300: 0.3807 - val_loss: 3.3185 - val_accuracy300: 0.3263 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 42s - loss: 3.2793 - accuracy300: 0.3718 - val_loss: 3.3230 - val_accuracy300: 0.3250 - 42s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 41s - loss: 3.2640 - accuracy300: 0.3802 - val_loss: 3.3108 - val_accuracy300: 0.3282 - 41s/epoch - 33ms/step
Epoch 4/50
1230/1230 - 42s - loss: 3.2460 - accuracy300: 0.3851 - val_loss: 3.3283 - val_accuracy300: 0.3272 - 42s/epoch - 34ms/step
Epoch 5/50
1230/1230 - 40s - loss: 3.2443 - accuracy300: 0.3848 - val_loss: 3.3324 - val_accuracy300: 0.3264 - 40s/epoch - 33ms/step
Epoch 6/50
1230/1230 - 42s - loss: 3.2424 - accuracy300: 0.3849 - val_loss: 3.3295 - val_accuracy300: 0.3257 - 42s/epoch - 34ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.2384 - accuracy300: 0.3882 - val_loss: 3.3342 - val_accuracy300: 0.3287 - 41s/epoch - 34ms/step
Epoch 8/50
1230/1230 - 42s - loss: 3.2356 - accuracy300: 0.3903 - val_loss: 3.3373 - val_accuracy300: 0.3260 - 42s/epoch - 34ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2318 - accuracy300: 0.3930 - val_loss: 3.3431 - val_accuracy300: 0.3236 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.2302 - accuracy300: 0.3946 - val_loss: 3.3379 - val_accuracy300: 0.3258 - 41s/epoch - 34ms/step
Epoch 11/50
1230/1230 - 41s - loss: 3.2273 - accuracy300: 0.3958 - val_loss: 3.3520 - val_accuracy300: 0.3220 - 41s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 42s - loss: 3.2218 - accuracy300: 0.3984 - val_loss: 3.3496 - val_accuracy300: 0.3253 - 42s/epoch - 34ms/step
Epoch 13/50
1230/1230 - 41s - loss: 3.2188 - accuracy300: 0.4007 - val_loss: 3.3588 - val_accuracy300: 0.3217 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h300
Evaluating performance on  test set...
4192/4192 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115369
{'0': {'precision': 0.26770306103059305, 'recall': 0.8636738873736899, 'f1-score': 0.40871991197669194, 'support': 287091}, '1': {'precision': 0.45379535812975963, 'recall': 0.07214887266741885, 'f1-score': 0.12450302368045447, 'support': 484817}, '2': {'precision': 0.2862624382561386, 'recall': 0.06637188705426202, 'f1-score': 0.10775909692336298, 'support': 301242}, 'accuracy': 0.28227740763173836, 'macro avg': {'precision': 0.3359202858054971, 'recall': 0.3340648823651236, 'f1-score': 0.21366067752683646, 'support': 1073150}, 'weighted avg': {'precision': 0.35698375163014057, 'recall': 0.28227740763173836, 'f1-score': 0.1958370745528352, 'support': 1073150}}
[[247953  19934  19204]
 [419191  34979  30647]
 [259080  22168  19994]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981681
{'0': {'precision': 0.3438493013537631, 'recall': 0.8764446992251789, 'f1-score': 0.49392178829169164, 'support': 108154}, '1': {'precision': 0.3600077755459081, 'recall': 0.05450264861683343, 'f1-score': 0.09467253968118733, 'support': 101940}, '2': {'precision': 0.33794932233352976, 'recall': 0.07663233848415145, 'f1-score': 0.12493484062210673, 'support': 104773}, 'accuracy': 0.3441961209018411, 'macro avg': {'precision': 0.34726879974440034, 'recall': 0.3358598954420546, 'f1-score': 0.23784305619832855, 'support': 314867}, 'weighted avg': {'precision': 0.3471174633309165, 'recall': 0.3441961209018411, 'f1-score': 0.24188096511384125, 'support': 314867}}
[[94791  5105  8258]
 [88913  5556  7471]
 [91972  4772  8029]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011298
{'0': {'precision': 0.3253418913327891, 'recall': 0.8727016407210774, 'f1-score': 0.47398344845562357, 'support': 33339}, '1': {'precision': 0.35016764459346184, 'recall': 0.04765299720527006, 'f1-score': 0.0838897535016818, 'support': 35066}, '2': {'precision': 0.33105420188960716, 'recall': 0.07869385342789598, 'f1-score': 0.12716072963422786, 'support': 33840}, 'accuracy': 0.32694997310381924, 'macro avg': {'precision': 0.3355212459386194, 'recall': 0.3330161637847478, 'f1-score': 0.22834464386384443, 'support': 102245}, 'weighted avg': {'precision': 0.3357467468570834, 'recall': 0.32694997310381924, 'f1-score': 0.2254088842992252, 'support': 102245}}
[[29095  1544  2700]
 [30714  1671  2681]
 [29620  1557  2663]]
training model: results/WBA/W7/deepVOL_L3/h500
Epoch 1/50
1230/1230 - 44s - loss: 3.3071 - accuracy500: 0.3642 - val_loss: 3.3072 - val_accuracy500: 0.3307 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2846 - accuracy500: 0.3663 - val_loss: 3.3243 - val_accuracy500: 0.3481 - 41s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 41s - loss: 3.2547 - accuracy500: 0.3923 - val_loss: 3.3158 - val_accuracy500: 0.3557 - 41s/epoch - 33ms/step
Epoch 4/50
1230/1230 - 44s - loss: 3.2479 - accuracy500: 0.3956 - val_loss: 3.2972 - val_accuracy500: 0.3582 - 44s/epoch - 36ms/step
Epoch 5/50
1230/1230 - 44s - loss: 3.2396 - accuracy500: 0.3986 - val_loss: 3.2917 - val_accuracy500: 0.3624 - 44s/epoch - 36ms/step
Epoch 6/50
1230/1230 - 45s - loss: 3.2332 - accuracy500: 0.4029 - val_loss: 3.2853 - val_accuracy500: 0.3635 - 45s/epoch - 37ms/step
Epoch 7/50
1230/1230 - 44s - loss: 3.2289 - accuracy500: 0.4053 - val_loss: 3.2748 - val_accuracy500: 0.3819 - 44s/epoch - 36ms/step
Epoch 8/50
1230/1230 - 45s - loss: 3.2261 - accuracy500: 0.4064 - val_loss: 3.2803 - val_accuracy500: 0.3765 - 45s/epoch - 37ms/step
Epoch 9/50
1230/1230 - 45s - loss: 3.2243 - accuracy500: 0.4084 - val_loss: 3.2828 - val_accuracy500: 0.3786 - 45s/epoch - 37ms/step
Epoch 10/50
1230/1230 - 46s - loss: 3.2228 - accuracy500: 0.4091 - val_loss: 3.2818 - val_accuracy500: 0.3800 - 46s/epoch - 37ms/step
Epoch 11/50
1230/1230 - 45s - loss: 3.2203 - accuracy500: 0.4113 - val_loss: 3.2829 - val_accuracy500: 0.3782 - 45s/epoch - 37ms/step
Epoch 12/50
1230/1230 - 46s - loss: 3.2174 - accuracy500: 0.4135 - val_loss: 3.2790 - val_accuracy500: 0.3798 - 46s/epoch - 37ms/step
Epoch 13/50
1230/1230 - 44s - loss: 3.2130 - accuracy500: 0.4165 - val_loss: 3.2941 - val_accuracy500: 0.3753 - 44s/epoch - 36ms/step
Epoch 14/50
1230/1230 - 45s - loss: 3.2110 - accuracy500: 0.4177 - val_loss: 3.3067 - val_accuracy500: 0.3775 - 45s/epoch - 36ms/step
Epoch 15/50
1230/1230 - 45s - loss: 3.2068 - accuracy500: 0.4199 - val_loss: 3.2836 - val_accuracy500: 0.3819 - 45s/epoch - 37ms/step
Epoch 16/50
1230/1230 - 41s - loss: 3.2022 - accuracy500: 0.4221 - val_loss: 3.2936 - val_accuracy500: 0.3842 - 41s/epoch - 34ms/step
Epoch 17/50
1230/1230 - 41s - loss: 3.1982 - accuracy500: 0.4230 - val_loss: 3.2953 - val_accuracy500: 0.3847 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h500
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0776184
{'0': {'precision': 0.3206523751342145, 'recall': 0.05584140923715754, 'f1-score': 0.09511806699615596, 'support': 310182}, '1': {'precision': 0.4304986209842577, 'recall': 0.8880183206816782, 'f1-score': 0.5798797882402595, 'support': 430115}, '2': {'precision': 0.40240324475948597, 'recall': 0.15946679164676297, 'f1-score': 0.2284156485740966, 'support': 332853}, 'accuracy': 0.42151609747006474, 'macro avg': {'precision': 0.3845180802926527, 'recall': 0.3677755071885329, 'f1-score': 0.301137834603504, 'support': 1073150}, 'weighted avg': {'precision': 0.39003460524293354, 'recall': 0.42151609747006474, 'f1-score': 0.33075314844224446, 'support': 1073150}}
[[ 17321 245201  47660]
 [ 16999 381950  31166]
 [ 19698 260076  53079]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929536
{'0': {'precision': 0.36155192861580165, 'recall': 0.06068534053746623, 'f1-score': 0.10392688430382624, 'support': 105495}, '1': {'precision': 0.3693951368416651, 'recall': 0.82772546263762, 'f1-score': 0.5108219851389251, 'support': 106725}, '2': {'precision': 0.38769283805912264, 'recall': 0.21911989634378015, 'f1-score': 0.27999153502383883, 'support': 102647}, 'accuracy': 0.37232545805054196, 'macro avg': {'precision': 0.3728799678388632, 'recall': 0.36917689983962215, 'f1-score': 0.29824680148886334, 'support': 314867}, 'weighted avg': {'precision': 0.37273237092806, 'recall': 0.37232545805054196, 'f1-score': 0.2992423280914669, 'support': 314867}}
[[ 6402 76952 22141]
 [ 5004 88339 13382]
 [ 6301 73854 22492]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0903322
{'0': {'precision': 0.3274021352313167, 'recall': 0.05654752758228587, 'f1-score': 0.09643858591682172, 'support': 32539}, '1': {'precision': 0.3827833918567561, 'recall': 0.7997143977151817, 'f1-score': 0.5177470814299181, 'support': 35714}, '2': {'precision': 0.3889873245195584, 'recall': 0.2518827959519887, 'f1-score': 0.3057693337856901, 'support': 33992}, 'accuracy': 0.3810748691867573, 'macro avg': {'precision': 0.3663909505358771, 'recall': 0.3693815737498188, 'f1-score': 0.3066516670441433, 'support': 102245}, 'weighted avg': {'precision': 0.36722109902814637, 'recall': 0.3810748691867573, 'f1-score': 0.31319424526753126, 'support': 102245}}
[[ 1840 22688  8011]
 [ 1715 28561  5438]
 [ 2065 23365  8562]]
training model: results/WBA/W7/deepVOL_L3/h1000
Epoch 1/50
1230/1230 - 44s - loss: 3.3092 - accuracy1000: 0.3612 - val_loss: 3.3105 - val_accuracy1000: 0.3260 - 44s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2889 - accuracy1000: 0.3599 - val_loss: 3.3072 - val_accuracy1000: 0.3365 - 41s/epoch - 33ms/step
Epoch 3/50
1230/1230 - 42s - loss: 3.2784 - accuracy1000: 0.3790 - val_loss: 3.3114 - val_accuracy1000: 0.3381 - 42s/epoch - 34ms/step
Epoch 4/50
1230/1230 - 42s - loss: 3.2738 - accuracy1000: 0.3761 - val_loss: 3.3019 - val_accuracy1000: 0.3512 - 42s/epoch - 34ms/step
Epoch 5/50
1230/1230 - 41s - loss: 3.2667 - accuracy1000: 0.3816 - val_loss: 3.3139 - val_accuracy1000: 0.3488 - 41s/epoch - 33ms/step
Epoch 6/50
1230/1230 - 41s - loss: 3.2611 - accuracy1000: 0.3880 - val_loss: 3.3187 - val_accuracy1000: 0.3481 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 42s - loss: 3.2555 - accuracy1000: 0.3906 - val_loss: 3.3260 - val_accuracy1000: 0.3440 - 42s/epoch - 34ms/step
Epoch 8/50
1230/1230 - 41s - loss: 3.2563 - accuracy1000: 0.3915 - val_loss: 3.3264 - val_accuracy1000: 0.3409 - 41s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2493 - accuracy1000: 0.3951 - val_loss: 3.3161 - val_accuracy1000: 0.3415 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.2459 - accuracy1000: 0.3970 - val_loss: 3.3239 - val_accuracy1000: 0.3396 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 40s - loss: 3.2382 - accuracy1000: 0.4032 - val_loss: 3.3338 - val_accuracy1000: 0.3388 - 40s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 3.2324 - accuracy1000: 0.4053 - val_loss: 3.3605 - val_accuracy1000: 0.3402 - 41s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 41s - loss: 3.2297 - accuracy1000: 0.4070 - val_loss: 3.3661 - val_accuracy1000: 0.3389 - 41s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 41s - loss: 3.2241 - accuracy1000: 0.4095 - val_loss: 3.4104 - val_accuracy1000: 0.3292 - 41s/epoch - 33ms/step
testing model: results/WBA/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0940554
{'0': {'precision': 0.3036595774128068, 'recall': 0.1681392192863415, 'f1-score': 0.21643583931210092, 'support': 313175}, '1': {'precision': 0.4006122117880592, 'recall': 0.8074449336029449, 'f1-score': 0.5355248333770538, 'support': 415907}, '2': {'precision': 0.3677728973483, 'recall': 0.06570503505121081, 'f1-score': 0.11149140154560114, 'support': 344068}, 'accuracy': 0.3830648092065415, 'macro avg': {'precision': 0.357348228849722, 'recall': 0.3470963959801657, 'f1-score': 0.287817358078252, 'support': 1073150}, 'weighted avg': {'precision': 0.3617899609273885, 'recall': 0.3830648092065415, 'f1-score': 0.30645431151181984, 'support': 1073150}}
[[ 52657 238726  21792]
 [ 63014 335822  17071]
 [ 57737 263724  22607]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005974
{'0': {'precision': 0.3588522741511089, 'recall': 0.15805884895924355, 'f1-score': 0.21945659461703007, 'support': 108719}, '1': {'precision': 0.33734845618594855, 'recall': 0.8006539456346689, 'f1-score': 0.4746903382047862, 'support': 102455}, '2': {'precision': 0.3809463828357896, 'recall': 0.08749867397027765, 'f1-score': 0.14231040702689984, 'support': 103693}, 'accuracy': 0.3439166378185075, 'macro avg': {'precision': 0.3590490377242823, 'recall': 0.3487371561880634, 'f1-score': 0.2788191132829054, 'support': 314867}, 'weighted avg': {'precision': 0.35913121968119016, 'recall': 0.3439166378185075, 'f1-score': 0.2771014210659758, 'support': 314867}}
[[17184 82319  9216]
 [14896 82031  5528]
 [15806 78814  9073]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002727
{'0': {'precision': 0.3390932982917214, 'recall': 0.15663601323257156, 'f1-score': 0.2142871971599992, 'support': 32949}, '1': {'precision': 0.34978491022899977, 'recall': 0.7875536480686696, 'f1-score': 0.48441931398605137, 'support': 34484}, '2': {'precision': 0.3758925716721731, 'recall': 0.10131563828564863, 'f1-score': 0.15961081570313382, 'support': 34812}, 'accuracy': 0.35058927086899117, 'macro avg': {'precision': 0.3549235933976314, 'recall': 0.3485017665289633, 'f1-score': 0.2861057756163948, 'support': 102245}, 'weighted avg': {'precision': 0.35522852105044206, 'recall': 0.35058927086899117, 'f1-score': 0.2867781915886088, 'support': 102245}}
[[ 5161 24339  3449]
 [ 4919 27158  2407]
 [ 5140 26145  3527]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        19 (peak)  15.20 (ave)

============================================
