This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-31.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-23.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-10.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-19.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-17.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-12.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-08-02.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-18.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-09.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-25.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-07-24.csv
training model: results/AAPL/W5/deepLOB_L1/h10
Epoch 1/50
5759/5759 - 371s - loss: 2.9988 - accuracy10: 0.4740 - val_loss: 3.4197 - val_accuracy10: 0.4130 - 371s/epoch - 64ms/step
Epoch 2/50
5759/5759 - 363s - loss: 2.9517 - accuracy10: 0.4891 - val_loss: 3.5224 - val_accuracy10: 0.4045 - 363s/epoch - 63ms/step
Epoch 3/50
5759/5759 - 371s - loss: 2.9245 - accuracy10: 0.4975 - val_loss: 3.5597 - val_accuracy10: 0.4087 - 371s/epoch - 64ms/step
Epoch 4/50
5759/5759 - 374s - loss: 2.9073 - accuracy10: 0.5024 - val_loss: 3.4996 - val_accuracy10: 0.4158 - 374s/epoch - 65ms/step
Epoch 5/50
5759/5759 - 366s - loss: 2.8940 - accuracy10: 0.5063 - val_loss: 3.4707 - val_accuracy10: 0.4165 - 366s/epoch - 64ms/step
Epoch 6/50
5759/5759 - 357s - loss: 2.8840 - accuracy10: 0.5089 - val_loss: 3.5210 - val_accuracy10: 0.4135 - 357s/epoch - 62ms/step
Epoch 7/50
5759/5759 - 353s - loss: 2.8743 - accuracy10: 0.5114 - val_loss: 3.6409 - val_accuracy10: 0.4059 - 353s/epoch - 61ms/step
Epoch 8/50
5759/5759 - 351s - loss: 2.8688 - accuracy10: 0.5126 - val_loss: 3.6048 - val_accuracy10: 0.4095 - 351s/epoch - 61ms/step
Epoch 9/50
5759/5759 - 339s - loss: 2.8635 - accuracy10: 0.5140 - val_loss: 3.6870 - val_accuracy10: 0.4070 - 339s/epoch - 59ms/step
Epoch 10/50
5759/5759 - 357s - loss: 2.8587 - accuracy10: 0.5155 - val_loss: 3.6953 - val_accuracy10: 0.4071 - 357s/epoch - 62ms/step
Epoch 11/50
5759/5759 - 361s - loss: 2.8539 - accuracy10: 0.5158 - val_loss: 3.6860 - val_accuracy10: 0.4076 - 361s/epoch - 63ms/step
testing model: results/AAPL/W5/deepLOB_L1/h10
Evaluating performance on  test set...
31315/31315 - 799s - 799s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1494375
{'0': {'precision': 0.5008506977014989, 'recall': 0.05473825912383858, 'f1-score': 0.09869056948069889, 'support': 2828771}, '1': {'precision': 0.28719472623396103, 'recall': 0.5112220352301157, 'f1-score': 0.36777853256350346, 'support': 2325113}, '2': {'precision': 0.41227915803325876, 'recall': 0.5139446559458842, 'f1-score': 0.4575323303743805, 'support': 2862602}, 'accuracy': 0.35111518937349856, 'macro avg': {'precision': 0.4001081939895729, 'recall': 0.3599683167666128, 'f1-score': 0.3080004774728609, 'support': 8016486}, 'weighted avg': {'precision': 0.40725365987417844, 'recall': 0.35111518937349856, 'f1-score': 0.30487580619478083, 'support': 8016486}}
[[ 154842 1615440 1058489]
 [  97670 1188649 1038794]
 [  56646 1334737 1471219]]
Evaluating performance on  train set...
5759/5759 - 158s - 158s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0627186
{'0': {'precision': 0.4458085580369811, 'recall': 0.3293255909211382, 'f1-score': 0.3788148593648448, 'support': 415030}, '1': {'precision': 0.45119387515644555, 'recall': 0.4313860219878842, 'f1-score': 0.4410676734849933, 'support': 641808}, '2': {'precision': 0.35655680737104906, 'recall': 0.4732779979584697, 'f1-score': 0.40670863855613953, 'support': 417334}, 'accuracy': 0.4145120108101361, 'macro avg': {'precision': 0.4178530801881586, 'recall': 0.41132987028916407, 'f1-score': 0.40886372380199254, 'support': 1474172}, 'weighted avg': {'precision': 0.42288623248568397, 'recall': 0.4145120108101361, 'f1-score': 0.4138144228959959, 'support': 1474172}}
[[136680 183250  95100]
 [103605 276867 261336]
 [ 66304 153515 197515]]
Evaluating performance on  val set...
2129/2129 - 55s - 55s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0868062
{'0': {'precision': 0.44652914610542466, 'recall': 0.15091493060671243, 'f1-score': 0.22558735695975052, 'support': 169685}, '1': {'precision': 0.41612092923161403, 'recall': 0.5417534164521068, 'f1-score': 0.4706983459454468, 'support': 207013}, '2': {'precision': 0.3994717486403947, 'recall': 0.5178017379726823, 'f1-score': 0.4510043487264444, 'support': 168242}, 'accuracy': 0.4126582743054281, 'macro avg': {'precision': 0.4207072746591445, 'recall': 0.40349002834383385, 'f1-score': 0.38243001721054726, 'support': 544940}, 'weighted avg': {'precision': 0.4204493449089448, 'recall': 0.4126582743054281, 'f1-score': 0.3882947498685259, 'support': 544940}}
[[ 25608  85383  58694]
 [ 22595 112150  72268]
 [  9146  71980  87116]]
training model: results/AAPL/W5/deepLOB_L1/h20
Epoch 1/50
5759/5759 - 381s - loss: 3.0751 - accuracy20: 0.4544 - val_loss: 3.4046 - val_accuracy20: 0.3263 - 381s/epoch - 66ms/step
Epoch 2/50
5759/5759 - 405s - loss: 3.0317 - accuracy20: 0.4724 - val_loss: 3.3337 - val_accuracy20: 0.3874 - 405s/epoch - 70ms/step
Epoch 3/50
5759/5759 - 398s - loss: 3.0088 - accuracy20: 0.4810 - val_loss: 3.3801 - val_accuracy20: 0.3683 - 398s/epoch - 69ms/step
Epoch 4/50
5759/5759 - 401s - loss: 2.9930 - accuracy20: 0.4857 - val_loss: 3.3656 - val_accuracy20: 0.3774 - 401s/epoch - 70ms/step
Epoch 5/50
5759/5759 - 400s - loss: 2.9804 - accuracy20: 0.4900 - val_loss: 3.4389 - val_accuracy20: 0.3639 - 400s/epoch - 69ms/step
Epoch 6/50
5759/5759 - 385s - loss: 2.9701 - accuracy20: 0.4931 - val_loss: 3.4562 - val_accuracy20: 0.3513 - 385s/epoch - 67ms/step
Epoch 7/50
5759/5759 - 393s - loss: 2.9635 - accuracy20: 0.4948 - val_loss: 3.5404 - val_accuracy20: 0.3339 - 393s/epoch - 68ms/step
Epoch 8/50
5759/5759 - 389s - loss: 2.9577 - accuracy20: 0.4964 - val_loss: 3.5034 - val_accuracy20: 0.3452 - 389s/epoch - 68ms/step
Epoch 9/50
5759/5759 - 390s - loss: 2.9510 - accuracy20: 0.4984 - val_loss: 3.5347 - val_accuracy20: 0.3449 - 390s/epoch - 68ms/step
Epoch 10/50
5759/5759 - 381s - loss: 2.9454 - accuracy20: 0.4999 - val_loss: 3.5571 - val_accuracy20: 0.3300 - 381s/epoch - 66ms/step
Epoch 11/50
5759/5759 - 391s - loss: 2.9420 - accuracy20: 0.5013 - val_loss: 3.6096 - val_accuracy20: 0.3340 - 391s/epoch - 68ms/step
Epoch 12/50
5759/5759 - 379s - loss: 2.9370 - accuracy20: 0.5026 - val_loss: 3.5669 - val_accuracy20: 0.3343 - 379s/epoch - 66ms/step
testing model: results/AAPL/W5/deepLOB_L1/h20
Evaluating performance on  test set...
31315/31315 - 866s - 866s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1541398
{'0': {'precision': 0.5250711188822688, 'recall': 0.06106198497903662, 'f1-score': 0.1094013785022514, 'support': 3137615}, '1': {'precision': 0.3122484414887821, 'recall': 0.39655233850890365, 'f1-score': 0.3493868888477843, 'support': 1683808}, '2': {'precision': 0.4333892296376777, 'recall': 0.7478271946437363, 'f1-score': 0.548756764850978, 'support': 3195063}, 'accuracy': 0.4052476359342485, 'macro avg': {'precision': 0.4235695966695762, 'recall': 0.40181383937722553, 'f1-score': 0.3358483440670046, 'support': 8016486}, 'weighted avg': {'precision': 0.44382829766708015, 'recall': 0.4052476359342485, 'f1-score': 0.33491885099299273, 'support': 8016486}}
[[ 191589  746882 2199144]
 [  91404  667718  924686]
 [  81889  723819 2389355]]
Evaluating performance on  train set...
5759/5759 - 168s - 168s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820944
{'0': {'precision': 0.538242728216343, 'recall': 0.13932329855549244, 'f1-score': 0.22135039053208164, 'support': 487571}, '1': {'precision': 0.3805672802644222, 'recall': 0.6083011008628384, 'f1-score': 0.4682109367746727, 'support': 497428}, '2': {'precision': 0.4231025931814359, 'recall': 0.4781989194007028, 'f1-score': 0.4489667442704065, 'support': 489173}, 'accuracy': 0.4100186409726952, 'macro avg': {'precision': 0.44730420055406706, 'recall': 0.4086077729396778, 'f1-score': 0.37950935719238693, 'support': 1474172}, 'weighted avg': {'precision': 0.44683166627834753, 'recall': 0.4100186409726952, 'f1-score': 0.38017793738794187, 'support': 1474172}}
[[ 67930 259800 159841]
 [ 35732 302586 159110]
 [ 22545 232706 233922]]
Evaluating performance on  val set...
2129/2129 - 65s - 65s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1090478
{'0': {'precision': 0.49471029984103493, 'recall': 0.09374967538201046, 'f1-score': 0.1576281547463104, 'support': 192534}, '1': {'precision': 0.3458047338301146, 'recall': 0.6251015739270668, 'f1-score': 0.4452810362062172, 'support': 159982}, '2': {'precision': 0.42424256244897585, 'recall': 0.48340643578763565, 'f1-score': 0.4518962405540185, 'support': 192424}, 'accuracy': 0.38733438543692883, 'macro avg': {'precision': 0.4215858653733751, 'recall': 0.40075256169890433, 'f1-score': 0.35160181050218203, 'support': 544940}, 'weighted avg': {'precision': 0.4261121162584595, 'recall': 0.38733438543692883, 'f1-score': 0.3459856352490836, 'support': 544940}}
[[ 18050  97319  77165]
 [ 10902 100005  49075]
 [  7534  91871  93019]]
training model: results/AAPL/W5/deepLOB_L1/h30
Epoch 1/50
5759/5759 - 374s - loss: 3.1220 - accuracy30: 0.4413 - val_loss: 3.4380 - val_accuracy30: 0.3620 - 374s/epoch - 65ms/step
Epoch 2/50
5759/5759 - 396s - loss: 3.0946 - accuracy30: 0.4534 - val_loss: 3.3519 - val_accuracy30: 0.3639 - 396s/epoch - 69ms/step
Epoch 3/50
5759/5759 - 392s - loss: 3.0746 - accuracy30: 0.4618 - val_loss: 3.4294 - val_accuracy30: 0.3131 - 392s/epoch - 68ms/step
Epoch 4/50
5759/5759 - 383s - loss: 3.0613 - accuracy30: 0.4663 - val_loss: 3.6129 - val_accuracy30: 0.3074 - 383s/epoch - 66ms/step
Epoch 5/50
5759/5759 - 388s - loss: 3.0519 - accuracy30: 0.4699 - val_loss: 3.5730 - val_accuracy30: 0.3122 - 388s/epoch - 67ms/step
Epoch 6/50
5759/5759 - 404s - loss: 3.0449 - accuracy30: 0.4724 - val_loss: 3.4134 - val_accuracy30: 0.3212 - 404s/epoch - 70ms/step
Epoch 7/50
5759/5759 - 410s - loss: 3.0390 - accuracy30: 0.4744 - val_loss: 3.5416 - val_accuracy30: 0.3131 - 410s/epoch - 71ms/step
Epoch 8/50
5759/5759 - 397s - loss: 3.0349 - accuracy30: 0.4754 - val_loss: 3.4740 - val_accuracy30: 0.3143 - 397s/epoch - 69ms/step
Epoch 9/50
5759/5759 - 385s - loss: 3.0294 - accuracy30: 0.4776 - val_loss: 3.4637 - val_accuracy30: 0.3149 - 385s/epoch - 67ms/step
Epoch 10/50
5759/5759 - 381s - loss: 3.0242 - accuracy30: 0.4793 - val_loss: 3.3956 - val_accuracy30: 0.3256 - 381s/epoch - 66ms/step
Epoch 11/50
5759/5759 - 373s - loss: 3.0200 - accuracy30: 0.4804 - val_loss: 3.3907 - val_accuracy30: 0.3199 - 373s/epoch - 65ms/step
Epoch 12/50
5759/5759 - 366s - loss: 3.0165 - accuracy30: 0.4814 - val_loss: 3.3950 - val_accuracy30: 0.3175 - 366s/epoch - 64ms/step
testing model: results/AAPL/W5/deepLOB_L1/h30
Evaluating performance on  test set...
31315/31315 - 861s - 861s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1517565
{'0': {'precision': 0.5954701479163508, 'recall': 0.013910366436845274, 'f1-score': 0.027185667295288544, 'support': 3105310}, '1': {'precision': 0.2443979737533952, 'recall': 0.27220292222608605, 'f1-score': 0.2575521767753604, 'support': 1731146}, '2': {'precision': 0.4251467124834271, 'recall': 0.8042748024389706, 'f1-score': 0.5562531386345055, 'support': 3180030}, 'accuracy': 0.3832149148641936, 'macro avg': {'precision': 0.421671611384391, 'recall': 0.36346269703396733, 'f1-score': 0.28033032756838483, 'support': 8016486}, 'weighted avg': {'precision': 0.4520917618762249, 'recall': 0.3832149148641936, 'f1-score': 0.28680671475963126, 'support': 8016486}}
[[  43196  846219 2215895]
 [  17588  471223 1242335]
 [  11757  610655 2557618]]
Evaluating performance on  train set...
5759/5759 - 163s - 163s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1343675
{'0': {'precision': 0.5977713539723983, 'recall': 0.051795323432929884, 'f1-score': 0.0953305078444494, 'support': 495064}, '1': {'precision': 0.3406445530127711, 'recall': 0.5735653701359481, 'f1-score': 0.4274333808599032, 'support': 485038}, '2': {'precision': 0.40353506262752487, 'recall': 0.5019673325642116, 'f1-score': 0.447401177642118, 'support': 494070}, 'accuracy': 0.37434573441905017, 'macro avg': {'precision': 0.44731698987089813, 'recall': 0.37577600871102984, 'f1-score': 0.3233883554488235, 'support': 1474172}, 'weighted avg': {'precision': 0.4480720015572003, 'recall': 0.37434573441905017, 'f1-score': 0.32259711523395607, 'support': 1474172}}
[[ 25642 298156 171266]
 [ 11524 278201 195313]
 [  5730 240333 248007]]
Evaluating performance on  val set...
2129/2129 - 57s - 57s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1194098
{'0': {'precision': 0.5330432825744505, 'recall': 0.03712701870980214, 'f1-score': 0.06941893634480872, 'support': 191397}, '1': {'precision': 0.32192526784020753, 'recall': 0.6530324750681089, 'f1-score': 0.4312549050947413, 'support': 161139}, '2': {'precision': 0.42144235230908245, 'recall': 0.4484522151306626, 'f1-score': 0.43452796124278903, 'support': 192404}, 'accuracy': 0.36447865820090286, 'macro avg': {'precision': 0.4254703009079135, 'recall': 0.3795372363028579, 'f1-score': 0.31173393422744633, 'support': 544940}, 'weighted avg': {'precision': 0.43121223482049764, 'recall': 0.36447865820090286, 'f1-score': 0.30532439932213906, 'support': 544940}}
[[  7106 117628  66663]
 [  4122 105229  51788]
 [  2103 104017  86284]]
training model: results/AAPL/W5/deepLOB_L1/h50
Epoch 1/50
5759/5759 - 392s - loss: 3.1833 - accuracy50: 0.4191 - val_loss: 3.3747 - val_accuracy50: 0.3129 - 392s/epoch - 68ms/step
Epoch 2/50
5759/5759 - 372s - loss: 3.1616 - accuracy50: 0.4298 - val_loss: 3.4320 - val_accuracy50: 0.3268 - 372s/epoch - 65ms/step
Epoch 3/50
5759/5759 - 379s - loss: 3.1501 - accuracy50: 0.4354 - val_loss: 3.4545 - val_accuracy50: 0.3502 - 379s/epoch - 66ms/step
Epoch 4/50
5759/5759 - 381s - loss: 3.1445 - accuracy50: 0.4381 - val_loss: 3.4326 - val_accuracy50: 0.3270 - 381s/epoch - 66ms/step
Epoch 5/50
5759/5759 - 389s - loss: 3.1394 - accuracy50: 0.4399 - val_loss: 3.4804 - val_accuracy50: 0.3287 - 389s/epoch - 68ms/step
Epoch 6/50
5759/5759 - 378s - loss: 3.1351 - accuracy50: 0.4413 - val_loss: 3.4786 - val_accuracy50: 0.3338 - 378s/epoch - 66ms/step
Epoch 7/50
5759/5759 - 398s - loss: 3.1320 - accuracy50: 0.4428 - val_loss: 3.4704 - val_accuracy50: 0.3505 - 398s/epoch - 69ms/step
Epoch 8/50
5759/5759 - 382s - loss: 3.1289 - accuracy50: 0.4439 - val_loss: 3.4477 - val_accuracy50: 0.3364 - 382s/epoch - 66ms/step
Epoch 9/50
5759/5759 - 380s - loss: 3.1261 - accuracy50: 0.4451 - val_loss: 3.5269 - val_accuracy50: 0.3454 - 380s/epoch - 66ms/step
Epoch 10/50
5759/5759 - 385s - loss: 3.1242 - accuracy50: 0.4460 - val_loss: 3.5896 - val_accuracy50: 0.3489 - 385s/epoch - 67ms/step
Epoch 11/50
5759/5759 - 376s - loss: 3.1218 - accuracy50: 0.4468 - val_loss: 3.6089 - val_accuracy50: 0.3274 - 376s/epoch - 65ms/step
testing model: results/AAPL/W5/deepLOB_L1/h50
Evaluating performance on  test set...
31315/31315 - 834s - 834s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1573972
{'0': {'precision': 0.40911024625914244, 'recall': 0.1990842796440955, 'f1-score': 0.26783344868341663, 'support': 3062507}, '1': {'precision': 0.21936233022266527, 'recall': 0.6489652626666504, 'f1-score': 0.3278913014348185, 'support': 1804226}, '2': {'precision': 0.4424631036748664, 'recall': 0.16695975843185165, 'f1-score': 0.24243768160974175, 'support': 3149753}, 'accuracy': 0.2877144674112822, 'macro avg': {'precision': 0.35697856005222467, 'recall': 0.33833643358086585, 'f1-score': 0.27938747724265894, 'support': 8016486}, 'weighted avg': {'precision': 0.37950938861963807, 'recall': 0.2877144674112822, 'f1-score': 0.2713720996472731, 'support': 8016486}}
[[ 609697 2120324  332486]
 [ 303181 1170880  330165]
 [ 577422 2046449  525882]]
Evaluating performance on  train set...
5759/5759 - 156s - 156s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1239172
{'0': {'precision': 0.4569413940584903, 'recall': 0.09528687907147722, 'f1-score': 0.157690293948989, 'support': 497823}, '1': {'precision': 0.3179679430779236, 'recall': 0.7123221243081451, 'f1-score': 0.4396734625420509, 'support': 478424}, '2': {'precision': 0.40305580767569055, 'recall': 0.24169101772355275, 'f1-score': 0.30218052891134256, 'support': 497925}, 'accuracy': 0.3449882374648277, 'macro avg': {'precision': 0.39265504827070147, 'recall': 0.34976667370105835, 'f1-score': 0.2998480951341275, 'support': 1474172}, 'weighted avg': {'precision': 0.3936385943094907, 'recall': 0.3449882374648277, 'f1-score': 0.2980082593523456, 'support': 1474172}}
[[ 47436 382648  67739]
 [ 27136 340792 110496]
 [ 29240 348341 120344]]
Evaluating performance on  val set...
2129/2129 - 56s - 56s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1291907
{'0': {'precision': 0.44257372126224587, 'recall': 0.04775183916288211, 'f1-score': 0.08620276347457546, 'support': 188265}, '1': {'precision': 0.2953858084528887, 'recall': 0.8289445048966267, 'f1-score': 0.43556317895940533, 'support': 165420}, '2': {'precision': 0.4088599003426755, 'recall': 0.12913649316357742, 'f1-score': 0.19627913630186516, 'support': 191255}, 'accuracy': 0.3134510221308768, 'macro avg': {'precision': 0.3822731433526034, 'recall': 0.33527761240769544, 'f1-score': 0.2393483595786153, 'support': 544940}, 'weighted avg': {'precision': 0.3860615155939222, 'recall': 0.3134510221308768, 'f1-score': 0.2308863187551272, 'support': 544940}}
[[  8990 164461  14814]
 [  7401 137124  20895]
 [  3922 162635  24698]]
training model: results/AAPL/W5/deepLOB_L1/h100
Epoch 1/50
5759/5759 - 397s - loss: 3.1916 - accuracy100: 0.4151 - val_loss: 3.4204 - val_accuracy100: 0.3048 - 397s/epoch - 69ms/step
Epoch 2/50
5759/5759 - 391s - loss: 3.1768 - accuracy100: 0.4230 - val_loss: 3.4767 - val_accuracy100: 0.3032 - 391s/epoch - 68ms/step
Epoch 3/50
5759/5759 - 391s - loss: 3.1679 - accuracy100: 0.4275 - val_loss: 3.4144 - val_accuracy100: 0.3090 - 391s/epoch - 68ms/step
Epoch 4/50
5759/5759 - 380s - loss: 3.1618 - accuracy100: 0.4301 - val_loss: 3.4208 - val_accuracy100: 0.3142 - 380s/epoch - 66ms/step
Epoch 5/50
5759/5759 - 392s - loss: 3.1590 - accuracy100: 0.4313 - val_loss: 3.3933 - val_accuracy100: 0.3137 - 392s/epoch - 68ms/step
Epoch 6/50
5759/5759 - 386s - loss: 3.1564 - accuracy100: 0.4330 - val_loss: 3.3754 - val_accuracy100: 0.3211 - 386s/epoch - 67ms/step
Epoch 7/50
5759/5759 - 375s - loss: 3.1544 - accuracy100: 0.4339 - val_loss: 3.4079 - val_accuracy100: 0.3083 - 375s/epoch - 65ms/step
Epoch 8/50
5759/5759 - 391s - loss: 3.1518 - accuracy100: 0.4349 - val_loss: 3.4216 - val_accuracy100: 0.3111 - 391s/epoch - 68ms/step
Epoch 9/50
5759/5759 - 381s - loss: 3.1498 - accuracy100: 0.4357 - val_loss: 3.4091 - val_accuracy100: 0.3211 - 381s/epoch - 66ms/step
Epoch 10/50
5759/5759 - 395s - loss: 3.1477 - accuracy100: 0.4368 - val_loss: 3.4385 - val_accuracy100: 0.3238 - 395s/epoch - 69ms/step
Epoch 11/50
5759/5759 - 394s - loss: 3.1461 - accuracy100: 0.4373 - val_loss: 3.4278 - val_accuracy100: 0.3284 - 394s/epoch - 68ms/step
Epoch 12/50
5759/5759 - 388s - loss: 3.1454 - accuracy100: 0.4374 - val_loss: 3.5054 - val_accuracy100: 0.3175 - 388s/epoch - 67ms/step
Epoch 13/50
5759/5759 - 390s - loss: 3.1440 - accuracy100: 0.4384 - val_loss: 3.4942 - val_accuracy100: 0.3242 - 390s/epoch - 68ms/step
Epoch 14/50
5759/5759 - 389s - loss: 3.1417 - accuracy100: 0.4391 - val_loss: 3.5005 - val_accuracy100: 0.3350 - 389s/epoch - 67ms/step
Epoch 15/50
5759/5759 - 391s - loss: 3.1404 - accuracy100: 0.4397 - val_loss: 3.5469 - val_accuracy100: 0.3261 - 391s/epoch - 68ms/step
Epoch 16/50
5759/5759 - 392s - loss: 3.1394 - accuracy100: 0.4405 - val_loss: 3.5662 - val_accuracy100: 0.3237 - 392s/epoch - 68ms/step
testing model: results/AAPL/W5/deepLOB_L1/h100
Evaluating performance on  test set...
31315/31315 - 901s - 901s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1839564
{'0': {'precision': 0.41358381820091783, 'recall': 0.07947301394291416, 'f1-score': 0.13332642570849484, 'support': 3319177}, '1': {'precision': 0.15887792074771143, 'recall': 0.7291842299073914, 'f1-score': 0.26090803262867746, 'support': 1276340}, '2': {'precision': 0.4261570165333165, 'recall': 0.18945012363456085, 'f1-score': 0.26229552648773913, 'support': 3420969}, 'accuracy': 0.22984821529034044, 'macro avg': {'precision': 0.33287291849398193, 'recall': 0.3327024558282888, 'f1-score': 0.21884332827497047, 'support': 8016486}, 'weighted avg': {'precision': 0.3783964800792723, 'recall': 0.22984821529034044, 'f1-score': 0.20867575007582692, 'support': 8016486}}
[[ 263785 2428459  626933]
 [  99881  930687  245772]
 [ 274137 2498729  648103]]
Evaluating performance on  train set...
5759/5759 - 169s - 169s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1248084
{'0': {'precision': 0.37512185155999184, 'recall': 0.1306803046170427, 'f1-score': 0.19383483139289379, 'support': 491765}, '1': {'precision': 0.33287461653887895, 'recall': 0.6985529588292121, 'f1-score': 0.4508906952955739, 'support': 486510}, '2': {'precision': 0.33231403404838006, 'recall': 0.1889041474338421, 'f1-score': 0.24087992902968666, 'support': 495897}, 'accuracy': 0.3376770146224457, 'macro avg': {'precision': 0.346770167382417, 'recall': 0.3393791369600323, 'f1-score': 0.29520181857271816, 'support': 1474172}, 'weighted avg': {'precision': 0.34677918151153253, 'recall': 0.3376770146224457, 'f1-score': 0.2944945719998824, 'support': 1474172}}
[[ 64264 337015  90486]
 [ 48927 339853  97730]
 [ 58124 344096  93677]]
Evaluating performance on  val set...
2129/2129 - 68s - 68s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1264427
{'0': {'precision': 0.37685295621059806, 'recall': 0.09424284550117444, 'f1-score': 0.1507790763567262, 'support': 187749}, '1': {'precision': 0.3063079359087287, 'recall': 0.7080192452189932, 'f1-score': 0.42761727699255603, 'support': 165028}, '2': {'precision': 0.3544090893488484, 'recall': 0.21492170709241634, 'f1-score': 0.2675780300944298, 'support': 192163}, 'accuracy': 0.3226722207949499, 'macro avg': {'precision': 0.34585666048939173, 'recall': 0.339061265937528, 'f1-score': 0.281991461147904, 'support': 544940}, 'weighted avg': {'precision': 0.34757489918022544, 'recall': 0.3226722207949499, 'f1-score': 0.2758029173697332, 'support': 544940}}
[[ 17694 129528  40527]
 [ 13480 116843  34705]
 [ 15778 135085  41300]]
training model: results/AAPL/W5/deepLOB_L1/h200
Epoch 1/50
5759/5759 - 414s - loss: 3.2303 - accuracy200: 0.4009 - val_loss: 3.3740 - val_accuracy200: 0.3063 - 414s/epoch - 72ms/step
Epoch 2/50
5759/5759 - 387s - loss: 3.2150 - accuracy200: 0.4093 - val_loss: 3.3883 - val_accuracy200: 0.3088 - 387s/epoch - 67ms/step
Epoch 3/50
5759/5759 - 397s - loss: 3.2077 - accuracy200: 0.4128 - val_loss: 3.3799 - val_accuracy200: 0.3021 - 397s/epoch - 69ms/step
Epoch 4/50
5759/5759 - 379s - loss: 3.2013 - accuracy200: 0.4176 - val_loss: 3.4138 - val_accuracy200: 0.3050 - 379s/epoch - 66ms/step
Epoch 5/50
5759/5759 - 391s - loss: 3.1970 - accuracy200: 0.4194 - val_loss: 3.4464 - val_accuracy200: 0.3052 - 391s/epoch - 68ms/step
Epoch 6/50
5759/5759 - 385s - loss: 3.1930 - accuracy200: 0.4214 - val_loss: 3.4558 - val_accuracy200: 0.3039 - 385s/epoch - 67ms/step
Epoch 7/50
5759/5759 - 379s - loss: 3.1899 - accuracy200: 0.4234 - val_loss: 3.5122 - val_accuracy200: 0.3022 - 379s/epoch - 66ms/step
Epoch 8/50
5759/5759 - 389s - loss: 3.1876 - accuracy200: 0.4241 - val_loss: 3.4842 - val_accuracy200: 0.3002 - 389s/epoch - 68ms/step
Epoch 9/50
5759/5759 - 384s - loss: 3.1852 - accuracy200: 0.4257 - val_loss: 3.5345 - val_accuracy200: 0.2999 - 384s/epoch - 67ms/step
Epoch 10/50
5759/5759 - 384s - loss: 3.1832 - accuracy200: 0.4260 - val_loss: 3.5597 - val_accuracy200: 0.2992 - 384s/epoch - 67ms/step
Epoch 11/50
5759/5759 - 389s - loss: 3.1810 - accuracy200: 0.4270 - val_loss: 3.6271 - val_accuracy200: 0.3025 - 389s/epoch - 68ms/step
testing model: results/AAPL/W5/deepLOB_L1/h200
Evaluating performance on  test set...
31315/31315 - 883s - 883s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1485468
{'0': {'precision': 0.38869257950530034, 'recall': 3.654648962661116e-05, 'f1-score': 7.308610739405505e-05, 'support': 3009865}, '1': {'precision': 0.23745737698226602, 'recall': 0.9993527902515082, 'f1-score': 0.3837350282845437, 'support': 1903556}, '2': {'precision': 0.3845381526104418, 'recall': 0.0006171317713293147, 'f1-score': 0.0012322858903265556, 'support': 3103065}, 'accuracy': 0.2375540854184739, 'macro avg': {'precision': 0.3368960363660027, 'recall': 0.3333354895041547, 'f1-score': 0.12834680009408808, 'support': 8016486}, 'weighted avg': {'precision': 0.3511728814896821, 'recall': 0.2375540854184739, 'f1-score': 0.09162430496780143, 'support': 8016486}}
[[    110 3007852    1903]
 [     70 1902324    1162]
 [    103 3101047    1915]]
Evaluating performance on  train set...
5759/5759 - 164s - 164s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217365
{'0': {'precision': 0.31888149029713486, 'recall': 0.06643810913383116, 'f1-score': 0.109965251102756, 'support': 487988}, '1': {'precision': 0.32673011682437536, 'recall': 0.8784185102729879, 'f1-score': 0.4762993974833613, 'support': 486908}, '2': {'precision': 0.34935846915292706, 'recall': 0.04439228002147109, 'f1-score': 0.07877480372051364, 'support': 499276}, 'accuracy': 0.3271626377383372, 'macro avg': {'precision': 0.33165669209147913, 'recall': 0.3297496331427634, 'f1-score': 0.22167981743554363, 'support': 1474172}, 'weighted avg': {'precision': 0.3317958470616984, 'recall': 0.3271626377383372, 'f1-score': 0.2203990300231746, 'support': 1474172}}
[[ 32421 436916  18651]
 [ 36572 427709  22627]
 [ 32678 444434  22164]]
Evaluating performance on  val set...
2129/2129 - 61s - 61s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1257207
{'0': {'precision': 0.31578090223114924, 'recall': 0.03151905935899867, 'f1-score': 0.0573171212360082, 'support': 184555}, '1': {'precision': 0.30608972734772644, 'recall': 0.877579603768212, 'f1-score': 0.45387355164485066, 'support': 172071}, '2': {'precision': 0.3047016274864376, 'recall': 0.053686927153583905, 'f1-score': 0.09128915455949144, 'support': 188314}, 'accuracy': 0.30633280728153556, 'macro avg': {'precision': 0.30885741902177105, 'recall': 0.3209285300935982, 'f1-score': 0.2008266091467834, 'support': 544940}, 'weighted avg': {'precision': 0.3088921572360286, 'recall': 0.30633280728153556, 'f1-score': 0.19427398074376748, 'support': 544940}}
[[  5817 169444   9294]
 [  7289 151006  13776]
 [  5315 172889  10110]]
training model: results/AAPL/W5/deepLOB_L1/h300
Epoch 1/50
5759/5759 - 398s - loss: 3.1961 - accuracy300: 0.4210 - val_loss: 3.4982 - val_accuracy300: 0.3201 - 398s/epoch - 69ms/step
Epoch 2/50
5759/5759 - 391s - loss: 3.1791 - accuracy300: 0.4285 - val_loss: 3.4460 - val_accuracy300: 0.3196 - 391s/epoch - 68ms/step
Epoch 3/50
5759/5759 - 396s - loss: 3.1713 - accuracy300: 0.4334 - val_loss: 3.4778 - val_accuracy300: 0.3180 - 396s/epoch - 69ms/step
Epoch 4/50
5759/5759 - 384s - loss: 3.1647 - accuracy300: 0.4370 - val_loss: 3.4989 - val_accuracy300: 0.3137 - 384s/epoch - 67ms/step
Epoch 5/50
5759/5759 - 378s - loss: 3.1598 - accuracy300: 0.4388 - val_loss: 3.5138 - val_accuracy300: 0.3154 - 378s/epoch - 66ms/step
Epoch 6/50
5759/5759 - 392s - loss: 3.1546 - accuracy300: 0.4413 - val_loss: 3.6155 - val_accuracy300: 0.3258 - 392s/epoch - 68ms/step
Epoch 7/50
5759/5759 - 385s - loss: 3.1500 - accuracy300: 0.4427 - val_loss: 3.5391 - val_accuracy300: 0.3161 - 385s/epoch - 67ms/step
Epoch 8/50
5759/5759 - 380s - loss: 3.1454 - accuracy300: 0.4445 - val_loss: 3.5117 - val_accuracy300: 0.3172 - 380s/epoch - 66ms/step
Epoch 9/50
5759/5759 - 383s - loss: 3.1429 - accuracy300: 0.4456 - val_loss: 3.5262 - val_accuracy300: 0.3170 - 383s/epoch - 66ms/step
Epoch 10/50
5759/5759 - 393s - loss: 3.1400 - accuracy300: 0.4466 - val_loss: 3.5598 - val_accuracy300: 0.3237 - 393s/epoch - 68ms/step
Epoch 11/50
5759/5759 - 380s - loss: 3.1360 - accuracy300: 0.4480 - val_loss: 3.6131 - val_accuracy300: 0.3288 - 380s/epoch - 66ms/step
Epoch 12/50
5759/5759 - 388s - loss: 3.1326 - accuracy300: 0.4491 - val_loss: 3.6297 - val_accuracy300: 0.3261 - 388s/epoch - 67ms/step
testing model: results/AAPL/W5/deepLOB_L1/h300
Evaluating performance on  test set...
31315/31315 - 855s - 855s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1972183
{'0': {'precision': 0.4076655052264808, 'recall': 7.362785524260221e-05, 'f1-score': 0.00014722911965480434, 'support': 3178145}, '1': {'precision': 0.19811170435122313, 'recall': 0.99828712560785, 'f1-score': 0.3306127671368923, 'support': 1587974}, '2': {'precision': 0.4063010004967005, 'recall': 0.0017616472232212547, 'f1-score': 0.0035080840322748636, 'support': 3250367}, 'accuracy': 0.19849270615578946, 'macro avg': {'precision': 0.3373594033581348, 'recall': 0.3333741335621046, 'f1-score': 0.11142269342960733, 'support': 8016486}, 'weighted avg': {'precision': 0.36560204643217764, 'recall': 0.19849270615578946, 'f1-score': 0.06697135806682103, 'support': 8016486}}
[[    234 3172153    5758]
 [    111 1585254    2609]
 [    229 3244412    5726]]
Evaluating performance on  train set...
5759/5759 - 155s - 155s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1392102
{'0': {'precision': 0.38790318009183156, 'recall': 0.013986885889249536, 'f1-score': 0.027000207147577854, 'support': 489244}, '1': {'precision': 0.33100788309674833, 'recall': 0.9842438355264239, 'f1-score': 0.4954070218431964, 'support': 486984}, '2': {'precision': 0.2969632768361582, 'recall': 0.005066834824799576, 'f1-score': 0.009963667956717479, 'support': 497944}, 'accuracy': 0.33149252597390266, 'macro avg': {'precision': 0.33862478000824603, 'recall': 0.3344325187468244, 'f1-score': 0.1774569656491639, 'support': 1474172}, 'weighted avg': {'precision': 0.33839058692183743, 'recall': 0.33149252597390266, 'f1-score': 0.17598104640980597, 'support': 1474172}}
[[  6843 479948   2453]
 [  4153 479311   3520]
 [  6645 488776   2523]]
Evaluating performance on  val set...
2129/2129 - 50s - 50s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1500548
{'0': {'precision': 0.25193798449612403, 'recall': 0.0007064104027082688, 'f1-score': 0.0014088704651981903, 'support': 184029}, '1': {'precision': 0.319623325231207, 'recall': 0.9887782763936888, 'f1-score': 0.48308806749372424, 'support': 174483}, '2': {'precision': 0.3231497418244406, 'recall': 0.008056729675799772, 'f1-score': 0.01572149301848479, 'support': 186428}, 'accuracy': 0.3195893125848717, 'macro avg': {'precision': 0.2982370171839239, 'recall': 0.33251380549073223, 'f1-score': 0.16673947699246905, 'support': 544940}, 'weighted avg': {'precision': 0.29797205577494906, 'recall': 0.3195893125848717, 'f1-score': 0.16053300327338335, 'support': 544940}}
[[   130 182448   1451]
 [   263 172525   1695]
 [   123 184803   1502]]
training model: results/AAPL/W5/deepLOB_L1/h500
Epoch 1/50
5759/5759 - 365s - loss: 3.2105 - accuracy500: 0.4130 - val_loss: 3.4207 - val_accuracy500: 0.2990 - 365s/epoch - 63ms/step
Epoch 2/50
5759/5759 - 350s - loss: 3.1777 - accuracy500: 0.4295 - val_loss: 3.4142 - val_accuracy500: 0.3040 - 350s/epoch - 61ms/step
Epoch 3/50
5759/5759 - 355s - loss: 3.1616 - accuracy500: 0.4365 - val_loss: 3.4736 - val_accuracy500: 0.3202 - 355s/epoch - 62ms/step
Epoch 4/50
5759/5759 - 355s - loss: 3.1519 - accuracy500: 0.4404 - val_loss: 3.4465 - val_accuracy500: 0.3135 - 355s/epoch - 62ms/step
Epoch 5/50
5759/5759 - 340s - loss: 3.1438 - accuracy500: 0.4435 - val_loss: 3.5189 - val_accuracy500: 0.3343 - 340s/epoch - 59ms/step
Epoch 6/50
5759/5759 - 347s - loss: 3.1361 - accuracy500: 0.4466 - val_loss: 3.5940 - val_accuracy500: 0.3505 - 347s/epoch - 60ms/step
Epoch 7/50
5759/5759 - 344s - loss: 3.1309 - accuracy500: 0.4484 - val_loss: 3.4210 - val_accuracy500: 0.3448 - 344s/epoch - 60ms/step
Epoch 8/50
5759/5759 - 343s - loss: 3.1256 - accuracy500: 0.4502 - val_loss: 3.6161 - val_accuracy500: 0.3497 - 343s/epoch - 60ms/step
Epoch 9/50
5759/5759 - 352s - loss: 3.1224 - accuracy500: 0.4516 - val_loss: 3.6210 - val_accuracy500: 0.3433 - 352s/epoch - 61ms/step
Epoch 10/50
5759/5759 - 341s - loss: 3.1175 - accuracy500: 0.4525 - val_loss: 3.5889 - val_accuracy500: 0.3442 - 341s/epoch - 59ms/step
Epoch 11/50
5759/5759 - 348s - loss: 3.1143 - accuracy500: 0.4543 - val_loss: 3.4186 - val_accuracy500: 0.3220 - 348s/epoch - 60ms/step
Epoch 12/50
5759/5759 - 346s - loss: 3.1105 - accuracy500: 0.4555 - val_loss: 3.6117 - val_accuracy500: 0.3484 - 346s/epoch - 60ms/step
testing model: results/AAPL/W5/deepLOB_L1/h500
Evaluating performance on  test set...
31315/31315 - 802s - 802s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1424633
{'0': {'precision': 0.37142857142857144, 'recall': 0.0001101935200341926, 'f1-score': 0.00022032167616559456, 'support': 3067331}, '1': {'precision': 0.2297475295518982, 'recall': 0.9672928973035494, 'f1-score': 0.37130434114473715, 'support': 1848467}, '2': {'precision': 0.3755947503228491, 'recall': 0.028233733932598183, 'f1-score': 0.05251953569668444, 'support': 3100688}, 'accuracy': 0.23400415094593816, 'macro avg': {'precision': 0.32559028376777294, 'recall': 0.33187894158539394, 'f1-score': 0.14134806617252907, 'support': 8016486}, 'weighted avg': {'precision': 0.3403707351732211, 'recall': 0.23400415094593816, 'f1-score': 0.1060148193573025, 'support': 8016486}}
[[    338 2981680   85313]
 [    234 1788009   60224]
 [    338 3012806   87544]]
Evaluating performance on  train set...
5759/5759 - 145s - 145s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1264553
{'0': {'precision': 0.35613977088154547, 'recall': 0.05015343384127087, 'f1-score': 0.08792483964549011, 'support': 494024}, '1': {'precision': 0.3248021697108035, 'recall': 0.7980443285528032, 'f1-score': 0.4616953961920783, 'support': 483210}, '2': {'precision': 0.32534300148150874, 'recall': 0.14229541713453187, 'f1-score': 0.19799407518578044, 'support': 496938}, 'accuracy': 0.3263608317075619, 'macro avg': {'precision': 0.3354283140246192, 'recall': 0.330164393176202, 'f1-score': 0.2492047703411163, 'support': 1474172}, 'weighted avg': {'precision': 0.3354863279631956, 'recall': 0.3263608317075619, 'f1-score': 0.24754478657149173, 'support': 1474172}}
[[ 24777 399172  70075]
 [ 21028 385623  76559]
 [ 23766 402460  70712]]
Evaluating performance on  val set...
2129/2129 - 57s - 57s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1404464
{'0': {'precision': 0.2924299010018377, 'recall': 0.052260784812272226, 'f1-score': 0.08867437826372225, 'support': 188784}, '1': {'precision': 0.29399214903751847, 'recall': 0.7367967469806397, 'f1-score': 0.4202848127011163, 'support': 164770}, '2': {'precision': 0.34990179016680406, 'recall': 0.17964218908384103, 'f1-score': 0.23740095634310968, 'support': 191386}, 'accuracy': 0.3039765845781187, 'macro avg': {'precision': 0.3121079467353867, 'recall': 0.3228999069589176, 'f1-score': 0.24878671576931607, 'support': 544940}, 'weighted avg': {'precision': 0.31308671934617904, 'recall': 0.3039765845781187, 'f1-score': 0.24117490337575484, 'support': 544940}}
[[  9866 144879  34039]
 [ 13529 121402  29839]
 [ 10343 146662  34381]]
training model: results/AAPL/W5/deepLOB_L1/h1000
Epoch 1/50
5759/5759 - 360s - loss: 3.1760 - accuracy1000: 0.4303 - val_loss: 3.4356 - val_accuracy1000: 0.3035 - 360s/epoch - 62ms/step
Epoch 2/50
5759/5759 - 344s - loss: 3.1223 - accuracy1000: 0.4548 - val_loss: 3.4216 - val_accuracy1000: 0.3165 - 344s/epoch - 60ms/step
Epoch 3/50
5759/5759 - 360s - loss: 3.0963 - accuracy1000: 0.4646 - val_loss: 3.5216 - val_accuracy1000: 0.3256 - 360s/epoch - 62ms/step
Epoch 4/50
5759/5759 - 343s - loss: 3.0821 - accuracy1000: 0.4702 - val_loss: 3.5699 - val_accuracy1000: 0.3395 - 343s/epoch - 60ms/step
Epoch 5/50
5759/5759 - 339s - loss: 3.0729 - accuracy1000: 0.4731 - val_loss: 3.6460 - val_accuracy1000: 0.3492 - 339s/epoch - 59ms/step
Epoch 6/50
5759/5759 - 349s - loss: 3.0659 - accuracy1000: 0.4756 - val_loss: 3.7517 - val_accuracy1000: 0.3351 - 349s/epoch - 61ms/step
Epoch 7/50
5759/5759 - 338s - loss: 3.0593 - accuracy1000: 0.4774 - val_loss: 3.7737 - val_accuracy1000: 0.3464 - 338s/epoch - 59ms/step
Epoch 8/50
5759/5759 - 344s - loss: 3.0509 - accuracy1000: 0.4799 - val_loss: 3.7995 - val_accuracy1000: 0.3540 - 344s/epoch - 60ms/step
Epoch 9/50
5759/5759 - 347s - loss: 3.0454 - accuracy1000: 0.4818 - val_loss: 3.9518 - val_accuracy1000: 0.3521 - 347s/epoch - 60ms/step
Epoch 10/50
5759/5759 - 345s - loss: 3.0416 - accuracy1000: 0.4826 - val_loss: 4.0028 - val_accuracy1000: 0.3545 - 345s/epoch - 60ms/step
Epoch 11/50
5759/5759 - 343s - loss: 3.0380 - accuracy1000: 0.4836 - val_loss: 4.0068 - val_accuracy1000: 0.3494 - 343s/epoch - 59ms/step
Epoch 12/50
5759/5759 - 328s - loss: 3.0336 - accuracy1000: 0.4849 - val_loss: 4.1885 - val_accuracy1000: 0.3561 - 328s/epoch - 57ms/step
testing model: results/AAPL/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
31315/31315 - 690s - 690s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1334212
{'0': {'precision': 0.3843055894556993, 'recall': 0.0010183319147615117, 'f1-score': 0.002031281345690026, 'support': 3092312}, '1': {'precision': 0.2253645405681441, 'recall': 0.5586219113636152, 'f1-score': 0.321162617276243, 'support': 1823337}, '2': {'precision': 0.38526969509264053, 'recall': 0.433460385050875, 'f1-score': 0.4079467810783642, 'support': 3100837}, 'accuracy': 0.2951162142614607, 'macro avg': {'precision': 0.3316466083721613, 'recall': 0.3310335427764172, 'f1-score': 0.2437135599000991, 'support': 8016486}, 'weighted avg': {'precision': 0.3485276237953648, 'recall': 0.2951162142614607, 'f1-score': 0.2316283608024711, 'support': 8016486}}
[[   3149 1747469 1341694]
 [   1866 1018556  802915]
 [   3179 1753568 1344090]]
Evaluating performance on  train set...
5759/5759 - 121s - 121s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.132035
{'0': {'precision': 0.35140417173011934, 'recall': 0.2089010458313211, 'f1-score': 0.2620311097704937, 'support': 505244}, '1': {'precision': 0.31753574378620647, 'recall': 0.3691412170455051, 'f1-score': 0.34139934089158036, 'support': 471749}, '2': {'precision': 0.3308458586504637, 'recall': 0.4161700313166888, 'f1-score': 0.3686350804709513, 'support': 497179}, 'accuracy': 0.33008292112453635, 'macro avg': {'precision': 0.3332619247222632, 'recall': 0.331404098064505, 'f1-score': 0.32402184371100845, 'support': 1474172}, 'weighted avg': {'precision': 0.3336324608627694, 'recall': 0.33008292112453635, 'f1-score': 0.32338293249675926, 'support': 1474172}}
[[105546 188917 210781]
 [ 89899 174142 207708]
 [104910 185358 206911]]
Evaluating performance on  val set...
2129/2129 - 52s - 52s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.144696
{'0': {'precision': 0.3053798459322352, 'recall': 0.13003776322246166, 'f1-score': 0.18240379471717313, 'support': 187484}, '1': {'precision': 0.2733207070113684, 'recall': 0.3567515841517351, 'f1-score': 0.3095124054028164, 'support': 163021}, '2': {'precision': 0.3576937405378841, 'recall': 0.46418597474734485, 'f1-score': 0.4040406753559541, 'support': 194435}, 'accuracy': 0.3170844496641832, 'macro avg': {'precision': 0.3121314311604959, 'recall': 0.3169917740405139, 'f1-score': 0.29865229182531455, 'support': 544940}, 'weighted avg': {'precision': 0.31445486191863875, 'recall': 0.3170844496641832, 'f1-score': 0.2995090534788453, 'support': 544940}}
[[24380 75353 87751]
 [30546 58158 74317]
 [24909 79272 90254]]
training model: results/AAPL/W5/deepOF_L1/h10
Epoch 1/50
5759/5759 - 301s - loss: 3.0817 - accuracy10: 0.4664 - val_loss: 3.5091 - val_accuracy10: 0.3983 - 301s/epoch - 52ms/step
Epoch 2/50
5759/5759 - 287s - loss: 3.0609 - accuracy10: 0.4689 - val_loss: 3.5700 - val_accuracy10: 0.3957 - 287s/epoch - 50ms/step
Epoch 3/50
5759/5759 - 290s - loss: 3.0471 - accuracy10: 0.4715 - val_loss: 3.6374 - val_accuracy10: 0.3943 - 290s/epoch - 50ms/step
Epoch 4/50
5759/5759 - 289s - loss: 3.0363 - accuracy10: 0.4741 - val_loss: 3.6382 - val_accuracy10: 0.3955 - 289s/epoch - 50ms/step
Epoch 5/50
5759/5759 - 286s - loss: 3.0276 - accuracy10: 0.4766 - val_loss: 3.6561 - val_accuracy10: 0.3954 - 286s/epoch - 50ms/step
Epoch 6/50
5759/5759 - 284s - loss: 3.0225 - accuracy10: 0.4780 - val_loss: 3.6672 - val_accuracy10: 0.3964 - 284s/epoch - 49ms/step
Epoch 7/50
5759/5759 - 294s - loss: 3.0170 - accuracy10: 0.4797 - val_loss: 3.6356 - val_accuracy10: 0.3985 - 294s/epoch - 51ms/step
Epoch 8/50
5759/5759 - 290s - loss: 3.0123 - accuracy10: 0.4811 - val_loss: 3.6554 - val_accuracy10: 0.3989 - 290s/epoch - 50ms/step
Epoch 9/50
5759/5759 - 289s - loss: 3.0081 - accuracy10: 0.4823 - val_loss: 3.6592 - val_accuracy10: 0.3992 - 289s/epoch - 50ms/step
Epoch 10/50
5759/5759 - 286s - loss: 3.0046 - accuracy10: 0.4831 - val_loss: 3.6186 - val_accuracy10: 0.4007 - 286s/epoch - 50ms/step
Epoch 11/50
5759/5759 - 288s - loss: 3.0004 - accuracy10: 0.4843 - val_loss: 3.6313 - val_accuracy10: 0.4000 - 288s/epoch - 50ms/step
testing model: results/AAPL/W5/deepOF_L1/h10
Evaluating performance on  test set...
31315/31315 - 626s - 626s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1457952
{'0': {'precision': 0.5156928348462559, 'recall': 0.1219431491224628, 'f1-score': 0.19724485393574526, 'support': 2828769}, '1': {'precision': 0.29534758749757206, 'recall': 0.7958924129246248, 'f1-score': 0.4308216413877123, 'support': 2325112}, '2': {'precision': 0.46614618474489483, 'recall': 0.17618423810521902, 'f1-score': 0.25571764152325765, 'support': 2862600}, 'accuracy': 0.3367853051731801, 'macro avg': {'precision': 0.42572886902957424, 'recall': 0.36467326671743555, 'f1-score': 0.2945947122822384, 'support': 8016481}, 'weighted avg': {'precision': 0.43409099242517996, 'recall': 0.3367853051731801, 'f1-score': 0.28587182045310255, 'support': 8016481}}
[[ 344949 2204138  279682]
 [ 176654 1850539  297919]
 [ 147301 2210954  504345]]
Evaluating performance on  train set...
5759/5759 - 118s - 118s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0565141
{'0': {'precision': 0.44606905267592284, 'recall': 0.18373854029093925, 'f1-score': 0.2602702079901681, 'support': 414932}, '1': {'precision': 0.44992706599410703, 'recall': 0.7220242093467965, 'f1-score': 0.5543886353016213, 'support': 641653}, '2': {'precision': 0.3966296242140664, 'recall': 0.2598315077612755, 'f1-score': 0.3139770757553396, 'support': 417586}, 'accuracy': 0.4395894370463128, 'macro avg': {'precision': 0.43087524762803203, 'recall': 0.38853141913300376, 'f1-score': 0.3762119730157097, 'support': 1474171}, 'weighted avg': {'precision': 0.43374367973477834, 'recall': 0.4395894370463128, 'f1-score': 0.40350271447839964, 'support': 1474171}}
[[ 76239 284844  53849]
 [ 67155 463289 111209]
 [ 27519 281565 108502]]
Evaluating performance on  val set...
2129/2129 - 48s - 48s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0956954
{'0': {'precision': 0.46202990573617886, 'recall': 0.13896600708505008, 'f1-score': 0.21366684792459667, 'support': 169653}, '1': {'precision': 0.3855233739714314, 'recall': 0.7689995893025391, 'f1-score': 0.5135754344978025, 'support': 206965}, '2': {'precision': 0.4199380866047533, 'recall': 0.20228610809108785, 'f1-score': 0.273045123936456, 'support': 168321}, 'accuracy': 0.3978078280321284, 'macro avg': {'precision': 0.42249712210412116, 'recall': 0.37008390149289233, 'f1-score': 0.3334291354529517, 'support': 544939}, 'weighted avg': {'precision': 0.41997178283671366, 'recall': 0.3978078280321284, 'f1-score': 0.3459113586252728, 'support': 544939}}
[[ 23576 129193  16884]
 [ 17661 159156  30148]
 [  9790 124482  34049]]
training model: results/AAPL/W5/deepOF_L1/h20
Epoch 1/50
5759/5759 - 306s - loss: 3.1206 - accuracy20: 0.4524 - val_loss: 3.4440 - val_accuracy20: 0.3318 - 306s/epoch - 53ms/step
Epoch 2/50
5759/5759 - 290s - loss: 3.0994 - accuracy20: 0.4608 - val_loss: 3.4901 - val_accuracy20: 0.3337 - 290s/epoch - 50ms/step
Epoch 3/50
5759/5759 - 290s - loss: 3.0885 - accuracy20: 0.4645 - val_loss: 3.5105 - val_accuracy20: 0.3333 - 290s/epoch - 50ms/step
Epoch 4/50
5759/5759 - 292s - loss: 3.0789 - accuracy20: 0.4672 - val_loss: 3.5544 - val_accuracy20: 0.3323 - 292s/epoch - 51ms/step
Epoch 5/50
5759/5759 - 288s - loss: 3.0719 - accuracy20: 0.4698 - val_loss: 3.5711 - val_accuracy20: 0.3315 - 288s/epoch - 50ms/step
Epoch 6/50
5759/5759 - 287s - loss: 3.0659 - accuracy20: 0.4717 - val_loss: 3.5852 - val_accuracy20: 0.3311 - 287s/epoch - 50ms/step
Epoch 7/50
5759/5759 - 285s - loss: 3.0612 - accuracy20: 0.4730 - val_loss: 3.5922 - val_accuracy20: 0.3344 - 285s/epoch - 50ms/step
Epoch 8/50
5759/5759 - 291s - loss: 3.0571 - accuracy20: 0.4741 - val_loss: 3.6218 - val_accuracy20: 0.3319 - 291s/epoch - 50ms/step
Epoch 9/50
5759/5759 - 287s - loss: 3.0526 - accuracy20: 0.4750 - val_loss: 3.6189 - val_accuracy20: 0.3331 - 287s/epoch - 50ms/step
Epoch 10/50
5759/5759 - 293s - loss: 3.0495 - accuracy20: 0.4757 - val_loss: 3.6323 - val_accuracy20: 0.3316 - 293s/epoch - 51ms/step
Epoch 11/50
5759/5759 - 295s - loss: 3.0473 - accuracy20: 0.4767 - val_loss: 3.6168 - val_accuracy20: 0.3338 - 295s/epoch - 51ms/step
testing model: results/AAPL/W5/deepOF_L1/h20
Evaluating performance on  test set...
31315/31315 - 632s - 632s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1970413
{'0': {'precision': 0.5536608164003978, 'recall': 0.09457989069394176, 'f1-score': 0.16156091070364512, 'support': 3137612}, '1': {'precision': 0.2125814032572004, 'recall': 0.8494418603546248, 'f1-score': 0.34005948616506815, 'support': 1683808}, '2': {'precision': 0.4980312710199372, 'recall': 0.11725910710311947, 'f1-score': 0.18982485091795126, 'support': 3195061}, 'accuracy': 0.2621726415867511, 'macro avg': {'precision': 0.4214244968925118, 'recall': 0.353760286050562, 'f1-score': 0.23048174926222154, 'support': 8016481}, 'weighted avg': {'precision': 0.4598475789738186, 'recall': 0.2621726415867511, 'f1-score': 0.2103182572794817, 'support': 8016481}}
[[ 296755 2613920  226937]
 [ 102836 1430297  150675]
 [ 136396 2684015  374650]]
Evaluating performance on  train set...
5759/5759 - 126s - 126s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1067599
{'0': {'precision': 0.5126990228109338, 'recall': 0.1422894818899447, 'f1-score': 0.22275712565234845, 'support': 487464}, '1': {'precision': 0.34964600284689545, 'recall': 0.7916816625415445, 'f1-score': 0.48506373275482945, 'support': 497359}, '2': {'precision': 0.4369059817810911, 'recall': 0.18994662285326597, 'f1-score': 0.2647793600287141, 'support': 489348}, 'accuracy': 0.3772025090712, 'macro avg': {'precision': 0.43308366914630686, 'recall': 0.374639255761585, 'f1-score': 0.324200072811964, 'support': 1474171}, 'weighted avg': {'precision': 0.4325284998538511, 'recall': 0.3772025090712, 'f1-score': 0.325203889392436, 'support': 1474171}}
[[ 69361 362667  55436]
 [ 39249 393750  64360]
 [ 26676 369722  92950]]
Evaluating performance on  val set...
2129/2129 - 47s - 47s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1452571
{'0': {'precision': 0.5108606975321232, 'recall': 0.10412596133859904, 'f1-score': 0.17299191933144553, 'support': 192440}, '1': {'precision': 0.2984241479615416, 'recall': 0.8226572989851678, 'f1-score': 0.4379713966056951, 'support': 160125}, '2': {'precision': 0.4523117117397322, 'recall': 0.1511898697329161, 'f1-score': 0.22662723968255824, 'support': 192374}, 'accuracy': 0.33187384276038234, 'macro avg': {'precision': 0.42053218574446566, 'recall': 0.359324376685561, 'f1-score': 0.27919685187323295, 'support': 544939}, 'weighted avg': {'precision': 0.4277693697086149, 'recall': 0.33187384276038234, 'f1-score': 0.2697878541347247, 'support': 544939}}
[[ 20038 155461  16941]
 [ 10120 131728  18277]
 [  9066 154223  29085]]
training model: results/AAPL/W5/deepOF_L1/h30
Epoch 1/50
5759/5759 - 298s - loss: 3.1573 - accuracy30: 0.4404 - val_loss: 3.4353 - val_accuracy30: 0.3217 - 298s/epoch - 52ms/step
Epoch 2/50
5759/5759 - 295s - loss: 3.1395 - accuracy30: 0.4480 - val_loss: 3.4754 - val_accuracy30: 0.3237 - 295s/epoch - 51ms/step
Epoch 3/50
5759/5759 - 292s - loss: 3.1315 - accuracy30: 0.4506 - val_loss: 3.4972 - val_accuracy30: 0.3248 - 292s/epoch - 51ms/step
Epoch 4/50
5759/5759 - 297s - loss: 3.1242 - accuracy30: 0.4539 - val_loss: 3.4995 - val_accuracy30: 0.3270 - 297s/epoch - 52ms/step
Epoch 5/50
5759/5759 - 284s - loss: 3.1158 - accuracy30: 0.4564 - val_loss: 3.4931 - val_accuracy30: 0.3299 - 284s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 294s - loss: 3.1100 - accuracy30: 0.4585 - val_loss: 3.5015 - val_accuracy30: 0.3311 - 294s/epoch - 51ms/step
Epoch 7/50
5759/5759 - 286s - loss: 3.1056 - accuracy30: 0.4604 - val_loss: 3.5043 - val_accuracy30: 0.3316 - 286s/epoch - 50ms/step
Epoch 8/50
5759/5759 - 290s - loss: 3.1016 - accuracy30: 0.4615 - val_loss: 3.4895 - val_accuracy30: 0.3344 - 290s/epoch - 50ms/step
Epoch 9/50
5759/5759 - 288s - loss: 3.0990 - accuracy30: 0.4621 - val_loss: 3.5012 - val_accuracy30: 0.3353 - 288s/epoch - 50ms/step
Epoch 10/50
5759/5759 - 284s - loss: 3.0958 - accuracy30: 0.4632 - val_loss: 3.4825 - val_accuracy30: 0.3389 - 284s/epoch - 49ms/step
Epoch 11/50
5759/5759 - 287s - loss: 3.0932 - accuracy30: 0.4640 - val_loss: 3.4817 - val_accuracy30: 0.3374 - 287s/epoch - 50ms/step
testing model: results/AAPL/W5/deepOF_L1/h30
Evaluating performance on  test set...
31315/31315 - 641s - 641s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1926979
{'0': {'precision': 0.5481496943660105, 'recall': 0.06257805188925021, 'f1-score': 0.11233201775239428, 'support': 3105306}, '1': {'precision': 0.21625709596144396, 'recall': 0.8961826443292478, 'f1-score': 0.34843389550798914, 'support': 1731146}, '2': {'precision': 0.5046793320450741, 'recall': 0.07744646353854005, 'f1-score': 0.13428585293561168, 'support': 3180029}, 'accuracy': 0.2484917010344065, 'macro avg': {'precision': 0.4230287074575095, 'recall': 0.3454023865856794, 'f1-score': 0.19835058873199837, 'support': 8016481}, 'weighted avg': {'precision': 0.459233927338214, 'recall': 0.2484917010344065, 'f1-score': 0.17202662113421965, 'support': 8016481}}
[[ 194324 2775307  135675]
 [  73683 1551423  106040]
 [  86502 2847245  246282]]
Evaluating performance on  train set...
5759/5759 - 119s - 119s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1136267
{'0': {'precision': 0.5196681645350847, 'recall': 0.1063491357705305, 'f1-score': 0.17656464177198836, 'support': 494776}, '1': {'precision': 0.3354365330446987, 'recall': 0.8612987291455338, 'f1-score': 0.4828320326947259, 'support': 485028}, '2': {'precision': 0.4600508187464709, 'recall': 0.1186608329439465, 'f1-score': 0.18866049504807206, 'support': 494367}, 'accuracy': 0.35886949343054503, 'macro avg': {'precision': 0.43838517210875144, 'recall': 0.36210289928667033, 'f1-score': 0.2826857231715954, 'support': 1474171}, 'weighted avg': {'precision': 0.4390599120704801, 'recall': 0.35886949343054503, 'f1-score': 0.2813883364322491, 'support': 1474171}}
[[ 52619 411816  30341]
 [ 28765 417754  38509]
 [ 19871 415834  58662]]
Evaluating performance on  val set...
2129/2129 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1480268
{'0': {'precision': 0.5010493913530153, 'recall': 0.07489203291819599, 'f1-score': 0.1303070275187628, 'support': 191262}, '1': {'precision': 0.2982872554497372, 'recall': 0.8805660108266313, 'f1-score': 0.44562224345607643, 'support': 161269}, '2': {'precision': 0.4744866287587217, 'recall': 0.09931499729740967, 'f1-score': 0.164250626394076, 'support': 192408}, 'accuracy': 0.32194612608016676, 'macro avg': {'precision': 0.42460775852049143, 'recall': 0.3515910136807457, 'f1-score': 0.2467266324563051, 'support': 544939}, 'weighted avg': {'precision': 0.4316652310704358, 'recall': 0.32194612608016676, 'f1-score': 0.23560613353135484, 'support': 544939}}
[[ 14324 167352   9586]
 [  7683 142008  11578]
 [  6581 166718  19109]]
training model: results/AAPL/W5/deepOF_L1/h50
Epoch 1/50
5759/5759 - 301s - loss: 3.2017 - accuracy50: 0.4210 - val_loss: 3.3718 - val_accuracy50: 0.3116 - 301s/epoch - 52ms/step
Epoch 2/50
5759/5759 - 289s - loss: 3.1907 - accuracy50: 0.4261 - val_loss: 3.3595 - val_accuracy50: 0.3145 - 289s/epoch - 50ms/step
Epoch 3/50
5759/5759 - 288s - loss: 3.1856 - accuracy50: 0.4288 - val_loss: 3.3728 - val_accuracy50: 0.3176 - 288s/epoch - 50ms/step
Epoch 4/50
5759/5759 - 288s - loss: 3.1809 - accuracy50: 0.4306 - val_loss: 3.3930 - val_accuracy50: 0.3168 - 288s/epoch - 50ms/step
Epoch 5/50
5759/5759 - 284s - loss: 3.1775 - accuracy50: 0.4319 - val_loss: 3.3977 - val_accuracy50: 0.3180 - 284s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 289s - loss: 3.1744 - accuracy50: 0.4336 - val_loss: 3.4094 - val_accuracy50: 0.3186 - 289s/epoch - 50ms/step
Epoch 7/50
5759/5759 - 283s - loss: 3.1718 - accuracy50: 0.4345 - val_loss: 3.4088 - val_accuracy50: 0.3200 - 283s/epoch - 49ms/step
Epoch 8/50
5759/5759 - 278s - loss: 3.1693 - accuracy50: 0.4359 - val_loss: 3.4253 - val_accuracy50: 0.3199 - 278s/epoch - 48ms/step
Epoch 9/50
5759/5759 - 285s - loss: 3.1674 - accuracy50: 0.4363 - val_loss: 3.4247 - val_accuracy50: 0.3216 - 285s/epoch - 49ms/step
Epoch 10/50
5759/5759 - 285s - loss: 3.1650 - accuracy50: 0.4372 - val_loss: 3.4332 - val_accuracy50: 0.3207 - 285s/epoch - 49ms/step
Epoch 11/50
5759/5759 - 286s - loss: 3.1631 - accuracy50: 0.4386 - val_loss: 3.4389 - val_accuracy50: 0.3216 - 286s/epoch - 50ms/step
Epoch 12/50
5759/5759 - 289s - loss: 3.1610 - accuracy50: 0.4391 - val_loss: 3.4587 - val_accuracy50: 0.3210 - 289s/epoch - 50ms/step
testing model: results/AAPL/W5/deepOF_L1/h50
Evaluating performance on  test set...
31315/31315 - 643s - 643s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1669345
{'0': {'precision': 0.5382834534628643, 'recall': 0.04486950706660532, 'f1-score': 0.08283422996621538, 'support': 3062503}, '1': {'precision': 0.22503472902040855, 'recall': 0.9498405410408673, 'f1-score': 0.3638634912361068, 'support': 1804226}, '2': {'precision': 0.4947740926672702, 'recall': 0.02290466043040849, 'f1-score': 0.04378249064500037, 'support': 3149752}, 'accuracy': 0.239916242550815, 'macro avg': {'precision': 0.4193640917168477, 'recall': 0.33920490284596033, 'f1-score': 0.16349340394910752, 'support': 8016481}, 'weighted avg': {'precision': 0.4506870144155369, 'recall': 0.239916242550815, 'f1-score': 0.1307401634940882, 'support': 8016481}}
[[ 137413 2886090   39000]
 [  55831 1713727   34668]
 [  62036 3015572   72144]]
Evaluating performance on  train set...
5759/5759 - 109s - 109s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1091659
{'0': {'precision': 0.5417093987380278, 'recall': 0.06258384274915856, 'f1-score': 0.1122046499905488, 'support': 497956}, '1': {'precision': 0.3266978948279965, 'recall': 0.9388087978820843, 'f1-score': 0.4847178757423506, 'support': 478206}, '2': {'precision': 0.47438464256271345, 'recall': 0.04044103620617298, 'f1-score': 0.07452855324313924, 'support': 498009}, 'accuracy': 0.3393419080961435, 'macro avg': {'precision': 0.4475973120429126, 'recall': 0.3472778922791386, 'f1-score': 0.2238170263253462, 'support': 1474171}, 'weighted avg': {'precision': 0.44921800816195995, 'recall': 0.3393419080961435, 'f1-score': 0.2203162763682115, 'support': 1474171}}
[[ 31164 457474   9318]
 [ 16265 448944  12997]
 [ 10100 467769  20140]]
Evaluating performance on  val set...
2129/2129 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1244218
{'0': {'precision': 0.516728624535316, 'recall': 0.03986171077158379, 'f1-score': 0.07401381472880829, 'support': 188301}, '1': {'precision': 0.304125399430672, 'recall': 0.9487489496496817, 'f1-score': 0.4606026988794778, 'support': 165421}, '2': {'precision': 0.47821244605318114, 'recall': 0.03592776792858376, 'f1-score': 0.06683431995836232, 'support': 191217}, 'accuracy': 0.31438197669830936, 'macro avg': {'precision': 0.4330221566730564, 'recall': 0.3415128094499497, 'f1-score': 0.2004836111888828, 'support': 544939}, 'weighted avg': {'precision': 0.4386758769785185, 'recall': 0.31438197669830936, 'f1-score': 0.18884699487111328, 'support': 544939}}
[[  7506 177663   3132]
 [  4114 156943   4364]
 [  2906 181441   6870]]
training model: results/AAPL/W5/deepOF_L1/h100
Epoch 1/50
5759/5759 - 301s - loss: 3.2063 - accuracy100: 0.4145 - val_loss: 3.3859 - val_accuracy100: 0.3041 - 301s/epoch - 52ms/step
Epoch 2/50
5759/5759 - 289s - loss: 3.2035 - accuracy100: 0.4163 - val_loss: 3.3749 - val_accuracy100: 0.3044 - 289s/epoch - 50ms/step
Epoch 3/50
5759/5759 - 290s - loss: 3.2021 - accuracy100: 0.4167 - val_loss: 3.3715 - val_accuracy100: 0.3047 - 290s/epoch - 50ms/step
Epoch 4/50
5759/5759 - 285s - loss: 3.1993 - accuracy100: 0.4184 - val_loss: 3.3699 - val_accuracy100: 0.3048 - 285s/epoch - 49ms/step
Epoch 5/50
5759/5759 - 284s - loss: 3.1976 - accuracy100: 0.4195 - val_loss: 3.3661 - val_accuracy100: 0.3048 - 284s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 282s - loss: 3.1957 - accuracy100: 0.4204 - val_loss: 3.3584 - val_accuracy100: 0.3050 - 282s/epoch - 49ms/step
Epoch 7/50
5759/5759 - 283s - loss: 3.1933 - accuracy100: 0.4215 - val_loss: 3.3613 - val_accuracy100: 0.3053 - 283s/epoch - 49ms/step
Epoch 8/50
5759/5759 - 282s - loss: 3.1915 - accuracy100: 0.4220 - val_loss: 3.3615 - val_accuracy100: 0.3058 - 282s/epoch - 49ms/step
Epoch 9/50
5759/5759 - 281s - loss: 3.1900 - accuracy100: 0.4227 - val_loss: 3.3605 - val_accuracy100: 0.3061 - 281s/epoch - 49ms/step
Epoch 10/50
5759/5759 - 287s - loss: 3.1886 - accuracy100: 0.4236 - val_loss: 3.3663 - val_accuracy100: 0.3060 - 287s/epoch - 50ms/step
Epoch 11/50
5759/5759 - 284s - loss: 3.1870 - accuracy100: 0.4243 - val_loss: 3.3672 - val_accuracy100: 0.3068 - 284s/epoch - 49ms/step
Epoch 12/50
5759/5759 - 285s - loss: 3.1857 - accuracy100: 0.4248 - val_loss: 3.3695 - val_accuracy100: 0.3078 - 285s/epoch - 49ms/step
Epoch 13/50
5759/5759 - 286s - loss: 3.1842 - accuracy100: 0.4254 - val_loss: 3.3694 - val_accuracy100: 0.3081 - 286s/epoch - 50ms/step
Epoch 14/50
5759/5759 - 283s - loss: 3.1832 - accuracy100: 0.4258 - val_loss: 3.3666 - val_accuracy100: 0.3075 - 283s/epoch - 49ms/step
Epoch 15/50
5759/5759 - 280s - loss: 3.1814 - accuracy100: 0.4263 - val_loss: 3.3665 - val_accuracy100: 0.3083 - 280s/epoch - 49ms/step
Epoch 16/50
5759/5759 - 283s - loss: 3.1807 - accuracy100: 0.4268 - val_loss: 3.3670 - val_accuracy100: 0.3098 - 283s/epoch - 49ms/step
testing model: results/AAPL/W5/deepOF_L1/h100
Evaluating performance on  test set...
31315/31315 - 592s - 592s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1782564
{'0': {'precision': 0.54817343196843, 'recall': 0.013015587613062768, 'f1-score': 0.025427437394477843, 'support': 3319174}, '1': {'precision': 0.15925873356545053, 'recall': 0.9881128852813513, 'f1-score': 0.27430625639455164, 'support': 1276340}, '2': {'precision': 0.522425604795547, 'recall': 0.002853286804578939, 'f1-score': 0.005675575806964136, 'support': 3420967}, 'accuracy': 0.16392853672328295, 'macro avg': {'precision': 0.40995259010980917, 'recall': 0.334660586566331, 'f1-score': 0.10180308986533121, 'support': 8016481}, 'weighted avg': {'precision': 0.4752649010008153, 'recall': 0.16392853672328295, 'f1-score': 0.05662361002472573, 'support': 8016481}}
[[  43201 3270167    5806]
 [  12055 1261168    3117]
 [  23553 3387653    9761]]
Evaluating performance on  train set...
5759/5759 - 123s - 123s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069897
{'0': {'precision': 0.5253700397396763, 'recall': 0.01854883149681872, 'f1-score': 0.035832550977519216, 'support': 491783}, '1': {'precision': 0.33043498041302566, 'recall': 0.9848845953131357, 'f1-score': 0.49484600999984, 'support': 486722}, '2': {'precision': 0.4499098212821774, 'recall': 0.005535985926006626, 'f1-score': 0.010937391009735634, 'support': 495666}, 'accuracy': 0.3332252499879593, 'macro avg': {'precision': 0.4352382804782931, 'recall': 0.3363231375786537, 'f1-score': 0.18053865066236496, 'support': 1474171}, 'weighted avg': {'precision': 0.43563672753400906, 'recall': 0.3332252499879593, 'f1-score': 0.17901286346614545, 'support': 1474171}}
[[  9122 481281   1380]
 [  5382 479365   1975]
 [  2859 490063   2744]]
Evaluating performance on  val set...
2129/2129 - 44s - 44s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1210506
{'0': {'precision': 0.48863098057792514, 'recall': 0.010993168569023031, 'f1-score': 0.02150257447207688, 'support': 187662}, '1': {'precision': 0.3029551161097657, 'recall': 0.9879480129362032, 'f1-score': 0.46371241688862863, 'support': 165118}, '2': {'precision': 0.4502432551968156, 'recall': 0.005297696178685359, 'f1-score': 0.01047217364468676, 'support': 192159}, 'accuracy': 0.3050047803515623, 'macro avg': {'precision': 0.4139431172948355, 'recall': 0.33474629256130384, 'f1-score': 0.16522905500179744, 'support': 544939}, 'weighted avg': {'precision': 0.41883422477450094, 'recall': 0.3050047803515623, 'f1-score': 0.15160376739008374, 'support': 544939}}
[[  2063 185012    587]
 [  1334 163128    656]
 [   825 190316   1018]]
training model: results/AAPL/W5/deepOF_L1/h200
Epoch 1/50
5759/5759 - 296s - loss: 3.2467 - accuracy200: 0.3921 - val_loss: 3.3363 - val_accuracy200: 0.3168 - 296s/epoch - 51ms/step
Epoch 2/50
5759/5759 - 287s - loss: 3.2434 - accuracy200: 0.3930 - val_loss: 3.3333 - val_accuracy200: 0.3165 - 287s/epoch - 50ms/step
Epoch 3/50
5759/5759 - 281s - loss: 3.2430 - accuracy200: 0.3937 - val_loss: 3.3305 - val_accuracy200: 0.3165 - 281s/epoch - 49ms/step
Epoch 4/50
5759/5759 - 281s - loss: 3.2424 - accuracy200: 0.3940 - val_loss: 3.3267 - val_accuracy200: 0.3164 - 281s/epoch - 49ms/step
Epoch 5/50
5759/5759 - 283s - loss: 3.2410 - accuracy200: 0.3949 - val_loss: 3.3277 - val_accuracy200: 0.3165 - 283s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 283s - loss: 3.2393 - accuracy200: 0.3965 - val_loss: 3.3257 - val_accuracy200: 0.3172 - 283s/epoch - 49ms/step
Epoch 7/50
5759/5759 - 277s - loss: 3.2381 - accuracy200: 0.3970 - val_loss: 3.3269 - val_accuracy200: 0.3171 - 277s/epoch - 48ms/step
Epoch 8/50
5759/5759 - 274s - loss: 3.2366 - accuracy200: 0.3978 - val_loss: 3.3259 - val_accuracy200: 0.3176 - 274s/epoch - 48ms/step
Epoch 9/50
5759/5759 - 285s - loss: 3.2352 - accuracy200: 0.3988 - val_loss: 3.3250 - val_accuracy200: 0.3182 - 285s/epoch - 50ms/step
Epoch 10/50
5759/5759 - 279s - loss: 3.2340 - accuracy200: 0.3995 - val_loss: 3.3309 - val_accuracy200: 0.3179 - 279s/epoch - 48ms/step
Epoch 11/50
5759/5759 - 280s - loss: 3.2328 - accuracy200: 0.4002 - val_loss: 3.3290 - val_accuracy200: 0.3184 - 280s/epoch - 49ms/step
Epoch 12/50
5759/5759 - 279s - loss: 3.2315 - accuracy200: 0.4010 - val_loss: 3.3286 - val_accuracy200: 0.3188 - 279s/epoch - 49ms/step
Epoch 13/50
5759/5759 - 283s - loss: 3.2303 - accuracy200: 0.4020 - val_loss: 3.3290 - val_accuracy200: 0.3196 - 283s/epoch - 49ms/step
Epoch 14/50
5759/5759 - 279s - loss: 3.2293 - accuracy200: 0.4021 - val_loss: 3.3333 - val_accuracy200: 0.3195 - 279s/epoch - 49ms/step
Epoch 15/50
5759/5759 - 285s - loss: 3.2284 - accuracy200: 0.4026 - val_loss: 3.3322 - val_accuracy200: 0.3203 - 285s/epoch - 50ms/step
Epoch 16/50
5759/5759 - 279s - loss: 3.2273 - accuracy200: 0.4036 - val_loss: 3.3320 - val_accuracy200: 0.3206 - 279s/epoch - 48ms/step
Epoch 17/50
5759/5759 - 278s - loss: 3.2263 - accuracy200: 0.4039 - val_loss: 3.3353 - val_accuracy200: 0.3199 - 278s/epoch - 48ms/step
Epoch 18/50
5759/5759 - 276s - loss: 3.2254 - accuracy200: 0.4044 - val_loss: 3.3320 - val_accuracy200: 0.3213 - 276s/epoch - 48ms/step
Epoch 19/50
5759/5759 - 288s - loss: 3.2247 - accuracy200: 0.4049 - val_loss: 3.3346 - val_accuracy200: 0.3215 - 288s/epoch - 50ms/step
testing model: results/AAPL/W5/deepOF_L1/h200
Evaluating performance on  test set...
31315/31315 - 611s - 611s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1291927
{'0': {'precision': 0.4475985375326831, 'recall': 0.027414222783045464, 'f1-score': 0.05166415326245294, 'support': 3009861}, '1': {'precision': 0.2373849238115166, 'recall': 0.9744336389368109, 'f1-score': 0.38176648262225665, 'support': 1903556}, '2': {'precision': 0.4546746856205577, 'recall': 0.0026799318351152283, 'f1-score': 0.005328456817137691, 'support': 3103064}, 'accuracy': 0.24271472732237498, 'macro avg': {'precision': 0.37988604898825246, 'recall': 0.33484259785165715, 'f1-score': 0.14625303090061575, 'support': 8016481}, 'weighted avg': {'precision': 0.40042127293360824, 'recall': 0.24271472732237498, 'f1-score': 0.11211282620416449, 'support': 8016481}}
[[  82513 2922025    5323]
 [  44016 1854889    4651]
 [  57817 3036931    8316]]
Evaluating performance on  train set...
5759/5759 - 118s - 118s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024312
{'0': {'precision': 0.44076121897904075, 'recall': 0.035132636515885426, 'f1-score': 0.06507797282057708, 'support': 487837}, '1': {'precision': 0.3308119849588528, 'recall': 0.968848887328253, 'f1-score': 0.49321608486714935, 'support': 486981}, '2': {'precision': 0.42504136789851077, 'recall': 0.007715984483922195, 'f1-score': 0.01515681978214776, 'support': 499353}, 'accuracy': 0.33429161203144003, 'macro avg': {'precision': 0.3988715239454681, 'recall': 0.3372325027760203, 'f1-score': 0.19115029248995807, 'support': 1474171}, 'weighted avg': {'precision': 0.399115478607672, 'recall': 0.33429161203144003, 'f1-score': 0.18960005907064778, 'support': 1474171}}
[[ 17139 468480   2218]
 [ 12176 471811   2994]
 [  9570 485930   3853]]
Evaluating performance on  val set...
2129/2129 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089711
{'0': {'precision': 0.424375785881085, 'recall': 0.02559990464374143, 'f1-score': 0.04828696252011956, 'support': 184571}, '1': {'precision': 0.3154076123836955, 'recall': 0.9724296648437546, 'f1-score': 0.47632061010030285, 'support': 172069}, '2': {'precision': 0.41714631929718266, 'recall': 0.007312837561537767, 'f1-score': 0.014373695198329853, 'support': 188299}, 'accuracy': 0.3182502995748148, 'macro avg': {'precision': 0.3856432391873211, 'recall': 0.33511413568301124, 'f1-score': 0.17966042260625079, 'support': 544939}, 'weighted avg': {'precision': 0.3874701029077531, 'recall': 0.3182502995748148, 'f1-score': 0.17172369100174573, 'support': 544939}}
[[  4725 178994    852]
 [  3672 167325   1072]
 [  2737 184185   1377]]
training model: results/AAPL/W5/deepOF_L1/h300
Epoch 1/50
5759/5759 - 298s - loss: 3.2257 - accuracy300: 0.4026 - val_loss: 3.4762 - val_accuracy300: 0.3200 - 298s/epoch - 52ms/step
Epoch 2/50
5759/5759 - 280s - loss: 3.2289 - accuracy300: 0.3997 - val_loss: 3.4483 - val_accuracy300: 0.3201 - 280s/epoch - 49ms/step
Epoch 3/50
5759/5759 - 281s - loss: 3.2288 - accuracy300: 0.3996 - val_loss: 3.4504 - val_accuracy300: 0.3200 - 281s/epoch - 49ms/step
Epoch 4/50
5759/5759 - 274s - loss: 3.2281 - accuracy300: 0.4001 - val_loss: 3.4450 - val_accuracy300: 0.3200 - 274s/epoch - 48ms/step
Epoch 5/50
5759/5759 - 283s - loss: 3.2259 - accuracy300: 0.4018 - val_loss: 3.4480 - val_accuracy300: 0.3200 - 283s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 285s - loss: 3.2247 - accuracy300: 0.4025 - val_loss: 3.4422 - val_accuracy300: 0.3199 - 285s/epoch - 49ms/step
Epoch 7/50
5759/5759 - 283s - loss: 3.2233 - accuracy300: 0.4034 - val_loss: 3.4355 - val_accuracy300: 0.3199 - 283s/epoch - 49ms/step
Epoch 8/50
5759/5759 - 280s - loss: 3.2215 - accuracy300: 0.4047 - val_loss: 3.4406 - val_accuracy300: 0.3200 - 280s/epoch - 49ms/step
Epoch 9/50
5759/5759 - 281s - loss: 3.2202 - accuracy300: 0.4055 - val_loss: 3.4399 - val_accuracy300: 0.3200 - 281s/epoch - 49ms/step
Epoch 10/50
5759/5759 - 282s - loss: 3.2181 - accuracy300: 0.4070 - val_loss: 3.4410 - val_accuracy300: 0.3200 - 282s/epoch - 49ms/step
Epoch 11/50
5759/5759 - 282s - loss: 3.2166 - accuracy300: 0.4078 - val_loss: 3.4454 - val_accuracy300: 0.3200 - 282s/epoch - 49ms/step
Epoch 12/50
5759/5759 - 283s - loss: 3.2155 - accuracy300: 0.4088 - val_loss: 3.4472 - val_accuracy300: 0.3201 - 283s/epoch - 49ms/step
Epoch 13/50
5759/5759 - 283s - loss: 3.2142 - accuracy300: 0.4093 - val_loss: 3.4508 - val_accuracy300: 0.3200 - 283s/epoch - 49ms/step
Epoch 14/50
5759/5759 - 283s - loss: 3.2127 - accuracy300: 0.4107 - val_loss: 3.4496 - val_accuracy300: 0.3201 - 283s/epoch - 49ms/step
Epoch 15/50
5759/5759 - 274s - loss: 3.2114 - accuracy300: 0.4110 - val_loss: 3.4591 - val_accuracy300: 0.3201 - 274s/epoch - 48ms/step
Epoch 16/50
5759/5759 - 280s - loss: 3.2097 - accuracy300: 0.4121 - val_loss: 3.4556 - val_accuracy300: 0.3200 - 280s/epoch - 49ms/step
Epoch 17/50
5759/5759 - 278s - loss: 3.2085 - accuracy300: 0.4130 - val_loss: 3.4558 - val_accuracy300: 0.3200 - 278s/epoch - 48ms/step
testing model: results/AAPL/W5/deepOF_L1/h300
Evaluating performance on  test set...
31315/31315 - 612s - 612s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2145596
{'0': {'precision': 0.501676245210728, 'recall': 0.0006591903883433743, 'f1-score': 0.0013166507296413273, 'support': 3178141}, '1': {'precision': 0.1980893671434304, 'recall': 0.9994452050222484, 'f1-score': 0.33064509828615246, 'support': 1587974}, '2': {'precision': 0.47, 'recall': 4.337973015961895e-05, 'f1-score': 8.675145339447363e-05, 'support': 3250366}, 'accuracy': 0.19825768937767083, 'macro avg': {'precision': 0.38992187078471946, 'recall': 0.33338259171358375, 'f1-score': 0.11068283348972942, 'support': 8016481}, 'weighted avg': {'precision': 0.42869566189085834, 'recall': 0.19825768937767083, 'f1-score': 0.06605420694528828, 'support': 8016481}}
[[   2095 3175935     111]
 [    833 1587093      48]
 [   1248 3248977     141]]
Evaluating performance on  train set...
5759/5759 - 123s - 123s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1375288
{'0': {'precision': 0.4952100221075903, 'recall': 0.0013734523113649092, 'f1-score': 0.0027393072243113515, 'support': 489278}, '1': {'precision': 0.3303552149663689, 'recall': 0.9991374849059859, 'f1-score': 0.49653567656108877, 'support': 486948}, '2': {'precision': 0.375, 'recall': 5.4222855937904786e-05, 'f1-score': 0.00010843003351291219, 'support': 497945}, 'accuracy': 0.3305091471749207, 'macro avg': {'precision': 0.4001884123579864, 'recall': 0.3335217200244296, 'f1-score': 0.16646113793963768, 'support': 1474171}, 'weighted avg': {'precision': 0.4001506985378229, 'recall': 0.3305091471749207, 'f1-score': 0.16496141192792643, 'support': 1474171}}
[[   672 488581     25]
 [   400 486528     20]
 [   285 497633     27]]
Evaluating performance on  val set...
2129/2129 - 44s - 44s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1467398
{'0': {'precision': 0.4029038112522686, 'recall': 0.001206069463081779, 'f1-score': 0.002404939876503087, 'support': 184069}, '1': {'precision': 0.3198918311183942, 'recall': 0.9988412780359089, 'f1-score': 0.4845880689724266, 'support': 174330}, '2': {'precision': 0.5370370370370371, 'recall': 0.00015546263535970838, 'f1-score': 0.00031083528945196525, 'support': 186540}, 'accuracy': 0.3199972840996882, 'macro avg': {'precision': 0.41994422646923324, 'recall': 0.33340093671145016, 'f1-score': 0.16243461471279388, 'support': 544939}, 'weighted avg': {'precision': 0.4222632871590259, 'recall': 0.3199972840996882, 'f1-score': 0.15594203416710045, 'support': 544939}}
[[   222 183831     16]
 [   193 174128      9]
 [   136 186375     29]]
training model: results/AAPL/W5/deepOF_L1/h500
Epoch 1/50
5759/5759 - 296s - loss: 3.2502 - accuracy500: 0.3878 - val_loss: 3.4001 - val_accuracy500: 0.3025 - 296s/epoch - 51ms/step
Epoch 2/50
5759/5759 - 280s - loss: 3.2495 - accuracy500: 0.3847 - val_loss: 3.3743 - val_accuracy500: 0.3025 - 280s/epoch - 49ms/step
Epoch 3/50
5759/5759 - 284s - loss: 3.2486 - accuracy500: 0.3855 - val_loss: 3.3708 - val_accuracy500: 0.3026 - 284s/epoch - 49ms/step
Epoch 4/50
5759/5759 - 283s - loss: 3.2470 - accuracy500: 0.3867 - val_loss: 3.3700 - val_accuracy500: 0.3025 - 283s/epoch - 49ms/step
Epoch 5/50
5759/5759 - 283s - loss: 3.2452 - accuracy500: 0.3881 - val_loss: 3.3692 - val_accuracy500: 0.3025 - 283s/epoch - 49ms/step
Epoch 6/50
5759/5759 - 281s - loss: 3.2432 - accuracy500: 0.3894 - val_loss: 3.3694 - val_accuracy500: 0.3025 - 281s/epoch - 49ms/step
Epoch 7/50
5759/5759 - 286s - loss: 3.2423 - accuracy500: 0.3907 - val_loss: 3.3721 - val_accuracy500: 0.3026 - 286s/epoch - 50ms/step
Epoch 8/50
5759/5759 - 282s - loss: 3.2407 - accuracy500: 0.3918 - val_loss: 3.3720 - val_accuracy500: 0.3025 - 282s/epoch - 49ms/step
Epoch 9/50
5759/5759 - 285s - loss: 3.2392 - accuracy500: 0.3928 - val_loss: 3.3755 - val_accuracy500: 0.3025 - 285s/epoch - 49ms/step
Epoch 10/50
5759/5759 - 279s - loss: 3.2384 - accuracy500: 0.3937 - val_loss: 3.3780 - val_accuracy500: 0.3025 - 279s/epoch - 48ms/step
Epoch 11/50
5759/5759 - 279s - loss: 3.2372 - accuracy500: 0.3943 - val_loss: 3.3803 - val_accuracy500: 0.3025 - 279s/epoch - 48ms/step
Epoch 12/50
5759/5759 - 285s - loss: 3.2360 - accuracy500: 0.3955 - val_loss: 3.3838 - val_accuracy500: 0.3026 - 285s/epoch - 50ms/step
Epoch 13/50
5759/5759 - 278s - loss: 3.2351 - accuracy500: 0.3962 - val_loss: 3.3854 - val_accuracy500: 0.3026 - 278s/epoch - 48ms/step
Epoch 14/50
5759/5759 - 276s - loss: 3.2341 - accuracy500: 0.3967 - val_loss: 3.3889 - val_accuracy500: 0.3025 - 276s/epoch - 48ms/step
Epoch 15/50
5759/5759 - 281s - loss: 3.2331 - accuracy500: 0.3975 - val_loss: 3.3934 - val_accuracy500: 0.3025 - 281s/epoch - 49ms/step
testing model: results/AAPL/W5/deepOF_L1/h500
Evaluating performance on  test set...
31315/31315 - 605s - 605s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1514701
{'0': {'precision': 0.4843835616438356, 'recall': 0.0005763974377699418, 'f1-score': 0.0011514247252829555, 'support': 3067328}, '1': {'precision': 0.23059077560503213, 'recall': 0.999357304574336, 'f1-score': 0.37471919291868666, 'support': 1848465}, '2': {'precision': 0.4318824194460147, 'recall': 0.00024639692868163454, 'f1-score': 0.0004925128696384834, 'support': 3100688}, 'accuracy': 0.23075074961195566, 'macro avg': {'precision': 0.3822855855649608, 'recall': 0.3333933663135959, 'f1-score': 0.12545437683786936, 'support': 8016481}, 'weighted avg': {'precision': 0.40555636254683863, 'recall': 0.23075074961195566, 'f1-score': 0.08703497694099524, 'support': 8016481}}
[[   1768 3064930     630]
 [    813 1847277     375]
 [   1069 3098855     764]]
Evaluating performance on  train set...
5759/5759 - 121s - 121s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155516
{'0': {'precision': 0.44638602065131056, 'recall': 0.001137400856895948, 'f1-score': 0.002269020203162094, 'support': 494109}, '1': {'precision': 0.32768450985838776, 'recall': 0.9989151295943951, 'f1-score': 0.49348575847086645, 'support': 483007}, '2': {'precision': 0.42661448140900193, 'recall': 0.0004385832553741538, 'f1-score': 0.000876265661238911, 'support': 497055}, 'accuracy': 0.3278201782561182, 'macro avg': {'precision': 0.4002283373062334, 'recall': 0.33349703790222174, 'f1-score': 0.16554368144508916, 'support': 1474171}, 'weighted avg': {'precision': 0.40082739613512963, 'recall': 0.3278201782561182, 'f1-score': 0.1627448723883112, 'support': 1474171}}
[[   562 493400    147]
 [   378 482483    146]
 [   319 496518    218]]
Evaluating performance on  val set...
2129/2129 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1256286
{'0': {'precision': 0.42771084337349397, 'recall': 0.0011287758346581877, 'f1-score': 0.0022516094250467768, 'support': 188700}, '1': {'precision': 0.3023639554220299, 'recall': 0.9985920877760449, 'f1-score': 0.4641790244824386, 'support': 164783}, '2': {'precision': 0.4026548672566372, 'recall': 0.00047530503092094265, 'f1-score': 0.0009494892582506442, 'support': 191456}, 'accuracy': 0.302520098579841, 'macro avg': {'precision': 0.3775765553507204, 'recall': 0.33339872288054134, 'f1-score': 0.15579337438857868, 'support': 544939}, 'weighted avg': {'precision': 0.3810044171482925, 'recall': 0.302520098579841, 'f1-score': 0.14147542441488611, 'support': 544939}}
[[   213 188419     68]
 [   165 164551     67]
 [   120 191245     91]]
training model: results/AAPL/W5/deepOF_L1/h1000
Epoch 1/50
5759/5759 - 290s - loss: 3.2593 - accuracy1000: 0.3800 - val_loss: 3.3633 - val_accuracy1000: 0.2992 - 290s/epoch - 50ms/step
Epoch 2/50
5759/5759 - 282s - loss: 3.2595 - accuracy1000: 0.3750 - val_loss: 3.3490 - val_accuracy1000: 0.2992 - 282s/epoch - 49ms/step
Epoch 3/50
5759/5759 - 284s - loss: 3.2585 - accuracy1000: 0.3764 - val_loss: 3.3452 - val_accuracy1000: 0.2992 - 284s/epoch - 49ms/step
Epoch 4/50
5759/5759 - 279s - loss: 3.2571 - accuracy1000: 0.3774 - val_loss: 3.3464 - val_accuracy1000: 0.2992 - 279s/epoch - 48ms/step
Epoch 5/50
5759/5759 - 277s - loss: 3.2555 - accuracy1000: 0.3792 - val_loss: 3.3487 - val_accuracy1000: 0.2991 - 277s/epoch - 48ms/step
Epoch 6/50
5759/5759 - 276s - loss: 3.2543 - accuracy1000: 0.3802 - val_loss: 3.3496 - val_accuracy1000: 0.2991 - 276s/epoch - 48ms/step
Epoch 7/50
5759/5759 - 276s - loss: 3.2532 - accuracy1000: 0.3813 - val_loss: 3.3522 - val_accuracy1000: 0.2992 - 276s/epoch - 48ms/step
Epoch 8/50
5759/5759 - 271s - loss: 3.2516 - accuracy1000: 0.3825 - val_loss: 3.3540 - val_accuracy1000: 0.2991 - 271s/epoch - 47ms/step
Epoch 9/50
5759/5759 - 276s - loss: 3.2506 - accuracy1000: 0.3829 - val_loss: 3.3512 - val_accuracy1000: 0.2991 - 276s/epoch - 48ms/step
Epoch 10/50
5759/5759 - 275s - loss: 3.2492 - accuracy1000: 0.3841 - val_loss: 3.3505 - val_accuracy1000: 0.2992 - 275s/epoch - 48ms/step
Epoch 11/50
5759/5759 - 275s - loss: 3.2485 - accuracy1000: 0.3846 - val_loss: 3.3481 - val_accuracy1000: 0.2992 - 275s/epoch - 48ms/step
Epoch 12/50
5759/5759 - 272s - loss: 3.2470 - accuracy1000: 0.3857 - val_loss: 3.3548 - val_accuracy1000: 0.2991 - 272s/epoch - 47ms/step
Epoch 13/50
5759/5759 - 274s - loss: 3.2462 - accuracy1000: 0.3863 - val_loss: 3.3556 - val_accuracy1000: 0.2991 - 274s/epoch - 48ms/step
testing model: results/AAPL/W5/deepOF_L1/h1000
Evaluating performance on  test set...
31315/31315 - 590s - 590s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1444131
{'0': {'precision': 0.41718946047678795, 'recall': 0.00021504972984579804, 'f1-score': 0.0004298778694347785, 'support': 3092308}, '1': {'precision': 0.2274589864710799, 'recall': 0.9995541142421834, 'f1-score': 0.37058702244721264, 'support': 1823337}, '2': {'precision': 0.43185689948892675, 'recall': 0.00032700858736160184, 'f1-score': 0.0006535223177227004, 'support': 3100836}, 'accuracy': 0.2275565800006262, 'macro avg': {'precision': 0.35883511547893154, 'recall': 0.3333653908531303, 'f1-score': 0.12389014087812338, 'support': 8016481}, 'weighted avg': {'precision': 0.3797090160816099, 'recall': 0.2275565800006262, 'f1-score': 0.08470809199848504, 'support': 8016481}}
[[    665 3090769     874]
 [    353 1822524     460]
 [    576 3099246    1014]]
Evaluating performance on  train set...
5759/5759 - 109s - 109s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1155648
{'0': {'precision': 0.3558282208588957, 'recall': 0.0003443069635093982, 'f1-score': 0.0006879482536394044, 'support': 505363}, '1': {'precision': 0.31991138662812807, 'recall': 0.9989057920920152, 'f1-score': 0.4846180990289285, 'support': 471574}, '2': {'precision': 0.3891625615763547, 'recall': 0.0009532735090520761, 'f1-score': 0.001901888246009646, 'support': 497234}, 'accuracy': 0.31998051786393844, 'macro avg': {'precision': 0.3549673896877928, 'recall': 0.33340112418819223, 'f1-score': 0.1624026451761925, 'support': 1474171}, 'weighted avg': {'precision': 0.35558233512838344, 'recall': 0.31998051786393844, 'f1-score': 0.15590229527299634, 'support': 1474171}}
[[   174 504803    386]
 [   158 471058    358]
 [   157 496603    474]]
Evaluating performance on  val set...
2129/2129 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1207637
{'0': {'precision': 0.3619047619047619, 'recall': 0.00040528577980183657, 'f1-score': 0.0008096648413696121, 'support': 187522}, '1': {'precision': 0.2990130333973918, 'recall': 0.9988645848676782, 'f1-score': 0.46024914101494563, 'support': 162936}, '2': {'precision': 0.37471264367816093, 'recall': 0.0008381281461942297, 'f1-score': 0.001672515339941308, 'support': 194481}, 'accuracy': 0.2990976971734451, 'macro avg': {'precision': 0.34521014632677155, 'recall': 0.3333693329312248, 'f1-score': 0.1542437737320855, 'support': 544939}, 'weighted avg': {'precision': 0.34767117425384236, 'recall': 0.2990976971734451, 'f1-score': 0.13848936572097362, 'support': 544939}}
[[    76 187301    145]
 [    58 162751    127]
 [    76 194242    163]]
training model: results/AAPL/W5/deepLOB_L2/h10
Epoch 1/50
5759/5759 - 561s - loss: 3.0184 - accuracy10: 0.4663 - val_loss: 3.3626 - val_accuracy10: 0.3934 - 561s/epoch - 97ms/step
Epoch 2/50
5759/5759 - 543s - loss: 2.9399 - accuracy10: 0.4921 - val_loss: 3.3344 - val_accuracy10: 0.4218 - 543s/epoch - 94ms/step
Epoch 3/50
5759/5759 - 543s - loss: 2.8848 - accuracy10: 0.5070 - val_loss: 3.2494 - val_accuracy10: 0.4517 - 543s/epoch - 94ms/step
Epoch 4/50
5759/5759 - 544s - loss: 2.8409 - accuracy10: 0.5206 - val_loss: 3.2133 - val_accuracy10: 0.4696 - 544s/epoch - 95ms/step
Epoch 5/50
5759/5759 - 536s - loss: 2.8105 - accuracy10: 0.5298 - val_loss: 3.2155 - val_accuracy10: 0.4759 - 536s/epoch - 93ms/step
Epoch 6/50
5759/5759 - 554s - loss: 2.7907 - accuracy10: 0.5346 - val_loss: 3.2111 - val_accuracy10: 0.4766 - 554s/epoch - 96ms/step
Epoch 7/50
5759/5759 - 546s - loss: 2.7735 - accuracy10: 0.5389 - val_loss: 3.2135 - val_accuracy10: 0.4753 - 546s/epoch - 95ms/step
Epoch 8/50
5759/5759 - 542s - loss: 2.7610 - accuracy10: 0.5415 - val_loss: 3.1847 - val_accuracy10: 0.4842 - 542s/epoch - 94ms/step
Epoch 9/50
5759/5759 - 538s - loss: 2.7503 - accuracy10: 0.5439 - val_loss: 3.2066 - val_accuracy10: 0.4813 - 538s/epoch - 93ms/step
Epoch 10/50
5759/5759 - 523s - loss: 2.7410 - accuracy10: 0.5462 - val_loss: 3.1924 - val_accuracy10: 0.4850 - 523s/epoch - 91ms/step
Epoch 11/50
5759/5759 - 539s - loss: 2.7342 - accuracy10: 0.5475 - val_loss: 3.2034 - val_accuracy10: 0.4826 - 539s/epoch - 94ms/step
Epoch 12/50
5759/5759 - 525s - loss: 2.7282 - accuracy10: 0.5492 - val_loss: 3.2210 - val_accuracy10: 0.4842 - 525s/epoch - 91ms/step
Epoch 13/50
5759/5759 - 531s - loss: 2.7217 - accuracy10: 0.5507 - val_loss: 3.2133 - val_accuracy10: 0.4864 - 531s/epoch - 92ms/step
Epoch 14/50
5759/5759 - 535s - loss: 2.7165 - accuracy10: 0.5517 - val_loss: 3.2251 - val_accuracy10: 0.4848 - 535s/epoch - 93ms/step
Epoch 15/50
5759/5759 - 531s - loss: 2.7115 - accuracy10: 0.5531 - val_loss: 3.2382 - val_accuracy10: 0.4841 - 531s/epoch - 92ms/step
Epoch 16/50
5759/5759 - 536s - loss: 2.7075 - accuracy10: 0.5541 - val_loss: 3.2491 - val_accuracy10: 0.4824 - 536s/epoch - 93ms/step
Epoch 17/50
5759/5759 - 532s - loss: 2.7044 - accuracy10: 0.5546 - val_loss: 3.2209 - val_accuracy10: 0.4870 - 532s/epoch - 92ms/step
Epoch 18/50
5759/5759 - 534s - loss: 2.6997 - accuracy10: 0.5559 - val_loss: 3.2680 - val_accuracy10: 0.4812 - 534s/epoch - 93ms/step
testing model: results/AAPL/W5/deepLOB_L2/h10
Evaluating performance on  test set...
31315/31315 - 1315s - 1315s/epoch - 42ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0920423
{'0': {'precision': 0.5090429111966703, 'recall': 0.1788691979661839, 'f1-score': 0.2647201467842294, 'support': 2828771}, '1': {'precision': 0.35678453305408814, 'recall': 0.5002746103092623, 'f1-score': 0.41651791389228565, 'support': 2325113}, '2': {'precision': 0.4483728775537001, 'recall': 0.5892914907486266, 'f1-score': 0.5092635528328932, 'support': 2862602}, 'accuracy': 0.4186475221187937, 'macro avg': {'precision': 0.4380667739348196, 'recall': 0.4228117663413576, 'f1-score': 0.39683387116980273, 'support': 8016486}, 'weighted avg': {'precision': 0.44321705008686896, 'recall': 0.4186475221187937, 'f1-score': 0.39607163980943155, 'support': 8016486}}
[[ 505980 1154039 1168752]
 [ 255291 1163195  906627]
 [ 232712  942983 1686907]]
Evaluating performance on  train set...
5759/5759 - 260s - 260s/epoch - 45ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9975142
{'0': {'precision': 0.5079947797163993, 'recall': 0.3760884755318893, 'f1-score': 0.4322013365767078, 'support': 415030}, '1': {'precision': 0.5478679258157836, 'recall': 0.5379256724752574, 'f1-score': 0.5428512801805704, 'support': 641808}, '2': {'precision': 0.4126014442531691, 'recall': 0.5306612928733341, 'f1-score': 0.4642431153716347, 'support': 417334}, 'accuracy': 0.49030642285974774, 'macro avg': {'precision': 0.48948804992845063, 'recall': 0.4815584802934936, 'f1-score': 0.47976524404297094, 'support': 1474172}, 'weighted avg': {'precision': 0.49834870170755224, 'recall': 0.49030642285974774, 'f1-score': 0.4894457712261991, 'support': 1474172}}
[[156088 149849 109093]
 [ 90371 345245 206192]
 [ 60804 135067 221463]]
Evaluating performance on  val set...
2129/2129 - 90s - 90s/epoch - 42ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0131079
{'0': {'precision': 0.5004227632955474, 'recall': 0.41157438783628486, 'f1-score': 0.45167069262683385, 'support': 169685}, '1': {'precision': 0.5072883043746995, 'recall': 0.570911005589021, 'f1-score': 0.5372225214721277, 'support': 207013}, '2': {'precision': 0.4394336624015405, 'recall': 0.4503096729710774, 'f1-score': 0.44480519480519487, 'support': 168242}, 'accuracy': 0.4840624655925423, 'macro avg': {'precision': 0.4823815766905957, 'recall': 0.47759835546546103, 'f1-score': 0.4778994696347188, 'support': 544940}, 'weighted avg': {'precision': 0.48420139570059934, 'recall': 0.4840624655925423, 'f1-score': 0.4820506898012799, 'support': 544940}}
[[ 69838  56159  43688]
 [ 35870 118186  52957]
 [ 33850  58631  75761]]
training model: results/AAPL/W5/deepLOB_L2/h20
Epoch 1/50
5759/5759 - 546s - loss: 3.0766 - accuracy20: 0.4520 - val_loss: 3.3639 - val_accuracy20: 0.3880 - 546s/epoch - 95ms/step
Epoch 2/50
5759/5759 - 550s - loss: 3.0183 - accuracy20: 0.4773 - val_loss: 3.2733 - val_accuracy20: 0.4027 - 550s/epoch - 95ms/step
Epoch 3/50
5759/5759 - 539s - loss: 2.9763 - accuracy20: 0.4917 - val_loss: 3.2041 - val_accuracy20: 0.4412 - 539s/epoch - 94ms/step
Epoch 4/50
5759/5759 - 528s - loss: 2.9450 - accuracy20: 0.5014 - val_loss: 3.2166 - val_accuracy20: 0.4318 - 528s/epoch - 92ms/step
Epoch 5/50
5759/5759 - 530s - loss: 2.9189 - accuracy20: 0.5090 - val_loss: 3.2445 - val_accuracy20: 0.4268 - 530s/epoch - 92ms/step
Epoch 6/50
5759/5759 - 538s - loss: 2.8936 - accuracy20: 0.5167 - val_loss: 3.3260 - val_accuracy20: 0.3991 - 538s/epoch - 93ms/step
Epoch 7/50
5759/5759 - 529s - loss: 2.8775 - accuracy20: 0.5209 - val_loss: 3.2890 - val_accuracy20: 0.4238 - 529s/epoch - 92ms/step
Epoch 8/50
5759/5759 - 531s - loss: 2.8663 - accuracy20: 0.5242 - val_loss: 3.3349 - val_accuracy20: 0.4107 - 531s/epoch - 92ms/step
Epoch 9/50
5759/5759 - 538s - loss: 2.8548 - accuracy20: 0.5273 - val_loss: 3.3478 - val_accuracy20: 0.4212 - 538s/epoch - 93ms/step
Epoch 10/50
5759/5759 - 535s - loss: 2.8460 - accuracy20: 0.5296 - val_loss: 3.2751 - val_accuracy20: 0.4212 - 535s/epoch - 93ms/step
Epoch 11/50
5759/5759 - 534s - loss: 2.8396 - accuracy20: 0.5311 - val_loss: 3.3018 - val_accuracy20: 0.4105 - 534s/epoch - 93ms/step
Epoch 12/50
5759/5759 - 538s - loss: 2.8342 - accuracy20: 0.5322 - val_loss: 3.3060 - val_accuracy20: 0.4173 - 538s/epoch - 93ms/step
Epoch 13/50
5759/5759 - 540s - loss: 2.8284 - accuracy20: 0.5337 - val_loss: 3.2895 - val_accuracy20: 0.4187 - 540s/epoch - 94ms/step
testing model: results/AAPL/W5/deepLOB_L2/h20
Evaluating performance on  test set...
31315/31315 - 1363s - 1363s/epoch - 44ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631329
{'0': {'precision': 0.48078717762350953, 'recall': 0.45137373450853596, 'f1-score': 0.4656163995793058, 'support': 3137615}, '1': {'precision': 0.278673187632497, 'recall': 0.138337625192421, 'f1-score': 0.18489202580014258, 'support': 1683808}, '2': {'precision': 0.4584013289397408, 'recall': 0.6075964699287619, 'f1-score': 0.5225583571937511, 'support': 3195063}, 'accuracy': 0.44788701683006743, 'macro avg': {'precision': 0.4059538980652491, 'recall': 0.3991026098765729, 'f1-score': 0.3910222608577332, 'support': 8016486}, 'weighted avg': {'precision': 0.42941237947480754, 'recall': 0.44788701683006743, 'f1-score': 0.42934704110442506, 'support': 8016486}}
[[1416237  312842 1408536]
 [ 565764  232934  885110]
 [ 963662  290092 1941309]]
Evaluating performance on  train set...
5759/5759 - 236s - 236s/epoch - 41ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0534939
{'0': {'precision': 0.47610597784470876, 'recall': 0.4782093274620517, 'f1-score': 0.47715533471947086, 'support': 487571}, '1': {'precision': 0.4275186955745542, 'recall': 0.43327878607557274, 'f1-score': 0.43037946878762884, 'support': 497428}, '2': {'precision': 0.4411544875571758, 'recall': 0.4331678158851776, 'f1-score': 0.43712467379756365, 'support': 489173}, 'accuracy': 0.4481023923938319, 'macro avg': {'precision': 0.4482597203254796, 'recall': 0.44821864314093407, 'f1-score': 0.4482198257682211, 'support': 1474172}, 'weighted avg': {'precision': 0.4481133148423577, 'recall': 0.4481023923938319, 'f1-score': 0.4480884796076546, 'support': 1474172}}
[[233161 140645 113765]
 [127245 215525 154658]
 [129319 147960 211894]]
Evaluating performance on  val set...
2129/2129 - 86s - 86s/epoch - 40ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06632
{'0': {'precision': 0.46847309818578214, 'recall': 0.46874318302221946, 'f1-score': 0.4686081016877867, 'support': 192534}, '1': {'precision': 0.389653291462538, 'recall': 0.47776624870297907, 'f1-score': 0.4292344885873853, 'support': 159982}, '2': {'precision': 0.47313239739714097, 'recall': 0.3839074127967405, 'f1-score': 0.423875372963048, 'support': 192424}, 'accuracy': 0.4414357543949793, 'macro avg': {'precision': 0.4437529290151538, 'recall': 0.44347228150731305, 'f1-score': 0.44057265441273996, 'support': 544940}, 'weighted avg': {'precision': 0.4469786413139219, 'recall': 0.4414357543949793, 'f1-score': 0.4412533104022185, 'support': 544940}}
[[90249 58132 44153]
 [45438 76434 38110]
 [56958 61593 73873]]
training model: results/AAPL/W5/deepLOB_L2/h30
Epoch 1/50
5759/5759 - 568s - loss: 3.1245 - accuracy30: 0.4403 - val_loss: 3.3753 - val_accuracy30: 0.3098 - 568s/epoch - 99ms/step
Epoch 2/50
5759/5759 - 559s - loss: 3.0766 - accuracy30: 0.4602 - val_loss: 3.3797 - val_accuracy30: 0.3221 - 559s/epoch - 97ms/step
Epoch 3/50
5759/5759 - 542s - loss: 3.0484 - accuracy30: 0.4709 - val_loss: 3.3941 - val_accuracy30: 0.3106 - 542s/epoch - 94ms/step
Epoch 4/50
5759/5759 - 533s - loss: 3.0241 - accuracy30: 0.4789 - val_loss: 3.4859 - val_accuracy30: 0.3090 - 533s/epoch - 93ms/step
Epoch 5/50
5759/5759 - 537s - loss: 3.0001 - accuracy30: 0.4879 - val_loss: 3.4882 - val_accuracy30: 0.3159 - 537s/epoch - 93ms/step
Epoch 6/50
5759/5759 - 540s - loss: 2.9791 - accuracy30: 0.4947 - val_loss: 3.3207 - val_accuracy30: 0.3359 - 540s/epoch - 94ms/step
Epoch 7/50
5759/5759 - 540s - loss: 2.9656 - accuracy30: 0.4989 - val_loss: 3.3161 - val_accuracy30: 0.3420 - 540s/epoch - 94ms/step
Epoch 8/50
5759/5759 - 537s - loss: 2.9564 - accuracy30: 0.5018 - val_loss: 3.3221 - val_accuracy30: 0.3589 - 537s/epoch - 93ms/step
Epoch 9/50
5759/5759 - 537s - loss: 2.9496 - accuracy30: 0.5037 - val_loss: 3.3474 - val_accuracy30: 0.3588 - 537s/epoch - 93ms/step
Epoch 10/50
5759/5759 - 531s - loss: 2.9439 - accuracy30: 0.5050 - val_loss: 3.3569 - val_accuracy30: 0.3547 - 531s/epoch - 92ms/step
Epoch 11/50
5759/5759 - 534s - loss: 2.9384 - accuracy30: 0.5068 - val_loss: 3.3478 - val_accuracy30: 0.3533 - 534s/epoch - 93ms/step
Epoch 12/50
5759/5759 - 539s - loss: 2.9337 - accuracy30: 0.5080 - val_loss: 3.3696 - val_accuracy30: 0.3550 - 539s/epoch - 94ms/step
Epoch 13/50
5759/5759 - 540s - loss: 2.9301 - accuracy30: 0.5093 - val_loss: 3.4231 - val_accuracy30: 0.3480 - 540s/epoch - 94ms/step
Epoch 14/50
5759/5759 - 537s - loss: 2.9266 - accuracy30: 0.5101 - val_loss: 3.4415 - val_accuracy30: 0.3515 - 537s/epoch - 93ms/step
Epoch 15/50
5759/5759 - 534s - loss: 2.9234 - accuracy30: 0.5110 - val_loss: 3.4506 - val_accuracy30: 0.3535 - 534s/epoch - 93ms/step
Epoch 16/50
5759/5759 - 547s - loss: 2.9198 - accuracy30: 0.5119 - val_loss: 3.4363 - val_accuracy30: 0.3581 - 547s/epoch - 95ms/step
Epoch 17/50
5759/5759 - 547s - loss: 2.9177 - accuracy30: 0.5126 - val_loss: 3.4871 - val_accuracy30: 0.3661 - 547s/epoch - 95ms/step
testing model: results/AAPL/W5/deepLOB_L2/h30
Evaluating performance on  test set...
31315/31315 - 1362s - 1362s/epoch - 43ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2039068
{'0': {'precision': 0.520867401350871, 'recall': 0.016514293258966094, 'f1-score': 0.032013584017554345, 'support': 3105310}, '1': {'precision': 0.21862274092273268, 'recall': 0.8371246561526295, 'f1-score': 0.34670127973618664, 'support': 1731146}, '2': {'precision': 0.47340050522403515, 'recall': 0.191938126369877, 'f1-score': 0.27313491711003746, 'support': 3180030}, 'accuracy': 0.263311880043201, 'macro avg': {'precision': 0.404296882499213, 'recall': 0.34852569192715754, 'f1-score': 0.21728326028792613, 'support': 8016486}, 'weighted avg': {'precision': 0.4367687341029332, 'recall': 0.263311880043201, 'f1-score': 0.19561936073401298, 'support': 8016486}}
[[  51282 2635314  418714]
 [  21715 1449185  260246]
 [  25458 2544203  610369]]
Evaluating performance on  train set...
5759/5759 - 254s - 254s/epoch - 44ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0963837
{'0': {'precision': 0.5162472271635211, 'recall': 0.14713855178320379, 'f1-score': 0.22900662563957463, 'support': 495064}, '1': {'precision': 0.3576028587462265, 'recall': 0.7895834965507857, 'f1-score': 0.4922605891913673, 'support': 485038}, '2': {'precision': 0.4775286900256379, 'recall': 0.25333657174084645, 'f1-score': 0.33104728755775725, 'support': 494070}, 'accuracy': 0.3941107279204869, 'macro avg': {'precision': 0.4504595919784618, 'recall': 0.396686206691612, 'f1-score': 0.35077150079623304, 'support': 1474172}, 'weighted avg': {'precision': 0.4510728683966325, 'recall': 0.3941107279204869, 'f1-score': 0.34982251809116843, 'support': 1474172}}
[[ 72843 357660  64561]
 [ 29675 382978  72385]
 [ 38583 330321 125166]]
Evaluating performance on  val set...
2129/2129 - 92s - 92s/epoch - 43ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1082588
{'0': {'precision': 0.495906007751938, 'recall': 0.1069556994101266, 'f1-score': 0.17596066650335015, 'support': 191397}, '1': {'precision': 0.3082236416306235, 'recall': 0.8570675007291841, 'f1-score': 0.45339478967126445, 'support': 161139}, '2': {'precision': 0.4975353506278559, 'recall': 0.1437392154009272, 'f1-score': 0.22304125166337352, 'support': 192404}, 'accuracy': 0.3417513854736301, 'macro avg': {'precision': 0.43388833333680576, 'recall': 0.36925413851341266, 'f1-score': 0.28413223594599607, 'support': 544940}, 'weighted avg': {'precision': 0.44098352691418635, 'recall': 0.3417513854736301, 'f1-score': 0.2746209778775999, 'support': 544940}}
[[ 20471 156439  14487]
 [  9589 138107  13443]
 [ 11220 153528  27656]]
training model: results/AAPL/W5/deepLOB_L2/h50
Epoch 1/50
5759/5759 - 557s - loss: 3.1856 - accuracy50: 0.4178 - val_loss: 3.3754 - val_accuracy50: 0.3081 - 557s/epoch - 97ms/step
Epoch 2/50
5759/5759 - 552s - loss: 3.1608 - accuracy50: 0.4310 - val_loss: 3.4554 - val_accuracy50: 0.3115 - 552s/epoch - 96ms/step
Epoch 3/50
5759/5759 - 550s - loss: 3.1461 - accuracy50: 0.4380 - val_loss: 3.3808 - val_accuracy50: 0.3109 - 550s/epoch - 96ms/step
Epoch 4/50
5759/5759 - 544s - loss: 3.1351 - accuracy50: 0.4422 - val_loss: 3.4015 - val_accuracy50: 0.3119 - 544s/epoch - 94ms/step
Epoch 5/50
5759/5759 - 544s - loss: 3.1265 - accuracy50: 0.4460 - val_loss: 3.4252 - val_accuracy50: 0.3108 - 544s/epoch - 94ms/step
Epoch 6/50
5759/5759 - 536s - loss: 3.1197 - accuracy50: 0.4480 - val_loss: 3.4246 - val_accuracy50: 0.3121 - 536s/epoch - 93ms/step
Epoch 7/50
5759/5759 - 531s - loss: 3.1134 - accuracy50: 0.4507 - val_loss: 3.4263 - val_accuracy50: 0.3133 - 531s/epoch - 92ms/step
Epoch 8/50
5759/5759 - 531s - loss: 3.1080 - accuracy50: 0.4522 - val_loss: 3.4193 - val_accuracy50: 0.3122 - 531s/epoch - 92ms/step
Epoch 9/50
5759/5759 - 536s - loss: 3.1026 - accuracy50: 0.4543 - val_loss: 3.4320 - val_accuracy50: 0.3126 - 536s/epoch - 93ms/step
Epoch 10/50
5759/5759 - 525s - loss: 3.0985 - accuracy50: 0.4562 - val_loss: 3.4160 - val_accuracy50: 0.3169 - 525s/epoch - 91ms/step
Epoch 11/50
5759/5759 - 528s - loss: 3.0947 - accuracy50: 0.4578 - val_loss: 3.4300 - val_accuracy50: 0.3175 - 528s/epoch - 92ms/step
testing model: results/AAPL/W5/deepLOB_L2/h50
Evaluating performance on  test set...
31315/31315 - 1290s - 1290s/epoch - 41ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1713997
{'0': {'precision': 0.5203586848223182, 'recall': 0.002558034969389458, 'f1-score': 0.005091042844953246, 'support': 3062507}, '1': {'precision': 0.22450391578519122, 'recall': 0.9787343714146676, 'f1-score': 0.36523056361096884, 'support': 1804226}, '2': {'precision': 0.501277322555234, 'recall': 0.02161725062250913, 'f1-score': 0.04144712172934857, 'support': 3149753}, 'accuracy': 0.22974916939916068, 'macro avg': {'precision': 0.4153799743875812, 'recall': 0.3343032190021887, 'f1-score': 0.13725624272842354, 'support': 8016486}, 'weighted avg': {'precision': 0.4462750471080361, 'recall': 0.22974916939916068, 'f1-score': 0.1004302919283978, 'support': 8016486}}
[[   7834 3021455   33218]
 [   3844 1765858   34524]
 [   3377 3078287   68089]]
Evaluating performance on  train set...
5759/5759 - 239s - 239s/epoch - 42ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1159894
{'0': {'precision': 0.4076725156696435, 'recall': 0.10948670511406665, 'f1-score': 0.17261500409329225, 'support': 497823}, '1': {'precision': 0.3273083823657401, 'recall': 0.8568173837432904, 'f1-score': 0.47367183433121857, 'support': 478424}, '2': {'precision': 0.45185134720850223, 'recall': 0.07992167495104685, 'f1-score': 0.13582003972723364, 'support': 497925}, 'accuracy': 0.34203742846831986, 'macro avg': {'precision': 0.39561074841462857, 'recall': 0.34874192126946796, 'f1-score': 0.26070229271724815, 'support': 1474172}, 'weighted avg': {'precision': 0.396513447787605, 'recall': 0.34203742846831986, 'f1-score': 0.2578911321962408, 'support': 1474172}}
[[ 54505 425485  17833]
 [ 38059 409922  30443]
 [ 41134 416996  39795]]
Evaluating performance on  val set...
2129/2129 - 88s - 88s/epoch - 41ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1298177
{'0': {'precision': 0.418312833892409, 'recall': 0.03576873024725785, 'f1-score': 0.06590234044323091, 'support': 188265}, '1': {'precision': 0.30041650889814464, 'recall': 0.9352738483859268, 'f1-score': 0.45476069751548687, 'support': 165420}, '2': {'precision': 0.461688452372355, 'recall': 0.03342657708295208, 'f1-score': 0.06233971389845053, 'support': 191255}, 'accuracy': 0.3079972107020956, 'macro avg': {'precision': 0.3934725983876362, 'recall': 0.3348230519053789, 'f1-score': 0.1943342506190561, 'support': 544940}, 'weighted avg': {'precision': 0.39774798974778913, 'recall': 0.3079972107020956, 'f1-score': 0.1826924077663685, 'support': 544940}}
[[  6734 178787   2744]
 [  5997 154713   4710]
 [  3367 181495   6393]]
training model: results/AAPL/W5/deepLOB_L2/h100
Epoch 1/50
5759/5759 - 529s - loss: 3.1913 - accuracy100: 0.4148 - val_loss: 3.4403 - val_accuracy100: 0.2994 - 529s/epoch - 92ms/step
Epoch 2/50
5759/5759 - 534s - loss: 3.1698 - accuracy100: 0.4251 - val_loss: 3.4832 - val_accuracy100: 0.2973 - 534s/epoch - 93ms/step
Epoch 3/50
5759/5759 - 513s - loss: 3.1604 - accuracy100: 0.4309 - val_loss: 3.5167 - val_accuracy100: 0.3024 - 513s/epoch - 89ms/step
Epoch 4/50
5759/5759 - 511s - loss: 3.1547 - accuracy100: 0.4336 - val_loss: 3.4741 - val_accuracy100: 0.3022 - 511s/epoch - 89ms/step
Epoch 5/50
5759/5759 - 530s - loss: 3.1493 - accuracy100: 0.4362 - val_loss: 3.4712 - val_accuracy100: 0.3022 - 530s/epoch - 92ms/step
Epoch 6/50
5759/5759 - 536s - loss: 3.1450 - accuracy100: 0.4378 - val_loss: 3.4910 - val_accuracy100: 0.3014 - 536s/epoch - 93ms/step
Epoch 7/50
5759/5759 - 531s - loss: 3.1417 - accuracy100: 0.4390 - val_loss: 3.5217 - val_accuracy100: 0.3018 - 531s/epoch - 92ms/step
Epoch 8/50
5759/5759 - 526s - loss: 3.1382 - accuracy100: 0.4406 - val_loss: 3.4778 - val_accuracy100: 0.3016 - 526s/epoch - 91ms/step
Epoch 9/50
5759/5759 - 537s - loss: 3.1349 - accuracy100: 0.4418 - val_loss: 3.4851 - val_accuracy100: 0.2999 - 537s/epoch - 93ms/step
Epoch 10/50
5759/5759 - 534s - loss: 3.1325 - accuracy100: 0.4430 - val_loss: 3.5065 - val_accuracy100: 0.3028 - 534s/epoch - 93ms/step
Epoch 11/50
5759/5759 - 525s - loss: 3.1302 - accuracy100: 0.4437 - val_loss: 3.5334 - val_accuracy100: 0.3099 - 525s/epoch - 91ms/step
testing model: results/AAPL/W5/deepLOB_L2/h100
Evaluating performance on  test set...
31315/31315 - 1311s - 1311s/epoch - 42ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2237701
{'0': {'precision': 0.4362934362934363, 'recall': 3.404458394354986e-05, 'f1-score': 6.808385520913793e-05, 'support': 3319177}, '1': {'precision': 0.1592042091614243, 'recall': 0.9996905213344407, 'f1-score': 0.274666774586373, 'support': 1276340}, '2': {'precision': 0.4593329432416618, 'recall': 0.00022946714805074234, 'f1-score': 0.0004587051425813354, 'support': 3420969}, 'accuracy': 0.15927714462421566, 'macro avg': {'precision': 0.3516101962321741, 'recall': 0.333318011022145, 'f1-score': 0.09173118786138783, 'support': 8016486}, 'weighted avg': {'precision': 0.4020087603004253, 'recall': 0.15927714462421566, 'f1-score': 0.04395484374509781, 'support': 8016486}}
[[    113 3318492     572]
 [     43 1275945     352]
 [    103 3420081     785]]
Evaluating performance on  train set...
5759/5759 - 254s - 254s/epoch - 44ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1385896
{'0': {'precision': 0.36445309771600193, 'recall': 0.08488404014112431, 'f1-score': 0.13769728237294676, 'support': 491765}, '1': {'precision': 0.33155878933510263, 'recall': 0.9121066370680972, 'f1-score': 0.48633171898237804, 'support': 486510}, '2': {'precision': 0.3880737396538751, 'recall': 0.01664055237277096, 'f1-score': 0.03191269256575805, 'support': 495897}, 'accuracy': 0.3349297096946625, 'macro avg': {'precision': 0.36136187556832655, 'recall': 0.33787707652733084, 'f1-score': 0.2186472313070276, 'support': 1474172}, 'weighted avg': {'precision': 0.36154298648384864, 'recall': 0.3349297096946625, 'f1-score': 0.21716960922709874, 'support': 1474172}}
[[ 41743 445292   4730]
 [ 34479 443749   8282]
 [ 38314 449331   8252]]
Evaluating performance on  val set...
2129/2129 - 92s - 92s/epoch - 43ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1489731
{'0': {'precision': 0.32438455008488964, 'recall': 0.03256475400667913, 'f1-score': 0.059187693916174976, 'support': 187749}, '1': {'precision': 0.29757399162492876, 'recall': 0.9400101800906513, 'f1-score': 0.4520461522546504, 'support': 165028}, '2': {'precision': 0.37884173113108927, 'recall': 0.009429494751851293, 'f1-score': 0.01840098301057143, 'support': 192163}, 'accuracy': 0.2992145924321944, 'macro avg': {'precision': 0.3336000909469692, 'recall': 0.3273348096163939, 'f1-score': 0.17654494306046561, 'support': 544940}, 'weighted avg': {'precision': 0.33546863721347336, 'recall': 0.2992145924321944, 'f1-score': 0.1637770962997923, 'support': 544940}}
[[  6114 180509   1126]
 [  8055 155128   1845]
 [  4679 185672   1812]]
training model: results/AAPL/W5/deepLOB_L2/h200
Epoch 1/50
5759/5759 - 549s - loss: 3.2295 - accuracy200: 0.4006 - val_loss: 3.3756 - val_accuracy200: 0.3078 - 549s/epoch - 95ms/step
Epoch 2/50
5759/5759 - 534s - loss: 3.2078 - accuracy200: 0.4134 - val_loss: 3.3954 - val_accuracy200: 0.3111 - 534s/epoch - 93ms/step
Epoch 3/50
5759/5759 - 535s - loss: 3.1990 - accuracy200: 0.4189 - val_loss: 3.4044 - val_accuracy200: 0.3113 - 535s/epoch - 93ms/step
Epoch 4/50
5759/5759 - 525s - loss: 3.1919 - accuracy200: 0.4227 - val_loss: 3.4048 - val_accuracy200: 0.3091 - 525s/epoch - 91ms/step
Epoch 5/50
5759/5759 - 522s - loss: 3.1869 - accuracy200: 0.4244 - val_loss: 3.4243 - val_accuracy200: 0.3077 - 522s/epoch - 91ms/step
Epoch 6/50
5759/5759 - 524s - loss: 3.1828 - accuracy200: 0.4266 - val_loss: 3.4190 - val_accuracy200: 0.3065 - 524s/epoch - 91ms/step
Epoch 7/50
5759/5759 - 530s - loss: 3.1790 - accuracy200: 0.4281 - val_loss: 3.4324 - val_accuracy200: 0.3034 - 530s/epoch - 92ms/step
Epoch 8/50
5759/5759 - 536s - loss: 3.1762 - accuracy200: 0.4291 - val_loss: 3.4529 - val_accuracy200: 0.3078 - 536s/epoch - 93ms/step
Epoch 9/50
5759/5759 - 525s - loss: 3.1734 - accuracy200: 0.4309 - val_loss: 3.4556 - val_accuracy200: 0.3058 - 525s/epoch - 91ms/step
Epoch 10/50
5759/5759 - 528s - loss: 3.1711 - accuracy200: 0.4317 - val_loss: 3.4987 - val_accuracy200: 0.3089 - 528s/epoch - 92ms/step
Epoch 11/50
5759/5759 - 530s - loss: 3.1677 - accuracy200: 0.4332 - val_loss: 3.4911 - val_accuracy200: 0.3084 - 530s/epoch - 92ms/step
testing model: results/AAPL/W5/deepLOB_L2/h200
Evaluating performance on  test set...
31315/31315 - 1292s - 1292s/epoch - 41ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.142276
{'0': {'precision': 0.4098360655737705, 'recall': 5.8142142587790486e-05, 'f1-score': 0.00011626779063293526, 'support': 3009865}, '1': {'precision': 0.23748303406815383, 'recall': 0.9977668111681506, 'f1-score': 0.3836514378407226, 'support': 1903556}, '2': {'precision': 0.3931247963506028, 'recall': 0.002332854774231284, 'f1-score': 0.004638185936858778, 'support': 3103065}, 'accuracy': 0.23784972617678118, 'macro avg': {'precision': 0.346814631997509, 'recall': 0.33338593602832317, 'f1-score': 0.1294686305227381, 'support': 8016486}, 'weighted avg': {'precision': 0.3624412591869453, 'recall': 0.23784972617678118, 'f1-score': 0.0929390432676046, 'support': 8016486}}
[[    175 3002672    7018]
 [     94 1899305    4157]
 [    158 3095668    7239]]
Evaluating performance on  train set...
5759/5759 - 224s - 224s/epoch - 39ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201723
{'0': {'precision': 0.3785089332842816, 'recall': 0.04849299572940318, 'f1-score': 0.08597165885265765, 'support': 487988}, '1': {'precision': 0.333139210833212, 'recall': 0.9304796799395368, 'f1-score': 0.49062145008268027, 'support': 486908}, '2': {'precision': 0.33076015245613016, 'recall': 0.034241581810461545, 'f1-score': 0.06205861373631259, 'support': 499276}, 'accuracy': 0.3349799073649479, 'macro avg': {'precision': 0.3474694321912079, 'recall': 0.33773808582646714, 'f1-score': 0.21288390755721684, 'support': 1474172}, 'weighted avg': {'precision': 0.34735198476269696, 'recall': 0.3349799073649479, 'f1-score': 0.2115255365784044, 'support': 1474172}}
[[ 23664 447708  16616]
 [ 15875 453058  17975]
 [ 22980 459200  17096]]
Evaluating performance on  val set...
2129/2129 - 77s - 77s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1261413
{'0': {'precision': 0.31316538420997153, 'recall': 0.016098182113733032, 'f1-score': 0.03062223642304243, 'support': 184555}, '1': {'precision': 0.3086851052830414, 'recall': 0.9022264065414858, 'f1-score': 0.459990429643808, 'support': 172071}, '2': {'precision': 0.2976662669495434, 'recall': 0.05140881718831314, 'f1-score': 0.087675525387503, 'support': 188314}, 'accuracy': 0.3081054795023305, 'macro avg': {'precision': 0.3065055854808521, 'recall': 0.32324446861451067, 'f1-score': 0.19276273048478446, 'support': 544940}, 'weighted avg': {'precision': 0.306394681301365, 'recall': 0.3081054795023305, 'f1-score': 0.1859159337727392, 'support': 544940}}
[[  2971 172032   9552]
 [  3534 155247  13290]
 [  2982 175651   9681]]
training model: results/AAPL/W5/deepLOB_L2/h300
Epoch 1/50
5759/5759 - 268s - loss: 3.1949 - accuracy300: 0.4210 - val_loss: 3.5294 - val_accuracy300: 0.3149 - 268s/epoch - 47ms/step
Epoch 2/50
5759/5759 - 268s - loss: 3.1739 - accuracy300: 0.4311 - val_loss: 3.4866 - val_accuracy300: 0.3152 - 268s/epoch - 47ms/step
Epoch 3/50
5759/5759 - 268s - loss: 3.1623 - accuracy300: 0.4369 - val_loss: 3.5838 - val_accuracy300: 0.3080 - 268s/epoch - 47ms/step
Epoch 4/50
5759/5759 - 266s - loss: 3.1533 - accuracy300: 0.4409 - val_loss: 3.5614 - val_accuracy300: 0.3088 - 266s/epoch - 46ms/step
Epoch 5/50
5759/5759 - 268s - loss: 3.1471 - accuracy300: 0.4429 - val_loss: 3.6011 - val_accuracy300: 0.3129 - 268s/epoch - 47ms/step
Epoch 6/50
5759/5759 - 267s - loss: 3.1403 - accuracy300: 0.4457 - val_loss: 3.6059 - val_accuracy300: 0.3127 - 267s/epoch - 46ms/step
Epoch 7/50
5759/5759 - 270s - loss: 3.1344 - accuracy300: 0.4478 - val_loss: 3.6430 - val_accuracy300: 0.3140 - 270s/epoch - 47ms/step
Epoch 8/50
5759/5759 - 274s - loss: 3.1302 - accuracy300: 0.4497 - val_loss: 3.6770 - val_accuracy300: 0.3131 - 274s/epoch - 48ms/step
Epoch 9/50
5759/5759 - 271s - loss: 3.1262 - accuracy300: 0.4512 - val_loss: 3.7178 - val_accuracy300: 0.3221 - 271s/epoch - 47ms/step
Epoch 10/50
5759/5759 - 270s - loss: 3.1226 - accuracy300: 0.4527 - val_loss: 3.6531 - val_accuracy300: 0.3141 - 270s/epoch - 47ms/step
Epoch 11/50
5759/5759 - 271s - loss: 3.1192 - accuracy300: 0.4538 - val_loss: 3.8158 - val_accuracy300: 0.3081 - 271s/epoch - 47ms/step
Epoch 12/50
5759/5759 - 268s - loss: 3.1146 - accuracy300: 0.4556 - val_loss: 3.8147 - val_accuracy300: 0.3078 - 268s/epoch - 47ms/step
testing model: results/AAPL/W5/deepLOB_L2/h300
Evaluating performance on  test set...
31315/31315 - 555s - 555s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.223831
{'0': {'precision': 0.39530872714729215, 'recall': 0.0018029385065816694, 'f1-score': 0.003589505863486018, 'support': 3178145}, '1': {'precision': 0.1980997521726399, 'recall': 0.9956246135012287, 'f1-score': 0.3304498004113938, 'support': 1587974}, '2': {'precision': 0.402434385697984, 'recall': 0.002604013639075218, 'f1-score': 0.005174544590861586, 'support': 3250367}, 'accuracy': 0.198992426357384, 'macro avg': {'precision': 0.3319476216726387, 'recall': 0.3333438552156285, 'f1-score': 0.1130712836219138, 'support': 8016486}, 'weighted avg': {'precision': 0.35913306122334965, 'recall': 0.198992426357384, 'f1-score': 0.06897945439549903, 'support': 8016486}}
[[   5730 3164141    8274]
 [   2654 1581026    4294]
 [   6111 3235792    8464]]
Evaluating performance on  train set...
5759/5759 - 104s - 104s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1516255
{'0': {'precision': 0.3666107231155144, 'recall': 0.0415232481134158, 'f1-score': 0.07459740717552515, 'support': 489244}, '1': {'precision': 0.33221293172228533, 'recall': 0.9601958175217256, 'f1-score': 0.49363557427626603, 'support': 486984}, '2': {'precision': 0.3186676166726042, 'recall': 0.007185546969137092, 'f1-score': 0.014054189939745313, 'support': 497944}, 'accuracy': 0.3334027508323316, 'macro avg': {'precision': 0.33916375717013464, 'recall': 0.3363015375347595, 'f1-score': 0.19409572379717885, 'support': 1474172}, 'weighted avg': {'precision': 0.339053452838743, 'recall': 0.3334027508323316, 'f1-score': 0.1925739736848158, 'support': 1474172}}
[[ 20315 465311   3618]
 [ 15352 467600   4032]
 [ 19746 474620   3578]]
Evaluating performance on  val set...
2129/2129 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1643445
{'0': {'precision': 0.28164166837887816, 'recall': 0.029794217215764907, 'f1-score': 0.053887772301311566, 'support': 184029}, '1': {'precision': 0.3157782380669394, 'recall': 0.9410257732845033, 'f1-score': 0.4728747807604911, 'support': 174483}, '2': {'precision': 0.3205663459793066, 'recall': 0.009472825970347801, 'f1-score': 0.018401871447402008, 'support': 186428}, 'accuracy': 0.31460711270965613, 'macro avg': {'precision': 0.3059954174750414, 'recall': 0.32676427215687204, 'f1-score': 0.18172147483640155, 'support': 544940}, 'weighted avg': {'precision': 0.30588819255507127, 'recall': 0.31460711270965613, 'f1-score': 0.17590220448208446, 'support': 544940}}
[[  5483 176716   1830]
 [  8377 164193   1913]
 [  5608 179054   1766]]
training model: results/AAPL/W5/deepLOB_L2/h500
Epoch 1/50
5759/5759 - 273s - loss: 3.2066 - accuracy500: 0.4148 - val_loss: 3.6238 - val_accuracy500: 0.3196 - 273s/epoch - 47ms/step
Epoch 2/50
5759/5759 - 268s - loss: 3.1717 - accuracy500: 0.4312 - val_loss: 3.6532 - val_accuracy500: 0.3100 - 268s/epoch - 47ms/step
Epoch 3/50
5759/5759 - 267s - loss: 3.1573 - accuracy500: 0.4378 - val_loss: 3.7444 - val_accuracy500: 0.3501 - 267s/epoch - 46ms/step
Epoch 4/50
5759/5759 - 270s - loss: 3.1442 - accuracy500: 0.4439 - val_loss: 3.6800 - val_accuracy500: 0.3517 - 270s/epoch - 47ms/step
Epoch 5/50
5759/5759 - 266s - loss: 3.1349 - accuracy500: 0.4476 - val_loss: 3.8341 - val_accuracy500: 0.3489 - 266s/epoch - 46ms/step
Epoch 6/50
5759/5759 - 266s - loss: 3.1269 - accuracy500: 0.4506 - val_loss: 3.5728 - val_accuracy500: 0.3412 - 266s/epoch - 46ms/step
Epoch 7/50
5759/5759 - 268s - loss: 3.1208 - accuracy500: 0.4530 - val_loss: 3.5497 - val_accuracy500: 0.3390 - 268s/epoch - 47ms/step
Epoch 8/50
5759/5759 - 265s - loss: 3.1140 - accuracy500: 0.4555 - val_loss: 3.5963 - val_accuracy500: 0.3346 - 265s/epoch - 46ms/step
Epoch 9/50
5759/5759 - 266s - loss: 3.1093 - accuracy500: 0.4570 - val_loss: 3.6181 - val_accuracy500: 0.3439 - 266s/epoch - 46ms/step
Epoch 10/50
5759/5759 - 265s - loss: 3.1053 - accuracy500: 0.4579 - val_loss: 3.6715 - val_accuracy500: 0.3436 - 265s/epoch - 46ms/step
Epoch 11/50
5759/5759 - 265s - loss: 3.1022 - accuracy500: 0.4592 - val_loss: 3.5905 - val_accuracy500: 0.3275 - 265s/epoch - 46ms/step
Epoch 12/50
5759/5759 - 265s - loss: 3.0975 - accuracy500: 0.4613 - val_loss: 3.6869 - val_accuracy500: 0.3462 - 265s/epoch - 46ms/step
Epoch 13/50
5759/5759 - 265s - loss: 3.0933 - accuracy500: 0.4624 - val_loss: 3.7463 - val_accuracy500: 0.3445 - 265s/epoch - 46ms/step
Epoch 14/50
5759/5759 - 265s - loss: 3.0900 - accuracy500: 0.4634 - val_loss: 3.9242 - val_accuracy500: 0.3442 - 265s/epoch - 46ms/step
Epoch 15/50
5759/5759 - 265s - loss: 3.0864 - accuracy500: 0.4650 - val_loss: 3.6851 - val_accuracy500: 0.3466 - 265s/epoch - 46ms/step
Epoch 16/50
5759/5759 - 264s - loss: 3.0829 - accuracy500: 0.4657 - val_loss: 3.7862 - val_accuracy500: 0.3380 - 264s/epoch - 46ms/step
Epoch 17/50
5759/5759 - 264s - loss: 3.0797 - accuracy500: 0.4671 - val_loss: 3.8141 - val_accuracy500: 0.3377 - 264s/epoch - 46ms/step
testing model: results/AAPL/W5/deepLOB_L2/h500
Evaluating performance on  test set...
31315/31315 - 537s - 537s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1945995
{'0': {'precision': 0.38140675312398453, 'recall': 0.00420919685550728, 'f1-score': 0.008326502604490804, 'support': 3067331}, '1': {'precision': 0.22438534602595514, 'recall': 0.2757695971851269, 'f1-score': 0.2474379482907884, 'support': 1848467}, '2': {'precision': 0.3859628018082712, 'recall': 0.7108690071364807, 'f1-score': 0.5002936484437426, 'support': 3100688}, 'accuracy': 0.34015465130232875, 'macro avg': {'precision': 0.3305849669860703, 'recall': 0.3302826003923716, 'f1-score': 0.2520193664463406, 'support': 8016486}, 'weighted avg': {'precision': 0.3469624836733188, 'recall': 0.34015465130232875, 'f1-score': 0.25374902840587454, 'support': 8016486}}
[[  12911  878627 2175793]
 [   7823  509751 1330893]
 [  13117  883388 2204183]]
Evaluating performance on  train set...
5759/5759 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.165077
{'0': {'precision': 0.3468620889495429, 'recall': 0.15022751931080272, 'f1-score': 0.2096532709593948, 'support': 494024}, '1': {'precision': 0.32923057698916, 'recall': 0.19629353697150306, 'f1-score': 0.24594812195890364, 'support': 483210}, '2': {'precision': 0.3351805198799723, 'recall': 0.6556793805263433, 'f1-score': 0.44359642679914263, 'support': 496938}, 'accuracy': 0.3357132003592525, 'macro avg': {'precision': 0.3370910619395584, 'recall': 0.33406681226954965, 'f1-score': 0.29973260657248035, 'support': 1474172}, 'weighted avg': {'precision': 0.33714494707961806, 'recall': 0.3357132003592525, 'f1-score': 0.30041152639238716, 'support': 1474172}}
[[ 74216  95865 323943]
 [ 66025  94851 322334]
 [ 73723  97383 325832]]
Evaluating performance on  val set...
2129/2129 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1844229
{'0': {'precision': 0.28988942830700287, 'recall': 0.09457369268582083, 'f1-score': 0.14261921213549383, 'support': 188784}, '1': {'precision': 0.3020121581543201, 'recall': 0.22372397887965043, 'f1-score': 0.25703906173734786, 'support': 164770}, '2': {'precision': 0.35844314725167664, 'recall': 0.6766586897683217, 'f1-score': 0.46863731026509065, 'support': 191386}, 'accuracy': 0.33805556575035783, 'macro avg': {'precision': 0.3167815779043332, 'recall': 0.33165212044459763, 'f1-score': 0.28943186137931076, 'support': 544940}, 'weighted avg': {'precision': 0.3176313526489264, 'recall': 0.33805556575035783, 'f1-score': 0.2917149994653439, 'support': 544940}}
[[ 17854  41932 128998]
 [ 25115  36863 102792]
 [ 18620  43263 129503]]
training model: results/AAPL/W5/deepLOB_L2/h1000
Epoch 1/50
5759/5759 - 267s - loss: 3.1604 - accuracy1000: 0.4374 - val_loss: 3.5109 - val_accuracy1000: 0.2889 - 267s/epoch - 46ms/step
Epoch 2/50
5759/5759 - 265s - loss: 3.1164 - accuracy1000: 0.4574 - val_loss: 3.5056 - val_accuracy1000: 0.3404 - 265s/epoch - 46ms/step
Epoch 3/50
5759/5759 - 263s - loss: 3.0927 - accuracy1000: 0.4656 - val_loss: 3.5332 - val_accuracy1000: 0.3448 - 263s/epoch - 46ms/step
Epoch 4/50
5759/5759 - 263s - loss: 3.0790 - accuracy1000: 0.4701 - val_loss: 3.5699 - val_accuracy1000: 0.3549 - 263s/epoch - 46ms/step
Epoch 5/50
5759/5759 - 262s - loss: 3.0681 - accuracy1000: 0.4742 - val_loss: 3.4506 - val_accuracy1000: 0.3427 - 262s/epoch - 46ms/step
Epoch 6/50
5759/5759 - 263s - loss: 3.0594 - accuracy1000: 0.4770 - val_loss: 3.4642 - val_accuracy1000: 0.3415 - 263s/epoch - 46ms/step
Epoch 7/50
5759/5759 - 263s - loss: 3.0535 - accuracy1000: 0.4788 - val_loss: 3.4292 - val_accuracy1000: 0.3477 - 263s/epoch - 46ms/step
Epoch 8/50
5759/5759 - 262s - loss: 3.0472 - accuracy1000: 0.4807 - val_loss: 3.4473 - val_accuracy1000: 0.3581 - 262s/epoch - 45ms/step
Epoch 9/50
5759/5759 - 263s - loss: 3.0426 - accuracy1000: 0.4825 - val_loss: 3.5226 - val_accuracy1000: 0.3593 - 263s/epoch - 46ms/step
Epoch 10/50
5759/5759 - 262s - loss: 3.0374 - accuracy1000: 0.4839 - val_loss: 3.5304 - val_accuracy1000: 0.3585 - 262s/epoch - 46ms/step
Epoch 11/50
5759/5759 - 262s - loss: 3.0325 - accuracy1000: 0.4853 - val_loss: 3.5704 - val_accuracy1000: 0.3573 - 262s/epoch - 45ms/step
Epoch 12/50
5759/5759 - 262s - loss: 3.0297 - accuracy1000: 0.4866 - val_loss: 3.5761 - val_accuracy1000: 0.3559 - 262s/epoch - 45ms/step
Epoch 13/50
5759/5759 - 262s - loss: 3.0248 - accuracy1000: 0.4882 - val_loss: 3.5848 - val_accuracy1000: 0.3554 - 262s/epoch - 45ms/step
Epoch 14/50
5759/5759 - 262s - loss: 3.0216 - accuracy1000: 0.4888 - val_loss: 3.5683 - val_accuracy1000: 0.3578 - 262s/epoch - 45ms/step
Epoch 15/50
5759/5759 - 262s - loss: 3.0186 - accuracy1000: 0.4896 - val_loss: 3.5903 - val_accuracy1000: 0.3548 - 262s/epoch - 46ms/step
Epoch 16/50
5759/5759 - 263s - loss: 3.0148 - accuracy1000: 0.4910 - val_loss: 3.6483 - val_accuracy1000: 0.3515 - 263s/epoch - 46ms/step
Epoch 17/50
5759/5759 - 262s - loss: 3.0111 - accuracy1000: 0.4922 - val_loss: 3.6617 - val_accuracy1000: 0.3523 - 262s/epoch - 46ms/step
testing model: results/AAPL/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
31315/31315 - 541s - 541s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1323339
{'0': {'precision': 0.3880210357610765, 'recall': 0.08878373204256233, 'f1-score': 0.14450340261730074, 'support': 3092312}, '1': {'precision': 0.2279646032204595, 'recall': 0.18306325160954887, 'f1-score': 0.2030613790623865, 'support': 1823337}, '2': {'precision': 0.386604132818499, 'recall': 0.7287051850838984, 'f1-score': 0.5051879898027681, 'support': 3100837}, 'accuracy': 0.3577538836841978, 'macro avg': {'precision': 0.33419659060001167, 'recall': 0.33351738957866983, 'f1-score': 0.2842509238274851, 'support': 8016486}, 'weighted avg': {'precision': 0.3510683858582308, 'recall': 0.3577538836841978, 'f1-score': 0.29733782886988536, 'support': 8016486}}
[[ 274547  564613 2253152]
 [ 157571  333786 1331980]
 [ 275439  565802 2259596]]
Evaluating performance on  train set...
5759/5759 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1446496
{'0': {'precision': 0.35046711851987544, 'recall': 0.13253398358021076, 'f1-score': 0.1923341504992755, 'support': 505244}, '1': {'precision': 0.3144490207615365, 'recall': 0.2616921286531609, 'f1-score': 0.28565511656157805, 'support': 471749}, '2': {'precision': 0.33400448733641325, 'recall': 0.5982412772864502, 'f1-score': 0.42867509557284256, 'support': 497179}, 'accuracy': 0.33093017639732675, 'macro avg': {'precision': 0.3329735422059417, 'recall': 0.33082246317327396, 'f1-score': 0.30222145421123203, 'support': 1474172}, 'weighted avg': {'precision': 0.33338880194042525, 'recall': 0.33093017639732675, 'f1-score': 0.30190605062331544, 'support': 1474172}}
[[ 66962 135507 302775]
 [ 57998 123453 290298]
 [ 66105 133641 297433]]
Evaluating performance on  val set...
2129/2129 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1466072
{'0': {'precision': 0.32608411092619255, 'recall': 0.09301060357150477, 'f1-score': 0.14473711513481435, 'support': 187484}, '1': {'precision': 0.3232735143192959, 'recall': 0.27669441360315544, 'f1-score': 0.2981758567920331, 'support': 163021}, '2': {'precision': 0.361985730157332, 'recall': 0.6552009669041068, 'f1-score': 0.46633209240692136, 'support': 194435}, 'accuracy': 0.34855029911549895, 'macro avg': {'precision': 0.33711445180094013, 'recall': 0.3416353280262556, 'f1-score': 0.3030816881112563, 'support': 544940}, 'weighted avg': {'precision': 0.33805303423105854, 'recall': 0.34855029911549895, 'f1-score': 0.305384262544811, 'support': 544940}}
[[ 17438  46676 123370]
 [ 16747  45107 101167]
 [ 19292  47749 127394]]
training model: results/AAPL/W5/deepOF_L2/h10
Epoch 1/50
5759/5759 - 153s - loss: 2.9000 - accuracy10: 0.5124 - val_loss: 3.1670 - val_accuracy10: 0.5003 - 153s/epoch - 27ms/step
Epoch 2/50
5759/5759 - 135s - loss: 2.8079 - accuracy10: 0.5357 - val_loss: 3.0940 - val_accuracy10: 0.5113 - 135s/epoch - 23ms/step
Epoch 3/50
5759/5759 - 133s - loss: 2.7806 - accuracy10: 0.5410 - val_loss: 3.0359 - val_accuracy10: 0.5196 - 133s/epoch - 23ms/step
Epoch 4/50
5759/5759 - 131s - loss: 2.7641 - accuracy10: 0.5442 - val_loss: 3.0225 - val_accuracy10: 0.5207 - 131s/epoch - 23ms/step
Epoch 5/50
5759/5759 - 130s - loss: 2.7516 - accuracy10: 0.5471 - val_loss: 3.0065 - val_accuracy10: 0.5234 - 130s/epoch - 23ms/step
Epoch 6/50
5759/5759 - 127s - loss: 2.7421 - accuracy10: 0.5488 - val_loss: 3.0058 - val_accuracy10: 0.5238 - 127s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 129s - loss: 2.7330 - accuracy10: 0.5505 - val_loss: 2.9905 - val_accuracy10: 0.5257 - 129s/epoch - 22ms/step
Epoch 8/50
5759/5759 - 125s - loss: 2.7262 - accuracy10: 0.5519 - val_loss: 2.9966 - val_accuracy10: 0.5258 - 125s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 126s - loss: 2.7197 - accuracy10: 0.5532 - val_loss: 2.9888 - val_accuracy10: 0.5276 - 126s/epoch - 22ms/step
Epoch 10/50
5759/5759 - 124s - loss: 2.7140 - accuracy10: 0.5547 - val_loss: 2.9834 - val_accuracy10: 0.5277 - 124s/epoch - 22ms/step
Epoch 11/50
5759/5759 - 125s - loss: 2.7091 - accuracy10: 0.5555 - val_loss: 2.9837 - val_accuracy10: 0.5276 - 125s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 124s - loss: 2.7043 - accuracy10: 0.5566 - val_loss: 2.9835 - val_accuracy10: 0.5291 - 124s/epoch - 22ms/step
Epoch 13/50
5759/5759 - 124s - loss: 2.6994 - accuracy10: 0.5575 - val_loss: 2.9885 - val_accuracy10: 0.5285 - 124s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 124s - loss: 2.6953 - accuracy10: 0.5586 - val_loss: 2.9790 - val_accuracy10: 0.5295 - 124s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 123s - loss: 2.6915 - accuracy10: 0.5594 - val_loss: 2.9745 - val_accuracy10: 0.5311 - 123s/epoch - 21ms/step
Epoch 16/50
5759/5759 - 123s - loss: 2.6881 - accuracy10: 0.5601 - val_loss: 2.9720 - val_accuracy10: 0.5307 - 123s/epoch - 21ms/step
Epoch 17/50
5759/5759 - 125s - loss: 2.6850 - accuracy10: 0.5606 - val_loss: 2.9713 - val_accuracy10: 0.5315 - 125s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 125s - loss: 2.6813 - accuracy10: 0.5618 - val_loss: 2.9675 - val_accuracy10: 0.5322 - 125s/epoch - 22ms/step
Epoch 19/50
5759/5759 - 124s - loss: 2.6793 - accuracy10: 0.5618 - val_loss: 2.9784 - val_accuracy10: 0.5319 - 124s/epoch - 22ms/step
Epoch 20/50
5759/5759 - 124s - loss: 2.6756 - accuracy10: 0.5624 - val_loss: 2.9610 - val_accuracy10: 0.5334 - 124s/epoch - 22ms/step
Epoch 21/50
5759/5759 - 124s - loss: 2.6734 - accuracy10: 0.5633 - val_loss: 2.9565 - val_accuracy10: 0.5335 - 124s/epoch - 22ms/step
Epoch 22/50
5759/5759 - 125s - loss: 2.6705 - accuracy10: 0.5638 - val_loss: 2.9601 - val_accuracy10: 0.5333 - 125s/epoch - 22ms/step
Epoch 23/50
5759/5759 - 124s - loss: 2.6680 - accuracy10: 0.5639 - val_loss: 2.9593 - val_accuracy10: 0.5341 - 124s/epoch - 22ms/step
Epoch 24/50
5759/5759 - 126s - loss: 2.6657 - accuracy10: 0.5645 - val_loss: 2.9464 - val_accuracy10: 0.5358 - 126s/epoch - 22ms/step
Epoch 25/50
5759/5759 - 124s - loss: 2.6633 - accuracy10: 0.5652 - val_loss: 2.9500 - val_accuracy10: 0.5354 - 124s/epoch - 21ms/step
Epoch 26/50
5759/5759 - 125s - loss: 2.6613 - accuracy10: 0.5656 - val_loss: 2.9515 - val_accuracy10: 0.5355 - 125s/epoch - 22ms/step
Epoch 27/50
5759/5759 - 124s - loss: 2.6591 - accuracy10: 0.5659 - val_loss: 2.9421 - val_accuracy10: 0.5345 - 124s/epoch - 21ms/step
Epoch 28/50
5759/5759 - 124s - loss: 2.6567 - accuracy10: 0.5667 - val_loss: 2.9378 - val_accuracy10: 0.5366 - 124s/epoch - 21ms/step
Epoch 29/50
5759/5759 - 124s - loss: 2.6546 - accuracy10: 0.5667 - val_loss: 2.9376 - val_accuracy10: 0.5365 - 124s/epoch - 22ms/step
Epoch 30/50
5759/5759 - 124s - loss: 2.6525 - accuracy10: 0.5676 - val_loss: 2.9338 - val_accuracy10: 0.5368 - 124s/epoch - 21ms/step
Epoch 31/50
5759/5759 - 124s - loss: 2.6507 - accuracy10: 0.5680 - val_loss: 2.9335 - val_accuracy10: 0.5374 - 124s/epoch - 22ms/step
Epoch 32/50
5759/5759 - 124s - loss: 2.6487 - accuracy10: 0.5681 - val_loss: 2.9495 - val_accuracy10: 0.5350 - 124s/epoch - 22ms/step
Epoch 33/50
5759/5759 - 124s - loss: 2.6468 - accuracy10: 0.5686 - val_loss: 2.9244 - val_accuracy10: 0.5379 - 124s/epoch - 22ms/step
Epoch 34/50
5759/5759 - 124s - loss: 2.6453 - accuracy10: 0.5691 - val_loss: 2.9268 - val_accuracy10: 0.5375 - 124s/epoch - 22ms/step
Epoch 35/50
5759/5759 - 125s - loss: 2.6430 - accuracy10: 0.5695 - val_loss: 2.9246 - val_accuracy10: 0.5369 - 125s/epoch - 22ms/step
Epoch 36/50
5759/5759 - 125s - loss: 2.6415 - accuracy10: 0.5699 - val_loss: 2.9186 - val_accuracy10: 0.5371 - 125s/epoch - 22ms/step
Epoch 37/50
5759/5759 - 124s - loss: 2.6400 - accuracy10: 0.5702 - val_loss: 2.9290 - val_accuracy10: 0.5362 - 124s/epoch - 22ms/step
Epoch 38/50
5759/5759 - 124s - loss: 2.6381 - accuracy10: 0.5704 - val_loss: 2.9180 - val_accuracy10: 0.5366 - 124s/epoch - 22ms/step
Epoch 39/50
5759/5759 - 124s - loss: 2.6365 - accuracy10: 0.5709 - val_loss: 2.9280 - val_accuracy10: 0.5368 - 124s/epoch - 21ms/step
Epoch 40/50
5759/5759 - 124s - loss: 2.6350 - accuracy10: 0.5708 - val_loss: 2.9128 - val_accuracy10: 0.5387 - 124s/epoch - 22ms/step
Epoch 41/50
5759/5759 - 125s - loss: 2.6338 - accuracy10: 0.5713 - val_loss: 2.9201 - val_accuracy10: 0.5376 - 125s/epoch - 22ms/step
Epoch 42/50
5759/5759 - 123s - loss: 2.6324 - accuracy10: 0.5714 - val_loss: 2.9105 - val_accuracy10: 0.5380 - 123s/epoch - 21ms/step
Epoch 43/50
5759/5759 - 125s - loss: 2.6308 - accuracy10: 0.5720 - val_loss: 2.9125 - val_accuracy10: 0.5380 - 125s/epoch - 22ms/step
Epoch 44/50
5759/5759 - 124s - loss: 2.6295 - accuracy10: 0.5720 - val_loss: 2.9114 - val_accuracy10: 0.5373 - 124s/epoch - 22ms/step
Epoch 45/50
5759/5759 - 124s - loss: 2.6279 - accuracy10: 0.5724 - val_loss: 2.9076 - val_accuracy10: 0.5378 - 124s/epoch - 22ms/step
Epoch 46/50
5759/5759 - 124s - loss: 2.6261 - accuracy10: 0.5728 - val_loss: 2.9133 - val_accuracy10: 0.5358 - 124s/epoch - 22ms/step
Epoch 47/50
5759/5759 - 124s - loss: 2.6249 - accuracy10: 0.5733 - val_loss: 2.9162 - val_accuracy10: 0.5369 - 124s/epoch - 21ms/step
Epoch 48/50
5759/5759 - 124s - loss: 2.6233 - accuracy10: 0.5738 - val_loss: 2.9127 - val_accuracy10: 0.5362 - 124s/epoch - 22ms/step
Epoch 49/50
5759/5759 - 123s - loss: 2.6215 - accuracy10: 0.5742 - val_loss: 2.9102 - val_accuracy10: 0.5379 - 123s/epoch - 21ms/step
Epoch 50/50
5759/5759 - 123s - loss: 2.6210 - accuracy10: 0.5741 - val_loss: 2.9178 - val_accuracy10: 0.5370 - 123s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h10
Evaluating performance on  test set...
31315/31315 - 247s - 247s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9908649
{'0': {'precision': 0.49254986244841814, 'recall': 0.6076148317519033, 'f1-score': 0.5440650902155286, 'support': 2828769}, '1': {'precision': 0.5397198394714166, 'recall': 0.31274364417714073, 'f1-score': 0.39601449837722413, 'support': 2325112}, '2': {'precision': 0.5145440501298598, 'recall': 0.5715206455669671, 'f1-score': 0.5415378086922903, 'support': 2862600}, 'accuracy': 0.5092011070692989, 'macro avg': {'precision': 0.5156045840165647, 'recall': 0.4972930404986704, 'f1-score': 0.49387246576168103, 'support': 8016481}, 'weighted avg': {'precision': 0.5140850025270627, 'recall': 0.5092011070692989, 'f1-score': 0.5002218123759422, 'support': 8016481}}
[[1718802  292396  817571]
 [ 871972  727164  725976]
 [ 898826  327739 1636035]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9174632
{'0': {'precision': 0.4990890012297943, 'recall': 0.5565201044990504, 'f1-score': 0.5262422645112698, 'support': 414932}, '1': {'precision': 0.6461362808298492, 'recall': 0.5582877349595498, 'f1-score': 0.5990082495378602, 'support': 641653}, '2': {'precision': 0.4900038943025042, 'recall': 0.5363446092541416, 'f1-score': 0.512128085756359, 'support': 417586}, 'accuracy': 0.5515744102956849, 'macro avg': {'precision': 0.5450763921207159, 'recall': 0.550384149570914, 'f1-score': 0.5457928666018297, 'support': 1474171}, 'weighted avg': {'precision': 0.5605198085349675, 'recall': 0.5515744102956849, 'f1-score': 0.5539165500186625, 'support': 1474171}}
[[230918  95408  88606]
 [138924 358227 144502]
 [ 92837 100779 223970]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94394517
{'0': {'precision': 0.5008926280680749, 'recall': 0.5523686583791622, 'f1-score': 0.5253727494176447, 'support': 169653}, '1': {'precision': 0.613561945917049, 'recall': 0.5323653757881768, 'f1-score': 0.5700870024137155, 'support': 206965}, '2': {'precision': 0.4963230963399243, 'recall': 0.5256741583046679, 'f1-score': 0.5105771561125922, 'support': 168321}, 'accuracy': 0.5365261065917469, 'macro avg': {'precision': 0.5369258901083495, 'recall': 0.5368027308240023, 'f1-score': 0.5353456359813175, 'support': 544939}, 'weighted avg': {'precision': 0.5422724104264652, 'recall': 0.5365261065917469, 'f1-score': 0.5377849208912079, 'support': 544939}}
[[ 93711  33314  42628]
 [ 49619 110181  47165]
 [ 43758  36081  88482]]
training model: results/AAPL/W5/deepOF_L2/h20
Epoch 1/50
5759/5759 - 127s - loss: 2.9927 - accuracy20: 0.4904 - val_loss: 3.1639 - val_accuracy20: 0.4534 - 127s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 124s - loss: 2.9018 - accuracy20: 0.5164 - val_loss: 3.1073 - val_accuracy20: 0.4729 - 124s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 123s - loss: 2.8788 - accuracy20: 0.5227 - val_loss: 3.0751 - val_accuracy20: 0.4831 - 123s/epoch - 21ms/step
Epoch 4/50
5759/5759 - 124s - loss: 2.8665 - accuracy20: 0.5259 - val_loss: 3.0746 - val_accuracy20: 0.4831 - 124s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 123s - loss: 2.8572 - accuracy20: 0.5279 - val_loss: 3.0564 - val_accuracy20: 0.4865 - 123s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 123s - loss: 2.8494 - accuracy20: 0.5297 - val_loss: 3.0706 - val_accuracy20: 0.4841 - 123s/epoch - 21ms/step
Epoch 7/50
5759/5759 - 123s - loss: 2.8430 - accuracy20: 0.5312 - val_loss: 3.0700 - val_accuracy20: 0.4847 - 123s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 124s - loss: 2.8375 - accuracy20: 0.5326 - val_loss: 3.0542 - val_accuracy20: 0.4880 - 124s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 123s - loss: 2.8324 - accuracy20: 0.5335 - val_loss: 3.0519 - val_accuracy20: 0.4899 - 123s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 123s - loss: 2.8280 - accuracy20: 0.5349 - val_loss: 3.0365 - val_accuracy20: 0.4934 - 123s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 124s - loss: 2.8233 - accuracy20: 0.5365 - val_loss: 3.0467 - val_accuracy20: 0.4928 - 124s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 124s - loss: 2.8197 - accuracy20: 0.5370 - val_loss: 3.0383 - val_accuracy20: 0.4940 - 124s/epoch - 21ms/step
Epoch 13/50
5759/5759 - 123s - loss: 2.8164 - accuracy20: 0.5377 - val_loss: 3.0234 - val_accuracy20: 0.4979 - 123s/epoch - 21ms/step
Epoch 14/50
5759/5759 - 123s - loss: 2.8132 - accuracy20: 0.5384 - val_loss: 3.0214 - val_accuracy20: 0.4971 - 123s/epoch - 21ms/step
Epoch 15/50
5759/5759 - 125s - loss: 2.8104 - accuracy20: 0.5392 - val_loss: 3.0196 - val_accuracy20: 0.4985 - 125s/epoch - 22ms/step
Epoch 16/50
5759/5759 - 124s - loss: 2.8070 - accuracy20: 0.5402 - val_loss: 3.0202 - val_accuracy20: 0.4977 - 124s/epoch - 22ms/step
Epoch 17/50
5759/5759 - 125s - loss: 2.8044 - accuracy20: 0.5407 - val_loss: 3.0130 - val_accuracy20: 0.4992 - 125s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 128s - loss: 2.8020 - accuracy20: 0.5415 - val_loss: 3.0156 - val_accuracy20: 0.4992 - 128s/epoch - 22ms/step
Epoch 19/50
5759/5759 - 130s - loss: 2.7993 - accuracy20: 0.5420 - val_loss: 3.0001 - val_accuracy20: 0.5017 - 130s/epoch - 23ms/step
Epoch 20/50
5759/5759 - 130s - loss: 2.7971 - accuracy20: 0.5424 - val_loss: 3.0123 - val_accuracy20: 0.4997 - 130s/epoch - 23ms/step
Epoch 21/50
5759/5759 - 130s - loss: 2.7950 - accuracy20: 0.5432 - val_loss: 3.0151 - val_accuracy20: 0.4992 - 130s/epoch - 23ms/step
Epoch 22/50
5759/5759 - 132s - loss: 2.7925 - accuracy20: 0.5437 - val_loss: 2.9954 - val_accuracy20: 0.5031 - 132s/epoch - 23ms/step
Epoch 23/50
5759/5759 - 131s - loss: 2.7908 - accuracy20: 0.5441 - val_loss: 2.9993 - val_accuracy20: 0.5019 - 131s/epoch - 23ms/step
Epoch 24/50
5759/5759 - 131s - loss: 2.7886 - accuracy20: 0.5448 - val_loss: 2.9889 - val_accuracy20: 0.5043 - 131s/epoch - 23ms/step
Epoch 25/50
5759/5759 - 131s - loss: 2.7865 - accuracy20: 0.5452 - val_loss: 2.9850 - val_accuracy20: 0.5048 - 131s/epoch - 23ms/step
Epoch 26/50
5759/5759 - 133s - loss: 2.7843 - accuracy20: 0.5457 - val_loss: 2.9905 - val_accuracy20: 0.5036 - 133s/epoch - 23ms/step
Epoch 27/50
5759/5759 - 133s - loss: 2.7824 - accuracy20: 0.5460 - val_loss: 2.9755 - val_accuracy20: 0.5075 - 133s/epoch - 23ms/step
Epoch 28/50
5759/5759 - 130s - loss: 2.7806 - accuracy20: 0.5466 - val_loss: 2.9684 - val_accuracy20: 0.5084 - 130s/epoch - 23ms/step
Epoch 29/50
5759/5759 - 131s - loss: 2.7784 - accuracy20: 0.5471 - val_loss: 2.9611 - val_accuracy20: 0.5089 - 131s/epoch - 23ms/step
Epoch 30/50
5759/5759 - 129s - loss: 2.7768 - accuracy20: 0.5474 - val_loss: 2.9647 - val_accuracy20: 0.5088 - 129s/epoch - 22ms/step
Epoch 31/50
5759/5759 - 125s - loss: 2.7751 - accuracy20: 0.5481 - val_loss: 2.9606 - val_accuracy20: 0.5093 - 125s/epoch - 22ms/step
Epoch 32/50
5759/5759 - 129s - loss: 2.7736 - accuracy20: 0.5484 - val_loss: 2.9665 - val_accuracy20: 0.5086 - 129s/epoch - 22ms/step
Epoch 33/50
5759/5759 - 128s - loss: 2.7714 - accuracy20: 0.5490 - val_loss: 2.9602 - val_accuracy20: 0.5105 - 128s/epoch - 22ms/step
Epoch 34/50
5759/5759 - 124s - loss: 2.7698 - accuracy20: 0.5491 - val_loss: 2.9673 - val_accuracy20: 0.5090 - 124s/epoch - 22ms/step
Epoch 35/50
5759/5759 - 124s - loss: 2.7682 - accuracy20: 0.5497 - val_loss: 2.9605 - val_accuracy20: 0.5105 - 124s/epoch - 22ms/step
Epoch 36/50
5759/5759 - 125s - loss: 2.7671 - accuracy20: 0.5499 - val_loss: 2.9559 - val_accuracy20: 0.5122 - 125s/epoch - 22ms/step
Epoch 37/50
5759/5759 - 125s - loss: 2.7652 - accuracy20: 0.5502 - val_loss: 2.9476 - val_accuracy20: 0.5130 - 125s/epoch - 22ms/step
Epoch 38/50
5759/5759 - 125s - loss: 2.7636 - accuracy20: 0.5509 - val_loss: 2.9656 - val_accuracy20: 0.5107 - 125s/epoch - 22ms/step
Epoch 39/50
5759/5759 - 124s - loss: 2.7620 - accuracy20: 0.5510 - val_loss: 2.9703 - val_accuracy20: 0.5099 - 124s/epoch - 22ms/step
Epoch 40/50
5759/5759 - 124s - loss: 2.7606 - accuracy20: 0.5514 - val_loss: 2.9628 - val_accuracy20: 0.5111 - 124s/epoch - 21ms/step
Epoch 41/50
5759/5759 - 125s - loss: 2.7594 - accuracy20: 0.5517 - val_loss: 2.9628 - val_accuracy20: 0.5105 - 125s/epoch - 22ms/step
Epoch 42/50
5759/5759 - 125s - loss: 2.7578 - accuracy20: 0.5522 - val_loss: 2.9542 - val_accuracy20: 0.5126 - 125s/epoch - 22ms/step
Epoch 43/50
5759/5759 - 124s - loss: 2.7564 - accuracy20: 0.5524 - val_loss: 2.9566 - val_accuracy20: 0.5119 - 124s/epoch - 22ms/step
Epoch 44/50
5759/5759 - 123s - loss: 2.7549 - accuracy20: 0.5528 - val_loss: 2.9554 - val_accuracy20: 0.5124 - 123s/epoch - 21ms/step
Epoch 45/50
5759/5759 - 124s - loss: 2.7535 - accuracy20: 0.5530 - val_loss: 2.9660 - val_accuracy20: 0.5102 - 124s/epoch - 21ms/step
Epoch 46/50
5759/5759 - 123s - loss: 2.7523 - accuracy20: 0.5530 - val_loss: 2.9630 - val_accuracy20: 0.5117 - 123s/epoch - 21ms/step
Epoch 47/50
5759/5759 - 125s - loss: 2.7516 - accuracy20: 0.5534 - val_loss: 2.9493 - val_accuracy20: 0.5136 - 125s/epoch - 22ms/step
testing model: results/AAPL/W5/deepOF_L2/h20
Evaluating performance on  test set...
31315/31315 - 237s - 237s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0008576
{'0': {'precision': 0.5214452313006503, 'recall': 0.5227912182895782, 'f1-score': 0.52211735732828, 'support': 3137612}, '1': {'precision': 0.40657094085127155, 'recall': 0.3106256770368118, 'f1-score': 0.35218061718502763, 'support': 1683808}, '2': {'precision': 0.5205871800437349, 'recall': 0.5840107591060076, 'f1-score': 0.5504781485147829, 'support': 3195061}, 'accuracy': 0.5026270254990937, 'macro avg': {'precision': 0.48286778406521896, 'recall': 0.4724758848107992, 'f1-score': 0.4749253743426969, 'support': 8016481}, 'weighted avg': {'precision': 0.49697467179206317, 'recall': 0.5026270254990937, 'f1-score': 0.49772680682388915, 'support': 8016481}}
[[1640316  387663 1109633]
 [ 552039  523034  608735]
 [ 953356  375755 1865950]]
Evaluating performance on  train set...
5759/5759 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9643285
{'0': {'precision': 0.5361198346070778, 'recall': 0.482236636961909, 'f1-score': 0.5077527040235006, 'support': 487464}, '1': {'precision': 0.5190094372091135, 'recall': 0.5912509877171218, 'f1-score': 0.5527799343199749, 'support': 497359}, '2': {'precision': 0.5154429742940401, 'recall': 0.4941289225663536, 'f1-score': 0.5045609576185155, 'support': 489348}, 'accuracy': 0.522963753865732, 'macro avg': {'precision': 0.5235240820367438, 'recall': 0.5225388490817948, 'f1-score': 0.5216978653206636, 'support': 1474171}, 'weighted avg': {'precision': 0.5234834509175883, 'recall': 0.522963753865732, 'f1-score': 0.5218845947697148, 'support': 1474171}}
[[235073 137372 115019]
 [ 91002 294064 112293]
 [112396 135151 241801]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9813261
{'0': {'precision': 0.525246960172335, 'recall': 0.49540636042402825, 'f1-score': 0.5098904390194332, 'support': 192440}, '1': {'precision': 0.49743347853833136, 'recall': 0.5598126463700234, 'f1-score': 0.5267828284312286, 'support': 160125}, '2': {'precision': 0.5171235680330956, 'recall': 0.4925353738031127, 'f1-score': 0.5045300731361204, 'support': 192374}, 'accuracy': 0.5133180044004926, 'macro avg': {'precision': 0.5132680022479206, 'recall': 0.5159181268657215, 'f1-score': 0.5137344468622608, 'support': 544939}, 'weighted avg': {'precision': 0.5142065259475156, 'recall': 0.5133180044004926, 'f1-score': 0.5129617898093883, 'support': 544939}}
[[95336 45845 51259]
 [33268 89640 37217]
 [52903 44720 94751]]
training model: results/AAPL/W5/deepOF_L2/h30
Epoch 1/50
5759/5759 - 130s - loss: 3.0698 - accuracy30: 0.4672 - val_loss: 3.1702 - val_accuracy30: 0.4463 - 130s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 124s - loss: 2.9920 - accuracy30: 0.4937 - val_loss: 3.0923 - val_accuracy30: 0.4722 - 124s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 125s - loss: 2.9703 - accuracy30: 0.4994 - val_loss: 3.0942 - val_accuracy30: 0.4708 - 125s/epoch - 22ms/step
Epoch 4/50
5759/5759 - 126s - loss: 2.9587 - accuracy30: 0.5029 - val_loss: 3.0889 - val_accuracy30: 0.4713 - 126s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 124s - loss: 2.9510 - accuracy30: 0.5047 - val_loss: 3.0843 - val_accuracy30: 0.4716 - 124s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 122s - loss: 2.9446 - accuracy30: 0.5066 - val_loss: 3.0855 - val_accuracy30: 0.4719 - 122s/epoch - 21ms/step
Epoch 7/50
5759/5759 - 124s - loss: 2.9400 - accuracy30: 0.5078 - val_loss: 3.0874 - val_accuracy30: 0.4710 - 124s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 124s - loss: 2.9353 - accuracy30: 0.5090 - val_loss: 3.0712 - val_accuracy30: 0.4750 - 124s/epoch - 21ms/step
Epoch 9/50
5759/5759 - 123s - loss: 2.9312 - accuracy30: 0.5103 - val_loss: 3.0743 - val_accuracy30: 0.4744 - 123s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 123s - loss: 2.9272 - accuracy30: 0.5114 - val_loss: 3.0789 - val_accuracy30: 0.4728 - 123s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 121s - loss: 2.9242 - accuracy30: 0.5123 - val_loss: 3.0844 - val_accuracy30: 0.4717 - 121s/epoch - 21ms/step
Epoch 12/50
5759/5759 - 122s - loss: 2.9205 - accuracy30: 0.5132 - val_loss: 3.0966 - val_accuracy30: 0.4706 - 122s/epoch - 21ms/step
Epoch 13/50
5759/5759 - 124s - loss: 2.9172 - accuracy30: 0.5143 - val_loss: 3.0878 - val_accuracy30: 0.4733 - 124s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 123s - loss: 2.9146 - accuracy30: 0.5147 - val_loss: 3.0865 - val_accuracy30: 0.4734 - 123s/epoch - 21ms/step
Epoch 15/50
5759/5759 - 122s - loss: 2.9116 - accuracy30: 0.5156 - val_loss: 3.0820 - val_accuracy30: 0.4738 - 122s/epoch - 21ms/step
Epoch 16/50
5759/5759 - 121s - loss: 2.9088 - accuracy30: 0.5166 - val_loss: 3.0841 - val_accuracy30: 0.4741 - 121s/epoch - 21ms/step
Epoch 17/50
5759/5759 - 122s - loss: 2.9063 - accuracy30: 0.5175 - val_loss: 3.0910 - val_accuracy30: 0.4711 - 122s/epoch - 21ms/step
Epoch 18/50
5759/5759 - 123s - loss: 2.9043 - accuracy30: 0.5179 - val_loss: 3.0821 - val_accuracy30: 0.4737 - 123s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h30
Evaluating performance on  test set...
31315/31315 - 233s - 233s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0530312
{'0': {'precision': 0.46828067429410897, 'recall': 0.611588036734544, 'f1-score': 0.5304253291299657, 'support': 3105306}, '1': {'precision': 0.31484821619638653, 'recall': 0.33910658026532714, 'f1-score': 0.3265274678759721, 'support': 1731146}, '2': {'precision': 0.5404532195474483, 'recall': 0.35627693961281487, 'f1-score': 0.429451417680812, 'support': 3180029}, 'accuracy': 0.45146767016599926, 'macro avg': {'precision': 0.44119403667931456, 'recall': 0.435657185537562, 'f1-score': 0.42880140489558327, 'support': 8016481}, 'weighted avg': {'precision': 0.46377705241854933, 'recall': 0.45146767016599926, 'f1-score': 0.44633894090424087, 'support': 8016481}}
[[1899168  646131  560007]
 [ 740746  587043  403357]
 [1415705  631353 1132971]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0167515
{'0': {'precision': 0.5005184609117506, 'recall': 0.43706242825035974, 'f1-score': 0.4666430735501023, 'support': 494776}, '1': {'precision': 0.445230257518088, 'recall': 0.6424824958559093, 'f1-score': 0.5259709352372273, 'support': 485028}, '2': {'precision': 0.5126135629772275, 'recall': 0.3548416459836518, 'f1-score': 0.4193799024119687, 'support': 494367}, 'accuracy': 0.47707626862826635, 'macro avg': {'precision': 0.48612076046902203, 'recall': 0.47812885669664035, 'f1-score': 0.47066463706643275, 'support': 1474171}, 'weighted avg': {'precision': 0.48638379987662117, 'recall': 0.47707626862826635, 'f1-score': 0.4703131511546252, 'support': 1474171}}
[[216248 195993  82535]
 [ 89152 311622  84254]
 [126648 192297 175422]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0252955
{'0': {'precision': 0.48720175518785996, 'recall': 0.5015685290334724, 'f1-score': 0.4942807679228367, 'support': 191262}, '1': {'precision': 0.43670617338650125, 'recall': 0.5867339662303357, 'f1-score': 0.5007236579254434, 'support': 161269}, '2': {'precision': 0.5187530925284513, 'recall': 0.35417446260030766, 'f1-score': 0.42094924530458067, 'support': 192408}, 'accuracy': 0.474730199159906, 'macro avg': {'precision': 0.48088700703427084, 'recall': 0.4808256526213719, 'f1-score': 0.4719845570509536, 'support': 544939}, 'weighted avg': {'precision': 0.48339831614882106, 'recall': 0.474730199159906, 'f1-score': 0.47029545364710484, 'support': 544939}}
[[95931 61183 34148]
 [37576 94622 29071]
 [63395 60867 68146]]
training model: results/AAPL/W5/deepOF_L2/h50
Epoch 1/50
5759/5759 - 126s - loss: 3.1607 - accuracy50: 0.4346 - val_loss: 3.2977 - val_accuracy50: 0.3601 - 126s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 123s - loss: 3.1154 - accuracy50: 0.4536 - val_loss: 3.2317 - val_accuracy50: 0.4048 - 123s/epoch - 21ms/step
Epoch 3/50
5759/5759 - 123s - loss: 3.0943 - accuracy50: 0.4614 - val_loss: 3.2070 - val_accuracy50: 0.4185 - 123s/epoch - 21ms/step
Epoch 4/50
5759/5759 - 123s - loss: 3.0841 - accuracy50: 0.4650 - val_loss: 3.2092 - val_accuracy50: 0.4198 - 123s/epoch - 21ms/step
Epoch 5/50
5759/5759 - 122s - loss: 3.0772 - accuracy50: 0.4675 - val_loss: 3.2064 - val_accuracy50: 0.4222 - 122s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 123s - loss: 3.0721 - accuracy50: 0.4691 - val_loss: 3.2064 - val_accuracy50: 0.4237 - 123s/epoch - 21ms/step
Epoch 7/50
5759/5759 - 123s - loss: 3.0679 - accuracy50: 0.4705 - val_loss: 3.2099 - val_accuracy50: 0.4218 - 123s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 123s - loss: 3.0643 - accuracy50: 0.4719 - val_loss: 3.2068 - val_accuracy50: 0.4246 - 123s/epoch - 21ms/step
Epoch 9/50
5759/5759 - 122s - loss: 3.0616 - accuracy50: 0.4729 - val_loss: 3.2079 - val_accuracy50: 0.4255 - 122s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 124s - loss: 3.0587 - accuracy50: 0.4736 - val_loss: 3.2065 - val_accuracy50: 0.4256 - 124s/epoch - 22ms/step
Epoch 11/50
5759/5759 - 124s - loss: 3.0560 - accuracy50: 0.4745 - val_loss: 3.2063 - val_accuracy50: 0.4269 - 124s/epoch - 21ms/step
Epoch 12/50
5759/5759 - 124s - loss: 3.0539 - accuracy50: 0.4751 - val_loss: 3.2046 - val_accuracy50: 0.4288 - 124s/epoch - 21ms/step
Epoch 13/50
5759/5759 - 123s - loss: 3.0515 - accuracy50: 0.4761 - val_loss: 3.2018 - val_accuracy50: 0.4307 - 123s/epoch - 21ms/step
Epoch 14/50
5759/5759 - 125s - loss: 3.0500 - accuracy50: 0.4763 - val_loss: 3.1986 - val_accuracy50: 0.4317 - 125s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 124s - loss: 3.0475 - accuracy50: 0.4773 - val_loss: 3.1951 - val_accuracy50: 0.4325 - 124s/epoch - 22ms/step
Epoch 16/50
5759/5759 - 124s - loss: 3.0463 - accuracy50: 0.4780 - val_loss: 3.2011 - val_accuracy50: 0.4319 - 124s/epoch - 22ms/step
Epoch 17/50
5759/5759 - 125s - loss: 3.0437 - accuracy50: 0.4782 - val_loss: 3.1903 - val_accuracy50: 0.4354 - 125s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 123s - loss: 3.0423 - accuracy50: 0.4790 - val_loss: 3.1880 - val_accuracy50: 0.4358 - 123s/epoch - 21ms/step
Epoch 19/50
5759/5759 - 123s - loss: 3.0405 - accuracy50: 0.4799 - val_loss: 3.1929 - val_accuracy50: 0.4347 - 123s/epoch - 21ms/step
Epoch 20/50
5759/5759 - 124s - loss: 3.0388 - accuracy50: 0.4802 - val_loss: 3.1887 - val_accuracy50: 0.4363 - 124s/epoch - 21ms/step
Epoch 21/50
5759/5759 - 124s - loss: 3.0367 - accuracy50: 0.4811 - val_loss: 3.1891 - val_accuracy50: 0.4357 - 124s/epoch - 22ms/step
Epoch 22/50
5759/5759 - 123s - loss: 3.0348 - accuracy50: 0.4816 - val_loss: 3.1908 - val_accuracy50: 0.4354 - 123s/epoch - 21ms/step
Epoch 23/50
5759/5759 - 124s - loss: 3.0333 - accuracy50: 0.4820 - val_loss: 3.1876 - val_accuracy50: 0.4367 - 124s/epoch - 22ms/step
Epoch 24/50
5759/5759 - 124s - loss: 3.0318 - accuracy50: 0.4827 - val_loss: 3.1902 - val_accuracy50: 0.4368 - 124s/epoch - 21ms/step
Epoch 25/50
5759/5759 - 123s - loss: 3.0299 - accuracy50: 0.4835 - val_loss: 3.1887 - val_accuracy50: 0.4371 - 123s/epoch - 21ms/step
Epoch 26/50
5759/5759 - 124s - loss: 3.0283 - accuracy50: 0.4842 - val_loss: 3.1888 - val_accuracy50: 0.4373 - 124s/epoch - 21ms/step
Epoch 27/50
5759/5759 - 123s - loss: 3.0263 - accuracy50: 0.4842 - val_loss: 3.1908 - val_accuracy50: 0.4362 - 123s/epoch - 21ms/step
Epoch 28/50
5759/5759 - 124s - loss: 3.0246 - accuracy50: 0.4853 - val_loss: 3.1828 - val_accuracy50: 0.4382 - 124s/epoch - 22ms/step
Epoch 29/50
5759/5759 - 123s - loss: 3.0229 - accuracy50: 0.4857 - val_loss: 3.1999 - val_accuracy50: 0.4345 - 123s/epoch - 21ms/step
Epoch 30/50
5759/5759 - 125s - loss: 3.0214 - accuracy50: 0.4865 - val_loss: 3.1931 - val_accuracy50: 0.4358 - 125s/epoch - 22ms/step
Epoch 31/50
5759/5759 - 124s - loss: 3.0198 - accuracy50: 0.4870 - val_loss: 3.1942 - val_accuracy50: 0.4349 - 124s/epoch - 21ms/step
Epoch 32/50
5759/5759 - 123s - loss: 3.0180 - accuracy50: 0.4875 - val_loss: 3.1893 - val_accuracy50: 0.4361 - 123s/epoch - 21ms/step
Epoch 33/50
5759/5759 - 125s - loss: 3.0161 - accuracy50: 0.4880 - val_loss: 3.1909 - val_accuracy50: 0.4369 - 125s/epoch - 22ms/step
Epoch 34/50
5759/5759 - 123s - loss: 3.0147 - accuracy50: 0.4885 - val_loss: 3.1920 - val_accuracy50: 0.4368 - 123s/epoch - 21ms/step
Epoch 35/50
5759/5759 - 124s - loss: 3.0132 - accuracy50: 0.4890 - val_loss: 3.1909 - val_accuracy50: 0.4375 - 124s/epoch - 21ms/step
Epoch 36/50
5759/5759 - 123s - loss: 3.0116 - accuracy50: 0.4900 - val_loss: 3.2029 - val_accuracy50: 0.4335 - 123s/epoch - 21ms/step
Epoch 37/50
5759/5759 - 124s - loss: 3.0101 - accuracy50: 0.4903 - val_loss: 3.2014 - val_accuracy50: 0.4353 - 124s/epoch - 22ms/step
Epoch 38/50
5759/5759 - 124s - loss: 3.0081 - accuracy50: 0.4909 - val_loss: 3.1921 - val_accuracy50: 0.4373 - 124s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h50
Evaluating performance on  test set...
31315/31315 - 236s - 236s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0832345
{'0': {'precision': 0.4593812533202792, 'recall': 0.4890463780770174, 'f1-score': 0.4737498796018391, 'support': 3062503}, '1': {'precision': 0.2771100983990174, 'recall': 0.33237465816366685, 'f1-score': 0.3022368426357871, 'support': 1804226}, '2': {'precision': 0.4892794329994942, 'recall': 0.40266471773015783, 'f1-score': 0.44176659406027846, 'support': 3149752}, 'accuracy': 0.41984494193898797, 'macro avg': {'precision': 0.40859026157293027, 'recall': 0.40802858465694736, 'f1-score': 0.4059177720993015, 'support': 8016481}, 'weighted avg': {'precision': 0.4301057513240789, 'recall': 0.41984494193898797, 'f1-score': 0.42258182990095233, 'support': 8016481}}
[[1497706  776200  788597]
 [ 669271  599679  535276]
 [1093291  788167 1268294]]
Evaluating performance on  train set...
5759/5759 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0521985
{'0': {'precision': 0.5002605156802276, 'recall': 0.3567082232165091, 'f1-score': 0.41646102499235066, 'support': 497956}, '1': {'precision': 0.40091586204010754, 'recall': 0.6411421019393316, 'f1-score': 0.4933392332756748, 'support': 478206}, '2': {'precision': 0.47756249259232086, 'recall': 0.3398131359071824, 'f1-score': 0.3970806139580065, 'support': 498009}, 'accuracy': 0.4432681147573789, 'macro avg': {'precision': 0.459579623437552, 'recall': 0.44588782035434105, 'f1-score': 0.4356269574086773, 'support': 1474171}, 'weighted avg': {'precision': 0.46036620951180307, 'recall': 0.4432681147573789, 'f1-score': 0.43485237942242194, 'support': 1474171}}
[[177625 224237  96094]
 [ 82570 306598  89038]
 [ 94870 233909 169230]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0641208
{'0': {'precision': 0.47511481019334423, 'recall': 0.3922868173828073, 'f1-score': 0.4297462002763435, 'support': 188301}, '1': {'precision': 0.39673245860434536, 'recall': 0.5763234414010313, 'f1-score': 0.4699549447407598, 'support': 165421}, '2': {'precision': 0.4664659899974524, 'recall': 0.3638745509029009, 'f1-score': 0.4088325072933407, 'support': 191217}, 'accuracy': 0.43818298928870936, 'macro avg': {'precision': 0.4461044195983807, 'recall': 0.4441616032289131, 'f1-score': 0.43617788410348135, 'support': 544939}, 'weighted avg': {'precision': 0.44828632400754803, 'recall': 0.43818298928870936, 'f1-score': 0.4346133819001901, 'support': 544939}}
[[73868 70999 43434]
 [33936 95336 36149]
 [47670 73968 69579]]
training model: results/AAPL/W5/deepOF_L2/h100
Epoch 1/50
5759/5759 - 130s - loss: 3.1895 - accuracy100: 0.4198 - val_loss: 3.3736 - val_accuracy100: 0.3118 - 130s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 127s - loss: 3.1665 - accuracy100: 0.4298 - val_loss: 3.3693 - val_accuracy100: 0.3148 - 127s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 125s - loss: 3.1530 - accuracy100: 0.4348 - val_loss: 3.3804 - val_accuracy100: 0.3140 - 125s/epoch - 22ms/step
Epoch 4/50
5759/5759 - 124s - loss: 3.1444 - accuracy100: 0.4382 - val_loss: 3.3881 - val_accuracy100: 0.3152 - 124s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 125s - loss: 3.1385 - accuracy100: 0.4403 - val_loss: 3.3870 - val_accuracy100: 0.3153 - 125s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 124s - loss: 3.1338 - accuracy100: 0.4424 - val_loss: 3.3798 - val_accuracy100: 0.3151 - 124s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 124s - loss: 3.1300 - accuracy100: 0.4438 - val_loss: 3.3805 - val_accuracy100: 0.3165 - 124s/epoch - 22ms/step
Epoch 8/50
5759/5759 - 125s - loss: 3.1270 - accuracy100: 0.4451 - val_loss: 3.3791 - val_accuracy100: 0.3172 - 125s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 123s - loss: 3.1242 - accuracy100: 0.4458 - val_loss: 3.3784 - val_accuracy100: 0.3190 - 123s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 124s - loss: 3.1218 - accuracy100: 0.4474 - val_loss: 3.3677 - val_accuracy100: 0.3193 - 124s/epoch - 22ms/step
Epoch 11/50
5759/5759 - 124s - loss: 3.1193 - accuracy100: 0.4479 - val_loss: 3.3641 - val_accuracy100: 0.3225 - 124s/epoch - 21ms/step
Epoch 12/50
5759/5759 - 124s - loss: 3.1171 - accuracy100: 0.4490 - val_loss: 3.3531 - val_accuracy100: 0.3223 - 124s/epoch - 21ms/step
Epoch 13/50
5759/5759 - 124s - loss: 3.1149 - accuracy100: 0.4496 - val_loss: 3.3479 - val_accuracy100: 0.3269 - 124s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 124s - loss: 3.1127 - accuracy100: 0.4506 - val_loss: 3.3462 - val_accuracy100: 0.3275 - 124s/epoch - 21ms/step
Epoch 15/50
5759/5759 - 123s - loss: 3.1104 - accuracy100: 0.4514 - val_loss: 3.3426 - val_accuracy100: 0.3301 - 123s/epoch - 21ms/step
Epoch 16/50
5759/5759 - 124s - loss: 3.1083 - accuracy100: 0.4522 - val_loss: 3.3471 - val_accuracy100: 0.3271 - 124s/epoch - 21ms/step
Epoch 17/50
5759/5759 - 124s - loss: 3.1061 - accuracy100: 0.4533 - val_loss: 3.3432 - val_accuracy100: 0.3267 - 124s/epoch - 21ms/step
Epoch 18/50
5759/5759 - 125s - loss: 3.1035 - accuracy100: 0.4540 - val_loss: 3.3421 - val_accuracy100: 0.3308 - 125s/epoch - 22ms/step
Epoch 19/50
5759/5759 - 123s - loss: 3.1018 - accuracy100: 0.4545 - val_loss: 3.3423 - val_accuracy100: 0.3323 - 123s/epoch - 21ms/step
Epoch 20/50
5759/5759 - 124s - loss: 3.0992 - accuracy100: 0.4557 - val_loss: 3.3484 - val_accuracy100: 0.3322 - 124s/epoch - 22ms/step
Epoch 21/50
5759/5759 - 123s - loss: 3.0970 - accuracy100: 0.4565 - val_loss: 3.3467 - val_accuracy100: 0.3318 - 123s/epoch - 21ms/step
Epoch 22/50
5759/5759 - 123s - loss: 3.0952 - accuracy100: 0.4570 - val_loss: 3.3465 - val_accuracy100: 0.3401 - 123s/epoch - 21ms/step
Epoch 23/50
5759/5759 - 123s - loss: 3.0929 - accuracy100: 0.4580 - val_loss: 3.3469 - val_accuracy100: 0.3373 - 123s/epoch - 21ms/step
Epoch 24/50
5759/5759 - 123s - loss: 3.0897 - accuracy100: 0.4585 - val_loss: 3.3488 - val_accuracy100: 0.3333 - 123s/epoch - 21ms/step
Epoch 25/50
5759/5759 - 124s - loss: 3.0888 - accuracy100: 0.4590 - val_loss: 3.3575 - val_accuracy100: 0.3369 - 124s/epoch - 22ms/step
Epoch 26/50
5759/5759 - 123s - loss: 3.0856 - accuracy100: 0.4605 - val_loss: 3.3514 - val_accuracy100: 0.3377 - 123s/epoch - 21ms/step
Epoch 27/50
5759/5759 - 125s - loss: 3.0841 - accuracy100: 0.4609 - val_loss: 3.3600 - val_accuracy100: 0.3393 - 125s/epoch - 22ms/step
Epoch 28/50
5759/5759 - 123s - loss: 3.0821 - accuracy100: 0.4612 - val_loss: 3.3580 - val_accuracy100: 0.3407 - 123s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h100
Evaluating performance on  test set...
31315/31315 - 233s - 233s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1698967
{'0': {'precision': 0.5328381106952244, 'recall': 0.06686422585860217, 'f1-score': 0.118818305709231, 'support': 3319174}, '1': {'precision': 0.15916768782157636, 'recall': 0.8556740366986854, 'f1-score': 0.2684076830102096, 'support': 1276340}, '2': {'precision': 0.5387253946071262, 'recall': 0.11629021852593141, 'f1-score': 0.19128855132070005, 'support': 3420967}, 'accuracy': 0.21354631789185305, 'macro avg': {'precision': 0.41024373104130896, 'recall': 0.34627616036107295, 'f1-score': 0.19283818001338024, 'support': 8016481}, 'weighted avg': {'precision': 0.47585671155658676, 'recall': 0.21354631789185305, 'f1-score': 0.17356118160989883, 'support': 8016481}}
[[ 221934 2872634  224606]
 [  68184 1092131  116025]
 [ 126395 2896747  397825]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978298
{'0': {'precision': 0.5464363465615618, 'recall': 0.0780893198829565, 'f1-score': 0.13665040511544987, 'support': 491783}, '1': {'precision': 0.3355999013771533, 'recall': 0.8893043667637789, 'f1-score': 0.4873041355846718, 'support': 486722}, '2': {'precision': 0.4929115920441602, 'recall': 0.11349578143346528, 'f1-score': 0.18450760582227502, 'support': 495666}, 'accuracy': 0.35783026528130046, 'macro avg': {'precision': 0.4583159466609585, 'recall': 0.3602964893600669, 'f1-score': 0.2694873821741322, 'support': 1474171}, 'weighted avg': {'precision': 0.4588283707937112, 'recall': 0.35783026528130046, 'f1-score': 0.2685157533328479, 'support': 1474171}}
[[ 38403 430087  23293]
 [ 19297 432844  34581]
 [ 12579 426831  56256]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156734
{'0': {'precision': 0.48913906666043816, 'recall': 0.055797124617663674, 'f1-score': 0.10016788715687165, 'support': 187662}, '1': {'precision': 0.30568699529821264, 'recall': 0.8627042478712194, 'f1-score': 0.45141979778517577, 'support': 165118}, '2': {'precision': 0.4757642642381689, 'recall': 0.14246015018812547, 'f1-score': 0.21926487196533412, 'support': 192159}, 'accuracy': 0.33085171000790914, 'macro avg': {'precision': 0.4235301087322732, 'recall': 0.3536538408923362, 'f1-score': 0.25695085230246056, 'support': 544939}, 'weighted avg': {'precision': 0.4288363029055064, 'recall': 0.33085171000790914, 'f1-score': 0.24859472113816805, 'support': 544939}}
[[ 10471 163805  13386]
 [  5892 142448  16778]
 [  5044 159740  27375]]
training model: results/AAPL/W5/deepOF_L2/h200
Epoch 1/50
5759/5759 - 126s - loss: 3.2402 - accuracy200: 0.3950 - val_loss: 3.3253 - val_accuracy200: 0.3178 - 126s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 123s - loss: 3.2275 - accuracy200: 0.4018 - val_loss: 3.3203 - val_accuracy200: 0.3212 - 123s/epoch - 21ms/step
Epoch 3/50
5759/5759 - 124s - loss: 3.2185 - accuracy200: 0.4071 - val_loss: 3.3269 - val_accuracy200: 0.3225 - 124s/epoch - 22ms/step
Epoch 4/50
5759/5759 - 124s - loss: 3.2109 - accuracy200: 0.4110 - val_loss: 3.3369 - val_accuracy200: 0.3212 - 124s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 123s - loss: 3.2050 - accuracy200: 0.4142 - val_loss: 3.3397 - val_accuracy200: 0.3219 - 123s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 123s - loss: 3.2021 - accuracy200: 0.4151 - val_loss: 3.3396 - val_accuracy200: 0.3221 - 123s/epoch - 21ms/step
Epoch 7/50
5759/5759 - 123s - loss: 3.1991 - accuracy200: 0.4169 - val_loss: 3.3426 - val_accuracy200: 0.3241 - 123s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 124s - loss: 3.1967 - accuracy200: 0.4183 - val_loss: 3.3418 - val_accuracy200: 0.3255 - 124s/epoch - 21ms/step
Epoch 9/50
5759/5759 - 123s - loss: 3.1940 - accuracy200: 0.4194 - val_loss: 3.3482 - val_accuracy200: 0.3250 - 123s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 123s - loss: 3.1927 - accuracy200: 0.4202 - val_loss: 3.3461 - val_accuracy200: 0.3243 - 123s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 126s - loss: 3.1901 - accuracy200: 0.4215 - val_loss: 3.3459 - val_accuracy200: 0.3251 - 126s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 123s - loss: 3.1884 - accuracy200: 0.4227 - val_loss: 3.3495 - val_accuracy200: 0.3255 - 123s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h200
Evaluating performance on  test set...
31315/31315 - 237s - 237s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331574
{'0': {'precision': 0.45442282058117833, 'recall': 0.02831592555270825, 'f1-score': 0.053310006126831996, 'support': 3009861}, '1': {'precision': 0.2372271377952435, 'recall': 0.9626005223907256, 'f1-score': 0.38064627836895143, 'support': 1903556}, '2': {'precision': 0.4773845860358642, 'recall': 0.016128897115882883, 'f1-score': 0.03120355222600178, 'support': 3103064}, 'accuracy': 0.24544934367087004, 'macro avg': {'precision': 0.389678181470762, 'recall': 0.33568178168643886, 'f1-score': 0.15505327890726175, 'support': 8016481}, 'weighted avg': {'precision': 0.4117367196121392, 'recall': 0.24544934367087004, 'f1-score': 0.12248065391815016, 'support': 8016481}}
[[  85227 2896538   28096]
 [  44497 1832364   26695]
 [  57826 2995189   50049]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004341
{'0': {'precision': 0.4637502105913405, 'recall': 0.03385557061067529, 'f1-score': 0.06310428292237477, 'support': 487837}, '1': {'precision': 0.3304048504205625, 'recall': 0.9482731359129001, 'f1-score': 0.4900593378127201, 'support': 486981}, '2': {'precision': 0.44263537464857594, 'recall': 0.03625891904123937, 'f1-score': 0.06702723513580548, 'support': 499353}, 'accuracy': 0.33674044598625263, 'macro avg': {'precision': 0.41226347855349293, 'recall': 0.33946254185493824, 'f1-score': 0.2067302852903001, 'support': 1474171}, 'weighted avg': {'precision': 0.412548271661696, 'recall': 0.33674044598625263, 'f1-score': 0.2054744269166526, 'support': 1474171}}
[[ 16516 462801   8520]
 [ 10911 461791  14279]
 [  8187 473060  18106]]
Evaluating performance on  val set...
2129/2129 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076583
{'0': {'precision': 0.42205063043690744, 'recall': 0.023394791164375768, 'f1-score': 0.044332193714643586, 'support': 184571}, '1': {'precision': 0.31505240507013743, 'recall': 0.9478871847921473, 'f1-score': 0.47291911616531385, 'support': 172069}, '2': {'precision': 0.4343327454438566, 'recall': 0.03923547124520045, 'f1-score': 0.07196956782216074, 'support': 188299}, 'accuracy': 0.3207845281765482, 'macro avg': {'precision': 0.3904785936503005, 'recall': 0.33683914906724116, 'f1-score': 0.1964069592340394, 'support': 544939}, 'weighted avg': {'precision': 0.39250903464922987, 'recall': 0.3207845281765482, 'f1-score': 0.18921191982387003, 'support': 544939}}
[[  4318 176399   3854]
 [  3199 163102   5768]
 [  2714 178197   7388]]
training model: results/AAPL/W5/deepOF_L2/h300
Epoch 1/50
5759/5759 - 126s - loss: 3.2218 - accuracy300: 0.4047 - val_loss: 3.4874 - val_accuracy300: 0.3201 - 126s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 124s - loss: 3.2178 - accuracy300: 0.4060 - val_loss: 3.4678 - val_accuracy300: 0.3200 - 124s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 121s - loss: 3.2104 - accuracy300: 0.4092 - val_loss: 3.4643 - val_accuracy300: 0.3201 - 121s/epoch - 21ms/step
Epoch 4/50
5759/5759 - 122s - loss: 3.2015 - accuracy300: 0.4137 - val_loss: 3.4656 - val_accuracy300: 0.3200 - 122s/epoch - 21ms/step
Epoch 5/50
5759/5759 - 123s - loss: 3.1945 - accuracy300: 0.4169 - val_loss: 3.4661 - val_accuracy300: 0.3201 - 123s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 124s - loss: 3.1894 - accuracy300: 0.4197 - val_loss: 3.4783 - val_accuracy300: 0.3200 - 124s/epoch - 21ms/step
Epoch 7/50
5759/5759 - 124s - loss: 3.1862 - accuracy300: 0.4216 - val_loss: 3.4768 - val_accuracy300: 0.3201 - 124s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 123s - loss: 3.1833 - accuracy300: 0.4230 - val_loss: 3.4635 - val_accuracy300: 0.3203 - 123s/epoch - 21ms/step
Epoch 9/50
5759/5759 - 124s - loss: 3.1807 - accuracy300: 0.4244 - val_loss: 3.4757 - val_accuracy300: 0.3204 - 124s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 124s - loss: 3.1790 - accuracy300: 0.4254 - val_loss: 3.4665 - val_accuracy300: 0.3205 - 124s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 123s - loss: 3.1769 - accuracy300: 0.4264 - val_loss: 3.4708 - val_accuracy300: 0.3213 - 123s/epoch - 21ms/step
Epoch 12/50
5759/5759 - 124s - loss: 3.1750 - accuracy300: 0.4275 - val_loss: 3.4669 - val_accuracy300: 0.3213 - 124s/epoch - 22ms/step
Epoch 13/50
5759/5759 - 125s - loss: 3.1733 - accuracy300: 0.4280 - val_loss: 3.4633 - val_accuracy300: 0.3217 - 125s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 125s - loss: 3.1715 - accuracy300: 0.4290 - val_loss: 3.4449 - val_accuracy300: 0.3222 - 125s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 125s - loss: 3.1698 - accuracy300: 0.4299 - val_loss: 3.4485 - val_accuracy300: 0.3213 - 125s/epoch - 22ms/step
Epoch 16/50
5759/5759 - 125s - loss: 3.1688 - accuracy300: 0.4300 - val_loss: 3.4632 - val_accuracy300: 0.3207 - 125s/epoch - 22ms/step
Epoch 17/50
5759/5759 - 123s - loss: 3.1670 - accuracy300: 0.4308 - val_loss: 3.4520 - val_accuracy300: 0.3217 - 123s/epoch - 21ms/step
Epoch 18/50
5759/5759 - 123s - loss: 3.1655 - accuracy300: 0.4318 - val_loss: 3.4540 - val_accuracy300: 0.3219 - 123s/epoch - 21ms/step
Epoch 19/50
5759/5759 - 122s - loss: 3.1637 - accuracy300: 0.4325 - val_loss: 3.4512 - val_accuracy300: 0.3226 - 122s/epoch - 21ms/step
Epoch 20/50
5759/5759 - 123s - loss: 3.1617 - accuracy300: 0.4335 - val_loss: 3.4496 - val_accuracy300: 0.3224 - 123s/epoch - 21ms/step
Epoch 21/50
5759/5759 - 122s - loss: 3.1602 - accuracy300: 0.4341 - val_loss: 3.4524 - val_accuracy300: 0.3220 - 122s/epoch - 21ms/step
Epoch 22/50
5759/5759 - 124s - loss: 3.1582 - accuracy300: 0.4350 - val_loss: 3.4327 - val_accuracy300: 0.3246 - 124s/epoch - 21ms/step
Epoch 23/50
5759/5759 - 124s - loss: 3.1563 - accuracy300: 0.4357 - val_loss: 3.4310 - val_accuracy300: 0.3278 - 124s/epoch - 21ms/step
Epoch 24/50
5759/5759 - 124s - loss: 3.1544 - accuracy300: 0.4362 - val_loss: 3.4363 - val_accuracy300: 0.3261 - 124s/epoch - 22ms/step
Epoch 25/50
5759/5759 - 125s - loss: 3.1526 - accuracy300: 0.4368 - val_loss: 3.4489 - val_accuracy300: 0.3254 - 125s/epoch - 22ms/step
Epoch 26/50
5759/5759 - 126s - loss: 3.1511 - accuracy300: 0.4374 - val_loss: 3.4382 - val_accuracy300: 0.3259 - 126s/epoch - 22ms/step
Epoch 27/50
5759/5759 - 121s - loss: 3.1482 - accuracy300: 0.4388 - val_loss: 3.4240 - val_accuracy300: 0.3311 - 121s/epoch - 21ms/step
Epoch 28/50
5759/5759 - 124s - loss: 3.1465 - accuracy300: 0.4394 - val_loss: 3.4418 - val_accuracy300: 0.3301 - 124s/epoch - 21ms/step
Epoch 29/50
5759/5759 - 124s - loss: 3.1445 - accuracy300: 0.4408 - val_loss: 3.4416 - val_accuracy300: 0.3274 - 124s/epoch - 22ms/step
Epoch 30/50
5759/5759 - 124s - loss: 3.1436 - accuracy300: 0.4416 - val_loss: 3.4298 - val_accuracy300: 0.3280 - 124s/epoch - 22ms/step
Epoch 31/50
5759/5759 - 124s - loss: 3.1408 - accuracy300: 0.4423 - val_loss: 3.4482 - val_accuracy300: 0.3303 - 124s/epoch - 21ms/step
Epoch 32/50
5759/5759 - 124s - loss: 3.1385 - accuracy300: 0.4431 - val_loss: 3.4376 - val_accuracy300: 0.3303 - 124s/epoch - 21ms/step
Epoch 33/50
5759/5759 - 123s - loss: 3.1358 - accuracy300: 0.4448 - val_loss: 3.4341 - val_accuracy300: 0.3287 - 123s/epoch - 21ms/step
Epoch 34/50
5759/5759 - 123s - loss: 3.1333 - accuracy300: 0.4452 - val_loss: 3.4533 - val_accuracy300: 0.3330 - 123s/epoch - 21ms/step
Epoch 35/50
5759/5759 - 124s - loss: 3.1316 - accuracy300: 0.4457 - val_loss: 3.4246 - val_accuracy300: 0.3308 - 124s/epoch - 21ms/step
Epoch 36/50
5759/5759 - 123s - loss: 3.1292 - accuracy300: 0.4473 - val_loss: 3.4460 - val_accuracy300: 0.3301 - 123s/epoch - 21ms/step
Epoch 37/50
5759/5759 - 123s - loss: 3.1263 - accuracy300: 0.4482 - val_loss: 3.4488 - val_accuracy300: 0.3357 - 123s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h300
Evaluating performance on  test set...
31315/31315 - 233s - 233s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2006336
{'0': {'precision': 0.4359241076491842, 'recall': 0.08465577833079149, 'f1-score': 0.1417784114218233, 'support': 3178141}, '1': {'precision': 0.19899504489088074, 'recall': 0.9263659228677548, 'f1-score': 0.32761439873572773, 'support': 1587974}, '2': {'precision': 0.43880942060395894, 'recall': 0.0009343563155656933, 'f1-score': 0.001864742038389617, 'support': 3250366}, 'accuracy': 0.21744328964292436, 'macro avg': {'precision': 0.35790952438134127, 'recall': 0.3373186858380373, 'f1-score': 0.1570858507319802, 'support': 8016481}, 'weighted avg': {'precision': 0.390161026769058, 'recall': 0.21744328964292436, 'f1-score': 0.1218609541509405, 'support': 8016481}}
[[ 269048 2906553    2540]
 [ 115585 1471045    1344]
 [ 232557 3014772    3037]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1333165
{'0': {'precision': 0.46017568899810185, 'recall': 0.0639186720024199, 'f1-score': 0.11224627134855959, 'support': 489278}, '1': {'precision': 0.3341623630480659, 'recall': 0.9635135579158349, 'f1-score': 0.49622554004523534, 'support': 486948}, '2': {'precision': 0.4312181565539602, 'recall': 0.0018696844028959021, 'f1-score': 0.003723225569081631, 'support': 497945}, 'accuracy': 0.340113867387162, 'macro avg': {'precision': 0.40851873620004264, 'recall': 0.3431006381070502, 'f1-score': 0.20406501232095886, 'support': 1474171}, 'weighted avg': {'precision': 0.40876971537793416, 'recall': 0.340113867387162, 'f1-score': 0.2024253814400257, 'support': 1474171}}
[[ 31274 457422    582]
 [ 17121 469181    646]
 [ 19566 477448    931]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1430792
{'0': {'precision': 0.443928081669968, 'recall': 0.0633132140664642, 'f1-score': 0.11082107825656971, 'support': 184069}, '1': {'precision': 0.3249496340622471, 'recall': 0.9650088911833878, 'f1-score': 0.48618506706972564, 'support': 174330}, '2': {'precision': 0.375, 'recall': 0.0019620456738501124, 'f1-score': 0.003903666887092301, 'support': 186540}, 'accuracy': 0.3307709670256671, 'macro avg': {'precision': 0.38129257191073834, 'recall': 0.34342805030790075, 'f1-score': 0.20030327073779589, 'support': 544939}, 'weighted avg': {'precision': 0.38227098403854537, 'recall': 0.3307709670256671, 'f1-score': 0.1943035051941447, 'support': 544939}}
[[ 11654 172124    291]
 [  5781 168230    319]
 [  8817 177357    366]]
training model: results/AAPL/W5/deepOF_L2/h500
Epoch 1/50
5759/5759 - 127s - loss: 3.2485 - accuracy500: 0.3891 - val_loss: 3.4041 - val_accuracy500: 0.3026 - 127s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 123s - loss: 3.2405 - accuracy500: 0.3904 - val_loss: 3.3875 - val_accuracy500: 0.3025 - 123s/epoch - 21ms/step
Epoch 3/50
5759/5759 - 123s - loss: 3.2322 - accuracy500: 0.3964 - val_loss: 3.4103 - val_accuracy500: 0.3025 - 123s/epoch - 21ms/step
Epoch 4/50
5759/5759 - 121s - loss: 3.2253 - accuracy500: 0.4009 - val_loss: 3.4223 - val_accuracy500: 0.3025 - 121s/epoch - 21ms/step
Epoch 5/50
5759/5759 - 124s - loss: 3.2206 - accuracy500: 0.4035 - val_loss: 3.4330 - val_accuracy500: 0.3025 - 124s/epoch - 21ms/step
Epoch 6/50
5759/5759 - 124s - loss: 3.2177 - accuracy500: 0.4053 - val_loss: 3.4355 - val_accuracy500: 0.3025 - 124s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 124s - loss: 3.2157 - accuracy500: 0.4065 - val_loss: 3.4388 - val_accuracy500: 0.3025 - 124s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 123s - loss: 3.2136 - accuracy500: 0.4075 - val_loss: 3.4377 - val_accuracy500: 0.3025 - 123s/epoch - 21ms/step
Epoch 9/50
5759/5759 - 124s - loss: 3.2117 - accuracy500: 0.4087 - val_loss: 3.4303 - val_accuracy500: 0.3026 - 124s/epoch - 22ms/step
Epoch 10/50
5759/5759 - 121s - loss: 3.2102 - accuracy500: 0.4095 - val_loss: 3.4281 - val_accuracy500: 0.3026 - 121s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 122s - loss: 3.2087 - accuracy500: 0.4105 - val_loss: 3.4237 - val_accuracy500: 0.3026 - 122s/epoch - 21ms/step
Epoch 12/50
5759/5759 - 122s - loss: 3.2069 - accuracy500: 0.4117 - val_loss: 3.4204 - val_accuracy500: 0.3026 - 122s/epoch - 21ms/step
testing model: results/AAPL/W5/deepOF_L2/h500
Evaluating performance on  test set...
31315/31315 - 235s - 235s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1624646
{'0': {'precision': 0.5065530799475754, 'recall': 0.00025201087069918836, 'f1-score': 0.0005037711145593763, 'support': 3067328}, '1': {'precision': 0.23060233558390097, 'recall': 0.9994016657064104, 'f1-score': 0.37473757492914683, 'support': 1848465}, '2': {'precision': 0.43716679360243715, 'recall': 0.0005553606167405427, 'f1-score': 0.001109312004308408, 'support': 3100688}, 'accuracy': 0.2307563630475766, 'macro avg': {'precision': 0.3914407363779711, 'recall': 0.33340301239795006, 'f1-score': 0.12545021934933823, 'support': 8016481}, 'weighted avg': {'precision': 0.4160856394191024, 'recall': 0.2307563630475766, 'f1-score': 0.08702997650798396, 'support': 8016481}}
[[    773 3065140    1415]
 [    304 1847359     802]
 [    449 3098517    1722]]
Evaluating performance on  train set...
5759/5759 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1205423
{'0': {'precision': 0.4013961605584642, 'recall': 0.0004654843364520784, 'f1-score': 0.0009298903133730355, 'support': 494109}, '1': {'precision': 0.3276555515258699, 'recall': 0.9988302446962466, 'f1-score': 0.4934425617503821, 'support': 483007}, '2': {'precision': 0.40939597315436244, 'recall': 0.0009817827001036103, 'f1-score': 0.0019588677904734, 'support': 497055}, 'accuracy': 0.3277503084784601, 'macro avg': {'precision': 0.3794825617462321, 'recall': 0.3334258372442674, 'f1-score': 0.16544377328474283, 'support': 1474171}, 'weighted avg': {'precision': 0.3799326508997122, 'recall': 0.3277503084784601, 'f1-score': 0.16264690027534864, 'support': 1474171}}
[[   230 493552    327]
 [   188 482442    377]
 [   155 496412    488]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1321583
{'0': {'precision': 0.39147286821705424, 'recall': 0.0005352411234764176, 'f1-score': 0.0010690206289228293, 'support': 188700}, '1': {'precision': 0.30238588830322943, 'recall': 0.9984828532069449, 'f1-score': 0.4641930655848012, 'support': 164783}, '2': {'precision': 0.41061946902654867, 'recall': 0.0012117666722380076, 'f1-score': 0.002416402372657157, 'support': 191456}, 'accuracy': 0.30254028432540153, 'macro avg': {'precision': 0.36815940851561074, 'recall': 0.33340995366755316, 'f1-score': 0.15589282952879374, 'support': 544939}, 'weighted avg': {'precision': 0.37126090282908014, 'recall': 0.30254028432540153, 'f1-score': 0.1415855441647551, 'support': 544939}}
[[   101 188424    175]
 [    92 164533    158]
 [    65 191159    232]]
training model: results/AAPL/W5/deepOF_L2/h1000
Epoch 1/50
5759/5759 - 127s - loss: 3.2597 - accuracy1000: 0.3795 - val_loss: 3.3682 - val_accuracy1000: 0.2991 - 127s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 125s - loss: 3.2526 - accuracy1000: 0.3794 - val_loss: 3.3681 - val_accuracy1000: 0.2990 - 125s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 123s - loss: 3.2422 - accuracy1000: 0.3858 - val_loss: 3.3793 - val_accuracy1000: 0.2991 - 123s/epoch - 21ms/step
Epoch 4/50
5759/5759 - 123s - loss: 3.2377 - accuracy1000: 0.3888 - val_loss: 3.3869 - val_accuracy1000: 0.2991 - 123s/epoch - 21ms/step
Epoch 5/50
5759/5759 - 124s - loss: 3.2350 - accuracy1000: 0.3912 - val_loss: 3.3909 - val_accuracy1000: 0.2991 - 124s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 124s - loss: 3.2324 - accuracy1000: 0.3935 - val_loss: 3.3953 - val_accuracy1000: 0.2992 - 124s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 122s - loss: 3.2304 - accuracy1000: 0.3948 - val_loss: 3.3970 - val_accuracy1000: 0.2992 - 122s/epoch - 21ms/step
Epoch 8/50
5759/5759 - 124s - loss: 3.2285 - accuracy1000: 0.3961 - val_loss: 3.3988 - val_accuracy1000: 0.2992 - 124s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 123s - loss: 3.2270 - accuracy1000: 0.3975 - val_loss: 3.3988 - val_accuracy1000: 0.2992 - 123s/epoch - 21ms/step
Epoch 10/50
5759/5759 - 122s - loss: 3.2253 - accuracy1000: 0.3991 - val_loss: 3.3978 - val_accuracy1000: 0.2992 - 122s/epoch - 21ms/step
Epoch 11/50
5759/5759 - 124s - loss: 3.2240 - accuracy1000: 0.3998 - val_loss: 3.4004 - val_accuracy1000: 0.2992 - 124s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 124s - loss: 3.2227 - accuracy1000: 0.4010 - val_loss: 3.3981 - val_accuracy1000: 0.2992 - 124s/epoch - 22ms/step
testing model: results/AAPL/W5/deepOF_L2/h1000
Evaluating performance on  test set...
31315/31315 - 234s - 234s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1580611
{'0': {'precision': 0.5535524920466596, 'recall': 0.00016880595335264147, 'f1-score': 0.0003375089832671193, 'support': 3092308}, '1': {'precision': 0.22745339747256813, 'recall': 0.9998184647160673, 'f1-score': 0.37059776837044855, 'support': 1823337}, '2': {'precision': 0.3162518301610542, 'recall': 6.965863399418738e-05, 'f1-score': 0.00013928658828141956, 'support': 3100836}, 'accuracy': 0.2274993229572926, 'macro avg': {'precision': 0.36575257322676064, 'recall': 0.33335230976780467, 'f1-score': 0.12369152131399903, 'support': 8016481}, 'weighted avg': {'precision': 0.3875920188662013, 'recall': 0.2274993229572926, 'f1-score': 0.08447599511351148, 'support': 8016481}}
[[    522 3091467     319]
 [    183 1823006     148]
 [    238 3100382     216]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1225406
{'0': {'precision': 0.3378640776699029, 'recall': 0.0003443069635093982, 'f1-score': 0.0006879128959946865, 'support': 505363}, '1': {'precision': 0.3198641426841256, 'recall': 0.9991326917938648, 'f1-score': 0.4845905820764274, 'support': 471574}, '2': {'precision': 0.35, 'recall': 0.00045049212242123426, 'f1-score': 0.0008998260604088585, 'support': 497234}, 'accuracy': 0.3198835141920442, 'macro avg': {'precision': 0.3359094067846762, 'recall': 0.33330916362659846, 'f1-score': 0.16205944034427697, 'support': 1474171}, 'weighted avg': {'precision': 0.33619947557347074, 'recall': 0.3198835141920442, 'f1-score': 0.15555548778824782, 'support': 1474171}}
[[   174 504983    206]
 [   199 471165    210]
 [   142 496868    224]]
Evaluating performance on  val set...
2129/2129 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1293439
{'0': {'precision': 0.39344262295081966, 'recall': 0.00038395494928595046, 'f1-score': 0.0007671612370474947, 'support': 187522}, '1': {'precision': 0.29898484241918954, 'recall': 0.999232827613296, 'f1-score': 0.4602548192038808, 'support': 162936}, '2': {'precision': 0.2857142857142857, 'recall': 0.00030851342804695574, 'f1-score': 0.0006163613110005085, 'support': 194481}, 'accuracy': 0.29901144898786836, 'macro avg': {'precision': 0.3260472503614316, 'recall': 0.3333084319968763, 'f1-score': 0.15387944725064293, 'support': 544939}, 'weighted avg': {'precision': 0.32675316287767375, 'recall': 0.29901144898786836, 'f1-score': 0.13809951094603587, 'support': 544939}}
[[    72 187370     80]
 [    55 162811     70]
 [    56 194365     60]]
training model: results/AAPL/W5/deepVOL_L2/h10
Epoch 1/50
5759/5759 - 133s - loss: 2.9735 - accuracy10: 0.4858 - val_loss: 3.0730 - val_accuracy10: 0.5010 - 133s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 140s - loss: 2.8641 - accuracy10: 0.5185 - val_loss: 3.0371 - val_accuracy10: 0.5170 - 140s/epoch - 24ms/step
Epoch 3/50
5759/5759 - 142s - loss: 2.8167 - accuracy10: 0.5299 - val_loss: 2.9928 - val_accuracy10: 0.5154 - 142s/epoch - 25ms/step
Epoch 4/50
5759/5759 - 130s - loss: 2.7867 - accuracy10: 0.5373 - val_loss: 2.9756 - val_accuracy10: 0.5230 - 130s/epoch - 23ms/step
Epoch 5/50
5759/5759 - 138s - loss: 2.7688 - accuracy10: 0.5412 - val_loss: 2.9722 - val_accuracy10: 0.5251 - 138s/epoch - 24ms/step
Epoch 6/50
5759/5759 - 138s - loss: 2.7549 - accuracy10: 0.5445 - val_loss: 2.9516 - val_accuracy10: 0.5269 - 138s/epoch - 24ms/step
Epoch 7/50
5759/5759 - 127s - loss: 2.7457 - accuracy10: 0.5471 - val_loss: 2.9375 - val_accuracy10: 0.5288 - 127s/epoch - 22ms/step
Epoch 8/50
5759/5759 - 135s - loss: 2.7363 - accuracy10: 0.5484 - val_loss: 2.9369 - val_accuracy10: 0.5279 - 135s/epoch - 23ms/step
Epoch 9/50
5759/5759 - 140s - loss: 2.7291 - accuracy10: 0.5502 - val_loss: 2.9344 - val_accuracy10: 0.5275 - 140s/epoch - 24ms/step
Epoch 10/50
5759/5759 - 140s - loss: 2.7226 - accuracy10: 0.5517 - val_loss: 2.9224 - val_accuracy10: 0.5336 - 140s/epoch - 24ms/step
Epoch 11/50
5759/5759 - 141s - loss: 2.7167 - accuracy10: 0.5527 - val_loss: 2.9199 - val_accuracy10: 0.5311 - 141s/epoch - 24ms/step
Epoch 12/50
5759/5759 - 132s - loss: 2.7116 - accuracy10: 0.5538 - val_loss: 2.9158 - val_accuracy10: 0.5341 - 132s/epoch - 23ms/step
Epoch 13/50
5759/5759 - 131s - loss: 2.7076 - accuracy10: 0.5551 - val_loss: 2.9058 - val_accuracy10: 0.5367 - 131s/epoch - 23ms/step
Epoch 14/50
5759/5759 - 146s - loss: 2.7035 - accuracy10: 0.5555 - val_loss: 2.9064 - val_accuracy10: 0.5403 - 146s/epoch - 25ms/step
Epoch 15/50
5759/5759 - 139s - loss: 2.6997 - accuracy10: 0.5566 - val_loss: 2.9070 - val_accuracy10: 0.5385 - 139s/epoch - 24ms/step
Epoch 16/50
5759/5759 - 127s - loss: 2.6957 - accuracy10: 0.5573 - val_loss: 2.9069 - val_accuracy10: 0.5401 - 127s/epoch - 22ms/step
Epoch 17/50
5759/5759 - 136s - loss: 2.6925 - accuracy10: 0.5584 - val_loss: 2.8973 - val_accuracy10: 0.5389 - 136s/epoch - 24ms/step
Epoch 18/50
5759/5759 - 137s - loss: 2.6893 - accuracy10: 0.5592 - val_loss: 2.8988 - val_accuracy10: 0.5413 - 137s/epoch - 24ms/step
Epoch 19/50
5759/5759 - 128s - loss: 2.6866 - accuracy10: 0.5597 - val_loss: 2.8971 - val_accuracy10: 0.5399 - 128s/epoch - 22ms/step
Epoch 20/50
5759/5759 - 132s - loss: 2.6844 - accuracy10: 0.5601 - val_loss: 2.9011 - val_accuracy10: 0.5396 - 132s/epoch - 23ms/step
Epoch 21/50
5759/5759 - 143s - loss: 2.6817 - accuracy10: 0.5607 - val_loss: 2.8980 - val_accuracy10: 0.5403 - 143s/epoch - 25ms/step
Epoch 22/50
5759/5759 - 139s - loss: 2.6795 - accuracy10: 0.5613 - val_loss: 2.8996 - val_accuracy10: 0.5416 - 139s/epoch - 24ms/step
Epoch 23/50
5759/5759 - 135s - loss: 2.6770 - accuracy10: 0.5618 - val_loss: 2.8970 - val_accuracy10: 0.5414 - 135s/epoch - 23ms/step
Epoch 24/50
5759/5759 - 121s - loss: 2.6756 - accuracy10: 0.5624 - val_loss: 2.8951 - val_accuracy10: 0.5421 - 121s/epoch - 21ms/step
Epoch 25/50
5759/5759 - 131s - loss: 2.6731 - accuracy10: 0.5627 - val_loss: 2.8973 - val_accuracy10: 0.5429 - 131s/epoch - 23ms/step
Epoch 26/50
5759/5759 - 141s - loss: 2.6713 - accuracy10: 0.5635 - val_loss: 2.8982 - val_accuracy10: 0.5425 - 141s/epoch - 25ms/step
Epoch 27/50
5759/5759 - 127s - loss: 2.6688 - accuracy10: 0.5639 - val_loss: 2.8932 - val_accuracy10: 0.5428 - 127s/epoch - 22ms/step
Epoch 28/50
5759/5759 - 148s - loss: 2.6674 - accuracy10: 0.5644 - val_loss: 2.9036 - val_accuracy10: 0.5430 - 148s/epoch - 26ms/step
Epoch 29/50
5759/5759 - 140s - loss: 2.6653 - accuracy10: 0.5648 - val_loss: 2.9066 - val_accuracy10: 0.5424 - 140s/epoch - 24ms/step
Epoch 30/50
5759/5759 - 143s - loss: 2.6640 - accuracy10: 0.5650 - val_loss: 2.9027 - val_accuracy10: 0.5427 - 143s/epoch - 25ms/step
Epoch 31/50
5759/5759 - 141s - loss: 2.6617 - accuracy10: 0.5656 - val_loss: 2.9015 - val_accuracy10: 0.5425 - 141s/epoch - 25ms/step
Epoch 32/50
5759/5759 - 134s - loss: 2.6595 - accuracy10: 0.5660 - val_loss: 2.9020 - val_accuracy10: 0.5432 - 134s/epoch - 23ms/step
Epoch 33/50
5759/5759 - 137s - loss: 2.6583 - accuracy10: 0.5664 - val_loss: 2.9010 - val_accuracy10: 0.5424 - 137s/epoch - 24ms/step
Epoch 34/50
5759/5759 - 138s - loss: 2.6563 - accuracy10: 0.5669 - val_loss: 2.9071 - val_accuracy10: 0.5424 - 138s/epoch - 24ms/step
Epoch 35/50
5759/5759 - 127s - loss: 2.6544 - accuracy10: 0.5673 - val_loss: 2.9018 - val_accuracy10: 0.5431 - 127s/epoch - 22ms/step
Epoch 36/50
5759/5759 - 132s - loss: 2.6532 - accuracy10: 0.5674 - val_loss: 2.9070 - val_accuracy10: 0.5420 - 132s/epoch - 23ms/step
Epoch 37/50
5759/5759 - 131s - loss: 2.6514 - accuracy10: 0.5679 - val_loss: 2.9097 - val_accuracy10: 0.5416 - 131s/epoch - 23ms/step
testing model: results/AAPL/W5/deepVOL_L2/h10
Evaluating performance on  test set...
31315/31315 - 299s - 299s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0093303
{'0': {'precision': 0.4938963409707771, 'recall': 0.6396735543456858, 'f1-score': 0.5574114648111853, 'support': 2828771}, '1': {'precision': 0.5379737744660129, 'recall': 0.264181568809774, 'f1-score': 0.3543522010002593, 'support': 2325113}, '2': {'precision': 0.5192320508851777, 'recall': 0.5824250105323758, 'f1-score': 0.5490161018283074, 'support': 2862602}, 'accuracy': 0.5103224779535572, 'macro avg': {'precision': 0.5170340554406558, 'recall': 0.49542671122927856, 'f1-score': 0.48692658921325066, 'support': 8016486}, 'weighted avg': {'precision': 0.515727735362134, 'recall': 0.5103224779535572, 'f1-score': 0.49551797221072097, 'support': 8016486}}
[[1809490  283736  735545]
 [ 902663  614252  808198]
 [ 951551  243800 1667251]]
Evaluating performance on  train set...
5759/5759 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9379894
{'0': {'precision': 0.4874390587856078, 'recall': 0.5829819531118232, 'f1-score': 0.5309465553373344, 'support': 415030}, '1': {'precision': 0.6621015247424862, 'recall': 0.5071688106100267, 'f1-score': 0.5743705842079632, 'support': 641808}, '2': {'precision': 0.48611385364729887, 'recall': 0.5662922263702455, 'f1-score': 0.5231488142804332, 'support': 417334}, 'accuracy': 0.5452504863747243, 'macro avg': {'precision': 0.5452181457251309, 'recall': 0.5521476633640318, 'f1-score': 0.5428219846085769, 'support': 1474172}, 'weighted avg': {'precision': 0.5631064264941663, 'recall': 0.5452504863747243, 'f1-score': 0.5476444892657767, 'support': 1474172}}
[[241955  87885  85190]
 [151658 325505 164645]
 [102767  78234 236333]]
Evaluating performance on  val set...
2129/2129 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95088017
{'0': {'precision': 0.49540204159084494, 'recall': 0.6000412529098035, 'f1-score': 0.5427239606514733, 'support': 169685}, '1': {'precision': 0.6394188179220682, 'recall': 0.4951138334307507, 'f1-score': 0.5580890100106995, 'support': 207013}, '2': {'precision': 0.5103561857972309, 'recall': 0.5433542159508328, 'f1-score': 0.5263385171665294, 'support': 168242}, 'accuracy': 0.542679928065475, 'macro avg': {'precision': 0.5483923484367147, 'recall': 0.5461697674304623, 'f1-score': 0.5423838292762341, 'support': 544940}, 'weighted avg': {'precision': 0.5547283161315766, 'recall': 0.542679928065475, 'f1-score': 0.5435021108702268, 'support': 544940}}
[[101818  30887  36980]
 [ 53793 102495  50725]
 [ 49915  26912  91415]]
training model: results/AAPL/W5/deepVOL_L2/h20
Epoch 1/50
5759/5759 - 122s - loss: 3.0169 - accuracy20: 0.4811 - val_loss: 3.0746 - val_accuracy20: 0.4858 - 122s/epoch - 21ms/step
Epoch 2/50
5759/5759 - 130s - loss: 2.9425 - accuracy20: 0.5069 - val_loss: 3.0401 - val_accuracy20: 0.4960 - 130s/epoch - 23ms/step
Epoch 3/50
5759/5759 - 139s - loss: 2.9106 - accuracy20: 0.5159 - val_loss: 3.0291 - val_accuracy20: 0.4943 - 139s/epoch - 24ms/step
Epoch 4/50
5759/5759 - 127s - loss: 2.8869 - accuracy20: 0.5211 - val_loss: 2.9980 - val_accuracy20: 0.5024 - 127s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 139s - loss: 2.8717 - accuracy20: 0.5242 - val_loss: 3.0016 - val_accuracy20: 0.5002 - 139s/epoch - 24ms/step
Epoch 6/50
5759/5759 - 135s - loss: 2.8591 - accuracy20: 0.5277 - val_loss: 2.9888 - val_accuracy20: 0.5037 - 135s/epoch - 23ms/step
Epoch 7/50
5759/5759 - 135s - loss: 2.8496 - accuracy20: 0.5300 - val_loss: 2.9783 - val_accuracy20: 0.5075 - 135s/epoch - 23ms/step
Epoch 8/50
5759/5759 - 138s - loss: 2.8422 - accuracy20: 0.5319 - val_loss: 2.9594 - val_accuracy20: 0.5122 - 138s/epoch - 24ms/step
Epoch 9/50
5759/5759 - 144s - loss: 2.8364 - accuracy20: 0.5335 - val_loss: 2.9828 - val_accuracy20: 0.5083 - 144s/epoch - 25ms/step
Epoch 10/50
5759/5759 - 134s - loss: 2.8311 - accuracy20: 0.5347 - val_loss: 2.9607 - val_accuracy20: 0.5128 - 134s/epoch - 23ms/step
Epoch 11/50
5759/5759 - 134s - loss: 2.8268 - accuracy20: 0.5359 - val_loss: 2.9531 - val_accuracy20: 0.5134 - 134s/epoch - 23ms/step
Epoch 12/50
5759/5759 - 139s - loss: 2.8225 - accuracy20: 0.5370 - val_loss: 2.9463 - val_accuracy20: 0.5167 - 139s/epoch - 24ms/step
Epoch 13/50
5759/5759 - 134s - loss: 2.8192 - accuracy20: 0.5378 - val_loss: 2.9474 - val_accuracy20: 0.5158 - 134s/epoch - 23ms/step
Epoch 14/50
5759/5759 - 139s - loss: 2.8159 - accuracy20: 0.5387 - val_loss: 2.9480 - val_accuracy20: 0.5154 - 139s/epoch - 24ms/step
Epoch 15/50
5759/5759 - 137s - loss: 2.8132 - accuracy20: 0.5390 - val_loss: 2.9467 - val_accuracy20: 0.5158 - 137s/epoch - 24ms/step
Epoch 16/50
5759/5759 - 141s - loss: 2.8102 - accuracy20: 0.5401 - val_loss: 2.9429 - val_accuracy20: 0.5178 - 141s/epoch - 24ms/step
Epoch 17/50
5759/5759 - 130s - loss: 2.8079 - accuracy20: 0.5408 - val_loss: 2.9461 - val_accuracy20: 0.5172 - 130s/epoch - 22ms/step
Epoch 18/50
5759/5759 - 130s - loss: 2.8055 - accuracy20: 0.5411 - val_loss: 2.9382 - val_accuracy20: 0.5188 - 130s/epoch - 23ms/step
Epoch 19/50
5759/5759 - 132s - loss: 2.8034 - accuracy20: 0.5416 - val_loss: 2.9377 - val_accuracy20: 0.5187 - 132s/epoch - 23ms/step
Epoch 20/50
5759/5759 - 132s - loss: 2.8013 - accuracy20: 0.5421 - val_loss: 2.9294 - val_accuracy20: 0.5213 - 132s/epoch - 23ms/step
Epoch 21/50
5759/5759 - 135s - loss: 2.7989 - accuracy20: 0.5429 - val_loss: 2.9351 - val_accuracy20: 0.5194 - 135s/epoch - 24ms/step
Epoch 22/50
5759/5759 - 130s - loss: 2.7974 - accuracy20: 0.5430 - val_loss: 2.9391 - val_accuracy20: 0.5178 - 130s/epoch - 23ms/step
Epoch 23/50
5759/5759 - 126s - loss: 2.7952 - accuracy20: 0.5435 - val_loss: 2.9306 - val_accuracy20: 0.5201 - 126s/epoch - 22ms/step
Epoch 24/50
5759/5759 - 125s - loss: 2.7935 - accuracy20: 0.5440 - val_loss: 2.9284 - val_accuracy20: 0.5214 - 125s/epoch - 22ms/step
Epoch 25/50
5759/5759 - 133s - loss: 2.7915 - accuracy20: 0.5445 - val_loss: 2.9289 - val_accuracy20: 0.5213 - 133s/epoch - 23ms/step
Epoch 26/50
5759/5759 - 131s - loss: 2.7903 - accuracy20: 0.5446 - val_loss: 2.9173 - val_accuracy20: 0.5238 - 131s/epoch - 23ms/step
Epoch 27/50
5759/5759 - 136s - loss: 2.7881 - accuracy20: 0.5453 - val_loss: 2.9250 - val_accuracy20: 0.5215 - 136s/epoch - 24ms/step
Epoch 28/50
5759/5759 - 136s - loss: 2.7865 - accuracy20: 0.5457 - val_loss: 2.9350 - val_accuracy20: 0.5200 - 136s/epoch - 24ms/step
Epoch 29/50
5759/5759 - 124s - loss: 2.7852 - accuracy20: 0.5461 - val_loss: 2.9261 - val_accuracy20: 0.5219 - 124s/epoch - 22ms/step
Epoch 30/50
5759/5759 - 134s - loss: 2.7835 - accuracy20: 0.5464 - val_loss: 2.9268 - val_accuracy20: 0.5226 - 134s/epoch - 23ms/step
Epoch 31/50
5759/5759 - 126s - loss: 2.7826 - accuracy20: 0.5466 - val_loss: 2.9253 - val_accuracy20: 0.5221 - 126s/epoch - 22ms/step
Epoch 32/50
5759/5759 - 133s - loss: 2.7808 - accuracy20: 0.5472 - val_loss: 2.9271 - val_accuracy20: 0.5222 - 133s/epoch - 23ms/step
Epoch 33/50
5759/5759 - 131s - loss: 2.7795 - accuracy20: 0.5475 - val_loss: 2.9275 - val_accuracy20: 0.5222 - 131s/epoch - 23ms/step
Epoch 34/50
5759/5759 - 136s - loss: 2.7783 - accuracy20: 0.5477 - val_loss: 2.9224 - val_accuracy20: 0.5238 - 136s/epoch - 24ms/step
Epoch 35/50
5759/5759 - 134s - loss: 2.7767 - accuracy20: 0.5478 - val_loss: 2.9234 - val_accuracy20: 0.5234 - 134s/epoch - 23ms/step
Epoch 36/50
5759/5759 - 137s - loss: 2.7752 - accuracy20: 0.5486 - val_loss: 2.9249 - val_accuracy20: 0.5235 - 137s/epoch - 24ms/step
testing model: results/AAPL/W5/deepVOL_L2/h20
Evaluating performance on  test set...
31315/31315 - 298s - 298s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0054513
{'0': {'precision': 0.5068980519591243, 'recall': 0.6253249681684974, 'f1-score': 0.5599179712319997, 'support': 3137615}, '1': {'precision': 0.40568328645382634, 'recall': 0.2845508514034854, 'f1-score': 0.3344880185699076, 'support': 1683808}, '2': {'precision': 0.5495408437573572, 'recall': 0.5099339199258356, 'f1-score': 0.5289970582071086, 'support': 3195063}, 'accuracy': 0.5077572642177632, 'macro avg': {'precision': 0.487374060723436, 'recall': 0.47326991316593947, 'f1-score': 0.47446768266967193, 'support': 8016486}, 'weighted avg': {'precision': 0.5026343601639028, 'recall': 0.5077572642177632, 'f1-score': 0.5002440663734246, 'support': 8016486}}
[[1962029  364093  811493]
 [ 680657  479129  524022]
 [1227972  337820 1629271]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9668055
{'0': {'precision': 0.5137871619480093, 'recall': 0.5485847189434975, 'f1-score': 0.530616050563202, 'support': 487571}, '1': {'precision': 0.5383173460768546, 'recall': 0.5611626205199547, 'f1-score': 0.549502640836406, 'support': 497428}, '2': {'precision': 0.5324647561953931, 'recall': 0.47354208020475375, 'f1-score': 0.5012778425775849, 'support': 489173}, 'accuracy': 0.5279275416979837, 'macro avg': {'precision': 0.5281897547400857, 'recall': 0.5277631398894019, 'f1-score': 0.5271321779923976, 'support': 1474172}, 'weighted avg': {'precision': 0.5282621182228665, 'recall': 0.5279275416979837, 'f1-score': 0.5272536611076101, 'support': 1474172}}
[[267474 122072  98025]
 [112918 279138 105372]
 [140201 117328 231644]]
Evaluating performance on  val set...
2129/2129 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97187066
{'0': {'precision': 0.5121120858976038, 'recall': 0.5687722687940832, 'f1-score': 0.5389571080542364, 'support': 192534}, '1': {'precision': 0.5182902630903191, 'recall': 0.5551124501506419, 'f1-score': 0.5360697793740379, 'support': 159982}, '2': {'precision': 0.5464833871654273, 'recall': 0.45370639837026566, 'f1-score': 0.49579192458401955, 'support': 192424}, 'accuracy': 0.5241310970015047, 'macro avg': {'precision': 0.5256285787177835, 'recall': 0.5258637057716635, 'f1-score': 0.5236062706707646, 'support': 544940}, 'weighted avg': {'precision': 0.5260627234334879, 'recall': 0.5241310970015047, 'f1-score': 0.5228673772930728, 'support': 544940}}
[[109508  42308  40718]
 [ 39440  88808  31734]
 [ 64888  40232  87304]]
training model: results/AAPL/W5/deepVOL_L2/h30
Epoch 1/50
5759/5759 - 134s - loss: 3.0887 - accuracy30: 0.4596 - val_loss: 3.1265 - val_accuracy30: 0.4606 - 134s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 139s - loss: 3.0300 - accuracy30: 0.4830 - val_loss: 3.1041 - val_accuracy30: 0.4704 - 139s/epoch - 24ms/step
Epoch 3/50
5759/5759 - 135s - loss: 3.0060 - accuracy30: 0.4908 - val_loss: 3.0792 - val_accuracy30: 0.4746 - 135s/epoch - 24ms/step
Epoch 4/50
5759/5759 - 139s - loss: 2.9867 - accuracy30: 0.4962 - val_loss: 3.0660 - val_accuracy30: 0.4768 - 139s/epoch - 24ms/step
Epoch 5/50
5759/5759 - 129s - loss: 2.9750 - accuracy30: 0.4996 - val_loss: 3.0600 - val_accuracy30: 0.4771 - 129s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 135s - loss: 2.9664 - accuracy30: 0.5017 - val_loss: 3.0478 - val_accuracy30: 0.4803 - 135s/epoch - 23ms/step
Epoch 7/50
5759/5759 - 140s - loss: 2.9592 - accuracy30: 0.5035 - val_loss: 3.0579 - val_accuracy30: 0.4776 - 140s/epoch - 24ms/step
Epoch 8/50
5759/5759 - 132s - loss: 2.9526 - accuracy30: 0.5057 - val_loss: 3.0572 - val_accuracy30: 0.4784 - 132s/epoch - 23ms/step
Epoch 9/50
5759/5759 - 129s - loss: 2.9475 - accuracy30: 0.5070 - val_loss: 3.0630 - val_accuracy30: 0.4774 - 129s/epoch - 22ms/step
Epoch 10/50
5759/5759 - 130s - loss: 2.9426 - accuracy30: 0.5081 - val_loss: 3.0516 - val_accuracy30: 0.4815 - 130s/epoch - 23ms/step
Epoch 11/50
5759/5759 - 137s - loss: 2.9386 - accuracy30: 0.5090 - val_loss: 3.0509 - val_accuracy30: 0.4821 - 137s/epoch - 24ms/step
Epoch 12/50
5759/5759 - 130s - loss: 2.9343 - accuracy30: 0.5103 - val_loss: 3.0494 - val_accuracy30: 0.4825 - 130s/epoch - 23ms/step
Epoch 13/50
5759/5759 - 136s - loss: 2.9310 - accuracy30: 0.5112 - val_loss: 3.0490 - val_accuracy30: 0.4827 - 136s/epoch - 24ms/step
Epoch 14/50
5759/5759 - 130s - loss: 2.9278 - accuracy30: 0.5121 - val_loss: 3.0513 - val_accuracy30: 0.4824 - 130s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 134s - loss: 2.9251 - accuracy30: 0.5126 - val_loss: 3.0562 - val_accuracy30: 0.4825 - 134s/epoch - 23ms/step
Epoch 16/50
5759/5759 - 125s - loss: 2.9225 - accuracy30: 0.5133 - val_loss: 3.0518 - val_accuracy30: 0.4840 - 125s/epoch - 22ms/step
testing model: results/AAPL/W5/deepVOL_L2/h30
Evaluating performance on  test set...
31315/31315 - 280s - 280s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.04472
{'0': {'precision': 0.4936124298519565, 'recall': 0.48144629682704787, 'f1-score': 0.4874534628892371, 'support': 3105310}, '1': {'precision': 0.3002190065374597, 'recall': 0.317851873845418, 'f1-score': 0.3087839172517823, 'support': 1731146}, '2': {'precision': 0.5091928691038772, 'recall': 0.5051675613123147, 'f1-score': 0.5071722283513874, 'support': 3180030}, 'accuracy': 0.45552827011735564, 'macro avg': {'precision': 0.4343414351644312, 'recall': 0.43482191066159354, 'f1-score': 0.43446986949746896, 'support': 8016486}, 'weighted avg': {'precision': 0.4580300079575114, 'recall': 0.45552827011735564, 'f1-score': 0.4566922536113196, 'support': 8016486}}
[[1495040  661421  948849]
 [ 581304  550248  599594]
 [ 952429  621153 1606448]]
Evaluating performance on  train set...
5759/5759 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.014156
{'0': {'precision': 0.5015734541875752, 'recall': 0.4169258924098702, 'f1-score': 0.4553491753062888, 'support': 495064}, '1': {'precision': 0.4610711999430969, 'recall': 0.6013941175742932, 'f1-score': 0.521966228651338, 'support': 485038}, '2': {'precision': 0.4949721164087609, 'recall': 0.4307871354261542, 'f1-score': 0.46065458102831813, 'support': 494070}, 'accuracy': 0.4822659771044356, 'macro avg': {'precision': 0.48587225684647767, 'recall': 0.48303571513677257, 'f1-score': 0.4793233283286484, 'support': 1474172}, 'weighted avg': {'precision': 0.4860347956384968, 'recall': 0.4822659771044356, 'f1-score': 0.4790458973478546, 'support': 1474172}}
[[206405 175530 113129]
 [ 89305 291699 104034]
 [115805 165426 212839]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0165693
{'0': {'precision': 0.49338913288417763, 'recall': 0.4484291812306358, 'f1-score': 0.46983602160102694, 'support': 191397}, '1': {'precision': 0.4473341758236596, 'recall': 0.5909183996425447, 'f1-score': 0.5091978609625669, 'support': 161139}, '2': {'precision': 0.5105582363097083, 'recall': 0.4195910687927486, 'f1-score': 0.4606264282066717, 'support': 192404}, 'accuracy': 0.4803813263845561, 'macro avg': {'precision': 0.48376051500584855, 'recall': 0.48631288322197636, 'f1-score': 0.47988677025675514, 'support': 544940}, 'weighted avg': {'precision': 0.4858326210658324, 'recall': 0.4803813263845561, 'f1-score': 0.478223669462134, 'support': 544940}}
[[85828 60242 45327]
 [33854 95220 32065]
 [54274 57399 80731]]
training model: results/AAPL/W5/deepVOL_L2/h50
Epoch 1/50
5759/5759 - 139s - loss: 3.1791 - accuracy50: 0.4246 - val_loss: 3.3068 - val_accuracy50: 0.3719 - 139s/epoch - 24ms/step
Epoch 2/50
5759/5759 - 128s - loss: 3.1417 - accuracy50: 0.4444 - val_loss: 3.2536 - val_accuracy50: 0.4056 - 128s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 134s - loss: 3.1272 - accuracy50: 0.4506 - val_loss: 3.2784 - val_accuracy50: 0.3881 - 134s/epoch - 23ms/step
Epoch 4/50
5759/5759 - 133s - loss: 3.1148 - accuracy50: 0.4554 - val_loss: 3.2443 - val_accuracy50: 0.4147 - 133s/epoch - 23ms/step
Epoch 5/50
5759/5759 - 138s - loss: 3.1039 - accuracy50: 0.4594 - val_loss: 3.2145 - val_accuracy50: 0.4259 - 138s/epoch - 24ms/step
Epoch 6/50
5759/5759 - 128s - loss: 3.0967 - accuracy50: 0.4617 - val_loss: 3.2242 - val_accuracy50: 0.4146 - 128s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 140s - loss: 3.0914 - accuracy50: 0.4633 - val_loss: 3.2179 - val_accuracy50: 0.4193 - 140s/epoch - 24ms/step
Epoch 8/50
5759/5759 - 140s - loss: 3.0871 - accuracy50: 0.4650 - val_loss: 3.2071 - val_accuracy50: 0.4291 - 140s/epoch - 24ms/step
Epoch 9/50
5759/5759 - 138s - loss: 3.0837 - accuracy50: 0.4662 - val_loss: 3.1978 - val_accuracy50: 0.4316 - 138s/epoch - 24ms/step
Epoch 10/50
5759/5759 - 129s - loss: 3.0803 - accuracy50: 0.4671 - val_loss: 3.1979 - val_accuracy50: 0.4316 - 129s/epoch - 22ms/step
Epoch 11/50
5759/5759 - 137s - loss: 3.0779 - accuracy50: 0.4682 - val_loss: 3.2019 - val_accuracy50: 0.4311 - 137s/epoch - 24ms/step
Epoch 12/50
5759/5759 - 144s - loss: 3.0755 - accuracy50: 0.4684 - val_loss: 3.2022 - val_accuracy50: 0.4316 - 144s/epoch - 25ms/step
Epoch 13/50
5759/5759 - 143s - loss: 3.0728 - accuracy50: 0.4693 - val_loss: 3.1848 - val_accuracy50: 0.4389 - 143s/epoch - 25ms/step
Epoch 14/50
5759/5759 - 128s - loss: 3.0705 - accuracy50: 0.4701 - val_loss: 3.2012 - val_accuracy50: 0.4322 - 128s/epoch - 22ms/step
Epoch 15/50
5759/5759 - 138s - loss: 3.0685 - accuracy50: 0.4708 - val_loss: 3.1905 - val_accuracy50: 0.4376 - 138s/epoch - 24ms/step
Epoch 16/50
5759/5759 - 131s - loss: 3.0661 - accuracy50: 0.4717 - val_loss: 3.1875 - val_accuracy50: 0.4361 - 131s/epoch - 23ms/step
Epoch 17/50
5759/5759 - 138s - loss: 3.0641 - accuracy50: 0.4722 - val_loss: 3.1904 - val_accuracy50: 0.4387 - 138s/epoch - 24ms/step
Epoch 18/50
5759/5759 - 141s - loss: 3.0622 - accuracy50: 0.4732 - val_loss: 3.1762 - val_accuracy50: 0.4424 - 141s/epoch - 24ms/step
Epoch 19/50
5759/5759 - 133s - loss: 3.0606 - accuracy50: 0.4732 - val_loss: 3.1776 - val_accuracy50: 0.4415 - 133s/epoch - 23ms/step
Epoch 20/50
5759/5759 - 139s - loss: 3.0589 - accuracy50: 0.4740 - val_loss: 3.1885 - val_accuracy50: 0.4402 - 139s/epoch - 24ms/step
Epoch 21/50
5759/5759 - 132s - loss: 3.0569 - accuracy50: 0.4744 - val_loss: 3.1797 - val_accuracy50: 0.4417 - 132s/epoch - 23ms/step
Epoch 22/50
5759/5759 - 134s - loss: 3.0553 - accuracy50: 0.4749 - val_loss: 3.1790 - val_accuracy50: 0.4430 - 134s/epoch - 23ms/step
Epoch 23/50
5759/5759 - 141s - loss: 3.0540 - accuracy50: 0.4756 - val_loss: 3.1849 - val_accuracy50: 0.4413 - 141s/epoch - 25ms/step
Epoch 24/50
5759/5759 - 142s - loss: 3.0523 - accuracy50: 0.4758 - val_loss: 3.2019 - val_accuracy50: 0.4353 - 142s/epoch - 25ms/step
Epoch 25/50
5759/5759 - 133s - loss: 3.0510 - accuracy50: 0.4762 - val_loss: 3.1987 - val_accuracy50: 0.4378 - 133s/epoch - 23ms/step
Epoch 26/50
5759/5759 - 144s - loss: 3.0498 - accuracy50: 0.4767 - val_loss: 3.1850 - val_accuracy50: 0.4423 - 144s/epoch - 25ms/step
Epoch 27/50
5759/5759 - 139s - loss: 3.0483 - accuracy50: 0.4771 - val_loss: 3.1864 - val_accuracy50: 0.4428 - 139s/epoch - 24ms/step
Epoch 28/50
5759/5759 - 128s - loss: 3.0467 - accuracy50: 0.4779 - val_loss: 3.1809 - val_accuracy50: 0.4437 - 128s/epoch - 22ms/step
testing model: results/AAPL/W5/deepVOL_L2/h50
Evaluating performance on  test set...
31315/31315 - 300s - 300s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778885
{'0': {'precision': 0.46939640514977354, 'recall': 0.473717447829507, 'f1-score': 0.47154702767955436, 'support': 3062507}, '1': {'precision': 0.26965040913727506, 'recall': 0.3211654194097635, 'f1-score': 0.29316203987819295, 'support': 1804226}, '2': {'precision': 0.4894401080351114, 'recall': 0.4314985968741041, 'f1-score': 0.45864663683970036, 'support': 3149753}, 'accuracy': 0.42279522474061576, 'macro avg': {'precision': 0.4094956407740533, 'recall': 0.40879382137112485, 'f1-score': 0.40778523479914924, 'support': 8016486}, 'weighted avg': {'precision': 0.43231604274317237, 'recall': 0.42279522474061576, 'f1-score': 0.4263302234900502, 'support': 8016486}}
[[1450763  771948  839796]
 [ 646806  579455  577965]
 [ 993130  797509 1359114]]
Evaluating performance on  train set...
5759/5759 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0524552
{'0': {'precision': 0.4744433643922053, 'recall': 0.3951183452753288, 'f1-score': 0.43116267651017304, 'support': 497823}, '1': {'precision': 0.4082062190065054, 'recall': 0.6113238466297677, 'f1-score': 0.4895318037835643, 'support': 478424}, '2': {'precision': 0.47975820601453795, 'recall': 0.33058392328161873, 'f1-score': 0.3914404650504681, 'support': 497925}, 'accuracy': 0.44348759846205194, 'macro avg': {'precision': 0.45413592980441625, 'recall': 0.4456753717289051, 'f1-score': 0.4373783151147352, 'support': 1474172}, 'weighted avg': {'precision': 0.45474210325767817, 'recall': 0.44348759846205194, 'f1-score': 0.4366888357409625, 'support': 1474172}}
[[196699 208400  92724]
 [100180 292472  85772]
 [117710 215609 164606]]
Evaluating performance on  val set...
2129/2129 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0616721
{'0': {'precision': 0.46336058904655014, 'recall': 0.4265211271346241, 'f1-score': 0.44417831519905293, 'support': 188265}, '1': {'precision': 0.4028344129736437, 'recall': 0.5966025873534034, 'f1-score': 0.48093487228593906, 'support': 165420}, '2': {'precision': 0.490628010169438, 'recall': 0.3249065383911532, 'f1-score': 0.3909294798196969, 'support': 191255}, 'accuracy': 0.4424872463023452, 'macro avg': {'precision': 0.45227433739654394, 'recall': 0.4493434176263935, 'f1-score': 0.438680889101563, 'support': 544940}, 'weighted avg': {'precision': 0.4545574007705523, 'recall': 0.4424872463023452, 'f1-score': 0.4366475111891324, 'support': 544940}}
[[80299 71526 36440]
 [38656 98690 28074]
 [54342 74773 62140]]
training model: results/AAPL/W5/deepVOL_L2/h100
Epoch 1/50
5759/5759 - 133s - loss: 3.1998 - accuracy100: 0.4128 - val_loss: 3.3793 - val_accuracy100: 0.3040 - 133s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 138s - loss: 3.1950 - accuracy100: 0.4159 - val_loss: 3.3624 - val_accuracy100: 0.3070 - 138s/epoch - 24ms/step
Epoch 3/50
5759/5759 - 134s - loss: 3.1906 - accuracy100: 0.4181 - val_loss: 3.3562 - val_accuracy100: 0.3097 - 134s/epoch - 23ms/step
Epoch 4/50
5759/5759 - 134s - loss: 3.1829 - accuracy100: 0.4208 - val_loss: 3.3616 - val_accuracy100: 0.3131 - 134s/epoch - 23ms/step
Epoch 5/50
5759/5759 - 129s - loss: 3.1742 - accuracy100: 0.4254 - val_loss: 3.3664 - val_accuracy100: 0.3159 - 129s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 146s - loss: 3.1682 - accuracy100: 0.4283 - val_loss: 3.3726 - val_accuracy100: 0.3158 - 146s/epoch - 25ms/step
Epoch 7/50
5759/5759 - 138s - loss: 3.1634 - accuracy100: 0.4306 - val_loss: 3.3744 - val_accuracy100: 0.3153 - 138s/epoch - 24ms/step
Epoch 8/50
5759/5759 - 133s - loss: 3.1590 - accuracy100: 0.4325 - val_loss: 3.3881 - val_accuracy100: 0.3165 - 133s/epoch - 23ms/step
Epoch 9/50
5759/5759 - 127s - loss: 3.1553 - accuracy100: 0.4340 - val_loss: 3.3899 - val_accuracy100: 0.3180 - 127s/epoch - 22ms/step
Epoch 10/50
5759/5759 - 137s - loss: 3.1524 - accuracy100: 0.4351 - val_loss: 3.4003 - val_accuracy100: 0.3164 - 137s/epoch - 24ms/step
Epoch 11/50
5759/5759 - 133s - loss: 3.1494 - accuracy100: 0.4365 - val_loss: 3.4122 - val_accuracy100: 0.3166 - 133s/epoch - 23ms/step
Epoch 12/50
5759/5759 - 136s - loss: 3.1471 - accuracy100: 0.4374 - val_loss: 3.4177 - val_accuracy100: 0.3171 - 136s/epoch - 24ms/step
Epoch 13/50
5759/5759 - 129s - loss: 3.1447 - accuracy100: 0.4384 - val_loss: 3.4170 - val_accuracy100: 0.3185 - 129s/epoch - 22ms/step
testing model: results/AAPL/W5/deepVOL_L2/h100
Evaluating performance on  test set...
31315/31315 - 344s - 344s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1779318
{'0': {'precision': 0.5388830921380937, 'recall': 0.01789389357663059, 'f1-score': 0.03463762672800309, 'support': 3319177}, '1': {'precision': 0.1591999677092336, 'recall': 0.9610558315182475, 'f1-score': 0.2731520023372933, 'support': 1276340}, '2': {'precision': 0.5404805198676483, 'recall': 0.03180063894177351, 'f1-score': 0.06006706879230621, 'support': 3420969}, 'accuracy': 0.17399344301231237, 'macro avg': {'precision': 0.41285452657165855, 'recall': 0.3369167880122172, 'f1-score': 0.12261889928586754, 'support': 8016486}, 'weighted avg': {'precision': 0.4791137607513758, 'recall': 0.17399344301231237, 'f1-score': 0.08346435344522538, 'support': 8016486}}
[[  59393 3199597   60187]
 [  17400 1226634   32306]
 [  33422 3278758  108789]]
Evaluating performance on  train set...
5759/5759 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1043934
{'0': {'precision': 0.5237705975992772, 'recall': 0.024755726820737546, 'f1-score': 0.0472769355039145, 'support': 491765}, '1': {'precision': 0.3303655717726755, 'recall': 0.9494830527635608, 'f1-score': 0.4901775188114335, 'support': 486510}, '2': {'precision': 0.46513923425903075, 'recall': 0.04941348707493693, 'f1-score': 0.08933642982401774, 'support': 495897}, 'accuracy': 0.33823122403627254, 'macro avg': {'precision': 0.4397584678769945, 'recall': 0.3412174222197451, 'f1-score': 0.20893029471312188, 'support': 1474172}, 'weighted avg': {'precision': 0.4402195626445785, 'recall': 0.33823122403627254, 'f1-score': 0.2075925159380818, 'support': 1474172}}
[[ 12174 469207  10384]
 [  6784 461933  17793]
 [  4285 467108  24504]]
Evaluating performance on  val set...
2129/2129 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1203575
{'0': {'precision': 0.47550073554373656, 'recall': 0.02238094477200944, 'f1-score': 0.04274973802814036, 'support': 187749}, '1': {'precision': 0.3029995149135438, 'recall': 0.9613883704583465, 'f1-score': 0.4607766544784984, 'support': 165028}, '2': {'precision': 0.4769723668402083, 'recall': 0.030989316361630492, 'f1-score': 0.05819749032485048, 'support': 192163}, 'accuracy': 0.3097827283737659, 'macro avg': {'precision': 0.4184908724324963, 'recall': 0.33825287719732877, 'f1-score': 0.18724129427716307, 'support': 544940}, 'weighted avg': {'precision': 0.42377992526492503, 'recall': 0.3097827283737659, 'f1-score': 0.1747911231211091, 'support': 544940}}
[[  4202 180727   2820]
 [  2662 158656   3710]
 [  1973 184235   5955]]
training model: results/AAPL/W5/deepVOL_L2/h200
Epoch 1/50
5759/5759 - 131s - loss: 3.2467 - accuracy200: 0.3888 - val_loss: 3.3300 - val_accuracy200: 0.3160 - 131s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 128s - loss: 3.2409 - accuracy200: 0.3918 - val_loss: 3.3381 - val_accuracy200: 0.3159 - 128s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 132s - loss: 3.2386 - accuracy200: 0.3937 - val_loss: 3.3390 - val_accuracy200: 0.3161 - 132s/epoch - 23ms/step
Epoch 4/50
5759/5759 - 127s - loss: 3.2370 - accuracy200: 0.3950 - val_loss: 3.3491 - val_accuracy200: 0.3159 - 127s/epoch - 22ms/step
Epoch 5/50
5759/5759 - 137s - loss: 3.2313 - accuracy200: 0.3990 - val_loss: 3.3435 - val_accuracy200: 0.3165 - 137s/epoch - 24ms/step
Epoch 6/50
5759/5759 - 145s - loss: 3.2270 - accuracy200: 0.4016 - val_loss: 3.3418 - val_accuracy200: 0.3172 - 145s/epoch - 25ms/step
Epoch 7/50
5759/5759 - 133s - loss: 3.2236 - accuracy200: 0.4045 - val_loss: 3.3420 - val_accuracy200: 0.3186 - 133s/epoch - 23ms/step
Epoch 8/50
5759/5759 - 147s - loss: 3.2200 - accuracy200: 0.4067 - val_loss: 3.3394 - val_accuracy200: 0.3209 - 147s/epoch - 26ms/step
Epoch 9/50
5759/5759 - 134s - loss: 3.2168 - accuracy200: 0.4084 - val_loss: 3.3387 - val_accuracy200: 0.3205 - 134s/epoch - 23ms/step
Epoch 10/50
5759/5759 - 129s - loss: 3.2137 - accuracy200: 0.4106 - val_loss: 3.3373 - val_accuracy200: 0.3219 - 129s/epoch - 22ms/step
Epoch 11/50
5759/5759 - 131s - loss: 3.2107 - accuracy200: 0.4119 - val_loss: 3.3328 - val_accuracy200: 0.3258 - 131s/epoch - 23ms/step
testing model: results/AAPL/W5/deepVOL_L2/h200
Evaluating performance on  test set...
31315/31315 - 329s - 329s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1314908
{'0': {'precision': 0.48299319727891155, 'recall': 9.435639139961427e-05, 'f1-score': 0.00018867592352380194, 'support': 3009865}, '1': {'precision': 0.23745730506015078, 'recall': 0.9945281357627515, 'f1-score': 0.3833778599964257, 'support': 1903556}, '2': {'precision': 0.4477150568640568, 'recall': 0.006254461314861274, 'f1-score': 0.012336583806199694, 'support': 3103065}, 'accuracy': 0.2386122797445165, 'macro avg': {'precision': 0.3893885197343731, 'recall': 0.3336256511563374, 'f1-score': 0.13196770657538306, 'support': 8016486}, 'weighted avg': {'precision': 0.41103377719949064, 'recall': 0.2386122797445165, 'f1-score': 0.09588120482596715, 'support': 8016486}}
[[    284 2995916   13665]
 [    140 1893140   10276]
 [    164 3083493   19408]]
Evaluating performance on  train set...
5759/5759 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1048217
{'0': {'precision': 0.42028985507246375, 'recall': 0.00017828307253457053, 'f1-score': 0.0003564149571380288, 'support': 487988}, '1': {'precision': 0.3302726344828717, 'recall': 0.992848751714903, 'f1-score': 0.4956624181160305, 'support': 486908}, '2': {'precision': 0.4140724114374939, 'recall': 0.008498305546431233, 'f1-score': 0.01665479281602597, 'support': 499276}, 'accuracy': 0.3308677684829179, 'macro avg': {'precision': 0.38821163366427647, 'recall': 0.3338417801112896, 'f1-score': 0.1708912086297315, 'support': 1474172}, 'weighted avg': {'precision': 0.3884521012478556, 'recall': 0.3308677684829179, 'f1-score': 0.16947226052330272, 'support': 1474172}}
[[    87 485307   2594]
 [    72 483426   3410]
 [    48 494985   4243]]
Evaluating performance on  val set...
2129/2129 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1105051
{'0': {'precision': 0.421875, 'recall': 0.00014629785158895721, 'f1-score': 0.00029249427198717353, 'support': 184555}, '1': {'precision': 0.31566285494120183, 'recall': 0.9951182941925135, 'f1-score': 0.47928959301349155, 'support': 172071}, '2': {'precision': 0.39596209311907704, 'recall': 0.0051031787333921, 'f1-score': 0.010076491158167358, 'support': 188314}, 'accuracy': 0.3160329577568173, 'macro avg': {'precision': 0.3778333160200929, 'recall': 0.33345592359249815, 'f1-score': 0.16321952614788202, 'support': 544940}, 'weighted avg': {'precision': 0.3793826280713719, 'recall': 0.3160329577568173, 'f1-score': 0.15492231290738473, 'support': 544940}}
[[    27 183876    652]
 [    26 171231    814]
 [    11 187342    961]]
training model: results/AAPL/W5/deepVOL_L2/h300
Epoch 1/50
5759/5759 - 128s - loss: 3.2262 - accuracy300: 0.3992 - val_loss: 3.4667 - val_accuracy300: 0.3202 - 128s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 134s - loss: 3.2242 - accuracy300: 0.4015 - val_loss: 3.4047 - val_accuracy300: 0.3202 - 134s/epoch - 23ms/step
Epoch 3/50
5759/5759 - 125s - loss: 3.2202 - accuracy300: 0.4041 - val_loss: 3.4093 - val_accuracy300: 0.3202 - 125s/epoch - 22ms/step
Epoch 4/50
5759/5759 - 142s - loss: 3.2134 - accuracy300: 0.4079 - val_loss: 3.4231 - val_accuracy300: 0.3202 - 142s/epoch - 25ms/step
Epoch 5/50
5759/5759 - 132s - loss: 3.2101 - accuracy300: 0.4102 - val_loss: 3.4288 - val_accuracy300: 0.3202 - 132s/epoch - 23ms/step
Epoch 6/50
5759/5759 - 127s - loss: 3.2046 - accuracy300: 0.4126 - val_loss: 3.4471 - val_accuracy300: 0.3202 - 127s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 128s - loss: 3.2001 - accuracy300: 0.4154 - val_loss: 3.4377 - val_accuracy300: 0.3202 - 128s/epoch - 22ms/step
Epoch 8/50
5759/5759 - 134s - loss: 3.1974 - accuracy300: 0.4162 - val_loss: 3.4368 - val_accuracy300: 0.3202 - 134s/epoch - 23ms/step
Epoch 9/50
5759/5759 - 142s - loss: 3.1942 - accuracy300: 0.4181 - val_loss: 3.4378 - val_accuracy300: 0.3202 - 142s/epoch - 25ms/step
Epoch 10/50
5759/5759 - 142s - loss: 3.1916 - accuracy300: 0.4192 - val_loss: 3.4294 - val_accuracy300: 0.3202 - 142s/epoch - 25ms/step
Epoch 11/50
5759/5759 - 140s - loss: 3.1892 - accuracy300: 0.4206 - val_loss: 3.4290 - val_accuracy300: 0.3202 - 140s/epoch - 24ms/step
Epoch 12/50
5759/5759 - 136s - loss: 3.1864 - accuracy300: 0.4215 - val_loss: 3.4205 - val_accuracy300: 0.3203 - 136s/epoch - 24ms/step
testing model: results/AAPL/W5/deepVOL_L2/h300
Evaluating performance on  test set...
31315/31315 - 274s - 274s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1993268
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3178145}, '1': {'precision': 0.19808858846347102, 'recall': 1.0, 'f1-score': 0.3306743597608527, 'support': 1587974}, '2': {'precision': 0.5, 'recall': 3.076575660533103e-07, 'f1-score': 6.153147534941417e-07, 'support': 3250367}, 'accuracy': 0.1980886637861028, 'macro avg': {'precision': 0.23269619615449033, 'recall': 0.33333343588585534, 'f1-score': 0.11022499169186872, 'support': 8016486}, 'weighted avg': {'precision': 0.24196924040991175, 'recall': 0.1980886637861028, 'f1-score': 0.06550305030978032, 'support': 8016486}}
[[      0 3178144       1]
 [      0 1587974       0]
 [      0 3250366       1]]
Evaluating performance on  train set...
5759/5759 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1296254
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 489244}, '1': {'precision': 0.3303440846793997, 'recall': 1.0, 'f1-score': 0.49662953890460526, 'support': 486984}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 497944}, 'accuracy': 0.3303440846793997, 'macro avg': {'precision': 0.11011469489313323, 'recall': 0.3333333333333333, 'f1-score': 0.16554317963486842, 'support': 1474172}, 'weighted avg': {'precision': 0.10912721428267039, 'recall': 0.3303440846793997, 'f1-score': 0.16405863045419414, 'support': 1474172}}
[[     0 489244      0]
 [     0 486984      0]
 [     0 497944      0]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1362574
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 184029}, '1': {'precision': 0.32018754358277973, 'recall': 1.0, 'f1-score': 0.4850637246793611, 'support': 174483}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 186428}, 'accuracy': 0.32018754358277973, 'macro avg': {'precision': 0.1067291811942599, 'recall': 0.3333333333333333, 'f1-score': 0.1616879082264537, 'support': 544940}, 'weighted avg': {'precision': 0.10252006306557447, 'recall': 0.32018754358277973, 'f1-score': 0.15531136248619842, 'support': 544940}}
[[     0 184029      0]
 [     0 174483      0]
 [     0 186428      0]]
training model: results/AAPL/W5/deepVOL_L2/h500
Epoch 1/50
5759/5759 - 134s - loss: 3.2475 - accuracy500: 0.3884 - val_loss: 3.3849 - val_accuracy500: 0.3024 - 134s/epoch - 23ms/step
Epoch 2/50
5759/5759 - 126s - loss: 3.2490 - accuracy500: 0.3844 - val_loss: 3.3628 - val_accuracy500: 0.3024 - 126s/epoch - 22ms/step
Epoch 3/50
5759/5759 - 128s - loss: 3.2429 - accuracy500: 0.3888 - val_loss: 3.3642 - val_accuracy500: 0.3024 - 128s/epoch - 22ms/step
Epoch 4/50
5759/5759 - 140s - loss: 3.2441 - accuracy500: 0.3874 - val_loss: 3.3789 - val_accuracy500: 0.3024 - 140s/epoch - 24ms/step
Epoch 5/50
5759/5759 - 124s - loss: 3.2347 - accuracy500: 0.3938 - val_loss: 3.3847 - val_accuracy500: 0.3026 - 124s/epoch - 22ms/step
Epoch 6/50
5759/5759 - 126s - loss: 3.2272 - accuracy500: 0.3987 - val_loss: 3.3695 - val_accuracy500: 0.3029 - 126s/epoch - 22ms/step
Epoch 7/50
5759/5759 - 131s - loss: 3.2211 - accuracy500: 0.4031 - val_loss: 3.3600 - val_accuracy500: 0.3033 - 131s/epoch - 23ms/step
Epoch 8/50
5759/5759 - 128s - loss: 3.2166 - accuracy500: 0.4056 - val_loss: 3.3552 - val_accuracy500: 0.3056 - 128s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 135s - loss: 3.2125 - accuracy500: 0.4072 - val_loss: 3.3529 - val_accuracy500: 0.3059 - 135s/epoch - 24ms/step
Epoch 10/50
5759/5759 - 135s - loss: 3.2091 - accuracy500: 0.4095 - val_loss: 3.3486 - val_accuracy500: 0.3068 - 135s/epoch - 23ms/step
Epoch 11/50
5759/5759 - 140s - loss: 3.2064 - accuracy500: 0.4105 - val_loss: 3.3430 - val_accuracy500: 0.3056 - 140s/epoch - 24ms/step
Epoch 12/50
5759/5759 - 135s - loss: 3.2035 - accuracy500: 0.4116 - val_loss: 3.3426 - val_accuracy500: 0.3057 - 135s/epoch - 23ms/step
Epoch 13/50
5759/5759 - 129s - loss: 3.2015 - accuracy500: 0.4128 - val_loss: 3.3389 - val_accuracy500: 0.3084 - 129s/epoch - 22ms/step
Epoch 14/50
5759/5759 - 140s - loss: 3.1987 - accuracy500: 0.4141 - val_loss: 3.3439 - val_accuracy500: 0.3062 - 140s/epoch - 24ms/step
Epoch 15/50
5759/5759 - 138s - loss: 3.1964 - accuracy500: 0.4151 - val_loss: 3.3430 - val_accuracy500: 0.3071 - 138s/epoch - 24ms/step
Epoch 16/50
5759/5759 - 131s - loss: 3.1947 - accuracy500: 0.4161 - val_loss: 3.3527 - val_accuracy500: 0.3077 - 131s/epoch - 23ms/step
Epoch 17/50
5759/5759 - 142s - loss: 3.1924 - accuracy500: 0.4168 - val_loss: 3.3543 - val_accuracy500: 0.3102 - 142s/epoch - 25ms/step
Epoch 18/50
5759/5759 - 139s - loss: 3.1898 - accuracy500: 0.4182 - val_loss: 3.3458 - val_accuracy500: 0.3111 - 139s/epoch - 24ms/step
Epoch 19/50
5759/5759 - 133s - loss: 3.1879 - accuracy500: 0.4194 - val_loss: 3.3491 - val_accuracy500: 0.3128 - 133s/epoch - 23ms/step
Epoch 20/50
5759/5759 - 128s - loss: 3.1850 - accuracy500: 0.4209 - val_loss: 3.3521 - val_accuracy500: 0.3123 - 128s/epoch - 22ms/step
Epoch 21/50
5759/5759 - 133s - loss: 3.1836 - accuracy500: 0.4213 - val_loss: 3.3464 - val_accuracy500: 0.3133 - 133s/epoch - 23ms/step
Epoch 22/50
5759/5759 - 135s - loss: 3.1815 - accuracy500: 0.4226 - val_loss: 3.3524 - val_accuracy500: 0.3134 - 135s/epoch - 23ms/step
Epoch 23/50
5759/5759 - 135s - loss: 3.1792 - accuracy500: 0.4235 - val_loss: 3.3472 - val_accuracy500: 0.3161 - 135s/epoch - 23ms/step
testing model: results/AAPL/W5/deepVOL_L2/h500
Evaluating performance on  test set...
31315/31315 - 273s - 273s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1325302
{'0': {'precision': 0.40498496666521416, 'recall': 0.0030299957846088342, 'f1-score': 0.006014988933041666, 'support': 3067331}, '1': {'precision': 0.23169285232521117, 'recall': 0.9152595096369045, 'f1-score': 0.36977836820140386, 'support': 1848467}, '2': {'precision': 0.40668997790349265, 'recall': 0.09069954797128896, 'f1-score': 0.1483207636728021, 'support': 3100688}, 'accuracy': 0.24728440865486448, 'macro avg': {'precision': 0.34778926563130597, 'recall': 0.3363296844642674, 'f1-score': 0.17470470693574922, 'support': 8016486}, 'weighted avg': {'precision': 0.3656861957534547, 'recall': 0.24728440865486448, 'f1-score': 0.14493501080451127, 'support': 8016486}}
[[   9294 2798514  259523]
 [   5882 1691827  150758]
 [   7773 2811684  281231]]
Evaluating performance on  train set...
5759/5759 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066062
{'0': {'precision': 0.34795685542418586, 'recall': 0.006791168040419089, 'f1-score': 0.013322320744302773, 'support': 494024}, '1': {'precision': 0.33015221951440715, 'recall': 0.9341611307713003, 'f1-score': 0.48787805750613633, 'support': 483210}, '2': {'precision': 0.37958147470553166, 'recall': 0.07431711803082075, 'f1-score': 0.12429825388063923, 'support': 496938}, 'accuracy': 0.3335309583956282, 'macro avg': {'precision': 0.3525635165480416, 'recall': 0.33842313894751336, 'f1-score': 0.20849954404369275, 'support': 1474172}, 'weighted avg': {'precision': 0.35278132430466197, 'recall': 0.3335309583956282, 'f1-score': 0.2062836819840973, 'support': 1474172}}
[[  3355 458353  32316]
 [  3767 451396  28047]
 [  2520 457487  36931]]
Evaluating performance on  val set...
2129/2129 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151054
{'0': {'precision': 0.3285999003487793, 'recall': 0.006986820917026866, 'f1-score': 0.013682714550980819, 'support': 188784}, '1': {'precision': 0.30367714533177154, 'recall': 0.929902288037871, 'f1-score': 0.4578384895692488, 'support': 164770}, '2': {'precision': 0.37026142892487013, 'recall': 0.07037609856520331, 'f1-score': 0.11827206350460787, 'support': 191386}, 'accuracy': 0.3083055015231035, 'macro avg': {'precision': 0.33417949153514037, 'recall': 0.33575506917336706, 'f1-score': 0.1965977558749458, 'support': 544940}, 'weighted avg': {'precision': 0.3356959310382338, 'recall': 0.3083055015231035, 'f1-score': 0.1847116061511549, 'support': 544940}}
[[  1319 174551  12914]
 [  1556 153220   9994]
 [  1139 176778  13469]]
training model: results/AAPL/W5/deepVOL_L2/h1000
Epoch 1/50
5759/5759 - 129s - loss: 3.2560 - accuracy1000: 0.3771 - val_loss: 3.3675 - val_accuracy1000: 0.2992 - 129s/epoch - 22ms/step
Epoch 2/50
5759/5759 - 130s - loss: 3.2594 - accuracy1000: 0.3729 - val_loss: 3.3462 - val_accuracy1000: 0.2991 - 130s/epoch - 23ms/step
Epoch 3/50
5759/5759 - 140s - loss: 3.2567 - accuracy1000: 0.3753 - val_loss: 3.3495 - val_accuracy1000: 0.2994 - 140s/epoch - 24ms/step
Epoch 4/50
5759/5759 - 134s - loss: 3.2503 - accuracy1000: 0.3800 - val_loss: 3.3621 - val_accuracy1000: 0.2992 - 134s/epoch - 23ms/step
Epoch 5/50
5759/5759 - 134s - loss: 3.2496 - accuracy1000: 0.3833 - val_loss: 3.3522 - val_accuracy1000: 0.3220 - 134s/epoch - 23ms/step
Epoch 6/50
5759/5759 - 136s - loss: 3.2385 - accuracy1000: 0.3911 - val_loss: 3.3562 - val_accuracy1000: 0.3015 - 136s/epoch - 24ms/step
Epoch 7/50
5759/5759 - 137s - loss: 3.2308 - accuracy1000: 0.3958 - val_loss: 3.3534 - val_accuracy1000: 0.3031 - 137s/epoch - 24ms/step
Epoch 8/50
5759/5759 - 130s - loss: 3.2241 - accuracy1000: 0.3999 - val_loss: 3.3550 - val_accuracy1000: 0.3023 - 130s/epoch - 22ms/step
Epoch 9/50
5759/5759 - 142s - loss: 3.2187 - accuracy1000: 0.4032 - val_loss: 3.3489 - val_accuracy1000: 0.3058 - 142s/epoch - 25ms/step
Epoch 10/50
5759/5759 - 134s - loss: 3.2130 - accuracy1000: 0.4057 - val_loss: 3.3567 - val_accuracy1000: 0.3089 - 134s/epoch - 23ms/step
Epoch 11/50
5759/5759 - 128s - loss: 3.2086 - accuracy1000: 0.4080 - val_loss: 3.3577 - val_accuracy1000: 0.3089 - 128s/epoch - 22ms/step
Epoch 12/50
5759/5759 - 129s - loss: 3.2055 - accuracy1000: 0.4096 - val_loss: 3.3799 - val_accuracy1000: 0.3209 - 129s/epoch - 22ms/step
testing model: results/AAPL/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
31315/31315 - 286s - 286s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1433767
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3092312}, '1': {'precision': 0.22744817284670454, 'recall': 0.9999648995221398, 'f1-score': 0.37060089130092333, 'support': 1823337}, '2': {'precision': 0.3956043956043956, 'recall': 3.482930576486284e-05, 'f1-score': 6.965247927355043e-05, 'support': 3100837}, 'accuracy': 0.22745389937685914, 'macro avg': {'precision': 0.20768418948370004, 'recall': 0.3333332429426349, 'f1-score': 0.12355684792673229, 'support': 8016486}, 'weighted avg': {'precision': 0.20475547719868017, 'recall': 0.22745389937685914, 'f1-score': 0.08431952582800305, 'support': 8016486}}
[[      0 3092211     101]
 [      0 1823273      64]
 [      0 3100729     108]]
Evaluating performance on  train set...
5759/5759 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153281
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505244}, '1': {'precision': 0.32001003978604403, 'recall': 0.9999766825154902, 'f1-score': 0.4848572679563633, 'support': 471749}, '2': {'precision': 0.3783783783783784, 'recall': 2.815887235784295e-05, 'f1-score': 5.6313553867936664e-05, 'support': 497179}, 'accuracy': 0.3200115047633519, 'macro avg': {'precision': 0.2327961393881408, 'recall': 0.33333494712928263, 'f1-score': 0.16163786050341042, 'support': 1474172}, 'weighted avg': {'precision': 0.23001807119034298, 'recall': 0.3200115047633519, 'f1-score': 0.1551779095095721, 'support': 1474172}}
[[     0 505232     12]
 [     0 471738     11]
 [     0 497165     14]]
Evaluating performance on  val set...
2129/2129 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1210624
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 187484}, '1': {'precision': 0.29915199650595403, 'recall': 0.9999693291048393, 'f1-score': 0.46053099945193715, 'support': 163021}, '2': {'precision': 0.25, 'recall': 1.5429320852727133e-05, 'f1-score': 3.0856737311452477e-05, 'support': 194435}, 'accuracy': 0.29915036517781773, 'macro avg': {'precision': 0.18305066550198468, 'recall': 0.333328252808564, 'f1-score': 0.15352061872974954, 'support': 544940}, 'weighted avg': {'precision': 0.1786927141013637, 'recall': 0.29915036517781773, 'f1-score': 0.13778071657682203, 'support': 544940}}
[[     0 187479      5]
 [     1 163016      4]
 [     0 194432      3]]
training model: results/AAPL/W5/deepVOL_L3/h10
Epoch 1/50
5759/5759 - 201s - loss: 3.0588 - accuracy10: 0.4497 - val_loss: 3.1483 - val_accuracy10: 0.4770 - 201s/epoch - 35ms/step
Epoch 2/50
5759/5759 - 191s - loss: 2.8801 - accuracy10: 0.5072 - val_loss: 3.1111 - val_accuracy10: 0.5103 - 191s/epoch - 33ms/step
Epoch 3/50
5759/5759 - 194s - loss: 2.8234 - accuracy10: 0.5236 - val_loss: 3.0437 - val_accuracy10: 0.5191 - 194s/epoch - 34ms/step
Epoch 4/50
5759/5759 - 193s - loss: 2.7894 - accuracy10: 0.5322 - val_loss: 3.0102 - val_accuracy10: 0.5252 - 193s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 192s - loss: 2.7689 - accuracy10: 0.5377 - val_loss: 3.0136 - val_accuracy10: 0.5262 - 192s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 194s - loss: 2.7537 - accuracy10: 0.5416 - val_loss: 2.9996 - val_accuracy10: 0.5264 - 194s/epoch - 34ms/step
Epoch 7/50
5759/5759 - 197s - loss: 2.7425 - accuracy10: 0.5439 - val_loss: 2.9416 - val_accuracy10: 0.5311 - 197s/epoch - 34ms/step
Epoch 8/50
5759/5759 - 194s - loss: 2.7345 - accuracy10: 0.5459 - val_loss: 2.9248 - val_accuracy10: 0.5324 - 194s/epoch - 34ms/step
Epoch 9/50
5759/5759 - 191s - loss: 2.7257 - accuracy10: 0.5487 - val_loss: 2.9278 - val_accuracy10: 0.5317 - 191s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 191s - loss: 2.7191 - accuracy10: 0.5498 - val_loss: 2.9164 - val_accuracy10: 0.5331 - 191s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 191s - loss: 2.7135 - accuracy10: 0.5513 - val_loss: 2.9272 - val_accuracy10: 0.5320 - 191s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 191s - loss: 2.7078 - accuracy10: 0.5527 - val_loss: 2.9088 - val_accuracy10: 0.5321 - 191s/epoch - 33ms/step
Epoch 13/50
5759/5759 - 190s - loss: 2.7030 - accuracy10: 0.5540 - val_loss: 2.9011 - val_accuracy10: 0.5325 - 190s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 191s - loss: 2.6990 - accuracy10: 0.5550 - val_loss: 2.9085 - val_accuracy10: 0.5351 - 191s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 194s - loss: 2.6952 - accuracy10: 0.5559 - val_loss: 2.9133 - val_accuracy10: 0.5324 - 194s/epoch - 34ms/step
Epoch 16/50
5759/5759 - 195s - loss: 2.6917 - accuracy10: 0.5564 - val_loss: 2.8914 - val_accuracy10: 0.5356 - 195s/epoch - 34ms/step
Epoch 17/50
5759/5759 - 189s - loss: 2.6883 - accuracy10: 0.5576 - val_loss: 2.8979 - val_accuracy10: 0.5335 - 189s/epoch - 33ms/step
Epoch 18/50
5759/5759 - 192s - loss: 2.6848 - accuracy10: 0.5584 - val_loss: 2.8971 - val_accuracy10: 0.5308 - 192s/epoch - 33ms/step
Epoch 19/50
5759/5759 - 190s - loss: 2.6827 - accuracy10: 0.5589 - val_loss: 2.8948 - val_accuracy10: 0.5348 - 190s/epoch - 33ms/step
Epoch 20/50
5759/5759 - 195s - loss: 2.6796 - accuracy10: 0.5596 - val_loss: 2.9113 - val_accuracy10: 0.5325 - 195s/epoch - 34ms/step
Epoch 21/50
5759/5759 - 194s - loss: 2.6761 - accuracy10: 0.5606 - val_loss: 2.8974 - val_accuracy10: 0.5308 - 194s/epoch - 34ms/step
Epoch 22/50
5759/5759 - 193s - loss: 2.6745 - accuracy10: 0.5610 - val_loss: 2.8938 - val_accuracy10: 0.5325 - 193s/epoch - 33ms/step
Epoch 23/50
5759/5759 - 191s - loss: 2.6722 - accuracy10: 0.5614 - val_loss: 2.9141 - val_accuracy10: 0.5291 - 191s/epoch - 33ms/step
Epoch 24/50
5759/5759 - 191s - loss: 2.6701 - accuracy10: 0.5619 - val_loss: 2.8926 - val_accuracy10: 0.5335 - 191s/epoch - 33ms/step
Epoch 25/50
5759/5759 - 192s - loss: 2.6674 - accuracy10: 0.5627 - val_loss: 2.8909 - val_accuracy10: 0.5351 - 192s/epoch - 33ms/step
Epoch 26/50
5759/5759 - 191s - loss: 2.6651 - accuracy10: 0.5632 - val_loss: 2.8863 - val_accuracy10: 0.5374 - 191s/epoch - 33ms/step
Epoch 27/50
5759/5759 - 190s - loss: 2.6634 - accuracy10: 0.5634 - val_loss: 2.8988 - val_accuracy10: 0.5346 - 190s/epoch - 33ms/step
Epoch 28/50
5759/5759 - 192s - loss: 2.6614 - accuracy10: 0.5643 - val_loss: 2.8988 - val_accuracy10: 0.5341 - 192s/epoch - 33ms/step
Epoch 29/50
5759/5759 - 191s - loss: 2.6603 - accuracy10: 0.5642 - val_loss: 2.9017 - val_accuracy10: 0.5329 - 191s/epoch - 33ms/step
Epoch 30/50
5759/5759 - 188s - loss: 2.6576 - accuracy10: 0.5653 - val_loss: 2.8996 - val_accuracy10: 0.5359 - 188s/epoch - 33ms/step
Epoch 31/50
5759/5759 - 190s - loss: 2.6561 - accuracy10: 0.5653 - val_loss: 2.8921 - val_accuracy10: 0.5353 - 190s/epoch - 33ms/step
Epoch 32/50
5759/5759 - 193s - loss: 2.6539 - accuracy10: 0.5661 - val_loss: 2.8880 - val_accuracy10: 0.5379 - 193s/epoch - 33ms/step
Epoch 33/50
5759/5759 - 191s - loss: 2.6526 - accuracy10: 0.5666 - val_loss: 2.8962 - val_accuracy10: 0.5368 - 191s/epoch - 33ms/step
Epoch 34/50
5759/5759 - 192s - loss: 2.6506 - accuracy10: 0.5669 - val_loss: 2.8819 - val_accuracy10: 0.5384 - 192s/epoch - 33ms/step
Epoch 35/50
5759/5759 - 191s - loss: 2.6492 - accuracy10: 0.5670 - val_loss: 2.8794 - val_accuracy10: 0.5402 - 191s/epoch - 33ms/step
Epoch 36/50
5759/5759 - 188s - loss: 2.6474 - accuracy10: 0.5676 - val_loss: 2.8865 - val_accuracy10: 0.5390 - 188s/epoch - 33ms/step
Epoch 37/50
5759/5759 - 189s - loss: 2.6455 - accuracy10: 0.5682 - val_loss: 2.8838 - val_accuracy10: 0.5408 - 189s/epoch - 33ms/step
Epoch 38/50
5759/5759 - 188s - loss: 2.6450 - accuracy10: 0.5682 - val_loss: 2.8830 - val_accuracy10: 0.5415 - 188s/epoch - 33ms/step
Epoch 39/50
5759/5759 - 190s - loss: 2.6433 - accuracy10: 0.5688 - val_loss: 2.8789 - val_accuracy10: 0.5425 - 190s/epoch - 33ms/step
Epoch 40/50
5759/5759 - 191s - loss: 2.6419 - accuracy10: 0.5690 - val_loss: 2.8843 - val_accuracy10: 0.5405 - 191s/epoch - 33ms/step
Epoch 41/50
5759/5759 - 195s - loss: 2.6405 - accuracy10: 0.5695 - val_loss: 2.8899 - val_accuracy10: 0.5392 - 195s/epoch - 34ms/step
Epoch 42/50
5759/5759 - 192s - loss: 2.6389 - accuracy10: 0.5700 - val_loss: 2.8850 - val_accuracy10: 0.5410 - 192s/epoch - 33ms/step
Epoch 43/50
5759/5759 - 191s - loss: 2.6378 - accuracy10: 0.5704 - val_loss: 2.9053 - val_accuracy10: 0.5378 - 191s/epoch - 33ms/step
Epoch 44/50
5759/5759 - 188s - loss: 2.6365 - accuracy10: 0.5705 - val_loss: 2.8814 - val_accuracy10: 0.5411 - 188s/epoch - 33ms/step
Epoch 45/50
5759/5759 - 189s - loss: 2.6353 - accuracy10: 0.5705 - val_loss: 2.8798 - val_accuracy10: 0.5409 - 189s/epoch - 33ms/step
Epoch 46/50
5759/5759 - 187s - loss: 2.6336 - accuracy10: 0.5712 - val_loss: 2.8850 - val_accuracy10: 0.5404 - 187s/epoch - 32ms/step
Epoch 47/50
5759/5759 - 192s - loss: 2.6324 - accuracy10: 0.5716 - val_loss: 2.8816 - val_accuracy10: 0.5407 - 192s/epoch - 33ms/step
Epoch 48/50
5759/5759 - 192s - loss: 2.6306 - accuracy10: 0.5719 - val_loss: 2.8791 - val_accuracy10: 0.5417 - 192s/epoch - 33ms/step
Epoch 49/50
5759/5759 - 192s - loss: 2.6300 - accuracy10: 0.5718 - val_loss: 2.8820 - val_accuracy10: 0.5408 - 192s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h10
Evaluating performance on  test set...
31315/31315 - 422s - 422s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0071441
{'0': {'precision': 0.48026332459712023, 'recall': 0.6499320729744472, 'f1-score': 0.5523620761501828, 'support': 2828771}, '1': {'precision': 0.5740443299140403, 'recall': 0.2525477256374206, 'f1-score': 0.35077421555456123, 'support': 2325113}, '2': {'precision': 0.515671133031195, 'recall': 0.5702242225779204, 'f1-score': 0.541577361795874, 'support': 2862602}, 'accuracy': 0.5062113250119815, 'macro avg': {'precision': 0.5233262625141185, 'recall': 0.49090134039659605, 'f1-score': 0.4815712178335394, 'support': 8016486}, 'weighted avg': {'precision': 0.520107453041234, 'recall': 0.5062113250119815, 'f1-score': 0.4900421394356248, 'support': 8016486}}
[[1838509  235362  754900]
 [ 959698  587202  778213]
 [1029920  200357 1632325]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92506796
{'0': {'precision': 0.4758924750901644, 'recall': 0.6002554032238633, 'f1-score': 0.5308880596855894, 'support': 415030}, '1': {'precision': 0.6664805265784284, 'recall': 0.5244091690973002, 'f1-score': 0.5869703977314346, 'support': 641808}, '2': {'precision': 0.49890057618782646, 'recall': 0.532796273488381, 'f1-score': 0.5152916148139909, 'support': 417334}, 'accuracy': 0.548136852416136, 'macro avg': {'precision': 0.5470911926188065, 'recall': 0.5524869486031815, 'f1-score': 0.5443833574103382, 'support': 1474172}, 'weighted avg': {'precision': 0.5653820319485714, 'recall': 0.548136852416136, 'f1-score': 0.5508892308464065, 'support': 1474172}}
[[249124  87348  78558]
 [160462 336570 144776]
 [113902  81078 222354]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9430537
{'0': {'precision': 0.48558501983843805, 'recall': 0.6015204643898989, 'f1-score': 0.5373707167733224, 'support': 169685}, '1': {'precision': 0.6436523580084684, 'recall': 0.5110838449759194, 'f1-score': 0.5697583934903835, 'support': 207013}, '2': {'precision': 0.5128311987133582, 'recall': 0.5193055241853997, 'f1-score': 0.5160480555686813, 'support': 168242}, 'accuracy': 0.541782581568613, 'macro avg': {'precision': 0.5473561921867549, 'recall': 0.5439699445170727, 'f1-score': 0.5410590552774623, 'support': 544940}, 'weighted avg': {'precision': 0.5540438327405316, 'recall': 0.541782581568613, 'f1-score': 0.5430911684814695, 'support': 544940}}
[[102069  30779  36837]
 [ 55052 105801  46160]
 [ 53077  27796  87369]]
training model: results/AAPL/W5/deepVOL_L3/h20
Epoch 1/50
5759/5759 - 198s - loss: 3.0629 - accuracy20: 0.4583 - val_loss: 3.1641 - val_accuracy20: 0.4525 - 198s/epoch - 34ms/step
Epoch 2/50
5759/5759 - 191s - loss: 2.9504 - accuracy20: 0.5028 - val_loss: 3.0202 - val_accuracy20: 0.4974 - 191s/epoch - 33ms/step
Epoch 3/50
5759/5759 - 195s - loss: 2.9138 - accuracy20: 0.5136 - val_loss: 2.9916 - val_accuracy20: 0.5021 - 195s/epoch - 34ms/step
Epoch 4/50
5759/5759 - 189s - loss: 2.8866 - accuracy20: 0.5199 - val_loss: 2.9905 - val_accuracy20: 0.5012 - 189s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 189s - loss: 2.8698 - accuracy20: 0.5239 - val_loss: 2.9916 - val_accuracy20: 0.5018 - 189s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 190s - loss: 2.8579 - accuracy20: 0.5266 - val_loss: 2.9963 - val_accuracy20: 0.4982 - 190s/epoch - 33ms/step
Epoch 7/50
5759/5759 - 188s - loss: 2.8493 - accuracy20: 0.5295 - val_loss: 2.9777 - val_accuracy20: 0.5058 - 188s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 190s - loss: 2.8426 - accuracy20: 0.5309 - val_loss: 2.9689 - val_accuracy20: 0.5077 - 190s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 190s - loss: 2.8375 - accuracy20: 0.5324 - val_loss: 2.9747 - val_accuracy20: 0.5064 - 190s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 193s - loss: 2.8321 - accuracy20: 0.5338 - val_loss: 2.9632 - val_accuracy20: 0.5084 - 193s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 190s - loss: 2.8290 - accuracy20: 0.5344 - val_loss: 2.9737 - val_accuracy20: 0.5084 - 190s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 196s - loss: 2.8248 - accuracy20: 0.5355 - val_loss: 2.9705 - val_accuracy20: 0.5072 - 196s/epoch - 34ms/step
Epoch 13/50
5759/5759 - 189s - loss: 2.8216 - accuracy20: 0.5363 - val_loss: 2.9728 - val_accuracy20: 0.5093 - 189s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 190s - loss: 2.8197 - accuracy20: 0.5370 - val_loss: 3.0294 - val_accuracy20: 0.4982 - 190s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 193s - loss: 2.8157 - accuracy20: 0.5380 - val_loss: 2.9801 - val_accuracy20: 0.5103 - 193s/epoch - 33ms/step
Epoch 16/50
5759/5759 - 190s - loss: 2.8123 - accuracy20: 0.5389 - val_loss: 2.9867 - val_accuracy20: 0.5088 - 190s/epoch - 33ms/step
Epoch 17/50
5759/5759 - 195s - loss: 2.8094 - accuracy20: 0.5395 - val_loss: 2.9623 - val_accuracy20: 0.5124 - 195s/epoch - 34ms/step
Epoch 18/50
5759/5759 - 192s - loss: 2.8070 - accuracy20: 0.5401 - val_loss: 2.9645 - val_accuracy20: 0.5123 - 192s/epoch - 33ms/step
Epoch 19/50
5759/5759 - 191s - loss: 2.8049 - accuracy20: 0.5410 - val_loss: 2.9627 - val_accuracy20: 0.5126 - 191s/epoch - 33ms/step
Epoch 20/50
5759/5759 - 191s - loss: 2.8032 - accuracy20: 0.5410 - val_loss: 2.9476 - val_accuracy20: 0.5146 - 191s/epoch - 33ms/step
Epoch 21/50
5759/5759 - 189s - loss: 2.8004 - accuracy20: 0.5421 - val_loss: 2.9353 - val_accuracy20: 0.5183 - 189s/epoch - 33ms/step
Epoch 22/50
5759/5759 - 187s - loss: 2.7978 - accuracy20: 0.5426 - val_loss: 2.9661 - val_accuracy20: 0.5138 - 187s/epoch - 32ms/step
Epoch 23/50
5759/5759 - 188s - loss: 2.7960 - accuracy20: 0.5429 - val_loss: 2.9555 - val_accuracy20: 0.5142 - 188s/epoch - 33ms/step
Epoch 24/50
5759/5759 - 191s - loss: 2.7938 - accuracy20: 0.5435 - val_loss: 2.9497 - val_accuracy20: 0.5156 - 191s/epoch - 33ms/step
Epoch 25/50
5759/5759 - 191s - loss: 2.7920 - accuracy20: 0.5439 - val_loss: 2.9473 - val_accuracy20: 0.5173 - 191s/epoch - 33ms/step
Epoch 26/50
5759/5759 - 191s - loss: 2.7903 - accuracy20: 0.5447 - val_loss: 2.9425 - val_accuracy20: 0.5173 - 191s/epoch - 33ms/step
Epoch 27/50
5759/5759 - 189s - loss: 2.7884 - accuracy20: 0.5449 - val_loss: 2.9645 - val_accuracy20: 0.5141 - 189s/epoch - 33ms/step
Epoch 28/50
5759/5759 - 196s - loss: 2.7871 - accuracy20: 0.5453 - val_loss: 2.9436 - val_accuracy20: 0.5188 - 196s/epoch - 34ms/step
Epoch 29/50
5759/5759 - 194s - loss: 2.7851 - accuracy20: 0.5457 - val_loss: 2.9365 - val_accuracy20: 0.5193 - 194s/epoch - 34ms/step
Epoch 30/50
5759/5759 - 190s - loss: 2.7835 - accuracy20: 0.5460 - val_loss: 2.9573 - val_accuracy20: 0.5154 - 190s/epoch - 33ms/step
Epoch 31/50
5759/5759 - 192s - loss: 2.7821 - accuracy20: 0.5471 - val_loss: 2.9376 - val_accuracy20: 0.5204 - 192s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h20
Evaluating performance on  test set...
31315/31315 - 420s - 420s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.009042
{'0': {'precision': 0.5015511309986883, 'recall': 0.6499133896287467, 'f1-score': 0.5661742759418594, 'support': 3137615}, '1': {'precision': 0.38868799749410377, 'recall': 0.3006738297953211, 'f1-score': 0.3390623158278238, 'support': 1683808}, '2': {'precision': 0.5595221687060907, 'recall': 0.4637576786435823, 'f1-score': 0.5071588242079188, 'support': 3195063}, 'accuracy': 0.5023635044082906, 'macro avg': {'precision': 0.48325376573296097, 'recall': 0.47144829935588334, 'f1-score': 0.470798471992534, 'support': 8016486}, 'weighted avg': {'precision': 0.5009500285393862, 'recall': 0.5023635044082906, 'f1-score': 0.49494967433972437, 'support': 8016486}}
[[2039178  394812  703625]
 [ 714676  506277  462855]
 [1311889  401439 1481735]]
Evaluating performance on  train set...
5759/5759 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97154564
{'0': {'precision': 0.5015770297942503, 'recall': 0.580237544890898, 'f1-score': 0.5380475196984422, 'support': 487571}, '1': {'precision': 0.5244505060088551, 'recall': 0.5867442122276992, 'f1-score': 0.5538512628802398, 'support': 497428}, '2': {'precision': 0.5482191587133263, 'recall': 0.39630969002786337, 'f1-score': 0.4600485525594508, 'support': 489173}, 'accuracy': 0.5214004878670874, 'macro avg': {'precision': 0.5247488981721439, 'recall': 0.5210971490488202, 'f1-score': 0.5173157783793776, 'support': 1474172}, 'weighted avg': {'precision': 0.5247724083906485, 'recall': 0.5214004878670874, 'f1-score': 0.5174978386647184, 'support': 1474172}}
[[282907 127768  76896]
 [122700 291863  82865]
 [158428 136881 193864]]
Evaluating performance on  val set...
2129/2129 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97799677
{'0': {'precision': 0.5025078705587561, 'recall': 0.6093365327682383, 'f1-score': 0.5507900253286979, 'support': 192534}, '1': {'precision': 0.5062911989408941, 'recall': 0.5737082921828706, 'f1-score': 0.5378955480606094, 'support': 159982}, '2': {'precision': 0.5627313925800753, 'recall': 0.3807321332058371, 'f1-score': 0.45417743805290534, 'support': 192424}, 'accuracy': 0.5181542922156568, 'macro avg': {'precision': 0.5238434873599086, 'recall': 0.5212589860523154, 'f1-score': 0.5142876704807375, 'support': 544940}, 'weighted avg': {'precision': 0.5248841238025289, 'recall': 0.5181542922156568, 'f1-score': 0.5128895871955815, 'support': 544940}}
[[117318  43817  31399]
 [ 42670  91783  25529]
 [ 73477  45685  73262]]
training model: results/AAPL/W5/deepVOL_L3/h30
Epoch 1/50
5759/5759 - 197s - loss: 3.1584 - accuracy30: 0.4233 - val_loss: 3.2779 - val_accuracy30: 0.3549 - 197s/epoch - 34ms/step
Epoch 2/50
5759/5759 - 190s - loss: 3.0460 - accuracy30: 0.4756 - val_loss: 3.1099 - val_accuracy30: 0.4670 - 190s/epoch - 33ms/step
Epoch 3/50
5759/5759 - 189s - loss: 3.0018 - accuracy30: 0.4904 - val_loss: 3.1101 - val_accuracy30: 0.4691 - 189s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 196s - loss: 2.9800 - accuracy30: 0.4971 - val_loss: 3.0813 - val_accuracy30: 0.4763 - 196s/epoch - 34ms/step
Epoch 5/50
5759/5759 - 197s - loss: 2.9671 - accuracy30: 0.5010 - val_loss: 3.0725 - val_accuracy30: 0.4772 - 197s/epoch - 34ms/step
Epoch 6/50
5759/5759 - 191s - loss: 2.9585 - accuracy30: 0.5031 - val_loss: 3.0819 - val_accuracy30: 0.4716 - 191s/epoch - 33ms/step
Epoch 7/50
5759/5759 - 194s - loss: 2.9524 - accuracy30: 0.5048 - val_loss: 3.0715 - val_accuracy30: 0.4759 - 194s/epoch - 34ms/step
Epoch 8/50
5759/5759 - 200s - loss: 2.9460 - accuracy30: 0.5066 - val_loss: 3.0744 - val_accuracy30: 0.4738 - 200s/epoch - 35ms/step
Epoch 9/50
5759/5759 - 197s - loss: 2.9410 - accuracy30: 0.5080 - val_loss: 3.0747 - val_accuracy30: 0.4754 - 197s/epoch - 34ms/step
Epoch 10/50
5759/5759 - 198s - loss: 2.9374 - accuracy30: 0.5087 - val_loss: 3.0624 - val_accuracy30: 0.4791 - 198s/epoch - 34ms/step
Epoch 11/50
5759/5759 - 193s - loss: 2.9334 - accuracy30: 0.5102 - val_loss: 3.0642 - val_accuracy30: 0.4772 - 193s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 190s - loss: 2.9299 - accuracy30: 0.5108 - val_loss: 3.0731 - val_accuracy30: 0.4747 - 190s/epoch - 33ms/step
Epoch 13/50
5759/5759 - 191s - loss: 2.9270 - accuracy30: 0.5114 - val_loss: 3.0634 - val_accuracy30: 0.4766 - 191s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 189s - loss: 2.9241 - accuracy30: 0.5124 - val_loss: 3.0492 - val_accuracy30: 0.4789 - 189s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 190s - loss: 2.9212 - accuracy30: 0.5132 - val_loss: 3.0717 - val_accuracy30: 0.4751 - 190s/epoch - 33ms/step
Epoch 16/50
5759/5759 - 190s - loss: 2.9190 - accuracy30: 0.5143 - val_loss: 3.0508 - val_accuracy30: 0.4790 - 190s/epoch - 33ms/step
Epoch 17/50
5759/5759 - 193s - loss: 2.9167 - accuracy30: 0.5145 - val_loss: 3.0708 - val_accuracy30: 0.4762 - 193s/epoch - 34ms/step
Epoch 18/50
5759/5759 - 189s - loss: 2.9143 - accuracy30: 0.5151 - val_loss: 3.0637 - val_accuracy30: 0.4785 - 189s/epoch - 33ms/step
Epoch 19/50
5759/5759 - 196s - loss: 2.9126 - accuracy30: 0.5154 - val_loss: 3.0742 - val_accuracy30: 0.4751 - 196s/epoch - 34ms/step
Epoch 20/50
5759/5759 - 192s - loss: 2.9111 - accuracy30: 0.5164 - val_loss: 3.0693 - val_accuracy30: 0.4770 - 192s/epoch - 33ms/step
Epoch 21/50
5759/5759 - 193s - loss: 2.9091 - accuracy30: 0.5163 - val_loss: 3.0501 - val_accuracy30: 0.4806 - 193s/epoch - 33ms/step
Epoch 22/50
5759/5759 - 189s - loss: 2.9078 - accuracy30: 0.5170 - val_loss: 3.0421 - val_accuracy30: 0.4830 - 189s/epoch - 33ms/step
Epoch 23/50
5759/5759 - 191s - loss: 2.9060 - accuracy30: 0.5176 - val_loss: 3.0354 - val_accuracy30: 0.4840 - 191s/epoch - 33ms/step
Epoch 24/50
5759/5759 - 192s - loss: 2.9044 - accuracy30: 0.5179 - val_loss: 3.0433 - val_accuracy30: 0.4825 - 192s/epoch - 33ms/step
Epoch 25/50
5759/5759 - 193s - loss: 2.9026 - accuracy30: 0.5186 - val_loss: 3.0322 - val_accuracy30: 0.4842 - 193s/epoch - 34ms/step
Epoch 26/50
5759/5759 - 189s - loss: 2.9011 - accuracy30: 0.5190 - val_loss: 3.0356 - val_accuracy30: 0.4845 - 189s/epoch - 33ms/step
Epoch 27/50
5759/5759 - 191s - loss: 2.8995 - accuracy30: 0.5190 - val_loss: 3.0333 - val_accuracy30: 0.4859 - 191s/epoch - 33ms/step
Epoch 28/50
5759/5759 - 192s - loss: 2.8977 - accuracy30: 0.5201 - val_loss: 3.0318 - val_accuracy30: 0.4857 - 192s/epoch - 33ms/step
Epoch 29/50
5759/5759 - 194s - loss: 2.8963 - accuracy30: 0.5200 - val_loss: 3.0280 - val_accuracy30: 0.4868 - 194s/epoch - 34ms/step
Epoch 30/50
5759/5759 - 195s - loss: 2.8948 - accuracy30: 0.5204 - val_loss: 3.0252 - val_accuracy30: 0.4881 - 195s/epoch - 34ms/step
Epoch 31/50
5759/5759 - 195s - loss: 2.8935 - accuracy30: 0.5205 - val_loss: 3.0357 - val_accuracy30: 0.4848 - 195s/epoch - 34ms/step
Epoch 32/50
5759/5759 - 189s - loss: 2.8923 - accuracy30: 0.5214 - val_loss: 3.0278 - val_accuracy30: 0.4872 - 189s/epoch - 33ms/step
Epoch 33/50
5759/5759 - 189s - loss: 2.8910 - accuracy30: 0.5217 - val_loss: 3.0279 - val_accuracy30: 0.4880 - 189s/epoch - 33ms/step
Epoch 34/50
5759/5759 - 191s - loss: 2.8896 - accuracy30: 0.5219 - val_loss: 3.0292 - val_accuracy30: 0.4880 - 191s/epoch - 33ms/step
Epoch 35/50
5759/5759 - 190s - loss: 2.8889 - accuracy30: 0.5222 - val_loss: 3.0341 - val_accuracy30: 0.4870 - 190s/epoch - 33ms/step
Epoch 36/50
5759/5759 - 197s - loss: 2.8875 - accuracy30: 0.5225 - val_loss: 3.0271 - val_accuracy30: 0.4894 - 197s/epoch - 34ms/step
Epoch 37/50
5759/5759 - 193s - loss: 2.8866 - accuracy30: 0.5224 - val_loss: 3.0320 - val_accuracy30: 0.4874 - 193s/epoch - 34ms/step
Epoch 38/50
5759/5759 - 192s - loss: 2.8856 - accuracy30: 0.5229 - val_loss: 3.0339 - val_accuracy30: 0.4868 - 192s/epoch - 33ms/step
Epoch 39/50
5759/5759 - 189s - loss: 2.8841 - accuracy30: 0.5232 - val_loss: 3.0411 - val_accuracy30: 0.4847 - 189s/epoch - 33ms/step
Epoch 40/50
5759/5759 - 194s - loss: 2.8827 - accuracy30: 0.5237 - val_loss: 3.0344 - val_accuracy30: 0.4874 - 194s/epoch - 34ms/step
testing model: results/AAPL/W5/deepVOL_L3/h30
Evaluating performance on  test set...
31315/31315 - 416s - 416s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0387762
{'0': {'precision': 0.47865447386223053, 'recall': 0.6202301863582058, 'f1-score': 0.5403223182043635, 'support': 3105310}, '1': {'precision': 0.32100227520231384, 'recall': 0.29388682410380174, 'f1-score': 0.30684667949313343, 'support': 1731146}, '2': {'precision': 0.5418813528489753, 'recall': 0.410288582183187, 'f1-score': 0.46699170766067843, 'support': 3180030}, 'accuracy': 0.46647595966611805, 'macro avg': {'precision': 0.4471793673045066, 'recall': 0.4414685308817315, 'f1-score': 0.43805356845272514, 'support': 8016486}, 'weighted avg': {'precision': 0.4696909952112229, 'recall': 0.46647595966611805, 'f1-score': 0.46081441916984567, 'support': 8016486}}
[[1926007  549594  629709]
 [ 749046  508761  473339]
 [1348741  526559 1304730]]
Evaluating performance on  train set...
5759/5759 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9992869
{'0': {'precision': 0.49223057449485147, 'recall': 0.5121479243087762, 'f1-score': 0.5019917636810011, 'support': 495064}, '1': {'precision': 0.4756830587538839, 'recall': 0.5930793051266087, 'f1-score': 0.527933593997326, 'support': 485038}, '2': {'precision': 0.5252742476709762, 'recall': 0.3767118019713806, 'f1-score': 0.4387584673792997, 'support': 494070}, 'accuracy': 0.4933847610726564, 'macro avg': {'precision': 0.49772929363990387, 'recall': 0.4939796771355885, 'f1-score': 0.4895612750192089, 'support': 1474172}, 'weighted avg': {'precision': 0.49786065949589653, 'recall': 0.4933847610726564, 'f1-score': 0.48933455596656067, 'support': 1474172}}
[[253546 161679  79839]
 [109000 287666  88372]
 [152550 155398 186122]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0092106
{'0': {'precision': 0.4823766364551863, 'recall': 0.5605939487034802, 'f1-score': 0.5185523489170647, 'support': 191397}, '1': {'precision': 0.4612977758260184, 'recall': 0.5736600078193361, 'f1-score': 0.5113794782146889, 'support': 161139}, '2': {'precision': 0.5405301386352656, 'recall': 0.3430749880459866, 'f1-score': 0.4197403687488673, 'support': 192404}, 'accuracy': 0.48765735677322275, 'macro avg': {'precision': 0.4947348503054901, 'recall': 0.49244298152293425, 'f1-score': 0.4832240652935403, 'support': 544940}, 'weighted avg': {'precision': 0.49667608210155567, 'recall': 0.48765735677322275, 'f1-score': 0.48154341317296073, 'support': 544940}}
[[107296  54716  29385]
 [ 41975  92439  26725]
 [ 73161  53234  66009]]
training model: results/AAPL/W5/deepVOL_L3/h50
Epoch 1/50
5759/5759 - 200s - loss: 3.2238 - accuracy50: 0.3964 - val_loss: 3.3233 - val_accuracy50: 0.3114 - 200s/epoch - 35ms/step
Epoch 2/50
5759/5759 - 193s - loss: 3.1593 - accuracy50: 0.4295 - val_loss: 3.3132 - val_accuracy50: 0.3331 - 193s/epoch - 34ms/step
Epoch 3/50
5759/5759 - 190s - loss: 3.1282 - accuracy50: 0.4480 - val_loss: 3.2855 - val_accuracy50: 0.3756 - 190s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 192s - loss: 3.1138 - accuracy50: 0.4547 - val_loss: 3.2222 - val_accuracy50: 0.4264 - 192s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 191s - loss: 3.1047 - accuracy50: 0.4582 - val_loss: 3.2330 - val_accuracy50: 0.4159 - 191s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 195s - loss: 3.0977 - accuracy50: 0.4612 - val_loss: 3.2132 - val_accuracy50: 0.4334 - 195s/epoch - 34ms/step
Epoch 7/50
5759/5759 - 188s - loss: 3.0919 - accuracy50: 0.4629 - val_loss: 3.2366 - val_accuracy50: 0.4158 - 188s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 191s - loss: 3.0869 - accuracy50: 0.4650 - val_loss: 3.2314 - val_accuracy50: 0.4204 - 191s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 191s - loss: 3.0821 - accuracy50: 0.4661 - val_loss: 3.2173 - val_accuracy50: 0.4306 - 191s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 190s - loss: 3.0784 - accuracy50: 0.4674 - val_loss: 3.2008 - val_accuracy50: 0.4336 - 190s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 189s - loss: 3.0750 - accuracy50: 0.4685 - val_loss: 3.2271 - val_accuracy50: 0.4267 - 189s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 197s - loss: 3.0716 - accuracy50: 0.4693 - val_loss: 3.1959 - val_accuracy50: 0.4361 - 197s/epoch - 34ms/step
Epoch 13/50
5759/5759 - 198s - loss: 3.0687 - accuracy50: 0.4703 - val_loss: 3.2057 - val_accuracy50: 0.4338 - 198s/epoch - 34ms/step
Epoch 14/50
5759/5759 - 196s - loss: 3.0660 - accuracy50: 0.4710 - val_loss: 3.2025 - val_accuracy50: 0.4327 - 196s/epoch - 34ms/step
Epoch 15/50
5759/5759 - 197s - loss: 3.0639 - accuracy50: 0.4718 - val_loss: 3.2039 - val_accuracy50: 0.4314 - 197s/epoch - 34ms/step
Epoch 16/50
5759/5759 - 199s - loss: 3.0615 - accuracy50: 0.4727 - val_loss: 3.1935 - val_accuracy50: 0.4347 - 199s/epoch - 34ms/step
Epoch 17/50
5759/5759 - 196s - loss: 3.0594 - accuracy50: 0.4734 - val_loss: 3.1869 - val_accuracy50: 0.4346 - 196s/epoch - 34ms/step
Epoch 18/50
5759/5759 - 196s - loss: 3.0578 - accuracy50: 0.4736 - val_loss: 3.1881 - val_accuracy50: 0.4350 - 196s/epoch - 34ms/step
Epoch 19/50
5759/5759 - 197s - loss: 3.0558 - accuracy50: 0.4746 - val_loss: 3.1879 - val_accuracy50: 0.4347 - 197s/epoch - 34ms/step
Epoch 20/50
5759/5759 - 197s - loss: 3.0544 - accuracy50: 0.4751 - val_loss: 3.1888 - val_accuracy50: 0.4355 - 197s/epoch - 34ms/step
Epoch 21/50
5759/5759 - 198s - loss: 3.0526 - accuracy50: 0.4759 - val_loss: 3.1982 - val_accuracy50: 0.4325 - 198s/epoch - 34ms/step
Epoch 22/50
5759/5759 - 196s - loss: 3.0513 - accuracy50: 0.4762 - val_loss: 3.1926 - val_accuracy50: 0.4349 - 196s/epoch - 34ms/step
Epoch 23/50
5759/5759 - 197s - loss: 3.0497 - accuracy50: 0.4770 - val_loss: 3.1851 - val_accuracy50: 0.4368 - 197s/epoch - 34ms/step
Epoch 24/50
5759/5759 - 197s - loss: 3.0482 - accuracy50: 0.4773 - val_loss: 3.1900 - val_accuracy50: 0.4339 - 197s/epoch - 34ms/step
Epoch 25/50
5759/5759 - 197s - loss: 3.0468 - accuracy50: 0.4780 - val_loss: 3.1893 - val_accuracy50: 0.4334 - 197s/epoch - 34ms/step
Epoch 26/50
5759/5759 - 198s - loss: 3.0454 - accuracy50: 0.4785 - val_loss: 3.1958 - val_accuracy50: 0.4326 - 198s/epoch - 34ms/step
Epoch 27/50
5759/5759 - 198s - loss: 3.0440 - accuracy50: 0.4788 - val_loss: 3.2007 - val_accuracy50: 0.4337 - 198s/epoch - 34ms/step
Epoch 28/50
5759/5759 - 198s - loss: 3.0424 - accuracy50: 0.4792 - val_loss: 3.1912 - val_accuracy50: 0.4342 - 198s/epoch - 34ms/step
Epoch 29/50
5759/5759 - 196s - loss: 3.0412 - accuracy50: 0.4795 - val_loss: 3.2056 - val_accuracy50: 0.4257 - 196s/epoch - 34ms/step
Epoch 30/50
5759/5759 - 195s - loss: 3.0394 - accuracy50: 0.4804 - val_loss: 3.2012 - val_accuracy50: 0.4302 - 195s/epoch - 34ms/step
Epoch 31/50
5759/5759 - 196s - loss: 3.0382 - accuracy50: 0.4809 - val_loss: 3.2043 - val_accuracy50: 0.4308 - 196s/epoch - 34ms/step
Epoch 32/50
5759/5759 - 197s - loss: 3.0373 - accuracy50: 0.4812 - val_loss: 3.2078 - val_accuracy50: 0.4308 - 197s/epoch - 34ms/step
Epoch 33/50
5759/5759 - 196s - loss: 3.0354 - accuracy50: 0.4818 - val_loss: 3.2142 - val_accuracy50: 0.4272 - 196s/epoch - 34ms/step
testing model: results/AAPL/W5/deepVOL_L3/h50
Evaluating performance on  test set...
31315/31315 - 421s - 421s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0855633
{'0': {'precision': 0.44637597185057204, 'recall': 0.5534145717871012, 'f1-score': 0.49416544073107405, 'support': 3062507}, '1': {'precision': 0.2721344938054603, 'recall': 0.31921721558164, 'f1-score': 0.2938015194589816, 'support': 1804226}, '2': {'precision': 0.49943562888629184, 'recall': 0.33349472164960237, 'f1-score': 0.3999353509694213, 'support': 3149753}, 'accuracy': 0.41429648851130035, 'macro avg': {'precision': 0.40598203151410805, 'recall': 0.4020421696727812, 'f1-score': 0.39596743705315895, 'support': 8016486}, 'weighted avg': {'precision': 0.42800804966618977, 'recall': 0.41429648851130035, 'f1-score': 0.4120467537979094, 'support': 8016486}}
[[1694836  757699  609972]
 [ 785458  575940  442828]
 [1316586  782741 1050426]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0533313
{'0': {'precision': 0.45669542647226674, 'recall': 0.43402775685333944, 'f1-score': 0.4450731612864687, 'support': 497823}, '1': {'precision': 0.4091309536368855, 'recall': 0.6241576509539655, 'f1-score': 0.4942708432474573, 'support': 478424}, '2': {'precision': 0.4917419216856141, 'recall': 0.2678214590550786, 'f1-score': 0.3467756405422343, 'support': 497925}, 'accuracy': 0.4395932089335573, 'macro avg': {'precision': 0.45252276726492213, 'recall': 0.4420022889541279, 'f1-score': 0.4287065483587201, 'support': 1474172}, 'weighted avg': {'precision': 0.4530964846780335, 'recall': 0.4395932089335573, 'f1-score': 0.4278381024045548, 'support': 1474172}}
[[216069 211145  70609]
 [112587 298612  67225]
 [144458 220112 133355]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0647657
{'0': {'precision': 0.4467881159306304, 'recall': 0.4827822484264202, 'f1-score': 0.4640883131604276, 'support': 188265}, '1': {'precision': 0.4049612731922391, 'recall': 0.6002176278563656, 'f1-score': 0.4836251427792079, 'support': 165420}, '2': {'precision': 0.5011886347828796, 'recall': 0.2524326161407545, 'f1-score': 0.3357558139534884, 'support': 191255}, 'accuracy': 0.43758578926120306, 'macro avg': {'precision': 0.45097934130191636, 'recall': 0.44514416414118, 'f1-score': 0.4278230899643746, 'support': 544940}, 'weighted avg': {'precision': 0.4531840033811795, 'recall': 0.43758578926120306, 'f1-score': 0.4249785950625003, 'support': 544940}}
[[90891 71106 26268]
 [44350 99288 21782]
 [68191 74785 48279]]
training model: results/AAPL/W5/deepVOL_L3/h100
Epoch 1/50
5759/5759 - 202s - loss: 3.2085 - accuracy100: 0.4074 - val_loss: 3.3900 - val_accuracy100: 0.3052 - 202s/epoch - 35ms/step
Epoch 2/50
5759/5759 - 198s - loss: 3.1864 - accuracy100: 0.4185 - val_loss: 3.3721 - val_accuracy100: 0.3045 - 198s/epoch - 34ms/step
Epoch 3/50
5759/5759 - 191s - loss: 3.1811 - accuracy100: 0.4211 - val_loss: 3.3843 - val_accuracy100: 0.3054 - 191s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 191s - loss: 3.1794 - accuracy100: 0.4218 - val_loss: 3.3774 - val_accuracy100: 0.3066 - 191s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 189s - loss: 3.1740 - accuracy100: 0.4245 - val_loss: 3.3882 - val_accuracy100: 0.3069 - 189s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 191s - loss: 3.1705 - accuracy100: 0.4263 - val_loss: 3.3960 - val_accuracy100: 0.3079 - 191s/epoch - 33ms/step
Epoch 7/50
5759/5759 - 188s - loss: 3.1648 - accuracy100: 0.4289 - val_loss: 3.3941 - val_accuracy100: 0.3096 - 188s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 192s - loss: 3.1600 - accuracy100: 0.4315 - val_loss: 3.4034 - val_accuracy100: 0.3086 - 192s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 192s - loss: 3.1554 - accuracy100: 0.4332 - val_loss: 3.4089 - val_accuracy100: 0.3098 - 192s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 191s - loss: 3.1512 - accuracy100: 0.4354 - val_loss: 3.4274 - val_accuracy100: 0.3100 - 191s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 189s - loss: 3.1471 - accuracy100: 0.4370 - val_loss: 3.4185 - val_accuracy100: 0.3111 - 189s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 192s - loss: 3.1433 - accuracy100: 0.4386 - val_loss: 3.4247 - val_accuracy100: 0.3106 - 192s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h100
Evaluating performance on  test set...
31315/31315 - 417s - 417s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.190741
{'0': {'precision': 0.5894270981363433, 'recall': 0.008747349116964839, 'f1-score': 0.01723886612031997, 'support': 3319177}, '1': {'precision': 0.1590391456124746, 'recall': 0.9920992838898726, 'f1-score': 0.2741331857729826, 'support': 1276340}, '2': {'precision': 0.5180654873917953, 'recall': 0.0008047427497881449, 'f1-score': 0.001606989265043197, 'support': 3420969}, 'accuracy': 0.1619216948673022, 'macro avg': {'precision': 0.42217724371353765, 'recall': 0.33388379191887513, 'f1-score': 0.09765968038611528, 'support': 8016486}, 'weighted avg': {'precision': 0.4904501626721661, 'recall': 0.1619216948673022, 'f1-score': 0.0514693668424269, 'support': 8016486}}
[[  29034 3288688    1455]
 [   8978 1266256    1106]
 [  11246 3406970    2753]]
Evaluating performance on  train set...
5759/5759 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1084887
{'0': {'precision': 0.5450515857852503, 'recall': 0.02900572427887304, 'f1-score': 0.05508027069033759, 'support': 491765}, '1': {'precision': 0.3304139124851769, 'recall': 0.9816303878645866, 'f1-score': 0.49441064906454196, 'support': 486510}, '2': {'precision': 0.4378810975609756, 'recall': 0.002317013412059359, 'f1-score': 0.004609635301221012, 'support': 495897}, 'accuracy': 0.3344155227476848, 'macro avg': {'precision': 0.4377821986104675, 'recall': 0.33765104185183964, 'f1-score': 0.1847001850187002, 'support': 1474172}, 'weighted avg': {'precision': 0.43816521293583255, 'recall': 0.3344155227476848, 'f1-score': 0.18309137502909686, 'support': 1474172}}
[[ 14264 476975    526]
 [  7988 477573    949]
 [  3918 490830   1149]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1258171
{'0': {'precision': 0.465183625115177, 'recall': 0.018823003051947014, 'f1-score': 0.0361819540712377, 'support': 187749}, '1': {'precision': 0.30213928643268495, 'recall': 0.9829907652034806, 'f1-score': 0.46221022999247796, 'support': 165028}, '2': {'precision': 0.4735632183908046, 'recall': 0.0010720065777490985, 'f1-score': 0.002139170707899355, 'support': 192163}, 'accuracy': 0.3045491246742761, 'macro avg': {'precision': 0.41362870997955553, 'recall': 0.3342952582777256, 'f1-score': 0.16684378492387167, 'support': 544940}, 'weighted avg': {'precision': 0.41876267355818014, 'recall': 0.3045491246742761, 'f1-score': 0.15319452598609298, 'support': 544940}}
[[  3534 184133     82]
 [  2660 162221    147]
 [  1403 190554    206]]
training model: results/AAPL/W5/deepVOL_L3/h200
Epoch 1/50
5759/5759 - 196s - loss: 3.2495 - accuracy200: 0.3863 - val_loss: 3.3432 - val_accuracy200: 0.3158 - 196s/epoch - 34ms/step
Epoch 2/50
5759/5759 - 199s - loss: 3.2403 - accuracy200: 0.3910 - val_loss: 3.3367 - val_accuracy200: 0.3159 - 199s/epoch - 35ms/step
Epoch 3/50
5759/5759 - 193s - loss: 3.2344 - accuracy200: 0.3936 - val_loss: 3.3445 - val_accuracy200: 0.3163 - 193s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 191s - loss: 3.2290 - accuracy200: 0.3981 - val_loss: 3.3405 - val_accuracy200: 0.3163 - 191s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 191s - loss: 3.2278 - accuracy200: 0.4000 - val_loss: 3.3427 - val_accuracy200: 0.3164 - 191s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 195s - loss: 3.2221 - accuracy200: 0.4027 - val_loss: 3.3464 - val_accuracy200: 0.3164 - 195s/epoch - 34ms/step
Epoch 7/50
5759/5759 - 194s - loss: 3.2180 - accuracy200: 0.4057 - val_loss: 3.3360 - val_accuracy200: 0.3165 - 194s/epoch - 34ms/step
Epoch 8/50
5759/5759 - 190s - loss: 3.2108 - accuracy200: 0.4103 - val_loss: 3.3295 - val_accuracy200: 0.3167 - 190s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 192s - loss: 3.2057 - accuracy200: 0.4133 - val_loss: 3.3288 - val_accuracy200: 0.3173 - 192s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 192s - loss: 3.2016 - accuracy200: 0.4158 - val_loss: 3.3320 - val_accuracy200: 0.3167 - 192s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 191s - loss: 3.1981 - accuracy200: 0.4175 - val_loss: 3.3320 - val_accuracy200: 0.3169 - 191s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 192s - loss: 3.1956 - accuracy200: 0.4198 - val_loss: 3.3328 - val_accuracy200: 0.3178 - 192s/epoch - 33ms/step
Epoch 13/50
5759/5759 - 192s - loss: 3.1933 - accuracy200: 0.4202 - val_loss: 3.3342 - val_accuracy200: 0.3188 - 192s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 193s - loss: 3.1907 - accuracy200: 0.4218 - val_loss: 3.3272 - val_accuracy200: 0.3257 - 193s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 193s - loss: 3.1885 - accuracy200: 0.4227 - val_loss: 3.3295 - val_accuracy200: 0.3278 - 193s/epoch - 34ms/step
Epoch 16/50
5759/5759 - 190s - loss: 3.1862 - accuracy200: 0.4241 - val_loss: 3.3215 - val_accuracy200: 0.3371 - 190s/epoch - 33ms/step
Epoch 17/50
5759/5759 - 191s - loss: 3.1843 - accuracy200: 0.4248 - val_loss: 3.3281 - val_accuracy200: 0.3337 - 191s/epoch - 33ms/step
Epoch 18/50
5759/5759 - 194s - loss: 3.1826 - accuracy200: 0.4254 - val_loss: 3.3381 - val_accuracy200: 0.3318 - 194s/epoch - 34ms/step
Epoch 19/50
5759/5759 - 193s - loss: 3.1808 - accuracy200: 0.4266 - val_loss: 3.3305 - val_accuracy200: 0.3349 - 193s/epoch - 33ms/step
Epoch 20/50
5759/5759 - 193s - loss: 3.1795 - accuracy200: 0.4269 - val_loss: 3.3325 - val_accuracy200: 0.3342 - 193s/epoch - 34ms/step
Epoch 21/50
5759/5759 - 191s - loss: 3.1778 - accuracy200: 0.4276 - val_loss: 3.3141 - val_accuracy200: 0.3440 - 191s/epoch - 33ms/step
Epoch 22/50
5759/5759 - 193s - loss: 3.1758 - accuracy200: 0.4283 - val_loss: 3.3070 - val_accuracy200: 0.3487 - 193s/epoch - 34ms/step
Epoch 23/50
5759/5759 - 193s - loss: 3.1745 - accuracy200: 0.4293 - val_loss: 3.3049 - val_accuracy200: 0.3493 - 193s/epoch - 34ms/step
Epoch 24/50
5759/5759 - 194s - loss: 3.1727 - accuracy200: 0.4303 - val_loss: 3.3068 - val_accuracy200: 0.3472 - 194s/epoch - 34ms/step
Epoch 25/50
5759/5759 - 190s - loss: 3.1715 - accuracy200: 0.4305 - val_loss: 3.3054 - val_accuracy200: 0.3536 - 190s/epoch - 33ms/step
Epoch 26/50
5759/5759 - 189s - loss: 3.1701 - accuracy200: 0.4309 - val_loss: 3.3116 - val_accuracy200: 0.3495 - 189s/epoch - 33ms/step
Epoch 27/50
5759/5759 - 192s - loss: 3.1684 - accuracy200: 0.4319 - val_loss: 3.3103 - val_accuracy200: 0.3511 - 192s/epoch - 33ms/step
Epoch 28/50
5759/5759 - 192s - loss: 3.1670 - accuracy200: 0.4326 - val_loss: 3.3100 - val_accuracy200: 0.3529 - 192s/epoch - 33ms/step
Epoch 29/50
5759/5759 - 195s - loss: 3.1655 - accuracy200: 0.4335 - val_loss: 3.3092 - val_accuracy200: 0.3546 - 195s/epoch - 34ms/step
Epoch 30/50
5759/5759 - 191s - loss: 3.1639 - accuracy200: 0.4339 - val_loss: 3.3216 - val_accuracy200: 0.3475 - 191s/epoch - 33ms/step
Epoch 31/50
5759/5759 - 189s - loss: 3.1626 - accuracy200: 0.4346 - val_loss: 3.3216 - val_accuracy200: 0.3493 - 189s/epoch - 33ms/step
Epoch 32/50
5759/5759 - 191s - loss: 3.1613 - accuracy200: 0.4354 - val_loss: 3.3281 - val_accuracy200: 0.3470 - 191s/epoch - 33ms/step
Epoch 33/50
5759/5759 - 191s - loss: 3.1597 - accuracy200: 0.4358 - val_loss: 3.3328 - val_accuracy200: 0.3466 - 191s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h200
Evaluating performance on  test set...
31315/31315 - 424s - 424s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1177374
{'0': {'precision': 0.40815555168012396, 'recall': 0.19983853096401333, 'f1-score': 0.2683092095167743, 'support': 3009865}, '1': {'precision': 0.2459533325982377, 'recall': 0.5706645877505049, 'f1-score': 0.3437515970580115, 'support': 1903556}, '2': {'precision': 0.4096124649367215, 'recall': 0.28065799459566587, 'f1-score': 0.33308976614298763, 'support': 3103065}, 'accuracy': 0.3191771307278526, 'macro avg': {'precision': 0.3545737830716944, 'recall': 0.3503870377700613, 'f1-score': 0.31505019090592445, 'support': 8016486}, 'weighted avg': {'precision': 0.37020374701009084, 'recall': 0.3191771307278526, 'f1-score': 0.3112990042230543, 'support': 8016486}}
[[ 601487 1621288  787090]
 [ 349098 1086292  468166]
 [ 523086 1709079  870900]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937169
{'0': {'precision': 0.39632115515011396, 'recall': 0.271891931768814, 'f1-score': 0.32252144288723295, 'support': 487988}, '1': {'precision': 0.3490914348623519, 'recall': 0.6297473033920166, 'f1-score': 0.4491840814021539, 'support': 486908}, '2': {'precision': 0.40021453472780905, 'recall': 0.20923897804020222, 'f1-score': 0.27480514424455416, 'support': 499276}, 'accuracy': 0.368869439929669, 'macro avg': {'precision': 0.3818757082467583, 'recall': 0.3702927377336776, 'f1-score': 0.3488368895113137, 'support': 1474172}, 'weighted avg': {'precision': 0.3820401501765828, 'recall': 0.368869439929669, 'f1-score': 0.34819649930731217, 'support': 1474172}}
[[132680 274062  81246]
 [104963 306629  75316]
 [ 97136 297672 104468]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024059
{'0': {'precision': 0.3740910272672124, 'recall': 0.25728373655549835, 'f1-score': 0.3048824337686687, 'support': 184555}, '1': {'precision': 0.3275202312506765, 'recall': 0.597892730326435, 'f1-score': 0.42320990396738717, 'support': 172071}, '2': {'precision': 0.38479012060485307, 'recall': 0.2122890491413278, 'f1-score': 0.2736210973727529, 'support': 188314}, 'accuracy': 0.349286159944214, 'macro avg': {'precision': 0.36213379304091403, 'recall': 0.35582183867442035, 'f1-score': 0.33390447836960296, 'support': 544940}, 'weighted avg': {'precision': 0.36308303670205494, 'recall': 0.349286159944214, 'f1-score': 0.3314427501750679, 'support': 544940}}
[[ 47483 101410  35662]
 [ 40937 102880  28254]
 [ 38509 109828  39977]]
training model: results/AAPL/W5/deepVOL_L3/h300
Epoch 1/50
5759/5759 - 202s - loss: 3.2286 - accuracy300: 0.3977 - val_loss: 3.4385 - val_accuracy300: 0.3202 - 202s/epoch - 35ms/step
Epoch 2/50
5759/5759 - 191s - loss: 3.2318 - accuracy300: 0.3945 - val_loss: 3.4614 - val_accuracy300: 0.3202 - 191s/epoch - 33ms/step
Epoch 3/50
5759/5759 - 191s - loss: 3.2330 - accuracy300: 0.3934 - val_loss: 3.4260 - val_accuracy300: 0.3202 - 191s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 188s - loss: 3.2226 - accuracy300: 0.4017 - val_loss: 3.4526 - val_accuracy300: 0.3202 - 188s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 189s - loss: 3.2159 - accuracy300: 0.4062 - val_loss: 3.4412 - val_accuracy300: 0.3202 - 189s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 190s - loss: 3.2104 - accuracy300: 0.4084 - val_loss: 3.4305 - val_accuracy300: 0.3202 - 190s/epoch - 33ms/step
Epoch 7/50
5759/5759 - 190s - loss: 3.1997 - accuracy300: 0.4141 - val_loss: 3.4665 - val_accuracy300: 0.3202 - 190s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 194s - loss: 3.1889 - accuracy300: 0.4210 - val_loss: 3.4571 - val_accuracy300: 0.3202 - 194s/epoch - 34ms/step
Epoch 9/50
5759/5759 - 191s - loss: 3.1829 - accuracy300: 0.4243 - val_loss: 3.4486 - val_accuracy300: 0.3202 - 191s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 191s - loss: 3.1792 - accuracy300: 0.4258 - val_loss: 3.4369 - val_accuracy300: 0.3202 - 191s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 193s - loss: 3.1745 - accuracy300: 0.4283 - val_loss: 3.4315 - val_accuracy300: 0.3201 - 193s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 191s - loss: 3.1706 - accuracy300: 0.4302 - val_loss: 3.4347 - val_accuracy300: 0.3201 - 191s/epoch - 33ms/step
Epoch 13/50
5759/5759 - 191s - loss: 3.1679 - accuracy300: 0.4315 - val_loss: 3.4350 - val_accuracy300: 0.3201 - 191s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h300
Evaluating performance on  test set...
31315/31315 - 419s - 419s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.212028
{'0': {'precision': 0.5, 'recall': 3.1464895402821455e-07, 'f1-score': 6.292975120408213e-07, 'support': 3178145}, '1': {'precision': 0.19808853785095978, 'recall': 0.9999993702667676, 'f1-score': 0.3306742548119596, 'support': 1587974}, '2': {'precision': 0.3333333333333333, 'recall': 3.076575660533103e-07, 'f1-score': 6.153145641880772e-07, 'support': 3250367}, 'accuracy': 0.1980886637861028, 'macro avg': {'precision': 0.3438072903947644, 'recall': 0.33333333085776257, 'f1-score': 0.11022516647467862, 'support': 8016486}, 'weighted avg': {'precision': 0.37261807910249034, 'recall': 0.1980886637861028, 'f1-score': 0.06550327900624565, 'support': 8016486}}
[[      1 3178142       2]
 [      1 1587973       0]
 [      0 3250366       1]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1366998
{'0': {'precision': 1.0, 'recall': 4.087939760119695e-06, 'f1-score': 8.175846097873054e-06, 'support': 489244}, '1': {'precision': 0.3303447569444209, 'recall': 1.0, 'f1-score': 0.49663029860495334, 'support': 486984}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 497944}, 'accuracy': 0.33034544137319116, 'macro avg': {'precision': 0.44344825231480695, 'recall': 0.33333469597992, 'f1-score': 0.1655461581503504, 'support': 1474172}, 'weighted avg': {'precision': 0.44100458502523576, 'recall': 0.33034544137319116, 'f1-score': 0.16406159479320112, 'support': 1474172}}
[[     2 489241      1]
 [     0 486984      0]
 [     0 497944      0]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1436985
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 184029}, '1': {'precision': 0.32018754358277973, 'recall': 1.0, 'f1-score': 0.4850637246793611, 'support': 174483}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 186428}, 'accuracy': 0.32018754358277973, 'macro avg': {'precision': 0.1067291811942599, 'recall': 0.3333333333333333, 'f1-score': 0.1616879082264537, 'support': 544940}, 'weighted avg': {'precision': 0.10252006306557447, 'recall': 0.32018754358277973, 'f1-score': 0.15531136248619842, 'support': 544940}}
[[     0 184029      0]
 [     0 174483      0]
 [     0 186428      0]]
training model: results/AAPL/W5/deepVOL_L3/h500
Epoch 1/50
5759/5759 - 200s - loss: 3.2473 - accuracy500: 0.3884 - val_loss: 3.4414 - val_accuracy500: 0.3024 - 200s/epoch - 35ms/step
Epoch 2/50
5759/5759 - 207s - loss: 3.2491 - accuracy500: 0.3812 - val_loss: 3.4190 - val_accuracy500: 0.3024 - 207s/epoch - 36ms/step
Epoch 3/50
5759/5759 - 190s - loss: 3.2491 - accuracy500: 0.3820 - val_loss: 3.4344 - val_accuracy500: 0.3028 - 190s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 191s - loss: 3.2446 - accuracy500: 0.3861 - val_loss: 3.4183 - val_accuracy500: 0.3024 - 191s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 195s - loss: 3.2413 - accuracy500: 0.3907 - val_loss: 3.4108 - val_accuracy500: 0.3027 - 195s/epoch - 34ms/step
Epoch 6/50
5759/5759 - 195s - loss: 3.2307 - accuracy500: 0.3976 - val_loss: 3.4410 - val_accuracy500: 0.3026 - 195s/epoch - 34ms/step
Epoch 7/50
5759/5759 - 191s - loss: 3.2221 - accuracy500: 0.4020 - val_loss: 3.4191 - val_accuracy500: 0.3028 - 191s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 191s - loss: 3.2096 - accuracy500: 0.4107 - val_loss: 3.4180 - val_accuracy500: 0.3033 - 191s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 193s - loss: 3.1993 - accuracy500: 0.4174 - val_loss: 3.4306 - val_accuracy500: 0.3051 - 193s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 195s - loss: 3.1916 - accuracy500: 0.4216 - val_loss: 3.4142 - val_accuracy500: 0.3047 - 195s/epoch - 34ms/step
Epoch 11/50
5759/5759 - 189s - loss: 3.1874 - accuracy500: 0.4234 - val_loss: 3.4139 - val_accuracy500: 0.3063 - 189s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 196s - loss: 3.1836 - accuracy500: 0.4253 - val_loss: 3.4256 - val_accuracy500: 0.3082 - 196s/epoch - 34ms/step
Epoch 13/50
5759/5759 - 191s - loss: 3.1805 - accuracy500: 0.4265 - val_loss: 3.4202 - val_accuracy500: 0.3067 - 191s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 188s - loss: 3.1773 - accuracy500: 0.4278 - val_loss: 3.4068 - val_accuracy500: 0.3103 - 188s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 193s - loss: 3.1744 - accuracy500: 0.4291 - val_loss: 3.4054 - val_accuracy500: 0.3106 - 193s/epoch - 33ms/step
Epoch 16/50
5759/5759 - 190s - loss: 3.1714 - accuracy500: 0.4306 - val_loss: 3.4162 - val_accuracy500: 0.3074 - 190s/epoch - 33ms/step
Epoch 17/50
5759/5759 - 189s - loss: 3.1694 - accuracy500: 0.4316 - val_loss: 3.3773 - val_accuracy500: 0.3205 - 189s/epoch - 33ms/step
Epoch 18/50
5759/5759 - 189s - loss: 3.1671 - accuracy500: 0.4327 - val_loss: 3.3815 - val_accuracy500: 0.3181 - 189s/epoch - 33ms/step
Epoch 19/50
5759/5759 - 190s - loss: 3.1642 - accuracy500: 0.4337 - val_loss: 3.3734 - val_accuracy500: 0.3245 - 190s/epoch - 33ms/step
Epoch 20/50
5759/5759 - 194s - loss: 3.1620 - accuracy500: 0.4346 - val_loss: 3.3769 - val_accuracy500: 0.3229 - 194s/epoch - 34ms/step
Epoch 21/50
5759/5759 - 192s - loss: 3.1597 - accuracy500: 0.4359 - val_loss: 3.3794 - val_accuracy500: 0.3198 - 192s/epoch - 33ms/step
Epoch 22/50
5759/5759 - 193s - loss: 3.1569 - accuracy500: 0.4369 - val_loss: 3.3732 - val_accuracy500: 0.3200 - 193s/epoch - 33ms/step
Epoch 23/50
5759/5759 - 194s - loss: 3.1552 - accuracy500: 0.4379 - val_loss: 3.3775 - val_accuracy500: 0.3200 - 194s/epoch - 34ms/step
Epoch 24/50
5759/5759 - 192s - loss: 3.1529 - accuracy500: 0.4389 - val_loss: 3.3861 - val_accuracy500: 0.3219 - 192s/epoch - 33ms/step
Epoch 25/50
5759/5759 - 191s - loss: 3.1504 - accuracy500: 0.4396 - val_loss: 3.3950 - val_accuracy500: 0.3172 - 191s/epoch - 33ms/step
Epoch 26/50
5759/5759 - 192s - loss: 3.1476 - accuracy500: 0.4406 - val_loss: 3.3918 - val_accuracy500: 0.3198 - 192s/epoch - 33ms/step
Epoch 27/50
5759/5759 - 190s - loss: 3.1447 - accuracy500: 0.4419 - val_loss: 3.3905 - val_accuracy500: 0.3239 - 190s/epoch - 33ms/step
Epoch 28/50
5759/5759 - 190s - loss: 3.1427 - accuracy500: 0.4428 - val_loss: 3.3813 - val_accuracy500: 0.3269 - 190s/epoch - 33ms/step
Epoch 29/50
5759/5759 - 191s - loss: 3.1405 - accuracy500: 0.4435 - val_loss: 3.3676 - val_accuracy500: 0.3336 - 191s/epoch - 33ms/step
Epoch 30/50
5759/5759 - 190s - loss: 3.1385 - accuracy500: 0.4447 - val_loss: 3.3652 - val_accuracy500: 0.3311 - 190s/epoch - 33ms/step
Epoch 31/50
5759/5759 - 190s - loss: 3.1358 - accuracy500: 0.4450 - val_loss: 3.3709 - val_accuracy500: 0.3321 - 190s/epoch - 33ms/step
Epoch 32/50
5759/5759 - 193s - loss: 3.1333 - accuracy500: 0.4464 - val_loss: 3.3728 - val_accuracy500: 0.3349 - 193s/epoch - 33ms/step
Epoch 33/50
5759/5759 - 193s - loss: 3.1302 - accuracy500: 0.4479 - val_loss: 3.3854 - val_accuracy500: 0.3337 - 193s/epoch - 34ms/step
Epoch 34/50
5759/5759 - 190s - loss: 3.1277 - accuracy500: 0.4484 - val_loss: 3.3764 - val_accuracy500: 0.3371 - 190s/epoch - 33ms/step
Epoch 35/50
5759/5759 - 190s - loss: 3.1240 - accuracy500: 0.4496 - val_loss: 3.3735 - val_accuracy500: 0.3421 - 190s/epoch - 33ms/step
Epoch 36/50
5759/5759 - 191s - loss: 3.1216 - accuracy500: 0.4506 - val_loss: 3.3709 - val_accuracy500: 0.3419 - 191s/epoch - 33ms/step
Epoch 37/50
5759/5759 - 192s - loss: 3.1188 - accuracy500: 0.4515 - val_loss: 3.3806 - val_accuracy500: 0.3432 - 192s/epoch - 33ms/step
Epoch 38/50
5759/5759 - 192s - loss: 3.1152 - accuracy500: 0.4532 - val_loss: 3.3697 - val_accuracy500: 0.3473 - 192s/epoch - 33ms/step
Epoch 39/50
5759/5759 - 189s - loss: 3.1132 - accuracy500: 0.4535 - val_loss: 3.3746 - val_accuracy500: 0.3439 - 189s/epoch - 33ms/step
Epoch 40/50
5759/5759 - 190s - loss: 3.1093 - accuracy500: 0.4552 - val_loss: 3.3815 - val_accuracy500: 0.3468 - 190s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h500
Evaluating performance on  test set...
31315/31315 - 432s - 432s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1365331
{'0': {'precision': 0.38141012367753707, 'recall': 0.15313313105106688, 'f1-score': 0.21852871937545942, 'support': 3067331}, '1': {'precision': 0.23822094145143108, 'recall': 0.6375466805736862, 'f1-score': 0.34684308176248707, 'support': 1848467}, '2': {'precision': 0.40252214960532245, 'recall': 0.23859801437616426, 'f1-score': 0.2996036968852179, 'support': 3100688}, 'accuracy': 0.2978876280704538, 'macro avg': {'precision': 0.34071773824476353, 'recall': 0.3430926086669725, 'f1-score': 0.28832516600772146, 'support': 8016486}, 'weighted avg': {'precision': 0.35655900154597336, 'recall': 0.2978876280704538, 'f1-score': 0.2794747591194619, 'support': 8016486}}
[[ 469710 1888459  709162]
 [ 281007 1178484  388976]
 [ 480792 1880078  739818]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110639
{'0': {'precision': 0.3602283730383733, 'recall': 0.16718013699739284, 'f1-score': 0.22837336754698614, 'support': 494024}, '1': {'precision': 0.3475649793864572, 'recall': 0.7350365265619503, 'f1-score': 0.47196120419025567, 'support': 483210}, '2': {'precision': 0.38375404153419107, 'recall': 0.17220659317661358, 'f1-score': 0.23773257307951415, 'support': 496938}, 'accuracy': 0.355008777808831, 'macro avg': {'precision': 0.3638491313196739, 'recall': 0.35814108557865226, 'f1-score': 0.31268904827225197, 'support': 1474172}, 'weighted avg': {'precision': 0.3640079321430316, 'recall': 0.355008777808831, 'f1-score': 0.311372517865482, 'support': 1474172}}
[[ 82591 331800  79633]
 [ 70245 355177  57788]
 [ 76438 334924  85576]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1238884
{'0': {'precision': 0.34389256240709415, 'recall': 0.1421518772777354, 'f1-score': 0.2011543362566524, 'support': 188784}, '1': {'precision': 0.3189651930525784, 'recall': 0.7206712386963646, 'f1-score': 0.4422104377229765, 'support': 164770}, '2': {'precision': 0.36992454186130075, 'recall': 0.1828921655711494, 'f1-score': 0.24476937708036137, 'support': 191386}, 'accuracy': 0.3313832715528315, 'macro avg': {'precision': 0.3442607657736578, 'recall': 0.3485717605150831, 'f1-score': 0.29604471701999674, 'support': 544940}, 'weighted avg': {'precision': 0.34549801212867676, 'recall': 0.3313832715528315, 'f1-score': 0.2893587661786486, 'support': 544940}}
[[ 26836 124310  37638]
 [ 24044 118745  21981]
 [ 27156 129227  35003]]
training model: results/AAPL/W5/deepVOL_L3/h1000
Epoch 1/50
5759/5759 - 196s - loss: 3.2527 - accuracy1000: 0.3832 - val_loss: 3.3717 - val_accuracy1000: 0.3004 - 196s/epoch - 34ms/step
Epoch 2/50
5759/5759 - 192s - loss: 3.2554 - accuracy1000: 0.3755 - val_loss: 3.3629 - val_accuracy1000: 0.3050 - 192s/epoch - 33ms/step
Epoch 3/50
5759/5759 - 189s - loss: 3.2532 - accuracy1000: 0.3801 - val_loss: 3.4013 - val_accuracy1000: 0.3106 - 189s/epoch - 33ms/step
Epoch 4/50
5759/5759 - 190s - loss: 3.2499 - accuracy1000: 0.3840 - val_loss: 3.3983 - val_accuracy1000: 0.3072 - 190s/epoch - 33ms/step
Epoch 5/50
5759/5759 - 190s - loss: 3.2296 - accuracy1000: 0.3984 - val_loss: 3.3905 - val_accuracy1000: 0.3157 - 190s/epoch - 33ms/step
Epoch 6/50
5759/5759 - 187s - loss: 3.2179 - accuracy1000: 0.4063 - val_loss: 3.3522 - val_accuracy1000: 0.3053 - 187s/epoch - 32ms/step
Epoch 7/50
5759/5759 - 188s - loss: 3.2084 - accuracy1000: 0.4118 - val_loss: 3.3408 - val_accuracy1000: 0.3115 - 188s/epoch - 33ms/step
Epoch 8/50
5759/5759 - 191s - loss: 3.2001 - accuracy1000: 0.4163 - val_loss: 3.3416 - val_accuracy1000: 0.3142 - 191s/epoch - 33ms/step
Epoch 9/50
5759/5759 - 190s - loss: 3.1935 - accuracy1000: 0.4209 - val_loss: 3.3432 - val_accuracy1000: 0.3116 - 190s/epoch - 33ms/step
Epoch 10/50
5759/5759 - 188s - loss: 3.1874 - accuracy1000: 0.4242 - val_loss: 3.3538 - val_accuracy1000: 0.3080 - 188s/epoch - 33ms/step
Epoch 11/50
5759/5759 - 190s - loss: 3.1825 - accuracy1000: 0.4263 - val_loss: 3.3596 - val_accuracy1000: 0.3068 - 190s/epoch - 33ms/step
Epoch 12/50
5759/5759 - 190s - loss: 3.1785 - accuracy1000: 0.4286 - val_loss: 3.3613 - val_accuracy1000: 0.3077 - 190s/epoch - 33ms/step
Epoch 13/50
5759/5759 - 187s - loss: 3.1749 - accuracy1000: 0.4298 - val_loss: 3.3798 - val_accuracy1000: 0.3049 - 187s/epoch - 33ms/step
Epoch 14/50
5759/5759 - 190s - loss: 3.1711 - accuracy1000: 0.4313 - val_loss: 3.3658 - val_accuracy1000: 0.3045 - 190s/epoch - 33ms/step
Epoch 15/50
5759/5759 - 189s - loss: 3.1695 - accuracy1000: 0.4322 - val_loss: 3.3698 - val_accuracy1000: 0.3049 - 189s/epoch - 33ms/step
Epoch 16/50
5759/5759 - 190s - loss: 3.1644 - accuracy1000: 0.4344 - val_loss: 3.3770 - val_accuracy1000: 0.3024 - 190s/epoch - 33ms/step
Epoch 17/50
5759/5759 - 190s - loss: 3.1618 - accuracy1000: 0.4356 - val_loss: 3.3776 - val_accuracy1000: 0.3015 - 190s/epoch - 33ms/step
testing model: results/AAPL/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
31315/31315 - 422s - 422s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13536
{'0': {'precision': 0.3681217615390972, 'recall': 0.0777922796923467, 'f1-score': 0.12844193448317656, 'support': 3092312}, '1': {'precision': 0.22785365479414127, 'recall': 0.8160515582144168, 'f1-score': 0.3562398725909695, 'support': 1823337}, '2': {'precision': 0.3955397637554171, 'recall': 0.10622873759568788, 'f1-score': 0.1674783875811022, 'support': 3100837}, 'accuracy': 0.25670761478283627, 'macro avg': {'precision': 0.3305050600295519, 'recall': 0.3333575251674838, 'f1-score': 0.21738673155174945, 'support': 8016486}, 'weighted avg': {'precision': 0.3468234927952136, 'recall': 0.25670761478283627, 'f1-score': 0.19535380674122846, 'support': 8016486}}
[[ 240558 2523372  328382]
 [ 160399 1487937  175001]
 [ 252517 2518922  329398]]
Evaluating performance on  train set...
5759/5759 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110835
{'0': {'precision': 0.35572953736654805, 'recall': 0.06924575056804237, 'f1-score': 0.11592560562232228, 'support': 505244}, '1': {'precision': 0.3242018496341185, 'recall': 0.8579117284827312, 'f1-score': 0.4705750349978839, 'support': 471749}, '2': {'precision': 0.35983431005672056, 'recall': 0.09225449988837019, 'f1-score': 0.14685758013338754, 'support': 497179}, 'accuracy': 0.3293862588626022, 'macro avg': {'precision': 0.3465885656857957, 'recall': 0.3398039929797146, 'f1-score': 0.2444527402511979, 'support': 1474172}, 'weighted avg': {'precision': 0.34702475367864827, 'recall': 0.3293862588626022, 'f1-score': 0.23984889395904874, 'support': 1474172}}
[[ 34986 425011  45247]
 [ 30677 404719  36353]
 [ 32687 418625  45867]]
Evaluating performance on  val set...
2129/2129 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1183535
{'0': {'precision': 0.346492337972726, 'recall': 0.06572827547950759, 'f1-score': 0.11049590000403499, 'support': 187484}, '1': {'precision': 0.3039671333033023, 'recall': 0.8609626980573055, 'f1-score': 0.449304938656935, 'support': 163021}, '2': {'precision': 0.3699061535554576, 'recall': 0.09061640136806645, 'f1-score': 0.1455718688291623, 'support': 194435}, 'accuracy': 0.312505963959335, 'macro avg': {'precision': 0.3401218749438286, 'recall': 0.3391024583016265, 'f1-score': 0.23512423583004408, 'support': 544940}, 'weighted avg': {'precision': 0.3421248183236165, 'recall': 0.312505963959335, 'f1-score': 0.22436712305381667, 'support': 544940}}
[[ 12323 157069  18092]
 [ 10746 140355  11920]
 [ 12496 164320  17619]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        57 (peak)  20.84 (ave)

============================================
