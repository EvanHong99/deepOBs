This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-22.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-14.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-02.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-10.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-06.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-08.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-03.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-24.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-07.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-09.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-31.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-16.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2020-01-15.csv
training model: results/QRTEA/W10/deepLOB_L1/h10
Epoch 1/50
529/529 - 37s - loss: 2.8333 - accuracy10: 0.4303 - val_loss: 3.7094 - val_accuracy10: 0.4902 - 37s/epoch - 70ms/step
Epoch 2/50
529/529 - 13s - loss: 2.6531 - accuracy10: 0.4829 - val_loss: 3.5240 - val_accuracy10: 0.4338 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 13s - loss: 2.5820 - accuracy10: 0.5145 - val_loss: 3.4533 - val_accuracy10: 0.6131 - 13s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 2.5140 - accuracy10: 0.5378 - val_loss: 3.2646 - val_accuracy10: 0.5625 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 13s - loss: 2.4420 - accuracy10: 0.5747 - val_loss: 3.3361 - val_accuracy10: 0.6438 - 13s/epoch - 24ms/step
Epoch 6/50
529/529 - 13s - loss: 2.4046 - accuracy10: 0.5848 - val_loss: 3.2672 - val_accuracy10: 0.5512 - 13s/epoch - 24ms/step
Epoch 7/50
529/529 - 13s - loss: 2.3537 - accuracy10: 0.6061 - val_loss: 3.3114 - val_accuracy10: 0.5444 - 13s/epoch - 24ms/step
Epoch 8/50
529/529 - 13s - loss: 2.3258 - accuracy10: 0.6152 - val_loss: 3.2992 - val_accuracy10: 0.5899 - 13s/epoch - 24ms/step
Epoch 9/50
529/529 - 13s - loss: 2.3136 - accuracy10: 0.6170 - val_loss: 3.3403 - val_accuracy10: 0.4429 - 13s/epoch - 24ms/step
Epoch 10/50
529/529 - 13s - loss: 2.2856 - accuracy10: 0.6241 - val_loss: 3.4143 - val_accuracy10: 0.4751 - 13s/epoch - 24ms/step
Epoch 11/50
529/529 - 13s - loss: 2.2539 - accuracy10: 0.6361 - val_loss: 3.3355 - val_accuracy10: 0.5498 - 13s/epoch - 24ms/step
Epoch 12/50
529/529 - 13s - loss: 2.2297 - accuracy10: 0.6460 - val_loss: 3.4472 - val_accuracy10: 0.5277 - 13s/epoch - 24ms/step
Epoch 13/50
529/529 - 13s - loss: 2.2094 - accuracy10: 0.6469 - val_loss: 3.5461 - val_accuracy10: 0.5123 - 13s/epoch - 24ms/step
Epoch 14/50
529/529 - 13s - loss: 2.1956 - accuracy10: 0.6514 - val_loss: 3.7174 - val_accuracy10: 0.4573 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h10
Evaluating performance on  test set...
1840/1840 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7797461
{'0': {'precision': 0.32182890855457225, 'recall': 0.10830665376119922, 'f1-score': 0.16207082242400608, 'support': 40293}, '1': {'precision': 0.8587851862424989, 'recall': 0.7398998245007238, 'f1-score': 0.794922081979419, 'support': 390315}, '2': {'precision': 0.18407430340557276, 'recall': 0.5524418345350479, 'f1-score': 0.2761388125139333, 'support': 40359}, 'accuracy': 0.6698006442064943, 'macro avg': {'precision': 0.45489613273421464, 'recall': 0.4668827709323236, 'f1-score': 0.41104390563911947, 'support': 470967}, 'weighted avg': {'precision': 0.7550279467388923, 'recall': 0.6698006442064943, 'f1-score': 0.6963227113788807, 'support': 470967}}
[[  4364  30114   5815]
 [  8507 288794  93014]
 [   689  17374  22296]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8476192
{'0': {'precision': 0.20887826961770622, 'recall': 0.4314846083907001, 'f1-score': 0.2814896411473118, 'support': 7699}, '1': {'precision': 0.9306669335568538, 'recall': 0.6207682101521232, 'f1-score': 0.7447664814536717, 'support': 119837}, '2': {'precision': 0.13279749267010413, 'recall': 0.6680228862047044, 'f1-score': 0.22155221488962448, 'support': 7865}, 'accuracy': 0.612750275108751, 'macro avg': {'precision': 0.4241142319482214, 'recall': 0.5734252349158425, 'f1-score': 0.4159361124968694, 'support': 135401}, 'weighted avg': {'precision': 0.8432798826765665, 'recall': 0.612750275108751, 'f1-score': 0.6880324204050465, 'support': 135401}}
[[ 3322  3391   986]
 [12122 74391 33324]
 [  460  2151  5254]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.896177
{'0': {'precision': 0.20413751140857925, 'recall': 0.5240822702421244, 'f1-score': 0.29382571887315717, 'support': 3841}, '1': {'precision': 0.9096917086414461, 'recall': 0.5627499944752602, 'f1-score': 0.6953470591447763, 'support': 45251}, '2': {'precision': 0.15832676648279484, 'recall': 0.6042606516290727, 'f1-score': 0.2509106046414819, 'support': 3990}, 'accuracy': 0.5630722278738556, 'macro avg': {'precision': 0.42405199551094, 'recall': 0.5636976387821525, 'f1-score': 0.41336112755313853, 'support': 53082}, 'weighted avg': {'precision': 0.8021603460178739, 'recall': 0.5630722278738556, 'f1-score': 0.6328862452822347, 'support': 53082}}
[[ 2013  1332   496]
 [ 7465 25465 12321]
 [  383  1196  2411]]
training model: results/QRTEA/W10/deepLOB_L1/h20
Epoch 1/50
529/529 - 15s - loss: 2.8323 - accuracy20: 0.4000 - val_loss: 3.5336 - val_accuracy20: 0.5818 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 2.6684 - accuracy20: 0.4426 - val_loss: 3.3351 - val_accuracy20: 0.4651 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 13s - loss: 2.5880 - accuracy20: 0.4955 - val_loss: 3.2738 - val_accuracy20: 0.3741 - 13s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 2.5401 - accuracy20: 0.5229 - val_loss: 3.3542 - val_accuracy20: 0.3781 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 2.4915 - accuracy20: 0.5329 - val_loss: 3.4589 - val_accuracy20: 0.3717 - 12s/epoch - 24ms/step
Epoch 6/50
529/529 - 13s - loss: 2.4589 - accuracy20: 0.5570 - val_loss: 3.1734 - val_accuracy20: 0.5145 - 13s/epoch - 24ms/step
Epoch 7/50
529/529 - 13s - loss: 2.4172 - accuracy20: 0.5707 - val_loss: 3.2394 - val_accuracy20: 0.4395 - 13s/epoch - 24ms/step
Epoch 8/50
529/529 - 12s - loss: 2.3968 - accuracy20: 0.5759 - val_loss: 3.2368 - val_accuracy20: 0.4172 - 12s/epoch - 23ms/step
Epoch 9/50
529/529 - 12s - loss: 2.3650 - accuracy20: 0.5896 - val_loss: 3.3607 - val_accuracy20: 0.4502 - 12s/epoch - 23ms/step
Epoch 10/50
529/529 - 12s - loss: 2.3481 - accuracy20: 0.5955 - val_loss: 3.3709 - val_accuracy20: 0.4340 - 12s/epoch - 23ms/step
Epoch 11/50
529/529 - 12s - loss: 2.3212 - accuracy20: 0.6031 - val_loss: 3.3306 - val_accuracy20: 0.4987 - 12s/epoch - 23ms/step
Epoch 12/50
529/529 - 13s - loss: 2.2970 - accuracy20: 0.6123 - val_loss: 3.3004 - val_accuracy20: 0.5024 - 13s/epoch - 24ms/step
Epoch 13/50
529/529 - 12s - loss: 2.2713 - accuracy20: 0.6207 - val_loss: 3.3630 - val_accuracy20: 0.5020 - 12s/epoch - 24ms/step
Epoch 14/50
529/529 - 13s - loss: 2.2572 - accuracy20: 0.6278 - val_loss: 3.3475 - val_accuracy20: 0.4791 - 13s/epoch - 24ms/step
Epoch 15/50
529/529 - 13s - loss: 2.2403 - accuracy20: 0.6339 - val_loss: 3.2646 - val_accuracy20: 0.5289 - 13s/epoch - 24ms/step
Epoch 16/50
529/529 - 12s - loss: 2.2284 - accuracy20: 0.6360 - val_loss: 3.2611 - val_accuracy20: 0.5383 - 12s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h20
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8028231
{'0': {'precision': 0.41467056150600456, 'recall': 0.114805362855397, 'f1-score': 0.17982462313679676, 'support': 55642}, '1': {'precision': 0.8063970183906641, 'recall': 0.7335669563332491, 'f1-score': 0.7682597983931406, 'support': 359839}, '2': {'precision': 0.2379622841634041, 'recall': 0.5499044804094727, 'f1-score': 0.3321793280641018, 'support': 55486}, 'accuracy': 0.6388260748629947, 'macro avg': {'precision': 0.48634328802002424, 'recall': 0.4660922665327063, 'f1-score': 0.426754583198013, 'support': 470967}, 'weighted avg': {'precision': 0.6931478667997671, 'recall': 0.6388260748629947, 'f1-score': 0.6473637037659362, 'support': 470967}}
[[  6388  39332   9922]
 [  8085 263966  87788]
 [   932  24042  30512]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9285012
{'0': {'precision': 0.236847976440141, 'recall': 0.4995294560511952, 'f1-score': 0.32133668311287344, 'support': 10626}, '1': {'precision': 0.9083831659708902, 'recall': 0.565597667638484, 'f1-score': 0.6971317242125772, 'support': 113876}, '2': {'precision': 0.17583044242741053, 'recall': 0.678961372602991, 'f1-score': 0.2793243370765311, 'support': 10899}, 'accuracy': 0.5695378911529457, 'macro avg': {'precision': 0.440353861612814, 'recall': 0.5813628320975567, 'f1-score': 0.43259758146732724, 'support': 135401}, 'weighted avg': {'precision': 0.7967161542216851, 'recall': 0.5695378911529457, 'f1-score': 0.6340089938108725, 'support': 135401}}
[[ 5308  3795  1523]
 [16305 64408 33163]
 [  798  2701  7400]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9270273
{'0': {'precision': 0.245872412991241, 'recall': 0.5937850992137776, 'f1-score': 0.34774982184947656, 'support': 5342}, '1': {'precision': 0.8852627962899348, 'recall': 0.48884357290209374, 'f1-score': 0.6298712210323704, 'support': 42173}, '2': {'precision': 0.2116853134434381, 'recall': 0.6423567451050836, 'f1-score': 0.31843276936776493, 'support': 5567}, 'accuracy': 0.5155043140801024, 'macro avg': {'precision': 0.44760684090820463, 'recall': 0.5749951390736516, 'f1-score': 0.4320179374165373, 'support': 53082}, 'weighted avg': {'precision': 0.7502748667735626, 'recall': 0.5155043140801024, 'f1-score': 0.5688171843560605, 'support': 53082}}
[[ 3172  1417   753]
 [ 8993 20616 12564]
 [  736  1255  3576]]
training model: results/QRTEA/W10/deepLOB_L1/h30
Epoch 1/50
529/529 - 15s - loss: 2.8084 - accuracy30: 0.4408 - val_loss: 3.5782 - val_accuracy30: 0.5913 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 2.6475 - accuracy30: 0.4795 - val_loss: 3.5523 - val_accuracy30: 0.6299 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 13s - loss: 2.6070 - accuracy30: 0.4958 - val_loss: 3.3815 - val_accuracy30: 0.6190 - 13s/epoch - 24ms/step
Epoch 4/50
529/529 - 12s - loss: 2.5382 - accuracy30: 0.5287 - val_loss: 3.4073 - val_accuracy30: 0.6330 - 12s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 2.5005 - accuracy30: 0.5438 - val_loss: 3.4364 - val_accuracy30: 0.6714 - 12s/epoch - 23ms/step
Epoch 6/50
529/529 - 12s - loss: 2.4724 - accuracy30: 0.5510 - val_loss: 3.3709 - val_accuracy30: 0.6631 - 12s/epoch - 24ms/step
Epoch 7/50
529/529 - 12s - loss: 2.4420 - accuracy30: 0.5675 - val_loss: 3.3875 - val_accuracy30: 0.6364 - 12s/epoch - 23ms/step
Epoch 8/50
529/529 - 12s - loss: 2.4217 - accuracy30: 0.5685 - val_loss: 3.4330 - val_accuracy30: 0.6547 - 12s/epoch - 23ms/step
Epoch 9/50
529/529 - 12s - loss: 2.4001 - accuracy30: 0.5752 - val_loss: 3.4098 - val_accuracy30: 0.6379 - 12s/epoch - 23ms/step
Epoch 10/50
529/529 - 12s - loss: 2.3873 - accuracy30: 0.5782 - val_loss: 3.3717 - val_accuracy30: 0.6458 - 12s/epoch - 23ms/step
Epoch 11/50
529/529 - 12s - loss: 2.3647 - accuracy30: 0.5895 - val_loss: 3.3953 - val_accuracy30: 0.6394 - 12s/epoch - 24ms/step
Epoch 12/50
529/529 - 12s - loss: 2.3527 - accuracy30: 0.5970 - val_loss: 3.3971 - val_accuracy30: 0.6398 - 12s/epoch - 23ms/step
Epoch 13/50
529/529 - 13s - loss: 2.3380 - accuracy30: 0.5993 - val_loss: 3.3722 - val_accuracy30: 0.6274 - 13s/epoch - 24ms/step
Epoch 14/50
529/529 - 12s - loss: 2.3284 - accuracy30: 0.6016 - val_loss: 3.4046 - val_accuracy30: 0.6301 - 12s/epoch - 23ms/step
Epoch 15/50
529/529 - 12s - loss: 2.3039 - accuracy30: 0.6086 - val_loss: 3.4339 - val_accuracy30: 0.6284 - 12s/epoch - 23ms/step
Epoch 16/50
529/529 - 13s - loss: 2.2930 - accuracy30: 0.6105 - val_loss: 3.3901 - val_accuracy30: 0.6261 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h30
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75708556
{'0': {'precision': 0.4411705952856572, 'recall': 0.19681261882129278, 'f1-score': 0.2721950618298344, 'support': 67328}, '1': {'precision': 0.7513643442863224, 'recall': 0.8759803032959588, 'f1-score': 0.8089010120524248, 'support': 336503}, '2': {'precision': 0.37874861162532397, 'recall': 0.2742790753098189, 'f1-score': 0.31815747188002147, 'support': 67136}, 'accuracy': 0.6931165028547648, 'macro avg': {'precision': 0.5237611837324345, 'recall': 0.4490239991423568, 'f1-score': 0.4664178485874269, 'support': 470967}, 'weighted avg': {'precision': 0.653903896822603, 'recall': 0.6931165028547648, 'f1-score': 0.6622200417729762, 'support': 470967}}
[[ 13251  50675   3402]
 [ 14931 294770  26802]
 [  1854  46868  18414]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75200284
{'0': {'precision': 0.2833140686922061, 'recall': 0.5282074963441853, 'f1-score': 0.3688099524410888, 'support': 12993}, '1': {'precision': 0.8737090231334284, 'recall': 0.7306408728339598, 'f1-score': 0.795795885759936, 'support': 109070}, '2': {'precision': 0.31436870836880854, 'recall': 0.4706102863997601, 'f1-score': 0.37694039933943857, 'support': 13338}, 'accuracy': 0.6856005494789551, 'macro avg': {'precision': 0.4904639333981476, 'recall': 0.5764862185259684, 'f1-score': 0.513848745846821, 'support': 135401}, 'weighted avg': {'precision': 0.7619559137665455, 'recall': 0.6856005494789551, 'f1-score': 0.7135622042547153, 'support': 135401}}
[[ 6863  5484   646]
 [16335 79691 13044]
 [ 1026  6035  6277]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78297883
{'0': {'precision': 0.3196677858278848, 'recall': 0.5561875480399693, 'f1-score': 0.4059922571957583, 'support': 6505}, '1': {'precision': 0.827118836305895, 'recall': 0.7332277606012618, 'f1-score': 0.7773484343770819, 'support': 39783}, '2': {'precision': 0.37047868246883175, 'recall': 0.3542831910509273, 'f1-score': 0.36219998495222333, 'support': 6794}, 'accuracy': 0.6630307825628273, 'macro avg': {'precision': 0.5057551015342038, 'recall': 0.5478994998973862, 'f1-score': 0.5151802255083545, 'support': 53082}, 'weighted avg': {'precision': 0.706486940587413, 'recall': 0.6630307825628273, 'f1-score': 0.6787050053812453, 'support': 53082}}
[[ 3618  2600   287]
 [ 6810 29170  3803]
 [  890  3497  2407]]
training model: results/QRTEA/W10/deepLOB_L1/h50
Epoch 1/50
529/529 - 15s - loss: 2.9103 - accuracy50: 0.4139 - val_loss: 3.7289 - val_accuracy50: 0.5136 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 2.7815 - accuracy50: 0.4511 - val_loss: 3.4250 - val_accuracy50: 0.4330 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 12s - loss: 2.7291 - accuracy50: 0.4789 - val_loss: 3.3584 - val_accuracy50: 0.5153 - 12s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 2.6930 - accuracy50: 0.4955 - val_loss: 3.3240 - val_accuracy50: 0.4916 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 13s - loss: 2.6818 - accuracy50: 0.5038 - val_loss: 3.3236 - val_accuracy50: 0.5165 - 13s/epoch - 24ms/step
Epoch 6/50
529/529 - 13s - loss: 2.6579 - accuracy50: 0.5148 - val_loss: 3.3191 - val_accuracy50: 0.3928 - 13s/epoch - 24ms/step
Epoch 7/50
529/529 - 13s - loss: 2.6245 - accuracy50: 0.5243 - val_loss: 3.3341 - val_accuracy50: 0.4485 - 13s/epoch - 24ms/step
Epoch 8/50
529/529 - 12s - loss: 2.6040 - accuracy50: 0.5326 - val_loss: 3.3707 - val_accuracy50: 0.4318 - 12s/epoch - 23ms/step
Epoch 9/50
529/529 - 13s - loss: 2.5926 - accuracy50: 0.5346 - val_loss: 3.3336 - val_accuracy50: 0.4827 - 13s/epoch - 24ms/step
Epoch 10/50
529/529 - 12s - loss: 2.5703 - accuracy50: 0.5465 - val_loss: 3.4093 - val_accuracy50: 0.4209 - 12s/epoch - 24ms/step
Epoch 11/50
529/529 - 12s - loss: 2.5537 - accuracy50: 0.5476 - val_loss: 3.5205 - val_accuracy50: 0.4043 - 12s/epoch - 24ms/step
Epoch 12/50
529/529 - 12s - loss: 2.5439 - accuracy50: 0.5554 - val_loss: 3.4454 - val_accuracy50: 0.4270 - 12s/epoch - 24ms/step
Epoch 13/50
529/529 - 13s - loss: 2.5274 - accuracy50: 0.5556 - val_loss: 3.4959 - val_accuracy50: 0.4184 - 13s/epoch - 24ms/step
Epoch 14/50
529/529 - 12s - loss: 2.5153 - accuracy50: 0.5608 - val_loss: 3.5289 - val_accuracy50: 0.4295 - 12s/epoch - 24ms/step
Epoch 15/50
529/529 - 12s - loss: 2.5010 - accuracy50: 0.5636 - val_loss: 3.5781 - val_accuracy50: 0.4350 - 12s/epoch - 23ms/step
Epoch 16/50
529/529 - 12s - loss: 2.4867 - accuracy50: 0.5663 - val_loss: 3.6150 - val_accuracy50: 0.4405 - 12s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h50
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.937196
{'0': {'precision': 0.4187645510128593, 'recall': 0.22369185708640368, 'f1-score': 0.2916126881671553, 'support': 86038}, '1': {'precision': 0.7026774467258, 'recall': 0.6304344909922599, 'f1-score': 0.6645985020831897, 'support': 298188}, '2': {'precision': 0.3070162626923297, 'recall': 0.5573834749426454, 'f1-score': 0.3959413311058153, 'support': 86741}, 'accuracy': 0.5426749644879577, 'macro avg': {'precision': 0.4761527534769963, 'recall': 0.4705032743404363, 'f1-score': 0.4507175071187201, 'support': 470967}, 'weighted avg': {'precision': 0.5779397379572508, 'recall': 0.5426749644879577, 'f1-score': 0.5469797620749595, 'support': 470967}}
[[ 19246  44658  22134]
 [ 23205 187988  86995]
 [  3508  34885  48348]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9714338
{'0': {'precision': 0.30055573716900946, 'recall': 0.5328619450562189, 'f1-score': 0.3843324136777861, 'support': 17254}, '1': {'precision': 0.8329900479316252, 'recall': 0.43078714995370876, 'f1-score': 0.5678871391076115, 'support': 100451}, '2': {'precision': 0.22850062426695925, 'recall': 0.6825836347197106, 'f1-score': 0.342384988236628, 'support': 17696}, 'accuracy': 0.4767025354317915, 'macro avg': {'precision': 0.454015469789198, 'recall': 0.5487442432432128, 'f1-score': 0.43153484700734185, 'support': 135401}, 'weighted avg': {'precision': 0.6861398294024557, 'recall': 0.4767025354317915, 'f1-score': 0.5150253486158194, 'support': 135401}}
[[ 9194  4726  3334]
 [19729 43273 37449]
 [ 1667  3950 12079]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723257
{'0': {'precision': 0.28195291149884383, 'recall': 0.6275587788045386, 'f1-score': 0.38909235957500815, 'support': 8549}, '1': {'precision': 0.7619811969731712, 'recall': 0.2792593422600706, 'f1-score': 0.4087247083905619, 'support': 35698}, '2': {'precision': 0.2671307996757427, 'recall': 0.6340690435766837, 'f1-score': 0.3758974703079917, 'support': 8835}, 'accuracy': 0.39440865076673826, 'macro avg': {'precision': 0.43702163604925265, 'recall': 0.5136290548804309, 'f1-score': 0.39123817942452055, 'support': 53082}, 'weighted avg': {'precision': 0.602308142592349, 'recall': 0.39440865076673826, 'f1-score': 0.40009908014588996, 'support': 53082}}
[[ 5365  1571  1613]
 [11973  9969 13756]
 [ 1690  1543  5602]]
training model: results/QRTEA/W10/deepLOB_L1/h100
Epoch 1/50
529/529 - 15s - loss: 3.0811 - accuracy100: 0.4232 - val_loss: 3.6681 - val_accuracy100: 0.3687 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 2.9954 - accuracy100: 0.4476 - val_loss: 3.4832 - val_accuracy100: 0.3833 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 12s - loss: 2.9819 - accuracy100: 0.4578 - val_loss: 3.4657 - val_accuracy100: 0.3671 - 12s/epoch - 23ms/step
Epoch 4/50
529/529 - 13s - loss: 2.9579 - accuracy100: 0.4719 - val_loss: 3.4329 - val_accuracy100: 0.3829 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 13s - loss: 2.9372 - accuracy100: 0.4734 - val_loss: 3.4688 - val_accuracy100: 0.3858 - 13s/epoch - 24ms/step
Epoch 6/50
529/529 - 12s - loss: 2.9220 - accuracy100: 0.4848 - val_loss: 3.4295 - val_accuracy100: 0.3962 - 12s/epoch - 24ms/step
Epoch 7/50
529/529 - 12s - loss: 2.9114 - accuracy100: 0.4871 - val_loss: 3.4476 - val_accuracy100: 0.3991 - 12s/epoch - 23ms/step
Epoch 8/50
529/529 - 13s - loss: 2.8989 - accuracy100: 0.4902 - val_loss: 3.4393 - val_accuracy100: 0.4053 - 13s/epoch - 24ms/step
Epoch 9/50
529/529 - 12s - loss: 2.8769 - accuracy100: 0.4981 - val_loss: 3.5002 - val_accuracy100: 0.4059 - 12s/epoch - 23ms/step
Epoch 10/50
529/529 - 13s - loss: 2.8610 - accuracy100: 0.5051 - val_loss: 3.5222 - val_accuracy100: 0.4076 - 13s/epoch - 24ms/step
Epoch 11/50
529/529 - 13s - loss: 2.8453 - accuracy100: 0.5094 - val_loss: 3.5632 - val_accuracy100: 0.3998 - 13s/epoch - 24ms/step
Epoch 12/50
529/529 - 12s - loss: 2.8391 - accuracy100: 0.5127 - val_loss: 3.6325 - val_accuracy100: 0.4017 - 12s/epoch - 23ms/step
Epoch 13/50
529/529 - 13s - loss: 2.8286 - accuracy100: 0.5143 - val_loss: 3.7100 - val_accuracy100: 0.4037 - 13s/epoch - 24ms/step
Epoch 14/50
529/529 - 13s - loss: 2.8210 - accuracy100: 0.5159 - val_loss: 3.7948 - val_accuracy100: 0.3971 - 13s/epoch - 24ms/step
Epoch 15/50
529/529 - 13s - loss: 2.8056 - accuracy100: 0.5205 - val_loss: 3.8642 - val_accuracy100: 0.3899 - 13s/epoch - 24ms/step
Epoch 16/50
529/529 - 13s - loss: 2.7965 - accuracy100: 0.5226 - val_loss: 3.8998 - val_accuracy100: 0.3980 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h100
Evaluating performance on  test set...
1840/1840 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0321062
{'0': {'precision': 0.5412387316679373, 'recall': 0.10047874776237459, 'f1-score': 0.1694920015168326, 'support': 120105}, '1': {'precision': 0.5404653906107374, 'recall': 0.6721799652435138, 'f1-score': 0.5991694203456986, 'support': 229022}, '2': {'precision': 0.3734389687122331, 'recall': 0.50215036112935, 'f1-score': 0.42833439514971605, 'support': 121840}, 'accuracy': 0.48239897912167945, 'macro avg': {'precision': 0.48504769699696926, 'recall': 0.4249363580450794, 'f1-score': 0.39899860567074913, 'support': 470967}, 'weighted avg': {'precision': 0.4974525741789305, 'recall': 0.48239897912167945, 'f1-score': 0.44539867662412275, 'support': 470967}}
[[ 12068  73706  34331]
 [  6757 153944  68321]
 [  3472  57186  61182]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0044953
{'0': {'precision': 0.36646110056925996, 'recall': 0.2967045629128898, 'f1-score': 0.3279140843874692, 'support': 26036}, '1': {'precision': 0.68153851109751, 'recall': 0.5089365182458926, 'f1-score': 0.5827250943344259, 'support': 83142}, '2': {'precision': 0.2943237293002776, 'recall': 0.5862792205315944, 'f1-score': 0.39190394860944716, 'support': 26223}, 'accuracy': 0.48310573777150834, 'macro avg': {'precision': 0.44744111365568257, 'recall': 0.4639734338967923, 'f1-score': 0.4341810424437807, 'support': 135401}, 'weighted avg': {'precision': 0.54596130942557, 'recall': 0.48310573777150834, 'f1-score': 0.49677179739182514, 'support': 135401}}
[[ 7725 11382  6929]
 [10896 42314 29932]
 [ 2459  8390 15374]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860401
{'0': {'precision': 0.3033131738101499, 'recall': 0.5600420780061499, 'f1-score': 0.3935069365476461, 'support': 12358}, '1': {'precision': 0.5939558310732275, 'recall': 0.27321333095704864, 'f1-score': 0.37426757812499994, 'support': 28055}, '2': {'precision': 0.3713347543061236, 'recall': 0.5088010103402005, 'f1-score': 0.42933262288530705, 'support': 12669}, 'accuracy': 0.39621717342978785, 'macro avg': {'precision': 0.4228679197298337, 'recall': 0.4473521397677997, 'f1-score': 0.39903571251931763, 'support': 53082}, 'weighted avg': {'precision': 0.4731587929054954, 'recall': 0.39621717342978785, 'f1-score': 0.39188897602740363, 'support': 53082}}
[[ 6921  2816  2621]
 [12098  7665  8292]
 [ 3799  2424  6446]]
training model: results/QRTEA/W10/deepLOB_L1/h200
Epoch 1/50
529/529 - 15s - loss: 3.2266 - accuracy200: 0.4207 - val_loss: 3.6498 - val_accuracy200: 0.3793 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 12s - loss: 3.1837 - accuracy200: 0.4212 - val_loss: 3.4444 - val_accuracy200: 0.3932 - 12s/epoch - 24ms/step
Epoch 3/50
529/529 - 13s - loss: 3.1568 - accuracy200: 0.4285 - val_loss: 3.4021 - val_accuracy200: 0.3754 - 13s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 3.1370 - accuracy200: 0.4422 - val_loss: 3.3618 - val_accuracy200: 0.3759 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 3.1283 - accuracy200: 0.4462 - val_loss: 3.3687 - val_accuracy200: 0.3753 - 12s/epoch - 24ms/step
Epoch 6/50
529/529 - 13s - loss: 3.1177 - accuracy200: 0.4518 - val_loss: 3.4529 - val_accuracy200: 0.3696 - 13s/epoch - 24ms/step
Epoch 7/50
529/529 - 12s - loss: 3.1057 - accuracy200: 0.4512 - val_loss: 3.3818 - val_accuracy200: 0.3801 - 12s/epoch - 24ms/step
Epoch 8/50
529/529 - 13s - loss: 3.0978 - accuracy200: 0.4548 - val_loss: 3.3846 - val_accuracy200: 0.3873 - 13s/epoch - 24ms/step
Epoch 9/50
529/529 - 13s - loss: 3.0757 - accuracy200: 0.4596 - val_loss: 3.3850 - val_accuracy200: 0.3806 - 13s/epoch - 24ms/step
Epoch 10/50
529/529 - 13s - loss: 3.0669 - accuracy200: 0.4626 - val_loss: 3.3920 - val_accuracy200: 0.3906 - 13s/epoch - 24ms/step
Epoch 11/50
529/529 - 12s - loss: 3.0569 - accuracy200: 0.4642 - val_loss: 3.4008 - val_accuracy200: 0.3925 - 12s/epoch - 23ms/step
Epoch 12/50
529/529 - 12s - loss: 3.0492 - accuracy200: 0.4671 - val_loss: 3.4073 - val_accuracy200: 0.3935 - 12s/epoch - 23ms/step
Epoch 13/50
529/529 - 12s - loss: 3.0394 - accuracy200: 0.4711 - val_loss: 3.4787 - val_accuracy200: 0.3840 - 12s/epoch - 23ms/step
Epoch 14/50
529/529 - 12s - loss: 3.0301 - accuracy200: 0.4737 - val_loss: 3.4549 - val_accuracy200: 0.3911 - 12s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h200
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0816526
{'0': {'precision': 0.48537000439174355, 'recall': 0.2302189182327707, 'f1-score': 0.3123060008918992, 'support': 153619}, '1': {'precision': 0.3834779363746618, 'recall': 0.5186685341509887, 'f1-score': 0.4409437838243734, 'support': 158502}, '2': {'precision': 0.4094370329245658, 'recall': 0.4735592964254687, 'f1-score': 0.43916991905280395, 'support': 158846}, 'accuracy': 0.4093683846214278, 'macro avg': {'precision': 0.42609499123032374, 'recall': 0.40748224960307605, 'f1-score': 0.39747323458969214, 'support': 470967}, 'weighted avg': {'precision': 0.42546825893926216, 'recall': 0.4093683846214278, 'f1-score': 0.3983867067896587, 'support': 470967}}
[[35366 67332 50921]
 [18713 82210 57579]
 [18785 64838 75223]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0599109
{'0': {'precision': 0.36409083043319423, 'recall': 0.5309853625708036, 'f1-score': 0.4319786474432823, 'support': 35662}, '1': {'precision': 0.5532499088810594, 'recall': 0.3562610505233841, 'f1-score': 0.4334228009060971, 'support': 63911}, '2': {'precision': 0.3675687193692734, 'recall': 0.4333203081388858, 'f1-score': 0.39774546851982323, 'support': 35828}, 'accuracy': 0.42267043817992483, 'macro avg': {'precision': 0.428303152894509, 'recall': 0.4401889070776912, 'f1-score': 0.4210489722897342, 'support': 135401}, 'weighted avg': {'precision': 0.45429660193771304, 'recall': 0.42267043817992483, 'f1-score': 0.42360198078271305, 'support': 135401}}
[[18936  8990  7736]
 [22166 22769 18976]
 [10907  9396 15525]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938227
{'0': {'precision': 0.3353339651117897, 'recall': 0.6034613441131885, 'f1-score': 0.4311080026171514, 'support': 15832}, '1': {'precision': 0.43429818515966, 'recall': 0.17690544144481354, 'f1-score': 0.2514046344625819, 'support': 21373}, '2': {'precision': 0.41473087818696885, 'recall': 0.4149398500976255, 'f1-score': 0.41483533782507404, 'support': 15877}, 'accuracy': 0.37532496891601674, 'macro avg': {'precision': 0.3947876761528062, 'recall': 0.3984355452185426, 'f1-score': 0.3657826583016024, 'support': 53082}, 'weighted avg': {'precision': 0.39892891375686246, 'recall': 0.37532496891601674, 'f1-score': 0.3538848161043706, 'support': 53082}}
[[ 9554  2499  3779]
 [12074  3781  5518]
 [ 6863  2426  6588]]
training model: results/QRTEA/W10/deepLOB_L1/h300
Epoch 1/50
529/529 - 14s - loss: 3.2795 - accuracy300: 0.3979 - val_loss: 3.3842 - val_accuracy300: 0.3920 - 14s/epoch - 27ms/step
Epoch 2/50
529/529 - 13s - loss: 3.2257 - accuracy300: 0.4078 - val_loss: 3.3626 - val_accuracy300: 0.3706 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 12s - loss: 3.2121 - accuracy300: 0.4135 - val_loss: 3.3418 - val_accuracy300: 0.3821 - 12s/epoch - 24ms/step
Epoch 4/50
529/529 - 12s - loss: 3.1980 - accuracy300: 0.4211 - val_loss: 3.2887 - val_accuracy300: 0.4179 - 12s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 3.1859 - accuracy300: 0.4253 - val_loss: 3.3578 - val_accuracy300: 0.3912 - 12s/epoch - 23ms/step
Epoch 6/50
529/529 - 12s - loss: 3.1691 - accuracy300: 0.4368 - val_loss: 3.3682 - val_accuracy300: 0.4062 - 12s/epoch - 24ms/step
Epoch 7/50
529/529 - 12s - loss: 3.1600 - accuracy300: 0.4414 - val_loss: 3.4025 - val_accuracy300: 0.3938 - 12s/epoch - 24ms/step
Epoch 8/50
529/529 - 13s - loss: 3.1567 - accuracy300: 0.4418 - val_loss: 3.3351 - val_accuracy300: 0.3729 - 13s/epoch - 24ms/step
Epoch 9/50
529/529 - 12s - loss: 3.1456 - accuracy300: 0.4434 - val_loss: 3.3323 - val_accuracy300: 0.3918 - 12s/epoch - 24ms/step
Epoch 10/50
529/529 - 13s - loss: 3.1375 - accuracy300: 0.4496 - val_loss: 3.3380 - val_accuracy300: 0.3788 - 13s/epoch - 24ms/step
Epoch 11/50
529/529 - 13s - loss: 3.1267 - accuracy300: 0.4545 - val_loss: 3.3566 - val_accuracy300: 0.3755 - 13s/epoch - 24ms/step
Epoch 12/50
529/529 - 13s - loss: 3.1179 - accuracy300: 0.4599 - val_loss: 3.4026 - val_accuracy300: 0.3796 - 13s/epoch - 24ms/step
Epoch 13/50
529/529 - 12s - loss: 3.1143 - accuracy300: 0.4619 - val_loss: 3.4197 - val_accuracy300: 0.3749 - 12s/epoch - 23ms/step
Epoch 14/50
529/529 - 13s - loss: 3.1041 - accuracy300: 0.4643 - val_loss: 3.3834 - val_accuracy300: 0.3771 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h300
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100082
{'0': {'precision': 0.4740740740740741, 'recall': 0.30014484838410943, 'f1-score': 0.367572754832753, 'support': 168452}, '1': {'precision': 0.3199532227689691, 'recall': 0.16929171823017952, 'f1-score': 0.2214245924555669, 'support': 124442}, '2': {'precision': 0.4080302070874082, 'recall': 0.6839105310743346, 'f1-score': 0.5111195981080524, 'support': 178073}, 'accuracy': 0.4106720853053399, 'macro avg': {'precision': 0.40068583464348384, 'recall': 0.3844490325628745, 'f1-score': 0.3667056484654574, 'support': 470967}, 'weighted avg': {'precision': 0.40838000951323133, 'recall': 0.4106720853053399, 'f1-score': 0.3832317020626451, 'support': 470967}}
[[ 50560  21263  96629]
 [ 23317  21067  80058]
 [ 32773  23514 121786]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041112
{'0': {'precision': 0.3926468697776064, 'recall': 0.37893901047094436, 'f1-score': 0.3856711744131722, 'support': 40302}, '1': {'precision': 0.49352639644876606, 'recall': 0.1720206299502671, 'f1-score': 0.2551186264734405, 'support': 54290}, '2': {'precision': 0.34707345681399276, 'recall': 0.6598299394741356, 'f1-score': 0.45487870802081215, 'support': 40809}, 'accuracy': 0.38063234392655887, 'macro avg': {'precision': 0.4110822410134551, 'recall': 0.4035965266317823, 'f1-score': 0.365222836302475, 'support': 135401}, 'weighted avg': {'precision': 0.41935970124373406, 'recall': 0.38063234392655887, 'f1-score': 0.35418390630840296, 'support': 135401}}
[[15272  4751 20279]
 [14574  9339 30377]
 [ 9049  4833 26927]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0788417
{'0': {'precision': 0.40442222493191887, 'recall': 0.5665641726454845, 'f1-score': 0.471955413257441, 'support': 17562}, '1': {'precision': 0.4373938243229739, 'recall': 0.24786227985729656, 'f1-score': 0.3164172630665799, 'support': 17659}, '2': {'precision': 0.4192291035080121, 'recall': 0.43357034880465817, 'f1-score': 0.4262791401755979, 'support': 17861}, 'accuracy': 0.41579066350175203, 'macro avg': {'precision': 0.4203483842543016, 'recall': 0.4159989337691464, 'f1-score': 0.4048839388332062, 'support': 53082}, 'weighted avg': {'precision': 0.4203732277557432, 'recall': 0.41579066350175203, 'f1-score': 0.40484279301451087, 'support': 53082}}
[[9950 2322 5290]
 [7844 4377 5438]
 [6809 3308 7744]]
training model: results/QRTEA/W10/deepLOB_L1/h500
Epoch 1/50
529/529 - 15s - loss: 3.2981 - accuracy500: 0.3879 - val_loss: 3.4577 - val_accuracy500: 0.3469 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 3.2690 - accuracy500: 0.3974 - val_loss: 3.3887 - val_accuracy500: 0.3430 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 12s - loss: 3.2601 - accuracy500: 0.4041 - val_loss: 3.2874 - val_accuracy500: 0.3998 - 12s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 3.2558 - accuracy500: 0.4037 - val_loss: 3.2938 - val_accuracy500: 0.3969 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 3.2448 - accuracy500: 0.4105 - val_loss: 3.2790 - val_accuracy500: 0.3955 - 12s/epoch - 23ms/step
Epoch 6/50
529/529 - 12s - loss: 3.2374 - accuracy500: 0.4119 - val_loss: 3.3132 - val_accuracy500: 0.3860 - 12s/epoch - 24ms/step
Epoch 7/50
529/529 - 13s - loss: 3.2208 - accuracy500: 0.4199 - val_loss: 3.3191 - val_accuracy500: 0.3973 - 13s/epoch - 24ms/step
Epoch 8/50
529/529 - 13s - loss: 3.2161 - accuracy500: 0.4188 - val_loss: 3.3476 - val_accuracy500: 0.3823 - 13s/epoch - 24ms/step
Epoch 9/50
529/529 - 13s - loss: 3.1950 - accuracy500: 0.4321 - val_loss: 3.4136 - val_accuracy500: 0.3750 - 13s/epoch - 24ms/step
Epoch 10/50
529/529 - 12s - loss: 3.1845 - accuracy500: 0.4379 - val_loss: 3.3517 - val_accuracy500: 0.3855 - 12s/epoch - 24ms/step
Epoch 11/50
529/529 - 12s - loss: 3.1756 - accuracy500: 0.4409 - val_loss: 3.3247 - val_accuracy500: 0.3905 - 12s/epoch - 24ms/step
Epoch 12/50
529/529 - 13s - loss: 3.1558 - accuracy500: 0.4482 - val_loss: 3.3366 - val_accuracy500: 0.3893 - 13s/epoch - 24ms/step
Epoch 13/50
529/529 - 13s - loss: 3.1530 - accuracy500: 0.4496 - val_loss: 3.3323 - val_accuracy500: 0.3934 - 13s/epoch - 24ms/step
Epoch 14/50
529/529 - 13s - loss: 3.1441 - accuracy500: 0.4525 - val_loss: 3.3330 - val_accuracy500: 0.3855 - 13s/epoch - 24ms/step
Epoch 15/50
529/529 - 13s - loss: 3.1374 - accuracy500: 0.4543 - val_loss: 3.3542 - val_accuracy500: 0.3875 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h500
Evaluating performance on  test set...
1840/1840 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957341
{'0': {'precision': 0.4520261874680227, 'recall': 0.24363765293832942, 'f1-score': 0.31662016331635323, 'support': 177686}, '1': {'precision': 0.2132731693245972, 'recall': 0.10386417684303474, 'f1-score': 0.13969620697333882, 'support': 99659}, '2': {'precision': 0.4150222554199754, 'recall': 0.7001890281063102, 'f1-score': 0.5211461432602195, 'support': 193622}, 'accuracy': 0.4017563863285538, 'macro avg': {'precision': 0.3601072040708651, 'recall': 0.3492302859625582, 'f1-score': 0.3258208378499705, 'support': 470967}, 'weighted avg': {'precision': 0.38629193779413334, 'recall': 0.4017563863285538, 'f1-score': 0.3632660317604327, 'support': 470967}}
[[ 43291  18859 115536]
 [ 13754  10351  75554]
 [ 38726  19324 135572]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1040277
{'0': {'precision': 0.3860178418164322, 'recall': 0.3338431778307616, 'f1-score': 0.35803973126515254, 'support': 44458}, '1': {'precision': 0.37060839760068554, 'recall': 0.057978461950936144, 'f1-score': 0.10027047913446677, 'support': 44758}, '2': {'precision': 0.3580655919955531, 'recall': 0.6973692757388763, 'f1-score': 0.47317736070812066, 'support': 46185}, 'accuracy': 0.36665164954468576, 'macro avg': {'precision': 0.3715639438042236, 'recall': 0.363063638506858, 'f1-score': 0.3104958570359133, 'support': 135401}, 'weighted avg': {'precision': 0.37138965914285016, 'recall': 0.36665164954468576, 'f1-score': 0.31210502789485434, 'support': 135401}}
[[14842  2315 27301]
 [11722  2595 30441]
 [11885  2092 32208]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943177
{'0': {'precision': 0.3863144637840282, 'recall': 0.6254836348426226, 'f1-score': 0.4776316052143014, 'support': 19126}, '1': {'precision': 0.3258909403177329, 'recall': 0.052086192698325554, 'f1-score': 0.08981717058162239, 'support': 14572}, '2': {'precision': 0.4212574547659962, 'recall': 0.4299938093272802, 'f1-score': 0.4255808016339035, 'support': 19384}, 'accuracy': 0.3966881428732904, 'macro avg': {'precision': 0.3778209529559191, 'recall': 0.36918787895607613, 'f1-score': 0.33100985914327574, 'support': 53082}, 'weighted avg': {'precision': 0.3824872408693605, 'recall': 0.3966881428732904, 'f1-score': 0.35216186560257173, 'support': 53082}}
[[11963   900  6263]
 [ 8625   759  5188]
 [10379   670  8335]]
training model: results/QRTEA/W10/deepLOB_L1/h1000
Epoch 1/50
529/529 - 15s - loss: 3.2899 - accuracy1000: 0.3936 - val_loss: 3.4702 - val_accuracy1000: 0.3430 - 15s/epoch - 28ms/step
Epoch 2/50
529/529 - 13s - loss: 3.2661 - accuracy1000: 0.4022 - val_loss: 3.4203 - val_accuracy1000: 0.3351 - 13s/epoch - 24ms/step
Epoch 3/50
529/529 - 13s - loss: 3.2604 - accuracy1000: 0.3926 - val_loss: 3.4000 - val_accuracy1000: 0.3324 - 13s/epoch - 24ms/step
Epoch 4/50
529/529 - 13s - loss: 3.2625 - accuracy1000: 0.3979 - val_loss: 3.3133 - val_accuracy1000: 0.3500 - 13s/epoch - 24ms/step
Epoch 5/50
529/529 - 12s - loss: 3.2505 - accuracy1000: 0.4022 - val_loss: 3.3367 - val_accuracy1000: 0.3583 - 12s/epoch - 23ms/step
Epoch 6/50
529/529 - 12s - loss: 3.2442 - accuracy1000: 0.4023 - val_loss: 3.3376 - val_accuracy1000: 0.3519 - 12s/epoch - 24ms/step
Epoch 7/50
529/529 - 12s - loss: 3.2382 - accuracy1000: 0.4076 - val_loss: 3.3210 - val_accuracy1000: 0.3606 - 12s/epoch - 23ms/step
Epoch 8/50
529/529 - 12s - loss: 3.2232 - accuracy1000: 0.4095 - val_loss: 3.3294 - val_accuracy1000: 0.3537 - 12s/epoch - 23ms/step
Epoch 9/50
529/529 - 13s - loss: 3.2209 - accuracy1000: 0.4114 - val_loss: 3.3408 - val_accuracy1000: 0.3558 - 13s/epoch - 24ms/step
Epoch 10/50
529/529 - 13s - loss: 3.2008 - accuracy1000: 0.4203 - val_loss: 3.3540 - val_accuracy1000: 0.3566 - 13s/epoch - 24ms/step
Epoch 11/50
529/529 - 13s - loss: 3.1848 - accuracy1000: 0.4309 - val_loss: 3.3501 - val_accuracy1000: 0.3584 - 13s/epoch - 24ms/step
Epoch 12/50
529/529 - 13s - loss: 3.1749 - accuracy1000: 0.4342 - val_loss: 3.3752 - val_accuracy1000: 0.3547 - 13s/epoch - 24ms/step
Epoch 13/50
529/529 - 12s - loss: 3.1689 - accuracy1000: 0.4399 - val_loss: 3.3613 - val_accuracy1000: 0.3493 - 12s/epoch - 24ms/step
Epoch 14/50
529/529 - 12s - loss: 3.1532 - accuracy1000: 0.4471 - val_loss: 3.3799 - val_accuracy1000: 0.3371 - 12s/epoch - 24ms/step
testing model: results/QRTEA/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106534
{'0': {'precision': 0.3554408655639846, 'recall': 0.178300280105055, 'f1-score': 0.23747543694200834, 'support': 160297}, '1': {'precision': 0.3115967163833969, 'recall': 0.06048115621119406, 'f1-score': 0.10129992169146437, 'support': 133678}, '2': {'precision': 0.39226022325224214, 'recall': 0.8080704212619779, 'f1-score': 0.5281442830713329, 'support': 176992}, 'accuracy': 0.38152991610877196, 'macro avg': {'precision': 0.35309926839987454, 'recall': 0.34895061919274234, 'f1-score': 0.28897321390160186, 'support': 470967}, 'weighted avg': {'precision': 0.3568331787871987, 'recall': 0.38152991610877196, 'f1-score': 0.3080587047430628, 'support': 470967}}
[[ 28581   8678 123038]
 [ 27043   8085  98550]
 [ 24786   9184 143022]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089494
{'0': {'precision': 0.3230337828815596, 'recall': 0.2699698694342149, 'f1-score': 0.29412765957446807, 'support': 44805}, '1': {'precision': 0.34180590117312476, 'recall': 0.1288499765483662, 'f1-score': 0.18715024898217383, 'support': 44773}, '2': {'precision': 0.3507979969905523, 'recall': 0.6206926652554394, 'f1-score': 0.44825493888937046, 'support': 45823}, 'accuracy': 0.3419989512632846, 'macro avg': {'precision': 0.3385458936817456, 'recall': 0.33983750374600685, 'f1-score': 0.3098442824820041, 'support': 135401}, 'weighted avg': {'precision': 0.33863723954277053, 'recall': 0.3419989512632846, 'f1-score': 0.31091390720630224, 'support': 135401}}
[[12096  5499 27210]
 [13578  5769 25426]
 [11771  5610 28442]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046658
{'0': {'precision': 0.33287869746824655, 'recall': 0.45199374963828925, 'f1-score': 0.3833975601973442, 'support': 17279}, '1': {'precision': 0.3646176362971094, 'recall': 0.11365191605839416, 'f1-score': 0.17328927919311365, 'support': 17536}, '2': {'precision': 0.36664734619524714, 'recall': 0.48480867137461, 'f1-score': 0.4175290540062705, 'support': 18267}, 'accuracy': 0.35151275385253006, 'macro avg': {'precision': 0.3547145599868677, 'recall': 0.3501514456904311, 'f1-score': 0.32473863113224277, 'support': 53082}, 'weighted avg': {'precision': 0.35498460790114394, 'recall': 0.35151275385253006, 'f1-score': 0.325732460572565, 'support': 53082}}
[[7810 1699 7770]
 [8015 1993 7528]
 [7637 1774 8856]]
training model: results/QRTEA/W10/deepOF_L1/h10
Epoch 1/50
529/529 - 14s - loss: 2.9165 - accuracy10: 0.4533 - val_loss: 3.4957 - val_accuracy10: 0.6254 - 14s/epoch - 27ms/step
Epoch 2/50
529/529 - 12s - loss: 2.7503 - accuracy10: 0.5188 - val_loss: 3.3724 - val_accuracy10: 0.6534 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 2.6798 - accuracy10: 0.5690 - val_loss: 3.3273 - val_accuracy10: 0.6645 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 2.6299 - accuracy10: 0.5963 - val_loss: 3.2979 - val_accuracy10: 0.6710 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 2.6037 - accuracy10: 0.5995 - val_loss: 3.2510 - val_accuracy10: 0.6342 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 2.5766 - accuracy10: 0.5993 - val_loss: 3.2514 - val_accuracy10: 0.6442 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 2.5568 - accuracy10: 0.6123 - val_loss: 3.2114 - val_accuracy10: 0.6437 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 2.5380 - accuracy10: 0.6119 - val_loss: 3.2127 - val_accuracy10: 0.6444 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 2.5151 - accuracy10: 0.6175 - val_loss: 3.2164 - val_accuracy10: 0.6488 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 2.5045 - accuracy10: 0.6136 - val_loss: 3.2088 - val_accuracy10: 0.6414 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 2.4811 - accuracy10: 0.6166 - val_loss: 3.1815 - val_accuracy10: 0.6359 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 2.4667 - accuracy10: 0.6159 - val_loss: 3.2181 - val_accuracy10: 0.6484 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 2.4522 - accuracy10: 0.6170 - val_loss: 3.2039 - val_accuracy10: 0.6661 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 2.4392 - accuracy10: 0.6210 - val_loss: 3.1590 - val_accuracy10: 0.6402 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 2.4227 - accuracy10: 0.6233 - val_loss: 3.1808 - val_accuracy10: 0.6470 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 2.4074 - accuracy10: 0.6271 - val_loss: 3.1991 - val_accuracy10: 0.6531 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 2.3896 - accuracy10: 0.6280 - val_loss: 3.1716 - val_accuracy10: 0.6452 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 2.3769 - accuracy10: 0.6273 - val_loss: 3.1802 - val_accuracy10: 0.6540 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 2.3602 - accuracy10: 0.6336 - val_loss: 3.2347 - val_accuracy10: 0.6818 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 2.3524 - accuracy10: 0.6329 - val_loss: 3.1937 - val_accuracy10: 0.6650 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 2.3356 - accuracy10: 0.6334 - val_loss: 3.1702 - val_accuracy10: 0.6368 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 2.3187 - accuracy10: 0.6368 - val_loss: 3.2158 - val_accuracy10: 0.6617 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 2.3052 - accuracy10: 0.6358 - val_loss: 3.1901 - val_accuracy10: 0.6624 - 12s/epoch - 22ms/step
Epoch 24/50
529/529 - 12s - loss: 2.2895 - accuracy10: 0.6381 - val_loss: 3.1976 - val_accuracy10: 0.6718 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h10
Evaluating performance on  test set...
1840/1840 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83816344
{'0': {'precision': 0.26271486449278214, 'recall': 0.49728240637331544, 'f1-score': 0.3437998661656458, 'support': 40293}, '1': {'precision': 0.895764696031355, 'recall': 0.7126170858185247, 'f1-score': 0.793763314740854, 'support': 390312}, '2': {'precision': 0.2452247457949254, 'recall': 0.5115345541046163, 'f1-score': 0.3315213463839218, 'support': 40357}, 'accuracy': 0.6769633218815956, 'macro avg': {'precision': 0.46790143543968754, 'recall': 0.5738113487654856, 'f1-score': 0.48969484243014055, 'support': 470962}, 'weighted avg': {'precision': 0.7858591885087198, 'recall': 0.6769633218815956, 'f1-score': 0.7156570633863465, 'support': 470962}}
[[ 20037  16596   3660]
 [ 52289 278143  59880]
 [  3943  15770  20644]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75984055
{'0': {'precision': 0.22888130760222009, 'recall': 0.581425430086664, 'f1-score': 0.3284618195104128, 'support': 7731}, '1': {'precision': 0.9503701762432025, 'recall': 0.7263584847397367, 'f1-score': 0.8234002999068112, 'support': 119821}, '2': {'precision': 0.1995699280456538, 'recall': 0.6150121065375302, 'f1-score': 0.3013518998407693, 'support': 7847}, 'accuracy': 0.711630071123125, 'macro avg': {'precision': 0.45960713729702546, 'recall': 0.6409320071213104, 'f1-score': 0.48440467308599783, 'support': 135399}, 'weighted avg': {'precision': 0.8656623128832841, 'recall': 0.711630071123125, 'f1-score': 0.7648852208644047, 'support': 135399}}
[[ 4495  2335   901]
 [14333 87033 18455]
 [  811  2210  4826]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85510623
{'0': {'precision': 0.22166599919903884, 'recall': 0.5717975206611571, 'f1-score': 0.3194805194805195, 'support': 3872}, '1': {'precision': 0.9236602788004658, 'recall': 0.6491585023331933, 'f1-score': 0.7624551924775314, 'support': 45217}, '2': {'precision': 0.21104728236853734, 'recall': 0.5980465815176559, 'f1-score': 0.31199372876927095, 'support': 3993}, 'accuracy': 0.639670698165103, 'macro avg': {'precision': 0.4521245201226807, 'recall': 0.6063342015040021, 'f1-score': 0.46464314690910724, 'support': 53082}, 'weighted avg': {'precision': 0.8188491272732169, 'recall': 0.639670698165103, 'f1-score': 0.6962577892442033, 'support': 53082}}
[[ 2214  1235   423]
 [ 7360 29353  8504]
 [  414  1191  2388]]
training model: results/QRTEA/W10/deepOF_L1/h20
Epoch 1/50
529/529 - 14s - loss: 2.9123 - accuracy20: 0.4322 - val_loss: 3.4519 - val_accuracy20: 0.5858 - 14s/epoch - 26ms/step
Epoch 2/50
529/529 - 12s - loss: 2.7579 - accuracy20: 0.4765 - val_loss: 3.4008 - val_accuracy20: 0.6185 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 2.6940 - accuracy20: 0.5244 - val_loss: 3.3430 - val_accuracy20: 0.6345 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 2.6542 - accuracy20: 0.5431 - val_loss: 3.3149 - val_accuracy20: 0.6270 - 12s/epoch - 23ms/step
Epoch 5/50
529/529 - 12s - loss: 2.6250 - accuracy20: 0.5579 - val_loss: 3.2426 - val_accuracy20: 0.5850 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 2.6037 - accuracy20: 0.5590 - val_loss: 3.2176 - val_accuracy20: 0.6010 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 2.5775 - accuracy20: 0.5644 - val_loss: 3.2118 - val_accuracy20: 0.5892 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 2.5547 - accuracy20: 0.5674 - val_loss: 3.2018 - val_accuracy20: 0.5908 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 2.5373 - accuracy20: 0.5732 - val_loss: 3.2034 - val_accuracy20: 0.6036 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 2.5213 - accuracy20: 0.5760 - val_loss: 3.2237 - val_accuracy20: 0.5905 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 2.5068 - accuracy20: 0.5783 - val_loss: 3.1902 - val_accuracy20: 0.5852 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 2.4846 - accuracy20: 0.5772 - val_loss: 3.1978 - val_accuracy20: 0.6059 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 2.4793 - accuracy20: 0.5797 - val_loss: 3.1815 - val_accuracy20: 0.6060 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 2.4613 - accuracy20: 0.5826 - val_loss: 3.1761 - val_accuracy20: 0.5822 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 2.4484 - accuracy20: 0.5860 - val_loss: 3.2089 - val_accuracy20: 0.6066 - 12s/epoch - 23ms/step
Epoch 16/50
529/529 - 12s - loss: 2.4306 - accuracy20: 0.5861 - val_loss: 3.1941 - val_accuracy20: 0.5990 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 2.4179 - accuracy20: 0.5904 - val_loss: 3.1690 - val_accuracy20: 0.5932 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 2.4017 - accuracy20: 0.5912 - val_loss: 3.1764 - val_accuracy20: 0.5949 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 2.3896 - accuracy20: 0.5890 - val_loss: 3.1759 - val_accuracy20: 0.5889 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 2.3806 - accuracy20: 0.5959 - val_loss: 3.1991 - val_accuracy20: 0.5963 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 2.3632 - accuracy20: 0.6033 - val_loss: 3.1901 - val_accuracy20: 0.5785 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 2.3486 - accuracy20: 0.6023 - val_loss: 3.1880 - val_accuracy20: 0.5981 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 2.3358 - accuracy20: 0.6007 - val_loss: 3.2569 - val_accuracy20: 0.5897 - 12s/epoch - 22ms/step
Epoch 24/50
529/529 - 12s - loss: 2.3265 - accuracy20: 0.6024 - val_loss: 3.1743 - val_accuracy20: 0.5925 - 12s/epoch - 22ms/step
Epoch 25/50
529/529 - 12s - loss: 2.3130 - accuracy20: 0.6072 - val_loss: 3.2123 - val_accuracy20: 0.5930 - 12s/epoch - 22ms/step
Epoch 26/50
529/529 - 12s - loss: 2.2945 - accuracy20: 0.6067 - val_loss: 3.2042 - val_accuracy20: 0.6163 - 12s/epoch - 22ms/step
Epoch 27/50
529/529 - 12s - loss: 2.2828 - accuracy20: 0.6082 - val_loss: 3.2357 - val_accuracy20: 0.6041 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h20
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8695381
{'0': {'precision': 0.31380910296067166, 'recall': 0.5105319913731129, 'f1-score': 0.38869731800766283, 'support': 55640}, '1': {'precision': 0.8445116545862231, 'recall': 0.6751037967085188, 'f1-score': 0.7503648688093925, 'support': 359838}, '2': {'precision': 0.3000959186092879, 'recall': 0.5018563910316488, 'f1-score': 0.3755960369863291, 'support': 55484}, 'accuracy': 0.635250827030631, 'macro avg': {'precision': 0.4861388920520609, 'recall': 0.5624973930377601, 'f1-score': 0.5048860746011281, 'support': 470962}, 'weighted avg': {'precision': 0.7176762566828041, 'recall': 0.635250827030631, 'f1-score': 0.663485552874181, 'support': 470962}}
[[ 28406  22697   4537]
 [ 56505 242928  60405]
 [  5609  22030  27845]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8001827
{'0': {'precision': 0.2663655063929335, 'recall': 0.6191636977311082, 'f1-score': 0.3724865337431964, 'support': 10666}, '1': {'precision': 0.9220273829580239, 'recall': 0.6826478803956361, 'f1-score': 0.7844827586206896, 'support': 113842}, '2': {'precision': 0.2472644376899696, 'recall': 0.5975576163804976, 'f1-score': 0.34978904087501006, 'support': 10891}, 'accuracy': 0.6708025908610846, 'macro avg': {'precision': 0.47855244234697564, 'recall': 0.6331230648357473, 'f1-score': 0.5022527777462987, 'support': 135399}, 'weighted avg': {'precision': 0.8161024292112633, 'recall': 0.6708025908610846, 'f1-score': 0.7170627554115704, 'support': 135399}}
[[ 6604  3153   909]
 [17225 77714 18903]
 [  964  3419  6508]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9003826
{'0': {'precision': 0.2523974217890269, 'recall': 0.6006359895248784, 'f1-score': 0.35543502324551696, 'support': 5346}, '1': {'precision': 0.878765613519471, 'recall': 0.5958294783289445, 'f1-score': 0.710153532954449, 'support': 42153}, '2': {'precision': 0.27243399269887086, 'recall': 0.5747805839154576, 'f1-score': 0.36965787351687596, 'support': 5583}, 'accuracy': 0.5940996948118006, 'macro avg': {'precision': 0.4678656760024562, 'recall': 0.5904153505897601, 'f1-score': 0.4784154765722806, 'support': 53082}, 'weighted avg': {'precision': 0.7519106760259258, 'recall': 0.5940996948118006, 'f1-score': 0.638616808272939, 'support': 53082}}
[[ 3211  1699   436]
 [ 8903 25116  8134]
 [  608  1766  3209]]
training model: results/QRTEA/W10/deepOF_L1/h30
Epoch 1/50
529/529 - 14s - loss: 2.9329 - accuracy30: 0.4108 - val_loss: 3.4840 - val_accuracy30: 0.5754 - 14s/epoch - 26ms/step
Epoch 2/50
529/529 - 12s - loss: 2.7859 - accuracy30: 0.4498 - val_loss: 3.4173 - val_accuracy30: 0.6131 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 2.7267 - accuracy30: 0.4819 - val_loss: 3.3453 - val_accuracy30: 0.6092 - 12s/epoch - 23ms/step
Epoch 4/50
529/529 - 12s - loss: 2.6854 - accuracy30: 0.4999 - val_loss: 3.3041 - val_accuracy30: 0.6053 - 12s/epoch - 23ms/step
Epoch 5/50
529/529 - 12s - loss: 2.6472 - accuracy30: 0.5198 - val_loss: 3.2895 - val_accuracy30: 0.6024 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 2.6256 - accuracy30: 0.5259 - val_loss: 3.2765 - val_accuracy30: 0.6042 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 2.5996 - accuracy30: 0.5320 - val_loss: 3.2535 - val_accuracy30: 0.5926 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 2.5768 - accuracy30: 0.5376 - val_loss: 3.2505 - val_accuracy30: 0.5909 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 2.5605 - accuracy30: 0.5412 - val_loss: 3.2473 - val_accuracy30: 0.6024 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 2.5433 - accuracy30: 0.5460 - val_loss: 3.2393 - val_accuracy30: 0.5870 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 2.5194 - accuracy30: 0.5495 - val_loss: 3.2423 - val_accuracy30: 0.5904 - 12s/epoch - 23ms/step
Epoch 12/50
529/529 - 12s - loss: 2.5027 - accuracy30: 0.5509 - val_loss: 3.2263 - val_accuracy30: 0.5883 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 2.4846 - accuracy30: 0.5543 - val_loss: 3.2154 - val_accuracy30: 0.6026 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 2.4646 - accuracy30: 0.5571 - val_loss: 3.2536 - val_accuracy30: 0.5937 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 2.4575 - accuracy30: 0.5592 - val_loss: 3.2166 - val_accuracy30: 0.5953 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 2.4340 - accuracy30: 0.5623 - val_loss: 3.2133 - val_accuracy30: 0.5866 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 2.4168 - accuracy30: 0.5665 - val_loss: 3.1959 - val_accuracy30: 0.5929 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 2.4003 - accuracy30: 0.5660 - val_loss: 3.2388 - val_accuracy30: 0.5680 - 12s/epoch - 23ms/step
Epoch 19/50
529/529 - 12s - loss: 2.4001 - accuracy30: 0.5670 - val_loss: 3.2369 - val_accuracy30: 0.5821 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 2.3810 - accuracy30: 0.5701 - val_loss: 3.2224 - val_accuracy30: 0.5763 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 2.3670 - accuracy30: 0.5700 - val_loss: 3.2896 - val_accuracy30: 0.5944 - 12s/epoch - 23ms/step
Epoch 22/50
529/529 - 12s - loss: 2.3472 - accuracy30: 0.5754 - val_loss: 3.2756 - val_accuracy30: 0.6057 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 2.4162 - accuracy30: 0.5646 - val_loss: 3.2409 - val_accuracy30: 0.6049 - 12s/epoch - 23ms/step
Epoch 24/50
529/529 - 12s - loss: 2.3388 - accuracy30: 0.5777 - val_loss: 3.2679 - val_accuracy30: 0.5819 - 12s/epoch - 23ms/step
Epoch 25/50
529/529 - 12s - loss: 2.3255 - accuracy30: 0.5753 - val_loss: 3.2594 - val_accuracy30: 0.5821 - 12s/epoch - 23ms/step
Epoch 26/50
529/529 - 12s - loss: 2.3053 - accuracy30: 0.5791 - val_loss: 3.2811 - val_accuracy30: 0.5858 - 12s/epoch - 22ms/step
Epoch 27/50
529/529 - 12s - loss: 2.2950 - accuracy30: 0.5831 - val_loss: 3.2772 - val_accuracy30: 0.5991 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h30
Evaluating performance on  test set...
1840/1840 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87003344
{'0': {'precision': 0.35873885012805795, 'recall': 0.4826735982176012, 'f1-score': 0.4115788207131956, 'support': 67325}, '1': {'precision': 0.7972690539222517, 'recall': 0.6801722421494013, 'f1-score': 0.7340803068717396, 'support': 336503}, '2': {'precision': 0.34375870865399044, 'recall': 0.47773110495427057, 'f1-score': 0.3998204846913334, 'support': 67134}, 'accuracy': 0.6230821170285501, 'macro avg': {'precision': 0.49992220423476663, 'recall': 0.5468589817737577, 'f1-score': 0.5151598707587562, 'support': 470962}, 'weighted avg': {'precision': 0.6699339196870404, 'recall': 0.6230821170285501, 'f1-score': 0.6403304683329969, 'support': 470962}}
[[ 32496  29339   5490]
 [ 51887 228880  55736]
 [  6201  28861  32072]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7884889
{'0': {'precision': 0.30804828973843057, 'recall': 0.5879867885398264, 'f1-score': 0.40428846814016745, 'support': 13019}, '1': {'precision': 0.8922406025876671, 'recall': 0.6811416098827026, 'f1-score': 0.7725296442687747, 'support': 109039}, '2': {'precision': 0.29192910502416874, 'recall': 0.5975564050670864, 'f1-score': 0.39223597136460925, 'support': 13341}, 'accuracy': 0.6639487736246206, 'macro avg': {'precision': 0.4974059991167555, 'recall': 0.6222282678298718, 'f1-score': 0.5230180279245171, 'support': 135399}, 'weighted avg': {'precision': 0.7769195484441443, 'recall': 0.6639487736246206, 'f1-score': 0.6996514859202433, 'support': 135399}}
[[ 7655  4436   928]
 [16360 74271 18408]
 [  835  4534  7972]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8784658
{'0': {'precision': 0.30509329299041854, 'recall': 0.557518046383044, 'f1-score': 0.39437231788798954, 'support': 6511}, '1': {'precision': 0.8351204567608969, 'recall': 0.6032440588457186, 'f1-score': 0.7004920498182189, 'support': 39765}, '2': {'precision': 0.3108346709470305, 'recall': 0.5690567146635321, 'f1-score': 0.4020554344440984, 'support': 6806}, 'accuracy': 0.593251949813496, 'macro avg': {'precision': 0.4836828068994486, 'recall': 0.5766062732974316, 'f1-score': 0.49897326738343556, 'support': 53082}, 'weighted avg': {'precision': 0.7028855010026593, 'recall': 0.593251949813496, 'f1-score': 0.6246790589958311, 'support': 53082}}
[[ 3630  2328   553]
 [ 7743 23988  8034]
 [  525  2408  3873]]
training model: results/QRTEA/W10/deepOF_L1/h50
Epoch 1/50
529/529 - 14s - loss: 3.0062 - accuracy50: 0.3953 - val_loss: 3.6139 - val_accuracy50: 0.5504 - 14s/epoch - 26ms/step
Epoch 2/50
529/529 - 12s - loss: 2.8834 - accuracy50: 0.4159 - val_loss: 3.4589 - val_accuracy50: 0.5350 - 12s/epoch - 23ms/step
Epoch 3/50
529/529 - 12s - loss: 2.8363 - accuracy50: 0.4344 - val_loss: 3.4300 - val_accuracy50: 0.5438 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 2.7994 - accuracy50: 0.4528 - val_loss: 3.4055 - val_accuracy50: 0.5294 - 12s/epoch - 23ms/step
Epoch 5/50
529/529 - 12s - loss: 2.7687 - accuracy50: 0.4673 - val_loss: 3.3823 - val_accuracy50: 0.5407 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 2.7472 - accuracy50: 0.4763 - val_loss: 3.3560 - val_accuracy50: 0.5376 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 2.7245 - accuracy50: 0.4874 - val_loss: 3.3390 - val_accuracy50: 0.5467 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 2.6999 - accuracy50: 0.4963 - val_loss: 3.3258 - val_accuracy50: 0.5188 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 2.6783 - accuracy50: 0.4957 - val_loss: 3.3422 - val_accuracy50: 0.5176 - 12s/epoch - 23ms/step
Epoch 10/50
529/529 - 12s - loss: 2.6577 - accuracy50: 0.5029 - val_loss: 3.3356 - val_accuracy50: 0.5333 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 2.6378 - accuracy50: 0.5102 - val_loss: 3.3243 - val_accuracy50: 0.5391 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 2.6173 - accuracy50: 0.5132 - val_loss: 3.2954 - val_accuracy50: 0.5283 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 2.5972 - accuracy50: 0.5161 - val_loss: 3.3210 - val_accuracy50: 0.5313 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 2.5829 - accuracy50: 0.5215 - val_loss: 3.3174 - val_accuracy50: 0.5322 - 12s/epoch - 23ms/step
Epoch 15/50
529/529 - 12s - loss: 2.5711 - accuracy50: 0.5182 - val_loss: 3.3189 - val_accuracy50: 0.5401 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 2.5597 - accuracy50: 0.5203 - val_loss: 3.3167 - val_accuracy50: 0.5333 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 2.5317 - accuracy50: 0.5260 - val_loss: 3.3183 - val_accuracy50: 0.5280 - 12s/epoch - 23ms/step
Epoch 18/50
529/529 - 12s - loss: 2.5143 - accuracy50: 0.5293 - val_loss: 3.3781 - val_accuracy50: 0.5433 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 2.5069 - accuracy50: 0.5321 - val_loss: 3.3394 - val_accuracy50: 0.5478 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 2.4840 - accuracy50: 0.5332 - val_loss: 3.3408 - val_accuracy50: 0.5347 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 2.4659 - accuracy50: 0.5346 - val_loss: 3.3494 - val_accuracy50: 0.5361 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 2.4574 - accuracy50: 0.5382 - val_loss: 3.3634 - val_accuracy50: 0.5470 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h50
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95314157
{'0': {'precision': 0.34592577933167684, 'recall': 0.5485558203056895, 'f1-score': 0.42428955435886834, 'support': 86035}, '1': {'precision': 0.7136467301202588, 'recall': 0.5687739572818399, 'f1-score': 0.6330273346011223, 'support': 298187}, '2': {'precision': 0.3995169131992114, 'recall': 0.4462070555683652, 'f1-score': 0.42157316588333327, 'support': 86740}, 'accuracy': 0.5425066141217338, 'macro avg': {'precision': 0.4863631408837157, 'recall': 0.5211789443852982, 'f1-score': 0.4929633516144413, 'support': 470962}, 'weighted avg': {'precision': 0.5886164892073459, 'recall': 0.5425066141217338, 'f1-score': 0.5559504377013229, 'support': 470962}}
[[ 47195  31926   6914]
 [ 77327 169601  51259]
 [ 11909  36127  38704]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8800683
{'0': {'precision': 0.2907108038886288, 'recall': 0.6108089341511399, 'f1-score': 0.39393204336387216, 'support': 17282}, '1': {'precision': 0.829344737281997, 'recall': 0.5928976169373712, 'f1-score': 0.6914665660114397, 'support': 100417}, '2': {'precision': 0.34512820512820513, 'recall': 0.532316384180791, 'f1-score': 0.41875555555555555, 'support': 17700}, 'accuracy': 0.5872643077127601, 'macro avg': {'precision': 0.48839458209961034, 'recall': 0.578674311756434, 'f1-score': 0.5013847216436225, 'support': 135399}, 'weighted avg': {'precision': 0.6972957246893907, 'recall': 0.5872643077127601, 'f1-score': 0.6178399032926278, 'support': 135399}}
[[10556  5619  1107]
 [24109 59537 16771]
 [ 1646  6632  9422]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.944955
{'0': {'precision': 0.3076031949271386, 'recall': 0.5884754461682025, 'f1-score': 0.4040201809882278, 'support': 8573}, '1': {'precision': 0.7517098192476795, 'recall': 0.5176909274419648, 'f1-score': 0.6131292336299641, 'support': 35668}, '2': {'precision': 0.3710489395064785, 'recall': 0.5085397579459338, 'f1-score': 0.42904857333715046, 'support': 8841}, 'accuracy': 0.5275988093892469, 'macro avg': {'precision': 0.47678731789376555, 'recall': 0.5382353771853671, 'f1-score': 0.4820659959851141, 'support': 53082}, 'weighted avg': {'precision': 0.6165839964058131, 'recall': 0.5275988093892469, 'f1-score': 0.5486978062921402, 'support': 53082}}
[[ 5045  2810   718]
 [10300 18465  6903]
 [ 1056  3289  4496]]
training model: results/QRTEA/W10/deepOF_L1/h100
Epoch 1/50
529/529 - 13s - loss: 3.1663 - accuracy100: 0.3876 - val_loss: 3.5183 - val_accuracy100: 0.4656 - 13s/epoch - 25ms/step
Epoch 2/50
529/529 - 12s - loss: 3.0851 - accuracy100: 0.4120 - val_loss: 3.4836 - val_accuracy100: 0.4755 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 3.0508 - accuracy100: 0.4237 - val_loss: 3.4583 - val_accuracy100: 0.4864 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 3.0315 - accuracy100: 0.4357 - val_loss: 3.4443 - val_accuracy100: 0.4902 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 3.0099 - accuracy100: 0.4428 - val_loss: 3.4274 - val_accuracy100: 0.4969 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 2.9911 - accuracy100: 0.4523 - val_loss: 3.4051 - val_accuracy100: 0.4981 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 2.9745 - accuracy100: 0.4604 - val_loss: 3.3944 - val_accuracy100: 0.4987 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 2.9553 - accuracy100: 0.4639 - val_loss: 3.3930 - val_accuracy100: 0.4857 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 2.9377 - accuracy100: 0.4676 - val_loss: 3.3903 - val_accuracy100: 0.4831 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 2.9223 - accuracy100: 0.4716 - val_loss: 3.3914 - val_accuracy100: 0.4913 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 2.9070 - accuracy100: 0.4757 - val_loss: 3.3798 - val_accuracy100: 0.4954 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 2.8990 - accuracy100: 0.4724 - val_loss: 3.3670 - val_accuracy100: 0.4882 - 12s/epoch - 23ms/step
Epoch 13/50
529/529 - 12s - loss: 2.8829 - accuracy100: 0.4794 - val_loss: 3.3793 - val_accuracy100: 0.4950 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 2.8712 - accuracy100: 0.4800 - val_loss: 3.3615 - val_accuracy100: 0.4859 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 2.8586 - accuracy100: 0.4813 - val_loss: 3.3677 - val_accuracy100: 0.4958 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 2.8510 - accuracy100: 0.4855 - val_loss: 3.3601 - val_accuracy100: 0.4929 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 2.8383 - accuracy100: 0.4873 - val_loss: 3.3696 - val_accuracy100: 0.4985 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 2.8330 - accuracy100: 0.4864 - val_loss: 3.3569 - val_accuracy100: 0.4971 - 12s/epoch - 23ms/step
Epoch 19/50
529/529 - 12s - loss: 2.8155 - accuracy100: 0.4899 - val_loss: 3.3842 - val_accuracy100: 0.4891 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 2.8059 - accuracy100: 0.4887 - val_loss: 3.3821 - val_accuracy100: 0.4909 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 2.7930 - accuracy100: 0.4918 - val_loss: 3.4059 - val_accuracy100: 0.4898 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 2.7859 - accuracy100: 0.4926 - val_loss: 3.4240 - val_accuracy100: 0.4865 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 2.7688 - accuracy100: 0.4917 - val_loss: 3.4145 - val_accuracy100: 0.4866 - 12s/epoch - 22ms/step
Epoch 24/50
529/529 - 12s - loss: 2.7568 - accuracy100: 0.4911 - val_loss: 3.4424 - val_accuracy100: 0.4771 - 12s/epoch - 22ms/step
Epoch 25/50
529/529 - 12s - loss: 2.7455 - accuracy100: 0.4950 - val_loss: 3.4324 - val_accuracy100: 0.4753 - 12s/epoch - 22ms/step
Epoch 26/50
529/529 - 12s - loss: 2.7342 - accuracy100: 0.4953 - val_loss: 3.4510 - val_accuracy100: 0.4822 - 12s/epoch - 23ms/step
Epoch 27/50
529/529 - 12s - loss: 2.7280 - accuracy100: 0.4917 - val_loss: 3.4669 - val_accuracy100: 0.4788 - 12s/epoch - 22ms/step
Epoch 28/50
529/529 - 12s - loss: 2.7105 - accuracy100: 0.4995 - val_loss: 3.5444 - val_accuracy100: 0.4750 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h100
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0162643
{'0': {'precision': 0.4467758951839061, 'recall': 0.4125410068108774, 'f1-score': 0.42897649793723835, 'support': 120102}, '1': {'precision': 0.544962093224967, 'recall': 0.592576259049349, 'f1-score': 0.567772678400348, 'support': 229022}, '2': {'precision': 0.4406697228701894, 'recall': 0.4015824291272017, 'f1-score': 0.42021909313820216, 'support': 121838}, 'accuracy': 0.49725455556923914, 'macro avg': {'precision': 0.47746923709302086, 'recall': 0.46889989832914264, 'f1-score': 0.4723227564919295, 'support': 470962}, 'weighted avg': {'precision': 0.49294275286117356, 'recall': 0.49725455556923914, 'f1-score': 0.49420552736236667, 'support': 470962}}
[[ 49547  56326  14229]
 [ 45435 135713  47874]
 [ 15917  56993  48928]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93993366
{'0': {'precision': 0.3895877122069523, 'recall': 0.46215811883846714, 'f1-score': 0.42278134540477946, 'support': 26069}, '1': {'precision': 0.69273091934085, 'recall': 0.6151457899613714, 'f1-score': 0.6516371238630643, 'support': 83099}, '2': {'precision': 0.405938335180236, 'recall': 0.47481986961991535, 'f1-score': 0.43768559028692916, 'support': 26231}, 'accuracy': 0.5585048634037179, 'macro avg': {'precision': 0.49608565557601275, 'recall': 0.5173745928065846, 'f1-score': 0.5040346865182577, 'support': 135399}, 'weighted avg': {'precision': 0.5788046972720706, 'recall': 0.5585048634037179, 'f1-score': 0.5661253847374826, 'support': 135399}}
[[12048 11492  2529]
 [16283 51118 15698]
 [ 2594 11182 12455]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9993374
{'0': {'precision': 0.3922494617681783, 'recall': 0.4557043730837502, 'f1-score': 0.42160265741051767, 'support': 12394}, '1': {'precision': 0.5899996053514346, 'recall': 0.5335855521450497, 'f1-score': 0.5603763330022304, 'support': 28018}, '2': {'precision': 0.4282074340527578, 'recall': 0.4509865824782952, 'f1-score': 0.4393019143538095, 'support': 12670}, 'accuracy': 0.49568591989751704, 'macro avg': {'precision': 0.4701521670574569, 'recall': 0.48009216923569836, 'f1-score': 0.4737603015888525, 'support': 53082}, 'weighted avg': {'precision': 0.5052096183516019, 'recall': 0.49568591989751704, 'f1-score': 0.49907544344345006, 'support': 53082}}
[[ 5648  5144  1602]
 [ 7040 14950  6028]
 [ 1711  5245  5714]]
training model: results/QRTEA/W10/deepOF_L1/h200
Epoch 1/50
529/529 - 13s - loss: 3.2670 - accuracy200: 0.3821 - val_loss: 3.3917 - val_accuracy200: 0.4095 - 13s/epoch - 25ms/step
Epoch 2/50
529/529 - 12s - loss: 3.2149 - accuracy200: 0.4050 - val_loss: 3.3710 - val_accuracy200: 0.4152 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 3.1933 - accuracy200: 0.4120 - val_loss: 3.3472 - val_accuracy200: 0.4206 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 3.1819 - accuracy200: 0.4177 - val_loss: 3.3324 - val_accuracy200: 0.4198 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 3.1714 - accuracy200: 0.4247 - val_loss: 3.3184 - val_accuracy200: 0.4211 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 3.1631 - accuracy200: 0.4289 - val_loss: 3.3153 - val_accuracy200: 0.4262 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 3.1553 - accuracy200: 0.4337 - val_loss: 3.3122 - val_accuracy200: 0.4293 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 3.1496 - accuracy200: 0.4350 - val_loss: 3.3093 - val_accuracy200: 0.4305 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 3.1419 - accuracy200: 0.4389 - val_loss: 3.3117 - val_accuracy200: 0.4309 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 3.1349 - accuracy200: 0.4406 - val_loss: 3.3137 - val_accuracy200: 0.4377 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 3.1292 - accuracy200: 0.4443 - val_loss: 3.3076 - val_accuracy200: 0.4349 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 3.1222 - accuracy200: 0.4451 - val_loss: 3.3082 - val_accuracy200: 0.4377 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 3.1163 - accuracy200: 0.4460 - val_loss: 3.3085 - val_accuracy200: 0.4365 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 3.1107 - accuracy200: 0.4464 - val_loss: 3.3105 - val_accuracy200: 0.4401 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 3.1048 - accuracy200: 0.4490 - val_loss: 3.3186 - val_accuracy200: 0.4429 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 3.0989 - accuracy200: 0.4490 - val_loss: 3.3172 - val_accuracy200: 0.4405 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 3.0890 - accuracy200: 0.4529 - val_loss: 3.3115 - val_accuracy200: 0.4398 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 3.0823 - accuracy200: 0.4543 - val_loss: 3.3264 - val_accuracy200: 0.4392 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 3.0769 - accuracy200: 0.4547 - val_loss: 3.3259 - val_accuracy200: 0.4325 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 3.0716 - accuracy200: 0.4545 - val_loss: 3.3514 - val_accuracy200: 0.4346 - 12s/epoch - 23ms/step
Epoch 21/50
529/529 - 12s - loss: 3.0635 - accuracy200: 0.4560 - val_loss: 3.3509 - val_accuracy200: 0.4346 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h200
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0684503
{'0': {'precision': 0.44853502012045976, 'recall': 0.44406181647745024, 'f1-score': 0.4462872096826954, 'support': 153616}, '1': {'precision': 0.37023417844010065, 'recall': 0.5069084301775372, 'f1-score': 0.4279231777074745, 'support': 158502}, '2': {'precision': 0.4946497290504987, 'recall': 0.31721059656014705, 'f1-score': 0.386539730272949, 'support': 158844}, 'accuracy': 0.4224289857780458, 'macro avg': {'precision': 0.43780630920368635, 'recall': 0.42272694773837816, 'f1-score': 0.4202500392210396, 'support': 470962}, 'weighted avg': {'precision': 0.43773628225469313, 'recall': 0.4224289857780458, 'f1-score': 0.41995543681036557, 'support': 470962}}
[[68215 64777 20624]
 [47303 80346 30853]
 [36566 71891 50387]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.035592
{'0': {'precision': 0.39102899743186975, 'recall': 0.43971849941120394, 'f1-score': 0.41394692040700515, 'support': 35666}, '1': {'precision': 0.5252775649404305, 'recall': 0.547357379923602, 'f1-score': 0.5360902197995967, 'support': 63876}, '2': {'precision': 0.4405694197904702, 'recall': 0.35301335861895866, 'f1-score': 0.39196135505047375, 'support': 35857}, 'accuracy': 0.4675366878632782, 'macro avg': {'precision': 0.45229199405425685, 'recall': 0.44669641265125487, 'f1-score': 0.44733283175235855, 'support': 135399}, 'weighted avg': {'precision': 0.46748179562601566, 'recall': 0.4675366878632782, 'f1-score': 0.46574707384249603, 'support': 135399}}
[[15683 15446  4537]
 [17377 34963 11536]
 [ 7047 16152 12658]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0547928
{'0': {'precision': 0.4171107994389902, 'recall': 0.46944058593256727, 'f1-score': 0.4417312776639041, 'support': 15838}, '1': {'precision': 0.4433991295555458, 'recall': 0.47174929840972873, 'f1-score': 0.4571350873614794, 'support': 21380}, '2': {'precision': 0.4541167066346922, 'recall': 0.3581064044377206, 'f1-score': 0.40043701980686547, 'support': 15864}, 'accuracy': 0.43709732112580535, 'macro avg': {'precision': 0.43820887854307605, 'recall': 0.4330987629266722, 'f1-score': 0.43310112827741626, 'support': 53082}, 'weighted avg': {'precision': 0.4387585559222534, 'recall': 0.43709732112580535, 'f1-score': 0.43559438275960694, 'support': 53082}}
[[ 7435  5991  2412]
 [ 6877 10086  4417]
 [ 3513  6670  5681]]
training model: results/QRTEA/W10/deepOF_L1/h300
Epoch 1/50
529/529 - 14s - loss: 3.2899 - accuracy300: 0.3791 - val_loss: 3.3559 - val_accuracy300: 0.3694 - 14s/epoch - 26ms/step
Epoch 2/50
529/529 - 12s - loss: 3.2554 - accuracy300: 0.3961 - val_loss: 3.3360 - val_accuracy300: 0.3832 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 3.2380 - accuracy300: 0.4039 - val_loss: 3.3226 - val_accuracy300: 0.3871 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 3.2319 - accuracy300: 0.4062 - val_loss: 3.3017 - val_accuracy300: 0.3973 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 3.2249 - accuracy300: 0.4095 - val_loss: 3.2942 - val_accuracy300: 0.4004 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 3.2146 - accuracy300: 0.4147 - val_loss: 3.2956 - val_accuracy300: 0.3967 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 3.2087 - accuracy300: 0.4188 - val_loss: 3.2957 - val_accuracy300: 0.4004 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 3.2034 - accuracy300: 0.4211 - val_loss: 3.2896 - val_accuracy300: 0.4047 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 3.1986 - accuracy300: 0.4235 - val_loss: 3.2829 - val_accuracy300: 0.4075 - 12s/epoch - 23ms/step
Epoch 10/50
529/529 - 12s - loss: 3.1936 - accuracy300: 0.4257 - val_loss: 3.2909 - val_accuracy300: 0.4024 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 3.1885 - accuracy300: 0.4283 - val_loss: 3.2897 - val_accuracy300: 0.4048 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 3.1857 - accuracy300: 0.4292 - val_loss: 3.2888 - val_accuracy300: 0.4065 - 12s/epoch - 23ms/step
Epoch 13/50
529/529 - 12s - loss: 3.1815 - accuracy300: 0.4302 - val_loss: 3.2927 - val_accuracy300: 0.4063 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 3.1758 - accuracy300: 0.4320 - val_loss: 3.2921 - val_accuracy300: 0.4077 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 3.1707 - accuracy300: 0.4329 - val_loss: 3.2824 - val_accuracy300: 0.4114 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 3.1671 - accuracy300: 0.4353 - val_loss: 3.2799 - val_accuracy300: 0.4124 - 12s/epoch - 23ms/step
Epoch 17/50
529/529 - 12s - loss: 3.1618 - accuracy300: 0.4376 - val_loss: 3.2862 - val_accuracy300: 0.4150 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 3.1562 - accuracy300: 0.4388 - val_loss: 3.2852 - val_accuracy300: 0.4141 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 3.1529 - accuracy300: 0.4396 - val_loss: 3.2904 - val_accuracy300: 0.4123 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 3.1466 - accuracy300: 0.4415 - val_loss: 3.2974 - val_accuracy300: 0.4141 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 3.1418 - accuracy300: 0.4431 - val_loss: 3.2978 - val_accuracy300: 0.4141 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 3.1347 - accuracy300: 0.4454 - val_loss: 3.2910 - val_accuracy300: 0.4143 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 3.1268 - accuracy300: 0.4459 - val_loss: 3.3197 - val_accuracy300: 0.4034 - 12s/epoch - 22ms/step
Epoch 24/50
529/529 - 12s - loss: 3.1273 - accuracy300: 0.4455 - val_loss: 3.3175 - val_accuracy300: 0.4074 - 12s/epoch - 22ms/step
Epoch 25/50
529/529 - 12s - loss: 3.1170 - accuracy300: 0.4513 - val_loss: 3.3248 - val_accuracy300: 0.4070 - 12s/epoch - 22ms/step
Epoch 26/50
529/529 - 12s - loss: 3.1132 - accuracy300: 0.4498 - val_loss: 3.3418 - val_accuracy300: 0.4032 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h300
Evaluating performance on  test set...
1840/1840 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0811466
{'0': {'precision': 0.4437904176127382, 'recall': 0.4583226970774537, 'f1-score': 0.4509395059781434, 'support': 168449}, '1': {'precision': 0.28753197422301263, 'recall': 0.42093505408141946, 'f1-score': 0.3416737329593634, 'support': 124442}, '2': {'precision': 0.49354200959771466, 'recall': 0.3182326150805016, 'f1-score': 0.38695756085902555, 'support': 178071}, 'accuracy': 0.39547564347017383, 'macro avg': {'precision': 0.4082881338111551, 'recall': 0.3991634554131249, 'f1-score': 0.3931902665988441, 'support': 470962}, 'weighted avg': {'precision': 0.42131345030763195, 'recall': 0.39547564347017383, 'f1-score': 0.3978766680521335, 'support': 470962}}
[[77204 61776 29469]
 [43378 52382 28682]
 [53383 68020 56668]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0582016
{'0': {'precision': 0.41498277307011827, 'recall': 0.44242033157946986, 'f1-score': 0.428262540841822, 'support': 40292}, '1': {'precision': 0.4502219736428147, 'recall': 0.47475026724169705, 'f1-score': 0.46216090139227783, 'support': 54258}, '2': {'precision': 0.4301285872434642, 'recall': 0.37095155328159807, 'f1-score': 0.3983543205657351, 'support': 40849}, 'accuracy': 0.4338141345209344, 'macro avg': {'precision': 0.4317777779854657, 'recall': 0.42937405070092166, 'f1-score': 0.42959258759994495, 'support': 135399}, 'weighted avg': {'precision': 0.43367345695877607, 'recall': 0.4338141345209344, 'f1-score': 0.43282340433925376, 'support': 135399}}
[[17826 15378  7088]
 [15511 25759 12988]
 [ 9619 16077 15153]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0729775
{'0': {'precision': 0.4213862195869965, 'recall': 0.46912877710123485, 'f1-score': 0.4439777041764278, 'support': 17573}, '1': {'precision': 0.3697286346430666, 'recall': 0.3924064957845301, 'f1-score': 0.3807301674444139, 'support': 17673}, '2': {'precision': 0.45728609172820267, 'recall': 0.3784480825297152, 'f1-score': 0.41414854127680456, 'support': 17836}, 'accuracy': 0.4131155570626578, 'macro avg': {'precision': 0.4161336486527552, 'recall': 0.4133277851384934, 'f1-score': 0.41295213763254873, 'support': 53082}, 'weighted avg': {'precision': 0.4162501211128712, 'recall': 0.4131155570626578, 'f1-score': 0.41289736307883235, 'support': 53082}}
[[8244 5784 3545]
 [6272 6935 4466]
 [5048 6038 6750]]
training model: results/QRTEA/W10/deepOF_L1/h500
Epoch 1/50
529/529 - 14s - loss: 3.3095 - accuracy500: 0.3707 - val_loss: 3.3044 - val_accuracy500: 0.3542 - 14s/epoch - 26ms/step
Epoch 2/50
529/529 - 12s - loss: 3.2812 - accuracy500: 0.3850 - val_loss: 3.2863 - val_accuracy500: 0.3700 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 3.2674 - accuracy500: 0.3908 - val_loss: 3.2701 - val_accuracy500: 0.3805 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 3.2616 - accuracy500: 0.3927 - val_loss: 3.2629 - val_accuracy500: 0.3838 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 3.2555 - accuracy500: 0.3955 - val_loss: 3.2564 - val_accuracy500: 0.3933 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 3.2508 - accuracy500: 0.3979 - val_loss: 3.2549 - val_accuracy500: 0.3942 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 3.2459 - accuracy500: 0.3994 - val_loss: 3.2552 - val_accuracy500: 0.3904 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 3.2424 - accuracy500: 0.4027 - val_loss: 3.2542 - val_accuracy500: 0.3882 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 3.2385 - accuracy500: 0.4035 - val_loss: 3.2557 - val_accuracy500: 0.3886 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 3.2372 - accuracy500: 0.4042 - val_loss: 3.2538 - val_accuracy500: 0.3892 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 3.2344 - accuracy500: 0.4063 - val_loss: 3.2569 - val_accuracy500: 0.3869 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 3.2320 - accuracy500: 0.4079 - val_loss: 3.2555 - val_accuracy500: 0.3866 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 3.2290 - accuracy500: 0.4091 - val_loss: 3.2528 - val_accuracy500: 0.3891 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 3.2287 - accuracy500: 0.4107 - val_loss: 3.2579 - val_accuracy500: 0.3862 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 3.2263 - accuracy500: 0.4114 - val_loss: 3.2573 - val_accuracy500: 0.3812 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 3.2246 - accuracy500: 0.4114 - val_loss: 3.2584 - val_accuracy500: 0.3839 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 3.2226 - accuracy500: 0.4125 - val_loss: 3.2594 - val_accuracy500: 0.3794 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 3.2209 - accuracy500: 0.4132 - val_loss: 3.2583 - val_accuracy500: 0.3818 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 3.2198 - accuracy500: 0.4138 - val_loss: 3.2562 - val_accuracy500: 0.3837 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 3.2163 - accuracy500: 0.4153 - val_loss: 3.2569 - val_accuracy500: 0.3820 - 12s/epoch - 22ms/step
Epoch 21/50
529/529 - 12s - loss: 3.2157 - accuracy500: 0.4155 - val_loss: 3.2568 - val_accuracy500: 0.3834 - 12s/epoch - 22ms/step
Epoch 22/50
529/529 - 12s - loss: 3.2127 - accuracy500: 0.4169 - val_loss: 3.2578 - val_accuracy500: 0.3833 - 12s/epoch - 22ms/step
Epoch 23/50
529/529 - 12s - loss: 3.2109 - accuracy500: 0.4167 - val_loss: 3.2585 - val_accuracy500: 0.3866 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h500
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0940737
{'0': {'precision': 0.4369761262664078, 'recall': 0.3711532833569708, 'f1-score': 0.40138404092476326, 'support': 177684}, '1': {'precision': 0.22312122099444676, 'recall': 0.4358161330135763, 'f1-score': 0.2951413427561838, 'support': 99659}, '2': {'precision': 0.47805905153849837, 'recall': 0.3095770559707467, 'f1-score': 0.3757981949899844, 'support': 193619}, 'accuracy': 0.35952157498906495, 'macro avg': {'precision': 0.37938546626645103, 'recall': 0.37218215744709787, 'f1-score': 0.3574411928903105, 'support': 470962}, 'weighted avg': {'precision': 0.4086126253974599, 'recall': 0.35952157498906495, 'f1-score': 0.3683836142219117, 'support': 470962}}
[[65948 72718 39018]
 [29802 43433 26424]
 [55169 78510 59940]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0811504
{'0': {'precision': 0.4143193944658146, 'recall': 0.3754131906186054, 'f1-score': 0.39390793478517333, 'support': 44471}, '1': {'precision': 0.3616508614013046, 'recall': 0.46964820526574586, 'f1-score': 0.4086343526666342, 'support': 44742}, '2': {'precision': 0.43512337504391774, 'recall': 0.3485904819642316, 'f1-score': 0.38707971197422675, 'support': 46186}, 'accuracy': 0.397403230452219, 'macro avg': {'precision': 0.40369787697034565, 'recall': 0.3978839592828609, 'f1-score': 0.39654066647534475, 'support': 135399}, 'weighted avg': {'precision': 0.40401176398558925, 'recall': 0.397403230452219, 'f1-score': 0.39644503690635546, 'support': 135399}}
[[16695 18211  9565]
 [12393 21013 11336]
 [11207 18879 16100]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0856397
{'0': {'precision': 0.4341120694579311, 'recall': 0.3972817564035546, 'f1-score': 0.4148811310969785, 'support': 19130}, '1': {'precision': 0.2935742769168644, 'recall': 0.3990668313434884, 'f1-score': 0.33828704376908536, 'support': 14574}, '2': {'precision': 0.4583227607206293, 'recall': 0.3728454948911136, 'f1-score': 0.41118889078595416, 'support': 19378}, 'accuracy': 0.38885121133340866, 'macro avg': {'precision': 0.3953363690318083, 'recall': 0.3897313608793856, 'f1-score': 0.38811902188400604, 'support': 53082}, 'weighted avg': {'precision': 0.40436482909010507, 'recall': 0.38885121133340866, 'f1-score': 0.3925038570405423, 'support': 53082}}
[[7600 6991 4539]
 [4758 5816 4000]
 [5149 7004 7225]]
training model: results/QRTEA/W10/deepOF_L1/h1000
Epoch 1/50
529/529 - 13s - loss: 3.3202 - accuracy1000: 0.3640 - val_loss: 3.3536 - val_accuracy1000: 0.3361 - 13s/epoch - 25ms/step
Epoch 2/50
529/529 - 12s - loss: 3.2995 - accuracy1000: 0.3688 - val_loss: 3.3086 - val_accuracy1000: 0.3440 - 12s/epoch - 22ms/step
Epoch 3/50
529/529 - 12s - loss: 3.2942 - accuracy1000: 0.3695 - val_loss: 3.2957 - val_accuracy1000: 0.3487 - 12s/epoch - 22ms/step
Epoch 4/50
529/529 - 12s - loss: 3.2899 - accuracy1000: 0.3659 - val_loss: 3.2898 - val_accuracy1000: 0.3551 - 12s/epoch - 22ms/step
Epoch 5/50
529/529 - 12s - loss: 3.2843 - accuracy1000: 0.3651 - val_loss: 3.2883 - val_accuracy1000: 0.3571 - 12s/epoch - 22ms/step
Epoch 6/50
529/529 - 12s - loss: 3.2828 - accuracy1000: 0.3654 - val_loss: 3.2862 - val_accuracy1000: 0.3623 - 12s/epoch - 22ms/step
Epoch 7/50
529/529 - 12s - loss: 3.2814 - accuracy1000: 0.3659 - val_loss: 3.2876 - val_accuracy1000: 0.3622 - 12s/epoch - 22ms/step
Epoch 8/50
529/529 - 12s - loss: 3.2823 - accuracy1000: 0.3621 - val_loss: 3.2860 - val_accuracy1000: 0.3626 - 12s/epoch - 22ms/step
Epoch 9/50
529/529 - 12s - loss: 3.2812 - accuracy1000: 0.3623 - val_loss: 3.2858 - val_accuracy1000: 0.3621 - 12s/epoch - 22ms/step
Epoch 10/50
529/529 - 12s - loss: 3.2794 - accuracy1000: 0.3638 - val_loss: 3.2849 - val_accuracy1000: 0.3651 - 12s/epoch - 22ms/step
Epoch 11/50
529/529 - 12s - loss: 3.2776 - accuracy1000: 0.3642 - val_loss: 3.2858 - val_accuracy1000: 0.3619 - 12s/epoch - 22ms/step
Epoch 12/50
529/529 - 12s - loss: 3.2771 - accuracy1000: 0.3651 - val_loss: 3.2851 - val_accuracy1000: 0.3650 - 12s/epoch - 22ms/step
Epoch 13/50
529/529 - 12s - loss: 3.2751 - accuracy1000: 0.3675 - val_loss: 3.2853 - val_accuracy1000: 0.3628 - 12s/epoch - 22ms/step
Epoch 14/50
529/529 - 12s - loss: 3.2745 - accuracy1000: 0.3668 - val_loss: 3.2862 - val_accuracy1000: 0.3622 - 12s/epoch - 22ms/step
Epoch 15/50
529/529 - 12s - loss: 3.2724 - accuracy1000: 0.3685 - val_loss: 3.2868 - val_accuracy1000: 0.3632 - 12s/epoch - 22ms/step
Epoch 16/50
529/529 - 12s - loss: 3.2711 - accuracy1000: 0.3691 - val_loss: 3.2872 - val_accuracy1000: 0.3628 - 12s/epoch - 22ms/step
Epoch 17/50
529/529 - 12s - loss: 3.2699 - accuracy1000: 0.3705 - val_loss: 3.2858 - val_accuracy1000: 0.3613 - 12s/epoch - 22ms/step
Epoch 18/50
529/529 - 12s - loss: 3.2679 - accuracy1000: 0.3713 - val_loss: 3.2867 - val_accuracy1000: 0.3607 - 12s/epoch - 22ms/step
Epoch 19/50
529/529 - 12s - loss: 3.2672 - accuracy1000: 0.3709 - val_loss: 3.2864 - val_accuracy1000: 0.3607 - 12s/epoch - 22ms/step
Epoch 20/50
529/529 - 12s - loss: 3.2647 - accuracy1000: 0.3730 - val_loss: 3.2882 - val_accuracy1000: 0.3580 - 12s/epoch - 22ms/step
testing model: results/QRTEA/W10/deepOF_L1/h1000
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943902
{'0': {'precision': 0.36703639020290457, 'recall': 0.5939199980036932, 'f1-score': 0.4536943711741593, 'support': 160296}, '1': {'precision': 0.3568476164232571, 'recall': 0.04843728960636754, 'f1-score': 0.08529669417677165, 'support': 133678}, '2': {'precision': 0.3965486936112576, 'recall': 0.4333966144597374, 'f1-score': 0.4141546668394426, 'support': 176988}, 'accuracy': 0.37876516576708946, 'macro avg': {'precision': 0.3734775667458064, 'recall': 0.35858463402326607, 'f1-score': 0.3177152440634578, 'support': 470962}, 'weighted avg': {'precision': 0.3752351592210459, 'recall': 0.37876516576708946, 'f1-score': 0.33426919917206643, 'support': 470962}}
[[95203  5575 59518]
 [69993  6475 57210]
 [94187  6095 76706]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.091445
{'0': {'precision': 0.3667780854146642, 'recall': 0.5707684064830111, 'f1-score': 0.44658125256547976, 'support': 44794}, '1': {'precision': 0.3572888283378747, 'recall': 0.04685022665862754, 'f1-score': 0.08283813397034727, 'support': 44781}, '2': {'precision': 0.3824473420260782, 'recall': 0.49925803072625696, 'f1-score': 0.4331149899663019, 'support': 45824}, 'accuracy': 0.37328931528297843, 'macro avg': {'precision': 0.36883808525953904, 'recall': 0.37229222128929856, 'f1-score': 0.32084479216737627, 'support': 135399}, 'weighted avg': {'precision': 0.36894272173993786, 'recall': 0.37328931528297843, 'f1-score': 0.3217216996060535, 'support': 135399}}
[[25567  1832 17395]
 [23136  2098 19547]
 [21004  1942 22878]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0953248
{'0': {'precision': 0.35438063104816286, 'recall': 0.5529330093717459, 'f1-score': 0.4319316718259259, 'support': 17286}, '1': {'precision': 0.3134246575342466, 'recall': 0.03261303381036547, 'f1-score': 0.05907870274736625, 'support': 17539}, '2': {'precision': 0.3760191056575805, 'recall': 0.5001917072903543, 'f1-score': 0.42930681898314643, 'support': 18257}, 'accuracy': 0.36287253682981047, 'macro avg': {'precision': 0.3479414647466634, 'recall': 0.36191258349082195, 'f1-score': 0.3067723978521462, 'support': 53082}, 'weighted avg': {'precision': 0.3482905593003681, 'recall': 0.36287253682981047, 'f1-score': 0.30783329265747933, 'support': 53082}}
[[9558  690 7038]
 [8851  572 8116]
 [8562  563 9132]]
training model: results/QRTEA/W10/deepLOB_L2/h10
Epoch 1/50
529/529 - 28s - loss: 2.9653 - accuracy10: 0.4005 - val_loss: 3.9096 - val_accuracy10: 0.7640 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 25s - loss: 2.6818 - accuracy10: 0.4546 - val_loss: 3.7825 - val_accuracy10: 0.6096 - 25s/epoch - 48ms/step
Epoch 3/50
529/529 - 26s - loss: 2.5714 - accuracy10: 0.5027 - val_loss: 3.7450 - val_accuracy10: 0.5046 - 26s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 2.4887 - accuracy10: 0.5267 - val_loss: 3.5801 - val_accuracy10: 0.4609 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 2.3964 - accuracy10: 0.5617 - val_loss: 3.8301 - val_accuracy10: 0.4510 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 2.3468 - accuracy10: 0.5781 - val_loss: 3.7457 - val_accuracy10: 0.4650 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 2.2908 - accuracy10: 0.5972 - val_loss: 3.7378 - val_accuracy10: 0.4794 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.2374 - accuracy10: 0.6146 - val_loss: 3.6793 - val_accuracy10: 0.5148 - 26s/epoch - 48ms/step
Epoch 9/50
529/529 - 25s - loss: 2.2087 - accuracy10: 0.6276 - val_loss: 3.6113 - val_accuracy10: 0.5168 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.1588 - accuracy10: 0.6387 - val_loss: 3.7327 - val_accuracy10: 0.5039 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.1299 - accuracy10: 0.6449 - val_loss: 3.6780 - val_accuracy10: 0.5550 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.0885 - accuracy10: 0.6549 - val_loss: 3.5974 - val_accuracy10: 0.5787 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 26s - loss: 2.0490 - accuracy10: 0.6613 - val_loss: 3.5428 - val_accuracy10: 0.5650 - 26s/epoch - 48ms/step
Epoch 14/50
529/529 - 26s - loss: 2.0167 - accuracy10: 0.6710 - val_loss: 3.5559 - val_accuracy10: 0.6256 - 26s/epoch - 48ms/step
Epoch 15/50
529/529 - 25s - loss: 1.9832 - accuracy10: 0.6768 - val_loss: 3.5613 - val_accuracy10: 0.5863 - 25s/epoch - 48ms/step
Epoch 16/50
529/529 - 25s - loss: 1.9594 - accuracy10: 0.6803 - val_loss: 3.6604 - val_accuracy10: 0.6374 - 25s/epoch - 48ms/step
Epoch 17/50
529/529 - 25s - loss: 1.9288 - accuracy10: 0.6850 - val_loss: 3.6580 - val_accuracy10: 0.5890 - 25s/epoch - 48ms/step
Epoch 18/50
529/529 - 25s - loss: 1.8902 - accuracy10: 0.6872 - val_loss: 3.7218 - val_accuracy10: 0.6516 - 25s/epoch - 48ms/step
Epoch 19/50
529/529 - 26s - loss: 1.8763 - accuracy10: 0.6865 - val_loss: 3.5960 - val_accuracy10: 0.6135 - 26s/epoch - 48ms/step
Epoch 20/50
529/529 - 26s - loss: 1.8426 - accuracy10: 0.6919 - val_loss: 3.8077 - val_accuracy10: 0.6349 - 26s/epoch - 48ms/step
Epoch 21/50
529/529 - 26s - loss: 1.8256 - accuracy10: 0.6923 - val_loss: 3.7792 - val_accuracy10: 0.6437 - 26s/epoch - 49ms/step
Epoch 22/50
529/529 - 25s - loss: 1.7918 - accuracy10: 0.6980 - val_loss: 3.7284 - val_accuracy10: 0.5961 - 25s/epoch - 48ms/step
Epoch 23/50
529/529 - 25s - loss: 1.7683 - accuracy10: 0.7016 - val_loss: 3.8427 - val_accuracy10: 0.6321 - 25s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h10
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6742142
{'0': {'precision': 0.28346648612051456, 'recall': 0.25977216886307797, 'f1-score': 0.2711025926597425, 'support': 40293}, '1': {'precision': 0.8731862474518656, 'recall': 0.8186874703764908, 'f1-score': 0.8450590993416363, 'support': 390315}, '2': {'precision': 0.2374133474327341, 'recall': 0.4005302410862509, 'f1-score': 0.2981179746788754, 'support': 40359}, 'accuracy': 0.7350366373864835, 'macro avg': {'precision': 0.4646886936683714, 'recall': 0.49299662677527323, 'f1-score': 0.4714265555600847, 'support': 470967}, 'weighted avg': {'precision': 0.7682516409609729, 'recall': 0.7350366373864835, 'f1-score': 0.7490854400958762, 'support': 470967}}
[[ 10467  25399   4427]
 [ 23273 319546  47496]
 [  3185  21009  16165]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8603761
{'0': {'precision': 0.15394155245333419, 'recall': 0.6287829588258216, 'f1-score': 0.24733050630971234, 'support': 7699}, '1': {'precision': 0.9410330699817483, 'recall': 0.6152440398207565, 'f1-score': 0.7440384285469206, 'support': 119837}, '2': {'precision': 0.15883616481156024, 'recall': 0.5171010807374443, 'f1-score': 0.24302360322677022, 'support': 7865}, 'accuracy': 0.6103130700659523, 'macro avg': {'precision': 0.4179369290822142, 'recall': 0.5870426931280075, 'f1-score': 0.4114641793611344, 'support': 135401}, 'weighted avg': {'precision': 0.850843217228705, 'recall': 0.6103130700659523, 'f1-score': 0.6866929444334559, 'support': 135401}}
[[ 4841  2219   639]
 [25209 73729 20899]
 [ 1397  2401  4067]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91161215
{'0': {'precision': 0.18393605614582317, 'recall': 0.4912783129393387, 'f1-score': 0.26765957446808514, 'support': 3841}, '1': {'precision': 0.9042224871992706, 'recall': 0.5697774634814701, 'f1-score': 0.6990578187487291, 'support': 45251}, '2': {'precision': 0.15647494583828359, 'recall': 0.5611528822055137, 'f1-score': 0.24471282583747744, 'support': 3990}, 'accuracy': 0.5634490034286576, 'macro avg': {'precision': 0.4148778297277924, 'recall': 0.5407362195421075, 'f1-score': 0.4038100730180972, 'support': 53082}, 'weighted avg': {'precision': 0.7958970120531451, 'recall': 0.5634490034286577, 'f1-score': 0.6336903273580912, 'support': 53082}}
[[ 1887  1452   502]
 [ 7900 25783 11568]
 [  472  1279  2239]]
training model: results/QRTEA/W10/deepLOB_L2/h20
Epoch 1/50
529/529 - 28s - loss: 2.9616 - accuracy20: 0.3847 - val_loss: 3.8916 - val_accuracy20: 0.6727 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 26s - loss: 2.6864 - accuracy20: 0.4309 - val_loss: 3.7719 - val_accuracy20: 0.4802 - 26s/epoch - 48ms/step
Epoch 3/50
529/529 - 25s - loss: 2.5985 - accuracy20: 0.4915 - val_loss: 3.6628 - val_accuracy20: 0.5771 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 2.5317 - accuracy20: 0.5132 - val_loss: 3.8402 - val_accuracy20: 0.4571 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 2.4727 - accuracy20: 0.5304 - val_loss: 3.6307 - val_accuracy20: 0.5155 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 26s - loss: 2.4040 - accuracy20: 0.5592 - val_loss: 3.6703 - val_accuracy20: 0.4890 - 26s/epoch - 49ms/step
Epoch 7/50
529/529 - 25s - loss: 2.3428 - accuracy20: 0.5787 - val_loss: 3.6570 - val_accuracy20: 0.5204 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.2948 - accuracy20: 0.5954 - val_loss: 3.5857 - val_accuracy20: 0.5383 - 26s/epoch - 48ms/step
Epoch 9/50
529/529 - 26s - loss: 2.2468 - accuracy20: 0.6098 - val_loss: 3.5037 - val_accuracy20: 0.4812 - 26s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.2076 - accuracy20: 0.6217 - val_loss: 3.3981 - val_accuracy20: 0.5273 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.1735 - accuracy20: 0.6262 - val_loss: 3.5329 - val_accuracy20: 0.5103 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 26s - loss: 2.1394 - accuracy20: 0.6336 - val_loss: 3.7336 - val_accuracy20: 0.4506 - 26s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.1099 - accuracy20: 0.6423 - val_loss: 3.4390 - val_accuracy20: 0.5294 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 25s - loss: 2.0665 - accuracy20: 0.6495 - val_loss: 3.6474 - val_accuracy20: 0.5842 - 25s/epoch - 48ms/step
Epoch 15/50
529/529 - 25s - loss: 2.0334 - accuracy20: 0.6531 - val_loss: 3.7372 - val_accuracy20: 0.5460 - 25s/epoch - 48ms/step
Epoch 16/50
529/529 - 25s - loss: 2.0038 - accuracy20: 0.6565 - val_loss: 3.7203 - val_accuracy20: 0.6000 - 25s/epoch - 48ms/step
Epoch 17/50
529/529 - 26s - loss: 1.9684 - accuracy20: 0.6641 - val_loss: 3.6863 - val_accuracy20: 0.5376 - 26s/epoch - 48ms/step
Epoch 18/50
529/529 - 26s - loss: 1.9435 - accuracy20: 0.6651 - val_loss: 3.8064 - val_accuracy20: 0.5078 - 26s/epoch - 48ms/step
Epoch 19/50
529/529 - 25s - loss: 1.9025 - accuracy20: 0.6732 - val_loss: 3.8494 - val_accuracy20: 0.5549 - 25s/epoch - 48ms/step
Epoch 20/50
529/529 - 25s - loss: 1.8942 - accuracy20: 0.6716 - val_loss: 3.7710 - val_accuracy20: 0.5177 - 25s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h20
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7790026
{'0': {'precision': 0.318482173677203, 'recall': 0.23214478271809066, 'f1-score': 0.26854469854469853, 'support': 55642}, '1': {'precision': 0.8197459350802279, 'recall': 0.7661037297235708, 'f1-score': 0.7920175943895617, 'support': 359839}, '2': {'precision': 0.2765812764962759, 'recall': 0.4691453700032441, 'f1-score': 0.3480010427598377, 'support': 55486}, 'accuracy': 0.668034066081063, 'macro avg': {'precision': 0.47160312841790225, 'recall': 0.48913129414830187, 'f1-score': 0.46952111189803264, 'support': 470967}, 'weighted avg': {'precision': 0.6965327323331643, 'recall': 0.668034066081063, 'f1-score': 0.6778614406583519, 'support': 470967}}
[[ 12917  34153   8572]
 [ 24651 275674  59514]
 [  2990  26465  26031]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8392483
{'0': {'precision': 0.2119174041297935, 'recall': 0.5070581592320723, 'f1-score': 0.2989098776732962, 'support': 10626}, '1': {'precision': 0.9075075312101241, 'recall': 0.6057992904562858, 'f1-score': 0.7265775989636268, 'support': 113876}, '2': {'precision': 0.19865131482081333, 'recall': 0.6189558675107808, 'f1-score': 0.3007713228409648, 'support': 10899}, 'accuracy': 0.5991093123389044, 'macro avg': {'precision': 0.43935875005357694, 'recall': 0.5772711057330463, 'f1-score': 0.4420862664926293, 'support': 135401}, 'weighted avg': {'precision': 0.7958601682454289, 'recall': 0.5991093123389044, 'f1-score': 0.6587401397876094, 'support': 135401}}
[[ 5388  3924  1314]
 [18991 68986 25899]
 [ 1046  3107  6746]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9413651
{'0': {'precision': 0.2008717310087173, 'recall': 0.6038936727817297, 'f1-score': 0.30146715260256046, 'support': 5342}, '1': {'precision': 0.8745683324733061, 'recall': 0.5224432693903682, 'f1-score': 0.6541281952320162, 'support': 42173}, '2': {'precision': 0.24423028151153944, 'recall': 0.5189509610202981, 'f1-score': 0.33214532076339387, 'support': 5567}, 'accuracy': 0.530273915828341, 'macro avg': {'precision': 0.43989011499785424, 'recall': 0.548429301064132, 'f1-score': 0.4292468895326569, 'support': 53082}, 'weighted avg': {'precision': 0.7406626926193446, 'recall': 0.530273915828341, 'f1-score': 0.5848694266872482, 'support': 53082}}
[[ 3226  1590   526]
 [11726 22033  8414]
 [ 1108  1570  2889]]
training model: results/QRTEA/W10/deepLOB_L2/h30
Epoch 1/50
529/529 - 28s - loss: 2.9701 - accuracy30: 0.3948 - val_loss: 3.7158 - val_accuracy30: 0.6202 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 25s - loss: 2.6697 - accuracy30: 0.4574 - val_loss: 3.6224 - val_accuracy30: 0.5935 - 25s/epoch - 48ms/step
Epoch 3/50
529/529 - 25s - loss: 2.6024 - accuracy30: 0.4863 - val_loss: 3.7140 - val_accuracy30: 0.5966 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 2.5612 - accuracy30: 0.5028 - val_loss: 3.5589 - val_accuracy30: 0.5158 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 2.4923 - accuracy30: 0.5283 - val_loss: 3.5795 - val_accuracy30: 0.5122 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 2.4634 - accuracy30: 0.5396 - val_loss: 3.6839 - val_accuracy30: 0.6019 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 26s - loss: 2.4195 - accuracy30: 0.5553 - val_loss: 3.7043 - val_accuracy30: 0.6067 - 26s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.3807 - accuracy30: 0.5638 - val_loss: 3.5973 - val_accuracy30: 0.5267 - 26s/epoch - 49ms/step
Epoch 9/50
529/529 - 25s - loss: 2.3324 - accuracy30: 0.5795 - val_loss: 3.5984 - val_accuracy30: 0.5170 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.2980 - accuracy30: 0.5918 - val_loss: 3.5762 - val_accuracy30: 0.5186 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.2652 - accuracy30: 0.5980 - val_loss: 3.6062 - val_accuracy30: 0.4949 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.2376 - accuracy30: 0.6040 - val_loss: 4.0708 - val_accuracy30: 0.4544 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.2010 - accuracy30: 0.6106 - val_loss: 3.8742 - val_accuracy30: 0.5275 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 25s - loss: 2.1751 - accuracy30: 0.6117 - val_loss: 3.7907 - val_accuracy30: 0.5190 - 25s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h30
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7833758
{'0': {'precision': 0.38382256537256904, 'recall': 0.1565322005703422, 'f1-score': 0.2223746122845146, 'support': 67328}, '1': {'precision': 0.7449206874363377, 'recall': 0.8497576544637047, 'f1-score': 0.7938930873836005, 'support': 336503}, '2': {'precision': 0.33040504291845496, 'recall': 0.29355338417540516, 'f1-score': 0.31089096415951545, 'support': 67136}, 'accuracy': 0.6713697562674242, 'macro avg': {'precision': 0.4863827652424539, 'recall': 0.43328107973648405, 'f1-score': 0.44238622127587685, 'support': 470967}, 'weighted avg': {'precision': 0.6342103050259735, 'recall': 0.6713697562674242, 'f1-score': 0.6433389584610997, 'support': 470967}}
[[ 10539  53083   3706]
 [ 14323 285946  36234]
 [  2596  44832  19708]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.765151
{'0': {'precision': 0.2483561712593485, 'recall': 0.3808204417763411, 'f1-score': 0.30064406367723906, 'support': 12993}, '1': {'precision': 0.847348023231558, 'recall': 0.7076097918767764, 'f1-score': 0.7712000319755387, 'support': 109070}, '2': {'precision': 0.23763066202090594, 'recall': 0.43462288199130306, 'f1-score': 0.3072641984469827, 'support': 13338}, 'accuracy': 0.6493600490395196, 'macro avg': {'precision': 0.44444495217060415, 'recall': 0.5076843718814735, 'f1-score': 0.45970276469992016, 'support': 135401}, 'weighted avg': {'precision': 0.7298074489632542, 'recall': 0.6493600490395196, 'f1-score': 0.6803446480145363, 'support': 135401}}
[[ 4948  7193   852]
 [14145 77179 17746]
 [  830  6711  5797]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89718413
{'0': {'precision': 0.19913369234371342, 'recall': 0.5229823212913144, 'f1-score': 0.2884395268981305, 'support': 6505}, '1': {'precision': 0.806997129780467, 'recall': 0.5229872055903275, 'f1-score': 0.6346678868298635, 'support': 39783}, '2': {'precision': 0.312744714173845, 'recall': 0.47026788342655285, 'f1-score': 0.37566137566137564, 'support': 6794}, 'accuracy': 0.5162390264119664, 'macro avg': {'precision': 0.43962517876600843, 'recall': 0.5054124701027315, 'f1-score': 0.4329229297964565, 'support': 53082}, 'weighted avg': {'precision': 0.6692460546107772, 'recall': 0.5162390264119664, 'f1-score': 0.5590884866898042, 'support': 53082}}
[[ 3402  2666   437]
 [12393 20806  6584]
 [ 1289  2310  3195]]
training model: results/QRTEA/W10/deepLOB_L2/h50
Epoch 1/50
529/529 - 28s - loss: 3.0305 - accuracy50: 0.3843 - val_loss: 3.6419 - val_accuracy50: 0.5045 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 26s - loss: 2.7916 - accuracy50: 0.4314 - val_loss: 3.6283 - val_accuracy50: 0.5763 - 26s/epoch - 48ms/step
Epoch 3/50
529/529 - 25s - loss: 2.7131 - accuracy50: 0.4745 - val_loss: 3.6325 - val_accuracy50: 0.5099 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 2.6564 - accuracy50: 0.4963 - val_loss: 3.5753 - val_accuracy50: 0.4689 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 2.6043 - accuracy50: 0.5168 - val_loss: 3.7561 - val_accuracy50: 0.5053 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 2.5631 - accuracy50: 0.5224 - val_loss: 3.6248 - val_accuracy50: 0.4583 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 2.5343 - accuracy50: 0.5265 - val_loss: 3.6685 - val_accuracy50: 0.4753 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.4923 - accuracy50: 0.5414 - val_loss: 3.6661 - val_accuracy50: 0.4361 - 26s/epoch - 49ms/step
Epoch 9/50
529/529 - 25s - loss: 2.4566 - accuracy50: 0.5459 - val_loss: 3.7540 - val_accuracy50: 0.4239 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.4218 - accuracy50: 0.5557 - val_loss: 3.8644 - val_accuracy50: 0.4187 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.3950 - accuracy50: 0.5629 - val_loss: 3.8945 - val_accuracy50: 0.4243 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 26s - loss: 2.3683 - accuracy50: 0.5688 - val_loss: 3.9344 - val_accuracy50: 0.4329 - 26s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.3309 - accuracy50: 0.5749 - val_loss: 3.8994 - val_accuracy50: 0.4183 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 26s - loss: 2.2903 - accuracy50: 0.5802 - val_loss: 3.9458 - val_accuracy50: 0.4264 - 26s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h50
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8866059
{'0': {'precision': 0.42502493232654226, 'recall': 0.1386945303238104, 'f1-score': 0.20914173545752493, 'support': 86038}, '1': {'precision': 0.6737619819275454, 'recall': 0.822668920278482, 'f1-score': 0.7408067307082525, 'support': 298188}, '2': {'precision': 0.37084554764533445, 'recall': 0.3368995054241939, 'f1-score': 0.35305843834193135, 'support': 86741}, 'accuracy': 0.60825068423053, 'macro avg': {'precision': 0.48987748729980735, 'recall': 0.4327543186754954, 'f1-score': 0.43433563483590293, 'support': 470967}, 'weighted avg': {'precision': 0.5725317201477512, 'recall': 0.60825068423053, 'f1-score': 0.5722661164199284, 'support': 470967}}
[[ 11933  64287   9818]
 [ 13118 245310  39760]
 [  3025  54493  29223]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.818155
{'0': {'precision': 0.2904641720618896, 'recall': 0.30682740234148603, 'f1-score': 0.29842164599774523, 'support': 17254}, '1': {'precision': 0.7851648885101241, 'recall': 0.7245721794705876, 'f1-score': 0.7536526016049703, 'support': 100451}, '2': {'precision': 0.3002533093642752, 'recall': 0.4152915913200723, 'f1-score': 0.34852508773593854, 'support': 17696}, 'accuracy': 0.6309185308823421, 'macro avg': {'precision': 0.45862745664542964, 'recall': 0.48223039104404863, 'f1-score': 0.4668664451128846, 'support': 135401}, 'weighted avg': {'precision': 0.658751040265556, 'recall': 0.6309185308823421, 'f1-score': 0.6426955821333752, 'support': 135401}}
[[ 5294 10672  1288]
 [11828 72784 15839]
 [ 1104  9243  7349]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9837929
{'0': {'precision': 0.25076412824348054, 'recall': 0.4510469060708855, 'f1-score': 0.32232717545766115, 'support': 8549}, '1': {'precision': 0.7204786534584028, 'recall': 0.46044596335929183, 'f1-score': 0.5618334700574242, 'support': 35698}, '2': {'precision': 0.3126720838090122, 'recall': 0.5269949066213921, 'f1-score': 0.3924808227261232, 'support': 8835}, 'accuracy': 0.47000866583776046, 'macro avg': {'precision': 0.4279716218369652, 'recall': 0.47949592535052316, 'f1-score': 0.4255471560804029, 'support': 53082}, 'weighted avg': {'precision': 0.5769542851430653, 'recall': 0.47000866583776046, 'f1-score': 0.49507317557520014, 'support': 53082}}
[[ 3856  3555  1138]
 [10164 16437  9097]
 [ 1357  2822  4656]]
training model: results/QRTEA/W10/deepLOB_L2/h100
Epoch 1/50
529/529 - 28s - loss: 3.1561 - accuracy100: 0.4020 - val_loss: 3.7405 - val_accuracy100: 0.4904 - 28s/epoch - 52ms/step
Epoch 2/50
529/529 - 25s - loss: 3.0176 - accuracy100: 0.4211 - val_loss: 3.5455 - val_accuracy100: 0.4408 - 25s/epoch - 48ms/step
Epoch 3/50
529/529 - 25s - loss: 2.9609 - accuracy100: 0.4467 - val_loss: 3.5676 - val_accuracy100: 0.4489 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 2.9211 - accuracy100: 0.4680 - val_loss: 3.5505 - val_accuracy100: 0.4622 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 26s - loss: 2.8672 - accuracy100: 0.4913 - val_loss: 3.4761 - val_accuracy100: 0.4565 - 26s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 2.8301 - accuracy100: 0.5049 - val_loss: 3.5382 - val_accuracy100: 0.4642 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 2.7922 - accuracy100: 0.5140 - val_loss: 3.5198 - val_accuracy100: 0.4365 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 25s - loss: 2.7591 - accuracy100: 0.5229 - val_loss: 3.5295 - val_accuracy100: 0.4281 - 25s/epoch - 48ms/step
Epoch 9/50
529/529 - 25s - loss: 2.7238 - accuracy100: 0.5330 - val_loss: 3.5697 - val_accuracy100: 0.4192 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.6824 - accuracy100: 0.5409 - val_loss: 3.6356 - val_accuracy100: 0.4194 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.6514 - accuracy100: 0.5482 - val_loss: 3.6118 - val_accuracy100: 0.4172 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.6185 - accuracy100: 0.5579 - val_loss: 3.6604 - val_accuracy100: 0.4152 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.5882 - accuracy100: 0.5625 - val_loss: 3.7801 - val_accuracy100: 0.4021 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 26s - loss: 2.5533 - accuracy100: 0.5670 - val_loss: 3.7635 - val_accuracy100: 0.4159 - 26s/epoch - 48ms/step
Epoch 15/50
529/529 - 26s - loss: 2.5197 - accuracy100: 0.5736 - val_loss: 3.8297 - val_accuracy100: 0.4013 - 26s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h100
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.045545
{'0': {'precision': 0.491961970613656, 'recall': 0.11847966362765913, 'f1-score': 0.19096826142387438, 'support': 120105}, '1': {'precision': 0.5201622105116819, 'recall': 0.8658687811651282, 'f1-score': 0.6499020901098721, 'support': 229022}, '2': {'precision': 0.4387015080004605, 'recall': 0.2189510833880499, 'f1-score': 0.2921121933325668, 'support': 121840}, 'accuracy': 0.5079124439716584, 'macro avg': {'precision': 0.4836085630419327, 'recall': 0.4010998427269457, 'f1-score': 0.3776608482887711, 'support': 470967}, 'weighted avg': {'precision': 0.49189661694160236, 'recall': 0.5079124439716584, 'f1-score': 0.4403048815630341, 'support': 470967}}
[[ 14230  92534  13341]
 [  9928 198303  20791]
 [  4767  90396  26677]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.92094886
{'0': {'precision': 0.3931082981715893, 'recall': 0.23617299124289445, 'f1-score': 0.29507174048658763, 'support': 26036}, '1': {'precision': 0.650961000186602, 'recall': 0.7552500541242694, 'f1-score': 0.6992383243134898, 'support': 83142}, '2': {'precision': 0.36330858050392756, 'recall': 0.32277008732791823, 'f1-score': 0.3418416801292407, 'support': 26223}, 'accuracy': 0.571679677402678, 'macro avg': {'precision': 0.4691259596207063, 'recall': 0.4380643775650273, 'f1-score': 0.44538391497643937, 'support': 135401}, 'weighted avg': {'precision': 0.5456695891113393, 'recall': 0.571679677402678, 'f1-score': 0.5523051895732678, 'support': 135401}}
[[ 6149 17331  2556]
 [ 8072 62793 12277]
 [ 1421 16338  8464]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0234668
{'0': {'precision': 0.34924034535840975, 'recall': 0.4222366078653504, 'f1-score': 0.3822850653870105, 'support': 12358}, '1': {'precision': 0.6005650277557494, 'recall': 0.43190162181429337, 'f1-score': 0.5024569260434161, 'support': 28055}, '2': {'precision': 0.373114389089897, 'recall': 0.5290867471781514, 'f1-score': 0.4376183325716524, 'support': 12669}, 'accuracy': 0.45284653931652913, 'macro avg': {'precision': 0.4409732540680187, 'recall': 0.4610749922859318, 'f1-score': 0.4407867746673597, 'support': 53082}, 'weighted avg': {'precision': 0.4877689280171561, 'recall': 0.45284653931652913, 'f1-score': 0.4590048331553253, 'support': 53082}}
[[ 5218  4129  3011]
 [ 7687 12117  8251]
 [ 2036  3930  6703]]
training model: results/QRTEA/W10/deepLOB_L2/h200
Epoch 1/50
529/529 - 27s - loss: 3.2546 - accuracy200: 0.4037 - val_loss: 3.6292 - val_accuracy200: 0.3476 - 27s/epoch - 52ms/step
Epoch 2/50
529/529 - 26s - loss: 3.2029 - accuracy200: 0.4127 - val_loss: 3.6596 - val_accuracy200: 0.4109 - 26s/epoch - 49ms/step
Epoch 3/50
529/529 - 25s - loss: 3.1616 - accuracy200: 0.4218 - val_loss: 3.5136 - val_accuracy200: 0.4054 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 26s - loss: 3.1175 - accuracy200: 0.4459 - val_loss: 3.5113 - val_accuracy200: 0.3870 - 26s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 3.0618 - accuracy200: 0.4699 - val_loss: 3.5278 - val_accuracy200: 0.4123 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 3.0278 - accuracy200: 0.4811 - val_loss: 3.5261 - val_accuracy200: 0.4068 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 2.9824 - accuracy200: 0.4950 - val_loss: 3.5812 - val_accuracy200: 0.3831 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.9416 - accuracy200: 0.5047 - val_loss: 3.6274 - val_accuracy200: 0.3905 - 26s/epoch - 49ms/step
Epoch 9/50
529/529 - 26s - loss: 2.9062 - accuracy200: 0.5143 - val_loss: 3.6857 - val_accuracy200: 0.3674 - 26s/epoch - 49ms/step
Epoch 10/50
529/529 - 25s - loss: 2.8717 - accuracy200: 0.5214 - val_loss: 3.7471 - val_accuracy200: 0.3590 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.8263 - accuracy200: 0.5316 - val_loss: 3.7537 - val_accuracy200: 0.3564 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.7964 - accuracy200: 0.5367 - val_loss: 3.8105 - val_accuracy200: 0.3611 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 26s - loss: 2.7436 - accuracy200: 0.5469 - val_loss: 3.9815 - val_accuracy200: 0.3642 - 26s/epoch - 48ms/step
Epoch 14/50
529/529 - 26s - loss: 2.7083 - accuracy200: 0.5542 - val_loss: 4.0651 - val_accuracy200: 0.3611 - 26s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h200
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233312
{'0': {'precision': 0.49329315504216625, 'recall': 0.15345107050560153, 'f1-score': 0.23408438676106968, 'support': 153619}, '1': {'precision': 0.3602109070778029, 'recall': 0.8456486353484498, 'f1-score': 0.5052194742267848, 'support': 158502}, '2': {'precision': 0.4673898145791318, 'recall': 0.1502776273875326, 'f1-score': 0.2274305803667129, 'support': 158846}, 'accuracy': 0.38533697690071705, 'macro avg': {'precision': 0.4402979588997003, 'recall': 0.38312577774719464, 'f1-score': 0.3222448137848558, 'support': 470967}, 'weighted avg': {'precision': 0.43976829133401113, 'recall': 0.38533697690071705, 'f1-score': 0.32308961027561056, 'support': 470967}}
[[ 23573 114995  15051]
 [ 12314 134037  12151]
 [ 11900 123075  23871]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0340209
{'0': {'precision': 0.426088153006467, 'recall': 0.26050137401155293, 'f1-score': 0.32332724266945095, 'support': 35662}, '1': {'precision': 0.5075271988836829, 'recall': 0.6999890472688582, 'f1-score': 0.5884202080784964, 'support': 63911}, '2': {'precision': 0.3923225020627873, 'recall': 0.27869264262587923, 'f1-score': 0.32588651903588506, 'support': 35828}, 'accuracy': 0.47275869454435343, 'macro avg': {'precision': 0.44197928465097913, 'recall': 0.4130610213020968, 'f1-score': 0.41254465659461076, 'support': 135401}, 'weighted avg': {'precision': 0.4555938074628491, 'recall': 0.47275869454435343, 'f1-score': 0.44913170693422083, 'support': 135401}}
[[ 9290 21145  5227]
 [ 8935 44737 10239]
 [ 3578 22265  9985]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955061
{'0': {'precision': 0.35026129726406396, 'recall': 0.3598408287013643, 'f1-score': 0.3549864473315263, 'support': 15832}, '1': {'precision': 0.393572239100992, 'recall': 0.5030646142329107, 'f1-score': 0.44163312248418635, 'support': 21373}, '2': {'precision': 0.4339861023373342, 'recall': 0.2596208351703722, 'f1-score': 0.32488669950738913, 'support': 15877}, 'accuracy': 0.3875324968916017, 'macro avg': {'precision': 0.39260654623413, 'recall': 0.3741754260348824, 'f1-score': 0.37383542310770057, 'support': 53082}, 'weighted avg': {'precision': 0.39274243004031534, 'recall': 0.3875324968916017, 'f1-score': 0.38087103517361925, 'support': 53082}}
[[ 5697  8113  2022]
 [ 7267 10752  3354]
 [ 3301  8454  4122]]
training model: results/QRTEA/W10/deepLOB_L2/h300
Epoch 1/50
529/529 - 28s - loss: 3.2701 - accuracy300: 0.4018 - val_loss: 3.5377 - val_accuracy300: 0.3366 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 26s - loss: 3.2249 - accuracy300: 0.4167 - val_loss: 3.6182 - val_accuracy300: 0.3351 - 26s/epoch - 49ms/step
Epoch 3/50
529/529 - 25s - loss: 3.1885 - accuracy300: 0.4293 - val_loss: 3.4052 - val_accuracy300: 0.3677 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 25s - loss: 3.1528 - accuracy300: 0.4406 - val_loss: 3.4540 - val_accuracy300: 0.3551 - 25s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 3.1029 - accuracy300: 0.4628 - val_loss: 3.5197 - val_accuracy300: 0.3536 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 3.0651 - accuracy300: 0.4759 - val_loss: 3.5535 - val_accuracy300: 0.3624 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 3.0325 - accuracy300: 0.4868 - val_loss: 3.5419 - val_accuracy300: 0.3655 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 2.9958 - accuracy300: 0.4988 - val_loss: 3.5302 - val_accuracy300: 0.3729 - 26s/epoch - 48ms/step
Epoch 9/50
529/529 - 25s - loss: 2.9531 - accuracy300: 0.5109 - val_loss: 3.6271 - val_accuracy300: 0.3642 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 25s - loss: 2.8967 - accuracy300: 0.5234 - val_loss: 3.7666 - val_accuracy300: 0.3587 - 25s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.8592 - accuracy300: 0.5330 - val_loss: 3.7545 - val_accuracy300: 0.3657 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.8282 - accuracy300: 0.5407 - val_loss: 3.8096 - val_accuracy300: 0.3646 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.7795 - accuracy300: 0.5501 - val_loss: 4.0556 - val_accuracy300: 0.3465 - 25s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h300
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1342027
{'0': {'precision': 0.38648810630954594, 'recall': 0.11101678816517464, 'f1-score': 0.1724874215431726, 'support': 168452}, '1': {'precision': 0.24535876953746902, 'recall': 0.42725928545024994, 'f1-score': 0.3117127522050999, 'support': 124442}, '2': {'precision': 0.392794866937697, 'recall': 0.4541339787615192, 'f1-score': 0.4212431697547102, 'support': 178073}, 'accuracy': 0.324309346514724, 'macro avg': {'precision': 0.34154724759490396, 'recall': 0.3308033507923146, 'f1-score': 0.3018144478343276, 'support': 470967}, 'weighted avg': {'precision': 0.35158257547351274, 'recall': 0.324309346514724, 'f1-score': 0.30332920228259735, 'support': 470967}}
[[18701 82991 66760]
 [13021 53169 58252]
 [16665 80539 80869]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1174389
{'0': {'precision': 0.3682584397292017, 'recall': 0.20110664483152202, 'f1-score': 0.2601466835711191, 'support': 40302}, '1': {'precision': 0.4028955067136749, 'recall': 0.29679498986922087, 'f1-score': 0.3418007488094354, 'support': 54290}, '2': {'precision': 0.3116936198040845, 'recall': 0.5606116297875469, 'f1-score': 0.4006374334547492, 'support': 40809}, 'accuracy': 0.34782608695652173, 'macro avg': {'precision': 0.360949188748987, 'recall': 0.3528377548294299, 'f1-score': 0.3341949552784345, 'support': 135401}, 'weighted avg': {'precision': 0.3650981427614019, 'recall': 0.34782608695652173, 'f1-score': 0.33522948365227995, 'support': 135401}}
[[ 8105 11584 20613]
 [ 8269 16113 29908]
 [ 5635 12296 22878]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103302
{'0': {'precision': 0.3774716253836819, 'recall': 0.3011046577838515, 'f1-score': 0.33499097272813655, 'support': 17562}, '1': {'precision': 0.34492635024549917, 'recall': 0.525114672405006, 'f1-score': 0.4163617178905777, 'support': 17659}, '2': {'precision': 0.40446304044630405, 'recall': 0.27602037959800685, 'f1-score': 0.32811980033277877, 'support': 17861}, 'accuracy': 0.36718661693229343, 'macro avg': {'precision': 0.37562033869182837, 'recall': 0.3674132365956215, 'f1-score': 0.3598241636504977, 'support': 53082}, 'weighted avg': {'precision': 0.37572671469396274, 'recall': 0.36718661693229343, 'f1-score': 0.35974889403234633, 'support': 53082}}
[[5288 8875 3399]
 [4526 9273 3860]
 [4195 8736 4930]]
training model: results/QRTEA/W10/deepLOB_L2/h500
Epoch 1/50
529/529 - 28s - loss: 3.2844 - accuracy500: 0.3927 - val_loss: 3.5892 - val_accuracy500: 0.3121 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 25s - loss: 3.2600 - accuracy500: 0.3978 - val_loss: 3.5316 - val_accuracy500: 0.3178 - 25s/epoch - 48ms/step
Epoch 3/50
529/529 - 25s - loss: 3.2403 - accuracy500: 0.4092 - val_loss: 3.5320 - val_accuracy500: 0.3184 - 25s/epoch - 48ms/step
Epoch 4/50
529/529 - 26s - loss: 3.2411 - accuracy500: 0.4091 - val_loss: 3.4244 - val_accuracy500: 0.3022 - 26s/epoch - 48ms/step
Epoch 5/50
529/529 - 25s - loss: 3.2123 - accuracy500: 0.4233 - val_loss: 3.4426 - val_accuracy500: 0.2972 - 25s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 3.1935 - accuracy500: 0.4303 - val_loss: 3.5169 - val_accuracy500: 0.2811 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 3.1454 - accuracy500: 0.4524 - val_loss: 3.5435 - val_accuracy500: 0.2930 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 26s - loss: 3.1037 - accuracy500: 0.4662 - val_loss: 3.6066 - val_accuracy500: 0.3105 - 26s/epoch - 48ms/step
Epoch 9/50
529/529 - 25s - loss: 3.0584 - accuracy500: 0.4821 - val_loss: 3.5916 - val_accuracy500: 0.3405 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 26s - loss: 3.0305 - accuracy500: 0.4913 - val_loss: 3.7840 - val_accuracy500: 0.3231 - 26s/epoch - 49ms/step
Epoch 11/50
529/529 - 25s - loss: 2.9705 - accuracy500: 0.5116 - val_loss: 3.8231 - val_accuracy500: 0.3367 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.9330 - accuracy500: 0.5225 - val_loss: 4.0484 - val_accuracy500: 0.3425 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.8813 - accuracy500: 0.5365 - val_loss: 3.9200 - val_accuracy500: 0.3521 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 25s - loss: 2.8260 - accuracy500: 0.5507 - val_loss: 3.9973 - val_accuracy500: 0.3532 - 25s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h500
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1829566
{'0': {'precision': 0.429065463047149, 'recall': 0.14872865616874711, 'f1-score': 0.22088950927373183, 'support': 177686}, '1': {'precision': 0.21818670751980182, 'recall': 0.8059984547306315, 'f1-score': 0.343410851056098, 'support': 99659}, '2': {'precision': 0.46549591287263203, 'recall': 0.09911580295627563, 'f1-score': 0.1634326737605866, 'support': 193622}, 'accuracy': 0.2674136404461459, 'macro avg': {'precision': 0.37091602781319427, 'recall': 0.35128097128521807, 'f1-score': 0.24257767803013877, 'support': 470967}, 'weighted avg': {'precision': 0.39941958692209095, 'recall': 0.2674136404461459, 'f1-score': 0.2231942291266358, 'support': 470967}}
[[ 26427 136410  14849]
 [ 12147  80325   7187]
 [ 23018 151413  19191]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1192448
{'0': {'precision': 0.3896766596339728, 'recall': 0.17864051464303388, 'f1-score': 0.24497601752031958, 'support': 44458}, '1': {'precision': 0.3371553290669195, 'recall': 0.762746324679387, 'f1-score': 0.46761269467311356, 'support': 44758}, '2': {'precision': 0.4017727404824179, 'recall': 0.11973584497131103, 'f1-score': 0.18449014996080002, 'support': 46185}, 'accuracy': 0.3516296039172532, 'macro avg': {'precision': 0.3762015763944367, 'recall': 0.35370756143124393, 'f1-score': 0.2990262873847444, 'support': 135401}, 'weighted avg': {'precision': 0.37644121662000146, 'recall': 0.3516296039172532, 'f1-score': 0.29793893952804734, 'support': 135401}}
[[ 7942 32408  4108]
 [ 6493 34139  4126]
 [ 5946 34709  5530]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145134
{'0': {'precision': 0.3756333122229259, 'recall': 0.2480916030534351, 'f1-score': 0.2988223439763209, 'support': 19126}, '1': {'precision': 0.2686906129268038, 'recall': 0.7063546527587153, 'f1-score': 0.38929652042360063, 'support': 14572}, '2': {'precision': 0.46591970121381887, 'recall': 0.051485761452744534, 'f1-score': 0.09272507665149123, 'support': 19384}, 'accuracy': 0.30209863984024715, 'macro avg': {'precision': 0.37008120878784956, 'recall': 0.3353106724216317, 'f1-score': 0.26028131368380425, 'support': 53082}, 'weighted avg': {'precision': 0.3792455037390025, 'recall': 0.30209863984024715, 'f1-score': 0.2483984765516809, 'support': 53082}}
[[ 4745 13794   587]
 [ 3722 10293   557]
 [ 4165 14221   998]]
training model: results/QRTEA/W10/deepLOB_L2/h1000
Epoch 1/50
529/529 - 28s - loss: 3.2558 - accuracy1000: 0.4064 - val_loss: 3.4711 - val_accuracy1000: 0.3500 - 28s/epoch - 53ms/step
Epoch 2/50
529/529 - 26s - loss: 3.2678 - accuracy1000: 0.3914 - val_loss: 3.3773 - val_accuracy1000: 0.3420 - 26s/epoch - 49ms/step
Epoch 3/50
529/529 - 26s - loss: 3.2207 - accuracy1000: 0.4185 - val_loss: 3.4659 - val_accuracy1000: 0.3266 - 26s/epoch - 49ms/step
Epoch 4/50
529/529 - 26s - loss: 3.2108 - accuracy1000: 0.4188 - val_loss: 3.3171 - val_accuracy1000: 0.3553 - 26s/epoch - 48ms/step
Epoch 5/50
529/529 - 26s - loss: 3.2122 - accuracy1000: 0.4222 - val_loss: 3.3695 - val_accuracy1000: 0.3514 - 26s/epoch - 48ms/step
Epoch 6/50
529/529 - 25s - loss: 3.1879 - accuracy1000: 0.4290 - val_loss: 3.3677 - val_accuracy1000: 0.3468 - 25s/epoch - 48ms/step
Epoch 7/50
529/529 - 25s - loss: 3.1659 - accuracy1000: 0.4400 - val_loss: 3.5407 - val_accuracy1000: 0.3301 - 25s/epoch - 48ms/step
Epoch 8/50
529/529 - 25s - loss: 3.1163 - accuracy1000: 0.4648 - val_loss: 3.4177 - val_accuracy1000: 0.3325 - 25s/epoch - 48ms/step
Epoch 9/50
529/529 - 25s - loss: 3.0369 - accuracy1000: 0.4893 - val_loss: 3.6372 - val_accuracy1000: 0.3081 - 25s/epoch - 48ms/step
Epoch 10/50
529/529 - 26s - loss: 2.9988 - accuracy1000: 0.4990 - val_loss: 3.5564 - val_accuracy1000: 0.3378 - 26s/epoch - 48ms/step
Epoch 11/50
529/529 - 25s - loss: 2.9321 - accuracy1000: 0.5183 - val_loss: 3.7077 - val_accuracy1000: 0.3216 - 25s/epoch - 48ms/step
Epoch 12/50
529/529 - 25s - loss: 2.8816 - accuracy1000: 0.5340 - val_loss: 3.6951 - val_accuracy1000: 0.3446 - 25s/epoch - 48ms/step
Epoch 13/50
529/529 - 25s - loss: 2.8339 - accuracy1000: 0.5465 - val_loss: 3.8505 - val_accuracy1000: 0.3372 - 25s/epoch - 48ms/step
Epoch 14/50
529/529 - 26s - loss: 2.7668 - accuracy1000: 0.5618 - val_loss: 3.9578 - val_accuracy1000: 0.3169 - 26s/epoch - 48ms/step
testing model: results/QRTEA/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
1840/1840 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984743
{'0': {'precision': 0.3344175496710767, 'recall': 0.3136428005514763, 'f1-score': 0.32369718899290484, 'support': 160297}, '1': {'precision': 0.2969038439069985, 'recall': 0.09504929756579243, 'f1-score': 0.143999365342007, 'support': 133678}, '2': {'precision': 0.39268193483135555, 'recall': 0.6164120412222022, 'f1-score': 0.47974495685153634, 'support': 176992}, 'accuracy': 0.3653801646399854, 'macro avg': {'precision': 0.34133444280314357, 'recall': 0.3417013797798236, 'f1-score': 0.31581383706214944, 'support': 470967}, 'weighted avg': {'precision': 0.34566583861522276, 'recall': 0.3653801646399854, 'f1-score': 0.3313358576444881, 'support': 470967}}
[[ 50276  14449  95572]
 [ 47811  12706  73161]
 [ 52252  15640 109100]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045625
{'0': {'precision': 0.33563917546265926, 'recall': 0.3768552616895436, 'f1-score': 0.3550550929430566, 'support': 44805}, '1': {'precision': 0.4110889634913974, 'recall': 0.17503852768409534, 'f1-score': 0.2455315882638595, 'support': 44773}, '2': {'precision': 0.3520823867938816, 'recall': 0.5073434738013661, 'f1-score': 0.4156884482311606, 'support': 45823}, 'accuracy': 0.35428098758502524, 'macro avg': {'precision': 0.36627017524931277, 'recall': 0.35307908772500163, 'f1-score': 0.33875837647935886, 'support': 135401}, 'weighted avg': {'precision': 0.36615291341320094, 'recall': 0.35428098758502524, 'f1-score': 0.339358800924276, 'support': 135401}}
[[16885  5592 22328]
 [16482  7837 20454]
 [16940  5635 23248]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060767
{'0': {'precision': 0.3346516725436005, 'recall': 0.4064471323571966, 'f1-score': 0.3670717365738925, 'support': 17279}, '1': {'precision': 0.3751450574955164, 'recall': 0.20278284671532848, 'f1-score': 0.2632611512122895, 'support': 17536}, '2': {'precision': 0.36516779413715345, 'recall': 0.4521267860075546, 'f1-score': 0.4040211329615498, 'support': 18267}, 'accuracy': 0.35488489506800797, 'macro avg': {'precision': 0.3583215080587568, 'recall': 0.35378558836002655, 'f1-score': 0.34478467358257725, 'support': 53082}, 'weighted avg': {'precision': 0.3585303883355117, 'recall': 0.35488489506800797, 'f1-score': 0.3454925232607594, 'support': 53082}}
[[7023 2695 7561]
 [7183 3556 6797]
 [6780 3228 8259]]
training model: results/QRTEA/W10/deepOF_L2/h10
Epoch 1/50
529/529 - 18s - loss: 2.7593 - accuracy10: 0.5611 - val_loss: 3.2162 - val_accuracy10: 0.7360 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 16s - loss: 2.4055 - accuracy10: 0.6432 - val_loss: 3.0024 - val_accuracy10: 0.7542 - 16s/epoch - 29ms/step
Epoch 3/50
529/529 - 16s - loss: 2.2497 - accuracy10: 0.6706 - val_loss: 2.8794 - val_accuracy10: 0.7432 - 16s/epoch - 30ms/step
Epoch 4/50
529/529 - 16s - loss: 2.1465 - accuracy10: 0.6782 - val_loss: 2.9055 - val_accuracy10: 0.7725 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 2.0824 - accuracy10: 0.6856 - val_loss: 2.8235 - val_accuracy10: 0.7549 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 16s - loss: 2.0296 - accuracy10: 0.6945 - val_loss: 2.8395 - val_accuracy10: 0.7693 - 16s/epoch - 30ms/step
Epoch 7/50
529/529 - 16s - loss: 1.9752 - accuracy10: 0.7002 - val_loss: 2.7810 - val_accuracy10: 0.7213 - 16s/epoch - 30ms/step
Epoch 8/50
529/529 - 16s - loss: 1.9391 - accuracy10: 0.7042 - val_loss: 2.7350 - val_accuracy10: 0.7372 - 16s/epoch - 30ms/step
Epoch 9/50
529/529 - 16s - loss: 1.9031 - accuracy10: 0.7045 - val_loss: 3.0263 - val_accuracy10: 0.6917 - 16s/epoch - 30ms/step
Epoch 10/50
529/529 - 16s - loss: 1.8840 - accuracy10: 0.7056 - val_loss: 2.7868 - val_accuracy10: 0.7233 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 1.8637 - accuracy10: 0.7050 - val_loss: 2.7488 - val_accuracy10: 0.7030 - 16s/epoch - 30ms/step
Epoch 12/50
529/529 - 16s - loss: 1.8436 - accuracy10: 0.7083 - val_loss: 2.8066 - val_accuracy10: 0.7363 - 16s/epoch - 30ms/step
Epoch 13/50
529/529 - 16s - loss: 1.8211 - accuracy10: 0.7116 - val_loss: 2.8001 - val_accuracy10: 0.7147 - 16s/epoch - 30ms/step
Epoch 14/50
529/529 - 16s - loss: 1.7919 - accuracy10: 0.7111 - val_loss: 2.8813 - val_accuracy10: 0.7216 - 16s/epoch - 30ms/step
Epoch 15/50
529/529 - 16s - loss: 1.7777 - accuracy10: 0.7152 - val_loss: 2.9647 - val_accuracy10: 0.7170 - 16s/epoch - 30ms/step
Epoch 16/50
529/529 - 16s - loss: 1.7565 - accuracy10: 0.7101 - val_loss: 2.8827 - val_accuracy10: 0.7218 - 16s/epoch - 30ms/step
Epoch 17/50
529/529 - 16s - loss: 1.7400 - accuracy10: 0.7142 - val_loss: 2.8629 - val_accuracy10: 0.6943 - 16s/epoch - 29ms/step
Epoch 18/50
529/529 - 16s - loss: 1.7209 - accuracy10: 0.7152 - val_loss: 2.8195 - val_accuracy10: 0.7021 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h10
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.695416
{'0': {'precision': 0.31316492092832204, 'recall': 0.5676420221874767, 'f1-score': 0.40364252435408726, 'support': 40293}, '1': {'precision': 0.9244170563279968, 'recall': 0.7648291623111767, 'f1-score': 0.8370847482341197, 'support': 390312}, '2': {'precision': 0.2908116324652986, 'recall': 0.5404266917759001, 'f1-score': 0.37814033323508506, 'support': 40357}, 'accuracy': 0.7287297064306675, 'macro avg': {'precision': 0.5094645365738725, 'recall': 0.6242992920915178, 'f1-score': 0.5396225352744307, 'support': 470962}, 'weighted avg': {'precision': 0.8178275727125756, 'recall': 0.7287297064306675, 'f1-score': 0.7606745340705264, 'support': 470962}}
[[ 22872  13122   4299]
 [ 42902 298522  48888]
 [  7261  11286  21810]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53072035
{'0': {'precision': 0.32767076551282964, 'recall': 0.5963006079420515, 'f1-score': 0.4229357798165138, 'support': 7731}, '1': {'precision': 0.959718583212033, 'recall': 0.8253895393962661, 'f1-score': 0.8874999439137438, 'support': 119821}, '2': {'precision': 0.2731400437636761, 'recall': 0.6362941251433669, 'f1-score': 0.3822099743560301, 'support': 7847}, 'accuracy': 0.8013500838263208, 'macro avg': {'precision': 0.5201764641628462, 'recall': 0.6859947574938948, 'f1-score': 0.5642152326954292, 'support': 135399}, 'weighted avg': {'precision': 0.8838395628523271, 'recall': 0.8013500838263208, 'f1-score': 0.8316904036382982, 'support': 135399}}
[[ 4610  2309   812]
 [ 8447 98899 12475]
 [ 1012  1842  4993]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64077586
{'0': {'precision': 0.30188182655612583, 'recall': 0.5924586776859504, 'f1-score': 0.39996512945689133, 'support': 3872}, '1': {'precision': 0.9412992720780112, 'recall': 0.7578565583740628, 'f1-score': 0.839675577662885, 'support': 45217}, '2': {'precision': 0.26911213923771754, 'recall': 0.6118206862008515, 'f1-score': 0.3738046056154846, 'support': 3993}, 'accuracy': 0.7348065257526092, 'macro avg': {'precision': 0.504097745957285, 'recall': 0.6540453074202882, 'f1-score': 0.537815104245087, 'support': 53082}, 'weighted avg': {'precision': 0.844093673749161, 'recall': 0.7348065257526092, 'f1-score': 0.7725571260815792, 'support': 53082}}
[[ 2294  1135   443]
 [ 4757 34268  6192]
 [  548  1002  2443]]
training model: results/QRTEA/W10/deepOF_L2/h20
Epoch 1/50
529/529 - 18s - loss: 2.7773 - accuracy20: 0.5098 - val_loss: 3.1936 - val_accuracy20: 0.6641 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 16s - loss: 2.4333 - accuracy20: 0.6034 - val_loss: 3.0580 - val_accuracy20: 0.7245 - 16s/epoch - 29ms/step
Epoch 3/50
529/529 - 16s - loss: 2.2969 - accuracy20: 0.6246 - val_loss: 3.0368 - val_accuracy20: 0.7527 - 16s/epoch - 30ms/step
Epoch 4/50
529/529 - 16s - loss: 2.2104 - accuracy20: 0.6348 - val_loss: 3.0055 - val_accuracy20: 0.7624 - 16s/epoch - 30ms/step
Epoch 5/50
529/529 - 16s - loss: 2.1552 - accuracy20: 0.6460 - val_loss: 2.9427 - val_accuracy20: 0.7602 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 15s - loss: 2.1010 - accuracy20: 0.6532 - val_loss: 2.9695 - val_accuracy20: 0.7713 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 16s - loss: 2.0565 - accuracy20: 0.6601 - val_loss: 2.9297 - val_accuracy20: 0.7562 - 16s/epoch - 30ms/step
Epoch 8/50
529/529 - 16s - loss: 2.0194 - accuracy20: 0.6658 - val_loss: 2.8950 - val_accuracy20: 0.7454 - 16s/epoch - 30ms/step
Epoch 9/50
529/529 - 15s - loss: 1.9779 - accuracy20: 0.6690 - val_loss: 2.9451 - val_accuracy20: 0.7563 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 16s - loss: 1.9491 - accuracy20: 0.6708 - val_loss: 2.8775 - val_accuracy20: 0.7344 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 1.9253 - accuracy20: 0.6749 - val_loss: 2.9237 - val_accuracy20: 0.7318 - 16s/epoch - 29ms/step
Epoch 12/50
529/529 - 16s - loss: 1.8918 - accuracy20: 0.6776 - val_loss: 2.8691 - val_accuracy20: 0.7257 - 16s/epoch - 30ms/step
Epoch 13/50
529/529 - 16s - loss: 1.8784 - accuracy20: 0.6787 - val_loss: 3.0673 - val_accuracy20: 0.7259 - 16s/epoch - 30ms/step
Epoch 14/50
529/529 - 16s - loss: 1.8500 - accuracy20: 0.6770 - val_loss: 3.0041 - val_accuracy20: 0.6902 - 16s/epoch - 30ms/step
Epoch 15/50
529/529 - 16s - loss: 1.8248 - accuracy20: 0.6789 - val_loss: 2.8580 - val_accuracy20: 0.7121 - 16s/epoch - 30ms/step
Epoch 16/50
529/529 - 16s - loss: 1.8025 - accuracy20: 0.6801 - val_loss: 2.9130 - val_accuracy20: 0.6840 - 16s/epoch - 30ms/step
Epoch 17/50
529/529 - 16s - loss: 1.7715 - accuracy20: 0.6817 - val_loss: 3.3678 - val_accuracy20: 0.6429 - 16s/epoch - 29ms/step
Epoch 18/50
529/529 - 16s - loss: 1.7552 - accuracy20: 0.6816 - val_loss: 3.2825 - val_accuracy20: 0.6174 - 16s/epoch - 30ms/step
Epoch 19/50
529/529 - 16s - loss: 1.7238 - accuracy20: 0.6841 - val_loss: 3.0711 - val_accuracy20: 0.6367 - 16s/epoch - 29ms/step
Epoch 20/50
529/529 - 16s - loss: 1.7187 - accuracy20: 0.6836 - val_loss: 3.3234 - val_accuracy20: 0.6364 - 16s/epoch - 30ms/step
Epoch 21/50
529/529 - 16s - loss: 1.6926 - accuracy20: 0.6863 - val_loss: 3.4819 - val_accuracy20: 0.6228 - 16s/epoch - 30ms/step
Epoch 22/50
529/529 - 16s - loss: 1.6751 - accuracy20: 0.6851 - val_loss: 3.3412 - val_accuracy20: 0.6423 - 16s/epoch - 29ms/step
Epoch 23/50
529/529 - 16s - loss: 1.6625 - accuracy20: 0.6876 - val_loss: 3.2724 - val_accuracy20: 0.6443 - 16s/epoch - 29ms/step
Epoch 24/50
529/529 - 16s - loss: 1.6406 - accuracy20: 0.6908 - val_loss: 3.1234 - val_accuracy20: 0.6958 - 16s/epoch - 30ms/step
Epoch 25/50
529/529 - 16s - loss: 1.6157 - accuracy20: 0.6966 - val_loss: 3.3566 - val_accuracy20: 0.5928 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h20
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7376372
{'0': {'precision': 0.3747364638236703, 'recall': 0.5622393961179007, 'f1-score': 0.4497268545140885, 'support': 55640}, '1': {'precision': 0.8865528359199245, 'recall': 0.7129541627065513, 'f1-score': 0.7903329405512812, 'support': 359838}, '2': {'precision': 0.3288415473217471, 'recall': 0.581446903611852, 'f1-score': 0.420095189108595, 'support': 55484}, 'accuracy': 0.6796556834734012, 'macro avg': {'precision': 0.5300436156884474, 'recall': 0.6188801541454346, 'f1-score': 0.553384994724655, 'support': 470962}, 'weighted avg': {'precision': 0.7603823251780455, 'recall': 0.6796556834734012, 'f1-score': 0.7064756568889998, 'support': 470962}}
[[ 31283  17497   6860]
 [ 44306 256548  58984]
 [  7891  15332  32261]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5547021
{'0': {'precision': 0.39046018314593717, 'recall': 0.6316332270766923, 'f1-score': 0.48259312320916903, 'support': 10666}, '1': {'precision': 0.9410599044157385, 'recall': 0.7800723810193074, 'f1-score': 0.8530370925368259, 'support': 113842}, '2': {'precision': 0.3140297754226596, 'recall': 0.6856119731888716, 'f1-score': 0.43075946811272314, 'support': 10891}, 'accuracy': 0.7607810988264315, 'macro avg': {'precision': 0.5485166209947784, 'recall': 0.6991058604282904, 'f1-score': 0.5887965612862394, 'support': 135399}, 'weighted avg': {'precision': 0.847250631364037, 'recall': 0.7607810988264315, 'f1-score': 0.7898890561078148, 'support': 135399}}
[[ 6737  3061   868]
 [ 9594 88805 15443]
 [  923  2501  7467]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6654285
{'0': {'precision': 0.3553567579219659, 'recall': 0.6167227833894501, 'f1-score': 0.4509026258205689, 'support': 5346}, '1': {'precision': 0.9098730028676771, 'recall': 0.7376461936279742, 'f1-score': 0.8147575563037982, 'support': 42153}, '2': {'precision': 0.3557632398753894, 'recall': 0.6136485760343902, 'f1-score': 0.45040425951488855, 'support': 5583}, 'accuracy': 0.7124260577973701, 'macro avg': {'precision': 0.5403310002216775, 'recall': 0.6560058510172715, 'f1-score': 0.5720214805464185, 'support': 53082}, 'weighted avg': {'precision': 0.795746959156707, 'recall': 0.7124260577973701, 'f1-score': 0.7397914112012054, 'support': 53082}}
[[ 3297  1521   528]
 [ 5383 31094  5676]
 [  598  1559  3426]]
training model: results/QRTEA/W10/deepOF_L2/h30
Epoch 1/50
529/529 - 18s - loss: 2.8175 - accuracy30: 0.4778 - val_loss: 3.2793 - val_accuracy30: 0.6717 - 18s/epoch - 33ms/step
Epoch 2/50
529/529 - 16s - loss: 2.5000 - accuracy30: 0.5524 - val_loss: 3.1630 - val_accuracy30: 0.7213 - 16s/epoch - 30ms/step
Epoch 3/50
529/529 - 16s - loss: 2.3610 - accuracy30: 0.5813 - val_loss: 3.0734 - val_accuracy30: 0.7132 - 16s/epoch - 30ms/step
Epoch 4/50
529/529 - 16s - loss: 2.2781 - accuracy30: 0.5986 - val_loss: 3.1469 - val_accuracy30: 0.7055 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 2.2211 - accuracy30: 0.6136 - val_loss: 3.0283 - val_accuracy30: 0.7095 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 16s - loss: 2.1733 - accuracy30: 0.6208 - val_loss: 3.1391 - val_accuracy30: 0.7269 - 16s/epoch - 30ms/step
Epoch 7/50
529/529 - 16s - loss: 2.1348 - accuracy30: 0.6277 - val_loss: 3.1478 - val_accuracy30: 0.6897 - 16s/epoch - 30ms/step
Epoch 8/50
529/529 - 16s - loss: 2.1030 - accuracy30: 0.6265 - val_loss: 3.1331 - val_accuracy30: 0.7019 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 2.0649 - accuracy30: 0.6315 - val_loss: 3.0213 - val_accuracy30: 0.7183 - 16s/epoch - 30ms/step
Epoch 10/50
529/529 - 16s - loss: 2.0358 - accuracy30: 0.6384 - val_loss: 3.1746 - val_accuracy30: 0.6939 - 16s/epoch - 29ms/step
Epoch 11/50
529/529 - 16s - loss: 2.0079 - accuracy30: 0.6407 - val_loss: 3.0019 - val_accuracy30: 0.6669 - 16s/epoch - 30ms/step
Epoch 12/50
529/529 - 16s - loss: 1.9763 - accuracy30: 0.6426 - val_loss: 3.1839 - val_accuracy30: 0.6784 - 16s/epoch - 29ms/step
Epoch 13/50
529/529 - 16s - loss: 1.9497 - accuracy30: 0.6450 - val_loss: 3.0763 - val_accuracy30: 0.7010 - 16s/epoch - 29ms/step
Epoch 14/50
529/529 - 16s - loss: 1.9265 - accuracy30: 0.6449 - val_loss: 3.0788 - val_accuracy30: 0.6861 - 16s/epoch - 30ms/step
Epoch 15/50
529/529 - 16s - loss: 1.8993 - accuracy30: 0.6481 - val_loss: 3.0884 - val_accuracy30: 0.6776 - 16s/epoch - 30ms/step
Epoch 16/50
529/529 - 16s - loss: 1.8784 - accuracy30: 0.6498 - val_loss: 3.0828 - val_accuracy30: 0.6477 - 16s/epoch - 29ms/step
Epoch 17/50
529/529 - 16s - loss: 1.8563 - accuracy30: 0.6487 - val_loss: 3.1737 - val_accuracy30: 0.7065 - 16s/epoch - 30ms/step
Epoch 18/50
529/529 - 16s - loss: 1.8317 - accuracy30: 0.6526 - val_loss: 3.2330 - val_accuracy30: 0.7137 - 16s/epoch - 30ms/step
Epoch 19/50
529/529 - 16s - loss: 1.8085 - accuracy30: 0.6545 - val_loss: 3.3282 - val_accuracy30: 0.7181 - 16s/epoch - 30ms/step
Epoch 20/50
529/529 - 16s - loss: 1.7858 - accuracy30: 0.6592 - val_loss: 3.3402 - val_accuracy30: 0.7061 - 16s/epoch - 30ms/step
Epoch 21/50
529/529 - 16s - loss: 1.7643 - accuracy30: 0.6577 - val_loss: 3.3037 - val_accuracy30: 0.6945 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h30
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7632768
{'0': {'precision': 0.3794836468773346, 'recall': 0.5809580393613071, 'f1-score': 0.4590889350563987, 'support': 67325}, '1': {'precision': 0.8381406741861148, 'recall': 0.7382222446753818, 'f1-score': 0.7850147734993443, 'support': 336503}, '2': {'precision': 0.43677453640253966, 'recall': 0.465218816099145, 'f1-score': 0.45054818234275823, 'support': 67134}, 'accuracy': 0.6768253065003121, 'macro avg': {'precision': 0.5514662858219964, 'recall': 0.5947997000452779, 'f1-score': 0.5648839636328337, 'support': 470962}, 'weighted avg': {'precision': 0.7153613445214579, 'recall': 0.6768253065003121, 'f1-score': 0.6907459424601574, 'support': 470962}}
[[ 39113  22222   5990]
 [ 53805 248414  34284]
 [ 10151  25751  31232]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.58707654
{'0': {'precision': 0.3681810359662709, 'recall': 0.6573469544511867, 'f1-score': 0.4719962496208256, 'support': 13019}, '1': {'precision': 0.9085666352102338, 'recall': 0.794669797045094, 'f1-score': 0.8478100279341908, 'support': 109039}, '2': {'precision': 0.43830801310694073, 'recall': 0.5514579117007721, 'f1-score': 0.48841532231295226, 'support': 13341}, 'accuracy': 0.7575019017865715, 'macro avg': {'precision': 0.5716852280944819, 'recall': 0.6678248877323508, 'f1-score': 0.6027405332893229, 'support': 135399}, 'weighted avg': {'precision': 0.8102719624723467, 'recall': 0.7575019017865715, 'f1-score': 0.7762629386089029, 'support': 135399}}
[[ 8558  3787   674]
 [13635 86650  8754]
 [ 1051  4933  7357]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7451226
{'0': {'precision': 0.31893382352941174, 'recall': 0.6928275226539702, 'f1-score': 0.43679496489954006, 'support': 6511}, '1': {'precision': 0.8665388724781597, 'recall': 0.6934490129510876, 'f1-score': 0.7703912721583529, 'support': 39765}, '2': {'precision': 0.47484541877459246, 'recall': 0.4964736996767558, 'f1-score': 0.4854187616721735, 'support': 6806}, 'accuracy': 0.6681172525526544, 'macro avg': {'precision': 0.5534393715940547, 'recall': 0.6275834117606045, 'f1-score': 0.5642016662433554, 'support': 53082}, 'weighted avg': {'precision': 0.7491483800398232, 'recall': 0.6681172525526544, 'f1-score': 0.692934347721989, 'support': 53082}}
[[ 4511  1622   378]
 [ 8831 27575  3359]
 [  802  2625  3379]]
training model: results/QRTEA/W10/deepOF_L2/h50
Epoch 1/50
529/529 - 18s - loss: 2.9195 - accuracy50: 0.4359 - val_loss: 3.3683 - val_accuracy50: 0.6003 - 18s/epoch - 33ms/step
Epoch 2/50
529/529 - 16s - loss: 2.6380 - accuracy50: 0.5042 - val_loss: 3.2853 - val_accuracy50: 0.6509 - 16s/epoch - 29ms/step
Epoch 3/50
529/529 - 16s - loss: 2.5196 - accuracy50: 0.5376 - val_loss: 3.2406 - val_accuracy50: 0.6615 - 16s/epoch - 29ms/step
Epoch 4/50
529/529 - 16s - loss: 2.4441 - accuracy50: 0.5508 - val_loss: 3.3429 - val_accuracy50: 0.6618 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 2.3928 - accuracy50: 0.5616 - val_loss: 3.3217 - val_accuracy50: 0.6662 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 16s - loss: 2.3502 - accuracy50: 0.5738 - val_loss: 3.3213 - val_accuracy50: 0.6789 - 16s/epoch - 30ms/step
Epoch 7/50
529/529 - 16s - loss: 2.3114 - accuracy50: 0.5805 - val_loss: 3.3694 - val_accuracy50: 0.6691 - 16s/epoch - 30ms/step
Epoch 8/50
529/529 - 16s - loss: 2.2751 - accuracy50: 0.5893 - val_loss: 3.3719 - val_accuracy50: 0.6800 - 16s/epoch - 30ms/step
Epoch 9/50
529/529 - 16s - loss: 2.2426 - accuracy50: 0.5933 - val_loss: 3.4201 - val_accuracy50: 0.6756 - 16s/epoch - 30ms/step
Epoch 10/50
529/529 - 16s - loss: 2.2101 - accuracy50: 0.6010 - val_loss: 3.4235 - val_accuracy50: 0.6661 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 2.1760 - accuracy50: 0.6073 - val_loss: 3.4631 - val_accuracy50: 0.6719 - 16s/epoch - 29ms/step
Epoch 12/50
529/529 - 16s - loss: 2.1590 - accuracy50: 0.6096 - val_loss: 3.3744 - val_accuracy50: 0.6790 - 16s/epoch - 29ms/step
Epoch 13/50
529/529 - 16s - loss: 2.1328 - accuracy50: 0.6126 - val_loss: 3.3641 - val_accuracy50: 0.6735 - 16s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepOF_L2/h50
Evaluating performance on  test set...
1840/1840 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84409845
{'0': {'precision': 0.4347086150591049, 'recall': 0.4394025687220317, 'f1-score': 0.43704298868779584, 'support': 86035}, '1': {'precision': 0.7225711278928738, 'recall': 0.7851918427027336, 'f1-score': 0.7525810972395437, 'support': 298187}, '2': {'precision': 0.5122646700795411, 'recall': 0.354161863038967, 'f1-score': 0.41878821340204075, 'support': 86740}, 'accuracy': 0.642637834899631, 'macro avg': {'precision': 0.5565148043438399, 'recall': 0.5262520914879109, 'f1-score': 0.5361374331097934, 'support': 470962}, 'weighted avg': {'precision': 0.6312511627101588, 'recall': 0.642637834899631, 'f1-score': 0.6334621111784291, 'support': 470962}}
[[ 37804  42980   5251]
 [ 40055 234134  23998]
 [  9105  46915  30720]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.73372865
{'0': {'precision': 0.4097321914756695, 'recall': 0.4789376229603055, 'f1-score': 0.441640210228637, 'support': 17282}, '1': {'precision': 0.8227495810390232, 'recall': 0.8213649083322545, 'f1-score': 0.8220566616001793, 'support': 100417}, '2': {'precision': 0.4946488294314381, 'recall': 0.41779661016949154, 'f1-score': 0.45298621745788675, 'support': 17700}, 'accuracy': 0.7249019564398556, 'macro avg': {'precision': 0.5757102006487103, 'recall': 0.5726997138206839, 'f1-score': 0.5722276964289009, 'support': 135399}, 'weighted avg': {'precision': 0.7271421553572373, 'recall': 0.7249019564398556, 'f1-score': 0.7252545879222232, 'support': 135399}}
[[ 8277  8411   594]
 [10977 82479  6961]
 [  947  9358  7395]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7975769
{'0': {'precision': 0.4025960752248569, 'recall': 0.4594657646098215, 'f1-score': 0.429155090701095, 'support': 8573}, '1': {'precision': 0.7520575852234144, 'recall': 0.7762420096444993, 'f1-score': 0.7639584454285833, 'support': 35668}, '2': {'precision': 0.5273792997069258, 'recall': 0.386720959167515, 'f1-score': 0.4462281388671365, 'support': 8841}, 'accuracy': 0.6602049659018123, 'macro avg': {'precision': 0.5606776533850657, 'recall': 0.5408095778072786, 'f1-score': 0.5464472249989383, 'support': 53082}, 'weighted avg': {'precision': 0.6581968744840129, 'recall': 0.6602049659018123, 'f1-score': 0.6569669454777807, 'support': 53082}}
[[ 3939  4298   336]
 [ 5253 27687  2728]
 [  592  4830  3419]]
training model: results/QRTEA/W10/deepOF_L2/h100
Epoch 1/50
529/529 - 18s - loss: 3.1092 - accuracy100: 0.4085 - val_loss: 3.4373 - val_accuracy100: 0.5036 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 16s - loss: 2.9225 - accuracy100: 0.4593 - val_loss: 3.4052 - val_accuracy100: 0.5302 - 16s/epoch - 30ms/step
Epoch 3/50
529/529 - 16s - loss: 2.8354 - accuracy100: 0.4887 - val_loss: 3.4556 - val_accuracy100: 0.5147 - 16s/epoch - 29ms/step
Epoch 4/50
529/529 - 16s - loss: 2.7804 - accuracy100: 0.4987 - val_loss: 3.4613 - val_accuracy100: 0.5270 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 2.7353 - accuracy100: 0.5112 - val_loss: 3.4678 - val_accuracy100: 0.5422 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 16s - loss: 2.6968 - accuracy100: 0.5193 - val_loss: 3.4857 - val_accuracy100: 0.5629 - 16s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 2.6611 - accuracy100: 0.5257 - val_loss: 3.5278 - val_accuracy100: 0.5556 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 16s - loss: 2.6354 - accuracy100: 0.5324 - val_loss: 3.5996 - val_accuracy100: 0.5590 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 2.6075 - accuracy100: 0.5363 - val_loss: 3.5935 - val_accuracy100: 0.5621 - 16s/epoch - 29ms/step
Epoch 10/50
529/529 - 16s - loss: 2.5809 - accuracy100: 0.5402 - val_loss: 3.5880 - val_accuracy100: 0.5697 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 2.5596 - accuracy100: 0.5435 - val_loss: 3.6305 - val_accuracy100: 0.5716 - 16s/epoch - 29ms/step
Epoch 12/50
529/529 - 16s - loss: 2.5298 - accuracy100: 0.5494 - val_loss: 3.6159 - val_accuracy100: 0.5764 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h100
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.981242
{'0': {'precision': 0.45446942074202157, 'recall': 0.40266606717623354, 'f1-score': 0.4270023044933205, 'support': 120102}, '1': {'precision': 0.550153643546971, 'recall': 0.7223279859576809, 'f1-score': 0.624592707818122, 'support': 229022}, '2': {'precision': 0.5147837253735084, 'recall': 0.26979267551995273, 'f1-score': 0.3540378691596838, 'support': 121838}, 'accuracy': 0.5237386455807475, 'macro avg': {'precision': 0.5064689298875004, 'recall': 0.464928909551289, 'f1-score': 0.4685442938237088, 'support': 470962}, 'weighted avg': {'precision': 0.5166025999006931, 'recall': 0.5237386455807475, 'f1-score': 0.5042117364179196, 'support': 470962}}
[[ 48361  62544   9197]
 [ 41807 165429  21786]
 [ 16244  72723  32871]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.90557224
{'0': {'precision': 0.3964405375220665, 'recall': 0.4221105527638191, 'f1-score': 0.40887303533608294, 'support': 26069}, '1': {'precision': 0.6760785329577221, 'recall': 0.7537756170351028, 'f1-score': 0.7128160775656052, 'support': 83099}, '2': {'precision': 0.5105716000800373, 'recall': 0.2918302771529869, 'f1-score': 0.3713856006209975, 'support': 26231}, 'accuracy': 0.6004254093457115, 'macro avg': {'precision': 0.5276968901866087, 'recall': 0.4892388156506362, 'f1-score': 0.4976915711742285, 'support': 135399}, 'weighted avg': {'precision': 0.590174683894386, 'recall': 0.6004254093457115, 'f1-score': 0.5881507993241454, 'support': 135399}}
[[11004 13885  1180]
 [14303 62638  6158]
 [ 2450 16126  7655]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9592093
{'0': {'precision': 0.40503962913115, 'recall': 0.43706632241407134, 'f1-score': 0.4204439615026389, 'support': 12394}, '1': {'precision': 0.5786114986198094, 'recall': 0.6957670069241202, 'f1-score': 0.6318041128522582, 'support': 28018}, '2': {'precision': 0.5426292172178827, 'recall': 0.25769534333070243, 'f1-score': 0.3494407877133836, 'support': 12670}, 'accuracy': 0.5308014016050638, 'macro avg': {'precision': 0.508760114989614, 'recall': 0.463509557556298, 'f1-score': 0.4672296206894269, 'support': 53082}, 'weighted avg': {'precision': 0.529496068609545, 'recall': 0.5308014016050638, 'f1-score': 0.5150575500751073, 'support': 53082}}
[[ 5417  6340   637]
 [ 6409 19494  2115]
 [ 1548  7857  3265]]
training model: results/QRTEA/W10/deepOF_L2/h200
Epoch 1/50
529/529 - 17s - loss: 3.2319 - accuracy200: 0.3961 - val_loss: 3.3726 - val_accuracy200: 0.4222 - 17s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 3.1309 - accuracy200: 0.4340 - val_loss: 3.4228 - val_accuracy200: 0.4374 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 16s - loss: 3.0769 - accuracy200: 0.4521 - val_loss: 3.4900 - val_accuracy200: 0.4404 - 16s/epoch - 29ms/step
Epoch 4/50
529/529 - 16s - loss: 3.0414 - accuracy200: 0.4648 - val_loss: 3.5381 - val_accuracy200: 0.4469 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 3.0120 - accuracy200: 0.4715 - val_loss: 3.5314 - val_accuracy200: 0.4482 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 16s - loss: 2.9869 - accuracy200: 0.4787 - val_loss: 3.5349 - val_accuracy200: 0.4512 - 16s/epoch - 30ms/step
Epoch 7/50
529/529 - 16s - loss: 2.9654 - accuracy200: 0.4808 - val_loss: 3.5222 - val_accuracy200: 0.4516 - 16s/epoch - 29ms/step
Epoch 8/50
529/529 - 16s - loss: 2.9497 - accuracy200: 0.4851 - val_loss: 3.5410 - val_accuracy200: 0.4543 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 2.9337 - accuracy200: 0.4879 - val_loss: 3.5629 - val_accuracy200: 0.4525 - 16s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 2.9201 - accuracy200: 0.4899 - val_loss: 3.5506 - val_accuracy200: 0.4567 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 16s - loss: 2.9032 - accuracy200: 0.4939 - val_loss: 3.5613 - val_accuracy200: 0.4563 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h200
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0794504
{'0': {'precision': 0.44016187403062773, 'recall': 0.32145089053223624, 'f1-score': 0.37155476632982454, 'support': 153616}, '1': {'precision': 0.3648894810812784, 'recall': 0.6306292665076781, 'f1-score': 0.46229161704479493, 'support': 158502}, '2': {'precision': 0.4656121450713688, 'recall': 0.24869053914532496, 'f1-score': 0.3242136364569013, 'support': 158844}, 'accuracy': 0.40096440901813735, 'macro avg': {'precision': 0.42355450006109163, 'recall': 0.40025689872841314, 'f1-score': 0.3860200066105069, 'support': 470962}, 'weighted avg': {'precision': 0.4234127478292308, 'recall': 0.40096440901813735, 'f1-score': 0.3861251942592321, 'support': 470962}}
[[49380 83194 21042]
 [34250 99956 24296]
 [28556 90785 39503]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.036731
{'0': {'precision': 0.37692117770507994, 'recall': 0.3424269612516122, 'f1-score': 0.3588470353176236, 'support': 35666}, '1': {'precision': 0.5028656151105131, 'recall': 0.6318648631723965, 'f1-score': 0.5600327463958151, 'support': 63876}, '2': {'precision': 0.41662634704200574, 'recall': 0.264160414981733, 'f1-score': 0.32332058984161666, 'support': 35857}, 'accuracy': 0.45824562958367493, 'macro avg': {'precision': 0.4321377132858662, 'recall': 0.4128174131352473, 'f1-score': 0.41406679051835177, 'support': 135399}, 'weighted avg': {'precision': 0.44685179122972635, 'recall': 0.45824562958367493, 'f1-score': 0.4443503752639849, 'support': 135399}}
[[12213 19456  3997]
 [14249 40361  9266]
 [ 5940 20445  9472]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0573028
{'0': {'precision': 0.41148985063194177, 'recall': 0.33918424043439827, 'f1-score': 0.3718547745128577, 'support': 15838}, '1': {'precision': 0.42143376656231224, 'recall': 0.6233395696913003, 'f1-score': 0.502877195630436, 'support': 21380}, '2': {'precision': 0.43764873869585913, 'recall': 0.23184568835098335, 'f1-score': 0.3031152134498104, 'support': 15864}, 'accuracy': 0.4215553294902227, 'macro avg': {'precision': 0.42352411863003775, 'recall': 0.398123166158894, 'f1-score': 0.39261572786436805, 'support': 53082}, 'weighted avg': {'precision': 0.42331279480957834, 'recall': 0.4215553294902227, 'f1-score': 0.4040836838755351, 'support': 53082}}
[[ 5372  8682  1784]
 [ 5111 13327  2942]
 [ 2572  9614  3678]]
training model: results/QRTEA/W10/deepOF_L2/h300
Epoch 1/50
529/529 - 18s - loss: 3.2584 - accuracy300: 0.3910 - val_loss: 3.3351 - val_accuracy300: 0.3854 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 16s - loss: 3.1851 - accuracy300: 0.4194 - val_loss: 3.3726 - val_accuracy300: 0.3802 - 16s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 3.1471 - accuracy300: 0.4365 - val_loss: 3.4453 - val_accuracy300: 0.3773 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 3.1184 - accuracy300: 0.4482 - val_loss: 3.4901 - val_accuracy300: 0.3780 - 15s/epoch - 29ms/step
Epoch 5/50
529/529 - 16s - loss: 3.0980 - accuracy300: 0.4561 - val_loss: 3.5058 - val_accuracy300: 0.3811 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 15s - loss: 3.0771 - accuracy300: 0.4615 - val_loss: 3.5137 - val_accuracy300: 0.3800 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 3.0639 - accuracy300: 0.4647 - val_loss: 3.5111 - val_accuracy300: 0.3825 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 16s - loss: 3.0503 - accuracy300: 0.4688 - val_loss: 3.5208 - val_accuracy300: 0.3823 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 3.0365 - accuracy300: 0.4720 - val_loss: 3.5208 - val_accuracy300: 0.3836 - 16s/epoch - 30ms/step
Epoch 10/50
529/529 - 16s - loss: 3.0284 - accuracy300: 0.4734 - val_loss: 3.5312 - val_accuracy300: 0.3882 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 3.0159 - accuracy300: 0.4755 - val_loss: 3.5314 - val_accuracy300: 0.3858 - 16s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepOF_L2/h300
Evaluating performance on  test set...
1840/1840 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001036
{'0': {'precision': 0.42973965412370746, 'recall': 0.3397348752441392, 'f1-score': 0.3794733736050236, 'support': 168449}, '1': {'precision': 0.2835190056530049, 'recall': 0.5638369682261616, 'f1-score': 0.37731131073534435, 'support': 124442}, '2': {'precision': 0.46288504550789467, 'recall': 0.23476590798052463, 'f1-score': 0.31153007805950406, 'support': 178071}, 'accuracy': 0.3592604074214055, 'macro avg': {'precision': 0.39204790176153564, 'recall': 0.37944591715027515, 'f1-score': 0.35610492079995737, 'support': 470962}, 'weighted avg': {'precision': 0.4036361533151123, 'recall': 0.3592604074214055, 'f1-score': 0.3532126943809783, 'support': 470962}}
[[57228 84075 27146]
 [32914 70165 21363]
 [43027 93239 41805]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0656071
{'0': {'precision': 0.3812939639113632, 'recall': 0.34036533306859923, 'f1-score': 0.35966902267273376, 'support': 40292}, '1': {'precision': 0.42724754866571285, 'recall': 0.5998931033211692, 'f1-score': 0.499060878098144, 'support': 54258}, '2': {'precision': 0.4244913759731601, 'recall': 0.24159710152023306, 'f1-score': 0.30793472495241664, 'support': 40849}, 'accuracy': 0.4145673158590536, 'macro avg': {'precision': 0.4110109628500787, 'recall': 0.3939518459700005, 'f1-score': 0.38888820857443146, 'support': 135399}, 'weighted avg': {'precision': 0.41274117317372, 'recall': 0.4145673158590536, 'f1-score': 0.3999191645799463, 'support': 135399}}
[[13714 21209  5369]
 [13698 32549  8011]
 [ 8555 22425  9869]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0827157
{'0': {'precision': 0.41163793103448276, 'recall': 0.34780629374608774, 'f1-score': 0.3770395731161901, 'support': 17573}, '1': {'precision': 0.34886402170227193, 'recall': 0.5821309341934023, 'f1-score': 0.43627419799419037, 'support': 17673}, '2': {'precision': 0.4424748398902104, 'recall': 0.21692083426777303, 'f1-score': 0.29112114371708053, 'support': 17836}, 'accuracy': 0.3818431860140914, 'macro avg': {'precision': 0.4009922642089883, 'recall': 0.38228602073575435, 'f1-score': 0.3681449716091536, 'support': 53082}, 'weighted avg': {'precision': 0.40109959048067156, 'recall': 0.3818431860140914, 'f1-score': 0.36789169659884674, 'support': 53082}}
[[ 6112  9048  2413]
 [ 4923 10288  2462]
 [ 3813 10154  3869]]
training model: results/QRTEA/W10/deepOF_L2/h500
Epoch 1/50
529/529 - 28s - loss: 3.2880 - accuracy500: 0.3774 - val_loss: 3.2960 - val_accuracy500: 0.3559 - 28s/epoch - 54ms/step
Epoch 2/50
529/529 - 16s - loss: 3.2380 - accuracy500: 0.3997 - val_loss: 3.3055 - val_accuracy500: 0.3394 - 16s/epoch - 30ms/step
Epoch 3/50
529/529 - 16s - loss: 3.2094 - accuracy500: 0.4147 - val_loss: 3.3676 - val_accuracy500: 0.3253 - 16s/epoch - 29ms/step
Epoch 4/50
529/529 - 16s - loss: 3.1930 - accuracy500: 0.4226 - val_loss: 3.4129 - val_accuracy500: 0.3222 - 16s/epoch - 29ms/step
Epoch 5/50
529/529 - 15s - loss: 3.1792 - accuracy500: 0.4293 - val_loss: 3.4355 - val_accuracy500: 0.3198 - 15s/epoch - 29ms/step
Epoch 6/50
529/529 - 16s - loss: 3.1685 - accuracy500: 0.4326 - val_loss: 3.4502 - val_accuracy500: 0.3194 - 16s/epoch - 29ms/step
Epoch 7/50
529/529 - 16s - loss: 3.1601 - accuracy500: 0.4357 - val_loss: 3.4404 - val_accuracy500: 0.3212 - 16s/epoch - 29ms/step
Epoch 8/50
529/529 - 16s - loss: 3.1517 - accuracy500: 0.4392 - val_loss: 3.4574 - val_accuracy500: 0.3201 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 3.1433 - accuracy500: 0.4415 - val_loss: 3.4601 - val_accuracy500: 0.3239 - 16s/epoch - 30ms/step
Epoch 10/50
529/529 - 16s - loss: 3.1366 - accuracy500: 0.4445 - val_loss: 3.4780 - val_accuracy500: 0.3264 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 3.1265 - accuracy500: 0.4483 - val_loss: 3.4947 - val_accuracy500: 0.3285 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h500
Evaluating performance on  test set...
1840/1840 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153905
{'0': {'precision': 0.40414182939362797, 'recall': 0.44261723058913577, 'f1-score': 0.42250539910390994, 'support': 177684}, '1': {'precision': 0.22086078817086308, 'recall': 0.43824441344986403, 'f1-score': 0.2937042715730579, 'support': 99659}, '2': {'precision': 0.45683283935227, 'recall': 0.1854828296809714, 'f1-score': 0.2638411355020718, 'support': 193619}, 'accuracy': 0.33598039756923065, 'macro avg': {'precision': 0.36061181897225364, 'recall': 0.35544815790665707, 'f1-score': 0.3266836020596799, 'support': 470962}, 'weighted avg': {'precision': 0.3870202258883829, 'recall': 0.33598039756923065, 'f1-score': 0.3300210635886847, 'support': 470962}}
[[78646 73131 25907]
 [39191 43675 16793]
 [76763 80943 35913]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934086
{'0': {'precision': 0.37154195443965354, 'recall': 0.4379033527467338, 'f1-score': 0.40200237394849564, 'support': 44471}, '1': {'precision': 0.34933301773547265, 'recall': 0.4618032273926065, 'f1-score': 0.39777069757144645, 'support': 44742}, '2': {'precision': 0.42348351371759374, 'recall': 0.2185727276663924, 'f1-score': 0.2883297155261053, 'support': 46186}, 'accuracy': 0.37098501466037415, 'macro avg': {'precision': 0.3814528286309066, 'recall': 0.37275976926857757, 'f1-score': 0.3627009290153491, 'support': 135399}, 'weighted avg': {'precision': 0.3819209130050232, 'recall': 0.37098501466037415, 'f1-score': 0.36182911516254856, 'support': 135399}}
[[19474 18572  6425]
 [16762 20662  7318]
 [16178 19913 10095]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017557
{'0': {'precision': 0.3958794647155098, 'recall': 0.4299006795608991, 'f1-score': 0.41218925421010427, 'support': 19130}, '1': {'precision': 0.2877855343054236, 'recall': 0.47804309043502125, 'f1-score': 0.3592811283294226, 'support': 14574}, '2': {'precision': 0.44524015310532167, 'recall': 0.1860873155124368, 'f1-score': 0.26247406922153077, 'support': 19378}, 'accuracy': 0.3541125051806639, 'macro avg': {'precision': 0.37630171737541834, 'recall': 0.36467702850278566, 'f1-score': 0.3446481505870192, 'support': 53082}, 'weighted avg': {'precision': 0.38422109611261573, 'recall': 0.3541125051806639, 'f1-score': 0.3430082911474158, 'support': 53082}}
[[8224 8411 2495]
 [5609 6967 1998]
 [6941 8831 3606]]
training model: results/QRTEA/W10/deepOF_L2/h1000
Epoch 1/50
529/529 - 18s - loss: 3.3146 - accuracy1000: 0.3660 - val_loss: 3.3595 - val_accuracy1000: 0.3343 - 18s/epoch - 33ms/step
Epoch 2/50
529/529 - 16s - loss: 3.2953 - accuracy1000: 0.3749 - val_loss: 3.3177 - val_accuracy1000: 0.3453 - 16s/epoch - 29ms/step
Epoch 3/50
529/529 - 16s - loss: 3.2819 - accuracy1000: 0.3794 - val_loss: 3.3050 - val_accuracy1000: 0.3508 - 16s/epoch - 30ms/step
Epoch 4/50
529/529 - 16s - loss: 3.2746 - accuracy1000: 0.3840 - val_loss: 3.3027 - val_accuracy1000: 0.3520 - 16s/epoch - 30ms/step
Epoch 5/50
529/529 - 16s - loss: 3.2689 - accuracy1000: 0.3863 - val_loss: 3.2996 - val_accuracy1000: 0.3537 - 16s/epoch - 30ms/step
Epoch 6/50
529/529 - 15s - loss: 3.2630 - accuracy1000: 0.3907 - val_loss: 3.3031 - val_accuracy1000: 0.3541 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 16s - loss: 3.2564 - accuracy1000: 0.3967 - val_loss: 3.3044 - val_accuracy1000: 0.3540 - 16s/epoch - 30ms/step
Epoch 8/50
529/529 - 16s - loss: 3.2511 - accuracy1000: 0.3991 - val_loss: 3.3117 - val_accuracy1000: 0.3504 - 16s/epoch - 29ms/step
Epoch 9/50
529/529 - 16s - loss: 3.2452 - accuracy1000: 0.4034 - val_loss: 3.3257 - val_accuracy1000: 0.3516 - 16s/epoch - 29ms/step
Epoch 10/50
529/529 - 16s - loss: 3.2407 - accuracy1000: 0.4062 - val_loss: 3.3331 - val_accuracy1000: 0.3503 - 16s/epoch - 30ms/step
Epoch 11/50
529/529 - 16s - loss: 3.2328 - accuracy1000: 0.4105 - val_loss: 3.3456 - val_accuracy1000: 0.3483 - 16s/epoch - 30ms/step
Epoch 12/50
529/529 - 16s - loss: 3.2254 - accuracy1000: 0.4125 - val_loss: 3.3605 - val_accuracy1000: 0.3439 - 16s/epoch - 29ms/step
Epoch 13/50
529/529 - 16s - loss: 3.2180 - accuracy1000: 0.4158 - val_loss: 3.3815 - val_accuracy1000: 0.3425 - 16s/epoch - 29ms/step
Epoch 14/50
529/529 - 16s - loss: 3.2119 - accuracy1000: 0.4209 - val_loss: 3.3899 - val_accuracy1000: 0.3413 - 16s/epoch - 29ms/step
Epoch 15/50
529/529 - 16s - loss: 3.2024 - accuracy1000: 0.4236 - val_loss: 3.4146 - val_accuracy1000: 0.3386 - 16s/epoch - 30ms/step
testing model: results/QRTEA/W10/deepOF_L2/h1000
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006991
{'0': {'precision': 0.3639604187232781, 'recall': 0.6739157558516744, 'f1-score': 0.4726549596042905, 'support': 160296}, '1': {'precision': 0.30452150556148627, 'recall': 0.1323029967533925, 'f1-score': 0.18446358914453787, 'support': 133678}, '2': {'precision': 0.3990454612024777, 'recall': 0.26171265848532105, 'f1-score': 0.316107348199205, 'support': 176988}, 'accuracy': 0.3652778780453625, 'macro avg': {'precision': 0.3558424618290807, 'recall': 0.3559771370301293, 'f1-score': 0.32440863231601114, 'support': 470962}, 'weighted avg': {'precision': 0.3602742539470681, 'recall': 0.3652778780453625, 'f1-score': 0.33202387967070335, 'support': 470962}}
[[108026  18351  33919]
 [ 80154  17686  35838]
 [108627  22041  46320]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.088041
{'0': {'precision': 0.37083354280830527, 'recall': 0.6586819663347769, 'f1-score': 0.47451711992794987, 'support': 44794}, '1': {'precision': 0.3943492825990772, 'recall': 0.1393224805162904, 'f1-score': 0.2059007953532887, 'support': 44781}, '2': {'precision': 0.39936022392162746, 'recall': 0.3487255586592179, 'f1-score': 0.372329271418253, 'support': 45824}, 'accuracy': 0.3820116839858492, 'macro avg': {'precision': 0.3881810164430033, 'recall': 0.38224333517009507, 'f1-score': 0.3509157288998305, 'support': 135399}, 'weighted avg': {'precision': 0.38826546607884227, 'recall': 0.3820116839858492, 'f1-score': 0.3510925481003422, 'support': 135399}}
[[29505  4213 11076]
 [25584  6239 12958]
 [24475  5369 15980]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003596
{'0': {'precision': 0.34793143134048093, 'recall': 0.6645840564618767, 'f1-score': 0.45674300254452926, 'support': 17286}, '1': {'precision': 0.33533260632497275, 'recall': 0.10519413877644107, 'f1-score': 0.16014929907556094, 'support': 17539}, '2': {'precision': 0.38463123197363, 'recall': 0.3067864380785452, 'f1-score': 0.34132667052621957, 'support': 18257}, 'accuracy': 0.3566934177310576, 'macro avg': {'precision': 0.3559650898796946, 'recall': 0.3588548777722877, 'f1-score': 0.31940632404876995, 'support': 53082}, 'weighted avg': {'precision': 0.35639112517666655, 'recall': 0.3566934177310576, 'f1-score': 0.3190482484131756, 'support': 53082}}
[[11488  1712  4086]
 [10819  1845  4875]
 [10711  1945  5601]]
training model: results/QRTEA/W10/deepVOL_L2/h10
Epoch 1/50
529/529 - 18s - loss: 2.5454 - accuracy10: 0.5706 - val_loss: 2.8662 - val_accuracy10: 0.6336 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 15s - loss: 2.2262 - accuracy10: 0.6788 - val_loss: 2.7847 - val_accuracy10: 0.6238 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 2.1511 - accuracy10: 0.7034 - val_loss: 2.7236 - val_accuracy10: 0.6264 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 2.1006 - accuracy10: 0.7140 - val_loss: 2.7449 - val_accuracy10: 0.6699 - 15s/epoch - 29ms/step
Epoch 5/50
529/529 - 15s - loss: 2.0664 - accuracy10: 0.7202 - val_loss: 2.7340 - val_accuracy10: 0.6099 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 2.0521 - accuracy10: 0.7249 - val_loss: 2.7161 - val_accuracy10: 0.6435 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 2.0350 - accuracy10: 0.7302 - val_loss: 2.7196 - val_accuracy10: 0.6612 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 2.0190 - accuracy10: 0.7352 - val_loss: 2.7466 - val_accuracy10: 0.6362 - 15s/epoch - 28ms/step
Epoch 9/50
529/529 - 15s - loss: 2.0078 - accuracy10: 0.7341 - val_loss: 2.7238 - val_accuracy10: 0.6551 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 1.9978 - accuracy10: 0.7327 - val_loss: 2.7080 - val_accuracy10: 0.6657 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 15s - loss: 1.9839 - accuracy10: 0.7337 - val_loss: 2.7057 - val_accuracy10: 0.6475 - 15s/epoch - 29ms/step
Epoch 12/50
529/529 - 15s - loss: 1.9738 - accuracy10: 0.7328 - val_loss: 2.7178 - val_accuracy10: 0.6586 - 15s/epoch - 29ms/step
Epoch 13/50
529/529 - 15s - loss: 1.9662 - accuracy10: 0.7314 - val_loss: 2.6956 - val_accuracy10: 0.6217 - 15s/epoch - 29ms/step
Epoch 14/50
529/529 - 15s - loss: 1.9549 - accuracy10: 0.7326 - val_loss: 2.6924 - val_accuracy10: 0.6315 - 15s/epoch - 29ms/step
Epoch 15/50
529/529 - 15s - loss: 1.9476 - accuracy10: 0.7312 - val_loss: 2.7235 - val_accuracy10: 0.6496 - 15s/epoch - 29ms/step
Epoch 16/50
529/529 - 16s - loss: 1.9353 - accuracy10: 0.7307 - val_loss: 2.6817 - val_accuracy10: 0.6276 - 16s/epoch - 29ms/step
Epoch 17/50
529/529 - 15s - loss: 1.9269 - accuracy10: 0.7346 - val_loss: 2.6874 - val_accuracy10: 0.6276 - 15s/epoch - 28ms/step
Epoch 18/50
529/529 - 15s - loss: 1.9130 - accuracy10: 0.7321 - val_loss: 2.7016 - val_accuracy10: 0.6143 - 15s/epoch - 29ms/step
Epoch 19/50
529/529 - 15s - loss: 1.9051 - accuracy10: 0.7322 - val_loss: 2.6826 - val_accuracy10: 0.6347 - 15s/epoch - 29ms/step
Epoch 20/50
529/529 - 15s - loss: 1.8920 - accuracy10: 0.7316 - val_loss: 2.7350 - val_accuracy10: 0.6092 - 15s/epoch - 29ms/step
Epoch 21/50
529/529 - 15s - loss: 1.8873 - accuracy10: 0.7328 - val_loss: 2.7513 - val_accuracy10: 0.6122 - 15s/epoch - 28ms/step
Epoch 22/50
529/529 - 15s - loss: 1.8729 - accuracy10: 0.7323 - val_loss: 2.7750 - val_accuracy10: 0.6283 - 15s/epoch - 28ms/step
Epoch 23/50
529/529 - 15s - loss: 1.8741 - accuracy10: 0.7300 - val_loss: 2.7241 - val_accuracy10: 0.6268 - 15s/epoch - 29ms/step
Epoch 24/50
529/529 - 15s - loss: 1.8713 - accuracy10: 0.7280 - val_loss: 2.7437 - val_accuracy10: 0.6453 - 15s/epoch - 28ms/step
Epoch 25/50
529/529 - 15s - loss: 1.8573 - accuracy10: 0.7302 - val_loss: 2.7609 - val_accuracy10: 0.6357 - 15s/epoch - 28ms/step
Epoch 26/50
529/529 - 15s - loss: 1.8483 - accuracy10: 0.7309 - val_loss: 2.7524 - val_accuracy10: 0.6629 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h10
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92326146
{'0': {'precision': 0.21540431106347505, 'recall': 0.7182389000570819, 'f1-score': 0.33141515646024794, 'support': 40293}, '1': {'precision': 0.9379355240208642, 'recall': 0.5869285064627289, 'f1-score': 0.7220330275576344, 'support': 390315}, '2': {'precision': 0.22579003778323897, 'recall': 0.5167620605069502, 'f1-score': 0.31426677114098006, 'support': 40359}, 'accuracy': 0.5921497684551147, 'macro avg': {'precision': 0.4597099576225261, 'recall': 0.6073098223422536, 'f1-score': 0.4559049850529542, 'support': 470967}, 'weighted avg': {'precision': 0.815093732891642, 'recall': 0.5921497684551148, 'f1-score': 0.6536711163773463, 'support': 470967}}
[[ 28940   6854   4499]
 [ 94214 229087  67014]
 [ 11198   8305  20856]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7469969
{'0': {'precision': 0.19584241408214584, 'recall': 0.7586699571372906, 'f1-score': 0.3113207547169811, 'support': 7699}, '1': {'precision': 0.9690337517635568, 'recall': 0.6705858791525156, 'f1-score': 0.7926476825503289, 'support': 119837}, '2': {'precision': 0.22055901443899853, 'recall': 0.635092180546726, 'f1-score': 0.3274121657052963, 'support': 7865}, 'accuracy': 0.6735326917821878, 'macro avg': {'precision': 0.46181172676156707, 'recall': 0.6881160056121773, 'f1-score': 0.4771268676575355, 'support': 135401}, 'weighted avg': {'precision': 0.8815930835420012, 'recall': 0.6735326917821878, 'f1-score': 0.7382550757204301, 'support': 135401}}
[[ 5841  1091   767]
 [22591 80361 16885]
 [ 1393  1477  4995]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8429805
{'0': {'precision': 0.22014051522248243, 'recall': 0.7341838063004426, 'f1-score': 0.33871839529157405, 'support': 3841}, '1': {'precision': 0.9564503438130751, 'recall': 0.6178426996088484, 'f1-score': 0.7507317204156708, 'support': 45251}, '2': {'precision': 0.2265193370165746, 'recall': 0.6268170426065163, 'f1-score': 0.3327789235579802, 'support': 3990}, 'accuracy': 0.6269356844127953, 'macro avg': {'precision': 0.46770339868404404, 'recall': 0.6596145161719357, 'f1-score': 0.4740763464217417, 'support': 53082}, 'weighted avg': {'precision': 0.8483046302240147, 'recall': 0.6269356844127953, 'f1-score': 0.6895023989646357, 'support': 53082}}
[[ 2820   576   445]
 [ 9198 27958  8095]
 [  792   697  2501]]
training model: results/QRTEA/W10/deepVOL_L2/h20
Epoch 1/50
529/529 - 18s - loss: 2.5947 - accuracy20: 0.5512 - val_loss: 2.9746 - val_accuracy20: 0.5932 - 18s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 2.3085 - accuracy20: 0.6497 - val_loss: 2.8524 - val_accuracy20: 0.6132 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 2.2464 - accuracy20: 0.6670 - val_loss: 2.8584 - val_accuracy20: 0.6224 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 2.2053 - accuracy20: 0.6776 - val_loss: 2.8071 - val_accuracy20: 0.5991 - 15s/epoch - 29ms/step
Epoch 5/50
529/529 - 15s - loss: 2.1687 - accuracy20: 0.6825 - val_loss: 2.7804 - val_accuracy20: 0.6251 - 15s/epoch - 29ms/step
Epoch 6/50
529/529 - 15s - loss: 2.1456 - accuracy20: 0.6888 - val_loss: 2.8233 - val_accuracy20: 0.6320 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 2.1289 - accuracy20: 0.6927 - val_loss: 2.8205 - val_accuracy20: 0.6196 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 2.1078 - accuracy20: 0.6977 - val_loss: 2.8019 - val_accuracy20: 0.6388 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 2.0968 - accuracy20: 0.6953 - val_loss: 2.8013 - val_accuracy20: 0.6265 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 2.0780 - accuracy20: 0.6961 - val_loss: 2.7992 - val_accuracy20: 0.6109 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 15s - loss: 2.0680 - accuracy20: 0.6951 - val_loss: 2.8256 - val_accuracy20: 0.6298 - 15s/epoch - 28ms/step
Epoch 12/50
529/529 - 15s - loss: 2.0538 - accuracy20: 0.6952 - val_loss: 2.8425 - val_accuracy20: 0.6163 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 2.0455 - accuracy20: 0.6961 - val_loss: 2.8978 - val_accuracy20: 0.6499 - 15s/epoch - 29ms/step
Epoch 14/50
529/529 - 15s - loss: 2.0309 - accuracy20: 0.6967 - val_loss: 2.8585 - val_accuracy20: 0.6650 - 15s/epoch - 29ms/step
Epoch 15/50
529/529 - 15s - loss: 2.0207 - accuracy20: 0.6936 - val_loss: 2.8400 - val_accuracy20: 0.6401 - 15s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h20
Evaluating performance on  test set...
1840/1840 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84499204
{'0': {'precision': 0.31195898255426824, 'recall': 0.5893929046403795, 'f1-score': 0.40797919984076436, 'support': 55642}, '1': {'precision': 0.8875370427622401, 'recall': 0.6541953484752904, 'f1-score': 0.7532080253026447, 'support': 359839}, '2': {'precision': 0.29638096752711046, 'recall': 0.5373968208196662, 'f1-score': 0.3820542881487318, 'support': 55486}, 'accuracy': 0.6327789420490183, 'macro avg': {'precision': 0.4986256642812063, 'recall': 0.5936616913117787, 'f1-score': 0.514413837764047, 'support': 470967}, 'weighted avg': {'precision': 0.7498900305159716, 'recall': 0.6327789420490183, 'f1-score': 0.6686945486342754, 'support': 470967}}
[[ 32795  15012   7835]
 [ 61480 235405  62954]
 [ 10851  14817  29818]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7552264
{'0': {'precision': 0.2629338812651354, 'recall': 0.6743835874270657, 'f1-score': 0.37835269271383315, 'support': 10626}, '1': {'precision': 0.9399813989443297, 'recall': 0.6833924619761846, 'f1-score': 0.7914088281206303, 'support': 113876}, '2': {'precision': 0.2737024767313456, 'recall': 0.6367556656573997, 'f1-score': 0.3828437456902496, 'support': 10899}, 'accuracy': 0.6789314702254784, 'macro avg': {'precision': 0.4922059189802703, 'recall': 0.6648439050202167, 'f1-score': 0.517535088841571, 'support': 135401}, 'weighted avg': {'precision': 0.8332164496746903, 'recall': 0.6789314702254784, 'f1-score': 0.726105873724124, 'support': 135401}}
[[ 7166  2391  1069]
 [18707 77822 17347]
 [ 1381  2578  6940]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8346111
{'0': {'precision': 0.299359795134443, 'recall': 0.6564956944964433, 'f1-score': 0.4112094741161986, 'support': 5342}, '1': {'precision': 0.9182012697744572, 'recall': 0.6207051905247433, 'f1-score': 0.7406977731246992, 'support': 42173}, '2': {'precision': 0.2774926116036709, 'recall': 0.6409197054068618, 'f1-score': 0.38729986431478974, 'support': 5567}, 'accuracy': 0.6264270374138126, 'macro avg': {'precision': 0.49835122550419036, 'recall': 0.6393735301426828, 'f1-score': 0.5130690371852292, 'support': 53082}, 'weighted avg': {'precision': 0.7887284492785502, 'recall': 0.6264270374138126, 'f1-score': 0.6704763675324424, 'support': 53082}}
[[ 3507  1122   713]
 [ 7419 26177  8577]
 [  789  1210  3568]]
training model: results/QRTEA/W10/deepVOL_L2/h30
Epoch 1/50
529/529 - 18s - loss: 2.6788 - accuracy30: 0.5124 - val_loss: 3.0565 - val_accuracy30: 0.5550 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 15s - loss: 2.4211 - accuracy30: 0.6102 - val_loss: 2.9423 - val_accuracy30: 0.5754 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 2.3485 - accuracy30: 0.6367 - val_loss: 2.9039 - val_accuracy30: 0.5636 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 2.2965 - accuracy30: 0.6538 - val_loss: 2.8814 - val_accuracy30: 0.5655 - 15s/epoch - 29ms/step
Epoch 5/50
529/529 - 15s - loss: 2.2653 - accuracy30: 0.6591 - val_loss: 2.8802 - val_accuracy30: 0.5504 - 15s/epoch - 29ms/step
Epoch 6/50
529/529 - 15s - loss: 2.2441 - accuracy30: 0.6656 - val_loss: 2.8926 - val_accuracy30: 0.5833 - 15s/epoch - 28ms/step
Epoch 7/50
529/529 - 15s - loss: 2.2176 - accuracy30: 0.6659 - val_loss: 2.8734 - val_accuracy30: 0.5575 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 2.2007 - accuracy30: 0.6655 - val_loss: 2.8879 - val_accuracy30: 0.5670 - 15s/epoch - 28ms/step
Epoch 9/50
529/529 - 15s - loss: 2.1839 - accuracy30: 0.6651 - val_loss: 2.9087 - val_accuracy30: 0.5848 - 15s/epoch - 28ms/step
Epoch 10/50
529/529 - 15s - loss: 2.1763 - accuracy30: 0.6680 - val_loss: 2.9014 - val_accuracy30: 0.5781 - 15s/epoch - 28ms/step
Epoch 11/50
529/529 - 15s - loss: 2.1587 - accuracy30: 0.6668 - val_loss: 2.8989 - val_accuracy30: 0.5642 - 15s/epoch - 28ms/step
Epoch 12/50
529/529 - 15s - loss: 2.1419 - accuracy30: 0.6696 - val_loss: 2.9377 - val_accuracy30: 0.6004 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 2.1324 - accuracy30: 0.6700 - val_loss: 2.8943 - val_accuracy30: 0.6094 - 15s/epoch - 29ms/step
Epoch 14/50
529/529 - 15s - loss: 2.1162 - accuracy30: 0.6701 - val_loss: 2.9242 - val_accuracy30: 0.6141 - 15s/epoch - 28ms/step
Epoch 15/50
529/529 - 15s - loss: 2.0969 - accuracy30: 0.6676 - val_loss: 2.9118 - val_accuracy30: 0.5859 - 15s/epoch - 28ms/step
Epoch 16/50
529/529 - 15s - loss: 2.0980 - accuracy30: 0.6644 - val_loss: 2.9198 - val_accuracy30: 0.6329 - 15s/epoch - 29ms/step
Epoch 17/50
529/529 - 15s - loss: 2.0947 - accuracy30: 0.6653 - val_loss: 2.9128 - val_accuracy30: 0.6145 - 15s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h30
Evaluating performance on  test set...
1840/1840 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92891884
{'0': {'precision': 0.31632903245579086, 'recall': 0.6132069866920152, 'f1-score': 0.4173591314368897, 'support': 67328}, '1': {'precision': 0.8540161448074748, 'recall': 0.5630796753669358, 'f1-score': 0.6786825939789028, 'support': 336503}, '2': {'precision': 0.30902988598799164, 'recall': 0.545847235462345, 'f1-score': 0.39463708808959724, 'support': 67136}, 'accuracy': 0.5677892506269017, 'macro avg': {'precision': 0.4931250210837524, 'recall': 0.5740446325070986, 'f1-score': 0.49689293783512994, 'support': 470967}, 'weighted avg': {'precision': 0.6994626508842934, 'recall': 0.5677892506269017, 'f1-score': 0.6008341137893927, 'support': 470967}}
[[ 41286  15992  10050]
 [ 75137 189478  71888]
 [ 14093  16397  36646]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84730977
{'0': {'precision': 0.2659347718181553, 'recall': 0.7009928422996998, 'f1-score': 0.38558909444985395, 'support': 12993}, '1': {'precision': 0.918879629229817, 'recall': 0.5853213532593747, 'f1-score': 0.7151170280094317, 'support': 109070}, '2': {'precision': 0.2758326756116811, 'recall': 0.6550457339931024, 'f1-score': 0.3881989647435185, 'support': 13338}, 'accuracy': 0.6032894882607958, 'macro avg': {'precision': 0.4868823588865512, 'recall': 0.6471199765173924, 'f1-score': 0.496301695734268, 'support': 135401}, 'weighted avg': {'precision': 0.7928785450449999, 'recall': 0.6032894882607958, 'f1-score': 0.6512918748083449, 'support': 135401}}
[[ 9108  2671  1214]
 [23505 63841 21724]
 [ 1636  2965  8737]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9278366
{'0': {'precision': 0.3112197887872989, 'recall': 0.6750192159877018, 'f1-score': 0.42602115067429897, 'support': 6505}, '1': {'precision': 0.8917915281316119, 'recall': 0.5191413417791519, 'f1-score': 0.6562549648883099, 'support': 39783}, '2': {'precision': 0.28449475148602504, 'recall': 0.6622019428907859, 'f1-score': 0.3980007077140835, 'support': 6794}, 'accuracy': 0.5565540107757808, 'macro avg': {'precision': 0.4958353561349786, 'recall': 0.6187875002192132, 'f1-score': 0.49342560775889743, 'support': 53082}, 'weighted avg': {'precision': 0.7429163262747702, 'recall': 0.5565540107757808, 'f1-score': 0.5949865427357189, 'support': 53082}}
[[ 4391  1181   933]
 [ 8748 20653 10382]
 [  970  1325  4499]]
training model: results/QRTEA/W10/deepVOL_L2/h50
Epoch 1/50
529/529 - 17s - loss: 2.8190 - accuracy50: 0.4786 - val_loss: 3.1476 - val_accuracy50: 0.5139 - 17s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 2.5853 - accuracy50: 0.5709 - val_loss: 3.0813 - val_accuracy50: 0.5586 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 2.5199 - accuracy50: 0.5824 - val_loss: 3.0627 - val_accuracy50: 0.5836 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 2.4741 - accuracy50: 0.6009 - val_loss: 3.0710 - val_accuracy50: 0.6215 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 2.4374 - accuracy50: 0.6106 - val_loss: 3.1071 - val_accuracy50: 0.6178 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 2.4110 - accuracy50: 0.6128 - val_loss: 3.1371 - val_accuracy50: 0.6358 - 15s/epoch - 28ms/step
Epoch 7/50
529/529 - 15s - loss: 2.3889 - accuracy50: 0.6170 - val_loss: 3.1466 - val_accuracy50: 0.6273 - 15s/epoch - 28ms/step
Epoch 8/50
529/529 - 15s - loss: 2.3706 - accuracy50: 0.6162 - val_loss: 3.1721 - val_accuracy50: 0.6303 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 2.3708 - accuracy50: 0.6191 - val_loss: 3.1916 - val_accuracy50: 0.6430 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 2.3490 - accuracy50: 0.6185 - val_loss: 3.2264 - val_accuracy50: 0.6537 - 15s/epoch - 28ms/step
Epoch 11/50
529/529 - 15s - loss: 2.3292 - accuracy50: 0.6191 - val_loss: 3.1999 - val_accuracy50: 0.6285 - 15s/epoch - 29ms/step
Epoch 12/50
529/529 - 15s - loss: 2.3088 - accuracy50: 0.6185 - val_loss: 3.1675 - val_accuracy50: 0.6185 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 2.2985 - accuracy50: 0.6189 - val_loss: 3.2593 - val_accuracy50: 0.6171 - 15s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h50
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9215537
{'0': {'precision': 0.3823919569922502, 'recall': 0.5092633487528766, 'f1-score': 0.43680154718824454, 'support': 86038}, '1': {'precision': 0.7649251189240529, 'recall': 0.6401028881108562, 'f1-score': 0.6969694203393357, 'support': 298188}, '2': {'precision': 0.3797611694461602, 'recall': 0.46781798688048326, 'f1-score': 0.4192153722978383, 'support': 86741}, 'accuracy': 0.5844698248497241, 'macro avg': {'precision': 0.5090260817874878, 'recall': 0.5390614079147387, 'f1-score': 0.5176621132751394, 'support': 470967}, 'weighted avg': {'precision': 0.6241044365239052, 'recall': 0.5844698248497241, 'f1-score': 0.5982852506388235, 'support': 470967}}
[[ 43816  28976  13246]
 [ 54288 190871  53029]
 [ 16480  29682  40579]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83093184
{'0': {'precision': 0.3316285759948857, 'recall': 0.6013098411962443, 'f1-score': 0.4274912956591606, 'support': 17254}, '1': {'precision': 0.8548606346206129, 'recall': 0.6573553274730963, 'f1-score': 0.743210237824575, 'support': 100451}, '2': {'precision': 0.3608082461950657, 'recall': 0.5479204339963833, 'f1-score': 0.4351006304830712, 'support': 17696}, 'accuracy': 0.6359111084851663, 'macro avg': {'precision': 0.5157658189368548, 'recall': 0.6021952008885747, 'f1-score': 0.5352673879889356, 'support': 135401}, 'weighted avg': {'precision': 0.7236164266376085, 'recall': 0.6359111084851663, 'f1-score': 0.6627106681047257, 'support': 135401}}
[[10375  5256  1623]
 [18865 66032 15554]
 [ 2045  5955  9696]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90439534
{'0': {'precision': 0.3754563743387229, 'recall': 0.5894256638203299, 'f1-score': 0.45871643149749664, 'support': 8549}, '1': {'precision': 0.8153253124634973, 'recall': 0.586587483892655, 'f1-score': 0.6822958244407877, 'support': 35698}, '2': {'precision': 0.3618543425382744, 'recall': 0.5724957555178268, 'f1-score': 0.4434313768465349, 'support': 8835}, 'accuracy': 0.5846991447194906, 'macro avg': {'precision': 0.5175453431134982, 'recall': 0.5828363010769372, 'f1-score': 0.5281478775949396, 'support': 53082}, 'weighted avg': {'precision': 0.6690072466159775, 'recall': 0.5846991447194906, 'f1-score': 0.6065310148110183, 'support': 53082}}
[[ 5039  2207  1303]
 [ 7141 20940  7617]
 [ 1241  2536  5058]]
training model: results/QRTEA/W10/deepVOL_L2/h100
Epoch 1/50
529/529 - 17s - loss: 3.0983 - accuracy100: 0.4229 - val_loss: 3.4928 - val_accuracy100: 0.4937 - 17s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 2.9534 - accuracy100: 0.4906 - val_loss: 3.2821 - val_accuracy100: 0.5094 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 2.8723 - accuracy100: 0.5176 - val_loss: 3.2529 - val_accuracy100: 0.5028 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 2.8235 - accuracy100: 0.5350 - val_loss: 3.2629 - val_accuracy100: 0.5162 - 15s/epoch - 29ms/step
Epoch 5/50
529/529 - 15s - loss: 2.7838 - accuracy100: 0.5413 - val_loss: 3.2799 - val_accuracy100: 0.5295 - 15s/epoch - 29ms/step
Epoch 6/50
529/529 - 15s - loss: 2.7572 - accuracy100: 0.5456 - val_loss: 3.3043 - val_accuracy100: 0.5372 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 2.7329 - accuracy100: 0.5446 - val_loss: 3.3222 - val_accuracy100: 0.5300 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 2.7172 - accuracy100: 0.5474 - val_loss: 3.3254 - val_accuracy100: 0.5320 - 15s/epoch - 28ms/step
Epoch 9/50
529/529 - 15s - loss: 2.7005 - accuracy100: 0.5494 - val_loss: 3.3976 - val_accuracy100: 0.5452 - 15s/epoch - 28ms/step
Epoch 10/50
529/529 - 15s - loss: 2.6828 - accuracy100: 0.5526 - val_loss: 3.4962 - val_accuracy100: 0.5482 - 15s/epoch - 28ms/step
Epoch 11/50
529/529 - 15s - loss: 2.6623 - accuracy100: 0.5558 - val_loss: 3.4676 - val_accuracy100: 0.5336 - 15s/epoch - 29ms/step
Epoch 12/50
529/529 - 15s - loss: 2.6464 - accuracy100: 0.5574 - val_loss: 3.4856 - val_accuracy100: 0.5373 - 15s/epoch - 29ms/step
Epoch 13/50
529/529 - 15s - loss: 2.6209 - accuracy100: 0.5622 - val_loss: 3.4968 - val_accuracy100: 0.5311 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h100
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0350014
{'0': {'precision': 0.40342134688020004, 'recall': 0.3815078473002789, 'f1-score': 0.39215870869457303, 'support': 120105}, '1': {'precision': 0.6262351766383323, 'recall': 0.55039690510082, 'f1-score': 0.5858720129023562, 'support': 229022}, '2': {'precision': 0.40677390630305127, 'recall': 0.521150689428759, 'f1-score': 0.4569132075743238, 'support': 121840}, 'accuracy': 0.4997611297606839, 'macro avg': {'precision': 0.4788101432738612, 'recall': 0.4843518139432859, 'f1-score': 0.4783146430570844, 'support': 470967}, 'weighted avg': {'precision': 0.5126386482175488, 'recall': 0.4997611297606839, 'f1-score': 0.5031097870074565, 'support': 470967}}
[[ 45821  36182  38102]
 [ 48469 126053  54500]
 [ 19291  39052  63497]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99616766
{'0': {'precision': 0.3452152738200093, 'recall': 0.511829774158857, 'f1-score': 0.4123271140815001, 'support': 26036}, '1': {'precision': 0.7319222861514432, 'recall': 0.5523441822424286, 'f1-score': 0.629578092333002, 'support': 83142}, '2': {'precision': 0.39094432699083864, 'recall': 0.5077222285779659, 'f1-score': 0.441745881650326, 'support': 26223}, 'accuracy': 0.535911847032149, 'macro avg': {'precision': 0.4893606289874304, 'recall': 0.5239653949930838, 'f1-score': 0.49455036268827596, 'support': 135401}, 'weighted avg': {'precision': 0.5915262122957866, 'recall': 0.535911847032149, 'f1-score': 0.5514260068204289, 'support': 135401}}
[[13326  7929  4781]
 [21258 45923 15961]
 [ 4018  8891 13314]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0312777
{'0': {'precision': 0.3836792211119652, 'recall': 0.4847062631493769, 'f1-score': 0.4283160529138363, 'support': 12358}, '1': {'precision': 0.67601246105919, 'recall': 0.487292817679558, 'f1-score': 0.5663449190107296, 'support': 28055}, '2': {'precision': 0.4101003072998203, 'recall': 0.5582918935985476, 'f1-score': 0.4728573338681642, 'support': 12669}, 'accuracy': 0.5036358841038393, 'macro avg': {'precision': 0.48993066315699174, 'recall': 0.5100969914758275, 'f1-score': 0.48917276859757663, 'support': 53082}, 'weighted avg': {'precision': 0.5444896236520603, 'recall': 0.5036358841038393, 'f1-score': 0.5118979323976297, 'support': 53082}}
[[ 5990  3012  3356]
 [ 7566 13671  6818]
 [ 2056  3540  7073]]
training model: results/QRTEA/W10/deepVOL_L2/h200
Epoch 1/50
529/529 - 18s - loss: 3.2215 - accuracy200: 0.4122 - val_loss: 3.4726 - val_accuracy200: 0.4066 - 18s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 3.1542 - accuracy200: 0.4353 - val_loss: 3.3388 - val_accuracy200: 0.4144 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 3.0977 - accuracy200: 0.4595 - val_loss: 3.2753 - val_accuracy200: 0.4366 - 15s/epoch - 28ms/step
Epoch 4/50
529/529 - 15s - loss: 3.0441 - accuracy200: 0.4861 - val_loss: 3.3811 - val_accuracy200: 0.4681 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 3.0139 - accuracy200: 0.4902 - val_loss: 3.4796 - val_accuracy200: 0.4626 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 2.9859 - accuracy200: 0.4974 - val_loss: 3.4377 - val_accuracy200: 0.4636 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 2.9625 - accuracy200: 0.5047 - val_loss: 3.4905 - val_accuracy200: 0.4612 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 2.9456 - accuracy200: 0.5098 - val_loss: 3.4662 - val_accuracy200: 0.4550 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 2.9289 - accuracy200: 0.5117 - val_loss: 3.5399 - val_accuracy200: 0.4446 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 2.9065 - accuracy200: 0.5173 - val_loss: 3.5629 - val_accuracy200: 0.4487 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 15s - loss: 2.8854 - accuracy200: 0.5212 - val_loss: 3.6532 - val_accuracy200: 0.4486 - 15s/epoch - 29ms/step
Epoch 12/50
529/529 - 15s - loss: 2.8692 - accuracy200: 0.5245 - val_loss: 3.6736 - val_accuracy200: 0.4368 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 2.8440 - accuracy200: 0.5297 - val_loss: 3.6920 - val_accuracy200: 0.4281 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h200
Evaluating performance on  test set...
1840/1840 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0686437
{'0': {'precision': 0.40492273285787656, 'recall': 0.4054446390094975, 'f1-score': 0.40518351787038603, 'support': 153619}, '1': {'precision': 0.4279144869270171, 'recall': 0.4949085815951849, 'f1-score': 0.4589797524420819, 'support': 158502}, '2': {'precision': 0.43383171564561807, 'recall': 0.3655175452954434, 'f1-score': 0.3967554898028215, 'support': 158846}, 'accuracy': 0.4220868978081267, 'macro avg': {'precision': 0.42222297847683726, 'recall': 0.4219569219667086, 'f1-score': 0.4203062533717632, 'support': 470967}, 'weighted avg': {'precision': 0.42241082710517736, 'recall': 0.4220868978081267, 'f1-score': 0.42044584458470485, 'support': 470967}}
[[62284 47103 44232]
 [48518 78444 31540]
 [43015 57770 58061]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0274717
{'0': {'precision': 0.382381227159069, 'recall': 0.5017105041781168, 'f1-score': 0.4339926988708719, 'support': 35662}, '1': {'precision': 0.5683075921438131, 'recall': 0.4916837477116615, 'f1-score': 0.5272262069544064, 'support': 63911}, '2': {'precision': 0.4060211309881138, 'recall': 0.3775538684827509, 'f1-score': 0.3912703922249219, 'support': 35828}, 'accuracy': 0.46412508031698435, 'macro avg': {'precision': 0.4522366500969987, 'recall': 0.456982706790843, 'f1-score': 0.45082976601673336, 'support': 135401}, 'weighted avg': {'precision': 0.4763961191238772, 'recall': 0.46412508031698435, 'f1-score': 0.4666954996819122, 'support': 135401}}
[[17892 10644  7126]
 [19824 31424 12663]
 [ 9075 13226 13527]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0488849
{'0': {'precision': 0.39637713771377137, 'recall': 0.44504800404244566, 'f1-score': 0.4193049273982385, 'support': 15832}, '1': {'precision': 0.5049680821537608, 'recall': 0.42563046834791557, 'f1-score': 0.4619173352290038, 'support': 21373}, '2': {'precision': 0.4122375802440576, 'recall': 0.4489513132203817, 'f1-score': 0.42981186685962375, 'support': 15877}, 'accuracy': 0.43839719678987227, 'macro avg': {'precision': 0.4378609333705299, 'recall': 0.43987659520358097, 'f1-score': 0.43701137649562205, 'support': 53082}, 'weighted avg': {'precision': 0.44484423581801097, 'recall': 0.43839719678987227, 'f1-score': 0.4396050982734007, 'support': 53082}}
[[7046 4083 4703]
 [6816 9097 5460]
 [3914 4835 7128]]
training model: results/QRTEA/W10/deepVOL_L2/h300
Epoch 1/50
529/529 - 19s - loss: 3.2752 - accuracy300: 0.3986 - val_loss: 3.4583 - val_accuracy300: 0.3493 - 19s/epoch - 35ms/step
Epoch 2/50
529/529 - 16s - loss: 3.2182 - accuracy300: 0.4164 - val_loss: 3.2808 - val_accuracy300: 0.4080 - 16s/epoch - 31ms/step
Epoch 3/50
529/529 - 15s - loss: 3.1744 - accuracy300: 0.4395 - val_loss: 3.2849 - val_accuracy300: 0.4002 - 15s/epoch - 28ms/step
Epoch 4/50
529/529 - 15s - loss: 3.1491 - accuracy300: 0.4479 - val_loss: 3.3248 - val_accuracy300: 0.3940 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 3.1109 - accuracy300: 0.4654 - val_loss: 3.3221 - val_accuracy300: 0.3982 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 3.0858 - accuracy300: 0.4690 - val_loss: 3.3449 - val_accuracy300: 0.4053 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 3.0598 - accuracy300: 0.4761 - val_loss: 3.4151 - val_accuracy300: 0.3923 - 15s/epoch - 28ms/step
Epoch 8/50
529/529 - 15s - loss: 3.0443 - accuracy300: 0.4782 - val_loss: 3.4656 - val_accuracy300: 0.3985 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 3.0227 - accuracy300: 0.4847 - val_loss: 3.4625 - val_accuracy300: 0.3927 - 15s/epoch - 29ms/step
Epoch 10/50
529/529 - 15s - loss: 3.0059 - accuracy300: 0.4900 - val_loss: 3.4430 - val_accuracy300: 0.4036 - 15s/epoch - 28ms/step
Epoch 11/50
529/529 - 15s - loss: 2.9868 - accuracy300: 0.4955 - val_loss: 3.4591 - val_accuracy300: 0.4036 - 15s/epoch - 28ms/step
Epoch 12/50
529/529 - 15s - loss: 2.9696 - accuracy300: 0.5004 - val_loss: 3.5008 - val_accuracy300: 0.3988 - 15s/epoch - 29ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h300
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950574
{'0': {'precision': 0.403473386301793, 'recall': 0.5272540545674732, 'f1-score': 0.457132710386198, 'support': 168452}, '1': {'precision': 0.3327802025085005, 'recall': 0.42705838864691986, 'f1-score': 0.37407043735636425, 'support': 124442}, '2': {'precision': 0.4626339986174964, 'recall': 0.23677929837763165, 'f1-score': 0.3132401230257195, 'support': 178073}, 'accuracy': 0.3909509583474001, 'macro avg': {'precision': 0.39962919580926326, 'recall': 0.39703058053067486, 'f1-score': 0.38148109025609395, 'support': 470967}, 'weighted avg': {'precision': 0.4071630429853597, 'recall': 0.3909509583474001, 'f1-score': 0.38077954744819803, 'support': 470967}}
[[88817 48790 30845]
 [53168 53144 18130]
 [78146 57763 42164]]
Evaluating performance on  train set...
529/529 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0712509
{'0': {'precision': 0.3605115293684178, 'recall': 0.5826757977271599, 'f1-score': 0.4454286798179059, 'support': 40302}, '1': {'precision': 0.47752361907482604, 'recall': 0.4310554429913428, 'f1-score': 0.45310125173044713, 'support': 54290}, '2': {'precision': 0.4408637561159202, 'recall': 0.22963071871400917, 'f1-score': 0.30197373721098847, 'support': 40809}, 'accuracy': 0.41547699056875503, 'macro avg': {'precision': 0.4262996348530546, 'recall': 0.41445398647750403, 'f1-score': 0.40016788958644717, 'support': 135401}, 'weighted avg': {'precision': 0.4316460141321915, 'recall': 0.41547699056875503, 'f1-score': 0.4052686453741881, 'support': 135401}}
[[23483 11676  5143]
 [24146 23402  6742]
 [17509 13929  9371]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0747582
{'0': {'precision': 0.38570265670095466, 'recall': 0.5935542648901037, 'f1-score': 0.4675697497084418, 'support': 17562}, '1': {'precision': 0.41376613218615566, 'recall': 0.359476754063084, 'f1-score': 0.38471561467834303, 'support': 17659}, '2': {'precision': 0.4616389770393877, 'recall': 0.2769161861038016, 'f1-score': 0.3461767279090114, 'support': 17861}, 'accuracy': 0.40914057495949663, 'macro avg': {'precision': 0.42036925530883273, 'recall': 0.4099824016856631, 'f1-score': 0.39948736409859875, 'support': 53082}, 'weighted avg': {'precision': 0.42058965287965777, 'recall': 0.40914057495949663, 'f1-score': 0.39916008291261384, 'support': 53082}}
[[10424  4121  3017]
 [ 8560  6348  2751]
 [ 8042  4873  4946]]
training model: results/QRTEA/W10/deepVOL_L2/h500
Epoch 1/50
529/529 - 18s - loss: 3.2928 - accuracy500: 0.3915 - val_loss: 3.5262 - val_accuracy500: 0.3174 - 18s/epoch - 34ms/step
Epoch 2/50
529/529 - 15s - loss: 3.2751 - accuracy500: 0.3951 - val_loss: 3.3695 - val_accuracy500: 0.3178 - 15s/epoch - 29ms/step
Epoch 3/50
529/529 - 15s - loss: 3.2522 - accuracy500: 0.3988 - val_loss: 3.3585 - val_accuracy500: 0.3214 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 3.2359 - accuracy500: 0.4060 - val_loss: 3.3152 - val_accuracy500: 0.3444 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 3.2090 - accuracy500: 0.4187 - val_loss: 3.3064 - val_accuracy500: 0.3678 - 15s/epoch - 29ms/step
Epoch 6/50
529/529 - 15s - loss: 3.1806 - accuracy500: 0.4302 - val_loss: 3.3040 - val_accuracy500: 0.3759 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 3.1527 - accuracy500: 0.4409 - val_loss: 3.3452 - val_accuracy500: 0.3682 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 3.1271 - accuracy500: 0.4498 - val_loss: 3.3766 - val_accuracy500: 0.3753 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 3.1139 - accuracy500: 0.4533 - val_loss: 3.3758 - val_accuracy500: 0.3785 - 15s/epoch - 28ms/step
Epoch 10/50
529/529 - 15s - loss: 3.0916 - accuracy500: 0.4611 - val_loss: 3.3926 - val_accuracy500: 0.3745 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 15s - loss: 3.0746 - accuracy500: 0.4646 - val_loss: 3.3745 - val_accuracy500: 0.3781 - 15s/epoch - 28ms/step
Epoch 12/50
529/529 - 15s - loss: 3.0474 - accuracy500: 0.4760 - val_loss: 3.4216 - val_accuracy500: 0.3837 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 3.0236 - accuracy500: 0.4846 - val_loss: 3.4670 - val_accuracy500: 0.3755 - 15s/epoch - 29ms/step
Epoch 14/50
529/529 - 15s - loss: 3.0049 - accuracy500: 0.4907 - val_loss: 3.4476 - val_accuracy500: 0.3819 - 15s/epoch - 28ms/step
Epoch 15/50
529/529 - 15s - loss: 2.9974 - accuracy500: 0.4924 - val_loss: 3.4437 - val_accuracy500: 0.3725 - 15s/epoch - 29ms/step
Epoch 16/50
529/529 - 15s - loss: 2.9754 - accuracy500: 0.4990 - val_loss: 3.5536 - val_accuracy500: 0.3730 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h500
Evaluating performance on  test set...
1840/1840 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1232373
{'0': {'precision': 0.4103936117168139, 'recall': 0.6207016872460408, 'f1-score': 0.49409983244778555, 'support': 177686}, '1': {'precision': 0.2646002148502807, 'recall': 0.37320262093739653, 'f1-score': 0.30965523557376096, 'support': 99659}, '2': {'precision': 0.4513638869968538, 'recall': 0.1437439960335086, 'f1-score': 0.21804735118534654, 'support': 193622}, 'accuracy': 0.37224476449517696, 'macro avg': {'precision': 0.3754525711879828, 'recall': 0.3792161014056486, 'f1-score': 0.3406008064022977, 'support': 470967}, 'weighted avg': {'precision': 0.39638652099060595, 'recall': 0.37224476449517696, 'f1-score': 0.34158087123210723, 'support': 470967}}
[[110290  46001  21395]
 [ 50031  37193  12435]
 [108421  57369  27832]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0874138
{'0': {'precision': 0.3855727571266937, 'recall': 0.6285482927707049, 'f1-score': 0.47795299832381216, 'support': 44458}, '1': {'precision': 0.409064522371052, 'recall': 0.42508601814200814, 'f1-score': 0.4169214081451534, 'support': 44758}, '2': {'precision': 0.44365253411306044, 'recall': 0.1576918913067013, 'f1-score': 0.2326799891375537, 'support': 46185}, 'accuracy': 0.400683894505949, 'macro avg': {'precision': 0.412763271203602, 'recall': 0.40377540073980484, 'f1-score': 0.3758514652021731, 'support': 135401}, 'weighted avg': {'precision': 0.4131490595832659, 'recall': 0.400683894505949, 'f1-score': 0.3741163513087698, 'support': 135401}}
[[27944 12231  4283]
 [20882 19026  4850]
 [23648 15254  7283]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041815
{'0': {'precision': 0.3868732678256488, 'recall': 0.6422670710028234, 'f1-score': 0.4828806163764298, 'support': 19126}, '1': {'precision': 0.3129878239150796, 'recall': 0.275185286851496, 'f1-score': 0.2928717499269647, 'support': 14572}, '2': {'precision': 0.4255693824841512, 'recall': 0.18700990507635162, 'f1-score': 0.25983800444412586, 'support': 19384}, 'accuracy': 0.37524961380505634, 'macro avg': {'precision': 0.3751434914082932, 'recall': 0.368154087643557, 'f1-score': 0.34519679024917344, 'support': 53082}, 'weighted avg': {'precision': 0.38072102785495426, 'recall': 0.37524961380505634, 'f1-score': 0.3492709710805219, 'support': 53082}}
[[12284  4017  2825]
 [ 8494  4010  2068]
 [10974  4785  3625]]
training model: results/QRTEA/W10/deepVOL_L2/h1000
Epoch 1/50
529/529 - 17s - loss: 3.2946 - accuracy1000: 0.3942 - val_loss: 3.4649 - val_accuracy1000: 0.3266 - 17s/epoch - 33ms/step
Epoch 2/50
529/529 - 15s - loss: 3.2808 - accuracy1000: 0.3864 - val_loss: 3.3176 - val_accuracy1000: 0.3324 - 15s/epoch - 28ms/step
Epoch 3/50
529/529 - 15s - loss: 3.2724 - accuracy1000: 0.3828 - val_loss: 3.3048 - val_accuracy1000: 0.3477 - 15s/epoch - 29ms/step
Epoch 4/50
529/529 - 15s - loss: 3.2650 - accuracy1000: 0.3921 - val_loss: 3.3099 - val_accuracy1000: 0.3406 - 15s/epoch - 28ms/step
Epoch 5/50
529/529 - 15s - loss: 3.2600 - accuracy1000: 0.3926 - val_loss: 3.3001 - val_accuracy1000: 0.3523 - 15s/epoch - 28ms/step
Epoch 6/50
529/529 - 15s - loss: 3.2417 - accuracy1000: 0.4044 - val_loss: 3.3147 - val_accuracy1000: 0.3520 - 15s/epoch - 29ms/step
Epoch 7/50
529/529 - 15s - loss: 3.2333 - accuracy1000: 0.4102 - val_loss: 3.3276 - val_accuracy1000: 0.3441 - 15s/epoch - 29ms/step
Epoch 8/50
529/529 - 15s - loss: 3.2229 - accuracy1000: 0.4146 - val_loss: 3.3352 - val_accuracy1000: 0.3385 - 15s/epoch - 29ms/step
Epoch 9/50
529/529 - 15s - loss: 3.2182 - accuracy1000: 0.4190 - val_loss: 3.3489 - val_accuracy1000: 0.3485 - 15s/epoch - 28ms/step
Epoch 10/50
529/529 - 15s - loss: 3.2056 - accuracy1000: 0.4267 - val_loss: 3.3594 - val_accuracy1000: 0.3468 - 15s/epoch - 29ms/step
Epoch 11/50
529/529 - 15s - loss: 3.1858 - accuracy1000: 0.4345 - val_loss: 3.3651 - val_accuracy1000: 0.3462 - 15s/epoch - 29ms/step
Epoch 12/50
529/529 - 15s - loss: 3.1701 - accuracy1000: 0.4389 - val_loss: 3.3858 - val_accuracy1000: 0.3424 - 15s/epoch - 28ms/step
Epoch 13/50
529/529 - 15s - loss: 3.1451 - accuracy1000: 0.4508 - val_loss: 3.4235 - val_accuracy1000: 0.3478 - 15s/epoch - 28ms/step
Epoch 14/50
529/529 - 15s - loss: 3.1341 - accuracy1000: 0.4540 - val_loss: 3.4355 - val_accuracy1000: 0.3447 - 15s/epoch - 28ms/step
Epoch 15/50
529/529 - 15s - loss: 3.1109 - accuracy1000: 0.4619 - val_loss: 3.4660 - val_accuracy1000: 0.3418 - 15s/epoch - 28ms/step
testing model: results/QRTEA/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
1840/1840 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036501
{'0': {'precision': 0.35248806039131103, 'recall': 0.6565812211083177, 'f1-score': 0.45871387695774307, 'support': 160297}, '1': {'precision': 0.3222325618231136, 'recall': 0.12174778198357246, 'f1-score': 0.17672448896489942, 'support': 133678}, '2': {'precision': 0.389147808392274, 'recall': 0.2679612637859338, 'f1-score': 0.31737969524803755, 'support': 176992}, 'accuracy': 0.3587300171774243, 'macro avg': {'precision': 0.35462281020223285, 'recall': 0.348763422292608, 'f1-score': 0.3176060203902267, 'support': 470967}, 'weighted avg': {'precision': 0.35767735726473726, 'recall': 0.3587300171774243, 'f1-score': 0.3255606052905741, 'support': 470967}}
[[105248  16081  38968]
 [ 81924  16275  35479]
 [111414  18151  47427]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0907649
{'0': {'precision': 0.36849023535302955, 'recall': 0.656957928802589, 'f1-score': 0.47214981754020124, 'support': 44805}, '1': {'precision': 0.44112825730597477, 'recall': 0.17430147633618476, 'f1-score': 0.24987192622950818, 'support': 44773}, '2': {'precision': 0.40005286809410523, 'recall': 0.33027082469502217, 'f1-score': 0.36182802768579725, 'support': 45823}, 'accuracy': 0.38679921123182254, 'macro avg': {'precision': 0.40322378691770316, 'recall': 0.387176743277932, 'f1-score': 0.36128325715183557, 'support': 135401}, 'weighted avg': {'precision': 0.4031909885010383, 'recall': 0.38679921123182254, 'f1-score': 0.36131368335986275, 'support': 135401}}
[[29435  4542 10828]
 [25101  7804 11868]
 [25344  5345 15134]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006503
{'0': {'precision': 0.3458630700374985, 'recall': 0.6619017304242144, 'f1-score': 0.454326970822492, 'support': 17279}, '1': {'precision': 0.35649841502072666, 'recall': 0.0833713503649635, 'f1-score': 0.13513888246984332, 'support': 17536}, '2': {'precision': 0.360020109344561, 'recall': 0.31362566376525974, 'f1-score': 0.335225277940316, 'support': 18267}, 'accuracy': 0.3509287517425869, 'macro avg': {'precision': 0.354127198134262, 'recall': 0.35296624818481254, 'f1-score': 0.30823037707755047, 'support': 53082}, 'weighted avg': {'precision': 0.3542483615986303, 'recall': 0.3509287517425869, 'f1-score': 0.30789479152949706, 'support': 53082}}
[[11437  1373  4469]
 [10359  1462  5715]
 [11272  1266  5729]]
training model: results/QRTEA/W10/deepVOL_L3/h10
Epoch 1/50
529/529 - 25s - loss: 2.8210 - accuracy10: 0.4827 - val_loss: 2.9507 - val_accuracy10: 0.6177 - 25s/epoch - 47ms/step
Epoch 2/50
529/529 - 21s - loss: 2.2878 - accuracy10: 0.6387 - val_loss: 2.9036 - val_accuracy10: 0.5199 - 21s/epoch - 40ms/step
Epoch 3/50
529/529 - 22s - loss: 2.1654 - accuracy10: 0.6823 - val_loss: 2.7668 - val_accuracy10: 0.5991 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 22s - loss: 2.0833 - accuracy10: 0.7032 - val_loss: 2.7383 - val_accuracy10: 0.6582 - 22s/epoch - 42ms/step
Epoch 5/50
529/529 - 22s - loss: 2.0295 - accuracy10: 0.7177 - val_loss: 2.7702 - val_accuracy10: 0.6595 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 21s - loss: 2.0034 - accuracy10: 0.7217 - val_loss: 2.7646 - val_accuracy10: 0.6679 - 21s/epoch - 40ms/step
Epoch 7/50
529/529 - 21s - loss: 1.9856 - accuracy10: 0.7231 - val_loss: 2.7561 - val_accuracy10: 0.6361 - 21s/epoch - 41ms/step
Epoch 8/50
529/529 - 22s - loss: 1.9726 - accuracy10: 0.7298 - val_loss: 2.6536 - val_accuracy10: 0.6242 - 22s/epoch - 41ms/step
Epoch 9/50
529/529 - 21s - loss: 1.9472 - accuracy10: 0.7313 - val_loss: 2.6703 - val_accuracy10: 0.6400 - 21s/epoch - 40ms/step
Epoch 10/50
529/529 - 21s - loss: 1.9343 - accuracy10: 0.7335 - val_loss: 2.6253 - val_accuracy10: 0.6684 - 21s/epoch - 40ms/step
Epoch 11/50
529/529 - 21s - loss: 1.9132 - accuracy10: 0.7352 - val_loss: 2.6835 - val_accuracy10: 0.6363 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 1.9042 - accuracy10: 0.7374 - val_loss: 2.6590 - val_accuracy10: 0.6444 - 21s/epoch - 40ms/step
Epoch 13/50
529/529 - 23s - loss: 1.8909 - accuracy10: 0.7338 - val_loss: 2.6049 - val_accuracy10: 0.6219 - 23s/epoch - 43ms/step
Epoch 14/50
529/529 - 21s - loss: 1.8770 - accuracy10: 0.7374 - val_loss: 2.6037 - val_accuracy10: 0.6520 - 21s/epoch - 40ms/step
Epoch 15/50
529/529 - 22s - loss: 1.8611 - accuracy10: 0.7373 - val_loss: 2.6332 - val_accuracy10: 0.6352 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 23s - loss: 1.8546 - accuracy10: 0.7359 - val_loss: 2.6035 - val_accuracy10: 0.6306 - 23s/epoch - 43ms/step
Epoch 17/50
529/529 - 22s - loss: 1.8417 - accuracy10: 0.7349 - val_loss: 2.6229 - val_accuracy10: 0.6616 - 22s/epoch - 41ms/step
Epoch 18/50
529/529 - 22s - loss: 1.8289 - accuracy10: 0.7348 - val_loss: 2.6301 - val_accuracy10: 0.6297 - 22s/epoch - 41ms/step
Epoch 19/50
529/529 - 21s - loss: 1.8114 - accuracy10: 0.7374 - val_loss: 2.7192 - val_accuracy10: 0.6524 - 21s/epoch - 40ms/step
Epoch 20/50
529/529 - 22s - loss: 1.8058 - accuracy10: 0.7366 - val_loss: 2.6662 - val_accuracy10: 0.6420 - 22s/epoch - 41ms/step
Epoch 21/50
529/529 - 21s - loss: 1.7968 - accuracy10: 0.7369 - val_loss: 2.7240 - val_accuracy10: 0.6238 - 21s/epoch - 40ms/step
Epoch 22/50
529/529 - 23s - loss: 1.7822 - accuracy10: 0.7367 - val_loss: 2.6627 - val_accuracy10: 0.6311 - 23s/epoch - 44ms/step
Epoch 23/50
529/529 - 21s - loss: 1.7729 - accuracy10: 0.7389 - val_loss: 2.7313 - val_accuracy10: 0.6301 - 21s/epoch - 41ms/step
Epoch 24/50
529/529 - 21s - loss: 1.7625 - accuracy10: 0.7405 - val_loss: 2.6979 - val_accuracy10: 0.6345 - 21s/epoch - 40ms/step
Epoch 25/50
529/529 - 21s - loss: 1.7583 - accuracy10: 0.7377 - val_loss: 2.7026 - val_accuracy10: 0.6180 - 21s/epoch - 40ms/step
Epoch 26/50
529/529 - 22s - loss: 1.7448 - accuracy10: 0.7358 - val_loss: 2.7376 - val_accuracy10: 0.6512 - 22s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h10
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8975188
{'0': {'precision': 0.21418545764887606, 'recall': 0.7536544809272082, 'f1-score': 0.33357133441715364, 'support': 40293}, '1': {'precision': 0.9422264812889813, 'recall': 0.5945044387225702, 'f1-score': 0.7290252549926404, 'support': 390315}, '2': {'precision': 0.2582010709633846, 'recall': 0.5304640848385738, 'f1-score': 0.34733725410667204, 'support': 40359}, 'accuracy': 0.6026324562018146, 'macro avg': {'precision': 0.47153766996708063, 'recall': 0.6262076681627841, 'f1-score': 0.469977947838822, 'support': 470967}, 'weighted avg': {'precision': 0.8213230241447196, 'recall': 0.6026324562018146, 'f1-score': 0.6624843490491139, 'support': 470967}}
[[ 30367   5899   4027]
 [100791 232044  57480]
 [ 10621   8329  21409]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7210965
{'0': {'precision': 0.19527599651983374, 'recall': 0.7871152097675023, 'f1-score': 0.31291954972632446, 'support': 7699}, '1': {'precision': 0.9714906358245758, 'recall': 0.6904128107345812, 'f1-score': 0.8071823689524982, 'support': 119837}, '2': {'precision': 0.26068843409883874, 'recall': 0.6364907819453274, 'f1-score': 0.3698832569824147, 'support': 7865}, 'accuracy': 0.6927792261504716, 'macro avg': {'precision': 0.4758183554810828, 'recall': 0.704672934149137, 'f1-score': 0.4966617252204124, 'support': 135401}, 'weighted avg': {'precision': 0.8860663344931223, 'recall': 0.6927792261504716, 'f1-score': 0.7536769519993958, 'support': 135401}}
[[ 6060   909   730]
 [23633 82737 13467]
 [ 1340  1519  5006]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84256124
{'0': {'precision': 0.20991130508235956, 'recall': 0.7763603228325957, 'f1-score': 0.33047043829999445, 'support': 3841}, '1': {'precision': 0.9577844515732714, 'recall': 0.620207288236724, 'f1-score': 0.752887207758239, 'support': 45251}, '2': {'precision': 0.2500522247754335, 'recall': 0.6, 'f1-score': 0.3529932173400177, 'support': 3990}, 'accuracy': 0.6299875664066915, 'macro avg': {'precision': 0.4725826604770215, 'recall': 0.6655225370231066, 'f1-score': 0.47878362113275036, 'support': 53082}, 'weighted avg': {'precision': 0.8504706287972841, 'recall': 0.6299875664066915, 'f1-score': 0.6922625170295961, 'support': 53082}}
[[ 2982   471   388]
 [10394 28065  6792]
 [  830   766  2394]]
training model: results/QRTEA/W10/deepVOL_L3/h20
Epoch 1/50
529/529 - 24s - loss: 2.9300 - accuracy20: 0.3807 - val_loss: 3.6865 - val_accuracy20: 0.6491 - 24s/epoch - 46ms/step
Epoch 2/50
529/529 - 22s - loss: 2.4590 - accuracy20: 0.5433 - val_loss: 3.0490 - val_accuracy20: 0.5539 - 22s/epoch - 41ms/step
Epoch 3/50
529/529 - 22s - loss: 2.2599 - accuracy20: 0.6399 - val_loss: 2.8619 - val_accuracy20: 0.5568 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 22s - loss: 2.1743 - accuracy20: 0.6685 - val_loss: 2.8340 - val_accuracy20: 0.5852 - 22s/epoch - 41ms/step
Epoch 5/50
529/529 - 23s - loss: 2.1171 - accuracy20: 0.6787 - val_loss: 2.8077 - val_accuracy20: 0.5938 - 23s/epoch - 43ms/step
Epoch 6/50
529/529 - 22s - loss: 2.0853 - accuracy20: 0.6836 - val_loss: 2.8459 - val_accuracy20: 0.5802 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 23s - loss: 2.0568 - accuracy20: 0.6895 - val_loss: 2.8876 - val_accuracy20: 0.5404 - 23s/epoch - 44ms/step
Epoch 8/50
529/529 - 23s - loss: 2.0325 - accuracy20: 0.6915 - val_loss: 2.8361 - val_accuracy20: 0.5747 - 23s/epoch - 44ms/step
Epoch 9/50
529/529 - 23s - loss: 2.0086 - accuracy20: 0.6955 - val_loss: 2.8213 - val_accuracy20: 0.6048 - 23s/epoch - 43ms/step
Epoch 10/50
529/529 - 21s - loss: 1.9980 - accuracy20: 0.6949 - val_loss: 2.8610 - val_accuracy20: 0.6538 - 21s/epoch - 40ms/step
Epoch 11/50
529/529 - 21s - loss: 1.9799 - accuracy20: 0.6970 - val_loss: 2.8033 - val_accuracy20: 0.6194 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 1.9602 - accuracy20: 0.7005 - val_loss: 2.8575 - val_accuracy20: 0.6588 - 21s/epoch - 40ms/step
Epoch 13/50
529/529 - 21s - loss: 1.9603 - accuracy20: 0.7010 - val_loss: 2.9379 - val_accuracy20: 0.6236 - 21s/epoch - 40ms/step
Epoch 14/50
529/529 - 21s - loss: 1.9411 - accuracy20: 0.7072 - val_loss: 2.8300 - val_accuracy20: 0.6311 - 21s/epoch - 40ms/step
Epoch 15/50
529/529 - 21s - loss: 1.9309 - accuracy20: 0.7028 - val_loss: 2.8995 - val_accuracy20: 0.6102 - 21s/epoch - 40ms/step
Epoch 16/50
529/529 - 21s - loss: 1.9238 - accuracy20: 0.7028 - val_loss: 2.9569 - val_accuracy20: 0.6364 - 21s/epoch - 40ms/step
Epoch 17/50
529/529 - 21s - loss: 1.9081 - accuracy20: 0.7019 - val_loss: 2.8484 - val_accuracy20: 0.6390 - 21s/epoch - 40ms/step
Epoch 18/50
529/529 - 22s - loss: 1.8990 - accuracy20: 0.7017 - val_loss: 2.8572 - val_accuracy20: 0.6366 - 22s/epoch - 41ms/step
Epoch 19/50
529/529 - 22s - loss: 1.8884 - accuracy20: 0.7034 - val_loss: 2.9135 - val_accuracy20: 0.6001 - 22s/epoch - 41ms/step
Epoch 20/50
529/529 - 21s - loss: 1.8823 - accuracy20: 0.7034 - val_loss: 2.8588 - val_accuracy20: 0.6249 - 21s/epoch - 40ms/step
Epoch 21/50
529/529 - 21s - loss: 1.8688 - accuracy20: 0.7004 - val_loss: 2.8944 - val_accuracy20: 0.6449 - 21s/epoch - 40ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h20
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95311207
{'0': {'precision': 0.25766863659166267, 'recall': 0.7569461917256749, 'f1-score': 0.3844637151985395, 'support': 55642}, '1': {'precision': 0.9034937742250231, 'recall': 0.5609842179419129, 'f1-score': 0.6921862275295105, 'support': 359839}, '2': {'precision': 0.3125721013760213, 'recall': 0.4736690336301049, 'f1-score': 0.37661658391190017, 'support': 55486}, 'accuracy': 0.5738491231869749, 'macro avg': {'precision': 0.4912448373975691, 'recall': 0.5971998144325642, 'f1-score': 0.48442217554665007, 'support': 470967}, 'weighted avg': {'precision': 0.7575750957445878, 'recall': 0.5738491231869749, 'f1-score': 0.6186524273335592, 'support': 470967}}
[[ 42118   8397   5127]
 [105301 201864  52674]
 [ 16039  13165  26282]]
Evaluating performance on  train set...
529/529 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7748322
{'0': {'precision': 0.22926655524808898, 'recall': 0.787502352719744, 'f1-score': 0.35514058355437667, 'support': 10626}, '1': {'precision': 0.9490006538377713, 'recall': 0.6500316133338017, 'f1-score': 0.7715672019053873, 'support': 113876}, '2': {'precision': 0.31185110760250706, 'recall': 0.5980365171116616, 'f1-score': 0.409937106918239, 'support': 10899}, 'accuracy': 0.6566347368187827, 'macro avg': {'precision': 0.4967061055627891, 'recall': 0.6785234943884024, 'f1-score': 0.512214964126001, 'support': 135401}, 'weighted avg': {'precision': 0.8412304938239449, 'recall': 0.6566347368187827, 'f1-score': 0.7097777346794232, 'support': 135401}}
[[ 8368  1497   761]
 [26231 74023 13622]
 [ 1900  2481  6518]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8558657
{'0': {'precision': 0.2576823398741207, 'recall': 0.7817296892549607, 'f1-score': 0.38759977724150735, 'support': 5342}, '1': {'precision': 0.9257140801496511, 'recall': 0.6101771275460602, 'f1-score': 0.7355332923639794, 'support': 42173}, '2': {'precision': 0.32650363516192993, 'recall': 0.5324232081911263, 'f1-score': 0.40477978832365996, 'support': 5567}, 'accuracy': 0.6192871406503146, 'macro avg': {'precision': 0.503300018395234, 'recall': 0.6414433416640491, 'f1-score': 0.5093042859763822, 'support': 53082}, 'weighted avg': {'precision': 0.7956430560021335, 'recall': 0.6192871406503146, 'f1-score': 0.6658304628779632, 'support': 53082}}
[[ 4176   725   441]
 [10767 25733  5673]
 [ 1263  1340  2964]]
training model: results/QRTEA/W10/deepVOL_L3/h30
Epoch 1/50
529/529 - 24s - loss: 2.9650 - accuracy30: 0.3747 - val_loss: 3.6307 - val_accuracy30: 0.5827 - 24s/epoch - 46ms/step
Epoch 2/50
529/529 - 22s - loss: 2.6632 - accuracy30: 0.4317 - val_loss: 3.0795 - val_accuracy30: 0.5353 - 22s/epoch - 42ms/step
Epoch 3/50
529/529 - 22s - loss: 2.4106 - accuracy30: 0.5794 - val_loss: 2.9373 - val_accuracy30: 0.6191 - 22s/epoch - 42ms/step
Epoch 4/50
529/529 - 21s - loss: 2.3022 - accuracy30: 0.6291 - val_loss: 2.9521 - val_accuracy30: 0.6385 - 21s/epoch - 40ms/step
Epoch 5/50
529/529 - 22s - loss: 2.2413 - accuracy30: 0.6441 - val_loss: 3.0143 - val_accuracy30: 0.6158 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 21s - loss: 2.1937 - accuracy30: 0.6551 - val_loss: 3.0796 - val_accuracy30: 0.6271 - 21s/epoch - 40ms/step
Epoch 7/50
529/529 - 21s - loss: 2.1567 - accuracy30: 0.6561 - val_loss: 3.0058 - val_accuracy30: 0.6432 - 21s/epoch - 41ms/step
Epoch 8/50
529/529 - 22s - loss: 2.1350 - accuracy30: 0.6596 - val_loss: 3.0944 - val_accuracy30: 0.6211 - 22s/epoch - 42ms/step
Epoch 9/50
529/529 - 21s - loss: 2.1090 - accuracy30: 0.6622 - val_loss: 3.0075 - val_accuracy30: 0.6119 - 21s/epoch - 40ms/step
Epoch 10/50
529/529 - 22s - loss: 2.0939 - accuracy30: 0.6606 - val_loss: 2.9993 - val_accuracy30: 0.6312 - 22s/epoch - 42ms/step
Epoch 11/50
529/529 - 22s - loss: 2.0763 - accuracy30: 0.6619 - val_loss: 3.0454 - val_accuracy30: 0.6114 - 22s/epoch - 41ms/step
Epoch 12/50
529/529 - 22s - loss: 2.0575 - accuracy30: 0.6606 - val_loss: 3.0963 - val_accuracy30: 0.6247 - 22s/epoch - 41ms/step
Epoch 13/50
529/529 - 21s - loss: 2.0429 - accuracy30: 0.6642 - val_loss: 3.1122 - val_accuracy30: 0.5977 - 21s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h30
Evaluating performance on  test set...
1840/1840 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95383424
{'0': {'precision': 0.2996140483734896, 'recall': 0.6698995960076045, 'f1-score': 0.4140453950841117, 'support': 67328}, '1': {'precision': 0.8511487143046714, 'recall': 0.5908892342713141, 'f1-score': 0.6975331162999551, 'support': 336503}, '2': {'precision': 0.3358749611269163, 'recall': 0.4343571258341277, 'f1-score': 0.37882006014666436, 'support': 67136}, 'accuracy': 0.5798707765087575, 'macro avg': {'precision': 0.49554590793502573, 'recall': 0.5650486520376822, 'f1-score': 0.496799523843577, 'support': 470967}, 'weighted avg': {'precision': 0.6988511123895556, 'recall': 0.5798707765087575, 'f1-score': 0.6115742677353472, 'support': 470967}}
[[ 45103  15615   6610]
 [ 86617 198836  51050]
 [ 18817  19158  29161]]
Evaluating performance on  train set...
529/529 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83519286
{'0': {'precision': 0.25944383259911896, 'recall': 0.7252366658970215, 'f1-score': 0.3821710299515341, 'support': 12993}, '1': {'precision': 0.9128085006150384, 'recall': 0.6395434124873934, 'f1-score': 0.7521241266281377, 'support': 109070}, '2': {'precision': 0.32131668358116755, 'recall': 0.545958914379967, 'f1-score': 0.40454431821338294, 'support': 13338}, 'accuracy': 0.638547721213285, 'macro avg': {'precision': 0.497856338931775, 'recall': 0.6369129975881274, 'f1-score': 0.5129464915976849, 'support': 135401}, 'weighted avg': {'precision': 0.7918456939361467, 'recall': 0.638547721213285, 'f1-score': 0.6823844639243531, 'support': 135401}}
[[ 9423  2725   845]
 [24779 69755 14536]
 [ 2118  3938  7282]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88135767
{'0': {'precision': 0.30771750524109015, 'recall': 0.7220599538816295, 'f1-score': 0.4315310763011622, 'support': 6505}, '1': {'precision': 0.8842391888502741, 'recall': 0.6203654827438856, 'f1-score': 0.7291635890920909, 'support': 39783}, '2': {'precision': 0.346017967093974, 'recall': 0.5045628495731528, 'f1-score': 0.4105143404586552, 'support': 6794}, 'accuracy': 0.6180061037639878, 'macro avg': {'precision': 0.5126582203951128, 'recall': 0.6156627620662226, 'f1-score': 0.5237363352839695, 'support': 53082}, 'weighted avg': {'precision': 0.7447013317143327, 'recall': 0.6180061037639878, 'f1-score': 0.6519057146540413, 'support': 53082}}
[[ 4697  1312   496]
 [ 9120 24680  5983]
 [ 1447  1919  3428]]
training model: results/QRTEA/W10/deepVOL_L3/h50
Epoch 1/50
529/529 - 25s - loss: 3.0445 - accuracy50: 0.3796 - val_loss: 3.6854 - val_accuracy50: 0.5552 - 25s/epoch - 46ms/step
Epoch 2/50
529/529 - 21s - loss: 2.7165 - accuracy50: 0.4637 - val_loss: 3.0987 - val_accuracy50: 0.5421 - 21s/epoch - 40ms/step
Epoch 3/50
529/529 - 22s - loss: 2.5578 - accuracy50: 0.5573 - val_loss: 3.0697 - val_accuracy50: 0.5943 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 22s - loss: 2.4875 - accuracy50: 0.5792 - val_loss: 3.0269 - val_accuracy50: 0.5673 - 22s/epoch - 41ms/step
Epoch 5/50
529/529 - 21s - loss: 2.4187 - accuracy50: 0.5942 - val_loss: 3.0491 - val_accuracy50: 0.5735 - 21s/epoch - 40ms/step
Epoch 6/50
529/529 - 22s - loss: 2.3817 - accuracy50: 0.6026 - val_loss: 3.0379 - val_accuracy50: 0.5797 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 22s - loss: 2.3572 - accuracy50: 0.6024 - val_loss: 3.0400 - val_accuracy50: 0.6069 - 22s/epoch - 42ms/step
Epoch 8/50
529/529 - 21s - loss: 2.3298 - accuracy50: 0.6102 - val_loss: 3.0598 - val_accuracy50: 0.6133 - 21s/epoch - 40ms/step
Epoch 9/50
529/529 - 21s - loss: 2.3124 - accuracy50: 0.6095 - val_loss: 3.0640 - val_accuracy50: 0.6182 - 21s/epoch - 40ms/step
Epoch 10/50
529/529 - 21s - loss: 2.2897 - accuracy50: 0.6155 - val_loss: 3.0267 - val_accuracy50: 0.5933 - 21s/epoch - 40ms/step
Epoch 11/50
529/529 - 21s - loss: 2.2754 - accuracy50: 0.6167 - val_loss: 3.1205 - val_accuracy50: 0.6161 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 2.2607 - accuracy50: 0.6172 - val_loss: 3.0857 - val_accuracy50: 0.6078 - 21s/epoch - 41ms/step
Epoch 13/50
529/529 - 21s - loss: 2.2401 - accuracy50: 0.6216 - val_loss: 3.0870 - val_accuracy50: 0.5962 - 21s/epoch - 40ms/step
Epoch 14/50
529/529 - 22s - loss: 2.2270 - accuracy50: 0.6233 - val_loss: 3.1319 - val_accuracy50: 0.6002 - 22s/epoch - 41ms/step
Epoch 15/50
529/529 - 22s - loss: 2.2199 - accuracy50: 0.6230 - val_loss: 3.1007 - val_accuracy50: 0.5930 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 21s - loss: 2.2032 - accuracy50: 0.6245 - val_loss: 3.1099 - val_accuracy50: 0.6041 - 21s/epoch - 40ms/step
Epoch 17/50
529/529 - 21s - loss: 2.1902 - accuracy50: 0.6264 - val_loss: 3.2008 - val_accuracy50: 0.5954 - 21s/epoch - 40ms/step
Epoch 18/50
529/529 - 21s - loss: 2.1823 - accuracy50: 0.6259 - val_loss: 3.1790 - val_accuracy50: 0.5913 - 21s/epoch - 40ms/step
Epoch 19/50
529/529 - 21s - loss: 2.1716 - accuracy50: 0.6269 - val_loss: 3.1555 - val_accuracy50: 0.5870 - 21s/epoch - 40ms/step
Epoch 20/50
529/529 - 21s - loss: 2.1566 - accuracy50: 0.6270 - val_loss: 3.1902 - val_accuracy50: 0.5880 - 21s/epoch - 40ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h50
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9302706
{'0': {'precision': 0.3620390714915624, 'recall': 0.563041911713429, 'f1-score': 0.44070340787103585, 'support': 86038}, '1': {'precision': 0.7811826234533159, 'recall': 0.6051081867814936, 'f1-score': 0.6819636938125276, 'support': 298188}, '2': {'precision': 0.3956659728958496, 'recall': 0.48434996137927855, 'f1-score': 0.43553938338413056, 'support': 86741}, 'accuracy': 0.575182549945113, 'macro avg': {'precision': 0.5129625559469093, 'recall': 0.5508333532914004, 'f1-score': 0.5194021616892314, 'support': 470967}, 'weighted avg': {'precision': 0.6336088598781812, 'recall': 0.575182549945113, 'f1-score': 0.5925038301857689, 'support': 470967}}
[[ 48443  22397  15198]
 [ 68780 180436  48972]
 [ 16583  28145  42013]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8150438
{'0': {'precision': 0.31637550393549624, 'recall': 0.6685985858351686, 'f1-score': 0.4295102109201928, 'support': 17254}, '1': {'precision': 0.8624358856027742, 'recall': 0.6511433435207216, 'f1-score': 0.7420416127787989, 'support': 100451}, '2': {'precision': 0.4104429146642421, 'recall': 0.5357142857142857, 'f1-score': 0.46478562498467874, 'support': 17696}, 'accuracy': 0.6382818442995252, 'macro avg': {'precision': 0.5297514347341709, 'recall': 0.6184854050233919, 'f1-score': 0.5454458162278901, 'support': 135401}, 'weighted avg': {'precision': 0.7337795725842922, 'recall': 0.6382818442995252, 'f1-score': 0.6659805883574642, 'support': 135401}}
[[11536  4320  1398]
 [22824 65408 12219]
 [ 2103  6113  9480]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8962488
{'0': {'precision': 0.35114598903836575, 'recall': 0.6594923382851795, 'f1-score': 0.4582808372282056, 'support': 8549}, '1': {'precision': 0.8203415851084245, 'recall': 0.598745027732646, 'f1-score': 0.6922416724693538, 'support': 35698}, '2': {'precision': 0.41199526023151944, 'recall': 0.511601584606678, 'f1-score': 0.4564273452489145, 'support': 8835}, 'accuracy': 0.5940243397008402, 'macro avg': {'precision': 0.5278276114594366, 'recall': 0.5899463168748346, 'f1-score': 0.5356499516488246, 'support': 53082}, 'weighted avg': {'precision': 0.676810954553992, 'recall': 0.5940243397008402, 'f1-score': 0.6153125672836193, 'support': 53082}}
[[ 5638  1800  1111]
 [ 8984 21374  5340]
 [ 1434  2881  4520]]
training model: results/QRTEA/W10/deepVOL_L3/h100
Epoch 1/50
529/529 - 25s - loss: 3.1733 - accuracy100: 0.3893 - val_loss: 3.6067 - val_accuracy100: 0.4686 - 25s/epoch - 46ms/step
Epoch 2/50
529/529 - 21s - loss: 3.0331 - accuracy100: 0.3979 - val_loss: 3.5629 - val_accuracy100: 0.4821 - 21s/epoch - 40ms/step
Epoch 3/50
529/529 - 21s - loss: 2.9767 - accuracy100: 0.4032 - val_loss: 3.4531 - val_accuracy100: 0.4882 - 21s/epoch - 40ms/step
Epoch 4/50
529/529 - 21s - loss: 2.8930 - accuracy100: 0.4656 - val_loss: 3.3800 - val_accuracy100: 0.5290 - 21s/epoch - 40ms/step
Epoch 5/50
529/529 - 22s - loss: 2.8128 - accuracy100: 0.5113 - val_loss: 3.3850 - val_accuracy100: 0.5187 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 22s - loss: 2.7755 - accuracy100: 0.5299 - val_loss: 3.4448 - val_accuracy100: 0.5009 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 21s - loss: 2.7232 - accuracy100: 0.5410 - val_loss: 3.3560 - val_accuracy100: 0.4981 - 21s/epoch - 41ms/step
Epoch 8/50
529/529 - 21s - loss: 2.6969 - accuracy100: 0.5481 - val_loss: 3.4757 - val_accuracy100: 0.5109 - 21s/epoch - 40ms/step
Epoch 9/50
529/529 - 21s - loss: 2.6634 - accuracy100: 0.5545 - val_loss: 3.4546 - val_accuracy100: 0.5037 - 21s/epoch - 40ms/step
Epoch 10/50
529/529 - 21s - loss: 2.6342 - accuracy100: 0.5596 - val_loss: 3.4388 - val_accuracy100: 0.5093 - 21s/epoch - 40ms/step
Epoch 11/50
529/529 - 21s - loss: 2.6131 - accuracy100: 0.5622 - val_loss: 3.4266 - val_accuracy100: 0.5156 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 2.5948 - accuracy100: 0.5633 - val_loss: 3.4578 - val_accuracy100: 0.5286 - 21s/epoch - 40ms/step
Epoch 13/50
529/529 - 21s - loss: 2.5780 - accuracy100: 0.5688 - val_loss: 3.4525 - val_accuracy100: 0.5239 - 21s/epoch - 40ms/step
Epoch 14/50
529/529 - 21s - loss: 2.5612 - accuracy100: 0.5683 - val_loss: 3.5213 - val_accuracy100: 0.5212 - 21s/epoch - 40ms/step
Epoch 15/50
529/529 - 22s - loss: 2.5487 - accuracy100: 0.5694 - val_loss: 3.5805 - val_accuracy100: 0.5100 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 21s - loss: 2.5366 - accuracy100: 0.5687 - val_loss: 3.6164 - val_accuracy100: 0.5154 - 21s/epoch - 40ms/step
Epoch 17/50
529/529 - 21s - loss: 2.5075 - accuracy100: 0.5746 - val_loss: 3.6011 - val_accuracy100: 0.5125 - 21s/epoch - 40ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h100
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0477318
{'0': {'precision': 0.3697259299066099, 'recall': 0.6358436368177844, 'f1-score': 0.46757158863398407, 'support': 120105}, '1': {'precision': 0.6204858759530728, 'recall': 0.4960484145627931, 'f1-score': 0.551332883619581, 'support': 229022}, '2': {'precision': 0.47589828090799535, 'recall': 0.3176378857518056, 'f1-score': 0.3809866018251445, 'support': 121840}, 'accuracy': 0.4855435731165878, 'macro avg': {'precision': 0.48870336225589267, 'recall': 0.4831766457107944, 'f1-score': 0.46663035802623654, 'support': 470967}, 'weighted avg': {'precision': 0.5191325414302662, 'recall': 0.4855435731165878, 'f1-score': 0.4859033709189475, 'support': 470967}}
[[ 76368  28665  15072]
 [ 87867 113606  27549]
 [ 42318  40821  38701]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9703841
{'0': {'precision': 0.32461485915619553, 'recall': 0.6935781225994776, 'f1-score': 0.4422457601175534, 'support': 26036}, '1': {'precision': 0.7349091349229678, 'recall': 0.5111977099420268, 'f1-score': 0.6029721581840752, 'support': 83142}, '2': {'precision': 0.470121701080268, 'recall': 0.3933188422377302, 'f1-score': 0.428304472405631, 'support': 26223}, 'accuracy': 0.5234377884949151, 'macro avg': {'precision': 0.5098818983864771, 'recall': 0.5326982249264115, 'f1-score': 0.49117413023575324, 'support': 135401}, 'weighted avg': {'precision': 0.604733267377523, 'recall': 0.5234377884949151, 'f1-score': 0.538238639050331, 'support': 135401}}
[[18058  6055  1923]
 [30938 42502  9702]
 [ 6633  9276 10314]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0270773
{'0': {'precision': 0.3612089824680562, 'recall': 0.688541835248422, 'f1-score': 0.4738410135041069, 'support': 12358}, '1': {'precision': 0.6679306608884074, 'recall': 0.48344323649973264, 'f1-score': 0.5609065155807366, 'support': 28055}, '2': {'precision': 0.46653650070506564, 'recall': 0.3394900939300655, 'f1-score': 0.393000730994152, 'support': 12669}, 'accuracy': 0.49683508533966314, 'macro avg': {'precision': 0.4985587146871764, 'recall': 0.5038250552260735, 'f1-score': 0.4759160866929985, 'support': 53082}, 'weighted avg': {'precision': 0.548456467804472, 'recall': 0.49683508533966314, 'f1-score': 0.5005630119525682, 'support': 53082}}
[[ 8509  2596  1253]
 [10827 13563  3665]
 [ 4221  4147  4301]]
training model: results/QRTEA/W10/deepVOL_L3/h200
Epoch 1/50
529/529 - 25s - loss: 3.2859 - accuracy200: 0.3967 - val_loss: 3.6449 - val_accuracy200: 0.4015 - 25s/epoch - 46ms/step
Epoch 2/50
529/529 - 22s - loss: 3.2010 - accuracy200: 0.3960 - val_loss: 3.3691 - val_accuracy200: 0.3743 - 22s/epoch - 41ms/step
Epoch 3/50
529/529 - 22s - loss: 3.1661 - accuracy200: 0.3884 - val_loss: 3.3620 - val_accuracy200: 0.3718 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 21s - loss: 3.1414 - accuracy200: 0.3991 - val_loss: 3.3693 - val_accuracy200: 0.3759 - 21s/epoch - 40ms/step
Epoch 5/50
529/529 - 21s - loss: 3.1105 - accuracy200: 0.4182 - val_loss: 3.3979 - val_accuracy200: 0.3810 - 21s/epoch - 41ms/step
Epoch 6/50
529/529 - 21s - loss: 3.0854 - accuracy200: 0.4430 - val_loss: 3.3373 - val_accuracy200: 0.3979 - 21s/epoch - 41ms/step
Epoch 7/50
529/529 - 21s - loss: 3.0470 - accuracy200: 0.4617 - val_loss: 3.3260 - val_accuracy200: 0.4200 - 21s/epoch - 40ms/step
Epoch 8/50
529/529 - 23s - loss: 3.0118 - accuracy200: 0.4772 - val_loss: 3.4116 - val_accuracy200: 0.4232 - 23s/epoch - 43ms/step
Epoch 9/50
529/529 - 22s - loss: 2.9803 - accuracy200: 0.4945 - val_loss: 3.4282 - val_accuracy200: 0.4291 - 22s/epoch - 41ms/step
Epoch 10/50
529/529 - 22s - loss: 2.9486 - accuracy200: 0.5033 - val_loss: 3.4499 - val_accuracy200: 0.4337 - 22s/epoch - 41ms/step
Epoch 11/50
529/529 - 21s - loss: 2.9166 - accuracy200: 0.5096 - val_loss: 3.4388 - val_accuracy200: 0.4272 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 2.8858 - accuracy200: 0.5162 - val_loss: 3.5100 - val_accuracy200: 0.4234 - 21s/epoch - 40ms/step
Epoch 13/50
529/529 - 22s - loss: 2.8632 - accuracy200: 0.5205 - val_loss: 3.4935 - val_accuracy200: 0.4127 - 22s/epoch - 42ms/step
Epoch 14/50
529/529 - 22s - loss: 2.8404 - accuracy200: 0.5261 - val_loss: 3.5375 - val_accuracy200: 0.4147 - 22s/epoch - 41ms/step
Epoch 15/50
529/529 - 22s - loss: 2.8190 - accuracy200: 0.5291 - val_loss: 3.6107 - val_accuracy200: 0.4063 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 22s - loss: 2.7987 - accuracy200: 0.5343 - val_loss: 3.5739 - val_accuracy200: 0.4019 - 22s/epoch - 41ms/step
Epoch 17/50
529/529 - 22s - loss: 2.7586 - accuracy200: 0.5434 - val_loss: 3.6912 - val_accuracy200: 0.4029 - 22s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h200
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997831
{'0': {'precision': 0.39017619398334374, 'recall': 0.5828120219504098, 'f1-score': 0.4674247289092153, 'support': 153619}, '1': {'precision': 0.45594649607444027, 'recall': 0.23742287163568915, 'f1-score': 0.312249520822443, 'support': 158502}, '2': {'precision': 0.40550299431332093, 'recall': 0.4058144366241517, 'f1-score': 0.40565865569169385, 'support': 158846}, 'accuracy': 0.4068756409684755, 'macro avg': {'precision': 0.41720856145703494, 'recall': 0.40868311007008357, 'f1-score': 0.3951109684744507, 'support': 470967}, 'weighted avg': {'precision': 0.4174802839668426, 'recall': 0.4068756409684755, 'f1-score': 0.39436892139301993, 'support': 470967}}
[[89531 20294 43794]
 [70158 37632 50712]
 [69774 24610 64462]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0446353
{'0': {'precision': 0.3621639385308754, 'recall': 0.6489540687566597, 'f1-score': 0.46488690691414564, 'support': 35662}, '1': {'precision': 0.5930899303727107, 'recall': 0.3172067406236798, 'f1-score': 0.413342440337231, 'support': 63911}, '2': {'precision': 0.4235603076345901, 'recall': 0.4411633359383722, 'f1-score': 0.4321826508988994, 'support': 35828}, 'accuracy': 0.4373822940746376, 'macro avg': {'precision': 0.4596047255127254, 'recall': 0.4691080484395706, 'f1-score': 0.43680399938342535, 'support': 135401}, 'weighted avg': {'precision': 0.48740983905488505, 'recall': 0.4373822940746376, 'f1-score': 0.431903498461391, 'support': 135401}}
[[23143  6300  6219]
 [28346 20273 15292]
 [12413  7609 15806]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.078829
{'0': {'precision': 0.37700630127214363, 'recall': 0.6008716523496715, 'f1-score': 0.4633142578838427, 'support': 15832}, '1': {'precision': 0.5244793569601753, 'recall': 0.26865671641791045, 'f1-score': 0.3553107886513412, 'support': 21373}, '2': {'precision': 0.41494586119164545, 'recall': 0.441708131259054, 'f1-score': 0.42790896332906214, 'support': 15877}, 'accuracy': 0.41950190271655174, 'macro avg': {'precision': 0.4388105064746548, 'recall': 0.437078833342212, 'f1-score': 0.4155113366214153, 'support': 53082}, 'weighted avg': {'precision': 0.44773287547926155, 'recall': 0.41950190271655174, 'f1-score': 0.40923777226626035, 'support': 53082}}
[[9513 2517 3802]
 [9545 5742 6086]
 [6175 2689 7013]]
training model: results/QRTEA/W10/deepVOL_L3/h300
Epoch 1/50
529/529 - 24s - loss: 3.3021 - accuracy300: 0.3842 - val_loss: 3.4228 - val_accuracy300: 0.3534 - 24s/epoch - 46ms/step
Epoch 2/50
529/529 - 22s - loss: 3.2398 - accuracy300: 0.3936 - val_loss: 3.4501 - val_accuracy300: 0.3458 - 22s/epoch - 42ms/step
Epoch 3/50
529/529 - 22s - loss: 3.2125 - accuracy300: 0.4001 - val_loss: 3.3391 - val_accuracy300: 0.3754 - 22s/epoch - 42ms/step
Epoch 4/50
529/529 - 22s - loss: 3.1964 - accuracy300: 0.4050 - val_loss: 3.3463 - val_accuracy300: 0.3812 - 22s/epoch - 41ms/step
Epoch 5/50
529/529 - 22s - loss: 3.1768 - accuracy300: 0.4147 - val_loss: 3.3383 - val_accuracy300: 0.3804 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 22s - loss: 3.1515 - accuracy300: 0.4327 - val_loss: 3.3185 - val_accuracy300: 0.3950 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 22s - loss: 3.1094 - accuracy300: 0.4505 - val_loss: 3.3407 - val_accuracy300: 0.4009 - 22s/epoch - 42ms/step
Epoch 8/50
529/529 - 22s - loss: 3.0805 - accuracy300: 0.4602 - val_loss: 3.3724 - val_accuracy300: 0.3927 - 22s/epoch - 41ms/step
Epoch 9/50
529/529 - 22s - loss: 3.0598 - accuracy300: 0.4684 - val_loss: 3.3676 - val_accuracy300: 0.3972 - 22s/epoch - 41ms/step
Epoch 10/50
529/529 - 22s - loss: 3.0305 - accuracy300: 0.4778 - val_loss: 3.4326 - val_accuracy300: 0.3961 - 22s/epoch - 41ms/step
Epoch 11/50
529/529 - 22s - loss: 3.0024 - accuracy300: 0.4833 - val_loss: 3.4711 - val_accuracy300: 0.3945 - 22s/epoch - 41ms/step
Epoch 12/50
529/529 - 22s - loss: 2.9777 - accuracy300: 0.4926 - val_loss: 3.5073 - val_accuracy300: 0.3901 - 22s/epoch - 41ms/step
Epoch 13/50
529/529 - 22s - loss: 2.9465 - accuracy300: 0.5016 - val_loss: 3.5125 - val_accuracy300: 0.3816 - 22s/epoch - 41ms/step
Epoch 14/50
529/529 - 22s - loss: 2.9319 - accuracy300: 0.5060 - val_loss: 3.6240 - val_accuracy300: 0.3860 - 22s/epoch - 41ms/step
Epoch 15/50
529/529 - 22s - loss: 2.8954 - accuracy300: 0.5205 - val_loss: 3.6408 - val_accuracy300: 0.3813 - 22s/epoch - 41ms/step
Epoch 16/50
529/529 - 22s - loss: 2.8552 - accuracy300: 0.5291 - val_loss: 3.7698 - val_accuracy300: 0.3780 - 22s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h300
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1053556
{'0': {'precision': 0.4009969147899143, 'recall': 0.71062379787714, 'f1-score': 0.5126891704659584, 'support': 168452}, '1': {'precision': 0.32206972109835313, 'recall': 0.30001125022098646, 'f1-score': 0.3106493981968788, 'support': 124442}, '2': {'precision': 0.4210908061634263, 'recall': 0.13366989942327023, 'f1-score': 0.20292412617220804, 'support': 178073}, 'accuracy': 0.38398231723241755, 'macro avg': {'precision': 0.38138581401723126, 'recall': 0.3814349825071323, 'f1-score': 0.3420875649450151, 'support': 470967}, 'weighted avg': {'precision': 0.3877397687078961, 'recall': 0.38398231723241755, 'f1-score': 0.34218248088212383, 'support': 470967}}
[[119706  32653  16093]
 [ 70477  37334  16631]
 [108338  45932  23803]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0573115
{'0': {'precision': 0.3805286465541102, 'recall': 0.6822738325641408, 'f1-score': 0.4885663012384286, 'support': 40302}, '1': {'precision': 0.4600040749796251, 'recall': 0.415859274267821, 'f1-score': 0.4368191931895134, 'support': 54290}, '2': {'precision': 0.435175307588365, 'recall': 0.14994241466343208, 'f1-score': 0.22303626754146164, 'support': 40809}, 'accuracy': 0.41501170596967524, 'macro avg': {'precision': 0.4252360097073667, 'recall': 0.41602517383179793, 'f1-score': 0.38280725398980125, 'support': 135401}, 'weighted avg': {'precision': 0.4288650443603901, 'recall': 0.41501170596967524, 'f1-score': 0.38778886502218846, 'support': 135401}}
[[27497 10335  2470]
 [26241 22577  5472]
 [18522 16168  6119]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0826427
{'0': {'precision': 0.3852421315460937, 'recall': 0.6676916068784876, 'f1-score': 0.48858333333333326, 'support': 17562}, '1': {'precision': 0.3947872977831037, 'recall': 0.3731241859674953, 'f1-score': 0.3836501790445137, 'support': 17659}, '2': {'precision': 0.43029895868323814, 'recall': 0.14344101674038406, 'f1-score': 0.21515851354188534, 'support': 17861}, 'accuracy': 0.3932971628800723, 'macro avg': {'precision': 0.4034427960041452, 'recall': 0.39475226986212236, 'f1-score': 0.36246400863991074, 'support': 53082}, 'weighted avg': {'precision': 0.40357825452706464, 'recall': 0.3932971628800723, 'f1-score': 0.3616729818416541, 'support': 53082}}
[[11726  4407  1429]
 [ 9107  6589  1963]
 [ 9605  5694  2562]]
training model: results/QRTEA/W10/deepVOL_L3/h500
Epoch 1/50
529/529 - 25s - loss: 3.2963 - accuracy500: 0.3867 - val_loss: 3.3838 - val_accuracy500: 0.3388 - 25s/epoch - 47ms/step
Epoch 2/50
529/529 - 22s - loss: 3.2624 - accuracy500: 0.3944 - val_loss: 3.3563 - val_accuracy500: 0.3280 - 22s/epoch - 41ms/step
Epoch 3/50
529/529 - 22s - loss: 3.2530 - accuracy500: 0.3970 - val_loss: 3.2772 - val_accuracy500: 0.3867 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 22s - loss: 3.2361 - accuracy500: 0.4055 - val_loss: 3.2912 - val_accuracy500: 0.3852 - 22s/epoch - 42ms/step
Epoch 5/50
529/529 - 22s - loss: 3.2188 - accuracy500: 0.4143 - val_loss: 3.2970 - val_accuracy500: 0.3639 - 22s/epoch - 41ms/step
Epoch 6/50
529/529 - 22s - loss: 3.2305 - accuracy500: 0.4056 - val_loss: 3.2961 - val_accuracy500: 0.3776 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 22s - loss: 3.2010 - accuracy500: 0.4205 - val_loss: 3.2948 - val_accuracy500: 0.3775 - 22s/epoch - 41ms/step
Epoch 8/50
529/529 - 21s - loss: 3.1656 - accuracy500: 0.4362 - val_loss: 3.3197 - val_accuracy500: 0.3744 - 21s/epoch - 41ms/step
Epoch 9/50
529/529 - 22s - loss: 3.1471 - accuracy500: 0.4492 - val_loss: 3.3229 - val_accuracy500: 0.3746 - 22s/epoch - 42ms/step
Epoch 10/50
529/529 - 22s - loss: 3.1105 - accuracy500: 0.4597 - val_loss: 3.3214 - val_accuracy500: 0.3785 - 22s/epoch - 41ms/step
Epoch 11/50
529/529 - 22s - loss: 3.0914 - accuracy500: 0.4704 - val_loss: 3.3343 - val_accuracy500: 0.3810 - 22s/epoch - 41ms/step
Epoch 12/50
529/529 - 22s - loss: 3.0502 - accuracy500: 0.4845 - val_loss: 3.3658 - val_accuracy500: 0.3800 - 22s/epoch - 41ms/step
Epoch 13/50
529/529 - 22s - loss: 3.0011 - accuracy500: 0.4989 - val_loss: 3.4006 - val_accuracy500: 0.3773 - 22s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h500
Evaluating performance on  test set...
1840/1840 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098911
{'0': {'precision': 0.3924683470457832, 'recall': 0.624714383800637, 'f1-score': 0.48207782957923556, 'support': 177686}, '1': {'precision': 0.22197428894957702, 'recall': 0.06687805416470163, 'f1-score': 0.10278752361491306, 'support': 99659}, '2': {'precision': 0.42273003263591974, 'recall': 0.34519321151522037, 'f1-score': 0.38004719529184317, 'support': 193622}, 'accuracy': 0.3917578089335346, 'macro avg': {'precision': 0.3457242228770933, 'recall': 0.34559521649351965, 'f1-score': 0.32163751616199726, 'support': 470967}, 'weighted avg': {'precision': 0.36883200044723935, 'recall': 0.3917578089335346, 'f1-score': 0.3598716706039955, 'support': 470967}}
[[111003  11316  55367]
 [ 57090   6665  35904]
 [114740  12045  66837]]
Evaluating performance on  train set...
529/529 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0838305
{'0': {'precision': 0.3805427367576244, 'recall': 0.6825768140717081, 'f1-score': 0.48865557720487596, 'support': 44458}, '1': {'precision': 0.3873690337601863, 'recall': 0.08921310156843469, 'f1-score': 0.14502596883739513, 'support': 44758}, '2': {'precision': 0.4191492645923835, 'recall': 0.4115621955180253, 'f1-score': 0.4153210828763082, 'support': 46185}, 'accuracy': 0.3939926588429923, 'macro avg': {'precision': 0.3956870117033981, 'recall': 0.3944507037193894, 'f1-score': 0.34966754297285974, 'support': 135401}, 'weighted avg': {'precision': 0.39596783619772463, 'recall': 0.3939926588429923, 'f1-score': 0.3500515223465174, 'support': 135401}}
[[30346  3055 11057]
 [25481  3993 15284]
 [23917  3260 19008]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0928161
{'0': {'precision': 0.3925015608057043, 'recall': 0.6245425075813029, 'f1-score': 0.4820516959583527, 'support': 19126}, '1': {'precision': 0.2708516242317823, 'recall': 0.08468295360966237, 'f1-score': 0.1290255123379339, 'support': 14572}, '2': {'precision': 0.41054551483999335, 'recall': 0.38320264135369375, 'f1-score': 0.3964031272513809, 'support': 19384}, 'accuracy': 0.3882106928902453, 'macro avg': {'precision': 0.3579662332924933, 'recall': 0.36414270084821965, 'f1-score': 0.3358267785158891, 'support': 53082}, 'weighted avg': {'precision': 0.36569550845736526, 'recall': 0.3882106928902453, 'f1-score': 0.3538630556747785, 'support': 53082}}
[[11945  1714  5467]
 [ 8140  1234  5198]
 [10348  1608  7428]]
training model: results/QRTEA/W10/deepVOL_L3/h1000
Epoch 1/50
529/529 - 24s - loss: 3.2956 - accuracy1000: 0.3791 - val_loss: 3.3282 - val_accuracy1000: 0.3292 - 24s/epoch - 46ms/step
Epoch 2/50
529/529 - 22s - loss: 3.2971 - accuracy1000: 0.3677 - val_loss: 3.3143 - val_accuracy1000: 0.3359 - 22s/epoch - 41ms/step
Epoch 3/50
529/529 - 22s - loss: 3.2860 - accuracy1000: 0.3766 - val_loss: 3.3230 - val_accuracy1000: 0.3464 - 22s/epoch - 41ms/step
Epoch 4/50
529/529 - 22s - loss: 3.2720 - accuracy1000: 0.3881 - val_loss: 3.3454 - val_accuracy1000: 0.3347 - 22s/epoch - 42ms/step
Epoch 5/50
529/529 - 21s - loss: 3.2822 - accuracy1000: 0.3912 - val_loss: 3.3350 - val_accuracy1000: 0.3425 - 21s/epoch - 41ms/step
Epoch 6/50
529/529 - 22s - loss: 3.2581 - accuracy1000: 0.3980 - val_loss: 3.3545 - val_accuracy1000: 0.3356 - 22s/epoch - 41ms/step
Epoch 7/50
529/529 - 21s - loss: 3.2431 - accuracy1000: 0.4046 - val_loss: 3.3341 - val_accuracy1000: 0.3457 - 21s/epoch - 40ms/step
Epoch 8/50
529/529 - 22s - loss: 3.2338 - accuracy1000: 0.4156 - val_loss: 3.3645 - val_accuracy1000: 0.3468 - 22s/epoch - 42ms/step
Epoch 9/50
529/529 - 22s - loss: 3.2151 - accuracy1000: 0.4217 - val_loss: 3.4320 - val_accuracy1000: 0.3231 - 22s/epoch - 42ms/step
Epoch 10/50
529/529 - 22s - loss: 3.1966 - accuracy1000: 0.4301 - val_loss: 3.4277 - val_accuracy1000: 0.3366 - 22s/epoch - 41ms/step
Epoch 11/50
529/529 - 21s - loss: 3.1610 - accuracy1000: 0.4501 - val_loss: 3.4321 - val_accuracy1000: 0.3426 - 21s/epoch - 40ms/step
Epoch 12/50
529/529 - 21s - loss: 3.1400 - accuracy1000: 0.4553 - val_loss: 3.5244 - val_accuracy1000: 0.3521 - 21s/epoch - 41ms/step
testing model: results/QRTEA/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
1840/1840 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977455
{'0': {'precision': 0.3404785443274729, 'recall': 0.3179785024049109, 'f1-score': 0.3288441005029016, 'support': 160297}, '1': {'precision': 0.2861165169144135, 'recall': 0.05169137778841694, 'f1-score': 0.08756312211317312, 'support': 133678}, '2': {'precision': 0.3761106922641967, 'recall': 0.6313675194359067, 'f1-score': 0.4714028989420042, 'support': 176992}, 'accuracy': 0.36016960848636953, 'macro avg': {'precision': 0.33423525116869435, 'recall': 0.33367913320974485, 'f1-score': 0.2959367071860263, 'support': 470967}, 'weighted avg': {'precision': 0.33843933144651456, 'recall': 0.36016960848636953, 'f1-score': 0.3139339437916066, 'support': 470967}}
[[ 50971   7746 101580]
 [ 42983   6910  83785]
 [ 55750   9495 111747]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984172
{'0': {'precision': 0.3418856193842354, 'recall': 0.35837518134136814, 'f1-score': 0.34993625437229625, 'support': 44805}, '1': {'precision': 0.3810923340680872, 'recall': 0.06950617559689992, 'f1-score': 0.1175692778480893, 'support': 44773}, '2': {'precision': 0.35252712753366805, 'recall': 0.6175283154747616, 'f1-score': 0.4488310122767504, 'support': 45823}, 'accuracy': 0.35055871079238704, 'macro avg': {'precision': 0.3585016936619969, 'recall': 0.34846989080434326, 'f1-score': 0.30544551483237864, 'support': 135401}, 'weighted avg': {'precision': 0.3584514354747484, 'recall': 0.35055871079238704, 'f1-score': 0.3065679472810449, 'support': 135401}}
[[16057  2735 26013]
 [15702  3112 25959]
 [15207  2319 28297]]
Evaluating performance on  val set...
208/208 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045066
{'0': {'precision': 0.31998873873873873, 'recall': 0.32889634816829677, 'f1-score': 0.32438140357886924, 'support': 17279}, '1': {'precision': 0.3398741206960385, 'recall': 0.052349452554744526, 'f1-score': 0.09072490981864902, 'support': 17536}, '2': {'precision': 0.3451764200974832, 'recall': 0.6164121092680791, 'f1-score': 0.4425404810564376, 'support': 18267}, 'accuracy': 0.33647940921593006, 'macro avg': {'precision': 0.3350130931774202, 'recall': 0.3325526366637068, 'f1-score': 0.2858822648179853, 'support': 53082}, 'weighted avg': {'precision': 0.3352257952434559, 'recall': 0.33647940921593006, 'f1-score': 0.2878532319520187, 'support': 53082}}
[[ 5683   866 10730]
 [ 5987   918 10631]
 [ 6090   917 11260]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        18 (peak)  12.40 (ave)

============================================
