This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-07-31.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-23.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-10.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-11.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-19.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-15.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-17.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-12.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-02.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-16.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-29.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-18.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-09.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-25.csv
data/WBA_orderbooks/WBA_orderbooks_2019-07-24.csv
training model: results/WBA/W5/deepLOB_L1/h10
Epoch 1/50
1664/1664 - 55s - loss: 2.9148 - accuracy10: 0.4325 - val_loss: 3.7999 - val_accuracy10: 0.4555 - 55s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 46s - loss: 2.8295 - accuracy10: 0.4364 - val_loss: 3.5786 - val_accuracy10: 0.4229 - 46s/epoch - 28ms/step
Epoch 3/50
1664/1664 - 47s - loss: 2.7379 - accuracy10: 0.4840 - val_loss: 3.4961 - val_accuracy10: 0.5174 - 47s/epoch - 29ms/step
Epoch 4/50
1664/1664 - 47s - loss: 2.6693 - accuracy10: 0.5215 - val_loss: 3.4771 - val_accuracy10: 0.5214 - 47s/epoch - 28ms/step
Epoch 5/50
1664/1664 - 41s - loss: 2.6118 - accuracy10: 0.5418 - val_loss: 3.5228 - val_accuracy10: 0.5229 - 41s/epoch - 25ms/step
Epoch 6/50
1664/1664 - 43s - loss: 2.5751 - accuracy10: 0.5537 - val_loss: 3.5064 - val_accuracy10: 0.5120 - 43s/epoch - 26ms/step
Epoch 7/50
1664/1664 - 44s - loss: 2.5488 - accuracy10: 0.5626 - val_loss: 3.4142 - val_accuracy10: 0.5117 - 44s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 44s - loss: 2.5287 - accuracy10: 0.5671 - val_loss: 3.2449 - val_accuracy10: 0.5018 - 44s/epoch - 27ms/step
Epoch 9/50
1664/1664 - 44s - loss: 2.5158 - accuracy10: 0.5705 - val_loss: 3.2683 - val_accuracy10: 0.4935 - 44s/epoch - 27ms/step
Epoch 10/50
1664/1664 - 46s - loss: 2.4973 - accuracy10: 0.5747 - val_loss: 3.3070 - val_accuracy10: 0.4757 - 46s/epoch - 27ms/step
Epoch 11/50
1664/1664 - 43s - loss: 2.4843 - accuracy10: 0.5773 - val_loss: 3.2937 - val_accuracy10: 0.4795 - 43s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 44s - loss: 2.4737 - accuracy10: 0.5799 - val_loss: 3.2507 - val_accuracy10: 0.4775 - 44s/epoch - 26ms/step
Epoch 13/50
1664/1664 - 48s - loss: 2.4664 - accuracy10: 0.5815 - val_loss: 3.3001 - val_accuracy10: 0.4640 - 48s/epoch - 29ms/step
Epoch 14/50
1664/1664 - 47s - loss: 2.4551 - accuracy10: 0.5837 - val_loss: 3.2722 - val_accuracy10: 0.4681 - 47s/epoch - 28ms/step
Epoch 15/50
1664/1664 - 46s - loss: 2.4484 - accuracy10: 0.5843 - val_loss: 3.2798 - val_accuracy10: 0.4691 - 46s/epoch - 28ms/step
Epoch 16/50
1664/1664 - 47s - loss: 2.4426 - accuracy10: 0.5851 - val_loss: 3.2847 - val_accuracy10: 0.4605 - 47s/epoch - 28ms/step
Epoch 17/50
1664/1664 - 46s - loss: 2.4359 - accuracy10: 0.5868 - val_loss: 3.3252 - val_accuracy10: 0.4614 - 46s/epoch - 28ms/step
Epoch 18/50
1664/1664 - 47s - loss: 2.4293 - accuracy10: 0.5878 - val_loss: 3.3246 - val_accuracy10: 0.4645 - 47s/epoch - 28ms/step
testing model: results/WBA/W5/deepLOB_L1/h10
Evaluating performance on  test set...
7459/7459 - 107s - 107s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0438917
{'0': {'precision': 0.41071327916173456, 'recall': 0.3327412784060183, 'f1-score': 0.36763850641711654, 'support': 416065}, '1': {'precision': 0.6737983906046107, 'recall': 0.46804287827958124, 'f1-score': 0.5523824487915172, 'support': 1059091}, '2': {'precision': 0.32375725348896706, 'recall': 0.6238749582464668, 'f1-score': 0.42629205825015015, 'support': 434095}, 'accuracy': 0.47398849077465455, 'macro avg': {'precision': 0.46942297441843744, 'recall': 0.4748863716440221, 'f1-score': 0.44877100448626134, 'support': 1909251}, 'weighted avg': {'precision': 0.5368799789820972, 'recall': 0.47398849077465455, 'f1-score': 0.48345453074089967, 'support': 1909251}}
[[138442 128639 148984]
 [146702 495700 416689]
 [ 51933 111341 270821]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95050144
{'0': {'precision': 0.3523745337501017, 'recall': 0.4545795233098486, 'f1-score': 0.39700462790225766, 'support': 66710}, '1': {'precision': 0.8439705909315928, 'recall': 0.4730719030376113, 'f1-score': 0.6062959629442628, 'support': 291907}, '2': {'precision': 0.2716685292232288, 'recall': 0.7111038517506608, 'f1-score': 0.3931419752326302, 'support': 67346}, 'accuracy': 0.5078093637240794, 'macro avg': {'precision': 0.48933788463497446, 'recall': 0.5462517593660402, 'f1-score': 0.4654808553597169, 'support': 425963}, 'weighted avg': {'precision': 0.6764991729389767, 'recall': 0.5078093637240794, 'f1-score': 0.5398186082982495, 'support': 425963}}
[[ 30325  13952  22433]
 [ 47856 138093 105958]
 [  7878  11578  47890]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9849604
{'0': {'precision': 0.38366854894993974, 'recall': 0.4817942793402916, 'f1-score': 0.42716869172082506, 'support': 25102}, '1': {'precision': 0.8120158954670977, 'recall': 0.44279033324355427, 'f1-score': 0.5730809757334242, 'support': 81682}, '2': {'precision': 0.3226168624026518, 'recall': 0.7129410838059231, 'f1-score': 0.44421814612600463, 'support': 25392}, 'accuracy': 0.502095690594359, 'macro avg': {'precision': 0.506100435606563, 'recall': 0.5458418987965897, 'f1-score': 0.481489271193418, 'support': 132176}, 'weighted avg': {'precision': 0.6366497522955227, 'recall': 0.502095690594359, 'f1-score': 0.5206147555219193, 'support': 132176}}
[[12094  4629  8379]
 [15883 36168 29631]
 [ 3545  3744 18103]]
training model: results/WBA/W5/deepLOB_L1/h20
Epoch 1/50
1664/1664 - 47s - loss: 2.9828 - accuracy20: 0.4552 - val_loss: 3.8491 - val_accuracy20: 0.4471 - 47s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 45s - loss: 2.9240 - accuracy20: 0.4519 - val_loss: 3.5871 - val_accuracy20: 0.4983 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 45s - loss: 2.8460 - accuracy20: 0.4841 - val_loss: 3.5847 - val_accuracy20: 0.5014 - 45s/epoch - 27ms/step
Epoch 4/50
1664/1664 - 45s - loss: 2.7659 - accuracy20: 0.5244 - val_loss: 3.5510 - val_accuracy20: 0.5246 - 45s/epoch - 27ms/step
Epoch 5/50
1664/1664 - 45s - loss: 2.7057 - accuracy20: 0.5493 - val_loss: 3.6973 - val_accuracy20: 0.5257 - 45s/epoch - 27ms/step
Epoch 6/50
1664/1664 - 42s - loss: 2.6664 - accuracy20: 0.5616 - val_loss: 3.6457 - val_accuracy20: 0.5300 - 42s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 44s - loss: 2.6419 - accuracy20: 0.5678 - val_loss: 3.6059 - val_accuracy20: 0.5302 - 44s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 48s - loss: 2.6211 - accuracy20: 0.5727 - val_loss: 3.6404 - val_accuracy20: 0.5122 - 48s/epoch - 29ms/step
Epoch 9/50
1664/1664 - 47s - loss: 2.6074 - accuracy20: 0.5751 - val_loss: 3.5820 - val_accuracy20: 0.5050 - 47s/epoch - 28ms/step
Epoch 10/50
1664/1664 - 46s - loss: 2.5948 - accuracy20: 0.5780 - val_loss: 3.6264 - val_accuracy20: 0.5103 - 46s/epoch - 28ms/step
Epoch 11/50
1664/1664 - 46s - loss: 2.5828 - accuracy20: 0.5799 - val_loss: 3.5804 - val_accuracy20: 0.5101 - 46s/epoch - 28ms/step
Epoch 12/50
1664/1664 - 51s - loss: 2.5754 - accuracy20: 0.5810 - val_loss: 3.4891 - val_accuracy20: 0.4978 - 51s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 41s - loss: 2.5675 - accuracy20: 0.5823 - val_loss: 3.5561 - val_accuracy20: 0.5082 - 41s/epoch - 25ms/step
Epoch 14/50
1664/1664 - 44s - loss: 2.5587 - accuracy20: 0.5838 - val_loss: 3.5694 - val_accuracy20: 0.5081 - 44s/epoch - 26ms/step
Epoch 15/50
1664/1664 - 47s - loss: 2.5534 - accuracy20: 0.5852 - val_loss: 3.5405 - val_accuracy20: 0.5162 - 47s/epoch - 28ms/step
Epoch 16/50
1664/1664 - 47s - loss: 2.5450 - accuracy20: 0.5851 - val_loss: 3.6310 - val_accuracy20: 0.5102 - 47s/epoch - 28ms/step
Epoch 17/50
1664/1664 - 45s - loss: 2.5399 - accuracy20: 0.5865 - val_loss: 3.5267 - val_accuracy20: 0.5108 - 45s/epoch - 27ms/step
Epoch 18/50
1664/1664 - 41s - loss: 2.5325 - accuracy20: 0.5872 - val_loss: 3.5990 - val_accuracy20: 0.5204 - 41s/epoch - 25ms/step
Epoch 19/50
1664/1664 - 44s - loss: 2.5301 - accuracy20: 0.5877 - val_loss: 3.6318 - val_accuracy20: 0.5154 - 44s/epoch - 26ms/step
Epoch 20/50
1664/1664 - 46s - loss: 2.5228 - accuracy20: 0.5892 - val_loss: 3.6283 - val_accuracy20: 0.5107 - 46s/epoch - 28ms/step
Epoch 21/50
1664/1664 - 43s - loss: 2.5196 - accuracy20: 0.5892 - val_loss: 3.6701 - val_accuracy20: 0.5100 - 43s/epoch - 26ms/step
Epoch 22/50
1664/1664 - 45s - loss: 2.5147 - accuracy20: 0.5902 - val_loss: 3.6984 - val_accuracy20: 0.5188 - 45s/epoch - 27ms/step
testing model: results/WBA/W5/deepLOB_L1/h20
Evaluating performance on  test set...
7459/7459 - 127s - 127s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1954119
{'0': {'precision': 0.5266880585170617, 'recall': 0.17250081928001296, 'f1-score': 0.2598843445148769, 'support': 530954}, '1': {'precision': 0.5287017282169472, 'recall': 0.42114682031947154, 'f1-score': 0.4688348517857203, 'support': 821419}, '2': {'precision': 0.36039562013141085, 'recall': 0.699616433042785, 'f1-score': 0.47572798344236417, 'support': 556878}, 'accuracy': 0.4332217188834784, 'macro avg': {'precision': 0.47192846895513996, 'recall': 0.4310880242140898, 'f1-score': 0.40148239324765383, 'support': 1909251}, 'weighted avg': {'precision': 0.47905129732007173, 'recall': 0.4332217188834784, 'f1-score': 0.41273721230992855, 'support': 1909251}}
[[ 91590 169976 269388]
 [ 53433 345938 422048]
 [ 28875 138402 389601]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99506444
{'0': {'precision': 0.45177286668386507, 'recall': 0.3568986209551414, 'f1-score': 0.39877036737172356, 'support': 88322}, '1': {'precision': 0.7449587199532403, 'recall': 0.49197433072512486, 'f1-score': 0.5925956420452069, 'support': 248702}, '2': {'precision': 0.328297168459715, 'recall': 0.7085193222320917, 'f1-score': 0.44869056265219803, 'support': 88939}, 'accuracy': 0.5091803748212873, 'macro avg': {'precision': 0.5083429183656069, 'recall': 0.5191307579707859, 'f1-score': 0.48001885735637617, 'support': 425963}, 'weighted avg': {'precision': 0.5971707133405992, 'recall': 0.5091803748212873, 'f1-score': 0.5223599413720352, 'support': 425963}}
[[ 31522  24281  32519]
 [ 29936 122355  96411]
 [  8316  17608  63015]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0378904
{'0': {'precision': 0.4835237779147504, 'recall': 0.31461714074165487, 'f1-score': 0.38119801887674054, 'support': 32414}, '1': {'precision': 0.6828179789607906, 'recall': 0.47900888544337766, 'f1-score': 0.5630372116252376, 'support': 67076}, '2': {'precision': 0.3677494924254256, 'recall': 0.7204001713271737, 'f1-score': 0.4869308077257124, 'support': 32686}, 'accuracy': 0.4983885122866481, 'macro avg': {'precision': 0.5113637497669888, 'recall': 0.5046753991707355, 'f1-score': 0.47705534607589684, 'support': 132176}, 'weighted avg': {'precision': 0.5560305834911041, 'recall': 0.4983885122866481, 'f1-score': 0.4996236606658374, 'support': 132176}}
[[10198  8565 13651]
 [ 8114 32130 26832]
 [ 2779  6360 23547]]
training model: results/WBA/W5/deepLOB_L1/h30
Epoch 1/50
1664/1664 - 47s - loss: 3.0326 - accuracy30: 0.4551 - val_loss: 3.6907 - val_accuracy30: 0.4253 - 47s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 45s - loss: 2.9815 - accuracy30: 0.4557 - val_loss: 3.4434 - val_accuracy30: 0.4514 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 44s - loss: 2.9044 - accuracy30: 0.4945 - val_loss: 3.5993 - val_accuracy30: 0.4783 - 44s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 43s - loss: 2.8450 - accuracy30: 0.5197 - val_loss: 3.6297 - val_accuracy30: 0.4805 - 43s/epoch - 26ms/step
Epoch 5/50
1664/1664 - 43s - loss: 2.7910 - accuracy30: 0.5376 - val_loss: 3.6839 - val_accuracy30: 0.4973 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 41s - loss: 2.7533 - accuracy30: 0.5486 - val_loss: 3.7653 - val_accuracy30: 0.4918 - 41s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 43s - loss: 2.7307 - accuracy30: 0.5532 - val_loss: 3.8567 - val_accuracy30: 0.4858 - 43s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 44s - loss: 2.7134 - accuracy30: 0.5567 - val_loss: 3.7878 - val_accuracy30: 0.4941 - 44s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 44s - loss: 2.6989 - accuracy30: 0.5610 - val_loss: 3.8721 - val_accuracy30: 0.4961 - 44s/epoch - 26ms/step
Epoch 10/50
1664/1664 - 46s - loss: 2.6894 - accuracy30: 0.5620 - val_loss: 3.7823 - val_accuracy30: 0.4938 - 46s/epoch - 27ms/step
Epoch 11/50
1664/1664 - 45s - loss: 2.6814 - accuracy30: 0.5636 - val_loss: 3.8089 - val_accuracy30: 0.4948 - 45s/epoch - 27ms/step
Epoch 12/50
1664/1664 - 46s - loss: 2.6710 - accuracy30: 0.5657 - val_loss: 3.7372 - val_accuracy30: 0.4959 - 46s/epoch - 28ms/step
testing model: results/WBA/W5/deepLOB_L1/h30
Evaluating performance on  test set...
7459/7459 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1297165
{'0': {'precision': 0.3712276657656307, 'recall': 0.473152527634682, 'f1-score': 0.41603843803488727, 'support': 607208}, '1': {'precision': 0.368154874190181, 'recall': 0.47830303431249466, 'f1-score': 0.41606225579152156, 'support': 665093}, '2': {'precision': 0.47177275157145754, 'recall': 0.2009043096004396, 'f1-score': 0.28180291677448127, 'support': 636950}, 'accuracy': 0.38412131249374754, 'macro avg': {'precision': 0.40371843050908973, 'recall': 0.38411995718253883, 'f1-score': 0.37130120353363005, 'support': 1909251}, 'weighted avg': {'precision': 0.40370034758521905, 'recall': 0.38412131249374754, 'f1-score': 0.37126408712785486, 'support': 1909251}}
[[287302 270636  49270]
 [252968 318116  94009]
 [233654 275330 127966]]
Evaluating performance on  train set...
1664/1664 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0048168
{'0': {'precision': 0.34720678314333686, 'recall': 0.4368543400885476, 'f1-score': 0.3869055246589268, 'support': 103673}, '1': {'precision': 0.5712620564005901, 'recall': 0.4986182844730004, 'f1-score': 0.5324739518335266, 'support': 218207}, '2': {'precision': 0.38341756850651515, 'recall': 0.3870276606170076, 'f1-score': 0.385214156617865, 'support': 104083}, 'accuracy': 0.4563189760613011, 'macro avg': {'precision': 0.43396213601681405, 'recall': 0.4408334283928519, 'f1-score': 0.4348645443701062, 'support': 425963}, 'weighted avg': {'precision': 0.47083103263120585, 'recall': 0.4563189760613011, 'f1-score': 0.4610622169741516, 'support': 425963}}
[[ 45290  44312  14071]
 [ 58696 108802  50709]
 [ 26455  37345  40283]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0334488
{'0': {'precision': 0.3895406360424028, 'recall': 0.369922955088454, 'f1-score': 0.3794784237050092, 'support': 37251}, '1': {'precision': 0.498747630652586, 'recall': 0.5135667357928306, 'f1-score': 0.5060487159893879, 'support': 57383}, '2': {'precision': 0.4373823350038448, 'recall': 0.439374567151457, 'f1-score': 0.438376187628729, 'support': 37542}, 'accuracy': 0.4520109550901828, 'macro avg': {'precision': 0.44189020056627787, 'recall': 0.44095475267758055, 'f1-score': 0.44130110910770864, 'support': 132176}, 'weighted avg': {'precision': 0.4505403488051328, 'recall': 0.4520109550901828, 'f1-score': 0.4511565115226069, 'support': 132176}}
[[13780 15942  7529]
 [14224 29470 13689]
 [ 7371 13676 16495]]
training model: results/WBA/W5/deepLOB_L1/h50
Epoch 1/50
1664/1664 - 46s - loss: 3.0905 - accuracy50: 0.4562 - val_loss: 3.5230 - val_accuracy50: 0.3891 - 46s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 45s - loss: 3.0592 - accuracy50: 0.4630 - val_loss: 3.4741 - val_accuracy50: 0.4015 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 44s - loss: 3.0094 - accuracy50: 0.4849 - val_loss: 3.5467 - val_accuracy50: 0.3888 - 44s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 42s - loss: 2.9603 - accuracy50: 0.5030 - val_loss: 3.6023 - val_accuracy50: 0.4044 - 42s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 43s - loss: 2.9211 - accuracy50: 0.5142 - val_loss: 3.7012 - val_accuracy50: 0.4078 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 42s - loss: 2.8881 - accuracy50: 0.5230 - val_loss: 3.7506 - val_accuracy50: 0.4266 - 42s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 42s - loss: 2.8625 - accuracy50: 0.5287 - val_loss: 3.7166 - val_accuracy50: 0.4266 - 42s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 44s - loss: 2.8446 - accuracy50: 0.5338 - val_loss: 3.6522 - val_accuracy50: 0.4342 - 44s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 42s - loss: 2.8322 - accuracy50: 0.5369 - val_loss: 3.6794 - val_accuracy50: 0.4420 - 42s/epoch - 25ms/step
Epoch 10/50
1664/1664 - 42s - loss: 2.8213 - accuracy50: 0.5397 - val_loss: 3.6175 - val_accuracy50: 0.4359 - 42s/epoch - 25ms/step
Epoch 11/50
1664/1664 - 44s - loss: 2.8128 - accuracy50: 0.5410 - val_loss: 3.8107 - val_accuracy50: 0.4359 - 44s/epoch - 27ms/step
Epoch 12/50
1664/1664 - 47s - loss: 2.8045 - accuracy50: 0.5429 - val_loss: 3.8260 - val_accuracy50: 0.4398 - 47s/epoch - 28ms/step
testing model: results/WBA/W5/deepLOB_L1/h50
Evaluating performance on  test set...
7459/7459 - 130s - 130s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1719195
{'0': {'precision': 0.41738363174099147, 'recall': 0.22231507432453668, 'f1-score': 0.29010742786413724, 'support': 700038}, '1': {'precision': 0.2461188920060784, 'recall': 0.6624545944748426, 'f1-score': 0.35889797187012223, 'support': 478466}, '2': {'precision': 0.48271117155249416, 'recall': 0.16417994189507448, 'f1-score': 0.2450226644024389, 'support': 730747}, 'accuracy': 0.31036516414028326, 'macro avg': {'precision': 0.38207123176652136, 'recall': 0.3496498702314846, 'f1-score': 0.29800935471223283, 'support': 1909251}, 'weighted avg': {'precision': 0.39946746921057047, 'recall': 0.31036516414028326, 'f1-score': 0.29009086680591173, 'support': 1909251}}
[[155629 481575  62834]
 [ 95770 316962  65734]
 [121469 489304 119974]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0696074
{'0': {'precision': 0.38950225261900884, 'recall': 0.28730091365518123, 'f1-score': 0.3306850754384833, 'support': 124883}, '1': {'precision': 0.431218915467931, 'recall': 0.5481606338180043, 'f1-score': 0.48270812718022527, 'support': 176202}, '2': {'precision': 0.41347326646156085, 'recall': 0.3637550249043066, 'f1-score': 0.3870239413819545, 'support': 124878}, 'accuracy': 0.417620779269561, 'macro avg': {'precision': 0.41139814484950027, 'recall': 0.39973885745916404, 'f1-score': 0.400139048000221, 'support': 425963}, 'weighted avg': {'precision': 0.41378607936906925, 'recall': 0.417620779269561, 'f1-score': 0.4100869264543866, 'support': 425963}}
[[35879 68378 20626]
 [35804 96587 43811]
 [20432 59021 45425]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038313
{'0': {'precision': 0.45846910952982645, 'recall': 0.15870896450112804, 'f1-score': 0.23579307396323215, 'support': 43438}, '1': {'precision': 0.35998116880638226, 'recall': 0.6321104606997632, 'f1-score': 0.45872348015014064, 'support': 44758}, '2': {'precision': 0.4654698282571473, 'recall': 0.4079581628012733, 'f1-score': 0.4348205414051329, 'support': 43980}, 'accuracy': 0.40194891659605375, 'macro avg': {'precision': 0.427973368864452, 'recall': 0.3995925293340548, 'f1-score': 0.37644569850616855, 'support': 132176}, 'weighted avg': {'precision': 0.4274481099438778, 'recall': 0.40194891659605375, 'f1-score': 0.37750675222712604, 'support': 132176}}
[[ 6894 26691  9853]
 [ 5715 28292 10751]
 [ 2428 23610 17942]]
training model: results/WBA/W5/deepLOB_L1/h100
Epoch 1/50
1664/1664 - 49s - loss: 3.1924 - accuracy100: 0.4251 - val_loss: 3.3899 - val_accuracy100: 0.3565 - 49s/epoch - 30ms/step
Epoch 2/50
1664/1664 - 46s - loss: 3.1656 - accuracy100: 0.4363 - val_loss: 3.5925 - val_accuracy100: 0.3000 - 46s/epoch - 28ms/step
Epoch 3/50
1664/1664 - 46s - loss: 3.1339 - accuracy100: 0.4515 - val_loss: 3.6849 - val_accuracy100: 0.2961 - 46s/epoch - 28ms/step
Epoch 4/50
1664/1664 - 47s - loss: 3.1139 - accuracy100: 0.4578 - val_loss: 3.6195 - val_accuracy100: 0.3240 - 47s/epoch - 28ms/step
Epoch 5/50
1664/1664 - 47s - loss: 3.0999 - accuracy100: 0.4610 - val_loss: 3.5962 - val_accuracy100: 0.3467 - 47s/epoch - 28ms/step
Epoch 6/50
1664/1664 - 46s - loss: 3.0872 - accuracy100: 0.4645 - val_loss: 3.6288 - val_accuracy100: 0.3496 - 46s/epoch - 27ms/step
Epoch 7/50
1664/1664 - 42s - loss: 3.0760 - accuracy100: 0.4670 - val_loss: 3.5802 - val_accuracy100: 0.3571 - 42s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 41s - loss: 3.0694 - accuracy100: 0.4687 - val_loss: 3.5636 - val_accuracy100: 0.3585 - 41s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 45s - loss: 3.0620 - accuracy100: 0.4714 - val_loss: 3.5796 - val_accuracy100: 0.3602 - 45s/epoch - 27ms/step
Epoch 10/50
1664/1664 - 45s - loss: 3.0558 - accuracy100: 0.4730 - val_loss: 3.5407 - val_accuracy100: 0.3625 - 45s/epoch - 27ms/step
Epoch 11/50
1664/1664 - 44s - loss: 3.0494 - accuracy100: 0.4751 - val_loss: 3.5245 - val_accuracy100: 0.3620 - 44s/epoch - 27ms/step
testing model: results/WBA/W5/deepLOB_L1/h100
Evaluating performance on  test set...
7459/7459 - 124s - 124s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1446245
{'0': {'precision': 0.4012598094213716, 'recall': 0.17527961245794338, 'f1-score': 0.24398215012276725, 'support': 740668}, '1': {'precision': 0.22325588173311034, 'recall': 0.486355344675593, 'f1-score': 0.3060314923727609, 'support': 409501}, '2': {'precision': 0.4173070213630977, 'recall': 0.3813224394729423, 'f1-score': 0.39850403522249483, 'support': 759082}, 'accuracy': 0.3239186466315849, 'macro avg': {'precision': 0.34727423750585995, 'recall': 0.3476524655354929, 'f1-score': 0.316172559239341, 'support': 1909251}, 'weighted avg': {'precision': 0.36946114247966444, 'recall': 0.3239186466315849, 'f1-score': 0.31872562245091374, 'support': 1909251}}
[[129824 350731 260113]
 [ 66280 199163 144058]
 [127437 342190 289455]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1105188
{'0': {'precision': 0.39453181808738286, 'recall': 0.13222576557256055, 'f1-score': 0.19806937121579551, 'support': 143618}, '1': {'precision': 0.34374703572309384, 'recall': 0.5165748415928384, 'f1-score': 0.4128014763047954, 'support': 140303}, '2': {'precision': 0.3956319691471141, 'recall': 0.46510891144872646, 'f1-score': 0.4275664341095306, 'support': 142042}, 'accuracy': 0.3698255482283673, 'macro avg': {'precision': 0.377970274319197, 'recall': 0.37130317287137515, 'f1-score': 0.3461457605433738, 'support': 425963}, 'weighted avg': {'precision': 0.37817126643564203, 'recall': 0.3698255482283673, 'f1-score': 0.34532577693144184, 'support': 425963}}
[[18990 77923 46705]
 [13610 72477 54216]
 [15533 60444 66065]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1333126
{'0': {'precision': 0.3929554210236654, 'recall': 0.09002458654674596, 'f1-score': 0.14648908341739472, 'support': 47587}, '1': {'precision': 0.2852410620805657, 'recall': 0.45907571614043813, 'f1-score': 0.35185890921409213, 'support': 36201}, '2': {'precision': 0.41781593689990637, 'recall': 0.5440811771513598, 'f1-score': 0.47266133448235625, 'support': 48388}, 'accuracy': 0.3573265948432393, 'macro avg': {'precision': 0.3653374733347125, 'recall': 0.36439382661284797, 'f1-score': 0.32366977570461436, 'support': 132176}, 'weighted avg': {'precision': 0.3725552207915536, 'recall': 0.3573265948432393, 'f1-score': 0.32214439109955795, 'support': 132176}}
[[ 4284 23051 20252]
 [ 3150 16619 16432]
 [ 3468 18593 26327]]
training model: results/WBA/W5/deepLOB_L1/h200
Epoch 1/50
1664/1664 - 47s - loss: 3.2673 - accuracy200: 0.3852 - val_loss: 3.4294 - val_accuracy200: 0.3418 - 47s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 47s - loss: 3.2358 - accuracy200: 0.3991 - val_loss: 3.4559 - val_accuracy200: 0.3395 - 47s/epoch - 28ms/step
Epoch 3/50
1664/1664 - 47s - loss: 3.2226 - accuracy200: 0.4074 - val_loss: 3.4637 - val_accuracy200: 0.3403 - 47s/epoch - 29ms/step
Epoch 4/50
1664/1664 - 43s - loss: 3.2144 - accuracy200: 0.4112 - val_loss: 3.4820 - val_accuracy200: 0.3438 - 43s/epoch - 26ms/step
Epoch 5/50
1664/1664 - 45s - loss: 3.2076 - accuracy200: 0.4135 - val_loss: 3.4725 - val_accuracy200: 0.3367 - 45s/epoch - 27ms/step
Epoch 6/50
1664/1664 - 48s - loss: 3.2049 - accuracy200: 0.4150 - val_loss: 3.5108 - val_accuracy200: 0.3427 - 48s/epoch - 29ms/step
Epoch 7/50
1664/1664 - 48s - loss: 3.2009 - accuracy200: 0.4175 - val_loss: 3.5097 - val_accuracy200: 0.3383 - 48s/epoch - 29ms/step
Epoch 8/50
1664/1664 - 48s - loss: 3.1960 - accuracy200: 0.4192 - val_loss: 3.5176 - val_accuracy200: 0.3376 - 48s/epoch - 29ms/step
Epoch 9/50
1664/1664 - 48s - loss: 3.1922 - accuracy200: 0.4210 - val_loss: 3.5308 - val_accuracy200: 0.3410 - 48s/epoch - 29ms/step
Epoch 10/50
1664/1664 - 47s - loss: 3.1899 - accuracy200: 0.4219 - val_loss: 3.5111 - val_accuracy200: 0.3366 - 47s/epoch - 29ms/step
Epoch 11/50
1664/1664 - 47s - loss: 3.1862 - accuracy200: 0.4240 - val_loss: 3.5236 - val_accuracy200: 0.3371 - 47s/epoch - 28ms/step
testing model: results/WBA/W5/deepLOB_L1/h200
Evaluating performance on  test set...
7459/7459 - 123s - 123s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.2121077
{'0': {'precision': 0.41720940924067124, 'recall': 0.028970547939739133, 'f1-score': 0.05417896970405547, 'support': 751798}, '1': {'precision': 0.1968058782262599, 'recall': 0.6611766067103155, 'f1-score': 0.30332424036814976, 'support': 397567}, '2': {'precision': 0.4008431049892023, 'recall': 0.2750438881621717, 'f1-score': 0.3262363302042001, 'support': 759886}, 'accuracy': 0.2585537469929307, 'macro avg': {'precision': 0.3382861308187111, 'recall': 0.32173034760407543, 'f1-score': 0.2279131800921351, 'support': 1909251}, 'weighted avg': {'precision': 0.36480053472011936, 'recall': 0.2585537469929307, 'f1-score': 0.21433838156929733, 'support': 1909251}}
[[ 21780 541957 188061]
 [ 10362 262862 124343]
 [ 20062 530822 209002]]
Evaluating performance on  train set...
1664/1664 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1316884
{'0': {'precision': 0.3804700788619143, 'recall': 0.06996516670221085, 'f1-score': 0.11819524673047593, 'support': 140670}, '1': {'precision': 0.34628908206244696, 'recall': 0.446251460558137, 'f1-score': 0.38996619184864395, 'support': 147204}, '2': {'precision': 0.3400507609387922, 'recall': 0.5181151286489148, 'f1-score': 0.4106092910208989, 'support': 138089}, 'accuracy': 0.3452835105396478, 'macro avg': {'precision': 0.35560330728771783, 'recall': 0.34477725196975423, 'f1-score': 0.3062569098666729, 'support': 425963}, 'weighted avg': {'precision': 0.3555546692006179, 'recall': 0.3452835105396478, 'f1-score': 0.3069086635464788, 'support': 425963}}
[[ 9842 65607 65221]
 [ 7883 65690 73631]
 [ 8143 58400 71546]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1400273
{'0': {'precision': 0.40370866845397674, 'recall': 0.040229757107553936, 'f1-score': 0.07316826270929079, 'support': 44917}, '1': {'precision': 0.3078771139949302, 'recall': 0.389093430238118, 'f1-score': 0.34375330024289785, 'support': 41828}, '2': {'precision': 0.36015126005505227, 'recall': 0.5932733155774691, 'f1-score': 0.4482119249349375, 'support': 45431}, 'accuracy': 0.3407199491586975, 'macro avg': {'precision': 0.3572456808346531, 'recall': 0.34086550097438034, 'f1-score': 0.2883778292957087, 'support': 132176}, 'weighted avg': {'precision': 0.3584107408356153, 'recall': 0.3407199491586975, 'f1-score': 0.28770524043996104, 'support': 132176}}
[[ 1807 19270 23840]
 [ 1508 16275 24045]
 [ 1161 17317 26953]]
training model: results/WBA/W5/deepLOB_L1/h300
Epoch 1/50
1664/1664 - 47s - loss: 3.2858 - accuracy300: 0.3770 - val_loss: 3.4076 - val_accuracy300: 0.3495 - 47s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 45s - loss: 3.2538 - accuracy300: 0.3927 - val_loss: 3.4150 - val_accuracy300: 0.3481 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 43s - loss: 3.2416 - accuracy300: 0.4000 - val_loss: 3.4226 - val_accuracy300: 0.3501 - 43s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 45s - loss: 3.2335 - accuracy300: 0.4040 - val_loss: 3.4310 - val_accuracy300: 0.3537 - 45s/epoch - 27ms/step
Epoch 5/50
1664/1664 - 43s - loss: 3.2286 - accuracy300: 0.4072 - val_loss: 3.4294 - val_accuracy300: 0.3425 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 45s - loss: 3.2223 - accuracy300: 0.4097 - val_loss: 3.4030 - val_accuracy300: 0.3402 - 45s/epoch - 27ms/step
Epoch 7/50
1664/1664 - 42s - loss: 3.2185 - accuracy300: 0.4118 - val_loss: 3.4244 - val_accuracy300: 0.3406 - 42s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 42s - loss: 3.2141 - accuracy300: 0.4145 - val_loss: 3.4290 - val_accuracy300: 0.3367 - 42s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 46s - loss: 3.2095 - accuracy300: 0.4165 - val_loss: 3.4341 - val_accuracy300: 0.3375 - 46s/epoch - 27ms/step
Epoch 10/50
1664/1664 - 43s - loss: 3.2065 - accuracy300: 0.4178 - val_loss: 3.4429 - val_accuracy300: 0.3365 - 43s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 44s - loss: 3.2035 - accuracy300: 0.4199 - val_loss: 3.4240 - val_accuracy300: 0.3364 - 44s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 43s - loss: 3.1985 - accuracy300: 0.4218 - val_loss: 3.4412 - val_accuracy300: 0.3376 - 43s/epoch - 26ms/step
Epoch 13/50
1664/1664 - 45s - loss: 3.1961 - accuracy300: 0.4228 - val_loss: 3.4324 - val_accuracy300: 0.3361 - 45s/epoch - 27ms/step
Epoch 14/50
1664/1664 - 45s - loss: 3.1941 - accuracy300: 0.4234 - val_loss: 3.4374 - val_accuracy300: 0.3341 - 45s/epoch - 27ms/step
Epoch 15/50
1664/1664 - 46s - loss: 3.1911 - accuracy300: 0.4257 - val_loss: 3.4483 - val_accuracy300: 0.3363 - 46s/epoch - 27ms/step
Epoch 16/50
1664/1664 - 40s - loss: 3.1881 - accuracy300: 0.4261 - val_loss: 3.4458 - val_accuracy300: 0.3371 - 40s/epoch - 24ms/step
testing model: results/WBA/W5/deepLOB_L1/h300
Evaluating performance on  test set...
7459/7459 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1459403
{'0': {'precision': 0.396099024756189, 'recall': 0.002361025197683691, 'f1-score': 0.004694070476252567, 'support': 670895}, '1': {'precision': 0.2842157248181099, 'recall': 0.41873715072313494, 'f1-score': 0.3386050102132716, 'support': 559370}, '2': {'precision': 0.3523819566230826, 'recall': 0.5610866792540642, 'f1-score': 0.4328924149231243, 'support': 678986}, 'accuracy': 0.3230497194973317, 'macro avg': {'precision': 0.3442322353991272, 'recall': 0.32739495172496097, 'f1-score': 0.25873049853754954, 'support': 1909251}, 'weighted avg': {'precision': 0.34777251414559424, 'recall': 0.3230497194973317, 'f1-score': 0.2548028531681563, 'support': 1909251}}
[[  1584 293306 376005]
 [   988 234229 324153]
 [  1427 296589 380970]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.13324
{'0': {'precision': 0.4021792966815255, 'recall': 0.07278042457545901, 'f1-score': 0.1232558411078547, 'support': 145039}, '1': {'precision': 0.33655315821277504, 'recall': 0.2731790706732642, 'f1-score': 0.30157264004459133, 'support': 138638}, '2': {'precision': 0.3391867234943451, 'recall': 0.6846000309236326, 'f1-score': 0.45362423452161965, 'support': 142286}, 'accuracy': 0.34237245957982265, 'macro avg': {'precision': 0.35930639279621523, 'recall': 0.34351984205745195, 'f1-score': 0.2928175718913552, 'support': 425963}, 'weighted avg': {'precision': 0.3597783420128295, 'recall': 0.34237245957982265, 'f1-score': 0.29164671448479645, 'support': 425963}}
[[10556 38392 96091]
 [ 7081 37873 93684]
 [ 8610 36267 97409]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1378176
{'0': {'precision': 0.32922755741127346, 'recall': 0.06934611494657227, 'f1-score': 0.11456176673567976, 'support': 45482}, '1': {'precision': 0.3008832059056156, 'recall': 0.22228173540439208, 'f1-score': 0.25567784032036744, 'support': 41074}, '2': {'precision': 0.3550492130251919, 'recall': 0.7179745725558966, 'f1-score': 0.4751363583613787, 'support': 45620}, 'accuracy': 0.3407426461687447, 'macro avg': {'precision': 0.3283866587806937, 'recall': 0.3365341409689537, 'f1-score': 0.2817919884724753, 'support': 132176}, 'weighted avg': {'precision': 0.3293317218235992, 'recall': 0.3407426461687447, 'f1-score': 0.2828647451612778, 'support': 132176}}
[[ 3154 11133 31195]
 [ 3641  9130 28303]
 [ 2785 10081 32754]]
training model: results/WBA/W5/deepLOB_L1/h500
Epoch 1/50
1664/1664 - 47s - loss: 3.2202 - accuracy500: 0.4190 - val_loss: 3.4128 - val_accuracy500: 0.3430 - 47s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 45s - loss: 3.1844 - accuracy500: 0.4369 - val_loss: 3.4488 - val_accuracy500: 0.3450 - 45s/epoch - 27ms/step
Epoch 3/50
1664/1664 - 42s - loss: 3.1779 - accuracy500: 0.4400 - val_loss: 3.3730 - val_accuracy500: 0.3625 - 42s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 44s - loss: 3.1708 - accuracy500: 0.4429 - val_loss: 3.3921 - val_accuracy500: 0.3486 - 44s/epoch - 27ms/step
Epoch 5/50
1664/1664 - 43s - loss: 3.1591 - accuracy500: 0.4459 - val_loss: 3.4091 - val_accuracy500: 0.3214 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 45s - loss: 3.1504 - accuracy500: 0.4493 - val_loss: 3.4416 - val_accuracy500: 0.3251 - 45s/epoch - 27ms/step
Epoch 7/50
1664/1664 - 46s - loss: 3.1408 - accuracy500: 0.4542 - val_loss: 3.4317 - val_accuracy500: 0.3426 - 46s/epoch - 28ms/step
Epoch 8/50
1664/1664 - 48s - loss: 3.1414 - accuracy500: 0.4540 - val_loss: 3.3882 - val_accuracy500: 0.3549 - 48s/epoch - 29ms/step
Epoch 9/50
1664/1664 - 45s - loss: 3.1371 - accuracy500: 0.4560 - val_loss: 3.4432 - val_accuracy500: 0.3198 - 45s/epoch - 27ms/step
Epoch 10/50
1664/1664 - 44s - loss: 3.1341 - accuracy500: 0.4558 - val_loss: 3.4330 - val_accuracy500: 0.3568 - 44s/epoch - 27ms/step
Epoch 11/50
1664/1664 - 48s - loss: 3.1304 - accuracy500: 0.4573 - val_loss: 3.4792 - val_accuracy500: 0.3284 - 48s/epoch - 29ms/step
Epoch 12/50
1664/1664 - 45s - loss: 3.1242 - accuracy500: 0.4608 - val_loss: 3.4582 - val_accuracy500: 0.3171 - 45s/epoch - 27ms/step
Epoch 13/50
1664/1664 - 45s - loss: 3.1195 - accuracy500: 0.4624 - val_loss: 3.5185 - val_accuracy500: 0.3174 - 45s/epoch - 27ms/step
testing model: results/WBA/W5/deepLOB_L1/h500
Evaluating performance on  test set...
7459/7459 - 113s - 113s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986539
{'0': {'precision': 0.3621834296594605, 'recall': 0.05971706316903697, 'f1-score': 0.10252906130898717, 'support': 719878}, '1': {'precision': 0.23718669400171946, 'recall': 0.015621188891599011, 'f1-score': 0.029311887803263416, 'support': 459184}, '2': {'precision': 0.3814629767967665, 'recall': 0.9196180714856017, 'f1-score': 0.5392442654177628, 'support': 730189}, 'accuracy': 0.3779791132753106, 'macro avg': {'precision': 0.3269443668193155, 'recall': 0.33165210784874594, 'f1-score': 0.22369507151000448, 'support': 1909251}, 'weighted avg': {'precision': 0.33949453866418444, 'recall': 0.3779791132753106, 'f1-score': 0.25194078536932835, 'support': 1909251}}
[[ 42989  11326 665563]
 [ 28754   7173 423257]
 [ 46951  11743 671495]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1403149
{'0': {'precision': 0.35505677550479386, 'recall': 0.11122106501505138, 'f1-score': 0.1693830985767056, 'support': 144505}, '1': {'precision': 0.27279053583855256, 'recall': 0.008448215170868025, 'f1-score': 0.01638887340431462, 'support': 139201}, '2': {'precision': 0.33583874001689756, 'recall': 0.8885678736371496, 'f1-score': 0.4874451212105437, 'support': 142257}, 'accuracy': 0.33724290607400176, 'macro avg': {'precision': 0.321228683786748, 'recall': 0.33607905127435633, 'f1-score': 0.22440569773052133, 'support': 425963}, 'weighted avg': {'precision': 0.32175472133064703, 'recall': 0.33724290607400176, 'f1-score': 0.22560770028060922, 'support': 425963}}
[[ 16072   1663 126770]
 [ 14814   1176 123211]
 [ 14380   1472 126405]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1257538
{'0': {'precision': 0.30626640419947504, 'recall': 0.07807631991636174, 'f1-score': 0.12443141110018828, 'support': 47825}, '1': {'precision': 0.23333333333333334, 'recall': 0.005700480469068107, 'f1-score': 0.011129070722594664, 'support': 36839}, '2': {'precision': 0.36863054650498805, 'recall': 0.9239350058932481, 'f1-score': 0.5269994477658526, 'support': 47512}, 'accuracy': 0.3619567848928701, 'macro avg': {'precision': 0.3027434280125988, 'recall': 0.33590393542622593, 'f1-score': 0.22085330986287852, 'support': 132176}, 'weighted avg': {'precision': 0.3083565244299385, 'recall': 0.3619567848928701, 'f1-score': 0.2375598734601392, 'support': 132176}}
[[ 3734   369 43722]
 [ 5165   210 31464]
 [ 3293   321 43898]]
training model: results/WBA/W5/deepLOB_L1/h1000
Epoch 1/50
1664/1664 - 49s - loss: 3.2247 - accuracy1000: 0.4214 - val_loss: 3.3829 - val_accuracy1000: 0.3487 - 49s/epoch - 29ms/step
Epoch 2/50
1664/1664 - 47s - loss: 3.1753 - accuracy1000: 0.4344 - val_loss: 3.5284 - val_accuracy1000: 0.3458 - 47s/epoch - 28ms/step
Epoch 3/50
1664/1664 - 48s - loss: 3.1518 - accuracy1000: 0.4436 - val_loss: 3.5160 - val_accuracy1000: 0.3292 - 48s/epoch - 29ms/step
Epoch 4/50
1664/1664 - 48s - loss: 3.1293 - accuracy1000: 0.4527 - val_loss: 3.5796 - val_accuracy1000: 0.3144 - 48s/epoch - 29ms/step
Epoch 5/50
1664/1664 - 43s - loss: 3.1157 - accuracy1000: 0.4586 - val_loss: 3.5817 - val_accuracy1000: 0.3272 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 44s - loss: 3.1007 - accuracy1000: 0.4617 - val_loss: 3.6223 - val_accuracy1000: 0.3098 - 44s/epoch - 27ms/step
Epoch 7/50
1664/1664 - 47s - loss: 3.0914 - accuracy1000: 0.4660 - val_loss: 3.5821 - val_accuracy1000: 0.3232 - 47s/epoch - 28ms/step
Epoch 8/50
1664/1664 - 47s - loss: 3.0833 - accuracy1000: 0.4687 - val_loss: 3.6208 - val_accuracy1000: 0.3032 - 47s/epoch - 28ms/step
Epoch 9/50
1664/1664 - 44s - loss: 3.0753 - accuracy1000: 0.4712 - val_loss: 3.6963 - val_accuracy1000: 0.2986 - 44s/epoch - 26ms/step
Epoch 10/50
1664/1664 - 44s - loss: 3.0687 - accuracy1000: 0.4733 - val_loss: 3.5769 - val_accuracy1000: 0.3565 - 44s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 46s - loss: 3.0601 - accuracy1000: 0.4754 - val_loss: 3.6130 - val_accuracy1000: 0.3185 - 46s/epoch - 28ms/step
testing model: results/WBA/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
7459/7459 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1217805
{'0': {'precision': 0.39300542957521556, 'recall': 0.006299901956015882, 'f1-score': 0.012401014857534462, 'support': 781282}, '1': {'precision': 0.168324449085014, 'recall': 0.027681296071479136, 'f1-score': 0.04754390140422405, 'support': 331957}, '2': {'precision': 0.4171092688053434, 'recall': 0.9652769053732858, 'f1-score': 0.5825086386358915, 'support': 796012}, 'accuracy': 0.4098376798021842, 'macro avg': {'precision': 0.3261463824885243, 'recall': 0.3330860344669269, 'f1-score': 0.21415118496588334, 'support': 1909251}, 'weighted avg': {'precision': 0.3639901356367374, 'recall': 0.4098376798021842, 'f1-score': 0.25620260878543444, 'support': 1909251}}
[[  4922  23205 753155]
 [  2159   9189 320609]
 [  5443  22197 768372]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233091
{'0': {'precision': 0.3890896839010047, 'recall': 0.08919017595102018, 'f1-score': 0.14511577961319214, 'support': 142426}, '1': {'precision': 0.2733405513450487, 'recall': 0.023136627353668938, 'f1-score': 0.0426621604055635, 'support': 141853}, '2': {'precision': 0.3319127844157479, 'recall': 0.8932624714152622, 'f1-score': 0.4839882828035611, 'support': 141684}, 'accuracy': 0.33464408880583524, 'macro avg': {'precision': 0.3314476732206004, 'recall': 0.3351964249066504, 'f1-score': 0.22392207427410557, 'support': 425963}, 'weighted avg': {'precision': 0.33152502798692496, 'recall': 0.33464408880583524, 'f1-score': 0.2237128842832327, 'support': 425963}}
[[ 12703   4416 125307]
 [  9131   3282 129440]
 [ 10814   4309 126561]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1283547
{'0': {'precision': 0.2979890310786106, 'recall': 0.02495025256390632, 'f1-score': 0.046045197740112995, 'support': 45731}, '1': {'precision': 0.338979171435111, 'recall': 0.036602244080866, 'f1-score': 0.06607035310387903, 'support': 40462}, '2': {'precision': 0.35090903224765685, 'recall': 0.9461105191048866, 'f1-score': 0.5119409746941945, 'support': 45983}, 'accuracy': 0.34898166081588183, 'macro avg': {'precision': 0.32929241158712613, 'recall': 0.33588767191655294, 'f1-score': 0.2080188418460622, 'support': 132176}, 'weighted avg': {'precision': 0.32894747643072425, 'recall': 0.34898166081588183, 'f1-score': 0.21425684999171865, 'support': 132176}}
[[ 1141  1476 43114]
 [ 1622  1481 37359]
 [ 1066  1412 43505]]
training model: results/WBA/W5/deepOF_L1/h10
Epoch 1/50
1664/1664 - 46s - loss: 3.1259 - accuracy10: 0.4023 - val_loss: 3.6357 - val_accuracy10: 0.5485 - 46s/epoch - 27ms/step
Epoch 2/50
1664/1664 - 42s - loss: 3.0808 - accuracy10: 0.3988 - val_loss: 3.5836 - val_accuracy10: 0.5322 - 42s/epoch - 25ms/step
Epoch 3/50
1664/1664 - 42s - loss: 3.0597 - accuracy10: 0.4006 - val_loss: 3.5895 - val_accuracy10: 0.5426 - 42s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 41s - loss: 3.0418 - accuracy10: 0.4086 - val_loss: 3.6264 - val_accuracy10: 0.5604 - 41s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 41s - loss: 3.0249 - accuracy10: 0.4196 - val_loss: 3.6814 - val_accuracy10: 0.5757 - 41s/epoch - 25ms/step
Epoch 6/50
1664/1664 - 42s - loss: 3.0104 - accuracy10: 0.4287 - val_loss: 3.7477 - val_accuracy10: 0.5872 - 42s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 43s - loss: 2.9981 - accuracy10: 0.4372 - val_loss: 3.8202 - val_accuracy10: 0.5934 - 43s/epoch - 26ms/step
Epoch 8/50
1664/1664 - 43s - loss: 2.9855 - accuracy10: 0.4444 - val_loss: 3.8774 - val_accuracy10: 0.5960 - 43s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 39s - loss: 2.9755 - accuracy10: 0.4502 - val_loss: 3.9309 - val_accuracy10: 0.6003 - 39s/epoch - 23ms/step
Epoch 10/50
1664/1664 - 41s - loss: 2.9671 - accuracy10: 0.4535 - val_loss: 3.9559 - val_accuracy10: 0.6003 - 41s/epoch - 25ms/step
Epoch 11/50
1664/1664 - 40s - loss: 2.9557 - accuracy10: 0.4593 - val_loss: 3.9964 - val_accuracy10: 0.6006 - 40s/epoch - 24ms/step
Epoch 12/50
1664/1664 - 42s - loss: 2.9472 - accuracy10: 0.4617 - val_loss: 3.9946 - val_accuracy10: 0.6022 - 42s/epoch - 26ms/step
testing model: results/WBA/W5/deepOF_L1/h10
Evaluating performance on  test set...
7458/7458 - 128s - 128s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0173136
{'0': {'precision': 0.3467950532312892, 'recall': 0.2974302030456853, 'f1-score': 0.3202212955571398, 'support': 416064}, '1': {'precision': 0.5785727551031555, 'recall': 0.6500873391307632, 'f1-score': 0.6122487816178017, 'support': 1059090}, '2': {'precision': 0.3406740469305313, 'recall': 0.284416667434553, 'f1-score': 0.31001381042059006, 'support': 434092}, 'accuracy': 0.49009609028904605, 'macro avg': {'precision': 0.42201395175499207, 'recall': 0.4106447365370005, 'f1-score': 0.4141612958651772, 'support': 1909246}, 'weighted avg': {'precision': 0.4739742466973833, 'recall': 0.49009609028904605, 'f1-score': 0.47989291596335837, 'support': 1909246}}
[[123750 240468  51846]
 [183490 688501 187099]
 [ 49599 261030 123463]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9637503
{'0': {'precision': 0.2920054284896099, 'recall': 0.3508354650032162, 'f1-score': 0.31872851066142993, 'support': 66849}, '1': {'precision': 0.7156308711375805, 'recall': 0.6608152447825774, 'f1-score': 0.6871315684865943, 'support': 291667}, '2': {'precision': 0.27875468434707407, 'recall': 0.3154273852768923, 'f1-score': 0.29595932193958113, 'support': 67445}, 'accuracy': 0.5574806144224471, 'macro avg': {'precision': 0.4287969946580881, 'recall': 0.4423593650208953, 'f1-score': 0.43393980036253516, 'support': 425961}, 'weighted avg': {'precision': 0.5799751382567302, 'recall': 0.5574806144224471, 'f1-score': 0.5673788489162165, 'support': 425961}}
[[ 23453  36842   6554]
 [ 50439 192738  48490]
 [  6425  39746  21274]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98754567
{'0': {'precision': 0.3333333333333333, 'recall': 0.30527322731077366, 'f1-score': 0.31868680564224194, 'support': 25089}, '1': {'precision': 0.6476102316534456, 'recall': 0.6766859297712915, 'f1-score': 0.6618288937186788, 'support': 81676}, '2': {'precision': 0.31477677635715784, 'recall': 0.29551357733175915, 'f1-score': 0.30484116512737236, 'support': 25410}, 'accuracy': 0.5329071306979384, 'macro avg': {'precision': 0.43190678044797887, 'recall': 0.4258242448046081, 'f1-score': 0.42845228816276437, 'support': 132175}, 'weighted avg': {'precision': 0.5239696702686756, 'recall': 0.5329071306979384, 'f1-score': 0.5280657007453116, 'support': 132175}}
[[ 7659 14675  2755]
 [12816 55269 13591]
 [ 2502 15399  7509]]
training model: results/WBA/W5/deepOF_L1/h20
Epoch 1/50
1664/1664 - 41s - loss: 3.1622 - accuracy20: 0.3998 - val_loss: 3.5655 - val_accuracy20: 0.4810 - 41s/epoch - 25ms/step
Epoch 2/50
1664/1664 - 41s - loss: 3.1161 - accuracy20: 0.3969 - val_loss: 3.5329 - val_accuracy20: 0.4810 - 41s/epoch - 24ms/step
Epoch 3/50
1664/1664 - 40s - loss: 3.0935 - accuracy20: 0.4044 - val_loss: 3.5577 - val_accuracy20: 0.4891 - 40s/epoch - 24ms/step
Epoch 4/50
1664/1664 - 41s - loss: 3.0744 - accuracy20: 0.4152 - val_loss: 3.6067 - val_accuracy20: 0.4994 - 41s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 41s - loss: 3.0570 - accuracy20: 0.4288 - val_loss: 3.6716 - val_accuracy20: 0.5050 - 41s/epoch - 25ms/step
Epoch 6/50
1664/1664 - 41s - loss: 3.0412 - accuracy20: 0.4401 - val_loss: 3.7488 - val_accuracy20: 0.5098 - 41s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 40s - loss: 3.0267 - accuracy20: 0.4512 - val_loss: 3.8129 - val_accuracy20: 0.5104 - 40s/epoch - 24ms/step
Epoch 8/50
1664/1664 - 40s - loss: 3.0133 - accuracy20: 0.4593 - val_loss: 3.8444 - val_accuracy20: 0.5120 - 40s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 39s - loss: 3.0033 - accuracy20: 0.4647 - val_loss: 3.8858 - val_accuracy20: 0.5134 - 39s/epoch - 23ms/step
Epoch 10/50
1664/1664 - 39s - loss: 2.9950 - accuracy20: 0.4678 - val_loss: 3.9157 - val_accuracy20: 0.5129 - 39s/epoch - 23ms/step
Epoch 11/50
1664/1664 - 40s - loss: 2.9862 - accuracy20: 0.4712 - val_loss: 3.9178 - val_accuracy20: 0.5138 - 40s/epoch - 24ms/step
Epoch 12/50
1664/1664 - 40s - loss: 2.9783 - accuracy20: 0.4731 - val_loss: 3.9124 - val_accuracy20: 0.5138 - 40s/epoch - 24ms/step
testing model: results/WBA/W5/deepOF_L1/h20
Evaluating performance on  test set...
7458/7458 - 110s - 110s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0638475
{'0': {'precision': 0.40215474516493394, 'recall': 0.26286180295017253, 'f1-score': 0.31792027334851936, 'support': 530952}, '1': {'precision': 0.4422417401977719, 'recall': 0.6623270218974725, 'f1-score': 0.5303583892565109, 'support': 821419}, '2': {'precision': 0.4084062013355703, 'recall': 0.24348013468013469, 'f1-score': 0.3050801693839805, 'support': 556875}, 'accuracy': 0.4290714763838709, 'macro avg': {'precision': 0.4176008955660921, 'recall': 0.38955631984259326, 'f1-score': 0.38445294399633695, 'support': 1909246}, 'weighted avg': {'precision': 0.42122483829484064, 'recall': 0.4290714763838709, 'f1-score': 0.4055728711990708, 'support': 1909246}}
[[139567 331114  60271]
 [141237 544048 136134]
 [ 66244 355043 135588]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9936034
{'0': {'precision': 0.3615305175366354, 'recall': 0.31266675711120157, 'f1-score': 0.33532788922636697, 'support': 88452}, '1': {'precision': 0.6085647688054496, 'recall': 0.6776974248149803, 'f1-score': 0.6412732624780562, 'support': 248487}, '2': {'precision': 0.34682263673727476, 'recall': 0.28342432207768864, 'f1-score': 0.3119347719925079, 'support': 89022}, 'accuracy': 0.5194982639255706, 'macro avg': {'precision': 0.4389726410264532, 'recall': 0.4245961680012902, 'f1-score': 0.42951197456564366, 'support': 425961}, 'weighted avg': {'precision': 0.5025656710612848, 'recall': 0.5194982639255706, 'f1-score': 0.5089140764143957, 'support': 425961}}
[[ 27656  52956   7840]
 [ 40410 168399  39678]
 [  8431  55360  25231]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0264477
{'0': {'precision': 0.39630493437600034, 'recall': 0.26773356401384085, 'f1-score': 0.31957223195353557, 'support': 32368}, '1': {'precision': 0.5287585194624916, 'recall': 0.6932038545302665, 'f1-score': 0.5999160884298854, 'support': 67038}, '2': {'precision': 0.37745863253200124, 'recall': 0.25826238212945163, 'f1-score': 0.30668599383946366, 'support': 32769}, 'accuracy': 0.48118025345186305, 'macro avg': {'precision': 0.43417402879016437, 'recall': 0.406399933557853, 'f1-score': 0.40872477140762825, 'support': 132175}, 'weighted avg': {'precision': 0.45881183032381345, 'recall': 0.48118025345186305, 'f1-score': 0.45856540247520394, 'support': 132175}}
[[ 8666 20419  3283]
 [ 9892 46471 10675]
 [ 3309 20997  8463]]
training model: results/WBA/W5/deepOF_L1/h30
Epoch 1/50
1664/1664 - 43s - loss: 3.1913 - accuracy30: 0.4088 - val_loss: 3.5148 - val_accuracy30: 0.4355 - 43s/epoch - 26ms/step
Epoch 2/50
1664/1664 - 39s - loss: 3.1521 - accuracy30: 0.4013 - val_loss: 3.5026 - val_accuracy30: 0.4376 - 39s/epoch - 24ms/step
Epoch 3/50
1664/1664 - 39s - loss: 3.1304 - accuracy30: 0.4080 - val_loss: 3.5521 - val_accuracy30: 0.4441 - 39s/epoch - 24ms/step
Epoch 4/50
1664/1664 - 41s - loss: 3.1069 - accuracy30: 0.4249 - val_loss: 3.6442 - val_accuracy30: 0.4475 - 41s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 42s - loss: 3.0880 - accuracy30: 0.4388 - val_loss: 3.7297 - val_accuracy30: 0.4477 - 42s/epoch - 25ms/step
Epoch 6/50
1664/1664 - 41s - loss: 3.0718 - accuracy30: 0.4499 - val_loss: 3.7846 - val_accuracy30: 0.4490 - 41s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 39s - loss: 3.0573 - accuracy30: 0.4585 - val_loss: 3.8402 - val_accuracy30: 0.4481 - 39s/epoch - 23ms/step
Epoch 8/50
1664/1664 - 41s - loss: 3.0461 - accuracy30: 0.4635 - val_loss: 3.8557 - val_accuracy30: 0.4486 - 41s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 40s - loss: 3.0364 - accuracy30: 0.4679 - val_loss: 3.8915 - val_accuracy30: 0.4496 - 40s/epoch - 24ms/step
Epoch 10/50
1664/1664 - 40s - loss: 3.0283 - accuracy30: 0.4707 - val_loss: 3.8995 - val_accuracy30: 0.4508 - 40s/epoch - 24ms/step
Epoch 11/50
1664/1664 - 39s - loss: 3.0198 - accuracy30: 0.4739 - val_loss: 3.8981 - val_accuracy30: 0.4505 - 39s/epoch - 24ms/step
Epoch 12/50
1664/1664 - 39s - loss: 3.0124 - accuracy30: 0.4771 - val_loss: 3.9030 - val_accuracy30: 0.4521 - 39s/epoch - 23ms/step
testing model: results/WBA/W5/deepOF_L1/h30
Evaluating performance on  test set...
7458/7458 - 111s - 111s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0994908
{'0': {'precision': 0.4310135153810011, 'recall': 0.25682387855192473, 'f1-score': 0.32186259050418153, 'support': 607206}, '1': {'precision': 0.3546009701744532, 'recall': 0.6520967744360563, 'f1-score': 0.4593914113756586, 'support': 665093}, '2': {'precision': 0.438717215907164, 'recall': 0.22341105303894987, 'f1-score': 0.29605827084876374, 'support': 636947}, 'accuracy': 0.3833717603703242, 'macro avg': {'precision': 0.40811056715420607, 'recall': 0.377443902008977, 'f1-score': 0.35910409090953466, 'support': 1909246}, 'weighted avg': {'precision': 0.40696496428280804, 'recall': 0.3833717603703242, 'f1-score': 0.3611626451164808, 'support': 1909246}}
[[155945 379940  71321]
 [120653 433705 110735]
 [ 85212 409434 142301]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.019359
{'0': {'precision': 0.3962202384699646, 'recall': 0.30349117561963546, 'f1-score': 0.343711260260058, 'support': 103690}, '1': {'precision': 0.5331972944749281, 'recall': 0.662092254963504, 'f1-score': 0.5906950315180155, 'support': 218243}, '2': {'precision': 0.3821835656698042, 'recall': 0.27751182373976235, 'f1-score': 0.32154373068248265, 'support': 104028}, 'accuracy': 0.48087735731674963, 'macro avg': {'precision': 0.43720036620489905, 'recall': 0.41436508477430056, 'f1-score': 0.41865000748685205, 'support': 425961}, 'weighted avg': {'precision': 0.46297300840814243, 'recall': 0.48087735731674963, 'f1-score': 0.46484074259237107, 'support': 425961}}
[[ 31469  62265   9956]
 [ 37034 144497  36712]
 [ 10920  64239  28869]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0565921
{'0': {'precision': 0.42897876820494824, 'recall': 0.26289754550098127, 'f1-score': 0.3260047005483973, 'support': 37197}, '1': {'precision': 0.4483737557829805, 'recall': 0.6685654559707342, 'f1-score': 0.5367654771644953, 'support': 57405}, '2': {'precision': 0.40293486944456125, 'recall': 0.25505016900433825, 'f1-score': 0.3123736879848752, 'support': 37573}, 'accuracy': 0.4368526574616985, 'macro avg': {'precision': 0.4267624644774967, 'recall': 0.3955043901586846, 'f1-score': 0.391714621899256, 'support': 132175}, 'weighted avg': {'precision': 0.42999879357883075, 'recall': 0.4368526574616985, 'f1-score': 0.41366548622343335, 'support': 132175}}
[[ 9779 23327  4091]
 [ 8917 38379 10109]
 [ 4100 23890  9583]]
training model: results/WBA/W5/deepOF_L1/h50
Epoch 1/50
1664/1664 - 43s - loss: 3.2272 - accuracy50: 0.4044 - val_loss: 3.4235 - val_accuracy50: 0.3753 - 43s/epoch - 26ms/step
Epoch 2/50
1664/1664 - 41s - loss: 3.1898 - accuracy50: 0.4080 - val_loss: 3.4170 - val_accuracy50: 0.3761 - 41s/epoch - 25ms/step
Epoch 3/50
1664/1664 - 40s - loss: 3.1716 - accuracy50: 0.4154 - val_loss: 3.4693 - val_accuracy50: 0.3700 - 40s/epoch - 24ms/step
Epoch 4/50
1664/1664 - 36s - loss: 3.1563 - accuracy50: 0.4278 - val_loss: 3.5505 - val_accuracy50: 0.3643 - 36s/epoch - 22ms/step
Epoch 5/50
1664/1664 - 40s - loss: 3.1375 - accuracy50: 0.4406 - val_loss: 3.6164 - val_accuracy50: 0.3655 - 40s/epoch - 24ms/step
Epoch 6/50
1664/1664 - 40s - loss: 3.1243 - accuracy50: 0.4490 - val_loss: 3.6666 - val_accuracy50: 0.3635 - 40s/epoch - 24ms/step
Epoch 7/50
1664/1664 - 40s - loss: 3.1127 - accuracy50: 0.4539 - val_loss: 3.6925 - val_accuracy50: 0.3661 - 40s/epoch - 24ms/step
Epoch 8/50
1664/1664 - 40s - loss: 3.1032 - accuracy50: 0.4583 - val_loss: 3.7167 - val_accuracy50: 0.3644 - 40s/epoch - 24ms/step
Epoch 9/50
1664/1664 - 40s - loss: 3.0966 - accuracy50: 0.4612 - val_loss: 3.7494 - val_accuracy50: 0.3648 - 40s/epoch - 24ms/step
Epoch 10/50
1664/1664 - 40s - loss: 3.0881 - accuracy50: 0.4647 - val_loss: 3.7541 - val_accuracy50: 0.3673 - 40s/epoch - 24ms/step
Epoch 11/50
1664/1664 - 41s - loss: 3.0820 - accuracy50: 0.4666 - val_loss: 3.7540 - val_accuracy50: 0.3663 - 41s/epoch - 25ms/step
Epoch 12/50
1664/1664 - 41s - loss: 3.0755 - accuracy50: 0.4699 - val_loss: 3.7586 - val_accuracy50: 0.3663 - 41s/epoch - 25ms/step
testing model: results/WBA/W5/deepOF_L1/h50
Evaluating performance on  test set...
7458/7458 - 115s - 115s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1311383
{'0': {'precision': 0.4642367742029535, 'recall': 0.18196323908593404, 'f1-score': 0.2614485465787516, 'support': 700037}, '1': {'precision': 0.2531222000496283, 'recall': 0.7120771634288819, 'f1-score': 0.373482505339904, 'support': 478465}, '2': {'precision': 0.46768933571517596, 'recall': 0.18487048816001225, 'f1-score': 0.264993193382477, 'support': 730744}, 'accuracy': 0.31592471583022824, 'macro avg': {'precision': 0.3950161033225859, 'recall': 0.35963696355827607, 'f1-score': 0.2999747484337109, 'support': 1909246}, 'weighted avg': {'precision': 0.41265201450588823, 'recall': 0.31592471583022824, 'f1-score': 0.2908813998949803, 'support': 1909246}}
[[127381 490106  82550]
 [ 66552 340704  71209]
 [ 80455 515196 135093]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.057112
{'0': {'precision': 0.4598588219400162, 'recall': 0.2180171813327142, 'f1-score': 0.2957978264057484, 'support': 124903}, '1': {'precision': 0.425941411530618, 'recall': 0.7314413826375684, 'f1-score': 0.5383718792821095, 'support': 176185}, '2': {'precision': 0.42574072343209646, 'recall': 0.2188623641619886, 'f1-score': 0.28910386265186416, 'support': 124873}, 'accuracy': 0.4306262779925862, 'macro avg': {'precision': 0.4371803189675769, 'recall': 0.38944030937742374, 'f1-score': 0.3744245227799074, 'support': 425961}, 'weighted avg': {'precision': 0.4358280579312002, 'recall': 0.4306262779925862, 'f1-score': 0.3941683677702933, 'support': 425961}}
[[ 27231  86345  11327]
 [ 21779 128869  25537]
 [ 10206  87337  27330]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091555
{'0': {'precision': 0.4720806020878854, 'recall': 0.17928268486077817, 'f1-score': 0.25987303708653525, 'support': 43384}, '1': {'precision': 0.34580764938410674, 'recall': 0.7401826178197486, 'f1-score': 0.47138693395891096, 'support': 44793}, '2': {'precision': 0.43759459186762184, 'recall': 0.19714532478749033, 'f1-score': 0.27182701347539956, 'support': 43998}, 'accuracy': 0.37531303196519766, 'macro avg': {'precision': 0.41849428111320464, 'recall': 0.372203542489339, 'f1-score': 0.3343623281736152, 'support': 132175}, 'weighted avg': {'precision': 0.41780816139840926, 'recall': 0.37531303196519766, 'f1-score': 0.3355325266705078, 'support': 132175}}
[[ 7778 31153  4453]
 [ 4943 33155  6695]
 [ 3755 31569  8674]]
training model: results/WBA/W5/deepOF_L1/h100
Epoch 1/50
1664/1664 - 44s - loss: 3.2652 - accuracy100: 0.3919 - val_loss: 3.3418 - val_accuracy100: 0.3261 - 44s/epoch - 26ms/step
Epoch 2/50
1664/1664 - 39s - loss: 3.2400 - accuracy100: 0.4001 - val_loss: 3.3504 - val_accuracy100: 0.3272 - 39s/epoch - 24ms/step
Epoch 3/50
1664/1664 - 40s - loss: 3.2287 - accuracy100: 0.4051 - val_loss: 3.3871 - val_accuracy100: 0.3151 - 40s/epoch - 24ms/step
Epoch 4/50
1664/1664 - 35s - loss: 3.2195 - accuracy100: 0.4107 - val_loss: 3.4293 - val_accuracy100: 0.3020 - 35s/epoch - 21ms/step
Epoch 5/50
1664/1664 - 39s - loss: 3.2107 - accuracy100: 0.4165 - val_loss: 3.4776 - val_accuracy100: 0.2962 - 39s/epoch - 23ms/step
Epoch 6/50
1664/1664 - 40s - loss: 3.2028 - accuracy100: 0.4221 - val_loss: 3.5028 - val_accuracy100: 0.2956 - 40s/epoch - 24ms/step
Epoch 7/50
1664/1664 - 41s - loss: 3.1968 - accuracy100: 0.4257 - val_loss: 3.5278 - val_accuracy100: 0.2946 - 41s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 42s - loss: 3.1921 - accuracy100: 0.4277 - val_loss: 3.5327 - val_accuracy100: 0.2924 - 42s/epoch - 25ms/step
Epoch 9/50
1664/1664 - 39s - loss: 3.1868 - accuracy100: 0.4310 - val_loss: 3.5441 - val_accuracy100: 0.2961 - 39s/epoch - 23ms/step
Epoch 10/50
1664/1664 - 39s - loss: 3.1838 - accuracy100: 0.4317 - val_loss: 3.5545 - val_accuracy100: 0.2971 - 39s/epoch - 24ms/step
Epoch 11/50
1664/1664 - 41s - loss: 3.1812 - accuracy100: 0.4335 - val_loss: 3.5629 - val_accuracy100: 0.2961 - 41s/epoch - 25ms/step
testing model: results/WBA/W5/deepOF_L1/h100
Evaluating performance on  test set...
7458/7458 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1407498
{'0': {'precision': 0.4507518912131328, 'recall': 0.11922361871124271, 'f1-score': 0.18857045846933448, 'support': 740667}, '1': {'precision': 0.21260725519757293, 'recall': 0.6694635666335369, 'f1-score': 0.32272422538875506, 'support': 409501}, '2': {'precision': 0.4430798410915988, 'recall': 0.24742911795625747, 'f1-score': 0.31753637032215526, 'support': 759078}, 'accuracy': 0.2882127290040152, 'macro avg': {'precision': 0.36881299583410154, 'recall': 0.3453721011003457, 'f1-score': 0.2762770180600816, 'support': 1909246}, 'weighted avg': {'precision': 0.39662363793662386, 'recall': 0.2882127290040152, 'f1-score': 0.26861843979006794, 'support': 1909246}}
[[ 88305 507001 145361]
 [ 44642 274146  90713]
 [ 62959 508301 187818]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945665
{'0': {'precision': 0.4745354520340944, 'recall': 0.13994359920621105, 'f1-score': 0.21614471306891508, 'support': 143615}, '1': {'precision': 0.33247675447739006, 'recall': 0.6939728958630528, 'f1-score': 0.4495687753126466, 'support': 140200}, '2': {'precision': 0.427388948126326, 'recall': 0.2735215904773965, 'f1-score': 0.33356640656837555, 'support': 142146}, 'accuracy': 0.36687161500700766, 'macro avg': {'precision': 0.4114670515459368, 'recall': 0.36914602851555345, 'f1-score': 0.33309329831664575, 'support': 425961}, 'weighted avg': {'precision': 0.41204542045391784, 'recall': 0.36687161500700766, 'f1-score': 0.3321578634999298, 'support': 425961}}
[[ 20098 101195  22322]
 [ 13136  97295  29769]
 [  9119  94147  38880]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.116472
{'0': {'precision': 0.48077959403628523, 'recall': 0.11244144768626463, 'f1-score': 0.1822577075637119, 'support': 47607}, '1': {'precision': 0.27278953719709076, 'recall': 0.6930917327293318, 'f1-score': 0.39149361084673834, 'support': 36203}, '2': {'precision': 0.43079358524330646, 'recall': 0.25882352941176473, 'f1-score': 0.3233664414967129, 'support': 48365}, 'accuracy': 0.3250463400794401, 'macro avg': {'precision': 0.3947875721588942, 'recall': 0.35478556994245375, 'f1-score': 0.29903925330238773, 'support': 132175}, 'weighted avg': {'precision': 0.4055199962074842, 'recall': 0.3250463400794401, 'f1-score': 0.2912018446790893, 'support': 132175}}
[[ 5353 33920  8334]
 [ 2905 25092  8206]
 [ 2876 32971 12518]]
training model: results/WBA/W5/deepOF_L1/h200
Epoch 1/50
1664/1664 - 44s - loss: 3.2963 - accuracy200: 0.3621 - val_loss: 3.3213 - val_accuracy200: 0.3538 - 44s/epoch - 26ms/step
Epoch 2/50
1664/1664 - 41s - loss: 3.2769 - accuracy200: 0.3685 - val_loss: 3.3086 - val_accuracy200: 0.3582 - 41s/epoch - 25ms/step
Epoch 3/50
1664/1664 - 43s - loss: 3.2711 - accuracy200: 0.3711 - val_loss: 3.3016 - val_accuracy200: 0.3632 - 43s/epoch - 26ms/step
Epoch 4/50
1664/1664 - 42s - loss: 3.2680 - accuracy200: 0.3724 - val_loss: 3.3034 - val_accuracy200: 0.3632 - 42s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 41s - loss: 3.2654 - accuracy200: 0.3742 - val_loss: 3.3124 - val_accuracy200: 0.3616 - 41s/epoch - 24ms/step
Epoch 6/50
1664/1664 - 39s - loss: 3.2634 - accuracy200: 0.3758 - val_loss: 3.3152 - val_accuracy200: 0.3579 - 39s/epoch - 23ms/step
Epoch 7/50
1664/1664 - 39s - loss: 3.2610 - accuracy200: 0.3775 - val_loss: 3.3198 - val_accuracy200: 0.3581 - 39s/epoch - 23ms/step
Epoch 8/50
1664/1664 - 39s - loss: 3.2594 - accuracy200: 0.3791 - val_loss: 3.3313 - val_accuracy200: 0.3545 - 39s/epoch - 23ms/step
Epoch 9/50
1664/1664 - 39s - loss: 3.2572 - accuracy200: 0.3810 - val_loss: 3.3419 - val_accuracy200: 0.3497 - 39s/epoch - 23ms/step
Epoch 10/50
1664/1664 - 40s - loss: 3.2558 - accuracy200: 0.3818 - val_loss: 3.3464 - val_accuracy200: 0.3467 - 40s/epoch - 24ms/step
Epoch 11/50
1664/1664 - 38s - loss: 3.2539 - accuracy200: 0.3836 - val_loss: 3.3563 - val_accuracy200: 0.3440 - 38s/epoch - 23ms/step
Epoch 12/50
1664/1664 - 41s - loss: 3.2523 - accuracy200: 0.3845 - val_loss: 3.3538 - val_accuracy200: 0.3457 - 41s/epoch - 25ms/step
Epoch 13/50
1664/1664 - 40s - loss: 3.2511 - accuracy200: 0.3858 - val_loss: 3.3687 - val_accuracy200: 0.3429 - 40s/epoch - 24ms/step
testing model: results/WBA/W5/deepOF_L1/h200
Evaluating performance on  test set...
7458/7458 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108612
{'0': {'precision': 0.4297655835440272, 'recall': 0.18314010715672868, 'f1-score': 0.256833363490355, 'support': 751796}, '1': {'precision': 0.21459253342175466, 'recall': 0.1790641577394502, 'f1-score': 0.19522508885086218, 'support': 397567}, '2': {'precision': 0.4136649243396273, 'recall': 0.684356670697989, 'f1-score': 0.5156444129787895, 'support': 759883}, 'accuracy': 0.3817763661675866, 'macro avg': {'precision': 0.35267434710180307, 'recall': 0.34885364519805595, 'f1-score': 0.3225676217733356, 'support': 1909246}, 'weighted avg': {'precision': 0.3785514805755368, 'recall': 0.3817763661675866, 'f1-score': 0.3470117374635469, 'support': 1909246}}
[[137684 135379 478733]
 [ 68010  71190 258367]
 [114676 125176 520031]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944364
{'0': {'precision': 0.3900988463338748, 'recall': 0.20140019190447422, 'f1-score': 0.26565041507877357, 'support': 140695}, '1': {'precision': 0.3675463504259228, 'recall': 0.17943978580845077, 'f1-score': 0.2411484826622588, 'support': 147158}, '2': {'precision': 0.3534686424209266, 'recall': 0.7204072175398963, 'f1-score': 0.4742472955549148, 'support': 138108}, 'accuracy': 0.3620894870657173, 'macro avg': {'precision': 0.3703712797269081, 'recall': 0.3670823984176071, 'f1-score': 0.3270153977653157, 'support': 425961}, 'weighted avg': {'precision': 0.3704310730052559, 'recall': 0.3620894870657173, 'f1-score': 0.3248183731741143, 'support': 425961}}
[[28336 25606 86753]
 [25520 26406 95232]
 [18782 19832 99494]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994638
{'0': {'precision': 0.3851194539249147, 'recall': 0.18854431225771956, 'f1-score': 0.2531520617400278, 'support': 44886}, '1': {'precision': 0.33076404277868776, 'recall': 0.16383897678192189, 'f1-score': 0.21913348759275517, 'support': 41907}, '2': {'precision': 0.36473916057333244, 'recall': 0.7188532898506016, 'f1-score': 0.483934611048478, 'support': 45382}, 'accuracy': 0.36279175335729147, 'macro avg': {'precision': 0.360207552425645, 'recall': 0.35707885963008107, 'f1-score': 0.31874005346042034, 'support': 132175}, 'weighted avg': {'precision': 0.3608881644391085, 'recall': 0.36279175335729147, 'f1-score': 0.32160492548828834, 'support': 132175}}
[[ 8463  7506 28917]
 [ 7139  6866 27902]
 [ 6373  6386 32623]]
training model: results/WBA/W5/deepOF_L1/h300
Epoch 1/50
1664/1664 - 45s - loss: 3.3045 - accuracy300: 0.3556 - val_loss: 3.3233 - val_accuracy300: 0.3501 - 45s/epoch - 27ms/step
Epoch 2/50
1664/1664 - 43s - loss: 3.2872 - accuracy300: 0.3616 - val_loss: 3.3113 - val_accuracy300: 0.3531 - 43s/epoch - 26ms/step
Epoch 3/50
1664/1664 - 42s - loss: 3.2827 - accuracy300: 0.3644 - val_loss: 3.2990 - val_accuracy300: 0.3563 - 42s/epoch - 25ms/step
Epoch 4/50
1664/1664 - 42s - loss: 3.2805 - accuracy300: 0.3669 - val_loss: 3.2962 - val_accuracy300: 0.3595 - 42s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 42s - loss: 3.2790 - accuracy300: 0.3674 - val_loss: 3.2942 - val_accuracy300: 0.3610 - 42s/epoch - 25ms/step
Epoch 6/50
1664/1664 - 40s - loss: 3.2778 - accuracy300: 0.3686 - val_loss: 3.2946 - val_accuracy300: 0.3629 - 40s/epoch - 24ms/step
Epoch 7/50
1664/1664 - 42s - loss: 3.2764 - accuracy300: 0.3698 - val_loss: 3.2959 - val_accuracy300: 0.3617 - 42s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 42s - loss: 3.2756 - accuracy300: 0.3698 - val_loss: 3.2961 - val_accuracy300: 0.3621 - 42s/epoch - 25ms/step
Epoch 9/50
1664/1664 - 42s - loss: 3.2745 - accuracy300: 0.3715 - val_loss: 3.2954 - val_accuracy300: 0.3621 - 42s/epoch - 25ms/step
Epoch 10/50
1664/1664 - 44s - loss: 3.2736 - accuracy300: 0.3715 - val_loss: 3.2975 - val_accuracy300: 0.3633 - 44s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 43s - loss: 3.2724 - accuracy300: 0.3727 - val_loss: 3.2970 - val_accuracy300: 0.3623 - 43s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 43s - loss: 3.2716 - accuracy300: 0.3739 - val_loss: 3.3022 - val_accuracy300: 0.3604 - 43s/epoch - 26ms/step
Epoch 13/50
1664/1664 - 44s - loss: 3.2710 - accuracy300: 0.3739 - val_loss: 3.3002 - val_accuracy300: 0.3619 - 44s/epoch - 27ms/step
Epoch 14/50
1664/1664 - 41s - loss: 3.2700 - accuracy300: 0.3747 - val_loss: 3.3012 - val_accuracy300: 0.3615 - 41s/epoch - 25ms/step
Epoch 15/50
1664/1664 - 42s - loss: 3.2694 - accuracy300: 0.3756 - val_loss: 3.3033 - val_accuracy300: 0.3603 - 42s/epoch - 25ms/step
testing model: results/WBA/W5/deepOF_L1/h300
Evaluating performance on  test set...
7458/7458 - 123s - 123s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029999
{'0': {'precision': 0.3854339545640049, 'recall': 0.1689283254880801, 'f1-score': 0.23490311254448495, 'support': 670894}, '1': {'precision': 0.30438532632778376, 'recall': 0.13753687183796057, 'f1-score': 0.18946414454971053, 'support': 559370}, '2': {'precision': 0.3675874561636576, 'recall': 0.7376057097242636, 'f1-score': 0.4906555973344254, 'support': 678982}, 'accuracy': 0.36196907051265265, 'macro avg': {'precision': 0.35246891235181543, 'recall': 0.34802363568343475, 'f1-score': 0.30500761814287364, 'support': 1909246}, 'weighted avg': {'precision': 0.3553416446398989, 'recall': 0.36196907051265265, 'f1-score': 0.3125432584976027, 'support': 1909246}}
[[113333  91577 465984]
 [ 86787  76934 395649]
 [ 93920  84241 500821]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972579
{'0': {'precision': 0.3907398502438689, 'recall': 0.19611358589968142, 'f1-score': 0.2611534276387378, 'support': 145018}, '1': {'precision': 0.3442462003209667, 'recall': 0.1315132717830352, 'f1-score': 0.19031862425302054, 'support': 138640}, '2': {'precision': 0.35501030941571093, 'recall': 0.7489511816335566, 'f1-score': 0.4816932345643302, 'support': 142303}, 'accuracy': 0.3597770687926829, 'macro avg': {'precision': 0.3633321199935155, 'recall': 0.3588593464387577, 'f1-score': 0.31105509548536286, 'support': 425961}, 'weighted avg': {'precision': 0.36367093906706977, 'recall': 0.3597770687926829, 'f1-score': 0.31177528974239693, 'support': 425961}}
[[ 28440  19272  97306]
 [ 24080  18233  96327]
 [ 20265  15460 106578]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996107
{'0': {'precision': 0.3883321403006442, 'recall': 0.19086990940276188, 'f1-score': 0.25594149908592323, 'support': 45476}, '1': {'precision': 0.3287167135019403, 'recall': 0.11957844521248114, 'f1-score': 0.17536407766990292, 'support': 41086}, '2': {'precision': 0.36118342696333144, 'recall': 0.7512770482099401, 'f1-score': 0.4878354331269129, 'support': 45613}, 'accuracy': 0.362103272177038, 'macro avg': {'precision': 0.35941076025530533, 'recall': 0.35390846760839434, 'f1-score': 0.3063803366275797, 'support': 132175}, 'weighted avg': {'precision': 0.3604320556635616, 'recall': 0.362103272177038, 'f1-score': 0.310919929780934, 'support': 132175}}
[[ 8680  5292 31504]
 [ 7068  4913 29105]
 [ 6604  4741 34268]]
training model: results/WBA/W5/deepOF_L1/h500
Epoch 1/50
1664/1664 - 46s - loss: 3.2657 - accuracy500: 0.3940 - val_loss: 3.3405 - val_accuracy500: 0.3604 - 46s/epoch - 28ms/step
Epoch 2/50
1664/1664 - 42s - loss: 3.2603 - accuracy500: 0.3933 - val_loss: 3.2890 - val_accuracy500: 0.3603 - 42s/epoch - 25ms/step
Epoch 3/50
1664/1664 - 41s - loss: 3.2778 - accuracy500: 0.3819 - val_loss: 3.2798 - val_accuracy500: 0.3610 - 41s/epoch - 25ms/step
Epoch 4/50
1664/1664 - 42s - loss: 3.2801 - accuracy500: 0.3766 - val_loss: 3.2757 - val_accuracy500: 0.3680 - 42s/epoch - 25ms/step
Epoch 5/50
1664/1664 - 45s - loss: 3.2801 - accuracy500: 0.3738 - val_loss: 3.2747 - val_accuracy500: 0.3704 - 45s/epoch - 27ms/step
Epoch 6/50
1664/1664 - 42s - loss: 3.2796 - accuracy500: 0.3735 - val_loss: 3.2741 - val_accuracy500: 0.3729 - 42s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 41s - loss: 3.2787 - accuracy500: 0.3740 - val_loss: 3.2756 - val_accuracy500: 0.3739 - 41s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 43s - loss: 3.2777 - accuracy500: 0.3750 - val_loss: 3.2772 - val_accuracy500: 0.3728 - 43s/epoch - 26ms/step
Epoch 9/50
1664/1664 - 43s - loss: 3.2783 - accuracy500: 0.3745 - val_loss: 3.2749 - val_accuracy500: 0.3745 - 43s/epoch - 26ms/step
Epoch 10/50
1664/1664 - 43s - loss: 3.2777 - accuracy500: 0.3755 - val_loss: 3.2779 - val_accuracy500: 0.3741 - 43s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 44s - loss: 3.2771 - accuracy500: 0.3756 - val_loss: 3.2787 - val_accuracy500: 0.3744 - 44s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 41s - loss: 3.2761 - accuracy500: 0.3767 - val_loss: 3.2785 - val_accuracy500: 0.3753 - 41s/epoch - 24ms/step
Epoch 13/50
1664/1664 - 44s - loss: 3.2756 - accuracy500: 0.3775 - val_loss: 3.2782 - val_accuracy500: 0.3745 - 44s/epoch - 26ms/step
Epoch 14/50
1664/1664 - 44s - loss: 3.2750 - accuracy500: 0.3785 - val_loss: 3.2766 - val_accuracy500: 0.3760 - 44s/epoch - 26ms/step
Epoch 15/50
1664/1664 - 43s - loss: 3.2740 - accuracy500: 0.3786 - val_loss: 3.2771 - val_accuracy500: 0.3755 - 43s/epoch - 26ms/step
Epoch 16/50
1664/1664 - 44s - loss: 3.2739 - accuracy500: 0.3788 - val_loss: 3.2767 - val_accuracy500: 0.3758 - 44s/epoch - 26ms/step
testing model: results/WBA/W5/deepOF_L1/h500
Evaluating performance on  test set...
7458/7458 - 119s - 119s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0851395
{'0': {'precision': 0.4049972731426662, 'recall': 0.2290102739916319, 'f1-score': 0.2925786511769059, 'support': 719876}, '1': {'precision': 0.2126984126984127, 'recall': 0.00014591132511438795, 'f1-score': 0.0002916225968339362, 'support': 459183}, '2': {'precision': 0.39123319011178737, 'recall': 0.8046993441406105, 'f1-score': 0.5264930628980634, 'support': 730187}, 'accuracy': 0.39413831428742024, 'macro avg': {'precision': 0.3363096253176221, 'recall': 0.34461850981911896, 'f1-score': 0.2731211122239344, 'support': 1909246}, 'weighted avg': {'precision': 0.35348441302330913, 'recall': 0.39413831428742024, 'f1-score': 0.3117422518375613, 'support': 1909246}}
[[164859    128 554889]
 [ 99717     67 359399]
 [142486    120 587581]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006023
{'0': {'precision': 0.37050532904383604, 'recall': 0.23429077547970134, 'f1-score': 0.2870586639423831, 'support': 144517}, '1': {'precision': 0.37254901960784315, 'recall': 0.00040965933592065543, 'f1-score': 0.0008184187288664901, 'support': 139140}, '2': {'precision': 0.34638271405589344, 'recall': 0.8140178772205982, 'f1-score': 0.48597307468021456, 'support': 142304}, 'accuracy': 0.3515673970152197, 'macro avg': {'precision': 0.3631456875691909, 'recall': 0.3495727706787401, 'f1-score': 0.2579500524504881, 'support': 425961}, 'weighted avg': {'precision': 0.3631140760930536, 'recall': 0.3515673970152197, 'f1-score': 0.26001123139956267, 'support': 425961}}
[[ 33859     53 110605]
 [ 31104     57 107979]
 [ 26423     43 115838]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919797
{'0': {'precision': 0.39053540844441137, 'recall': 0.2192470893166949, 'f1-score': 0.2808337461010188, 'support': 47841}, '1': {'precision': 0.29411764705882354, 'recall': 0.00027170959678295836, 'f1-score': 0.0005429176393941039, 'support': 36804}, '2': {'precision': 0.36817909823998174, 'recall': 0.8155480749000631, 'f1-score': 0.5073259473997632, 'support': 47530}, 'accuracy': 0.37270285606203896, 'macro avg': {'precision': 0.35094405124773886, 'recall': 0.3450222912711803, 'f1-score': 0.2629008703800587, 'support': 132175}, 'weighted avg': {'precision': 0.35564866954483343, 'recall': 0.37270285606203896, 'f1-score': 0.28423341076549913, 'support': 132175}}
[[10489    15 37337]
 [ 7611    10 29183]
 [ 8758     9 38763]]
training model: results/WBA/W5/deepOF_L1/h1000
Epoch 1/50
1664/1664 - 44s - loss: 3.3000 - accuracy1000: 0.3666 - val_loss: 3.3806 - val_accuracy1000: 0.3490 - 44s/epoch - 26ms/step
Epoch 2/50
1664/1664 - 43s - loss: 3.2920 - accuracy1000: 0.3598 - val_loss: 3.3101 - val_accuracy1000: 0.3485 - 43s/epoch - 26ms/step
Epoch 3/50
1664/1664 - 41s - loss: 3.2929 - accuracy1000: 0.3553 - val_loss: 3.3069 - val_accuracy1000: 0.3417 - 41s/epoch - 25ms/step
Epoch 4/50
1664/1664 - 43s - loss: 3.2918 - accuracy1000: 0.3548 - val_loss: 3.3053 - val_accuracy1000: 0.3327 - 43s/epoch - 26ms/step
Epoch 5/50
1664/1664 - 43s - loss: 3.2899 - accuracy1000: 0.3566 - val_loss: 3.3122 - val_accuracy1000: 0.3217 - 43s/epoch - 26ms/step
Epoch 6/50
1664/1664 - 41s - loss: 3.2884 - accuracy1000: 0.3583 - val_loss: 3.3167 - val_accuracy1000: 0.3146 - 41s/epoch - 25ms/step
Epoch 7/50
1664/1664 - 42s - loss: 3.2865 - accuracy1000: 0.3597 - val_loss: 3.3307 - val_accuracy1000: 0.3073 - 42s/epoch - 25ms/step
Epoch 8/50
1664/1664 - 41s - loss: 3.2848 - accuracy1000: 0.3614 - val_loss: 3.3488 - val_accuracy1000: 0.3056 - 41s/epoch - 25ms/step
Epoch 9/50
1664/1664 - 43s - loss: 3.2832 - accuracy1000: 0.3632 - val_loss: 3.3563 - val_accuracy1000: 0.3057 - 43s/epoch - 26ms/step
Epoch 10/50
1664/1664 - 43s - loss: 3.2819 - accuracy1000: 0.3643 - val_loss: 3.3664 - val_accuracy1000: 0.3054 - 43s/epoch - 26ms/step
Epoch 11/50
1664/1664 - 43s - loss: 3.2800 - accuracy1000: 0.3664 - val_loss: 3.3744 - val_accuracy1000: 0.3057 - 43s/epoch - 26ms/step
Epoch 12/50
1664/1664 - 43s - loss: 3.2790 - accuracy1000: 0.3668 - val_loss: 3.3811 - val_accuracy1000: 0.3056 - 43s/epoch - 26ms/step
Epoch 13/50
1664/1664 - 44s - loss: 3.2780 - accuracy1000: 0.3676 - val_loss: 3.3837 - val_accuracy1000: 0.3058 - 44s/epoch - 26ms/step
Epoch 14/50
1664/1664 - 44s - loss: 3.2773 - accuracy1000: 0.3687 - val_loss: 3.3853 - val_accuracy1000: 0.3056 - 44s/epoch - 26ms/step
testing model: results/WBA/W5/deepOF_L1/h1000
Evaluating performance on  test set...
7458/7458 - 125s - 125s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087052
{'0': {'precision': 0.4404624789580934, 'recall': 0.01272653501109076, 'f1-score': 0.02473829235372051, 'support': 781281}, '1': {'precision': 0.17588537047027733, 'recall': 0.40561098458831896, 'f1-score': 0.24537054332504468, 'support': 331956}, '2': {'precision': 0.4239139451186064, 'recall': 0.5970648573068897, 'f1-score': 0.4958068052957665, 'support': 796009}, 'accuracy': 0.3246606251892108, 'macro avg': {'precision': 0.3467539315156591, 'recall': 0.33846745896876645, 'f1-score': 0.2553052136581772, 'support': 1909246}, 'weighted avg': {'precision': 0.38756162673778355, 'recall': 0.3246606251892108, 'f1-score': 0.259498493722178, 'support': 1909246}}
[[  9943 318423 452915]
 [  4350 134645 192961]
 [  8281 312459 475269]]
Evaluating performance on  train set...
1664/1664 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001339
{'0': {'precision': 0.3608095676172953, 'recall': 0.01376613712785449, 'f1-score': 0.026520427897164033, 'support': 142451}, '1': {'precision': 0.33803754915641254, 'recall': 0.37584096134046063, 'f1-score': 0.35593831604677717, 'support': 141802}, '2': {'precision': 0.34133741145678786, 'recall': 0.6331752618059672, 'f1-score': 0.44355791523923926, 'support': 141708}, 'accuracy': 0.34036449346301656, 'macro avg': {'precision': 0.34672817607683193, 'recall': 0.3409274534247608, 'f1-score': 0.27533888639439347, 'support': 425961}, 'weighted avg': {'precision': 0.3467508202977443, 'recall': 0.34036449346301656, 'f1-score': 0.2749226610397809, 'support': 425961}}
[[ 1961 53979 86511]
 [ 1878 53295 86629]
 [ 1596 50386 89726]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020813
{'0': {'precision': 0.37155297532656023, 'recall': 0.011196396159986004, 'f1-score': 0.02173774598255036, 'support': 45729}, '1': {'precision': 0.3027351456875247, 'recall': 0.3603262884686689, 'f1-score': 0.3290296368191771, 'support': 40455}, '2': {'precision': 0.3516564625027225, 'recall': 0.6319279859102868, 'f1-score': 0.4518606621734027, 'support': 45991}, 'accuracy': 0.3340419897862682, 'macro avg': {'precision': 0.3419815278389358, 'recall': 0.33448355684631387, 'f1-score': 0.26754268165837675, 'support': 132175}, 'weighted avg': {'precision': 0.3435667009227145, 'recall': 0.3340419897862682, 'f1-score': 0.26545460985491065, 'support': 132175}}
[[  512 17054 28163]
 [  458 14577 25420]
 [  408 16520 29063]]
training model: results/WBA/W5/deepLOB_L2/h10
Epoch 1/50
1664/1664 - 87s - loss: 2.9352 - accuracy10: 0.4321 - val_loss: 3.5356 - val_accuracy10: 0.4856 - 87s/epoch - 52ms/step
Epoch 2/50
1664/1664 - 82s - loss: 2.7155 - accuracy10: 0.4927 - val_loss: 3.4862 - val_accuracy10: 0.5156 - 82s/epoch - 50ms/step
Epoch 3/50
1664/1664 - 81s - loss: 2.6189 - accuracy10: 0.5372 - val_loss: 3.3667 - val_accuracy10: 0.5201 - 81s/epoch - 49ms/step
Epoch 4/50
1664/1664 - 82s - loss: 2.5545 - accuracy10: 0.5642 - val_loss: 3.2037 - val_accuracy10: 0.5168 - 82s/epoch - 49ms/step
Epoch 5/50
1664/1664 - 83s - loss: 2.4901 - accuracy10: 0.5850 - val_loss: 3.1067 - val_accuracy10: 0.5369 - 83s/epoch - 50ms/step
Epoch 6/50
1664/1664 - 83s - loss: 2.4490 - accuracy10: 0.5954 - val_loss: 3.0670 - val_accuracy10: 0.5398 - 83s/epoch - 50ms/step
Epoch 7/50
1664/1664 - 84s - loss: 2.4209 - accuracy10: 0.6002 - val_loss: 3.0791 - val_accuracy10: 0.5386 - 84s/epoch - 50ms/step
Epoch 8/50
1664/1664 - 82s - loss: 2.4020 - accuracy10: 0.6044 - val_loss: 3.0668 - val_accuracy10: 0.5418 - 82s/epoch - 49ms/step
Epoch 9/50
1664/1664 - 82s - loss: 2.3840 - accuracy10: 0.6069 - val_loss: 3.0623 - val_accuracy10: 0.5453 - 82s/epoch - 50ms/step
Epoch 10/50
1664/1664 - 81s - loss: 2.3691 - accuracy10: 0.6082 - val_loss: 3.0347 - val_accuracy10: 0.5422 - 81s/epoch - 49ms/step
Epoch 11/50
1664/1664 - 82s - loss: 2.3541 - accuracy10: 0.6098 - val_loss: 3.0396 - val_accuracy10: 0.5491 - 82s/epoch - 49ms/step
Epoch 12/50
1664/1664 - 82s - loss: 2.3421 - accuracy10: 0.6109 - val_loss: 2.9951 - val_accuracy10: 0.5428 - 82s/epoch - 49ms/step
Epoch 13/50
1664/1664 - 81s - loss: 2.3312 - accuracy10: 0.6118 - val_loss: 2.9968 - val_accuracy10: 0.5467 - 81s/epoch - 49ms/step
Epoch 14/50
1664/1664 - 80s - loss: 2.3198 - accuracy10: 0.6135 - val_loss: 2.9940 - val_accuracy10: 0.5486 - 80s/epoch - 48ms/step
Epoch 15/50
1664/1664 - 81s - loss: 2.3107 - accuracy10: 0.6138 - val_loss: 2.9921 - val_accuracy10: 0.5458 - 81s/epoch - 48ms/step
Epoch 16/50
1664/1664 - 81s - loss: 2.3021 - accuracy10: 0.6154 - val_loss: 2.9743 - val_accuracy10: 0.5458 - 81s/epoch - 49ms/step
Epoch 17/50
1664/1664 - 81s - loss: 2.2926 - accuracy10: 0.6163 - val_loss: 2.9750 - val_accuracy10: 0.5529 - 81s/epoch - 49ms/step
Epoch 18/50
1664/1664 - 81s - loss: 2.2858 - accuracy10: 0.6171 - val_loss: 2.9807 - val_accuracy10: 0.5487 - 81s/epoch - 49ms/step
Epoch 19/50
1664/1664 - 82s - loss: 2.2781 - accuracy10: 0.6184 - val_loss: 2.9984 - val_accuracy10: 0.5525 - 82s/epoch - 49ms/step
Epoch 20/50
1664/1664 - 82s - loss: 2.2697 - accuracy10: 0.6189 - val_loss: 3.0357 - val_accuracy10: 0.5520 - 82s/epoch - 49ms/step
Epoch 21/50
1664/1664 - 81s - loss: 2.2643 - accuracy10: 0.6197 - val_loss: 3.0134 - val_accuracy10: 0.5439 - 81s/epoch - 49ms/step
Epoch 22/50
1664/1664 - 81s - loss: 2.2573 - accuracy10: 0.6196 - val_loss: 3.0248 - val_accuracy10: 0.5520 - 81s/epoch - 49ms/step
Epoch 23/50
1664/1664 - 81s - loss: 2.2503 - accuracy10: 0.6201 - val_loss: 3.0146 - val_accuracy10: 0.5436 - 81s/epoch - 48ms/step
Epoch 24/50
1664/1664 - 79s - loss: 2.2440 - accuracy10: 0.6216 - val_loss: 3.0051 - val_accuracy10: 0.5485 - 79s/epoch - 47ms/step
Epoch 25/50
1664/1664 - 79s - loss: 2.2388 - accuracy10: 0.6214 - val_loss: 3.0142 - val_accuracy10: 0.5510 - 79s/epoch - 48ms/step
Epoch 26/50
1664/1664 - 79s - loss: 2.2323 - accuracy10: 0.6227 - val_loss: 3.0148 - val_accuracy10: 0.5493 - 79s/epoch - 47ms/step
testing model: results/WBA/W5/deepLOB_L2/h10
Evaluating performance on  test set...
7459/7459 - 147s - 147s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95453185
{'0': {'precision': 0.44784582733765677, 'recall': 0.4914544602405874, 'f1-score': 0.4686378408606488, 'support': 416065}, '1': {'precision': 0.7131431539286861, 'recall': 0.5911899921725329, 'f1-score': 0.6464653556481468, 'support': 1059091}, '2': {'precision': 0.40814416019655675, 'recall': 0.5403379444591622, 'f1-score': 0.46502886133770294, 'support': 434095}, 'accuracy': 0.5578936452043236, 'macro avg': {'precision': 0.5230443804876332, 'recall': 0.5409941322907609, 'f1-score': 0.5267106859488329, 'support': 1909251}, 'weighted avg': {'precision': 0.5859836183976086, 'recall': 0.5578936452043236, 'f1-score': 0.5664609560496904, 'support': 1909251}}
[[204477 125550  86038]
 [178869 626124 254098]
 [ 73233 126304 234558]]
Evaluating performance on  train set...
1664/1664 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8499084
{'0': {'precision': 0.39197826170155764, 'recall': 0.6141208214660471, 'f1-score': 0.4785254575823765, 'support': 66710}, '1': {'precision': 0.8836562958388018, 'recall': 0.5489556605357185, 'f1-score': 0.6772079814220421, 'support': 291907}, '2': {'precision': 0.33945969094607614, 'recall': 0.7062037834466783, 'f1-score': 0.4585179150739211, 'support': 67346}, 'accuracy': 0.5840225559496952, 'macro avg': {'precision': 0.5383647494954785, 'recall': 0.623093421816148, 'f1-score': 0.53808378469278, 'support': 425963}, 'weighted avg': {'precision': 0.7206155946267221, 'recall': 0.5840225559496952, 'f1-score': 0.6115168007945588, 'support': 425963}}
[[ 40968  11889  13853]
 [ 52971 160244  78692]
 [ 10577   9209  47560]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.920857
{'0': {'precision': 0.4083879643637586, 'recall': 0.5807107003426022, 'f1-score': 0.4795381275083887, 'support': 25102}, '1': {'precision': 0.8519245540667406, 'recall': 0.4888225067946426, 'f1-score': 0.6212057565149748, 'support': 81682}, '2': {'precision': 0.3592534365300117, 'recall': 0.7019533711405167, 'f1-score': 0.4752686451750527, 'support': 25392}, 'accuracy': 0.5472173465682121, 'macro avg': {'precision': 0.5398553183201703, 'recall': 0.5904955260925872, 'f1-score': 0.5253375097328054, 'support': 132176}, 'weighted avg': {'precision': 0.6730451773930867, 'recall': 0.5472173465682121, 'f1-score': 0.5662655559152696, 'support': 132176}}
[[14577  3899  6626]
 [16590 39928 25164]
 [ 4527  3041 17824]]
training model: results/WBA/W5/deepLOB_L2/h20
Epoch 1/50
1664/1664 - 82s - loss: 3.0346 - accuracy20: 0.4383 - val_loss: 3.6311 - val_accuracy20: 0.5099 - 82s/epoch - 49ms/step
Epoch 2/50
1664/1664 - 79s - loss: 2.8396 - accuracy20: 0.4882 - val_loss: 3.5581 - val_accuracy20: 0.4765 - 79s/epoch - 48ms/step
Epoch 3/50
1664/1664 - 78s - loss: 2.7337 - accuracy20: 0.5316 - val_loss: 3.2365 - val_accuracy20: 0.4692 - 78s/epoch - 47ms/step
Epoch 4/50
1664/1664 - 79s - loss: 2.6714 - accuracy20: 0.5542 - val_loss: 3.1578 - val_accuracy20: 0.4901 - 79s/epoch - 47ms/step
Epoch 5/50
1664/1664 - 79s - loss: 2.6193 - accuracy20: 0.5711 - val_loss: 3.1661 - val_accuracy20: 0.4932 - 79s/epoch - 47ms/step
Epoch 6/50
1664/1664 - 79s - loss: 2.5795 - accuracy20: 0.5801 - val_loss: 3.1884 - val_accuracy20: 0.4978 - 79s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 79s - loss: 2.5491 - accuracy20: 0.5875 - val_loss: 3.1067 - val_accuracy20: 0.5237 - 79s/epoch - 47ms/step
Epoch 8/50
1664/1664 - 80s - loss: 2.5245 - accuracy20: 0.5924 - val_loss: 3.1154 - val_accuracy20: 0.5285 - 80s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 79s - loss: 2.5019 - accuracy20: 0.5972 - val_loss: 3.1045 - val_accuracy20: 0.5194 - 79s/epoch - 47ms/step
Epoch 10/50
1664/1664 - 78s - loss: 2.4879 - accuracy20: 0.6006 - val_loss: 3.0506 - val_accuracy20: 0.5317 - 78s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 77s - loss: 2.4722 - accuracy20: 0.6031 - val_loss: 3.0519 - val_accuracy20: 0.5280 - 77s/epoch - 47ms/step
Epoch 12/50
1664/1664 - 78s - loss: 2.4610 - accuracy20: 0.6051 - val_loss: 3.0455 - val_accuracy20: 0.5238 - 78s/epoch - 47ms/step
Epoch 13/50
1664/1664 - 79s - loss: 2.4486 - accuracy20: 0.6074 - val_loss: 3.0840 - val_accuracy20: 0.5167 - 79s/epoch - 48ms/step
Epoch 14/50
1664/1664 - 78s - loss: 2.4397 - accuracy20: 0.6079 - val_loss: 3.0933 - val_accuracy20: 0.5243 - 78s/epoch - 47ms/step
Epoch 15/50
1664/1664 - 78s - loss: 2.4312 - accuracy20: 0.6097 - val_loss: 3.1027 - val_accuracy20: 0.5259 - 78s/epoch - 47ms/step
Epoch 16/50
1664/1664 - 79s - loss: 2.4245 - accuracy20: 0.6108 - val_loss: 3.1204 - val_accuracy20: 0.5172 - 79s/epoch - 48ms/step
Epoch 17/50
1664/1664 - 79s - loss: 2.4159 - accuracy20: 0.6122 - val_loss: 3.0947 - val_accuracy20: 0.5248 - 79s/epoch - 47ms/step
Epoch 18/50
1664/1664 - 80s - loss: 2.4096 - accuracy20: 0.6133 - val_loss: 3.0909 - val_accuracy20: 0.5205 - 80s/epoch - 48ms/step
Epoch 19/50
1664/1664 - 81s - loss: 2.4037 - accuracy20: 0.6142 - val_loss: 3.0982 - val_accuracy20: 0.5249 - 81s/epoch - 49ms/step
Epoch 20/50
1664/1664 - 81s - loss: 2.3966 - accuracy20: 0.6151 - val_loss: 3.1230 - val_accuracy20: 0.5264 - 81s/epoch - 49ms/step
Epoch 21/50
1664/1664 - 80s - loss: 2.3898 - accuracy20: 0.6158 - val_loss: 3.0741 - val_accuracy20: 0.5267 - 80s/epoch - 48ms/step
Epoch 22/50
1664/1664 - 80s - loss: 2.3850 - accuracy20: 0.6168 - val_loss: 3.0741 - val_accuracy20: 0.5282 - 80s/epoch - 48ms/step
testing model: results/WBA/W5/deepLOB_L2/h20
Evaluating performance on  test set...
7459/7459 - 142s - 142s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0669404
{'0': {'precision': 0.4955130925657952, 'recall': 0.3650297389227692, 'f1-score': 0.42037887759572795, 'support': 530954}, '1': {'precision': 0.5827077107725469, 'recall': 0.463385921192473, 'f1-score': 0.5162416462378827, 'support': 821419}, '2': {'precision': 0.40960253070596847, 'recall': 0.6361608826349757, 'f1-score': 0.4983404547132986, 'support': 556878}, 'accuracy': 0.48642740006421364, 'macro avg': {'precision': 0.49594111134810354, 'recall': 0.48819218091673927, 'f1-score': 0.4783203261823031, 'support': 1909251}, 'weighted avg': {'precision': 0.5079690840647627, 'recall': 0.48642740006421364, 'f1-score': 0.48436134333614056, 'support': 1909251}}
[[193814 147222 189918]
 [120070 380634 320715]
 [ 77254 125360 354264]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92044884
{'0': {'precision': 0.4633172234319401, 'recall': 0.49386336360136773, 'f1-score': 0.47810288983761445, 'support': 88322}, '1': {'precision': 0.8125526679475511, 'recall': 0.48463623131297695, 'f1-score': 0.60714744469659, 'support': 248702}, '2': {'precision': 0.36297095643738114, 'recall': 0.7488166046391347, 'f1-score': 0.48893995345456687, 'support': 88939}, 'accuracy': 0.5417090216755915, 'macro avg': {'precision': 0.5462802826056241, 'recall': 0.5757720665178264, 'f1-score': 0.5247300959962571, 'support': 425963}, 'weighted avg': {'precision': 0.6462693974040747, 'recall': 0.5417090216755915, 'f1-score': 0.5557093403592913, 'support': 425963}}
[[ 43619  16524  28179]
 [ 39467 120530  88705]
 [ 11059  11281  66599]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9587285
{'0': {'precision': 0.4789983584923879, 'recall': 0.4591226013450978, 'f1-score': 0.46884992832726874, 'support': 32414}, '1': {'precision': 0.7677640777933138, 'recall': 0.4502355537002803, 'f1-score': 0.5676104913965662, 'support': 67076}, '2': {'precision': 0.3925726866541475, 'recall': 0.7419078504558526, 'f1-score': 0.5134557157678544, 'support': 32686}, 'accuracy': 0.5245430335310495, 'macro avg': {'precision': 0.5464450409799497, 'recall': 0.5504220018337436, 'f1-score': 0.5166387118305632, 'support': 132176}, 'weighted avg': {'precision': 0.6041673746384673, 'recall': 0.5245430335310495, 'f1-score': 0.5299990650594983, 'support': 132176}}
[[14882  5396 12136]
 [11490 30200 25386]
 [ 4697  3739 24250]]
training model: results/WBA/W5/deepLOB_L2/h30
Epoch 1/50
1664/1664 - 83s - loss: 3.0428 - accuracy30: 0.4564 - val_loss: 3.6082 - val_accuracy30: 0.4860 - 83s/epoch - 50ms/step
Epoch 2/50
1664/1664 - 79s - loss: 2.8684 - accuracy30: 0.5016 - val_loss: 3.4091 - val_accuracy30: 0.4942 - 79s/epoch - 47ms/step
Epoch 3/50
1664/1664 - 79s - loss: 2.7992 - accuracy30: 0.5279 - val_loss: 3.3593 - val_accuracy30: 0.4989 - 79s/epoch - 47ms/step
Epoch 4/50
1664/1664 - 79s - loss: 2.7476 - accuracy30: 0.5472 - val_loss: 3.2664 - val_accuracy30: 0.5083 - 79s/epoch - 47ms/step
Epoch 5/50
1664/1664 - 80s - loss: 2.6983 - accuracy30: 0.5624 - val_loss: 3.1891 - val_accuracy30: 0.5271 - 80s/epoch - 48ms/step
Epoch 6/50
1664/1664 - 79s - loss: 2.6556 - accuracy30: 0.5734 - val_loss: 3.1650 - val_accuracy30: 0.5246 - 79s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 81s - loss: 2.6252 - accuracy30: 0.5806 - val_loss: 3.1086 - val_accuracy30: 0.5197 - 81s/epoch - 48ms/step
Epoch 8/50
1664/1664 - 79s - loss: 2.6015 - accuracy30: 0.5864 - val_loss: 3.0871 - val_accuracy30: 0.5215 - 79s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 79s - loss: 2.5845 - accuracy30: 0.5891 - val_loss: 3.0751 - val_accuracy30: 0.5284 - 79s/epoch - 47ms/step
Epoch 10/50
1664/1664 - 78s - loss: 2.5708 - accuracy30: 0.5923 - val_loss: 3.0759 - val_accuracy30: 0.5266 - 78s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 79s - loss: 2.5589 - accuracy30: 0.5928 - val_loss: 3.0206 - val_accuracy30: 0.5357 - 79s/epoch - 48ms/step
Epoch 12/50
1664/1664 - 80s - loss: 2.5501 - accuracy30: 0.5946 - val_loss: 3.0386 - val_accuracy30: 0.5408 - 80s/epoch - 48ms/step
Epoch 13/50
1664/1664 - 80s - loss: 2.5405 - accuracy30: 0.5956 - val_loss: 3.0261 - val_accuracy30: 0.5389 - 80s/epoch - 48ms/step
Epoch 14/50
1664/1664 - 79s - loss: 2.5322 - accuracy30: 0.5970 - val_loss: 2.9914 - val_accuracy30: 0.5399 - 79s/epoch - 47ms/step
Epoch 15/50
1664/1664 - 80s - loss: 2.5244 - accuracy30: 0.5981 - val_loss: 2.9911 - val_accuracy30: 0.5454 - 80s/epoch - 48ms/step
Epoch 16/50
1664/1664 - 79s - loss: 2.5173 - accuracy30: 0.5997 - val_loss: 2.9968 - val_accuracy30: 0.5433 - 79s/epoch - 47ms/step
Epoch 17/50
1664/1664 - 79s - loss: 2.5107 - accuracy30: 0.6007 - val_loss: 3.0048 - val_accuracy30: 0.5444 - 79s/epoch - 47ms/step
Epoch 18/50
1664/1664 - 79s - loss: 2.5059 - accuracy30: 0.6010 - val_loss: 2.9937 - val_accuracy30: 0.5477 - 79s/epoch - 47ms/step
Epoch 19/50
1664/1664 - 79s - loss: 2.4981 - accuracy30: 0.6024 - val_loss: 2.9808 - val_accuracy30: 0.5448 - 79s/epoch - 47ms/step
Epoch 20/50
1664/1664 - 79s - loss: 2.4925 - accuracy30: 0.6039 - val_loss: 2.9938 - val_accuracy30: 0.5421 - 79s/epoch - 47ms/step
Epoch 21/50
1664/1664 - 79s - loss: 2.4883 - accuracy30: 0.6040 - val_loss: 2.9961 - val_accuracy30: 0.5471 - 79s/epoch - 48ms/step
Epoch 22/50
1664/1664 - 80s - loss: 2.4824 - accuracy30: 0.6050 - val_loss: 3.0044 - val_accuracy30: 0.5439 - 80s/epoch - 48ms/step
Epoch 23/50
1664/1664 - 81s - loss: 2.4772 - accuracy30: 0.6055 - val_loss: 2.9836 - val_accuracy30: 0.5448 - 81s/epoch - 48ms/step
Epoch 24/50
1664/1664 - 81s - loss: 2.4711 - accuracy30: 0.6065 - val_loss: 3.0189 - val_accuracy30: 0.5397 - 81s/epoch - 49ms/step
Epoch 25/50
1664/1664 - 80s - loss: 2.4674 - accuracy30: 0.6079 - val_loss: 3.0055 - val_accuracy30: 0.5446 - 80s/epoch - 48ms/step
Epoch 26/50
1664/1664 - 79s - loss: 2.4616 - accuracy30: 0.6087 - val_loss: 3.0266 - val_accuracy30: 0.5363 - 79s/epoch - 47ms/step
Epoch 27/50
1664/1664 - 78s - loss: 2.4556 - accuracy30: 0.6095 - val_loss: 3.0214 - val_accuracy30: 0.5353 - 78s/epoch - 47ms/step
Epoch 28/50
1664/1664 - 79s - loss: 2.4512 - accuracy30: 0.6102 - val_loss: 3.0327 - val_accuracy30: 0.5340 - 79s/epoch - 47ms/step
Epoch 29/50
1664/1664 - 80s - loss: 2.4473 - accuracy30: 0.6111 - val_loss: 3.0484 - val_accuracy30: 0.5382 - 80s/epoch - 48ms/step
testing model: results/WBA/W5/deepLOB_L2/h30
Evaluating performance on  test set...
7459/7459 - 142s - 142s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0829681
{'0': {'precision': 0.5638486674232788, 'recall': 0.24382419203963057, 'f1-score': 0.3404347296219053, 'support': 607208}, '1': {'precision': 0.4712885732375368, 'recall': 0.6177963081854718, 'f1-score': 0.5346880589430564, 'support': 665093}, '2': {'precision': 0.4688027939067846, 'recall': 0.5702833817411099, 'f1-score': 0.514587623133649, 'support': 636950}, 'accuracy': 0.48300930574345646, 'macro avg': {'precision': 0.5013133448558666, 'recall': 0.4773012939887374, 'f1-score': 0.4632368038995369, 'support': 1909251}, 'weighted avg': {'precision': 0.4998966046203217, 'recall': 0.48300930574345646, 'f1-score': 0.466203010000178, 'support': 1909251}}
[[148052 250784 208372]
 [ 50986 410892 203215]
 [ 63536 210172 363242]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8759764
{'0': {'precision': 0.5373792292715183, 'recall': 0.4232924676627473, 'f1-score': 0.4735615314887555, 'support': 103673}, '1': {'precision': 0.7258832705487976, 'recall': 0.601369341955116, 'f1-score': 0.6577857758707116, 'support': 218207}, '2': {'precision': 0.43419580120227735, 'recall': 0.6821575089111575, 'f1-score': 0.5306383264949216, 'support': 104083}, 'accuracy': 0.5777684916295547, 'macro avg': {'precision': 0.5658194336741977, 'recall': 0.5689397728430069, 'f1-score': 0.5539952112847962, 'support': 425963}, 'weighted avg': {'precision': 0.6087311086395867, 'recall': 0.5777684916295547, 'f1-score': 0.5818801970735136, 'support': 425963}}
[[ 43884  29495  30294]
 [ 24756 131223  62228]
 [ 13023  20059  71001]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92938733
{'0': {'precision': 0.5215585643380491, 'recall': 0.4146734315857292, 'f1-score': 0.4620147155590118, 'support': 37251}, '1': {'precision': 0.6804282673847891, 'recall': 0.5459979436418452, 'f1-score': 0.6058455558885805, 'support': 57383}, '2': {'precision': 0.4501619096491073, 'recall': 0.6776410420329231, 'f1-score': 0.5409600765509542, 'support': 37542}, 'accuracy': 0.5463775571964653, 'macro avg': {'precision': 0.5507162471239818, 'recall': 0.5461041390868325, 'f1-score': 0.5362734493328488, 'support': 132176}, 'weighted avg': {'precision': 0.5702515718401586, 'recall': 0.5463775571964653, 'f1-score': 0.546880438935352, 'support': 132176}}
[[15447  8598 13206]
 [ 8185 31331 17867]
 [ 5985  6117 25440]]
training model: results/WBA/W5/deepLOB_L2/h50
Epoch 1/50
1664/1664 - 82s - loss: 3.1138 - accuracy50: 0.4488 - val_loss: 3.5707 - val_accuracy50: 0.3971 - 82s/epoch - 49ms/step
Epoch 2/50
1664/1664 - 79s - loss: 2.9884 - accuracy50: 0.4844 - val_loss: 3.4905 - val_accuracy50: 0.4343 - 79s/epoch - 47ms/step
Epoch 3/50
1664/1664 - 78s - loss: 2.9375 - accuracy50: 0.5033 - val_loss: 3.4242 - val_accuracy50: 0.4531 - 78s/epoch - 47ms/step
Epoch 4/50
1664/1664 - 79s - loss: 2.8991 - accuracy50: 0.5180 - val_loss: 3.3196 - val_accuracy50: 0.4727 - 79s/epoch - 48ms/step
Epoch 5/50
1664/1664 - 79s - loss: 2.8685 - accuracy50: 0.5263 - val_loss: 3.2792 - val_accuracy50: 0.4830 - 79s/epoch - 48ms/step
Epoch 6/50
1664/1664 - 80s - loss: 2.8383 - accuracy50: 0.5339 - val_loss: 3.2978 - val_accuracy50: 0.4769 - 80s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 81s - loss: 2.8132 - accuracy50: 0.5408 - val_loss: 3.2279 - val_accuracy50: 0.4861 - 81s/epoch - 49ms/step
Epoch 8/50
1664/1664 - 80s - loss: 2.7900 - accuracy50: 0.5461 - val_loss: 3.2483 - val_accuracy50: 0.4854 - 80s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 80s - loss: 2.7689 - accuracy50: 0.5512 - val_loss: 3.2573 - val_accuracy50: 0.4846 - 80s/epoch - 48ms/step
Epoch 10/50
1664/1664 - 78s - loss: 2.7505 - accuracy50: 0.5548 - val_loss: 3.2281 - val_accuracy50: 0.4817 - 78s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 78s - loss: 2.7368 - accuracy50: 0.5582 - val_loss: 3.1660 - val_accuracy50: 0.4947 - 78s/epoch - 47ms/step
Epoch 12/50
1664/1664 - 79s - loss: 2.7255 - accuracy50: 0.5601 - val_loss: 3.1871 - val_accuracy50: 0.4903 - 79s/epoch - 47ms/step
Epoch 13/50
1664/1664 - 79s - loss: 2.7146 - accuracy50: 0.5628 - val_loss: 3.1353 - val_accuracy50: 0.4952 - 79s/epoch - 47ms/step
Epoch 14/50
1664/1664 - 80s - loss: 2.7071 - accuracy50: 0.5638 - val_loss: 3.1444 - val_accuracy50: 0.4939 - 80s/epoch - 48ms/step
Epoch 15/50
1664/1664 - 80s - loss: 2.6990 - accuracy50: 0.5657 - val_loss: 3.1670 - val_accuracy50: 0.4911 - 80s/epoch - 48ms/step
Epoch 16/50
1664/1664 - 79s - loss: 2.6910 - accuracy50: 0.5672 - val_loss: 3.1278 - val_accuracy50: 0.4977 - 79s/epoch - 47ms/step
Epoch 17/50
1664/1664 - 79s - loss: 2.6845 - accuracy50: 0.5683 - val_loss: 3.0883 - val_accuracy50: 0.5018 - 79s/epoch - 47ms/step
Epoch 18/50
1664/1664 - 79s - loss: 2.6784 - accuracy50: 0.5686 - val_loss: 3.1195 - val_accuracy50: 0.4999 - 79s/epoch - 48ms/step
Epoch 19/50
1664/1664 - 79s - loss: 2.6713 - accuracy50: 0.5700 - val_loss: 3.1091 - val_accuracy50: 0.5017 - 79s/epoch - 47ms/step
Epoch 20/50
1664/1664 - 78s - loss: 2.6658 - accuracy50: 0.5716 - val_loss: 3.1100 - val_accuracy50: 0.5006 - 78s/epoch - 47ms/step
Epoch 21/50
1664/1664 - 79s - loss: 2.6598 - accuracy50: 0.5729 - val_loss: 3.1296 - val_accuracy50: 0.4973 - 79s/epoch - 48ms/step
Epoch 22/50
1664/1664 - 80s - loss: 2.6534 - accuracy50: 0.5738 - val_loss: 3.0945 - val_accuracy50: 0.4992 - 80s/epoch - 48ms/step
Epoch 23/50
1664/1664 - 79s - loss: 2.6479 - accuracy50: 0.5751 - val_loss: 3.1669 - val_accuracy50: 0.4900 - 79s/epoch - 48ms/step
Epoch 24/50
1664/1664 - 79s - loss: 2.6421 - accuracy50: 0.5764 - val_loss: 3.1533 - val_accuracy50: 0.4900 - 79s/epoch - 47ms/step
Epoch 25/50
1664/1664 - 79s - loss: 2.6373 - accuracy50: 0.5771 - val_loss: 3.1694 - val_accuracy50: 0.4877 - 79s/epoch - 47ms/step
Epoch 26/50
1664/1664 - 79s - loss: 2.6316 - accuracy50: 0.5784 - val_loss: 3.2042 - val_accuracy50: 0.4846 - 79s/epoch - 47ms/step
Epoch 27/50
1664/1664 - 79s - loss: 2.6256 - accuracy50: 0.5796 - val_loss: 3.2294 - val_accuracy50: 0.4803 - 79s/epoch - 48ms/step
testing model: results/WBA/W5/deepLOB_L2/h50
Evaluating performance on  test set...
7459/7459 - 144s - 144s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1529808
{'0': {'precision': 0.5651414263702399, 'recall': 0.17604330050654393, 'f1-score': 0.26846036714874816, 'support': 700038}, '1': {'precision': 0.3339279810540378, 'recall': 0.5171924441862118, 'f1-score': 0.4058298299086281, 'support': 478466}, '2': {'precision': 0.46988734196932636, 'recall': 0.6109570070078973, 'f1-score': 0.5312161077626646, 'support': 730747}, 'accuracy': 0.4279955857035036, 'macro avg': {'precision': 0.4563189164645347, 'recall': 0.434730917233551, 'f1-score': 0.40183543494001367, 'support': 1909251}, 'weighted avg': {'precision': 0.4707408427170815, 'recall': 0.4279955857035036, 'f1-score': 0.40345287811522995, 'support': 1909251}}
[[123237 275927 300874]
 [ 28204 247459 202803]
 [ 66623 217669 446455]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.971266
{'0': {'precision': 0.5767948698784735, 'recall': 0.30898521015670666, 'f1-score': 0.40240481379900095, 'support': 124883}, '1': {'precision': 0.5855041953625455, 'recall': 0.5524511640049489, 'f1-score': 0.5684976507999545, 'support': 176202}, '2': {'precision': 0.4327132032218413, 'recall': 0.6681000656640882, 'f1-score': 0.5252402521979181, 'support': 124878}, 'accuracy': 0.5149766529017779, 'macro avg': {'precision': 0.5316707561542867, 'recall': 0.5098454799419145, 'f1-score': 0.4987142389322912, 'support': 425963}, 'weighted avg': {'precision': 0.5381576412933559, 'recall': 0.5149766529017779, 'f1-score': 0.5071212655603559, 'support': 425963}}
[[38587 42179 44117]
 [13598 97343 65261]
 [14714 26733 83431]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99343395
{'0': {'precision': 0.5553794829024187, 'recall': 0.3065979096643492, 'f1-score': 0.3950873653920318, 'support': 43438}, '1': {'precision': 0.5270652770159079, 'recall': 0.5366861790071049, 'f1-score': 0.5318322207831025, 'support': 44758}, '2': {'precision': 0.4617939668801201, 'recall': 0.6575261482492042, 'f1-score': 0.542546505192259, 'support': 43980}, 'accuracy': 0.5012785982326595, 'macro avg': {'precision': 0.514746242266149, 'recall': 0.5002700789735527, 'f1-score': 0.4898220304557978, 'support': 132176}, 'weighted avg': {'precision': 0.5146521328409163, 'recall': 0.5012785982326595, 'f1-score': 0.4904577745889174, 'support': 132176}}
[[13318 12536 17584]
 [ 4618 24021 16119]
 [ 6044  9018 28918]]
training model: results/WBA/W5/deepLOB_L2/h100
Epoch 1/50
1664/1664 - 81s - loss: 3.2472 - accuracy100: 0.4006 - val_loss: 3.3670 - val_accuracy100: 0.3428 - 81s/epoch - 49ms/step
Epoch 2/50
1664/1664 - 78s - loss: 3.1722 - accuracy100: 0.4317 - val_loss: 3.4259 - val_accuracy100: 0.3729 - 78s/epoch - 47ms/step
Epoch 3/50
1664/1664 - 79s - loss: 3.1208 - accuracy100: 0.4507 - val_loss: 3.4594 - val_accuracy100: 0.3547 - 79s/epoch - 47ms/step
Epoch 4/50
1664/1664 - 79s - loss: 3.0956 - accuracy100: 0.4589 - val_loss: 3.5034 - val_accuracy100: 0.3662 - 79s/epoch - 47ms/step
Epoch 5/50
1664/1664 - 79s - loss: 3.0799 - accuracy100: 0.4646 - val_loss: 3.5311 - val_accuracy100: 0.3787 - 79s/epoch - 48ms/step
Epoch 6/50
1664/1664 - 80s - loss: 3.0669 - accuracy100: 0.4689 - val_loss: 3.4646 - val_accuracy100: 0.3852 - 80s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 81s - loss: 3.0570 - accuracy100: 0.4713 - val_loss: 3.4634 - val_accuracy100: 0.3973 - 81s/epoch - 48ms/step
Epoch 8/50
1664/1664 - 78s - loss: 3.0463 - accuracy100: 0.4754 - val_loss: 3.4720 - val_accuracy100: 0.3972 - 78s/epoch - 47ms/step
Epoch 9/50
1664/1664 - 80s - loss: 3.0361 - accuracy100: 0.4780 - val_loss: 3.3693 - val_accuracy100: 0.4006 - 80s/epoch - 48ms/step
Epoch 10/50
1664/1664 - 80s - loss: 3.0278 - accuracy100: 0.4820 - val_loss: 3.3887 - val_accuracy100: 0.4012 - 80s/epoch - 48ms/step
Epoch 11/50
1664/1664 - 81s - loss: 3.0167 - accuracy100: 0.4847 - val_loss: 3.3567 - val_accuracy100: 0.3997 - 81s/epoch - 49ms/step
Epoch 12/50
1664/1664 - 81s - loss: 3.0084 - accuracy100: 0.4878 - val_loss: 3.3844 - val_accuracy100: 0.4002 - 81s/epoch - 49ms/step
Epoch 13/50
1664/1664 - 79s - loss: 3.0014 - accuracy100: 0.4898 - val_loss: 3.3592 - val_accuracy100: 0.4040 - 79s/epoch - 48ms/step
Epoch 14/50
1664/1664 - 79s - loss: 2.9927 - accuracy100: 0.4931 - val_loss: 3.3489 - val_accuracy100: 0.4036 - 79s/epoch - 47ms/step
Epoch 15/50
1664/1664 - 79s - loss: 2.9828 - accuracy100: 0.4956 - val_loss: 3.3846 - val_accuracy100: 0.4012 - 79s/epoch - 47ms/step
Epoch 16/50
1664/1664 - 79s - loss: 2.9784 - accuracy100: 0.4976 - val_loss: 3.4288 - val_accuracy100: 0.4001 - 79s/epoch - 47ms/step
Epoch 17/50
1664/1664 - 80s - loss: 2.9698 - accuracy100: 0.5003 - val_loss: 3.3826 - val_accuracy100: 0.4010 - 80s/epoch - 48ms/step
Epoch 18/50
1664/1664 - 81s - loss: 2.9618 - accuracy100: 0.5027 - val_loss: 3.5318 - val_accuracy100: 0.4000 - 81s/epoch - 49ms/step
Epoch 19/50
1664/1664 - 79s - loss: 2.9545 - accuracy100: 0.5053 - val_loss: 3.5437 - val_accuracy100: 0.4015 - 79s/epoch - 48ms/step
Epoch 20/50
1664/1664 - 79s - loss: 2.9475 - accuracy100: 0.5070 - val_loss: 3.5997 - val_accuracy100: 0.3988 - 79s/epoch - 47ms/step
Epoch 21/50
1664/1664 - 80s - loss: 2.9397 - accuracy100: 0.5092 - val_loss: 3.5659 - val_accuracy100: 0.4021 - 80s/epoch - 48ms/step
Epoch 22/50
1664/1664 - 80s - loss: 2.9335 - accuracy100: 0.5107 - val_loss: 3.5797 - val_accuracy100: 0.4012 - 80s/epoch - 48ms/step
Epoch 23/50
1664/1664 - 79s - loss: 2.9276 - accuracy100: 0.5134 - val_loss: 3.5684 - val_accuracy100: 0.3983 - 79s/epoch - 48ms/step
Epoch 24/50
1664/1664 - 79s - loss: 2.9205 - accuracy100: 0.5150 - val_loss: 3.5648 - val_accuracy100: 0.3998 - 79s/epoch - 48ms/step
testing model: results/WBA/W5/deepLOB_L2/h100
Evaluating performance on  test set...
7459/7459 - 144s - 144s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1540147
{'0': {'precision': 0.4503965156156625, 'recall': 0.11294939163025809, 'f1-score': 0.18060666378097845, 'support': 740668}, '1': {'precision': 0.25275900812898006, 'recall': 0.35543014546973023, 'f1-score': 0.29542838933081106, 'support': 409501}, '2': {'precision': 0.4286112609319602, 'recall': 0.6480235336893775, 'f1-score': 0.515959887746106, 'support': 759082}, 'accuracy': 0.3776926134908401, 'macro avg': {'precision': 0.3772555948922009, 'recall': 0.3721343569297886, 'f1-score': 0.3306649802859652, 'support': 1909251}, 'weighted avg': {'precision': 0.3993453171880498, 'recall': 0.3776926134908401, 'f1-score': 0.33856400275227083, 'support': 1909251}}
[[ 83658 229396 427614]
 [ 35802 145549 228150]
 [ 66283 200896 491903]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048262
{'0': {'precision': 0.45148217765438275, 'recall': 0.18229609101923158, 'f1-score': 0.25972312469309106, 'support': 143618}, '1': {'precision': 0.4105607646554635, 'recall': 0.45065322908277083, 'f1-score': 0.42967377602299633, 'support': 140303}, '2': {'precision': 0.4004907229985512, 'recall': 0.6032933920952958, 'f1-score': 0.48140512117569073, 'support': 142042}, 'accuracy': 0.41107326223169616, 'macro avg': {'precision': 0.4208445551027991, 'recall': 0.4120809040657661, 'f1-score': 0.3902673406305927, 'support': 425963}, 'weighted avg': {'precision': 0.42099989348836137, 'recall': 0.41107326223169616, 'f1-score': 0.38962346903736766, 'support': 425963}}
[[26181 52002 65435]
 [14233 63228 62842]
 [17575 38774 85693]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1192466
{'0': {'precision': 0.484707632239472, 'recall': 0.1095677390884065, 'f1-score': 0.17873303167420812, 'support': 47587}, '1': {'precision': 0.3539510107236735, 'recall': 0.42031988066627995, 'f1-score': 0.38429094582649326, 'support': 36201}, '2': {'precision': 0.4197500956266735, 'recall': 0.6803546333801769, 'f1-score': 0.5191849737418978, 'support': 48388}, 'accuracy': 0.403636061009563, 'macro avg': {'precision': 0.4194695795299397, 'recall': 0.4034140843782878, 'f1-score': 0.36073631708086634, 'support': 132176}, 'weighted avg': {'precision': 0.42511522713481215, 'recall': 0.403636061009563, 'f1-score': 0.35966747229125084, 'support': 132176}}
[[ 5214 15127 27246]
 [ 2722 15216 18263]
 [ 2821 12646 32921]]
training model: results/WBA/W5/deepLOB_L2/h200
Epoch 1/50
1664/1664 - 86s - loss: 3.2701 - accuracy200: 0.3847 - val_loss: 3.4953 - val_accuracy200: 0.3633 - 86s/epoch - 52ms/step
Epoch 2/50
1664/1664 - 80s - loss: 3.2213 - accuracy200: 0.4078 - val_loss: 3.4884 - val_accuracy200: 0.3644 - 80s/epoch - 48ms/step
Epoch 3/50
1664/1664 - 81s - loss: 3.2072 - accuracy200: 0.4136 - val_loss: 3.4382 - val_accuracy200: 0.3633 - 81s/epoch - 48ms/step
Epoch 4/50
1664/1664 - 81s - loss: 3.1971 - accuracy200: 0.4194 - val_loss: 3.4235 - val_accuracy200: 0.3642 - 81s/epoch - 49ms/step
Epoch 5/50
1664/1664 - 82s - loss: 3.1885 - accuracy200: 0.4225 - val_loss: 3.4306 - val_accuracy200: 0.3645 - 82s/epoch - 49ms/step
Epoch 6/50
1664/1664 - 81s - loss: 3.1805 - accuracy200: 0.4262 - val_loss: 3.4410 - val_accuracy200: 0.3645 - 81s/epoch - 49ms/step
Epoch 7/50
1664/1664 - 81s - loss: 3.1724 - accuracy200: 0.4308 - val_loss: 3.4159 - val_accuracy200: 0.3634 - 81s/epoch - 49ms/step
Epoch 8/50
1664/1664 - 80s - loss: 3.1650 - accuracy200: 0.4335 - val_loss: 3.4323 - val_accuracy200: 0.3642 - 80s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 79s - loss: 3.1561 - accuracy200: 0.4362 - val_loss: 3.4148 - val_accuracy200: 0.3649 - 79s/epoch - 47ms/step
Epoch 10/50
1664/1664 - 80s - loss: 3.1484 - accuracy200: 0.4389 - val_loss: 3.4580 - val_accuracy200: 0.3582 - 80s/epoch - 48ms/step
Epoch 11/50
1664/1664 - 79s - loss: 3.1405 - accuracy200: 0.4424 - val_loss: 3.4733 - val_accuracy200: 0.3642 - 79s/epoch - 47ms/step
Epoch 12/50
1664/1664 - 79s - loss: 3.1320 - accuracy200: 0.4457 - val_loss: 3.4152 - val_accuracy200: 0.3662 - 79s/epoch - 47ms/step
Epoch 13/50
1664/1664 - 79s - loss: 3.1244 - accuracy200: 0.4476 - val_loss: 3.4436 - val_accuracy200: 0.3671 - 79s/epoch - 48ms/step
Epoch 14/50
1664/1664 - 79s - loss: 3.1130 - accuracy200: 0.4525 - val_loss: 3.5046 - val_accuracy200: 0.3650 - 79s/epoch - 48ms/step
Epoch 15/50
1664/1664 - 79s - loss: 3.1073 - accuracy200: 0.4537 - val_loss: 3.5020 - val_accuracy200: 0.3670 - 79s/epoch - 48ms/step
Epoch 16/50
1664/1664 - 80s - loss: 3.0960 - accuracy200: 0.4578 - val_loss: 3.6050 - val_accuracy200: 0.3658 - 80s/epoch - 48ms/step
Epoch 17/50
1664/1664 - 81s - loss: 3.0877 - accuracy200: 0.4613 - val_loss: 3.6243 - val_accuracy200: 0.3691 - 81s/epoch - 49ms/step
Epoch 18/50
1664/1664 - 81s - loss: 3.0798 - accuracy200: 0.4623 - val_loss: 3.6322 - val_accuracy200: 0.3673 - 81s/epoch - 49ms/step
Epoch 19/50
1664/1664 - 84s - loss: 3.0673 - accuracy200: 0.4672 - val_loss: 3.6922 - val_accuracy200: 0.3654 - 84s/epoch - 50ms/step
testing model: results/WBA/W5/deepLOB_L2/h200
Evaluating performance on  test set...
7459/7459 - 147s - 147s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1995713
{'0': {'precision': 0.4581564389553583, 'recall': 0.018947908879778878, 'f1-score': 0.03639080841497529, 'support': 751798}, '1': {'precision': 0.21039124907500523, 'recall': 0.33468321062864875, 'f1-score': 0.2583662377682395, 'support': 397567}, '2': {'precision': 0.40605335214971544, 'recall': 0.6656656393195821, 'f1-score': 0.5044153671029598, 'support': 759886}, 'accuracy': 0.34208912290736, 'macro avg': {'precision': 0.358200346726693, 'recall': 0.33976558627600323, 'f1-score': 0.26639080442872487, 'support': 1909251}, 'weighted avg': {'precision': 0.38582667745959104, 'recall': 0.34208912290736, 'f1-score': 0.2688879579908388, 'support': 1909251}}
[[ 14245 256474 481079]
 [  5694 133059 258814]
 [ 11153 242903 505830]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1553365
{'0': {'precision': 0.4092155787164015, 'recall': 0.08485106987986067, 'f1-score': 0.14055747241488947, 'support': 140670}, '1': {'precision': 0.3758526466951215, 'recall': 0.25603244477052256, 'f1-score': 0.30458218845967355, 'support': 147204}, '2': {'precision': 0.3382751189637089, 'recall': 0.7263793640333408, 'f1-score': 0.4615883738909546, 'support': 138089}, 'accuracy': 0.35197892774724565, 'macro avg': {'precision': 0.3744477814584106, 'recall': 0.35575429289457466, 'f1-score': 0.30224267825517254, 'support': 425963}, 'weighted avg': {'precision': 0.3746885090130468, 'recall': 0.35197892774724565, 'f1-score': 0.301313055539679, 'support': 425963}}
[[ 11936  33801  94933]
 [  8234  37689 101281]
 [  8998  28786 100305]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1374923
{'0': {'precision': 0.3885571448409943, 'recall': 0.06229267315270388, 'f1-score': 0.1073717333742661, 'support': 44917}, '1': {'precision': 0.3689016337773082, 'recall': 0.23374294730802334, 'f1-score': 0.2861658690784563, 'support': 41828}, '2': {'precision': 0.36202169144528396, 'recall': 0.7846844665536749, 'f1-score': 0.49545874651675087, 'support': 45431}, 'accuracy': 0.3648468708388815, 'macro avg': {'precision': 0.3731601566878622, 'recall': 0.3602400290048007, 'f1-score': 0.29633211632315776, 'support': 132176}, 'weighted avg': {'precision': 0.3732163651231001, 'recall': 0.3648468708388815, 'f1-score': 0.2973440596839675, 'support': 132176}}
[[ 2798  8852 33267]
 [ 2495  9777 29556]
 [ 1908  7874 35649]]
training model: results/WBA/W5/deepLOB_L2/h300
Epoch 1/50
1664/1664 - 83s - loss: 3.2944 - accuracy300: 0.3690 - val_loss: 3.3741 - val_accuracy300: 0.3530 - 83s/epoch - 50ms/step
Epoch 2/50
1664/1664 - 81s - loss: 3.2622 - accuracy300: 0.3874 - val_loss: 3.3810 - val_accuracy300: 0.3447 - 81s/epoch - 48ms/step
Epoch 3/50
1664/1664 - 81s - loss: 3.2498 - accuracy300: 0.3950 - val_loss: 3.3724 - val_accuracy300: 0.3428 - 81s/epoch - 48ms/step
Epoch 4/50
1664/1664 - 81s - loss: 3.2371 - accuracy300: 0.4016 - val_loss: 3.3943 - val_accuracy300: 0.3535 - 81s/epoch - 49ms/step
Epoch 5/50
1664/1664 - 80s - loss: 3.2275 - accuracy300: 0.4076 - val_loss: 3.3565 - val_accuracy300: 0.3583 - 80s/epoch - 48ms/step
Epoch 6/50
1664/1664 - 79s - loss: 3.2188 - accuracy300: 0.4125 - val_loss: 3.3857 - val_accuracy300: 0.3441 - 79s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 80s - loss: 3.2124 - accuracy300: 0.4149 - val_loss: 3.3727 - val_accuracy300: 0.3495 - 80s/epoch - 48ms/step
Epoch 8/50
1664/1664 - 81s - loss: 3.2050 - accuracy300: 0.4188 - val_loss: 3.3782 - val_accuracy300: 0.3559 - 81s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 81s - loss: 3.1977 - accuracy300: 0.4230 - val_loss: 3.3724 - val_accuracy300: 0.3441 - 81s/epoch - 49ms/step
Epoch 10/50
1664/1664 - 81s - loss: 3.1908 - accuracy300: 0.4258 - val_loss: 3.4052 - val_accuracy300: 0.3367 - 81s/epoch - 49ms/step
Epoch 11/50
1664/1664 - 81s - loss: 3.1844 - accuracy300: 0.4283 - val_loss: 3.3654 - val_accuracy300: 0.3479 - 81s/epoch - 49ms/step
Epoch 12/50
1664/1664 - 81s - loss: 3.1759 - accuracy300: 0.4328 - val_loss: 3.3917 - val_accuracy300: 0.3470 - 81s/epoch - 49ms/step
Epoch 13/50
1664/1664 - 84s - loss: 3.1690 - accuracy300: 0.4350 - val_loss: 3.3945 - val_accuracy300: 0.3466 - 84s/epoch - 50ms/step
Epoch 14/50
1664/1664 - 80s - loss: 3.1614 - accuracy300: 0.4385 - val_loss: 3.4068 - val_accuracy300: 0.3464 - 80s/epoch - 48ms/step
Epoch 15/50
1664/1664 - 81s - loss: 3.1583 - accuracy300: 0.4394 - val_loss: 3.4067 - val_accuracy300: 0.3492 - 81s/epoch - 49ms/step
testing model: results/WBA/W5/deepLOB_L2/h300
Evaluating performance on  test set...
7459/7459 - 147s - 147s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1130956
{'0': {'precision': 0.41003149532270955, 'recall': 0.13001438377093286, 'f1-score': 0.19742764181638137, 'support': 670895}, '1': {'precision': 0.289003717357437, 'recall': 0.33495539624935194, 'f1-score': 0.31028749337572864, 'support': 559370}, '2': {'precision': 0.3545297654766073, 'recall': 0.547319090526167, 'f1-score': 0.4303180239428392, 'support': 678986}, 'accuracy': 0.33846361740808306, 'macro avg': {'precision': 0.3511883260522513, 'recall': 0.3374296235154839, 'f1-score': 0.3126777197116497, 'support': 1909251}, 'weighted avg': {'precision': 0.35483487334806085, 'recall': 0.33846361740808306, 'f1-score': 0.31331587451353177, 'support': 1909251}}
[[ 87226 230246 353423]
 [ 48840 187364 323166]
 [ 76664 230700 371622]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1271061
{'0': {'precision': 0.39125144612438667, 'recall': 0.13523948731030963, 'f1-score': 0.2010011630707116, 'support': 145039}, '1': {'precision': 0.329682530503672, 'recall': 0.20561462225363897, 'f1-score': 0.2532707249570197, 'support': 138638}, '2': {'precision': 0.3376992300355262, 'recall': 0.6867717133098127, 'f1-score': 0.4527649716205259, 'support': 142286}, 'accuracy': 0.34237480720156444, 'macro avg': {'precision': 0.3528777355545283, 'recall': 0.3425419409579204, 'f1-score': 0.3023456198827524, 'support': 425963}, 'weighted avg': {'precision': 0.35332439156273643, 'recall': 0.34237480720156444, 'f1-score': 0.30211091388031913, 'support': 425963}}
[[19615 29642 95782]
 [14268 28506 95864]
 [16251 28317 97718]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1207801
{'0': {'precision': 0.39772151898734176, 'recall': 0.20724682291895696, 'f1-score': 0.272498626810442, 'support': 45482}, '1': {'precision': 0.32453848833159177, 'recall': 0.18147733359302723, 'f1-score': 0.23278473501764466, 'support': 41074}, '2': {'precision': 0.35635262197689105, 'recall': 0.6679307321350285, 'f1-score': 0.4647519980477091, 'support': 45620}, 'accuracy': 0.35824204091514344, 'macro avg': {'precision': 0.35953754309860825, 'recall': 0.35221829621567097, 'f1-score': 0.3233451199585986, 'support': 132176}, 'weighted avg': {'precision': 0.36070141788902554, 'recall': 0.35824204091514344, 'f1-score': 0.32651289872324585, 'support': 132176}}
[[ 9426  7623 28433]
 [ 7016  7454 26604]
 [ 7258  7891 30471]]
training model: results/WBA/W5/deepLOB_L2/h500
Epoch 1/50
1664/1664 - 84s - loss: 3.2196 - accuracy500: 0.4166 - val_loss: 3.3896 - val_accuracy500: 0.3599 - 84s/epoch - 50ms/step
Epoch 2/50
1664/1664 - 82s - loss: 3.1949 - accuracy500: 0.4270 - val_loss: 3.4037 - val_accuracy500: 0.3627 - 82s/epoch - 49ms/step
Epoch 3/50
1664/1664 - 82s - loss: 3.1837 - accuracy500: 0.4360 - val_loss: 3.3808 - val_accuracy500: 0.3620 - 82s/epoch - 49ms/step
Epoch 4/50
1664/1664 - 81s - loss: 3.1701 - accuracy500: 0.4421 - val_loss: 3.4422 - val_accuracy500: 0.3599 - 81s/epoch - 48ms/step
Epoch 5/50
1664/1664 - 83s - loss: 3.1577 - accuracy500: 0.4481 - val_loss: 3.5034 - val_accuracy500: 0.3588 - 83s/epoch - 50ms/step
Epoch 6/50
1664/1664 - 80s - loss: 3.1742 - accuracy500: 0.4412 - val_loss: 3.4795 - val_accuracy500: 0.3362 - 80s/epoch - 48ms/step
Epoch 7/50
1664/1664 - 79s - loss: 3.1576 - accuracy500: 0.4472 - val_loss: 3.4829 - val_accuracy500: 0.3200 - 79s/epoch - 47ms/step
Epoch 8/50
1664/1664 - 80s - loss: 3.1494 - accuracy500: 0.4501 - val_loss: 3.4914 - val_accuracy500: 0.3086 - 80s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 79s - loss: 3.1491 - accuracy500: 0.4508 - val_loss: 3.4610 - val_accuracy500: 0.3506 - 79s/epoch - 47ms/step
Epoch 10/50
1664/1664 - 79s - loss: 3.1362 - accuracy500: 0.4560 - val_loss: 3.4496 - val_accuracy500: 0.3416 - 79s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 78s - loss: 3.1253 - accuracy500: 0.4604 - val_loss: 3.4521 - val_accuracy500: 0.3567 - 78s/epoch - 47ms/step
Epoch 12/50
1664/1664 - 78s - loss: 3.1095 - accuracy500: 0.4659 - val_loss: 3.3875 - val_accuracy500: 0.3529 - 78s/epoch - 47ms/step
Epoch 13/50
1664/1664 - 80s - loss: 3.0992 - accuracy500: 0.4694 - val_loss: 3.4285 - val_accuracy500: 0.3399 - 80s/epoch - 48ms/step
testing model: results/WBA/W5/deepLOB_L2/h500
Evaluating performance on  test set...
7459/7459 - 142s - 142s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1232986
{'0': {'precision': 0.39772372934206424, 'recall': 0.0035436560083791976, 'f1-score': 0.007024722838748052, 'support': 719878}, '1': {'precision': 0.2525573192239859, 'recall': 0.0031185755601240463, 'f1-score': 0.00616107422975816, 'support': 459184}, '2': {'precision': 0.3824723917293522, 'recall': 0.9937344988763184, 'f1-score': 0.5523530119252967, 'support': 730189}, 'accuracy': 0.3821378121577519, 'macro avg': {'precision': 0.34425114676513413, 'recall': 0.33346557681494055, 'f1-score': 0.18851293633126764, 'support': 1909251}, 'weighted avg': {'precision': 0.3569776714252433, 'recall': 0.3821378121577519, 'f1-score': 0.21537666004184364, 'support': 1909251}}
[[  2551   2023 715304]
 [  1503   1432 456249]
 [  2360   2215 725614]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1376823
{'0': {'precision': 0.3526395050673613, 'recall': 0.05995640289263347, 'f1-score': 0.10248766812165087, 'support': 144505}, '1': {'precision': 0.3422103861517976, 'recall': 0.0018462511045179272, 'f1-score': 0.003672687778666971, 'support': 139201}, '2': {'precision': 0.3367586604533213, 'recall': 0.9484243306129048, 'f1-score': 0.49703444464910673, 'support': 142257}, 'accuracy': 0.3376842589614591, 'macro avg': {'precision': 0.3438695172241601, 'recall': 0.3367423282033521, 'f1-score': 0.20106493351647484, 'support': 425963}, 'weighted avg': {'precision': 0.34392770358595354, 'recall': 0.3376842589614591, 'f1-score': 0.20196085407851236, 'support': 425963}}
[[  8664    226 135615]
 [  8836    257 130108]
 [  7069    268 134920]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1289312
{'0': {'precision': 0.28987388724035607, 'recall': 0.03268165185572399, 'f1-score': 0.05874062799481368, 'support': 47825}, '1': {'precision': 0.26666666666666666, 'recall': 0.0005429029018160102, 'f1-score': 0.0010835997182640732, 'support': 36839}, '2': {'precision': 0.36517532298416056, 'recall': 0.973880282875905, 'f1-score': 0.5311759202392364, 'support': 47512}, 'accuracy': 0.36204757293305895, 'macro avg': {'precision': 0.30723862563039445, 'recall': 0.33570161254448166, 'f1-score': 0.19700004931743806, 'support': 132176}, 'weighted avg': {'precision': 0.3104736255918381, 'recall': 0.36204757293305895, 'f1-score': 0.21249258251331327, 'support': 132176}}
[[ 1563    20 46242]
 [ 2623    20 34196]
 [ 1206    35 46271]]
training model: results/WBA/W5/deepLOB_L2/h1000
Epoch 1/50
1664/1664 - 83s - loss: 3.2162 - accuracy1000: 0.4191 - val_loss: 3.4442 - val_accuracy1000: 0.3473 - 83s/epoch - 50ms/step
Epoch 2/50
1664/1664 - 80s - loss: 3.1798 - accuracy1000: 0.4331 - val_loss: 3.5454 - val_accuracy1000: 0.3159 - 80s/epoch - 48ms/step
Epoch 3/50
1664/1664 - 80s - loss: 3.1512 - accuracy1000: 0.4439 - val_loss: 3.5388 - val_accuracy1000: 0.2900 - 80s/epoch - 48ms/step
Epoch 4/50
1664/1664 - 80s - loss: 3.1321 - accuracy1000: 0.4507 - val_loss: 3.4868 - val_accuracy1000: 0.2982 - 80s/epoch - 48ms/step
Epoch 5/50
1664/1664 - 79s - loss: 3.1185 - accuracy1000: 0.4561 - val_loss: 3.5770 - val_accuracy1000: 0.2840 - 79s/epoch - 48ms/step
Epoch 6/50
1664/1664 - 79s - loss: 3.1041 - accuracy1000: 0.4615 - val_loss: 3.6574 - val_accuracy1000: 0.2811 - 79s/epoch - 47ms/step
Epoch 7/50
1664/1664 - 80s - loss: 3.0904 - accuracy1000: 0.4674 - val_loss: 3.6805 - val_accuracy1000: 0.2861 - 80s/epoch - 48ms/step
Epoch 8/50
1664/1664 - 80s - loss: 3.0798 - accuracy1000: 0.4695 - val_loss: 3.6962 - val_accuracy1000: 0.2782 - 80s/epoch - 48ms/step
Epoch 9/50
1664/1664 - 79s - loss: 3.0649 - accuracy1000: 0.4765 - val_loss: 3.7336 - val_accuracy1000: 0.2873 - 79s/epoch - 48ms/step
Epoch 10/50
1664/1664 - 79s - loss: 3.0550 - accuracy1000: 0.4804 - val_loss: 3.7239 - val_accuracy1000: 0.2804 - 79s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 79s - loss: 3.0446 - accuracy1000: 0.4830 - val_loss: 3.6640 - val_accuracy1000: 0.2804 - 79s/epoch - 47ms/step
testing model: results/WBA/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
7459/7459 - 142s - 142s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1469387
{'0': {'precision': 0.4400423117607462, 'recall': 0.011714080191275365, 'f1-score': 0.02282066626770397, 'support': 781282}, '1': {'precision': 0.15541628387167195, 'recall': 0.051470521784447984, 'f1-score': 0.07733076258107148, 'support': 331957}, '2': {'precision': 0.4169622314333973, 'recall': 0.9316115837449687, 'f1-score': 0.5760854028388893, 'support': 796012}, 'accuracy': 0.4021535146505095, 'macro avg': {'precision': 0.3374736090219385, 'recall': 0.331598728573564, 'f1-score': 0.2254122772292216, 'support': 1909251}, 'weighted avg': {'precision': 0.3809324182781674, 'recall': 0.4021535146505095, 'f1-score': 0.26296739266952274, 'support': 1909251}}
[[  9152  46825 725305]
 [  3234  17086 311637]
 [  8412  46026 741574]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1621759
{'0': {'precision': 0.3940193491644679, 'recall': 0.009436479294510833, 'f1-score': 0.01843153657850888, 'support': 142426}, '1': {'precision': 0.26974157489900946, 'recall': 0.068726075585289, 'f1-score': 0.10954240287648531, 'support': 141853}, '2': {'precision': 0.33043658290416916, 'recall': 0.901188560458485, 'f1-score': 0.4835654258522158, 'support': 141684}, 'accuracy': 0.32579590246101187, 'macro avg': {'precision': 0.3313991689892155, 'recall': 0.3264503717794283, 'f1-score': 0.20384645510240332, 'support': 425963}, 'weighted avg': {'precision': 0.33148378676185963, 'recall': 0.32579590246101187, 'f1-score': 0.20348605935354508, 'support': 425963}}
[[  1344  13713 127369]
 [   747   9749 131357]
 [  1320  12680 127684]]
Evaluating performance on  val set...
517/517 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1484911
{'0': {'precision': 0.3987915407854985, 'recall': 0.005772889287354311, 'f1-score': 0.01138102731015455, 'support': 45731}, '1': {'precision': 0.3293418647166362, 'recall': 0.08904651277742079, 'f1-score': 0.14018909770047858, 'support': 40462}, '2': {'precision': 0.3506560286628958, 'recall': 0.91947023900137, 'f1-score': 0.5076940626932522, 'support': 45983}, 'accuracy': 0.3491329742161966, 'macro avg': {'precision': 0.3595964780550102, 'recall': 0.33809654702204833, 'f1-score': 0.21975472923462847, 'support': 132176}, 'weighted avg': {'precision': 0.3607854878936577, 'recall': 0.3491329742161966, 'f1-score': 0.22347546540900967, 'support': 132176}}
[[  264  3901 41566]
 [  131  3603 36728]
 [  267  3436 42280]]
training model: results/WBA/W5/deepOF_L2/h10
Epoch 1/50
1664/1664 - 53s - loss: 2.8421 - accuracy10: 0.4860 - val_loss: 3.2958 - val_accuracy10: 0.6259 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 50s - loss: 2.5436 - accuracy10: 0.5785 - val_loss: 3.0501 - val_accuracy10: 0.6212 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 50s - loss: 2.4623 - accuracy10: 0.5951 - val_loss: 2.9978 - val_accuracy10: 0.6027 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 51s - loss: 2.4282 - accuracy10: 0.5991 - val_loss: 2.9729 - val_accuracy10: 0.5995 - 51s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 51s - loss: 2.4070 - accuracy10: 0.6034 - val_loss: 2.9731 - val_accuracy10: 0.5933 - 51s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 52s - loss: 2.3900 - accuracy10: 0.6051 - val_loss: 2.9526 - val_accuracy10: 0.5960 - 52s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 52s - loss: 2.3758 - accuracy10: 0.6075 - val_loss: 2.9388 - val_accuracy10: 0.5904 - 52s/epoch - 32ms/step
Epoch 8/50
1664/1664 - 51s - loss: 2.3641 - accuracy10: 0.6092 - val_loss: 2.9436 - val_accuracy10: 0.5822 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 2.3554 - accuracy10: 0.6102 - val_loss: 2.9473 - val_accuracy10: 0.5975 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 2.3474 - accuracy10: 0.6119 - val_loss: 2.9456 - val_accuracy10: 0.5896 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 50s - loss: 2.3377 - accuracy10: 0.6121 - val_loss: 2.9190 - val_accuracy10: 0.5841 - 50s/epoch - 30ms/step
Epoch 12/50
1664/1664 - 49s - loss: 2.3295 - accuracy10: 0.6127 - val_loss: 2.9381 - val_accuracy10: 0.5857 - 49s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 50s - loss: 2.3221 - accuracy10: 0.6147 - val_loss: 2.9298 - val_accuracy10: 0.5950 - 50s/epoch - 30ms/step
Epoch 14/50
1664/1664 - 50s - loss: 2.3163 - accuracy10: 0.6149 - val_loss: 2.9641 - val_accuracy10: 0.5946 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 50s - loss: 2.3086 - accuracy10: 0.6156 - val_loss: 2.9271 - val_accuracy10: 0.5875 - 50s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 49s - loss: 2.3011 - accuracy10: 0.6163 - val_loss: 2.9590 - val_accuracy10: 0.5876 - 49s/epoch - 30ms/step
Epoch 17/50
1664/1664 - 49s - loss: 2.2959 - accuracy10: 0.6163 - val_loss: 2.9342 - val_accuracy10: 0.5888 - 49s/epoch - 30ms/step
Epoch 18/50
1664/1664 - 50s - loss: 2.2890 - accuracy10: 0.6179 - val_loss: 2.9262 - val_accuracy10: 0.5886 - 50s/epoch - 30ms/step
Epoch 19/50
1664/1664 - 50s - loss: 2.2832 - accuracy10: 0.6182 - val_loss: 2.9528 - val_accuracy10: 0.5858 - 50s/epoch - 30ms/step
Epoch 20/50
1664/1664 - 50s - loss: 2.2759 - accuracy10: 0.6189 - val_loss: 2.9394 - val_accuracy10: 0.5813 - 50s/epoch - 30ms/step
Epoch 21/50
1664/1664 - 50s - loss: 2.2725 - accuracy10: 0.6190 - val_loss: 2.9393 - val_accuracy10: 0.5895 - 50s/epoch - 30ms/step
testing model: results/WBA/W5/deepOF_L2/h10
Evaluating performance on  test set...
7458/7458 - 112s - 112s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0463185
{'0': {'precision': 0.4241586357694043, 'recall': 0.5287119289340102, 'f1-score': 0.4706992508714156, 'support': 416064}, '1': {'precision': 0.768719834021289, 'recall': 0.434154793265917, 'f1-score': 0.5549097022215866, 'support': 1059090}, '2': {'precision': 0.3681037256695795, 'recall': 0.6720073164214038, 'f1-score': 0.4756576689247306, 'support': 434092}, 'accuracy': 0.5088396152198302, 'macro avg': {'precision': 0.5203273984867577, 'recall': 0.544958012873777, 'f1-score': 0.5004222073392444, 'support': 1909246}, 'weighted avg': {'precision': 0.6025475554903493, 'recall': 0.5088396152198303, 'f1-score': 0.518539527362791, 'support': 1909246}}
[[219978  65661 130425]
 [228944 459809 370337]
 [ 69700  72679 291713]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8248725
{'0': {'precision': 0.41909543273502753, 'recall': 0.5644362668102739, 'f1-score': 0.4810270204804916, 'support': 66849}, '1': {'precision': 0.867374399138843, 'recall': 0.6409364103583881, 'f1-score': 0.7371581908984978, 'support': 291667}, '2': {'precision': 0.3682737427847681, 'recall': 0.657454221958633, 'f1-score': 0.472100079850945, 'support': 67445}, 'accuracy': 0.631546080509718, 'macro avg': {'precision': 0.5515811915528795, 'recall': 0.6209422997090984, 'f1-score': 0.5634284304099781, 'support': 425961}, 'weighted avg': {'precision': 0.7179972392746083, 'recall': 0.631546080509718, 'f1-score': 0.6549934929311357, 'support': 425961}}
[[ 37732  13911  15206]
 [ 43870 186940  60857]
 [  8430  14673  44342]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91034836
{'0': {'precision': 0.42799514610868783, 'recall': 0.5201482721511419, 'f1-score': 0.4695933789132781, 'support': 25089}, '1': {'precision': 0.8348120579260226, 'recall': 0.5794603065772075, 'f1-score': 0.6840838627149144, 'support': 81676}, '2': {'precision': 0.3759418550376742, 'recall': 0.6656434474616293, 'f1-score': 0.4805045382878085, 'support': 25410}, 'accuracy': 0.5847701910346133, 'macro avg': {'precision': 0.5462496863574615, 'recall': 0.5884173420633262, 'f1-score': 0.5447272599720003, 'support': 132175}, 'weighted avg': {'precision': 0.6693759213194175, 'recall': 0.5847701910346133, 'f1-score': 0.6042328895218596, 'support': 132175}}
[[13050  4588  7451]
 [13722 47328 20626]
 [ 3719  4777 16914]]
training model: results/WBA/W5/deepOF_L2/h20
Epoch 1/50
1664/1664 - 53s - loss: 2.8990 - accuracy20: 0.4916 - val_loss: 3.3408 - val_accuracy20: 0.5742 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 50s - loss: 2.6334 - accuracy20: 0.5713 - val_loss: 3.1382 - val_accuracy20: 0.5866 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 51s - loss: 2.5559 - accuracy20: 0.5904 - val_loss: 3.0408 - val_accuracy20: 0.5824 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 51s - loss: 2.5223 - accuracy20: 0.5961 - val_loss: 3.0218 - val_accuracy20: 0.5838 - 51s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 51s - loss: 2.5021 - accuracy20: 0.6001 - val_loss: 3.0000 - val_accuracy20: 0.5774 - 51s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 51s - loss: 2.4869 - accuracy20: 0.6024 - val_loss: 2.9841 - val_accuracy20: 0.5826 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 51s - loss: 2.4756 - accuracy20: 0.6046 - val_loss: 2.9919 - val_accuracy20: 0.5817 - 51s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 50s - loss: 2.4656 - accuracy20: 0.6061 - val_loss: 2.9730 - val_accuracy20: 0.5842 - 50s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 50s - loss: 2.4575 - accuracy20: 0.6071 - val_loss: 2.9852 - val_accuracy20: 0.5829 - 50s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 50s - loss: 2.4492 - accuracy20: 0.6091 - val_loss: 2.9769 - val_accuracy20: 0.5785 - 50s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 50s - loss: 2.4416 - accuracy20: 0.6092 - val_loss: 2.9752 - val_accuracy20: 0.5765 - 50s/epoch - 30ms/step
Epoch 12/50
1664/1664 - 50s - loss: 2.4357 - accuracy20: 0.6100 - val_loss: 2.9784 - val_accuracy20: 0.5796 - 50s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 50s - loss: 2.4284 - accuracy20: 0.6114 - val_loss: 3.0091 - val_accuracy20: 0.5800 - 50s/epoch - 30ms/step
Epoch 14/50
1664/1664 - 50s - loss: 2.4230 - accuracy20: 0.6126 - val_loss: 2.9935 - val_accuracy20: 0.5741 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 50s - loss: 2.4162 - accuracy20: 0.6133 - val_loss: 2.9983 - val_accuracy20: 0.5791 - 50s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 51s - loss: 2.4105 - accuracy20: 0.6133 - val_loss: 2.9911 - val_accuracy20: 0.5788 - 51s/epoch - 31ms/step
Epoch 17/50
1664/1664 - 51s - loss: 2.4048 - accuracy20: 0.6143 - val_loss: 2.9830 - val_accuracy20: 0.5794 - 51s/epoch - 31ms/step
Epoch 18/50
1664/1664 - 51s - loss: 2.3995 - accuracy20: 0.6150 - val_loss: 2.9873 - val_accuracy20: 0.5783 - 51s/epoch - 30ms/step
testing model: results/WBA/W5/deepOF_L2/h20
Evaluating performance on  test set...
7458/7458 - 113s - 113s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0215529
{'0': {'precision': 0.46599320968038666, 'recall': 0.5247593002757311, 'f1-score': 0.4936334113470025, 'support': 530952}, '1': {'precision': 0.6275296821141325, 'recall': 0.4986736367188974, 'f1-score': 0.5557300418066042, 'support': 821419}, '2': {'precision': 0.45850200277564357, 'recall': 0.5422455667789001, 'f1-score': 0.4968699119099667, 'support': 556875}, 'accuracy': 0.5186366764680926, 'macro avg': {'precision': 0.5173416315233875, 'recall': 0.5218928345911763, 'f1-score': 0.5154111216878577, 'support': 1909246}, 'weighted avg': {'precision': 0.5333064117533391, 'recall': 0.5186366764680926, 'f1-score': 0.5212933767713095, 'support': 1909246}}
[[278622 119290 133040]
 [188216 409620 223583]
 [131072 123840 301963]]
Evaluating performance on  train set...
1664/1664 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8347338
{'0': {'precision': 0.48138071756504, 'recall': 0.5441030163252385, 'f1-score': 0.5108237054805789, 'support': 88452}, '1': {'precision': 0.7755184252689402, 'recall': 0.6817740968340396, 'f1-score': 0.725631080852449, 'support': 248487}, '2': {'precision': 0.45633939033236, 'recall': 0.5512345262968704, 'f1-score': 0.4993182604448605, 'support': 89022}, 'accuracy': 0.6259047189766199, 'macro avg': {'precision': 0.5710795110554467, 'recall': 0.5923705464853829, 'f1-score': 0.5785910155926294, 'support': 425961}, 'weighted avg': {'precision': 0.6477343685831177, 'recall': 0.6259047189766199, 'f1-score': 0.6337283905481323, 'support': 425961}}
[[ 48127  24693  15632]
 [ 36245 169412  42830]
 [ 15605  24345  49072]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90597695
{'0': {'precision': 0.4785506159305311, 'recall': 0.5124814631735047, 'f1-score': 0.4949351792454238, 'support': 32368}, '1': {'precision': 0.7237522243877638, 'recall': 0.6370267609415555, 'f1-score': 0.6776258895773665, 'support': 67038}, '2': {'precision': 0.4637338665697146, 'recall': 0.544935762458421, 'f1-score': 0.5010662775688871, 'support': 32769}, 'accuracy': 0.5836958577643276, 'macro avg': {'precision': 0.5553455689626698, 'recall': 0.5648146621911604, 'f1-score': 0.5578757821305591, 'support': 132175}, 'weighted avg': {'precision': 0.5992413317841445, 'recall': 0.5836958577643276, 'f1-score': 0.5891143341551597, 'support': 132175}}
[[16588  8232  7548]
 [11231 42705 13102]
 [ 6844  8068 17857]]
training model: results/WBA/W5/deepOF_L2/h30
Epoch 1/50
1664/1664 - 52s - loss: 2.9567 - accuracy30: 0.4864 - val_loss: 3.2939 - val_accuracy30: 0.5276 - 52s/epoch - 31ms/step
Epoch 2/50
1664/1664 - 50s - loss: 2.7178 - accuracy30: 0.5577 - val_loss: 3.1114 - val_accuracy30: 0.5545 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 50s - loss: 2.6454 - accuracy30: 0.5752 - val_loss: 3.0558 - val_accuracy30: 0.5565 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 49s - loss: 2.6136 - accuracy30: 0.5812 - val_loss: 3.0273 - val_accuracy30: 0.5617 - 49s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 49s - loss: 2.5941 - accuracy30: 0.5848 - val_loss: 3.0192 - val_accuracy30: 0.5599 - 49s/epoch - 29ms/step
Epoch 6/50
1664/1664 - 49s - loss: 2.5804 - accuracy30: 0.5876 - val_loss: 3.0172 - val_accuracy30: 0.5591 - 49s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 49s - loss: 2.5687 - accuracy30: 0.5905 - val_loss: 3.0124 - val_accuracy30: 0.5594 - 49s/epoch - 29ms/step
Epoch 8/50
1664/1664 - 49s - loss: 2.5593 - accuracy30: 0.5924 - val_loss: 2.9965 - val_accuracy30: 0.5608 - 49s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 49s - loss: 2.5504 - accuracy30: 0.5936 - val_loss: 3.0578 - val_accuracy30: 0.5558 - 49s/epoch - 29ms/step
Epoch 10/50
1664/1664 - 50s - loss: 2.5441 - accuracy30: 0.5945 - val_loss: 3.0135 - val_accuracy30: 0.5574 - 50s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 50s - loss: 2.5367 - accuracy30: 0.5959 - val_loss: 3.0253 - val_accuracy30: 0.5600 - 50s/epoch - 30ms/step
Epoch 12/50
1664/1664 - 50s - loss: 2.5306 - accuracy30: 0.5966 - val_loss: 3.0119 - val_accuracy30: 0.5603 - 50s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 50s - loss: 2.5256 - accuracy30: 0.5976 - val_loss: 3.0111 - val_accuracy30: 0.5604 - 50s/epoch - 30ms/step
Epoch 14/50
1664/1664 - 50s - loss: 2.5189 - accuracy30: 0.5991 - val_loss: 3.0330 - val_accuracy30: 0.5591 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 50s - loss: 2.5125 - accuracy30: 0.5997 - val_loss: 3.0101 - val_accuracy30: 0.5594 - 50s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 50s - loss: 2.5074 - accuracy30: 0.6008 - val_loss: 3.0222 - val_accuracy30: 0.5580 - 50s/epoch - 30ms/step
Epoch 17/50
1664/1664 - 49s - loss: 2.5021 - accuracy30: 0.6016 - val_loss: 3.0224 - val_accuracy30: 0.5585 - 49s/epoch - 30ms/step
Epoch 18/50
1664/1664 - 49s - loss: 2.4974 - accuracy30: 0.6020 - val_loss: 3.0268 - val_accuracy30: 0.5588 - 49s/epoch - 29ms/step
testing model: results/WBA/W5/deepOF_L2/h30
Evaluating performance on  test set...
7458/7458 - 112s - 112s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0252855
{'0': {'precision': 0.5113518407230213, 'recall': 0.43160970082640815, 'f1-score': 0.46810904849596596, 'support': 607206}, '1': {'precision': 0.5236266880648913, 'recall': 0.506267544538884, 'f1-score': 0.5148008197918107, 'support': 665093}, '2': {'precision': 0.47311479847045057, 'recall': 0.5598267987760364, 'f1-score': 0.5128312070833929, 'support': 636947}, 'accuracy': 0.5003917776965358, 'macro avg': {'precision': 0.5026977757527877, 'recall': 0.49923468138044286, 'f1-score': 0.4985803584570565, 'support': 1909246}, 'weighted avg': {'precision': 0.5028715012023405, 'recall': 0.5003917776965358, 'f1-score': 0.4992941419790756, 'support': 1909246}}
[[262076 155270 189860]
 [121132 336715 207246]
 [129308 151059 356580]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86599874
{'0': {'precision': 0.5374552448929933, 'recall': 0.44733339762754365, 'f1-score': 0.4882706204965446, 'support': 103690}, '1': {'precision': 0.6968233394729063, 'recall': 0.7020660456463667, 'f1-score': 0.6994348683489756, 'support': 218243}, '2': {'precision': 0.47660157130572, 'recall': 0.5487368785327027, 'f1-score': 0.5101317688482179, 'support': 104028}, 'accuracy': 0.602611506687232, 'macro avg': {'precision': 0.5702933852238732, 'recall': 0.5660454406022043, 'f1-score': 0.5659457525645794, 'support': 425961}, 'weighted avg': {'precision': 0.6042465359019521, 'recall': 0.602611506687232, 'f1-score': 0.6018004753066938, 'support': 425961}}
[[ 46384  35119  22187]
 [ 24520 153221  40502]
 [ 15399  31545  57084]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9263729
{'0': {'precision': 0.525736418305983, 'recall': 0.4160012904266473, 'f1-score': 0.46447546150382707, 'support': 37197}, '1': {'precision': 0.6375985977212971, 'recall': 0.6590018291089627, 'f1-score': 0.6481235597968082, 'support': 57405}, '2': {'precision': 0.47664132688320665, 'recall': 0.5506879940382722, 'f1-score': 0.5109961349912945, 'support': 37573}, 'accuracy': 0.5598259882731228, 'macro avg': {'precision': 0.5466587809701623, 'recall': 0.5418970378579607, 'f1-score': 0.5411983854306434, 'support': 132175}, 'weighted avg': {'precision': 0.5603632277579076, 'recall': 0.5598259882731228, 'f1-score': 0.5574600678775982, 'support': 132175}}
[[15474 11376 10347]
 [ 7203 37830 12372]
 [ 6756 10126 20691]]
training model: results/WBA/W5/deepOF_L2/h50
Epoch 1/50
1664/1664 - 52s - loss: 3.0417 - accuracy50: 0.4730 - val_loss: 3.2635 - val_accuracy50: 0.4565 - 52s/epoch - 31ms/step
Epoch 2/50
1664/1664 - 50s - loss: 2.8572 - accuracy50: 0.5294 - val_loss: 3.2084 - val_accuracy50: 0.4867 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 50s - loss: 2.7957 - accuracy50: 0.5420 - val_loss: 3.0940 - val_accuracy50: 0.5047 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 50s - loss: 2.7677 - accuracy50: 0.5489 - val_loss: 3.0896 - val_accuracy50: 0.5069 - 50s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 50s - loss: 2.7507 - accuracy50: 0.5525 - val_loss: 3.0553 - val_accuracy50: 0.5094 - 50s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 50s - loss: 2.7386 - accuracy50: 0.5548 - val_loss: 3.0650 - val_accuracy50: 0.5089 - 50s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 51s - loss: 2.7284 - accuracy50: 0.5569 - val_loss: 3.0486 - val_accuracy50: 0.5101 - 51s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 51s - loss: 2.7214 - accuracy50: 0.5592 - val_loss: 3.0500 - val_accuracy50: 0.5095 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 2.7128 - accuracy50: 0.5607 - val_loss: 3.0249 - val_accuracy50: 0.5143 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 52s - loss: 2.7065 - accuracy50: 0.5620 - val_loss: 3.0113 - val_accuracy50: 0.5141 - 52s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 51s - loss: 2.6997 - accuracy50: 0.5636 - val_loss: 3.0249 - val_accuracy50: 0.5143 - 51s/epoch - 30ms/step
Epoch 12/50
1664/1664 - 49s - loss: 2.6934 - accuracy50: 0.5656 - val_loss: 3.0203 - val_accuracy50: 0.5131 - 49s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 49s - loss: 2.6882 - accuracy50: 0.5668 - val_loss: 3.0191 - val_accuracy50: 0.5130 - 49s/epoch - 29ms/step
Epoch 14/50
1664/1664 - 50s - loss: 2.6831 - accuracy50: 0.5675 - val_loss: 3.0323 - val_accuracy50: 0.5125 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 50s - loss: 2.6790 - accuracy50: 0.5686 - val_loss: 3.0286 - val_accuracy50: 0.5134 - 50s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 49s - loss: 2.6749 - accuracy50: 0.5686 - val_loss: 3.0319 - val_accuracy50: 0.5116 - 49s/epoch - 30ms/step
Epoch 17/50
1664/1664 - 50s - loss: 2.6692 - accuracy50: 0.5698 - val_loss: 3.0176 - val_accuracy50: 0.5116 - 50s/epoch - 30ms/step
Epoch 18/50
1664/1664 - 51s - loss: 2.6640 - accuracy50: 0.5714 - val_loss: 3.0290 - val_accuracy50: 0.5111 - 51s/epoch - 30ms/step
Epoch 19/50
1664/1664 - 50s - loss: 2.6576 - accuracy50: 0.5725 - val_loss: 3.0298 - val_accuracy50: 0.5121 - 50s/epoch - 30ms/step
Epoch 20/50
1664/1664 - 50s - loss: 2.6525 - accuracy50: 0.5739 - val_loss: 3.0462 - val_accuracy50: 0.5097 - 50s/epoch - 30ms/step
testing model: results/WBA/W5/deepOF_L2/h50
Evaluating performance on  test set...
7458/7458 - 111s - 111s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0412785
{'0': {'precision': 0.5128042522447408, 'recall': 0.41469093776471816, 'f1-score': 0.45855822982960787, 'support': 700037}, '1': {'precision': 0.3882837438495489, 'recall': 0.4451485479606659, 'f1-score': 0.4147762127045516, 'support': 478465}, '2': {'precision': 0.49031597970319957, 'recall': 0.5331675662064964, 'f1-score': 0.5108447099423608, 'support': 730744}, 'accuracy': 0.4676694359972471, 'macro avg': {'precision': 0.46380132526582973, 'recall': 0.46433568397729347, 'f1-score': 0.4613930508255068, 'support': 1909246}, 'weighted avg': {'precision': 0.47299174234323965, 'recall': 0.4676694359972471, 'f1-score': 0.4675983790821261, 'support': 1909246}}
[[290299 172148 237590]
 [ 98068 212988 167409]
 [177734 163401 389609]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93133837
{'0': {'precision': 0.5533440461018452, 'recall': 0.3997582123728013, 'f1-score': 0.46417648207197243, 'support': 124903}, '1': {'precision': 0.5834989324404952, 'recall': 0.6716406050458325, 'f1-score': 0.6244749118696303, 'support': 176185}, '2': {'precision': 0.49230780804501717, 'recall': 0.5240604454125392, 'f1-score': 0.507688130333592, 'support': 124873}, 'accuracy': 0.5486535152279199, 'macro avg': {'precision': 0.5430502621957859, 'recall': 0.5318197542770576, 'f1-score': 0.5321131747583983, 'support': 425961}, 'weighted avg': {'precision': 0.5479235040679613, 'recall': 0.5486535152279199, 'f1-score': 0.5432344449072404, 'support': 425961}}
[[ 49931  46124  28848]
 [ 19214 118333  38638]
 [ 21090  38342  65441]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9724486
{'0': {'precision': 0.5277993597911552, 'recall': 0.3914576802507837, 'f1-score': 0.44951760828999093, 'support': 43384}, '1': {'precision': 0.5225374093454512, 'recall': 0.6353671332574287, 'f1-score': 0.5734550363698645, 'support': 44793}, '2': {'precision': 0.49559660026793756, 'recall': 0.5128869494067912, 'f1-score': 0.5040935541879349, 'support': 43998}, 'accuracy': 0.5145375449215056, 'macro avg': {'precision': 0.5153111231348481, 'recall': 0.5132372543050012, 'f1-score': 0.5090220662825967, 'support': 132175}, 'weighted avg': {'precision': 0.5152965751509664, 'recall': 0.5145375449215056, 'f1-score': 0.5096860341163538, 'support': 132175}}
[[16983 13972 12429]
 [ 5795 28460 10538]
 [ 9399 12033 22566]]
training model: results/WBA/W5/deepOF_L2/h100
Epoch 1/50
1664/1664 - 54s - loss: 3.1703 - accuracy100: 0.4307 - val_loss: 3.2957 - val_accuracy100: 0.3762 - 54s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 50s - loss: 3.0781 - accuracy100: 0.4660 - val_loss: 3.2596 - val_accuracy100: 0.3913 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.0467 - accuracy100: 0.4748 - val_loss: 3.2186 - val_accuracy100: 0.4150 - 51s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 52s - loss: 3.0243 - accuracy100: 0.4797 - val_loss: 3.1881 - val_accuracy100: 0.4280 - 52s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 52s - loss: 3.0078 - accuracy100: 0.4845 - val_loss: 3.1668 - val_accuracy100: 0.4331 - 52s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 52s - loss: 2.9968 - accuracy100: 0.4873 - val_loss: 3.1854 - val_accuracy100: 0.4321 - 52s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 51s - loss: 2.9883 - accuracy100: 0.4896 - val_loss: 3.1589 - val_accuracy100: 0.4370 - 51s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 51s - loss: 2.9817 - accuracy100: 0.4922 - val_loss: 3.1430 - val_accuracy100: 0.4413 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 2.9759 - accuracy100: 0.4936 - val_loss: 3.1394 - val_accuracy100: 0.4425 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 2.9710 - accuracy100: 0.4950 - val_loss: 3.2089 - val_accuracy100: 0.4383 - 51s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 49s - loss: 2.9643 - accuracy100: 0.4969 - val_loss: 3.1972 - val_accuracy100: 0.4352 - 49s/epoch - 30ms/step
Epoch 12/50
1664/1664 - 50s - loss: 2.9611 - accuracy100: 0.4982 - val_loss: 3.1626 - val_accuracy100: 0.4370 - 50s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 51s - loss: 2.9563 - accuracy100: 0.4986 - val_loss: 3.1829 - val_accuracy100: 0.4391 - 51s/epoch - 30ms/step
Epoch 14/50
1664/1664 - 50s - loss: 2.9532 - accuracy100: 0.4997 - val_loss: 3.1756 - val_accuracy100: 0.4369 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 50s - loss: 2.9486 - accuracy100: 0.5012 - val_loss: 3.1842 - val_accuracy100: 0.4314 - 50s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 52s - loss: 2.9434 - accuracy100: 0.5037 - val_loss: 3.1961 - val_accuracy100: 0.4337 - 52s/epoch - 31ms/step
Epoch 17/50
1664/1664 - 51s - loss: 2.9395 - accuracy100: 0.5037 - val_loss: 3.2085 - val_accuracy100: 0.4303 - 51s/epoch - 31ms/step
Epoch 18/50
1664/1664 - 51s - loss: 2.9331 - accuracy100: 0.5067 - val_loss: 3.1967 - val_accuracy100: 0.4343 - 51s/epoch - 30ms/step
Epoch 19/50
1664/1664 - 51s - loss: 2.9289 - accuracy100: 0.5077 - val_loss: 3.2143 - val_accuracy100: 0.4295 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepOF_L2/h100
Evaluating performance on  test set...
7458/7458 - 115s - 115s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0794636
{'0': {'precision': 0.4803808220232081, 'recall': 0.320319387795055, 'f1-score': 0.3843518184012584, 'support': 740667}, '1': {'precision': 0.2873404347449554, 'recall': 0.40511744782064024, 'f1-score': 0.3362128629347288, 'support': 409501}, '2': {'precision': 0.4625562488589134, 'recall': 0.5106589836617581, 'f1-score': 0.48541883857879464, 'support': 759078}, 'accuracy': 0.41418235261459235, 'macro avg': {'precision': 0.4100925018756923, 'recall': 0.41203193975915114, 'f1-score': 0.4019945066382606, 'support': 1909246}, 'weighted avg': {'precision': 0.43189022784140113, 'recall': 0.41418235261459235, 'f1-score': 0.4142090505964939, 'support': 1909246}}
[[237250 211339 292078]
 [ 85296 165896 158309]
 [171333 200115 387630]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0311419
{'0': {'precision': 0.53370336766825, 'recall': 0.27852243846394875, 'f1-score': 0.36602718666928985, 'support': 143615}, '1': {'precision': 0.4358223113750562, 'recall': 0.6291726105563481, 'f1-score': 0.514946044792892, 'support': 140200}, '2': {'precision': 0.4743227421373491, 'recall': 0.4959056181672365, 'f1-score': 0.4848741229880314, 'support': 142146}, 'accuracy': 0.46647697793929493, 'macro avg': {'precision': 0.4812828070602184, 'recall': 0.4678668890625111, 'f1-score': 0.4552824514834044, 'support': 425961}, 'weighted avg': {'precision': 0.48167127438031704, 'recall': 0.46647697793929493, 'f1-score': 0.4547020665735366, 'support': 425961}}
[[40000 63081 40534]
 [14401 88210 37589]
 [20547 51108 70491]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.048294
{'0': {'precision': 0.5027501506931886, 'recall': 0.28031591992774174, 'f1-score': 0.3599412010626964, 'support': 47607}, '1': {'precision': 0.38687410978415687, 'recall': 0.5852001215368892, 'f1-score': 0.46580552959929644, 'support': 36203}, '2': {'precision': 0.47246849751322023, 'recall': 0.4969295978496847, 'f1-score': 0.48439043069915555, 'support': 48365}, 'accuracy': 0.44308681672025724, 'macro avg': {'precision': 0.4540309193301886, 'recall': 0.4541485464381052, 'f1-score': 0.4367123871203828, 'support': 132175}, 'weighted avg': {'precision': 0.4599309150958453, 'recall': 0.44308681672025724, 'f1-score': 0.4344756688317743, 'support': 132175}}
[[13345 18012 16250]
 [ 4432 21186 10585]
 [ 8767 15564 24034]]
training model: results/WBA/W5/deepOF_L2/h200
Epoch 1/50
1664/1664 - 53s - loss: 3.2670 - accuracy200: 0.3810 - val_loss: 3.3000 - val_accuracy200: 0.3741 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 50s - loss: 3.2295 - accuracy200: 0.4013 - val_loss: 3.2821 - val_accuracy200: 0.3809 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.2161 - accuracy200: 0.4074 - val_loss: 3.2808 - val_accuracy200: 0.3844 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 51s - loss: 3.2076 - accuracy200: 0.4113 - val_loss: 3.2756 - val_accuracy200: 0.3858 - 51s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 50s - loss: 3.1997 - accuracy200: 0.4148 - val_loss: 3.2724 - val_accuracy200: 0.3892 - 50s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 50s - loss: 3.1941 - accuracy200: 0.4176 - val_loss: 3.2707 - val_accuracy200: 0.3897 - 50s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 50s - loss: 3.1871 - accuracy200: 0.4204 - val_loss: 3.2838 - val_accuracy200: 0.3907 - 50s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 50s - loss: 3.1827 - accuracy200: 0.4228 - val_loss: 3.2756 - val_accuracy200: 0.3905 - 50s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 51s - loss: 3.1783 - accuracy200: 0.4249 - val_loss: 3.2824 - val_accuracy200: 0.3911 - 51s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 50s - loss: 3.1737 - accuracy200: 0.4269 - val_loss: 3.2826 - val_accuracy200: 0.3931 - 50s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 51s - loss: 3.1698 - accuracy200: 0.4288 - val_loss: 3.2856 - val_accuracy200: 0.3916 - 51s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 51s - loss: 3.1655 - accuracy200: 0.4311 - val_loss: 3.2814 - val_accuracy200: 0.3932 - 51s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 52s - loss: 3.1604 - accuracy200: 0.4337 - val_loss: 3.2946 - val_accuracy200: 0.3913 - 52s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 52s - loss: 3.1571 - accuracy200: 0.4345 - val_loss: 3.3061 - val_accuracy200: 0.3894 - 52s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 52s - loss: 3.1518 - accuracy200: 0.4378 - val_loss: 3.3127 - val_accuracy200: 0.3879 - 52s/epoch - 31ms/step
Epoch 16/50
1664/1664 - 52s - loss: 3.1468 - accuracy200: 0.4390 - val_loss: 3.3109 - val_accuracy200: 0.3879 - 52s/epoch - 31ms/step
testing model: results/WBA/W5/deepOF_L2/h200
Evaluating performance on  test set...
7458/7458 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158093
{'0': {'precision': 0.45540681140320455, 'recall': 0.26199660546212006, 'f1-score': 0.33263024927679163, 'support': 751796}, '1': {'precision': 0.20352281891344778, 'recall': 0.248838560544512, 'f1-score': 0.22391091545908753, 'support': 397567}, '2': {'precision': 0.4286800155050028, 'recall': 0.5588636671698143, 'f1-score': 0.4851910648825985, 'support': 759883}, 'accuracy': 0.3774102446725042, 'macro avg': {'precision': 0.36253654860721835, 'recall': 0.3565662777254821, 'f1-score': 0.3472440765394926, 'support': 1909246}, 'weighted avg': {'precision': 0.39231907881678646, 'recall': 0.3774102446725042, 'f1-score': 0.37071080613383584, 'support': 1909246}}
[[196968 199436 355392]
 [ 88052  98930 210585]
 [147490 187722 424671]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0760468
{'0': {'precision': 0.44171530479896237, 'recall': 0.27110416148406125, 'f1-score': 0.33599210736103097, 'support': 140695}, '1': {'precision': 0.4051539508709865, 'recall': 0.31752266271626417, 'f1-score': 0.3560252507743241, 'support': 147158}, '2': {'precision': 0.3840645621544498, 'recall': 0.6237002925246908, 'f1-score': 0.4753910173626058, 'support': 138108}, 'accuracy': 0.4014616361591789, 'macro avg': {'precision': 0.4103112726081329, 'recall': 0.40410903890833877, 'f1-score': 0.3891361251659869, 'support': 425961}, 'weighted avg': {'precision': 0.4103924266798824, 'recall': 0.4014616361591789, 'f1-score': 0.38810988805201174, 'support': 425961}}
[[38143 38069 64483]
 [26773 46726 73659]
 [21436 30534 86138]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878487
{'0': {'precision': 0.42047226957814937, 'recall': 0.25825424408501535, 'f1-score': 0.31997791732799663, 'support': 44886}, '1': {'precision': 0.37337903456155386, 'recall': 0.3119287947121006, 'f1-score': 0.33989885200930875, 'support': 41907}, '2': {'precision': 0.3871055807805046, 'recall': 0.5936494645454145, 'f1-score': 0.4686287811581346, 'support': 45382}, 'accuracy': 0.39042935502175147, 'macro avg': {'precision': 0.39365229497340265, 'recall': 0.3879441677808435, 'f1-score': 0.37616851683181335, 'support': 132175}, 'weighted avg': {'precision': 0.3940846526244503, 'recall': 0.39042935502175147, 'f1-score': 0.37733293992704386, 'support': 132175}}
[[11592 11539 21755]
 [ 7935 13072 20900]
 [ 8042 10399 26941]]
training model: results/WBA/W5/deepOF_L2/h300
Epoch 1/50
1664/1664 - 54s - loss: 3.2864 - accuracy300: 0.3689 - val_loss: 3.3093 - val_accuracy300: 0.3632 - 54s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 51s - loss: 3.2593 - accuracy300: 0.3859 - val_loss: 3.2928 - val_accuracy300: 0.3695 - 51s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.2492 - accuracy300: 0.3917 - val_loss: 3.2859 - val_accuracy300: 0.3752 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 50s - loss: 3.2440 - accuracy300: 0.3951 - val_loss: 3.2784 - val_accuracy300: 0.3789 - 50s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 50s - loss: 3.2398 - accuracy300: 0.3975 - val_loss: 3.2774 - val_accuracy300: 0.3803 - 50s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 51s - loss: 3.2358 - accuracy300: 0.4003 - val_loss: 3.2770 - val_accuracy300: 0.3814 - 51s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 51s - loss: 3.2316 - accuracy300: 0.4023 - val_loss: 3.2761 - val_accuracy300: 0.3826 - 51s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 52s - loss: 3.2286 - accuracy300: 0.4047 - val_loss: 3.2744 - val_accuracy300: 0.3829 - 52s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 3.2254 - accuracy300: 0.4069 - val_loss: 3.2784 - val_accuracy300: 0.3823 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 52s - loss: 3.2223 - accuracy300: 0.4083 - val_loss: 3.2931 - val_accuracy300: 0.3812 - 52s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 53s - loss: 3.2181 - accuracy300: 0.4110 - val_loss: 3.2927 - val_accuracy300: 0.3828 - 53s/epoch - 32ms/step
Epoch 12/50
1664/1664 - 52s - loss: 3.2152 - accuracy300: 0.4125 - val_loss: 3.2906 - val_accuracy300: 0.3819 - 52s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 53s - loss: 3.2119 - accuracy300: 0.4149 - val_loss: 3.3038 - val_accuracy300: 0.3798 - 53s/epoch - 32ms/step
Epoch 14/50
1664/1664 - 50s - loss: 3.2079 - accuracy300: 0.4175 - val_loss: 3.3072 - val_accuracy300: 0.3812 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 52s - loss: 3.2039 - accuracy300: 0.4188 - val_loss: 3.3082 - val_accuracy300: 0.3811 - 52s/epoch - 31ms/step
Epoch 16/50
1664/1664 - 53s - loss: 3.1992 - accuracy300: 0.4215 - val_loss: 3.2957 - val_accuracy300: 0.3851 - 53s/epoch - 32ms/step
Epoch 17/50
1664/1664 - 52s - loss: 3.1955 - accuracy300: 0.4241 - val_loss: 3.3071 - val_accuracy300: 0.3859 - 52s/epoch - 31ms/step
Epoch 18/50
1664/1664 - 51s - loss: 3.1900 - accuracy300: 0.4263 - val_loss: 3.3258 - val_accuracy300: 0.3760 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepOF_L2/h300
Evaluating performance on  test set...
7458/7458 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958827
{'0': {'precision': 0.4103257673762202, 'recall': 0.28602879143352006, 'f1-score': 0.33708398071597523, 'support': 670894}, '1': {'precision': 0.3580543170435936, 'recall': 0.17471798630602284, 'f1-score': 0.23484152186110435, 'support': 559370}, '2': {'precision': 0.37975300951200897, 'recall': 0.6536108468265727, 'f1-score': 0.4803935895562375, 'support': 678982}, 'accuracy': 0.38413960275417625, 'macro avg': {'precision': 0.38271103131060763, 'recall': 0.3714525415220385, 'f1-score': 0.35077303071110566, 'support': 1909246}, 'weighted avg': {'precision': 0.38413876295001254, 'recall': 0.38413960275417625, 'f1-score': 0.35809399232261463, 'support': 1909246}}
[[191895  89990 389009]
 [125809  97732 335829]
 [149961  85231 443790]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0859098
{'0': {'precision': 0.43096796522695113, 'recall': 0.2919430691362452, 'f1-score': 0.34808739799798566, 'support': 145018}, '1': {'precision': 0.4152008483033932, 'recall': 0.19205135603000578, 'f1-score': 0.26262526631421135, 'support': 138640}, '2': {'precision': 0.3716672483649221, 'recall': 0.6884605384285644, 'f1-score': 0.48273092567362824, 'support': 142303}, 'accuracy': 0.3918973802765981, 'macro avg': {'precision': 0.4059453539650888, 'recall': 0.3908183211982718, 'f1-score': 0.36448119666194173, 'support': 425961}, 'weighted avg': {'precision': 0.40602525215721147, 'recall': 0.3918973802765981, 'f1-score': 0.36525260322144154, 'support': 425961}}
[[42337 19939 82742]
 [29130 26626 82884]
 [26770 17563 97970]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926325
{'0': {'precision': 0.4102445919370698, 'recall': 0.29358342862169057, 'f1-score': 0.3422455780569085, 'support': 45476}, '1': {'precision': 0.3848843598581348, 'recall': 0.18753346638757729, 'f1-score': 0.2521888552491613, 'support': 41086}, '2': {'precision': 0.3716148319348842, 'recall': 0.6486089492030781, 'f1-score': 0.4725094829307247, 'support': 45613}, 'accuracy': 0.3831359939474182, 'macro avg': {'precision': 0.38891459457669625, 'recall': 0.3765752814041153, 'f1-score': 0.35564797207893156, 'support': 132175}, 'weighted avg': {'precision': 0.38903052166527247, 'recall': 0.3831359939474182, 'f1-score': 0.3592053433660084, 'support': 132175}}
[[13351  6247 25878]
 [ 9232  7705 24149]
 [ 9961  6067 29585]]
training model: results/WBA/W5/deepOF_L2/h500
Epoch 1/50
1664/1664 - 55s - loss: 3.2508 - accuracy500: 0.4005 - val_loss: 3.3095 - val_accuracy500: 0.3644 - 55s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 50s - loss: 3.2397 - accuracy500: 0.4046 - val_loss: 3.2879 - val_accuracy500: 0.3670 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 50s - loss: 3.2293 - accuracy500: 0.4044 - val_loss: 3.2797 - val_accuracy500: 0.3736 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 50s - loss: 3.2343 - accuracy500: 0.4032 - val_loss: 3.2769 - val_accuracy500: 0.3746 - 50s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 50s - loss: 3.2330 - accuracy500: 0.4034 - val_loss: 3.2777 - val_accuracy500: 0.3753 - 50s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 51s - loss: 3.2308 - accuracy500: 0.4040 - val_loss: 3.2775 - val_accuracy500: 0.3748 - 51s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 51s - loss: 3.2280 - accuracy500: 0.4044 - val_loss: 3.2724 - val_accuracy500: 0.3759 - 51s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 50s - loss: 3.2278 - accuracy500: 0.4053 - val_loss: 3.2704 - val_accuracy500: 0.3769 - 50s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 50s - loss: 3.2266 - accuracy500: 0.4060 - val_loss: 3.2690 - val_accuracy500: 0.3778 - 50s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 51s - loss: 3.2225 - accuracy500: 0.4069 - val_loss: 3.2695 - val_accuracy500: 0.3788 - 51s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 51s - loss: 3.2211 - accuracy500: 0.4079 - val_loss: 3.2678 - val_accuracy500: 0.3798 - 51s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 51s - loss: 3.2185 - accuracy500: 0.4088 - val_loss: 3.2682 - val_accuracy500: 0.3814 - 51s/epoch - 30ms/step
Epoch 13/50
1664/1664 - 52s - loss: 3.2177 - accuracy500: 0.4087 - val_loss: 3.2720 - val_accuracy500: 0.3790 - 52s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 52s - loss: 3.2132 - accuracy500: 0.4108 - val_loss: 3.2737 - val_accuracy500: 0.3772 - 52s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 52s - loss: 3.2107 - accuracy500: 0.4113 - val_loss: 3.2750 - val_accuracy500: 0.3782 - 52s/epoch - 31ms/step
Epoch 16/50
1664/1664 - 53s - loss: 3.2102 - accuracy500: 0.4112 - val_loss: 3.2746 - val_accuracy500: 0.3777 - 53s/epoch - 32ms/step
Epoch 17/50
1664/1664 - 53s - loss: 3.2058 - accuracy500: 0.4133 - val_loss: 3.2772 - val_accuracy500: 0.3771 - 53s/epoch - 32ms/step
Epoch 18/50
1664/1664 - 53s - loss: 3.2029 - accuracy500: 0.4149 - val_loss: 3.2754 - val_accuracy500: 0.3796 - 53s/epoch - 32ms/step
Epoch 19/50
1664/1664 - 52s - loss: 3.2007 - accuracy500: 0.4171 - val_loss: 3.2781 - val_accuracy500: 0.3773 - 52s/epoch - 31ms/step
Epoch 20/50
1664/1664 - 52s - loss: 3.1978 - accuracy500: 0.4190 - val_loss: 3.2781 - val_accuracy500: 0.3762 - 52s/epoch - 31ms/step
Epoch 21/50
1664/1664 - 50s - loss: 3.1957 - accuracy500: 0.4203 - val_loss: 3.2783 - val_accuracy500: 0.3770 - 50s/epoch - 30ms/step
testing model: results/WBA/W5/deepOF_L2/h500
Evaluating performance on  test set...
7458/7458 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0829164
{'0': {'precision': 0.4186514846387959, 'recall': 0.26885602520434077, 'f1-score': 0.32743489342120513, 'support': 719876}, '1': {'precision': 0.2930602291459477, 'recall': 0.09369467075218377, 'f1-score': 0.14199267643472074, 'support': 459183}, '2': {'precision': 0.397992829997408, 'recall': 0.7086486064528675, 'f1-score': 0.509717158722294, 'support': 730187}, 'accuracy': 0.3949265835832575, 'macro avg': {'precision': 0.3699015145940505, 'recall': 0.35706643413646405, 'f1-score': 0.32638157619273994, 'support': 1909246}, 'weighted avg': {'precision': 0.38054531574929523, 'recall': 0.3949265835832575, 'f1-score': 0.3525485911484238, 'support': 1909246}}
[[193543  51943 474390]
 [107857  43023 308303]
 [160901  51840 517446]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977467
{'0': {'precision': 0.39114472025864433, 'recall': 0.29635267823162675, 'f1-score': 0.33721374271192983, 'support': 144517}, '1': {'precision': 0.3731221423905944, 'recall': 0.08211154233146471, 'f1-score': 0.13460179076343073, 'support': 139140}, '2': {'precision': 0.3577753133669411, 'recall': 0.7186656734877446, 'f1-score': 0.477723980558261, 'support': 142304}, 'accuracy': 0.36745617556536864, 'macro avg': {'precision': 0.37401405867205995, 'recall': 0.365709964683612, 'f1-score': 0.31651317134454054, 'support': 425961}, 'weighted avg': {'precision': 0.37410968286583746, 'recall': 0.36745617556536864, 'f1-score': 0.31797193863214357, 'support': 425961}}
[[ 42828   9852  91837]
 [ 35974  11425  91741]
 [ 30692   9343 102269]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0900142
{'0': {'precision': 0.4056424282061954, 'recall': 0.2852156100415961, 'f1-score': 0.33493292750279213, 'support': 47841}, '1': {'precision': 0.34192768657468026, 'recall': 0.09224540810781437, 'f1-score': 0.14529347570239445, 'support': 36804}, '2': {'precision': 0.375598140122788, 'recall': 0.7002103934357248, 'f1-score': 0.4889303500859422, 'support': 47530}, 'accuracy': 0.3807149612256478, 'macro avg': {'precision': 0.37438941830122124, 'recall': 0.35922380386171177, 'f1-score': 0.32305225109704294, 'support': 132175}, 'weighted avg': {'precision': 0.3770972240177283, 'recall': 0.3807149612256478, 'f1-score': 0.3375053285719451, 'support': 132175}}
[[13645  3265 30931]
 [ 9013  3395 24396]
 [10980  3269 33281]]
training model: results/WBA/W5/deepOF_L2/h1000
Epoch 1/50
1664/1664 - 54s - loss: 3.2774 - accuracy1000: 0.3814 - val_loss: 3.3666 - val_accuracy1000: 0.3491 - 54s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 49s - loss: 3.2539 - accuracy1000: 0.3903 - val_loss: 3.3118 - val_accuracy1000: 0.3532 - 49s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 49s - loss: 3.2434 - accuracy1000: 0.3949 - val_loss: 3.2957 - val_accuracy1000: 0.3590 - 49s/epoch - 29ms/step
Epoch 4/50
1664/1664 - 48s - loss: 3.2410 - accuracy1000: 0.3979 - val_loss: 3.2936 - val_accuracy1000: 0.3576 - 48s/epoch - 29ms/step
Epoch 5/50
1664/1664 - 49s - loss: 3.2377 - accuracy1000: 0.3999 - val_loss: 3.2932 - val_accuracy1000: 0.3605 - 49s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 51s - loss: 3.2351 - accuracy1000: 0.4019 - val_loss: 3.2921 - val_accuracy1000: 0.3602 - 51s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 50s - loss: 3.2326 - accuracy1000: 0.4037 - val_loss: 3.2993 - val_accuracy1000: 0.3599 - 50s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 50s - loss: 3.2294 - accuracy1000: 0.4050 - val_loss: 3.2961 - val_accuracy1000: 0.3621 - 50s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 51s - loss: 3.2271 - accuracy1000: 0.4071 - val_loss: 3.2908 - val_accuracy1000: 0.3662 - 51s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 3.2255 - accuracy1000: 0.4072 - val_loss: 3.2915 - val_accuracy1000: 0.3685 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 51s - loss: 3.2224 - accuracy1000: 0.4092 - val_loss: 3.2959 - val_accuracy1000: 0.3677 - 51s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 51s - loss: 3.2205 - accuracy1000: 0.4104 - val_loss: 3.2934 - val_accuracy1000: 0.3687 - 51s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 52s - loss: 3.2181 - accuracy1000: 0.4117 - val_loss: 3.2927 - val_accuracy1000: 0.3684 - 52s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 50s - loss: 3.2160 - accuracy1000: 0.4119 - val_loss: 3.2891 - val_accuracy1000: 0.3693 - 50s/epoch - 30ms/step
Epoch 15/50
1664/1664 - 51s - loss: 3.2140 - accuracy1000: 0.4129 - val_loss: 3.2876 - val_accuracy1000: 0.3702 - 51s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 50s - loss: 3.2112 - accuracy1000: 0.4143 - val_loss: 3.2889 - val_accuracy1000: 0.3683 - 50s/epoch - 30ms/step
Epoch 17/50
1664/1664 - 50s - loss: 3.2091 - accuracy1000: 0.4150 - val_loss: 3.2886 - val_accuracy1000: 0.3706 - 50s/epoch - 30ms/step
Epoch 18/50
1664/1664 - 51s - loss: 3.2070 - accuracy1000: 0.4167 - val_loss: 3.2894 - val_accuracy1000: 0.3673 - 51s/epoch - 31ms/step
Epoch 19/50
1664/1664 - 52s - loss: 3.2044 - accuracy1000: 0.4173 - val_loss: 3.2939 - val_accuracy1000: 0.3624 - 52s/epoch - 31ms/step
Epoch 20/50
1664/1664 - 52s - loss: 3.2030 - accuracy1000: 0.4187 - val_loss: 3.2879 - val_accuracy1000: 0.3687 - 52s/epoch - 31ms/step
Epoch 21/50
1664/1664 - 52s - loss: 3.2006 - accuracy1000: 0.4195 - val_loss: 3.2942 - val_accuracy1000: 0.3674 - 52s/epoch - 31ms/step
Epoch 22/50
1664/1664 - 54s - loss: 3.1968 - accuracy1000: 0.4224 - val_loss: 3.2973 - val_accuracy1000: 0.3644 - 54s/epoch - 32ms/step
Epoch 23/50
1664/1664 - 52s - loss: 3.1950 - accuracy1000: 0.4231 - val_loss: 3.2938 - val_accuracy1000: 0.3672 - 52s/epoch - 31ms/step
Epoch 24/50
1664/1664 - 51s - loss: 3.1920 - accuracy1000: 0.4245 - val_loss: 3.2919 - val_accuracy1000: 0.3688 - 51s/epoch - 31ms/step
Epoch 25/50
1664/1664 - 49s - loss: 3.1895 - accuracy1000: 0.4257 - val_loss: 3.2936 - val_accuracy1000: 0.3672 - 49s/epoch - 29ms/step
testing model: results/WBA/W5/deepOF_L2/h1000
Evaluating performance on  test set...
7458/7458 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1094178
{'0': {'precision': 0.43756067312421154, 'recall': 0.13096056348484092, 'f1-score': 0.20158681372375178, 'support': 781281}, '1': {'precision': 0.17850232198142416, 'recall': 0.3112460687561002, 'f1-score': 0.22688444528378124, 'support': 331956}, '2': {'precision': 0.4207132077020231, 'recall': 0.5795813866426134, 'f1-score': 0.4875314645853016, 'support': 796009}, 'accuracy': 0.3493468102067518, 'macro avg': {'precision': 0.34559206760255295, 'recall': 0.3405960062945182, 'f1-score': 0.30533424119761154, 'support': 1909246}, 'weighted avg': {'precision': 0.38549472242157506, 'recall': 0.3493468102067518, 'f1-score': 0.32520221800889504, 'support': 1909246}}
[[102317 233504 445460]
 [ 38853 103320 189783]
 [ 92665 241992 461352]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0913928
{'0': {'precision': 0.41147951625501655, 'recall': 0.10724389439175576, 'f1-score': 0.17014333604339063, 'support': 142451}, '1': {'precision': 0.3947538353162179, 'recall': 0.5690610851751033, 'f1-score': 0.46614560768070984, 'support': 141802}, '2': {'precision': 0.36747497532778794, 'recall': 0.4782298811640839, 'f1-score': 0.4156001054807037, 'support': 141708}, 'accuracy': 0.3844013888595435, 'macro avg': {'precision': 0.3912361089663408, 'recall': 0.38484495357698095, 'f1-score': 0.3506296830682681, 'support': 425961}, 'weighted avg': {'precision': 0.39127219564538507, 'recall': 0.3844013888595435, 'f1-score': 0.3503403540946627, 'support': 425961}}
[[15277 62234 64940]
 [ 9399 80694 51709]
 [12451 61488 67769]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096075
{'0': {'precision': 0.3884400248601616, 'recall': 0.12300728203109625, 'f1-score': 0.18684603886397608, 'support': 45729}, '1': {'precision': 0.3733912483912484, 'recall': 0.4589791125942405, 'f1-score': 0.41178492620560414, 'support': 40455}, '2': {'precision': 0.36427037047935734, 'recall': 0.5383227153138658, 'f1-score': 0.43451477311617537, 'support': 45991}, 'accuracy': 0.3703499148855684, 'macro avg': {'precision': 0.37536721457692246, 'recall': 0.3734363699797341, 'f1-score': 0.3443819127285852, 'support': 132175}, 'weighted avg': {'precision': 0.3754240624869635, 'recall': 0.3703499148855684, 'f1-score': 0.34187108478338946, 'support': 132175}}
[[ 5625 15449 24655]
 [ 3334 18568 18553]
 [ 5522 15711 24758]]
training model: results/WBA/W5/deepVOL_L2/h10
Epoch 1/50
1664/1664 - 55s - loss: 2.8295 - accuracy10: 0.4945 - val_loss: 3.1967 - val_accuracy10: 0.5696 - 55s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 51s - loss: 2.5932 - accuracy10: 0.5576 - val_loss: 3.1838 - val_accuracy10: 0.5794 - 51s/epoch - 31ms/step
Epoch 3/50
1664/1664 - 50s - loss: 2.5209 - accuracy10: 0.5809 - val_loss: 3.0504 - val_accuracy10: 0.5742 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 50s - loss: 2.4828 - accuracy10: 0.5888 - val_loss: 3.0243 - val_accuracy10: 0.5699 - 50s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 51s - loss: 2.4593 - accuracy10: 0.5935 - val_loss: 3.0095 - val_accuracy10: 0.5725 - 51s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 51s - loss: 2.4413 - accuracy10: 0.5984 - val_loss: 3.0270 - val_accuracy10: 0.5821 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 52s - loss: 2.4276 - accuracy10: 0.6013 - val_loss: 3.0300 - val_accuracy10: 0.5870 - 52s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 52s - loss: 2.4148 - accuracy10: 0.6035 - val_loss: 3.0248 - val_accuracy10: 0.5830 - 52s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 2.4039 - accuracy10: 0.6064 - val_loss: 2.9977 - val_accuracy10: 0.5944 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 2.3941 - accuracy10: 0.6066 - val_loss: 3.0419 - val_accuracy10: 0.5915 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 52s - loss: 2.3835 - accuracy10: 0.6088 - val_loss: 3.0395 - val_accuracy10: 0.5972 - 52s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 52s - loss: 2.3757 - accuracy10: 0.6097 - val_loss: 3.0215 - val_accuracy10: 0.5864 - 52s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 50s - loss: 2.3671 - accuracy10: 0.6100 - val_loss: 3.0260 - val_accuracy10: 0.5882 - 50s/epoch - 30ms/step
Epoch 14/50
1664/1664 - 49s - loss: 2.3586 - accuracy10: 0.6124 - val_loss: 3.0206 - val_accuracy10: 0.5964 - 49s/epoch - 29ms/step
Epoch 15/50
1664/1664 - 51s - loss: 2.3506 - accuracy10: 0.6123 - val_loss: 3.0756 - val_accuracy10: 0.5990 - 51s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 51s - loss: 2.3456 - accuracy10: 0.6134 - val_loss: 3.0696 - val_accuracy10: 0.5972 - 51s/epoch - 31ms/step
Epoch 17/50
1664/1664 - 51s - loss: 2.3402 - accuracy10: 0.6147 - val_loss: 3.0291 - val_accuracy10: 0.5940 - 51s/epoch - 31ms/step
Epoch 18/50
1664/1664 - 52s - loss: 2.3325 - accuracy10: 0.6153 - val_loss: 3.0730 - val_accuracy10: 0.5890 - 52s/epoch - 31ms/step
Epoch 19/50
1664/1664 - 50s - loss: 2.3275 - accuracy10: 0.6162 - val_loss: 3.0703 - val_accuracy10: 0.5960 - 50s/epoch - 30ms/step
testing model: results/WBA/W5/deepVOL_L2/h10
Evaluating performance on  test set...
7459/7459 - 119s - 119s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99392235
{'0': {'precision': 0.4055033476703122, 'recall': 0.5698917236489491, 'f1-score': 0.4738449240607514, 'support': 416065}, '1': {'precision': 0.7382284143838186, 'recall': 0.511059011926265, 'f1-score': 0.6039895641073139, 'support': 1059091}, '2': {'precision': 0.40779022239659346, 'recall': 0.5554982204356189, 'f1-score': 0.4703196525151498, 'support': 434095}, 'accuracy': 0.5339837454582975, 'macro avg': {'precision': 0.5171739948169081, 'recall': 0.5454829853369444, 'f1-score': 0.5160513802277383, 'support': 1909251}, 'weighted avg': {'precision': 0.5905910310157598, 'recall': 0.5339837454582975, 'f1-score': 0.5452366448035798, 'support': 1909251}}
[[237112 101763  77190]
 [244831 541258 273002]
 [102792  90164 241139]]
Evaluating performance on  train set...
1664/1664 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8067185
{'0': {'precision': 0.4005575929571413, 'recall': 0.6008844251236696, 'f1-score': 0.4806844822314025, 'support': 66710}, '1': {'precision': 0.8557358517437202, 'recall': 0.6586926658147971, 'f1-score': 0.7443955563212471, 'support': 291907}, '2': {'precision': 0.38690487954307395, 'recall': 0.581385679921599, 'f1-score': 0.4646145813556104, 'support': 67346}, 'accuracy': 0.6374168648450687, 'macro avg': {'precision': 0.5477327747479785, 'recall': 0.6136542569533553, 'f1-score': 0.56323153996942, 'support': 425963}, 'weighted avg': {'precision': 0.7103269023808004, 'recall': 0.6374168648450687, 'f1-score': 0.6588616125454513, 'support': 425963}}
[[ 40085  17104   9521]
 [ 47107 192277  52523]
 [ 12881  15311  39154]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8899275
{'0': {'precision': 0.40655655236019117, 'recall': 0.5795155764480918, 'f1-score': 0.4778673849843142, 'support': 25102}, '1': {'precision': 0.8128220648137545, 'recall': 0.6082980338385446, 'f1-score': 0.695842757210579, 'support': 81682}, '2': {'precision': 0.4094595360970907, 'recall': 0.568683049779458, 'f1-score': 0.4761119720399618, 'support': 25392}, 'accuracy': 0.5952215228180607, 'macro avg': {'precision': 0.5429460510903454, 'recall': 0.5854988866886982, 'f1-score': 0.5499407047449517, 'support': 132176}, 'weighted avg': {'precision': 0.6581778160637327, 'recall': 0.5952215228180607, 'f1-score': 0.6122343722490429, 'support': 132176}}
[[14547  6206  4349]
 [15518 49687 16477]
 [ 5716  5236 14440]]
training model: results/WBA/W5/deepVOL_L2/h20
Epoch 1/50
1664/1664 - 55s - loss: 2.8852 - accuracy20: 0.5066 - val_loss: 3.1711 - val_accuracy20: 0.5631 - 55s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 52s - loss: 2.6570 - accuracy20: 0.5688 - val_loss: 3.0793 - val_accuracy20: 0.5711 - 52s/epoch - 31ms/step
Epoch 3/50
1664/1664 - 51s - loss: 2.5961 - accuracy20: 0.5843 - val_loss: 3.0534 - val_accuracy20: 0.5645 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 50s - loss: 2.5692 - accuracy20: 0.5902 - val_loss: 3.0024 - val_accuracy20: 0.5679 - 50s/epoch - 30ms/step
Epoch 5/50
1664/1664 - 52s - loss: 2.5497 - accuracy20: 0.5936 - val_loss: 2.9887 - val_accuracy20: 0.5707 - 52s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 51s - loss: 2.5356 - accuracy20: 0.5964 - val_loss: 2.9983 - val_accuracy20: 0.5668 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 50s - loss: 2.5250 - accuracy20: 0.5979 - val_loss: 2.9756 - val_accuracy20: 0.5752 - 50s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 51s - loss: 2.5163 - accuracy20: 0.5999 - val_loss: 2.9539 - val_accuracy20: 0.5736 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 51s - loss: 2.5081 - accuracy20: 0.6010 - val_loss: 2.9810 - val_accuracy20: 0.5722 - 51s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 51s - loss: 2.4995 - accuracy20: 0.6027 - val_loss: 2.9979 - val_accuracy20: 0.5688 - 51s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 51s - loss: 2.4921 - accuracy20: 0.6041 - val_loss: 2.9730 - val_accuracy20: 0.5777 - 51s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 52s - loss: 2.4846 - accuracy20: 0.6056 - val_loss: 2.9812 - val_accuracy20: 0.5731 - 52s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 51s - loss: 2.4782 - accuracy20: 0.6063 - val_loss: 3.0006 - val_accuracy20: 0.5748 - 51s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 51s - loss: 2.4713 - accuracy20: 0.6074 - val_loss: 2.9929 - val_accuracy20: 0.5770 - 51s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 51s - loss: 2.4657 - accuracy20: 0.6075 - val_loss: 2.9876 - val_accuracy20: 0.5756 - 51s/epoch - 30ms/step
Epoch 16/50
1664/1664 - 51s - loss: 2.4596 - accuracy20: 0.6089 - val_loss: 2.9931 - val_accuracy20: 0.5775 - 51s/epoch - 31ms/step
Epoch 17/50
1664/1664 - 52s - loss: 2.4558 - accuracy20: 0.6096 - val_loss: 2.9822 - val_accuracy20: 0.5769 - 52s/epoch - 31ms/step
Epoch 18/50
1664/1664 - 52s - loss: 2.4509 - accuracy20: 0.6092 - val_loss: 2.9683 - val_accuracy20: 0.5777 - 52s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h20
Evaluating performance on  test set...
7459/7459 - 130s - 130s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0246055
{'0': {'precision': 0.4806937210016958, 'recall': 0.47728240111196074, 'f1-score': 0.478981987260665, 'support': 530954}, '1': {'precision': 0.6203363978069093, 'recall': 0.4713526227175169, 'f1-score': 0.5356785358763828, 'support': 821419}, '2': {'precision': 0.43954333091884, 'recall': 0.598227978120881, 'f1-score': 0.5067534934944526, 'support': 556878}, 'accuracy': 0.5100078512463788, 'macro avg': {'precision': 0.5135244832424818, 'recall': 0.5156210006501195, 'f1-score': 0.5071380055438335, 'support': 1909251}, 'weighted avg': {'precision': 0.5287698519085807, 'recall': 0.5100078512463788, 'f1-score': 0.5114748146132936, 'support': 1909251}}
[[253415 124481 153058]
 [162516 387178 271725]
 [111255 112483 333140]]
Evaluating performance on  train set...
1664/1664 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85858405
{'0': {'precision': 0.4895540970000109, 'recall': 0.5075405901134485, 'f1-score': 0.4983851152655249, 'support': 88322}, '1': {'precision': 0.7783438867564726, 'recall': 0.6400551664240738, 'f1-score': 0.7024582043480275, 'support': 248702}, '2': {'precision': 0.4208082783471023, 'recall': 0.6145223130460203, 'f1-score': 0.499543003381775, 'support': 88939}, 'accuracy': 0.6072475778412679, 'macro avg': {'precision': 0.562902087367862, 'recall': 0.5873726898611809, 'f1-score': 0.5667954409984425, 'support': 425963}, 'weighted avg': {'precision': 0.6438125981534925, 'recall': 0.6072475778412679, 'f1-score': 0.6177766277024449, 'support': 425963}}
[[ 44827  24797  18698]
 [ 32991 159183  56528]
 [ 13749  20535  54655]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9233351
{'0': {'precision': 0.4872898165949526, 'recall': 0.4926266428086629, 'f1-score': 0.48994369697620543, 'support': 32414}, '1': {'precision': 0.7273685358142239, 'recall': 0.5967857355835172, 'f1-score': 0.6556383588567685, 'support': 67076}, '2': {'precision': 0.4456088161719965, 'recall': 0.6049378938995289, 'f1-score': 0.5131911911652112, 'support': 32686}, 'accuracy': 0.5732583827623774, 'macro avg': {'precision': 0.5534223895270577, 'recall': 0.5647834240972364, 'f1-score': 0.5529244156660617, 'support': 132176}, 'weighted avg': {'precision': 0.598816379590709, 'recall': 0.5732583827623774, 'f1-score': 0.5797784834379117, 'support': 132176}}
[[15968  8172  8274]
 [10720 40030 16326]
 [ 6081  6832 19773]]
training model: results/WBA/W5/deepVOL_L2/h30
Epoch 1/50
1664/1664 - 53s - loss: 2.9211 - accuracy30: 0.5085 - val_loss: 3.1203 - val_accuracy30: 0.5322 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 52s - loss: 2.7592 - accuracy30: 0.5515 - val_loss: 3.1060 - val_accuracy30: 0.5371 - 52s/epoch - 31ms/step
Epoch 3/50
1664/1664 - 52s - loss: 2.7045 - accuracy30: 0.5671 - val_loss: 3.0535 - val_accuracy30: 0.5435 - 52s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 53s - loss: 2.6756 - accuracy30: 0.5737 - val_loss: 3.0726 - val_accuracy30: 0.5438 - 53s/epoch - 32ms/step
Epoch 5/50
1664/1664 - 52s - loss: 2.6549 - accuracy30: 0.5775 - val_loss: 3.0260 - val_accuracy30: 0.5466 - 52s/epoch - 32ms/step
Epoch 6/50
1664/1664 - 51s - loss: 2.6378 - accuracy30: 0.5817 - val_loss: 3.0374 - val_accuracy30: 0.5471 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 52s - loss: 2.6256 - accuracy30: 0.5847 - val_loss: 3.0394 - val_accuracy30: 0.5489 - 52s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 52s - loss: 2.6152 - accuracy30: 0.5863 - val_loss: 3.0165 - val_accuracy30: 0.5508 - 52s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 50s - loss: 2.6067 - accuracy30: 0.5876 - val_loss: 3.0427 - val_accuracy30: 0.5537 - 50s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 51s - loss: 2.5985 - accuracy30: 0.5894 - val_loss: 3.0556 - val_accuracy30: 0.5542 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 52s - loss: 2.5914 - accuracy30: 0.5904 - val_loss: 3.0544 - val_accuracy30: 0.5506 - 52s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 51s - loss: 2.5847 - accuracy30: 0.5910 - val_loss: 3.0494 - val_accuracy30: 0.5521 - 51s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 51s - loss: 2.5780 - accuracy30: 0.5922 - val_loss: 3.0296 - val_accuracy30: 0.5538 - 51s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 52s - loss: 2.5716 - accuracy30: 0.5930 - val_loss: 3.0099 - val_accuracy30: 0.5540 - 52s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 52s - loss: 2.5650 - accuracy30: 0.5937 - val_loss: 3.0438 - val_accuracy30: 0.5507 - 52s/epoch - 31ms/step
Epoch 16/50
1664/1664 - 53s - loss: 2.5596 - accuracy30: 0.5952 - val_loss: 3.0191 - val_accuracy30: 0.5516 - 53s/epoch - 32ms/step
Epoch 17/50
1664/1664 - 53s - loss: 2.5544 - accuracy30: 0.5955 - val_loss: 3.0305 - val_accuracy30: 0.5509 - 53s/epoch - 32ms/step
Epoch 18/50
1664/1664 - 53s - loss: 2.5498 - accuracy30: 0.5964 - val_loss: 3.0532 - val_accuracy30: 0.5512 - 53s/epoch - 32ms/step
Epoch 19/50
1664/1664 - 53s - loss: 2.5443 - accuracy30: 0.5968 - val_loss: 3.0226 - val_accuracy30: 0.5511 - 53s/epoch - 32ms/step
Epoch 20/50
1664/1664 - 52s - loss: 2.5407 - accuracy30: 0.5979 - val_loss: 3.0338 - val_accuracy30: 0.5523 - 52s/epoch - 31ms/step
Epoch 21/50
1664/1664 - 52s - loss: 2.5359 - accuracy30: 0.5981 - val_loss: 3.0557 - val_accuracy30: 0.5504 - 52s/epoch - 31ms/step
Epoch 22/50
1664/1664 - 50s - loss: 2.5323 - accuracy30: 0.5988 - val_loss: 3.0293 - val_accuracy30: 0.5498 - 50s/epoch - 30ms/step
Epoch 23/50
1664/1664 - 51s - loss: 2.5296 - accuracy30: 0.5994 - val_loss: 3.0283 - val_accuracy30: 0.5526 - 51s/epoch - 31ms/step
Epoch 24/50
1664/1664 - 51s - loss: 2.5262 - accuracy30: 0.6001 - val_loss: 3.0416 - val_accuracy30: 0.5510 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h30
Evaluating performance on  test set...
7459/7459 - 122s - 122s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0396657
{'0': {'precision': 0.5194472876151485, 'recall': 0.3995088997509914, 'f1-score': 0.4516511607556781, 'support': 607208}, '1': {'precision': 0.504741573772255, 'recall': 0.5080086544287792, 'f1-score': 0.5063698443826149, 'support': 665093}, '2': {'precision': 0.4717544352245658, 'recall': 0.5724059973310307, 'f1-score': 0.5172290762428918, 'support': 636950}, 'accuracy': 0.49498573000616475, 'macro avg': {'precision': 0.4986477655373231, 'recall': 0.49330785050360043, 'f1-score': 0.4917500271270616, 'support': 1909251}, 'weighted avg': {'precision': 0.4984135787591138, 'recall': 0.49498573000616475, 'f1-score': 0.4925901817220523, 'support': 1909251}}
[[242585 174806 189817]
 [108784 337873 218436]
 [115637 156719 364594]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.884257
{'0': {'precision': 0.5449146523645091, 'recall': 0.42924387256084034, 'f1-score': 0.4802119359659866, 'support': 103673}, '1': {'precision': 0.6945901429242753, 'recall': 0.6706017680459381, 'f1-score': 0.6823852004532759, 'support': 218207}, '2': {'precision': 0.4589675661922081, 'recall': 0.5892412785949674, 'f1-score': 0.5160090699132132, 'support': 104083}, 'accuracy': 0.5919786460326366, 'macro avg': {'precision': 0.5661574538269974, 'recall': 0.5630289730672486, 'f1-score': 0.5595354021108252, 'support': 425963}, 'weighted avg': {'precision': 0.6005875845170746, 'recall': 0.5919786460326366, 'f1-score': 0.5925256688878768, 'support': 425963}}
[[ 44501  35775  23397]
 [ 22978 146330  48899]
 [ 14187  28566  61330]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9443136
{'0': {'precision': 0.5258833745240798, 'recall': 0.42270006174330893, 'f1-score': 0.46867977319065973, 'support': 37251}, '1': {'precision': 0.6334185247201903, 'recall': 0.6262656187372567, 'f1-score': 0.629821763437845, 'support': 57383}, '2': {'precision': 0.4760544187784347, 'recall': 0.5769538117308615, 'f1-score': 0.5216700184246336, 'support': 37542}, 'accuracy': 0.554888935964169, 'macro avg': {'precision': 0.5451187726742349, 'recall': 0.5419731640704757, 'f1-score': 0.5400571850177127, 'support': 132176}, 'weighted avg': {'precision': 0.5584158378086428, 'recall': 0.554888935964169, 'f1-score': 0.5536889322885903, 'support': 132176}}
[[15746 11399 10106]
 [ 7713 35937 13733]
 [ 6483  9399 21660]]
training model: results/WBA/W5/deepVOL_L2/h50
Epoch 1/50
1664/1664 - 57s - loss: 3.0138 - accuracy50: 0.4853 - val_loss: 3.1560 - val_accuracy50: 0.4840 - 57s/epoch - 34ms/step
Epoch 2/50
1664/1664 - 53s - loss: 2.8708 - accuracy50: 0.5260 - val_loss: 3.0906 - val_accuracy50: 0.4877 - 53s/epoch - 32ms/step
Epoch 3/50
1664/1664 - 52s - loss: 2.8376 - accuracy50: 0.5343 - val_loss: 3.0482 - val_accuracy50: 0.4942 - 52s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 51s - loss: 2.8135 - accuracy50: 0.5402 - val_loss: 3.0540 - val_accuracy50: 0.4976 - 51s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 52s - loss: 2.7972 - accuracy50: 0.5441 - val_loss: 3.0410 - val_accuracy50: 0.5014 - 52s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 52s - loss: 2.7865 - accuracy50: 0.5472 - val_loss: 3.0435 - val_accuracy50: 0.5057 - 52s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 52s - loss: 2.7774 - accuracy50: 0.5488 - val_loss: 3.0441 - val_accuracy50: 0.5059 - 52s/epoch - 32ms/step
Epoch 8/50
1664/1664 - 52s - loss: 2.7691 - accuracy50: 0.5512 - val_loss: 3.0223 - val_accuracy50: 0.5100 - 52s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 2.7628 - accuracy50: 0.5524 - val_loss: 3.0344 - val_accuracy50: 0.5089 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 52s - loss: 2.7564 - accuracy50: 0.5532 - val_loss: 3.0176 - val_accuracy50: 0.5127 - 52s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 52s - loss: 2.7510 - accuracy50: 0.5549 - val_loss: 3.0225 - val_accuracy50: 0.5135 - 52s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 52s - loss: 2.7452 - accuracy50: 0.5557 - val_loss: 3.0082 - val_accuracy50: 0.5131 - 52s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 52s - loss: 2.7410 - accuracy50: 0.5569 - val_loss: 3.0014 - val_accuracy50: 0.5147 - 52s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 52s - loss: 2.7357 - accuracy50: 0.5577 - val_loss: 3.0034 - val_accuracy50: 0.5156 - 52s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 53s - loss: 2.7298 - accuracy50: 0.5592 - val_loss: 3.0055 - val_accuracy50: 0.5158 - 53s/epoch - 32ms/step
Epoch 16/50
1664/1664 - 53s - loss: 2.7268 - accuracy50: 0.5603 - val_loss: 3.0113 - val_accuracy50: 0.5150 - 53s/epoch - 32ms/step
Epoch 17/50
1664/1664 - 53s - loss: 2.7226 - accuracy50: 0.5607 - val_loss: 3.0104 - val_accuracy50: 0.5126 - 53s/epoch - 32ms/step
Epoch 18/50
1664/1664 - 51s - loss: 2.7182 - accuracy50: 0.5618 - val_loss: 3.0156 - val_accuracy50: 0.5140 - 51s/epoch - 30ms/step
Epoch 19/50
1664/1664 - 51s - loss: 2.7139 - accuracy50: 0.5622 - val_loss: 3.0230 - val_accuracy50: 0.5127 - 51s/epoch - 31ms/step
Epoch 20/50
1664/1664 - 51s - loss: 2.7103 - accuracy50: 0.5629 - val_loss: 3.0240 - val_accuracy50: 0.5126 - 51s/epoch - 31ms/step
Epoch 21/50
1664/1664 - 52s - loss: 2.7070 - accuracy50: 0.5639 - val_loss: 3.0195 - val_accuracy50: 0.5146 - 52s/epoch - 31ms/step
Epoch 22/50
1664/1664 - 52s - loss: 2.7025 - accuracy50: 0.5646 - val_loss: 3.0159 - val_accuracy50: 0.5152 - 52s/epoch - 31ms/step
Epoch 23/50
1664/1664 - 51s - loss: 2.6997 - accuracy50: 0.5646 - val_loss: 3.0185 - val_accuracy50: 0.5152 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h50
Evaluating performance on  test set...
7459/7459 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0435739
{'0': {'precision': 0.502416460369536, 'recall': 0.4189244012467895, 'f1-score': 0.45688739880178514, 'support': 700038}, '1': {'precision': 0.3885250904312907, 'recall': 0.41776845167681714, 'f1-score': 0.4026164591190851, 'support': 478466}, '2': {'precision': 0.4862594582198511, 'recall': 0.5397066289700813, 'f1-score': 0.5115908922866182, 'support': 730747}, 'accuracy': 0.46486292268538815, 'macro avg': {'precision': 0.4590670030068926, 'recall': 0.4587998272978959, 'f1-score': 0.4570315834024961, 'support': 1909251}, 'weighted avg': {'precision': 0.4676908904686963, 'recall': 0.46486292268538815, 'f1-score': 0.46422410535704617, 'support': 1909251}}
[[293263 163991 242784]
 [104684 199888 173894]
 [185758 150600 394389]]
Evaluating performance on  train set...
1664/1664 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9430959
{'0': {'precision': 0.5416960042246084, 'recall': 0.39427303956503285, 'f1-score': 0.4563743459743534, 'support': 124883}, '1': {'precision': 0.5925756947324762, 'recall': 0.6486646008558359, 'f1-score': 0.6193528809316087, 'support': 176202}, '2': {'precision': 0.4791858608733569, 'recall': 0.5456045100017617, 'f1-score': 0.5102428247804841, 'support': 124878}, 'accuracy': 0.5438688336780425, 'macro avg': {'precision': 0.5378191866101472, 'recall': 0.5295140501408768, 'f1-score': 0.5286566838954821, 'support': 425963}, 'weighted avg': {'precision': 0.5444168075466099, 'recall': 0.5438688336780425, 'f1-score': 0.5395837602025616, 'support': 425963}}
[[ 49238  43503  32142]
 [ 19995 114296  41911]
 [ 21663  35081  68134]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97648835
{'0': {'precision': 0.5234712692319318, 'recall': 0.398683180625259, 'f1-score': 0.452633917486703, 'support': 43438}, '1': {'precision': 0.5378744096135833, 'recall': 0.603020689038831, 'f1-score': 0.568587589664725, 'support': 44758}, '2': {'precision': 0.4895530931839555, 'recall': 0.544474761255116, 'f1-score': 0.5155553641785261, 'support': 43980}, 'accuracy': 0.5163872412540854, 'macro avg': {'precision': 0.5169662573431569, 'recall': 0.5153928769730687, 'f1-score': 0.5122589571099847, 'support': 132176}, 'weighted avg': {'precision': 0.5170626502285725, 'recall': 0.5163872412540854, 'f1-score': 0.5128350106114025, 'support': 132176}}
[[17318 12720 13400]
 [ 6200 26990 11568]
 [ 9565 10469 23946]]
training model: results/WBA/W5/deepVOL_L2/h100
Epoch 1/50
1664/1664 - 53s - loss: 3.1888 - accuracy100: 0.4250 - val_loss: 3.2140 - val_accuracy100: 0.4170 - 53s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 50s - loss: 3.0898 - accuracy100: 0.4587 - val_loss: 3.1603 - val_accuracy100: 0.4316 - 50s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 50s - loss: 3.0610 - accuracy100: 0.4674 - val_loss: 3.1701 - val_accuracy100: 0.4332 - 50s/epoch - 30ms/step
Epoch 4/50
1664/1664 - 52s - loss: 3.0445 - accuracy100: 0.4721 - val_loss: 3.1716 - val_accuracy100: 0.4336 - 52s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 51s - loss: 3.0351 - accuracy100: 0.4755 - val_loss: 3.1693 - val_accuracy100: 0.4326 - 51s/epoch - 30ms/step
Epoch 6/50
1664/1664 - 50s - loss: 3.0267 - accuracy100: 0.4772 - val_loss: 3.1786 - val_accuracy100: 0.4323 - 50s/epoch - 30ms/step
Epoch 7/50
1664/1664 - 50s - loss: 3.0199 - accuracy100: 0.4794 - val_loss: 3.1910 - val_accuracy100: 0.4320 - 50s/epoch - 30ms/step
Epoch 8/50
1664/1664 - 51s - loss: 3.0141 - accuracy100: 0.4818 - val_loss: 3.1883 - val_accuracy100: 0.4359 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 3.0100 - accuracy100: 0.4832 - val_loss: 3.1795 - val_accuracy100: 0.4368 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 3.0036 - accuracy100: 0.4848 - val_loss: 3.1859 - val_accuracy100: 0.4357 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 51s - loss: 2.9999 - accuracy100: 0.4864 - val_loss: 3.1693 - val_accuracy100: 0.4364 - 51s/epoch - 31ms/step
Epoch 12/50
1664/1664 - 51s - loss: 2.9963 - accuracy100: 0.4874 - val_loss: 3.1966 - val_accuracy100: 0.4322 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h100
Evaluating performance on  test set...
7459/7459 - 120s - 120s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0779381
{'0': {'precision': 0.4612557271830959, 'recall': 0.25770655678387616, 'f1-score': 0.33066720716787756, 'support': 740668}, '1': {'precision': 0.28450871262171834, 'recall': 0.36438494655690706, 'f1-score': 0.31953060590811266, 'support': 409501}, '2': {'precision': 0.4454296030962979, 'recall': 0.5697632139874217, 'f1-score': 0.4999826594406629, 'support': 759082}, 'accuracy': 0.4046550191672022, 'macro avg': {'precision': 0.39706468096703734, 'recall': 0.39728490577606834, 'f1-score': 0.38339349083888435, 'support': 1909251}, 'weighted avg': {'precision': 0.41705441204226135, 'recall': 0.4046550191672022, 'f1-score': 0.3955952144281359, 'support': 1909251}}
[[190875 195861 353932]
 [ 75748 149216 184537]
 [147193 179392 432497]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0455308
{'0': {'precision': 0.4918425885173999, 'recall': 0.22565416591235082, 'f1-score': 0.3093709578108816, 'support': 143618}, '1': {'precision': 0.43096015477030725, 'recall': 0.6049193531143311, 'f1-score': 0.5033329379670264, 'support': 140303}, '2': {'precision': 0.4407331351334784, 'recall': 0.5061812703284944, 'f1-score': 0.4711954046340321, 'support': 142042}, 'accuracy': 0.444120733490937, 'macro avg': {'precision': 0.4545119594737285, 'recall': 0.44558492978505876, 'f1-score': 0.4279664334706467, 'support': 425963}, 'weighted avg': {'precision': 0.45474622784856883, 'recall': 0.444120733490937, 'f1-score': 0.42721996295335063, 'support': 425963}}
[[32408 61600 49610]
 [13805 84872 41626]
 [19678 50465 71899]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.054845
{'0': {'precision': 0.46987653301399845, 'recall': 0.23911992771134974, 'f1-score': 0.3169461311347557, 'support': 47587}, '1': {'precision': 0.39166082823654164, 'recall': 0.5713654318941466, 'f1-score': 0.4647463263380218, 'support': 36201}, '2': {'precision': 0.4520925509537971, 'recall': 0.5152517153013144, 'f1-score': 0.48161026116519856, 'support': 48388}, 'accuracy': 0.43120536254690717, 'macro avg': {'precision': 0.4378766374014457, 'recall': 0.4419123583022702, 'f1-score': 0.4211009062126587, 'support': 132176}, 'weighted avg': {'precision': 0.44194394273605286, 'recall': 0.43120536254690717, 'f1-score': 0.41770786390368886, 'support': 132176}}
[[11379 17130 19078]
 [ 4379 20684 11138]
 [ 8459 14997 24932]]
training model: results/WBA/W5/deepVOL_L2/h200
Epoch 1/50
1664/1664 - 56s - loss: 3.2800 - accuracy200: 0.3785 - val_loss: 3.3602 - val_accuracy200: 0.3628 - 56s/epoch - 34ms/step
Epoch 2/50
1664/1664 - 53s - loss: 3.2423 - accuracy200: 0.3972 - val_loss: 3.3533 - val_accuracy200: 0.3578 - 53s/epoch - 32ms/step
Epoch 3/50
1664/1664 - 52s - loss: 3.2292 - accuracy200: 0.4056 - val_loss: 3.3748 - val_accuracy200: 0.3581 - 52s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 53s - loss: 3.2179 - accuracy200: 0.4102 - val_loss: 3.3962 - val_accuracy200: 0.3571 - 53s/epoch - 32ms/step
Epoch 5/50
1664/1664 - 53s - loss: 3.2091 - accuracy200: 0.4132 - val_loss: 3.3902 - val_accuracy200: 0.3595 - 53s/epoch - 32ms/step
Epoch 6/50
1664/1664 - 52s - loss: 3.2025 - accuracy200: 0.4164 - val_loss: 3.3996 - val_accuracy200: 0.3560 - 52s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 51s - loss: 3.1967 - accuracy200: 0.4197 - val_loss: 3.4084 - val_accuracy200: 0.3536 - 51s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 51s - loss: 3.1921 - accuracy200: 0.4222 - val_loss: 3.3964 - val_accuracy200: 0.3584 - 51s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 51s - loss: 3.1878 - accuracy200: 0.4245 - val_loss: 3.3821 - val_accuracy200: 0.3622 - 51s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 51s - loss: 3.1828 - accuracy200: 0.4274 - val_loss: 3.3825 - val_accuracy200: 0.3637 - 51s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 54s - loss: 3.1786 - accuracy200: 0.4286 - val_loss: 3.3834 - val_accuracy200: 0.3649 - 54s/epoch - 32ms/step
Epoch 12/50
1664/1664 - 52s - loss: 3.1749 - accuracy200: 0.4308 - val_loss: 3.3753 - val_accuracy200: 0.3656 - 52s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h200
Evaluating performance on  test set...
7459/7459 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1435384
{'0': {'precision': 0.46308815121245755, 'recall': 0.036629520163660986, 'f1-score': 0.06788912117387189, 'support': 751798}, '1': {'precision': 0.2087780216889896, 'recall': 0.4152884922541358, 'f1-score': 0.27786496440962216, 'support': 397567}, '2': {'precision': 0.4227394758486792, 'recall': 0.5891252108868962, 'f1-score': 0.4922525434957707, 'support': 759886}, 'accuracy': 0.33537287658877746, 'macro avg': {'precision': 0.36486854958337545, 'recall': 0.34701440776823095, 'f1-score': 0.27933554302642155, 'support': 1909251}, 'weighted avg': {'precision': 0.39407380538169107, 'recall': 0.33537287658877746, 'f1-score': 0.28051034782359263, 'support': 1909251}}
[[ 27538 331104 393156]
 [ 14317 165105 218145]
 [ 17611 294607 447668]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050549
{'0': {'precision': 0.4494475138121547, 'recall': 0.08096253643278595, 'f1-score': 0.1372086018914523, 'support': 140670}, '1': {'precision': 0.36089323467230444, 'recall': 0.46385288443248823, 'f1-score': 0.4059464215645474, 'support': 147204}, '2': {'precision': 0.37162938753115793, 'recall': 0.568988116359739, 'f1-score': 0.4496040193183639, 'support': 138089}, 'accuracy': 0.3714900120432995, 'macro avg': {'precision': 0.39399004533853904, 'recall': 0.3712678457416711, 'f1-score': 0.33091968092478785, 'support': 425963}, 'weighted avg': {'precision': 0.3936178493893783, 'recall': 0.3714900120432995, 'f1-score': 0.33135140961001724, 'support': 425963}}
[[11389 67142 62139]
 [ 8210 68281 70713]
 [ 5741 53777 78571]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152585
{'0': {'precision': 0.42172224454265433, 'recall': 0.07010708640381147, 'f1-score': 0.1202275503970678, 'support': 44917}, '1': {'precision': 0.32633795281569816, 'recall': 0.45206560198909823, 'f1-score': 0.3790480199657215, 'support': 41828}, '2': {'precision': 0.3761645148728395, 'recall': 0.5528163588738967, 'f1-score': 0.4476946798934018, 'support': 45431}, 'accuracy': 0.3568953516523423, 'macro avg': {'precision': 0.37474157074373066, 'recall': 0.3583296824222688, 'f1-score': 0.315656750085397, 'support': 132176}, 'weighted avg': {'precision': 0.3758783139426628, 'recall': 0.3568953516523423, 'f1-score': 0.3146887367037013, 'support': 132176}}
[[ 3149 20526 21242]
 [ 2510 18909 20409]
 [ 1808 18508 25115]]
training model: results/WBA/W5/deepVOL_L2/h300
Epoch 1/50
1664/1664 - 54s - loss: 3.2945 - accuracy300: 0.3671 - val_loss: 3.3429 - val_accuracy300: 0.3509 - 54s/epoch - 32ms/step
Epoch 2/50
1664/1664 - 52s - loss: 3.2671 - accuracy300: 0.3821 - val_loss: 3.3645 - val_accuracy300: 0.3482 - 52s/epoch - 31ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.2595 - accuracy300: 0.3881 - val_loss: 3.3657 - val_accuracy300: 0.3438 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 51s - loss: 3.2521 - accuracy300: 0.3938 - val_loss: 3.3828 - val_accuracy300: 0.3377 - 51s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 51s - loss: 3.2472 - accuracy300: 0.3962 - val_loss: 3.3602 - val_accuracy300: 0.3471 - 51s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 51s - loss: 3.2421 - accuracy300: 0.3990 - val_loss: 3.3769 - val_accuracy300: 0.3434 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 52s - loss: 3.2377 - accuracy300: 0.4009 - val_loss: 3.3809 - val_accuracy300: 0.3457 - 52s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 52s - loss: 3.2345 - accuracy300: 0.4031 - val_loss: 3.3852 - val_accuracy300: 0.3457 - 52s/epoch - 31ms/step
Epoch 9/50
1664/1664 - 52s - loss: 3.2303 - accuracy300: 0.4052 - val_loss: 3.3984 - val_accuracy300: 0.3461 - 52s/epoch - 31ms/step
Epoch 10/50
1664/1664 - 51s - loss: 3.2280 - accuracy300: 0.4059 - val_loss: 3.3862 - val_accuracy300: 0.3489 - 51s/epoch - 30ms/step
Epoch 11/50
1664/1664 - 51s - loss: 3.2246 - accuracy300: 0.4075 - val_loss: 3.4242 - val_accuracy300: 0.3476 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h300
Evaluating performance on  test set...
7459/7459 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1172358
{'0': {'precision': 0.4364889441945056, 'recall': 0.0067968907206045655, 'f1-score': 0.013385348327271767, 'support': 670895}, '1': {'precision': 0.31260611699034774, 'recall': 0.0480558485438976, 'f1-score': 0.08330544192388745, 'support': 559370}, '2': {'precision': 0.3591587443609769, 'recall': 0.9589122603411557, 'f1-score': 0.5225844770848382, 'support': 678986}, 'accuracy': 0.3574852127876324, 'macro avg': {'precision': 0.3694179351819434, 'recall': 0.3379216665352193, 'f1-score': 0.20642508911199917, 'support': 1909251}, 'weighted avg': {'precision': 0.37269300530676475, 'recall': 0.3574852127876324, 'f1-score': 0.214956688289238, 'support': 1909251}}
[[  4560  33978 632357]
 [  3120  26881 529369]
 [  2767  25131 651088]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1170189
{'0': {'precision': 0.43928001822738666, 'recall': 0.013292976371872394, 'f1-score': 0.02580507000026769, 'support': 145039}, '1': {'precision': 0.3432749954581239, 'recall': 0.08177411676452344, 'f1-score': 0.13208360518221643, 'support': 138638}, '2': {'precision': 0.33974180796195064, 'recall': 0.9277511490940781, 'f1-score': 0.49735322153441563, 'support': 142286}, 'accuracy': 0.3410413580522252, 'macro avg': {'precision': 0.3740989405491537, 'recall': 0.34093941407682465, 'f1-score': 0.21841396557229995, 'support': 425963}, 'weighted avg': {'precision': 0.37478418611869907, 'recall': 0.3410413580522252, 'f1-score': 0.21790847769000313, 'support': 425963}}
[[  1928  12534 130577]
 [  1336  11337 125965]
 [  1125   9155 132006]]
Evaluating performance on  val set...
517/517 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162194
{'0': {'precision': 0.38808250572956454, 'recall': 0.011169253770722483, 'f1-score': 0.02171357739736274, 'support': 45482}, '1': {'precision': 0.34265299782541164, 'recall': 0.08056191264546915, 'f1-score': 0.1304527803512645, 'support': 41074}, '2': {'precision': 0.3504908835904628, 'recall': 0.9312362998684788, 'f1-score': 0.5092968890487322, 'support': 45620}, 'accuracy': 0.3502905217286043, 'macro avg': {'precision': 0.36040879571514634, 'recall': 0.34098915542822344, 'f1-score': 0.22048774893245313, 'support': 132176}, 'weighted avg': {'precision': 0.36099058730533473, 'recall': 0.3502905217286043, 'f1-score': 0.22379190250679284, 'support': 132176}}
[[  508  3602 41372]
 [  410  3309 37355]
 [  391  2746 42483]]
training model: results/WBA/W5/deepVOL_L2/h500
Epoch 1/50
1664/1664 - 56s - loss: 3.2352 - accuracy500: 0.4040 - val_loss: 3.3142 - val_accuracy500: 0.3594 - 56s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 51s - loss: 3.2310 - accuracy500: 0.3981 - val_loss: 3.3090 - val_accuracy500: 0.3572 - 51s/epoch - 31ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.2285 - accuracy500: 0.4008 - val_loss: 3.3367 - val_accuracy500: 0.3438 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 52s - loss: 3.2259 - accuracy500: 0.4018 - val_loss: 3.3117 - val_accuracy500: 0.3534 - 52s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 51s - loss: 3.2237 - accuracy500: 0.4032 - val_loss: 3.3280 - val_accuracy500: 0.3565 - 51s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 52s - loss: 3.2225 - accuracy500: 0.4040 - val_loss: 3.3120 - val_accuracy500: 0.3596 - 52s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 53s - loss: 3.2199 - accuracy500: 0.4048 - val_loss: 3.3133 - val_accuracy500: 0.3640 - 53s/epoch - 32ms/step
Epoch 8/50
1664/1664 - 54s - loss: 3.2148 - accuracy500: 0.4067 - val_loss: 3.3162 - val_accuracy500: 0.3624 - 54s/epoch - 33ms/step
Epoch 9/50
1664/1664 - 54s - loss: 3.2113 - accuracy500: 0.4096 - val_loss: 3.3249 - val_accuracy500: 0.3553 - 54s/epoch - 32ms/step
Epoch 10/50
1664/1664 - 53s - loss: 3.2105 - accuracy500: 0.4120 - val_loss: 3.3201 - val_accuracy500: 0.3641 - 53s/epoch - 32ms/step
Epoch 11/50
1664/1664 - 54s - loss: 3.2104 - accuracy500: 0.4118 - val_loss: 3.3333 - val_accuracy500: 0.3611 - 54s/epoch - 32ms/step
Epoch 12/50
1664/1664 - 51s - loss: 3.2073 - accuracy500: 0.4137 - val_loss: 3.3291 - val_accuracy500: 0.3625 - 51s/epoch - 31ms/step
testing model: results/WBA/W5/deepVOL_L2/h500
Evaluating performance on  test set...
7459/7459 - 115s - 115s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895439
{'0': {'precision': 0.40015647782638075, 'recall': 0.015630426266672964, 'f1-score': 0.030085682161826853, 'support': 719878}, '1': {'precision': 0.21888216375009498, 'recall': 0.018822519948430257, 'f1-score': 0.034664137276881946, 'support': 459184}, '2': {'precision': 0.38304287742751725, 'recall': 0.9660909709677905, 'f1-score': 0.548580507140041, 'support': 730189}, 'accuracy': 0.3798997617390275, 'macro avg': {'precision': 0.33402717300133095, 'recall': 0.3335146390609646, 'f1-score': 0.20444344219291663, 'support': 1909251}, 'weighted avg': {'precision': 0.3500140777980707, 'recall': 0.3798997617390275, 'f1-score': 0.22948406984870967, 'support': 1909251}}
[[ 11252  16191 692435]
 [  6760   8643 443781]
 [ 10107  14653 705429]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11695
{'0': {'precision': 0.3809746954076851, 'recall': 0.011252205806027473, 'f1-score': 0.02185880502510536, 'support': 144505}, '1': {'precision': 0.28078755956859797, 'recall': 0.01608465456426319, 'f1-score': 0.03042636317309326, 'support': 139201}, '2': {'precision': 0.33339617761728313, 'recall': 0.9696043076966335, 'f1-score': 0.4961815035846742, 'support': 142257}, 'accuracy': 0.33288806774297297, 'macro avg': {'precision': 0.33171947753118874, 'recall': 0.33231372268897474, 'f1-score': 0.18282222392762426, 'support': 425963}, 'weighted avg': {'precision': 0.3323448221528578, 'recall': 0.33288806774297297, 'f1-score': 0.18306608544792763, 'support': 425963}}
[[  1626   2871 140008]
 [  1182   2239 135780]
 [  1460   2864 137933]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036054
{'0': {'precision': 0.3774390243902439, 'recall': 0.012943021432305279, 'f1-score': 0.02502779743252805, 'support': 47825}, '1': {'precision': 0.22667217175887697, 'recall': 0.01490268465484948, 'f1-score': 0.027966684496064795, 'support': 36839}, '2': {'precision': 0.3591176608333203, 'recall': 0.9683448391985182, 'f1-score': 0.5239315363328891, 'support': 47512}, 'accuracy': 0.3569180486623895, 'macro avg': {'precision': 0.32107628566081375, 'recall': 0.3320635150952243, 'f1-score': 0.19230867275382732, 'support': 132176}, 'weighted avg': {'precision': 0.32883273649075023, 'recall': 0.3569180486623895, 'f1-score': 0.20518289444838256, 'support': 132176}}
[[  619  1004 46202]
 [  386   549 35904]
 [  635   869 46008]]
training model: results/WBA/W5/deepVOL_L2/h1000
Epoch 1/50
1664/1664 - 55s - loss: 3.2538 - accuracy1000: 0.3983 - val_loss: 3.3496 - val_accuracy1000: 0.3482 - 55s/epoch - 33ms/step
Epoch 2/50
1664/1664 - 51s - loss: 3.2455 - accuracy1000: 0.3987 - val_loss: 3.3038 - val_accuracy1000: 0.3573 - 51s/epoch - 30ms/step
Epoch 3/50
1664/1664 - 51s - loss: 3.2419 - accuracy1000: 0.4000 - val_loss: 3.3081 - val_accuracy1000: 0.3413 - 51s/epoch - 31ms/step
Epoch 4/50
1664/1664 - 51s - loss: 3.2394 - accuracy1000: 0.4005 - val_loss: 3.2966 - val_accuracy1000: 0.3525 - 51s/epoch - 31ms/step
Epoch 5/50
1664/1664 - 52s - loss: 3.2311 - accuracy1000: 0.4062 - val_loss: 3.2891 - val_accuracy1000: 0.3597 - 52s/epoch - 31ms/step
Epoch 6/50
1664/1664 - 51s - loss: 3.2278 - accuracy1000: 0.4065 - val_loss: 3.2964 - val_accuracy1000: 0.3556 - 51s/epoch - 31ms/step
Epoch 7/50
1664/1664 - 51s - loss: 3.2241 - accuracy1000: 0.4086 - val_loss: 3.3121 - val_accuracy1000: 0.3529 - 51s/epoch - 31ms/step
Epoch 8/50
1664/1664 - 50s - loss: 3.2164 - accuracy1000: 0.4123 - val_loss: 3.3148 - val_accuracy1000: 0.3560 - 50s/epoch - 30ms/step
Epoch 9/50
1664/1664 - 50s - loss: 3.2145 - accuracy1000: 0.4127 - val_loss: 3.3179 - val_accuracy1000: 0.3550 - 50s/epoch - 30ms/step
Epoch 10/50
1664/1664 - 52s - loss: 3.2074 - accuracy1000: 0.4171 - val_loss: 3.3248 - val_accuracy1000: 0.3528 - 52s/epoch - 31ms/step
Epoch 11/50
1664/1664 - 53s - loss: 3.2039 - accuracy1000: 0.4191 - val_loss: 3.3258 - val_accuracy1000: 0.3582 - 53s/epoch - 32ms/step
Epoch 12/50
1664/1664 - 52s - loss: 3.2013 - accuracy1000: 0.4202 - val_loss: 3.3221 - val_accuracy1000: 0.3538 - 52s/epoch - 31ms/step
Epoch 13/50
1664/1664 - 52s - loss: 3.1956 - accuracy1000: 0.4220 - val_loss: 3.3134 - val_accuracy1000: 0.3673 - 52s/epoch - 31ms/step
Epoch 14/50
1664/1664 - 52s - loss: 3.1880 - accuracy1000: 0.4264 - val_loss: 3.3290 - val_accuracy1000: 0.3650 - 52s/epoch - 31ms/step
Epoch 15/50
1664/1664 - 51s - loss: 3.1833 - accuracy1000: 0.4293 - val_loss: 3.3427 - val_accuracy1000: 0.3580 - 51s/epoch - 30ms/step
testing model: results/WBA/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
7459/7459 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0862054
{'0': {'precision': 0.44374917041166545, 'recall': 0.08985999933442726, 'f1-score': 0.14945507843060032, 'support': 781282}, '1': {'precision': 0.16664941785252263, 'recall': 0.038806230927499644, 'f1-score': 0.06295310770493846, 'support': 331957}, '2': {'precision': 0.4182913714196948, 'recall': 0.8795231730174922, 'f1-score': 0.5669484223517178, 'support': 796012}, 'accuracy': 0.4102126959734472, 'macro avg': {'precision': 0.3428966532279609, 'recall': 0.336063134426473, 'f1-score': 0.2597855361624189, 'support': 1909251}, 'weighted avg': {'precision': 0.3849565255203065, 'recall': 0.4102126959734472, 'f1-score': 0.3084780549722693, 'support': 1909251}}
[[ 70206  30428 680648]
 [ 26094  12882 292981]
 [ 61911  33990 700111]]
Evaluating performance on  train set...
1664/1664 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976965
{'0': {'precision': 0.41023729110925916, 'recall': 0.06566918961425583, 'f1-score': 0.113215312452716, 'support': 142426}, '1': {'precision': 0.43354885057471265, 'recall': 0.18719378511557738, 'f1-score': 0.2614856647677756, 'support': 141853}, '2': {'precision': 0.33712958738403587, 'recall': 0.8135710454250303, 'f1-score': 0.47671629445823005, 'support': 141684}, 'accuracy': 0.3549064120592634, 'macro avg': {'precision': 0.3936385763560026, 'recall': 0.3554780067182879, 'f1-score': 0.2838057572262405, 'support': 425963}, 'weighted avg': {'precision': 0.3936833245681474, 'recall': 0.3549064120592634, 'f1-score': 0.28349974424941526, 'support': 425963}}
[[  9353  16632 116441]
 [  5094  26554 110205]
 [  8352  18062 115270]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964913
{'0': {'precision': 0.42032310486569163, 'recall': 0.09614922044127616, 'f1-score': 0.15649914578587698, 'support': 45731}, '1': {'precision': 0.39357947604180804, 'recall': 0.14331965795066975, 'f1-score': 0.21012392202333502, 'support': 40462}, '2': {'precision': 0.34980977930660584, 'recall': 0.813844246786856, 'f1-score': 0.48930467299495306, 'support': 45983}, 'accuracy': 0.36026964047936083, 'macro avg': {'precision': 0.3879041200713685, 'recall': 0.3511043750596006, 'f1-score': 0.28530924693472165, 'support': 132176}, 'weighted avg': {'precision': 0.38760525171038795, 'recall': 0.36026964047936083, 'f1-score': 0.2886953255293628, 'support': 132176}}
[[ 4397  4265 37069]
 [ 2174  5799 32489]
 [ 3890  4670 37423]]
training model: results/WBA/W5/deepVOL_L3/h10
Epoch 1/50
1664/1664 - 76s - loss: 3.1051 - accuracy10: 0.4008 - val_loss: 3.5019 - val_accuracy10: 0.5373 - 76s/epoch - 46ms/step
Epoch 2/50
1664/1664 - 76s - loss: 2.6763 - accuracy10: 0.5247 - val_loss: 3.1744 - val_accuracy10: 0.5654 - 76s/epoch - 46ms/step
Epoch 3/50
1664/1664 - 72s - loss: 2.5242 - accuracy10: 0.5829 - val_loss: 3.0634 - val_accuracy10: 0.5927 - 72s/epoch - 43ms/step
Epoch 4/50
1664/1664 - 73s - loss: 2.4669 - accuracy10: 0.5951 - val_loss: 2.9959 - val_accuracy10: 0.5922 - 73s/epoch - 44ms/step
Epoch 5/50
1664/1664 - 73s - loss: 2.4356 - accuracy10: 0.6003 - val_loss: 2.9876 - val_accuracy10: 0.5942 - 73s/epoch - 44ms/step
Epoch 6/50
1664/1664 - 73s - loss: 2.4155 - accuracy10: 0.6043 - val_loss: 2.9707 - val_accuracy10: 0.5879 - 73s/epoch - 44ms/step
Epoch 7/50
1664/1664 - 72s - loss: 2.4009 - accuracy10: 0.6063 - val_loss: 2.9925 - val_accuracy10: 0.5975 - 72s/epoch - 43ms/step
Epoch 8/50
1664/1664 - 69s - loss: 2.3879 - accuracy10: 0.6085 - val_loss: 2.9634 - val_accuracy10: 0.5899 - 69s/epoch - 42ms/step
Epoch 9/50
1664/1664 - 71s - loss: 2.3766 - accuracy10: 0.6101 - val_loss: 2.9471 - val_accuracy10: 0.5913 - 71s/epoch - 42ms/step
Epoch 10/50
1664/1664 - 70s - loss: 2.3653 - accuracy10: 0.6125 - val_loss: 2.9468 - val_accuracy10: 0.5929 - 70s/epoch - 42ms/step
Epoch 11/50
1664/1664 - 70s - loss: 2.3556 - accuracy10: 0.6139 - val_loss: 2.9288 - val_accuracy10: 0.5995 - 70s/epoch - 42ms/step
Epoch 12/50
1664/1664 - 69s - loss: 2.3475 - accuracy10: 0.6150 - val_loss: 2.9274 - val_accuracy10: 0.5962 - 69s/epoch - 42ms/step
Epoch 13/50
1664/1664 - 70s - loss: 2.3396 - accuracy10: 0.6158 - val_loss: 2.9188 - val_accuracy10: 0.5897 - 70s/epoch - 42ms/step
Epoch 14/50
1664/1664 - 69s - loss: 2.3321 - accuracy10: 0.6173 - val_loss: 2.9067 - val_accuracy10: 0.5962 - 69s/epoch - 42ms/step
Epoch 15/50
1664/1664 - 69s - loss: 2.3259 - accuracy10: 0.6175 - val_loss: 2.8957 - val_accuracy10: 0.5955 - 69s/epoch - 41ms/step
Epoch 16/50
1664/1664 - 70s - loss: 2.3176 - accuracy10: 0.6184 - val_loss: 2.8895 - val_accuracy10: 0.5904 - 70s/epoch - 42ms/step
Epoch 17/50
1664/1664 - 70s - loss: 2.3145 - accuracy10: 0.6181 - val_loss: 2.9032 - val_accuracy10: 0.5959 - 70s/epoch - 42ms/step
Epoch 18/50
1664/1664 - 70s - loss: 2.3080 - accuracy10: 0.6191 - val_loss: 2.9107 - val_accuracy10: 0.5977 - 70s/epoch - 42ms/step
Epoch 19/50
1664/1664 - 71s - loss: 2.3020 - accuracy10: 0.6201 - val_loss: 2.9054 - val_accuracy10: 0.5899 - 71s/epoch - 42ms/step
Epoch 20/50
1664/1664 - 70s - loss: 2.3004 - accuracy10: 0.6191 - val_loss: 2.8984 - val_accuracy10: 0.5781 - 70s/epoch - 42ms/step
Epoch 21/50
1664/1664 - 71s - loss: 2.2932 - accuracy10: 0.6200 - val_loss: 2.9107 - val_accuracy10: 0.5885 - 71s/epoch - 43ms/step
Epoch 22/50
1664/1664 - 71s - loss: 2.2858 - accuracy10: 0.6208 - val_loss: 2.9020 - val_accuracy10: 0.5850 - 71s/epoch - 43ms/step
Epoch 23/50
1664/1664 - 74s - loss: 2.2822 - accuracy10: 0.6209 - val_loss: 2.8887 - val_accuracy10: 0.5870 - 74s/epoch - 44ms/step
Epoch 24/50
1664/1664 - 70s - loss: 2.2777 - accuracy10: 0.6224 - val_loss: 2.9134 - val_accuracy10: 0.5915 - 70s/epoch - 42ms/step
Epoch 25/50
1664/1664 - 70s - loss: 2.2736 - accuracy10: 0.6232 - val_loss: 2.9093 - val_accuracy10: 0.5835 - 70s/epoch - 42ms/step
Epoch 26/50
1664/1664 - 73s - loss: 2.2699 - accuracy10: 0.6231 - val_loss: 2.9168 - val_accuracy10: 0.5863 - 73s/epoch - 44ms/step
Epoch 27/50
1664/1664 - 69s - loss: 2.2654 - accuracy10: 0.6235 - val_loss: 2.9232 - val_accuracy10: 0.5692 - 69s/epoch - 41ms/step
Epoch 28/50
1664/1664 - 69s - loss: 2.2616 - accuracy10: 0.6237 - val_loss: 2.9193 - val_accuracy10: 0.5842 - 69s/epoch - 42ms/step
Epoch 29/50
1664/1664 - 69s - loss: 2.2572 - accuracy10: 0.6245 - val_loss: 2.9173 - val_accuracy10: 0.5903 - 69s/epoch - 42ms/step
Epoch 30/50
1664/1664 - 70s - loss: 2.2545 - accuracy10: 0.6241 - val_loss: 2.9163 - val_accuracy10: 0.5900 - 70s/epoch - 42ms/step
Epoch 31/50
1664/1664 - 70s - loss: 2.2495 - accuracy10: 0.6246 - val_loss: 2.9711 - val_accuracy10: 0.5813 - 70s/epoch - 42ms/step
Epoch 32/50
1664/1664 - 70s - loss: 2.2472 - accuracy10: 0.6250 - val_loss: 2.8949 - val_accuracy10: 0.5847 - 70s/epoch - 42ms/step
Epoch 33/50
1664/1664 - 74s - loss: 2.2423 - accuracy10: 0.6252 - val_loss: 2.9142 - val_accuracy10: 0.5845 - 74s/epoch - 44ms/step
testing model: results/WBA/W5/deepVOL_L3/h10
Evaluating performance on  test set...
7459/7459 - 158s - 158s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0189201
{'0': {'precision': 0.4117161553326288, 'recall': 0.551507576941103, 'f1-score': 0.47146799151015306, 'support': 416065}, '1': {'precision': 0.7842910853845919, 'recall': 0.4130296641176254, 'f1-score': 0.5411005926382234, 'support': 1059091}, '2': {'precision': 0.3753108587445273, 'recall': 0.6866261993342471, 'f1-score': 0.48533623824155353, 'support': 434095}, 'accuracy': 0.5054128556172027, 'macro avg': {'precision': 0.5237726998205826, 'recall': 0.5503878134643251, 'f1-score': 0.49930160746331004, 'support': 1909251}, 'weighted avg': {'precision': 0.6101119650094349, 'recall': 0.5054128556172027, 'f1-score': 0.5132474106259196, 'support': 1909251}}
[[229463  66174 120428]
 [245973 437436 375682]
 [ 81897  54137 298061]]
Evaluating performance on  train set...
1664/1664 - 36s - 36s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78801477
{'0': {'precision': 0.43231476442457994, 'recall': 0.5596762104631989, 'f1-score': 0.4878195370836137, 'support': 66710}, '1': {'precision': 0.8773667115582666, 'recall': 0.6449828198707123, 'f1-score': 0.7434382761629859, 'support': 291907}, '2': {'precision': 0.3737970866097641, 'recall': 0.6938496718439106, 'f1-score': 0.4858516804866003, 'support': 67346}, 'accuracy': 0.6393489575385656, 'macro avg': {'precision': 0.5611595208642036, 'recall': 0.6328362340592739, 'f1-score': 0.5723698312444, 'support': 425963}, 'weighted avg': {'precision': 0.7280513593913647, 'recall': 0.6393489575385656, 'f1-score': 0.6626806682101665, 'support': 425963}}
[[ 37336  14719  14655]
 [ 40006 188275  63626]
 [  9021  11597  46728]]
Evaluating performance on  val set...
517/517 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8880176
{'0': {'precision': 0.4236952915656501, 'recall': 0.5291211855629033, 'f1-score': 0.47057573073516384, 'support': 25102}, '1': {'precision': 0.8437370740041363, 'recall': 0.5743737910433143, 'f1-score': 0.6834733077421752, 'support': 81682}, '2': {'precision': 0.38478207991508745, 'recall': 0.6852945809703844, 'f1-score': 0.49284146427812786, 'support': 25392}, 'accuracy': 0.5870884275511439, 'macro avg': {'precision': 0.550738148494958, 'recall': 0.5962631858588674, 'f1-score': 0.5489635009184889, 'support': 132176}, 'weighted avg': {'precision': 0.6757967971559943, 'recall': 0.5870884275511439, 'f1-score': 0.6064193891240517, 'support': 132176}}
[[13282  4869  6951]
 [13895 46916 20871]
 [ 4171  3820 17401]]
training model: results/WBA/W5/deepVOL_L3/h20
Epoch 1/50
1664/1664 - 75s - loss: 3.1057 - accuracy20: 0.4510 - val_loss: 3.2394 - val_accuracy20: 0.5225 - 75s/epoch - 45ms/step
Epoch 2/50
1664/1664 - 73s - loss: 2.7280 - accuracy20: 0.5472 - val_loss: 3.1137 - val_accuracy20: 0.5640 - 73s/epoch - 44ms/step
Epoch 3/50
1664/1664 - 71s - loss: 2.6197 - accuracy20: 0.5786 - val_loss: 3.0475 - val_accuracy20: 0.5673 - 71s/epoch - 43ms/step
Epoch 4/50
1664/1664 - 75s - loss: 2.5726 - accuracy20: 0.5907 - val_loss: 3.0837 - val_accuracy20: 0.5822 - 75s/epoch - 45ms/step
Epoch 5/50
1664/1664 - 76s - loss: 2.5429 - accuracy20: 0.5962 - val_loss: 3.0105 - val_accuracy20: 0.5830 - 76s/epoch - 46ms/step
Epoch 6/50
1664/1664 - 77s - loss: 2.5254 - accuracy20: 0.5991 - val_loss: 3.0012 - val_accuracy20: 0.5747 - 77s/epoch - 46ms/step
Epoch 7/50
1664/1664 - 76s - loss: 2.5108 - accuracy20: 0.6013 - val_loss: 2.9716 - val_accuracy20: 0.5911 - 76s/epoch - 45ms/step
Epoch 8/50
1664/1664 - 76s - loss: 2.4986 - accuracy20: 0.6041 - val_loss: 2.9510 - val_accuracy20: 0.5846 - 76s/epoch - 46ms/step
Epoch 9/50
1664/1664 - 76s - loss: 2.4891 - accuracy20: 0.6057 - val_loss: 2.9653 - val_accuracy20: 0.5921 - 76s/epoch - 46ms/step
Epoch 10/50
1664/1664 - 78s - loss: 2.4801 - accuracy20: 0.6077 - val_loss: 2.9766 - val_accuracy20: 0.5826 - 78s/epoch - 47ms/step
Epoch 11/50
1664/1664 - 77s - loss: 2.4737 - accuracy20: 0.6086 - val_loss: 2.9350 - val_accuracy20: 0.5887 - 77s/epoch - 47ms/step
Epoch 12/50
1664/1664 - 78s - loss: 2.4668 - accuracy20: 0.6094 - val_loss: 2.9315 - val_accuracy20: 0.5886 - 78s/epoch - 47ms/step
Epoch 13/50
1664/1664 - 77s - loss: 2.4617 - accuracy20: 0.6109 - val_loss: 2.9454 - val_accuracy20: 0.5779 - 77s/epoch - 46ms/step
Epoch 14/50
1664/1664 - 75s - loss: 2.4557 - accuracy20: 0.6120 - val_loss: 2.9288 - val_accuracy20: 0.5815 - 75s/epoch - 45ms/step
Epoch 15/50
1664/1664 - 75s - loss: 2.4495 - accuracy20: 0.6129 - val_loss: 2.9321 - val_accuracy20: 0.5774 - 75s/epoch - 45ms/step
Epoch 16/50
1664/1664 - 75s - loss: 2.4448 - accuracy20: 0.6135 - val_loss: 2.9189 - val_accuracy20: 0.5713 - 75s/epoch - 45ms/step
Epoch 17/50
1664/1664 - 75s - loss: 2.4394 - accuracy20: 0.6142 - val_loss: 2.9259 - val_accuracy20: 0.5809 - 75s/epoch - 45ms/step
Epoch 18/50
1664/1664 - 72s - loss: 2.4349 - accuracy20: 0.6144 - val_loss: 2.9342 - val_accuracy20: 0.5769 - 72s/epoch - 43ms/step
Epoch 19/50
1664/1664 - 75s - loss: 2.4308 - accuracy20: 0.6144 - val_loss: 2.9287 - val_accuracy20: 0.5791 - 75s/epoch - 45ms/step
Epoch 20/50
1664/1664 - 76s - loss: 2.4258 - accuracy20: 0.6156 - val_loss: 2.9134 - val_accuracy20: 0.5902 - 76s/epoch - 46ms/step
Epoch 21/50
1664/1664 - 74s - loss: 2.4219 - accuracy20: 0.6158 - val_loss: 2.9247 - val_accuracy20: 0.5844 - 74s/epoch - 45ms/step
Epoch 22/50
1664/1664 - 73s - loss: 2.4181 - accuracy20: 0.6162 - val_loss: 2.9331 - val_accuracy20: 0.5798 - 73s/epoch - 44ms/step
Epoch 23/50
1664/1664 - 73s - loss: 2.4127 - accuracy20: 0.6167 - val_loss: 2.9438 - val_accuracy20: 0.5795 - 73s/epoch - 44ms/step
Epoch 24/50
1664/1664 - 74s - loss: 2.4091 - accuracy20: 0.6174 - val_loss: 2.9375 - val_accuracy20: 0.5809 - 74s/epoch - 45ms/step
Epoch 25/50
1664/1664 - 74s - loss: 2.4063 - accuracy20: 0.6174 - val_loss: 2.9200 - val_accuracy20: 0.5823 - 74s/epoch - 45ms/step
Epoch 26/50
1664/1664 - 72s - loss: 2.4013 - accuracy20: 0.6181 - val_loss: 2.9346 - val_accuracy20: 0.5844 - 72s/epoch - 44ms/step
Epoch 27/50
1664/1664 - 72s - loss: 2.3980 - accuracy20: 0.6180 - val_loss: 2.9118 - val_accuracy20: 0.5756 - 72s/epoch - 43ms/step
Epoch 28/50
1664/1664 - 73s - loss: 2.3961 - accuracy20: 0.6184 - val_loss: 2.9140 - val_accuracy20: 0.5813 - 73s/epoch - 44ms/step
Epoch 29/50
1664/1664 - 70s - loss: 2.3917 - accuracy20: 0.6193 - val_loss: 2.9337 - val_accuracy20: 0.5780 - 70s/epoch - 42ms/step
Epoch 30/50
1664/1664 - 71s - loss: 2.3887 - accuracy20: 0.6191 - val_loss: 2.9207 - val_accuracy20: 0.5798 - 71s/epoch - 42ms/step
Epoch 31/50
1664/1664 - 70s - loss: 2.3849 - accuracy20: 0.6194 - val_loss: 2.9268 - val_accuracy20: 0.5869 - 70s/epoch - 42ms/step
Epoch 32/50
1664/1664 - 69s - loss: 2.3813 - accuracy20: 0.6205 - val_loss: 2.9515 - val_accuracy20: 0.5812 - 69s/epoch - 41ms/step
Epoch 33/50
1664/1664 - 70s - loss: 2.3798 - accuracy20: 0.6203 - val_loss: 2.9165 - val_accuracy20: 0.5756 - 70s/epoch - 42ms/step
Epoch 34/50
1664/1664 - 72s - loss: 2.3758 - accuracy20: 0.6203 - val_loss: 2.9344 - val_accuracy20: 0.5787 - 72s/epoch - 43ms/step
Epoch 35/50
1664/1664 - 71s - loss: 2.3726 - accuracy20: 0.6209 - val_loss: 2.9311 - val_accuracy20: 0.5723 - 71s/epoch - 43ms/step
Epoch 36/50
1664/1664 - 71s - loss: 2.3701 - accuracy20: 0.6213 - val_loss: 2.9400 - val_accuracy20: 0.5784 - 71s/epoch - 43ms/step
Epoch 37/50
1664/1664 - 71s - loss: 2.3674 - accuracy20: 0.6215 - val_loss: 2.9344 - val_accuracy20: 0.5804 - 71s/epoch - 43ms/step
testing model: results/WBA/W5/deepVOL_L3/h20
Evaluating performance on  test set...
7459/7459 - 187s - 187s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0273819
{'0': {'precision': 0.46630527386912946, 'recall': 0.47728240111196074, 'f1-score': 0.4717299868671742, 'support': 530954}, '1': {'precision': 0.6608691792757032, 'recall': 0.4169260754864448, 'f1-score': 0.5112911605575263, 'support': 821419}, '2': {'precision': 0.4322657904516951, 'recall': 0.6579214837002001, 'f1-score': 0.5217396257501978, 'support': 556878}, 'accuracy': 0.5040028786157503, 'macro avg': {'precision': 0.5198134145321759, 'recall': 0.5173766534328685, 'f1-score': 0.5015869243916328, 'support': 1909251}, 'weighted avg': {'precision': 0.5400842841556913, 'recall': 0.5040028786157503, 'f1-score': 0.5033369193309811, 'support': 1909251}}
[[253415  91045 186494]
 [184239 342471 294709]
 [105799  84697 366382]]
Evaluating performance on  train set...
1664/1664 - 42s - 42s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8175441
{'0': {'precision': 0.5110061958163374, 'recall': 0.48651525101333754, 'f1-score': 0.4984600750532159, 'support': 88322}, '1': {'precision': 0.7962628491367191, 'recall': 0.6718361734123569, 'f1-score': 0.7287767069902146, 'support': 248702}, '2': {'precision': 0.43751278070208655, 'recall': 0.6495125872789215, 'f1-score': 0.522839791106646, 'support': 88939}, 'accuracy': 0.6287494453743635, 'macro avg': {'precision': 0.5815939418850476, 'recall': 0.602621337234872, 'f1-score': 0.5833588577166922, 'support': 425963}, 'weighted avg': {'precision': 0.6622105711898774, 'recall': 0.6287494453743635, 'f1-score': 0.6380227003565203, 'support': 425963}}
[[ 42970  23089  22263]
 [ 29610 167087  52005]
 [ 11509  19663  57767]]
Evaluating performance on  val set...
517/517 - 13s - 13s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91504157
{'0': {'precision': 0.4906575289325661, 'recall': 0.4682544579502684, 'f1-score': 0.47919429184820356, 'support': 32414}, '1': {'precision': 0.7553560146273286, 'recall': 0.5881835529846741, 'f1-score': 0.6613694083331239, 'support': 67076}, '2': {'precision': 0.4398196323274367, 'recall': 0.6594872422443859, 'f1-score': 0.5277060357173459, 'support': 32686}, 'accuracy': 0.5764057014889239, 'macro avg': {'precision': 0.5619443919624438, 'recall': 0.5719750843931095, 'f1-score': 0.5560899119662244, 'support': 132176}, 'weighted avg': {'precision': 0.6124135825128426, 'recall': 0.5764057014889239, 'f1-score': 0.5836401290156871, 'support': 132176}}
[[15178  6937 10299]
 [10467 39453 17156]
 [ 5289  5841 21556]]
training model: results/WBA/W5/deepVOL_L3/h30
Epoch 1/50
1664/1664 - 74s - loss: 3.1326 - accuracy30: 0.4444 - val_loss: 3.1619 - val_accuracy30: 0.5122 - 74s/epoch - 45ms/step
Epoch 2/50
1664/1664 - 71s - loss: 2.8250 - accuracy30: 0.5352 - val_loss: 3.1182 - val_accuracy30: 0.5288 - 71s/epoch - 43ms/step
Epoch 3/50
1664/1664 - 71s - loss: 2.7201 - accuracy30: 0.5633 - val_loss: 3.0585 - val_accuracy30: 0.5373 - 71s/epoch - 42ms/step
Epoch 4/50
1664/1664 - 70s - loss: 2.6768 - accuracy30: 0.5725 - val_loss: 3.0500 - val_accuracy30: 0.5459 - 70s/epoch - 42ms/step
Epoch 5/50
1664/1664 - 70s - loss: 2.6495 - accuracy30: 0.5783 - val_loss: 3.0403 - val_accuracy30: 0.5438 - 70s/epoch - 42ms/step
Epoch 6/50
1664/1664 - 70s - loss: 2.6313 - accuracy30: 0.5820 - val_loss: 3.0407 - val_accuracy30: 0.5447 - 70s/epoch - 42ms/step
Epoch 7/50
1664/1664 - 71s - loss: 2.6118 - accuracy30: 0.5852 - val_loss: 3.0411 - val_accuracy30: 0.5556 - 71s/epoch - 42ms/step
Epoch 8/50
1664/1664 - 71s - loss: 2.5996 - accuracy30: 0.5880 - val_loss: 3.0111 - val_accuracy30: 0.5570 - 71s/epoch - 42ms/step
Epoch 9/50
1664/1664 - 72s - loss: 2.5861 - accuracy30: 0.5900 - val_loss: 3.0312 - val_accuracy30: 0.5595 - 72s/epoch - 43ms/step
Epoch 10/50
1664/1664 - 72s - loss: 2.5756 - accuracy30: 0.5927 - val_loss: 3.0128 - val_accuracy30: 0.5635 - 72s/epoch - 43ms/step
Epoch 11/50
1664/1664 - 71s - loss: 2.5655 - accuracy30: 0.5925 - val_loss: 2.9924 - val_accuracy30: 0.5651 - 71s/epoch - 42ms/step
Epoch 12/50
1664/1664 - 72s - loss: 2.5570 - accuracy30: 0.5954 - val_loss: 2.9843 - val_accuracy30: 0.5671 - 72s/epoch - 44ms/step
Epoch 13/50
1664/1664 - 72s - loss: 2.5510 - accuracy30: 0.5957 - val_loss: 2.9700 - val_accuracy30: 0.5680 - 72s/epoch - 43ms/step
Epoch 14/50
1664/1664 - 72s - loss: 2.5434 - accuracy30: 0.5971 - val_loss: 2.9549 - val_accuracy30: 0.5686 - 72s/epoch - 43ms/step
Epoch 15/50
1664/1664 - 72s - loss: 2.5383 - accuracy30: 0.5974 - val_loss: 2.9446 - val_accuracy30: 0.5656 - 72s/epoch - 43ms/step
Epoch 16/50
1664/1664 - 72s - loss: 2.5330 - accuracy30: 0.5987 - val_loss: 2.9607 - val_accuracy30: 0.5679 - 72s/epoch - 43ms/step
Epoch 17/50
1664/1664 - 72s - loss: 2.5282 - accuracy30: 0.5994 - val_loss: 2.9175 - val_accuracy30: 0.5687 - 72s/epoch - 43ms/step
Epoch 18/50
1664/1664 - 73s - loss: 2.5228 - accuracy30: 0.5999 - val_loss: 2.9394 - val_accuracy30: 0.5671 - 73s/epoch - 44ms/step
Epoch 19/50
1664/1664 - 69s - loss: 2.5188 - accuracy30: 0.6007 - val_loss: 2.9174 - val_accuracy30: 0.5690 - 69s/epoch - 42ms/step
Epoch 20/50
1664/1664 - 71s - loss: 2.5156 - accuracy30: 0.6020 - val_loss: 2.9277 - val_accuracy30: 0.5693 - 71s/epoch - 42ms/step
Epoch 21/50
1664/1664 - 73s - loss: 2.5110 - accuracy30: 0.6024 - val_loss: 2.9306 - val_accuracy30: 0.5692 - 73s/epoch - 44ms/step
Epoch 22/50
1664/1664 - 73s - loss: 2.5083 - accuracy30: 0.6027 - val_loss: 2.9421 - val_accuracy30: 0.5688 - 73s/epoch - 44ms/step
Epoch 23/50
1664/1664 - 70s - loss: 2.5023 - accuracy30: 0.6042 - val_loss: 2.9293 - val_accuracy30: 0.5680 - 70s/epoch - 42ms/step
Epoch 24/50
1664/1664 - 70s - loss: 2.4993 - accuracy30: 0.6040 - val_loss: 2.9206 - val_accuracy30: 0.5656 - 70s/epoch - 42ms/step
Epoch 25/50
1664/1664 - 71s - loss: 2.4951 - accuracy30: 0.6045 - val_loss: 2.9308 - val_accuracy30: 0.5616 - 71s/epoch - 43ms/step
Epoch 26/50
1664/1664 - 70s - loss: 2.4928 - accuracy30: 0.6048 - val_loss: 2.9281 - val_accuracy30: 0.5654 - 70s/epoch - 42ms/step
Epoch 27/50
1664/1664 - 72s - loss: 2.4895 - accuracy30: 0.6051 - val_loss: 2.9430 - val_accuracy30: 0.5608 - 72s/epoch - 43ms/step
Epoch 28/50
1664/1664 - 72s - loss: 2.4859 - accuracy30: 0.6063 - val_loss: 2.9485 - val_accuracy30: 0.5646 - 72s/epoch - 43ms/step
Epoch 29/50
1664/1664 - 73s - loss: 2.4821 - accuracy30: 0.6069 - val_loss: 2.9171 - val_accuracy30: 0.5608 - 73s/epoch - 44ms/step
Epoch 30/50
1664/1664 - 70s - loss: 2.4773 - accuracy30: 0.6072 - val_loss: 2.9470 - val_accuracy30: 0.5593 - 70s/epoch - 42ms/step
Epoch 31/50
1664/1664 - 70s - loss: 2.4749 - accuracy30: 0.6079 - val_loss: 2.9530 - val_accuracy30: 0.5588 - 70s/epoch - 42ms/step
Epoch 32/50
1664/1664 - 71s - loss: 2.4728 - accuracy30: 0.6084 - val_loss: 2.9310 - val_accuracy30: 0.5541 - 71s/epoch - 43ms/step
Epoch 33/50
1664/1664 - 72s - loss: 2.4682 - accuracy30: 0.6088 - val_loss: 2.9518 - val_accuracy30: 0.5526 - 72s/epoch - 43ms/step
Epoch 34/50
1664/1664 - 73s - loss: 2.4662 - accuracy30: 0.6087 - val_loss: 2.9413 - val_accuracy30: 0.5533 - 73s/epoch - 44ms/step
Epoch 35/50
1664/1664 - 73s - loss: 2.4633 - accuracy30: 0.6098 - val_loss: 2.9535 - val_accuracy30: 0.5543 - 73s/epoch - 44ms/step
Epoch 36/50
1664/1664 - 72s - loss: 2.4619 - accuracy30: 0.6097 - val_loss: 2.9536 - val_accuracy30: 0.5525 - 72s/epoch - 43ms/step
Epoch 37/50
1664/1664 - 73s - loss: 2.4586 - accuracy30: 0.6111 - val_loss: 2.9457 - val_accuracy30: 0.5545 - 73s/epoch - 44ms/step
Epoch 38/50
1664/1664 - 69s - loss: 2.4557 - accuracy30: 0.6105 - val_loss: 2.9631 - val_accuracy30: 0.5500 - 69s/epoch - 42ms/step
Epoch 39/50
1664/1664 - 71s - loss: 2.4523 - accuracy30: 0.6109 - val_loss: 2.9660 - val_accuracy30: 0.5492 - 71s/epoch - 42ms/step
testing model: results/WBA/W5/deepVOL_L3/h30
Evaluating performance on  test set...
7459/7459 - 159s - 159s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0317371
{'0': {'precision': 0.4598245623581779, 'recall': 0.5566560387873678, 'f1-score': 0.503628144267532, 'support': 607208}, '1': {'precision': 0.5630011490848285, 'recall': 0.40296018752264723, 'f1-score': 0.4697228346787904, 'support': 665093}, '2': {'precision': 0.48179315442086446, 'recall': 0.5280806970719837, 'f1-score': 0.5038761315682642, 'support': 636950}, 'accuracy': 0.4935825619575425, 'macro avg': {'precision': 0.5015396219546236, 'recall': 0.49589897446066616, 'f1-score': 0.4924090368381955, 'support': 1909251}, 'weighted avg': {'precision': 0.5030954158552384, 'recall': 0.4935825619575425, 'f1-score': 0.4918998651889281, 'support': 1909251}}
[[338006  98866 170336]
 [205640 268006 191447]
 [191430 109159 336361]]
Evaluating performance on  train set...
1664/1664 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85353845
{'0': {'precision': 0.5090065806595531, 'recall': 0.5282281789858497, 'f1-score': 0.5184392765347129, 'support': 103673}, '1': {'precision': 0.7223698193411264, 'recall': 0.685335484196199, 'f1-score': 0.7033654965465505, 'support': 218207}, '2': {'precision': 0.4933321359615644, 'recall': 0.5277999289028948, 'f1-score': 0.5099843110314801, 'support': 104083}, 'accuracy': 0.6086045032080251, 'macro avg': {'precision': 0.574902845320748, 'recall': 0.5804545306949812, 'f1-score': 0.5772630280375811, 'support': 425963}, 'weighted avg': {'precision': 0.6144756213872438, 'recall': 0.6086045032080251, 'f1-score': 0.6111050186664241, 'support': 425963}}
[[ 54763  29349  19561]
 [ 31803 149545  36859]
 [ 21022  28126  54935]]
Evaluating performance on  val set...
517/517 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93080634
{'0': {'precision': 0.4850268748400307, 'recall': 0.5087111755389117, 'f1-score': 0.49658678476435053, 'support': 37251}, '1': {'precision': 0.6744812718943681, 'recall': 0.6106686649356081, 'f1-score': 0.6409906984826729, 'support': 57383}, '2': {'precision': 0.48942943234836706, 'recall': 0.5364924617761441, 'f1-score': 0.511881464914733, 'support': 37542}, 'accuracy': 0.5608658152766008, 'macro avg': {'precision': 0.5496458596942553, 'recall': 0.5519574340835546, 'f1-score': 0.5498196493872521, 'support': 132176}, 'weighted avg': {'precision': 0.5685272264934852, 'recall': 0.5608658152766008, 'f1-score': 0.5636225754003521, 'support': 132176}}
[[18950  8726  9575]
 [10905 35042 11436]
 [ 9215  8186 20141]]
training model: results/WBA/W5/deepVOL_L3/h50
Epoch 1/50
1664/1664 - 75s - loss: 3.2112 - accuracy50: 0.4250 - val_loss: 3.3168 - val_accuracy50: 0.4394 - 75s/epoch - 45ms/step
Epoch 2/50
1664/1664 - 73s - loss: 2.9642 - accuracy50: 0.5027 - val_loss: 3.1609 - val_accuracy50: 0.4905 - 73s/epoch - 44ms/step
Epoch 3/50
1664/1664 - 72s - loss: 2.8643 - accuracy50: 0.5292 - val_loss: 3.1169 - val_accuracy50: 0.4930 - 72s/epoch - 43ms/step
Epoch 4/50
1664/1664 - 73s - loss: 2.8164 - accuracy50: 0.5395 - val_loss: 3.1371 - val_accuracy50: 0.4956 - 73s/epoch - 44ms/step
Epoch 5/50
1664/1664 - 73s - loss: 2.7890 - accuracy50: 0.5452 - val_loss: 3.1236 - val_accuracy50: 0.4944 - 73s/epoch - 44ms/step
Epoch 6/50
1664/1664 - 73s - loss: 2.7722 - accuracy50: 0.5498 - val_loss: 3.0813 - val_accuracy50: 0.4989 - 73s/epoch - 44ms/step
Epoch 7/50
1664/1664 - 74s - loss: 2.7621 - accuracy50: 0.5514 - val_loss: 3.0842 - val_accuracy50: 0.5013 - 74s/epoch - 44ms/step
Epoch 8/50
1664/1664 - 77s - loss: 2.7518 - accuracy50: 0.5538 - val_loss: 3.0887 - val_accuracy50: 0.5026 - 77s/epoch - 46ms/step
Epoch 9/50
1664/1664 - 74s - loss: 2.7436 - accuracy50: 0.5555 - val_loss: 3.0609 - val_accuracy50: 0.5039 - 74s/epoch - 44ms/step
Epoch 10/50
1664/1664 - 73s - loss: 2.7366 - accuracy50: 0.5573 - val_loss: 3.0755 - val_accuracy50: 0.5044 - 73s/epoch - 44ms/step
Epoch 11/50
1664/1664 - 73s - loss: 2.7304 - accuracy50: 0.5584 - val_loss: 3.0479 - val_accuracy50: 0.5076 - 73s/epoch - 44ms/step
Epoch 12/50
1664/1664 - 70s - loss: 2.7245 - accuracy50: 0.5601 - val_loss: 3.0402 - val_accuracy50: 0.5054 - 70s/epoch - 42ms/step
Epoch 13/50
1664/1664 - 71s - loss: 2.7184 - accuracy50: 0.5612 - val_loss: 3.0270 - val_accuracy50: 0.5097 - 71s/epoch - 43ms/step
Epoch 14/50
1664/1664 - 70s - loss: 2.7135 - accuracy50: 0.5623 - val_loss: 3.0291 - val_accuracy50: 0.5121 - 70s/epoch - 42ms/step
Epoch 15/50
1664/1664 - 71s - loss: 2.7085 - accuracy50: 0.5632 - val_loss: 3.0189 - val_accuracy50: 0.5128 - 71s/epoch - 43ms/step
Epoch 16/50
1664/1664 - 73s - loss: 2.7034 - accuracy50: 0.5643 - val_loss: 3.0122 - val_accuracy50: 0.5142 - 73s/epoch - 44ms/step
Epoch 17/50
1664/1664 - 71s - loss: 2.6990 - accuracy50: 0.5656 - val_loss: 3.0088 - val_accuracy50: 0.5147 - 71s/epoch - 43ms/step
Epoch 18/50
1664/1664 - 71s - loss: 2.6962 - accuracy50: 0.5661 - val_loss: 3.0046 - val_accuracy50: 0.5159 - 71s/epoch - 43ms/step
Epoch 19/50
1664/1664 - 74s - loss: 2.6908 - accuracy50: 0.5663 - val_loss: 2.9920 - val_accuracy50: 0.5177 - 74s/epoch - 44ms/step
Epoch 20/50
1664/1664 - 72s - loss: 2.6887 - accuracy50: 0.5672 - val_loss: 3.0116 - val_accuracy50: 0.5141 - 72s/epoch - 43ms/step
Epoch 21/50
1664/1664 - 73s - loss: 2.6848 - accuracy50: 0.5677 - val_loss: 2.9805 - val_accuracy50: 0.5203 - 73s/epoch - 44ms/step
Epoch 22/50
1664/1664 - 74s - loss: 2.6810 - accuracy50: 0.5685 - val_loss: 2.9832 - val_accuracy50: 0.5187 - 74s/epoch - 44ms/step
Epoch 23/50
1664/1664 - 74s - loss: 2.6771 - accuracy50: 0.5698 - val_loss: 2.9954 - val_accuracy50: 0.5195 - 74s/epoch - 44ms/step
Epoch 24/50
1664/1664 - 73s - loss: 2.6741 - accuracy50: 0.5701 - val_loss: 2.9867 - val_accuracy50: 0.5173 - 73s/epoch - 44ms/step
Epoch 25/50
1664/1664 - 70s - loss: 2.6718 - accuracy50: 0.5705 - val_loss: 2.9791 - val_accuracy50: 0.5185 - 70s/epoch - 42ms/step
Epoch 26/50
1664/1664 - 70s - loss: 2.6673 - accuracy50: 0.5716 - val_loss: 2.9743 - val_accuracy50: 0.5176 - 70s/epoch - 42ms/step
Epoch 27/50
1664/1664 - 69s - loss: 2.6638 - accuracy50: 0.5726 - val_loss: 2.9851 - val_accuracy50: 0.5156 - 69s/epoch - 41ms/step
Epoch 28/50
1664/1664 - 69s - loss: 2.6610 - accuracy50: 0.5724 - val_loss: 2.9902 - val_accuracy50: 0.5160 - 69s/epoch - 42ms/step
Epoch 29/50
1664/1664 - 73s - loss: 2.6581 - accuracy50: 0.5739 - val_loss: 2.9874 - val_accuracy50: 0.5167 - 73s/epoch - 44ms/step
Epoch 30/50
1664/1664 - 74s - loss: 2.6548 - accuracy50: 0.5741 - val_loss: 3.0057 - val_accuracy50: 0.5154 - 74s/epoch - 44ms/step
Epoch 31/50
1664/1664 - 73s - loss: 2.6508 - accuracy50: 0.5745 - val_loss: 3.0184 - val_accuracy50: 0.5147 - 73s/epoch - 44ms/step
Epoch 32/50
1664/1664 - 71s - loss: 2.6496 - accuracy50: 0.5751 - val_loss: 3.0232 - val_accuracy50: 0.5145 - 71s/epoch - 43ms/step
Epoch 33/50
1664/1664 - 71s - loss: 2.6454 - accuracy50: 0.5758 - val_loss: 3.0010 - val_accuracy50: 0.5163 - 71s/epoch - 42ms/step
Epoch 34/50
1664/1664 - 69s - loss: 2.6433 - accuracy50: 0.5771 - val_loss: 3.0059 - val_accuracy50: 0.5164 - 69s/epoch - 42ms/step
Epoch 35/50
1664/1664 - 70s - loss: 2.6413 - accuracy50: 0.5772 - val_loss: 3.0097 - val_accuracy50: 0.5142 - 70s/epoch - 42ms/step
Epoch 36/50
1664/1664 - 73s - loss: 2.6363 - accuracy50: 0.5774 - val_loss: 3.0133 - val_accuracy50: 0.5140 - 73s/epoch - 44ms/step
testing model: results/WBA/W5/deepVOL_L3/h50
Evaluating performance on  test set...
7459/7459 - 157s - 157s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0316303
{'0': {'precision': 0.5018508573401358, 'recall': 0.44852707995851654, 'f1-score': 0.47369302418205106, 'support': 700038}, '1': {'precision': 0.4171443743136095, 'recall': 0.3612064389110198, 'f1-score': 0.3871653537133262, 'support': 478466}, '2': {'precision': 0.47681441176132244, 'recall': 0.5672140973551721, 'f1-score': 0.5181005189254998, 'support': 730747}, 'accuracy': 0.47207046113894924, 'macro avg': {'precision': 0.46526988113835593, 'recall': 0.4589825387415695, 'f1-score': 0.459652965606959, 'support': 1909251}, 'weighted avg': {'precision': 0.4710406183484312, 'recall': 0.47207046113894924, 'f1-score': 0.46900537189474156, 'support': 1909251}}
[[313986 126479 259573]
 [110414 172825 195227]
 [201256 115001 414490]]
Evaluating performance on  train set...
1664/1664 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.920122
{'0': {'precision': 0.5572574362800496, 'recall': 0.40669266433381646, 'f1-score': 0.47021627226604457, 'support': 124883}, '1': {'precision': 0.6033416095539049, 'recall': 0.667489585816279, 'f1-score': 0.6337965931809733, 'support': 176202}, '2': {'precision': 0.4861101182391376, 'recall': 0.5445314627076027, 'f1-score': 0.5136649997733832, 'support': 124878}, 'accuracy': 0.5549824750036975, 'macro avg': {'precision': 0.5489030546910307, 'recall': 0.5395712376192328, 'f1-score': 0.539225955073467, 'support': 425963}, 'weighted avg': {'precision': 0.5554624182077917, 'recall': 0.5549824750036975, 'f1-score': 0.5506198986362074, 'support': 425963}}
[[ 50789  42874  31220]
 [ 17923 117613  40666]
 [ 22429  34449  68000]]
Evaluating performance on  val set...
517/517 - 13s - 13s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9696696
{'0': {'precision': 0.5219312176951286, 'recall': 0.4161103181546112, 'f1-score': 0.4630519156131115, 'support': 43438}, '1': {'precision': 0.5564105798746899, 'recall': 0.5912686000268108, 'f1-score': 0.5733102253032929, 'support': 44758}, '2': {'precision': 0.48290418742372404, 'recall': 0.5488176443838109, 'f1-score': 0.5137554143652289, 'support': 43980}, 'accuracy': 0.5195799540007263, 'macro avg': {'precision': 0.5204153283311809, 'recall': 0.5187321875217443, 'f1-score': 0.5167058517605444, 'support': 132176}, 'weighted avg': {'precision': 0.5206209836215936, 'recall': 0.5195799540007263, 'f1-score': 0.5172590432325831, 'support': 132176}}
[[18075 11589 13774]
 [ 6222 26464 12072]
 [10334  9509 24137]]
training model: results/WBA/W5/deepVOL_L3/h100
Epoch 1/50
1664/1664 - 73s - loss: 3.2372 - accuracy100: 0.4050 - val_loss: 3.3452 - val_accuracy100: 0.3497 - 73s/epoch - 44ms/step
Epoch 2/50
1664/1664 - 71s - loss: 3.1207 - accuracy100: 0.4504 - val_loss: 3.2132 - val_accuracy100: 0.4310 - 71s/epoch - 43ms/step
Epoch 3/50
1664/1664 - 76s - loss: 3.0743 - accuracy100: 0.4663 - val_loss: 3.2142 - val_accuracy100: 0.4218 - 76s/epoch - 46ms/step
Epoch 4/50
1664/1664 - 76s - loss: 3.0480 - accuracy100: 0.4730 - val_loss: 3.1973 - val_accuracy100: 0.4290 - 76s/epoch - 46ms/step
Epoch 5/50
1664/1664 - 73s - loss: 3.0305 - accuracy100: 0.4768 - val_loss: 3.2167 - val_accuracy100: 0.4246 - 73s/epoch - 44ms/step
Epoch 6/50
1664/1664 - 72s - loss: 3.0174 - accuracy100: 0.4802 - val_loss: 3.1788 - val_accuracy100: 0.4279 - 72s/epoch - 43ms/step
Epoch 7/50
1664/1664 - 76s - loss: 3.0080 - accuracy100: 0.4830 - val_loss: 3.1812 - val_accuracy100: 0.4289 - 76s/epoch - 45ms/step
Epoch 8/50
1664/1664 - 77s - loss: 2.9998 - accuracy100: 0.4855 - val_loss: 3.1770 - val_accuracy100: 0.4272 - 77s/epoch - 46ms/step
Epoch 9/50
1664/1664 - 72s - loss: 2.9953 - accuracy100: 0.4872 - val_loss: 3.1562 - val_accuracy100: 0.4305 - 72s/epoch - 43ms/step
Epoch 10/50
1664/1664 - 70s - loss: 2.9889 - accuracy100: 0.4887 - val_loss: 3.1725 - val_accuracy100: 0.4316 - 70s/epoch - 42ms/step
Epoch 11/50
1664/1664 - 72s - loss: 2.9850 - accuracy100: 0.4896 - val_loss: 3.1789 - val_accuracy100: 0.4316 - 72s/epoch - 43ms/step
Epoch 12/50
1664/1664 - 73s - loss: 2.9794 - accuracy100: 0.4914 - val_loss: 3.1667 - val_accuracy100: 0.4359 - 73s/epoch - 44ms/step
Epoch 13/50
1664/1664 - 73s - loss: 2.9748 - accuracy100: 0.4928 - val_loss: 3.1680 - val_accuracy100: 0.4336 - 73s/epoch - 44ms/step
Epoch 14/50
1664/1664 - 72s - loss: 2.9721 - accuracy100: 0.4948 - val_loss: 3.1664 - val_accuracy100: 0.4368 - 72s/epoch - 43ms/step
Epoch 15/50
1664/1664 - 70s - loss: 2.9686 - accuracy100: 0.4948 - val_loss: 3.1615 - val_accuracy100: 0.4364 - 70s/epoch - 42ms/step
Epoch 16/50
1664/1664 - 70s - loss: 2.9643 - accuracy100: 0.4966 - val_loss: 3.1794 - val_accuracy100: 0.4353 - 70s/epoch - 42ms/step
Epoch 17/50
1664/1664 - 69s - loss: 2.9616 - accuracy100: 0.4972 - val_loss: 3.1675 - val_accuracy100: 0.4376 - 69s/epoch - 41ms/step
Epoch 18/50
1664/1664 - 69s - loss: 2.9576 - accuracy100: 0.4985 - val_loss: 3.1825 - val_accuracy100: 0.4350 - 69s/epoch - 41ms/step
Epoch 19/50
1664/1664 - 69s - loss: 2.9542 - accuracy100: 0.5003 - val_loss: 3.1762 - val_accuracy100: 0.4378 - 69s/epoch - 41ms/step
testing model: results/WBA/W5/deepVOL_L3/h100
Evaluating performance on  test set...
7459/7459 - 159s - 159s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0782657
{'0': {'precision': 0.4996530607749411, 'recall': 0.1224988793899561, 'f1-score': 0.1967588175083708, 'support': 740668}, '1': {'precision': 0.29142671487552274, 'recall': 0.3745631878798831, 'f1-score': 0.32780592890528326, 'support': 409501}, '2': {'precision': 0.4331031463147047, 'recall': 0.6854397812094082, 'f1-score': 0.530808641395943, 'support': 759082}, 'accuracy': 0.40037690172743134, 'macro avg': {'precision': 0.40806097398838953, 'recall': 0.3941672828264158, 'f1-score': 0.35179112926986567, 'support': 1909251}, 'weighted avg': {'precision': 0.4285331613795955, 'recall': 0.40037690172743134, 'f1-score': 0.3576780112552239, 'support': 1909251}}
[[ 90731 191263 458674]
 [ 33754 153384 222363]
 [ 57103 181674 520305]]
Evaluating performance on  train set...
1664/1664 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0425806
{'0': {'precision': 0.5694720430436244, 'recall': 0.12970519015722262, 'f1-score': 0.21128685582065343, 'support': 143618}, '1': {'precision': 0.4390897105503723, 'recall': 0.6812755251135043, 'f1-score': 0.5340063465105365, 'support': 140303}, '2': {'precision': 0.4449627768949038, 'recall': 0.5499711352980104, 'f1-score': 0.49192550495111853, 'support': 142042}, 'accuracy': 0.451522784842815, 'macro avg': {'precision': 0.48450817682963354, 'recall': 0.45365061685624575, 'f1-score': 0.41240623576076946, 'support': 425963}, 'weighted avg': {'precision': 0.4850079520824439, 'recall': 0.451522784842815, 'f1-score': 0.41116568966784717, 'support': 425963}}
[[18628 65899 59091]
 [ 6365 95585 38353]
 [ 7718 56205 78119]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0542167
{'0': {'precision': 0.5246314610934876, 'recall': 0.11816252337823355, 'f1-score': 0.1928822570963039, 'support': 47587}, '1': {'precision': 0.39773730684326714, 'recall': 0.5972486947874368, 'f1-score': 0.4774903103985159, 'support': 36201}, '2': {'precision': 0.4448120659334108, 'recall': 0.6168058196247004, 'f1-score': 0.5168765045113692, 'support': 48388}, 'accuracy': 0.43192410119840213, 'macro avg': {'precision': 0.45572694462338853, 'recall': 0.4440723459301236, 'f1-score': 0.39574969066872967, 'support': 132176}, 'weighted avg': {'precision': 0.46065618440923306, 'recall': 0.43192410119840213, 'f1-score': 0.3894423722572526, 'support': 132176}}
[[ 5623 17150 24814]
 [ 2142 21621 12438]
 [ 2953 15589 29846]]
training model: results/WBA/W5/deepVOL_L3/h200
Epoch 1/50
1664/1664 - 69s - loss: 3.3012 - accuracy200: 0.3608 - val_loss: 3.3451 - val_accuracy200: 0.3511 - 69s/epoch - 42ms/step
Epoch 2/50
1664/1664 - 67s - loss: 3.2716 - accuracy200: 0.3712 - val_loss: 3.3554 - val_accuracy200: 0.3638 - 67s/epoch - 40ms/step
Epoch 3/50
1664/1664 - 67s - loss: 3.2496 - accuracy200: 0.3893 - val_loss: 3.3145 - val_accuracy200: 0.3676 - 67s/epoch - 40ms/step
Epoch 4/50
1664/1664 - 66s - loss: 3.2314 - accuracy200: 0.4019 - val_loss: 3.2987 - val_accuracy200: 0.3724 - 66s/epoch - 40ms/step
Epoch 5/50
1664/1664 - 67s - loss: 3.2205 - accuracy200: 0.4070 - val_loss: 3.2975 - val_accuracy200: 0.3756 - 67s/epoch - 40ms/step
Epoch 6/50
1664/1664 - 67s - loss: 3.2123 - accuracy200: 0.4115 - val_loss: 3.3149 - val_accuracy200: 0.3705 - 67s/epoch - 40ms/step
Epoch 7/50
1664/1664 - 66s - loss: 3.2071 - accuracy200: 0.4127 - val_loss: 3.2968 - val_accuracy200: 0.3764 - 66s/epoch - 40ms/step
Epoch 8/50
1664/1664 - 67s - loss: 3.1988 - accuracy200: 0.4171 - val_loss: 3.3019 - val_accuracy200: 0.3760 - 67s/epoch - 40ms/step
Epoch 9/50
1664/1664 - 67s - loss: 3.1929 - accuracy200: 0.4186 - val_loss: 3.3044 - val_accuracy200: 0.3781 - 67s/epoch - 40ms/step
Epoch 10/50
1664/1664 - 66s - loss: 3.1881 - accuracy200: 0.4215 - val_loss: 3.3044 - val_accuracy200: 0.3803 - 66s/epoch - 40ms/step
Epoch 11/50
1664/1664 - 67s - loss: 3.1833 - accuracy200: 0.4232 - val_loss: 3.3085 - val_accuracy200: 0.3782 - 67s/epoch - 40ms/step
Epoch 12/50
1664/1664 - 67s - loss: 3.1797 - accuracy200: 0.4249 - val_loss: 3.3089 - val_accuracy200: 0.3804 - 67s/epoch - 40ms/step
Epoch 13/50
1664/1664 - 68s - loss: 3.1753 - accuracy200: 0.4269 - val_loss: 3.3169 - val_accuracy200: 0.3782 - 68s/epoch - 41ms/step
Epoch 14/50
1664/1664 - 67s - loss: 3.1721 - accuracy200: 0.4288 - val_loss: 3.3248 - val_accuracy200: 0.3794 - 67s/epoch - 40ms/step
Epoch 15/50
1664/1664 - 66s - loss: 3.1674 - accuracy200: 0.4304 - val_loss: 3.3250 - val_accuracy200: 0.3783 - 66s/epoch - 40ms/step
Epoch 16/50
1664/1664 - 67s - loss: 3.1633 - accuracy200: 0.4331 - val_loss: 3.3440 - val_accuracy200: 0.3743 - 67s/epoch - 40ms/step
Epoch 17/50
1664/1664 - 66s - loss: 3.1607 - accuracy200: 0.4339 - val_loss: 3.3608 - val_accuracy200: 0.3743 - 66s/epoch - 40ms/step
testing model: results/WBA/W5/deepVOL_L3/h200
Evaluating performance on  test set...
7459/7459 - 146s - 146s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0932862
{'0': {'precision': 0.427277379026124, 'recall': 0.24657687304302486, 'f1-score': 0.31269883574607055, 'support': 751798}, '1': {'precision': 0.2331014755394469, 'recall': 0.06600145384300005, 'f1-score': 0.10287452757695986, 'support': 397567}, '2': {'precision': 0.4118553478502056, 'recall': 0.7386476392511508, 'f1-score': 0.5288399661942211, 'support': 759886}, 'accuracy': 0.40482052909753613, 'macro avg': {'precision': 0.35741140080525885, 'recall': 0.3504086553790586, 'f1-score': 0.3148044431724172, 'support': 1909251}, 'weighted avg': {'precision': 0.38070575643504945, 'recall': 0.40482052909753613, 'f1-score': 0.35503135165197003, 'support': 1909251}}
[[185376  45261 521161]
 [ 90948  26240 280379]
 [157530  41068 561288]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099355
{'0': {'precision': 0.40778800833059303, 'recall': 0.21157318546953863, 'f1-score': 0.2785999794059554, 'support': 140670}, '1': {'precision': 0.41687620174530393, 'recall': 0.2297627781853754, 'f1-score': 0.29624763506411605, 'support': 147204}, '2': {'precision': 0.35841116510390036, 'recall': 0.7055811831499975, 'f1-score': 0.4753571289176847, 'support': 138089}, 'accuracy': 0.378007009998521, 'macro avg': {'precision': 0.3943584583932658, 'recall': 0.3823057156016372, 'f1-score': 0.3500682477959187, 'support': 425963}, 'weighted avg': {'precision': 0.3949216784359504, 'recall': 0.378007009998521, 'f1-score': 0.3484835221606761, 'support': 425963}}
[[29762 28126 82782]
 [21750 33822 91632]
 [21472 19184 97433]]
Evaluating performance on  val set...
517/517 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984102
{'0': {'precision': 0.39277683606046976, 'recall': 0.2527773448805575, 'f1-score': 0.30759644560034677, 'support': 44917}, '1': {'precision': 0.392729105982523, 'recall': 0.16761499474036531, 'f1-score': 0.23495308310991955, 'support': 41828}, '2': {'precision': 0.36752637062879756, 'recall': 0.6910039400409412, 'f1-score': 0.479839202739056, 'support': 45431}, 'accuracy': 0.37645260864302144, 'macro avg': {'precision': 0.3843441042239301, 'recall': 0.37046542655395465, 'f1-score': 0.34079624381644075, 'support': 132176}, 'weighted avg': {'precision': 0.38408274372353524, 'recall': 0.37645260864302144, 'f1-score': 0.3438105399391005, 'support': 132176}}
[[11354  5991 27572]
 [ 8365  7011 26452]
 [ 9188  4850 31393]]
training model: results/WBA/W5/deepVOL_L3/h300
Epoch 1/50
1664/1664 - 72s - loss: 3.3026 - accuracy300: 0.3595 - val_loss: 3.3285 - val_accuracy300: 0.3416 - 72s/epoch - 43ms/step
Epoch 2/50
1664/1664 - 73s - loss: 3.2772 - accuracy300: 0.3730 - val_loss: 3.3176 - val_accuracy300: 0.3521 - 73s/epoch - 44ms/step
Epoch 3/50
1664/1664 - 74s - loss: 3.2645 - accuracy300: 0.3851 - val_loss: 3.3087 - val_accuracy300: 0.3579 - 74s/epoch - 44ms/step
Epoch 4/50
1664/1664 - 69s - loss: 3.2538 - accuracy300: 0.3916 - val_loss: 3.3051 - val_accuracy300: 0.3606 - 69s/epoch - 42ms/step
Epoch 5/50
1664/1664 - 72s - loss: 3.2466 - accuracy300: 0.3956 - val_loss: 3.3047 - val_accuracy300: 0.3628 - 72s/epoch - 43ms/step
Epoch 6/50
1664/1664 - 74s - loss: 3.2409 - accuracy300: 0.3997 - val_loss: 3.3274 - val_accuracy300: 0.3582 - 74s/epoch - 45ms/step
Epoch 7/50
1664/1664 - 69s - loss: 3.2352 - accuracy300: 0.4026 - val_loss: 3.3305 - val_accuracy300: 0.3629 - 69s/epoch - 42ms/step
Epoch 8/50
1664/1664 - 67s - loss: 3.2317 - accuracy300: 0.4052 - val_loss: 3.3283 - val_accuracy300: 0.3605 - 67s/epoch - 40ms/step
Epoch 9/50
1664/1664 - 68s - loss: 3.2281 - accuracy300: 0.4074 - val_loss: 3.3334 - val_accuracy300: 0.3635 - 68s/epoch - 41ms/step
Epoch 10/50
1664/1664 - 70s - loss: 3.2225 - accuracy300: 0.4105 - val_loss: 3.3311 - val_accuracy300: 0.3665 - 70s/epoch - 42ms/step
Epoch 11/50
1664/1664 - 70s - loss: 3.2188 - accuracy300: 0.4125 - val_loss: 3.3351 - val_accuracy300: 0.3631 - 70s/epoch - 42ms/step
Epoch 12/50
1664/1664 - 66s - loss: 3.2163 - accuracy300: 0.4136 - val_loss: 3.3310 - val_accuracy300: 0.3640 - 66s/epoch - 40ms/step
Epoch 13/50
1664/1664 - 66s - loss: 3.2087 - accuracy300: 0.4174 - val_loss: 3.3409 - val_accuracy300: 0.3668 - 66s/epoch - 40ms/step
Epoch 14/50
1664/1664 - 70s - loss: 3.2046 - accuracy300: 0.4199 - val_loss: 3.3436 - val_accuracy300: 0.3636 - 70s/epoch - 42ms/step
Epoch 15/50
1664/1664 - 67s - loss: 3.2012 - accuracy300: 0.4212 - val_loss: 3.3479 - val_accuracy300: 0.3645 - 67s/epoch - 40ms/step
testing model: results/WBA/W5/deepVOL_L3/h300
Evaluating performance on  test set...
7459/7459 - 168s - 168s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032419
{'0': {'precision': 0.37002756586433977, 'recall': 0.26850997548051486, 'f1-score': 0.31119890751635315, 'support': 670895}, '1': {'precision': 0.31668986460837656, 'recall': 0.022371596617623397, 'f1-score': 0.0417909949322491, 'support': 559370}, '2': {'precision': 0.3591989887931321, 'recall': 0.7315865128294251, 'f1-score': 0.481827334947388, 'support': 678986}, 'accuracy': 0.36108033988197463, 'macro avg': {'precision': 0.3486388064219495, 'recall': 0.34082269497585443, 'f1-score': 0.2782724124653301, 'support': 1909251}, 'weighted avg': {'precision': 0.35054979045250595, 'recall': 0.36108033988197474, 'f1-score': 0.29294861426812036, 'support': 1909251}}
[[180142  14177 476576]
 [137267  12514 409589]
 [169425  12824 496737]]
Evaluating performance on  train set...
1664/1664 - 40s - 40s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050742
{'0': {'precision': 0.40369278900543304, 'recall': 0.19928433042147284, 'f1-score': 0.2668414590238093, 'support': 145039}, '1': {'precision': 0.36145658263305325, 'recall': 0.09307693417389172, 'f1-score': 0.1480342782411178, 'support': 138638}, '2': {'precision': 0.3482947556046494, 'recall': 0.7800416063421559, 'f1-score': 0.4815663304045992, 'support': 142286}, 'accuracy': 0.3587095592809704, 'macro avg': {'precision': 0.37114804241437854, 'recall': 0.3574676236458401, 'f1-score': 0.29881402255650874, 'support': 425963}, 'weighted avg': {'precision': 0.37144137806242183, 'recall': 0.3587095592809704, 'f1-score': 0.2998986802377088, 'support': 425963}}
[[ 28904  13297 102838]
 [ 20897  12904 104837]
 [ 21798   9499 110989]]
Evaluating performance on  val set...
517/517 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028637
{'0': {'precision': 0.3853611991751054, 'recall': 0.2752737346642628, 'f1-score': 0.3211450411050263, 'support': 45482}, '1': {'precision': 0.34918110987438383, 'recall': 0.05346447874567853, 'f1-score': 0.09273061250343094, 'support': 41074}, '2': {'precision': 0.3537977258613675, 'recall': 0.7243314335817623, 'f1-score': 0.47539167589808506, 'support': 45620}, 'accuracy': 0.36133639995157973, 'macro avg': {'precision': 0.3627800116369522, 'recall': 0.3510232156639012, 'f1-score': 0.2964224431688474, 'support': 132176}, 'weighted avg': {'precision': 0.36322414978254886, 'recall': 0.36133639995157973, 'f1-score': 0.30340231352117913, 'support': 132176}}
[[12520  2328 30634]
 [ 9158  2196 29720]
 [10811  1765 33044]]
training model: results/WBA/W5/deepVOL_L3/h500
Epoch 1/50
1664/1664 - 77s - loss: 3.2468 - accuracy500: 0.3994 - val_loss: 3.2855 - val_accuracy500: 0.3594 - 77s/epoch - 46ms/step
Epoch 2/50
1664/1664 - 75s - loss: 3.2712 - accuracy500: 0.3840 - val_loss: 3.2834 - val_accuracy500: 0.3597 - 75s/epoch - 45ms/step
Epoch 3/50
1664/1664 - 74s - loss: 3.2618 - accuracy500: 0.3901 - val_loss: 3.3029 - val_accuracy500: 0.3594 - 74s/epoch - 44ms/step
Epoch 4/50
1664/1664 - 73s - loss: 3.2526 - accuracy500: 0.3951 - val_loss: 3.2930 - val_accuracy500: 0.3588 - 73s/epoch - 44ms/step
Epoch 5/50
1664/1664 - 70s - loss: 3.2385 - accuracy500: 0.4018 - val_loss: 3.2916 - val_accuracy500: 0.3595 - 70s/epoch - 42ms/step
Epoch 6/50
1664/1664 - 71s - loss: 3.2357 - accuracy500: 0.4058 - val_loss: 3.3704 - val_accuracy500: 0.3592 - 71s/epoch - 43ms/step
Epoch 7/50
1664/1664 - 69s - loss: 3.2333 - accuracy500: 0.4103 - val_loss: 3.3698 - val_accuracy500: 0.3620 - 69s/epoch - 42ms/step
Epoch 8/50
1664/1664 - 69s - loss: 3.2180 - accuracy500: 0.4191 - val_loss: 3.3641 - val_accuracy500: 0.3613 - 69s/epoch - 41ms/step
Epoch 9/50
1664/1664 - 70s - loss: 3.2167 - accuracy500: 0.4168 - val_loss: 3.3598 - val_accuracy500: 0.3629 - 70s/epoch - 42ms/step
Epoch 10/50
1664/1664 - 71s - loss: 3.2080 - accuracy500: 0.4200 - val_loss: 3.3459 - val_accuracy500: 0.3633 - 71s/epoch - 43ms/step
Epoch 11/50
1664/1664 - 68s - loss: 3.1977 - accuracy500: 0.4227 - val_loss: 3.3726 - val_accuracy500: 0.3607 - 68s/epoch - 41ms/step
Epoch 12/50
1664/1664 - 68s - loss: 3.1935 - accuracy500: 0.4259 - val_loss: 3.3506 - val_accuracy500: 0.3663 - 68s/epoch - 41ms/step
testing model: results/WBA/W5/deepVOL_L3/h500
Evaluating performance on  test set...
7459/7459 - 146s - 146s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0861123
{'0': {'precision': 0.3801670708703853, 'recall': 0.009798882588438597, 'f1-score': 0.019105321674410543, 'support': 719878}, '1': {'precision': 0.18181818181818182, 'recall': 8.711104916547614e-06, 'f1-score': 1.7421375156247957e-05, 'support': 459184}, '2': {'precision': 0.3823937918435436, 'recall': 0.9901299526560932, 'f1-score': 0.551712928146187, 'support': 730189}, 'accuracy': 0.3823698403195808, 'macro avg': {'precision': 0.31479301484403693, 'recall': 0.3333125154498161, 'f1-score': 0.19027855706525124, 'support': 1909251}, 'weighted avg': {'precision': 0.3333148188040632, 'recall': 0.3823698403195808, 'f1-score': 0.21820924103912853, 'support': 1909251}}
[[  7054      5 712819]
 [  4307      4 454873]
 [  7194     13 722982]]
Evaluating performance on  train set...
1664/1664 - 37s - 37s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057851
{'0': {'precision': 0.3675909437802086, 'recall': 0.009999653991211378, 'f1-score': 0.019469670430353823, 'support': 144505}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 139201}, '2': {'precision': 0.33414291434948784, 'recall': 0.991290411016681, 'f1-score': 0.4998103798428456, 'support': 142257}, 'accuracy': 0.3344492362012663, 'macro avg': {'precision': 0.23391128604323216, 'recall': 0.3337633550026308, 'f1-score': 0.1730933500910665, 'support': 425963}, 'weighted avg': {'precision': 0.2362949314789645, 'recall': 0.3344492362012663, 'f1-score': 0.17352443740616427, 'support': 425963}}
[[  1445      2 143058]
 [  1248      0 137953]
 [  1238      1 141018]]
Evaluating performance on  val set...
517/517 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095329
{'0': {'precision': 0.3859504132231405, 'recall': 0.009764767381076843, 'f1-score': 0.019047619047619046, 'support': 47825}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 36839}, '2': {'precision': 0.3593986225432555, 'recall': 0.9906760397373295, 'f1-score': 0.5274487611918556, 'support': 47512}, 'accuracy': 0.3596416898680547, 'macro avg': {'precision': 0.24844967858879866, 'recall': 0.33348026903946876, 'f1-score': 0.1821654600798249, 'support': 132176}, 'weighted avg': {'precision': 0.2688372009038846, 'recall': 0.3596416898680547, 'f1-score': 0.196488756829529, 'support': 132176}}
[[  467     0 47358]
 [  300     0 36539]
 [  443     0 47069]]
training model: results/WBA/W5/deepVOL_L3/h1000
Epoch 1/50
1664/1664 - 72s - loss: 3.2652 - accuracy1000: 0.3930 - val_loss: 3.3420 - val_accuracy1000: 0.3473 - 72s/epoch - 43ms/step
Epoch 2/50
1664/1664 - 68s - loss: 3.2829 - accuracy1000: 0.3668 - val_loss: 3.3069 - val_accuracy1000: 0.3517 - 68s/epoch - 41ms/step
Epoch 3/50
1664/1664 - 67s - loss: 3.2777 - accuracy1000: 0.3697 - val_loss: 3.2918 - val_accuracy1000: 0.3533 - 67s/epoch - 41ms/step
Epoch 4/50
1664/1664 - 67s - loss: 3.2728 - accuracy1000: 0.3765 - val_loss: 3.2991 - val_accuracy1000: 0.3533 - 67s/epoch - 40ms/step
Epoch 5/50
1664/1664 - 67s - loss: 3.2583 - accuracy1000: 0.3898 - val_loss: 3.3056 - val_accuracy1000: 0.3474 - 67s/epoch - 40ms/step
Epoch 6/50
1664/1664 - 72s - loss: 3.2506 - accuracy1000: 0.3960 - val_loss: 3.3059 - val_accuracy1000: 0.3467 - 72s/epoch - 43ms/step
Epoch 7/50
1664/1664 - 72s - loss: 3.2381 - accuracy1000: 0.4048 - val_loss: 3.3025 - val_accuracy1000: 0.3535 - 72s/epoch - 43ms/step
Epoch 8/50
1664/1664 - 70s - loss: 3.2239 - accuracy1000: 0.4128 - val_loss: 3.3062 - val_accuracy1000: 0.3665 - 70s/epoch - 42ms/step
Epoch 9/50
1664/1664 - 73s - loss: 3.2174 - accuracy1000: 0.4183 - val_loss: 3.3911 - val_accuracy1000: 0.3548 - 73s/epoch - 44ms/step
Epoch 10/50
1664/1664 - 69s - loss: 3.2069 - accuracy1000: 0.4249 - val_loss: 3.4226 - val_accuracy1000: 0.3555 - 69s/epoch - 41ms/step
Epoch 11/50
1664/1664 - 68s - loss: 3.1975 - accuracy1000: 0.4287 - val_loss: 3.4440 - val_accuracy1000: 0.3525 - 68s/epoch - 41ms/step
Epoch 12/50
1664/1664 - 68s - loss: 3.1914 - accuracy1000: 0.4315 - val_loss: 3.4179 - val_accuracy1000: 0.3545 - 68s/epoch - 41ms/step
Epoch 13/50
1664/1664 - 68s - loss: 3.1928 - accuracy1000: 0.4301 - val_loss: 3.3899 - val_accuracy1000: 0.3530 - 68s/epoch - 41ms/step
testing model: results/WBA/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
7459/7459 - 146s - 146s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0845511
{'0': {'precision': 0.42651712923126284, 'recall': 0.037432066782544585, 'f1-score': 0.06882399108547518, 'support': 781282}, '1': {'precision': 0.17269439421338156, 'recall': 0.009206011621987186, 'f1-score': 0.017480187500178747, 'support': 331957}, '2': {'precision': 0.4171300085354374, 'recall': 0.9552908750119345, 'f1-score': 0.5806972126765941, 'support': 796012}, 'accuracy': 0.4152015633355698, 'macro avg': {'precision': 0.3387805106600273, 'recall': 0.3339763178054888, 'f1-score': 0.22233379708741605, 'support': 1909251}, 'weighted avg': {'precision': 0.37847185159743874, 'recall': 0.4152015633355698, 'f1-score': 0.2733090440504471, 'support': 1909251}}
[[ 29245   7170 744867]
 [ 11203   3056 317698]
 [ 28119   7470 760423]]
Evaluating performance on  train set...
1664/1664 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988044
{'0': {'precision': 0.3838140252724993, 'recall': 0.027937314816115034, 'f1-score': 0.05208353785840974, 'support': 142426}, '1': {'precision': 0.45210995603402226, 'recall': 0.07756621291054824, 'f1-score': 0.1324147060593297, 'support': 141853}, '2': {'precision': 0.3344587600540818, 'recall': 0.9236046413144745, 'f1-score': 0.49108441240432843, 'support': 141684}, 'accuracy': 0.34238185006678984, 'macro avg': {'precision': 0.39012758045353446, 'recall': 0.343036056347046, 'f1-score': 0.22519421877402265, 'support': 425963}, 'weighted avg': {'precision': 0.3901411740368475, 'recall': 0.34238185006678984, 'f1-score': 0.22485586106950797, 'support': 425963}}
[[  3979   6083 132364]
 [  2815  11003 128035]
 [  3573   7251 130860]]
Evaluating performance on  val set...
517/517 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972553
{'0': {'precision': 0.40520540954325085, 'recall': 0.03472480374363123, 'f1-score': 0.06396777442094662, 'support': 45731}, '1': {'precision': 0.4009216589861751, 'recall': 0.043003311749295635, 'f1-score': 0.07767510379000939, 'support': 40462}, '2': {'precision': 0.3497905856339324, 'recall': 0.9426309723158559, 'f1-score': 0.5102413184226016, 'support': 45983}, 'accuracy': 0.353112516644474, 'macro avg': {'precision': 0.38530588472111943, 'recall': 0.3401196959362609, 'f1-score': 0.21729473221118586, 'support': 132176}, 'weighted avg': {'precision': 0.3846156734121636, 'recall': 0.353112516644474, 'f1-score': 0.22341897838202213, 'support': 132176}}
[[ 1588  1192 42951]
 [ 1101  1740 37621]
 [ 1230  1408 43345]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        24 (peak)  17.79 (ave)

============================================
