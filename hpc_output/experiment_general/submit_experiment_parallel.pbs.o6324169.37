This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-05-22.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-14.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-01.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-02.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-10.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-06.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-08.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-03.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-24.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-07.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-20.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-09.csv
data/WBA_orderbooks/WBA_orderbooks_2019-04-30.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-16.csv
data/WBA_orderbooks/WBA_orderbooks_2019-05-15.csv
training model: results/WBA/W3/deepLOB_L1/h10
Epoch 1/50
2155/2155 - 49s - loss: 2.8103 - accuracy10: 0.4517 - val_loss: 2.6066 - val_accuracy10: 0.5471 - 49s/epoch - 23ms/step
Epoch 2/50
2155/2155 - 34s - loss: 2.6312 - accuracy10: 0.5146 - val_loss: 2.5737 - val_accuracy10: 0.6905 - 34s/epoch - 16ms/step
Epoch 3/50
2155/2155 - 34s - loss: 2.5172 - accuracy10: 0.5613 - val_loss: 2.4760 - val_accuracy10: 0.6754 - 34s/epoch - 16ms/step
Epoch 4/50
2155/2155 - 34s - loss: 2.4688 - accuracy10: 0.5762 - val_loss: 2.3834 - val_accuracy10: 0.6393 - 34s/epoch - 16ms/step
Epoch 5/50
2155/2155 - 33s - loss: 2.4371 - accuracy10: 0.5861 - val_loss: 2.3791 - val_accuracy10: 0.6094 - 33s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 2.4158 - accuracy10: 0.5924 - val_loss: 2.3670 - val_accuracy10: 0.6239 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 2.3987 - accuracy10: 0.5958 - val_loss: 2.3862 - val_accuracy10: 0.6222 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 33s - loss: 2.3847 - accuracy10: 0.5985 - val_loss: 2.4206 - val_accuracy10: 0.6307 - 33s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 2.3748 - accuracy10: 0.6001 - val_loss: 2.4139 - val_accuracy10: 0.5972 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 33s - loss: 2.3653 - accuracy10: 0.6018 - val_loss: 2.4220 - val_accuracy10: 0.5969 - 33s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 33s - loss: 2.3559 - accuracy10: 0.6032 - val_loss: 2.4632 - val_accuracy10: 0.5921 - 33s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 33s - loss: 2.3478 - accuracy10: 0.6049 - val_loss: 2.4513 - val_accuracy10: 0.5887 - 33s/epoch - 15ms/step
Epoch 13/50
2155/2155 - 33s - loss: 2.3428 - accuracy10: 0.6058 - val_loss: 2.5048 - val_accuracy10: 0.5628 - 33s/epoch - 15ms/step
Epoch 14/50
2155/2155 - 34s - loss: 2.3350 - accuracy10: 0.6080 - val_loss: 2.4226 - val_accuracy10: 0.5879 - 34s/epoch - 16ms/step
Epoch 15/50
2155/2155 - 33s - loss: 2.3286 - accuracy10: 0.6084 - val_loss: 2.4370 - val_accuracy10: 0.6207 - 33s/epoch - 15ms/step
Epoch 16/50
2155/2155 - 33s - loss: 2.3235 - accuracy10: 0.6090 - val_loss: 2.4118 - val_accuracy10: 0.6396 - 33s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h10
Evaluating performance on  test set...
6315/6315 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80979276
{'0': {'precision': 0.36101964979932544, 'recall': 0.5597782213351076, 'f1-score': 0.43894744713671324, 'support': 225450}, '1': {'precision': 0.8683005264659354, 'recall': 0.5743793146041201, 'f1-score': 0.6913992239497612, 'support': 1165808}, '2': {'precision': 0.32300566280202786, 'recall': 0.7110229856472928, 'f1-score': 0.4442129356684585, 'support': 225184}, 'accuracy': 0.5913784719773428, 'macro avg': {'precision': 0.5174419463557629, 'recall': 0.6150601738621736, 'f1-score': 0.5248532022516443, 'support': 1616442}, 'weighted avg': {'precision': 0.7215843731961115, 'recall': 0.5913784719773428, 'f1-score': 0.6217538854700394, 'support': 1616442}}
[[126202  56268  42980]
 [203592 669616 292600]
 [ 19777  45296 160111]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78513235
{'0': {'precision': 0.3914119348278289, 'recall': 0.568117536140792, 'f1-score': 0.46349380765973036, 'support': 89096}, '1': {'precision': 0.8134139286213019, 'recall': 0.6613751750463637, 'f1-score': 0.7295575727935301, 'support': 369902}, '2': {'precision': 0.41850815083154946, 'recall': 0.5492797942578045, 'f1-score': 0.47505876085849263, 'support': 92543}, 'accuracy': 0.6275018538966278, 'macro avg': {'precision': 0.5411113380935602, 'recall': 0.5929241684816534, 'f1-score': 0.5560367137705844, 'support': 551541}, 'weighted avg': {'precision': 0.6789824810353194, 'recall': 0.6275018538966278, 'f1-score': 0.6438752739775486, 'support': 551541}}
[[ 50617  26042  12437]
 [ 67067 244644  58191]
 [ 11635  30076  50832]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7721643
{'0': {'precision': 0.37871498020347816, 'recall': 0.5643812084547016, 'f1-score': 0.4532721492411973, 'support': 26778}, '1': {'precision': 0.8488567080558705, 'recall': 0.638206079333037, 'f1-score': 0.7286114831978567, 'support': 137219}, '2': {'precision': 0.3418762190390302, 'recall': 0.6092237545315244, 'f1-score': 0.437975227706279, 'support': 26757}, 'accuracy': 0.6237772209232834, 'macro avg': {'precision': 0.523149302432793, 'recall': 0.603937014106421, 'f1-score': 0.5399529533817776, 'support': 190754}, 'weighted avg': {'precision': 0.711744342742142, 'recall': 0.6237772209232834, 'f1-score': 0.6491919639590487, 'support': 190754}}
[[15113  7897  3768]
 [22033 87574 27612]
 [ 2760  7696 16301]]
training model: results/WBA/W3/deepLOB_L1/h20
Epoch 1/50
2155/2155 - 34s - loss: 2.9114 - accuracy20: 0.4740 - val_loss: 2.9737 - val_accuracy20: 0.4343 - 34s/epoch - 16ms/step
Epoch 2/50
2155/2155 - 32s - loss: 2.7348 - accuracy20: 0.5305 - val_loss: 2.6964 - val_accuracy20: 0.5045 - 32s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 33s - loss: 2.6371 - accuracy20: 0.5651 - val_loss: 2.6320 - val_accuracy20: 0.5370 - 33s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 2.5991 - accuracy20: 0.5761 - val_loss: 2.5497 - val_accuracy20: 0.5960 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 33s - loss: 2.5701 - accuracy20: 0.5830 - val_loss: 2.5559 - val_accuracy20: 0.6062 - 33s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 2.5506 - accuracy20: 0.5859 - val_loss: 2.6250 - val_accuracy20: 0.5779 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 2.5353 - accuracy20: 0.5889 - val_loss: 2.6425 - val_accuracy20: 0.5793 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 33s - loss: 2.5228 - accuracy20: 0.5910 - val_loss: 2.6456 - val_accuracy20: 0.5844 - 33s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 2.5133 - accuracy20: 0.5924 - val_loss: 2.6333 - val_accuracy20: 0.5942 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 2.5049 - accuracy20: 0.5937 - val_loss: 2.6042 - val_accuracy20: 0.6027 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 2.4967 - accuracy20: 0.5953 - val_loss: 2.6768 - val_accuracy20: 0.5808 - 32s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 33s - loss: 2.4902 - accuracy20: 0.5970 - val_loss: 2.6267 - val_accuracy20: 0.5875 - 33s/epoch - 15ms/step
Epoch 13/50
2155/2155 - 33s - loss: 2.4848 - accuracy20: 0.5980 - val_loss: 2.7105 - val_accuracy20: 0.5748 - 33s/epoch - 15ms/step
Epoch 14/50
2155/2155 - 32s - loss: 2.4794 - accuracy20: 0.5993 - val_loss: 2.7016 - val_accuracy20: 0.5866 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h20
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8772629
{'0': {'precision': 0.4385624143579954, 'recall': 0.5162295959765187, 'f1-score': 0.4742371019531155, 'support': 304413}, '1': {'precision': 0.7786786474689198, 'recall': 0.5504114378634021, 'f1-score': 0.6449429406129878, 'support': 1007321}, '2': {'precision': 0.3675541255944522, 'recall': 0.6587224490331728, 'f1-score': 0.47183412298321936, 'support': 304708}, 'accuracy': 0.5643914226430642, 'macro avg': {'precision': 0.5282650624737891, 'recall': 0.5751211609576979, 'f1-score': 0.5303380551831075, 'support': 1616442}, 'weighted avg': {'precision': 0.6371278008061128, 'recall': 0.5643914226430642, 'f1-score': 0.580163184787354, 'support': 1616442}}
[[157147  86349  60917]
 [168424 554441 284456]
 [ 32752  71238 200718]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8641987
{'0': {'precision': 0.4427308632687606, 'recall': 0.5381437014207576, 'f1-score': 0.48579672481990327, 'support': 118106}, '1': {'precision': 0.7016305987547656, 'recall': 0.6576620004370574, 'f1-score': 0.6789351805773965, 'support': 311172}, '2': {'precision': 0.4745679649213309, 'recall': 0.4514611943106255, 'f1-score': 0.4627262934196242, 'support': 122263}, 'accuracy': 0.5863589470229774, 'macro avg': {'precision': 0.5396431423149525, 'recall': 0.5490889653894802, 'f1-score': 0.542486066272308, 'support': 551541}, 'weighted avg': {'precision': 0.5958561033687702, 'recall': 0.5863589470229774, 'f1-score': 0.5896486948469337, 'support': 551541}}
[[ 63558  39702  14846]
 [ 60259 204646  46267]
 [ 19742  47324  55197]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8413164
{'0': {'precision': 0.45816594752764966, 'recall': 0.5126241607014039, 'f1-score': 0.4838675885187514, 'support': 36042}, '1': {'precision': 0.756625825074181, 'recall': 0.6335877217447158, 'f1-score': 0.6896621512844692, 'support': 118323}, '2': {'precision': 0.39333151560004675, 'recall': 0.5550028854873725, 'f1-score': 0.4603863908360404, 'support': 36389}, 'accuracy': 0.5957411115887478, 'macro avg': {'precision': 0.5360410960672924, 'recall': 0.5670715893111641, 'f1-score': 0.544638710213087, 'support': 190754}, 'weighted avg': {'precision': 0.6309298630813193, 'recall': 0.5957411115887478, 'f1-score': 0.6070407473917074, 'support': 190754}}
[[18476 12108  5458]
 [17663 74968 25692]
 [ 4187 12006 20196]]
training model: results/WBA/W3/deepLOB_L1/h30
Epoch 1/50
2155/2155 - 35s - loss: 2.9985 - accuracy30: 0.4651 - val_loss: 3.0043 - val_accuracy30: 0.4717 - 35s/epoch - 16ms/step
Epoch 2/50
2155/2155 - 32s - loss: 2.8625 - accuracy30: 0.5105 - val_loss: 2.8422 - val_accuracy30: 0.5256 - 32s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 32s - loss: 2.7489 - accuracy30: 0.5484 - val_loss: 2.7691 - val_accuracy30: 0.5693 - 32s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 2.7026 - accuracy30: 0.5621 - val_loss: 2.7993 - val_accuracy30: 0.5816 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 32s - loss: 2.6774 - accuracy30: 0.5692 - val_loss: 2.8356 - val_accuracy30: 0.5842 - 32s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 2.6606 - accuracy30: 0.5722 - val_loss: 2.8320 - val_accuracy30: 0.5801 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 32s - loss: 2.6462 - accuracy30: 0.5747 - val_loss: 2.8165 - val_accuracy30: 0.5888 - 32s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 32s - loss: 2.6348 - accuracy30: 0.5763 - val_loss: 2.8558 - val_accuracy30: 0.5865 - 32s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 2.6265 - accuracy30: 0.5783 - val_loss: 2.8255 - val_accuracy30: 0.5855 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 2.6191 - accuracy30: 0.5792 - val_loss: 2.8798 - val_accuracy30: 0.5852 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 2.6126 - accuracy30: 0.5801 - val_loss: 2.8691 - val_accuracy30: 0.5812 - 32s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 32s - loss: 2.6067 - accuracy30: 0.5816 - val_loss: 2.8522 - val_accuracy30: 0.5802 - 32s/epoch - 15ms/step
Epoch 13/50
2155/2155 - 32s - loss: 2.6013 - accuracy30: 0.5824 - val_loss: 2.8546 - val_accuracy30: 0.5758 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h30
Evaluating performance on  test set...
6315/6315 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90256166
{'0': {'precision': 0.5036784704352825, 'recall': 0.36070306693889054, 'f1-score': 0.4203661489323339, 'support': 361957}, '1': {'precision': 0.6659761335241098, 'recall': 0.6153315691507255, 'f1-score': 0.6396529707935735, 'support': 891820}, '2': {'precision': 0.4089229788271478, 'recall': 0.601243571891415, 'f1-score': 0.4867757940383639, 'support': 362665}, 'accuracy': 0.5551538502464054, 'macro avg': {'precision': 0.5261925275955134, 'recall': 0.5257594026603437, 'f1-score': 0.5155983045880904, 'support': 1616442}, 'weighted avg': {'precision': 0.5719616513547425, 'recall': 0.5551538502464054, 'f1-score': 0.5562502866958102, 'support': 1616442}}
[[130559 158270  73128]
 [101003 548765 242052]
 [ 27649 116966 218050]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92794144
{'0': {'precision': 0.49333390676070876, 'recall': 0.4148223688017127, 'f1-score': 0.45068441482924987, 'support': 138264}, '1': {'precision': 0.5898746208228799, 'recall': 0.7064068972908252, 'f1-score': 0.642902787493946, 'support': 270599}, '2': {'precision': 0.5003506437459541, 'recall': 0.390046117831761, 'f1-score': 0.43836598372600444, 'support': 142678}, 'accuracy': 0.5514712414852205, 'macro avg': {'precision': 0.5278530571098475, 'recall': 0.5037584613080996, 'f1-score': 0.5106510620164001, 'support': 551541}, 'weighted avg': {'precision': 0.542514211913164, 'recall': 0.5514712414852205, 'f1-score': 0.5418046222331333, 'support': 551541}}
[[ 57355  63966  16943]
 [ 40816 191153  38630]
 [ 18089  68938  55651]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8909581
{'0': {'precision': 0.5192783309024035, 'recall': 0.38142817216321967, 'f1-score': 0.43980449552864087, 'support': 42936}, '1': {'precision': 0.6493520866958727, 'recall': 0.6743805135966131, 'f1-score': 0.6616296881020176, 'support': 104401}, '2': {'precision': 0.43027307987635605, 'recall': 0.5033512218716171, 'f1-score': 0.46395210597826086, 'support': 43417}, 'accuracy': 0.5695136143934072, 'macro avg': {'precision': 0.5329678324915441, 'recall': 0.5197199692104832, 'f1-score': 0.5217954298696398, 'support': 190754}, 'weighted avg': {'precision': 0.5702103648036381, 'recall': 0.5695136143934072, 'f1-score': 0.5667071488556706, 'support': 190754}}
[[16377 20132  6427]
 [11485 70406 22510]
 [ 3676 17887 21854]]
training model: results/WBA/W3/deepLOB_L1/h50
Epoch 1/50
2155/2155 - 35s - loss: 3.0705 - accuracy50: 0.4715 - val_loss: 3.1998 - val_accuracy50: 0.4239 - 35s/epoch - 16ms/step
Epoch 2/50
2155/2155 - 32s - loss: 2.9776 - accuracy50: 0.5017 - val_loss: 3.2045 - val_accuracy50: 0.4444 - 32s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 33s - loss: 2.9106 - accuracy50: 0.5193 - val_loss: 3.2342 - val_accuracy50: 0.4450 - 33s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 33s - loss: 2.8626 - accuracy50: 0.5307 - val_loss: 3.4071 - val_accuracy50: 0.4245 - 33s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 32s - loss: 2.8381 - accuracy50: 0.5363 - val_loss: 3.2683 - val_accuracy50: 0.4402 - 32s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 2.8226 - accuracy50: 0.5391 - val_loss: 3.3328 - val_accuracy50: 0.4348 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 2.8110 - accuracy50: 0.5418 - val_loss: 3.2996 - val_accuracy50: 0.4404 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 32s - loss: 2.8021 - accuracy50: 0.5432 - val_loss: 3.3255 - val_accuracy50: 0.4448 - 32s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 2.7947 - accuracy50: 0.5442 - val_loss: 3.3798 - val_accuracy50: 0.4361 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 2.7886 - accuracy50: 0.5456 - val_loss: 3.3560 - val_accuracy50: 0.4396 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 2.7829 - accuracy50: 0.5466 - val_loss: 3.4432 - val_accuracy50: 0.4351 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h50
Evaluating performance on  test set...
6315/6315 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0848907
{'0': {'precision': 0.3668819695303911, 'recall': 0.3332144608389426, 'f1-score': 0.34923868303143846, 'support': 448660}, '1': {'precision': 0.4767485747204068, 'recall': 0.36630951488964925, 'f1-score': 0.41429538790367315, 'support': 720702}, '2': {'precision': 0.3566512973841695, 'recall': 0.5226782678715218, 'f1-score': 0.4239909351772639, 'support': 447080}, 'accuracy': 0.4003725466178186, 'macro avg': {'precision': 0.4000939472116558, 'recall': 0.40740074786670455, 'f1-score': 0.3958416687041251, 'support': 1616442}, 'weighted avg': {'precision': 0.4130371382221982, 'recall': 0.4003725466178186, 'f1-score': 0.3989198557578245, 'support': 1616442}}
[[149500 146500 152660]
 [187838 264000 268864]
 [ 70150 143251 233679]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737455
{'0': {'precision': 0.4216845324745982, 'recall': 0.34489082916914715, 'f1-score': 0.37944117520582965, 'support': 166299}, '1': {'precision': 0.4324956518938418, 'recall': 0.5025166764901251, 'f1-score': 0.4648843036364188, 'support': 213774}, '2': {'precision': 0.43495091029836724, 'recall': 0.4239799846035412, 'f1-score': 0.4293953829025047, 'support': 171468}, 'accuracy': 0.4305736110280106, 'macro avg': {'precision': 0.42971036488893577, 'recall': 0.4237958300876045, 'f1-score': 0.42457362058158443, 'support': 551541}, 'weighted avg': {'precision': 0.429999228055553, 'recall': 0.4305736110280106, 'f1-score': 0.4280886328244912, 'support': 551541}}
[[ 57355  67890  41054]
 [ 52959 107425  53390]
 [ 25700  73069  72699]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0666003
{'0': {'precision': 0.3629798428310518, 'recall': 0.40627520114026366, 'f1-score': 0.3834091432010053, 'support': 53321}, '1': {'precision': 0.47636070814167714, 'recall': 0.4669098301841665, 'f1-score': 0.4715879237352112, 'support': 83620}, '2': {'precision': 0.4140128685453657, 'recall': 0.37784550201624145, 'f1-score': 0.3951032305076512, 'support': 53813}, 'accuracy': 0.4248351279658618, 'macro avg': {'precision': 0.41778447317269823, 'recall': 0.4170101777802239, 'f1-score': 0.4167000991479559, 'support': 190754}, 'weighted avg': {'precision': 0.42707888227472723, 'recall': 0.4248351279658618, 'f1-score': 0.4253626726080051, 'support': 190754}}
[[21663 20275 11383]
 [27181 39043 17396]
 [10837 22643 20333]]
training model: results/WBA/W3/deepLOB_L1/h100
Epoch 1/50
2155/2155 - 35s - loss: 3.2048 - accuracy100: 0.4254 - val_loss: 3.3327 - val_accuracy100: 0.3818 - 35s/epoch - 16ms/step
Epoch 2/50
2155/2155 - 32s - loss: 3.1580 - accuracy100: 0.4436 - val_loss: 3.4131 - val_accuracy100: 0.3734 - 32s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 33s - loss: 3.1348 - accuracy100: 0.4513 - val_loss: 3.4668 - val_accuracy100: 0.3781 - 33s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 33s - loss: 3.1178 - accuracy100: 0.4570 - val_loss: 3.4779 - val_accuracy100: 0.3825 - 33s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 33s - loss: 3.1053 - accuracy100: 0.4615 - val_loss: 3.3676 - val_accuracy100: 0.3882 - 33s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 3.0964 - accuracy100: 0.4643 - val_loss: 3.3830 - val_accuracy100: 0.3851 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 3.0899 - accuracy100: 0.4666 - val_loss: 3.3149 - val_accuracy100: 0.3909 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 32s - loss: 3.0842 - accuracy100: 0.4682 - val_loss: 3.3103 - val_accuracy100: 0.3894 - 32s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 33s - loss: 3.0797 - accuracy100: 0.4705 - val_loss: 3.2862 - val_accuracy100: 0.3949 - 33s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 3.0752 - accuracy100: 0.4714 - val_loss: 3.2827 - val_accuracy100: 0.3954 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 3.0717 - accuracy100: 0.4725 - val_loss: 3.3068 - val_accuracy100: 0.3909 - 32s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 32s - loss: 3.0686 - accuracy100: 0.4733 - val_loss: 3.3023 - val_accuracy100: 0.3917 - 32s/epoch - 15ms/step
Epoch 13/50
2155/2155 - 32s - loss: 3.0650 - accuracy100: 0.4747 - val_loss: 3.3213 - val_accuracy100: 0.3911 - 32s/epoch - 15ms/step
Epoch 14/50
2155/2155 - 33s - loss: 3.0628 - accuracy100: 0.4746 - val_loss: 3.3300 - val_accuracy100: 0.3879 - 33s/epoch - 15ms/step
Epoch 15/50
2155/2155 - 33s - loss: 3.0600 - accuracy100: 0.4763 - val_loss: 3.3085 - val_accuracy100: 0.3904 - 33s/epoch - 16ms/step
Epoch 16/50
2155/2155 - 33s - loss: 3.0578 - accuracy100: 0.4765 - val_loss: 3.3223 - val_accuracy100: 0.3914 - 33s/epoch - 15ms/step
Epoch 17/50
2155/2155 - 33s - loss: 3.0559 - accuracy100: 0.4775 - val_loss: 3.3257 - val_accuracy100: 0.3900 - 33s/epoch - 15ms/step
Epoch 18/50
2155/2155 - 33s - loss: 3.0538 - accuracy100: 0.4775 - val_loss: 3.3410 - val_accuracy100: 0.3885 - 33s/epoch - 15ms/step
Epoch 19/50
2155/2155 - 32s - loss: 3.0517 - accuracy100: 0.4789 - val_loss: 3.3194 - val_accuracy100: 0.3901 - 32s/epoch - 15ms/step
Epoch 20/50
2155/2155 - 33s - loss: 3.0499 - accuracy100: 0.4796 - val_loss: 3.3615 - val_accuracy100: 0.3861 - 33s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h100
Evaluating performance on  test set...
6315/6315 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1135978
{'0': {'precision': 0.41457316730041077, 'recall': 0.09867986735527623, 'f1-score': 0.15941464500333855, 'support': 522599}, '1': {'precision': 0.40440737499203033, 'recall': 0.23881067001637776, 'f1-score': 0.3002925584282974, 'support': 584329}, '2': {'precision': 0.3422162859168032, 'recall': 0.7703792241233803, 'f1-score': 0.4739122429452371, 'support': 509514}, 'accuracy': 0.3610602793047941, 'macro avg': {'precision': 0.3870656094030814, 'recall': 0.3692899204983448, 'f1-score': 0.31120648212562435, 'support': 1616442}, 'weighted avg': {'precision': 0.3880909233875137, 'recall': 0.3610602793047941, 'f1-score': 0.30947259907249863, 'support': 1616442}}
[[ 51570 114510 356519]
 [ 46832 139544 397953]
 [ 25991  91004 392519]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102716
{'0': {'precision': 0.4688375688472316, 'recall': 0.18561997201818817, 'f1-score': 0.2659473257666814, 'support': 182976}, '1': {'precision': 0.3739532498039376, 'recall': 0.5528988294773863, 'f1-score': 0.44615169716440845, 'support': 181970}, '2': {'precision': 0.402987845808875, 'recall': 0.4536455960770653, 'f1-score': 0.4268188762775876, 'support': 186595}, 'accuracy': 0.39747362390103363, 'macro avg': {'precision': 0.4152595548200147, 'recall': 0.39738813252421323, 'f1-score': 0.37963929973622584, 'support': 551541}, 'weighted avg': {'precision': 0.41525437447609626, 'recall': 0.39747362390103363, 'f1-score': 0.3798275566666996, 'support': 551541}}
[[ 33964  82039  66973]
 [ 22929 100611  58430]
 [ 15550  86397  84648]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934315
{'0': {'precision': 0.4408098271155596, 'recall': 0.15662280559956032, 'f1-score': 0.231125211707736, 'support': 61862}, '1': {'precision': 0.4050102754871101, 'recall': 0.46645893879018485, 'f1-score': 0.4335681862485728, 'support': 66754}, '2': {'precision': 0.37902102468114746, 'recall': 0.560510476680936, 'f1-score': 0.45223657729013833, 'support': 62138}, 'accuracy': 0.39661553624039336, 'macro avg': {'precision': 0.40828037576127235, 'recall': 0.3945307403568938, 'f1-score': 0.3723099917488157, 'support': 190754}, 'weighted avg': {'precision': 0.40815417703705525, 'recall': 0.39661553624039336, 'f1-score': 0.37399663960470453, 'support': 190754}}
[[ 9689 23192 28981]
 [ 7534 31138 28082]
 [ 4757 22552 34829]]
training model: results/WBA/W3/deepLOB_L1/h200
Epoch 1/50
2155/2155 - 36s - loss: 3.2644 - accuracy200: 0.3898 - val_loss: 3.3378 - val_accuracy200: 0.3583 - 36s/epoch - 17ms/step
Epoch 2/50
2155/2155 - 33s - loss: 3.2386 - accuracy200: 0.4051 - val_loss: 3.3982 - val_accuracy200: 0.3523 - 33s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 32s - loss: 3.2271 - accuracy200: 0.4104 - val_loss: 3.3609 - val_accuracy200: 0.3578 - 32s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 3.2190 - accuracy200: 0.4141 - val_loss: 3.4122 - val_accuracy200: 0.3512 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 32s - loss: 3.2129 - accuracy200: 0.4166 - val_loss: 3.4020 - val_accuracy200: 0.3531 - 32s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 33s - loss: 3.2085 - accuracy200: 0.4191 - val_loss: 3.4052 - val_accuracy200: 0.3500 - 33s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 3.2035 - accuracy200: 0.4220 - val_loss: 3.3731 - val_accuracy200: 0.3494 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 33s - loss: 3.2002 - accuracy200: 0.4237 - val_loss: 3.3812 - val_accuracy200: 0.3465 - 33s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 3.1975 - accuracy200: 0.4250 - val_loss: 3.3880 - val_accuracy200: 0.3480 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 3.1942 - accuracy200: 0.4263 - val_loss: 3.4111 - val_accuracy200: 0.3548 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 3.1908 - accuracy200: 0.4274 - val_loss: 3.4149 - val_accuracy200: 0.3556 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h200
Evaluating performance on  test set...
6315/6315 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1238405
{'0': {'precision': 0.3796442388743597, 'recall': 0.031362935135057925, 'f1-score': 0.05793941513021937, 'support': 560056}, '1': {'precision': 0.32311850542683446, 'recall': 0.7503429777588785, 'f1-score': 0.45171569791484467, 'support': 519713}, '2': {'precision': 0.3550241947470699, 'recall': 0.24033443083590939, 'f1-score': 0.2866324064557349, 'support': 536673}, 'accuracy': 0.33190736197153997, 'macro avg': {'precision': 0.35259564634942137, 'recall': 0.34068011457661523, 'f1-score': 0.265429173166933, 'support': 1616442}, 'weighted avg': {'precision': 0.35329620322004074, 'recall': 0.33190736197153997, 'f1-score': 0.2604731323860716, 'support': 1616442}}
[[ 17565 421249 121242]
 [ 16671 389963 113079]
 [ 12031 395661 128981]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135943
{'0': {'precision': 0.37178687502051805, 'recall': 0.2476817426296912, 'f1-score': 0.2973026186257137, 'support': 182896}, '1': {'precision': 0.3413306377133799, 'recall': 0.5578014379013226, 'f1-score': 0.42350779308175185, 'support': 182210}, '2': {'precision': 0.37519138937315244, 'recall': 0.26550272212835574, 'f1-score': 0.3109575487255195, 'support': 186435}, 'accuracy': 0.35615847235291664, 'macro avg': {'precision': 0.36276963403568346, 'recall': 0.35699530088645653, 'f1-score': 0.34392265347766166, 'support': 551541}, 'weighted avg': {'precision': 0.36287600462937714, 'recall': 0.35615847235291664, 'f1-score': 0.34361214363073056, 'support': 551541}}
[[ 45300  95822  41774]
 [ 39916 101637  40657]
 [ 36628 100308  49499]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.113154
{'0': {'precision': 0.4069052960109236, 'recall': 0.0657401279505846, 'f1-score': 0.11319270162110832, 'support': 63462}, '1': {'precision': 0.3472683298545539, 'recall': 0.816298557677331, 'f1-score': 0.4872511238070446, 'support': 64202}, '2': {'precision': 0.3971472993983641, 'recall': 0.18624187668410208, 'f1-score': 0.2535715827182874, 'support': 63090}, 'accuracy': 0.3582100506411399, 'macro avg': {'precision': 0.38377364175461387, 'recall': 0.3560935207706725, 'f1-score': 0.2846718027154801, 'support': 190754}, 'weighted avg': {'precision': 0.3836059444510212, 'recall': 0.3582100506411399, 'f1-score': 0.2855183274512482, 'support': 190754}}
[[ 4172 49870  9420]
 [ 3378 52408  8416]
 [ 2703 48637 11750]]
training model: results/WBA/W3/deepLOB_L1/h300
Epoch 1/50
2155/2155 - 34s - loss: 3.2790 - accuracy300: 0.3807 - val_loss: 3.3911 - val_accuracy300: 0.3433 - 34s/epoch - 16ms/step
Epoch 2/50
2155/2155 - 32s - loss: 3.2532 - accuracy300: 0.3930 - val_loss: 3.3600 - val_accuracy300: 0.3487 - 32s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 32s - loss: 3.2417 - accuracy300: 0.3994 - val_loss: 3.3408 - val_accuracy300: 0.3398 - 32s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 3.2347 - accuracy300: 0.4042 - val_loss: 3.3498 - val_accuracy300: 0.3465 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 32s - loss: 3.2288 - accuracy300: 0.4080 - val_loss: 3.3794 - val_accuracy300: 0.3457 - 32s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 3.2228 - accuracy300: 0.4118 - val_loss: 3.3659 - val_accuracy300: 0.3423 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 33s - loss: 3.2184 - accuracy300: 0.4134 - val_loss: 3.3665 - val_accuracy300: 0.3460 - 33s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 33s - loss: 3.2145 - accuracy300: 0.4162 - val_loss: 3.3559 - val_accuracy300: 0.3463 - 33s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 3.2107 - accuracy300: 0.4170 - val_loss: 3.3867 - val_accuracy300: 0.3443 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 3.2078 - accuracy300: 0.4183 - val_loss: 3.3774 - val_accuracy300: 0.3452 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 33s - loss: 3.2046 - accuracy300: 0.4199 - val_loss: 3.3926 - val_accuracy300: 0.3481 - 33s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 33s - loss: 3.2027 - accuracy300: 0.4208 - val_loss: 3.3884 - val_accuracy300: 0.3477 - 33s/epoch - 15ms/step
Epoch 13/50
2155/2155 - 32s - loss: 3.1995 - accuracy300: 0.4217 - val_loss: 3.4057 - val_accuracy300: 0.3478 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h300
Evaluating performance on  test set...
6315/6315 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113024
{'0': {'precision': 0.3484483234341645, 'recall': 0.17015927722463337, 'f1-score': 0.2286573308619975, 'support': 564048}, '1': {'precision': 0.32180219121397197, 'recall': 0.5883426048531281, 'f1-score': 0.4160435575622725, 'support': 521849}, '2': {'precision': 0.3350891022576018, 'recall': 0.24437323883930676, 'f1-score': 0.28263030540841017, 'support': 530545}, 'accuracy': 0.3295231131089145, 'macro avg': {'precision': 0.3351132056352461, 'recall': 0.33429170697235605, 'f1-score': 0.30911039794422673, 'support': 1616442}, 'weighted avg': {'precision': 0.33546120391357875, 'recall': 0.3295231131089145, 'f1-score': 0.30686762655960886, 'support': 1616442}}
[[ 95978 337232 130838]
 [ 88397 307026 126426]
 [ 91069 309825 129651]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1273273
{'0': {'precision': 0.34039410347685317, 'recall': 0.43350960565675567, 'f1-score': 0.38135006157635465, 'support': 182861}, '1': {'precision': 0.32668543285392704, 'recall': 0.4218282902937575, 'f1-score': 0.3682101031498622, 'support': 181306}, '2': {'precision': 0.36531478787448696, 'recall': 0.16484144011442356, 'f1-score': 0.22717460457556, 'support': 187374}, 'accuracy': 0.33839551366081577, 'macro avg': {'precision': 0.3441314414017557, 'recall': 0.3400597786883122, 'f1-score': 0.32557825643392563, 'support': 551541}, 'weighted avg': {'precision': 0.3443539615515239, 'recall': 0.33839551366081577, 'f1-score': 0.32465287064668563, 'support': 551541}}
[[79272 77468 26121]
 [77285 76480 27541]
 [76326 80161 30887]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1143633
{'0': {'precision': 0.35347322062275927, 'recall': 0.29893955950933465, 'f1-score': 0.3239272193592502, 'support': 64973}, '1': {'precision': 0.32512263855547435, 'recall': 0.4550471522017887, 'f1-score': 0.379266494406039, 'support': 61609}, '2': {'precision': 0.3496046474100371, 'recall': 0.27008664214922395, 'f1-score': 0.30474381967155467, 'support': 64172}, 'accuracy': 0.33965211738679135, 'macro avg': {'precision': 0.3427335021960902, 'recall': 0.34135778462011573, 'f1-score': 0.3359791778122813, 'support': 190754}, 'weighted avg': {'precision': 0.34301522188726663, 'recall': 0.33965211738679135, 'f1-score': 0.3353469551005652, 'support': 190754}}
[[19423 29169 16381]
 [17711 28035 15863]
 [17815 29025 17332]]
training model: results/WBA/W3/deepLOB_L1/h500
Epoch 1/50
2155/2155 - 85s - loss: 3.2227 - accuracy500: 0.4230 - val_loss: 3.3484 - val_accuracy500: 0.3622 - 85s/epoch - 40ms/step
Epoch 2/50
2155/2155 - 33s - loss: 3.1949 - accuracy500: 0.4365 - val_loss: 3.3453 - val_accuracy500: 0.3525 - 33s/epoch - 15ms/step
Epoch 3/50
2155/2155 - 33s - loss: 3.1798 - accuracy500: 0.4435 - val_loss: 3.3535 - val_accuracy500: 0.3265 - 33s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 3.1642 - accuracy500: 0.4502 - val_loss: 3.3903 - val_accuracy500: 0.3183 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 33s - loss: 3.1555 - accuracy500: 0.4528 - val_loss: 3.4316 - val_accuracy500: 0.3160 - 33s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 32s - loss: 3.1483 - accuracy500: 0.4558 - val_loss: 3.5344 - val_accuracy500: 0.3129 - 32s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 32s - loss: 3.1411 - accuracy500: 0.4583 - val_loss: 3.4781 - val_accuracy500: 0.3128 - 32s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 33s - loss: 3.1342 - accuracy500: 0.4604 - val_loss: 3.5614 - val_accuracy500: 0.3172 - 33s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 3.1288 - accuracy500: 0.4624 - val_loss: 3.4925 - val_accuracy500: 0.3268 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 32s - loss: 3.1237 - accuracy500: 0.4637 - val_loss: 3.5201 - val_accuracy500: 0.3223 - 32s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 33s - loss: 3.1200 - accuracy500: 0.4653 - val_loss: 3.5716 - val_accuracy500: 0.3191 - 33s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 34s - loss: 3.1159 - accuracy500: 0.4663 - val_loss: 3.6040 - val_accuracy500: 0.3263 - 34s/epoch - 16ms/step
testing model: results/WBA/W3/deepLOB_L1/h500
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151091
{'0': {'precision': 0.41894605479607466, 'recall': 0.05885643702434554, 'f1-score': 0.10321282334362815, 'support': 627425}, '1': {'precision': 0.252381237093488, 'recall': 0.13354473353110527, 'f1-score': 0.17466658178693065, 'support': 410911}, '2': {'precision': 0.3603917404345823, 'recall': 0.8171961543384777, 'f1-score': 0.5001932265875549, 'support': 578106}, 'accuracy': 0.34905613687345416, 'macro avg': {'precision': 0.3439063441080483, 'recall': 0.3365324416313095, 'f1-score': 0.2593575439060379, 'support': 1616442}, 'weighted avg': {'precision': 0.35566267298265203, 'recall': 0.34905613687345416, 'f1-score': 0.263353359368694, 'support': 1616442}}
[[ 36928  83139 507358]
 [ 24952  54875 331084]
 [ 26265  79415 472426]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1144993
{'0': {'precision': 0.3106821787414067, 'recall': 0.263955246778294, 'f1-score': 0.28541890074472565, 'support': 182512}, '1': {'precision': 0.42307371531376964, 'recall': 0.1948581462986336, 'f1-score': 0.26682346399359785, 'support': 182230}, '2': {'precision': 0.37590706067548024, 'recall': 0.6289594698044422, 'f1-score': 0.4705705651580964, 'support': 186799}, 'accuracy': 0.36474713575237383, 'macro avg': {'precision': 0.36988765157688547, 'recall': 0.3625909542937899, 'f1-score': 0.34093764329880666, 'support': 551541}, 'weighted avg': {'precision': 0.3699072452912819, 'recall': 0.36474713575237383, 'f1-score': 0.34198314405863206, 'support': 551541}}
[[ 48175  24416 109921]
 [ 61583  35509  85138]
 [ 45304  24006 117489]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1147175
{'0': {'precision': 0.3586394236447384, 'recall': 0.21408931316008403, 'f1-score': 0.2681229802037897, 'support': 70919}, '1': {'precision': 0.28218104333929456, 'recall': 0.14347624206779136, 'f1-score': 0.19022945016609163, 'support': 51688}, '2': {'precision': 0.3666508375771668, 'recall': 0.6571382452639147, 'f1-score': 0.4706834485114433, 'support': 68147}, 'accuracy': 0.353235056669847, 'macro avg': {'precision': 0.3358237681870666, 'recall': 0.33823460016393003, 'f1-score': 0.3096786262937749, 'support': 190754}, 'weighted avg': {'precision': 0.3407838246220464, 'recall': 0.353235056669847, 'f1-score': 0.3193812890894389, 'support': 190754}}
[[15183  9670 46066]
 [12982  7416 31290]
 [14170  9195 44782]]
training model: results/WBA/W3/deepLOB_L1/h1000
Epoch 1/50
2155/2155 - 37s - loss: 3.2399 - accuracy1000: 0.4115 - val_loss: 3.4191 - val_accuracy1000: 0.3472 - 37s/epoch - 17ms/step
Epoch 2/50
2155/2155 - 34s - loss: 3.1893 - accuracy1000: 0.4293 - val_loss: 3.4189 - val_accuracy1000: 0.3096 - 34s/epoch - 16ms/step
Epoch 3/50
2155/2155 - 33s - loss: 3.1686 - accuracy1000: 0.4385 - val_loss: 3.4759 - val_accuracy1000: 0.3385 - 33s/epoch - 15ms/step
Epoch 4/50
2155/2155 - 32s - loss: 3.1580 - accuracy1000: 0.4433 - val_loss: 3.4949 - val_accuracy1000: 0.3531 - 32s/epoch - 15ms/step
Epoch 5/50
2155/2155 - 32s - loss: 3.1454 - accuracy1000: 0.4495 - val_loss: 3.6355 - val_accuracy1000: 0.3535 - 32s/epoch - 15ms/step
Epoch 6/50
2155/2155 - 33s - loss: 3.1359 - accuracy1000: 0.4509 - val_loss: 3.4753 - val_accuracy1000: 0.3440 - 33s/epoch - 15ms/step
Epoch 7/50
2155/2155 - 32s - loss: 3.1229 - accuracy1000: 0.4563 - val_loss: 3.6193 - val_accuracy1000: 0.3450 - 32s/epoch - 15ms/step
Epoch 8/50
2155/2155 - 32s - loss: 3.1151 - accuracy1000: 0.4590 - val_loss: 3.6011 - val_accuracy1000: 0.3538 - 32s/epoch - 15ms/step
Epoch 9/50
2155/2155 - 32s - loss: 3.1032 - accuracy1000: 0.4627 - val_loss: 3.7598 - val_accuracy1000: 0.3519 - 32s/epoch - 15ms/step
Epoch 10/50
2155/2155 - 33s - loss: 3.0992 - accuracy1000: 0.4643 - val_loss: 3.7597 - val_accuracy1000: 0.3510 - 33s/epoch - 15ms/step
Epoch 11/50
2155/2155 - 32s - loss: 3.0926 - accuracy1000: 0.4665 - val_loss: 3.7802 - val_accuracy1000: 0.3544 - 32s/epoch - 15ms/step
Epoch 12/50
2155/2155 - 32s - loss: 3.0890 - accuracy1000: 0.4678 - val_loss: 3.9048 - val_accuracy1000: 0.3561 - 32s/epoch - 15ms/step
testing model: results/WBA/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
6315/6315 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402094
{'0': {'precision': 0.5241698637385898, 'recall': 0.028796397506860784, 'f1-score': 0.054593579446733986, 'support': 687968}, '1': {'precision': 0.18989218424289353, 'recall': 0.5311897403386427, 'f1-score': 0.279770651854454, 'support': 302856}, '2': {'precision': 0.3885442969618339, 'recall': 0.4542788091135485, 'f1-score': 0.41884812895933105, 'support': 625618}, 'accuracy': 0.2876007923575359, 'macro avg': {'precision': 0.3675354483144391, 'recall': 0.3380883156530174, 'f1-score': 0.2510707867535063, 'support': 1616442}, 'weighted avg': {'precision': 0.40904801170981975, 'recall': 0.2876007923575359, 'f1-score': 0.23776156827533682, 'support': 1616442}}
[[ 19811 356076 312081]
 [  6807 160874 135175]
 [ 11177 330236 284205]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1736851
{'0': {'precision': 0.3223659370129053, 'recall': 0.36661161574456375, 'f1-score': 0.34306806239568094, 'support': 181650}, '1': {'precision': 0.29097773815313127, 'recall': 0.2369535564209183, 'f1-score': 0.2612014502770806, 'support': 181812}, '2': {'precision': 0.36086804162455627, 'recall': 0.3777986909756007, 'f1-score': 0.3691393363845582, 'support': 188079}, 'accuracy': 0.32768552111266436, 'macro avg': {'precision': 0.3247372389301976, 'recall': 0.32712128771369425, 'f1-score': 0.3244696163524399, 'support': 551541}, 'weighted avg': {'precision': 0.3251484792394333, 'recall': 0.32768552111266436, 'f1-score': 0.32497172260960355, 'support': 551541}}
[[66595 50066 64989]
 [77873 43081 60858]
 [62114 54909 71056]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1404696
{'0': {'precision': 0.29943290241083664, 'recall': 0.16363609658656952, 'f1-score': 0.21162302570969976, 'support': 68084}, '1': {'precision': 0.2622629005839179, 'recall': 0.3690832306880169, 'f1-score': 0.3066363563267961, 'support': 56830}, '2': {'precision': 0.3682479271442164, 'recall': 0.4114823815309842, 'f1-score': 0.3886665232049351, 'support': 65840}, 'accuracy': 0.3103892972100192, 'macro avg': {'precision': 0.309981243379657, 'recall': 0.31473390293519027, 'f1-score': 0.30230863508047695, 'support': 190754}, 'weighted avg': {'precision': 0.3121110639415093, 'recall': 0.3103892972100192, 'f1-score': 0.30103740996405814, 'support': 190754}}
[[11141 30455 26488]
 [15865 20975 19990]
 [10201 28547 27092]]
training model: results/WBA/W3/deepOF_L1/h10
Epoch 1/50
2155/2155 - 32s - loss: 3.1187 - accuracy10: 0.3881 - val_loss: 2.8722 - val_accuracy10: 0.6401 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.0824 - accuracy10: 0.3692 - val_loss: 2.8375 - val_accuracy10: 0.6370 - 29s/epoch - 14ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.0596 - accuracy10: 0.3768 - val_loss: 2.8165 - val_accuracy10: 0.6266 - 29s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 29s - loss: 3.0438 - accuracy10: 0.3908 - val_loss: 2.8112 - val_accuracy10: 0.6388 - 29s/epoch - 13ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.0310 - accuracy10: 0.4024 - val_loss: 2.7964 - val_accuracy10: 0.6362 - 29s/epoch - 13ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.0193 - accuracy10: 0.4127 - val_loss: 2.7931 - val_accuracy10: 0.6320 - 29s/epoch - 13ms/step
Epoch 7/50
2155/2155 - 28s - loss: 3.0074 - accuracy10: 0.4232 - val_loss: 2.7923 - val_accuracy10: 0.6453 - 28s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 2.9979 - accuracy10: 0.4281 - val_loss: 2.7842 - val_accuracy10: 0.6459 - 29s/epoch - 13ms/step
Epoch 9/50
2155/2155 - 29s - loss: 2.9907 - accuracy10: 0.4326 - val_loss: 2.7753 - val_accuracy10: 0.6407 - 29s/epoch - 14ms/step
Epoch 10/50
2155/2155 - 29s - loss: 2.9841 - accuracy10: 0.4361 - val_loss: 2.7726 - val_accuracy10: 0.6436 - 29s/epoch - 14ms/step
Epoch 11/50
2155/2155 - 29s - loss: 2.9756 - accuracy10: 0.4384 - val_loss: 2.7734 - val_accuracy10: 0.6465 - 29s/epoch - 13ms/step
Epoch 12/50
2155/2155 - 29s - loss: 2.9689 - accuracy10: 0.4407 - val_loss: 2.7723 - val_accuracy10: 0.6422 - 29s/epoch - 13ms/step
Epoch 13/50
2155/2155 - 29s - loss: 2.9600 - accuracy10: 0.4443 - val_loss: 2.7720 - val_accuracy10: 0.6459 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 2.9502 - accuracy10: 0.4479 - val_loss: 2.7773 - val_accuracy10: 0.6527 - 29s/epoch - 13ms/step
Epoch 15/50
2155/2155 - 30s - loss: 2.9444 - accuracy10: 0.4491 - val_loss: 2.7785 - val_accuracy10: 0.6563 - 30s/epoch - 14ms/step
Epoch 16/50
2155/2155 - 29s - loss: 2.9373 - accuracy10: 0.4514 - val_loss: 2.7835 - val_accuracy10: 0.6530 - 29s/epoch - 13ms/step
Epoch 17/50
2155/2155 - 29s - loss: 2.9290 - accuracy10: 0.4549 - val_loss: 2.7882 - val_accuracy10: 0.6564 - 29s/epoch - 13ms/step
Epoch 18/50
2155/2155 - 29s - loss: 2.9221 - accuracy10: 0.4565 - val_loss: 2.7935 - val_accuracy10: 0.6643 - 29s/epoch - 14ms/step
Epoch 19/50
2155/2155 - 29s - loss: 2.9183 - accuracy10: 0.4567 - val_loss: 2.7870 - val_accuracy10: 0.6639 - 29s/epoch - 13ms/step
Epoch 20/50
2155/2155 - 30s - loss: 2.9108 - accuracy10: 0.4603 - val_loss: 2.7850 - val_accuracy10: 0.6603 - 30s/epoch - 14ms/step
Epoch 21/50
2155/2155 - 29s - loss: 2.9054 - accuracy10: 0.4608 - val_loss: 2.7973 - val_accuracy10: 0.6634 - 29s/epoch - 13ms/step
Epoch 22/50
2155/2155 - 28s - loss: 2.8996 - accuracy10: 0.4632 - val_loss: 2.7985 - val_accuracy10: 0.6608 - 28s/epoch - 13ms/step
Epoch 23/50
2155/2155 - 28s - loss: 2.8916 - accuracy10: 0.4668 - val_loss: 2.8012 - val_accuracy10: 0.6590 - 28s/epoch - 13ms/step
testing model: results/WBA/W3/deepOF_L1/h10
Evaluating performance on  test set...
6315/6315 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86468774
{'0': {'precision': 0.3192469571152315, 'recall': 0.2738668168854153, 'f1-score': 0.2948208312741285, 'support': 225449}, '1': {'precision': 0.7587508765259473, 'recall': 0.780573456841484, 'f1-score': 0.7695074803056389, 'support': 1165807}, '2': {'precision': 0.31617038967541206, 'recall': 0.31408815979962873, 'f1-score': 0.31512583513225106, 'support': 225182}, 'accuracy': 0.6449167861681054, 'macro avg': {'precision': 0.4647227411055303, 'recall': 0.45617614450884275, 'f1-score': 0.4598180489040062, 'support': 1616438}, 'weighted avg': {'precision': 0.6357972721704424, 'recall': 0.6449167861681054, 'f1-score': 0.6400028547270897, 'support': 1616438}}
[[ 61743 146708  16998]
 [119835 909998 135974]
 [ 11824 142631  70727]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8921605
{'0': {'precision': 0.3565298251497736, 'recall': 0.26259178586666065, 'f1-score': 0.30243429347299, 'support': 89066}, '1': {'precision': 0.7084759584161413, 'recall': 0.7847299219540161, 'f1-score': 0.7446558989124465, 'support': 369782}, '2': {'precision': 0.35167627029858567, 'recall': 0.2897090395175472, 'f1-score': 0.3176991830964254, 'support': 92693}, 'accuracy': 0.6172179402800517, 'macro avg': {'precision': 0.4722273512881669, 'recall': 0.44567691577940804, 'f1-score': 0.4549297918272874, 'support': 551541}, 'weighted avg': {'precision': 0.5916772656694863, 'recall': 0.6172179402800517, 'f1-score': 0.6014882860437658, 'support': 551541}}
[[ 23388  59031   6647]
 [ 36744 290179  42859]
 [  5467  60372  26854]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86193156
{'0': {'precision': 0.3376179347355665, 'recall': 0.2908541814250028, 'f1-score': 0.3124962445169948, 'support': 26821}, '1': {'precision': 0.7579702935114775, 'recall': 0.7780363434757552, 'f1-score': 0.7678722492809342, 'support': 137081}, '2': {'precision': 0.31139325091881054, 'recall': 0.31239059997765445, 'f1-score': 0.31189112813266895, 'support': 26851}, 'accuracy': 0.6439898717189245, 'macro avg': {'precision': 0.4689938263886182, 'recall': 0.4604270416261375, 'f1-score': 0.4640865406435326, 'support': 190753}, 'weighted avg': {'precision': 0.6360046584473662, 'recall': 0.6439898717189245, 'f1-score': 0.6396583343871937, 'support': 190753}}
[[  7801  17142   1878]
 [ 13756 106654  16671]
 [  1549  16914   8388]]
training model: results/WBA/W3/deepOF_L1/h20
Epoch 1/50
2155/2155 - 37s - loss: 3.1540 - accuracy20: 0.4079 - val_loss: 2.9858 - val_accuracy20: 0.5870 - 37s/epoch - 17ms/step
Epoch 2/50
2155/2155 - 30s - loss: 3.1239 - accuracy20: 0.3953 - val_loss: 2.9409 - val_accuracy20: 0.5849 - 30s/epoch - 14ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.1004 - accuracy20: 0.4107 - val_loss: 2.9229 - val_accuracy20: 0.5877 - 29s/epoch - 14ms/step
Epoch 4/50
2155/2155 - 30s - loss: 3.0859 - accuracy20: 0.4215 - val_loss: 2.9097 - val_accuracy20: 0.5805 - 30s/epoch - 14ms/step
Epoch 5/50
2155/2155 - 30s - loss: 3.0750 - accuracy20: 0.4292 - val_loss: 2.9028 - val_accuracy20: 0.5828 - 30s/epoch - 14ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.0635 - accuracy20: 0.4367 - val_loss: 2.8962 - val_accuracy20: 0.5824 - 29s/epoch - 14ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.0551 - accuracy20: 0.4412 - val_loss: 2.8958 - val_accuracy20: 0.5867 - 29s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.0456 - accuracy20: 0.4458 - val_loss: 2.8879 - val_accuracy20: 0.5865 - 29s/epoch - 14ms/step
Epoch 9/50
2155/2155 - 29s - loss: 3.0370 - accuracy20: 0.4507 - val_loss: 2.8857 - val_accuracy20: 0.5932 - 29s/epoch - 13ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.0284 - accuracy20: 0.4540 - val_loss: 2.8828 - val_accuracy20: 0.5956 - 29s/epoch - 13ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.0206 - accuracy20: 0.4571 - val_loss: 2.8787 - val_accuracy20: 0.5951 - 29s/epoch - 14ms/step
Epoch 12/50
2155/2155 - 29s - loss: 3.0133 - accuracy20: 0.4586 - val_loss: 2.8812 - val_accuracy20: 0.5939 - 29s/epoch - 13ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.0059 - accuracy20: 0.4603 - val_loss: 2.8805 - val_accuracy20: 0.5961 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 2.9987 - accuracy20: 0.4628 - val_loss: 2.8813 - val_accuracy20: 0.5986 - 29s/epoch - 14ms/step
Epoch 15/50
2155/2155 - 29s - loss: 2.9933 - accuracy20: 0.4644 - val_loss: 2.8896 - val_accuracy20: 0.6036 - 29s/epoch - 14ms/step
Epoch 16/50
2155/2155 - 30s - loss: 2.9867 - accuracy20: 0.4655 - val_loss: 2.8906 - val_accuracy20: 0.6063 - 30s/epoch - 14ms/step
Epoch 17/50
2155/2155 - 30s - loss: 2.9792 - accuracy20: 0.4688 - val_loss: 2.8977 - val_accuracy20: 0.6067 - 30s/epoch - 14ms/step
Epoch 18/50
2155/2155 - 29s - loss: 2.9730 - accuracy20: 0.4703 - val_loss: 2.8970 - val_accuracy20: 0.6066 - 29s/epoch - 14ms/step
Epoch 19/50
2155/2155 - 28s - loss: 2.9659 - accuracy20: 0.4730 - val_loss: 2.9139 - val_accuracy20: 0.6094 - 28s/epoch - 13ms/step
Epoch 20/50
2155/2155 - 31s - loss: 2.9604 - accuracy20: 0.4737 - val_loss: 2.9063 - val_accuracy20: 0.6079 - 31s/epoch - 15ms/step
Epoch 21/50
2155/2155 - 30s - loss: 2.9560 - accuracy20: 0.4751 - val_loss: 2.9069 - val_accuracy20: 0.6081 - 30s/epoch - 14ms/step
testing model: results/WBA/W3/deepOF_L1/h20
Evaluating performance on  test set...
6315/6315 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9254658
{'0': {'precision': 0.4005171880709447, 'recall': 0.23404541885805705, 'f1-score': 0.2954451208386551, 'support': 304411}, '1': {'precision': 0.6583519739224329, 'recall': 0.80320076718345, 'f1-score': 0.7235986710012655, 'support': 1007321}, '2': {'precision': 0.39509265090360873, 'recall': 0.2717800108957487, 'f1-score': 0.3220353483307733, 'support': 304706}, 'accuracy': 0.5958409787446224, 'macro avg': {'precision': 0.48465393763232884, 'recall': 0.4363420656457519, 'f1-score': 0.44702638005689793, 'support': 1616438}, 'weighted avg': {'precision': 0.5601703917797147, 'recall': 0.5958409787446224, 'f1-score': 0.5672713611037097, 'support': 1616438}}
[[ 71246 212859  20306]
 [ 91755 809081 106485]
 [ 14884 207009  82813]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9588667
{'0': {'precision': 0.4367966237942122, 'recall': 0.22065056469692484, 'f1-score': 0.29319289331542236, 'support': 118205}, '1': {'precision': 0.5969189560798998, 'recall': 0.8066653379281967, 'f1-score': 0.686120289999713, 'support': 311072}, '2': {'precision': 0.42936516822482224, 'recall': 0.25092422953608584, 'f1-score': 0.316742034731256, 'support': 122264}, 'accuracy': 0.5578769302735427, 'macro avg': {'precision': 0.48769358269964475, 'recall': 0.4260800440537358, 'f1-score': 0.43201840601546376, 'support': 551541}, 'weighted avg': {'precision': 0.5254590707655842, 'recall': 0.5578769302735427, 'f1-score': 0.5200262989324864, 'support': 551541}}
[[ 26082  84192   7931]
 [ 27299 250931  32842]
 [  6331  85254  30679]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92417246
{'0': {'precision': 0.4209617985913522, 'recall': 0.24988924576365046, 'f1-score': 0.31361306576318304, 'support': 36116}, '1': {'precision': 0.6572990286529958, 'recall': 0.7987240451491716, 'f1-score': 0.7211431583531002, 'support': 118186}, '2': {'precision': 0.3917662165843029, 'recall': 0.2762064140901484, 'f1-score': 0.32399034593724857, 'support': 36451}, 'accuracy': 0.5949631198460836, 'macro avg': {'precision': 0.4900090146095503, 'recall': 0.4416065683343235, 'f1-score': 0.45291552335117724, 'support': 190753}, 'weighted avg': {'precision': 0.5618117129430346, 'recall': 0.5949631198460836, 'f1-score': 0.5680919665535077, 'support': 190753}}
[[ 9025 24663  2428]
 [10585 94398 13203]
 [ 1829 24554 10068]]
training model: results/WBA/W3/deepOF_L1/h30
Epoch 1/50
2155/2155 - 56s - loss: 3.1833 - accuracy30: 0.4126 - val_loss: 3.0683 - val_accuracy30: 0.5314 - 56s/epoch - 26ms/step
Epoch 2/50
2155/2155 - 31s - loss: 3.1549 - accuracy30: 0.4068 - val_loss: 3.0265 - val_accuracy30: 0.5329 - 31s/epoch - 14ms/step
Epoch 3/50
2155/2155 - 30s - loss: 3.1361 - accuracy30: 0.4182 - val_loss: 3.0148 - val_accuracy30: 0.5373 - 30s/epoch - 14ms/step
Epoch 4/50
2155/2155 - 29s - loss: 3.1248 - accuracy30: 0.4247 - val_loss: 3.0047 - val_accuracy30: 0.5362 - 29s/epoch - 13ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.1151 - accuracy30: 0.4308 - val_loss: 2.9989 - val_accuracy30: 0.5378 - 29s/epoch - 14ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.1061 - accuracy30: 0.4355 - val_loss: 2.9945 - val_accuracy30: 0.5358 - 29s/epoch - 14ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.0982 - accuracy30: 0.4406 - val_loss: 2.9895 - val_accuracy30: 0.5382 - 29s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.0906 - accuracy30: 0.4439 - val_loss: 2.9831 - val_accuracy30: 0.5415 - 29s/epoch - 14ms/step
Epoch 9/50
2155/2155 - 29s - loss: 3.0828 - accuracy30: 0.4465 - val_loss: 2.9824 - val_accuracy30: 0.5419 - 29s/epoch - 13ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.0750 - accuracy30: 0.4503 - val_loss: 2.9817 - val_accuracy30: 0.5425 - 29s/epoch - 13ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.0692 - accuracy30: 0.4521 - val_loss: 2.9797 - val_accuracy30: 0.5424 - 29s/epoch - 13ms/step
Epoch 12/50
2155/2155 - 30s - loss: 3.0608 - accuracy30: 0.4546 - val_loss: 2.9773 - val_accuracy30: 0.5470 - 30s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 28s - loss: 3.0541 - accuracy30: 0.4565 - val_loss: 2.9795 - val_accuracy30: 0.5451 - 28s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 3.0459 - accuracy30: 0.4597 - val_loss: 2.9794 - val_accuracy30: 0.5477 - 29s/epoch - 13ms/step
Epoch 15/50
2155/2155 - 29s - loss: 3.0408 - accuracy30: 0.4617 - val_loss: 2.9800 - val_accuracy30: 0.5474 - 29s/epoch - 13ms/step
Epoch 16/50
2155/2155 - 28s - loss: 3.0339 - accuracy30: 0.4642 - val_loss: 2.9925 - val_accuracy30: 0.5501 - 28s/epoch - 13ms/step
Epoch 17/50
2155/2155 - 29s - loss: 3.0287 - accuracy30: 0.4648 - val_loss: 2.9888 - val_accuracy30: 0.5500 - 29s/epoch - 13ms/step
Epoch 18/50
2155/2155 - 29s - loss: 3.0217 - accuracy30: 0.4680 - val_loss: 2.9938 - val_accuracy30: 0.5517 - 29s/epoch - 13ms/step
Epoch 19/50
2155/2155 - 29s - loss: 3.0161 - accuracy30: 0.4696 - val_loss: 3.0002 - val_accuracy30: 0.5519 - 29s/epoch - 14ms/step
Epoch 20/50
2155/2155 - 29s - loss: 3.0099 - accuracy30: 0.4719 - val_loss: 3.0030 - val_accuracy30: 0.5499 - 29s/epoch - 13ms/step
Epoch 21/50
2155/2155 - 29s - loss: 3.0059 - accuracy30: 0.4727 - val_loss: 3.0072 - val_accuracy30: 0.5504 - 29s/epoch - 13ms/step
Epoch 22/50
2155/2155 - 29s - loss: 2.9996 - accuracy30: 0.4750 - val_loss: 3.0053 - val_accuracy30: 0.5532 - 29s/epoch - 13ms/step
testing model: results/WBA/W3/deepOF_L1/h30
Evaluating performance on  test set...
6315/6315 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9657369
{'0': {'precision': 0.4368595226295343, 'recall': 0.22648671796217762, 'f1-score': 0.298314435015502, 'support': 361955}, '1': {'precision': 0.584633674774678, 'recall': 0.805612119037474, 'f1-score': 0.6775607244304785, 'support': 891820}, '2': {'precision': 0.4399455665234119, 'recall': 0.24247028232822207, 'f1-score': 0.3126355459167348, 'support': 362663}, 'accuracy': 0.5495874261802803, 'macro avg': {'precision': 0.48714625464254135, 'recall': 0.4248563731092912, 'f1-score': 0.4295035684542385, 'support': 1616438}, 'weighted avg': {'precision': 0.5190817534251276, 'recall': 0.5495874261802803, 'f1-score': 0.5107649978387208, 'support': 1616438}}
[[ 81978 256584  23393]
 [ 84810 718461  88549]
 [ 20865 253863  87935]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.999745
{'0': {'precision': 0.46985673081469576, 'recall': 0.21559991321327837, 'f1-score': 0.295572510001636, 'support': 138270}, '1': {'precision': 0.5214708322339412, 'recall': 0.8104505622792629, 'f1-score': 0.6346115182731124, 'support': 270684}, '2': {'precision': 0.47260670256798254, 'recall': 0.2234214900376612, 'f1-score': 0.3034086688191091, 'support': 142587}, 'accuracy': 0.5095613925347345, 'macro avg': {'precision': 0.48797808853887314, 'recall': 0.41649065517673417, 'f1-score': 0.4111975656979525, 'support': 551541}, 'weighted avg': {'precision': 0.4958987143679637, 'recall': 0.5095613925347345, 'f1-score': 0.46399112129665004, 'support': 551541}}
[[ 29811  99388   9071]
 [ 24829 219376  26479]
 [  8807 101923  31857]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96580523
{'0': {'precision': 0.45715557533941686, 'recall': 0.2389205536815168, 'f1-score': 0.31382734912146676, 'support': 42985}, '1': {'precision': 0.5808394883304034, 'recall': 0.8012325917974179, 'f1-score': 0.6734634688665642, 'support': 104333}, '2': {'precision': 0.4306644231953051, 'recall': 0.2416023943824105, 'f1-score': 0.30954839090292324, 'support': 43435}, 'accuracy': 0.5470896919052387, 'macro avg': {'precision': 0.48955316228837514, 'recall': 0.42725184662044846, 'f1-score': 0.43227973629698474, 'support': 190753}, 'weighted avg': {'precision': 0.5187728002360587, 'recall': 0.5470896919052387, 'f1-score': 0.5095572130352339, 'support': 190753}}
[[10270 29848  2867]
 [ 9732 83595 11006]
 [ 2463 30478 10494]]
training model: results/WBA/W3/deepOF_L1/h50
Epoch 1/50
2155/2155 - 31s - loss: 3.2225 - accuracy50: 0.4129 - val_loss: 3.1999 - val_accuracy50: 0.4451 - 31s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.2050 - accuracy50: 0.4093 - val_loss: 3.1589 - val_accuracy50: 0.4497 - 29s/epoch - 13ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.1913 - accuracy50: 0.4159 - val_loss: 3.1484 - val_accuracy50: 0.4548 - 29s/epoch - 14ms/step
Epoch 4/50
2155/2155 - 30s - loss: 3.1803 - accuracy50: 0.4228 - val_loss: 3.1400 - val_accuracy50: 0.4573 - 30s/epoch - 14ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.1719 - accuracy50: 0.4279 - val_loss: 3.1377 - val_accuracy50: 0.4585 - 29s/epoch - 13ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.1637 - accuracy50: 0.4323 - val_loss: 3.1335 - val_accuracy50: 0.4609 - 29s/epoch - 13ms/step
Epoch 7/50
2155/2155 - 28s - loss: 3.1568 - accuracy50: 0.4366 - val_loss: 3.1336 - val_accuracy50: 0.4620 - 28s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.1509 - accuracy50: 0.4392 - val_loss: 3.1305 - val_accuracy50: 0.4627 - 29s/epoch - 14ms/step
Epoch 9/50
2155/2155 - 30s - loss: 3.1427 - accuracy50: 0.4431 - val_loss: 3.1309 - val_accuracy50: 0.4637 - 30s/epoch - 14ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.1372 - accuracy50: 0.4453 - val_loss: 3.1271 - val_accuracy50: 0.4637 - 29s/epoch - 14ms/step
Epoch 11/50
2155/2155 - 31s - loss: 3.1307 - accuracy50: 0.4482 - val_loss: 3.1260 - val_accuracy50: 0.4654 - 31s/epoch - 14ms/step
Epoch 12/50
2155/2155 - 30s - loss: 3.1254 - accuracy50: 0.4503 - val_loss: 3.1316 - val_accuracy50: 0.4659 - 30s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.1198 - accuracy50: 0.4523 - val_loss: 3.1284 - val_accuracy50: 0.4672 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 30s - loss: 3.1151 - accuracy50: 0.4536 - val_loss: 3.1310 - val_accuracy50: 0.4653 - 30s/epoch - 14ms/step
Epoch 15/50
2155/2155 - 30s - loss: 3.1102 - accuracy50: 0.4566 - val_loss: 3.1348 - val_accuracy50: 0.4659 - 30s/epoch - 14ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.1038 - accuracy50: 0.4591 - val_loss: 3.1315 - val_accuracy50: 0.4677 - 29s/epoch - 13ms/step
Epoch 17/50
2155/2155 - 29s - loss: 3.1001 - accuracy50: 0.4601 - val_loss: 3.1285 - val_accuracy50: 0.4689 - 29s/epoch - 13ms/step
Epoch 18/50
2155/2155 - 29s - loss: 3.0950 - accuracy50: 0.4618 - val_loss: 3.1331 - val_accuracy50: 0.4689 - 29s/epoch - 13ms/step
Epoch 19/50
2155/2155 - 29s - loss: 3.0910 - accuracy50: 0.4633 - val_loss: 3.1367 - val_accuracy50: 0.4699 - 29s/epoch - 13ms/step
Epoch 20/50
2155/2155 - 29s - loss: 3.0863 - accuracy50: 0.4647 - val_loss: 3.1459 - val_accuracy50: 0.4689 - 29s/epoch - 14ms/step
Epoch 21/50
2155/2155 - 29s - loss: 3.0818 - accuracy50: 0.4665 - val_loss: 3.1422 - val_accuracy50: 0.4705 - 29s/epoch - 13ms/step
testing model: results/WBA/W3/deepOF_L1/h50
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.031979
{'0': {'precision': 0.46762981321404823, 'recall': 0.20691038608472379, 'f1-score': 0.28688420733836645, 'support': 448658}, '1': {'precision': 0.46588675859647755, 'recall': 0.8285837974641391, 'f1-score': 0.596423329706159, 'support': 720702}, '2': {'precision': 0.49038906476088345, 'recall': 0.1493363574141425, 'f1-score': 0.2289510909168846, 'support': 447078}, 'accuracy': 0.4681645692566, 'macro avg': {'precision': 0.4746352121904698, 'recall': 0.3949435136543351, 'f1-score': 0.37075287598713663, 'support': 1616438}, 'weighted avg': {'precision': 0.4731474623376543, 'recall': 0.4681645692566, 'f1-score': 0.40887146744065894, 'support': 1616438}}
[[ 92832 335715  20111]
 [ 74269 597162  49271]
 [ 31415 348898  66765]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0598531
{'0': {'precision': 0.5002616665919047, 'recall': 0.20113743619956836, 'f1-score': 0.28691610424581293, 'support': 166339}, '1': {'precision': 0.40676874625962256, 'recall': 0.8363894126619472, 'f1-score': 0.5473431845043081, 'support': 213727}, '2': {'precision': 0.5243689298909316, 'recall': 0.13822423093745445, 'f1-score': 0.2187782680130702, 'support': 171475}, 'accuracy': 0.4277433590612484, 'macro avg': {'precision': 0.47713311424748633, 'recall': 0.3919170265996566, 'f1-score': 0.3510125189210638, 'support': 551541}, 'weighted avg': {'precision': 0.4715273233433393, 'recall': 0.4277433590612484, 'f1-score': 0.3666497289707162, 'support': 551541}}
[[ 33457 125397   7485]
 [ 20954 178759  14014]
 [ 12468 135305  23702]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0335363
{'0': {'precision': 0.4884824137783666, 'recall': 0.214378153309451, 'f1-score': 0.2979821679962459, 'support': 53317}, '1': {'precision': 0.45949108704180214, 'recall': 0.8262533028850177, 'f1-score': 0.5905622163922097, 'support': 83639}, '2': {'precision': 0.48605131229725745, 'recall': 0.1531869806866554, 'f1-score': 0.23295454545454547, 'support': 53797}, 'accuracy': 0.4654081456123888, 'macro avg': {'precision': 0.47800827103914206, 'recall': 0.39793947896037474, 'f1-score': 0.37383297661433373, 'support': 190753}, 'weighted avg': {'precision': 0.4750850279270366, 'recall': 0.4654081456123888, 'f1-score': 0.40792964802494347, 'support': 190753}}
[[11430 39359  2528]
 [ 8346 69107  6186]
 [ 3623 41933  8241]]
training model: results/WBA/W3/deepOF_L1/h100
Epoch 1/50
2155/2155 - 32s - loss: 3.2661 - accuracy100: 0.3936 - val_loss: 3.3061 - val_accuracy100: 0.3609 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.2502 - accuracy100: 0.3973 - val_loss: 3.2626 - val_accuracy100: 0.3735 - 29s/epoch - 13ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.2425 - accuracy100: 0.3996 - val_loss: 3.2538 - val_accuracy100: 0.3784 - 29s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 30s - loss: 3.2377 - accuracy100: 0.4030 - val_loss: 3.2488 - val_accuracy100: 0.3821 - 30s/epoch - 14ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.2324 - accuracy100: 0.4067 - val_loss: 3.2500 - val_accuracy100: 0.3815 - 29s/epoch - 14ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.2285 - accuracy100: 0.4099 - val_loss: 3.2486 - val_accuracy100: 0.3820 - 29s/epoch - 14ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.2245 - accuracy100: 0.4126 - val_loss: 3.2488 - val_accuracy100: 0.3829 - 29s/epoch - 14ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.2205 - accuracy100: 0.4151 - val_loss: 3.2494 - val_accuracy100: 0.3826 - 29s/epoch - 14ms/step
Epoch 9/50
2155/2155 - 30s - loss: 3.2178 - accuracy100: 0.4167 - val_loss: 3.2498 - val_accuracy100: 0.3826 - 30s/epoch - 14ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.2142 - accuracy100: 0.4189 - val_loss: 3.2522 - val_accuracy100: 0.3819 - 29s/epoch - 14ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.2110 - accuracy100: 0.4210 - val_loss: 3.2534 - val_accuracy100: 0.3823 - 29s/epoch - 14ms/step
Epoch 12/50
2155/2155 - 29s - loss: 3.2084 - accuracy100: 0.4224 - val_loss: 3.2565 - val_accuracy100: 0.3809 - 29s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.2057 - accuracy100: 0.4244 - val_loss: 3.2562 - val_accuracy100: 0.3818 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 30s - loss: 3.2028 - accuracy100: 0.4259 - val_loss: 3.2582 - val_accuracy100: 0.3820 - 30s/epoch - 14ms/step
Epoch 15/50
2155/2155 - 30s - loss: 3.2000 - accuracy100: 0.4276 - val_loss: 3.2536 - val_accuracy100: 0.3837 - 30s/epoch - 14ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.1978 - accuracy100: 0.4281 - val_loss: 3.2559 - val_accuracy100: 0.3827 - 29s/epoch - 14ms/step
testing model: results/WBA/W3/deepOF_L1/h100
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0799655
{'0': {'precision': 0.4686205919949787, 'recall': 0.11714954352971793, 'f1-score': 0.18744106300900132, 'support': 522597}, '1': {'precision': 0.36960030048287346, 'recall': 0.7948535841965741, 'f1-score': 0.5045766559314016, 'support': 584329}, '2': {'precision': 0.4398671618277904, 'recall': 0.19782851041781155, 'f1-score': 0.27291471212176593, 'support': 509512}, 'accuracy': 0.3875645091243834, 'macro avg': {'precision': 0.4260293514352142, 'recall': 0.36994387938136786, 'f1-score': 0.3216441436873896, 'support': 1616438}, 'weighted avg': {'precision': 0.42376230133964804, 'recall': 0.3875645091243834, 'f1-score': 0.32902482544436606, 'support': 1616438}}
[[ 61222 409178  52197]
 [ 43715 464456  76158]
 [ 25706 383010 100796]]
Evaluating performance on  train set...
2155/2155 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886924
{'0': {'precision': 0.4916287887439757, 'recall': 0.11765734839125824, 'f1-score': 0.18987380854714428, 'support': 182938}, '1': {'precision': 0.33776275687813245, 'recall': 0.8047965898728893, 'f1-score': 0.4758270381220242, 'support': 182046}, '2': {'precision': 0.4614968781252534, 'recall': 0.18304325219637965, 'f1-score': 0.26212142728295035, 'support': 186557}, 'accuracy': 0.3665765555053931, 'macro avg': {'precision': 0.43029614124912047, 'recall': 0.36849906348684236, 'f1-score': 0.309274091317373, 'support': 551541}, 'weighted avg': {'precision': 0.4306505215138944, 'recall': 0.3665765555053931, 'f1-score': 0.30869532977527486, 'support': 551541}}
[[ 21524 143959  17455]
 [ 13145 146510  22391]
 [  9112 143297  34148]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0831679
{'0': {'precision': 0.474892930296071, 'recall': 0.12368450831730225, 'f1-score': 0.19625496986020266, 'support': 61859}, '1': {'precision': 0.3591376007961447, 'recall': 0.7888842307001258, 'f1-score': 0.4935759619663225, 'support': 66788}, '2': {'precision': 0.44557007338464294, 'recall': 0.20041541880011593, 'f1-score': 0.276474050710232, 'support': 62106}, 'accuracy': 0.3815719805193103, 'macro avg': {'precision': 0.42653353482561956, 'recall': 0.37099471927251465, 'f1-score': 0.3221016608455857, 'support': 190753}, 'weighted avg': {'precision': 0.42481669402202954, 'recall': 0.3815719805193103, 'f1-score': 0.32647342333697865, 'support': 190753}}
[[ 7651 47719  6489]
 [ 5101 52688  8999]
 [ 3359 46300 12447]]
training model: results/WBA/W3/deepOF_L1/h200
Epoch 1/50
2155/2155 - 32s - loss: 3.2956 - accuracy200: 0.3636 - val_loss: 3.3279 - val_accuracy200: 0.3371 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.2790 - accuracy200: 0.3698 - val_loss: 3.3052 - val_accuracy200: 0.3375 - 29s/epoch - 13ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.2759 - accuracy200: 0.3709 - val_loss: 3.2934 - val_accuracy200: 0.3417 - 29s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 29s - loss: 3.2735 - accuracy200: 0.3726 - val_loss: 3.2894 - val_accuracy200: 0.3429 - 29s/epoch - 13ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.2721 - accuracy200: 0.3739 - val_loss: 3.2848 - val_accuracy200: 0.3479 - 29s/epoch - 13ms/step
Epoch 6/50
2155/2155 - 30s - loss: 3.2703 - accuracy200: 0.3749 - val_loss: 3.2822 - val_accuracy200: 0.3502 - 30s/epoch - 14ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.2688 - accuracy200: 0.3766 - val_loss: 3.2825 - val_accuracy200: 0.3508 - 29s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.2677 - accuracy200: 0.3774 - val_loss: 3.2823 - val_accuracy200: 0.3515 - 29s/epoch - 13ms/step
Epoch 9/50
2155/2155 - 29s - loss: 3.2665 - accuracy200: 0.3781 - val_loss: 3.2818 - val_accuracy200: 0.3502 - 29s/epoch - 13ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.2653 - accuracy200: 0.3791 - val_loss: 3.2843 - val_accuracy200: 0.3486 - 29s/epoch - 14ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.2643 - accuracy200: 0.3800 - val_loss: 3.2840 - val_accuracy200: 0.3499 - 29s/epoch - 13ms/step
Epoch 12/50
2155/2155 - 30s - loss: 3.2634 - accuracy200: 0.3808 - val_loss: 3.2827 - val_accuracy200: 0.3510 - 30s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.2623 - accuracy200: 0.3814 - val_loss: 3.2830 - val_accuracy200: 0.3505 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 3.2613 - accuracy200: 0.3825 - val_loss: 3.2835 - val_accuracy200: 0.3492 - 29s/epoch - 13ms/step
Epoch 15/50
2155/2155 - 28s - loss: 3.2603 - accuracy200: 0.3834 - val_loss: 3.2843 - val_accuracy200: 0.3508 - 28s/epoch - 13ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.2595 - accuracy200: 0.3831 - val_loss: 3.2848 - val_accuracy200: 0.3490 - 29s/epoch - 14ms/step
Epoch 17/50
2155/2155 - 28s - loss: 3.2583 - accuracy200: 0.3840 - val_loss: 3.2854 - val_accuracy200: 0.3479 - 28s/epoch - 13ms/step
Epoch 18/50
2155/2155 - 29s - loss: 3.2571 - accuracy200: 0.3852 - val_loss: 3.2860 - val_accuracy200: 0.3493 - 29s/epoch - 13ms/step
Epoch 19/50
2155/2155 - 28s - loss: 3.2562 - accuracy200: 0.3855 - val_loss: 3.2849 - val_accuracy200: 0.3502 - 28s/epoch - 13ms/step
testing model: results/WBA/W3/deepOF_L1/h200
Evaluating performance on  test set...
6315/6315 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996156
{'0': {'precision': 0.407501901916761, 'recall': 0.07842622599566114, 'f1-score': 0.13153729705124423, 'support': 560055}, '1': {'precision': 0.32253363580132227, 'recall': 0.8116864500214541, 'f1-score': 0.46163206793534756, 'support': 519713}, '2': {'precision': 0.3836110488430596, 'recall': 0.14349227644548793, 'f1-score': 0.20885932615962516, 'support': 536670}, 'accuracy': 0.3357846078847441, 'macro avg': {'precision': 0.3712155288537143, 'recall': 0.3445349841542011, 'f1-score': 0.267342897048739, 'support': 1616438}, 'weighted avg': {'precision': 0.3722511737065133, 'recall': 0.3357846078847441, 'f1-score': 0.2633400367926292, 'support': 1616438}}
[[ 43923 455671  60461]
 [ 34593 421844  63276]
 [ 29270 430392  77008]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943104
{'0': {'precision': 0.414405963186451, 'recall': 0.0894136825636481, 'f1-score': 0.147090585122658, 'support': 182802}, '1': {'precision': 0.33402615300430777, 'recall': 0.8133015324725169, 'f1-score': 0.4735595341472136, 'support': 182385}, '2': {'precision': 0.4044986768597471, 'recall': 0.1476437318222308, 'f1-score': 0.2163271403523945, 'support': 186354}, 'accuracy': 0.348465481260686, 'macro avg': {'precision': 0.38431026435016863, 'recall': 0.3501196489527986, 'f1-score': 0.2789924198740887, 'support': 551541}, 'weighted avg': {'precision': 0.38447829848664306, 'recall': 0.348465481260686, 'f1-score': 0.2784417417567539, 'support': 551541}}
[[ 16345 147395  19062]
 [ 12607 148334  21444]
 [ 10490 148350  27514]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944118
{'0': {'precision': 0.40102890739833413, 'recall': 0.07738001449595058, 'f1-score': 0.12972844463229077, 'support': 63466}, '1': {'precision': 0.3395044128510517, 'recall': 0.8164845953653633, 'f1-score': 0.47958954831091444, 'support': 64169}, '2': {'precision': 0.39607194542071533, 'recall': 0.1517633638581704, 'f1-score': 0.2194426308374283, 'support': 63118}, 'accuracy': 0.35062620247125864, 'macro avg': {'precision': 0.3788684218900337, 'recall': 0.34854265790649475, 'f1-score': 0.2762535412602112, 'support': 190753}, 'weighted avg': {'precision': 0.3786919647724886, 'recall': 0.35062620247125864, 'f1-score': 0.2771065575157027, 'support': 190753}}
[[ 4911 51673  6882]
 [ 4052 52393  7724]
 [ 3283 50256  9579]]
training model: results/WBA/W3/deepOF_L1/h300
Epoch 1/50
2155/2155 - 32s - loss: 3.3046 - accuracy300: 0.3543 - val_loss: 3.3100 - val_accuracy300: 0.3321 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.2887 - accuracy300: 0.3588 - val_loss: 3.3039 - val_accuracy300: 0.3337 - 29s/epoch - 13ms/step
Epoch 3/50
2155/2155 - 28s - loss: 3.2856 - accuracy300: 0.3613 - val_loss: 3.2985 - val_accuracy300: 0.3382 - 28s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 29s - loss: 3.2838 - accuracy300: 0.3628 - val_loss: 3.2959 - val_accuracy300: 0.3416 - 29s/epoch - 14ms/step
Epoch 5/50
2155/2155 - 29s - loss: 3.2826 - accuracy300: 0.3635 - val_loss: 3.2936 - val_accuracy300: 0.3464 - 29s/epoch - 13ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.2815 - accuracy300: 0.3653 - val_loss: 3.2925 - val_accuracy300: 0.3465 - 29s/epoch - 13ms/step
Epoch 7/50
2155/2155 - 30s - loss: 3.2804 - accuracy300: 0.3664 - val_loss: 3.2916 - val_accuracy300: 0.3504 - 30s/epoch - 14ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.2801 - accuracy300: 0.3666 - val_loss: 3.2903 - val_accuracy300: 0.3497 - 29s/epoch - 13ms/step
Epoch 9/50
2155/2155 - 29s - loss: 3.2792 - accuracy300: 0.3679 - val_loss: 3.2905 - val_accuracy300: 0.3505 - 29s/epoch - 13ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.2787 - accuracy300: 0.3678 - val_loss: 3.2908 - val_accuracy300: 0.3501 - 29s/epoch - 13ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.2779 - accuracy300: 0.3698 - val_loss: 3.2901 - val_accuracy300: 0.3507 - 29s/epoch - 14ms/step
Epoch 12/50
2155/2155 - 29s - loss: 3.2773 - accuracy300: 0.3699 - val_loss: 3.2911 - val_accuracy300: 0.3517 - 29s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.2766 - accuracy300: 0.3702 - val_loss: 3.2899 - val_accuracy300: 0.3512 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 3.2759 - accuracy300: 0.3709 - val_loss: 3.2902 - val_accuracy300: 0.3528 - 29s/epoch - 13ms/step
Epoch 15/50
2155/2155 - 29s - loss: 3.2754 - accuracy300: 0.3718 - val_loss: 3.2909 - val_accuracy300: 0.3504 - 29s/epoch - 14ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.2749 - accuracy300: 0.3723 - val_loss: 3.2918 - val_accuracy300: 0.3500 - 29s/epoch - 13ms/step
Epoch 17/50
2155/2155 - 29s - loss: 3.2741 - accuracy300: 0.3733 - val_loss: 3.2914 - val_accuracy300: 0.3502 - 29s/epoch - 13ms/step
Epoch 18/50
2155/2155 - 29s - loss: 3.2734 - accuracy300: 0.3739 - val_loss: 3.2914 - val_accuracy300: 0.3510 - 29s/epoch - 13ms/step
Epoch 19/50
2155/2155 - 29s - loss: 3.2730 - accuracy300: 0.3741 - val_loss: 3.2915 - val_accuracy300: 0.3515 - 29s/epoch - 14ms/step
Epoch 20/50
2155/2155 - 29s - loss: 3.2722 - accuracy300: 0.3749 - val_loss: 3.2919 - val_accuracy300: 0.3524 - 29s/epoch - 13ms/step
Epoch 21/50
2155/2155 - 29s - loss: 3.2715 - accuracy300: 0.3754 - val_loss: 3.2922 - val_accuracy300: 0.3522 - 29s/epoch - 13ms/step
Epoch 22/50
2155/2155 - 29s - loss: 3.2705 - accuracy300: 0.3766 - val_loss: 3.2937 - val_accuracy300: 0.3493 - 29s/epoch - 13ms/step
Epoch 23/50
2155/2155 - 29s - loss: 3.2698 - accuracy300: 0.3775 - val_loss: 3.2934 - val_accuracy300: 0.3515 - 29s/epoch - 14ms/step
testing model: results/WBA/W3/deepOF_L1/h300
Evaluating performance on  test set...
6315/6315 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979367
{'0': {'precision': 0.3958395887630463, 'recall': 0.11686260187537563, 'f1-score': 0.18045112781954886, 'support': 564047}, '1': {'precision': 0.327577076491244, 'recall': 0.5523781783619399, 'f1-score': 0.41126279498280444, 'support': 521849}, '2': {'precision': 0.3602622002786229, 'recall': 0.3870193123258856, 'f1-score': 0.37316172461671543, 'support': 530542}, 'accuracy': 0.3461339067752676, 'macro avg': {'precision': 0.3612262885109711, 'recall': 0.352086697521067, 'f1-score': 0.3216252158063562, 'support': 1616438}, 'weighted avg': {'precision': 0.3621247029413626, 'recall': 0.3461339067752676, 'f1-score': 0.31821694571262, 'support': 1616438}}
[[ 65916 314191 183940]
 [ 52915 288258 180676]
 [ 47691 277521 205330]]
Evaluating performance on  train set...
2155/2155 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942305
{'0': {'precision': 0.3879450857824604, 'recall': 0.12626748777633148, 'f1-score': 0.19052374016414075, 'support': 182842}, '1': {'precision': 0.3371799242044475, 'recall': 0.5562183349780309, 'f1-score': 0.41984782061391923, 'support': 181391}, '2': {'precision': 0.3785813572332524, 'recall': 0.38968970892860955, 'f1-score': 0.38405522582817697, 'support': 187308}, 'accuracy': 0.3571302949372757, 'macro avg': {'precision': 0.3679021224067201, 'recall': 0.357391843894324, 'f1-score': 0.33147559553541234, 'support': 551541}, 'weighted avg': {'precision': 0.36806941980134134, 'recall': 0.3571302949372757, 'f1-score': 0.3316688586478529, 'support': 551541}}
[[ 23087 101781  57974]
 [ 18660 100893  61838]
 [ 17764  96552  72992]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969863
{'0': {'precision': 0.3867783118829793, 'recall': 0.11510890967265568, 'f1-score': 0.17741686918380656, 'support': 65008}, '1': {'precision': 0.3285829628692886, 'recall': 0.548959061286181, 'f1-score': 0.41109961662508365, 'support': 61531}, '2': {'precision': 0.37108458320579535, 'recall': 0.3964711745102314, 'f1-score': 0.38335805331988165, 'support': 64214}, 'accuracy': 0.34977169428527993, 'macro avg': {'precision': 0.36214861931935444, 'recall': 0.35351304848968934, 'f1-score': 0.3239581797095907, 'support': 190753}, 'weighted avg': {'precision': 0.3627232505553038, 'recall': 0.34977169428527993, 'f1-score': 0.32212253740880514, 'support': 190753}}
[[ 7483 35942 21583]
 [ 6188 33778 21565]
 [ 5676 33079 25459]]
training model: results/WBA/W3/deepOF_L1/h500
Epoch 1/50
2155/2155 - 32s - loss: 3.2750 - accuracy500: 0.3894 - val_loss: 3.2773 - val_accuracy500: 0.3741 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 29s - loss: 3.2720 - accuracy500: 0.3805 - val_loss: 3.2724 - val_accuracy500: 0.3742 - 29s/epoch - 13ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.2765 - accuracy500: 0.3739 - val_loss: 3.2717 - val_accuracy500: 0.3766 - 29s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 29s - loss: 3.2779 - accuracy500: 0.3723 - val_loss: 3.2711 - val_accuracy500: 0.3782 - 29s/epoch - 13ms/step
Epoch 5/50
2155/2155 - 30s - loss: 3.2782 - accuracy500: 0.3714 - val_loss: 3.2698 - val_accuracy500: 0.3803 - 30s/epoch - 14ms/step
Epoch 6/50
2155/2155 - 28s - loss: 3.2776 - accuracy500: 0.3718 - val_loss: 3.2700 - val_accuracy500: 0.3789 - 28s/epoch - 13ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.2777 - accuracy500: 0.3721 - val_loss: 3.2699 - val_accuracy500: 0.3807 - 29s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.2775 - accuracy500: 0.3718 - val_loss: 3.2698 - val_accuracy500: 0.3800 - 29s/epoch - 14ms/step
Epoch 9/50
2155/2155 - 29s - loss: 3.2767 - accuracy500: 0.3724 - val_loss: 3.2693 - val_accuracy500: 0.3809 - 29s/epoch - 14ms/step
Epoch 10/50
2155/2155 - 29s - loss: 3.2764 - accuracy500: 0.3726 - val_loss: 3.2695 - val_accuracy500: 0.3808 - 29s/epoch - 14ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.2758 - accuracy500: 0.3731 - val_loss: 3.2691 - val_accuracy500: 0.3819 - 29s/epoch - 13ms/step
Epoch 12/50
2155/2155 - 29s - loss: 3.2749 - accuracy500: 0.3742 - val_loss: 3.2691 - val_accuracy500: 0.3817 - 29s/epoch - 14ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.2740 - accuracy500: 0.3751 - val_loss: 3.2697 - val_accuracy500: 0.3817 - 29s/epoch - 13ms/step
Epoch 14/50
2155/2155 - 29s - loss: 3.2733 - accuracy500: 0.3755 - val_loss: 3.2707 - val_accuracy500: 0.3823 - 29s/epoch - 13ms/step
Epoch 15/50
2155/2155 - 29s - loss: 3.2727 - accuracy500: 0.3760 - val_loss: 3.2697 - val_accuracy500: 0.3813 - 29s/epoch - 13ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.2715 - accuracy500: 0.3768 - val_loss: 3.2703 - val_accuracy500: 0.3815 - 29s/epoch - 13ms/step
Epoch 17/50
2155/2155 - 30s - loss: 3.2707 - accuracy500: 0.3778 - val_loss: 3.2710 - val_accuracy500: 0.3813 - 30s/epoch - 14ms/step
Epoch 18/50
2155/2155 - 29s - loss: 3.2694 - accuracy500: 0.3791 - val_loss: 3.2705 - val_accuracy500: 0.3818 - 29s/epoch - 13ms/step
Epoch 19/50
2155/2155 - 29s - loss: 3.2688 - accuracy500: 0.3793 - val_loss: 3.2708 - val_accuracy500: 0.3836 - 29s/epoch - 13ms/step
Epoch 20/50
2155/2155 - 29s - loss: 3.2685 - accuracy500: 0.3797 - val_loss: 3.2710 - val_accuracy500: 0.3847 - 29s/epoch - 13ms/step
Epoch 21/50
2155/2155 - 30s - loss: 3.2671 - accuracy500: 0.3810 - val_loss: 3.2712 - val_accuracy500: 0.3854 - 30s/epoch - 14ms/step
testing model: results/WBA/W3/deepOF_L1/h500
Evaluating performance on  test set...
6315/6315 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860707
{'0': {'precision': 0.417477585129185, 'recall': 0.3374432600601826, 'f1-score': 0.3732179293385571, 'support': 627424}, '1': {'precision': 0.3147268408551069, 'recall': 0.0019347255245053066, 'f1-score': 0.0038458096396790805, 'support': 410911}, '2': {'precision': 0.37364188255745767, 'recall': 0.7153327348240711, 'f1-score': 0.49088062371429547, 'support': 578103}, 'accuracy': 0.38730282262604565, 'macro avg': {'precision': 0.3686154361805832, 'recall': 0.351570240136253, 'f1-score': 0.2893147875641772, 'support': 1616438}, 'weighted avg': {'precision': 0.3756801501244221, 'recall': 0.38730282262604565, 'f1-score': 0.3214015834775416, 'support': 1616438}}
[[211720    935 414769]
 [131650    795 278466]
 [163771    796 413536]]
Evaluating performance on  train set...
2155/2155 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002239
{'0': {'precision': 0.36300665966057216, 'recall': 0.34253014622494204, 'f1-score': 0.35247126209979757, 'support': 182527}, '1': {'precision': 0.42427884615384615, 'recall': 0.0019375377353312475, 'f1-score': 0.0038574597589360843, 'support': 182190}, '2': {'precision': 0.3558595215573957, 'recall': 0.7209191538560357, 'f1-score': 0.4765063629705892, 'support': 186824}, 'accuracy': 0.3581945857152959, 'macro avg': {'precision': 0.3810483424572713, 'recall': 0.35512894593876965, 'f1-score': 0.2776116949431076, 'support': 551541}, 'weighted avg': {'precision': 0.3808256844080012, 'recall': 0.3581945857152959, 'f1-score': 0.27932853116339074, 'support': 551541}}
[[ 62521    261 119745]
 [ 57789    353 124048]
 [ 51921    218 134685]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894818
{'0': {'precision': 0.4019076117449037, 'recall': 0.3331689029202841, 'f1-score': 0.36432429933188976, 'support': 70952}, '1': {'precision': 0.3152454780361757, 'recall': 0.0023615493312169724, 'f1-score': 0.004687980325853059, 'support': 51661}, '2': {'precision': 0.3729256778842865, 'recall': 0.7199589081303199, 'f1-score': 0.4913440399821723, 'support': 68140}, 'accuracy': 0.3817449791091097, 'macro avg': {'precision': 0.3633595892217886, 'recall': 0.35182978679394034, 'f1-score': 0.2867854398799717, 'support': 190753}, 'weighted avg': {'precision': 0.3680843876656544, 'recall': 0.3817449791091097, 'f1-score': 0.31229866016364277, 'support': 190753}}
[[23639   124 47189]
 [16237   122 35302]
 [18941   141 49058]]
training model: results/WBA/W3/deepOF_L1/h1000
Epoch 1/50
2155/2155 - 32s - loss: 3.3079 - accuracy1000: 0.3569 - val_loss: 3.4513 - val_accuracy1000: 0.2996 - 32s/epoch - 15ms/step
Epoch 2/50
2155/2155 - 30s - loss: 3.2994 - accuracy1000: 0.3461 - val_loss: 3.3426 - val_accuracy1000: 0.2993 - 30s/epoch - 14ms/step
Epoch 3/50
2155/2155 - 29s - loss: 3.2967 - accuracy1000: 0.3454 - val_loss: 3.3284 - val_accuracy1000: 0.2996 - 29s/epoch - 13ms/step
Epoch 4/50
2155/2155 - 28s - loss: 3.2959 - accuracy1000: 0.3452 - val_loss: 3.3250 - val_accuracy1000: 0.2998 - 28s/epoch - 13ms/step
Epoch 5/50
2155/2155 - 28s - loss: 3.2954 - accuracy1000: 0.3459 - val_loss: 3.3249 - val_accuracy1000: 0.2999 - 28s/epoch - 13ms/step
Epoch 6/50
2155/2155 - 29s - loss: 3.2949 - accuracy1000: 0.3470 - val_loss: 3.3250 - val_accuracy1000: 0.3007 - 29s/epoch - 13ms/step
Epoch 7/50
2155/2155 - 29s - loss: 3.2945 - accuracy1000: 0.3475 - val_loss: 3.3247 - val_accuracy1000: 0.3009 - 29s/epoch - 13ms/step
Epoch 8/50
2155/2155 - 29s - loss: 3.2943 - accuracy1000: 0.3478 - val_loss: 3.3269 - val_accuracy1000: 0.3004 - 29s/epoch - 13ms/step
Epoch 9/50
2155/2155 - 28s - loss: 3.2941 - accuracy1000: 0.3483 - val_loss: 3.3264 - val_accuracy1000: 0.3010 - 28s/epoch - 13ms/step
Epoch 10/50
2155/2155 - 28s - loss: 3.2935 - accuracy1000: 0.3492 - val_loss: 3.3267 - val_accuracy1000: 0.3019 - 28s/epoch - 13ms/step
Epoch 11/50
2155/2155 - 29s - loss: 3.2933 - accuracy1000: 0.3497 - val_loss: 3.3277 - val_accuracy1000: 0.3013 - 29s/epoch - 13ms/step
Epoch 12/50
2155/2155 - 29s - loss: 3.2927 - accuracy1000: 0.3496 - val_loss: 3.3288 - val_accuracy1000: 0.3019 - 29s/epoch - 13ms/step
Epoch 13/50
2155/2155 - 29s - loss: 3.2925 - accuracy1000: 0.3500 - val_loss: 3.3270 - val_accuracy1000: 0.3020 - 29s/epoch - 14ms/step
Epoch 14/50
2155/2155 - 30s - loss: 3.2918 - accuracy1000: 0.3510 - val_loss: 3.3297 - val_accuracy1000: 0.3026 - 30s/epoch - 14ms/step
Epoch 15/50
2155/2155 - 29s - loss: 3.2912 - accuracy1000: 0.3526 - val_loss: 3.3315 - val_accuracy1000: 0.3032 - 29s/epoch - 13ms/step
Epoch 16/50
2155/2155 - 29s - loss: 3.2910 - accuracy1000: 0.3525 - val_loss: 3.3317 - val_accuracy1000: 0.3031 - 29s/epoch - 14ms/step
Epoch 17/50
2155/2155 - 30s - loss: 3.2906 - accuracy1000: 0.3533 - val_loss: 3.3341 - val_accuracy1000: 0.3025 - 30s/epoch - 14ms/step
testing model: results/WBA/W3/deepOF_L1/h1000
Evaluating performance on  test set...
6315/6315 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1261101
{'0': {'precision': 0.43273330175272384, 'recall': 0.00265565449455351, 'f1-score': 0.005278912665345253, 'support': 687966}, '1': {'precision': 0.18664218563753962, 'recall': 0.9606215495152812, 'f1-score': 0.31255673840011944, 'support': 302856}, '2': {'precision': 0.41692543679149985, 'recall': 0.03562568732257487, 'f1-score': 0.06564233058547375, 'support': 625616}, 'accuracy': 0.19490076328321904, 'macro avg': {'precision': 0.34543364139392113, 'recall': 0.3329676304441365, 'f1-score': 0.12782599388364616, 'support': 1616438}, 'weighted avg': {'precision': 0.38050746673290786, 'recall': 0.19490076328321904, 'f1-score': 0.08621319734329139, 'support': 1616438}}
[[  1827 665933  20206]
 [   962 290930  10964]
 [  1433 601895  22288]]
Evaluating performance on  train set...
2155/2155 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011944
{'0': {'precision': 0.39839357429718875, 'recall': 0.002730901582931865, 'f1-score': 0.005424618581505988, 'support': 181625}, '1': {'precision': 0.33004449966498567, 'recall': 0.9669529643355951, 'f1-score': 0.49211739601916954, 'support': 181862}, '2': {'precision': 0.37928273179660243, 'recall': 0.035261148393546535, 'f1-score': 0.06452366240628209, 'support': 188054}, 'accuracy': 0.3317595609392593, 'macro avg': {'precision': 0.36924026858625897, 'recall': 0.33498167143735785, 'f1-score': 0.18735522566898588, 'support': 551541}, 'weighted avg': {'precision': 0.3693404852496529, 'recall': 0.3317595609392593, 'f1-score': 0.1860544058100036, 'support': 551541}}
[[   496 175907   5222]
 [   380 175852   5630]
 [   369 181054   6631]]
Evaluating performance on  val set...
746/746 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081359
{'0': {'precision': 0.3711340206185567, 'recall': 0.003172132230919478, 'f1-score': 0.006290498725882781, 'support': 68093}, '1': {'precision': 0.2974124295017945, 'recall': 0.9599147947327653, 'f1-score': 0.4541229772384672, 'support': 56804}, '2': {'precision': 0.3711400556124689, 'recall': 0.03850826044703596, 'f1-score': 0.06977671999889942, 'support': 65856}, 'accuracy': 0.3002783704581317, 'macro avg': {'precision': 0.34656216857760674, 'recall': 0.3338650624702402, 'f1-score': 0.17673006532108312, 'support': 190753}, 'weighted avg': {'precision': 0.3491826813408652, 'recall': 0.3002783704581317, 'f1-score': 0.16156787154615102, 'support': 190753}}
[[  216 65688  2189]
 [  169 54527  2108]
 [  197 63123  2536]]
training model: results/WBA/W3/deepLOB_L2/h10
Epoch 1/50
2155/2155 - 90s - loss: 2.8258 - accuracy10: 0.4608 - val_loss: 2.8789 - val_accuracy10: 0.3301 - 90s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 87s - loss: 2.5761 - accuracy10: 0.5326 - val_loss: 2.6908 - val_accuracy10: 0.4200 - 87s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 88s - loss: 2.4656 - accuracy10: 0.5770 - val_loss: 2.5198 - val_accuracy10: 0.5104 - 88s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 86s - loss: 2.3939 - accuracy10: 0.5992 - val_loss: 2.3450 - val_accuracy10: 0.5650 - 86s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 87s - loss: 2.3590 - accuracy10: 0.6071 - val_loss: 2.2210 - val_accuracy10: 0.6250 - 87s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 86s - loss: 2.3359 - accuracy10: 0.6120 - val_loss: 2.2619 - val_accuracy10: 0.6007 - 86s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 87s - loss: 2.3179 - accuracy10: 0.6144 - val_loss: 2.2782 - val_accuracy10: 0.5927 - 87s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 87s - loss: 2.3042 - accuracy10: 0.6167 - val_loss: 2.2136 - val_accuracy10: 0.6286 - 87s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 86s - loss: 2.2924 - accuracy10: 0.6188 - val_loss: 2.2526 - val_accuracy10: 0.6077 - 86s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 2.2820 - accuracy10: 0.6204 - val_loss: 2.2337 - val_accuracy10: 0.6164 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 86s - loss: 2.2734 - accuracy10: 0.6219 - val_loss: 2.2322 - val_accuracy10: 0.6171 - 86s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 87s - loss: 2.2655 - accuracy10: 0.6221 - val_loss: 2.2414 - val_accuracy10: 0.6199 - 87s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 87s - loss: 2.2578 - accuracy10: 0.6232 - val_loss: 2.2404 - val_accuracy10: 0.6130 - 87s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 86s - loss: 2.2524 - accuracy10: 0.6241 - val_loss: 2.2564 - val_accuracy10: 0.6144 - 86s/epoch - 40ms/step
Epoch 15/50
2155/2155 - 87s - loss: 2.2453 - accuracy10: 0.6249 - val_loss: 2.2584 - val_accuracy10: 0.6083 - 87s/epoch - 40ms/step
Epoch 16/50
2155/2155 - 87s - loss: 2.2398 - accuracy10: 0.6257 - val_loss: 2.2957 - val_accuracy10: 0.5928 - 87s/epoch - 40ms/step
Epoch 17/50
2155/2155 - 86s - loss: 2.2336 - accuracy10: 0.6264 - val_loss: 2.2355 - val_accuracy10: 0.6176 - 86s/epoch - 40ms/step
Epoch 18/50
2155/2155 - 86s - loss: 2.2284 - accuracy10: 0.6271 - val_loss: 2.2752 - val_accuracy10: 0.5996 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h10
Evaluating performance on  test set...
6315/6315 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81886065
{'0': {'precision': 0.3730559603905049, 'recall': 0.6630649811488135, 'f1-score': 0.47747388056126056, 'support': 225450}, '1': {'precision': 0.8997148754929086, 'recall': 0.566787155346335, 'f1-score': 0.6954601141760131, 'support': 1165808}, '2': {'precision': 0.32664123628234376, 'recall': 0.6981712732698593, 'f1-score': 0.4450600001698519, 'support': 225184}, 'accuracy': 0.5985182270690813, 'macro avg': {'precision': 0.5331373573885858, 'recall': 0.6426744699216692, 'f1-score': 0.5393313316357086, 'support': 1616442}, 'weighted avg': {'precision': 0.7464261915922004, 'recall': 0.5985182270690813, 'f1-score': 0.6301740750599734, 'support': 1616442}}
[[149488  40597  35365]
 [216311 660765 288732]
 [ 34913  33054 157217]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83250856
{'0': {'precision': 0.3533799584271609, 'recall': 0.7327152734129478, 'f1-score': 0.4768032954512256, 'support': 89096}, '1': {'precision': 0.8533529556814134, 'recall': 0.5894101680985775, 'f1-score': 0.6972383765088512, 'support': 369902}, '2': {'precision': 0.42759221661246566, 'recall': 0.5143230714370617, 'f1-score': 0.46696458792192563, 'support': 92543}, 'accuracy': 0.5999608370003318, 'macro avg': {'precision': 0.54477504357368, 'recall': 0.6121495043161956, 'f1-score': 0.5470020866273342, 'support': 551541}, 'weighted avg': {'precision': 0.7011489123935662, 'recall': 0.5999608370003318, 'f1-score': 0.6229916546892402, 'support': 551541}}
[[ 65282  15204   8610]
 [ 96771 218024  55107]
 [ 22683  22263  47597]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7922214
{'0': {'precision': 0.39042887029288703, 'recall': 0.669056688326238, 'f1-score': 0.4931054413343242, 'support': 26778}, '1': {'precision': 0.8820595615153635, 'recall': 0.6250956500193122, 'f1-score': 0.7316719482391678, 'support': 137219}, '2': {'precision': 0.34030490109613204, 'recall': 0.6056732817580446, 'f1-score': 0.4357681603678457, 'support': 26757}, 'accuracy': 0.6285425207335101, 'macro avg': {'precision': 0.5375977776347942, 'recall': 0.6332752067011983, 'f1-score': 0.5535151833137792, 'support': 190754}, 'weighted avg': {'precision': 0.7370528193322751, 'recall': 0.6285425207335101, 'f1-score': 0.6566757144827544, 'support': 190754}}
[[17916  5790  3072]
 [23100 85775 28344]
 [ 4872  5679 16206]]
training model: results/WBA/W3/deepLOB_L2/h20
Epoch 1/50
2155/2155 - 90s - loss: 2.9423 - accuracy20: 0.4650 - val_loss: 2.8182 - val_accuracy20: 0.3916 - 90s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 86s - loss: 2.7491 - accuracy20: 0.5211 - val_loss: 2.8620 - val_accuracy20: 0.4460 - 86s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 87s - loss: 2.6600 - accuracy20: 0.5538 - val_loss: 2.6562 - val_accuracy20: 0.5137 - 87s/epoch - 40ms/step
Epoch 4/50
2155/2155 - 87s - loss: 2.5895 - accuracy20: 0.5758 - val_loss: 2.5339 - val_accuracy20: 0.5487 - 87s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 86s - loss: 2.5365 - accuracy20: 0.5910 - val_loss: 2.4551 - val_accuracy20: 0.5735 - 86s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 86s - loss: 2.5062 - accuracy20: 0.5993 - val_loss: 2.4587 - val_accuracy20: 0.5716 - 86s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 86s - loss: 2.4846 - accuracy20: 0.6046 - val_loss: 2.4248 - val_accuracy20: 0.5839 - 86s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 86s - loss: 2.4668 - accuracy20: 0.6075 - val_loss: 2.4360 - val_accuracy20: 0.5901 - 86s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 87s - loss: 2.4536 - accuracy20: 0.6089 - val_loss: 2.4298 - val_accuracy20: 0.5868 - 87s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 2.4423 - accuracy20: 0.6105 - val_loss: 2.4274 - val_accuracy20: 0.5920 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 87s - loss: 2.4336 - accuracy20: 0.6117 - val_loss: 2.4224 - val_accuracy20: 0.5892 - 87s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 86s - loss: 2.4257 - accuracy20: 0.6129 - val_loss: 2.4108 - val_accuracy20: 0.5998 - 86s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 86s - loss: 2.4194 - accuracy20: 0.6139 - val_loss: 2.4234 - val_accuracy20: 0.5869 - 86s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 87s - loss: 2.4136 - accuracy20: 0.6150 - val_loss: 2.4256 - val_accuracy20: 0.5869 - 87s/epoch - 40ms/step
Epoch 15/50
2155/2155 - 86s - loss: 2.4077 - accuracy20: 0.6152 - val_loss: 2.4185 - val_accuracy20: 0.5828 - 86s/epoch - 40ms/step
Epoch 16/50
2155/2155 - 88s - loss: 2.4020 - accuracy20: 0.6167 - val_loss: 2.3911 - val_accuracy20: 0.5986 - 88s/epoch - 41ms/step
Epoch 17/50
2155/2155 - 88s - loss: 2.3974 - accuracy20: 0.6166 - val_loss: 2.3833 - val_accuracy20: 0.6055 - 88s/epoch - 41ms/step
Epoch 18/50
2155/2155 - 86s - loss: 2.3921 - accuracy20: 0.6173 - val_loss: 2.3993 - val_accuracy20: 0.5987 - 86s/epoch - 40ms/step
Epoch 19/50
2155/2155 - 86s - loss: 2.3883 - accuracy20: 0.6176 - val_loss: 2.3956 - val_accuracy20: 0.5977 - 86s/epoch - 40ms/step
Epoch 20/50
2155/2155 - 86s - loss: 2.3849 - accuracy20: 0.6183 - val_loss: 2.3851 - val_accuracy20: 0.6157 - 86s/epoch - 40ms/step
Epoch 21/50
2155/2155 - 86s - loss: 2.3789 - accuracy20: 0.6195 - val_loss: 2.3855 - val_accuracy20: 0.6101 - 86s/epoch - 40ms/step
Epoch 22/50
2155/2155 - 87s - loss: 2.3766 - accuracy20: 0.6196 - val_loss: 2.3627 - val_accuracy20: 0.6240 - 87s/epoch - 40ms/step
Epoch 23/50
2155/2155 - 87s - loss: 2.3709 - accuracy20: 0.6200 - val_loss: 2.3856 - val_accuracy20: 0.6203 - 87s/epoch - 40ms/step
Epoch 24/50
2155/2155 - 86s - loss: 2.3676 - accuracy20: 0.6206 - val_loss: 2.3487 - val_accuracy20: 0.6271 - 86s/epoch - 40ms/step
Epoch 25/50
2155/2155 - 86s - loss: 2.3634 - accuracy20: 0.6207 - val_loss: 2.3678 - val_accuracy20: 0.6234 - 86s/epoch - 40ms/step
Epoch 26/50
2155/2155 - 86s - loss: 2.3601 - accuracy20: 0.6208 - val_loss: 2.3808 - val_accuracy20: 0.6176 - 86s/epoch - 40ms/step
Epoch 27/50
2155/2155 - 86s - loss: 2.3560 - accuracy20: 0.6219 - val_loss: 2.3731 - val_accuracy20: 0.6196 - 86s/epoch - 40ms/step
Epoch 28/50
2155/2155 - 87s - loss: 2.3528 - accuracy20: 0.6224 - val_loss: 2.3773 - val_accuracy20: 0.6189 - 87s/epoch - 40ms/step
Epoch 29/50
2155/2155 - 86s - loss: 2.3492 - accuracy20: 0.6221 - val_loss: 2.3795 - val_accuracy20: 0.6183 - 86s/epoch - 40ms/step
Epoch 30/50
2155/2155 - 87s - loss: 2.3453 - accuracy20: 0.6230 - val_loss: 2.3659 - val_accuracy20: 0.6229 - 87s/epoch - 40ms/step
Epoch 31/50
2155/2155 - 86s - loss: 2.3414 - accuracy20: 0.6236 - val_loss: 2.3951 - val_accuracy20: 0.6125 - 86s/epoch - 40ms/step
Epoch 32/50
2155/2155 - 86s - loss: 2.3373 - accuracy20: 0.6240 - val_loss: 2.3815 - val_accuracy20: 0.6201 - 86s/epoch - 40ms/step
Epoch 33/50
2155/2155 - 88s - loss: 2.3348 - accuracy20: 0.6249 - val_loss: 2.4455 - val_accuracy20: 0.5992 - 88s/epoch - 41ms/step
Epoch 34/50
2155/2155 - 87s - loss: 2.3309 - accuracy20: 0.6251 - val_loss: 2.4235 - val_accuracy20: 0.6001 - 87s/epoch - 41ms/step
testing model: results/WBA/W3/deepLOB_L2/h20
Evaluating performance on  test set...
6315/6315 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8280707
{'0': {'precision': 0.4690141430372207, 'recall': 0.5561293374461669, 'f1-score': 0.5088702793040843, 'support': 304413}, '1': {'precision': 0.82838437765771, 'recall': 0.588875839975539, 'f1-score': 0.6883923504611239, 'support': 1007321}, '2': {'precision': 0.3908288685786322, 'recall': 0.691865654987726, 'f1-score': 0.49949651588995847, 'support': 304708}, 'accuracy': 0.6021230579259881, 'macro avg': {'precision': 0.5627424630911877, 'recall': 0.6122902774698107, 'f1-score': 0.5655863818850556, 'support': 1616442}, 'weighted avg': {'precision': 0.6782251790647541, 'recall': 0.6021230579259881, 'f1-score': 0.618976358914481, 'support': 1616442}}
[[169293  71352  63768]
 [149309 593187 264825]
 [ 42353  51538 210817]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85215354
{'0': {'precision': 0.4181760090508166, 'recall': 0.6759944456674513, 'f1-score': 0.516710459893602, 'support': 118106}, '1': {'precision': 0.778325481176199, 'recall': 0.5850622806679264, 'f1-score': 0.6679961400019814, 'support': 311172}, '2': {'precision': 0.4982046041053404, 'recall': 0.5163377309570353, 'f1-score': 0.5071091189512242, 'support': 122263}, 'accuracy': 0.5892997982017656, 'macro avg': {'precision': 0.5649020314441188, 'recall': 0.592464819097471, 'f1-score': 0.5639385729489358, 'support': 551541}, 'weighted avg': {'precision': 0.6391078484922195, 'recall': 0.5892997982017656, 'f1-score': 0.5999354221412802, 'support': 551541}}
[[ 79839  21314  16953]
 [ 82486 182055  46631]
 [ 28597  30537  63129]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80063754
{'0': {'precision': 0.46079564032697545, 'recall': 0.5865101825647855, 'f1-score': 0.516107767618443, 'support': 36042}, '1': {'precision': 0.8072609332496338, 'recall': 0.6520963802472892, 'f1-score': 0.7214298069685792, 'support': 118323}, '2': {'precision': 0.4299073003509199, 'recall': 0.5824287559427299, 'f1-score': 0.4946783680328634, 'support': 36389}, 'accuracy': 0.6264141249986894, 'macro avg': {'precision': 0.565987957975843, 'recall': 0.6070117729182681, 'f1-score': 0.5774053142066286, 'support': 190754}, 'weighted avg': {'precision': 0.6698125786407146, 'recall': 0.6264141249986894, 'f1-score': 0.6393792336978253, 'support': 190754}}
[[21139  9064  5839]
 [18899 77158 22266]
 [ 5837  9358 21194]]
training model: results/WBA/W3/deepLOB_L2/h30
Epoch 1/50
2155/2155 - 92s - loss: 2.9973 - accuracy30: 0.4756 - val_loss: 2.9463 - val_accuracy30: 0.4226 - 92s/epoch - 43ms/step
Epoch 2/50
2155/2155 - 90s - loss: 2.8077 - accuracy30: 0.5291 - val_loss: 2.9277 - val_accuracy30: 0.4571 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 89s - loss: 2.7085 - accuracy30: 0.5580 - val_loss: 2.7324 - val_accuracy30: 0.5497 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 89s - loss: 2.6534 - accuracy30: 0.5727 - val_loss: 2.6553 - val_accuracy30: 0.5632 - 89s/epoch - 41ms/step
Epoch 5/50
2155/2155 - 90s - loss: 2.6195 - accuracy30: 0.5810 - val_loss: 2.6581 - val_accuracy30: 0.5681 - 90s/epoch - 42ms/step
Epoch 6/50
2155/2155 - 91s - loss: 2.6002 - accuracy30: 0.5853 - val_loss: 2.6469 - val_accuracy30: 0.5663 - 91s/epoch - 42ms/step
Epoch 7/50
2155/2155 - 90s - loss: 2.5834 - accuracy30: 0.5886 - val_loss: 2.6238 - val_accuracy30: 0.5689 - 90s/epoch - 42ms/step
Epoch 8/50
2155/2155 - 89s - loss: 2.5731 - accuracy30: 0.5902 - val_loss: 2.6088 - val_accuracy30: 0.5829 - 89s/epoch - 41ms/step
Epoch 9/50
2155/2155 - 87s - loss: 2.5631 - accuracy30: 0.5922 - val_loss: 2.6345 - val_accuracy30: 0.5608 - 87s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 87s - loss: 2.5554 - accuracy30: 0.5932 - val_loss: 2.6757 - val_accuracy30: 0.5410 - 87s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 87s - loss: 2.5485 - accuracy30: 0.5944 - val_loss: 2.6460 - val_accuracy30: 0.5600 - 87s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 88s - loss: 2.5422 - accuracy30: 0.5955 - val_loss: 2.6340 - val_accuracy30: 0.5722 - 88s/epoch - 41ms/step
Epoch 13/50
2155/2155 - 87s - loss: 2.5391 - accuracy30: 0.5961 - val_loss: 2.6285 - val_accuracy30: 0.5581 - 87s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 87s - loss: 2.5323 - accuracy30: 0.5975 - val_loss: 2.5994 - val_accuracy30: 0.5741 - 87s/epoch - 41ms/step
Epoch 15/50
2155/2155 - 86s - loss: 2.5283 - accuracy30: 0.5978 - val_loss: 2.6653 - val_accuracy30: 0.5493 - 86s/epoch - 40ms/step
Epoch 16/50
2155/2155 - 87s - loss: 2.5242 - accuracy30: 0.5992 - val_loss: 2.6078 - val_accuracy30: 0.5613 - 87s/epoch - 40ms/step
Epoch 17/50
2155/2155 - 87s - loss: 2.5192 - accuracy30: 0.5998 - val_loss: 2.6180 - val_accuracy30: 0.5534 - 87s/epoch - 40ms/step
Epoch 18/50
2155/2155 - 87s - loss: 2.5152 - accuracy30: 0.6002 - val_loss: 2.6150 - val_accuracy30: 0.5587 - 87s/epoch - 40ms/step
Epoch 19/50
2155/2155 - 88s - loss: 2.5108 - accuracy30: 0.6016 - val_loss: 2.6434 - val_accuracy30: 0.5403 - 88s/epoch - 41ms/step
Epoch 20/50
2155/2155 - 87s - loss: 2.5067 - accuracy30: 0.6019 - val_loss: 2.6206 - val_accuracy30: 0.5562 - 87s/epoch - 40ms/step
Epoch 21/50
2155/2155 - 86s - loss: 2.5037 - accuracy30: 0.6024 - val_loss: 2.6271 - val_accuracy30: 0.5523 - 86s/epoch - 40ms/step
Epoch 22/50
2155/2155 - 86s - loss: 2.4991 - accuracy30: 0.6037 - val_loss: 2.6352 - val_accuracy30: 0.5453 - 86s/epoch - 40ms/step
Epoch 23/50
2155/2155 - 86s - loss: 2.4955 - accuracy30: 0.6039 - val_loss: 2.6592 - val_accuracy30: 0.5374 - 86s/epoch - 40ms/step
Epoch 24/50
2155/2155 - 86s - loss: 2.4919 - accuracy30: 0.6044 - val_loss: 2.6630 - val_accuracy30: 0.5406 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h30
Evaluating performance on  test set...
6315/6315 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92993385
{'0': {'precision': 0.4798483074686656, 'recall': 0.4778716808902715, 'f1-score': 0.47885795441175044, 'support': 361957}, '1': {'precision': 0.7802315840798318, 'recall': 0.4772857751564217, 'f1-score': 0.5922676671998174, 'support': 891820}, '2': {'precision': 0.3762627933262859, 'recall': 0.73706588725132, 'f1-score': 0.4982005304288348, 'support': 362665}, 'accuracy': 0.5357012500293855, 'macro avg': {'precision': 0.5454475616249278, 'recall': 0.5640744477660043, 'f1-score': 0.5231087173468009, 'support': 1616442}, 'weighted avg': {'precision': 0.6223346900675613, 'recall': 0.5357012500293855, 'f1-score': 0.5457678252205328, 'support': 1616442}}
[[172969  71374 117614]
 [140660 425653 325507]
 [ 46837  48520 267308]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92882663
{'0': {'precision': 0.4274552928295653, 'recall': 0.6438046056818839, 'f1-score': 0.5137832315559814, 'support': 138264}, '1': {'precision': 0.6975472290954794, 'recall': 0.5250647637278778, 'f1-score': 0.599139339682513, 'support': 270599}, '2': {'precision': 0.4908995838377182, 'recall': 0.4803403467948808, 'f1-score': 0.48556256575754464, 'support': 142678}, 'accuracy': 0.54326151636959, 'macro avg': {'precision': 0.5386340352542544, 'recall': 0.5497365720682142, 'f1-score': 0.5328283789986797, 'support': 551541}, 'weighted avg': {'precision': 0.5763811431545299, 'recall': 0.54326151636959, 'f1-score': 0.5483605510084645, 'support': 551541}}
[[ 89015  25539  23710]
 [ 81152 142082  47365]
 [ 38077  36067  68534]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88994956
{'0': {'precision': 0.49506385916465306, 'recall': 0.5010480715483511, 'f1-score': 0.4980379900684099, 'support': 42936}, '1': {'precision': 0.7343694176491604, 'recall': 0.5906552619227785, 'f1-score': 0.654718613799364, 'support': 104401}, '2': {'precision': 0.4161442625021712, 'recall': 0.6069972591381256, 'f1-score': 0.49377025837033706, 'support': 43417}, 'accuracy': 0.5742055212472609, 'macro avg': {'precision': 0.5485258464386615, 'recall': 0.5662335308697518, 'f1-score': 0.5488422874127036, 'support': 190754}, 'weighted avg': {'precision': 0.6080747920050972, 'recall': 0.5742055212472609, 'f1-score': 0.5828190258055379, 'support': 190754}}
[[21513 11490  9933]
 [15694 61665 27042]
 [ 6248 10815 26354]]
training model: results/WBA/W3/deepLOB_L2/h50
Epoch 1/50
2155/2155 - 91s - loss: 3.0786 - accuracy50: 0.4670 - val_loss: 3.4525 - val_accuracy50: 0.3667 - 91s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 90s - loss: 2.9556 - accuracy50: 0.5032 - val_loss: 3.3338 - val_accuracy50: 0.3986 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 89s - loss: 2.9002 - accuracy50: 0.5209 - val_loss: 3.2138 - val_accuracy50: 0.4313 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 89s - loss: 2.8556 - accuracy50: 0.5317 - val_loss: 3.4590 - val_accuracy50: 0.4221 - 89s/epoch - 41ms/step
Epoch 5/50
2155/2155 - 90s - loss: 2.8191 - accuracy50: 0.5408 - val_loss: 3.5372 - val_accuracy50: 0.4223 - 90s/epoch - 42ms/step
Epoch 6/50
2155/2155 - 90s - loss: 2.7923 - accuracy50: 0.5464 - val_loss: 3.6076 - val_accuracy50: 0.4215 - 90s/epoch - 42ms/step
Epoch 7/50
2155/2155 - 90s - loss: 2.7748 - accuracy50: 0.5500 - val_loss: 3.4343 - val_accuracy50: 0.4303 - 90s/epoch - 42ms/step
Epoch 8/50
2155/2155 - 90s - loss: 2.7620 - accuracy50: 0.5522 - val_loss: 3.3959 - val_accuracy50: 0.4406 - 90s/epoch - 42ms/step
Epoch 9/50
2155/2155 - 90s - loss: 2.7521 - accuracy50: 0.5547 - val_loss: 3.4394 - val_accuracy50: 0.4392 - 90s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 89s - loss: 2.7439 - accuracy50: 0.5564 - val_loss: 3.5076 - val_accuracy50: 0.4398 - 89s/epoch - 41ms/step
Epoch 11/50
2155/2155 - 88s - loss: 2.7375 - accuracy50: 0.5569 - val_loss: 3.5167 - val_accuracy50: 0.4406 - 88s/epoch - 41ms/step
Epoch 12/50
2155/2155 - 90s - loss: 2.7320 - accuracy50: 0.5586 - val_loss: 3.5584 - val_accuracy50: 0.4414 - 90s/epoch - 42ms/step
Epoch 13/50
2155/2155 - 91s - loss: 2.7263 - accuracy50: 0.5597 - val_loss: 3.5275 - val_accuracy50: 0.4432 - 91s/epoch - 42ms/step
testing model: results/WBA/W3/deepLOB_L2/h50
Evaluating performance on  test set...
6315/6315 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.085043
{'0': {'precision': 0.4532971778517256, 'recall': 0.30999420496589847, 'f1-score': 0.368193592708241, 'support': 448660}, '1': {'precision': 0.5788239896669067, 'recall': 0.2586686314177011, 'f1-score': 0.35755206784979293, 'support': 720702}, '2': {'precision': 0.3448564979692106, 'recall': 0.761747338283976, 'f1-score': 0.4747742793074437, 'support': 447080}, 'accuracy': 0.4120574694297723, 'macro avg': {'precision': 0.45899255516261434, 'recall': 0.4434700582225252, 'f1-score': 0.40017331328849254, 'support': 1616442}, 'weighted avg': {'precision': 0.47927136385218205, 'recall': 0.4120574694297723, 'f1-score': 0.3929273753717936, 'support': 1616442}}
[[139082  89894 219684]
 [106978 186423 427301]
 [ 60763  45755 340562]]
Evaluating performance on  train set...
2155/2155 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0361251
{'0': {'precision': 0.4210504887835374, 'recall': 0.5596966909001256, 'f1-score': 0.4805735262986694, 'support': 166299}, '1': {'precision': 0.5392063121064672, 'recall': 0.3561237568647263, 'f1-score': 0.42894611551063067, 'support': 213774}, '2': {'precision': 0.4472748596091773, 'recall': 0.49377143257050876, 'f1-score': 0.46937446120839, 'support': 171468}, 'accuracy': 0.4602976025354416, 'macro avg': {'precision': 0.46917722016639396, 'recall': 0.4698639601117869, 'f1-score': 0.4596313676725634, 'support': 551541}, 'weighted avg': {'precision': 0.47499984774645554, 'recall': 0.4602976025354416, 'f1-score': 0.4570813844511871, 'support': 551541}}
[[93077 30685 42537]
 [75554 76130 62090]
 [52428 34374 84666]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0824865
{'0': {'precision': 0.4572170083363918, 'recall': 0.32709439057782114, 'f1-score': 0.38136158395924213, 'support': 53321}, '1': {'precision': 0.5484357541899442, 'recall': 0.35220043051901456, 'f1-score': 0.4289397028837751, 'support': 83620}, '2': {'precision': 0.3576960407651555, 'recall': 0.6574433687027298, 'f1-score': 0.4633154575991513, 'support': 53813}, 'accuracy': 0.4312937081266972, 'macro avg': {'precision': 0.45444960109716376, 'recall': 0.4455793965998551, 'f1-score': 0.4245389148140562, 'support': 190754}, 'weighted avg': {'precision': 0.4691286311614078, 'recall': 0.4312937081266972, 'f1-score': 0.4253379415016993, 'support': 190754}}
[[17441 13670 22210]
 [12850 29451 41319]
 [ 7855 10579 35379]]
training model: results/WBA/W3/deepLOB_L2/h100
Epoch 1/50
2155/2155 - 93s - loss: 3.2217 - accuracy100: 0.4145 - val_loss: 3.3307 - val_accuracy100: 0.3685 - 93s/epoch - 43ms/step
Epoch 2/50
2155/2155 - 91s - loss: 3.1499 - accuracy100: 0.4444 - val_loss: 3.3197 - val_accuracy100: 0.3824 - 91s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 89s - loss: 3.1215 - accuracy100: 0.4559 - val_loss: 3.4395 - val_accuracy100: 0.3831 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 91s - loss: 3.1017 - accuracy100: 0.4632 - val_loss: 3.3948 - val_accuracy100: 0.3844 - 91s/epoch - 42ms/step
Epoch 5/50
2155/2155 - 89s - loss: 3.0874 - accuracy100: 0.4680 - val_loss: 3.4413 - val_accuracy100: 0.3816 - 89s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 89s - loss: 3.0753 - accuracy100: 0.4724 - val_loss: 3.4291 - val_accuracy100: 0.3837 - 89s/epoch - 41ms/step
Epoch 7/50
2155/2155 - 87s - loss: 3.0647 - accuracy100: 0.4752 - val_loss: 3.5185 - val_accuracy100: 0.3800 - 87s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 88s - loss: 3.0563 - accuracy100: 0.4785 - val_loss: 3.4706 - val_accuracy100: 0.3790 - 88s/epoch - 41ms/step
Epoch 9/50
2155/2155 - 86s - loss: 3.0493 - accuracy100: 0.4807 - val_loss: 3.4165 - val_accuracy100: 0.3832 - 86s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 3.0433 - accuracy100: 0.4823 - val_loss: 3.3999 - val_accuracy100: 0.3840 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 86s - loss: 3.0369 - accuracy100: 0.4846 - val_loss: 3.3744 - val_accuracy100: 0.3886 - 86s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 86s - loss: 3.0320 - accuracy100: 0.4858 - val_loss: 3.4289 - val_accuracy100: 0.3858 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h100
Evaluating performance on  test set...
6315/6315 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1292565
{'0': {'precision': 0.42850936893625646, 'recall': 0.1415616945306057, 'f1-score': 0.21281737059219497, 'support': 522599}, '1': {'precision': 0.5020188764952304, 'recall': 0.06808835433462998, 'f1-score': 0.11991301740104073, 'support': 584329}, '2': {'precision': 0.33021263498089104, 'recall': 0.8843525398713283, 'f1-score': 0.4808706662917229, 'support': 509514}, 'accuracy': 0.34913470449295425, 'macro avg': {'precision': 0.42024696013745927, 'recall': 0.3646675295788547, 'f1-score': 0.2712003514283195, 'support': 1616442}, 'weighted avg': {'precision': 0.42409855490017817, 'recall': 0.34913470449295425, 'f1-score': 0.26372559934968537, 'support': 1616442}}
[[ 73980  20048 428571]
 [ 59159  39786 485384]
 [ 39506  19418 450590]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156594
{'0': {'precision': 0.38876497315159025, 'recall': 0.4372267401189227, 'f1-score': 0.4115742062604016, 'support': 182976}, '1': {'precision': 0.410291200263139, 'recall': 0.21935483870967742, 'f1-score': 0.2858728697937742, 'support': 181970}, '2': {'precision': 0.3910226225404376, 'recall': 0.5206838339719714, 'f1-score': 0.4466331390324182, 'support': 186595}, 'accuracy': 0.3935790811562513, 'macro avg': {'precision': 0.3966929319850556, 'recall': 0.3924218042668572, 'f1-score': 0.3813600716955314, 'support': 551541}, 'weighted avg': {'precision': 0.3966309226189925, 'recall': 0.3935790811562513, 'f1-score': 0.3819625352581774, 'support': 551541}}
[[80002 24121 78853]
 [69595 39916 72459]
 [56188 33250 97157]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104516
{'0': {'precision': 0.42579562326512166, 'recall': 0.21324884420161003, 'f1-score': 0.2841756063935203, 'support': 61862}, '1': {'precision': 0.4353927368225588, 'recall': 0.24587290649249482, 'f1-score': 0.3142717637935491, 'support': 66754}, '2': {'precision': 0.35578128199877124, 'recall': 0.6989603785123435, 'f1-score': 0.47154109644813347, 'support': 62138}, 'accuracy': 0.38288581104459146, 'macro avg': {'precision': 0.40565654736215057, 'recall': 0.3860273764021495, 'f1-score': 0.3566628222117343, 'support': 190754}, 'weighted avg': {'precision': 0.4063469856523045, 'recall': 0.38288581104459146, 'f1-score': 0.3557418944508878, 'support': 190754}}
[[13192  9529 39141]
 [10839 16413 39502]
 [ 6951 11755 43432]]
training model: results/WBA/W3/deepLOB_L2/h200
Epoch 1/50
2155/2155 - 89s - loss: 3.2813 - accuracy200: 0.3798 - val_loss: 3.3825 - val_accuracy200: 0.3388 - 89s/epoch - 41ms/step
Epoch 2/50
2155/2155 - 86s - loss: 3.2396 - accuracy200: 0.4010 - val_loss: 3.3495 - val_accuracy200: 0.3471 - 86s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 86s - loss: 3.2189 - accuracy200: 0.4136 - val_loss: 3.3484 - val_accuracy200: 0.3553 - 86s/epoch - 40ms/step
Epoch 4/50
2155/2155 - 86s - loss: 3.2102 - accuracy200: 0.4187 - val_loss: 3.3335 - val_accuracy200: 0.3643 - 86s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 86s - loss: 3.2018 - accuracy200: 0.4233 - val_loss: 3.3686 - val_accuracy200: 0.3570 - 86s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 85s - loss: 3.1953 - accuracy200: 0.4254 - val_loss: 3.3206 - val_accuracy200: 0.3611 - 85s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 86s - loss: 3.1899 - accuracy200: 0.4282 - val_loss: 3.3605 - val_accuracy200: 0.3639 - 86s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 86s - loss: 3.1838 - accuracy200: 0.4303 - val_loss: 3.3330 - val_accuracy200: 0.3633 - 86s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 87s - loss: 3.1779 - accuracy200: 0.4334 - val_loss: 3.3291 - val_accuracy200: 0.3629 - 87s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 3.1717 - accuracy200: 0.4357 - val_loss: 3.3422 - val_accuracy200: 0.3622 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 86s - loss: 3.1665 - accuracy200: 0.4370 - val_loss: 3.3745 - val_accuracy200: 0.3519 - 86s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 86s - loss: 3.1605 - accuracy200: 0.4400 - val_loss: 3.3899 - val_accuracy200: 0.3503 - 86s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 86s - loss: 3.1528 - accuracy200: 0.4429 - val_loss: 3.4059 - val_accuracy200: 0.3543 - 86s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 87s - loss: 3.1451 - accuracy200: 0.4463 - val_loss: 3.4263 - val_accuracy200: 0.3514 - 87s/epoch - 40ms/step
Epoch 15/50
2155/2155 - 86s - loss: 3.1394 - accuracy200: 0.4480 - val_loss: 3.4054 - val_accuracy200: 0.3549 - 86s/epoch - 40ms/step
Epoch 16/50
2155/2155 - 86s - loss: 3.1319 - accuracy200: 0.4511 - val_loss: 3.4856 - val_accuracy200: 0.3516 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h200
Evaluating performance on  test set...
6315/6315 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101753
{'0': {'precision': 0.38665383991543295, 'recall': 0.12343587069864442, 'f1-score': 0.1871316060521162, 'support': 560056}, '1': {'precision': 0.36265200966143, 'recall': 0.448659163807717, 'f1-score': 0.40109677452648274, 'support': 519713}, '2': {'precision': 0.35364297578899684, 'recall': 0.5236577953427879, 'f1-score': 0.4221765377026228, 'support': 536673}, 'accuracy': 0.3608777797161915, 'macro avg': {'precision': 0.36764960845528655, 'recall': 0.36525094328304974, 'f1-score': 0.3368016394270739, 'support': 1616442}, 'weighted avg': {'precision': 0.36797695408214876, 'recall': 0.3608777797161915, 'f1-score': 0.33396195827446057, 'support': 1616442}}
[[ 69131 209928 280997]
 [ 53889 233174 232650]
 [ 55773 199867 281033]]
Evaluating performance on  train set...
2155/2155 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091508
{'0': {'precision': 0.35661443579559987, 'recall': 0.40404382818651036, 'f1-score': 0.3788504474298736, 'support': 182896}, '1': {'precision': 0.3680218215803258, 'recall': 0.3717139564239065, 'f1-score': 0.36985867499617747, 'support': 182210}, '2': {'precision': 0.3827878364382775, 'recall': 0.3290905677581999, 'f1-score': 0.3539139990251415, 'support': 186435}, 'accuracy': 0.3680270369745858, 'macro avg': {'precision': 0.3691413646047344, 'recall': 0.36828278412287224, 'f1-score': 0.3675410404837309, 'support': 551541}, 'weighted avg': {'precision': 0.36923032058503985, 'recall': 0.3680270369745858, 'f1-score': 0.36745071900808807, 'support': 551541}}
[[73898 56524 52474]
 [68026 67730 46454]
 [65297 59784 61354]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1066138
{'0': {'precision': 0.3768432841790886, 'recall': 0.22268444108285274, 'f1-score': 0.27994413795152684, 'support': 63462}, '1': {'precision': 0.362374242874301, 'recall': 0.43704245973645683, 'f1-score': 0.3962212196310182, 'support': 64202}, '2': {'precision': 0.35218010603782546, 'recall': 0.4232524964336662, 'f1-score': 0.3844592259847961, 'support': 63090}, 'accuracy': 0.3611667383121717, 'macro avg': {'precision': 0.3637992110304051, 'recall': 0.36099313241765857, 'f1-score': 0.35354152785578036, 'support': 190754}, 'weighted avg': {'precision': 0.3638163421554232, 'recall': 0.3611667383121717, 'f1-score': 0.35364680265059295, 'support': 190754}}
[[14132 24144 25186]
 [12210 28059 23933]
 [11159 25228 26703]]
training model: results/WBA/W3/deepLOB_L2/h300
Epoch 1/50
2155/2155 - 90s - loss: 3.2868 - accuracy300: 0.3754 - val_loss: 3.5168 - val_accuracy300: 0.3332 - 90s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 89s - loss: 3.2543 - accuracy300: 0.3923 - val_loss: 3.4932 - val_accuracy300: 0.3355 - 89s/epoch - 41ms/step
Epoch 3/50
2155/2155 - 87s - loss: 3.2348 - accuracy300: 0.4031 - val_loss: 3.4719 - val_accuracy300: 0.3363 - 87s/epoch - 40ms/step
Epoch 4/50
2155/2155 - 86s - loss: 3.2239 - accuracy300: 0.4095 - val_loss: 3.3837 - val_accuracy300: 0.3402 - 86s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 86s - loss: 3.2123 - accuracy300: 0.4156 - val_loss: 3.3901 - val_accuracy300: 0.3416 - 86s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 85s - loss: 3.2027 - accuracy300: 0.4213 - val_loss: 3.3932 - val_accuracy300: 0.3460 - 85s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 86s - loss: 3.1957 - accuracy300: 0.4238 - val_loss: 3.3648 - val_accuracy300: 0.3473 - 86s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 86s - loss: 3.1877 - accuracy300: 0.4283 - val_loss: 3.3796 - val_accuracy300: 0.3443 - 86s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 86s - loss: 3.1808 - accuracy300: 0.4312 - val_loss: 3.3867 - val_accuracy300: 0.3482 - 86s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 3.1769 - accuracy300: 0.4320 - val_loss: 3.4106 - val_accuracy300: 0.3496 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 87s - loss: 3.1710 - accuracy300: 0.4352 - val_loss: 3.4045 - val_accuracy300: 0.3469 - 87s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 87s - loss: 3.1636 - accuracy300: 0.4376 - val_loss: 3.4101 - val_accuracy300: 0.3483 - 87s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 85s - loss: 3.1580 - accuracy300: 0.4398 - val_loss: 3.4835 - val_accuracy300: 0.3474 - 85s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 86s - loss: 3.1545 - accuracy300: 0.4409 - val_loss: 3.4758 - val_accuracy300: 0.3443 - 86s/epoch - 40ms/step
Epoch 15/50
2155/2155 - 86s - loss: 3.1481 - accuracy300: 0.4431 - val_loss: 3.4515 - val_accuracy300: 0.3462 - 86s/epoch - 40ms/step
Epoch 16/50
2155/2155 - 85s - loss: 3.1397 - accuracy300: 0.4465 - val_loss: 3.5582 - val_accuracy300: 0.3486 - 85s/epoch - 40ms/step
Epoch 17/50
2155/2155 - 86s - loss: 3.1334 - accuracy300: 0.4486 - val_loss: 3.5740 - val_accuracy300: 0.3468 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h300
Evaluating performance on  test set...
6315/6315 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1161482
{'0': {'precision': 0.3540121404153835, 'recall': 0.1481646952032451, 'f1-score': 0.20889892628471513, 'support': 564048}, '1': {'precision': 0.3347687796559223, 'recall': 0.20915053971551156, 'f1-score': 0.2574538849837241, 'support': 521849}, '2': {'precision': 0.33625680520515205, 'recall': 0.6682354936904504, 'f1-score': 0.44738766535111385, 'support': 530545}, 'accuracy': 0.3385497283540022, 'macro avg': {'precision': 0.34167924175881925, 'recall': 0.3418502428697357, 'f1-score': 0.3045801588731844, 'support': 1616442}, 'weighted avg': {'precision': 0.34197203449876146, 'recall': 0.3385497283540022, 'f1-score': 0.3028505587652506, 'support': 1616442}}
[[ 83572 113365 367111]
 [ 80004 109145 332700]
 [ 72495 103521 354529]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1230745
{'0': {'precision': 0.3456456428174532, 'recall': 0.4014087202848065, 'f1-score': 0.37144599378072635, 'support': 182861}, '1': {'precision': 0.3534340686615174, 'recall': 0.1963531267580775, 'f1-score': 0.25245362228399615, 'support': 181306}, '2': {'precision': 0.3595173891710316, 'recall': 0.45752345576227227, 'f1-score': 0.4026423876362936, 'support': 187374}, 'accuracy': 0.35306532061986323, 'macro avg': {'precision': 0.35286570021666747, 'recall': 0.3517617676017188, 'f1-score': 0.34218066790033874, 'support': 551541}, 'weighted avg': {'precision': 0.3529185254088459, 'recall': 0.35306532061986323, 'f1-score': 0.3429283716922631, 'support': 551541}}
[[73402 32591 76868]
 [69849 35600 75857]
 [69111 32535 85728]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1222594
{'0': {'precision': 0.35374189979453136, 'recall': 0.27557600849583674, 'f1-score': 0.30980456617844254, 'support': 64973}, '1': {'precision': 0.3379824226213221, 'recall': 0.229706698696619, 'f1-score': 0.2735188102163682, 'support': 61609}, '2': {'precision': 0.34343516577453037, 'recall': 0.5258991460450041, 'f1-score': 0.41551853630308183, 'support': 64172}, 'accuracy': 0.3449731067238433, 'macro avg': {'precision': 0.3450531627301279, 'recall': 0.3437272844124866, 'f1-score': 0.3329473042326308, 'support': 190754}, 'weighted avg': {'precision': 0.34518465137669607, 'recall': 0.3449731067238433, 'f1-score': 0.3336486153295529, 'support': 190754}}
[[17905 13616 33452]
 [16391 14152 31066]
 [16320 14104 33748]]
training model: results/WBA/W3/deepLOB_L2/h500
Epoch 1/50
2155/2155 - 90s - loss: 3.2323 - accuracy500: 0.4172 - val_loss: 3.3470 - val_accuracy500: 0.3602 - 90s/epoch - 42ms/step
Epoch 2/50
2155/2155 - 86s - loss: 3.2049 - accuracy500: 0.4311 - val_loss: 3.3813 - val_accuracy500: 0.3476 - 86s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 85s - loss: 3.1802 - accuracy500: 0.4436 - val_loss: 3.3440 - val_accuracy500: 0.3593 - 85s/epoch - 40ms/step
Epoch 4/50
2155/2155 - 86s - loss: 3.1627 - accuracy500: 0.4506 - val_loss: 3.3365 - val_accuracy500: 0.3649 - 86s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 86s - loss: 3.1482 - accuracy500: 0.4560 - val_loss: 3.4014 - val_accuracy500: 0.3257 - 86s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 86s - loss: 3.1374 - accuracy500: 0.4596 - val_loss: 3.4106 - val_accuracy500: 0.3215 - 86s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 85s - loss: 3.1281 - accuracy500: 0.4635 - val_loss: 3.3906 - val_accuracy500: 0.3349 - 85s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 85s - loss: 3.1187 - accuracy500: 0.4670 - val_loss: 3.4018 - val_accuracy500: 0.3344 - 85s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 85s - loss: 3.1100 - accuracy500: 0.4705 - val_loss: 3.4251 - val_accuracy500: 0.3307 - 85s/epoch - 39ms/step
Epoch 10/50
2155/2155 - 85s - loss: 3.1022 - accuracy500: 0.4733 - val_loss: 3.4383 - val_accuracy500: 0.3240 - 85s/epoch - 39ms/step
Epoch 11/50
2155/2155 - 85s - loss: 3.0935 - accuracy500: 0.4752 - val_loss: 3.4681 - val_accuracy500: 0.3295 - 85s/epoch - 39ms/step
Epoch 12/50
2155/2155 - 85s - loss: 3.0857 - accuracy500: 0.4771 - val_loss: 3.5276 - val_accuracy500: 0.3371 - 85s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 86s - loss: 3.0767 - accuracy500: 0.4799 - val_loss: 3.5310 - val_accuracy500: 0.3335 - 86s/epoch - 40ms/step
Epoch 14/50
2155/2155 - 86s - loss: 3.0681 - accuracy500: 0.4819 - val_loss: 3.5272 - val_accuracy500: 0.3305 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h500
Evaluating performance on  test set...
6315/6315 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096086
{'0': {'precision': 0.3875923062112997, 'recall': 0.49732956130214767, 'f1-score': 0.4356567934156608, 'support': 627425}, '1': {'precision': 0.2437519681658126, 'recall': 0.041442064096604864, 'f1-score': 0.07084008461373663, 'support': 410911}, '2': {'precision': 0.3608854844473814, 'recall': 0.462894348095332, 'f1-score': 0.4055740246631419, 'support': 578106}, 'accuracy': 0.3691242865503371, 'macro avg': {'precision': 0.3307432529414979, 'recall': 0.3338886578313615, 'f1-score': 0.30402363423084644, 'support': 1616442}, 'weighted avg': {'precision': 0.341475618418443, 'recall': 0.3691242865503371, 'f1-score': 0.3321589705782493, 'support': 1616442}}
[[312037  27940 287448]
 [207417  17029 186465]
 [285611  24893 267602]]
Evaluating performance on  train set...
2155/2155 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1163424
{'0': {'precision': 0.3217930180944051, 'recall': 0.5926350048216008, 'f1-score': 0.4171040301713334, 'support': 182512}, '1': {'precision': 0.3604291769692688, 'recall': 0.044795039236130166, 'f1-score': 0.07968644754439226, 'support': 182230}, '2': {'precision': 0.3717181882791142, 'recall': 0.3835941305895642, 'f1-score': 0.377562795403171, 'support': 186799}, 'accuracy': 0.3408286963253865, 'macro avg': {'precision': 0.3513134611142627, 'recall': 0.3403413915490984, 'f1-score': 0.29145109103963224, 'support': 551541}, 'weighted avg': {'precision': 0.35146740149853983, 'recall': 0.3408286963253865, 'f1-score': 0.2922286914466231, 'support': 551541}}
[[108163   7241  67108]
 [120063   8163  54004]
 [107900   7244  71655]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1130469
{'0': {'precision': 0.3672200728693235, 'recall': 0.5514178146899984, 'f1-score': 0.4408520328502742, 'support': 70919}, '1': {'precision': 0.25799842395587075, 'recall': 0.031670793994737656, 'f1-score': 0.05641617700273981, 'support': 51688}, '2': {'precision': 0.36900804702439777, 'recall': 0.4219114561169237, 'f1-score': 0.3936904370686823, 'support': 68147}, 'accuracy': 0.36431739308218963, 'macro avg': {'precision': 0.331408847949864, 'recall': 0.33500002160055325, 'f1-score': 0.29698621564056543, 'support': 190754}, 'weighted avg': {'precision': 0.3382633877445413, 'recall': 0.36431739308218963, 'f1-score': 0.31983416803603437, 'support': 190754}}
[[39106  2435 29378]
 [30264  1637 19787]
 [37122  2273 28752]]
training model: results/WBA/W3/deepLOB_L2/h1000
Epoch 1/50
2155/2155 - 89s - loss: 3.2371 - accuracy1000: 0.4133 - val_loss: 3.4636 - val_accuracy1000: 0.3021 - 89s/epoch - 41ms/step
Epoch 2/50
2155/2155 - 86s - loss: 3.1903 - accuracy1000: 0.4255 - val_loss: 3.4078 - val_accuracy1000: 0.2954 - 86s/epoch - 40ms/step
Epoch 3/50
2155/2155 - 86s - loss: 3.1625 - accuracy1000: 0.4370 - val_loss: 3.4004 - val_accuracy1000: 0.3320 - 86s/epoch - 40ms/step
Epoch 4/50
2155/2155 - 86s - loss: 3.1393 - accuracy1000: 0.4488 - val_loss: 3.4122 - val_accuracy1000: 0.2951 - 86s/epoch - 40ms/step
Epoch 5/50
2155/2155 - 86s - loss: 3.1172 - accuracy1000: 0.4609 - val_loss: 3.4169 - val_accuracy1000: 0.2875 - 86s/epoch - 40ms/step
Epoch 6/50
2155/2155 - 86s - loss: 3.1071 - accuracy1000: 0.4637 - val_loss: 3.4525 - val_accuracy1000: 0.2896 - 86s/epoch - 40ms/step
Epoch 7/50
2155/2155 - 85s - loss: 3.0935 - accuracy1000: 0.4689 - val_loss: 3.4262 - val_accuracy1000: 0.3048 - 85s/epoch - 40ms/step
Epoch 8/50
2155/2155 - 86s - loss: 3.0800 - accuracy1000: 0.4737 - val_loss: 3.5149 - val_accuracy1000: 0.3043 - 86s/epoch - 40ms/step
Epoch 9/50
2155/2155 - 86s - loss: 3.0688 - accuracy1000: 0.4760 - val_loss: 3.5569 - val_accuracy1000: 0.2958 - 86s/epoch - 40ms/step
Epoch 10/50
2155/2155 - 86s - loss: 3.0547 - accuracy1000: 0.4811 - val_loss: 3.5924 - val_accuracy1000: 0.3097 - 86s/epoch - 40ms/step
Epoch 11/50
2155/2155 - 86s - loss: 3.0416 - accuracy1000: 0.4841 - val_loss: 3.6313 - val_accuracy1000: 0.3136 - 86s/epoch - 40ms/step
Epoch 12/50
2155/2155 - 86s - loss: 3.0304 - accuracy1000: 0.4877 - val_loss: 3.5364 - val_accuracy1000: 0.3210 - 86s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 86s - loss: 3.0204 - accuracy1000: 0.4911 - val_loss: 3.6411 - val_accuracy1000: 0.2980 - 86s/epoch - 40ms/step
testing model: results/WBA/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
6315/6315 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274444
{'0': {'precision': 0.42561180688081984, 'recall': 0.3601591934508582, 'f1-score': 0.39015948673253353, 'support': 687968}, '1': {'precision': 0.18900005791330102, 'recall': 0.4525814248355654, 'f1-score': 0.2666470831979674, 'support': 302856}, '2': {'precision': 0.38729530077560015, 'recall': 0.19132122157610554, 'f1-score': 0.2561206159613724, 'support': 625618}, 'accuracy': 0.31212935570840156, 'macro avg': {'precision': 0.33396905518990705, 'recall': 0.3346872799541764, 'f1-score': 0.30430906196395785, 'support': 1616442}, 'weighted avg': {'precision': 0.36645052317138754, 'recall': 0.31212935570840156, 'f1-score': 0.31514064736868574, 'support': 1616442}}
[[247778 307538 132652]
 [109084 137067  56705]
 [225307 280617 119694]]
Evaluating performance on  train set...
2155/2155 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525608
{'0': {'precision': 0.32981541955302834, 'recall': 0.4125516102394715, 'f1-score': 0.3665730749288279, 'support': 181650}, '1': {'precision': 0.3233967061058572, 'recall': 0.3820044881525972, 'f1-score': 0.3502659031250236, 'support': 181812}, '2': {'precision': 0.35180080684909, 'recall': 0.2049351602252245, 'f1-score': 0.2589965764125238, 'support': 188079}, 'accuracy': 0.33168341066212664, 'macro avg': {'precision': 0.33500431083599186, 'recall': 0.3331637528724311, 'f1-score': 0.32527851815545844, 'support': 551541}, 'weighted avg': {'precision': 0.33519668863003066, 'recall': 0.33168341066212664, 'f1-score': 0.3245132465852574, 'support': 551541}}
[[74940 70896 35814]
 [77155 69453 35204]
 [75123 74412 38544]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1339228
{'0': {'precision': 0.359363495050315, 'recall': 0.387095352799483, 'f1-score': 0.37271428773458165, 'support': 68084}, '1': {'precision': 0.2926088176792883, 'recall': 0.4219426359317262, 'f1-score': 0.3455710157876912, 'support': 56830}, '2': {'precision': 0.3651563425155779, 'recall': 0.1967041312272175, 'f1-score': 0.25567828481743615, 'support': 65840}, 'accuracy': 0.3317623745766799, 'macro avg': {'precision': 0.3390428850817271, 'recall': 0.3352473733194756, 'f1-score': 0.3246545294465697, 'support': 190754}, 'weighted avg': {'precision': 0.3414751821557883, 'recall': 0.3317623745766799, 'f1-score': 0.32423193571676473, 'support': 190754}}
[[26355 29642 12087]
 [22422 23979 10429]
 [24561 28328 12951]]
training model: results/WBA/W3/deepOF_L2/h10
Epoch 1/50
2155/2155 - 54s - loss: 2.7465 - accuracy10: 0.5123 - val_loss: 2.4129 - val_accuracy10: 0.6643 - 54s/epoch - 25ms/step
Epoch 2/50
2155/2155 - 48s - loss: 2.4708 - accuracy10: 0.5887 - val_loss: 2.2918 - val_accuracy10: 0.6548 - 48s/epoch - 22ms/step
Epoch 3/50
2155/2155 - 51s - loss: 2.4067 - accuracy10: 0.6038 - val_loss: 2.2444 - val_accuracy10: 0.6430 - 51s/epoch - 24ms/step
Epoch 4/50
2155/2155 - 107s - loss: 2.3783 - accuracy10: 0.6094 - val_loss: 2.2255 - val_accuracy10: 0.6504 - 107s/epoch - 50ms/step
Epoch 5/50
2155/2155 - 106s - loss: 2.3607 - accuracy10: 0.6114 - val_loss: 2.2238 - val_accuracy10: 0.6401 - 106s/epoch - 49ms/step
Epoch 6/50
2155/2155 - 100s - loss: 2.3457 - accuracy10: 0.6132 - val_loss: 2.2211 - val_accuracy10: 0.6466 - 100s/epoch - 46ms/step
Epoch 7/50
2155/2155 - 103s - loss: 2.3353 - accuracy10: 0.6144 - val_loss: 2.2135 - val_accuracy10: 0.6491 - 103s/epoch - 48ms/step
Epoch 8/50
2155/2155 - 101s - loss: 2.3259 - accuracy10: 0.6159 - val_loss: 2.1967 - val_accuracy10: 0.6529 - 101s/epoch - 47ms/step
Epoch 9/50
2155/2155 - 119s - loss: 2.3166 - accuracy10: 0.6163 - val_loss: 2.2064 - val_accuracy10: 0.6533 - 119s/epoch - 55ms/step
Epoch 10/50
2155/2155 - 120s - loss: 2.3084 - accuracy10: 0.6178 - val_loss: 2.1919 - val_accuracy10: 0.6584 - 120s/epoch - 56ms/step
Epoch 11/50
2155/2155 - 121s - loss: 2.3004 - accuracy10: 0.6189 - val_loss: 2.1946 - val_accuracy10: 0.6529 - 121s/epoch - 56ms/step
Epoch 12/50
2155/2155 - 115s - loss: 2.2947 - accuracy10: 0.6189 - val_loss: 2.2011 - val_accuracy10: 0.6540 - 115s/epoch - 54ms/step
Epoch 13/50
2155/2155 - 115s - loss: 2.2877 - accuracy10: 0.6199 - val_loss: 2.1971 - val_accuracy10: 0.6546 - 115s/epoch - 54ms/step
Epoch 14/50
2155/2155 - 121s - loss: 2.2820 - accuracy10: 0.6204 - val_loss: 2.1721 - val_accuracy10: 0.6587 - 121s/epoch - 56ms/step
Epoch 15/50
2155/2155 - 118s - loss: 2.2758 - accuracy10: 0.6213 - val_loss: 2.1748 - val_accuracy10: 0.6596 - 118s/epoch - 55ms/step
Epoch 16/50
2155/2155 - 116s - loss: 2.2697 - accuracy10: 0.6221 - val_loss: 2.1724 - val_accuracy10: 0.6526 - 116s/epoch - 54ms/step
Epoch 17/50
2155/2155 - 125s - loss: 2.2641 - accuracy10: 0.6230 - val_loss: 2.1684 - val_accuracy10: 0.6606 - 125s/epoch - 58ms/step
Epoch 18/50
2155/2155 - 122s - loss: 2.2588 - accuracy10: 0.6233 - val_loss: 2.1546 - val_accuracy10: 0.6604 - 122s/epoch - 57ms/step
Epoch 19/50
2155/2155 - 121s - loss: 2.2558 - accuracy10: 0.6237 - val_loss: 2.1679 - val_accuracy10: 0.6604 - 121s/epoch - 56ms/step
Epoch 20/50
2155/2155 - 122s - loss: 2.2497 - accuracy10: 0.6247 - val_loss: 2.1562 - val_accuracy10: 0.6583 - 122s/epoch - 56ms/step
Epoch 21/50
2155/2155 - 128s - loss: 2.2451 - accuracy10: 0.6249 - val_loss: 2.1635 - val_accuracy10: 0.6664 - 128s/epoch - 59ms/step
Epoch 22/50
2155/2155 - 121s - loss: 2.2413 - accuracy10: 0.6252 - val_loss: 2.1620 - val_accuracy10: 0.6602 - 121s/epoch - 56ms/step
Epoch 23/50
2155/2155 - 122s - loss: 2.2368 - accuracy10: 0.6256 - val_loss: 2.1538 - val_accuracy10: 0.6627 - 122s/epoch - 56ms/step
Epoch 24/50
2155/2155 - 126s - loss: 2.2307 - accuracy10: 0.6262 - val_loss: 2.1517 - val_accuracy10: 0.6645 - 126s/epoch - 59ms/step
Epoch 25/50
2155/2155 - 128s - loss: 2.2266 - accuracy10: 0.6268 - val_loss: 2.1449 - val_accuracy10: 0.6619 - 128s/epoch - 59ms/step
Epoch 26/50
2155/2155 - 122s - loss: 2.2249 - accuracy10: 0.6262 - val_loss: 2.1513 - val_accuracy10: 0.6604 - 122s/epoch - 57ms/step
Epoch 27/50
2155/2155 - 123s - loss: 2.2204 - accuracy10: 0.6266 - val_loss: 2.1497 - val_accuracy10: 0.6665 - 123s/epoch - 57ms/step
Epoch 28/50
2155/2155 - 123s - loss: 2.2155 - accuracy10: 0.6280 - val_loss: 2.1489 - val_accuracy10: 0.6672 - 123s/epoch - 57ms/step
Epoch 29/50
2155/2155 - 120s - loss: 2.2125 - accuracy10: 0.6279 - val_loss: 2.1540 - val_accuracy10: 0.6667 - 120s/epoch - 56ms/step
Epoch 30/50
2155/2155 - 124s - loss: 2.2083 - accuracy10: 0.6286 - val_loss: 2.1389 - val_accuracy10: 0.6630 - 124s/epoch - 58ms/step
Epoch 31/50
2155/2155 - 120s - loss: 2.2055 - accuracy10: 0.6293 - val_loss: 2.1389 - val_accuracy10: 0.6668 - 120s/epoch - 56ms/step
Epoch 32/50
2155/2155 - 129s - loss: 2.2015 - accuracy10: 0.6293 - val_loss: 2.1579 - val_accuracy10: 0.6617 - 129s/epoch - 60ms/step
Epoch 33/50
2155/2155 - 125s - loss: 2.1977 - accuracy10: 0.6293 - val_loss: 2.1568 - val_accuracy10: 0.6624 - 125s/epoch - 58ms/step
Epoch 34/50
2155/2155 - 132s - loss: 2.1943 - accuracy10: 0.6303 - val_loss: 2.1415 - val_accuracy10: 0.6646 - 132s/epoch - 61ms/step
Epoch 35/50
2155/2155 - 128s - loss: 2.1892 - accuracy10: 0.6301 - val_loss: 2.1669 - val_accuracy10: 0.6599 - 128s/epoch - 59ms/step
Epoch 36/50
2155/2155 - 118s - loss: 2.1868 - accuracy10: 0.6305 - val_loss: 2.1515 - val_accuracy10: 0.6640 - 118s/epoch - 55ms/step
Epoch 37/50
2155/2155 - 120s - loss: 2.1840 - accuracy10: 0.6307 - val_loss: 2.1669 - val_accuracy10: 0.6639 - 120s/epoch - 56ms/step
Epoch 38/50
2155/2155 - 125s - loss: 2.1806 - accuracy10: 0.6305 - val_loss: 2.1556 - val_accuracy10: 0.6651 - 125s/epoch - 58ms/step
Epoch 39/50
2155/2155 - 125s - loss: 2.1778 - accuracy10: 0.6313 - val_loss: 2.1610 - val_accuracy10: 0.6604 - 125s/epoch - 58ms/step
Epoch 40/50
2155/2155 - 120s - loss: 2.1745 - accuracy10: 0.6316 - val_loss: 2.1511 - val_accuracy10: 0.6563 - 120s/epoch - 56ms/step
Epoch 41/50
2155/2155 - 109s - loss: 2.1711 - accuracy10: 0.6320 - val_loss: 2.1599 - val_accuracy10: 0.6639 - 109s/epoch - 50ms/step
testing model: results/WBA/W3/deepOF_L2/h10
Evaluating performance on  test set...
6315/6315 - 134s - 134s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7252274
{'0': {'precision': 0.3767018958700989, 'recall': 0.6779227230992375, 'f1-score': 0.4842951140178683, 'support': 225449}, '1': {'precision': 0.880076568602041, 'recall': 0.687385647881682, 'f1-score': 0.7718871892824136, 'support': 1165807}, '2': {'precision': 0.4148348536437476, 'recall': 0.5529571635388264, 'f1-score': 0.4740396695473408, 'support': 225182}, 'accuracy': 0.6673389267017974, 'macro avg': {'precision': 0.5572044393719625, 'recall': 0.6394218448399153, 'f1-score': 0.5767406576158742, 'support': 1616438}, 'weighted avg': {'precision': 0.7450578568107554, 'recall': 0.6673389267017974, 'f1-score': 0.6902835360861268, 'support': 1616438}}
[[152837  51591  21021]
 [209827 801359 154621]
 [ 43060  57606 124516]]
Evaluating performance on  train set...
2155/2155 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7912173
{'0': {'precision': 0.39366132821365263, 'recall': 0.7205779983383109, 'f1-score': 0.5091611562216131, 'support': 89066}, '1': {'precision': 0.8637856186722084, 'recall': 0.6317154431529929, 'f1-score': 0.7297443362865033, 'support': 369782}, '2': {'precision': 0.4483722348318032, 'recall': 0.5711542403417734, 'f1-score': 0.5023698931057223, 'support': 92693}, 'accuracy': 0.635887449890398, 'macro avg': {'precision': 0.5686063939058882, 'recall': 0.6411492272776925, 'f1-score': 0.5804251285379463, 'support': 551541}, 'weighted avg': {'precision': 0.7180521141053666, 'recall': 0.635887449890398, 'f1-score': 0.6559103316025077, 'support': 551541}}
[[ 64179  15825   9062]
 [ 80113 233597  56072]
 [ 18739  21012  52942]]
Evaluating performance on  val set...
746/746 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73236865
{'0': {'precision': 0.38124521150046375, 'recall': 0.7050072704224302, 'f1-score': 0.49487692851254267, 'support': 26821}, '1': {'precision': 0.8844386142071139, 'recall': 0.6836541898585508, 'f1-score': 0.7711918104689723, 'support': 137081}, '2': {'precision': 0.41373529578905494, 'recall': 0.5422889277866746, 'f1-score': 0.469369006366347, 'support': 26851}, 'accuracy': 0.6667575346128239, 'macro avg': {'precision': 0.5598063738322109, 'recall': 0.6436501293558852, 'f1-score': 0.5784792484492873, 'support': 190753}, 'weighted avg': {'precision': 0.7474289469576428, 'recall': 0.6667575346128239, 'f1-score': 0.6898547643312287, 'support': 190753}}
[[18909  5409  2503]
 [25235 93716 18130]
 [ 5454  6836 14561]]
training model: results/WBA/W3/deepOF_L2/h20
Epoch 1/50
2155/2155 - 100s - loss: 2.8352 - accuracy20: 0.5157 - val_loss: 2.5931 - val_accuracy20: 0.6213 - 100s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 95s - loss: 2.5897 - accuracy20: 0.5840 - val_loss: 2.4707 - val_accuracy20: 0.6289 - 95s/epoch - 44ms/step
Epoch 3/50
2155/2155 - 97s - loss: 2.5328 - accuracy20: 0.5970 - val_loss: 2.4410 - val_accuracy20: 0.6341 - 97s/epoch - 45ms/step
Epoch 4/50
2155/2155 - 96s - loss: 2.5094 - accuracy20: 0.6009 - val_loss: 2.4232 - val_accuracy20: 0.6297 - 96s/epoch - 44ms/step
Epoch 5/50
2155/2155 - 98s - loss: 2.4924 - accuracy20: 0.6038 - val_loss: 2.4077 - val_accuracy20: 0.6375 - 98s/epoch - 46ms/step
Epoch 6/50
2155/2155 - 102s - loss: 2.4810 - accuracy20: 0.6058 - val_loss: 2.3839 - val_accuracy20: 0.6406 - 102s/epoch - 47ms/step
Epoch 7/50
2155/2155 - 100s - loss: 2.4725 - accuracy20: 0.6080 - val_loss: 2.3782 - val_accuracy20: 0.6451 - 100s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 100s - loss: 2.4633 - accuracy20: 0.6095 - val_loss: 2.3835 - val_accuracy20: 0.6443 - 100s/epoch - 46ms/step
Epoch 9/50
2155/2155 - 95s - loss: 2.4557 - accuracy20: 0.6101 - val_loss: 2.3817 - val_accuracy20: 0.6407 - 95s/epoch - 44ms/step
Epoch 10/50
2155/2155 - 93s - loss: 2.4486 - accuracy20: 0.6118 - val_loss: 2.3753 - val_accuracy20: 0.6420 - 93s/epoch - 43ms/step
Epoch 11/50
2155/2155 - 100s - loss: 2.4437 - accuracy20: 0.6122 - val_loss: 2.3816 - val_accuracy20: 0.6449 - 100s/epoch - 46ms/step
Epoch 12/50
2155/2155 - 101s - loss: 2.4376 - accuracy20: 0.6125 - val_loss: 2.3748 - val_accuracy20: 0.6458 - 101s/epoch - 47ms/step
Epoch 13/50
2155/2155 - 97s - loss: 2.4324 - accuracy20: 0.6136 - val_loss: 2.3837 - val_accuracy20: 0.6410 - 97s/epoch - 45ms/step
Epoch 14/50
2155/2155 - 97s - loss: 2.4282 - accuracy20: 0.6137 - val_loss: 2.3759 - val_accuracy20: 0.6458 - 97s/epoch - 45ms/step
Epoch 15/50
2155/2155 - 100s - loss: 2.4224 - accuracy20: 0.6151 - val_loss: 2.3755 - val_accuracy20: 0.6520 - 100s/epoch - 47ms/step
Epoch 16/50
2155/2155 - 102s - loss: 2.4171 - accuracy20: 0.6156 - val_loss: 2.3813 - val_accuracy20: 0.6451 - 102s/epoch - 47ms/step
Epoch 17/50
2155/2155 - 98s - loss: 2.4135 - accuracy20: 0.6157 - val_loss: 2.3815 - val_accuracy20: 0.6455 - 98s/epoch - 46ms/step
Epoch 18/50
2155/2155 - 101s - loss: 2.4084 - accuracy20: 0.6165 - val_loss: 2.3683 - val_accuracy20: 0.6473 - 101s/epoch - 47ms/step
Epoch 19/50
2155/2155 - 98s - loss: 2.4048 - accuracy20: 0.6162 - val_loss: 2.3716 - val_accuracy20: 0.6486 - 98s/epoch - 45ms/step
Epoch 20/50
2155/2155 - 98s - loss: 2.3999 - accuracy20: 0.6174 - val_loss: 2.3601 - val_accuracy20: 0.6512 - 98s/epoch - 45ms/step
Epoch 21/50
2155/2155 - 98s - loss: 2.3962 - accuracy20: 0.6181 - val_loss: 2.3690 - val_accuracy20: 0.6494 - 98s/epoch - 45ms/step
Epoch 22/50
2155/2155 - 102s - loss: 2.3920 - accuracy20: 0.6188 - val_loss: 2.3617 - val_accuracy20: 0.6463 - 102s/epoch - 47ms/step
Epoch 23/50
2155/2155 - 97s - loss: 2.3878 - accuracy20: 0.6189 - val_loss: 2.3648 - val_accuracy20: 0.6496 - 97s/epoch - 45ms/step
Epoch 24/50
2155/2155 - 97s - loss: 2.3839 - accuracy20: 0.6195 - val_loss: 2.3506 - val_accuracy20: 0.6502 - 97s/epoch - 45ms/step
Epoch 25/50
2155/2155 - 97s - loss: 2.3795 - accuracy20: 0.6200 - val_loss: 2.3517 - val_accuracy20: 0.6492 - 97s/epoch - 45ms/step
Epoch 26/50
2155/2155 - 100s - loss: 2.3758 - accuracy20: 0.6205 - val_loss: 2.3511 - val_accuracy20: 0.6467 - 100s/epoch - 46ms/step
Epoch 27/50
2155/2155 - 95s - loss: 2.3723 - accuracy20: 0.6206 - val_loss: 2.3555 - val_accuracy20: 0.6498 - 95s/epoch - 44ms/step
Epoch 28/50
2155/2155 - 95s - loss: 2.3688 - accuracy20: 0.6207 - val_loss: 2.3602 - val_accuracy20: 0.6472 - 95s/epoch - 44ms/step
Epoch 29/50
2155/2155 - 97s - loss: 2.3647 - accuracy20: 0.6215 - val_loss: 2.3518 - val_accuracy20: 0.6459 - 97s/epoch - 45ms/step
Epoch 30/50
2155/2155 - 96s - loss: 2.3623 - accuracy20: 0.6222 - val_loss: 2.3535 - val_accuracy20: 0.6470 - 96s/epoch - 44ms/step
Epoch 31/50
2155/2155 - 96s - loss: 2.3581 - accuracy20: 0.6227 - val_loss: 2.3521 - val_accuracy20: 0.6489 - 96s/epoch - 45ms/step
Epoch 32/50
2155/2155 - 98s - loss: 2.3525 - accuracy20: 0.6232 - val_loss: 2.3523 - val_accuracy20: 0.6465 - 98s/epoch - 45ms/step
Epoch 33/50
2155/2155 - 94s - loss: 2.3500 - accuracy20: 0.6236 - val_loss: 2.3553 - val_accuracy20: 0.6481 - 94s/epoch - 44ms/step
Epoch 34/50
2155/2155 - 97s - loss: 2.3463 - accuracy20: 0.6241 - val_loss: 2.3591 - val_accuracy20: 0.6457 - 97s/epoch - 45ms/step
testing model: results/WBA/W3/deepOF_L2/h20
Evaluating performance on  test set...
6315/6315 - 126s - 126s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7699839
{'0': {'precision': 0.4546860275627242, 'recall': 0.5737769003091215, 'f1-score': 0.507336399667128, 'support': 304411}, '1': {'precision': 0.7862814392250727, 'recall': 0.7213718367829123, 'f1-score': 0.7524293484029129, 'support': 1007321}, '2': {'precision': 0.4905819583814729, 'recall': 0.4960978779544873, 'f1-score': 0.493324500112591, 'support': 304706}, 'accuracy': 0.6511112705838393, 'macro avg': {'precision': 0.5771831417230899, 'recall': 0.597082205015507, 'f1-score': 0.5843634160608773, 'support': 1616438}, 'weighted avg': {'precision': 0.6680939820696006, 'recall': 0.6511112705838393, 'f1-score': 0.6574304733945551, 'support': 1616438}}
[[174664  94891  34856]
 [158556 726653 122112]
 [ 50922 102620 151164]]
Evaluating performance on  train set...
2155/2155 - 47s - 47s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8268304
{'0': {'precision': 0.46379895689824835, 'recall': 0.6379594771794763, 'f1-score': 0.5371140005057033, 'support': 118205}, '1': {'precision': 0.7648162293314162, 'recall': 0.6566357627816068, 'f1-score': 0.70660942602535, 'support': 311072}, '2': {'precision': 0.5155115403234408, 'recall': 0.5138798010861741, 'f1-score': 0.5146943774294362, 'support': 122264}, 'accuracy': 0.6209873789981162, 'macro avg': {'precision': 0.5813755755177018, 'recall': 0.602825013682419, 'f1-score': 0.5861392679868298, 'support': 551541}, 'weighted avg': {'precision': 0.6450377628441856, 'recall': 0.6209873789981162, 'f1-score': 0.6277403876853525, 'support': 551541}}
[[ 75410  27721  15074]
 [ 62837 204261  43974]
 [ 24345  35090  62829]]
Evaluating performance on  val set...
746/746 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7756102
{'0': {'precision': 0.45861623693089515, 'recall': 0.6097020711042197, 'f1-score': 0.5234755735171758, 'support': 36116}, '1': {'precision': 0.7928092683892497, 'recall': 0.7116071277477873, 'f1-score': 0.7500167211404263, 'support': 118186}, '2': {'precision': 0.4905341262480223, 'recall': 0.4933197991824641, 'f1-score': 0.4919230190537417, 'support': 36451}, 'accuracy': 0.6506005148018642, 'macro avg': {'precision': 0.5806532105227223, 'recall': 0.6048763326781571, 'f1-score': 0.5884717712371145, 'support': 190753}, 'weighted avg': {'precision': 0.6717734433676783, 'recall': 0.6506005148018642, 'f1-score': 0.6578056753255607, 'support': 190753}}
[[22020 10068  4028]
 [19436 84102 14648]
 [ 6558 11911 17982]]
training model: results/WBA/W3/deepOF_L2/h30
Epoch 1/50
2155/2155 - 107s - loss: 2.9085 - accuracy30: 0.5068 - val_loss: 2.7013 - val_accuracy30: 0.5978 - 107s/epoch - 50ms/step
Epoch 2/50
2155/2155 - 100s - loss: 2.6961 - accuracy30: 0.5661 - val_loss: 2.6091 - val_accuracy30: 0.5970 - 100s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 97s - loss: 2.6422 - accuracy30: 0.5782 - val_loss: 2.5884 - val_accuracy30: 0.6016 - 97s/epoch - 45ms/step
Epoch 4/50
2155/2155 - 96s - loss: 2.6203 - accuracy30: 0.5823 - val_loss: 2.5776 - val_accuracy30: 0.6005 - 96s/epoch - 45ms/step
Epoch 5/50
2155/2155 - 98s - loss: 2.6049 - accuracy30: 0.5847 - val_loss: 2.5606 - val_accuracy30: 0.6040 - 98s/epoch - 45ms/step
Epoch 6/50
2155/2155 - 98s - loss: 2.5933 - accuracy30: 0.5868 - val_loss: 2.5521 - val_accuracy30: 0.6063 - 98s/epoch - 45ms/step
Epoch 7/50
2155/2155 - 98s - loss: 2.5842 - accuracy30: 0.5881 - val_loss: 2.5418 - val_accuracy30: 0.6125 - 98s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 98s - loss: 2.5765 - accuracy30: 0.5897 - val_loss: 2.5500 - val_accuracy30: 0.6108 - 98s/epoch - 45ms/step
Epoch 9/50
2155/2155 - 99s - loss: 2.5698 - accuracy30: 0.5910 - val_loss: 2.5376 - val_accuracy30: 0.6128 - 99s/epoch - 46ms/step
Epoch 10/50
2155/2155 - 94s - loss: 2.5633 - accuracy30: 0.5922 - val_loss: 2.5465 - val_accuracy30: 0.6116 - 94s/epoch - 44ms/step
Epoch 11/50
2155/2155 - 96s - loss: 2.5572 - accuracy30: 0.5933 - val_loss: 2.5404 - val_accuracy30: 0.6138 - 96s/epoch - 45ms/step
Epoch 12/50
2155/2155 - 97s - loss: 2.5523 - accuracy30: 0.5941 - val_loss: 2.5407 - val_accuracy30: 0.6146 - 97s/epoch - 45ms/step
Epoch 13/50
2155/2155 - 99s - loss: 2.5474 - accuracy30: 0.5948 - val_loss: 2.5612 - val_accuracy30: 0.6113 - 99s/epoch - 46ms/step
Epoch 14/50
2155/2155 - 99s - loss: 2.5435 - accuracy30: 0.5957 - val_loss: 2.5398 - val_accuracy30: 0.6177 - 99s/epoch - 46ms/step
Epoch 15/50
2155/2155 - 99s - loss: 2.5376 - accuracy30: 0.5965 - val_loss: 2.5424 - val_accuracy30: 0.6172 - 99s/epoch - 46ms/step
Epoch 16/50
2155/2155 - 100s - loss: 2.5335 - accuracy30: 0.5970 - val_loss: 2.5426 - val_accuracy30: 0.6152 - 100s/epoch - 47ms/step
Epoch 17/50
2155/2155 - 101s - loss: 2.5294 - accuracy30: 0.5973 - val_loss: 2.5537 - val_accuracy30: 0.6136 - 101s/epoch - 47ms/step
Epoch 18/50
2155/2155 - 103s - loss: 2.5249 - accuracy30: 0.5985 - val_loss: 2.5470 - val_accuracy30: 0.6156 - 103s/epoch - 48ms/step
Epoch 19/50
2155/2155 - 102s - loss: 2.5215 - accuracy30: 0.5991 - val_loss: 2.5560 - val_accuracy30: 0.6177 - 102s/epoch - 47ms/step
testing model: results/WBA/W3/deepOF_L2/h30
Evaluating performance on  test set...
6315/6315 - 134s - 134s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8369426
{'0': {'precision': 0.47322800356209693, 'recall': 0.5344062107168018, 'f1-score': 0.5019598989494007, 'support': 361955}, '1': {'precision': 0.7042359650394296, 'recall': 0.7136653136283106, 'f1-score': 0.7089192857353692, 'support': 891820}, '2': {'precision': 0.5184730644328116, 'recall': 0.434505312094148, 'f1-score': 0.4727899524746772, 'support': 362663}, 'accuracy': 0.6108932108747753, 'macro avg': {'precision': 0.5653123443447794, 'recall': 0.5608589454797536, 'f1-score': 0.5612230457198157, 'support': 1616438}, 'weighted avg': {'precision': 0.6108307014170539, 'recall': 0.6108932108747753, 'f1-score': 0.6095988309870661, 'support': 1616438}}
[[193431 128943  39581]
 [148590 636461 106769]
 [ 66727 138357 157579]]
Evaluating performance on  train set...
2155/2155 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88239104
{'0': {'precision': 0.47831072821468074, 'recall': 0.5942648441455124, 'f1-score': 0.5300199961297815, 'support': 138270}, '1': {'precision': 0.6732884670519533, 'recall': 0.6593592528557285, 'f1-score': 0.666251063893327, 'support': 270684}, '2': {'precision': 0.5449519042095808, 'recall': 0.43824472076697035, 'f1-score': 0.48580780085052133, 'support': 142587}, 'accuracy': 0.5858766619344709, 'macro avg': {'precision': 0.5655170331587382, 'recall': 0.5639562725894037, 'f1-score': 0.5606929536245433, 'support': 551541}, 'weighted avg': {'precision': 0.5912298396153075, 'recall': 0.5858766619344709, 'f1-score': 0.5854492136462013, 'support': 551541}}
[[ 82169  39076  17025]
 [ 57052 178478  35154]
 [ 32569  47530  62488]]
Evaluating performance on  val set...
746/746 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83950615
{'0': {'precision': 0.48111250293588037, 'recall': 0.5718506455740374, 'f1-score': 0.5225719357547541, 'support': 42985}, '1': {'precision': 0.7089957815682527, 'recall': 0.7039671053262151, 'f1-score': 0.7064724950222675, 'support': 104333}, '2': {'precision': 0.5193523344793168, 'recall': 0.4312651087832393, 'f1-score': 0.47122750084902454, 'support': 43435}, 'accuracy': 0.6121004649992399, 'macro avg': {'precision': 0.5698202063278166, 'recall': 0.5690276198944973, 'f1-score': 0.5667573105420154, 'support': 190753}, 'weighted avg': {'precision': 0.6144613529809149, 'recall': 0.6121004649992399, 'f1-score': 0.6114656963767475, 'support': 190753}}
[[24581 13804  4600]
 [18150 73447 12736]
 [ 8361 16342 18732]]
training model: results/WBA/W3/deepOF_L2/h50
Epoch 1/50
2155/2155 - 103s - loss: 3.0083 - accuracy50: 0.4877 - val_loss: 2.9234 - val_accuracy50: 0.5208 - 103s/epoch - 48ms/step
Epoch 2/50
2155/2155 - 100s - loss: 2.8496 - accuracy50: 0.5321 - val_loss: 2.8472 - val_accuracy50: 0.5364 - 100s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 100s - loss: 2.8044 - accuracy50: 0.5421 - val_loss: 2.8272 - val_accuracy50: 0.5412 - 100s/epoch - 46ms/step
Epoch 4/50
2155/2155 - 98s - loss: 2.7837 - accuracy50: 0.5464 - val_loss: 2.8143 - val_accuracy50: 0.5425 - 98s/epoch - 46ms/step
Epoch 5/50
2155/2155 - 100s - loss: 2.7711 - accuracy50: 0.5494 - val_loss: 2.8107 - val_accuracy50: 0.5451 - 100s/epoch - 46ms/step
Epoch 6/50
2155/2155 - 95s - loss: 2.7617 - accuracy50: 0.5510 - val_loss: 2.8063 - val_accuracy50: 0.5479 - 95s/epoch - 44ms/step
Epoch 7/50
2155/2155 - 98s - loss: 2.7537 - accuracy50: 0.5527 - val_loss: 2.8129 - val_accuracy50: 0.5459 - 98s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 100s - loss: 2.7476 - accuracy50: 0.5541 - val_loss: 2.7987 - val_accuracy50: 0.5509 - 100s/epoch - 47ms/step
Epoch 9/50
2155/2155 - 99s - loss: 2.7407 - accuracy50: 0.5559 - val_loss: 2.7978 - val_accuracy50: 0.5515 - 99s/epoch - 46ms/step
Epoch 10/50
2155/2155 - 97s - loss: 2.7356 - accuracy50: 0.5567 - val_loss: 2.7980 - val_accuracy50: 0.5532 - 97s/epoch - 45ms/step
Epoch 11/50
2155/2155 - 99s - loss: 2.7304 - accuracy50: 0.5580 - val_loss: 2.7939 - val_accuracy50: 0.5524 - 99s/epoch - 46ms/step
Epoch 12/50
2155/2155 - 100s - loss: 2.7246 - accuracy50: 0.5589 - val_loss: 2.7968 - val_accuracy50: 0.5519 - 100s/epoch - 46ms/step
Epoch 13/50
2155/2155 - 98s - loss: 2.7201 - accuracy50: 0.5605 - val_loss: 2.7830 - val_accuracy50: 0.5533 - 98s/epoch - 45ms/step
Epoch 14/50
2155/2155 - 98s - loss: 2.7156 - accuracy50: 0.5609 - val_loss: 2.7887 - val_accuracy50: 0.5518 - 98s/epoch - 46ms/step
Epoch 15/50
2155/2155 - 99s - loss: 2.7112 - accuracy50: 0.5623 - val_loss: 2.7864 - val_accuracy50: 0.5541 - 99s/epoch - 46ms/step
Epoch 16/50
2155/2155 - 97s - loss: 2.7067 - accuracy50: 0.5629 - val_loss: 2.7963 - val_accuracy50: 0.5515 - 97s/epoch - 45ms/step
Epoch 17/50
2155/2155 - 98s - loss: 2.7032 - accuracy50: 0.5634 - val_loss: 2.7987 - val_accuracy50: 0.5533 - 98s/epoch - 45ms/step
Epoch 18/50
2155/2155 - 95s - loss: 2.6996 - accuracy50: 0.5649 - val_loss: 2.7896 - val_accuracy50: 0.5547 - 95s/epoch - 44ms/step
Epoch 19/50
2155/2155 - 100s - loss: 2.6949 - accuracy50: 0.5653 - val_loss: 2.7986 - val_accuracy50: 0.5526 - 100s/epoch - 46ms/step
Epoch 20/50
2155/2155 - 98s - loss: 2.6908 - accuracy50: 0.5660 - val_loss: 2.8018 - val_accuracy50: 0.5514 - 98s/epoch - 45ms/step
Epoch 21/50
2155/2155 - 96s - loss: 2.6856 - accuracy50: 0.5672 - val_loss: 2.8228 - val_accuracy50: 0.5487 - 96s/epoch - 45ms/step
Epoch 22/50
2155/2155 - 99s - loss: 2.6817 - accuracy50: 0.5683 - val_loss: 2.8115 - val_accuracy50: 0.5497 - 99s/epoch - 46ms/step
Epoch 23/50
2155/2155 - 96s - loss: 2.6781 - accuracy50: 0.5688 - val_loss: 2.8107 - val_accuracy50: 0.5478 - 96s/epoch - 45ms/step
testing model: results/WBA/W3/deepOF_L2/h50
Evaluating performance on  test set...
6315/6315 - 114s - 114s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9254066
{'0': {'precision': 0.4955138334011836, 'recall': 0.48018758163233466, 'f1-score': 0.4877303356541878, 'support': 448658}, '1': {'precision': 0.5777142741785344, 'recall': 0.7147364652796856, 'f1-score': 0.6389620055323318, 'support': 720702}, '2': {'precision': 0.5512604346611774, 'recall': 0.35760202917611694, 'f1-score': 0.4337990793613324, 'support': 447078}, 'accuracy': 0.5508581213755183, 'macro avg': {'precision': 0.541496180746965, 'recall': 0.5175086920293791, 'f1-score': 0.5201638068492841, 'support': 1616438}, 'weighted avg': {'precision': 0.5475820853645955, 'recall': 0.5508581213755183, 'f1-score': 0.5402417767014912, 'support': 1616438}}
[[215440 180653  52565]
 [128012 515112  77578]
 [ 91329 195873 159876]]
Evaluating performance on  train set...
2155/2155 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94435257
{'0': {'precision': 0.5002354783915502, 'recall': 0.5683153078953223, 'f1-score': 0.5321066318432044, 'support': 166339}, '1': {'precision': 0.5520108337485734, 'recall': 0.6427311476790485, 'f1-score': 0.5939266590139197, 'support': 213727}, '2': {'precision': 0.5698870831574504, 'recall': 0.3779151479807552, 'f1-score': 0.4544597053862904, 'support': 171475}, 'accuracy': 0.5379563803960177, 'macro avg': {'precision': 0.540711131765858, 'recall': 0.5296538678517086, 'f1-score': 0.5268309987478049, 'support': 551541}, 'weighted avg': {'precision': 0.5419536830247929, 'recall': 0.5379563803960177, 'f1-score': 0.5319218808145704, 'support': 551541}}
[[ 94533  50468  21338]
 [ 48787 137369  27571]
 [ 45657  61015  64803]]
Evaluating performance on  val set...
746/746 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.926548
{'0': {'precision': 0.500810635538262, 'recall': 0.5214284374589718, 'f1-score': 0.5109116136323957, 'support': 53317}, '1': {'precision': 0.5787362582945429, 'recall': 0.6986573249321488, 'f1-score': 0.6330677269255561, 'support': 83639}, '2': {'precision': 0.5581687140731231, 'recall': 0.35557744855661094, 'f1-score': 0.43441431621020116, 'support': 53797}, 'accuracy': 0.552363527703365, 'macro avg': {'precision': 0.5459052026353093, 'recall': 0.5252210703159105, 'f1-score': 0.5261312189227177, 'support': 190753}, 'weighted avg': {'precision': 0.5511548697712885, 'recall': 0.552363527703365, 'f1-score': 0.5428990007262021, 'support': 190753}}
[[27801 19530  5986]
 [16048 58435  9156]
 [11663 23005 19129]]
training model: results/WBA/W3/deepOF_L2/h100
Epoch 1/50
2155/2155 - 107s - loss: 3.1827 - accuracy100: 0.4313 - val_loss: 3.1866 - val_accuracy100: 0.4180 - 107s/epoch - 50ms/step
Epoch 2/50
2155/2155 - 99s - loss: 3.1165 - accuracy100: 0.4583 - val_loss: 3.1488 - val_accuracy100: 0.4338 - 99s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 100s - loss: 3.0917 - accuracy100: 0.4658 - val_loss: 3.1389 - val_accuracy100: 0.4395 - 100s/epoch - 46ms/step
Epoch 4/50
2155/2155 - 98s - loss: 3.0784 - accuracy100: 0.4700 - val_loss: 3.1360 - val_accuracy100: 0.4419 - 98s/epoch - 46ms/step
Epoch 5/50
2155/2155 - 98s - loss: 3.0688 - accuracy100: 0.4726 - val_loss: 3.1176 - val_accuracy100: 0.4494 - 98s/epoch - 46ms/step
Epoch 6/50
2155/2155 - 98s - loss: 3.0610 - accuracy100: 0.4759 - val_loss: 3.1210 - val_accuracy100: 0.4495 - 98s/epoch - 46ms/step
Epoch 7/50
2155/2155 - 100s - loss: 3.0546 - accuracy100: 0.4766 - val_loss: 3.1120 - val_accuracy100: 0.4530 - 100s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 101s - loss: 3.0495 - accuracy100: 0.4787 - val_loss: 3.1205 - val_accuracy100: 0.4525 - 101s/epoch - 47ms/step
Epoch 9/50
2155/2155 - 99s - loss: 3.0458 - accuracy100: 0.4801 - val_loss: 3.1141 - val_accuracy100: 0.4533 - 99s/epoch - 46ms/step
Epoch 10/50
2155/2155 - 102s - loss: 3.0411 - accuracy100: 0.4815 - val_loss: 3.1140 - val_accuracy100: 0.4534 - 102s/epoch - 47ms/step
Epoch 11/50
2155/2155 - 96s - loss: 3.0376 - accuracy100: 0.4821 - val_loss: 3.1160 - val_accuracy100: 0.4534 - 96s/epoch - 45ms/step
Epoch 12/50
2155/2155 - 99s - loss: 3.0335 - accuracy100: 0.4838 - val_loss: 3.1179 - val_accuracy100: 0.4545 - 99s/epoch - 46ms/step
Epoch 13/50
2155/2155 - 97s - loss: 3.0304 - accuracy100: 0.4847 - val_loss: 3.1181 - val_accuracy100: 0.4543 - 97s/epoch - 45ms/step
Epoch 14/50
2155/2155 - 100s - loss: 3.0279 - accuracy100: 0.4854 - val_loss: 3.1190 - val_accuracy100: 0.4551 - 100s/epoch - 46ms/step
Epoch 15/50
2155/2155 - 103s - loss: 3.0242 - accuracy100: 0.4867 - val_loss: 3.1316 - val_accuracy100: 0.4544 - 103s/epoch - 48ms/step
Epoch 16/50
2155/2155 - 98s - loss: 3.0205 - accuracy100: 0.4880 - val_loss: 3.1274 - val_accuracy100: 0.4548 - 98s/epoch - 45ms/step
Epoch 17/50
2155/2155 - 93s - loss: 3.0161 - accuracy100: 0.4889 - val_loss: 3.1325 - val_accuracy100: 0.4530 - 93s/epoch - 43ms/step
testing model: results/WBA/W3/deepOF_L2/h100
Evaluating performance on  test set...
6315/6315 - 127s - 127s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0367715
{'0': {'precision': 0.4797797899462756, 'recall': 0.3525355101540958, 'f1-score': 0.4064311036693382, 'support': 522597}, '1': {'precision': 0.43045149655300224, 'recall': 0.6797061244607062, 'f1-score': 0.5270972570961423, 'support': 584329}, '2': {'precision': 0.49984503832073196, 'recall': 0.30387704313146696, 'f1-score': 0.37797003659373146, 'support': 509512}, 'accuracy': 0.4554675156114865, 'macro avg': {'precision': 0.47002544160667, 'recall': 0.4453728925820897, 'f1-score': 0.4371661324530707, 'support': 1616438}, 'weighted avg': {'precision': 0.4682727185210604, 'recall': 0.4554675156114865, 'f1-score': 0.44107980504724725, 'support': 1616438}}
[[184234 257560  80803]
 [113035 397172  74122]
 [ 86728 267955 154829]]
Evaluating performance on  train set...
2155/2155 - 49s - 49s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.043782
{'0': {'precision': 0.4816897396070026, 'recall': 0.3881970940974538, 'f1-score': 0.42991927208666675, 'support': 182938}, '1': {'precision': 0.40474115828842105, 'recall': 0.6200246091647166, 'f1-score': 0.4897694408827505, 'support': 182046}, '2': {'precision': 0.4972970383205705, 'recall': 0.3338282669639842, 'f1-score': 0.39948683408704583, 'support': 186557}, 'accuracy': 0.4463258397834431, 'macro avg': {'precision': 0.46124264540533133, 'recall': 0.44734999007538484, 'f1-score': 0.43972518235215435, 'support': 551541}, 'weighted avg': {'precision': 0.461570599581845, 'recall': 0.4463258397834431, 'f1-score': 0.4393802178599757, 'support': 551541}}
[[ 71016  78051  33871]
 [ 40089 112873  29084]
 [ 36326  87953  62278]]
Evaluating performance on  val set...
746/746 - 17s - 17s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0376389
{'0': {'precision': 0.4876791924675545, 'recall': 0.371764819993857, 'f1-score': 0.42190524239783517, 'support': 61859}, '1': {'precision': 0.41981198260137503, 'recall': 0.6719770018566209, 'f1-score': 0.5167738481113229, 'support': 66788}, '2': {'precision': 0.5075765834514335, 'recall': 0.2998744082697324, 'f1-score': 0.37701168039838867, 'support': 62106}, 'accuracy': 0.453471242916232, 'macro avg': {'precision': 0.47168925284012103, 'recall': 0.4478720767067368, 'f1-score': 0.43856359030251557, 'support': 190753}, 'weighted avg': {'precision': 0.47039522918468285, 'recall': 0.453471242916232, 'f1-score': 0.4405048181678351, 'support': 190753}}
[[22997 29277  9585]
 [13425 44880  8483]
 [10734 32748 18624]]
training model: results/WBA/W3/deepOF_L2/h200
Epoch 1/50
2155/2155 - 111s - loss: 3.2661 - accuracy200: 0.3848 - val_loss: 3.2878 - val_accuracy200: 0.3475 - 111s/epoch - 52ms/step
Epoch 2/50
2155/2155 - 102s - loss: 3.2374 - accuracy200: 0.4001 - val_loss: 3.2698 - val_accuracy200: 0.3565 - 102s/epoch - 48ms/step
Epoch 3/50
2155/2155 - 100s - loss: 3.2251 - accuracy200: 0.4067 - val_loss: 3.2654 - val_accuracy200: 0.3683 - 100s/epoch - 47ms/step
Epoch 4/50
2155/2155 - 101s - loss: 3.2173 - accuracy200: 0.4114 - val_loss: 3.2603 - val_accuracy200: 0.3773 - 101s/epoch - 47ms/step
Epoch 5/50
2155/2155 - 104s - loss: 3.2114 - accuracy200: 0.4145 - val_loss: 3.2582 - val_accuracy200: 0.3819 - 104s/epoch - 48ms/step
Epoch 6/50
2155/2155 - 100s - loss: 3.2060 - accuracy200: 0.4171 - val_loss: 3.2559 - val_accuracy200: 0.3841 - 100s/epoch - 47ms/step
Epoch 7/50
2155/2155 - 104s - loss: 3.2026 - accuracy200: 0.4195 - val_loss: 3.2565 - val_accuracy200: 0.3849 - 104s/epoch - 48ms/step
Epoch 8/50
2155/2155 - 103s - loss: 3.1981 - accuracy200: 0.4227 - val_loss: 3.2656 - val_accuracy200: 0.3850 - 103s/epoch - 48ms/step
Epoch 9/50
2155/2155 - 100s - loss: 3.1948 - accuracy200: 0.4245 - val_loss: 3.2572 - val_accuracy200: 0.3872 - 100s/epoch - 46ms/step
Epoch 10/50
2155/2155 - 100s - loss: 3.1915 - accuracy200: 0.4261 - val_loss: 3.2559 - val_accuracy200: 0.3875 - 100s/epoch - 46ms/step
Epoch 11/50
2155/2155 - 101s - loss: 3.1883 - accuracy200: 0.4280 - val_loss: 3.2558 - val_accuracy200: 0.3871 - 101s/epoch - 47ms/step
Epoch 12/50
2155/2155 - 102s - loss: 3.1854 - accuracy200: 0.4297 - val_loss: 3.2529 - val_accuracy200: 0.3891 - 102s/epoch - 47ms/step
Epoch 13/50
2155/2155 - 104s - loss: 3.1818 - accuracy200: 0.4312 - val_loss: 3.2577 - val_accuracy200: 0.3888 - 104s/epoch - 48ms/step
Epoch 14/50
2155/2155 - 103s - loss: 3.1780 - accuracy200: 0.4332 - val_loss: 3.2680 - val_accuracy200: 0.3897 - 103s/epoch - 48ms/step
Epoch 15/50
2155/2155 - 104s - loss: 3.1738 - accuracy200: 0.4350 - val_loss: 3.2636 - val_accuracy200: 0.3893 - 104s/epoch - 48ms/step
Epoch 16/50
2155/2155 - 103s - loss: 3.1694 - accuracy200: 0.4369 - val_loss: 3.2814 - val_accuracy200: 0.3871 - 103s/epoch - 48ms/step
Epoch 17/50
2155/2155 - 99s - loss: 3.1668 - accuracy200: 0.4390 - val_loss: 3.2706 - val_accuracy200: 0.3890 - 99s/epoch - 46ms/step
Epoch 18/50
2155/2155 - 99s - loss: 3.1631 - accuracy200: 0.4402 - val_loss: 3.2726 - val_accuracy200: 0.3876 - 99s/epoch - 46ms/step
Epoch 19/50
2155/2155 - 103s - loss: 3.1571 - accuracy200: 0.4438 - val_loss: 3.2738 - val_accuracy200: 0.3913 - 103s/epoch - 48ms/step
Epoch 20/50
2155/2155 - 103s - loss: 3.1524 - accuracy200: 0.4447 - val_loss: 3.2750 - val_accuracy200: 0.3921 - 103s/epoch - 48ms/step
Epoch 21/50
2155/2155 - 95s - loss: 3.1477 - accuracy200: 0.4468 - val_loss: 3.2642 - val_accuracy200: 0.3900 - 95s/epoch - 44ms/step
Epoch 22/50
2155/2155 - 96s - loss: 3.1422 - accuracy200: 0.4489 - val_loss: 3.2902 - val_accuracy200: 0.3972 - 96s/epoch - 44ms/step
testing model: results/WBA/W3/deepOF_L2/h200
Evaluating performance on  test set...
6315/6315 - 133s - 133s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986059
{'0': {'precision': 0.4274092079690319, 'recall': 0.28507378739588074, 'f1-score': 0.34202405524415674, 'support': 560055}, '1': {'precision': 0.3339124043320974, 'recall': 0.569926093824861, 'f1-score': 0.42110486036768013, 'support': 519713}, '2': {'precision': 0.41813291966310606, 'recall': 0.2772429984906926, 'f1-score': 0.333415125225628, 'support': 536670}, 'accuracy': 0.3740588875045006, 'macro avg': {'precision': 0.39315151065474513, 'recall': 0.37741429323714476, 'f1-score': 0.3655146802791549, 'support': 1616438}, 'weighted avg': {'precision': 0.3942685555260039, 'recall': 0.3740588875045006, 'f1-score': 0.36459168109811335, 'support': 1616438}}
[[159657 302132  98266]
 [114730 296198 108785]
 [ 99159 288723 148788]]
Evaluating performance on  train set...
2155/2155 - 44s - 44s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0821224
{'0': {'precision': 0.43379316603893453, 'recall': 0.3137657137230446, 'f1-score': 0.36414368429072075, 'support': 182802}, '1': {'precision': 0.3543802695950869, 'recall': 0.5973353071798667, 'f1-score': 0.44484686888154357, 'support': 182385}, '2': {'precision': 0.4435676303677555, 'recall': 0.26633718621548236, 'f1-score': 0.33282928023228914, 'support': 186354}, 'accuracy': 0.39151214506265175, 'macro avg': {'precision': 0.4105803553339256, 'recall': 0.39247940237279794, 'f1-score': 0.38060661113485117, 'support': 551541}, 'weighted avg': {'precision': 0.41083528875986, 'recall': 0.39151214506265175, 'f1-score': 0.3802503488318741, 'support': 551541}}
[[ 57357  97070  28375]
 [ 39553 108945  33887]
 [ 35312 101409  49633]]
Evaluating performance on  val set...
746/746 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0846893
{'0': {'precision': 0.42946678918969866, 'recall': 0.28719314278511326, 'f1-score': 0.3442076538850123, 'support': 63466}, '1': {'precision': 0.3579861657700036, 'recall': 0.6024715984353816, 'f1-score': 0.44911188299392435, 'support': 64169}, '2': {'precision': 0.4315831245814628, 'recall': 0.2756899775024557, 'f1-score': 0.33645600703810047, 'support': 63118}, 'accuracy': 0.3894460375459364, 'macro avg': {'precision': 0.406345359847055, 'recall': 0.38845157290765014, 'f1-score': 0.37659184797234574, 'support': 190753}, 'weighted avg': {'precision': 0.40612109466871577, 'recall': 0.3894460375459364, 'f1-score': 0.3769323346607086, 'support': 190753}}
[[18227 34767 10472]
 [13063 38660 12446]
 [11151 34566 17401]]
training model: results/WBA/W3/deepOF_L2/h300
Epoch 1/50
2155/2155 - 103s - loss: 3.2869 - accuracy300: 0.3690 - val_loss: 3.2850 - val_accuracy300: 0.3504 - 103s/epoch - 48ms/step
Epoch 2/50
2155/2155 - 100s - loss: 3.2659 - accuracy300: 0.3814 - val_loss: 3.2750 - val_accuracy300: 0.3671 - 100s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 101s - loss: 3.2588 - accuracy300: 0.3872 - val_loss: 3.2697 - val_accuracy300: 0.3747 - 101s/epoch - 47ms/step
Epoch 4/50
2155/2155 - 104s - loss: 3.2540 - accuracy300: 0.3913 - val_loss: 3.2662 - val_accuracy300: 0.3794 - 104s/epoch - 48ms/step
Epoch 5/50
2155/2155 - 103s - loss: 3.2499 - accuracy300: 0.3939 - val_loss: 3.2638 - val_accuracy300: 0.3810 - 103s/epoch - 48ms/step
Epoch 6/50
2155/2155 - 101s - loss: 3.2461 - accuracy300: 0.3970 - val_loss: 3.2625 - val_accuracy300: 0.3853 - 101s/epoch - 47ms/step
Epoch 7/50
2155/2155 - 102s - loss: 3.2429 - accuracy300: 0.3989 - val_loss: 3.2612 - val_accuracy300: 0.3872 - 102s/epoch - 47ms/step
Epoch 8/50
2155/2155 - 102s - loss: 3.2395 - accuracy300: 0.4007 - val_loss: 3.2611 - val_accuracy300: 0.3886 - 102s/epoch - 47ms/step
Epoch 9/50
2155/2155 - 105s - loss: 3.2364 - accuracy300: 0.4033 - val_loss: 3.2604 - val_accuracy300: 0.3900 - 105s/epoch - 49ms/step
Epoch 10/50
2155/2155 - 104s - loss: 3.2336 - accuracy300: 0.4050 - val_loss: 3.2620 - val_accuracy300: 0.3903 - 104s/epoch - 48ms/step
Epoch 11/50
2155/2155 - 106s - loss: 3.2309 - accuracy300: 0.4071 - val_loss: 3.2623 - val_accuracy300: 0.3887 - 106s/epoch - 49ms/step
Epoch 12/50
2155/2155 - 106s - loss: 3.2277 - accuracy300: 0.4092 - val_loss: 3.2646 - val_accuracy300: 0.3911 - 106s/epoch - 49ms/step
Epoch 13/50
2155/2155 - 103s - loss: 3.2251 - accuracy300: 0.4112 - val_loss: 3.2698 - val_accuracy300: 0.3897 - 103s/epoch - 48ms/step
Epoch 14/50
2155/2155 - 100s - loss: 3.2220 - accuracy300: 0.4128 - val_loss: 3.2663 - val_accuracy300: 0.3904 - 100s/epoch - 46ms/step
Epoch 15/50
2155/2155 - 99s - loss: 3.2191 - accuracy300: 0.4146 - val_loss: 3.2730 - val_accuracy300: 0.3888 - 99s/epoch - 46ms/step
Epoch 16/50
2155/2155 - 101s - loss: 3.2164 - accuracy300: 0.4164 - val_loss: 3.2718 - val_accuracy300: 0.3900 - 101s/epoch - 47ms/step
Epoch 17/50
2155/2155 - 102s - loss: 3.2133 - accuracy300: 0.4183 - val_loss: 3.2722 - val_accuracy300: 0.3893 - 102s/epoch - 47ms/step
Epoch 18/50
2155/2155 - 101s - loss: 3.2100 - accuracy300: 0.4209 - val_loss: 3.2723 - val_accuracy300: 0.3907 - 101s/epoch - 47ms/step
Epoch 19/50
2155/2155 - 101s - loss: 3.2063 - accuracy300: 0.4217 - val_loss: 3.2833 - val_accuracy300: 0.3843 - 101s/epoch - 47ms/step
testing model: results/WBA/W3/deepOF_L2/h300
Evaluating performance on  test set...
6315/6315 - 109s - 109s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088532
{'0': {'precision': 0.3917824441992807, 'recall': 0.5571911560561442, 'f1-score': 0.46007120313387473, 'support': 564047}, '1': {'precision': 0.37256251780909655, 'recall': 0.28312021293515943, 'f1-score': 0.3217409104371004, 'support': 521849}, '2': {'precision': 0.39279506615017024, 'recall': 0.30924036174327385, 'f1-score': 0.3460454658584222, 'support': 530542}, 'accuracy': 0.3873288056826182, 'macro avg': {'precision': 0.38571334271951585, 'recall': 0.38318391024485915, 'f1-score': 0.3759525264764658, 'support': 1616438}, 'weighted avg': {'precision': 0.3859098645570535, 'recall': 0.3873288056826182, 'f1-score': 0.3779876542324556, 'support': 1616438}}
[[314282 123976 125789]
 [246271 147746 127832]
 [241632 124845 164065]]
Evaluating performance on  train set...
2155/2155 - 43s - 43s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0859113
{'0': {'precision': 0.3767057627364828, 'recall': 0.5673805799542775, 'f1-score': 0.4527881073342761, 'support': 182842}, '1': {'precision': 0.38755162977690066, 'recall': 0.29122723839661285, 'f1-score': 0.3325548162091042, 'support': 181391}, '2': {'precision': 0.4175366837333028, 'recall': 0.31173254746193435, 'f1-score': 0.3569594561549372, 'support': 187308}, 'accuracy': 0.3897389314665637, 'macro avg': {'precision': 0.39393135874889545, 'recall': 0.39011345527094154, 'f1-score': 0.3807674598994392, 'support': 551541}, 'weighted avg': {'precision': 0.39413928230873724, 'recall': 0.3897389314665637, 'f1-score': 0.38070151738795177, 'support': 551541}}
[[103741  40471  38630]
 [ 85741  52826  42824]
 [ 85908  43010  58390]]
Evaluating performance on  val set...
746/746 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0874271
{'0': {'precision': 0.38873208500356926, 'recall': 0.5444868323898597, 'f1-score': 0.45361168246156996, 'support': 65008}, '1': {'precision': 0.3749871396530793, 'recall': 0.2961759113292487, 'f1-score': 0.33095432670480346, 'support': 61531}, '2': {'precision': 0.4106538288420517, 'recall': 0.3267823216121095, 'f1-score': 0.3639485574046291, 'support': 64214}, 'accuracy': 0.3911026301028031, 'macro avg': {'precision': 0.39145768449956675, 'recall': 0.389148355110406, 'f1-score': 0.3828381888570009, 'support': 190753}, 'weighted avg': {'precision': 0.39167800263780467, 'recall': 0.3911026301028031, 'f1-score': 0.38386254263427505, 'support': 190753}}
[[35396 14794 14818]
 [28010 18224 15297]
 [27649 15581 20984]]
training model: results/WBA/W3/deepOF_L2/h500
Epoch 1/50
2155/2155 - 106s - loss: 3.2602 - accuracy500: 0.3969 - val_loss: 3.2639 - val_accuracy500: 0.3872 - 106s/epoch - 49ms/step
Epoch 2/50
2155/2155 - 100s - loss: 3.2483 - accuracy500: 0.3975 - val_loss: 3.2609 - val_accuracy500: 0.3896 - 100s/epoch - 46ms/step
Epoch 3/50
2155/2155 - 103s - loss: 3.2512 - accuracy500: 0.3939 - val_loss: 3.2591 - val_accuracy500: 0.3915 - 103s/epoch - 48ms/step
Epoch 4/50
2155/2155 - 103s - loss: 3.2499 - accuracy500: 0.3931 - val_loss: 3.2569 - val_accuracy500: 0.3942 - 103s/epoch - 48ms/step
Epoch 5/50
2155/2155 - 100s - loss: 3.2492 - accuracy500: 0.3931 - val_loss: 3.2555 - val_accuracy500: 0.3955 - 100s/epoch - 46ms/step
Epoch 6/50
2155/2155 - 102s - loss: 3.2470 - accuracy500: 0.3945 - val_loss: 3.2542 - val_accuracy500: 0.3974 - 102s/epoch - 48ms/step
Epoch 7/50
2155/2155 - 99s - loss: 3.2444 - accuracy500: 0.3963 - val_loss: 3.2524 - val_accuracy500: 0.3982 - 99s/epoch - 46ms/step
Epoch 8/50
2155/2155 - 97s - loss: 3.2438 - accuracy500: 0.3955 - val_loss: 3.2508 - val_accuracy500: 0.4005 - 97s/epoch - 45ms/step
Epoch 9/50
2155/2155 - 97s - loss: 3.2420 - accuracy500: 0.3968 - val_loss: 3.2499 - val_accuracy500: 0.3994 - 97s/epoch - 45ms/step
Epoch 10/50
2155/2155 - 99s - loss: 3.2392 - accuracy500: 0.3987 - val_loss: 3.2492 - val_accuracy500: 0.4004 - 99s/epoch - 46ms/step
Epoch 11/50
2155/2155 - 102s - loss: 3.2387 - accuracy500: 0.3987 - val_loss: 3.2487 - val_accuracy500: 0.4010 - 102s/epoch - 47ms/step
Epoch 12/50
2155/2155 - 99s - loss: 3.2365 - accuracy500: 0.4002 - val_loss: 3.2481 - val_accuracy500: 0.4009 - 99s/epoch - 46ms/step
Epoch 13/50
2155/2155 - 95s - loss: 3.2332 - accuracy500: 0.4032 - val_loss: 3.2478 - val_accuracy500: 0.4002 - 95s/epoch - 44ms/step
Epoch 14/50
2155/2155 - 93s - loss: 3.2319 - accuracy500: 0.4038 - val_loss: 3.2476 - val_accuracy500: 0.4013 - 93s/epoch - 43ms/step
Epoch 15/50
2155/2155 - 99s - loss: 3.2306 - accuracy500: 0.4058 - val_loss: 3.2480 - val_accuracy500: 0.4000 - 99s/epoch - 46ms/step
Epoch 16/50
2155/2155 - 100s - loss: 3.2282 - accuracy500: 0.4070 - val_loss: 3.2476 - val_accuracy500: 0.4000 - 100s/epoch - 46ms/step
Epoch 17/50
2155/2155 - 97s - loss: 3.2233 - accuracy500: 0.4092 - val_loss: 3.2499 - val_accuracy500: 0.3976 - 97s/epoch - 45ms/step
Epoch 18/50
2155/2155 - 94s - loss: 3.2239 - accuracy500: 0.4093 - val_loss: 3.2514 - val_accuracy500: 0.3971 - 94s/epoch - 44ms/step
Epoch 19/50
2155/2155 - 97s - loss: 3.2239 - accuracy500: 0.4101 - val_loss: 3.2536 - val_accuracy500: 0.3959 - 97s/epoch - 45ms/step
Epoch 20/50
2155/2155 - 99s - loss: 3.2188 - accuracy500: 0.4131 - val_loss: 3.2552 - val_accuracy500: 0.3942 - 99s/epoch - 46ms/step
Epoch 21/50
2155/2155 - 98s - loss: 3.2181 - accuracy500: 0.4133 - val_loss: 3.2581 - val_accuracy500: 0.3954 - 98s/epoch - 46ms/step
Epoch 22/50
2155/2155 - 97s - loss: 3.2150 - accuracy500: 0.4157 - val_loss: 3.2582 - val_accuracy500: 0.3939 - 97s/epoch - 45ms/step
Epoch 23/50
2155/2155 - 98s - loss: 3.2112 - accuracy500: 0.4176 - val_loss: 3.2596 - val_accuracy500: 0.3942 - 98s/epoch - 46ms/step
Epoch 24/50
2155/2155 - 97s - loss: 3.2087 - accuracy500: 0.4202 - val_loss: 3.2604 - val_accuracy500: 0.3947 - 97s/epoch - 45ms/step
testing model: results/WBA/W3/deepOF_L2/h500
Evaluating performance on  test set...
6315/6315 - 121s - 121s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0779315
{'0': {'precision': 0.42144948276290156, 'recall': 0.5951748737695721, 'f1-score': 0.49346868603309724, 'support': 627424}, '1': {'precision': 0.35839944139496094, 'recall': 0.044968375146929626, 'f1-score': 0.07991039380021969, 'support': 410911}, '2': {'precision': 0.39478836286712227, 'recall': 0.4635731002952761, 'f1-score': 0.4264247014551328, 'support': 578103}, 'accuracy': 0.40824207300249066, 'macro avg': {'precision': 0.3915457623416616, 'recall': 0.3679054497372593, 'f1-score': 0.3332679270961499, 'support': 1616438}, 'weighted avg': {'precision': 0.39588659142797156, 'recall': 0.40824207300249066, 'f1-score': 0.3643613648514751, 'support': 1616438}}
[[373427  17367 236630]
 [218229  18478 174204]
 [294398  15712 267993]]
Evaluating performance on  train set...
2155/2155 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991961
{'0': {'precision': 0.3593147066389755, 'recall': 0.627485248757718, 'f1-score': 0.4569612652384591, 'support': 182527}, '1': {'precision': 0.39520958083832336, 'recall': 0.03296558537790219, 'f1-score': 0.06085507150926859, 'support': 182190}, '2': {'precision': 0.38618043108598743, 'recall': 0.4497762600094206, 'f1-score': 0.4155593030903975, 'support': 186824}, 'accuracy': 0.37090261648726025, 'macro avg': {'precision': 0.38023490618776207, 'recall': 0.3700756980483469, 'f1-score': 0.3111252132793751, 'support': 551541}, 'weighted avg': {'precision': 0.38027207741370983, 'recall': 0.37090261648726025, 'f1-score': 0.3120917675730622, 'support': 551541}}
[[114533   4664  63330]
 [105953   6006  70231]
 [ 98268   4527  84029]]
Evaluating performance on  val set...
746/746 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0825541
{'0': {'precision': 0.4044771050695244, 'recall': 0.6043099560266095, 'f1-score': 0.48460086574215355, 'support': 70952}, '1': {'precision': 0.37551020408163266, 'recall': 0.04274017150268094, 'f1-score': 0.07674527728054778, 'support': 51661}, '2': {'precision': 0.3977075329351947, 'recall': 0.46031699442324625, 'f1-score': 0.4267279789397783, 'support': 68140}, 'accuracy': 0.40078530875005897, 'macro avg': {'precision': 0.3925649473621173, 'recall': 0.3691223739841789, 'f1-score': 0.3293580406541599, 'support': 190753}, 'weighted avg': {'precision': 0.39421389706142645, 'recall': 0.40078530875005897, 'f1-score': 0.3534695804557944, 'support': 190753}}
[[42877  1907 26168]
 [28120  2208 21333]
 [35009  1765 31366]]
training model: results/WBA/W3/deepOF_L2/h1000
Epoch 1/50
2155/2155 - 105s - loss: 3.2886 - accuracy1000: 0.3723 - val_loss: 3.4381 - val_accuracy1000: 0.3076 - 105s/epoch - 49ms/step
Epoch 2/50
2155/2155 - 90s - loss: 3.2720 - accuracy1000: 0.3780 - val_loss: 3.4069 - val_accuracy1000: 0.3081 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 95s - loss: 3.2671 - accuracy1000: 0.3803 - val_loss: 3.3988 - val_accuracy1000: 0.3131 - 95s/epoch - 44ms/step
Epoch 4/50
2155/2155 - 98s - loss: 3.2623 - accuracy1000: 0.3855 - val_loss: 3.3957 - val_accuracy1000: 0.3142 - 98s/epoch - 45ms/step
Epoch 5/50
2155/2155 - 96s - loss: 3.2598 - accuracy1000: 0.3864 - val_loss: 3.3909 - val_accuracy1000: 0.3159 - 96s/epoch - 44ms/step
Epoch 6/50
2155/2155 - 95s - loss: 3.2577 - accuracy1000: 0.3876 - val_loss: 3.3847 - val_accuracy1000: 0.3173 - 95s/epoch - 44ms/step
Epoch 7/50
2155/2155 - 98s - loss: 3.2584 - accuracy1000: 0.3865 - val_loss: 3.3836 - val_accuracy1000: 0.3180 - 98s/epoch - 45ms/step
Epoch 8/50
2155/2155 - 101s - loss: 3.2574 - accuracy1000: 0.3872 - val_loss: 3.3824 - val_accuracy1000: 0.3186 - 101s/epoch - 47ms/step
Epoch 9/50
2155/2155 - 98s - loss: 3.2572 - accuracy1000: 0.3877 - val_loss: 3.3771 - val_accuracy1000: 0.3198 - 98s/epoch - 45ms/step
Epoch 10/50
2155/2155 - 93s - loss: 3.2581 - accuracy1000: 0.3882 - val_loss: 3.4021 - val_accuracy1000: 0.3125 - 93s/epoch - 43ms/step
Epoch 11/50
2155/2155 - 94s - loss: 3.2562 - accuracy1000: 0.3900 - val_loss: 3.3786 - val_accuracy1000: 0.3229 - 94s/epoch - 43ms/step
Epoch 12/50
2155/2155 - 100s - loss: 3.2550 - accuracy1000: 0.3896 - val_loss: 3.3709 - val_accuracy1000: 0.3244 - 100s/epoch - 47ms/step
Epoch 13/50
2155/2155 - 95s - loss: 3.2540 - accuracy1000: 0.3915 - val_loss: 3.3676 - val_accuracy1000: 0.3262 - 95s/epoch - 44ms/step
Epoch 14/50
2155/2155 - 97s - loss: 3.2545 - accuracy1000: 0.3901 - val_loss: 3.3562 - val_accuracy1000: 0.3288 - 97s/epoch - 45ms/step
Epoch 15/50
2155/2155 - 102s - loss: 3.2545 - accuracy1000: 0.3909 - val_loss: 3.3481 - val_accuracy1000: 0.3315 - 102s/epoch - 47ms/step
Epoch 16/50
2155/2155 - 102s - loss: 3.2549 - accuracy1000: 0.3906 - val_loss: 3.3428 - val_accuracy1000: 0.3333 - 102s/epoch - 47ms/step
Epoch 17/50
2155/2155 - 97s - loss: 3.2522 - accuracy1000: 0.3920 - val_loss: 3.3449 - val_accuracy1000: 0.3316 - 97s/epoch - 45ms/step
Epoch 18/50
2155/2155 - 101s - loss: 3.2503 - accuracy1000: 0.3947 - val_loss: 3.3398 - val_accuracy1000: 0.3341 - 101s/epoch - 47ms/step
Epoch 19/50
2155/2155 - 104s - loss: 3.2491 - accuracy1000: 0.3943 - val_loss: 3.3397 - val_accuracy1000: 0.3356 - 104s/epoch - 48ms/step
Epoch 20/50
2155/2155 - 101s - loss: 3.2487 - accuracy1000: 0.3948 - val_loss: 3.3379 - val_accuracy1000: 0.3363 - 101s/epoch - 47ms/step
Epoch 21/50
2155/2155 - 96s - loss: 3.2460 - accuracy1000: 0.3972 - val_loss: 3.3415 - val_accuracy1000: 0.3350 - 96s/epoch - 45ms/step
Epoch 22/50
2155/2155 - 97s - loss: 3.2445 - accuracy1000: 0.3979 - val_loss: 3.3454 - val_accuracy1000: 0.3348 - 97s/epoch - 45ms/step
Epoch 23/50
2155/2155 - 99s - loss: 3.2425 - accuracy1000: 0.3990 - val_loss: 3.3383 - val_accuracy1000: 0.3377 - 99s/epoch - 46ms/step
Epoch 24/50
2155/2155 - 97s - loss: 3.2416 - accuracy1000: 0.4000 - val_loss: 3.3385 - val_accuracy1000: 0.3382 - 97s/epoch - 45ms/step
Epoch 25/50
2155/2155 - 101s - loss: 3.2389 - accuracy1000: 0.4012 - val_loss: 3.3434 - val_accuracy1000: 0.3377 - 101s/epoch - 47ms/step
Epoch 26/50
2155/2155 - 102s - loss: 3.2366 - accuracy1000: 0.4023 - val_loss: 3.3341 - val_accuracy1000: 0.3431 - 102s/epoch - 47ms/step
Epoch 27/50
2155/2155 - 96s - loss: 3.2340 - accuracy1000: 0.4039 - val_loss: 3.3344 - val_accuracy1000: 0.3428 - 96s/epoch - 45ms/step
Epoch 28/50
2155/2155 - 98s - loss: 3.2315 - accuracy1000: 0.4045 - val_loss: 3.3312 - val_accuracy1000: 0.3431 - 98s/epoch - 45ms/step
Epoch 29/50
2155/2155 - 103s - loss: 3.2287 - accuracy1000: 0.4065 - val_loss: 3.3288 - val_accuracy1000: 0.3449 - 103s/epoch - 48ms/step
Epoch 30/50
2155/2155 - 104s - loss: 3.2261 - accuracy1000: 0.4076 - val_loss: 3.3281 - val_accuracy1000: 0.3479 - 104s/epoch - 48ms/step
Epoch 31/50
2155/2155 - 103s - loss: 3.2234 - accuracy1000: 0.4094 - val_loss: 3.3312 - val_accuracy1000: 0.3473 - 103s/epoch - 48ms/step
Epoch 32/50
2155/2155 - 101s - loss: 3.2190 - accuracy1000: 0.4114 - val_loss: 3.3293 - val_accuracy1000: 0.3507 - 101s/epoch - 47ms/step
Epoch 33/50
2155/2155 - 100s - loss: 3.2161 - accuracy1000: 0.4128 - val_loss: 3.3286 - val_accuracy1000: 0.3486 - 100s/epoch - 46ms/step
Epoch 34/50
2155/2155 - 101s - loss: 3.2128 - accuracy1000: 0.4135 - val_loss: 3.3286 - val_accuracy1000: 0.3515 - 101s/epoch - 47ms/step
Epoch 35/50
2155/2155 - 102s - loss: 3.2094 - accuracy1000: 0.4157 - val_loss: 3.3276 - val_accuracy1000: 0.3518 - 102s/epoch - 47ms/step
Epoch 36/50
2155/2155 - 102s - loss: 3.2060 - accuracy1000: 0.4176 - val_loss: 3.3387 - val_accuracy1000: 0.3486 - 102s/epoch - 47ms/step
Epoch 37/50
2155/2155 - 99s - loss: 3.2025 - accuracy1000: 0.4191 - val_loss: 3.3257 - val_accuracy1000: 0.3556 - 99s/epoch - 46ms/step
Epoch 38/50
2155/2155 - 103s - loss: 3.1994 - accuracy1000: 0.4212 - val_loss: 3.3309 - val_accuracy1000: 0.3534 - 103s/epoch - 48ms/step
Epoch 39/50
2155/2155 - 100s - loss: 3.1945 - accuracy1000: 0.4223 - val_loss: 3.3465 - val_accuracy1000: 0.3505 - 100s/epoch - 46ms/step
Epoch 40/50
2155/2155 - 97s - loss: 3.1917 - accuracy1000: 0.4232 - val_loss: 3.3393 - val_accuracy1000: 0.3527 - 97s/epoch - 45ms/step
Epoch 41/50
2155/2155 - 93s - loss: 3.1842 - accuracy1000: 0.4265 - val_loss: 3.3513 - val_accuracy1000: 0.3528 - 93s/epoch - 43ms/step
Epoch 42/50
2155/2155 - 96s - loss: 3.1809 - accuracy1000: 0.4275 - val_loss: 3.3455 - val_accuracy1000: 0.3537 - 96s/epoch - 45ms/step
Epoch 43/50
2155/2155 - 98s - loss: 3.1743 - accuracy1000: 0.4298 - val_loss: 3.3461 - val_accuracy1000: 0.3536 - 98s/epoch - 46ms/step
Epoch 44/50
2155/2155 - 101s - loss: 3.1702 - accuracy1000: 0.4309 - val_loss: 3.3544 - val_accuracy1000: 0.3523 - 101s/epoch - 47ms/step
Epoch 45/50
2155/2155 - 103s - loss: 3.1627 - accuracy1000: 0.4348 - val_loss: 3.3518 - val_accuracy1000: 0.3562 - 103s/epoch - 48ms/step
Epoch 46/50
2155/2155 - 107s - loss: 3.1601 - accuracy1000: 0.4341 - val_loss: 3.3486 - val_accuracy1000: 0.3565 - 107s/epoch - 49ms/step
Epoch 47/50
2155/2155 - 106s - loss: 3.1549 - accuracy1000: 0.4369 - val_loss: 3.3737 - val_accuracy1000: 0.3538 - 106s/epoch - 49ms/step
testing model: results/WBA/W3/deepOF_L2/h1000
Evaluating performance on  test set...
6315/6315 - 128s - 128s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1238958
{'0': {'precision': 0.44281717109981383, 'recall': 0.36438573999296475, 'f1-score': 0.3997910819086502, 'support': 687966}, '1': {'precision': 0.1900028412831512, 'recall': 0.45265076471986687, 'f1-score': 0.26765564093127325, 'support': 302856}, '2': {'precision': 0.40529896386765973, 'recall': 0.2130220454719828, 'f1-score': 0.27926469586718844, 'support': 625616}, 'accuracy': 0.3223402320410681, 'macro avg': {'precision': 0.3460396587502082, 'recall': 0.3433528500616048, 'f1-score': 0.31557047290237067, 'support': 1616438}, 'weighted avg': {'precision': 0.38092903966099184, 'recall': 0.3223402320410681, 'f1-score': 0.3283863966424293, 'support': 1616438}}
[[250685 302100 135181]
 [105400 137088  60368]
 [210029 282317 133270]]
Evaluating performance on  train set...
2155/2155 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0893984
{'0': {'precision': 0.36917000476203815, 'recall': 0.5079311768754301, 'f1-score': 0.4275742842708763, 'support': 181625}, '1': {'precision': 0.39554534865833024, 'recall': 0.39587159494561813, 'f1-score': 0.3957084045576216, 'support': 181862}, '2': {'precision': 0.3993196027951453, 'recall': 0.2540387335552554, 'f1-score': 0.3105268289512171, 'support': 188054}, 'accuracy': 0.38441385137279005, 'macro avg': {'precision': 0.3880116520718379, 'recall': 0.38594716845876786, 'f1-score': 0.37793650592657163, 'support': 551541}, 'weighted avg': {'precision': 0.38814669969529864, 'recall': 0.38441385137279005, 'f1-score': 0.3771583863066359, 'support': 551541}}
[[92253 52618 36754]
 [74759 71994 35109]
 [82881 57400 47773]]
Evaluating performance on  val set...
746/746 - 18s - 18s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1094643
{'0': {'precision': 0.38031850317789045, 'recall': 0.39105341224501783, 'f1-score': 0.3856112607524546, 'support': 68093}, '1': {'precision': 0.32235545530096166, 'recall': 0.4779945074290543, 'f1-score': 0.3850419047889162, 'support': 56804}, '2': {'precision': 0.3797797742960447, 'recall': 0.21053510689990282, 'f1-score': 0.27089601813137426, 'support': 65856}, 'accuracy': 0.35462089718117146, 'macro avg': {'precision': 0.3608179109249656, 'recall': 0.35986100885799166, 'f1-score': 0.34718306122424836, 'support': 190753}, 'weighted avg': {'precision': 0.3628717972238877, 'recall': 0.35462089718117146, 'f1-score': 0.34583716171229945, 'support': 190753}}
[[26628 29084 12381]
 [19390 27152 10262]
 [23997 27994 13865]]
training model: results/WBA/W3/deepVOL_L2/h10
Epoch 1/50
2155/2155 - 98s - loss: 2.7327 - accuracy10: 0.5184 - val_loss: 2.3386 - val_accuracy10: 0.6184 - 98s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 90s - loss: 2.5183 - accuracy10: 0.5723 - val_loss: 2.3178 - val_accuracy10: 0.6328 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 91s - loss: 2.4529 - accuracy10: 0.5929 - val_loss: 2.2759 - val_accuracy10: 0.6419 - 91s/epoch - 42ms/step
Epoch 4/50
2155/2155 - 93s - loss: 2.4167 - accuracy10: 0.6019 - val_loss: 2.2547 - val_accuracy10: 0.6500 - 93s/epoch - 43ms/step
Epoch 5/50
2155/2155 - 92s - loss: 2.3945 - accuracy10: 0.6064 - val_loss: 2.2470 - val_accuracy10: 0.6425 - 92s/epoch - 43ms/step
Epoch 6/50
2155/2155 - 89s - loss: 2.3764 - accuracy10: 0.6110 - val_loss: 2.2528 - val_accuracy10: 0.6527 - 89s/epoch - 41ms/step
Epoch 7/50
2155/2155 - 92s - loss: 2.3623 - accuracy10: 0.6138 - val_loss: 2.2309 - val_accuracy10: 0.6486 - 92s/epoch - 43ms/step
Epoch 8/50
2155/2155 - 95s - loss: 2.3492 - accuracy10: 0.6155 - val_loss: 2.2456 - val_accuracy10: 0.6450 - 95s/epoch - 44ms/step
Epoch 9/50
2155/2155 - 94s - loss: 2.3396 - accuracy10: 0.6171 - val_loss: 2.2181 - val_accuracy10: 0.6493 - 94s/epoch - 44ms/step
Epoch 10/50
2155/2155 - 92s - loss: 2.3306 - accuracy10: 0.6183 - val_loss: 2.2351 - val_accuracy10: 0.6411 - 92s/epoch - 42ms/step
Epoch 11/50
2155/2155 - 89s - loss: 2.3214 - accuracy10: 0.6197 - val_loss: 2.2189 - val_accuracy10: 0.6478 - 89s/epoch - 41ms/step
Epoch 12/50
2155/2155 - 92s - loss: 2.3142 - accuracy10: 0.6210 - val_loss: 2.1880 - val_accuracy10: 0.6630 - 92s/epoch - 43ms/step
Epoch 13/50
2155/2155 - 90s - loss: 2.3064 - accuracy10: 0.6216 - val_loss: 2.1835 - val_accuracy10: 0.6544 - 90s/epoch - 42ms/step
Epoch 14/50
2155/2155 - 89s - loss: 2.3013 - accuracy10: 0.6225 - val_loss: 2.1881 - val_accuracy10: 0.6590 - 89s/epoch - 41ms/step
Epoch 15/50
2155/2155 - 92s - loss: 2.2948 - accuracy10: 0.6233 - val_loss: 2.1851 - val_accuracy10: 0.6649 - 92s/epoch - 43ms/step
Epoch 16/50
2155/2155 - 92s - loss: 2.2880 - accuracy10: 0.6248 - val_loss: 2.1809 - val_accuracy10: 0.6608 - 92s/epoch - 43ms/step
Epoch 17/50
2155/2155 - 91s - loss: 2.2842 - accuracy10: 0.6244 - val_loss: 2.1670 - val_accuracy10: 0.6593 - 91s/epoch - 42ms/step
Epoch 18/50
2155/2155 - 89s - loss: 2.2776 - accuracy10: 0.6261 - val_loss: 2.1569 - val_accuracy10: 0.6558 - 89s/epoch - 41ms/step
Epoch 19/50
2155/2155 - 91s - loss: 2.2729 - accuracy10: 0.6262 - val_loss: 2.1764 - val_accuracy10: 0.6643 - 91s/epoch - 42ms/step
Epoch 20/50
2155/2155 - 89s - loss: 2.2690 - accuracy10: 0.6267 - val_loss: 2.1720 - val_accuracy10: 0.6619 - 89s/epoch - 41ms/step
Epoch 21/50
2155/2155 - 93s - loss: 2.2641 - accuracy10: 0.6277 - val_loss: 2.1557 - val_accuracy10: 0.6704 - 93s/epoch - 43ms/step
Epoch 22/50
2155/2155 - 89s - loss: 2.2605 - accuracy10: 0.6277 - val_loss: 2.1501 - val_accuracy10: 0.6700 - 89s/epoch - 41ms/step
Epoch 23/50
2155/2155 - 92s - loss: 2.2562 - accuracy10: 0.6286 - val_loss: 2.1532 - val_accuracy10: 0.6697 - 92s/epoch - 43ms/step
Epoch 24/50
2155/2155 - 91s - loss: 2.2527 - accuracy10: 0.6291 - val_loss: 2.1562 - val_accuracy10: 0.6676 - 91s/epoch - 42ms/step
Epoch 25/50
2155/2155 - 93s - loss: 2.2491 - accuracy10: 0.6294 - val_loss: 2.1663 - val_accuracy10: 0.6692 - 93s/epoch - 43ms/step
Epoch 26/50
2155/2155 - 93s - loss: 2.2465 - accuracy10: 0.6293 - val_loss: 2.1613 - val_accuracy10: 0.6717 - 93s/epoch - 43ms/step
Epoch 27/50
2155/2155 - 91s - loss: 2.2419 - accuracy10: 0.6299 - val_loss: 2.1573 - val_accuracy10: 0.6692 - 91s/epoch - 42ms/step
Epoch 28/50
2155/2155 - 91s - loss: 2.2403 - accuracy10: 0.6297 - val_loss: 2.1414 - val_accuracy10: 0.6748 - 91s/epoch - 42ms/step
Epoch 29/50
2155/2155 - 92s - loss: 2.2363 - accuracy10: 0.6307 - val_loss: 2.1368 - val_accuracy10: 0.6773 - 92s/epoch - 43ms/step
Epoch 30/50
2155/2155 - 92s - loss: 2.2342 - accuracy10: 0.6304 - val_loss: 2.1270 - val_accuracy10: 0.6788 - 92s/epoch - 42ms/step
Epoch 31/50
2155/2155 - 91s - loss: 2.2308 - accuracy10: 0.6308 - val_loss: 2.1656 - val_accuracy10: 0.6712 - 91s/epoch - 42ms/step
Epoch 32/50
2155/2155 - 90s - loss: 2.2267 - accuracy10: 0.6313 - val_loss: 2.1523 - val_accuracy10: 0.6811 - 90s/epoch - 42ms/step
Epoch 33/50
2155/2155 - 91s - loss: 2.2247 - accuracy10: 0.6315 - val_loss: 2.1331 - val_accuracy10: 0.6791 - 91s/epoch - 42ms/step
Epoch 34/50
2155/2155 - 93s - loss: 2.2207 - accuracy10: 0.6319 - val_loss: 2.1505 - val_accuracy10: 0.6746 - 93s/epoch - 43ms/step
Epoch 35/50
2155/2155 - 89s - loss: 2.2181 - accuracy10: 0.6323 - val_loss: 2.1363 - val_accuracy10: 0.6732 - 89s/epoch - 41ms/step
Epoch 36/50
2155/2155 - 92s - loss: 2.2169 - accuracy10: 0.6323 - val_loss: 2.1503 - val_accuracy10: 0.6784 - 92s/epoch - 43ms/step
Epoch 37/50
2155/2155 - 92s - loss: 2.2130 - accuracy10: 0.6329 - val_loss: 2.1453 - val_accuracy10: 0.6772 - 92s/epoch - 43ms/step
Epoch 38/50
2155/2155 - 92s - loss: 2.2104 - accuracy10: 0.6330 - val_loss: 2.1289 - val_accuracy10: 0.6764 - 92s/epoch - 43ms/step
Epoch 39/50
2155/2155 - 91s - loss: 2.2083 - accuracy10: 0.6336 - val_loss: 2.1494 - val_accuracy10: 0.6779 - 91s/epoch - 42ms/step
Epoch 40/50
2155/2155 - 91s - loss: 2.2060 - accuracy10: 0.6335 - val_loss: 2.1352 - val_accuracy10: 0.6803 - 91s/epoch - 42ms/step
testing model: results/WBA/W3/deepVOL_L2/h10
Evaluating performance on  test set...
6315/6315 - 122s - 122s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6985884
{'0': {'precision': 0.3908278823951201, 'recall': 0.6914437791084498, 'f1-score': 0.4993857228208377, 'support': 225450}, '1': {'precision': 0.8764864562381217, 'recall': 0.718783882080068, 'f1-score': 0.7898402201467866, 'support': 1165808}, '2': {'precision': 0.4563686279308077, 'recall': 0.5300332172800909, 'f1-score': 0.49045028312198485, 'support': 225184}, 'accuracy': 0.6886761170521429, 'macro avg': {'precision': 0.5745609888546831, 'recall': 0.6467536261562029, 'f1-score': 0.5932254086965364, 'support': 1616442}, 'weighted avg': {'precision': 0.7502242466924288, 'recall': 0.6886761170521429, 'f1-score': 0.7076221201462124, 'support': 1616442}}
[[155886  49489  20075]
 [205742 837964 122102]
 [ 37233  68596 119355]]
Evaluating performance on  train set...
2155/2155 - 43s - 43s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7822443
{'0': {'precision': 0.3977747389358528, 'recall': 0.7182589566310497, 'f1-score': 0.5120011521106026, 'support': 89096}, '1': {'precision': 0.8564131589244788, 'recall': 0.6626782228806549, 'f1-score': 0.7471918503458178, 'support': 369902}, '2': {'precision': 0.47742658253301035, 'recall': 0.5387873745177917, 'f1-score': 0.5062544420753377, 'support': 92543}, 'accuracy': 0.6508691103653219, 'macro avg': {'precision': 0.5772048267977806, 'recall': 0.6399081846764987, 'f1-score': 0.588482481510586, 'support': 551541}, 'weighted avg': {'precision': 0.7187345395538386, 'recall': 0.6508691103653219, 'f1-score': 0.6687722568368315, 'support': 551541}}
[[ 63994  16398   8704]
 [ 78904 245126  45872]
 [ 17982  24700  49861]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7242206
{'0': {'precision': 0.3837663508343182, 'recall': 0.7154380461572933, 'f1-score': 0.49956322768223843, 'support': 26778}, '1': {'precision': 0.8807841412114047, 'recall': 0.7003767699808335, 'f1-score': 0.7802883912768134, 'support': 137219}, '2': {'precision': 0.4412358133669609, 'recall': 0.523078073027619, 'f1-score': 0.47868392701403967, 'support': 26757}, 'accuracy': 0.6776214391310273, 'macro avg': {'precision': 0.5685954351375613, 'recall': 0.6462976297219153, 'f1-score': 0.5861785153243638, 'support': 190754}, 'weighted avg': {'precision': 0.7493576075667555, 'recall': 0.6776214391310273, 'f1-score': 0.6985743035983659, 'support': 190754}}
[[19158  5247  2373]
 [25763 96105 15351]
 [ 5000  7761 13996]]
training model: results/WBA/W3/deepVOL_L2/h20
Epoch 1/50
2155/2155 - 100s - loss: 2.8130 - accuracy20: 0.5346 - val_loss: 2.5812 - val_accuracy20: 0.5795 - 100s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 94s - loss: 2.6083 - accuracy20: 0.5812 - val_loss: 2.4890 - val_accuracy20: 0.6132 - 94s/epoch - 44ms/step
Epoch 3/50
2155/2155 - 91s - loss: 2.5577 - accuracy20: 0.5939 - val_loss: 2.4389 - val_accuracy20: 0.6333 - 91s/epoch - 42ms/step
Epoch 4/50
2155/2155 - 91s - loss: 2.5342 - accuracy20: 0.5990 - val_loss: 2.4451 - val_accuracy20: 0.6341 - 91s/epoch - 42ms/step
Epoch 5/50
2155/2155 - 89s - loss: 2.5192 - accuracy20: 0.6027 - val_loss: 2.4120 - val_accuracy20: 0.6430 - 89s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 92s - loss: 2.5069 - accuracy20: 0.6039 - val_loss: 2.4100 - val_accuracy20: 0.6412 - 92s/epoch - 43ms/step
Epoch 7/50
2155/2155 - 92s - loss: 2.4973 - accuracy20: 0.6051 - val_loss: 2.4118 - val_accuracy20: 0.6422 - 92s/epoch - 43ms/step
Epoch 8/50
2155/2155 - 92s - loss: 2.4875 - accuracy20: 0.6063 - val_loss: 2.4320 - val_accuracy20: 0.6391 - 92s/epoch - 43ms/step
Epoch 9/50
2155/2155 - 90s - loss: 2.4799 - accuracy20: 0.6076 - val_loss: 2.4012 - val_accuracy20: 0.6405 - 90s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 92s - loss: 2.4723 - accuracy20: 0.6085 - val_loss: 2.3952 - val_accuracy20: 0.6462 - 92s/epoch - 43ms/step
Epoch 11/50
2155/2155 - 91s - loss: 2.4665 - accuracy20: 0.6095 - val_loss: 2.3834 - val_accuracy20: 0.6481 - 91s/epoch - 42ms/step
Epoch 12/50
2155/2155 - 92s - loss: 2.4597 - accuracy20: 0.6108 - val_loss: 2.3835 - val_accuracy20: 0.6459 - 92s/epoch - 42ms/step
Epoch 13/50
2155/2155 - 89s - loss: 2.4547 - accuracy20: 0.6122 - val_loss: 2.3830 - val_accuracy20: 0.6483 - 89s/epoch - 41ms/step
Epoch 14/50
2155/2155 - 91s - loss: 2.4507 - accuracy20: 0.6120 - val_loss: 2.3770 - val_accuracy20: 0.6487 - 91s/epoch - 42ms/step
Epoch 15/50
2155/2155 - 89s - loss: 2.4458 - accuracy20: 0.6131 - val_loss: 2.3760 - val_accuracy20: 0.6507 - 89s/epoch - 41ms/step
Epoch 16/50
2155/2155 - 91s - loss: 2.4418 - accuracy20: 0.6136 - val_loss: 2.3865 - val_accuracy20: 0.6514 - 91s/epoch - 42ms/step
Epoch 17/50
2155/2155 - 91s - loss: 2.4364 - accuracy20: 0.6143 - val_loss: 2.3784 - val_accuracy20: 0.6512 - 91s/epoch - 42ms/step
Epoch 18/50
2155/2155 - 88s - loss: 2.4322 - accuracy20: 0.6152 - val_loss: 2.3846 - val_accuracy20: 0.6536 - 88s/epoch - 41ms/step
Epoch 19/50
2155/2155 - 94s - loss: 2.4287 - accuracy20: 0.6149 - val_loss: 2.3907 - val_accuracy20: 0.6507 - 94s/epoch - 43ms/step
Epoch 20/50
2155/2155 - 91s - loss: 2.4251 - accuracy20: 0.6160 - val_loss: 2.3812 - val_accuracy20: 0.6485 - 91s/epoch - 42ms/step
Epoch 21/50
2155/2155 - 93s - loss: 2.4223 - accuracy20: 0.6159 - val_loss: 2.3815 - val_accuracy20: 0.6499 - 93s/epoch - 43ms/step
Epoch 22/50
2155/2155 - 94s - loss: 2.4179 - accuracy20: 0.6166 - val_loss: 2.3832 - val_accuracy20: 0.6474 - 94s/epoch - 44ms/step
Epoch 23/50
2155/2155 - 94s - loss: 2.4149 - accuracy20: 0.6171 - val_loss: 2.3792 - val_accuracy20: 0.6475 - 94s/epoch - 44ms/step
Epoch 24/50
2155/2155 - 93s - loss: 2.4118 - accuracy20: 0.6175 - val_loss: 2.3863 - val_accuracy20: 0.6474 - 93s/epoch - 43ms/step
Epoch 25/50
2155/2155 - 92s - loss: 2.4086 - accuracy20: 0.6183 - val_loss: 2.3758 - val_accuracy20: 0.6468 - 92s/epoch - 42ms/step
Epoch 26/50
2155/2155 - 93s - loss: 2.4062 - accuracy20: 0.6184 - val_loss: 2.3772 - val_accuracy20: 0.6437 - 93s/epoch - 43ms/step
Epoch 27/50
2155/2155 - 91s - loss: 2.4013 - accuracy20: 0.6190 - val_loss: 2.3827 - val_accuracy20: 0.6436 - 91s/epoch - 42ms/step
Epoch 28/50
2155/2155 - 92s - loss: 2.3988 - accuracy20: 0.6188 - val_loss: 2.3943 - val_accuracy20: 0.6440 - 92s/epoch - 43ms/step
Epoch 29/50
2155/2155 - 93s - loss: 2.3963 - accuracy20: 0.6194 - val_loss: 2.3829 - val_accuracy20: 0.6416 - 93s/epoch - 43ms/step
Epoch 30/50
2155/2155 - 92s - loss: 2.3931 - accuracy20: 0.6200 - val_loss: 2.3898 - val_accuracy20: 0.6467 - 92s/epoch - 43ms/step
Epoch 31/50
2155/2155 - 90s - loss: 2.3901 - accuracy20: 0.6200 - val_loss: 2.3877 - val_accuracy20: 0.6477 - 90s/epoch - 42ms/step
Epoch 32/50
2155/2155 - 90s - loss: 2.3881 - accuracy20: 0.6204 - val_loss: 2.3943 - val_accuracy20: 0.6421 - 90s/epoch - 42ms/step
Epoch 33/50
2155/2155 - 93s - loss: 2.3841 - accuracy20: 0.6212 - val_loss: 2.4011 - val_accuracy20: 0.6423 - 93s/epoch - 43ms/step
Epoch 34/50
2155/2155 - 92s - loss: 2.3824 - accuracy20: 0.6213 - val_loss: 2.4024 - val_accuracy20: 0.6461 - 92s/epoch - 43ms/step
Epoch 35/50
2155/2155 - 89s - loss: 2.3796 - accuracy20: 0.6214 - val_loss: 2.3911 - val_accuracy20: 0.6423 - 89s/epoch - 41ms/step
testing model: results/WBA/W3/deepVOL_L2/h20
Evaluating performance on  test set...
6315/6315 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7693334
{'0': {'precision': 0.45355453352453806, 'recall': 0.6119580964019277, 'f1-score': 0.5209818469618621, 'support': 304413}, '1': {'precision': 0.7817912641409238, 'recall': 0.7234387052389457, 'f1-score': 0.7514839212645195, 'support': 1007321}, '2': {'precision': 0.520041816227913, 'recall': 0.4669125851635008, 'f1-score': 0.4920471877237215, 'support': 304708}, 'accuracy': 0.6540878051918968, 'macro avg': {'precision': 0.5851292046311249, 'recall': 0.600769795601458, 'f1-score': 0.5881709853167011, 'support': 1616442}, 'weighted avg': {'precision': 0.6706356033428231, 'recall': 0.6540878051918968, 'f1-score': 0.6591698907280423, 'support': 1616442}}
[[186288  91335  26790]
 [174070 728735 104516]
 [ 50371 112065 142272]]
Evaluating performance on  train set...
2155/2155 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8316245
{'0': {'precision': 0.4647667641245524, 'recall': 0.6231690176621002, 'f1-score': 0.5324362939250901, 'support': 118106}, '1': {'precision': 0.7444795281778792, 'recall': 0.6880021338680858, 'f1-score': 0.7151274848097164, 'support': 311172}, '2': {'precision': 0.5413668383578246, 'recall': 0.4676557912042073, 'f1-score': 0.5018189477749156, 'support': 122263}, 'accuracy': 0.6252735517395805, 'macro avg': {'precision': 0.5835377102200855, 'recall': 0.5929423142447977, 'f1-score': 0.5831275755032407, 'support': 551541}, 'weighted avg': {'precision': 0.6395572785051412, 'recall': 0.6252735517395805, 'f1-score': 0.628721093527644, 'support': 551541}}
[[ 73600  32079  12427]
 [ 61073 214087  36012]
 [ 23686  41400  57177]]
Evaluating performance on  val set...
746/746 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78843933
{'0': {'precision': 0.4530027919133517, 'recall': 0.6347594473114699, 'f1-score': 0.5286960540759142, 'support': 36042}, '1': {'precision': 0.7876161224066781, 'recall': 0.706506765379512, 'f1-score': 0.7448599088483077, 'support': 118323}, '2': {'precision': 0.5006302582593146, 'recall': 0.46931765093847044, 'f1-score': 0.4844685257155826, 'support': 36389}, 'accuracy': 0.6477033247009237, 'macro avg': {'precision': 0.5804163908597815, 'recall': 0.6035279545431508, 'f1-score': 0.5860081628799348, 'support': 190754}, 'weighted avg': {'precision': 0.6696460548427011, 'recall': 0.6477033247009237, 'f1-score': 0.6543435385780992, 'support': 190754}}
[[22878  9758  3406]
 [21098 83596 13629]
 [ 6527 12784 17078]]
training model: results/WBA/W3/deepVOL_L2/h30
Epoch 1/50
2155/2155 - 102s - loss: 2.8964 - accuracy30: 0.5192 - val_loss: 2.6818 - val_accuracy30: 0.5750 - 102s/epoch - 47ms/step
Epoch 2/50
2155/2155 - 95s - loss: 2.7269 - accuracy30: 0.5598 - val_loss: 2.6566 - val_accuracy30: 0.5742 - 95s/epoch - 44ms/step
Epoch 3/50
2155/2155 - 94s - loss: 2.6754 - accuracy30: 0.5732 - val_loss: 2.6195 - val_accuracy30: 0.6083 - 94s/epoch - 43ms/step
Epoch 4/50
2155/2155 - 93s - loss: 2.6498 - accuracy30: 0.5798 - val_loss: 2.6126 - val_accuracy30: 0.6168 - 93s/epoch - 43ms/step
Epoch 5/50
2155/2155 - 91s - loss: 2.6357 - accuracy30: 0.5825 - val_loss: 2.6244 - val_accuracy30: 0.6212 - 91s/epoch - 42ms/step
Epoch 6/50
2155/2155 - 94s - loss: 2.6250 - accuracy30: 0.5851 - val_loss: 2.5927 - val_accuracy30: 0.6167 - 94s/epoch - 44ms/step
Epoch 7/50
2155/2155 - 92s - loss: 2.6150 - accuracy30: 0.5859 - val_loss: 2.6017 - val_accuracy30: 0.6155 - 92s/epoch - 43ms/step
Epoch 8/50
2155/2155 - 94s - loss: 2.6069 - accuracy30: 0.5875 - val_loss: 2.5939 - val_accuracy30: 0.6161 - 94s/epoch - 43ms/step
Epoch 9/50
2155/2155 - 94s - loss: 2.5995 - accuracy30: 0.5888 - val_loss: 2.6080 - val_accuracy30: 0.6157 - 94s/epoch - 44ms/step
Epoch 10/50
2155/2155 - 93s - loss: 2.5927 - accuracy30: 0.5902 - val_loss: 2.5951 - val_accuracy30: 0.6178 - 93s/epoch - 43ms/step
Epoch 11/50
2155/2155 - 91s - loss: 2.5865 - accuracy30: 0.5917 - val_loss: 2.5945 - val_accuracy30: 0.6199 - 91s/epoch - 42ms/step
Epoch 12/50
2155/2155 - 91s - loss: 2.5804 - accuracy30: 0.5927 - val_loss: 2.5824 - val_accuracy30: 0.6186 - 91s/epoch - 42ms/step
Epoch 13/50
2155/2155 - 94s - loss: 2.5756 - accuracy30: 0.5937 - val_loss: 2.5984 - val_accuracy30: 0.6138 - 94s/epoch - 44ms/step
Epoch 14/50
2155/2155 - 89s - loss: 2.5710 - accuracy30: 0.5940 - val_loss: 2.5838 - val_accuracy30: 0.6182 - 89s/epoch - 41ms/step
Epoch 15/50
2155/2155 - 94s - loss: 2.5666 - accuracy30: 0.5943 - val_loss: 2.5836 - val_accuracy30: 0.6155 - 94s/epoch - 44ms/step
Epoch 16/50
2155/2155 - 95s - loss: 2.5612 - accuracy30: 0.5954 - val_loss: 2.5839 - val_accuracy30: 0.6123 - 95s/epoch - 44ms/step
Epoch 17/50
2155/2155 - 93s - loss: 2.5577 - accuracy30: 0.5958 - val_loss: 2.5905 - val_accuracy30: 0.6129 - 93s/epoch - 43ms/step
Epoch 18/50
2155/2155 - 102s - loss: 2.5538 - accuracy30: 0.5961 - val_loss: 2.5776 - val_accuracy30: 0.6167 - 102s/epoch - 47ms/step
Epoch 19/50
2155/2155 - 94s - loss: 2.5505 - accuracy30: 0.5964 - val_loss: 2.5786 - val_accuracy30: 0.6205 - 94s/epoch - 44ms/step
Epoch 20/50
2155/2155 - 96s - loss: 2.5467 - accuracy30: 0.5973 - val_loss: 2.5839 - val_accuracy30: 0.6166 - 96s/epoch - 44ms/step
Epoch 21/50
2155/2155 - 94s - loss: 2.5434 - accuracy30: 0.5979 - val_loss: 2.5729 - val_accuracy30: 0.6138 - 94s/epoch - 44ms/step
Epoch 22/50
2155/2155 - 90s - loss: 2.5413 - accuracy30: 0.5980 - val_loss: 2.5792 - val_accuracy30: 0.6152 - 90s/epoch - 42ms/step
Epoch 23/50
2155/2155 - 95s - loss: 2.5379 - accuracy30: 0.5986 - val_loss: 2.5661 - val_accuracy30: 0.6189 - 95s/epoch - 44ms/step
Epoch 24/50
2155/2155 - 94s - loss: 2.5346 - accuracy30: 0.5985 - val_loss: 2.5697 - val_accuracy30: 0.6168 - 94s/epoch - 44ms/step
Epoch 25/50
2155/2155 - 96s - loss: 2.5320 - accuracy30: 0.5993 - val_loss: 2.5566 - val_accuracy30: 0.6146 - 96s/epoch - 44ms/step
Epoch 26/50
2155/2155 - 93s - loss: 2.5289 - accuracy30: 0.5998 - val_loss: 2.5669 - val_accuracy30: 0.6146 - 93s/epoch - 43ms/step
Epoch 27/50
2155/2155 - 96s - loss: 2.5260 - accuracy30: 0.6004 - val_loss: 2.5692 - val_accuracy30: 0.6150 - 96s/epoch - 44ms/step
Epoch 28/50
2155/2155 - 91s - loss: 2.5245 - accuracy30: 0.6007 - val_loss: 2.5648 - val_accuracy30: 0.6139 - 91s/epoch - 42ms/step
Epoch 29/50
2155/2155 - 87s - loss: 2.5218 - accuracy30: 0.6010 - val_loss: 2.5571 - val_accuracy30: 0.6181 - 87s/epoch - 41ms/step
Epoch 30/50
2155/2155 - 88s - loss: 2.5184 - accuracy30: 0.6013 - val_loss: 2.5590 - val_accuracy30: 0.6152 - 88s/epoch - 41ms/step
Epoch 31/50
2155/2155 - 92s - loss: 2.5158 - accuracy30: 0.6020 - val_loss: 2.5571 - val_accuracy30: 0.6154 - 92s/epoch - 43ms/step
Epoch 32/50
2155/2155 - 88s - loss: 2.5150 - accuracy30: 0.6018 - val_loss: 2.5673 - val_accuracy30: 0.6147 - 88s/epoch - 41ms/step
Epoch 33/50
2155/2155 - 88s - loss: 2.5104 - accuracy30: 0.6027 - val_loss: 2.5784 - val_accuracy30: 0.6132 - 88s/epoch - 41ms/step
Epoch 34/50
2155/2155 - 89s - loss: 2.5090 - accuracy30: 0.6031 - val_loss: 2.5751 - val_accuracy30: 0.6136 - 89s/epoch - 41ms/step
Epoch 35/50
2155/2155 - 87s - loss: 2.5064 - accuracy30: 0.6035 - val_loss: 2.5685 - val_accuracy30: 0.6156 - 87s/epoch - 40ms/step
testing model: results/WBA/W3/deepVOL_L2/h30
Evaluating performance on  test set...
6315/6315 - 112s - 112s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82958454
{'0': {'precision': 0.49808475381828926, 'recall': 0.5356354484096177, 'f1-score': 0.5161780719433654, 'support': 361957}, '1': {'precision': 0.7007966844113535, 'recall': 0.7098719472539302, 'f1-score': 0.7053051238616102, 'support': 891820}, '2': {'precision': 0.5258501426683301, 'recall': 0.4695380033915597, 'f1-score': 0.4961011984098891, 'support': 362665}, 'accuracy': 0.6169352194511155, 'macro avg': {'precision': 0.5749105269659909, 'recall': 0.571681799685036, 'f1-score': 0.5725281314049548, 'support': 1616442}, 'weighted avg': {'precision': 0.6161540001561143, 'recall': 0.6169352194511155, 'f1-score': 0.616018405281469, 'support': 1616442}}
[[193877 129737  38343]
 [143542 633078 115200]
 [ 51826 140554 170285]]
Evaluating performance on  train set...
2155/2155 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8774613
{'0': {'precision': 0.5088008912982928, 'recall': 0.5416883642886073, 'f1-score': 0.5247298267738602, 'support': 138264}, '1': {'precision': 0.6532828149941238, 'recall': 0.6881584928251767, 'f1-score': 0.6702672934468833, 'support': 270599}, '2': {'precision': 0.5506349805104992, 'recall': 0.4603933332398828, 'f1-score': 0.5014867944406485, 'support': 142678}, 'accuracy': 0.5925198670633733, 'macro avg': {'precision': 0.5709062289343052, 'recall': 0.5634133967845557, 'f1-score': 0.565494638220464, 'support': 551541}, 'weighted avg': {'precision': 0.5905091745461154, 'recall': 0.5925198670633733, 'f1-score': 0.5901212003562691, 'support': 551541}}
[[ 74896  45819  17549]
 [ 48326 186215  36058]
 [ 23979  53011  65688]]
Evaluating performance on  val set...
746/746 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83925176
{'0': {'precision': 0.501870017738454, 'recall': 0.5469303148872741, 'f1-score': 0.5234321887503204, 'support': 42936}, '1': {'precision': 0.7003210136075679, 'recall': 0.7083840193101598, 'f1-score': 0.7043294413439743, 'support': 104401}, '2': {'precision': 0.5172054223149114, 'recall': 0.45696386208167306, 'f1-score': 0.48522200618755884, 'support': 43417}, 'accuracy': 0.614818037891735, 'macro avg': {'precision': 0.573132151220311, 'recall': 0.5707593987597024, 'f1-score': 0.5709945454272845, 'support': 190754}, 'weighted avg': {'precision': 0.61397408727423, 'recall': 0.614818037891735, 'f1-score': 0.6137416059667491, 'support': 190754}}
[[23483 14659  4794]
 [16719 73956 13726]
 [ 6589 16988 19840]]
training model: results/WBA/W3/deepVOL_L2/h50
Epoch 1/50
2155/2155 - 97s - loss: 3.0152 - accuracy50: 0.4894 - val_loss: 2.9905 - val_accuracy50: 0.5121 - 97s/epoch - 45ms/step
Epoch 2/50
2155/2155 - 89s - loss: 2.8700 - accuracy50: 0.5274 - val_loss: 2.9220 - val_accuracy50: 0.5369 - 89s/epoch - 41ms/step
Epoch 3/50
2155/2155 - 89s - loss: 2.8339 - accuracy50: 0.5362 - val_loss: 2.8787 - val_accuracy50: 0.5405 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 89s - loss: 2.8146 - accuracy50: 0.5414 - val_loss: 2.8599 - val_accuracy50: 0.5449 - 89s/epoch - 41ms/step
Epoch 5/50
2155/2155 - 88s - loss: 2.8017 - accuracy50: 0.5443 - val_loss: 2.8482 - val_accuracy50: 0.5475 - 88s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 85s - loss: 2.7938 - accuracy50: 0.5462 - val_loss: 2.8454 - val_accuracy50: 0.5468 - 85s/epoch - 39ms/step
Epoch 7/50
2155/2155 - 88s - loss: 2.7864 - accuracy50: 0.5477 - val_loss: 2.8537 - val_accuracy50: 0.5471 - 88s/epoch - 41ms/step
Epoch 8/50
2155/2155 - 89s - loss: 2.7807 - accuracy50: 0.5481 - val_loss: 2.8411 - val_accuracy50: 0.5458 - 89s/epoch - 41ms/step
Epoch 9/50
2155/2155 - 91s - loss: 2.7741 - accuracy50: 0.5496 - val_loss: 2.8499 - val_accuracy50: 0.5468 - 91s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 91s - loss: 2.7692 - accuracy50: 0.5511 - val_loss: 2.8418 - val_accuracy50: 0.5470 - 91s/epoch - 42ms/step
Epoch 11/50
2155/2155 - 89s - loss: 2.7647 - accuracy50: 0.5518 - val_loss: 2.8285 - val_accuracy50: 0.5479 - 89s/epoch - 41ms/step
Epoch 12/50
2155/2155 - 89s - loss: 2.7595 - accuracy50: 0.5532 - val_loss: 2.8336 - val_accuracy50: 0.5454 - 89s/epoch - 42ms/step
Epoch 13/50
2155/2155 - 89s - loss: 2.7560 - accuracy50: 0.5534 - val_loss: 2.8253 - val_accuracy50: 0.5471 - 89s/epoch - 41ms/step
Epoch 14/50
2155/2155 - 90s - loss: 2.7518 - accuracy50: 0.5540 - val_loss: 2.8233 - val_accuracy50: 0.5482 - 90s/epoch - 42ms/step
Epoch 15/50
2155/2155 - 91s - loss: 2.7481 - accuracy50: 0.5547 - val_loss: 2.8254 - val_accuracy50: 0.5485 - 91s/epoch - 42ms/step
Epoch 16/50
2155/2155 - 92s - loss: 2.7449 - accuracy50: 0.5554 - val_loss: 2.8188 - val_accuracy50: 0.5490 - 92s/epoch - 43ms/step
Epoch 17/50
2155/2155 - 90s - loss: 2.7416 - accuracy50: 0.5567 - val_loss: 2.8194 - val_accuracy50: 0.5494 - 90s/epoch - 42ms/step
Epoch 18/50
2155/2155 - 92s - loss: 2.7383 - accuracy50: 0.5577 - val_loss: 2.8165 - val_accuracy50: 0.5508 - 92s/epoch - 43ms/step
Epoch 19/50
2155/2155 - 90s - loss: 2.7346 - accuracy50: 0.5580 - val_loss: 2.8311 - val_accuracy50: 0.5469 - 90s/epoch - 42ms/step
Epoch 20/50
2155/2155 - 91s - loss: 2.7323 - accuracy50: 0.5576 - val_loss: 2.8209 - val_accuracy50: 0.5458 - 91s/epoch - 42ms/step
Epoch 21/50
2155/2155 - 95s - loss: 2.7292 - accuracy50: 0.5587 - val_loss: 2.8188 - val_accuracy50: 0.5467 - 95s/epoch - 44ms/step
Epoch 22/50
2155/2155 - 92s - loss: 2.7269 - accuracy50: 0.5591 - val_loss: 2.8230 - val_accuracy50: 0.5460 - 92s/epoch - 43ms/step
Epoch 23/50
2155/2155 - 91s - loss: 2.7232 - accuracy50: 0.5599 - val_loss: 2.8347 - val_accuracy50: 0.5455 - 91s/epoch - 42ms/step
Epoch 24/50
2155/2155 - 91s - loss: 2.7212 - accuracy50: 0.5603 - val_loss: 2.8413 - val_accuracy50: 0.5426 - 91s/epoch - 42ms/step
Epoch 25/50
2155/2155 - 94s - loss: 2.7180 - accuracy50: 0.5610 - val_loss: 2.8283 - val_accuracy50: 0.5442 - 94s/epoch - 44ms/step
Epoch 26/50
2155/2155 - 93s - loss: 2.7160 - accuracy50: 0.5614 - val_loss: 2.8289 - val_accuracy50: 0.5458 - 93s/epoch - 43ms/step
Epoch 27/50
2155/2155 - 89s - loss: 2.7139 - accuracy50: 0.5616 - val_loss: 2.8435 - val_accuracy50: 0.5446 - 89s/epoch - 41ms/step
Epoch 28/50
2155/2155 - 91s - loss: 2.7114 - accuracy50: 0.5622 - val_loss: 2.8445 - val_accuracy50: 0.5442 - 91s/epoch - 42ms/step
testing model: results/WBA/W3/deepVOL_L2/h50
Evaluating performance on  test set...
6315/6315 - 117s - 117s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9288035
{'0': {'precision': 0.5189165917271914, 'recall': 0.4540074889671466, 'f1-score': 0.4842968191830946, 'support': 448660}, '1': {'precision': 0.5715332675376452, 'recall': 0.7304003596493419, 'f1-score': 0.6412740180357974, 'support': 720702}, '2': {'precision': 0.5604417736982864, 'recall': 0.37966583161850226, 'f1-score': 0.4526728448563237, 'support': 447080}, 'accuracy': 0.5566775671505689, 'macro avg': {'precision': 0.5502972109877077, 'recall': 0.5213578934116635, 'f1-score': 0.5260812273584052, 'support': 1616442}, 'weighted avg': {'precision': 0.5538612552818274, 'recall': 0.5566775671505689, 'f1-score': 0.5455395576949175, 'support': 1616442}}
[[203695 190453  54512]
 [115684 526401  78617]
 [ 73160 204179 169741]]
Evaluating performance on  train set...
2155/2155 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9659581
{'0': {'precision': 0.5158391372725231, 'recall': 0.4832259965483857, 'f1-score': 0.49900026080153004, 'support': 166299}, '1': {'precision': 0.523476828480343, 'recall': 0.6897658274626475, 'f1-score': 0.5952254085125621, 'support': 213774}, '2': {'precision': 0.5703490716552413, 'recall': 0.3794410618890988, 'f1-score': 0.4557087924018182, 'support': 171468}, 'accuracy': 0.5310140134640943, 'macro avg': {'precision': 0.5365550124693691, 'recall': 0.5174776286333774, 'f1-score': 0.5166448205719701, 'support': 551541}, 'weighted avg': {'precision': 0.5357459968332746, 'recall': 0.5310140134640943, 'f1-score': 0.5228377148135008, 'support': 551541}}
[[ 80360  61821  24118]
 [ 41426 147454  24894]
 [ 33999  72407  65062]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93438524
{'0': {'precision': 0.5168332617894156, 'recall': 0.47418465520151537, 'f1-score': 0.4945912638641654, 'support': 53321}, '1': {'precision': 0.5650712417498371, 'recall': 0.7156780674479789, 'f1-score': 0.6315195196462773, 'support': 83620}, '2': {'precision': 0.5507153593497746, 'recall': 0.3676620890862803, 'f1-score': 0.44094540835088425, 'support': 53813}, 'accuracy': 0.5499963303521813, 'macro avg': {'precision': 0.5442066209630091, 'recall': 0.5191749372452582, 'f1-score': 0.5223520639537756, 'support': 190754}, 'weighted avg': {'precision': 0.5475375049523692, 'recall': 0.5499963303521813, 'f1-score': 0.5394820463681443, 'support': 190754}}
[[25284 21363  6674]
 [14308 59845  9467]
 [ 9329 24699 19785]]
training model: results/WBA/W3/deepVOL_L2/h100
Epoch 1/50
2155/2155 - 97s - loss: 3.2082 - accuracy100: 0.4204 - val_loss: 3.2225 - val_accuracy100: 0.4298 - 97s/epoch - 45ms/step
Epoch 2/50
2155/2155 - 90s - loss: 3.1354 - accuracy100: 0.4488 - val_loss: 3.1811 - val_accuracy100: 0.4433 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 90s - loss: 3.1107 - accuracy100: 0.4565 - val_loss: 3.1681 - val_accuracy100: 0.4462 - 90s/epoch - 42ms/step
Epoch 4/50
2155/2155 - 91s - loss: 3.0979 - accuracy100: 0.4605 - val_loss: 3.1452 - val_accuracy100: 0.4475 - 91s/epoch - 42ms/step
Epoch 5/50
2155/2155 - 92s - loss: 3.0882 - accuracy100: 0.4638 - val_loss: 3.1413 - val_accuracy100: 0.4461 - 92s/epoch - 43ms/step
Epoch 6/50
2155/2155 - 91s - loss: 3.0814 - accuracy100: 0.4672 - val_loss: 3.1409 - val_accuracy100: 0.4445 - 91s/epoch - 42ms/step
Epoch 7/50
2155/2155 - 92s - loss: 3.0765 - accuracy100: 0.4686 - val_loss: 3.1468 - val_accuracy100: 0.4455 - 92s/epoch - 43ms/step
Epoch 8/50
2155/2155 - 92s - loss: 3.0733 - accuracy100: 0.4700 - val_loss: 3.1391 - val_accuracy100: 0.4491 - 92s/epoch - 43ms/step
Epoch 9/50
2155/2155 - 90s - loss: 3.0686 - accuracy100: 0.4720 - val_loss: 3.1367 - val_accuracy100: 0.4503 - 90s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 89s - loss: 3.0656 - accuracy100: 0.4730 - val_loss: 3.1424 - val_accuracy100: 0.4497 - 89s/epoch - 41ms/step
Epoch 11/50
2155/2155 - 89s - loss: 3.0622 - accuracy100: 0.4739 - val_loss: 3.1421 - val_accuracy100: 0.4520 - 89s/epoch - 41ms/step
Epoch 12/50
2155/2155 - 91s - loss: 3.0589 - accuracy100: 0.4750 - val_loss: 3.1241 - val_accuracy100: 0.4524 - 91s/epoch - 42ms/step
Epoch 13/50
2155/2155 - 90s - loss: 3.0567 - accuracy100: 0.4761 - val_loss: 3.1291 - val_accuracy100: 0.4538 - 90s/epoch - 42ms/step
Epoch 14/50
2155/2155 - 91s - loss: 3.0533 - accuracy100: 0.4774 - val_loss: 3.1312 - val_accuracy100: 0.4532 - 91s/epoch - 42ms/step
Epoch 15/50
2155/2155 - 93s - loss: 3.0507 - accuracy100: 0.4782 - val_loss: 3.1220 - val_accuracy100: 0.4549 - 93s/epoch - 43ms/step
Epoch 16/50
2155/2155 - 93s - loss: 3.0477 - accuracy100: 0.4789 - val_loss: 3.1226 - val_accuracy100: 0.4550 - 93s/epoch - 43ms/step
Epoch 17/50
2155/2155 - 91s - loss: 3.0454 - accuracy100: 0.4796 - val_loss: 3.1265 - val_accuracy100: 0.4545 - 91s/epoch - 42ms/step
Epoch 18/50
2155/2155 - 89s - loss: 3.0431 - accuracy100: 0.4807 - val_loss: 3.1341 - val_accuracy100: 0.4529 - 89s/epoch - 41ms/step
Epoch 19/50
2155/2155 - 91s - loss: 3.0410 - accuracy100: 0.4806 - val_loss: 3.1344 - val_accuracy100: 0.4516 - 91s/epoch - 42ms/step
Epoch 20/50
2155/2155 - 92s - loss: 3.0380 - accuracy100: 0.4821 - val_loss: 3.1290 - val_accuracy100: 0.4544 - 92s/epoch - 43ms/step
Epoch 21/50
2155/2155 - 90s - loss: 3.0356 - accuracy100: 0.4830 - val_loss: 3.1322 - val_accuracy100: 0.4530 - 90s/epoch - 42ms/step
Epoch 22/50
2155/2155 - 91s - loss: 3.0322 - accuracy100: 0.4843 - val_loss: 3.1360 - val_accuracy100: 0.4522 - 91s/epoch - 42ms/step
Epoch 23/50
2155/2155 - 91s - loss: 3.0303 - accuracy100: 0.4848 - val_loss: 3.1363 - val_accuracy100: 0.4524 - 91s/epoch - 42ms/step
Epoch 24/50
2155/2155 - 92s - loss: 3.0279 - accuracy100: 0.4858 - val_loss: 3.1336 - val_accuracy100: 0.4535 - 92s/epoch - 43ms/step
Epoch 25/50
2155/2155 - 92s - loss: 3.0251 - accuracy100: 0.4863 - val_loss: 3.1406 - val_accuracy100: 0.4524 - 92s/epoch - 43ms/step
testing model: results/WBA/W3/deepVOL_L2/h100
Evaluating performance on  test set...
6315/6315 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0360291
{'0': {'precision': 0.48666418528113936, 'recall': 0.38029349462972567, 'f1-score': 0.42695330584238217, 'support': 522599}, '1': {'precision': 0.4325700501966247, 'recall': 0.6972715713236892, 'f1-score': 0.5339134138151321, 'support': 584329}, '2': {'precision': 0.5158431390228875, 'recall': 0.2694783656582547, 'f1-score': 0.3540169604711185, 'support': 509514}, 'accuracy': 0.45994845469246654, 'macro avg': {'precision': 0.47835912483355053, 'recall': 0.4490144772038898, 'f1-score': 0.4382945600428776, 'support': 1616442}, 'weighted avg': {'precision': 0.47630706363803293, 'recall': 0.45994845469246654, 'f1-score': 0.44262835255368693, 'support': 1616442}}
[[198741 256302  67556]
 [115580 407436  61313]
 [ 94053 278158 137303]]
Evaluating performance on  train set...
2155/2155 - 40s - 40s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0499071
{'0': {'precision': 0.4767055387984861, 'recall': 0.4068238457502623, 'f1-score': 0.4390010880815265, 'support': 182976}, '1': {'precision': 0.40633650647369507, 'recall': 0.6396768698137055, 'f1-score': 0.49698038370154357, 'support': 181970}, '2': {'precision': 0.5127018664903921, 'recall': 0.29927918754521826, 'f1-score': 0.3779423110762193, 'support': 186595}, 'accuracy': 0.44726502653474537, 'macro avg': {'precision': 0.4652479705875245, 'recall': 0.4485933010363954, 'f1-score': 0.43797459428642976, 'support': 551541}, 'weighted avg': {'precision': 0.465666798167289, 'recall': 0.44726502653474537, 'f1-score': 0.4374730601174571, 'support': 551541}}
[[ 74439  78911  29626]
 [ 42117 116402  23451]
 [ 39597  91154  55844]]
Evaluating performance on  val set...
746/746 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0405536
{'0': {'precision': 0.48419579332063295, 'recall': 0.4026381300313601, 'f1-score': 0.43966673727317657, 'support': 61862}, '1': {'precision': 0.4230092161126644, 'recall': 0.6731431824310153, 'f1-score': 0.5195368277440875, 'support': 66754}, '2': {'precision': 0.5177572918240895, 'recall': 0.2756767195596897, 'f1-score': 0.3597870262436596, 'support': 62138}, 'accuracy': 0.4559432567600155, 'macro avg': {'precision': 0.4749874337524623, 'recall': 0.45048601067402166, 'f1-score': 0.43966353042030787, 'support': 190754}, 'weighted avg': {'precision': 0.47371630465495385, 'recall': 0.4559432567600155, 'f1-score': 0.4415963562344726, 'support': 190754}}
[[24908 28389  8565]
 [14429 44935  7390]
 [12105 32903 17130]]
training model: results/WBA/W3/deepVOL_L2/h200
Epoch 1/50
2155/2155 - 99s - loss: 3.2866 - accuracy200: 0.3748 - val_loss: 3.3325 - val_accuracy200: 0.3539 - 99s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 91s - loss: 3.2472 - accuracy200: 0.3973 - val_loss: 3.3480 - val_accuracy200: 0.3628 - 91s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 91s - loss: 3.2334 - accuracy200: 0.4052 - val_loss: 3.3848 - val_accuracy200: 0.3650 - 91s/epoch - 42ms/step
Epoch 4/50
2155/2155 - 90s - loss: 3.2273 - accuracy200: 0.4082 - val_loss: 3.3396 - val_accuracy200: 0.3748 - 90s/epoch - 42ms/step
Epoch 5/50
2155/2155 - 90s - loss: 3.2232 - accuracy200: 0.4108 - val_loss: 3.3241 - val_accuracy200: 0.3790 - 90s/epoch - 42ms/step
Epoch 6/50
2155/2155 - 92s - loss: 3.2192 - accuracy200: 0.4133 - val_loss: 3.3300 - val_accuracy200: 0.3754 - 92s/epoch - 43ms/step
Epoch 7/50
2155/2155 - 90s - loss: 3.2157 - accuracy200: 0.4155 - val_loss: 3.3283 - val_accuracy200: 0.3773 - 90s/epoch - 42ms/step
Epoch 8/50
2155/2155 - 91s - loss: 3.2126 - accuracy200: 0.4171 - val_loss: 3.3271 - val_accuracy200: 0.3793 - 91s/epoch - 42ms/step
Epoch 9/50
2155/2155 - 90s - loss: 3.2109 - accuracy200: 0.4179 - val_loss: 3.3200 - val_accuracy200: 0.3818 - 90s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 90s - loss: 3.2081 - accuracy200: 0.4196 - val_loss: 3.3363 - val_accuracy200: 0.3786 - 90s/epoch - 42ms/step
Epoch 11/50
2155/2155 - 90s - loss: 3.2058 - accuracy200: 0.4211 - val_loss: 3.3285 - val_accuracy200: 0.3820 - 90s/epoch - 42ms/step
Epoch 12/50
2155/2155 - 92s - loss: 3.2026 - accuracy200: 0.4226 - val_loss: 3.3289 - val_accuracy200: 0.3805 - 92s/epoch - 43ms/step
Epoch 13/50
2155/2155 - 91s - loss: 3.2004 - accuracy200: 0.4241 - val_loss: 3.3388 - val_accuracy200: 0.3810 - 91s/epoch - 42ms/step
Epoch 14/50
2155/2155 - 91s - loss: 3.1975 - accuracy200: 0.4251 - val_loss: 3.3465 - val_accuracy200: 0.3799 - 91s/epoch - 42ms/step
Epoch 15/50
2155/2155 - 92s - loss: 3.1950 - accuracy200: 0.4266 - val_loss: 3.3488 - val_accuracy200: 0.3828 - 92s/epoch - 43ms/step
Epoch 16/50
2155/2155 - 91s - loss: 3.1930 - accuracy200: 0.4276 - val_loss: 3.3380 - val_accuracy200: 0.3839 - 91s/epoch - 42ms/step
Epoch 17/50
2155/2155 - 91s - loss: 3.1898 - accuracy200: 0.4289 - val_loss: 3.3338 - val_accuracy200: 0.3868 - 91s/epoch - 42ms/step
Epoch 18/50
2155/2155 - 89s - loss: 3.1879 - accuracy200: 0.4294 - val_loss: 3.3356 - val_accuracy200: 0.3856 - 89s/epoch - 41ms/step
Epoch 19/50
2155/2155 - 90s - loss: 3.1857 - accuracy200: 0.4309 - val_loss: 3.3340 - val_accuracy200: 0.3828 - 90s/epoch - 42ms/step
testing model: results/WBA/W3/deepVOL_L2/h200
Evaluating performance on  test set...
6315/6315 - 117s - 117s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1197653
{'0': {'precision': 0.3989394333246686, 'recall': 0.4110446098247318, 'f1-score': 0.4049015659050256, 'support': 560056}, '1': {'precision': 0.32495376840441, 'recall': 0.442925229886495, 'f1-score': 0.3748773514925051, 'support': 519713}, '2': {'precision': 0.4151485489513658, 'recall': 0.2560497733256564, 'f1-score': 0.3167430201400294, 'support': 536673}, 'accuracy': 0.3698351069818775, 'macro avg': {'precision': 0.37968058356014817, 'recall': 0.370006537678961, 'f1-score': 0.36550731251252006, 'support': 1616442}, 'weighted avg': {'precision': 0.38053338030082, 'recall': 0.3698351069818775, 'f1-score': 0.36597886668271384, 'support': 1616442}}
[[230208 237316  92532]
 [188464 230194 101055]
 [158378 240880 137415]]
Evaluating performance on  train set...
2155/2155 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147248
{'0': {'precision': 0.39491850487680424, 'recall': 0.36815457965182397, 'f1-score': 0.38106718506382337, 'support': 182896}, '1': {'precision': 0.34871998511776997, 'recall': 0.5349706382745184, 'f1-score': 0.4222177945068416, 'support': 182210}, '2': {'precision': 0.4303038064465285, 'recall': 0.23429613538230482, 'f1-score': 0.30339611108988807, 'support': 186435}, 'accuracy': 0.37801722809365035, 'macro avg': {'precision': 0.39131409881370094, 'recall': 0.3791404511028824, 'f1-score': 0.368893696886851, 'support': 551541}, 'weighted avg': {'precision': 0.39161725694212285, 'recall': 0.37801722809365035, 'f1-score': 0.3684071033478344, 'support': 551541}}
[[67334 88139 27423]
 [54325 97477 30408]
 [48842 93912 43681]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1074388
{'0': {'precision': 0.39587215803205367, 'recall': 0.40167344237496455, 'f1-score': 0.3987517011591346, 'support': 63462}, '1': {'precision': 0.3582948545169344, 'recall': 0.5052023301454783, 'f1-score': 0.4192518484049429, 'support': 64202}, '2': {'precision': 0.4205826543140976, 'recall': 0.23889681407513078, 'f1-score': 0.30471261346865336, 'support': 63090}, 'accuracy': 0.38268135923755203, 'macro avg': {'precision': 0.3915832222876952, 'recall': 0.3819241955318579, 'f1-score': 0.3742387210109103, 'support': 190754}, 'weighted avg': {'precision': 0.3913975319175631, 'recall': 0.38268135923755203, 'f1-score': 0.374548929060426, 'support': 190754}}
[[25491 28227  9744]
 [20747 32435 11020]
 [18154 29864 15072]]
training model: results/WBA/W3/deepVOL_L2/h300
Epoch 1/50
2155/2155 - 99s - loss: 3.3070 - accuracy300: 0.3501 - val_loss: 3.3236 - val_accuracy300: 0.3275 - 99s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 90s - loss: 3.2819 - accuracy300: 0.3659 - val_loss: 3.3022 - val_accuracy300: 0.3515 - 90s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 89s - loss: 3.2687 - accuracy300: 0.3801 - val_loss: 3.3093 - val_accuracy300: 0.3457 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 88s - loss: 3.2575 - accuracy300: 0.3905 - val_loss: 3.3180 - val_accuracy300: 0.3585 - 88s/epoch - 41ms/step
Epoch 5/50
2155/2155 - 88s - loss: 3.2529 - accuracy300: 0.3941 - val_loss: 3.3127 - val_accuracy300: 0.3603 - 88s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 92s - loss: 3.2483 - accuracy300: 0.3973 - val_loss: 3.3169 - val_accuracy300: 0.3631 - 92s/epoch - 43ms/step
Epoch 7/50
2155/2155 - 91s - loss: 3.2439 - accuracy300: 0.4004 - val_loss: 3.3026 - val_accuracy300: 0.3647 - 91s/epoch - 42ms/step
Epoch 8/50
2155/2155 - 91s - loss: 3.2406 - accuracy300: 0.4032 - val_loss: 3.3013 - val_accuracy300: 0.3665 - 91s/epoch - 42ms/step
Epoch 9/50
2155/2155 - 89s - loss: 3.2378 - accuracy300: 0.4040 - val_loss: 3.3025 - val_accuracy300: 0.3659 - 89s/epoch - 42ms/step
Epoch 10/50
2155/2155 - 91s - loss: 3.2344 - accuracy300: 0.4064 - val_loss: 3.3098 - val_accuracy300: 0.3661 - 91s/epoch - 42ms/step
Epoch 11/50
2155/2155 - 91s - loss: 3.2319 - accuracy300: 0.4073 - val_loss: 3.3124 - val_accuracy300: 0.3659 - 91s/epoch - 42ms/step
Epoch 12/50
2155/2155 - 92s - loss: 3.2290 - accuracy300: 0.4089 - val_loss: 3.3059 - val_accuracy300: 0.3693 - 92s/epoch - 43ms/step
Epoch 13/50
2155/2155 - 89s - loss: 3.2265 - accuracy300: 0.4102 - val_loss: 3.3193 - val_accuracy300: 0.3656 - 89s/epoch - 41ms/step
Epoch 14/50
2155/2155 - 89s - loss: 3.2241 - accuracy300: 0.4121 - val_loss: 3.3184 - val_accuracy300: 0.3685 - 89s/epoch - 41ms/step
Epoch 15/50
2155/2155 - 91s - loss: 3.2218 - accuracy300: 0.4124 - val_loss: 3.3186 - val_accuracy300: 0.3674 - 91s/epoch - 42ms/step
Epoch 16/50
2155/2155 - 90s - loss: 3.2190 - accuracy300: 0.4141 - val_loss: 3.3207 - val_accuracy300: 0.3658 - 90s/epoch - 42ms/step
Epoch 17/50
2155/2155 - 88s - loss: 3.2157 - accuracy300: 0.4157 - val_loss: 3.3201 - val_accuracy300: 0.3642 - 88s/epoch - 41ms/step
Epoch 18/50
2155/2155 - 88s - loss: 3.2140 - accuracy300: 0.4165 - val_loss: 3.3356 - val_accuracy300: 0.3617 - 88s/epoch - 41ms/step
testing model: results/WBA/W3/deepVOL_L2/h300
Evaluating performance on  test set...
6315/6315 - 116s - 116s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986519
{'0': {'precision': 0.4001474146570858, 'recall': 0.4254176949479477, 'f1-score': 0.41239579725998676, 'support': 564048}, '1': {'precision': 0.3403221532249472, 'recall': 0.4774197133653605, 'f1-score': 0.39737846741785576, 'support': 521849}, '2': {'precision': 0.3901278192055469, 'recall': 0.2093488770980784, 'f1-score': 0.2724803862401931, 'support': 530545}, 'accuracy': 0.3712882986212929, 'macro avg': {'precision': 0.37686579569585993, 'recall': 0.37072876180379555, 'f1-score': 0.3607515503060119, 'support': 1616442}, 'weighted avg': {'precision': 0.37754493394825933, 'recall': 0.3712882986212929, 'f1-score': 0.36162490643910816, 'support': 1616442}}
[[239956 238905  85187]
 [184265 249141  88443]
 [175448 244028 111069]]
Evaluating performance on  train set...
2155/2155 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011842
{'0': {'precision': 0.37699146385288035, 'recall': 0.39584711884983675, 'f1-score': 0.3861892719570622, 'support': 182861}, '1': {'precision': 0.34742175357882515, 'recall': 0.5264635478141926, 'f1-score': 0.4186015915026302, 'support': 181306}, '2': {'precision': 0.41738115174601675, 'recall': 0.1888789266387012, 'f1-score': 0.26006826690965473, 'support': 187374}, 'accuracy': 0.368471246924526, 'macro avg': {'precision': 0.38059812305924073, 'recall': 0.37039653110091014, 'f1-score': 0.354953043456449, 'support': 551541}, 'weighted avg': {'precision': 0.38099263781517995, 'recall': 0.368471246924526, 'f1-score': 0.35399719703928784, 'support': 551541}}
[[72385 86931 23545]
 [59998 95451 25857]
 [59624 92359 35391]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018276
{'0': {'precision': 0.3836759011021746, 'recall': 0.3964723808351161, 'f1-score': 0.3899691930392922, 'support': 64973}, '1': {'precision': 0.34073194767962733, 'recall': 0.49385641708191985, 'f1-score': 0.4032470759749512, 'support': 61609}, '2': {'precision': 0.39708024943178505, 'recall': 0.2123511812005236, 'f1-score': 0.27671844857345923, 'support': 64172}, 'accuracy': 0.365984461662665, 'macro avg': {'precision': 0.3738293660711957, 'recall': 0.36755999303918657, 'f1-score': 0.35664490586256753, 'support': 190754}, 'weighted avg': {'precision': 0.37431541489794323, 'recall': 0.365984461662665, 'f1-score': 0.35615868482411234, 'support': 190754}}
[[25760 28963 10250]
 [20742 30426 10441]
 [20638 29907 13627]]
training model: results/WBA/W3/deepVOL_L2/h500
Epoch 1/50
2155/2155 - 98s - loss: 3.2578 - accuracy500: 0.3987 - val_loss: 3.2927 - val_accuracy500: 0.3563 - 98s/epoch - 45ms/step
Epoch 2/50
2155/2155 - 89s - loss: 3.2536 - accuracy500: 0.3919 - val_loss: 3.2864 - val_accuracy500: 0.3745 - 89s/epoch - 41ms/step
Epoch 3/50
2155/2155 - 89s - loss: 3.2464 - accuracy500: 0.3975 - val_loss: 3.2786 - val_accuracy500: 0.3780 - 89s/epoch - 41ms/step
Epoch 4/50
2155/2155 - 88s - loss: 3.2391 - accuracy500: 0.4014 - val_loss: 3.2819 - val_accuracy500: 0.3780 - 88s/epoch - 41ms/step
Epoch 5/50
2155/2155 - 88s - loss: 3.2350 - accuracy500: 0.4031 - val_loss: 3.2950 - val_accuracy500: 0.3701 - 88s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 88s - loss: 3.2364 - accuracy500: 0.4034 - val_loss: 3.3162 - val_accuracy500: 0.3660 - 88s/epoch - 41ms/step
Epoch 7/50
2155/2155 - 92s - loss: 3.2344 - accuracy500: 0.4036 - val_loss: 3.3040 - val_accuracy500: 0.3717 - 92s/epoch - 42ms/step
Epoch 8/50
2155/2155 - 89s - loss: 3.2337 - accuracy500: 0.4052 - val_loss: 3.3726 - val_accuracy500: 0.3338 - 89s/epoch - 41ms/step
Epoch 9/50
2155/2155 - 89s - loss: 3.2284 - accuracy500: 0.4104 - val_loss: 3.3674 - val_accuracy500: 0.3443 - 89s/epoch - 41ms/step
Epoch 10/50
2155/2155 - 87s - loss: 3.2226 - accuracy500: 0.4128 - val_loss: 3.3525 - val_accuracy500: 0.3511 - 87s/epoch - 41ms/step
Epoch 11/50
2155/2155 - 89s - loss: 3.2213 - accuracy500: 0.4126 - val_loss: 3.3520 - val_accuracy500: 0.3524 - 89s/epoch - 41ms/step
Epoch 12/50
2155/2155 - 85s - loss: 3.2213 - accuracy500: 0.4113 - val_loss: 3.3454 - val_accuracy500: 0.3532 - 85s/epoch - 40ms/step
Epoch 13/50
2155/2155 - 89s - loss: 3.2173 - accuracy500: 0.4143 - val_loss: 3.3621 - val_accuracy500: 0.3496 - 89s/epoch - 41ms/step
testing model: results/WBA/W3/deepVOL_L2/h500
Evaluating performance on  test set...
6315/6315 - 123s - 123s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0902903
{'0': {'precision': 0.4079778916188692, 'recall': 0.45199665298641273, 'f1-score': 0.4288606974729045, 'support': 627425}, '1': {'precision': 0.2630477409653855, 'recall': 0.06300877805656213, 'f1-score': 0.10166529887815165, 'support': 410911}, '2': {'precision': 0.38067721966620244, 'recall': 0.5418677543564675, 'f1-score': 0.44719057815845825, 'support': 578106}, 'accuracy': 0.385254775612116, 'macro avg': {'precision': 0.3505676174168191, 'recall': 0.3522910617998141, 'f1-score': 0.3259055248365048, 'support': 1616442}, 'weighted avg': {'precision': 0.3613717805458817, 'recall': 0.385254775612116, 'f1-score': 0.3522408283848916, 'support': 1616442}}
[[283594  37243 306588]
 [181971  25891 203049]
 [229556  35293 313257]]
Evaluating performance on  train set...
2155/2155 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017419
{'0': {'precision': 0.34719968642321924, 'recall': 0.4173807749627422, 'f1-score': 0.3790692582529682, 'support': 182512}, '1': {'precision': 0.33903748020411756, 'recall': 0.04229270701860286, 'f1-score': 0.07520418419024012, 'support': 182230}, '2': {'precision': 0.3608021848386419, 'recall': 0.5976156189272962, 'f1-score': 0.4499520358562204, 'support': 186799}, 'accuracy': 0.354494044867018, 'macro avg': {'precision': 0.3490131171553263, 'recall': 0.35242970030288046, 'f1-score': 0.30140849276647624, 'support': 551541}, 'weighted avg': {'precision': 0.3491098513288122, 'recall': 0.354494044867018, 'f1-score': 0.3026787442695272, 'support': 551541}}
[[ 76177   7230  99105]
 [ 75857   7707  98666]
 [ 67370   7795 111634]]
Evaluating performance on  val set...
746/746 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0928587
{'0': {'precision': 0.3895553987297107, 'recall': 0.4670116611909361, 'f1-score': 0.4247814850678791, 'support': 70919}, '1': {'precision': 0.2756716967243283, 'recall': 0.04347237269772481, 'f1-score': 0.07510152241848962, 'support': 51688}, '2': {'precision': 0.37978951251754917, 'recall': 0.5438390538101457, 'f1-score': 0.4472455198213963, 'support': 68147}, 'accuracy': 0.37969321744236034, 'macro avg': {'precision': 0.3483388693238627, 'recall': 0.3514410292329355, 'f1-score': 0.3157095091025883, 'support': 190754}, 'weighted avg': {'precision': 0.3552078273186033, 'recall': 0.37969321744236034, 'f1-score': 0.338055118474918, 'support': 190754}}
[[33120  3022 34777]
 [23696  2247 25745]
 [28204  2882 37061]]
training model: results/WBA/W3/deepVOL_L2/h1000
Epoch 1/50
2155/2155 - 100s - loss: 3.2975 - accuracy1000: 0.3627 - val_loss: 3.4477 - val_accuracy1000: 0.2984 - 100s/epoch - 46ms/step
Epoch 2/50
2155/2155 - 91s - loss: 3.2832 - accuracy1000: 0.3627 - val_loss: 3.4395 - val_accuracy1000: 0.2995 - 91s/epoch - 42ms/step
Epoch 3/50
2155/2155 - 91s - loss: 3.2723 - accuracy1000: 0.3757 - val_loss: 3.3979 - val_accuracy1000: 0.2979 - 91s/epoch - 42ms/step
Epoch 4/50
2155/2155 - 91s - loss: 3.2718 - accuracy1000: 0.3769 - val_loss: 3.3942 - val_accuracy1000: 0.3005 - 91s/epoch - 42ms/step
Epoch 5/50
2155/2155 - 88s - loss: 3.2724 - accuracy1000: 0.3782 - val_loss: 3.3908 - val_accuracy1000: 0.2979 - 88s/epoch - 41ms/step
Epoch 6/50
2155/2155 - 89s - loss: 3.2690 - accuracy1000: 0.3797 - val_loss: 3.3840 - val_accuracy1000: 0.2979 - 89s/epoch - 41ms/step
Epoch 7/50
2155/2155 - 88s - loss: 3.2662 - accuracy1000: 0.3817 - val_loss: 3.3977 - val_accuracy1000: 0.3020 - 88s/epoch - 41ms/step
Epoch 8/50
2155/2155 - 89s - loss: 3.2672 - accuracy1000: 0.3814 - val_loss: 3.4033 - val_accuracy1000: 0.2987 - 89s/epoch - 41ms/step
Epoch 9/50
2155/2155 - 93s - loss: 3.2674 - accuracy1000: 0.3810 - val_loss: 3.3876 - val_accuracy1000: 0.3000 - 93s/epoch - 43ms/step
Epoch 10/50
2155/2155 - 92s - loss: 3.2630 - accuracy1000: 0.3851 - val_loss: 3.3856 - val_accuracy1000: 0.2987 - 92s/epoch - 43ms/step
Epoch 11/50
2155/2155 - 90s - loss: 3.2601 - accuracy1000: 0.3867 - val_loss: 3.3857 - val_accuracy1000: 0.2981 - 90s/epoch - 42ms/step
Epoch 12/50
2155/2155 - 93s - loss: 3.2556 - accuracy1000: 0.3918 - val_loss: 3.3877 - val_accuracy1000: 0.2993 - 93s/epoch - 43ms/step
Epoch 13/50
2155/2155 - 90s - loss: 3.2575 - accuracy1000: 0.3907 - val_loss: 3.3933 - val_accuracy1000: 0.2998 - 90s/epoch - 42ms/step
Epoch 14/50
2155/2155 - 88s - loss: 3.2598 - accuracy1000: 0.3894 - val_loss: 3.3956 - val_accuracy1000: 0.2979 - 88s/epoch - 41ms/step
Epoch 15/50
2155/2155 - 89s - loss: 3.2549 - accuracy1000: 0.3919 - val_loss: 3.3864 - val_accuracy1000: 0.2989 - 89s/epoch - 41ms/step
Epoch 16/50
2155/2155 - 88s - loss: 3.2514 - accuracy1000: 0.3940 - val_loss: 3.4141 - val_accuracy1000: 0.2989 - 88s/epoch - 41ms/step
testing model: results/WBA/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
6315/6315 - 117s - 117s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.169385
{'0': {'precision': 0.4230769230769231, 'recall': 1.5989115772826644e-05, 'f1-score': 3.197702305543362e-05, 'support': 687968}, '1': {'precision': 0.18736152675855217, 'recall': 0.9999141506194363, 'f1-score': 0.3155887810340345, 'support': 302856}, '2': {'precision': 0.4186046511627907, 'recall': 8.631465207203118e-05, 'f1-score': 0.00017259371599064797, 'support': 625618}, 'accuracy': 0.18738377250776705, 'macro avg': {'precision': 0.34301436699942195, 'recall': 0.3333388181290937, 'f1-score': 0.10526445059102685, 'support': 1616442}, 'weighted avg': {'precision': 0.37718244874516715, 'recall': 0.18738377250776705, 'f1-score': 0.05920901137984015, 'support': 1616442}}
[[    11 687902     55]
 [     6 302830     20]
 [     9 625555     54]]
Evaluating performance on  train set...
2155/2155 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1154932
{'0': {'precision': 0.4117647058823529, 'recall': 3.853564547206166e-05, 'f1-score': 7.706407878150682e-05, 'support': 181650}, '1': {'precision': 0.3296516783233268, 'recall': 0.9999009966338855, 'f1-score': 0.4958344981828348, 'support': 181812}, '2': {'precision': 0.2549019607843137, 'recall': 6.911989110958693e-05, 'f1-score': 0.00013820230691543084, 'support': 188079}, 'accuracy': 0.32964729729974745, 'macro avg': {'precision': 0.3321061149966645, 'recall': 0.33333621739015573, 'f1-score': 0.16534992152284392, 'support': 551541}, 'weighted avg': {'precision': 0.33120546912233734, 'recall': 0.32964729729974745, 'f1-score': 0.16352121315588608, 'support': 551541}}
[[     7 181617     26]
 [     6 181794     12]
 [     4 188062     13]]
Evaluating performance on  val set...
746/746 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1290767
{'0': {'precision': 0.5, 'recall': 2.937547735150696e-05, 'f1-score': 5.8747503231112676e-05, 'support': 68084}, '1': {'precision': 0.2979326905432258, 'recall': 0.9999120183001936, 'f1-score': 0.45907877250455437, 'support': 56830}, '2': {'precision': 0.3684210526315789, 'recall': 0.000106318347509113, 'f1-score': 0.00021257535036972927, 'support': 65840}, 'accuracy': 0.29794394875074703, 'macro avg': {'precision': 0.38878458105826824, 'recall': 0.33334923737501804, 'f1-score': 0.15311669845271839, 'support': 190754}, 'weighted avg': {'precision': 0.39438416446750624, 'recall': 0.29794394875074703, 'f1-score': 0.1368644556209157, 'support': 190754}}
[[    2 68074     8]
 [    1 56825     4]
 [    1 65832     7]]
training model: results/WBA/W3/deepVOL_L3/h10
Epoch 1/50
2155/2155 - 147s - loss: 2.9561 - accuracy10: 0.4503 - val_loss: 2.3812 - val_accuracy10: 0.6152 - 147s/epoch - 68ms/step
Epoch 2/50
2155/2155 - 135s - loss: 2.5068 - accuracy10: 0.5746 - val_loss: 2.2780 - val_accuracy10: 0.6442 - 135s/epoch - 63ms/step
Epoch 3/50
2155/2155 - 136s - loss: 2.4114 - accuracy10: 0.6010 - val_loss: 2.2483 - val_accuracy10: 0.6269 - 136s/epoch - 63ms/step
Epoch 4/50
2155/2155 - 140s - loss: 2.3746 - accuracy10: 0.6090 - val_loss: 2.2121 - val_accuracy10: 0.6368 - 140s/epoch - 65ms/step
Epoch 5/50
2155/2155 - 133s - loss: 2.3516 - accuracy10: 0.6145 - val_loss: 2.2116 - val_accuracy10: 0.6300 - 133s/epoch - 62ms/step
Epoch 6/50
2155/2155 - 138s - loss: 2.3362 - accuracy10: 0.6174 - val_loss: 2.1989 - val_accuracy10: 0.6345 - 138s/epoch - 64ms/step
Epoch 7/50
2155/2155 - 137s - loss: 2.3240 - accuracy10: 0.6190 - val_loss: 2.1897 - val_accuracy10: 0.6352 - 137s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 139s - loss: 2.3146 - accuracy10: 0.6206 - val_loss: 2.1858 - val_accuracy10: 0.6368 - 139s/epoch - 65ms/step
Epoch 9/50
2155/2155 - 138s - loss: 2.3057 - accuracy10: 0.6216 - val_loss: 2.1714 - val_accuracy10: 0.6520 - 138s/epoch - 64ms/step
Epoch 10/50
2155/2155 - 140s - loss: 2.2980 - accuracy10: 0.6231 - val_loss: 2.1694 - val_accuracy10: 0.6435 - 140s/epoch - 65ms/step
Epoch 11/50
2155/2155 - 140s - loss: 2.2904 - accuracy10: 0.6235 - val_loss: 2.1532 - val_accuracy10: 0.6464 - 140s/epoch - 65ms/step
Epoch 12/50
2155/2155 - 141s - loss: 2.2826 - accuracy10: 0.6241 - val_loss: 2.1445 - val_accuracy10: 0.6542 - 141s/epoch - 66ms/step
Epoch 13/50
2155/2155 - 139s - loss: 2.2770 - accuracy10: 0.6253 - val_loss: 2.1352 - val_accuracy10: 0.6467 - 139s/epoch - 64ms/step
Epoch 14/50
2155/2155 - 138s - loss: 2.2728 - accuracy10: 0.6254 - val_loss: 2.1268 - val_accuracy10: 0.6559 - 138s/epoch - 64ms/step
Epoch 15/50
2155/2155 - 139s - loss: 2.2656 - accuracy10: 0.6268 - val_loss: 2.1171 - val_accuracy10: 0.6579 - 139s/epoch - 65ms/step
Epoch 16/50
2155/2155 - 137s - loss: 2.2615 - accuracy10: 0.6273 - val_loss: 2.1156 - val_accuracy10: 0.6578 - 137s/epoch - 64ms/step
Epoch 17/50
2155/2155 - 140s - loss: 2.2578 - accuracy10: 0.6273 - val_loss: 2.1139 - val_accuracy10: 0.6679 - 140s/epoch - 65ms/step
Epoch 18/50
2155/2155 - 138s - loss: 2.2541 - accuracy10: 0.6285 - val_loss: 2.1162 - val_accuracy10: 0.6434 - 138s/epoch - 64ms/step
Epoch 19/50
2155/2155 - 141s - loss: 2.2491 - accuracy10: 0.6287 - val_loss: 2.0876 - val_accuracy10: 0.6655 - 141s/epoch - 65ms/step
Epoch 20/50
2155/2155 - 139s - loss: 2.2449 - accuracy10: 0.6297 - val_loss: 2.1170 - val_accuracy10: 0.6521 - 139s/epoch - 64ms/step
Epoch 21/50
2155/2155 - 137s - loss: 2.2398 - accuracy10: 0.6306 - val_loss: 2.0938 - val_accuracy10: 0.6633 - 137s/epoch - 64ms/step
Epoch 22/50
2155/2155 - 138s - loss: 2.2368 - accuracy10: 0.6304 - val_loss: 2.0968 - val_accuracy10: 0.6605 - 138s/epoch - 64ms/step
Epoch 23/50
2155/2155 - 138s - loss: 2.2342 - accuracy10: 0.6302 - val_loss: 2.1100 - val_accuracy10: 0.6594 - 138s/epoch - 64ms/step
Epoch 24/50
2155/2155 - 145s - loss: 2.2287 - accuracy10: 0.6313 - val_loss: 2.0981 - val_accuracy10: 0.6708 - 145s/epoch - 67ms/step
Epoch 25/50
2155/2155 - 146s - loss: 2.2258 - accuracy10: 0.6314 - val_loss: 2.0957 - val_accuracy10: 0.6556 - 146s/epoch - 68ms/step
Epoch 26/50
2155/2155 - 144s - loss: 2.2234 - accuracy10: 0.6318 - val_loss: 2.0894 - val_accuracy10: 0.6697 - 144s/epoch - 67ms/step
Epoch 27/50
2155/2155 - 144s - loss: 2.2193 - accuracy10: 0.6323 - val_loss: 2.0847 - val_accuracy10: 0.6684 - 144s/epoch - 67ms/step
Epoch 28/50
2155/2155 - 144s - loss: 2.2160 - accuracy10: 0.6327 - val_loss: 2.1012 - val_accuracy10: 0.6679 - 144s/epoch - 67ms/step
Epoch 29/50
2155/2155 - 143s - loss: 2.2134 - accuracy10: 0.6322 - val_loss: 2.0836 - val_accuracy10: 0.6633 - 143s/epoch - 67ms/step
Epoch 30/50
2155/2155 - 140s - loss: 2.2114 - accuracy10: 0.6328 - val_loss: 2.0862 - val_accuracy10: 0.6717 - 140s/epoch - 65ms/step
Epoch 31/50
2155/2155 - 144s - loss: 2.2070 - accuracy10: 0.6334 - val_loss: 2.0831 - val_accuracy10: 0.6561 - 144s/epoch - 67ms/step
Epoch 32/50
2155/2155 - 141s - loss: 2.2049 - accuracy10: 0.6335 - val_loss: 2.0751 - val_accuracy10: 0.6631 - 141s/epoch - 65ms/step
Epoch 33/50
2155/2155 - 137s - loss: 2.2022 - accuracy10: 0.6337 - val_loss: 2.0835 - val_accuracy10: 0.6564 - 137s/epoch - 64ms/step
Epoch 34/50
2155/2155 - 140s - loss: 2.1979 - accuracy10: 0.6346 - val_loss: 2.0937 - val_accuracy10: 0.6670 - 140s/epoch - 65ms/step
Epoch 35/50
2155/2155 - 140s - loss: 2.1959 - accuracy10: 0.6348 - val_loss: 2.0886 - val_accuracy10: 0.6666 - 140s/epoch - 65ms/step
Epoch 36/50
2155/2155 - 137s - loss: 2.1932 - accuracy10: 0.6347 - val_loss: 2.0888 - val_accuracy10: 0.6622 - 137s/epoch - 64ms/step
Epoch 37/50
2155/2155 - 139s - loss: 2.1916 - accuracy10: 0.6350 - val_loss: 2.1021 - val_accuracy10: 0.6572 - 139s/epoch - 65ms/step
Epoch 38/50
2155/2155 - 142s - loss: 2.1886 - accuracy10: 0.6356 - val_loss: 2.0899 - val_accuracy10: 0.6673 - 142s/epoch - 66ms/step
Epoch 39/50
2155/2155 - 139s - loss: 2.1858 - accuracy10: 0.6357 - val_loss: 2.1044 - val_accuracy10: 0.6750 - 139s/epoch - 64ms/step
Epoch 40/50
2155/2155 - 140s - loss: 2.1835 - accuracy10: 0.6358 - val_loss: 2.0951 - val_accuracy10: 0.6649 - 140s/epoch - 65ms/step
Epoch 41/50
2155/2155 - 142s - loss: 2.1813 - accuracy10: 0.6365 - val_loss: 2.0926 - val_accuracy10: 0.6607 - 142s/epoch - 66ms/step
Epoch 42/50
2155/2155 - 138s - loss: 2.1780 - accuracy10: 0.6364 - val_loss: 2.0964 - val_accuracy10: 0.6582 - 138s/epoch - 64ms/step
testing model: results/WBA/W3/deepVOL_L3/h10
Evaluating performance on  test set...
6315/6315 - 190s - 190s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7277324
{'0': {'precision': 0.37096089710688807, 'recall': 0.7405544466622311, 'f1-score': 0.49431030067251996, 'support': 225450}, '1': {'precision': 0.894856281830506, 'recall': 0.6703899784527126, 'f1-score': 0.7665281798994108, 'support': 1165808}, '2': {'precision': 0.43998744014443836, 'recall': 0.5724873880915162, 'f1-score': 0.49756745229948607, 'support': 225184}, 'accuracy': 0.6665373703479618, 'macro avg': {'precision': 0.5686015396939441, 'recall': 0.6611439377354867, 'f1-score': 0.5861353109571389, 'support': 1616442}, 'weighted avg': {'precision': 0.7584199607424774, 'recall': 0.6665373703479618, 'f1-score': 0.6910926410087089, 'support': 1616442}}
[[166958  36815  21677]
 [241857 781546 142405]
 [ 41254  55015 128915]]
Evaluating performance on  train set...
2155/2155 - 66s - 66s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80857164
{'0': {'precision': 0.37747946190759823, 'recall': 0.7539844661937685, 'f1-score': 0.5030892165746766, 'support': 89096}, '1': {'precision': 0.8783681014613144, 'recall': 0.6088774864693892, 'f1-score': 0.7192067889161204, 'support': 369902}, '2': {'precision': 0.46232695491866244, 'recall': 0.5853387074116897, 'f1-score': 0.5166111134953674, 'support': 92543}, 'accuracy': 0.6283685165744705, 'macro avg': {'precision': 0.5727248394291916, 'recall': 0.6494002200249492, 'f1-score': 0.5796357063287215, 'support': 551541}, 'weighted avg': {'precision': 0.7276469945006813, 'recall': 0.6283685165744705, 'f1-score': 0.6503016253547605, 'support': 551541}}
[[ 67177  11982   9937]
 [ 91617 225225  53060]
 [ 19168  19206  54169]]
Evaluating performance on  val set...
746/746 - 23s - 23s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7403571
{'0': {'precision': 0.375589600392438, 'recall': 0.7434087683919636, 'f1-score': 0.49904738029581347, 'support': 26778}, '1': {'precision': 0.897235653860926, 'recall': 0.663960530247269, 'f1-score': 0.7631700186796894, 'support': 137219}, '2': {'precision': 0.4245905714048993, 'recall': 0.5745786149418843, 'f1-score': 0.488327033637201, 'support': 26757}, 'accuracy': 0.6625758830745357, 'macro avg': {'precision': 0.5658052752194211, 'recall': 0.660649304527039, 'f1-score': 0.5835148108709013, 'support': 190754}, 'weighted avg': {'precision': 0.7577093399117817, 'recall': 0.6625758830745357, 'f1-score': 0.6875404132117816, 'support': 190754}}
[[19907  4141  2730]
 [28006 91108 18105]
 [ 5089  6294 15374]]
training model: results/WBA/W3/deepVOL_L3/h20
Epoch 1/50
2155/2155 - 140s - loss: 2.9826 - accuracy20: 0.4682 - val_loss: 2.5621 - val_accuracy20: 0.6015 - 140s/epoch - 65ms/step
Epoch 2/50
2155/2155 - 145s - loss: 2.6330 - accuracy20: 0.5732 - val_loss: 2.4260 - val_accuracy20: 0.6145 - 145s/epoch - 67ms/step
Epoch 3/50
2155/2155 - 139s - loss: 2.5634 - accuracy20: 0.5890 - val_loss: 2.4259 - val_accuracy20: 0.6023 - 139s/epoch - 64ms/step
Epoch 4/50
2155/2155 - 139s - loss: 2.5337 - accuracy20: 0.5955 - val_loss: 2.3645 - val_accuracy20: 0.6466 - 139s/epoch - 64ms/step
Epoch 5/50
2155/2155 - 136s - loss: 2.5132 - accuracy20: 0.5989 - val_loss: 2.3607 - val_accuracy20: 0.6399 - 136s/epoch - 63ms/step
Epoch 6/50
2155/2155 - 140s - loss: 2.4955 - accuracy20: 0.6028 - val_loss: 2.4055 - val_accuracy20: 0.6222 - 140s/epoch - 65ms/step
Epoch 7/50
2155/2155 - 137s - loss: 2.4828 - accuracy20: 0.6039 - val_loss: 2.3673 - val_accuracy20: 0.6430 - 137s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 136s - loss: 2.4702 - accuracy20: 0.6062 - val_loss: 2.4170 - val_accuracy20: 0.6245 - 136s/epoch - 63ms/step
Epoch 9/50
2155/2155 - 138s - loss: 2.4618 - accuracy20: 0.6074 - val_loss: 2.3822 - val_accuracy20: 0.6320 - 138s/epoch - 64ms/step
Epoch 10/50
2155/2155 - 138s - loss: 2.4544 - accuracy20: 0.6093 - val_loss: 2.3853 - val_accuracy20: 0.6357 - 138s/epoch - 64ms/step
Epoch 11/50
2155/2155 - 144s - loss: 2.4463 - accuracy20: 0.6106 - val_loss: 2.3793 - val_accuracy20: 0.6188 - 144s/epoch - 67ms/step
Epoch 12/50
2155/2155 - 142s - loss: 2.4399 - accuracy20: 0.6116 - val_loss: 2.3555 - val_accuracy20: 0.6303 - 142s/epoch - 66ms/step
Epoch 13/50
2155/2155 - 138s - loss: 2.4342 - accuracy20: 0.6126 - val_loss: 2.3557 - val_accuracy20: 0.6274 - 138s/epoch - 64ms/step
Epoch 14/50
2155/2155 - 140s - loss: 2.4283 - accuracy20: 0.6139 - val_loss: 2.3530 - val_accuracy20: 0.6269 - 140s/epoch - 65ms/step
Epoch 15/50
2155/2155 - 137s - loss: 2.4244 - accuracy20: 0.6142 - val_loss: 2.3473 - val_accuracy20: 0.6243 - 137s/epoch - 64ms/step
Epoch 16/50
2155/2155 - 138s - loss: 2.4200 - accuracy20: 0.6146 - val_loss: 2.3456 - val_accuracy20: 0.6260 - 138s/epoch - 64ms/step
Epoch 17/50
2155/2155 - 143s - loss: 2.4159 - accuracy20: 0.6151 - val_loss: 2.3339 - val_accuracy20: 0.6256 - 143s/epoch - 66ms/step
Epoch 18/50
2155/2155 - 140s - loss: 2.4098 - accuracy20: 0.6162 - val_loss: 2.3090 - val_accuracy20: 0.6319 - 140s/epoch - 65ms/step
Epoch 19/50
2155/2155 - 138s - loss: 2.4077 - accuracy20: 0.6161 - val_loss: 2.3278 - val_accuracy20: 0.6238 - 138s/epoch - 64ms/step
Epoch 20/50
2155/2155 - 136s - loss: 2.4048 - accuracy20: 0.6169 - val_loss: 2.3167 - val_accuracy20: 0.6246 - 136s/epoch - 63ms/step
Epoch 21/50
2155/2155 - 135s - loss: 2.4016 - accuracy20: 0.6176 - val_loss: 2.3179 - val_accuracy20: 0.6271 - 135s/epoch - 63ms/step
Epoch 22/50
2155/2155 - 140s - loss: 2.3970 - accuracy20: 0.6186 - val_loss: 2.3166 - val_accuracy20: 0.6339 - 140s/epoch - 65ms/step
Epoch 23/50
2155/2155 - 136s - loss: 2.3934 - accuracy20: 0.6186 - val_loss: 2.3273 - val_accuracy20: 0.6265 - 136s/epoch - 63ms/step
Epoch 24/50
2155/2155 - 140s - loss: 2.3912 - accuracy20: 0.6189 - val_loss: 2.3154 - val_accuracy20: 0.6282 - 140s/epoch - 65ms/step
Epoch 25/50
2155/2155 - 139s - loss: 2.3883 - accuracy20: 0.6193 - val_loss: 2.3079 - val_accuracy20: 0.6298 - 139s/epoch - 64ms/step
Epoch 26/50
2155/2155 - 136s - loss: 2.3848 - accuracy20: 0.6200 - val_loss: 2.3100 - val_accuracy20: 0.6309 - 136s/epoch - 63ms/step
Epoch 27/50
2155/2155 - 136s - loss: 2.3818 - accuracy20: 0.6206 - val_loss: 2.3059 - val_accuracy20: 0.6256 - 136s/epoch - 63ms/step
Epoch 28/50
2155/2155 - 137s - loss: 2.3789 - accuracy20: 0.6207 - val_loss: 2.3181 - val_accuracy20: 0.6292 - 137s/epoch - 64ms/step
Epoch 29/50
2155/2155 - 140s - loss: 2.3773 - accuracy20: 0.6210 - val_loss: 2.3091 - val_accuracy20: 0.6301 - 140s/epoch - 65ms/step
Epoch 30/50
2155/2155 - 135s - loss: 2.3739 - accuracy20: 0.6219 - val_loss: 2.3028 - val_accuracy20: 0.6249 - 135s/epoch - 63ms/step
Epoch 31/50
2155/2155 - 137s - loss: 2.3713 - accuracy20: 0.6225 - val_loss: 2.3136 - val_accuracy20: 0.6238 - 137s/epoch - 64ms/step
Epoch 32/50
2155/2155 - 141s - loss: 2.3687 - accuracy20: 0.6227 - val_loss: 2.3013 - val_accuracy20: 0.6332 - 141s/epoch - 65ms/step
Epoch 33/50
2155/2155 - 138s - loss: 2.3654 - accuracy20: 0.6230 - val_loss: 2.3197 - val_accuracy20: 0.6331 - 138s/epoch - 64ms/step
Epoch 34/50
2155/2155 - 137s - loss: 2.3636 - accuracy20: 0.6234 - val_loss: 2.3203 - val_accuracy20: 0.6314 - 137s/epoch - 64ms/step
Epoch 35/50
2155/2155 - 135s - loss: 2.3614 - accuracy20: 0.6239 - val_loss: 2.3126 - val_accuracy20: 0.6304 - 135s/epoch - 63ms/step
Epoch 36/50
2155/2155 - 138s - loss: 2.3587 - accuracy20: 0.6240 - val_loss: 2.3162 - val_accuracy20: 0.6316 - 138s/epoch - 64ms/step
Epoch 37/50
2155/2155 - 135s - loss: 2.3560 - accuracy20: 0.6242 - val_loss: 2.3297 - val_accuracy20: 0.6273 - 135s/epoch - 63ms/step
Epoch 38/50
2155/2155 - 139s - loss: 2.3526 - accuracy20: 0.6240 - val_loss: 2.3411 - val_accuracy20: 0.6219 - 139s/epoch - 64ms/step
Epoch 39/50
2155/2155 - 141s - loss: 2.3503 - accuracy20: 0.6248 - val_loss: 2.3393 - val_accuracy20: 0.6247 - 141s/epoch - 65ms/step
Epoch 40/50
2155/2155 - 139s - loss: 2.3481 - accuracy20: 0.6253 - val_loss: 2.3195 - val_accuracy20: 0.6309 - 139s/epoch - 64ms/step
Epoch 41/50
2155/2155 - 137s - loss: 2.3451 - accuracy20: 0.6254 - val_loss: 2.3195 - val_accuracy20: 0.6287 - 137s/epoch - 64ms/step
Epoch 42/50
2155/2155 - 143s - loss: 2.3431 - accuracy20: 0.6256 - val_loss: 2.3325 - val_accuracy20: 0.6268 - 143s/epoch - 66ms/step
testing model: results/WBA/W3/deepVOL_L3/h20
Evaluating performance on  test set...
6315/6315 - 188s - 188s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7779304
{'0': {'precision': 0.42646092780947653, 'recall': 0.7058929809173721, 'f1-score': 0.531699097351439, 'support': 304413}, '1': {'precision': 0.8147625666704804, 'recall': 0.6645260051165418, 'f1-score': 0.7320152725765612, 'support': 1007321}, '2': {'precision': 0.5097855932698487, 'recall': 0.48683329613925463, 'f1-score': 0.4980451471133815, 'support': 304708}, 'accuracy': 0.6388203226592727, 'macro avg': {'precision': 0.5836696959166019, 'recall': 0.6190840940577229, 'f1-score': 0.5872531723471273, 'support': 1616442}, 'weighted avg': {'precision': 0.6841466890815818, 'recall': 0.6388203226592727, 'f1-score': 0.6501865296718113, 'support': 1616442}}
[[214883  63247  26283]
 [221566 669391 116364]
 [ 67426  88940 148342]]
Evaluating performance on  train set...
2155/2155 - 72s - 72s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8408176
{'0': {'precision': 0.43283431878223677, 'recall': 0.7282864545408362, 'f1-score': 0.5429708582809132, 'support': 118106}, '1': {'precision': 0.7877266097103564, 'recall': 0.6074293316879411, 'f1-score': 0.6859279796487893, 'support': 311172}, '2': {'precision': 0.532737937022664, 'recall': 0.4917922838471165, 'f1-score': 0.5114469078675961, 'support': 122263}, 'accuracy': 0.6076755853146004, 'macro avg': {'precision': 0.5844329551717524, 'recall': 0.6091693566919646, 'f1-score': 0.5801152485990996, 'support': 551541}, 'weighted avg': {'precision': 0.6552059285621338, 'recall': 0.6076755853146004, 'f1-score': 0.6166372595473671, 'support': 551541}}
[[ 86015  20320  11771]
 [ 81190 189015  40967]
 [ 31520  30615  60128]]
Evaluating performance on  val set...
746/746 - 27s - 27s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7951753
{'0': {'precision': 0.4272162843167932, 'recall': 0.719743632428833, 'f1-score': 0.5361760176927132, 'support': 36042}, '1': {'precision': 0.8191564798645288, 'recall': 0.6541247263845575, 'f1-score': 0.7273974662606669, 'support': 118323}, '2': {'precision': 0.4949364239900979, 'recall': 0.4834977603121823, 'f1-score': 0.4891502286723105, 'support': 36389}, 'accuracy': 0.6339735995051218, 'macro avg': {'precision': 0.58043639605714, 'recall': 0.6191220397085243, 'f1-score': 0.5842412375418968, 'support': 190754}, 'weighted avg': {'precision': 0.6832518480290436, 'recall': 0.6339735995051218, 'f1-score': 0.6458181432693331, 'support': 190754}}
[[25941  6800  3301]
 [26272 77398 14653]
 [ 8508 10287 17594]]
training model: results/WBA/W3/deepVOL_L3/h30
Epoch 1/50
2155/2155 - 144s - loss: 3.0868 - accuracy30: 0.4446 - val_loss: 3.0315 - val_accuracy30: 0.4535 - 144s/epoch - 67ms/step
Epoch 2/50
2155/2155 - 141s - loss: 2.8064 - accuracy30: 0.5336 - val_loss: 2.6840 - val_accuracy30: 0.5879 - 141s/epoch - 65ms/step
Epoch 3/50
2155/2155 - 139s - loss: 2.6779 - accuracy30: 0.5732 - val_loss: 2.6419 - val_accuracy30: 0.5808 - 139s/epoch - 65ms/step
Epoch 4/50
2155/2155 - 138s - loss: 2.6403 - accuracy30: 0.5805 - val_loss: 2.6155 - val_accuracy30: 0.5677 - 138s/epoch - 64ms/step
Epoch 5/50
2155/2155 - 141s - loss: 2.6215 - accuracy30: 0.5837 - val_loss: 2.5894 - val_accuracy30: 0.5619 - 141s/epoch - 65ms/step
Epoch 6/50
2155/2155 - 136s - loss: 2.6079 - accuracy30: 0.5859 - val_loss: 2.5762 - val_accuracy30: 0.5601 - 136s/epoch - 63ms/step
Epoch 7/50
2155/2155 - 138s - loss: 2.5961 - accuracy30: 0.5878 - val_loss: 2.5424 - val_accuracy30: 0.5838 - 138s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 138s - loss: 2.5876 - accuracy30: 0.5896 - val_loss: 2.5424 - val_accuracy30: 0.5837 - 138s/epoch - 64ms/step
Epoch 9/50
2155/2155 - 139s - loss: 2.5789 - accuracy30: 0.5910 - val_loss: 2.5495 - val_accuracy30: 0.5866 - 139s/epoch - 64ms/step
Epoch 10/50
2155/2155 - 140s - loss: 2.5723 - accuracy30: 0.5918 - val_loss: 2.5270 - val_accuracy30: 0.5931 - 140s/epoch - 65ms/step
Epoch 11/50
2155/2155 - 138s - loss: 2.5658 - accuracy30: 0.5929 - val_loss: 2.5148 - val_accuracy30: 0.5942 - 138s/epoch - 64ms/step
Epoch 12/50
2155/2155 - 140s - loss: 2.5601 - accuracy30: 0.5936 - val_loss: 2.5107 - val_accuracy30: 0.5983 - 140s/epoch - 65ms/step
Epoch 13/50
2155/2155 - 138s - loss: 2.5564 - accuracy30: 0.5946 - val_loss: 2.5203 - val_accuracy30: 0.5991 - 138s/epoch - 64ms/step
Epoch 14/50
2155/2155 - 136s - loss: 2.5504 - accuracy30: 0.5956 - val_loss: 2.4997 - val_accuracy30: 0.6061 - 136s/epoch - 63ms/step
Epoch 15/50
2155/2155 - 137s - loss: 2.5472 - accuracy30: 0.5962 - val_loss: 2.5184 - val_accuracy30: 0.5958 - 137s/epoch - 64ms/step
Epoch 16/50
2155/2155 - 139s - loss: 2.5420 - accuracy30: 0.5978 - val_loss: 2.5023 - val_accuracy30: 0.6044 - 139s/epoch - 65ms/step
Epoch 17/50
2155/2155 - 139s - loss: 2.5390 - accuracy30: 0.5979 - val_loss: 2.5159 - val_accuracy30: 0.5957 - 139s/epoch - 64ms/step
Epoch 18/50
2155/2155 - 139s - loss: 2.5353 - accuracy30: 0.5985 - val_loss: 2.5020 - val_accuracy30: 0.5988 - 139s/epoch - 64ms/step
Epoch 19/50
2155/2155 - 139s - loss: 2.5314 - accuracy30: 0.5989 - val_loss: 2.5086 - val_accuracy30: 0.5985 - 139s/epoch - 65ms/step
Epoch 20/50
2155/2155 - 137s - loss: 2.5286 - accuracy30: 0.5999 - val_loss: 2.5093 - val_accuracy30: 0.5976 - 137s/epoch - 63ms/step
Epoch 21/50
2155/2155 - 137s - loss: 2.5247 - accuracy30: 0.6002 - val_loss: 2.5107 - val_accuracy30: 0.6046 - 137s/epoch - 64ms/step
Epoch 22/50
2155/2155 - 138s - loss: 2.5221 - accuracy30: 0.6008 - val_loss: 2.5166 - val_accuracy30: 0.6048 - 138s/epoch - 64ms/step
Epoch 23/50
2155/2155 - 138s - loss: 2.5187 - accuracy30: 0.6011 - val_loss: 2.5052 - val_accuracy30: 0.5996 - 138s/epoch - 64ms/step
Epoch 24/50
2155/2155 - 138s - loss: 2.5160 - accuracy30: 0.6018 - val_loss: 2.5064 - val_accuracy30: 0.5994 - 138s/epoch - 64ms/step
testing model: results/WBA/W3/deepVOL_L3/h30
Evaluating performance on  test set...
6315/6315 - 190s - 190s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8370884
{'0': {'precision': 0.44520655627419936, 'recall': 0.6728313031658457, 'f1-score': 0.5358475205588712, 'support': 361957}, '1': {'precision': 0.7320370765367791, 'recall': 0.6580576798008567, 'f1-score': 0.693078824904208, 'support': 891820}, '2': {'precision': 0.5526965498952306, 'recall': 0.40801841920229415, 'f1-score': 0.46946363872867214, 'support': 362665}, 'accuracy': 0.605266999991339, 'macro avg': {'precision': 0.5766467275687365, 'recall': 0.5796358007229989, 'f1-score': 0.5661299947305838, 'support': 1616442}, 'weighted avg': {'precision': 0.6275725509199368, 'recall': 0.605266999991339, 'f1-score': 0.6077009562759023, 'support': 1616442}}
[[243536  88243  30178]
 [215372 586869  89579]
 [ 88110 126581 147974]]
Evaluating performance on  train set...
2155/2155 - 70s - 70s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8930745
{'0': {'precision': 0.44309443390551984, 'recall': 0.6926314875889602, 'f1-score': 0.5404493304062709, 'support': 138264}, '1': {'precision': 0.6900887386969822, 'recall': 0.6052350526055159, 'f1-score': 0.644882610621647, 'support': 270599}, '2': {'precision': 0.5735331600142733, 'recall': 0.3942794264007065, 'f1-score': 0.46730602293541784, 'support': 142678}, 'accuracy': 0.572572120658301, 'macro avg': {'precision': 0.5689054442055917, 'recall': 0.5640486555317276, 'f1-score': 0.550879321321112, 'support': 551541}, 'weighted avg': {'precision': 0.5980188156758862, 'recall': 0.572572120658301, 'f1-score': 0.5727653329694061, 'support': 551541}}
[[ 95766  29079  13419]
 [ 78412 163776  28411]
 [ 41952  44471  56255]]
Evaluating performance on  val set...
746/746 - 28s - 28s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8434143
{'0': {'precision': 0.4494665524491862, 'recall': 0.672116638718092, 'f1-score': 0.5386920039947358, 'support': 42936}, '1': {'precision': 0.7278430465942288, 'recall': 0.6634323426020824, 'f1-score': 0.6941467105625793, 'support': 104401}, '2': {'precision': 0.5486347851021124, 'recall': 0.3966188359398392, 'f1-score': 0.4604031869953479, 'support': 43417}, 'accuracy': 0.6046583557880831, 'macro avg': {'precision': 0.5753147947151759, 'recall': 0.5773892724200046, 'f1-score': 0.5644139671842211, 'support': 190754}, 'weighted avg': {'precision': 0.6243953692620903, 'recall': 0.6046583557880831, 'f1-score': 0.605954348442176, 'support': 190754}}
[[28858 10446  3632]
 [24603 69263 10535]
 [10744 15453 17220]]
training model: results/WBA/W3/deepVOL_L3/h50
Epoch 1/50
2155/2155 - 145s - loss: 3.1854 - accuracy50: 0.4271 - val_loss: 3.1801 - val_accuracy50: 0.4420 - 145s/epoch - 67ms/step
Epoch 2/50
2155/2155 - 143s - loss: 3.0907 - accuracy50: 0.4565 - val_loss: 3.1214 - val_accuracy50: 0.4191 - 143s/epoch - 66ms/step
Epoch 3/50
2155/2155 - 141s - loss: 2.9659 - accuracy50: 0.5000 - val_loss: 2.8799 - val_accuracy50: 0.5233 - 141s/epoch - 65ms/step
Epoch 4/50
2155/2155 - 141s - loss: 2.8636 - accuracy50: 0.5287 - val_loss: 2.8478 - val_accuracy50: 0.5416 - 141s/epoch - 66ms/step
Epoch 5/50
2155/2155 - 141s - loss: 2.8268 - accuracy50: 0.5377 - val_loss: 2.8405 - val_accuracy50: 0.5435 - 141s/epoch - 65ms/step
Epoch 6/50
2155/2155 - 140s - loss: 2.8056 - accuracy50: 0.5423 - val_loss: 2.8085 - val_accuracy50: 0.5460 - 140s/epoch - 65ms/step
Epoch 7/50
2155/2155 - 137s - loss: 2.7914 - accuracy50: 0.5452 - val_loss: 2.8062 - val_accuracy50: 0.5459 - 137s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 142s - loss: 2.7824 - accuracy50: 0.5474 - val_loss: 2.7941 - val_accuracy50: 0.5490 - 142s/epoch - 66ms/step
Epoch 9/50
2155/2155 - 140s - loss: 2.7733 - accuracy50: 0.5490 - val_loss: 2.7990 - val_accuracy50: 0.5474 - 140s/epoch - 65ms/step
Epoch 10/50
2155/2155 - 141s - loss: 2.7656 - accuracy50: 0.5504 - val_loss: 2.7815 - val_accuracy50: 0.5489 - 141s/epoch - 65ms/step
Epoch 11/50
2155/2155 - 140s - loss: 2.7603 - accuracy50: 0.5518 - val_loss: 2.7832 - val_accuracy50: 0.5475 - 140s/epoch - 65ms/step
Epoch 12/50
2155/2155 - 139s - loss: 2.7540 - accuracy50: 0.5529 - val_loss: 2.7757 - val_accuracy50: 0.5490 - 139s/epoch - 65ms/step
Epoch 13/50
2155/2155 - 140s - loss: 2.7499 - accuracy50: 0.5535 - val_loss: 2.7789 - val_accuracy50: 0.5464 - 140s/epoch - 65ms/step
Epoch 14/50
2155/2155 - 141s - loss: 2.7445 - accuracy50: 0.5550 - val_loss: 2.7739 - val_accuracy50: 0.5475 - 141s/epoch - 65ms/step
Epoch 15/50
2155/2155 - 142s - loss: 2.7405 - accuracy50: 0.5556 - val_loss: 2.7709 - val_accuracy50: 0.5479 - 142s/epoch - 66ms/step
Epoch 16/50
2155/2155 - 142s - loss: 2.7368 - accuracy50: 0.5563 - val_loss: 2.7709 - val_accuracy50: 0.5484 - 142s/epoch - 66ms/step
Epoch 17/50
2155/2155 - 142s - loss: 2.7328 - accuracy50: 0.5572 - val_loss: 2.7612 - val_accuracy50: 0.5453 - 142s/epoch - 66ms/step
Epoch 18/50
2155/2155 - 138s - loss: 2.7294 - accuracy50: 0.5575 - val_loss: 2.7651 - val_accuracy50: 0.5466 - 138s/epoch - 64ms/step
Epoch 19/50
2155/2155 - 139s - loss: 2.7263 - accuracy50: 0.5580 - val_loss: 2.7479 - val_accuracy50: 0.5501 - 139s/epoch - 64ms/step
Epoch 20/50
2155/2155 - 140s - loss: 2.7230 - accuracy50: 0.5591 - val_loss: 2.7568 - val_accuracy50: 0.5469 - 140s/epoch - 65ms/step
Epoch 21/50
2155/2155 - 141s - loss: 2.7211 - accuracy50: 0.5598 - val_loss: 2.7489 - val_accuracy50: 0.5528 - 141s/epoch - 66ms/step
Epoch 22/50
2155/2155 - 145s - loss: 2.7172 - accuracy50: 0.5603 - val_loss: 2.7664 - val_accuracy50: 0.5451 - 145s/epoch - 68ms/step
Epoch 23/50
2155/2155 - 142s - loss: 2.7147 - accuracy50: 0.5610 - val_loss: 2.7543 - val_accuracy50: 0.5442 - 142s/epoch - 66ms/step
Epoch 24/50
2155/2155 - 139s - loss: 2.7120 - accuracy50: 0.5618 - val_loss: 2.7625 - val_accuracy50: 0.5444 - 139s/epoch - 64ms/step
Epoch 25/50
2155/2155 - 137s - loss: 2.7097 - accuracy50: 0.5624 - val_loss: 2.7591 - val_accuracy50: 0.5500 - 137s/epoch - 64ms/step
Epoch 26/50
2155/2155 - 141s - loss: 2.7072 - accuracy50: 0.5633 - val_loss: 2.7635 - val_accuracy50: 0.5459 - 141s/epoch - 65ms/step
Epoch 27/50
2155/2155 - 141s - loss: 2.7041 - accuracy50: 0.5633 - val_loss: 2.7587 - val_accuracy50: 0.5484 - 141s/epoch - 65ms/step
Epoch 28/50
2155/2155 - 140s - loss: 2.7019 - accuracy50: 0.5638 - val_loss: 2.7684 - val_accuracy50: 0.5471 - 140s/epoch - 65ms/step
Epoch 29/50
2155/2155 - 139s - loss: 2.6987 - accuracy50: 0.5647 - val_loss: 2.7718 - val_accuracy50: 0.5441 - 139s/epoch - 64ms/step
testing model: results/WBA/W3/deepVOL_L3/h50
Evaluating performance on  test set...
6315/6315 - 185s - 185s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.911853
{'0': {'precision': 0.4741529770470315, 'recall': 0.5934003477020461, 'f1-score': 0.5271166037720907, 'support': 448660}, '1': {'precision': 0.6272161859403885, 'recall': 0.6331715466309238, 'f1-score': 0.6301797966783291, 'support': 720702}, '2': {'precision': 0.5464430469057822, 'recall': 0.40016551847544063, 'f1-score': 0.46200229573094753, 'support': 447080}, 'accuracy': 0.5576871919932791, 'macro avg': {'precision': 0.5492707366310674, 'recall': 0.5422458042694701, 'f1-score': 0.5397662320604558, 'support': 1616442}, 'weighted avg': {'precision': 0.5623914694942151, 'recall': 0.5576871919932791, 'f1-score': 0.5550585555494372, 'support': 1616442}}
[[266235 120527  61898]
 [177777 456328  86597]
 [117484 150690 178906]]
Evaluating performance on  train set...
2155/2155 - 72s - 72s/epoch - 34ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9443494
{'0': {'precision': 0.46902216811377045, 'recall': 0.6324391607886999, 'f1-score': 0.5386080811184514, 'support': 166299}, '1': {'precision': 0.5884226403897035, 'recall': 0.556578442654392, 'f1-score': 0.5720577240678015, 'support': 213774}, '2': {'precision': 0.5560733842279867, 'recall': 0.4056850257774045, 'f1-score': 0.4691212322508202, 'support': 171468}, 'accuracy': 0.5325406452104195, 'macro avg': {'precision': 0.5378393975771535, 'recall': 0.5315675430734988, 'f1-score': 0.526595679145691, 'support': 551541}, 'weighted avg': {'precision': 0.5423643393847871, 'recall': 0.5325406452104195, 'f1-score': 0.5299702699135171, 'support': 551541}}
[[105174  35001  26124]
 [ 65383 118982  29409]
 [ 53684  48222  69562]]
Evaluating performance on  val set...
746/746 - 22s - 22s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9217713
{'0': {'precision': 0.47281917924294, 'recall': 0.606965360739671, 'f1-score': 0.531559497413156, 'support': 53321}, '1': {'precision': 0.6154855177792746, 'recall': 0.6228533843578091, 'f1-score': 0.6191475324088658, 'support': 83620}, '2': {'precision': 0.5460672964653434, 'recall': 0.38239830524222773, 'f1-score': 0.4498070975004645, 'support': 53813}, 'accuracy': 0.5505782316491398, 'macro avg': {'precision': 0.5447906644958526, 'recall': 0.5374056834465692, 'f1-score': 0.5335047091074955, 'support': 190754}, 'weighted avg': {'precision': 0.5560229923241728, 'recall': 0.5505782316491398, 'f1-score': 0.5468921750494813, 'support': 190754}}
[[32364 13828  7129]
 [21560 52083  9977]
 [14525 18710 20578]]
training model: results/WBA/W3/deepVOL_L3/h100
Epoch 1/50
2155/2155 - 141s - loss: 3.2792 - accuracy100: 0.3781 - val_loss: 3.3206 - val_accuracy100: 0.3502 - 141s/epoch - 65ms/step
Epoch 2/50
2155/2155 - 139s - loss: 3.2346 - accuracy100: 0.4031 - val_loss: 3.2556 - val_accuracy100: 0.3686 - 139s/epoch - 64ms/step
Epoch 3/50
2155/2155 - 140s - loss: 3.1787 - accuracy100: 0.4321 - val_loss: 3.2010 - val_accuracy100: 0.4261 - 140s/epoch - 65ms/step
Epoch 4/50
2155/2155 - 138s - loss: 3.1400 - accuracy100: 0.4497 - val_loss: 3.2011 - val_accuracy100: 0.4321 - 138s/epoch - 64ms/step
Epoch 5/50
2155/2155 - 136s - loss: 3.1168 - accuracy100: 0.4576 - val_loss: 3.1672 - val_accuracy100: 0.4421 - 136s/epoch - 63ms/step
Epoch 6/50
2155/2155 - 144s - loss: 3.0969 - accuracy100: 0.4636 - val_loss: 3.1625 - val_accuracy100: 0.4432 - 144s/epoch - 67ms/step
Epoch 7/50
2155/2155 - 138s - loss: 3.0833 - accuracy100: 0.4678 - val_loss: 3.1662 - val_accuracy100: 0.4435 - 138s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 139s - loss: 3.0761 - accuracy100: 0.4695 - val_loss: 3.1577 - val_accuracy100: 0.4440 - 139s/epoch - 64ms/step
Epoch 9/50
2155/2155 - 136s - loss: 3.0701 - accuracy100: 0.4713 - val_loss: 3.1400 - val_accuracy100: 0.4502 - 136s/epoch - 63ms/step
Epoch 10/50
2155/2155 - 139s - loss: 3.0643 - accuracy100: 0.4731 - val_loss: 3.1586 - val_accuracy100: 0.4451 - 139s/epoch - 65ms/step
Epoch 11/50
2155/2155 - 139s - loss: 3.0601 - accuracy100: 0.4748 - val_loss: 3.1186 - val_accuracy100: 0.4558 - 139s/epoch - 64ms/step
Epoch 12/50
2155/2155 - 137s - loss: 3.0555 - accuracy100: 0.4764 - val_loss: 3.1100 - val_accuracy100: 0.4588 - 137s/epoch - 64ms/step
Epoch 13/50
2155/2155 - 139s - loss: 3.0510 - accuracy100: 0.4782 - val_loss: 3.0943 - val_accuracy100: 0.4609 - 139s/epoch - 64ms/step
Epoch 14/50
2155/2155 - 138s - loss: 3.0473 - accuracy100: 0.4796 - val_loss: 3.1005 - val_accuracy100: 0.4603 - 138s/epoch - 64ms/step
Epoch 15/50
2155/2155 - 139s - loss: 3.0434 - accuracy100: 0.4804 - val_loss: 3.0918 - val_accuracy100: 0.4617 - 139s/epoch - 65ms/step
Epoch 16/50
2155/2155 - 137s - loss: 3.0401 - accuracy100: 0.4815 - val_loss: 3.0944 - val_accuracy100: 0.4617 - 137s/epoch - 63ms/step
Epoch 17/50
2155/2155 - 143s - loss: 3.0371 - accuracy100: 0.4831 - val_loss: 3.0943 - val_accuracy100: 0.4611 - 143s/epoch - 67ms/step
Epoch 18/50
2155/2155 - 136s - loss: 3.0348 - accuracy100: 0.4838 - val_loss: 3.0901 - val_accuracy100: 0.4624 - 136s/epoch - 63ms/step
Epoch 19/50
2155/2155 - 138s - loss: 3.0317 - accuracy100: 0.4842 - val_loss: 3.0992 - val_accuracy100: 0.4618 - 138s/epoch - 64ms/step
Epoch 20/50
2155/2155 - 137s - loss: 3.0291 - accuracy100: 0.4860 - val_loss: 3.1078 - val_accuracy100: 0.4616 - 137s/epoch - 64ms/step
Epoch 21/50
2155/2155 - 138s - loss: 3.0264 - accuracy100: 0.4863 - val_loss: 3.1020 - val_accuracy100: 0.4610 - 138s/epoch - 64ms/step
Epoch 22/50
2155/2155 - 138s - loss: 3.0240 - accuracy100: 0.4871 - val_loss: 3.1057 - val_accuracy100: 0.4594 - 138s/epoch - 64ms/step
Epoch 23/50
2155/2155 - 136s - loss: 3.0203 - accuracy100: 0.4881 - val_loss: 3.1144 - val_accuracy100: 0.4590 - 136s/epoch - 63ms/step
Epoch 24/50
2155/2155 - 136s - loss: 3.0186 - accuracy100: 0.4884 - val_loss: 3.1061 - val_accuracy100: 0.4595 - 136s/epoch - 63ms/step
Epoch 25/50
2155/2155 - 135s - loss: 3.0160 - accuracy100: 0.4889 - val_loss: 3.1111 - val_accuracy100: 0.4586 - 135s/epoch - 63ms/step
Epoch 26/50
2155/2155 - 138s - loss: 3.0125 - accuracy100: 0.4908 - val_loss: 3.1167 - val_accuracy100: 0.4554 - 138s/epoch - 64ms/step
Epoch 27/50
2155/2155 - 139s - loss: 3.0103 - accuracy100: 0.4916 - val_loss: 3.1093 - val_accuracy100: 0.4589 - 139s/epoch - 65ms/step
Epoch 28/50
2155/2155 - 139s - loss: 3.0073 - accuracy100: 0.4928 - val_loss: 3.1218 - val_accuracy100: 0.4550 - 139s/epoch - 64ms/step
testing model: results/WBA/W3/deepVOL_L3/h100
Evaluating performance on  test set...
6315/6315 - 183s - 183s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0246282
{'0': {'precision': 0.44858766322460797, 'recall': 0.5027487614786863, 'f1-score': 0.4741264735472054, 'support': 522599}, '1': {'precision': 0.47743451991439656, 'recall': 0.5356520042647207, 'f1-score': 0.5048705147954287, 'support': 584329}, '2': {'precision': 0.48422960564018497, 'recall': 0.3565476120381383, 'f1-score': 0.4106935962083422, 'support': 509514}, 'accuracy': 0.4685593420611442, 'macro avg': {'precision': 0.47008392959306317, 'recall': 0.4649827925938485, 'f1-score': 0.46323019485032546, 'support': 1616442}, 'weighted avg': {'precision': 0.47025013151645995, 'recall': 0.4685593420611442, 'f1-score': 0.4652456697906212, 'support': 1616442}}
[[262736 163526  96337]
 [174170 312997  97162]
 [148790 179058 181666]]
Evaluating performance on  train set...
2155/2155 - 66s - 66s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.035776
{'0': {'precision': 0.440207685405396, 'recall': 0.5523238020286814, 'f1-score': 0.48993343901646813, 'support': 182976}, '1': {'precision': 0.45926743385686575, 'recall': 0.44367752926306536, 'f1-score': 0.45133789687586473, 'support': 181970}, '2': {'precision': 0.49174249161934735, 'recall': 0.3852086068758541, 'f1-score': 0.43200456778807866, 'support': 186595}, 'accuracy': 0.45994042147365294, 'macro avg': {'precision': 0.463739203627203, 'recall': 0.4604033127225336, 'f1-score': 0.45775863456013716, 'support': 551541}, 'weighted avg': {'precision': 0.4639311068576656, 'recall': 0.45994042147365294, 'f1-score': 0.4576013575752209, 'support': 551541}}
[[101062  42785  39129]
 [ 66071  80736  35163]
 [ 62445  52272  71878]]
Evaluating performance on  val set...
746/746 - 22s - 22s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0304306
{'0': {'precision': 0.4534361349893519, 'recall': 0.47153341308072805, 'f1-score': 0.46230773497737593, 'support': 61862}, '1': {'precision': 0.45794669172061414, 'recall': 0.5330317284357492, 'f1-score': 0.49264466643129595, 'support': 66754}, '2': {'precision': 0.4810770872670552, 'recall': 0.37722488654285624, 'f1-score': 0.4228680702134185, 'support': 62138}, 'accuracy': 0.46233368631850447, 'macro avg': {'precision': 0.4641533046590071, 'recall': 0.4605966760197778, 'f1-score': 0.45927349054069677, 'support': 190754}, 'weighted avg': {'precision': 0.46401861921862425, 'recall': 0.46233368631850447, 'f1-score': 0.46007663960413175, 'support': 190754}}
[[29170 19890 12802]
 [18690 35582 12482]
 [16471 22227 23440]]
training model: results/WBA/W3/deepVOL_L3/h200
Epoch 1/50
2155/2155 - 145s - loss: 3.2974 - accuracy200: 0.3629 - val_loss: 3.3256 - val_accuracy200: 0.3421 - 145s/epoch - 67ms/step
Epoch 2/50
2155/2155 - 138s - loss: 3.2682 - accuracy200: 0.3796 - val_loss: 3.3006 - val_accuracy200: 0.3622 - 138s/epoch - 64ms/step
Epoch 3/50
2155/2155 - 135s - loss: 3.2550 - accuracy200: 0.3904 - val_loss: 3.3029 - val_accuracy200: 0.3652 - 135s/epoch - 63ms/step
Epoch 4/50
2155/2155 - 137s - loss: 3.2452 - accuracy200: 0.3971 - val_loss: 3.3051 - val_accuracy200: 0.3666 - 137s/epoch - 63ms/step
Epoch 5/50
2155/2155 - 138s - loss: 3.2389 - accuracy200: 0.4020 - val_loss: 3.3097 - val_accuracy200: 0.3695 - 138s/epoch - 64ms/step
Epoch 6/50
2155/2155 - 137s - loss: 3.2327 - accuracy200: 0.4059 - val_loss: 3.3075 - val_accuracy200: 0.3700 - 137s/epoch - 63ms/step
Epoch 7/50
2155/2155 - 138s - loss: 3.2255 - accuracy200: 0.4106 - val_loss: 3.3123 - val_accuracy200: 0.3711 - 138s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 136s - loss: 3.2173 - accuracy200: 0.4151 - val_loss: 3.3312 - val_accuracy200: 0.3662 - 136s/epoch - 63ms/step
Epoch 9/50
2155/2155 - 138s - loss: 3.2094 - accuracy200: 0.4190 - val_loss: 3.3381 - val_accuracy200: 0.3701 - 138s/epoch - 64ms/step
Epoch 10/50
2155/2155 - 137s - loss: 3.2037 - accuracy200: 0.4218 - val_loss: 3.3441 - val_accuracy200: 0.3725 - 137s/epoch - 64ms/step
Epoch 11/50
2155/2155 - 141s - loss: 3.1988 - accuracy200: 0.4244 - val_loss: 3.3352 - val_accuracy200: 0.3735 - 141s/epoch - 65ms/step
Epoch 12/50
2155/2155 - 135s - loss: 3.1939 - accuracy200: 0.4268 - val_loss: 3.3410 - val_accuracy200: 0.3767 - 135s/epoch - 63ms/step
testing model: results/WBA/W3/deepVOL_L3/h200
Evaluating performance on  test set...
6315/6315 - 191s - 191s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014937
{'0': {'precision': 0.39120576390256806, 'recall': 0.4858157041438713, 'f1-score': 0.43340764298235757, 'support': 560056}, '1': {'precision': 0.3205556068369179, 'recall': 0.47442338367522074, 'f1-score': 0.3825989805181202, 'support': 519713}, '2': {'precision': 0.42384228143696795, 'recall': 0.1198569706320236, 'f1-score': 0.18686967725441833, 'support': 536673}, 'accuracy': 0.36065135649778957, 'macro avg': {'precision': 0.37853455072548464, 'recall': 0.3600320194837052, 'f1-score': 0.334292100251632, 'support': 1616442}, 'weighted avg': {'precision': 0.3793261744682913, 'recall': 0.36065135649778957, 'f1-score': 0.33521903363145816, 'support': 1616442}}
[[272084 249110  38862]
 [224571 246564  48578]
 [198846 273503  64324]]
Evaluating performance on  train set...
2155/2155 - 63s - 63s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044914
{'0': {'precision': 0.37488005201336366, 'recall': 0.5233247309946636, 'f1-score': 0.43683579977864745, 'support': 182896}, '1': {'precision': 0.33197541838982725, 'recall': 0.47139015421766095, 'f1-score': 0.38958588470086636, 'support': 182210}, '2': {'precision': 0.43726661687826734, 'recall': 0.08793413253949098, 'f1-score': 0.1464227181179581, 'support': 186435}, 'accuracy': 0.3589941636251883, 'macro avg': {'precision': 0.3813740290938194, 'recall': 0.36088300591727185, 'f1-score': 0.3242814675324906, 'support': 551541}, 'weighted avg': {'precision': 0.38179410904274813, 'recall': 0.3589941636251883, 'f1-score': 0.32305900003804233, 'support': 551541}}
[[95714 78361  8821]
 [84041 85892 12277]
 [75564 94477 16394]]
Evaluating performance on  val set...
746/746 - 21s - 21s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1015286
{'0': {'precision': 0.3768393457571095, 'recall': 0.5209731808011093, 'f1-score': 0.43733671964390824, 'support': 63462}, '1': {'precision': 0.33880251701668695, 'recall': 0.4721504002990561, 'f1-score': 0.3945130244089723, 'support': 64202}, '2': {'precision': 0.4239740183052849, 'recall': 0.09104453954667935, 'f1-score': 0.14989952764946893, 'support': 63090}, 'accuracy': 0.36234626796816843, 'macro avg': {'precision': 0.3798719603596938, 'recall': 0.36138937354894823, 'f1-score': 0.3272497572341165, 'support': 190754}, 'weighted avg': {'precision': 0.37962663206445707, 'recall': 0.36234626796816843, 'f1-score': 0.3278565550109122, 'support': 190754}}
[[33062 27200  3200]
 [29285 30313  4604]
 [25388 31958  5744]]
training model: results/WBA/W3/deepVOL_L3/h300
Epoch 1/50
2155/2155 - 144s - loss: 3.3037 - accuracy300: 0.3555 - val_loss: 3.3204 - val_accuracy300: 0.3289 - 144s/epoch - 67ms/step
Epoch 2/50
2155/2155 - 140s - loss: 3.2824 - accuracy300: 0.3651 - val_loss: 3.3142 - val_accuracy300: 0.3447 - 140s/epoch - 65ms/step
Epoch 3/50
2155/2155 - 142s - loss: 3.2676 - accuracy300: 0.3812 - val_loss: 3.3207 - val_accuracy300: 0.3519 - 142s/epoch - 66ms/step
Epoch 4/50
2155/2155 - 137s - loss: 3.2581 - accuracy300: 0.3891 - val_loss: 3.3199 - val_accuracy300: 0.3577 - 137s/epoch - 64ms/step
Epoch 5/50
2155/2155 - 141s - loss: 3.2519 - accuracy300: 0.3945 - val_loss: 3.3198 - val_accuracy300: 0.3598 - 141s/epoch - 65ms/step
Epoch 6/50
2155/2155 - 137s - loss: 3.2471 - accuracy300: 0.3971 - val_loss: 3.3343 - val_accuracy300: 0.3559 - 137s/epoch - 64ms/step
Epoch 7/50
2155/2155 - 142s - loss: 3.2420 - accuracy300: 0.4007 - val_loss: 3.3513 - val_accuracy300: 0.3557 - 142s/epoch - 66ms/step
Epoch 8/50
2155/2155 - 145s - loss: 3.2388 - accuracy300: 0.4025 - val_loss: 3.3550 - val_accuracy300: 0.3583 - 145s/epoch - 67ms/step
Epoch 9/50
2155/2155 - 143s - loss: 3.2342 - accuracy300: 0.4051 - val_loss: 3.3560 - val_accuracy300: 0.3588 - 143s/epoch - 66ms/step
Epoch 10/50
2155/2155 - 140s - loss: 3.2304 - accuracy300: 0.4083 - val_loss: 3.3524 - val_accuracy300: 0.3609 - 140s/epoch - 65ms/step
Epoch 11/50
2155/2155 - 141s - loss: 3.2247 - accuracy300: 0.4108 - val_loss: 3.3571 - val_accuracy300: 0.3603 - 141s/epoch - 65ms/step
Epoch 12/50
2155/2155 - 141s - loss: 3.2182 - accuracy300: 0.4145 - val_loss: 3.3475 - val_accuracy300: 0.3610 - 141s/epoch - 66ms/step
testing model: results/WBA/W3/deepVOL_L3/h300
Evaluating performance on  test set...
6315/6315 - 196s - 196s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020521
{'0': {'precision': 0.37328469888316645, 'recall': 0.5192643179303889, 'f1-score': 0.4343367611370254, 'support': 564048}, '1': {'precision': 0.32425449232027465, 'recall': 0.4771188600533871, 'f1-score': 0.3861070081374568, 'support': 521849}, '2': {'precision': 0.3749980452562278, 'recall': 0.04519880500240319, 'f1-score': 0.08067391991818225, 'support': 530545}, 'accuracy': 0.35006143121745165, 'macro avg': {'precision': 0.35751241215322294, 'recall': 0.3471939943287264, 'f1-score': 0.3003725630642215, 'support': 1616442}, 'weighted avg': {'precision': 0.35801823283418804, 'recall': 0.35006143121745165, 'f1-score': 0.3026879296493982, 'support': 1616442}}
[[292890 251251  19907]
 [252805 248984  20060]
 [238934 267631  23980]]
Evaluating performance on  train set...
2155/2155 - 60s - 60s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048074
{'0': {'precision': 0.3576923983420931, 'recall': 0.5809604016165284, 'f1-score': 0.4427731306083832, 'support': 182861}, '1': {'precision': 0.3334304318026045, 'recall': 0.4293073588298236, 'f1-score': 0.37534298100524177, 'support': 181306}, '2': {'precision': 0.3784834123222749, 'recall': 0.042620641070799575, 'f1-score': 0.07661387031476348, 'support': 187374}, 'accuracy': 0.3482188994109232, 'macro avg': {'precision': 0.35653541415565754, 'recall': 0.3509628005057172, 'f1-score': 0.29824332730946285, 'support': 551541}, 'weighted avg': {'precision': 0.3567801458497382, 'recall': 0.3482188994109232, 'f1-score': 0.2962124652322754, 'support': 551541}}
[[106235  70560   6066]
 [ 96422  77836   7048]
 [ 94344  85044   7986]]
Evaluating performance on  val set...
746/746 - 26s - 26s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063005
{'0': {'precision': 0.36021531878814167, 'recall': 0.5623412802240931, 'f1-score': 0.4391360784596524, 'support': 64973}, '1': {'precision': 0.3241831478079181, 'recall': 0.43819896443701406, 'f1-score': 0.3726654059053325, 'support': 61609}, '2': {'precision': 0.3632153489910685, 'recall': 0.034220532319391636, 'f1-score': 0.06254806459882081, 'support': 64172}, 'accuracy': 0.34457993017184435, 'macro avg': {'precision': 0.34920460519570945, 'recall': 0.3449202589934996, 'f1-score': 0.2914498496546019, 'support': 190754}, 'weighted avg': {'precision': 0.3495870327037693, 'recall': 0.34457993017184435, 'f1-score': 0.2909787780052641, 'support': 190754}}
[[36537 26432  2004]
 [32766 26997  1846]
 [32128 29848  2196]]
training model: results/WBA/W3/deepVOL_L3/h500
Epoch 1/50
2155/2155 - 148s - loss: 3.2621 - accuracy500: 0.3930 - val_loss: 3.2805 - val_accuracy500: 0.3604 - 148s/epoch - 68ms/step
Epoch 2/50
2155/2155 - 143s - loss: 3.2661 - accuracy500: 0.3884 - val_loss: 3.2773 - val_accuracy500: 0.3726 - 143s/epoch - 66ms/step
Epoch 3/50
2155/2155 - 147s - loss: 3.2529 - accuracy500: 0.3971 - val_loss: 3.2745 - val_accuracy500: 0.3790 - 147s/epoch - 68ms/step
Epoch 4/50
2155/2155 - 140s - loss: 3.2596 - accuracy500: 0.3965 - val_loss: 3.2897 - val_accuracy500: 0.3804 - 140s/epoch - 65ms/step
Epoch 5/50
2155/2155 - 139s - loss: 3.2396 - accuracy500: 0.4110 - val_loss: 3.2907 - val_accuracy500: 0.3803 - 139s/epoch - 64ms/step
Epoch 6/50
2155/2155 - 141s - loss: 3.2328 - accuracy500: 0.4132 - val_loss: 3.2918 - val_accuracy500: 0.3836 - 141s/epoch - 65ms/step
Epoch 7/50
2155/2155 - 138s - loss: 3.2309 - accuracy500: 0.4121 - val_loss: 3.3078 - val_accuracy500: 0.3767 - 138s/epoch - 64ms/step
Epoch 8/50
2155/2155 - 140s - loss: 3.2303 - accuracy500: 0.4125 - val_loss: 3.3013 - val_accuracy500: 0.3759 - 140s/epoch - 65ms/step
Epoch 9/50
2155/2155 - 139s - loss: 3.2246 - accuracy500: 0.4118 - val_loss: 3.3057 - val_accuracy500: 0.3795 - 139s/epoch - 64ms/step
Epoch 10/50
2155/2155 - 142s - loss: 3.2237 - accuracy500: 0.4163 - val_loss: 3.3257 - val_accuracy500: 0.3772 - 142s/epoch - 66ms/step
Epoch 11/50
2155/2155 - 138s - loss: 3.2191 - accuracy500: 0.4179 - val_loss: 3.3231 - val_accuracy500: 0.3759 - 138s/epoch - 64ms/step
Epoch 12/50
2155/2155 - 138s - loss: 3.2125 - accuracy500: 0.4215 - val_loss: 3.3157 - val_accuracy500: 0.3770 - 138s/epoch - 64ms/step
Epoch 13/50
2155/2155 - 139s - loss: 3.2110 - accuracy500: 0.4217 - val_loss: 3.3117 - val_accuracy500: 0.3777 - 139s/epoch - 65ms/step
testing model: results/WBA/W3/deepVOL_L3/h500
Evaluating performance on  test set...
6315/6315 - 189s - 189s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0896447
{'0': {'precision': 0.40254053837494974, 'recall': 0.4964338367135514, 'f1-score': 0.4445838489635298, 'support': 627425}, '1': {'precision': 0.23275862068965517, 'recall': 0.0001971229779684652, 'f1-score': 0.0003939123520701067, 'support': 410911}, '2': {'precision': 0.373769619895503, 'recall': 0.5445956277914431, 'f1-score': 0.4432948683740875, 'support': 578106}, 'accuracy': 0.3875115840840562, 'macro avg': {'precision': 0.3363562596533693, 'recall': 0.34707552916098766, 'f1-score': 0.29609087656322913, 'support': 1616442}, 'weighted avg': {'precision': 0.34909111168567714, 'recall': 0.3875115840840562, 'f1-score': 0.33120663007439455, 'support': 1616442}}
[[311475    147 315803]
 [199146     81 211684]
 [263152    120 314834]]
Evaluating performance on  train set...
2155/2155 - 62s - 62s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002643
{'0': {'precision': 0.34353562005277044, 'recall': 0.5278995353730166, 'f1-score': 0.41621523547860345, 'support': 182512}, '1': {'precision': 0.37815126050420167, 'recall': 0.0002469406793612468, 'f1-score': 0.0004935590543408519, 'support': 182230}, '2': {'precision': 0.35789889357179233, 'recall': 0.5191516014539692, 'f1-score': 0.4237014511939636, 'support': 186799}, 'accuracy': 0.3505995021222357, 'macro avg': {'precision': 0.35986192470958817, 'recall': 0.3490993591687824, 'f1-score': 0.2801367485756359, 'support': 551541}, 'weighted avg': {'precision': 0.3598373152840299, 'recall': 0.3505995021222357, 'f1-score': 0.28139562372647664, 'support': 551541}}
[[96348    51 86113]
 [94313    45 87872]
 [89799    23 96977]]
Evaluating performance on  val set...
746/746 - 22s - 22s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917528
{'0': {'precision': 0.3823691226882221, 'recall': 0.509595453968612, 'f1-score': 0.4369087557046574, 'support': 70919}, '1': {'precision': 0.2826086956521739, 'recall': 0.00025150905432595576, 'f1-score': 0.0005025708431592377, 'support': 51688}, '2': {'precision': 0.37228667664670656, 'recall': 0.5254963534711726, 'f1-score': 0.43581864317051944, 'support': 68147}, 'accuracy': 0.3772607651739937, 'macro avg': {'precision': 0.34575483166236753, 'recall': 0.3451144388313702, 'f1-score': 0.2910766565727787, 'support': 190754}, 'weighted avg': {'precision': 0.3517353986088821, 'recall': 0.3772607651739937, 'f1-score': 0.3182677270395441, 'support': 190754}}
[[36140    20 34759]
 [26053    13 25622]
 [32323    13 35811]]
training model: results/WBA/W3/deepVOL_L3/h1000
Epoch 1/50
2155/2155 - 144s - loss: 3.2916 - accuracy1000: 0.3654 - val_loss: 3.4354 - val_accuracy1000: 0.2980 - 144s/epoch - 67ms/step
Epoch 2/50
2155/2155 - 142s - loss: 3.2857 - accuracy1000: 0.3661 - val_loss: 3.3468 - val_accuracy1000: 0.2988 - 142s/epoch - 66ms/step
Epoch 3/50
2155/2155 - 139s - loss: 3.2660 - accuracy1000: 0.3836 - val_loss: 3.3493 - val_accuracy1000: 0.3081 - 139s/epoch - 64ms/step
Epoch 4/50
2155/2155 - 141s - loss: 3.2497 - accuracy1000: 0.3930 - val_loss: 3.3689 - val_accuracy1000: 0.3230 - 141s/epoch - 65ms/step
Epoch 5/50
2155/2155 - 138s - loss: 3.2367 - accuracy1000: 0.4037 - val_loss: 3.4508 - val_accuracy1000: 0.3167 - 138s/epoch - 64ms/step
Epoch 6/50
2155/2155 - 139s - loss: 3.2276 - accuracy1000: 0.4068 - val_loss: 3.4736 - val_accuracy1000: 0.3369 - 139s/epoch - 65ms/step
Epoch 7/50
2155/2155 - 142s - loss: 3.2193 - accuracy1000: 0.4143 - val_loss: 3.4728 - val_accuracy1000: 0.3426 - 142s/epoch - 66ms/step
Epoch 8/50
2155/2155 - 143s - loss: 3.2109 - accuracy1000: 0.4181 - val_loss: 3.4835 - val_accuracy1000: 0.3485 - 143s/epoch - 66ms/step
Epoch 9/50
2155/2155 - 140s - loss: 3.2075 - accuracy1000: 0.4209 - val_loss: 3.4861 - val_accuracy1000: 0.3483 - 140s/epoch - 65ms/step
Epoch 10/50
2155/2155 - 136s - loss: 3.2010 - accuracy1000: 0.4242 - val_loss: 3.5109 - val_accuracy1000: 0.3542 - 136s/epoch - 63ms/step
Epoch 11/50
2155/2155 - 135s - loss: 3.1964 - accuracy1000: 0.4258 - val_loss: 3.5581 - val_accuracy1000: 0.3443 - 135s/epoch - 63ms/step
Epoch 12/50
2155/2155 - 142s - loss: 3.1869 - accuracy1000: 0.4296 - val_loss: 3.5808 - val_accuracy1000: 0.3513 - 142s/epoch - 66ms/step
testing model: results/WBA/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
6315/6315 - 183s - 183s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1476647
{'0': {'precision': 0.4113249342378513, 'recall': 0.004318514814642542, 'f1-score': 0.008547291319939414, 'support': 687968}, '1': {'precision': 0.18745338292427505, 'recall': 0.9858447579047468, 'f1-score': 0.3150093373144407, 'support': 302856}, '2': {'precision': 0.420480097234883, 'recall': 0.011059464401599698, 'f1-score': 0.02155206650957134, 'support': 625618}, 'accuracy': 0.19082590034161448, 'macro avg': {'precision': 0.3397528047990031, 'recall': 0.333740912373663, 'f1-score': 0.1150362317146505, 'support': 1616442}, 'weighted avg': {'precision': 0.37292379904045636, 'recall': 0.19082590034161448, 'f1-score': 0.07099920165529189, 'support': 1616442}}
[[  2971 678308   6689]
 [  1440 298569   2847]
 [  2812 615887   6919]]
Evaluating performance on  train set...
2155/2155 - 71s - 71s/epoch - 33ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109496
{'0': {'precision': 0.3320839580209895, 'recall': 0.0024387558491604736, 'f1-score': 0.004841953394832336, 'support': 181650}, '1': {'precision': 0.3300339730052337, 'recall': 0.9884936087826987, 'f1-score': 0.49484967550615255, 'support': 181812}, '2': {'precision': 0.3837723174827647, 'recall': 0.011543021815301016, 'f1-score': 0.022411942024197874, 'support': 188079}, 'accuracy': 0.3305901102547227, 'macro avg': {'precision': 0.3486300828363293, 'recall': 0.33415846214905337, 'f1-score': 0.17403452364172758, 'support': 551541}, 'weighted avg': {'precision': 0.34903425379868624, 'recall': 0.3305901102547227, 'f1-score': 0.17236137600153936, 'support': 551541}}
[[   443 179353   1854]
 [   460 179720   1632]
 [   431 185477   2171]]
Evaluating performance on  val set...
746/746 - 22s - 22s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166831
{'0': {'precision': 0.2981651376146789, 'recall': 0.0019094060278479525, 'f1-score': 0.0037945125510799762, 'support': 68084}, '1': {'precision': 0.29799870610569634, 'recall': 0.9888439204645434, 'f1-score': 0.4579801799452341, 'support': 56830}, '2': {'precision': 0.3816091954022989, 'recall': 0.01008505467800729, 'f1-score': 0.01965078425569695, 'support': 65840}, 'accuracy': 0.29876175597890475, 'macro avg': {'precision': 0.3259243463742247, 'recall': 0.33361279372346625, 'f1-score': 0.16047515891733702, 'support': 190754}, 'weighted avg': {'precision': 0.32691682021153884, 'recall': 0.29876175597890475, 'f1-score': 0.1445797564098812, 'support': 190754}}
[[  130 67364   590]
 [  148 56196   486]
 [  158 65018   664]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        28 (peak)  24.55 (ave)

============================================
