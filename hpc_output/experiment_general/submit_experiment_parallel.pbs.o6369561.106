This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2020-01-22.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-14.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-02.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-10.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-06.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-08.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-03.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-24.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-07.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-09.csv
data/AAL_orderbooks/AAL_orderbooks_2019-12-31.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-16.csv
data/AAL_orderbooks/AAL_orderbooks_2020-01-15.csv
training model: results/AAL/W10/deepLOB_L1/h10
Epoch 1/50
1686/1686 - 35s - loss: 2.7680 - accuracy10: 0.4610 - val_loss: 4.4127 - val_accuracy10: 0.5986 - 35s/epoch - 21ms/step
Epoch 2/50
1686/1686 - 27s - loss: 2.6976 - accuracy10: 0.4594 - val_loss: 4.1756 - val_accuracy10: 0.5814 - 27s/epoch - 16ms/step
Epoch 3/50
1686/1686 - 27s - loss: 2.5691 - accuracy10: 0.5155 - val_loss: 4.3247 - val_accuracy10: 0.5820 - 27s/epoch - 16ms/step
Epoch 4/50
1686/1686 - 26s - loss: 2.4854 - accuracy10: 0.5507 - val_loss: 4.4733 - val_accuracy10: 0.4987 - 26s/epoch - 15ms/step
Epoch 5/50
1686/1686 - 26s - loss: 2.4144 - accuracy10: 0.5827 - val_loss: 4.4236 - val_accuracy10: 0.5000 - 26s/epoch - 16ms/step
Epoch 6/50
1686/1686 - 27s - loss: 2.3575 - accuracy10: 0.6038 - val_loss: 4.5220 - val_accuracy10: 0.5102 - 27s/epoch - 16ms/step
Epoch 7/50
1686/1686 - 26s - loss: 2.3200 - accuracy10: 0.6166 - val_loss: 4.5488 - val_accuracy10: 0.5020 - 26s/epoch - 16ms/step
Epoch 8/50
1686/1686 - 26s - loss: 2.2894 - accuracy10: 0.6272 - val_loss: 4.5595 - val_accuracy10: 0.5484 - 26s/epoch - 16ms/step
Epoch 9/50
1686/1686 - 26s - loss: 2.2616 - accuracy10: 0.6331 - val_loss: 4.7429 - val_accuracy10: 0.5707 - 26s/epoch - 15ms/step
Epoch 10/50
1686/1686 - 26s - loss: 2.2381 - accuracy10: 0.6393 - val_loss: 4.7430 - val_accuracy10: 0.5541 - 26s/epoch - 15ms/step
Epoch 11/50
1686/1686 - 26s - loss: 2.2156 - accuracy10: 0.6449 - val_loss: 4.8072 - val_accuracy10: 0.5122 - 26s/epoch - 15ms/step
Epoch 12/50
1686/1686 - 27s - loss: 2.1981 - accuracy10: 0.6486 - val_loss: 4.8292 - val_accuracy10: 0.5391 - 27s/epoch - 16ms/step
testing model: results/AAL/W10/deepLOB_L1/h10
Evaluating performance on  test set...
10110/10110 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7984065
{'0': {'precision': 0.29602325610001107, 'recall': 0.24844887214164044, 'f1-score': 0.2701576087769978, 'support': 290595}, '1': {'precision': 0.8036266927160209, 'recall': 0.7477182836938935, 'f1-score': 0.7746650558649824, 'support': 2002440}, '2': {'precision': 0.23500970736554155, 'recall': 0.3831617333071245, 'f1-score': 0.29133253623039024, 'support': 295066}, 'accuracy': 0.650097117539076, 'macro avg': {'precision': 0.4448865520605245, 'recall': 0.4597762963808862, 'f1-score': 0.4453850669574568, 'support': 2588101}, 'weighted avg': {'precision': 0.6818051099946149, 'recall': 0.650097117539076, 'f1-score': 0.662914264522205, 'support': 2588101}}
[[  72198  192565   25832]
 [ 162991 1497261  342188]
 [   8704  173304  113058]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8731344
{'0': {'precision': 0.2226951737284464, 'recall': 0.48224505113050004, 'f1-score': 0.30468865771613174, 'support': 42636}, '1': {'precision': 0.8436998962557767, 'recall': 0.6198623413518726, 'f1-score': 0.7146642344999302, 'support': 346364}, '2': {'precision': 0.19687853907134767, 'recall': 0.3920550648374366, 'f1-score': 0.26212540051517247, 'support': 42568}, 'accuracy': 0.5837967597226856, 'macro avg': {'precision': 0.4210912030185236, 'recall': 0.4980541524399364, 'f1-score': 0.4271594309104115, 'support': 431568}, 'weighted avg': {'precision': 0.7185491694124935, 'recall': 0.5837967597226856, 'f1-score': 0.6295249475814905, 'support': 431568}}
[[ 20561  18721   3354]
 [ 66941 214698  64725]
 [  4826  21053  16689]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92990315
{'0': {'precision': 0.2301400724850622, 'recall': 0.44275888061810986, 'f1-score': 0.30285843189069, 'support': 21226}, '1': {'precision': 0.7885474470387045, 'recall': 0.659055939211411, 'f1-score': 0.7180100340426546, 'support': 137131}, '2': {'precision': 0.20443803572859087, 'recall': 0.23140046243822823, 'f1-score': 0.21708525615124513, 'support': 22057}, 'accuracy': 0.5813240657598634, 'macro avg': {'precision': 0.40770851841745254, 'recall': 0.44440509408924966, 'f1-score': 0.41265124069486325, 'support': 180414}, 'weighted avg': {'precision': 0.6514380419063822, 'recall': 0.5813240657598634, 'f1-score': 0.6079248647474313, 'support': 180414}}
[[ 9398 10797  1031]
 [27923 90377 18831]
 [ 3515 13438  5104]]
training model: results/AAL/W10/deepLOB_L1/h20
Epoch 1/50
1686/1686 - 29s - loss: 2.7675 - accuracy20: 0.4767 - val_loss: 4.0994 - val_accuracy20: 0.5906 - 29s/epoch - 17ms/step
Epoch 2/50
1686/1686 - 26s - loss: 2.6920 - accuracy20: 0.4718 - val_loss: 4.5791 - val_accuracy20: 0.5473 - 26s/epoch - 15ms/step
Epoch 3/50
1686/1686 - 26s - loss: 2.5914 - accuracy20: 0.5208 - val_loss: 4.5351 - val_accuracy20: 0.5223 - 26s/epoch - 15ms/step
Epoch 4/50
1686/1686 - 26s - loss: 2.5224 - accuracy20: 0.5503 - val_loss: 4.6943 - val_accuracy20: 0.4706 - 26s/epoch - 15ms/step
Epoch 5/50
1686/1686 - 26s - loss: 2.4583 - accuracy20: 0.5771 - val_loss: 4.7099 - val_accuracy20: 0.5508 - 26s/epoch - 15ms/step
Epoch 6/50
1686/1686 - 26s - loss: 2.4090 - accuracy20: 0.5943 - val_loss: 4.8658 - val_accuracy20: 0.5451 - 26s/epoch - 15ms/step
Epoch 7/50
1686/1686 - 26s - loss: 2.3701 - accuracy20: 0.6066 - val_loss: 4.8635 - val_accuracy20: 0.5455 - 26s/epoch - 15ms/step
Epoch 8/50
1686/1686 - 26s - loss: 2.3431 - accuracy20: 0.6149 - val_loss: 5.0491 - val_accuracy20: 0.5597 - 26s/epoch - 16ms/step
Epoch 9/50
1686/1686 - 26s - loss: 2.3170 - accuracy20: 0.6232 - val_loss: 5.0287 - val_accuracy20: 0.5422 - 26s/epoch - 15ms/step
Epoch 10/50
1686/1686 - 26s - loss: 2.2912 - accuracy20: 0.6294 - val_loss: 4.9853 - val_accuracy20: 0.5595 - 26s/epoch - 16ms/step
Epoch 11/50
1686/1686 - 26s - loss: 2.2697 - accuracy20: 0.6337 - val_loss: 4.9089 - val_accuracy20: 0.5698 - 26s/epoch - 15ms/step
testing model: results/AAL/W10/deepLOB_L1/h20
Evaluating performance on  test set...
10110/10110 - 50s - 50s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84678847
{'0': {'precision': 0.3239232510014159, 'recall': 0.2692940359773029, 'f1-score': 0.29409324887792604, 'support': 397584}, '1': {'precision': 0.7198526093419667, 'recall': 0.7456999280039902, 'f1-score': 0.7325483396615675, 'support': 1790377}, '2': {'precision': 0.28272599564166334, 'recall': 0.28468036187334433, 'f1-score': 0.28369981296214664, 'support': 400140}, 'accuracy': 0.6012373551109481, 'macro avg': {'precision': 0.44216728532834865, 'recall': 0.4332247752848792, 'f1-score': 0.43678046716721336, 'support': 2588101}, 'weighted avg': {'precision': 0.5914468704575457, 'recall': 0.6012373551109481, 'f1-score': 0.5957975025467758, 'support': 2588101}}
[[ 107067  256595   33922]
 [ 200221 1335084  255072]
 [  23244  262984  113912]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82507426
{'0': {'precision': 0.2961466443283729, 'recall': 0.3622976231484671, 'f1-score': 0.3258991858330299, 'support': 58060}, '1': {'precision': 0.7616163562548588, 'recall': 0.7263760254245075, 'f1-score': 0.7435788900079305, 'support': 315601}, '2': {'precision': 0.25676424648561497, 'recall': 0.26400953252629217, 'f1-score': 0.26033648933996323, 'support': 57907}, 'accuracy': 0.6153560968375783, 'macro avg': {'precision': 0.4381757490229489, 'recall': 0.4508943936997556, 'f1-score': 0.44327152172697454, 'support': 431568}, 'weighted avg': {'precision': 0.6312553410849219, 'recall': 0.6153560968375783, 'f1-score': 0.6225467436952411, 'support': 431568}}
[[ 21035  33678   3347]
 [ 45450 229245  40906]
 [  4544  38075  15288]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89488065
{'0': {'precision': 0.31365442557093576, 'recall': 0.25633430875740487, 'f1-score': 0.28211220862871395, 'support': 28022}, '1': {'precision': 0.6996879292838798, 'recall': 0.7618873415766326, 'f1-score': 0.7294641432479869, 'support': 123009}, '2': {'precision': 0.253723110865968, 'recall': 0.203519041622707, 'f1-score': 0.22586493428010274, 'support': 29383}, 'accuracy': 0.5924263083796157, 'macro avg': {'precision': 0.4223551552402611, 'recall': 0.4072468973189149, 'f1-score': 0.41248042871893453, 'support': 180414}, 'weighted avg': {'precision': 0.5670972484020324, 'recall': 0.5924263083796157, 'f1-score': 0.577962865802752, 'support': 180414}}
[[ 7183 19530  1309]
 [13010 93719 16280]
 [ 2708 20695  5980]]
training model: results/AAL/W10/deepLOB_L1/h30
Epoch 1/50
1686/1686 - 30s - loss: 2.8412 - accuracy30: 0.4698 - val_loss: 4.1218 - val_accuracy30: 0.4721 - 30s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 29s - loss: 2.8061 - accuracy30: 0.4637 - val_loss: 4.0868 - val_accuracy30: 0.4333 - 29s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 29s - loss: 2.7163 - accuracy30: 0.5044 - val_loss: 4.0850 - val_accuracy30: 0.4031 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 28s - loss: 2.6424 - accuracy30: 0.5400 - val_loss: 3.9540 - val_accuracy30: 0.4503 - 28s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 28s - loss: 2.5872 - accuracy30: 0.5642 - val_loss: 4.0701 - val_accuracy30: 0.4733 - 28s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 29s - loss: 2.5512 - accuracy30: 0.5770 - val_loss: 4.0355 - val_accuracy30: 0.4188 - 29s/epoch - 17ms/step
Epoch 7/50
1686/1686 - 28s - loss: 2.5129 - accuracy30: 0.5910 - val_loss: 4.0157 - val_accuracy30: 0.4326 - 28s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 28s - loss: 2.4850 - accuracy30: 0.5977 - val_loss: 4.0173 - val_accuracy30: 0.4296 - 28s/epoch - 16ms/step
Epoch 9/50
1686/1686 - 27s - loss: 2.4583 - accuracy30: 0.6046 - val_loss: 4.0839 - val_accuracy30: 0.4075 - 27s/epoch - 16ms/step
Epoch 10/50
1686/1686 - 28s - loss: 2.4348 - accuracy30: 0.6082 - val_loss: 4.3123 - val_accuracy30: 0.3895 - 28s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 28s - loss: 2.4142 - accuracy30: 0.6112 - val_loss: 4.1271 - val_accuracy30: 0.4085 - 28s/epoch - 17ms/step
Epoch 12/50
1686/1686 - 29s - loss: 2.3948 - accuracy30: 0.6141 - val_loss: 4.2720 - val_accuracy30: 0.4241 - 29s/epoch - 17ms/step
Epoch 13/50
1686/1686 - 29s - loss: 2.3705 - accuracy30: 0.6183 - val_loss: 4.1524 - val_accuracy30: 0.4373 - 29s/epoch - 17ms/step
Epoch 14/50
1686/1686 - 29s - loss: 2.3575 - accuracy30: 0.6209 - val_loss: 4.1408 - val_accuracy30: 0.4543 - 29s/epoch - 17ms/step
testing model: results/AAL/W10/deepLOB_L1/h30
Evaluating performance on  test set...
10110/10110 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9389963
{'0': {'precision': 0.34785574987019896, 'recall': 0.463349013538673, 'f1-score': 0.3973808484033103, 'support': 474271}, '1': {'precision': 0.7067886953582215, 'recall': 0.589126154963263, 'f1-score': 0.6426158421822153, 'support': 1636091}, '2': {'precision': 0.31015351595060764, 'recall': 0.38474983202125007, 'f1-score': 0.3434478003626746, 'support': 477739}, 'accuracy': 0.5283514824189628, 'macro avg': {'precision': 0.45493265372634273, 'recall': 0.47907500017439536, 'f1-score': 0.4611481636494001, 'support': 2588101}, 'weighted avg': {'precision': 0.5677989183114355, 'recall': 0.5283514824189628, 'f1-score': 0.5424527933424131, 'support': 2588101}}
[[219753 182094  72424]
 [335819 963864 336408]
 [ 76164 217765 183810]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9617295
{'0': {'precision': 0.30950597071528335, 'recall': 0.4811763014092609, 'f1-score': 0.3767048876730218, 'support': 69540}, '1': {'precision': 0.729229667528008, 'recall': 0.5773233197747291, 'f1-score': 0.6444457999435773, 'support': 292803}, '2': {'precision': 0.25351344273743015, 'recall': 0.3356301914048393, 'f1-score': 0.2888489678193357, 'support': 69225}, 'accuracy': 0.523062414266118, 'macro avg': {'precision': 0.43074969366024046, 'recall': 0.4647099375296097, 'f1-score': 0.43666655181197833, 'support': 431568}, 'weighted avg': {'precision': 0.585291651879293, 'recall': 0.523062414266118, 'f1-score': 0.5442648464366096, 'support': 431568}}
[[ 33461  27723   8356]
 [ 63703 169042  60058]
 [ 10947  35044  23234]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0516406
{'0': {'precision': 0.29856835816545846, 'recall': 0.4971340187426076, 'f1-score': 0.37307539118065436, 'support': 32973}, '1': {'precision': 0.6694709735486775, 'recall': 0.47427382217499114, 'f1-score': 0.5552157415662776, 'support': 112920}, '2': {'precision': 0.24896739608049917, 'recall': 0.3282639552736016, 'f1-score': 0.28316903432162627, 'support': 34521}, 'accuracy': 0.4505138182180984, 'macro avg': {'precision': 0.40566890926487836, 'recall': 0.43322393206373344, 'f1-score': 0.40382005568951945, 'support': 180414}, 'weighted avg': {'precision': 0.52122318826145, 'recall': 0.4505138182180984, 'f1-score': 0.4698729291788921, 'support': 180414}}
[[16392 11642  4939]
 [30120 53555 29245]
 [ 8390 14799 11332]]
training model: results/AAL/W10/deepLOB_L1/h50
Epoch 1/50
1686/1686 - 31s - loss: 2.9361 - accuracy50: 0.4768 - val_loss: 3.9957 - val_accuracy50: 0.4860 - 31s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 28s - loss: 2.9183 - accuracy50: 0.4602 - val_loss: 4.0412 - val_accuracy50: 0.4661 - 28s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 29s - loss: 2.8624 - accuracy50: 0.4888 - val_loss: 4.1356 - val_accuracy50: 0.3726 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 29s - loss: 2.8041 - accuracy50: 0.5154 - val_loss: 3.9029 - val_accuracy50: 0.4585 - 29s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 29s - loss: 2.7580 - accuracy50: 0.5367 - val_loss: 3.8877 - val_accuracy50: 0.4690 - 29s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 29s - loss: 2.7286 - accuracy50: 0.5461 - val_loss: 3.8733 - val_accuracy50: 0.4996 - 29s/epoch - 17ms/step
Epoch 7/50
1686/1686 - 29s - loss: 2.7008 - accuracy50: 0.5582 - val_loss: 4.0299 - val_accuracy50: 0.5278 - 29s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 29s - loss: 2.6671 - accuracy50: 0.5681 - val_loss: 4.2385 - val_accuracy50: 0.5305 - 29s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 29s - loss: 2.6419 - accuracy50: 0.5733 - val_loss: 4.2452 - val_accuracy50: 0.5339 - 29s/epoch - 17ms/step
Epoch 10/50
1686/1686 - 30s - loss: 2.6198 - accuracy50: 0.5784 - val_loss: 4.4170 - val_accuracy50: 0.5215 - 30s/epoch - 18ms/step
Epoch 11/50
1686/1686 - 31s - loss: 2.6042 - accuracy50: 0.5816 - val_loss: 4.1851 - val_accuracy50: 0.5191 - 31s/epoch - 18ms/step
Epoch 12/50
1686/1686 - 30s - loss: 2.5908 - accuracy50: 0.5827 - val_loss: 4.3627 - val_accuracy50: 0.5292 - 30s/epoch - 18ms/step
Epoch 13/50
1686/1686 - 29s - loss: 2.5660 - accuracy50: 0.5893 - val_loss: 4.3466 - val_accuracy50: 0.4952 - 29s/epoch - 17ms/step
Epoch 14/50
1686/1686 - 29s - loss: 2.5518 - accuracy50: 0.5916 - val_loss: 4.1996 - val_accuracy50: 0.4719 - 29s/epoch - 17ms/step
Epoch 15/50
1686/1686 - 29s - loss: 2.5399 - accuracy50: 0.5922 - val_loss: 4.3387 - val_accuracy50: 0.4754 - 29s/epoch - 17ms/step
Epoch 16/50
1686/1686 - 29s - loss: 2.5307 - accuracy50: 0.5946 - val_loss: 4.4492 - val_accuracy50: 0.4903 - 29s/epoch - 17ms/step
testing model: results/AAL/W10/deepLOB_L1/h50
Evaluating performance on  test set...
10110/10110 - 68s - 68s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97901326
{'0': {'precision': 0.41931859104361224, 'recall': 0.26154864685933554, 'f1-score': 0.32215446414548377, 'support': 592104}, '1': {'precision': 0.5719848618751998, 'recall': 0.7921554517042589, 'f1-score': 0.6643025238918793, 'support': 1397939}, '2': {'precision': 0.4512819243188948, 'recall': 0.21334887251738124, 'f1-score': 0.28972623657891655, 'support': 598058}, 'accuracy': 0.5370130454723366, 'macro avg': {'precision': 0.48086179241256893, 'recall': 0.42235099036032525, 'f1-score': 0.42539440820542657, 'support': 2588101}, 'weighted avg': {'precision': 0.5091659583418698, 'recall': 0.5370130454723366, 'f1-score': 0.4994690881001943, 'support': 2588101}}
[[ 154864  404857   32383]
 [ 167793 1107385  122761]
 [  46666  423797  127595]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9883427
{'0': {'precision': 0.3628038314600521, 'recall': 0.3735889073867135, 'f1-score': 0.36811739127992227, 'support': 87698}, '1': {'precision': 0.6343295968839562, 'recall': 0.6700655357017619, 'f1-score': 0.6517080454064009, 'support': 256654}, '2': {'precision': 0.35938702779757664, 'recall': 0.2890639332232618, 'f1-score': 0.32041228727933607, 'support': 87216}, 'accuracy': 0.5328221740258777, 'macro avg': {'precision': 0.4521734853805283, 'recall': 0.4442394587705791, 'f1-score': 0.446745907988553, 'support': 431568}, 'weighted avg': {'precision': 0.5235900200812664, 'recall': 0.5328221740258777, 'f1-score': 0.5271283174692184, 'support': 431568}}
[[ 32763  48782   6153]
 [ 45893 171975  38786]
 [ 11649  50356  25211]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.045574
{'0': {'precision': 0.36644951140065146, 'recall': 0.2883762200532387, 'f1-score': 0.3227586206896552, 'support': 40572}, '1': {'precision': 0.5594183359013868, 'recall': 0.7161878929848354, 'f1-score': 0.6281697756150312, 'support': 97332}, '2': {'precision': 0.3579026719155708, 'recall': 0.20103505057633497, 'f1-score': 0.2574561667771284, 'support': 42510}, 'accuracy': 0.49859766980389547, 'macro avg': {'precision': 0.4279235064058697, 'recall': 0.4018663878714697, 'f1-score': 0.40279485436060497, 'support': 180414}, 'weighted avg': {'precision': 0.46854089832070644, 'recall': 0.49859766980389547, 'f1-score': 0.4721387753083388, 'support': 180414}}
[[11700 26655  2217]
 [14509 69708 13115]
 [ 5719 28245  8546]]
training model: results/AAL/W10/deepLOB_L1/h100
Epoch 1/50
1686/1686 - 32s - loss: 3.0430 - accuracy100: 0.4832 - val_loss: 3.7792 - val_accuracy100: 0.3948 - 32s/epoch - 19ms/step
Epoch 2/50
1686/1686 - 29s - loss: 3.0213 - accuracy100: 0.4852 - val_loss: 3.9125 - val_accuracy100: 0.3719 - 29s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 29s - loss: 3.0206 - accuracy100: 0.4827 - val_loss: 3.7263 - val_accuracy100: 0.3664 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 29s - loss: 3.0057 - accuracy100: 0.4875 - val_loss: 3.8285 - val_accuracy100: 0.3929 - 29s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 30s - loss: 2.9776 - accuracy100: 0.4967 - val_loss: 3.9481 - val_accuracy100: 0.3891 - 30s/epoch - 18ms/step
Epoch 6/50
1686/1686 - 30s - loss: 2.9508 - accuracy100: 0.5079 - val_loss: 4.0020 - val_accuracy100: 0.3935 - 30s/epoch - 18ms/step
Epoch 7/50
1686/1686 - 30s - loss: 2.9351 - accuracy100: 0.5134 - val_loss: 4.0023 - val_accuracy100: 0.4074 - 30s/epoch - 18ms/step
Epoch 8/50
1686/1686 - 29s - loss: 2.9190 - accuracy100: 0.5188 - val_loss: 3.9137 - val_accuracy100: 0.4066 - 29s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 29s - loss: 2.9038 - accuracy100: 0.5234 - val_loss: 4.0815 - val_accuracy100: 0.4044 - 29s/epoch - 17ms/step
Epoch 10/50
1686/1686 - 29s - loss: 2.8919 - accuracy100: 0.5271 - val_loss: 4.0679 - val_accuracy100: 0.4065 - 29s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 29s - loss: 2.8819 - accuracy100: 0.5293 - val_loss: 3.9401 - val_accuracy100: 0.3994 - 29s/epoch - 17ms/step
Epoch 12/50
1686/1686 - 29s - loss: 2.8733 - accuracy100: 0.5319 - val_loss: 3.9303 - val_accuracy100: 0.4011 - 29s/epoch - 17ms/step
Epoch 13/50
1686/1686 - 29s - loss: 2.8601 - accuracy100: 0.5350 - val_loss: 3.8738 - val_accuracy100: 0.3973 - 29s/epoch - 17ms/step
testing model: results/AAL/W10/deepLOB_L1/h100
Evaluating performance on  test set...
10110/10110 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.138469
{'0': {'precision': 0.38366627755229976, 'recall': 0.3358053780754202, 'f1-score': 0.3581439195845237, 'support': 780056}, '1': {'precision': 0.44288103861308403, 'recall': 0.47698164602369936, 'f1-score': 0.4592992635064155, 'support': 1014712}, '2': {'precision': 0.36901485762671815, 'recall': 0.3779358730822996, 'f1-score': 0.37342209241863317, 'support': 793333}, 'accuracy': 0.4040703975617644, 'macro avg': {'precision': 0.39852072459736726, 'recall': 0.39690763239380633, 'f1-score': 0.3969550918365241, 'support': 2588101}, 'weighted avg': {'precision': 0.4023913866966836, 'recall': 0.4040703975617644, 'f1-score': 0.40248694175818434, 'support': 2588101}}
[[261947 275060 243049]
 [261079 483999 269634]
 [159721 333783 299829]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1164708
{'0': {'precision': 0.34597803545871425, 'recall': 0.4018574275900089, 'f1-score': 0.3718300353537137, 'support': 117905}, '1': {'precision': 0.4697064370928362, 'recall': 0.41217145845285297, 'f1-score': 0.43906211551305935, 'support': 196969}, '2': {'precision': 0.33264629079144015, 'recall': 0.3471386703686565, 'f1-score': 0.33973799859102954, 'support': 116694}, 'accuracy': 0.3917690838987135, 'macro avg': {'precision': 0.3827769211143302, 'recall': 0.3870558521371728, 'f1-score': 0.3835433831526009, 'support': 431568}, 'weighted avg': {'precision': 0.39884322687528934, 'recall': 0.3917690838987135, 'f1-score': 0.39383743038513747, 'support': 431568}}
[[47381 45214 25310]
 [59825 81185 55959]
 [29742 46443 40509]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.16086
{'0': {'precision': 0.3459629064494638, 'recall': 0.3064417878626361, 'f1-score': 0.3250052996577935, 'support': 52532}, '1': {'precision': 0.4013285478595618, 'recall': 0.38221713781649275, 'f1-score': 0.39153977028047804, 'support': 72553}, '2': {'precision': 0.3428880142008181, 'recall': 0.4014892732563394, 'f1-score': 0.3698819454851225, 'support': 55329}, 'accuracy': 0.3660636092542707, 'macro avg': {'precision': 0.36339315616994794, 'recall': 0.3633827329784894, 'f1-score': 0.3621423384744647, 'support': 180414}, 'weighted avg': {'precision': 0.3672850470150602, 'recall': 0.3660636092542707, 'f1-score': 0.36552463509777, 'support': 180414}}
[[16098 20715 15719]
 [17970 27731 26852]
 [12463 20652 22214]]
training model: results/AAL/W10/deepLOB_L1/h200
Epoch 1/50
1686/1686 - 30s - loss: 3.1750 - accuracy200: 0.4385 - val_loss: 3.6488 - val_accuracy200: 0.3261 - 30s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 28s - loss: 3.1700 - accuracy200: 0.4358 - val_loss: 3.5986 - val_accuracy200: 0.3389 - 28s/epoch - 16ms/step
Epoch 3/50
1686/1686 - 29s - loss: 3.1720 - accuracy200: 0.4360 - val_loss: 3.6906 - val_accuracy200: 0.3374 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 29s - loss: 3.1595 - accuracy200: 0.4393 - val_loss: 3.5726 - val_accuracy200: 0.3402 - 29s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 29s - loss: 3.1228 - accuracy200: 0.4555 - val_loss: 3.8012 - val_accuracy200: 0.3352 - 29s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 29s - loss: 3.1093 - accuracy200: 0.4623 - val_loss: 3.6233 - val_accuracy200: 0.3373 - 29s/epoch - 17ms/step
Epoch 7/50
1686/1686 - 29s - loss: 3.0916 - accuracy200: 0.4672 - val_loss: 3.6427 - val_accuracy200: 0.3185 - 29s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 28s - loss: 3.0838 - accuracy200: 0.4695 - val_loss: 3.6364 - val_accuracy200: 0.3197 - 28s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 29s - loss: 3.0703 - accuracy200: 0.4734 - val_loss: 3.6409 - val_accuracy200: 0.3145 - 29s/epoch - 17ms/step
Epoch 10/50
1686/1686 - 29s - loss: 3.0626 - accuracy200: 0.4759 - val_loss: 3.6871 - val_accuracy200: 0.3211 - 29s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 29s - loss: 3.0552 - accuracy200: 0.4779 - val_loss: 3.6886 - val_accuracy200: 0.3224 - 29s/epoch - 17ms/step
Epoch 12/50
1686/1686 - 29s - loss: 3.0484 - accuracy200: 0.4791 - val_loss: 3.7357 - val_accuracy200: 0.3318 - 29s/epoch - 17ms/step
Epoch 13/50
1686/1686 - 28s - loss: 3.0430 - accuracy200: 0.4812 - val_loss: 3.6838 - val_accuracy200: 0.3280 - 28s/epoch - 16ms/step
Epoch 14/50
1686/1686 - 28s - loss: 3.0387 - accuracy200: 0.4824 - val_loss: 3.6873 - val_accuracy200: 0.3370 - 28s/epoch - 17ms/step
testing model: results/AAL/W10/deepLOB_L1/h200
Evaluating performance on  test set...
10110/10110 - 61s - 61s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1867661
{'0': {'precision': 0.49162153608102405, 'recall': 0.05989161052620305, 'f1-score': 0.1067753533941689, 'support': 933670}, '1': {'precision': 0.2964796914888744, 'recall': 0.6061121193760456, 'f1-score': 0.398186493600198, 'support': 704731}, '2': {'precision': 0.4153271331838925, 'recall': 0.4520322207012741, 'f1-score': 0.43290303030608607, 'support': 949700}, 'accuracy': 0.3525210183064726, 'macro avg': {'precision': 0.4011427869179303, 'recall': 0.37267865020117424, 'f1-score': 0.3126216257668177, 'support': 2588101}, 'weighted avg': {'precision': 0.41048895983586364, 'recall': 0.3525210183064726, 'f1-score': 0.30579769410335406, 'support': 2588101}}
[[ 55919 522472 355279]
 [ 28528 427146 249057]
 [ 29297 491108 429295]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1599033
{'0': {'precision': 0.45592072667217176, 'recall': 0.0956668191458394, 'f1-score': 0.15814891410828555, 'support': 144282}, '1': {'precision': 0.33922546291731154, 'recall': 0.5431952987697716, 'f1-score': 0.4176367662233811, 'support': 145664}, '2': {'precision': 0.3655352169669848, 'recall': 0.43373204728078973, 'f1-score': 0.39672421253867074, 'support': 141622}, 'accuracy': 0.3576562673784896, 'macro avg': {'precision': 0.38689380218548935, 'recall': 0.3575313883988002, 'f1-score': 0.32416996429011247, 'support': 431568}, 'weighted avg': {'precision': 0.386872800145979, 'recall': 0.3576562673784896, 'f1-score': 0.32402207756062973, 'support': 431568}}
[[13803 81122 49357]
 [ 9279 79124 57261]
 [ 7193 73003 61426]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1891419
{'0': {'precision': 0.4188060154944554, 'recall': 0.0448489580791567, 'f1-score': 0.08102151169625015, 'support': 61473}, '1': {'precision': 0.29804748221772104, 'recall': 0.4678275014325588, 'f1-score': 0.36411897996619075, 'support': 54099}, '2': {'precision': 0.37525726817747285, 'recall': 0.5145738872952715, 'f1-score': 0.43400950851018166, 'support': 64842}, 'accuracy': 0.3405057257197335, 'macro avg': {'precision': 0.36403692196321646, 'recall': 0.3424167822689957, 'f1-score': 0.29305000005754084, 'support': 180414}, 'weighted avg': {'precision': 0.3669436114389728, 'recall': 0.3405057257197335, 'f1-score': 0.29277745982302783, 'support': 180414}}
[[ 2757 30447 28269]
 [ 1510 25309 27280]
 [ 2316 29160 33366]]
training model: results/AAL/W10/deepLOB_L1/h300
Epoch 1/50
1686/1686 - 31s - loss: 3.2149 - accuracy300: 0.4183 - val_loss: 3.6490 - val_accuracy300: 0.2919 - 31s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 29s - loss: 3.2093 - accuracy300: 0.4174 - val_loss: 3.5479 - val_accuracy300: 0.2886 - 29s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 28s - loss: 3.2031 - accuracy300: 0.4169 - val_loss: 3.5186 - val_accuracy300: 0.3146 - 28s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 28s - loss: 3.1800 - accuracy300: 0.4304 - val_loss: 3.6178 - val_accuracy300: 0.3158 - 28s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 29s - loss: 3.1599 - accuracy300: 0.4377 - val_loss: 3.6782 - val_accuracy300: 0.3295 - 29s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 29s - loss: 3.1491 - accuracy300: 0.4430 - val_loss: 3.6809 - val_accuracy300: 0.3149 - 29s/epoch - 17ms/step
Epoch 7/50
1686/1686 - 29s - loss: 3.1415 - accuracy300: 0.4466 - val_loss: 3.6234 - val_accuracy300: 0.3243 - 29s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 29s - loss: 3.1339 - accuracy300: 0.4510 - val_loss: 3.6923 - val_accuracy300: 0.3313 - 29s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 29s - loss: 3.1297 - accuracy300: 0.4518 - val_loss: 3.6624 - val_accuracy300: 0.3304 - 29s/epoch - 17ms/step
Epoch 10/50
1686/1686 - 29s - loss: 3.1244 - accuracy300: 0.4541 - val_loss: 3.6569 - val_accuracy300: 0.3338 - 29s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 29s - loss: 3.1203 - accuracy300: 0.4561 - val_loss: 3.6746 - val_accuracy300: 0.3350 - 29s/epoch - 17ms/step
Epoch 12/50
1686/1686 - 30s - loss: 3.1158 - accuracy300: 0.4575 - val_loss: 3.6801 - val_accuracy300: 0.3361 - 30s/epoch - 18ms/step
Epoch 13/50
1686/1686 - 30s - loss: 3.1110 - accuracy300: 0.4589 - val_loss: 3.7079 - val_accuracy300: 0.3368 - 30s/epoch - 18ms/step
testing model: results/AAL/W10/deepLOB_L1/h300
Evaluating performance on  test set...
10110/10110 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2164094
{'0': {'precision': 0.4546278395360077, 'recall': 0.07808187338388681, 'f1-score': 0.13327406105988743, 'support': 963732}, '1': {'precision': 0.25440547732666347, 'recall': 0.8140543514886224, 'f1-score': 0.38766059382867757, 'support': 646974}, '2': {'precision': 0.40165278936584425, 'recall': 0.14480532435709206, 'f1-score': 0.2128670468329462, 'support': 977395}, 'accuracy': 0.28725849570785683, 'macro avg': {'precision': 0.37022870207617187, 'recall': 0.34564718307653375, 'f1-score': 0.24460056724050372, 'support': 2588101}, 'weighted avg': {'precision': 0.384570213605221, 'recall': 0.28725849570785683, 'f1-score': 0.22692390663438938, 'support': 2588101}}
[[ 75250 760472 128010]
 [ 37470 526672  82832]
 [ 52800 783063 141532]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1740766
{'0': {'precision': 0.3897432106067327, 'recall': 0.10619154093561362, 'f1-score': 0.16690676333855742, 'support': 148929}, '1': {'precision': 0.3180183491055139, 'recall': 0.7103394190810546, 'f1-score': 0.4393431475878013, 'support': 136439}, '2': {'precision': 0.37328663868079875, 'recall': 0.22017783857729137, 'f1-score': 0.27698185291308497, 'support': 146200}, 'accuracy': 0.3358057131205279, 'macro avg': {'precision': 0.36034939946434846, 'recall': 0.3455695995313199, 'f1-score': 0.29441058794648123, 'support': 431568}, 'weighted avg': {'precision': 0.36149269343693247, 'recall': 0.3358057131205279, 'f1-score': 0.2903263077125113, 'support': 431568}}
[[ 15815 106113  27001]
 [ 12478  96918  27043]
 [ 12285 101725  32190]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1835814
{'0': {'precision': 0.3453173186171076, 'recall': 0.06830184439058061, 'f1-score': 0.1140460204505555, 'support': 62297}, '1': {'precision': 0.2875656602109146, 'recall': 0.6903602163993762, 'f1-score': 0.4060100998663919, 'support': 51941}, '2': {'precision': 0.38366707376085907, 'recall': 0.2516017891682785, 'f1-score': 0.3039069843848393, 'support': 66176}, 'accuracy': 0.3146263593734411, 'macro avg': {'precision': 0.3388500175296271, 'recall': 0.3367546166527451, 'f1-score': 0.2746543682339289, 'support': 180414}, 'weighted avg': {'precision': 0.3427573981404086, 'recall': 0.3146263593734411, 'f1-score': 0.26774332441949983, 'support': 180414}}
[[ 4255 43947 14095]
 [ 3431 35858 12652]
 [ 4636 44890 16650]]
training model: results/AAL/W10/deepLOB_L1/h500
Epoch 1/50
1686/1686 - 31s - loss: 3.2583 - accuracy500: 0.3965 - val_loss: 3.4668 - val_accuracy500: 0.3121 - 31s/epoch - 19ms/step
Epoch 2/50
1686/1686 - 29s - loss: 3.2366 - accuracy500: 0.4045 - val_loss: 3.4972 - val_accuracy500: 0.3259 - 29s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 29s - loss: 3.2201 - accuracy500: 0.4154 - val_loss: 3.6345 - val_accuracy500: 0.3125 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 28s - loss: 3.2072 - accuracy500: 0.4219 - val_loss: 3.5847 - val_accuracy500: 0.3311 - 28s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 29s - loss: 3.1967 - accuracy500: 0.4278 - val_loss: 3.5171 - val_accuracy500: 0.3290 - 29s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 28s - loss: 3.1843 - accuracy500: 0.4339 - val_loss: 3.5093 - val_accuracy500: 0.3274 - 28s/epoch - 16ms/step
Epoch 7/50
1686/1686 - 28s - loss: 3.1782 - accuracy500: 0.4358 - val_loss: 3.5213 - val_accuracy500: 0.3262 - 28s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 29s - loss: 3.1719 - accuracy500: 0.4392 - val_loss: 3.5439 - val_accuracy500: 0.3307 - 29s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 28s - loss: 3.1684 - accuracy500: 0.4407 - val_loss: 3.5357 - val_accuracy500: 0.3249 - 28s/epoch - 17ms/step
Epoch 10/50
1686/1686 - 29s - loss: 3.1638 - accuracy500: 0.4424 - val_loss: 3.6162 - val_accuracy500: 0.3251 - 29s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 29s - loss: 3.1593 - accuracy500: 0.4437 - val_loss: 3.6374 - val_accuracy500: 0.3245 - 29s/epoch - 17ms/step
testing model: results/AAL/W10/deepLOB_L1/h500
Evaluating performance on  test set...
10110/10110 - 71s - 71s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1943467
{'0': {'precision': 0.36839176405119645, 'recall': 0.004218862521588213, 'f1-score': 0.008342189383660903, 'support': 941486}, '1': {'precision': 0.26560550420801243, 'recall': 0.9298686608433356, 'f1-score': 0.41318874423340674, 'support': 684259}, '2': {'precision': 0.3977884139296914, 'recall': 0.07513435776365503, 'f1-score': 0.12639516976277088, 'support': 962356}, 'accuracy': 0.27531730794122794, 'macro avg': {'precision': 0.3439285607296334, 'recall': 0.3364072937095263, 'f1-score': 0.18264203445994617, 'support': 2588101}, 'weighted avg': {'precision': 0.35214727398548096, 'recall': 0.27531730794122794, 'f1-score': 0.15927482020473435, 'support': 2588101}}
[[  3972 872858  64656]
 [  3180 636271  44808]
 [  3630 886420  72306]]
Evaluating performance on  train set...
1686/1686 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1546887
{'0': {'precision': 0.34937570942111235, 'recall': 0.010424145545184844, 'f1-score': 0.02024427300171662, 'support': 147638}, '1': {'precision': 0.32149348991575183, 'recall': 0.9118946240296605, 'f1-score': 0.4753867526368639, 'support': 138096}, '2': {'precision': 0.3844570397315512, 'recall': 0.0934898583320762, 'f1-score': 0.15040513632327066, 'support': 145834}, 'accuracy': 0.3269519519519519, 'macro avg': {'precision': 0.3517754130228051, 'recall': 0.33860287596897387, 'f1-score': 0.21534538732061706, 'support': 431568}, 'weighted avg': {'precision': 0.35230833588943317, 'recall': 0.3269519519519519, 'f1-score': 0.2098673108760048, 'support': 431568}}
[[  1539 134823  11276]
 [  1614 125929  10553]
 [  1252 130948  13634]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1635401
{'0': {'precision': 0.323220536756126, 'recall': 0.041222964481777896, 'f1-score': 0.07312029799527782, 'support': 60476}, '1': {'precision': 0.30129861299972804, 'recall': 0.811763843857046, 'f1-score': 0.4394781599734221, 'support': 54591}, '2': {'precision': 0.3769564029507045, 'recall': 0.14779561418274748, 'f1-score': 0.21233840471374546, 'support': 65347}, 'accuracy': 0.31298014566497057, 'macro avg': {'precision': 0.3338251842355195, 'recall': 0.3335941408405238, 'f1-score': 0.24164562089414846, 'support': 180414}, 'weighted avg': {'precision': 0.33605068246783126, 'recall': 0.31298014566497057, 'f1-score': 0.23440117233419044, 'support': 180414}}
[[ 2493 49703  8280]
 [ 2593 44315  7683]
 [ 2627 53062  9658]]
training model: results/AAL/W10/deepLOB_L1/h1000
Epoch 1/50
1686/1686 - 30s - loss: 3.1733 - accuracy1000: 0.4402 - val_loss: 3.4670 - val_accuracy1000: 0.3253 - 30s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 28s - loss: 3.1461 - accuracy1000: 0.4533 - val_loss: 3.4459 - val_accuracy1000: 0.3533 - 28s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 28s - loss: 3.1323 - accuracy1000: 0.4591 - val_loss: 3.4293 - val_accuracy1000: 0.3628 - 28s/epoch - 16ms/step
Epoch 4/50
1686/1686 - 29s - loss: 3.1145 - accuracy1000: 0.4677 - val_loss: 3.4411 - val_accuracy1000: 0.3557 - 29s/epoch - 17ms/step
Epoch 5/50
1686/1686 - 29s - loss: 3.1042 - accuracy1000: 0.4668 - val_loss: 3.4044 - val_accuracy1000: 0.3746 - 29s/epoch - 17ms/step
Epoch 6/50
1686/1686 - 28s - loss: 3.1067 - accuracy1000: 0.4718 - val_loss: 3.4887 - val_accuracy1000: 0.3600 - 28s/epoch - 16ms/step
Epoch 7/50
1686/1686 - 28s - loss: 3.1121 - accuracy1000: 0.4654 - val_loss: 3.5047 - val_accuracy1000: 0.3625 - 28s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 28s - loss: 3.0769 - accuracy1000: 0.4773 - val_loss: 3.4923 - val_accuracy1000: 0.3846 - 28s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 27s - loss: 3.0903 - accuracy1000: 0.4734 - val_loss: 3.5012 - val_accuracy1000: 0.3779 - 27s/epoch - 16ms/step
Epoch 10/50
1686/1686 - 28s - loss: 3.0825 - accuracy1000: 0.4783 - val_loss: 3.5103 - val_accuracy1000: 0.3700 - 28s/epoch - 17ms/step
Epoch 11/50
1686/1686 - 27s - loss: 3.0684 - accuracy1000: 0.4808 - val_loss: 3.5966 - val_accuracy1000: 0.3774 - 27s/epoch - 16ms/step
Epoch 12/50
1686/1686 - 28s - loss: 3.0641 - accuracy1000: 0.4807 - val_loss: 3.6383 - val_accuracy1000: 0.3710 - 28s/epoch - 16ms/step
Epoch 13/50
1686/1686 - 27s - loss: 3.0631 - accuracy1000: 0.4830 - val_loss: 3.5906 - val_accuracy1000: 0.3814 - 27s/epoch - 16ms/step
Epoch 14/50
1686/1686 - 27s - loss: 3.0570 - accuracy1000: 0.4820 - val_loss: 3.5583 - val_accuracy1000: 0.3636 - 27s/epoch - 16ms/step
Epoch 15/50
1686/1686 - 27s - loss: 3.0510 - accuracy1000: 0.4837 - val_loss: 3.5637 - val_accuracy1000: 0.3733 - 27s/epoch - 16ms/step
testing model: results/AAL/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
10110/10110 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.242243
{'0': {'precision': 0.3478313112837424, 'recall': 0.17791628903433762, 'f1-score': 0.23541659943330343, 'support': 1025027}, '1': {'precision': 0.19063772834825726, 'recall': 0.6690720890967952, 'f1-score': 0.2967289208019032, 'support': 516472}, '2': {'precision': 0.40485584943522285, 'recall': 0.0971563211230248, 'f1-score': 0.15670657893621562, 'support': 1046602}, 'accuracy': 0.24327103154011379, 'macro avg': {'precision': 0.3144416296890742, 'recall': 0.31471489975138583, 'f1-score': 0.22961736639047411, 'support': 2588101}, 'weighted avg': {'precision': 0.33952248234412985, 'recall': 0.24327103154011379, 'f1-score': 0.21582232253668712, 'support': 2588101}}
[[182369 744607  98051]
 [119489 345557  51426]
 [222445 722473 101684]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.150288
{'0': {'precision': 0.3239520711521041, 'recall': 0.10768988597944071, 'f1-score': 0.1616449051292851, 'support': 146114}, '1': {'precision': 0.34235544459896455, 'recall': 0.7142237944100334, 'f1-score': 0.4628491563164703, 'support': 143042}, '2': {'precision': 0.3664534588146274, 'recall': 0.2176431761368424, 'f1-score': 0.2730921217834911, 'support': 142412}, 'accuracy': 0.34500704408111815, 'macro avg': {'precision': 0.34425365818856535, 'recall': 0.3465189521754388, 'f1-score': 0.2991953944097488, 'support': 431568}, 'weighted avg': {'precision': 0.344076739719702, 'recall': 0.34500704408111815, 'f1-score': 0.2982543838591171, 'support': 431568}}
[[ 15735 100551  29828]
 [ 17120 102164  23758]
 [ 15717  95700  30995]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.135051
{'0': {'precision': 0.4154994822606137, 'recall': 0.13250373666098925, 'f1-score': 0.2009303306231634, 'support': 57538}, '1': {'precision': 0.3605196060849428, 'recall': 0.7864237847399395, 'f1-score': 0.49439439707022376, 'support': 58794}, '2': {'precision': 0.4066658780386822, 'recall': 0.2145844386879311, 'f1-score': 0.28093078368881264, 'support': 64082}, 'accuracy': 0.37476027359295844, 'macro avg': {'precision': 0.39422832212807957, 'recall': 0.37783732002961995, 'f1-score': 0.3254185037940666, 'support': 180414}, 'weighted avg': {'precision': 0.39444478658498866, 'recall': 0.37476027359295844, 'f1-score': 0.324981210022996, 'support': 180414}}
[[ 7624 38158 11756]
 [ 4250 46237  8307]
 [ 6475 43856 13751]]
training model: results/AAL/W10/deepOF_L1/h10
Epoch 1/50
1686/1686 - 31s - loss: 2.9636 - accuracy10: 0.4653 - val_loss: 3.9733 - val_accuracy10: 0.6945 - 31s/epoch - 18ms/step
Epoch 2/50
1686/1686 - 29s - loss: 2.8843 - accuracy10: 0.4983 - val_loss: 3.8173 - val_accuracy10: 0.6963 - 29s/epoch - 17ms/step
Epoch 3/50
1686/1686 - 29s - loss: 2.8358 - accuracy10: 0.5148 - val_loss: 3.7793 - val_accuracy10: 0.6991 - 29s/epoch - 17ms/step
Epoch 4/50
1686/1686 - 26s - loss: 2.8021 - accuracy10: 0.5223 - val_loss: 3.7344 - val_accuracy10: 0.6958 - 26s/epoch - 16ms/step
Epoch 5/50
1686/1686 - 26s - loss: 2.7783 - accuracy10: 0.5287 - val_loss: 3.7522 - val_accuracy10: 0.6961 - 26s/epoch - 15ms/step
Epoch 6/50
1686/1686 - 26s - loss: 2.7595 - accuracy10: 0.5333 - val_loss: 3.7376 - val_accuracy10: 0.6993 - 26s/epoch - 15ms/step
Epoch 7/50
1686/1686 - 29s - loss: 2.7408 - accuracy10: 0.5365 - val_loss: 3.7484 - val_accuracy10: 0.7003 - 29s/epoch - 17ms/step
Epoch 8/50
1686/1686 - 28s - loss: 2.7247 - accuracy10: 0.5419 - val_loss: 3.7466 - val_accuracy10: 0.7010 - 28s/epoch - 17ms/step
Epoch 9/50
1686/1686 - 24s - loss: 2.7073 - accuracy10: 0.5452 - val_loss: 3.7841 - val_accuracy10: 0.7052 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 23s - loss: 2.6934 - accuracy10: 0.5473 - val_loss: 3.8290 - val_accuracy10: 0.7045 - 23s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 23s - loss: 2.6803 - accuracy10: 0.5502 - val_loss: 3.7885 - val_accuracy10: 0.6967 - 23s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 23s - loss: 2.6643 - accuracy10: 0.5504 - val_loss: 3.8239 - val_accuracy10: 0.6980 - 23s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 23s - loss: 2.6501 - accuracy10: 0.5526 - val_loss: 3.7808 - val_accuracy10: 0.6955 - 23s/epoch - 14ms/step
Epoch 14/50
1686/1686 - 24s - loss: 2.6326 - accuracy10: 0.5541 - val_loss: 3.7696 - val_accuracy10: 0.6911 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h10
Evaluating performance on  test set...
10110/10110 - 59s - 59s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79980767
{'0': {'precision': 0.3084740357826189, 'recall': 0.3794908325074331, 'f1-score': 0.3403169959449701, 'support': 290592}, '1': {'precision': 0.8296171254223584, 'recall': 0.7583797766724596, 'f1-score': 0.7924006016277344, 'support': 2002440}, '2': {'precision': 0.28744667078221187, 'recall': 0.38977984437274626, 'f1-score': 0.33088166542716707, 'support': 295064}, 'accuracy': 0.6738146498429733, 'macro avg': {'precision': 0.47517927732906307, 'recall': 0.5092168178508797, 'f1-score': 0.48786642099995725, 'support': 2588096}, 'weighted avg': {'precision': 0.7092912195314907, 'recall': 0.6738146498429733, 'f1-score': 0.6890236393614003, 'support': 2588096}}
[[ 110277  154137   26178]
 [ 224909 1518610  258921]
 [  22306  157748  115010]]
Evaluating performance on  train set...
1686/1686 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7430295
{'0': {'precision': 0.3087794173897288, 'recall': 0.3598864356273024, 'f1-score': 0.3323798379057773, 'support': 42619}, '1': {'precision': 0.8544772013059269, 'recall': 0.8072173641834837, 'f1-score': 0.8301752301752301, 'support': 346276}, '2': {'precision': 0.3022877905384433, 'recall': 0.387991844578285, 'f1-score': 0.33981937602627255, 'support': 42671}, 'accuracy': 0.7215906721104072, 'macro avg': {'precision': 0.488514803078033, 'recall': 0.518365214796357, 'f1-score': 0.5007914813690933, 'support': 431566}, 'weighted avg': {'precision': 0.7459895813368288, 'recall': 0.7215906721104072, 'f1-score': 0.7325319578240208, 'support': 431566}}
[[ 15338  24207   3074]
 [ 31617 279520  35139]
 [  2718  23397  16556]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7830102
{'0': {'precision': 0.3283165499124343, 'recall': 0.2826383981154299, 'f1-score': 0.30376990657518294, 'support': 21225}, '1': {'precision': 0.8021395328947837, 'recall': 0.8202144017956697, 'f1-score': 0.8110762800417972, 'support': 137219}, '2': {'precision': 0.3189959232284366, 'recall': 0.3169776968593537, 'f1-score': 0.3179836076801899, 'support': 21970}, 'accuracy': 0.695688804638221, 'macro avg': {'precision': 0.48315066867855155, 'recall': 0.4732768322568177, 'f1-score': 0.47760993143239, 'support': 180414}, 'weighted avg': {'precision': 0.687561074913862, 'recall': 0.695688804638221, 'f1-score': 0.6913470805971123, 'support': 180414}}
[[  5999  13917   1309]
 [ 11112 112549  13558]
 [  1161  13845   6964]]
training model: results/AAL/W10/deepOF_L1/h20
Epoch 1/50
1686/1686 - 27s - loss: 2.9855 - accuracy20: 0.4637 - val_loss: 3.9014 - val_accuracy20: 0.6518 - 27s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 25s - loss: 2.9090 - accuracy20: 0.4949 - val_loss: 3.7622 - val_accuracy20: 0.6549 - 25s/epoch - 15ms/step
Epoch 3/50
1686/1686 - 25s - loss: 2.8604 - accuracy20: 0.5035 - val_loss: 3.6879 - val_accuracy20: 0.6642 - 25s/epoch - 15ms/step
Epoch 4/50
1686/1686 - 25s - loss: 2.8282 - accuracy20: 0.5167 - val_loss: 3.6941 - val_accuracy20: 0.6691 - 25s/epoch - 15ms/step
Epoch 5/50
1686/1686 - 25s - loss: 2.8041 - accuracy20: 0.5233 - val_loss: 3.6759 - val_accuracy20: 0.6692 - 25s/epoch - 15ms/step
Epoch 6/50
1686/1686 - 24s - loss: 2.7865 - accuracy20: 0.5300 - val_loss: 3.6841 - val_accuracy20: 0.6679 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 2.7691 - accuracy20: 0.5338 - val_loss: 3.6646 - val_accuracy20: 0.6695 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 24s - loss: 2.7540 - accuracy20: 0.5375 - val_loss: 3.6783 - val_accuracy20: 0.6640 - 24s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 25s - loss: 2.7412 - accuracy20: 0.5384 - val_loss: 3.6968 - val_accuracy20: 0.6666 - 25s/epoch - 15ms/step
Epoch 10/50
1686/1686 - 25s - loss: 2.7274 - accuracy20: 0.5436 - val_loss: 3.7051 - val_accuracy20: 0.6664 - 25s/epoch - 15ms/step
Epoch 11/50
1686/1686 - 25s - loss: 2.7147 - accuracy20: 0.5464 - val_loss: 3.7482 - val_accuracy20: 0.6698 - 25s/epoch - 15ms/step
Epoch 12/50
1686/1686 - 25s - loss: 2.7018 - accuracy20: 0.5467 - val_loss: 3.7145 - val_accuracy20: 0.6660 - 25s/epoch - 15ms/step
Epoch 13/50
1686/1686 - 25s - loss: 2.6874 - accuracy20: 0.5498 - val_loss: 3.7233 - val_accuracy20: 0.6604 - 25s/epoch - 15ms/step
Epoch 14/50
1686/1686 - 25s - loss: 2.6723 - accuracy20: 0.5547 - val_loss: 3.7535 - val_accuracy20: 0.6623 - 25s/epoch - 15ms/step
Epoch 15/50
1686/1686 - 23s - loss: 2.6587 - accuracy20: 0.5540 - val_loss: 3.7412 - val_accuracy20: 0.6534 - 23s/epoch - 14ms/step
Epoch 16/50
1686/1686 - 24s - loss: 2.6454 - accuracy20: 0.5562 - val_loss: 3.7475 - val_accuracy20: 0.6507 - 24s/epoch - 14ms/step
Epoch 17/50
1686/1686 - 24s - loss: 2.6318 - accuracy20: 0.5575 - val_loss: 3.7449 - val_accuracy20: 0.6525 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h20
Evaluating performance on  test set...
10110/10110 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82056105
{'0': {'precision': 0.41882536642492485, 'recall': 0.34541892092428966, 'f1-score': 0.37859676158786126, 'support': 397581}, '1': {'precision': 0.7579984892675046, 'recall': 0.807102638159449, 'f1-score': 0.7817802564802417, 'support': 1790377}, '2': {'precision': 0.3990244123016748, 'recall': 0.35285326562335995, 'f1-score': 0.3745212049189895, 'support': 400138}, 'accuracy': 0.6659490219837286, 'macro avg': {'precision': 0.5252827559980348, 'recall': 0.5017916082356996, 'f1-score': 0.5116327409956974, 'support': 2588096}, 'weighted avg': {'precision': 0.6503950778941132, 'recall': 0.6659490219837286, 'f1-score': 0.6568784292464669, 'support': 2588096}}
[[ 137332  227930   32319]
 [ 165030 1445018  180329]
 [  25536  233412  141190]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76300955
{'0': {'precision': 0.40752509416889376, 'recall': 0.3338907949862933, 'f1-score': 0.3670514205568507, 'support': 58001}, '1': {'precision': 0.792346281749814, 'recall': 0.840311423619143, 'f1-score': 0.8156242791455857, 'support': 315583}, '2': {'precision': 0.4126990558774667, 'recall': 0.35131592563209274, 'f1-score': 0.37954164337618784, 'support': 57982}, 'accuracy': 0.7065524160846777, 'macro avg': {'precision': 0.5375234772653915, 'recall': 0.5085060480791764, 'f1-score': 0.5207391143595413, 'support': 431566}, 'weighted avg': {'precision': 0.6896210458614184, 'recall': 0.7065524160846777, 'f1-score': 0.696748793685224, 'support': 431566}}
[[ 19366  35052   3583]
 [ 24990 265188  25405]
 [  3165  34447  20370]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82169205
{'0': {'precision': 0.4295577746077033, 'recall': 0.26871318936284133, 'f1-score': 0.33061045234958275, 'support': 28015}, '1': {'precision': 0.7326781361302152, 'recall': 0.8472461413484972, 'f1-score': 0.7858081966780812, 'support': 123100}, '2': {'precision': 0.43203505355404087, 'recall': 0.3028772313048227, 'f1-score': 0.3561066634563293, 'support': 29299}, 'accuracy': 0.6690057312625406, 'macro avg': {'precision': 0.5314236547639865, 'recall': 0.4729455206720537, 'f1-score': 0.49084177082799774, 'support': 180414}, 'weighted avg': {'precision': 0.6367850313575673, 'recall': 0.6690057312625406, 'f1-score': 0.6453413258741137, 'support': 180414}}
[[  7528  18959   1528]
 [  8666 104296  10138]
 [  1331  19094   8874]]
training model: results/AAL/W10/deepOF_L1/h30
Epoch 1/50
1686/1686 - 27s - loss: 3.0184 - accuracy30: 0.4603 - val_loss: 3.8496 - val_accuracy30: 0.6094 - 27s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 2.9472 - accuracy30: 0.4855 - val_loss: 3.6844 - val_accuracy30: 0.6171 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 24s - loss: 2.9019 - accuracy30: 0.5000 - val_loss: 3.6476 - val_accuracy30: 0.6241 - 24s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 24s - loss: 2.8722 - accuracy30: 0.5070 - val_loss: 3.6366 - val_accuracy30: 0.6309 - 24s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 25s - loss: 2.8485 - accuracy30: 0.5106 - val_loss: 3.6318 - val_accuracy30: 0.6267 - 25s/epoch - 15ms/step
Epoch 6/50
1686/1686 - 24s - loss: 2.8301 - accuracy30: 0.5138 - val_loss: 3.6576 - val_accuracy30: 0.6287 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 27s - loss: 2.8139 - accuracy30: 0.5183 - val_loss: 3.6792 - val_accuracy30: 0.6307 - 27s/epoch - 16ms/step
Epoch 8/50
1686/1686 - 27s - loss: 2.7997 - accuracy30: 0.5208 - val_loss: 3.6739 - val_accuracy30: 0.6300 - 27s/epoch - 16ms/step
Epoch 9/50
1686/1686 - 24s - loss: 2.7852 - accuracy30: 0.5240 - val_loss: 3.6977 - val_accuracy30: 0.6300 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 2.7718 - accuracy30: 0.5271 - val_loss: 3.7139 - val_accuracy30: 0.6292 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 2.7602 - accuracy30: 0.5299 - val_loss: 3.7071 - val_accuracy30: 0.6287 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 24s - loss: 2.7460 - accuracy30: 0.5330 - val_loss: 3.7364 - val_accuracy30: 0.6281 - 24s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 2.7370 - accuracy30: 0.5345 - val_loss: 3.7491 - val_accuracy30: 0.6283 - 24s/epoch - 14ms/step
Epoch 14/50
1686/1686 - 24s - loss: 2.7240 - accuracy30: 0.5365 - val_loss: 3.7592 - val_accuracy30: 0.6283 - 24s/epoch - 14ms/step
Epoch 15/50
1686/1686 - 24s - loss: 2.7119 - accuracy30: 0.5388 - val_loss: 3.7582 - val_accuracy30: 0.6262 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h30
Evaluating performance on  test set...
10110/10110 - 50s - 50s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8808433
{'0': {'precision': 0.46878547471620224, 'recall': 0.30649548356625367, 'f1-score': 0.3706543524047999, 'support': 474268}, '1': {'precision': 0.6919624157192278, 'recall': 0.7956330057435681, 'f1-score': 0.7401853067534983, 'support': 1636091}, '2': {'precision': 0.4114273041602403, 'recall': 0.34172777071903576, 'f1-score': 0.37335242144164765, 'support': 477737}, 'accuracy': 0.6222122363312643, 'macro avg': {'precision': 0.5240583981985568, 'recall': 0.4812854200096192, 'f1-score': 0.4947306935333153, 'support': 2588096}, 'weighted avg': {'precision': 0.5992812771345389, 'recall': 0.6222122363312643, 'f1-score': 0.6047551106605882, 'support': 2588096}}
[[ 145361  290352   38555]
 [ 139370 1301728  194993]
 [  25349  289132  163256]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8228018
{'0': {'precision': 0.4555805580558056, 'recall': 0.29140998330358686, 'f1-score': 0.3554548965904702, 'support': 69476}, '1': {'precision': 0.7346453632537218, 'recall': 0.832730551315021, 'f1-score': 0.7806189091933564, 'support': 292809}, '2': {'precision': 0.4209477934918422, 'recall': 0.33553210837026026, 'f1-score': 0.3734177215189874, 'support': 69281}, 'accuracy': 0.665768387685777, 'macro avg': {'precision': 0.5370579049337899, 'recall': 0.48655754766295606, 'f1-score': 0.5031638424342714, 'support': 431566}, 'weighted avg': {'precision': 0.6393607770337619, 'recall': 0.665768387685777, 'f1-score': 0.6468039181540575, 'support': 431566}}
[[ 20246  45103   4127]
 [ 21128 243831  27850]
 [  3066  42969  23246]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87802476
{'0': {'precision': 0.4711168164313222, 'recall': 0.2335100742311771, 'f1-score': 0.312251843448667, 'support': 33005}, '1': {'precision': 0.6710756949675131, 'recall': 0.8440778813716896, 'f1-score': 0.7476999819606428, 'support': 112941}, '2': {'precision': 0.4524502227475225, 'recall': 0.2887605895323198, 'f1-score': 0.3525307264548577, 'support': 34468}, 'accuracy': 0.6262873169487956, 'macro avg': {'precision': 0.5315475780487859, 'recall': 0.45544951504506215, 'f1-score': 0.47082751728805583, 'support': 180414}, 'weighted avg': {'precision': 0.5927268663701447, 'recall': 0.6262873169487956, 'f1-score': 0.592542068991798, 'support': 180414}}
[[ 7707 23555  1743]
 [ 7308 95331 10302]
 [ 1344 23171  9953]]
training model: results/AAL/W10/deepOF_L1/h50
Epoch 1/50
1686/1686 - 28s - loss: 3.0798 - accuracy50: 0.4565 - val_loss: 3.7485 - val_accuracy50: 0.5460 - 28s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 3.0198 - accuracy50: 0.4768 - val_loss: 3.6407 - val_accuracy50: 0.5564 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 24s - loss: 2.9796 - accuracy50: 0.4892 - val_loss: 3.6149 - val_accuracy50: 0.5633 - 24s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 24s - loss: 2.9573 - accuracy50: 0.4908 - val_loss: 3.5954 - val_accuracy50: 0.5636 - 24s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 24s - loss: 2.9368 - accuracy50: 0.4976 - val_loss: 3.6067 - val_accuracy50: 0.5637 - 24s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 24s - loss: 2.9213 - accuracy50: 0.5009 - val_loss: 3.6180 - val_accuracy50: 0.5641 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 2.9071 - accuracy50: 0.5055 - val_loss: 3.6393 - val_accuracy50: 0.5668 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 23s - loss: 2.8937 - accuracy50: 0.5082 - val_loss: 3.6658 - val_accuracy50: 0.5678 - 23s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 23s - loss: 2.8792 - accuracy50: 0.5121 - val_loss: 3.6808 - val_accuracy50: 0.5662 - 23s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 2.8681 - accuracy50: 0.5144 - val_loss: 3.6969 - val_accuracy50: 0.5690 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 2.8569 - accuracy50: 0.5165 - val_loss: 3.7227 - val_accuracy50: 0.5685 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 24s - loss: 2.8446 - accuracy50: 0.5188 - val_loss: 3.7517 - val_accuracy50: 0.5697 - 24s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 2.8353 - accuracy50: 0.5200 - val_loss: 3.7812 - val_accuracy50: 0.5703 - 24s/epoch - 14ms/step
Epoch 14/50
1686/1686 - 24s - loss: 2.8233 - accuracy50: 0.5213 - val_loss: 3.8011 - val_accuracy50: 0.5708 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h50
Evaluating performance on  test set...
10110/10110 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95761544
{'0': {'precision': 0.5533646732871295, 'recall': 0.22802866402860322, 'f1-score': 0.32296924261923327, 'support': 592101}, '1': {'precision': 0.5898608076834366, 'recall': 0.8140877391645844, 'f1-score': 0.6840684474183749, 'support': 1397939}, '2': {'precision': 0.44611582601986693, 'recall': 0.3093874152253301, 'f1-score': 0.3653792989052306, 'support': 598056}, 'accuracy': 0.5633840475778332, 'macro avg': {'precision': 0.5297804356634778, 'recall': 0.45050127280617264, 'f1-score': 0.45747232964761286, 'support': 2588096}, 'weighted avg': {'precision': 0.5482947504637756, 'recall': 0.5633840475778332, 'f1-score': 0.5278141362707384, 'support': 2588096}}
[[ 135016  402331   54754]
 [  84919 1138045  174975]
 [  24056  388969  185031]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9013687
{'0': {'precision': 0.5244053008478065, 'recall': 0.21816749803097926, 'f1-score': 0.30814000354684257, 'support': 87607}, '1': {'precision': 0.6424435334112524, 'recall': 0.8435901730659116, 'f1-score': 0.7294034437755231, 'support': 256723}, '2': {'precision': 0.4531258079528414, 'recall': 0.30135494520610756, 'f1-score': 0.3619753120417478, 'support': 87236}, 'accuracy': 0.6070241863353462, 'macro avg': {'precision': 0.5399915474039667, 'recall': 0.4543708721009994, 'f1-score': 0.4665062531213711, 'support': 431566}, 'weighted avg': {'precision': 0.5802136623410667, 'recall': 0.6070241863353462, 'f1-score': 0.5696165590162009, 'support': 431566}}
[[ 19113  62540   5954]
 [ 14380 216569  25774]
 [  2954  57993  26289]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9555425
{'0': {'precision': 0.5435442269761797, 'recall': 0.17640396878154468, 'f1-score': 0.2663618282867712, 'support': 40617}, '1': {'precision': 0.5764089483299438, 'recall': 0.8590995026920389, 'f1-score': 0.6899195062278497, 'support': 97324}, '2': {'precision': 0.4890201560174956, 'recall': 0.2553386857533021, 'f1-score': 0.3354988399071926, 'support': 42473}, 'accuracy': 0.5632656002305808, 'macro avg': {'precision': 0.5363244437745397, 'recall': 0.4302807190756286, 'f1-score': 0.43059339147393777, 'support': 180414}, 'weighted avg': {'precision': 0.5484370028982564, 'recall': 0.5632656002305808, 'f1-score': 0.5111254483078986, 'support': 180414}}
[[ 7165 31127  2325]
 [ 4706 83611  9007]
 [ 1311 30317 10845]]
training model: results/AAL/W10/deepOF_L1/h100
Epoch 1/50
1686/1686 - 26s - loss: 3.1696 - accuracy100: 0.4438 - val_loss: 3.7035 - val_accuracy100: 0.4220 - 26s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 3.1391 - accuracy100: 0.4572 - val_loss: 3.6038 - val_accuracy100: 0.4377 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 25s - loss: 3.1197 - accuracy100: 0.4664 - val_loss: 3.5695 - val_accuracy100: 0.4444 - 25s/epoch - 15ms/step
Epoch 4/50
1686/1686 - 24s - loss: 3.1005 - accuracy100: 0.4710 - val_loss: 3.5786 - val_accuracy100: 0.4479 - 24s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 24s - loss: 3.0854 - accuracy100: 0.4751 - val_loss: 3.5983 - val_accuracy100: 0.4486 - 24s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 24s - loss: 3.0722 - accuracy100: 0.4805 - val_loss: 3.6152 - val_accuracy100: 0.4484 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 3.0589 - accuracy100: 0.4840 - val_loss: 3.6467 - val_accuracy100: 0.4505 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 24s - loss: 3.0504 - accuracy100: 0.4853 - val_loss: 3.6536 - val_accuracy100: 0.4508 - 24s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 24s - loss: 3.0398 - accuracy100: 0.4873 - val_loss: 3.6773 - val_accuracy100: 0.4520 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 3.0293 - accuracy100: 0.4895 - val_loss: 3.7086 - val_accuracy100: 0.4517 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 3.0265 - accuracy100: 0.4909 - val_loss: 3.7096 - val_accuracy100: 0.4526 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 24s - loss: 3.0138 - accuracy100: 0.4932 - val_loss: 3.7575 - val_accuracy100: 0.4536 - 24s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 3.0021 - accuracy100: 0.4963 - val_loss: 3.7672 - val_accuracy100: 0.4546 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h100
Evaluating performance on  test set...
10110/10110 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0835278
{'0': {'precision': 0.5471932988191496, 'recall': 0.1808879408039464, 'f1-score': 0.27189457345818596, 'support': 780052}, '1': {'precision': 0.42179704247647787, 'recall': 0.8303163853388942, 'f1-score': 0.5594141678789614, 'support': 1014712}, '2': {'precision': 0.5024988805375824, 'recall': 0.21076421977179793, 'f1-score': 0.29696975617206933, 'support': 793332}, 'accuracy': 0.4446666584237988, 'macro avg': {'precision': 0.49049640727773663, 'recall': 0.4073228486382128, 'f1-score': 0.3760928325030723, 'support': 2588096}, 'weighted avg': {'precision': 0.484329093507547, 'recall': 0.4446666584237988, 'f1-score': 0.3923083940995626, 'support': 2588096}}
[[141102 574253  64697]
 [ 71334 842532 100846]
 [ 45429 580697 167206]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0287099
{'0': {'precision': 0.5299047307072858, 'recall': 0.1646731477239952, 'f1-score': 0.2512636313626509, 'support': 117882}, '1': {'precision': 0.4856962225383278, 'recall': 0.8578353000888213, 'f1-score': 0.6202271517953799, 'support': 197025}, '2': {'precision': 0.5026412200732726, 'recall': 0.2022818642367927, 'f1-score': 0.2884717646555465, 'support': 116659}, 'accuracy': 0.49129217778972395, 'macro avg': {'precision': 0.5060807244396287, 'recall': 0.4082634373498697, 'f1-score': 0.3866541826045258, 'support': 431566}, 'weighted avg': {'precision': 0.5023522469410895, 'recall': 0.49129217778972395, 'f1-score': 0.42976634296429317, 'support': 431566}}
[[ 19412  90961   7509]
 [ 12169 169015  15841]
 [  5052  88009  23598]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0790468
{'0': {'precision': 0.5414036669672377, 'recall': 0.13702407668023278, 'f1-score': 0.21869782971619367, 'support': 52582}, '1': {'precision': 0.42467327685276746, 'recall': 0.8761337634052877, 'f1-score': 0.5720611662631517, 'support': 72546}, '2': {'precision': 0.5332606950338341, 'recall': 0.1681980971674565, 'f1-score': 0.2557340080303614, 'support': 55286}, 'accuracy': 0.44377930759253714, 'macro avg': {'precision': 0.49977921295127975, 'recall': 0.3937853124176591, 'f1-score': 0.3488310013365689, 'support': 180414}, 'weighted avg': {'precision': 0.4919700574493815, 'recall': 0.44377930759253714, 'f1-score': 0.37213757811383846, 'support': 180414}}
[[ 7205 42311  3066]
 [ 3913 63560  5073]
 [ 2190 43797  9299]]
training model: results/AAL/W10/deepOF_L1/h200
Epoch 1/50
1686/1686 - 26s - loss: 3.2320 - accuracy200: 0.4129 - val_loss: 3.5524 - val_accuracy200: 0.3103 - 26s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 3.2197 - accuracy200: 0.4187 - val_loss: 3.4998 - val_accuracy200: 0.3092 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 23s - loss: 3.2090 - accuracy200: 0.4228 - val_loss: 3.4849 - val_accuracy200: 0.3120 - 23s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 23s - loss: 3.1965 - accuracy200: 0.4279 - val_loss: 3.4959 - val_accuracy200: 0.3143 - 23s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 23s - loss: 3.1847 - accuracy200: 0.4342 - val_loss: 3.5122 - val_accuracy200: 0.3176 - 23s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 23s - loss: 3.1739 - accuracy200: 0.4384 - val_loss: 3.5228 - val_accuracy200: 0.3223 - 23s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 3.1632 - accuracy200: 0.4427 - val_loss: 3.5389 - val_accuracy200: 0.3273 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 24s - loss: 3.1555 - accuracy200: 0.4449 - val_loss: 3.5439 - val_accuracy200: 0.3297 - 24s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 24s - loss: 3.1476 - accuracy200: 0.4480 - val_loss: 3.5717 - val_accuracy200: 0.3301 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 3.1414 - accuracy200: 0.4503 - val_loss: 3.5690 - val_accuracy200: 0.3391 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 3.1361 - accuracy200: 0.4525 - val_loss: 3.5772 - val_accuracy200: 0.3436 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 24s - loss: 3.1287 - accuracy200: 0.4546 - val_loss: 3.5869 - val_accuracy200: 0.3419 - 24s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 25s - loss: 3.1237 - accuracy200: 0.4566 - val_loss: 3.6016 - val_accuracy200: 0.3476 - 25s/epoch - 15ms/step
testing model: results/AAL/W10/deepOF_L1/h200
Evaluating performance on  test set...
10110/10110 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1705941
{'0': {'precision': 0.5515976688102894, 'recall': 0.04703614251364247, 'f1-score': 0.08668079239618624, 'support': 933665}, '1': {'precision': 0.2760163254547776, 'recall': 0.9509983241832699, 'f1-score': 0.4278531850164117, 'support': 704731}, '2': {'precision': 0.5480527560034839, 'recall': 0.04637990944508792, 'f1-score': 0.08552234314172823, 'support': 949700}, 'accuracy': 0.2929416064937313, 'macro avg': {'precision': 0.4585555834228503, 'recall': 0.3481381253806668, 'f1-score': 0.2000187735181087, 'support': 2588096}, 'weighted avg': {'precision': 0.4752568687097922, 'recall': 0.2929416064937313, 'f1-score': 0.1791559487144547, 'support': 2588096}}
[[ 43916 870303  19446]
 [ 17656 670198  16877]
 [ 18044 887609  44047]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269851
{'0': {'precision': 0.5368319268635724, 'recall': 0.04233856990335686, 'f1-score': 0.07848706447840226, 'support': 144242}, '1': {'precision': 0.3414251674552189, 'recall': 0.9585305045981827, 'f1-score': 0.5035039964500051, 'support': 145601}, '2': {'precision': 0.5438550420168067, 'recall': 0.043839038123663764, 'f1-score': 0.08113773041587494, 'support': 141723}, 'accuracy': 0.35193458242771675, 'macro avg': {'precision': 0.47403737877853264, 'recall': 0.34823603754173443, 'f1-score': 0.2210429304480941, 'support': 431566}, 'weighted avg': {'precision': 0.4732122658435804, 'recall': 0.35193458242771675, 'f1-score': 0.2227490096748584, 'support': 431566}}
[[  6107 135734   2401]
 [  3228 139563   2810]
 [  2041 133469   6213]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1582991
{'0': {'precision': 0.5359956533550666, 'recall': 0.03208234414127289, 'f1-score': 0.060540971785391, 'support': 61498}, '1': {'precision': 0.30203937912363843, 'recall': 0.9680851063829787, 'f1-score': 0.4604270334244068, 'support': 54050}, '2': {'precision': 0.5560961648540355, 'recall': 0.02995405913729843, 'f1-score': 0.056846108835576364, 'support': 64866}, 'accuracy': 0.3117330140676444, 'macro avg': {'precision': 0.46471039911091355, 'recall': 0.34337383655385006, 'f1-score': 0.1926047046817914, 'support': 180414}, 'weighted avg': {'precision': 0.47313192413606714, 'recall': 0.3117330140676444, 'f1-score': 0.1790138766125448, 'support': 180414}}
[[ 1973 58729   796]
 [  970 52325   755]
 [  738 62185  1943]]
training model: results/AAL/W10/deepOF_L1/h300
Epoch 1/50
1686/1686 - 27s - loss: 3.2591 - accuracy300: 0.3946 - val_loss: 3.4965 - val_accuracy300: 0.2937 - 27s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 3.2467 - accuracy300: 0.3995 - val_loss: 3.4346 - val_accuracy300: 0.2947 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 24s - loss: 3.2405 - accuracy300: 0.4016 - val_loss: 3.4197 - val_accuracy300: 0.2971 - 24s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 24s - loss: 3.2343 - accuracy300: 0.4044 - val_loss: 3.4314 - val_accuracy300: 0.2974 - 24s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 24s - loss: 3.2275 - accuracy300: 0.4077 - val_loss: 3.4413 - val_accuracy300: 0.3002 - 24s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 24s - loss: 3.2206 - accuracy300: 0.4117 - val_loss: 3.4591 - val_accuracy300: 0.3008 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 3.2135 - accuracy300: 0.4151 - val_loss: 3.4671 - val_accuracy300: 0.3006 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 24s - loss: 3.2085 - accuracy300: 0.4179 - val_loss: 3.4727 - val_accuracy300: 0.3036 - 24s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 24s - loss: 3.2033 - accuracy300: 0.4198 - val_loss: 3.4842 - val_accuracy300: 0.3063 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 3.1980 - accuracy300: 0.4228 - val_loss: 3.4849 - val_accuracy300: 0.3084 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 3.1936 - accuracy300: 0.4240 - val_loss: 3.4907 - val_accuracy300: 0.3104 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 24s - loss: 3.1890 - accuracy300: 0.4258 - val_loss: 3.4917 - val_accuracy300: 0.3146 - 24s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 3.1853 - accuracy300: 0.4278 - val_loss: 3.5039 - val_accuracy300: 0.3179 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h300
Evaluating performance on  test set...
10110/10110 - 50s - 50s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1690623
{'0': {'precision': 0.5243032859944144, 'recall': 0.03662236647684824, 'f1-score': 0.0684626456290905, 'support': 963728}, '1': {'precision': 0.25216817304762873, 'recall': 0.9595053278802549, 'f1-score': 0.3993760784167395, 'support': 646974}, '2': {'precision': 0.5139420633576147, 'recall': 0.031039683075607175, 'f1-score': 0.058543607635485086, 'support': 977394}, 'accuracy': 0.26521697804100003, 'macro avg': {'precision': 0.43013784079988593, 'recall': 0.34238912581090347, 'f1-score': 0.17546077722710504, 'support': 2588096}, 'weighted avg': {'precision': 0.4523618512866192, 'recall': 0.26521697804100003, 'f1-score': 0.147438687879314, 'support': 2588096}}
[[ 35294 911589  16845]
 [ 14352 620775  11847]
 [ 17670 929386  30338]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1319598
{'0': {'precision': 0.5167475440880578, 'recall': 0.029321101656783276, 'f1-score': 0.055493416035385636, 'support': 148903}, '1': {'precision': 0.31892443592966946, 'recall': 0.9685210152998417, 'f1-score': 0.47984171786936286, 'support': 136472}, '2': {'precision': 0.5053032049804012, 'recall': 0.02998132579980984, 'f1-score': 0.05660413908888387, 'support': 146191}, 'accuracy': 0.3265433328853524, 'macro avg': {'precision': 0.44699172833270945, 'recall': 0.3426078142521449, 'f1-score': 0.19731309099787744, 'support': 431566}, 'weighted avg': {'precision': 0.4503141953185092, 'recall': 0.3265433328853524, 'f1-score': 0.19005925106826704, 'support': 431566}}
[[  4366 142285   2252]
 [  2257 132176   2039]
 [  1826 139982   4383]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1511443
{'0': {'precision': 0.5029873039581777, 'recall': 0.02162396455403583, 'f1-score': 0.041465291673079885, 'support': 62292}, '1': {'precision': 0.28957915258791717, 'recall': 0.975013475013475, 'f1-score': 0.4465368051239328, 'support': 51948}, '2': {'precision': 0.5383799080297135, 'recall': 0.022999969776649438, 'f1-score': 0.0441153026767728, 'support': 66174}, 'accuracy': 0.2966454931435476, 'macro avg': {'precision': 0.44364878819193604, 'recall': 0.3398791364480534, 'f1-score': 0.17737246649126182, 'support': 180414}, 'weighted avg': {'precision': 0.4545206857048687, 'recall': 0.2966454931435476, 'f1-score': 0.15907266587299387, 'support': 180414}}
[[ 1347 60234   711]
 [  704 50650   594]
 [  627 64025  1522]]
training model: results/AAL/W10/deepOF_L1/h500
Epoch 1/50
1686/1686 - 27s - loss: 3.2858 - accuracy500: 0.3738 - val_loss: 3.4869 - val_accuracy500: 0.3033 - 27s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 23s - loss: 3.2726 - accuracy500: 0.3758 - val_loss: 3.4405 - val_accuracy500: 0.3032 - 23s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 23s - loss: 3.2681 - accuracy500: 0.3764 - val_loss: 3.4231 - val_accuracy500: 0.3029 - 23s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 23s - loss: 3.2642 - accuracy500: 0.3785 - val_loss: 3.4372 - val_accuracy500: 0.3032 - 23s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 23s - loss: 3.2602 - accuracy500: 0.3811 - val_loss: 3.4513 - val_accuracy500: 0.3031 - 23s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 24s - loss: 3.2572 - accuracy500: 0.3838 - val_loss: 3.4589 - val_accuracy500: 0.3029 - 24s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 3.2536 - accuracy500: 0.3871 - val_loss: 3.4766 - val_accuracy500: 0.3031 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 25s - loss: 3.2511 - accuracy500: 0.3888 - val_loss: 3.4774 - val_accuracy500: 0.3031 - 25s/epoch - 15ms/step
Epoch 9/50
1686/1686 - 24s - loss: 3.2482 - accuracy500: 0.3912 - val_loss: 3.4839 - val_accuracy500: 0.3029 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 3.2455 - accuracy500: 0.3938 - val_loss: 3.4850 - val_accuracy500: 0.3029 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 23s - loss: 3.2432 - accuracy500: 0.3946 - val_loss: 3.4975 - val_accuracy500: 0.3030 - 23s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 23s - loss: 3.2412 - accuracy500: 0.3967 - val_loss: 3.4987 - val_accuracy500: 0.3030 - 23s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 3.2393 - accuracy500: 0.3977 - val_loss: 3.5026 - val_accuracy500: 0.3030 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h500
Evaluating performance on  test set...
10110/10110 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1755162
{'0': {'precision': 0.4585416307533184, 'recall': 0.005650671654552773, 'f1-score': 0.011163770626482687, 'support': 941481}, '1': {'precision': 0.2643133585378034, 'recall': 0.9923917697830792, 'f1-score': 0.4174446268188776, 'support': 684259}, '2': {'precision': 0.4707717347077173, 'recall': 0.003606773377003936, 'f1-score': 0.0071587010391563, 'support': 962356}, 'accuracy': 0.2657722124681619, 'macro avg': {'precision': 0.3978755746662797, 'recall': 0.3338830716048786, 'f1-score': 0.14525569949483885, 'support': 2588096}, 'weighted avg': {'precision': 0.4117378300454712, 'recall': 0.2657722124681619, 'f1-score': 0.11708991464493133, 'support': 2588096}}
[[  5320 934224   1937]
 [  3241 679053   1965]
 [  3041 955844   3471]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.139279
{'0': {'precision': 0.4630122405534859, 'recall': 0.0058905973878247446, 'f1-score': 0.011633193378439816, 'support': 147693}, '1': {'precision': 0.3197084754939254, 'recall': 0.9925376919008599, 'f1-score': 0.48363290399676623, 'support': 138027}, '2': {'precision': 0.4479254868755292, 'recall': 0.0036271135307104755, 'f1-score': 0.0071959572051391914, 'support': 145846}, 'accuracy': 0.3206832790349564, 'macro avg': {'precision': 0.41021540097431347, 'recall': 0.33401846760646503, 'f1-score': 0.16748735152678174, 'support': 431566}, 'weighted avg': {'precision': 0.4120811397327742, 'recall': 0.3206832790349564, 'f1-score': 0.1610924902428465, 'support': 431566}}
[[   870 146566    257]
 [   635 136997    395]
 [   374 144943    529]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1491104
{'0': {'precision': 0.43666666666666665, 'recall': 0.004330721676749644, 'f1-score': 0.008576385479066417, 'support': 60498}, '1': {'precision': 0.3023600463540738, 'recall': 0.9945936039585815, 'f1-score': 0.46374111846462135, 'support': 54565}, '2': {'precision': 0.4815950920245399, 'recall': 0.002402411592783584, 'f1-score': 0.004780973552385158, 'support': 65351}, 'accuracy': 0.3031305774496436, 'macro avg': {'precision': 0.4068739350150934, 'recall': 0.3337755790760382, 'f1-score': 0.1590328258320243, 'support': 180414}, 'weighted avg': {'precision': 0.4123208663862325, 'recall': 0.3031305774496436, 'f1-score': 0.14486309100378325, 'support': 180414}}
[[  262 60159    77]
 [  203 54270    92]
 [  135 65059   157]]
training model: results/AAL/W10/deepOF_L1/h1000
Epoch 1/50
1686/1686 - 26s - loss: 3.2316 - accuracy1000: 0.4101 - val_loss: 3.3223 - val_accuracy1000: 0.3245 - 26s/epoch - 16ms/step
Epoch 2/50
1686/1686 - 24s - loss: 3.2226 - accuracy1000: 0.4124 - val_loss: 3.3229 - val_accuracy1000: 0.3259 - 24s/epoch - 14ms/step
Epoch 3/50
1686/1686 - 24s - loss: 3.2346 - accuracy1000: 0.4037 - val_loss: 3.3165 - val_accuracy1000: 0.3265 - 24s/epoch - 14ms/step
Epoch 4/50
1686/1686 - 24s - loss: 3.2380 - accuracy1000: 0.3989 - val_loss: 3.3123 - val_accuracy1000: 0.3281 - 24s/epoch - 14ms/step
Epoch 5/50
1686/1686 - 24s - loss: 3.2368 - accuracy1000: 0.4004 - val_loss: 3.3153 - val_accuracy1000: 0.3270 - 24s/epoch - 14ms/step
Epoch 6/50
1686/1686 - 23s - loss: 3.2333 - accuracy1000: 0.4012 - val_loss: 3.3150 - val_accuracy1000: 0.3268 - 23s/epoch - 14ms/step
Epoch 7/50
1686/1686 - 24s - loss: 3.2315 - accuracy1000: 0.4033 - val_loss: 3.3183 - val_accuracy1000: 0.3261 - 24s/epoch - 14ms/step
Epoch 8/50
1686/1686 - 23s - loss: 3.2298 - accuracy1000: 0.4020 - val_loss: 3.3170 - val_accuracy1000: 0.3262 - 23s/epoch - 14ms/step
Epoch 9/50
1686/1686 - 24s - loss: 3.2283 - accuracy1000: 0.4036 - val_loss: 3.3188 - val_accuracy1000: 0.3255 - 24s/epoch - 14ms/step
Epoch 10/50
1686/1686 - 24s - loss: 3.2254 - accuracy1000: 0.4062 - val_loss: 3.3186 - val_accuracy1000: 0.3249 - 24s/epoch - 14ms/step
Epoch 11/50
1686/1686 - 24s - loss: 3.2241 - accuracy1000: 0.4082 - val_loss: 3.3202 - val_accuracy1000: 0.3257 - 24s/epoch - 14ms/step
Epoch 12/50
1686/1686 - 23s - loss: 3.2209 - accuracy1000: 0.4104 - val_loss: 3.3224 - val_accuracy1000: 0.3260 - 23s/epoch - 14ms/step
Epoch 13/50
1686/1686 - 24s - loss: 3.2187 - accuracy1000: 0.4136 - val_loss: 3.3265 - val_accuracy1000: 0.3260 - 24s/epoch - 14ms/step
Epoch 14/50
1686/1686 - 24s - loss: 3.2185 - accuracy1000: 0.4136 - val_loss: 3.3254 - val_accuracy1000: 0.3251 - 24s/epoch - 14ms/step
testing model: results/AAL/W10/deepOF_L1/h1000
Evaluating performance on  test set...
10110/10110 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1248884
{'0': {'precision': 0.42380177906452976, 'recall': 0.1202440137987013, 'f1-score': 0.18733580017798368, 'support': 1025024}, '1': {'precision': 0.19864672398827993, 'recall': 0.8822644446638824, 'f1-score': 0.3242800087677098, 'support': 516471}, '2': {'precision': 0.470828471411902, 'recall': 0.0015421349683403705, 'f1-score': 0.003074200807787214, 'support': 1046601}, 'accuracy': 0.22430814003808205, 'macro avg': {'precision': 0.3644256581549039, 'recall': 0.33468353114364136, 'f1-score': 0.17156333658449355, 'support': 2588096}, 'weighted avg': {'precision': 0.39788779704344795, 'recall': 0.22430814003808205, 'f1-score': 0.14015027776772435, 'support': 2588096}}
[[123253 900636   1135]
 [ 60128 455664    679]
 [107446 937541   1614]]
Evaluating performance on  train set...
1686/1686 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998788
{'0': {'precision': 0.38629777214272776, 'recall': 0.11673029295458588, 'f1-score': 0.17928483613017115, 'support': 146166}, '1': {'precision': 0.33269221323447673, 'recall': 0.899800033560801, 'f1-score': 0.485774195192197, 'support': 143024}, '2': {'precision': 0.3843478260869565, 'recall': 0.001552227903579255, 'f1-score': 0.0030919685766451445, 'support': 142376}, 'accuracy': 0.33824722058734935, 'macro avg': {'precision': 0.36777927048805364, 'recall': 0.3393608514729887, 'f1-score': 0.22271699996633776, 'support': 431566}, 'weighted avg': {'precision': 0.36788921591510515, 'recall': 0.33824722058734935, 'f1-score': 0.22273056257684762, 'support': 431566}}
[[ 17062 128964    140]
 [ 14117 128693    214]
 [ 12989 129166    221]]
Evaluating performance on  val set...
705/705 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033059
{'0': {'precision': 0.3535471656086424, 'recall': 0.11034638580391748, 'f1-score': 0.1681965693092258, 'support': 57537}, '1': {'precision': 0.32487907077055794, 'recall': 0.8967411640643603, 'f1-score': 0.4769607244469172, 'support': 58794}, '2': {'precision': 0.4327485380116959, 'recall': 0.0011547524304417708, 'f1-score': 0.0023033585457714694, 'support': 64083}, 'accuracy': 0.32783486869089984, 'macro avg': {'precision': 0.37039159146363215, 'recall': 0.33608076743290655, 'f1-score': 0.21582021743397148, 'support': 180414}, 'weighted avg': {'precision': 0.3723370022055503, 'recall': 0.32783486869089984, 'f1-score': 0.2098925857592296, 'support': 180414}}
[[ 6349 51147    41]
 [ 6015 52723    56]
 [ 5594 58415    74]]
training model: results/AAL/W10/deepLOB_L2/h10
Epoch 1/50
1686/1686 - 75s - loss: 2.8405 - accuracy10: 0.4496 - val_loss: 4.0467 - val_accuracy10: 0.4723 - 75s/epoch - 45ms/step
Epoch 2/50
1686/1686 - 71s - loss: 2.6428 - accuracy10: 0.4707 - val_loss: 4.3501 - val_accuracy10: 0.5875 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 72s - loss: 2.5169 - accuracy10: 0.5191 - val_loss: 4.0271 - val_accuracy10: 0.4471 - 72s/epoch - 43ms/step
Epoch 4/50
1686/1686 - 71s - loss: 2.3932 - accuracy10: 0.5792 - val_loss: 3.9729 - val_accuracy10: 0.5359 - 71s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 2.2597 - accuracy10: 0.6373 - val_loss: 3.8277 - val_accuracy10: 0.4708 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 2.1953 - accuracy10: 0.6572 - val_loss: 3.9319 - val_accuracy10: 0.4251 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 2.1541 - accuracy10: 0.6664 - val_loss: 3.9900 - val_accuracy10: 0.4270 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 70s - loss: 2.1237 - accuracy10: 0.6707 - val_loss: 3.9478 - val_accuracy10: 0.4422 - 70s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 2.0930 - accuracy10: 0.6733 - val_loss: 4.0282 - val_accuracy10: 0.4183 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 70s - loss: 2.0716 - accuracy10: 0.6768 - val_loss: 4.0449 - val_accuracy10: 0.4218 - 70s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 2.0490 - accuracy10: 0.6777 - val_loss: 3.9086 - val_accuracy10: 0.4267 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 2.0322 - accuracy10: 0.6794 - val_loss: 3.9079 - val_accuracy10: 0.3954 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 71s - loss: 2.0174 - accuracy10: 0.6800 - val_loss: 3.8957 - val_accuracy10: 0.4011 - 71s/epoch - 42ms/step
Epoch 14/50
1686/1686 - 70s - loss: 2.0053 - accuracy10: 0.6812 - val_loss: 3.8379 - val_accuracy10: 0.4149 - 70s/epoch - 42ms/step
Epoch 15/50
1686/1686 - 71s - loss: 1.9908 - accuracy10: 0.6827 - val_loss: 3.8558 - val_accuracy10: 0.3871 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h10
Evaluating performance on  test set...
10110/10110 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8132059
{'0': {'precision': 0.28039314081403827, 'recall': 0.4922383385811869, 'f1-score': 0.3572731825317237, 'support': 290595}, '1': {'precision': 0.8624885249245924, 'recall': 0.6502966381015162, 'f1-score': 0.7415109585523061, 'support': 2002440}, '2': {'precision': 0.2824913448524093, 'recall': 0.5439461001945327, 'f1-score': 0.37186133395117144, 'support': 295066}, 'accuracy': 0.6204247824949645, 'macro avg': {'precision': 0.47512433686368, 'recall': 0.5621603589590786, 'f1-score': 0.49021515834506707, 'support': 2588101}, 'weighted avg': {'precision': 0.7310054583515393, 'recall': 0.6204247824949645, 'f1-score': 0.656225023940303, 'support': 2588101}}
[[ 143042  110045   37508]
 [ 330109 1302180  370151]
 [  36997   97569  160500]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1043764
{'0': {'precision': 0.19893368877040987, 'recall': 0.6581058260624824, 'f1-score': 0.30551548047451316, 'support': 42636}, '1': {'precision': 0.908671274590362, 'recall': 0.4342137173609267, 'f1-score': 0.5876266908391876, 'support': 346364}, '2': {'precision': 0.20827300434368726, 'recall': 0.6116331516632212, 'f1-score': 0.31073476670426137, 'support': 42568}, 'accuracy': 0.47383262892522154, 'macro avg': {'precision': 0.4386259892348197, 'recall': 0.5679842316955434, 'f1-score': 0.40129231267265403, 'support': 431568}, 'weighted avg': {'precision': 0.7694697460319889, 'recall': 0.47383262892522154, 'f1-score': 0.5324445897758934, 'support': 431568}}
[[ 28059   8356   6221]
 [103216 150396  92752]
 [  9772   6760  26036]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1030307
{'0': {'precision': 0.22159853369554544, 'recall': 0.6379440309054932, 'f1-score': 0.32893650099596755, 'support': 21226}, '1': {'precision': 0.8652796389026024, 'recall': 0.447338676156376, 'f1-score': 0.5897724322921173, 'support': 137131}, '2': {'precision': 0.20882820729969223, 'recall': 0.45835789091898266, 'f1-score': 0.28693060876968923, 'support': 22057}, 'accuracy': 0.4711108893988271, 'macro avg': {'precision': 0.43190212663261335, 'recall': 0.5145468659936173, 'f1-score': 0.40187984735259136, 'support': 180414}, 'weighted avg': {'precision': 0.7092932721794525, 'recall': 0.4711108893988271, 'f1-score': 0.5220599178579477, 'support': 180414}}
[[13541  4953  2732]
 [40216 61344 35571]
 [ 7349  4598 10110]]
training model: results/AAL/W10/deepLOB_L2/h20
Epoch 1/50
1686/1686 - 74s - loss: 2.8677 - accuracy20: 0.4475 - val_loss: 4.1445 - val_accuracy20: 0.6060 - 74s/epoch - 44ms/step
Epoch 2/50
1686/1686 - 71s - loss: 2.7620 - accuracy20: 0.4728 - val_loss: 3.8805 - val_accuracy20: 0.5270 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 71s - loss: 2.6606 - accuracy20: 0.5025 - val_loss: 4.0213 - val_accuracy20: 0.5555 - 71s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 72s - loss: 2.5583 - accuracy20: 0.5486 - val_loss: 3.7914 - val_accuracy20: 0.5243 - 72s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 2.4832 - accuracy20: 0.5789 - val_loss: 3.8112 - val_accuracy20: 0.5289 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 2.4064 - accuracy20: 0.6069 - val_loss: 3.8209 - val_accuracy20: 0.4953 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 2.3405 - accuracy20: 0.6312 - val_loss: 3.8527 - val_accuracy20: 0.4742 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 71s - loss: 2.3034 - accuracy20: 0.6390 - val_loss: 3.8842 - val_accuracy20: 0.5103 - 71s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 2.2670 - accuracy20: 0.6448 - val_loss: 3.8618 - val_accuracy20: 0.4926 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 71s - loss: 2.2327 - accuracy20: 0.6503 - val_loss: 3.7036 - val_accuracy20: 0.5142 - 71s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 2.2058 - accuracy20: 0.6539 - val_loss: 3.9445 - val_accuracy20: 0.4797 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 2.1821 - accuracy20: 0.6567 - val_loss: 3.9250 - val_accuracy20: 0.4638 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 70s - loss: 2.1631 - accuracy20: 0.6596 - val_loss: 3.7997 - val_accuracy20: 0.4968 - 70s/epoch - 42ms/step
Epoch 14/50
1686/1686 - 70s - loss: 2.1445 - accuracy20: 0.6616 - val_loss: 3.9301 - val_accuracy20: 0.4509 - 70s/epoch - 42ms/step
Epoch 15/50
1686/1686 - 71s - loss: 2.1313 - accuracy20: 0.6621 - val_loss: 3.8230 - val_accuracy20: 0.4548 - 71s/epoch - 42ms/step
Epoch 16/50
1686/1686 - 72s - loss: 2.1176 - accuracy20: 0.6628 - val_loss: 3.9022 - val_accuracy20: 0.4342 - 72s/epoch - 42ms/step
Epoch 17/50
1686/1686 - 73s - loss: 2.1031 - accuracy20: 0.6638 - val_loss: 3.9929 - val_accuracy20: 0.4176 - 73s/epoch - 43ms/step
Epoch 18/50
1686/1686 - 73s - loss: 2.0904 - accuracy20: 0.6650 - val_loss: 4.0883 - val_accuracy20: 0.4270 - 73s/epoch - 43ms/step
Epoch 19/50
1686/1686 - 73s - loss: 2.0803 - accuracy20: 0.6664 - val_loss: 4.0357 - val_accuracy20: 0.4247 - 73s/epoch - 43ms/step
Epoch 20/50
1686/1686 - 71s - loss: 2.0711 - accuracy20: 0.6671 - val_loss: 3.9058 - val_accuracy20: 0.4511 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h20
Evaluating performance on  test set...
10110/10110 - 138s - 138s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7820412
{'0': {'precision': 0.3902441654997367, 'recall': 0.546033039558936, 'f1-score': 0.45517760489450004, 'support': 397584}, '1': {'precision': 0.7978231770178261, 'recall': 0.7387164826179067, 'f1-score': 0.767132989222514, 'support': 1790377}, '2': {'precision': 0.4208671847639823, 'recall': 0.3934372969460689, 'f1-score': 0.4066902522729885, 'support': 400140}, 'accuracy': 0.6557336827272197, 'macro avg': {'precision': 0.5363115090938484, 'recall': 0.5593956063743039, 'f1-score': 0.5430002821300008, 'support': 2588101}, 'weighted avg': {'precision': 0.6769306521681926, 'recall': 0.6557336827272197, 'f1-score': 0.6634832374216174, 'support': 2588101}}
[[ 217094  152741   27749]
 [ 278914 1322581  188882]
 [  60295  182415  157430]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96942407
{'0': {'precision': 0.27918492724456156, 'recall': 0.7263520496038581, 'f1-score': 0.4033398050823953, 'support': 58060}, '1': {'precision': 0.871369049219107, 'recall': 0.5135566744085095, 'f1-score': 0.6462402762327404, 'support': 315601}, '2': {'precision': 0.30505031266863475, 'recall': 0.4978672699328233, 'f1-score': 0.3783067394499265, 'support': 57907}, 'accuracy': 0.540079431283135, 'macro avg': {'precision': 0.4852014297107678, 'recall': 0.5792586646483969, 'f1-score': 0.475962273588354, 'support': 431568}, 'weighted avg': {'precision': 0.7157133259048892, 'recall': 0.540079431283135, 'f1-score': 0.5776113958026078, 'support': 431568}}
[[ 42172  10309   5579]
 [ 93422 162079  60100]
 [ 15460  13617  28830]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0998509
{'0': {'precision': 0.27728776929830484, 'recall': 0.732602954821212, 'f1-score': 0.40230459449131367, 'support': 28022}, '1': {'precision': 0.829388612610696, 'recall': 0.5070767179637262, 'f1-score': 0.6293671013798149, 'support': 123009}, '2': {'precision': 0.3167805472684695, 'recall': 0.3360786849538849, 'f1-score': 0.32614439527049344, 'support': 29383}, 'accuracy': 0.5142560998592127, 'macro avg': {'precision': 0.4744856430591568, 'recall': 0.525252785912941, 'f1-score': 0.452605363713874, 'support': 180414}, 'weighted avg': {'precision': 0.6601504569506559, 'recall': 0.5142560998592127, 'f1-score': 0.5447154759979721, 'support': 180414}}
[[20529  5526  1967]
 [41303 62375 19331]
 [12203  7305  9875]]
training model: results/AAL/W10/deepLOB_L2/h30
Epoch 1/50
1686/1686 - 72s - loss: 2.9096 - accuracy30: 0.4704 - val_loss: 4.0007 - val_accuracy30: 0.5502 - 72s/epoch - 43ms/step
Epoch 2/50
1686/1686 - 71s - loss: 2.8290 - accuracy30: 0.4635 - val_loss: 3.7530 - val_accuracy30: 0.4853 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 70s - loss: 2.7587 - accuracy30: 0.4792 - val_loss: 3.8354 - val_accuracy30: 0.5413 - 70s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 71s - loss: 2.6720 - accuracy30: 0.5151 - val_loss: 4.0358 - val_accuracy30: 0.5402 - 71s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 2.6004 - accuracy30: 0.5508 - val_loss: 3.8620 - val_accuracy30: 0.5395 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 2.5133 - accuracy30: 0.5876 - val_loss: 3.9297 - val_accuracy30: 0.4537 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 70s - loss: 2.4374 - accuracy30: 0.6111 - val_loss: 3.7967 - val_accuracy30: 0.4783 - 70s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 70s - loss: 2.3832 - accuracy30: 0.6232 - val_loss: 3.8018 - val_accuracy30: 0.5058 - 70s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 2.3463 - accuracy30: 0.6299 - val_loss: 3.8148 - val_accuracy30: 0.4952 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 71s - loss: 2.3217 - accuracy30: 0.6349 - val_loss: 3.7844 - val_accuracy30: 0.5414 - 71s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 2.2986 - accuracy30: 0.6380 - val_loss: 3.7964 - val_accuracy30: 0.4955 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 2.2783 - accuracy30: 0.6402 - val_loss: 3.7042 - val_accuracy30: 0.4828 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 71s - loss: 2.2637 - accuracy30: 0.6412 - val_loss: 3.8246 - val_accuracy30: 0.4809 - 71s/epoch - 42ms/step
Epoch 14/50
1686/1686 - 71s - loss: 2.2469 - accuracy30: 0.6440 - val_loss: 3.9408 - val_accuracy30: 0.4863 - 71s/epoch - 42ms/step
Epoch 15/50
1686/1686 - 72s - loss: 2.2339 - accuracy30: 0.6450 - val_loss: 4.0106 - val_accuracy30: 0.4967 - 72s/epoch - 43ms/step
Epoch 16/50
1686/1686 - 71s - loss: 2.2226 - accuracy30: 0.6456 - val_loss: 4.0393 - val_accuracy30: 0.5015 - 71s/epoch - 42ms/step
Epoch 17/50
1686/1686 - 71s - loss: 2.2127 - accuracy30: 0.6464 - val_loss: 3.9740 - val_accuracy30: 0.4963 - 71s/epoch - 42ms/step
Epoch 18/50
1686/1686 - 72s - loss: 2.2030 - accuracy30: 0.6478 - val_loss: 4.0123 - val_accuracy30: 0.5107 - 72s/epoch - 43ms/step
Epoch 19/50
1686/1686 - 72s - loss: 2.1936 - accuracy30: 0.6486 - val_loss: 4.0182 - val_accuracy30: 0.4754 - 72s/epoch - 43ms/step
Epoch 20/50
1686/1686 - 72s - loss: 2.1866 - accuracy30: 0.6491 - val_loss: 4.1159 - val_accuracy30: 0.4775 - 72s/epoch - 43ms/step
Epoch 21/50
1686/1686 - 70s - loss: 2.1787 - accuracy30: 0.6502 - val_loss: 4.0248 - val_accuracy30: 0.4855 - 70s/epoch - 42ms/step
Epoch 22/50
1686/1686 - 71s - loss: 2.1682 - accuracy30: 0.6513 - val_loss: 4.0004 - val_accuracy30: 0.4819 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h30
Evaluating performance on  test set...
10110/10110 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84740865
{'0': {'precision': 0.374389401196178, 'recall': 0.5631885567534174, 'f1-score': 0.44977982840929187, 'support': 474271}, '1': {'precision': 0.7503429964114287, 'recall': 0.7026442905681897, 'f1-score': 0.7257107162888942, 'support': 1636091}, '2': {'precision': 0.4718631778058008, 'recall': 0.3383625787302272, 'f1-score': 0.394114456032134, 'support': 477739}, 'accuracy': 0.6098459835995581, 'macro avg': {'precision': 0.5321985251378024, 'recall': 0.5347318086839448, 'f1-score': 0.5232016669101066, 'support': 2588101}, 'weighted avg': {'precision': 0.6300445391189327, 'recall': 0.6098459835995581, 'f1-score': 0.6139366843232362, 'support': 2588101}}
[[ 267104  177107   30060]
 [ 335634 1149590  150867]
 [ 110701  205389  161649]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0146006
{'0': {'precision': 0.2846315485992138, 'recall': 0.7382369859073914, 'f1-score': 0.4108554118998171, 'support': 69540}, '1': {'precision': 0.8267493429697766, 'recall': 0.4813167897869899, 'f1-score': 0.6084223568697964, 'support': 292803}, '2': {'precision': 0.3721157776098884, 'recall': 0.4340195016251354, 'f1-score': 0.4006908232532707, 'support': 69225}, 'accuracy': 0.5151285544804063, 'macro avg': {'precision': 0.49449888972629297, 'recall': 0.5511910924398389, 'f1-score': 0.4733228640076281, 'support': 431568}, 'weighted avg': {'precision': 0.6664712871765593, 'recall': 0.5151285544804063, 'f1-score': 0.5432668755370369, 'support': 431568}}
[[ 51337  12997   5206]
 [106382 140931  45490]
 [ 22644  16536  30045]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1016777
{'0': {'precision': 0.28083790211820403, 'recall': 0.7627756042822915, 'f1-score': 0.4105280339508692, 'support': 32973}, '1': {'precision': 0.7830019716147676, 'recall': 0.46072440665958203, 'f1-score': 0.5801084950630843, 'support': 112920}, '2': {'precision': 0.40235111001884166, 'recall': 0.2845514324614003, 'f1-score': 0.3333503011792653, 'support': 34521}, 'accuracy': 0.4822186748256787, 'macro avg': {'precision': 0.48873032791727106, 'recall': 0.502683814467758, 'f1-score': 0.4413289433977396, 'support': 180414}, 'weighted avg': {'precision': 0.6183899999459217, 'recall': 0.4822186748256787, 'f1-score': 0.5018999516278942, 'support': 180414}}
[[25151  6042  1780]
 [48084 52025 12811]
 [16322  8376  9823]]
training model: results/AAL/W10/deepLOB_L2/h50
Epoch 1/50
1686/1686 - 75s - loss: 2.9973 - accuracy50: 0.4690 - val_loss: 3.9592 - val_accuracy50: 0.4790 - 75s/epoch - 45ms/step
Epoch 2/50
1686/1686 - 73s - loss: 2.8560 - accuracy50: 0.4997 - val_loss: 4.0171 - val_accuracy50: 0.4193 - 73s/epoch - 43ms/step
Epoch 3/50
1686/1686 - 71s - loss: 2.7797 - accuracy50: 0.5263 - val_loss: 4.0031 - val_accuracy50: 0.4185 - 71s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 72s - loss: 2.7367 - accuracy50: 0.5413 - val_loss: 3.9329 - val_accuracy50: 0.4081 - 72s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 2.6798 - accuracy50: 0.5621 - val_loss: 4.0440 - val_accuracy50: 0.3875 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 2.6231 - accuracy50: 0.5806 - val_loss: 4.2628 - val_accuracy50: 0.4166 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 72s - loss: 2.5731 - accuracy50: 0.5945 - val_loss: 4.3409 - val_accuracy50: 0.3924 - 72s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 71s - loss: 2.5363 - accuracy50: 0.6029 - val_loss: 4.3394 - val_accuracy50: 0.4032 - 71s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 2.5117 - accuracy50: 0.6078 - val_loss: 4.2538 - val_accuracy50: 0.4132 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 72s - loss: 2.4935 - accuracy50: 0.6107 - val_loss: 4.0934 - val_accuracy50: 0.4341 - 72s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 2.4778 - accuracy50: 0.6127 - val_loss: 4.0492 - val_accuracy50: 0.3986 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 2.4666 - accuracy50: 0.6134 - val_loss: 4.0921 - val_accuracy50: 0.3834 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 71s - loss: 2.4535 - accuracy50: 0.6154 - val_loss: 4.0391 - val_accuracy50: 0.3992 - 71s/epoch - 42ms/step
Epoch 14/50
1686/1686 - 71s - loss: 2.4395 - accuracy50: 0.6170 - val_loss: 4.1132 - val_accuracy50: 0.3933 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h50
Evaluating performance on  test set...
10110/10110 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0592371
{'0': {'precision': 0.3840166293139054, 'recall': 0.478934443949036, 'f1-score': 0.42625543098802837, 'support': 592104}, '1': {'precision': 0.672592379858319, 'recall': 0.4523308956971656, 'f1-score': 0.5408978909609129, 'support': 1397939}, '2': {'precision': 0.3446552304217894, 'recall': 0.5241397991499153, 'f1-score': 0.41585763523140645, 'support': 598058}, 'accuracy': 0.47501082840275555, 'macro avg': {'precision': 0.46708807986467127, 'recall': 0.4851350462653723, 'f1-score': 0.46100365239344926, 'support': 2588101}, 'weighted avg': {'precision': 0.5307925459576862, 'recall': 0.47501082840275555, 'f1-score': 0.4857757823643543, 'support': 2588101}}
[[283579 143056 165469]
 [335037 632331 430571]
 [119839 164753 313466]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1439757
{'0': {'precision': 0.314820641101684, 'recall': 0.6960135921001619, 'f1-score': 0.4335417976227258, 'support': 87698}, '1': {'precision': 0.7301020687640367, 'recall': 0.311590701878794, 'f1-score': 0.43677564529695123, 'support': 256654}, '2': {'precision': 0.3082817657570484, 'recall': 0.45296734544120343, 'f1-score': 0.36687484038724955, 'support': 87216}, 'accuracy': 0.4182793905016127, 'macro avg': {'precision': 0.4510681585409231, 'recall': 0.4868572131400531, 'f1-score': 0.41239742776897553, 'support': 431568}, 'weighted avg': {'precision': 0.560467549545303, 'recall': 0.4182793905016127, 'f1-score': 0.42199217994655747, 'support': 431568}}
[[ 61039  13273  13386]
 [101426  79971  75257]
 [ 31420  16290  39506]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2173158
{'0': {'precision': 0.307990819483097, 'recall': 0.6846593709947747, 'f1-score': 0.4248602433410062, 'support': 40572}, '1': {'precision': 0.6415291454661534, 'recall': 0.3406895984876505, 'f1-score': 0.44503794767180466, 'support': 97332}, '2': {'precision': 0.3285410287019256, 'recall': 0.2978122794636556, 'f1-score': 0.31242288139775926, 'support': 42510}, 'accuracy': 0.4079395168889332, 'macro avg': {'precision': 0.4260203312170587, 'recall': 0.44105374964869365, 'f1-score': 0.3941070241368567, 'support': 180414}, 'weighted avg': {'precision': 0.49277438250190514, 'recall': 0.4079395168889332, 'f1-score': 0.40925294048046235, 'support': 180414}}
[[27778  8623  4171]
 [42469 33160 21703]
 [19944  9906 12660]]
training model: results/AAL/W10/deepLOB_L2/h100
Epoch 1/50
1686/1686 - 74s - loss: 3.0855 - accuracy100: 0.4678 - val_loss: 3.9168 - val_accuracy100: 0.3995 - 74s/epoch - 44ms/step
Epoch 2/50
1686/1686 - 71s - loss: 3.0105 - accuracy100: 0.4857 - val_loss: 3.7319 - val_accuracy100: 0.4021 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 71s - loss: 2.9665 - accuracy100: 0.5013 - val_loss: 3.7863 - val_accuracy100: 0.3879 - 71s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 71s - loss: 2.9431 - accuracy100: 0.5096 - val_loss: 3.8277 - val_accuracy100: 0.3976 - 71s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 2.9237 - accuracy100: 0.5161 - val_loss: 3.8220 - val_accuracy100: 0.4000 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 2.9045 - accuracy100: 0.5216 - val_loss: 3.9237 - val_accuracy100: 0.3899 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 2.8877 - accuracy100: 0.5271 - val_loss: 3.9986 - val_accuracy100: 0.3829 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 71s - loss: 2.8712 - accuracy100: 0.5314 - val_loss: 3.9270 - val_accuracy100: 0.3936 - 71s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 2.8569 - accuracy100: 0.5348 - val_loss: 4.0263 - val_accuracy100: 0.3777 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 71s - loss: 2.8422 - accuracy100: 0.5384 - val_loss: 4.0280 - val_accuracy100: 0.3754 - 71s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 2.8275 - accuracy100: 0.5427 - val_loss: 4.0073 - val_accuracy100: 0.3885 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 2.8124 - accuracy100: 0.5456 - val_loss: 4.0680 - val_accuracy100: 0.3989 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h100
Evaluating performance on  test set...
10110/10110 - 139s - 139s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1640129
{'0': {'precision': 0.4397682747180114, 'recall': 0.26100177423159365, 'f1-score': 0.3275833495572872, 'support': 780056}, '1': {'precision': 0.4429300244276789, 'recall': 0.48461829563462344, 'f1-score': 0.46283732907656167, 'support': 1014712}, '2': {'precision': 0.3832310431431744, 'recall': 0.49027331524088874, 'f1-score': 0.43019351242301973, 'support': 793333}, 'accuracy': 0.41895351070147574, 'macro avg': {'precision': 0.42197644742962154, 'recall': 0.4119644617023686, 'f1-score': 0.40687139701895614, 'support': 2588101}, 'weighted avg': {'precision': 0.42367748607971484, 'recall': 0.41895351070147574, 'f1-score': 0.41206531699314936, 'support': 2588101}}
[[203596 298616 277844]
 [174835 491748 348129]
 [ 84531 319852 388950]]
Evaluating performance on  train set...
1686/1686 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093293
{'0': {'precision': 0.40317764429715547, 'recall': 0.39622577498833805, 'f1-score': 0.399671481796755, 'support': 117905}, '1': {'precision': 0.48870254817494063, 'recall': 0.4417598708426199, 'f1-score': 0.4640470590744978, 'support': 196969}, '2': {'precision': 0.3619984452984809, 'recall': 0.42699710353574305, 'f1-score': 0.39182043005256717, 'support': 116694}, 'accuracy': 0.42532810588366143, 'macro avg': {'precision': 0.4179595459235257, 'recall': 0.42166091645556697, 'f1-score': 0.41851299030794004, 'support': 431568}, 'weighted avg': {'precision': 0.43107681509747464, 'recall': 0.42532810588366143, 'f1-score': 0.4269298106083987, 'support': 431568}}
[[46717 46498 24690]
 [46827 87013 63129]
 [22328 44538 49828]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.160836
{'0': {'precision': 0.42107436009519644, 'recall': 0.33006548389553036, 'f1-score': 0.37005655746451815, 'support': 52532}, '1': {'precision': 0.41092913424065464, 'recall': 0.46651413449478313, 'f1-score': 0.43696101213529565, 'support': 72553}, '2': {'precision': 0.37252281559373296, 'recall': 0.3828914312566647, 'f1-score': 0.37763596499046326, 'support': 55329}, 'accuracy': 0.4011384925781813, 'macro avg': {'precision': 0.401508769976528, 'recall': 0.39315701654899277, 'f1-score': 0.39488451153009235, 'support': 180414}, 'weighted avg': {'precision': 0.4021047957756534, 'recall': 0.4011384925781813, 'f1-score': 0.39928643950655446, 'support': 180414}}
[[17339 24427 10766]
 [13788 33847 24918]
 [10051 24093 21185]]
training model: results/AAL/W10/deepLOB_L2/h200
Epoch 1/50
1686/1686 - 73s - loss: 3.2020 - accuracy200: 0.4242 - val_loss: 3.7229 - val_accuracy200: 0.3126 - 73s/epoch - 43ms/step
Epoch 2/50
1686/1686 - 71s - loss: 3.1788 - accuracy200: 0.4309 - val_loss: 3.6910 - val_accuracy200: 0.3055 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 71s - loss: 3.1419 - accuracy200: 0.4467 - val_loss: 3.6063 - val_accuracy200: 0.3394 - 71s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 71s - loss: 3.1147 - accuracy200: 0.4574 - val_loss: 3.5665 - val_accuracy200: 0.3302 - 71s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 3.0926 - accuracy200: 0.4656 - val_loss: 3.6452 - val_accuracy200: 0.3195 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 70s - loss: 3.0746 - accuracy200: 0.4708 - val_loss: 3.6731 - val_accuracy200: 0.3208 - 70s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 3.0630 - accuracy200: 0.4742 - val_loss: 3.6762 - val_accuracy200: 0.3259 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 71s - loss: 3.0523 - accuracy200: 0.4783 - val_loss: 3.5893 - val_accuracy200: 0.3276 - 71s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 71s - loss: 3.0412 - accuracy200: 0.4822 - val_loss: 3.7038 - val_accuracy200: 0.3352 - 71s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 71s - loss: 3.0316 - accuracy200: 0.4849 - val_loss: 3.6780 - val_accuracy200: 0.3371 - 71s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 70s - loss: 3.0215 - accuracy200: 0.4878 - val_loss: 3.7612 - val_accuracy200: 0.3328 - 70s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 71s - loss: 3.0115 - accuracy200: 0.4908 - val_loss: 3.8676 - val_accuracy200: 0.3353 - 71s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 71s - loss: 3.0025 - accuracy200: 0.4938 - val_loss: 3.8738 - val_accuracy200: 0.3368 - 71s/epoch - 42ms/step
Epoch 14/50
1686/1686 - 70s - loss: 2.9883 - accuracy200: 0.4983 - val_loss: 3.9092 - val_accuracy200: 0.3380 - 70s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h200
Evaluating performance on  test set...
10110/10110 - 139s - 139s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1814911
{'0': {'precision': 0.4650214252797667, 'recall': 0.1448241884177493, 'f1-score': 0.22086360547773362, 'support': 933670}, '1': {'precision': 0.2791178873784818, 'recall': 0.6965508825353219, 'f1-score': 0.39853650496992393, 'support': 704731}, '2': {'precision': 0.4185535315129327, 'recall': 0.2373886490470675, 'f1-score': 0.30295309661259284, 'support': 949700}, 'accuracy': 0.3290238673065696, 'macro avg': {'precision': 0.38756428139039373, 'recall': 0.3595879066667129, 'f1-score': 0.30745106902008346, 'support': 2588101}, 'weighted avg': {'precision': 0.39734920349279906, 'recall': 0.3290238673065696, 'f1-score': 0.29936594748942735, 'support': 2588101}}
[[135218 615315 183137]
 [ 83799 490881 130051]
 [ 71761 652491 225448]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1482172
{'0': {'precision': 0.43651017435029843, 'recall': 0.12875479962850528, 'f1-score': 0.19885463498180259, 'support': 144282}, '1': {'precision': 0.34013486530277465, 'recall': 0.6946397188049209, 'f1-score': 0.45666213843744496, 'support': 145664}, '2': {'precision': 0.3817411065466305, 'recall': 0.2467130813009278, 'f1-score': 0.29972120952176706, 'support': 141622}, 'accuracy': 0.3584626292959626, 'macro avg': {'precision': 0.3861287153999012, 'recall': 0.3567025332447846, 'f1-score': 0.3184126609803382, 'support': 431568}, 'weighted avg': {'precision': 0.3860084737200627, 'recall': 0.3584626292959626, 'f1-score': 0.31897058010021156, 'support': 431568}}
[[ 18577  99688  26017]
 [ 13909 101184  30571]
 [ 10072  96610  34940]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1861986
{'0': {'precision': 0.41962248496162624, 'recall': 0.06581751337985782, 'f1-score': 0.11378752724460381, 'support': 61473}, '1': {'precision': 0.3019153306054865, 'recall': 0.7010480785227083, 'f1-score': 0.42206357773610736, 'support': 54099}, '2': {'precision': 0.38430703813615624, 'recall': 0.2676197526294686, 'f1-score': 0.3155205643841595, 'support': 64842}, 'accuracy': 0.3288270311616615, 'macro avg': {'precision': 0.368614951234423, 'recall': 0.3448284481773449, 'f1-score': 0.28379055645495693, 'support': 180414}, 'weighted avg': {'precision': 0.3716341717122668, 'recall': 0.3288270311616615, 'f1-score': 0.2787314875234232, 'support': 180414}}
[[ 4046 43427 14000]
 [ 2372 37926 13801]
 [ 3224 44265 17353]]
training model: results/AAL/W10/deepLOB_L2/h300
Epoch 1/50
1686/1686 - 74s - loss: 3.2376 - accuracy300: 0.4035 - val_loss: 3.5075 - val_accuracy300: 0.2903 - 74s/epoch - 44ms/step
Epoch 2/50
1686/1686 - 71s - loss: 3.2092 - accuracy300: 0.4166 - val_loss: 3.5547 - val_accuracy300: 0.2977 - 71s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 70s - loss: 3.1853 - accuracy300: 0.4277 - val_loss: 3.4962 - val_accuracy300: 0.3246 - 70s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 70s - loss: 3.1596 - accuracy300: 0.4408 - val_loss: 3.5380 - val_accuracy300: 0.3231 - 70s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 70s - loss: 3.1459 - accuracy300: 0.4470 - val_loss: 3.5727 - val_accuracy300: 0.3216 - 70s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 3.1310 - accuracy300: 0.4525 - val_loss: 3.6930 - val_accuracy300: 0.3191 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 3.1139 - accuracy300: 0.4586 - val_loss: 3.7148 - val_accuracy300: 0.3243 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 71s - loss: 3.1025 - accuracy300: 0.4631 - val_loss: 3.8354 - val_accuracy300: 0.3252 - 71s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 70s - loss: 3.0887 - accuracy300: 0.4679 - val_loss: 3.7805 - val_accuracy300: 0.3279 - 70s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 71s - loss: 3.0745 - accuracy300: 0.4726 - val_loss: 3.8603 - val_accuracy300: 0.3261 - 71s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 3.0632 - accuracy300: 0.4756 - val_loss: 3.8454 - val_accuracy300: 0.3332 - 71s/epoch - 42ms/step
Epoch 12/50
1686/1686 - 70s - loss: 3.0485 - accuracy300: 0.4814 - val_loss: 3.8711 - val_accuracy300: 0.3304 - 70s/epoch - 42ms/step
Epoch 13/50
1686/1686 - 70s - loss: 3.0360 - accuracy300: 0.4857 - val_loss: 3.7755 - val_accuracy300: 0.3249 - 70s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h300
Evaluating performance on  test set...
10110/10110 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1849024
{'0': {'precision': 0.45253270093007747, 'recall': 0.025344182822610434, 'f1-score': 0.04800011005142939, 'support': 963732}, '1': {'precision': 0.2522339639279945, 'recall': 0.8329314624698984, 'f1-score': 0.387210280291569, 'support': 646974}, '2': {'precision': 0.40644189520164553, 'recall': 0.1653712163454898, 'f1-score': 0.23509006430931303, 'support': 977395}, 'accuracy': 0.28010614732578054, 'macro avg': {'precision': 0.37040285335323914, 'recall': 0.3412156205459995, 'f1-score': 0.22343348488410383, 'support': 2588101}, 'weighted avg': {'precision': 0.38505581415551715, 'recall': 0.28010614732578054, 'f1-score': 0.20345035968342917, 'support': 2588101}}
[[ 24425 798341 140966]
 [ 13010 538885  95079]
 [ 16539 799223 161633]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1597278
{'0': {'precision': 0.41256559353283223, 'recall': 0.01953279750753715, 'f1-score': 0.03729965380176946, 'support': 148929}, '1': {'precision': 0.31881183648723604, 'recall': 0.7245802153343253, 'f1-score': 0.4427956849580432, 'support': 136439}, '2': {'precision': 0.3841468210618309, 'recall': 0.300656634746922, 'f1-score': 0.33731223021582735, 'support': 146200}, 'accuracy': 0.3376663700737775, 'macro avg': {'precision': 0.3718414170272997, 'recall': 0.3482565491962615, 'f1-score': 0.27246918965854666, 'support': 431568}, 'weighted avg': {'precision': 0.373298332306781, 'recall': 0.3376663700737775, 'f1-score': 0.2671297423779987, 'support': 431568}}
[[  2909 110730  35290]
 [  2399  98861  35179]
 [  1743 100501  43956]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1760317
{'0': {'precision': 0.34888768312533913, 'recall': 0.010321524310962005, 'f1-score': 0.02004989086373558, 'support': 62297}, '1': {'precision': 0.29646806194498915, 'recall': 0.76552241966847, 'f1-score': 0.42741051273782654, 'support': 51941}, '2': {'precision': 0.4063709169441195, 'recall': 0.2729690522243714, 'f1-score': 0.3265719347723904, 'support': 66176}, 'accuracy': 0.3240823882847229, 'macro avg': {'precision': 0.3505755540048159, 'recall': 0.34960433206793445, 'f1-score': 0.2580107794579842, 'support': 180414}, 'weighted avg': {'precision': 0.35488102586738274, 'recall': 0.3240823882847229, 'f1-score': 0.2497611152612951, 'support': 180414}}
[[  643 46872 14782]
 [  573 39762 11606]
 [  627 47485 18064]]
training model: results/AAL/W10/deepLOB_L2/h500
Epoch 1/50
1686/1686 - 74s - loss: 3.2652 - accuracy500: 0.3883 - val_loss: 3.4883 - val_accuracy500: 0.3121 - 74s/epoch - 44ms/step
Epoch 2/50
1686/1686 - 70s - loss: 3.2428 - accuracy500: 0.4009 - val_loss: 3.4923 - val_accuracy500: 0.3034 - 70s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 70s - loss: 3.2208 - accuracy500: 0.4121 - val_loss: 3.5429 - val_accuracy500: 0.3078 - 70s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 70s - loss: 3.1999 - accuracy500: 0.4230 - val_loss: 3.5381 - val_accuracy500: 0.3122 - 70s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 3.1877 - accuracy500: 0.4299 - val_loss: 3.5481 - val_accuracy500: 0.3194 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 70s - loss: 3.1728 - accuracy500: 0.4361 - val_loss: 3.5961 - val_accuracy500: 0.3298 - 70s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 3.1594 - accuracy500: 0.4423 - val_loss: 3.6396 - val_accuracy500: 0.3304 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 70s - loss: 3.1500 - accuracy500: 0.4459 - val_loss: 3.6812 - val_accuracy500: 0.3280 - 70s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 70s - loss: 3.1374 - accuracy500: 0.4519 - val_loss: 3.6523 - val_accuracy500: 0.3239 - 70s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 70s - loss: 3.1261 - accuracy500: 0.4554 - val_loss: 3.6717 - val_accuracy500: 0.3166 - 70s/epoch - 42ms/step
Epoch 11/50
1686/1686 - 71s - loss: 3.1137 - accuracy500: 0.4592 - val_loss: 3.7067 - val_accuracy500: 0.3198 - 71s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h500
Evaluating performance on  test set...
10110/10110 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2041483
{'0': {'precision': 0.3767799273298635, 'recall': 0.01630082656566322, 'f1-score': 0.031249681842523757, 'support': 941486}, '1': {'precision': 0.2637960566485295, 'recall': 0.9275332878339927, 'f1-score': 0.4107673916940815, 'support': 684259}, '2': {'precision': 0.3957764800701328, 'recall': 0.05817078087526861, 'f1-score': 0.1014330468689131, 'support': 962356}, 'accuracy': 0.27278726757572447, 'macro avg': {'precision': 0.3454508213495086, 'recall': 0.33400163175830816, 'f1-score': 0.18115004013517277, 'support': 2588101}, 'weighted avg': {'precision': 0.353972168336059, 'recall': 0.27278726757572447, 'f1-score': 0.1576859341598224, 'support': 2588101}}
[[ 15347 879208  46931]
 [ 11052 634673  38534]
 [ 14333 892042  55981]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1573018
{'0': {'precision': 0.35605202093788785, 'recall': 0.04469039136265731, 'f1-score': 0.07941312759901066, 'support': 147638}, '1': {'precision': 0.3221636198878959, 'recall': 0.8598728420808712, 'f1-score': 0.4687160783292084, 'support': 138096}, '2': {'precision': 0.3818586758453128, 'recall': 0.11639261077663644, 'f1-score': 0.17840607509787948, 'support': 145834}, 'accuracy': 0.3297672672672673, 'macro avg': {'precision': 0.35335810555703223, 'recall': 0.340318614740055, 'f1-score': 0.24217842700869951, 'support': 431568}, 'weighted avg': {'precision': 0.3539286825077209, 'recall': 0.3297672672672673, 'f1-score': 0.23743623818549398, 'support': 431568}}
[[  6598 127091  13949]
 [  5823 118745  13528]
 [  6110 122750  16974]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1716346
{'0': {'precision': 0.33014073494917906, 'recall': 0.02792843442026589, 'f1-score': 0.05150018294914014, 'support': 60476}, '1': {'precision': 0.30285014529903687, 'recall': 0.8743382608854939, 'f1-score': 0.44987440915752824, 'support': 54591}, '2': {'precision': 0.38452407867962923, 'recall': 0.10410577379221693, 'f1-score': 0.16385072074567372, 'support': 65347}, 'accuracy': 0.31163324353985833, 'macro avg': {'precision': 0.33917165297594837, 'recall': 0.3354574896993256, 'f1-score': 0.2217417709507807, 'support': 180414}, 'weighted avg': {'precision': 0.34158091023027043, 'recall': 0.31163324353985833, 'f1-score': 0.21273721542074542, 'support': 180414}}
[[ 1689 53246  5541]
 [ 1512 47731  5348]
 [ 1915 56629  6803]]
training model: results/AAL/W10/deepLOB_L2/h1000
Epoch 1/50
1686/1686 - 74s - loss: 3.1734 - accuracy1000: 0.4416 - val_loss: 3.4126 - val_accuracy1000: 0.3310 - 74s/epoch - 44ms/step
Epoch 2/50
1686/1686 - 70s - loss: 3.1417 - accuracy1000: 0.4513 - val_loss: 3.5684 - val_accuracy1000: 0.3639 - 70s/epoch - 42ms/step
Epoch 3/50
1686/1686 - 70s - loss: 3.1199 - accuracy1000: 0.4612 - val_loss: 3.5898 - val_accuracy1000: 0.3545 - 70s/epoch - 42ms/step
Epoch 4/50
1686/1686 - 71s - loss: 3.1110 - accuracy1000: 0.4698 - val_loss: 3.5415 - val_accuracy1000: 0.3507 - 71s/epoch - 42ms/step
Epoch 5/50
1686/1686 - 71s - loss: 3.0981 - accuracy1000: 0.4677 - val_loss: 3.5753 - val_accuracy1000: 0.3543 - 71s/epoch - 42ms/step
Epoch 6/50
1686/1686 - 71s - loss: 3.0806 - accuracy1000: 0.4776 - val_loss: 3.7115 - val_accuracy1000: 0.3535 - 71s/epoch - 42ms/step
Epoch 7/50
1686/1686 - 71s - loss: 3.0752 - accuracy1000: 0.4775 - val_loss: 3.5577 - val_accuracy1000: 0.3560 - 71s/epoch - 42ms/step
Epoch 8/50
1686/1686 - 70s - loss: 3.0642 - accuracy1000: 0.4792 - val_loss: 3.5916 - val_accuracy1000: 0.3469 - 70s/epoch - 42ms/step
Epoch 9/50
1686/1686 - 70s - loss: 3.0498 - accuracy1000: 0.4869 - val_loss: 3.6023 - val_accuracy1000: 0.3620 - 70s/epoch - 42ms/step
Epoch 10/50
1686/1686 - 70s - loss: 3.0391 - accuracy1000: 0.4908 - val_loss: 3.7298 - val_accuracy1000: 0.3663 - 70s/epoch - 41ms/step
Epoch 11/50
1686/1686 - 70s - loss: 3.0303 - accuracy1000: 0.4934 - val_loss: 3.5835 - val_accuracy1000: 0.3587 - 70s/epoch - 42ms/step
testing model: results/AAL/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
10110/10110 - 138s - 138s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1664935
{'0': {'precision': 0.39877886647728283, 'recall': 0.5457465998456626, 'f1-score': 0.4608286768964117, 'support': 1025027}, '1': {'precision': 0.19254166864065217, 'recall': 0.21246456729503246, 'f1-score': 0.20201309848718457, 'support': 516472}, '2': {'precision': 0.41676782153843156, 'recall': 0.24505590472787173, 'f1-score': 0.30863630757011906, 'support': 1046602}, 'accuracy': 0.35764176127593167, 'macro avg': {'precision': 0.3360294522187888, 'recall': 0.33442235728952224, 'f1-score': 0.3238260276512384, 'support': 2588101}, 'weighted avg': {'precision': 0.3648974755670471, 'recall': 0.35764176127593167, 'f1-score': 0.34763532102127126, 'support': 2588101}}
[[559405 224151 241471]
 [289294 109732 117446]
 [554096 236030 256476]]
Evaluating performance on  train set...
1686/1686 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1439952
{'0': {'precision': 0.3132761618483482, 'recall': 0.36377075434249967, 'f1-score': 0.3366404985765361, 'support': 146114}, '1': {'precision': 0.2973713822159418, 'recall': 0.31777380070189176, 'f1-score': 0.30723424964007867, 'support': 143042}, '2': {'precision': 0.3732335598411694, 'recall': 0.2857905232705109, 'f1-score': 0.32371082363327625, 'support': 142412}, 'accuracy': 0.32279270010751493, 'macro avg': {'precision': 0.32796036796848643, 'recall': 0.32244502610496745, 'f1-score': 0.3225285239499636, 'support': 431568}, 'weighted avg': {'precision': 0.32778975292733226, 'recall': 0.32279270010751493, 'f1-score': 0.32262725030885114, 'support': 431568}}
[[53152 54289 38673]
 [67913 45455 29674]
 [48600 53112 40700]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1375746
{'0': {'precision': 0.30717765127061447, 'recall': 0.27289791094580973, 'f1-score': 0.28902489531084624, 'support': 57538}, '1': {'precision': 0.31361935952423364, 'recall': 0.38927441575670985, 'f1-score': 0.3473753709086218, 'support': 58794}, '2': {'precision': 0.3767223011363636, 'recall': 0.3310914141256515, 'f1-score': 0.3524360060464112, 'support': 64082}, 'accuracy': 0.33149312137638987, 'macro avg': {'precision': 0.3325064373104039, 'recall': 0.3310879136093903, 'f1-score': 0.3296120907552931, 'support': 180414}, 'weighted avg': {'precision': 0.3339787534453915, 'recall': 0.33149312137638987, 'f1-score': 0.33056362656480703, 'support': 180414}}
[[15702 23788 18048]
 [18852 22887 17055]
 [16563 26302 21217]]
training model: results/AAL/W10/deepOF_L2/h10
Epoch 1/50
1686/1686 - 41s - loss: 2.6515 - accuracy10: 0.5294 - val_loss: 3.2979 - val_accuracy10: 0.7320 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 2.2724 - accuracy10: 0.6371 - val_loss: 3.1853 - val_accuracy10: 0.7216 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 38s - loss: 2.1631 - accuracy10: 0.6574 - val_loss: 3.2287 - val_accuracy10: 0.7394 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.1230 - accuracy10: 0.6627 - val_loss: 3.3514 - val_accuracy10: 0.7466 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.0967 - accuracy10: 0.6668 - val_loss: 3.2826 - val_accuracy10: 0.7407 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.0804 - accuracy10: 0.6683 - val_loss: 3.3108 - val_accuracy10: 0.7367 - 38s/epoch - 22ms/step
Epoch 7/50
1686/1686 - 38s - loss: 2.0624 - accuracy10: 0.6701 - val_loss: 3.3307 - val_accuracy10: 0.7381 - 38s/epoch - 22ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.0500 - accuracy10: 0.6701 - val_loss: 3.3461 - val_accuracy10: 0.7304 - 38s/epoch - 22ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.0381 - accuracy10: 0.6721 - val_loss: 3.3375 - val_accuracy10: 0.7373 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.0256 - accuracy10: 0.6725 - val_loss: 3.3530 - val_accuracy10: 0.7402 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.0165 - accuracy10: 0.6735 - val_loss: 3.3413 - val_accuracy10: 0.7285 - 38s/epoch - 23ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.0068 - accuracy10: 0.6742 - val_loss: 3.3480 - val_accuracy10: 0.7384 - 38s/epoch - 22ms/step
testing model: results/AAL/W10/deepOF_L2/h10
Evaluating performance on  test set...
10110/10110 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64363366
{'0': {'precision': 0.4147201694279007, 'recall': 0.5094462338949455, 'f1-score': 0.45722854169047406, 'support': 290592}, '1': {'precision': 0.8840575969717499, 'recall': 0.8210922674337309, 'f1-score': 0.8514123854945032, 'support': 2002440}, '2': {'precision': 0.3840672214591581, 'recall': 0.48331209500311795, 'f1-score': 0.42801189722288085, 'support': 295064}, 'accuracy': 0.7475908930735181, 'macro avg': {'precision': 0.5609483292862696, 'recall': 0.6046168654439315, 'f1-score': 0.5788842748026194, 'support': 2588096}, 'weighted avg': {'precision': 0.7743573146386875, 'recall': 0.7475908930735181, 'f1-score': 0.758882234677038, 'support': 2588096}}
[[ 148041  105380   37171]
 [ 166721 1644188  191531]
 [  42204  110252  142608]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58464915
{'0': {'precision': 0.39731785428342675, 'recall': 0.5123301813745044, 'f1-score': 0.44755316423264163, 'support': 42619}, '1': {'precision': 0.9023466575312602, 'recall': 0.8367285055851402, 'f1-score': 0.8682996414288303, 'support': 346276}, '2': {'precision': 0.37858236512654236, 'recall': 0.49253591432120175, 'f1-score': 0.4281058399364472, 'support': 42671}, 'accuracy': 0.7706608027509118, 'macro avg': {'precision': 0.5594156256470765, 'recall': 0.6138648670936154, 'f1-score': 0.5813195485326398, 'support': 431566}, 'weighted avg': {'precision': 0.8006858022117469, 'recall': 0.7706608027509118, 'f1-score': 0.7832250437656552, 'support': 431566}}
[[ 21835  15720   5064]
 [ 27103 289739  29434]
 [  6018  15636  21017]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69468766
{'0': {'precision': 0.36988318130900943, 'recall': 0.5444994110718492, 'f1-score': 0.4405183914617877, 'support': 21225}, '1': {'precision': 0.8927289085521374, 'recall': 0.7881925972350767, 'f1-score': 0.8372102024228819, 'support': 137219}, '2': {'precision': 0.3733314297951317, 'recall': 0.4761037778789258, 'f1-score': 0.41850044010562537, 'support': 21970}, 'accuracy': 0.7215182857206204, 'macro avg': {'precision': 0.5453145065520929, 'recall': 0.6029319287286173, 'f1-score': 0.565409677996765, 'support': 180414}, 'weighted avg': {'precision': 0.7679682848254489, 'recall': 0.7215182857206204, 'f1-score': 0.7395523867003805, 'support': 180414}}
[[ 11557   6272   3396]
 [ 14902 108155  14162]
 [  4786   6724  10460]]
training model: results/AAL/W10/deepOF_L2/h20
Epoch 1/50
1686/1686 - 41s - loss: 2.7057 - accuracy20: 0.5303 - val_loss: 3.3462 - val_accuracy20: 0.7068 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 2.3644 - accuracy20: 0.6196 - val_loss: 3.3555 - val_accuracy20: 0.7098 - 38s/epoch - 22ms/step
Epoch 3/50
1686/1686 - 38s - loss: 2.2469 - accuracy20: 0.6440 - val_loss: 3.3589 - val_accuracy20: 0.7224 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.2082 - accuracy20: 0.6493 - val_loss: 3.3265 - val_accuracy20: 0.7143 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.1841 - accuracy20: 0.6516 - val_loss: 3.3275 - val_accuracy20: 0.7082 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.1658 - accuracy20: 0.6535 - val_loss: 3.3837 - val_accuracy20: 0.7134 - 38s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 39s - loss: 2.1538 - accuracy20: 0.6537 - val_loss: 3.3932 - val_accuracy20: 0.7068 - 39s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.1397 - accuracy20: 0.6553 - val_loss: 3.3512 - val_accuracy20: 0.7049 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.1286 - accuracy20: 0.6557 - val_loss: 3.3846 - val_accuracy20: 0.7081 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.1199 - accuracy20: 0.6573 - val_loss: 3.3755 - val_accuracy20: 0.7107 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.1118 - accuracy20: 0.6577 - val_loss: 3.4124 - val_accuracy20: 0.7110 - 38s/epoch - 22ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.1092 - accuracy20: 0.6567 - val_loss: 3.4344 - val_accuracy20: 0.7140 - 38s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 38s - loss: 2.0980 - accuracy20: 0.6585 - val_loss: 3.3659 - val_accuracy20: 0.7091 - 38s/epoch - 23ms/step
Epoch 14/50
1686/1686 - 38s - loss: 2.0900 - accuracy20: 0.6598 - val_loss: 3.3377 - val_accuracy20: 0.7052 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h20
Evaluating performance on  test set...
10110/10110 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68355376
{'0': {'precision': 0.5315624330629801, 'recall': 0.4618958149408548, 'f1-score': 0.4942864256347107, 'support': 397581}, '1': {'precision': 0.8147806940135537, 'recall': 0.8560750054318169, 'f1-score': 0.8349175662325926, 'support': 1790377}, '2': {'precision': 0.4942739539592704, 'recall': 0.44655343906352307, 'f1-score': 0.46920345988414536, 'support': 400138}, 'accuracy': 0.7322066105739509, 'macro avg': {'precision': 0.6135390270119347, 'recall': 0.5881747531453982, 'f1-score': 0.5994691505838162, 'support': 2588096}, 'weighted avg': {'precision': 0.7217203417859582, 'recall': 0.7322066105739509, 'f1-score': 0.7260481191193088, 'support': 2588096}}
[[ 183641  168998   44942]
 [ 119799 1532697  137881]
 [  42034  179421  178683]]
Evaluating performance on  train set...
1686/1686 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62090015
{'0': {'precision': 0.5117292098811993, 'recall': 0.4678712435992483, 'f1-score': 0.48881843809386566, 'support': 58001}, '1': {'precision': 0.8466513280430734, 'recall': 0.8570391941264264, 'f1-score': 0.8518135922574712, 'support': 315583}, '2': {'precision': 0.4738240720366954, 'recall': 0.4828050084508986, 'f1-score': 0.4782723832466279, 'support': 57982}, 'accuracy': 0.7544570239546211, 'macro avg': {'precision': 0.6107348699869893, 'recall': 0.6025718153921911, 'f1-score': 0.6063014711993215, 'support': 431566}, 'weighted avg': {'precision': 0.7515486375316136, 'recall': 0.7544570239546211, 'f1-score': 0.7528420599367833, 'support': 431566}}
[[ 27137  24670   6194]
 [ 20223 270467  24893]
 [  5670  24318  27994]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7141319
{'0': {'precision': 0.479867843009113, 'recall': 0.47178297340710335, 'f1-score': 0.4757910651931315, 'support': 28015}, '1': {'precision': 0.8296653135749336, 'recall': 0.8268480909829407, 'f1-score': 0.8282543066620013, 'support': 123100}, '2': {'precision': 0.46076385438404716, 'recall': 0.4747602307245981, 'f1-score': 0.46765734265734266, 'support': 29299}, 'accuracy': 0.714534348775594, 'macro avg': {'precision': 0.5900990036560313, 'recall': 0.5911304317048808, 'f1-score': 0.5905675715041585, 'support': 180414}, 'weighted avg': {'precision': 0.7154390340692673, 'recall': 0.714534348775594, 'f1-score': 0.7149627208752948, 'support': 180414}}
[[ 13217  10422   4376]
 [  9412 101785  11903]
 [  4914  10475  13910]]
training model: results/AAL/W10/deepOF_L2/h30
Epoch 1/50
1686/1686 - 41s - loss: 2.7726 - accuracy30: 0.5207 - val_loss: 3.4071 - val_accuracy30: 0.6681 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 2.4679 - accuracy30: 0.5993 - val_loss: 3.4108 - val_accuracy30: 0.6777 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 39s - loss: 2.3581 - accuracy30: 0.6204 - val_loss: 3.3696 - val_accuracy30: 0.6827 - 39s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.3116 - accuracy30: 0.6280 - val_loss: 3.3885 - val_accuracy30: 0.6812 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.2874 - accuracy30: 0.6324 - val_loss: 3.4357 - val_accuracy30: 0.6898 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.2720 - accuracy30: 0.6335 - val_loss: 3.4178 - val_accuracy30: 0.6703 - 38s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 38s - loss: 2.2566 - accuracy30: 0.6352 - val_loss: 3.4871 - val_accuracy30: 0.6851 - 38s/epoch - 22ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.2473 - accuracy30: 0.6367 - val_loss: 3.5330 - val_accuracy30: 0.6887 - 38s/epoch - 22ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.2377 - accuracy30: 0.6367 - val_loss: 3.4600 - val_accuracy30: 0.6856 - 38s/epoch - 22ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.2270 - accuracy30: 0.6379 - val_loss: 3.5089 - val_accuracy30: 0.6837 - 38s/epoch - 22ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.2202 - accuracy30: 0.6384 - val_loss: 3.4742 - val_accuracy30: 0.6868 - 38s/epoch - 22ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.2121 - accuracy30: 0.6396 - val_loss: 3.4423 - val_accuracy30: 0.6817 - 38s/epoch - 22ms/step
Epoch 13/50
1686/1686 - 38s - loss: 2.2030 - accuracy30: 0.6416 - val_loss: 3.4960 - val_accuracy30: 0.6778 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h30
Evaluating performance on  test set...
10110/10110 - 76s - 76s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7644053
{'0': {'precision': 0.5878672625273367, 'recall': 0.39108267899162497, 'f1-score': 0.46969654763743734, 'support': 474268}, '1': {'precision': 0.7491858985320338, 'recall': 0.8596031638826935, 'f1-score': 0.8006053543748153, 'support': 1636091}, '2': {'precision': 0.5016149715577836, 'recall': 0.4151238024268583, 'f1-score': 0.4542893139388386, 'support': 477737}, 'accuracy': 0.6917003851480007, 'macro avg': {'precision': 0.6128893775390513, 'recall': 0.5552698817670589, 'f1-score': 0.5748637386503638, 'support': 2588096}, 'weighted avg': {'precision': 0.673925143598456, 'recall': 0.6917003851480007, 'f1-score': 0.67603986524169, 'support': 2588096}}
[[ 185478  235187   53603]
 [  86262 1406389  143440]
 [  43770  235647  198320]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6954593
{'0': {'precision': 0.5606335487290295, 'recall': 0.3958633197075249, 'f1-score': 0.46405642310580175, 'support': 69476}, '1': {'precision': 0.7889817235634371, 'recall': 0.8636551472120051, 'f1-score': 0.8246313980542317, 'support': 292809}, '2': {'precision': 0.488699243389743, 'recall': 0.43724830761680694, 'f1-score': 0.4615443215406649, 'support': 69281}, 'accuracy': 0.7198945236649782, 'macro avg': {'precision': 0.6127715052274032, 'recall': 0.5655889248454457, 'f1-score': 0.5834107142335662, 'support': 431566}, 'weighted avg': {'precision': 0.7040153724057717, 'recall': 0.7198945236649782, 'f1-score': 0.7082961383084372, 'support': 431566}}
[[ 27503  34835   7138]
 [ 15367 252886  24556]
 [  6187  32801  30293]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77713066
{'0': {'precision': 0.5130895876594482, 'recall': 0.41923950916527797, 'f1-score': 0.46144098177513215, 'support': 33005}, '1': {'precision': 0.768675170775898, 'recall': 0.8339309905171727, 'f1-score': 0.7999745190470124, 'support': 112941}, '2': {'precision': 0.48853381634699355, 'recall': 0.4382035511198793, 'f1-score': 0.46200198822359867, 'support': 34468}, 'accuracy': 0.6824636668994646, 'macro avg': {'precision': 0.5900995249274467, 'recall': 0.5637913502674433, 'f1-score': 0.5744724963485811, 'support': 180414}, 'weighted avg': {'precision': 0.668397396461189, 'recall': 0.6824636668994646, 'f1-score': 0.6734736012131424, 'support': 180414}}
[[13837 14321  4847]
 [ 7790 94185 10966]
 [ 5341 14023 15104]]
training model: results/AAL/W10/deepOF_L2/h50
Epoch 1/50
1686/1686 - 41s - loss: 2.8939 - accuracy50: 0.5028 - val_loss: 3.4552 - val_accuracy50: 0.6038 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 2.6373 - accuracy50: 0.5701 - val_loss: 3.5813 - val_accuracy50: 0.6139 - 38s/epoch - 22ms/step
Epoch 3/50
1686/1686 - 38s - loss: 2.5434 - accuracy50: 0.5909 - val_loss: 3.5334 - val_accuracy50: 0.6216 - 38s/epoch - 22ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.5094 - accuracy50: 0.5979 - val_loss: 3.5069 - val_accuracy50: 0.6217 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.4876 - accuracy50: 0.6011 - val_loss: 3.5379 - val_accuracy50: 0.6289 - 38s/epoch - 22ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.4699 - accuracy50: 0.6036 - val_loss: 3.5203 - val_accuracy50: 0.6278 - 38s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 38s - loss: 2.4597 - accuracy50: 0.6052 - val_loss: 3.5124 - val_accuracy50: 0.6292 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.4470 - accuracy50: 0.6068 - val_loss: 3.5459 - val_accuracy50: 0.6288 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.4381 - accuracy50: 0.6078 - val_loss: 3.5525 - val_accuracy50: 0.6293 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.4292 - accuracy50: 0.6088 - val_loss: 3.5592 - val_accuracy50: 0.6246 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.4220 - accuracy50: 0.6100 - val_loss: 3.5996 - val_accuracy50: 0.6298 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h50
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91269916
{'0': {'precision': 0.6050114612679137, 'recall': 0.2919755244459982, 'f1-score': 0.39387090674218483, 'support': 592101}, '1': {'precision': 0.6207926434197482, 'recall': 0.8533140573372658, 'f1-score': 0.718714715901628, 'support': 1397939}, '2': {'precision': 0.5029306260930763, 'recall': 0.3202358976416924, 'f1-score': 0.3913095002155564, 'support': 598056}, 'accuracy': 0.6017083601226538, 'macro avg': {'precision': 0.5762449102602459, 'recall': 0.4885084931416521, 'f1-score': 0.5012983742864564, 'support': 2588096}, 'weighted avg': {'precision': 0.589946747298583, 'recall': 0.6017083601226538, 'f1-score': 0.5687407590161552, 'support': 2588096}}
[[ 172879  358556   60666]
 [  76437 1192881  128621]
 [  36429  370108  191519]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84461874
{'0': {'precision': 0.5760887370416305, 'recall': 0.2810049425274236, 'f1-score': 0.37775049869571886, 'support': 87607}, '1': {'precision': 0.6721282187931494, 'recall': 0.8646245174760345, 'f1-score': 0.7563201589175617, 'support': 256723}, '2': {'precision': 0.4970043526499957, 'recall': 0.33377275436746295, 'f1-score': 0.3993526309653616, 'support': 87236}, 'accuracy': 0.6388455068286195, 'macro avg': {'precision': 0.5817404361615919, 'recall': 0.49313407145697363, 'f1-score': 0.5111410961928807, 'support': 431566}, 'weighted avg': {'precision': 0.617233170377219, 'recall': 0.6388455068286195, 'f1-score': 0.6073145109019786, 'support': 431566}}
[[ 24618  55194   7795]
 [ 13081 221969  21673]
 [  5034  53085  29117]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90096146
{'0': {'precision': 0.5481574742143238, 'recall': 0.2787010365118054, 'f1-score': 0.3695240582359469, 'support': 40617}, '1': {'precision': 0.6318122575169738, 'recall': 0.8567157124655789, 'f1-score': 0.7272735202274828, 'support': 97324}, '2': {'precision': 0.5103076092822451, 'recall': 0.3339533350599204, 'f1-score': 0.40371150452553084, 'support': 42473}, 'accuracy': 0.6035174653851697, 'macro avg': {'precision': 0.5634257803378476, 'recall': 0.48979002801243493, 'f1-score': 0.5001696943296535, 'support': 180414}, 'weighted avg': {'precision': 0.5843742911846639, 'recall': 0.6035174653851697, 'f1-score': 0.5705597430781529, 'support': 180414}}
[[11320 24154  5143]
 [ 5477 83379  8468]
 [ 3854 24435 14184]]
training model: results/AAL/W10/deepOF_L2/h100
Epoch 1/50
1686/1686 - 42s - loss: 3.0633 - accuracy100: 0.4709 - val_loss: 3.5352 - val_accuracy100: 0.4722 - 42s/epoch - 25ms/step
Epoch 2/50
1686/1686 - 39s - loss: 2.9019 - accuracy100: 0.5192 - val_loss: 3.5475 - val_accuracy100: 0.4929 - 39s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 39s - loss: 2.8284 - accuracy100: 0.5376 - val_loss: 3.5576 - val_accuracy100: 0.5010 - 39s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.8020 - accuracy100: 0.5432 - val_loss: 3.5713 - val_accuracy100: 0.5030 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.7871 - accuracy100: 0.5459 - val_loss: 3.5286 - val_accuracy100: 0.5089 - 38s/epoch - 22ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.7736 - accuracy100: 0.5494 - val_loss: 3.5178 - val_accuracy100: 0.5102 - 38s/epoch - 22ms/step
Epoch 7/50
1686/1686 - 39s - loss: 2.7616 - accuracy100: 0.5512 - val_loss: 3.5465 - val_accuracy100: 0.5105 - 39s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.7531 - accuracy100: 0.5536 - val_loss: 3.5824 - val_accuracy100: 0.5099 - 38s/epoch - 22ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.7458 - accuracy100: 0.5547 - val_loss: 3.5661 - val_accuracy100: 0.5094 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.7378 - accuracy100: 0.5560 - val_loss: 3.5685 - val_accuracy100: 0.5118 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.7315 - accuracy100: 0.5571 - val_loss: 3.5495 - val_accuracy100: 0.5112 - 38s/epoch - 23ms/step
Epoch 12/50
1686/1686 - 39s - loss: 2.7255 - accuracy100: 0.5582 - val_loss: 3.5422 - val_accuracy100: 0.5129 - 39s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 39s - loss: 2.7176 - accuracy100: 0.5598 - val_loss: 3.5878 - val_accuracy100: 0.5111 - 39s/epoch - 23ms/step
Epoch 14/50
1686/1686 - 39s - loss: 2.7109 - accuracy100: 0.5610 - val_loss: 3.5461 - val_accuracy100: 0.5143 - 39s/epoch - 23ms/step
Epoch 15/50
1686/1686 - 38s - loss: 2.7035 - accuracy100: 0.5624 - val_loss: 3.5744 - val_accuracy100: 0.5146 - 38s/epoch - 23ms/step
Epoch 16/50
1686/1686 - 38s - loss: 2.6999 - accuracy100: 0.5640 - val_loss: 3.5847 - val_accuracy100: 0.5147 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h100
Evaluating performance on  test set...
10110/10110 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1056215
{'0': {'precision': 0.6195032162164846, 'recall': 0.23989298149354146, 'f1-score': 0.3458578801698525, 'support': 780052}, '1': {'precision': 0.46071567368796285, 'recall': 0.8470107774422694, 'f1-score': 0.5968085154399289, 'support': 1014712}, '2': {'precision': 0.53263593948416, 'recall': 0.2823319871125834, 'f1-score': 0.36904559871483306, 'support': 793332}, 'accuracy': 0.4909338757140384, 'macro avg': {'precision': 0.5376182764628691, 'recall': 0.45641191534946474, 'f1-score': 0.43723733144153815, 'support': 2588096}, 'weighted avg': {'precision': 0.5306200313428131, 'recall': 0.4909338757140384, 'f1-score': 0.4513555820112434, 'support': 2588096}}
[[187129 497335  95588]
 [ 54293 859472 100947]
 [ 60641 508708 223983]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0086088
{'0': {'precision': 0.6082212417948993, 'recall': 0.23973973973973975, 'f1-score': 0.343918659908608, 'support': 117882}, '1': {'precision': 0.5318738998239718, 'recall': 0.843466565156706, 'f1-score': 0.6523735217625987, 'support': 197025}, '2': {'precision': 0.5216858680541218, 'recall': 0.3248870640070633, 'f1-score': 0.40041202260842007, 'support': 116659}, 'accuracy': 0.5383788342918581, 'macro avg': {'precision': 0.553927003224331, 'recall': 0.4693644563011697, 'f1-score': 0.4655680680932089, 'support': 431566}, 'weighted avg': {'precision': 0.549974148147468, 'recall': 0.5383788342918581, 'f1-score': 0.5000101461609539, 'support': 431566}}
[[ 28261  75504  14117]
 [ 10208 166184  20633]
 [  7996  70762  37901]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0510671
{'0': {'precision': 0.5655172413793104, 'recall': 0.25107451219048343, 'f1-score': 0.3477550805378851, 'support': 52582}, '1': {'precision': 0.49436630090581046, 'recall': 0.8328095277479116, 'f1-score': 0.6204346955436776, 'support': 72546}, '2': {'precision': 0.5308680934075392, 'recall': 0.3347140324856202, 'f1-score': 0.41056531771388, 'support': 55286}, 'accuracy': 0.5106255612092188, 'macro avg': {'precision': 0.5302505452308867, 'recall': 0.47286602414133844, 'f1-score': 0.45958503126514755, 'support': 180414}, 'weighted avg': {'precision': 0.5262889723848982, 'recall': 0.5106255612092188, 'f1-score': 0.47664941314357134, 'support': 180414}}
[[13202 31092  8288]
 [ 4064 60417  8065]
 [ 6079 30702 18505]]
training model: results/AAL/W10/deepOF_L2/h200
Epoch 1/50
1686/1686 - 41s - loss: 3.1696 - accuracy200: 0.4330 - val_loss: 3.3989 - val_accuracy200: 0.3609 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 3.0829 - accuracy200: 0.4615 - val_loss: 3.3688 - val_accuracy200: 0.3836 - 38s/epoch - 22ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.0432 - accuracy200: 0.4717 - val_loss: 3.3526 - val_accuracy200: 0.3946 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.0205 - accuracy200: 0.4768 - val_loss: 3.3624 - val_accuracy200: 0.4044 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 3.0067 - accuracy200: 0.4801 - val_loss: 3.3843 - val_accuracy200: 0.4044 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 38s - loss: 2.9960 - accuracy200: 0.4821 - val_loss: 3.3849 - val_accuracy200: 0.4058 - 38s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 38s - loss: 2.9883 - accuracy200: 0.4847 - val_loss: 3.3890 - val_accuracy200: 0.4102 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.9823 - accuracy200: 0.4858 - val_loss: 3.3909 - val_accuracy200: 0.4108 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 2.9772 - accuracy200: 0.4876 - val_loss: 3.3791 - val_accuracy200: 0.4126 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.9719 - accuracy200: 0.4889 - val_loss: 3.4013 - val_accuracy200: 0.4126 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.9679 - accuracy200: 0.4898 - val_loss: 3.4214 - val_accuracy200: 0.4108 - 38s/epoch - 22ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.9633 - accuracy200: 0.4917 - val_loss: 3.4216 - val_accuracy200: 0.4123 - 38s/epoch - 22ms/step
Epoch 13/50
1686/1686 - 38s - loss: 2.9582 - accuracy200: 0.4935 - val_loss: 3.4433 - val_accuracy200: 0.4127 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h200
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1699799
{'0': {'precision': 0.5877864866070764, 'recall': 0.12698666009757248, 'f1-score': 0.20885239779597242, 'support': 933665}, '1': {'precision': 0.30687777354483553, 'recall': 0.8812752667329804, 'f1-score': 0.4552339346317078, 'support': 704731}, '2': {'precision': 0.5053588764838268, 'recall': 0.19293566389386121, 'f1-score': 0.2792568026848011, 'support': 949700}, 'accuracy': 0.3565771903360617, 'macro avg': {'precision': 0.4666743788785796, 'recall': 0.400399196908138, 'f1-score': 0.3144477117041604, 'support': 2588096}, 'weighted avg': {'precision': 0.48104910916855936, 'recall': 0.3565771903360617, 'f1-score': 0.3017762190756719, 'support': 2588096}}
[[118563 697012 118090]
 [ 22414 621062  61255]
 [ 60734 705735 183231]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050285
{'0': {'precision': 0.5766081453141202, 'recall': 0.11179822797798145, 'f1-score': 0.18728405600171882, 'support': 144242}, '1': {'precision': 0.377922668948798, 'recall': 0.9068550353362957, 'f1-score': 0.5335103094657987, 'support': 145601}, '2': {'precision': 0.5094064701759563, 'recall': 0.1948801535389457, 'f1-score': 0.28191139169443863, 'support': 141723}, 'accuracy': 0.4073166097421947, 'macro avg': {'precision': 0.48797909481295815, 'recall': 0.40451113895107427, 'f1-score': 0.3342352523873187, 'support': 431566}, 'weighted avg': {'precision': 0.48750745839746484, 'recall': 0.4073166097421947, 'f1-score': 0.3351681771488964, 'support': 431566}}
[[ 16126 111318  16798]
 [  3761 132039   9801]
 [  8080 106024  27619]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1141905
{'0': {'precision': 0.5334714056654195, 'recall': 0.1298416208657192, 'f1-score': 0.20885099259801743, 'support': 61498}, '1': {'precision': 0.3531209334288597, 'recall': 0.8936540240518038, 'f1-score': 0.5062147603177598, 'support': 54050}, '2': {'precision': 0.5198534542916957, 'recall': 0.22968889711096724, 'f1-score': 0.3186065906806664, 'support': 64866}, 'accuracy': 0.39457026616559693, 'macro avg': {'precision': 0.4688152644619916, 'recall': 0.4177281806761634, 'f1-score': 0.3445574478654812, 'support': 180414}, 'weighted avg': {'precision': 0.47454424337095225, 'recall': 0.39457026616559693, 'f1-score': 0.3373993218323406, 'support': 180414}}
[[ 7985 43779  9734]
 [ 1721 48302  4027]
 [ 5262 44705 14899]]
training model: results/AAL/W10/deepOF_L2/h300
Epoch 1/50
1686/1686 - 41s - loss: 3.2213 - accuracy300: 0.4076 - val_loss: 3.3933 - val_accuracy300: 0.3364 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 3.1671 - accuracy300: 0.4298 - val_loss: 3.3542 - val_accuracy300: 0.3499 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.1438 - accuracy300: 0.4378 - val_loss: 3.3385 - val_accuracy300: 0.3581 - 38s/epoch - 22ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.1305 - accuracy300: 0.4420 - val_loss: 3.3401 - val_accuracy300: 0.3632 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 38s - loss: 3.1196 - accuracy300: 0.4446 - val_loss: 3.3480 - val_accuracy300: 0.3682 - 38s/epoch - 22ms/step
Epoch 6/50
1686/1686 - 38s - loss: 3.1111 - accuracy300: 0.4466 - val_loss: 3.3630 - val_accuracy300: 0.3730 - 38s/epoch - 22ms/step
Epoch 7/50
1686/1686 - 38s - loss: 3.1054 - accuracy300: 0.4486 - val_loss: 3.3656 - val_accuracy300: 0.3774 - 38s/epoch - 22ms/step
Epoch 8/50
1686/1686 - 38s - loss: 3.0994 - accuracy300: 0.4510 - val_loss: 3.3744 - val_accuracy300: 0.3768 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 3.0953 - accuracy300: 0.4529 - val_loss: 3.3746 - val_accuracy300: 0.3790 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 39s - loss: 3.0921 - accuracy300: 0.4533 - val_loss: 3.4358 - val_accuracy300: 0.3734 - 39s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 3.0886 - accuracy300: 0.4552 - val_loss: 3.3794 - val_accuracy300: 0.3842 - 38s/epoch - 23ms/step
Epoch 12/50
1686/1686 - 38s - loss: 3.0843 - accuracy300: 0.4562 - val_loss: 3.3654 - val_accuracy300: 0.3889 - 38s/epoch - 22ms/step
Epoch 13/50
1686/1686 - 38s - loss: 3.0821 - accuracy300: 0.4574 - val_loss: 3.3920 - val_accuracy300: 0.3868 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h300
Evaluating performance on  test set...
10110/10110 - 75s - 75s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.168773
{'0': {'precision': 0.5535972242381515, 'recall': 0.0831095495824548, 'f1-score': 0.1445224641806409, 'support': 963728}, '1': {'precision': 0.27180242556426976, 'recall': 0.9161017289721071, 'f1-score': 0.4192235056125733, 'support': 646974}, '2': {'precision': 0.4938795855545282, 'recall': 0.13279803231859413, 'f1-score': 0.2093141203496524, 'support': 977394}, 'accuracy': 0.31010634845075297, 'macro avg': {'precision': 0.43975974511898314, 'recall': 0.3773364369577186, 'f1-score': 0.25768669671428884, 'support': 2588096}, 'weighted avg': {'precision': 0.4606016128617661, 'recall': 0.31010634845075297, 'f1-score': 0.23766097510490258, 'support': 2588096}}
[[ 80095 788938  94695]
 [ 15962 592694  38318]
 [ 48624 798974 129796]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1189016
{'0': {'precision': 0.5441802872709262, 'recall': 0.07378629040381994, 'f1-score': 0.1299521565055916, 'support': 148903}, '1': {'precision': 0.3442139518688648, 'recall': 0.9416876721964945, 'f1-score': 0.5041474853234529, 'support': 136472}, '2': {'precision': 0.5002761631729834, 'recall': 0.13011060872420327, 'f1-score': 0.20651206218921675, 'support': 146191}, 'accuracy': 0.3673180927135131, 'macro avg': {'precision': 0.46289013410425817, 'recall': 0.38186152377483923, 'f1-score': 0.2802039013394204, 'support': 431566}, 'weighted avg': {'precision': 0.4660735932056094, 'recall': 0.3673180927135131, 'f1-score': 0.2742164268286152, 'support': 431566}}
[[ 10987 124325  13591]
 [  2549 128514   5409]
 [  6654 120516  19021]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1236945
{'0': {'precision': 0.5047882136279926, 'recall': 0.08800488024144353, 'f1-score': 0.14987970253718286, 'support': 62292}, '1': {'precision': 0.32410201466070837, 'recall': 0.92005467005467, 'f1-score': 0.4793472973718389, 'support': 51948}, '2': {'precision': 0.5091238397102106, 'recall': 0.16991567685193582, 'f1-score': 0.25479554493026213, 'support': 66174}, 'accuracy': 0.35762745684924674, 'macro avg': {'precision': 0.44600468933297055, 'recall': 0.39265840904934984, 'f1-score': 0.2946741816130946, 'support': 180414}, 'weighted avg': {'precision': 0.45435210033530027, 'recall': 0.35762745684924674, 'f1-score': 0.28322791038685274, 'support': 180414}}
[[ 5482 48834  7976]
 [ 1288 47795  2865]
 [ 4090 50840 11244]]
training model: results/AAL/W10/deepOF_L2/h500
Epoch 1/50
1686/1686 - 42s - loss: 3.2708 - accuracy500: 0.3827 - val_loss: 3.5130 - val_accuracy500: 0.3046 - 42s/epoch - 25ms/step
Epoch 2/50
1686/1686 - 38s - loss: 3.2453 - accuracy500: 0.3959 - val_loss: 3.5095 - val_accuracy500: 0.3056 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.2325 - accuracy500: 0.4022 - val_loss: 3.5084 - val_accuracy500: 0.3066 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.2238 - accuracy500: 0.4068 - val_loss: 3.5130 - val_accuracy500: 0.3065 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 38s - loss: 3.2178 - accuracy500: 0.4102 - val_loss: 3.5125 - val_accuracy500: 0.3064 - 38s/epoch - 22ms/step
Epoch 6/50
1686/1686 - 38s - loss: 3.2122 - accuracy500: 0.4124 - val_loss: 3.5173 - val_accuracy500: 0.3066 - 38s/epoch - 22ms/step
Epoch 7/50
1686/1686 - 38s - loss: 3.2073 - accuracy500: 0.4140 - val_loss: 3.5353 - val_accuracy500: 0.3072 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 3.2036 - accuracy500: 0.4162 - val_loss: 3.5549 - val_accuracy500: 0.3075 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 3.1996 - accuracy500: 0.4172 - val_loss: 3.5879 - val_accuracy500: 0.3074 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 3.1960 - accuracy500: 0.4193 - val_loss: 3.5816 - val_accuracy500: 0.3084 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 39s - loss: 3.1930 - accuracy500: 0.4208 - val_loss: 3.5880 - val_accuracy500: 0.3085 - 39s/epoch - 23ms/step
Epoch 12/50
1686/1686 - 38s - loss: 3.1898 - accuracy500: 0.4224 - val_loss: 3.5690 - val_accuracy500: 0.3108 - 38s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 38s - loss: 3.1861 - accuracy500: 0.4243 - val_loss: 3.5690 - val_accuracy500: 0.3128 - 38s/epoch - 22ms/step
testing model: results/AAL/W10/deepOF_L2/h500
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2130164
{'0': {'precision': 0.41382549593855333, 'recall': 0.007954488725741678, 'f1-score': 0.015608944765303083, 'support': 941481}, '1': {'precision': 0.2648750195937484, 'recall': 0.9779308712052015, 'f1-score': 0.4168462035616673, 'support': 684259}, '2': {'precision': 0.41226564109607855, 'recall': 0.018713449077056722, 'f1-score': 0.035801792972240634, 'support': 962356}, 'accuracy': 0.26840426321125643, 'macro avg': {'precision': 0.3636553855427935, 'recall': 0.33486626966933325, 'f1-score': 0.156085647099737, 'support': 2588096}, 'weighted avg': {'precision': 0.3738649072818711, 'recall': 0.26840426321125643, 'f1-score': 0.12919936571405344, 'support': 2588096}}
[[  7489 918985  15007]
 [  4434 669158  10667]
 [  6174 938173  18009]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1643125
{'0': {'precision': 0.4250077954474587, 'recall': 0.009228602574258766, 'f1-score': 0.018064943671305497, 'support': 147693}, '1': {'precision': 0.3211504718546972, 'recall': 0.9812717801589544, 'f1-score': 0.48392277501174596, 'support': 138027}, '2': {'precision': 0.41667925668529987, 'recall': 0.01891035750037711, 'f1-score': 0.03617879513330929, 'support': 145846}, 'accuracy': 0.32338738454836574, 'macro avg': {'precision': 0.3876125079958186, 'recall': 0.33647024674453013, 'f1-score': 0.1793888379387869, 'support': 431566}, 'weighted avg': {'precision': 0.3889766927474223, 'recall': 0.32338738454836574, 'f1-score': 0.17318094369622494, 'support': 431566}}
[[  1363 144205   2125]
 [   849 135442   1736]
 [   995 142093   2758]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1799746
{'0': {'precision': 0.38583175205566095, 'recall': 0.010082977949684288, 'f1-score': 0.019652378421044156, 'support': 60498}, '1': {'precision': 0.3038489354069029, 'recall': 0.9778795931457894, 'f1-score': 0.4636358896824983, 'support': 54565}, '2': {'precision': 0.4200247985120893, 'recall': 0.0207341892243424, 'f1-score': 0.03951762252650306, 'support': 65351}, 'accuracy': 0.30664471715055375, 'macro avg': {'precision': 0.3699018286582177, 'recall': 0.3362322534399387, 'f1-score': 0.17426863021001518, 'support': 180414}, 'weighted avg': {'precision': 0.3734222793347777, 'recall': 0.30664471715055375, 'f1-score': 0.1611279504914882, 'support': 180414}}
[[  610 58829  1059]
 [  395 53358   812]
 [  576 63420  1355]]
training model: results/AAL/W10/deepOF_L2/h1000
Epoch 1/50
1686/1686 - 41s - loss: 3.2204 - accuracy1000: 0.4139 - val_loss: 3.3749 - val_accuracy1000: 0.3291 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 38s - loss: 3.2111 - accuracy1000: 0.4120 - val_loss: 3.3214 - val_accuracy1000: 0.3197 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.2112 - accuracy1000: 0.4121 - val_loss: 3.3221 - val_accuracy1000: 0.3295 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.1955 - accuracy1000: 0.4169 - val_loss: 3.3082 - val_accuracy1000: 0.3296 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 3.1997 - accuracy1000: 0.4168 - val_loss: 3.3053 - val_accuracy1000: 0.3351 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 38s - loss: 3.1964 - accuracy1000: 0.4209 - val_loss: 3.3115 - val_accuracy1000: 0.3348 - 38s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 38s - loss: 3.1916 - accuracy1000: 0.4234 - val_loss: 3.3201 - val_accuracy1000: 0.3360 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 3.1852 - accuracy1000: 0.4263 - val_loss: 3.3251 - val_accuracy1000: 0.3347 - 38s/epoch - 22ms/step
Epoch 9/50
1686/1686 - 38s - loss: 3.1801 - accuracy1000: 0.4283 - val_loss: 3.3260 - val_accuracy1000: 0.3358 - 38s/epoch - 22ms/step
Epoch 10/50
1686/1686 - 38s - loss: 3.1743 - accuracy1000: 0.4317 - val_loss: 3.3281 - val_accuracy1000: 0.3366 - 38s/epoch - 22ms/step
Epoch 11/50
1686/1686 - 38s - loss: 3.1682 - accuracy1000: 0.4340 - val_loss: 3.3202 - val_accuracy1000: 0.3400 - 38s/epoch - 23ms/step
Epoch 12/50
1686/1686 - 38s - loss: 3.1660 - accuracy1000: 0.4354 - val_loss: 3.3232 - val_accuracy1000: 0.3380 - 38s/epoch - 22ms/step
Epoch 13/50
1686/1686 - 38s - loss: 3.1662 - accuracy1000: 0.4348 - val_loss: 3.3156 - val_accuracy1000: 0.3417 - 38s/epoch - 23ms/step
Epoch 14/50
1686/1686 - 38s - loss: 3.1583 - accuracy1000: 0.4381 - val_loss: 3.3220 - val_accuracy1000: 0.3390 - 38s/epoch - 23ms/step
Epoch 15/50
1686/1686 - 38s - loss: 3.1568 - accuracy1000: 0.4387 - val_loss: 3.3230 - val_accuracy1000: 0.3391 - 38s/epoch - 23ms/step
testing model: results/AAL/W10/deepOF_L2/h1000
Evaluating performance on  test set...
10110/10110 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1136981
{'0': {'precision': 0.41927478628143533, 'recall': 0.44354961444805197, 'f1-score': 0.43107072457776974, 'support': 1025024}, '1': {'precision': 0.20194824845339104, 'recall': 0.5103829643871582, 'f1-score': 0.289390507787584, 'support': 516471}, '2': {'precision': 0.42550554041047917, 'recall': 0.08068213196815215, 'f1-score': 0.13564413373899245, 'support': 1046601}, 'accuracy': 0.3101465324315636, 'macro avg': {'precision': 0.34890952504843514, 'recall': 0.3448715702677874, 'f1-score': 0.2853684553681154, 'support': 2588096}, 'weighted avg': {'precision': 0.3784255516253884, 'recall': 0.3101465324315636, 'f1-score': 0.2833298800942965, 'support': 2588096}}
[[454649 493700  76675]
 [215539 263598  37334]
 [414182 547977  84442]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975782
{'0': {'precision': 0.3681021934729708, 'recall': 0.44811378843233035, 'f1-score': 0.4041863234835839, 'support': 146166}, '1': {'precision': 0.3358908250355619, 'recall': 0.5283169258306298, 'f1-score': 0.41068089916952916, 'support': 143024}, '2': {'precision': 0.3707140116502145, 'recall': 0.07464741248525032, 'f1-score': 0.12427139056973312, 'support': 142376}, 'accuracy': 0.35148505674682434, 'macro avg': {'precision': 0.3582356767195824, 'recall': 0.35035937558273683, 'f1-score': 0.3130462044076154, 'support': 431566}, 'weighted avg': {'precision': 0.358288773197535, 'recall': 0.35148505674682434, 'f1-score': 0.3139931935900432, 'support': 431566}}
[[65499 71051  9616]
 [59037 75562  8425]
 [53401 78347 10628]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011871
{'0': {'precision': 0.3386802920507938, 'recall': 0.429706102160349, 'f1-score': 0.37880157502030054, 'support': 57537}, '1': {'precision': 0.3194532048633012, 'recall': 0.4996258121577032, 'f1-score': 0.38972324674290865, 'support': 58794}, '2': {'precision': 0.411669577592341, 'recall': 0.0993087090179923, 'f1-score': 0.16001609212742954, 'support': 64083}, 'accuracy': 0.3351347456405822, 'macro avg': {'precision': 0.3566010248354787, 'recall': 0.3428802077786815, 'f1-score': 0.30951363796354625, 'support': 180414}, 'weighted avg': {'precision': 0.35834026866711804, 'recall': 0.3351347456405822, 'f1-score': 0.30464823141634056, 'support': 180414}}
[[24724 27881  4932]
 [25256 29375  4163]
 [23021 34698  6364]]
training model: results/AAL/W10/deepVOL_L2/h10
Epoch 1/50
1686/1686 - 43s - loss: 2.6758 - accuracy10: 0.5320 - val_loss: 3.1582 - val_accuracy10: 0.6418 - 43s/epoch - 26ms/step
Epoch 2/50
1686/1686 - 43s - loss: 2.3817 - accuracy10: 0.6104 - val_loss: 3.0123 - val_accuracy10: 0.6300 - 43s/epoch - 25ms/step
Epoch 3/50
1686/1686 - 43s - loss: 2.2934 - accuracy10: 0.6354 - val_loss: 3.1214 - val_accuracy10: 0.6707 - 43s/epoch - 26ms/step
Epoch 4/50
1686/1686 - 42s - loss: 2.2467 - accuracy10: 0.6453 - val_loss: 3.0374 - val_accuracy10: 0.6459 - 42s/epoch - 25ms/step
Epoch 5/50
1686/1686 - 40s - loss: 2.2131 - accuracy10: 0.6559 - val_loss: 2.9856 - val_accuracy10: 0.6677 - 40s/epoch - 24ms/step
Epoch 6/50
1686/1686 - 37s - loss: 2.1884 - accuracy10: 0.6605 - val_loss: 3.0078 - val_accuracy10: 0.6277 - 37s/epoch - 22ms/step
Epoch 7/50
1686/1686 - 41s - loss: 2.1609 - accuracy10: 0.6679 - val_loss: 3.0468 - val_accuracy10: 0.6871 - 41s/epoch - 24ms/step
Epoch 8/50
1686/1686 - 40s - loss: 2.1407 - accuracy10: 0.6717 - val_loss: 3.0143 - val_accuracy10: 0.6544 - 40s/epoch - 24ms/step
Epoch 9/50
1686/1686 - 39s - loss: 2.1270 - accuracy10: 0.6734 - val_loss: 3.0585 - val_accuracy10: 0.6872 - 39s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 40s - loss: 2.1084 - accuracy10: 0.6759 - val_loss: 3.0156 - val_accuracy10: 0.6782 - 40s/epoch - 24ms/step
Epoch 11/50
1686/1686 - 40s - loss: 2.0928 - accuracy10: 0.6782 - val_loss: 3.0286 - val_accuracy10: 0.6734 - 40s/epoch - 24ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.0825 - accuracy10: 0.6809 - val_loss: 3.0743 - val_accuracy10: 0.6843 - 38s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 42s - loss: 2.0718 - accuracy10: 0.6823 - val_loss: 2.9912 - val_accuracy10: 0.6697 - 42s/epoch - 25ms/step
Epoch 14/50
1686/1686 - 36s - loss: 2.0629 - accuracy10: 0.6834 - val_loss: 2.9974 - val_accuracy10: 0.6616 - 36s/epoch - 22ms/step
Epoch 15/50
1686/1686 - 37s - loss: 2.0528 - accuracy10: 0.6841 - val_loss: 2.9802 - val_accuracy10: 0.6720 - 37s/epoch - 22ms/step
Epoch 16/50
1686/1686 - 37s - loss: 2.0435 - accuracy10: 0.6845 - val_loss: 3.0232 - val_accuracy10: 0.6818 - 37s/epoch - 22ms/step
Epoch 17/50
1686/1686 - 39s - loss: 2.0374 - accuracy10: 0.6849 - val_loss: 2.9933 - val_accuracy10: 0.6737 - 39s/epoch - 23ms/step
Epoch 18/50
1686/1686 - 38s - loss: 2.0296 - accuracy10: 0.6851 - val_loss: 2.9898 - val_accuracy10: 0.6764 - 38s/epoch - 23ms/step
Epoch 19/50
1686/1686 - 38s - loss: 2.0223 - accuracy10: 0.6865 - val_loss: 3.0012 - val_accuracy10: 0.6648 - 38s/epoch - 22ms/step
Epoch 20/50
1686/1686 - 41s - loss: 2.0159 - accuracy10: 0.6863 - val_loss: 2.9841 - val_accuracy10: 0.6667 - 41s/epoch - 24ms/step
Epoch 21/50
1686/1686 - 39s - loss: 2.0100 - accuracy10: 0.6882 - val_loss: 3.0213 - val_accuracy10: 0.6679 - 39s/epoch - 23ms/step
Epoch 22/50
1686/1686 - 41s - loss: 2.0041 - accuracy10: 0.6877 - val_loss: 3.0022 - val_accuracy10: 0.6647 - 41s/epoch - 24ms/step
Epoch 23/50
1686/1686 - 39s - loss: 1.9962 - accuracy10: 0.6887 - val_loss: 2.9970 - val_accuracy10: 0.6738 - 39s/epoch - 23ms/step
Epoch 24/50
1686/1686 - 38s - loss: 1.9946 - accuracy10: 0.6890 - val_loss: 3.0595 - val_accuracy10: 0.6809 - 38s/epoch - 22ms/step
Epoch 25/50
1686/1686 - 40s - loss: 1.9905 - accuracy10: 0.6891 - val_loss: 2.9878 - val_accuracy10: 0.6552 - 40s/epoch - 24ms/step
testing model: results/AAL/W10/deepVOL_L2/h10
Evaluating performance on  test set...
10110/10110 - 97s - 97s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65725374
{'0': {'precision': 0.38428630867017227, 'recall': 0.597529207316024, 'f1-score': 0.46775038622493575, 'support': 290595}, '1': {'precision': 0.9034472031690045, 'recall': 0.7628787878787879, 'f1-score': 0.8272339397798945, 'support': 2002440}, '2': {'precision': 0.3752208812798204, 'recall': 0.566361424223733, 'f1-score': 0.4513904551476755, 'support': 295066}, 'accuracy': 0.7219084572047227, 'macro avg': {'precision': 0.5543181310396658, 'recall': 0.642256473139515, 'f1-score': 0.5821249270508352, 'support': 2588101}, 'weighted avg': {'precision': 0.7849328221493139, 'recall': 0.7219084572047227, 'f1-score': 0.744021284291645, 'support': 2588101}}
[[ 173639   83187   33769]
 [ 230329 1527619  244492]
 [  47880   80072  167114]]
Evaluating performance on  train set...
1686/1686 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62828684
{'0': {'precision': 0.3517516862026063, 'recall': 0.6299371423210433, 'f1-score': 0.4514290996798077, 'support': 42636}, '1': {'precision': 0.9242867334901496, 'recall': 0.7555548498111813, 'f1-score': 0.8314466447867983, 'support': 346364}, '2': {'precision': 0.35086502309965456, 'recall': 0.5941082503288856, 'f1-score': 0.4411803187174545, 'support': 42568}, 'accuracy': 0.7272202758313869, 'macro avg': {'precision': 0.5423011475974702, 'recall': 0.6598667474870367, 'f1-score': 0.5746853543946868, 'support': 431568}, 'weighted avg': {'precision': 0.8111643063313835, 'recall': 0.7272202758313869, 'f1-score': 0.7554092995218539, 'support': 431568}}
[[ 26858  10813   4965]
 [ 42843 261697  41824]
 [  6654  10624  25290]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7585579
{'0': {'precision': 0.33372996784728726, 'recall': 0.6210308112691981, 'f1-score': 0.4341539728283244, 'support': 21226}, '1': {'precision': 0.9090173454427752, 'recall': 0.6963049930358562, 'f1-score': 0.788568502681967, 'support': 137131}, '2': {'precision': 0.34769882641540995, 'recall': 0.56548941379154, 'f1-score': 0.4306231658898671, 'support': 22057}, 'accuracy': 0.671455652000399, 'macro avg': {'precision': 0.5301487132351574, 'recall': 0.6276084060321981, 'f1-score': 0.5511152138000529, 'support': 180414}, 'weighted avg': {'precision': 0.772708342532644, 'recall': 0.671455652000399, 'f1-score': 0.7031094856195619, 'support': 180414}}
[[13182  4747  3297]
 [21543 95485 20103]
 [ 4774  4810 12473]]
training model: results/AAL/W10/deepVOL_L2/h20
Epoch 1/50
1686/1686 - 42s - loss: 2.7583 - accuracy20: 0.5293 - val_loss: 3.2559 - val_accuracy20: 0.5802 - 42s/epoch - 25ms/step
Epoch 2/50
1686/1686 - 42s - loss: 2.5297 - accuracy20: 0.5852 - val_loss: 3.2522 - val_accuracy20: 0.6331 - 42s/epoch - 25ms/step
Epoch 3/50
1686/1686 - 42s - loss: 2.4350 - accuracy20: 0.6086 - val_loss: 3.1203 - val_accuracy20: 0.6070 - 42s/epoch - 25ms/step
Epoch 4/50
1686/1686 - 42s - loss: 2.3785 - accuracy20: 0.6250 - val_loss: 3.1630 - val_accuracy20: 0.6335 - 42s/epoch - 25ms/step
Epoch 5/50
1686/1686 - 40s - loss: 2.3415 - accuracy20: 0.6340 - val_loss: 3.1415 - val_accuracy20: 0.6294 - 40s/epoch - 24ms/step
Epoch 6/50
1686/1686 - 41s - loss: 2.3177 - accuracy20: 0.6390 - val_loss: 3.1223 - val_accuracy20: 0.6458 - 41s/epoch - 24ms/step
Epoch 7/50
1686/1686 - 39s - loss: 2.2963 - accuracy20: 0.6432 - val_loss: 3.1450 - val_accuracy20: 0.6500 - 39s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 40s - loss: 2.2771 - accuracy20: 0.6463 - val_loss: 3.1194 - val_accuracy20: 0.6518 - 40s/epoch - 24ms/step
Epoch 9/50
1686/1686 - 41s - loss: 2.2548 - accuracy20: 0.6490 - val_loss: 3.1930 - val_accuracy20: 0.6542 - 41s/epoch - 24ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.2421 - accuracy20: 0.6503 - val_loss: 3.1472 - val_accuracy20: 0.6461 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 2.2248 - accuracy20: 0.6524 - val_loss: 3.1945 - val_accuracy20: 0.6568 - 38s/epoch - 22ms/step
Epoch 12/50
1686/1686 - 39s - loss: 2.2160 - accuracy20: 0.6527 - val_loss: 3.1740 - val_accuracy20: 0.6614 - 39s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 41s - loss: 2.2032 - accuracy20: 0.6539 - val_loss: 3.1784 - val_accuracy20: 0.6775 - 41s/epoch - 24ms/step
Epoch 14/50
1686/1686 - 38s - loss: 2.1914 - accuracy20: 0.6556 - val_loss: 3.1858 - val_accuracy20: 0.6630 - 38s/epoch - 22ms/step
Epoch 15/50
1686/1686 - 42s - loss: 2.1838 - accuracy20: 0.6561 - val_loss: 3.1548 - val_accuracy20: 0.6746 - 42s/epoch - 25ms/step
Epoch 16/50
1686/1686 - 38s - loss: 2.1733 - accuracy20: 0.6583 - val_loss: 3.2030 - val_accuracy20: 0.6685 - 38s/epoch - 23ms/step
Epoch 17/50
1686/1686 - 36s - loss: 2.1675 - accuracy20: 0.6572 - val_loss: 3.1893 - val_accuracy20: 0.6703 - 36s/epoch - 22ms/step
Epoch 18/50
1686/1686 - 38s - loss: 2.1557 - accuracy20: 0.6593 - val_loss: 3.1571 - val_accuracy20: 0.6667 - 38s/epoch - 22ms/step
testing model: results/AAL/W10/deepVOL_L2/h20
Evaluating performance on  test set...
10110/10110 - 94s - 94s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7164676
{'0': {'precision': 0.4390113311644852, 'recall': 0.5691929252686225, 'f1-score': 0.4956974585599054, 'support': 397584}, '1': {'precision': 0.8297147264939814, 'recall': 0.776224225400572, 'f1-score': 0.8020786470325634, 'support': 1790377}, '2': {'precision': 0.45625474644550956, 'recall': 0.4534337981706403, 'f1-score': 0.45483989842142075, 'support': 400140}, 'accuracy': 0.6945142403638807, 'macro avg': {'precision': 0.574993601367992, 'recall': 0.5996169829466116, 'f1-score': 0.5842053346712965, 'support': 2588101}, 'weighted avg': {'precision': 0.7119551432531117, 'recall': 0.6945142403638807, 'f1-score': 0.7013266395541166, 'support': 2588101}}
[[ 226302  136193   35089]
 [ 219503 1389734  181140]
 [  69676  149027  181437]]
Evaluating performance on  train set...
1686/1686 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6834469
{'0': {'precision': 0.3966609423512152, 'recall': 0.6007233895969687, 'f1-score': 0.47781682181534224, 'support': 58060}, '1': {'precision': 0.8638086180935296, 'recall': 0.7598043098722754, 'f1-score': 0.8084753448650799, 'support': 315601}, '2': {'precision': 0.4239592955464361, 'recall': 0.4834821351477369, 'f1-score': 0.4517685406312528, 'support': 57907}, 'accuracy': 0.7013263263263263, 'macro avg': {'precision': 0.5614762853303937, 'recall': 0.6146699448723271, 'f1-score': 0.5793535691038917, 'support': 431568}, 'weighted avg': {'precision': 0.7419438163141268, 'recall': 0.7013263263263263, 'f1-score': 0.7161287047966874, 'support': 431568}}
[[ 34878  17964   5218]
 [ 42984 239795  32822]
 [ 10067  19843  27997]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7960449
{'0': {'precision': 0.37574663744574793, 'recall': 0.6240810791520948, 'f1-score': 0.4690735475564616, 'support': 28022}, '1': {'precision': 0.8423718452536897, 'recall': 0.7057532375679828, 'f1-score': 0.7680343967301874, 'support': 123009}, '2': {'precision': 0.424788238730406, 'recall': 0.44546166150495187, 'f1-score': 0.43487939397966646, 'support': 29383}, 'accuracy': 0.6506756681853958, 'macro avg': {'precision': 0.5476355738099479, 'recall': 0.5917653260750099, 'f1-score': 0.5573291127554384, 'support': 180414}, 'weighted avg': {'precision': 0.7018859035658617, 'recall': 0.6506756681853958, 'f1-score': 0.6673405793913738, 'support': 180414}}
[[17488  7525  3009]
 [21480 86814 14715]
 [ 7574  8720 13089]]
training model: results/AAL/W10/deepVOL_L2/h30
Epoch 1/50
1686/1686 - 41s - loss: 2.8431 - accuracy30: 0.5063 - val_loss: 3.3127 - val_accuracy30: 0.5689 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 41s - loss: 2.6075 - accuracy30: 0.5741 - val_loss: 3.1990 - val_accuracy30: 0.6005 - 41s/epoch - 24ms/step
Epoch 3/50
1686/1686 - 41s - loss: 2.5038 - accuracy30: 0.5970 - val_loss: 3.1780 - val_accuracy30: 0.5945 - 41s/epoch - 24ms/step
Epoch 4/50
1686/1686 - 38s - loss: 2.4643 - accuracy30: 0.6073 - val_loss: 3.1855 - val_accuracy30: 0.6391 - 38s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 40s - loss: 2.4288 - accuracy30: 0.6164 - val_loss: 3.1625 - val_accuracy30: 0.6266 - 40s/epoch - 24ms/step
Epoch 6/50
1686/1686 - 36s - loss: 2.4076 - accuracy30: 0.6202 - val_loss: 3.1639 - val_accuracy30: 0.6274 - 36s/epoch - 21ms/step
Epoch 7/50
1686/1686 - 38s - loss: 2.3871 - accuracy30: 0.6233 - val_loss: 3.1831 - val_accuracy30: 0.6379 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 38s - loss: 2.3726 - accuracy30: 0.6254 - val_loss: 3.2024 - val_accuracy30: 0.6353 - 38s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 39s - loss: 2.3563 - accuracy30: 0.6276 - val_loss: 3.1321 - val_accuracy30: 0.6448 - 39s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 39s - loss: 2.3451 - accuracy30: 0.6286 - val_loss: 3.1685 - val_accuracy30: 0.6455 - 39s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 41s - loss: 2.3318 - accuracy30: 0.6307 - val_loss: 3.1570 - val_accuracy30: 0.6475 - 41s/epoch - 24ms/step
Epoch 12/50
1686/1686 - 38s - loss: 2.3205 - accuracy30: 0.6318 - val_loss: 3.1630 - val_accuracy30: 0.6493 - 38s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 41s - loss: 2.3106 - accuracy30: 0.6336 - val_loss: 3.1317 - val_accuracy30: 0.6420 - 41s/epoch - 24ms/step
Epoch 14/50
1686/1686 - 38s - loss: 2.2983 - accuracy30: 0.6351 - val_loss: 3.1332 - val_accuracy30: 0.6429 - 38s/epoch - 23ms/step
Epoch 15/50
1686/1686 - 38s - loss: 2.2895 - accuracy30: 0.6364 - val_loss: 3.1107 - val_accuracy30: 0.6443 - 38s/epoch - 23ms/step
Epoch 16/50
1686/1686 - 37s - loss: 2.2811 - accuracy30: 0.6378 - val_loss: 3.1143 - val_accuracy30: 0.6407 - 37s/epoch - 22ms/step
Epoch 17/50
1686/1686 - 40s - loss: 2.2751 - accuracy30: 0.6393 - val_loss: 3.1020 - val_accuracy30: 0.6477 - 40s/epoch - 24ms/step
Epoch 18/50
1686/1686 - 39s - loss: 2.2691 - accuracy30: 0.6392 - val_loss: 3.1087 - val_accuracy30: 0.6443 - 39s/epoch - 23ms/step
Epoch 19/50
1686/1686 - 38s - loss: 2.2594 - accuracy30: 0.6404 - val_loss: 3.1135 - val_accuracy30: 0.6446 - 38s/epoch - 23ms/step
Epoch 20/50
1686/1686 - 37s - loss: 2.2529 - accuracy30: 0.6409 - val_loss: 3.0371 - val_accuracy30: 0.6393 - 37s/epoch - 22ms/step
Epoch 21/50
1686/1686 - 41s - loss: 2.2471 - accuracy30: 0.6411 - val_loss: 3.1667 - val_accuracy30: 0.6536 - 41s/epoch - 24ms/step
Epoch 22/50
1686/1686 - 40s - loss: 2.2413 - accuracy30: 0.6419 - val_loss: 3.1442 - val_accuracy30: 0.6576 - 40s/epoch - 24ms/step
Epoch 23/50
1686/1686 - 39s - loss: 2.2359 - accuracy30: 0.6415 - val_loss: 3.1530 - val_accuracy30: 0.6473 - 39s/epoch - 23ms/step
Epoch 24/50
1686/1686 - 39s - loss: 2.2313 - accuracy30: 0.6435 - val_loss: 3.1740 - val_accuracy30: 0.6454 - 39s/epoch - 23ms/step
Epoch 25/50
1686/1686 - 39s - loss: 2.2244 - accuracy30: 0.6438 - val_loss: 3.2798 - val_accuracy30: 0.6553 - 39s/epoch - 23ms/step
Epoch 26/50
1686/1686 - 39s - loss: 2.2205 - accuracy30: 0.6442 - val_loss: 3.1847 - val_accuracy30: 0.6547 - 39s/epoch - 23ms/step
Epoch 27/50
1686/1686 - 37s - loss: 2.2119 - accuracy30: 0.6442 - val_loss: 3.1847 - val_accuracy30: 0.6460 - 37s/epoch - 22ms/step
Epoch 28/50
1686/1686 - 39s - loss: 2.2060 - accuracy30: 0.6443 - val_loss: 3.2020 - val_accuracy30: 0.6444 - 39s/epoch - 23ms/step
Epoch 29/50
1686/1686 - 37s - loss: 2.1994 - accuracy30: 0.6454 - val_loss: 3.1933 - val_accuracy30: 0.6383 - 37s/epoch - 22ms/step
Epoch 30/50
1686/1686 - 42s - loss: 2.1948 - accuracy30: 0.6454 - val_loss: 3.1849 - val_accuracy30: 0.6431 - 42s/epoch - 25ms/step
testing model: results/AAL/W10/deepVOL_L2/h30
Evaluating performance on  test set...
10110/10110 - 97s - 97s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7608536
{'0': {'precision': 0.5016859976501343, 'recall': 0.5122767362963369, 'f1-score': 0.5069260573739194, 'support': 474271}, '1': {'precision': 0.7763783730109476, 'recall': 0.764623728142261, 'f1-score': 0.7704562188155425, 'support': 1636091}, '2': {'precision': 0.47901311274360503, 'recall': 0.4938114744661834, 'f1-score': 0.4862997391359018, 'support': 477739}, 'accuracy': 0.6683916122284254, 'macro avg': {'precision': 0.585692494468229, 'recall': 0.5902373129682604, 'f1-score': 0.5878940051084546, 'support': 2588101}, 'weighted avg': {'precision': 0.6711500184646574, 'recall': 0.6683916122284254, 'f1-score': 0.6697115625433367, 'support': 2588101}}
[[ 242958  180123   51190]
 [ 179702 1250994  205395]
 [  61623  180203  235913]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7161531
{'0': {'precision': 0.45931017992707274, 'recall': 0.5524733966062698, 'f1-score': 0.5016026373339426, 'support': 69540}, '1': {'precision': 0.8210087573770369, 'recall': 0.7521097802959669, 'f1-score': 0.7850504603999044, 'support': 292803}, '2': {'precision': 0.4554660442704412, 'recall': 0.5243336944745396, 'f1-score': 0.487479602731723, 'support': 69225}, 'accuracy': 0.6834056278500723, 'macro avg': {'precision': 0.5785949938581837, 'recall': 0.6096389571255921, 'f1-score': 0.5913775668218567, 'support': 431568}, 'weighted avg': {'precision': 0.7040927362849387, 'recall': 0.6834056278500723, 'f1-score': 0.6916461666661549, 'support': 431568}}
[[ 38419  24004   7117]
 [ 36305 220220  36278]
 [  8921  24007  36297]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8174565
{'0': {'precision': 0.4360058274223209, 'recall': 0.553665119946623, 'f1-score': 0.4878413767302656, 'support': 32973}, '1': {'precision': 0.7954811531264697, 'recall': 0.7040205455189514, 'f1-score': 0.7469615751419968, 'support': 112920}, '2': {'precision': 0.45783038905869555, 'recall': 0.5120071840329075, 'f1-score': 0.4834055820695502, 'support': 34521}, 'accuracy': 0.6398006806567118, 'macro avg': {'precision': 0.5631057898691622, 'recall': 0.589897616499494, 'f1-score': 0.5727361779806043, 'support': 180414}, 'weighted avg': {'precision': 0.6651751794169654, 'recall': 0.6398006806567118, 'f1-score': 0.649174337238708, 'support': 180414}}
[[18256 10096  4621]
 [17112 79498 16310]
 [ 6503 10343 17675]]
training model: results/AAL/W10/deepVOL_L2/h50
Epoch 1/50
1686/1686 - 40s - loss: 2.9480 - accuracy50: 0.4978 - val_loss: 3.3592 - val_accuracy50: 0.5405 - 40s/epoch - 23ms/step
Epoch 2/50
1686/1686 - 38s - loss: 2.7489 - accuracy50: 0.5485 - val_loss: 3.2967 - val_accuracy50: 0.5782 - 38s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 39s - loss: 2.6647 - accuracy50: 0.5689 - val_loss: 3.2979 - val_accuracy50: 0.5763 - 39s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 39s - loss: 2.6216 - accuracy50: 0.5815 - val_loss: 3.5095 - val_accuracy50: 0.5782 - 39s/epoch - 23ms/step
Epoch 5/50
1686/1686 - 38s - loss: 2.5968 - accuracy50: 0.5867 - val_loss: 3.4020 - val_accuracy50: 0.5875 - 38s/epoch - 22ms/step
Epoch 6/50
1686/1686 - 42s - loss: 2.5799 - accuracy50: 0.5900 - val_loss: 3.3863 - val_accuracy50: 0.5883 - 42s/epoch - 25ms/step
Epoch 7/50
1686/1686 - 41s - loss: 2.5636 - accuracy50: 0.5948 - val_loss: 3.3945 - val_accuracy50: 0.5799 - 41s/epoch - 24ms/step
Epoch 8/50
1686/1686 - 40s - loss: 2.5508 - accuracy50: 0.5951 - val_loss: 3.4598 - val_accuracy50: 0.5838 - 40s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 40s - loss: 2.5361 - accuracy50: 0.5970 - val_loss: 3.3830 - val_accuracy50: 0.5796 - 40s/epoch - 24ms/step
Epoch 10/50
1686/1686 - 38s - loss: 2.5267 - accuracy50: 0.5984 - val_loss: 3.3222 - val_accuracy50: 0.5821 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 41s - loss: 2.5177 - accuracy50: 0.6012 - val_loss: 3.3460 - val_accuracy50: 0.5923 - 41s/epoch - 24ms/step
Epoch 12/50
1686/1686 - 36s - loss: 2.5069 - accuracy50: 0.6016 - val_loss: 3.3547 - val_accuracy50: 0.5911 - 36s/epoch - 21ms/step
testing model: results/AAL/W10/deepVOL_L2/h50
Evaluating performance on  test set...
10110/10110 - 99s - 99s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8974104
{'0': {'precision': 0.5057321089711432, 'recall': 0.39159167984002813, 'f1-score': 0.4414025094852909, 'support': 592104}, '1': {'precision': 0.6492735345732358, 'recall': 0.7638065752511376, 'f1-score': 0.7018984860033453, 'support': 1397939}, '2': {'precision': 0.4773785645226792, 'recall': 0.3872082640814102, 'f1-score': 0.4275913515290112, 'support': 598058}, 'accuracy': 0.5916272201123527, 'macro avg': {'precision': 0.544128069355686, 'recall': 0.5142021730575252, 'f1-score': 0.5236307823392158, 'support': 2588101}, 'weighted avg': {'precision': 0.5767127596022446, 'recall': 0.5916272201123527, 'f1-score': 0.5789155398549154, 'support': 2588101}}
[[ 231863  290923   69318]
 [ 145982 1067755  184202]
 [  80625  285860  231573]]
Evaluating performance on  train set...
1686/1686 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8534897
{'0': {'precision': 0.46753033781567727, 'recall': 0.4226208123332345, 'f1-score': 0.44394269697913424, 'support': 87698}, '1': {'precision': 0.7106876818550517, 'recall': 0.7442042594309849, 'f1-score': 0.7270599072727688, 'support': 256654}, '2': {'precision': 0.44158207239992336, 'recall': 0.42294991744634014, 'f1-score': 0.4320652173913043, 'support': 87216}, 'accuracy': 0.6139333778222668, 'macro avg': {'precision': 0.5399333640235507, 'recall': 0.5299249964035199, 'f1-score': 0.5343559405477358, 'support': 431568}, 'weighted avg': {'precision': 0.6068923875056015, 'recall': 0.6139333778222668, 'f1-score': 0.6099125052850567, 'support': 431568}}
[[ 37063  39807  10828]
 [ 29831 191003  35820]
 [ 12380  37948  36888]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92116416
{'0': {'precision': 0.44350067509512703, 'recall': 0.4452824608104111, 'f1-score': 0.44438978193759454, 'support': 40572}, '1': {'precision': 0.6787873973527688, 'recall': 0.7023383881970986, 'f1-score': 0.6903620967375442, 'support': 97332}, '2': {'precision': 0.458891454965358, 'recall': 0.4206774876499647, 'f1-score': 0.4389543446244477, 'support': 42510}, 'accuracy': 0.5781646657133038, 'macro avg': {'precision': 0.5270598424710846, 'recall': 0.5227661122191581, 'f1-score': 0.5245687410998622, 'support': 180414}, 'weighted avg': {'precision': 0.5740625455877956, 'recall': 0.5781646657133038, 'f1-score': 0.5758092776747703, 'support': 180414}}
[[18066 16004  6502]
 [14387 68360 14585]
 [ 8282 16345 17883]]
training model: results/AAL/W10/deepVOL_L2/h100
Epoch 1/50
1686/1686 - 42s - loss: 3.1424 - accuracy100: 0.4478 - val_loss: 3.7434 - val_accuracy100: 0.4162 - 42s/epoch - 25ms/step
Epoch 2/50
1686/1686 - 43s - loss: 3.0219 - accuracy100: 0.4907 - val_loss: 3.4437 - val_accuracy100: 0.4760 - 43s/epoch - 26ms/step
Epoch 3/50
1686/1686 - 42s - loss: 2.9221 - accuracy100: 0.5200 - val_loss: 3.4222 - val_accuracy100: 0.4832 - 42s/epoch - 25ms/step
Epoch 4/50
1686/1686 - 41s - loss: 2.8862 - accuracy100: 0.5292 - val_loss: 3.3444 - val_accuracy100: 0.4917 - 41s/epoch - 24ms/step
Epoch 5/50
1686/1686 - 42s - loss: 2.8639 - accuracy100: 0.5335 - val_loss: 3.4016 - val_accuracy100: 0.4959 - 42s/epoch - 25ms/step
Epoch 6/50
1686/1686 - 42s - loss: 2.8464 - accuracy100: 0.5376 - val_loss: 3.3455 - val_accuracy100: 0.4995 - 42s/epoch - 25ms/step
Epoch 7/50
1686/1686 - 37s - loss: 2.8339 - accuracy100: 0.5412 - val_loss: 3.3620 - val_accuracy100: 0.4983 - 37s/epoch - 22ms/step
Epoch 8/50
1686/1686 - 42s - loss: 2.8233 - accuracy100: 0.5440 - val_loss: 3.3745 - val_accuracy100: 0.4993 - 42s/epoch - 25ms/step
Epoch 9/50
1686/1686 - 41s - loss: 2.8184 - accuracy100: 0.5450 - val_loss: 3.3786 - val_accuracy100: 0.5020 - 41s/epoch - 24ms/step
Epoch 10/50
1686/1686 - 37s - loss: 2.8128 - accuracy100: 0.5460 - val_loss: 3.4686 - val_accuracy100: 0.4965 - 37s/epoch - 22ms/step
Epoch 11/50
1686/1686 - 42s - loss: 2.8047 - accuracy100: 0.5480 - val_loss: 3.4242 - val_accuracy100: 0.4988 - 42s/epoch - 25ms/step
Epoch 12/50
1686/1686 - 41s - loss: 2.7976 - accuracy100: 0.5488 - val_loss: 3.3959 - val_accuracy100: 0.4979 - 41s/epoch - 24ms/step
Epoch 13/50
1686/1686 - 38s - loss: 2.7922 - accuracy100: 0.5507 - val_loss: 3.4120 - val_accuracy100: 0.4987 - 38s/epoch - 22ms/step
Epoch 14/50
1686/1686 - 41s - loss: 2.7868 - accuracy100: 0.5512 - val_loss: 3.4259 - val_accuracy100: 0.4974 - 41s/epoch - 24ms/step
testing model: results/AAL/W10/deepVOL_L2/h100
Evaluating performance on  test set...
10110/10110 - 97s - 97s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0315667
{'0': {'precision': 0.4825680792800913, 'recall': 0.3788574153650507, 'f1-score': 0.4244696642721155, 'support': 780056}, '1': {'precision': 0.4809486282499776, 'recall': 0.7397714819574421, 'f1-score': 0.582921632060981, 'support': 1014712}, '2': {'precision': 0.522997758550047, 'recall': 0.2735257451788845, 'f1-score': 0.35919430114637535, 'support': 793333}, 'accuracy': 0.488072915237852, 'macro avg': {'precision': 0.4955048220267053, 'recall': 0.4640515475004592, 'f1-score': 0.4555285324931573, 'support': 2588101}, 'weighted avg': {'precision': 0.4943260911778507, 'recall': 0.488072915237852, 'f1-score': 0.46658471831534737, 'support': 2588101}}
[[295530 386052  98474]
 [164618 750655  99439]
 [152263 424073 216997]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9837267
{'0': {'precision': 0.4560446268418433, 'recall': 0.41186548492430347, 'f1-score': 0.43283063265415267, 'support': 117905}, '1': {'precision': 0.5578438929538403, 'recall': 0.7311708949123974, 'f1-score': 0.6328542112502142, 'support': 196969}, '2': {'precision': 0.5106700938490047, 'recall': 0.29283425026136733, 'f1-score': 0.37222373509068135, 'support': 116694}, 'accuracy': 0.5254119860601342, 'macro avg': {'precision': 0.5081862045482294, 'recall': 0.4786235433660228, 'f1-score': 0.4793028596650161, 'support': 431568}, 'weighted avg': {'precision': 0.5172766085776246, 'recall': 0.5254119860601342, 'f1-score': 0.5077342004539338, 'support': 431568}}
[[ 48561  54845  14499]
 [ 34706 144018  18245]
 [ 23216  59306  34172]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0376824
{'0': {'precision': 0.43646492591048625, 'recall': 0.4384755958273053, 'f1-score': 0.43746795054412857, 'support': 52532}, '1': {'precision': 0.5161679916823323, 'recall': 0.6774220225214671, 'f1-score': 0.5859022959731064, 'support': 72553}, '2': {'precision': 0.5188612319175843, 'recall': 0.3040358582298614, 'f1-score': 0.3834074074074074, 'support': 55329}, 'accuracy': 0.49333754586672873, 'macro avg': {'precision': 0.49049804983680095, 'recall': 0.4733111588595446, 'f1-score': 0.46892588464154744, 'support': 180414}, 'weighted avg': {'precision': 0.49378642948566037, 'recall': 0.49333754586672873, 'f1-score': 0.4805812414899364, 'support': 180414}}
[[23034 21364  8134]
 [15939 49149  7465]
 [13801 24706 16822]]
training model: results/AAL/W10/deepVOL_L2/h200
Epoch 1/50
1686/1686 - 43s - loss: 3.2143 - accuracy200: 0.4158 - val_loss: 3.6344 - val_accuracy200: 0.3152 - 43s/epoch - 26ms/step
Epoch 2/50
1686/1686 - 43s - loss: 3.1761 - accuracy200: 0.4313 - val_loss: 3.3369 - val_accuracy200: 0.3947 - 43s/epoch - 26ms/step
Epoch 3/50
1686/1686 - 43s - loss: 3.1067 - accuracy200: 0.4596 - val_loss: 3.3105 - val_accuracy200: 0.3880 - 43s/epoch - 25ms/step
Epoch 4/50
1686/1686 - 43s - loss: 3.0702 - accuracy200: 0.4663 - val_loss: 3.2512 - val_accuracy200: 0.3958 - 43s/epoch - 25ms/step
Epoch 5/50
1686/1686 - 43s - loss: 3.0467 - accuracy200: 0.4708 - val_loss: 3.2910 - val_accuracy200: 0.3906 - 43s/epoch - 26ms/step
Epoch 6/50
1686/1686 - 43s - loss: 3.0297 - accuracy200: 0.4741 - val_loss: 3.2855 - val_accuracy200: 0.3985 - 43s/epoch - 25ms/step
Epoch 7/50
1686/1686 - 44s - loss: 3.0203 - accuracy200: 0.4759 - val_loss: 3.2835 - val_accuracy200: 0.3992 - 44s/epoch - 26ms/step
Epoch 8/50
1686/1686 - 43s - loss: 3.0142 - accuracy200: 0.4778 - val_loss: 3.2782 - val_accuracy200: 0.4059 - 43s/epoch - 25ms/step
Epoch 9/50
1686/1686 - 43s - loss: 3.0081 - accuracy200: 0.4794 - val_loss: 3.2615 - val_accuracy200: 0.4081 - 43s/epoch - 26ms/step
Epoch 10/50
1686/1686 - 44s - loss: 3.0004 - accuracy200: 0.4815 - val_loss: 3.2804 - val_accuracy200: 0.4073 - 44s/epoch - 26ms/step
Epoch 11/50
1686/1686 - 40s - loss: 2.9947 - accuracy200: 0.4831 - val_loss: 3.2388 - val_accuracy200: 0.4147 - 40s/epoch - 24ms/step
Epoch 12/50
1686/1686 - 42s - loss: 2.9877 - accuracy200: 0.4853 - val_loss: 3.2599 - val_accuracy200: 0.4135 - 42s/epoch - 25ms/step
Epoch 13/50
1686/1686 - 42s - loss: 2.9806 - accuracy200: 0.4880 - val_loss: 3.2758 - val_accuracy200: 0.4109 - 42s/epoch - 25ms/step
Epoch 14/50
1686/1686 - 42s - loss: 2.9736 - accuracy200: 0.4900 - val_loss: 3.3027 - val_accuracy200: 0.4107 - 42s/epoch - 25ms/step
Epoch 15/50
1686/1686 - 43s - loss: 2.9679 - accuracy200: 0.4919 - val_loss: 3.3213 - val_accuracy200: 0.4137 - 43s/epoch - 25ms/step
Epoch 16/50
1686/1686 - 43s - loss: 2.9605 - accuracy200: 0.4937 - val_loss: 3.3853 - val_accuracy200: 0.4116 - 43s/epoch - 26ms/step
Epoch 17/50
1686/1686 - 41s - loss: 2.9542 - accuracy200: 0.4957 - val_loss: 3.3998 - val_accuracy200: 0.4070 - 41s/epoch - 24ms/step
Epoch 18/50
1686/1686 - 41s - loss: 2.9443 - accuracy200: 0.4981 - val_loss: 3.4562 - val_accuracy200: 0.4033 - 41s/epoch - 24ms/step
Epoch 19/50
1686/1686 - 41s - loss: 2.9386 - accuracy200: 0.5004 - val_loss: 3.4609 - val_accuracy200: 0.4004 - 41s/epoch - 24ms/step
Epoch 20/50
1686/1686 - 38s - loss: 2.9316 - accuracy200: 0.5016 - val_loss: 3.5442 - val_accuracy200: 0.3974 - 38s/epoch - 23ms/step
Epoch 21/50
1686/1686 - 39s - loss: 2.9247 - accuracy200: 0.5034 - val_loss: 3.5354 - val_accuracy200: 0.4009 - 39s/epoch - 23ms/step
testing model: results/AAL/W10/deepVOL_L2/h200
Evaluating performance on  test set...
10110/10110 - 98s - 98s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1081032
{'0': {'precision': 0.512174011318123, 'recall': 0.19900714385168208, 'f1-score': 0.28663944877207087, 'support': 933670}, '1': {'precision': 0.3129706387375219, 'recall': 0.7272874330773018, 'f1-score': 0.43762142999548753, 'support': 704731}, '2': {'precision': 0.4823262747340263, 'recall': 0.29845214278193116, 'f1-score': 0.3687379337978551, 'support': 949700}, 'accuracy': 0.37934725113123485, 'macro avg': {'precision': 0.43582364159655707, 'recall': 0.408248906570305, 'f1-score': 0.3643329375218045, 'support': 2588101}, 'weighted avg': {'precision': 0.44697903345751544, 'recall': 0.37934725113123485, 'f1-score': 0.35787724584357117, 'support': 2588101}}
[[185807 571951 175912]
 [ 63889 512542 128300]
 [113085 553175 283440]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0655361
{'0': {'precision': 0.48774748923959826, 'recall': 0.23562190709859857, 'f1-score': 0.317746352496939, 'support': 144282}, '1': {'precision': 0.3937619918115756, 'recall': 0.7157156195079086, 'f1-score': 0.508025768222441, 'support': 145664}, '2': {'precision': 0.4652537485582468, 'recall': 0.31900410953100505, 'f1-score': 0.3784924976751589, 'support': 141622}, 'accuracy': 0.4250268787305824, 'macro avg': {'precision': 0.44892107653647356, 'recall': 0.4234472120458374, 'f1-score': 0.4014215394648463, 'support': 431568}, 'weighted avg': {'precision': 0.4486437743206751, 'recall': 0.4250268787305824, 'f1-score': 0.40190424044198914, 'support': 431568}}
[[ 33996  83193  27093]
 [ 16577 104254  24833]
 [ 19127  77317  45178]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0779383
{'0': {'precision': 0.45353667220507954, 'recall': 0.248662014217624, 'f1-score': 0.3212120575349086, 'support': 61473}, '1': {'precision': 0.37117864368903697, 'recall': 0.6816022477310116, 'f1-score': 0.4806246008263708, 'support': 54099}, '2': {'precision': 0.4782443473304199, 'recall': 0.3493568983066531, 'f1-score': 0.4037644039248189, 'support': 64842}, 'accuracy': 0.41467402751449445, 'macro avg': {'precision': 0.43431988774151215, 'recall': 0.4265403867517629, 'f1-score': 0.4018670207620328, 'support': 180414}, 'weighted avg': {'precision': 0.4377208712461071, 'recall': 0.41467402751449445, 'f1-score': 0.3986834202015496, 'support': 180414}}
[[15286 31532 14655]
 [ 7166 36874 10059]
 [11252 30937 22653]]
training model: results/AAL/W10/deepVOL_L2/h300
Epoch 1/50
1686/1686 - 41s - loss: 3.2381 - accuracy300: 0.4047 - val_loss: 3.4712 - val_accuracy300: 0.3099 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 39s - loss: 3.2205 - accuracy300: 0.4080 - val_loss: 3.4336 - val_accuracy300: 0.3165 - 39s/epoch - 23ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.1966 - accuracy300: 0.4215 - val_loss: 3.3863 - val_accuracy300: 0.3274 - 38s/epoch - 22ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.1752 - accuracy300: 0.4323 - val_loss: 3.3347 - val_accuracy300: 0.3560 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 39s - loss: 3.1558 - accuracy300: 0.4397 - val_loss: 3.3271 - val_accuracy300: 0.3768 - 39s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 39s - loss: 3.1376 - accuracy300: 0.4439 - val_loss: 3.3305 - val_accuracy300: 0.3702 - 39s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 39s - loss: 3.1229 - accuracy300: 0.4477 - val_loss: 3.3780 - val_accuracy300: 0.3688 - 39s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 39s - loss: 3.1102 - accuracy300: 0.4495 - val_loss: 3.3549 - val_accuracy300: 0.3734 - 39s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 38s - loss: 3.1015 - accuracy300: 0.4534 - val_loss: 3.3545 - val_accuracy300: 0.3769 - 38s/epoch - 22ms/step
Epoch 10/50
1686/1686 - 38s - loss: 3.0902 - accuracy300: 0.4566 - val_loss: 3.3671 - val_accuracy300: 0.3741 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 42s - loss: 3.0834 - accuracy300: 0.4587 - val_loss: 3.3750 - val_accuracy300: 0.3782 - 42s/epoch - 25ms/step
Epoch 12/50
1686/1686 - 39s - loss: 3.0775 - accuracy300: 0.4611 - val_loss: 3.4020 - val_accuracy300: 0.3719 - 39s/epoch - 23ms/step
Epoch 13/50
1686/1686 - 38s - loss: 3.0715 - accuracy300: 0.4636 - val_loss: 3.4126 - val_accuracy300: 0.3741 - 38s/epoch - 23ms/step
Epoch 14/50
1686/1686 - 39s - loss: 3.0618 - accuracy300: 0.4677 - val_loss: 3.4568 - val_accuracy300: 0.3702 - 39s/epoch - 23ms/step
Epoch 15/50
1686/1686 - 40s - loss: 3.0532 - accuracy300: 0.4703 - val_loss: 3.4035 - val_accuracy300: 0.3788 - 40s/epoch - 24ms/step
testing model: results/AAL/W10/deepVOL_L2/h300
Evaluating performance on  test set...
10110/10110 - 97s - 97s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1401665
{'0': {'precision': 0.429062160772439, 'recall': 0.24935978051989557, 'f1-score': 0.3154109256425266, 'support': 963732}, '1': {'precision': 0.2786900651388147, 'recall': 0.623402176903554, 'f1-score': 0.3851845414291247, 'support': 646974}, '2': {'precision': 0.45358030813308814, 'recall': 0.26952664992147496, 'f1-score': 0.33812973187359896, 'support': 977395}, 'accuracy': 0.35047898053437637, 'macro avg': {'precision': 0.3871108446814473, 'recall': 0.38076286911497487, 'f1-score': 0.34624173298175015, 'support': 2588101}, 'weighted avg': {'precision': 0.4007313801881779, 'recall': 0.35047898053437637, 'f1-score': 0.34143269330775194, 'support': 2588101}}
[[240316 532163 191253]
 [117548 403325 126101]
 [202232 511729 263434]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059158
{'0': {'precision': 0.4094688221709007, 'recall': 0.2738150393811816, 'f1-score': 0.32817611530707913, 'support': 148929}, '1': {'precision': 0.3590781226866703, 'recall': 0.6399343296271593, 'f1-score': 0.4600271341824839, 'support': 136439}, '2': {'precision': 0.43902411564702437, 'recall': 0.26672366621067034, 'f1-score': 0.3318412744338828, 'support': 146200}, 'accuracy': 0.38716030845660476, 'macro avg': {'precision': 0.4025236868348651, 'recall': 0.39349101173967044, 'f1-score': 0.3733481746411486, 'support': 431568}, 'weighted avg': {'precision': 0.40355023520263705, 'recall': 0.38716030845660476, 'f1-score': 0.3711020677147647, 'support': 431568}}
[[40779 80849 27301]
 [26601 87312 22526]
 [32210 74995 38995]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1149142
{'0': {'precision': 0.39113653907278756, 'recall': 0.27654622212947655, 'f1-score': 0.3240081622673801, 'support': 62297}, '1': {'precision': 0.3372042278257352, 'recall': 0.6099227970196954, 'f1-score': 0.4342998149290561, 'support': 51941}, '2': {'precision': 0.4496805676701478, 'recall': 0.2882464941972921, 'f1-score': 0.35130530871587096, 'support': 66176}, 'accuracy': 0.37681665502677175, 'macro avg': {'precision': 0.39267377818955684, 'recall': 0.39157183778215465, 'f1-score': 0.3698710953041024, 'support': 180414}, 'weighted avg': {'precision': 0.39708348031889795, 'recall': 0.37681665502677175, 'f1-score': 0.3657736277760183, 'support': 180414}}
[[17228 30938 14131]
 [11048 31680  9213]
 [15770 31331 19075]]
training model: results/AAL/W10/deepVOL_L2/h500
Epoch 1/50
1686/1686 - 41s - loss: 3.2835 - accuracy500: 0.3760 - val_loss: 3.4499 - val_accuracy500: 0.3024 - 41s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 41s - loss: 3.2630 - accuracy500: 0.3839 - val_loss: 3.4638 - val_accuracy500: 0.3079 - 41s/epoch - 25ms/step
Epoch 3/50
1686/1686 - 40s - loss: 3.2443 - accuracy500: 0.4004 - val_loss: 3.4729 - val_accuracy500: 0.3106 - 40s/epoch - 24ms/step
Epoch 4/50
1686/1686 - 41s - loss: 3.2338 - accuracy500: 0.4065 - val_loss: 3.4709 - val_accuracy500: 0.3173 - 41s/epoch - 24ms/step
Epoch 5/50
1686/1686 - 39s - loss: 3.2264 - accuracy500: 0.4082 - val_loss: 3.4900 - val_accuracy500: 0.3181 - 39s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 39s - loss: 3.2186 - accuracy500: 0.4135 - val_loss: 3.4742 - val_accuracy500: 0.3238 - 39s/epoch - 23ms/step
Epoch 7/50
1686/1686 - 38s - loss: 3.2120 - accuracy500: 0.4169 - val_loss: 3.4633 - val_accuracy500: 0.3296 - 38s/epoch - 22ms/step
Epoch 8/50
1686/1686 - 38s - loss: 3.2033 - accuracy500: 0.4221 - val_loss: 3.4565 - val_accuracy500: 0.3296 - 38s/epoch - 22ms/step
Epoch 9/50
1686/1686 - 38s - loss: 3.1995 - accuracy500: 0.4230 - val_loss: 3.4612 - val_accuracy500: 0.3296 - 38s/epoch - 23ms/step
Epoch 10/50
1686/1686 - 38s - loss: 3.1904 - accuracy500: 0.4272 - val_loss: 3.4569 - val_accuracy500: 0.3333 - 38s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 37s - loss: 3.1777 - accuracy500: 0.4343 - val_loss: 3.4914 - val_accuracy500: 0.3365 - 37s/epoch - 22ms/step
testing model: results/AAL/W10/deepVOL_L2/h500
Evaluating performance on  test set...
10110/10110 - 89s - 89s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1761844
{'0': {'precision': 0.4073822309836177, 'recall': 0.006365469056364088, 'f1-score': 0.012535073839386653, 'support': 941486}, '1': {'precision': 0.26439822013836717, 'recall': 0.994212717699, 'f1-score': 0.41771140722838895, 'support': 684259}, '2': {'precision': 0.3648293963254593, 'recall': 0.00014443719372041116, 'f1-score': 0.00028876006635249294, 'support': 962356}, 'accuracy': 0.26522573887186013, 'macro avg': {'precision': 0.3455366158158147, 'recall': 0.33357420798302817, 'f1-score': 0.14351174704470937, 'support': 2588101}, 'weighted avg': {'precision': 0.35375639797816427, 'recall': 0.26522573887186013, 'f1-score': 0.11510457911412797, 'support': 2588101}}
[[  5993 935362    131]
 [  3849 680299    111]
 [  4869 957348    139]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436929
{'0': {'precision': 0.3779334500875657, 'recall': 0.007308416532329075, 'f1-score': 0.014339537387120996, 'support': 147638}, '1': {'precision': 0.3199171324853722, 'recall': 0.9929903835013324, 'f1-score': 0.48392538272058044, 'support': 138096}, '2': {'precision': 0.35064935064935066, 'recall': 0.0001851420107793793, 'f1-score': 0.0003700886156629726, 'support': 145834}, 'accuracy': 0.32030641752863975, 'macro avg': {'precision': 0.3494999777407628, 'recall': 0.333494647348147, 'f1-score': 0.1662116695744548, 'support': 431568}, 'weighted avg': {'precision': 0.350149252109344, 'recall': 0.32030641752863975, 'f1-score': 0.15988023156517084, 'support': 431568}}
[[  1079 146534     25]
 [   943 137128     25]
 [   833 144974     27]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.157723
{'0': {'precision': 0.32775665399239545, 'recall': 0.007126794100138898, 'f1-score': 0.013950251654771728, 'support': 60476}, '1': {'precision': 0.30235259298968614, 'recall': 0.9918301551537799, 'f1-score': 0.46343133478837684, 'support': 54591}, '2': {'precision': 0.4, 'recall': 0.00012242337062145164, 'f1-score': 0.0002447718267627396, 'support': 65347}, 'accuracy': 0.30254858270422474, 'macro avg': {'precision': 0.3433697489940272, 'recall': 0.33302645754151344, 'f1-score': 0.15920878608997044, 'support': 180414}, 'weighted avg': {'precision': 0.3462366657285137, 'recall': 0.30254858270422474, 'f1-score': 0.14499335151966986, 'support': 180414}}
[[  431 60041     4]
 [  438 54145     8]
 [  446 64893     8]]
training model: results/AAL/W10/deepVOL_L2/h1000
Epoch 1/50
1686/1686 - 40s - loss: 3.2072 - accuracy1000: 0.4191 - val_loss: 3.3267 - val_accuracy1000: 0.3241 - 40s/epoch - 24ms/step
Epoch 2/50
1686/1686 - 37s - loss: 3.2278 - accuracy1000: 0.4104 - val_loss: 3.3612 - val_accuracy1000: 0.3152 - 37s/epoch - 22ms/step
Epoch 3/50
1686/1686 - 38s - loss: 3.2140 - accuracy1000: 0.4179 - val_loss: 3.3383 - val_accuracy1000: 0.3270 - 38s/epoch - 23ms/step
Epoch 4/50
1686/1686 - 38s - loss: 3.2214 - accuracy1000: 0.4174 - val_loss: 3.3674 - val_accuracy1000: 0.3265 - 38s/epoch - 22ms/step
Epoch 5/50
1686/1686 - 38s - loss: 3.2296 - accuracy1000: 0.4136 - val_loss: 3.3745 - val_accuracy1000: 0.3309 - 38s/epoch - 23ms/step
Epoch 6/50
1686/1686 - 42s - loss: 3.2213 - accuracy1000: 0.4207 - val_loss: 3.3755 - val_accuracy1000: 0.3284 - 42s/epoch - 25ms/step
Epoch 7/50
1686/1686 - 38s - loss: 3.2107 - accuracy1000: 0.4258 - val_loss: 3.3718 - val_accuracy1000: 0.3314 - 38s/epoch - 23ms/step
Epoch 8/50
1686/1686 - 39s - loss: 3.1986 - accuracy1000: 0.4309 - val_loss: 3.3926 - val_accuracy1000: 0.3268 - 39s/epoch - 23ms/step
Epoch 9/50
1686/1686 - 40s - loss: 3.1935 - accuracy1000: 0.4337 - val_loss: 3.4332 - val_accuracy1000: 0.3263 - 40s/epoch - 24ms/step
Epoch 10/50
1686/1686 - 39s - loss: 3.1874 - accuracy1000: 0.4318 - val_loss: 3.4501 - val_accuracy1000: 0.3356 - 39s/epoch - 23ms/step
Epoch 11/50
1686/1686 - 38s - loss: 3.1675 - accuracy1000: 0.4416 - val_loss: 3.4726 - val_accuracy1000: 0.3316 - 38s/epoch - 22ms/step
testing model: results/AAL/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
10110/10110 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1242497
{'0': {'precision': 0.40395916196542014, 'recall': 0.12078218427417034, 'f1-score': 0.18596236141632108, 'support': 1025027}, '1': {'precision': 0.19989670487678587, 'recall': 0.881284948651621, 'f1-score': 0.3258767048405856, 'support': 516472}, '2': {'precision': 0.44356052461836165, 'recall': 0.0019711408921442917, 'f1-score': 0.003924840166924613, 'support': 1046602}, 'accuracy': 0.22449935300052046, 'macro avg': {'precision': 0.34913879715352253, 'recall': 0.33467942460597855, 'f1-score': 0.1719213021412771, 'support': 2588101}, 'weighted avg': {'precision': 0.37925159453192847, 'recall': 0.22449935300052046, 'f1-score': 0.1402690159720575, 'support': 2588101}}
[[123805 899374   1848]
 [ 60573 455159    740]
 [122101 922438   2063]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033447
{'0': {'precision': 0.3224571886044559, 'recall': 0.11302133950203266, 'f1-score': 0.16737699351837304, 'support': 146114}, '1': {'precision': 0.3242293908700387, 'recall': 0.8595517400483774, 'f1-score': 0.4708504466209036, 'support': 143042}, '2': {'precision': 0.28896672504378285, 'recall': 0.0023172204589500885, 'f1-score': 0.004597573038717137, 'support': 142412}, 'accuracy': 0.3239257776294813, 'macro avg': {'precision': 0.3118844348394258, 'recall': 0.3249634333364534, 'f1-score': 0.2142750043926646, 'support': 431568}, 'weighted avg': {'precision': 0.3119931492407193, 'recall': 0.3239257776294813, 'f1-score': 0.21424725926871463, 'support': 431568}}
[[ 16514 129284    316]
 [ 19594 122952    496]
 [ 15105 126977    330]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078916
{'0': {'precision': 0.32136775118759525, 'recall': 0.12463067885571275, 'f1-score': 0.17960727345589342, 'support': 57538}, '1': {'precision': 0.32421506193961286, 'recall': 0.8702588699527163, 'f1-score': 0.47242727679828633, 'support': 58794}, '2': {'precision': 0.35789473684210527, 'recall': 0.0015917106207671422, 'f1-score': 0.003169325896810478, 'support': 64082}, 'accuracy': 0.3239161040717461, 'macro avg': {'precision': 0.3344925166564378, 'recall': 0.33216041980973204, 'f1-score': 0.2184012920503301, 'support': 180414}, 'weighted avg': {'precision': 0.3352698157893802, 'recall': 0.3239161040717461, 'f1-score': 0.21236283965935596, 'support': 180414}}
[[ 7171 50276    91]
 [ 7536 51166    92]
 [ 7607 56373   102]]
training model: results/AAL/W10/deepVOL_L3/h10
Epoch 1/50
1686/1686 - 65s - loss: 2.9398 - accuracy10: 0.4222 - val_loss: 4.3512 - val_accuracy10: 0.6898 - 65s/epoch - 38ms/step
Epoch 2/50
1686/1686 - 59s - loss: 2.5237 - accuracy10: 0.5293 - val_loss: 3.0596 - val_accuracy10: 0.5601 - 59s/epoch - 35ms/step
Epoch 3/50
1686/1686 - 58s - loss: 2.2832 - accuracy10: 0.6279 - val_loss: 3.0669 - val_accuracy10: 0.5676 - 58s/epoch - 34ms/step
Epoch 4/50
1686/1686 - 58s - loss: 2.2160 - accuracy10: 0.6477 - val_loss: 3.0429 - val_accuracy10: 0.6027 - 58s/epoch - 34ms/step
Epoch 5/50
1686/1686 - 59s - loss: 2.1772 - accuracy10: 0.6565 - val_loss: 2.9118 - val_accuracy10: 0.6212 - 59s/epoch - 35ms/step
Epoch 6/50
1686/1686 - 57s - loss: 2.1490 - accuracy10: 0.6621 - val_loss: 2.9278 - val_accuracy10: 0.6281 - 57s/epoch - 34ms/step
Epoch 7/50
1686/1686 - 61s - loss: 2.1313 - accuracy10: 0.6644 - val_loss: 2.8997 - val_accuracy10: 0.6421 - 61s/epoch - 36ms/step
Epoch 8/50
1686/1686 - 58s - loss: 2.1166 - accuracy10: 0.6649 - val_loss: 2.8974 - val_accuracy10: 0.6448 - 58s/epoch - 34ms/step
Epoch 9/50
1686/1686 - 60s - loss: 2.0972 - accuracy10: 0.6700 - val_loss: 2.8947 - val_accuracy10: 0.6629 - 60s/epoch - 36ms/step
Epoch 10/50
1686/1686 - 62s - loss: 2.0825 - accuracy10: 0.6715 - val_loss: 2.8801 - val_accuracy10: 0.6462 - 62s/epoch - 37ms/step
Epoch 11/50
1686/1686 - 59s - loss: 2.0711 - accuracy10: 0.6745 - val_loss: 2.9138 - val_accuracy10: 0.6505 - 59s/epoch - 35ms/step
Epoch 12/50
1686/1686 - 58s - loss: 2.0609 - accuracy10: 0.6752 - val_loss: 2.9124 - val_accuracy10: 0.6358 - 58s/epoch - 35ms/step
Epoch 13/50
1686/1686 - 58s - loss: 2.0537 - accuracy10: 0.6754 - val_loss: 2.9387 - val_accuracy10: 0.6627 - 58s/epoch - 34ms/step
Epoch 14/50
1686/1686 - 58s - loss: 2.0422 - accuracy10: 0.6770 - val_loss: 2.9147 - val_accuracy10: 0.6556 - 58s/epoch - 34ms/step
Epoch 15/50
1686/1686 - 58s - loss: 2.0333 - accuracy10: 0.6787 - val_loss: 2.9025 - val_accuracy10: 0.6566 - 58s/epoch - 34ms/step
Epoch 16/50
1686/1686 - 58s - loss: 2.0266 - accuracy10: 0.6789 - val_loss: 2.8869 - val_accuracy10: 0.6740 - 58s/epoch - 34ms/step
Epoch 17/50
1686/1686 - 58s - loss: 2.0182 - accuracy10: 0.6809 - val_loss: 2.8731 - val_accuracy10: 0.6671 - 58s/epoch - 34ms/step
Epoch 18/50
1686/1686 - 58s - loss: 2.0079 - accuracy10: 0.6815 - val_loss: 2.8846 - val_accuracy10: 0.6686 - 58s/epoch - 34ms/step
Epoch 19/50
1686/1686 - 59s - loss: 2.0015 - accuracy10: 0.6831 - val_loss: 2.9243 - val_accuracy10: 0.6514 - 59s/epoch - 35ms/step
Epoch 20/50
1686/1686 - 58s - loss: 1.9940 - accuracy10: 0.6835 - val_loss: 2.9062 - val_accuracy10: 0.6937 - 58s/epoch - 34ms/step
Epoch 21/50
1686/1686 - 58s - loss: 1.9879 - accuracy10: 0.6843 - val_loss: 2.9189 - val_accuracy10: 0.6922 - 58s/epoch - 34ms/step
Epoch 22/50
1686/1686 - 57s - loss: 1.9813 - accuracy10: 0.6853 - val_loss: 2.9128 - val_accuracy10: 0.6632 - 57s/epoch - 34ms/step
Epoch 23/50
1686/1686 - 58s - loss: 1.9798 - accuracy10: 0.6848 - val_loss: 2.8839 - val_accuracy10: 0.6719 - 58s/epoch - 35ms/step
Epoch 24/50
1686/1686 - 58s - loss: 1.9689 - accuracy10: 0.6867 - val_loss: 2.9077 - val_accuracy10: 0.6786 - 58s/epoch - 34ms/step
Epoch 25/50
1686/1686 - 58s - loss: 1.9676 - accuracy10: 0.6862 - val_loss: 2.8589 - val_accuracy10: 0.6578 - 58s/epoch - 35ms/step
Epoch 26/50
1686/1686 - 58s - loss: 1.9617 - accuracy10: 0.6870 - val_loss: 2.9037 - val_accuracy10: 0.6490 - 58s/epoch - 34ms/step
Epoch 27/50
1686/1686 - 58s - loss: 1.9536 - accuracy10: 0.6874 - val_loss: 2.8902 - val_accuracy10: 0.6512 - 58s/epoch - 34ms/step
Epoch 28/50
1686/1686 - 58s - loss: 1.9500 - accuracy10: 0.6880 - val_loss: 2.8741 - val_accuracy10: 0.6691 - 58s/epoch - 34ms/step
Epoch 29/50
1686/1686 - 59s - loss: 1.9453 - accuracy10: 0.6876 - val_loss: 2.8593 - val_accuracy10: 0.6283 - 59s/epoch - 35ms/step
Epoch 30/50
1686/1686 - 61s - loss: 1.9397 - accuracy10: 0.6885 - val_loss: 2.8572 - val_accuracy10: 0.6531 - 61s/epoch - 36ms/step
Epoch 31/50
1686/1686 - 60s - loss: 1.9352 - accuracy10: 0.6881 - val_loss: 2.8710 - val_accuracy10: 0.6583 - 60s/epoch - 36ms/step
Epoch 32/50
1686/1686 - 59s - loss: 1.9294 - accuracy10: 0.6884 - val_loss: 2.8522 - val_accuracy10: 0.6499 - 59s/epoch - 35ms/step
Epoch 33/50
1686/1686 - 58s - loss: 1.9239 - accuracy10: 0.6883 - val_loss: 2.8639 - val_accuracy10: 0.6471 - 58s/epoch - 34ms/step
Epoch 34/50
1686/1686 - 58s - loss: 1.9170 - accuracy10: 0.6900 - val_loss: 2.8424 - val_accuracy10: 0.6500 - 58s/epoch - 35ms/step
Epoch 35/50
1686/1686 - 59s - loss: 1.9155 - accuracy10: 0.6884 - val_loss: 2.9013 - val_accuracy10: 0.6582 - 59s/epoch - 35ms/step
Epoch 36/50
1686/1686 - 60s - loss: 1.9112 - accuracy10: 0.6886 - val_loss: 2.8403 - val_accuracy10: 0.6424 - 60s/epoch - 35ms/step
Epoch 37/50
1686/1686 - 61s - loss: 1.9029 - accuracy10: 0.6898 - val_loss: 2.8476 - val_accuracy10: 0.6482 - 61s/epoch - 36ms/step
Epoch 38/50
1686/1686 - 58s - loss: 1.8998 - accuracy10: 0.6895 - val_loss: 2.8895 - val_accuracy10: 0.6571 - 58s/epoch - 34ms/step
Epoch 39/50
1686/1686 - 59s - loss: 1.8943 - accuracy10: 0.6909 - val_loss: 2.8532 - val_accuracy10: 0.6681 - 59s/epoch - 35ms/step
Epoch 40/50
1686/1686 - 58s - loss: 1.8901 - accuracy10: 0.6899 - val_loss: 2.9013 - val_accuracy10: 0.6672 - 58s/epoch - 34ms/step
Epoch 41/50
1686/1686 - 57s - loss: 1.8861 - accuracy10: 0.6913 - val_loss: 2.8740 - val_accuracy10: 0.6375 - 57s/epoch - 34ms/step
Epoch 42/50
1686/1686 - 59s - loss: 1.8794 - accuracy10: 0.6919 - val_loss: 2.8349 - val_accuracy10: 0.6403 - 59s/epoch - 35ms/step
Epoch 43/50
1686/1686 - 57s - loss: 1.8759 - accuracy10: 0.6914 - val_loss: 2.8238 - val_accuracy10: 0.6232 - 57s/epoch - 34ms/step
Epoch 44/50
1686/1686 - 59s - loss: 1.8718 - accuracy10: 0.6912 - val_loss: 2.8166 - val_accuracy10: 0.6383 - 59s/epoch - 35ms/step
Epoch 45/50
1686/1686 - 58s - loss: 1.8697 - accuracy10: 0.6915 - val_loss: 2.8415 - val_accuracy10: 0.6123 - 58s/epoch - 34ms/step
Epoch 46/50
1686/1686 - 58s - loss: 1.8623 - accuracy10: 0.6916 - val_loss: 2.8848 - val_accuracy10: 0.6296 - 58s/epoch - 34ms/step
Epoch 47/50
1686/1686 - 58s - loss: 1.8566 - accuracy10: 0.6929 - val_loss: 2.8183 - val_accuracy10: 0.6206 - 58s/epoch - 34ms/step
Epoch 48/50
1686/1686 - 58s - loss: 1.8537 - accuracy10: 0.6926 - val_loss: 2.8969 - val_accuracy10: 0.6428 - 58s/epoch - 34ms/step
Epoch 49/50
1686/1686 - 57s - loss: 1.8494 - accuracy10: 0.6923 - val_loss: 2.8762 - val_accuracy10: 0.6545 - 57s/epoch - 34ms/step
Epoch 50/50
1686/1686 - 58s - loss: 1.8387 - accuracy10: 0.6925 - val_loss: 2.8780 - val_accuracy10: 0.6536 - 58s/epoch - 34ms/step
testing model: results/AAL/W10/deepVOL_L3/h10
Evaluating performance on  test set...
10110/10110 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71125484
{'0': {'precision': 0.376012280713166, 'recall': 0.5967790223506942, 'f1-score': 0.461345081044844, 'support': 290595}, '1': {'precision': 0.9142407624837768, 'recall': 0.7011046523241645, 'f1-score': 0.7936116276381388, 'support': 2002440}, '2': {'precision': 0.3288205020658676, 'recall': 0.6589169880636875, 'f1-score': 0.4387105217731736, 'support': 295066}, 'accuracy': 0.6845810886051201, 'macro avg': {'precision': 0.5396911817542701, 'recall': 0.6522668875795153, 'f1-score': 0.5645557434853855, 'support': 2588101}, 'weighted avg': {'precision': 0.7870648446117149, 'recall': 0.6845810886051201, 'f1-score': 0.7158425425790818, 'support': 2588101}}
[[ 173421   70158   47016]
 [ 248683 1403920  349837]
 [  39107   61535  194424]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67161065
{'0': {'precision': 0.35341645370298663, 'recall': 0.6422272258185571, 'f1-score': 0.4559335298133439, 'support': 42636}, '1': {'precision': 0.9350477669067181, 'recall': 0.7024979501333857, 'f1-score': 0.8022605203549042, 'support': 346364}, '2': {'precision': 0.31318447181147996, 'recall': 0.6906126667919564, 'f1-score': 0.4309419801225483, 'support': 42568}, 'accuracy': 0.695371297223149, 'macro avg': {'precision': 0.5338828974737283, 'recall': 0.6784459475812997, 'f1-score': 0.5630453434302655, 'support': 431568}, 'weighted avg': {'precision': 0.8162486218927959, 'recall': 0.695371297223149, 'f1-score': 0.7314205016571768, 'support': 431568}}
[[ 27382   8992   6262]
 [ 44836 243320  58208]
 [  5260   7910  29398]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80304605
{'0': {'precision': 0.3263353844562801, 'recall': 0.5946480731178743, 'f1-score': 0.42140758547008544, 'support': 21226}, '1': {'precision': 0.9221886285378349, 'recall': 0.6405845505392653, 'f1-score': 0.7560147512554488, 'support': 137131}, '2': {'precision': 0.31540447504302926, 'recall': 0.6646416103731242, 'f1-score': 0.4277981236412449, 'support': 22057}, 'accuracy': 0.6381212101056459, 'macro avg': {'precision': 0.5213094960123814, 'recall': 0.6332914113434213, 'f1-score': 0.5350734867889264, 'support': 180414}, 'weighted avg': {'precision': 0.777901494321477, 'recall': 0.6381212101056459, 'f1-score': 0.6765206662274209, 'support': 180414}}
[[12622  3818  4786]
 [22253 87844 27034]
 [ 3803  3594 14660]]
training model: results/AAL/W10/deepVOL_L3/h20
Epoch 1/50
1686/1686 - 62s - loss: 2.9833 - accuracy20: 0.4438 - val_loss: 4.1524 - val_accuracy20: 0.6483 - 62s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 58s - loss: 2.8535 - accuracy20: 0.3783 - val_loss: 3.9270 - val_accuracy20: 0.6409 - 58s/epoch - 35ms/step
Epoch 3/50
1686/1686 - 57s - loss: 2.5914 - accuracy20: 0.5243 - val_loss: 3.0908 - val_accuracy20: 0.5860 - 57s/epoch - 34ms/step
Epoch 4/50
1686/1686 - 60s - loss: 2.3887 - accuracy20: 0.6045 - val_loss: 3.0999 - val_accuracy20: 0.5924 - 60s/epoch - 35ms/step
Epoch 5/50
1686/1686 - 60s - loss: 2.3337 - accuracy20: 0.6196 - val_loss: 3.1124 - val_accuracy20: 0.5808 - 60s/epoch - 35ms/step
Epoch 6/50
1686/1686 - 60s - loss: 2.2987 - accuracy20: 0.6284 - val_loss: 3.0221 - val_accuracy20: 0.6333 - 60s/epoch - 36ms/step
Epoch 7/50
1686/1686 - 64s - loss: 2.2719 - accuracy20: 0.6340 - val_loss: 3.0398 - val_accuracy20: 0.6322 - 64s/epoch - 38ms/step
Epoch 8/50
1686/1686 - 65s - loss: 2.2525 - accuracy20: 0.6381 - val_loss: 3.0183 - val_accuracy20: 0.6202 - 65s/epoch - 38ms/step
Epoch 9/50
1686/1686 - 65s - loss: 2.2337 - accuracy20: 0.6412 - val_loss: 3.0436 - val_accuracy20: 0.6072 - 65s/epoch - 39ms/step
Epoch 10/50
1686/1686 - 66s - loss: 2.2205 - accuracy20: 0.6439 - val_loss: 2.9983 - val_accuracy20: 0.6178 - 66s/epoch - 39ms/step
Epoch 11/50
1686/1686 - 65s - loss: 2.2070 - accuracy20: 0.6445 - val_loss: 3.0005 - val_accuracy20: 0.6422 - 65s/epoch - 39ms/step
Epoch 12/50
1686/1686 - 65s - loss: 2.1952 - accuracy20: 0.6477 - val_loss: 2.9803 - val_accuracy20: 0.6212 - 65s/epoch - 38ms/step
Epoch 13/50
1686/1686 - 65s - loss: 2.1828 - accuracy20: 0.6492 - val_loss: 3.0472 - val_accuracy20: 0.6261 - 65s/epoch - 38ms/step
Epoch 14/50
1686/1686 - 64s - loss: 2.1748 - accuracy20: 0.6518 - val_loss: 2.9827 - val_accuracy20: 0.6425 - 64s/epoch - 38ms/step
Epoch 15/50
1686/1686 - 64s - loss: 2.1642 - accuracy20: 0.6518 - val_loss: 3.0552 - val_accuracy20: 0.6645 - 64s/epoch - 38ms/step
Epoch 16/50
1686/1686 - 65s - loss: 2.1568 - accuracy20: 0.6525 - val_loss: 3.0199 - val_accuracy20: 0.6529 - 65s/epoch - 38ms/step
Epoch 17/50
1686/1686 - 65s - loss: 2.1462 - accuracy20: 0.6550 - val_loss: 3.0024 - val_accuracy20: 0.6717 - 65s/epoch - 39ms/step
Epoch 18/50
1686/1686 - 65s - loss: 2.1403 - accuracy20: 0.6559 - val_loss: 3.0827 - val_accuracy20: 0.6395 - 65s/epoch - 38ms/step
Epoch 19/50
1686/1686 - 65s - loss: 2.1325 - accuracy20: 0.6563 - val_loss: 2.9545 - val_accuracy20: 0.6452 - 65s/epoch - 39ms/step
Epoch 20/50
1686/1686 - 65s - loss: 2.1251 - accuracy20: 0.6577 - val_loss: 3.0313 - val_accuracy20: 0.6620 - 65s/epoch - 39ms/step
Epoch 21/50
1686/1686 - 65s - loss: 2.1204 - accuracy20: 0.6583 - val_loss: 2.9826 - val_accuracy20: 0.6398 - 65s/epoch - 38ms/step
Epoch 22/50
1686/1686 - 65s - loss: 2.1153 - accuracy20: 0.6596 - val_loss: 3.0498 - val_accuracy20: 0.6500 - 65s/epoch - 38ms/step
Epoch 23/50
1686/1686 - 65s - loss: 2.1092 - accuracy20: 0.6608 - val_loss: 2.9601 - val_accuracy20: 0.6609 - 65s/epoch - 38ms/step
Epoch 24/50
1686/1686 - 65s - loss: 2.1059 - accuracy20: 0.6608 - val_loss: 3.0608 - val_accuracy20: 0.6640 - 65s/epoch - 39ms/step
Epoch 25/50
1686/1686 - 64s - loss: 2.1024 - accuracy20: 0.6610 - val_loss: 3.0041 - val_accuracy20: 0.6602 - 64s/epoch - 38ms/step
Epoch 26/50
1686/1686 - 64s - loss: 2.0961 - accuracy20: 0.6618 - val_loss: 2.9884 - val_accuracy20: 0.6391 - 64s/epoch - 38ms/step
Epoch 27/50
1686/1686 - 64s - loss: 2.0926 - accuracy20: 0.6623 - val_loss: 2.9916 - val_accuracy20: 0.6470 - 64s/epoch - 38ms/step
Epoch 28/50
1686/1686 - 64s - loss: 2.0886 - accuracy20: 0.6626 - val_loss: 2.9523 - val_accuracy20: 0.6581 - 64s/epoch - 38ms/step
Epoch 29/50
1686/1686 - 65s - loss: 2.0832 - accuracy20: 0.6629 - val_loss: 2.9576 - val_accuracy20: 0.6459 - 65s/epoch - 39ms/step
Epoch 30/50
1686/1686 - 64s - loss: 2.0787 - accuracy20: 0.6636 - val_loss: 2.9659 - val_accuracy20: 0.6445 - 64s/epoch - 38ms/step
Epoch 31/50
1686/1686 - 64s - loss: 2.0722 - accuracy20: 0.6643 - val_loss: 2.9931 - val_accuracy20: 0.6474 - 64s/epoch - 38ms/step
Epoch 32/50
1686/1686 - 64s - loss: 2.0674 - accuracy20: 0.6642 - val_loss: 3.0054 - val_accuracy20: 0.6299 - 64s/epoch - 38ms/step
Epoch 33/50
1686/1686 - 65s - loss: 2.0638 - accuracy20: 0.6651 - val_loss: 2.9832 - val_accuracy20: 0.6479 - 65s/epoch - 38ms/step
Epoch 34/50
1686/1686 - 65s - loss: 2.0571 - accuracy20: 0.6653 - val_loss: 3.0255 - val_accuracy20: 0.6379 - 65s/epoch - 38ms/step
Epoch 35/50
1686/1686 - 64s - loss: 2.0558 - accuracy20: 0.6668 - val_loss: 3.0547 - val_accuracy20: 0.6343 - 64s/epoch - 38ms/step
Epoch 36/50
1686/1686 - 64s - loss: 2.0505 - accuracy20: 0.6660 - val_loss: 3.0939 - val_accuracy20: 0.6408 - 64s/epoch - 38ms/step
Epoch 37/50
1686/1686 - 59s - loss: 2.0473 - accuracy20: 0.6674 - val_loss: 3.1232 - val_accuracy20: 0.6418 - 59s/epoch - 35ms/step
Epoch 38/50
1686/1686 - 64s - loss: 2.0414 - accuracy20: 0.6678 - val_loss: 3.0503 - val_accuracy20: 0.6311 - 64s/epoch - 38ms/step
testing model: results/AAL/W10/deepVOL_L3/h20
Evaluating performance on  test set...
10110/10110 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7048231
{'0': {'precision': 0.4702200154314755, 'recall': 0.5564182663286249, 'f1-score': 0.5097004669080504, 'support': 397584}, '1': {'precision': 0.8378477993023727, 'recall': 0.7554621177550873, 'f1-score': 0.7945249898229099, 'support': 1790377}, '2': {'precision': 0.42699754621948915, 'recall': 0.5370870195431598, 'f1-score': 0.47575668690401735, 'support': 400140}, 'accuracy': 0.6911225643821474, 'macro avg': {'precision': 0.5783551203177791, 'recall': 0.6163224678756241, 'f1-score': 0.5933273812116592, 'support': 2588101}, 'weighted avg': {'precision': 0.7178522716583157, 'recall': 0.6911225643821474, 'f1-score': 0.7014862630311242, 'support': 2588101}}
[[ 221223  136436   39925]
 [ 189345 1352562  248470]
 [  59899  125331  214910]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6602459
{'0': {'precision': 0.43401219225680404, 'recall': 0.6045297967619704, 'f1-score': 0.5052724014078931, 'support': 58060}, '1': {'precision': 0.8734618098102558, 'recall': 0.7453461807788949, 'f1-score': 0.8043343346252678, 'support': 315601}, '2': {'precision': 0.40486809932790246, 'recall': 0.569033104805982, 'f1-score': 0.4731144198601519, 'support': 57907}, 'accuracy': 0.7027444110777444, 'macro avg': {'precision': 0.5707807004649874, 'recall': 0.6396363607822825, 'f1-score': 0.594240385297771, 'support': 431568}, 'weighted avg': {'precision': 0.751466432979594, 'recall': 0.7027444110777444, 'f1-score': 0.719658252415965, 'support': 431568}}
[[ 35099  17748   5213]
 [ 37146 235232  43223]
 [  8626  16330  32951]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7688819
{'0': {'precision': 0.4056582144986015, 'recall': 0.6314324459353365, 'f1-score': 0.49396984924623116, 'support': 28022}, '1': {'precision': 0.8524923101190945, 'recall': 0.7029566942256258, 'f1-score': 0.7705365775415365, 'support': 123009}, '2': {'precision': 0.4107001470421898, 'recall': 0.49429942483749106, 'f1-score': 0.44863854695970473, 'support': 29383}, 'accuracy': 0.6578646889930937, 'macro avg': {'precision': 0.5562835572199619, 'recall': 0.6095628549994844, 'f1-score': 0.5710483245824908, 'support': 180414}, 'weighted avg': {'precision': 0.7111376250327589, 'recall': 0.6578646889930937, 'f1-score': 0.675154386065947, 'support': 180414}}
[[17694  7532  2796]
 [18495 86470 18044]
 [ 7429  7430 14524]]
training model: results/AAL/W10/deepVOL_L3/h30
Epoch 1/50
1686/1686 - 63s - loss: 2.9960 - accuracy30: 0.4381 - val_loss: 4.3468 - val_accuracy30: 0.5860 - 63s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 60s - loss: 2.8723 - accuracy30: 0.4242 - val_loss: 3.9029 - val_accuracy30: 0.4989 - 60s/epoch - 36ms/step
Epoch 3/50
1686/1686 - 65s - loss: 2.6936 - accuracy30: 0.5157 - val_loss: 3.2460 - val_accuracy30: 0.4874 - 65s/epoch - 38ms/step
Epoch 4/50
1686/1686 - 64s - loss: 2.5816 - accuracy30: 0.5600 - val_loss: 3.2319 - val_accuracy30: 0.5463 - 64s/epoch - 38ms/step
Epoch 5/50
1686/1686 - 60s - loss: 2.4779 - accuracy30: 0.5903 - val_loss: 3.3495 - val_accuracy30: 0.5476 - 60s/epoch - 35ms/step
Epoch 6/50
1686/1686 - 59s - loss: 2.4288 - accuracy30: 0.6034 - val_loss: 3.3213 - val_accuracy30: 0.6096 - 59s/epoch - 35ms/step
Epoch 7/50
1686/1686 - 59s - loss: 2.3974 - accuracy30: 0.6118 - val_loss: 3.4372 - val_accuracy30: 0.6404 - 59s/epoch - 35ms/step
Epoch 8/50
1686/1686 - 65s - loss: 2.3748 - accuracy30: 0.6153 - val_loss: 3.2297 - val_accuracy30: 0.6366 - 65s/epoch - 38ms/step
Epoch 9/50
1686/1686 - 65s - loss: 2.3543 - accuracy30: 0.6209 - val_loss: 3.3485 - val_accuracy30: 0.6530 - 65s/epoch - 39ms/step
Epoch 10/50
1686/1686 - 60s - loss: 2.3434 - accuracy30: 0.6230 - val_loss: 3.3458 - val_accuracy30: 0.6598 - 60s/epoch - 35ms/step
Epoch 11/50
1686/1686 - 65s - loss: 2.3224 - accuracy30: 0.6275 - val_loss: 3.2057 - val_accuracy30: 0.6458 - 65s/epoch - 38ms/step
Epoch 12/50
1686/1686 - 60s - loss: 2.3066 - accuracy30: 0.6298 - val_loss: 3.1506 - val_accuracy30: 0.6599 - 60s/epoch - 35ms/step
Epoch 13/50
1686/1686 - 59s - loss: 2.2935 - accuracy30: 0.6321 - val_loss: 3.0876 - val_accuracy30: 0.6460 - 59s/epoch - 35ms/step
Epoch 14/50
1686/1686 - 64s - loss: 2.2814 - accuracy30: 0.6342 - val_loss: 3.0674 - val_accuracy30: 0.6340 - 64s/epoch - 38ms/step
Epoch 15/50
1686/1686 - 64s - loss: 2.2738 - accuracy30: 0.6352 - val_loss: 3.0643 - val_accuracy30: 0.6407 - 64s/epoch - 38ms/step
Epoch 16/50
1686/1686 - 65s - loss: 2.2615 - accuracy30: 0.6371 - val_loss: 3.0144 - val_accuracy30: 0.6339 - 65s/epoch - 38ms/step
Epoch 17/50
1686/1686 - 65s - loss: 2.2570 - accuracy30: 0.6386 - val_loss: 3.0636 - val_accuracy30: 0.6220 - 65s/epoch - 38ms/step
Epoch 18/50
1686/1686 - 64s - loss: 2.2502 - accuracy30: 0.6397 - val_loss: 3.1638 - val_accuracy30: 0.6269 - 64s/epoch - 38ms/step
Epoch 19/50
1686/1686 - 64s - loss: 2.2445 - accuracy30: 0.6397 - val_loss: 3.1407 - val_accuracy30: 0.6419 - 64s/epoch - 38ms/step
Epoch 20/50
1686/1686 - 64s - loss: 2.2380 - accuracy30: 0.6413 - val_loss: 3.0925 - val_accuracy30: 0.6370 - 64s/epoch - 38ms/step
Epoch 21/50
1686/1686 - 64s - loss: 2.2324 - accuracy30: 0.6417 - val_loss: 3.0326 - val_accuracy30: 0.6378 - 64s/epoch - 38ms/step
Epoch 22/50
1686/1686 - 64s - loss: 2.2236 - accuracy30: 0.6426 - val_loss: 3.1365 - val_accuracy30: 0.6320 - 64s/epoch - 38ms/step
Epoch 23/50
1686/1686 - 58s - loss: 2.2204 - accuracy30: 0.6435 - val_loss: 3.0740 - val_accuracy30: 0.6440 - 58s/epoch - 35ms/step
Epoch 24/50
1686/1686 - 57s - loss: 2.2148 - accuracy30: 0.6430 - val_loss: 3.0367 - val_accuracy30: 0.6288 - 57s/epoch - 34ms/step
Epoch 25/50
1686/1686 - 58s - loss: 2.2119 - accuracy30: 0.6438 - val_loss: 3.0879 - val_accuracy30: 0.6543 - 58s/epoch - 34ms/step
Epoch 26/50
1686/1686 - 57s - loss: 2.2058 - accuracy30: 0.6451 - val_loss: 3.0550 - val_accuracy30: 0.6471 - 57s/epoch - 34ms/step
testing model: results/AAL/W10/deepVOL_L3/h30
Evaluating performance on  test set...
10110/10110 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7707174
{'0': {'precision': 0.5015727698513451, 'recall': 0.48817869951989473, 'f1-score': 0.4947851053076419, 'support': 474271}, '1': {'precision': 0.7753579738059037, 'recall': 0.752418416824003, 'f1-score': 0.7637159766323787, 'support': 1636091}, '2': {'precision': 0.4608776022672227, 'recall': 0.5197921877845434, 'f1-score': 0.4885652226948457, 'support': 477739}, 'accuracy': 0.6610557315962553, 'macro avg': {'precision': 0.5792694486414905, 'recall': 0.5867964347094804, 'f1-score': 0.5823554348782888, 'support': 2588101}, 'weighted avg': {'precision': 0.6671365710541368, 'recall': 0.6610557315962553, 'f1-score': 0.6636440090741508, 'support': 2588101}}
[[ 231529  184542   58200]
 [ 172782 1231025  232284]
 [  57295  172119  248325]]
Evaluating performance on  train set...
1686/1686 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.724506
{'0': {'precision': 0.4616820088922287, 'recall': 0.5300977854472246, 'f1-score': 0.4935301402416575, 'support': 69540}, '1': {'precision': 0.8203823585084232, 'recall': 0.7401017066081973, 'f1-score': 0.7781769736405046, 'support': 292803}, '2': {'precision': 0.43142292715791397, 'recall': 0.5457710364752618, 'f1-score': 0.48190665697266544, 'support': 69225}, 'accuracy': 0.6750917584250917, 'macro avg': {'precision': 0.571162431519522, 'recall': 0.605323509510228, 'f1-score': 0.5845379236182758, 'support': 431568}, 'weighted avg': {'precision': 0.7001933293228738, 'recall': 0.6750917584250917, 'f1-score': 0.68478809062349, 'support': 431568}}
[[ 36863  24789   7888]
 [ 34195 216704  41904]
 [  8787  22657  37781]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8166258
{'0': {'precision': 0.433570824779616, 'recall': 0.5444454553725776, 'f1-score': 0.48272338594745756, 'support': 32973}, '1': {'precision': 0.7969224188850642, 'recall': 0.6929950407368048, 'f1-score': 0.7413340659548868, 'support': 112920}, '2': {'precision': 0.4442484380742374, 'recall': 0.5252455027374642, 'f1-score': 0.481363491557821, 'support': 34521}, 'accuracy': 0.6337479353043556, 'macro avg': {'precision': 0.5582472272463059, 'recall': 0.5875619996156155, 'f1-score': 0.568473647820055, 'support': 180414}, 'weighted avg': {'precision': 0.6630334157921252, 'recall': 0.6337479353043556, 'f1-score': 0.6443259947927483, 'support': 180414}}
[[17952 10226  4795]
 [16779 78253 17888]
 [ 6674  9715 18132]]
training model: results/AAL/W10/deepVOL_L3/h50
Epoch 1/50
1686/1686 - 63s - loss: 3.1308 - accuracy50: 0.4457 - val_loss: 4.0491 - val_accuracy50: 0.5126 - 63s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 64s - loss: 3.0045 - accuracy50: 0.4091 - val_loss: 4.0314 - val_accuracy50: 0.5136 - 64s/epoch - 38ms/step
Epoch 3/50
1686/1686 - 65s - loss: 2.9716 - accuracy50: 0.4089 - val_loss: 3.7565 - val_accuracy50: 0.5162 - 65s/epoch - 38ms/step
Epoch 4/50
1686/1686 - 65s - loss: 2.8988 - accuracy50: 0.4555 - val_loss: 3.4574 - val_accuracy50: 0.5100 - 65s/epoch - 38ms/step
Epoch 5/50
1686/1686 - 65s - loss: 2.7746 - accuracy50: 0.5284 - val_loss: 3.5517 - val_accuracy50: 0.5176 - 65s/epoch - 39ms/step
Epoch 6/50
1686/1686 - 65s - loss: 2.6886 - accuracy50: 0.5572 - val_loss: 3.2069 - val_accuracy50: 0.5375 - 65s/epoch - 38ms/step
Epoch 7/50
1686/1686 - 59s - loss: 2.6341 - accuracy50: 0.5733 - val_loss: 3.2302 - val_accuracy50: 0.5495 - 59s/epoch - 35ms/step
Epoch 8/50
1686/1686 - 58s - loss: 2.5908 - accuracy50: 0.5847 - val_loss: 3.1863 - val_accuracy50: 0.5519 - 58s/epoch - 34ms/step
Epoch 9/50
1686/1686 - 59s - loss: 2.5691 - accuracy50: 0.5902 - val_loss: 3.2171 - val_accuracy50: 0.5725 - 59s/epoch - 35ms/step
Epoch 10/50
1686/1686 - 64s - loss: 2.5529 - accuracy50: 0.5935 - val_loss: 3.1454 - val_accuracy50: 0.5717 - 64s/epoch - 38ms/step
Epoch 11/50
1686/1686 - 64s - loss: 2.5274 - accuracy50: 0.5987 - val_loss: 3.2213 - val_accuracy50: 0.5791 - 64s/epoch - 38ms/step
Epoch 12/50
1686/1686 - 64s - loss: 2.5146 - accuracy50: 0.6005 - val_loss: 3.1364 - val_accuracy50: 0.5749 - 64s/epoch - 38ms/step
Epoch 13/50
1686/1686 - 64s - loss: 2.5000 - accuracy50: 0.6018 - val_loss: 3.3148 - val_accuracy50: 0.5759 - 64s/epoch - 38ms/step
Epoch 14/50
1686/1686 - 57s - loss: 2.4887 - accuracy50: 0.6045 - val_loss: 3.1319 - val_accuracy50: 0.5906 - 57s/epoch - 34ms/step
Epoch 15/50
1686/1686 - 64s - loss: 2.4838 - accuracy50: 0.6040 - val_loss: 3.1015 - val_accuracy50: 0.5889 - 64s/epoch - 38ms/step
Epoch 16/50
1686/1686 - 58s - loss: 2.4709 - accuracy50: 0.6063 - val_loss: 3.1613 - val_accuracy50: 0.5889 - 58s/epoch - 34ms/step
Epoch 17/50
1686/1686 - 58s - loss: 2.4634 - accuracy50: 0.6067 - val_loss: 3.1187 - val_accuracy50: 0.6011 - 58s/epoch - 34ms/step
Epoch 18/50
1686/1686 - 58s - loss: 2.4573 - accuracy50: 0.6074 - val_loss: 3.1546 - val_accuracy50: 0.5998 - 58s/epoch - 34ms/step
Epoch 19/50
1686/1686 - 57s - loss: 2.4451 - accuracy50: 0.6088 - val_loss: 3.1416 - val_accuracy50: 0.6054 - 57s/epoch - 34ms/step
Epoch 20/50
1686/1686 - 57s - loss: 2.4383 - accuracy50: 0.6096 - val_loss: 3.1463 - val_accuracy50: 0.5980 - 57s/epoch - 34ms/step
Epoch 21/50
1686/1686 - 63s - loss: 2.4367 - accuracy50: 0.6104 - val_loss: 3.1958 - val_accuracy50: 0.5959 - 63s/epoch - 37ms/step
Epoch 22/50
1686/1686 - 59s - loss: 2.5054 - accuracy50: 0.5979 - val_loss: 3.0973 - val_accuracy50: 0.5941 - 59s/epoch - 35ms/step
Epoch 23/50
1686/1686 - 57s - loss: 2.4689 - accuracy50: 0.6041 - val_loss: 3.0243 - val_accuracy50: 0.6038 - 57s/epoch - 34ms/step
Epoch 24/50
1686/1686 - 64s - loss: 2.4406 - accuracy50: 0.6097 - val_loss: 2.9839 - val_accuracy50: 0.5964 - 64s/epoch - 38ms/step
Epoch 25/50
1686/1686 - 58s - loss: 2.4290 - accuracy50: 0.6115 - val_loss: 3.1020 - val_accuracy50: 0.5984 - 58s/epoch - 34ms/step
Epoch 26/50
1686/1686 - 63s - loss: 2.4216 - accuracy50: 0.6125 - val_loss: 3.0176 - val_accuracy50: 0.6048 - 63s/epoch - 37ms/step
Epoch 27/50
1686/1686 - 60s - loss: 2.4125 - accuracy50: 0.6134 - val_loss: 3.0083 - val_accuracy50: 0.5971 - 60s/epoch - 35ms/step
Epoch 28/50
1686/1686 - 59s - loss: 2.4097 - accuracy50: 0.6148 - val_loss: 3.0056 - val_accuracy50: 0.6041 - 59s/epoch - 35ms/step
Epoch 29/50
1686/1686 - 65s - loss: 2.4041 - accuracy50: 0.6148 - val_loss: 3.0542 - val_accuracy50: 0.6023 - 65s/epoch - 38ms/step
Epoch 30/50
1686/1686 - 65s - loss: 2.3993 - accuracy50: 0.6149 - val_loss: 3.0283 - val_accuracy50: 0.5898 - 65s/epoch - 38ms/step
Epoch 31/50
1686/1686 - 65s - loss: 2.3939 - accuracy50: 0.6160 - val_loss: 3.0427 - val_accuracy50: 0.5907 - 65s/epoch - 38ms/step
Epoch 32/50
1686/1686 - 64s - loss: 2.3910 - accuracy50: 0.6164 - val_loss: 3.0311 - val_accuracy50: 0.5930 - 64s/epoch - 38ms/step
Epoch 33/50
1686/1686 - 64s - loss: 2.3875 - accuracy50: 0.6174 - val_loss: 3.0752 - val_accuracy50: 0.6015 - 64s/epoch - 38ms/step
Epoch 34/50
1686/1686 - 65s - loss: 2.3835 - accuracy50: 0.6165 - val_loss: 3.0781 - val_accuracy50: 0.5891 - 65s/epoch - 38ms/step
testing model: results/AAL/W10/deepVOL_L3/h50
Evaluating performance on  test set...
10110/10110 - 142s - 142s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85774726
{'0': {'precision': 0.5484774820052328, 'recall': 0.42944820504505965, 'f1-score': 0.4817189552822695, 'support': 592104}, '1': {'precision': 0.6674066829159745, 'recall': 0.7380522326081467, 'f1-score': 0.7009539545309866, 'support': 1397939}, '2': {'precision': 0.48688863462741666, 'recall': 0.4710329098515529, 'f1-score': 0.47882954854500953, 'support': 598058}, 'accuracy': 0.6057472254753582, 'macro avg': {'precision': 0.5675909331828747, 'recall': 0.5461777825015864, 'f1-score': 0.5538341527860885, 'support': 2588101}, 'weighted avg': {'precision': 0.5984840564421962, 'recall': 0.6057472254753582, 'f1-score': 0.5994690441699443, 'support': 2588101}}
[[ 254278  257778   80048]
 [ 149358 1031752  216829]
 [  59971  256382  281705]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.802343
{'0': {'precision': 0.5173416671981631, 'recall': 0.4624620857944309, 'f1-score': 0.4883649521653531, 'support': 87698}, '1': {'precision': 0.7278945235162985, 'recall': 0.7277073414012639, 'f1-score': 0.7278009204235039, 'support': 256654}, '2': {'precision': 0.46044416834912255, 'recall': 0.5099064391854705, 'f1-score': 0.48391466858178134, 'support': 87216}, 'accuracy': 0.6297918288659029, 'macro avg': {'precision': 0.5685601196878614, 'recall': 0.5666919554603885, 'f1-score': 0.5666935137235461, 'support': 431568}, 'weighted avg': {'precision': 0.631059228569388, 'recall': 0.6297918288659029, 'f1-score': 0.6298584434907123, 'support': 431568}}
[[ 40557  35606  11535]
 [ 29307 186769  40578]
 [  8531  34213  44472]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8613501
{'0': {'precision': 0.49807657080051293, 'recall': 0.4691166321601104, 'f1-score': 0.48316303864948906, 'support': 40572}, '1': {'precision': 0.7011001285590845, 'recall': 0.6835675831175769, 'f1-score': 0.692222858034646, 'support': 97332}, '2': {'precision': 0.4692725619939539, 'recall': 0.5221830157609975, 'f1-score': 0.49431596762161384, 'support': 42510}, 'accuracy': 0.5973150642411342, 'macro avg': {'precision': 0.5561497537845171, 'recall': 0.5582890770128949, 'f1-score': 0.5565672881019162, 'support': 180414}, 'weighted avg': {'precision': 0.6008193208608767, 'recall': 0.5973150642411342, 'f1-score': 0.598577149256211, 'support': 180414}}
[[19033 14179  7360]
 [13054 66533 17745]
 [ 6126 14186 22198]]
training model: results/AAL/W10/deepVOL_L3/h100
Epoch 1/50
1686/1686 - 62s - loss: 3.1736 - accuracy100: 0.4394 - val_loss: 3.9453 - val_accuracy100: 0.3939 - 62s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 57s - loss: 3.1192 - accuracy100: 0.4308 - val_loss: 3.6790 - val_accuracy100: 0.3903 - 57s/epoch - 34ms/step
Epoch 3/50
1686/1686 - 58s - loss: 3.0958 - accuracy100: 0.4360 - val_loss: 3.9035 - val_accuracy100: 0.3929 - 58s/epoch - 34ms/step
Epoch 4/50
1686/1686 - 57s - loss: 3.0722 - accuracy100: 0.4455 - val_loss: 3.8145 - val_accuracy100: 0.3851 - 57s/epoch - 34ms/step
Epoch 5/50
1686/1686 - 59s - loss: 3.0376 - accuracy100: 0.4653 - val_loss: 3.9237 - val_accuracy100: 0.3934 - 59s/epoch - 35ms/step
Epoch 6/50
1686/1686 - 57s - loss: 3.0037 - accuracy100: 0.4808 - val_loss: 3.6699 - val_accuracy100: 0.4071 - 57s/epoch - 34ms/step
Epoch 7/50
1686/1686 - 57s - loss: 2.9545 - accuracy100: 0.5014 - val_loss: 3.5146 - val_accuracy100: 0.4536 - 57s/epoch - 34ms/step
Epoch 8/50
1686/1686 - 58s - loss: 2.9127 - accuracy100: 0.5181 - val_loss: 3.4149 - val_accuracy100: 0.4614 - 58s/epoch - 34ms/step
Epoch 9/50
1686/1686 - 58s - loss: 2.8702 - accuracy100: 0.5323 - val_loss: 3.3709 - val_accuracy100: 0.4754 - 58s/epoch - 34ms/step
Epoch 10/50
1686/1686 - 58s - loss: 2.8382 - accuracy100: 0.5399 - val_loss: 3.3239 - val_accuracy100: 0.4837 - 58s/epoch - 34ms/step
Epoch 11/50
1686/1686 - 58s - loss: 2.8207 - accuracy100: 0.5426 - val_loss: 3.3143 - val_accuracy100: 0.4883 - 58s/epoch - 34ms/step
Epoch 12/50
1686/1686 - 57s - loss: 2.8052 - accuracy100: 0.5465 - val_loss: 3.2900 - val_accuracy100: 0.4922 - 57s/epoch - 34ms/step
Epoch 13/50
1686/1686 - 57s - loss: 2.7947 - accuracy100: 0.5477 - val_loss: 3.2652 - val_accuracy100: 0.4959 - 57s/epoch - 34ms/step
Epoch 14/50
1686/1686 - 58s - loss: 2.7843 - accuracy100: 0.5500 - val_loss: 3.2483 - val_accuracy100: 0.4967 - 58s/epoch - 34ms/step
Epoch 15/50
1686/1686 - 58s - loss: 2.7753 - accuracy100: 0.5515 - val_loss: 3.2285 - val_accuracy100: 0.4974 - 58s/epoch - 34ms/step
Epoch 16/50
1686/1686 - 57s - loss: 2.7668 - accuracy100: 0.5536 - val_loss: 3.2486 - val_accuracy100: 0.4932 - 57s/epoch - 34ms/step
Epoch 17/50
1686/1686 - 57s - loss: 2.7620 - accuracy100: 0.5542 - val_loss: 3.2343 - val_accuracy100: 0.4980 - 57s/epoch - 34ms/step
Epoch 18/50
1686/1686 - 57s - loss: 2.7580 - accuracy100: 0.5551 - val_loss: 3.2633 - val_accuracy100: 0.4962 - 57s/epoch - 34ms/step
Epoch 19/50
1686/1686 - 57s - loss: 2.7503 - accuracy100: 0.5565 - val_loss: 3.2875 - val_accuracy100: 0.4963 - 57s/epoch - 34ms/step
Epoch 20/50
1686/1686 - 58s - loss: 2.7451 - accuracy100: 0.5573 - val_loss: 3.2543 - val_accuracy100: 0.4974 - 58s/epoch - 34ms/step
Epoch 21/50
1686/1686 - 57s - loss: 2.7388 - accuracy100: 0.5582 - val_loss: 3.2487 - val_accuracy100: 0.4985 - 57s/epoch - 34ms/step
Epoch 22/50
1686/1686 - 58s - loss: 2.7347 - accuracy100: 0.5596 - val_loss: 3.2423 - val_accuracy100: 0.5001 - 58s/epoch - 35ms/step
Epoch 23/50
1686/1686 - 57s - loss: 2.7284 - accuracy100: 0.5608 - val_loss: 3.1876 - val_accuracy100: 0.4984 - 57s/epoch - 34ms/step
Epoch 24/50
1686/1686 - 57s - loss: 2.7233 - accuracy100: 0.5625 - val_loss: 3.2697 - val_accuracy100: 0.4955 - 57s/epoch - 34ms/step
Epoch 25/50
1686/1686 - 58s - loss: 2.7163 - accuracy100: 0.5632 - val_loss: 3.2771 - val_accuracy100: 0.4996 - 58s/epoch - 34ms/step
Epoch 26/50
1686/1686 - 57s - loss: 2.7125 - accuracy100: 0.5642 - val_loss: 3.2909 - val_accuracy100: 0.4935 - 57s/epoch - 34ms/step
Epoch 27/50
1686/1686 - 58s - loss: 2.7072 - accuracy100: 0.5658 - val_loss: 3.2814 - val_accuracy100: 0.4976 - 58s/epoch - 34ms/step
Epoch 28/50
1686/1686 - 57s - loss: 2.7026 - accuracy100: 0.5657 - val_loss: 3.3614 - val_accuracy100: 0.4962 - 57s/epoch - 34ms/step
Epoch 29/50
1686/1686 - 57s - loss: 2.6967 - accuracy100: 0.5668 - val_loss: 3.3725 - val_accuracy100: 0.4960 - 57s/epoch - 34ms/step
Epoch 30/50
1686/1686 - 57s - loss: 2.6920 - accuracy100: 0.5683 - val_loss: 3.3313 - val_accuracy100: 0.4921 - 57s/epoch - 34ms/step
Epoch 31/50
1686/1686 - 57s - loss: 2.6857 - accuracy100: 0.5694 - val_loss: 3.3242 - val_accuracy100: 0.4901 - 57s/epoch - 34ms/step
Epoch 32/50
1686/1686 - 58s - loss: 2.6801 - accuracy100: 0.5705 - val_loss: 3.2660 - val_accuracy100: 0.4907 - 58s/epoch - 35ms/step
Epoch 33/50
1686/1686 - 57s - loss: 2.6742 - accuracy100: 0.5708 - val_loss: 3.3794 - val_accuracy100: 0.4935 - 57s/epoch - 34ms/step
testing model: results/AAL/W10/deepVOL_L3/h100
Evaluating performance on  test set...
10110/10110 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0295597
{'0': {'precision': 0.48687428020364293, 'recall': 0.4265168141774437, 'f1-score': 0.4547013172667382, 'support': 780056}, '1': {'precision': 0.5278085401536435, 'recall': 0.5800670535087789, 'f1-score': 0.5527052792842451, 'support': 1014712}, '2': {'precision': 0.47047566457143075, 'recall': 0.4682434740518798, 'f1-score': 0.46935691533651486, 'support': 793333}, 'accuracy': 0.49950948591264405, 'macro avg': {'precision': 0.49505282830957237, 'recall': 0.49160911391270073, 'f1-score': 0.4922545039624994, 'support': 2588101}, 'weighted avg': {'precision': 0.4978966173717192, 'recall': 0.49950948591264405, 'f1-score': 0.49761794451204217, 'support': 2588101}}
[[332707 272431 174918]
 [182933 588601 243178]
 [167713 254147 371473]]
Evaluating performance on  train set...
1686/1686 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9719734
{'0': {'precision': 0.47618578314548354, 'recall': 0.450778168864764, 'f1-score': 0.463133771060348, 'support': 117905}, '1': {'precision': 0.611069069718357, 'recall': 0.6026430555061965, 'f1-score': 0.6068268144429505, 'support': 196969}, '2': {'precision': 0.45993269743279686, 'recall': 0.4954324986717398, 'f1-score': 0.4770230409043091, 'support': 116694}, 'accuracy': 0.5321641085529975, 'macro avg': {'precision': 0.5157291834322125, 'recall': 0.5162845743475667, 'f1-score': 0.5156612088025359, 'support': 431568}, 'weighted avg': {'precision': 0.5333521821574957, 'recall': 0.5321641085529975, 'f1-score': 0.5324713250893748, 'support': 431568}}
[[ 53149  40311  24445]
 [ 34825 118702  43442]
 [ 23640  35240  57814]]
Evaluating performance on  val set...
705/705 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0247897
{'0': {'precision': 0.4456030126979922, 'recall': 0.4482410721084292, 'f1-score': 0.4469181494661922, 'support': 52532}, '1': {'precision': 0.5661939050112735, 'recall': 0.5364767824900417, 'f1-score': 0.550934903537205, 'support': 72553}, '2': {'precision': 0.46418250433481795, 'recall': 0.4935205769126498, 'f1-score': 0.47840217248477945, 'support': 55329}, 'accuracy': 0.49761105014023305, 'macro avg': {'precision': 0.4919931406813613, 'recall': 0.49274614383704024, 'f1-score': 0.49208507516272554, 'support': 180414}, 'weighted avg': {'precision': 0.49979623330603495, 'recall': 0.49761105014023305, 'f1-score': 0.4984036609437361, 'support': 180414}}
[[23547 15460 13525]
 [15635 38923 17995]
 [13661 14362 27306]]
training model: results/AAL/W10/deepVOL_L3/h200
Epoch 1/50
1686/1686 - 63s - loss: 3.2485 - accuracy200: 0.3971 - val_loss: 3.5335 - val_accuracy200: 0.2999 - 63s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 59s - loss: 3.2277 - accuracy200: 0.4023 - val_loss: 3.4234 - val_accuracy200: 0.3030 - 59s/epoch - 35ms/step
Epoch 3/50
1686/1686 - 61s - loss: 3.2068 - accuracy200: 0.4106 - val_loss: 3.4160 - val_accuracy200: 0.3785 - 61s/epoch - 36ms/step
Epoch 4/50
1686/1686 - 60s - loss: 3.1925 - accuracy200: 0.4153 - val_loss: 3.3717 - val_accuracy200: 0.3474 - 60s/epoch - 36ms/step
Epoch 5/50
1686/1686 - 60s - loss: 3.1601 - accuracy200: 0.4343 - val_loss: 3.3010 - val_accuracy200: 0.3915 - 60s/epoch - 36ms/step
Epoch 6/50
1686/1686 - 60s - loss: 3.1292 - accuracy200: 0.4509 - val_loss: 3.3398 - val_accuracy200: 0.4024 - 60s/epoch - 36ms/step
Epoch 7/50
1686/1686 - 60s - loss: 3.1107 - accuracy200: 0.4578 - val_loss: 3.3296 - val_accuracy200: 0.4124 - 60s/epoch - 36ms/step
Epoch 8/50
1686/1686 - 59s - loss: 3.0946 - accuracy200: 0.4648 - val_loss: 3.3001 - val_accuracy200: 0.4156 - 59s/epoch - 35ms/step
Epoch 9/50
1686/1686 - 59s - loss: 3.0897 - accuracy200: 0.4662 - val_loss: 3.3981 - val_accuracy200: 0.3912 - 59s/epoch - 35ms/step
Epoch 10/50
1686/1686 - 59s - loss: 3.0773 - accuracy200: 0.4719 - val_loss: 3.4926 - val_accuracy200: 0.4058 - 59s/epoch - 35ms/step
Epoch 11/50
1686/1686 - 62s - loss: 3.0653 - accuracy200: 0.4753 - val_loss: 3.3523 - val_accuracy200: 0.4170 - 62s/epoch - 37ms/step
Epoch 12/50
1686/1686 - 62s - loss: 3.0553 - accuracy200: 0.4793 - val_loss: 3.3355 - val_accuracy200: 0.4163 - 62s/epoch - 37ms/step
Epoch 13/50
1686/1686 - 57s - loss: 3.0430 - accuracy200: 0.4838 - val_loss: 3.3887 - val_accuracy200: 0.4202 - 57s/epoch - 34ms/step
Epoch 14/50
1686/1686 - 61s - loss: 3.0303 - accuracy200: 0.4869 - val_loss: 3.3459 - val_accuracy200: 0.4206 - 61s/epoch - 36ms/step
Epoch 15/50
1686/1686 - 59s - loss: 3.0224 - accuracy200: 0.4883 - val_loss: 3.3015 - val_accuracy200: 0.4216 - 59s/epoch - 35ms/step
Epoch 16/50
1686/1686 - 58s - loss: 3.0084 - accuracy200: 0.4922 - val_loss: 3.3538 - val_accuracy200: 0.4238 - 58s/epoch - 34ms/step
Epoch 17/50
1686/1686 - 62s - loss: 2.9959 - accuracy200: 0.4949 - val_loss: 3.3475 - val_accuracy200: 0.4238 - 62s/epoch - 37ms/step
Epoch 18/50
1686/1686 - 61s - loss: 2.9881 - accuracy200: 0.4960 - val_loss: 3.3905 - val_accuracy200: 0.4239 - 61s/epoch - 36ms/step
testing model: results/AAL/W10/deepVOL_L3/h200
Evaluating performance on  test set...
10110/10110 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155653
{'0': {'precision': 0.45308780393441844, 'recall': 0.24584382062184712, 'f1-score': 0.3187402969986308, 'support': 933670}, '1': {'precision': 0.33559716697390124, 'recall': 0.42210999658025544, 'f1-score': 0.37391468846413217, 'support': 704731}, '2': {'precision': 0.43374616034065966, 'recall': 0.545821838475308, 'f1-score': 0.4833725212642898, 'support': 949700}, 'accuracy': 0.40391700323905444, 'macro avg': {'precision': 0.40747704374965976, 'recall': 0.4045918852258035, 'f1-score': 0.39200916890901766, 'support': 2588101}, 'weighted avg': {'precision': 0.4139981188731264, 'recall': 0.40391700323905444, 'f1-score': 0.3941756557643709, 'support': 2588101}}
[[229537 310711 393422]
 [123953 297474 283304]
 [153116 278217 518367]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0817816
{'0': {'precision': 0.4474655222044854, 'recall': 0.2370219431391303, 'f1-score': 0.30989361509324537, 'support': 144282}, '1': {'precision': 0.42513948339483393, 'recall': 0.49434314586994726, 'f1-score': 0.4571370528728189, 'support': 145664}, '2': {'precision': 0.4164787071977262, 'recall': 0.5462993037804861, 'f1-score': 0.472636527189368, 'support': 141622}, 'accuracy': 0.4253651799948096, 'macro avg': {'precision': 0.42969457093234853, 'recall': 0.42588813092985456, 'f1-score': 0.41322239838514413, 'support': 431568}, 'weighted avg': {'precision': 0.429761441197422, 'recall': 0.4253651799948096, 'f1-score': 0.4129968220446432, 'support': 431568}}
[[34198 53026 57058]
 [22315 72008 51341]
 [19913 44341 77368]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981889
{'0': {'precision': 0.4091079812206573, 'recall': 0.21262993509345565, 'f1-score': 0.27982402620339747, 'support': 61473}, '1': {'precision': 0.3932833407757572, 'recall': 0.47211593559954895, 'f1-score': 0.4291090539473463, 'support': 54099}, '2': {'precision': 0.43634535027118926, 'recall': 0.5620431201998705, 'f1-score': 0.4912815189771034, 'support': 64842}, 'accuracy': 0.4160209296396067, 'macro avg': {'precision': 0.4129122240892012, 'recall': 0.41559633029762505, 'f1-score': 0.4000715330426157, 'support': 180414}, 'weighted avg': {'precision': 0.4141520923237088, 'recall': 0.4160209296396067, 'f1-score': 0.4005879218121226, 'support': 180414}}
[[13071 20894 27508]
 [ 8989 25541 19569]
 [ 9890 18508 36444]]
training model: results/AAL/W10/deepVOL_L3/h300
Epoch 1/50
1686/1686 - 62s - loss: 3.2582 - accuracy300: 0.3882 - val_loss: 3.4574 - val_accuracy300: 0.2879 - 62s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 59s - loss: 3.2689 - accuracy300: 0.3712 - val_loss: 3.5250 - val_accuracy300: 0.2880 - 59s/epoch - 35ms/step
Epoch 3/50
1686/1686 - 64s - loss: 3.2731 - accuracy300: 0.3690 - val_loss: 3.4258 - val_accuracy300: 0.2880 - 64s/epoch - 38ms/step
Epoch 4/50
1686/1686 - 64s - loss: 3.2649 - accuracy300: 0.3795 - val_loss: 3.4662 - val_accuracy300: 0.2880 - 64s/epoch - 38ms/step
Epoch 5/50
1686/1686 - 66s - loss: 3.2458 - accuracy300: 0.3901 - val_loss: 3.3858 - val_accuracy300: 0.2906 - 66s/epoch - 39ms/step
Epoch 6/50
1686/1686 - 64s - loss: 3.2322 - accuracy300: 0.3999 - val_loss: 3.4345 - val_accuracy300: 0.2998 - 64s/epoch - 38ms/step
Epoch 7/50
1686/1686 - 64s - loss: 3.2164 - accuracy300: 0.4097 - val_loss: 3.5178 - val_accuracy300: 0.2989 - 64s/epoch - 38ms/step
Epoch 8/50
1686/1686 - 65s - loss: 3.1995 - accuracy300: 0.4188 - val_loss: 3.5266 - val_accuracy300: 0.3083 - 65s/epoch - 39ms/step
Epoch 9/50
1686/1686 - 65s - loss: 3.1896 - accuracy300: 0.4254 - val_loss: 3.4942 - val_accuracy300: 0.3076 - 65s/epoch - 38ms/step
Epoch 10/50
1686/1686 - 58s - loss: 3.1770 - accuracy300: 0.4334 - val_loss: 3.5243 - val_accuracy300: 0.3064 - 58s/epoch - 35ms/step
Epoch 11/50
1686/1686 - 57s - loss: 3.1680 - accuracy300: 0.4367 - val_loss: 3.5095 - val_accuracy300: 0.3152 - 57s/epoch - 34ms/step
Epoch 12/50
1686/1686 - 57s - loss: 3.1587 - accuracy300: 0.4404 - val_loss: 3.5460 - val_accuracy300: 0.3119 - 57s/epoch - 34ms/step
Epoch 13/50
1686/1686 - 58s - loss: 3.1523 - accuracy300: 0.4437 - val_loss: 3.4135 - val_accuracy300: 0.3341 - 58s/epoch - 34ms/step
Epoch 14/50
1686/1686 - 57s - loss: 3.1454 - accuracy300: 0.4469 - val_loss: 3.4314 - val_accuracy300: 0.3390 - 57s/epoch - 34ms/step
Epoch 15/50
1686/1686 - 58s - loss: 3.1383 - accuracy300: 0.4499 - val_loss: 3.4017 - val_accuracy300: 0.3427 - 58s/epoch - 34ms/step
testing model: results/AAL/W10/deepVOL_L3/h300
Evaluating performance on  test set...
10110/10110 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1518465
{'0': {'precision': 0.5105853051058531, 'recall': 0.0004254294762444331, 'f1-score': 0.0008501505906991451, 'support': 963732}, '1': {'precision': 0.24875661236534902, 'recall': 0.9577618265958138, 'f1-score': 0.3949373333108134, 'support': 646974}, '2': {'precision': 0.4390942785062447, 'recall': 0.04327216734278362, 'f1-score': 0.07878060865256735, 'support': 977395}, 'accuracy': 0.2559216197513157, 'macro avg': {'precision': 0.39947873199248224, 'recall': 0.3338198078049473, 'f1-score': 0.1581893641846933, 'support': 2588101}, 'weighted avg': {'precision': 0.4181347675880286, 'recall': 0.2559216197513157, 'f1-score': 0.12879453955022696, 'support': 2588101}}
[[   410 936436  26886]
 [   186 619647  27141]
 [   207 934894  42294]]
Evaluating performance on  train set...
1686/1686 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200773
{'0': {'precision': 0.448, 'recall': 0.0003760181025857959, 'f1-score': 0.0007514055308814255, 'support': 148929}, '1': {'precision': 0.31492238007099577, 'recall': 0.9564787194277297, 'f1-score': 0.47383403227856147, 'support': 136439}, '2': {'precision': 0.40581749941355855, 'recall': 0.047332421340629274, 'f1-score': 0.08477690931810943, 'support': 146200}, 'accuracy': 0.31855234864494125, 'macro avg': {'precision': 0.3895799598281848, 'recall': 0.3347290529569816, 'f1-score': 0.1864541157091841, 'support': 431568}, 'weighted avg': {'precision': 0.3916379458828478, 'recall': 0.31855234864494125, 'f1-score': 0.17878001090597745, 'support': 431568}}
[[    56 144628   4245]
 [    51 130501   5887]
 [    18 139262   6920]]
Evaluating performance on  val set...
705/705 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1377137
{'0': {'precision': 0.4897959183673469, 'recall': 0.0003852512962100904, 'f1-score': 0.000769897026272736, 'support': 62297}, '1': {'precision': 0.2865391804457225, 'recall': 0.959203711903891, 'f1-score': 0.44126191235342055, 'support': 51941}, '2': {'precision': 0.4228043143297381, 'recall': 0.0414651837524178, 'f1-score': 0.07552362865714365, 'support': 66176}, 'accuracy': 0.29149622534836545, 'macro avg': {'precision': 0.39971313771426925, 'recall': 0.3336847156508396, 'f1-score': 0.1725184793456123, 'support': 180414}, 'weighted avg': {'precision': 0.4067059441237744, 'recall': 0.29149622534836545, 'f1-score': 0.15500681163662391, 'support': 180414}}
[[   24 60631  1642]
 [   15 49822  2104]
 [   10 63422  2744]]
training model: results/AAL/W10/deepVOL_L3/h500
Epoch 1/50
1686/1686 - 63s - loss: 3.2777 - accuracy500: 0.3814 - val_loss: 3.4931 - val_accuracy500: 0.3026 - 63s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 58s - loss: 3.2739 - accuracy500: 0.3742 - val_loss: 3.5213 - val_accuracy500: 0.3026 - 58s/epoch - 34ms/step
Epoch 3/50
1686/1686 - 57s - loss: 3.2671 - accuracy500: 0.3802 - val_loss: 3.4372 - val_accuracy500: 0.3026 - 57s/epoch - 34ms/step
Epoch 4/50
1686/1686 - 58s - loss: 3.2612 - accuracy500: 0.3844 - val_loss: 3.4234 - val_accuracy500: 0.3033 - 58s/epoch - 34ms/step
Epoch 5/50
1686/1686 - 57s - loss: 3.2501 - accuracy500: 0.3943 - val_loss: 3.4871 - val_accuracy500: 0.3042 - 57s/epoch - 34ms/step
Epoch 6/50
1686/1686 - 57s - loss: 3.2391 - accuracy500: 0.4038 - val_loss: 3.5257 - val_accuracy500: 0.3030 - 57s/epoch - 34ms/step
Epoch 7/50
1686/1686 - 57s - loss: 3.2282 - accuracy500: 0.4104 - val_loss: 3.5808 - val_accuracy500: 0.3071 - 57s/epoch - 34ms/step
Epoch 8/50
1686/1686 - 57s - loss: 3.2154 - accuracy500: 0.4183 - val_loss: 3.5935 - val_accuracy500: 0.3066 - 57s/epoch - 34ms/step
Epoch 9/50
1686/1686 - 57s - loss: 3.2046 - accuracy500: 0.4255 - val_loss: 3.5966 - val_accuracy500: 0.3095 - 57s/epoch - 34ms/step
Epoch 10/50
1686/1686 - 57s - loss: 3.1955 - accuracy500: 0.4301 - val_loss: 3.6365 - val_accuracy500: 0.3121 - 57s/epoch - 34ms/step
Epoch 11/50
1686/1686 - 57s - loss: 3.1851 - accuracy500: 0.4344 - val_loss: 3.6286 - val_accuracy500: 0.3122 - 57s/epoch - 34ms/step
Epoch 12/50
1686/1686 - 57s - loss: 3.1795 - accuracy500: 0.4371 - val_loss: 3.6492 - val_accuracy500: 0.3126 - 57s/epoch - 34ms/step
Epoch 13/50
1686/1686 - 57s - loss: 3.1681 - accuracy500: 0.4429 - val_loss: 3.6244 - val_accuracy500: 0.3158 - 57s/epoch - 34ms/step
Epoch 14/50
1686/1686 - 57s - loss: 3.1645 - accuracy500: 0.4436 - val_loss: 3.5627 - val_accuracy500: 0.3180 - 57s/epoch - 34ms/step
testing model: results/AAL/W10/deepVOL_L3/h500
Evaluating performance on  test set...
10110/10110 - 173s - 173s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1683905
{'0': {'precision': 0.40635120546959336, 'recall': 0.00479773464501862, 'f1-score': 0.009483498879909973, 'support': 941486}, '1': {'precision': 0.26431709307191803, 'recall': 0.9913307680278959, 'f1-score': 0.41735533503537964, 'support': 684259}, '2': {'precision': 0.4360852822391284, 'recall': 0.004824617916862367, 'f1-score': 0.009543649916803957, 'support': 962356}, 'accuracy': 0.2656337600425949, 'macro avg': {'precision': 0.3689178602602132, 'recall': 0.33365104019659225, 'f1-score': 0.14546082794403117, 'support': 2588101}, 'weighted avg': {'precision': 0.3798555808662652, 'recall': 0.2656337600425949, 'f1-score': 0.11734167808047698, 'support': 2588101}}
[[  4517 933803   3166]
 [  3094 678327   2838]
 [  3505 954208   4643]]
Evaluating performance on  train set...
1686/1686 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1328505
{'0': {'precision': 0.40375802016498624, 'recall': 0.005967298392012896, 'f1-score': 0.011760779602189294, 'support': 147638}, '1': {'precision': 0.31983781039351805, 'recall': 0.9898838489166957, 'f1-score': 0.48346498743583083, 'support': 138096}, '2': {'precision': 0.419647355163728, 'recall': 0.005711973888119368, 'f1-score': 0.01127054032296254, 'support': 145834}, 'accuracy': 0.3207211841471101, 'macro avg': {'precision': 0.38108106190741076, 'recall': 0.33385437373227594, 'f1-score': 0.16883210245366087, 'support': 431568}, 'weighted avg': {'precision': 0.38227394347627397, 'recall': 0.3207211841471101, 'f1-score': 0.16253417042344528, 'support': 431568}}
[[   881 146264    493]
 [   738 136699    659]
 [   563 144438    833]]
Evaluating performance on  val set...
705/705 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1481084
{'0': {'precision': 0.4557260920897285, 'recall': 0.006382697268337853, 'f1-score': 0.012589077507623567, 'support': 60476}, '1': {'precision': 0.3025731386697992, 'recall': 0.990840981114103, 'f1-score': 0.46358217525636247, 'support': 54591}, '2': {'precision': 0.37641154328732745, 'recall': 0.004590876398304436, 'f1-score': 0.009071117561683599, 'support': 65347}, 'accuracy': 0.3036183444743756, 'macro avg': {'precision': 0.37823692468228504, 'recall': 0.3339381849269151, 'f1-score': 0.1617474567752232, 'support': 180414}, 'weighted avg': {'precision': 0.38065574998358453, 'recall': 0.3036183444743756, 'f1-score': 0.14777967286393773, 'support': 180414}}
[[  386 59849   241]
 [  244 54091   256]
 [  217 64830   300]]
training model: results/AAL/W10/deepVOL_L3/h1000
Epoch 1/50
1686/1686 - 62s - loss: 3.2041 - accuracy1000: 0.4227 - val_loss: 3.3283 - val_accuracy1000: 0.3204 - 62s/epoch - 37ms/step
Epoch 2/50
1686/1686 - 58s - loss: 3.2166 - accuracy1000: 0.4149 - val_loss: 3.3606 - val_accuracy1000: 0.3175 - 58s/epoch - 34ms/step
Epoch 3/50
1686/1686 - 58s - loss: 3.1966 - accuracy1000: 0.4327 - val_loss: 3.4147 - val_accuracy1000: 0.3240 - 58s/epoch - 35ms/step
Epoch 4/50
1686/1686 - 59s - loss: 3.1882 - accuracy1000: 0.4342 - val_loss: 3.3961 - val_accuracy1000: 0.3219 - 59s/epoch - 35ms/step
Epoch 5/50
1686/1686 - 59s - loss: 3.2085 - accuracy1000: 0.4258 - val_loss: 3.4049 - val_accuracy1000: 0.3193 - 59s/epoch - 35ms/step
Epoch 6/50
1686/1686 - 57s - loss: 3.2063 - accuracy1000: 0.4284 - val_loss: 3.4311 - val_accuracy1000: 0.3170 - 57s/epoch - 34ms/step
Epoch 7/50
1686/1686 - 59s - loss: 3.1910 - accuracy1000: 0.4395 - val_loss: 3.4381 - val_accuracy1000: 0.3191 - 59s/epoch - 35ms/step
Epoch 8/50
1686/1686 - 59s - loss: 3.1901 - accuracy1000: 0.4384 - val_loss: 3.4473 - val_accuracy1000: 0.3191 - 59s/epoch - 35ms/step
Epoch 9/50
1686/1686 - 58s - loss: 3.1894 - accuracy1000: 0.4375 - val_loss: 3.3878 - val_accuracy1000: 0.3277 - 58s/epoch - 35ms/step
Epoch 10/50
1686/1686 - 60s - loss: 3.1823 - accuracy1000: 0.4416 - val_loss: 3.4616 - val_accuracy1000: 0.3227 - 60s/epoch - 36ms/step
Epoch 11/50
1686/1686 - 59s - loss: 3.1756 - accuracy1000: 0.4451 - val_loss: 3.4588 - val_accuracy1000: 0.3216 - 59s/epoch - 35ms/step
testing model: results/AAL/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
10110/10110 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1160545
{'0': {'precision': 0.39665624083057077, 'recall': 0.6198470869547826, 'f1-score': 0.48374896309868554, 'support': 1025027}, '1': {'precision': 0.19850375847699975, 'recall': 0.37632049752939173, 'f1-score': 0.259909119599463, 'support': 516472}, '2': {'precision': 0.38993185926853013, 'recall': 0.0026791464186003847, 'f1-score': 0.005321728271112068, 'support': 1046602}, 'accuracy': 0.321673304094392, 'macro avg': {'precision': 0.3283639528587002, 'recall': 0.33294891030092494, 'f1-score': 0.24965993698975353, 'support': 2588101}, 'weighted avg': {'precision': 0.3543943816304436, 'recall': 0.321673304094392, 'f1-score': 0.24560914070507006, 'support': 2588101}}
[[635360 386862   2805]
 [320531 194359   1582]
 [645899 397899   2804]]
Evaluating performance on  train set...
1686/1686 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036452
{'0': {'precision': 0.33414794040179524, 'recall': 0.5895465184718781, 'f1-score': 0.42653878244249294, 'support': 146114}, '1': {'precision': 0.31849126567977054, 'recall': 0.38429272521357366, 'f1-score': 0.34831150974061975, 'support': 143042}, '2': {'precision': 0.3432203389830508, 'recall': 0.002843861472347836, 'f1-score': 0.005640982784556243, 'support': 142412}, 'accuracy': 0.32791124457791127, 'macro avg': {'precision': 0.33195318168820553, 'recall': 0.32556103505259987, 'f1-score': 0.2601637583225563, 'support': 431568}, 'weighted avg': {'precision': 0.33195235676530205, 'recall': 0.32791124457791127, 'f1-score': 0.261719604499023, 'support': 431568}}
[[86141 59547   426]
 [87723 54970   349]
 [83929 58078   405]]
Evaluating performance on  val set...
705/705 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080657
{'0': {'precision': 0.3189849657985453, 'recall': 0.6143418262713337, 'f1-score': 0.4199296711651777, 'support': 57538}, '1': {'precision': 0.32349919696728546, 'recall': 0.38027689900329964, 'f1-score': 0.34959775461859005, 'support': 58794}, '2': {'precision': 0.3264887063655031, 'recall': 0.0024811959676664273, 'f1-score': 0.004924963992008548, 'support': 64082}, 'accuracy': 0.3207345327967896, 'macro avg': {'precision': 0.3229909563771113, 'recall': 0.3323666404140999, 'f1-score': 0.25815079659192547, 'support': 180414}, 'weighted avg': {'precision': 0.32312136547011566, 'recall': 0.3207345327967896, 'f1-score': 0.24960238865655257, 'support': 180414}}
[[35348 22031   159]
 [36267 22358   169]
 [39199 24724   159]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        25 (peak)  20.40 (ave)

============================================
