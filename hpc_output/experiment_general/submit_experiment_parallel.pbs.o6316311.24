This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-17.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-09.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-27.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-28.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-05.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-01.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-03.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-02.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-04.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-26.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-10.csv
training model: results/PCAR/W2/deepLOB_L1/h10
Epoch 1/50
716/716 - 33s - loss: 3.1624 - accuracy10: 0.4372 - val_loss: 3.7440 - val_accuracy10: 0.3769 - 33s/epoch - 47ms/step
Epoch 2/50
716/716 - 19s - loss: 3.1123 - accuracy10: 0.4526 - val_loss: 3.4029 - val_accuracy10: 0.4110 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 20s - loss: 3.0549 - accuracy10: 0.4717 - val_loss: 3.4771 - val_accuracy10: 0.4276 - 20s/epoch - 28ms/step
Epoch 4/50
716/716 - 19s - loss: 3.0255 - accuracy10: 0.4824 - val_loss: 3.7302 - val_accuracy10: 0.4042 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 19s - loss: 3.0025 - accuracy10: 0.4895 - val_loss: 3.6747 - val_accuracy10: 0.4060 - 19s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 2.9783 - accuracy10: 0.4972 - val_loss: 3.6777 - val_accuracy10: 0.4049 - 20s/epoch - 27ms/step
Epoch 7/50
716/716 - 20s - loss: 2.9650 - accuracy10: 0.5010 - val_loss: 3.5974 - val_accuracy10: 0.4167 - 20s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 2.9506 - accuracy10: 0.5062 - val_loss: 3.7194 - val_accuracy10: 0.4069 - 19s/epoch - 26ms/step
Epoch 9/50
716/716 - 19s - loss: 2.9381 - accuracy10: 0.5105 - val_loss: 3.5654 - val_accuracy10: 0.4246 - 19s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 2.9277 - accuracy10: 0.5118 - val_loss: 3.6637 - val_accuracy10: 0.4156 - 19s/epoch - 26ms/step
Epoch 11/50
716/716 - 20s - loss: 2.9179 - accuracy10: 0.5151 - val_loss: 3.6615 - val_accuracy10: 0.4161 - 20s/epoch - 28ms/step
Epoch 12/50
716/716 - 19s - loss: 2.9110 - accuracy10: 0.5169 - val_loss: 3.6509 - val_accuracy10: 0.4208 - 19s/epoch - 26ms/step
testing model: results/PCAR/W2/deepLOB_L1/h10
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0638158
{'0': {'precision': 0.4195780848977207, 'recall': 0.39630264687912653, 'f1-score': 0.4076083651474712, 'support': 152217}, '1': {'precision': 0.4495072672456464, 'recall': 0.27502340179505536, 'f1-score': 0.34125544452984885, 'support': 181610}, '2': {'precision': 0.4149835553607822, 'recall': 0.6248494477615765, 'f1-score': 0.4987382485816482, 'support': 156092}, 'accuracy': 0.4241619533024847, 'macro avg': {'precision': 0.4280229691680497, 'recall': 0.43205849881191943, 'f1-score': 0.4158673527529894, 'support': 489919}, 'weighted avg': {'precision': 0.42920879834571307, 'recall': 0.4241619533024847, 'f1-score': 0.4120464290960855, 'support': 489919}}
[[60324 31317 60576]
 [54742 49947 76921]
 [28707 29851 97534]]
Evaluating performance on  train set...
716/716 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0558937
{'0': {'precision': 0.40789333048311244, 'recall': 0.28906057679562197, 'f1-score': 0.33834628129398336, 'support': 52809}, '1': {'precision': 0.46893764827406154, 'recall': 0.5405985422473468, 'f1-score': 0.5022247076272217, 'support': 76419}, '2': {'precision': 0.40693513081546856, 'recall': 0.4349456874941974, 'f1-score': 0.42047443388351863, 'support': 53855}, 'accuracy': 0.43696574777559904, 'macro avg': {'precision': 0.4279220365242142, 'recall': 0.42153493551238874, 'f1-score': 0.42034847426824123, 'support': 183083}, 'weighted avg': {'precision': 0.43309142030120357, 'recall': 0.43696574777559904, 'f1-score': 0.4309077813768374, 'support': 183083}}
[[15265 23543 14001]
 [14970 41312 20137]
 [ 7189 23242 23424]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0857904
{'0': {'precision': 0.4600406053894426, 'recall': 0.2742024202420242, 'f1-score': 0.34360352908740005, 'support': 18180}, '1': {'precision': 0.3894029780637888, 'recall': 0.450984658905451, 'f1-score': 0.41793753623553725, 'support': 18382}, '2': {'precision': 0.40756358471303655, 'recall': 0.507517134645147, 'f1-score': 0.45208143571059306, 'support': 18092}, 'accuracy': 0.41089398763128043, 'macro avg': {'precision': 0.419002389388756, 'recall': 0.41090140459754076, 'f1-score': 0.4045408336778435, 'support': 54654}, 'weighted avg': {'precision': 0.4189114085588775, 'recall': 0.41089398763128043, 'f1-score': 0.40451380108988605, 'support': 54654}}
[[4985 6526 6669]
 [3414 8290 6678]
 [2437 6473 9182]]
training model: results/PCAR/W2/deepLOB_L1/h20
Epoch 1/50
716/716 - 22s - loss: 3.2055 - accuracy20: 0.4238 - val_loss: 3.5348 - val_accuracy20: 0.3111 - 22s/epoch - 31ms/step
Epoch 2/50
716/716 - 19s - loss: 3.1462 - accuracy20: 0.4524 - val_loss: 3.4811 - val_accuracy20: 0.3307 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 20s - loss: 3.1130 - accuracy20: 0.4634 - val_loss: 3.4440 - val_accuracy20: 0.3183 - 20s/epoch - 28ms/step
Epoch 4/50
716/716 - 19s - loss: 3.0832 - accuracy20: 0.4741 - val_loss: 3.4621 - val_accuracy20: 0.3658 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 20s - loss: 3.0613 - accuracy20: 0.4798 - val_loss: 3.4200 - val_accuracy20: 0.3800 - 20s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 3.0466 - accuracy20: 0.4838 - val_loss: 3.4601 - val_accuracy20: 0.3716 - 20s/epoch - 28ms/step
Epoch 7/50
716/716 - 19s - loss: 3.0351 - accuracy20: 0.4859 - val_loss: 3.4922 - val_accuracy20: 0.3741 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 3.0199 - accuracy20: 0.4904 - val_loss: 3.4881 - val_accuracy20: 0.3706 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 19s - loss: 3.0101 - accuracy20: 0.4933 - val_loss: 3.5071 - val_accuracy20: 0.3785 - 19s/epoch - 27ms/step
Epoch 10/50
716/716 - 20s - loss: 2.9986 - accuracy20: 0.4968 - val_loss: 3.4896 - val_accuracy20: 0.3812 - 20s/epoch - 27ms/step
Epoch 11/50
716/716 - 19s - loss: 2.9890 - accuracy20: 0.4996 - val_loss: 3.4930 - val_accuracy20: 0.3843 - 19s/epoch - 27ms/step
Epoch 12/50
716/716 - 19s - loss: 2.9832 - accuracy20: 0.5014 - val_loss: 3.4909 - val_accuracy20: 0.3888 - 19s/epoch - 27ms/step
Epoch 13/50
716/716 - 20s - loss: 2.9745 - accuracy20: 0.5032 - val_loss: 3.4847 - val_accuracy20: 0.3934 - 20s/epoch - 28ms/step
Epoch 14/50
716/716 - 20s - loss: 2.9686 - accuracy20: 0.5053 - val_loss: 3.4630 - val_accuracy20: 0.3954 - 20s/epoch - 27ms/step
Epoch 15/50
716/716 - 19s - loss: 2.9626 - accuracy20: 0.5061 - val_loss: 3.4571 - val_accuracy20: 0.3915 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h20
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0934787
{'0': {'precision': 0.45724082160763385, 'recall': 0.4155353961749437, 'f1-score': 0.4353916664613262, 'support': 170089}, '1': {'precision': 0.34503540018128814, 'recall': 0.39431651151396374, 'f1-score': 0.36803355261868526, 'support': 142870}, '2': {'precision': 0.46364228095869076, 'recall': 0.4508250452079566, 'f1-score': 0.4571438394627365, 'support': 176960}, 'accuracy': 0.4220942645621011, 'macro avg': {'precision': 0.42197283424920423, 'recall': 0.4202256509656213, 'f1-score': 0.420189686180916, 'support': 489919}, 'weighted avg': {'precision': 0.4268317411016339, 'recall': 0.4220942645621011, 'f1-score': 0.42360565858988514, 'support': 489919}}
[[70678 54091 45320]
 [39564 56336 46970]
 [44333 52849 79778]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1099201
{'0': {'precision': 0.465312982146793, 'recall': 0.27794875170745353, 'f1-score': 0.3480151248209852, 'support': 60763}, '1': {'precision': 0.37079177969905736, 'recall': 0.6250801954300943, 'f1-score': 0.46547067074179105, 'support': 60789}, '2': {'precision': 0.4599065652576226, 'recall': 0.3311826558970275, 'f1-score': 0.3850718065003779, 'support': 61531}, 'accuracy': 0.41109769885789504, 'macro avg': {'precision': 0.43200377570115767, 'recall': 0.41140386767819176, 'f1-score': 0.399519200687718, 'support': 183083}, 'weighted avg': {'precision': 0.4321121300021212, 'recall': 0.41109769885789504, 'f1-score': 0.3994679623940781, 'support': 183083}}
[[16889 32492 11382]
 [10242 37998 12549]
 [ 9165 31988 20378]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1426636
{'0': {'precision': 0.49930771893388715, 'recall': 0.2839427193543625, 'f1-score': 0.36201650092543214, 'support': 20321}, '1': {'precision': 0.2918457648546144, 'recall': 0.6659935088351966, 'f1-score': 0.4058455114822547, 'support': 13865}, '2': {'precision': 0.4928434281724559, 'recall': 0.2758940785616572, 'f1-score': 0.35375555973187994, 'support': 20468}, 'accuracy': 0.37784974567277785, 'macro avg': {'precision': 0.42799897065365244, 'recall': 0.40861010225040545, 'f1-score': 0.3738725240465222, 'support': 54654}, 'weighted avg': {'precision': 0.44425646748634273, 'recall': 0.37784974567277785, 'f1-score': 0.3700416095546398, 'support': 54654}}
[[ 5770 10906  3645]
 [ 2465  9234  2166]
 [ 3321 11500  5647]]
training model: results/PCAR/W2/deepLOB_L1/h30
Epoch 1/50
716/716 - 23s - loss: 3.2474 - accuracy30: 0.4046 - val_loss: 3.3620 - val_accuracy30: 0.3516 - 23s/epoch - 32ms/step
Epoch 2/50
716/716 - 19s - loss: 3.1876 - accuracy30: 0.4331 - val_loss: 3.3354 - val_accuracy30: 0.3856 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 20s - loss: 3.1529 - accuracy30: 0.4471 - val_loss: 3.3734 - val_accuracy30: 0.3635 - 20s/epoch - 28ms/step
Epoch 4/50
716/716 - 19s - loss: 3.1378 - accuracy30: 0.4508 - val_loss: 3.3493 - val_accuracy30: 0.3676 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 19s - loss: 3.1209 - accuracy30: 0.4582 - val_loss: 3.3839 - val_accuracy30: 0.3790 - 19s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 3.1105 - accuracy30: 0.4610 - val_loss: 3.3903 - val_accuracy30: 0.3734 - 20s/epoch - 27ms/step
Epoch 7/50
716/716 - 20s - loss: 3.0995 - accuracy30: 0.4649 - val_loss: 3.4173 - val_accuracy30: 0.3690 - 20s/epoch - 27ms/step
Epoch 8/50
716/716 - 17s - loss: 3.0861 - accuracy30: 0.4691 - val_loss: 3.4828 - val_accuracy30: 0.3521 - 17s/epoch - 24ms/step
Epoch 9/50
716/716 - 20s - loss: 3.0810 - accuracy30: 0.4707 - val_loss: 3.5248 - val_accuracy30: 0.3449 - 20s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 3.0730 - accuracy30: 0.4727 - val_loss: 3.4474 - val_accuracy30: 0.3693 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 19s - loss: 3.0675 - accuracy30: 0.4747 - val_loss: 3.4243 - val_accuracy30: 0.3725 - 19s/epoch - 27ms/step
Epoch 12/50
716/716 - 20s - loss: 3.0614 - accuracy30: 0.4762 - val_loss: 3.4226 - val_accuracy30: 0.3736 - 20s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h30
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1093502
{'0': {'precision': 0.39289120472679057, 'recall': 0.5045013829730036, 'f1-score': 0.4417557239929068, 'support': 167393}, '1': {'precision': 0.3159071695437563, 'recall': 0.3152687908663496, 'f1-score': 0.31558765737325856, 'support': 146973}, '2': {'precision': 0.43111350137960064, 'recall': 0.3150672446497639, 'f1-score': 0.364066598431468, 'support': 175553}, 'accuracy': 0.37985258787677145, 'macro avg': {'precision': 0.3799706252167158, 'recall': 0.37827913949637243, 'f1-score': 0.3738033265992111, 'support': 489919}, 'weighted avg': {'precision': 0.38349263933401073, 'recall': 0.37985258787677145, 'f1-score': 0.3760676034771137, 'support': 489919}}
[[84450 43500 39443]
 [67093 46336 33544]
 [63402 56840 55311]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0999342
{'0': {'precision': 0.40811531039552623, 'recall': 0.5003782330881524, 'f1-score': 0.4495618474708621, 'support': 62131}, '1': {'precision': 0.3620717055495518, 'recall': 0.3848414722724278, 'f1-score': 0.37310951893551686, 'support': 59201}, '2': {'precision': 0.42833431858487564, 'recall': 0.3050800796748231, 'f1-score': 0.35635042985633625, 'support': 61751}, 'accuracy': 0.3971477417346231, 'macro avg': {'precision': 0.3995071115099846, 'recall': 0.3967665950118011, 'f1-score': 0.3930072654209051, 'support': 183083}, 'weighted avg': {'precision': 0.4000463827737043, 'recall': 0.3971477417346231, 'f1-score': 0.3934017859100642, 'support': 183083}}
[[31089 17984 13058]
 [24333 22783 12085]
 [20755 22157 18839]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1157286
{'0': {'precision': 0.4197682237076296, 'recall': 0.5302258193445244, 'f1-score': 0.4685754652420583, 'support': 20016}, '1': {'precision': 0.2819898112076716, 'recall': 0.325312867316601, 'f1-score': 0.30210607422627456, 'support': 14463}, '2': {'precision': 0.44970833990225445, 'recall': 0.28277571251548944, 'f1-score': 0.3472201089437327, 'support': 20175}, 'accuracy': 0.3846562008270209, 'macro avg': {'precision': 0.38382212493918527, 'recall': 0.37943813305887164, 'f1-score': 0.3726338828040219, 'support': 54654}, 'weighted avg': {'precision': 0.39436025108421074, 'recall': 0.3846562008270209, 'f1-score': 0.37972577234528954, 'support': 54654}}
[[10613  5310  4093]
 [ 6870  4705  2888]
 [ 7800  6670  5705]]
training model: results/PCAR/W2/deepLOB_L1/h50
Epoch 1/50
716/716 - 23s - loss: 3.2747 - accuracy50: 0.3850 - val_loss: 3.5269 - val_accuracy50: 0.3295 - 23s/epoch - 31ms/step
Epoch 2/50
716/716 - 20s - loss: 3.2409 - accuracy50: 0.4006 - val_loss: 3.3788 - val_accuracy50: 0.3371 - 20s/epoch - 28ms/step
Epoch 3/50
716/716 - 20s - loss: 3.2174 - accuracy50: 0.4126 - val_loss: 3.4953 - val_accuracy50: 0.3281 - 20s/epoch - 28ms/step
Epoch 4/50
716/716 - 20s - loss: 3.1981 - accuracy50: 0.4236 - val_loss: 3.5383 - val_accuracy50: 0.3427 - 20s/epoch - 28ms/step
Epoch 5/50
716/716 - 20s - loss: 3.1891 - accuracy50: 0.4263 - val_loss: 3.4916 - val_accuracy50: 0.3540 - 20s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 3.1825 - accuracy50: 0.4294 - val_loss: 3.4916 - val_accuracy50: 0.3611 - 20s/epoch - 27ms/step
Epoch 7/50
716/716 - 20s - loss: 3.1740 - accuracy50: 0.4329 - val_loss: 3.5229 - val_accuracy50: 0.3575 - 20s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 3.1693 - accuracy50: 0.4349 - val_loss: 3.5546 - val_accuracy50: 0.3537 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 20s - loss: 3.1656 - accuracy50: 0.4363 - val_loss: 3.5697 - val_accuracy50: 0.3487 - 20s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 3.1623 - accuracy50: 0.4379 - val_loss: 3.5586 - val_accuracy50: 0.3508 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 20s - loss: 3.1580 - accuracy50: 0.4392 - val_loss: 3.5990 - val_accuracy50: 0.3476 - 20s/epoch - 28ms/step
Epoch 12/50
716/716 - 19s - loss: 3.1546 - accuracy50: 0.4410 - val_loss: 3.6979 - val_accuracy50: 0.3319 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h50
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109077
{'0': {'precision': 0.37089069819773746, 'recall': 0.4304785535360251, 'f1-score': 0.3984692223583647, 'support': 168466}, '1': {'precision': 0.28118805488297016, 'recall': 0.3070377055190502, 'f1-score': 0.29354489722322397, 'support': 141836}, '2': {'precision': 0.3873501920981708, 'recall': 0.3008623905309631, 'f1-score': 0.33867182236650384, 'support': 179617}, 'accuracy': 0.3472206630075584, 'macro avg': {'precision': 0.3464763150596261, 'recall': 0.3461262165286794, 'f1-score': 0.34356198064936416, 'support': 489919}, 'weighted avg': {'precision': 0.35095544522473743, 'recall': 0.3472206630075584, 'f1-score': 0.34616940101196686, 'support': 489919}}
[[72521 51239 44706]
 [57521 43549 40766]
 [65490 60087 54040]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1105
{'0': {'precision': 0.38184233345017804, 'recall': 0.3335535858178888, 'f1-score': 0.3560682304972775, 'support': 62050}, '1': {'precision': 0.32850215690262363, 'recall': 0.5061518670009236, 'f1-score': 0.39842132253185597, 'support': 60632}, '2': {'precision': 0.35570659071039795, 'recall': 0.20882104600917203, 'f1-score': 0.26315460045900274, 'support': 60401}, 'accuracy': 0.3495627666140494, 'macro avg': {'precision': 0.3553503603543999, 'recall': 0.34950883294266144, 'f1-score': 0.33921471782937873, 'support': 183083}, 'weighted avg': {'precision': 0.35555509442931443, 'recall': 0.3495627666140494, 'f1-score': 0.33944121711153835, 'support': 183083}}
[[20697 30785 10568]
 [17665 30689 12278]
 [15841 31947 12613]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1252533
{'0': {'precision': 0.3879003558718861, 'recall': 0.3501070663811563, 'f1-score': 0.3680360157568936, 'support': 19614}, '1': {'precision': 0.2889652062302702, 'recall': 0.5476300046019328, 'f1-score': 0.3783096416731005, 'support': 15211}, '2': {'precision': 0.3985721319547021, 'recall': 0.1632961823591709, 'f1-score': 0.23167459664436735, 'support': 19829}, 'accuracy': 0.33730376550664176, 'macro avg': {'precision': 0.35847923135228615, 'recall': 0.35367775111408667, 'f1-score': 0.32600675135812046, 'support': 54654}, 'weighted avg': {'precision': 0.3642370940200096, 'recall': 0.33730376550664176, 'f1-score': 0.3214220724815458, 'support': 54654}}
[[ 6867  9852  2895]
 [ 4890  8330  1991]
 [ 5946 10645  3238]]
training model: results/PCAR/W2/deepLOB_L1/h100
Epoch 1/50
716/716 - 22s - loss: 3.2937 - accuracy100: 0.3711 - val_loss: 3.4914 - val_accuracy100: 0.3149 - 22s/epoch - 30ms/step
Epoch 2/50
716/716 - 20s - loss: 3.2671 - accuracy100: 0.3782 - val_loss: 3.4944 - val_accuracy100: 0.3230 - 20s/epoch - 27ms/step
Epoch 3/50
716/716 - 19s - loss: 3.2521 - accuracy100: 0.3868 - val_loss: 3.3887 - val_accuracy100: 0.3321 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 19s - loss: 3.2381 - accuracy100: 0.3951 - val_loss: 3.4925 - val_accuracy100: 0.3009 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 19s - loss: 3.2291 - accuracy100: 0.3984 - val_loss: 3.5100 - val_accuracy100: 0.3054 - 19s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 3.2232 - accuracy100: 0.4037 - val_loss: 3.4969 - val_accuracy100: 0.3177 - 20s/epoch - 28ms/step
Epoch 7/50
716/716 - 19s - loss: 3.2156 - accuracy100: 0.4080 - val_loss: 3.5063 - val_accuracy100: 0.3354 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 20s - loss: 3.2096 - accuracy100: 0.4124 - val_loss: 3.5308 - val_accuracy100: 0.3319 - 20s/epoch - 28ms/step
Epoch 9/50
716/716 - 19s - loss: 3.2064 - accuracy100: 0.4140 - val_loss: 3.5232 - val_accuracy100: 0.3352 - 19s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 3.2036 - accuracy100: 0.4144 - val_loss: 3.5337 - val_accuracy100: 0.3414 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 20s - loss: 3.1999 - accuracy100: 0.4141 - val_loss: 3.5324 - val_accuracy100: 0.3241 - 20s/epoch - 28ms/step
Epoch 12/50
716/716 - 20s - loss: 3.1960 - accuracy100: 0.4189 - val_loss: 3.5200 - val_accuracy100: 0.3390 - 20s/epoch - 28ms/step
Epoch 13/50
716/716 - 19s - loss: 3.1942 - accuracy100: 0.4182 - val_loss: 3.5587 - val_accuracy100: 0.3344 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h100
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1163524
{'0': {'precision': 0.39130364241096777, 'recall': 0.14749085749929672, 'f1-score': 0.21423273538020135, 'support': 163522}, '1': {'precision': 0.323664184184591, 'recall': 0.6219040801717967, 'f1-score': 0.42575049171491003, 'support': 153670}, '2': {'precision': 0.37646881930609327, 'recall': 0.28991414196969784, 'f1-score': 0.32757030437427637, 'support': 172727}, 'accuracy': 0.34651034150543253, 'macro avg': {'precision': 0.3638122153005507, 'recall': 0.3531030265469304, 'f1-score': 0.32251784382312926, 'support': 489919}, 'weighted avg': {'precision': 0.3648573726478376, 'recall': 0.34651034150543253, 'f1-score': 0.3205368221692303, 'support': 489919}}
[[ 24118  95210  44194]
 [ 19357  95568  38745]
 [ 18160 104491  50076]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1087496
{'0': {'precision': 0.36446305460389966, 'recall': 0.28124286040667124, 'f1-score': 0.31749014406248854, 'support': 61278}, '1': {'precision': 0.3463424200823691, 'recall': 0.5163491057940646, 'f1-score': 0.4145945417196518, 'support': 61563}, '2': {'precision': 0.3597182778598205, 'recall': 0.26282327943959366, 'f1-score': 0.30373020516608, 'support': 60242}, 'accuracy': 0.35423824167181006, 'macro avg': {'precision': 0.35684125084869645, 'recall': 0.3534717485467765, 'f1-score': 0.34527163031607344, 'support': 183083}, 'weighted avg': {'precision': 0.35680862757536175, 'recall': 0.35423824167181006, 'f1-score': 0.3456146110745568, 'support': 183083}}
[[17234 29555 14489]
 [16082 31788 13693]
 [13970 30439 15833]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1279345
{'0': {'precision': 0.3628212369387179, 'recall': 0.2640665947279174, 'f1-score': 0.30566542750929365, 'support': 19461}, '1': {'precision': 0.2939665370965016, 'recall': 0.5489837141775028, 'f1-score': 0.38290003742267814, 'support': 15842}, '2': {'precision': 0.3892709766162311, 'recall': 0.21936850808743735, 'f1-score': 0.2806054997355897, 'support': 19351}, 'accuracy': 0.33082665495663627, 'macro avg': {'precision': 0.3486862502171502, 'recall': 0.34413960566428586, 'f1-score': 0.3230569882225205, 'support': 54654}, 'weighted avg': {'precision': 0.3522279181989947, 'recall': 0.33082665495663627, 'f1-score': 0.3191798276977317, 'support': 54654}}
[[ 5139 10214  4108]
 [ 4593  8697  2552]
 [ 4432 10674  4245]]
training model: results/PCAR/W2/deepLOB_L1/h200
Epoch 1/50
716/716 - 22s - loss: 3.3132 - accuracy200: 0.3624 - val_loss: 3.4696 - val_accuracy200: 0.3249 - 22s/epoch - 30ms/step
Epoch 2/50
716/716 - 19s - loss: 3.2831 - accuracy200: 0.3715 - val_loss: 3.5469 - val_accuracy200: 0.3257 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 19s - loss: 3.2676 - accuracy200: 0.3835 - val_loss: 3.4349 - val_accuracy200: 0.3334 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 19s - loss: 3.2583 - accuracy200: 0.3869 - val_loss: 3.4711 - val_accuracy200: 0.3384 - 19s/epoch - 26ms/step
Epoch 5/50
716/716 - 19s - loss: 3.2509 - accuracy200: 0.3937 - val_loss: 3.4424 - val_accuracy200: 0.3445 - 19s/epoch - 26ms/step
Epoch 6/50
716/716 - 19s - loss: 3.2412 - accuracy200: 0.3982 - val_loss: 3.4553 - val_accuracy200: 0.3383 - 19s/epoch - 27ms/step
Epoch 7/50
716/716 - 20s - loss: 3.2342 - accuracy200: 0.4029 - val_loss: 3.5389 - val_accuracy200: 0.3369 - 20s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 3.2319 - accuracy200: 0.4025 - val_loss: 3.5243 - val_accuracy200: 0.3274 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 19s - loss: 3.2266 - accuracy200: 0.4064 - val_loss: 3.4797 - val_accuracy200: 0.3309 - 19s/epoch - 26ms/step
Epoch 10/50
716/716 - 19s - loss: 3.2224 - accuracy200: 0.4064 - val_loss: 3.5735 - val_accuracy200: 0.3306 - 19s/epoch - 26ms/step
Epoch 11/50
716/716 - 19s - loss: 3.2194 - accuracy200: 0.4088 - val_loss: 3.5482 - val_accuracy200: 0.3335 - 19s/epoch - 26ms/step
Epoch 12/50
716/716 - 19s - loss: 3.2154 - accuracy200: 0.4119 - val_loss: 3.6131 - val_accuracy200: 0.3328 - 19s/epoch - 26ms/step
Epoch 13/50
716/716 - 19s - loss: 3.2135 - accuracy200: 0.4124 - val_loss: 3.5990 - val_accuracy200: 0.3331 - 19s/epoch - 26ms/step
testing model: results/PCAR/W2/deepLOB_L1/h200
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259365
{'0': {'precision': 0.338076709282935, 'recall': 0.15014596152540594, 'f1-score': 0.2079413989546517, 'support': 162029}, '1': {'precision': 0.32533048493204, 'recall': 0.5074195089821906, 'f1-score': 0.3964672137557675, 'support': 154862}, '2': {'precision': 0.36842761591656276, 'recall': 0.3756501837852833, 'f1-score': 0.3720038460657952, 'support': 173028}, 'accuracy': 0.3427219601607613, 'macro avg': {'precision': 0.34394493671051257, 'recall': 0.34440521809762664, 'f1-score': 0.3254708195920714, 'support': 489919}, 'weighted avg': {'precision': 0.3447668986358179, 'recall': 0.3427219601607613, 'f1-score': 0.3254769136631593, 'support': 489919}}
[[24328 79910 57791]
 [22651 78580 53631]
 [24981 83049 64998]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1287051
{'0': {'precision': 0.34981927322016393, 'recall': 0.3489296636085627, 'f1-score': 0.3493739021127782, 'support': 62130}, '1': {'precision': 0.3424287499256262, 'recall': 0.4774752352033451, 'f1-score': 0.3988302310432288, 'support': 60267}, '2': {'precision': 0.3458571582695005, 'recall': 0.2113007942523811, 'f1-score': 0.2623309670424091, 'support': 60686}, 'accuracy': 0.345624662038529, 'macro avg': {'precision': 0.3460350604717635, 'recall': 0.3459018976880963, 'f1-score': 0.3368450333994721, 'support': 183083}, 'weighted avg': {'precision': 0.34607316038998387, 'recall': 0.345624662038529, 'f1-score': 0.33680199220290696, 'support': 183083}}
[[21679 28215 12236]
 [19474 28776 12017]
 [20819 27044 12823]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1438559
{'0': {'precision': 0.3467724822815431, 'recall': 0.4298264071541294, 'f1-score': 0.38385831395485404, 'support': 19010}, '1': {'precision': 0.3112493369979266, 'recall': 0.3839747784188924, 'f1-score': 0.34380825565912115, 'support': 16811}, '2': {'precision': 0.36476043276661513, 'recall': 0.20049912387829874, 'f1-score': 0.2587630632174062, 'support': 18833}, 'accuracy': 0.33669996706553956, 'macro avg': {'precision': 0.34092741734869497, 'recall': 0.3381001031504402, 'f1-score': 0.3288098776104605, 'support': 54654}, 'weighted avg': {'precision': 0.34204432837007254, 'recall': 0.33669996706553956, 'f1-score': 0.3284332693625475, 'support': 54654}}
[[8171 7143 3696]
 [7476 6455 2880]
 [7916 7141 3776]]
training model: results/PCAR/W2/deepLOB_L1/h300
Epoch 1/50
716/716 - 22s - loss: 3.3042 - accuracy300: 0.3763 - val_loss: 3.7285 - val_accuracy300: 0.3564 - 22s/epoch - 31ms/step
Epoch 2/50
716/716 - 20s - loss: 3.2810 - accuracy300: 0.3864 - val_loss: 3.3944 - val_accuracy300: 0.3409 - 20s/epoch - 28ms/step
Epoch 3/50
716/716 - 19s - loss: 3.2646 - accuracy300: 0.3905 - val_loss: 3.4035 - val_accuracy300: 0.3359 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 20s - loss: 3.2508 - accuracy300: 0.3975 - val_loss: 3.4240 - val_accuracy300: 0.3426 - 20s/epoch - 27ms/step
Epoch 5/50
716/716 - 19s - loss: 3.2355 - accuracy300: 0.4074 - val_loss: 3.4303 - val_accuracy300: 0.3506 - 19s/epoch - 27ms/step
Epoch 6/50
716/716 - 19s - loss: 3.2270 - accuracy300: 0.4123 - val_loss: 3.4676 - val_accuracy300: 0.3525 - 19s/epoch - 26ms/step
Epoch 7/50
716/716 - 19s - loss: 3.2187 - accuracy300: 0.4162 - val_loss: 3.4711 - val_accuracy300: 0.3450 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 3.2146 - accuracy300: 0.4200 - val_loss: 3.4352 - val_accuracy300: 0.3348 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 19s - loss: 3.2051 - accuracy300: 0.4238 - val_loss: 3.4519 - val_accuracy300: 0.3405 - 19s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 3.2029 - accuracy300: 0.4255 - val_loss: 3.4936 - val_accuracy300: 0.3454 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 19s - loss: 3.1965 - accuracy300: 0.4271 - val_loss: 3.5293 - val_accuracy300: 0.3441 - 19s/epoch - 26ms/step
Epoch 12/50
716/716 - 19s - loss: 3.1935 - accuracy300: 0.4292 - val_loss: 3.5274 - val_accuracy300: 0.3424 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h300
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146721
{'0': {'precision': 0.32139719940060973, 'recall': 0.04178170068986827, 'f1-score': 0.0739498995375159, 'support': 148869}, '1': {'precision': 0.3758352722435374, 'recall': 0.8183043227859071, 'f1-score': 0.5150949339800118, 'support': 178843}, '2': {'precision': 0.3637337998324545, 'recall': 0.1820205046637938, 'f1-score': 0.24262569901265107, 'support': 162207}, 'accuracy': 0.3716798082948406, 'macro avg': {'precision': 0.3536554238255339, 'recall': 0.34736884271318974, 'f1-score': 0.277223510843393, 'support': 489919}, 'weighted avg': {'precision': 0.35528680402442697, 'recall': 0.3716798082948406, 'f1-score': 0.29083492910416375, 'support': 489919}}
[[  6220 117059  25590]
 [  6438 146348  26057]
 [  6695 125987  29525]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1301763
{'0': {'precision': 0.3306937631394534, 'recall': 0.07630983182406209, 'f1-score': 0.12400472999605833, 'support': 61840}, '1': {'precision': 0.34089835578847927, 'recall': 0.7489992587101557, 'f1-score': 0.4685442235756021, 'support': 60705}, '2': {'precision': 0.36513714866237723, 'recall': 0.21373352274604382, 'f1-score': 0.2696355262883698, 'support': 60538}, 'accuracy': 0.3447944374955621, 'macro avg': {'precision': 0.3455764225301033, 'recall': 0.34634753776008714, 'f1-score': 0.2873948266200101, 'support': 183083}, 'weighted avg': {'precision': 0.3454663169513632, 'recall': 0.3447944374955621, 'f1-score': 0.28639810952168415, 'support': 183083}}
[[ 4719 44921 12200]
 [ 4940 45468 10297]
 [ 4611 42988 12939]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1306931
{'0': {'precision': 0.3150860490662761, 'recall': 0.0945188927943761, 'f1-score': 0.14541613857203212, 'support': 18208}, '1': {'precision': 0.335796730558312, 'recall': 0.7176982753809231, 'f1-score': 0.45752610698973506, 'support': 17917}, '2': {'precision': 0.3532758304276014, 'recall': 0.207782395164337, 'f1-score': 0.26166445781085396, 'support': 18529}, 'accuracy': 0.33721228089435357, 'macro avg': {'precision': 0.3347195366840632, 'recall': 0.3399998544465454, 'f1-score': 0.2882022344575404, 'support': 54654}, 'weighted avg': {'precision': 0.33482278817296185, 'recall': 0.33721228089435357, 'f1-score': 0.28714482103472677, 'support': 54654}}
[[ 1721 12535  3952]
 [ 1962 12859  3096]
 [ 1779 12900  3850]]
training model: results/PCAR/W2/deepLOB_L1/h500
Epoch 1/50
716/716 - 23s - loss: 3.2823 - accuracy500: 0.3912 - val_loss: 3.6653 - val_accuracy500: 0.2908 - 23s/epoch - 31ms/step
Epoch 2/50
716/716 - 19s - loss: 3.2610 - accuracy500: 0.3898 - val_loss: 3.7548 - val_accuracy500: 0.3056 - 19s/epoch - 26ms/step
Epoch 3/50
716/716 - 19s - loss: 3.2528 - accuracy500: 0.3958 - val_loss: 3.4200 - val_accuracy500: 0.3456 - 19s/epoch - 27ms/step
Epoch 4/50
716/716 - 19s - loss: 3.2193 - accuracy500: 0.4092 - val_loss: 3.4105 - val_accuracy500: 0.3243 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 20s - loss: 3.2217 - accuracy500: 0.4018 - val_loss: 3.4125 - val_accuracy500: 0.3087 - 20s/epoch - 27ms/step
Epoch 6/50
716/716 - 20s - loss: 3.1916 - accuracy500: 0.4231 - val_loss: 3.4086 - val_accuracy500: 0.3033 - 20s/epoch - 27ms/step
Epoch 7/50
716/716 - 20s - loss: 3.1771 - accuracy500: 0.4305 - val_loss: 3.4261 - val_accuracy500: 0.3102 - 20s/epoch - 27ms/step
Epoch 8/50
716/716 - 19s - loss: 3.1692 - accuracy500: 0.4320 - val_loss: 3.4700 - val_accuracy500: 0.3165 - 19s/epoch - 27ms/step
Epoch 9/50
716/716 - 20s - loss: 3.1538 - accuracy500: 0.4393 - val_loss: 3.4477 - val_accuracy500: 0.3145 - 20s/epoch - 27ms/step
Epoch 10/50
716/716 - 20s - loss: 3.1404 - accuracy500: 0.4457 - val_loss: 3.5175 - val_accuracy500: 0.3206 - 20s/epoch - 28ms/step
Epoch 11/50
716/716 - 19s - loss: 3.1343 - accuracy500: 0.4482 - val_loss: 3.4749 - val_accuracy500: 0.3182 - 19s/epoch - 26ms/step
Epoch 12/50
716/716 - 19s - loss: 3.1286 - accuracy500: 0.4501 - val_loss: 3.5246 - val_accuracy500: 0.3249 - 19s/epoch - 27ms/step
Epoch 13/50
716/716 - 19s - loss: 3.1187 - accuracy500: 0.4546 - val_loss: 3.5848 - val_accuracy500: 0.3178 - 19s/epoch - 27ms/step
Epoch 14/50
716/716 - 19s - loss: 3.1131 - accuracy500: 0.4569 - val_loss: 3.6468 - val_accuracy500: 0.3136 - 19s/epoch - 27ms/step
Epoch 15/50
716/716 - 19s - loss: 3.1110 - accuracy500: 0.4582 - val_loss: 3.6427 - val_accuracy500: 0.3344 - 19s/epoch - 27ms/step
Epoch 16/50
716/716 - 19s - loss: 3.1032 - accuracy500: 0.4624 - val_loss: 3.6408 - val_accuracy500: 0.3286 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h500
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1409944
{'0': {'precision': 0.36736608399262016, 'recall': 0.0717991969344163, 'f1-score': 0.12012147115060173, 'support': 163623}, '1': {'precision': 0.2884925402252821, 'recall': 0.5638860828087264, 'f1-score': 0.3817010986224199, 'support': 149477}, '2': {'precision': 0.3465401482750508, 'recall': 0.32489155577172135, 'f1-score': 0.3353668503642817, 'support': 176819}, 'accuracy': 0.3132823997436311, 'macro avg': {'precision': 0.33413292416431767, 'recall': 0.3201922785049547, 'f1-score': 0.27906314004576777, 'support': 489919}, 'weighted avg': {'precision': 0.33578494133565995, 'recall': 0.3132823997436311, 'f1-score': 0.2776160992070532, 'support': 489919}}
[[ 11748  99452  52423]
 [  9286  84288  55903]
 [ 10945 108427  57447]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173177
{'0': {'precision': 0.3528394921786443, 'recall': 0.20541797964133107, 'f1-score': 0.25966361143262323, 'support': 60613}, '1': {'precision': 0.3348052157672043, 'recall': 0.4570565182492091, 'f1-score': 0.3864940042855051, 'support': 63537}, '2': {'precision': 0.31055717514494413, 'recall': 0.32175521354758796, 'f1-score': 0.3160570376111541, 'support': 58933}, 'accuracy': 0.3301945019472043, 'macro avg': {'precision': 0.3327339610302642, 'recall': 0.32807657047937605, 'f1-score': 0.32073821777642747, 'support': 183083}, 'weighted avg': {'precision': 0.3329705386979786, 'recall': 0.3301945019472043, 'f1-score': 0.3218313520512111, 'support': 183083}}
[[12451 28994 19168]
 [11569 29040 22928]
 [11268 28703 18962]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1291974
{'0': {'precision': 0.340738423028786, 'recall': 0.22603912614809818, 'f1-score': 0.27178287318671035, 'support': 19271}, '1': {'precision': 0.2796288241264318, 'recall': 0.6248299099332599, 'f1-score': 0.3863536199366962, 'support': 15433}, '2': {'precision': 0.35206499661475965, 'recall': 0.13032581453634084, 'f1-score': 0.19023230290835924, 'support': 19950}, 'accuracy': 0.30371061587440995, 'macro avg': {'precision': 0.3241440812566591, 'recall': 0.32706495020589965, 'f1-score': 0.2827895986772553, 'support': 54654}, 'weighted avg': {'precision': 0.32761698092354474, 'recall': 0.30371061587440995, 'f1-score': 0.2743670656985014, 'support': 54654}}
[[ 4356 12207  2708]
 [ 3713  9643  2077]
 [ 4715 12635  2600]]
training model: results/PCAR/W2/deepLOB_L1/h1000
Epoch 1/50
716/716 - 22s - loss: 3.2913 - accuracy1000: 0.3879 - val_loss: 3.4218 - val_accuracy1000: 0.3269 - 22s/epoch - 31ms/step
Epoch 2/50
716/716 - 19s - loss: 3.2426 - accuracy1000: 0.4002 - val_loss: 3.4544 - val_accuracy1000: 0.3383 - 19s/epoch - 27ms/step
Epoch 3/50
716/716 - 19s - loss: 3.1924 - accuracy1000: 0.4266 - val_loss: 3.4318 - val_accuracy1000: 0.3409 - 19s/epoch - 26ms/step
Epoch 4/50
716/716 - 19s - loss: 3.1651 - accuracy1000: 0.4389 - val_loss: 3.4348 - val_accuracy1000: 0.3414 - 19s/epoch - 27ms/step
Epoch 5/50
716/716 - 19s - loss: 3.1483 - accuracy1000: 0.4446 - val_loss: 3.4730 - val_accuracy1000: 0.3411 - 19s/epoch - 26ms/step
Epoch 6/50
716/716 - 19s - loss: 3.1304 - accuracy1000: 0.4508 - val_loss: 3.5120 - val_accuracy1000: 0.3436 - 19s/epoch - 26ms/step
Epoch 7/50
716/716 - 19s - loss: 3.1230 - accuracy1000: 0.4518 - val_loss: 3.5643 - val_accuracy1000: 0.3413 - 19s/epoch - 27ms/step
Epoch 8/50
716/716 - 20s - loss: 3.1170 - accuracy1000: 0.4557 - val_loss: 3.5244 - val_accuracy1000: 0.3409 - 20s/epoch - 27ms/step
Epoch 9/50
716/716 - 19s - loss: 3.1048 - accuracy1000: 0.4595 - val_loss: 3.5072 - val_accuracy1000: 0.3433 - 19s/epoch - 27ms/step
Epoch 10/50
716/716 - 19s - loss: 3.1008 - accuracy1000: 0.4600 - val_loss: 3.5143 - val_accuracy1000: 0.3419 - 19s/epoch - 27ms/step
Epoch 11/50
716/716 - 19s - loss: 3.0910 - accuracy1000: 0.4620 - val_loss: 3.5438 - val_accuracy1000: 0.3394 - 19s/epoch - 27ms/step
testing model: results/PCAR/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1238142
{'0': {'precision': 0.3347973200080669, 'recall': 0.1844362972015455, 'f1-score': 0.23784584036422682, 'support': 162018}, '1': {'precision': 0.3116979153361613, 'recall': 0.30065232333450054, 'f1-score': 0.30607549897514946, 'support': 154218}, '2': {'precision': 0.3549930134332624, 'recall': 0.5148863158743228, 'f1-score': 0.42024459873823705, 'support': 173683}, 'accuracy': 0.3381681461629371, 'macro avg': {'precision': 0.3338294162591635, 'recall': 0.3333249788034563, 'f1-score': 0.3213886460258711, 'support': 489919}, 'weighted avg': {'precision': 0.33468567835194885, 'recall': 0.3381681461629371, 'f1-score': 0.3239862126346072, 'support': 489919}}
[[29882 50319 81817]
 [27184 46366 80668]
 [32188 52068 89427]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1248868
{'0': {'precision': 0.3526689803338291, 'recall': 0.27334443448187523, 'f1-score': 0.30798094963198147, 'support': 62456}, '1': {'precision': 0.3519395465994962, 'recall': 0.39164210661199383, 'f1-score': 0.3707308937357381, 'support': 62432}, '2': {'precision': 0.3309049079754601, 'recall': 0.37073631755305436, 'f1-score': 0.3496900198549374, 'support': 58195}, 'accuracy': 0.3446415013955419, 'macro avg': {'precision': 0.3451711449695951, 'recall': 0.3452409528823079, 'f1-score': 0.342800621074219, 'support': 183083}, 'weighted avg': {'precision': 0.34550228436644187, 'recall': 0.3446415013955419, 'f1-score': 0.342636618655925, 'support': 183083}}
[[17072 23664 21720]
 [16076 24451 21905]
 [15260 21360 21575]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1348664
{'0': {'precision': 0.33697224779692225, 'recall': 0.2750550217402974, 'f1-score': 0.30288163144672675, 'support': 18629}, '1': {'precision': 0.31028241929374134, 'recall': 0.44481988776926323, 'f1-score': 0.36556580382822573, 'support': 16573}, '2': {'precision': 0.36037988399515586, 'recall': 0.29066419905408186, 'f1-score': 0.3217893628525085, 'support': 19452}, 'accuracy': 0.33208914260621364, 'macro avg': {'precision': 0.33587818369527317, 'recall': 0.3368463695212142, 'f1-score': 0.33007893270915367, 'support': 54654}, 'weighted avg': {'precision': 0.3372100128561096, 'recall': 0.33208914260621364, 'f1-score': 0.3286191434345749, 'support': 54654}}
[[5124 8066 5439]
 [4605 7372 4596]
 [5477 8321 5654]]
training model: results/PCAR/W2/deepOF_L1/h10
Epoch 1/50
716/716 - 21s - loss: 3.2823 - accuracy10: 0.3797 - val_loss: 3.3425 - val_accuracy10: 0.3802 - 21s/epoch - 30ms/step
Epoch 2/50
716/716 - 18s - loss: 3.2403 - accuracy10: 0.3940 - val_loss: 3.3371 - val_accuracy10: 0.3865 - 18s/epoch - 25ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2261 - accuracy10: 0.3997 - val_loss: 3.3296 - val_accuracy10: 0.3887 - 18s/epoch - 26ms/step
Epoch 4/50
716/716 - 19s - loss: 3.2159 - accuracy10: 0.4058 - val_loss: 3.3256 - val_accuracy10: 0.3957 - 19s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2081 - accuracy10: 0.4088 - val_loss: 3.3250 - val_accuracy10: 0.3985 - 18s/epoch - 26ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2042 - accuracy10: 0.4105 - val_loss: 3.3216 - val_accuracy10: 0.3974 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.1991 - accuracy10: 0.4148 - val_loss: 3.3241 - val_accuracy10: 0.3961 - 18s/epoch - 25ms/step
Epoch 8/50
716/716 - 18s - loss: 3.1943 - accuracy10: 0.4166 - val_loss: 3.3232 - val_accuracy10: 0.3941 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.1911 - accuracy10: 0.4175 - val_loss: 3.3201 - val_accuracy10: 0.3968 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.1870 - accuracy10: 0.4205 - val_loss: 3.3212 - val_accuracy10: 0.3983 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.1836 - accuracy10: 0.4217 - val_loss: 3.3224 - val_accuracy10: 0.3970 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.1788 - accuracy10: 0.4238 - val_loss: 3.3244 - val_accuracy10: 0.3989 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.1755 - accuracy10: 0.4259 - val_loss: 3.3261 - val_accuracy10: 0.3992 - 18s/epoch - 25ms/step
Epoch 14/50
716/716 - 18s - loss: 3.1718 - accuracy10: 0.4275 - val_loss: 3.3193 - val_accuracy10: 0.4023 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.1699 - accuracy10: 0.4275 - val_loss: 3.3276 - val_accuracy10: 0.3974 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.1648 - accuracy10: 0.4303 - val_loss: 3.3227 - val_accuracy10: 0.4019 - 18s/epoch - 26ms/step
Epoch 17/50
716/716 - 18s - loss: 3.1624 - accuracy10: 0.4304 - val_loss: 3.3230 - val_accuracy10: 0.4028 - 18s/epoch - 26ms/step
Epoch 18/50
716/716 - 18s - loss: 3.1581 - accuracy10: 0.4330 - val_loss: 3.3266 - val_accuracy10: 0.4019 - 18s/epoch - 25ms/step
Epoch 19/50
716/716 - 18s - loss: 3.1547 - accuracy10: 0.4332 - val_loss: 3.3305 - val_accuracy10: 0.4025 - 18s/epoch - 25ms/step
Epoch 20/50
716/716 - 18s - loss: 3.1527 - accuracy10: 0.4340 - val_loss: 3.3281 - val_accuracy10: 0.4048 - 18s/epoch - 25ms/step
Epoch 21/50
716/716 - 18s - loss: 3.1498 - accuracy10: 0.4354 - val_loss: 3.3302 - val_accuracy10: 0.4030 - 18s/epoch - 26ms/step
Epoch 22/50
716/716 - 18s - loss: 3.1455 - accuracy10: 0.4382 - val_loss: 3.3259 - val_accuracy10: 0.4047 - 18s/epoch - 26ms/step
Epoch 23/50
716/716 - 18s - loss: 3.1426 - accuracy10: 0.4394 - val_loss: 3.3348 - val_accuracy10: 0.4036 - 18s/epoch - 25ms/step
Epoch 24/50
716/716 - 18s - loss: 3.1402 - accuracy10: 0.4403 - val_loss: 3.3383 - val_accuracy10: 0.4028 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h10
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0825548
{'0': {'precision': 0.3924683748410376, 'recall': 0.4237520858790913, 'f1-score': 0.40751071673389966, 'support': 152214}, '1': {'precision': 0.43593721647613864, 'recall': 0.2645738922630486, 'f1-score': 0.32929558063112296, 'support': 181609}, '2': {'precision': 0.38258717325990144, 'recall': 0.5278267164666764, 'f1-score': 0.44362181575390774, 'support': 156091}, 'accuracy': 0.39790453018284844, 'macro avg': {'precision': 0.4036642548590259, 'recall': 0.4053842315362721, 'f1-score': 0.3934760377063102, 'support': 489914}, 'weighted avg': {'precision': 0.40543384679021227, 'recall': 0.39790453018284844, 'f1-score': 0.3900220246463963, 'support': 489914}}
[[64501 31938 55775]
 [56377 48049 77183]
 [43469 30233 82389]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0704733
{'0': {'precision': 0.3777547605768465, 'recall': 0.449445445065883, 'f1-score': 0.4104935064935065, 'support': 52745}, '1': {'precision': 0.5106516745254503, 'recall': 0.2762581269704224, 'f1-score': 0.35854598550060274, 'support': 76443}, '2': {'precision': 0.37292492370810276, 'recall': 0.5464514333426106, 'f1-score': 0.4433121594364331, 'support': 53895}, 'accuracy': 0.4056903153214662, 'macro avg': {'precision': 0.4204437862701332, 'recall': 0.4240516684596387, 'f1-score': 0.4041172171435141, 'support': 183083}, 'weighted avg': {'precision': 0.4318216850588147, 'recall': 0.4056903153214662, 'f1-score': 0.39846473786451575, 'support': 183083}}
[[23706 10577 18462]
 [24265 21118 31060]
 [14784  9660 29451]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0818151
{'0': {'precision': 0.41317737177164743, 'recall': 0.4401499696752495, 'f1-score': 0.42623738587217685, 'support': 18137}, '1': {'precision': 0.40145653163404643, 'recall': 0.23906326231907626, 'f1-score': 0.29967382440880674, 'support': 18447}, '2': {'precision': 0.392393625759816, 'recall': 0.5287216380741561, 'f1-score': 0.450469140459239, 'support': 18070}, 'accuracy': 0.4015625571778827, 'macro avg': {'precision': 0.40234250972183666, 'recall': 0.402644956689494, 'f1-score': 0.3921267835800742, 'support': 54654}, 'weighted avg': {'precision': 0.4023496806886138, 'recall': 0.4015625571778827, 'f1-score': 0.3915308646124965, 'support': 54654}}
[[7983 3437 6717]
 [5960 4410 8077]
 [5378 3138 9554]]
training model: results/PCAR/W2/deepOF_L1/h20
Epoch 1/50
716/716 - 21s - loss: 3.2981 - accuracy20: 0.3807 - val_loss: 3.2733 - val_accuracy20: 0.3959 - 21s/epoch - 29ms/step
Epoch 2/50
716/716 - 18s - loss: 3.2602 - accuracy20: 0.3988 - val_loss: 3.2669 - val_accuracy20: 0.4043 - 18s/epoch - 25ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2465 - accuracy20: 0.4044 - val_loss: 3.2613 - val_accuracy20: 0.4068 - 18s/epoch - 25ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2379 - accuracy20: 0.4090 - val_loss: 3.2605 - val_accuracy20: 0.4067 - 18s/epoch - 25ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2326 - accuracy20: 0.4121 - val_loss: 3.2574 - val_accuracy20: 0.4068 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2282 - accuracy20: 0.4122 - val_loss: 3.2576 - val_accuracy20: 0.4059 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.2246 - accuracy20: 0.4148 - val_loss: 3.2612 - val_accuracy20: 0.4041 - 18s/epoch - 25ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2198 - accuracy20: 0.4168 - val_loss: 3.2589 - val_accuracy20: 0.4075 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2159 - accuracy20: 0.4179 - val_loss: 3.2602 - val_accuracy20: 0.4059 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2124 - accuracy20: 0.4192 - val_loss: 3.2573 - val_accuracy20: 0.4044 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 19s - loss: 3.2084 - accuracy20: 0.4209 - val_loss: 3.2616 - val_accuracy20: 0.4043 - 19s/epoch - 26ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2044 - accuracy20: 0.4228 - val_loss: 3.2618 - val_accuracy20: 0.4048 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 17s - loss: 3.2014 - accuracy20: 0.4236 - val_loss: 3.2590 - val_accuracy20: 0.4053 - 17s/epoch - 24ms/step
Epoch 14/50
716/716 - 18s - loss: 3.1977 - accuracy20: 0.4267 - val_loss: 3.2595 - val_accuracy20: 0.4039 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.1955 - accuracy20: 0.4264 - val_loss: 3.2628 - val_accuracy20: 0.4030 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.1916 - accuracy20: 0.4282 - val_loss: 3.2617 - val_accuracy20: 0.4041 - 18s/epoch - 25ms/step
Epoch 17/50
716/716 - 18s - loss: 3.1879 - accuracy20: 0.4296 - val_loss: 3.2655 - val_accuracy20: 0.4010 - 18s/epoch - 25ms/step
Epoch 18/50
716/716 - 18s - loss: 3.1859 - accuracy20: 0.4306 - val_loss: 3.2687 - val_accuracy20: 0.3975 - 18s/epoch - 25ms/step
Epoch 19/50
716/716 - 18s - loss: 3.1840 - accuracy20: 0.4320 - val_loss: 3.2667 - val_accuracy20: 0.3992 - 18s/epoch - 26ms/step
Epoch 20/50
716/716 - 18s - loss: 3.1801 - accuracy20: 0.4327 - val_loss: 3.2680 - val_accuracy20: 0.4009 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h20
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0847751
{'0': {'precision': 0.40485657947773795, 'recall': 0.4369906988229484, 'f1-score': 0.42031034404759215, 'support': 170086}, '1': {'precision': 0.3435122322369191, 'recall': 0.16432536099503742, 'f1-score': 0.22230639212548473, 'support': 142869}, '2': {'precision': 0.4125025211778943, 'recall': 0.5547556213586198, 'f1-score': 0.473168603880533, 'support': 176959}, 'accuracy': 0.4000130635172704, 'macro avg': {'precision': 0.38695711096418384, 'recall': 0.38535722705886855, 'f1-score': 0.3719284466845367, 'support': 489914}, 'weighted avg': {'precision': 0.3897290523022937, 'recall': 0.4000130635172704, 'f1-score': 0.38166094475428314, 'support': 489914}}
[[74326 24335 71425]
 [51002 23477 68390]
 [58258 20532 98169]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0804247
{'0': {'precision': 0.3965608503454886, 'recall': 0.4578412750846478, 'f1-score': 0.4250034497033255, 'support': 60545}, '1': {'precision': 0.41523874800091387, 'recall': 0.1788789921755819, 'f1-score': 0.2500429922613929, 'support': 60963}, '2': {'precision': 0.3962034054302807, 'recall': 0.5592854242793341, 'f1-score': 0.4638270648843395, 'support': 61575}, 'accuracy': 0.39907036699202003, 'macro avg': {'precision': 0.402667667925561, 'recall': 0.3986685638465213, 'f1-score': 0.3796245022830193, 'support': 183083}, 'weighted avg': {'precision': 0.4026600021188032, 'recall': 0.39907036699202003, 'f1-score': 0.37980236460934297, 'support': 183083}}
[[27720  8228 24597]
 [22173 10905 27885]
 [20008  7129 34438]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0859319
{'0': {'precision': 0.4248499790668465, 'recall': 0.44970210251612586, 'f1-score': 0.4369229297230062, 'support': 20309}, '1': {'precision': 0.28623853211009176, 'recall': 0.13529921942758022, 'f1-score': 0.18374558303886926, 'support': 13836}, '2': {'precision': 0.41710185219972196, 'recall': 0.5413233214686235, 'f1-score': 0.47116241565165723, 'support': 20509}, 'accuracy': 0.4044900647711055, 'macro avg': {'precision': 0.3760634544588868, 'recall': 0.3754415478041098, 'f1-score': 0.3639436428045109, 'support': 54654}, 'weighted avg': {'precision': 0.3868521323582521, 'recall': 0.4044900647711055, 'f1-score': 0.385677931153624, 'support': 54654}}
[[ 9133  2441  8735]
 [ 5184  1872  6780]
 [ 7180  2227 11102]]
training model: results/PCAR/W2/deepOF_L1/h30
Epoch 1/50
716/716 - 21s - loss: 3.3049 - accuracy30: 0.3732 - val_loss: 3.2688 - val_accuracy30: 0.3953 - 21s/epoch - 29ms/step
Epoch 2/50
716/716 - 19s - loss: 3.2709 - accuracy30: 0.3910 - val_loss: 3.2670 - val_accuracy30: 0.3988 - 19s/epoch - 26ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2585 - accuracy30: 0.3975 - val_loss: 3.2589 - val_accuracy30: 0.4027 - 18s/epoch - 25ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2517 - accuracy30: 0.3997 - val_loss: 3.2592 - val_accuracy30: 0.4038 - 18s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2459 - accuracy30: 0.4041 - val_loss: 3.2604 - val_accuracy30: 0.4046 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2426 - accuracy30: 0.4057 - val_loss: 3.2558 - val_accuracy30: 0.4049 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.2381 - accuracy30: 0.4076 - val_loss: 3.2548 - val_accuracy30: 0.4067 - 18s/epoch - 26ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2341 - accuracy30: 0.4093 - val_loss: 3.2548 - val_accuracy30: 0.4051 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 19s - loss: 3.2325 - accuracy30: 0.4113 - val_loss: 3.2551 - val_accuracy30: 0.4069 - 19s/epoch - 26ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2278 - accuracy30: 0.4128 - val_loss: 3.2565 - val_accuracy30: 0.4050 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2252 - accuracy30: 0.4137 - val_loss: 3.2579 - val_accuracy30: 0.4032 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2219 - accuracy30: 0.4160 - val_loss: 3.2585 - val_accuracy30: 0.4030 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 19s - loss: 3.2185 - accuracy30: 0.4177 - val_loss: 3.2589 - val_accuracy30: 0.4064 - 19s/epoch - 26ms/step
Epoch 14/50
716/716 - 18s - loss: 3.2160 - accuracy30: 0.4180 - val_loss: 3.2570 - val_accuracy30: 0.4054 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2141 - accuracy30: 0.4184 - val_loss: 3.2614 - val_accuracy30: 0.3982 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2116 - accuracy30: 0.4211 - val_loss: 3.2591 - val_accuracy30: 0.4045 - 18s/epoch - 26ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2078 - accuracy30: 0.4216 - val_loss: 3.2608 - val_accuracy30: 0.4024 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h30
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0860745
{'0': {'precision': 0.4006733294927831, 'recall': 0.45290311788707743, 'f1-score': 0.42519027027633355, 'support': 167389}, '1': {'precision': 0.35837227043005626, 'recall': 0.10228409299667286, 'f1-score': 0.15914588637578672, 'support': 146973}, '2': {'precision': 0.4065861020184961, 'recall': 0.5992925173168064, 'f1-score': 0.48447994400300237, 'support': 175552}, 'accuracy': 0.4001743163085766, 'macro avg': {'precision': 0.38854390064711186, 'recall': 0.3848265760668523, 'f1-score': 0.35627203355170756, 'support': 489914}, 'weighted avg': {'precision': 0.39010185263931046, 'recall': 0.4001743163085766, 'f1-score': 0.36662301064923386, 'support': 489914}}
[[ 75811  14695  76883]
 [ 55273  15033  76667]
 [ 58125  12220 105207]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0859025
{'0': {'precision': 0.3988367144275784, 'recall': 0.4531592520954223, 'f1-score': 0.42426620387836717, 'support': 62040}, '1': {'precision': 0.4156943491191947, 'recall': 0.12286366325754373, 'f1-score': 0.18966844556948811, 'support': 59155}, '2': {'precision': 0.38693499037945933, 'recall': 0.5946387021716649, 'f1-score': 0.468811505952343, 'support': 61888}, 'accuracy': 0.3942638038485277, 'macro avg': {'precision': 0.40048868464207743, 'recall': 0.390220539174877, 'f1-score': 0.36091538513339944, 'support': 183083}, 'weighted avg': {'precision': 0.4002603282109038, 'recall': 0.3942638038485277, 'f1-score': 0.3635242959021623, 'support': 183083}}
[[28114  5436 28490]
 [22069  7268 29818]
 [20307  4780 36801]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0865232
{'0': {'precision': 0.41681951577402787, 'recall': 0.45418207254921555, 'f1-score': 0.4346994404858687, 'support': 20014}, '1': {'precision': 0.3283662963966405, 'recall': 0.08403827485785606, 'f1-score': 0.13382653342902887, 'support': 14422}, '2': {'precision': 0.40788886983364775, 'recall': 0.5881887427045207, 'f1-score': 0.4817207785631823, 'support': 20218}, 'accuracy': 0.4060818970249204, 'macro avg': {'precision': 0.38435822733477204, 'recall': 0.37546969670386404, 'f1-score': 0.3500822508260266, 'support': 54654}, 'weighted avg': {'precision': 0.39017494942054437, 'recall': 0.4060818970249204, 'f1-score': 0.3727001055364301, 'support': 54654}}
[[ 9090  1259  9665]
 [ 5612  1212  7598]
 [ 7106  1220 11892]]
training model: results/PCAR/W2/deepOF_L1/h50
Epoch 1/50
716/716 - 21s - loss: 3.3144 - accuracy50: 0.3613 - val_loss: 3.2884 - val_accuracy50: 0.3816 - 21s/epoch - 29ms/step
Epoch 2/50
716/716 - 18s - loss: 3.2833 - accuracy50: 0.3779 - val_loss: 3.2788 - val_accuracy50: 0.3868 - 18s/epoch - 26ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2730 - accuracy50: 0.3825 - val_loss: 3.2775 - val_accuracy50: 0.3901 - 18s/epoch - 25ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2669 - accuracy50: 0.3866 - val_loss: 3.2750 - val_accuracy50: 0.3925 - 18s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2622 - accuracy50: 0.3890 - val_loss: 3.2734 - val_accuracy50: 0.3917 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2592 - accuracy50: 0.3909 - val_loss: 3.2740 - val_accuracy50: 0.3918 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 19s - loss: 3.2560 - accuracy50: 0.3935 - val_loss: 3.2739 - val_accuracy50: 0.3927 - 19s/epoch - 26ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2533 - accuracy50: 0.3944 - val_loss: 3.2766 - val_accuracy50: 0.3909 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2505 - accuracy50: 0.3945 - val_loss: 3.2765 - val_accuracy50: 0.3906 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2491 - accuracy50: 0.3968 - val_loss: 3.2779 - val_accuracy50: 0.3907 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2466 - accuracy50: 0.3980 - val_loss: 3.2777 - val_accuracy50: 0.3904 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2444 - accuracy50: 0.3999 - val_loss: 3.2787 - val_accuracy50: 0.3890 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.2422 - accuracy50: 0.4014 - val_loss: 3.2770 - val_accuracy50: 0.3901 - 18s/epoch - 25ms/step
Epoch 14/50
716/716 - 20s - loss: 3.2392 - accuracy50: 0.4020 - val_loss: 3.2792 - val_accuracy50: 0.3906 - 20s/epoch - 28ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2379 - accuracy50: 0.4035 - val_loss: 3.2799 - val_accuracy50: 0.3903 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h50
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869855
{'0': {'precision': 0.3992125233169408, 'recall': 0.4471809666274887, 'f1-score': 0.42183746493227237, 'support': 168462}, '1': {'precision': 0.3433371722783009, 'recall': 0.07146281621027102, 'f1-score': 0.11830203433746893, 'support': 141836}, '2': {'precision': 0.4083986042813816, 'recall': 0.6177456351327276, 'f1-score': 0.49171733465690537, 'support': 179616}, 'accuracy': 0.4009397567736378, 'macro avg': {'precision': 0.3836494332922078, 'recall': 0.37879647265682914, 'f1-score': 0.3439522779755489, 'support': 489914}, 'weighted avg': {'precision': 0.3864038075598742, 'recall': 0.4009397567736378, 'f1-score': 0.3595801939553563, 'support': 489914}}
[[ 75333   9827  83302]
 [ 54271  10136  77429]
 [ 59100   9559 110957]]
Evaluating performance on  train set...
716/716 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0918032
{'0': {'precision': 0.3890642351978491, 'recall': 0.429943968092493, 'f1-score': 0.408483872204963, 'support': 61929}, '1': {'precision': 0.40824028935367196, 'recall': 0.08549175873935881, 'f1-score': 0.14137700989802449, 'support': 60731}, '2': {'precision': 0.37012037791011393, 'recall': 0.6243648941628188, 'f1-score': 0.4647432738740515, 'support': 60423}, 'accuracy': 0.379849576421623, 'macro avg': {'precision': 0.3891416341538783, 'recall': 0.37993354033155685, 'f1-score': 0.3382013853256797, 'support': 183083}, 'weighted avg': {'precision': 0.3891731270995574, 'recall': 0.379849576421623, 'f1-score': 0.3384483963404024, 'support': 183083}}
[[26626  3893 31410]
 [22746  5192 32793]
 [19064  3633 37726]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0915725
{'0': {'precision': 0.3991505381533858, 'recall': 0.42217571085813466, 'f1-score': 0.41034037908107573, 'support': 19589}, '1': {'precision': 0.3081525804038893, 'recall': 0.05401861806739216, 'f1-score': 0.09192324854975457, 'support': 15254}, '2': {'precision': 0.39461309619014107, 'recall': 0.6226843672707082, 'f1-score': 0.4830827067669173, 'support': 19811}, 'accuracy': 0.39210304826728143, 'macro avg': {'precision': 0.3673054049158054, 'recall': 0.3662928987320783, 'f1-score': 0.3284487781325825, 'support': 54654}, 'weighted avg': {'precision': 0.37210816046383594, 'recall': 0.39210304826728143, 'f1-score': 0.34783742128584455, 'support': 54654}}
[[ 8270   920 10399]
 [ 5904   824  8526]
 [ 6545   930 12336]]
training model: results/PCAR/W2/deepOF_L1/h100
Epoch 1/50
716/716 - 21s - loss: 3.3224 - accuracy100: 0.3529 - val_loss: 3.3145 - val_accuracy100: 0.3550 - 21s/epoch - 29ms/step
Epoch 2/50
716/716 - 18s - loss: 3.2968 - accuracy100: 0.3619 - val_loss: 3.3034 - val_accuracy100: 0.3579 - 18s/epoch - 25ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2875 - accuracy100: 0.3674 - val_loss: 3.2968 - val_accuracy100: 0.3661 - 18s/epoch - 26ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2823 - accuracy100: 0.3713 - val_loss: 3.2930 - val_accuracy100: 0.3677 - 18s/epoch - 26ms/step
Epoch 5/50
716/716 - 19s - loss: 3.2790 - accuracy100: 0.3727 - val_loss: 3.2904 - val_accuracy100: 0.3701 - 19s/epoch - 26ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2759 - accuracy100: 0.3754 - val_loss: 3.2901 - val_accuracy100: 0.3678 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.2741 - accuracy100: 0.3763 - val_loss: 3.2888 - val_accuracy100: 0.3727 - 18s/epoch - 26ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2724 - accuracy100: 0.3778 - val_loss: 3.2888 - val_accuracy100: 0.3703 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2712 - accuracy100: 0.3775 - val_loss: 3.2888 - val_accuracy100: 0.3716 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2691 - accuracy100: 0.3808 - val_loss: 3.2889 - val_accuracy100: 0.3698 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2671 - accuracy100: 0.3813 - val_loss: 3.2885 - val_accuracy100: 0.3712 - 18s/epoch - 26ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2659 - accuracy100: 0.3829 - val_loss: 3.2876 - val_accuracy100: 0.3742 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.2648 - accuracy100: 0.3823 - val_loss: 3.2894 - val_accuracy100: 0.3714 - 18s/epoch - 25ms/step
Epoch 14/50
716/716 - 19s - loss: 3.2636 - accuracy100: 0.3848 - val_loss: 3.2891 - val_accuracy100: 0.3705 - 19s/epoch - 26ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2615 - accuracy100: 0.3854 - val_loss: 3.2898 - val_accuracy100: 0.3695 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2598 - accuracy100: 0.3864 - val_loss: 3.2888 - val_accuracy100: 0.3722 - 18s/epoch - 25ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2596 - accuracy100: 0.3876 - val_loss: 3.2877 - val_accuracy100: 0.3746 - 18s/epoch - 25ms/step
Epoch 18/50
716/716 - 18s - loss: 3.2575 - accuracy100: 0.3871 - val_loss: 3.2884 - val_accuracy100: 0.3714 - 18s/epoch - 25ms/step
Epoch 19/50
716/716 - 18s - loss: 3.2566 - accuracy100: 0.3879 - val_loss: 3.2901 - val_accuracy100: 0.3712 - 18s/epoch - 25ms/step
Epoch 20/50
716/716 - 18s - loss: 3.2554 - accuracy100: 0.3883 - val_loss: 3.2901 - val_accuracy100: 0.3701 - 18s/epoch - 25ms/step
Epoch 21/50
716/716 - 18s - loss: 3.2542 - accuracy100: 0.3893 - val_loss: 3.2909 - val_accuracy100: 0.3725 - 18s/epoch - 25ms/step
Epoch 22/50
716/716 - 18s - loss: 3.2525 - accuracy100: 0.3905 - val_loss: 3.2914 - val_accuracy100: 0.3702 - 18s/epoch - 26ms/step
testing model: results/PCAR/W2/deepOF_L1/h100
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944289
{'0': {'precision': 0.36750452334990213, 'recall': 0.33413854047541874, 'f1-score': 0.35002818778187783, 'support': 163519}, '1': {'precision': 0.3526654871081457, 'recall': 0.1699171596092901, 'f1-score': 0.22933757268080174, 'support': 153669}, '2': {'precision': 0.3801730525969117, 'recall': 0.5881164387527066, 'f1-score': 0.4618164790602099, 'support': 172726}, 'accuracy': 0.3721714423347771, 'macro avg': {'precision': 0.36678102101831983, 'recall': 0.3640573796124718, 'f1-score': 0.34706074650762986, 'support': 489914}, 'weighted avg': {'precision': 0.367316499579372, 'recall': 0.3721714423347771, 'f1-score': 0.3515842532696449, 'support': 489914}}
[[ 54638  25056  83825]
 [ 45764  26111  81794]
 [ 48271  22872 101583]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925026
{'0': {'precision': 0.37555567086987357, 'recall': 0.35478283604039346, 'f1-score': 0.3648738351917049, 'support': 61198}, '1': {'precision': 0.3980171935662784, 'recall': 0.18639005227103017, 'f1-score': 0.25388612493090107, 'support': 61602}, '2': {'precision': 0.36218912696272637, 'recall': 0.5793175522120664, 'f1-score': 0.4457164736287929, 'support': 60283}, 'accuracy': 0.3720552973241644, 'macro avg': {'precision': 0.3785873304662928, 'recall': 0.37349681350783, 'f1-score': 0.3548254779171329, 'support': 183083}, 'weighted avg': {'precision': 0.37871215921007656, 'recall': 0.3720552973241644, 'f1-score': 0.35414849119699726, 'support': 183083}}
[[21712  9261 30225]
 [18846 11482 31274]
 [17255  8105 34923]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0962015
{'0': {'precision': 0.38021646953804955, 'recall': 0.349774173680969, 'f1-score': 0.3643605645851155, 'support': 19484}, '1': {'precision': 0.31588814247773783, 'recall': 0.12766763480237403, 'f1-score': 0.18184270875489003, 'support': 15838}, '2': {'precision': 0.37591084440634376, 'recall': 0.5897475687978482, 'f1-score': 0.459153057731419, 'support': 19332}, 'accuracy': 0.37029311669777143, 'macro avg': {'precision': 0.35733848547404373, 'recall': 0.3557297924270637, 'f1-score': 0.33511877702380816, 'support': 54654}, 'weighted avg': {'precision': 0.36005200968099693, 'recall': 0.37029311669777143, 'f1-score': 0.34499895659421326, 'support': 54654}}
[[ 6815  2265 10404]
 [ 5292  2022  8524]
 [ 5817  2114 11401]]
training model: results/PCAR/W2/deepOF_L1/h200
Epoch 1/50
716/716 - 21s - loss: 3.3292 - accuracy200: 0.3459 - val_loss: 3.3159 - val_accuracy200: 0.3386 - 21s/epoch - 29ms/step
Epoch 2/50
716/716 - 18s - loss: 3.3049 - accuracy200: 0.3512 - val_loss: 3.3054 - val_accuracy200: 0.3441 - 18s/epoch - 25ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2972 - accuracy200: 0.3558 - val_loss: 3.2987 - val_accuracy200: 0.3528 - 18s/epoch - 25ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2919 - accuracy200: 0.3569 - val_loss: 3.2965 - val_accuracy200: 0.3542 - 18s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2890 - accuracy200: 0.3622 - val_loss: 3.2963 - val_accuracy200: 0.3563 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2868 - accuracy200: 0.3619 - val_loss: 3.2943 - val_accuracy200: 0.3553 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.2858 - accuracy200: 0.3644 - val_loss: 3.2935 - val_accuracy200: 0.3605 - 18s/epoch - 26ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2839 - accuracy200: 0.3645 - val_loss: 3.2932 - val_accuracy200: 0.3592 - 18s/epoch - 26ms/step
Epoch 9/50
716/716 - 19s - loss: 3.2822 - accuracy200: 0.3673 - val_loss: 3.2948 - val_accuracy200: 0.3575 - 19s/epoch - 26ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2808 - accuracy200: 0.3681 - val_loss: 3.2947 - val_accuracy200: 0.3565 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2796 - accuracy200: 0.3697 - val_loss: 3.2956 - val_accuracy200: 0.3542 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2789 - accuracy200: 0.3704 - val_loss: 3.2950 - val_accuracy200: 0.3548 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 19s - loss: 3.2773 - accuracy200: 0.3702 - val_loss: 3.2947 - val_accuracy200: 0.3559 - 19s/epoch - 26ms/step
Epoch 14/50
716/716 - 18s - loss: 3.2760 - accuracy200: 0.3713 - val_loss: 3.2954 - val_accuracy200: 0.3581 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2746 - accuracy200: 0.3728 - val_loss: 3.2961 - val_accuracy200: 0.3571 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2739 - accuracy200: 0.3737 - val_loss: 3.2992 - val_accuracy200: 0.3538 - 18s/epoch - 25ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2718 - accuracy200: 0.3750 - val_loss: 3.2975 - val_accuracy200: 0.3567 - 18s/epoch - 25ms/step
Epoch 18/50
716/716 - 18s - loss: 3.2709 - accuracy200: 0.3760 - val_loss: 3.2989 - val_accuracy200: 0.3550 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h200
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985562
{'0': {'precision': 0.3501722309673255, 'recall': 0.328136668579928, 'f1-score': 0.3387965258174079, 'support': 162027}, '1': {'precision': 0.32698772333797144, 'recall': 0.17147524893130658, 'f1-score': 0.22497278384228606, 'support': 154862}, '2': {'precision': 0.3670933383163599, 'recall': 0.544984828781968, 'f1-score': 0.43869112834004426, 'support': 173025}, 'accuracy': 0.3552011169307266, 'macro avg': {'precision': 0.3480844308738856, 'recall': 0.34819891543106757, 'f1-score': 0.3341534793332461, 'support': 489914}, 'weighted avg': {'precision': 0.3488196984382891, 'recall': 0.3552011169307266, 'f1-score': 0.33809699747514343, 'support': 489914}}
[[53167 26856 82004]
 [47735 26555 80572]
 [50929 27800 94296]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967637
{'0': {'precision': 0.36749384353097175, 'recall': 0.34342361479907946, 'f1-score': 0.3550512445095168, 'support': 62139}, '1': {'precision': 0.36318323613183234, 'recall': 0.17778773694519137, 'f1-score': 0.2387171543827587, 'support': 60246}, '2': {'precision': 0.351322208496472, 'recall': 0.5528847737981482, 'f1-score': 0.4296376904365638, 'support': 60698}, 'accuracy': 0.35836205436878354, 'macro avg': {'precision': 0.3606664293864254, 'recall': 0.358032041847473, 'f1-score': 0.34113536310961307, 'support': 183083}, 'weighted avg': {'precision': 0.360713952679868, 'recall': 0.35836205436878354, 'f1-score': 0.3414977441905535, 'support': 183083}}
[[21340  9709 31090]
 [18662 10711 30873]
 [18067  9072 33559]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980312
{'0': {'precision': 0.37319168173598555, 'recall': 0.3474509391276898, 'f1-score': 0.35986159169550175, 'support': 19007}, '1': {'precision': 0.3231908982669665, 'recall': 0.14528694617900684, 'f1-score': 0.20045950603101664, 'support': 16815}, '2': {'precision': 0.36028436341372155, 'recall': 0.562446898895497, 'f1-score': 0.4392195890609774, 'support': 18832}, 'accuracy': 0.3593332601456435, 'macro avg': {'precision': 0.3522223144722245, 'recall': 0.35172826140073127, 'f1-score': 0.33318022892916527, 'support': 54654}, 'weighted avg': {'precision': 0.3533608588744122, 'recall': 0.3593332601456435, 'f1-score': 0.3381637056476063, 'support': 54654}}
[[ 6604  2564  9839]
 [ 5404  2443  8968]
 [ 5688  2552 10592]]
training model: results/PCAR/W2/deepOF_L1/h300
Epoch 1/50
716/716 - 22s - loss: 3.3336 - accuracy300: 0.3463 - val_loss: 3.3177 - val_accuracy300: 0.3425 - 22s/epoch - 31ms/step
Epoch 2/50
716/716 - 18s - loss: 3.3087 - accuracy300: 0.3490 - val_loss: 3.3078 - val_accuracy300: 0.3409 - 18s/epoch - 26ms/step
Epoch 3/50
716/716 - 19s - loss: 3.3009 - accuracy300: 0.3509 - val_loss: 3.3020 - val_accuracy300: 0.3461 - 19s/epoch - 26ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2956 - accuracy300: 0.3523 - val_loss: 3.3009 - val_accuracy300: 0.3413 - 18s/epoch - 25ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2941 - accuracy300: 0.3527 - val_loss: 3.2978 - val_accuracy300: 0.3435 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2911 - accuracy300: 0.3531 - val_loss: 3.2985 - val_accuracy300: 0.3469 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 19s - loss: 3.2906 - accuracy300: 0.3537 - val_loss: 3.2973 - val_accuracy300: 0.3471 - 19s/epoch - 26ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2885 - accuracy300: 0.3564 - val_loss: 3.2979 - val_accuracy300: 0.3471 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2876 - accuracy300: 0.3574 - val_loss: 3.2967 - val_accuracy300: 0.3486 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2864 - accuracy300: 0.3594 - val_loss: 3.2979 - val_accuracy300: 0.3473 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2849 - accuracy300: 0.3604 - val_loss: 3.2973 - val_accuracy300: 0.3492 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2841 - accuracy300: 0.3619 - val_loss: 3.2982 - val_accuracy300: 0.3464 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.2824 - accuracy300: 0.3631 - val_loss: 3.2982 - val_accuracy300: 0.3439 - 18s/epoch - 26ms/step
Epoch 14/50
716/716 - 18s - loss: 3.2816 - accuracy300: 0.3641 - val_loss: 3.3003 - val_accuracy300: 0.3469 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2803 - accuracy300: 0.3655 - val_loss: 3.2998 - val_accuracy300: 0.3475 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2800 - accuracy300: 0.3664 - val_loss: 3.2999 - val_accuracy300: 0.3460 - 18s/epoch - 25ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2784 - accuracy300: 0.3677 - val_loss: 3.3011 - val_accuracy300: 0.3461 - 18s/epoch - 25ms/step
Epoch 18/50
716/716 - 18s - loss: 3.2766 - accuracy300: 0.3699 - val_loss: 3.3021 - val_accuracy300: 0.3436 - 18s/epoch - 25ms/step
Epoch 19/50
716/716 - 18s - loss: 3.2754 - accuracy300: 0.3696 - val_loss: 3.3035 - val_accuracy300: 0.3472 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h300
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979241
{'0': {'precision': 0.3205636028951147, 'recall': 0.2234313389624435, 'f1-score': 0.26332581245299447, 'support': 148869}, '1': {'precision': 0.37980655193316293, 'recall': 0.2417425729287236, 'f1-score': 0.2954405674689409, 'support': 178839}, '2': {'precision': 0.3414498905715251, 'recall': 0.5732525307325254, 'f1-score': 0.4279796561802407, 'support': 162206}, 'accuracy': 0.34593826671619915, 'macro avg': {'precision': 0.3472733484666009, 'recall': 0.3461421475412308, 'f1-score': 0.32891534536739203, 'support': 489914}, 'weighted avg': {'precision': 0.3491050018791309, 'recall': 0.34593826671619915, 'f1-score': 0.32956440136435144, 'support': 489914}}
[[33262 33943 81664]
 [37931 43233 97675]
 [32568 36653 92985]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975385
{'0': {'precision': 0.3659752371763949, 'recall': 0.22101021217368788, 'f1-score': 0.2755920607852436, 'support': 61789}, '1': {'precision': 0.3561348089902961, 'recall': 0.25786970759079164, 'f1-score': 0.2991390993948881, 'support': 60771}, '2': {'precision': 0.3464909694790008, 'recall': 0.582604960097814, 'f1-score': 0.4345457794428458, 'support': 60523}, 'accuracy': 0.3527798867180459, 'macro avg': {'precision': 0.3562003385485639, 'recall': 0.3538282932874312, 'f1-score': 0.3364256465409925, 'support': 183083}, 'weighted avg': {'precision': 0.3562678421962668, 'recall': 0.3527798867180459, 'f1-score': 0.3359544810954896, 'support': 183083}}
[[13656 14514 33619]
 [12214 15671 32886]
 [11444 13818 35261]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996848
{'0': {'precision': 0.3534314142359044, 'recall': 0.22792585280245695, 'f1-score': 0.2771313306438169, 'support': 18234}, '1': {'precision': 0.33108223627970595, 'recall': 0.21625998101513205, 'f1-score': 0.26162731786401866, 'support': 17909}, '2': {'precision': 0.3456422091867808, 'recall': 0.5825185025120199, 'f1-score': 0.4338537056409431, 'support': 18511}, 'accuracy': 0.34420170527317306, 'macro avg': {'precision': 0.34338528656746375, 'recall': 0.3422347787765363, 'f1-score': 0.32420411804959287, 'support': 54654}, 'weighted avg': {'precision': 0.3434698852959936, 'recall': 0.34420170527317306, 'f1-score': 0.3251319622297648, 'support': 54654}}
[[ 4156  3866 10212]
 [ 3834  3873 10202]
 [ 3769  3959 10783]]
training model: results/PCAR/W2/deepOF_L1/h500
Epoch 1/50
716/716 - 20s - loss: 3.3295 - accuracy500: 0.3563 - val_loss: 3.3242 - val_accuracy500: 0.3570 - 20s/epoch - 29ms/step
Epoch 2/50
716/716 - 17s - loss: 3.3043 - accuracy500: 0.3593 - val_loss: 3.3109 - val_accuracy500: 0.3579 - 17s/epoch - 24ms/step
Epoch 3/50
716/716 - 18s - loss: 3.2944 - accuracy500: 0.3647 - val_loss: 3.3041 - val_accuracy500: 0.3611 - 18s/epoch - 25ms/step
Epoch 4/50
716/716 - 18s - loss: 3.2893 - accuracy500: 0.3665 - val_loss: 3.3007 - val_accuracy500: 0.3633 - 18s/epoch - 26ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2853 - accuracy500: 0.3700 - val_loss: 3.2990 - val_accuracy500: 0.3617 - 18s/epoch - 26ms/step
Epoch 6/50
716/716 - 18s - loss: 3.2819 - accuracy500: 0.3715 - val_loss: 3.3015 - val_accuracy500: 0.3598 - 18s/epoch - 25ms/step
Epoch 7/50
716/716 - 18s - loss: 3.2801 - accuracy500: 0.3723 - val_loss: 3.2975 - val_accuracy500: 0.3620 - 18s/epoch - 25ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2767 - accuracy500: 0.3734 - val_loss: 3.2968 - val_accuracy500: 0.3619 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2747 - accuracy500: 0.3753 - val_loss: 3.2986 - val_accuracy500: 0.3618 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2721 - accuracy500: 0.3759 - val_loss: 3.3002 - val_accuracy500: 0.3593 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2704 - accuracy500: 0.3772 - val_loss: 3.2992 - val_accuracy500: 0.3602 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2686 - accuracy500: 0.3782 - val_loss: 3.3024 - val_accuracy500: 0.3587 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.2655 - accuracy500: 0.3797 - val_loss: 3.2997 - val_accuracy500: 0.3619 - 18s/epoch - 25ms/step
Epoch 14/50
716/716 - 18s - loss: 3.2628 - accuracy500: 0.3809 - val_loss: 3.3013 - val_accuracy500: 0.3617 - 18s/epoch - 25ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2608 - accuracy500: 0.3823 - val_loss: 3.3043 - val_accuracy500: 0.3587 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2599 - accuracy500: 0.3812 - val_loss: 3.3004 - val_accuracy500: 0.3580 - 18s/epoch - 26ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2578 - accuracy500: 0.3841 - val_loss: 3.3040 - val_accuracy500: 0.3562 - 18s/epoch - 25ms/step
Epoch 18/50
716/716 - 18s - loss: 3.2556 - accuracy500: 0.3853 - val_loss: 3.3065 - val_accuracy500: 0.3559 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h500
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979196
{'0': {'precision': 0.3455910566323409, 'recall': 0.203673145092287, 'f1-score': 0.25629785155874474, 'support': 163620}, '1': {'precision': 0.33739441705655165, 'recall': 0.07188444967754021, 'f1-score': 0.11851778318249755, 'support': 149476}, '2': {'precision': 0.36644102666202116, 'recall': 0.749465552149668, 'f1-score': 0.4922184913901973, 'support': 176818}, 'accuracy': 0.3604489767591863, 'macro avg': {'precision': 0.3498088334503045, 'recall': 0.34167438230649844, 'f1-score': 0.28901137537714655, 'support': 489914}, 'weighted avg': {'precision': 0.3506153039563148, 'recall': 0.3604489767591863, 'f1-score': 0.2994078712624271, 'support': 489914}}
[[ 33325  10309 119986]
 [ 29598  10745 109133]
 [ 33506  10793 132519]]
Evaluating performance on  train set...
716/716 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025683
{'0': {'precision': 0.3515229685484671, 'recall': 0.17547422118765788, 'f1-score': 0.23409316154608523, 'support': 60573}, '1': {'precision': 0.4295988154833251, 'recall': 0.09581544558192197, 'f1-score': 0.156684753259444, 'support': 63591}, '2': {'precision': 0.330679417003815, 'recall': 0.7782379198560736, 'f1-score': 0.46414147037685616, 'support': 58919}, 'accuracy': 0.3417848735273073, 'macro avg': {'precision': 0.37060040034520236, 'recall': 0.34984252887521783, 'f1-score': 0.28497312839412847, 'support': 183083}, 'weighted avg': {'precision': 0.37193360180756385, 'recall': 0.3417848735273073, 'f1-score': 0.2812397465192635, 'support': 183083}}
[[10629  4161 45783]
 [10471  6093 47027]
 [ 9137  3929 45853]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973135
{'0': {'precision': 0.3591101694915254, 'recall': 0.1758298755186722, 'f1-score': 0.23607242339832865, 'support': 19280}, '1': {'precision': 0.28784899724734564, 'recall': 0.047443126579817224, 'f1-score': 0.08146004896505675, 'support': 15429}, '2': {'precision': 0.366103442619109, 'recall': 0.7832539483579845, 'f1-score': 0.498977897023125, 'support': 19945}, 'accuracy': 0.36125443700369597, 'macro avg': {'precision': 0.33768753645266, 'recall': 0.33550898348549135, 'f1-score': 0.27217012312883676, 'support': 54654}, 'weighted avg': {'precision': 0.34154498132550287, 'recall': 0.36125443700369597, 'f1-score': 0.2883675042033129, 'support': 54654}}
[[ 3390   847 15043]
 [ 2691   732 12006]
 [ 3359   964 15622]]
training model: results/PCAR/W2/deepOF_L1/h1000
Epoch 1/50
716/716 - 20s - loss: 3.3386 - accuracy1000: 0.3492 - val_loss: 3.3208 - val_accuracy1000: 0.3525 - 20s/epoch - 28ms/step
Epoch 2/50
716/716 - 18s - loss: 3.3116 - accuracy1000: 0.3529 - val_loss: 3.3088 - val_accuracy1000: 0.3539 - 18s/epoch - 25ms/step
Epoch 3/50
716/716 - 17s - loss: 3.2992 - accuracy1000: 0.3585 - val_loss: 3.3041 - val_accuracy1000: 0.3545 - 17s/epoch - 24ms/step
Epoch 4/50
716/716 - 17s - loss: 3.2933 - accuracy1000: 0.3592 - val_loss: 3.3025 - val_accuracy1000: 0.3527 - 17s/epoch - 24ms/step
Epoch 5/50
716/716 - 18s - loss: 3.2893 - accuracy1000: 0.3611 - val_loss: 3.3010 - val_accuracy1000: 0.3544 - 18s/epoch - 25ms/step
Epoch 6/50
716/716 - 17s - loss: 3.2868 - accuracy1000: 0.3625 - val_loss: 3.3012 - val_accuracy1000: 0.3538 - 17s/epoch - 24ms/step
Epoch 7/50
716/716 - 17s - loss: 3.2845 - accuracy1000: 0.3616 - val_loss: 3.2990 - val_accuracy1000: 0.3539 - 17s/epoch - 24ms/step
Epoch 8/50
716/716 - 18s - loss: 3.2827 - accuracy1000: 0.3620 - val_loss: 3.3002 - val_accuracy1000: 0.3542 - 18s/epoch - 25ms/step
Epoch 9/50
716/716 - 18s - loss: 3.2802 - accuracy1000: 0.3650 - val_loss: 3.2997 - val_accuracy1000: 0.3539 - 18s/epoch - 25ms/step
Epoch 10/50
716/716 - 18s - loss: 3.2786 - accuracy1000: 0.3651 - val_loss: 3.2999 - val_accuracy1000: 0.3536 - 18s/epoch - 25ms/step
Epoch 11/50
716/716 - 18s - loss: 3.2760 - accuracy1000: 0.3667 - val_loss: 3.2996 - val_accuracy1000: 0.3522 - 18s/epoch - 25ms/step
Epoch 12/50
716/716 - 18s - loss: 3.2746 - accuracy1000: 0.3672 - val_loss: 3.3018 - val_accuracy1000: 0.3532 - 18s/epoch - 25ms/step
Epoch 13/50
716/716 - 18s - loss: 3.2725 - accuracy1000: 0.3694 - val_loss: 3.3007 - val_accuracy1000: 0.3550 - 18s/epoch - 25ms/step
Epoch 14/50
716/716 - 18s - loss: 3.2704 - accuracy1000: 0.3694 - val_loss: 3.3005 - val_accuracy1000: 0.3526 - 18s/epoch - 24ms/step
Epoch 15/50
716/716 - 18s - loss: 3.2702 - accuracy1000: 0.3687 - val_loss: 3.3015 - val_accuracy1000: 0.3538 - 18s/epoch - 25ms/step
Epoch 16/50
716/716 - 18s - loss: 3.2676 - accuracy1000: 0.3711 - val_loss: 3.3010 - val_accuracy1000: 0.3530 - 18s/epoch - 25ms/step
Epoch 17/50
716/716 - 18s - loss: 3.2664 - accuracy1000: 0.3720 - val_loss: 3.3019 - val_accuracy1000: 0.3533 - 18s/epoch - 25ms/step
testing model: results/PCAR/W2/deepOF_L1/h1000
Evaluating performance on  test set...
1914/1914 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003135
{'0': {'precision': 0.3372931859170391, 'recall': 0.0530996938573968, 'f1-score': 0.09175456746408421, 'support': 162016}, '1': {'precision': 0.3427278795520285, 'recall': 0.059928542248909006, 'f1-score': 0.10201840128488876, 'support': 154217}, '2': {'precision': 0.3561294983106332, 'recall': 0.8969662772554281, 'f1-score': 0.5098351722975571, 'support': 173681}, 'accuracy': 0.35441118237078345, 'macro avg': {'precision': 0.3453835212599003, 'recall': 0.3366648377872446, 'f1-score': 0.23453604701551004, 'support': 489914}, 'weighted avg': {'precision': 0.34568166169266296, 'recall': 0.35441118237078345, 'f1-score': 0.24320056653417696, 'support': 489914}}
[[  8603   8620 144793]
 [  8112   9242 136863]
 [  8791   9104 155786]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052151
{'0': {'precision': 0.3603123450669311, 'recall': 0.046543277082199234, 'f1-score': 0.08243768255678757, 'support': 62458}, '1': {'precision': 0.42486741308190923, 'recall': 0.08083606951229279, 'f1-score': 0.1358290497079958, 'support': 62435}, '2': {'precision': 0.3225958709297764, 'recall': 0.9043993813369995, 'f1-score': 0.4755609372599694, 'support': 58190}, 'accuracy': 0.3308936384044395, 'macro avg': {'precision': 0.3692585430262056, 'recall': 0.34392624264383054, 'f1-score': 0.23127588984158423, 'support': 183083}, 'weighted avg': {'precision': 0.3703393494391236, 'recall': 0.3308936384044395, 'f1-score': 0.22559314865284147, 'support': 183083}}
[[ 2907  3623 55928]
 [ 2807  5047 54581]
 [ 2354  3209 52627]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003559
{'0': {'precision': 0.359697097181321, 'recall': 0.045878943979394717, 'f1-score': 0.0813781944510541, 'support': 18636}, '1': {'precision': 0.3198343304187759, 'recall': 0.04196099740385196, 'f1-score': 0.07418872758326217, 'support': 16563}, '2': {'precision': 0.3561591888871148, 'recall': 0.9172449241840144, 'f1-score': 0.5130896073836599, 'support': 19455}, 'accuracy': 0.35486881106597873, 'macro avg': {'precision': 0.34523020549573724, 'recall': 0.33502828852242034, 'f1-score': 0.2228855098059921, 'support': 54654}, 'weighted avg': {'precision': 0.3463572316316483, 'recall': 0.35486881106597873, 'f1-score': 0.23287426791086688, 'support': 54654}}
[[  855   684 17097]
 [  706   695 15162]
 [  816   794 17845]]
training model: results/PCAR/W2/deepLOB_L2/h10
Epoch 1/50
716/716 - 38s - loss: 3.2557 - accuracy10: 0.3999 - val_loss: 3.5572 - val_accuracy10: 0.3588 - 38s/epoch - 53ms/step
Epoch 2/50
716/716 - 34s - loss: 3.0770 - accuracy10: 0.4693 - val_loss: 3.3677 - val_accuracy10: 0.4249 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 33s - loss: 3.0099 - accuracy10: 0.4882 - val_loss: 3.2489 - val_accuracy10: 0.4517 - 33s/epoch - 47ms/step
Epoch 4/50
716/716 - 33s - loss: 2.9646 - accuracy10: 0.5010 - val_loss: 3.2145 - val_accuracy10: 0.4612 - 33s/epoch - 46ms/step
Epoch 5/50
716/716 - 34s - loss: 2.9300 - accuracy10: 0.5113 - val_loss: 3.2105 - val_accuracy10: 0.4652 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 34s - loss: 2.9051 - accuracy10: 0.5191 - val_loss: 3.1992 - val_accuracy10: 0.4707 - 34s/epoch - 47ms/step
Epoch 7/50
716/716 - 34s - loss: 2.8891 - accuracy10: 0.5232 - val_loss: 3.2238 - val_accuracy10: 0.4698 - 34s/epoch - 48ms/step
Epoch 8/50
716/716 - 33s - loss: 2.8725 - accuracy10: 0.5283 - val_loss: 3.2131 - val_accuracy10: 0.4718 - 33s/epoch - 46ms/step
Epoch 9/50
716/716 - 33s - loss: 2.8576 - accuracy10: 0.5317 - val_loss: 3.2386 - val_accuracy10: 0.4696 - 33s/epoch - 47ms/step
Epoch 10/50
716/716 - 34s - loss: 2.8440 - accuracy10: 0.5364 - val_loss: 3.2312 - val_accuracy10: 0.4744 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 33s - loss: 2.8289 - accuracy10: 0.5405 - val_loss: 3.2362 - val_accuracy10: 0.4734 - 33s/epoch - 46ms/step
Epoch 12/50
716/716 - 33s - loss: 2.8158 - accuracy10: 0.5428 - val_loss: 3.2546 - val_accuracy10: 0.4738 - 33s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 2.8032 - accuracy10: 0.5471 - val_loss: 3.2229 - val_accuracy10: 0.4766 - 34s/epoch - 47ms/step
Epoch 14/50
716/716 - 33s - loss: 2.7892 - accuracy10: 0.5505 - val_loss: 3.2261 - val_accuracy10: 0.4778 - 33s/epoch - 46ms/step
Epoch 15/50
716/716 - 33s - loss: 2.7774 - accuracy10: 0.5523 - val_loss: 3.2360 - val_accuracy10: 0.4779 - 33s/epoch - 47ms/step
Epoch 16/50
716/716 - 34s - loss: 2.7685 - accuracy10: 0.5556 - val_loss: 3.2350 - val_accuracy10: 0.4786 - 34s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h10
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0300864
{'0': {'precision': 0.5249406969362868, 'recall': 0.30966317822582234, 'f1-score': 0.389537622412297, 'support': 152217}, '1': {'precision': 0.530590831795651, 'recall': 0.48449975221628766, 'f1-score': 0.506498889029599, 'support': 181610}, '2': {'precision': 0.4354950233042528, 'recall': 0.6536721933218871, 'f1-score': 0.5227314644042789, 'support': 156092}, 'accuracy': 0.4840779802375495, 'macro avg': {'precision': 0.49700885067873024, 'recall': 0.4826117079213324, 'f1-score': 0.4729226586153916, 'support': 489919}, 'weighted avg': {'precision': 0.498537081039042, 'recall': 0.4840779802375495, 'f1-score': 0.4753310470693947, 'support': 489919}}
[[ 47136  41888  63193]
 [ 24554  87990  69066]
 [ 18103  35956 102033]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9848571
{'0': {'precision': 0.48181499824903695, 'recall': 0.3647484330322483, 'f1-score': 0.41518747238298465, 'support': 52809}, '1': {'precision': 0.5799507606843002, 'recall': 0.6010939687773983, 'f1-score': 0.5903331105742045, 'support': 76419}, '2': {'precision': 0.45125195618153363, 'recall': 0.5354191811345279, 'f1-score': 0.4897456583584561, 'support': 53855}, 'accuracy': 0.5136031198964404, 'macro avg': {'precision': 0.5043392383716235, 'recall': 0.5004205276480581, 'f1-score': 0.4984220804385484, 'support': 183083}, 'weighted avg': {'precision': 0.5137866406134016, 'recall': 0.5136031198964404, 'f1-score': 0.5102251636522114, 'support': 183083}}
[[19262 17321 16226]
 [11645 45935 18839]
 [ 9071 15949 28835]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0406135
{'0': {'precision': 0.4808467741935484, 'recall': 0.4198019801980198, 'f1-score': 0.44825560906848344, 'support': 18180}, '1': {'precision': 0.5044587834408758, 'recall': 0.37852246763137853, 'f1-score': 0.4325097125097125, 'support': 18382}, '2': {'precision': 0.44295490015606864, 'recall': 0.611817377846562, 'f1-score': 0.513869223091386, 'support': 18092}, 'accuracy': 0.4694807333406521, 'macro avg': {'precision': 0.47608681926349766, 'recall': 0.47004727522532014, 'f1-score': 0.46487818155652727, 'support': 54654}, 'weighted avg': {'precision': 0.4762450280980804, 'recall': 0.4694807333406521, 'f1-score': 0.4646796664907952, 'support': 54654}}
[[ 7632  3531  7017]
 [ 4521  6958  6903]
 [ 3719  3304 11069]]
training model: results/PCAR/W2/deepLOB_L2/h20
Epoch 1/50
716/716 - 37s - loss: 3.2371 - accuracy20: 0.4045 - val_loss: 3.3952 - val_accuracy20: 0.3559 - 37s/epoch - 52ms/step
Epoch 2/50
716/716 - 34s - loss: 3.1014 - accuracy20: 0.4579 - val_loss: 3.3286 - val_accuracy20: 0.3876 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.0531 - accuracy20: 0.4759 - val_loss: 3.2277 - val_accuracy20: 0.4328 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.0200 - accuracy20: 0.4849 - val_loss: 3.2330 - val_accuracy20: 0.4282 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 2.9998 - accuracy20: 0.4924 - val_loss: 3.2483 - val_accuracy20: 0.4296 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 33s - loss: 2.9879 - accuracy20: 0.4960 - val_loss: 3.2562 - val_accuracy20: 0.4364 - 33s/epoch - 46ms/step
Epoch 7/50
716/716 - 34s - loss: 2.9714 - accuracy20: 0.5012 - val_loss: 3.2299 - val_accuracy20: 0.4419 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 33s - loss: 2.9590 - accuracy20: 0.5053 - val_loss: 3.2928 - val_accuracy20: 0.4306 - 33s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 2.9477 - accuracy20: 0.5083 - val_loss: 3.2814 - val_accuracy20: 0.4364 - 34s/epoch - 47ms/step
Epoch 10/50
716/716 - 34s - loss: 2.9373 - accuracy20: 0.5115 - val_loss: 3.2879 - val_accuracy20: 0.4344 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 34s - loss: 2.9263 - accuracy20: 0.5149 - val_loss: 3.3066 - val_accuracy20: 0.4329 - 34s/epoch - 47ms/step
Epoch 12/50
716/716 - 34s - loss: 2.9171 - accuracy20: 0.5169 - val_loss: 3.4007 - val_accuracy20: 0.4161 - 34s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 2.9099 - accuracy20: 0.5191 - val_loss: 3.3771 - val_accuracy20: 0.4237 - 34s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h20
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0648819
{'0': {'precision': 0.46346325473547245, 'recall': 0.32668779286138433, 'f1-score': 0.38323758026360255, 'support': 170089}, '1': {'precision': 0.39386470612988356, 'recall': 0.458591726744593, 'f1-score': 0.42377085496040023, 'support': 142870}, '2': {'precision': 0.4584170033926266, 'recall': 0.527627712477396, 'f1-score': 0.49059340001103413, 'support': 176960}, 'accuracy': 0.4377335845313205, 'macro avg': {'precision': 0.43858165475266087, 'recall': 0.43763574402779115, 'f1-score': 0.43253394507834564, 'support': 489919}, 'weighted avg': {'precision': 0.44134423245442095, 'recall': 0.4377335845313205, 'f1-score': 0.4338350766220556, 'support': 489919}}
[[55566 53559 60964]
 [28007 65519 49344]
 [36320 47271 93369]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0665631
{'0': {'precision': 0.47489505533446, 'recall': 0.28672053716900087, 'f1-score': 0.35756139108661966, 'support': 60763}, '1': {'precision': 0.42572113918646964, 'recall': 0.6890226850252513, 'f1-score': 0.5262761111983667, 'support': 60789}, '2': {'precision': 0.46049863572931204, 'recall': 0.35931481692155176, 'f1-score': 0.4036625221376276, 'support': 61531}, 'accuracy': 0.44469448283019175, 'macro avg': {'precision': 0.4537049434167472, 'recall': 0.4450193463719347, 'f1-score': 0.429166674807538, 'support': 183083}, 'weighted avg': {'precision': 0.4537294676859916, 'recall': 0.44469448283019175, 'f1-score': 0.42907348022418323, 'support': 183083}}
[[17422 28699 14642]
 [ 7644 41885 11260]
 [11620 27802 22109]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0767525
{'0': {'precision': 0.46747500287323296, 'recall': 0.4003247871659859, 'f1-score': 0.43130185828274525, 'support': 20321}, '1': {'precision': 0.3546709991876523, 'recall': 0.4723404255319149, 'f1-score': 0.4051345499536035, 'support': 13865}, '2': {'precision': 0.4791611220524831, 'recall': 0.43980848153214774, 'f1-score': 0.4586422111832888, 'support': 20468}, 'accuracy': 0.4333809053317232, 'macro avg': {'precision': 0.4337690413711228, 'recall': 0.43749123141001617, 'f1-score': 0.4316928731398792, 'support': 54654}, 'weighted avg': {'precision': 0.44323458087777645, 'recall': 0.4333809053317232, 'f1-score': 0.434902557466424, 'support': 54654}}
[[8135 5985 6201]
 [3732 6549 3584]
 [5535 5931 9002]]
training model: results/PCAR/W2/deepLOB_L2/h30
Epoch 1/50
716/716 - 37s - loss: 3.2664 - accuracy30: 0.3915 - val_loss: 3.4860 - val_accuracy30: 0.3257 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 34s - loss: 3.1747 - accuracy30: 0.4250 - val_loss: 3.3713 - val_accuracy30: 0.3556 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.1257 - accuracy30: 0.4478 - val_loss: 3.3372 - val_accuracy30: 0.3737 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.0970 - accuracy30: 0.4603 - val_loss: 3.3364 - val_accuracy30: 0.3877 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 33s - loss: 3.0846 - accuracy30: 0.4645 - val_loss: 3.3232 - val_accuracy30: 0.4041 - 33s/epoch - 46ms/step
Epoch 6/50
716/716 - 33s - loss: 3.0690 - accuracy30: 0.4700 - val_loss: 3.3287 - val_accuracy30: 0.4099 - 33s/epoch - 47ms/step
Epoch 7/50
716/716 - 34s - loss: 3.0583 - accuracy30: 0.4738 - val_loss: 3.3330 - val_accuracy30: 0.4121 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 34s - loss: 3.0469 - accuracy30: 0.4776 - val_loss: 3.3493 - val_accuracy30: 0.4174 - 34s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 3.0368 - accuracy30: 0.4813 - val_loss: 3.3346 - val_accuracy30: 0.4123 - 34s/epoch - 48ms/step
Epoch 10/50
716/716 - 34s - loss: 3.0275 - accuracy30: 0.4853 - val_loss: 3.3409 - val_accuracy30: 0.4174 - 34s/epoch - 48ms/step
Epoch 11/50
716/716 - 34s - loss: 3.0196 - accuracy30: 0.4881 - val_loss: 3.3472 - val_accuracy30: 0.4228 - 34s/epoch - 47ms/step
Epoch 12/50
716/716 - 34s - loss: 3.0110 - accuracy30: 0.4894 - val_loss: 3.3206 - val_accuracy30: 0.4169 - 34s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 3.0012 - accuracy30: 0.4922 - val_loss: 3.3321 - val_accuracy30: 0.4200 - 34s/epoch - 47ms/step
Epoch 14/50
716/716 - 34s - loss: 2.9935 - accuracy30: 0.4948 - val_loss: 3.3413 - val_accuracy30: 0.4226 - 34s/epoch - 47ms/step
Epoch 15/50
716/716 - 34s - loss: 2.9852 - accuracy30: 0.4976 - val_loss: 3.3456 - val_accuracy30: 0.4240 - 34s/epoch - 48ms/step
Epoch 16/50
716/716 - 34s - loss: 2.9802 - accuracy30: 0.4981 - val_loss: 3.3314 - val_accuracy30: 0.4242 - 34s/epoch - 47ms/step
Epoch 17/50
716/716 - 33s - loss: 2.9713 - accuracy30: 0.5011 - val_loss: 3.3553 - val_accuracy30: 0.4193 - 33s/epoch - 46ms/step
Epoch 18/50
716/716 - 34s - loss: 2.9636 - accuracy30: 0.5029 - val_loss: 3.3635 - val_accuracy30: 0.4230 - 34s/epoch - 47ms/step
Epoch 19/50
716/716 - 33s - loss: 2.9576 - accuracy30: 0.5052 - val_loss: 3.3386 - val_accuracy30: 0.4210 - 33s/epoch - 46ms/step
Epoch 20/50
716/716 - 33s - loss: 2.9513 - accuracy30: 0.5061 - val_loss: 3.3715 - val_accuracy30: 0.4203 - 33s/epoch - 46ms/step
Epoch 21/50
716/716 - 34s - loss: 2.9427 - accuracy30: 0.5088 - val_loss: 3.4269 - val_accuracy30: 0.4178 - 34s/epoch - 47ms/step
Epoch 22/50
716/716 - 33s - loss: 2.9364 - accuracy30: 0.5108 - val_loss: 3.3871 - val_accuracy30: 0.4210 - 33s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h30
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1042225
{'0': {'precision': 0.4287597502834583, 'recall': 0.37500373372841156, 'f1-score': 0.400084130287222, 'support': 167393}, '1': {'precision': 0.3702199584294557, 'recall': 0.5514142053302308, 'f1-score': 0.44300559202794376, 'support': 146973}, '2': {'precision': 0.46801970980996405, 'recall': 0.3322016712901517, 'f1-score': 0.3885847928278491, 'support': 175553}, 'accuracy': 0.4125886115868133, 'macro avg': {'precision': 0.422333139507626, 'recall': 0.4195398701162647, 'f1-score': 0.4105581717143383, 'support': 489919}, 'weighted avg': {'precision': 0.42526618266635907, 'recall': 0.4125886115868133, 'f1-score': 0.4088397670504702, 'support': 489919}}
[[62773 68878 35742]
 [35383 81043 30547]
 [48250 68984 58319]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0741267
{'0': {'precision': 0.47403110485844785, 'recall': 0.3958893306079091, 'f1-score': 0.4314506226977723, 'support': 62131}, '1': {'precision': 0.4215268545977207, 'recall': 0.6266617117954089, 'f1-score': 0.5040214112979919, 'support': 59201}, '2': {'precision': 0.47511752309936783, 'recall': 0.3322537286845557, 'f1-score': 0.3910458002172794, 'support': 61751}, 'accuracy': 0.4490476996771956, 'macro avg': {'precision': 0.4568918275185121, 'recall': 0.45160159036262454, 'f1-score': 0.4421726114043479, 'support': 183083}, 'weighted avg': {'precision': 0.45741996834173, 'recall': 0.4490476996771956, 'f1-score': 0.4412889204257355, 'support': 183083}}
[[24597 24998 12536]
 [11972 37099 10130]
 [15320 25914 20517]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1116211
{'0': {'precision': 0.4552512629619782, 'recall': 0.4277078337330136, 'f1-score': 0.44104994719352925, 'support': 20016}, '1': {'precision': 0.33765532144786603, 'recall': 0.4321371776256655, 'f1-score': 0.37909804991963125, 'support': 14463}, '2': {'precision': 0.4620797047119211, 'recall': 0.39712515489467165, 'f1-score': 0.4271471983792718, 'support': 20175}, 'accuracy': 0.4175906612507776, 'macro avg': {'precision': 0.41832876304058847, 'recall': 0.4189900554177836, 'f1-score': 0.4157650651641441, 'support': 54654}, 'weighted avg': {'precision': 0.4266526921380036, 'recall': 0.4175906612507776, 'f1-score': 0.41952364998563907, 'support': 54654}}
[[8561 5880 5575]
 [4461 6250 3752]
 [5783 6380 8012]]
training model: results/PCAR/W2/deepLOB_L2/h50
Epoch 1/50
716/716 - 36s - loss: 3.3024 - accuracy50: 0.3707 - val_loss: 3.3500 - val_accuracy50: 0.3407 - 36s/epoch - 50ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2384 - accuracy50: 0.3951 - val_loss: 3.4506 - val_accuracy50: 0.3309 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.2018 - accuracy50: 0.4150 - val_loss: 3.3369 - val_accuracy50: 0.3645 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 33s - loss: 3.1790 - accuracy50: 0.4268 - val_loss: 3.3394 - val_accuracy50: 0.3757 - 33s/epoch - 46ms/step
Epoch 5/50
716/716 - 33s - loss: 3.1644 - accuracy50: 0.4352 - val_loss: 3.3278 - val_accuracy50: 0.3852 - 33s/epoch - 47ms/step
Epoch 6/50
716/716 - 34s - loss: 3.1538 - accuracy50: 0.4396 - val_loss: 3.3124 - val_accuracy50: 0.3913 - 34s/epoch - 47ms/step
Epoch 7/50
716/716 - 34s - loss: 3.1460 - accuracy50: 0.4418 - val_loss: 3.3118 - val_accuracy50: 0.3889 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 33s - loss: 3.1367 - accuracy50: 0.4456 - val_loss: 3.3046 - val_accuracy50: 0.3941 - 33s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 3.1294 - accuracy50: 0.4481 - val_loss: 3.3209 - val_accuracy50: 0.3926 - 34s/epoch - 47ms/step
Epoch 10/50
716/716 - 33s - loss: 3.1215 - accuracy50: 0.4510 - val_loss: 3.3332 - val_accuracy50: 0.3893 - 33s/epoch - 47ms/step
Epoch 11/50
716/716 - 33s - loss: 3.1150 - accuracy50: 0.4545 - val_loss: 3.3611 - val_accuracy50: 0.3804 - 33s/epoch - 47ms/step
Epoch 12/50
716/716 - 33s - loss: 3.1072 - accuracy50: 0.4564 - val_loss: 3.3647 - val_accuracy50: 0.3834 - 33s/epoch - 47ms/step
Epoch 13/50
716/716 - 33s - loss: 3.1010 - accuracy50: 0.4595 - val_loss: 3.3732 - val_accuracy50: 0.3795 - 33s/epoch - 46ms/step
Epoch 14/50
716/716 - 33s - loss: 3.0919 - accuracy50: 0.4622 - val_loss: 3.4173 - val_accuracy50: 0.3798 - 33s/epoch - 47ms/step
Epoch 15/50
716/716 - 33s - loss: 3.0827 - accuracy50: 0.4656 - val_loss: 3.4204 - val_accuracy50: 0.3789 - 33s/epoch - 46ms/step
Epoch 16/50
716/716 - 33s - loss: 3.0787 - accuracy50: 0.4669 - val_loss: 3.4104 - val_accuracy50: 0.3795 - 33s/epoch - 46ms/step
Epoch 17/50
716/716 - 33s - loss: 3.0730 - accuracy50: 0.4708 - val_loss: 3.4346 - val_accuracy50: 0.3749 - 33s/epoch - 46ms/step
Epoch 18/50
716/716 - 33s - loss: 3.0649 - accuracy50: 0.4720 - val_loss: 3.4343 - val_accuracy50: 0.3800 - 33s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h50
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1060826
{'0': {'precision': 0.4385480348083346, 'recall': 0.22525613476903353, 'f1-score': 0.29763487413577416, 'support': 168466}, '1': {'precision': 0.3523545014113945, 'recall': 0.4373924814574579, 'f1-score': 0.39029515292400513, 'support': 141836}, '2': {'precision': 0.4147395093282187, 'recall': 0.5248890695201457, 'f1-score': 0.46335805454393547, 'support': 179617}, 'accuracy': 0.3965247316393118, 'macro avg': {'precision': 0.4018806818493159, 'recall': 0.39584589524887903, 'f1-score': 0.3837626938679049, 'support': 489919}, 'weighted avg': {'precision': 0.40486540171174035, 'recall': 0.3965247316393118, 'f1-score': 0.3852192784915559, 'support': 489919}}
[[37948 56665 73853]
 [20609 62038 59189]
 [27974 57364 94279]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0804684
{'0': {'precision': 0.43336365924004566, 'recall': 0.3608058017727639, 'f1-score': 0.3937701717511938, 'support': 62050}, '1': {'precision': 0.40865384615384615, 'recall': 0.5046839952500329, 'f1-score': 0.4516205206918944, 'support': 60632}, '2': {'precision': 0.40492023628453183, 'recall': 0.3790500157282164, 'f1-score': 0.3915582805298307, 'support': 60401}, 'accuracy': 0.41447321706548396, 'macro avg': {'precision': 0.4156459138928079, 'recall': 0.41484660425033776, 'f1-score': 0.41231632432430626, 'support': 183083}, 'weighted avg': {'precision': 0.4157966728077803, 'recall': 0.41447321706548396, 'f1-score': 0.4121988730249932, 'support': 183083}}
[[22388 22421 17241]
 [13626 30600 16406]
 [15647 21859 22895]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015332
{'0': {'precision': 0.4104353605849119, 'recall': 0.44075660242683795, 'f1-score': 0.42505592841163303, 'support': 19614}, '1': {'precision': 0.34523906824683287, 'recall': 0.2776937742423246, 'f1-score': 0.30780441594403557, 'support': 15211}, '2': {'precision': 0.4123899606667915, 'recall': 0.44414746078975237, 'f1-score': 0.42767998057545226, 'support': 19829}, 'accuracy': 0.3966040911918615, 'macro avg': {'precision': 0.3893547964995121, 'recall': 0.387532612486305, 'f1-score': 0.3868467749770403, 'support': 54654}, 'weighted avg': {'precision': 0.3929994357169987, 'recall': 0.3966040911918615, 'f1-score': 0.3933751653240593, 'support': 54654}}
[[8645 3882 7087]
 [5525 4224 5462]
 [6893 4129 8807]]
training model: results/PCAR/W2/deepLOB_L2/h100
Epoch 1/50
716/716 - 37s - loss: 3.3029 - accuracy100: 0.3661 - val_loss: 3.4109 - val_accuracy100: 0.3234 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 33s - loss: 3.2628 - accuracy100: 0.3780 - val_loss: 3.4217 - val_accuracy100: 0.3047 - 33s/epoch - 46ms/step
Epoch 3/50
716/716 - 34s - loss: 3.2477 - accuracy100: 0.3868 - val_loss: 3.4464 - val_accuracy100: 0.3005 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.2343 - accuracy100: 0.3939 - val_loss: 3.4134 - val_accuracy100: 0.3033 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 3.2186 - accuracy100: 0.4031 - val_loss: 3.4097 - val_accuracy100: 0.3216 - 34s/epoch - 48ms/step
Epoch 6/50
716/716 - 33s - loss: 3.2080 - accuracy100: 0.4085 - val_loss: 3.4965 - val_accuracy100: 0.3110 - 33s/epoch - 47ms/step
Epoch 7/50
716/716 - 33s - loss: 3.1969 - accuracy100: 0.4153 - val_loss: 3.4797 - val_accuracy100: 0.3212 - 33s/epoch - 47ms/step
Epoch 8/50
716/716 - 34s - loss: 3.1874 - accuracy100: 0.4197 - val_loss: 3.4883 - val_accuracy100: 0.3261 - 34s/epoch - 47ms/step
Epoch 9/50
716/716 - 33s - loss: 3.1799 - accuracy100: 0.4225 - val_loss: 3.4727 - val_accuracy100: 0.3446 - 33s/epoch - 46ms/step
Epoch 10/50
716/716 - 34s - loss: 3.1699 - accuracy100: 0.4280 - val_loss: 3.4847 - val_accuracy100: 0.3491 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 34s - loss: 3.1643 - accuracy100: 0.4310 - val_loss: 3.5123 - val_accuracy100: 0.3507 - 34s/epoch - 47ms/step
Epoch 12/50
716/716 - 33s - loss: 3.1535 - accuracy100: 0.4355 - val_loss: 3.5303 - val_accuracy100: 0.3536 - 33s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 3.1463 - accuracy100: 0.4385 - val_loss: 3.5663 - val_accuracy100: 0.3452 - 34s/epoch - 47ms/step
Epoch 14/50
716/716 - 34s - loss: 3.1406 - accuracy100: 0.4418 - val_loss: 3.5697 - val_accuracy100: 0.3514 - 34s/epoch - 47ms/step
Epoch 15/50
716/716 - 33s - loss: 3.1295 - accuracy100: 0.4462 - val_loss: 3.5892 - val_accuracy100: 0.3514 - 33s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h100
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1257614
{'0': {'precision': 0.39448487169666796, 'recall': 0.06298846638372818, 'f1-score': 0.1086314546068174, 'support': 163522}, '1': {'precision': 0.32518276915218525, 'recall': 0.7954122470228412, 'f1-score': 0.46163752893944715, 'support': 153670}, '2': {'precision': 0.39419960193346604, 'recall': 0.2006634747318022, 'f1-score': 0.26594846768871905, 'support': 172727}, 'accuracy': 0.34126253523541644, 'macro avg': {'precision': 0.3712890809274397, 'recall': 0.35302139604612387, 'f1-score': 0.2787391504116612, 'support': 489919}, 'weighted avg': {'precision': 0.3726467150046449, 'recall': 0.34126253523541644, 'f1-score': 0.2748208433859683, 'support': 489919}}
[[ 10300 124291  28931]
 [  7105 122231  24334]
 [  8705 129362  34660]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1092958
{'0': {'precision': 0.3972326582974434, 'recall': 0.07074317046901009, 'f1-score': 0.12009807316701529, 'support': 61278}, '1': {'precision': 0.3565901418502273, 'recall': 0.7223494631515683, 'f1-score': 0.47747380175227616, 'support': 61563}, '2': {'precision': 0.3615178778365395, 'recall': 0.28481790113210054, 'f1-score': 0.31861693731836627, 'support': 60242}, 'accuracy': 0.36029014162975265, 'macro avg': {'precision': 0.37178022599473676, 'recall': 0.3593035115842263, 'f1-score': 0.3053962707458859, 'support': 183083}, 'weighted avg': {'precision': 0.3718146509206485, 'recall': 0.36029014162975265, 'f1-score': 0.30558932791540866, 'support': 183083}}
[[ 4335 40410 16533]
 [ 3323 44470 13770]
 [ 3255 39829 17158]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1333299
{'0': {'precision': 0.360126844064525, 'recall': 0.1342171522532244, 'f1-score': 0.19555289361383543, 'support': 19461}, '1': {'precision': 0.2930448572723154, 'recall': 0.6532003534907209, 'f1-score': 0.40458224185791924, 'support': 15842}, '2': {'precision': 0.3829100835470262, 'recall': 0.23921244380135392, 'f1-score': 0.29446564885496185, 'support': 19351}, 'accuracy': 0.32182456910747614, 'macro avg': {'precision': 0.34536059496128885, 'recall': 0.34220998318176643, 'f1-score': 0.2982002614422388, 'support': 54654}, 'weighted avg': {'precision': 0.348749188860216, 'recall': 0.32182456910747614, 'f1-score': 0.29116352891141317, 'support': 54654}}
[[ 2612 12454  4395]
 [ 2429 10348  3065]
 [ 2212 12510  4629]]
training model: results/PCAR/W2/deepLOB_L2/h200
Epoch 1/50
716/716 - 37s - loss: 3.3251 - accuracy200: 0.3537 - val_loss: 3.4023 - val_accuracy200: 0.3321 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2835 - accuracy200: 0.3678 - val_loss: 3.3477 - val_accuracy200: 0.3415 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.2657 - accuracy200: 0.3812 - val_loss: 3.3207 - val_accuracy200: 0.3424 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.2491 - accuracy200: 0.3905 - val_loss: 3.3385 - val_accuracy200: 0.3480 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 3.2350 - accuracy200: 0.3985 - val_loss: 3.3377 - val_accuracy200: 0.3563 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 34s - loss: 3.2226 - accuracy200: 0.4078 - val_loss: 3.3305 - val_accuracy200: 0.3484 - 34s/epoch - 48ms/step
Epoch 7/50
716/716 - 34s - loss: 3.2147 - accuracy200: 0.4117 - val_loss: 3.3427 - val_accuracy200: 0.3560 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 34s - loss: 3.2057 - accuracy200: 0.4178 - val_loss: 3.3494 - val_accuracy200: 0.3562 - 34s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 3.1995 - accuracy200: 0.4207 - val_loss: 3.3513 - val_accuracy200: 0.3502 - 34s/epoch - 47ms/step
Epoch 10/50
716/716 - 34s - loss: 3.1889 - accuracy200: 0.4245 - val_loss: 3.3975 - val_accuracy200: 0.3454 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 34s - loss: 3.1770 - accuracy200: 0.4307 - val_loss: 3.3806 - val_accuracy200: 0.3467 - 34s/epoch - 47ms/step
Epoch 12/50
716/716 - 34s - loss: 3.1672 - accuracy200: 0.4369 - val_loss: 3.3837 - val_accuracy200: 0.3483 - 34s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 3.1573 - accuracy200: 0.4407 - val_loss: 3.3721 - val_accuracy200: 0.3487 - 34s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h200
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097451
{'0': {'precision': 0.3398866978543653, 'recall': 0.10627109961796963, 'f1-score': 0.1619164041562838, 'support': 162029}, '1': {'precision': 0.3300727223536107, 'recall': 0.456922937841433, 'f1-score': 0.38327478949948407, 'support': 154862}, '2': {'precision': 0.36702967347174725, 'recall': 0.47702106017523177, 'f1-score': 0.4148586737168548, 'support': 173028}, 'accuracy': 0.348051412580447, 'macro avg': {'precision': 0.34566303122657444, 'recall': 0.3467383658782115, 'f1-score': 0.32001662245754087, 'support': 489919}, 'weighted avg': {'precision': 0.3463707960647358, 'recall': 0.348051412580447, 'f1-score': 0.32122048766507844, 'support': 489919}}
[[17219 70993 73817]
 [15576 70760 68526]
 [17866 72624 82538]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005669
{'0': {'precision': 0.36514820993199026, 'recall': 0.2290037019153388, 'f1-score': 0.28147781789406007, 'support': 62130}, '1': {'precision': 0.353834851901356, 'recall': 0.5754227023080625, 'f1-score': 0.4382092041749855, 'support': 60267}, '2': {'precision': 0.35012687327853564, 'recall': 0.2660251128761164, 'f1-score': 0.30233625169717687, 'support': 60686}, 'accuracy': 0.3553087943719515, 'macro avg': {'precision': 0.3563699783706273, 'recall': 0.3568171723665059, 'f1-score': 0.3406744245887408, 'support': 183083}, 'weighted avg': {'precision': 0.35644501529030437, 'recall': 0.3553087943719515, 'f1-score': 0.33998431697244785, 'support': 183083}}
[[14228 31948 15954]
 [11577 34679 14011]
 [13160 31382 16144]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1087595
{'0': {'precision': 0.3521045918367347, 'recall': 0.29042609153077326, 'f1-score': 0.31830498702796195, 'support': 19010}, '1': {'precision': 0.31349080890655345, 'recall': 0.41288442091487715, 'f1-score': 0.35638734853152604, 'support': 16811}, '2': {'precision': 0.3555515950810907, 'recall': 0.3177932352785005, 'f1-score': 0.33561374978971564, 'support': 18833}, 'accuracy': 0.3375233285761335, 'macro avg': {'precision': 0.3403823319414596, 'recall': 0.3403679159080503, 'f1-score': 0.33676869511640123, 'support': 54654}, 'weighted avg': {'precision': 0.3414151840580118, 'recall': 0.3375233285761335, 'f1-score': 0.3359830802750897, 'support': 54654}}
[[5521 7631 5858]
 [4880 6941 4990]
 [5279 7569 5985]]
training model: results/PCAR/W2/deepLOB_L2/h300
Epoch 1/50
716/716 - 38s - loss: 3.3086 - accuracy300: 0.3715 - val_loss: 3.4088 - val_accuracy300: 0.3444 - 38s/epoch - 53ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2680 - accuracy300: 0.3910 - val_loss: 3.4213 - val_accuracy300: 0.3522 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.2602 - accuracy300: 0.3941 - val_loss: 3.3727 - val_accuracy300: 0.3580 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.2306 - accuracy300: 0.4111 - val_loss: 3.3680 - val_accuracy300: 0.3556 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 3.2186 - accuracy300: 0.4184 - val_loss: 3.3619 - val_accuracy300: 0.3576 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 34s - loss: 3.2071 - accuracy300: 0.4244 - val_loss: 3.3926 - val_accuracy300: 0.3526 - 34s/epoch - 47ms/step
Epoch 7/50
716/716 - 34s - loss: 3.1927 - accuracy300: 0.4311 - val_loss: 3.4269 - val_accuracy300: 0.3568 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 33s - loss: 3.1803 - accuracy300: 0.4351 - val_loss: 3.4406 - val_accuracy300: 0.3525 - 33s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 3.1643 - accuracy300: 0.4424 - val_loss: 3.4279 - val_accuracy300: 0.3564 - 34s/epoch - 47ms/step
Epoch 10/50
716/716 - 34s - loss: 3.1572 - accuracy300: 0.4449 - val_loss: 3.4654 - val_accuracy300: 0.3502 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 34s - loss: 3.1456 - accuracy300: 0.4492 - val_loss: 3.4282 - val_accuracy300: 0.3553 - 34s/epoch - 47ms/step
Epoch 12/50
716/716 - 34s - loss: 3.1347 - accuracy300: 0.4528 - val_loss: 3.4166 - val_accuracy300: 0.3522 - 34s/epoch - 47ms/step
Epoch 13/50
716/716 - 33s - loss: 3.1217 - accuracy300: 0.4578 - val_loss: 3.4393 - val_accuracy300: 0.3548 - 33s/epoch - 46ms/step
Epoch 14/50
716/716 - 34s - loss: 3.1138 - accuracy300: 0.4610 - val_loss: 3.4578 - val_accuracy300: 0.3555 - 34s/epoch - 47ms/step
Epoch 15/50
716/716 - 34s - loss: 3.0989 - accuracy300: 0.4665 - val_loss: 3.5132 - val_accuracy300: 0.3613 - 34s/epoch - 48ms/step
testing model: results/PCAR/W2/deepLOB_L2/h300
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.111925
{'0': {'precision': 0.3775144667952604, 'recall': 0.018405443712257084, 'f1-score': 0.03509963042907376, 'support': 148869}, '1': {'precision': 0.4116374150120847, 'recall': 0.5094859737311497, 'f1-score': 0.45536459452570976, 'support': 178843}, '2': {'precision': 0.36352016409879606, 'recall': 0.585609745572016, 'f1-score': 0.4485812714131561, 'support': 162207}, 'accuracy': 0.3854678018203009, 'macro avg': {'precision': 0.38422401530204703, 'recall': 0.37116705433847424, 'f1-score': 0.3130151654559799, 'support': 489919}, 'weighted avg': {'precision': 0.3853375489179299, 'recall': 0.3854678018203009, 'f1-score': 0.32541509791051404, 'support': 489919}}
[[ 2740 65264 80865]
 [ 2274 91118 85451]
 [ 2244 64973 94990]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229758
{'0': {'precision': 0.35590229404662393, 'recall': 0.06196636481241915, 'f1-score': 0.105554560855014, 'support': 61840}, '1': {'precision': 0.3514783313082219, 'recall': 0.7862449551107816, 'f1-score': 0.48579134860050893, 'support': 60705}, '2': {'precision': 0.3809862818652282, 'recall': 0.2298391093197661, 'f1-score': 0.2867122059778073, 'support': 60538}, 'accuracy': 0.3576246838865433, 'macro avg': {'precision': 0.36278896907335795, 'recall': 0.35935014308098895, 'f1-score': 0.29268603847777674, 'support': 183083}, 'weighted avg': {'precision': 0.36272967723636834, 'recall': 0.3576246838865433, 'f1-score': 0.29153138950941626, 'support': 183083}}
[[ 3832 44850 13158]
 [ 3527 47729  9449]
 [ 3408 43216 13914]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227207
{'0': {'precision': 0.34284882027381297, 'recall': 0.06464191564147627, 'f1-score': 0.10877501039693176, 'support': 18208}, '1': {'precision': 0.35622529644268774, 'recall': 0.6438577886923034, 'f1-score': 0.45867875390151286, 'support': 17917}, '2': {'precision': 0.3592397940224027, 'recall': 0.36521129040962813, 'f1-score': 0.3622009313279451, 'support': 18529}, 'accuracy': 0.3564240494748783, 'macro avg': {'precision': 0.3527713035796345, 'recall': 0.3579036649144693, 'f1-score': 0.3098848985421299, 'support': 54654}, 'weighted avg': {'precision': 0.3527909045879592, 'recall': 0.3564240494748783, 'f1-score': 0.3093999282675785, 'support': 54654}}
[[ 1177 10183  6848]
 [ 1159 11536  5222]
 [ 1097 10665  6767]]
training model: results/PCAR/W2/deepLOB_L2/h500
Epoch 1/50
716/716 - 36s - loss: 3.2768 - accuracy500: 0.3928 - val_loss: 3.6151 - val_accuracy500: 0.3194 - 36s/epoch - 51ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2185 - accuracy500: 0.4179 - val_loss: 3.6049 - val_accuracy500: 0.3170 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.1805 - accuracy500: 0.4344 - val_loss: 3.4564 - val_accuracy500: 0.3370 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.1574 - accuracy500: 0.4429 - val_loss: 3.5331 - val_accuracy500: 0.3243 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 3.1365 - accuracy500: 0.4504 - val_loss: 3.6172 - val_accuracy500: 0.3295 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 34s - loss: 3.1202 - accuracy500: 0.4553 - val_loss: 3.5824 - val_accuracy500: 0.3478 - 34s/epoch - 48ms/step
Epoch 7/50
716/716 - 34s - loss: 3.1063 - accuracy500: 0.4601 - val_loss: 3.4922 - val_accuracy500: 0.3521 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 33s - loss: 3.0877 - accuracy500: 0.4666 - val_loss: 3.5761 - val_accuracy500: 0.3433 - 33s/epoch - 46ms/step
Epoch 9/50
716/716 - 34s - loss: 3.0736 - accuracy500: 0.4694 - val_loss: 3.4764 - val_accuracy500: 0.3471 - 34s/epoch - 47ms/step
Epoch 10/50
716/716 - 34s - loss: 3.0569 - accuracy500: 0.4767 - val_loss: 3.5166 - val_accuracy500: 0.3385 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 33s - loss: 3.0401 - accuracy500: 0.4813 - val_loss: 3.4721 - val_accuracy500: 0.3476 - 33s/epoch - 47ms/step
Epoch 12/50
716/716 - 34s - loss: 3.0317 - accuracy500: 0.4841 - val_loss: 3.4312 - val_accuracy500: 0.3501 - 34s/epoch - 47ms/step
Epoch 13/50
716/716 - 34s - loss: 3.0120 - accuracy500: 0.4902 - val_loss: 3.4561 - val_accuracy500: 0.3497 - 34s/epoch - 48ms/step
Epoch 14/50
716/716 - 34s - loss: 2.9909 - accuracy500: 0.4978 - val_loss: 3.4217 - val_accuracy500: 0.3511 - 34s/epoch - 47ms/step
Epoch 15/50
716/716 - 34s - loss: 2.9773 - accuracy500: 0.5003 - val_loss: 3.4451 - val_accuracy500: 0.3471 - 34s/epoch - 47ms/step
Epoch 16/50
716/716 - 34s - loss: 2.9629 - accuracy500: 0.5052 - val_loss: 3.5226 - val_accuracy500: 0.3428 - 34s/epoch - 47ms/step
Epoch 17/50
716/716 - 34s - loss: 2.9522 - accuracy500: 0.5082 - val_loss: 3.4439 - val_accuracy500: 0.3515 - 34s/epoch - 47ms/step
Epoch 18/50
716/716 - 34s - loss: 2.9366 - accuracy500: 0.5128 - val_loss: 3.4846 - val_accuracy500: 0.3505 - 34s/epoch - 48ms/step
Epoch 19/50
716/716 - 34s - loss: 2.9146 - accuracy500: 0.5183 - val_loss: 3.5212 - val_accuracy500: 0.3447 - 34s/epoch - 47ms/step
Epoch 20/50
716/716 - 33s - loss: 2.9021 - accuracy500: 0.5217 - val_loss: 3.5199 - val_accuracy500: 0.3430 - 33s/epoch - 47ms/step
Epoch 21/50
716/716 - 33s - loss: 2.8884 - accuracy500: 0.5246 - val_loss: 3.6070 - val_accuracy500: 0.3486 - 33s/epoch - 46ms/step
Epoch 22/50
716/716 - 34s - loss: 2.8728 - accuracy500: 0.5289 - val_loss: 3.5859 - val_accuracy500: 0.3427 - 34s/epoch - 47ms/step
Epoch 23/50
716/716 - 33s - loss: 2.8620 - accuracy500: 0.5308 - val_loss: 3.6916 - val_accuracy500: 0.3422 - 33s/epoch - 46ms/step
Epoch 24/50
716/716 - 34s - loss: 2.8418 - accuracy500: 0.5363 - val_loss: 3.7804 - val_accuracy500: 0.3498 - 34s/epoch - 47ms/step
testing model: results/PCAR/W2/deepLOB_L2/h500
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1529888
{'0': {'precision': 0.3491317707588967, 'recall': 0.11943919864566717, 'f1-score': 0.17798806005491827, 'support': 163623}, '1': {'precision': 0.34465096892242264, 'recall': 0.3263712812004522, 'f1-score': 0.3352621415268739, 'support': 149477}, '2': {'precision': 0.3754352004487096, 'recall': 0.6208326028311437, 'f1-score': 0.46791116188170406, 'support': 176819}, 'accuracy': 0.36353560486529407, 'macro avg': {'precision': 0.356405980043343, 'recall': 0.35554769422575433, 'f1-score': 0.3270537878211654, 'support': 489919}, 'weighted avg': {'precision': 0.3572579494092703, 'recall': 0.36353560486529407, 'f1-score': 0.3306107809906116, 'support': 489919}}
[[ 19543  46269  97811]
 [ 15884  48785  84808]
 [ 20549  46495 109775]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200174
{'0': {'precision': 0.3608455836473906, 'recall': 0.23852968835068386, 'f1-score': 0.28720699245133097, 'support': 60613}, '1': {'precision': 0.4094200856627592, 'recall': 0.4573555566048129, 'f1-score': 0.4320623285481701, 'support': 63537}, '2': {'precision': 0.3563159355913382, 'recall': 0.43556241833947024, 'f1-score': 0.39197391828850225, 'support': 58933}, 'accuracy': 0.37789417914279316, 'macro avg': {'precision': 0.37552720163382936, 'recall': 0.37714922109832233, 'f1-score': 0.37041441309600115, 'support': 183083}, 'weighted avg': {'precision': 0.3762447872089618, 'recall': 0.37789417914279316, 'f1-score': 0.3712011520944813, 'support': 183083}}
[[14458 21962 24193]
 [12300 29059 22178]
 [13309 19955 25669]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.137506
{'0': {'precision': 0.35491896502701165, 'recall': 0.25909397540345597, 'f1-score': 0.2995290800563904, 'support': 19271}, '1': {'precision': 0.3074489674107676, 'recall': 0.33376530810600663, 'f1-score': 0.3200671078385684, 'support': 15433}, '2': {'precision': 0.3760070493454179, 'recall': 0.44917293233082706, 'f1-score': 0.4093463067013841, 'support': 19950}, 'accuracy': 0.34956270355326235, 'macro avg': {'precision': 0.3461249939277324, 'recall': 0.34734407194676326, 'f1-score': 0.3429808315321143, 'support': 54654}, 'weighted avg': {'precision': 0.34921220630744326, 'recall': 0.34956270355326235, 'f1-score': 0.3454144142374197, 'support': 54654}}
[[4993 5590 8688]
 [4099 5151 6183]
 [4976 6013 8961]]
training model: results/PCAR/W2/deepLOB_L2/h1000
Epoch 1/50
716/716 - 37s - loss: 3.2847 - accuracy1000: 0.3912 - val_loss: 3.5324 - val_accuracy1000: 0.3259 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2213 - accuracy1000: 0.4198 - val_loss: 3.6287 - val_accuracy1000: 0.3437 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 34s - loss: 3.1790 - accuracy1000: 0.4383 - val_loss: 3.5960 - val_accuracy1000: 0.3441 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 34s - loss: 3.1443 - accuracy1000: 0.4489 - val_loss: 3.6055 - val_accuracy1000: 0.3476 - 34s/epoch - 47ms/step
Epoch 5/50
716/716 - 34s - loss: 3.1230 - accuracy1000: 0.4572 - val_loss: 3.5674 - val_accuracy1000: 0.3379 - 34s/epoch - 48ms/step
Epoch 6/50
716/716 - 34s - loss: 3.1020 - accuracy1000: 0.4617 - val_loss: 3.6599 - val_accuracy1000: 0.3415 - 34s/epoch - 47ms/step
Epoch 7/50
716/716 - 35s - loss: 3.0740 - accuracy1000: 0.4704 - val_loss: 3.7554 - val_accuracy1000: 0.3428 - 35s/epoch - 49ms/step
Epoch 8/50
716/716 - 34s - loss: 3.0550 - accuracy1000: 0.4776 - val_loss: 3.8104 - val_accuracy1000: 0.3437 - 34s/epoch - 47ms/step
Epoch 9/50
716/716 - 34s - loss: 3.0384 - accuracy1000: 0.4838 - val_loss: 3.8084 - val_accuracy1000: 0.3448 - 34s/epoch - 48ms/step
Epoch 10/50
716/716 - 34s - loss: 3.0261 - accuracy1000: 0.4868 - val_loss: 3.8544 - val_accuracy1000: 0.3464 - 34s/epoch - 48ms/step
Epoch 11/50
716/716 - 34s - loss: 3.0108 - accuracy1000: 0.4920 - val_loss: 3.8000 - val_accuracy1000: 0.3405 - 34s/epoch - 48ms/step
testing model: results/PCAR/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
1914/1914 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1519604
{'0': {'precision': 0.32793973862869574, 'recall': 0.14698366848127986, 'f1-score': 0.202987619067914, 'support': 162018}, '1': {'precision': 0.30786428380601527, 'recall': 0.4259230440026456, 'f1-score': 0.35739644970414197, 'support': 154218}, '2': {'precision': 0.35570864693912574, 'recall': 0.4176862444798858, 'f1-score': 0.38421409429385533, 'support': 173683}, 'accuracy': 0.33075671692667563, 'macro avg': {'precision': 0.33050422312461225, 'recall': 0.3301976523212704, 'f1-score': 0.31486605435530374, 'support': 489919}, 'weighted avg': {'precision': 0.3314647923829618, 'recall': 0.33075671692667563, 'f1-score': 0.3158401088462752, 'support': 489919}}
[[23814 72381 65823]
 [22956 65685 65577]
 [25847 75291 72545]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.137049
{'0': {'precision': 0.3647846012832264, 'recall': 0.31860830024337133, 'f1-score': 0.3401364032613712, 'support': 62456}, '1': {'precision': 0.3575459452073512, 'recall': 0.4191280112762686, 'f1-score': 0.3858955735637863, 'support': 62432}, '2': {'precision': 0.3300751608007516, 'recall': 0.3139273133430707, 'f1-score': 0.32179878988577015, 'support': 58195}, 'accuracy': 0.3513979998142919, 'macro avg': {'precision': 0.3508019024304431, 'recall': 0.35055454162090355, 'f1-score': 0.3492769222369759, 'support': 183083}, 'weighted avg': {'precision': 0.35128340420317716, 'recall': 0.3513979998142919, 'f1-score': 0.3499116369527968, 'support': 183083}}
[[19899 24466 18091]
 [17277 26167 18988]
 [17374 22552 18269]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1697644
{'0': {'precision': 0.33154942623372613, 'recall': 0.34585860754737235, 'f1-score': 0.3385528873942515, 'support': 18629}, '1': {'precision': 0.29817925938956813, 'recall': 0.40909913715078744, 'f1-score': 0.34494161939406276, 'support': 16573}, '2': {'precision': 0.3605703757109669, 'recall': 0.2313900884227843, 'f1-score': 0.28188507906685456, 'support': 19452}, 'accuracy': 0.32429465363925786, 'macro avg': {'precision': 0.33009968711142035, 'recall': 0.3287826110403147, 'f1-score': 0.3217931952850563, 'support': 54654}, 'weighted avg': {'precision': 0.3317593236634304, 'recall': 0.32429465363925786, 'f1-score': 0.32032143586002426, 'support': 54654}}
[[6443 7836 4350]
 [6161 6780 3632]
 [6829 8122 4501]]
training model: results/PCAR/W2/deepOF_L2/h10
Epoch 1/50
716/716 - 26s - loss: 3.1241 - accuracy10: 0.4405 - val_loss: 3.2040 - val_accuracy10: 0.4560 - 26s/epoch - 36ms/step
Epoch 2/50
716/716 - 22s - loss: 2.9369 - accuracy10: 0.5153 - val_loss: 3.2325 - val_accuracy10: 0.4696 - 22s/epoch - 31ms/step
Epoch 3/50
716/716 - 22s - loss: 2.8619 - accuracy10: 0.5383 - val_loss: 3.2096 - val_accuracy10: 0.4836 - 22s/epoch - 31ms/step
Epoch 4/50
716/716 - 22s - loss: 2.8257 - accuracy10: 0.5470 - val_loss: 3.1907 - val_accuracy10: 0.4903 - 22s/epoch - 31ms/step
Epoch 5/50
716/716 - 22s - loss: 2.8013 - accuracy10: 0.5522 - val_loss: 3.1691 - val_accuracy10: 0.4944 - 22s/epoch - 31ms/step
Epoch 6/50
716/716 - 22s - loss: 2.7835 - accuracy10: 0.5568 - val_loss: 3.1557 - val_accuracy10: 0.4990 - 22s/epoch - 31ms/step
Epoch 7/50
716/716 - 22s - loss: 2.7704 - accuracy10: 0.5594 - val_loss: 3.1544 - val_accuracy10: 0.4994 - 22s/epoch - 31ms/step
Epoch 8/50
716/716 - 21s - loss: 2.7579 - accuracy10: 0.5609 - val_loss: 3.1502 - val_accuracy10: 0.5038 - 21s/epoch - 30ms/step
Epoch 9/50
716/716 - 21s - loss: 2.7488 - accuracy10: 0.5634 - val_loss: 3.1443 - val_accuracy10: 0.5014 - 21s/epoch - 30ms/step
Epoch 10/50
716/716 - 21s - loss: 2.7410 - accuracy10: 0.5654 - val_loss: 3.1493 - val_accuracy10: 0.5030 - 21s/epoch - 30ms/step
Epoch 11/50
716/716 - 21s - loss: 2.7326 - accuracy10: 0.5670 - val_loss: 3.1418 - val_accuracy10: 0.5025 - 21s/epoch - 30ms/step
Epoch 12/50
716/716 - 21s - loss: 2.7245 - accuracy10: 0.5690 - val_loss: 3.1647 - val_accuracy10: 0.5042 - 21s/epoch - 29ms/step
Epoch 13/50
716/716 - 22s - loss: 2.7188 - accuracy10: 0.5691 - val_loss: 3.1460 - val_accuracy10: 0.5036 - 22s/epoch - 31ms/step
Epoch 14/50
716/716 - 22s - loss: 2.7127 - accuracy10: 0.5718 - val_loss: 3.1308 - val_accuracy10: 0.5053 - 22s/epoch - 30ms/step
Epoch 15/50
716/716 - 22s - loss: 2.7058 - accuracy10: 0.5724 - val_loss: 3.1533 - val_accuracy10: 0.5038 - 22s/epoch - 30ms/step
Epoch 16/50
716/716 - 21s - loss: 2.6999 - accuracy10: 0.5730 - val_loss: 3.1256 - val_accuracy10: 0.5042 - 21s/epoch - 30ms/step
Epoch 17/50
716/716 - 22s - loss: 2.6939 - accuracy10: 0.5751 - val_loss: 3.1399 - val_accuracy10: 0.5049 - 22s/epoch - 30ms/step
Epoch 18/50
716/716 - 22s - loss: 2.6898 - accuracy10: 0.5736 - val_loss: 3.1242 - val_accuracy10: 0.5059 - 22s/epoch - 30ms/step
Epoch 19/50
716/716 - 22s - loss: 2.6836 - accuracy10: 0.5773 - val_loss: 3.1406 - val_accuracy10: 0.5069 - 22s/epoch - 31ms/step
Epoch 20/50
716/716 - 22s - loss: 2.6770 - accuracy10: 0.5781 - val_loss: 3.1400 - val_accuracy10: 0.5071 - 22s/epoch - 30ms/step
Epoch 21/50
716/716 - 22s - loss: 2.6721 - accuracy10: 0.5780 - val_loss: 3.1453 - val_accuracy10: 0.5077 - 22s/epoch - 30ms/step
Epoch 22/50
716/716 - 21s - loss: 2.6661 - accuracy10: 0.5809 - val_loss: 3.1381 - val_accuracy10: 0.5075 - 21s/epoch - 30ms/step
Epoch 23/50
716/716 - 22s - loss: 2.6614 - accuracy10: 0.5797 - val_loss: 3.1473 - val_accuracy10: 0.5083 - 22s/epoch - 30ms/step
Epoch 24/50
716/716 - 21s - loss: 2.6570 - accuracy10: 0.5830 - val_loss: 3.1462 - val_accuracy10: 0.5083 - 21s/epoch - 30ms/step
Epoch 25/50
716/716 - 22s - loss: 2.6516 - accuracy10: 0.5820 - val_loss: 3.1346 - val_accuracy10: 0.5061 - 22s/epoch - 30ms/step
Epoch 26/50
716/716 - 21s - loss: 2.6464 - accuracy10: 0.5834 - val_loss: 3.1435 - val_accuracy10: 0.5076 - 21s/epoch - 30ms/step
Epoch 27/50
716/716 - 21s - loss: 2.6434 - accuracy10: 0.5841 - val_loss: 3.1509 - val_accuracy10: 0.5076 - 21s/epoch - 30ms/step
Epoch 28/50
716/716 - 22s - loss: 2.6360 - accuracy10: 0.5849 - val_loss: 3.1416 - val_accuracy10: 0.5068 - 22s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h10
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9977596
{'0': {'precision': 0.4819185621631497, 'recall': 0.5545416321757526, 'f1-score': 0.5156858073226909, 'support': 152214}, '1': {'precision': 0.5610798572204189, 'recall': 0.5348963983062514, 'f1-score': 0.5476753593446523, 'support': 181609}, '2': {'precision': 0.5160914508430536, 'recall': 0.4682717132954495, 'f1-score': 0.4910200558244519, 'support': 156091}, 'accuracy': 0.5197728580934613, 'macro avg': {'precision': 0.5196966234088741, 'recall': 0.5192365812591512, 'f1-score': 0.5181270741639317, 'support': 489914}, 'weighted avg': {'precision': 0.5221511009372825, 'recall': 0.5197728580934613, 'f1-score': 0.5196854659077583, 'support': 489914}}
[[84409 36585 31220]
 [47152 97142 37315]
 [43591 39407 73093]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92269397
{'0': {'precision': 0.5020881670533642, 'recall': 0.5538724049672955, 'f1-score': 0.5267105381772289, 'support': 52745}, '1': {'precision': 0.6334350451210803, 'recall': 0.6381748492340699, 'f1-score': 0.6357961135945992, 'support': 76443}, '2': {'precision': 0.5298957876490612, 'recall': 0.47078578717877356, 'f1-score': 0.4985949812336654, 'support': 53895}, 'accuracy': 0.5646127712567524, 'macro avg': {'precision': 0.5551396666078352, 'recall': 0.5542776804600463, 'f1-score': 0.5537005443351645, 'support': 183083}, 'weighted avg': {'precision': 0.5651155432277524, 'recall': 0.5646127712567524, 'f1-score': 0.5639807418561978, 'support': 183083}}
[[29214 13474 10057]
 [15206 48784 12453]
 [13765 14757 25373]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.014017
{'0': {'precision': 0.48348248286367096, 'recall': 0.5600154380548051, 'f1-score': 0.5189423936645805, 'support': 18137}, '1': {'precision': 0.5339684429889848, 'recall': 0.48614950940532337, 'f1-score': 0.5089381987401396, 'support': 18447}, '2': {'precision': 0.508100409471248, 'recall': 0.4738240177089098, 'f1-score': 0.4903639643767361, 'support': 18070}, 'accuracy': 0.5065868920847514, 'macro avg': {'precision': 0.5085171117746347, 'recall': 0.5066629883896794, 'f1-score': 0.506081518927152, 'support': 54654}, 'weighted avg': {'precision': 0.5086619837278453, 'recall': 0.5065868920847514, 'f1-score': 0.5061169901990975, 'support': 54654}}
[[10157  3821  4159]
 [ 5349  8968  4130]
 [ 5502  4006  8562]]
training model: results/PCAR/W2/deepOF_L2/h20
Epoch 1/50
716/716 - 24s - loss: 3.1682 - accuracy20: 0.4265 - val_loss: 3.1792 - val_accuracy20: 0.4178 - 24s/epoch - 33ms/step
Epoch 2/50
716/716 - 21s - loss: 3.0082 - accuracy20: 0.4900 - val_loss: 3.2414 - val_accuracy20: 0.4138 - 21s/epoch - 30ms/step
Epoch 3/50
716/716 - 22s - loss: 2.9479 - accuracy20: 0.5086 - val_loss: 3.2174 - val_accuracy20: 0.4338 - 22s/epoch - 30ms/step
Epoch 4/50
716/716 - 21s - loss: 2.9170 - accuracy20: 0.5162 - val_loss: 3.2043 - val_accuracy20: 0.4487 - 21s/epoch - 30ms/step
Epoch 5/50
716/716 - 22s - loss: 2.8947 - accuracy20: 0.5223 - val_loss: 3.1922 - val_accuracy20: 0.4552 - 22s/epoch - 30ms/step
Epoch 6/50
716/716 - 21s - loss: 2.8786 - accuracy20: 0.5263 - val_loss: 3.2007 - val_accuracy20: 0.4562 - 21s/epoch - 30ms/step
Epoch 7/50
716/716 - 21s - loss: 2.8679 - accuracy20: 0.5305 - val_loss: 3.1827 - val_accuracy20: 0.4584 - 21s/epoch - 30ms/step
Epoch 8/50
716/716 - 21s - loss: 2.8561 - accuracy20: 0.5318 - val_loss: 3.1648 - val_accuracy20: 0.4618 - 21s/epoch - 30ms/step
Epoch 9/50
716/716 - 21s - loss: 2.8481 - accuracy20: 0.5352 - val_loss: 3.1753 - val_accuracy20: 0.4632 - 21s/epoch - 30ms/step
Epoch 10/50
716/716 - 22s - loss: 2.8411 - accuracy20: 0.5365 - val_loss: 3.1881 - val_accuracy20: 0.4613 - 22s/epoch - 30ms/step
Epoch 11/50
716/716 - 22s - loss: 2.8335 - accuracy20: 0.5383 - val_loss: 3.1840 - val_accuracy20: 0.4642 - 22s/epoch - 30ms/step
Epoch 12/50
716/716 - 22s - loss: 2.8277 - accuracy20: 0.5399 - val_loss: 3.1917 - val_accuracy20: 0.4642 - 22s/epoch - 30ms/step
Epoch 13/50
716/716 - 22s - loss: 2.8218 - accuracy20: 0.5420 - val_loss: 3.1779 - val_accuracy20: 0.4639 - 22s/epoch - 30ms/step
Epoch 14/50
716/716 - 22s - loss: 2.8148 - accuracy20: 0.5435 - val_loss: 3.1808 - val_accuracy20: 0.4647 - 22s/epoch - 31ms/step
Epoch 15/50
716/716 - 21s - loss: 2.8101 - accuracy20: 0.5445 - val_loss: 3.1943 - val_accuracy20: 0.4622 - 21s/epoch - 30ms/step
Epoch 16/50
716/716 - 22s - loss: 2.8051 - accuracy20: 0.5464 - val_loss: 3.1837 - val_accuracy20: 0.4640 - 22s/epoch - 31ms/step
Epoch 17/50
716/716 - 21s - loss: 2.7998 - accuracy20: 0.5474 - val_loss: 3.1939 - val_accuracy20: 0.4662 - 21s/epoch - 30ms/step
Epoch 18/50
716/716 - 21s - loss: 2.7938 - accuracy20: 0.5493 - val_loss: 3.1725 - val_accuracy20: 0.4685 - 21s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h20
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.046833
{'0': {'precision': 0.4987488459456878, 'recall': 0.4605376103853345, 'f1-score': 0.4788821945277419, 'support': 170086}, '1': {'precision': 0.4270444288335094, 'recall': 0.5914369107364089, 'f1-score': 0.49597342223891816, 'support': 142869}, '2': {'precision': 0.5225198530283276, 'recall': 0.3986008058363802, 'f1-score': 0.45222486864924294, 'support': 176959}, 'accuracy': 0.47633870434402775, 'macro avg': {'precision': 0.48277104260250825, 'recall': 0.48352510898604123, 'f1-score': 0.4756934951386343, 'support': 489914}, 'weighted avg': {'precision': 0.48642455081212765, 'recall': 0.47633870434402775, 'f1-score': 0.4742376097266028, 'support': 489914}}
[[78331 53394 38361]
 [32276 84498 26095]
 [46448 59975 70536]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99596554
{'0': {'precision': 0.5261640450319696, 'recall': 0.44309191510446777, 'f1-score': 0.48106804386224455, 'support': 60545}, '1': {'precision': 0.49500424168159113, 'recall': 0.6891393140101373, 'f1-score': 0.5761579867658655, 'support': 60963}, '2': {'precision': 0.5259290629962944, 'recall': 0.4033617539585871, 'f1-score': 0.4565625, 'support': 61575}, 'accuracy': 0.5116586466247549, 'macro avg': {'precision': 0.5156991165699517, 'recall': 0.511864327691064, 'f1-score': 0.5045961768760366, 'support': 183083}, 'weighted avg': {'precision': 0.5157094200231166, 'recall': 0.5116586466247549, 'f1-score': 0.5044893299779174, 'support': 183083}}
[[26827 20478 13240]
 [ 9803 42012  9148]
 [14356 22382 24837]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558255
{'0': {'precision': 0.5052620332282708, 'recall': 0.4657048599143237, 'f1-score': 0.4846776673157733, 'support': 20309}, '1': {'precision': 0.3825918356652518, 'recall': 0.5276814108123735, 'f1-score': 0.44357362009781587, 'support': 13836}, '2': {'precision': 0.5017802041300736, 'recall': 0.41230679214003607, 'f1-score': 0.45266454324027733, 'support': 20509}, 'accuracy': 0.46135689976945876, 'macro avg': {'precision': 0.46321135767453203, 'recall': 0.4685643542889111, 'f1-score': 0.46030527688462214, 'support': 54654}, 'weighted avg': {'precision': 0.47290074793429676, 'recall': 0.46135689976945876, 'f1-score': 0.4622589466554007, 'support': 54654}}
[[9458 5533 5318]
 [3457 7301 3078]
 [5804 6249 8456]]
training model: results/PCAR/W2/deepOF_L2/h30
Epoch 1/50
716/716 - 24s - loss: 3.2232 - accuracy30: 0.4055 - val_loss: 3.2172 - val_accuracy30: 0.4099 - 24s/epoch - 34ms/step
Epoch 2/50
716/716 - 22s - loss: 3.1016 - accuracy30: 0.4598 - val_loss: 3.2771 - val_accuracy30: 0.3878 - 22s/epoch - 30ms/step
Epoch 3/50
716/716 - 22s - loss: 3.0562 - accuracy30: 0.4754 - val_loss: 3.2703 - val_accuracy30: 0.3991 - 22s/epoch - 30ms/step
Epoch 4/50
716/716 - 22s - loss: 3.0333 - accuracy30: 0.4836 - val_loss: 3.2629 - val_accuracy30: 0.4114 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 22s - loss: 3.0135 - accuracy30: 0.4884 - val_loss: 3.2603 - val_accuracy30: 0.4191 - 22s/epoch - 31ms/step
Epoch 6/50
716/716 - 21s - loss: 2.9999 - accuracy30: 0.4917 - val_loss: 3.2506 - val_accuracy30: 0.4219 - 21s/epoch - 30ms/step
Epoch 7/50
716/716 - 22s - loss: 2.9880 - accuracy30: 0.4970 - val_loss: 3.2373 - val_accuracy30: 0.4286 - 22s/epoch - 31ms/step
Epoch 8/50
716/716 - 22s - loss: 2.9772 - accuracy30: 0.4992 - val_loss: 3.2388 - val_accuracy30: 0.4305 - 22s/epoch - 30ms/step
Epoch 9/50
716/716 - 21s - loss: 2.9700 - accuracy30: 0.5018 - val_loss: 3.2410 - val_accuracy30: 0.4304 - 21s/epoch - 29ms/step
Epoch 10/50
716/716 - 22s - loss: 2.9626 - accuracy30: 0.5042 - val_loss: 3.2395 - val_accuracy30: 0.4321 - 22s/epoch - 30ms/step
Epoch 11/50
716/716 - 22s - loss: 2.9575 - accuracy30: 0.5040 - val_loss: 3.2482 - val_accuracy30: 0.4293 - 22s/epoch - 31ms/step
testing model: results/PCAR/W2/deepOF_L2/h30
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0708733
{'0': {'precision': 0.43892305451229013, 'recall': 0.4140176475156671, 'f1-score': 0.4261067388096409, 'support': 167389}, '1': {'precision': 0.3641566989925007, 'recall': 0.38094071700244264, 'f1-score': 0.3723596701250333, 'support': 146973}, '2': {'precision': 0.4386737418384976, 'recall': 0.4454805413780532, 'f1-score': 0.4420509400047481, 'support': 175552}, 'accuracy': 0.4153688198336851, 'macro avg': {'precision': 0.41391783178109615, 'recall': 0.41347963529872095, 'f1-score': 0.41350578297980745, 'support': 489914}, 'weighted avg': {'precision': 0.41640399421125845, 'recall': 0.4153688198336851, 'f1-score': 0.4156960717995547, 'support': 489914}}
[[69302 46807 51280]
 [42194 55988 48791]
 [46395 50952 78205]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0577538
{'0': {'precision': 0.44744400814426993, 'recall': 0.39672791747259833, 'f1-score': 0.4205625042717518, 'support': 62040}, '1': {'precision': 0.40383886646346484, 'recall': 0.41435212577127883, 'f1-score': 0.40902795160617433, 'support': 59155}, '2': {'precision': 0.42493321460374, 'recall': 0.4626421923474664, 'f1-score': 0.4429866633660303, 'support': 61888}, 'accuracy': 0.42470354975612157, 'macro avg': {'precision': 0.42540536307049165, 'recall': 0.4245740785304479, 'f1-score': 0.42419237308131885, 'support': 183083}, 'weighted avg': {'precision': 0.42574559733188244, 'recall': 0.42470354975612157, 'f1-score': 0.4244157287387666, 'support': 183083}}
[[24613 18184 19243]
 [15139 24511 19505]
 [15256 18000 28632]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747938
{'0': {'precision': 0.45593981454481836, 'recall': 0.39062656140701507, 'f1-score': 0.42076370388310325, 'support': 20014}, '1': {'precision': 0.3270878274268105, 'recall': 0.3679794758008598, 'f1-score': 0.3463307990994225, 'support': 14422}, '2': {'precision': 0.4389625035241049, 'recall': 0.4620635077653576, 'f1-score': 0.45021686746987954, 'support': 20218}, 'accuracy': 0.4110769568558568, 'macro avg': {'precision': 0.40733004849857796, 'recall': 0.40688984832441083, 'f1-score': 0.40577045681746843, 'support': 54654}, 'weighted avg': {'precision': 0.4156582133366233, 'recall': 0.4110769568558568, 'f1-score': 0.4120180074767505, 'support': 54654}}
[[7818 5296 6900]
 [4075 5307 5040]
 [5254 5622 9342]]
training model: results/PCAR/W2/deepOF_L2/h50
Epoch 1/50
716/716 - 25s - loss: 3.2779 - accuracy50: 0.3805 - val_loss: 3.2681 - val_accuracy50: 0.3937 - 25s/epoch - 35ms/step
Epoch 2/50
716/716 - 22s - loss: 3.2077 - accuracy50: 0.4202 - val_loss: 3.2849 - val_accuracy50: 0.3748 - 22s/epoch - 31ms/step
Epoch 3/50
716/716 - 22s - loss: 3.1751 - accuracy50: 0.4352 - val_loss: 3.3011 - val_accuracy50: 0.3710 - 22s/epoch - 31ms/step
Epoch 4/50
716/716 - 22s - loss: 3.1614 - accuracy50: 0.4398 - val_loss: 3.3012 - val_accuracy50: 0.3712 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 21s - loss: 3.1500 - accuracy50: 0.4440 - val_loss: 3.3022 - val_accuracy50: 0.3755 - 21s/epoch - 30ms/step
Epoch 6/50
716/716 - 22s - loss: 3.1408 - accuracy50: 0.4474 - val_loss: 3.2938 - val_accuracy50: 0.3786 - 22s/epoch - 30ms/step
Epoch 7/50
716/716 - 21s - loss: 3.1334 - accuracy50: 0.4513 - val_loss: 3.2948 - val_accuracy50: 0.3793 - 21s/epoch - 30ms/step
Epoch 8/50
716/716 - 21s - loss: 3.1269 - accuracy50: 0.4539 - val_loss: 3.2967 - val_accuracy50: 0.3824 - 21s/epoch - 29ms/step
Epoch 9/50
716/716 - 21s - loss: 3.1224 - accuracy50: 0.4557 - val_loss: 3.2955 - val_accuracy50: 0.3852 - 21s/epoch - 30ms/step
Epoch 10/50
716/716 - 21s - loss: 3.1145 - accuracy50: 0.4586 - val_loss: 3.3005 - val_accuracy50: 0.3869 - 21s/epoch - 30ms/step
Epoch 11/50
716/716 - 21s - loss: 3.1095 - accuracy50: 0.4597 - val_loss: 3.3006 - val_accuracy50: 0.3898 - 21s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h50
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0855708
{'0': {'precision': 0.40911096973135935, 'recall': 0.4237038619985516, 'f1-score': 0.4162795648129518, 'support': 168462}, '1': {'precision': 0.32620175770084203, 'recall': 0.23735158915931076, 'f1-score': 0.27477258722080977, 'support': 141836}, '2': {'precision': 0.4222342630983792, 'recall': 0.4989254854801354, 'f1-score': 0.4573874076191254, 'support': 179616}, 'accuracy': 0.39733096012769586, 'macro avg': {'precision': 0.38584899684352686, 'recall': 0.38666031221266595, 'f1-score': 0.3828131865509623, 'support': 489914}, 'weighted avg': {'precision': 0.38991911659764644, 'recall': 0.39733096012769586, 'f1-score': 0.3903828617583639, 'support': 489914}}
[[71378 33317 63767]
 [49313 33665 58858]
 [53780 36221 89615]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0832652
{'0': {'precision': 0.40778601777958956, 'recall': 0.41998094592194285, 'f1-score': 0.4137936520563201, 'support': 61929}, '1': {'precision': 0.381257125090683, 'recall': 0.24229800266750096, 'f1-score': 0.2962940590171857, 'support': 60731}, '2': {'precision': 0.3836146011448963, 'recall': 0.5123876669480165, 'f1-score': 0.4387475288565781, 'support': 60423}, 'accuracy': 0.3915382640660247, 'macro avg': {'precision': 0.39088591467172296, 'recall': 0.39155553851248676, 'f1-score': 0.38294507997669464, 'support': 183083}, 'weighted avg': {'precision': 0.3910087326727907, 'recall': 0.3915382640660247, 'f1-score': 0.3830530607018105, 'support': 183083}}
[[26009 11989 23931]
 [20201 14715 25815]
 [17571 11892 30960]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905201
{'0': {'precision': 0.4168131527246407, 'recall': 0.4115575067640002, 'f1-score': 0.4141686573681642, 'support': 19589}, '1': {'precision': 0.3047050767876357, 'recall': 0.20420873213583324, 'f1-score': 0.2445342858264317, 'support': 15254}, '2': {'precision': 0.4052772131212882, 'recall': 0.5132502145272828, 'f1-score': 0.4529175946547884, 'support': 19811}, 'accuracy': 0.39054780985838183, 'macro avg': {'precision': 0.3755984808778549, 'recall': 0.3763388178090388, 'f1-score': 0.37054017928312816, 'support': 54654}, 'weighted avg': {'precision': 0.381342096812446, 'recall': 0.39054780985838183, 'f1-score': 0.38086921895721026, 'support': 54654}}
[[ 8062  3434  8093]
 [ 5311  3115  6828]
 [ 5969  3674 10168]]
training model: results/PCAR/W2/deepOF_L2/h100
Epoch 1/50
716/716 - 25s - loss: 3.2982 - accuracy100: 0.3674 - val_loss: 3.3113 - val_accuracy100: 0.3555 - 25s/epoch - 35ms/step
Epoch 2/50
716/716 - 22s - loss: 3.2550 - accuracy100: 0.3904 - val_loss: 3.3189 - val_accuracy100: 0.3487 - 22s/epoch - 31ms/step
Epoch 3/50
716/716 - 22s - loss: 3.2316 - accuracy100: 0.4028 - val_loss: 3.3403 - val_accuracy100: 0.3437 - 22s/epoch - 30ms/step
Epoch 4/50
716/716 - 22s - loss: 3.2198 - accuracy100: 0.4078 - val_loss: 3.3604 - val_accuracy100: 0.3381 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 22s - loss: 3.2120 - accuracy100: 0.4117 - val_loss: 3.3514 - val_accuracy100: 0.3435 - 22s/epoch - 31ms/step
Epoch 6/50
716/716 - 21s - loss: 3.2057 - accuracy100: 0.4145 - val_loss: 3.3535 - val_accuracy100: 0.3417 - 21s/epoch - 30ms/step
Epoch 7/50
716/716 - 21s - loss: 3.2010 - accuracy100: 0.4158 - val_loss: 3.3614 - val_accuracy100: 0.3444 - 21s/epoch - 30ms/step
Epoch 8/50
716/716 - 22s - loss: 3.1960 - accuracy100: 0.4176 - val_loss: 3.3596 - val_accuracy100: 0.3461 - 22s/epoch - 30ms/step
Epoch 9/50
716/716 - 22s - loss: 3.1929 - accuracy100: 0.4209 - val_loss: 3.3514 - val_accuracy100: 0.3524 - 22s/epoch - 30ms/step
Epoch 10/50
716/716 - 22s - loss: 3.1886 - accuracy100: 0.4212 - val_loss: 3.3630 - val_accuracy100: 0.3483 - 22s/epoch - 30ms/step
Epoch 11/50
716/716 - 21s - loss: 3.1857 - accuracy100: 0.4227 - val_loss: 3.3654 - val_accuracy100: 0.3510 - 21s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h100
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994192
{'0': {'precision': 0.3779738812597571, 'recall': 0.24726790158941775, 'f1-score': 0.2989589340904722, 'support': 163519}, '1': {'precision': 0.33319982282370014, 'recall': 0.46015136429598685, 'f1-score': 0.38651824197088175, 'support': 153669}, '2': {'precision': 0.3881375092986885, 'recall': 0.3836365110058706, 'f1-score': 0.38587388520566374, 'support': 172726}, 'accuracy': 0.36212069873488, 'macro avg': {'precision': 0.36643707112738194, 'recall': 0.3636852589637584, 'f1-score': 0.3571170204223392, 'support': 489914}, 'weighted avg': {'precision': 0.3675131433156323, 'recall': 0.36212069873488, 'f1-score': 0.3570663225892643, 'support': 489914}}
[[40433 69719 53367]
 [31866 70711 51092]
 [34674 71788 66264]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0939597
{'0': {'precision': 0.38562008943233206, 'recall': 0.24941991568351907, 'f1-score': 0.3029142397872615, 'support': 61198}, '1': {'precision': 0.3638369793991964, 'recall': 0.463020681146716, 'f1-score': 0.4074801602891491, 'support': 61602}, '2': {'precision': 0.36700714230857845, 'recall': 0.3963638173282683, 'f1-score': 0.38112100041471275, 'support': 60283}, 'accuracy': 0.3696738637667069, 'macro avg': {'precision': 0.37215473704670227, 'recall': 0.3696014713861678, 'f1-score': 0.36383846683037446, 'support': 183083}, 'weighted avg': {'precision': 0.3721621089768968, 'recall': 0.3696738637667069, 'f1-score': 0.3638483952558846, 'support': 183083}}
[[15264 25316 20618]
 [12486 28523 20593]
 [11833 24556 23894]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031576
{'0': {'precision': 0.4003804482673063, 'recall': 0.24846027509751592, 'f1-score': 0.3066349960411718, 'support': 19484}, '1': {'precision': 0.31020059368534675, 'recall': 0.4354716504609168, 'f1-score': 0.3623135112418575, 'support': 15838}, '2': {'precision': 0.38516405135520687, 'recall': 0.40502793296089384, 'f1-score': 0.39484632258389857, 'support': 19332}, 'accuracy': 0.3580341786511509, 'macro avg': {'precision': 0.36524836443595327, 'recall': 0.3629866195064422, 'f1-score': 0.35459827662230925, 'support': 54654}, 'weighted avg': {'precision': 0.36886524495238365, 'recall': 0.3580341786511509, 'f1-score': 0.3539716537143971, 'support': 54654}}
[[4841 7762 6881]
 [3323 6897 5618]
 [3927 7575 7830]]
training model: results/PCAR/W2/deepOF_L2/h200
Epoch 1/50
716/716 - 25s - loss: 3.3136 - accuracy200: 0.3547 - val_loss: 3.3226 - val_accuracy200: 0.3347 - 25s/epoch - 34ms/step
Epoch 2/50
716/716 - 21s - loss: 3.2861 - accuracy200: 0.3693 - val_loss: 3.3173 - val_accuracy200: 0.3393 - 21s/epoch - 30ms/step
Epoch 3/50
716/716 - 21s - loss: 3.2731 - accuracy200: 0.3754 - val_loss: 3.3319 - val_accuracy200: 0.3281 - 21s/epoch - 30ms/step
Epoch 4/50
716/716 - 22s - loss: 3.2635 - accuracy200: 0.3801 - val_loss: 3.3401 - val_accuracy200: 0.3242 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 22s - loss: 3.2572 - accuracy200: 0.3852 - val_loss: 3.3441 - val_accuracy200: 0.3269 - 22s/epoch - 31ms/step
Epoch 6/50
716/716 - 22s - loss: 3.2518 - accuracy200: 0.3890 - val_loss: 3.3550 - val_accuracy200: 0.3234 - 22s/epoch - 30ms/step
Epoch 7/50
716/716 - 23s - loss: 3.2505 - accuracy200: 0.3891 - val_loss: 3.3524 - val_accuracy200: 0.3262 - 23s/epoch - 32ms/step
Epoch 8/50
716/716 - 22s - loss: 3.2468 - accuracy200: 0.3909 - val_loss: 3.3581 - val_accuracy200: 0.3264 - 22s/epoch - 31ms/step
Epoch 9/50
716/716 - 22s - loss: 3.2436 - accuracy200: 0.3941 - val_loss: 3.3612 - val_accuracy200: 0.3307 - 22s/epoch - 30ms/step
Epoch 10/50
716/716 - 22s - loss: 3.2405 - accuracy200: 0.3948 - val_loss: 3.3549 - val_accuracy200: 0.3324 - 22s/epoch - 30ms/step
Epoch 11/50
716/716 - 22s - loss: 3.2380 - accuracy200: 0.3985 - val_loss: 3.3626 - val_accuracy200: 0.3323 - 22s/epoch - 30ms/step
Epoch 12/50
716/716 - 21s - loss: 3.2349 - accuracy200: 0.4004 - val_loss: 3.3729 - val_accuracy200: 0.3295 - 21s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h200
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058428
{'0': {'precision': 0.3718450265107135, 'recall': 0.11556715855999308, 'f1-score': 0.17633155039927675, 'support': 162027}, '1': {'precision': 0.3245925956940303, 'recall': 0.7008497888442613, 'f1-score': 0.4436927039152963, 'support': 154862}, '2': {'precision': 0.38623745056282327, 'recall': 0.23479843953185955, 'f1-score': 0.2920538156565747, 'support': 173025}, 'accuracy': 0.34268463444604563, 'macro avg': {'precision': 0.3608916909225224, 'recall': 0.3504051289787047, 'f1-score': 0.3040260233237159, 'support': 489914}, 'weighted avg': {'precision': 0.36199154861557903, 'recall': 0.34268463444604563, 'f1-score': 0.3017146337607275, 'support': 489914}}
[[ 18725 110088  33214]
 [ 14983 108535  31344]
 [ 16649 115750  40626]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016749
{'0': {'precision': 0.388224523659667, 'recall': 0.10919068539886384, 'f1-score': 0.1704431270096463, 'support': 62139}, '1': {'precision': 0.33796551452641527, 'recall': 0.7124954353816021, 'f1-score': 0.45846328021532023, 'support': 60246}, '2': {'precision': 0.36343144367291946, 'recall': 0.23109492899271805, 'f1-score': 0.282534694946321, 'support': 60698}, 'accuracy': 0.348131721678146, 'macro avg': {'precision': 0.36320716061966724, 'recall': 0.35092701659106135, 'f1-score': 0.3038137007237625, 'support': 183083}, 'weighted avg': {'precision': 0.36346638318088154, 'recall': 0.348131721678146, 'f1-score': 0.30238217181800814, 'support': 183083}}
[[ 6785 42692 12662]
 [ 5414 42925 11907]
 [ 5278 41393 14027]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065402
{'0': {'precision': 0.3880709701774254, 'recall': 0.10817067396222445, 'f1-score': 0.16918329561818554, 'support': 19007}, '1': {'precision': 0.31580811245198726, 'recall': 0.6894439488551888, 'f1-score': 0.4331888498617443, 'support': 16815}, '2': {'precision': 0.37281568751482563, 'recall': 0.25037170773152084, 'f1-score': 0.2995647892245624, 'support': 18832}, 'accuracy': 0.33600468401214917, 'macro avg': {'precision': 0.3588982567147461, 'recall': 0.3493287768496447, 'f1-score': 0.3006456449014974, 'support': 54654}, 'weighted avg': {'precision': 0.3605819037640738, 'recall': 0.33600468401214917, 'f1-score': 0.29533321478605484, 'support': 54654}}
[[ 2056 12716  4235]
 [ 1525 11593  3697]
 [ 1717 12400  4715]]
training model: results/PCAR/W2/deepOF_L2/h300
Epoch 1/50
716/716 - 26s - loss: 3.3208 - accuracy300: 0.3542 - val_loss: 3.3089 - val_accuracy300: 0.3448 - 26s/epoch - 36ms/step
Epoch 2/50
716/716 - 22s - loss: 3.2882 - accuracy300: 0.3664 - val_loss: 3.3043 - val_accuracy300: 0.3478 - 22s/epoch - 31ms/step
Epoch 3/50
716/716 - 22s - loss: 3.2732 - accuracy300: 0.3757 - val_loss: 3.3092 - val_accuracy300: 0.3485 - 22s/epoch - 30ms/step
Epoch 4/50
716/716 - 22s - loss: 3.2642 - accuracy300: 0.3822 - val_loss: 3.3208 - val_accuracy300: 0.3474 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 21s - loss: 3.2567 - accuracy300: 0.3871 - val_loss: 3.3275 - val_accuracy300: 0.3488 - 21s/epoch - 30ms/step
Epoch 6/50
716/716 - 22s - loss: 3.2543 - accuracy300: 0.3880 - val_loss: 3.3305 - val_accuracy300: 0.3490 - 22s/epoch - 30ms/step
Epoch 7/50
716/716 - 22s - loss: 3.2529 - accuracy300: 0.3890 - val_loss: 3.3307 - val_accuracy300: 0.3495 - 22s/epoch - 30ms/step
Epoch 8/50
716/716 - 22s - loss: 3.2496 - accuracy300: 0.3911 - val_loss: 3.3344 - val_accuracy300: 0.3492 - 22s/epoch - 31ms/step
Epoch 9/50
716/716 - 22s - loss: 3.2481 - accuracy300: 0.3919 - val_loss: 3.3472 - val_accuracy300: 0.3487 - 22s/epoch - 31ms/step
Epoch 10/50
716/716 - 21s - loss: 3.2460 - accuracy300: 0.3946 - val_loss: 3.3440 - val_accuracy300: 0.3505 - 21s/epoch - 30ms/step
Epoch 11/50
716/716 - 22s - loss: 3.2439 - accuracy300: 0.3944 - val_loss: 3.3530 - val_accuracy300: 0.3485 - 22s/epoch - 30ms/step
Epoch 12/50
716/716 - 22s - loss: 3.2412 - accuracy300: 0.3966 - val_loss: 3.3543 - val_accuracy300: 0.3480 - 22s/epoch - 31ms/step
testing model: results/PCAR/W2/deepOF_L2/h300
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095922
{'0': {'precision': 0.32855780635858317, 'recall': 0.09489551216169921, 'f1-score': 0.14725902452753484, 'support': 148869}, '1': {'precision': 0.3811586613985814, 'recall': 0.7163538154429403, 'f1-score': 0.49756967167749944, 'support': 178839}, '2': {'precision': 0.3578358377329543, 'recall': 0.24444225244442253, 'f1-score': 0.290464486778921, 'support': 162206}, 'accuracy': 0.37126720199871815, 'macro avg': {'precision': 0.35585076849670627, 'recall': 0.35189719334968733, 'f1-score': 0.3117643943279851, 'support': 489914}, 'weighted avg': {'precision': 0.35745299341510633, 'recall': 0.37126720199871815, 'f1-score': 0.32255099625236994, 'support': 489914}}
[[ 14127 100388  34354]
 [ 13926 128112  36801]
 [ 14944 107612  39650]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006566
{'0': {'precision': 0.3813631314121414, 'recall': 0.09445046852999725, 'f1-score': 0.15140351787474707, 'support': 61789}, '1': {'precision': 0.348018646148415, 'recall': 0.7137614980829672, 'f1-score': 0.4678978253365551, 'support': 60771}, '2': {'precision': 0.3578100734765779, 'recall': 0.25506005981197233, 'f1-score': 0.2978218509443791, 'support': 60523}, 'accuracy': 0.35311306893594707, 'macro avg': {'precision': 0.3623972836790448, 'recall': 0.3544240088083123, 'f1-score': 0.30570773138522706, 'support': 183083}, 'weighted avg': {'precision': 0.36250895358352797, 'recall': 0.35311306893594707, 'f1-score': 0.30486043266822804, 'support': 183083}}
[[ 5836 41307 14646]
 [ 4335 43376 13060]
 [ 5132 39954 15437]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020596
{'0': {'precision': 0.366751269035533, 'recall': 0.11094658330591203, 'f1-score': 0.17035789473684212, 'support': 18234}, '1': {'precision': 0.3439580277558389, 'recall': 0.6808867050086549, 'f1-score': 0.45703791158336615, 'support': 17909}, '2': {'precision': 0.35905304690925033, 'recall': 0.2654637782939874, 'f1-score': 0.30524583035686553, 'support': 18511}, 'accuracy': 0.350038423537161, 'macro avg': {'precision': 0.3565874479002074, 'recall': 0.3524323555361848, 'f1-score': 0.3108805455590246, 'support': 54654}, 'weighted avg': {'precision': 0.3566750450106188, 'recall': 0.350038423537161, 'f1-score': 0.3099828626800238, 'support': 54654}}
[[ 2023 11540  4671]
 [ 1614 12194  4101]
 [ 1879 11718  4914]]
training model: results/PCAR/W2/deepOF_L2/h500
Epoch 1/50
716/716 - 25s - loss: 3.3050 - accuracy500: 0.3653 - val_loss: 3.3410 - val_accuracy500: 0.3385 - 25s/epoch - 35ms/step
Epoch 2/50
716/716 - 21s - loss: 3.2516 - accuracy500: 0.3895 - val_loss: 3.4389 - val_accuracy500: 0.3142 - 21s/epoch - 30ms/step
Epoch 3/50
716/716 - 21s - loss: 3.2275 - accuracy500: 0.4035 - val_loss: 3.4552 - val_accuracy500: 0.3159 - 21s/epoch - 30ms/step
Epoch 4/50
716/716 - 22s - loss: 3.2199 - accuracy500: 0.4063 - val_loss: 3.4858 - val_accuracy500: 0.3080 - 22s/epoch - 30ms/step
Epoch 5/50
716/716 - 22s - loss: 3.2137 - accuracy500: 0.4092 - val_loss: 3.4803 - val_accuracy500: 0.3115 - 22s/epoch - 30ms/step
Epoch 6/50
716/716 - 21s - loss: 3.2099 - accuracy500: 0.4118 - val_loss: 3.4684 - val_accuracy500: 0.3127 - 21s/epoch - 30ms/step
Epoch 7/50
716/716 - 22s - loss: 3.2068 - accuracy500: 0.4144 - val_loss: 3.4755 - val_accuracy500: 0.3114 - 22s/epoch - 30ms/step
Epoch 8/50
716/716 - 22s - loss: 3.2044 - accuracy500: 0.4145 - val_loss: 3.4718 - val_accuracy500: 0.3102 - 22s/epoch - 30ms/step
Epoch 9/50
716/716 - 22s - loss: 3.2030 - accuracy500: 0.4161 - val_loss: 3.4640 - val_accuracy500: 0.3115 - 22s/epoch - 31ms/step
Epoch 10/50
716/716 - 21s - loss: 3.1999 - accuracy500: 0.4180 - val_loss: 3.4625 - val_accuracy500: 0.3101 - 21s/epoch - 30ms/step
Epoch 11/50
716/716 - 22s - loss: 3.1967 - accuracy500: 0.4196 - val_loss: 3.4598 - val_accuracy500: 0.3083 - 22s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h500
Evaluating performance on  test set...
1914/1914 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059747
{'0': {'precision': 0.3505291279226293, 'recall': 0.10344701136780345, 'f1-score': 0.15974932399590386, 'support': 163620}, '1': {'precision': 0.324896928016281, 'recall': 0.6194573041826112, 'f1-score': 0.4262378846919587, 'support': 149476}, '2': {'precision': 0.3816333827059605, 'recall': 0.338065129115814, 'f1-score': 0.358530514319988, 'support': 176818}, 'accuracy': 0.3455626905946758, 'macro avg': {'precision': 0.35235314621495695, 'recall': 0.3536564815554096, 'f1-score': 0.31483924100261684, 'support': 489914}, 'weighted avg': {'precision': 0.35393461012782806, 'recall': 0.3455626905946758, 'f1-score': 0.3128001382394801, 'support': 489914}}
[[16926 93444 53250]
 [13276 92594 43606]
 [18085 98957 59776]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994892
{'0': {'precision': 0.37369420702754036, 'recall': 0.10394069965165999, 'f1-score': 0.16264321049844357, 'support': 60573}, '1': {'precision': 0.3777875385474145, 'recall': 0.6492270918840717, 'f1-score': 0.4776366328844463, 'support': 63591}, '2': {'precision': 0.3468588685605928, 'recall': 0.33529082299428026, 'f1-score': 0.3409767590379122, 'support': 58919}, 'accuracy': 0.36778947253431504, 'macro avg': {'precision': 0.36611353804518254, 'recall': 0.3628195381766706, 'f1-score': 0.32708553414026736, 'support': 183083}, 'weighted avg': {'precision': 0.36647992573187793, 'recall': 0.36778947253431504, 'f1-score': 0.32944177218546666, 'support': 183083}}
[[ 6296 34459 19818]
 [ 4925 41285 17381]
 [ 5627 33537 19755]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10848
{'0': {'precision': 0.38191724842499575, 'recall': 0.11633817427385892, 'f1-score': 0.1783485071363257, 'support': 19280}, '1': {'precision': 0.3041750178346978, 'recall': 0.580335731414868, 'f1-score': 0.3991441180403869, 'support': 15429}, '2': {'precision': 0.37675765095119934, 'recall': 0.36540486337427924, 'f1-score': 0.37099442592074117, 'support': 19945}, 'accuracy': 0.33821861162952394, 'macro avg': {'precision': 0.3542833057369643, 'recall': 0.35402625635433543, 'f1-score': 0.3161623503658179, 'support': 54654}, 'weighted avg': {'precision': 0.35808746382748086, 'recall': 0.33821861162952394, 'f1-score': 0.3109825015519938, 'support': 54654}}
[[ 2243  9974  7063]
 [ 1482  8954  4993]
 [ 2148 10509  7288]]
training model: results/PCAR/W2/deepOF_L2/h1000
Epoch 1/50
716/716 - 25s - loss: 3.3161 - accuracy1000: 0.3621 - val_loss: 3.3170 - val_accuracy1000: 0.3493 - 25s/epoch - 35ms/step
Epoch 2/50
716/716 - 21s - loss: 3.2690 - accuracy1000: 0.3794 - val_loss: 3.3326 - val_accuracy1000: 0.3387 - 21s/epoch - 30ms/step
Epoch 3/50
716/716 - 22s - loss: 3.2501 - accuracy1000: 0.3892 - val_loss: 3.3459 - val_accuracy1000: 0.3328 - 22s/epoch - 30ms/step
Epoch 4/50
716/716 - 21s - loss: 3.2415 - accuracy1000: 0.3928 - val_loss: 3.3525 - val_accuracy1000: 0.3284 - 21s/epoch - 30ms/step
Epoch 5/50
716/716 - 21s - loss: 3.2344 - accuracy1000: 0.3964 - val_loss: 3.3561 - val_accuracy1000: 0.3285 - 21s/epoch - 29ms/step
Epoch 6/50
716/716 - 21s - loss: 3.2307 - accuracy1000: 0.3994 - val_loss: 3.3567 - val_accuracy1000: 0.3289 - 21s/epoch - 30ms/step
Epoch 7/50
716/716 - 22s - loss: 3.2273 - accuracy1000: 0.4021 - val_loss: 3.3711 - val_accuracy1000: 0.3252 - 22s/epoch - 30ms/step
Epoch 8/50
716/716 - 22s - loss: 3.2239 - accuracy1000: 0.4039 - val_loss: 3.3624 - val_accuracy1000: 0.3284 - 22s/epoch - 31ms/step
Epoch 9/50
716/716 - 22s - loss: 3.2204 - accuracy1000: 0.4061 - val_loss: 3.3661 - val_accuracy1000: 0.3291 - 22s/epoch - 30ms/step
Epoch 10/50
716/716 - 23s - loss: 3.2188 - accuracy1000: 0.4070 - val_loss: 3.3637 - val_accuracy1000: 0.3295 - 23s/epoch - 32ms/step
Epoch 11/50
716/716 - 21s - loss: 3.2160 - accuracy1000: 0.4093 - val_loss: 3.3785 - val_accuracy1000: 0.3242 - 21s/epoch - 30ms/step
testing model: results/PCAR/W2/deepOF_L2/h1000
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067829
{'0': {'precision': 0.33783783783783783, 'recall': 0.1135690302192376, 'f1-score': 0.16999260901699925, 'support': 162016}, '1': {'precision': 0.3311462277196563, 'recall': 0.2251567596309097, 'f1-score': 0.2680546870778233, 'support': 154217}, '2': {'precision': 0.35567298763131705, 'recall': 0.6770055446479465, 'f1-score': 0.46634567715170716, 'support': 173681}, 'accuracy': 0.348440746743306, 'macro avg': {'precision': 0.341552351062937, 'recall': 0.3385771114993646, 'f1-score': 0.3014643244155099, 'support': 489914}, 'weighted avg': {'precision': 0.3420542240070138, 'recall': 0.348440746743306, 'f1-score': 0.3059220511619682, 'support': 489914}}
[[ 18400  34131 109485]
 [ 15969  34723 103525]
 [ 20095  36003 117583]]
Evaluating performance on  train set...
716/716 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1071124
{'0': {'precision': 0.3763941011681379, 'recall': 0.1140126164782734, 'f1-score': 0.17501259569657276, 'support': 62458}, '1': {'precision': 0.36954736734065485, 'recall': 0.23067189877472571, 'f1-score': 0.2840435078446261, 'support': 62435}, '2': {'precision': 0.32016422774618186, 'recall': 0.6888125107406771, 'f1-score': 0.43714214044998967, 'support': 58190}, 'accuracy': 0.33648673006232144, 'macro avg': {'precision': 0.3553685654183249, 'recall': 0.34449900866455874, 'f1-score': 0.29873274799706284, 'support': 183083}, 'weighted avg': {'precision': 0.3561874617699276, 'recall': 0.33648673006232144, 'f1-score': 0.2955080169490377, 'support': 183083}}
[[ 7121 12707 42630]
 [ 5553 14402 42480]
 [ 6245 11863 40082]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1059973
{'0': {'precision': 0.36212772262557413, 'recall': 0.13114402232238678, 'f1-score': 0.19255465826275361, 'support': 18636}, '1': {'precision': 0.3141193595342067, 'recall': 0.19543560949103422, 'f1-score': 0.24095578383206787, 'support': 16563}, '2': {'precision': 0.35723404255319147, 'recall': 0.6904137753790799, 'f1-score': 0.47084392253089125, 'support': 19455}, 'accuracy': 0.34970907893292347, 'macro avg': {'precision': 0.3444937082376574, 'recall': 0.33899780239750027, 'f1-score': 0.30145145487523756, 'support': 54654}, 'weighted avg': {'precision': 0.3458367089085448, 'recall': 0.34970907893292347, 'f1-score': 0.3062844031879406, 'support': 54654}}
[[ 2444  3479 12713]
 [ 1871  3237 11455]
 [ 2434  3589 13432]]
training model: results/PCAR/W2/deepVOL_L2/h10
Epoch 1/50
716/716 - 28s - loss: 3.1084 - accuracy10: 0.4527 - val_loss: 3.2441 - val_accuracy10: 0.4664 - 28s/epoch - 40ms/step
Epoch 2/50
716/716 - 26s - loss: 2.9122 - accuracy10: 0.5203 - val_loss: 3.2336 - val_accuracy10: 0.4812 - 26s/epoch - 36ms/step
Epoch 3/50
716/716 - 25s - loss: 2.8665 - accuracy10: 0.5331 - val_loss: 3.2280 - val_accuracy10: 0.4814 - 25s/epoch - 35ms/step
Epoch 4/50
716/716 - 23s - loss: 2.8436 - accuracy10: 0.5393 - val_loss: 3.1959 - val_accuracy10: 0.4869 - 23s/epoch - 33ms/step
Epoch 5/50
716/716 - 24s - loss: 2.8240 - accuracy10: 0.5437 - val_loss: 3.2015 - val_accuracy10: 0.4858 - 24s/epoch - 33ms/step
Epoch 6/50
716/716 - 26s - loss: 2.8104 - accuracy10: 0.5476 - val_loss: 3.1760 - val_accuracy10: 0.4924 - 26s/epoch - 36ms/step
Epoch 7/50
716/716 - 27s - loss: 2.7964 - accuracy10: 0.5498 - val_loss: 3.1321 - val_accuracy10: 0.4972 - 27s/epoch - 38ms/step
Epoch 8/50
716/716 - 24s - loss: 2.7862 - accuracy10: 0.5530 - val_loss: 3.1451 - val_accuracy10: 0.4972 - 24s/epoch - 33ms/step
Epoch 9/50
716/716 - 27s - loss: 2.7724 - accuracy10: 0.5563 - val_loss: 3.1116 - val_accuracy10: 0.5041 - 27s/epoch - 38ms/step
Epoch 10/50
716/716 - 26s - loss: 2.7641 - accuracy10: 0.5592 - val_loss: 3.0911 - val_accuracy10: 0.5048 - 26s/epoch - 37ms/step
Epoch 11/50
716/716 - 24s - loss: 2.7561 - accuracy10: 0.5604 - val_loss: 3.1045 - val_accuracy10: 0.5047 - 24s/epoch - 34ms/step
Epoch 12/50
716/716 - 24s - loss: 2.7474 - accuracy10: 0.5621 - val_loss: 3.0973 - val_accuracy10: 0.5070 - 24s/epoch - 34ms/step
Epoch 13/50
716/716 - 26s - loss: 2.7392 - accuracy10: 0.5637 - val_loss: 3.0904 - val_accuracy10: 0.5077 - 26s/epoch - 36ms/step
Epoch 14/50
716/716 - 24s - loss: 2.7306 - accuracy10: 0.5655 - val_loss: 3.0960 - val_accuracy10: 0.5081 - 24s/epoch - 34ms/step
Epoch 15/50
716/716 - 26s - loss: 2.7249 - accuracy10: 0.5670 - val_loss: 3.0848 - val_accuracy10: 0.5095 - 26s/epoch - 36ms/step
Epoch 16/50
716/716 - 25s - loss: 2.7182 - accuracy10: 0.5678 - val_loss: 3.0812 - val_accuracy10: 0.5103 - 25s/epoch - 34ms/step
Epoch 17/50
716/716 - 25s - loss: 2.7108 - accuracy10: 0.5695 - val_loss: 3.0698 - val_accuracy10: 0.5114 - 25s/epoch - 35ms/step
Epoch 18/50
716/716 - 26s - loss: 2.7071 - accuracy10: 0.5702 - val_loss: 3.0843 - val_accuracy10: 0.5105 - 26s/epoch - 36ms/step
Epoch 19/50
716/716 - 27s - loss: 2.6997 - accuracy10: 0.5725 - val_loss: 3.0803 - val_accuracy10: 0.5118 - 27s/epoch - 38ms/step
Epoch 20/50
716/716 - 27s - loss: 2.6957 - accuracy10: 0.5726 - val_loss: 3.0831 - val_accuracy10: 0.5116 - 27s/epoch - 38ms/step
Epoch 21/50
716/716 - 26s - loss: 2.6920 - accuracy10: 0.5734 - val_loss: 3.0692 - val_accuracy10: 0.5117 - 26s/epoch - 36ms/step
Epoch 22/50
716/716 - 25s - loss: 2.6865 - accuracy10: 0.5751 - val_loss: 3.0802 - val_accuracy10: 0.5141 - 25s/epoch - 35ms/step
Epoch 23/50
716/716 - 27s - loss: 2.6813 - accuracy10: 0.5758 - val_loss: 3.0706 - val_accuracy10: 0.5121 - 27s/epoch - 37ms/step
Epoch 24/50
716/716 - 26s - loss: 2.6761 - accuracy10: 0.5772 - val_loss: 3.0841 - val_accuracy10: 0.5116 - 26s/epoch - 36ms/step
Epoch 25/50
716/716 - 24s - loss: 2.6724 - accuracy10: 0.5778 - val_loss: 3.0716 - val_accuracy10: 0.5124 - 24s/epoch - 34ms/step
Epoch 26/50
716/716 - 26s - loss: 2.6685 - accuracy10: 0.5780 - val_loss: 3.0850 - val_accuracy10: 0.5120 - 26s/epoch - 36ms/step
Epoch 27/50
716/716 - 26s - loss: 2.6638 - accuracy10: 0.5799 - val_loss: 3.0803 - val_accuracy10: 0.5130 - 26s/epoch - 36ms/step
Epoch 28/50
716/716 - 26s - loss: 2.6585 - accuracy10: 0.5810 - val_loss: 3.0846 - val_accuracy10: 0.5106 - 26s/epoch - 36ms/step
Epoch 29/50
716/716 - 26s - loss: 2.6559 - accuracy10: 0.5820 - val_loss: 3.1033 - val_accuracy10: 0.5119 - 26s/epoch - 37ms/step
Epoch 30/50
716/716 - 25s - loss: 2.6509 - accuracy10: 0.5824 - val_loss: 3.0822 - val_accuracy10: 0.5110 - 25s/epoch - 36ms/step
Epoch 31/50
716/716 - 24s - loss: 2.6471 - accuracy10: 0.5831 - val_loss: 3.0880 - val_accuracy10: 0.5113 - 24s/epoch - 34ms/step
testing model: results/PCAR/W2/deepVOL_L2/h10
Evaluating performance on  test set...
1914/1914 - 36s - 36s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99572366
{'0': {'precision': 0.5055498913106208, 'recall': 0.5179447762076509, 'f1-score': 0.511672280524133, 'support': 152217}, '1': {'precision': 0.6046261430876816, 'recall': 0.5136941798359121, 'f1-score': 0.5554632681069462, 'support': 181610}, '2': {'precision': 0.48877126780317576, 'recall': 0.5626105117494811, 'f1-score': 0.5230980000893483, 'support': 156092}, 'accuracy': 0.5305999563193099, 'macro avg': {'precision': 0.5329824340671594, 'recall': 0.531416489264348, 'f1-score': 0.5300778495734758, 'support': 489919}, 'weighted avg': {'precision': 0.5369310567373706, 'recall': 0.5305999563193099, 'f1-score': 0.5315456568848952, 'support': 489919}}
[[78840 30800 42577]
 [39041 93292 49277]
 [38068 30205 87819]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9249713
{'0': {'precision': 0.5286199419009042, 'recall': 0.489310534189248, 'f1-score': 0.508206232606622, 'support': 52809}, '1': {'precision': 0.6421494966688387, 'recall': 0.6318978264567712, 'f1-score': 0.6369824163357912, 'support': 76419}, '2': {'precision': 0.4940510491169791, 'recall': 0.5412682202209637, 'f1-score': 0.5165829323834588, 'support': 53855}, 'accuracy': 0.5641102669281146, 'macro avg': {'precision': 0.5549401625622407, 'recall': 0.5541588602889943, 'f1-score': 0.5539238604419573, 'support': 183083}, 'weighted avg': {'precision': 0.5658386204507013, 'recall': 0.5641102669281146, 'f1-score': 0.5644215794759704, 'support': 183083}}
[[25840 13027 13942]
 [12220 48289 15910]
 [10822 13883 29150]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0159342
{'0': {'precision': 0.512753884499125, 'recall': 0.5318481848184818, 'f1-score': 0.5221265221265221, 'support': 18180}, '1': {'precision': 0.5507797878976918, 'recall': 0.4803068218909803, 'f1-score': 0.5131349529233987, 'support': 18382}, '2': {'precision': 0.4847978954823696, 'recall': 0.5296816272385585, 'f1-score': 0.5062468633614201, 'support': 18092}, 'accuracy': 0.5137958795330625, 'macro avg': {'precision': 0.5161105226263955, 'recall': 0.5139455446493403, 'f1-score': 0.5138361128037804, 'support': 54654}, 'weighted avg': {'precision': 0.5162890768543289, 'recall': 0.5137958795330625, 'f1-score': 0.5138457410040053, 'support': 54654}}
[[9669 3473 5038]
 [4407 8829 5146]
 [4781 3728 9583]]
training model: results/PCAR/W2/deepVOL_L2/h20
Epoch 1/50
716/716 - 29s - loss: 3.1738 - accuracy20: 0.4295 - val_loss: 3.2306 - val_accuracy20: 0.4197 - 29s/epoch - 40ms/step
Epoch 2/50
716/716 - 26s - loss: 3.0107 - accuracy20: 0.4840 - val_loss: 3.1984 - val_accuracy20: 0.4322 - 26s/epoch - 36ms/step
Epoch 3/50
716/716 - 26s - loss: 2.9529 - accuracy20: 0.5040 - val_loss: 3.1787 - val_accuracy20: 0.4429 - 26s/epoch - 36ms/step
Epoch 4/50
716/716 - 25s - loss: 2.9250 - accuracy20: 0.5117 - val_loss: 3.1325 - val_accuracy20: 0.4535 - 25s/epoch - 35ms/step
Epoch 5/50
716/716 - 24s - loss: 2.9089 - accuracy20: 0.5152 - val_loss: 3.1232 - val_accuracy20: 0.4580 - 24s/epoch - 34ms/step
Epoch 6/50
716/716 - 24s - loss: 2.8970 - accuracy20: 0.5194 - val_loss: 3.1260 - val_accuracy20: 0.4600 - 24s/epoch - 34ms/step
Epoch 7/50
716/716 - 25s - loss: 2.8869 - accuracy20: 0.5213 - val_loss: 3.1081 - val_accuracy20: 0.4647 - 25s/epoch - 35ms/step
Epoch 8/50
716/716 - 26s - loss: 2.8775 - accuracy20: 0.5233 - val_loss: 3.1123 - val_accuracy20: 0.4664 - 26s/epoch - 36ms/step
Epoch 9/50
716/716 - 25s - loss: 2.8689 - accuracy20: 0.5270 - val_loss: 3.0985 - val_accuracy20: 0.4688 - 25s/epoch - 35ms/step
Epoch 10/50
716/716 - 24s - loss: 2.8603 - accuracy20: 0.5293 - val_loss: 3.1011 - val_accuracy20: 0.4687 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 27s - loss: 2.8537 - accuracy20: 0.5315 - val_loss: 3.0898 - val_accuracy20: 0.4677 - 27s/epoch - 37ms/step
Epoch 12/50
716/716 - 25s - loss: 2.8471 - accuracy20: 0.5333 - val_loss: 3.1049 - val_accuracy20: 0.4707 - 25s/epoch - 34ms/step
Epoch 13/50
716/716 - 26s - loss: 2.8404 - accuracy20: 0.5349 - val_loss: 3.0967 - val_accuracy20: 0.4702 - 26s/epoch - 37ms/step
Epoch 14/50
716/716 - 24s - loss: 2.8340 - accuracy20: 0.5360 - val_loss: 3.1030 - val_accuracy20: 0.4692 - 24s/epoch - 34ms/step
Epoch 15/50
716/716 - 26s - loss: 2.8282 - accuracy20: 0.5382 - val_loss: 3.0903 - val_accuracy20: 0.4728 - 26s/epoch - 36ms/step
Epoch 16/50
716/716 - 24s - loss: 2.8252 - accuracy20: 0.5386 - val_loss: 3.1109 - val_accuracy20: 0.4675 - 24s/epoch - 33ms/step
Epoch 17/50
716/716 - 23s - loss: 2.8182 - accuracy20: 0.5414 - val_loss: 3.0993 - val_accuracy20: 0.4731 - 23s/epoch - 32ms/step
Epoch 18/50
716/716 - 24s - loss: 2.8129 - accuracy20: 0.5421 - val_loss: 3.0957 - val_accuracy20: 0.4732 - 24s/epoch - 34ms/step
Epoch 19/50
716/716 - 26s - loss: 2.8101 - accuracy20: 0.5425 - val_loss: 3.1005 - val_accuracy20: 0.4723 - 26s/epoch - 36ms/step
Epoch 20/50
716/716 - 25s - loss: 2.8033 - accuracy20: 0.5449 - val_loss: 3.0753 - val_accuracy20: 0.4779 - 25s/epoch - 34ms/step
Epoch 21/50
716/716 - 25s - loss: 2.7985 - accuracy20: 0.5455 - val_loss: 3.0949 - val_accuracy20: 0.4755 - 25s/epoch - 34ms/step
Epoch 22/50
716/716 - 25s - loss: 2.7938 - accuracy20: 0.5464 - val_loss: 3.0955 - val_accuracy20: 0.4760 - 25s/epoch - 36ms/step
Epoch 23/50
716/716 - 26s - loss: 2.7903 - accuracy20: 0.5480 - val_loss: 3.0862 - val_accuracy20: 0.4774 - 26s/epoch - 36ms/step
Epoch 24/50
716/716 - 25s - loss: 2.7878 - accuracy20: 0.5483 - val_loss: 3.0903 - val_accuracy20: 0.4767 - 25s/epoch - 34ms/step
Epoch 25/50
716/716 - 25s - loss: 2.7818 - accuracy20: 0.5501 - val_loss: 3.0990 - val_accuracy20: 0.4753 - 25s/epoch - 35ms/step
Epoch 26/50
716/716 - 25s - loss: 2.7789 - accuracy20: 0.5501 - val_loss: 3.0787 - val_accuracy20: 0.4833 - 25s/epoch - 35ms/step
Epoch 27/50
716/716 - 24s - loss: 2.7735 - accuracy20: 0.5518 - val_loss: 3.0888 - val_accuracy20: 0.4812 - 24s/epoch - 33ms/step
Epoch 28/50
716/716 - 25s - loss: 2.7725 - accuracy20: 0.5525 - val_loss: 3.0927 - val_accuracy20: 0.4817 - 25s/epoch - 35ms/step
Epoch 29/50
716/716 - 25s - loss: 2.7682 - accuracy20: 0.5530 - val_loss: 3.0945 - val_accuracy20: 0.4811 - 25s/epoch - 35ms/step
Epoch 30/50
716/716 - 25s - loss: 2.7643 - accuracy20: 0.5543 - val_loss: 3.0954 - val_accuracy20: 0.4811 - 25s/epoch - 34ms/step
testing model: results/PCAR/W2/deepVOL_L2/h20
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090835
{'0': {'precision': 0.5393824768009541, 'recall': 0.34036886571148045, 'f1-score': 0.4173656644594317, 'support': 170089}, '1': {'precision': 0.4780387352396841, 'recall': 0.5134457898789109, 'f1-score': 0.4951100492032316, 'support': 142870}, '2': {'precision': 0.48636829816483734, 'recall': 0.6297694394213381, 'f1-score': 0.5488567945923983, 'support': 176960}, 'accuracy': 0.49537372504434407, 'macro avg': {'precision': 0.5012631700684919, 'recall': 0.4945280316705765, 'f1-score': 0.48711083608502054, 'support': 489919}, 'weighted avg': {'precision': 0.50234457990717, 'recall': 0.49537372504434407, 'f1-score': 0.48753238719661174, 'support': 489919}}
[[ 57893  42065  70131]
 [ 21954  73356  47560]
 [ 27485  38031 111444]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9640446
{'0': {'precision': 0.567171057684922, 'recall': 0.36456396162138144, 'f1-score': 0.4438389100380686, 'support': 60763}, '1': {'precision': 0.5242685400754264, 'recall': 0.6334534208491668, 'f1-score': 0.5737123616263652, 'support': 60789}, '2': {'precision': 0.4952604956288876, 'recall': 0.5680713786546618, 'f1-score': 0.5291731007963182, 'support': 61531}, 'accuracy': 0.5222385475440101, 'macro avg': {'precision': 0.5289000311297454, 'recall': 0.5220295870417367, 'f1-score': 0.5155747908202506, 'support': 183083}, 'weighted avg': {'precision': 0.5287582616479689, 'recall': 0.5222385475440101, 'f1-score': 0.5156400895039219, 'support': 183083}}
[[22152 17683 20928]
 [ 7587 38507 14695]
 [ 9318 17259 34954]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0259521
{'0': {'precision': 0.5390417355075067, 'recall': 0.3692731656906648, 'f1-score': 0.43829215583201914, 'support': 20321}, '1': {'precision': 0.41063203684749233, 'recall': 0.46296429859358096, 'f1-score': 0.4352307014272638, 'support': 13865}, '2': {'precision': 0.48141508306441977, 'recall': 0.5903849912057847, 'f1-score': 0.5303605521297373, 'support': 20468}, 'accuracy': 0.47584806235591176, 'macro avg': {'precision': 0.47702961847313957, 'recall': 0.47420748516334355, 'f1-score': 0.46796113646300674, 'support': 54654}, 'weighted avg': {'precision': 0.48488462360121987, 'recall': 0.47584806235591176, 'f1-score': 0.4719952492945244, 'support': 54654}}
[[ 7504  4606  8211]
 [ 2640  6419  4806]
 [ 3777  4607 12084]]
training model: results/PCAR/W2/deepVOL_L2/h30
Epoch 1/50
716/716 - 29s - loss: 3.1984 - accuracy30: 0.4210 - val_loss: 3.2770 - val_accuracy30: 0.3994 - 29s/epoch - 40ms/step
Epoch 2/50
716/716 - 24s - loss: 3.0838 - accuracy30: 0.4626 - val_loss: 3.2218 - val_accuracy30: 0.4247 - 24s/epoch - 34ms/step
Epoch 3/50
716/716 - 25s - loss: 3.0392 - accuracy30: 0.4787 - val_loss: 3.2137 - val_accuracy30: 0.4306 - 25s/epoch - 35ms/step
Epoch 4/50
716/716 - 25s - loss: 3.0170 - accuracy30: 0.4861 - val_loss: 3.1981 - val_accuracy30: 0.4363 - 25s/epoch - 35ms/step
Epoch 5/50
716/716 - 25s - loss: 3.0065 - accuracy30: 0.4896 - val_loss: 3.2068 - val_accuracy30: 0.4339 - 25s/epoch - 35ms/step
Epoch 6/50
716/716 - 27s - loss: 2.9961 - accuracy30: 0.4927 - val_loss: 3.2122 - val_accuracy30: 0.4354 - 27s/epoch - 37ms/step
Epoch 7/50
716/716 - 26s - loss: 2.9891 - accuracy30: 0.4949 - val_loss: 3.1947 - val_accuracy30: 0.4391 - 26s/epoch - 36ms/step
Epoch 8/50
716/716 - 26s - loss: 2.9810 - accuracy30: 0.4975 - val_loss: 3.1978 - val_accuracy30: 0.4394 - 26s/epoch - 37ms/step
Epoch 9/50
716/716 - 24s - loss: 2.9764 - accuracy30: 0.4989 - val_loss: 3.1977 - val_accuracy30: 0.4409 - 24s/epoch - 34ms/step
Epoch 10/50
716/716 - 24s - loss: 2.9710 - accuracy30: 0.4998 - val_loss: 3.2024 - val_accuracy30: 0.4399 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 25s - loss: 2.9666 - accuracy30: 0.5021 - val_loss: 3.2049 - val_accuracy30: 0.4412 - 25s/epoch - 35ms/step
Epoch 12/50
716/716 - 25s - loss: 2.9631 - accuracy30: 0.5023 - val_loss: 3.2023 - val_accuracy30: 0.4399 - 25s/epoch - 34ms/step
Epoch 13/50
716/716 - 26s - loss: 2.9582 - accuracy30: 0.5037 - val_loss: 3.2010 - val_accuracy30: 0.4410 - 26s/epoch - 36ms/step
Epoch 14/50
716/716 - 24s - loss: 2.9534 - accuracy30: 0.5052 - val_loss: 3.2052 - val_accuracy30: 0.4384 - 24s/epoch - 33ms/step
Epoch 15/50
716/716 - 25s - loss: 2.9491 - accuracy30: 0.5072 - val_loss: 3.2052 - val_accuracy30: 0.4414 - 25s/epoch - 35ms/step
Epoch 16/50
716/716 - 26s - loss: 2.9465 - accuracy30: 0.5081 - val_loss: 3.1977 - val_accuracy30: 0.4422 - 26s/epoch - 36ms/step
Epoch 17/50
716/716 - 26s - loss: 2.9412 - accuracy30: 0.5091 - val_loss: 3.2014 - val_accuracy30: 0.4420 - 26s/epoch - 37ms/step
testing model: results/PCAR/W2/deepVOL_L2/h30
Evaluating performance on  test set...
1914/1914 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0487595
{'0': {'precision': 0.48074065317977643, 'recall': 0.34013967131242046, 'f1-score': 0.3983990427843221, 'support': 167393}, '1': {'precision': 0.441106276371308, 'recall': 0.4552332741387874, 'f1-score': 0.44805844910313974, 'support': 146973}, '2': {'precision': 0.45624945974349757, 'recall': 0.5712519865795515, 'f1-score': 0.5073149262942765, 'support': 175553}, 'accuracy': 0.4574817469826645, 'macro avg': {'precision': 0.45936546309819404, 'recall': 0.4555416440102531, 'f1-score': 0.4512574727272461, 'support': 489919}, 'weighted avg': {'precision': 0.46007461298947944, 'recall': 0.4574817469826645, 'f1-score': 0.45232449173143097, 'support': 489919}}
[[ 56937  44892  65564]
 [ 26112  66907  53954]
 [ 35387  39881 100285]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0168161
{'0': {'precision': 0.5200092291127234, 'recall': 0.3264714876631633, 'f1-score': 0.4011153077972671, 'support': 62131}, '1': {'precision': 0.46876147776637916, 'recall': 0.6251921420246279, 'f1-score': 0.5357923536820162, 'support': 59201}, '2': {'precision': 0.46029576621262613, 'recall': 0.48540104613690466, 'f1-score': 0.4725151730117443, 'support': 61751}, 'accuracy': 0.4766690517415598, 'macro avg': {'precision': 0.4830221576972429, 'recall': 0.479021558608232, 'f1-score': 0.46980761149700917, 'support': 183083}, 'weighted avg': {'precision': 0.48329755093944227, 'recall': 0.4766690517415598, 'f1-score': 0.46874599371721715, 'support': 183083}}
[[20284 21308 20539]
 [ 7583 37012 14606]
 [11140 20637 29974]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669998
{'0': {'precision': 0.4890658747300216, 'recall': 0.36201039168665067, 'f1-score': 0.416054203031695, 'support': 20016}, '1': {'precision': 0.3684365261362968, 'recall': 0.4332434488003872, 'f1-score': 0.39822052748649506, 'support': 14463}, '2': {'precision': 0.454951600893522, 'recall': 0.5148451053283767, 'f1-score': 0.4830488769008976, 'support': 20175}, 'accuracy': 0.4372781498152011, 'macro avg': {'precision': 0.4374846672532801, 'recall': 0.43669964860513816, 'f1-score': 0.43244120247302925, 'support': 54654}, 'weighted avg': {'precision': 0.4445509674338965, 'recall': 0.4372781498152011, 'f1-score': 0.4360653476121637, 'support': 54654}}
[[ 7246  5414  7356]
 [ 3109  6266  5088]
 [ 4461  5327 10387]]
training model: results/PCAR/W2/deepVOL_L2/h50
Epoch 1/50
716/716 - 26s - loss: 3.2754 - accuracy50: 0.3881 - val_loss: 3.3093 - val_accuracy50: 0.3659 - 26s/epoch - 36ms/step
Epoch 2/50
716/716 - 25s - loss: 3.1983 - accuracy50: 0.4184 - val_loss: 3.2805 - val_accuracy50: 0.3875 - 25s/epoch - 35ms/step
Epoch 3/50
716/716 - 28s - loss: 3.1684 - accuracy50: 0.4330 - val_loss: 3.3312 - val_accuracy50: 0.3635 - 28s/epoch - 39ms/step
Epoch 4/50
716/716 - 24s - loss: 3.1567 - accuracy50: 0.4374 - val_loss: 3.2698 - val_accuracy50: 0.4056 - 24s/epoch - 34ms/step
Epoch 5/50
716/716 - 25s - loss: 3.1445 - accuracy50: 0.4432 - val_loss: 3.2735 - val_accuracy50: 0.4063 - 25s/epoch - 34ms/step
Epoch 6/50
716/716 - 24s - loss: 3.1384 - accuracy50: 0.4460 - val_loss: 3.2600 - val_accuracy50: 0.4112 - 24s/epoch - 34ms/step
Epoch 7/50
716/716 - 24s - loss: 3.1319 - accuracy50: 0.4489 - val_loss: 3.2583 - val_accuracy50: 0.4095 - 24s/epoch - 33ms/step
Epoch 8/50
716/716 - 26s - loss: 3.1256 - accuracy50: 0.4515 - val_loss: 3.2615 - val_accuracy50: 0.4143 - 26s/epoch - 36ms/step
Epoch 9/50
716/716 - 25s - loss: 3.1191 - accuracy50: 0.4537 - val_loss: 3.2772 - val_accuracy50: 0.4080 - 25s/epoch - 35ms/step
Epoch 10/50
716/716 - 27s - loss: 3.1147 - accuracy50: 0.4551 - val_loss: 3.2778 - val_accuracy50: 0.4077 - 27s/epoch - 37ms/step
Epoch 11/50
716/716 - 25s - loss: 3.1117 - accuracy50: 0.4560 - val_loss: 3.2801 - val_accuracy50: 0.4062 - 25s/epoch - 35ms/step
Epoch 12/50
716/716 - 26s - loss: 3.1071 - accuracy50: 0.4573 - val_loss: 3.2732 - val_accuracy50: 0.4051 - 26s/epoch - 36ms/step
Epoch 13/50
716/716 - 25s - loss: 3.1035 - accuracy50: 0.4599 - val_loss: 3.2665 - val_accuracy50: 0.4101 - 25s/epoch - 35ms/step
Epoch 14/50
716/716 - 25s - loss: 3.1004 - accuracy50: 0.4600 - val_loss: 3.2716 - val_accuracy50: 0.4079 - 25s/epoch - 34ms/step
Epoch 15/50
716/716 - 25s - loss: 3.0964 - accuracy50: 0.4617 - val_loss: 3.2673 - val_accuracy50: 0.4108 - 25s/epoch - 35ms/step
Epoch 16/50
716/716 - 24s - loss: 3.0926 - accuracy50: 0.4639 - val_loss: 3.2705 - val_accuracy50: 0.4109 - 24s/epoch - 34ms/step
Epoch 17/50
716/716 - 25s - loss: 3.0891 - accuracy50: 0.4647 - val_loss: 3.2804 - val_accuracy50: 0.4094 - 25s/epoch - 35ms/step
testing model: results/PCAR/W2/deepVOL_L2/h50
Evaluating performance on  test set...
1914/1914 - 36s - 36s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764872
{'0': {'precision': 0.4357978138739619, 'recall': 0.3388992437643204, 'f1-score': 0.3812885258820465, 'support': 168466}, '1': {'precision': 0.38611133952799936, 'recall': 0.26484108406892465, 'f1-score': 0.3141800906642579, 'support': 141836}, '2': {'precision': 0.42719485672131274, 'recall': 0.622235089106265, 'f1-score': 0.5065905176321277, 'support': 179617}, 'accuracy': 0.42133699652391515, 'macro avg': {'precision': 0.41636800337442464, 'recall': 0.40865847231317004, 'f1-score': 0.4006863780594774, 'support': 489919}, 'weighted avg': {'precision': 0.4182590612837963, 'recall': 0.42133699652391515, 'f1-score': 0.4077989813545309, 'support': 489919}}
[[ 57093  31293  80080]
 [ 34493  37564  69779]
 [ 39422  28431 111764]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.063095
{'0': {'precision': 0.4657208765859285, 'recall': 0.32536663980660757, 'f1-score': 0.38309297912713475, 'support': 62050}, '1': {'precision': 0.4394721654630251, 'recall': 0.46468861327351896, 'f1-score': 0.45172875431887966, 'support': 60632}, '2': {'precision': 0.4106344714501071, 'recall': 0.5141140047350209, 'f1-score': 0.4565845482014071, 'support': 60401}, 'accuracy': 0.43377593768946326, 'macro avg': {'precision': 0.43860917116635356, 'recall': 0.43472308593838244, 'f1-score': 0.43046876054914046, 'support': 183083}, 'weighted avg': {'precision': 0.4388544509242744, 'recall': 0.43377593768946326, 'f1-score': 0.4300688785010854, 'support': 183083}}
[[20189 18625 23236]
 [11124 28175 21333]
 [12037 17311 31053]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872997
{'0': {'precision': 0.44505056696291756, 'recall': 0.37019475884572245, 'f1-score': 0.4041860335662, 'support': 19614}, '1': {'precision': 0.33804281875704256, 'recall': 0.25639339951351, 'f1-score': 0.2916105877074922, 'support': 15211}, '2': {'precision': 0.41825236922617715, 'recall': 0.5653336022996621, 'f1-score': 0.4807960369711136, 'support': 19829}, 'accuracy': 0.40932045229992314, 'macro avg': {'precision': 0.4004485849820458, 'recall': 0.39730725355296487, 'f1-score': 0.39219755274826856, 'support': 54654}, 'weighted avg': {'precision': 0.40554611493961845, 'recall': 0.40932045229992314, 'f1-score': 0.4006495065152838, 'support': 54654}}
[[ 7261  3750  8603]
 [ 4322  3900  6989]
 [ 4732  3887 11210]]
training model: results/PCAR/W2/deepVOL_L2/h100
Epoch 1/50
716/716 - 27s - loss: 3.3070 - accuracy100: 0.3669 - val_loss: 3.3018 - val_accuracy100: 0.3488 - 27s/epoch - 38ms/step
Epoch 2/50
716/716 - 25s - loss: 3.2681 - accuracy100: 0.3751 - val_loss: 3.3314 - val_accuracy100: 0.3304 - 25s/epoch - 35ms/step
Epoch 3/50
716/716 - 26s - loss: 3.2446 - accuracy100: 0.3938 - val_loss: 3.3537 - val_accuracy100: 0.3287 - 26s/epoch - 36ms/step
Epoch 4/50
716/716 - 23s - loss: 3.2322 - accuracy100: 0.4012 - val_loss: 3.3402 - val_accuracy100: 0.3570 - 23s/epoch - 33ms/step
Epoch 5/50
716/716 - 24s - loss: 3.2217 - accuracy100: 0.4056 - val_loss: 3.3549 - val_accuracy100: 0.3568 - 24s/epoch - 34ms/step
Epoch 6/50
716/716 - 25s - loss: 3.2120 - accuracy100: 0.4111 - val_loss: 3.3432 - val_accuracy100: 0.3607 - 25s/epoch - 35ms/step
Epoch 7/50
716/716 - 26s - loss: 3.2033 - accuracy100: 0.4146 - val_loss: 3.3301 - val_accuracy100: 0.3622 - 26s/epoch - 36ms/step
Epoch 8/50
716/716 - 24s - loss: 3.1967 - accuracy100: 0.4181 - val_loss: 3.3426 - val_accuracy100: 0.3643 - 24s/epoch - 34ms/step
Epoch 9/50
716/716 - 27s - loss: 3.1927 - accuracy100: 0.4202 - val_loss: 3.3637 - val_accuracy100: 0.3583 - 27s/epoch - 38ms/step
Epoch 10/50
716/716 - 25s - loss: 3.1883 - accuracy100: 0.4227 - val_loss: 3.3192 - val_accuracy100: 0.3630 - 25s/epoch - 35ms/step
Epoch 11/50
716/716 - 26s - loss: 3.1852 - accuracy100: 0.4231 - val_loss: 3.3443 - val_accuracy100: 0.3582 - 26s/epoch - 36ms/step
testing model: results/PCAR/W2/deepVOL_L2/h100
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0996361
{'0': {'precision': 0.35705615915213595, 'recall': 0.14751531903963994, 'f1-score': 0.20877618140903587, 'support': 163522}, '1': {'precision': 0.3192276563764597, 'recall': 0.1796707229778096, 'f1-score': 0.2299300466355763, 'support': 153670}, '2': {'precision': 0.3573961431621069, 'recall': 0.6949637288900983, 'f1-score': 0.472038820443651, 'support': 172727}, 'accuracy': 0.35061101937259015, 'macro avg': {'precision': 0.3445599862302342, 'recall': 0.34071659030251594, 'f1-score': 0.30358168282942105, 'support': 489919}, 'weighted avg': {'precision': 0.34531058161085276, 'recall': 0.35061101937259015, 'f1-score': 0.3082278873479654, 'support': 489919}}
[[ 24122  29589 109811]
 [ 20039  27610 106021]
 [ 23397  29291 120039]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007951
{'0': {'precision': 0.351023306862935, 'recall': 0.17745357224452496, 'f1-score': 0.23573534512660427, 'support': 61278}, '1': {'precision': 0.3564362001124227, 'recall': 0.2060003573575037, 'f1-score': 0.26109961602997644, 'support': 61563}, '2': {'precision': 0.3379274833726668, 'recall': 0.6536469572723349, 'f1-score': 0.44552433429316557, 'support': 60242}, 'accuracy': 0.3437402708061371, 'macro avg': {'precision': 0.3484623301160082, 'recall': 0.3457002956247878, 'f1-score': 0.3141197651499154, 'support': 183083}, 'weighted avg': {'precision': 0.3485343556682171, 'recall': 0.3437402708061371, 'f1-score': 0.3132936596342117, 'support': 183083}}
[[10874 11921 38483]
 [10216 12682 38665]
 [ 9888 10977 39377]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005024
{'0': {'precision': 0.3725177869809918, 'recall': 0.18025795180103799, 'f1-score': 0.24295311309647485, 'support': 19461}, '1': {'precision': 0.29124849458048974, 'recall': 0.18318394142153768, 'f1-score': 0.22490893590637834, 'support': 15842}, '2': {'precision': 0.354803957701358, 'recall': 0.6467366027595474, 'f1-score': 0.4582234915055653, 'support': 19351}, 'accuracy': 0.34626925751088666, 'macro avg': {'precision': 0.3395234130876132, 'recall': 0.33672616532737437, 'f1-score': 0.30869518016947284, 'support': 54654}, 'weighted avg': {'precision': 0.34268925767666003, 'recall': 0.34626925751088666, 'f1-score': 0.31394226736786945, 'support': 54654}}
[[ 3508  3547 12406]
 [ 2588  2902 10352]
 [ 3321  3515 12515]]
training model: results/PCAR/W2/deepVOL_L2/h200
Epoch 1/50
716/716 - 28s - loss: 3.3223 - accuracy200: 0.3569 - val_loss: 3.3340 - val_accuracy200: 0.3233 - 28s/epoch - 40ms/step
Epoch 2/50
716/716 - 25s - loss: 3.2898 - accuracy200: 0.3624 - val_loss: 3.3253 - val_accuracy200: 0.3324 - 25s/epoch - 34ms/step
Epoch 3/50
716/716 - 26s - loss: 3.2738 - accuracy200: 0.3728 - val_loss: 3.3493 - val_accuracy200: 0.3244 - 26s/epoch - 36ms/step
Epoch 4/50
716/716 - 25s - loss: 3.2636 - accuracy200: 0.3810 - val_loss: 3.3493 - val_accuracy200: 0.3332 - 25s/epoch - 35ms/step
Epoch 5/50
716/716 - 26s - loss: 3.2579 - accuracy200: 0.3847 - val_loss: 3.3545 - val_accuracy200: 0.3358 - 26s/epoch - 36ms/step
Epoch 6/50
716/716 - 25s - loss: 3.2537 - accuracy200: 0.3866 - val_loss: 3.3688 - val_accuracy200: 0.3384 - 25s/epoch - 35ms/step
Epoch 7/50
716/716 - 25s - loss: 3.2507 - accuracy200: 0.3890 - val_loss: 3.3744 - val_accuracy200: 0.3416 - 25s/epoch - 35ms/step
Epoch 8/50
716/716 - 24s - loss: 3.2449 - accuracy200: 0.3928 - val_loss: 3.3868 - val_accuracy200: 0.3417 - 24s/epoch - 34ms/step
Epoch 9/50
716/716 - 25s - loss: 3.2394 - accuracy200: 0.3969 - val_loss: 3.3874 - val_accuracy200: 0.3443 - 25s/epoch - 34ms/step
Epoch 10/50
716/716 - 26s - loss: 3.2345 - accuracy200: 0.3985 - val_loss: 3.4030 - val_accuracy200: 0.3445 - 26s/epoch - 36ms/step
Epoch 11/50
716/716 - 25s - loss: 3.2299 - accuracy200: 0.4029 - val_loss: 3.4194 - val_accuracy200: 0.3460 - 25s/epoch - 35ms/step
Epoch 12/50
716/716 - 25s - loss: 3.2257 - accuracy200: 0.4042 - val_loss: 3.4047 - val_accuracy200: 0.3516 - 25s/epoch - 34ms/step
testing model: results/PCAR/W2/deepVOL_L2/h200
Evaluating performance on  test set...
1914/1914 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073284
{'0': {'precision': 0.3498066179630425, 'recall': 0.010047584074455808, 'f1-score': 0.01953408565960536, 'support': 162029}, '1': {'precision': 0.3209713855421687, 'recall': 0.4183724864718265, 'f1-score': 0.3632561294916432, 'support': 154862}, '2': {'precision': 0.3592617030510675, 'recall': 0.5884481124442287, 'f1-score': 0.4461426220924246, 'support': 173028}, 'accuracy': 0.3433955408955358, 'macro avg': {'precision': 0.3433465688520929, 'recall': 0.338956060996837, 'f1-score': 0.27631094574789106, 'support': 489919}, 'weighted avg': {'precision': 0.34403119937231513, 'recall': 0.3433955408955358, 'f1-score': 0.27885186062610984, 'support': 489919}}
[[  1628  67552  92849]
 [  1330  64790  88742]
 [  1696  69514 101818]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052934
{'0': {'precision': 0.3617904937701892, 'recall': 0.01261870272010301, 'f1-score': 0.024386829867645458, 'support': 62130}, '1': {'precision': 0.3374467012539646, 'recall': 0.5331441750875272, 'f1-score': 0.41330031835868414, 'support': 60267}, '2': {'precision': 0.34905131975075265, 'recall': 0.4929143459776555, 'f1-score': 0.4086922067985572, 'support': 60686}, 'accuracy': 0.3431667604310613, 'macro avg': {'precision': 0.3494295049249689, 'recall': 0.3462257412617619, 'f1-score': 0.28212645167496225, 'support': 183083}, 'weighted avg': {'precision': 0.3495544212887527, 'recall': 0.3431667604310613, 'f1-score': 0.2797934231358284, 'support': 183083}}
[[  784 33022 28324]
 [  675 32131 27461]
 [  708 30065 29913]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1099073
{'0': {'precision': 0.39705882352941174, 'recall': 0.012782745923198316, 'f1-score': 0.02476811741922332, 'support': 19010}, '1': {'precision': 0.30682215743440233, 'recall': 0.4695140086847897, 'f1-score': 0.37112093285687414, 'support': 16811}, '2': {'precision': 0.34936610516650773, 'recall': 0.5253013327669517, 'f1-score': 0.41963944856839874, 'support': 18833}, 'accuracy': 0.32987521498883887, 'macro avg': {'precision': 0.3510823620434406, 'recall': 0.3358660291249799, 'f1-score': 0.2718428329481654, 'support': 54654}, 'weighted avg': {'precision': 0.3528687265803911, 'recall': 0.32987521498883887, 'f1-score': 0.2673697377920189, 'support': 54654}}
[[ 243 9091 9676]
 [ 170 7893 8748]
 [ 199 8741 9893]]
training model: results/PCAR/W2/deepVOL_L2/h300
Epoch 1/50
716/716 - 28s - loss: 3.3097 - accuracy300: 0.3729 - val_loss: 3.3168 - val_accuracy300: 0.3439 - 28s/epoch - 39ms/step
Epoch 2/50
716/716 - 26s - loss: 3.2795 - accuracy300: 0.3735 - val_loss: 3.3102 - val_accuracy300: 0.3508 - 26s/epoch - 36ms/step
Epoch 3/50
716/716 - 26s - loss: 3.2633 - accuracy300: 0.3862 - val_loss: 3.3175 - val_accuracy300: 0.3549 - 26s/epoch - 37ms/step
Epoch 4/50
716/716 - 26s - loss: 3.2554 - accuracy300: 0.3909 - val_loss: 3.2982 - val_accuracy300: 0.3590 - 26s/epoch - 36ms/step
Epoch 5/50
716/716 - 24s - loss: 3.2525 - accuracy300: 0.3910 - val_loss: 3.3077 - val_accuracy300: 0.3557 - 24s/epoch - 34ms/step
Epoch 6/50
716/716 - 26s - loss: 3.2473 - accuracy300: 0.3930 - val_loss: 3.3159 - val_accuracy300: 0.3584 - 26s/epoch - 36ms/step
Epoch 7/50
716/716 - 25s - loss: 3.2393 - accuracy300: 0.3986 - val_loss: 3.3062 - val_accuracy300: 0.3609 - 25s/epoch - 34ms/step
Epoch 8/50
716/716 - 25s - loss: 3.2343 - accuracy300: 0.4019 - val_loss: 3.3047 - val_accuracy300: 0.3598 - 25s/epoch - 34ms/step
Epoch 9/50
716/716 - 25s - loss: 3.2313 - accuracy300: 0.4035 - val_loss: 3.3155 - val_accuracy300: 0.3582 - 25s/epoch - 35ms/step
Epoch 10/50
716/716 - 24s - loss: 3.2248 - accuracy300: 0.4067 - val_loss: 3.3247 - val_accuracy300: 0.3571 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 25s - loss: 3.2234 - accuracy300: 0.4081 - val_loss: 3.3242 - val_accuracy300: 0.3540 - 25s/epoch - 35ms/step
Epoch 12/50
716/716 - 24s - loss: 3.2179 - accuracy300: 0.4123 - val_loss: 3.3181 - val_accuracy300: 0.3598 - 24s/epoch - 34ms/step
Epoch 13/50
716/716 - 25s - loss: 3.2114 - accuracy300: 0.4152 - val_loss: 3.3212 - val_accuracy300: 0.3600 - 25s/epoch - 35ms/step
Epoch 14/50
716/716 - 25s - loss: 3.2055 - accuracy300: 0.4178 - val_loss: 3.3226 - val_accuracy300: 0.3586 - 25s/epoch - 35ms/step
testing model: results/PCAR/W2/deepVOL_L2/h300
Evaluating performance on  test set...
1914/1914 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097917
{'0': {'precision': 0.33202004601758756, 'recall': 0.070760198563838, 'f1-score': 0.11665817626082527, 'support': 148869}, '1': {'precision': 0.3944237064956088, 'recall': 0.36512471832836624, 'f1-score': 0.37920911960185955, 'support': 178843}, '2': {'precision': 0.33557959772275264, 'recall': 0.6054116036915793, 'f1-score': 0.4318080384134236, 'support': 162207}, 'accuracy': 0.3552342325976335, 'macro avg': {'precision': 0.354007783411983, 'recall': 0.3470988401945945, 'f1-score': 0.30922511142536946, 'support': 489919}, 'weighted avg': {'precision': 0.35597878624670803, 'recall': 0.3552342325976335, 'f1-score': 0.31684414996285987, 'support': 489919}}
[[ 10534  49211  89124]
 [  8235  65300 105308]
 [ 12958  51047  98202]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952104
{'0': {'precision': 0.38842748927626175, 'recall': 0.06882276843467011, 'f1-score': 0.11692789538030413, 'support': 61840}, '1': {'precision': 0.37212488123909054, 'recall': 0.5548801581418334, 'f1-score': 0.4454877895558216, 'support': 60705}, '2': {'precision': 0.3609940201940986, 'recall': 0.4866364927813935, 'f1-score': 0.41450339791482, 'support': 60538}, 'accuracy': 0.36813904076293263, 'macro avg': {'precision': 0.3738487969031503, 'recall': 0.37011313978596566, 'f1-score': 0.3256396942836486, 'support': 183083}, 'weighted avg': {'precision': 0.37395090121405783, 'recall': 0.36813904076293263, 'f1-score': 0.32426475433694846, 'support': 183083}}
[[ 4256 29619 27965]
 [ 2838 33684 24183]
 [ 3863 27215 29460]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998279
{'0': {'precision': 0.3770707336313437, 'recall': 0.07875659050966607, 'f1-score': 0.1302984871200763, 'support': 18208}, '1': {'precision': 0.3572749391727494, 'recall': 0.40977842272701903, 'f1-score': 0.38172979436919957, 'support': 17917}, '2': {'precision': 0.3545427543645424, 'recall': 0.5797938366884343, 'f1-score': 0.4400163833708785, 'support': 18529}, 'accuracy': 0.3571376294507264, 'macro avg': {'precision': 0.3629628090562118, 'recall': 0.35610961664170643, 'f1-score': 0.31734822162005144, 'support': 54654}, 'weighted avg': {'precision': 0.3629436399666678, 'recall': 0.3571376294507264, 'f1-score': 0.3177258964883505, 'support': 54654}}
[[ 1434  6796  9978]
 [  995  7342  9580]
 [ 1374  6412 10743]]
training model: results/PCAR/W2/deepVOL_L2/h500
Epoch 1/50
716/716 - 28s - loss: 3.2978 - accuracy500: 0.3823 - val_loss: 3.3396 - val_accuracy500: 0.3350 - 28s/epoch - 39ms/step
Epoch 2/50
716/716 - 23s - loss: 3.2425 - accuracy500: 0.3940 - val_loss: 3.4344 - val_accuracy500: 0.2935 - 23s/epoch - 32ms/step
Epoch 3/50
716/716 - 26s - loss: 3.2220 - accuracy500: 0.4046 - val_loss: 3.3402 - val_accuracy500: 0.3229 - 26s/epoch - 36ms/step
Epoch 4/50
716/716 - 24s - loss: 3.2122 - accuracy500: 0.4074 - val_loss: 3.3483 - val_accuracy500: 0.3082 - 24s/epoch - 33ms/step
Epoch 5/50
716/716 - 25s - loss: 3.2034 - accuracy500: 0.4103 - val_loss: 3.3400 - val_accuracy500: 0.3231 - 25s/epoch - 34ms/step
Epoch 6/50
716/716 - 25s - loss: 3.1929 - accuracy500: 0.4139 - val_loss: 3.3583 - val_accuracy500: 0.3220 - 25s/epoch - 34ms/step
Epoch 7/50
716/716 - 23s - loss: 3.1883 - accuracy500: 0.4169 - val_loss: 3.3897 - val_accuracy500: 0.3299 - 23s/epoch - 32ms/step
Epoch 8/50
716/716 - 25s - loss: 3.1849 - accuracy500: 0.4184 - val_loss: 3.3587 - val_accuracy500: 0.3301 - 25s/epoch - 35ms/step
Epoch 9/50
716/716 - 26s - loss: 3.1831 - accuracy500: 0.4208 - val_loss: 3.3508 - val_accuracy500: 0.3382 - 26s/epoch - 36ms/step
Epoch 10/50
716/716 - 24s - loss: 3.1781 - accuracy500: 0.4226 - val_loss: 3.3584 - val_accuracy500: 0.3402 - 24s/epoch - 33ms/step
Epoch 11/50
716/716 - 27s - loss: 3.1738 - accuracy500: 0.4248 - val_loss: 3.3587 - val_accuracy500: 0.3422 - 27s/epoch - 37ms/step
testing model: results/PCAR/W2/deepVOL_L2/h500
Evaluating performance on  test set...
1914/1914 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1080527
{'0': {'precision': 0.34443821574437417, 'recall': 0.05257207116358947, 'f1-score': 0.09122096321786667, 'support': 163623}, '1': {'precision': 0.30497113803033044, 'recall': 0.4626664971868582, 'f1-score': 0.3676211840125875, 'support': 149477}, '2': {'precision': 0.3596919924761521, 'recall': 0.4845067554957329, 'f1-score': 0.4128724442463162, 'support': 176819}, 'accuracy': 0.3335857560127286, 'macro avg': {'precision': 0.33636711541695224, 'recall': 0.3332484412820602, 'f1-score': 0.29057153049225676, 'support': 489919}, 'weighted avg': {'precision': 0.3379019049919317, 'recall': 0.3335857560127286, 'f1-score': 0.2916409694386948, 'support': 489919}}
[[ 8602 75872 79149]
 [ 6962 69158 73357]
 [ 9410 81739 85670]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106688
{'0': {'precision': 0.3580112896222319, 'recall': 0.054410769966838794, 'f1-score': 0.09446473326172573, 'support': 60613}, '1': {'precision': 0.3475769415312907, 'recall': 0.3990430772620678, 'f1-score': 0.37153617326826976, 'support': 63537}, '2': {'precision': 0.3228404969978004, 'recall': 0.5528820864371404, 'f1-score': 0.40764673868846923, 'support': 58933}, 'accuracy': 0.3344657887406258, 'macro avg': {'precision': 0.34280957605044104, 'recall': 0.3354453112220157, 'f1-score': 0.29121588173948826, 'support': 183083}, 'weighted avg': {'precision': 0.34306895474466403, 'recall': 0.3344657887406258, 'f1-score': 0.2914302800875373, 'support': 183083}}
[[ 3298 24313 33002]
 [ 2842 25354 35341]
 [ 3072 23278 32583]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087927
{'0': {'precision': 0.375, 'recall': 0.059623268123086506, 'f1-score': 0.10288784419073205, 'support': 19271}, '1': {'precision': 0.28798165550110155, 'recall': 0.4150197628458498, 'f1-score': 0.3400222965440357, 'support': 15433}, '2': {'precision': 0.3678830624552796, 'recall': 0.541203007518797, 'f1-score': 0.43802105519381734, 'support': 19950}, 'accuracy': 0.3357668240201998, 'macro avg': {'precision': 0.34362157265212706, 'recall': 0.33861534616257777, 'f1-score': 0.29364373197619503, 'support': 54654}, 'weighted avg': {'precision': 0.347830222588124, 'recall': 0.3357668240201998, 'f1-score': 0.2921805503546009, 'support': 54654}}
[[ 1149  7821 10301]
 [  777  6405  8251]
 [ 1138  8015 10797]]
training model: results/PCAR/W2/deepVOL_L2/h1000
Epoch 1/50
716/716 - 28s - loss: 3.2937 - accuracy1000: 0.3859 - val_loss: 3.3690 - val_accuracy1000: 0.3445 - 28s/epoch - 40ms/step
Epoch 2/50
716/716 - 25s - loss: 3.2624 - accuracy1000: 0.3858 - val_loss: 3.3491 - val_accuracy1000: 0.3498 - 25s/epoch - 35ms/step
Epoch 3/50
716/716 - 25s - loss: 3.2419 - accuracy1000: 0.3953 - val_loss: 3.2967 - val_accuracy1000: 0.3571 - 25s/epoch - 35ms/step
Epoch 4/50
716/716 - 25s - loss: 3.2302 - accuracy1000: 0.4020 - val_loss: 3.3987 - val_accuracy1000: 0.3125 - 25s/epoch - 35ms/step
Epoch 5/50
716/716 - 25s - loss: 3.2234 - accuracy1000: 0.4044 - val_loss: 3.3167 - val_accuracy1000: 0.3497 - 25s/epoch - 35ms/step
Epoch 6/50
716/716 - 28s - loss: 3.2164 - accuracy1000: 0.4080 - val_loss: 3.3825 - val_accuracy1000: 0.3184 - 28s/epoch - 39ms/step
Epoch 7/50
716/716 - 24s - loss: 3.2141 - accuracy1000: 0.4088 - val_loss: 3.3866 - val_accuracy1000: 0.3242 - 24s/epoch - 33ms/step
Epoch 8/50
716/716 - 26s - loss: 3.2042 - accuracy1000: 0.4121 - val_loss: 3.3525 - val_accuracy1000: 0.3526 - 26s/epoch - 36ms/step
Epoch 9/50
716/716 - 24s - loss: 3.2018 - accuracy1000: 0.4138 - val_loss: 3.3548 - val_accuracy1000: 0.3465 - 24s/epoch - 34ms/step
Epoch 10/50
716/716 - 26s - loss: 3.1991 - accuracy1000: 0.4157 - val_loss: 3.3478 - val_accuracy1000: 0.3544 - 26s/epoch - 36ms/step
Epoch 11/50
716/716 - 26s - loss: 3.1897 - accuracy1000: 0.4209 - val_loss: 3.3565 - val_accuracy1000: 0.3582 - 26s/epoch - 36ms/step
Epoch 12/50
716/716 - 25s - loss: 3.1871 - accuracy1000: 0.4219 - val_loss: 3.3759 - val_accuracy1000: 0.3602 - 25s/epoch - 35ms/step
Epoch 13/50
716/716 - 26s - loss: 3.1841 - accuracy1000: 0.4245 - val_loss: 3.3771 - val_accuracy1000: 0.3500 - 26s/epoch - 36ms/step
testing model: results/PCAR/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
1914/1914 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031442
{'0': {'precision': 0.32305356755584475, 'recall': 0.04597020084188177, 'f1-score': 0.08048715912099551, 'support': 162018}, '1': {'precision': 0.32269538886120586, 'recall': 0.2729512767640613, 'f1-score': 0.2957461981360416, 'support': 154218}, '2': {'precision': 0.3531340382083057, 'recall': 0.6840105249218403, 'f1-score': 0.46579311588662653, 'support': 173683}, 'accuracy': 0.3436139443459021, 'macro avg': {'precision': 0.3329609982084521, 'recall': 0.3343106675092611, 'f1-score': 0.28067549104788786, 'support': 489919}, 'weighted avg': {'precision': 0.33360475822695884, 'recall': 0.3436139443459021, 'f1-score': 0.2848432117904112, 'support': 489919}}
[[  7448  42996 111574]
 [  6080  42094 106044]
 [  9527  45355 118801]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002845
{'0': {'precision': 0.38325664242244323, 'recall': 0.041341104137312665, 'f1-score': 0.07463182691890798, 'support': 62456}, '1': {'precision': 0.39006353504843244, 'recall': 0.35991158380317784, 'f1-score': 0.37438144587547273, 'support': 62432}, '2': {'precision': 0.3297203975071585, 'recall': 0.6727553913566457, 'f1-score': 0.4425466979399214, 'support': 58195}, 'accuracy': 0.350677015342768, 'macro avg': {'precision': 0.3676801916593447, 'recall': 0.3580026930990454, 'f1-score': 0.29718665691143403, 'support': 183083}, 'weighted avg': {'precision': 0.36856071842939503, 'recall': 0.350677015342768, 'f1-score': 0.29379348654740506, 'support': 183083}}
[[ 2582 18447 41427]
 [ 1800 22470 38162]
 [ 2355 16689 39151]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991911
{'0': {'precision': 0.35722725482473416, 'recall': 0.04868753019485748, 'f1-score': 0.08569538926681784, 'support': 18629}, '1': {'precision': 0.3358144861150873, 'recall': 0.2831110842937308, 'f1-score': 0.30721885742347355, 'support': 16573}, '2': {'precision': 0.36093123246729414, 'recall': 0.7077421344848859, 'f1-score': 0.4780623317996354, 'support': 19452}, 'accuracy': 0.3543382003147071, 'macro avg': {'precision': 0.35132432446903855, 'recall': 0.34651358299115803, 'f1-score': 0.2903255261633089, 'support': 54654}, 'weighted avg': {'precision': 0.35205244524589446, 'recall': 0.3543382003147071, 'f1-score': 0.292517034597601, 'support': 54654}}
[[  907  4584 13138]
 [  643  4692 11238]
 [  989  4696 13767]]
training model: results/PCAR/W2/deepVOL_L3/h10
Epoch 1/50
716/716 - 37s - loss: 3.2456 - accuracy10: 0.4122 - val_loss: 3.3756 - val_accuracy10: 0.4123 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 31s - loss: 3.0950 - accuracy10: 0.4701 - val_loss: 3.2915 - val_accuracy10: 0.4336 - 31s/epoch - 44ms/step
Epoch 3/50
716/716 - 31s - loss: 2.9796 - accuracy10: 0.5066 - val_loss: 3.1537 - val_accuracy10: 0.4668 - 31s/epoch - 43ms/step
Epoch 4/50
716/716 - 33s - loss: 2.8755 - accuracy10: 0.5302 - val_loss: 3.1151 - val_accuracy10: 0.4803 - 33s/epoch - 45ms/step
Epoch 5/50
716/716 - 32s - loss: 2.8397 - accuracy10: 0.5378 - val_loss: 3.0860 - val_accuracy10: 0.4866 - 32s/epoch - 45ms/step
Epoch 6/50
716/716 - 32s - loss: 2.8145 - accuracy10: 0.5442 - val_loss: 3.0726 - val_accuracy10: 0.4860 - 32s/epoch - 44ms/step
Epoch 7/50
716/716 - 32s - loss: 2.7976 - accuracy10: 0.5484 - val_loss: 3.0816 - val_accuracy10: 0.4850 - 32s/epoch - 44ms/step
Epoch 8/50
716/716 - 34s - loss: 2.7863 - accuracy10: 0.5511 - val_loss: 3.0744 - val_accuracy10: 0.4870 - 34s/epoch - 47ms/step
Epoch 9/50
716/716 - 32s - loss: 2.7754 - accuracy10: 0.5551 - val_loss: 3.0616 - val_accuracy10: 0.4932 - 32s/epoch - 44ms/step
Epoch 10/50
716/716 - 31s - loss: 2.7655 - accuracy10: 0.5570 - val_loss: 3.0562 - val_accuracy10: 0.4942 - 31s/epoch - 44ms/step
Epoch 11/50
716/716 - 33s - loss: 2.7575 - accuracy10: 0.5589 - val_loss: 3.0513 - val_accuracy10: 0.5000 - 33s/epoch - 45ms/step
Epoch 12/50
716/716 - 31s - loss: 2.7498 - accuracy10: 0.5610 - val_loss: 3.0613 - val_accuracy10: 0.4962 - 31s/epoch - 44ms/step
Epoch 13/50
716/716 - 33s - loss: 2.7445 - accuracy10: 0.5615 - val_loss: 3.0548 - val_accuracy10: 0.4967 - 33s/epoch - 46ms/step
Epoch 14/50
716/716 - 31s - loss: 2.7378 - accuracy10: 0.5636 - val_loss: 3.0379 - val_accuracy10: 0.4997 - 31s/epoch - 44ms/step
Epoch 15/50
716/716 - 33s - loss: 2.7326 - accuracy10: 0.5650 - val_loss: 3.0358 - val_accuracy10: 0.5024 - 33s/epoch - 46ms/step
Epoch 16/50
716/716 - 33s - loss: 2.7265 - accuracy10: 0.5659 - val_loss: 3.0337 - val_accuracy10: 0.5037 - 33s/epoch - 46ms/step
Epoch 17/50
716/716 - 32s - loss: 2.7211 - accuracy10: 0.5678 - val_loss: 3.0474 - val_accuracy10: 0.5040 - 32s/epoch - 44ms/step
Epoch 18/50
716/716 - 31s - loss: 2.7152 - accuracy10: 0.5688 - val_loss: 3.0170 - val_accuracy10: 0.5063 - 31s/epoch - 44ms/step
Epoch 19/50
716/716 - 33s - loss: 2.7103 - accuracy10: 0.5703 - val_loss: 3.0145 - val_accuracy10: 0.5098 - 33s/epoch - 47ms/step
Epoch 20/50
716/716 - 33s - loss: 2.7044 - accuracy10: 0.5702 - val_loss: 3.0097 - val_accuracy10: 0.5088 - 33s/epoch - 45ms/step
Epoch 21/50
716/716 - 32s - loss: 2.6975 - accuracy10: 0.5722 - val_loss: 3.0098 - val_accuracy10: 0.5100 - 32s/epoch - 44ms/step
Epoch 22/50
716/716 - 34s - loss: 2.6940 - accuracy10: 0.5719 - val_loss: 3.0013 - val_accuracy10: 0.5118 - 34s/epoch - 48ms/step
Epoch 23/50
716/716 - 32s - loss: 2.6865 - accuracy10: 0.5742 - val_loss: 3.0054 - val_accuracy10: 0.5095 - 32s/epoch - 45ms/step
Epoch 24/50
716/716 - 32s - loss: 2.6817 - accuracy10: 0.5742 - val_loss: 3.0150 - val_accuracy10: 0.5090 - 32s/epoch - 45ms/step
Epoch 25/50
716/716 - 32s - loss: 2.6773 - accuracy10: 0.5761 - val_loss: 3.0032 - val_accuracy10: 0.5136 - 32s/epoch - 45ms/step
Epoch 26/50
716/716 - 33s - loss: 2.6736 - accuracy10: 0.5757 - val_loss: 2.9996 - val_accuracy10: 0.5119 - 33s/epoch - 46ms/step
Epoch 27/50
716/716 - 32s - loss: 2.6682 - accuracy10: 0.5773 - val_loss: 2.9982 - val_accuracy10: 0.5086 - 32s/epoch - 45ms/step
Epoch 28/50
716/716 - 31s - loss: 2.6628 - accuracy10: 0.5780 - val_loss: 2.9943 - val_accuracy10: 0.5130 - 31s/epoch - 44ms/step
Epoch 29/50
716/716 - 31s - loss: 2.6598 - accuracy10: 0.5787 - val_loss: 3.0102 - val_accuracy10: 0.5126 - 31s/epoch - 43ms/step
Epoch 30/50
716/716 - 33s - loss: 2.6543 - accuracy10: 0.5794 - val_loss: 2.9934 - val_accuracy10: 0.5104 - 33s/epoch - 45ms/step
Epoch 31/50
716/716 - 33s - loss: 2.6499 - accuracy10: 0.5806 - val_loss: 2.9986 - val_accuracy10: 0.5132 - 33s/epoch - 46ms/step
Epoch 32/50
716/716 - 32s - loss: 2.6459 - accuracy10: 0.5816 - val_loss: 3.0036 - val_accuracy10: 0.5107 - 32s/epoch - 45ms/step
Epoch 33/50
716/716 - 32s - loss: 2.6418 - accuracy10: 0.5825 - val_loss: 3.0048 - val_accuracy10: 0.5168 - 32s/epoch - 44ms/step
Epoch 34/50
716/716 - 33s - loss: 2.6376 - accuracy10: 0.5832 - val_loss: 3.0054 - val_accuracy10: 0.5098 - 33s/epoch - 45ms/step
Epoch 35/50
716/716 - 32s - loss: 2.6355 - accuracy10: 0.5839 - val_loss: 3.0129 - val_accuracy10: 0.5113 - 32s/epoch - 45ms/step
Epoch 36/50
716/716 - 33s - loss: 2.6307 - accuracy10: 0.5856 - val_loss: 3.0049 - val_accuracy10: 0.5125 - 33s/epoch - 45ms/step
Epoch 37/50
716/716 - 31s - loss: 2.6264 - accuracy10: 0.5855 - val_loss: 3.0069 - val_accuracy10: 0.5128 - 31s/epoch - 43ms/step
Epoch 38/50
716/716 - 31s - loss: 2.6235 - accuracy10: 0.5861 - val_loss: 3.0197 - val_accuracy10: 0.5118 - 31s/epoch - 43ms/step
Epoch 39/50
716/716 - 33s - loss: 2.6189 - accuracy10: 0.5869 - val_loss: 3.0201 - val_accuracy10: 0.5155 - 33s/epoch - 46ms/step
Epoch 40/50
716/716 - 33s - loss: 2.6160 - accuracy10: 0.5875 - val_loss: 3.0178 - val_accuracy10: 0.5098 - 33s/epoch - 46ms/step
testing model: results/PCAR/W2/deepVOL_L3/h10
Evaluating performance on  test set...
1914/1914 - 45s - 45s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9797631
{'0': {'precision': 0.5016787703939515, 'recall': 0.5300721995572111, 'f1-score': 0.5154847963098428, 'support': 152217}, '1': {'precision': 0.6538048271991019, 'recall': 0.44896206156048674, 'f1-score': 0.5323583180987203, 'support': 181610}, '2': {'precision': 0.4792662579448764, 'recall': 0.6275209491838146, 'f1-score': 0.5434642091275532, 'support': 156092}, 'accuracy': 0.5310530924499764, 'macro avg': {'precision': 0.5449166185126433, 'recall': 0.5355184034338375, 'f1-score': 0.5304357745120387, 'support': 489919}, 'weighted avg': {'precision': 0.550930175796033, 'recall': 0.5310530924499764, 'f1-score': 0.5306541667519364, 'support': 489919}}
[[80686 21700 49831]
 [43479 81536 56595]
 [36667 21474 97951]]
Evaluating performance on  train set...
716/716 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9147668
{'0': {'precision': 0.5208380350560445, 'recall': 0.5244181862940029, 'f1-score': 0.522621979411404, 'support': 52809}, '1': {'precision': 0.7053824362606232, 'recall': 0.5408864287677149, 'f1-score': 0.6122784538243333, 'support': 76419}, '2': {'precision': 0.4812025857837982, 'recall': 0.6371924612385108, 'f1-score': 0.5483190591844561, 'support': 53855}, 'accuracy': 0.5644652971603044, 'macro avg': {'precision': 0.5691410190334887, 'recall': 0.5674990254334095, 'f1-score': 0.5610731641400645, 'support': 183083}, 'weighted avg': {'precision': 0.5862080119249832, 'recall': 0.5644652971603044, 'f1-score': 0.5676036235254909, 'support': 183083}}
[[27694  8564 16551]
 [14639 41334 20446]
 [10839  8700 34316]]
Evaluating performance on  val set...
214/214 - 6s - 6s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99928415
{'0': {'precision': 0.502292306917225, 'recall': 0.5484048404840484, 'f1-score': 0.5243366904204685, 'support': 18180}, '1': {'precision': 0.6186315983078904, 'recall': 0.36595582635186596, 'f1-score': 0.4598714793546623, 'support': 18382}, '2': {'precision': 0.46960010028832894, 'recall': 0.6211585231041344, 'f1-score': 0.5348499631154368, 'support': 18092}, 'accuracy': 0.5111245288542468, 'macro avg': {'precision': 0.5301746685044815, 'recall': 0.5118397299800163, 'f1-score': 0.5063527109635225, 'support': 54654}, 'weighted avg': {'precision': 0.530599136280368, 'recall': 0.5111245288542468, 'f1-score': 0.5061350330813116, 'support': 54654}}
[[ 9970  2010  6200]
 [ 5162  6727  6493]
 [ 4717  2137 11238]]
training model: results/PCAR/W2/deepVOL_L3/h20
Epoch 1/50
716/716 - 35s - loss: 3.2499 - accuracy20: 0.3997 - val_loss: 3.3214 - val_accuracy20: 0.3615 - 35s/epoch - 49ms/step
Epoch 2/50
716/716 - 33s - loss: 3.1261 - accuracy20: 0.4421 - val_loss: 3.2484 - val_accuracy20: 0.4109 - 33s/epoch - 45ms/step
Epoch 3/50
716/716 - 33s - loss: 3.0144 - accuracy20: 0.4813 - val_loss: 3.2021 - val_accuracy20: 0.4299 - 33s/epoch - 46ms/step
Epoch 4/50
716/716 - 32s - loss: 2.9528 - accuracy20: 0.5017 - val_loss: 3.1973 - val_accuracy20: 0.4384 - 32s/epoch - 45ms/step
Epoch 5/50
716/716 - 32s - loss: 2.9109 - accuracy20: 0.5151 - val_loss: 3.1585 - val_accuracy20: 0.4484 - 32s/epoch - 45ms/step
Epoch 6/50
716/716 - 32s - loss: 2.8918 - accuracy20: 0.5202 - val_loss: 3.0936 - val_accuracy20: 0.4632 - 32s/epoch - 45ms/step
Epoch 7/50
716/716 - 33s - loss: 2.8776 - accuracy20: 0.5231 - val_loss: 3.0932 - val_accuracy20: 0.4639 - 33s/epoch - 45ms/step
Epoch 8/50
716/716 - 32s - loss: 2.8623 - accuracy20: 0.5277 - val_loss: 3.0761 - val_accuracy20: 0.4683 - 32s/epoch - 45ms/step
Epoch 9/50
716/716 - 32s - loss: 2.8552 - accuracy20: 0.5289 - val_loss: 3.0785 - val_accuracy20: 0.4670 - 32s/epoch - 44ms/step
Epoch 10/50
716/716 - 33s - loss: 2.8455 - accuracy20: 0.5323 - val_loss: 3.0668 - val_accuracy20: 0.4698 - 33s/epoch - 45ms/step
Epoch 11/50
716/716 - 32s - loss: 2.8368 - accuracy20: 0.5339 - val_loss: 3.0587 - val_accuracy20: 0.4777 - 32s/epoch - 45ms/step
Epoch 12/50
716/716 - 33s - loss: 2.8305 - accuracy20: 0.5358 - val_loss: 3.0543 - val_accuracy20: 0.4787 - 33s/epoch - 46ms/step
Epoch 13/50
716/716 - 32s - loss: 2.8250 - accuracy20: 0.5365 - val_loss: 3.0699 - val_accuracy20: 0.4748 - 32s/epoch - 44ms/step
Epoch 14/50
716/716 - 32s - loss: 2.8215 - accuracy20: 0.5367 - val_loss: 3.0542 - val_accuracy20: 0.4768 - 32s/epoch - 44ms/step
Epoch 15/50
716/716 - 32s - loss: 2.8159 - accuracy20: 0.5383 - val_loss: 3.0464 - val_accuracy20: 0.4774 - 32s/epoch - 45ms/step
Epoch 16/50
716/716 - 33s - loss: 2.8104 - accuracy20: 0.5398 - val_loss: 3.0501 - val_accuracy20: 0.4837 - 33s/epoch - 46ms/step
Epoch 17/50
716/716 - 34s - loss: 2.8054 - accuracy20: 0.5420 - val_loss: 3.0443 - val_accuracy20: 0.4829 - 34s/epoch - 47ms/step
Epoch 18/50
716/716 - 32s - loss: 2.8020 - accuracy20: 0.5415 - val_loss: 3.0555 - val_accuracy20: 0.4799 - 32s/epoch - 45ms/step
Epoch 19/50
716/716 - 33s - loss: 2.7960 - accuracy20: 0.5439 - val_loss: 3.0513 - val_accuracy20: 0.4795 - 33s/epoch - 46ms/step
Epoch 20/50
716/716 - 33s - loss: 2.7916 - accuracy20: 0.5448 - val_loss: 3.0441 - val_accuracy20: 0.4821 - 33s/epoch - 46ms/step
Epoch 21/50
716/716 - 32s - loss: 2.7867 - accuracy20: 0.5453 - val_loss: 3.0419 - val_accuracy20: 0.4829 - 32s/epoch - 45ms/step
Epoch 22/50
716/716 - 33s - loss: 2.7829 - accuracy20: 0.5460 - val_loss: 3.0488 - val_accuracy20: 0.4844 - 33s/epoch - 46ms/step
Epoch 23/50
716/716 - 33s - loss: 2.7798 - accuracy20: 0.5480 - val_loss: 3.0561 - val_accuracy20: 0.4832 - 33s/epoch - 46ms/step
Epoch 24/50
716/716 - 32s - loss: 2.7756 - accuracy20: 0.5479 - val_loss: 3.0373 - val_accuracy20: 0.4865 - 32s/epoch - 45ms/step
Epoch 25/50
716/716 - 32s - loss: 2.7715 - accuracy20: 0.5505 - val_loss: 3.0411 - val_accuracy20: 0.4832 - 32s/epoch - 45ms/step
Epoch 26/50
716/716 - 32s - loss: 2.7683 - accuracy20: 0.5509 - val_loss: 3.0492 - val_accuracy20: 0.4862 - 32s/epoch - 45ms/step
Epoch 27/50
716/716 - 32s - loss: 2.7652 - accuracy20: 0.5511 - val_loss: 3.0438 - val_accuracy20: 0.4864 - 32s/epoch - 45ms/step
Epoch 28/50
716/716 - 33s - loss: 2.7591 - accuracy20: 0.5521 - val_loss: 3.0379 - val_accuracy20: 0.4868 - 33s/epoch - 46ms/step
Epoch 29/50
716/716 - 32s - loss: 2.7572 - accuracy20: 0.5529 - val_loss: 3.0541 - val_accuracy20: 0.4851 - 32s/epoch - 45ms/step
Epoch 30/50
716/716 - 31s - loss: 2.7528 - accuracy20: 0.5537 - val_loss: 3.0609 - val_accuracy20: 0.4851 - 31s/epoch - 43ms/step
Epoch 31/50
716/716 - 32s - loss: 2.7483 - accuracy20: 0.5547 - val_loss: 3.0509 - val_accuracy20: 0.4861 - 32s/epoch - 44ms/step
Epoch 32/50
716/716 - 33s - loss: 2.7456 - accuracy20: 0.5552 - val_loss: 3.0525 - val_accuracy20: 0.4880 - 33s/epoch - 46ms/step
Epoch 33/50
716/716 - 32s - loss: 2.7415 - accuracy20: 0.5564 - val_loss: 3.0471 - val_accuracy20: 0.4893 - 32s/epoch - 45ms/step
Epoch 34/50
716/716 - 33s - loss: 2.7393 - accuracy20: 0.5574 - val_loss: 3.0488 - val_accuracy20: 0.4864 - 33s/epoch - 46ms/step
testing model: results/PCAR/W2/deepVOL_L3/h20
Evaluating performance on  test set...
1914/1914 - 43s - 43s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0034612
{'0': {'precision': 0.5228545029621176, 'recall': 0.3959103763323907, 'f1-score': 0.45061261635026534, 'support': 170089}, '1': {'precision': 0.49799701409858876, 'recall': 0.5159795618394345, 'f1-score': 0.5068288306250623, 'support': 142870}, '2': {'precision': 0.4926207314040085, 'recall': 0.5932188065099457, 'f1-score': 0.538259792799514, 'support': 176960}, 'accuracy': 0.5021932196955007, 'macro avg': {'precision': 0.5044907494882382, 'recall': 0.5017029148939236, 'f1-score': 0.49856707992494725, 'support': 489919}, 'weighted avg': {'precision': 0.5046850552598335, 'recall': 0.5021932196955007, 'f1-score': 0.49866475329106436, 'support': 489919}}
[[ 67340  37059  65690]
 [ 26721  73718  42431]
 [ 34732  37252 104976]]
Evaluating performance on  train set...
716/716 - 18s - 18s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95007116
{'0': {'precision': 0.5606740780783604, 'recall': 0.3925908859009595, 'f1-score': 0.461813957990514, 'support': 60763}, '1': {'precision': 0.5506065756314833, 'recall': 0.6182039513727813, 'f1-score': 0.5824505389759844, 'support': 60789}, '2': {'precision': 0.49663826019589397, 'recall': 0.5834294908257627, 'f1-score': 0.5365467249560961, 'support': 61531}, 'accuracy': 0.5316386556916808, 'macro avg': {'precision': 0.5359729713019127, 'recall': 0.5314081093665012, 'f1-score': 0.5269370739741982, 'support': 183083}, 'weighted avg': {'precision': 0.5358100474672756, 'recall': 0.5316386556916808, 'f1-score': 0.5269852683016024, 'support': 183083}}
[[23855 15380 21528]
 [ 8352 37580 14857]
 [10340 15292 35899]]
Evaluating performance on  val set...
214/214 - 6s - 6s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0124921
{'0': {'precision': 0.5277375480133493, 'recall': 0.41243049062546133, 'f1-score': 0.46301309319927075, 'support': 20321}, '1': {'precision': 0.44250819183795054, 'recall': 0.4285611251352326, 'f1-score': 0.4354230022350053, 'support': 13865}, '2': {'precision': 0.4836851449990136, 'recall': 0.5989349228063319, 'f1-score': 0.5351756051775697, 'support': 20468}, 'accuracy': 0.48636879276905626, 'macro avg': {'precision': 0.4846436282834378, 'recall': 0.4799755128556753, 'f1-score': 0.4778705668706153, 'support': 54654}, 'weighted avg': {'precision': 0.48961829584023614, 'recall': 0.48636879276905626, 'f1-score': 0.4830388128895456, 'support': 54654}}
[[ 8381  3685  8255]
 [ 3092  5942  4831]
 [ 4408  3801 12259]]
training model: results/PCAR/W2/deepVOL_L3/h30
Epoch 1/50
716/716 - 35s - loss: 3.2871 - accuracy30: 0.3804 - val_loss: 3.2756 - val_accuracy30: 0.3710 - 35s/epoch - 49ms/step
Epoch 2/50
716/716 - 34s - loss: 3.2302 - accuracy30: 0.4016 - val_loss: 3.2283 - val_accuracy30: 0.4026 - 34s/epoch - 47ms/step
Epoch 3/50
716/716 - 31s - loss: 3.1229 - accuracy30: 0.4474 - val_loss: 3.2097 - val_accuracy30: 0.4186 - 31s/epoch - 43ms/step
Epoch 4/50
716/716 - 33s - loss: 3.0664 - accuracy30: 0.4695 - val_loss: 3.1943 - val_accuracy30: 0.4338 - 33s/epoch - 46ms/step
Epoch 5/50
716/716 - 32s - loss: 3.0291 - accuracy30: 0.4817 - val_loss: 3.2095 - val_accuracy30: 0.4324 - 32s/epoch - 45ms/step
Epoch 6/50
716/716 - 32s - loss: 3.0100 - accuracy30: 0.4886 - val_loss: 3.2011 - val_accuracy30: 0.4368 - 32s/epoch - 45ms/step
Epoch 7/50
716/716 - 32s - loss: 2.9932 - accuracy30: 0.4929 - val_loss: 3.1901 - val_accuracy30: 0.4483 - 32s/epoch - 44ms/step
Epoch 8/50
716/716 - 30s - loss: 2.9808 - accuracy30: 0.4956 - val_loss: 3.1989 - val_accuracy30: 0.4447 - 30s/epoch - 42ms/step
Epoch 9/50
716/716 - 32s - loss: 2.9715 - accuracy30: 0.4983 - val_loss: 3.1995 - val_accuracy30: 0.4442 - 32s/epoch - 45ms/step
Epoch 10/50
716/716 - 32s - loss: 2.9644 - accuracy30: 0.5001 - val_loss: 3.2064 - val_accuracy30: 0.4430 - 32s/epoch - 45ms/step
Epoch 11/50
716/716 - 31s - loss: 2.9574 - accuracy30: 0.5023 - val_loss: 3.1971 - val_accuracy30: 0.4481 - 31s/epoch - 44ms/step
Epoch 12/50
716/716 - 32s - loss: 2.9534 - accuracy30: 0.5032 - val_loss: 3.2126 - val_accuracy30: 0.4445 - 32s/epoch - 45ms/step
Epoch 13/50
716/716 - 32s - loss: 2.9466 - accuracy30: 0.5052 - val_loss: 3.1876 - val_accuracy30: 0.4456 - 32s/epoch - 44ms/step
Epoch 14/50
716/716 - 33s - loss: 2.9440 - accuracy30: 0.5058 - val_loss: 3.2107 - val_accuracy30: 0.4458 - 33s/epoch - 46ms/step
Epoch 15/50
716/716 - 32s - loss: 2.9418 - accuracy30: 0.5066 - val_loss: 3.1940 - val_accuracy30: 0.4504 - 32s/epoch - 44ms/step
Epoch 16/50
716/716 - 33s - loss: 2.9368 - accuracy30: 0.5080 - val_loss: 3.1957 - val_accuracy30: 0.4508 - 33s/epoch - 46ms/step
Epoch 17/50
716/716 - 33s - loss: 2.9321 - accuracy30: 0.5100 - val_loss: 3.2122 - val_accuracy30: 0.4481 - 33s/epoch - 46ms/step
Epoch 18/50
716/716 - 32s - loss: 2.9283 - accuracy30: 0.5108 - val_loss: 3.1981 - val_accuracy30: 0.4492 - 32s/epoch - 45ms/step
Epoch 19/50
716/716 - 33s - loss: 2.9235 - accuracy30: 0.5116 - val_loss: 3.1960 - val_accuracy30: 0.4517 - 33s/epoch - 46ms/step
Epoch 20/50
716/716 - 32s - loss: 2.9206 - accuracy30: 0.5133 - val_loss: 3.2069 - val_accuracy30: 0.4478 - 32s/epoch - 45ms/step
Epoch 21/50
716/716 - 33s - loss: 2.9185 - accuracy30: 0.5137 - val_loss: 3.2164 - val_accuracy30: 0.4462 - 33s/epoch - 46ms/step
Epoch 22/50
716/716 - 32s - loss: 2.9152 - accuracy30: 0.5138 - val_loss: 3.2025 - val_accuracy30: 0.4487 - 32s/epoch - 45ms/step
Epoch 23/50
716/716 - 32s - loss: 2.9101 - accuracy30: 0.5153 - val_loss: 3.2081 - val_accuracy30: 0.4478 - 32s/epoch - 45ms/step
testing model: results/PCAR/W2/deepVOL_L3/h30
Evaluating performance on  test set...
1914/1914 - 45s - 45s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.057836
{'0': {'precision': 0.4699027906465443, 'recall': 0.35750598890037216, 'f1-score': 0.40607029079176377, 'support': 167393}, '1': {'precision': 0.45547114469010863, 'recall': 0.44586420635082635, 'f1-score': 0.4506164774485466, 'support': 146973}, '2': {'precision': 0.45373859126076854, 'recall': 0.5652367091419686, 'f1-score': 0.5033874874760618, 'support': 175553}, 'accuracy': 0.4584492538562497, 'macro avg': {'precision': 0.4597041755324738, 'recall': 0.456202301464389, 'f1-score': 0.4533580852387907, 'support': 489919}, 'weighted avg': {'precision': 0.45978124811415355, 'recall': 0.4584492538562497, 'f1-score': 0.4543056368816805, 'support': 489919}}
[[59844 40100 67449]
 [29429 65530 52014]
 [38081 38243 99229]]
Evaluating performance on  train set...
716/716 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.005834
{'0': {'precision': 0.5094249374932058, 'recall': 0.37712253142553637, 'f1-score': 0.43340177200673285, 'support': 62131}, '1': {'precision': 0.5020891780576613, 'recall': 0.5683349943413118, 'f1-score': 0.5331621940687568, 'support': 59201}, '2': {'precision': 0.45974370683258176, 'recall': 0.5217243445450276, 'f1-score': 0.48877695767938284, 'support': 61751}, 'accuracy': 0.4877241469715921, 'macro avg': {'precision': 0.49041927412781633, 'recall': 0.489060623437292, 'f1-score': 0.48511364125162415, 'support': 183083}, 'weighted avg': {'precision': 0.49029618185304336, 'recall': 0.4877241469715921, 'f1-score': 0.4843370846079339, 'support': 183083}}
[[23431 16860 21840]
 [ 9536 33646 16019]
 [13028 16506 32217]]
Evaluating performance on  val set...
214/214 - 6s - 6s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0628929
{'0': {'precision': 0.4713460427498556, 'recall': 0.40762390087929656, 'f1-score': 0.43717515940631196, 'support': 20016}, '1': {'precision': 0.4027016885553471, 'recall': 0.3710156952222914, 'f1-score': 0.38620987476608604, 'support': 14463}, '2': {'precision': 0.45180898455389484, 'recall': 0.5378934324659231, 'f1-score': 0.4911073901434584, 'support': 20175}, 'accuracy': 0.44602407874995426, 'macro avg': {'precision': 0.4419522386196992, 'recall': 0.43884434285583707, 'f1-score': 0.4381641414386188, 'support': 54654}, 'weighted avg': {'precision': 0.44596888016672015, 'recall': 0.44602407874995426, 'f1-score': 0.44359686400927495, 'support': 54654}}
[[ 8159  3973  7884]
 [ 3814  5366  5283]
 [ 5337  3986 10852]]
training model: results/PCAR/W2/deepVOL_L3/h50
Epoch 1/50
716/716 - 37s - loss: 3.3055 - accuracy50: 0.3715 - val_loss: 3.3063 - val_accuracy50: 0.3470 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 33s - loss: 3.2630 - accuracy50: 0.3808 - val_loss: 3.2992 - val_accuracy50: 0.3574 - 33s/epoch - 46ms/step
Epoch 3/50
716/716 - 32s - loss: 3.2166 - accuracy50: 0.4073 - val_loss: 3.2678 - val_accuracy50: 0.3845 - 32s/epoch - 45ms/step
Epoch 4/50
716/716 - 31s - loss: 3.1818 - accuracy50: 0.4222 - val_loss: 3.2608 - val_accuracy50: 0.3942 - 31s/epoch - 43ms/step
Epoch 5/50
716/716 - 34s - loss: 3.1614 - accuracy50: 0.4336 - val_loss: 3.2567 - val_accuracy50: 0.3958 - 34s/epoch - 47ms/step
Epoch 6/50
716/716 - 33s - loss: 3.1475 - accuracy50: 0.4390 - val_loss: 3.2527 - val_accuracy50: 0.4005 - 33s/epoch - 46ms/step
Epoch 7/50
716/716 - 32s - loss: 3.1370 - accuracy50: 0.4435 - val_loss: 3.2451 - val_accuracy50: 0.4059 - 32s/epoch - 45ms/step
Epoch 8/50
716/716 - 32s - loss: 3.1285 - accuracy50: 0.4475 - val_loss: 3.2378 - val_accuracy50: 0.4046 - 32s/epoch - 45ms/step
Epoch 9/50
716/716 - 32s - loss: 3.1215 - accuracy50: 0.4497 - val_loss: 3.2370 - val_accuracy50: 0.4078 - 32s/epoch - 45ms/step
Epoch 10/50
716/716 - 32s - loss: 3.1157 - accuracy50: 0.4515 - val_loss: 3.2301 - val_accuracy50: 0.4119 - 32s/epoch - 45ms/step
Epoch 11/50
716/716 - 34s - loss: 3.1084 - accuracy50: 0.4546 - val_loss: 3.2221 - val_accuracy50: 0.4200 - 34s/epoch - 48ms/step
Epoch 12/50
716/716 - 33s - loss: 3.1041 - accuracy50: 0.4556 - val_loss: 3.2261 - val_accuracy50: 0.4187 - 33s/epoch - 46ms/step
Epoch 13/50
716/716 - 32s - loss: 3.0995 - accuracy50: 0.4594 - val_loss: 3.2275 - val_accuracy50: 0.4170 - 32s/epoch - 45ms/step
Epoch 14/50
716/716 - 33s - loss: 3.0951 - accuracy50: 0.4592 - val_loss: 3.2248 - val_accuracy50: 0.4169 - 33s/epoch - 47ms/step
Epoch 15/50
716/716 - 33s - loss: 3.0899 - accuracy50: 0.4616 - val_loss: 3.2223 - val_accuracy50: 0.4197 - 33s/epoch - 46ms/step
Epoch 16/50
716/716 - 32s - loss: 3.0861 - accuracy50: 0.4637 - val_loss: 3.2289 - val_accuracy50: 0.4184 - 32s/epoch - 45ms/step
Epoch 17/50
716/716 - 33s - loss: 3.0830 - accuracy50: 0.4640 - val_loss: 3.2320 - val_accuracy50: 0.4155 - 33s/epoch - 46ms/step
Epoch 18/50
716/716 - 33s - loss: 3.0800 - accuracy50: 0.4647 - val_loss: 3.2387 - val_accuracy50: 0.4137 - 33s/epoch - 46ms/step
Epoch 19/50
716/716 - 33s - loss: 3.0757 - accuracy50: 0.4664 - val_loss: 3.2387 - val_accuracy50: 0.4156 - 33s/epoch - 46ms/step
Epoch 20/50
716/716 - 33s - loss: 3.0710 - accuracy50: 0.4675 - val_loss: 3.2473 - val_accuracy50: 0.4122 - 33s/epoch - 47ms/step
Epoch 21/50
716/716 - 33s - loss: 3.0699 - accuracy50: 0.4678 - val_loss: 3.2605 - val_accuracy50: 0.4070 - 33s/epoch - 47ms/step
testing model: results/PCAR/W2/deepVOL_L3/h50
Evaluating performance on  test set...
1914/1914 - 45s - 45s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0702801
{'0': {'precision': 0.42989128243720853, 'recall': 0.37977396032433847, 'f1-score': 0.40328151986183075, 'support': 168466}, '1': {'precision': 0.39641514500537056, 'recall': 0.24979553850926423, 'f1-score': 0.3064719824230576, 'support': 141836}, '2': {'precision': 0.42960546963454993, 'recall': 0.6020532577651336, 'f1-score': 0.5014165356776883, 'support': 179617}, 'accuracy': 0.4236373767908573, 'macro avg': {'precision': 0.4186372990257097, 'recall': 0.41054091886624544, 'f1-score': 0.4037233459875256, 'support': 489919}, 'weighted avg': {'precision': 0.420094850237279, 'recall': 0.4236373767908573, 'f1-score': 0.41123311917443356, 'support': 489919}}
[[ 63979  28815  75672]
 [ 38500  35430  67906]
 [ 46347  25131 108139]]
Evaluating performance on  train set...
716/716 - 17s - 17s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0529007
{'0': {'precision': 0.46350989510982266, 'recall': 0.37103948428686545, 'f1-score': 0.4121516993224193, 'support': 62050}, '1': {'precision': 0.46754049445865303, 'recall': 0.3618056471830057, 'f1-score': 0.4079329068729544, 'support': 60632}, '2': {'precision': 0.4069624936410304, 'recall': 0.5827552523964835, 'f1-score': 0.47924679869020304, 'support': 60401}, 'accuracy': 0.4378287443399988, 'macro avg': {'precision': 0.44600429440316863, 'recall': 0.43853346128878484, 'f1-score': 0.43311046829519223, 'support': 183083}, 'weighted avg': {'precision': 0.44618913733111987, 'recall': 0.4378287443399988, 'f1-score': 0.4328899288309895, 'support': 183083}}
[[23023 13671 25356]
 [12758 21937 25937]
 [13890 11312 35199]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0750884
{'0': {'precision': 0.443457409123113, 'recall': 0.41485673498521464, 'f1-score': 0.4286805573848221, 'support': 19614}, '1': {'precision': 0.3545840207400424, 'recall': 0.1978173690092696, 'f1-score': 0.25395619698696037, 'support': 15211}, '2': {'precision': 0.422229411553255, 'recall': 0.5923647183418226, 'f1-score': 0.49303223640026866, 'support': 19829}, 'accuracy': 0.41885314890035497, 'macro avg': {'precision': 0.4067569471388035, 'recall': 0.4016796074454356, 'f1-score': 0.39188966359068367, 'support': 54654}, 'weighted avg': {'precision': 0.41102093467462614, 'recall': 0.41885314890035497, 'f1-score': 0.4033996483422162, 'support': 54654}}
[[ 8137  2834  8643]
 [ 4772  3009  7430]
 [ 5440  2643 11746]]
training model: results/PCAR/W2/deepVOL_L3/h100
Epoch 1/50
716/716 - 38s - loss: 3.3062 - accuracy100: 0.3666 - val_loss: 3.3449 - val_accuracy100: 0.3185 - 38s/epoch - 52ms/step
Epoch 2/50
716/716 - 32s - loss: 3.2889 - accuracy100: 0.3601 - val_loss: 3.3324 - val_accuracy100: 0.3227 - 32s/epoch - 45ms/step
Epoch 3/50
716/716 - 33s - loss: 3.2834 - accuracy100: 0.3604 - val_loss: 3.3098 - val_accuracy100: 0.3366 - 33s/epoch - 46ms/step
Epoch 4/50
716/716 - 33s - loss: 3.2697 - accuracy100: 0.3729 - val_loss: 3.3091 - val_accuracy100: 0.3486 - 33s/epoch - 45ms/step
Epoch 5/50
716/716 - 33s - loss: 3.2473 - accuracy100: 0.3900 - val_loss: 3.3543 - val_accuracy100: 0.3161 - 33s/epoch - 45ms/step
Epoch 6/50
716/716 - 31s - loss: 3.2349 - accuracy100: 0.3973 - val_loss: 3.3252 - val_accuracy100: 0.3413 - 31s/epoch - 43ms/step
Epoch 7/50
716/716 - 32s - loss: 3.2279 - accuracy100: 0.3999 - val_loss: 3.3670 - val_accuracy100: 0.3240 - 32s/epoch - 44ms/step
Epoch 8/50
716/716 - 32s - loss: 3.2236 - accuracy100: 0.4039 - val_loss: 3.3565 - val_accuracy100: 0.3263 - 32s/epoch - 45ms/step
Epoch 9/50
716/716 - 33s - loss: 3.2156 - accuracy100: 0.4086 - val_loss: 3.3468 - val_accuracy100: 0.3387 - 33s/epoch - 46ms/step
Epoch 10/50
716/716 - 34s - loss: 3.2071 - accuracy100: 0.4126 - val_loss: 3.3427 - val_accuracy100: 0.3298 - 34s/epoch - 47ms/step
Epoch 11/50
716/716 - 32s - loss: 3.1992 - accuracy100: 0.4152 - val_loss: 3.3467 - val_accuracy100: 0.3472 - 32s/epoch - 45ms/step
Epoch 12/50
716/716 - 32s - loss: 3.1929 - accuracy100: 0.4182 - val_loss: 3.3441 - val_accuracy100: 0.3513 - 32s/epoch - 45ms/step
Epoch 13/50
716/716 - 33s - loss: 3.1857 - accuracy100: 0.4217 - val_loss: 3.3570 - val_accuracy100: 0.3458 - 33s/epoch - 45ms/step
Epoch 14/50
716/716 - 31s - loss: 3.1796 - accuracy100: 0.4231 - val_loss: 3.3503 - val_accuracy100: 0.3551 - 31s/epoch - 43ms/step
testing model: results/PCAR/W2/deepVOL_L3/h100
Evaluating performance on  test set...
1914/1914 - 43s - 43s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014413
{'0': {'precision': 0.34747002047382275, 'recall': 0.06538569733736134, 'f1-score': 0.11006057861065505, 'support': 163522}, '1': {'precision': 0.32801256760050923, 'recall': 0.4728444068458385, 'f1-score': 0.3873323525021856, 'support': 153670}, '2': {'precision': 0.37160495905330226, 'recall': 0.5112287019400557, 'f1-score': 0.4303757983979647, 'support': 172727}, 'accuracy': 0.3503783278460317, 'macro avg': {'precision': 0.34902918237587804, 'recall': 0.34981960204108514, 'f1-score': 0.30925624317026845, 'support': 489919}, 'weighted avg': {'precision': 0.34987598707845674, 'recall': 0.3503783278460317, 'f1-score': 0.3099618693589505, 'support': 489919}}
[[10692 74949 77881]
 [ 9566 72662 71442]
 [10513 73911 88303]]
Evaluating performance on  train set...
716/716 - 17s - 17s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949392
{'0': {'precision': 0.382051282051282, 'recall': 0.06565162048369724, 'f1-score': 0.11204879679144385, 'support': 61278}, '1': {'precision': 0.3668136153617905, 'recall': 0.5622533014960285, 'f1-score': 0.44397698923214074, 'support': 61563}, '2': {'precision': 0.3619690749338142, 'recall': 0.46980511935194713, 'f1-score': 0.4088968511388345, 'support': 60242}, 'accuracy': 0.3656210571161714, 'macro avg': {'precision': 0.37027799078229556, 'recall': 0.36590334711055766, 'f1-score': 0.3216408790541397, 'support': 183083}, 'weighted avg': {'precision': 0.3703196150173375, 'recall': 0.3656210571161714, 'f1-score': 0.32133756637257443, 'support': 183083}}
[[ 4023 31226 26029]
 [ 3091 34614 23858]
 [ 3416 28524 28302]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028908
{'0': {'precision': 0.3734606685096758, 'recall': 0.07635784389291403, 'f1-score': 0.12679180887372013, 'support': 19461}, '1': {'precision': 0.31121656238189227, 'recall': 0.46780709506375456, 'f1-score': 0.37377379901651747, 'support': 15842}, '2': {'precision': 0.37320378229469137, 'recall': 0.5180610821146194, 'f1-score': 0.43386060199510956, 'support': 19351}, 'accuracy': 0.34621436674351375, 'macro avg': {'precision': 0.35262700439541983, 'recall': 0.35407534035709604, 'f1-score': 0.31147540329511575, 'support': 54654}, 'weighted avg': {'precision': 0.35532764742389045, 'recall': 0.34621436674351375, 'f1-score': 0.307103897715053, 'support': 54654}}
[[ 1486  8463  9512]
 [ 1106  7411  7325]
 [ 1387  7939 10025]]
training model: results/PCAR/W2/deepVOL_L3/h200
Epoch 1/50
716/716 - 37s - loss: 3.3218 - accuracy200: 0.3586 - val_loss: 3.3474 - val_accuracy200: 0.3149 - 37s/epoch - 51ms/step
Epoch 2/50
716/716 - 33s - loss: 3.2950 - accuracy200: 0.3587 - val_loss: 3.3265 - val_accuracy200: 0.3218 - 33s/epoch - 46ms/step
Epoch 3/50
716/716 - 33s - loss: 3.2845 - accuracy200: 0.3631 - val_loss: 3.3389 - val_accuracy200: 0.3097 - 33s/epoch - 46ms/step
Epoch 4/50
716/716 - 32s - loss: 3.2758 - accuracy200: 0.3717 - val_loss: 3.3584 - val_accuracy200: 0.3106 - 32s/epoch - 45ms/step
Epoch 5/50
716/716 - 33s - loss: 3.2665 - accuracy200: 0.3780 - val_loss: 3.3577 - val_accuracy200: 0.3153 - 33s/epoch - 46ms/step
Epoch 6/50
716/716 - 32s - loss: 3.2586 - accuracy200: 0.3805 - val_loss: 3.3432 - val_accuracy200: 0.3267 - 32s/epoch - 45ms/step
Epoch 7/50
716/716 - 32s - loss: 3.2522 - accuracy200: 0.3854 - val_loss: 3.3543 - val_accuracy200: 0.3286 - 32s/epoch - 45ms/step
Epoch 8/50
716/716 - 32s - loss: 3.2432 - accuracy200: 0.3897 - val_loss: 3.3462 - val_accuracy200: 0.3340 - 32s/epoch - 45ms/step
Epoch 9/50
716/716 - 33s - loss: 3.2364 - accuracy200: 0.3938 - val_loss: 3.3483 - val_accuracy200: 0.3360 - 33s/epoch - 46ms/step
Epoch 10/50
716/716 - 33s - loss: 3.2295 - accuracy200: 0.3988 - val_loss: 3.3353 - val_accuracy200: 0.3387 - 33s/epoch - 46ms/step
Epoch 11/50
716/716 - 33s - loss: 3.2234 - accuracy200: 0.4028 - val_loss: 3.3382 - val_accuracy200: 0.3428 - 33s/epoch - 46ms/step
Epoch 12/50
716/716 - 33s - loss: 3.2167 - accuracy200: 0.4064 - val_loss: 3.3441 - val_accuracy200: 0.3474 - 33s/epoch - 46ms/step
testing model: results/PCAR/W2/deepVOL_L3/h200
Evaluating performance on  test set...
1914/1914 - 45s - 45s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064497
{'0': {'precision': 0.33534660260809884, 'recall': 0.01507754784637318, 'f1-score': 0.02885762547692453, 'support': 162029}, '1': {'precision': 0.32105919003115263, 'recall': 0.7653200914362465, 'f1-score': 0.45235223620833104, 'support': 154862}, '2': {'precision': 0.36675654717845685, 'recall': 0.24054488290912454, 'f1-score': 0.2905358239794494, 'support': 173028}, 'accuracy': 0.331856898793474, 'macro avg': {'precision': 0.34105411327256946, 'recall': 0.3403141740639147, 'f1-score': 0.257248561888235, 'support': 489919}, 'weighted avg': {'precision': 0.3419236543301771, 'recall': 0.331856898793474, 'f1-score': 0.2551417208836794, 'support': 489919}}
[[  2443 121880  37706]
 [  2186 118519  34157]
 [  2656 128751  41621]]
Evaluating performance on  train set...
716/716 - 17s - 17s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1067307
{'0': {'precision': 0.34835566382460414, 'recall': 0.01380975374215355, 'f1-score': 0.02656634619850448, 'support': 62130}, '1': {'precision': 0.33217611809633063, 'recall': 0.7303167570975824, 'f1-score': 0.45665018753015263, 'support': 60267}, '2': {'precision': 0.3370464275323164, 'recall': 0.2672445044985664, 'f1-score': 0.29811403992500274, 'support': 60686}, 'accuracy': 0.333673798222664, 'macro avg': {'precision': 0.339192736484417, 'recall': 0.3371236717794341, 'f1-score': 0.26044352455121994, 'support': 183083}, 'weighted avg': {'precision': 0.33928106380144724, 'recall': 0.333673798222664, 'f1-score': 0.2581498695568759, 'support': 183083}}
[[  858 44835 16437]
 [  790 44014 15463]
 [  815 43653 16218]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1105765
{'0': {'precision': 0.38009049773755654, 'recall': 0.013256180957390847, 'f1-score': 0.025618868499974582, 'support': 19010}, '1': {'precision': 0.3103790131930146, 'recall': 0.7263101540657902, 'f1-score': 0.43490650044523604, 'support': 16811}, '2': {'precision': 0.35019110019110017, 'recall': 0.27244729995221156, 'f1-score': 0.3064655816037032, 'support': 18833}, 'accuracy': 0.3218977567973067, 'macro avg': {'precision': 0.3468868703738905, 'recall': 0.3373378783251309, 'f1-score': 0.25566365018297127, 'support': 54654}, 'weighted avg': {'precision': 0.34834506061180714, 'recall': 0.3218977567973067, 'f1-score': 0.24828730134138252, 'support': 54654}}
[[  252 13646  5112]
 [  192 12210  4409]
 [  219 13483  5131]]
training model: results/PCAR/W2/deepVOL_L3/h300
Epoch 1/50
716/716 - 34s - loss: 3.3160 - accuracy300: 0.3721 - val_loss: 3.3866 - val_accuracy300: 0.3345 - 34s/epoch - 48ms/step
Epoch 2/50
716/716 - 32s - loss: 3.3027 - accuracy300: 0.3568 - val_loss: 3.3036 - val_accuracy300: 0.3400 - 32s/epoch - 45ms/step
Epoch 3/50
716/716 - 33s - loss: 3.2899 - accuracy300: 0.3578 - val_loss: 3.2985 - val_accuracy300: 0.3411 - 33s/epoch - 46ms/step
Epoch 4/50
716/716 - 33s - loss: 3.2855 - accuracy300: 0.3669 - val_loss: 3.3005 - val_accuracy300: 0.3467 - 33s/epoch - 46ms/step
Epoch 5/50
716/716 - 32s - loss: 3.2770 - accuracy300: 0.3732 - val_loss: 3.2977 - val_accuracy300: 0.3536 - 32s/epoch - 45ms/step
Epoch 6/50
716/716 - 33s - loss: 3.2669 - accuracy300: 0.3794 - val_loss: 3.2967 - val_accuracy300: 0.3555 - 33s/epoch - 46ms/step
Epoch 7/50
716/716 - 31s - loss: 3.2600 - accuracy300: 0.3830 - val_loss: 3.3038 - val_accuracy300: 0.3560 - 31s/epoch - 44ms/step
Epoch 8/50
716/716 - 31s - loss: 3.2499 - accuracy300: 0.3892 - val_loss: 3.2986 - val_accuracy300: 0.3591 - 31s/epoch - 43ms/step
Epoch 9/50
716/716 - 32s - loss: 3.2444 - accuracy300: 0.3936 - val_loss: 3.3075 - val_accuracy300: 0.3610 - 32s/epoch - 45ms/step
Epoch 10/50
716/716 - 31s - loss: 3.2369 - accuracy300: 0.3970 - val_loss: 3.3143 - val_accuracy300: 0.3618 - 31s/epoch - 44ms/step
Epoch 11/50
716/716 - 32s - loss: 3.2279 - accuracy300: 0.4022 - val_loss: 3.3173 - val_accuracy300: 0.3600 - 32s/epoch - 45ms/step
Epoch 12/50
716/716 - 33s - loss: 3.2225 - accuracy300: 0.4075 - val_loss: 3.3245 - val_accuracy300: 0.3583 - 33s/epoch - 45ms/step
Epoch 13/50
716/716 - 32s - loss: 3.2144 - accuracy300: 0.4123 - val_loss: 3.3384 - val_accuracy300: 0.3523 - 32s/epoch - 45ms/step
Epoch 14/50
716/716 - 32s - loss: 3.2085 - accuracy300: 0.4169 - val_loss: 3.3354 - val_accuracy300: 0.3562 - 32s/epoch - 45ms/step
Epoch 15/50
716/716 - 32s - loss: 3.2018 - accuracy300: 0.4207 - val_loss: 3.3451 - val_accuracy300: 0.3535 - 32s/epoch - 45ms/step
Epoch 16/50
716/716 - 32s - loss: 3.1981 - accuracy300: 0.4212 - val_loss: 3.3495 - val_accuracy300: 0.3525 - 32s/epoch - 44ms/step
testing model: results/PCAR/W2/deepVOL_L3/h300
Evaluating performance on  test set...
1914/1914 - 45s - 45s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957186
{'0': {'precision': 0.31148036253776434, 'recall': 0.020776655986135463, 'f1-score': 0.03895490525758979, 'support': 148869}, '1': {'precision': 0.3900529135883933, 'recall': 0.5222289941457032, 'f1-score': 0.44656577972220235, 'support': 178843}, '2': {'precision': 0.3578294019339658, 'recall': 0.5306367789306257, 'f1-score': 0.4274275044754921, 'support': 162207}, 'accuracy': 0.37263915055345886, 'macro avg': {'precision': 0.3531208926867078, 'recall': 0.3578808096874881, 'f1-score': 0.3043160631517614, 'support': 489919}, 'weighted avg': {'precision': 0.35550863941799815, 'recall': 0.37263915055345886, 'f1-score': 0.3163708179354263, 'support': 489919}}
[[ 3093 73456 72320]
 [ 3297 93397 82149]
 [ 3540 72594 86073]]
Evaluating performance on  train set...
716/716 - 17s - 17s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971295
{'0': {'precision': 0.37271019257867544, 'recall': 0.025663001293661062, 'f1-score': 0.04801960724984115, 'support': 61840}, '1': {'precision': 0.3557623685987077, 'recall': 0.6076764681657194, 'f1-score': 0.4487849387146811, 'support': 60705}, '2': {'precision': 0.36317295534704197, 'recall': 0.45074168290990785, 'f1-score': 0.40224657816956955, 'support': 60538}, 'accuracy': 0.3591977409153226, 'macro avg': {'precision': 0.36388183884147507, 'recall': 0.3613603841230961, 'f1-score': 0.2996837080446973, 'support': 183083}, 'weighted avg': {'precision': 0.3639372157199142, 'recall': 0.3591977409153226, 'f1-score': 0.2980299949543884, 'support': 183083}}
[[ 1587 34957 25296]
 [ 1264 36889 22552]
 [ 1407 31844 27287]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099439
{'0': {'precision': 0.34023668639053256, 'recall': 0.018947715289982424, 'f1-score': 0.03589636874414733, 'support': 18208}, '1': {'precision': 0.35076820058777575, 'recall': 0.5262599765585757, 'f1-score': 0.42095629269163803, 'support': 17917}, '2': {'precision': 0.36200904368623643, 'recall': 0.5228020940147876, 'f1-score': 0.4277954425013249, 'support': 18529}, 'accuracy': 0.3560764079481831, 'macro avg': {'precision': 0.35100464355484823, 'recall': 0.3560032619544486, 'f1-score': 0.2948827013123701, 'support': 54654}, 'weighted avg': {'precision': 0.35107053474937366, 'recall': 0.3560764079481831, 'f1-score': 0.2949920725355246, 'support': 54654}}
[[ 345 8977 8886]
 [ 302 9429 8186]
 [ 367 8475 9687]]
training model: results/PCAR/W2/deepVOL_L3/h500
Epoch 1/50
716/716 - 36s - loss: 3.3020 - accuracy500: 0.3805 - val_loss: 3.3875 - val_accuracy500: 0.3121 - 36s/epoch - 50ms/step
Epoch 2/50
716/716 - 33s - loss: 3.2893 - accuracy500: 0.3657 - val_loss: 3.3284 - val_accuracy500: 0.3325 - 33s/epoch - 46ms/step
Epoch 3/50
716/716 - 33s - loss: 3.2720 - accuracy500: 0.3767 - val_loss: 3.4745 - val_accuracy500: 0.2943 - 33s/epoch - 46ms/step
Epoch 4/50
716/716 - 32s - loss: 3.2553 - accuracy500: 0.3879 - val_loss: 3.3617 - val_accuracy500: 0.3196 - 32s/epoch - 45ms/step
Epoch 5/50
716/716 - 31s - loss: 3.2383 - accuracy500: 0.3950 - val_loss: 3.4282 - val_accuracy500: 0.3079 - 31s/epoch - 43ms/step
Epoch 6/50
716/716 - 32s - loss: 3.2148 - accuracy500: 0.4089 - val_loss: 3.4111 - val_accuracy500: 0.2996 - 32s/epoch - 45ms/step
Epoch 7/50
716/716 - 34s - loss: 3.2072 - accuracy500: 0.4117 - val_loss: 3.3869 - val_accuracy500: 0.3416 - 34s/epoch - 47ms/step
Epoch 8/50
716/716 - 31s - loss: 3.2011 - accuracy500: 0.4119 - val_loss: 3.3655 - val_accuracy500: 0.3452 - 31s/epoch - 44ms/step
Epoch 9/50
716/716 - 33s - loss: 3.2023 - accuracy500: 0.4131 - val_loss: 3.4131 - val_accuracy500: 0.3288 - 33s/epoch - 46ms/step
Epoch 10/50
716/716 - 33s - loss: 3.1921 - accuracy500: 0.4176 - val_loss: 3.4148 - val_accuracy500: 0.3202 - 33s/epoch - 46ms/step
Epoch 11/50
716/716 - 32s - loss: 3.1891 - accuracy500: 0.4204 - val_loss: 3.4110 - val_accuracy500: 0.3170 - 32s/epoch - 45ms/step
Epoch 12/50
716/716 - 33s - loss: 3.1850 - accuracy500: 0.4236 - val_loss: 3.3472 - val_accuracy500: 0.3393 - 33s/epoch - 46ms/step
testing model: results/PCAR/W2/deepVOL_L3/h500
Evaluating performance on  test set...
1914/1914 - 42s - 42s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022168
{'0': {'precision': 0.34180058752376014, 'recall': 0.012088765026921643, 'f1-score': 0.023351632135056963, 'support': 163623}, '1': {'precision': 0.3105899204917364, 'recall': 0.4583849020250607, 'f1-score': 0.37028450374645683, 'support': 149477}, '2': {'precision': 0.36328483716976695, 'recall': 0.5414293712779735, 'f1-score': 0.43481815394747303, 'support': 176819}, 'accuracy': 0.33930302764334513, 'macro avg': {'precision': 0.33855844839508786, 'recall': 0.337301012776652, 'f1-score': 0.27615142994299563, 'support': 489919}, 'weighted avg': {'precision': 0.34003202305128916, 'recall': 0.33930302764334513, 'f1-score': 0.27770711491936784, 'support': 489919}}
[[ 1978 73223 88422]
 [ 1590 68518 79369]
 [ 2219 78865 95735]]
Evaluating performance on  train set...
716/716 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021655
{'0': {'precision': 0.3319634703196347, 'recall': 0.011994126672495999, 'f1-score': 0.02315176026622932, 'support': 60613}, '1': {'precision': 0.3544312737631396, 'recall': 0.47389709932795065, 'f1-score': 0.40554919523200217, 'support': 63537}, '2': {'precision': 0.32381696893892015, 'recall': 0.5271579590382298, 'f1-score': 0.401193235748, 'support': 58933}, 'accuracy': 0.33811986913039443, 'macro avg': {'precision': 0.3367372376738981, 'recall': 0.3376830616795588, 'f1-score': 0.2766313970820771, 'support': 183083}, 'weighted avg': {'precision': 0.33713838585805345, 'recall': 0.33811986913039443, 'f1-score': 0.27754733003506366, 'support': 183083}}
[[  727 27711 32175]
 [  729 30110 32698]
 [  734 27132 31067]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051892
{'0': {'precision': 0.3312788906009245, 'recall': 0.011156660266722018, 'f1-score': 0.021586345381526106, 'support': 19271}, '1': {'precision': 0.28557385106905875, 'recall': 0.4517592172617119, 'f1-score': 0.3499385148191834, 'support': 15433}, '2': {'precision': 0.364435132303741, 'recall': 0.5405513784461153, 'f1-score': 0.4353565733432915, 'support': 19950}, 'accuracy': 0.3288139934862956, 'macro avg': {'precision': 0.3270959579912414, 'recall': 0.3344890853248497, 'f1-score': 0.2689604778480003, 'support': 54654}, 'weighted avg': {'precision': 0.3304756766893335, 'recall': 0.3288139934862956, 'f1-score': 0.2653411497648939, 'support': 54654}}
[[  215  8517 10539]
 [  193  6972  8268]
 [  241  8925 10784]]
training model: results/PCAR/W2/deepVOL_L3/h1000
Epoch 1/50
716/716 - 36s - loss: 3.2990 - accuracy1000: 0.3832 - val_loss: 3.3087 - val_accuracy1000: 0.3556 - 36s/epoch - 51ms/step
Epoch 2/50
716/716 - 32s - loss: 3.2936 - accuracy1000: 0.3648 - val_loss: 3.3993 - val_accuracy1000: 0.3172 - 32s/epoch - 45ms/step
Epoch 3/50
716/716 - 34s - loss: 3.2797 - accuracy1000: 0.3703 - val_loss: 3.3077 - val_accuracy1000: 0.3552 - 34s/epoch - 47ms/step
Epoch 4/50
716/716 - 33s - loss: 3.2577 - accuracy1000: 0.3814 - val_loss: 3.3119 - val_accuracy1000: 0.3427 - 33s/epoch - 46ms/step
Epoch 5/50
716/716 - 33s - loss: 3.2611 - accuracy1000: 0.3844 - val_loss: 3.3634 - val_accuracy1000: 0.3071 - 33s/epoch - 46ms/step
Epoch 6/50
716/716 - 33s - loss: 3.2436 - accuracy1000: 0.3942 - val_loss: 3.3580 - val_accuracy1000: 0.3091 - 33s/epoch - 45ms/step
Epoch 7/50
716/716 - 33s - loss: 3.2260 - accuracy1000: 0.4040 - val_loss: 3.4012 - val_accuracy1000: 0.3061 - 33s/epoch - 46ms/step
Epoch 8/50
716/716 - 32s - loss: 3.2165 - accuracy1000: 0.4036 - val_loss: 3.3674 - val_accuracy1000: 0.3144 - 32s/epoch - 45ms/step
Epoch 9/50
716/716 - 32s - loss: 3.2075 - accuracy1000: 0.4095 - val_loss: 3.3863 - val_accuracy1000: 0.3076 - 32s/epoch - 45ms/step
Epoch 10/50
716/716 - 33s - loss: 3.1984 - accuracy1000: 0.4143 - val_loss: 3.3720 - val_accuracy1000: 0.3192 - 33s/epoch - 46ms/step
Epoch 11/50
716/716 - 31s - loss: 3.1916 - accuracy1000: 0.4154 - val_loss: 3.4072 - val_accuracy1000: 0.3179 - 31s/epoch - 43ms/step
Epoch 12/50
716/716 - 33s - loss: 3.1811 - accuracy1000: 0.4228 - val_loss: 3.4037 - val_accuracy1000: 0.3248 - 33s/epoch - 46ms/step
Epoch 13/50
716/716 - 32s - loss: 3.1702 - accuracy1000: 0.4260 - val_loss: 3.3717 - val_accuracy1000: 0.3263 - 32s/epoch - 44ms/step
testing model: results/PCAR/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
1914/1914 - 43s - 43s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080505
{'0': {'precision': 0.3370031403120762, 'recall': 0.17022799935809602, 'f1-score': 0.22619814071361494, 'support': 162018}, '1': {'precision': 0.3021282388709897, 'recall': 0.043172651700839074, 'f1-score': 0.07554962979773625, 'support': 154218}, '2': {'precision': 0.35073813020829286, 'recall': 0.7795811910204222, 'f1-score': 0.483808148987183, 'support': 173683}, 'accuracy': 0.34625723844145667, 'macro avg': {'precision': 0.32995650313045294, 'recall': 0.33099394735978577, 'f1-score': 0.2618519731661781, 'support': 489919}, 'weighted avg': {'precision': 0.33089436865738053, 'recall': 0.34625723844145667, 'f1-score': 0.2701028821311822, 'support': 489919}}
[[ 27580   7157 127281]
 [ 24198   6658 123362]
 [ 30061   8222 135400]]
Evaluating performance on  train set...
716/716 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080816
{'0': {'precision': 0.34096614216616666, 'recall': 0.17833354681695915, 'f1-score': 0.23418346964950273, 'support': 62456}, '1': {'precision': 0.4026858699883223, 'recall': 0.0662801127626858, 'f1-score': 0.11382516366837211, 'support': 62432}, '2': {'precision': 0.3259360215782676, 'recall': 0.7848956095884526, 'f1-score': 0.4606022103904485, 'support': 58195}, 'accuracy': 0.33292550373327945, 'macro avg': {'precision': 0.3565293445775855, 'recall': 0.34316975638936587, 'f1-score': 0.26953694790277444, 'support': 183083}, 'weighted avg': {'precision': 0.3572353106841614, 'recall': 0.33292550373327945, 'f1-score': 0.2651105839004457, 'support': 183083}}
[[11138  3318 48000]
 [11830  4138 46464]
 [ 9698  2820 45677]]
Evaluating performance on  val set...
214/214 - 6s - 6s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040536
{'0': {'precision': 0.35718168968141784, 'recall': 0.17633796768479254, 'f1-score': 0.23611011284410263, 'support': 18629}, '1': {'precision': 0.3099593495934959, 'recall': 0.03680685452241598, 'f1-score': 0.06580011865595167, 'support': 16573}, '2': {'precision': 0.35641196624433763, 'recall': 0.7968332305161423, 'f1-score': 0.4925247453964824, 'support': 19452}, 'accuracy': 0.35486881106597873, 'macro avg': {'precision': 0.34118433517308383, 'recall': 0.3366593509077836, 'f1-score': 0.26481165896551223, 'support': 54654}, 'weighted avg': {'precision': 0.34258827469669184, 'recall': 0.35486881106597873, 'f1-score': 0.2757271564041104, 'support': 54654}}
[[ 3285   685 14659]
 [ 2633   610 13330]
 [ 3279   673 15500]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)   6.41 (ave)

============================================
