This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-26.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-18.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-05.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-06.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-14.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-10.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-12.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-07.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-28.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-11.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-24.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-13.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-04.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-20.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-06-19.csv
training model: results/ATVI/W4/deepLOB_L1/h10
Epoch 1/50
1972/1972 - 49s - loss: 2.9280 - accuracy10: 0.4525 - val_loss: 3.3042 - val_accuracy10: 0.2729 - 49s/epoch - 25ms/step
Epoch 2/50
1972/1972 - 30s - loss: 2.8492 - accuracy10: 0.4631 - val_loss: 2.9400 - val_accuracy10: 0.4307 - 30s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 2.7454 - accuracy10: 0.5080 - val_loss: 2.8867 - val_accuracy10: 0.4659 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 2.6688 - accuracy10: 0.5402 - val_loss: 2.8848 - val_accuracy10: 0.5498 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 30s - loss: 2.6315 - accuracy10: 0.5553 - val_loss: 2.8860 - val_accuracy10: 0.5506 - 30s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 2.6072 - accuracy10: 0.5641 - val_loss: 2.9190 - val_accuracy10: 0.5800 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 2.5898 - accuracy10: 0.5701 - val_loss: 2.9142 - val_accuracy10: 0.5896 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 30s - loss: 2.5751 - accuracy10: 0.5749 - val_loss: 2.9073 - val_accuracy10: 0.5821 - 30s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 2.5633 - accuracy10: 0.5779 - val_loss: 2.9365 - val_accuracy10: 0.5985 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 30s - loss: 2.5499 - accuracy10: 0.5817 - val_loss: 2.9306 - val_accuracy10: 0.6014 - 30s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 2.5407 - accuracy10: 0.5838 - val_loss: 2.9211 - val_accuracy10: 0.6021 - 29s/epoch - 15ms/step
Epoch 12/50
1972/1972 - 29s - loss: 2.5314 - accuracy10: 0.5843 - val_loss: 2.9040 - val_accuracy10: 0.6025 - 29s/epoch - 15ms/step
Epoch 13/50
1972/1972 - 29s - loss: 2.5225 - accuracy10: 0.5859 - val_loss: 2.9232 - val_accuracy10: 0.6029 - 29s/epoch - 15ms/step
Epoch 14/50
1972/1972 - 29s - loss: 2.5161 - accuracy10: 0.5873 - val_loss: 2.9273 - val_accuracy10: 0.6022 - 29s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h10
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94648266
{'0': {'precision': 0.3840621741015456, 'recall': 0.5682773746673255, 'f1-score': 0.4583529987588932, 'support': 230706}, '1': {'precision': 0.7097197396521052, 'recall': 0.5260655154725151, 'f1-score': 0.6042458900247248, 'support': 635514}, '2': {'precision': 0.38650542005901173, 'recall': 0.47775900283087186, 'f1-score': 0.42731469486774853, 'support': 227845}, 'accuracy': 0.5249066554546576, 'macro avg': {'precision': 0.4934291112708875, 'recall': 0.5240339643235709, 'f1-score': 0.4966378612171221, 'support': 1094065}, 'weighted avg': {'precision': 0.5737370320747712, 'recall': 0.5249066554546576, 'f1-score': 0.5366345017316013, 'support': 1094065}}
[[131105  60973  38628]
 [167036 334322 134156]
 [ 43223  75767 108855]]
Evaluating performance on  train set...
1972/1972 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8593723
{'0': {'precision': 0.37934385752935307, 'recall': 0.4988945695730275, 'f1-score': 0.4309822587624405, 'support': 86844}, '1': {'precision': 0.7912840615737642, 'recall': 0.6253090262876347, 'f1-score': 0.698573316924199, 'support': 330878}, '2': {'precision': 0.36702820966390465, 'recall': 0.5446475857146147, 'f1-score': 0.43853534183082277, 'support': 86858}, 'accuracy': 0.5896666534543581, 'macro avg': {'precision': 0.5125520429223406, 'recall': 0.556283727191759, 'f1-score': 0.5226969725058207, 'support': 504580}, 'weighted avg': {'precision': 0.64735336700557, 'recall': 0.5896666534543581, 'f1-score': 0.6077550992071665, 'support': 504580}}
[[ 43326  27114  16404]
 [ 58796 206901  65181]
 [ 12091  27460  47307]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9103453
{'0': {'precision': 0.3620720479127559, 'recall': 0.5053334165055205, 'f1-score': 0.42187215206353335, 'support': 32062}, '1': {'precision': 0.7715160939564358, 'recall': 0.5620506967394637, 'f1-score': 0.6503328684836867, 'support': 117404}, '2': {'precision': 0.3445727757196347, 'recall': 0.5559000255689082, 'f1-score': 0.4254387574145417, 'support': 31288}, 'accuracy': 0.5509255673456742, 'macro avg': {'precision': 0.49272030586294213, 'recall': 0.5410947129379641, 'f1-score': 0.4992145926539206, 'support': 180754}, 'weighted avg': {'precision': 0.6249865701547744, 'recall': 0.5509255673456742, 'f1-score': 0.5708801623914599, 'support': 180754}}
[[16202 10059  5801]
 [24134 65987 27283]
 [ 4412  9483 17393]]
training model: results/ATVI/W4/deepLOB_L1/h20
Epoch 1/50
1972/1972 - 32s - loss: 2.9912 - accuracy20: 0.4649 - val_loss: 3.1911 - val_accuracy20: 0.3496 - 32s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 30s - loss: 2.8986 - accuracy20: 0.4838 - val_loss: 3.0859 - val_accuracy20: 0.4409 - 30s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 2.8220 - accuracy20: 0.5187 - val_loss: 3.0556 - val_accuracy20: 0.4752 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 2.7651 - accuracy20: 0.5405 - val_loss: 3.0851 - val_accuracy20: 0.5018 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 2.7288 - accuracy20: 0.5544 - val_loss: 3.0581 - val_accuracy20: 0.5123 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 2.7077 - accuracy20: 0.5615 - val_loss: 3.0681 - val_accuracy20: 0.5045 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 2.6928 - accuracy20: 0.5659 - val_loss: 3.0828 - val_accuracy20: 0.4642 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 2.6790 - accuracy20: 0.5699 - val_loss: 3.0967 - val_accuracy20: 0.4763 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 30s - loss: 2.6693 - accuracy20: 0.5709 - val_loss: 3.1054 - val_accuracy20: 0.4895 - 30s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 2.6595 - accuracy20: 0.5745 - val_loss: 3.1144 - val_accuracy20: 0.4777 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 2.6525 - accuracy20: 0.5749 - val_loss: 3.0905 - val_accuracy20: 0.4842 - 29s/epoch - 15ms/step
Epoch 12/50
1972/1972 - 29s - loss: 2.6465 - accuracy20: 0.5761 - val_loss: 3.0847 - val_accuracy20: 0.4865 - 29s/epoch - 15ms/step
Epoch 13/50
1972/1972 - 29s - loss: 2.6393 - accuracy20: 0.5775 - val_loss: 3.0792 - val_accuracy20: 0.5147 - 29s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h20
Evaluating performance on  test set...
4274/4274 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0978503
{'0': {'precision': 0.36344027537700424, 'recall': 0.6550881316098708, 'f1-score': 0.46750863169900114, 'support': 297850}, '1': {'precision': 0.5399723780539972, 'recall': 0.17543337165230202, 'f1-score': 0.264826428694525, 'support': 503667}, '2': {'precision': 0.3851556167627546, 'recall': 0.518147449307464, 'f1-score': 0.44186144807472844, 'support': 292548}, 'accuracy': 0.3976555323495405, 'macro avg': {'precision': 0.429522756731252, 'recall': 0.4495563175232123, 'f1-score': 0.3913988361560849, 'support': 1094065}, 'weighted avg': {'precision': 0.45051569982686007, 'recall': 0.3976555323495405, 'f1-score': 0.36734331298798373, 'support': 1094065}}
[[195118  31066  71666]
 [244993  88360 170314]
 [ 96753  44212 151583]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99844474
{'0': {'precision': 0.36564576299267026, 'recall': 0.5666339096792471, 'f1-score': 0.44447453766397904, 'support': 112953}, '1': {'precision': 0.6910094813819601, 'recall': 0.4210018022675542, 'f1-score': 0.5232253329139143, 'support': 278538}, '2': {'precision': 0.37191406298877616, 'recall': 0.5256567835952215, 'f1-score': 0.43561831552026736, 'support': 113089}, 'accuracy': 0.47705814737009, 'macro avg': {'precision': 0.4761897691211356, 'recall': 0.5044308318473409, 'f1-score': 0.4677727286993869, 'support': 504580}, 'weighted avg': {'precision': 0.5466577634107914, 'recall': 0.47705814737009, 'f1-score': 0.48596161147054345, 'support': 504580}}
[[ 64003  24187  24763]
 [ 85644 117265  75629]
 [ 25394  28249  59446]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061171
{'0': {'precision': 0.37557945340180116, 'recall': 0.5714183942437843, 'f1-score': 0.45324919947259373, 'support': 42111}, '1': {'precision': 0.6697646629269426, 'recall': 0.4142008190411676, 'f1-score': 0.5118559152741226, 'support': 97431}, '2': {'precision': 0.3818468572238663, 'recall': 0.5228574201688828, 'f1-score': 0.44136292412154476, 'support': 41212}, 'accuracy': 0.47560219967469597, 'macro avg': {'precision': 0.47573032451753666, 'recall': 0.5028255444846116, 'f1-score': 0.46882267962275365, 'support': 180754}, 'weighted avg': {'precision': 0.535581729398786, 'recall': 0.47560219967469597, 'f1-score': 0.4821296322568825, 'support': 180754}}
[[24063  9335  8713]
 [30905 40356 26170]
 [ 9101 10563 21548]]
training model: results/ATVI/W4/deepLOB_L1/h30
Epoch 1/50
1972/1972 - 33s - loss: 3.0493 - accuracy30: 0.4677 - val_loss: 3.2620 - val_accuracy30: 0.3963 - 33s/epoch - 17ms/step
Epoch 2/50
1972/1972 - 29s - loss: 3.0237 - accuracy30: 0.4668 - val_loss: 3.4168 - val_accuracy30: 0.4668 - 29s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 30s - loss: 2.9614 - accuracy30: 0.4902 - val_loss: 3.3463 - val_accuracy30: 0.4062 - 30s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 2.8998 - accuracy30: 0.5153 - val_loss: 3.3453 - val_accuracy30: 0.4265 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 2.8515 - accuracy30: 0.5320 - val_loss: 3.3853 - val_accuracy30: 0.4461 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 2.8191 - accuracy30: 0.5409 - val_loss: 3.3475 - val_accuracy30: 0.4844 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 30s - loss: 2.7981 - accuracy30: 0.5458 - val_loss: 3.3284 - val_accuracy30: 0.4807 - 30s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 30s - loss: 2.7820 - accuracy30: 0.5507 - val_loss: 3.3383 - val_accuracy30: 0.4867 - 30s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 2.7683 - accuracy30: 0.5539 - val_loss: 3.3584 - val_accuracy30: 0.4856 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 2.7576 - accuracy30: 0.5560 - val_loss: 3.3188 - val_accuracy30: 0.4817 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 2.7475 - accuracy30: 0.5589 - val_loss: 3.3899 - val_accuracy30: 0.4853 - 29s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h30
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869825
{'0': {'precision': 0.40232931297301633, 'recall': 0.44149125046586907, 'f1-score': 0.42100152373543254, 'support': 340761}, '1': {'precision': 0.36100289645184647, 'recall': 0.23787529970298094, 'f1-score': 0.28678176209616535, 'support': 419165}, '2': {'precision': 0.3862141980244856, 'recall': 0.5131217846465094, 'f1-score': 0.440713865262173, 'support': 334139}, 'accuracy': 0.3853573599374809, 'macro avg': {'precision': 0.3831821358164495, 'recall': 0.39749611160511983, 'f1-score': 0.38283238369792366, 'support': 1094065}, 'weighted avg': {'precision': 0.3815743525502962, 'recall': 0.3853573599374809, 'f1-score': 0.3755987695095685, 'support': 1094065}}
[[150443  95356  94962]
 [141937  99709 177519]
 [ 81550  81135 171454]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658202
{'0': {'precision': 0.3647943739489375, 'recall': 0.4565548488814395, 'f1-score': 0.4055489081663177, 'support': 130659}, '1': {'precision': 0.5202875554548104, 'recall': 0.2644664828607876, 'f1-score': 0.35067960953144867, 'support': 243010}, '2': {'precision': 0.35820641655672064, 'recall': 0.5952211808022244, 'f1-score': 0.44725377537725075, 'support': 130911}, 'accuracy': 0.40001981846288004, 'macro avg': {'precision': 0.4144294486534896, 'recall': 0.4387475041814839, 'f1-score': 0.40116076435833903, 'support': 504580}, 'weighted avg': {'precision': 0.437971990873052, 'recall': 0.40001981846288004, 'f1-score': 0.3899435286629504, 'support': 504580}}
[[ 59653  31738  39268]
 [ 78400  64268 100342]
 [ 25472  27518  77921]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0792742
{'0': {'precision': 0.38378282182783, 'recall': 0.4848249504383903, 'f1-score': 0.4284269459996388, 'support': 48929}, '1': {'precision': 0.46960438699569135, 'recall': 0.2861131661217574, 'f1-score': 0.3555825782628684, 'support': 83806}, '2': {'precision': 0.3560390672185967, 'recall': 0.5033216018659281, 'f1-score': 0.4170592397025073, 'support': 48019}, 'accuracy': 0.39760669196808923, 'macro avg': {'precision': 0.4031420920140394, 'recall': 0.4247532394753586, 'f1-score': 0.4003562546550048, 'support': 180754}, 'weighted avg': {'precision': 0.4162033200623201, 'recall': 0.39760669196808923, 'f1-score': 0.39163295543107746, 'support': 180754}}
[[23722 13047 12160]
 [28274 23978 31554]
 [ 9815 14035 24169]]
training model: results/ATVI/W4/deepLOB_L1/h50
Epoch 1/50
1972/1972 - 31s - loss: 3.1309 - accuracy50: 0.4503 - val_loss: 3.2977 - val_accuracy50: 0.3938 - 31s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 30s - loss: 3.0950 - accuracy50: 0.4636 - val_loss: 3.4279 - val_accuracy50: 0.3890 - 30s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.0799 - accuracy50: 0.4679 - val_loss: 3.3154 - val_accuracy50: 0.3916 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.0265 - accuracy50: 0.4886 - val_loss: 3.4756 - val_accuracy50: 0.3857 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 2.9798 - accuracy50: 0.5045 - val_loss: 3.4812 - val_accuracy50: 0.3984 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 2.9452 - accuracy50: 0.5144 - val_loss: 3.4968 - val_accuracy50: 0.4111 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 2.9272 - accuracy50: 0.5190 - val_loss: 3.4641 - val_accuracy50: 0.4133 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 2.9154 - accuracy50: 0.5219 - val_loss: 3.4324 - val_accuracy50: 0.4158 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 2.9019 - accuracy50: 0.5250 - val_loss: 3.4271 - val_accuracy50: 0.4168 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 2.8931 - accuracy50: 0.5276 - val_loss: 3.4325 - val_accuracy50: 0.4160 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 30s - loss: 2.8843 - accuracy50: 0.5299 - val_loss: 3.4027 - val_accuracy50: 0.4173 - 30s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h50
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1333047
{'0': {'precision': 0.3672926511049369, 'recall': 0.5512352254857201, 'f1-score': 0.4408459503756714, 'support': 394260}, '1': {'precision': 0.2744748944902858, 'recall': 0.28711299370056603, 'f1-score': 0.28065173879238475, 'support': 313044}, '2': {'precision': 0.4727528459282214, 'recall': 0.21378577467738474, 'f1-score': 0.29442723355766837, 'support': 386761}, 'accuracy': 0.3563709651620333, 'macro avg': {'precision': 0.3715067971744814, 'recall': 0.3507113312878903, 'f1-score': 0.33864164090857485, 'support': 1094065}, 'weighted avg': {'precision': 0.37801582441582016, 'recall': 0.3563709651620333, 'f1-score': 0.3432494765773815, 'support': 1094065}}
[[217330 131720  45210]
 [176160  89879  47005]
 [198218 105859  82684]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930645
{'0': {'precision': 0.34336053821550677, 'recall': 0.4835490551384934, 'f1-score': 0.4015715022787858, 'support': 154520}, '1': {'precision': 0.40952348789301274, 'recall': 0.3117374561047214, 'f1-score': 0.3540017282047689, 'support': 194497}, '2': {'precision': 0.4219425988179992, 'recall': 0.37679268206450117, 'f1-score': 0.39809155120891065, 'support': 155563}, 'accuracy': 0.38440881525228904, 'macro avg': {'precision': 0.3916088749755062, 'recall': 0.3906930644359053, 'f1-score': 0.3845549272308218, 'support': 504580}, 'weighted avg': {'precision': 0.3930909205472112, 'recall': 0.38440881525228904, 'f1-score': 0.38216223124870724, 'support': 504580}}
[[74718 49897 29905]
 [83468 60632 50397]
 [59422 37526 58615]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909609
{'0': {'precision': 0.38177126811869166, 'recall': 0.43326156231160107, 'f1-score': 0.4058899467484266, 'support': 58055}, '1': {'precision': 0.3753945560548108, 'recall': 0.3073158126738513, 'f1-score': 0.3379608347890043, 'support': 65789}, '2': {'precision': 0.4236449164904689, 'recall': 0.45417325601827446, 'f1-score': 0.4383782362768294, 'support': 56910}, 'accuracy': 0.39400511192006815, 'macro avg': {'precision': 0.3936035802213238, 'recall': 0.3982502103345756, 'f1-score': 0.3940763392714201, 'support': 180754}, 'weighted avg': {'precision': 0.392634163650006, 'recall': 0.39400511192006815, 'f1-score': 0.39139466703325004, 'support': 180754}}
[[25153 18614 14288]
 [24695 20218 20876]
 [16037 15026 25847]]
training model: results/ATVI/W4/deepLOB_L1/h100
Epoch 1/50
1972/1972 - 31s - loss: 3.2128 - accuracy100: 0.4202 - val_loss: 3.4482 - val_accuracy100: 0.3461 - 31s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 30s - loss: 3.1872 - accuracy100: 0.4278 - val_loss: 3.5071 - val_accuracy100: 0.3453 - 30s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.1596 - accuracy100: 0.4405 - val_loss: 3.4135 - val_accuracy100: 0.3337 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.1385 - accuracy100: 0.4489 - val_loss: 3.4515 - val_accuracy100: 0.3362 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 3.1222 - accuracy100: 0.4537 - val_loss: 3.4125 - val_accuracy100: 0.3360 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 3.1113 - accuracy100: 0.4585 - val_loss: 3.4833 - val_accuracy100: 0.3305 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 3.1032 - accuracy100: 0.4618 - val_loss: 3.4706 - val_accuracy100: 0.3343 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 3.0954 - accuracy100: 0.4637 - val_loss: 3.4983 - val_accuracy100: 0.3272 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 3.0900 - accuracy100: 0.4658 - val_loss: 3.4438 - val_accuracy100: 0.3365 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 30s - loss: 3.0867 - accuracy100: 0.4672 - val_loss: 3.4354 - val_accuracy100: 0.3425 - 30s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 3.0801 - accuracy100: 0.4693 - val_loss: 3.4320 - val_accuracy100: 0.3386 - 29s/epoch - 15ms/step
Epoch 12/50
1972/1972 - 29s - loss: 3.0772 - accuracy100: 0.4698 - val_loss: 3.4467 - val_accuracy100: 0.3395 - 29s/epoch - 15ms/step
Epoch 13/50
1972/1972 - 29s - loss: 3.0748 - accuracy100: 0.4705 - val_loss: 3.4453 - val_accuracy100: 0.3456 - 29s/epoch - 15ms/step
Epoch 14/50
1972/1972 - 29s - loss: 3.0701 - accuracy100: 0.4724 - val_loss: 3.4666 - val_accuracy100: 0.3369 - 29s/epoch - 15ms/step
Epoch 15/50
1972/1972 - 30s - loss: 3.0675 - accuracy100: 0.4729 - val_loss: 3.4553 - val_accuracy100: 0.3428 - 30s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h100
Evaluating performance on  test set...
4274/4274 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.201159
{'0': {'precision': 0.3625724476148016, 'recall': 0.44406910913156894, 'f1-score': 0.39920389040551835, 'support': 402899}, '1': {'precision': 0.25943427780455464, 'recall': 0.5272014946182589, 'f1-score': 0.3477445186417336, 'support': 286896}, '2': {'precision': 0.449085123309467, 'recall': 0.019548816385089172, 'f1-score': 0.037466695743692345, 'support': 404270}, 'accuracy': 0.3090035783979928, 'macro avg': {'precision': 0.3570306162429411, 'recall': 0.3302731400449724, 'f1-score': 0.26147170159698147, 'support': 1094065}, 'weighted avg': {'precision': 0.3674940482849645, 'recall': 0.3090035783979928, 'f1-score': 0.2520435447153819, 'support': 1094065}}
[[178915 217907   6077]
 [132026 151252   3618]
 [182519 213848   7903]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1560735
{'0': {'precision': 0.34274054021046635, 'recall': 0.40388570743261476, 'f1-score': 0.370809373460214, 'support': 166765}, '1': {'precision': 0.33999404654768994, 'recall': 0.5894067949164137, 'f1-score': 0.4312343874159829, 'support': 166654}, '2': {'precision': 0.48908958028816035, 'recall': 0.05473793679634963, 'f1-score': 0.09845678525827961, 'support': 171161}, 'accuracy': 0.34672400808593284, 'macro avg': {'precision': 0.3906080556821055, 'recall': 0.349343479715126, 'f1-score': 0.3001668487114922, 'support': 504580}, 'weighted avg': {'precision': 0.3914771803742894, 'recall': 0.34672400808593284, 'f1-score': 0.29838067816225017, 'support': 504580}}
[[67354 94857  4554]
 [63194 98227  5233]
 [65968 95824  9369]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1404059
{'0': {'precision': 0.35065724648315477, 'recall': 0.26930074546362043, 'f1-score': 0.30464082762640243, 'support': 62109}, '1': {'precision': 0.31472683072461294, 'recall': 0.6484990157480315, 'f1-score': 0.4237843922104622, 'support': 56896}, '2': {'precision': 0.46599241466498104, 'recall': 0.11938654877002057, 'f1-score': 0.19007593239567352, 'support': 61749}, 'accuracy': 0.33744758068977726, 'macro avg': {'precision': 0.3771254972909162, 'recall': 0.34572876999389085, 'f1-score': 0.3061670507441794, 'support': 180754}, 'weighted avg': {'precision': 0.378748101264026, 'recall': 0.33744758068977726, 'f1-score': 0.303006144769992, 'support': 180754}}
[[16726 40995  4388]
 [15939 36897  4060]
 [15034 39343  7372]]
training model: results/ATVI/W4/deepLOB_L1/h200
Epoch 1/50
1972/1972 - 32s - loss: 3.2611 - accuracy200: 0.3929 - val_loss: 3.3477 - val_accuracy200: 0.3340 - 32s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 29s - loss: 3.2339 - accuracy200: 0.4059 - val_loss: 3.3669 - val_accuracy200: 0.3526 - 29s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.2242 - accuracy200: 0.4125 - val_loss: 3.4328 - val_accuracy200: 0.3448 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.2137 - accuracy200: 0.4177 - val_loss: 3.4446 - val_accuracy200: 0.3422 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 3.2041 - accuracy200: 0.4226 - val_loss: 3.4523 - val_accuracy200: 0.3446 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 3.1982 - accuracy200: 0.4250 - val_loss: 3.4161 - val_accuracy200: 0.3453 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 30s - loss: 3.1928 - accuracy200: 0.4270 - val_loss: 3.4553 - val_accuracy200: 0.3449 - 30s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 3.1889 - accuracy200: 0.4286 - val_loss: 3.4239 - val_accuracy200: 0.3434 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 3.1863 - accuracy200: 0.4299 - val_loss: 3.3891 - val_accuracy200: 0.3436 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 3.1845 - accuracy200: 0.4310 - val_loss: 3.4292 - val_accuracy200: 0.3396 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 30s - loss: 3.1819 - accuracy200: 0.4319 - val_loss: 3.4981 - val_accuracy200: 0.3392 - 30s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h200
Evaluating performance on  test set...
4274/4274 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1388016
{'0': {'precision': 0.3481102918855927, 'recall': 0.892605739569702, 'f1-score': 0.5008805184469164, 'support': 382851}, '1': {'precision': 0.27223456458582557, 'recall': 0.0695383751929283, 'f1-score': 0.11077968492711797, 'support': 320715}, '2': {'precision': 0.38099615851856716, 'recall': 0.02971582513655605, 'f1-score': 0.055131652714297937, 'support': 390499}, 'accuracy': 0.34334431683675104, 'macro avg': {'precision': 0.3337803383299951, 'recall': 0.3306199799663954, 'f1-score': 0.22226395202944413, 'support': 1094065}, 'weighted avg': {'precision': 0.33760581011656166, 'recall': 0.34334431683675104, 'f1-score': 0.22742722715067357, 'support': 1094065}}
[[341735  30750  10366]
 [289926  22302   8487]
 [350025  28870  11604]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1266508
{'0': {'precision': 0.33720453948998186, 'recall': 0.8294990376551367, 'f1-score': 0.47948912899423146, 'support': 165741}, '1': {'precision': 0.3477956738529971, 'recall': 0.11617290237546056, 'f1-score': 0.17416883356012736, 'support': 166915}, '2': {'precision': 0.3990271190563055, 'recall': 0.09542588585654126, 'f1-score': 0.15401874774102395, 'support': 171924}, 'accuracy': 0.34341234293868167, 'macro avg': {'precision': 0.3613424441330948, 'recall': 0.3470326086290461, 'f1-score': 0.26922557009846093, 'support': 504580}, 'weighted avg': {'precision': 0.3617727038277743, 'recall': 0.34341234293868167, 'f1-score': 0.26759268652929047, 'support': 504580}}
[[137482  18359   9900]
 [132715  19391  14809]
 [137514  18004  16406]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1180052
{'0': {'precision': 0.3374250232322379, 'recall': 0.6620859994032424, 'f1-score': 0.4470273537180463, 'support': 60326}, '1': {'precision': 0.3043322040858228, 'recall': 0.19610048123832047, 'f1-score': 0.2385123651101747, 'support': 60469}, '2': {'precision': 0.37327070879590096, 'recall': 0.1457996297469938, 'f1-score': 0.20969308818767315, 'support': 59959}, 'accuracy': 0.334935879703907, 'macro avg': {'precision': 0.3383426453713206, 'recall': 0.3346620367961856, 'f1-score': 0.29841093567196475, 'support': 180754}, 'weighted avg': {'precision': 0.3382448212989313, 'recall': 0.334935879703907, 'f1-score': 0.29854367937023085, 'support': 180754}}
[[39941 13740  6645]
 [40578 11858  8033]
 [37851 13366  8742]]
training model: results/ATVI/W4/deepLOB_L1/h300
Epoch 1/50
1972/1972 - 32s - loss: 3.2646 - accuracy300: 0.3896 - val_loss: 3.3735 - val_accuracy300: 0.3341 - 32s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 30s - loss: 3.2461 - accuracy300: 0.4011 - val_loss: 3.3439 - val_accuracy300: 0.3448 - 30s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.2292 - accuracy300: 0.4092 - val_loss: 3.3706 - val_accuracy300: 0.3320 - 29s/epoch - 14ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.2200 - accuracy300: 0.4148 - val_loss: 3.4099 - val_accuracy300: 0.3348 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 3.2163 - accuracy300: 0.4186 - val_loss: 3.4084 - val_accuracy300: 0.3356 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 3.2130 - accuracy300: 0.4196 - val_loss: 3.4113 - val_accuracy300: 0.3341 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 3.2096 - accuracy300: 0.4223 - val_loss: 3.4458 - val_accuracy300: 0.3157 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 3.2077 - accuracy300: 0.4231 - val_loss: 3.4670 - val_accuracy300: 0.3268 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 3.2052 - accuracy300: 0.4235 - val_loss: 3.4131 - val_accuracy300: 0.3322 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 3.1978 - accuracy300: 0.4269 - val_loss: 3.5145 - val_accuracy300: 0.3126 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 3.1953 - accuracy300: 0.4283 - val_loss: 3.4069 - val_accuracy300: 0.3276 - 29s/epoch - 15ms/step
Epoch 12/50
1972/1972 - 29s - loss: 3.1919 - accuracy300: 0.4290 - val_loss: 3.5704 - val_accuracy300: 0.3130 - 29s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h300
Evaluating performance on  test set...
4274/4274 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1231395
{'0': {'precision': 0.2597538706562381, 'recall': 0.5681097042190081, 'f1-score': 0.35650486168689227, 'support': 299715}, '1': {'precision': 0.45381291569814275, 'recall': 0.3180160510925508, 'f1-score': 0.37396832094864096, 'support': 496041}, '2': {'precision': 0.3567972907595549, 'recall': 0.10877982226483278, 'f1-score': 0.1667278944245062, 'support': 298309}, 'accuracy': 0.32947768185619686, 'macro avg': {'precision': 0.35678802570464524, 'recall': 0.33163519252546386, 'f1-score': 0.2990670256866798, 'support': 1094065}, 'weighted avg': {'precision': 0.3741987787460058, 'recall': 0.32947768185619686, 'f1-score': 0.3126778628052737, 'support': 1094065}}
[[170271  96876  32568]
 [312362 157749  25930]
 [172876  92983  32450]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1421103
{'0': {'precision': 0.3298204231964078, 'recall': 0.6052267272804213, 'f1-score': 0.4269648545950026, 'support': 165419}, '1': {'precision': 0.33960567130777186, 'recall': 0.2881063673832326, 'f1-score': 0.31174344372066415, 'support': 166442}, '2': {'precision': 0.37756347044174426, 'recall': 0.1307904747016831, 'f1-score': 0.19428079982799398, 'support': 172719}, 'accuracy': 0.3382199056641167, 'macro avg': {'precision': 0.3489965216486413, 'recall': 0.341374523121779, 'f1-score': 0.3109963660478869, 'support': 504580}, 'weighted avg': {'precision': 0.3493907740690522, 'recall': 0.3382199056641167, 'f1-score': 0.3093093008194871, 'support': 504580}}
[[100116  45829  19474]
 [100722  47953  17767]
 [102709  47420  22590]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1154683
{'0': {'precision': 0.30249858392598655, 'recall': 0.41338264384622003, 'f1-score': 0.3493531036487862, 'support': 58135}, '1': {'precision': 0.4172167879342746, 'recall': 0.2627968738144017, 'f1-score': 0.3224737199839853, 'support': 65895}, '2': {'precision': 0.3518385365282678, 'recall': 0.3709364642831958, 'f1-score': 0.36113518755309926, 'support': 56724}, 'accuracy': 0.345165252221251, 'macro avg': {'precision': 0.3571846361295097, 'recall': 0.3490386606479392, 'f1-score': 0.3443206703952903, 'support': 180754}, 'weighted avg': {'precision': 0.3598036257205689, 'recall': 0.345165252221251, 'f1-score': 0.34325149561132196, 'support': 180754}}
[[24032 12231 21872]
 [31688 17317 16890]
 [23725 11958 21041]]
training model: results/ATVI/W4/deepLOB_L1/h500
Epoch 1/50
1972/1972 - 32s - loss: 3.2258 - accuracy500: 0.4214 - val_loss: 3.3794 - val_accuracy500: 0.3524 - 32s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 29s - loss: 3.1923 - accuracy500: 0.4359 - val_loss: 3.4723 - val_accuracy500: 0.3506 - 29s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.1715 - accuracy500: 0.4449 - val_loss: 3.4678 - val_accuracy500: 0.3542 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.1636 - accuracy500: 0.4488 - val_loss: 3.5041 - val_accuracy500: 0.3590 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 29s - loss: 3.1560 - accuracy500: 0.4515 - val_loss: 3.5864 - val_accuracy500: 0.3358 - 29s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 3.1523 - accuracy500: 0.4516 - val_loss: 3.5658 - val_accuracy500: 0.3528 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 3.1448 - accuracy500: 0.4546 - val_loss: 3.6049 - val_accuracy500: 0.3792 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 3.1349 - accuracy500: 0.4593 - val_loss: 3.6381 - val_accuracy500: 0.3754 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 3.1251 - accuracy500: 0.4623 - val_loss: 3.6390 - val_accuracy500: 0.3748 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 3.1213 - accuracy500: 0.4645 - val_loss: 3.4952 - val_accuracy500: 0.4055 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 29s - loss: 3.1152 - accuracy500: 0.4670 - val_loss: 3.7539 - val_accuracy500: 0.3491 - 29s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h500
Evaluating performance on  test set...
4274/4274 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1849494
{'0': {'precision': 0.3073532878384145, 'recall': 0.5947913959867186, 'f1-score': 0.4052810916302056, 'support': 346350}, '1': {'precision': 0.37060759116575714, 'recall': 0.27529220060753584, 'f1-score': 0.3159170528721569, 'support': 397672}, '2': {'precision': 0.35669841368730093, 'recall': 0.13085249526486745, 'f1-score': 0.19146668227248595, 'support': 350043}, 'accuracy': 0.33022352419646, 'macro avg': {'precision': 0.3448864308971575, 'recall': 0.3336453639530406, 'f1-score': 0.3042216089249495, 'support': 1094065}, 'weighted avg': {'precision': 0.3461328678453727, 'recall': 0.33022352419646, 'f1-score': 0.3043896333386096, 'support': 1094065}}
[[206006  92401  47943]
 [253532 109476  34664]
 [210720  93519  45804]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1665576
{'0': {'precision': 0.3285073218517478, 'recall': 0.5507393386104419, 'f1-score': 0.41153845286194146, 'support': 165621}, '1': {'precision': 0.3483960076095171, 'recall': 0.32024049776329894, 'f1-score': 0.333725454709981, 'support': 166987}, '2': {'precision': 0.39721624492686514, 'recall': 0.16959737631707486, 'f1-score': 0.23770364876649358, 'support': 171972}, 'accuracy': 0.3445558682468588, 'macro avg': {'precision': 0.35803985812937666, 'recall': 0.34685907089693857, 'f1-score': 0.3276558521128054, 'support': 504580}, 'weighted avg': {'precision': 0.35850685193162946, 'recall': 0.3445558682468588, 'f1-score': 0.32654008183593214, 'support': 504580}}
[[91214 48869 25538]
 [94789 53476 18722]
 [91659 51147 29166]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273264
{'0': {'precision': 0.2905979025741136, 'recall': 0.3187008331397086, 'f1-score': 0.3040012664740571, 'support': 60254}, '1': {'precision': 0.41422883052915044, 'recall': 0.28719380834596664, 'f1-score': 0.3392076296743064, 'support': 62665}, '2': {'precision': 0.37195686968241937, 'recall': 0.45807901789573785, 'f1-score': 0.4105500499763678, 'support': 57835}, 'accuracy': 0.3523739446983193, 'macro avg': {'precision': 0.3589278675952278, 'recall': 0.35465788646047103, 'f1-score': 0.35125298204157707, 'support': 180754}, 'weighted avg': {'precision': 0.3594911384804352, 'recall': 0.3523739446983193, 'f1-score': 0.3502987516959596, 'support': 180754}}
[[19203 12738 28313]
 [28248 17997 16420]
 [18630 12712 26493]]
training model: results/ATVI/W4/deepLOB_L1/h1000
Epoch 1/50
1972/1972 - 32s - loss: 3.2319 - accuracy1000: 0.4150 - val_loss: 3.8791 - val_accuracy1000: 0.3197 - 32s/epoch - 16ms/step
Epoch 2/50
1972/1972 - 29s - loss: 3.1764 - accuracy1000: 0.4401 - val_loss: 3.7890 - val_accuracy1000: 0.3388 - 29s/epoch - 15ms/step
Epoch 3/50
1972/1972 - 29s - loss: 3.1516 - accuracy1000: 0.4463 - val_loss: 4.0118 - val_accuracy1000: 0.3296 - 29s/epoch - 15ms/step
Epoch 4/50
1972/1972 - 29s - loss: 3.1256 - accuracy1000: 0.4578 - val_loss: 3.9251 - val_accuracy1000: 0.3299 - 29s/epoch - 15ms/step
Epoch 5/50
1972/1972 - 30s - loss: 3.1085 - accuracy1000: 0.4640 - val_loss: 3.9382 - val_accuracy1000: 0.3247 - 30s/epoch - 15ms/step
Epoch 6/50
1972/1972 - 29s - loss: 3.0953 - accuracy1000: 0.4683 - val_loss: 3.7822 - val_accuracy1000: 0.2921 - 29s/epoch - 15ms/step
Epoch 7/50
1972/1972 - 29s - loss: 3.0840 - accuracy1000: 0.4720 - val_loss: 3.8869 - val_accuracy1000: 0.2960 - 29s/epoch - 15ms/step
Epoch 8/50
1972/1972 - 29s - loss: 3.0688 - accuracy1000: 0.4771 - val_loss: 3.8269 - val_accuracy1000: 0.3149 - 29s/epoch - 15ms/step
Epoch 9/50
1972/1972 - 29s - loss: 3.0684 - accuracy1000: 0.4774 - val_loss: 3.8300 - val_accuracy1000: 0.3316 - 29s/epoch - 15ms/step
Epoch 10/50
1972/1972 - 29s - loss: 3.0577 - accuracy1000: 0.4795 - val_loss: 3.8528 - val_accuracy1000: 0.3276 - 29s/epoch - 15ms/step
Epoch 11/50
1972/1972 - 30s - loss: 3.0510 - accuracy1000: 0.4819 - val_loss: 4.0022 - val_accuracy1000: 0.3110 - 30s/epoch - 15ms/step
Epoch 12/50
1972/1972 - 29s - loss: 3.0437 - accuracy1000: 0.4840 - val_loss: 3.9672 - val_accuracy1000: 0.3106 - 29s/epoch - 15ms/step
Epoch 13/50
1972/1972 - 29s - loss: 3.0384 - accuracy1000: 0.4863 - val_loss: 4.0451 - val_accuracy1000: 0.3119 - 29s/epoch - 15ms/step
Epoch 14/50
1972/1972 - 29s - loss: 3.0310 - accuracy1000: 0.4875 - val_loss: 3.9016 - val_accuracy1000: 0.3187 - 29s/epoch - 15ms/step
Epoch 15/50
1972/1972 - 29s - loss: 3.0240 - accuracy1000: 0.4896 - val_loss: 3.8906 - val_accuracy1000: 0.3279 - 29s/epoch - 15ms/step
Epoch 16/50
1972/1972 - 30s - loss: 3.0231 - accuracy1000: 0.4902 - val_loss: 3.9036 - val_accuracy1000: 0.3246 - 30s/epoch - 15ms/step
testing model: results/ATVI/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2837272
{'0': {'precision': 0.3501034265279513, 'recall': 0.8256058278662838, 'f1-score': 0.49169882471727044, 'support': 389302}, '1': {'precision': 0.2401143302224015, 'recall': 0.11171508721522797, 'f1-score': 0.15248522160417086, 'support': 309063}, '2': {'precision': 0.4118158123370982, 'recall': 0.03354056103108415, 'f1-score': 0.062029126395094496, 'support': 395700}, 'accuracy': 0.33746532427232384, 'macro avg': {'precision': 0.33401118969581695, 'recall': 0.32362049203753196, 'f1-score': 0.23540439090551193, 'support': 1094065}, 'weighted avg': {'precision': 0.34135260367299963, 'recall': 0.33746532427232384, 'f1-score': 0.2404718195164561, 'support': 1094065}}
[[321410  54142  13750]
 [269330  34527   5206]
 [327303  55125  13272]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2743133
{'0': {'precision': 0.3221699232940172, 'recall': 0.8304284407525526, 'f1-score': 0.46423641643761787, 'support': 161796}, '1': {'precision': 0.32826382153249273, 'recall': 0.1487927406165552, 'f1-score': 0.20476931888769676, 'support': 170593}, '2': {'precision': 0.4788401253918495, 'recall': 0.02838708178708527, 'f1-score': 0.053596785070093585, 'support': 172191}, 'accuracy': 0.32627333624004123, 'macro avg': {'precision': 0.3764246234061199, 'recall': 0.33586942105206435, 'f1-score': 0.24086750679846938, 'support': 504580}, 'weighted avg': {'precision': 0.37769486513004735, 'recall': 0.32627333624004123, 'f1-score': 0.23638014124411225, 'support': 504580}}
[[134360  24676   2760]
 [142650  25383   2560]
 [140037  27266   4888]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2654204
{'0': {'precision': 0.32123114233745853, 'recall': 0.566896920680377, 'f1-score': 0.41008713270236585, 'support': 63553}, '1': {'precision': 0.23157649671376637, 'recall': 0.22645441490665827, 'f1-score': 0.22898681612523353, 'support': 57102}, '2': {'precision': 0.32220393447762363, 'recall': 0.06840380039601325, 'f1-score': 0.11284965274918335, 'support': 60099}, 'accuracy': 0.29360346105756996, 'macro avg': {'precision': 0.29167052450961617, 'recall': 0.2872517119943495, 'f1-score': 0.25064120052559424, 'support': 180754}, 'weighted avg': {'precision': 0.2932317855344429, 'recall': 0.29360346105756996, 'f1-score': 0.2540470694955006, 'support': 180754}}
[[36028 22206  5319]
 [40842 12931  3329]
 [35286 20702  4111]]
training model: results/ATVI/W4/deepOF_L1/h10
Epoch 1/50
1972/1972 - 28s - loss: 3.1451 - accuracy10: 0.4060 - val_loss: 3.1795 - val_accuracy10: 0.2332 - 28s/epoch - 14ms/step
Epoch 2/50
1972/1972 - 27s - loss: 3.1028 - accuracy10: 0.4015 - val_loss: 3.1598 - val_accuracy10: 0.2617 - 27s/epoch - 14ms/step
Epoch 3/50
1972/1972 - 27s - loss: 3.0843 - accuracy10: 0.4086 - val_loss: 3.1471 - val_accuracy10: 0.2942 - 27s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.0707 - accuracy10: 0.4155 - val_loss: 3.1403 - val_accuracy10: 0.3076 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 27s - loss: 3.0589 - accuracy10: 0.4206 - val_loss: 3.1354 - val_accuracy10: 0.3223 - 27s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.0478 - accuracy10: 0.4250 - val_loss: 3.1304 - val_accuracy10: 0.3245 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 27s - loss: 3.0364 - accuracy10: 0.4320 - val_loss: 3.1290 - val_accuracy10: 0.3355 - 27s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 27s - loss: 3.0277 - accuracy10: 0.4361 - val_loss: 3.1381 - val_accuracy10: 0.3396 - 27s/epoch - 14ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.0191 - accuracy10: 0.4402 - val_loss: 3.1313 - val_accuracy10: 0.3446 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.0104 - accuracy10: 0.4438 - val_loss: 3.1279 - val_accuracy10: 0.3467 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.0017 - accuracy10: 0.4494 - val_loss: 3.1242 - val_accuracy10: 0.3551 - 26s/epoch - 13ms/step
Epoch 12/50
1972/1972 - 26s - loss: 2.9940 - accuracy10: 0.4525 - val_loss: 3.1260 - val_accuracy10: 0.3533 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 2.9856 - accuracy10: 0.4571 - val_loss: 3.1193 - val_accuracy10: 0.3639 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 2.9786 - accuracy10: 0.4605 - val_loss: 3.1226 - val_accuracy10: 0.3547 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 27s - loss: 2.9703 - accuracy10: 0.4640 - val_loss: 3.1219 - val_accuracy10: 0.3707 - 27s/epoch - 14ms/step
Epoch 16/50
1972/1972 - 26s - loss: 2.9641 - accuracy10: 0.4663 - val_loss: 3.1190 - val_accuracy10: 0.3744 - 26s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 26s - loss: 2.9556 - accuracy10: 0.4694 - val_loss: 3.1228 - val_accuracy10: 0.3731 - 26s/epoch - 13ms/step
Epoch 18/50
1972/1972 - 27s - loss: 2.9506 - accuracy10: 0.4714 - val_loss: 3.1119 - val_accuracy10: 0.3605 - 27s/epoch - 14ms/step
Epoch 19/50
1972/1972 - 27s - loss: 2.9424 - accuracy10: 0.4742 - val_loss: 3.1102 - val_accuracy10: 0.3624 - 27s/epoch - 13ms/step
Epoch 20/50
1972/1972 - 26s - loss: 2.9362 - accuracy10: 0.4754 - val_loss: 3.1094 - val_accuracy10: 0.3683 - 26s/epoch - 13ms/step
Epoch 21/50
1972/1972 - 26s - loss: 2.9300 - accuracy10: 0.4772 - val_loss: 3.1021 - val_accuracy10: 0.3672 - 26s/epoch - 13ms/step
Epoch 22/50
1972/1972 - 26s - loss: 2.9247 - accuracy10: 0.4794 - val_loss: 3.1055 - val_accuracy10: 0.3700 - 26s/epoch - 13ms/step
Epoch 23/50
1972/1972 - 26s - loss: 2.9175 - accuracy10: 0.4806 - val_loss: 3.1012 - val_accuracy10: 0.3561 - 26s/epoch - 13ms/step
Epoch 24/50
1972/1972 - 26s - loss: 2.9119 - accuracy10: 0.4825 - val_loss: 3.1016 - val_accuracy10: 0.3773 - 26s/epoch - 13ms/step
Epoch 25/50
1972/1972 - 26s - loss: 2.9058 - accuracy10: 0.4849 - val_loss: 3.0981 - val_accuracy10: 0.3676 - 26s/epoch - 13ms/step
Epoch 26/50
1972/1972 - 26s - loss: 2.9007 - accuracy10: 0.4863 - val_loss: 3.0984 - val_accuracy10: 0.3593 - 26s/epoch - 13ms/step
Epoch 27/50
1972/1972 - 26s - loss: 2.8965 - accuracy10: 0.4882 - val_loss: 3.0967 - val_accuracy10: 0.3716 - 26s/epoch - 13ms/step
Epoch 28/50
1972/1972 - 26s - loss: 2.8911 - accuracy10: 0.4888 - val_loss: 3.0971 - val_accuracy10: 0.3792 - 26s/epoch - 13ms/step
Epoch 29/50
1972/1972 - 26s - loss: 2.8868 - accuracy10: 0.4905 - val_loss: 3.0997 - val_accuracy10: 0.3755 - 26s/epoch - 13ms/step
Epoch 30/50
1972/1972 - 26s - loss: 2.8795 - accuracy10: 0.4929 - val_loss: 3.0979 - val_accuracy10: 0.3730 - 26s/epoch - 13ms/step
Epoch 31/50
1972/1972 - 26s - loss: 2.8758 - accuracy10: 0.4939 - val_loss: 3.0961 - val_accuracy10: 0.3926 - 26s/epoch - 13ms/step
Epoch 32/50
1972/1972 - 26s - loss: 2.8733 - accuracy10: 0.4943 - val_loss: 3.0903 - val_accuracy10: 0.3895 - 26s/epoch - 13ms/step
Epoch 33/50
1972/1972 - 26s - loss: 2.8685 - accuracy10: 0.4957 - val_loss: 3.0873 - val_accuracy10: 0.3830 - 26s/epoch - 13ms/step
Epoch 34/50
1972/1972 - 26s - loss: 2.8609 - accuracy10: 0.4977 - val_loss: 3.0904 - val_accuracy10: 0.3834 - 26s/epoch - 13ms/step
Epoch 35/50
1972/1972 - 26s - loss: 2.8607 - accuracy10: 0.4979 - val_loss: 3.0869 - val_accuracy10: 0.3898 - 26s/epoch - 13ms/step
Epoch 36/50
1972/1972 - 27s - loss: 2.8562 - accuracy10: 0.4988 - val_loss: 3.0902 - val_accuracy10: 0.4096 - 27s/epoch - 14ms/step
Epoch 37/50
1972/1972 - 26s - loss: 2.8497 - accuracy10: 0.5010 - val_loss: 3.0831 - val_accuracy10: 0.3850 - 26s/epoch - 13ms/step
Epoch 38/50
1972/1972 - 26s - loss: 2.8461 - accuracy10: 0.5018 - val_loss: 3.0814 - val_accuracy10: 0.4043 - 26s/epoch - 13ms/step
Epoch 39/50
1972/1972 - 27s - loss: 2.8400 - accuracy10: 0.5035 - val_loss: 3.0858 - val_accuracy10: 0.4039 - 27s/epoch - 13ms/step
Epoch 40/50
1972/1972 - 26s - loss: 2.8359 - accuracy10: 0.5039 - val_loss: 3.0771 - val_accuracy10: 0.4184 - 26s/epoch - 13ms/step
Epoch 41/50
1972/1972 - 26s - loss: 2.8331 - accuracy10: 0.5048 - val_loss: 3.0883 - val_accuracy10: 0.3858 - 26s/epoch - 13ms/step
Epoch 42/50
1972/1972 - 26s - loss: 2.8279 - accuracy10: 0.5066 - val_loss: 3.0763 - val_accuracy10: 0.4162 - 26s/epoch - 13ms/step
Epoch 43/50
1972/1972 - 26s - loss: 2.8259 - accuracy10: 0.5067 - val_loss: 3.0779 - val_accuracy10: 0.4308 - 26s/epoch - 13ms/step
Epoch 44/50
1972/1972 - 26s - loss: 2.8216 - accuracy10: 0.5076 - val_loss: 3.0802 - val_accuracy10: 0.4133 - 26s/epoch - 13ms/step
Epoch 45/50
1972/1972 - 26s - loss: 2.8198 - accuracy10: 0.5082 - val_loss: 3.0792 - val_accuracy10: 0.4137 - 26s/epoch - 13ms/step
Epoch 46/50
1972/1972 - 26s - loss: 2.8152 - accuracy10: 0.5087 - val_loss: 3.0801 - val_accuracy10: 0.4423 - 26s/epoch - 13ms/step
Epoch 47/50
1972/1972 - 26s - loss: 2.8106 - accuracy10: 0.5103 - val_loss: 3.0834 - val_accuracy10: 0.4417 - 26s/epoch - 13ms/step
Epoch 48/50
1972/1972 - 27s - loss: 2.8090 - accuracy10: 0.5096 - val_loss: 3.0827 - val_accuracy10: 0.4480 - 27s/epoch - 14ms/step
Epoch 49/50
1972/1972 - 26s - loss: 2.8004 - accuracy10: 0.5121 - val_loss: 3.0730 - val_accuracy10: 0.4570 - 26s/epoch - 13ms/step
Epoch 50/50
1972/1972 - 26s - loss: 2.7989 - accuracy10: 0.5133 - val_loss: 3.0844 - val_accuracy10: 0.4663 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h10
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0551475
{'0': {'precision': 0.28064311214144905, 'recall': 0.5189571097288745, 'f1-score': 0.36428638801919316, 'support': 230705}, '1': {'precision': 0.6328221512247071, 'recall': 0.37401083537499746, 'f1-score': 0.4701521395771582, 'support': 635511}, '2': {'precision': 0.30904100764781667, 'recall': 0.39585244354714827, 'f1-score': 0.34710107698198744, 'support': 227845}, 'accuracy': 0.40912435412650666, 'macro avg': {'precision': 0.40750209033799095, 'recall': 0.42960679621700676, 'f1-score': 0.39384653485944626, 'support': 1094061}, 'weighted avg': {'precision': 0.4911286077477167, 'recall': 0.40912435412650666, 'f1-score': 0.42220204577966697, 'support': 1094061}}
[[119726  66408  44571]
 [240739 237688 157084]
 [ 66148  71504  90193]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0104663
{'0': {'precision': 0.26940174349338974, 'recall': 0.5910917654103477, 'f1-score': 0.3701158707611995, 'support': 86841}, '1': {'precision': 0.7678369943914535, 'recall': 0.42160456703526517, 'f1-score': 0.544328690155683, 'support': 330893}, '2': {'precision': 0.3071331968296903, 'recall': 0.46808608638577665, 'f1-score': 0.3709009288490666, 'support': 86843}, 'accuracy': 0.45877437933159854, 'macro avg': {'precision': 0.44812397823817784, 'recall': 0.4935941396104632, 'f1-score': 0.4284484965886497, 'support': 504577}, 'weighted avg': {'precision': 0.6027610683882965, 'recall': 0.45877437933159854, 'f1-score': 0.48449678635470356, 'support': 504577}}
[[ 51331  19394  16116]
 [115800 139506  75587]
 [ 23406  22787  40650]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.012411
{'0': {'precision': 0.2779435847988123, 'recall': 0.5665439570724402, 'f1-score': 0.37292973683399905, 'support': 32054}, '1': {'precision': 0.7477478816708786, 'recall': 0.4281482742477763, 'f1-score': 0.5445157099943168, 'support': 117485}, '2': {'precision': 0.28932228383907616, 'recall': 0.4462598109883069, 'f1-score': 0.3510496207252842, 'support': 31215}, 'accuracy': 0.4558184051251978, 'macro avg': {'precision': 0.43833791676958905, 'recall': 0.48031734743617444, 'f1-score': 0.42283168918453334, 'support': 180754}, 'weighted avg': {'precision': 0.5852681469581922, 'recall': 0.4558184051251978, 'f1-score': 0.4806772291849644, 'support': 180754}}
[[18160  7909  5985]
 [38952 50301 28232]
 [ 8225  9060 13930]]
training model: results/ATVI/W4/deepOF_L1/h20
Epoch 1/50
1972/1972 - 29s - loss: 3.1834 - accuracy20: 0.4077 - val_loss: 3.2349 - val_accuracy20: 0.2937 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 27s - loss: 3.1488 - accuracy20: 0.3978 - val_loss: 3.2118 - val_accuracy20: 0.3216 - 27s/epoch - 14ms/step
Epoch 3/50
1972/1972 - 26s - loss: 3.1310 - accuracy20: 0.4070 - val_loss: 3.2225 - val_accuracy20: 0.3032 - 26s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.1171 - accuracy20: 0.4159 - val_loss: 3.2156 - val_accuracy20: 0.3152 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.1061 - accuracy20: 0.4238 - val_loss: 3.2110 - val_accuracy20: 0.3145 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.0945 - accuracy20: 0.4293 - val_loss: 3.2143 - val_accuracy20: 0.3228 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 25s - loss: 3.0842 - accuracy20: 0.4368 - val_loss: 3.2111 - val_accuracy20: 0.3219 - 25s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.0746 - accuracy20: 0.4417 - val_loss: 3.2112 - val_accuracy20: 0.3276 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.0659 - accuracy20: 0.4468 - val_loss: 3.2089 - val_accuracy20: 0.3431 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.0576 - accuracy20: 0.4509 - val_loss: 3.2129 - val_accuracy20: 0.3411 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.0507 - accuracy20: 0.4547 - val_loss: 3.1988 - val_accuracy20: 0.3513 - 26s/epoch - 13ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.0424 - accuracy20: 0.4584 - val_loss: 3.1995 - val_accuracy20: 0.3497 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.0363 - accuracy20: 0.4618 - val_loss: 3.1922 - val_accuracy20: 0.3637 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 27s - loss: 3.0298 - accuracy20: 0.4653 - val_loss: 3.1828 - val_accuracy20: 0.3790 - 27s/epoch - 14ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.0217 - accuracy20: 0.4692 - val_loss: 3.1866 - val_accuracy20: 0.3688 - 26s/epoch - 13ms/step
Epoch 16/50
1972/1972 - 26s - loss: 3.0157 - accuracy20: 0.4711 - val_loss: 3.1773 - val_accuracy20: 0.3772 - 26s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 26s - loss: 3.0088 - accuracy20: 0.4736 - val_loss: 3.1767 - val_accuracy20: 0.3852 - 26s/epoch - 13ms/step
Epoch 18/50
1972/1972 - 26s - loss: 3.0026 - accuracy20: 0.4763 - val_loss: 3.1742 - val_accuracy20: 0.3904 - 26s/epoch - 13ms/step
Epoch 19/50
1972/1972 - 26s - loss: 2.9973 - accuracy20: 0.4782 - val_loss: 3.1689 - val_accuracy20: 0.3912 - 26s/epoch - 13ms/step
Epoch 20/50
1972/1972 - 26s - loss: 2.9895 - accuracy20: 0.4815 - val_loss: 3.1696 - val_accuracy20: 0.3879 - 26s/epoch - 13ms/step
Epoch 21/50
1972/1972 - 26s - loss: 2.9836 - accuracy20: 0.4838 - val_loss: 3.1580 - val_accuracy20: 0.4068 - 26s/epoch - 13ms/step
Epoch 22/50
1972/1972 - 27s - loss: 2.9774 - accuracy20: 0.4863 - val_loss: 3.1578 - val_accuracy20: 0.4007 - 27s/epoch - 14ms/step
Epoch 23/50
1972/1972 - 26s - loss: 2.9718 - accuracy20: 0.4881 - val_loss: 3.1498 - val_accuracy20: 0.4161 - 26s/epoch - 13ms/step
Epoch 24/50
1972/1972 - 26s - loss: 2.9657 - accuracy20: 0.4902 - val_loss: 3.1525 - val_accuracy20: 0.4169 - 26s/epoch - 13ms/step
Epoch 25/50
1972/1972 - 27s - loss: 2.9596 - accuracy20: 0.4910 - val_loss: 3.1456 - val_accuracy20: 0.4218 - 27s/epoch - 14ms/step
Epoch 26/50
1972/1972 - 26s - loss: 2.9546 - accuracy20: 0.4929 - val_loss: 3.1405 - val_accuracy20: 0.4349 - 26s/epoch - 13ms/step
Epoch 27/50
1972/1972 - 26s - loss: 2.9492 - accuracy20: 0.4943 - val_loss: 3.1410 - val_accuracy20: 0.4365 - 26s/epoch - 13ms/step
Epoch 28/50
1972/1972 - 26s - loss: 2.9437 - accuracy20: 0.4955 - val_loss: 3.1373 - val_accuracy20: 0.4441 - 26s/epoch - 13ms/step
Epoch 29/50
1972/1972 - 26s - loss: 2.9401 - accuracy20: 0.4977 - val_loss: 3.1383 - val_accuracy20: 0.4519 - 26s/epoch - 13ms/step
Epoch 30/50
1972/1972 - 26s - loss: 2.9351 - accuracy20: 0.4988 - val_loss: 3.1405 - val_accuracy20: 0.4526 - 26s/epoch - 13ms/step
Epoch 31/50
1972/1972 - 26s - loss: 2.9305 - accuracy20: 0.5001 - val_loss: 3.1431 - val_accuracy20: 0.4377 - 26s/epoch - 13ms/step
Epoch 32/50
1972/1972 - 26s - loss: 2.9253 - accuracy20: 0.5015 - val_loss: 3.1416 - val_accuracy20: 0.4543 - 26s/epoch - 13ms/step
Epoch 33/50
1972/1972 - 26s - loss: 2.9216 - accuracy20: 0.5038 - val_loss: 3.1394 - val_accuracy20: 0.4428 - 26s/epoch - 13ms/step
Epoch 34/50
1972/1972 - 26s - loss: 2.9165 - accuracy20: 0.5036 - val_loss: 3.1320 - val_accuracy20: 0.4549 - 26s/epoch - 13ms/step
Epoch 35/50
1972/1972 - 26s - loss: 2.9139 - accuracy20: 0.5047 - val_loss: 3.1406 - val_accuracy20: 0.4509 - 26s/epoch - 13ms/step
Epoch 36/50
1972/1972 - 26s - loss: 2.9096 - accuracy20: 0.5051 - val_loss: 3.1383 - val_accuracy20: 0.4483 - 26s/epoch - 13ms/step
Epoch 37/50
1972/1972 - 26s - loss: 2.9046 - accuracy20: 0.5075 - val_loss: 3.1444 - val_accuracy20: 0.4642 - 26s/epoch - 13ms/step
Epoch 38/50
1972/1972 - 26s - loss: 2.9003 - accuracy20: 0.5086 - val_loss: 3.1367 - val_accuracy20: 0.4607 - 26s/epoch - 13ms/step
Epoch 39/50
1972/1972 - 26s - loss: 2.8968 - accuracy20: 0.5091 - val_loss: 3.1297 - val_accuracy20: 0.4542 - 26s/epoch - 13ms/step
Epoch 40/50
1972/1972 - 26s - loss: 2.8934 - accuracy20: 0.5101 - val_loss: 3.1395 - val_accuracy20: 0.4567 - 26s/epoch - 13ms/step
Epoch 41/50
1972/1972 - 26s - loss: 2.8894 - accuracy20: 0.5111 - val_loss: 3.1426 - val_accuracy20: 0.4643 - 26s/epoch - 13ms/step
Epoch 42/50
1972/1972 - 27s - loss: 2.8850 - accuracy20: 0.5118 - val_loss: 3.1534 - val_accuracy20: 0.4741 - 27s/epoch - 14ms/step
Epoch 43/50
1972/1972 - 26s - loss: 2.8833 - accuracy20: 0.5117 - val_loss: 3.1448 - val_accuracy20: 0.4532 - 26s/epoch - 13ms/step
Epoch 44/50
1972/1972 - 26s - loss: 2.8769 - accuracy20: 0.5143 - val_loss: 3.1506 - val_accuracy20: 0.4730 - 26s/epoch - 13ms/step
Epoch 45/50
1972/1972 - 26s - loss: 2.8744 - accuracy20: 0.5148 - val_loss: 3.1455 - val_accuracy20: 0.4639 - 26s/epoch - 13ms/step
Epoch 46/50
1972/1972 - 26s - loss: 2.8679 - accuracy20: 0.5165 - val_loss: 3.1605 - val_accuracy20: 0.4725 - 26s/epoch - 13ms/step
Epoch 47/50
1972/1972 - 26s - loss: 2.8668 - accuracy20: 0.5169 - val_loss: 3.1555 - val_accuracy20: 0.4757 - 26s/epoch - 13ms/step
Epoch 48/50
1972/1972 - 26s - loss: 2.8633 - accuracy20: 0.5173 - val_loss: 3.1530 - val_accuracy20: 0.4807 - 26s/epoch - 13ms/step
Epoch 49/50
1972/1972 - 26s - loss: 2.8594 - accuracy20: 0.5181 - val_loss: 3.1563 - val_accuracy20: 0.4785 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h20
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684758
{'0': {'precision': 0.3447058339673857, 'recall': 0.5627975530979097, 'f1-score': 0.4275457318628401, 'support': 297846}, '1': {'precision': 0.5239816670023711, 'recall': 0.29440086406296223, 'f1-score': 0.37698912101127047, 'support': 503667}, '2': {'precision': 0.3697934627321543, 'recall': 0.4105411761488713, 'f1-score': 0.38910343218883847, 'support': 292548}, 'accuracy': 0.39852439672010975, 'macro avg': {'precision': 0.41282698790063704, 'recall': 0.4225798644365811, 'f1-score': 0.39787942835431633, 'support': 1094061}, 'weighted avg': {'precision': 0.43394643080532025, 'recall': 0.39852439672010975, 'f1-score': 0.39399192233777036, 'support': 1094061}}
[[167627  64127  66092]
 [216798 148280 138589]
 [101865  70580 120103]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0194117
{'0': {'precision': 0.33286471462736733, 'recall': 0.5474380780270012, 'f1-score': 0.414000321569258, 'support': 112884}, '1': {'precision': 0.6774101005843023, 'recall': 0.4153104517685234, 'f1-score': 0.5149267016172819, 'support': 278594}, '2': {'precision': 0.35725714440026196, 'recall': 0.46789096278481684, 'f1-score': 0.4051572991555076, 'support': 113099}, 'accuracy': 0.45665577305346855, 'macro avg': {'precision': 0.4558439865373105, 'recall': 0.4768798308601138, 'f1-score': 0.44469477411401587, 'support': 504577}, 'weighted avg': {'precision': 0.5285673262608166, 'recall': 0.45665577305346855, 'f1-score': 0.4677430544546777, 'support': 504577}}
[[ 61797  26330  24757]
 [ 92443 115703  70448]
 [ 31412  28769  52918]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0230595
{'0': {'precision': 0.3486076275001608, 'recall': 0.5154403898728159, 'f1-score': 0.41591774489022737, 'support': 42065}, '1': {'precision': 0.6503699541069589, 'recall': 0.4274633725940822, 'f1-score': 0.5158670216058937, 'support': 97468}, '2': {'precision': 0.3481172930123312, 'recall': 0.4602265835375173, 'f1-score': 0.3963977140946749, 'support': 41221}, 'accuracy': 0.455409008929263, 'macro avg': {'precision': 0.4490316248731503, 'recall': 0.4677101153348051, 'f1-score': 0.44272749353026536, 'support': 180754}, 'weighted avg': {'precision': 0.5112151403175179, 'recall': 0.455409008929263, 'f1-score': 0.4653618562985453, 'support': 180754}}
[[21682 11040  9343]
 [29622 41664 26182]
 [10892 11358 18971]]
training model: results/ATVI/W4/deepOF_L1/h30
Epoch 1/50
1972/1972 - 29s - loss: 3.2107 - accuracy30: 0.4087 - val_loss: 3.2475 - val_accuracy30: 0.3372 - 29s/epoch - 14ms/step
Epoch 2/50
1972/1972 - 26s - loss: 3.1790 - accuracy30: 0.4046 - val_loss: 3.2375 - val_accuracy30: 0.3461 - 26s/epoch - 13ms/step
Epoch 3/50
1972/1972 - 26s - loss: 3.1631 - accuracy30: 0.4142 - val_loss: 3.2443 - val_accuracy30: 0.3504 - 26s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.1483 - accuracy30: 0.4227 - val_loss: 3.2479 - val_accuracy30: 0.3573 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.1369 - accuracy30: 0.4284 - val_loss: 3.2403 - val_accuracy30: 0.3614 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 27s - loss: 3.1246 - accuracy30: 0.4358 - val_loss: 3.2411 - val_accuracy30: 0.3654 - 27s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.1166 - accuracy30: 0.4411 - val_loss: 3.2377 - val_accuracy30: 0.3633 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.1079 - accuracy30: 0.4454 - val_loss: 3.2385 - val_accuracy30: 0.3721 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.1006 - accuracy30: 0.4493 - val_loss: 3.2377 - val_accuracy30: 0.3689 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.0937 - accuracy30: 0.4531 - val_loss: 3.2345 - val_accuracy30: 0.3789 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.0871 - accuracy30: 0.4563 - val_loss: 3.2398 - val_accuracy30: 0.3742 - 26s/epoch - 13ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.0812 - accuracy30: 0.4601 - val_loss: 3.2372 - val_accuracy30: 0.3772 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.0764 - accuracy30: 0.4613 - val_loss: 3.2367 - val_accuracy30: 0.3857 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.0702 - accuracy30: 0.4639 - val_loss: 3.2366 - val_accuracy30: 0.3821 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.0651 - accuracy30: 0.4665 - val_loss: 3.2361 - val_accuracy30: 0.3837 - 26s/epoch - 13ms/step
Epoch 16/50
1972/1972 - 25s - loss: 3.0595 - accuracy30: 0.4683 - val_loss: 3.2368 - val_accuracy30: 0.3855 - 25s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 25s - loss: 3.0553 - accuracy30: 0.4704 - val_loss: 3.2356 - val_accuracy30: 0.3909 - 25s/epoch - 13ms/step
Epoch 18/50
1972/1972 - 26s - loss: 3.0492 - accuracy30: 0.4729 - val_loss: 3.2386 - val_accuracy30: 0.3872 - 26s/epoch - 13ms/step
Epoch 19/50
1972/1972 - 26s - loss: 3.0444 - accuracy30: 0.4741 - val_loss: 3.2310 - val_accuracy30: 0.3970 - 26s/epoch - 13ms/step
Epoch 20/50
1972/1972 - 26s - loss: 3.0392 - accuracy30: 0.4764 - val_loss: 3.2319 - val_accuracy30: 0.3955 - 26s/epoch - 13ms/step
Epoch 21/50
1972/1972 - 26s - loss: 3.0340 - accuracy30: 0.4780 - val_loss: 3.2233 - val_accuracy30: 0.4042 - 26s/epoch - 13ms/step
Epoch 22/50
1972/1972 - 26s - loss: 3.0280 - accuracy30: 0.4802 - val_loss: 3.2233 - val_accuracy30: 0.4001 - 26s/epoch - 13ms/step
Epoch 23/50
1972/1972 - 26s - loss: 3.0231 - accuracy30: 0.4821 - val_loss: 3.2211 - val_accuracy30: 0.4061 - 26s/epoch - 13ms/step
Epoch 24/50
1972/1972 - 26s - loss: 3.0175 - accuracy30: 0.4837 - val_loss: 3.2166 - val_accuracy30: 0.4028 - 26s/epoch - 13ms/step
Epoch 25/50
1972/1972 - 26s - loss: 3.0119 - accuracy30: 0.4862 - val_loss: 3.2149 - val_accuracy30: 0.4095 - 26s/epoch - 13ms/step
Epoch 26/50
1972/1972 - 26s - loss: 3.0062 - accuracy30: 0.4875 - val_loss: 3.2104 - val_accuracy30: 0.4082 - 26s/epoch - 13ms/step
Epoch 27/50
1972/1972 - 26s - loss: 3.0029 - accuracy30: 0.4885 - val_loss: 3.2073 - val_accuracy30: 0.4145 - 26s/epoch - 13ms/step
Epoch 28/50
1972/1972 - 26s - loss: 2.9984 - accuracy30: 0.4901 - val_loss: 3.2108 - val_accuracy30: 0.4123 - 26s/epoch - 13ms/step
Epoch 29/50
1972/1972 - 26s - loss: 2.9934 - accuracy30: 0.4915 - val_loss: 3.2093 - val_accuracy30: 0.4154 - 26s/epoch - 13ms/step
Epoch 30/50
1972/1972 - 26s - loss: 2.9904 - accuracy30: 0.4923 - val_loss: 3.2182 - val_accuracy30: 0.4314 - 26s/epoch - 13ms/step
Epoch 31/50
1972/1972 - 26s - loss: 2.9842 - accuracy30: 0.4942 - val_loss: 3.2081 - val_accuracy30: 0.4326 - 26s/epoch - 13ms/step
Epoch 32/50
1972/1972 - 26s - loss: 2.9808 - accuracy30: 0.4958 - val_loss: 3.2027 - val_accuracy30: 0.4311 - 26s/epoch - 13ms/step
Epoch 33/50
1972/1972 - 26s - loss: 2.9774 - accuracy30: 0.4958 - val_loss: 3.1987 - val_accuracy30: 0.4272 - 26s/epoch - 13ms/step
Epoch 34/50
1972/1972 - 27s - loss: 2.9716 - accuracy30: 0.4978 - val_loss: 3.1974 - val_accuracy30: 0.4299 - 27s/epoch - 14ms/step
Epoch 35/50
1972/1972 - 26s - loss: 2.9671 - accuracy30: 0.4993 - val_loss: 3.1975 - val_accuracy30: 0.4275 - 26s/epoch - 13ms/step
Epoch 36/50
1972/1972 - 26s - loss: 2.9620 - accuracy30: 0.5008 - val_loss: 3.1937 - val_accuracy30: 0.4433 - 26s/epoch - 13ms/step
Epoch 37/50
1972/1972 - 26s - loss: 2.9572 - accuracy30: 0.5016 - val_loss: 3.2139 - val_accuracy30: 0.4474 - 26s/epoch - 13ms/step
Epoch 38/50
1972/1972 - 26s - loss: 2.9549 - accuracy30: 0.5024 - val_loss: 3.1975 - val_accuracy30: 0.4437 - 26s/epoch - 13ms/step
Epoch 39/50
1972/1972 - 27s - loss: 2.9500 - accuracy30: 0.5034 - val_loss: 3.2012 - val_accuracy30: 0.4456 - 27s/epoch - 13ms/step
Epoch 40/50
1972/1972 - 26s - loss: 2.9512 - accuracy30: 0.5043 - val_loss: 3.2169 - val_accuracy30: 0.4514 - 26s/epoch - 13ms/step
Epoch 41/50
1972/1972 - 26s - loss: 2.9444 - accuracy30: 0.5057 - val_loss: 3.2068 - val_accuracy30: 0.4560 - 26s/epoch - 13ms/step
Epoch 42/50
1972/1972 - 27s - loss: 2.9415 - accuracy30: 0.5057 - val_loss: 3.2182 - val_accuracy30: 0.4532 - 27s/epoch - 14ms/step
Epoch 43/50
1972/1972 - 26s - loss: 2.9375 - accuracy30: 0.5075 - val_loss: 3.2020 - val_accuracy30: 0.4555 - 26s/epoch - 13ms/step
Epoch 44/50
1972/1972 - 26s - loss: 2.9323 - accuracy30: 0.5078 - val_loss: 3.2100 - val_accuracy30: 0.4539 - 26s/epoch - 13ms/step
Epoch 45/50
1972/1972 - 27s - loss: 2.9284 - accuracy30: 0.5093 - val_loss: 3.2121 - val_accuracy30: 0.4591 - 27s/epoch - 13ms/step
Epoch 46/50
1972/1972 - 27s - loss: 2.9239 - accuracy30: 0.5099 - val_loss: 3.2347 - val_accuracy30: 0.4590 - 27s/epoch - 14ms/step
testing model: results/ATVI/W4/deepOF_L1/h30
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.080283
{'0': {'precision': 0.3911868968605206, 'recall': 0.4640638343452959, 'f1-score': 0.42452040010953074, 'support': 340757}, '1': {'precision': 0.4202934921530175, 'recall': 0.38755859864253933, 'f1-score': 0.4032628217301345, 'support': 419165}, '2': {'precision': 0.39613391185081637, 'recall': 0.35957790021517994, 'f1-score': 0.3769717449246443, 'support': 334139}, 'accuracy': 0.4028413406565082, 'macro avg': {'precision': 0.4025381002881181, 'recall': 0.40373344440100506, 'f1-score': 0.4015849889214365, 'support': 1094061}, 'weighted avg': {'precision': 0.40384931390821893, 'recall': 0.4028413406565082, 'f1-score': 0.4018541201340793, 'support': 1094061}}
[[158133 110832  71792]
 [145351 162451 111363]
 [100755 113235 120149]]
Evaluating performance on  train set...
1972/1972 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0404671
{'0': {'precision': 0.3612554923717813, 'recall': 0.5092604644396634, 'f1-score': 0.42267608855900973, 'support': 130609}, '1': {'precision': 0.5764588574939999, 'recall': 0.40917788321077775, 'f1-score': 0.4786230166274785, 'support': 243019}, '2': {'precision': 0.38263044065963775, 'recall': 0.4323362530450786, 'f1-score': 0.4059675377990671, 'support': 130949}, 'accuracy': 0.4410942234782798, 'macro avg': {'precision': 0.44011493017513964, 'recall': 0.45025820023184, 'f1-score': 0.43575554766185176, 'support': 504577}, 'weighted avg': {'precision': 0.4704509862051962, 'recall': 0.4410942234782798, 'f1-score': 0.4452855188319066, 'support': 504577}}
[[66514 34847 29248]
 [81483 99438 62098]
 [36122 38213 56614]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0428035
{'0': {'precision': 0.3787014805922369, 'recall': 0.4650015354693418, 'f1-score': 0.4174378107166815, 'support': 48845}, '1': {'precision': 0.5514000767165325, 'recall': 0.44542301779308535, 'f1-score': 0.49277808175831134, 'support': 83909}, '2': {'precision': 0.3828590837044305, 'recall': 0.42270833333333335, 'f1-score': 0.4017980910135055, 'support': 48000}, 'accuracy': 0.4446817221195658, 'macro avg': {'precision': 0.4376535470044, 'recall': 0.44437762886525345, 'f1-score': 0.4373379944961661, 'support': 180754}, 'weighted avg': {'precision': 0.4599750980589531, 'recall': 0.4446817221195658, 'f1-score': 0.44825881748322427, 'support': 180754}}
[[22713 15169 10963]
 [24791 37375 21743]
 [12472 15238 20290]]
training model: results/ATVI/W4/deepOF_L1/h50
Epoch 1/50
1972/1972 - 29s - loss: 3.2435 - accuracy50: 0.4089 - val_loss: 3.2708 - val_accuracy50: 0.3757 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 26s - loss: 3.2186 - accuracy50: 0.4094 - val_loss: 3.2600 - val_accuracy50: 0.3805 - 26s/epoch - 13ms/step
Epoch 3/50
1972/1972 - 27s - loss: 3.2024 - accuracy50: 0.4191 - val_loss: 3.2587 - val_accuracy50: 0.3817 - 27s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 27s - loss: 3.1870 - accuracy50: 0.4277 - val_loss: 3.2585 - val_accuracy50: 0.3888 - 27s/epoch - 14ms/step
Epoch 5/50
1972/1972 - 27s - loss: 3.1771 - accuracy50: 0.4329 - val_loss: 3.2606 - val_accuracy50: 0.3899 - 27s/epoch - 14ms/step
Epoch 6/50
1972/1972 - 27s - loss: 3.1687 - accuracy50: 0.4377 - val_loss: 3.2584 - val_accuracy50: 0.3945 - 27s/epoch - 14ms/step
Epoch 7/50
1972/1972 - 27s - loss: 3.1617 - accuracy50: 0.4414 - val_loss: 3.2554 - val_accuracy50: 0.3995 - 27s/epoch - 14ms/step
Epoch 8/50
1972/1972 - 27s - loss: 3.1555 - accuracy50: 0.4439 - val_loss: 3.2569 - val_accuracy50: 0.3998 - 27s/epoch - 14ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.1495 - accuracy50: 0.4471 - val_loss: 3.2576 - val_accuracy50: 0.3988 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.1454 - accuracy50: 0.4489 - val_loss: 3.2645 - val_accuracy50: 0.3999 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.1412 - accuracy50: 0.4515 - val_loss: 3.2682 - val_accuracy50: 0.3987 - 26s/epoch - 13ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.1362 - accuracy50: 0.4534 - val_loss: 3.2653 - val_accuracy50: 0.3994 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.1331 - accuracy50: 0.4550 - val_loss: 3.2667 - val_accuracy50: 0.4006 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.1285 - accuracy50: 0.4563 - val_loss: 3.2657 - val_accuracy50: 0.4010 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.1260 - accuracy50: 0.4577 - val_loss: 3.2685 - val_accuracy50: 0.4017 - 26s/epoch - 13ms/step
Epoch 16/50
1972/1972 - 26s - loss: 3.1219 - accuracy50: 0.4588 - val_loss: 3.2711 - val_accuracy50: 0.4028 - 26s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 26s - loss: 3.1184 - accuracy50: 0.4606 - val_loss: 3.2685 - val_accuracy50: 0.3999 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h50
Evaluating performance on  test set...
4274/4274 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091621
{'0': {'precision': 0.42530944343460575, 'recall': 0.5608321475585722, 'f1-score': 0.48375854079563135, 'support': 394257}, '1': {'precision': 0.29849368695433093, 'recall': 0.39361046246042874, 'f1-score': 0.33951606347964214, 'support': 313043}, '2': {'precision': 0.47041764778782996, 'recall': 0.19628659559779812, 'f1-score': 0.276994422967813, 'support': 386761}, 'accuracy': 0.38411477970606756, 'macro avg': {'precision': 0.3980735927255889, 'recall': 0.3835764018722663, 'f1-score': 0.3667563424143621, 'support': 1094061}, 'weighted avg': {'precision': 0.40496990968648994, 'recall': 0.38411477970606756, 'f1-score': 0.36939344159034565, 'support': 1094061}}
[[221112 133108  40037]
 [144399 123217  45427]
 [154374 156471  75916]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0737709
{'0': {'precision': 0.38633004752766975, 'recall': 0.5329303337044037, 'f1-score': 0.44794055167048824, 'support': 154508}, '1': {'precision': 0.4106760712879423, 'recall': 0.36978952561045797, 'f1-score': 0.38916182900219287, 'support': 194608}, '2': {'precision': 0.42452562282173745, 'recall': 0.3173271753044172, 'f1-score': 0.3631812593405137, 'support': 155461}, 'accuracy': 0.4035816139063017, 'macro avg': {'precision': 0.4071772472124498, 'recall': 0.40668234487309296, 'f1-score': 0.400094546671065, 'support': 504577}, 'weighted avg': {'precision': 0.40748807360244166, 'recall': 0.4035816139063017, 'f1-score': 0.3991559776491955, 'support': 504577}}
[[82342 47612 24554]
 [80325 71964 42319]
 [50472 55657 49332]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779673
{'0': {'precision': 0.4033345208407553, 'recall': 0.487865416436845, 'f1-score': 0.44159106333517956, 'support': 58016}, '1': {'precision': 0.3817285879542689, 'recall': 0.3860552744731604, 'f1-score': 0.38387974014201537, 'support': 65817}, '2': {'precision': 0.415848782260996, 'recall': 0.32156848966110924, 'f1-score': 0.3626816727265521, 'support': 56921}, 'accuracy': 0.39842548435995884, 'macro avg': {'precision': 0.40030396368534005, 'recall': 0.3984963935237049, 'f1-score': 0.396050825401249, 'support': 180754}, 'weighted avg': {'precision': 0.39940811583456814, 'recall': 0.39842548435995884, 'f1-score': 0.39572769333264474, 'support': 180754}}
[[28304 19733  9979]
 [24675 25409 15733]
 [17196 21421 18304]]
training model: results/ATVI/W4/deepOF_L1/h100
Epoch 1/50
1972/1972 - 29s - loss: 3.2645 - accuracy100: 0.3954 - val_loss: 3.2688 - val_accuracy100: 0.3922 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 28s - loss: 3.2432 - accuracy100: 0.4053 - val_loss: 3.2639 - val_accuracy100: 0.3948 - 28s/epoch - 14ms/step
Epoch 3/50
1972/1972 - 27s - loss: 3.2341 - accuracy100: 0.4111 - val_loss: 3.2649 - val_accuracy100: 0.3889 - 27s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.2269 - accuracy100: 0.4156 - val_loss: 3.2641 - val_accuracy100: 0.3905 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 27s - loss: 3.2213 - accuracy100: 0.4181 - val_loss: 3.2647 - val_accuracy100: 0.3870 - 27s/epoch - 14ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.2156 - accuracy100: 0.4215 - val_loss: 3.2629 - val_accuracy100: 0.3900 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.2121 - accuracy100: 0.4239 - val_loss: 3.2672 - val_accuracy100: 0.3851 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.2081 - accuracy100: 0.4257 - val_loss: 3.2661 - val_accuracy100: 0.3862 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.2061 - accuracy100: 0.4267 - val_loss: 3.2666 - val_accuracy100: 0.3855 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.2038 - accuracy100: 0.4273 - val_loss: 3.2648 - val_accuracy100: 0.3874 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 27s - loss: 3.2019 - accuracy100: 0.4277 - val_loss: 3.2684 - val_accuracy100: 0.3830 - 27s/epoch - 14ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.2002 - accuracy100: 0.4287 - val_loss: 3.2684 - val_accuracy100: 0.3831 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.1986 - accuracy100: 0.4303 - val_loss: 3.2681 - val_accuracy100: 0.3813 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.1955 - accuracy100: 0.4307 - val_loss: 3.2682 - val_accuracy100: 0.3836 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 27s - loss: 3.1943 - accuracy100: 0.4308 - val_loss: 3.2708 - val_accuracy100: 0.3784 - 27s/epoch - 14ms/step
Epoch 16/50
1972/1972 - 26s - loss: 3.1924 - accuracy100: 0.4325 - val_loss: 3.2725 - val_accuracy100: 0.3767 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h100
Evaluating performance on  test set...
4274/4274 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926225
{'0': {'precision': 0.4191080656418579, 'recall': 0.6051075088670306, 'f1-score': 0.49521886575143803, 'support': 402897}, '1': {'precision': 0.270481644728294, 'recall': 0.18865787134665993, 'f1-score': 0.22227880435563788, 'support': 286895}, '2': {'precision': 0.4386346968644016, 'recall': 0.3387966923014132, 'f1-score': 0.38230507925785945, 'support': 404269}, 'accuracy': 0.3974970317011574, 'macro avg': {'precision': 0.37607480241151786, 'recall': 0.3775206908383679, 'f1-score': 0.36660091645497844, 'support': 1094061}, 'weighted avg': {'precision': 0.3873491734500236, 'recall': 0.3974970317011574, 'f1-score': 0.38192291381994553, 'support': 1094061}}
[[243796  69748  89353]
 [146835  54125  85935]
 [191071  76233 136965]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0844704
{'0': {'precision': 0.3953686962204553, 'recall': 0.5440565477796363, 'f1-score': 0.4579458117389395, 'support': 166797}, '1': {'precision': 0.3525195042048026, 'recall': 0.2506002256848575, 'f1-score': 0.29294835812517545, 'support': 166604}, '2': {'precision': 0.4296112785411452, 'recall': 0.3930691218395102, 'f1-score': 0.4105286279103822, 'support': 171176}, 'accuracy': 0.3959395691836925, 'macro avg': {'precision': 0.39249982632213437, 'recall': 0.39590863176800134, 'f1-score': 0.387140932591499, 'support': 504577}, 'weighted avg': {'precision': 0.39283719257433314, 'recall': 0.3959395691836925, 'f1-score': 0.3873799325551783, 'support': 504577}}
[[90747 36636 39414]
 [74935 41751 49918]
 [63843 40049 67284]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0878361
{'0': {'precision': 0.4051649416203538, 'recall': 0.5114647529245177, 'f1-score': 0.45215115327989525, 'support': 62147}, '1': {'precision': 0.3274740767691468, 'recall': 0.25306201346055845, 'f1-score': 0.2854990434463686, 'support': 56907}, '2': {'precision': 0.4156293934094572, 'recall': 0.3929011345218801, 'f1-score': 0.40394581174078953, 'support': 61700}, 'accuracy': 0.38964006329043893, 'macro avg': {'precision': 0.3827561372663193, 'recall': 0.3858093003023187, 'f1-score': 0.3805320028223511, 'support': 180754}, 'weighted avg': {'precision': 0.3842774516024292, 'recall': 0.38964006329043893, 'f1-score': 0.38322907583065857, 'support': 180754}}
[[31786 14453 15908]
 [24330 14401 18176]
 [22336 15122 24242]]
training model: results/ATVI/W4/deepOF_L1/h200
Epoch 1/50
1972/1972 - 29s - loss: 3.2920 - accuracy200: 0.3699 - val_loss: 3.2953 - val_accuracy200: 0.3627 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 27s - loss: 3.2740 - accuracy200: 0.3775 - val_loss: 3.2886 - val_accuracy200: 0.3677 - 27s/epoch - 14ms/step
Epoch 3/50
1972/1972 - 26s - loss: 3.2694 - accuracy200: 0.3797 - val_loss: 3.2843 - val_accuracy200: 0.3695 - 26s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.2661 - accuracy200: 0.3823 - val_loss: 3.2829 - val_accuracy200: 0.3705 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.2636 - accuracy200: 0.3841 - val_loss: 3.2813 - val_accuracy200: 0.3722 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.2615 - accuracy200: 0.3860 - val_loss: 3.2811 - val_accuracy200: 0.3715 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.2591 - accuracy200: 0.3878 - val_loss: 3.2806 - val_accuracy200: 0.3728 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.2573 - accuracy200: 0.3885 - val_loss: 3.2802 - val_accuracy200: 0.3711 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.2561 - accuracy200: 0.3901 - val_loss: 3.2814 - val_accuracy200: 0.3713 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 27s - loss: 3.2548 - accuracy200: 0.3911 - val_loss: 3.2807 - val_accuracy200: 0.3725 - 27s/epoch - 14ms/step
Epoch 11/50
1972/1972 - 27s - loss: 3.2540 - accuracy200: 0.3911 - val_loss: 3.2810 - val_accuracy200: 0.3711 - 27s/epoch - 14ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.2527 - accuracy200: 0.3921 - val_loss: 3.2812 - val_accuracy200: 0.3719 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.2517 - accuracy200: 0.3926 - val_loss: 3.2813 - val_accuracy200: 0.3718 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.2501 - accuracy200: 0.3939 - val_loss: 3.2815 - val_accuracy200: 0.3711 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.2499 - accuracy200: 0.3945 - val_loss: 3.2815 - val_accuracy200: 0.3713 - 26s/epoch - 13ms/step
Epoch 16/50
1972/1972 - 26s - loss: 3.2486 - accuracy200: 0.3952 - val_loss: 3.2827 - val_accuracy200: 0.3708 - 26s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 26s - loss: 3.2476 - accuracy200: 0.3949 - val_loss: 3.2826 - val_accuracy200: 0.3710 - 26s/epoch - 13ms/step
Epoch 18/50
1972/1972 - 26s - loss: 3.2464 - accuracy200: 0.3966 - val_loss: 3.2835 - val_accuracy200: 0.3696 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h200
Evaluating performance on  test set...
4274/4274 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909197
{'0': {'precision': 0.3898957940601448, 'recall': 0.5240290558418593, 'f1-score': 0.44711931152754547, 'support': 382849}, '1': {'precision': 0.3157292417242402, 'recall': 0.023226301315190483, 'f1-score': 0.04326952400038338, 'support': 320714}, '2': {'precision': 0.3909859509632854, 'recall': 0.5566046433016302, 'f1-score': 0.45932198375330724, 'support': 390498}, 'accuracy': 0.38885034746691455, 'macro avg': {'precision': 0.36553699558255676, 'recall': 0.3679533334862266, 'f1-score': 0.31657027309374536, 'support': 1094061}, 'weighted avg': {'precision': 0.3685436504634946, 'recall': 0.38885034746691455, 'f1-score': 0.3330898728964538, 'support': 1094061}}
[[200624   7395 174830]
 [149538   7449 163727]
 [164396   8749 217353]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895326
{'0': {'precision': 0.3801497152002121, 'recall': 0.4843132642043227, 'f1-score': 0.4259558913252232, 'support': 165777}, '1': {'precision': 0.37751949195997736, 'recall': 0.17198562443845464, 'f1-score': 0.23631418024995166, 'support': 166950}, '2': {'precision': 0.38628467828399726, 'recall': 0.48848996217631657, 'f1-score': 0.43141668529610533, 'support': 171850}, 'accuracy': 0.38239555112500173, 'macro avg': {'precision': 0.3813179618147289, 'recall': 0.38159628360636466, 'f1-score': 0.36456225229042677, 'support': 504577}, 'weighted avg': {'precision': 0.38136890996333306, 'recall': 0.38239555112500173, 'f1-score': 0.36506875968798946, 'support': 504577}}
[[80288 21691 63798]
 [68663 28713 69574]
 [62250 25653 83947]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927234
{'0': {'precision': 0.37861081392477985, 'recall': 0.45719254658385095, 'f1-score': 0.414207576473766, 'support': 60375}, '1': {'precision': 0.36724792061870715, 'recall': 0.1666915039822496, 'f1-score': 0.22930357041170776, 'support': 60393}, '2': {'precision': 0.368964145407529, 'recall': 0.49474877471409995, 'f1-score': 0.42269729814416546, 'support': 59986}, 'accuracy': 0.372594797348883, 'macro avg': {'precision': 0.3716076266503387, 'recall': 0.3728776084267335, 'f1-score': 0.35540281500987975, 'support': 180754}, 'weighted avg': {'precision': 0.371612881524338, 'recall': 0.372594797348883, 'f1-score': 0.35524543348392734, 'support': 180754}}
[[27603  8322 24450]
 [24018 10067 26308]
 [21285  9023 29678]]
training model: results/ATVI/W4/deepOF_L1/h300
Epoch 1/50
1972/1972 - 29s - loss: 3.2889 - accuracy300: 0.3705 - val_loss: 3.3018 - val_accuracy300: 0.3444 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 27s - loss: 3.2725 - accuracy300: 0.3767 - val_loss: 3.2987 - val_accuracy300: 0.3470 - 27s/epoch - 14ms/step
Epoch 3/50
1972/1972 - 26s - loss: 3.2693 - accuracy300: 0.3785 - val_loss: 3.2953 - val_accuracy300: 0.3470 - 26s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.2665 - accuracy300: 0.3795 - val_loss: 3.2908 - val_accuracy300: 0.3510 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.2640 - accuracy300: 0.3803 - val_loss: 3.2899 - val_accuracy300: 0.3511 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.2625 - accuracy300: 0.3821 - val_loss: 3.2893 - val_accuracy300: 0.3544 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.2616 - accuracy300: 0.3829 - val_loss: 3.2886 - val_accuracy300: 0.3578 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.2608 - accuracy300: 0.3833 - val_loss: 3.2892 - val_accuracy300: 0.3555 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.2601 - accuracy300: 0.3840 - val_loss: 3.2893 - val_accuracy300: 0.3568 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.2592 - accuracy300: 0.3837 - val_loss: 3.2911 - val_accuracy300: 0.3550 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.2583 - accuracy300: 0.3848 - val_loss: 3.2911 - val_accuracy300: 0.3572 - 26s/epoch - 13ms/step
Epoch 12/50
1972/1972 - 27s - loss: 3.2572 - accuracy300: 0.3852 - val_loss: 3.2906 - val_accuracy300: 0.3599 - 27s/epoch - 14ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.2564 - accuracy300: 0.3859 - val_loss: 3.2918 - val_accuracy300: 0.3588 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.2559 - accuracy300: 0.3863 - val_loss: 3.2926 - val_accuracy300: 0.3582 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.2549 - accuracy300: 0.3869 - val_loss: 3.2925 - val_accuracy300: 0.3602 - 26s/epoch - 13ms/step
Epoch 16/50
1972/1972 - 26s - loss: 3.2540 - accuracy300: 0.3882 - val_loss: 3.2927 - val_accuracy300: 0.3585 - 26s/epoch - 13ms/step
Epoch 17/50
1972/1972 - 26s - loss: 3.2542 - accuracy300: 0.3876 - val_loss: 3.2940 - val_accuracy300: 0.3577 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h300
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926105
{'0': {'precision': 0.309551038057362, 'recall': 0.1815303306830201, 'f1-score': 0.22885373332716408, 'support': 299713}, '1': {'precision': 0.455327815195729, 'recall': 0.3155047980001613, 'f1-score': 0.3727349048234307, 'support': 496040}, '2': {'precision': 0.28771896238154493, 'recall': 0.5541889590624455, 'f1-score': 0.378784112142038, 'support': 298308}, 'accuracy': 0.3438830193197637, 'macro avg': {'precision': 0.35086593854487863, 'recall': 0.3504080292485423, 'f1-score': 0.32679091676421096, 'support': 1094061}, 'weighted avg': {'precision': 0.36969250155986677, 'recall': 0.3438830193197637, 'f1-score': 0.3349687010963428, 'support': 1094061}}
[[ 54407  95799 149507]
 [ 79778 156503 259759]
 [ 41576  91413 165319]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951948
{'0': {'precision': 0.3797833715648594, 'recall': 0.15107839760208366, 'f1-score': 0.21616573859509564, 'support': 165477}, '1': {'precision': 0.3374979299685355, 'recall': 0.5512876000865613, 'f1-score': 0.41868013723176234, 'support': 166356}, '2': {'precision': 0.3692901835164506, 'recall': 0.35704279164544067, 'f1-score': 0.3630632301131096, 'support': 172744}, 'accuracy': 0.3535377157500243, 'macro avg': {'precision': 0.3621904950166152, 'recall': 0.35313626311136187, 'f1-score': 0.33263636864665586, 'support': 504577}, 'weighted avg': {'precision': 0.36224973012176476, 'recall': 0.3535377157500243, 'f1-score': 0.33322447407925193, 'support': 504577}}
[[25000 88677 51800]
 [21108 91710 53538]
 [19719 91348 61677]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947672
{'0': {'precision': 0.35963130760818623, 'recall': 0.1583572669269266, 'f1-score': 0.21988991176224762, 'support': 58147}, '1': {'precision': 0.37123250367627036, 'recall': 0.5170760571073114, 'f1-score': 0.43218189657358796, 'support': 65911}, '2': {'precision': 0.33889020443602497, 'recall': 0.378633413291943, 'f1-score': 0.3576611324464141, 'support': 56696}, 'accuracy': 0.35825486572911247, 'macro avg': {'precision': 0.35658467190682713, 'recall': 0.35135557910872706, 'f1-score': 0.3365776469274166, 'support': 180754}, 'weighted avg': {'precision': 0.35735588824592945, 'recall': 0.35825486572911247, 'f1-score': 0.3405149277442439, 'support': 180754}}
[[ 9208 29504 19435]
 [ 9387 34081 22443]
 [ 7009 28220 21467]]
training model: results/ATVI/W4/deepOF_L1/h500
Epoch 1/50
1972/1972 - 29s - loss: 3.2590 - accuracy500: 0.3991 - val_loss: 3.3290 - val_accuracy500: 0.3298 - 29s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 26s - loss: 3.2473 - accuracy500: 0.4017 - val_loss: 3.3183 - val_accuracy500: 0.3309 - 26s/epoch - 13ms/step
Epoch 3/50
1972/1972 - 27s - loss: 3.2426 - accuracy500: 0.4014 - val_loss: 3.3157 - val_accuracy500: 0.3359 - 27s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.2395 - accuracy500: 0.4012 - val_loss: 3.3151 - val_accuracy500: 0.3385 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.2415 - accuracy500: 0.4000 - val_loss: 3.3118 - val_accuracy500: 0.3457 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.2358 - accuracy500: 0.4029 - val_loss: 3.3136 - val_accuracy500: 0.3430 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.2334 - accuracy500: 0.4037 - val_loss: 3.3135 - val_accuracy500: 0.3437 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.2318 - accuracy500: 0.4045 - val_loss: 3.3163 - val_accuracy500: 0.3413 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.2297 - accuracy500: 0.4068 - val_loss: 3.3176 - val_accuracy500: 0.3389 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.2282 - accuracy500: 0.4077 - val_loss: 3.3185 - val_accuracy500: 0.3402 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 27s - loss: 3.2274 - accuracy500: 0.4090 - val_loss: 3.3192 - val_accuracy500: 0.3414 - 27s/epoch - 14ms/step
Epoch 12/50
1972/1972 - 26s - loss: 3.2270 - accuracy500: 0.4089 - val_loss: 3.3161 - val_accuracy500: 0.3408 - 26s/epoch - 13ms/step
Epoch 13/50
1972/1972 - 26s - loss: 3.2260 - accuracy500: 0.4095 - val_loss: 3.3164 - val_accuracy500: 0.3419 - 26s/epoch - 13ms/step
Epoch 14/50
1972/1972 - 26s - loss: 3.2253 - accuracy500: 0.4103 - val_loss: 3.3153 - val_accuracy500: 0.3417 - 26s/epoch - 13ms/step
Epoch 15/50
1972/1972 - 26s - loss: 3.2233 - accuracy500: 0.4117 - val_loss: 3.3180 - val_accuracy500: 0.3394 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h500
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1074842
{'0': {'precision': 0.34442082572378074, 'recall': 0.3653655705661053, 'f1-score': 0.35458417395202874, 'support': 346349}, '1': {'precision': 0.3670555108608206, 'recall': 0.004589220737745523, 'f1-score': 0.009065102336312813, 'support': 397671}, '2': {'precision': 0.3323199543286618, 'recall': 0.6851425975814261, 'f1-score': 0.4475576153823903, 'support': 350041}, 'accuracy': 0.33654156395301543, 'macro avg': {'precision': 0.34793209697108773, 'recall': 0.3516991296284257, 'f1-score': 0.2704022972235773, 'support': 1094061}, 'weighted avg': {'precision': 0.3487764848224169, 'recall': 0.33654156395301543, 'f1-score': 0.25874089070112394, 'support': 1094061}}
[[126544   1637 218168]
 [132164   1825 263682]
 [108703   1510 239828]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975971
{'0': {'precision': 0.36292064186326234, 'recall': 0.3206143740340031, 'f1-score': 0.3404582697559912, 'support': 165632}, '1': {'precision': 0.3853346812044191, 'recall': 0.06393238370212409, 'f1-score': 0.10966913275791204, 'support': 166942}, '2': {'precision': 0.35578950552858074, 'recall': 0.6837555158921647, 'f1-score': 0.46803752004743737, 'support': 172003}, 'accuracy': 0.3594793262475301, 'macro avg': {'precision': 0.3680149428654207, 'recall': 0.3561007578760973, 'f1-score': 0.3060549741871135, 'support': 504577}, 'weighted avg': {'precision': 0.3679055454809801, 'recall': 0.3594793262475301, 'f1-score': 0.3075903698698416, 'support': 504577}}
[[ 53104   8386 104142]
 [ 47464  10673 108805]
 [ 45756   8639 117608]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022135
{'0': {'precision': 0.3669809151529087, 'recall': 0.3178122199727855, 'f1-score': 0.3406313917296577, 'support': 60262}, '1': {'precision': 0.3839884540283556, 'recall': 0.07219242801506735, 'f1-score': 0.12153538176297508, 'support': 62652}, '2': {'precision': 0.3339327151138397, 'recall': 0.6742565698478562, 'f1-score': 0.4466548700945444, 'support': 57840}, 'accuracy': 0.3467364484326765, 'macro avg': {'precision': 0.3616340280983679, 'recall': 0.35475373927856974, 'f1-score': 0.3029405478623924, 'support': 180754}, 'weighted avg': {'precision': 0.36230078876768207, 'recall': 0.3467364484326765, 'f1-score': 0.29861624834247097, 'support': 180754}}
[[19152  3662 37448]
 [17789  4523 40340]
 [15247  3594 38999]]
training model: results/ATVI/W4/deepOF_L1/h1000
Epoch 1/50
1972/1972 - 30s - loss: 3.3071 - accuracy1000: 0.3661 - val_loss: 3.3320 - val_accuracy1000: 0.3182 - 30s/epoch - 15ms/step
Epoch 2/50
1972/1972 - 26s - loss: 3.2960 - accuracy1000: 0.3562 - val_loss: 3.3335 - val_accuracy1000: 0.3169 - 26s/epoch - 13ms/step
Epoch 3/50
1972/1972 - 26s - loss: 3.2917 - accuracy1000: 0.3562 - val_loss: 3.3393 - val_accuracy1000: 0.3156 - 26s/epoch - 13ms/step
Epoch 4/50
1972/1972 - 26s - loss: 3.2885 - accuracy1000: 0.3593 - val_loss: 3.3443 - val_accuracy1000: 0.3149 - 26s/epoch - 13ms/step
Epoch 5/50
1972/1972 - 26s - loss: 3.2851 - accuracy1000: 0.3631 - val_loss: 3.3432 - val_accuracy1000: 0.3153 - 26s/epoch - 13ms/step
Epoch 6/50
1972/1972 - 26s - loss: 3.2826 - accuracy1000: 0.3658 - val_loss: 3.3439 - val_accuracy1000: 0.3147 - 26s/epoch - 13ms/step
Epoch 7/50
1972/1972 - 26s - loss: 3.2801 - accuracy1000: 0.3676 - val_loss: 3.3412 - val_accuracy1000: 0.3147 - 26s/epoch - 13ms/step
Epoch 8/50
1972/1972 - 26s - loss: 3.2780 - accuracy1000: 0.3700 - val_loss: 3.3453 - val_accuracy1000: 0.3152 - 26s/epoch - 13ms/step
Epoch 9/50
1972/1972 - 26s - loss: 3.2770 - accuracy1000: 0.3710 - val_loss: 3.3469 - val_accuracy1000: 0.3150 - 26s/epoch - 13ms/step
Epoch 10/50
1972/1972 - 26s - loss: 3.2751 - accuracy1000: 0.3730 - val_loss: 3.3460 - val_accuracy1000: 0.3153 - 26s/epoch - 13ms/step
Epoch 11/50
1972/1972 - 26s - loss: 3.2735 - accuracy1000: 0.3743 - val_loss: 3.3488 - val_accuracy1000: 0.3152 - 26s/epoch - 13ms/step
testing model: results/ATVI/W4/deepOF_L1/h1000
Evaluating performance on  test set...
4274/4274 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1086009
{'0': {'precision': 0.3554609929078014, 'recall': 0.0032185974826611868, 'f1-score': 0.006379431044358176, 'support': 389300}, '1': {'precision': 0.2828870672905577, 'recall': 0.796144462923297, 'f1-score': 0.41744650818748763, 'support': 309062}, '2': {'precision': 0.36509971639045696, 'recall': 0.20365732539126963, 'f1-score': 0.2614657095348177, 'support': 395699}, 'accuracy': 0.2997072375306313, 'macro avg': {'precision': 0.334482592196272, 'recall': 0.3343401285990759, 'f1-score': 0.22843054958888784, 'support': 1094061}, 'weighted avg': {'precision': 0.33844566254162145, 'recall': 0.2997072375306313, 'f1-score': 0.2147614118556715, 'support': 1094061}}
[[  1253 309858  78189]
 [  1054 246058  61950]
 [  1218 313894  80587]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006678
{'0': {'precision': 0.32433826057064286, 'recall': 0.011660096147904643, 'f1-score': 0.022510915467754633, 'support': 161834}, '1': {'precision': 0.33799823688684594, 'recall': 0.7556264627043386, 'f1-score': 0.4670714043576073, 'support': 170489}, '2': {'precision': 0.3494452238234919, 'recall': 0.23860113553241144, 'f1-score': 0.28357637415522186, 'support': 172254}, 'accuracy': 0.3405089807898497, 'macro avg': {'precision': 0.3372605737603269, 'recall': 0.3352958981282182, 'f1-score': 0.2577195646601946, 'support': 504577}, 'weighted avg': {'precision': 0.3375248516168645, 'recall': 0.3405089807898497, 'f1-score': 0.26184454088289066, 'support': 504577}}
[[  1887 123016  36931]
 [  2079 128826  39584]
 [  1852 129302  41100]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106796
{'0': {'precision': 0.3074216250799744, 'recall': 0.01511172613337946, 'f1-score': 0.028807386201831563, 'support': 63593}, '1': {'precision': 0.3134219249866099, 'recall': 0.7588098200360979, 'f1-score': 0.4436123731617741, 'support': 57067}, '2': {'precision': 0.3379364516292505, 'recall': 0.22193563417312875, 'f1-score': 0.26791884290879875, 'support': 60094}, 'accuracy': 0.31867067948703764, 'macro avg': {'precision': 0.3195933338986116, 'recall': 0.33195239344753535, 'f1-score': 0.24677953409080144, 'support': 180754}, 'weighted avg': {'precision': 0.31946106598542695, 'recall': 0.31867067948703764, 'f1-score': 0.2392638080248149, 'support': 180754}}
[[  961 49084 13548]
 [ 1183 43303 12581]
 [  982 45775 13337]]
training model: results/ATVI/W4/deepLOB_L2/h10
Epoch 1/50
1972/1972 - 84s - loss: 2.9260 - accuracy10: 0.4450 - val_loss: 3.4201 - val_accuracy10: 0.5809 - 84s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 79s - loss: 2.7537 - accuracy10: 0.5055 - val_loss: 3.1411 - val_accuracy10: 0.5565 - 79s/epoch - 40ms/step
Epoch 3/50
1972/1972 - 79s - loss: 2.6502 - accuracy10: 0.5482 - val_loss: 3.0605 - val_accuracy10: 0.5958 - 79s/epoch - 40ms/step
Epoch 4/50
1972/1972 - 79s - loss: 2.5822 - accuracy10: 0.5741 - val_loss: 2.9295 - val_accuracy10: 0.6219 - 79s/epoch - 40ms/step
Epoch 5/50
1972/1972 - 79s - loss: 2.5424 - accuracy10: 0.5860 - val_loss: 2.8662 - val_accuracy10: 0.6280 - 79s/epoch - 40ms/step
Epoch 6/50
1972/1972 - 79s - loss: 2.5158 - accuracy10: 0.5920 - val_loss: 2.8179 - val_accuracy10: 0.6270 - 79s/epoch - 40ms/step
Epoch 7/50
1972/1972 - 79s - loss: 2.4921 - accuracy10: 0.5972 - val_loss: 2.7779 - val_accuracy10: 0.6269 - 79s/epoch - 40ms/step
Epoch 8/50
1972/1972 - 78s - loss: 2.4717 - accuracy10: 0.6021 - val_loss: 2.7478 - val_accuracy10: 0.6320 - 78s/epoch - 40ms/step
Epoch 9/50
1972/1972 - 79s - loss: 2.4562 - accuracy10: 0.6044 - val_loss: 2.6978 - val_accuracy10: 0.6136 - 79s/epoch - 40ms/step
Epoch 10/50
1972/1972 - 79s - loss: 2.4418 - accuracy10: 0.6066 - val_loss: 2.6713 - val_accuracy10: 0.6146 - 79s/epoch - 40ms/step
Epoch 11/50
1972/1972 - 79s - loss: 2.4283 - accuracy10: 0.6082 - val_loss: 2.6621 - val_accuracy10: 0.6247 - 79s/epoch - 40ms/step
Epoch 12/50
1972/1972 - 79s - loss: 2.4167 - accuracy10: 0.6097 - val_loss: 2.6602 - val_accuracy10: 0.6154 - 79s/epoch - 40ms/step
Epoch 13/50
1972/1972 - 79s - loss: 2.4065 - accuracy10: 0.6111 - val_loss: 2.6484 - val_accuracy10: 0.6170 - 79s/epoch - 40ms/step
Epoch 14/50
1972/1972 - 79s - loss: 2.3981 - accuracy10: 0.6129 - val_loss: 2.6482 - val_accuracy10: 0.6181 - 79s/epoch - 40ms/step
Epoch 15/50
1972/1972 - 79s - loss: 2.3902 - accuracy10: 0.6142 - val_loss: 2.6501 - val_accuracy10: 0.6218 - 79s/epoch - 40ms/step
Epoch 16/50
1972/1972 - 79s - loss: 2.3818 - accuracy10: 0.6157 - val_loss: 2.6531 - val_accuracy10: 0.6164 - 79s/epoch - 40ms/step
Epoch 17/50
1972/1972 - 81s - loss: 2.3747 - accuracy10: 0.6164 - val_loss: 2.6653 - val_accuracy10: 0.6183 - 81s/epoch - 41ms/step
Epoch 18/50
1972/1972 - 79s - loss: 2.3672 - accuracy10: 0.6177 - val_loss: 2.6569 - val_accuracy10: 0.6089 - 79s/epoch - 40ms/step
Epoch 19/50
1972/1972 - 79s - loss: 2.3611 - accuracy10: 0.6179 - val_loss: 2.6510 - val_accuracy10: 0.6089 - 79s/epoch - 40ms/step
Epoch 20/50
1972/1972 - 79s - loss: 2.3557 - accuracy10: 0.6187 - val_loss: 2.6855 - val_accuracy10: 0.6004 - 79s/epoch - 40ms/step
Epoch 21/50
1972/1972 - 79s - loss: 2.3501 - accuracy10: 0.6194 - val_loss: 2.6701 - val_accuracy10: 0.6014 - 79s/epoch - 40ms/step
Epoch 22/50
1972/1972 - 78s - loss: 2.3444 - accuracy10: 0.6202 - val_loss: 2.7147 - val_accuracy10: 0.5849 - 78s/epoch - 40ms/step
Epoch 23/50
1972/1972 - 79s - loss: 2.3379 - accuracy10: 0.6204 - val_loss: 2.7148 - val_accuracy10: 0.5832 - 79s/epoch - 40ms/step
Epoch 24/50
1972/1972 - 79s - loss: 2.3329 - accuracy10: 0.6217 - val_loss: 2.6973 - val_accuracy10: 0.5923 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h10
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.415337
{'0': {'precision': 0.27279569278226845, 'recall': 0.8279671963451319, 'f1-score': 0.410380631758056, 'support': 230706}, '1': {'precision': 0.8334681047344624, 'recall': 0.11515245926918997, 'f1-score': 0.20234834795808754, 'support': 635514}, '2': {'precision': 0.37175289666124256, 'recall': 0.49933946323158285, 'f1-score': 0.42620254847935984, 'support': 227845}, 'accuracy': 0.34547307518291875, 'macro avg': {'precision': 0.49267223139265787, 'recall': 0.4808197062819682, 'f1-score': 0.3463105093985011, 'support': 1094065}, 'weighted avg': {'precision': 0.6190841412082682, 'recall': 0.34547307518291875, 'f1-score': 0.29283507076169135, 'support': 1094065}}
[[191017   6471  33218]
 [403281  73181 159052]
 [105922   8151 113772]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8741308
{'0': {'precision': 0.3645916771560438, 'recall': 0.6603910460135415, 'f1-score': 0.4698090486839842, 'support': 86844}, '1': {'precision': 0.8548610144725856, 'recall': 0.5941071935879689, 'f1-score': 0.7010216999803862, 'support': 330878}, '2': {'precision': 0.41432419071646526, 'recall': 0.5596605954546501, 'f1-score': 0.47614896367981824, 'support': 86858}, 'accuracy': 0.5995857941258076, 'macro avg': {'precision': 0.5445922941150315, 'recall': 0.6047196116853869, 'f1-score': 0.5489932374480629, 'support': 504580}, 'weighted avg': {'precision': 0.6946463849436172, 'recall': 0.5995857941258076, 'f1-score': 0.6225179391916521, 'support': 504580}}
[[ 57351  16190  13303]
 [ 78889 196577  55412]
 [ 21062  17185  48611]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8346044
{'0': {'precision': 0.4156093470729716, 'recall': 0.587455554862454, 'f1-score': 0.4868120081156873, 'support': 32062}, '1': {'precision': 0.8247075894820156, 'recall': 0.6390071888521686, 'f1-score': 0.7200775536060506, 'support': 117404}, '2': {'precision': 0.4042098634942767, 'recall': 0.5744694451546919, 'f1-score': 0.4745297340109564, 'support': 31288}, 'accuracy': 0.618691702534937, 'macro avg': {'precision': 0.5481756000164214, 'recall': 0.6003107296231048, 'f1-score': 0.5604730985775648, 'support': 180754}, 'weighted avg': {'precision': 0.679355117620684, 'recall': 0.618691702534937, 'f1-score': 0.6361974729494493, 'support': 180754}}
[[18835  8277  4950]
 [20839 75022 21543]
 [ 5645  7669 17974]]
training model: results/ATVI/W4/deepLOB_L2/h20
Epoch 1/50
1972/1972 - 82s - loss: 3.0202 - accuracy20: 0.4581 - val_loss: 3.5931 - val_accuracy20: 0.5189 - 82s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 79s - loss: 2.8472 - accuracy20: 0.5063 - val_loss: 3.1623 - val_accuracy20: 0.4834 - 79s/epoch - 40ms/step
Epoch 3/50
1972/1972 - 79s - loss: 2.7608 - accuracy20: 0.5393 - val_loss: 3.1073 - val_accuracy20: 0.5136 - 79s/epoch - 40ms/step
Epoch 4/50
1972/1972 - 79s - loss: 2.6940 - accuracy20: 0.5638 - val_loss: 3.0674 - val_accuracy20: 0.5241 - 79s/epoch - 40ms/step
Epoch 5/50
1972/1972 - 79s - loss: 2.6480 - accuracy20: 0.5770 - val_loss: 3.0319 - val_accuracy20: 0.5457 - 79s/epoch - 40ms/step
Epoch 6/50
1972/1972 - 80s - loss: 2.6185 - accuracy20: 0.5840 - val_loss: 2.9728 - val_accuracy20: 0.5528 - 80s/epoch - 40ms/step
Epoch 7/50
1972/1972 - 79s - loss: 2.5950 - accuracy20: 0.5900 - val_loss: 2.9450 - val_accuracy20: 0.5511 - 79s/epoch - 40ms/step
Epoch 8/50
1972/1972 - 81s - loss: 2.5786 - accuracy20: 0.5933 - val_loss: 2.9081 - val_accuracy20: 0.5351 - 81s/epoch - 41ms/step
Epoch 9/50
1972/1972 - 79s - loss: 2.5632 - accuracy20: 0.5961 - val_loss: 2.8932 - val_accuracy20: 0.5490 - 79s/epoch - 40ms/step
Epoch 10/50
1972/1972 - 79s - loss: 2.5516 - accuracy20: 0.5990 - val_loss: 2.9039 - val_accuracy20: 0.5299 - 79s/epoch - 40ms/step
Epoch 11/50
1972/1972 - 79s - loss: 2.5406 - accuracy20: 0.5998 - val_loss: 2.9189 - val_accuracy20: 0.5199 - 79s/epoch - 40ms/step
Epoch 12/50
1972/1972 - 79s - loss: 2.5302 - accuracy20: 0.6024 - val_loss: 2.9228 - val_accuracy20: 0.5164 - 79s/epoch - 40ms/step
Epoch 13/50
1972/1972 - 79s - loss: 2.5225 - accuracy20: 0.6029 - val_loss: 2.9270 - val_accuracy20: 0.5085 - 79s/epoch - 40ms/step
Epoch 14/50
1972/1972 - 79s - loss: 2.5136 - accuracy20: 0.6041 - val_loss: 2.8895 - val_accuracy20: 0.5164 - 79s/epoch - 40ms/step
Epoch 15/50
1972/1972 - 79s - loss: 2.5068 - accuracy20: 0.6050 - val_loss: 2.8830 - val_accuracy20: 0.5224 - 79s/epoch - 40ms/step
Epoch 16/50
1972/1972 - 78s - loss: 2.5007 - accuracy20: 0.6057 - val_loss: 2.9047 - val_accuracy20: 0.5030 - 78s/epoch - 40ms/step
Epoch 17/50
1972/1972 - 79s - loss: 2.4951 - accuracy20: 0.6067 - val_loss: 2.9118 - val_accuracy20: 0.5100 - 79s/epoch - 40ms/step
Epoch 18/50
1972/1972 - 79s - loss: 2.4889 - accuracy20: 0.6076 - val_loss: 2.8974 - val_accuracy20: 0.5136 - 79s/epoch - 40ms/step
Epoch 19/50
1972/1972 - 79s - loss: 2.4832 - accuracy20: 0.6084 - val_loss: 2.8774 - val_accuracy20: 0.5245 - 79s/epoch - 40ms/step
Epoch 20/50
1972/1972 - 79s - loss: 2.4780 - accuracy20: 0.6092 - val_loss: 2.8978 - val_accuracy20: 0.5205 - 79s/epoch - 40ms/step
Epoch 21/50
1972/1972 - 79s - loss: 2.4739 - accuracy20: 0.6102 - val_loss: 2.9028 - val_accuracy20: 0.5137 - 79s/epoch - 40ms/step
Epoch 22/50
1972/1972 - 79s - loss: 2.4687 - accuracy20: 0.6105 - val_loss: 2.8934 - val_accuracy20: 0.5234 - 79s/epoch - 40ms/step
Epoch 23/50
1972/1972 - 79s - loss: 2.4638 - accuracy20: 0.6113 - val_loss: 2.8746 - val_accuracy20: 0.5262 - 79s/epoch - 40ms/step
Epoch 24/50
1972/1972 - 79s - loss: 2.4600 - accuracy20: 0.6123 - val_loss: 2.8977 - val_accuracy20: 0.5238 - 79s/epoch - 40ms/step
Epoch 25/50
1972/1972 - 79s - loss: 2.4561 - accuracy20: 0.6123 - val_loss: 2.8952 - val_accuracy20: 0.5239 - 79s/epoch - 40ms/step
Epoch 26/50
1972/1972 - 79s - loss: 2.4507 - accuracy20: 0.6134 - val_loss: 2.8983 - val_accuracy20: 0.5206 - 79s/epoch - 40ms/step
Epoch 27/50
1972/1972 - 79s - loss: 2.4463 - accuracy20: 0.6138 - val_loss: 2.9102 - val_accuracy20: 0.5096 - 79s/epoch - 40ms/step
Epoch 28/50
1972/1972 - 79s - loss: 2.4420 - accuracy20: 0.6145 - val_loss: 2.9350 - val_accuracy20: 0.5127 - 79s/epoch - 40ms/step
Epoch 29/50
1972/1972 - 79s - loss: 2.4374 - accuracy20: 0.6149 - val_loss: 2.9775 - val_accuracy20: 0.4895 - 79s/epoch - 40ms/step
Epoch 30/50
1972/1972 - 79s - loss: 2.4326 - accuracy20: 0.6155 - val_loss: 2.9474 - val_accuracy20: 0.4994 - 79s/epoch - 40ms/step
Epoch 31/50
1972/1972 - 79s - loss: 2.4288 - accuracy20: 0.6158 - val_loss: 2.9373 - val_accuracy20: 0.5025 - 79s/epoch - 40ms/step
Epoch 32/50
1972/1972 - 79s - loss: 2.4227 - accuracy20: 0.6169 - val_loss: 2.9545 - val_accuracy20: 0.5092 - 79s/epoch - 40ms/step
Epoch 33/50
1972/1972 - 79s - loss: 2.4211 - accuracy20: 0.6170 - val_loss: 2.9730 - val_accuracy20: 0.5023 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h20
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4890374
{'0': {'precision': 0.2899828836349101, 'recall': 0.8549135470874601, 'f1-score': 0.433070256820615, 'support': 297850}, '1': {'precision': 0.7713382929365651, 'recall': 0.038289187101795435, 'f1-score': 0.07295680283882733, 'support': 503667}, '2': {'precision': 0.4476214415886382, 'recall': 0.2921776939168957, 'f1-score': 0.3535689466891691, 'support': 292548}, 'accuracy': 0.32849693573964983, 'macro avg': {'precision': 0.5029808727200378, 'recall': 0.3951268093687171, 'f1-score': 0.28653200211620383, 'support': 1094065}, 'weighted avg': {'precision': 0.5537329165753513, 'recall': 0.32849693573964983, 'f1-score': 0.24602907343299243, 'support': 1094065}}
[[254636   1720  41494]
 [420396  19285  63986]
 [203075   3997  85476]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0098093
{'0': {'precision': 0.3378504804236883, 'recall': 0.7449293068798527, 'f1-score': 0.46486779151611585, 'support': 112953}, '1': {'precision': 0.7907678382863177, 'recall': 0.4140332737364381, 'f1-score': 0.5434991611212698, 'support': 278538}, '2': {'precision': 0.4534191501581716, 'recall': 0.4397952055460743, 'f1-score': 0.446503276775294, 'support': 113089}, 'accuracy': 0.4938800586626501, 'macro avg': {'precision': 0.5273458229560593, 'recall': 0.5329192620541218, 'f1-score': 0.4849567431375599, 'support': 504580}, 'weighted avg': {'precision': 0.6137715242937269, 'recall': 0.4938800586626501, 'f1-score': 0.5041578938181405, 'support': 504580}}
[[ 84142  12801  16010]
 [119269 115324  43945]
 [ 45640  17713  49736]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9746831
{'0': {'precision': 0.3914766110937544, 'recall': 0.6546270570634751, 'f1-score': 0.48995370082378764, 'support': 42111}, '1': {'precision': 0.7529977599156674, 'recall': 0.4692141104987119, 'f1-score': 0.5781602726646137, 'support': 97431}, '2': {'precision': 0.4345276479123005, 'recall': 0.5232213918276231, 'f1-score': 0.4747677132414461, 'support': 41212}, 'accuracy': 0.5247242108058466, 'macro avg': {'precision': 0.5263340063072408, 'recall': 0.5490208531299366, 'f1-score': 0.5142938955766158, 'support': 180754}, 'weighted avg': {'precision': 0.5961613559969583, 'recall': 0.5247242108058466, 'f1-score': 0.5340368723208503, 'support': 180754}}
[[27567  6962  7582]
 [31236 45716 20479]
 [11615  8034 21563]]
training model: results/ATVI/W4/deepLOB_L2/h30
Epoch 1/50
1972/1972 - 84s - loss: 3.0462 - accuracy30: 0.4690 - val_loss: 3.2785 - val_accuracy30: 0.4627 - 84s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 80s - loss: 2.9260 - accuracy30: 0.5026 - val_loss: 3.2304 - val_accuracy30: 0.4720 - 80s/epoch - 40ms/step
Epoch 3/50
1972/1972 - 79s - loss: 2.8503 - accuracy30: 0.5281 - val_loss: 3.1759 - val_accuracy30: 0.4939 - 79s/epoch - 40ms/step
Epoch 4/50
1972/1972 - 80s - loss: 2.8065 - accuracy30: 0.5420 - val_loss: 3.1315 - val_accuracy30: 0.5085 - 80s/epoch - 40ms/step
Epoch 5/50
1972/1972 - 82s - loss: 2.7697 - accuracy30: 0.5523 - val_loss: 3.1747 - val_accuracy30: 0.4977 - 82s/epoch - 41ms/step
Epoch 6/50
1972/1972 - 82s - loss: 2.7402 - accuracy30: 0.5603 - val_loss: 3.1140 - val_accuracy30: 0.5222 - 82s/epoch - 41ms/step
Epoch 7/50
1972/1972 - 81s - loss: 2.7173 - accuracy30: 0.5662 - val_loss: 3.1050 - val_accuracy30: 0.5247 - 81s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 80s - loss: 2.6978 - accuracy30: 0.5707 - val_loss: 3.1131 - val_accuracy30: 0.5296 - 80s/epoch - 40ms/step
Epoch 9/50
1972/1972 - 82s - loss: 2.6812 - accuracy30: 0.5755 - val_loss: 3.0840 - val_accuracy30: 0.5317 - 82s/epoch - 41ms/step
Epoch 10/50
1972/1972 - 82s - loss: 2.6672 - accuracy30: 0.5776 - val_loss: 3.0667 - val_accuracy30: 0.5308 - 82s/epoch - 41ms/step
Epoch 11/50
1972/1972 - 81s - loss: 2.6548 - accuracy30: 0.5801 - val_loss: 3.0185 - val_accuracy30: 0.5383 - 81s/epoch - 41ms/step
Epoch 12/50
1972/1972 - 81s - loss: 2.6434 - accuracy30: 0.5822 - val_loss: 3.0287 - val_accuracy30: 0.5349 - 81s/epoch - 41ms/step
Epoch 13/50
1972/1972 - 80s - loss: 2.6358 - accuracy30: 0.5840 - val_loss: 2.9927 - val_accuracy30: 0.5397 - 80s/epoch - 40ms/step
Epoch 14/50
1972/1972 - 79s - loss: 2.6268 - accuracy30: 0.5849 - val_loss: 2.9686 - val_accuracy30: 0.5417 - 79s/epoch - 40ms/step
Epoch 15/50
1972/1972 - 79s - loss: 2.6198 - accuracy30: 0.5865 - val_loss: 2.9939 - val_accuracy30: 0.5347 - 79s/epoch - 40ms/step
Epoch 16/50
1972/1972 - 79s - loss: 2.6133 - accuracy30: 0.5875 - val_loss: 2.9943 - val_accuracy30: 0.5336 - 79s/epoch - 40ms/step
Epoch 17/50
1972/1972 - 79s - loss: 2.6074 - accuracy30: 0.5886 - val_loss: 2.9961 - val_accuracy30: 0.5327 - 79s/epoch - 40ms/step
Epoch 18/50
1972/1972 - 79s - loss: 2.6007 - accuracy30: 0.5901 - val_loss: 3.0058 - val_accuracy30: 0.5322 - 79s/epoch - 40ms/step
Epoch 19/50
1972/1972 - 79s - loss: 2.5969 - accuracy30: 0.5903 - val_loss: 3.0192 - val_accuracy30: 0.5298 - 79s/epoch - 40ms/step
Epoch 20/50
1972/1972 - 79s - loss: 2.5921 - accuracy30: 0.5910 - val_loss: 3.0225 - val_accuracy30: 0.5301 - 79s/epoch - 40ms/step
Epoch 21/50
1972/1972 - 79s - loss: 2.5862 - accuracy30: 0.5920 - val_loss: 3.0325 - val_accuracy30: 0.5334 - 79s/epoch - 40ms/step
Epoch 22/50
1972/1972 - 80s - loss: 2.5820 - accuracy30: 0.5931 - val_loss: 3.0234 - val_accuracy30: 0.5263 - 80s/epoch - 41ms/step
Epoch 23/50
1972/1972 - 79s - loss: 2.5780 - accuracy30: 0.5935 - val_loss: 2.9873 - val_accuracy30: 0.5283 - 79s/epoch - 40ms/step
Epoch 24/50
1972/1972 - 79s - loss: 2.5728 - accuracy30: 0.5941 - val_loss: 3.0006 - val_accuracy30: 0.5293 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h30
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2269143
{'0': {'precision': 0.35072144785336234, 'recall': 0.7556792003779775, 'f1-score': 0.47909028920564956, 'support': 340761}, '1': {'precision': 0.6070187741051223, 'recall': 0.04543318263690909, 'f1-score': 0.08453892901375688, 'support': 419165}, '2': {'precision': 0.44270779422420037, 'recall': 0.43520211648445706, 'f1-score': 0.43892287051416135, 'support': 334139}, 'accuracy': 0.38568823607372504, 'macro avg': {'precision': 0.4668160053942283, 'recall': 0.4121048331664479, 'f1-score': 0.3341840295778559, 'support': 1094065}, 'weighted avg': {'precision': 0.4770092776882665, 'recall': 0.38568823607372504, 'f1-score': 0.315659759932718, 'support': 1094065}}
[[257506   4474  78781]
 [295846  19044 104275]
 [180866   7855 145418]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.950346
{'0': {'precision': 0.41365585308631986, 'recall': 0.5870089316464997, 'f1-score': 0.48531672962660644, 'support': 130659}, '1': {'precision': 0.6844276419537769, 'recall': 0.5393687502571911, 'f1-score': 0.6033011442616613, 'support': 243010}, '2': {'precision': 0.4883321974948887, 'recall': 0.4762013887297477, 'f1-score': 0.4821905093398306, 'support': 130911}, 'accuracy': 0.535316500852194, 'macro avg': {'precision': 0.5288052308449952, 'recall': 0.5341930235444795, 'f1-score': 0.5236027944093661, 'support': 504580}, 'weighted avg': {'precision': 0.5634362790555436, 'recall': 0.535316500852194, 'f1-score': 0.541327938902643, 'support': 504580}}
[[ 76698  27724  26237]
 [ 72856 131072  39082]
 [ 35861  32710  62340]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9492739
{'0': {'precision': 0.47947098302408214, 'recall': 0.4467902470927262, 'f1-score': 0.46255408736498, 'support': 48929}, '1': {'precision': 0.6231081669164934, 'recall': 0.6150633606185715, 'f1-score': 0.6190596288956944, 'support': 83806}, '2': {'precision': 0.46864749408803114, 'recall': 0.5117557633436765, 'f1-score': 0.4892538947787566, 'support': 48019}, 'accuracy': 0.5420682253228144, 'macro avg': {'precision': 0.5237422146762022, 'recall': 0.5245364570183247, 'f1-score': 0.5236225370131437, 'support': 180754}, 'weighted avg': {'precision': 0.5431925311948954, 'recall': 0.5420682253228144, 'f1-score': 0.5422104239645861, 'support': 180754}}
[[21861 16158 10910]
 [15308 51546 16952]
 [ 8425 15020 24574]]
training model: results/ATVI/W4/deepLOB_L2/h50
Epoch 1/50
1972/1972 - 84s - loss: 3.1202 - accuracy50: 0.4516 - val_loss: 3.5247 - val_accuracy50: 0.3840 - 84s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 80s - loss: 3.0187 - accuracy50: 0.4827 - val_loss: 3.4424 - val_accuracy50: 0.4107 - 80s/epoch - 41ms/step
Epoch 3/50
1972/1972 - 81s - loss: 2.9715 - accuracy50: 0.5000 - val_loss: 3.4113 - val_accuracy50: 0.4300 - 81s/epoch - 41ms/step
Epoch 4/50
1972/1972 - 80s - loss: 2.9370 - accuracy50: 0.5120 - val_loss: 3.2550 - val_accuracy50: 0.4596 - 80s/epoch - 41ms/step
Epoch 5/50
1972/1972 - 79s - loss: 2.9085 - accuracy50: 0.5208 - val_loss: 3.2542 - val_accuracy50: 0.4645 - 79s/epoch - 40ms/step
Epoch 6/50
1972/1972 - 79s - loss: 2.8864 - accuracy50: 0.5267 - val_loss: 3.2351 - val_accuracy50: 0.4634 - 79s/epoch - 40ms/step
Epoch 7/50
1972/1972 - 79s - loss: 2.8624 - accuracy50: 0.5326 - val_loss: 3.2095 - val_accuracy50: 0.4717 - 79s/epoch - 40ms/step
Epoch 8/50
1972/1972 - 79s - loss: 2.8445 - accuracy50: 0.5374 - val_loss: 3.2367 - val_accuracy50: 0.4669 - 79s/epoch - 40ms/step
Epoch 9/50
1972/1972 - 79s - loss: 2.8298 - accuracy50: 0.5404 - val_loss: 3.2330 - val_accuracy50: 0.4671 - 79s/epoch - 40ms/step
Epoch 10/50
1972/1972 - 79s - loss: 2.8173 - accuracy50: 0.5435 - val_loss: 3.2188 - val_accuracy50: 0.4755 - 79s/epoch - 40ms/step
Epoch 11/50
1972/1972 - 79s - loss: 2.8054 - accuracy50: 0.5457 - val_loss: 3.2760 - val_accuracy50: 0.4684 - 79s/epoch - 40ms/step
Epoch 12/50
1972/1972 - 79s - loss: 2.7963 - accuracy50: 0.5479 - val_loss: 3.2297 - val_accuracy50: 0.4743 - 79s/epoch - 40ms/step
Epoch 13/50
1972/1972 - 79s - loss: 2.7876 - accuracy50: 0.5499 - val_loss: 3.2529 - val_accuracy50: 0.4743 - 79s/epoch - 40ms/step
Epoch 14/50
1972/1972 - 79s - loss: 2.7803 - accuracy50: 0.5509 - val_loss: 3.2329 - val_accuracy50: 0.4752 - 79s/epoch - 40ms/step
Epoch 15/50
1972/1972 - 79s - loss: 2.7714 - accuracy50: 0.5526 - val_loss: 3.2575 - val_accuracy50: 0.4707 - 79s/epoch - 40ms/step
Epoch 16/50
1972/1972 - 79s - loss: 2.7661 - accuracy50: 0.5536 - val_loss: 3.2445 - val_accuracy50: 0.4680 - 79s/epoch - 40ms/step
Epoch 17/50
1972/1972 - 79s - loss: 2.7608 - accuracy50: 0.5551 - val_loss: 3.2414 - val_accuracy50: 0.4714 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h50
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1652713
{'0': {'precision': 0.3820682043147471, 'recall': 0.935938213361741, 'f1-score': 0.5426259352501058, 'support': 394260}, '1': {'precision': 0.5673415492957746, 'recall': 0.012352896078506535, 'f1-score': 0.02417932845619959, 'support': 313044}, '2': {'precision': 0.5224175552719338, 'recall': 0.16404187599059886, 'f1-score': 0.24968221547954964, 'support': 386761}, 'accuracy': 0.3988017165342096, 'macro avg': {'precision': 0.49060910296081844, 'recall': 0.3707776618102821, 'f1-score': 0.27216249306195167, 'support': 1094065}, 'weighted avg': {'precision': 0.4846949809064425, 'recall': 0.3988017165342096, 'f1-score': 0.29072517471085846, 'support': 1094065}}
[[369003   1346  23911]
 [275088   3867  34089]
 [321713   1603  63445]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.016254
{'0': {'precision': 0.41526174278077627, 'recall': 0.6766761584260937, 'f1-score': 0.5146771085345535, 'support': 154520}, '1': {'precision': 0.584174615082342, 'recall': 0.42038694684236777, 'f1-score': 0.4889284881391609, 'support': 194497}, '2': {'precision': 0.50132952792895, 'recall': 0.36358902823936284, 'f1-score': 0.42149151405629975, 'support': 155563}, 'accuracy': 0.48136073566134213, 'macro avg': {'precision': 0.5002552952640228, 'recall': 0.4868840445026081, 'f1-score': 0.47503237024333805, 'support': 504580}, 'weighted avg': {'precision': 0.5069062982230114, 'recall': 0.48136073566134213, 'f1-score': 0.47602266314459896, 'support': 504580}}
[[104560  28025  21935]
 [ 78407  81764  34326]
 [ 68826  30176  56561]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0538304
{'0': {'precision': 0.4451967316540231, 'recall': 0.4983550081818965, 'f1-score': 0.4702784415077778, 'support': 58055}, '1': {'precision': 0.48993038289408253, 'recall': 0.5391326817553086, 'f1-score': 0.513355284582263, 'support': 65789}, '2': {'precision': 0.4788683682645085, 'recall': 0.36494464944649446, 'f1-score': 0.4142160528913752, 'support': 56910}, 'accuracy': 0.4711928919968576, 'macro avg': {'precision': 0.4713318276042047, 'recall': 0.46747744646123324, 'f1-score': 0.46594992632713866, 'support': 180754}, 'weighted avg': {'precision': 0.4720798712854283, 'recall': 0.4711928919968576, 'f1-score': 0.46830599217259206, 'support': 180754}}
[[28932 18690 10433]
 [18151 35469 12169]
 [17904 18237 20769]]
training model: results/ATVI/W4/deepLOB_L2/h100
Epoch 1/50
1972/1972 - 84s - loss: 3.2100 - accuracy100: 0.4161 - val_loss: 3.3974 - val_accuracy100: 0.3421 - 84s/epoch - 43ms/step
Epoch 2/50
1972/1972 - 80s - loss: 3.1415 - accuracy100: 0.4457 - val_loss: 3.3643 - val_accuracy100: 0.3723 - 80s/epoch - 40ms/step
Epoch 3/50
1972/1972 - 81s - loss: 3.1184 - accuracy100: 0.4542 - val_loss: 3.3764 - val_accuracy100: 0.3739 - 81s/epoch - 41ms/step
Epoch 4/50
1972/1972 - 80s - loss: 3.1056 - accuracy100: 0.4592 - val_loss: 3.3938 - val_accuracy100: 0.3786 - 80s/epoch - 41ms/step
Epoch 5/50
1972/1972 - 81s - loss: 3.0909 - accuracy100: 0.4642 - val_loss: 3.5114 - val_accuracy100: 0.3654 - 81s/epoch - 41ms/step
Epoch 6/50
1972/1972 - 82s - loss: 3.0804 - accuracy100: 0.4676 - val_loss: 3.6474 - val_accuracy100: 0.3649 - 82s/epoch - 41ms/step
Epoch 7/50
1972/1972 - 82s - loss: 3.0712 - accuracy100: 0.4714 - val_loss: 3.6203 - val_accuracy100: 0.3662 - 82s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 82s - loss: 3.0625 - accuracy100: 0.4742 - val_loss: 3.6356 - val_accuracy100: 0.3665 - 82s/epoch - 41ms/step
Epoch 9/50
1972/1972 - 81s - loss: 3.0550 - accuracy100: 0.4767 - val_loss: 3.6901 - val_accuracy100: 0.3696 - 81s/epoch - 41ms/step
Epoch 10/50
1972/1972 - 81s - loss: 3.0475 - accuracy100: 0.4791 - val_loss: 3.7394 - val_accuracy100: 0.3740 - 81s/epoch - 41ms/step
Epoch 11/50
1972/1972 - 81s - loss: 3.0400 - accuracy100: 0.4817 - val_loss: 3.7300 - val_accuracy100: 0.3690 - 81s/epoch - 41ms/step
Epoch 12/50
1972/1972 - 81s - loss: 3.0327 - accuracy100: 0.4840 - val_loss: 3.8087 - val_accuracy100: 0.3645 - 81s/epoch - 41ms/step
testing model: results/ATVI/W4/deepLOB_L2/h100
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1282797
{'0': {'precision': 0.38129680798263615, 'recall': 0.6387754747467728, 'f1-score': 0.4775407658109001, 'support': 402899}, '1': {'precision': 0.2668881823988288, 'recall': 0.25925073894372874, 'f1-score': 0.2630140280277661, 'support': 286896}, '2': {'precision': 0.42861822895152907, 'recall': 0.14887080416553294, 'f1-score': 0.22098684741978836, 'support': 404270}, 'accuracy': 0.3582273448104089, 'macro avg': {'precision': 0.35893440644433133, 'recall': 0.3489656726186781, 'f1-score': 0.32051388041948486, 'support': 1094065}, 'weighted avg': {'precision': 0.3687813302090142, 'recall': 0.3582273448104089, 'f1-score': 0.32648583255647295, 'support': 1094065}}
[[257362 100842  44695]
 [176983  74378  35535]
 [240620 103466  60184]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998346
{'0': {'precision': 0.39116562896880713, 'recall': 0.4543399394357329, 'f1-score': 0.42039266166014266, 'support': 166765}, '1': {'precision': 0.3626838486407723, 'recall': 0.47793032270452557, 'f1-score': 0.4124070583849388, 'support': 166654}, '2': {'precision': 0.43638793934613024, 'recall': 0.23270488020051297, 'f1-score': 0.3035441426954689, 'support': 171161}, 'accuracy': 0.38694954219350747, 'macro avg': {'precision': 0.39674580565190326, 'recall': 0.3883250474469238, 'f1-score': 0.3787812875801834, 'support': 504580}, 'weighted avg': {'precision': 0.39709866881918704, 'recall': 0.38694954219350747, 'f1-score': 0.3781184096431417, 'support': 504580}}
[[75768 66718 24279]
 [59842 79649 27163]
 [58088 73243 39830]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1230046
{'0': {'precision': 0.4211427097742246, 'recall': 0.289217343702201, 'f1-score': 0.34292968824573794, 'support': 62109}, '1': {'precision': 0.3332235726117065, 'recall': 0.5869481158605174, 'f1-score': 0.4251053375256183, 'support': 56896}, '2': {'precision': 0.42404244647995143, 'recall': 0.2601499619427035, 'f1-score': 0.3224666773727316, 'support': 61749}, 'accuracy': 0.37300419354481784, 'macro avg': {'precision': 0.3928029096219608, 'recall': 0.378771807168474, 'f1-score': 0.3635005677146959, 'support': 180754}, 'weighted avg': {'precision': 0.3944589772639802, 'recall': 0.37300419354481784, 'f1-score': 0.3618055929727747, 'support': 180754}}
[[17963 33233 10913]
 [12595 33395 10906]
 [12095 33590 16064]]
training model: results/ATVI/W4/deepLOB_L2/h200
Epoch 1/50
1972/1972 - 84s - loss: 3.2691 - accuracy200: 0.3861 - val_loss: 3.3334 - val_accuracy200: 0.3573 - 84s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 82s - loss: 3.2259 - accuracy200: 0.4077 - val_loss: 3.3907 - val_accuracy200: 0.3553 - 82s/epoch - 41ms/step
Epoch 3/50
1972/1972 - 82s - loss: 3.2056 - accuracy200: 0.4193 - val_loss: 3.3710 - val_accuracy200: 0.3529 - 82s/epoch - 41ms/step
Epoch 4/50
1972/1972 - 81s - loss: 3.1929 - accuracy200: 0.4255 - val_loss: 3.4202 - val_accuracy200: 0.3494 - 81s/epoch - 41ms/step
Epoch 5/50
1972/1972 - 81s - loss: 3.1825 - accuracy200: 0.4305 - val_loss: 3.4286 - val_accuracy200: 0.3540 - 81s/epoch - 41ms/step
Epoch 6/50
1972/1972 - 82s - loss: 3.1733 - accuracy200: 0.4350 - val_loss: 3.4596 - val_accuracy200: 0.3540 - 82s/epoch - 42ms/step
Epoch 7/50
1972/1972 - 82s - loss: 3.1643 - accuracy200: 0.4393 - val_loss: 3.5206 - val_accuracy200: 0.3560 - 82s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 81s - loss: 3.1585 - accuracy200: 0.4420 - val_loss: 3.5083 - val_accuracy200: 0.3525 - 81s/epoch - 41ms/step
Epoch 9/50
1972/1972 - 81s - loss: 3.1505 - accuracy200: 0.4453 - val_loss: 3.5348 - val_accuracy200: 0.3538 - 81s/epoch - 41ms/step
Epoch 10/50
1972/1972 - 79s - loss: 3.1423 - accuracy200: 0.4480 - val_loss: 3.4977 - val_accuracy200: 0.3502 - 79s/epoch - 40ms/step
Epoch 11/50
1972/1972 - 79s - loss: 3.1362 - accuracy200: 0.4509 - val_loss: 3.4420 - val_accuracy200: 0.3527 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h200
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1275331
{'0': {'precision': 0.35465101044587244, 'recall': 0.6009857620849887, 'f1-score': 0.4460694981892627, 'support': 382851}, '1': {'precision': 0.2962683014575755, 'recall': 0.25420700622047615, 'f1-score': 0.27363072203632166, 'support': 320715}, '2': {'precision': 0.3730372878566096, 'recall': 0.1625023367537433, 'f1-score': 0.22638635196072837, 'support': 390499}, 'accuracy': 0.3428251520704894, 'macro avg': {'precision': 0.3413188665866859, 'recall': 0.33923170168640265, 'f1-score': 0.3153621907287709, 'support': 1094065}, 'weighted avg': {'precision': 0.3440991807368824, 'recall': 0.3428251520704894, 'f1-score': 0.3171102946565778, 'support': 1094065}}
[[230088  93999  58764]
 [191299  81528  47888]
 [227386  99656  63457]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1252532
{'0': {'precision': 0.340282018347336, 'recall': 0.5850212077880549, 'f1-score': 0.43028531996707253, 'support': 165741}, '1': {'precision': 0.3501066989001806, 'recall': 0.2811131414192853, 'f1-score': 0.31183935508096383, 'support': 166915}, '2': {'precision': 0.3726697191982432, 'recall': 0.18557618482585328, 'f1-score': 0.24777118538767395, 'support': 171924}, 'accuracy': 0.34838677712156646, 'macro avg': {'precision': 0.3543528121485866, 'recall': 0.35057017801106444, 'f1-score': 0.32996528681190346, 'support': 504580}, 'weighted avg': {'precision': 0.3545673836721, 'recall': 0.34838677712156646, 'f1-score': 0.32891592700184724, 'support': 504580}}
[[96962 42102 26677]
 [92963 46922 27030]
 [95021 44998 31905]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119014
{'0': {'precision': 0.3460333968914312, 'recall': 0.4963697244969002, 'f1-score': 0.407786955011882, 'support': 60326}, '1': {'precision': 0.37639048446299983, 'recall': 0.22214688518083647, 'f1-score': 0.2793943301649369, 'support': 60469}, '2': {'precision': 0.36770886724756535, 'recall': 0.3589452792741707, 'f1-score': 0.36327422798740816, 'support': 59959}, 'accuracy': 0.35904599621585137, 'macro avg': {'precision': 0.3633775828673322, 'recall': 0.3591539629839691, 'f1-score': 0.350151837721409, 'support': 180754}, 'weighted avg': {'precision': 0.3633790836007081, 'recall': 0.35904599621585137, 'f1-score': 0.3500692158109219, 'support': 180754}}
[[29944 10770 19612]
 [29640 13433 17396]
 [26951 11486 21522]]
training model: results/ATVI/W4/deepLOB_L2/h300
Epoch 1/50
1972/1972 - 84s - loss: 3.2663 - accuracy300: 0.3873 - val_loss: 3.3881 - val_accuracy300: 0.3318 - 84s/epoch - 43ms/step
Epoch 2/50
1972/1972 - 82s - loss: 3.2325 - accuracy300: 0.4073 - val_loss: 3.3894 - val_accuracy300: 0.3475 - 82s/epoch - 42ms/step
Epoch 3/50
1972/1972 - 82s - loss: 3.2152 - accuracy300: 0.4161 - val_loss: 3.4048 - val_accuracy300: 0.3536 - 82s/epoch - 41ms/step
Epoch 4/50
1972/1972 - 82s - loss: 3.2047 - accuracy300: 0.4214 - val_loss: 3.3806 - val_accuracy300: 0.3588 - 82s/epoch - 41ms/step
Epoch 5/50
1972/1972 - 81s - loss: 3.1961 - accuracy300: 0.4259 - val_loss: 3.5613 - val_accuracy300: 0.3275 - 81s/epoch - 41ms/step
Epoch 6/50
1972/1972 - 83s - loss: 3.1909 - accuracy300: 0.4286 - val_loss: 3.6396 - val_accuracy300: 0.3191 - 83s/epoch - 42ms/step
Epoch 7/50
1972/1972 - 81s - loss: 3.1832 - accuracy300: 0.4320 - val_loss: 3.4979 - val_accuracy300: 0.3373 - 81s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 81s - loss: 3.1799 - accuracy300: 0.4337 - val_loss: 3.5216 - val_accuracy300: 0.3385 - 81s/epoch - 41ms/step
Epoch 9/50
1972/1972 - 81s - loss: 3.1672 - accuracy300: 0.4388 - val_loss: 3.6438 - val_accuracy300: 0.3302 - 81s/epoch - 41ms/step
Epoch 10/50
1972/1972 - 81s - loss: 3.1642 - accuracy300: 0.4396 - val_loss: 3.5730 - val_accuracy300: 0.3301 - 81s/epoch - 41ms/step
Epoch 11/50
1972/1972 - 82s - loss: 3.1579 - accuracy300: 0.4419 - val_loss: 3.5276 - val_accuracy300: 0.3331 - 82s/epoch - 41ms/step
Epoch 12/50
1972/1972 - 81s - loss: 3.1488 - accuracy300: 0.4449 - val_loss: 3.5305 - val_accuracy300: 0.3495 - 81s/epoch - 41ms/step
Epoch 13/50
1972/1972 - 80s - loss: 3.1389 - accuracy300: 0.4486 - val_loss: 3.5755 - val_accuracy300: 0.3489 - 80s/epoch - 40ms/step
Epoch 14/50
1972/1972 - 80s - loss: 3.1331 - accuracy300: 0.4508 - val_loss: 3.5618 - val_accuracy300: 0.3480 - 80s/epoch - 41ms/step
testing model: results/ATVI/W4/deepLOB_L2/h300
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1140647
{'0': {'precision': 0.28452636895983674, 'recall': 0.3740019685367766, 'f1-score': 0.32318555188112136, 'support': 299715}, '1': {'precision': 0.4753499348958333, 'recall': 0.3532631375229064, 'f1-score': 0.40531247939991744, 'support': 496041}, '2': {'precision': 0.274804047571638, 'recall': 0.30534110603434694, 'f1-score': 0.2892688883348921, 'support': 298309}, 'accuracy': 0.34587798713970375, 'macro avg': {'precision': 0.3448934504757693, 'recall': 0.34420207069800995, 'f1-score': 0.339255639871977, 'support': 1094065}, 'weighted avg': {'precision': 0.36839346689228636, 'recall': 0.34587798713970375, 'f1-score': 0.35117353912825844, 'support': 1094065}}
[[112094  97101  90520]
 [170956 175233 149852]
 [110917  96306  91086]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194593
{'0': {'precision': 0.33582905824898707, 'recall': 0.3953415266686415, 'f1-score': 0.3631633310380062, 'support': 165419}, '1': {'precision': 0.34346740545039184, 'recall': 0.3694500186251066, 'f1-score': 0.35598523771618784, 'support': 166442}, '2': {'precision': 0.34952680905713457, 'recall': 0.2647247841870321, 'f1-score': 0.301272019846277, 'support': 172719}, 'accuracy': 0.3420904514645844, 'macro avg': {'precision': 0.3429410909188378, 'recall': 0.34317210982692675, 'f1-score': 0.34014019620015706, 'support': 504580}, 'weighted avg': {'precision': 0.34303743671568937, 'recall': 0.3420904514645844, 'f1-score': 0.33960999641040623, 'support': 504580}}
[[65397 57314 42708]
 [62567 61492 42383]
 [66769 60227 45723]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.126013
{'0': {'precision': 0.3389074063612225, 'recall': 0.30957254665863937, 'f1-score': 0.32357647566479075, 'support': 58135}, '1': {'precision': 0.41010897706062976, 'recall': 0.41347598452082857, 'f1-score': 0.41178559823472954, 'support': 65895}, '2': {'precision': 0.3224863187127338, 'recall': 0.34801847542486425, 'f1-score': 0.3347662774824273, 'support': 56724}, 'accuracy': 0.3595162486030738, 'macro avg': {'precision': 0.3571675673781954, 'recall': 0.3570223355347774, 'f1-score': 0.3567094504606492, 'support': 180754}, 'weighted avg': {'precision': 0.3597111380931043, 'recall': 0.3595162486030738, 'f1-score': 0.35924523237307787, 'support': 180754}}
[[17997 19385 20753]
 [17928 27246 20721]
 [17178 19805 19741]]
training model: results/ATVI/W4/deepLOB_L2/h500
Epoch 1/50
1972/1972 - 84s - loss: 3.2167 - accuracy500: 0.4242 - val_loss: 3.3700 - val_accuracy500: 0.3552 - 84s/epoch - 43ms/step
Epoch 2/50
1972/1972 - 80s - loss: 3.1765 - accuracy500: 0.4436 - val_loss: 3.4184 - val_accuracy500: 0.3653 - 80s/epoch - 41ms/step
Epoch 3/50
1972/1972 - 82s - loss: 3.1582 - accuracy500: 0.4502 - val_loss: 3.6143 - val_accuracy500: 0.3634 - 82s/epoch - 41ms/step
Epoch 4/50
1972/1972 - 82s - loss: 3.1369 - accuracy500: 0.4591 - val_loss: 3.8393 - val_accuracy500: 0.3324 - 82s/epoch - 41ms/step
Epoch 5/50
1972/1972 - 81s - loss: 3.1172 - accuracy500: 0.4659 - val_loss: 3.7826 - val_accuracy500: 0.3377 - 81s/epoch - 41ms/step
Epoch 6/50
1972/1972 - 80s - loss: 3.1051 - accuracy500: 0.4706 - val_loss: 3.7906 - val_accuracy500: 0.3305 - 80s/epoch - 41ms/step
Epoch 7/50
1972/1972 - 81s - loss: 3.0942 - accuracy500: 0.4744 - val_loss: 3.8145 - val_accuracy500: 0.3318 - 81s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 81s - loss: 3.0871 - accuracy500: 0.4758 - val_loss: 3.8273 - val_accuracy500: 0.3333 - 81s/epoch - 41ms/step
Epoch 9/50
1972/1972 - 81s - loss: 3.0783 - accuracy500: 0.4789 - val_loss: 3.9037 - val_accuracy500: 0.3301 - 81s/epoch - 41ms/step
Epoch 10/50
1972/1972 - 81s - loss: 3.0666 - accuracy500: 0.4826 - val_loss: 3.8293 - val_accuracy500: 0.3298 - 81s/epoch - 41ms/step
Epoch 11/50
1972/1972 - 81s - loss: 3.0563 - accuracy500: 0.4852 - val_loss: 3.8902 - val_accuracy500: 0.3278 - 81s/epoch - 41ms/step
testing model: results/ATVI/W4/deepLOB_L2/h500
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1170921
{'0': {'precision': 0.3221037572701837, 'recall': 0.4264501227082431, 'f1-score': 0.3670041408819221, 'support': 346350}, '1': {'precision': 0.3821795338102102, 'recall': 0.428046229053089, 'f1-score': 0.4038146298646613, 'support': 397672}, '2': {'precision': 0.33826716320562183, 'recall': 0.18372028579345967, 'f1-score': 0.2381150735246474, 'support': 350043}, 'accuracy': 0.3493695529973082, 'macro avg': {'precision': 0.3475168180953386, 'recall': 0.346072212518264, 'f1-score': 0.3363112814237436, 'support': 1094065}, 'weighted avg': {'precision': 0.3491116053524128, 'recall': 0.3493695529973082, 'f1-score': 0.33914636732166875, 'support': 1094065}}
[[147701 135684  62965]
 [164609 170222  62841]
 [146241 139492  64310]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1271319
{'0': {'precision': 0.32913598584794757, 'recall': 0.5324868223232561, 'f1-score': 0.406815078603587, 'support': 165621}, '1': {'precision': 0.34415075100984355, 'recall': 0.3153119703929048, 'f1-score': 0.3291007903594276, 'support': 166987}, '2': {'precision': 0.3707361398390703, 'recall': 0.18030842230130487, 'f1-score': 0.24261866664580162, 'support': 171972}, 'accuracy': 0.34058424828570294, 'macro avg': {'precision': 0.3480076255656204, 'recall': 0.3427024050058219, 'f1-score': 0.32617817853627207, 'support': 504580}, 'weighted avg': {'precision': 0.348283261348861, 'recall': 0.34058424828570294, 'f1-score': 0.3251343516460546, 'support': 504580}}
[[88191 49596 27834]
 [89537 52653 24797]
 [90219 50745 31008]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1223992
{'0': {'precision': 0.31103410789509445, 'recall': 0.3798751950078003, 'f1-score': 0.3420250440811691, 'support': 60254}, '1': {'precision': 0.43993172052504564, 'recall': 0.2385382589962499, 'f1-score': 0.3093447016338483, 'support': 62665}, '2': {'precision': 0.3601645123384254, 'recall': 0.4557620817843866, 'f1-score': 0.4023629799803085, 'support': 57835}, 'accuracy': 0.3551567323544707, 'macro avg': {'precision': 0.3703767802528552, 'recall': 0.35805851192947896, 'f1-score': 0.351244241898442, 'support': 180754}, 'weighted avg': {'precision': 0.3714412127803858, 'recall': 0.3551567323544707, 'f1-score': 0.3500012485539075, 'support': 180754}}
[[22889  9538 27827]
 [28717 14948 19000]
 [21984  9492 26359]]
training model: results/ATVI/W4/deepLOB_L2/h1000
Epoch 1/50
1972/1972 - 84s - loss: 3.2219 - accuracy1000: 0.4205 - val_loss: 3.6297 - val_accuracy1000: 0.3409 - 84s/epoch - 42ms/step
Epoch 2/50
1972/1972 - 79s - loss: 3.1550 - accuracy1000: 0.4466 - val_loss: 3.6452 - val_accuracy1000: 0.3648 - 79s/epoch - 40ms/step
Epoch 3/50
1972/1972 - 79s - loss: 3.1283 - accuracy1000: 0.4560 - val_loss: 3.6739 - val_accuracy1000: 0.3603 - 79s/epoch - 40ms/step
Epoch 4/50
1972/1972 - 79s - loss: 3.0989 - accuracy1000: 0.4664 - val_loss: 3.7384 - val_accuracy1000: 0.3502 - 79s/epoch - 40ms/step
Epoch 5/50
1972/1972 - 79s - loss: 3.0900 - accuracy1000: 0.4682 - val_loss: 3.7435 - val_accuracy1000: 0.3499 - 79s/epoch - 40ms/step
Epoch 6/50
1972/1972 - 79s - loss: 3.0726 - accuracy1000: 0.4736 - val_loss: 3.9322 - val_accuracy1000: 0.3368 - 79s/epoch - 40ms/step
Epoch 7/50
1972/1972 - 80s - loss: 3.0622 - accuracy1000: 0.4772 - val_loss: 3.9891 - val_accuracy1000: 0.3308 - 80s/epoch - 41ms/step
Epoch 8/50
1972/1972 - 79s - loss: 3.0463 - accuracy1000: 0.4812 - val_loss: 3.9458 - val_accuracy1000: 0.3319 - 79s/epoch - 40ms/step
Epoch 9/50
1972/1972 - 79s - loss: 3.0327 - accuracy1000: 0.4872 - val_loss: 4.1182 - val_accuracy1000: 0.3259 - 79s/epoch - 40ms/step
Epoch 10/50
1972/1972 - 79s - loss: 3.0210 - accuracy1000: 0.4902 - val_loss: 4.0704 - val_accuracy1000: 0.3258 - 79s/epoch - 40ms/step
Epoch 11/50
1972/1972 - 79s - loss: 3.0100 - accuracy1000: 0.4931 - val_loss: 4.0654 - val_accuracy1000: 0.3229 - 79s/epoch - 40ms/step
testing model: results/ATVI/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
4274/4274 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2241775
{'0': {'precision': 0.3566708347689413, 'recall': 0.23665945718234174, 'f1-score': 0.28452795110660223, 'support': 389302}, '1': {'precision': 0.2822002248791002, 'recall': 0.752785030883671, 'f1-score': 0.41051039870984357, 'support': 309063}, '2': {'precision': 0.4324993369286535, 'recall': 0.012362901187768512, 'f1-score': 0.02403866234573513, 'support': 395700}, 'accuracy': 0.30133675787087605, 'macro avg': {'precision': 0.357123465525565, 'recall': 0.3339357964179271, 'f1-score': 0.23969233738739368, 'support': 1094065}, 'weighted avg': {'precision': 0.36305914643252085, 'recall': 0.30133675787087605, 'f1-score': 0.2259033736280479, 'support': 1094065}}
[[ 92132 292909   4261]
 [ 74247 232658   2158]
 [ 91932 298876   4892]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1979167
{'0': {'precision': 0.33397627319521744, 'recall': 0.17764963287102276, 'f1-score': 0.23193025066670966, 'support': 161796}, '1': {'precision': 0.3399855909589543, 'recall': 0.7939188595077172, 'f1-score': 0.4760912129978873, 'support': 170593}, '2': {'precision': 0.3536912085731296, 'recall': 0.04140169927580419, 'f1-score': 0.07412644855391558, 'support': 172191}, 'accuracy': 0.3395081057513179, 'macro avg': {'precision': 0.34255102424243383, 'recall': 0.33765673055151474, 'f1-score': 0.2607159707395042, 'support': 504580}, 'weighted avg': {'precision': 0.3427357998964883, 'recall': 0.3395081057513179, 'f1-score': 0.2606269024510817, 'support': 504580}}
[[ 28743 127413   5640]
 [ 27769 135437   7387]
 [ 29551 135511   7129]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2078836
{'0': {'precision': 0.3373091328147508, 'recall': 0.09211209541642408, 'f1-score': 0.1447075690908192, 'support': 63553}, '1': {'precision': 0.3306559772224928, 'recall': 0.7728450842352282, 'f1-score': 0.46315469100106527, 'support': 57102}, '2': {'precision': 0.3821407095610343, 'recall': 0.19033594568961215, 'f1-score': 0.25410682749658464, 'support': 60099}, 'accuracy': 0.3398209721499939, 'macro avg': {'precision': 0.350035273199426, 'recall': 0.35176437511375486, 'f1-score': 0.2873230291961564, 'support': 180754}, 'weighted avg': {'precision': 0.35011341067441515, 'recall': 0.3398209721499939, 'f1-score': 0.281682427662397, 'support': 180754}}
[[ 5854 46099 11600]
 [ 6076 44131  6895]
 [ 5425 43235 11439]]
training model: results/ATVI/W4/deepOF_L2/h10
Epoch 1/50
1972/1972 - 46s - loss: 2.8317 - accuracy10: 0.5155 - val_loss: 3.1317 - val_accuracy10: 0.4582 - 46s/epoch - 24ms/step
Epoch 2/50
1972/1972 - 44s - loss: 2.5822 - accuracy10: 0.5816 - val_loss: 2.8305 - val_accuracy10: 0.6434 - 44s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 2.5171 - accuracy10: 0.5962 - val_loss: 2.7631 - val_accuracy10: 0.6536 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 2.4913 - accuracy10: 0.5998 - val_loss: 2.7487 - val_accuracy10: 0.6616 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.4723 - accuracy10: 0.6030 - val_loss: 2.7387 - val_accuracy10: 0.6603 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 2.4579 - accuracy10: 0.6048 - val_loss: 2.7306 - val_accuracy10: 0.6536 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 42s - loss: 2.4480 - accuracy10: 0.6061 - val_loss: 2.7407 - val_accuracy10: 0.6590 - 42s/epoch - 21ms/step
Epoch 8/50
1972/1972 - 43s - loss: 2.4380 - accuracy10: 0.6076 - val_loss: 2.7497 - val_accuracy10: 0.6571 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 43s - loss: 2.4305 - accuracy10: 0.6086 - val_loss: 2.7624 - val_accuracy10: 0.6587 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 43s - loss: 2.4223 - accuracy10: 0.6098 - val_loss: 2.7262 - val_accuracy10: 0.6418 - 43s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 2.4171 - accuracy10: 0.6105 - val_loss: 2.7380 - val_accuracy10: 0.6580 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 42s - loss: 2.4098 - accuracy10: 0.6114 - val_loss: 2.7630 - val_accuracy10: 0.6584 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 43s - loss: 2.4030 - accuracy10: 0.6122 - val_loss: 2.7419 - val_accuracy10: 0.6600 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 43s - loss: 2.3969 - accuracy10: 0.6131 - val_loss: 2.7394 - val_accuracy10: 0.6513 - 43s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 42s - loss: 2.3913 - accuracy10: 0.6137 - val_loss: 2.7210 - val_accuracy10: 0.6438 - 42s/epoch - 21ms/step
Epoch 16/50
1972/1972 - 43s - loss: 2.3856 - accuracy10: 0.6149 - val_loss: 2.7328 - val_accuracy10: 0.6487 - 43s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 43s - loss: 2.3805 - accuracy10: 0.6149 - val_loss: 2.7262 - val_accuracy10: 0.6462 - 43s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 44s - loss: 2.3772 - accuracy10: 0.6150 - val_loss: 2.7109 - val_accuracy10: 0.6404 - 44s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 45s - loss: 2.3709 - accuracy10: 0.6159 - val_loss: 2.7199 - val_accuracy10: 0.6374 - 45s/epoch - 23ms/step
Epoch 20/50
1972/1972 - 43s - loss: 2.3670 - accuracy10: 0.6159 - val_loss: 2.7276 - val_accuracy10: 0.6371 - 43s/epoch - 22ms/step
Epoch 21/50
1972/1972 - 43s - loss: 2.3615 - accuracy10: 0.6161 - val_loss: 2.7163 - val_accuracy10: 0.6396 - 43s/epoch - 22ms/step
Epoch 22/50
1972/1972 - 43s - loss: 2.3589 - accuracy10: 0.6172 - val_loss: 2.7562 - val_accuracy10: 0.6371 - 43s/epoch - 22ms/step
Epoch 23/50
1972/1972 - 43s - loss: 2.3539 - accuracy10: 0.6181 - val_loss: 2.7699 - val_accuracy10: 0.6295 - 43s/epoch - 22ms/step
Epoch 24/50
1972/1972 - 43s - loss: 2.3492 - accuracy10: 0.6184 - val_loss: 2.7816 - val_accuracy10: 0.6396 - 43s/epoch - 22ms/step
Epoch 25/50
1972/1972 - 43s - loss: 2.3463 - accuracy10: 0.6189 - val_loss: 2.7230 - val_accuracy10: 0.6407 - 43s/epoch - 22ms/step
Epoch 26/50
1972/1972 - 44s - loss: 2.3416 - accuracy10: 0.6191 - val_loss: 2.7490 - val_accuracy10: 0.6324 - 44s/epoch - 22ms/step
Epoch 27/50
1972/1972 - 45s - loss: 2.3386 - accuracy10: 0.6191 - val_loss: 2.7483 - val_accuracy10: 0.6286 - 45s/epoch - 23ms/step
Epoch 28/50
1972/1972 - 44s - loss: 2.3340 - accuracy10: 0.6203 - val_loss: 2.7234 - val_accuracy10: 0.6383 - 44s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h10
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9758008
{'0': {'precision': 0.3590708114805574, 'recall': 0.7335905160269608, 'f1-score': 0.4821456296712016, 'support': 230705}, '1': {'precision': 0.7799695388641666, 'recall': 0.5149194899852245, 'f1-score': 0.6203180476597584, 'support': 635511}, '2': {'precision': 0.466688651106933, 'recall': 0.4161557198972986, 'f1-score': 0.43997596393662464, 'support': 227845}, 'accuracy': 0.5404625519052411, 'macro avg': {'precision': 0.5352430004838856, 'recall': 0.5548885753031613, 'f1-score': 0.5141465470891949, 'support': 1094061}, 'weighted avg': {'precision': 0.6259717958022327, 'recall': 0.5404625519052411, 'f1-score': 0.5536242255072941, 'support': 1094061}}
[[169243  38683  22779]
 [222698 327237  85576]
 [ 79395  53631  94819]]
Evaluating performance on  train set...
1972/1972 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8150821
{'0': {'precision': 0.3822391467851988, 'recall': 0.6496009949217536, 'f1-score': 0.4812817800225233, 'support': 86841}, '1': {'precision': 0.8270253865757923, 'recall': 0.6835563157878831, 'f1-score': 0.7484777889553662, 'support': 330893}, '2': {'precision': 0.4798749745518125, 'recall': 0.4614188823509091, 'f1-score': 0.47046599274417944, 'support': 86843}, 'accuracy': 0.6394801982650814, 'macro avg': {'precision': 0.5630465026376011, 'recall': 0.5981920643535152, 'f1-score': 0.5667418539073563, 'support': 504577}, 'weighted avg': {'precision': 0.6907265360910231, 'recall': 0.6394801982650814, 'f1-score': 0.6546428598363119, 'support': 504577}}
[[ 56412  21501   8928]
 [ 70205 226184  34504]
 [ 20966  25806  40071]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8173028
{'0': {'precision': 0.39566125982684847, 'recall': 0.6202034067511075, 'f1-score': 0.4831164412690312, 'support': 32054}, '1': {'precision': 0.8053737951571194, 'recall': 0.6998255096395285, 'f1-score': 0.7488989994216046, 'support': 117485}, '2': {'precision': 0.47943422117448364, 'recall': 0.43652090341182126, 'f1-score': 0.45697229861157695, 'support': 31215}, 'accuracy': 0.6402347942507496, 'macro avg': {'precision': 0.5601564253861505, 'recall': 0.5855166066008191, 'f1-score': 0.5629959131007376, 'support': 180754}, 'weighted avg': {'precision': 0.6764298746389319, 'recall': 0.6402347942507496, 'f1-score': 0.6513526873908467, 'support': 180754}}
[[19880  9232  2942]
 [23413 82219 11853]
 [ 6952 10637 13626]]
training model: results/ATVI/W4/deepOF_L2/h20
Epoch 1/50
1972/1972 - 45s - loss: 2.9056 - accuracy20: 0.5118 - val_loss: 3.0262 - val_accuracy20: 0.5966 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 2.6765 - accuracy20: 0.5751 - val_loss: 2.9110 - val_accuracy20: 0.5726 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 44s - loss: 2.6245 - accuracy20: 0.5865 - val_loss: 2.8384 - val_accuracy20: 0.5865 - 44s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 2.6000 - accuracy20: 0.5904 - val_loss: 2.8269 - val_accuracy20: 0.6053 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.5848 - accuracy20: 0.5933 - val_loss: 2.8318 - val_accuracy20: 0.5963 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 2.5720 - accuracy20: 0.5946 - val_loss: 2.8037 - val_accuracy20: 0.6009 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 2.5622 - accuracy20: 0.5966 - val_loss: 2.7942 - val_accuracy20: 0.6004 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 42s - loss: 2.5534 - accuracy20: 0.5985 - val_loss: 2.8076 - val_accuracy20: 0.6018 - 42s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 43s - loss: 2.5470 - accuracy20: 0.5989 - val_loss: 2.7839 - val_accuracy20: 0.5972 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 44s - loss: 2.5388 - accuracy20: 0.6004 - val_loss: 2.7884 - val_accuracy20: 0.5967 - 44s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 44s - loss: 2.5348 - accuracy20: 0.6011 - val_loss: 2.7935 - val_accuracy20: 0.5979 - 44s/epoch - 23ms/step
Epoch 12/50
1972/1972 - 44s - loss: 2.5279 - accuracy20: 0.6023 - val_loss: 2.7914 - val_accuracy20: 0.5967 - 44s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 44s - loss: 2.5224 - accuracy20: 0.6031 - val_loss: 2.7861 - val_accuracy20: 0.5882 - 44s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 44s - loss: 2.5172 - accuracy20: 0.6040 - val_loss: 2.7888 - val_accuracy20: 0.5840 - 44s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 44s - loss: 2.5128 - accuracy20: 0.6047 - val_loss: 2.7841 - val_accuracy20: 0.5868 - 44s/epoch - 23ms/step
Epoch 16/50
1972/1972 - 44s - loss: 2.5073 - accuracy20: 0.6056 - val_loss: 2.7861 - val_accuracy20: 0.5841 - 44s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 44s - loss: 2.5037 - accuracy20: 0.6062 - val_loss: 2.7797 - val_accuracy20: 0.5790 - 44s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 44s - loss: 2.4994 - accuracy20: 0.6062 - val_loss: 2.7811 - val_accuracy20: 0.5859 - 44s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 45s - loss: 2.4950 - accuracy20: 0.6072 - val_loss: 2.7745 - val_accuracy20: 0.5800 - 45s/epoch - 23ms/step
Epoch 20/50
1972/1972 - 44s - loss: 2.4905 - accuracy20: 0.6072 - val_loss: 2.7845 - val_accuracy20: 0.5851 - 44s/epoch - 22ms/step
Epoch 21/50
1972/1972 - 45s - loss: 2.4863 - accuracy20: 0.6081 - val_loss: 2.7888 - val_accuracy20: 0.5860 - 45s/epoch - 23ms/step
Epoch 22/50
1972/1972 - 44s - loss: 2.4820 - accuracy20: 0.6089 - val_loss: 2.7769 - val_accuracy20: 0.5710 - 44s/epoch - 22ms/step
Epoch 23/50
1972/1972 - 43s - loss: 2.4788 - accuracy20: 0.6087 - val_loss: 2.7700 - val_accuracy20: 0.5812 - 43s/epoch - 22ms/step
Epoch 24/50
1972/1972 - 43s - loss: 2.4742 - accuracy20: 0.6098 - val_loss: 2.7758 - val_accuracy20: 0.5826 - 43s/epoch - 22ms/step
Epoch 25/50
1972/1972 - 43s - loss: 2.4692 - accuracy20: 0.6099 - val_loss: 2.7809 - val_accuracy20: 0.5821 - 43s/epoch - 22ms/step
Epoch 26/50
1972/1972 - 43s - loss: 2.4666 - accuracy20: 0.6105 - val_loss: 2.7612 - val_accuracy20: 0.5781 - 43s/epoch - 22ms/step
Epoch 27/50
1972/1972 - 42s - loss: 2.4612 - accuracy20: 0.6112 - val_loss: 2.7723 - val_accuracy20: 0.5820 - 42s/epoch - 21ms/step
Epoch 28/50
1972/1972 - 42s - loss: 2.4571 - accuracy20: 0.6117 - val_loss: 2.7707 - val_accuracy20: 0.5754 - 42s/epoch - 22ms/step
Epoch 29/50
1972/1972 - 43s - loss: 2.4553 - accuracy20: 0.6121 - val_loss: 2.7726 - val_accuracy20: 0.5528 - 43s/epoch - 22ms/step
Epoch 30/50
1972/1972 - 43s - loss: 2.4505 - accuracy20: 0.6125 - val_loss: 2.7719 - val_accuracy20: 0.5608 - 43s/epoch - 22ms/step
Epoch 31/50
1972/1972 - 43s - loss: 2.4459 - accuracy20: 0.6127 - val_loss: 2.7758 - val_accuracy20: 0.5643 - 43s/epoch - 22ms/step
Epoch 32/50
1972/1972 - 43s - loss: 2.4428 - accuracy20: 0.6136 - val_loss: 2.7666 - val_accuracy20: 0.5577 - 43s/epoch - 22ms/step
Epoch 33/50
1972/1972 - 43s - loss: 2.4387 - accuracy20: 0.6146 - val_loss: 2.7699 - val_accuracy20: 0.5727 - 43s/epoch - 22ms/step
Epoch 34/50
1972/1972 - 43s - loss: 2.4354 - accuracy20: 0.6145 - val_loss: 2.7649 - val_accuracy20: 0.5617 - 43s/epoch - 22ms/step
Epoch 35/50
1972/1972 - 42s - loss: 2.4318 - accuracy20: 0.6148 - val_loss: 2.7751 - val_accuracy20: 0.5632 - 42s/epoch - 22ms/step
Epoch 36/50
1972/1972 - 43s - loss: 2.4282 - accuracy20: 0.6151 - val_loss: 2.7654 - val_accuracy20: 0.5619 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h20
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233003
{'0': {'precision': 0.43469664444695516, 'recall': 0.6200519731673415, 'f1-score': 0.5110876802630159, 'support': 297846}, '1': {'precision': 0.6951715590016682, 'recall': 0.38307056050922533, 'f1-score': 0.4939516903265447, 'support': 503667}, '2': {'precision': 0.43519289197538746, 'recall': 0.5826462665955672, 'f1-score': 0.49823886539085505, 'support': 292548}, 'accuracy': 0.5009519578890025, 'macro avg': {'precision': 0.5216870318080037, 'recall': 0.5285896000907113, 'f1-score': 0.5010927453268051, 'support': 1094061}, 'weighted avg': {'precision': 0.5547427799101299, 'recall': 0.5009519578890025, 'f1-score': 0.4997631492391026, 'support': 1094061}}
[[184680  41779  71387]
 [160896 192940 149831]
 [ 79272  42824 170452]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8956805
{'0': {'precision': 0.45155031972936815, 'recall': 0.5711261117607456, 'f1-score': 0.5043475539875069, 'support': 112884}, '1': {'precision': 0.7647745547121512, 'recall': 0.5855043540061882, 'f1-score': 0.6632390222878205, 'support': 278594}, '2': {'precision': 0.4507342890425625, 'recall': 0.5918619970114678, 'f1-score': 0.5117464928710677, 'support': 113099}, 'accuracy': 0.583712693999132, 'macro avg': {'precision': 0.5556863878280273, 'recall': 0.5828308209261338, 'f1-score': 0.559777689715465, 'support': 504577}, 'weighted avg': {'precision': 0.6243090865105461, 'recall': 0.583712693999132, 'f1-score': 0.5937353427857466, 'support': 504577}}
[[ 64471  25836  22577]
 [ 56481 163118  58995]
 [ 21825  24335  66939]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9036247
{'0': {'precision': 0.458010462966605, 'recall': 0.5536193985498633, 'f1-score': 0.5012969400824444, 'support': 42065}, '1': {'precision': 0.7315956144888407, 'recall': 0.5949337218369106, 'f1-score': 0.6562250677591115, 'support': 97468}, '2': {'precision': 0.45522933243824903, 'recall': 0.55932655685209, 'f1-score': 0.5019375625898028, 'support': 41221}, 'accuracy': 0.5771988448388418, 'macro avg': {'precision': 0.548278469964565, 'recall': 0.569293225746288, 'f1-score': 0.5531531901437863, 'support': 180754}, 'weighted avg': {'precision': 0.60490157778044, 'recall': 0.5771988448388418, 'f1-score': 0.5849849461501675, 'support': 180754}}
[[23288 10864  7913]
 [19803 57987 19678]
 [ 7755 10410 23056]]
training model: results/ATVI/W4/deepOF_L2/h30
Epoch 1/50
1972/1972 - 46s - loss: 2.9681 - accuracy30: 0.5006 - val_loss: 3.1633 - val_accuracy30: 0.5451 - 46s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 2.7707 - accuracy30: 0.5576 - val_loss: 3.0033 - val_accuracy30: 0.5592 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 2.7169 - accuracy30: 0.5686 - val_loss: 2.9382 - val_accuracy30: 0.5686 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 2.6936 - accuracy30: 0.5734 - val_loss: 2.9294 - val_accuracy30: 0.5750 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.6786 - accuracy30: 0.5758 - val_loss: 2.9292 - val_accuracy30: 0.5757 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 2.6682 - accuracy30: 0.5782 - val_loss: 2.9303 - val_accuracy30: 0.5733 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 2.6589 - accuracy30: 0.5794 - val_loss: 2.9288 - val_accuracy30: 0.5738 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 2.6519 - accuracy30: 0.5802 - val_loss: 2.9430 - val_accuracy30: 0.5724 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 43s - loss: 2.6445 - accuracy30: 0.5821 - val_loss: 2.9105 - val_accuracy30: 0.5755 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 43s - loss: 2.6402 - accuracy30: 0.5822 - val_loss: 2.9214 - val_accuracy30: 0.5763 - 43s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 2.6329 - accuracy30: 0.5840 - val_loss: 2.9090 - val_accuracy30: 0.5774 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 44s - loss: 2.6282 - accuracy30: 0.5844 - val_loss: 2.9132 - val_accuracy30: 0.5770 - 44s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 43s - loss: 2.6235 - accuracy30: 0.5854 - val_loss: 2.9157 - val_accuracy30: 0.5780 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 43s - loss: 2.6184 - accuracy30: 0.5869 - val_loss: 2.9199 - val_accuracy30: 0.5807 - 43s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 43s - loss: 2.6144 - accuracy30: 0.5866 - val_loss: 2.9215 - val_accuracy30: 0.5762 - 43s/epoch - 22ms/step
Epoch 16/50
1972/1972 - 43s - loss: 2.6093 - accuracy30: 0.5882 - val_loss: 2.9124 - val_accuracy30: 0.5770 - 43s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 43s - loss: 2.6058 - accuracy30: 0.5883 - val_loss: 2.9204 - val_accuracy30: 0.5769 - 43s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 42s - loss: 2.6016 - accuracy30: 0.5889 - val_loss: 2.9103 - val_accuracy30: 0.5775 - 42s/epoch - 21ms/step
Epoch 19/50
1972/1972 - 43s - loss: 2.5971 - accuracy30: 0.5901 - val_loss: 2.9109 - val_accuracy30: 0.5755 - 43s/epoch - 22ms/step
Epoch 20/50
1972/1972 - 43s - loss: 2.5925 - accuracy30: 0.5905 - val_loss: 2.9184 - val_accuracy30: 0.5791 - 43s/epoch - 22ms/step
Epoch 21/50
1972/1972 - 43s - loss: 2.5896 - accuracy30: 0.5916 - val_loss: 2.9393 - val_accuracy30: 0.5769 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h30
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0014572
{'0': {'precision': 0.49625167902997447, 'recall': 0.4813840948241709, 'f1-score': 0.4887048361028147, 'support': 340757}, '1': {'precision': 0.5811639718330593, 'recall': 0.45207018715780184, 'f1-score': 0.5085524965077475, 'support': 419165}, '2': {'precision': 0.4506911536448154, 'recall': 0.5900478543360698, 'f1-score': 0.5110394558810569, 'support': 334139}, 'accuracy': 0.5033403073503214, 'macro avg': {'precision': 0.5093689348359498, 'recall': 0.5078340454393474, 'f1-score': 0.5027655961638731, 'support': 1094061}, 'weighted avg': {'precision': 0.5148692084192256, 'recall': 0.5033403073503214, 'f1-score': 0.5031302768156412, 'support': 1094061}}
[[164035  73220 103502]
 [ 92876 189492 136797]
 [ 73637  63344 197158]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9042586
{'0': {'precision': 0.5134825431759688, 'recall': 0.4322902709614192, 'f1-score': 0.46940132853354166, 'support': 130609}, '1': {'precision': 0.6542964558217328, 'recall': 0.7276015455581663, 'f1-score': 0.6890047051717924, 'support': 243019}, '2': {'precision': 0.5086593661054561, 'recall': 0.4831193823549626, 'f1-score': 0.49556052529541006, 'support': 130949}, 'accuracy': 0.587712083586846, 'macro avg': {'precision': 0.5588127883677193, 'recall': 0.5476703996248494, 'f1-score': 0.5513221863335813, 'support': 504577}, 'weighted avg': {'precision': 0.5800509084067549, 'recall': 0.587712083586846, 'f1-score': 0.5819576155700513, 'support': 504577}}
[[ 56461  48541  25607]
 [ 30695 176821  35503]
 [ 22801  44884  63264]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92117125
{'0': {'precision': 0.5318725099601593, 'recall': 0.41543658511618387, 'f1-score': 0.4664988447877513, 'support': 48845}, '1': {'precision': 0.6188973063973064, 'recall': 0.7360473846667223, 'f1-score': 0.6724078801966238, 'support': 83909}, '2': {'precision': 0.5165849100677412, 'recall': 0.4607291666666667, 'f1-score': 0.487060896377051, 'support': 48000}, 'accuracy': 0.57629706673158, 'macro avg': {'precision': 0.5557849088084024, 'recall': 0.5374043788165243, 'f1-score': 0.5419892071204754, 'support': 180754}, 'weighted avg': {'precision': 0.5682111738315454, 'recall': 0.57629706673158, 'f1-score': 0.5675455697753559, 'support': 180754}}
[[20292 19966  8587]
 [10040 61761 12108]
 [ 7820 18065 22115]]
training model: results/ATVI/W4/deepOF_L2/h50
Epoch 1/50
1972/1972 - 45s - loss: 3.0484 - accuracy50: 0.4777 - val_loss: 3.2044 - val_accuracy50: 0.4586 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 2.9035 - accuracy50: 0.5207 - val_loss: 3.0874 - val_accuracy50: 0.4907 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 2.8553 - accuracy50: 0.5319 - val_loss: 3.0360 - val_accuracy50: 0.5014 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 2.8332 - accuracy50: 0.5372 - val_loss: 3.0231 - val_accuracy50: 0.5037 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.8197 - accuracy50: 0.5399 - val_loss: 3.0140 - val_accuracy50: 0.5070 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 2.8099 - accuracy50: 0.5424 - val_loss: 3.0191 - val_accuracy50: 0.5059 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 2.8018 - accuracy50: 0.5441 - val_loss: 3.0149 - val_accuracy50: 0.5078 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 2.7949 - accuracy50: 0.5457 - val_loss: 3.0270 - val_accuracy50: 0.5063 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 44s - loss: 2.7886 - accuracy50: 0.5468 - val_loss: 3.0231 - val_accuracy50: 0.5062 - 44s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 44s - loss: 2.7834 - accuracy50: 0.5481 - val_loss: 3.0222 - val_accuracy50: 0.5072 - 44s/epoch - 23ms/step
Epoch 11/50
1972/1972 - 44s - loss: 2.7784 - accuracy50: 0.5492 - val_loss: 3.0048 - val_accuracy50: 0.5097 - 44s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 44s - loss: 2.7735 - accuracy50: 0.5504 - val_loss: 3.0289 - val_accuracy50: 0.5069 - 44s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 43s - loss: 2.7689 - accuracy50: 0.5513 - val_loss: 3.0181 - val_accuracy50: 0.5088 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 43s - loss: 2.7642 - accuracy50: 0.5522 - val_loss: 3.0210 - val_accuracy50: 0.5091 - 43s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 43s - loss: 2.7598 - accuracy50: 0.5533 - val_loss: 3.0217 - val_accuracy50: 0.5074 - 43s/epoch - 22ms/step
Epoch 16/50
1972/1972 - 42s - loss: 2.7557 - accuracy50: 0.5542 - val_loss: 3.0174 - val_accuracy50: 0.5103 - 42s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 43s - loss: 2.7520 - accuracy50: 0.5548 - val_loss: 3.0263 - val_accuracy50: 0.5058 - 43s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 42s - loss: 2.7481 - accuracy50: 0.5558 - val_loss: 3.0353 - val_accuracy50: 0.5071 - 42s/epoch - 21ms/step
Epoch 19/50
1972/1972 - 43s - loss: 2.7441 - accuracy50: 0.5560 - val_loss: 3.0319 - val_accuracy50: 0.5078 - 43s/epoch - 22ms/step
Epoch 20/50
1972/1972 - 42s - loss: 2.7389 - accuracy50: 0.5578 - val_loss: 3.0343 - val_accuracy50: 0.5077 - 42s/epoch - 22ms/step
Epoch 21/50
1972/1972 - 42s - loss: 2.7351 - accuracy50: 0.5585 - val_loss: 3.0403 - val_accuracy50: 0.5070 - 42s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h50
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0156004
{'0': {'precision': 0.4947556480593847, 'recall': 0.4895816688099387, 'f1-score': 0.4921550604226718, 'support': 394257}, '1': {'precision': 0.44408325685341776, 'recall': 0.40497950760758106, 'f1-score': 0.42363091687676785, 'support': 313043}, '2': {'precision': 0.477336545194277, 'recall': 0.5164455568167421, 'f1-score': 0.49612150867475563, 'support': 386761}, 'accuracy': 0.4748711452103676, 'macro avg': {'precision': 0.4720584833690265, 'recall': 0.47033557774475393, 'f1-score': 0.47063582865806514, 'support': 1094061}, 'weighted avg': {'precision': 0.4740989689496263, 'recall': 0.4748711452103676, 'f1-score': 0.47395046673400526, 'support': 1094061}}
[[193021  83864 117372]
 [ 84931 126776 101336]
 [112182  74838 199741]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.955676
{'0': {'precision': 0.525375161647455, 'recall': 0.36548916560954775, 'f1-score': 0.431084562682494, 'support': 154508}, '1': {'precision': 0.5324935265393853, 'recall': 0.7587200937268765, 'f1-score': 0.6257888424095241, 'support': 194608}, '2': {'precision': 0.5331040699809689, 'recall': 0.41082972578331545, 'f1-score': 0.4640473725319238, 'support': 155461}, 'accuracy': 0.5311221082213419, 'macro avg': {'precision': 0.5303242527226031, 'recall': 0.5116796617065799, 'f1-score': 0.506973592541314, 'support': 504577}, 'weighted avg': {'precision': 0.5305019006255003, 'recall': 0.5311221082213419, 'f1-score': 0.5163350633020627, 'support': 504577}}
[[ 56471  67670  30367]
 [ 21386 147653  25569]
 [ 29630  61963  63868]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9832445
{'0': {'precision': 0.531322505800464, 'recall': 0.34340526751241035, 'f1-score': 0.41717881335525003, 'support': 58016}, '1': {'precision': 0.48871540515951045, 'recall': 0.7590136286977529, 'f1-score': 0.594586874241234, 'support': 65817}, '2': {'precision': 0.5359910327013987, 'recall': 0.386430315700708, 'f1-score': 0.44908584203595386, 'support': 56921}, 'accuracy': 0.5082875067771667, 'macro avg': {'precision': 0.518676314553791, 'recall': 0.49628307063695715, 'f1-score': 0.4869505098774793, 'support': 180754}, 'weighted avg': {'precision': 0.5172783666768068, 'recall': 0.5082875067771667, 'f1-score': 0.49182527386437935, 'support': 180754}}
[[19923 27565 10528]
 [ 7347 49956  8514]
 [10227 24698 21996]]
training model: results/ATVI/W4/deepOF_L2/h100
Epoch 1/50
1972/1972 - 45s - loss: 3.1860 - accuracy100: 0.4279 - val_loss: 3.2407 - val_accuracy100: 0.3858 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 3.1131 - accuracy100: 0.4574 - val_loss: 3.2725 - val_accuracy100: 0.3945 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.0878 - accuracy100: 0.4646 - val_loss: 3.2598 - val_accuracy100: 0.3993 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 42s - loss: 3.0725 - accuracy100: 0.4679 - val_loss: 3.2436 - val_accuracy100: 0.4092 - 42s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 3.0613 - accuracy100: 0.4720 - val_loss: 3.2427 - val_accuracy100: 0.4117 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 3.0536 - accuracy100: 0.4746 - val_loss: 3.2425 - val_accuracy100: 0.4112 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 3.0473 - accuracy100: 0.4762 - val_loss: 3.2277 - val_accuracy100: 0.4146 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 3.0411 - accuracy100: 0.4778 - val_loss: 3.2476 - val_accuracy100: 0.4138 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 43s - loss: 3.0368 - accuracy100: 0.4794 - val_loss: 3.2382 - val_accuracy100: 0.4223 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 44s - loss: 3.0327 - accuracy100: 0.4808 - val_loss: 3.2208 - val_accuracy100: 0.4240 - 44s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.0282 - accuracy100: 0.4823 - val_loss: 3.2040 - val_accuracy100: 0.4278 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 43s - loss: 3.0239 - accuracy100: 0.4828 - val_loss: 3.2022 - val_accuracy100: 0.4272 - 43s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 43s - loss: 3.0200 - accuracy100: 0.4846 - val_loss: 3.2115 - val_accuracy100: 0.4287 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 42s - loss: 3.0168 - accuracy100: 0.4855 - val_loss: 3.2047 - val_accuracy100: 0.4292 - 42s/epoch - 21ms/step
Epoch 15/50
1972/1972 - 43s - loss: 3.0131 - accuracy100: 0.4862 - val_loss: 3.2138 - val_accuracy100: 0.4271 - 43s/epoch - 22ms/step
Epoch 16/50
1972/1972 - 43s - loss: 3.0074 - accuracy100: 0.4881 - val_loss: 3.2247 - val_accuracy100: 0.4266 - 43s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 42s - loss: 3.0039 - accuracy100: 0.4893 - val_loss: 3.2255 - val_accuracy100: 0.4279 - 42s/epoch - 21ms/step
Epoch 18/50
1972/1972 - 43s - loss: 3.0001 - accuracy100: 0.4903 - val_loss: 3.2106 - val_accuracy100: 0.4293 - 43s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 43s - loss: 2.9954 - accuracy100: 0.4916 - val_loss: 3.2279 - val_accuracy100: 0.4254 - 43s/epoch - 22ms/step
Epoch 20/50
1972/1972 - 43s - loss: 2.9925 - accuracy100: 0.4931 - val_loss: 3.2319 - val_accuracy100: 0.4224 - 43s/epoch - 22ms/step
Epoch 21/50
1972/1972 - 43s - loss: 2.9874 - accuracy100: 0.4947 - val_loss: 3.2157 - val_accuracy100: 0.4250 - 43s/epoch - 22ms/step
Epoch 22/50
1972/1972 - 43s - loss: 2.9845 - accuracy100: 0.4959 - val_loss: 3.2448 - val_accuracy100: 0.4226 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h100
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0666744
{'0': {'precision': 0.461412348185775, 'recall': 0.3339017168159604, 'f1-score': 0.38743530889014965, 'support': 402897}, '1': {'precision': 0.32919015038093435, 'recall': 0.4491085588804266, 'f1-score': 0.37991098347193947, 'support': 286895}, '2': {'precision': 0.4544999002670896, 'recall': 0.46217741157496617, 'f1-score': 0.45830650492354974, 'support': 404269}, 'accuracy': 0.41151178956200796, 'macro avg': {'precision': 0.4150341329445996, 'recall': 0.4150625624237844, 'f1-score': 0.4085509324285463, 'support': 1094061}, 'weighted avg': {'precision': 0.42418556115391953, 'recall': 0.41151178956200796, 'f1-score': 0.41164998815242954, 'support': 1094061}}
[[134528 137540 130829]
 [ 64623 128847  93425]
 [ 92406 125019 186844]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0428239
{'0': {'precision': 0.4892482978381972, 'recall': 0.2558978878517, 'f1-score': 0.3360350182452301, 'support': 166797}, '1': {'precision': 0.41452556083049774, 'recall': 0.7326774867350123, 'f1-score': 0.5294852497842013, 'support': 166604}, '2': {'precision': 0.49680533285582895, 'recall': 0.3565803617329532, 'f1-score': 0.4151722402282706, 'support': 171176}, 'accuracy': 0.4474797701837381, 'macro avg': {'precision': 0.4668597305081746, 'recall': 0.4483852454398885, 'f1-score': 0.42689750275256727, 'support': 504577}, 'weighted avg': {'precision': 0.46713963285693044, 'recall': 0.4474797701837381, 'f1-score': 0.4267565047289336, 'support': 504577}}
[[ 42683  89513  34601]
 [ 17315 122067  27222]
 [ 27244  82894  61038]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0680279
{'0': {'precision': 0.4964383924725839, 'recall': 0.24110576536276893, 'f1-score': 0.32457489440051984, 'support': 62147}, '1': {'precision': 0.38250783466538096, 'recall': 0.7249547507336531, 'f1-score': 0.5007859869750729, 'support': 56907}, '2': {'precision': 0.4874405974202308, 'recall': 0.33747163695299837, 'f1-score': 0.39882394629227047, 'support': 61700}, 'accuracy': 0.4263308142558394, 'macro avg': {'precision': 0.45546227485273194, 'recall': 0.43451071768314015, 'f1-score': 0.4080616092226211, 'support': 180754}, 'weighted avg': {'precision': 0.45749811890815556, 'recall': 0.4263308142558394, 'f1-score': 0.4053964040039649, 'support': 180754}}
[[14984 35024 12139]
 [ 5896 41255  9756]
 [ 9303 31575 20822]]
training model: results/ATVI/W4/deepOF_L2/h200
Epoch 1/50
1972/1972 - 45s - loss: 3.2637 - accuracy200: 0.3869 - val_loss: 3.2876 - val_accuracy200: 0.3726 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 44s - loss: 3.2301 - accuracy200: 0.4045 - val_loss: 3.2843 - val_accuracy200: 0.3775 - 44s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.2184 - accuracy200: 0.4112 - val_loss: 3.2939 - val_accuracy200: 0.3747 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 3.2107 - accuracy200: 0.4149 - val_loss: 3.3037 - val_accuracy200: 0.3718 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 42s - loss: 3.2056 - accuracy200: 0.4165 - val_loss: 3.2955 - val_accuracy200: 0.3761 - 42s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 3.2013 - accuracy200: 0.4188 - val_loss: 3.2993 - val_accuracy200: 0.3745 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 3.1966 - accuracy200: 0.4208 - val_loss: 3.2946 - val_accuracy200: 0.3767 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 42s - loss: 3.1933 - accuracy200: 0.4222 - val_loss: 3.2929 - val_accuracy200: 0.3806 - 42s/epoch - 21ms/step
Epoch 9/50
1972/1972 - 43s - loss: 3.1896 - accuracy200: 0.4231 - val_loss: 3.2986 - val_accuracy200: 0.3799 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 42s - loss: 3.1852 - accuracy200: 0.4266 - val_loss: 3.2937 - val_accuracy200: 0.3821 - 42s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.1824 - accuracy200: 0.4272 - val_loss: 3.2983 - val_accuracy200: 0.3832 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 43s - loss: 3.1786 - accuracy200: 0.4289 - val_loss: 3.2962 - val_accuracy200: 0.3846 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h200
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089533
{'0': {'precision': 0.4236599138552851, 'recall': 0.2147818069264906, 'f1-score': 0.2850516777278786, 'support': 382849}, '1': {'precision': 0.37006753029919054, 'recall': 0.15480771029640117, 'f1-score': 0.2182968545273877, 'support': 320714}, '2': {'precision': 0.38346737493911653, 'recall': 0.7520192164876645, 'f1-score': 0.5079317308149666, 'support': 390498}, 'accuracy': 0.3889545464101179, 'macro avg': {'precision': 0.3923982730311974, 'recall': 0.37386957790351877, 'f1-score': 0.33709342102341094, 'support': 1094061}, 'weighted avg': {'precision': 0.39360406343972754, 'recall': 0.3889545464101179, 'f1-score': 0.345034629869011, 'support': 1094061}}
[[ 82229  43332 257288]
 [ 56208  49649 214857]
 [ 55655  41181 293662]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859884
{'0': {'precision': 0.41200201714573875, 'recall': 0.2612002871327144, 'f1-score': 0.3197108640115772, 'support': 165777}, '1': {'precision': 0.39382291980888806, 'recall': 0.2424198861934711, 'f1-score': 0.30010714934542504, 'support': 166950}, '2': {'precision': 0.37818955144905314, 'recall': 0.6529706139074775, 'f1-score': 0.4789685868008648, 'support': 171850}, 'accuracy': 0.3884164359453562, 'macro avg': {'precision': 0.39467149613456004, 'recall': 0.38553026241122107, 'f1-score': 0.36626220005262233, 'support': 504577}, 'weighted avg': {'precision': 0.39447114964610513, 'recall': 0.3884164359453562, 'f1-score': 0.36746492235713196, 'support': 504577}}
[[ 43301  31244  91232]
 [ 33212  40472  93266]
 [ 28586  31051 112213]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935065
{'0': {'precision': 0.4115771912053864, 'recall': 0.2288198757763975, 'f1-score': 0.2941207779350869, 'support': 60375}, '1': {'precision': 0.37846226193275334, 'recall': 0.2665209544152468, 'f1-score': 0.3127775132866318, 'support': 60393}, '2': {'precision': 0.3653901278449808, 'recall': 0.6374987497082653, 'f1-score': 0.46452953038070016, 'support': 59986}, 'accuracy': 0.3770428316939044, 'macro avg': {'precision': 0.38514319366104016, 'recall': 0.37761319329996984, 'f1-score': 0.3571426072008063, 'support': 180754}, 'weighted avg': {'precision': 0.3851850388530213, 'recall': 0.3770428316939044, 'f1-score': 0.3569070822065742, 'support': 180754}}
[[13815 13685 32875]
 [10755 16096 33542]
 [ 8996 12749 38241]]
training model: results/ATVI/W4/deepOF_L2/h300
Epoch 1/50
1972/1972 - 46s - loss: 3.2704 - accuracy300: 0.3810 - val_loss: 3.2875 - val_accuracy300: 0.3616 - 46s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 3.2478 - accuracy300: 0.3938 - val_loss: 3.2819 - val_accuracy300: 0.3652 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.2409 - accuracy300: 0.3980 - val_loss: 3.2778 - val_accuracy300: 0.3680 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 43s - loss: 3.2385 - accuracy300: 0.3990 - val_loss: 3.2762 - val_accuracy300: 0.3713 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 42s - loss: 3.2335 - accuracy300: 0.4024 - val_loss: 3.2814 - val_accuracy300: 0.3705 - 42s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 42s - loss: 3.2301 - accuracy300: 0.4045 - val_loss: 3.2853 - val_accuracy300: 0.3661 - 42s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 42s - loss: 3.2270 - accuracy300: 0.4061 - val_loss: 3.2871 - val_accuracy300: 0.3659 - 42s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 3.2234 - accuracy300: 0.4081 - val_loss: 3.2900 - val_accuracy300: 0.3663 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 42s - loss: 3.2207 - accuracy300: 0.4090 - val_loss: 3.2886 - val_accuracy300: 0.3674 - 42s/epoch - 21ms/step
Epoch 10/50
1972/1972 - 43s - loss: 3.2174 - accuracy300: 0.4112 - val_loss: 3.2929 - val_accuracy300: 0.3651 - 43s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.2158 - accuracy300: 0.4119 - val_loss: 3.2919 - val_accuracy300: 0.3669 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 42s - loss: 3.2129 - accuracy300: 0.4138 - val_loss: 3.2952 - val_accuracy300: 0.3668 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 43s - loss: 3.2102 - accuracy300: 0.4152 - val_loss: 3.2992 - val_accuracy300: 0.3656 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 43s - loss: 3.2078 - accuracy300: 0.4167 - val_loss: 3.3005 - val_accuracy300: 0.3654 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h300
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855466
{'0': {'precision': 0.3152775876445186, 'recall': 0.16905172615135147, 'f1-score': 0.2200908303089143, 'support': 299713}, '1': {'precision': 0.45527563762081813, 'recall': 0.48210628175147163, 'f1-score': 0.46830697347434136, 'support': 496040}, '2': {'precision': 0.2979719762204655, 'recall': 0.40762232323638653, 'f1-score': 0.344277240617789, 'support': 298308}, 'accuracy': 0.3760375335561728, 'macro avg': {'precision': 0.3561750671619341, 'recall': 0.35292677704640324, 'f1-score': 0.34422501480034823, 'support': 1094061}, 'weighted avg': {'precision': 0.37403320582079685, 'recall': 0.3760375335561728, 'f1-score': 0.3664912004365381, 'support': 1094061}}
[[ 50667 148358 100688]
 [ 71099 239144 185797]
 [ 38940 137771 121597]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092192
{'0': {'precision': 0.3899870801033592, 'recall': 0.14592964581180465, 'f1-score': 0.212386267189101, 'support': 165477}, '1': {'precision': 0.3422457232139007, 'recall': 0.6201820192839452, 'f1-score': 0.44108172352391684, 'support': 166356}, '2': {'precision': 0.39123537576839185, 'recall': 0.31980271384244896, 'f1-score': 0.3519308930141298, 'support': 172744}, 'accuracy': 0.3618139550554227, 'macro avg': {'precision': 0.3744893930285505, 'recall': 0.3619714596460663, 'f1-score': 0.33513296124238257, 'support': 504577}, 'weighted avg': {'precision': 0.37467440120530726, 'recall': 0.3618139550554227, 'f1-score': 0.33555945617225597, 'support': 504577}}
[[ 24148  99787  41542]
 [ 18767 103171  44418]
 [ 19005  98495  55244]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911548
{'0': {'precision': 0.3879951397326853, 'recall': 0.13728997196759937, 'f1-score': 0.20281496913188182, 'support': 58147}, '1': {'precision': 0.3776026108589619, 'recall': 0.642487596910986, 'f1-score': 0.4756540003818981, 'support': 65911}, '2': {'precision': 0.35578364423717523, 'recall': 0.3014145618738535, 'f1-score': 0.32635016423497054, 'support': 56696}, 'accuracy': 0.3729875964017394, 'macro avg': {'precision': 0.3737937982762742, 'recall': 0.3603973769174796, 'f1-score': 0.3349397112495835, 'support': 180754}, 'weighted avg': {'precision': 0.3741019759896455, 'recall': 0.3729875964017394, 'f1-score': 0.3410528217397607, 'support': 180754}}
[[ 7983 36032 14132]
 [ 6753 42347 16811]
 [ 5839 33768 17089]]
training model: results/ATVI/W4/deepOF_L2/h500
Epoch 1/50
1972/1972 - 45s - loss: 3.2467 - accuracy500: 0.4033 - val_loss: 3.3273 - val_accuracy500: 0.3370 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 43s - loss: 3.2260 - accuracy500: 0.4098 - val_loss: 3.3168 - val_accuracy500: 0.3432 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.2155 - accuracy500: 0.4126 - val_loss: 3.3125 - val_accuracy500: 0.3469 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 42s - loss: 3.2128 - accuracy500: 0.4141 - val_loss: 3.3124 - val_accuracy500: 0.3495 - 42s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 3.2103 - accuracy500: 0.4150 - val_loss: 3.3122 - val_accuracy500: 0.3493 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 3.2091 - accuracy500: 0.4164 - val_loss: 3.3157 - val_accuracy500: 0.3496 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 42s - loss: 3.2086 - accuracy500: 0.4169 - val_loss: 3.3121 - val_accuracy500: 0.3516 - 42s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 3.2057 - accuracy500: 0.4186 - val_loss: 3.3073 - val_accuracy500: 0.3541 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 43s - loss: 3.2049 - accuracy500: 0.4192 - val_loss: 3.3094 - val_accuracy500: 0.3541 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 42s - loss: 3.2025 - accuracy500: 0.4205 - val_loss: 3.3110 - val_accuracy500: 0.3534 - 42s/epoch - 21ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.1983 - accuracy500: 0.4228 - val_loss: 3.3091 - val_accuracy500: 0.3512 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 42s - loss: 3.1965 - accuracy500: 0.4230 - val_loss: 3.3104 - val_accuracy500: 0.3542 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 44s - loss: 3.1941 - accuracy500: 0.4243 - val_loss: 3.3174 - val_accuracy500: 0.3527 - 44s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 44s - loss: 3.1915 - accuracy500: 0.4254 - val_loss: 3.3169 - val_accuracy500: 0.3519 - 44s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 44s - loss: 3.1902 - accuracy500: 0.4263 - val_loss: 3.3183 - val_accuracy500: 0.3502 - 44s/epoch - 23ms/step
Epoch 16/50
1972/1972 - 44s - loss: 3.1879 - accuracy500: 0.4276 - val_loss: 3.3176 - val_accuracy500: 0.3536 - 44s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 43s - loss: 3.1855 - accuracy500: 0.4288 - val_loss: 3.3260 - val_accuracy500: 0.3516 - 43s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 44s - loss: 3.1831 - accuracy500: 0.4297 - val_loss: 3.3314 - val_accuracy500: 0.3490 - 44s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h500
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106436
{'0': {'precision': 0.3522017098193647, 'recall': 0.42452555081723925, 'f1-score': 0.38499646513576496, 'support': 346349}, '1': {'precision': 0.347472399767577, 'recall': 0.04511266851241353, 'f1-score': 0.07985737846120976, 'support': 397671}, '2': {'precision': 0.33818484383000513, 'recall': 0.6037921272079556, 'f1-score': 0.4335421194439801, 'support': 350041}, 'accuracy': 0.3439716798240683, 'macro avg': {'precision': 0.34595298447231554, 'recall': 0.35781011551253616, 'f1-score': 0.2994653210136516, 'support': 1094061}, 'weighted avg': {'precision': 0.3459980454483782, 'recall': 0.3439716798240683, 'f1-score': 0.28961604634992477, 'support': 1094061}}
[[147034  16478 182837]
 [148960  17940 230771]
 [121477  17212 211352]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947652
{'0': {'precision': 0.3729571688515078, 'recall': 0.399705370942813, 'f1-score': 0.38586828231961606, 'support': 165632}, '1': {'precision': 0.3735261587261838, 'recall': 0.10721687771800985, 'f1-score': 0.16661004091016984, 'support': 166942}, '2': {'precision': 0.36519468237165364, 'recall': 0.592681522996692, 'f1-score': 0.4519250803502161, 'support': 172003}, 'accuracy': 0.3687167667174683, 'macro avg': {'precision': 0.37055933664978175, 'recall': 0.366534590552505, 'f1-score': 0.3348011345266673, 'support': 504577}, 'weighted avg': {'precision': 0.3704993028482294, 'recall': 0.3687167667174683, 'f1-score': 0.3358433269496359, 'support': 504577}}
[[ 66204  14450  84978]
 [ 56817  17899  92226]
 [ 54490  15570 101943]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012397
{'0': {'precision': 0.3711243499440458, 'recall': 0.37421592379940927, 'f1-score': 0.37266372514996776, 'support': 60262}, '1': {'precision': 0.36044088361969157, 'recall': 0.12422588265338697, 'f1-score': 0.18477060953172297, 'support': 62652}, '2': {'precision': 0.340284764779414, 'recall': 0.578890041493776, 'f1-score': 0.42861806102267713, 'support': 57840}, 'accuracy': 0.3530599599455614, 'macro avg': {'precision': 0.35728333278105046, 'recall': 0.3591106159821907, 'f1-score': 0.32868413190145596, 'support': 180754}, 'weighted avg': {'precision': 0.3575528542201573, 'recall': 0.3530599599455614, 'f1-score': 0.3254421937158819, 'support': 180754}}
[[22551  7109 30602]
 [20557  7783 34312]
 [17656  6701 33483]]
training model: results/ATVI/W4/deepOF_L2/h1000
Epoch 1/50
1972/1972 - 45s - loss: 3.2835 - accuracy1000: 0.3835 - val_loss: 3.3904 - val_accuracy1000: 0.3273 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 42s - loss: 3.2522 - accuracy1000: 0.3966 - val_loss: 3.3959 - val_accuracy1000: 0.3249 - 42s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.2456 - accuracy1000: 0.3975 - val_loss: 3.4007 - val_accuracy1000: 0.3247 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 42s - loss: 3.2418 - accuracy1000: 0.3979 - val_loss: 3.4143 - val_accuracy1000: 0.3238 - 42s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 42s - loss: 3.2394 - accuracy1000: 0.3988 - val_loss: 3.4098 - val_accuracy1000: 0.3249 - 42s/epoch - 21ms/step
Epoch 6/50
1972/1972 - 42s - loss: 3.2373 - accuracy1000: 0.4000 - val_loss: 3.4145 - val_accuracy1000: 0.3261 - 42s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 42s - loss: 3.2356 - accuracy1000: 0.4003 - val_loss: 3.4212 - val_accuracy1000: 0.3253 - 42s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 42s - loss: 3.2330 - accuracy1000: 0.4015 - val_loss: 3.4198 - val_accuracy1000: 0.3276 - 42s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 42s - loss: 3.2311 - accuracy1000: 0.4029 - val_loss: 3.4240 - val_accuracy1000: 0.3274 - 42s/epoch - 21ms/step
Epoch 10/50
1972/1972 - 44s - loss: 3.2288 - accuracy1000: 0.4043 - val_loss: 3.4226 - val_accuracy1000: 0.3283 - 44s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.2266 - accuracy1000: 0.4058 - val_loss: 3.4276 - val_accuracy1000: 0.3304 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepOF_L2/h1000
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1248473
{'0': {'precision': 0.3833480855437855, 'recall': 0.03448754174158746, 'f1-score': 0.06328198094376218, 'support': 389300}, '1': {'precision': 0.29322617406168583, 'recall': 0.8725077816101624, 'f1-score': 0.4389374048783664, 'support': 309062}, '2': {'precision': 0.39269062477584105, 'recall': 0.13835010955296828, 'f1-score': 0.20461251819722712, 'support': 395699}, 'accuracy': 0.30878534195076873, 'macro avg': {'precision': 0.35642162812710415, 'recall': 0.348448477634906, 'f1-score': 0.23561063467311857, 'support': 1094061}, 'weighted avg': {'precision': 0.36126848963926506, 'recall': 0.30878534195076873, 'f1-score': 0.22051742658411994, 'support': 1094061}}
[[ 13426 322374  53500]
 [  8238 269659  31165]
 [ 13359 327595  54745]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108919
{'0': {'precision': 0.3822680412371134, 'recall': 0.03436855049000828, 'f1-score': 0.06306694484760524, 'support': 161834}, '1': {'precision': 0.34815259903904777, 'recall': 0.9278017936641073, 'f1-score': 0.5063137173311141, 'support': 170489}, '2': {'precision': 0.3913579555007566, 'recall': 0.08107794303760725, 'f1-score': 0.13432720977204962, 'support': 172254}, 'accuracy': 0.35219203411966854, 'macro avg': {'precision': 0.3739261985923059, 'recall': 0.3477494290639076, 'f1-score': 0.2345692906502563, 'support': 504577}, 'weighted avg': {'precision': 0.373844087047096, 'recall': 0.35219203411966854, 'f1-score': 0.23716042248974148, 'support': 504577}}
[[  5562 143231  13041]
 [  3630 158180   8679]
 [  5358 152930  13966]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1241307
{'0': {'precision': 0.39858264700248996, 'recall': 0.03272372745427956, 'f1-score': 0.060481878687476384, 'support': 63593}, '1': {'precision': 0.3224528130396583, 'recall': 0.9325179175355284, 'f1-score': 0.47920324895768607, 'support': 57067}, '2': {'precision': 0.365974471327872, 'recall': 0.06393317136486172, 'f1-score': 0.10885086128739802, 'support': 60094}, 'accuracy': 0.3271794815052502, 'macro avg': {'precision': 0.3623366437900068, 'recall': 0.3430582721182232, 'f1-score': 0.21617866297752011, 'support': 180754}, 'weighted avg': {'precision': 0.36370620197915765, 'recall': 0.3271794815052502, 'f1-score': 0.20875996978128203, 'support': 180754}}
[[ 2081 57390  4122]
 [ 1317 53216  2534]
 [ 1823 54429  3842]]
training model: results/ATVI/W4/deepVOL_L2/h10
Epoch 1/50
1972/1972 - 47s - loss: 2.8331 - accuracy10: 0.5028 - val_loss: 2.8469 - val_accuracy10: 0.4851 - 47s/epoch - 24ms/step
Epoch 2/50
1972/1972 - 48s - loss: 2.6520 - accuracy10: 0.5527 - val_loss: 2.6987 - val_accuracy10: 0.5280 - 48s/epoch - 24ms/step
Epoch 3/50
1972/1972 - 47s - loss: 2.5748 - accuracy10: 0.5779 - val_loss: 2.6830 - val_accuracy10: 0.5872 - 47s/epoch - 24ms/step
Epoch 4/50
1972/1972 - 46s - loss: 2.5381 - accuracy10: 0.5899 - val_loss: 2.6746 - val_accuracy10: 0.5778 - 46s/epoch - 23ms/step
Epoch 5/50
1972/1972 - 44s - loss: 2.5190 - accuracy10: 0.5961 - val_loss: 2.6626 - val_accuracy10: 0.5793 - 44s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 46s - loss: 2.5031 - accuracy10: 0.6002 - val_loss: 2.6617 - val_accuracy10: 0.5914 - 46s/epoch - 23ms/step
Epoch 7/50
1972/1972 - 41s - loss: 2.4911 - accuracy10: 0.6033 - val_loss: 2.6392 - val_accuracy10: 0.6060 - 41s/epoch - 21ms/step
Epoch 8/50
1972/1972 - 47s - loss: 2.4804 - accuracy10: 0.6055 - val_loss: 2.6135 - val_accuracy10: 0.5961 - 47s/epoch - 24ms/step
Epoch 9/50
1972/1972 - 45s - loss: 2.4701 - accuracy10: 0.6080 - val_loss: 2.6094 - val_accuracy10: 0.5898 - 45s/epoch - 23ms/step
Epoch 10/50
1972/1972 - 47s - loss: 2.4620 - accuracy10: 0.6092 - val_loss: 2.6074 - val_accuracy10: 0.5906 - 47s/epoch - 24ms/step
Epoch 11/50
1972/1972 - 45s - loss: 2.4517 - accuracy10: 0.6118 - val_loss: 2.5990 - val_accuracy10: 0.5916 - 45s/epoch - 23ms/step
Epoch 12/50
1972/1972 - 47s - loss: 2.4452 - accuracy10: 0.6131 - val_loss: 2.5968 - val_accuracy10: 0.5960 - 47s/epoch - 24ms/step
Epoch 13/50
1972/1972 - 43s - loss: 2.4383 - accuracy10: 0.6138 - val_loss: 2.5893 - val_accuracy10: 0.5908 - 43s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 43s - loss: 2.4310 - accuracy10: 0.6147 - val_loss: 2.5967 - val_accuracy10: 0.5866 - 43s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 41s - loss: 2.4249 - accuracy10: 0.6160 - val_loss: 2.5939 - val_accuracy10: 0.5868 - 41s/epoch - 21ms/step
Epoch 16/50
1972/1972 - 43s - loss: 2.4181 - accuracy10: 0.6163 - val_loss: 2.5815 - val_accuracy10: 0.5893 - 43s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 41s - loss: 2.4118 - accuracy10: 0.6174 - val_loss: 2.5859 - val_accuracy10: 0.5986 - 41s/epoch - 21ms/step
Epoch 18/50
1972/1972 - 42s - loss: 2.4042 - accuracy10: 0.6176 - val_loss: 2.5743 - val_accuracy10: 0.5862 - 42s/epoch - 21ms/step
Epoch 19/50
1972/1972 - 42s - loss: 2.3998 - accuracy10: 0.6185 - val_loss: 2.5752 - val_accuracy10: 0.6004 - 42s/epoch - 21ms/step
Epoch 20/50
1972/1972 - 42s - loss: 2.3951 - accuracy10: 0.6198 - val_loss: 2.5691 - val_accuracy10: 0.5885 - 42s/epoch - 21ms/step
Epoch 21/50
1972/1972 - 42s - loss: 2.3887 - accuracy10: 0.6203 - val_loss: 2.5645 - val_accuracy10: 0.5873 - 42s/epoch - 21ms/step
Epoch 22/50
1972/1972 - 42s - loss: 2.3843 - accuracy10: 0.6200 - val_loss: 2.5624 - val_accuracy10: 0.5821 - 42s/epoch - 21ms/step
Epoch 23/50
1972/1972 - 45s - loss: 2.3808 - accuracy10: 0.6207 - val_loss: 2.5625 - val_accuracy10: 0.5886 - 45s/epoch - 23ms/step
Epoch 24/50
1972/1972 - 44s - loss: 2.3757 - accuracy10: 0.6213 - val_loss: 2.5698 - val_accuracy10: 0.5738 - 44s/epoch - 22ms/step
Epoch 25/50
1972/1972 - 41s - loss: 2.3713 - accuracy10: 0.6221 - val_loss: 2.5625 - val_accuracy10: 0.5873 - 41s/epoch - 21ms/step
Epoch 26/50
1972/1972 - 46s - loss: 2.3656 - accuracy10: 0.6219 - val_loss: 2.5606 - val_accuracy10: 0.5816 - 46s/epoch - 23ms/step
Epoch 27/50
1972/1972 - 44s - loss: 2.3629 - accuracy10: 0.6224 - val_loss: 2.5537 - val_accuracy10: 0.5836 - 44s/epoch - 22ms/step
Epoch 28/50
1972/1972 - 46s - loss: 2.3582 - accuracy10: 0.6228 - val_loss: 2.5599 - val_accuracy10: 0.5754 - 46s/epoch - 23ms/step
Epoch 29/50
1972/1972 - 43s - loss: 2.3547 - accuracy10: 0.6233 - val_loss: 2.5661 - val_accuracy10: 0.5721 - 43s/epoch - 22ms/step
Epoch 30/50
1972/1972 - 48s - loss: 2.3521 - accuracy10: 0.6235 - val_loss: 2.5717 - val_accuracy10: 0.5750 - 48s/epoch - 24ms/step
Epoch 31/50
1972/1972 - 45s - loss: 2.3486 - accuracy10: 0.6236 - val_loss: 2.5715 - val_accuracy10: 0.5764 - 45s/epoch - 23ms/step
Epoch 32/50
1972/1972 - 42s - loss: 2.3435 - accuracy10: 0.6248 - val_loss: 2.5690 - val_accuracy10: 0.5689 - 42s/epoch - 21ms/step
Epoch 33/50
1972/1972 - 42s - loss: 2.3421 - accuracy10: 0.6245 - val_loss: 2.5645 - val_accuracy10: 0.5711 - 42s/epoch - 21ms/step
Epoch 34/50
1972/1972 - 44s - loss: 2.3381 - accuracy10: 0.6241 - val_loss: 2.5797 - val_accuracy10: 0.5708 - 44s/epoch - 22ms/step
Epoch 35/50
1972/1972 - 45s - loss: 2.3358 - accuracy10: 0.6252 - val_loss: 2.5662 - val_accuracy10: 0.5853 - 45s/epoch - 23ms/step
Epoch 36/50
1972/1972 - 43s - loss: 2.3312 - accuracy10: 0.6256 - val_loss: 2.5673 - val_accuracy10: 0.5764 - 43s/epoch - 22ms/step
Epoch 37/50
1972/1972 - 42s - loss: 2.3272 - accuracy10: 0.6262 - val_loss: 2.5637 - val_accuracy10: 0.5825 - 42s/epoch - 21ms/step
testing model: results/ATVI/W4/deepVOL_L2/h10
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98010993
{'0': {'precision': 0.3887159513694161, 'recall': 0.6765840506965575, 'f1-score': 0.493755772904989, 'support': 230706}, '1': {'precision': 0.8101227928278064, 'recall': 0.48543069074796147, 'f1-score': 0.6070895133216179, 'support': 635514}, '2': {'precision': 0.4252509600485077, 'recall': 0.5817639184533345, 'f1-score': 0.49134460696731336, 'support': 227845}, 'accuracy': 0.5458012092517355, 'macro avg': {'precision': 0.5413632347485767, 'recall': 0.5812595532992845, 'f1-score': 0.5307299643979734, 'support': 1094065}, 'weighted avg': {'precision': 0.6411088772879632, 'recall': 0.5458012092517355, 'f1-score': 0.5590862666179437, 'support': 1094065}}
[[156092  32772  41842]
 [189707 308498 137309]
 [ 55759  39534 132552]]
Evaluating performance on  train set...
1972/1972 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86430234
{'0': {'precision': 0.39231759076916517, 'recall': 0.6354267422044125, 'f1-score': 0.485118877553263, 'support': 86844}, '1': {'precision': 0.86550822288222, 'recall': 0.5900966519381766, 'f1-score': 0.7017474499881394, 'support': 330878}, '2': {'precision': 0.40124773188945356, 'recall': 0.6390315227152363, 'f1-score': 0.4929636882796229, 'support': 86858}, 'accuracy': 0.606322089658726, 'macro avg': {'precision': 0.5530245151802796, 'recall': 0.6215183056192751, 'f1-score': 0.5599433386070084, 'support': 504580}, 'weighted avg': {'precision': 0.7041492610092249, 'recall': 0.606322089658726, 'f1-score': 0.6285233195846103, 'support': 504580}}
[[ 55183  15107  16554]
 [ 69356 195250  66272]
 [ 16120  15233  55505]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89340603
{'0': {'precision': 0.3867572657779091, 'recall': 0.6532967375709563, 'f1-score': 0.48587334725121784, 'support': 32062}, '1': {'precision': 0.8575888823935802, 'recall': 0.5498023917413376, 'f1-score': 0.6700402757017107, 'support': 117404}, '2': {'precision': 0.3891832917705736, 'recall': 0.6384556379442597, 'f1-score': 0.48358671443788126, 'support': 31288}, 'accuracy': 0.5835057592086482, 'macro avg': {'precision': 0.5445098133140209, 'recall': 0.613851589085518, 'f1-score': 0.5465001124636033, 'support': 180754}, 'weighted avg': {'precision': 0.692993479739452, 'recall': 0.5835057592086482, 'f1-score': 0.6050983154418967, 'support': 180754}}
[[20946  5343  5773]
 [27276 64549 25579]
 [ 5936  5376 19976]]
training model: results/ATVI/W4/deepVOL_L2/h20
Epoch 1/50
1972/1972 - 44s - loss: 2.9025 - accuracy20: 0.5084 - val_loss: 2.9693 - val_accuracy20: 0.4649 - 44s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 45s - loss: 2.7332 - accuracy20: 0.5567 - val_loss: 2.8891 - val_accuracy20: 0.5264 - 45s/epoch - 23ms/step
Epoch 3/50
1972/1972 - 43s - loss: 2.6738 - accuracy20: 0.5737 - val_loss: 2.8616 - val_accuracy20: 0.5307 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 42s - loss: 2.6441 - accuracy20: 0.5830 - val_loss: 2.8622 - val_accuracy20: 0.5268 - 42s/epoch - 21ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.6275 - accuracy20: 0.5874 - val_loss: 2.8811 - val_accuracy20: 0.5164 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 41s - loss: 2.6149 - accuracy20: 0.5904 - val_loss: 2.8526 - val_accuracy20: 0.5400 - 41s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 44s - loss: 2.6047 - accuracy20: 0.5937 - val_loss: 2.8169 - val_accuracy20: 0.5458 - 44s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 41s - loss: 2.5958 - accuracy20: 0.5954 - val_loss: 2.8215 - val_accuracy20: 0.5495 - 41s/epoch - 21ms/step
Epoch 9/50
1972/1972 - 45s - loss: 2.5868 - accuracy20: 0.5958 - val_loss: 2.7834 - val_accuracy20: 0.5567 - 45s/epoch - 23ms/step
Epoch 10/50
1972/1972 - 43s - loss: 2.5784 - accuracy20: 0.5971 - val_loss: 2.7731 - val_accuracy20: 0.5497 - 43s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 41s - loss: 2.5707 - accuracy20: 0.5981 - val_loss: 2.7548 - val_accuracy20: 0.5637 - 41s/epoch - 21ms/step
Epoch 12/50
1972/1972 - 42s - loss: 2.5640 - accuracy20: 0.5992 - val_loss: 2.7304 - val_accuracy20: 0.5714 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 42s - loss: 2.5589 - accuracy20: 0.6003 - val_loss: 2.7299 - val_accuracy20: 0.5642 - 42s/epoch - 21ms/step
Epoch 14/50
1972/1972 - 44s - loss: 2.5528 - accuracy20: 0.6012 - val_loss: 2.7346 - val_accuracy20: 0.5675 - 44s/epoch - 22ms/step
Epoch 15/50
1972/1972 - 44s - loss: 2.5480 - accuracy20: 0.6020 - val_loss: 2.7318 - val_accuracy20: 0.5744 - 44s/epoch - 22ms/step
Epoch 16/50
1972/1972 - 46s - loss: 2.5440 - accuracy20: 0.6028 - val_loss: 2.7216 - val_accuracy20: 0.5677 - 46s/epoch - 23ms/step
Epoch 17/50
1972/1972 - 45s - loss: 2.5379 - accuracy20: 0.6037 - val_loss: 2.7309 - val_accuracy20: 0.5801 - 45s/epoch - 23ms/step
Epoch 18/50
1972/1972 - 45s - loss: 2.5338 - accuracy20: 0.6044 - val_loss: 2.7193 - val_accuracy20: 0.5666 - 45s/epoch - 23ms/step
Epoch 19/50
1972/1972 - 45s - loss: 2.5306 - accuracy20: 0.6046 - val_loss: 2.7188 - val_accuracy20: 0.5601 - 45s/epoch - 23ms/step
Epoch 20/50
1972/1972 - 47s - loss: 2.5262 - accuracy20: 0.6058 - val_loss: 2.7137 - val_accuracy20: 0.5649 - 47s/epoch - 24ms/step
Epoch 21/50
1972/1972 - 46s - loss: 2.5208 - accuracy20: 0.6060 - val_loss: 2.7271 - val_accuracy20: 0.5561 - 46s/epoch - 23ms/step
Epoch 22/50
1972/1972 - 43s - loss: 2.5168 - accuracy20: 0.6069 - val_loss: 2.7130 - val_accuracy20: 0.5607 - 43s/epoch - 22ms/step
Epoch 23/50
1972/1972 - 45s - loss: 2.5126 - accuracy20: 0.6078 - val_loss: 2.7201 - val_accuracy20: 0.5517 - 45s/epoch - 23ms/step
Epoch 24/50
1972/1972 - 43s - loss: 2.5089 - accuracy20: 0.6080 - val_loss: 2.7141 - val_accuracy20: 0.5614 - 43s/epoch - 22ms/step
Epoch 25/50
1972/1972 - 45s - loss: 2.5065 - accuracy20: 0.6088 - val_loss: 2.7074 - val_accuracy20: 0.5608 - 45s/epoch - 23ms/step
Epoch 26/50
1972/1972 - 44s - loss: 2.5016 - accuracy20: 0.6094 - val_loss: 2.7086 - val_accuracy20: 0.5593 - 44s/epoch - 22ms/step
Epoch 27/50
1972/1972 - 42s - loss: 2.4963 - accuracy20: 0.6106 - val_loss: 2.7159 - val_accuracy20: 0.5618 - 42s/epoch - 21ms/step
Epoch 28/50
1972/1972 - 44s - loss: 2.4955 - accuracy20: 0.6103 - val_loss: 2.7085 - val_accuracy20: 0.5602 - 44s/epoch - 22ms/step
Epoch 29/50
1972/1972 - 41s - loss: 2.4918 - accuracy20: 0.6105 - val_loss: 2.7056 - val_accuracy20: 0.5610 - 41s/epoch - 21ms/step
Epoch 30/50
1972/1972 - 41s - loss: 2.4867 - accuracy20: 0.6114 - val_loss: 2.7111 - val_accuracy20: 0.5573 - 41s/epoch - 21ms/step
Epoch 31/50
1972/1972 - 43s - loss: 2.4851 - accuracy20: 0.6109 - val_loss: 2.7101 - val_accuracy20: 0.5628 - 43s/epoch - 22ms/step
Epoch 32/50
1972/1972 - 42s - loss: 2.4810 - accuracy20: 0.6120 - val_loss: 2.7041 - val_accuracy20: 0.5708 - 42s/epoch - 21ms/step
Epoch 33/50
1972/1972 - 43s - loss: 2.4786 - accuracy20: 0.6129 - val_loss: 2.7046 - val_accuracy20: 0.5699 - 43s/epoch - 22ms/step
Epoch 34/50
1972/1972 - 42s - loss: 2.4764 - accuracy20: 0.6128 - val_loss: 2.7082 - val_accuracy20: 0.5662 - 42s/epoch - 21ms/step
Epoch 35/50
1972/1972 - 46s - loss: 2.4726 - accuracy20: 0.6137 - val_loss: 2.7108 - val_accuracy20: 0.5635 - 46s/epoch - 23ms/step
Epoch 36/50
1972/1972 - 44s - loss: 2.4683 - accuracy20: 0.6139 - val_loss: 2.7108 - val_accuracy20: 0.5690 - 44s/epoch - 22ms/step
Epoch 37/50
1972/1972 - 42s - loss: 2.4653 - accuracy20: 0.6143 - val_loss: 2.7109 - val_accuracy20: 0.5624 - 42s/epoch - 21ms/step
Epoch 38/50
1972/1972 - 43s - loss: 2.4639 - accuracy20: 0.6145 - val_loss: 2.7065 - val_accuracy20: 0.5707 - 43s/epoch - 22ms/step
Epoch 39/50
1972/1972 - 47s - loss: 2.4607 - accuracy20: 0.6148 - val_loss: 2.7065 - val_accuracy20: 0.5703 - 47s/epoch - 24ms/step
Epoch 40/50
1972/1972 - 46s - loss: 2.4579 - accuracy20: 0.6155 - val_loss: 2.7080 - val_accuracy20: 0.5623 - 46s/epoch - 23ms/step
Epoch 41/50
1972/1972 - 44s - loss: 2.4540 - accuracy20: 0.6158 - val_loss: 2.7095 - val_accuracy20: 0.5585 - 44s/epoch - 22ms/step
Epoch 42/50
1972/1972 - 43s - loss: 2.4530 - accuracy20: 0.6152 - val_loss: 2.7068 - val_accuracy20: 0.5664 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepVOL_L2/h20
Evaluating performance on  test set...
4274/4274 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9781855
{'0': {'precision': 0.44890681242501, 'recall': 0.6330904817861339, 'f1-score': 0.525322256674272, 'support': 297850}, '1': {'precision': 0.6941219466589608, 'recall': 0.4864464020870933, 'f1-score': 0.5720179164901049, 'support': 503667}, '2': {'precision': 0.4779105082000405, 'recall': 0.5244472701915583, 'f1-score': 0.5000986011672423, 'support': 292548}, 'accuracy': 0.5365302792795675, 'macro avg': {'precision': 0.5403130890946705, 'recall': 0.5479947180215952, 'f1-score': 0.532479591443873, 'support': 1094065}, 'weighted avg': {'precision': 0.5695502332508339, 'recall': 0.5365302792795675, 'f1-score': 0.5400745181223492, 'support': 1094065}}
[[188566  55476  53808]
 [144859 245007 113801]
 [ 86631  52491 153426]]
Evaluating performance on  train set...
1972/1972 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8818598
{'0': {'precision': 0.45241351296459276, 'recall': 0.5916266057563766, 'f1-score': 0.5127386702370493, 'support': 112953}, '1': {'precision': 0.7794537472972847, 'recall': 0.5979399579231559, 'f1-score': 0.6767368532258458, 'support': 278538}, '2': {'precision': 0.4572055085337579, 'recall': 0.5789245638391002, 'f1-score': 0.5109155822619349, 'support': 113089}, 'accuracy': 0.5922648539379286, 'macro avg': {'precision': 0.5630242562652118, 'recall': 0.5894970425062108, 'f1-score': 0.56679703524161, 'support': 504580}, 'weighted avg': {'precision': 0.6340201061261937, 'recall': 0.5922648539379286, 'f1-score': 0.6028602658161758, 'support': 504580}}
[[ 66826  25262  20865]
 [ 55128 166549  56861]
 [ 25756  21863  65470]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90753126
{'0': {'precision': 0.4478876222073201, 'recall': 0.6026928830946784, 'f1-score': 0.5138848112414833, 'support': 42111}, '1': {'precision': 0.7643145876178994, 'recall': 0.5530888526239082, 'f1-score': 0.6417682926829268, 'support': 97431}, '2': {'precision': 0.443162943470877, 'recall': 0.5761914005629428, 'f1-score': 0.5009968880215202, 'support': 41212}, 'accuracy': 0.5699126990274074, 'macro avg': {'precision': 0.5517883844320322, 'recall': 0.5773243787605099, 'f1-score': 0.5522166639819767, 'support': 180754}, 'weighted avg': {'precision': 0.6173725697428206, 'recall': 0.5699126990274074, 'f1-score': 0.5798788052254624, 'support': 180754}}
[[25380  8912  7819]
 [21525 53888 22018]
 [ 9761  7705 23746]]
training model: results/ATVI/W4/deepVOL_L2/h30
Epoch 1/50
1972/1972 - 45s - loss: 2.9611 - accuracy30: 0.5032 - val_loss: 3.0710 - val_accuracy30: 0.4381 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 46s - loss: 2.8225 - accuracy30: 0.5399 - val_loss: 2.9288 - val_accuracy30: 0.5198 - 46s/epoch - 23ms/step
Epoch 3/50
1972/1972 - 42s - loss: 2.7699 - accuracy30: 0.5562 - val_loss: 2.8932 - val_accuracy30: 0.5323 - 42s/epoch - 21ms/step
Epoch 4/50
1972/1972 - 43s - loss: 2.7415 - accuracy30: 0.5654 - val_loss: 2.8893 - val_accuracy30: 0.5493 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 2.7234 - accuracy30: 0.5693 - val_loss: 2.8828 - val_accuracy30: 0.5453 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 43s - loss: 2.7115 - accuracy30: 0.5722 - val_loss: 2.8674 - val_accuracy30: 0.5564 - 43s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 46s - loss: 2.7009 - accuracy30: 0.5748 - val_loss: 2.8674 - val_accuracy30: 0.5562 - 46s/epoch - 23ms/step
Epoch 8/50
1972/1972 - 42s - loss: 2.6909 - accuracy30: 0.5772 - val_loss: 2.8522 - val_accuracy30: 0.5496 - 42s/epoch - 21ms/step
Epoch 9/50
1972/1972 - 42s - loss: 2.6834 - accuracy30: 0.5785 - val_loss: 2.8628 - val_accuracy30: 0.5450 - 42s/epoch - 21ms/step
Epoch 10/50
1972/1972 - 45s - loss: 2.6781 - accuracy30: 0.5788 - val_loss: 2.8378 - val_accuracy30: 0.5498 - 45s/epoch - 23ms/step
Epoch 11/50
1972/1972 - 47s - loss: 2.6708 - accuracy30: 0.5800 - val_loss: 2.8547 - val_accuracy30: 0.5458 - 47s/epoch - 24ms/step
Epoch 12/50
1972/1972 - 42s - loss: 2.6655 - accuracy30: 0.5807 - val_loss: 2.8268 - val_accuracy30: 0.5472 - 42s/epoch - 21ms/step
Epoch 13/50
1972/1972 - 45s - loss: 2.6595 - accuracy30: 0.5816 - val_loss: 2.8254 - val_accuracy30: 0.5470 - 45s/epoch - 23ms/step
Epoch 14/50
1972/1972 - 41s - loss: 2.6542 - accuracy30: 0.5831 - val_loss: 2.8215 - val_accuracy30: 0.5419 - 41s/epoch - 21ms/step
Epoch 15/50
1972/1972 - 42s - loss: 2.6515 - accuracy30: 0.5826 - val_loss: 2.8181 - val_accuracy30: 0.5473 - 42s/epoch - 21ms/step
Epoch 16/50
1972/1972 - 42s - loss: 2.6466 - accuracy30: 0.5840 - val_loss: 2.8251 - val_accuracy30: 0.5535 - 42s/epoch - 22ms/step
Epoch 17/50
1972/1972 - 43s - loss: 2.6420 - accuracy30: 0.5847 - val_loss: 2.8116 - val_accuracy30: 0.5522 - 43s/epoch - 22ms/step
Epoch 18/50
1972/1972 - 43s - loss: 2.6379 - accuracy30: 0.5850 - val_loss: 2.8133 - val_accuracy30: 0.5464 - 43s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 40s - loss: 2.6339 - accuracy30: 0.5859 - val_loss: 2.8146 - val_accuracy30: 0.5505 - 40s/epoch - 21ms/step
Epoch 20/50
1972/1972 - 41s - loss: 2.6312 - accuracy30: 0.5862 - val_loss: 2.8171 - val_accuracy30: 0.5421 - 41s/epoch - 21ms/step
Epoch 21/50
1972/1972 - 42s - loss: 2.6282 - accuracy30: 0.5870 - val_loss: 2.8044 - val_accuracy30: 0.5461 - 42s/epoch - 21ms/step
Epoch 22/50
1972/1972 - 42s - loss: 2.6238 - accuracy30: 0.5878 - val_loss: 2.8126 - val_accuracy30: 0.5422 - 42s/epoch - 21ms/step
Epoch 23/50
1972/1972 - 43s - loss: 2.6200 - accuracy30: 0.5888 - val_loss: 2.8091 - val_accuracy30: 0.5470 - 43s/epoch - 22ms/step
Epoch 24/50
1972/1972 - 44s - loss: 2.6178 - accuracy30: 0.5893 - val_loss: 2.8150 - val_accuracy30: 0.5403 - 44s/epoch - 22ms/step
Epoch 25/50
1972/1972 - 42s - loss: 2.6155 - accuracy30: 0.5895 - val_loss: 2.8043 - val_accuracy30: 0.5453 - 42s/epoch - 21ms/step
Epoch 26/50
1972/1972 - 43s - loss: 2.6121 - accuracy30: 0.5898 - val_loss: 2.8100 - val_accuracy30: 0.5455 - 43s/epoch - 22ms/step
Epoch 27/50
1972/1972 - 41s - loss: 2.6097 - accuracy30: 0.5900 - val_loss: 2.8049 - val_accuracy30: 0.5459 - 41s/epoch - 21ms/step
Epoch 28/50
1972/1972 - 42s - loss: 2.6074 - accuracy30: 0.5909 - val_loss: 2.8129 - val_accuracy30: 0.5372 - 42s/epoch - 21ms/step
Epoch 29/50
1972/1972 - 46s - loss: 2.6035 - accuracy30: 0.5907 - val_loss: 2.8077 - val_accuracy30: 0.5384 - 46s/epoch - 23ms/step
Epoch 30/50
1972/1972 - 43s - loss: 2.6013 - accuracy30: 0.5915 - val_loss: 2.8064 - val_accuracy30: 0.5405 - 43s/epoch - 22ms/step
Epoch 31/50
1972/1972 - 42s - loss: 2.5983 - accuracy30: 0.5918 - val_loss: 2.8112 - val_accuracy30: 0.5385 - 42s/epoch - 21ms/step
Epoch 32/50
1972/1972 - 43s - loss: 2.5965 - accuracy30: 0.5929 - val_loss: 2.8097 - val_accuracy30: 0.5383 - 43s/epoch - 22ms/step
Epoch 33/50
1972/1972 - 43s - loss: 2.5945 - accuracy30: 0.5928 - val_loss: 2.8179 - val_accuracy30: 0.5389 - 43s/epoch - 22ms/step
Epoch 34/50
1972/1972 - 42s - loss: 2.5905 - accuracy30: 0.5928 - val_loss: 2.8126 - val_accuracy30: 0.5392 - 42s/epoch - 21ms/step
Epoch 35/50
1972/1972 - 46s - loss: 2.5889 - accuracy30: 0.5937 - val_loss: 2.8131 - val_accuracy30: 0.5408 - 46s/epoch - 23ms/step
testing model: results/ATVI/W4/deepVOL_L2/h30
Evaluating performance on  test set...
4274/4274 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9889377
{'0': {'precision': 0.48387048808594474, 'recall': 0.5729793022088795, 'f1-score': 0.5246682682230785, 'support': 340761}, '1': {'precision': 0.6074621505660877, 'recall': 0.4600431810862071, 'f1-score': 0.5235736288142796, 'support': 419165}, '2': {'precision': 0.4877649366939331, 'recall': 0.5446505795492295, 'f1-score': 0.5146405711158902, 'support': 334139}, 'accuracy': 0.5210586208314862, 'macro avg': {'precision': 0.5263658584486551, 'recall': 0.5258910209481052, 'f1-score': 0.5209608227177495, 'support': 1094065}, 'weighted avg': {'precision': 0.5324111016389912, 'recall': 0.5210586208314862, 'f1-score': 0.5211863186026373, 'support': 1094065}}
[[195249  60152  85360]
 [120572 192834 105759]
 [ 87694  64456 181989]]
Evaluating performance on  train set...
1972/1972 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9119828
{'0': {'precision': 0.47754954802020116, 'recall': 0.5167267467223842, 'f1-score': 0.49636630311317936, 'support': 130659}, '1': {'precision': 0.7052464651737741, 'recall': 0.58928027653183, 'f1-score': 0.642069134042205, 'support': 243010}, '2': {'precision': 0.47625678266136334, 'recall': 0.5826324754986212, 'f1-score': 0.5241013942046713, 'support': 130911}, 'accuracy': 0.568768084347378, 'macro avg': {'precision': 0.5530175986184461, 'recall': 0.5628798329176118, 'f1-score': 0.5541789437866852, 'support': 504580}, 'weighted avg': {'precision': 0.5868749089770345, 'recall': 0.568768084347378, 'f1-score': 0.5737337640786176, 'support': 504580}}
[[ 67515  30412  32732]
 [ 48663 143201  51146]
 [ 25200  29438  76273]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93676084
{'0': {'precision': 0.4685106909785473, 'recall': 0.5414171554701711, 'f1-score': 0.5023323725728155, 'support': 48929}, '1': {'precision': 0.6781404278661547, 'recall': 0.5310478963320049, 'f1-score': 0.5956475768566726, 'support': 83806}, '2': {'precision': 0.4688561528088353, 'recall': 0.5720027489118891, 'f1-score': 0.5153186619388004, 'support': 48019}, 'accuracy': 0.5447348329774169, 'macro avg': {'precision': 0.5385024238845124, 'recall': 0.5481559335713551, 'f1-score': 0.5377662037894294, 'support': 180754}, 'weighted avg': {'precision': 0.5657966069816865, 'recall': 0.5447348329774169, 'f1-score': 0.549047591263844, 'support': 180754}}
[[26491 10418 12020]
 [20205 44505 19096]
 [ 9847 10705 27467]]
training model: results/ATVI/W4/deepVOL_L2/h50
Epoch 1/50
1972/1972 - 44s - loss: 3.0498 - accuracy50: 0.4791 - val_loss: 3.0806 - val_accuracy50: 0.4773 - 44s/epoch - 22ms/step
Epoch 2/50
1972/1972 - 45s - loss: 2.9198 - accuracy50: 0.5161 - val_loss: 3.0067 - val_accuracy50: 0.4905 - 45s/epoch - 23ms/step
Epoch 3/50
1972/1972 - 41s - loss: 2.8818 - accuracy50: 0.5255 - val_loss: 3.0160 - val_accuracy50: 0.4955 - 41s/epoch - 21ms/step
Epoch 4/50
1972/1972 - 41s - loss: 2.8651 - accuracy50: 0.5298 - val_loss: 3.0074 - val_accuracy50: 0.4933 - 41s/epoch - 21ms/step
Epoch 5/50
1972/1972 - 45s - loss: 2.8509 - accuracy50: 0.5330 - val_loss: 2.9835 - val_accuracy50: 0.5044 - 45s/epoch - 23ms/step
Epoch 6/50
1972/1972 - 42s - loss: 2.8411 - accuracy50: 0.5355 - val_loss: 2.9767 - val_accuracy50: 0.5016 - 42s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 42s - loss: 2.8326 - accuracy50: 0.5378 - val_loss: 2.9673 - val_accuracy50: 0.5043 - 42s/epoch - 21ms/step
Epoch 8/50
1972/1972 - 46s - loss: 2.8257 - accuracy50: 0.5393 - val_loss: 2.9658 - val_accuracy50: 0.5051 - 46s/epoch - 23ms/step
Epoch 9/50
1972/1972 - 43s - loss: 2.8199 - accuracy50: 0.5413 - val_loss: 2.9600 - val_accuracy50: 0.5066 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 43s - loss: 2.8160 - accuracy50: 0.5422 - val_loss: 2.9638 - val_accuracy50: 0.5072 - 43s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 45s - loss: 2.8122 - accuracy50: 0.5431 - val_loss: 2.9630 - val_accuracy50: 0.5075 - 45s/epoch - 23ms/step
Epoch 12/50
1972/1972 - 43s - loss: 2.8076 - accuracy50: 0.5441 - val_loss: 2.9572 - val_accuracy50: 0.5073 - 43s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 44s - loss: 2.8047 - accuracy50: 0.5450 - val_loss: 2.9596 - val_accuracy50: 0.5076 - 44s/epoch - 22ms/step
Epoch 14/50
1972/1972 - 42s - loss: 2.8014 - accuracy50: 0.5453 - val_loss: 2.9575 - val_accuracy50: 0.5066 - 42s/epoch - 21ms/step
Epoch 15/50
1972/1972 - 42s - loss: 2.7989 - accuracy50: 0.5460 - val_loss: 2.9558 - val_accuracy50: 0.5072 - 42s/epoch - 21ms/step
Epoch 16/50
1972/1972 - 45s - loss: 2.7950 - accuracy50: 0.5477 - val_loss: 2.9586 - val_accuracy50: 0.5083 - 45s/epoch - 23ms/step
Epoch 17/50
1972/1972 - 42s - loss: 2.7929 - accuracy50: 0.5476 - val_loss: 2.9547 - val_accuracy50: 0.5089 - 42s/epoch - 21ms/step
Epoch 18/50
1972/1972 - 44s - loss: 2.7884 - accuracy50: 0.5488 - val_loss: 2.9531 - val_accuracy50: 0.5067 - 44s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 41s - loss: 2.7868 - accuracy50: 0.5498 - val_loss: 2.9575 - val_accuracy50: 0.5068 - 41s/epoch - 21ms/step
Epoch 20/50
1972/1972 - 47s - loss: 2.7826 - accuracy50: 0.5504 - val_loss: 2.9496 - val_accuracy50: 0.5068 - 47s/epoch - 24ms/step
Epoch 21/50
1972/1972 - 43s - loss: 2.7809 - accuracy50: 0.5507 - val_loss: 2.9490 - val_accuracy50: 0.5080 - 43s/epoch - 22ms/step
Epoch 22/50
1972/1972 - 41s - loss: 2.7782 - accuracy50: 0.5509 - val_loss: 2.9516 - val_accuracy50: 0.5052 - 41s/epoch - 21ms/step
Epoch 23/50
1972/1972 - 42s - loss: 2.7765 - accuracy50: 0.5510 - val_loss: 2.9560 - val_accuracy50: 0.5077 - 42s/epoch - 22ms/step
Epoch 24/50
1972/1972 - 45s - loss: 2.7739 - accuracy50: 0.5517 - val_loss: 2.9577 - val_accuracy50: 0.5057 - 45s/epoch - 23ms/step
Epoch 25/50
1972/1972 - 42s - loss: 2.7723 - accuracy50: 0.5521 - val_loss: 2.9561 - val_accuracy50: 0.5061 - 42s/epoch - 21ms/step
Epoch 26/50
1972/1972 - 42s - loss: 2.7696 - accuracy50: 0.5528 - val_loss: 2.9556 - val_accuracy50: 0.5036 - 42s/epoch - 21ms/step
Epoch 27/50
1972/1972 - 45s - loss: 2.7666 - accuracy50: 0.5533 - val_loss: 2.9661 - val_accuracy50: 0.5036 - 45s/epoch - 23ms/step
Epoch 28/50
1972/1972 - 46s - loss: 2.7649 - accuracy50: 0.5539 - val_loss: 2.9685 - val_accuracy50: 0.5024 - 46s/epoch - 23ms/step
Epoch 29/50
1972/1972 - 43s - loss: 2.7626 - accuracy50: 0.5545 - val_loss: 2.9681 - val_accuracy50: 0.5030 - 43s/epoch - 22ms/step
Epoch 30/50
1972/1972 - 45s - loss: 2.7604 - accuracy50: 0.5547 - val_loss: 2.9756 - val_accuracy50: 0.5006 - 45s/epoch - 23ms/step
Epoch 31/50
1972/1972 - 42s - loss: 2.7587 - accuracy50: 0.5550 - val_loss: 2.9676 - val_accuracy50: 0.5047 - 42s/epoch - 21ms/step
testing model: results/ATVI/W4/deepVOL_L2/h50
Evaluating performance on  test set...
4274/4274 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0029683
{'0': {'precision': 0.49407904677617803, 'recall': 0.5805610510830417, 'f1-score': 0.5338402155026647, 'support': 394260}, '1': {'precision': 0.46015505315444966, 'recall': 0.4749587917353471, 'f1-score': 0.4674397438376255, 'support': 313044}, '2': {'precision': 0.5261830473218929, 'recall': 0.4185944291177239, 'f1-score': 0.4662627926634516, 'support': 386761}, 'accuracy': 0.4930886190491424, 'macro avg': {'precision': 0.49347238241750685, 'recall': 0.4913714239787042, 'f1-score': 0.48918091733458063, 'support': 1094065}, 'weighted avg': {'precision': 0.49572142880625936, 'recall': 0.4930886190491424, 'f1-score': 0.4909519219491488, 'support': 1094065}}
[[228892  82115  83253]
 [101830 148683  62531]
 [132548  92317 161896]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95975524
{'0': {'precision': 0.4864347858075671, 'recall': 0.5134480973336785, 'f1-score': 0.49957653933461577, 'support': 154520}, '1': {'precision': 0.5740337575230405, 'recall': 0.586996200455534, 'f1-score': 0.580442618700208, 'support': 194497}, '2': {'precision': 0.510463566870047, 'recall': 0.4678940364996818, 'f1-score': 0.4882526756396884, 'support': 155563}, 'accuracy': 0.5277537754171786, 'macro avg': {'precision': 0.5236440367335515, 'recall': 0.5227794447629647, 'f1-score': 0.5227572778915041, 'support': 504580}, 'weighted avg': {'precision': 0.5276090821930105, 'recall': 0.5277537754171786, 'f1-score': 0.5272562643145904, 'support': 504580}}
[[ 79338  41440  33742]
 [ 44267 114169  36061]
 [ 39496  43280  72787]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.981754
{'0': {'precision': 0.48213648008694976, 'recall': 0.5348721040392731, 'f1-score': 0.5071370243344766, 'support': 58055}, '1': {'precision': 0.5385701868752716, 'recall': 0.5274285974859019, 'f1-score': 0.5329411674358955, 'support': 65789}, '2': {'precision': 0.50130005200208, 'recall': 0.4573537163943068, 'f1-score': 0.47831959643851474, 'support': 56910}, 'accuracy': 0.5077563981986567, 'macro avg': {'precision': 0.5073355729881005, 'recall': 0.5065514726398272, 'f1-score': 0.5061325960696289, 'support': 180754}, 'weighted avg': {'precision': 0.5087102544631017, 'recall': 0.5077563981986567, 'f1-score': 0.5074558496381493, 'support': 180754}}
[[31052 14359 12644]
 [17841 34699 13249]
 [15512 15370 26028]]
training model: results/ATVI/W4/deepVOL_L2/h100
Epoch 1/50
1972/1972 - 48s - loss: 3.1997 - accuracy100: 0.4224 - val_loss: 3.2092 - val_accuracy100: 0.4180 - 48s/epoch - 25ms/step
Epoch 2/50
1972/1972 - 43s - loss: 3.1238 - accuracy100: 0.4513 - val_loss: 3.1796 - val_accuracy100: 0.4235 - 43s/epoch - 22ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.0966 - accuracy100: 0.4593 - val_loss: 3.1797 - val_accuracy100: 0.4238 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 41s - loss: 3.0829 - accuracy100: 0.4634 - val_loss: 3.1802 - val_accuracy100: 0.4238 - 41s/epoch - 21ms/step
Epoch 5/50
1972/1972 - 42s - loss: 3.0733 - accuracy100: 0.4667 - val_loss: 3.1588 - val_accuracy100: 0.4341 - 42s/epoch - 21ms/step
Epoch 6/50
1972/1972 - 41s - loss: 3.0669 - accuracy100: 0.4687 - val_loss: 3.1600 - val_accuracy100: 0.4344 - 41s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 45s - loss: 3.0625 - accuracy100: 0.4703 - val_loss: 3.1534 - val_accuracy100: 0.4374 - 45s/epoch - 23ms/step
Epoch 8/50
1972/1972 - 44s - loss: 3.0578 - accuracy100: 0.4720 - val_loss: 3.1537 - val_accuracy100: 0.4329 - 44s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 48s - loss: 3.0540 - accuracy100: 0.4730 - val_loss: 3.1602 - val_accuracy100: 0.4318 - 48s/epoch - 24ms/step
Epoch 10/50
1972/1972 - 42s - loss: 3.0506 - accuracy100: 0.4742 - val_loss: 3.1548 - val_accuracy100: 0.4350 - 42s/epoch - 21ms/step
Epoch 11/50
1972/1972 - 44s - loss: 3.0476 - accuracy100: 0.4755 - val_loss: 3.1504 - val_accuracy100: 0.4390 - 44s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 46s - loss: 3.0439 - accuracy100: 0.4759 - val_loss: 3.1522 - val_accuracy100: 0.4394 - 46s/epoch - 23ms/step
Epoch 13/50
1972/1972 - 46s - loss: 3.0416 - accuracy100: 0.4769 - val_loss: 3.1555 - val_accuracy100: 0.4377 - 46s/epoch - 23ms/step
Epoch 14/50
1972/1972 - 41s - loss: 3.0389 - accuracy100: 0.4779 - val_loss: 3.1472 - val_accuracy100: 0.4409 - 41s/epoch - 21ms/step
Epoch 15/50
1972/1972 - 40s - loss: 3.0360 - accuracy100: 0.4796 - val_loss: 3.1532 - val_accuracy100: 0.4375 - 40s/epoch - 20ms/step
Epoch 16/50
1972/1972 - 46s - loss: 3.0342 - accuracy100: 0.4801 - val_loss: 3.1547 - val_accuracy100: 0.4407 - 46s/epoch - 23ms/step
Epoch 17/50
1972/1972 - 40s - loss: 3.0309 - accuracy100: 0.4810 - val_loss: 3.1534 - val_accuracy100: 0.4396 - 40s/epoch - 20ms/step
Epoch 18/50
1972/1972 - 44s - loss: 3.0294 - accuracy100: 0.4814 - val_loss: 3.1534 - val_accuracy100: 0.4411 - 44s/epoch - 22ms/step
Epoch 19/50
1972/1972 - 46s - loss: 3.0277 - accuracy100: 0.4822 - val_loss: 3.1595 - val_accuracy100: 0.4401 - 46s/epoch - 23ms/step
Epoch 20/50
1972/1972 - 41s - loss: 3.0253 - accuracy100: 0.4827 - val_loss: 3.1451 - val_accuracy100: 0.4429 - 41s/epoch - 21ms/step
Epoch 21/50
1972/1972 - 41s - loss: 3.0232 - accuracy100: 0.4831 - val_loss: 3.1530 - val_accuracy100: 0.4413 - 41s/epoch - 21ms/step
Epoch 22/50
1972/1972 - 45s - loss: 3.0212 - accuracy100: 0.4840 - val_loss: 3.1619 - val_accuracy100: 0.4417 - 45s/epoch - 23ms/step
Epoch 23/50
1972/1972 - 42s - loss: 3.0192 - accuracy100: 0.4852 - val_loss: 3.1661 - val_accuracy100: 0.4413 - 42s/epoch - 21ms/step
Epoch 24/50
1972/1972 - 42s - loss: 3.0168 - accuracy100: 0.4856 - val_loss: 3.1746 - val_accuracy100: 0.4402 - 42s/epoch - 21ms/step
Epoch 25/50
1972/1972 - 42s - loss: 3.0140 - accuracy100: 0.4866 - val_loss: 3.1809 - val_accuracy100: 0.4406 - 42s/epoch - 21ms/step
Epoch 26/50
1972/1972 - 42s - loss: 3.0127 - accuracy100: 0.4870 - val_loss: 3.1811 - val_accuracy100: 0.4404 - 42s/epoch - 21ms/step
Epoch 27/50
1972/1972 - 43s - loss: 3.0103 - accuracy100: 0.4878 - val_loss: 3.1886 - val_accuracy100: 0.4388 - 43s/epoch - 22ms/step
Epoch 28/50
1972/1972 - 42s - loss: 3.0079 - accuracy100: 0.4886 - val_loss: 3.1993 - val_accuracy100: 0.4362 - 42s/epoch - 21ms/step
Epoch 29/50
1972/1972 - 43s - loss: 3.0047 - accuracy100: 0.4897 - val_loss: 3.1997 - val_accuracy100: 0.4362 - 43s/epoch - 22ms/step
Epoch 30/50
1972/1972 - 42s - loss: 3.0025 - accuracy100: 0.4898 - val_loss: 3.2096 - val_accuracy100: 0.4363 - 42s/epoch - 21ms/step
testing model: results/ATVI/W4/deepVOL_L2/h100
Evaluating performance on  test set...
4274/4274 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0637999
{'0': {'precision': 0.4448105698505665, 'recall': 0.5555089488928987, 'f1-score': 0.49403465089739595, 'support': 402899}, '1': {'precision': 0.35403457467456845, 'recall': 0.3814692432100831, 'f1-score': 0.3672402453592472, 'support': 286896}, '2': {'precision': 0.4784469602867587, 'recall': 0.33347020555569296, 'f1-score': 0.39301498454900585, 'support': 404270}, 'accuracy': 0.42782467220868964, 'macro avg': {'precision': 0.4257640349372979, 'recall': 0.4234827992195583, 'f1-score': 0.4180966269352164, 'support': 1094065}, 'weighted avg': {'precision': 0.4334354812128953, 'recall': 0.42782467220868964, 'f1-score': 0.42345746555106245, 'support': 1094065}}
[[223814  95884  83201]
 [113697 109442  63757]
 [165656 103802 134812]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0319321
{'0': {'precision': 0.4507989011605091, 'recall': 0.4821695199832099, 'f1-score': 0.46595679951323393, 'support': 166765}, '1': {'precision': 0.4517466752156198, 'recall': 0.5242358419239862, 'f1-score': 0.4852992639911124, 'support': 166654}, '2': {'precision': 0.4811315072206243, 'recall': 0.37333855259083554, 'f1-score': 0.4204358911094663, 'support': 171161}, 'accuracy': 0.4591462206191288, 'macro avg': {'precision': 0.46122569453225104, 'recall': 0.4599146381660106, 'f1-score': 0.45723065153793757, 'support': 504580}, 'weighted avg': {'precision': 0.46140120312102245, 'recall': 0.4591462206191288, 'f1-score': 0.45690391369096406, 'support': 504580}}
[[80409 51042 35314]
 [45689 87366 33599]
 [52272 54988 63901]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0480756
{'0': {'precision': 0.45425615324303964, 'recall': 0.47574425606594856, 'f1-score': 0.46475195822454307, 'support': 62109}, '1': {'precision': 0.41542697210306956, 'recall': 0.48001616985376827, 'f1-score': 0.44539212968248015, 'support': 56896}, '2': {'precision': 0.46434504152907036, 'recall': 0.3757307810652804, 'f1-score': 0.41536423366811676, 'support': 61749}, 'accuracy': 0.4429224249532514, 'macro avg': {'precision': 0.4446760556250599, 'recall': 0.4438304023283324, 'f1-score': 0.44183610719171335, 'support': 180754}, 'weighted avg': {'precision': 0.44548043415872823, 'recall': 0.4429224249532514, 'f1-score': 0.4417862733248231, 'support': 180754}}
[[29548 18521 14040]
 [16861 27311 12724]
 [18638 19910 23201]]
training model: results/ATVI/W4/deepVOL_L2/h200
Epoch 1/50
1972/1972 - 45s - loss: 3.2773 - accuracy200: 0.3785 - val_loss: 3.2831 - val_accuracy200: 0.3640 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 47s - loss: 3.2463 - accuracy200: 0.3958 - val_loss: 3.2824 - val_accuracy200: 0.3674 - 47s/epoch - 24ms/step
Epoch 3/50
1972/1972 - 45s - loss: 3.2344 - accuracy200: 0.4038 - val_loss: 3.3158 - val_accuracy200: 0.3663 - 45s/epoch - 23ms/step
Epoch 4/50
1972/1972 - 43s - loss: 3.2233 - accuracy200: 0.4084 - val_loss: 3.3013 - val_accuracy200: 0.3764 - 43s/epoch - 22ms/step
Epoch 5/50
1972/1972 - 43s - loss: 3.2147 - accuracy200: 0.4125 - val_loss: 3.3121 - val_accuracy200: 0.3762 - 43s/epoch - 22ms/step
Epoch 6/50
1972/1972 - 42s - loss: 3.2072 - accuracy200: 0.4159 - val_loss: 3.3430 - val_accuracy200: 0.3759 - 42s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 44s - loss: 3.2034 - accuracy200: 0.4171 - val_loss: 3.3177 - val_accuracy200: 0.3806 - 44s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 41s - loss: 3.1985 - accuracy200: 0.4195 - val_loss: 3.3027 - val_accuracy200: 0.3852 - 41s/epoch - 21ms/step
Epoch 9/50
1972/1972 - 41s - loss: 3.1961 - accuracy200: 0.4208 - val_loss: 3.3200 - val_accuracy200: 0.3789 - 41s/epoch - 21ms/step
Epoch 10/50
1972/1972 - 46s - loss: 3.1918 - accuracy200: 0.4226 - val_loss: 3.3293 - val_accuracy200: 0.3843 - 46s/epoch - 23ms/step
Epoch 11/50
1972/1972 - 43s - loss: 3.1880 - accuracy200: 0.4244 - val_loss: 3.3306 - val_accuracy200: 0.3780 - 43s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 43s - loss: 3.1853 - accuracy200: 0.4259 - val_loss: 3.3333 - val_accuracy200: 0.3792 - 43s/epoch - 22ms/step
testing model: results/ATVI/W4/deepVOL_L2/h200
Evaluating performance on  test set...
4274/4274 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009862
{'0': {'precision': 0.39928427082406986, 'recall': 0.3400983672499223, 'f1-score': 0.36732247035060206, 'support': 382851}, '1': {'precision': 0.3048328753267125, 'recall': 0.48111251422602624, 'f1-score': 0.37320382056224866, 'support': 320715}, '2': {'precision': 0.4089462727047004, 'recall': 0.2741517904015119, 'f1-score': 0.3282496581243753, 'support': 390499}, 'accuracy': 0.3578973826966405, 'macro avg': {'precision': 0.3710211396184942, 'recall': 0.36512089062582015, 'f1-score': 0.35625864967907533, 'support': 1094065}, 'weighted avg': {'precision': 0.3750453295961258, 'recall': 0.3578973826966405, 'f1-score': 0.35510047543402845, 'support': 1094065}}
[[130207 174563  78081]
 [ 89767 154300  76648]
 [106127 177316 107056]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901138
{'0': {'precision': 0.3956700515686408, 'recall': 0.3152569370282549, 'f1-score': 0.3509157213950396, 'support': 165741}, '1': {'precision': 0.3401384930934965, 'recall': 0.44907288140670404, 'f1-score': 0.38708761202932196, 'support': 166915}, '2': {'precision': 0.402547469290376, 'recall': 0.3562504362392685, 'f1-score': 0.377986577181208, 'support': 171924}, 'accuracy': 0.37349082405168654, 'macro avg': {'precision': 0.3794520046508378, 'recall': 0.3735267515580758, 'f1-score': 0.3719966368685232, 'support': 504580}, 'weighted avg': {'precision': 0.37964354057239225, 'recall': 0.37349082405168654, 'f1-score': 0.37210514811707074, 'support': 504580}}
[[52251 72933 40557]
 [41612 74957 50346]
 [38194 72482 61248]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094223
{'0': {'precision': 0.40049245504653475, 'recall': 0.293886549746378, 'f1-score': 0.3390060615331663, 'support': 60326}, '1': {'precision': 0.34071507057729694, 'recall': 0.46663579685458667, 'f1-score': 0.39385564535265133, 'support': 60469}, '2': {'precision': 0.3830703012912482, 'recall': 0.34288430427458766, 'f1-score': 0.3618650332664484, 'support': 59959}, 'accuracy': 0.3679310001438419, 'macro avg': {'precision': 0.37475927563836, 'recall': 0.3678022169585175, 'f1-score': 0.36490891338408865, 'support': 180754}, 'weighted avg': {'precision': 0.37471546765768815, 'recall': 0.3679310001438419, 'f1-score': 0.36493799427123186, 'support': 180754}}
[[17729 27481 15116]
 [14258 28217 17994]
 [12281 27119 20559]]
training model: results/ATVI/W4/deepVOL_L2/h300
Epoch 1/50
1972/1972 - 47s - loss: 3.2839 - accuracy300: 0.3696 - val_loss: 3.3003 - val_accuracy300: 0.3386 - 47s/epoch - 24ms/step
Epoch 2/50
1972/1972 - 42s - loss: 3.2571 - accuracy300: 0.3867 - val_loss: 3.3127 - val_accuracy300: 0.3418 - 42s/epoch - 21ms/step
Epoch 3/50
1972/1972 - 43s - loss: 3.2517 - accuracy300: 0.3915 - val_loss: 3.3154 - val_accuracy300: 0.3434 - 43s/epoch - 22ms/step
Epoch 4/50
1972/1972 - 46s - loss: 3.2462 - accuracy300: 0.3947 - val_loss: 3.3328 - val_accuracy300: 0.3411 - 46s/epoch - 23ms/step
Epoch 5/50
1972/1972 - 46s - loss: 3.2435 - accuracy300: 0.3964 - val_loss: 3.3100 - val_accuracy300: 0.3446 - 46s/epoch - 23ms/step
Epoch 6/50
1972/1972 - 44s - loss: 3.2402 - accuracy300: 0.3986 - val_loss: 3.3437 - val_accuracy300: 0.3391 - 44s/epoch - 22ms/step
Epoch 7/50
1972/1972 - 43s - loss: 3.2350 - accuracy300: 0.4007 - val_loss: 3.3272 - val_accuracy300: 0.3427 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 45s - loss: 3.2307 - accuracy300: 0.4028 - val_loss: 3.3628 - val_accuracy300: 0.3410 - 45s/epoch - 23ms/step
Epoch 9/50
1972/1972 - 41s - loss: 3.2264 - accuracy300: 0.4055 - val_loss: 3.3633 - val_accuracy300: 0.3414 - 41s/epoch - 21ms/step
Epoch 10/50
1972/1972 - 44s - loss: 3.2217 - accuracy300: 0.4083 - val_loss: 3.3563 - val_accuracy300: 0.3469 - 44s/epoch - 22ms/step
Epoch 11/50
1972/1972 - 46s - loss: 3.2182 - accuracy300: 0.4101 - val_loss: 3.3649 - val_accuracy300: 0.3455 - 46s/epoch - 23ms/step
testing model: results/ATVI/W4/deepVOL_L2/h300
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097504
{'0': {'precision': 0.30469340279158547, 'recall': 0.20451762507715662, 'f1-score': 0.2447518521993807, 'support': 299715}, '1': {'precision': 0.4517804584836049, 'recall': 0.21970562917178216, 'f1-score': 0.2956389170332212, 'support': 496041}, '2': {'precision': 0.28107031438221525, 'recall': 0.6140009185106718, 'f1-score': 0.38561719973725433, 'support': 298309}, 'accuracy': 0.3230539318961853, 'macro avg': {'precision': 0.34584805855246853, 'recall': 0.34607472425320357, 'f1-score': 0.30866932298995203, 'support': 1094065}, 'weighted avg': {'precision': 0.3649404907728427, 'recall': 0.3230539318961853, 'f1-score': 0.30623217693869564, 'support': 1094065}}
[[ 61297  68508 169910]
 [ 88471 108983 298587]
 [ 51408  63739 183162]]
Evaluating performance on  train set...
1972/1972 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969203
{'0': {'precision': 0.3619123902713585, 'recall': 0.2021291387325519, 'f1-score': 0.2593888427732481, 'support': 165419}, '1': {'precision': 0.33308857430713273, 'recall': 0.2343879549632905, 'f1-score': 0.27515481513873413, 'support': 166442}, '2': {'precision': 0.35620918355243314, 'recall': 0.6085433565502347, 'f1-score': 0.44937685713674935, 'support': 172719}, 'accuracy': 0.3518867176661778, 'macro avg': {'precision': 0.35040338271030813, 'recall': 0.34835348341535904, 'f1-score': 0.32797350501624384, 'support': 504580}, 'weighted avg': {'precision': 0.35045227346529456, 'recall': 0.3518867176661778, 'f1-score': 0.3296228191997926, 'support': 504580}}
[[ 33436  39771  92212]
 [ 29678  39012  97752]
 [ 29273  38339 105107]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983727
{'0': {'precision': 0.35302806499261447, 'recall': 0.16855594736389437, 'f1-score': 0.22817026032692214, 'support': 58135}, '1': {'precision': 0.3650920542635659, 'recall': 0.22871234539798163, 'f1-score': 0.28124096104501983, 'support': 65895}, '2': {'precision': 0.3254473356785449, 'recall': 0.6409632607009379, 'f1-score': 0.4317001205169763, 'support': 56724}, 'accuracy': 0.3387366254688693, 'macro avg': {'precision': 0.34785581831157514, 'recall': 0.34607718448760466, 'f1-score': 0.31370378062963944, 'support': 180754}, 'weighted avg': {'precision': 0.34877071679228727, 'recall': 0.3387366254688693, 'f1-score': 0.3113890085329905, 'support': 180754}}
[[ 9799 13848 34488]
 [ 9953 15071 40871]
 [ 8005 12361 36358]]
training model: results/ATVI/W4/deepVOL_L2/h500
Epoch 1/50
1972/1972 - 46s - loss: 3.2454 - accuracy500: 0.4083 - val_loss: 3.3477 - val_accuracy500: 0.3224 - 46s/epoch - 24ms/step
Epoch 2/50
1972/1972 - 48s - loss: 3.2338 - accuracy500: 0.4113 - val_loss: 3.3539 - val_accuracy500: 0.3297 - 48s/epoch - 24ms/step
Epoch 3/50
1972/1972 - 48s - loss: 3.2196 - accuracy500: 0.4170 - val_loss: 3.3474 - val_accuracy500: 0.3257 - 48s/epoch - 24ms/step
Epoch 4/50
1972/1972 - 47s - loss: 3.2160 - accuracy500: 0.4173 - val_loss: 3.3636 - val_accuracy500: 0.3214 - 47s/epoch - 24ms/step
Epoch 5/50
1972/1972 - 46s - loss: 3.2141 - accuracy500: 0.4141 - val_loss: 3.3874 - val_accuracy500: 0.3230 - 46s/epoch - 23ms/step
Epoch 6/50
1972/1972 - 49s - loss: 3.2120 - accuracy500: 0.4153 - val_loss: 3.4034 - val_accuracy500: 0.3177 - 49s/epoch - 25ms/step
Epoch 7/50
1972/1972 - 44s - loss: 3.2058 - accuracy500: 0.4189 - val_loss: 3.4141 - val_accuracy500: 0.3182 - 44s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 43s - loss: 3.1984 - accuracy500: 0.4226 - val_loss: 3.3986 - val_accuracy500: 0.3193 - 43s/epoch - 22ms/step
Epoch 9/50
1972/1972 - 44s - loss: 3.1932 - accuracy500: 0.4257 - val_loss: 3.4079 - val_accuracy500: 0.3207 - 44s/epoch - 23ms/step
Epoch 10/50
1972/1972 - 41s - loss: 3.1896 - accuracy500: 0.4274 - val_loss: 3.4344 - val_accuracy500: 0.3191 - 41s/epoch - 21ms/step
Epoch 11/50
1972/1972 - 44s - loss: 3.1823 - accuracy500: 0.4305 - val_loss: 3.4563 - val_accuracy500: 0.3196 - 44s/epoch - 22ms/step
Epoch 12/50
1972/1972 - 44s - loss: 3.1753 - accuracy500: 0.4353 - val_loss: 3.4423 - val_accuracy500: 0.3214 - 44s/epoch - 22ms/step
Epoch 13/50
1972/1972 - 47s - loss: 3.1702 - accuracy500: 0.4364 - val_loss: 3.4301 - val_accuracy500: 0.3224 - 47s/epoch - 24ms/step
testing model: results/ATVI/W4/deepVOL_L2/h500
Evaluating performance on  test set...
4274/4274 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087424
{'0': {'precision': 0.35725629751628607, 'recall': 0.28057745055579614, 'f1-score': 0.31430780028526983, 'support': 346350}, '1': {'precision': 0.3326962352125159, 'recall': 0.10855428594419522, 'f1-score': 0.16369658739503287, 'support': 397672}, '2': {'precision': 0.3241985387795429, 'recall': 0.6411840830983622, 'f1-score': 0.4306498545101842, 'support': 350043}, 'accuracy': 0.3334253449292318, 'macro avg': {'precision': 0.33805035716944826, 'recall': 0.3434386065327845, 'f1-score': 0.30288474739682897, 'support': 1094065}, 'weighted avg': {'precision': 0.33775244158638185, 'recall': 0.3334253449292318, 'f1-score': 0.29678677496645, 'support': 1094065}}
[[ 97178  42564 206608]
 [ 93255  43169 261248]
 [ 81579  44022 224442]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036414
{'0': {'precision': 0.37462884250802914, 'recall': 0.2612953671333949, 'f1-score': 0.3078630423493089, 'support': 165621}, '1': {'precision': 0.29781406645651387, 'recall': 0.06902333714600538, 'f1-score': 0.11207210886338113, 'support': 166987}, '2': {'precision': 0.34973356052757015, 'recall': 0.712517153955295, 'f1-score': 0.469175793985829, 'support': 171972}, 'accuracy': 0.35145071148281737, 'macro avg': {'precision': 0.3407254898307044, 'recall': 0.3476119527448984, 'f1-score': 0.296370315066173, 'support': 504580}, 'weighted avg': {'precision': 0.34072270187372367, 'recall': 0.35145071148281737, 'f1-score': 0.298046434307811, 'support': 504580}}
[[ 43276  13793 108552]
 [ 36185  11526 119276]
 [ 36056  13383 122533]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137612
{'0': {'precision': 0.35915135519236624, 'recall': 0.23487237361834898, 'f1-score': 0.28401131870998814, 'support': 60254}, '1': {'precision': 0.29677562490755804, 'recall': 0.06403893720577675, 'f1-score': 0.10534605641382387, 'support': 62665}, '2': {'precision': 0.31813843602340647, 'recall': 0.7031555286591165, 'f1-score': 0.4380732833143922, 'support': 57835}, 'accuracy': 0.3254810405302234, 'macro avg': {'precision': 0.3246884720411103, 'recall': 0.3340222798277474, 'f1-score': 0.27581021947940143, 'support': 180754}, 'weighted avg': {'precision': 0.3244038125740325, 'recall': 0.3254810405302234, 'f1-score': 0.2713649322461012, 'support': 180754}}
[[14152  4762 41340]
 [12831  4013 45821]
 [12421  4747 40667]]
training model: results/ATVI/W4/deepVOL_L2/h1000
Epoch 1/50
1972/1972 - 45s - loss: 3.2833 - accuracy1000: 0.3838 - val_loss: 3.3349 - val_accuracy1000: 0.3364 - 45s/epoch - 23ms/step
Epoch 2/50
1972/1972 - 41s - loss: 3.2651 - accuracy1000: 0.3873 - val_loss: 3.3421 - val_accuracy1000: 0.3469 - 41s/epoch - 21ms/step
Epoch 3/50
1972/1972 - 45s - loss: 3.2367 - accuracy1000: 0.4060 - val_loss: 3.3603 - val_accuracy1000: 0.3451 - 45s/epoch - 23ms/step
Epoch 4/50
1972/1972 - 45s - loss: 3.2267 - accuracy1000: 0.4079 - val_loss: 3.3480 - val_accuracy1000: 0.3541 - 45s/epoch - 23ms/step
Epoch 5/50
1972/1972 - 42s - loss: 3.2187 - accuracy1000: 0.4121 - val_loss: 3.3862 - val_accuracy1000: 0.3573 - 42s/epoch - 21ms/step
Epoch 6/50
1972/1972 - 42s - loss: 3.2111 - accuracy1000: 0.4148 - val_loss: 3.3889 - val_accuracy1000: 0.3559 - 42s/epoch - 21ms/step
Epoch 7/50
1972/1972 - 43s - loss: 3.2034 - accuracy1000: 0.4192 - val_loss: 3.4127 - val_accuracy1000: 0.3605 - 43s/epoch - 22ms/step
Epoch 8/50
1972/1972 - 42s - loss: 3.1988 - accuracy1000: 0.4210 - val_loss: 3.4245 - val_accuracy1000: 0.3599 - 42s/epoch - 21ms/step
Epoch 9/50
1972/1972 - 43s - loss: 3.1923 - accuracy1000: 0.4246 - val_loss: 3.4417 - val_accuracy1000: 0.3633 - 43s/epoch - 22ms/step
Epoch 10/50
1972/1972 - 41s - loss: 3.1867 - accuracy1000: 0.4263 - val_loss: 3.4487 - val_accuracy1000: 0.3649 - 41s/epoch - 21ms/step
Epoch 11/50
1972/1972 - 46s - loss: 3.1811 - accuracy1000: 0.4290 - val_loss: 3.4696 - val_accuracy1000: 0.3656 - 46s/epoch - 23ms/step
testing model: results/ATVI/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
4274/4274 - 41s - 41s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106145
{'0': {'precision': 0.3948887056883759, 'recall': 0.0061520362083934835, 'f1-score': 0.012115325760622409, 'support': 389302}, '1': {'precision': 0.2876455132683165, 'recall': 0.5076020099461922, 'f1-score': 0.3672050183741779, 'support': 309063}, '2': {'precision': 0.3830369533526354, 'recall': 0.5252388172858226, 'f1-score': 0.4430061504652548, 'support': 395700}, 'accuracy': 0.3355495331630205, 'macro avg': {'precision': 0.35519039076977593, 'recall': 0.34633095448013607, 'f1-score': 0.2741088315333517, 'support': 1094065}, 'weighted avg': {'precision': 0.36030699328721755, 'recall': 0.3355495331630205, 'f1-score': 0.26826883126883844, 'support': 1094065}}
[[  2395 202456 184451]
 [  1867 156881 150315]
 [  1803 186060 207837]]
Evaluating performance on  train set...
1972/1972 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990331
{'0': {'precision': 0.3474930362116992, 'recall': 0.00616826126727484, 'f1-score': 0.01212135934121991, 'support': 161796}, '1': {'precision': 0.34854233110765787, 'recall': 0.5272256188706453, 'f1-score': 0.41965556338389615, 'support': 170593}, '2': {'precision': 0.36049150657271023, 'recall': 0.5101137690123178, 'f1-score': 0.42244559336299153, 'support': 172191}, 'accuracy': 0.35430655198382816, 'macro avg': {'precision': 0.35217562463068913, 'recall': 0.34783588305007934, 'f1-score': 0.2847408386960359, 'support': 504580}, 'weighted avg': {'precision': 0.3522835986083838, 'recall': 0.35430655198382816, 'f1-score': 0.2899298786061435, 'support': 504580}}
[[  998 84690 76108]
 [  938 89941 79714]
 [  936 83418 87837]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1071109
{'0': {'precision': 0.3728414442700157, 'recall': 0.007474076754834548, 'f1-score': 0.0146543878322304, 'support': 63553}, '1': {'precision': 0.32854440300524296, 'recall': 0.5322405519946762, 'f1-score': 0.40629114947829986, 'support': 57102}, '2': {'precision': 0.34248922104052887, 'recall': 0.4956488460706501, 'f1-score': 0.40507499626038596, 'support': 60099}, 'accuracy': 0.3355665711408876, 'macro avg': {'precision': 0.34795835610526255, 'recall': 0.3451211582733869, 'f1-score': 0.27534017785697207, 'support': 180754}, 'weighted avg': {'precision': 0.348755737098003, 'recall': 0.3355665711408876, 'f1-score': 0.2681875351453608, 'support': 180754}}
[[  475 32218 30860]
 [  383 30392 26327]
 [  416 29895 29788]]
training model: results/ATVI/W4/deepVOL_L3/h10
Epoch 1/50
1972/1972 - 69s - loss: 3.1781 - accuracy10: 0.4349 - val_loss: 3.1047 - val_accuracy10: 0.3515 - 69s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 71s - loss: 2.7270 - accuracy10: 0.5173 - val_loss: 2.7397 - val_accuracy10: 0.5214 - 71s/epoch - 36ms/step
Epoch 3/50
1972/1972 - 71s - loss: 2.6003 - accuracy10: 0.5695 - val_loss: 2.6682 - val_accuracy10: 0.5981 - 71s/epoch - 36ms/step
Epoch 4/50
1972/1972 - 71s - loss: 2.5418 - accuracy10: 0.5850 - val_loss: 2.6278 - val_accuracy10: 0.6077 - 71s/epoch - 36ms/step
Epoch 5/50
1972/1972 - 70s - loss: 2.5113 - accuracy10: 0.5932 - val_loss: 2.5968 - val_accuracy10: 0.5986 - 70s/epoch - 36ms/step
Epoch 6/50
1972/1972 - 72s - loss: 2.4911 - accuracy10: 0.5986 - val_loss: 2.5716 - val_accuracy10: 0.6018 - 72s/epoch - 36ms/step
Epoch 7/50
1972/1972 - 72s - loss: 2.4758 - accuracy10: 0.6010 - val_loss: 2.5585 - val_accuracy10: 0.6017 - 72s/epoch - 37ms/step
Epoch 8/50
1972/1972 - 71s - loss: 2.4641 - accuracy10: 0.6041 - val_loss: 2.5527 - val_accuracy10: 0.5952 - 71s/epoch - 36ms/step
Epoch 9/50
1972/1972 - 72s - loss: 2.4519 - accuracy10: 0.6066 - val_loss: 2.5352 - val_accuracy10: 0.6052 - 72s/epoch - 37ms/step
Epoch 10/50
1972/1972 - 72s - loss: 2.4398 - accuracy10: 0.6087 - val_loss: 2.5412 - val_accuracy10: 0.5988 - 72s/epoch - 36ms/step
Epoch 11/50
1972/1972 - 72s - loss: 2.4289 - accuracy10: 0.6099 - val_loss: 2.5433 - val_accuracy10: 0.5897 - 72s/epoch - 36ms/step
Epoch 12/50
1972/1972 - 71s - loss: 2.4205 - accuracy10: 0.6111 - val_loss: 2.5325 - val_accuracy10: 0.5852 - 71s/epoch - 36ms/step
Epoch 13/50
1972/1972 - 73s - loss: 2.4127 - accuracy10: 0.6121 - val_loss: 2.5307 - val_accuracy10: 0.5780 - 73s/epoch - 37ms/step
Epoch 14/50
1972/1972 - 72s - loss: 2.4047 - accuracy10: 0.6133 - val_loss: 2.5428 - val_accuracy10: 0.5726 - 72s/epoch - 36ms/step
Epoch 15/50
1972/1972 - 71s - loss: 2.3990 - accuracy10: 0.6145 - val_loss: 2.5427 - val_accuracy10: 0.5782 - 71s/epoch - 36ms/step
Epoch 16/50
1972/1972 - 69s - loss: 2.3920 - accuracy10: 0.6159 - val_loss: 2.5465 - val_accuracy10: 0.5716 - 69s/epoch - 35ms/step
Epoch 17/50
1972/1972 - 71s - loss: 2.3868 - accuracy10: 0.6167 - val_loss: 2.5285 - val_accuracy10: 0.5833 - 71s/epoch - 36ms/step
Epoch 18/50
1972/1972 - 70s - loss: 2.3805 - accuracy10: 0.6175 - val_loss: 2.5300 - val_accuracy10: 0.5780 - 70s/epoch - 36ms/step
Epoch 19/50
1972/1972 - 71s - loss: 2.3763 - accuracy10: 0.6185 - val_loss: 2.5317 - val_accuracy10: 0.5799 - 71s/epoch - 36ms/step
Epoch 20/50
1972/1972 - 72s - loss: 2.3716 - accuracy10: 0.6180 - val_loss: 2.5202 - val_accuracy10: 0.5884 - 72s/epoch - 36ms/step
Epoch 21/50
1972/1972 - 71s - loss: 2.3673 - accuracy10: 0.6190 - val_loss: 2.5259 - val_accuracy10: 0.5844 - 71s/epoch - 36ms/step
Epoch 22/50
1972/1972 - 71s - loss: 2.3635 - accuracy10: 0.6203 - val_loss: 2.5111 - val_accuracy10: 0.5934 - 71s/epoch - 36ms/step
Epoch 23/50
1972/1972 - 71s - loss: 2.3576 - accuracy10: 0.6205 - val_loss: 2.5211 - val_accuracy10: 0.5962 - 71s/epoch - 36ms/step
Epoch 24/50
1972/1972 - 71s - loss: 2.3551 - accuracy10: 0.6215 - val_loss: 2.5179 - val_accuracy10: 0.6048 - 71s/epoch - 36ms/step
Epoch 25/50
1972/1972 - 71s - loss: 2.3505 - accuracy10: 0.6216 - val_loss: 2.5219 - val_accuracy10: 0.5974 - 71s/epoch - 36ms/step
Epoch 26/50
1972/1972 - 70s - loss: 2.3486 - accuracy10: 0.6217 - val_loss: 2.5220 - val_accuracy10: 0.5948 - 70s/epoch - 36ms/step
Epoch 27/50
1972/1972 - 71s - loss: 2.3437 - accuracy10: 0.6221 - val_loss: 2.5275 - val_accuracy10: 0.6058 - 71s/epoch - 36ms/step
Epoch 28/50
1972/1972 - 71s - loss: 2.3404 - accuracy10: 0.6227 - val_loss: 2.5180 - val_accuracy10: 0.6032 - 71s/epoch - 36ms/step
Epoch 29/50
1972/1972 - 72s - loss: 2.3370 - accuracy10: 0.6229 - val_loss: 2.5153 - val_accuracy10: 0.5965 - 72s/epoch - 37ms/step
Epoch 30/50
1972/1972 - 71s - loss: 2.3325 - accuracy10: 0.6235 - val_loss: 2.5177 - val_accuracy10: 0.6038 - 71s/epoch - 36ms/step
Epoch 31/50
1972/1972 - 71s - loss: 2.3307 - accuracy10: 0.6238 - val_loss: 2.5147 - val_accuracy10: 0.6084 - 71s/epoch - 36ms/step
Epoch 32/50
1972/1972 - 71s - loss: 2.3263 - accuracy10: 0.6240 - val_loss: 2.5166 - val_accuracy10: 0.5960 - 71s/epoch - 36ms/step
testing model: results/ATVI/W4/deepVOL_L3/h10
Evaluating performance on  test set...
4274/4274 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98130846
{'0': {'precision': 0.41191792209307415, 'recall': 0.6121383925862353, 'f1-score': 0.49245489938994097, 'support': 230706}, '1': {'precision': 0.8173432532387482, 'recall': 0.4757283081096561, 'f1-score': 0.6014103698988473, 'support': 635514}, '2': {'precision': 0.39280769109733454, 'recall': 0.6574074480458206, 'f1-score': 0.4917748605066902, 'support': 227845}, 'accuracy': 0.5423288378661232, 'macro avg': {'precision': 0.5406896221430523, 'recall': 0.5817580495805706, 'f1-score': 0.5285467099318262, 'support': 1094065}, 'weighted avg': {'precision': 0.6434391784320372, 'recall': 0.5423288378661232, 'f1-score': 0.5556026862450573, 'support': 1094065}}
[[141224  33776  55706]
 [157351 302332 175831]
 [ 44270  33788 149787]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8534691
{'0': {'precision': 0.4116298689928527, 'recall': 0.5955276127308737, 'f1-score': 0.486789717910827, 'support': 86844}, '1': {'precision': 0.8706949151787504, 'recall': 0.5908461729096525, 'f1-score': 0.7039785095308142, 'support': 330878}, '2': {'precision': 0.3836030749901235, 'recall': 0.6819291256994174, 'f1-score': 0.49100366816570995, 'support': 86858}, 'accuracy': 0.607330849419319, 'macro avg': {'precision': 0.5553092863872423, 'recall': 0.6227676371133145, 'f1-score': 0.5605906318691171, 'support': 504580}, 'weighted avg': {'precision': 0.7078369582124182, 'recall': 0.607330849419319, 'f1-score': 0.6299365098662687, 'support': 504580}}
[[ 51718  15069  20057]
 [ 60261 195498  75119]
 [ 13663  13964  59231]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87013495
{'0': {'precision': 0.40725722603451864, 'recall': 0.6108477325182459, 'f1-score': 0.48869647669428096, 'support': 32062}, '1': {'precision': 0.8623614845992958, 'recall': 0.5654151476951381, 'f1-score': 0.6830091418399946, 'support': 117404}, '2': {'precision': 0.38226156912744447, 'recall': 0.6803566862694963, 'f1-score': 0.4894969818913481, 'support': 31288}, 'accuracy': 0.5933699945782666, 'macro avg': {'precision': 0.5506267599204197, 'recall': 0.6188731888276268, 'f1-score': 0.5537342001418746, 'support': 180754}, 'weighted avg': {'precision': 0.6985315339847193, 'recall': 0.5933699945782666, 'f1-score': 0.6150457156896736, 'support': 180754}}
[[19585  5563  6914]
 [23536 66382 27486]
 [ 4969  5032 21287]]
training model: results/ATVI/W4/deepVOL_L3/h20
Epoch 1/50
1972/1972 - 69s - loss: 3.1733 - accuracy20: 0.4343 - val_loss: 3.1543 - val_accuracy20: 0.3582 - 69s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 64s - loss: 2.8601 - accuracy20: 0.5116 - val_loss: 2.9462 - val_accuracy20: 0.5587 - 64s/epoch - 33ms/step
Epoch 3/50
1972/1972 - 65s - loss: 2.6975 - accuracy20: 0.5700 - val_loss: 2.8584 - val_accuracy20: 0.5676 - 65s/epoch - 33ms/step
Epoch 4/50
1972/1972 - 67s - loss: 2.6467 - accuracy20: 0.5819 - val_loss: 2.8246 - val_accuracy20: 0.5540 - 67s/epoch - 34ms/step
Epoch 5/50
1972/1972 - 63s - loss: 2.6164 - accuracy20: 0.5881 - val_loss: 2.7840 - val_accuracy20: 0.5710 - 63s/epoch - 32ms/step
Epoch 6/50
1972/1972 - 64s - loss: 2.5956 - accuracy20: 0.5920 - val_loss: 2.7537 - val_accuracy20: 0.5767 - 64s/epoch - 33ms/step
Epoch 7/50
1972/1972 - 64s - loss: 2.5818 - accuracy20: 0.5942 - val_loss: 2.7188 - val_accuracy20: 0.5809 - 64s/epoch - 32ms/step
Epoch 8/50
1972/1972 - 64s - loss: 2.5684 - accuracy20: 0.5961 - val_loss: 2.7218 - val_accuracy20: 0.5776 - 64s/epoch - 33ms/step
Epoch 9/50
1972/1972 - 64s - loss: 2.5583 - accuracy20: 0.5980 - val_loss: 2.7032 - val_accuracy20: 0.5814 - 64s/epoch - 33ms/step
Epoch 10/50
1972/1972 - 64s - loss: 2.5498 - accuracy20: 0.5994 - val_loss: 2.7000 - val_accuracy20: 0.5800 - 64s/epoch - 33ms/step
Epoch 11/50
1972/1972 - 63s - loss: 2.5420 - accuracy20: 0.6012 - val_loss: 2.6771 - val_accuracy20: 0.5812 - 63s/epoch - 32ms/step
Epoch 12/50
1972/1972 - 66s - loss: 2.5338 - accuracy20: 0.6024 - val_loss: 2.6966 - val_accuracy20: 0.5701 - 66s/epoch - 33ms/step
Epoch 13/50
1972/1972 - 66s - loss: 2.5290 - accuracy20: 0.6040 - val_loss: 2.6732 - val_accuracy20: 0.5727 - 66s/epoch - 34ms/step
Epoch 14/50
1972/1972 - 65s - loss: 2.5227 - accuracy20: 0.6047 - val_loss: 2.6717 - val_accuracy20: 0.5756 - 65s/epoch - 33ms/step
Epoch 15/50
1972/1972 - 65s - loss: 2.5176 - accuracy20: 0.6054 - val_loss: 2.6777 - val_accuracy20: 0.5655 - 65s/epoch - 33ms/step
Epoch 16/50
1972/1972 - 66s - loss: 2.5120 - accuracy20: 0.6066 - val_loss: 2.6619 - val_accuracy20: 0.5684 - 66s/epoch - 33ms/step
Epoch 17/50
1972/1972 - 64s - loss: 2.5080 - accuracy20: 0.6075 - val_loss: 2.6798 - val_accuracy20: 0.5591 - 64s/epoch - 33ms/step
Epoch 18/50
1972/1972 - 65s - loss: 2.5036 - accuracy20: 0.6078 - val_loss: 2.6739 - val_accuracy20: 0.5571 - 65s/epoch - 33ms/step
Epoch 19/50
1972/1972 - 67s - loss: 2.4995 - accuracy20: 0.6079 - val_loss: 2.6761 - val_accuracy20: 0.5590 - 67s/epoch - 34ms/step
Epoch 20/50
1972/1972 - 63s - loss: 2.4938 - accuracy20: 0.6097 - val_loss: 2.6897 - val_accuracy20: 0.5511 - 63s/epoch - 32ms/step
Epoch 21/50
1972/1972 - 66s - loss: 2.4905 - accuracy20: 0.6098 - val_loss: 2.6952 - val_accuracy20: 0.5496 - 66s/epoch - 34ms/step
Epoch 22/50
1972/1972 - 66s - loss: 2.4865 - accuracy20: 0.6103 - val_loss: 2.6849 - val_accuracy20: 0.5518 - 66s/epoch - 33ms/step
Epoch 23/50
1972/1972 - 64s - loss: 2.4822 - accuracy20: 0.6111 - val_loss: 2.6817 - val_accuracy20: 0.5562 - 64s/epoch - 33ms/step
Epoch 24/50
1972/1972 - 65s - loss: 2.4791 - accuracy20: 0.6116 - val_loss: 2.6973 - val_accuracy20: 0.5493 - 65s/epoch - 33ms/step
Epoch 25/50
1972/1972 - 65s - loss: 2.4762 - accuracy20: 0.6119 - val_loss: 2.7007 - val_accuracy20: 0.5558 - 65s/epoch - 33ms/step
Epoch 26/50
1972/1972 - 65s - loss: 2.4735 - accuracy20: 0.6124 - val_loss: 2.7043 - val_accuracy20: 0.5524 - 65s/epoch - 33ms/step
testing model: results/ATVI/W4/deepVOL_L3/h20
Evaluating performance on  test set...
4274/4274 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0077426
{'0': {'precision': 0.4430179079991521, 'recall': 0.6455195568239046, 'f1-score': 0.5254329462755826, 'support': 297850}, '1': {'precision': 0.7288936198523053, 'recall': 0.41329688067711406, 'f1-score': 0.5274942477472455, 'support': 503667}, '2': {'precision': 0.4628765221106601, 'recall': 0.5925113143825971, 'f1-score': 0.519732305090641, 'support': 292548}, 'accuracy': 0.5244386759470415, 'macro avg': {'precision': 0.5449293499873725, 'recall': 0.5504425839612053, 'f1-score': 0.524219833037823, 'support': 1094065}, 'weighted avg': {'precision': 0.5799345994233688, 'recall': 0.5244386759470415, 'f1-score': 0.524857567619795, 'support': 1094065}}
[[192268  35859  69723]
 [164084 208164 131419]
 [ 77644  41566 173338]]
Evaluating performance on  train set...
1972/1972 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9030167
{'0': {'precision': 0.4364065920661518, 'recall': 0.6018078315759652, 'f1-score': 0.5059319132466992, 'support': 112953}, '1': {'precision': 0.7983180765696155, 'recall': 0.5582505798131673, 'f1-score': 0.6570423502318751, 'support': 278538}, '2': {'precision': 0.4509867566865749, 'recall': 0.6142949358469878, 'f1-score': 0.5201232363389974, 'support': 113089}, 'accuracy': 0.5805620516072774, 'macro avg': {'precision': 0.5619038084407807, 'recall': 0.5914511157453733, 'f1-score': 0.5610324999391906, 'support': 504580}, 'weighted avg': {'precision': 0.6394565688931857, 'recall': 0.5805620516072774, 'f1-score': 0.592528451821676, 'support': 504580}}
[[ 67976  19177  25800]
 [ 64274 155494  58770]
 [ 23513  20106  69470]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91643226
{'0': {'precision': 0.4406108311281161, 'recall': 0.6207641708817173, 'f1-score': 0.5153982649842271, 'support': 42111}, '1': {'precision': 0.7828128561659449, 'recall': 0.5287126273978507, 'f1-score': 0.6311475409836065, 'support': 97431}, '2': {'precision': 0.45296655879180153, 'recall': 0.6113267980199941, 'f1-score': 0.5203651685393259, 'support': 41212}, 'accuracy': 0.5689943237770672, 'macro avg': {'precision': 0.5587967486952875, 'recall': 0.5869345320998541, 'f1-score': 0.5556369915023865, 'support': 180754}, 'weighted avg': {'precision': 0.6278835318702103, 'recall': 0.568994323777067, 'f1-score': 0.5789225230322276, 'support': 180754}}
[[26141  6863  9107]
 [24599 51513 21319]
 [ 8589  7429 25194]]
training model: results/ATVI/W4/deepVOL_L3/h30
Epoch 1/50
1972/1972 - 69s - loss: 3.2654 - accuracy30: 0.4049 - val_loss: 3.3000 - val_accuracy30: 0.3217 - 69s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 66s - loss: 3.0861 - accuracy30: 0.4308 - val_loss: 3.0325 - val_accuracy30: 0.4560 - 66s/epoch - 33ms/step
Epoch 3/50
1972/1972 - 66s - loss: 2.8558 - accuracy30: 0.5294 - val_loss: 2.9156 - val_accuracy30: 0.5319 - 66s/epoch - 33ms/step
Epoch 4/50
1972/1972 - 67s - loss: 2.7697 - accuracy30: 0.5575 - val_loss: 2.9236 - val_accuracy30: 0.5322 - 67s/epoch - 34ms/step
Epoch 5/50
1972/1972 - 67s - loss: 2.7327 - accuracy30: 0.5659 - val_loss: 2.8610 - val_accuracy30: 0.5525 - 67s/epoch - 34ms/step
Epoch 6/50
1972/1972 - 67s - loss: 2.7114 - accuracy30: 0.5694 - val_loss: 2.8893 - val_accuracy30: 0.5318 - 67s/epoch - 34ms/step
Epoch 7/50
1972/1972 - 66s - loss: 2.6975 - accuracy30: 0.5727 - val_loss: 2.8864 - val_accuracy30: 0.5249 - 66s/epoch - 33ms/step
Epoch 8/50
1972/1972 - 68s - loss: 2.6875 - accuracy30: 0.5747 - val_loss: 2.8919 - val_accuracy30: 0.5234 - 68s/epoch - 34ms/step
Epoch 9/50
1972/1972 - 66s - loss: 2.6772 - accuracy30: 0.5773 - val_loss: 2.8760 - val_accuracy30: 0.5276 - 66s/epoch - 33ms/step
Epoch 10/50
1972/1972 - 66s - loss: 2.6698 - accuracy30: 0.5780 - val_loss: 2.8396 - val_accuracy30: 0.5317 - 66s/epoch - 34ms/step
Epoch 11/50
1972/1972 - 67s - loss: 2.6638 - accuracy30: 0.5796 - val_loss: 2.8218 - val_accuracy30: 0.5354 - 67s/epoch - 34ms/step
Epoch 12/50
1972/1972 - 67s - loss: 2.6569 - accuracy30: 0.5807 - val_loss: 2.8128 - val_accuracy30: 0.5385 - 67s/epoch - 34ms/step
Epoch 13/50
1972/1972 - 66s - loss: 2.6506 - accuracy30: 0.5812 - val_loss: 2.8060 - val_accuracy30: 0.5362 - 66s/epoch - 33ms/step
Epoch 14/50
1972/1972 - 66s - loss: 2.6448 - accuracy30: 0.5821 - val_loss: 2.8227 - val_accuracy30: 0.5338 - 66s/epoch - 33ms/step
Epoch 15/50
1972/1972 - 66s - loss: 2.6399 - accuracy30: 0.5832 - val_loss: 2.8042 - val_accuracy30: 0.5325 - 66s/epoch - 33ms/step
Epoch 16/50
1972/1972 - 66s - loss: 2.6352 - accuracy30: 0.5832 - val_loss: 2.7903 - val_accuracy30: 0.5411 - 66s/epoch - 33ms/step
Epoch 17/50
1972/1972 - 66s - loss: 2.6294 - accuracy30: 0.5846 - val_loss: 2.7877 - val_accuracy30: 0.5466 - 66s/epoch - 34ms/step
Epoch 18/50
1972/1972 - 66s - loss: 2.6260 - accuracy30: 0.5849 - val_loss: 2.8020 - val_accuracy30: 0.5294 - 66s/epoch - 34ms/step
Epoch 19/50
1972/1972 - 66s - loss: 2.6222 - accuracy30: 0.5857 - val_loss: 2.7985 - val_accuracy30: 0.5399 - 66s/epoch - 34ms/step
Epoch 20/50
1972/1972 - 66s - loss: 2.6191 - accuracy30: 0.5862 - val_loss: 2.8048 - val_accuracy30: 0.5405 - 66s/epoch - 33ms/step
Epoch 21/50
1972/1972 - 66s - loss: 2.6146 - accuracy30: 0.5869 - val_loss: 2.7983 - val_accuracy30: 0.5406 - 66s/epoch - 33ms/step
Epoch 22/50
1972/1972 - 66s - loss: 2.6097 - accuracy30: 0.5878 - val_loss: 2.7936 - val_accuracy30: 0.5406 - 66s/epoch - 34ms/step
Epoch 23/50
1972/1972 - 67s - loss: 2.6061 - accuracy30: 0.5884 - val_loss: 2.7873 - val_accuracy30: 0.5459 - 67s/epoch - 34ms/step
Epoch 24/50
1972/1972 - 66s - loss: 2.6034 - accuracy30: 0.5892 - val_loss: 2.8043 - val_accuracy30: 0.5374 - 66s/epoch - 33ms/step
Epoch 25/50
1972/1972 - 67s - loss: 2.5996 - accuracy30: 0.5898 - val_loss: 2.8054 - val_accuracy30: 0.5344 - 67s/epoch - 34ms/step
Epoch 26/50
1972/1972 - 72s - loss: 2.5974 - accuracy30: 0.5899 - val_loss: 2.8068 - val_accuracy30: 0.5357 - 72s/epoch - 37ms/step
Epoch 27/50
1972/1972 - 72s - loss: 2.5929 - accuracy30: 0.5908 - val_loss: 2.8013 - val_accuracy30: 0.5385 - 72s/epoch - 37ms/step
Epoch 28/50
1972/1972 - 73s - loss: 2.5908 - accuracy30: 0.5909 - val_loss: 2.8129 - val_accuracy30: 0.5350 - 73s/epoch - 37ms/step
Epoch 29/50
1972/1972 - 73s - loss: 2.5892 - accuracy30: 0.5915 - val_loss: 2.8097 - val_accuracy30: 0.5369 - 73s/epoch - 37ms/step
Epoch 30/50
1972/1972 - 73s - loss: 2.5842 - accuracy30: 0.5919 - val_loss: 2.8244 - val_accuracy30: 0.5305 - 73s/epoch - 37ms/step
Epoch 31/50
1972/1972 - 74s - loss: 2.5812 - accuracy30: 0.5922 - val_loss: 2.8327 - val_accuracy30: 0.5286 - 74s/epoch - 37ms/step
Epoch 32/50
1972/1972 - 73s - loss: 2.5785 - accuracy30: 0.5932 - val_loss: 2.8463 - val_accuracy30: 0.5215 - 73s/epoch - 37ms/step
Epoch 33/50
1972/1972 - 74s - loss: 2.5747 - accuracy30: 0.5939 - val_loss: 2.8446 - val_accuracy30: 0.5191 - 74s/epoch - 37ms/step
testing model: results/ATVI/W4/deepVOL_L3/h30
Evaluating performance on  test set...
4274/4274 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0169055
{'0': {'precision': 0.4705362113240074, 'recall': 0.6151584248197417, 'f1-score': 0.5332149666076105, 'support': 340761}, '1': {'precision': 0.6429433146366684, 'recall': 0.3916023522956354, 'f1-score': 0.48674142177031116, 'support': 419165}, '2': {'precision': 0.48472149822638677, 'recall': 0.5704931181334714, 'f1-score': 0.524121396088006, 'support': 334139}, 'accuracy': 0.5158669731688702, 'macro avg': {'precision': 0.5327336747290209, 'recall': 0.5257512984162828, 'f1-score': 0.5146925948219759, 'support': 1094065}, 'weighted avg': {'precision': 0.5409222313870985, 'recall': 0.5158669731688702, 'f1-score': 0.5126324601006144, 'support': 1094065}}
[[209622  42654  88485]
 [140863 164146 114156]
 [ 95011  48504 190624]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93162006
{'0': {'precision': 0.46196908157803596, 'recall': 0.561484474854392, 'f1-score': 0.5068885940911477, 'support': 130659}, '1': {'precision': 0.7318842989866737, 'recall': 0.5433068598000083, 'f1-score': 0.6236520030419975, 'support': 243010}, '2': {'precision': 0.47426819608293674, 'recall': 0.5991398736546203, 'f1-score': 0.5294407506159506, 'support': 130911}, 'accuracy': 0.562499504538428, 'macro avg': {'precision': 0.5560405255492155, 'recall': 0.5679770694363402, 'f1-score': 0.5533271159163653, 'support': 504580}, 'weighted avg': {'precision': 0.5951534851640364, 'recall': 0.562499504538428, 'f1-score': 0.5689738954744061, 'support': 504580}}
[[ 73363  23544  33752]
 [ 57788 132029  53193]
 [ 27654  24823  78434]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94890434
{'0': {'precision': 0.46107744776663023, 'recall': 0.569192094667784, 'f1-score': 0.5094620921787966, 'support': 48929}, '1': {'precision': 0.7043710764938387, 'recall': 0.506085483139632, 'f1-score': 0.5889876406054714, 'support': 83806}, '2': {'precision': 0.4706009511456982, 'recall': 0.5893708740290302, 'f1-score': 0.5233318231829654, 'support': 48019}, 'accuracy': 0.5452936034610576, 'macro avg': {'precision': 0.5453498251353891, 'recall': 0.5548828172788154, 'f1-score': 0.5405938519890778, 'support': 180754}, 'weighted avg': {'precision': 0.5764097499998969, 'recall': 0.5452936034610576, 'f1-score': 0.5500184766822382, 'support': 180754}}
[[27850  8558 12521]
 [22077 42413 19316]
 [10475  9243 28301]]
training model: results/ATVI/W4/deepVOL_L3/h50
Epoch 1/50
1972/1972 - 70s - loss: 3.2660 - accuracy50: 0.4032 - val_loss: 3.3128 - val_accuracy50: 0.3313 - 70s/epoch - 36ms/step
Epoch 2/50
1972/1972 - 69s - loss: 3.1918 - accuracy50: 0.4261 - val_loss: 3.2020 - val_accuracy50: 0.4086 - 69s/epoch - 35ms/step
Epoch 3/50
1972/1972 - 67s - loss: 3.0073 - accuracy50: 0.4926 - val_loss: 3.0772 - val_accuracy50: 0.4792 - 67s/epoch - 34ms/step
Epoch 4/50
1972/1972 - 66s - loss: 2.9141 - accuracy50: 0.5180 - val_loss: 3.0510 - val_accuracy50: 0.4863 - 66s/epoch - 34ms/step
Epoch 5/50
1972/1972 - 67s - loss: 2.8696 - accuracy50: 0.5282 - val_loss: 2.9994 - val_accuracy50: 0.4945 - 67s/epoch - 34ms/step
Epoch 6/50
1972/1972 - 66s - loss: 2.8468 - accuracy50: 0.5332 - val_loss: 2.9983 - val_accuracy50: 0.5028 - 66s/epoch - 34ms/step
Epoch 7/50
1972/1972 - 66s - loss: 2.8327 - accuracy50: 0.5368 - val_loss: 2.9767 - val_accuracy50: 0.5022 - 66s/epoch - 34ms/step
Epoch 8/50
1972/1972 - 65s - loss: 2.8225 - accuracy50: 0.5397 - val_loss: 2.9871 - val_accuracy50: 0.5010 - 65s/epoch - 33ms/step
Epoch 9/50
1972/1972 - 65s - loss: 2.8166 - accuracy50: 0.5414 - val_loss: 2.9881 - val_accuracy50: 0.4992 - 65s/epoch - 33ms/step
Epoch 10/50
1972/1972 - 64s - loss: 2.8112 - accuracy50: 0.5427 - val_loss: 2.9629 - val_accuracy50: 0.5081 - 64s/epoch - 33ms/step
Epoch 11/50
1972/1972 - 64s - loss: 2.8056 - accuracy50: 0.5437 - val_loss: 2.9750 - val_accuracy50: 0.5042 - 64s/epoch - 33ms/step
Epoch 12/50
1972/1972 - 65s - loss: 2.8006 - accuracy50: 0.5450 - val_loss: 2.9624 - val_accuracy50: 0.5093 - 65s/epoch - 33ms/step
Epoch 13/50
1972/1972 - 65s - loss: 2.7980 - accuracy50: 0.5457 - val_loss: 2.9844 - val_accuracy50: 0.5106 - 65s/epoch - 33ms/step
Epoch 14/50
1972/1972 - 64s - loss: 2.7927 - accuracy50: 0.5468 - val_loss: 2.9558 - val_accuracy50: 0.5123 - 64s/epoch - 33ms/step
Epoch 15/50
1972/1972 - 64s - loss: 2.7896 - accuracy50: 0.5476 - val_loss: 2.9506 - val_accuracy50: 0.5141 - 64s/epoch - 33ms/step
Epoch 16/50
1972/1972 - 65s - loss: 2.7870 - accuracy50: 0.5480 - val_loss: 2.9577 - val_accuracy50: 0.5164 - 65s/epoch - 33ms/step
Epoch 17/50
1972/1972 - 65s - loss: 2.7834 - accuracy50: 0.5487 - val_loss: 2.9560 - val_accuracy50: 0.5119 - 65s/epoch - 33ms/step
Epoch 18/50
1972/1972 - 65s - loss: 2.7795 - accuracy50: 0.5503 - val_loss: 2.9473 - val_accuracy50: 0.5108 - 65s/epoch - 33ms/step
Epoch 19/50
1972/1972 - 65s - loss: 2.7774 - accuracy50: 0.5505 - val_loss: 2.9636 - val_accuracy50: 0.5124 - 65s/epoch - 33ms/step
Epoch 20/50
1972/1972 - 66s - loss: 2.7743 - accuracy50: 0.5512 - val_loss: 2.9741 - val_accuracy50: 0.5076 - 66s/epoch - 34ms/step
Epoch 21/50
1972/1972 - 66s - loss: 2.7715 - accuracy50: 0.5515 - val_loss: 2.9614 - val_accuracy50: 0.5087 - 66s/epoch - 34ms/step
Epoch 22/50
1972/1972 - 66s - loss: 2.7690 - accuracy50: 0.5517 - val_loss: 2.9737 - val_accuracy50: 0.5093 - 66s/epoch - 34ms/step
Epoch 23/50
1972/1972 - 68s - loss: 2.7667 - accuracy50: 0.5524 - val_loss: 2.9628 - val_accuracy50: 0.5083 - 68s/epoch - 35ms/step
Epoch 24/50
1972/1972 - 66s - loss: 2.7637 - accuracy50: 0.5534 - val_loss: 2.9550 - val_accuracy50: 0.5101 - 66s/epoch - 33ms/step
Epoch 25/50
1972/1972 - 64s - loss: 2.7601 - accuracy50: 0.5542 - val_loss: 2.9653 - val_accuracy50: 0.5069 - 64s/epoch - 32ms/step
Epoch 26/50
1972/1972 - 67s - loss: 2.7587 - accuracy50: 0.5542 - val_loss: 2.9760 - val_accuracy50: 0.5035 - 67s/epoch - 34ms/step
Epoch 27/50
1972/1972 - 67s - loss: 2.7561 - accuracy50: 0.5551 - val_loss: 2.9529 - val_accuracy50: 0.5083 - 67s/epoch - 34ms/step
Epoch 28/50
1972/1972 - 66s - loss: 2.7548 - accuracy50: 0.5553 - val_loss: 2.9872 - val_accuracy50: 0.5011 - 66s/epoch - 34ms/step
testing model: results/ATVI/W4/deepVOL_L3/h50
Evaluating performance on  test set...
4274/4274 - 59s - 59s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0158483
{'0': {'precision': 0.4619244032262771, 'recall': 0.6825774869375539, 'f1-score': 0.5509806510921318, 'support': 394260}, '1': {'precision': 0.499372918210618, 'recall': 0.3917564304059493, 'f1-score': 0.4390665668980678, 'support': 313044}, '2': {'precision': 0.5322988280956178, 'recall': 0.3659469284648659, 'f1-score': 0.433718990029924, 'support': 386761}, 'accuracy': 0.48743356199128934, 'macro avg': {'precision': 0.49786538317750434, 'recall': 0.4800936152694564, 'f1-score': 0.4745887360067078, 'support': 1094065}, 'weighted avg': {'precision': 0.49751745835705, 'recall': 0.48743356199128934, 'f1-score': 0.4775057936873824, 'support': 1094065}}
[[269113  55220  69927]
 [135976 122637  54431]
 [177502  67725 141534]]
Evaluating performance on  train set...
1972/1972 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9707917
{'0': {'precision': 0.4553644755024662, 'recall': 0.5992557597721978, 'f1-score': 0.5174939293089331, 'support': 154520}, '1': {'precision': 0.5990515643737054, 'recall': 0.5650575587284122, 'f1-score': 0.5815582195858259, 'support': 194497}, '2': {'precision': 0.5287799410730812, 'recall': 0.4003265558005438, 'f1-score': 0.4556736031843592, 'support': 155563}, 'accuracy': 0.5247433509057038, 'macro avg': {'precision': 0.527731993649751, 'recall': 0.5215466247670513, 'f1-score': 0.518241917359706, 'support': 504580}, 'weighted avg': {'precision': 0.5333846859641393, 'recall': 0.5247433509057038, 'f1-score': 0.5231290255732871, 'support': 504580}}
[[ 92597  34323  27600]
 [ 56698 109902  27897]
 [ 54052  39235  62276]]
Evaluating performance on  val set...
707/707 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98645586
{'0': {'precision': 0.4620267604310657, 'recall': 0.5930066316424081, 'f1-score': 0.5193862772313077, 'support': 58055}, '1': {'precision': 0.5609495908034264, 'recall': 0.5355150557084011, 'f1-score': 0.5479373226019674, 'support': 65789}, '2': {'precision': 0.5217221135029354, 'recall': 0.39819012475839044, 'f1-score': 0.45166176690418053, 'support': 56910}, 'accuracy': 0.5107438839527756, 'macro avg': {'precision': 0.5148994882458092, 'recall': 0.5089039373697332, 'f1-score': 0.5063284555791518, 'support': 180754}, 'weighted avg': {'precision': 0.5168266355690285, 'recall': 0.5107438839527756, 'f1-score': 0.5084550825754413, 'support': 180754}}
[[34427 12952 10676]
 [20460 35231 10098]
 [19626 14623 22661]]
training model: results/ATVI/W4/deepVOL_L3/h100
Epoch 1/50
1972/1972 - 70s - loss: 3.2793 - accuracy100: 0.3783 - val_loss: 3.2948 - val_accuracy100: 0.3516 - 70s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 67s - loss: 3.2580 - accuracy100: 0.3854 - val_loss: 3.2552 - val_accuracy100: 0.3899 - 67s/epoch - 34ms/step
Epoch 3/50
1972/1972 - 66s - loss: 3.1733 - accuracy100: 0.4331 - val_loss: 3.2150 - val_accuracy100: 0.4163 - 66s/epoch - 34ms/step
Epoch 4/50
1972/1972 - 66s - loss: 3.1292 - accuracy100: 0.4517 - val_loss: 3.1820 - val_accuracy100: 0.4273 - 66s/epoch - 34ms/step
Epoch 5/50
1972/1972 - 64s - loss: 3.1020 - accuracy100: 0.4598 - val_loss: 3.1873 - val_accuracy100: 0.4252 - 64s/epoch - 33ms/step
Epoch 6/50
1972/1972 - 64s - loss: 3.0814 - accuracy100: 0.4652 - val_loss: 3.1638 - val_accuracy100: 0.4311 - 64s/epoch - 33ms/step
Epoch 7/50
1972/1972 - 64s - loss: 3.0666 - accuracy100: 0.4691 - val_loss: 3.1633 - val_accuracy100: 0.4290 - 64s/epoch - 33ms/step
Epoch 8/50
1972/1972 - 64s - loss: 3.0565 - accuracy100: 0.4722 - val_loss: 3.1484 - val_accuracy100: 0.4363 - 64s/epoch - 33ms/step
Epoch 9/50
1972/1972 - 64s - loss: 3.0494 - accuracy100: 0.4743 - val_loss: 3.1504 - val_accuracy100: 0.4367 - 64s/epoch - 32ms/step
Epoch 10/50
1972/1972 - 64s - loss: 3.0452 - accuracy100: 0.4753 - val_loss: 3.1588 - val_accuracy100: 0.4342 - 64s/epoch - 32ms/step
Epoch 11/50
1972/1972 - 65s - loss: 3.0389 - accuracy100: 0.4775 - val_loss: 3.1651 - val_accuracy100: 0.4329 - 65s/epoch - 33ms/step
Epoch 12/50
1972/1972 - 64s - loss: 3.0357 - accuracy100: 0.4789 - val_loss: 3.1662 - val_accuracy100: 0.4310 - 64s/epoch - 33ms/step
Epoch 13/50
1972/1972 - 65s - loss: 3.0321 - accuracy100: 0.4802 - val_loss: 3.1734 - val_accuracy100: 0.4322 - 65s/epoch - 33ms/step
Epoch 14/50
1972/1972 - 64s - loss: 3.0275 - accuracy100: 0.4815 - val_loss: 3.1761 - val_accuracy100: 0.4340 - 64s/epoch - 32ms/step
Epoch 15/50
1972/1972 - 64s - loss: 3.0251 - accuracy100: 0.4828 - val_loss: 3.1748 - val_accuracy100: 0.4339 - 64s/epoch - 32ms/step
Epoch 16/50
1972/1972 - 63s - loss: 3.0219 - accuracy100: 0.4830 - val_loss: 3.1763 - val_accuracy100: 0.4332 - 63s/epoch - 32ms/step
Epoch 17/50
1972/1972 - 64s - loss: 3.0190 - accuracy100: 0.4843 - val_loss: 3.1779 - val_accuracy100: 0.4337 - 64s/epoch - 32ms/step
Epoch 18/50
1972/1972 - 64s - loss: 3.0153 - accuracy100: 0.4857 - val_loss: 3.1806 - val_accuracy100: 0.4344 - 64s/epoch - 32ms/step
testing model: results/ATVI/W4/deepVOL_L3/h100
Evaluating performance on  test set...
4274/4274 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0641505
{'0': {'precision': 0.44821368195649725, 'recall': 0.4244512892809364, 'f1-score': 0.436008964379594, 'support': 402899}, '1': {'precision': 0.346014458482535, 'recall': 0.44627321398694997, 'f1-score': 0.38980029562154356, 'support': 286896}, '2': {'precision': 0.45367166811191795, 'recall': 0.38435451554654065, 'f1-score': 0.4161463152693396, 'support': 404270}, 'accuracy': 0.4153574056386046, 'macro avg': {'precision': 0.41596660285031667, 'recall': 0.4183596729381423, 'f1-score': 0.41398519175682574, 'support': 1094065}, 'weighted avg': {'precision': 0.42343083234999856, 'recall': 0.4153574056386046, 'f1-score': 0.41655220871351184, 'support': 1094065}}
[[171011 122403 109485]
 [ 81229 128034  77633]
 [129299 119588 155383]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0338476
{'0': {'precision': 0.46614616870573083, 'recall': 0.34727910532785655, 'f1-score': 0.39802752530025254, 'support': 166765}, '1': {'precision': 0.4419243149665936, 'recall': 0.5881947027974126, 'f1-score': 0.504674773726536, 'support': 166654}, '2': {'precision': 0.46036612290728335, 'recall': 0.42638217818311414, 'f1-score': 0.4427229463096816, 'support': 171161}, 'accuracy': 0.45368227040310755, 'macro avg': {'precision': 0.456145535526536, 'recall': 0.45395199543612774, 'f1-score': 0.4484750817788234, 'support': 504580}, 'weighted avg': {'precision': 0.4561854345665453, 'recall': 0.45368227040310755, 'f1-score': 0.44841260495982826, 'support': 504580}}
[[57914 62855 45996]
 [29079 98025 39550]
 [37247 60934 72980]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0490075
{'0': {'precision': 0.4642990189991308, 'recall': 0.3612036902864319, 'f1-score': 0.40631367328642454, 'support': 62109}, '1': {'precision': 0.41180338648693077, 'recall': 0.5283323959505062, 'f1-score': 0.4628460567240476, 'support': 56896}, '2': {'precision': 0.44281628532974426, 'recall': 0.426257915107937, 'f1-score': 0.43437935786251225, 'support': 61749}, 'accuracy': 0.4360346105756996, 'macro avg': {'precision': 0.4396395636052686, 'recall': 0.4385980004482917, 'f1-score': 0.4345130292909947, 'support': 180754}, 'weighted avg': {'precision': 0.4404360404273422, 'recall': 0.4360346105756996, 'f1-score': 0.4336961624427134, 'support': 180754}}
[[22434 21895 17780]
 [11497 30060 15339]
 [14387 21041 26321]]
training model: results/ATVI/W4/deepVOL_L3/h200
Epoch 1/50
1972/1972 - 69s - loss: 3.2986 - accuracy200: 0.3588 - val_loss: 3.2985 - val_accuracy200: 0.3392 - 69s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 67s - loss: 3.2884 - accuracy200: 0.3614 - val_loss: 3.2964 - val_accuracy200: 0.3488 - 67s/epoch - 34ms/step
Epoch 3/50
1972/1972 - 66s - loss: 3.2698 - accuracy200: 0.3806 - val_loss: 3.3003 - val_accuracy200: 0.3492 - 66s/epoch - 34ms/step
Epoch 4/50
1972/1972 - 66s - loss: 3.2524 - accuracy200: 0.3950 - val_loss: 3.2923 - val_accuracy200: 0.3556 - 66s/epoch - 33ms/step
Epoch 5/50
1972/1972 - 64s - loss: 3.2362 - accuracy200: 0.4048 - val_loss: 3.2980 - val_accuracy200: 0.3577 - 64s/epoch - 32ms/step
Epoch 6/50
1972/1972 - 66s - loss: 3.2244 - accuracy200: 0.4128 - val_loss: 3.2941 - val_accuracy200: 0.3600 - 66s/epoch - 33ms/step
Epoch 7/50
1972/1972 - 66s - loss: 3.2178 - accuracy200: 0.4149 - val_loss: 3.3094 - val_accuracy200: 0.3585 - 66s/epoch - 34ms/step
Epoch 8/50
1972/1972 - 68s - loss: 3.2109 - accuracy200: 0.4189 - val_loss: 3.3055 - val_accuracy200: 0.3616 - 68s/epoch - 34ms/step
Epoch 9/50
1972/1972 - 67s - loss: 3.2023 - accuracy200: 0.4222 - val_loss: 3.3062 - val_accuracy200: 0.3627 - 67s/epoch - 34ms/step
Epoch 10/50
1972/1972 - 67s - loss: 3.1950 - accuracy200: 0.4260 - val_loss: 3.3101 - val_accuracy200: 0.3647 - 67s/epoch - 34ms/step
Epoch 11/50
1972/1972 - 67s - loss: 3.1903 - accuracy200: 0.4284 - val_loss: 3.2981 - val_accuracy200: 0.3669 - 67s/epoch - 34ms/step
Epoch 12/50
1972/1972 - 67s - loss: 3.1834 - accuracy200: 0.4313 - val_loss: 3.3144 - val_accuracy200: 0.3608 - 67s/epoch - 34ms/step
Epoch 13/50
1972/1972 - 69s - loss: 3.1750 - accuracy200: 0.4345 - val_loss: 3.3200 - val_accuracy200: 0.3615 - 69s/epoch - 35ms/step
Epoch 14/50
1972/1972 - 68s - loss: 3.1719 - accuracy200: 0.4350 - val_loss: 3.3147 - val_accuracy200: 0.3632 - 68s/epoch - 35ms/step
testing model: results/ATVI/W4/deepVOL_L3/h200
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979309
{'0': {'precision': 0.36328782458255376, 'recall': 0.484854421171683, 'f1-score': 0.415358882990328, 'support': 382851}, '1': {'precision': 0.3115329726177887, 'recall': 0.18922095941879863, 'f1-score': 0.2354392614735225, 'support': 320715}, '2': {'precision': 0.38138773071544646, 'recall': 0.3792429686119555, 'f1-score': 0.380312325854325, 'support': 390499}, 'accuracy': 0.3604968626178518, 'macro avg': {'precision': 0.352069509305263, 'recall': 0.3511061164008124, 'f1-score': 0.3437034901060585, 'support': 1094065}, 'weighted avg': {'precision': 0.3545766766133827, 'recall': 0.3604968626178518, 'f1-score': 0.3501081283004199, 'support': 1094065}}
[[185627  69873 127351]
 [147171  60686 112858]
 [178166  64239 148094]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910035
{'0': {'precision': 0.3651288343558282, 'recall': 0.4488629850187944, 'f1-score': 0.40268910474138747, 'support': 165741}, '1': {'precision': 0.3719770831239321, 'recall': 0.22171764071533415, 'f1-score': 0.27783262326157543, 'support': 166915}, '2': {'precision': 0.3828052051256581, 'recall': 0.44830273841930157, 'f1-score': 0.4129731235800934, 'support': 171924}, 'accuracy': 0.3735324428237346, 'macro avg': {'precision': 0.3733037075351395, 'recall': 0.37296112138447673, 'f1-score': 0.36449828386101873, 'support': 504580}, 'weighted avg': {'precision': 0.37341704992394487, 'recall': 0.3735324428237346, 'f1-score': 0.3648906387867774, 'support': 504580}}
[[74395 32719 58627]
 [64268 37008 65639]
 [65087 29763 77074]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973732
{'0': {'precision': 0.3566709073747281, 'recall': 0.4322017040745284, 'f1-score': 0.390820448634834, 'support': 60326}, '1': {'precision': 0.3501991232845314, 'recall': 0.20213663199325274, 'f1-score': 0.2563226104097639, 'support': 60469}, '2': {'precision': 0.35620618556701034, 'recall': 0.43219533347787653, 'f1-score': 0.39053869745081343, 'support': 59959}, 'accuracy': 0.35523418568883675, 'macro avg': {'precision': 0.35435873874208995, 'recall': 0.35551122318188594, 'f1-score': 0.34589391883180376, 'support': 180754}, 'weighted avg': {'precision': 0.3543516969173161, 'recall': 0.35523418568883675, 'f1-score': 0.3457324102020776, 'support': 180754}}
[[26073 11928 22325]
 [23735 12223 24511]
 [23293 10752 25914]]
training model: results/ATVI/W4/deepVOL_L3/h300
Epoch 1/50
1972/1972 - 70s - loss: 3.2823 - accuracy300: 0.3717 - val_loss: 3.3199 - val_accuracy300: 0.3176 - 70s/epoch - 35ms/step
Epoch 2/50
1972/1972 - 65s - loss: 3.2784 - accuracy300: 0.3700 - val_loss: 3.3189 - val_accuracy300: 0.3199 - 65s/epoch - 33ms/step
Epoch 3/50
1972/1972 - 64s - loss: 3.2714 - accuracy300: 0.3755 - val_loss: 3.3256 - val_accuracy300: 0.3264 - 64s/epoch - 32ms/step
Epoch 4/50
1972/1972 - 64s - loss: 3.2647 - accuracy300: 0.3817 - val_loss: 3.3204 - val_accuracy300: 0.3307 - 64s/epoch - 33ms/step
Epoch 5/50
1972/1972 - 65s - loss: 3.2643 - accuracy300: 0.3879 - val_loss: 3.3381 - val_accuracy300: 0.3357 - 65s/epoch - 33ms/step
Epoch 6/50
1972/1972 - 66s - loss: 3.2590 - accuracy300: 0.3871 - val_loss: 3.3209 - val_accuracy300: 0.3360 - 66s/epoch - 33ms/step
Epoch 7/50
1972/1972 - 64s - loss: 3.2486 - accuracy300: 0.3956 - val_loss: 3.3069 - val_accuracy300: 0.3364 - 64s/epoch - 32ms/step
Epoch 8/50
1972/1972 - 64s - loss: 3.2413 - accuracy300: 0.4001 - val_loss: 3.2969 - val_accuracy300: 0.3594 - 64s/epoch - 32ms/step
Epoch 9/50
1972/1972 - 64s - loss: 3.2476 - accuracy300: 0.3972 - val_loss: 3.3086 - val_accuracy300: 0.3495 - 64s/epoch - 33ms/step
Epoch 10/50
1972/1972 - 64s - loss: 3.2415 - accuracy300: 0.4019 - val_loss: 3.3043 - val_accuracy300: 0.3497 - 64s/epoch - 32ms/step
Epoch 11/50
1972/1972 - 64s - loss: 3.2371 - accuracy300: 0.4057 - val_loss: 3.3273 - val_accuracy300: 0.3416 - 64s/epoch - 32ms/step
Epoch 12/50
1972/1972 - 65s - loss: 3.2341 - accuracy300: 0.4061 - val_loss: 3.3137 - val_accuracy300: 0.3387 - 65s/epoch - 33ms/step
Epoch 13/50
1972/1972 - 71s - loss: 3.2273 - accuracy300: 0.4107 - val_loss: 3.2962 - val_accuracy300: 0.3487 - 71s/epoch - 36ms/step
Epoch 14/50
1972/1972 - 73s - loss: 3.2208 - accuracy300: 0.4137 - val_loss: 3.3105 - val_accuracy300: 0.3450 - 73s/epoch - 37ms/step
Epoch 15/50
1972/1972 - 67s - loss: 3.2194 - accuracy300: 0.4150 - val_loss: 3.3129 - val_accuracy300: 0.3434 - 67s/epoch - 34ms/step
Epoch 16/50
1972/1972 - 70s - loss: 3.2114 - accuracy300: 0.4181 - val_loss: 3.3171 - val_accuracy300: 0.3405 - 70s/epoch - 36ms/step
Epoch 17/50
1972/1972 - 74s - loss: 3.2056 - accuracy300: 0.4202 - val_loss: 3.3167 - val_accuracy300: 0.3399 - 74s/epoch - 38ms/step
Epoch 18/50
1972/1972 - 74s - loss: 3.1997 - accuracy300: 0.4223 - val_loss: 3.3153 - val_accuracy300: 0.3441 - 74s/epoch - 38ms/step
Epoch 19/50
1972/1972 - 73s - loss: 3.1955 - accuracy300: 0.4251 - val_loss: 3.3230 - val_accuracy300: 0.3485 - 73s/epoch - 37ms/step
Epoch 20/50
1972/1972 - 73s - loss: 3.1899 - accuracy300: 0.4284 - val_loss: 3.3378 - val_accuracy300: 0.3435 - 73s/epoch - 37ms/step
Epoch 21/50
1972/1972 - 73s - loss: 3.1851 - accuracy300: 0.4301 - val_loss: 3.3318 - val_accuracy300: 0.3468 - 73s/epoch - 37ms/step
Epoch 22/50
1972/1972 - 75s - loss: 3.1772 - accuracy300: 0.4330 - val_loss: 3.3502 - val_accuracy300: 0.3456 - 75s/epoch - 38ms/step
Epoch 23/50
1972/1972 - 73s - loss: 3.1718 - accuracy300: 0.4359 - val_loss: 3.3749 - val_accuracy300: 0.3404 - 73s/epoch - 37ms/step
testing model: results/ATVI/W4/deepVOL_L3/h300
Evaluating performance on  test set...
4274/4274 - 63s - 63s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032268
{'0': {'precision': 0.29406206062941376, 'recall': 0.4277697145621674, 'f1-score': 0.34853229814002296, 'support': 299715}, '1': {'precision': 0.5444599774520856, 'recall': 0.12169760160954438, 'f1-score': 0.1989303297326154, 'support': 496041}, '2': {'precision': 0.28270988327786883, 'recall': 0.5185830799607118, 'f1-score': 0.36592998748678307, 'support': 298309}, 'accuracy': 0.313760151362122, 'macro avg': {'precision': 0.3737439737864561, 'recall': 0.3560167987108079, 'f1-score': 0.30446420511980715, 'support': 1094065}, 'weighted avg': {'precision': 0.40449533139949867, 'recall': 0.313760151362122, 'f1-score': 0.28544754293860786, 'support': 1094065}}
[[128209  24482 147024]
 [190199  60367 245475]
 [117585  26026 154698]]
Evaluating performance on  train set...
1972/1972 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907453
{'0': {'precision': 0.37149745942479406, 'recall': 0.3641963740561846, 'f1-score': 0.36781068845833326, 'support': 165419}, '1': {'precision': 0.38640729815131697, 'recall': 0.2211461049494719, 'f1-score': 0.2813002724504106, 'support': 166442}, '2': {'precision': 0.36959397948655703, 'recall': 0.528876383026766, 'f1-score': 0.43511624916046243, 'support': 172719}, 'accuracy': 0.3733798406595584, 'macro avg': {'precision': 0.3758329123542227, 'recall': 0.37140628734414083, 'f1-score': 0.36140907002306877, 'support': 504580}, 'weighted avg': {'precision': 0.3757640895446315, 'recall': 0.3733798406595584, 'f1-score': 0.3623130121289512, 'support': 504580}}
[[60245 29534 75640]
 [49466 36808 80168]
 [52457 28915 91347]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970759
{'0': {'precision': 0.35050408693863044, 'recall': 0.3223359422034919, 'f1-score': 0.33583039122564917, 'support': 58135}, '1': {'precision': 0.4031724488930359, 'recall': 0.21638971090371045, 'f1-score': 0.281625881377022, 'support': 65895}, '2': {'precision': 0.32605195596362213, 'recall': 0.5283830477399337, 'f1-score': 0.4032613960497282, 'support': 56724}, 'accuracy': 0.3483740332164157, 'macro avg': {'precision': 0.3599094972650962, 'recall': 0.35570290028237866, 'f1-score': 0.3402392228841331, 'support': 180754}, 'weighted avg': {'precision': 0.3620311294027484, 'recall': 0.3483740332164157, 'f1-score': 0.33723091426340085, 'support': 180754}}
[[18739 10900 28496]
 [18180 14259 33456]
 [16544 10208 29972]]
training model: results/ATVI/W4/deepVOL_L3/h500
Epoch 1/50
1972/1972 - 72s - loss: 3.2425 - accuracy500: 0.4077 - val_loss: 3.3634 - val_accuracy500: 0.3204 - 72s/epoch - 36ms/step
Epoch 2/50
1972/1972 - 72s - loss: 3.2443 - accuracy500: 0.4054 - val_loss: 3.3699 - val_accuracy500: 0.3182 - 72s/epoch - 36ms/step
Epoch 3/50
1972/1972 - 72s - loss: 3.2307 - accuracy500: 0.4133 - val_loss: 3.3815 - val_accuracy500: 0.3171 - 72s/epoch - 37ms/step
Epoch 4/50
1972/1972 - 72s - loss: 3.2202 - accuracy500: 0.4174 - val_loss: 3.3791 - val_accuracy500: 0.3181 - 72s/epoch - 37ms/step
Epoch 5/50
1972/1972 - 71s - loss: 3.2069 - accuracy500: 0.4227 - val_loss: 3.3770 - val_accuracy500: 0.3178 - 71s/epoch - 36ms/step
Epoch 6/50
1972/1972 - 72s - loss: 3.1901 - accuracy500: 0.4286 - val_loss: 3.3827 - val_accuracy500: 0.3189 - 72s/epoch - 37ms/step
Epoch 7/50
1972/1972 - 72s - loss: 3.1802 - accuracy500: 0.4321 - val_loss: 3.3861 - val_accuracy500: 0.3243 - 72s/epoch - 36ms/step
Epoch 8/50
1972/1972 - 73s - loss: 3.1733 - accuracy500: 0.4359 - val_loss: 3.4136 - val_accuracy500: 0.3217 - 73s/epoch - 37ms/step
Epoch 9/50
1972/1972 - 72s - loss: 3.1658 - accuracy500: 0.4380 - val_loss: 3.4101 - val_accuracy500: 0.3203 - 72s/epoch - 36ms/step
Epoch 10/50
1972/1972 - 68s - loss: 3.1597 - accuracy500: 0.4405 - val_loss: 3.4155 - val_accuracy500: 0.3209 - 68s/epoch - 34ms/step
Epoch 11/50
1972/1972 - 72s - loss: 3.1511 - accuracy500: 0.4447 - val_loss: 3.3960 - val_accuracy500: 0.3241 - 72s/epoch - 36ms/step
testing model: results/ATVI/W4/deepVOL_L3/h500
Evaluating performance on  test set...
4274/4274 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167756
{'0': {'precision': 0.32851968006223714, 'recall': 0.11704634040710264, 'f1-score': 0.17259855795328993, 'support': 346350}, '1': {'precision': 0.3510204081632653, 'recall': 0.0010812931259932808, 'f1-score': 0.0021559450183882053, 'support': 397672}, '2': {'precision': 0.32412802842050215, 'recall': 0.8976697148636025, 'f1-score': 0.47628163736733453, 'support': 350043}, 'accuracy': 0.3246534712288575, 'macro avg': {'precision': 0.3345560388820015, 'recall': 0.3385991161322328, 'f1-score': 0.2170120467796709, 'support': 1094065}, 'weighted avg': {'precision': 0.33529317398605724, 'recall': 0.3246534712288575, 'f1-score': 0.2078084233600822, 'support': 1094065}}
[[ 40539    343 305468]
 [ 47492    430 349750]
 [ 35368    452 314223]]
Evaluating performance on  train set...
1972/1972 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087844
{'0': {'precision': 0.3343227394483458, 'recall': 0.11153175020075956, 'f1-score': 0.16726354058667198, 'support': 165621}, '1': {'precision': 0.35478806907378335, 'recall': 0.001353398767568733, 'f1-score': 0.002696511239440653, 'support': 166987}, '2': {'precision': 0.34236256131725396, 'recall': 0.8932558788640012, 'f1-score': 0.49500292429224874, 'support': 171972}, 'accuracy': 0.34149787942447185, 'macro avg': {'precision': 0.3438244566131277, 'recall': 0.3353803426107765, 'f1-score': 0.2216543253727871, 'support': 504580}, 'weighted avg': {'precision': 0.34383573688106767, 'recall': 0.34149787942447185, 'f1-score': 0.22450212072264514, 'support': 504580}}
[[ 18472    198 146951]
 [ 18636    226 148125]
 [ 18144    213 153615]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1180962
{'0': {'precision': 0.354228624535316, 'recall': 0.12651442227901882, 'f1-score': 0.1864406779661017, 'support': 60254}, '1': {'precision': 0.3803418803418803, 'recall': 0.0014202505385781537, 'f1-score': 0.0028299337032385253, 'support': 62665}, '2': {'precision': 0.3172641509433962, 'recall': 0.8722227025157776, 'f1-score': 0.4652846634537782, 'support': 57835}, 'accuracy': 0.32174668333757483, 'macro avg': {'precision': 0.3506115519401975, 'recall': 0.33338579177779154, 'f1-score': 0.21818509170770617, 'support': 180754}, 'weighted avg': {'precision': 0.35145439461470385, 'recall': 0.32174668333757483, 'f1-score': 0.21200567022877612, 'support': 180754}}
[[ 7623    78 52553]
 [ 6574    89 56002]
 [ 7323    67 50445]]
training model: results/ATVI/W4/deepVOL_L3/h1000
Epoch 1/50
1972/1972 - 70s - loss: 3.2834 - accuracy1000: 0.3843 - val_loss: 3.3623 - val_accuracy1000: 0.3283 - 70s/epoch - 36ms/step
Epoch 2/50
1972/1972 - 67s - loss: 3.2836 - accuracy1000: 0.3725 - val_loss: 3.3385 - val_accuracy1000: 0.3390 - 67s/epoch - 34ms/step
Epoch 3/50
1972/1972 - 68s - loss: 3.2758 - accuracy1000: 0.3808 - val_loss: 3.3403 - val_accuracy1000: 0.3456 - 68s/epoch - 35ms/step
Epoch 4/50
1972/1972 - 68s - loss: 3.2689 - accuracy1000: 0.3850 - val_loss: 3.3470 - val_accuracy1000: 0.3506 - 68s/epoch - 34ms/step
Epoch 5/50
1972/1972 - 67s - loss: 3.2511 - accuracy1000: 0.3976 - val_loss: 3.4266 - val_accuracy1000: 0.3479 - 67s/epoch - 34ms/step
Epoch 6/50
1972/1972 - 67s - loss: 3.2237 - accuracy1000: 0.4153 - val_loss: 3.4808 - val_accuracy1000: 0.3489 - 67s/epoch - 34ms/step
Epoch 7/50
1972/1972 - 67s - loss: 3.1960 - accuracy1000: 0.4305 - val_loss: 3.4992 - val_accuracy1000: 0.3408 - 67s/epoch - 34ms/step
Epoch 8/50
1972/1972 - 67s - loss: 3.1808 - accuracy1000: 0.4348 - val_loss: 3.5272 - val_accuracy1000: 0.3431 - 67s/epoch - 34ms/step
Epoch 9/50
1972/1972 - 67s - loss: 3.1649 - accuracy1000: 0.4412 - val_loss: 3.5563 - val_accuracy1000: 0.3411 - 67s/epoch - 34ms/step
Epoch 10/50
1972/1972 - 68s - loss: 3.1550 - accuracy1000: 0.4453 - val_loss: 3.5480 - val_accuracy1000: 0.3430 - 68s/epoch - 34ms/step
Epoch 11/50
1972/1972 - 67s - loss: 3.1421 - accuracy1000: 0.4498 - val_loss: 3.5722 - val_accuracy1000: 0.3424 - 67s/epoch - 34ms/step
Epoch 12/50
1972/1972 - 67s - loss: 3.1312 - accuracy1000: 0.4539 - val_loss: 3.5835 - val_accuracy1000: 0.3405 - 67s/epoch - 34ms/step
testing model: results/ATVI/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
4274/4274 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060092
{'0': {'precision': 0.3787127865034134, 'recall': 0.3692095082994693, 'f1-score': 0.3739007719471668, 'support': 389302}, '1': {'precision': 0.2995046893317702, 'recall': 0.33064779672752803, 'f1-score': 0.3143066728385284, 'support': 309063}, '2': {'precision': 0.3770450965896307, 'recall': 0.35573161485974225, 'f1-score': 0.36607839465717945, 'support': 395700}, 'accuracy': 0.3534415231270537, 'macro avg': {'precision': 0.35175419080827136, 'recall': 0.35186297329557986, 'f1-score': 0.3514286131476249, 'support': 1094065}, 'weighted avg': {'precision': 0.3557340813670245, 'recall': 0.3534415231270537, 'f1-score': 0.3542368161982295, 'support': 1094065}}
[[143734 111083 134485]
 [108788 102191  98084]
 [127011 127926 140763]]
Evaluating performance on  train set...
1972/1972 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009136
{'0': {'precision': 0.3427561142017424, 'recall': 0.3229189844001088, 'f1-score': 0.332541975890118, 'support': 161796}, '1': {'precision': 0.3683763743878777, 'recall': 0.3739367969377407, 'f1-score': 0.3711357600193157, 'support': 170593}, '2': {'precision': 0.3647614258576377, 'recall': 0.3791429284921976, 'f1-score': 0.37181316224859107, 'support': 172191}, 'accuracy': 0.359354314479369, 'macro avg': {'precision': 0.35863130481575256, 'recall': 0.35866623661001573, 'f1-score': 0.3584969660526749, 'support': 504580}, 'weighted avg': {'precision': 0.3589274917142749, 'recall': 0.359354314479369, 'f1-score': 0.3589916454493634, 'support': 504580}}
[[52247 54080 55469]
 [48576 63791 58226]
 [51609 55297 65285]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101205
{'0': {'precision': 0.3396922523171061, 'recall': 0.29699620788947806, 'f1-score': 0.3169126412464951, 'support': 63553}, '1': {'precision': 0.3476302733893952, 'recall': 0.3460474239080943, 'f1-score': 0.346837042757846, 'support': 57102}, '2': {'precision': 0.32847089118761613, 'recall': 0.373550308657382, 'f1-score': 0.34956324058359156, 'support': 60099}, 'accuracy': 0.3379454949821304, 'macro avg': {'precision': 0.3385978056313725, 'recall': 0.33886464681831807, 'f1-score': 0.33777097486264424, 'support': 180754}, 'weighted avg': {'precision': 0.3384689559958553, 'recall': 0.3379454949821304, 'f1-score': 0.3372220758629424, 'support': 180754}}
[[18875 19158 25520]
 [16965 19760 20377]
 [19725 17924 22450]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        22 (peak)  16.06 (ave)

============================================
