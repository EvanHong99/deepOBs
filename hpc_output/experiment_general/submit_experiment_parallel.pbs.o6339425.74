This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-09.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-01.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-18.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-19.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-27.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-23.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-25.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-26.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-17.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-03.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-02.csv
training model: results/PCAR/W7/deepLOB_L1/h10
Epoch 1/50
526/526 - 23s - loss: 3.3099 - accuracy10: 0.3713 - val_loss: 3.4178 - val_accuracy10: 0.3308 - 23s/epoch - 44ms/step
Epoch 2/50
526/526 - 12s - loss: 3.2567 - accuracy10: 0.3959 - val_loss: 3.3506 - val_accuracy10: 0.3421 - 12s/epoch - 22ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2309 - accuracy10: 0.4096 - val_loss: 3.2685 - val_accuracy10: 0.3781 - 12s/epoch - 23ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2175 - accuracy10: 0.4179 - val_loss: 3.2585 - val_accuracy10: 0.3830 - 12s/epoch - 22ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2099 - accuracy10: 0.4234 - val_loss: 3.2194 - val_accuracy10: 0.4216 - 12s/epoch - 22ms/step
Epoch 6/50
526/526 - 12s - loss: 3.1995 - accuracy10: 0.4262 - val_loss: 3.2113 - val_accuracy10: 0.4237 - 12s/epoch - 22ms/step
Epoch 7/50
526/526 - 12s - loss: 3.1935 - accuracy10: 0.4278 - val_loss: 3.2067 - val_accuracy10: 0.4264 - 12s/epoch - 23ms/step
Epoch 8/50
526/526 - 12s - loss: 3.1873 - accuracy10: 0.4331 - val_loss: 3.2072 - val_accuracy10: 0.4257 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.1849 - accuracy10: 0.4324 - val_loss: 3.2145 - val_accuracy10: 0.4229 - 12s/epoch - 22ms/step
Epoch 10/50
526/526 - 12s - loss: 3.1798 - accuracy10: 0.4356 - val_loss: 3.2165 - val_accuracy10: 0.4138 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.1756 - accuracy10: 0.4368 - val_loss: 3.2185 - val_accuracy10: 0.4193 - 12s/epoch - 22ms/step
Epoch 12/50
526/526 - 12s - loss: 3.1738 - accuracy10: 0.4372 - val_loss: 3.2144 - val_accuracy10: 0.4215 - 12s/epoch - 22ms/step
Epoch 13/50
526/526 - 12s - loss: 3.1704 - accuracy10: 0.4387 - val_loss: 3.2171 - val_accuracy10: 0.4160 - 12s/epoch - 23ms/step
Epoch 14/50
526/526 - 12s - loss: 3.1662 - accuracy10: 0.4410 - val_loss: 3.2278 - val_accuracy10: 0.4150 - 12s/epoch - 22ms/step
Epoch 15/50
526/526 - 12s - loss: 3.1632 - accuracy10: 0.4418 - val_loss: 3.2378 - val_accuracy10: 0.4098 - 12s/epoch - 22ms/step
Epoch 16/50
526/526 - 12s - loss: 3.1614 - accuracy10: 0.4427 - val_loss: 3.2301 - val_accuracy10: 0.4106 - 12s/epoch - 23ms/step
Epoch 17/50
526/526 - 11s - loss: 3.1589 - accuracy10: 0.4443 - val_loss: 3.2490 - val_accuracy10: 0.3976 - 11s/epoch - 22ms/step
testing model: results/PCAR/W7/deepLOB_L1/h10
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0793908
{'0': {'precision': 0.3617338409168731, 'recall': 0.6961068560265434, 'f1-score': 0.4760743417163488, 'support': 128996}, '1': {'precision': 0.48592923808509886, 'recall': 0.16971462212995383, 'f1-score': 0.2515673585243635, 'support': 161365}, '2': {'precision': 0.4192403935145511, 'recall': 0.37366716568390823, 'f1-score': 0.3951440940811579, 'support': 130924}, 'accuracy': 0.3942770333622132, 'macro avg': {'precision': 0.4223011575055076, 'recall': 0.4131628812801352, 'f1-score': 0.3742619314406234, 'support': 421285}, 'weighted avg': {'precision': 0.4271759481752591, 'recall': 0.3942770333622132, 'f1-score': 0.36493038671162653, 'support': 421285}}
[[89795 13324 25877]
 [92086 27386 41893]
 [66354 15648 48922]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746903
{'0': {'precision': 0.4187841697266422, 'recall': 0.5564325519873365, 'f1-score': 0.4778940703218117, 'support': 46117}, '1': {'precision': 0.3923179396092362, 'recall': 0.1653372008701958, 'f1-score': 0.23263391755122192, 'support': 42749}, '2': {'precision': 0.4214323166211647, 'recall': 0.5096645821489483, 'f1-score': 0.4613679324643964, 'support': 45734}, 'accuracy': 0.4163298662704309, 'macro avg': {'precision': 0.4108448086523477, 'recall': 0.4104781116688268, 'f1-score': 0.39063197344580997, 'support': 134600}, 'weighted avg': {'precision': 0.4112782668944364, 'recall': 0.4163298662704309, 'f1-score': 0.39438416943354293, 'support': 134600}}
[[25661  5569 14887]
 [18568  7068 17113]
 [17046  5379 23309]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0695972
{'0': {'precision': 0.4218366631615843, 'recall': 0.5672427336999214, 'f1-score': 0.48385151433931917, 'support': 12730}, '1': {'precision': 0.3846582466567608, 'recall': 0.18014961725817677, 'f1-score': 0.24537914691943133, 'support': 11496}, '2': {'precision': 0.44654765914449307, 'recall': 0.505220638670833, 'f1-score': 0.47407566330544226, 'support': 13121}, 'accuracy': 0.42629930114868664, 'macro avg': {'precision': 0.41768085632094604, 'recall': 0.41753766320964375, 'f1-score': 0.4011021081880643, 'support': 37347}, 'weighted avg': {'precision': 0.4190741896604274, 'recall': 0.42629930114868664, 'f1-score': 0.407011412663829, 'support': 37347}}
[[7221 1604 3905]
 [5114 2071 4311]
 [4783 1709 6629]]
training model: results/PCAR/W7/deepLOB_L1/h20
Epoch 1/50
526/526 - 14s - loss: 3.3229 - accuracy20: 0.3618 - val_loss: 3.3673 - val_accuracy20: 0.3302 - 14s/epoch - 26ms/step
Epoch 2/50
526/526 - 12s - loss: 3.2680 - accuracy20: 0.3869 - val_loss: 3.3471 - val_accuracy20: 0.3232 - 12s/epoch - 22ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2540 - accuracy20: 0.3942 - val_loss: 3.3085 - val_accuracy20: 0.3387 - 12s/epoch - 22ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2406 - accuracy20: 0.4015 - val_loss: 3.2741 - val_accuracy20: 0.3555 - 12s/epoch - 22ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2337 - accuracy20: 0.4072 - val_loss: 3.2677 - val_accuracy20: 0.3625 - 12s/epoch - 22ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2293 - accuracy20: 0.4077 - val_loss: 3.2671 - val_accuracy20: 0.3602 - 12s/epoch - 22ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2255 - accuracy20: 0.4105 - val_loss: 3.2676 - val_accuracy20: 0.3680 - 12s/epoch - 22ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2213 - accuracy20: 0.4127 - val_loss: 3.2694 - val_accuracy20: 0.3598 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2171 - accuracy20: 0.4156 - val_loss: 3.2621 - val_accuracy20: 0.3705 - 12s/epoch - 23ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2144 - accuracy20: 0.4161 - val_loss: 3.2698 - val_accuracy20: 0.3612 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2116 - accuracy20: 0.4172 - val_loss: 3.2585 - val_accuracy20: 0.3814 - 12s/epoch - 22ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2085 - accuracy20: 0.4192 - val_loss: 3.2642 - val_accuracy20: 0.3777 - 12s/epoch - 22ms/step
Epoch 13/50
526/526 - 12s - loss: 3.2054 - accuracy20: 0.4212 - val_loss: 3.2600 - val_accuracy20: 0.3768 - 12s/epoch - 22ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2040 - accuracy20: 0.4209 - val_loss: 3.2690 - val_accuracy20: 0.3636 - 12s/epoch - 23ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2011 - accuracy20: 0.4212 - val_loss: 3.2573 - val_accuracy20: 0.3796 - 12s/epoch - 22ms/step
Epoch 16/50
526/526 - 11s - loss: 3.1965 - accuracy20: 0.4240 - val_loss: 3.2605 - val_accuracy20: 0.3776 - 11s/epoch - 22ms/step
Epoch 17/50
526/526 - 12s - loss: 3.1945 - accuracy20: 0.4258 - val_loss: 3.2588 - val_accuracy20: 0.3813 - 12s/epoch - 23ms/step
Epoch 18/50
526/526 - 12s - loss: 3.1941 - accuracy20: 0.4257 - val_loss: 3.2609 - val_accuracy20: 0.3866 - 12s/epoch - 22ms/step
Epoch 19/50
526/526 - 12s - loss: 3.1908 - accuracy20: 0.4270 - val_loss: 3.2709 - val_accuracy20: 0.3713 - 12s/epoch - 22ms/step
Epoch 20/50
526/526 - 12s - loss: 3.1890 - accuracy20: 0.4272 - val_loss: 3.2596 - val_accuracy20: 0.3818 - 12s/epoch - 22ms/step
Epoch 21/50
526/526 - 12s - loss: 3.1875 - accuracy20: 0.4303 - val_loss: 3.2717 - val_accuracy20: 0.3667 - 12s/epoch - 22ms/step
Epoch 22/50
526/526 - 12s - loss: 3.1853 - accuracy20: 0.4300 - val_loss: 3.2858 - val_accuracy20: 0.3752 - 12s/epoch - 23ms/step
Epoch 23/50
526/526 - 12s - loss: 3.1825 - accuracy20: 0.4312 - val_loss: 3.2795 - val_accuracy20: 0.3697 - 12s/epoch - 23ms/step
Epoch 24/50
526/526 - 12s - loss: 3.1803 - accuracy20: 0.4324 - val_loss: 3.2938 - val_accuracy20: 0.3715 - 12s/epoch - 22ms/step
Epoch 25/50
526/526 - 12s - loss: 3.1776 - accuracy20: 0.4334 - val_loss: 3.2895 - val_accuracy20: 0.3745 - 12s/epoch - 22ms/step
testing model: results/PCAR/W7/deepLOB_L1/h20
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075611
{'0': {'precision': 0.38880445795339413, 'recall': 0.3960546994112542, 'f1-score': 0.3923960911446532, 'support': 127899}, '1': {'precision': 0.4172522332064885, 'recall': 0.3816606914841371, 'f1-score': 0.3986636614010394, 'support': 162896}, '2': {'precision': 0.37922535211267605, 'recall': 0.4126753007893325, 'f1-score': 0.39524386216007934, 'support': 130490}, 'accuracy': 0.3956371577435703, 'macro avg': {'precision': 0.3950940144241863, 'recall': 0.39679689722824124, 'f1-score': 0.3954345382352573, 'support': 421285}, 'weighted avg': {'precision': 0.39683714669491765, 'recall': 0.3956371577435703, 'f1-score': 0.3957016153486653, 'support': 421285}}
[[50655 42722 34522]
 [47097 62171 53628]
 [32532 44108 53850]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0865476
{'0': {'precision': 0.42205777642152376, 'recall': 0.36317286652078773, 'f1-score': 0.390407414377117, 'support': 45700}, '1': {'precision': 0.3438070096366407, 'recall': 0.3677625235318426, 'f1-score': 0.35538152654989963, 'support': 43558}, '2': {'precision': 0.3991537086868106, 'recall': 0.4285651272550836, 'f1-score': 0.41333687848976336, 'support': 45342}, 'accuracy': 0.3866864784546805, 'macro avg': {'precision': 0.38833949824832503, 'recall': 0.3865001724359047, 'f1-score': 0.38637527313892667, 'support': 134600}, 'weighted avg': {'precision': 0.3890194172919301, 'recall': 0.3866864784546805, 'f1-score': 0.38679679134455885, 'support': 134600}}
[[16597 15424 13679]
 [11967 16019 15572]
 [10760 15150 19432]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0860933
{'0': {'precision': 0.41362763915547024, 'recall': 0.3442766994168863, 'f1-score': 0.37577924059462053, 'support': 12519}, '1': {'precision': 0.33963788113347243, 'recall': 0.4257509281133986, 'f1-score': 0.3778501628664495, 'support': 11852}, '2': {'precision': 0.415824357912179, 'recall': 0.3867909987669544, 'f1-score': 0.4007825600894354, 'support': 12976}, 'accuracy': 0.3849037405949608, 'macro avg': {'precision': 0.38969662606704053, 'recall': 0.3856062087657464, 'f1-score': 0.3848039878501685, 'support': 37347}, 'weighted avg': {'precision': 0.3909103662958118, 'recall': 0.3849037405949608, 'f1-score': 0.3851237031894858, 'support': 37347}}
[[4310 4894 3315]
 [3070 5046 3736]
 [3040 4917 5019]]
training model: results/PCAR/W7/deepLOB_L1/h30
Epoch 1/50
526/526 - 14s - loss: 3.3202 - accuracy30: 0.3641 - val_loss: 3.3572 - val_accuracy30: 0.3462 - 14s/epoch - 27ms/step
Epoch 2/50
526/526 - 12s - loss: 3.2847 - accuracy30: 0.3782 - val_loss: 3.3090 - val_accuracy30: 0.3573 - 12s/epoch - 23ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2667 - accuracy30: 0.3875 - val_loss: 3.3367 - val_accuracy30: 0.3558 - 12s/epoch - 23ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2615 - accuracy30: 0.3897 - val_loss: 3.3155 - val_accuracy30: 0.3629 - 12s/epoch - 22ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2537 - accuracy30: 0.3926 - val_loss: 3.3290 - val_accuracy30: 0.3595 - 12s/epoch - 22ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2518 - accuracy30: 0.3950 - val_loss: 3.2754 - val_accuracy30: 0.3836 - 12s/epoch - 23ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2433 - accuracy30: 0.3994 - val_loss: 3.2937 - val_accuracy30: 0.3747 - 12s/epoch - 23ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2382 - accuracy30: 0.4033 - val_loss: 3.2825 - val_accuracy30: 0.3802 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2360 - accuracy30: 0.4046 - val_loss: 3.3012 - val_accuracy30: 0.3717 - 12s/epoch - 23ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2308 - accuracy30: 0.4069 - val_loss: 3.2737 - val_accuracy30: 0.3854 - 12s/epoch - 23ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2272 - accuracy30: 0.4097 - val_loss: 3.2723 - val_accuracy30: 0.3815 - 12s/epoch - 23ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2256 - accuracy30: 0.4101 - val_loss: 3.2658 - val_accuracy30: 0.3896 - 12s/epoch - 22ms/step
Epoch 13/50
526/526 - 12s - loss: 3.2241 - accuracy30: 0.4108 - val_loss: 3.2752 - val_accuracy30: 0.3847 - 12s/epoch - 22ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2224 - accuracy30: 0.4123 - val_loss: 3.2753 - val_accuracy30: 0.3818 - 12s/epoch - 22ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2177 - accuracy30: 0.4138 - val_loss: 3.3001 - val_accuracy30: 0.3737 - 12s/epoch - 22ms/step
Epoch 16/50
526/526 - 12s - loss: 3.2167 - accuracy30: 0.4143 - val_loss: 3.2894 - val_accuracy30: 0.3735 - 12s/epoch - 22ms/step
Epoch 17/50
526/526 - 12s - loss: 3.2142 - accuracy30: 0.4160 - val_loss: 3.3009 - val_accuracy30: 0.3760 - 12s/epoch - 22ms/step
Epoch 18/50
526/526 - 12s - loss: 3.2116 - accuracy30: 0.4174 - val_loss: 3.2842 - val_accuracy30: 0.3813 - 12s/epoch - 22ms/step
Epoch 19/50
526/526 - 12s - loss: 3.2095 - accuracy30: 0.4187 - val_loss: 3.3003 - val_accuracy30: 0.3724 - 12s/epoch - 22ms/step
Epoch 20/50
526/526 - 12s - loss: 3.2088 - accuracy30: 0.4197 - val_loss: 3.2888 - val_accuracy30: 0.3819 - 12s/epoch - 23ms/step
Epoch 21/50
526/526 - 12s - loss: 3.2053 - accuracy30: 0.4213 - val_loss: 3.3125 - val_accuracy30: 0.3698 - 12s/epoch - 23ms/step
Epoch 22/50
526/526 - 13s - loss: 3.2035 - accuracy30: 0.4214 - val_loss: 3.3151 - val_accuracy30: 0.3679 - 13s/epoch - 25ms/step
testing model: results/PCAR/W7/deepLOB_L1/h30
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1045624
{'0': {'precision': 0.29184368965125523, 'recall': 0.4666170220494751, 'f1-score': 0.3590937045734094, 'support': 110116}, '1': {'precision': 0.49675963647759325, 'recall': 0.20267685446585657, 'f1-score': 0.28789370257498104, 'support': 195528}, '2': {'precision': 0.3009247506799637, 'recall': 0.43053934158300255, 'f1-score': 0.3542482683543763, 'support': 115641}, 'accuracy': 0.33421318110068005, 'macro avg': {'precision': 0.36317602560293744, 'recall': 0.36661107269944476, 'f1-score': 0.3337452251675889, 'support': 421285}, 'weighted avg': {'precision': 0.3894425793090429, 'recall': 0.33421318110068005, 'f1-score': 0.3247181035419131, 'support': 421285}}
[[51382 19757 38977]
 [79214 39629 76685]
 [45464 20389 49788]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0905354
{'0': {'precision': 0.38384975954221706, 'recall': 0.5573429973041057, 'f1-score': 0.45460608136118674, 'support': 45254}, '1': {'precision': 0.38159658744667885, 'recall': 0.07052596013064534, 'f1-score': 0.11904942965779468, 'support': 44395}, '2': {'precision': 0.3860464349860761, 'recall': 0.5211897399390447, 'f1-score': 0.4435525095136221, 'support': 44951}, 'accuracy': 0.384702823179792, 'macro avg': {'precision': 0.3838309273249907, 'recall': 0.3830195657912652, 'f1-score': 0.3390693401775345, 'support': 134600}, 'weighted avg': {'precision': 0.38384019923534846, 'recall': 0.384702823179792, 'f1-score': 0.3402382755625837, 'support': 134600}}
[[25222  2609 17423]
 [21428  3131 19836]
 [19058  2465 23428]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0872611
{'0': {'precision': 0.37636124671423205, 'recall': 0.6530911460454508, 'f1-score': 0.4775319377028677, 'support': 12277}, '1': {'precision': 0.44776119402985076, 'recall': 0.0899732511955905, 'f1-score': 0.14983801295896332, 'support': 12337}, '2': {'precision': 0.40592745502801536, 'recall': 0.4324196968507029, 'f1-score': 0.41875499106361946, 'support': 12733}, 'accuracy': 0.39183870190376735, 'macro avg': {'precision': 0.41001663192403276, 'recall': 0.3918280313639147, 'f1-score': 0.3487083139084835, 'support': 37347}, 'weighted avg': {'precision': 0.4100273425316254, 'recall': 0.39183870190376735, 'f1-score': 0.3492440749261227, 'support': 37347}}
[[8018  700 3559]
 [6728 1110 4499]
 [6558  669 5506]]
training model: results/PCAR/W7/deepLOB_L1/h50
Epoch 1/50
526/526 - 14s - loss: 3.3296 - accuracy50: 0.3538 - val_loss: 3.3883 - val_accuracy50: 0.3338 - 14s/epoch - 27ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3013 - accuracy50: 0.3610 - val_loss: 3.3414 - val_accuracy50: 0.3326 - 12s/epoch - 23ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2873 - accuracy50: 0.3664 - val_loss: 3.3236 - val_accuracy50: 0.3337 - 12s/epoch - 22ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2772 - accuracy50: 0.3739 - val_loss: 3.3142 - val_accuracy50: 0.3383 - 12s/epoch - 22ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2722 - accuracy50: 0.3776 - val_loss: 3.3203 - val_accuracy50: 0.3333 - 12s/epoch - 22ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2672 - accuracy50: 0.3812 - val_loss: 3.3188 - val_accuracy50: 0.3399 - 12s/epoch - 22ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2639 - accuracy50: 0.3846 - val_loss: 3.3373 - val_accuracy50: 0.3343 - 12s/epoch - 22ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2600 - accuracy50: 0.3867 - val_loss: 3.3340 - val_accuracy50: 0.3321 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2574 - accuracy50: 0.3877 - val_loss: 3.3261 - val_accuracy50: 0.3344 - 12s/epoch - 22ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2556 - accuracy50: 0.3892 - val_loss: 3.3219 - val_accuracy50: 0.3385 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2534 - accuracy50: 0.3898 - val_loss: 3.3274 - val_accuracy50: 0.3368 - 12s/epoch - 23ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2517 - accuracy50: 0.3914 - val_loss: 3.3110 - val_accuracy50: 0.3431 - 12s/epoch - 23ms/step
Epoch 13/50
526/526 - 11s - loss: 3.2477 - accuracy50: 0.3949 - val_loss: 3.3208 - val_accuracy50: 0.3326 - 11s/epoch - 22ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2458 - accuracy50: 0.3963 - val_loss: 3.3252 - val_accuracy50: 0.3364 - 12s/epoch - 23ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2441 - accuracy50: 0.3966 - val_loss: 3.3368 - val_accuracy50: 0.3315 - 12s/epoch - 22ms/step
Epoch 16/50
526/526 - 12s - loss: 3.2423 - accuracy50: 0.3980 - val_loss: 3.3106 - val_accuracy50: 0.3405 - 12s/epoch - 22ms/step
Epoch 17/50
526/526 - 12s - loss: 3.2380 - accuracy50: 0.4015 - val_loss: 3.3149 - val_accuracy50: 0.3465 - 12s/epoch - 22ms/step
Epoch 18/50
526/526 - 12s - loss: 3.2369 - accuracy50: 0.4013 - val_loss: 3.3304 - val_accuracy50: 0.3393 - 12s/epoch - 22ms/step
Epoch 19/50
526/526 - 12s - loss: 3.2364 - accuracy50: 0.4010 - val_loss: 3.3463 - val_accuracy50: 0.3332 - 12s/epoch - 22ms/step
Epoch 20/50
526/526 - 12s - loss: 3.2337 - accuracy50: 0.4042 - val_loss: 3.3280 - val_accuracy50: 0.3394 - 12s/epoch - 22ms/step
Epoch 21/50
526/526 - 12s - loss: 3.2321 - accuracy50: 0.4050 - val_loss: 3.3358 - val_accuracy50: 0.3328 - 12s/epoch - 23ms/step
Epoch 22/50
526/526 - 12s - loss: 3.2297 - accuracy50: 0.4047 - val_loss: 3.3237 - val_accuracy50: 0.3452 - 12s/epoch - 22ms/step
Epoch 23/50
526/526 - 12s - loss: 3.2278 - accuracy50: 0.4066 - val_loss: 3.3359 - val_accuracy50: 0.3311 - 12s/epoch - 22ms/step
Epoch 24/50
526/526 - 12s - loss: 3.2263 - accuracy50: 0.4068 - val_loss: 3.3383 - val_accuracy50: 0.3349 - 12s/epoch - 22ms/step
Epoch 25/50
526/526 - 12s - loss: 3.2263 - accuracy50: 0.4055 - val_loss: 3.3345 - val_accuracy50: 0.3356 - 12s/epoch - 22ms/step
Epoch 26/50
526/526 - 12s - loss: 3.2231 - accuracy50: 0.4099 - val_loss: 3.3515 - val_accuracy50: 0.3369 - 12s/epoch - 22ms/step
testing model: results/PCAR/W7/deepLOB_L1/h50
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1175419
{'0': {'precision': 0.2775024675111038, 'recall': 0.2213084510622248, 'f1-score': 0.24624016421484776, 'support': 121961}, '1': {'precision': 0.3887569885884966, 'recall': 0.5657535050155452, 'f1-score': 0.46084486313561246, 'support': 170470}, '2': {'precision': 0.2852063525507651, 'recall': 0.1680817048752852, 'f1-score': 0.21151216844407986, 'support': 128854}, 'accuracy': 0.34440580604578847, 'macro avg': {'precision': 0.31715526955012185, 'recall': 0.31838122031768507, 'f1-score': 0.3061990652648467, 'support': 421285}, 'weighted avg': {'precision': 0.3248771298203806, 'recall': 0.34440580604578847, 'f1-score': 0.3224565542073142, 'support': 421285}}
[[26991 73396 21574]
 [41320 96444 32706]
 [28953 78243 21658]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046016
{'0': {'precision': 0.3707995097018895, 'recall': 0.35302536550995245, 'f1-score': 0.36169420788449613, 'support': 45416}, '1': {'precision': 0.3485145477168522, 'recall': 0.46072555205047316, 'f1-score': 0.39684033809158753, 'support': 44380}, '2': {'precision': 0.350972715037318, 'recall': 0.25609320596375323, 'f1-score': 0.2961185093424177, 'support': 44804}, 'accuracy': 0.3562704309063893, 'macro avg': {'precision': 0.3567622574853533, 'recall': 0.356614707841393, 'f1-score': 0.3515510184395005, 'support': 134600}, 'weighted avg': {'precision': 0.356852063037347, 'recall': 0.3562704309063893, 'f1-score': 0.3514544728258887, 'support': 134600}}
[[16033 18680 10703]
 [13418 20447 10515]
 [13788 19542 11474]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104149
{'0': {'precision': 0.3709798055347794, 'recall': 0.1633863131021988, 'f1-score': 0.22685952775713228, 'support': 12143}, '1': {'precision': 0.34320621991854866, 'recall': 0.7370011130545396, 'f1-score': 0.4683237344649893, 'support': 12578}, '2': {'precision': 0.3251152535578272, 'recall': 0.12846507207349914, 'f1-score': 0.1841612262276469, 'support': 12626}, 'accuracy': 0.344766647923528, 'macro avg': {'precision': 0.3464337596703851, 'recall': 0.34295083274341254, 'f1-score': 0.2931148294832562, 'support': 37347}, 'weighted avg': {'precision': 0.34612045958619053, 'recall': 0.344766647923528, 'f1-score': 0.2937465076179014, 'support': 37347}}
[[1984 8469 1690]
 [1631 9270 1677]
 [1733 9271 1622]]
training model: results/PCAR/W7/deepLOB_L1/h100
Epoch 1/50
526/526 - 14s - loss: 3.3323 - accuracy100: 0.3554 - val_loss: 3.3964 - val_accuracy100: 0.3331 - 14s/epoch - 26ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3043 - accuracy100: 0.3613 - val_loss: 3.3373 - val_accuracy100: 0.3387 - 12s/epoch - 22ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2910 - accuracy100: 0.3691 - val_loss: 3.3291 - val_accuracy100: 0.3356 - 12s/epoch - 23ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2853 - accuracy100: 0.3699 - val_loss: 3.3075 - val_accuracy100: 0.3410 - 12s/epoch - 22ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2789 - accuracy100: 0.3756 - val_loss: 3.3054 - val_accuracy100: 0.3368 - 12s/epoch - 22ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2724 - accuracy100: 0.3792 - val_loss: 3.3146 - val_accuracy100: 0.3478 - 12s/epoch - 22ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2677 - accuracy100: 0.3852 - val_loss: 3.3057 - val_accuracy100: 0.3482 - 11s/epoch - 22ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2639 - accuracy100: 0.3874 - val_loss: 3.3188 - val_accuracy100: 0.3482 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2608 - accuracy100: 0.3897 - val_loss: 3.3265 - val_accuracy100: 0.3452 - 12s/epoch - 22ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2570 - accuracy100: 0.3929 - val_loss: 3.3193 - val_accuracy100: 0.3367 - 11s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2548 - accuracy100: 0.3928 - val_loss: 3.3252 - val_accuracy100: 0.3434 - 12s/epoch - 22ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2527 - accuracy100: 0.3948 - val_loss: 3.3116 - val_accuracy100: 0.3476 - 12s/epoch - 22ms/step
Epoch 13/50
526/526 - 12s - loss: 3.2508 - accuracy100: 0.3982 - val_loss: 3.3091 - val_accuracy100: 0.3457 - 12s/epoch - 22ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2471 - accuracy100: 0.4005 - val_loss: 3.3112 - val_accuracy100: 0.3462 - 12s/epoch - 23ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2448 - accuracy100: 0.4009 - val_loss: 3.3233 - val_accuracy100: 0.3456 - 12s/epoch - 23ms/step
testing model: results/PCAR/W7/deepLOB_L1/h100
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0927076
{'0': {'precision': 0.2642104226184612, 'recall': 0.14534090806455982, 'f1-score': 0.18752512745812086, 'support': 110719}, '1': {'precision': 0.45837633949559853, 'recall': 0.4487989417989418, 'f1-score': 0.45353708451521313, 'support': 189000}, '2': {'precision': 0.31026419054572, 'recall': 0.44747709063389435, 'f1-score': 0.36644728421591544, 'support': 121566}, 'accuracy': 0.36866491804835205, 'macro avg': {'precision': 0.34428365088659324, 'recall': 0.34720564683246535, 'f1-score': 0.3358364987297498, 'support': 421285}, 'weighted avg': {'precision': 0.3646078510614964, 'recall': 0.36866491804835205, 'f1-score': 0.35849516150207805, 'support': 421285}}
[[16092 49729 44898]
 [28145 84823 76032]
 [16669 50499 54398]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007338
{'0': {'precision': 0.3494551153551773, 'recall': 0.21366969001403963, 'f1-score': 0.26519153644032634, 'support': 44873}, '1': {'precision': 0.359980382540461, 'recall': 0.2781914656440897, 'f1-score': 0.3138448382106971, 'support': 44854}, '2': {'precision': 0.3494758620689655, 'recall': 0.5646379782942973, 'f1-score': 0.4317347260443203, 'support': 44873}, 'accuracy': 0.35217682020802377, 'macro avg': {'precision': 0.3529704533215346, 'recall': 0.3521663779841422, 'f1-score': 0.33692370023178125, 'support': 134600}, 'weighted avg': {'precision': 0.35296946380700894, 'recall': 0.35217682020802377, 'f1-score': 0.3369269580206253, 'support': 134600}}
[[ 9588 11527 23758]
 [ 8971 12478 23405]
 [ 8878 10658 25337]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1029378
{'0': {'precision': 0.3211246762856086, 'recall': 0.14172585517185077, 'f1-score': 0.1966581704899462, 'support': 12249}, '1': {'precision': 0.32727396052363833, 'recall': 0.3932675849702502, 'f1-score': 0.3572486302384125, 'support': 12269}, '2': {'precision': 0.35027328759158044, 'recall': 0.46956115051835684, 'f1-score': 0.40123888500349686, 'support': 12829}, 'accuracy': 0.33697485741826655, 'macro avg': {'precision': 0.3328906414669424, 'recall': 0.3348515302201526, 'f1-score': 0.3183818952439519, 'support': 37347}, 'weighted avg': {'precision': 0.33315758663344647, 'recall': 0.33697485741826655, 'f1-score': 0.31968948055898183, 'support': 37347}}
[[1736 4943 5570]
 [1840 4825 5604]
 [1830 4975 6024]]
training model: results/PCAR/W7/deepLOB_L1/h200
Epoch 1/50
526/526 - 14s - loss: 3.3388 - accuracy200: 0.3530 - val_loss: 3.3554 - val_accuracy200: 0.3301 - 14s/epoch - 27ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3099 - accuracy200: 0.3560 - val_loss: 3.3440 - val_accuracy200: 0.3231 - 12s/epoch - 23ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2975 - accuracy200: 0.3561 - val_loss: 3.3219 - val_accuracy200: 0.3307 - 12s/epoch - 23ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2892 - accuracy200: 0.3629 - val_loss: 3.3204 - val_accuracy200: 0.3273 - 12s/epoch - 23ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2837 - accuracy200: 0.3689 - val_loss: 3.3191 - val_accuracy200: 0.3309 - 12s/epoch - 23ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2776 - accuracy200: 0.3745 - val_loss: 3.3124 - val_accuracy200: 0.3340 - 12s/epoch - 22ms/step
Epoch 7/50
526/526 - 13s - loss: 3.2754 - accuracy200: 0.3776 - val_loss: 3.3183 - val_accuracy200: 0.3322 - 13s/epoch - 24ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2707 - accuracy200: 0.3811 - val_loss: 3.3240 - val_accuracy200: 0.3289 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2646 - accuracy200: 0.3875 - val_loss: 3.3309 - val_accuracy200: 0.3279 - 12s/epoch - 22ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2621 - accuracy200: 0.3890 - val_loss: 3.3183 - val_accuracy200: 0.3323 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2585 - accuracy200: 0.3909 - val_loss: 3.3207 - val_accuracy200: 0.3401 - 12s/epoch - 22ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2579 - accuracy200: 0.3934 - val_loss: 3.3368 - val_accuracy200: 0.3311 - 12s/epoch - 23ms/step
Epoch 13/50
526/526 - 12s - loss: 3.2517 - accuracy200: 0.3954 - val_loss: 3.3342 - val_accuracy200: 0.3318 - 12s/epoch - 23ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2489 - accuracy200: 0.3988 - val_loss: 3.3309 - val_accuracy200: 0.3330 - 12s/epoch - 23ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2458 - accuracy200: 0.3994 - val_loss: 3.3337 - val_accuracy200: 0.3305 - 12s/epoch - 23ms/step
Epoch 16/50
526/526 - 12s - loss: 3.2461 - accuracy200: 0.3999 - val_loss: 3.3277 - val_accuracy200: 0.3367 - 12s/epoch - 23ms/step
testing model: results/PCAR/W7/deepLOB_L1/h200
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138834
{'0': {'precision': 0.2694866478942971, 'recall': 0.15654659188955997, 'f1-score': 0.19804659518584633, 'support': 111264}, '1': {'precision': 0.4372697770032662, 'recall': 0.22570289777011743, 'f1-score': 0.297728879431314, 'support': 185660}, '2': {'precision': 0.2911816578483245, 'recall': 0.6106898464952839, 'f1-score': 0.3943392846479966, 'support': 124361}, 'accuracy': 0.32108430160105395, 'macro avg': {'precision': 0.3326460275819626, 'recall': 0.33097977871832046, 'f1-score': 0.2967049197550523, 'support': 421285}, 'weighted avg': {'precision': 0.34983280045910237, 'recall': 0.32108430160105395, 'f1-score': 0.29992102234849394, 'support': 421285}}
[[ 17418  25150  68696]
 [ 27578  41904 116178]
 [ 19638  28777  75946]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103649
{'0': {'precision': 0.34307012700165657, 'recall': 0.13681707075378213, 'f1-score': 0.19562034602729808, 'support': 45411}, '1': {'precision': 0.34191176470588236, 'recall': 0.4564494605658969, 'f1-score': 0.39096447978922283, 'support': 44213}, '2': {'precision': 0.33920927156927577, 'recall': 0.433408929206688, 'f1-score': 0.38056656449503135, 'support': 44976}, 'accuracy': 0.34091381872213966, 'macro avg': {'precision': 0.3413970544256049, 'recall': 0.342225153508789, 'f1-score': 0.32238379677051743, 'support': 134600}, 'weighted avg': {'precision': 0.34139954374675446, 'recall': 0.34091381872213966, 'f1-score': 0.3215853631730689, 'support': 134600}}
[[ 6213 19358 19840]
 [ 5899 20181 18133]
 [ 5998 19485 19493]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042081
{'0': {'precision': 0.3058252427184466, 'recall': 0.11273966766084363, 'f1-score': 0.16474690243446857, 'support': 11735}, '1': {'precision': 0.33994169096209914, 'recall': 0.4414994320333207, 'f1-score': 0.38412123208697085, 'support': 13205}, '2': {'precision': 0.3232310503433936, 'recall': 0.41347626339969373, 'f1-score': 0.36282622533418213, 'support': 12407}, 'accuracy': 0.3288885318767237, 'macro avg': {'precision': 0.32299932800797976, 'recall': 0.32257178769795264, 'f1-score': 0.3038981199518738, 'support': 37347}, 'weighted avg': {'precision': 0.3236703589060962, 'recall': 0.3288885318767237, 'f1-score': 0.3081160668192395, 'support': 37347}}
[[1323 5495 4917]
 [1551 5830 5824]
 [1452 5825 5130]]
training model: results/PCAR/W7/deepLOB_L1/h300
Epoch 1/50
526/526 - 15s - loss: 3.3375 - accuracy300: 0.3552 - val_loss: 3.4509 - val_accuracy300: 0.3425 - 15s/epoch - 29ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3133 - accuracy300: 0.3599 - val_loss: 3.3539 - val_accuracy300: 0.3487 - 12s/epoch - 24ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2972 - accuracy300: 0.3607 - val_loss: 3.3132 - val_accuracy300: 0.3417 - 12s/epoch - 24ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2888 - accuracy300: 0.3658 - val_loss: 3.3169 - val_accuracy300: 0.3393 - 12s/epoch - 23ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2789 - accuracy300: 0.3749 - val_loss: 3.3029 - val_accuracy300: 0.3496 - 12s/epoch - 23ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2687 - accuracy300: 0.3813 - val_loss: 3.2983 - val_accuracy300: 0.3453 - 12s/epoch - 23ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2628 - accuracy300: 0.3887 - val_loss: 3.3032 - val_accuracy300: 0.3462 - 12s/epoch - 23ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2574 - accuracy300: 0.3927 - val_loss: 3.3049 - val_accuracy300: 0.3461 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2535 - accuracy300: 0.3959 - val_loss: 3.3074 - val_accuracy300: 0.3443 - 12s/epoch - 23ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2561 - accuracy300: 0.3935 - val_loss: 3.3088 - val_accuracy300: 0.3515 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2481 - accuracy300: 0.3981 - val_loss: 3.3056 - val_accuracy300: 0.3495 - 12s/epoch - 23ms/step
Epoch 12/50
526/526 - 12s - loss: 3.2440 - accuracy300: 0.4021 - val_loss: 3.3322 - val_accuracy300: 0.3468 - 12s/epoch - 23ms/step
Epoch 13/50
526/526 - 12s - loss: 3.2393 - accuracy300: 0.4045 - val_loss: 3.3244 - val_accuracy300: 0.3524 - 12s/epoch - 23ms/step
Epoch 14/50
526/526 - 12s - loss: 3.2345 - accuracy300: 0.4089 - val_loss: 3.3401 - val_accuracy300: 0.3504 - 12s/epoch - 23ms/step
Epoch 15/50
526/526 - 12s - loss: 3.2302 - accuracy300: 0.4113 - val_loss: 3.3363 - val_accuracy300: 0.3480 - 12s/epoch - 22ms/step
Epoch 16/50
526/526 - 12s - loss: 3.2270 - accuracy300: 0.4110 - val_loss: 3.3697 - val_accuracy300: 0.3502 - 12s/epoch - 22ms/step
testing model: results/PCAR/W7/deepLOB_L1/h300
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970087
{'0': {'precision': 0.2677869575679795, 'recall': 0.11907479402218497, 'f1-score': 0.1648479162551847, 'support': 112148}, '1': {'precision': 0.42429422820820384, 'recall': 0.4998970672512505, 'f1-score': 0.45900332836930335, 'support': 179729}, '2': {'precision': 0.3030695903246212, 'recall': 0.3739258778437191, 'f1-score': 0.33478972294003895, 'support': 129408}, 'accuracy': 0.35982529641454125, 'macro avg': {'precision': 0.3317169253669348, 'recall': 0.33096591303905154, 'f1-score': 0.31954698918817565, 'support': 421285}, 'weighted avg': {'precision': 0.3453941597818451, 'recall': 0.35982529641454125, 'f1-score': 0.3425425585598764, 'support': 421285}}
[[13354 56072 42722]
 [21331 89846 68552]
 [15183 65836 48389]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128827
{'0': {'precision': 0.33965672990063234, 'recall': 0.09940296534555308, 'f1-score': 0.15379633574776308, 'support': 45391}, '1': {'precision': 0.33392223057950987, 'recall': 0.42960662525879917, 'f1-score': 0.37576890901038335, 'support': 44436}, '2': {'precision': 0.3315042012876674, 'recall': 0.4749514216157059, 'f1-score': 0.39047006977598236, 'support': 44773}, 'accuracy': 0.3333358098068351, 'macro avg': {'precision': 0.33502772058926983, 'recall': 0.3346536707400194, 'f1-score': 0.30667843817804297, 'support': 134600}, 'weighted avg': {'precision': 0.33505174197030785, 'recall': 0.3333358098068351, 'f1-score': 0.30580351523619737, 'support': 134600}}
[[ 4512 19134 21745]
 [ 4209 19090 21137]
 [ 4563 18945 21265]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002815
{'0': {'precision': 0.31348887101099493, 'recall': 0.1007324429125377, 'f1-score': 0.15247163166818836, 'support': 11605}, '1': {'precision': 0.35155188038060714, 'recall': 0.4651180217309854, 'f1-score': 0.40043869552595074, 'support': 13345}, '2': {'precision': 0.33241448440045107, 'recall': 0.4280067758328628, 'f1-score': 0.37420219330723936, 'support': 12397}, 'accuracy': 0.33957212092002037, 'macro avg': {'precision': 0.33248507859735105, 'recall': 0.33128574682546197, 'f1-score': 0.30903750683379283, 'support': 37347}, 'weighted avg': {'precision': 0.3333719055044365, 'recall': 0.33957212092002037, 'f1-score': 0.3146778126150155, 'support': 37347}}
[[1169 5569 4867]
 [1349 6207 5789]
 [1211 5880 5306]]
training model: results/PCAR/W7/deepLOB_L1/h500
Epoch 1/50
526/526 - 14s - loss: 3.3444 - accuracy500: 0.3553 - val_loss: 3.4543 - val_accuracy500: 0.3231 - 14s/epoch - 27ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3135 - accuracy500: 0.3551 - val_loss: 3.3208 - val_accuracy500: 0.3387 - 12s/epoch - 23ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2936 - accuracy500: 0.3614 - val_loss: 3.3328 - val_accuracy500: 0.3237 - 12s/epoch - 22ms/step
Epoch 4/50
526/526 - 12s - loss: 3.2775 - accuracy500: 0.3759 - val_loss: 3.3402 - val_accuracy500: 0.3185 - 12s/epoch - 23ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2677 - accuracy500: 0.3820 - val_loss: 3.3851 - val_accuracy500: 0.3262 - 12s/epoch - 23ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2548 - accuracy500: 0.3921 - val_loss: 3.3390 - val_accuracy500: 0.3324 - 12s/epoch - 23ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2457 - accuracy500: 0.3980 - val_loss: 3.3450 - val_accuracy500: 0.3242 - 12s/epoch - 23ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2389 - accuracy500: 0.4007 - val_loss: 3.4455 - val_accuracy500: 0.3169 - 12s/epoch - 23ms/step
Epoch 9/50
526/526 - 12s - loss: 3.2287 - accuracy500: 0.4088 - val_loss: 3.3686 - val_accuracy500: 0.3300 - 12s/epoch - 24ms/step
Epoch 10/50
526/526 - 12s - loss: 3.2255 - accuracy500: 0.4092 - val_loss: 3.4306 - val_accuracy500: 0.3185 - 12s/epoch - 23ms/step
Epoch 11/50
526/526 - 12s - loss: 3.2186 - accuracy500: 0.4135 - val_loss: 3.8162 - val_accuracy500: 0.3132 - 12s/epoch - 24ms/step
Epoch 12/50
526/526 - 13s - loss: 3.2133 - accuracy500: 0.4164 - val_loss: 3.4407 - val_accuracy500: 0.3158 - 13s/epoch - 24ms/step
testing model: results/PCAR/W7/deepLOB_L1/h500
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108319
{'0': {'precision': 0.2683087670478427, 'recall': 0.33014998305779963, 'f1-score': 0.2960342208363317, 'support': 112146}, '1': {'precision': 0.4371985447841046, 'recall': 0.29613255356276724, 'f1-score': 0.3530975892682051, 'support': 179369}, '2': {'precision': 0.30625413326575895, 'recall': 0.3818370964013254, 'f1-score': 0.33989443249750484, 'support': 129770}, 'accuracy': 0.3315878799387588, 'macro avg': {'precision': 0.33725381503256874, 'recall': 0.3360398776739641, 'f1-score': 0.3296754142006805, 'support': 421285}, 'weighted avg': {'precision': 0.3519048141819076, 'recall': 0.3315878799387588, 'f1-score': 0.33384031172380013, 'support': 421285}}
[[37025 31826 43295]
 [57301 53117 68951]
 [43668 36551 49551]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107772
{'0': {'precision': 0.3428599781681056, 'recall': 0.152680189137832, 'f1-score': 0.21127621843086897, 'support': 45258}, '1': {'precision': 0.3433796950183133, 'recall': 0.3222791408286151, 'f1-score': 0.33249498730890925, 'support': 44508}, '2': {'precision': 0.33529646498699656, 'recall': 0.5434937770442075, 'f1-score': 0.4147327393261678, 'support': 44834}, 'accuracy': 0.3389375928677563, 'macro avg': {'precision': 0.3405120460578051, 'recall': 0.33948436900355156, 'f1-score': 0.31950131502198204, 'support': 134600}, 'weighted avg': {'precision': 0.34051249679817397, 'recall': 0.3389375928677563, 'f1-score': 0.3191289273687861, 'support': 134600}}
[[ 6910 13777 24571]
 [ 6429 14344 23735]
 [ 6815 13652 24367]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067938
{'0': {'precision': 0.3091703056768559, 'recall': 0.18746690203000882, 'f1-score': 0.23340659340659342, 'support': 11330}, '1': {'precision': 0.3554300062774639, 'recall': 0.4186940767581158, 'f1-score': 0.38447696329745695, 'support': 13523}, '2': {'precision': 0.3345019591668385, 'recall': 0.38946694413318395, 'f1-score': 0.3598979327687585, 'support': 12494}, 'accuracy': 0.3387688435483439, 'macro avg': {'precision': 0.33303409037371945, 'recall': 0.33187597430710286, 'f1-score': 0.32592716315760295, 'support': 37347}, 'weighted avg': {'precision': 0.33439491836129814, 'recall': 0.3387688435483439, 'f1-score': 0.3304239550695125, 'support': 37347}}
[[2124 4790 4416]
 [2596 5662 5265]
 [2150 5478 4866]]
training model: results/PCAR/W7/deepLOB_L1/h1000
Epoch 1/50
526/526 - 14s - loss: 3.3460 - accuracy1000: 0.3594 - val_loss: 3.3688 - val_accuracy1000: 0.3410 - 14s/epoch - 26ms/step
Epoch 2/50
526/526 - 12s - loss: 3.3037 - accuracy1000: 0.3696 - val_loss: 3.3781 - val_accuracy1000: 0.3156 - 12s/epoch - 23ms/step
Epoch 3/50
526/526 - 12s - loss: 3.2926 - accuracy1000: 0.3695 - val_loss: 3.3763 - val_accuracy1000: 0.3167 - 12s/epoch - 23ms/step
Epoch 4/50
526/526 - 13s - loss: 3.2838 - accuracy1000: 0.3714 - val_loss: 3.3382 - val_accuracy1000: 0.3402 - 13s/epoch - 24ms/step
Epoch 5/50
526/526 - 12s - loss: 3.2647 - accuracy1000: 0.3871 - val_loss: 3.3290 - val_accuracy1000: 0.3501 - 12s/epoch - 23ms/step
Epoch 6/50
526/526 - 12s - loss: 3.2472 - accuracy1000: 0.3957 - val_loss: 3.3214 - val_accuracy1000: 0.3443 - 12s/epoch - 23ms/step
Epoch 7/50
526/526 - 12s - loss: 3.2278 - accuracy1000: 0.4077 - val_loss: 3.3267 - val_accuracy1000: 0.3477 - 12s/epoch - 23ms/step
Epoch 8/50
526/526 - 12s - loss: 3.2105 - accuracy1000: 0.4125 - val_loss: 3.3456 - val_accuracy1000: 0.3366 - 12s/epoch - 22ms/step
Epoch 9/50
526/526 - 12s - loss: 3.1930 - accuracy1000: 0.4233 - val_loss: 3.3396 - val_accuracy1000: 0.3426 - 12s/epoch - 22ms/step
Epoch 10/50
526/526 - 12s - loss: 3.1808 - accuracy1000: 0.4274 - val_loss: 3.3554 - val_accuracy1000: 0.3405 - 12s/epoch - 22ms/step
Epoch 11/50
526/526 - 12s - loss: 3.1682 - accuracy1000: 0.4360 - val_loss: 3.3664 - val_accuracy1000: 0.3389 - 12s/epoch - 22ms/step
Epoch 12/50
526/526 - 12s - loss: 3.1539 - accuracy1000: 0.4402 - val_loss: 3.3562 - val_accuracy1000: 0.3408 - 12s/epoch - 22ms/step
Epoch 13/50
526/526 - 12s - loss: 3.1527 - accuracy1000: 0.4398 - val_loss: 3.3875 - val_accuracy1000: 0.3385 - 12s/epoch - 22ms/step
Epoch 14/50
526/526 - 12s - loss: 3.1382 - accuracy1000: 0.4468 - val_loss: 3.3960 - val_accuracy1000: 0.3319 - 12s/epoch - 22ms/step
Epoch 15/50
526/526 - 12s - loss: 3.1287 - accuracy1000: 0.4499 - val_loss: 3.4011 - val_accuracy1000: 0.3207 - 12s/epoch - 23ms/step
Epoch 16/50
526/526 - 12s - loss: 3.1182 - accuracy1000: 0.4556 - val_loss: 3.4373 - val_accuracy1000: 0.3146 - 12s/epoch - 22ms/step
testing model: results/PCAR/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1345935
{'0': {'precision': 0.25877520735617565, 'recall': 0.4488435799382262, 'f1-score': 0.3282829471306254, 'support': 108784}, '1': {'precision': 0.41642792384406163, 'recall': 0.19409636925018595, 'f1-score': 0.26477946573715744, 'support': 177484}, '2': {'precision': 0.3240366972477064, 'recall': 0.35969544575868223, 'f1-score': 0.34093621442511546, 'support': 135017}, 'accuracy': 0.3129496659031297, 'macro avg': {'precision': 0.33307994281598124, 'recall': 0.3342117983156981, 'f1-score': 0.3113328757642994, 'support': 421285}, 'weighted avg': {'precision': 0.3461085928643726, 'recall': 0.3129496659031297, 'f1-score': 0.3055846652042855, 'support': 421285}}
[[48827 21564 38393]
 [80118 34449 62917]
 [59740 26712 48565]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1165816
{'0': {'precision': 0.3341470631750259, 'recall': 0.40056755198864896, 'f1-score': 0.36435499808425253, 'support': 45106}, '1': {'precision': 0.3520143948038269, 'recall': 0.17762866507219416, 'f1-score': 0.23611315533837682, 'support': 45156}, '2': {'precision': 0.32158567420595063, 'recall': 0.41880553926654335, 'f1-score': 0.3638126959247649, 'support': 44338}, 'accuracy': 0.33178306092124815, 'macro avg': {'precision': 0.3359157107282678, 'recall': 0.3323339187757955, 'f1-score': 0.3214269497824647, 'support': 134600}, 'weighted avg': {'precision': 0.3360034551729403, 'recall': 0.33178306092124815, 'f1-score': 0.3211534138035681, 'support': 134600}}
[[18068  7648 19390]
 [17352  8021 19783]
 [18652  7117 18569]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062573
{'0': {'precision': 0.3039778552388764, 'recall': 0.26815591932712307, 'f1-score': 0.28494546153476524, 'support': 11057}, '1': {'precision': 0.36065573770491804, 'recall': 0.25691758405236537, 'f1-score': 0.30007384561921724, 'support': 13444}, '2': {'precision': 0.35812611012433393, 'recall': 0.5022575120660128, 'f1-score': 0.41811937009915107, 'support': 12846}, 'accuracy': 0.3446327683615819, 'macro avg': {'precision': 0.34091990102270947, 'recall': 0.34244367181516705, 'f1-score': 0.33437955908437783, 'support': 37347}, 'weighted avg': {'precision': 0.3430055129927, 'recall': 0.3446327683615819, 'f1-score': 0.3361982535943543, 'support': 37347}}
[[2965 2897 5195]
 [3621 3454 6369]
 [3168 3226 6452]]
training model: results/PCAR/W7/deepOF_L1/h10
Epoch 1/50
526/526 - 14s - loss: 3.2982 - accuracy10: 0.3756 - val_loss: 3.2793 - val_accuracy10: 0.3869 - 14s/epoch - 27ms/step
Epoch 2/50
526/526 - 11s - loss: 3.2667 - accuracy10: 0.3924 - val_loss: 3.2669 - val_accuracy10: 0.3913 - 11s/epoch - 22ms/step
Epoch 3/50
526/526 - 11s - loss: 3.2539 - accuracy10: 0.3992 - val_loss: 3.2618 - val_accuracy10: 0.3923 - 11s/epoch - 21ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2486 - accuracy10: 0.4035 - val_loss: 3.2580 - val_accuracy10: 0.3968 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2414 - accuracy10: 0.4061 - val_loss: 3.2576 - val_accuracy10: 0.3992 - 11s/epoch - 21ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2385 - accuracy10: 0.4074 - val_loss: 3.2546 - val_accuracy10: 0.3986 - 11s/epoch - 21ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2345 - accuracy10: 0.4103 - val_loss: 3.2526 - val_accuracy10: 0.3967 - 11s/epoch - 21ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2326 - accuracy10: 0.4105 - val_loss: 3.2524 - val_accuracy10: 0.3970 - 11s/epoch - 21ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2289 - accuracy10: 0.4137 - val_loss: 3.2510 - val_accuracy10: 0.4003 - 11s/epoch - 21ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2265 - accuracy10: 0.4144 - val_loss: 3.2518 - val_accuracy10: 0.3999 - 11s/epoch - 21ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2243 - accuracy10: 0.4147 - val_loss: 3.2513 - val_accuracy10: 0.3995 - 11s/epoch - 21ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2223 - accuracy10: 0.4167 - val_loss: 3.2498 - val_accuracy10: 0.3966 - 11s/epoch - 21ms/step
Epoch 13/50
526/526 - 11s - loss: 3.2197 - accuracy10: 0.4167 - val_loss: 3.2520 - val_accuracy10: 0.3956 - 11s/epoch - 21ms/step
Epoch 14/50
526/526 - 11s - loss: 3.2184 - accuracy10: 0.4165 - val_loss: 3.2508 - val_accuracy10: 0.3975 - 11s/epoch - 21ms/step
Epoch 15/50
526/526 - 11s - loss: 3.2165 - accuracy10: 0.4181 - val_loss: 3.2512 - val_accuracy10: 0.3963 - 11s/epoch - 21ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2137 - accuracy10: 0.4198 - val_loss: 3.2527 - val_accuracy10: 0.3969 - 11s/epoch - 21ms/step
Epoch 17/50
526/526 - 12s - loss: 3.2124 - accuracy10: 0.4209 - val_loss: 3.2474 - val_accuracy10: 0.3997 - 12s/epoch - 22ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2096 - accuracy10: 0.4224 - val_loss: 3.2501 - val_accuracy10: 0.3968 - 11s/epoch - 21ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2094 - accuracy10: 0.4214 - val_loss: 3.2524 - val_accuracy10: 0.3980 - 11s/epoch - 21ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2057 - accuracy10: 0.4233 - val_loss: 3.2510 - val_accuracy10: 0.3992 - 11s/epoch - 22ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2042 - accuracy10: 0.4233 - val_loss: 3.2538 - val_accuracy10: 0.3990 - 11s/epoch - 21ms/step
Epoch 22/50
526/526 - 11s - loss: 3.2027 - accuracy10: 0.4242 - val_loss: 3.2493 - val_accuracy10: 0.3955 - 11s/epoch - 21ms/step
Epoch 23/50
526/526 - 11s - loss: 3.2016 - accuracy10: 0.4239 - val_loss: 3.2524 - val_accuracy10: 0.3984 - 11s/epoch - 21ms/step
Epoch 24/50
526/526 - 11s - loss: 3.1989 - accuracy10: 0.4259 - val_loss: 3.2514 - val_accuracy10: 0.3961 - 11s/epoch - 21ms/step
Epoch 25/50
526/526 - 11s - loss: 3.1975 - accuracy10: 0.4257 - val_loss: 3.2546 - val_accuracy10: 0.3919 - 11s/epoch - 21ms/step
Epoch 26/50
526/526 - 11s - loss: 3.1945 - accuracy10: 0.4277 - val_loss: 3.2539 - val_accuracy10: 0.3971 - 11s/epoch - 21ms/step
Epoch 27/50
526/526 - 11s - loss: 3.1926 - accuracy10: 0.4282 - val_loss: 3.2562 - val_accuracy10: 0.3952 - 11s/epoch - 21ms/step
testing model: results/PCAR/W7/deepOF_L1/h10
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0842147
{'0': {'precision': 0.36506895030374337, 'recall': 0.5003410958479333, 'f1-score': 0.42213283626017856, 'support': 128996}, '1': {'precision': 0.43851848491035444, 'recall': 0.3593800351999207, 'f1-score': 0.3950246417830638, 'support': 161364}, '2': {'precision': 0.39396666161809646, 'recall': 0.3377635197066911, 'f1-score': 0.36370664944913494, 'support': 130920}, 'accuracy': 0.395824629699962, 'macro avg': {'precision': 0.3991846989440648, 'recall': 0.39916155025151506, 'f1-score': 0.39362137583079243, 'support': 421280}, 'weighted avg': {'precision': 0.4021829815122895, 'recall': 0.395824629699962, 'f1-score': 0.3935925707101715, 'support': 421280}}
[[64542 34459 29995]
 [65345 57991 38028]
 [46907 39793 44220]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.073482
{'0': {'precision': 0.4249296599127594, 'recall': 0.48739441195581545, 'f1-score': 0.4540236262572256, 'support': 46170}, '1': {'precision': 0.3811131151765009, 'recall': 0.3463204476808167, 'f1-score': 0.36288472626013574, 'support': 42709}, '2': {'precision': 0.43378782218901757, 'recall': 0.40638670166229224, 'f1-score': 0.4196404372572048, 'support': 45720}, 'accuracy': 0.4151145253679448, 'macro avg': {'precision': 0.41327686575942596, 'recall': 0.41336718709964143, 'f1-score': 0.4121829299248554, 'support': 134599}, 'weighted avg': {'precision': 0.41403533209553683, 'recall': 0.4151145253679448, 'f1-score': 0.41342562269808575, 'support': 134599}}
[[22503 11664 12003]
 [15669 14791 12249]
 [14785 12355 18580]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0834318
{'0': {'precision': 0.4059339628959882, 'recall': 0.47600722532003453, 'f1-score': 0.4381868131868132, 'support': 12733}, '1': {'precision': 0.3499092192858584, 'recall': 0.3005544966210362, 'f1-score': 0.3233594332587621, 'support': 11542}, '2': {'precision': 0.42259380750460035, 'recall': 0.4041625219986227, 'f1-score': 0.4131727158948686, 'support': 13069}, 'accuracy': 0.39663667523564694, 'macro avg': {'precision': 0.39281232989548226, 'recall': 0.39357474797989783, 'f1-score': 0.3915729874468146, 'support': 37344}, 'weighted avg': {'precision': 0.3944485815346405, 'recall': 0.39663667523564694, 'f1-score': 0.3939428420900375, 'support': 37344}}
[[6061 2995 3677]
 [4533 3469 3540]
 [4337 3450 5282]]
training model: results/PCAR/W7/deepOF_L1/h20
Epoch 1/50
526/526 - 13s - loss: 3.3044 - accuracy20: 0.3654 - val_loss: 3.2950 - val_accuracy20: 0.3723 - 13s/epoch - 25ms/step
Epoch 2/50
526/526 - 11s - loss: 3.2779 - accuracy20: 0.3810 - val_loss: 3.2779 - val_accuracy20: 0.3823 - 11s/epoch - 21ms/step
Epoch 3/50
526/526 - 11s - loss: 3.2661 - accuracy20: 0.3868 - val_loss: 3.2680 - val_accuracy20: 0.3907 - 11s/epoch - 21ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2610 - accuracy20: 0.3926 - val_loss: 3.2659 - val_accuracy20: 0.3920 - 11s/epoch - 21ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2558 - accuracy20: 0.3936 - val_loss: 3.2654 - val_accuracy20: 0.3950 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2531 - accuracy20: 0.3954 - val_loss: 3.2617 - val_accuracy20: 0.3969 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2492 - accuracy20: 0.3975 - val_loss: 3.2618 - val_accuracy20: 0.3930 - 11s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2469 - accuracy20: 0.3999 - val_loss: 3.2614 - val_accuracy20: 0.3964 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2448 - accuracy20: 0.4010 - val_loss: 3.2624 - val_accuracy20: 0.3962 - 11s/epoch - 20ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2422 - accuracy20: 0.4018 - val_loss: 3.2622 - val_accuracy20: 0.3948 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2412 - accuracy20: 0.4024 - val_loss: 3.2606 - val_accuracy20: 0.3950 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2387 - accuracy20: 0.4045 - val_loss: 3.2628 - val_accuracy20: 0.3959 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 10s - loss: 3.2367 - accuracy20: 0.4044 - val_loss: 3.2623 - val_accuracy20: 0.3946 - 10s/epoch - 20ms/step
Epoch 14/50
526/526 - 11s - loss: 3.2350 - accuracy20: 0.4057 - val_loss: 3.2628 - val_accuracy20: 0.3940 - 11s/epoch - 20ms/step
Epoch 15/50
526/526 - 11s - loss: 3.2338 - accuracy20: 0.4064 - val_loss: 3.2614 - val_accuracy20: 0.3946 - 11s/epoch - 20ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2304 - accuracy20: 0.4079 - val_loss: 3.2641 - val_accuracy20: 0.3931 - 11s/epoch - 20ms/step
Epoch 17/50
526/526 - 11s - loss: 3.2304 - accuracy20: 0.4065 - val_loss: 3.2625 - val_accuracy20: 0.3951 - 11s/epoch - 20ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2285 - accuracy20: 0.4092 - val_loss: 3.2653 - val_accuracy20: 0.3913 - 11s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2268 - accuracy20: 0.4089 - val_loss: 3.2642 - val_accuracy20: 0.3933 - 11s/epoch - 20ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2247 - accuracy20: 0.4112 - val_loss: 3.2647 - val_accuracy20: 0.3934 - 11s/epoch - 21ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2228 - accuracy20: 0.4110 - val_loss: 3.2677 - val_accuracy20: 0.3903 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h20
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0891768
{'0': {'precision': 0.3460148031011838, 'recall': 0.6158970429561057, 'f1-score': 0.44309568475023414, 'support': 127898}, '1': {'precision': 0.41080944722984264, 'recall': 0.15995481779785875, 'f1-score': 0.230256006928182, 'support': 162896}, '2': {'precision': 0.3869461362990499, 'recall': 0.38609506000643745, 'f1-score': 0.3865201296584, 'support': 130486}, 'accuracy': 0.3684200531712875, 'macro avg': {'precision': 0.3812567955433588, 'recall': 0.38731564025346726, 'f1-score': 0.35329060711227206, 'support': 421280}, 'weighted avg': {'precision': 0.38374684424635747, 'recall': 0.3684200531712875, 'f1-score': 0.34327359483328085, 'support': 421280}}
[[78772 17323 31803]
 [88824 26056 48016]
 [60059 20047 50380]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0806674
{'0': {'precision': 0.4015310089109503, 'recall': 0.5865164122387473, 'f1-score': 0.4767069306754946, 'support': 45789}, '1': {'precision': 0.35744145051624276, 'recall': 0.16345002303086134, 'f1-score': 0.2243224022125642, 'support': 43420}, '2': {'precision': 0.4199331383201003, 'recall': 0.4427847543511787, 'f1-score': 0.4310563002680965, 'support': 45390}, 'accuracy': 0.4015705911633816, 'macro avg': {'precision': 0.3929685325824311, 'recall': 0.3975837298735958, 'f1-score': 0.37736187771871843, 'support': 134599}, 'weighted avg': {'precision': 0.3935138916098048, 'recall': 0.4015705911633816, 'f1-score': 0.37989626833734763, 'support': 134599}}
[[26856  6192 12741]
 [21302  7097 15021]
 [18726  6566 20098]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880153
{'0': {'precision': 0.38987314085739283, 'recall': 0.5701263393571085, 'f1-score': 0.46307722283561736, 'support': 12506}, '1': {'precision': 0.3519223448800914, 'recall': 0.15540426962514708, 'f1-score': 0.21560167910447764, 'support': 11898}, '2': {'precision': 0.4154470366613534, 'recall': 0.44312210200927354, 'f1-score': 0.4288385311495027, 'support': 12940}, 'accuracy': 0.39398564695801197, 'macro avg': {'precision': 0.3857475074662792, 'recall': 0.3895509036638431, 'f1-score': 0.36917247769653255, 'support': 37344}, 'weighted avg': {'precision': 0.38664337546443317, 'recall': 0.39398564695801197, 'f1-score': 0.3723661932262712, 'support': 37344}}
[[7130 1585 3791]
 [5772 1849 4277]
 [5386 1820 5734]]
training model: results/PCAR/W7/deepOF_L1/h30
Epoch 1/50
526/526 - 13s - loss: 3.3089 - accuracy30: 0.3661 - val_loss: 3.3016 - val_accuracy30: 0.3700 - 13s/epoch - 25ms/step
Epoch 2/50
526/526 - 11s - loss: 3.2806 - accuracy30: 0.3781 - val_loss: 3.2916 - val_accuracy30: 0.3754 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.2705 - accuracy30: 0.3824 - val_loss: 3.2840 - val_accuracy30: 0.3809 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2658 - accuracy30: 0.3840 - val_loss: 3.2814 - val_accuracy30: 0.3809 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 10s - loss: 3.2622 - accuracy30: 0.3864 - val_loss: 3.2827 - val_accuracy30: 0.3781 - 10s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2585 - accuracy30: 0.3885 - val_loss: 3.2781 - val_accuracy30: 0.3811 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 10s - loss: 3.2563 - accuracy30: 0.3896 - val_loss: 3.2782 - val_accuracy30: 0.3811 - 10s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2539 - accuracy30: 0.3916 - val_loss: 3.2789 - val_accuracy30: 0.3823 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 10s - loss: 3.2524 - accuracy30: 0.3918 - val_loss: 3.2781 - val_accuracy30: 0.3827 - 10s/epoch - 20ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2503 - accuracy30: 0.3947 - val_loss: 3.2764 - val_accuracy30: 0.3829 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2492 - accuracy30: 0.3948 - val_loss: 3.2771 - val_accuracy30: 0.3825 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2470 - accuracy30: 0.3969 - val_loss: 3.2747 - val_accuracy30: 0.3821 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 11s - loss: 3.2444 - accuracy30: 0.3971 - val_loss: 3.2759 - val_accuracy30: 0.3841 - 11s/epoch - 20ms/step
Epoch 14/50
526/526 - 10s - loss: 3.2433 - accuracy30: 0.3976 - val_loss: 3.2764 - val_accuracy30: 0.3836 - 10s/epoch - 20ms/step
Epoch 15/50
526/526 - 11s - loss: 3.2420 - accuracy30: 0.3999 - val_loss: 3.2736 - val_accuracy30: 0.3842 - 11s/epoch - 20ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2400 - accuracy30: 0.4012 - val_loss: 3.2775 - val_accuracy30: 0.3810 - 11s/epoch - 20ms/step
Epoch 17/50
526/526 - 10s - loss: 3.2382 - accuracy30: 0.4024 - val_loss: 3.2747 - val_accuracy30: 0.3847 - 10s/epoch - 20ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2368 - accuracy30: 0.4030 - val_loss: 3.2781 - val_accuracy30: 0.3834 - 11s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2345 - accuracy30: 0.4053 - val_loss: 3.2775 - val_accuracy30: 0.3827 - 11s/epoch - 21ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2331 - accuracy30: 0.4053 - val_loss: 3.2773 - val_accuracy30: 0.3823 - 11s/epoch - 20ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2311 - accuracy30: 0.4063 - val_loss: 3.2790 - val_accuracy30: 0.3821 - 11s/epoch - 21ms/step
Epoch 22/50
526/526 - 11s - loss: 3.2291 - accuracy30: 0.4075 - val_loss: 3.2805 - val_accuracy30: 0.3827 - 11s/epoch - 20ms/step
Epoch 23/50
526/526 - 11s - loss: 3.2278 - accuracy30: 0.4088 - val_loss: 3.2816 - val_accuracy30: 0.3838 - 11s/epoch - 20ms/step
Epoch 24/50
526/526 - 11s - loss: 3.2255 - accuracy30: 0.4093 - val_loss: 3.2820 - val_accuracy30: 0.3804 - 11s/epoch - 20ms/step
Epoch 25/50
526/526 - 11s - loss: 3.2250 - accuracy30: 0.4114 - val_loss: 3.2854 - val_accuracy30: 0.3823 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h30
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1032118
{'0': {'precision': 0.2961777177444175, 'recall': 0.6292364415707072, 'f1-score': 0.40277277219089697, 'support': 110116}, '1': {'precision': 0.4821244610629936, 'recall': 0.06462534586016254, 'f1-score': 0.11397337374174696, 'support': 195527}, '2': {'precision': 0.32866000111713123, 'recall': 0.4579503100218788, 'f1-score': 0.38267982830136865, 'support': 115637}, 'accuracy': 0.3201694834789214, 'macro avg': {'precision': 0.3689873933081808, 'recall': 0.38393736581758287, 'f1-score': 0.29980865807800416, 'support': 421280}, 'weighted avg': {'precision': 0.39139648598222065, 'recall': 0.3201694834789214, 'f1-score': 0.26321815831622847, 'support': 421280}}
[[ 69289   6271  34556]
 [109276  12636  73615]
 [ 55379   7302  52956]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0830824
{'0': {'precision': 0.39086591262426723, 'recall': 0.605372448528762, 'f1-score': 0.47502578458818334, 'support': 45268}, '1': {'precision': 0.39532453963693354, 'recall': 0.06819564286840742, 'f1-score': 0.11632464837445239, 'support': 44387}, '2': {'precision': 0.40289630659323256, 'recall': 0.5094562121751512, 'f1-score': 0.4499533284205354, 'support': 44944}, 'accuracy': 0.3961990802309081, 'macro avg': {'precision': 0.3963622529514778, 'recall': 0.3943414345241069, 'f1-score': 0.34710125379439044, 'support': 134599}, 'weighted avg': {'precision': 0.39635331671904056, 'recall': 0.3961990802309081, 'f1-score': 0.3483641912396619, 'support': 134599}}
[[27404  2218 15646]
 [23072  3027 18288]
 [19635  2412 22897]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914029
{'0': {'precision': 0.3739397794741306, 'recall': 0.5764955867930697, 'f1-score': 0.45363344051446947, 'support': 12236}, '1': {'precision': 0.39990421455938696, 'recall': 0.06731699451789745, 'f1-score': 0.11523599227159813, 'support': 12404}, '2': {'precision': 0.39464372864812103, 'recall': 0.5092096977329975, 'f1-score': 0.44466593346164424, 'support': 12704}, 'accuracy': 0.38447943444730076, 'macro avg': {'precision': 0.3894959075605462, 'recall': 0.38434075968132153, 'f1-score': 0.3378451220825706, 'support': 37344}, 'weighted avg': {'precision': 0.38960724474576447, 'recall': 0.38447943444730076, 'f1-score': 0.33818235981599937, 'support': 37344}}
[[7054  628 4554]
 [6200  835 5369]
 [5610  625 6469]]
training model: results/PCAR/W7/deepOF_L1/h50
Epoch 1/50
526/526 - 13s - loss: 3.3232 - accuracy50: 0.3528 - val_loss: 3.3126 - val_accuracy50: 0.3591 - 13s/epoch - 24ms/step
Epoch 2/50
526/526 - 11s - loss: 3.2943 - accuracy50: 0.3641 - val_loss: 3.2960 - val_accuracy50: 0.3650 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.2842 - accuracy50: 0.3703 - val_loss: 3.2889 - val_accuracy50: 0.3667 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 10s - loss: 3.2785 - accuracy50: 0.3740 - val_loss: 3.2874 - val_accuracy50: 0.3683 - 10s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2746 - accuracy50: 0.3770 - val_loss: 3.2858 - val_accuracy50: 0.3684 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2715 - accuracy50: 0.3788 - val_loss: 3.2832 - val_accuracy50: 0.3691 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2690 - accuracy50: 0.3804 - val_loss: 3.2815 - val_accuracy50: 0.3726 - 11s/epoch - 20ms/step
Epoch 8/50
526/526 - 10s - loss: 3.2670 - accuracy50: 0.3828 - val_loss: 3.2831 - val_accuracy50: 0.3706 - 10s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2654 - accuracy50: 0.3843 - val_loss: 3.2817 - val_accuracy50: 0.3715 - 11s/epoch - 21ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2640 - accuracy50: 0.3862 - val_loss: 3.2833 - val_accuracy50: 0.3715 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2616 - accuracy50: 0.3862 - val_loss: 3.2806 - val_accuracy50: 0.3736 - 11s/epoch - 21ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2607 - accuracy50: 0.3867 - val_loss: 3.2835 - val_accuracy50: 0.3727 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 11s - loss: 3.2591 - accuracy50: 0.3885 - val_loss: 3.2839 - val_accuracy50: 0.3719 - 11s/epoch - 20ms/step
Epoch 14/50
526/526 - 11s - loss: 3.2584 - accuracy50: 0.3889 - val_loss: 3.2825 - val_accuracy50: 0.3686 - 11s/epoch - 20ms/step
Epoch 15/50
526/526 - 10s - loss: 3.2564 - accuracy50: 0.3903 - val_loss: 3.2874 - val_accuracy50: 0.3668 - 10s/epoch - 20ms/step
Epoch 16/50
526/526 - 10s - loss: 3.2548 - accuracy50: 0.3909 - val_loss: 3.2862 - val_accuracy50: 0.3693 - 10s/epoch - 20ms/step
Epoch 17/50
526/526 - 10s - loss: 3.2542 - accuracy50: 0.3924 - val_loss: 3.2839 - val_accuracy50: 0.3700 - 10s/epoch - 20ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2520 - accuracy50: 0.3932 - val_loss: 3.2857 - val_accuracy50: 0.3705 - 11s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2516 - accuracy50: 0.3927 - val_loss: 3.2888 - val_accuracy50: 0.3695 - 11s/epoch - 20ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2501 - accuracy50: 0.3946 - val_loss: 3.2883 - val_accuracy50: 0.3674 - 11s/epoch - 20ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2481 - accuracy50: 0.3957 - val_loss: 3.2905 - val_accuracy50: 0.3661 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h50
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966165
{'0': {'precision': 0.32158402093513844, 'recall': 0.5924729419481797, 'f1-score': 0.416888309380535, 'support': 121960}, '1': {'precision': 0.42385934321418195, 'recall': 0.11978201187319615, 'f1-score': 0.18678021606095813, 'support': 170468}, '2': {'precision': 0.3558472360725548, 'recall': 0.40986558221835906, 'f1-score': 0.3809510069825149, 'support': 128852}, 'accuracy': 0.3453498860615268, 'macro avg': {'precision': 0.3670968667406251, 'recall': 0.37404017867991163, 'f1-score': 0.3282065108080026, 'support': 421280}, 'weighted avg': {'precision': 0.37344870341508135, 'recall': 0.3453498860615268, 'f1-score': 0.3127849583062107, 'support': 421280}}
[[72258 13515 36187]
 [90636 20419 59413]
 [61800 14240 52812]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880427
{'0': {'precision': 0.38232042548105655, 'recall': 0.5635666938272149, 'f1-score': 0.4555787974542704, 'support': 45409}, '1': {'precision': 0.37549434538264065, 'recall': 0.12180136385119168, 'f1-score': 0.18393773578493017, 'support': 44433}, '2': {'precision': 0.3910798122065728, 'recall': 0.46529034564425675, 'f1-score': 0.4249696450253553, 'support': 44757}, 'accuracy': 0.38505486667805855, 'macro avg': {'precision': 0.3829648610234233, 'recall': 0.3835528011075544, 'f1-score': 0.3548287260881853, 'support': 134599}, 'weighted avg': {'precision': 0.38297972201863123, 'recall': 0.38505486667805855, 'f1-score': 0.35572812153234856, 'support': 134599}}
[[25591  4623 15195]
 [21791  5412 17230]
 [19554  4378 20825]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936188
{'0': {'precision': 0.36410857908847183, 'recall': 0.5364107627746235, 'f1-score': 0.43377582593073155, 'support': 12153}, '1': {'precision': 0.3678020093114433, 'recall': 0.119649262654444, 'f1-score': 0.18056056778539636, 'support': 12545}, '2': {'precision': 0.38244677387850773, 'recall': 0.464494701882018, 'f1-score': 0.419496518478843, 'support': 12646}, 'accuracy': 0.37205441302485004, 'macro avg': {'precision': 0.37145245409280764, 'recall': 0.37351824243702847, 'f1-score': 0.344610970731657, 'support': 37344}, 'weighted avg': {'precision': 0.37155927782085113, 'recall': 0.37205441302485004, 'f1-score': 0.3438775414547833, 'support': 37344}}
[[6519 1303 4331]
 [5890 1501 5154]
 [5495 1277 5874]]
training model: results/PCAR/W7/deepOF_L1/h100
Epoch 1/50
526/526 - 13s - loss: 3.3316 - accuracy100: 0.3474 - val_loss: 3.3352 - val_accuracy100: 0.3510 - 13s/epoch - 24ms/step
Epoch 2/50
526/526 - 11s - loss: 3.3043 - accuracy100: 0.3578 - val_loss: 3.3221 - val_accuracy100: 0.3476 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.2942 - accuracy100: 0.3615 - val_loss: 3.3179 - val_accuracy100: 0.3536 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2894 - accuracy100: 0.3642 - val_loss: 3.3111 - val_accuracy100: 0.3558 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2854 - accuracy100: 0.3640 - val_loss: 3.3115 - val_accuracy100: 0.3555 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2840 - accuracy100: 0.3666 - val_loss: 3.3080 - val_accuracy100: 0.3565 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 10s - loss: 3.2818 - accuracy100: 0.3654 - val_loss: 3.3111 - val_accuracy100: 0.3545 - 10s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2805 - accuracy100: 0.3676 - val_loss: 3.3090 - val_accuracy100: 0.3562 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2780 - accuracy100: 0.3698 - val_loss: 3.3078 - val_accuracy100: 0.3558 - 11s/epoch - 20ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2764 - accuracy100: 0.3708 - val_loss: 3.3072 - val_accuracy100: 0.3571 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2756 - accuracy100: 0.3721 - val_loss: 3.3055 - val_accuracy100: 0.3565 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2730 - accuracy100: 0.3750 - val_loss: 3.3061 - val_accuracy100: 0.3583 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 11s - loss: 3.2731 - accuracy100: 0.3743 - val_loss: 3.3105 - val_accuracy100: 0.3523 - 11s/epoch - 20ms/step
Epoch 14/50
526/526 - 11s - loss: 3.2714 - accuracy100: 0.3749 - val_loss: 3.3082 - val_accuracy100: 0.3536 - 11s/epoch - 20ms/step
Epoch 15/50
526/526 - 11s - loss: 3.2702 - accuracy100: 0.3752 - val_loss: 3.3109 - val_accuracy100: 0.3564 - 11s/epoch - 20ms/step
Epoch 16/50
526/526 - 10s - loss: 3.2689 - accuracy100: 0.3778 - val_loss: 3.3089 - val_accuracy100: 0.3548 - 10s/epoch - 20ms/step
Epoch 17/50
526/526 - 10s - loss: 3.2679 - accuracy100: 0.3795 - val_loss: 3.3120 - val_accuracy100: 0.3551 - 10s/epoch - 20ms/step
Epoch 18/50
526/526 - 10s - loss: 3.2668 - accuracy100: 0.3800 - val_loss: 3.3115 - val_accuracy100: 0.3568 - 10s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2650 - accuracy100: 0.3796 - val_loss: 3.3136 - val_accuracy100: 0.3545 - 11s/epoch - 20ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2634 - accuracy100: 0.3835 - val_loss: 3.3155 - val_accuracy100: 0.3534 - 11s/epoch - 20ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2629 - accuracy100: 0.3820 - val_loss: 3.3167 - val_accuracy100: 0.3534 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h100
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198558
{'0': {'precision': 0.28236087432250184, 'recall': 0.6013439670511304, 'f1-score': 0.38428217286031324, 'support': 110717}, '1': {'precision': 0.47966388225934764, 'recall': 0.05104286817849924, 'f1-score': 0.09226722777485533, 'support': 188998}, '2': {'precision': 0.31546676019204956, 'recall': 0.4291531279562374, 'f1-score': 0.363631294456313, 'support': 121565}, 'accuracy': 0.30477592100265855, 'macro avg': {'precision': 0.359163838924633, 'recall': 0.3605133210619556, 'f1-score': 0.28006023169716054, 'support': 421280}, 'weighted avg': {'precision': 0.3804295956237256, 'recall': 0.30477592100265855, 'f1-score': 0.24731705554061217, 'support': 421280}}
[[ 66579   4838  39300]
 [105447   9647  73904]
 [ 63768   5627  52170]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960457
{'0': {'precision': 0.36514357904299566, 'recall': 0.5732878696708341, 'f1-score': 0.4461325008671523, 'support': 44871}, '1': {'precision': 0.3934040047114252, 'recall': 0.052175853604106225, 'f1-score': 0.09213248477922488, 'support': 44810}, '2': {'precision': 0.3732540759702441, 'recall': 0.4836813749499087, 'f1-score': 0.4213527272727273, 'support': 44918}, 'accuracy': 0.3698987362461831, 'macro avg': {'precision': 0.37726721990822165, 'recall': 0.3697150327416163, 'f1-score': 0.31987257097303484, 'support': 134599}, 'weighted avg': {'precision': 0.37725850541823225, 'recall': 0.3698987362461831, 'f1-score': 0.32001121771338137, 'support': 134599}}
[[25724  1803 17344]
 [23335  2338 19137]
 [21390  1802 21726]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020092
{'0': {'precision': 0.3483303132280611, 'recall': 0.549942782409678, 'f1-score': 0.42651114139909346, 'support': 12234}, '1': {'precision': 0.3346966598500341, 'recall': 0.039986969622933466, 'f1-score': 0.07143896406227267, 'support': 12279}, '2': {'precision': 0.3698224852071006, 'recall': 0.4773595199127114, 'f1-score': 0.4167658966420576, 'support': 12831}, 'accuracy': 0.35732647814910024, 'macro avg': {'precision': 0.3509498194283986, 'recall': 0.35576309064844097, 'f1-score': 0.30490533403447456, 'support': 37344}, 'weighted avg': {'precision': 0.35123194210644215, 'recall': 0.35732647814910024, 'f1-score': 0.3064122633732701, 'support': 37344}}
[[6728  464 5042]
 [6393  491 5395]
 [6194  512 6125]]
training model: results/PCAR/W7/deepOF_L1/h200
Epoch 1/50
526/526 - 13s - loss: 3.3356 - accuracy200: 0.3414 - val_loss: 3.3372 - val_accuracy200: 0.3371 - 13s/epoch - 24ms/step
Epoch 2/50
526/526 - 11s - loss: 3.3121 - accuracy200: 0.3485 - val_loss: 3.3253 - val_accuracy200: 0.3367 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.3029 - accuracy200: 0.3514 - val_loss: 3.3179 - val_accuracy200: 0.3378 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2972 - accuracy200: 0.3530 - val_loss: 3.3144 - val_accuracy200: 0.3388 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2940 - accuracy200: 0.3558 - val_loss: 3.3136 - val_accuracy200: 0.3389 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2919 - accuracy200: 0.3575 - val_loss: 3.3100 - val_accuracy200: 0.3393 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2890 - accuracy200: 0.3575 - val_loss: 3.3092 - val_accuracy200: 0.3435 - 11s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2883 - accuracy200: 0.3588 - val_loss: 3.3085 - val_accuracy200: 0.3409 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2859 - accuracy200: 0.3616 - val_loss: 3.3072 - val_accuracy200: 0.3429 - 11s/epoch - 20ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2847 - accuracy200: 0.3644 - val_loss: 3.3069 - val_accuracy200: 0.3439 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2841 - accuracy200: 0.3636 - val_loss: 3.3059 - val_accuracy200: 0.3427 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 10s - loss: 3.2829 - accuracy200: 0.3652 - val_loss: 3.3064 - val_accuracy200: 0.3462 - 10s/epoch - 20ms/step
Epoch 13/50
526/526 - 10s - loss: 3.2811 - accuracy200: 0.3675 - val_loss: 3.3071 - val_accuracy200: 0.3456 - 10s/epoch - 20ms/step
Epoch 14/50
526/526 - 10s - loss: 3.2803 - accuracy200: 0.3670 - val_loss: 3.3061 - val_accuracy200: 0.3473 - 10s/epoch - 20ms/step
Epoch 15/50
526/526 - 10s - loss: 3.2785 - accuracy200: 0.3703 - val_loss: 3.3079 - val_accuracy200: 0.3445 - 10s/epoch - 20ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2775 - accuracy200: 0.3715 - val_loss: 3.3084 - val_accuracy200: 0.3440 - 11s/epoch - 21ms/step
Epoch 17/50
526/526 - 11s - loss: 3.2766 - accuracy200: 0.3722 - val_loss: 3.3090 - val_accuracy200: 0.3442 - 11s/epoch - 21ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2761 - accuracy200: 0.3721 - val_loss: 3.3085 - val_accuracy200: 0.3469 - 11s/epoch - 21ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2742 - accuracy200: 0.3734 - val_loss: 3.3118 - val_accuracy200: 0.3431 - 11s/epoch - 20ms/step
Epoch 20/50
526/526 - 10s - loss: 3.2735 - accuracy200: 0.3735 - val_loss: 3.3103 - val_accuracy200: 0.3473 - 10s/epoch - 20ms/step
Epoch 21/50
526/526 - 10s - loss: 3.2730 - accuracy200: 0.3746 - val_loss: 3.3105 - val_accuracy200: 0.3452 - 10s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h200
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069756
{'0': {'precision': 0.276737090311366, 'recall': 0.47362082292247126, 'f1-score': 0.3493491469466092, 'support': 111262}, '1': {'precision': 0.4460471172234203, 'recall': 0.11809284764002823, 'f1-score': 0.18674434550046207, 'support': 185659}, '2': {'precision': 0.3094762447236485, 'recall': 0.4521908345998279, 'f1-score': 0.3674632268857044, 'support': 124359}, 'accuracy': 0.3106128940372199, 'macro avg': {'precision': 0.3440868174194783, 'recall': 0.3479681683874425, 'f1-score': 0.3011855731109252, 'support': 421280}, 'weighted avg': {'precision': 0.3610167589166217, 'recall': 0.3106128940372199, 'f1-score': 0.283036015621732, 'support': 421280}}
[[52696 12618 45948]
 [84209 21925 79525]
 [53514 14611 56234]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952494
{'0': {'precision': 0.3621847433927739, 'recall': 0.4621772843422328, 'f1-score': 0.40611662230825063, 'support': 45396}, '1': {'precision': 0.36606035551880944, 'recall': 0.12017643067179372, 'f1-score': 0.18094816429398541, 'support': 44210}, '2': {'precision': 0.3602387541025806, 'recall': 0.49765519080745896, 'f1-score': 0.41794137136137527, 'support': 44993}, 'accuracy': 0.36170402454698775, 'macro avg': {'precision': 0.36282795100472137, 'recall': 0.3600029686071618, 'f1-score': 0.33500205265453714, 'support': 134599}, 'weighted avg': {'precision': 0.3628072213900723, 'recall': 0.36170402454698775, 'f1-score': 0.3361111497960966, 'support': 134599}}
[[20981  4661 19754]
 [18886  5313 20011]
 [18062  4540 22391]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009041
{'0': {'precision': 0.3305993690851735, 'recall': 0.4465274818917767, 'f1-score': 0.3799166213521841, 'support': 11735}, '1': {'precision': 0.37710617812249264, 'recall': 0.1067211625794732, 'f1-score': 0.16636186655654533, 'support': 13212}, '2': {'precision': 0.3518445508307519, 'recall': 0.5039122368314914, 'f1-score': 0.4143672061554789, 'support': 12397}, 'accuracy': 0.34535668380462725, 'macro avg': {'precision': 0.35318336601280603, 'recall': 0.3523869604342471, 'f1-score': 0.3202152313547361, 'support': 37344}, 'weighted avg': {'precision': 0.35410580864978886, 'recall': 0.34535668380462725, 'f1-score': 0.3157991856047137, 'support': 37344}}
[[5240 1126 5369]
 [5663 1410 6139]
 [4947 1203 6247]]
training model: results/PCAR/W7/deepOF_L1/h300
Epoch 1/50
526/526 - 13s - loss: 3.3374 - accuracy300: 0.3421 - val_loss: 3.3325 - val_accuracy300: 0.3315 - 13s/epoch - 25ms/step
Epoch 2/50
526/526 - 11s - loss: 3.3140 - accuracy300: 0.3448 - val_loss: 3.3179 - val_accuracy300: 0.3364 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.3048 - accuracy300: 0.3482 - val_loss: 3.3109 - val_accuracy300: 0.3389 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.2992 - accuracy300: 0.3513 - val_loss: 3.3066 - val_accuracy300: 0.3394 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2960 - accuracy300: 0.3534 - val_loss: 3.3047 - val_accuracy300: 0.3365 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2931 - accuracy300: 0.3556 - val_loss: 3.3046 - val_accuracy300: 0.3378 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2913 - accuracy300: 0.3562 - val_loss: 3.3041 - val_accuracy300: 0.3395 - 11s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2894 - accuracy300: 0.3585 - val_loss: 3.3032 - val_accuracy300: 0.3383 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2887 - accuracy300: 0.3595 - val_loss: 3.3020 - val_accuracy300: 0.3427 - 11s/epoch - 21ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2864 - accuracy300: 0.3614 - val_loss: 3.3030 - val_accuracy300: 0.3414 - 11s/epoch - 21ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2857 - accuracy300: 0.3619 - val_loss: 3.3030 - val_accuracy300: 0.3410 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2848 - accuracy300: 0.3617 - val_loss: 3.3028 - val_accuracy300: 0.3408 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 10s - loss: 3.2834 - accuracy300: 0.3636 - val_loss: 3.3037 - val_accuracy300: 0.3435 - 10s/epoch - 20ms/step
Epoch 14/50
526/526 - 10s - loss: 3.2829 - accuracy300: 0.3645 - val_loss: 3.3050 - val_accuracy300: 0.3411 - 10s/epoch - 20ms/step
Epoch 15/50
526/526 - 10s - loss: 3.2806 - accuracy300: 0.3664 - val_loss: 3.3058 - val_accuracy300: 0.3400 - 10s/epoch - 20ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2797 - accuracy300: 0.3656 - val_loss: 3.3054 - val_accuracy300: 0.3444 - 11s/epoch - 20ms/step
Epoch 17/50
526/526 - 11s - loss: 3.2790 - accuracy300: 0.3672 - val_loss: 3.3071 - val_accuracy300: 0.3421 - 11s/epoch - 20ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2774 - accuracy300: 0.3687 - val_loss: 3.3093 - val_accuracy300: 0.3415 - 11s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2761 - accuracy300: 0.3721 - val_loss: 3.3084 - val_accuracy300: 0.3412 - 11s/epoch - 21ms/step
testing model: results/PCAR/W7/deepOF_L1/h300
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005002
{'0': {'precision': 0.28283920754744557, 'recall': 0.3451215379951135, 'f1-score': 0.31089173330334513, 'support': 112146}, '1': {'precision': 0.4319235416895529, 'recall': 0.21876269272070728, 'f1-score': 0.29042801901321835, 'support': 179729}, '2': {'precision': 0.31654162939677055, 'recall': 0.4731038213361153, 'f1-score': 0.37930201292385085, 'support': 129405}, 'accuracy': 0.33052601595138625, 'macro avg': {'precision': 0.34376812621125635, 'recall': 0.34566268401731204, 'f1-score': 0.3268739217468048, 'support': 421280}, 'weighted avg': {'precision': 0.3567948669436635, 'recall': 0.33052601595138625, 'f1-score': 0.3231750349759651, 'support': 421280}}
[[38704 23996 49446]
 [57670 39318 82741]
 [40467 27716 61222]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962601
{'0': {'precision': 0.37091084803092533, 'recall': 0.3379116041556612, 'f1-score': 0.3536430858538158, 'support': 45432}, '1': {'precision': 0.353716847217034, 'recall': 0.21329939404861126, 'f1-score': 0.266121439512106, 'support': 44393}, '2': {'precision': 0.3533316275079396, 'recall': 0.524299816857998, 'f1-score': 0.42216287664211916, 'support': 44774}, 'accuracy': 0.3588139584989487, 'macro avg': {'precision': 0.3593197742519663, 'recall': 0.35850360502075684, 'f1-score': 0.3473091340026803, 'support': 134599}, 'weighted avg': {'precision': 0.3593922981321353, 'recall': 0.3588139584989487, 'f1-score': 0.34756991047144276, 'support': 134599}}
[[15352  8720 21360]
 [13320  9469 21604]
 [12718  8581 23475]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003209
{'0': {'precision': 0.32684757002006803, 'recall': 0.32312602432502374, 'f1-score': 0.32497614296868227, 'support': 11593}, '1': {'precision': 0.3635971223021583, 'recall': 0.1895155242237888, 'f1-score': 0.24916190100571883, 'support': 13334}, '2': {'precision': 0.33977710875191464, 'recall': 0.5180800515422405, 'f1-score': 0.4103987240829346, 'support': 12417}, 'accuracy': 0.3402420736932305, 'macro avg': {'precision': 0.34340726702471364, 'recall': 0.34357386669701767, 'f1-score': 0.32817892268577853, 'support': 37344}, 'weighted avg': {'precision': 0.34426843046787037, 'recall': 0.3402420736932305, 'f1-score': 0.32630929119494395, 'support': 37344}}
[[3746 2063 5784]
 [4091 2527 6716]
 [3624 2360 6433]]
training model: results/PCAR/W7/deepOF_L1/h500
Epoch 1/50
526/526 - 13s - loss: 3.3410 - accuracy500: 0.3414 - val_loss: 3.3331 - val_accuracy500: 0.3315 - 13s/epoch - 24ms/step
Epoch 2/50
526/526 - 11s - loss: 3.3190 - accuracy500: 0.3418 - val_loss: 3.3173 - val_accuracy500: 0.3360 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.3092 - accuracy500: 0.3443 - val_loss: 3.3120 - val_accuracy500: 0.3346 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.3024 - accuracy500: 0.3473 - val_loss: 3.3079 - val_accuracy500: 0.3369 - 11s/epoch - 21ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2991 - accuracy500: 0.3499 - val_loss: 3.3045 - val_accuracy500: 0.3398 - 11s/epoch - 21ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2957 - accuracy500: 0.3542 - val_loss: 3.3010 - val_accuracy500: 0.3442 - 11s/epoch - 21ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2941 - accuracy500: 0.3522 - val_loss: 3.3021 - val_accuracy500: 0.3388 - 11s/epoch - 21ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2925 - accuracy500: 0.3540 - val_loss: 3.3030 - val_accuracy500: 0.3413 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2910 - accuracy500: 0.3543 - val_loss: 3.2998 - val_accuracy500: 0.3447 - 11s/epoch - 20ms/step
Epoch 10/50
526/526 - 11s - loss: 3.2901 - accuracy500: 0.3582 - val_loss: 3.3028 - val_accuracy500: 0.3403 - 11s/epoch - 20ms/step
Epoch 11/50
526/526 - 10s - loss: 3.2885 - accuracy500: 0.3587 - val_loss: 3.3026 - val_accuracy500: 0.3398 - 10s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2874 - accuracy500: 0.3585 - val_loss: 3.3035 - val_accuracy500: 0.3412 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 10s - loss: 3.2863 - accuracy500: 0.3608 - val_loss: 3.3049 - val_accuracy500: 0.3384 - 10s/epoch - 20ms/step
Epoch 14/50
526/526 - 10s - loss: 3.2855 - accuracy500: 0.3617 - val_loss: 3.3056 - val_accuracy500: 0.3387 - 10s/epoch - 20ms/step
Epoch 15/50
526/526 - 10s - loss: 3.2839 - accuracy500: 0.3622 - val_loss: 3.3033 - val_accuracy500: 0.3453 - 10s/epoch - 20ms/step
Epoch 16/50
526/526 - 10s - loss: 3.2830 - accuracy500: 0.3641 - val_loss: 3.3066 - val_accuracy500: 0.3396 - 10s/epoch - 20ms/step
Epoch 17/50
526/526 - 10s - loss: 3.2821 - accuracy500: 0.3648 - val_loss: 3.3043 - val_accuracy500: 0.3437 - 10s/epoch - 20ms/step
Epoch 18/50
526/526 - 10s - loss: 3.2815 - accuracy500: 0.3666 - val_loss: 3.3068 - val_accuracy500: 0.3408 - 10s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2802 - accuracy500: 0.3662 - val_loss: 3.3062 - val_accuracy500: 0.3432 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h500
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011693
{'0': {'precision': 0.27824121675364233, 'recall': 0.2557872021686403, 'f1-score': 0.266542153337236, 'support': 112144}, '1': {'precision': 0.42904248718950344, 'recall': 0.20819325739963315, 'f1-score': 0.28034759107374113, 'support': 179367}, '2': {'precision': 0.3134701576479139, 'recall': 0.5583613960190801, 'f1-score': 0.40152167949971873, 'support': 129769}, 'accuracy': 0.32872673756171666, 'macro avg': {'precision': 0.34025128719701986, 'recall': 0.34078061852911784, 'f1-score': 0.3161371413035653, 'support': 421280}, 'weighted avg': {'precision': 0.35329912575757755, 'recall': 0.32872673756171666, 'f1-score': 0.3139984723674842, 'support': 421280}}
[[28685 23154 60305]
 [43639 37343 98385]
 [30770 26541 72458]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975432
{'0': {'precision': 0.36254454269499803, 'recall': 0.24249111733939488, 'f1-score': 0.29060710649158306, 'support': 45313}, '1': {'precision': 0.35135650780325867, 'recall': 0.20706559625806742, 'f1-score': 0.26056935876393683, 'support': 44469}, '2': {'precision': 0.3471517852569028, 'recall': 0.6048374500747484, 'f1-score': 0.441119274863508, 'support': 44817}, 'accuracy': 0.3514364891269623, 'macro avg': {'precision': 0.35368427858505314, 'recall': 0.35146472122407024, 'f1-score': 0.3307652467063426, 'support': 134599}, 'weighted avg': {'precision': 0.3537229471875732, 'recall': 0.3514364891269623, 'f1-score': 0.33079875164662775, 'support': 134599}}
[[10988  8731 25594]
 [ 9878  9208 25383]
 [ 9442  8268 27107]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001236
{'0': {'precision': 0.31569517439082656, 'recall': 0.23333627615432154, 'f1-score': 0.2683384943398142, 'support': 11327}, '1': {'precision': 0.3615934627170582, 'recall': 0.1832975811820401, 'f1-score': 0.2432750834478696, 'support': 13519}, '2': {'precision': 0.33916542339165423, 'recall': 0.6002560409665546, 'f1-score': 0.43342866221798537, 'support': 12498}, 'accuracy': 0.3380194944301628, 'macro avg': {'precision': 0.338818020166513, 'recall': 0.3389632994343054, 'f1-score': 0.31501408000188974, 'support': 37344}, 'weighted avg': {'precision': 0.34016577560908573, 'recall': 0.3380194944301628, 'f1-score': 0.3145163185229008, 'support': 37344}}
[[2643 2096 6588]
 [3012 2478 8029]
 [2717 2279 7502]]
training model: results/PCAR/W7/deepOF_L1/h1000
Epoch 1/50
526/526 - 13s - loss: 3.3414 - accuracy1000: 0.3492 - val_loss: 3.3445 - val_accuracy1000: 0.3307 - 13s/epoch - 24ms/step
Epoch 2/50
526/526 - 11s - loss: 3.3199 - accuracy1000: 0.3502 - val_loss: 3.3255 - val_accuracy1000: 0.3290 - 11s/epoch - 20ms/step
Epoch 3/50
526/526 - 11s - loss: 3.3077 - accuracy1000: 0.3513 - val_loss: 3.3165 - val_accuracy1000: 0.3355 - 11s/epoch - 20ms/step
Epoch 4/50
526/526 - 11s - loss: 3.3026 - accuracy1000: 0.3550 - val_loss: 3.3105 - val_accuracy1000: 0.3422 - 11s/epoch - 20ms/step
Epoch 5/50
526/526 - 11s - loss: 3.2991 - accuracy1000: 0.3527 - val_loss: 3.3067 - val_accuracy1000: 0.3417 - 11s/epoch - 20ms/step
Epoch 6/50
526/526 - 11s - loss: 3.2964 - accuracy1000: 0.3555 - val_loss: 3.3048 - val_accuracy1000: 0.3423 - 11s/epoch - 20ms/step
Epoch 7/50
526/526 - 11s - loss: 3.2952 - accuracy1000: 0.3553 - val_loss: 3.3029 - val_accuracy1000: 0.3440 - 11s/epoch - 20ms/step
Epoch 8/50
526/526 - 11s - loss: 3.2934 - accuracy1000: 0.3565 - val_loss: 3.3042 - val_accuracy1000: 0.3416 - 11s/epoch - 20ms/step
Epoch 9/50
526/526 - 11s - loss: 3.2922 - accuracy1000: 0.3557 - val_loss: 3.3018 - val_accuracy1000: 0.3430 - 11s/epoch - 20ms/step
Epoch 10/50
526/526 - 10s - loss: 3.2908 - accuracy1000: 0.3593 - val_loss: 3.3014 - val_accuracy1000: 0.3455 - 10s/epoch - 20ms/step
Epoch 11/50
526/526 - 11s - loss: 3.2900 - accuracy1000: 0.3576 - val_loss: 3.2997 - val_accuracy1000: 0.3452 - 11s/epoch - 20ms/step
Epoch 12/50
526/526 - 11s - loss: 3.2885 - accuracy1000: 0.3596 - val_loss: 3.3011 - val_accuracy1000: 0.3463 - 11s/epoch - 20ms/step
Epoch 13/50
526/526 - 10s - loss: 3.2878 - accuracy1000: 0.3596 - val_loss: 3.3012 - val_accuracy1000: 0.3462 - 10s/epoch - 20ms/step
Epoch 14/50
526/526 - 10s - loss: 3.2867 - accuracy1000: 0.3622 - val_loss: 3.3020 - val_accuracy1000: 0.3436 - 10s/epoch - 20ms/step
Epoch 15/50
526/526 - 11s - loss: 3.2858 - accuracy1000: 0.3642 - val_loss: 3.3023 - val_accuracy1000: 0.3445 - 11s/epoch - 20ms/step
Epoch 16/50
526/526 - 11s - loss: 3.2848 - accuracy1000: 0.3630 - val_loss: 3.3004 - val_accuracy1000: 0.3492 - 11s/epoch - 20ms/step
Epoch 17/50
526/526 - 10s - loss: 3.2836 - accuracy1000: 0.3656 - val_loss: 3.3011 - val_accuracy1000: 0.3442 - 10s/epoch - 20ms/step
Epoch 18/50
526/526 - 11s - loss: 3.2827 - accuracy1000: 0.3661 - val_loss: 3.3020 - val_accuracy1000: 0.3449 - 11s/epoch - 20ms/step
Epoch 19/50
526/526 - 11s - loss: 3.2806 - accuracy1000: 0.3676 - val_loss: 3.3049 - val_accuracy1000: 0.3443 - 11s/epoch - 20ms/step
Epoch 20/50
526/526 - 11s - loss: 3.2811 - accuracy1000: 0.3676 - val_loss: 3.3024 - val_accuracy1000: 0.3465 - 11s/epoch - 20ms/step
Epoch 21/50
526/526 - 11s - loss: 3.2797 - accuracy1000: 0.3680 - val_loss: 3.3057 - val_accuracy1000: 0.3441 - 11s/epoch - 20ms/step
testing model: results/PCAR/W7/deepOF_L1/h1000
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033207
{'0': {'precision': 0.2629362627302895, 'recall': 0.10561489952381828, 'f1-score': 0.15069813807984156, 'support': 108782}, '1': {'precision': 0.42850374301146593, 'recall': 0.10191456034978195, 'f1-score': 0.1646653982357279, 'support': 177482}, '2': {'precision': 0.3217462347893241, 'recall': 0.7992015761094982, 'f1-score': 0.4587904904238832, 'support': 135016}, 'accuracy': 0.32634352449677173, 'macro avg': {'precision': 0.3377287468436932, 'recall': 0.3355770119943661, 'f1-score': 0.25805134224648424, 'support': 421280}, 'weighted avg': {'precision': 0.3515365635344729, 'recall': 0.32634352449677173, 'f1-score': 0.2553229346784699, 'support': 421280}}
[[ 11489  10826  86467]
 [ 18393  18088 141001]
 [ 13813  13298 107905]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991048
{'0': {'precision': 0.3717443973349485, 'recall': 0.10878716710240617, 'f1-score': 0.16831784991944054, 'support': 45134}, '1': {'precision': 0.3796612802983219, 'recall': 0.10828477099997784, 'f1-score': 0.1685085254210989, 'support': 45131}, '2': {'precision': 0.3359043116873543, 'recall': 0.8222131998015068, 'f1-score': 0.4769549828920597, 'support': 44334}, 'accuracy': 0.34360582173716003, 'macro avg': {'precision': 0.36243666310687495, 'recall': 0.34642837930129694, 'f1-score': 0.2712604527441997, 'support': 134599}, 'weighted avg': {'precision': 0.3625939763653987, 'recall': 0.34360582173716003, 'f1-score': 0.27004018091204407, 'support': 134599}}
[[ 4910  4209 36015]
 [ 4192  4887 36052]
 [ 4106  3776 36452]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999998
{'0': {'precision': 0.31953320366768545, 'recall': 0.10409123823316438, 'f1-score': 0.15702874308732165, 'support': 11048}, '1': {'precision': 0.3588325652841782, 'recall': 0.08682078346837137, 'f1-score': 0.13981326310749342, 'support': 13453}, '2': {'precision': 0.3466054444080026, 'recall': 0.8228607023281165, 'f1-score': 0.48775759813537023, 'support': 12843}, 'accuracy': 0.34506212510711226, 'macro avg': {'precision': 0.3416570711199554, 'recall': 0.33792424134321736, 'f1-score': 0.2615332014433951, 'support': 37344}, 'weighted avg': {'precision': 0.3430010458820859, 'recall': 0.34506212510711226, 'f1-score': 0.2645681291523778, 'support': 37344}}
[[ 1150   923  8975]
 [ 1338  1168 10947]
 [ 1111  1164 10568]]
training model: results/PCAR/W7/deepLOB_L2/h10
Epoch 1/50
526/526 - 28s - loss: 3.3188 - accuracy10: 0.3608 - val_loss: 3.3704 - val_accuracy10: 0.3452 - 28s/epoch - 53ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2473 - accuracy10: 0.4001 - val_loss: 3.3144 - val_accuracy10: 0.3445 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2110 - accuracy10: 0.4222 - val_loss: 3.2528 - val_accuracy10: 0.3989 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.1878 - accuracy10: 0.4326 - val_loss: 3.1935 - val_accuracy10: 0.4279 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.1799 - accuracy10: 0.4367 - val_loss: 3.1862 - val_accuracy10: 0.4307 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.1616 - accuracy10: 0.4433 - val_loss: 3.1745 - val_accuracy10: 0.4386 - 24s/epoch - 46ms/step
Epoch 7/50
526/526 - 24s - loss: 3.1553 - accuracy10: 0.4476 - val_loss: 3.1662 - val_accuracy10: 0.4396 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.1477 - accuracy10: 0.4485 - val_loss: 3.1705 - val_accuracy10: 0.4382 - 24s/epoch - 46ms/step
Epoch 9/50
526/526 - 24s - loss: 3.1397 - accuracy10: 0.4524 - val_loss: 3.1628 - val_accuracy10: 0.4416 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.1347 - accuracy10: 0.4534 - val_loss: 3.1633 - val_accuracy10: 0.4422 - 24s/epoch - 45ms/step
Epoch 11/50
526/526 - 24s - loss: 3.1288 - accuracy10: 0.4551 - val_loss: 3.1674 - val_accuracy10: 0.4352 - 24s/epoch - 45ms/step
Epoch 12/50
526/526 - 24s - loss: 3.1246 - accuracy10: 0.4568 - val_loss: 3.1710 - val_accuracy10: 0.4374 - 24s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 3.1165 - accuracy10: 0.4602 - val_loss: 3.1768 - val_accuracy10: 0.4330 - 24s/epoch - 45ms/step
Epoch 14/50
526/526 - 24s - loss: 3.1131 - accuracy10: 0.4605 - val_loss: 3.1603 - val_accuracy10: 0.4396 - 24s/epoch - 46ms/step
Epoch 15/50
526/526 - 24s - loss: 3.1077 - accuracy10: 0.4627 - val_loss: 3.1867 - val_accuracy10: 0.4263 - 24s/epoch - 46ms/step
Epoch 16/50
526/526 - 24s - loss: 3.1034 - accuracy10: 0.4643 - val_loss: 3.1840 - val_accuracy10: 0.4328 - 24s/epoch - 46ms/step
Epoch 17/50
526/526 - 24s - loss: 3.0964 - accuracy10: 0.4664 - val_loss: 3.1772 - val_accuracy10: 0.4343 - 24s/epoch - 46ms/step
Epoch 18/50
526/526 - 24s - loss: 3.0932 - accuracy10: 0.4674 - val_loss: 3.1797 - val_accuracy10: 0.4358 - 24s/epoch - 46ms/step
Epoch 19/50
526/526 - 24s - loss: 3.0868 - accuracy10: 0.4704 - val_loss: 3.1788 - val_accuracy10: 0.4358 - 24s/epoch - 46ms/step
Epoch 20/50
526/526 - 24s - loss: 3.0821 - accuracy10: 0.4712 - val_loss: 3.1807 - val_accuracy10: 0.4354 - 24s/epoch - 45ms/step
Epoch 21/50
526/526 - 24s - loss: 3.0787 - accuracy10: 0.4727 - val_loss: 3.1766 - val_accuracy10: 0.4334 - 24s/epoch - 45ms/step
Epoch 22/50
526/526 - 24s - loss: 3.0726 - accuracy10: 0.4746 - val_loss: 3.1959 - val_accuracy10: 0.4302 - 24s/epoch - 46ms/step
Epoch 23/50
526/526 - 24s - loss: 3.0680 - accuracy10: 0.4765 - val_loss: 3.2004 - val_accuracy10: 0.4293 - 24s/epoch - 46ms/step
Epoch 24/50
526/526 - 24s - loss: 3.0616 - accuracy10: 0.4791 - val_loss: 3.2052 - val_accuracy10: 0.4261 - 24s/epoch - 46ms/step
testing model: results/PCAR/W7/deepLOB_L2/h10
Evaluating performance on  test set...
1646/1646 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0680015
{'0': {'precision': 0.40647932191819786, 'recall': 0.22157276194610687, 'f1-score': 0.2868066147547564, 'support': 128996}, '1': {'precision': 0.42676832483330457, 'recall': 0.5668019706875717, 'f1-score': 0.48691698742007783, 'support': 161365}, '2': {'precision': 0.392108652382625, 'recall': 0.40927561027771836, 'f1-score': 0.40050825921219824, 'support': 130924}, 'accuracy': 0.4121390507613611, 'macro avg': {'precision': 0.4084520997113758, 'recall': 0.39921678097046565, 'f1-score': 0.39141062046234415, 'support': 421285}, 'weighted avg': {'precision': 0.4097846126765226, 'recall': 0.4121390507613611, 'f1-score': 0.3987903891214813, 'support': 421285}}
[[28582 63398 37016]
 [23847 91462 46056]
 [17887 59453 53584]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0595905
{'0': {'precision': 0.46902378859621763, 'recall': 0.3586963592601427, 'f1-score': 0.4065072616912, 'support': 46117}, '1': {'precision': 0.438732313794287, 'recall': 0.2691057100750895, 'f1-score': 0.333594316369436, 'support': 42749}, '2': {'precision': 0.4124606756941595, 'recall': 0.6593562776052827, 'f1-score': 0.5074719800747198, 'support': 45734}, 'accuracy': 0.4323997028231798, 'macro avg': {'precision': 0.4400722593615547, 'recall': 0.4290527823135049, 'f1-score': 0.41585785271178527, 'support': 134600}, 'weighted avg': {'precision': 0.44018435574502546, 'recall': 0.4323997028231798, 'f1-score': 0.4176555895588955, 'support': 134600}}
[[16542  8060 21515]
 [ 9805 11504 21440]
 [ 8922  6657 30155]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0539515
{'0': {'precision': 0.48083963876006836, 'recall': 0.30950510604870385, 'f1-score': 0.3766010323073983, 'support': 12730}, '1': {'precision': 0.42276163100180986, 'recall': 0.3454244954766875, 'f1-score': 0.3802001053185887, 'support': 11496}, '2': {'precision': 0.4312753036437247, 'recall': 0.6494931788735615, 'f1-score': 0.518354064657401, 'support': 13121}, 'accuracy': 0.44000856829196455, 'macro avg': {'precision': 0.44495885780186767, 'recall': 0.4348075934663176, 'f1-score': 0.4250517340944627, 'support': 37347}, 'weighted avg': {'precision': 0.4455490285838698, 'recall': 0.44000856829196455, 'f1-score': 0.4275105158214967, 'support': 37347}}
[[3940 2890 5900]
 [2187 3971 5338]
 [2067 2532 8522]]
training model: results/PCAR/W7/deepLOB_L2/h20
Epoch 1/50
526/526 - 26s - loss: 3.3276 - accuracy20: 0.3528 - val_loss: 3.3606 - val_accuracy20: 0.3362 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2730 - accuracy20: 0.3815 - val_loss: 3.3375 - val_accuracy20: 0.3380 - 24s/epoch - 45ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2415 - accuracy20: 0.4039 - val_loss: 3.3216 - val_accuracy20: 0.3427 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2236 - accuracy20: 0.4142 - val_loss: 3.2949 - val_accuracy20: 0.3576 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2129 - accuracy20: 0.4195 - val_loss: 3.2657 - val_accuracy20: 0.3799 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 25s - loss: 3.2040 - accuracy20: 0.4212 - val_loss: 3.2925 - val_accuracy20: 0.3555 - 25s/epoch - 47ms/step
Epoch 7/50
526/526 - 24s - loss: 3.1976 - accuracy20: 0.4256 - val_loss: 3.2651 - val_accuracy20: 0.3747 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.1903 - accuracy20: 0.4278 - val_loss: 3.2440 - val_accuracy20: 0.3991 - 24s/epoch - 46ms/step
Epoch 9/50
526/526 - 24s - loss: 3.1857 - accuracy20: 0.4299 - val_loss: 3.2564 - val_accuracy20: 0.3981 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.1809 - accuracy20: 0.4318 - val_loss: 3.2398 - val_accuracy20: 0.4052 - 24s/epoch - 46ms/step
Epoch 11/50
526/526 - 24s - loss: 3.1753 - accuracy20: 0.4355 - val_loss: 3.2348 - val_accuracy20: 0.4090 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.1720 - accuracy20: 0.4368 - val_loss: 3.2494 - val_accuracy20: 0.4034 - 24s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 3.1669 - accuracy20: 0.4397 - val_loss: 3.2430 - val_accuracy20: 0.4045 - 24s/epoch - 46ms/step
Epoch 14/50
526/526 - 24s - loss: 3.1622 - accuracy20: 0.4401 - val_loss: 3.2479 - val_accuracy20: 0.3997 - 24s/epoch - 46ms/step
Epoch 15/50
526/526 - 24s - loss: 3.1584 - accuracy20: 0.4426 - val_loss: 3.2648 - val_accuracy20: 0.3964 - 24s/epoch - 47ms/step
Epoch 16/50
526/526 - 24s - loss: 3.1519 - accuracy20: 0.4446 - val_loss: 3.2424 - val_accuracy20: 0.4022 - 24s/epoch - 46ms/step
Epoch 17/50
526/526 - 24s - loss: 3.1466 - accuracy20: 0.4470 - val_loss: 3.2407 - val_accuracy20: 0.4066 - 24s/epoch - 45ms/step
Epoch 18/50
526/526 - 24s - loss: 3.1429 - accuracy20: 0.4472 - val_loss: 3.2585 - val_accuracy20: 0.3933 - 24s/epoch - 46ms/step
Epoch 19/50
526/526 - 24s - loss: 3.1362 - accuracy20: 0.4504 - val_loss: 3.2532 - val_accuracy20: 0.3991 - 24s/epoch - 46ms/step
Epoch 20/50
526/526 - 24s - loss: 3.1320 - accuracy20: 0.4526 - val_loss: 3.2481 - val_accuracy20: 0.4044 - 24s/epoch - 45ms/step
Epoch 21/50
526/526 - 24s - loss: 3.1252 - accuracy20: 0.4546 - val_loss: 3.2597 - val_accuracy20: 0.3990 - 24s/epoch - 46ms/step
testing model: results/PCAR/W7/deepLOB_L2/h20
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798836
{'0': {'precision': 0.3830498903151539, 'recall': 0.2757801077412646, 'f1-score': 0.32068224073897295, 'support': 127899}, '1': {'precision': 0.42424329183797344, 'recall': 0.454823936744917, 'f1-score': 0.4390017005694241, 'support': 162896}, '2': {'precision': 0.3665060007116747, 'recall': 0.43412522032339645, 'f1-score': 0.3974601392713687, 'support': 130490}, 'accuracy': 0.3940562801903699, 'macro avg': {'precision': 0.3912663942882673, 'recall': 0.38824308826985937, 'f1-score': 0.38571469352658855, 'support': 421285}, 'weighted avg': {'precision': 0.39385356996219384, 'recall': 0.3940562801903699, 'f1-score': 0.3902135905568718, 'support': 421285}}
[[35272 52409 40218]
 [31109 74089 57698]
 [25701 48140 56649]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774579
{'0': {'precision': 0.4332159107588434, 'recall': 0.3875054704595186, 'f1-score': 0.4090877590149923, 'support': 45700}, '1': {'precision': 0.3838975205784483, 'recall': 0.3522659442582304, 'f1-score': 0.3674021573862344, 'support': 43558}, '2': {'precision': 0.4077725894368686, 'recall': 0.4834149353800009, 'f1-score': 0.44238357132045014, 'support': 45342}, 'accuracy': 0.4084101040118871, 'macro avg': {'precision': 0.4082953402580534, 'recall': 0.40772878336591667, 'f1-score': 0.40629116257389225, 'support': 134600}, 'weighted avg': {'precision': 0.40868499311502, 'recall': 0.4084101040118871, 'f1-score': 0.40681403899871166, 'support': 134600}}
[[17709 12838 15153]
 [11533 15344 16681]
 [11636 11787 21919]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0797654
{'0': {'precision': 0.4276803118908382, 'recall': 0.3505072290119019, 'f1-score': 0.38526713200755086, 'support': 12519}, '1': {'precision': 0.37386934673366834, 'recall': 0.40803239959500504, 'f1-score': 0.39020454270383664, 'support': 11852}, '2': {'precision': 0.4267241379310345, 'recall': 0.4653976572133169, 'f1-score': 0.44522264818637564, 'support': 12976}, 'accuracy': 0.4086807507965834, 'macro avg': {'precision': 0.409424598851847, 'recall': 0.4079790952734079, 'f1-score': 0.4068981076325877, 'support': 37347}, 'weighted avg': {'precision': 0.41027128647125455, 'recall': 0.4086807507965834, 'f1-score': 0.4076652086806119, 'support': 37347}}
[[4388 4220 3911]
 [2814 4836 4202]
 [3058 3879 6039]]
training model: results/PCAR/W7/deepLOB_L2/h30
Epoch 1/50
526/526 - 26s - loss: 3.3314 - accuracy30: 0.3553 - val_loss: 3.3268 - val_accuracy30: 0.3494 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2841 - accuracy30: 0.3749 - val_loss: 3.3737 - val_accuracy30: 0.3465 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2605 - accuracy30: 0.3906 - val_loss: 3.2622 - val_accuracy30: 0.3903 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2467 - accuracy30: 0.3991 - val_loss: 3.2845 - val_accuracy30: 0.3779 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2378 - accuracy30: 0.4055 - val_loss: 3.2714 - val_accuracy30: 0.3872 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2309 - accuracy30: 0.4083 - val_loss: 3.3107 - val_accuracy30: 0.3802 - 24s/epoch - 46ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2237 - accuracy30: 0.4122 - val_loss: 3.3124 - val_accuracy30: 0.3883 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2163 - accuracy30: 0.4160 - val_loss: 3.3236 - val_accuracy30: 0.3819 - 24s/epoch - 46ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2155 - accuracy30: 0.4152 - val_loss: 3.3104 - val_accuracy30: 0.3862 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.2094 - accuracy30: 0.4180 - val_loss: 3.3227 - val_accuracy30: 0.3845 - 24s/epoch - 45ms/step
Epoch 11/50
526/526 - 24s - loss: 3.2033 - accuracy30: 0.4204 - val_loss: 3.3757 - val_accuracy30: 0.3778 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.1994 - accuracy30: 0.4234 - val_loss: 3.3538 - val_accuracy30: 0.3765 - 24s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 3.1922 - accuracy30: 0.4275 - val_loss: 3.3279 - val_accuracy30: 0.3768 - 24s/epoch - 46ms/step
testing model: results/PCAR/W7/deepLOB_L2/h30
Evaluating performance on  test set...
1646/1646 - 35s - 35s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1081572
{'0': {'precision': 0.29054974475967815, 'recall': 0.5597824112753823, 'f1-score': 0.38254377554155067, 'support': 110116}, '1': {'precision': 0.5237573224624028, 'recall': 0.1563868090503662, 'f1-score': 0.2408569965735891, 'support': 195528}, '2': {'precision': 0.30543283582089553, 'recall': 0.3981632811891976, 'f1-score': 0.34568735430251024, 'support': 115641}, 'accuracy': 0.32819350321041574, 'macro avg': {'precision': 0.3732466343476588, 'recall': 0.3714441671716487, 'f1-score': 0.32302937547255, 'support': 421285}, 'weighted avg': {'precision': 0.4028720604995421, 'recall': 0.32819350321041574, 'f1-score': 0.3066667660905817, 'support': 421285}}
[[61641 14194 34281]
 [94525 30578 70425]
 [55987 13610 46044]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0923661
{'0': {'precision': 0.39052631578947367, 'recall': 0.4427011976841826, 'f1-score': 0.41498021832342524, 'support': 45254}, '1': {'precision': 0.41254896053028023, 'recall': 0.12336974884559072, 'f1-score': 0.18993948431620744, 'support': 44395}, '2': {'precision': 0.3719581857648806, 'recall': 0.5794309359079887, 'f1-score': 0.45307240704500973, 'support': 44951}, 'accuracy': 0.38303863298662705, 'macro avg': {'precision': 0.39167782069487816, 'recall': 0.3818339608125873, 'f1-score': 0.35266403656154743, 'support': 134600}, 'weighted avg': {'precision': 0.3915890149019003, 'recall': 0.38303863298662705, 'f1-score': 0.35347649313006346, 'support': 134600}}
[[20034  4192 21028]
 [15968  5477 22950]
 [15298  3607 26046]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867052
{'0': {'precision': 0.38119388664245085, 'recall': 0.45304227417121445, 'f1-score': 0.4140241179097812, 'support': 12277}, '1': {'precision': 0.42646753785521674, 'recall': 0.16665315716949014, 'f1-score': 0.239654971441893, 'support': 12337}, '2': {'precision': 0.3904098132143853, 'recall': 0.549909683499568, 'f1-score': 0.4566323203338985, 'support': 12733}, 'accuracy': 0.39146383913031835, 'macro avg': {'precision': 0.3993570792373509, 'recall': 0.3898683716134242, 'f1-score': 0.3701038032285242, 'support': 37347}, 'weighted avg': {'precision': 0.39929138920095175, 'recall': 0.39146383913031835, 'f1-score': 0.37095072731594364, 'support': 37347}}
[[5562 1439 5276]
 [4624 2056 5657]
 [4405 1326 7002]]
training model: results/PCAR/W7/deepLOB_L2/h50
Epoch 1/50
526/526 - 26s - loss: 3.3362 - accuracy50: 0.3486 - val_loss: 3.3799 - val_accuracy50: 0.3372 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2953 - accuracy50: 0.3585 - val_loss: 3.4058 - val_accuracy50: 0.3362 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2753 - accuracy50: 0.3749 - val_loss: 3.3755 - val_accuracy50: 0.3370 - 24s/epoch - 45ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2607 - accuracy50: 0.3868 - val_loss: 3.3481 - val_accuracy50: 0.3405 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2505 - accuracy50: 0.3960 - val_loss: 3.3980 - val_accuracy50: 0.3369 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2433 - accuracy50: 0.4017 - val_loss: 3.3687 - val_accuracy50: 0.3359 - 24s/epoch - 45ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2400 - accuracy50: 0.4001 - val_loss: 3.3730 - val_accuracy50: 0.3387 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2351 - accuracy50: 0.4041 - val_loss: 3.4003 - val_accuracy50: 0.3378 - 24s/epoch - 45ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2296 - accuracy50: 0.4068 - val_loss: 3.3899 - val_accuracy50: 0.3390 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 25s - loss: 3.2245 - accuracy50: 0.4117 - val_loss: 3.3400 - val_accuracy50: 0.3486 - 25s/epoch - 47ms/step
Epoch 11/50
526/526 - 24s - loss: 3.2210 - accuracy50: 0.4120 - val_loss: 3.3533 - val_accuracy50: 0.3475 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.2179 - accuracy50: 0.4149 - val_loss: 3.3400 - val_accuracy50: 0.3558 - 24s/epoch - 46ms/step
Epoch 13/50
526/526 - 24s - loss: 3.2123 - accuracy50: 0.4180 - val_loss: 3.3349 - val_accuracy50: 0.3594 - 24s/epoch - 46ms/step
Epoch 14/50
526/526 - 24s - loss: 3.2094 - accuracy50: 0.4181 - val_loss: 3.3311 - val_accuracy50: 0.3585 - 24s/epoch - 46ms/step
Epoch 15/50
526/526 - 24s - loss: 3.2037 - accuracy50: 0.4216 - val_loss: 3.3350 - val_accuracy50: 0.3636 - 24s/epoch - 46ms/step
Epoch 16/50
526/526 - 24s - loss: 3.2011 - accuracy50: 0.4231 - val_loss: 3.3532 - val_accuracy50: 0.3648 - 24s/epoch - 46ms/step
Epoch 17/50
526/526 - 24s - loss: 3.1956 - accuracy50: 0.4253 - val_loss: 3.3383 - val_accuracy50: 0.3691 - 24s/epoch - 45ms/step
Epoch 18/50
526/526 - 24s - loss: 3.1905 - accuracy50: 0.4274 - val_loss: 3.3330 - val_accuracy50: 0.3684 - 24s/epoch - 46ms/step
Epoch 19/50
526/526 - 24s - loss: 3.1867 - accuracy50: 0.4295 - val_loss: 3.3467 - val_accuracy50: 0.3643 - 24s/epoch - 46ms/step
Epoch 20/50
526/526 - 24s - loss: 3.1827 - accuracy50: 0.4304 - val_loss: 3.3427 - val_accuracy50: 0.3666 - 24s/epoch - 45ms/step
Epoch 21/50
526/526 - 24s - loss: 3.1793 - accuracy50: 0.4313 - val_loss: 3.3562 - val_accuracy50: 0.3605 - 24s/epoch - 45ms/step
Epoch 22/50
526/526 - 24s - loss: 3.1739 - accuracy50: 0.4340 - val_loss: 3.3653 - val_accuracy50: 0.3642 - 24s/epoch - 46ms/step
Epoch 23/50
526/526 - 24s - loss: 3.1706 - accuracy50: 0.4352 - val_loss: 3.3601 - val_accuracy50: 0.3614 - 24s/epoch - 45ms/step
Epoch 24/50
526/526 - 24s - loss: 3.1631 - accuracy50: 0.4396 - val_loss: 3.4091 - val_accuracy50: 0.3627 - 24s/epoch - 45ms/step
testing model: results/PCAR/W7/deepLOB_L2/h50
Evaluating performance on  test set...
1646/1646 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014119
{'0': {'precision': 0.30060343002329026, 'recall': 0.2793843933716516, 'f1-score': 0.2896057591378292, 'support': 121961}, '1': {'precision': 0.40490057359077447, 'recall': 0.5925676072036136, 'f1-score': 0.48107993551628647, 'support': 170470}, '2': {'precision': 0.31872305481420654, 'recall': 0.14458224036506434, 'f1-score': 0.19892582191707686, 'support': 128854}, 'accuracy': 0.3648812561567585, 'macro avg': {'precision': 0.3414090194760904, 'recall': 0.33884474698010986, 'f1-score': 0.32320383885706416, 'support': 421285}, 'weighted avg': {'precision': 0.34834859112980426, 'recall': 0.3648812561567585, 'f1-score': 0.3393491162870104, 'support': 421285}}
[[ 34074  72500  15387]
 [ 45020 101015  24435]
 [ 34258  75966  18630]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052896
{'0': {'precision': 0.3816208458537023, 'recall': 0.3747137572661617, 'f1-score': 0.3781357626930341, 'support': 45416}, '1': {'precision': 0.35942861972783363, 'recall': 0.4790896800360523, 'f1-score': 0.4107210122180905, 'support': 44380}, '2': {'precision': 0.3776862986613076, 'recall': 0.2600660655298634, 'f1-score': 0.30802987244729363, 'support': 44804}, 'accuracy': 0.37096582466567607, 'macro avg': {'precision': 0.37291192141428114, 'recall': 0.3712898342773591, 'f1-score': 0.36562888245280606, 'support': 134600}, 'weighted avg': {'precision': 0.37299399260055144, 'recall': 0.37096582466567607, 'f1-score': 0.36554370524393937, 'support': 134600}}
[[17018 18973  9425]
 [13344 21262  9774]
 [14232 18920 11652]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1104445
{'0': {'precision': 0.38454449710373884, 'recall': 0.24055011117516265, 'f1-score': 0.2959623081209788, 'support': 12143}, '1': {'precision': 0.35234611221023554, 'recall': 0.7504372714262999, 'f1-score': 0.4795386999263342, 'support': 12578}, '2': {'precision': 0.3865631330182309, 'recall': 0.09068588626643434, 'f1-score': 0.14690787785476006, 'support': 12626}, 'accuracy': 0.361608696816344, 'macro avg': {'precision': 0.37448458077740177, 'recall': 0.360557756289299, 'f1-score': 0.3074696286340244, 'support': 37347}, 'weighted avg': {'precision': 0.37438293156610236, 'recall': 0.361608696816344, 'f1-score': 0.30739729940773497, 'support': 37347}}
[[2921 8426  796]
 [2118 9439 1021]
 [2557 8924 1145]]
training model: results/PCAR/W7/deepLOB_L2/h100
Epoch 1/50
526/526 - 26s - loss: 3.3313 - accuracy100: 0.3552 - val_loss: 3.5229 - val_accuracy100: 0.3232 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2936 - accuracy100: 0.3680 - val_loss: 3.4105 - val_accuracy100: 0.3278 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2754 - accuracy100: 0.3737 - val_loss: 3.3412 - val_accuracy100: 0.3368 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2620 - accuracy100: 0.3824 - val_loss: 3.2962 - val_accuracy100: 0.3569 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2480 - accuracy100: 0.3927 - val_loss: 3.2954 - val_accuracy100: 0.3638 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2428 - accuracy100: 0.3976 - val_loss: 3.2974 - val_accuracy100: 0.3650 - 24s/epoch - 46ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2348 - accuracy100: 0.4027 - val_loss: 3.3201 - val_accuracy100: 0.3641 - 24s/epoch - 45ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2270 - accuracy100: 0.4079 - val_loss: 3.3374 - val_accuracy100: 0.3546 - 24s/epoch - 45ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2225 - accuracy100: 0.4096 - val_loss: 3.3599 - val_accuracy100: 0.3586 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.2169 - accuracy100: 0.4133 - val_loss: 3.3635 - val_accuracy100: 0.3614 - 24s/epoch - 46ms/step
Epoch 11/50
526/526 - 24s - loss: 3.2094 - accuracy100: 0.4177 - val_loss: 3.3439 - val_accuracy100: 0.3583 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.2056 - accuracy100: 0.4198 - val_loss: 3.3422 - val_accuracy100: 0.3539 - 24s/epoch - 46ms/step
Epoch 13/50
526/526 - 24s - loss: 3.2026 - accuracy100: 0.4230 - val_loss: 3.3398 - val_accuracy100: 0.3539 - 24s/epoch - 45ms/step
Epoch 14/50
526/526 - 24s - loss: 3.1969 - accuracy100: 0.4240 - val_loss: 3.3353 - val_accuracy100: 0.3506 - 24s/epoch - 45ms/step
Epoch 15/50
526/526 - 24s - loss: 3.1899 - accuracy100: 0.4261 - val_loss: 3.3655 - val_accuracy100: 0.3338 - 24s/epoch - 45ms/step
testing model: results/PCAR/W7/deepLOB_L2/h100
Evaluating performance on  test set...
1646/1646 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0752646
{'0': {'precision': 0.2984894453465516, 'recall': 0.25235957694704614, 'f1-score': 0.27349297939087835, 'support': 110719}, '1': {'precision': 0.4987920107229733, 'recall': 0.6379365079365079, 'f1-score': 0.5598480697616106, 'support': 189000}, '2': {'precision': 0.33526462136283786, 'recall': 0.23704818781567213, 'f1-score': 0.2777287862798105, 'support': 121566}, 'accuracy': 0.42092170383469624, 'macro avg': {'precision': 0.37751535914412093, 'recall': 0.3757814242330754, 'f1-score': 0.37035661181076646, 'support': 421285}, 'weighted avg': {'precision': 0.39896251204424926, 'recall': 0.42092170383469624, 'f1-score': 0.4031820074368053, 'support': 421285}}
[[ 27941  57856  24922]
 [ 36216 120570  32214]
 [ 29451  63298  28817]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988834
{'0': {'precision': 0.35156115971864815, 'recall': 0.36534218795266643, 'f1-score': 0.3583192175290968, 'support': 44873}, '1': {'precision': 0.41930582593419113, 'recall': 0.19688322111740314, 'f1-score': 0.26795114920731244, 'support': 44854}, '2': {'precision': 0.3475421106909591, 'recall': 0.5181957970271656, 'f1-score': 0.41604938271604935, 'support': 44873}, 'accuracy': 0.36016344725111443, 'macro avg': {'precision': 0.3728030321145995, 'recall': 0.3601404020324117, 'f1-score': 0.34743991648415284, 'support': 134600}, 'weighted avg': {'precision': 0.3727964678272104, 'recall': 0.36016344725111443, 'f1-score': 0.3474511370382261, 'support': 134600}}
[[16394  6110 22369]
 [14738  8831 21285]
 [15500  6120 23253]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09801
{'0': {'precision': 0.335423197492163, 'recall': 0.22712058127194057, 'f1-score': 0.2708465170617728, 'support': 12249}, '1': {'precision': 0.3929547525053143, 'recall': 0.3164072051511941, 'f1-score': 0.3505508398049485, 'support': 12269}, '2': {'precision': 0.35965369771565664, 'recall': 0.5375321537142411, 'f1-score': 0.4309595975377308, 'support': 12829}, 'accuracy': 0.3630813719977508, 'macro avg': {'precision': 0.362677215904378, 'recall': 0.36035331337912524, 'f1-score': 0.35078565146815066, 'support': 37347}, 'weighted avg': {'precision': 0.3626464747520112, 'recall': 0.3630813719977508, 'f1-score': 0.3520306294446171, 'support': 37347}}
[[2782 2914 6553]
 [2662 3882 5725]
 [2850 3083 6896]]
training model: results/PCAR/W7/deepLOB_L2/h200
Epoch 1/50
526/526 - 27s - loss: 3.3401 - accuracy200: 0.3494 - val_loss: 3.4019 - val_accuracy200: 0.3434 - 27s/epoch - 52ms/step
Epoch 2/50
526/526 - 24s - loss: 3.3099 - accuracy200: 0.3557 - val_loss: 3.4706 - val_accuracy200: 0.3410 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2916 - accuracy200: 0.3612 - val_loss: 3.3306 - val_accuracy200: 0.3562 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2794 - accuracy200: 0.3711 - val_loss: 3.3388 - val_accuracy200: 0.3556 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2701 - accuracy200: 0.3815 - val_loss: 3.3886 - val_accuracy200: 0.3508 - 24s/epoch - 45ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2650 - accuracy200: 0.3861 - val_loss: 3.3943 - val_accuracy200: 0.3507 - 24s/epoch - 45ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2573 - accuracy200: 0.3928 - val_loss: 3.3539 - val_accuracy200: 0.3505 - 24s/epoch - 45ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2502 - accuracy200: 0.3975 - val_loss: 3.3976 - val_accuracy200: 0.3537 - 24s/epoch - 45ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2437 - accuracy200: 0.4013 - val_loss: 3.3892 - val_accuracy200: 0.3492 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.2379 - accuracy200: 0.4072 - val_loss: 3.3999 - val_accuracy200: 0.3474 - 24s/epoch - 46ms/step
Epoch 11/50
526/526 - 24s - loss: 3.2320 - accuracy200: 0.4114 - val_loss: 3.3780 - val_accuracy200: 0.3399 - 24s/epoch - 45ms/step
Epoch 12/50
526/526 - 24s - loss: 3.2236 - accuracy200: 0.4172 - val_loss: 3.3727 - val_accuracy200: 0.3448 - 24s/epoch - 46ms/step
Epoch 13/50
526/526 - 24s - loss: 3.2169 - accuracy200: 0.4184 - val_loss: 3.3706 - val_accuracy200: 0.3402 - 24s/epoch - 45ms/step
testing model: results/PCAR/W7/deepLOB_L2/h200
Evaluating performance on  test set...
1646/1646 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0893655
{'0': {'precision': 0.2762847017129356, 'recall': 0.13452689099798676, 'f1-score': 0.18094777562862668, 'support': 111264}, '1': {'precision': 0.4619259565952455, 'recall': 0.6489927825056555, 'f1-score': 0.5397093438624703, 'support': 185660}, '2': {'precision': 0.32606199770378874, 'recall': 0.2786082453502304, 'f1-score': 0.3004730664330964, 'support': 124361}, 'accuracy': 0.4037836618915936, 'macro avg': {'precision': 0.35475755200399, 'recall': 0.3540426396179575, 'f1-score': 0.34037672864139773, 'support': 421285}, 'weighted avg': {'precision': 0.37279065300046815, 'recall': 0.4037836618915936, 'f1-score': 0.3743369479182408, 'support': 421285}}
[[ 14968  67257  29039]
 [ 22593 120492  42575]
 [ 16615  73098  34648]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093559
{'0': {'precision': 0.3445177282988801, 'recall': 0.17139019180374798, 'f1-score': 0.22890503220493513, 'support': 45411}, '1': {'precision': 0.35412972061516995, 'recall': 0.5510144075271979, 'f1-score': 0.43115913173520226, 'support': 44213}, '2': {'precision': 0.34541247252111534, 'recall': 0.33188811810743507, 'f1-score': 0.33851526799786824, 'support': 44976}, 'accuracy': 0.3497176820208024, 'macro avg': {'precision': 0.3480199738117218, 'recall': 0.3514309058127936, 'f1-score': 0.3328598106460019, 'support': 134600}, 'weighted avg': {'precision': 0.3479740212589052, 'recall': 0.3497176820208024, 'f1-score': 0.33196662557458345, 'support': 134600}}
[[ 7783 22228 15400]
 [ 6963 24362 12888]
 [ 7845 22204 14927]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109494
{'0': {'precision': 0.3204239706481859, 'recall': 0.13395824456753302, 'f1-score': 0.18893095366864973, 'support': 11735}, '1': {'precision': 0.3687515699572972, 'recall': 0.6670200681560016, 'f1-score': 0.4749400124019305, 'support': 13205}, '2': {'precision': 0.3526592635885447, 'recall': 0.2431691786894495, 'f1-score': 0.28785421238431447, 'support': 12407}, 'accuracy': 0.3587168982783088, 'macro avg': {'precision': 0.347278268064676, 'recall': 0.348049163804328, 'f1-score': 0.3172417261516316, 'support': 37347}, 'weighted avg': {'precision': 0.3482202923979342, 'recall': 0.3587168982783088, 'f1-score': 0.3229200422556373, 'support': 37347}}
[[1572 7341 2822]
 [1681 8808 2716]
 [1653 7737 3017]]
training model: results/PCAR/W7/deepLOB_L2/h300
Epoch 1/50
526/526 - 26s - loss: 3.3413 - accuracy300: 0.3521 - val_loss: 3.3677 - val_accuracy300: 0.3435 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.3120 - accuracy300: 0.3577 - val_loss: 3.4179 - val_accuracy300: 0.3521 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2940 - accuracy300: 0.3656 - val_loss: 3.3450 - val_accuracy300: 0.3533 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2810 - accuracy300: 0.3740 - val_loss: 3.4904 - val_accuracy300: 0.3561 - 24s/epoch - 45ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2675 - accuracy300: 0.3849 - val_loss: 3.3754 - val_accuracy300: 0.3565 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2570 - accuracy300: 0.3952 - val_loss: 3.4579 - val_accuracy300: 0.3565 - 24s/epoch - 45ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2484 - accuracy300: 0.4018 - val_loss: 3.4222 - val_accuracy300: 0.3572 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2396 - accuracy300: 0.4063 - val_loss: 3.3929 - val_accuracy300: 0.3548 - 24s/epoch - 45ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2316 - accuracy300: 0.4113 - val_loss: 3.3762 - val_accuracy300: 0.3544 - 24s/epoch - 45ms/step
Epoch 10/50
526/526 - 24s - loss: 3.2225 - accuracy300: 0.4160 - val_loss: 3.4514 - val_accuracy300: 0.3563 - 24s/epoch - 46ms/step
Epoch 11/50
526/526 - 24s - loss: 3.2162 - accuracy300: 0.4195 - val_loss: 3.4390 - val_accuracy300: 0.3567 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.2115 - accuracy300: 0.4212 - val_loss: 3.4862 - val_accuracy300: 0.3566 - 24s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 3.2041 - accuracy300: 0.4252 - val_loss: 3.4825 - val_accuracy300: 0.3554 - 24s/epoch - 46ms/step
testing model: results/PCAR/W7/deepLOB_L2/h300
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926887
{'0': {'precision': 0.2707060905302814, 'recall': 0.08457573920176908, 'f1-score': 0.12888454064924654, 'support': 112148}, '1': {'precision': 0.42788453828678336, 'recall': 0.8907466240840376, 'f1-score': 0.578079327795421, 'support': 179729}, '2': {'precision': 0.29833843101595436, 'recall': 0.027888538575667657, 'f1-score': 0.051008798275679314, 'support': 129408}, 'accuracy': 0.4110922534626203, 'macro avg': {'precision': 0.33230968661100635, 'recall': 0.3344036339538248, 'f1-score': 0.25265755557344893, 'support': 421285}, 'weighted avg': {'precision': 0.3462496564165539, 'recall': 0.4110922534626203, 'f1-score': 0.29659899957827607, 'support': 421285}}
[[  9485  99150   3513]
 [ 14661 160093   4975]
 [ 10892 114907   3609]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1130786
{'0': {'precision': 0.3380698996251058, 'recall': 0.12317419752814435, 'f1-score': 0.18056161087697203, 'support': 45391}, '1': {'precision': 0.33788831573770833, 'recall': 0.7267305788099739, 'f1-score': 0.46129891649822513, 'support': 44436}, '2': {'precision': 0.34154475521366, 'recall': 0.17155428494851807, 'f1-score': 0.22839047307543633, 'support': 44773}, 'accuracy': 0.3385215453194651, 'macro avg': {'precision': 0.3391676568588247, 'recall': 0.3404863537622121, 'f1-score': 0.29008366681687786, 'support': 134600}, 'weighted avg': {'precision': 0.3391658197413461, 'recall': 0.3385215453194651, 'f1-score': 0.28915213509538096, 'support': 134600}}
[[ 5591 31811  7989]
 [ 5324 32293  6819]
 [ 5623 31469  7681]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1144879
{'0': {'precision': 0.3139337298215803, 'recall': 0.06367944851357174, 'f1-score': 0.10588151013682928, 'support': 11605}, '1': {'precision': 0.35764201003276597, 'recall': 0.9242412888722368, 'f1-score': 0.5157216925907342, 'support': 13345}, '2': {'precision': 0.37549407114624506, 'recall': 0.015326288618214085, 'f1-score': 0.02945051538401922, 'support': 12397}, 'accuracy': 0.35512892601815405, 'macro avg': {'precision': 0.3490232703335305, 'recall': 0.33441567533467426, 'f1-score': 0.21701790603719426, 'support': 37347}, 'weighted avg': {'precision': 0.3499861718067503, 'recall': 0.35512892601815405, 'f1-score': 0.22695688949519208, 'support': 37347}}
[[  739 10740   126]
 [  821 12334   190]
 [  794 11413   190]]
training model: results/PCAR/W7/deepLOB_L2/h500
Epoch 1/50
526/526 - 26s - loss: 3.3408 - accuracy500: 0.3550 - val_loss: 3.3852 - val_accuracy500: 0.3405 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.3077 - accuracy500: 0.3674 - val_loss: 3.3770 - val_accuracy500: 0.3542 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2958 - accuracy500: 0.3657 - val_loss: 3.3414 - val_accuracy500: 0.3560 - 24s/epoch - 46ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2740 - accuracy500: 0.3821 - val_loss: 3.3665 - val_accuracy500: 0.3576 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2596 - accuracy500: 0.3923 - val_loss: 3.3180 - val_accuracy500: 0.3401 - 24s/epoch - 46ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2398 - accuracy500: 0.4047 - val_loss: 3.3917 - val_accuracy500: 0.3395 - 24s/epoch - 46ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2283 - accuracy500: 0.4112 - val_loss: 3.4000 - val_accuracy500: 0.3386 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.2170 - accuracy500: 0.4180 - val_loss: 3.4549 - val_accuracy500: 0.3514 - 24s/epoch - 46ms/step
Epoch 9/50
526/526 - 24s - loss: 3.2055 - accuracy500: 0.4235 - val_loss: 3.5063 - val_accuracy500: 0.3422 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.1924 - accuracy500: 0.4312 - val_loss: 3.4776 - val_accuracy500: 0.3404 - 24s/epoch - 45ms/step
Epoch 11/50
526/526 - 24s - loss: 3.1799 - accuracy500: 0.4384 - val_loss: 3.5426 - val_accuracy500: 0.3397 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.1747 - accuracy500: 0.4391 - val_loss: 3.6507 - val_accuracy500: 0.3233 - 24s/epoch - 45ms/step
Epoch 13/50
526/526 - 24s - loss: 3.1642 - accuracy500: 0.4447 - val_loss: 3.6544 - val_accuracy500: 0.3149 - 24s/epoch - 46ms/step
Epoch 14/50
526/526 - 24s - loss: 3.1542 - accuracy500: 0.4478 - val_loss: 3.7727 - val_accuracy500: 0.3169 - 24s/epoch - 46ms/step
Epoch 15/50
526/526 - 24s - loss: 3.1454 - accuracy500: 0.4513 - val_loss: 3.6849 - val_accuracy500: 0.3295 - 24s/epoch - 45ms/step
testing model: results/PCAR/W7/deepLOB_L2/h500
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046937
{'0': {'precision': 0.2683067019197609, 'recall': 0.603552511904125, 'f1-score': 0.37147553489546314, 'support': 112146}, '1': {'precision': 0.44042270309921144, 'recall': 0.3213431529417012, 'f1-score': 0.37157564603002186, 'support': 179369}, '2': {'precision': 0.31264747522416236, 'recall': 0.09189334977267473, 'f1-score': 0.1420386869312497, 'support': 129770}, 'accuracy': 0.3257889552203378, 'macro avg': {'precision': 0.34045896008104487, 'recall': 0.3389296715395003, 'f1-score': 0.2950299559522449, 'support': 421285}, 'weighted avg': {'precision': 0.35524636786388203, 'recall': 0.3257889552203378, 'f1-score': 0.30084386529834645, 'support': 421285}}
[[ 67686  34031  10429]
 [105942  57639  15788]
 [ 78643  39202  11925]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077167
{'0': {'precision': 0.34099978676089804, 'recall': 0.4946749745901277, 'f1-score': 0.40370744373918055, 'support': 45258}, '1': {'precision': 0.36482845338602476, 'recall': 0.3650579671070369, 'f1-score': 0.3649431741610889, 'support': 44508}, '2': {'precision': 0.3460876689881196, 'recall': 0.18842842485613598, 'f1-score': 0.24400670094159782, 'support': 44834}, 'accuracy': 0.3498068350668648, 'macro avg': {'precision': 0.3506386363783475, 'recall': 0.3493871221844335, 'f1-score': 0.33755243961395576, 'support': 134600}, 'weighted avg': {'precision': 0.3505739056756558, 'recall': 0.3498068350668648, 'f1-score': 0.33769449267700724, 'support': 134600}}
[[22388 14440  8430]
 [20728 16248  7532]
 [22538 13848  8448]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048908
{'0': {'precision': 0.3131281988037245, 'recall': 0.44819064430714917, 'f1-score': 0.3686789850074418, 'support': 11330}, '1': {'precision': 0.37497327346589693, 'recall': 0.5187458404200251, 'f1-score': 0.4352952126834414, 'support': 13523}, '2': {'precision': 0.3389760528488852, 'recall': 0.06571154153993918, 'f1-score': 0.11008313220702601, 'support': 12494}, 'accuracy': 0.34578413259431817, 'macro avg': {'precision': 0.34235917503950225, 'recall': 0.34421600875570446, 'f1-score': 0.3046857766326364, 'support': 37347}, 'weighted avg': {'precision': 0.34416881874901584, 'recall': 0.34578413259431817, 'f1-score': 0.30628989517356353, 'support': 37347}}
[[5078 5484  768]
 [5675 7015  833]
 [5464 6209  821]]
training model: results/PCAR/W7/deepLOB_L2/h1000
Epoch 1/50
526/526 - 26s - loss: 3.3340 - accuracy1000: 0.3667 - val_loss: 3.3747 - val_accuracy1000: 0.3428 - 26s/epoch - 50ms/step
Epoch 2/50
526/526 - 24s - loss: 3.2931 - accuracy1000: 0.3791 - val_loss: 3.3248 - val_accuracy1000: 0.3403 - 24s/epoch - 46ms/step
Epoch 3/50
526/526 - 24s - loss: 3.2843 - accuracy1000: 0.3788 - val_loss: 3.3615 - val_accuracy1000: 0.3372 - 24s/epoch - 45ms/step
Epoch 4/50
526/526 - 24s - loss: 3.2646 - accuracy1000: 0.3878 - val_loss: 3.3203 - val_accuracy1000: 0.3191 - 24s/epoch - 46ms/step
Epoch 5/50
526/526 - 24s - loss: 3.2472 - accuracy1000: 0.3949 - val_loss: 3.3613 - val_accuracy1000: 0.3280 - 24s/epoch - 45ms/step
Epoch 6/50
526/526 - 24s - loss: 3.2260 - accuracy1000: 0.4051 - val_loss: 3.4143 - val_accuracy1000: 0.3308 - 24s/epoch - 46ms/step
Epoch 7/50
526/526 - 24s - loss: 3.2036 - accuracy1000: 0.4162 - val_loss: 3.4033 - val_accuracy1000: 0.3241 - 24s/epoch - 46ms/step
Epoch 8/50
526/526 - 24s - loss: 3.1953 - accuracy1000: 0.4233 - val_loss: 3.3898 - val_accuracy1000: 0.3178 - 24s/epoch - 46ms/step
Epoch 9/50
526/526 - 24s - loss: 3.1776 - accuracy1000: 0.4330 - val_loss: 3.3604 - val_accuracy1000: 0.3338 - 24s/epoch - 46ms/step
Epoch 10/50
526/526 - 24s - loss: 3.1620 - accuracy1000: 0.4392 - val_loss: 3.3809 - val_accuracy1000: 0.3257 - 24s/epoch - 45ms/step
Epoch 11/50
526/526 - 24s - loss: 3.1413 - accuracy1000: 0.4487 - val_loss: 3.3871 - val_accuracy1000: 0.3254 - 24s/epoch - 46ms/step
Epoch 12/50
526/526 - 24s - loss: 3.1261 - accuracy1000: 0.4543 - val_loss: 3.3728 - val_accuracy1000: 0.3329 - 24s/epoch - 46ms/step
Epoch 13/50
526/526 - 24s - loss: 3.1233 - accuracy1000: 0.4539 - val_loss: 3.4125 - val_accuracy1000: 0.3293 - 24s/epoch - 46ms/step
Epoch 14/50
526/526 - 24s - loss: 3.1224 - accuracy1000: 0.4543 - val_loss: 3.3709 - val_accuracy1000: 0.3376 - 24s/epoch - 46ms/step
testing model: results/PCAR/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
1646/1646 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107453
{'0': {'precision': 0.25853667291866717, 'recall': 0.5296550963376967, 'f1-score': 0.3474668773330599, 'support': 108784}, '1': {'precision': 0.42417050899557, 'recall': 0.21147821775483988, 'f1-score': 0.28224023581429625, 'support': 177484}, '2': {'precision': 0.3187701823804976, 'recall': 0.259552500796196, 'f1-score': 0.28612952741761644, 'support': 135017}, 'accuracy': 0.3090449458205253, 'macro avg': {'precision': 0.3338257880982449, 'recall': 0.3335619382962442, 'f1-score': 0.3052788801883242, 'support': 421285}, 'weighted avg': {'precision': 0.3476210303234667, 'recall': 0.3090449458205253, 'f1-score': 0.3003294995084289, 'support': 421285}}
[[57618 22892 28274]
 [93333 37534 46617]
 [71911 28062 35044]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109384
{'0': {'precision': 0.3302572300537713, 'recall': 0.6045758879084823, 'f1-score': 0.4271683453688185, 'support': 45106}, '1': {'precision': 0.35402716064835094, 'recall': 0.12527681814155373, 'f1-score': 0.1850658378997301, 'support': 45156}, '2': {'precision': 0.32846958306749147, 'recall': 0.2670621137624611, 'f1-score': 0.2945998731138119, 'support': 44338}, 'accuracy': 0.3326002971768202, 'macro avg': {'precision': 0.3375846579232045, 'recall': 0.33230493993749904, 'f1-score': 0.30227801879412014, 'support': 134600}, 'weighted avg': {'precision': 0.33764277458461206, 'recall': 0.3326002971768202, 'f1-score': 0.302278287789943, 'support': 134600}}
[[27270  5365 12471]
 [27762  5657 11737]
 [27540  4957 11841]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063722
{'0': {'precision': 0.30056347647912574, 'recall': 0.6367911730125713, 'f1-score': 0.4083751413740104, 'support': 11057}, '1': {'precision': 0.3789742051589682, 'recall': 0.18796489140136863, 'f1-score': 0.25129276054097055, 'support': 13444}, '2': {'precision': 0.3336550392940852, 'recall': 0.18838548964658258, 'f1-score': 0.24080800039802974, 'support': 12846}, 'accuracy': 0.32098963772190536, 'macro avg': {'precision': 0.33773090697739305, 'recall': 0.33771385135350745, 'f1-score': 0.3001586341043369, 'support': 37347}, 'weighted avg': {'precision': 0.3401716927292334, 'recall': 0.32098963772190536, 'f1-score': 0.2941923952124222, 'support': 37347}}
[[7041 1868 2148]
 [8232 2527 2685]
 [8153 2273 2420]]
training model: results/PCAR/W7/deepOF_L2/h10
Epoch 1/50
526/526 - 17s - loss: 3.2949 - accuracy10: 0.3710 - val_loss: 3.2338 - val_accuracy10: 0.4028 - 17s/epoch - 33ms/step
Epoch 2/50
526/526 - 15s - loss: 3.2255 - accuracy10: 0.4082 - val_loss: 3.2050 - val_accuracy10: 0.4177 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.1946 - accuracy10: 0.4250 - val_loss: 3.1885 - val_accuracy10: 0.4250 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.1728 - accuracy10: 0.4337 - val_loss: 3.1795 - val_accuracy10: 0.4297 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.1583 - accuracy10: 0.4423 - val_loss: 3.1659 - val_accuracy10: 0.4364 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.1451 - accuracy10: 0.4482 - val_loss: 3.1564 - val_accuracy10: 0.4403 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.1335 - accuracy10: 0.4533 - val_loss: 3.1501 - val_accuracy10: 0.4462 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.1250 - accuracy10: 0.4558 - val_loss: 3.1472 - val_accuracy10: 0.4443 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.1154 - accuracy10: 0.4598 - val_loss: 3.1416 - val_accuracy10: 0.4487 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.1094 - accuracy10: 0.4618 - val_loss: 3.1406 - val_accuracy10: 0.4502 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.1009 - accuracy10: 0.4656 - val_loss: 3.1361 - val_accuracy10: 0.4496 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.0934 - accuracy10: 0.4683 - val_loss: 3.1330 - val_accuracy10: 0.4509 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.0868 - accuracy10: 0.4698 - val_loss: 3.1328 - val_accuracy10: 0.4522 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.0811 - accuracy10: 0.4722 - val_loss: 3.1303 - val_accuracy10: 0.4535 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.0733 - accuracy10: 0.4755 - val_loss: 3.1293 - val_accuracy10: 0.4520 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.0670 - accuracy10: 0.4783 - val_loss: 3.1256 - val_accuracy10: 0.4548 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.0604 - accuracy10: 0.4807 - val_loss: 3.1271 - val_accuracy10: 0.4555 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.0542 - accuracy10: 0.4824 - val_loss: 3.1255 - val_accuracy10: 0.4551 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.0479 - accuracy10: 0.4840 - val_loss: 3.1280 - val_accuracy10: 0.4558 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.0405 - accuracy10: 0.4879 - val_loss: 3.1323 - val_accuracy10: 0.4528 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.0355 - accuracy10: 0.4880 - val_loss: 3.1328 - val_accuracy10: 0.4563 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.0268 - accuracy10: 0.4902 - val_loss: 3.1348 - val_accuracy10: 0.4554 - 15s/epoch - 28ms/step
Epoch 23/50
526/526 - 15s - loss: 3.0208 - accuracy10: 0.4930 - val_loss: 3.1353 - val_accuracy10: 0.4536 - 15s/epoch - 28ms/step
Epoch 24/50
526/526 - 15s - loss: 3.0156 - accuracy10: 0.4950 - val_loss: 3.1334 - val_accuracy10: 0.4557 - 15s/epoch - 28ms/step
Epoch 25/50
526/526 - 15s - loss: 3.0098 - accuracy10: 0.4973 - val_loss: 3.1408 - val_accuracy10: 0.4542 - 15s/epoch - 28ms/step
Epoch 26/50
526/526 - 15s - loss: 3.0027 - accuracy10: 0.4994 - val_loss: 3.1477 - val_accuracy10: 0.4525 - 15s/epoch - 28ms/step
Epoch 27/50
526/526 - 15s - loss: 2.9972 - accuracy10: 0.5005 - val_loss: 3.1415 - val_accuracy10: 0.4553 - 15s/epoch - 28ms/step
Epoch 28/50
526/526 - 15s - loss: 2.9882 - accuracy10: 0.5042 - val_loss: 3.1460 - val_accuracy10: 0.4547 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h10
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0418419
{'0': {'precision': 0.42741350590973215, 'recall': 0.41573382120375824, 'f1-score': 0.4214927672350442, 'support': 128996}, '1': {'precision': 0.5029919868587244, 'recall': 0.45163109491584247, 'f1-score': 0.47592987451469543, 'support': 161364}, '2': {'precision': 0.4241860033659771, 'recall': 0.4889932783379163, 'f1-score': 0.45428999226516986, 'support': 130920}, 'accuracy': 0.45225028484618307, 'macro avg': {'precision': 0.4515304987114779, 'recall': 0.4521193981525056, 'f1-score': 0.4505708780049698, 'support': 421280}, 'weighted avg': {'precision': 0.45535953080249886, 'recall': 0.45225028484618307, 'f1-score': 0.4525362586897007, 'support': 421280}}
[[53628 35662 39706]
 [41290 72877 47197]
 [30553 36348 64019]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0231396
{'0': {'precision': 0.4983945173967219, 'recall': 0.4504873294346979, 'f1-score': 0.47323155332074357, 'support': 46170}, '1': {'precision': 0.4523251270027354, 'recall': 0.4336322554964996, 'f1-score': 0.44278149020357904, 'support': 42709}, '2': {'precision': 0.4734510717793656, 'recall': 0.5376859142607174, 'f1-score': 0.5035281587005725, 'support': 45720}, 'accuracy': 0.4747583563027957, 'macro avg': {'precision': 0.47472357205960763, 'recall': 0.473935166397305, 'f1-score': 0.47318040074163176, 'support': 134599}, 'weighted avg': {'precision': 0.47530376688622555, 'recall': 0.4747583563027957, 'f1-score': 0.4738605999874706, 'support': 134599}}
[[20799 11356 14015]
 [10864 18520 13325]
 [10069 11068 24583]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.042247
{'0': {'precision': 0.47423230974632846, 'recall': 0.4184402733055839, 'f1-score': 0.44459279038718286, 'support': 12733}, '1': {'precision': 0.44137375905554066, 'recall': 0.42756887887714434, 'f1-score': 0.43436165999207854, 'support': 11542}, '2': {'precision': 0.45940514469453375, 'recall': 0.5247532328410743, 'f1-score': 0.48990963317498304, 'support': 13069}, 'accuracy': 0.4584672236503856, 'macro avg': {'precision': 0.4583370711654677, 'recall': 0.4569207950079342, 'f1-score': 0.4562880278514148, 'support': 37344}, 'weighted avg': {'precision': 0.45888768645651, 'recall': 0.4584672236503856, 'f1-score': 0.4572898263601228, 'support': 37344}}
[[5328 3061 4344]
 [2881 4935 3726]
 [3026 3185 6858]]
training model: results/PCAR/W7/deepOF_L2/h20
Epoch 1/50
526/526 - 17s - loss: 3.3114 - accuracy20: 0.3574 - val_loss: 3.2740 - val_accuracy20: 0.3807 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.2584 - accuracy20: 0.3893 - val_loss: 3.2539 - val_accuracy20: 0.3935 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2366 - accuracy20: 0.4025 - val_loss: 3.2439 - val_accuracy20: 0.3982 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2224 - accuracy20: 0.4091 - val_loss: 3.2379 - val_accuracy20: 0.4005 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2107 - accuracy20: 0.4182 - val_loss: 3.2313 - val_accuracy20: 0.4070 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2001 - accuracy20: 0.4243 - val_loss: 3.2281 - val_accuracy20: 0.4087 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.1922 - accuracy20: 0.4282 - val_loss: 3.2276 - val_accuracy20: 0.4119 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.1857 - accuracy20: 0.4303 - val_loss: 3.2236 - val_accuracy20: 0.4111 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.1783 - accuracy20: 0.4339 - val_loss: 3.2274 - val_accuracy20: 0.4104 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.1719 - accuracy20: 0.4374 - val_loss: 3.2278 - val_accuracy20: 0.4110 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.1660 - accuracy20: 0.4415 - val_loss: 3.2307 - val_accuracy20: 0.4111 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 14s - loss: 3.1603 - accuracy20: 0.4418 - val_loss: 3.2296 - val_accuracy20: 0.4100 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 15s - loss: 3.1533 - accuracy20: 0.4449 - val_loss: 3.2303 - val_accuracy20: 0.4136 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.1474 - accuracy20: 0.4479 - val_loss: 3.2328 - val_accuracy20: 0.4120 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.1411 - accuracy20: 0.4509 - val_loss: 3.2294 - val_accuracy20: 0.4150 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.1339 - accuracy20: 0.4525 - val_loss: 3.2304 - val_accuracy20: 0.4154 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.1286 - accuracy20: 0.4549 - val_loss: 3.2356 - val_accuracy20: 0.4168 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.1212 - accuracy20: 0.4579 - val_loss: 3.2346 - val_accuracy20: 0.4138 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h20
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0681676
{'0': {'precision': 0.3976335312176809, 'recall': 0.38178079407027476, 'f1-score': 0.3895459459028229, 'support': 127898}, '1': {'precision': 0.4403645425761169, 'recall': 0.4490963559571751, 'f1-score': 0.44468758927974417, 'support': 162896}, '2': {'precision': 0.4010653167617393, 'recall': 0.40680992596906945, 'f1-score': 0.4039171970887343, 'support': 130486}, 'accuracy': 0.4155620964679073, 'macro avg': {'precision': 0.413021130185179, 'recall': 0.41256235866550645, 'f1-score': 0.4127169107571005, 'support': 421280}, 'weighted avg': {'precision': 0.41521924806810295, 'recall': 0.4155620964679073, 'f1-score': 0.41531882907261924, 'support': 421280}}
[[48829 45943 33126]
 [43594 73156 46146]
 [30376 47027 53083]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0655696
{'0': {'precision': 0.4558556716837452, 'recall': 0.3895913865775623, 'f1-score': 0.42012670450531076, 'support': 45789}, '1': {'precision': 0.37921624495856493, 'recall': 0.4352602487333026, 'f1-score': 0.4053100571538865, 'support': 43420}, '2': {'precision': 0.4398956803787065, 'recall': 0.44221194095615773, 'f1-score': 0.44105076961953, 'support': 45390}, 'accuracy': 0.4220685146249229, 'macro avg': {'precision': 0.4249891990070056, 'recall': 0.42235452542234087, 'f1-score': 0.4221625104262425, 'support': 134599}, 'weighted avg': {'precision': 0.4257506343971158, 'recall': 0.4220685146249229, 'f1-score': 0.4224031292004093, 'support': 134599}}
[[17839 15716 12234]
 [11198 18899 13323]
 [10096 15222 20072]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0765718
{'0': {'precision': 0.43412774070543375, 'recall': 0.36414521029905644, 'f1-score': 0.3960688815446165, 'support': 12506}, '1': {'precision': 0.371997052321297, 'recall': 0.4242729870566482, 'f1-score': 0.39641903565258363, 'support': 11898}, '2': {'precision': 0.43450767841011745, 'recall': 0.44605873261205564, 'f1-score': 0.4402074435631482, 'support': 12940}, 'accuracy': 0.4116859468723222, 'macro avg': {'precision': 0.41354415714561604, 'recall': 0.4114923099892534, 'f1-score': 0.4108984535867828, 'support': 37344}, 'weighted avg': {'precision': 0.41446421948392953, 'recall': 0.4116859468723222, 'f1-score': 0.4114748135844728, 'support': 37344}}
[[4554 4300 3652]
 [2990 5048 3860]
 [2946 4222 5772]]
training model: results/PCAR/W7/deepOF_L2/h30
Epoch 1/50
526/526 - 17s - loss: 3.3181 - accuracy30: 0.3577 - val_loss: 3.3003 - val_accuracy30: 0.3693 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.2719 - accuracy30: 0.3810 - val_loss: 3.2797 - val_accuracy30: 0.3803 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2541 - accuracy30: 0.3901 - val_loss: 3.2728 - val_accuracy30: 0.3846 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2442 - accuracy30: 0.3945 - val_loss: 3.2674 - val_accuracy30: 0.3884 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2368 - accuracy30: 0.4008 - val_loss: 3.2627 - val_accuracy30: 0.3908 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2304 - accuracy30: 0.4058 - val_loss: 3.2591 - val_accuracy30: 0.3895 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2243 - accuracy30: 0.4072 - val_loss: 3.2571 - val_accuracy30: 0.3922 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2186 - accuracy30: 0.4116 - val_loss: 3.2558 - val_accuracy30: 0.3922 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2135 - accuracy30: 0.4146 - val_loss: 3.2559 - val_accuracy30: 0.3934 - 14s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2068 - accuracy30: 0.4160 - val_loss: 3.2528 - val_accuracy30: 0.3937 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2033 - accuracy30: 0.4198 - val_loss: 3.2536 - val_accuracy30: 0.3963 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.1975 - accuracy30: 0.4224 - val_loss: 3.2526 - val_accuracy30: 0.3980 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.1923 - accuracy30: 0.4254 - val_loss: 3.2554 - val_accuracy30: 0.3950 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.1869 - accuracy30: 0.4281 - val_loss: 3.2569 - val_accuracy30: 0.3981 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.1842 - accuracy30: 0.4280 - val_loss: 3.2568 - val_accuracy30: 0.3974 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.1749 - accuracy30: 0.4344 - val_loss: 3.2558 - val_accuracy30: 0.4008 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.1704 - accuracy30: 0.4372 - val_loss: 3.2577 - val_accuracy30: 0.3974 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.1659 - accuracy30: 0.4377 - val_loss: 3.2617 - val_accuracy30: 0.4007 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.1602 - accuracy30: 0.4395 - val_loss: 3.2684 - val_accuracy30: 0.3964 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.1522 - accuracy30: 0.4440 - val_loss: 3.2698 - val_accuracy30: 0.3979 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.1467 - accuracy30: 0.4465 - val_loss: 3.2773 - val_accuracy30: 0.3963 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.1426 - accuracy30: 0.4480 - val_loss: 3.2752 - val_accuracy30: 0.3986 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h30
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1061363
{'0': {'precision': 0.31204015978384475, 'recall': 0.5831214355770279, 'f1-score': 0.4065351035473925, 'support': 110116}, '1': {'precision': 0.5542163929260704, 'recall': 0.07196448572319936, 'f1-score': 0.12738778540259646, 'support': 195527}, '2': {'precision': 0.3321024864159737, 'recall': 0.5459930645035759, 'f1-score': 0.4129975470155356, 'support': 115637}, 'accuracy': 0.3356888530193695, 'macro avg': {'precision': 0.3994530130419629, 'recall': 0.40035966193460104, 'f1-score': 0.31564014532184154, 'support': 421280}, 'weighted avg': {'precision': 0.429947346458644, 'recall': 0.3356888530193695, 'f1-score': 0.2787494500637905, 'support': 421280}}
[[64211  5468 40437]
 [94917 14071 86539]
 [46650  5850 63137]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703106
{'0': {'precision': 0.41536599350194303, 'recall': 0.5761244145975082, 'f1-score': 0.48271266750573777, 'support': 45268}, '1': {'precision': 0.44687871189124984, 'recall': 0.07628359654853899, 'f1-score': 0.13032099145562312, 'support': 44387}, '2': {'precision': 0.4144378366597129, 'recall': 0.592314880740477, 'f1-score': 0.48766234955760307, 'support': 44944}, 'accuracy': 0.41669700369244944, 'macro avg': {'precision': 0.4255608473509686, 'recall': 0.41490763062884134, 'f1-score': 0.3668986695063213, 'support': 134599}, 'weighted avg': {'precision': 0.4254480888371905, 'recall': 0.41669700369244944, 'f1-score': 0.3681564611840162, 'support': 134599}}
[[26080  2147 17041]
 [20429  3386 20572]
 [16279  2044 26621]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0840818
{'0': {'precision': 0.3889815366289458, 'recall': 0.5337528604118993, 'f1-score': 0.450010335561221, 'support': 12236}, '1': {'precision': 0.4676292501164415, 'recall': 0.08094163173169945, 'f1-score': 0.13799738849563603, 'support': 12404}, '2': {'precision': 0.3944694953007008, 'recall': 0.5715522670025189, 'f1-score': 0.4667802385008518, 'support': 12704}, 'accuracy': 0.3962082262210797, 'macro avg': {'precision': 0.41702676068202943, 'recall': 0.3954155863820392, 'f1-score': 0.35159598751923626, 'support': 37344}, 'weighted avg': {'precision': 0.4169717161775981, 'recall': 0.3962082262210797, 'f1-score': 0.35207857280264004, 'support': 37344}}
[[6531  586 5119]
 [5373 1004 6027]
 [4886  557 7261]]
training model: results/PCAR/W7/deepOF_L2/h50
Epoch 1/50
526/526 - 17s - loss: 3.3269 - accuracy50: 0.3451 - val_loss: 3.3042 - val_accuracy50: 0.3571 - 17s/epoch - 33ms/step
Epoch 2/50
526/526 - 15s - loss: 3.2859 - accuracy50: 0.3707 - val_loss: 3.2822 - val_accuracy50: 0.3676 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2700 - accuracy50: 0.3808 - val_loss: 3.2745 - val_accuracy50: 0.3751 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2585 - accuracy50: 0.3904 - val_loss: 3.2709 - val_accuracy50: 0.3788 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2507 - accuracy50: 0.3945 - val_loss: 3.2684 - val_accuracy50: 0.3820 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2434 - accuracy50: 0.3995 - val_loss: 3.2677 - val_accuracy50: 0.3842 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2366 - accuracy50: 0.4044 - val_loss: 3.2673 - val_accuracy50: 0.3832 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2324 - accuracy50: 0.4060 - val_loss: 3.2622 - val_accuracy50: 0.3891 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2265 - accuracy50: 0.4104 - val_loss: 3.2655 - val_accuracy50: 0.3867 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2222 - accuracy50: 0.4121 - val_loss: 3.2670 - val_accuracy50: 0.3858 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2166 - accuracy50: 0.4146 - val_loss: 3.2673 - val_accuracy50: 0.3880 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2139 - accuracy50: 0.4165 - val_loss: 3.2675 - val_accuracy50: 0.3861 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2086 - accuracy50: 0.4172 - val_loss: 3.2686 - val_accuracy50: 0.3880 - 14s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2021 - accuracy50: 0.4223 - val_loss: 3.2685 - val_accuracy50: 0.3876 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.1970 - accuracy50: 0.4239 - val_loss: 3.2731 - val_accuracy50: 0.3880 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.1922 - accuracy50: 0.4285 - val_loss: 3.2711 - val_accuracy50: 0.3868 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.1860 - accuracy50: 0.4298 - val_loss: 3.2751 - val_accuracy50: 0.3875 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.1804 - accuracy50: 0.4334 - val_loss: 3.2779 - val_accuracy50: 0.3894 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h50
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874205
{'0': {'precision': 0.3454035453730147, 'recall': 0.4452607412266317, 'f1-score': 0.3890263952517919, 'support': 121960}, '1': {'precision': 0.45530429663270994, 'recall': 0.25405941291034095, 'f1-score': 0.3261354950694494, 'support': 170468}, '2': {'precision': 0.35799100272286016, 'recall': 0.4693679570359793, 'f1-score': 0.40618283902858365, 'support': 128852}, 'accuracy': 0.37526585643752375, 'macro avg': {'precision': 0.38623294824286164, 'recall': 0.3895627037243173, 'f1-score': 0.3737815764499417, 'support': 421280}, 'weighted avg': {'precision': 0.3937240930377033, 'recall': 0.37526585643752375, 'f1-score': 0.3688254745369315, 'support': 421280}}
[[54304 25236 42420]
 [61118 43309 66041]
 [41797 26576 60479]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780169
{'0': {'precision': 0.4125619196706195, 'recall': 0.42368252989495475, 'f1-score': 0.4180482823059038, 'support': 45409}, '1': {'precision': 0.39670078189562014, 'recall': 0.28089483041883284, 'f1-score': 0.32890177218525596, 'support': 44433}, '2': {'precision': 0.3997593090754637, 'recall': 0.5046808320486181, 'f1-score': 0.4461342471435202, 'support': 44757}, 'accuracy': 0.4034799664187698, 'macro avg': {'precision': 0.4030073368805678, 'recall': 0.4030860641208019, 'f1-score': 0.39769476721156, 'support': 134599}, 'weighted avg': {'precision': 0.40306880027772707, 'recall': 0.4034799664187698, 'f1-score': 0.3979589550749916, 'support': 134599}}
[[19239  9870 16300]
 [14336 12481 17616]
 [13058  9111 22588]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874455
{'0': {'precision': 0.3870762880050806, 'recall': 0.40121780630297044, 'f1-score': 0.394020202020202, 'support': 12153}, '1': {'precision': 0.38906562978673265, 'recall': 0.2632124352331606, 'f1-score': 0.3139977177634081, 'support': 12545}, '2': {'precision': 0.3833948339483395, 'recall': 0.4929622014866361, 'f1-score': 0.43132913581955307, 'support': 12646}, 'accuracy': 0.3859254498714653, 'macro avg': {'precision': 0.3865122505800509, 'recall': 0.38579748100758904, 'f1-score': 0.379782351867721, 'support': 37344}, 'weighted avg': {'precision': 0.38649789856231276, 'recall': 0.3859254498714653, 'f1-score': 0.37977230977044607, 'support': 37344}}
[[4876 2578 4699]
 [3916 3302 5327]
 [3805 2607 6234]]
training model: results/PCAR/W7/deepOF_L2/h100
Epoch 1/50
526/526 - 17s - loss: 3.3291 - accuracy100: 0.3474 - val_loss: 3.3245 - val_accuracy100: 0.3470 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.2934 - accuracy100: 0.3662 - val_loss: 3.3106 - val_accuracy100: 0.3506 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2790 - accuracy100: 0.3729 - val_loss: 3.3005 - val_accuracy100: 0.3578 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2671 - accuracy100: 0.3835 - val_loss: 3.2928 - val_accuracy100: 0.3628 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2586 - accuracy100: 0.3907 - val_loss: 3.2884 - val_accuracy100: 0.3647 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2511 - accuracy100: 0.3958 - val_loss: 3.2875 - val_accuracy100: 0.3655 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2451 - accuracy100: 0.3979 - val_loss: 3.2848 - val_accuracy100: 0.3676 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2418 - accuracy100: 0.4022 - val_loss: 3.2837 - val_accuracy100: 0.3698 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2362 - accuracy100: 0.4049 - val_loss: 3.2833 - val_accuracy100: 0.3677 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2323 - accuracy100: 0.4081 - val_loss: 3.2836 - val_accuracy100: 0.3702 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2286 - accuracy100: 0.4097 - val_loss: 3.2817 - val_accuracy100: 0.3713 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2261 - accuracy100: 0.4117 - val_loss: 3.2853 - val_accuracy100: 0.3668 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.2223 - accuracy100: 0.4134 - val_loss: 3.2899 - val_accuracy100: 0.3664 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2177 - accuracy100: 0.4148 - val_loss: 3.2871 - val_accuracy100: 0.3697 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.2134 - accuracy100: 0.4190 - val_loss: 3.2877 - val_accuracy100: 0.3703 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.2101 - accuracy100: 0.4198 - val_loss: 3.2935 - val_accuracy100: 0.3697 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.2063 - accuracy100: 0.4211 - val_loss: 3.2942 - val_accuracy100: 0.3671 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.1994 - accuracy100: 0.4256 - val_loss: 3.2981 - val_accuracy100: 0.3694 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.1975 - accuracy100: 0.4274 - val_loss: 3.3010 - val_accuracy100: 0.3691 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.1924 - accuracy100: 0.4286 - val_loss: 3.3053 - val_accuracy100: 0.3678 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.1872 - accuracy100: 0.4313 - val_loss: 3.3014 - val_accuracy100: 0.3688 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h100
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058465
{'0': {'precision': 0.2957145615226043, 'recall': 0.428859163452767, 'f1-score': 0.35005381813892456, 'support': 110717}, '1': {'precision': 0.5310153963608601, 'recall': 0.17664737192986169, 'f1-score': 0.2651050144916028, 'support': 188998}, '2': {'precision': 0.3180382226131085, 'recall': 0.5175914120018097, 'f1-score': 0.3939875894629406, 'support': 121565}, 'accuracy': 0.3413145651348272, 'macro avg': {'precision': 0.3815893934988576, 'recall': 0.3743659824614795, 'f1-score': 0.33638214069782263, 'support': 421280}, 'weighted avg': {'precision': 0.40771884143911546, 'recall': 0.3413145651348272, 'f1-score': 0.3246209823035359, 'support': 421280}}
[[47482 14602 48633]
 [69325 33386 86287]
 [43760 14884 62921]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0842488
{'0': {'precision': 0.3910653628409676, 'recall': 0.42334692785986494, 'f1-score': 0.40656635918070333, 'support': 44871}, '1': {'precision': 0.42114367617258935, 'recall': 0.19015844677527338, 'f1-score': 0.2620112848423351, 'support': 44810}, '2': {'precision': 0.3790792053624356, 'recall': 0.5552339819226145, 'f1-score': 0.4505505424129927, 'support': 44918}, 'accuracy': 0.38972800689455345, 'macro avg': {'precision': 0.3970960814586642, 'recall': 0.38957978551925093, 'f1-score': 0.3730427288120104, 'support': 134599}, 'weighted avg': {'precision': 0.39707889190707707, 'recall': 0.38972800689455345, 'f1-score': 0.3731201126359719, 'support': 134599}}
[[18996  6083 19792]
 [15230  8521 21059]
 [14349  5629 24940]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0947697
{'0': {'precision': 0.36001552795031055, 'recall': 0.3790256661762302, 'f1-score': 0.36927610097953334, 'support': 12234}, '1': {'precision': 0.38711947914833716, 'recall': 0.17916768466487498, 'f1-score': 0.2449615855695357, 'support': 12279}, '2': {'precision': 0.3653160108620414, 'recall': 0.5347205985503858, 'f1-score': 0.4340756674680501, 'support': 12831}, 'accuracy': 0.36680591259640105, 'macro avg': {'precision': 0.37081700598689643, 'recall': 0.36430464979716365, 'f1-score': 0.3494377846723731, 'support': 37344}, 'weighted avg': {'precision': 0.3707487089968237, 'recall': 0.36680591259640105, 'f1-score': 0.3506649533492527, 'support': 37344}}
[[4637 1729 5868]
 [4027 2200 6052]
 [4216 1754 6861]]
training model: results/PCAR/W7/deepOF_L2/h200
Epoch 1/50
526/526 - 17s - loss: 3.3352 - accuracy200: 0.3421 - val_loss: 3.3341 - val_accuracy200: 0.3315 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.3035 - accuracy200: 0.3562 - val_loss: 3.3228 - val_accuracy200: 0.3364 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2915 - accuracy200: 0.3629 - val_loss: 3.3156 - val_accuracy200: 0.3379 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2824 - accuracy200: 0.3700 - val_loss: 3.3108 - val_accuracy200: 0.3418 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2763 - accuracy200: 0.3765 - val_loss: 3.3072 - val_accuracy200: 0.3426 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2709 - accuracy200: 0.3792 - val_loss: 3.3040 - val_accuracy200: 0.3482 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2654 - accuracy200: 0.3841 - val_loss: 3.3006 - val_accuracy200: 0.3514 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2612 - accuracy200: 0.3863 - val_loss: 3.2967 - val_accuracy200: 0.3560 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2566 - accuracy200: 0.3899 - val_loss: 3.2961 - val_accuracy200: 0.3546 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2528 - accuracy200: 0.3930 - val_loss: 3.2967 - val_accuracy200: 0.3546 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2498 - accuracy200: 0.3948 - val_loss: 3.2975 - val_accuracy200: 0.3571 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2465 - accuracy200: 0.3972 - val_loss: 3.2955 - val_accuracy200: 0.3610 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.2438 - accuracy200: 0.3989 - val_loss: 3.2941 - val_accuracy200: 0.3636 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2399 - accuracy200: 0.4009 - val_loss: 3.2962 - val_accuracy200: 0.3614 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.2348 - accuracy200: 0.4036 - val_loss: 3.2972 - val_accuracy200: 0.3601 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.2331 - accuracy200: 0.4053 - val_loss: 3.2988 - val_accuracy200: 0.3595 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.2295 - accuracy200: 0.4077 - val_loss: 3.2956 - val_accuracy200: 0.3653 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.2241 - accuracy200: 0.4112 - val_loss: 3.3020 - val_accuracy200: 0.3594 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.2214 - accuracy200: 0.4130 - val_loss: 3.3035 - val_accuracy200: 0.3626 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.2178 - accuracy200: 0.4142 - val_loss: 3.3065 - val_accuracy200: 0.3603 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.2120 - accuracy200: 0.4170 - val_loss: 3.3131 - val_accuracy200: 0.3583 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.2104 - accuracy200: 0.4171 - val_loss: 3.3161 - val_accuracy200: 0.3590 - 15s/epoch - 28ms/step
Epoch 23/50
526/526 - 15s - loss: 3.2066 - accuracy200: 0.4206 - val_loss: 3.3137 - val_accuracy200: 0.3602 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h200
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102626
{'0': {'precision': 0.28945722328054363, 'recall': 0.3660009706818141, 'f1-score': 0.3232597461360768, 'support': 111262}, '1': {'precision': 0.5003857746870082, 'recall': 0.26199106964919555, 'f1-score': 0.34391549355525225, 'support': 185659}, '2': {'precision': 0.31891771044064804, 'recall': 0.47029969684542333, 'f1-score': 0.38009020367313523, 'support': 124359}, 'accuracy': 0.35095186099506265, 'macro avg': {'precision': 0.36958690280273326, 'recall': 0.36609724572547764, 'f1-score': 0.3490884811214881, 'support': 421280}, 'weighted avg': {'precision': 0.39111042459158674, 'recall': 0.35095186099506265, 'f1-score': 0.3491387441396558, 'support': 421280}}
[[40722 23257 47283]
 [59398 48641 77620]
 [40564 25309 58486]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859067
{'0': {'precision': 0.3880526700115422, 'recall': 0.36289540928716185, 'f1-score': 0.3750526471559153, 'support': 45396}, '1': {'precision': 0.40782122905027934, 'recall': 0.28070572268717486, 'f1-score': 0.33252947481243306, 'support': 44210}, '2': {'precision': 0.3761261261261261, 'recall': 0.515924699397684, 'f1-score': 0.4350710811646627, 'support': 44993}, 'accuracy': 0.3870533956418696, 'macro avg': {'precision': 0.39066667506264924, 'recall': 0.38650861045734025, 'f1-score': 0.380884401044337, 'support': 134599}, 'weighted avg': {'precision': 0.39055905569097554, 'recall': 0.3870533956418696, 'f1-score': 0.3811482344340542, 'support': 134599}}
[[16474  9155 19767]
 [13064 12410 18736]
 [12915  8865 23213]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969276
{'0': {'precision': 0.33743016759776534, 'recall': 0.33455475074563273, 'f1-score': 0.33598630723149336, 'support': 11735}, '1': {'precision': 0.4129955947136564, 'recall': 0.255449591280654, 'f1-score': 0.31565656565656564, 'support': 13212}, '2': {'precision': 0.3483492045389747, 'recall': 0.49278051141405177, 'f1-score': 0.40816462885013693, 'support': 12397}, 'accuracy': 0.35909383033419023, 'macro avg': {'precision': 0.36625832228346544, 'recall': 0.3609282844801129, 'f1-score': 0.35326916724606533, 'support': 37344}, 'weighted avg': {'precision': 0.3677893611500181, 'recall': 0.35909383033419023, 'f1-score': 0.3527546798594491, 'support': 37344}}
[[3926 2296 5513]
 [3922 3375 5915]
 [3787 2501 6109]]
training model: results/PCAR/W7/deepOF_L2/h300
Epoch 1/50
526/526 - 17s - loss: 3.3383 - accuracy300: 0.3412 - val_loss: 3.3320 - val_accuracy300: 0.3305 - 17s/epoch - 33ms/step
Epoch 2/50
526/526 - 15s - loss: 3.3067 - accuracy300: 0.3540 - val_loss: 3.3189 - val_accuracy300: 0.3351 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2967 - accuracy300: 0.3580 - val_loss: 3.3086 - val_accuracy300: 0.3400 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2882 - accuracy300: 0.3643 - val_loss: 3.3071 - val_accuracy300: 0.3383 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2811 - accuracy300: 0.3724 - val_loss: 3.3047 - val_accuracy300: 0.3476 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2766 - accuracy300: 0.3755 - val_loss: 3.3033 - val_accuracy300: 0.3424 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2712 - accuracy300: 0.3805 - val_loss: 3.3009 - val_accuracy300: 0.3487 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2684 - accuracy300: 0.3823 - val_loss: 3.2989 - val_accuracy300: 0.3512 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2636 - accuracy300: 0.3850 - val_loss: 3.2977 - val_accuracy300: 0.3522 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2607 - accuracy300: 0.3867 - val_loss: 3.3001 - val_accuracy300: 0.3522 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2584 - accuracy300: 0.3891 - val_loss: 3.2986 - val_accuracy300: 0.3519 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2547 - accuracy300: 0.3908 - val_loss: 3.2986 - val_accuracy300: 0.3507 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.2514 - accuracy300: 0.3939 - val_loss: 3.2966 - val_accuracy300: 0.3559 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2486 - accuracy300: 0.3952 - val_loss: 3.2977 - val_accuracy300: 0.3531 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.2448 - accuracy300: 0.3986 - val_loss: 3.2991 - val_accuracy300: 0.3546 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.2427 - accuracy300: 0.3986 - val_loss: 3.2989 - val_accuracy300: 0.3571 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.2395 - accuracy300: 0.4015 - val_loss: 3.2987 - val_accuracy300: 0.3578 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.2337 - accuracy300: 0.4050 - val_loss: 3.3014 - val_accuracy300: 0.3549 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.2311 - accuracy300: 0.4067 - val_loss: 3.3001 - val_accuracy300: 0.3559 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.2259 - accuracy300: 0.4097 - val_loss: 3.3059 - val_accuracy300: 0.3542 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.2229 - accuracy300: 0.4102 - val_loss: 3.3060 - val_accuracy300: 0.3564 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.2204 - accuracy300: 0.4122 - val_loss: 3.3028 - val_accuracy300: 0.3615 - 15s/epoch - 28ms/step
Epoch 23/50
526/526 - 15s - loss: 3.2155 - accuracy300: 0.4144 - val_loss: 3.3072 - val_accuracy300: 0.3564 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h300
Evaluating performance on  test set...
1646/1646 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035994
{'0': {'precision': 0.28637405375373287, 'recall': 0.22061419934727944, 'f1-score': 0.24922937443336352, 'support': 112146}, '1': {'precision': 0.4801711429906878, 'recall': 0.2229189501972414, 'f1-score': 0.3044823078793774, 'support': 179729}, '2': {'precision': 0.32089466169809144, 'recall': 0.6235307754723542, 'f1-score': 0.42372365118208644, 'support': 129405}, 'accuracy': 0.34536175465248764, 'macro avg': {'precision': 0.36247995281417067, 'recall': 0.35568797500562505, 'f1-score': 0.32581177783160914, 'support': 421280}, 'weighted avg': {'precision': 0.37965665991236464, 'recall': 0.34536175465248764, 'f1-score': 0.32640129419691055, 'support': 421280}}
[[ 24741  20620  66785]
 [ 35690  40065 103974]
 [ 25963  22754  80688]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0900016
{'0': {'precision': 0.3917749701335843, 'recall': 0.2382021482655397, 'f1-score': 0.29626993361166243, 'support': 45432}, '1': {'precision': 0.39520567786790267, 'recall': 0.24584957087829162, 'f1-score': 0.30312877556972045, 'support': 44393}, '2': {'precision': 0.35914818548387095, 'recall': 0.636574797873766, 'f1-score': 0.459213430647526, 'support': 44774}, 'accuracy': 0.37324200031203797, 'macro avg': {'precision': 0.3820429444951193, 'recall': 0.3735421723391991, 'f1-score': 0.3528707132763029, 'support': 134599}, 'weighted avg': {'precision': 0.38205326159595276, 'recall': 0.37324200031203797, 'f1-score': 0.3527348160203566, 'support': 134599}}
[[10822  8648 25962]
 [ 8583 10914 24896]
 [ 8218  8054 28502]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983757
{'0': {'precision': 0.3248657849941076, 'recall': 0.21400845337703786, 'f1-score': 0.25803432137285487, 'support': 11593}, '1': {'precision': 0.4060140237324703, 'recall': 0.22581370931453426, 'f1-score': 0.2902168674698795, 'support': 13334}, '2': {'precision': 0.343815889821004, 'recall': 0.6172183297092696, 'f1-score': 0.44162729053820443, 'support': 12417}, 'accuracy': 0.3522922022279349, 'macro avg': {'precision': 0.35823189951586065, 'recall': 0.35234683080028056, 'f1-score': 0.3299594931269796, 'support': 37344}, 'weighted avg': {'precision': 0.3601414401722594, 'recall': 0.3522922022279349, 'f1-score': 0.33057063156415395, 'support': 37344}}
[[2481 2134 6978]
 [2674 3011 7649]
 [2482 2271 7664]]
training model: results/PCAR/W7/deepOF_L2/h500
Epoch 1/50
526/526 - 17s - loss: 3.3403 - accuracy500: 0.3429 - val_loss: 3.3336 - val_accuracy500: 0.3272 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.3109 - accuracy500: 0.3541 - val_loss: 3.3191 - val_accuracy500: 0.3334 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2986 - accuracy500: 0.3592 - val_loss: 3.3110 - val_accuracy500: 0.3396 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2896 - accuracy500: 0.3658 - val_loss: 3.3066 - val_accuracy500: 0.3405 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2828 - accuracy500: 0.3709 - val_loss: 3.3036 - val_accuracy500: 0.3474 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2762 - accuracy500: 0.3744 - val_loss: 3.3054 - val_accuracy500: 0.3460 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2721 - accuracy500: 0.3783 - val_loss: 3.2996 - val_accuracy500: 0.3529 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2682 - accuracy500: 0.3806 - val_loss: 3.3005 - val_accuracy500: 0.3542 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2639 - accuracy500: 0.3838 - val_loss: 3.2974 - val_accuracy500: 0.3562 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2602 - accuracy500: 0.3875 - val_loss: 3.3002 - val_accuracy500: 0.3525 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2560 - accuracy500: 0.3912 - val_loss: 3.2973 - val_accuracy500: 0.3619 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2538 - accuracy500: 0.3921 - val_loss: 3.2961 - val_accuracy500: 0.3625 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.2498 - accuracy500: 0.3957 - val_loss: 3.2965 - val_accuracy500: 0.3600 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2463 - accuracy500: 0.3958 - val_loss: 3.2972 - val_accuracy500: 0.3642 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.2434 - accuracy500: 0.3998 - val_loss: 3.2991 - val_accuracy500: 0.3594 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.2399 - accuracy500: 0.3999 - val_loss: 3.2957 - val_accuracy500: 0.3659 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.2375 - accuracy500: 0.4028 - val_loss: 3.3013 - val_accuracy500: 0.3604 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.2332 - accuracy500: 0.4047 - val_loss: 3.3064 - val_accuracy500: 0.3582 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.2295 - accuracy500: 0.4075 - val_loss: 3.3023 - val_accuracy500: 0.3602 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.2260 - accuracy500: 0.4083 - val_loss: 3.3063 - val_accuracy500: 0.3606 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.2222 - accuracy500: 0.4098 - val_loss: 3.3028 - val_accuracy500: 0.3654 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.2200 - accuracy500: 0.4129 - val_loss: 3.3065 - val_accuracy500: 0.3635 - 15s/epoch - 28ms/step
Epoch 23/50
526/526 - 15s - loss: 3.2148 - accuracy500: 0.4150 - val_loss: 3.3096 - val_accuracy500: 0.3618 - 15s/epoch - 28ms/step
Epoch 24/50
526/526 - 15s - loss: 3.2127 - accuracy500: 0.4156 - val_loss: 3.3105 - val_accuracy500: 0.3629 - 15s/epoch - 28ms/step
Epoch 25/50
526/526 - 15s - loss: 3.2066 - accuracy500: 0.4203 - val_loss: 3.3180 - val_accuracy500: 0.3613 - 15s/epoch - 28ms/step
Epoch 26/50
526/526 - 15s - loss: 3.2034 - accuracy500: 0.4196 - val_loss: 3.3185 - val_accuracy500: 0.3611 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h500
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047179
{'0': {'precision': 0.283694400837258, 'recall': 0.2417160079897275, 'f1-score': 0.26102824347357173, 'support': 112144}, '1': {'precision': 0.4821215343093154, 'recall': 0.3286501976394766, 'f1-score': 0.3908605376661351, 'support': 179367}, '2': {'precision': 0.32421114715423177, 'recall': 0.508318627715402, 'f1-score': 0.3959079191787029, 'support': 129769}, 'accuracy': 0.3608526395746297, 'macro avg': {'precision': 0.36334236076693505, 'recall': 0.35956161111486873, 'f1-score': 0.34926556677280324, 'support': 421280}, 'weighted avg': {'precision': 0.38065864623768025, 'recall': 0.3608526395746297, 'f1-score': 0.35785417812277576, 'support': 421280}}
[[27107 30171 54866]
 [37788 58949 82630]
 [30655 33150 65964]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0883778
{'0': {'precision': 0.38057636498616454, 'recall': 0.24889104671948448, 'f1-score': 0.3009593446035198, 'support': 45313}, '1': {'precision': 0.40185343519872024, 'recall': 0.32764397670287165, 'f1-score': 0.3609741595025147, 'support': 44469}, '2': {'precision': 0.36320370262560403, 'recall': 0.5568199567128544, 'f1-score': 0.4396388460691477, 'support': 44817}, 'accuracy': 0.3774396540836113, 'macro avg': {'precision': 0.381877834270163, 'recall': 0.3777849933784035, 'f1-score': 0.3671907833917274, 'support': 134599}, 'weighted avg': {'precision': 0.38182139226176764, 'recall': 0.3774396540836113, 'f1-score': 0.3669627920357329, 'support': 134599}}
[[11278 11089 22946]
 [ 9092 14570 20807]
 [ 9264 10598 24955]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987737
{'0': {'precision': 0.3329656862745098, 'recall': 0.23986933874812394, 'f1-score': 0.2788525683789193, 'support': 11327}, '1': {'precision': 0.41835506519558674, 'recall': 0.30852873733264297, 'f1-score': 0.355144961471327, 'support': 13519}, '2': {'precision': 0.34282294160507965, 'recall': 0.5270443270923347, 'f1-score': 0.4154263370332997, 'support': 12498}, 'accuracy': 0.36083440445586973, 'macro avg': {'precision': 0.36471456435839206, 'recall': 0.3584808010577006, 'f1-score': 0.3498079556278486, 'support': 37344}, 'weighted avg': {'precision': 0.36717667038857105, 'recall': 0.36083440445586973, 'f1-score': 0.35217882756001145, 'support': 37344}}
[[2717 2650 5960]
 [2681 4171 6667]
 [2762 3149 6587]]
training model: results/PCAR/W7/deepOF_L2/h1000
Epoch 1/50
526/526 - 17s - loss: 3.3390 - accuracy1000: 0.3503 - val_loss: 3.3483 - val_accuracy1000: 0.3215 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 15s - loss: 3.3092 - accuracy1000: 0.3581 - val_loss: 3.3299 - val_accuracy1000: 0.3224 - 15s/epoch - 28ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2977 - accuracy1000: 0.3616 - val_loss: 3.3161 - val_accuracy1000: 0.3364 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 15s - loss: 3.2893 - accuracy1000: 0.3658 - val_loss: 3.3154 - val_accuracy1000: 0.3418 - 15s/epoch - 28ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2840 - accuracy1000: 0.3682 - val_loss: 3.3104 - val_accuracy1000: 0.3484 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2773 - accuracy1000: 0.3734 - val_loss: 3.3122 - val_accuracy1000: 0.3453 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 15s - loss: 3.2734 - accuracy1000: 0.3757 - val_loss: 3.3116 - val_accuracy1000: 0.3475 - 15s/epoch - 28ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2698 - accuracy1000: 0.3783 - val_loss: 3.3121 - val_accuracy1000: 0.3466 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2648 - accuracy1000: 0.3825 - val_loss: 3.3101 - val_accuracy1000: 0.3500 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 15s - loss: 3.2615 - accuracy1000: 0.3846 - val_loss: 3.3106 - val_accuracy1000: 0.3485 - 15s/epoch - 28ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2583 - accuracy1000: 0.3880 - val_loss: 3.3139 - val_accuracy1000: 0.3506 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 15s - loss: 3.2556 - accuracy1000: 0.3883 - val_loss: 3.3093 - val_accuracy1000: 0.3507 - 15s/epoch - 28ms/step
Epoch 13/50
526/526 - 15s - loss: 3.2529 - accuracy1000: 0.3919 - val_loss: 3.3089 - val_accuracy1000: 0.3533 - 15s/epoch - 28ms/step
Epoch 14/50
526/526 - 15s - loss: 3.2484 - accuracy1000: 0.3950 - val_loss: 3.3112 - val_accuracy1000: 0.3522 - 15s/epoch - 28ms/step
Epoch 15/50
526/526 - 15s - loss: 3.2454 - accuracy1000: 0.3965 - val_loss: 3.3111 - val_accuracy1000: 0.3503 - 15s/epoch - 28ms/step
Epoch 16/50
526/526 - 15s - loss: 3.2437 - accuracy1000: 0.3981 - val_loss: 3.3085 - val_accuracy1000: 0.3559 - 15s/epoch - 28ms/step
Epoch 17/50
526/526 - 15s - loss: 3.2394 - accuracy1000: 0.4007 - val_loss: 3.3117 - val_accuracy1000: 0.3521 - 15s/epoch - 28ms/step
Epoch 18/50
526/526 - 15s - loss: 3.2363 - accuracy1000: 0.4016 - val_loss: 3.3130 - val_accuracy1000: 0.3596 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 15s - loss: 3.2311 - accuracy1000: 0.4045 - val_loss: 3.3155 - val_accuracy1000: 0.3567 - 15s/epoch - 28ms/step
Epoch 20/50
526/526 - 15s - loss: 3.2286 - accuracy1000: 0.4052 - val_loss: 3.3141 - val_accuracy1000: 0.3559 - 15s/epoch - 28ms/step
Epoch 21/50
526/526 - 15s - loss: 3.2254 - accuracy1000: 0.4081 - val_loss: 3.3169 - val_accuracy1000: 0.3560 - 15s/epoch - 28ms/step
Epoch 22/50
526/526 - 15s - loss: 3.2206 - accuracy1000: 0.4102 - val_loss: 3.3216 - val_accuracy1000: 0.3525 - 15s/epoch - 28ms/step
Epoch 23/50
526/526 - 15s - loss: 3.2170 - accuracy1000: 0.4125 - val_loss: 3.3233 - val_accuracy1000: 0.3558 - 15s/epoch - 28ms/step
Epoch 24/50
526/526 - 15s - loss: 3.2122 - accuracy1000: 0.4156 - val_loss: 3.3217 - val_accuracy1000: 0.3588 - 15s/epoch - 28ms/step
Epoch 25/50
526/526 - 15s - loss: 3.2078 - accuracy1000: 0.4164 - val_loss: 3.3306 - val_accuracy1000: 0.3547 - 15s/epoch - 28ms/step
Epoch 26/50
526/526 - 15s - loss: 3.2033 - accuracy1000: 0.4178 - val_loss: 3.3312 - val_accuracy1000: 0.3585 - 15s/epoch - 28ms/step
testing model: results/PCAR/W7/deepOF_L2/h1000
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153274
{'0': {'precision': 0.26000350487762136, 'recall': 0.12275008733062455, 'f1-score': 0.16676762062957806, 'support': 108782}, '1': {'precision': 0.4739870379648635, 'recall': 0.1652392918718518, 'f1-score': 0.24505023918447494, 'support': 177482}, '2': {'precision': 0.32843694205486124, 'recall': 0.7493556319251051, 'f1-score': 0.45670396735475083, 'support': 135016}, 'accuracy': 0.3414712305355108, 'macro avg': {'precision': 0.35414249496578204, 'recall': 0.3457816703758605, 'f1-score': 0.2895072757229346, 'support': 421280}, 'weighted avg': {'precision': 0.37208533732471627, 'recall': 0.3414712305355108, 'f1-score': 0.29266916234958884, 'support': 421280}}
[[ 13353  14799  80630]
 [ 21910  29327 126245]
 [ 16094  17747 101175]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0926163
{'0': {'precision': 0.3895565394616628, 'recall': 0.12281207072273674, 'f1-score': 0.18674932196822938, 'support': 45134}, '1': {'precision': 0.4206331131860624, 'recall': 0.20462653165230107, 'f1-score': 0.2753182482187043, 'support': 45131}, '2': {'precision': 0.3464106081390032, 'recall': 0.7689809175801867, 'f1-score': 0.47764958073261454, 'support': 44334}, 'accuracy': 0.36307847755183914, 'macro avg': {'precision': 0.38553342026224285, 'recall': 0.3654731733184082, 'f1-score': 0.31323905030651605, 'support': 134599}, 'weighted avg': {'precision': 0.3857651675309433, 'recall': 0.36307847755183914, 'f1-score': 0.31226270826879954, 'support': 134599}}
[[ 5543  6683 32908]
 [ 4481  9235 31415]
 [ 4205  6037 34092]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042118
{'0': {'precision': 0.2943135245901639, 'recall': 0.10400072411296163, 'f1-score': 0.15369181380417335, 'support': 11048}, '1': {'precision': 0.4166246003701834, 'recall': 0.18404816769493793, 'f1-score': 0.25531037327283973, 'support': 13453}, '2': {'precision': 0.3505837000400044, 'recall': 0.7506034415634977, 'f1-score': 0.4779375309866138, 'support': 12843}, 'accuracy': 0.3552110111396744, 'macro avg': {'precision': 0.3538406083334505, 'recall': 0.34621744445713243, 'f1-score': 0.29564657268787564, 'support': 37344}, 'weighted avg': {'precision': 0.35772742684409764, 'recall': 0.3552110111396744, 'f1-score': 0.3018109822463877, 'support': 37344}}
[[1149 1578 8321]
 [1441 2476 9536]
 [1314 1889 9640]]
training model: results/PCAR/W7/deepVOL_L2/h10
Epoch 1/50
526/526 - 17s - loss: 3.3090 - accuracy10: 0.3698 - val_loss: 3.2432 - val_accuracy10: 0.4023 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2363 - accuracy10: 0.4055 - val_loss: 3.2222 - val_accuracy10: 0.4143 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.1982 - accuracy10: 0.4259 - val_loss: 3.1765 - val_accuracy10: 0.4411 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.1718 - accuracy10: 0.4390 - val_loss: 3.1598 - val_accuracy10: 0.4505 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.1570 - accuracy10: 0.4462 - val_loss: 3.1486 - val_accuracy10: 0.4571 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.1481 - accuracy10: 0.4504 - val_loss: 3.1372 - val_accuracy10: 0.4587 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.1367 - accuracy10: 0.4542 - val_loss: 3.1520 - val_accuracy10: 0.4559 - 14s/epoch - 26ms/step
Epoch 8/50
526/526 - 14s - loss: 3.1305 - accuracy10: 0.4570 - val_loss: 3.1379 - val_accuracy10: 0.4545 - 14s/epoch - 26ms/step
Epoch 9/50
526/526 - 14s - loss: 3.1228 - accuracy10: 0.4576 - val_loss: 3.1326 - val_accuracy10: 0.4586 - 14s/epoch - 26ms/step
Epoch 10/50
526/526 - 14s - loss: 3.1181 - accuracy10: 0.4611 - val_loss: 3.1292 - val_accuracy10: 0.4580 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.1135 - accuracy10: 0.4627 - val_loss: 3.1238 - val_accuracy10: 0.4603 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.1096 - accuracy10: 0.4628 - val_loss: 3.1323 - val_accuracy10: 0.4566 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 3.1058 - accuracy10: 0.4659 - val_loss: 3.1377 - val_accuracy10: 0.4577 - 14s/epoch - 26ms/step
Epoch 14/50
526/526 - 14s - loss: 3.1023 - accuracy10: 0.4655 - val_loss: 3.1303 - val_accuracy10: 0.4582 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 3.0982 - accuracy10: 0.4673 - val_loss: 3.1360 - val_accuracy10: 0.4588 - 14s/epoch - 26ms/step
Epoch 16/50
526/526 - 14s - loss: 3.0912 - accuracy10: 0.4690 - val_loss: 3.1316 - val_accuracy10: 0.4615 - 14s/epoch - 26ms/step
Epoch 17/50
526/526 - 14s - loss: 3.0880 - accuracy10: 0.4702 - val_loss: 3.1262 - val_accuracy10: 0.4617 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 14s - loss: 3.0844 - accuracy10: 0.4718 - val_loss: 3.1333 - val_accuracy10: 0.4596 - 14s/epoch - 26ms/step
Epoch 19/50
526/526 - 14s - loss: 3.0821 - accuracy10: 0.4723 - val_loss: 3.1300 - val_accuracy10: 0.4596 - 14s/epoch - 27ms/step
Epoch 20/50
526/526 - 14s - loss: 3.0785 - accuracy10: 0.4741 - val_loss: 3.1263 - val_accuracy10: 0.4623 - 14s/epoch - 27ms/step
Epoch 21/50
526/526 - 14s - loss: 3.0754 - accuracy10: 0.4746 - val_loss: 3.1332 - val_accuracy10: 0.4577 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h10
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.038027
{'0': {'precision': 0.43699810696102415, 'recall': 0.3919113770969642, 'f1-score': 0.4132285446884336, 'support': 128996}, '1': {'precision': 0.5151765215330942, 'recall': 0.3907538809531187, 'f1-score': 0.4444209502463367, 'support': 161365}, '2': {'precision': 0.4157091782429519, 'recall': 0.5817115272982799, 'f1-score': 0.48489633239847324, 'support': 130924}, 'accuracy': 0.4504527813712807, 'macro avg': {'precision': 0.4559612689123567, 'recall': 0.4547922617827876, 'f1-score': 0.44751527577774786, 'support': 421285}, 'weighted avg': {'precision': 0.4603267993282748, 'recall': 0.4504527813712807, 'f1-score': 0.44744859990283775, 'support': 421285}}
[[50555 31221 47220]
 [38486 63054 59825]
 [26646 28118 76160]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0466833
{'0': {'precision': 0.48504105132050535, 'recall': 0.41377366264067483, 'f1-score': 0.4465819466872616, 'support': 46117}, '1': {'precision': 0.456425749477109, 'recall': 0.3215981660389717, 'f1-score': 0.3773294908741595, 'support': 42749}, '2': {'precision': 0.4354754521170438, 'recall': 0.6202387720295622, 'f1-score': 0.5116891550616928, 'support': 45734}, 'accuracy': 0.45465081723625556, 'macro avg': {'precision': 0.4589807509715527, 'recall': 0.45187020023640284, 'f1-score': 0.445200197541038, 'support': 134600}, 'weighted avg': {'precision': 0.45911156653243357, 'recall': 0.45465081723625556, 'f1-score': 0.4467092857232343, 'support': 134600}}
[[19082  8683 18352]
 [10581 13748 18420]
 [ 9678  7690 28366]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0428528
{'0': {'precision': 0.48890122086570476, 'recall': 0.4152395915161037, 'f1-score': 0.44906974768498853, 'support': 12730}, '1': {'precision': 0.44363350550190883, 'recall': 0.34368475991649267, 'f1-score': 0.3873149691206744, 'support': 11496}, '2': {'precision': 0.4507913097736684, 'recall': 0.6056702995198536, 'f1-score': 0.5168780487804878, 'support': 13121}, 'accuracy': 0.46011727849626477, 'macro avg': {'precision': 0.46110867871376066, 'recall': 0.4548648836508167, 'f1-score': 0.45108758852871694, 'support': 37347}, 'weighted avg': {'precision': 0.4615780677540544, 'recall': 0.46011727849626477, 'f1-score': 0.45388351543872224, 'support': 37347}}
[[5286 2558 4886]
 [2749 3951 4796]
 [2777 2397 7947]]
training model: results/PCAR/W7/deepVOL_L2/h20
Epoch 1/50
526/526 - 17s - loss: 3.3229 - accuracy20: 0.3587 - val_loss: 3.2973 - val_accuracy20: 0.3714 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2612 - accuracy20: 0.3914 - val_loss: 3.2693 - val_accuracy20: 0.3921 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2356 - accuracy20: 0.4083 - val_loss: 3.2433 - val_accuracy20: 0.4012 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2188 - accuracy20: 0.4161 - val_loss: 3.2253 - val_accuracy20: 0.4165 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2070 - accuracy20: 0.4232 - val_loss: 3.2266 - val_accuracy20: 0.4174 - 14s/epoch - 26ms/step
Epoch 6/50
526/526 - 14s - loss: 3.1989 - accuracy20: 0.4262 - val_loss: 3.2119 - val_accuracy20: 0.4266 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.1919 - accuracy20: 0.4301 - val_loss: 3.2096 - val_accuracy20: 0.4289 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.1865 - accuracy20: 0.4328 - val_loss: 3.2066 - val_accuracy20: 0.4265 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.1835 - accuracy20: 0.4338 - val_loss: 3.2212 - val_accuracy20: 0.4213 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.1789 - accuracy20: 0.4351 - val_loss: 3.2248 - val_accuracy20: 0.4224 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.1758 - accuracy20: 0.4364 - val_loss: 3.2284 - val_accuracy20: 0.4207 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.1714 - accuracy20: 0.4397 - val_loss: 3.2142 - val_accuracy20: 0.4252 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 3.1698 - accuracy20: 0.4398 - val_loss: 3.2314 - val_accuracy20: 0.4193 - 14s/epoch - 27ms/step
Epoch 14/50
526/526 - 14s - loss: 3.1637 - accuracy20: 0.4416 - val_loss: 3.2142 - val_accuracy20: 0.4267 - 14s/epoch - 26ms/step
Epoch 15/50
526/526 - 14s - loss: 3.1623 - accuracy20: 0.4417 - val_loss: 3.2349 - val_accuracy20: 0.4217 - 14s/epoch - 26ms/step
Epoch 16/50
526/526 - 14s - loss: 3.1584 - accuracy20: 0.4439 - val_loss: 3.2228 - val_accuracy20: 0.4273 - 14s/epoch - 26ms/step
Epoch 17/50
526/526 - 14s - loss: 3.1552 - accuracy20: 0.4453 - val_loss: 3.2214 - val_accuracy20: 0.4255 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 14s - loss: 3.1532 - accuracy20: 0.4462 - val_loss: 3.2330 - val_accuracy20: 0.4231 - 14s/epoch - 26ms/step
testing model: results/PCAR/W7/deepVOL_L2/h20
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0623255
{'0': {'precision': 0.4064490478833108, 'recall': 0.3836699270518143, 'f1-score': 0.39473112657362336, 'support': 127899}, '1': {'precision': 0.4716885156661342, 'recall': 0.3244769668991258, 'f1-score': 0.3844729826552174, 'support': 162896}, '2': {'precision': 0.39419725512872883, 'recall': 0.569430607709403, 'f1-score': 0.46588105471382846, 'support': 130490}, 'accuracy': 0.41832013957297315, 'macro avg': {'precision': 0.424111606226058, 'recall': 0.42585916722011435, 'f1-score': 0.41502838798088976, 'support': 421285}, 'weighted avg': {'precision': 0.4278799364917478, 'recall': 0.41832013957297315, 'f1-score': 0.41280284408381884, 'support': 421285}}
[[49071 30617 48211]
 [44059 52856 65981]
 [27601 28584 74305]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716584
{'0': {'precision': 0.45712378154626787, 'recall': 0.37455142231947486, 'f1-score': 0.4117385290757112, 'support': 45700}, '1': {'precision': 0.40603317253684, 'recall': 0.28212957436062264, 'f1-score': 0.3329269614217598, 'support': 43558}, '2': {'precision': 0.4114278879935415, 'recall': 0.6069427903489039, 'f1-score': 0.49041708618830804, 'support': 45342}, 'accuracy': 0.422927191679049, 'macro avg': {'precision': 0.42486161402554984, 'recall': 0.42120792900966714, 'f1-score': 0.411694192228593, 'support': 134600}, 'weighted avg': {'precision': 0.42519697654849387, 'recall': 0.422927191679049, 'f1-score': 0.4127382978181224, 'support': 134600}}
[[17117  9403 19180]
 [11080 12289 20189]
 [ 9248  8574 27520]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700872
{'0': {'precision': 0.4514171959427434, 'recall': 0.38038181963415607, 'f1-score': 0.4128663083058783, 'support': 12519}, '1': {'precision': 0.4018639119694588, 'recall': 0.301974350320621, 'f1-score': 0.34483090856537235, 'support': 11852}, '2': {'precision': 0.4305835010060362, 'recall': 0.593711467324291, 'f1-score': 0.49915770377089536, 'support': 12976}, 'accuracy': 0.42961951428494927, 'macro avg': {'precision': 0.4279548696394128, 'recall': 0.4253558790930227, 'f1-score': 0.4189516402140487, 'support': 37347}, 'weighted avg': {'precision': 0.4284530074630775, 'recall': 0.42961951428494927, 'f1-score': 0.4212568507813003, 'support': 37347}}
[[4762 2741 5016]
 [3101 3579 5172]
 [2686 2586 7704]]
training model: results/PCAR/W7/deepVOL_L2/h30
Epoch 1/50
526/526 - 17s - loss: 3.3227 - accuracy30: 0.3646 - val_loss: 3.3106 - val_accuracy30: 0.3623 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2661 - accuracy30: 0.3920 - val_loss: 3.2903 - val_accuracy30: 0.3782 - 14s/epoch - 26ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2460 - accuracy30: 0.4029 - val_loss: 3.2881 - val_accuracy30: 0.3804 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2363 - accuracy30: 0.4082 - val_loss: 3.2838 - val_accuracy30: 0.3850 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2274 - accuracy30: 0.4127 - val_loss: 3.2869 - val_accuracy30: 0.3828 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2235 - accuracy30: 0.4143 - val_loss: 3.2801 - val_accuracy30: 0.3898 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2193 - accuracy30: 0.4161 - val_loss: 3.2814 - val_accuracy30: 0.3913 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2149 - accuracy30: 0.4178 - val_loss: 3.2732 - val_accuracy30: 0.3930 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2126 - accuracy30: 0.4203 - val_loss: 3.2738 - val_accuracy30: 0.3956 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2080 - accuracy30: 0.4218 - val_loss: 3.2642 - val_accuracy30: 0.4008 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2075 - accuracy30: 0.4221 - val_loss: 3.2704 - val_accuracy30: 0.3965 - 14s/epoch - 26ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2041 - accuracy30: 0.4241 - val_loss: 3.2644 - val_accuracy30: 0.4006 - 14s/epoch - 26ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2013 - accuracy30: 0.4250 - val_loss: 3.2656 - val_accuracy30: 0.3997 - 14s/epoch - 26ms/step
Epoch 14/50
526/526 - 14s - loss: 3.1983 - accuracy30: 0.4263 - val_loss: 3.2641 - val_accuracy30: 0.3995 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 3.1932 - accuracy30: 0.4288 - val_loss: 3.2595 - val_accuracy30: 0.4034 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 3.1919 - accuracy30: 0.4298 - val_loss: 3.2631 - val_accuracy30: 0.4022 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 3.1879 - accuracy30: 0.4319 - val_loss: 3.2576 - val_accuracy30: 0.4053 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 14s - loss: 3.1837 - accuracy30: 0.4334 - val_loss: 3.2659 - val_accuracy30: 0.4035 - 14s/epoch - 27ms/step
Epoch 19/50
526/526 - 14s - loss: 3.1786 - accuracy30: 0.4372 - val_loss: 3.2604 - val_accuracy30: 0.4073 - 14s/epoch - 27ms/step
Epoch 20/50
526/526 - 14s - loss: 3.1749 - accuracy30: 0.4377 - val_loss: 3.2546 - val_accuracy30: 0.4091 - 14s/epoch - 27ms/step
Epoch 21/50
526/526 - 14s - loss: 3.1726 - accuracy30: 0.4384 - val_loss: 3.2547 - val_accuracy30: 0.4101 - 14s/epoch - 27ms/step
Epoch 22/50
526/526 - 14s - loss: 3.1708 - accuracy30: 0.4383 - val_loss: 3.2491 - val_accuracy30: 0.4113 - 14s/epoch - 27ms/step
Epoch 23/50
526/526 - 14s - loss: 3.1668 - accuracy30: 0.4417 - val_loss: 3.2521 - val_accuracy30: 0.4103 - 14s/epoch - 27ms/step
Epoch 24/50
526/526 - 14s - loss: 3.1654 - accuracy30: 0.4424 - val_loss: 3.2456 - val_accuracy30: 0.4120 - 14s/epoch - 27ms/step
Epoch 25/50
526/526 - 14s - loss: 3.1613 - accuracy30: 0.4422 - val_loss: 3.2489 - val_accuracy30: 0.4137 - 14s/epoch - 26ms/step
Epoch 26/50
526/526 - 14s - loss: 3.1580 - accuracy30: 0.4455 - val_loss: 3.2503 - val_accuracy30: 0.4104 - 14s/epoch - 27ms/step
Epoch 27/50
526/526 - 14s - loss: 3.1552 - accuracy30: 0.4461 - val_loss: 3.2505 - val_accuracy30: 0.4112 - 14s/epoch - 27ms/step
Epoch 28/50
526/526 - 14s - loss: 3.1496 - accuracy30: 0.4482 - val_loss: 3.2556 - val_accuracy30: 0.4103 - 14s/epoch - 27ms/step
Epoch 29/50
526/526 - 14s - loss: 3.1490 - accuracy30: 0.4490 - val_loss: 3.2646 - val_accuracy30: 0.4085 - 14s/epoch - 26ms/step
Epoch 30/50
526/526 - 14s - loss: 3.1451 - accuracy30: 0.4491 - val_loss: 3.2603 - val_accuracy30: 0.4077 - 14s/epoch - 27ms/step
Epoch 31/50
526/526 - 14s - loss: 3.1416 - accuracy30: 0.4525 - val_loss: 3.2686 - val_accuracy30: 0.4074 - 14s/epoch - 27ms/step
Epoch 32/50
526/526 - 14s - loss: 3.1384 - accuracy30: 0.4532 - val_loss: 3.2651 - val_accuracy30: 0.4083 - 14s/epoch - 27ms/step
Epoch 33/50
526/526 - 14s - loss: 3.1346 - accuracy30: 0.4548 - val_loss: 3.2746 - val_accuracy30: 0.4090 - 14s/epoch - 27ms/step
Epoch 34/50
526/526 - 14s - loss: 3.1300 - accuracy30: 0.4542 - val_loss: 3.2778 - val_accuracy30: 0.4076 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h30
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1014456
{'0': {'precision': 0.34491239669421486, 'recall': 0.47375494932616513, 'f1-score': 0.39919499858436064, 'support': 110116}, '1': {'precision': 0.5739419411592219, 'recall': 0.12012601775704758, 'f1-score': 0.19867034324091148, 'support': 195528}, '2': {'precision': 0.33193954022286143, 'recall': 0.6576473742011916, 'f1-score': 0.44119250939806004, 'support': 115641}, 'accuracy': 0.36010539183688, 'macro avg': {'precision': 0.4169312926920994, 'recall': 0.41717611376146807, 'f1-score': 0.34635261707444404, 'support': 421285}, 'weighted avg': {'precision': 0.4476492486470499, 'recall': 0.36010539183688, 'f1-score': 0.3176550656126505, 'support': 421285}}
[[ 52168   9102  48846]
 [ 67826  23488 104214]
 [ 31256   8334  76051]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0807831
{'0': {'precision': 0.4367404981470309, 'recall': 0.44791620630220536, 'f1-score': 0.44225776187463184, 'support': 45254}, '1': {'precision': 0.43274311671456384, 'recall': 0.10514697601081203, 'f1-score': 0.16918560400130478, 'support': 44395}, '2': {'precision': 0.3951370137336727, 'recall': 0.6803853084469756, 'f1-score': 0.49993461488165297, 'support': 44951}, 'accuracy': 0.4124962852897474, 'macro avg': {'precision': 0.4215402095317558, 'recall': 0.41114949691999775, 'f1-score': 0.37045932691919653, 'support': 134600}, 'weighted avg': {'precision': 0.42152815062430254, 'recall': 0.4124962852897474, 'f1-score': 0.37145236641201856, 'support': 134600}}
[[20270  3395 21589]
 [14499  4668 25228]
 [11643  2724 30584]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081394
{'0': {'precision': 0.42088950875561754, 'recall': 0.44245336808666613, 'f1-score': 0.4314021363618314, 'support': 12277}, '1': {'precision': 0.43111404087013844, 'recall': 0.10602253384129043, 'f1-score': 0.17019061869754734, 'support': 12337}, '2': {'precision': 0.4008034754986687, 'recall': 0.6738396293096678, 'f1-score': 0.5026362038664324, 'support': 12733}, 'accuracy': 0.4102069778027686, 'macro avg': {'precision': 0.41760234170814153, 'recall': 0.4074385104125415, 'f1-score': 0.36807631964193704, 'support': 37347}, 'weighted avg': {'precision': 0.4174189379262635, 'recall': 0.4102069778027686, 'f1-score': 0.3694013568644638, 'support': 37347}}
[[5432  974 5871]
 [4073 1308 6956]
 [3401  752 8580]]
training model: results/PCAR/W7/deepVOL_L2/h50
Epoch 1/50
526/526 - 16s - loss: 3.3284 - accuracy50: 0.3551 - val_loss: 3.3251 - val_accuracy50: 0.3546 - 16s/epoch - 31ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2802 - accuracy50: 0.3757 - val_loss: 3.3026 - val_accuracy50: 0.3631 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2599 - accuracy50: 0.3893 - val_loss: 3.2972 - val_accuracy50: 0.3638 - 14s/epoch - 26ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2515 - accuracy50: 0.3965 - val_loss: 3.2817 - val_accuracy50: 0.3685 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2458 - accuracy50: 0.4007 - val_loss: 3.2799 - val_accuracy50: 0.3758 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2401 - accuracy50: 0.4040 - val_loss: 3.2884 - val_accuracy50: 0.3678 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2363 - accuracy50: 0.4066 - val_loss: 3.2822 - val_accuracy50: 0.3726 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 15s - loss: 3.2312 - accuracy50: 0.4111 - val_loss: 3.2780 - val_accuracy50: 0.3760 - 15s/epoch - 28ms/step
Epoch 9/50
526/526 - 15s - loss: 3.2287 - accuracy50: 0.4114 - val_loss: 3.2845 - val_accuracy50: 0.3739 - 15s/epoch - 28ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2253 - accuracy50: 0.4126 - val_loss: 3.2837 - val_accuracy50: 0.3760 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 15s - loss: 3.2214 - accuracy50: 0.4159 - val_loss: 3.2806 - val_accuracy50: 0.3791 - 15s/epoch - 28ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2209 - accuracy50: 0.4150 - val_loss: 3.2760 - val_accuracy50: 0.3800 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2173 - accuracy50: 0.4168 - val_loss: 3.2857 - val_accuracy50: 0.3789 - 14s/epoch - 27ms/step
Epoch 14/50
526/526 - 14s - loss: 3.2159 - accuracy50: 0.4175 - val_loss: 3.2816 - val_accuracy50: 0.3813 - 14s/epoch - 28ms/step
Epoch 15/50
526/526 - 14s - loss: 3.2112 - accuracy50: 0.4188 - val_loss: 3.2842 - val_accuracy50: 0.3804 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 3.2089 - accuracy50: 0.4201 - val_loss: 3.2831 - val_accuracy50: 0.3828 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 3.2040 - accuracy50: 0.4223 - val_loss: 3.2785 - val_accuracy50: 0.3862 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 15s - loss: 3.2018 - accuracy50: 0.4230 - val_loss: 3.2901 - val_accuracy50: 0.3807 - 15s/epoch - 28ms/step
Epoch 19/50
526/526 - 14s - loss: 3.1984 - accuracy50: 0.4251 - val_loss: 3.2890 - val_accuracy50: 0.3817 - 14s/epoch - 27ms/step
Epoch 20/50
526/526 - 14s - loss: 3.1960 - accuracy50: 0.4257 - val_loss: 3.2854 - val_accuracy50: 0.3851 - 14s/epoch - 27ms/step
Epoch 21/50
526/526 - 14s - loss: 3.1926 - accuracy50: 0.4280 - val_loss: 3.2833 - val_accuracy50: 0.3850 - 14s/epoch - 27ms/step
Epoch 22/50
526/526 - 14s - loss: 3.1891 - accuracy50: 0.4307 - val_loss: 3.2974 - val_accuracy50: 0.3827 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h50
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960796
{'0': {'precision': 0.38588246693474154, 'recall': 0.19592328695238642, 'f1-score': 0.2598921058928455, 'support': 121961}, '1': {'precision': 0.4944003113886874, 'recall': 0.1639232709567666, 'f1-score': 0.24621240489711047, 'support': 170470}, '2': {'precision': 0.3364570847408376, 'recall': 0.7907631893460816, 'f1-score': 0.47206013504905076, 'support': 128854}, 'accuracy': 0.36491211412701613, 'macro avg': {'precision': 0.4055799543547555, 'recall': 0.38353658241841154, 'f1-score': 0.3260548819463356, 'support': 421285}, 'weighted avg': {'precision': 0.4146762259027818, 'recall': 0.36491211412701613, 'f1-score': 0.31925030900985824, 'support': 421285}}
[[ 23895  15572  82494]
 [ 24072  27944 118454]
 [ 13956  13005 101893]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930295
{'0': {'precision': 0.44619408271127337, 'recall': 0.18031090364629204, 'f1-score': 0.2568332575389296, 'support': 45416}, '1': {'precision': 0.4250157309655317, 'recall': 0.13697611536728255, 'f1-score': 0.207180955302217, 'support': 44380}, '2': {'precision': 0.3584713175861257, 'recall': 0.8156414605838764, 'f1-score': 0.4980510807643034, 'support': 44804}, 'accuracy': 0.3775037147102526, 'macro avg': {'precision': 0.40989371042097694, 'recall': 0.37764282653248366, 'f1-score': 0.32068843120181667, 'support': 134600}, 'weighted avg': {'precision': 0.4100111256596899, 'recall': 0.3775037147102526, 'f1-score': 0.3207556511386647, 'support': 134600}}
[[ 8189  4495 32732]
 [ 5633  6079 32668]
 [ 4531  3729 36544]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923096
{'0': {'precision': 0.4250132485426603, 'recall': 0.19813884542534793, 'f1-score': 0.27027634239496745, 'support': 12143}, '1': {'precision': 0.407587323617858, 'recall': 0.14008586420734617, 'f1-score': 0.2085083722856636, 'support': 12578}, '2': {'precision': 0.36370281036436064, 'recall': 0.7882147948677333, 'f1-score': 0.49773687764135144, 'support': 12626}, 'accuracy': 0.37807588293571104, 'macro avg': {'precision': 0.39876779417495967, 'recall': 0.3754798348334758, 'f1-score': 0.32550719744066087, 'support': 37347}, 'weighted avg': {'precision': 0.3984170326178638, 'recall': 0.37807588293571104, 'f1-score': 0.32637185716150885, 'support': 37347}}
[[2406 1382 8355]
 [1760 1762 9056]
 [1495 1179 9952]]
training model: results/PCAR/W7/deepVOL_L2/h100
Epoch 1/50
526/526 - 16s - loss: 3.3269 - accuracy100: 0.3558 - val_loss: 3.3340 - val_accuracy100: 0.3449 - 16s/epoch - 31ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2782 - accuracy100: 0.3766 - val_loss: 3.2887 - val_accuracy100: 0.3640 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2571 - accuracy100: 0.3899 - val_loss: 3.2846 - val_accuracy100: 0.3679 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2469 - accuracy100: 0.3969 - val_loss: 3.2926 - val_accuracy100: 0.3620 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2406 - accuracy100: 0.4008 - val_loss: 3.2876 - val_accuracy100: 0.3641 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2391 - accuracy100: 0.4030 - val_loss: 3.2871 - val_accuracy100: 0.3667 - 14s/epoch - 26ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2377 - accuracy100: 0.4049 - val_loss: 3.2905 - val_accuracy100: 0.3640 - 14s/epoch - 26ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2347 - accuracy100: 0.4054 - val_loss: 3.2891 - val_accuracy100: 0.3671 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2328 - accuracy100: 0.4064 - val_loss: 3.2876 - val_accuracy100: 0.3681 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2297 - accuracy100: 0.4090 - val_loss: 3.2893 - val_accuracy100: 0.3688 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2280 - accuracy100: 0.4094 - val_loss: 3.2918 - val_accuracy100: 0.3663 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2256 - accuracy100: 0.4116 - val_loss: 3.2920 - val_accuracy100: 0.3661 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2238 - accuracy100: 0.4121 - val_loss: 3.2960 - val_accuracy100: 0.3636 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h100
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1057904
{'0': {'precision': 0.303890777896021, 'recall': 0.211490349443185, 'f1-score': 0.2494075293040001, 'support': 110719}, '1': {'precision': 0.5900759577278731, 'recall': 0.18907407407407406, 'f1-score': 0.28638403590318956, 'support': 189000}, '2': {'precision': 0.3107896119095713, 'recall': 0.7252192224799697, 'f1-score': 0.4351132793895917, 'support': 121566}, 'accuracy': 0.3496753978897896, 'macro avg': {'precision': 0.40158544917782174, 'recall': 0.3752612153324096, 'f1-score': 0.32363494819892713, 'support': 421285}, 'weighted avg': {'precision': 0.43427202252593017, 'recall': 0.3496753978897896, 'f1-score': 0.3195834552499793, 'support': 421285}}
[[ 23416  13456  73847]
 [ 31603  35735 121662]
 [ 22035  11369  88162]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960768
{'0': {'precision': 0.3739137212111765, 'recall': 0.21382568582443787, 'f1-score': 0.27206737176397205, 'support': 44873}, '1': {'precision': 0.43822126480997076, 'recall': 0.12698978909350336, 'f1-score': 0.19691626910046323, 'support': 44854}, '2': {'precision': 0.34770327597169093, 'recall': 0.7434091770106745, 'f1-score': 0.4738023207919667, 'support': 44873}, 'accuracy': 0.3614413075780089, 'macro avg': {'precision': 0.38661275399761275, 'recall': 0.3614082173095386, 'f1-score': 0.31426198721880066, 'support': 134600}, 'weighted avg': {'precision': 0.38660546899237175, 'recall': 0.3614413075780089, 'f1-score': 0.314278551621804, 'support': 134600}}
[[ 9595  3691 31587]
 [ 8163  5696 30995]
 [ 7903  3611 33359]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945711
{'0': {'precision': 0.3576285014957846, 'recall': 0.2147114050126541, 'f1-score': 0.2683262765903178, 'support': 12249}, '1': {'precision': 0.4322120285423038, 'recall': 0.13823457494498329, 'f1-score': 0.2094732291730995, 'support': 12269}, '2': {'precision': 0.35981433886992215, 'recall': 0.731155974744719, 'f1-score': 0.48228700704406396, 'support': 12829}, 'accuracy': 0.36699065520657614, 'macro avg': {'precision': 0.3832182896360035, 'recall': 0.36136731823411883, 'f1-score': 0.3200288376024938, 'support': 37347}, 'weighted avg': {'precision': 0.38288106263875604, 'recall': 0.36699065520657614, 'f1-score': 0.322489507163838, 'support': 37347}}
[[2630 1105 8514]
 [2398 1696 8175]
 [2326 1123 9380]]
training model: results/PCAR/W7/deepVOL_L2/h200
Epoch 1/50
526/526 - 17s - loss: 3.3377 - accuracy200: 0.3515 - val_loss: 3.3524 - val_accuracy200: 0.3367 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2912 - accuracy200: 0.3678 - val_loss: 3.3416 - val_accuracy200: 0.3367 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2760 - accuracy200: 0.3770 - val_loss: 3.3436 - val_accuracy200: 0.3389 - 14s/epoch - 26ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2620 - accuracy200: 0.3848 - val_loss: 3.3095 - val_accuracy200: 0.3516 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2549 - accuracy200: 0.3915 - val_loss: 3.3007 - val_accuracy200: 0.3558 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2479 - accuracy200: 0.3959 - val_loss: 3.2937 - val_accuracy200: 0.3603 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2441 - accuracy200: 0.3978 - val_loss: 3.2916 - val_accuracy200: 0.3578 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2399 - accuracy200: 0.3996 - val_loss: 3.2989 - val_accuracy200: 0.3567 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2371 - accuracy200: 0.4012 - val_loss: 3.2904 - val_accuracy200: 0.3618 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2348 - accuracy200: 0.4035 - val_loss: 3.2873 - val_accuracy200: 0.3639 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2327 - accuracy200: 0.4043 - val_loss: 3.2880 - val_accuracy200: 0.3673 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2287 - accuracy200: 0.4081 - val_loss: 3.2880 - val_accuracy200: 0.3665 - 14s/epoch - 26ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2265 - accuracy200: 0.4097 - val_loss: 3.2882 - val_accuracy200: 0.3679 - 14s/epoch - 27ms/step
Epoch 14/50
526/526 - 14s - loss: 3.2233 - accuracy200: 0.4107 - val_loss: 3.2954 - val_accuracy200: 0.3645 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 3.2218 - accuracy200: 0.4108 - val_loss: 3.3019 - val_accuracy200: 0.3627 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 3.2168 - accuracy200: 0.4137 - val_loss: 3.2956 - val_accuracy200: 0.3650 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 3.2149 - accuracy200: 0.4139 - val_loss: 3.3034 - val_accuracy200: 0.3657 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 14s - loss: 3.2115 - accuracy200: 0.4173 - val_loss: 3.3146 - val_accuracy200: 0.3611 - 14s/epoch - 27ms/step
Epoch 19/50
526/526 - 14s - loss: 3.2106 - accuracy200: 0.4171 - val_loss: 3.3154 - val_accuracy200: 0.3623 - 14s/epoch - 27ms/step
Epoch 20/50
526/526 - 14s - loss: 3.2059 - accuracy200: 0.4200 - val_loss: 3.3233 - val_accuracy200: 0.3597 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h200
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.111071
{'0': {'precision': 0.2867183354644538, 'recall': 0.2962503595053207, 'f1-score': 0.2914064192160971, 'support': 111264}, '1': {'precision': 0.5446170576355445, 'recall': 0.18882365614564256, 'f1-score': 0.2804223493180818, 'support': 185660}, '2': {'precision': 0.31797215976722654, 'recall': 0.6186344593562291, 'f1-score': 0.4200451526426853, 'support': 124361}, 'accuracy': 0.34407348944301364, 'macro avg': {'precision': 0.38310251762240827, 'recall': 0.36790282500239746, 'f1-score': 0.3306246403922881, 'support': 421285}, 'weighted avg': {'precision': 0.40960007491020145, 'recall': 0.34407348944301364, 'f1-score': 0.3245391894557174, 'support': 421285}}
[[ 32962  14747  63555]
 [ 49140  35057 101463]
 [ 32861  14566  76934]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920045
{'0': {'precision': 0.38123578787793716, 'recall': 0.29904648653409965, 'f1-score': 0.33517622667588115, 'support': 45411}, '1': {'precision': 0.4312837484758753, 'recall': 0.16800488544093367, 'f1-score': 0.241812618008985, 'support': 44213}, '2': {'precision': 0.359019521503009, 'recall': 0.652614727854856, 'f1-score': 0.4632137108228388, 'support': 44976}, 'accuracy': 0.37414561664190193, 'macro avg': {'precision': 0.39051301928560717, 'recall': 0.3732220332766298, 'f1-score': 0.346734185169235, 'support': 134600}, 'weighted avg': {'precision': 0.3902519222422602, 'recall': 0.37414561664190193, 'f1-score': 0.34729159559864553, 'support': 134600}}
[[13580  4787 27044]
 [11425  7428 25360]
 [10616  5008 29352]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094642
{'0': {'precision': 0.33955564573399616, 'recall': 0.2852151682999574, 'f1-score': 0.31002223045572436, 'support': 11735}, '1': {'precision': 0.47862470438420956, 'recall': 0.19924271109428246, 'f1-score': 0.28136028232274624, 'support': 13205}, '2': {'precision': 0.3491565498113036, 'recall': 0.6189248005158379, 'f1-score': 0.4464534883720931, 'support': 12407}, 'accuracy': 0.36567863549950463, 'macro avg': {'precision': 0.3891122999765031, 'recall': 0.36779422663669264, 'f1-score': 0.34594533371685454, 'support': 37347}, 'weighted avg': {'precision': 0.39191662081534734, 'recall': 0.36567863549950463, 'f1-score': 0.3452117126597143, 'support': 37347}}
[[3347 1293 7095]
 [3355 2631 7219]
 [3155 1573 7679]]
training model: results/PCAR/W7/deepVOL_L2/h300
Epoch 1/50
526/526 - 17s - loss: 3.3273 - accuracy300: 0.3580 - val_loss: 3.3559 - val_accuracy300: 0.3277 - 17s/epoch - 32ms/step
Epoch 2/50
526/526 - 14s - loss: 3.2998 - accuracy300: 0.3615 - val_loss: 3.3223 - val_accuracy300: 0.3310 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 15s - loss: 3.2816 - accuracy300: 0.3702 - val_loss: 3.3239 - val_accuracy300: 0.3328 - 15s/epoch - 28ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2714 - accuracy300: 0.3763 - val_loss: 3.3230 - val_accuracy300: 0.3352 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 15s - loss: 3.2677 - accuracy300: 0.3798 - val_loss: 3.3162 - val_accuracy300: 0.3361 - 15s/epoch - 28ms/step
Epoch 6/50
526/526 - 15s - loss: 3.2617 - accuracy300: 0.3834 - val_loss: 3.3061 - val_accuracy300: 0.3439 - 15s/epoch - 28ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2574 - accuracy300: 0.3868 - val_loss: 3.3013 - val_accuracy300: 0.3456 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2548 - accuracy300: 0.3873 - val_loss: 3.3058 - val_accuracy300: 0.3431 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2537 - accuracy300: 0.3881 - val_loss: 3.3156 - val_accuracy300: 0.3412 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2514 - accuracy300: 0.3895 - val_loss: 3.3117 - val_accuracy300: 0.3415 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2493 - accuracy300: 0.3919 - val_loss: 3.3191 - val_accuracy300: 0.3361 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2466 - accuracy300: 0.3924 - val_loss: 3.3246 - val_accuracy300: 0.3349 - 14s/epoch - 26ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2450 - accuracy300: 0.3936 - val_loss: 3.3272 - val_accuracy300: 0.3381 - 14s/epoch - 26ms/step
Epoch 14/50
526/526 - 14s - loss: 3.2435 - accuracy300: 0.3941 - val_loss: 3.3147 - val_accuracy300: 0.3416 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 3.2384 - accuracy300: 0.3979 - val_loss: 3.3254 - val_accuracy300: 0.3385 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 3.2347 - accuracy300: 0.4012 - val_loss: 3.3238 - val_accuracy300: 0.3390 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 3.2330 - accuracy300: 0.4013 - val_loss: 3.3183 - val_accuracy300: 0.3412 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h300
Evaluating performance on  test set...
1646/1646 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110733
{'0': {'precision': 0.2865848637074858, 'recall': 0.1551521204123123, 'f1-score': 0.20131549261553947, 'support': 112148}, '1': {'precision': 0.5379779538408543, 'recall': 0.1042736564494322, 'f1-score': 0.1746883228858388, 'support': 179729}, '2': {'precision': 0.3193587405674569, 'recall': 0.8038606577645895, 'f1-score': 0.45711448295257306, 'support': 129408}, 'accuracy': 0.33271300900815365, 'macro avg': {'precision': 0.38130718603859903, 'recall': 0.3544288115421113, 'f1-score': 0.27770609948465047, 'support': 421285}, 'weighted avg': {'precision': 0.4039017170330857, 'recall': 0.33271300900815365, 'f1-score': 0.2685307059584913, 'support': 421285}}
[[ 17400   7664  87084]
 [ 26364  18741 134624]
 [ 16951   8431 104026]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979694
{'0': {'precision': 0.3649426863379586, 'recall': 0.1465929369258223, 'f1-score': 0.2091663523198793, 'support': 45391}, '1': {'precision': 0.43083873957367935, 'recall': 0.0836934017463318, 'f1-score': 0.14015979498002562, 'support': 44436}, '2': {'precision': 0.3403165173806098, 'recall': 0.8188863824179751, 'f1-score': 0.4808141212264274, 'support': 44773}, 'accuracy': 0.34945765230312037, 'macro avg': {'precision': 0.3786993144307493, 'recall': 0.3497242403633764, 'f1-score': 0.2767134228421108, 'support': 134600}, 'weighted avg': {'precision': 0.37850561025218676, 'recall': 0.34945765230312037, 'f1-score': 0.2767451797738105, 'support': 134600}}
[[ 6654  2412 36325]
 [ 5971  3719 34746]
 [ 5608  2501 36664]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099931
{'0': {'precision': 0.33089086000771306, 'recall': 0.14786729857819905, 'f1-score': 0.2043952117205646, 'support': 11605}, '1': {'precision': 0.4693526170798898, 'recall': 0.10213563132259273, 'f1-score': 0.16776417010277556, 'support': 13345}, '2': {'precision': 0.33745770243018763, 'recall': 0.7964023554085666, 'f1-score': 0.4740481106256301, 'support': 12397}, 'accuracy': 0.34680161726510833, 'macro avg': {'precision': 0.3792337265059302, 'recall': 0.3488017617697861, 'f1-score': 0.28206916414965677, 'support': 37347}, 'weighted avg': {'precision': 0.38254644930911924, 'recall': 0.34680161726510833, 'f1-score': 0.2808148903383037, 'support': 37347}}
[[ 1716   677  9212]
 [ 1810  1363 10172]
 [ 1660   864  9873]]
training model: results/PCAR/W7/deepVOL_L2/h500
Epoch 1/50
526/526 - 16s - loss: 3.3348 - accuracy500: 0.3591 - val_loss: 3.3504 - val_accuracy500: 0.3249 - 16s/epoch - 31ms/step
Epoch 2/50
526/526 - 14s - loss: 3.3019 - accuracy500: 0.3582 - val_loss: 3.3285 - val_accuracy500: 0.3320 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2874 - accuracy500: 0.3655 - val_loss: 3.3292 - val_accuracy500: 0.3334 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2799 - accuracy500: 0.3707 - val_loss: 3.3248 - val_accuracy500: 0.3364 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2737 - accuracy500: 0.3739 - val_loss: 3.3333 - val_accuracy500: 0.3358 - 14s/epoch - 27ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2720 - accuracy500: 0.3745 - val_loss: 3.3269 - val_accuracy500: 0.3366 - 14s/epoch - 28ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2671 - accuracy500: 0.3797 - val_loss: 3.3292 - val_accuracy500: 0.3379 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2655 - accuracy500: 0.3806 - val_loss: 3.3252 - val_accuracy500: 0.3376 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2627 - accuracy500: 0.3832 - val_loss: 3.3278 - val_accuracy500: 0.3367 - 14s/epoch - 28ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2618 - accuracy500: 0.3837 - val_loss: 3.3197 - val_accuracy500: 0.3407 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2570 - accuracy500: 0.3881 - val_loss: 3.3202 - val_accuracy500: 0.3394 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2537 - accuracy500: 0.3911 - val_loss: 3.3209 - val_accuracy500: 0.3401 - 14s/epoch - 27ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2500 - accuracy500: 0.3936 - val_loss: 3.3278 - val_accuracy500: 0.3404 - 14s/epoch - 27ms/step
Epoch 14/50
526/526 - 14s - loss: 3.2487 - accuracy500: 0.3931 - val_loss: 3.3269 - val_accuracy500: 0.3403 - 14s/epoch - 27ms/step
Epoch 15/50
526/526 - 14s - loss: 3.2458 - accuracy500: 0.3958 - val_loss: 3.3364 - val_accuracy500: 0.3381 - 14s/epoch - 27ms/step
Epoch 16/50
526/526 - 14s - loss: 3.2423 - accuracy500: 0.3993 - val_loss: 3.3352 - val_accuracy500: 0.3410 - 14s/epoch - 27ms/step
Epoch 17/50
526/526 - 14s - loss: 3.2388 - accuracy500: 0.4016 - val_loss: 3.3430 - val_accuracy500: 0.3437 - 14s/epoch - 27ms/step
Epoch 18/50
526/526 - 14s - loss: 3.2360 - accuracy500: 0.4024 - val_loss: 3.3445 - val_accuracy500: 0.3410 - 14s/epoch - 26ms/step
Epoch 19/50
526/526 - 14s - loss: 3.2316 - accuracy500: 0.4056 - val_loss: 3.3470 - val_accuracy500: 0.3423 - 14s/epoch - 27ms/step
Epoch 20/50
526/526 - 14s - loss: 3.2287 - accuracy500: 0.4091 - val_loss: 3.3562 - val_accuracy500: 0.3388 - 14s/epoch - 27ms/step
testing model: results/PCAR/W7/deepVOL_L2/h500
Evaluating performance on  test set...
1646/1646 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176229
{'0': {'precision': 0.2848101265822785, 'recall': 0.15247980311379808, 'f1-score': 0.19862241994122634, 'support': 112146}, '1': {'precision': 0.5830755374554568, 'recall': 0.08301322971081959, 'f1-score': 0.14533493406732842, 'support': 179369}, '2': {'precision': 0.3154348421842792, 'recall': 0.8160129459813517, 'f1-score': 0.45499035400169285, 'support': 129770}, 'accuracy': 0.32729387469290383, 'macro avg': {'precision': 0.3944401687406715, 'recall': 0.3505019929353231, 'f1-score': 0.26631590267008254, 'support': 421285}, 'weighted avg': {'precision': 0.4212349644630072, 'recall': 0.32729387469290383, 'f1-score': 0.254904375741484, 'support': 421285}}
[[ 17100   4966  90080]
 [ 24745  14890 139734]
 [ 18195   5681 105894]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023684
{'0': {'precision': 0.3535358826610791, 'recall': 0.14912280701754385, 'f1-score': 0.20976564928202895, 'support': 45258}, '1': {'precision': 0.45345448311332076, 'recall': 0.059427518648332886, 'f1-score': 0.10508333167795635, 'support': 44508}, '2': {'precision': 0.33722658351340756, 'recall': 0.824954275772851, 'f1-score': 0.4787490858256046, 'support': 44834}, 'accuracy': 0.34457652303120356, 'macro avg': {'precision': 0.38140564976260244, 'recall': 0.3445015338129092, 'f1-score': 0.26453268892853, 'support': 134600}, 'weighted avg': {'precision': 0.38114335629363233, 'recall': 0.34457652303120356, 'f1-score': 0.2647463536064911, 'support': 134600}}
[[ 6749  1667 36842]
 [ 6014  2645 35849]
 [ 6327  1521 36986]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052494
{'0': {'precision': 0.33339615529589145, 'recall': 0.1561341571050309, 'f1-score': 0.2126713152200048, 'support': 11330}, '1': {'precision': 0.4697125256673511, 'recall': 0.06766250092435111, 'f1-score': 0.11828582509210783, 'support': 13523}, '2': {'precision': 0.33658990462898347, 'recall': 0.810709140387386, 'f1-score': 0.47568506821330453, 'support': 12494}, 'accuracy': 0.34307976544300745, 'macro avg': {'precision': 0.37989952853074205, 'recall': 0.3448352661389227, 'f1-score': 0.2688807361751391, 'support': 37347}, 'weighted avg': {'precision': 0.38382347156495994, 'recall': 0.34307976544300745, 'f1-score': 0.26648337099151886, 'support': 37347}}
[[ 1769   500  9061]
 [ 1705   915 10903]
 [ 1832   533 10129]]
training model: results/PCAR/W7/deepVOL_L2/h1000
Epoch 1/50
526/526 - 16s - loss: 3.3375 - accuracy1000: 0.3632 - val_loss: 3.3717 - val_accuracy1000: 0.3309 - 16s/epoch - 31ms/step
Epoch 2/50
526/526 - 14s - loss: 3.3114 - accuracy1000: 0.3629 - val_loss: 3.3295 - val_accuracy1000: 0.3363 - 14s/epoch - 27ms/step
Epoch 3/50
526/526 - 14s - loss: 3.2950 - accuracy1000: 0.3615 - val_loss: 3.3121 - val_accuracy1000: 0.3447 - 14s/epoch - 27ms/step
Epoch 4/50
526/526 - 14s - loss: 3.2841 - accuracy1000: 0.3693 - val_loss: 3.3037 - val_accuracy1000: 0.3508 - 14s/epoch - 27ms/step
Epoch 5/50
526/526 - 14s - loss: 3.2800 - accuracy1000: 0.3738 - val_loss: 3.3135 - val_accuracy1000: 0.3516 - 14s/epoch - 26ms/step
Epoch 6/50
526/526 - 14s - loss: 3.2732 - accuracy1000: 0.3773 - val_loss: 3.3037 - val_accuracy1000: 0.3528 - 14s/epoch - 27ms/step
Epoch 7/50
526/526 - 14s - loss: 3.2674 - accuracy1000: 0.3809 - val_loss: 3.3064 - val_accuracy1000: 0.3576 - 14s/epoch - 27ms/step
Epoch 8/50
526/526 - 14s - loss: 3.2623 - accuracy1000: 0.3814 - val_loss: 3.3120 - val_accuracy1000: 0.3551 - 14s/epoch - 27ms/step
Epoch 9/50
526/526 - 14s - loss: 3.2600 - accuracy1000: 0.3855 - val_loss: 3.3060 - val_accuracy1000: 0.3563 - 14s/epoch - 27ms/step
Epoch 10/50
526/526 - 14s - loss: 3.2573 - accuracy1000: 0.3855 - val_loss: 3.3045 - val_accuracy1000: 0.3562 - 14s/epoch - 27ms/step
Epoch 11/50
526/526 - 14s - loss: 3.2537 - accuracy1000: 0.3896 - val_loss: 3.3040 - val_accuracy1000: 0.3549 - 14s/epoch - 27ms/step
Epoch 12/50
526/526 - 14s - loss: 3.2494 - accuracy1000: 0.3909 - val_loss: 3.3160 - val_accuracy1000: 0.3535 - 14s/epoch - 26ms/step
Epoch 13/50
526/526 - 14s - loss: 3.2449 - accuracy1000: 0.3953 - val_loss: 3.3126 - val_accuracy1000: 0.3530 - 14s/epoch - 26ms/step
Epoch 14/50
526/526 - 14s - loss: 3.2424 - accuracy1000: 0.3955 - val_loss: 3.3155 - val_accuracy1000: 0.3530 - 14s/epoch - 26ms/step
Epoch 15/50
526/526 - 14s - loss: 3.2373 - accuracy1000: 0.3985 - val_loss: 3.3298 - val_accuracy1000: 0.3520 - 14s/epoch - 26ms/step
Epoch 16/50
526/526 - 14s - loss: 3.2346 - accuracy1000: 0.3985 - val_loss: 3.3251 - val_accuracy1000: 0.3533 - 14s/epoch - 26ms/step
testing model: results/PCAR/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1196855
{'0': {'precision': 0.28940528971105334, 'recall': 0.017401456096484778, 'f1-score': 0.03282896163017559, 'support': 108784}, '1': {'precision': 0.5074915910712465, 'recall': 0.056106465934957515, 'f1-score': 0.10104207888141406, 'support': 177484}, '2': {'precision': 0.3236342193044174, 'recall': 0.9471029574053638, 'f1-score': 0.4824206481696311, 'support': 135017}, 'accuracy': 0.33166621170941285, 'macro avg': {'precision': 0.3735103666955724, 'recall': 0.3402036264789354, 'f1-score': 0.20543056289374026, 'support': 421285}, 'weighted avg': {'precision': 0.39225328215683175, 'recall': 0.33166621170941285, 'f1-score': 0.20565556984959113, 'support': 421285}}
[[  1893   4479 102412]
 [  2691   9958 164835]
 [  1957   5185 127875]]
Evaluating performance on  train set...
526/526 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070464
{'0': {'precision': 0.33838630806845965, 'recall': 0.015341639693167207, 'f1-score': 0.02935250577930479, 'support': 45106}, '1': {'precision': 0.4189706507868992, 'recall': 0.04362653910886704, 'f1-score': 0.0790244293794376, 'support': 45156}, '2': {'precision': 0.3315057135929544, 'recall': 0.9559294510352294, 'f1-score': 0.4922905378329877, 'support': 44338}, 'accuracy': 0.334665676077266, 'macro avg': {'precision': 0.36295422414943773, 'recall': 0.3382992099457545, 'f1-score': 0.20022249099724335, 'support': 134600}, 'weighted avg': {'precision': 0.3631544713815273, 'recall': 0.334665676077266, 'f1-score': 0.19851098904292877, 'support': 134600}}
[[  692  1421 42993]
 [  710  1970 42476]
 [  643  1311 42384]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021163
{'0': {'precision': 0.3443708609271523, 'recall': 0.018811612553133763, 'f1-score': 0.03567447045707916, 'support': 11057}, '1': {'precision': 0.48672019765287217, 'recall': 0.058613507884558165, 'f1-score': 0.10462723229104427, 'support': 13444}, '2': {'precision': 0.3470561439471586, 'recall': 0.9489335201619181, 'f1-score': 0.5082343131123619, 'support': 12846}, 'accuracy': 0.35306718076418453, 'macro avg': {'precision': 0.3927157341757277, 'recall': 0.34211954686653673, 'f1-score': 0.21617867195349513, 'support': 37347}, 'weighted avg': {'precision': 0.39653675453615916, 'recall': 0.35306718076418453, 'f1-score': 0.2230390424132092, 'support': 37347}}
[[  208   363 10486]
 [  208   788 12448]
 [  188   468 12190]]
training model: results/PCAR/W7/deepVOL_L3/h10
Epoch 1/50
526/526 - 23s - loss: 3.3316 - accuracy10: 0.3482 - val_loss: 3.3156 - val_accuracy10: 0.3256 - 23s/epoch - 44ms/step
Epoch 2/50
526/526 - 20s - loss: 3.2867 - accuracy10: 0.3655 - val_loss: 3.2608 - val_accuracy10: 0.3924 - 20s/epoch - 38ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2449 - accuracy10: 0.4015 - val_loss: 3.2179 - val_accuracy10: 0.4200 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2035 - accuracy10: 0.4263 - val_loss: 3.1771 - val_accuracy10: 0.4462 - 20s/epoch - 38ms/step
Epoch 5/50
526/526 - 20s - loss: 3.1778 - accuracy10: 0.4376 - val_loss: 3.1598 - val_accuracy10: 0.4518 - 20s/epoch - 38ms/step
Epoch 6/50
526/526 - 21s - loss: 3.1606 - accuracy10: 0.4444 - val_loss: 3.1516 - val_accuracy10: 0.4539 - 21s/epoch - 41ms/step
Epoch 7/50
526/526 - 20s - loss: 3.1496 - accuracy10: 0.4487 - val_loss: 3.1373 - val_accuracy10: 0.4575 - 20s/epoch - 39ms/step
Epoch 8/50
526/526 - 20s - loss: 3.1390 - accuracy10: 0.4528 - val_loss: 3.1323 - val_accuracy10: 0.4598 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.1313 - accuracy10: 0.4550 - val_loss: 3.1230 - val_accuracy10: 0.4636 - 20s/epoch - 37ms/step
Epoch 10/50
526/526 - 20s - loss: 3.1230 - accuracy10: 0.4573 - val_loss: 3.1190 - val_accuracy10: 0.4652 - 20s/epoch - 38ms/step
Epoch 11/50
526/526 - 20s - loss: 3.1171 - accuracy10: 0.4587 - val_loss: 3.1206 - val_accuracy10: 0.4642 - 20s/epoch - 37ms/step
Epoch 12/50
526/526 - 20s - loss: 3.1119 - accuracy10: 0.4597 - val_loss: 3.1248 - val_accuracy10: 0.4629 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.1058 - accuracy10: 0.4628 - val_loss: 3.1275 - val_accuracy10: 0.4619 - 20s/epoch - 39ms/step
Epoch 14/50
526/526 - 20s - loss: 3.1009 - accuracy10: 0.4645 - val_loss: 3.1196 - val_accuracy10: 0.4660 - 20s/epoch - 37ms/step
Epoch 15/50
526/526 - 21s - loss: 3.0945 - accuracy10: 0.4657 - val_loss: 3.1234 - val_accuracy10: 0.4636 - 21s/epoch - 40ms/step
Epoch 16/50
526/526 - 21s - loss: 3.0918 - accuracy10: 0.4676 - val_loss: 3.1293 - val_accuracy10: 0.4599 - 21s/epoch - 40ms/step
Epoch 17/50
526/526 - 20s - loss: 3.0861 - accuracy10: 0.4699 - val_loss: 3.1232 - val_accuracy10: 0.4648 - 20s/epoch - 37ms/step
Epoch 18/50
526/526 - 20s - loss: 3.0830 - accuracy10: 0.4703 - val_loss: 3.1191 - val_accuracy10: 0.4671 - 20s/epoch - 38ms/step
Epoch 19/50
526/526 - 20s - loss: 3.0778 - accuracy10: 0.4723 - val_loss: 3.1207 - val_accuracy10: 0.4664 - 20s/epoch - 38ms/step
Epoch 20/50
526/526 - 20s - loss: 3.0743 - accuracy10: 0.4742 - val_loss: 3.1251 - val_accuracy10: 0.4660 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h10
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0396053
{'0': {'precision': 0.4132596543576675, 'recall': 0.500325591491209, 'f1-score': 0.4526438708274743, 'support': 128996}, '1': {'precision': 0.546088734085519, 'recall': 0.3410343011185821, 'f1-score': 0.419862820346535, 'support': 161365}, '2': {'precision': 0.4241902409044718, 'recall': 0.5324539427454096, 'f1-score': 0.47219597443635, 'support': 130924}, 'accuracy': 0.4492967943316282, 'macro avg': {'precision': 0.46117954311588605, 'recall': 0.45793794511840025, 'f1-score': 0.4482342218701198, 'support': 421285}, 'weighted avg': {'precision': 0.46753417294565075, 'recall': 0.4492967943316282, 'f1-score': 0.4461639947389159, 'support': 421285}}
[[64540 23879 40577]
 [52283 55031 54051]
 [39350 21863 69711]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.042429
{'0': {'precision': 0.4583570912684837, 'recall': 0.522930806427131, 'f1-score': 0.48851931004446425, 'support': 46117}, '1': {'precision': 0.4937913728204906, 'recall': 0.26697700531006574, 'f1-score': 0.34657313777291915, 'support': 42749}, '2': {'precision': 0.4403716474444992, 'recall': 0.5668867800760922, 'f1-score': 0.49568384524936193, 'support': 45734}, 'accuracy': 0.4565750371471025, 'macro avg': {'precision': 0.46417337051115787, 'recall': 0.45226486393776294, 'f1-score': 0.4435920976889151, 'support': 134600}, 'weighted avg': {'precision': 0.4634999873622477, 'recall': 0.4565750371471025, 'f1-score': 0.44587150866723174, 'support': 134600}}
[[24116  6148 15853]
 [14242 11413 17094]
 [14256  5552 25926]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0388045
{'0': {'precision': 0.4652482269503546, 'recall': 0.5153181461115475, 'f1-score': 0.48900484532240024, 'support': 12730}, '1': {'precision': 0.48, 'recall': 0.29958246346555323, 'f1-score': 0.368914359166622, 'support': 11496}, '2': {'precision': 0.4599925335988054, 'recall': 0.5634479079338465, 'f1-score': 0.5064912821566814, 'support': 13121}, 'accuracy': 0.46582054783516746, 'macro avg': {'precision': 0.46841358684971995, 'recall': 0.45944950583698246, 'f1-score': 0.45480349554856786, 'support': 37347}, 'weighted avg': {'precision': 0.46794259143781125, 'recall': 0.46582054783516746, 'f1-score': 0.45818253854691027, 'support': 37347}}
[[6560 1943 4227]
 [3600 3444 4452]
 [3940 1788 7393]]
training model: results/PCAR/W7/deepVOL_L3/h20
Epoch 1/50
526/526 - 23s - loss: 3.3361 - accuracy20: 0.3433 - val_loss: 3.3198 - val_accuracy20: 0.3394 - 23s/epoch - 43ms/step
Epoch 2/50
526/526 - 20s - loss: 3.2890 - accuracy20: 0.3652 - val_loss: 3.2778 - val_accuracy20: 0.3755 - 20s/epoch - 39ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2515 - accuracy20: 0.3985 - val_loss: 3.2437 - val_accuracy20: 0.4058 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2311 - accuracy20: 0.4110 - val_loss: 3.2266 - val_accuracy20: 0.4175 - 20s/epoch - 39ms/step
Epoch 5/50
526/526 - 20s - loss: 3.2164 - accuracy20: 0.4180 - val_loss: 3.2295 - val_accuracy20: 0.4203 - 20s/epoch - 38ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2053 - accuracy20: 0.4247 - val_loss: 3.2048 - val_accuracy20: 0.4260 - 20s/epoch - 38ms/step
Epoch 7/50
526/526 - 20s - loss: 3.1995 - accuracy20: 0.4267 - val_loss: 3.2026 - val_accuracy20: 0.4320 - 20s/epoch - 38ms/step
Epoch 8/50
526/526 - 20s - loss: 3.1935 - accuracy20: 0.4286 - val_loss: 3.1959 - val_accuracy20: 0.4337 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.1872 - accuracy20: 0.4311 - val_loss: 3.1958 - val_accuracy20: 0.4309 - 20s/epoch - 39ms/step
Epoch 10/50
526/526 - 20s - loss: 3.1816 - accuracy20: 0.4344 - val_loss: 3.1885 - val_accuracy20: 0.4359 - 20s/epoch - 38ms/step
Epoch 11/50
526/526 - 20s - loss: 3.1780 - accuracy20: 0.4346 - val_loss: 3.1933 - val_accuracy20: 0.4341 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.1747 - accuracy20: 0.4364 - val_loss: 3.1860 - val_accuracy20: 0.4374 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.1711 - accuracy20: 0.4360 - val_loss: 3.1856 - val_accuracy20: 0.4368 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 20s - loss: 3.1659 - accuracy20: 0.4388 - val_loss: 3.1906 - val_accuracy20: 0.4367 - 20s/epoch - 38ms/step
Epoch 15/50
526/526 - 20s - loss: 3.1644 - accuracy20: 0.4397 - val_loss: 3.1891 - val_accuracy20: 0.4380 - 20s/epoch - 38ms/step
Epoch 16/50
526/526 - 20s - loss: 3.1611 - accuracy20: 0.4411 - val_loss: 3.1926 - val_accuracy20: 0.4378 - 20s/epoch - 38ms/step
Epoch 17/50
526/526 - 20s - loss: 3.1582 - accuracy20: 0.4420 - val_loss: 3.1866 - val_accuracy20: 0.4375 - 20s/epoch - 38ms/step
Epoch 18/50
526/526 - 20s - loss: 3.1560 - accuracy20: 0.4432 - val_loss: 3.1866 - val_accuracy20: 0.4387 - 20s/epoch - 38ms/step
Epoch 19/50
526/526 - 20s - loss: 3.1524 - accuracy20: 0.4455 - val_loss: 3.1824 - val_accuracy20: 0.4402 - 20s/epoch - 38ms/step
Epoch 20/50
526/526 - 20s - loss: 3.1500 - accuracy20: 0.4455 - val_loss: 3.1839 - val_accuracy20: 0.4400 - 20s/epoch - 37ms/step
Epoch 21/50
526/526 - 20s - loss: 3.1458 - accuracy20: 0.4480 - val_loss: 3.1859 - val_accuracy20: 0.4401 - 20s/epoch - 38ms/step
Epoch 22/50
526/526 - 20s - loss: 3.1418 - accuracy20: 0.4484 - val_loss: 3.1814 - val_accuracy20: 0.4415 - 20s/epoch - 38ms/step
Epoch 23/50
526/526 - 20s - loss: 3.1415 - accuracy20: 0.4486 - val_loss: 3.1828 - val_accuracy20: 0.4419 - 20s/epoch - 38ms/step
Epoch 24/50
526/526 - 20s - loss: 3.1380 - accuracy20: 0.4509 - val_loss: 3.1849 - val_accuracy20: 0.4400 - 20s/epoch - 37ms/step
Epoch 25/50
526/526 - 20s - loss: 3.1357 - accuracy20: 0.4507 - val_loss: 3.1851 - val_accuracy20: 0.4399 - 20s/epoch - 38ms/step
Epoch 26/50
526/526 - 20s - loss: 3.1320 - accuracy20: 0.4519 - val_loss: 3.1816 - val_accuracy20: 0.4398 - 20s/epoch - 38ms/step
Epoch 27/50
526/526 - 20s - loss: 3.1308 - accuracy20: 0.4525 - val_loss: 3.1853 - val_accuracy20: 0.4375 - 20s/epoch - 38ms/step
Epoch 28/50
526/526 - 20s - loss: 3.1272 - accuracy20: 0.4547 - val_loss: 3.1852 - val_accuracy20: 0.4388 - 20s/epoch - 38ms/step
Epoch 29/50
526/526 - 20s - loss: 3.1256 - accuracy20: 0.4546 - val_loss: 3.1828 - val_accuracy20: 0.4394 - 20s/epoch - 38ms/step
Epoch 30/50
526/526 - 20s - loss: 3.1221 - accuracy20: 0.4551 - val_loss: 3.1888 - val_accuracy20: 0.4372 - 20s/epoch - 37ms/step
Epoch 31/50
526/526 - 20s - loss: 3.1186 - accuracy20: 0.4561 - val_loss: 3.2033 - val_accuracy20: 0.4320 - 20s/epoch - 38ms/step
Epoch 32/50
526/526 - 20s - loss: 3.1170 - accuracy20: 0.4588 - val_loss: 3.1998 - val_accuracy20: 0.4368 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h20
Evaluating performance on  test set...
1646/1646 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631648
{'0': {'precision': 0.40483654276757725, 'recall': 0.4523569378963088, 'f1-score': 0.42727954182067934, 'support': 127899}, '1': {'precision': 0.5096174170365674, 'recall': 0.26641538159316375, 'f1-score': 0.34990768139195505, 'support': 162896}, '2': {'precision': 0.3958647102968196, 'recall': 0.5861521955705418, 'f1-score': 0.4725722494246304, 'support': 130490}, 'accuracy': 0.421902037812882, 'macro avg': {'precision': 0.4367728900336547, 'recall': 0.4349748383533381, 'f1-score': 0.41658649087908833, 'support': 421285}, 'weighted avg': {'precision': 0.44257263799008045, 'recall': 0.421902037812882, 'f1-score': 0.41139167218098677, 'support': 421285}}
[[57856 22141 47902]
 [50672 43398 68826]
 [34384 19619 76487]]
Evaluating performance on  train set...
526/526 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059569
{'0': {'precision': 0.4552594254747137, 'recall': 0.47059080962800875, 'f1-score': 0.4627981794510378, 'support': 45700}, '1': {'precision': 0.45522037402499765, 'recall': 0.2224160888929703, 'f1-score': 0.2988278840222085, 'support': 43558}, '2': {'precision': 0.4225245539430076, 'recall': 0.6157646332318821, 'f1-score': 0.5011622584611519, 'support': 45342}, 'accuracy': 0.43918276374442794, 'macro avg': {'precision': 0.4443347844809063, 'recall': 0.43625717725095375, 'f1-score': 0.4209294406447994, 'support': 134600}, 'weighted avg': {'precision': 0.44421956256210343, 'recall': 0.43918276374442794, 'f1-score': 0.4226591448461912, 'support': 134600}}
[[21506  6216 17978]
 [13689  9688 20181]
 [12044  5378 27920]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0595182
{'0': {'precision': 0.44679720704310866, 'recall': 0.4702452272545731, 'f1-score': 0.4582214438606733, 'support': 12519}, '1': {'precision': 0.43320790216368765, 'recall': 0.23312521093486333, 'f1-score': 0.3031267142073505, 'support': 11852}, '2': {'precision': 0.4408475243073119, 'recall': 0.6045006165228114, 'f1-score': 0.5098638239786798, 'support': 12976}, 'accuracy': 0.44164189894770667, 'macro avg': {'precision': 0.4402842111713694, 'recall': 0.4359570182374159, 'f1-score': 0.4237373273489012, 'support': 37347}, 'weighted avg': {'precision': 0.4404174837825899, 'recall': 0.44164189894770667, 'f1-score': 0.4269452714387939, 'support': 37347}}
[[5887 1969 4663]
 [3803 2763 5286]
 [3486 1646 7844]]
training model: results/PCAR/W7/deepVOL_L3/h30
Epoch 1/50
526/526 - 23s - loss: 3.3320 - accuracy30: 0.3564 - val_loss: 3.3173 - val_accuracy30: 0.3484 - 23s/epoch - 43ms/step
Epoch 2/50
526/526 - 20s - loss: 3.2962 - accuracy30: 0.3631 - val_loss: 3.2902 - val_accuracy30: 0.3587 - 20s/epoch - 37ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2883 - accuracy30: 0.3633 - val_loss: 3.2804 - val_accuracy30: 0.3666 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 21s - loss: 3.2751 - accuracy30: 0.3743 - val_loss: 3.2780 - val_accuracy30: 0.3715 - 21s/epoch - 41ms/step
Epoch 5/50
526/526 - 21s - loss: 3.2598 - accuracy30: 0.3861 - val_loss: 3.2828 - val_accuracy30: 0.3755 - 21s/epoch - 41ms/step
Epoch 6/50
526/526 - 21s - loss: 3.2469 - accuracy30: 0.3971 - val_loss: 3.2690 - val_accuracy30: 0.3885 - 21s/epoch - 40ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2374 - accuracy30: 0.4036 - val_loss: 3.2633 - val_accuracy30: 0.3911 - 20s/epoch - 39ms/step
Epoch 8/50
526/526 - 20s - loss: 3.2308 - accuracy30: 0.4077 - val_loss: 3.2691 - val_accuracy30: 0.3932 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2219 - accuracy30: 0.4138 - val_loss: 3.2696 - val_accuracy30: 0.3970 - 20s/epoch - 38ms/step
Epoch 10/50
526/526 - 20s - loss: 3.2175 - accuracy30: 0.4165 - val_loss: 3.2647 - val_accuracy30: 0.3991 - 20s/epoch - 37ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2143 - accuracy30: 0.4180 - val_loss: 3.2662 - val_accuracy30: 0.3973 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.2098 - accuracy30: 0.4206 - val_loss: 3.2614 - val_accuracy30: 0.3989 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2034 - accuracy30: 0.4251 - val_loss: 3.2695 - val_accuracy30: 0.3981 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 20s - loss: 3.2007 - accuracy30: 0.4243 - val_loss: 3.2694 - val_accuracy30: 0.3973 - 20s/epoch - 38ms/step
Epoch 15/50
526/526 - 20s - loss: 3.1945 - accuracy30: 0.4288 - val_loss: 3.2627 - val_accuracy30: 0.4010 - 20s/epoch - 38ms/step
Epoch 16/50
526/526 - 20s - loss: 3.1934 - accuracy30: 0.4290 - val_loss: 3.2686 - val_accuracy30: 0.4007 - 20s/epoch - 38ms/step
Epoch 17/50
526/526 - 20s - loss: 3.1914 - accuracy30: 0.4289 - val_loss: 3.2599 - val_accuracy30: 0.4034 - 20s/epoch - 38ms/step
Epoch 18/50
526/526 - 20s - loss: 3.1887 - accuracy30: 0.4306 - val_loss: 3.2692 - val_accuracy30: 0.3999 - 20s/epoch - 38ms/step
Epoch 19/50
526/526 - 20s - loss: 3.1857 - accuracy30: 0.4322 - val_loss: 3.2665 - val_accuracy30: 0.3992 - 20s/epoch - 39ms/step
Epoch 20/50
526/526 - 21s - loss: 3.1824 - accuracy30: 0.4333 - val_loss: 3.2677 - val_accuracy30: 0.4006 - 21s/epoch - 41ms/step
Epoch 21/50
526/526 - 21s - loss: 3.1788 - accuracy30: 0.4333 - val_loss: 3.2676 - val_accuracy30: 0.4002 - 21s/epoch - 40ms/step
Epoch 22/50
526/526 - 21s - loss: 3.1771 - accuracy30: 0.4355 - val_loss: 3.2612 - val_accuracy30: 0.4043 - 21s/epoch - 40ms/step
Epoch 23/50
526/526 - 21s - loss: 3.1753 - accuracy30: 0.4359 - val_loss: 3.2648 - val_accuracy30: 0.4045 - 21s/epoch - 41ms/step
Epoch 24/50
526/526 - 21s - loss: 3.1710 - accuracy30: 0.4379 - val_loss: 3.2603 - val_accuracy30: 0.4048 - 21s/epoch - 40ms/step
Epoch 25/50
526/526 - 22s - loss: 3.1676 - accuracy30: 0.4393 - val_loss: 3.2555 - val_accuracy30: 0.4077 - 22s/epoch - 41ms/step
Epoch 26/50
526/526 - 20s - loss: 3.1639 - accuracy30: 0.4404 - val_loss: 3.2604 - val_accuracy30: 0.4075 - 20s/epoch - 37ms/step
Epoch 27/50
526/526 - 20s - loss: 3.1616 - accuracy30: 0.4425 - val_loss: 3.2725 - val_accuracy30: 0.4037 - 20s/epoch - 37ms/step
Epoch 28/50
526/526 - 20s - loss: 3.1582 - accuracy30: 0.4426 - val_loss: 3.2701 - val_accuracy30: 0.4053 - 20s/epoch - 39ms/step
Epoch 29/50
526/526 - 20s - loss: 3.1555 - accuracy30: 0.4447 - val_loss: 3.2709 - val_accuracy30: 0.4059 - 20s/epoch - 38ms/step
Epoch 30/50
526/526 - 20s - loss: 3.1531 - accuracy30: 0.4447 - val_loss: 3.2725 - val_accuracy30: 0.4079 - 20s/epoch - 37ms/step
Epoch 31/50
526/526 - 20s - loss: 3.1520 - accuracy30: 0.4454 - val_loss: 3.2750 - val_accuracy30: 0.4064 - 20s/epoch - 37ms/step
Epoch 32/50
526/526 - 20s - loss: 3.1467 - accuracy30: 0.4472 - val_loss: 3.2717 - val_accuracy30: 0.4053 - 20s/epoch - 38ms/step
Epoch 33/50
526/526 - 20s - loss: 3.1462 - accuracy30: 0.4487 - val_loss: 3.2589 - val_accuracy30: 0.4097 - 20s/epoch - 37ms/step
Epoch 34/50
526/526 - 20s - loss: 3.1427 - accuracy30: 0.4485 - val_loss: 3.2819 - val_accuracy30: 0.4065 - 20s/epoch - 38ms/step
Epoch 35/50
526/526 - 20s - loss: 3.1433 - accuracy30: 0.4490 - val_loss: 3.2703 - val_accuracy30: 0.4068 - 20s/epoch - 37ms/step
testing model: results/PCAR/W7/deepVOL_L3/h30
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1019276
{'0': {'precision': 0.3525376559334033, 'recall': 0.3934305641323695, 'f1-score': 0.3718632647368082, 'support': 110116}, '1': {'precision': 0.5912089598036208, 'recall': 0.15766539830612494, 'f1-score': 0.24894214929422784, 'support': 195528}, '2': {'precision': 0.32652729724022544, 'recall': 0.6953243226883199, 'f1-score': 0.4443744421693705, 'support': 115641}, 'accuracy': 0.36687515577340757, 'macro avg': {'precision': 0.4234246376590831, 'recall': 0.41547342837560475, 'f1-score': 0.35505995206680224, 'support': 421285}, 'weighted avg': {'precision': 0.4561707281137517, 'recall': 0.36687515577340757, 'f1-score': 0.3347167848223135, 'support': 421285}}
[[ 43323  11851  54942]
 [ 53798  30828 110902]
 [ 25768   9465  80408]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0785223
{'0': {'precision': 0.4493174924165824, 'recall': 0.39278295841251604, 'f1-score': 0.41915249840828167, 'support': 45254}, '1': {'precision': 0.4698401483705732, 'recall': 0.11983331456245072, 'f1-score': 0.1909616281991457, 'support': 44395}, '2': {'precision': 0.3901716497246676, 'recall': 0.7266579163978555, 'f1-score': 0.5077253085460254, 'support': 44951}, 'accuracy': 0.4142570579494799, 'macro avg': {'precision': 0.4364430968372744, 'recall': 0.41309139645760745, 'f1-score': 0.37261314505115095, 'support': 134600}, 'weighted avg': {'precision': 0.4363341234435747, 'recall': 0.4142570579494799, 'f1-score': 0.3734682688805486, 'support': 134600}}
[[17775  3442 24037]
 [12059  5320 27016]
 [ 9726  2561 32664]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08436
{'0': {'precision': 0.4259477065050213, 'recall': 0.3834813065081046, 'f1-score': 0.40360051435919414, 'support': 12277}, '1': {'precision': 0.44769503546099293, 'recall': 0.12280132933452217, 'f1-score': 0.1927358310540042, 'support': 12337}, '2': {'precision': 0.38991706678306415, 'recall': 0.7015628681379094, 'f1-score': 0.501248491990012, 'support': 12733}, 'accuracy': 0.4058157281709374, 'macro avg': {'precision': 0.4211866029163594, 'recall': 0.4026151679935121, 'f1-score': 0.36586161246773674, 'support': 37347}, 'weighted avg': {'precision': 0.4208473948802627, 'recall': 0.4058157281709374, 'f1-score': 0.3672365253168902, 'support': 37347}}
[[4708 1022 6547]
 [3392 1515 7430]
 [2953  847 8933]]
training model: results/PCAR/W7/deepVOL_L3/h50
Epoch 1/50
526/526 - 23s - loss: 3.3344 - accuracy50: 0.3413 - val_loss: 3.3049 - val_accuracy50: 0.3471 - 23s/epoch - 43ms/step
Epoch 2/50
526/526 - 20s - loss: 3.2949 - accuracy50: 0.3531 - val_loss: 3.2885 - val_accuracy50: 0.3611 - 20s/epoch - 38ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2819 - accuracy50: 0.3677 - val_loss: 3.2772 - val_accuracy50: 0.3723 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2675 - accuracy50: 0.3823 - val_loss: 3.2748 - val_accuracy50: 0.3741 - 20s/epoch - 38ms/step
Epoch 5/50
526/526 - 20s - loss: 3.2575 - accuracy50: 0.3914 - val_loss: 3.2687 - val_accuracy50: 0.3774 - 20s/epoch - 38ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2486 - accuracy50: 0.3981 - val_loss: 3.2771 - val_accuracy50: 0.3753 - 20s/epoch - 38ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2426 - accuracy50: 0.4016 - val_loss: 3.2748 - val_accuracy50: 0.3753 - 20s/epoch - 38ms/step
Epoch 8/50
526/526 - 20s - loss: 3.2365 - accuracy50: 0.4046 - val_loss: 3.2704 - val_accuracy50: 0.3808 - 20s/epoch - 39ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2328 - accuracy50: 0.4063 - val_loss: 3.2762 - val_accuracy50: 0.3798 - 20s/epoch - 38ms/step
Epoch 10/50
526/526 - 20s - loss: 3.2293 - accuracy50: 0.4099 - val_loss: 3.2615 - val_accuracy50: 0.3868 - 20s/epoch - 38ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2248 - accuracy50: 0.4124 - val_loss: 3.2758 - val_accuracy50: 0.3794 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.2232 - accuracy50: 0.4127 - val_loss: 3.2715 - val_accuracy50: 0.3848 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2193 - accuracy50: 0.4158 - val_loss: 3.2733 - val_accuracy50: 0.3842 - 20s/epoch - 37ms/step
Epoch 14/50
526/526 - 20s - loss: 3.2146 - accuracy50: 0.4163 - val_loss: 3.2633 - val_accuracy50: 0.3873 - 20s/epoch - 38ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2130 - accuracy50: 0.4169 - val_loss: 3.2606 - val_accuracy50: 0.3912 - 20s/epoch - 37ms/step
Epoch 16/50
526/526 - 20s - loss: 3.2092 - accuracy50: 0.4209 - val_loss: 3.2649 - val_accuracy50: 0.3912 - 20s/epoch - 37ms/step
Epoch 17/50
526/526 - 20s - loss: 3.2077 - accuracy50: 0.4229 - val_loss: 3.2652 - val_accuracy50: 0.3885 - 20s/epoch - 38ms/step
Epoch 18/50
526/526 - 20s - loss: 3.2027 - accuracy50: 0.4236 - val_loss: 3.2746 - val_accuracy50: 0.3881 - 20s/epoch - 39ms/step
Epoch 19/50
526/526 - 20s - loss: 3.2009 - accuracy50: 0.4246 - val_loss: 3.2750 - val_accuracy50: 0.3887 - 20s/epoch - 39ms/step
Epoch 20/50
526/526 - 20s - loss: 3.1980 - accuracy50: 0.4259 - val_loss: 3.2768 - val_accuracy50: 0.3931 - 20s/epoch - 38ms/step
Epoch 21/50
526/526 - 20s - loss: 3.1941 - accuracy50: 0.4294 - val_loss: 3.2790 - val_accuracy50: 0.3899 - 20s/epoch - 38ms/step
Epoch 22/50
526/526 - 20s - loss: 3.1917 - accuracy50: 0.4305 - val_loss: 3.2779 - val_accuracy50: 0.3899 - 20s/epoch - 38ms/step
Epoch 23/50
526/526 - 19s - loss: 3.1897 - accuracy50: 0.4326 - val_loss: 3.2768 - val_accuracy50: 0.3897 - 19s/epoch - 37ms/step
Epoch 24/50
526/526 - 20s - loss: 3.1860 - accuracy50: 0.4324 - val_loss: 3.2828 - val_accuracy50: 0.3892 - 20s/epoch - 38ms/step
Epoch 25/50
526/526 - 20s - loss: 3.1828 - accuracy50: 0.4329 - val_loss: 3.2900 - val_accuracy50: 0.3870 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h50
Evaluating performance on  test set...
1646/1646 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870444
{'0': {'precision': 0.36533001101002494, 'recall': 0.31015652544665917, 'f1-score': 0.33548999348123976, 'support': 121961}, '1': {'precision': 0.5123789764868603, 'recall': 0.2607731565671379, 'f1-score': 0.34563620106519455, 'support': 170470}, '2': {'precision': 0.35051064364044104, 'recall': 0.6283235289552517, 'f1-score': 0.4499926355544316, 'support': 128854}, 'accuracy': 0.38748827990552714, 'macro avg': {'precision': 0.40940654371244206, 'recall': 0.3997510703230162, 'f1-score': 0.37703961003362196, 'support': 421285}, 'weighted avg': {'precision': 0.4202996927736665, 'recall': 0.38748827990552714, 'f1-score': 0.3746173002890678, 'support': 421285}}
[[37827 21899 62235]
 [38230 44454 87786]
 [27485 20407 80962]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0845801
{'0': {'precision': 0.4263456090651558, 'recall': 0.29824290998766956, 'f1-score': 0.3509703832301194, 'support': 45416}, '1': {'precision': 0.43722600503684356, 'recall': 0.2112438035150969, 'f1-score': 0.28485916562851327, 'support': 44380}, '2': {'precision': 0.372032732098098, 'recall': 0.6758101955182573, 'f1-score': 0.47988779003423354, 'support': 44804}, 'accuracy': 0.3952377414561664, 'macro avg': {'precision': 0.4118681154000325, 'recall': 0.3950989696736746, 'f1-score': 0.37190577963095545, 'support': 134600}, 'weighted avg': {'precision': 0.4118540625093716, 'recall': 0.3952377414561664, 'f1-score': 0.37208479375977954, 'support': 134600}}
[[13545  6419 25452]
 [ 9348  9375 25657]
 [ 8877  5648 30279]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0864737
{'0': {'precision': 0.40610484406104846, 'recall': 0.30239644239479535, 'f1-score': 0.3466603729053576, 'support': 12143}, '1': {'precision': 0.43541058098020125, 'recall': 0.2133089521386548, 'f1-score': 0.2863393810032017, 'support': 12578}, '2': {'precision': 0.37262340242966174, 'recall': 0.6534927926500871, 'f1-score': 0.4746181943685467, 'support': 12626}, 'accuracy': 0.39108897635686934, 'macro avg': {'precision': 0.4047129424903038, 'recall': 0.3897327290611791, 'f1-score': 0.3692059827590353, 'support': 37347}, 'weighted avg': {'precision': 0.4046554874040537, 'recall': 0.39108897635686934, 'f1-score': 0.36960406363416876, 'support': 37347}}
[[3672 1756 6715]
 [2718 2683 7177]
 [2652 1723 8251]]
training model: results/PCAR/W7/deepVOL_L3/h100
Epoch 1/50
526/526 - 22s - loss: 3.3394 - accuracy100: 0.3504 - val_loss: 3.3295 - val_accuracy100: 0.3400 - 22s/epoch - 43ms/step
Epoch 2/50
526/526 - 21s - loss: 3.3039 - accuracy100: 0.3591 - val_loss: 3.2969 - val_accuracy100: 0.3514 - 21s/epoch - 40ms/step
Epoch 3/50
526/526 - 21s - loss: 3.2771 - accuracy100: 0.3739 - val_loss: 3.2827 - val_accuracy100: 0.3676 - 21s/epoch - 40ms/step
Epoch 4/50
526/526 - 21s - loss: 3.2614 - accuracy100: 0.3809 - val_loss: 3.2779 - val_accuracy100: 0.3681 - 21s/epoch - 40ms/step
Epoch 5/50
526/526 - 21s - loss: 3.2563 - accuracy100: 0.3856 - val_loss: 3.2729 - val_accuracy100: 0.3714 - 21s/epoch - 40ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2490 - accuracy100: 0.3910 - val_loss: 3.2736 - val_accuracy100: 0.3746 - 20s/epoch - 38ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2441 - accuracy100: 0.3953 - val_loss: 3.2773 - val_accuracy100: 0.3652 - 20s/epoch - 37ms/step
Epoch 8/50
526/526 - 20s - loss: 3.2404 - accuracy100: 0.3984 - val_loss: 3.2758 - val_accuracy100: 0.3654 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2376 - accuracy100: 0.3982 - val_loss: 3.2804 - val_accuracy100: 0.3636 - 20s/epoch - 37ms/step
Epoch 10/50
526/526 - 20s - loss: 3.2339 - accuracy100: 0.4033 - val_loss: 3.2763 - val_accuracy100: 0.3696 - 20s/epoch - 38ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2309 - accuracy100: 0.4054 - val_loss: 3.2705 - val_accuracy100: 0.3760 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 19s - loss: 3.2270 - accuracy100: 0.4097 - val_loss: 3.2716 - val_accuracy100: 0.3731 - 19s/epoch - 37ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2235 - accuracy100: 0.4110 - val_loss: 3.2763 - val_accuracy100: 0.3684 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 21s - loss: 3.2195 - accuracy100: 0.4138 - val_loss: 3.2767 - val_accuracy100: 0.3726 - 21s/epoch - 39ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2170 - accuracy100: 0.4146 - val_loss: 3.2784 - val_accuracy100: 0.3708 - 20s/epoch - 38ms/step
Epoch 16/50
526/526 - 22s - loss: 3.2136 - accuracy100: 0.4165 - val_loss: 3.2817 - val_accuracy100: 0.3740 - 22s/epoch - 41ms/step
Epoch 17/50
526/526 - 20s - loss: 3.2125 - accuracy100: 0.4173 - val_loss: 3.2839 - val_accuracy100: 0.3671 - 20s/epoch - 37ms/step
Epoch 18/50
526/526 - 20s - loss: 3.2086 - accuracy100: 0.4180 - val_loss: 3.2927 - val_accuracy100: 0.3656 - 20s/epoch - 38ms/step
Epoch 19/50
526/526 - 20s - loss: 3.2043 - accuracy100: 0.4223 - val_loss: 3.2902 - val_accuracy100: 0.3671 - 20s/epoch - 38ms/step
Epoch 20/50
526/526 - 20s - loss: 3.2022 - accuracy100: 0.4239 - val_loss: 3.2796 - val_accuracy100: 0.3721 - 20s/epoch - 38ms/step
Epoch 21/50
526/526 - 20s - loss: 3.1995 - accuracy100: 0.4249 - val_loss: 3.2837 - val_accuracy100: 0.3684 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h100
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988874
{'0': {'precision': 0.30219990638696226, 'recall': 0.3207218273286428, 'f1-score': 0.3111855019629838, 'support': 110719}, '1': {'precision': 0.5819339803345678, 'recall': 0.1928941798941799, 'f1-score': 0.289745994404883, 'support': 189000}, '2': {'precision': 0.3025272464874011, 'recall': 0.6000773242518468, 'f1-score': 0.40225752554466804, 'support': 121566}, 'accuracy': 0.3439856629122803, 'macro avg': {'precision': 0.3955537110696437, 'recall': 0.3712311104915565, 'f1-score': 0.3343963406375116, 'support': 421285}, 'weighted avg': {'precision': 0.42779073777841314, 'recall': 0.3439856629122803, 'f1-score': 0.32784689434640585, 'support': 421285}}
[[ 35510  13917  61292]
 [ 45652  36457 106891]
 [ 36343  12274  72949]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090674
{'0': {'precision': 0.3855162644812061, 'recall': 0.3396474494685, 'f1-score': 0.3611311858021255, 'support': 44873}, '1': {'precision': 0.4469348275632046, 'recall': 0.1493735229856869, 'f1-score': 0.2239117720778678, 'support': 44854}, '2': {'precision': 0.35385576022478926, 'recall': 0.6314487553762842, 'f1-score': 0.4535486762493197, 'support': 44873}, 'accuracy': 0.3735215453194651, 'macro avg': {'precision': 0.3954356174230666, 'recall': 0.37348990927682374, 'f1-score': 0.3461972113764376, 'support': 134600}, 'weighted avg': {'precision': 0.3954283478465981, 'recall': 0.3735215453194651, 'f1-score': 0.34621447306549175, 'support': 134600}}
[[15241  4427 25205]
 [11619  6700 26535]
 [12674  3864 28335]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0902041
{'0': {'precision': 0.3728114400953341, 'recall': 0.3320271042534084, 'f1-score': 0.35123931254857926, 'support': 12249}, '1': {'precision': 0.42618570474281897, 'recall': 0.15600293422446818, 'f1-score': 0.22840095465393795, 'support': 12269}, '2': {'precision': 0.35767986512963046, 'recall': 0.6118949255592797, 'f1-score': 0.45146077754773406, 'support': 12829}, 'accuracy': 0.37033764425522797, 'macro avg': {'precision': 0.3855590033225946, 'recall': 0.36664165467905213, 'f1-score': 0.3437003482500837, 'support': 37347}, 'weighted avg': {'precision': 0.38514779583274217, 'recall': 0.37033764425522797, 'f1-score': 0.34531212593291544, 'support': 37347}}
[[4067 1261 6921]
 [3179 1914 7176]
 [3663 1316 7850]]
training model: results/PCAR/W7/deepVOL_L3/h200
Epoch 1/50
526/526 - 23s - loss: 3.3380 - accuracy200: 0.3524 - val_loss: 3.3397 - val_accuracy200: 0.3334 - 23s/epoch - 44ms/step
Epoch 2/50
526/526 - 20s - loss: 3.3113 - accuracy200: 0.3539 - val_loss: 3.3168 - val_accuracy200: 0.3388 - 20s/epoch - 39ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2978 - accuracy200: 0.3541 - val_loss: 3.3119 - val_accuracy200: 0.3417 - 20s/epoch - 39ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2853 - accuracy200: 0.3643 - val_loss: 3.3092 - val_accuracy200: 0.3445 - 20s/epoch - 39ms/step
Epoch 5/50
526/526 - 20s - loss: 3.2756 - accuracy200: 0.3719 - val_loss: 3.3120 - val_accuracy200: 0.3447 - 20s/epoch - 39ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2670 - accuracy200: 0.3777 - val_loss: 3.3009 - val_accuracy200: 0.3507 - 20s/epoch - 39ms/step
Epoch 7/50
526/526 - 22s - loss: 3.2618 - accuracy200: 0.3830 - val_loss: 3.3009 - val_accuracy200: 0.3525 - 22s/epoch - 41ms/step
Epoch 8/50
526/526 - 20s - loss: 3.2566 - accuracy200: 0.3846 - val_loss: 3.3124 - val_accuracy200: 0.3488 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2541 - accuracy200: 0.3880 - val_loss: 3.3058 - val_accuracy200: 0.3500 - 20s/epoch - 39ms/step
Epoch 10/50
526/526 - 21s - loss: 3.2488 - accuracy200: 0.3906 - val_loss: 3.3038 - val_accuracy200: 0.3497 - 21s/epoch - 41ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2463 - accuracy200: 0.3911 - val_loss: 3.3098 - val_accuracy200: 0.3504 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.2433 - accuracy200: 0.3949 - val_loss: 3.3191 - val_accuracy200: 0.3476 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2403 - accuracy200: 0.3960 - val_loss: 3.3155 - val_accuracy200: 0.3486 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 21s - loss: 3.2366 - accuracy200: 0.3992 - val_loss: 3.3169 - val_accuracy200: 0.3475 - 21s/epoch - 41ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2344 - accuracy200: 0.4006 - val_loss: 3.3130 - val_accuracy200: 0.3515 - 20s/epoch - 38ms/step
Epoch 16/50
526/526 - 20s - loss: 3.2293 - accuracy200: 0.4043 - val_loss: 3.3142 - val_accuracy200: 0.3540 - 20s/epoch - 39ms/step
Epoch 17/50
526/526 - 20s - loss: 3.2244 - accuracy200: 0.4077 - val_loss: 3.3163 - val_accuracy200: 0.3519 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h200
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116804
{'0': {'precision': 0.27380952380952384, 'recall': 0.16268514524014954, 'f1-score': 0.20410211307308931, 'support': 111264}, '1': {'precision': 0.5487800621313135, 'recall': 0.16936335236453734, 'f1-score': 0.2588430922217009, 'support': 185660}, '2': {'precision': 0.3057113794527308, 'recall': 0.7322633301436946, 'f1-score': 0.4313423645320197, 'support': 124361}, 'accuracy': 0.33376455368693403, 'macro avg': {'precision': 0.376100321797856, 'recall': 0.35477060924946047, 'f1-score': 0.2980958566089366, 'support': 421285}, 'weighted avg': {'precision': 0.40440609576074055, 'recall': 0.33376455368693403, 'f1-score': 0.29530648802215054, 'support': 421285}}
[[ 18101  13077  80086]
 [ 27488  31444 126728]
 [ 20519  12777  91065]]
Evaluating performance on  train set...
526/526 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955615
{'0': {'precision': 0.3567818415732402, 'recall': 0.17099381207196493, 'f1-score': 0.23118719761816148, 'support': 45411}, '1': {'precision': 0.43487096118675067, 'recall': 0.14520616108384413, 'f1-score': 0.21771568095496474, 'support': 44213}, '2': {'precision': 0.34728212657918084, 'recall': 0.7572705442902882, 'f1-score': 0.4761864815552712, 'support': 44976}, 'accuracy': 0.3584249628528975, 'macro avg': {'precision': 0.37964497644639056, 'recall': 0.35782350581536576, 'f1-score': 0.30836312004279914, 'support': 134600}, 'weighted avg': {'precision': 0.37925803075525594, 'recall': 0.3584249628528975, 'f1-score': 0.30862755146753396, 'support': 134600}}
[[ 7765  4417 33229]
 [ 7008  6420 30785]
 [ 6991  3926 34059]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992433
{'0': {'precision': 0.3225158399010972, 'recall': 0.17784405624201108, 'f1-score': 0.2292650774469955, 'support': 11735}, '1': {'precision': 0.47357243983010855, 'recall': 0.15198788337750851, 'f1-score': 0.23012096543025856, 'support': 13205}, '2': {'precision': 0.3403033260755312, 'recall': 0.7306359313290884, 'f1-score': 0.464336022538097, 'support': 12407}, 'accuracy': 0.3523442311296757, 'macro avg': {'precision': 0.378797201935579, 'recall': 0.35348929031620263, 'f1-score': 0.30790735513845036, 'support': 37347}, 'weighted avg': {'precision': 0.3818349751202258, 'recall': 0.3523442311296757, 'f1-score': 0.307660322488479, 'support': 37347}}
[[2087 1057 8591]
 [2216 2007 8982]
 [2168 1174 9065]]
training model: results/PCAR/W7/deepVOL_L3/h300
Epoch 1/50
526/526 - 22s - loss: 3.3402 - accuracy300: 0.3517 - val_loss: 3.3333 - val_accuracy300: 0.3375 - 22s/epoch - 42ms/step
Epoch 2/50
526/526 - 20s - loss: 3.3089 - accuracy300: 0.3519 - val_loss: 3.3127 - val_accuracy300: 0.3269 - 20s/epoch - 37ms/step
Epoch 3/50
526/526 - 20s - loss: 3.2932 - accuracy300: 0.3569 - val_loss: 3.3037 - val_accuracy300: 0.3435 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2851 - accuracy300: 0.3656 - val_loss: 3.3151 - val_accuracy300: 0.3393 - 20s/epoch - 38ms/step
Epoch 5/50
526/526 - 21s - loss: 3.2768 - accuracy300: 0.3741 - val_loss: 3.3058 - val_accuracy300: 0.3473 - 21s/epoch - 39ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2736 - accuracy300: 0.3748 - val_loss: 3.3037 - val_accuracy300: 0.3471 - 20s/epoch - 37ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2710 - accuracy300: 0.3766 - val_loss: 3.3008 - val_accuracy300: 0.3559 - 20s/epoch - 37ms/step
Epoch 8/50
526/526 - 20s - loss: 3.2656 - accuracy300: 0.3798 - val_loss: 3.3150 - val_accuracy300: 0.3511 - 20s/epoch - 38ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2636 - accuracy300: 0.3814 - val_loss: 3.3133 - val_accuracy300: 0.3522 - 20s/epoch - 38ms/step
Epoch 10/50
526/526 - 20s - loss: 3.2616 - accuracy300: 0.3823 - val_loss: 3.3059 - val_accuracy300: 0.3569 - 20s/epoch - 38ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2579 - accuracy300: 0.3859 - val_loss: 3.3132 - val_accuracy300: 0.3500 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.2545 - accuracy300: 0.3877 - val_loss: 3.3079 - val_accuracy300: 0.3537 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2518 - accuracy300: 0.3903 - val_loss: 3.3041 - val_accuracy300: 0.3562 - 20s/epoch - 37ms/step
Epoch 14/50
526/526 - 20s - loss: 3.2489 - accuracy300: 0.3920 - val_loss: 3.3105 - val_accuracy300: 0.3506 - 20s/epoch - 38ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2443 - accuracy300: 0.3959 - val_loss: 3.3065 - val_accuracy300: 0.3499 - 20s/epoch - 38ms/step
Epoch 16/50
526/526 - 20s - loss: 3.2425 - accuracy300: 0.3959 - val_loss: 3.3047 - val_accuracy300: 0.3535 - 20s/epoch - 37ms/step
Epoch 17/50
526/526 - 20s - loss: 3.2406 - accuracy300: 0.3985 - val_loss: 3.3051 - val_accuracy300: 0.3479 - 20s/epoch - 39ms/step
testing model: results/PCAR/W7/deepVOL_L3/h300
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081028
{'0': {'precision': 0.2688152011922504, 'recall': 0.051467703391946354, 'f1-score': 0.08639425235743152, 'support': 112148}, '1': {'precision': 0.5636151498833244, 'recall': 0.17470191232355378, 'f1-score': 0.26672726268799984, 'support': 179729}, '2': {'precision': 0.3215171038904049, 'recall': 0.8549316889218596, 'f1-score': 0.4672964302835625, 'support': 129408}, 'accuracy': 0.35084562706956096, 'macro avg': {'precision': 0.38464915165532654, 'recall': 0.36036710154578655, 'f1-score': 0.27347264844299796, 'support': 421285}, 'weighted avg': {'precision': 0.41077170997528517, 'recall': 0.35084562706956096, 'f1-score': 0.2803315172844227, 'support': 421285}}
[[  5772  12097  94279]
 [  9141  31399 139189]
 [  6559  12214 110635]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984021
{'0': {'precision': 0.3554046406338427, 'recall': 0.05534136723138948, 'f1-score': 0.09577002992813434, 'support': 45391}, '1': {'precision': 0.43743743743743746, 'recall': 0.12784679089026915, 'f1-score': 0.197864966999286, 'support': 44436}, '2': {'precision': 0.34089659085948754, 'recall': 0.8721327585821812, 'f1-score': 0.49018943245584307, 'support': 44773}, 'accuracy': 0.3509732540861813, 'macro avg': {'precision': 0.37791288964358927, 'recall': 0.35177363890127994, 'f1-score': 0.26127480979442114, 'support': 134600}, 'weighted avg': {'precision': 0.377660513191178, 'recall': 0.3509732540861813, 'f1-score': 0.2606736743045593, 'support': 134600}}
[[ 2512  3832 39047]
 [ 2305  5681 36450]
 [ 2251  3474 39048]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099465
{'0': {'precision': 0.3072594259988745, 'recall': 0.047048685911245156, 'f1-score': 0.08160215214467195, 'support': 11605}, '1': {'precision': 0.49722081859525014, 'recall': 0.14747096290745598, 'f1-score': 0.22747500433450846, 'support': 13345}, '2': {'precision': 0.33930153106415284, 'recall': 0.865209324836654, 'f1-score': 0.4874457497330091, 'support': 12397}, 'accuracy': 0.35451308003320214, 'macro avg': {'precision': 0.38126059188609246, 'recall': 0.35324299121845176, 'f1-score': 0.26550763540406314, 'support': 37347}, 'weighted avg': {'precision': 0.3857733832295192, 'recall': 0.35451308003320214, 'f1-score': 0.26844222743253937, 'support': 37347}}
[[  546   892 10167]
 [  658  1968 10719]
 [  573  1098 10726]]
training model: results/PCAR/W7/deepVOL_L3/h500
Epoch 1/50
526/526 - 23s - loss: 3.3370 - accuracy500: 0.3542 - val_loss: 3.3281 - val_accuracy500: 0.3345 - 23s/epoch - 43ms/step
Epoch 2/50
526/526 - 20s - loss: 3.3096 - accuracy500: 0.3473 - val_loss: 3.3024 - val_accuracy500: 0.3354 - 20s/epoch - 39ms/step
Epoch 3/50
526/526 - 20s - loss: 3.3018 - accuracy500: 0.3440 - val_loss: 3.2945 - val_accuracy500: 0.3442 - 20s/epoch - 39ms/step
Epoch 4/50
526/526 - 21s - loss: 3.2971 - accuracy500: 0.3505 - val_loss: 3.2913 - val_accuracy500: 0.3470 - 21s/epoch - 39ms/step
Epoch 5/50
526/526 - 20s - loss: 3.2925 - accuracy500: 0.3547 - val_loss: 3.2901 - val_accuracy500: 0.3573 - 20s/epoch - 38ms/step
Epoch 6/50
526/526 - 21s - loss: 3.2851 - accuracy500: 0.3639 - val_loss: 3.2951 - val_accuracy500: 0.3593 - 21s/epoch - 39ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2788 - accuracy500: 0.3699 - val_loss: 3.3067 - val_accuracy500: 0.3550 - 20s/epoch - 39ms/step
Epoch 8/50
526/526 - 21s - loss: 3.2756 - accuracy500: 0.3773 - val_loss: 3.3072 - val_accuracy500: 0.3573 - 21s/epoch - 40ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2730 - accuracy500: 0.3779 - val_loss: 3.3106 - val_accuracy500: 0.3582 - 20s/epoch - 39ms/step
Epoch 10/50
526/526 - 21s - loss: 3.2728 - accuracy500: 0.3791 - val_loss: 3.3005 - val_accuracy500: 0.3614 - 21s/epoch - 39ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2683 - accuracy500: 0.3796 - val_loss: 3.2918 - val_accuracy500: 0.3641 - 20s/epoch - 39ms/step
Epoch 12/50
526/526 - 21s - loss: 3.2649 - accuracy500: 0.3839 - val_loss: 3.2884 - val_accuracy500: 0.3669 - 21s/epoch - 39ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2618 - accuracy500: 0.3847 - val_loss: 3.2893 - val_accuracy500: 0.3678 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 21s - loss: 3.2579 - accuracy500: 0.3880 - val_loss: 3.2888 - val_accuracy500: 0.3713 - 21s/epoch - 39ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2560 - accuracy500: 0.3888 - val_loss: 3.3049 - val_accuracy500: 0.3663 - 20s/epoch - 39ms/step
Epoch 16/50
526/526 - 20s - loss: 3.2539 - accuracy500: 0.3913 - val_loss: 3.3005 - val_accuracy500: 0.3640 - 20s/epoch - 39ms/step
Epoch 17/50
526/526 - 21s - loss: 3.2528 - accuracy500: 0.3904 - val_loss: 3.3068 - val_accuracy500: 0.3636 - 21s/epoch - 39ms/step
Epoch 18/50
526/526 - 21s - loss: 3.2480 - accuracy500: 0.3960 - val_loss: 3.3119 - val_accuracy500: 0.3628 - 21s/epoch - 39ms/step
Epoch 19/50
526/526 - 20s - loss: 3.2471 - accuracy500: 0.3951 - val_loss: 3.3241 - val_accuracy500: 0.3604 - 20s/epoch - 39ms/step
Epoch 20/50
526/526 - 21s - loss: 3.2418 - accuracy500: 0.3976 - val_loss: 3.3331 - val_accuracy500: 0.3587 - 21s/epoch - 39ms/step
Epoch 21/50
526/526 - 20s - loss: 3.2412 - accuracy500: 0.3989 - val_loss: 3.3244 - val_accuracy500: 0.3625 - 20s/epoch - 39ms/step
Epoch 22/50
526/526 - 20s - loss: 3.2389 - accuracy500: 0.3993 - val_loss: 3.3236 - val_accuracy500: 0.3666 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h500
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012156
{'0': {'precision': 0.3048780487804878, 'recall': 0.005127244841545842, 'f1-score': 0.010084888452364249, 'support': 112146}, '1': {'precision': 0.5614412256949641, 'recall': 0.23003975045855193, 'f1-score': 0.3263598326359832, 'support': 179369}, '2': {'precision': 0.3251779385150879, 'recall': 0.8667719811975033, 'f1-score': 0.4729311548196672, 'support': 129770}, 'accuracy': 0.36630309647863085, 'macro avg': {'precision': 0.3971657376635133, 'recall': 0.36731299216586705, 'f1-score': 0.2697919586360049, 'support': 421285}, 'weighted avg': {'precision': 0.42036708155125285, 'recall': 0.36630309647863085, 'f1-score': 0.2873164073760298, 'support': 421285}}
[[   575  15564  96007]
 [   689  41262 137418]
 [   622  16667 112481]]
Evaluating performance on  train set...
526/526 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09666
{'0': {'precision': 0.38522012578616355, 'recall': 0.0054134075743514955, 'f1-score': 0.010676776920730378, 'support': 45258}, '1': {'precision': 0.44042049327095245, 'recall': 0.17131751595218836, 'f1-score': 0.24667993076786202, 'support': 44508}, '2': {'precision': 0.3428860446974308, 'recall': 0.8921354329303653, 'f1-score': 0.49537727962349437, 'support': 44834}, 'accuracy': 0.35563150074294203, 'macro avg': {'precision': 0.3895088879181823, 'recall': 0.3562887854856351, 'f1-score': 0.2509113291040289, 'support': 134600}, 'weighted avg': {'precision': 0.38937207054456424, 'recall': 0.35563150074294203, 'f1-score': 0.25016482082566244, 'support': 134600}}
[[  245  5061 39952]
 [  182  7625 36701]
 [  209  4627 39998]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952116
{'0': {'precision': 0.4186046511627907, 'recall': 0.004766107678729038, 'f1-score': 0.009424906187276375, 'support': 11330}, '1': {'precision': 0.5016629711751663, 'recall': 0.2007690601197959, 'f1-score': 0.286770530763137, 'support': 13523}, '2': {'precision': 0.34405458089668617, 'recall': 0.8758604129982391, 'f1-score': 0.49404063205417614, 'support': 12494}, 'accuracy': 0.36715131068091145, 'macro avg': {'precision': 0.4214407344115478, 'recall': 0.3604651935989214, 'f1-score': 0.2634120230015298, 'support': 37347}, 'weighted avg': {'precision': 0.4237394433448306, 'recall': 0.36715131068091145, 'f1-score': 0.2719716638952692, 'support': 37347}}
[[   54  1188 10088]
 [   33  2715 10775]
 [   42  1509 10943]]
training model: results/PCAR/W7/deepVOL_L3/h1000
Epoch 1/50
526/526 - 23s - loss: 3.3327 - accuracy1000: 0.3688 - val_loss: 3.3280 - val_accuracy1000: 0.3445 - 23s/epoch - 44ms/step
Epoch 2/50
526/526 - 20s - loss: 3.3077 - accuracy1000: 0.3623 - val_loss: 3.3229 - val_accuracy1000: 0.3349 - 20s/epoch - 38ms/step
Epoch 3/50
526/526 - 20s - loss: 3.3023 - accuracy1000: 0.3501 - val_loss: 3.3026 - val_accuracy1000: 0.3459 - 20s/epoch - 38ms/step
Epoch 4/50
526/526 - 20s - loss: 3.2980 - accuracy1000: 0.3517 - val_loss: 3.2976 - val_accuracy1000: 0.3489 - 20s/epoch - 38ms/step
Epoch 5/50
526/526 - 20s - loss: 3.2946 - accuracy1000: 0.3514 - val_loss: 3.2961 - val_accuracy1000: 0.3519 - 20s/epoch - 38ms/step
Epoch 6/50
526/526 - 20s - loss: 3.2927 - accuracy1000: 0.3523 - val_loss: 3.2961 - val_accuracy1000: 0.3556 - 20s/epoch - 38ms/step
Epoch 7/50
526/526 - 20s - loss: 3.2888 - accuracy1000: 0.3569 - val_loss: 3.2998 - val_accuracy1000: 0.3543 - 20s/epoch - 38ms/step
Epoch 8/50
526/526 - 21s - loss: 3.2874 - accuracy1000: 0.3612 - val_loss: 3.2949 - val_accuracy1000: 0.3587 - 21s/epoch - 39ms/step
Epoch 9/50
526/526 - 20s - loss: 3.2831 - accuracy1000: 0.3621 - val_loss: 3.2950 - val_accuracy1000: 0.3593 - 20s/epoch - 38ms/step
Epoch 10/50
526/526 - 21s - loss: 3.2800 - accuracy1000: 0.3634 - val_loss: 3.2888 - val_accuracy1000: 0.3607 - 21s/epoch - 39ms/step
Epoch 11/50
526/526 - 20s - loss: 3.2799 - accuracy1000: 0.3662 - val_loss: 3.2795 - val_accuracy1000: 0.3657 - 20s/epoch - 38ms/step
Epoch 12/50
526/526 - 20s - loss: 3.2792 - accuracy1000: 0.3681 - val_loss: 3.2937 - val_accuracy1000: 0.3553 - 20s/epoch - 38ms/step
Epoch 13/50
526/526 - 20s - loss: 3.2729 - accuracy1000: 0.3728 - val_loss: 3.3190 - val_accuracy1000: 0.3522 - 20s/epoch - 38ms/step
Epoch 14/50
526/526 - 20s - loss: 3.2678 - accuracy1000: 0.3775 - val_loss: 3.3103 - val_accuracy1000: 0.3537 - 20s/epoch - 38ms/step
Epoch 15/50
526/526 - 20s - loss: 3.2640 - accuracy1000: 0.3818 - val_loss: 3.3185 - val_accuracy1000: 0.3539 - 20s/epoch - 37ms/step
Epoch 16/50
526/526 - 20s - loss: 3.2613 - accuracy1000: 0.3821 - val_loss: 3.3258 - val_accuracy1000: 0.3516 - 20s/epoch - 37ms/step
Epoch 17/50
526/526 - 20s - loss: 3.2577 - accuracy1000: 0.3864 - val_loss: 3.3291 - val_accuracy1000: 0.3488 - 20s/epoch - 38ms/step
Epoch 18/50
526/526 - 20s - loss: 3.2523 - accuracy1000: 0.3901 - val_loss: 3.3443 - val_accuracy1000: 0.3464 - 20s/epoch - 38ms/step
Epoch 19/50
526/526 - 20s - loss: 3.2485 - accuracy1000: 0.3921 - val_loss: 3.3447 - val_accuracy1000: 0.3450 - 20s/epoch - 37ms/step
Epoch 20/50
526/526 - 20s - loss: 3.2440 - accuracy1000: 0.3954 - val_loss: 3.3452 - val_accuracy1000: 0.3462 - 20s/epoch - 38ms/step
Epoch 21/50
526/526 - 20s - loss: 3.2392 - accuracy1000: 0.3947 - val_loss: 3.3320 - val_accuracy1000: 0.3509 - 20s/epoch - 38ms/step
testing model: results/PCAR/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
1646/1646 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024477
{'0': {'precision': 0.2917302410741532, 'recall': 0.03515222826886307, 'f1-score': 0.06274406851967317, 'support': 108784}, '1': {'precision': 0.5165322505192642, 'recall': 0.15552951251943836, 'f1-score': 0.2390732921944354, 'support': 177484}, '2': {'precision': 0.3297325334896937, 'recall': 0.8663205374138071, 'f1-score': 0.4776611883949664, 'support': 135017}, 'accuracy': 0.35224610418125496, 'macro avg': {'precision': 0.37933167502770365, 'recall': 0.35233409273403615, 'f1-score': 0.25982618303635835, 'support': 421285}, 'weighted avg': {'precision': 0.39861682701817003, 'recall': 0.35224610418125496, 'f1-score': 0.27000632734420754, 'support': 421285}}
[[  3824  12283  92677]
 [  4789  27604 145091]
 [  4495  13554 116968]]
Evaluating performance on  train set...
526/526 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979803
{'0': {'precision': 0.3786737915958222, 'recall': 0.03456302930873941, 'f1-score': 0.06334437153363265, 'support': 45106}, '1': {'precision': 0.4067691885212138, 'recall': 0.13121179909646558, 'f1-score': 0.19841934295569474, 'support': 45156}, '2': {'precision': 0.3363441082843759, 'recall': 0.8793360097433353, 'f1-score': 0.4865745218557923, 'support': 44338}, 'accuracy': 0.345260029717682, 'macro avg': {'precision': 0.3739290294671373, 'recall': 0.34837027938284676, 'f1-score': 0.24944607878170655, 'support': 134600}, 'weighted avg': {'precision': 0.37415568048809617, 'recall': 0.345260029717682, 'f1-score': 0.24807411755531578, 'support': 134600}}
[[ 1559  4505 39042]
 [ 1344  5925 37887]
 [ 1214  4136 38988]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935764
{'0': {'precision': 0.35900339750849375, 'recall': 0.028669621054535587, 'f1-score': 0.05309882747068677, 'support': 11057}, '1': {'precision': 0.4519785655399835, 'recall': 0.1631210949122285, 'f1-score': 0.23972452995190208, 'support': 13444}, '2': {'precision': 0.3511008477793243, 'recall': 0.8640043593336447, 'f1-score': 0.4993027126726349, 'support': 12846}, 'accuracy': 0.3643933917048223, 'macro avg': {'precision': 0.38736093694260054, 'recall': 0.35193169176680295, 'f1-score': 0.2640420233650746, 'support': 37347}, 'weighted avg': {'precision': 0.389753980023674, 'recall': 0.3643933917048223, 'f1-score': 0.27375727536373534, 'support': 37347}}
[[  317  1205  9535]
 [  273  2193 10978]
 [  293  1454 11099]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        18 (peak)  11.79 (ave)

============================================
