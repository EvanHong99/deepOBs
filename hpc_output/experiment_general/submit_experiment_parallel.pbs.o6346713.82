This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-13.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-05.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-23.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-01.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-28.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-30.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-25.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-31.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-10-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-06.csv
training model: results/XRAY/W8/deepLOB_L1/h10
Epoch 1/50
327/327 - 32s - loss: 3.2880 - accuracy10: 0.3856 - val_loss: 3.2864 - val_accuracy10: 0.3827 - 32s/epoch - 99ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2113 - accuracy10: 0.4214 - val_loss: 3.1961 - val_accuracy10: 0.4197 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.1825 - accuracy10: 0.4314 - val_loss: 3.1598 - val_accuracy10: 0.4346 - 8s/epoch - 26ms/step
Epoch 4/50
327/327 - 8s - loss: 3.1630 - accuracy10: 0.4394 - val_loss: 3.1477 - val_accuracy10: 0.4480 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.1430 - accuracy10: 0.4485 - val_loss: 3.1305 - val_accuracy10: 0.4512 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.1333 - accuracy10: 0.4525 - val_loss: 3.1266 - val_accuracy10: 0.4537 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.1188 - accuracy10: 0.4578 - val_loss: 3.1174 - val_accuracy10: 0.4561 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.1073 - accuracy10: 0.4610 - val_loss: 3.1139 - val_accuracy10: 0.4635 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.1012 - accuracy10: 0.4646 - val_loss: 3.1130 - val_accuracy10: 0.4590 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.0940 - accuracy10: 0.4651 - val_loss: 3.1096 - val_accuracy10: 0.4628 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.0869 - accuracy10: 0.4663 - val_loss: 3.1304 - val_accuracy10: 0.4586 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.0786 - accuracy10: 0.4704 - val_loss: 3.1376 - val_accuracy10: 0.4541 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.0736 - accuracy10: 0.4721 - val_loss: 3.1558 - val_accuracy10: 0.4478 - 8s/epoch - 25ms/step
Epoch 14/50
327/327 - 8s - loss: 3.0665 - accuracy10: 0.4746 - val_loss: 3.1138 - val_accuracy10: 0.4676 - 8s/epoch - 25ms/step
Epoch 15/50
327/327 - 8s - loss: 3.0627 - accuracy10: 0.4773 - val_loss: 3.1348 - val_accuracy10: 0.4578 - 8s/epoch - 25ms/step
Epoch 16/50
327/327 - 8s - loss: 3.0573 - accuracy10: 0.4770 - val_loss: 3.1581 - val_accuracy10: 0.4531 - 8s/epoch - 25ms/step
Epoch 17/50
327/327 - 8s - loss: 3.0513 - accuracy10: 0.4778 - val_loss: 3.1505 - val_accuracy10: 0.4549 - 8s/epoch - 25ms/step
Epoch 18/50
327/327 - 8s - loss: 3.0477 - accuracy10: 0.4801 - val_loss: 3.1301 - val_accuracy10: 0.4658 - 8s/epoch - 25ms/step
Epoch 19/50
327/327 - 8s - loss: 3.0435 - accuracy10: 0.4826 - val_loss: 3.1488 - val_accuracy10: 0.4602 - 8s/epoch - 25ms/step
Epoch 20/50
327/327 - 8s - loss: 3.0397 - accuracy10: 0.4822 - val_loss: 3.1467 - val_accuracy10: 0.4533 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h10
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0086069
{'0': {'precision': 0.3924326247744275, 'recall': 0.6091370558375635, 'f1-score': 0.4773412340589978, 'support': 76042}, '1': {'precision': 0.5955869085159948, 'recall': 0.4730010986536375, 'f1-score': 0.5272626310264563, 'support': 146543}, '2': {'precision': 0.3806087328902917, 'recall': 0.3204813162744731, 'f1-score': 0.3479666780253322, 'support': 74878}, 'accuracy': 0.4694096408628972, 'macro avg': {'precision': 0.45620942206023796, 'recall': 0.467539823588558, 'f1-score': 0.4508568477035954, 'support': 297463}, 'weighted avg': {'precision': 0.4895387819295701, 'recall': 0.4694096408628972, 'f1-score': 0.4693682198323998, 'support': 297463}}
[[46320 21178  8544]
 [46720 69315 30508]
 [24993 25888 23997]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0573355
{'0': {'precision': 0.45122740012936213, 'recall': 0.5284992784992785, 'f1-score': 0.48681608985329056, 'support': 27720}, '1': {'precision': 0.4148389646314958, 'recall': 0.4524621960418088, 'f1-score': 0.4328345388011751, 'support': 27841}, '2': {'precision': 0.47525181936478866, 'recall': 0.3519146354519824, 'f1-score': 0.4043879434078327, 'support': 28021}, 'accuracy': 0.4439711899691321, 'macro avg': {'precision': 0.4471060613752155, 'recall': 0.44429203666435657, 'f1-score': 0.44134619068743275, 'support': 83582}, 'weighted avg': {'precision': 0.4471607089602083, 'recall': 0.4439711899691321, 'f1-score': 0.4412007725075688, 'support': 83582}}
[[14650  8375  4695]
 [ 9051 12597  6193]
 [ 8766  9394  9861]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0380962
{'0': {'precision': 0.44826926754637597, 'recall': 0.47929659544013903, 'f1-score': 0.4632639952566826, 'support': 9781}, '1': {'precision': 0.45681675829911617, 'recall': 0.5459990018299784, 'f1-score': 0.4974423098783677, 'support': 12022}, '2': {'precision': 0.48456568557071067, 'recall': 0.33787165882470716, 'f1-score': 0.39813613306594314, 'support': 9989}, 'accuracy': 0.46008429793658784, 'macro avg': {'precision': 0.46321723713873425, 'recall': 0.45438908536494155, 'f1-score': 0.45294747940033114, 'support': 31792}, 'weighted avg': {'precision': 0.46290574381318905, 'recall': 0.46008429793658784, 'f1-score': 0.45572529001506845, 'support': 31792}}
[[4688 3684 1409]
 [3277 6564 2181]
 [2493 4121 3375]]
training model: results/XRAY/W8/deepLOB_L1/h20
Epoch 1/50
327/327 - 10s - loss: 3.2962 - accuracy20: 0.3791 - val_loss: 3.2572 - val_accuracy20: 0.3803 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2338 - accuracy20: 0.4070 - val_loss: 3.2002 - val_accuracy20: 0.4148 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2170 - accuracy20: 0.4129 - val_loss: 3.1906 - val_accuracy20: 0.4115 - 8s/epoch - 26ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2041 - accuracy20: 0.4195 - val_loss: 3.1764 - val_accuracy20: 0.4214 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.1849 - accuracy20: 0.4281 - val_loss: 3.1690 - val_accuracy20: 0.4244 - 8s/epoch - 26ms/step
Epoch 6/50
327/327 - 8s - loss: 3.1753 - accuracy20: 0.4337 - val_loss: 3.1581 - val_accuracy20: 0.4322 - 8s/epoch - 26ms/step
Epoch 7/50
327/327 - 8s - loss: 3.1711 - accuracy20: 0.4357 - val_loss: 3.1708 - val_accuracy20: 0.4282 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.1601 - accuracy20: 0.4385 - val_loss: 3.1573 - val_accuracy20: 0.4360 - 8s/epoch - 26ms/step
Epoch 9/50
327/327 - 8s - loss: 3.1509 - accuracy20: 0.4443 - val_loss: 3.1775 - val_accuracy20: 0.4279 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.1456 - accuracy20: 0.4430 - val_loss: 3.1776 - val_accuracy20: 0.4290 - 8s/epoch - 25ms/step
Epoch 11/50
327/327 - 8s - loss: 3.1427 - accuracy20: 0.4452 - val_loss: 3.1682 - val_accuracy20: 0.4355 - 8s/epoch - 25ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1346 - accuracy20: 0.4492 - val_loss: 3.1634 - val_accuracy20: 0.4380 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1303 - accuracy20: 0.4510 - val_loss: 3.1799 - val_accuracy20: 0.4278 - 8s/epoch - 25ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1248 - accuracy20: 0.4514 - val_loss: 3.1934 - val_accuracy20: 0.4269 - 8s/epoch - 25ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1210 - accuracy20: 0.4548 - val_loss: 3.1886 - val_accuracy20: 0.4292 - 8s/epoch - 25ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1149 - accuracy20: 0.4561 - val_loss: 3.1749 - val_accuracy20: 0.4336 - 8s/epoch - 25ms/step
Epoch 17/50
327/327 - 8s - loss: 3.1114 - accuracy20: 0.4574 - val_loss: 3.1876 - val_accuracy20: 0.4280 - 8s/epoch - 25ms/step
Epoch 18/50
327/327 - 8s - loss: 3.1086 - accuracy20: 0.4597 - val_loss: 3.1984 - val_accuracy20: 0.4303 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h20
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0379411
{'0': {'precision': 0.38390678595424166, 'recall': 0.5666305666827595, 'f1-score': 0.4577059893019947, 'support': 76639}, '1': {'precision': 0.5326892992828265, 'recall': 0.3613616786686421, 'f1-score': 0.4306096724791322, 'support': 145115}, '2': {'precision': 0.335417030440603, 'recall': 0.3805888335600787, 'f1-score': 0.3565780192310073, 'support': 75709}, 'accuracy': 0.4191412041161422, 'macro avg': {'precision': 0.4173377052258904, 'recall': 0.43619369297049343, 'f1-score': 0.414964560337378, 'support': 297463}, 'weighted avg': {'precision': 0.444147768938665, 'recall': 0.4191412041161422, 'f1-score': 0.4187486080416225, 'support': 297463}}
[[43426 21761 11452]
 [47037 52439 45639]
 [22653 24242 28814]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0717635
{'0': {'precision': 0.44618922991514, 'recall': 0.40549208980503804, 'f1-score': 0.4248683142333906, 'support': 27749}, '1': {'precision': 0.37436509393549966, 'recall': 0.43893951352514887, 'f1-score': 0.40408877733007464, 'support': 27874}, '2': {'precision': 0.4415154582976404, 'recall': 0.405558138703101, 'f1-score': 0.42277362465278423, 'support': 27959}, 'accuracy': 0.4166686607164222, 'macro avg': {'precision': 0.42068992738276, 'recall': 0.41666324734442933, 'f1-score': 0.4172435720720831, 'support': 83582}, 'weighted avg': {'precision': 0.42067297106813745, 'recall': 0.4166686607164222, 'f1-score': 0.4172377928576494, 'support': 83582}}
[[11252 10264  6233]
 [ 7529 12235  8110]
 [ 6437 10183 11339]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0521115
{'0': {'precision': 0.43045239702903443, 'recall': 0.3892733564013841, 'f1-score': 0.40882855921333905, 'support': 9826}, '1': {'precision': 0.42543077837195487, 'recall': 0.47880966312797796, 'f1-score': 0.45054469658237317, 'support': 11963}, '2': {'precision': 0.44905740309256514, 'recall': 0.4238728381485554, 'f1-score': 0.4361018256621239, 'support': 10003}, 'accuracy': 0.4338512833417212, 'macro avg': {'precision': 0.4349801928311848, 'recall': 0.43065195255930583, 'f1-score': 0.43182502715261206, 'support': 31792}, 'weighted avg': {'precision': 0.4344166726851383, 'recall': 0.4338512833417212, 'f1-score': 0.4331071398510136, 'support': 31792}}
[[3825 3939 2062]
 [3095 5728 3140]
 [1966 3797 4240]]
training model: results/XRAY/W8/deepLOB_L1/h30
Epoch 1/50
327/327 - 10s - loss: 3.3206 - accuracy30: 0.3678 - val_loss: 3.3102 - val_accuracy30: 0.3624 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2645 - accuracy30: 0.3896 - val_loss: 3.2688 - val_accuracy30: 0.3779 - 8s/epoch - 26ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2460 - accuracy30: 0.4001 - val_loss: 3.2421 - val_accuracy30: 0.3881 - 8s/epoch - 26ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2233 - accuracy30: 0.4069 - val_loss: 3.2347 - val_accuracy30: 0.3898 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2120 - accuracy30: 0.4152 - val_loss: 3.2352 - val_accuracy30: 0.3981 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2026 - accuracy30: 0.4193 - val_loss: 3.2312 - val_accuracy30: 0.3970 - 8s/epoch - 26ms/step
Epoch 7/50
327/327 - 8s - loss: 3.1969 - accuracy30: 0.4221 - val_loss: 3.2460 - val_accuracy30: 0.3950 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.1891 - accuracy30: 0.4259 - val_loss: 3.2521 - val_accuracy30: 0.3970 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.1821 - accuracy30: 0.4290 - val_loss: 3.2643 - val_accuracy30: 0.3927 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.1798 - accuracy30: 0.4314 - val_loss: 3.2595 - val_accuracy30: 0.3949 - 8s/epoch - 25ms/step
Epoch 11/50
327/327 - 8s - loss: 3.1735 - accuracy30: 0.4330 - val_loss: 3.2602 - val_accuracy30: 0.3946 - 8s/epoch - 25ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1684 - accuracy30: 0.4360 - val_loss: 3.2702 - val_accuracy30: 0.3916 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1638 - accuracy30: 0.4378 - val_loss: 3.2719 - val_accuracy30: 0.3961 - 8s/epoch - 25ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1585 - accuracy30: 0.4382 - val_loss: 3.2602 - val_accuracy30: 0.3957 - 8s/epoch - 25ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1554 - accuracy30: 0.4419 - val_loss: 3.2711 - val_accuracy30: 0.3999 - 8s/epoch - 26ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1508 - accuracy30: 0.4439 - val_loss: 3.2788 - val_accuracy30: 0.3970 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h30
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0520812
{'0': {'precision': 0.37545312822824517, 'recall': 0.5046961395712879, 'f1-score': 0.4305854730311908, 'support': 79214}, '1': {'precision': 0.49294749232831414, 'recall': 0.5205831842318941, 'f1-score': 0.5063885704699864, 'support': 139167}, '2': {'precision': 0.33697627919658274, 'recall': 0.18753951594547433, 'f1-score': 0.24097031536874264, 'support': 79082}, 'accuracy': 0.42781118996312145, 'macro avg': {'precision': 0.401792299917714, 'recall': 0.4042729465828854, 'f1-score': 0.39264811962330665, 'support': 297463}, 'weighted avg': {'precision': 0.4201931866341389, 'recall': 0.42781118996312145, 'f1-score': 0.4156395596335687, 'support': 297463}}
[[39979 33048  6187]
 [43725 72448 22994]
 [22778 41473 14831]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0896362
{'0': {'precision': 0.4239997005651832, 'recall': 0.4022441587955401, 'f1-score': 0.4128355108511452, 'support': 28162}, '1': {'precision': 0.3419160832589391, 'recall': 0.5371470751061082, 'f1-score': 0.4178521697937153, 'support': 27095}, '2': {'precision': 0.4488425764039443, 'recall': 0.22658428949691087, 'f1-score': 0.3011448948948949, 'support': 28325}, 'accuracy': 0.3864468426216171, 'macro avg': {'precision': 0.4049194534093556, 'recall': 0.3886585077995197, 'f1-score': 0.37727752517991847, 'support': 83582}, 'weighted avg': {'precision': 0.4058094065691102, 'recall': 0.3864468426216171, 'f1-score': 0.3766110806758461, 'support': 83582}}
[[11328 13460  3374]
 [ 8034 14554  4507]
 [ 7355 14552  6418]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768658
{'0': {'precision': 0.4171785870996051, 'recall': 0.37683313515655964, 'f1-score': 0.3959808413161183, 'support': 10092}, '1': {'precision': 0.3775464010864645, 'recall': 0.5790158812809164, 'f1-score': 0.4570645658503168, 'support': 11523}, '2': {'precision': 0.43105515587529974, 'recall': 0.21194851134912057, 'f1-score': 0.2841710032277189, 'support': 10177}, 'accuracy': 0.3973326623049824, 'macro avg': {'precision': 0.4085933813537898, 'recall': 0.3892658425955322, 'f1-score': 0.37907213679805135, 'support': 31792}, 'weighted avg': {'precision': 0.4072559701205168, 'recall': 0.3973326623049824, 'f1-score': 0.38232894887720065, 'support': 31792}}
[[3803 5277 1012]
 [3016 6672 1835]
 [2297 5723 2157]]
training model: results/XRAY/W8/deepLOB_L1/h50
Epoch 1/50
327/327 - 11s - loss: 3.3233 - accuracy50: 0.3635 - val_loss: 3.3293 - val_accuracy50: 0.3616 - 11s/epoch - 32ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2861 - accuracy50: 0.3736 - val_loss: 3.2913 - val_accuracy50: 0.3698 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2667 - accuracy50: 0.3823 - val_loss: 3.2797 - val_accuracy50: 0.3770 - 8s/epoch - 25ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2617 - accuracy50: 0.3870 - val_loss: 3.2716 - val_accuracy50: 0.3726 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2492 - accuracy50: 0.3919 - val_loss: 3.2622 - val_accuracy50: 0.3818 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2415 - accuracy50: 0.3944 - val_loss: 3.2528 - val_accuracy50: 0.3826 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2322 - accuracy50: 0.4009 - val_loss: 3.2568 - val_accuracy50: 0.3906 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2230 - accuracy50: 0.4050 - val_loss: 3.2665 - val_accuracy50: 0.3825 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2196 - accuracy50: 0.4079 - val_loss: 3.3005 - val_accuracy50: 0.3770 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2087 - accuracy50: 0.4124 - val_loss: 3.3032 - val_accuracy50: 0.3739 - 8s/epoch - 25ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2047 - accuracy50: 0.4144 - val_loss: 3.3005 - val_accuracy50: 0.3772 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2016 - accuracy50: 0.4175 - val_loss: 3.3255 - val_accuracy50: 0.3756 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1968 - accuracy50: 0.4179 - val_loss: 3.3010 - val_accuracy50: 0.3783 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1926 - accuracy50: 0.4221 - val_loss: 3.3163 - val_accuracy50: 0.3775 - 8s/epoch - 25ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1906 - accuracy50: 0.4232 - val_loss: 3.3133 - val_accuracy50: 0.3750 - 8s/epoch - 25ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1837 - accuracy50: 0.4255 - val_loss: 3.3190 - val_accuracy50: 0.3783 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h50
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774322
{'0': {'precision': 0.3079100737849025, 'recall': 0.5706936586742614, 'f1-score': 0.4000035967503361, 'support': 77949}, '1': {'precision': 0.5009296246525413, 'recall': 0.3869518229907286, 'f1-score': 0.4366250290821279, 'support': 140648}, '2': {'precision': 0.2914326951266265, 'recall': 0.16386021859863567, 'f1-score': 0.20977363666615267, 'support': 78866}, 'accuracy': 0.37595263948793634, 'macro avg': {'precision': 0.3667574645213567, 'recall': 0.37383523342120856, 'f1-score': 0.34880075416620554, 'support': 297463}, 'weighted avg': {'precision': 0.3948059527519272, 'recall': 0.37595263948793634, 'f1-score': 0.36688369673790644, 'support': 297463}}
[[44485 26597  6867]
 [61671 54424 24553]
 [38318 27625 12923]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954633
{'0': {'precision': 0.37133349765836826, 'recall': 0.4311368677112399, 'f1-score': 0.39900678695580205, 'support': 27954}, '1': {'precision': 0.3580268332176729, 'recall': 0.44531559072109334, 'f1-score': 0.3969289458077545, 'support': 27805}, '2': {'precision': 0.39674767259098054, 'recall': 0.2358839808791288, 'f1-score': 0.29586385664375076, 'support': 27823}, 'accuracy': 0.37085736163288746, 'macro avg': {'precision': 0.3753693344890072, 'recall': 0.3707788131038207, 'f1-score': 0.36393319646910244, 'support': 83582}, 'weighted avg': {'precision': 0.3753667438642085, 'recall': 0.37085736163288746, 'f1-score': 0.36398106224002996, 'support': 83582}}
[[12052 11232  4670]
 [10114 12382  5309]
 [10290 10970  6563]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847317
{'0': {'precision': 0.35454952935903183, 'recall': 0.3943563665370426, 'f1-score': 0.37339501510574025, 'support': 10029}, '1': {'precision': 0.39312151981657384, 'recall': 0.5192973347178955, 'f1-score': 0.44748517952350775, 'support': 11556}, '2': {'precision': 0.4013402829486225, 'recall': 0.21122758890957186, 'f1-score': 0.2767828487065922, 'support': 10207}, 'accuracy': 0.3809763462506291, 'macro avg': {'precision': 0.3830037773747427, 'recall': 0.37496043005483665, 'f1-score': 0.3658876811119467, 'support': 31792}, 'weighted avg': {'precision': 0.38359240629713914, 'recall': 0.3809763462506291, 'f1-score': 0.3693079981698953, 'support': 31792}}
[[3955 4662 1412]
 [3751 6001 1804]
 [3449 4602 2156]]
training model: results/XRAY/W8/deepLOB_L1/h100
Epoch 1/50
327/327 - 10s - loss: 3.3422 - accuracy100: 0.3485 - val_loss: 3.3292 - val_accuracy100: 0.3625 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3073 - accuracy100: 0.3587 - val_loss: 3.2946 - val_accuracy100: 0.3815 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2917 - accuracy100: 0.3686 - val_loss: 3.2936 - val_accuracy100: 0.3858 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2779 - accuracy100: 0.3782 - val_loss: 3.2941 - val_accuracy100: 0.3878 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2686 - accuracy100: 0.3828 - val_loss: 3.2785 - val_accuracy100: 0.3927 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2545 - accuracy100: 0.3855 - val_loss: 3.2964 - val_accuracy100: 0.3927 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2479 - accuracy100: 0.3931 - val_loss: 3.2806 - val_accuracy100: 0.3990 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2462 - accuracy100: 0.3956 - val_loss: 3.2884 - val_accuracy100: 0.3931 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2356 - accuracy100: 0.4003 - val_loss: 3.3096 - val_accuracy100: 0.3931 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2343 - accuracy100: 0.3990 - val_loss: 3.2941 - val_accuracy100: 0.3924 - 8s/epoch - 25ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2259 - accuracy100: 0.4073 - val_loss: 3.3045 - val_accuracy100: 0.3988 - 8s/epoch - 25ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2207 - accuracy100: 0.4088 - val_loss: 3.3091 - val_accuracy100: 0.3948 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2190 - accuracy100: 0.4087 - val_loss: 3.3258 - val_accuracy100: 0.3894 - 8s/epoch - 25ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2132 - accuracy100: 0.4130 - val_loss: 3.3216 - val_accuracy100: 0.3932 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2094 - accuracy100: 0.4152 - val_loss: 3.3265 - val_accuracy100: 0.3874 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h100
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0493302
{'0': {'precision': 0.2530116016160718, 'recall': 0.1047832494166769, 'f1-score': 0.14819317651400846, 'support': 65144}, '1': {'precision': 0.5529322101885279, 'recall': 0.8416431598099914, 'f1-score': 0.6674025980313837, 'support': 163782}, '2': {'precision': 0.2176642749244713, 'recall': 0.06727752892598159, 'f1-score': 0.10278530110007691, 'support': 68537}, 'accuracy': 0.501854012095622, 'macro avg': {'precision': 0.34120269557635696, 'recall': 0.3379013127175499, 'f1-score': 0.30612702521515633, 'support': 297463}, 'weighted avg': {'precision': 0.4100025463176037, 'recall': 0.501854012095622, 'f1-score': 0.42360570821614996, 'support': 297463}}
[[  6826  53830   4488]
 [ 13851 137846  12085]
 [  6302  57624   4611]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1188033
{'0': {'precision': 0.3797909407665505, 'recall': 0.05028745830080204, 'f1-score': 0.08881506784919614, 'support': 28178}, '1': {'precision': 0.3342338550929257, 'recall': 0.8926111231962874, 'f1-score': 0.48635461217071796, 'support': 27582}, '2': {'precision': 0.35137318255250405, 'recall': 0.0781755445331033, 'f1-score': 0.12789603669293192, 'support': 27822}, 'accuracy': 0.33753679021798955, 'macro avg': {'precision': 0.3551326594706601, 'recall': 0.34035804201006425, 'f1-score': 0.234355238904282, 'support': 83582}, 'weighted avg': {'precision': 0.35529769573674597, 'recall': 0.33753679021798955, 'f1-score': 0.23301174209301215, 'support': 83582}}
[[ 1417 24662  2099]
 [ 1046 24620  1916]
 [ 1268 24379  2175]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943565
{'0': {'precision': 0.3323427439326399, 'recall': 0.07047579035815565, 'f1-score': 0.11629116117850953, 'support': 9521}, '1': {'precision': 0.4021711319858182, 'recall': 0.8680867850098619, 'f1-score': 0.549682769645801, 'support': 12675}, '2': {'precision': 0.30613090306545154, 'recall': 0.07701125468945394, 'f1-score': 0.12306411323896754, 'support': 9596}, 'accuracy': 0.3904441368897836, 'macro avg': {'precision': 0.34688159299463656, 'recall': 0.3385246100191572, 'f1-score': 0.263012681354426, 'support': 31792}, 'weighted avg': {'precision': 0.35227058721436155, 'recall': 0.3904441368897836, 'f1-score': 0.2911223100617215, 'support': 31792}}
[[  671  8141   709]
 [  706 11003   966]
 [  642  8215   739]]
training model: results/XRAY/W8/deepLOB_L1/h200
Epoch 1/50
327/327 - 10s - loss: 3.3481 - accuracy200: 0.3526 - val_loss: 3.3546 - val_accuracy200: 0.3444 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3082 - accuracy200: 0.3595 - val_loss: 3.3552 - val_accuracy200: 0.3332 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2885 - accuracy200: 0.3687 - val_loss: 3.3479 - val_accuracy200: 0.3379 - 8s/epoch - 25ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2748 - accuracy200: 0.3786 - val_loss: 3.3301 - val_accuracy200: 0.3396 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2692 - accuracy200: 0.3820 - val_loss: 3.3169 - val_accuracy200: 0.3467 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2626 - accuracy200: 0.3848 - val_loss: 3.3246 - val_accuracy200: 0.3480 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2553 - accuracy200: 0.3914 - val_loss: 3.3285 - val_accuracy200: 0.3470 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2461 - accuracy200: 0.4006 - val_loss: 3.3476 - val_accuracy200: 0.3324 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2410 - accuracy200: 0.4012 - val_loss: 3.3850 - val_accuracy200: 0.3386 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2379 - accuracy200: 0.4028 - val_loss: 3.3937 - val_accuracy200: 0.3438 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2299 - accuracy200: 0.4075 - val_loss: 3.4103 - val_accuracy200: 0.3428 - 8s/epoch - 25ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2252 - accuracy200: 0.4113 - val_loss: 3.4093 - val_accuracy200: 0.3464 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2191 - accuracy200: 0.4126 - val_loss: 3.4079 - val_accuracy200: 0.3423 - 8s/epoch - 25ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2141 - accuracy200: 0.4170 - val_loss: 3.3806 - val_accuracy200: 0.3400 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2113 - accuracy200: 0.4174 - val_loss: 3.3822 - val_accuracy200: 0.3384 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h200
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935746
{'0': {'precision': 0.27490683229813667, 'recall': 0.22699473029630865, 'f1-score': 0.2486639090404725, 'support': 77993}, '1': {'precision': 0.4436045676529733, 'recall': 0.5426810071531596, 'f1-score': 0.4881664696332544, 'support': 136583}, '2': {'precision': 0.2635240621447518, 'recall': 0.20975545019122419, 'f1-score': 0.23358546842041625, 'support': 82887}, 'accuracy': 0.36714145961010275, 'macro avg': {'precision': 0.3273451540319539, 'recall': 0.3264770625468975, 'f1-score': 0.32347194903138105, 'support': 297463}, 'weighted avg': {'precision': 0.34919425331609866, 'recall': 0.36714145961010275, 'f1-score': 0.354432261829792, 'support': 297463}}
[[17704 44866 15423]
 [29296 74121 33166]
 [17400 48101 17386]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086743
{'0': {'precision': 0.3663946432308014, 'recall': 0.18215548928497122, 'f1-score': 0.243335263462652, 'support': 28838}, '1': {'precision': 0.332502691280252, 'recall': 0.6178551583626598, 'f1-score': 0.4323392563215263, 'support': 26995}, '2': {'precision': 0.34177016192422577, 'recall': 0.23503549677465854, 'f1-score': 0.27852750256235054, 'support': 27749}, 'accuracy': 0.34043215046301833, 'macro avg': {'precision': 0.34688916547842635, 'recall': 0.34501538147409655, 'f1-score': 0.3180673407821763, 'support': 83582}, 'weighted avg': {'precision': 0.3472730862606255, 'recall': 0.34043215046301833, 'f1-score': 0.3160627912796801, 'support': 83582}}
[[ 5253 17288  6297]
 [ 4052 16679  6264]
 [ 5032 16195  6522]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1063085
{'0': {'precision': 0.3156185414821376, 'recall': 0.21182998117507182, 'f1-score': 0.2535127764273433, 'support': 10093}, '1': {'precision': 0.35680355961758164, 'recall': 0.5134994807892004, 'f1-score': 0.4210451626636393, 'support': 11556}, '2': {'precision': 0.33492309526648384, 'recall': 0.2769397614118111, 'f1-score': 0.30318402590393956, 'support': 10143}, 'accuracy': 0.34225591343734274, 'macro avg': {'precision': 0.3357817321220677, 'recall': 0.3340897411253611, 'f1-score': 0.3259139883316407, 'support': 31792}, 'weighted avg': {'precision': 0.33674776136788925, 'recall': 0.34225591343734274, 'f1-score': 0.33025597404900137, 'support': 31792}}
[[2138 5383 2572]
 [2616 5934 3006]
 [2020 5314 2809]]
training model: results/XRAY/W8/deepLOB_L1/h300
Epoch 1/50
327/327 - 10s - loss: 3.3464 - accuracy300: 0.3507 - val_loss: 3.3496 - val_accuracy300: 0.3369 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3074 - accuracy300: 0.3652 - val_loss: 3.3243 - val_accuracy300: 0.3530 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.3008 - accuracy300: 0.3658 - val_loss: 3.3566 - val_accuracy300: 0.3525 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2807 - accuracy300: 0.3781 - val_loss: 3.3335 - val_accuracy300: 0.3639 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2766 - accuracy300: 0.3815 - val_loss: 3.3426 - val_accuracy300: 0.3470 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2672 - accuracy300: 0.3873 - val_loss: 3.3747 - val_accuracy300: 0.3513 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2522 - accuracy300: 0.3977 - val_loss: 3.3615 - val_accuracy300: 0.3560 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2411 - accuracy300: 0.4028 - val_loss: 3.3862 - val_accuracy300: 0.3655 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2332 - accuracy300: 0.4081 - val_loss: 3.4000 - val_accuracy300: 0.3636 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2283 - accuracy300: 0.4117 - val_loss: 3.3969 - val_accuracy300: 0.3482 - 8s/epoch - 25ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2173 - accuracy300: 0.4160 - val_loss: 3.4297 - val_accuracy300: 0.3606 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2112 - accuracy300: 0.4194 - val_loss: 3.4520 - val_accuracy300: 0.3519 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h300
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958067
{'0': {'precision': 0.2869047619047619, 'recall': 0.09777620001521414, 'f1-score': 0.14584791119012047, 'support': 78874}, '1': {'precision': 0.4337900302617139, 'recall': 0.5752980609499728, 'f1-score': 0.49462195707677137, 'support': 136046}, '2': {'precision': 0.24902115199041672, 'recall': 0.271991568031208, 'f1-score': 0.26000000000000006, 'support': 82543}, 'accuracy': 0.36451592298874147, 'macro avg': {'precision': 0.3232386480522975, 'recall': 0.3150219429987983, 'f1-score': 0.30015662275563065, 'support': 297463}, 'weighted avg': {'precision': 0.34357105790033143, 'recall': 0.36451592298874147, 'f1-score': 0.33703730184821645, 'support': 297463}}
[[ 7712 49619 21543]
 [11616 78267 46163]
 [ 7552 52540 22451]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1281776
{'0': {'precision': 0.341222512113306, 'recall': 0.0646699396037156, 'f1-score': 0.10873244455001634, 'support': 28313}, '1': {'precision': 0.3335853862379114, 'recall': 0.5923674911660778, 'f1-score': 0.4268146752552385, 'support': 28300}, '2': {'precision': 0.335240683785137, 'recall': 0.34758426341354887, 'f1-score': 0.34130090477144054, 'support': 26969}, 'accuracy': 0.33462946567442753, 'macro avg': {'precision': 0.3366828607121181, 'recall': 0.33487389806111406, 'f1-score': 0.2922826748588985, 'support': 83582}, 'weighted avg': {'precision': 0.3367065327103717, 'recall': 0.33462946567442753, 'f1-score': 0.29147353632419476, 'support': 83582}}
[[ 1831 17450  9032]
 [ 1980 16764  9556]
 [ 1555 16040  9374]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109939
{'0': {'precision': 0.3172598545732874, 'recall': 0.08383899676375405, 'f1-score': 0.1326293896488281, 'support': 9888}, '1': {'precision': 0.379366966762924, 'recall': 0.5588456084744349, 'f1-score': 0.4519392917369308, 'support': 11989}, '2': {'precision': 0.31854488626497657, 'recall': 0.37004538577912255, 'f1-score': 0.3423692436896375, 'support': 9915}, 'accuracy': 0.3522269753397081, 'macro avg': {'precision': 0.33839056920039595, 'recall': 0.33757666367243716, 'f1-score': 0.3089793083584655, 'support': 31792}, 'weighted avg': {'precision': 0.34108167318377586, 'recall': 0.3522269753397081, 'f1-score': 0.3184552914149607, 'support': 31792}}
[[ 829 5524 3535]
 [ 975 6700 4314]
 [ 809 5437 3669]]
training model: results/XRAY/W8/deepLOB_L1/h500
Epoch 1/50
327/327 - 11s - loss: 3.3352 - accuracy500: 0.3585 - val_loss: 3.3911 - val_accuracy500: 0.3350 - 11s/epoch - 32ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3126 - accuracy500: 0.3648 - val_loss: 3.3940 - val_accuracy500: 0.3460 - 8s/epoch - 25ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2931 - accuracy500: 0.3766 - val_loss: 3.4165 - val_accuracy500: 0.3574 - 8s/epoch - 25ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2884 - accuracy500: 0.3694 - val_loss: 3.4122 - val_accuracy500: 0.3230 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2714 - accuracy500: 0.3854 - val_loss: 3.3945 - val_accuracy500: 0.3184 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2514 - accuracy500: 0.3952 - val_loss: 3.3741 - val_accuracy500: 0.3302 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2409 - accuracy500: 0.4022 - val_loss: 3.4386 - val_accuracy500: 0.3217 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2314 - accuracy500: 0.4076 - val_loss: 3.4578 - val_accuracy500: 0.3232 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2220 - accuracy500: 0.4143 - val_loss: 3.4077 - val_accuracy500: 0.3195 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2005 - accuracy500: 0.4263 - val_loss: 3.4340 - val_accuracy500: 0.3228 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2034 - accuracy500: 0.4234 - val_loss: 3.4744 - val_accuracy500: 0.3159 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1916 - accuracy500: 0.4300 - val_loss: 3.4484 - val_accuracy500: 0.3217 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1872 - accuracy500: 0.4308 - val_loss: 3.4709 - val_accuracy500: 0.3206 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1851 - accuracy500: 0.4302 - val_loss: 3.4687 - val_accuracy500: 0.3234 - 8s/epoch - 25ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1727 - accuracy500: 0.4342 - val_loss: 3.5343 - val_accuracy500: 0.3164 - 8s/epoch - 25ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1629 - accuracy500: 0.4396 - val_loss: 3.5152 - val_accuracy500: 0.3171 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h500
Evaluating performance on  test set...
1162/1162 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1291634
{'0': {'precision': 0.25585137085137083, 'recall': 0.4830606601370404, 'f1-score': 0.33452353437825755, 'support': 73409}, '1': {'precision': 0.44977219167321286, 'recall': 0.19689404255904483, 'f1-score': 0.273889250315717, 'support': 145398}, '2': {'precision': 0.27036224045035867, 'recall': 0.3272731895850285, 'f1-score': 0.2961079893483024, 'support': 78656}, 'accuracy': 0.3019904996587811, 'macro avg': {'precision': 0.32532860099164745, 'recall': 0.33574263076037125, 'f1-score': 0.30150692468075896, 'support': 297463}, 'weighted avg': {'precision': 0.3544756248427317, 'recall': 0.3019904996587811, 'f1-score': 0.2947279404926267, 'support': 297463}}
[[35461 16850 21098]
 [68397 28628 48373]
 [34742 18172 25742]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.131119
{'0': {'precision': 0.35759452269853037, 'recall': 0.29201239272105695, 'f1-score': 0.32149298204344073, 'support': 28081}, '1': {'precision': 0.37307871448532837, 'recall': 0.22141598424380637, 'f1-score': 0.2779018583168896, 'support': 28941}, '2': {'precision': 0.3196549741230592, 'recall': 0.5232304216867469, 'f1-score': 0.39685871350039265, 'support': 26560}, 'accuracy': 0.34104232968821035, 'macro avg': {'precision': 0.35010940376897265, 'recall': 0.34555293288387007, 'f1-score': 0.33208451795357435, 'support': 83582}, 'weighted avg': {'precision': 0.3508999423383715, 'recall': 0.34104232968821035, 'f1-score': 0.3303482752372687, 'support': 83582}}
[[ 8200  5871 14010]
 [ 6965  6408 15568]
 [ 7766  4897 13897]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269444
{'0': {'precision': 0.2979256360078278, 'recall': 0.3913624678663239, 'f1-score': 0.3383111111111112, 'support': 9725}, '1': {'precision': 0.41777286135693215, 'recall': 0.18203727506426734, 'f1-score': 0.2535810205908684, 'support': 12448}, '2': {'precision': 0.32641800926947695, 'recall': 0.4612745607651523, 'f1-score': 0.3823022574530416, 'support': 9619}, 'accuracy': 0.33055485656768996, 'macro avg': {'precision': 0.3473721688780789, 'recall': 0.34489143456524785, 'f1-score': 0.3247314630516737, 'support': 31792}, 'weighted avg': {'precision': 0.3534718866227452, 'recall': 0.33055485656768996, 'f1-score': 0.3184454426997827, 'support': 31792}}
[[3806 1550 4369]
 [5395 2266 4787]
 [3574 1608 4437]]
training model: results/XRAY/W8/deepLOB_L1/h1000
Epoch 1/50
327/327 - 10s - loss: 3.3435 - accuracy1000: 0.3636 - val_loss: 3.4152 - val_accuracy1000: 0.3288 - 10s/epoch - 31ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2954 - accuracy1000: 0.3841 - val_loss: 3.5716 - val_accuracy1000: 0.3240 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2841 - accuracy1000: 0.3866 - val_loss: 3.3801 - val_accuracy1000: 0.3233 - 8s/epoch - 25ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2659 - accuracy1000: 0.3955 - val_loss: 3.4045 - val_accuracy1000: 0.3008 - 8s/epoch - 25ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2511 - accuracy1000: 0.3924 - val_loss: 3.4234 - val_accuracy1000: 0.3032 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2243 - accuracy1000: 0.4087 - val_loss: 3.5149 - val_accuracy1000: 0.3017 - 8s/epoch - 25ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2076 - accuracy1000: 0.4216 - val_loss: 3.5548 - val_accuracy1000: 0.3013 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.1979 - accuracy1000: 0.4194 - val_loss: 3.5873 - val_accuracy1000: 0.3034 - 8s/epoch - 25ms/step
Epoch 9/50
327/327 - 8s - loss: 3.1817 - accuracy1000: 0.4284 - val_loss: 3.7137 - val_accuracy1000: 0.2999 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.1606 - accuracy1000: 0.4377 - val_loss: 3.6980 - val_accuracy1000: 0.2986 - 8s/epoch - 26ms/step
Epoch 11/50
327/327 - 8s - loss: 3.1538 - accuracy1000: 0.4425 - val_loss: 3.6453 - val_accuracy1000: 0.2985 - 8s/epoch - 25ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1408 - accuracy1000: 0.4498 - val_loss: 3.8194 - val_accuracy1000: 0.3005 - 8s/epoch - 25ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1304 - accuracy1000: 0.4520 - val_loss: 3.8424 - val_accuracy1000: 0.2997 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1253887
{'0': {'precision': 0.25668262290099536, 'recall': 0.46366905487386423, 'f1-score': 0.3304380147504744, 'support': 72858}, '1': {'precision': 0.5073898461894298, 'recall': 0.1495629763966347, 'f1-score': 0.23102643897866873, 'support': 146674}, '2': {'precision': 0.28230765466734087, 'recall': 0.44418780716274653, 'f1-score': 0.34521239198400394, 'support': 77931}, 'accuracy': 0.3036848280290322, 'macro avg': {'precision': 0.348793374585922, 'recall': 0.3524732794777485, 'f1-score': 0.3022256152377157, 'support': 297463}, 'weighted avg': {'precision': 0.38701552352793356, 'recall': 0.3036848280290322, 'f1-score': 0.28529051246424847, 'support': 297463}}
[[33782 10599 28477]
 [65212 21937 59525]
 [32616 10699 34616]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1256106
{'0': {'precision': 0.3841145322612277, 'recall': 0.3278869655472595, 'f1-score': 0.35378057151114484, 'support': 29867}, '1': {'precision': 0.34233971082225795, 'recall': 0.08652319958657857, 'f1-score': 0.13813424479934, 'support': 27091}, '2': {'precision': 0.3188914910226386, 'recall': 0.6137319711538461, 'f1-score': 0.4197061543203534, 'support': 26624}, 'accuracy': 0.34070732932928144, 'macro avg': {'precision': 0.34844857803537477, 'recall': 0.34271404542922806, 'f1-score': 0.30387365687694606, 'support': 83582}, 'weighted avg': {'precision': 0.3497982926696969, 'recall': 0.34070732932928144, 'f1-score': 0.3048840157905694, 'support': 83582}}
[[ 9793  2403 17671]
 [ 7518  2344 17229]
 [ 8184  2100 16340]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1217487
{'0': {'precision': 0.2960717548376381, 'recall': 0.3676394761266371, 'f1-score': 0.3279970558469041, 'support': 9697}, '1': {'precision': 0.4407126766332173, 'recall': 0.16932882209457864, 'f1-score': 0.24465666211914505, 'support': 12709}, '2': {'precision': 0.31241592682270647, 'recall': 0.49488600042616665, 'f1-score': 0.38302960336439357, 'support': 9386}, 'accuracy': 0.3259310518369401, 'macro avg': {'precision': 0.3497334527645206, 'recall': 0.34395143288246083, 'f1-score': 0.31856110711014757, 'support': 31792}, 'weighted avg': {'precision': 0.358717951155953, 'recall': 0.3259310518369401, 'f1-score': 0.3109286872986236, 'support': 31792}}
[[3565 1417 4715]
 [5049 2152 5508]
 [3427 1314 4645]]
training model: results/XRAY/W8/deepOF_L1/h10
Epoch 1/50
327/327 - 10s - loss: 3.2912 - accuracy10: 0.3812 - val_loss: 3.2503 - val_accuracy10: 0.4037 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2409 - accuracy10: 0.4051 - val_loss: 3.2345 - val_accuracy10: 0.4096 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2277 - accuracy10: 0.4101 - val_loss: 3.2301 - val_accuracy10: 0.4108 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2195 - accuracy10: 0.4119 - val_loss: 3.2251 - val_accuracy10: 0.4099 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2117 - accuracy10: 0.4154 - val_loss: 3.2291 - val_accuracy10: 0.4077 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2090 - accuracy10: 0.4151 - val_loss: 3.2291 - val_accuracy10: 0.4082 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2049 - accuracy10: 0.4172 - val_loss: 3.2274 - val_accuracy10: 0.4090 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.1993 - accuracy10: 0.4180 - val_loss: 3.2292 - val_accuracy10: 0.4086 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.1939 - accuracy10: 0.4210 - val_loss: 3.2264 - val_accuracy10: 0.4109 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.1921 - accuracy10: 0.4209 - val_loss: 3.2257 - val_accuracy10: 0.4086 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.1890 - accuracy10: 0.4224 - val_loss: 3.2264 - val_accuracy10: 0.4101 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1859 - accuracy10: 0.4249 - val_loss: 3.2254 - val_accuracy10: 0.4096 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1851 - accuracy10: 0.4249 - val_loss: 3.2266 - val_accuracy10: 0.4101 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1805 - accuracy10: 0.4268 - val_loss: 3.2277 - val_accuracy10: 0.4088 - 8s/epoch - 25ms/step
testing model: results/XRAY/W8/deepOF_L1/h10
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0830996
{'0': {'precision': 0.34915365424564404, 'recall': 0.4619613103457345, 'f1-score': 0.39771299179167846, 'support': 76041}, '1': {'precision': 0.49750545810746866, 'recall': 0.4089680774112541, 'f1-score': 0.44891294170521157, 'support': 146542}, '2': {'precision': 0.28645301495038356, 'recall': 0.29223372287145244, 'f1-score': 0.2893144961358182, 'support': 74875}, 'accuracy': 0.3931311311176704, 'macro avg': {'precision': 0.3777040424344988, 'recall': 0.387721036876147, 'f1-score': 0.37864680987756943, 'support': 297458}, 'weighted avg': {'precision': 0.4064560622302566, 'recall': 0.3931311311176704, 'f1-score': 0.3956508710821881, 'support': 297458}}
[[35128 29218 11695]
 [43801 59931 42810]
 [21680 31314 21881]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730697
{'0': {'precision': 0.4250684552195182, 'recall': 0.4976048982531965, 'f1-score': 0.45848543173823586, 'support': 27765}, '1': {'precision': 0.3716144651233167, 'recall': 0.35415840513356645, 'f1-score': 0.36267651130595296, 'support': 27739}, '2': {'precision': 0.433307632999229, 'recall': 0.3802977420044163, 'f1-score': 0.40507577625614083, 'support': 28078}, 'accuracy': 0.41059079706156826, 'macro avg': {'precision': 0.4099968511140213, 'recall': 0.410687015130393, 'f1-score': 0.40874590643344316, 'support': 83582}, 'weighted avg': {'precision': 0.41009608559950655, 'recall': 0.41059079706156826, 'f1-score': 0.40874649332449414, 'support': 83582}}
[[13816  7866  6083]
 [10033  9824  7882]
 [ 8654  8746 10678]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0749872
{'0': {'precision': 0.3939489941390781, 'recall': 0.5078101071975498, 'f1-score': 0.4436911823736675, 'support': 9795}, '1': {'precision': 0.4264951902969469, 'recall': 0.33966192022649677, 'f1-score': 0.3781578825383581, 'support': 12009}, '2': {'precision': 0.41626744428244117, 'recall': 0.4001802162595114, 'f1-score': 0.40806533945890755, 'support': 9988}, 'accuracy': 0.41048062405636637, 'macro avg': {'precision': 0.412237209572822, 'recall': 0.41588408122785264, 'f1-score': 0.4099714681236444, 'support': 31792}, 'weighted avg': {'precision': 0.4132546040312446, 'recall': 0.41048062405636637, 'f1-score': 0.40774439334640117, 'support': 31792}}
[[4974 2585 2236]
 [4561 4079 3369]
 [3091 2900 3997]]
training model: results/XRAY/W8/deepOF_L1/h20
Epoch 1/50
327/327 - 10s - loss: 3.3000 - accuracy20: 0.3729 - val_loss: 3.2558 - val_accuracy20: 0.3903 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2511 - accuracy20: 0.3972 - val_loss: 3.2409 - val_accuracy20: 0.4010 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2342 - accuracy20: 0.4032 - val_loss: 3.2291 - val_accuracy20: 0.4010 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2263 - accuracy20: 0.4052 - val_loss: 3.2312 - val_accuracy20: 0.3968 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2175 - accuracy20: 0.4102 - val_loss: 3.2284 - val_accuracy20: 0.3952 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2152 - accuracy20: 0.4108 - val_loss: 3.2293 - val_accuracy20: 0.3964 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2103 - accuracy20: 0.4129 - val_loss: 3.2307 - val_accuracy20: 0.3923 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2063 - accuracy20: 0.4138 - val_loss: 3.2311 - val_accuracy20: 0.3924 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2026 - accuracy20: 0.4155 - val_loss: 3.2285 - val_accuracy20: 0.3963 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2006 - accuracy20: 0.4163 - val_loss: 3.2325 - val_accuracy20: 0.3931 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.1969 - accuracy20: 0.4182 - val_loss: 3.2287 - val_accuracy20: 0.3921 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1936 - accuracy20: 0.4193 - val_loss: 3.2303 - val_accuracy20: 0.3895 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1902 - accuracy20: 0.4202 - val_loss: 3.2296 - val_accuracy20: 0.3918 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1889 - accuracy20: 0.4214 - val_loss: 3.2273 - val_accuracy20: 0.3897 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1845 - accuracy20: 0.4251 - val_loss: 3.2286 - val_accuracy20: 0.3901 - 8s/epoch - 25ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1816 - accuracy20: 0.4248 - val_loss: 3.2308 - val_accuracy20: 0.3912 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.1807 - accuracy20: 0.4248 - val_loss: 3.2326 - val_accuracy20: 0.3870 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.1782 - accuracy20: 0.4280 - val_loss: 3.2318 - val_accuracy20: 0.3921 - 8s/epoch - 23ms/step
Epoch 19/50
327/327 - 8s - loss: 3.1745 - accuracy20: 0.4280 - val_loss: 3.2294 - val_accuracy20: 0.3928 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.1709 - accuracy20: 0.4288 - val_loss: 3.2359 - val_accuracy20: 0.3854 - 8s/epoch - 24ms/step
Epoch 21/50
327/327 - 8s - loss: 3.1685 - accuracy20: 0.4316 - val_loss: 3.2334 - val_accuracy20: 0.3893 - 8s/epoch - 24ms/step
Epoch 22/50
327/327 - 8s - loss: 3.1638 - accuracy20: 0.4336 - val_loss: 3.2319 - val_accuracy20: 0.3898 - 8s/epoch - 24ms/step
Epoch 23/50
327/327 - 8s - loss: 3.1616 - accuracy20: 0.4337 - val_loss: 3.2382 - val_accuracy20: 0.3875 - 8s/epoch - 24ms/step
Epoch 24/50
327/327 - 8s - loss: 3.1594 - accuracy20: 0.4337 - val_loss: 3.2355 - val_accuracy20: 0.3899 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h20
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0853204
{'0': {'precision': 0.35694415467000484, 'recall': 0.5357725380690789, 'f1-score': 0.4284469580370326, 'support': 76637}, '1': {'precision': 0.6699816656480916, 'recall': 0.08310018330416087, 'f1-score': 0.14786068553702036, 'support': 145114}, '2': {'precision': 0.3003886223065555, 'recall': 0.6524099488818735, 'f1-score': 0.41137031823898323, 'support': 75707}, 'accuracy': 0.3446234426372799, 'macro avg': {'precision': 0.44243814754155064, 'recall': 0.4237608900850378, 'f1-score': 0.3292259872710121, 'support': 297458}, 'weighted avg': {'precision': 0.49526444082614934, 'recall': 0.3446234426372799, 'f1-score': 0.28721754912297515, 'support': 297458}}
[[41060  3023 32554]
 [50574 12059 82481]
 [23398  2917 49392]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.065667
{'0': {'precision': 0.4368963970698161, 'recall': 0.5263309559829984, 'f1-score': 0.47746172823369876, 'support': 27762}, '1': {'precision': 0.37876225904633076, 'recall': 0.0402674911914863, 'f1-score': 0.07279581424068116, 'support': 27814}, '2': {'precision': 0.40144128868164475, 'recall': 0.6762836535028208, 'f1-score': 0.5038172000106403, 'support': 28006}, 'accuracy': 0.41482615874231293, 'macro avg': {'precision': 0.4056999815992639, 'recall': 0.4142940335591018, 'f1-score': 0.3513582474950067, 'support': 83582}, 'weighted avg': {'precision': 0.4056707901149173, 'recall': 0.41482615874231293, 'f1-score': 0.3516300134001608, 'support': 83582}}
[[14612   890 12260]
 [10714  1120 15980]
 [ 8119   947 18940]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0752407
{'0': {'precision': 0.39963738007101307, 'recall': 0.5391907043114871, 'f1-score': 0.45904199930579664, 'support': 9811}, '1': {'precision': 0.4016454749439043, 'recall': 0.04491844416562108, 'f1-score': 0.08080048149262715, 'support': 11955}, '2': {'precision': 0.38558485306075035, 'recall': 0.6621783363255536, 'f1-score': 0.4873733666128322, 'support': 10026}, 'accuracy': 0.3921112229491696, 'macro avg': {'precision': 0.39562256935855594, 'recall': 0.4154291616008872, 'f1-score': 0.3424052824704187, 'support': 31792}, 'weighted avg': {'precision': 0.39596086202875463, 'recall': 0.3921112229491696, 'f1-score': 0.32574346329560216, 'support': 31792}}
[[5290  359 4162]
 [5001  537 6417]
 [2946  441 6639]]
training model: results/XRAY/W8/deepOF_L1/h30
Epoch 1/50
327/327 - 11s - loss: 3.2998 - accuracy30: 0.3732 - val_loss: 3.2650 - val_accuracy30: 0.3868 - 11s/epoch - 32ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2533 - accuracy30: 0.3955 - val_loss: 3.2480 - val_accuracy30: 0.3926 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2404 - accuracy30: 0.3984 - val_loss: 3.2407 - val_accuracy30: 0.3933 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2313 - accuracy30: 0.4025 - val_loss: 3.2403 - val_accuracy30: 0.3971 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2240 - accuracy30: 0.4083 - val_loss: 3.2375 - val_accuracy30: 0.3970 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2198 - accuracy30: 0.4109 - val_loss: 3.2358 - val_accuracy30: 0.3982 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2142 - accuracy30: 0.4123 - val_loss: 3.2368 - val_accuracy30: 0.3976 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2115 - accuracy30: 0.4156 - val_loss: 3.2374 - val_accuracy30: 0.3971 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2087 - accuracy30: 0.4169 - val_loss: 3.2337 - val_accuracy30: 0.4003 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2060 - accuracy30: 0.4165 - val_loss: 3.2362 - val_accuracy30: 0.3975 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2028 - accuracy30: 0.4190 - val_loss: 3.2361 - val_accuracy30: 0.3960 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.1994 - accuracy30: 0.4191 - val_loss: 3.2344 - val_accuracy30: 0.3984 - 8s/epoch - 23ms/step
Epoch 13/50
327/327 - 8s - loss: 3.1964 - accuracy30: 0.4217 - val_loss: 3.2358 - val_accuracy30: 0.3972 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.1940 - accuracy30: 0.4223 - val_loss: 3.2351 - val_accuracy30: 0.3970 - 8s/epoch - 23ms/step
Epoch 15/50
327/327 - 8s - loss: 3.1929 - accuracy30: 0.4218 - val_loss: 3.2349 - val_accuracy30: 0.3964 - 8s/epoch - 23ms/step
Epoch 16/50
327/327 - 8s - loss: 3.1893 - accuracy30: 0.4230 - val_loss: 3.2358 - val_accuracy30: 0.3976 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.1859 - accuracy30: 0.4273 - val_loss: 3.2341 - val_accuracy30: 0.3971 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.1853 - accuracy30: 0.4257 - val_loss: 3.2347 - val_accuracy30: 0.3990 - 8s/epoch - 24ms/step
Epoch 19/50
327/327 - 8s - loss: 3.1812 - accuracy30: 0.4283 - val_loss: 3.2375 - val_accuracy30: 0.3970 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h30
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082424
{'0': {'precision': 0.36009466885956115, 'recall': 0.5666384719294038, 'f1-score': 0.4403500510164037, 'support': 79211}, '1': {'precision': 0.7058242843040474, 'recall': 0.07706623744305362, 'f1-score': 0.1389599704588594, 'support': 139166}, '2': {'precision': 0.3157380502226903, 'recall': 0.6293041312072432, 'f1-score': 0.42050029784663223, 'support': 79081}, 'accuracy': 0.3542516926759408, 'macro avg': {'precision': 0.46055233446209964, 'recall': 0.4243362801932335, 'f1-score': 0.33327010644063176, 'support': 297458}, 'weighted avg': {'precision': 0.5100521146318214, 'recall': 0.3542516926759408, 'f1-score': 0.2940672471204254, 'support': 297458}}
[[44884  2111 32216]
 [52805 10725 75636]
 [26956  2359 49766]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0697025
{'0': {'precision': 0.4307963723571409, 'recall': 0.5549912994069391, 'f1-score': 0.4850704575082252, 'support': 28159}, '1': {'precision': 0.38854895104895104, 'recall': 0.03276211534918003, 'f1-score': 0.06042891615402916, 'support': 27135}, '2': {'precision': 0.4074905035875336, 'recall': 0.6484728506787331, 'f1-score': 0.5004842780165063, 'support': 28288}, 'accuracy': 0.4170874111650834, 'macro avg': {'precision': 0.4089452756645418, 'recall': 0.4120754218116174, 'f1-score': 0.34866121722625354, 'support': 83582}, 'weighted avg': {'precision': 0.4091929147591846, 'recall': 0.4170874111650834, 'f1-score': 0.35242680133694604, 'support': 83582}}
[[15628   674 11857]
 [11430   889 14816]
 [ 9219   725 18344]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747837
{'0': {'precision': 0.4058831848394852, 'recall': 0.5677546983184966, 'f1-score': 0.47336302160646543, 'support': 10110}, '1': {'precision': 0.3955479452054795, 'recall': 0.04028601325427276, 'f1-score': 0.0731244064577398, 'support': 11468}, '2': {'precision': 0.39424827084091735, 'recall': 0.636185627570002, 'f1-score': 0.4868145040455499, 'support': 10214}, 'accuracy': 0.3994715651736286, 'macro avg': {'precision': 0.398559800295294, 'recall': 0.4147421130475904, 'f1-score': 0.3444339773699184, 'support': 31792}, 'weighted avg': {'precision': 0.3984170443102908, 'recall': 0.3994715651736286, 'f1-score': 0.33331071294728143, 'support': 31792}}
[[5740  290 4080]
 [5102  462 5904]
 [3300  416 6498]]
training model: results/XRAY/W8/deepOF_L1/h50
Epoch 1/50
327/327 - 10s - loss: 3.3140 - accuracy50: 0.3648 - val_loss: 3.2770 - val_accuracy50: 0.3759 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2703 - accuracy50: 0.3839 - val_loss: 3.2641 - val_accuracy50: 0.3790 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2576 - accuracy50: 0.3885 - val_loss: 3.2602 - val_accuracy50: 0.3784 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2508 - accuracy50: 0.3932 - val_loss: 3.2560 - val_accuracy50: 0.3835 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2432 - accuracy50: 0.3965 - val_loss: 3.2537 - val_accuracy50: 0.3828 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2400 - accuracy50: 0.3993 - val_loss: 3.2537 - val_accuracy50: 0.3850 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2351 - accuracy50: 0.4025 - val_loss: 3.2555 - val_accuracy50: 0.3840 - 8s/epoch - 23ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2329 - accuracy50: 0.4008 - val_loss: 3.2548 - val_accuracy50: 0.3848 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2293 - accuracy50: 0.4022 - val_loss: 3.2527 - val_accuracy50: 0.3861 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2279 - accuracy50: 0.4027 - val_loss: 3.2532 - val_accuracy50: 0.3834 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2233 - accuracy50: 0.4062 - val_loss: 3.2526 - val_accuracy50: 0.3859 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2203 - accuracy50: 0.4078 - val_loss: 3.2519 - val_accuracy50: 0.3858 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2192 - accuracy50: 0.4089 - val_loss: 3.2542 - val_accuracy50: 0.3826 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2159 - accuracy50: 0.4102 - val_loss: 3.2520 - val_accuracy50: 0.3847 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2127 - accuracy50: 0.4109 - val_loss: 3.2531 - val_accuracy50: 0.3836 - 8s/epoch - 24ms/step
Epoch 16/50
327/327 - 8s - loss: 3.2095 - accuracy50: 0.4120 - val_loss: 3.2539 - val_accuracy50: 0.3831 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.2079 - accuracy50: 0.4144 - val_loss: 3.2576 - val_accuracy50: 0.3826 - 8s/epoch - 23ms/step
Epoch 18/50
327/327 - 8s - loss: 3.2065 - accuracy50: 0.4147 - val_loss: 3.2563 - val_accuracy50: 0.3840 - 8s/epoch - 24ms/step
Epoch 19/50
327/327 - 8s - loss: 3.2034 - accuracy50: 0.4158 - val_loss: 3.2536 - val_accuracy50: 0.3843 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.2004 - accuracy50: 0.4174 - val_loss: 3.2551 - val_accuracy50: 0.3838 - 8s/epoch - 23ms/step
Epoch 21/50
327/327 - 8s - loss: 3.1977 - accuracy50: 0.4183 - val_loss: 3.2552 - val_accuracy50: 0.3832 - 8s/epoch - 24ms/step
Epoch 22/50
327/327 - 8s - loss: 3.1936 - accuracy50: 0.4206 - val_loss: 3.2530 - val_accuracy50: 0.3864 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h50
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858959
{'0': {'precision': 0.34867656669813374, 'recall': 0.4928155389628717, 'f1-score': 0.408401288580329, 'support': 77946}, '1': {'precision': 0.7934814127472017, 'recall': 0.09727900346256942, 'f1-score': 0.1733105326493128, 'support': 140647}, '2': {'precision': 0.3135897722394397, 'recall': 0.6761554555252647, 'f1-score': 0.428464678279874, 'support': 78865}, 'accuracy': 0.3544029745375818, 'macro avg': {'precision': 0.48524925056159174, 'recall': 0.4220833326502353, 'f1-score': 0.33672549983650524, 'support': 297458}, 'weighted avg': {'precision': 0.5496909860019628, 'recall': 0.3544029745375818, 'f1-score': 0.30256278257015273, 'support': 297458}}
[[38413  1709 37824]
 [48067 13682 78898]
 [23688  1852 53325]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0763946
{'0': {'precision': 0.42476913031311214, 'recall': 0.48909813468905516, 'f1-score': 0.45466950675630696, 'support': 27931}, '1': {'precision': 0.42678571428571427, 'recall': 0.02573859353124888, 'f1-score': 0.04854927717777703, 'support': 27857}, '2': {'precision': 0.3899197844836252, 'recall': 0.6978124775131324, 'f1-score': 0.5002901915264075, 'support': 27794}, 'accuracy': 0.4040702543609868, 'macro avg': {'precision': 0.4138248763608172, 'recall': 0.40421640191114544, 'f1-score': 0.33450299182016385, 'support': 83582}, 'weighted avg': {'precision': 0.41385258442691675, 'recall': 0.4040702543609868, 'f1-score': 0.33448441998081785, 'support': 83582}}
[[13661   481 13789]
 [10583   717 16557]
 [ 7917   482 19395]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836089
{'0': {'precision': 0.39401851412295275, 'recall': 0.49616419248779514, 'f1-score': 0.4392309049215029, 'support': 10037}, '1': {'precision': 0.3799795709908069, 'recall': 0.0323056882327399, 'f1-score': 0.059548583319993596, 'support': 11515}, '2': {'precision': 0.3788929239573016, 'recall': 0.6724609375, 'f1-score': 0.4846906454564651, 'support': 10240}, 'accuracy': 0.3849396074484147, 'macro avg': {'precision': 0.38429700302368713, 'recall': 0.40031027274017833, 'f1-score': 0.32782337789932053, 'support': 31792}, 'weighted avg': {'precision': 0.38406178055907103, 'recall': 0.3849396074484147, 'f1-score': 0.3163530051302546, 'support': 31792}}
[[4980  278 4779]
 [4634  372 6509]
 [3025  329 6886]]
training model: results/XRAY/W8/deepOF_L1/h100
Epoch 1/50
327/327 - 10s - loss: 3.3302 - accuracy100: 0.3511 - val_loss: 3.3086 - val_accuracy100: 0.3517 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.2942 - accuracy100: 0.3693 - val_loss: 3.2985 - val_accuracy100: 0.3541 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2815 - accuracy100: 0.3746 - val_loss: 3.2971 - val_accuracy100: 0.3487 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2752 - accuracy100: 0.3777 - val_loss: 3.2996 - val_accuracy100: 0.3458 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2706 - accuracy100: 0.3812 - val_loss: 3.2988 - val_accuracy100: 0.3450 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2672 - accuracy100: 0.3832 - val_loss: 3.3002 - val_accuracy100: 0.3470 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2642 - accuracy100: 0.3836 - val_loss: 3.3011 - val_accuracy100: 0.3487 - 8s/epoch - 25ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2612 - accuracy100: 0.3854 - val_loss: 3.3024 - val_accuracy100: 0.3475 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2590 - accuracy100: 0.3867 - val_loss: 3.3020 - val_accuracy100: 0.3501 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 7s - loss: 3.2575 - accuracy100: 0.3874 - val_loss: 3.2997 - val_accuracy100: 0.3494 - 7s/epoch - 23ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2546 - accuracy100: 0.3908 - val_loss: 3.3034 - val_accuracy100: 0.3480 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2542 - accuracy100: 0.3902 - val_loss: 3.2979 - val_accuracy100: 0.3505 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2496 - accuracy100: 0.3935 - val_loss: 3.2981 - val_accuracy100: 0.3500 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h100
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963497
{'0': {'precision': 0.27160727465415113, 'recall': 0.4406373768075896, 'f1-score': 0.33606518990305817, 'support': 65142}, '1': {'precision': 0.6209161853533794, 'recall': 0.17197565011387297, 'f1-score': 0.2693493862991953, 'support': 163779}, '2': {'precision': 0.2580012840302157, 'recall': 0.5511621459941346, 'f1-score': 0.3514754525449987, 'support': 68537}, 'accuracy': 0.3181793732224381, 'macro avg': {'precision': 0.38350824801258215, 'recall': 0.3879250576385324, 'f1-score': 0.31896334291575074, 'support': 297458}, 'weighted avg': {'precision': 0.4608002037601637, 'recall': 0.3181793732224381, 'f1-score': 0.3028824399761899, 'support': 297458}}
[[28704  8102 28336]
 [55310 28166 80303]
 [21668  9094 37775]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918767
{'0': {'precision': 0.39007259040193576, 'recall': 0.4116249379388609, 'f1-score': 0.40055906408530906, 'support': 28198}, '1': {'precision': 0.34714072028535264, 'recall': 0.10954576812751897, 'f1-score': 0.16653786707882534, 'support': 27541}, '2': {'precision': 0.3669879251135482, 'recall': 0.5949071579930324, 'f1-score': 0.4539450245279399, 'support': 27843}, 'accuracy': 0.3731425426527243, 'macro avg': {'precision': 0.3680670786002789, 'recall': 0.37202595468647076, 'f1-score': 0.3403473185640247, 'support': 83582}, 'weighted avg': {'precision': 0.36823615468006515, 'recall': 0.3731425426527243, 'f1-score': 0.3412310689410029, 'support': 83582}}
[[11607  2835 13756]
 [ 9709  3017 14815]
 [ 8440  2839 16564]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0961998
{'0': {'precision': 0.3505392912172573, 'recall': 0.4310072623934323, 'f1-score': 0.38663078884010765, 'support': 9501}, '1': {'precision': 0.4022801302931596, 'recall': 0.11657358609297569, 'f1-score': 0.18076477404403243, 'support': 12713}, '2': {'precision': 0.33702666504322415, 'recall': 0.5779912299018585, 'f1-score': 0.4257806491309029, 'support': 9578}, 'accuracy': 0.3495533467539004, 'macro avg': {'precision': 0.3632820288512137, 'recall': 0.37519069279608885, 'f1-score': 0.3310587373383476, 'support': 31792}, 'weighted avg': {'precision': 0.3671584832679951, 'recall': 0.3495533467539004, 'f1-score': 0.31610369761472806, 'support': 31792}}
[[4095 1066 4340]
 [4681 1482 6550]
 [2906 1136 5536]]
training model: results/XRAY/W8/deepOF_L1/h200
Epoch 1/50
327/327 - 10s - loss: 3.3411 - accuracy200: 0.3447 - val_loss: 3.3497 - val_accuracy200: 0.3336 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3086 - accuracy200: 0.3574 - val_loss: 3.3379 - val_accuracy200: 0.3365 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.2979 - accuracy200: 0.3643 - val_loss: 3.3417 - val_accuracy200: 0.3368 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2920 - accuracy200: 0.3652 - val_loss: 3.3350 - val_accuracy200: 0.3394 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2887 - accuracy200: 0.3655 - val_loss: 3.3326 - val_accuracy200: 0.3409 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2858 - accuracy200: 0.3680 - val_loss: 3.3370 - val_accuracy200: 0.3389 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2830 - accuracy200: 0.3691 - val_loss: 3.3350 - val_accuracy200: 0.3452 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2804 - accuracy200: 0.3696 - val_loss: 3.3356 - val_accuracy200: 0.3403 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2791 - accuracy200: 0.3709 - val_loss: 3.3351 - val_accuracy200: 0.3430 - 8s/epoch - 25ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2779 - accuracy200: 0.3714 - val_loss: 3.3355 - val_accuracy200: 0.3413 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2754 - accuracy200: 0.3739 - val_loss: 3.3324 - val_accuracy200: 0.3433 - 8s/epoch - 23ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2745 - accuracy200: 0.3750 - val_loss: 3.3337 - val_accuracy200: 0.3435 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2729 - accuracy200: 0.3736 - val_loss: 3.3345 - val_accuracy200: 0.3422 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2704 - accuracy200: 0.3781 - val_loss: 3.3354 - val_accuracy200: 0.3419 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2704 - accuracy200: 0.3776 - val_loss: 3.3325 - val_accuracy200: 0.3442 - 8s/epoch - 24ms/step
Epoch 16/50
327/327 - 8s - loss: 3.2681 - accuracy200: 0.3786 - val_loss: 3.3358 - val_accuracy200: 0.3401 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.2664 - accuracy200: 0.3806 - val_loss: 3.3359 - val_accuracy200: 0.3451 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.2654 - accuracy200: 0.3805 - val_loss: 3.3356 - val_accuracy200: 0.3427 - 8s/epoch - 23ms/step
Epoch 19/50
327/327 - 8s - loss: 3.2635 - accuracy200: 0.3833 - val_loss: 3.3349 - val_accuracy200: 0.3420 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.2609 - accuracy200: 0.3855 - val_loss: 3.3345 - val_accuracy200: 0.3433 - 8s/epoch - 24ms/step
Epoch 21/50
327/327 - 8s - loss: 3.2598 - accuracy200: 0.3853 - val_loss: 3.3339 - val_accuracy200: 0.3456 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h200
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175262
{'0': {'precision': 0.2940808907066576, 'recall': 0.3318972701978433, 'f1-score': 0.3118468053321768, 'support': 77991}, '1': {'precision': 0.7806547880277364, 'recall': 0.06511839041747815, 'f1-score': 0.12020949484710255, 'support': 136582}, '2': {'precision': 0.30171425686081443, 'recall': 0.7209145201182361, 'f1-score': 0.4253942263197238, 'support': 82885}, 'accuracy': 0.3177994876587619, 'macro avg': {'precision': 0.4588166451984028, 'recall': 0.37264339357785253, 'f1-score': 0.28581684216633435, 'support': 297458}, 'weighted avg': {'precision': 0.5196250939138158, 'recall': 0.3177994876587619, 'f1-score': 0.25549320532101705, 'support': 297458}}
[[25885  1068 51038]
 [40434  8894 87254]
 [21701  1431 59753]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958406
{'0': {'precision': 0.39412195016997287, 'recall': 0.31773399014778325, 'f1-score': 0.3518294439642754, 'support': 28826}, '1': {'precision': 0.42379679144385024, 'recall': 0.01174074074074074, 'f1-score': 0.022848493585123256, 'support': 27000}, '2': {'precision': 0.35400620857454485, 'recall': 0.7600879089205937, 'f1-score': 0.48303969044429945, 'support': 27756}, 'accuracy': 0.3657844990548204, 'macro avg': {'precision': 0.39064165006278934, 'recall': 0.3631875466030392, 'f1-score': 0.28590587599789935, 'support': 83582}, 'weighted avg': {'precision': 0.39038631559161857, 'recall': 0.3657844990548204, 'f1-score': 0.289129172865982, 'support': 83582}}
[[ 9159   229 19438]
 [ 7623   317 19060]
 [ 6457   202 21097]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1075583
{'0': {'precision': 0.345695638661556, 'recall': 0.3303960396039604, 'f1-score': 0.33787272819318587, 'support': 10100}, '1': {'precision': 0.3968871595330739, 'recall': 0.017677642980935875, 'f1-score': 0.033847685415629665, 'support': 11540}, '2': {'precision': 0.33604624277456646, 'recall': 0.7158195429472025, 'f1-score': 0.45737483085250336, 'support': 10152}, 'accuracy': 0.3399597382989431, 'macro avg': {'precision': 0.3595430136563988, 'recall': 0.35463107517736625, 'f1-score': 0.2763650814871063, 'support': 31792}, 'weighted avg': {'precision': 0.3611960627875185, 'recall': 0.3399597382989431, 'f1-score': 0.265676463489625, 'support': 31792}}
[[3337  144 6619]
 [3597  204 7739]
 [2719  166 7267]]
training model: results/XRAY/W8/deepOF_L1/h300
Epoch 1/50
327/327 - 10s - loss: 3.3438 - accuracy300: 0.3397 - val_loss: 3.3526 - val_accuracy300: 0.3209 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3138 - accuracy300: 0.3502 - val_loss: 3.3429 - val_accuracy300: 0.3205 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.3028 - accuracy300: 0.3556 - val_loss: 3.3391 - val_accuracy300: 0.3213 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.2979 - accuracy300: 0.3562 - val_loss: 3.3376 - val_accuracy300: 0.3230 - 8s/epoch - 23ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2934 - accuracy300: 0.3570 - val_loss: 3.3357 - val_accuracy300: 0.3225 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2916 - accuracy300: 0.3583 - val_loss: 3.3331 - val_accuracy300: 0.3251 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2887 - accuracy300: 0.3578 - val_loss: 3.3353 - val_accuracy300: 0.3249 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2879 - accuracy300: 0.3591 - val_loss: 3.3320 - val_accuracy300: 0.3267 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2846 - accuracy300: 0.3614 - val_loss: 3.3309 - val_accuracy300: 0.3285 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2851 - accuracy300: 0.3611 - val_loss: 3.3292 - val_accuracy300: 0.3278 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2815 - accuracy300: 0.3671 - val_loss: 3.3276 - val_accuracy300: 0.3279 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2806 - accuracy300: 0.3634 - val_loss: 3.3269 - val_accuracy300: 0.3283 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2792 - accuracy300: 0.3668 - val_loss: 3.3264 - val_accuracy300: 0.3268 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2777 - accuracy300: 0.3686 - val_loss: 3.3279 - val_accuracy300: 0.3261 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2762 - accuracy300: 0.3668 - val_loss: 3.3276 - val_accuracy300: 0.3283 - 8s/epoch - 24ms/step
Epoch 16/50
327/327 - 8s - loss: 3.2741 - accuracy300: 0.3700 - val_loss: 3.3254 - val_accuracy300: 0.3284 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.2734 - accuracy300: 0.3697 - val_loss: 3.3265 - val_accuracy300: 0.3257 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.2728 - accuracy300: 0.3715 - val_loss: 3.3256 - val_accuracy300: 0.3276 - 8s/epoch - 24ms/step
Epoch 19/50
327/327 - 8s - loss: 3.2700 - accuracy300: 0.3730 - val_loss: 3.3263 - val_accuracy300: 0.3277 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.2696 - accuracy300: 0.3738 - val_loss: 3.3255 - val_accuracy300: 0.3301 - 8s/epoch - 24ms/step
Epoch 21/50
327/327 - 8s - loss: 3.2660 - accuracy300: 0.3761 - val_loss: 3.3260 - val_accuracy300: 0.3287 - 8s/epoch - 24ms/step
Epoch 22/50
327/327 - 8s - loss: 3.2656 - accuracy300: 0.3781 - val_loss: 3.3265 - val_accuracy300: 0.3287 - 8s/epoch - 24ms/step
Epoch 23/50
327/327 - 8s - loss: 3.2633 - accuracy300: 0.3798 - val_loss: 3.3276 - val_accuracy300: 0.3277 - 8s/epoch - 24ms/step
Epoch 24/50
327/327 - 8s - loss: 3.2608 - accuracy300: 0.3805 - val_loss: 3.3298 - val_accuracy300: 0.3283 - 8s/epoch - 24ms/step
Epoch 25/50
327/327 - 7s - loss: 3.2610 - accuracy300: 0.3807 - val_loss: 3.3295 - val_accuracy300: 0.3295 - 7s/epoch - 23ms/step
Epoch 26/50
327/327 - 8s - loss: 3.2579 - accuracy300: 0.3831 - val_loss: 3.3282 - val_accuracy300: 0.3283 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h300
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137779
{'0': {'precision': 0.29409473504208544, 'recall': 0.392491727207029, 'f1-score': 0.33624243082520977, 'support': 78873}, '1': {'precision': 0.6875, 'recall': 0.06112638372315246, 'f1-score': 0.11227065923235813, 'support': 136046}, '2': {'precision': 0.2904553026096613, 'recall': 0.6337731254316141, 'f1-score': 0.3983490646857473, 'support': 82539}, 'accuracy': 0.30788884481170453, 'macro avg': {'precision': 0.4240166792172489, 'recall': 0.3624637454539319, 'f1-score': 0.28228738491443844, 'support': 297458}, 'weighted avg': {'precision': 0.4730134985748348, 'recall': 0.30788884481170453, 'f1-score': 0.2510396654401598, 'support': 297458}}
[[30957  1585 46331]
 [46272  8316 81458]
 [28033  2195 52311]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965081
{'0': {'precision': 0.37991773019723657, 'recall': 0.38167561458038995, 'f1-score': 0.3807946436437318, 'support': 28312}, '1': {'precision': 0.4537313432835821, 'recall': 0.02684848270745752, 'f1-score': 0.050697084917617236, 'support': 28307}, '2': {'precision': 0.344830166093072, 'recall': 0.6837518080332308, 'f1-score': 0.4584530070747386, 'support': 26963}, 'accuracy': 0.35895288459237634, 'macro avg': {'precision': 0.39282641319129685, 'recall': 0.3640919684403594, 'f1-score': 0.2966482452120292, 'support': 83582}, 'weighted avg': {'precision': 0.393597421454859, 'recall': 0.35895288459237634, 'f1-score': 0.2940514556167656, 'support': 83582}}
[[10806   470 17036]
 [ 9555   760 17992]
 [ 8082   445 18436]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101178
{'0': {'precision': 0.3319632706602536, 'recall': 0.38355057088006467, 'f1-score': 0.3558972435777236, 'support': 9897}, '1': {'precision': 0.3953488372093023, 'recall': 0.03403403403403404, 'f1-score': 0.06267281105990784, 'support': 11988}, '2': {'precision': 0.32294954721862873, 'recall': 0.6299586151206218, 'f1-score': 0.42699781061850023, 'support': 9907}, 'accuracy': 0.3285417715148465, 'macro avg': {'precision': 0.3500872183627282, 'recall': 0.34918107334490683, 'f1-score': 0.28185595508537725, 'support': 31792}, 'weighted avg': {'precision': 0.353055596202963, 'recall': 0.3285417715148465, 'f1-score': 0.26748565640640376, 'support': 31792}}
[[3796  300 5801]
 [4297  408 7283]
 [3342  324 6241]]
training model: results/XRAY/W8/deepOF_L1/h500
Epoch 1/50
327/327 - 10s - loss: 3.3445 - accuracy500: 0.3440 - val_loss: 3.3607 - val_accuracy500: 0.3091 - 10s/epoch - 30ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3173 - accuracy500: 0.3501 - val_loss: 3.3492 - val_accuracy500: 0.3116 - 8s/epoch - 24ms/step
Epoch 3/50
327/327 - 8s - loss: 3.3065 - accuracy500: 0.3545 - val_loss: 3.3488 - val_accuracy500: 0.3089 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.3017 - accuracy500: 0.3532 - val_loss: 3.3432 - val_accuracy500: 0.3110 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.2981 - accuracy500: 0.3544 - val_loss: 3.3402 - val_accuracy500: 0.3107 - 8s/epoch - 24ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2957 - accuracy500: 0.3555 - val_loss: 3.3371 - val_accuracy500: 0.3152 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2929 - accuracy500: 0.3566 - val_loss: 3.3380 - val_accuracy500: 0.3126 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2902 - accuracy500: 0.3594 - val_loss: 3.3348 - val_accuracy500: 0.3118 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2886 - accuracy500: 0.3586 - val_loss: 3.3340 - val_accuracy500: 0.3157 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2891 - accuracy500: 0.3571 - val_loss: 3.3320 - val_accuracy500: 0.3141 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2866 - accuracy500: 0.3603 - val_loss: 3.3298 - val_accuracy500: 0.3155 - 8s/epoch - 23ms/step
Epoch 12/50
327/327 - 7s - loss: 3.2849 - accuracy500: 0.3591 - val_loss: 3.3296 - val_accuracy500: 0.3141 - 7s/epoch - 23ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2851 - accuracy500: 0.3620 - val_loss: 3.3271 - val_accuracy500: 0.3147 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2836 - accuracy500: 0.3619 - val_loss: 3.3240 - val_accuracy500: 0.3165 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2815 - accuracy500: 0.3638 - val_loss: 3.3259 - val_accuracy500: 0.3149 - 8s/epoch - 24ms/step
Epoch 16/50
327/327 - 8s - loss: 3.2812 - accuracy500: 0.3637 - val_loss: 3.3254 - val_accuracy500: 0.3109 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.2795 - accuracy500: 0.3643 - val_loss: 3.3246 - val_accuracy500: 0.3139 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.2783 - accuracy500: 0.3654 - val_loss: 3.3225 - val_accuracy500: 0.3155 - 8s/epoch - 24ms/step
Epoch 19/50
327/327 - 8s - loss: 3.2764 - accuracy500: 0.3686 - val_loss: 3.3246 - val_accuracy500: 0.3152 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.2753 - accuracy500: 0.3698 - val_loss: 3.3228 - val_accuracy500: 0.3161 - 8s/epoch - 24ms/step
Epoch 21/50
327/327 - 8s - loss: 3.2729 - accuracy500: 0.3722 - val_loss: 3.3270 - val_accuracy500: 0.3136 - 8s/epoch - 24ms/step
Epoch 22/50
327/327 - 8s - loss: 3.2713 - accuracy500: 0.3702 - val_loss: 3.3271 - val_accuracy500: 0.3132 - 8s/epoch - 24ms/step
Epoch 23/50
327/327 - 8s - loss: 3.2713 - accuracy500: 0.3718 - val_loss: 3.3260 - val_accuracy500: 0.3158 - 8s/epoch - 24ms/step
Epoch 24/50
327/327 - 8s - loss: 3.2685 - accuracy500: 0.3721 - val_loss: 3.3280 - val_accuracy500: 0.3178 - 8s/epoch - 24ms/step
Epoch 25/50
327/327 - 8s - loss: 3.2670 - accuracy500: 0.3750 - val_loss: 3.3262 - val_accuracy500: 0.3160 - 8s/epoch - 24ms/step
Epoch 26/50
327/327 - 8s - loss: 3.2652 - accuracy500: 0.3760 - val_loss: 3.3302 - val_accuracy500: 0.3162 - 8s/epoch - 24ms/step
Epoch 27/50
327/327 - 8s - loss: 3.2623 - accuracy500: 0.3788 - val_loss: 3.3352 - val_accuracy500: 0.3135 - 8s/epoch - 24ms/step
Epoch 28/50
327/327 - 8s - loss: 3.2606 - accuracy500: 0.3808 - val_loss: 3.3349 - val_accuracy500: 0.3150 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h500
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1203355
{'0': {'precision': 0.2587306294950693, 'recall': 0.47536986077432364, 'f1-score': 0.33508421517601644, 'support': 73406}, '1': {'precision': 0.7047751574630146, 'recall': 0.06618385397323209, 'f1-score': 0.12100445137439327, 'support': 145398}, '2': {'precision': 0.2803456564652799, 'recall': 0.5308439494494877, 'f1-score': 0.3669174121658435, 'support': 78654}, 'accuracy': 0.2900274996806272, 'macro avg': {'precision': 0.41461714780778797, 'recall': 0.35746588806568114, 'f1-score': 0.2743353595720844, 'support': 297458}, 'weighted avg': {'precision': 0.48247344565331096, 'recall': 0.2900274996806272, 'f1-score': 0.23885899608226013, 'support': 297458}}
[[34895  1656 36855]
 [65449  9623 70326]
 [34526  2375 41753]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981153
{'0': {'precision': 0.36853427821190166, 'recall': 0.4146879783560571, 'f1-score': 0.390251256281407, 'support': 28091}, '1': {'precision': 0.4676524953789279, 'recall': 0.0349640685461581, 'f1-score': 0.06506364922206506, 'support': 28944}, '2': {'precision': 0.3427693790278865, 'recall': 0.6431235167815572, 'f1-score': 0.44719471947194717, 'support': 26547}, 'accuracy': 0.35574645258548493, 'macro avg': {'precision': 0.3929853842062387, 'recall': 0.3642585212279241, 'f1-score': 0.30083654165847307, 'support': 83582}, 'weighted avg': {'precision': 0.394675036976281, 'recall': 0.35574645258548493, 'f1-score': 0.2957266937989787, 'support': 83582}}
[[11649   611 15831]
 [11027  1012 16905]
 [ 8933   541 17073]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122072
{'0': {'precision': 0.3130875500694842, 'recall': 0.39399238761444294, 'f1-score': 0.3489113601166074, 'support': 9721}, '1': {'precision': 0.4077506318449874, 'recall': 0.03893178893178893, 'f1-score': 0.0710771715985021, 'support': 12432}, '2': {'precision': 0.31166993250598735, 'recall': 0.5940450254175744, 'f1-score': 0.408839384527507, 'support': 9639}, 'accuracy': 0.3158027176648213, 'macro avg': {'precision': 0.3441693714734863, 'recall': 0.34232306732126877, 'f1-score': 0.2762759720808722, 'support': 31792}, 'weighted avg': {'precision': 0.34967496252980473, 'recall': 0.3158027176648213, 'f1-score': 0.2584361335073842, 'support': 31792}}
[[3830  341 5550]
 [4852  484 7096]
 [3551  362 5726]]
training model: results/XRAY/W8/deepOF_L1/h1000
Epoch 1/50
327/327 - 10s - loss: 3.3490 - accuracy1000: 0.3445 - val_loss: 3.4016 - val_accuracy1000: 0.3090 - 10s/epoch - 32ms/step
Epoch 2/50
327/327 - 8s - loss: 3.3217 - accuracy1000: 0.3487 - val_loss: 3.3956 - val_accuracy1000: 0.3052 - 8s/epoch - 23ms/step
Epoch 3/50
327/327 - 8s - loss: 3.3112 - accuracy1000: 0.3522 - val_loss: 3.3889 - val_accuracy1000: 0.3065 - 8s/epoch - 24ms/step
Epoch 4/50
327/327 - 8s - loss: 3.3043 - accuracy1000: 0.3529 - val_loss: 3.3837 - val_accuracy1000: 0.3089 - 8s/epoch - 24ms/step
Epoch 5/50
327/327 - 8s - loss: 3.3003 - accuracy1000: 0.3516 - val_loss: 3.3738 - val_accuracy1000: 0.3107 - 8s/epoch - 25ms/step
Epoch 6/50
327/327 - 8s - loss: 3.2979 - accuracy1000: 0.3521 - val_loss: 3.3697 - val_accuracy1000: 0.3106 - 8s/epoch - 24ms/step
Epoch 7/50
327/327 - 8s - loss: 3.2971 - accuracy1000: 0.3522 - val_loss: 3.3652 - val_accuracy1000: 0.3084 - 8s/epoch - 24ms/step
Epoch 8/50
327/327 - 8s - loss: 3.2945 - accuracy1000: 0.3552 - val_loss: 3.3595 - val_accuracy1000: 0.3102 - 8s/epoch - 24ms/step
Epoch 9/50
327/327 - 8s - loss: 3.2931 - accuracy1000: 0.3533 - val_loss: 3.3573 - val_accuracy1000: 0.3128 - 8s/epoch - 24ms/step
Epoch 10/50
327/327 - 8s - loss: 3.2927 - accuracy1000: 0.3525 - val_loss: 3.3508 - val_accuracy1000: 0.3122 - 8s/epoch - 24ms/step
Epoch 11/50
327/327 - 8s - loss: 3.2910 - accuracy1000: 0.3564 - val_loss: 3.3475 - val_accuracy1000: 0.3161 - 8s/epoch - 24ms/step
Epoch 12/50
327/327 - 8s - loss: 3.2889 - accuracy1000: 0.3575 - val_loss: 3.3459 - val_accuracy1000: 0.3182 - 8s/epoch - 24ms/step
Epoch 13/50
327/327 - 8s - loss: 3.2875 - accuracy1000: 0.3578 - val_loss: 3.3459 - val_accuracy1000: 0.3136 - 8s/epoch - 24ms/step
Epoch 14/50
327/327 - 8s - loss: 3.2868 - accuracy1000: 0.3605 - val_loss: 3.3445 - val_accuracy1000: 0.3175 - 8s/epoch - 24ms/step
Epoch 15/50
327/327 - 8s - loss: 3.2849 - accuracy1000: 0.3608 - val_loss: 3.3448 - val_accuracy1000: 0.3167 - 8s/epoch - 24ms/step
Epoch 16/50
327/327 - 8s - loss: 3.2836 - accuracy1000: 0.3614 - val_loss: 3.3434 - val_accuracy1000: 0.3217 - 8s/epoch - 24ms/step
Epoch 17/50
327/327 - 8s - loss: 3.2830 - accuracy1000: 0.3629 - val_loss: 3.3448 - val_accuracy1000: 0.3155 - 8s/epoch - 24ms/step
Epoch 18/50
327/327 - 8s - loss: 3.2811 - accuracy1000: 0.3636 - val_loss: 3.3463 - val_accuracy1000: 0.3171 - 8s/epoch - 24ms/step
Epoch 19/50
327/327 - 8s - loss: 3.2806 - accuracy1000: 0.3634 - val_loss: 3.3485 - val_accuracy1000: 0.3177 - 8s/epoch - 24ms/step
Epoch 20/50
327/327 - 8s - loss: 3.2791 - accuracy1000: 0.3668 - val_loss: 3.3460 - val_accuracy1000: 0.3184 - 8s/epoch - 24ms/step
Epoch 21/50
327/327 - 8s - loss: 3.2758 - accuracy1000: 0.3686 - val_loss: 3.3487 - val_accuracy1000: 0.3203 - 8s/epoch - 25ms/step
Epoch 22/50
327/327 - 8s - loss: 3.2747 - accuracy1000: 0.3684 - val_loss: 3.3467 - val_accuracy1000: 0.3222 - 8s/epoch - 24ms/step
Epoch 23/50
327/327 - 8s - loss: 3.2733 - accuracy1000: 0.3710 - val_loss: 3.3517 - val_accuracy1000: 0.3166 - 8s/epoch - 24ms/step
Epoch 24/50
327/327 - 8s - loss: 3.2718 - accuracy1000: 0.3733 - val_loss: 3.3509 - val_accuracy1000: 0.3209 - 8s/epoch - 24ms/step
Epoch 25/50
327/327 - 8s - loss: 3.2701 - accuracy1000: 0.3735 - val_loss: 3.3531 - val_accuracy1000: 0.3168 - 8s/epoch - 24ms/step
Epoch 26/50
327/327 - 8s - loss: 3.2698 - accuracy1000: 0.3738 - val_loss: 3.3508 - val_accuracy1000: 0.3201 - 8s/epoch - 24ms/step
testing model: results/XRAY/W8/deepOF_L1/h1000
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1103473
{'0': {'precision': 0.26176727129186905, 'recall': 0.5643323816844186, 'f1-score': 0.35764147127516605, 'support': 72856}, '1': {'precision': 0.6892225276661733, 'recall': 0.13332969715150605, 'f1-score': 0.22343585759334583, 'support': 146674}, '2': {'precision': 0.27060178365783766, 'recall': 0.38897443794271636, 'f1-score': 0.3191660743899549, 'support': 77928}, 'accuracy': 0.30586839150401063, 'macro avg': {'precision': 0.4071971942052934, 'recall': 0.36221217225954705, 'f1-score': 0.3000811344194889, 'support': 297458}, 'weighted avg': {'precision': 0.4748562726066762, 'recall': 0.30586839150401063, 'f1-score': 0.2813860506455712, 'support': 297458}}
[[41115  3789 27952]
 [73365 19556 53753]
 [42587  5029 30312]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939908
{'0': {'precision': 0.37898721753557824, 'recall': 0.5439543853764883, 'f1-score': 0.44672763331864257, 'support': 29815}, '1': {'precision': 0.4282810029365259, 'recall': 0.06989604069896041, 'f1-score': 0.12017874687034513, 'support': 27126}, '2': {'precision': 0.34626808206369286, 'recall': 0.47261739424195787, 'f1-score': 0.3996952526070187, 'support': 26641}, 'accuracy': 0.36736378646119977, 'macro avg': {'precision': 0.38451210084526566, 'recall': 0.36215594010580215, 'f1-score': 0.3222005442653355, 'support': 83582}, 'weighted avg': {'precision': 0.3845562722923393, 'recall': 0.36736378646119977, 'f1-score': 0.3257571522541205, 'support': 83582}}
[[16218  1373 12224]
 [13683  1896 11547]
 [12892  1158 12591]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088556
{'0': {'precision': 0.31050456992612996, 'recall': 0.5118150861624188, 'f1-score': 0.3865186051042276, 'support': 9691}, '1': {'precision': 0.4323126510878324, 'recall': 0.08442835785663703, 'f1-score': 0.14126785596734912, 'support': 12709}, '2': {'precision': 0.3027894421115777, 'recall': 0.4299403747870528, 'f1-score': 0.3553326293558607, 'support': 9392}, 'accuracy': 0.3167778057372924, 'macro avg': {'precision': 0.34853555437518, 'recall': 0.3420612729353696, 'f1-score': 0.2943730301424791, 'support': 31792}, 'weighted avg': {'precision': 0.3569187125736451, 'recall': 0.3167778057372924, 'f1-score': 0.2792655082556729, 'support': 31792}}
[[4960  729 4002]
 [6340 1073 5296]
 [4674  680 4038]]
training model: results/XRAY/W8/deepLOB_L2/h10
Epoch 1/50
327/327 - 19s - loss: 3.3295 - accuracy10: 0.3642 - val_loss: 3.3424 - val_accuracy10: 0.3547 - 19s/epoch - 59ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2555 - accuracy10: 0.3959 - val_loss: 3.3171 - val_accuracy10: 0.3686 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.1982 - accuracy10: 0.4245 - val_loss: 3.2035 - val_accuracy10: 0.4106 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.1616 - accuracy10: 0.4401 - val_loss: 3.1754 - val_accuracy10: 0.4300 - 16s/epoch - 50ms/step
Epoch 5/50
327/327 - 17s - loss: 3.1336 - accuracy10: 0.4504 - val_loss: 3.1672 - val_accuracy10: 0.4378 - 17s/epoch - 51ms/step
Epoch 6/50
327/327 - 16s - loss: 3.1150 - accuracy10: 0.4578 - val_loss: 3.1834 - val_accuracy10: 0.4316 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.0945 - accuracy10: 0.4643 - val_loss: 3.2094 - val_accuracy10: 0.4317 - 16s/epoch - 50ms/step
Epoch 8/50
327/327 - 16s - loss: 3.0815 - accuracy10: 0.4683 - val_loss: 3.2094 - val_accuracy10: 0.4351 - 16s/epoch - 50ms/step
Epoch 9/50
327/327 - 16s - loss: 3.0707 - accuracy10: 0.4734 - val_loss: 3.2226 - val_accuracy10: 0.4282 - 16s/epoch - 50ms/step
Epoch 10/50
327/327 - 16s - loss: 3.0599 - accuracy10: 0.4766 - val_loss: 3.2372 - val_accuracy10: 0.4263 - 16s/epoch - 50ms/step
Epoch 11/50
327/327 - 16s - loss: 3.0541 - accuracy10: 0.4769 - val_loss: 3.2295 - val_accuracy10: 0.4301 - 16s/epoch - 50ms/step
Epoch 12/50
327/327 - 16s - loss: 3.0416 - accuracy10: 0.4822 - val_loss: 3.2082 - val_accuracy10: 0.4380 - 16s/epoch - 50ms/step
Epoch 13/50
327/327 - 16s - loss: 3.0353 - accuracy10: 0.4835 - val_loss: 3.2434 - val_accuracy10: 0.4343 - 16s/epoch - 50ms/step
Epoch 14/50
327/327 - 16s - loss: 3.0262 - accuracy10: 0.4854 - val_loss: 3.2475 - val_accuracy10: 0.4361 - 16s/epoch - 50ms/step
Epoch 15/50
327/327 - 16s - loss: 3.0194 - accuracy10: 0.4879 - val_loss: 3.2294 - val_accuracy10: 0.4363 - 16s/epoch - 50ms/step
testing model: results/XRAY/W8/deepLOB_L2/h10
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0364069
{'0': {'precision': 0.37821934083616326, 'recall': 0.5316667105020909, 'f1-score': 0.44200399048842487, 'support': 76042}, '1': {'precision': 0.5475722444936307, 'recall': 0.4828207420347611, 'f1-score': 0.5131619505579188, 'support': 146543}, '2': {'precision': 0.32987808853249884, 'recall': 0.27030636502043326, 'f1-score': 0.29713581044379517, 'support': 74878}, 'accuracy': 0.44181293135616867, 'macro avg': {'precision': 0.4185565579540976, 'recall': 0.42826460585242837, 'f1-score': 0.41743391716337963, 'support': 297463}, 'weighted avg': {'precision': 0.449481266758656, 'recall': 0.44181293135616867, 'f1-score': 0.44059292880035633, 'support': 297463}}
[[40429 26818  8795]
 [43468 70754 32321]
 [22996 31642 20240]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0592526
{'0': {'precision': 0.43119107343655394, 'recall': 0.5395021645021645, 'f1-score': 0.47930387962117205, 'support': 27720}, '1': {'precision': 0.4291174663845471, 'recall': 0.4516360762903631, 'f1-score': 0.4400888997777505, 'support': 27841}, '2': {'precision': 0.459968362504465, 'recall': 0.3216873059491096, 'f1-score': 0.3785963291192406, 'support': 28021}, 'accuracy': 0.4372113612978871, 'macro avg': {'precision': 0.4400923007751887, 'recall': 0.43760851558054575, 'f1-score': 0.43266303617272106, 'support': 83582}, 'weighted avg': {'precision': 0.44014799146958755, 'recall': 0.4372113612978871, 'f1-score': 0.4324790785104626, 'support': 83582}}
[[14955  7928  4837]
 [ 9521 12574  5746]
 [10207  8800  9014]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0555149
{'0': {'precision': 0.4313470096602627, 'recall': 0.4062979245475923, 'f1-score': 0.4184479309255555, 'support': 9781}, '1': {'precision': 0.4398130362402356, 'recall': 0.5713691565463317, 'f1-score': 0.49703328509406647, 'support': 12022}, '2': {'precision': 0.4440453957764689, 'recall': 0.30944038442286514, 'f1-score': 0.36471976401179945, 'support': 9989}, 'accuracy': 0.438286361348767, 'macro avg': {'precision': 0.4384018138923224, 'recall': 0.4290358218389297, 'f1-score': 0.4267336600104738, 'support': 31792}, 'weighted avg': {'precision': 0.4385382134366599, 'recall': 0.438286361348767, 'f1-score': 0.4312833130503771, 'support': 31792}}
[[3974 4124 1683]
 [2966 6869 2187]
 [2273 4625 3091]]
training model: results/XRAY/W8/deepLOB_L2/h20
Epoch 1/50
327/327 - 19s - loss: 3.3269 - accuracy20: 0.3610 - val_loss: 3.3666 - val_accuracy20: 0.3686 - 19s/epoch - 57ms/step
Epoch 2/50
327/327 - 17s - loss: 3.2604 - accuracy20: 0.3939 - val_loss: 3.2612 - val_accuracy20: 0.3833 - 17s/epoch - 51ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2042 - accuracy20: 0.4213 - val_loss: 3.2476 - val_accuracy20: 0.3966 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.1781 - accuracy20: 0.4331 - val_loss: 3.2551 - val_accuracy20: 0.3990 - 16s/epoch - 50ms/step
Epoch 5/50
327/327 - 16s - loss: 3.1614 - accuracy20: 0.4394 - val_loss: 3.2249 - val_accuracy20: 0.4028 - 16s/epoch - 50ms/step
Epoch 6/50
327/327 - 16s - loss: 3.1477 - accuracy20: 0.4447 - val_loss: 3.2215 - val_accuracy20: 0.4101 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.1343 - accuracy20: 0.4494 - val_loss: 3.2400 - val_accuracy20: 0.4113 - 16s/epoch - 50ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1268 - accuracy20: 0.4521 - val_loss: 3.2306 - val_accuracy20: 0.4197 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1187 - accuracy20: 0.4535 - val_loss: 3.2229 - val_accuracy20: 0.4218 - 16s/epoch - 49ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1131 - accuracy20: 0.4570 - val_loss: 3.2344 - val_accuracy20: 0.4240 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1060 - accuracy20: 0.4596 - val_loss: 3.2253 - val_accuracy20: 0.4271 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.0989 - accuracy20: 0.4613 - val_loss: 3.2362 - val_accuracy20: 0.4271 - 16s/epoch - 49ms/step
Epoch 13/50
327/327 - 16s - loss: 3.0924 - accuracy20: 0.4643 - val_loss: 3.2292 - val_accuracy20: 0.4266 - 16s/epoch - 49ms/step
Epoch 14/50
327/327 - 16s - loss: 3.0837 - accuracy20: 0.4683 - val_loss: 3.2282 - val_accuracy20: 0.4317 - 16s/epoch - 49ms/step
Epoch 15/50
327/327 - 16s - loss: 3.0757 - accuracy20: 0.4697 - val_loss: 3.2483 - val_accuracy20: 0.4263 - 16s/epoch - 50ms/step
Epoch 16/50
327/327 - 16s - loss: 3.0710 - accuracy20: 0.4711 - val_loss: 3.2520 - val_accuracy20: 0.4314 - 16s/epoch - 50ms/step
testing model: results/XRAY/W8/deepLOB_L2/h20
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.038513
{'0': {'precision': 0.3741040075804024, 'recall': 0.43788410600347083, 'f1-score': 0.40348915500408794, 'support': 76639}, '1': {'precision': 0.514067923059457, 'recall': 0.5460565758191779, 'f1-score': 0.5295796297533917, 'support': 145115}, '2': {'precision': 0.3169194038759256, 'recall': 0.22442510137500166, 'f1-score': 0.26277044895686735, 'support': 75709}, 'accuracy': 0.43632653472868893, 'macro avg': {'precision': 0.40169711150526166, 'recall': 0.4027885943992168, 'f1-score': 0.39861307790478234, 'support': 297463}, 'weighted avg': {'precision': 0.4278299312511809, 'recall': 0.43632653472868893, 'f1-score': 0.4291862895287723, 'support': 297463}}
[[33559 35879  7201]
 [36453 79241 29421]
 [19693 39025 16991]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0711157
{'0': {'precision': 0.436393848056264, 'recall': 0.40696962052686586, 'f1-score': 0.42116844127025566, 'support': 27749}, '1': {'precision': 0.38868110930774113, 'recall': 0.5928105044127143, 'f1-score': 0.4695185190447099, 'support': 27874}, '2': {'precision': 0.4656046343229544, 'recall': 0.25297757430523266, 'f1-score': 0.3278331402085748, 'support': 27959}, 'accuracy': 0.4174343758225455, 'macro avg': {'precision': 0.43022653056231985, 'recall': 0.41758589974827093, 'f1-score': 0.40617336684118016, 'support': 83582}, 'weighted avg': {'precision': 0.4302532854154332, 'recall': 0.4174343758225455, 'f1-score': 0.40607127184982544, 'support': 83582}}
[[11293 12750  3706]
 [ 6938 16524  4412]
 [ 7647 13239  7073]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0732704
{'0': {'precision': 0.40709459459459457, 'recall': 0.3188479544066762, 'f1-score': 0.35760757904348817, 'support': 9826}, '1': {'precision': 0.4007647582630559, 'recall': 0.6395552954944412, 'f1-score': 0.4927545565788627, 'support': 11963}, '2': {'precision': 0.44215784215784215, 'recall': 0.22123362991102669, 'f1-score': 0.294909381663113, 'support': 10003}, 'accuracy': 0.4088135379969804, 'macro avg': {'precision': 0.4166723983384976, 'recall': 0.3932122932707147, 'f1-score': 0.381757172428488, 'support': 31792}, 'weighted avg': {'precision': 0.4157450045512179, 'recall': 0.4088135379969804, 'f1-score': 0.3887346935332904, 'support': 31792}}
[[3133 5563 1130]
 [2650 7651 1662]
 [1913 5877 2213]]
training model: results/XRAY/W8/deepLOB_L2/h30
Epoch 1/50
327/327 - 18s - loss: 3.3344 - accuracy30: 0.3551 - val_loss: 3.3588 - val_accuracy30: 0.3488 - 18s/epoch - 56ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2845 - accuracy30: 0.3758 - val_loss: 3.3351 - val_accuracy30: 0.3521 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2509 - accuracy30: 0.3914 - val_loss: 3.2787 - val_accuracy30: 0.3734 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2191 - accuracy30: 0.4111 - val_loss: 3.2891 - val_accuracy30: 0.3680 - 16s/epoch - 49ms/step
Epoch 5/50
327/327 - 16s - loss: 3.1968 - accuracy30: 0.4244 - val_loss: 3.2915 - val_accuracy30: 0.3720 - 16s/epoch - 50ms/step
Epoch 6/50
327/327 - 16s - loss: 3.1810 - accuracy30: 0.4289 - val_loss: 3.2781 - val_accuracy30: 0.3771 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.1685 - accuracy30: 0.4353 - val_loss: 3.2694 - val_accuracy30: 0.3950 - 16s/epoch - 50ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1594 - accuracy30: 0.4384 - val_loss: 3.3081 - val_accuracy30: 0.3811 - 16s/epoch - 50ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1474 - accuracy30: 0.4461 - val_loss: 3.3093 - val_accuracy30: 0.3888 - 16s/epoch - 50ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1422 - accuracy30: 0.4476 - val_loss: 3.2910 - val_accuracy30: 0.3927 - 16s/epoch - 50ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1325 - accuracy30: 0.4523 - val_loss: 3.3082 - val_accuracy30: 0.3905 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1234 - accuracy30: 0.4546 - val_loss: 3.3184 - val_accuracy30: 0.3915 - 16s/epoch - 49ms/step
Epoch 13/50
327/327 - 16s - loss: 3.1151 - accuracy30: 0.4582 - val_loss: 3.3191 - val_accuracy30: 0.3931 - 16s/epoch - 50ms/step
Epoch 14/50
327/327 - 16s - loss: 3.1075 - accuracy30: 0.4597 - val_loss: 3.3229 - val_accuracy30: 0.3889 - 16s/epoch - 50ms/step
Epoch 15/50
327/327 - 16s - loss: 3.1019 - accuracy30: 0.4608 - val_loss: 3.3657 - val_accuracy30: 0.3847 - 16s/epoch - 50ms/step
Epoch 16/50
327/327 - 16s - loss: 3.0907 - accuracy30: 0.4665 - val_loss: 3.3548 - val_accuracy30: 0.3922 - 16s/epoch - 49ms/step
Epoch 17/50
327/327 - 16s - loss: 3.0841 - accuracy30: 0.4676 - val_loss: 3.3840 - val_accuracy30: 0.3916 - 16s/epoch - 49ms/step
testing model: results/XRAY/W8/deepLOB_L2/h30
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0583304
{'0': {'precision': 0.3424883413479, 'recall': 0.5952104425985305, 'f1-score': 0.4347934341571376, 'support': 79214}, '1': {'precision': 0.5081041482250237, 'recall': 0.47844675821135757, 'f1-score': 0.4928296775482863, 'support': 139167}, '2': {'precision': 0.33530414217646853, 'recall': 0.12191143370172731, 'f1-score': 0.17881021931654842, 'support': 79082}, 'accuracy': 0.41475410387174205, 'macro avg': {'precision': 0.39529887724979745, 'recall': 0.3985228781705385, 'f1-score': 0.36881111034065744, 'support': 297463}, 'weighted avg': {'precision': 0.41806114924936516, 'recall': 0.41475410387174205, 'f1-score': 0.393891087606449, 'support': 297463}}
[[47149 28345  3720]
 [57191 66584 15392]
 [33326 36115  9641]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0881538
{'0': {'precision': 0.4109431849986006, 'recall': 0.5213763227043534, 'f1-score': 0.45961935766606143, 'support': 28162}, '1': {'precision': 0.37934327687424513, 'recall': 0.4984314449160362, 'f1-score': 0.4308089830292204, 'support': 27095}, '2': {'precision': 0.4571871683944168, 'recall': 0.1977405119152692, 'f1-score': 0.27607452681388017, 'support': 28325}, 'accuracy': 0.40426168313751765, 'macro avg': {'precision': 0.41582454342242087, 'recall': 0.4058494265118863, 'f1-score': 0.3888342891697207, 'support': 83582}, 'weighted avg': {'precision': 0.4163709244527544, 'recall': 0.40426168313751765, 'f1-score': 0.38807854224320437, 'support': 83582}}
[[14683 10394  3085]
 [10025 13505  3565]
 [11022 11702  5601]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918839
{'0': {'precision': 0.38379859564994007, 'recall': 0.4441141498216409, 'f1-score': 0.41175930179145614, 'support': 10092}, '1': {'precision': 0.3893454738958198, 'recall': 0.571465764123926, 'f1-score': 0.4631453087635392, 'support': 11523}, '2': {'precision': 0.4739144017494533, 'recall': 0.1490616095116439, 'f1-score': 0.2267902526536104, 'support': 10177}, 'accuracy': 0.39582284851534977, 'macro avg': {'precision': 0.41568615709840434, 'recall': 0.38821384115240365, 'f1-score': 0.3672316210695352, 'support': 31792}, 'weighted avg': {'precision': 0.4146562087822381, 'recall': 0.39582284851534977, 'f1-score': 0.3711733350471008, 'support': 31792}}
[[4482 4847  763]
 [4017 6585  921]
 [3179 5481 1517]]
training model: results/XRAY/W8/deepLOB_L2/h50
Epoch 1/50
327/327 - 19s - loss: 3.3374 - accuracy50: 0.3553 - val_loss: 3.3700 - val_accuracy50: 0.3463 - 19s/epoch - 58ms/step
Epoch 2/50
327/327 - 16s - loss: 3.3033 - accuracy50: 0.3638 - val_loss: 3.3767 - val_accuracy50: 0.3470 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2745 - accuracy50: 0.3833 - val_loss: 3.3487 - val_accuracy50: 0.3468 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2556 - accuracy50: 0.3914 - val_loss: 3.3148 - val_accuracy50: 0.3535 - 16s/epoch - 50ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2318 - accuracy50: 0.4030 - val_loss: 3.3210 - val_accuracy50: 0.3538 - 16s/epoch - 50ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2201 - accuracy50: 0.4082 - val_loss: 3.3105 - val_accuracy50: 0.3638 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.2057 - accuracy50: 0.4174 - val_loss: 3.3027 - val_accuracy50: 0.3669 - 16s/epoch - 50ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1957 - accuracy50: 0.4242 - val_loss: 3.3062 - val_accuracy50: 0.3647 - 16s/epoch - 50ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1842 - accuracy50: 0.4273 - val_loss: 3.3095 - val_accuracy50: 0.3747 - 16s/epoch - 50ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1744 - accuracy50: 0.4317 - val_loss: 3.3238 - val_accuracy50: 0.3716 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1637 - accuracy50: 0.4355 - val_loss: 3.3237 - val_accuracy50: 0.3723 - 16s/epoch - 50ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1553 - accuracy50: 0.4388 - val_loss: 3.3463 - val_accuracy50: 0.3678 - 16s/epoch - 50ms/step
Epoch 13/50
327/327 - 16s - loss: 3.1477 - accuracy50: 0.4419 - val_loss: 3.3396 - val_accuracy50: 0.3741 - 16s/epoch - 50ms/step
Epoch 14/50
327/327 - 16s - loss: 3.1369 - accuracy50: 0.4466 - val_loss: 3.3494 - val_accuracy50: 0.3774 - 16s/epoch - 50ms/step
Epoch 15/50
327/327 - 16s - loss: 3.1269 - accuracy50: 0.4515 - val_loss: 3.3929 - val_accuracy50: 0.3675 - 16s/epoch - 49ms/step
Epoch 16/50
327/327 - 16s - loss: 3.1189 - accuracy50: 0.4563 - val_loss: 3.3876 - val_accuracy50: 0.3748 - 16s/epoch - 50ms/step
Epoch 17/50
327/327 - 16s - loss: 3.1122 - accuracy50: 0.4566 - val_loss: 3.4095 - val_accuracy50: 0.3741 - 16s/epoch - 50ms/step
testing model: results/XRAY/W8/deepLOB_L2/h50
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0968897
{'0': {'precision': 0.2890185769806432, 'recall': 0.5895906297707475, 'f1-score': 0.38789178057333845, 'support': 77949}, '1': {'precision': 0.5134626201364604, 'recall': 0.29856094647630965, 'f1-score': 0.3775749674054759, 'support': 140648}, '2': {'precision': 0.304233504508797, 'recall': 0.2185986356604874, 'f1-score': 0.25440298672647993, 'support': 78866}, 'accuracy': 0.3536238120371273, 'macro avg': {'precision': 0.36890490054196684, 'recall': 0.36891673730251484, 'f1-score': 0.3399565782350981, 'support': 297463}, 'weighted avg': {'precision': 0.39917528976917405, 'recall': 0.3536238120371273, 'f1-score': 0.3476220113786491, 'support': 297463}}
[[45958 20074 11917]
 [71146 41992 27510]
 [41910 19716 17240]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087416
{'0': {'precision': 0.37630937479412346, 'recall': 0.4086713887100236, 'f1-score': 0.3918232953765949, 'support': 27954}, '1': {'precision': 0.38723660064544707, 'recall': 0.44017263082179464, 'f1-score': 0.4120112437090775, 'support': 27805}, '2': {'precision': 0.39536497363308354, 'recall': 0.30719189160047444, 'f1-score': 0.34574543395157864, 'support': 27823}, 'accuracy': 0.38537005575363115, 'macro avg': {'precision': 0.3863036496908847, 'recall': 0.3853453037107643, 'f1-score': 0.3831933243457503, 'support': 83582}, 'weighted avg': {'precision': 0.3862877845150256, 'recall': 0.38537005575363115, 'f1-score': 0.38320064414734045, 'support': 83582}}
[[11424 10010  6520]
 [ 9015 12239  6551]
 [ 9919  9357  8547]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996866
{'0': {'precision': 0.33952630832506026, 'recall': 0.47741549506431347, 'f1-score': 0.39683394803364963, 'support': 10029}, '1': {'precision': 0.3950324799388613, 'recall': 0.4473001038421599, 'f1-score': 0.41954466133679647, 'support': 11556}, '2': {'precision': 0.3958740499457112, 'recall': 0.1786029195650044, 'f1-score': 0.24615176883607884, 'support': 10207}, 'accuracy': 0.3705334675390035, 'macro avg': {'precision': 0.3768109460698776, 'recall': 0.3677728394904926, 'f1-score': 0.35417679273550834, 'support': 31792}, 'weighted avg': {'precision': 0.37779287594870986, 'recall': 0.3705334675390035, 'f1-score': 0.3567116531123348, 'support': 31792}}
[[4788 3833 1408]
 [5013 5169 1374]
 [4301 4083 1823]]
training model: results/XRAY/W8/deepLOB_L2/h100
Epoch 1/50
327/327 - 18s - loss: 3.3445 - accuracy100: 0.3518 - val_loss: 3.2852 - val_accuracy100: 0.3768 - 18s/epoch - 57ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2964 - accuracy100: 0.3715 - val_loss: 3.3142 - val_accuracy100: 0.3671 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2738 - accuracy100: 0.3836 - val_loss: 3.3372 - val_accuracy100: 0.3797 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2533 - accuracy100: 0.3942 - val_loss: 3.3814 - val_accuracy100: 0.3809 - 16s/epoch - 50ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2416 - accuracy100: 0.4012 - val_loss: 3.3325 - val_accuracy100: 0.3904 - 16s/epoch - 50ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2205 - accuracy100: 0.4112 - val_loss: 3.3855 - val_accuracy100: 0.3895 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.2060 - accuracy100: 0.4195 - val_loss: 3.4197 - val_accuracy100: 0.3946 - 16s/epoch - 49ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1940 - accuracy100: 0.4243 - val_loss: 3.3924 - val_accuracy100: 0.3838 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1846 - accuracy100: 0.4298 - val_loss: 3.4195 - val_accuracy100: 0.3804 - 16s/epoch - 50ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1721 - accuracy100: 0.4332 - val_loss: 3.3712 - val_accuracy100: 0.3954 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1641 - accuracy100: 0.4378 - val_loss: 3.4381 - val_accuracy100: 0.3908 - 16s/epoch - 50ms/step
testing model: results/XRAY/W8/deepLOB_L2/h100
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0849158
{'0': {'precision': 0.23420178352858892, 'recall': 0.4112120839985263, 'f1-score': 0.29843363561417974, 'support': 65144}, '1': {'precision': 0.5938644574041165, 'recall': 0.43460209302609565, 'f1-score': 0.5019020522420948, 'support': 163782}, '2': {'precision': 0.2521036315323295, 'recall': 0.23256051475845163, 'f1-score': 0.24193805450778305, 'support': 68537}, 'accuracy': 0.3829282969646645, 'macro avg': {'precision': 0.36005662415501166, 'recall': 0.3594582305943579, 'f1-score': 0.3474245807880192, 'support': 297463}, 'weighted avg': {'precision': 0.43635536568608085, 'recall': 0.3829282969646645, 'f1-score': 0.39744570289604025, 'support': 297463}}
[[26788 24122 14234]
 [59551 71180 33051]
 [28041 24557 15939]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211679
{'0': {'precision': 0.3533865357069777, 'recall': 0.36773369295194835, 'f1-score': 0.36041739130434786, 'support': 28178}, '1': {'precision': 0.3436936311918968, 'recall': 0.4490247262707563, 'f1-score': 0.38936133423456, 'support': 27582}, '2': {'precision': 0.3375582990397805, 'recall': 0.2211199769966214, 'f1-score': 0.2672052468130388, 'support': 27822}, 'accuracy': 0.34575626331028214, 'macro avg': {'precision': 0.3448794886462183, 'recall': 0.345959465406442, 'f1-score': 0.3389946574506489, 'support': 83582}, 'weighted avg': {'precision': 0.34491912773768146, 'recall': 0.34575626331028214, 'f1-score': 0.3389412786229561, 'support': 83582}}
[[10362 11966  5850]
 [ 8974 12385  6223]
 [ 9986 11684  6152]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963454
{'0': {'precision': 0.3204903677758319, 'recall': 0.3651927318558975, 'f1-score': 0.3413843888070693, 'support': 9521}, '1': {'precision': 0.4324163075903215, 'recall': 0.5146351084812624, 'f1-score': 0.46995677233429395, 'support': 12675}, '2': {'precision': 0.33407306247866164, 'recall': 0.2039391413088787, 'f1-score': 0.2532677623916138, 'support': 9596}, 'accuracy': 0.3761009058882738, 'macro avg': {'precision': 0.362326579281605, 'recall': 0.36125566054867947, 'f1-score': 0.354869641177659, 'support': 31792}, 'weighted avg': {'precision': 0.3692133429116211, 'recall': 0.3761009058882738, 'f1-score': 0.3660474428497486, 'support': 31792}}
[[3477 4291 1753]
 [4004 6523 2148]
 [3368 4271 1957]]
training model: results/XRAY/W8/deepLOB_L2/h200
Epoch 1/50
327/327 - 18s - loss: 3.3327 - accuracy200: 0.3617 - val_loss: 3.3499 - val_accuracy200: 0.3500 - 18s/epoch - 56ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2893 - accuracy200: 0.3834 - val_loss: 3.3357 - val_accuracy200: 0.3604 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2655 - accuracy200: 0.3916 - val_loss: 3.3454 - val_accuracy200: 0.3637 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2537 - accuracy200: 0.3952 - val_loss: 3.3792 - val_accuracy200: 0.3507 - 16s/epoch - 50ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2405 - accuracy200: 0.4029 - val_loss: 3.3936 - val_accuracy200: 0.3474 - 16s/epoch - 49ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2273 - accuracy200: 0.4080 - val_loss: 3.3688 - val_accuracy200: 0.3556 - 16s/epoch - 49ms/step
Epoch 7/50
327/327 - 16s - loss: 3.2096 - accuracy200: 0.4191 - val_loss: 3.3978 - val_accuracy200: 0.3537 - 16s/epoch - 50ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1993 - accuracy200: 0.4237 - val_loss: 3.4058 - val_accuracy200: 0.3493 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1852 - accuracy200: 0.4303 - val_loss: 3.4371 - val_accuracy200: 0.3510 - 16s/epoch - 49ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1728 - accuracy200: 0.4344 - val_loss: 3.4464 - val_accuracy200: 0.3544 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1640 - accuracy200: 0.4383 - val_loss: 3.4709 - val_accuracy200: 0.3500 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1523 - accuracy200: 0.4439 - val_loss: 3.4769 - val_accuracy200: 0.3520 - 16s/epoch - 49ms/step
testing model: results/XRAY/W8/deepLOB_L2/h200
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012639
{'0': {'precision': 0.26432097405653293, 'recall': 0.338466272614209, 'f1-score': 0.2968335357351684, 'support': 77993}, '1': {'precision': 0.4795209124157177, 'recall': 0.40510165979660717, 'f1-score': 0.4391810103623859, 'support': 136583}, '2': {'precision': 0.2843344768021799, 'recall': 0.28199838334117533, 'f1-score': 0.28316161193993683, 'support': 82887}, 'accuracy': 0.35332797692486123, 'macro avg': {'precision': 0.34272545442481017, 'recall': 0.3418554385839972, 'f1-score': 0.33972538601249697, 'support': 297463}, 'weighted avg': {'precision': 0.3687087882821373, 'recall': 0.35332797692486123, 'f1-score': 0.35838411641039153, 'support': 297463}}
[[26398 28607 22988]
 [45409 55330 35844]
 [28064 31449 23374]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155684
{'0': {'precision': 0.37546608769528483, 'recall': 0.2758513073028643, 'f1-score': 0.31804097951024485, 'support': 28838}, '1': {'precision': 0.36243954862976896, 'recall': 0.4497499536951287, 'f1-score': 0.40140181508604295, 'support': 26995}, '2': {'precision': 0.3382011973561269, 'recall': 0.35219287181520054, 'f1-score': 0.3450552554461038, 'support': 27749}, 'accuracy': 0.3573616328874638, 'macro avg': {'precision': 0.35870227789372694, 'recall': 0.35926471093773116, 'f1-score': 0.3548326833474638, 'support': 83582}, 'weighted avg': {'precision': 0.35888698137939273, 'recall': 0.3573616328874638, 'f1-score': 0.3539332158687051, 'support': 83582}}
[[ 7955 10943  9940]
 [ 5670 12141  9184]
 [ 7562 10414  9773]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110709
{'0': {'precision': 0.32518762584660443, 'recall': 0.35202615674229665, 'f1-score': 0.3380750749322042, 'support': 10093}, '1': {'precision': 0.3863600813389645, 'recall': 0.4274835583246798, 'f1-score': 0.4058828362501027, 'support': 11556}, '2': {'precision': 0.3553217821782178, 'recall': 0.28305235137533274, 'f1-score': 0.3150963068649509, 'support': 10143}, 'accuracy': 0.3574484146955209, 'macro avg': {'precision': 0.35562316312126224, 'recall': 0.35418735548076974, 'f1-score': 0.35301807268241925, 'support': 31792}, 'weighted avg': {'precision': 0.35703713652039865, 'recall': 0.3574484146955209, 'f1-score': 0.35539115587343106, 'support': 31792}}
[[3553 3829 2711]
 [4118 4940 2498]
 [3255 4017 2871]]
training model: results/XRAY/W8/deepLOB_L2/h300
Epoch 1/50
327/327 - 19s - loss: 3.3439 - accuracy300: 0.3549 - val_loss: 3.3802 - val_accuracy300: 0.3624 - 19s/epoch - 57ms/step
Epoch 2/50
327/327 - 16s - loss: 3.3043 - accuracy300: 0.3723 - val_loss: 3.4038 - val_accuracy300: 0.3370 - 16s/epoch - 50ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2769 - accuracy300: 0.3866 - val_loss: 3.3941 - val_accuracy300: 0.3350 - 16s/epoch - 50ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2678 - accuracy300: 0.3887 - val_loss: 3.3934 - val_accuracy300: 0.3354 - 16s/epoch - 49ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2556 - accuracy300: 0.3971 - val_loss: 3.4137 - val_accuracy300: 0.3427 - 16s/epoch - 49ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2494 - accuracy300: 0.4021 - val_loss: 3.3638 - val_accuracy300: 0.3417 - 16s/epoch - 50ms/step
Epoch 7/50
327/327 - 16s - loss: 3.2295 - accuracy300: 0.4093 - val_loss: 3.3932 - val_accuracy300: 0.3380 - 16s/epoch - 49ms/step
Epoch 8/50
327/327 - 16s - loss: 3.2141 - accuracy300: 0.4193 - val_loss: 3.4315 - val_accuracy300: 0.3405 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1968 - accuracy300: 0.4268 - val_loss: 3.4395 - val_accuracy300: 0.3386 - 16s/epoch - 49ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1839 - accuracy300: 0.4340 - val_loss: 3.4223 - val_accuracy300: 0.3375 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1755 - accuracy300: 0.4380 - val_loss: 3.4413 - val_accuracy300: 0.3382 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1623 - accuracy300: 0.4407 - val_loss: 3.4181 - val_accuracy300: 0.3391 - 16s/epoch - 49ms/step
Epoch 13/50
327/327 - 16s - loss: 3.1505 - accuracy300: 0.4455 - val_loss: 3.4314 - val_accuracy300: 0.3397 - 16s/epoch - 49ms/step
Epoch 14/50
327/327 - 16s - loss: 3.1382 - accuracy300: 0.4495 - val_loss: 3.4211 - val_accuracy300: 0.3435 - 16s/epoch - 49ms/step
Epoch 15/50
327/327 - 16s - loss: 3.1276 - accuracy300: 0.4543 - val_loss: 3.4577 - val_accuracy300: 0.3381 - 16s/epoch - 49ms/step
Epoch 16/50
327/327 - 16s - loss: 3.1159 - accuracy300: 0.4588 - val_loss: 3.4724 - val_accuracy300: 0.3346 - 16s/epoch - 48ms/step
testing model: results/XRAY/W8/deepLOB_L2/h300
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057291
{'0': {'precision': 0.2806833030563789, 'recall': 0.4466364074346426, 'f1-score': 0.34472703075613315, 'support': 78874}, '1': {'precision': 0.48123873651744326, 'recall': 0.3945283213030887, 'f1-score': 0.4335908942196229, 'support': 136046}, '2': {'precision': 0.2682797656482738, 'recall': 0.19638249154985887, 'f1-score': 0.2267687895638793, 'support': 82543}, 'accuracy': 0.3533615945512551, 'macro avg': {'precision': 0.3434006017406987, 'recall': 0.34584907342919674, 'f1-score': 0.33502890484654513, 'support': 297463}, 'weighted avg': {'precision': 0.36896634771190495, 'recall': 0.3533615945512551, 'f1-score': 0.35263707693337776, 'support': 297463}}
[[35228 28527 15119]
 [53279 53674 29093]
 [37001 29332 16210]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029632
{'0': {'precision': 0.37231430325352977, 'recall': 0.29989757355278496, 'f1-score': 0.3322052465815059, 'support': 28313}, '1': {'precision': 0.38315341341036946, 'recall': 0.5342756183745583, 'f1-score': 0.44626781972196805, 'support': 28300}, '2': {'precision': 0.3576053298301586, 'recall': 0.28262078682932257, 'f1-score': 0.31572188969202414, 'support': 26969}, 'accuracy': 0.3736809360867172, 'macro avg': {'precision': 0.37102434883135266, 'recall': 0.37226465958555527, 'f1-score': 0.3647316519984994, 'support': 83582}, 'weighted avg': {'precision': 0.37123824038333836, 'recall': 0.3736809360867172, 'f1-score': 0.36550704802108197, 'support': 83582}}
[[ 8491 12885  6937]
 [ 6425 15120  6755]
 [ 7890 11457  7622]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200359
{'0': {'precision': 0.3105150043779352, 'recall': 0.39451860841423947, 'f1-score': 0.34751236025121374, 'support': 9888}, '1': {'precision': 0.3783053738982087, 'recall': 0.44390691467178245, 'f1-score': 0.408489081628737, 'support': 11989}, '2': {'precision': 0.320674287928696, 'recall': 0.1669188098840141, 'f1-score': 0.21955425842398515, 'support': 9915}, 'accuracy': 0.3421615500754907, 'macro avg': {'precision': 0.33649822206827995, 'recall': 0.3351147776566787, 'f1-score': 0.3251852334346453, 'support': 31792}, 'weighted avg': {'precision': 0.3392476426700952, 'recall': 0.3421615500754907, 'f1-score': 0.33060072628600723, 'support': 31792}}
[[3901 4170 1817]
 [4978 5322 1689]
 [3684 4576 1655]]
training model: results/XRAY/W8/deepLOB_L2/h500
Epoch 1/50
327/327 - 18s - loss: 3.3370 - accuracy500: 0.3613 - val_loss: 3.3797 - val_accuracy500: 0.3307 - 18s/epoch - 55ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2977 - accuracy500: 0.3766 - val_loss: 3.3748 - val_accuracy500: 0.3522 - 16s/epoch - 49ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2703 - accuracy500: 0.3913 - val_loss: 3.4104 - val_accuracy500: 0.3457 - 16s/epoch - 49ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2490 - accuracy500: 0.4022 - val_loss: 3.4204 - val_accuracy500: 0.3305 - 16s/epoch - 49ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2334 - accuracy500: 0.4126 - val_loss: 3.3677 - val_accuracy500: 0.3520 - 16s/epoch - 49ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2245 - accuracy500: 0.4157 - val_loss: 3.4050 - val_accuracy500: 0.3412 - 16s/epoch - 49ms/step
Epoch 7/50
327/327 - 16s - loss: 3.2122 - accuracy500: 0.4218 - val_loss: 3.4141 - val_accuracy500: 0.3303 - 16s/epoch - 49ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1885 - accuracy500: 0.4348 - val_loss: 3.4372 - val_accuracy500: 0.3436 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1842 - accuracy500: 0.4326 - val_loss: 3.4477 - val_accuracy500: 0.3268 - 16s/epoch - 49ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1639 - accuracy500: 0.4415 - val_loss: 3.4518 - val_accuracy500: 0.3392 - 16s/epoch - 49ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1427 - accuracy500: 0.4501 - val_loss: 3.4821 - val_accuracy500: 0.3388 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1250 - accuracy500: 0.4549 - val_loss: 3.4883 - val_accuracy500: 0.3416 - 16s/epoch - 49ms/step
Epoch 13/50
327/327 - 16s - loss: 3.1122 - accuracy500: 0.4596 - val_loss: 3.5470 - val_accuracy500: 0.3365 - 16s/epoch - 49ms/step
Epoch 14/50
327/327 - 16s - loss: 3.0936 - accuracy500: 0.4657 - val_loss: 3.6003 - val_accuracy500: 0.3262 - 16s/epoch - 49ms/step
Epoch 15/50
327/327 - 16s - loss: 3.0749 - accuracy500: 0.4728 - val_loss: 3.5927 - val_accuracy500: 0.3281 - 16s/epoch - 49ms/step
testing model: results/XRAY/W8/deepLOB_L2/h500
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125728
{'0': {'precision': 0.2595180766515198, 'recall': 0.3905515672465229, 'f1-score': 0.3118287171734201, 'support': 73409}, '1': {'precision': 0.5180888535393705, 'recall': 0.3136012875005158, 'f1-score': 0.39070640252262134, 'support': 145398}, '2': {'precision': 0.2803321916770224, 'recall': 0.35276393409275836, 'f1-score': 0.31240464998451883, 'support': 78656}, 'accuracy': 0.3429468538944339, 'macro avg': {'precision': 0.3526463739559709, 'recall': 0.35230559627993235, 'f1-score': 0.33831325656018674, 'support': 297463}, 'weighted avg': {'precision': 0.3914095349148522, 'recall': 0.3429468538944339, 'f1-score': 0.35053591190215255, 'support': 297463}}
[[28670 21159 23580]
 [52149 45597 47652]
 [29655 21254 27747]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1156838
{'0': {'precision': 0.3711773272095889, 'recall': 0.235995869092981, 'f1-score': 0.2885381517361489, 'support': 28081}, '1': {'precision': 0.37789213031029945, 'recall': 0.33747970007947203, 'f1-score': 0.35654443572380307, 'support': 28941}, '2': {'precision': 0.3402537485582468, 'recall': 0.5109186746987951, 'f1-score': 0.4084765660275127, 'support': 26560}, 'accuracy': 0.35849824124811563, 'macro avg': {'precision': 0.3631077353593784, 'recall': 0.3614647479570827, 'f1-score': 0.35118638449582157, 'support': 83582}, 'weighted avg': {'precision': 0.36367574633760713, 'recall': 0.35849824124811563, 'f1-score': 0.35019896564901676, 'support': 83582}}
[[ 6627  8672 12782]
 [ 5644  9767 13530]
 [ 5583  7407 13570]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1237854
{'0': {'precision': 0.29438398601954086, 'recall': 0.3810796915167095, 'f1-score': 0.33216814555884194, 'support': 9725}, '1': {'precision': 0.4242108256706797, 'recall': 0.359495501285347, 'f1-score': 0.3891811975475062, 'support': 12448}, '2': {'precision': 0.33626068869886755, 'recall': 0.30252625012995116, 'f1-score': 0.3185027089147923, 'support': 9619}, 'accuracy': 0.3488613487669854, 'macro avg': {'precision': 0.35161850012969603, 'recall': 0.34770048097733586, 'f1-score': 0.3466173506737135, 'support': 31792}, 'weighted avg': {'precision': 0.3578872731059091, 'recall': 0.3488613487669854, 'f1-score': 0.3503567035632386, 'support': 31792}}
[[3706 2970 3049]
 [5278 4475 2695]
 [3605 3104 2910]]
training model: results/XRAY/W8/deepLOB_L2/h1000
Epoch 1/50
327/327 - 18s - loss: 3.3378 - accuracy1000: 0.3652 - val_loss: 3.4564 - val_accuracy1000: 0.3290 - 18s/epoch - 56ms/step
Epoch 2/50
327/327 - 16s - loss: 3.2783 - accuracy1000: 0.3986 - val_loss: 3.4500 - val_accuracy1000: 0.3193 - 16s/epoch - 49ms/step
Epoch 3/50
327/327 - 16s - loss: 3.2660 - accuracy1000: 0.4057 - val_loss: 3.4924 - val_accuracy1000: 0.3078 - 16s/epoch - 49ms/step
Epoch 4/50
327/327 - 16s - loss: 3.2313 - accuracy1000: 0.4209 - val_loss: 3.4865 - val_accuracy1000: 0.3277 - 16s/epoch - 49ms/step
Epoch 5/50
327/327 - 16s - loss: 3.2559 - accuracy1000: 0.4074 - val_loss: 3.5357 - val_accuracy1000: 0.3136 - 16s/epoch - 49ms/step
Epoch 6/50
327/327 - 16s - loss: 3.2190 - accuracy1000: 0.4265 - val_loss: 3.6561 - val_accuracy1000: 0.3031 - 16s/epoch - 49ms/step
Epoch 7/50
327/327 - 16s - loss: 3.1901 - accuracy1000: 0.4392 - val_loss: 3.6737 - val_accuracy1000: 0.3102 - 16s/epoch - 49ms/step
Epoch 8/50
327/327 - 16s - loss: 3.1818 - accuracy1000: 0.4424 - val_loss: 3.6193 - val_accuracy1000: 0.3154 - 16s/epoch - 49ms/step
Epoch 9/50
327/327 - 16s - loss: 3.1808 - accuracy1000: 0.4397 - val_loss: 3.4755 - val_accuracy1000: 0.3200 - 16s/epoch - 49ms/step
Epoch 10/50
327/327 - 16s - loss: 3.1508 - accuracy1000: 0.4524 - val_loss: 3.6832 - val_accuracy1000: 0.3163 - 16s/epoch - 50ms/step
Epoch 11/50
327/327 - 16s - loss: 3.1325 - accuracy1000: 0.4600 - val_loss: 3.6311 - val_accuracy1000: 0.3183 - 16s/epoch - 49ms/step
Epoch 12/50
327/327 - 16s - loss: 3.1146 - accuracy1000: 0.4634 - val_loss: 3.7049 - val_accuracy1000: 0.3224 - 16s/epoch - 50ms/step
testing model: results/XRAY/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.150325
{'0': {'precision': 0.24802544721786865, 'recall': 0.4409261851821351, 'f1-score': 0.31747051353634975, 'support': 72858}, '1': {'precision': 0.5335813039511544, 'recall': 0.1555081336842249, 'f1-score': 0.2408286304052877, 'support': 146674}, '2': {'precision': 0.2751911049339819, 'recall': 0.44208338145282366, 'f1-score': 0.33922136232055294, 'support': 77931}, 'accuracy': 0.30049451528425386, 'macro avg': {'precision': 0.352265952034335, 'recall': 0.34617256677306124, 'f1-score': 0.29917350208739685, 'support': 297463}, 'weighted avg': {'precision': 0.3959452443085064, 'recall': 0.30049451528425386, 'f1-score': 0.28537809811068793, 'support': 297463}}
[[32125 10297 30436]
 [63560 22809 60305]
 [33838  9641 34452]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1425906
{'0': {'precision': 0.36547630176685053, 'recall': 0.2617939531924867, 'f1-score': 0.3050662296872867, 'support': 29867}, '1': {'precision': 0.3018785015928815, 'recall': 0.20287180244361597, 'f1-score': 0.24266507715742766, 'support': 27091}, '2': {'precision': 0.3278841344186258, 'recall': 0.5416541466346154, 'f1-score': 0.4084921961306405, 'support': 26624}, 'accuracy': 0.33184178411619725, 'macro avg': {'precision': 0.331746312592786, 'recall': 0.3354399674235727, 'f1-score': 0.3187411676584516, 'support': 83582}, 'weighted avg': {'precision': 0.3328881623589382, 'recall': 0.33184178411619725, 'f1-score': 0.3177855150286453, 'support': 83582}}
[[ 7819  7000 15048]
 [ 7082  5496 14513]
 [ 6493  5710 14421]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1420043
{'0': {'precision': 0.28735632183908044, 'recall': 0.4176549448282974, 'f1-score': 0.3404648816779455, 'support': 9697}, '1': {'precision': 0.40588489831241886, 'recall': 0.22141789283185145, 'f1-score': 0.2865288667141839, 'support': 12709}, '2': {'precision': 0.3035764050162564, 'recall': 0.3481781376518219, 'f1-score': 0.324351148826361, 'support': 9386}, 'accuracy': 0.31869652742828386, 'macro avg': {'precision': 0.3322725417225852, 'recall': 0.32908365843732357, 'f1-score': 0.31711496573949677, 'support': 31792}, 'weighted avg': {'precision': 0.3395273516296136, 'recall': 0.31869652742828386, 'f1-score': 0.3141464270126392, 'support': 31792}}
[[4050 2062 3585]
 [5983 2814 3912]
 [4061 2057 3268]]
training model: results/XRAY/W8/deepOF_L2/h10
Epoch 1/50
327/327 - 12s - loss: 3.2824 - accuracy10: 0.3817 - val_loss: 3.1921 - val_accuracy10: 0.4246 - 12s/epoch - 38ms/step
Epoch 2/50
327/327 - 10s - loss: 3.1930 - accuracy10: 0.4241 - val_loss: 3.1426 - val_accuracy10: 0.4391 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 11s - loss: 3.1564 - accuracy10: 0.4392 - val_loss: 3.1173 - val_accuracy10: 0.4506 - 11s/epoch - 32ms/step
Epoch 4/50
327/327 - 10s - loss: 3.1315 - accuracy10: 0.4508 - val_loss: 3.0988 - val_accuracy10: 0.4591 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1125 - accuracy10: 0.4555 - val_loss: 3.0866 - val_accuracy10: 0.4627 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.0984 - accuracy10: 0.4614 - val_loss: 3.0819 - val_accuracy10: 0.4616 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.0830 - accuracy10: 0.4687 - val_loss: 3.0797 - val_accuracy10: 0.4657 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.0694 - accuracy10: 0.4719 - val_loss: 3.0753 - val_accuracy10: 0.4670 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.0576 - accuracy10: 0.4756 - val_loss: 3.0726 - val_accuracy10: 0.4696 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.0475 - accuracy10: 0.4792 - val_loss: 3.0696 - val_accuracy10: 0.4719 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.0355 - accuracy10: 0.4837 - val_loss: 3.0645 - val_accuracy10: 0.4750 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.0255 - accuracy10: 0.4884 - val_loss: 3.0720 - val_accuracy10: 0.4729 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.0146 - accuracy10: 0.4904 - val_loss: 3.0700 - val_accuracy10: 0.4728 - 10s/epoch - 30ms/step
Epoch 14/50
327/327 - 10s - loss: 3.0044 - accuracy10: 0.4938 - val_loss: 3.0709 - val_accuracy10: 0.4734 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 2.9957 - accuracy10: 0.4961 - val_loss: 3.0736 - val_accuracy10: 0.4750 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 2.9863 - accuracy10: 0.4998 - val_loss: 3.0727 - val_accuracy10: 0.4770 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 2.9751 - accuracy10: 0.5019 - val_loss: 3.0749 - val_accuracy10: 0.4751 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 2.9662 - accuracy10: 0.5041 - val_loss: 3.0767 - val_accuracy10: 0.4791 - 10s/epoch - 31ms/step
Epoch 19/50
327/327 - 10s - loss: 2.9580 - accuracy10: 0.5064 - val_loss: 3.0808 - val_accuracy10: 0.4785 - 10s/epoch - 31ms/step
Epoch 20/50
327/327 - 10s - loss: 2.9478 - accuracy10: 0.5101 - val_loss: 3.0921 - val_accuracy10: 0.4772 - 10s/epoch - 31ms/step
Epoch 21/50
327/327 - 10s - loss: 2.9378 - accuracy10: 0.5143 - val_loss: 3.0859 - val_accuracy10: 0.4780 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h10
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0112976
{'0': {'precision': 0.37668983426258307, 'recall': 0.3242987335779382, 'f1-score': 0.3485364578180431, 'support': 76041}, '1': {'precision': 0.5422337603817834, 'recall': 0.7226255953924472, 'f1-score': 0.619566107724172, 'support': 146542}, '2': {'precision': 0.4368511403580479, 'recall': 0.2141168614357262, 'f1-score': 0.2873787800025095, 'support': 74875}, 'accuracy': 0.4927989833858898, 'macro avg': {'precision': 0.45192491166747145, 'recall': 0.4203470634687039, 'f1-score': 0.4184937818482415, 'support': 297458}, 'weighted avg': {'precision': 0.473388244845784, 'recall': 0.4927989833858898, 'f1-score': 0.466664213098136, 'support': 297458}}
[[ 24660  44041   7340]
 [ 27320 105895  13327]
 [ 13485  45358  16032]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0280015
{'0': {'precision': 0.5024088093599449, 'recall': 0.4206735098145147, 'f1-score': 0.4579224903455982, 'support': 27765}, '1': {'precision': 0.42502361992171683, 'recall': 0.6811348642705216, 'f1-score': 0.5234302494701701, 'support': 27739}, '2': {'precision': 0.5337531486146095, 'recall': 0.30187335280290617, 'f1-score': 0.3856408389826652, 'support': 28078}, 'accuracy': 0.46720585772056183, 'macro avg': {'precision': 0.48706185929875706, 'recall': 0.4678939089626475, 'f1-score': 0.4556645262661445, 'support': 83582}, 'weighted avg': {'precision': 0.48725600837128064, 'recall': 0.46720585772056183, 'f1-score': 0.45538121977762985, 'support': 83582}}
[[11680 12288  3797]
 [ 5238 18894  3607]
 [ 6330 13272  8476]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0214059
{'0': {'precision': 0.47001741726797713, 'recall': 0.3857069933639612, 'f1-score': 0.42370885437110967, 'support': 9795}, '1': {'precision': 0.4649741681017721, 'recall': 0.6969772670497127, 'f1-score': 0.5578140619793402, 'support': 12009}, '2': {'precision': 0.500782200590996, 'recall': 0.2884461353624349, 'f1-score': 0.3660504415221396, 'support': 9988}, 'accuracy': 0.47272898842476097, 'macro avg': {'precision': 0.47859126198691504, 'recall': 0.45704346525870293, 'f1-score': 0.44919111929086314, 'support': 31792}, 'weighted avg': {'precision': 0.477777680120058, 'recall': 0.47272898842476097, 'f1-score': 0.45625091560134773, 'support': 31792}}
[[3778 4668 1349]
 [2116 8370 1523]
 [2144 4963 2881]]
training model: results/XRAY/W8/deepOF_L2/h20
Epoch 1/50
327/327 - 13s - loss: 3.3035 - accuracy20: 0.3681 - val_loss: 3.2292 - val_accuracy20: 0.4019 - 13s/epoch - 39ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2304 - accuracy20: 0.4048 - val_loss: 3.1973 - val_accuracy20: 0.4160 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2039 - accuracy20: 0.4171 - val_loss: 3.1784 - val_accuracy20: 0.4210 - 10s/epoch - 32ms/step
Epoch 4/50
327/327 - 10s - loss: 3.1861 - accuracy20: 0.4244 - val_loss: 3.1680 - val_accuracy20: 0.4249 - 10s/epoch - 32ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1704 - accuracy20: 0.4322 - val_loss: 3.1587 - val_accuracy20: 0.4332 - 10s/epoch - 32ms/step
Epoch 6/50
327/327 - 10s - loss: 3.1629 - accuracy20: 0.4363 - val_loss: 3.1515 - val_accuracy20: 0.4341 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.1498 - accuracy20: 0.4432 - val_loss: 3.1416 - val_accuracy20: 0.4398 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.1396 - accuracy20: 0.4456 - val_loss: 3.1357 - val_accuracy20: 0.4397 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.1298 - accuracy20: 0.4506 - val_loss: 3.1357 - val_accuracy20: 0.4420 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.1207 - accuracy20: 0.4548 - val_loss: 3.1313 - val_accuracy20: 0.4456 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.1118 - accuracy20: 0.4579 - val_loss: 3.1265 - val_accuracy20: 0.4462 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.1011 - accuracy20: 0.4620 - val_loss: 3.1341 - val_accuracy20: 0.4438 - 10s/epoch - 30ms/step
Epoch 13/50
327/327 - 10s - loss: 3.0954 - accuracy20: 0.4646 - val_loss: 3.1314 - val_accuracy20: 0.4439 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.0855 - accuracy20: 0.4665 - val_loss: 3.1324 - val_accuracy20: 0.4430 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.0800 - accuracy20: 0.4687 - val_loss: 3.1369 - val_accuracy20: 0.4453 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.0686 - accuracy20: 0.4744 - val_loss: 3.1401 - val_accuracy20: 0.4441 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 3.0591 - accuracy20: 0.4752 - val_loss: 3.1377 - val_accuracy20: 0.4449 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 3.0536 - accuracy20: 0.4789 - val_loss: 3.1379 - val_accuracy20: 0.4448 - 10s/epoch - 31ms/step
Epoch 19/50
327/327 - 10s - loss: 3.0431 - accuracy20: 0.4833 - val_loss: 3.1408 - val_accuracy20: 0.4464 - 10s/epoch - 31ms/step
Epoch 20/50
327/327 - 10s - loss: 3.0338 - accuracy20: 0.4868 - val_loss: 3.1555 - val_accuracy20: 0.4428 - 10s/epoch - 31ms/step
Epoch 21/50
327/327 - 10s - loss: 3.0232 - accuracy20: 0.4898 - val_loss: 3.1578 - val_accuracy20: 0.4454 - 10s/epoch - 30ms/step
testing model: results/XRAY/W8/deepOF_L2/h20
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0240327
{'0': {'precision': 0.3805325339446306, 'recall': 0.3942221120346569, 'f1-score': 0.38725637854016187, 'support': 76637}, '1': {'precision': 0.5388925774989697, 'recall': 0.6488071447275935, 'f1-score': 0.5887638903653861, 'support': 145114}, '2': {'precision': 0.39850525927292857, 'recall': 0.22819554334473693, 'f1-score': 0.290209056014245, 'support': 75707}, 'accuracy': 0.4761647022436781, 'macro avg': {'precision': 0.4393101235721763, 'recall': 0.4237416000356624, 'f1-score': 0.42207644163993097, 'support': 297458}, 'weighted avg': {'precision': 0.46236230647310117, 'recall': 0.4761647022436781, 'f1-score': 0.4608613897502688, 'support': 297458}}
[[30212 38401  8024]
 [32911 94151 18052]
 [16271 42160 17276]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0447279
{'0': {'precision': 0.46813805041653145, 'recall': 0.4675815863410417, 'f1-score': 0.4678596529166892, 'support': 27762}, '1': {'precision': 0.40162398500936913, 'recall': 0.5317106493132955, 'f1-score': 0.4576016832464378, 'support': 27814}, '2': {'precision': 0.4959537572254335, 'recall': 0.33699921445404557, 'f1-score': 0.401309635173059, 'support': 28006}, 'accuracy': 0.4451676198224498, 'macro avg': {'precision': 0.4552385975504447, 'recall': 0.4454304833694609, 'f1-score': 0.4422569904453953, 'support': 83582}, 'weighted avg': {'precision': 0.45532410087781855, 'recall': 0.4451676198224498, 'f1-score': 0.44214699988928524, 'support': 83582}}
[[12981 10449  4332]
 [ 7765 14789  5260]
 [ 6983 11585  9438]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0432736
{'0': {'precision': 0.43918987341772153, 'recall': 0.4420548364081133, 'f1-score': 0.4406176978563446, 'support': 9811}, '1': {'precision': 0.44140781229169446, 'recall': 0.5539104976997072, 'f1-score': 0.4913009607894053, 'support': 11955}, '2': {'precision': 0.45900216919739695, 'recall': 0.3165769000598444, 'f1-score': 0.37471223658579783, 'support': 10026}, 'accuracy': 0.44454579768495217, 'macro avg': {'precision': 0.4465332849689376, 'recall': 0.4375140780558883, 'f1-score': 0.43554363174384925, 'support': 31792}, 'weighted avg': {'precision': 0.44627195497048233, 'recall': 0.44454579768495217, 'f1-score': 0.4388924290360829, 'support': 31792}}
[[4337 3944 1530]
 [3122 6622 2211]
 [2416 4436 3174]]
training model: results/XRAY/W8/deepOF_L2/h30
Epoch 1/50
327/327 - 12s - loss: 3.3081 - accuracy30: 0.3650 - val_loss: 3.2554 - val_accuracy30: 0.3848 - 12s/epoch - 38ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2450 - accuracy30: 0.3973 - val_loss: 3.2218 - val_accuracy30: 0.4026 - 10s/epoch - 32ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2212 - accuracy30: 0.4088 - val_loss: 3.2053 - val_accuracy30: 0.4099 - 10s/epoch - 32ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2047 - accuracy30: 0.4174 - val_loss: 3.2040 - val_accuracy30: 0.4110 - 10s/epoch - 32ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1900 - accuracy30: 0.4239 - val_loss: 3.1899 - val_accuracy30: 0.4186 - 10s/epoch - 32ms/step
Epoch 6/50
327/327 - 10s - loss: 3.1806 - accuracy30: 0.4294 - val_loss: 3.1873 - val_accuracy30: 0.4214 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.1734 - accuracy30: 0.4332 - val_loss: 3.1847 - val_accuracy30: 0.4195 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.1630 - accuracy30: 0.4390 - val_loss: 3.1842 - val_accuracy30: 0.4212 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.1580 - accuracy30: 0.4424 - val_loss: 3.1809 - val_accuracy30: 0.4224 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.1509 - accuracy30: 0.4432 - val_loss: 3.1763 - val_accuracy30: 0.4282 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.1419 - accuracy30: 0.4461 - val_loss: 3.1754 - val_accuracy30: 0.4262 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.1333 - accuracy30: 0.4506 - val_loss: 3.1812 - val_accuracy30: 0.4234 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.1255 - accuracy30: 0.4543 - val_loss: 3.1829 - val_accuracy30: 0.4225 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1211 - accuracy30: 0.4560 - val_loss: 3.1775 - val_accuracy30: 0.4241 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1128 - accuracy30: 0.4587 - val_loss: 3.1843 - val_accuracy30: 0.4250 - 10s/epoch - 30ms/step
Epoch 16/50
327/327 - 10s - loss: 3.1044 - accuracy30: 0.4607 - val_loss: 3.1900 - val_accuracy30: 0.4226 - 10s/epoch - 30ms/step
Epoch 17/50
327/327 - 10s - loss: 3.0953 - accuracy30: 0.4652 - val_loss: 3.1945 - val_accuracy30: 0.4192 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 3.0879 - accuracy30: 0.4678 - val_loss: 3.2011 - val_accuracy30: 0.4221 - 10s/epoch - 31ms/step
Epoch 19/50
327/327 - 10s - loss: 3.0802 - accuracy30: 0.4705 - val_loss: 3.2059 - val_accuracy30: 0.4198 - 10s/epoch - 31ms/step
Epoch 20/50
327/327 - 10s - loss: 3.0696 - accuracy30: 0.4739 - val_loss: 3.2153 - val_accuracy30: 0.4211 - 10s/epoch - 31ms/step
Epoch 21/50
327/327 - 10s - loss: 3.0623 - accuracy30: 0.4770 - val_loss: 3.2151 - val_accuracy30: 0.4222 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h30
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0513649
{'0': {'precision': 0.3686648279393453, 'recall': 0.3999318276502001, 'f1-score': 0.38366234709943076, 'support': 79211}, '1': {'precision': 0.4814947211419344, 'recall': 0.5613655634278487, 'f1-score': 0.5183715583394434, 'support': 139166}, '2': {'precision': 0.3658427695929218, 'recall': 0.22796879149226743, 'f1-score': 0.28089966422299956, 'support': 79081}, 'accuracy': 0.4297413416347854, 'macro avg': {'precision': 0.4053341062247338, 'recall': 0.39642206085677206, 'f1-score': 0.39431118988729125, 'support': 297458}, 'weighted avg': {'precision': 0.42070213647143384, 'recall': 0.4297413416347854, 'f1-score': 0.4193660981058805, 'support': 297458}}
[[31679 39245  8287]
 [38080 78123 22963]
 [16170 44883 18028]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0537251
{'0': {'precision': 0.471039332791462, 'recall': 0.4733477751340602, 'f1-score': 0.4721907326059232, 'support': 28159}, '1': {'precision': 0.37392193719593103, 'recall': 0.49850746268656715, 'f1-score': 0.4273191072641406, 'support': 27135}, '2': {'precision': 0.4876236328431629, 'recall': 0.32939762443438914, 'f1-score': 0.3931894423697702, 'support': 28288}, 'accuracy': 0.4327965351391448, 'macro avg': {'precision': 0.4441949676101853, 'recall': 0.4337509540850055, 'f1-score': 0.43089976074661135, 'support': 83582}, 'weighted avg': {'precision': 0.44512294110877654, 'recall': 0.4327965351391448, 'f1-score': 0.4308854270156099, 'support': 83582}}
[[13329 10461  4369]
 [ 8186 13527  5422]
 [ 6782 12188  9318]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.060359
{'0': {'precision': 0.4342492639842983, 'recall': 0.43768545994065283, 'f1-score': 0.43596059113300495, 'support': 10110}, '1': {'precision': 0.3966635147913008, 'recall': 0.512120683641437, 'f1-score': 0.44705792798964755, 'support': 11468}, '2': {'precision': 0.4546792230723955, 'recall': 0.3025259447816722, 'f1-score': 0.36331569664902996, 'support': 10214}, 'accuracy': 0.421112229491696, 'macro avg': {'precision': 0.4285306672826648, 'recall': 0.41744402945458736, 'f1-score': 0.4154447385905608, 'support': 31792}, 'weighted avg': {'precision': 0.4272549959414111, 'recall': 0.421112229491696, 'f1-score': 0.41662457285207444, 'support': 31792}}
[[4425 4136 1549]
 [3438 5873 2157]
 [2327 4797 3090]]
training model: results/XRAY/W8/deepOF_L2/h50
Epoch 1/50
327/327 - 13s - loss: 3.3188 - accuracy50: 0.3592 - val_loss: 3.2821 - val_accuracy50: 0.3686 - 13s/epoch - 39ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2665 - accuracy50: 0.3871 - val_loss: 3.2481 - val_accuracy50: 0.3875 - 10s/epoch - 32ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2438 - accuracy50: 0.3998 - val_loss: 3.2350 - val_accuracy50: 0.3923 - 10s/epoch - 31ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2309 - accuracy50: 0.4066 - val_loss: 3.2306 - val_accuracy50: 0.3958 - 10s/epoch - 32ms/step
Epoch 5/50
327/327 - 11s - loss: 3.2187 - accuracy50: 0.4134 - val_loss: 3.2192 - val_accuracy50: 0.4038 - 11s/epoch - 32ms/step
Epoch 6/50
327/327 - 11s - loss: 3.2099 - accuracy50: 0.4173 - val_loss: 3.2202 - val_accuracy50: 0.4020 - 11s/epoch - 32ms/step
Epoch 7/50
327/327 - 11s - loss: 3.2006 - accuracy50: 0.4213 - val_loss: 3.2160 - val_accuracy50: 0.4044 - 11s/epoch - 33ms/step
Epoch 8/50
327/327 - 10s - loss: 3.1946 - accuracy50: 0.4254 - val_loss: 3.2146 - val_accuracy50: 0.4075 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.1873 - accuracy50: 0.4300 - val_loss: 3.2155 - val_accuracy50: 0.4062 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.1811 - accuracy50: 0.4314 - val_loss: 3.2185 - val_accuracy50: 0.4049 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.1714 - accuracy50: 0.4372 - val_loss: 3.2209 - val_accuracy50: 0.4065 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.1650 - accuracy50: 0.4387 - val_loss: 3.2280 - val_accuracy50: 0.4038 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.1577 - accuracy50: 0.4425 - val_loss: 3.2283 - val_accuracy50: 0.4073 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1503 - accuracy50: 0.4458 - val_loss: 3.2322 - val_accuracy50: 0.4095 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1443 - accuracy50: 0.4487 - val_loss: 3.2441 - val_accuracy50: 0.4070 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.1360 - accuracy50: 0.4516 - val_loss: 3.2478 - val_accuracy50: 0.4036 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 3.1286 - accuracy50: 0.4562 - val_loss: 3.2538 - val_accuracy50: 0.4038 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 3.1211 - accuracy50: 0.4577 - val_loss: 3.2598 - val_accuracy50: 0.4041 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h50
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0576314
{'0': {'precision': 0.3683586947212151, 'recall': 0.33106253046981243, 'f1-score': 0.34871621621621623, 'support': 77946}, '1': {'precision': 0.48792935093009404, 'recall': 0.5648965139675927, 'f1-score': 0.5235995782259127, 'support': 140647}, '2': {'precision': 0.32455746387697265, 'recall': 0.26573258099283587, 'f1-score': 0.2922139490783346, 'support': 78865}, 'accuracy': 0.42430528007315316, 'macro avg': {'precision': 0.39361516984276057, 'recall': 0.3872305418100803, 'f1-score': 0.38817658117348786, 'support': 297458}, 'weighted avg': {'precision': 0.41328224699844085, 'recall': 0.42430528007315316, 'f1-score': 0.4164258388141922, 'support': 297458}}
[[25805 40275 11866]
 [29448 79451 31748]
 [14801 43107 20957]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0679069
{'0': {'precision': 0.44928310258411736, 'recall': 0.39153628584726646, 'f1-score': 0.4184266911539639, 'support': 27931}, '1': {'precision': 0.377864376080573, 'recall': 0.49427432961194673, 'f1-score': 0.4283003608311559, 'support': 27857}, '2': {'precision': 0.44031225331111307, 'recall': 0.3612290422393322, 'f1-score': 0.39686931773262707, 'support': 27794}, 'accuracy': 0.4156995525352349, 'macro avg': {'precision': 0.4224865773252678, 'recall': 0.41567988589951516, 'f1-score': 0.41453212323924893, 'support': 83582}, 'weighted avg': {'precision': 0.42249686572805845, 'recall': 0.4156995525352349, 'f1-score': 0.41454888468037987, 'support': 83582}}
[[10936 10985  6010]
 [ 7336 13769  6752]
 [ 6069 11685 10040]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0713698
{'0': {'precision': 0.42139493159901326, 'recall': 0.37441466573677396, 'f1-score': 0.3965180691110525, 'support': 10037}, '1': {'precision': 0.3888888888888889, 'recall': 0.5069908814589665, 'f1-score': 0.44015531345421643, 'support': 11515}, '2': {'precision': 0.4217756296107861, 'recall': 0.323828125, 'f1-score': 0.3663683570876146, 'support': 10240}, 'accuracy': 0.4061399094111726, 'macro avg': {'precision': 0.41068648336622937, 'recall': 0.4017445573985802, 'f1-score': 0.40101391321762786, 'support': 31792}, 'weighted avg': {'precision': 0.4097439271272428, 'recall': 0.4061399094111726, 'f1-score': 0.4026123638232923, 'support': 31792}}
[[3758 4320 1959]
 [3090 5838 2587]
 [2070 4854 3316]]
training model: results/XRAY/W8/deepOF_L2/h100
Epoch 1/50
327/327 - 12s - loss: 3.3310 - accuracy100: 0.3467 - val_loss: 3.2904 - val_accuracy100: 0.3652 - 12s/epoch - 38ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2874 - accuracy100: 0.3724 - val_loss: 3.2652 - val_accuracy100: 0.3811 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2681 - accuracy100: 0.3849 - val_loss: 3.2466 - val_accuracy100: 0.3927 - 10s/epoch - 31ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2561 - accuracy100: 0.3880 - val_loss: 3.2358 - val_accuracy100: 0.4002 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2460 - accuracy100: 0.3948 - val_loss: 3.2307 - val_accuracy100: 0.4059 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2393 - accuracy100: 0.3987 - val_loss: 3.2288 - val_accuracy100: 0.4032 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2330 - accuracy100: 0.4036 - val_loss: 3.2239 - val_accuracy100: 0.4089 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2256 - accuracy100: 0.4072 - val_loss: 3.2276 - val_accuracy100: 0.4060 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2215 - accuracy100: 0.4106 - val_loss: 3.2328 - val_accuracy100: 0.4076 - 10s/epoch - 32ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2147 - accuracy100: 0.4129 - val_loss: 3.2292 - val_accuracy100: 0.4112 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2097 - accuracy100: 0.4146 - val_loss: 3.2412 - val_accuracy100: 0.4093 - 10s/epoch - 32ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2048 - accuracy100: 0.4164 - val_loss: 3.2439 - val_accuracy100: 0.4088 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.1989 - accuracy100: 0.4224 - val_loss: 3.2513 - val_accuracy100: 0.4098 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1941 - accuracy100: 0.4223 - val_loss: 3.2567 - val_accuracy100: 0.4092 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1879 - accuracy100: 0.4251 - val_loss: 3.2633 - val_accuracy100: 0.4104 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.1817 - accuracy100: 0.4283 - val_loss: 3.2873 - val_accuracy100: 0.4087 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 3.1790 - accuracy100: 0.4294 - val_loss: 3.2866 - val_accuracy100: 0.4087 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h100
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0387838
{'0': {'precision': 0.3115993199947692, 'recall': 0.18289275736084246, 'f1-score': 0.23049614517736053, 'support': 65142}, '1': {'precision': 0.560662716699583, 'recall': 0.779996214410883, 'f1-score': 0.652387846660998, 'support': 163779}, '2': {'precision': 0.2413859050776145, 'recall': 0.11049506106190816, 'f1-score': 0.1515964367931138, 'support': 68537}, 'accuracy': 0.4949740803743722, 'macro avg': {'precision': 0.3712159805906556, 'recall': 0.35779467761121114, 'f1-score': 0.3448268095438241, 'support': 297458}, 'weighted avg': {'precision': 0.4325546724503786, 'recall': 0.4949740803743722, 'f1-score': 0.44460856327926923, 'support': 297458}}
[[ 11914  47833   5395]
 [ 17627 127747  18405]
 [  8694  52270   7573]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0870019
{'0': {'precision': 0.43328147438966014, 'recall': 0.25679126179161643, 'f1-score': 0.3224671565352928, 'support': 28198}, '1': {'precision': 0.3593616567036721, 'recall': 0.733415634871646, 'f1-score': 0.48236993874553735, 'support': 27541}, '2': {'precision': 0.42703057587694615, 'recall': 0.16352404554106956, 'f1-score': 0.23648876769250746, 'support': 27843}, 'accuracy': 0.38277380297193175, 'macro avg': {'precision': 0.4065579023234261, 'recall': 0.38457698073477736, 'f1-score': 0.3471086209911125, 'support': 83582}, 'weighted avg': {'precision': 0.40684193637693855, 'recall': 0.38277380297193175, 'f1-score': 0.3465152320097092, 'support': 83582}}
[[ 7241 17718  3239]
 [ 4472 20199  2870]
 [ 4999 18291  4553]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0742468
{'0': {'precision': 0.3753322700691122, 'recall': 0.22292390274707927, 'f1-score': 0.2797147385103011, 'support': 9501}, '1': {'precision': 0.4228356890459364, 'recall': 0.753008731220011, 'f1-score': 0.5415664865782253, 'support': 12713}, '2': {'precision': 0.38757480763750357, 'recall': 0.1419920651493005, 'f1-score': 0.20783984106365097, 'support': 9578}, 'accuracy': 0.41051207851031707, 'macro avg': {'precision': 0.3952475889175174, 'recall': 0.37264156637213025, 'f1-score': 0.34304035538405914, 'support': 31792}, 'weighted avg': {'precision': 0.3980162783190625, 'recall': 0.41051207851031707, 'f1-score': 0.3627703344288814, 'support': 31792}}
[[2118 6407  976]
 [1967 9573 1173]
 [1558 6660 1360]]
training model: results/XRAY/W8/deepOF_L2/h200
Epoch 1/50
327/327 - 12s - loss: 3.3338 - accuracy200: 0.3489 - val_loss: 3.3343 - val_accuracy200: 0.3393 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.3003 - accuracy200: 0.3618 - val_loss: 3.3149 - val_accuracy200: 0.3500 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2854 - accuracy200: 0.3707 - val_loss: 3.2974 - val_accuracy200: 0.3635 - 10s/epoch - 31ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2740 - accuracy200: 0.3786 - val_loss: 3.2854 - val_accuracy200: 0.3716 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2648 - accuracy200: 0.3839 - val_loss: 3.2785 - val_accuracy200: 0.3787 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2566 - accuracy200: 0.3899 - val_loss: 3.2748 - val_accuracy200: 0.3798 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2510 - accuracy200: 0.3902 - val_loss: 3.2727 - val_accuracy200: 0.3845 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2432 - accuracy200: 0.3961 - val_loss: 3.2736 - val_accuracy200: 0.3840 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2401 - accuracy200: 0.3988 - val_loss: 3.2737 - val_accuracy200: 0.3813 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2343 - accuracy200: 0.4009 - val_loss: 3.2757 - val_accuracy200: 0.3815 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2292 - accuracy200: 0.4043 - val_loss: 3.2811 - val_accuracy200: 0.3793 - 10s/epoch - 32ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2229 - accuracy200: 0.4074 - val_loss: 3.2894 - val_accuracy200: 0.3761 - 10s/epoch - 32ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2167 - accuracy200: 0.4118 - val_loss: 3.2890 - val_accuracy200: 0.3779 - 10s/epoch - 32ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2152 - accuracy200: 0.4107 - val_loss: 3.2924 - val_accuracy200: 0.3770 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2106 - accuracy200: 0.4159 - val_loss: 3.2965 - val_accuracy200: 0.3753 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2031 - accuracy200: 0.4189 - val_loss: 3.3038 - val_accuracy200: 0.3774 - 10s/epoch - 30ms/step
Epoch 17/50
327/327 - 10s - loss: 3.1987 - accuracy200: 0.4216 - val_loss: 3.3059 - val_accuracy200: 0.3776 - 10s/epoch - 32ms/step
testing model: results/XRAY/W8/deepOF_L2/h200
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0760374
{'0': {'precision': 0.3137236334367084, 'recall': 0.1699170417099409, 'f1-score': 0.22044048173531175, 'support': 77991}, '1': {'precision': 0.4820833619986437, 'recall': 0.7182718074123969, 'f1-score': 0.5769407198306281, 'support': 136582}, '2': {'precision': 0.313327790560529, 'recall': 0.19551185377330035, 'f1-score': 0.24078036313928264, 'support': 82885}, 'accuracy': 0.4288336504649396, 'macro avg': {'precision': 0.36971159533196035, 'recall': 0.3612335676318794, 'f1-score': 0.34605385490174084, 'support': 297458}, 'weighted avg': {'precision': 0.3909180575559256, 'recall': 0.4288336504649396, 'f1-score': 0.38980014457746975, 'support': 297458}}
[[13252 51085 13654]
 [16619 98103 21860]
 [12370 54310 16205]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.086621
{'0': {'precision': 0.4170519047340394, 'recall': 0.24724207312842572, 'f1-score': 0.31044321027986493, 'support': 28826}, '1': {'precision': 0.36978240344290014, 'recall': 0.6237407407407407, 'f1-score': 0.4643039300828474, 'support': 27000}, '2': {'precision': 0.3928878281622912, 'recall': 0.29654849401931116, 'f1-score': 0.33798710631133744, 'support': 27756}, 'accuracy': 0.38523844846976624, 'macro avg': {'precision': 0.39324071211307693, 'recall': 0.38917710262949257, 'f1-score': 0.3709114155580166, 'support': 83582}, 'weighted avg': {'precision': 0.39375771885446964, 'recall': 0.38523844846976624, 'f1-score': 0.3692925775231719, 'support': 83582}}
[[ 7127 14663  7036]
 [ 4476 16841  5683]
 [ 5486 14039  8231]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0898689
{'0': {'precision': 0.35894680279419666, 'recall': 0.19841584158415843, 'f1-score': 0.2555633488490723, 'support': 10100}, '1': {'precision': 0.3960308365454735, 'recall': 0.6588388214904679, 'f1-score': 0.494697117574338, 'support': 11540}, '2': {'precision': 0.362002567394095, 'recall': 0.25, 'f1-score': 0.29575249082328264, 'support': 10152}, 'accuracy': 0.38201434323100153, 'macro avg': {'precision': 0.3723267355779217, 'recall': 0.3690848876915421, 'f1-score': 0.34867098574889765, 'support': 31792}, 'weighted avg': {'precision': 0.37338351239749, 'recall': 0.38201434323100153, 'f1-score': 0.3551985986103881, 'support': 31792}}
[[2004 5827 2269]
 [1733 7603 2204]
 [1846 5768 2538]]
training model: results/XRAY/W8/deepOF_L2/h300
Epoch 1/50
327/327 - 12s - loss: 3.3387 - accuracy300: 0.3445 - val_loss: 3.3383 - val_accuracy300: 0.3265 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.3047 - accuracy300: 0.3602 - val_loss: 3.3225 - val_accuracy300: 0.3316 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2902 - accuracy300: 0.3688 - val_loss: 3.3074 - val_accuracy300: 0.3397 - 10s/epoch - 31ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2810 - accuracy300: 0.3718 - val_loss: 3.2992 - val_accuracy300: 0.3468 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2716 - accuracy300: 0.3789 - val_loss: 3.2919 - val_accuracy300: 0.3602 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2635 - accuracy300: 0.3841 - val_loss: 3.2826 - val_accuracy300: 0.3697 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2559 - accuracy300: 0.3906 - val_loss: 3.2849 - val_accuracy300: 0.3720 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2522 - accuracy300: 0.3922 - val_loss: 3.2845 - val_accuracy300: 0.3762 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2463 - accuracy300: 0.3950 - val_loss: 3.2857 - val_accuracy300: 0.3749 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2409 - accuracy300: 0.4005 - val_loss: 3.2856 - val_accuracy300: 0.3790 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2365 - accuracy300: 0.4013 - val_loss: 3.2897 - val_accuracy300: 0.3773 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2313 - accuracy300: 0.4042 - val_loss: 3.2936 - val_accuracy300: 0.3783 - 10s/epoch - 30ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2270 - accuracy300: 0.4071 - val_loss: 3.2975 - val_accuracy300: 0.3773 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2235 - accuracy300: 0.4080 - val_loss: 3.3048 - val_accuracy300: 0.3778 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2169 - accuracy300: 0.4130 - val_loss: 3.3027 - val_accuracy300: 0.3783 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2136 - accuracy300: 0.4150 - val_loss: 3.3098 - val_accuracy300: 0.3744 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h300
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0874021
{'0': {'precision': 0.3101187895603919, 'recall': 0.22673158114944278, 'f1-score': 0.2619490544756771, 'support': 78873}, '1': {'precision': 0.47710069880186523, 'recall': 0.5309527659762139, 'f1-score': 0.5025882942306087, 'support': 136046}, '2': {'precision': 0.29030104874930707, 'recall': 0.31088333999684997, 'f1-score': 0.3002398642719242, 'support': 82539}, 'accuracy': 0.3892213354490382, 'macro avg': {'precision': 0.3591735123705215, 'recall': 0.35618922904083555, 'f1-score': 0.35492573765940333, 'support': 297458}, 'weighted avg': {'precision': 0.3809909271927949, 'recall': 0.3892213354490382, 'f1-score': 0.3826332894314418, 'support': 297458}}
[[17883 38325 22665]
 [23746 72234 40066]
 [16036 40843 25660]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884578
{'0': {'precision': 0.3899647090761017, 'recall': 0.30442921729302064, 'f1-score': 0.34192882929345025, 'support': 28312}, '1': {'precision': 0.3878185745140389, 'recall': 0.47574804818596106, 'f1-score': 0.4273067648178703, 'support': 28307}, '2': {'precision': 0.3631470753130256, 'recall': 0.3603456588658532, 'f1-score': 0.36174094344540003, 'support': 26963}, 'accuracy': 0.38048862195209493, 'macro avg': {'precision': 0.38031011963438877, 'recall': 0.38017430811494496, 'f1-score': 0.3769921791855735, 'support': 83582}, 'weighted avg': {'precision': 0.3805866792347228, 'recall': 0.38048862195209493, 'f1-score': 0.3772353217771044, 'support': 83582}}
[[ 8619 10744  8949]
 [ 6750 13467  8090]
 [ 6733 10514  9716]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958223
{'0': {'precision': 0.3377749842866122, 'recall': 0.27149641305446093, 'f1-score': 0.3010306968406901, 'support': 9897}, '1': {'precision': 0.40444325481798715, 'recall': 0.5041708375041708, 'f1-score': 0.44883410069805435, 'support': 11988}, '2': {'precision': 0.3350950185539188, 'recall': 0.3007974159685071, 'f1-score': 0.3170212765957447, 'support': 9907}, 'accuracy': 0.36836311021640666, 'macro avg': {'precision': 0.35910441921950603, 'recall': 0.3588215555090463, 'f1-score': 0.35562869137816305, 'support': 31792}, 'weighted avg': {'precision': 0.36207885968345194, 'recall': 0.36836311021640666, 'f1-score': 0.36174678513571423, 'support': 31792}}
[[2687 4414 2796]
 [2827 6044 3117]
 [2441 4486 2980]]
training model: results/XRAY/W8/deepOF_L2/h500
Epoch 1/50
327/327 - 12s - loss: 3.3402 - accuracy500: 0.3469 - val_loss: 3.3408 - val_accuracy500: 0.3197 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.3103 - accuracy500: 0.3603 - val_loss: 3.3190 - val_accuracy500: 0.3214 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 11s - loss: 3.2917 - accuracy500: 0.3675 - val_loss: 3.3089 - val_accuracy500: 0.3322 - 11s/epoch - 33ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2830 - accuracy500: 0.3742 - val_loss: 3.2968 - val_accuracy500: 0.3435 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2740 - accuracy500: 0.3806 - val_loss: 3.2915 - val_accuracy500: 0.3535 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2664 - accuracy500: 0.3830 - val_loss: 3.2820 - val_accuracy500: 0.3691 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2597 - accuracy500: 0.3897 - val_loss: 3.2803 - val_accuracy500: 0.3747 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2550 - accuracy500: 0.3918 - val_loss: 3.2767 - val_accuracy500: 0.3823 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2494 - accuracy500: 0.3924 - val_loss: 3.2779 - val_accuracy500: 0.3818 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2436 - accuracy500: 0.3980 - val_loss: 3.2766 - val_accuracy500: 0.3844 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2398 - accuracy500: 0.4000 - val_loss: 3.2765 - val_accuracy500: 0.3843 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2347 - accuracy500: 0.4027 - val_loss: 3.2761 - val_accuracy500: 0.3861 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2305 - accuracy500: 0.4040 - val_loss: 3.2760 - val_accuracy500: 0.3904 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2261 - accuracy500: 0.4079 - val_loss: 3.2791 - val_accuracy500: 0.3884 - 10s/epoch - 31ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2226 - accuracy500: 0.4061 - val_loss: 3.2814 - val_accuracy500: 0.3872 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2165 - accuracy500: 0.4118 - val_loss: 3.2820 - val_accuracy500: 0.3876 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 3.2127 - accuracy500: 0.4126 - val_loss: 3.2825 - val_accuracy500: 0.3866 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 3.2086 - accuracy500: 0.4156 - val_loss: 3.2862 - val_accuracy500: 0.3844 - 10s/epoch - 31ms/step
Epoch 19/50
327/327 - 10s - loss: 3.2006 - accuracy500: 0.4211 - val_loss: 3.2916 - val_accuracy500: 0.3870 - 10s/epoch - 31ms/step
Epoch 20/50
327/327 - 10s - loss: 3.1967 - accuracy500: 0.4221 - val_loss: 3.2944 - val_accuracy500: 0.3838 - 10s/epoch - 31ms/step
Epoch 21/50
327/327 - 10s - loss: 3.1926 - accuracy500: 0.4253 - val_loss: 3.2983 - val_accuracy500: 0.3845 - 10s/epoch - 31ms/step
Epoch 22/50
327/327 - 10s - loss: 3.1854 - accuracy500: 0.4271 - val_loss: 3.3012 - val_accuracy500: 0.3849 - 10s/epoch - 31ms/step
Epoch 23/50
327/327 - 10s - loss: 3.1791 - accuracy500: 0.4302 - val_loss: 3.3080 - val_accuracy500: 0.3847 - 10s/epoch - 32ms/step
testing model: results/XRAY/W8/deepOF_L2/h500
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0743207
{'0': {'precision': 0.28737611288426, 'recall': 0.18644252513418522, 'f1-score': 0.2261588036024126, 'support': 73406}, '1': {'precision': 0.5059731985179542, 'recall': 0.7034759762857811, 'f1-score': 0.5885985078448918, 'support': 145398}, '2': {'precision': 0.2796082296931692, 'recall': 0.1695018689449996, 'f1-score': 0.21105790161079668, 'support': 78654}, 'accuracy': 0.43468993942001893, 'macro avg': {'precision': 0.3576525136984611, 'recall': 0.35314012345498863, 'f1-score': 0.34193840435270034, 'support': 297458}, 'weighted avg': {'precision': 0.3921727697987011, 'recall': 0.43468993942001893, 'f1-score': 0.3993269879249033, 'support': 297458}}
[[ 13686  48027  11693]
 [ 20458 102284  22656]
 [ 13480  51842  13332]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0794097
{'0': {'precision': 0.3997390606182256, 'recall': 0.28357837029653626, 'f1-score': 0.3317853349715738, 'support': 28091}, '1': {'precision': 0.40055578472026226, 'recall': 0.6374378109452736, 'f1-score': 0.49196720218652085, 'support': 28944}, '2': {'precision': 0.3918035582333883, 'recall': 0.2596526914528949, 'f1-score': 0.312324422292705, 'support': 26547}, 'accuracy': 0.3985188198415927, 'macro avg': {'precision': 0.39736613452395875, 'recall': 0.3935562908982349, 'f1-score': 0.37869231981693324, 'support': 83582}, 'weighted avg': {'precision': 0.397501443435089, 'recall': 0.3985188198415927, 'f1-score': 0.38107435791650807, 'support': 83582}}
[[ 7966 14244  5881]
 [ 5675 18450  4819]
 [ 6287 13367  6893]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935551
{'0': {'precision': 0.32297194844579225, 'recall': 0.21911325995267977, 'f1-score': 0.2610934052463839, 'support': 9721}, '1': {'precision': 0.41738153594771243, 'recall': 0.6574967824967825, 'f1-score': 0.5106196901549226, 'support': 12432}, '2': {'precision': 0.3443791199002316, 'recall': 0.20053947504927896, 'f1-score': 0.25347495410437976, 'support': 9639}, 'accuracy': 0.384908152994464, 'macro avg': {'precision': 0.3615775347645787, 'recall': 0.3590498391662471, 'f1-score': 0.34172934983522874, 'support': 31792}, 'weighted avg': {'precision': 0.3663804700069778, 'recall': 0.384908152994464, 'f1-score': 0.35635877148396494, 'support': 31792}}
[[2130 5925 1666]
 [2244 8174 2014]
 [2221 5485 1933]]
training model: results/XRAY/W8/deepOF_L2/h1000
Epoch 1/50
327/327 - 12s - loss: 3.3447 - accuracy1000: 0.3478 - val_loss: 3.3753 - val_accuracy1000: 0.3102 - 12s/epoch - 38ms/step
Epoch 2/50
327/327 - 10s - loss: 3.3153 - accuracy1000: 0.3539 - val_loss: 3.3641 - val_accuracy1000: 0.3109 - 10s/epoch - 31ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2976 - accuracy1000: 0.3622 - val_loss: 3.3417 - val_accuracy1000: 0.3203 - 10s/epoch - 31ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2898 - accuracy1000: 0.3662 - val_loss: 3.3342 - val_accuracy1000: 0.3263 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2833 - accuracy1000: 0.3718 - val_loss: 3.3269 - val_accuracy1000: 0.3339 - 10s/epoch - 31ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2778 - accuracy1000: 0.3739 - val_loss: 3.3138 - val_accuracy1000: 0.3486 - 10s/epoch - 31ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2708 - accuracy1000: 0.3790 - val_loss: 3.3150 - val_accuracy1000: 0.3515 - 10s/epoch - 31ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2669 - accuracy1000: 0.3825 - val_loss: 3.3073 - val_accuracy1000: 0.3640 - 10s/epoch - 31ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2611 - accuracy1000: 0.3846 - val_loss: 3.3029 - val_accuracy1000: 0.3712 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2567 - accuracy1000: 0.3868 - val_loss: 3.2988 - val_accuracy1000: 0.3804 - 10s/epoch - 31ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2530 - accuracy1000: 0.3897 - val_loss: 3.2916 - val_accuracy1000: 0.3869 - 10s/epoch - 31ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2494 - accuracy1000: 0.3904 - val_loss: 3.2942 - val_accuracy1000: 0.3887 - 10s/epoch - 31ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2437 - accuracy1000: 0.3942 - val_loss: 3.2888 - val_accuracy1000: 0.3898 - 10s/epoch - 31ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2398 - accuracy1000: 0.3965 - val_loss: 3.2934 - val_accuracy1000: 0.3901 - 10s/epoch - 32ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2365 - accuracy1000: 0.3992 - val_loss: 3.2946 - val_accuracy1000: 0.3893 - 10s/epoch - 31ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2317 - accuracy1000: 0.4013 - val_loss: 3.2960 - val_accuracy1000: 0.3881 - 10s/epoch - 31ms/step
Epoch 17/50
327/327 - 10s - loss: 3.2275 - accuracy1000: 0.4043 - val_loss: 3.3000 - val_accuracy1000: 0.3824 - 10s/epoch - 31ms/step
Epoch 18/50
327/327 - 10s - loss: 3.2226 - accuracy1000: 0.4074 - val_loss: 3.3020 - val_accuracy1000: 0.3863 - 10s/epoch - 31ms/step
Epoch 19/50
327/327 - 10s - loss: 3.2188 - accuracy1000: 0.4084 - val_loss: 3.3051 - val_accuracy1000: 0.3853 - 10s/epoch - 32ms/step
Epoch 20/50
327/327 - 10s - loss: 3.2135 - accuracy1000: 0.4108 - val_loss: 3.3049 - val_accuracy1000: 0.3841 - 10s/epoch - 31ms/step
Epoch 21/50
327/327 - 10s - loss: 3.2077 - accuracy1000: 0.4151 - val_loss: 3.3080 - val_accuracy1000: 0.3810 - 10s/epoch - 31ms/step
Epoch 22/50
327/327 - 10s - loss: 3.2037 - accuracy1000: 0.4168 - val_loss: 3.3100 - val_accuracy1000: 0.3859 - 10s/epoch - 31ms/step
Epoch 23/50
327/327 - 10s - loss: 3.1975 - accuracy1000: 0.4180 - val_loss: 3.3196 - val_accuracy1000: 0.3837 - 10s/epoch - 31ms/step
testing model: results/XRAY/W8/deepOF_L2/h1000
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0665818
{'0': {'precision': 0.2874378283362963, 'recall': 0.1975129021631712, 'f1-score': 0.23413792822915905, 'support': 72856}, '1': {'precision': 0.5273060158642896, 'recall': 0.7324201971719596, 'f1-score': 0.6131643084228972, 'support': 146674}, '2': {'precision': 0.295898504591568, 'recall': 0.16580689867570064, 'f1-score': 0.21252518606850612, 'support': 77928}, 'accuracy': 0.45296478830624826, 'macro avg': {'precision': 0.3702141162640513, 'recall': 0.36524666600361044, 'f1-score': 0.3532758075735208, 'support': 297458}, 'weighted avg': {'precision': 0.40793131016129913, 'recall': 0.45296478830624826, 'f1-score': 0.4153704972555123, 'support': 297458}}
[[ 14390  46194  12272]
 [ 20773 107427  18474]
 [ 14900  50107  12921]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0834541
{'0': {'precision': 0.40681304953634745, 'recall': 0.2839845715244005, 'f1-score': 0.3344789444576124, 'support': 29815}, '1': {'precision': 0.3790497737556561, 'recall': 0.6176362161763621, 'f1-score': 0.4697866135770967, 'support': 27126}, '2': {'precision': 0.3844041143841887, 'recall': 0.2679328854021996, 'f1-score': 0.3157708471577084, 'support': 26641}, 'accuracy': 0.3871527362350745, 'macro avg': {'precision': 0.3900889792253974, 'recall': 0.3898512243676541, 'f1-score': 0.37334546839747257, 'support': 83582}, 'weighted avg': {'precision': 0.390660013473371, 'recall': 0.3871527362350745, 'f1-score': 0.3724291420165173, 'support': 83582}}
[[ 8467 14631  6717]
 [ 5658 16754  4714]
 [ 6688 12815  7138]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0921667
{'0': {'precision': 0.3167197913648218, 'recall': 0.22557011660303375, 'f1-score': 0.2634846019405773, 'support': 9691}, '1': {'precision': 0.4304601017785006, 'recall': 0.6456054764340231, 'f1-score': 0.5165250236071766, 'support': 12709}, '2': {'precision': 0.3343626694115629, 'recall': 0.20751703577512776, 'f1-score': 0.2560935549569674, 'support': 9392}, 'accuracy': 0.388147961751384, 'macro avg': {'precision': 0.3605141875182951, 'recall': 0.3595642096040615, 'f1-score': 0.3453677268349071, 'support': 31792}, 'weighted avg': {'precision': 0.36740007306029354, 'recall': 0.388147961751384, 'f1-score': 0.3624552236595867, 'support': 31792}}
[[2186 5731 1774]
 [2398 8205 2106]
 [2318 5125 1949]]
training model: results/XRAY/W8/deepVOL_L2/h10
Epoch 1/50
327/327 - 12s - loss: 3.2933 - accuracy10: 0.3826 - val_loss: 3.3041 - val_accuracy10: 0.3836 - 12s/epoch - 38ms/step
Epoch 2/50
327/327 - 10s - loss: 3.1987 - accuracy10: 0.4225 - val_loss: 3.2041 - val_accuracy10: 0.4094 - 10s/epoch - 29ms/step
Epoch 3/50
327/327 - 10s - loss: 3.1484 - accuracy10: 0.4399 - val_loss: 3.1653 - val_accuracy10: 0.4220 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.1203 - accuracy10: 0.4527 - val_loss: 3.1353 - val_accuracy10: 0.4331 - 10s/epoch - 29ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1035 - accuracy10: 0.4602 - val_loss: 3.1309 - val_accuracy10: 0.4412 - 10s/epoch - 29ms/step
Epoch 6/50
327/327 - 10s - loss: 3.0920 - accuracy10: 0.4648 - val_loss: 3.1145 - val_accuracy10: 0.4412 - 10s/epoch - 30ms/step
Epoch 7/50
327/327 - 10s - loss: 3.0861 - accuracy10: 0.4676 - val_loss: 3.1071 - val_accuracy10: 0.4417 - 10s/epoch - 29ms/step
Epoch 8/50
327/327 - 10s - loss: 3.0781 - accuracy10: 0.4699 - val_loss: 3.0776 - val_accuracy10: 0.4546 - 10s/epoch - 29ms/step
Epoch 9/50
327/327 - 10s - loss: 3.0664 - accuracy10: 0.4732 - val_loss: 3.0746 - val_accuracy10: 0.4594 - 10s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.0599 - accuracy10: 0.4762 - val_loss: 3.0512 - val_accuracy10: 0.4708 - 10s/epoch - 29ms/step
Epoch 11/50
327/327 - 10s - loss: 3.0513 - accuracy10: 0.4785 - val_loss: 3.0537 - val_accuracy10: 0.4673 - 10s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.0442 - accuracy10: 0.4802 - val_loss: 3.0390 - val_accuracy10: 0.4781 - 10s/epoch - 30ms/step
Epoch 13/50
327/327 - 10s - loss: 3.0363 - accuracy10: 0.4838 - val_loss: 3.0511 - val_accuracy10: 0.4740 - 10s/epoch - 30ms/step
Epoch 14/50
327/327 - 10s - loss: 3.0291 - accuracy10: 0.4852 - val_loss: 3.0276 - val_accuracy10: 0.4835 - 10s/epoch - 30ms/step
Epoch 15/50
327/327 - 10s - loss: 3.0259 - accuracy10: 0.4857 - val_loss: 3.0313 - val_accuracy10: 0.4818 - 10s/epoch - 30ms/step
Epoch 16/50
327/327 - 10s - loss: 3.0171 - accuracy10: 0.4900 - val_loss: 3.0507 - val_accuracy10: 0.4743 - 10s/epoch - 30ms/step
Epoch 17/50
327/327 - 10s - loss: 3.0132 - accuracy10: 0.4899 - val_loss: 3.0353 - val_accuracy10: 0.4822 - 10s/epoch - 30ms/step
Epoch 18/50
327/327 - 9s - loss: 3.0088 - accuracy10: 0.4906 - val_loss: 3.0316 - val_accuracy10: 0.4812 - 9s/epoch - 29ms/step
Epoch 19/50
327/327 - 10s - loss: 3.0018 - accuracy10: 0.4937 - val_loss: 3.0361 - val_accuracy10: 0.4785 - 10s/epoch - 29ms/step
Epoch 20/50
327/327 - 9s - loss: 2.9990 - accuracy10: 0.4945 - val_loss: 3.0304 - val_accuracy10: 0.4798 - 9s/epoch - 29ms/step
Epoch 21/50
327/327 - 9s - loss: 2.9911 - accuracy10: 0.4961 - val_loss: 3.0379 - val_accuracy10: 0.4819 - 9s/epoch - 29ms/step
Epoch 22/50
327/327 - 9s - loss: 2.9874 - accuracy10: 0.4987 - val_loss: 3.0432 - val_accuracy10: 0.4798 - 9s/epoch - 29ms/step
Epoch 23/50
327/327 - 10s - loss: 2.9827 - accuracy10: 0.4988 - val_loss: 3.0339 - val_accuracy10: 0.4815 - 10s/epoch - 29ms/step
Epoch 24/50
327/327 - 9s - loss: 2.9745 - accuracy10: 0.5023 - val_loss: 3.0379 - val_accuracy10: 0.4803 - 9s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h10
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94535834
{'0': {'precision': 0.44758557936682253, 'recall': 0.3751873964388101, 'f1-score': 0.4082012247467522, 'support': 76042}, '1': {'precision': 0.5961089408649118, 'recall': 0.7403697208327931, 'f1-score': 0.6604535078374677, 'support': 146543}, '2': {'precision': 0.43961016359206406, 'recall': 0.3036138785758167, 'f1-score': 0.3591696157735086, 'support': 74878}, 'accuracy': 0.5370751992684805, 'macro avg': {'precision': 0.49443489460793283, 'recall': 0.47305699861580663, 'f1-score': 0.4759414494525762, 'support': 297463}, 'weighted avg': {'precision': 0.5187469533247001, 'recall': 0.5370751992684805, 'f1-score': 0.5201291536127429, 'support': 297463}}
[[ 28530  35951  11561]
 [ 20628 108496  17419]
 [ 14584  37560  22734]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0286494
{'0': {'precision': 0.4704555705908886, 'recall': 0.48914141414141415, 'f1-score': 0.4796165614332963, 'support': 27720}, '1': {'precision': 0.45083168146169095, 'recall': 0.563665098236414, 'f1-score': 0.5009736632083001, 'support': 27841}, '2': {'precision': 0.4920809943865277, 'recall': 0.3503800720887906, 'f1-score': 0.40931357221770587, 'support': 28021}, 'accuracy': 0.46744514369122536, 'macro avg': {'precision': 0.4711227488130358, 'recall': 0.4677288614888729, 'f1-score': 0.4633012656197674, 'support': 83582}, 'weighted avg': {'precision': 0.47116884980090523, 'recall': 0.46744514369122536, 'f1-score': 0.4631613798117488, 'support': 83582}}
[[13559  9080  5081]
 [ 7095 15693  5053]
 [ 8167 10036  9818]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0090666
{'0': {'precision': 0.4608350776688333, 'recall': 0.42766588283406604, 'f1-score': 0.4436313500901474, 'support': 9781}, '1': {'precision': 0.49383030148836027, 'recall': 0.6458160039926801, 'f1-score': 0.5596885813148789, 'support': 12022}, '2': {'precision': 0.4927784927784928, 'recall': 0.34497947742516766, 'f1-score': 0.4058414792132847, 'support': 9989}, 'accuracy': 0.48417840966280823, 'macro avg': {'precision': 0.48248129064522877, 'recall': 0.4728204547506379, 'f1-score': 0.4697204702061037, 'support': 31792}, 'weighted avg': {'precision': 0.483348645682445, 'recall': 0.48417840966280823, 'f1-score': 0.47564434120724414, 'support': 31792}}
[[4183 3852 1746]
 [2457 7764 1801]
 [2437 4106 3446]]
training model: results/XRAY/W8/deepVOL_L2/h20
Epoch 1/50
327/327 - 12s - loss: 3.3109 - accuracy20: 0.3726 - val_loss: 3.2757 - val_accuracy20: 0.3865 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2390 - accuracy20: 0.4034 - val_loss: 3.2408 - val_accuracy20: 0.3964 - 10s/epoch - 29ms/step
Epoch 3/50
327/327 - 10s - loss: 3.1988 - accuracy20: 0.4195 - val_loss: 3.2198 - val_accuracy20: 0.3969 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.1789 - accuracy20: 0.4283 - val_loss: 3.1897 - val_accuracy20: 0.4160 - 10s/epoch - 29ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1641 - accuracy20: 0.4362 - val_loss: 3.1886 - val_accuracy20: 0.4147 - 10s/epoch - 29ms/step
Epoch 6/50
327/327 - 10s - loss: 3.1518 - accuracy20: 0.4405 - val_loss: 3.1758 - val_accuracy20: 0.4209 - 10s/epoch - 30ms/step
Epoch 7/50
327/327 - 10s - loss: 3.1463 - accuracy20: 0.4433 - val_loss: 3.1619 - val_accuracy20: 0.4290 - 10s/epoch - 30ms/step
Epoch 8/50
327/327 - 10s - loss: 3.1380 - accuracy20: 0.4457 - val_loss: 3.1499 - val_accuracy20: 0.4313 - 10s/epoch - 30ms/step
Epoch 9/50
327/327 - 10s - loss: 3.1338 - accuracy20: 0.4470 - val_loss: 3.1433 - val_accuracy20: 0.4365 - 10s/epoch - 30ms/step
Epoch 10/50
327/327 - 10s - loss: 3.1259 - accuracy20: 0.4498 - val_loss: 3.1333 - val_accuracy20: 0.4406 - 10s/epoch - 30ms/step
Epoch 11/50
327/327 - 10s - loss: 3.1194 - accuracy20: 0.4527 - val_loss: 3.1341 - val_accuracy20: 0.4371 - 10s/epoch - 30ms/step
Epoch 12/50
327/327 - 10s - loss: 3.1150 - accuracy20: 0.4551 - val_loss: 3.1287 - val_accuracy20: 0.4441 - 10s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.1116 - accuracy20: 0.4580 - val_loss: 3.1290 - val_accuracy20: 0.4454 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1056 - accuracy20: 0.4584 - val_loss: 3.1190 - val_accuracy20: 0.4517 - 10s/epoch - 30ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1014 - accuracy20: 0.4591 - val_loss: 3.1201 - val_accuracy20: 0.4475 - 10s/epoch - 29ms/step
Epoch 16/50
327/327 - 10s - loss: 3.0967 - accuracy20: 0.4611 - val_loss: 3.1283 - val_accuracy20: 0.4466 - 10s/epoch - 29ms/step
Epoch 17/50
327/327 - 9s - loss: 3.0938 - accuracy20: 0.4615 - val_loss: 3.1320 - val_accuracy20: 0.4473 - 9s/epoch - 29ms/step
Epoch 18/50
327/327 - 10s - loss: 3.0867 - accuracy20: 0.4651 - val_loss: 3.1306 - val_accuracy20: 0.4466 - 10s/epoch - 29ms/step
Epoch 19/50
327/327 - 10s - loss: 3.0850 - accuracy20: 0.4662 - val_loss: 3.1420 - val_accuracy20: 0.4431 - 10s/epoch - 29ms/step
Epoch 20/50
327/327 - 10s - loss: 3.0797 - accuracy20: 0.4686 - val_loss: 3.1437 - val_accuracy20: 0.4487 - 10s/epoch - 30ms/step
Epoch 21/50
327/327 - 10s - loss: 3.0745 - accuracy20: 0.4708 - val_loss: 3.1496 - val_accuracy20: 0.4446 - 10s/epoch - 29ms/step
Epoch 22/50
327/327 - 9s - loss: 3.0720 - accuracy20: 0.4701 - val_loss: 3.1493 - val_accuracy20: 0.4465 - 9s/epoch - 29ms/step
Epoch 23/50
327/327 - 10s - loss: 3.0653 - accuracy20: 0.4719 - val_loss: 3.1549 - val_accuracy20: 0.4473 - 10s/epoch - 29ms/step
Epoch 24/50
327/327 - 9s - loss: 3.0631 - accuracy20: 0.4730 - val_loss: 3.1565 - val_accuracy20: 0.4502 - 9s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h20
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98821735
{'0': {'precision': 0.43552889469620476, 'recall': 0.2870470648103446, 'f1-score': 0.3460322453794731, 'support': 76639}, '1': {'precision': 0.5468967436682438, 'recall': 0.7041312062846707, 'f1-score': 0.6156330301761404, 'support': 145115}, '2': {'precision': 0.37761993479273404, 'recall': 0.2998454609095352, 'f1-score': 0.33426836002208726, 'support': 75709}, 'accuracy': 0.4937756964731748, 'macro avg': {'precision': 0.45334852438572754, 'recall': 0.43034124400151685, 'f1-score': 0.43197787852590025, 'support': 297463}, 'weighted avg': {'precision': 0.4751200907718363, 'recall': 0.4937756964731748, 'f1-score': 0.4745607880528343, 'support': 297463}}
[[ 21999  41445  13195]
 [ 18715 102180  24220]
 [  9797  43211  22701]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0492407
{'0': {'precision': 0.46897087061322873, 'recall': 0.41367256477710906, 'f1-score': 0.43958947650595487, 'support': 27749}, '1': {'precision': 0.4152900499423742, 'recall': 0.5429432446007032, 'f1-score': 0.4706138441445364, 'support': 27874}, '2': {'precision': 0.45629440056479725, 'recall': 0.3698630136986301, 'f1-score': 0.40855754415076445, 'support': 27959}, 'accuracy': 0.44212868799502286, 'macro avg': {'precision': 0.44685177370680007, 'recall': 0.44215960769214746, 'f1-score': 0.4395869549337519, 'support': 83582}, 'weighted avg': {'precision': 0.44682829659653256, 'recall': 0.44212868799502286, 'f1-score': 0.4395553953262637, 'support': 83582}}
[[11479 10260  6010]
 [ 6428 15134  6312]
 [ 6570 11048 10341]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0398088
{'0': {'precision': 0.44359861591695504, 'recall': 0.3914105434561368, 'f1-score': 0.41587370242214533, 'support': 9826}, '1': {'precision': 0.4508844070230403, 'recall': 0.5774471286466606, 'f1-score': 0.5063773640228706, 'support': 11963}, '2': {'precision': 0.45481348545058325, 'recall': 0.3546935919224233, 'f1-score': 0.3985621208717142, 'support': 10003}, 'accuracy': 0.449861600402617, 'macro avg': {'precision': 0.4497655027968595, 'recall': 0.4411837546750736, 'f1-score': 0.44027106243891007, 'support': 31792}, 'weighted avg': {'precision': 0.44986881782142724, 'recall': 0.449861600402617, 'f1-score': 0.44448239496997227, 'support': 31792}}
[[3846 4035 1945]
 [2747 6908 2308]
 [2077 4378 3548]]
training model: results/XRAY/W8/deepVOL_L2/h30
Epoch 1/50
327/327 - 13s - loss: 3.3226 - accuracy30: 0.3633 - val_loss: 3.2998 - val_accuracy30: 0.3680 - 13s/epoch - 39ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2515 - accuracy30: 0.3907 - val_loss: 3.2508 - val_accuracy30: 0.3805 - 10s/epoch - 30ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2195 - accuracy30: 0.4099 - val_loss: 3.2398 - val_accuracy30: 0.3856 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2048 - accuracy30: 0.4171 - val_loss: 3.2270 - val_accuracy30: 0.3890 - 10s/epoch - 30ms/step
Epoch 5/50
327/327 - 10s - loss: 3.1943 - accuracy30: 0.4226 - val_loss: 3.2158 - val_accuracy30: 0.3958 - 10s/epoch - 30ms/step
Epoch 6/50
327/327 - 10s - loss: 3.1873 - accuracy30: 0.4263 - val_loss: 3.2041 - val_accuracy30: 0.3977 - 10s/epoch - 30ms/step
Epoch 7/50
327/327 - 9s - loss: 3.1806 - accuracy30: 0.4262 - val_loss: 3.2063 - val_accuracy30: 0.4007 - 9s/epoch - 29ms/step
Epoch 8/50
327/327 - 17s - loss: 3.1731 - accuracy30: 0.4314 - val_loss: 3.1960 - val_accuracy30: 0.4104 - 17s/epoch - 51ms/step
Epoch 9/50
327/327 - 10s - loss: 3.1659 - accuracy30: 0.4358 - val_loss: 3.1959 - val_accuracy30: 0.4067 - 10s/epoch - 31ms/step
Epoch 10/50
327/327 - 9s - loss: 3.1635 - accuracy30: 0.4374 - val_loss: 3.1997 - val_accuracy30: 0.4011 - 9s/epoch - 29ms/step
Epoch 11/50
327/327 - 9s - loss: 3.1560 - accuracy30: 0.4383 - val_loss: 3.1988 - val_accuracy30: 0.4112 - 9s/epoch - 29ms/step
Epoch 12/50
327/327 - 9s - loss: 3.1529 - accuracy30: 0.4407 - val_loss: 3.2000 - val_accuracy30: 0.4102 - 9s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.1457 - accuracy30: 0.4433 - val_loss: 3.1958 - val_accuracy30: 0.4068 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1400 - accuracy30: 0.4460 - val_loss: 3.2021 - val_accuracy30: 0.4095 - 10s/epoch - 29ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1372 - accuracy30: 0.4475 - val_loss: 3.2010 - val_accuracy30: 0.4070 - 10s/epoch - 29ms/step
Epoch 16/50
327/327 - 9s - loss: 3.1335 - accuracy30: 0.4504 - val_loss: 3.2031 - val_accuracy30: 0.4120 - 9s/epoch - 29ms/step
Epoch 17/50
327/327 - 9s - loss: 3.1282 - accuracy30: 0.4499 - val_loss: 3.2147 - val_accuracy30: 0.4069 - 9s/epoch - 29ms/step
Epoch 18/50
327/327 - 9s - loss: 3.1234 - accuracy30: 0.4544 - val_loss: 3.2108 - val_accuracy30: 0.4111 - 9s/epoch - 29ms/step
Epoch 19/50
327/327 - 9s - loss: 3.1204 - accuracy30: 0.4544 - val_loss: 3.2173 - val_accuracy30: 0.4076 - 9s/epoch - 29ms/step
Epoch 20/50
327/327 - 10s - loss: 3.1146 - accuracy30: 0.4548 - val_loss: 3.2218 - val_accuracy30: 0.4103 - 10s/epoch - 29ms/step
Epoch 21/50
327/327 - 9s - loss: 3.1104 - accuracy30: 0.4574 - val_loss: 3.2169 - val_accuracy30: 0.4109 - 9s/epoch - 29ms/step
Epoch 22/50
327/327 - 9s - loss: 3.1050 - accuracy30: 0.4588 - val_loss: 3.2226 - val_accuracy30: 0.4124 - 9s/epoch - 29ms/step
Epoch 23/50
327/327 - 10s - loss: 3.1031 - accuracy30: 0.4610 - val_loss: 3.2426 - val_accuracy30: 0.4078 - 10s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h30
Evaluating performance on  test set...
1162/1162 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0246165
{'0': {'precision': 0.4256528970198229, 'recall': 0.23908652510919787, 'f1-score': 0.3061887670967116, 'support': 79214}, '1': {'precision': 0.48722247287061005, 'recall': 0.7371862582365072, 'f1-score': 0.5866892363295323, 'support': 139167}, '2': {'precision': 0.35718328459579285, 'recall': 0.19152272324928554, 'f1-score': 0.24934560360864627, 'support': 79082}, 'accuracy': 0.4594756322635084, 'macro avg': {'precision': 0.42335288482874195, 'recall': 0.38926516886499685, 'f1-score': 0.3807412023449634, 'support': 297463}, 'weighted avg': {'precision': 0.43625501988118504, 'recall': 0.4594756322635084, 'f1-score': 0.42230787349569493, 'support': 297463}}
[[ 18939  52541   7734]
 [ 17051 102592  19524]
 [  8504  55432  15146]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0700004
{'0': {'precision': 0.4673665876433306, 'recall': 0.3430154108372985, 'f1-score': 0.395650304110094, 'support': 28162}, '1': {'precision': 0.3630209824532701, 'recall': 0.6551393245986344, 'f1-score': 0.4671746081875962, 'support': 27095}, '2': {'precision': 0.46478772743489116, 'recall': 0.22997352162400705, 'f1-score': 0.30769957487009914, 'support': 28325}, 'accuracy': 0.4058888277380297, 'macro avg': {'precision': 0.43172509917716395, 'recall': 0.40937608568664663, 'f1-score': 0.39017482905592976, 'support': 83582}, 'weighted avg': {'precision': 0.43266664760805107, 'recall': 0.4058888277380297, 'f1-score': 0.38903101542661034, 'support': 83582}}
[[ 9660 14797  3705]
 [ 5548 17751  3796]
 [ 5461 16350  6514]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661937
{'0': {'precision': 0.4275053304904051, 'recall': 0.31787554498612763, 'f1-score': 0.3646283246192316, 'support': 10092}, '1': {'precision': 0.3899818323384376, 'recall': 0.6520003471318233, 'f1-score': 0.48804729115239703, 'support': 11523}, '2': {'precision': 0.4459486362731435, 'recall': 0.22010415643116832, 'f1-score': 0.29473684210526313, 'support': 10177}, 'accuracy': 0.4076811776547559, 'macro avg': {'precision': 0.42114526636732874, 'recall': 0.39666001618303975, 'f1-score': 0.38247081929229726, 'support': 31792}, 'weighted avg': {'precision': 0.41980887395246497, 'recall': 0.4076811776547559, 'f1-score': 0.386988387962746, 'support': 31792}}
[[3208 5686 1198]
 [2425 7513 1585]
 [1871 6066 2240]]
training model: results/XRAY/W8/deepVOL_L2/h50
Epoch 1/50
327/327 - 12s - loss: 3.3225 - accuracy50: 0.3631 - val_loss: 3.3219 - val_accuracy50: 0.3672 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2727 - accuracy50: 0.3780 - val_loss: 3.2850 - val_accuracy50: 0.3721 - 10s/epoch - 30ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2497 - accuracy50: 0.3929 - val_loss: 3.2746 - val_accuracy50: 0.3775 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2371 - accuracy50: 0.3984 - val_loss: 3.2756 - val_accuracy50: 0.3767 - 10s/epoch - 29ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2327 - accuracy50: 0.4034 - val_loss: 3.2644 - val_accuracy50: 0.3759 - 10s/epoch - 29ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2262 - accuracy50: 0.4060 - val_loss: 3.2546 - val_accuracy50: 0.3804 - 10s/epoch - 29ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2209 - accuracy50: 0.4075 - val_loss: 3.2429 - val_accuracy50: 0.3866 - 10s/epoch - 29ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2170 - accuracy50: 0.4089 - val_loss: 3.2479 - val_accuracy50: 0.3891 - 10s/epoch - 29ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2081 - accuracy50: 0.4139 - val_loss: 3.2707 - val_accuracy50: 0.3842 - 10s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2055 - accuracy50: 0.4161 - val_loss: 3.2550 - val_accuracy50: 0.3852 - 10s/epoch - 29ms/step
Epoch 11/50
327/327 - 9s - loss: 3.1988 - accuracy50: 0.4208 - val_loss: 3.2482 - val_accuracy50: 0.3914 - 9s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.1930 - accuracy50: 0.4225 - val_loss: 3.2555 - val_accuracy50: 0.3917 - 10s/epoch - 29ms/step
Epoch 13/50
327/327 - 9s - loss: 3.1876 - accuracy50: 0.4260 - val_loss: 3.2737 - val_accuracy50: 0.3897 - 9s/epoch - 29ms/step
Epoch 14/50
327/327 - 9s - loss: 3.1846 - accuracy50: 0.4255 - val_loss: 3.2660 - val_accuracy50: 0.3901 - 9s/epoch - 29ms/step
Epoch 15/50
327/327 - 9s - loss: 3.1815 - accuracy50: 0.4274 - val_loss: 3.2687 - val_accuracy50: 0.3914 - 9s/epoch - 29ms/step
Epoch 16/50
327/327 - 9s - loss: 3.1745 - accuracy50: 0.4319 - val_loss: 3.2732 - val_accuracy50: 0.3912 - 9s/epoch - 29ms/step
Epoch 17/50
327/327 - 9s - loss: 3.1702 - accuracy50: 0.4329 - val_loss: 3.2810 - val_accuracy50: 0.3906 - 9s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h50
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0429854
{'0': {'precision': 0.37522947810123264, 'recall': 0.14683960025144646, 'f1-score': 0.21107760965579558, 'support': 77949}, '1': {'precision': 0.48498411135478675, 'recall': 0.8474773903645981, 'f1-score': 0.6169229933155808, 'support': 140648}, '2': {'precision': 0.33517417162276975, 'recall': 0.09003879998985621, 'f1-score': 0.14194618798224923, 'support': 78866}, 'accuracy': 0.46305927123709506, 'macro avg': {'precision': 0.398462587026263, 'recall': 0.361451930201967, 'f1-score': 0.3233155969845419, 'support': 297463}, 'weighted avg': {'precision': 0.41650441937835087, 'recall': 0.46305927123709506, 'f1-score': 0.3846428020302272, 'support': 297463}}
[[ 11446  62250   4253]
 [ 11620 119196   9832]
 [  7438  64327   7101]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879335
{'0': {'precision': 0.44855336271316343, 'recall': 0.16748944694855836, 'f1-score': 0.24390498020420923, 'support': 27954}, '1': {'precision': 0.35914859437751007, 'recall': 0.8040640172630822, 'f1-score': 0.49651879407029037, 'support': 27805}, '2': {'precision': 0.42785019276666053, 'recall': 0.16752327211300003, 'f1-score': 0.2407727871477645, 'support': 27823}, 'accuracy': 0.3792682635017109, 'macro avg': {'precision': 0.4118507166191114, 'recall': 0.37969224544154684, 'f1-score': 0.32706552047408805, 'support': 83582}, 'weighted avg': {'precision': 0.4119195913150826, 'recall': 0.3792682635017109, 'f1-score': 0.326898688025713, 'support': 83582}}
[[ 4682 19820  3452]
 [ 2667 22357  2781]
 [ 3089 20073  4661]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814763
{'0': {'precision': 0.40653836013709466, 'recall': 0.15375411307209094, 'f1-score': 0.22312255824048619, 'support': 10029}, '1': {'precision': 0.3796300077592192, 'recall': 0.8044305988231222, 'f1-score': 0.5158283161778986, 'support': 11556}, '2': {'precision': 0.42739179954441914, 'recall': 0.14705594200058783, 'f1-score': 0.21882061374735767, 'support': 10207}, 'accuracy': 0.3881165072974333, 'macro avg': {'precision': 0.4045200558135777, 'recall': 0.3684135512986004, 'f1-score': 0.3192571627219141, 'support': 31792}, 'weighted avg': {'precision': 0.40345261957191575, 'recall': 0.3881165072974333, 'f1-score': 0.32813632872624915, 'support': 31792}}
[[1542 7489  998]
 [1247 9296 1013]
 [1004 7702 1501]]
training model: results/XRAY/W8/deepVOL_L2/h100
Epoch 1/50
327/327 - 12s - loss: 3.3338 - accuracy100: 0.3584 - val_loss: 3.2800 - val_accuracy100: 0.4072 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2919 - accuracy100: 0.3673 - val_loss: 3.2611 - val_accuracy100: 0.4000 - 10s/epoch - 30ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2742 - accuracy100: 0.3775 - val_loss: 3.2308 - val_accuracy100: 0.4166 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2533 - accuracy100: 0.3891 - val_loss: 3.2214 - val_accuracy100: 0.4152 - 10s/epoch - 29ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2471 - accuracy100: 0.3911 - val_loss: 3.2147 - val_accuracy100: 0.4188 - 10s/epoch - 29ms/step
Epoch 6/50
327/327 - 9s - loss: 3.2389 - accuracy100: 0.3942 - val_loss: 3.2159 - val_accuracy100: 0.4168 - 9s/epoch - 29ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2318 - accuracy100: 0.3974 - val_loss: 3.2140 - val_accuracy100: 0.4172 - 10s/epoch - 29ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2236 - accuracy100: 0.4009 - val_loss: 3.2244 - val_accuracy100: 0.4162 - 10s/epoch - 29ms/step
Epoch 9/50
327/327 - 9s - loss: 3.2213 - accuracy100: 0.4039 - val_loss: 3.2281 - val_accuracy100: 0.4085 - 9s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2147 - accuracy100: 0.4069 - val_loss: 3.2360 - val_accuracy100: 0.4084 - 10s/epoch - 30ms/step
Epoch 11/50
327/327 - 9s - loss: 3.2091 - accuracy100: 0.4098 - val_loss: 3.2384 - val_accuracy100: 0.4091 - 9s/epoch - 29ms/step
Epoch 12/50
327/327 - 9s - loss: 3.2064 - accuracy100: 0.4119 - val_loss: 3.2518 - val_accuracy100: 0.4087 - 9s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2007 - accuracy100: 0.4112 - val_loss: 3.2610 - val_accuracy100: 0.4069 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 9s - loss: 3.1980 - accuracy100: 0.4156 - val_loss: 3.2848 - val_accuracy100: 0.4064 - 9s/epoch - 29ms/step
Epoch 15/50
327/327 - 9s - loss: 3.1915 - accuracy100: 0.4168 - val_loss: 3.2990 - val_accuracy100: 0.4021 - 9s/epoch - 29ms/step
Epoch 16/50
327/327 - 10s - loss: 3.1875 - accuracy100: 0.4204 - val_loss: 3.2728 - val_accuracy100: 0.4051 - 10s/epoch - 29ms/step
Epoch 17/50
327/327 - 9s - loss: 3.1837 - accuracy100: 0.4227 - val_loss: 3.2807 - val_accuracy100: 0.4050 - 9s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h100
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0115782
{'0': {'precision': 0.2989891379418597, 'recall': 0.07309959474395186, 'f1-score': 0.11747727300761063, 'support': 65144}, '1': {'precision': 0.5665772010735871, 'recall': 0.8648447326324016, 'f1-score': 0.684635740783257, 'support': 163782}, '2': {'precision': 0.2923603843592427, 'recall': 0.13451128587478298, 'f1-score': 0.18425102428300189, 'support': 68537}, 'accuracy': 0.5231810342798936, 'macro avg': {'precision': 0.3859755744582299, 'recall': 0.3574852044170455, 'f1-score': 0.3287880126912898, 'support': 297463}, 'weighted avg': {'precision': 0.4447948121653724, 'recall': 0.5231810342798936, 'f1-score': 0.4451375896197351, 'support': 297463}}
[[  4762  53361   7021]
 [  6843 141646  15293]
 [  4322  54996   9219]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0910873
{'0': {'precision': 0.42727427019687714, 'recall': 0.1786854993257151, 'f1-score': 0.2519893899204244, 'support': 28178}, '1': {'precision': 0.36525797167433616, 'recall': 0.8144079472119499, 'f1-score': 0.5043275221427689, 'support': 27582}, '2': {'precision': 0.41159335857850277, 'recall': 0.15236144058658616, 'f1-score': 0.22239710395844808, 'support': 27822}, 'accuracy': 0.3797109425474384, 'macro avg': {'precision': 0.40137520014990535, 'recall': 0.38181829570808373, 'f1-score': 0.32623800534054714, 'support': 83582}, 'weighted avg': {'precision': 0.4015892199600422, 'recall': 0.3797109425474384, 'f1-score': 0.32541038706003106, 'support': 83582}}
[[ 5035 19681  3462]
 [ 2521 22463  2598]
 [ 4228 19355  4239]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0720123
{'0': {'precision': 0.3691844553913519, 'recall': 0.14168679760529357, 'f1-score': 0.2047817836812144, 'support': 9521}, '1': {'precision': 0.42639532540801933, 'recall': 0.834792899408284, 'f1-score': 0.5644705254734597, 'support': 12675}, '2': {'precision': 0.3731567860367138, 'recall': 0.12922050854522718, 'f1-score': 0.19196532239337408, 'support': 9596}, 'accuracy': 0.4142551585304479, 'macro avg': {'precision': 0.3895788556120283, 'recall': 0.36856673518626826, 'f1-score': 0.3204058771826827, 'support': 31792}, 'weighted avg': {'precision': 0.39319257889204867, 'recall': 0.4142551585304479, 'f1-score': 0.34431588155799453, 'support': 31792}}
[[ 1349  7106  1066]
 [ 1077 10581  1017]
 [ 1228  7128  1240]]
training model: results/XRAY/W8/deepVOL_L2/h200
Epoch 1/50
327/327 - 12s - loss: 3.3388 - accuracy200: 0.3608 - val_loss: 3.3419 - val_accuracy200: 0.3415 - 12s/epoch - 36ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2867 - accuracy200: 0.3732 - val_loss: 3.3033 - val_accuracy200: 0.3634 - 10s/epoch - 30ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2618 - accuracy200: 0.3870 - val_loss: 3.2856 - val_accuracy200: 0.3746 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2507 - accuracy200: 0.3900 - val_loss: 3.2697 - val_accuracy200: 0.3847 - 10s/epoch - 30ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2384 - accuracy200: 0.3971 - val_loss: 3.2700 - val_accuracy200: 0.3862 - 10s/epoch - 29ms/step
Epoch 6/50
327/327 - 9s - loss: 3.2356 - accuracy200: 0.3980 - val_loss: 3.2711 - val_accuracy200: 0.3832 - 9s/epoch - 29ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2350 - accuracy200: 0.3959 - val_loss: 3.2643 - val_accuracy200: 0.3873 - 10s/epoch - 30ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2242 - accuracy200: 0.4031 - val_loss: 3.2702 - val_accuracy200: 0.3835 - 10s/epoch - 29ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2238 - accuracy200: 0.4019 - val_loss: 3.2682 - val_accuracy200: 0.3842 - 10s/epoch - 29ms/step
Epoch 10/50
327/327 - 9s - loss: 3.2154 - accuracy200: 0.4050 - val_loss: 3.2725 - val_accuracy200: 0.3821 - 9s/epoch - 29ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2097 - accuracy200: 0.4104 - val_loss: 3.2775 - val_accuracy200: 0.3816 - 10s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2060 - accuracy200: 0.4114 - val_loss: 3.2719 - val_accuracy200: 0.3830 - 10s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2019 - accuracy200: 0.4137 - val_loss: 3.2786 - val_accuracy200: 0.3800 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 10s - loss: 3.1988 - accuracy200: 0.4155 - val_loss: 3.2777 - val_accuracy200: 0.3828 - 10s/epoch - 29ms/step
Epoch 15/50
327/327 - 10s - loss: 3.1928 - accuracy200: 0.4176 - val_loss: 3.2806 - val_accuracy200: 0.3821 - 10s/epoch - 29ms/step
Epoch 16/50
327/327 - 9s - loss: 3.1880 - accuracy200: 0.4206 - val_loss: 3.2895 - val_accuracy200: 0.3844 - 9s/epoch - 29ms/step
Epoch 17/50
327/327 - 10s - loss: 3.1841 - accuracy200: 0.4213 - val_loss: 3.2908 - val_accuracy200: 0.3821 - 10s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h200
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0567756
{'0': {'precision': 0.3370539419087137, 'recall': 0.10415037246932417, 'f1-score': 0.15912942121399118, 'support': 77993}, '1': {'precision': 0.49002689518454134, 'recall': 0.8524120864236399, 'f1-score': 0.6223073880461392, 'support': 136583}, '2': {'precision': 0.3472913288980824, 'recall': 0.14989081520624464, 'f1-score': 0.2094032580207482, 'support': 82887}, 'accuracy': 0.4604673522421276, 'macro avg': {'precision': 0.3914573886637791, 'recall': 0.36881775803306954, 'f1-score': 0.33028002242695953, 'support': 297463}, 'weighted avg': {'precision': 0.4101455572446047, 'recall': 0.4604673522421276, 'f1-score': 0.3858106681429771, 'support': 297463}}
[[  8123  58726  11144]
 [  7952 116425  12206]
 [  8025  62438  12424]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857111
{'0': {'precision': 0.40791037175352235, 'recall': 0.16665510784381718, 'f1-score': 0.23663220088626294, 'support': 28838}, '1': {'precision': 0.3733699647873699, 'recall': 0.7148731246527135, 'f1-score': 0.49053774100481684, 'support': 26995}, '2': {'precision': 0.3909714626628219, 'recall': 0.2833975999135104, 'f1-score': 0.32860455884503686, 'support': 27749}, 'accuracy': 0.38247469550860236, 'macro avg': {'precision': 0.3907505997345713, 'recall': 0.38830861080334705, 'f1-score': 0.3519248335787055, 'support': 83582}, 'weighted avg': {'precision': 0.391130968599624, 'recall': 0.38247469550860236, 'f1-score': 0.34917223362654654, 'support': 83582}}
[[ 4806 16474  7558]
 [ 3005 19298  4692]
 [ 3971 15914  7864]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878321
{'0': {'precision': 0.34882091991594677, 'recall': 0.14802338254235609, 'f1-score': 0.20784641068447413, 'support': 10093}, '1': {'precision': 0.3991858237547893, 'recall': 0.721270335756317, 'f1-score': 0.5139351338019484, 'support': 11556}, '2': {'precision': 0.372001810227787, 'recall': 0.24312333629103816, 'f1-score': 0.29406153112330075, 'support': 10143}, 'accuracy': 0.3867325113236034, 'macro avg': {'precision': 0.37333618463284096, 'recall': 0.37080568486323706, 'f1-score': 0.33861435853657446, 'support': 31792}, 'weighted avg': {'precision': 0.3745236312645458, 'recall': 0.3867325113236034, 'f1-score': 0.3466121772596047, 'support': 31792}}
[[1494 6285 2314]
 [1372 8335 1849]
 [1417 6260 2466]]
training model: results/XRAY/W8/deepVOL_L2/h300
Epoch 1/50
327/327 - 22s - loss: 3.3267 - accuracy300: 0.3647 - val_loss: 3.3110 - val_accuracy300: 0.3508 - 22s/epoch - 68ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2829 - accuracy300: 0.3790 - val_loss: 3.2918 - val_accuracy300: 0.3627 - 10s/epoch - 29ms/step
Epoch 3/50
327/327 - 9s - loss: 3.2615 - accuracy300: 0.3884 - val_loss: 3.2840 - val_accuracy300: 0.3705 - 9s/epoch - 29ms/step
Epoch 4/50
327/327 - 9s - loss: 3.2509 - accuracy300: 0.3927 - val_loss: 3.2828 - val_accuracy300: 0.3794 - 9s/epoch - 29ms/step
Epoch 5/50
327/327 - 9s - loss: 3.2445 - accuracy300: 0.3974 - val_loss: 3.2815 - val_accuracy300: 0.3819 - 9s/epoch - 29ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2451 - accuracy300: 0.3953 - val_loss: 3.2822 - val_accuracy300: 0.3771 - 10s/epoch - 30ms/step
Epoch 7/50
327/327 - 11s - loss: 3.2385 - accuracy300: 0.4007 - val_loss: 3.2722 - val_accuracy300: 0.3834 - 11s/epoch - 33ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2341 - accuracy300: 0.3990 - val_loss: 3.2740 - val_accuracy300: 0.3825 - 10s/epoch - 30ms/step
Epoch 9/50
327/327 - 9s - loss: 3.2294 - accuracy300: 0.4037 - val_loss: 3.2734 - val_accuracy300: 0.3847 - 9s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2304 - accuracy300: 0.4010 - val_loss: 3.2716 - val_accuracy300: 0.3844 - 10s/epoch - 29ms/step
Epoch 11/50
327/327 - 9s - loss: 3.2289 - accuracy300: 0.4020 - val_loss: 3.2799 - val_accuracy300: 0.3851 - 9s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2352 - accuracy300: 0.3998 - val_loss: 3.2826 - val_accuracy300: 0.3815 - 10s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2379 - accuracy300: 0.3992 - val_loss: 3.2835 - val_accuracy300: 0.3804 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 9s - loss: 3.2247 - accuracy300: 0.4030 - val_loss: 3.3002 - val_accuracy300: 0.3725 - 9s/epoch - 29ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2171 - accuracy300: 0.4101 - val_loss: 3.3113 - val_accuracy300: 0.3684 - 10s/epoch - 29ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2072 - accuracy300: 0.4139 - val_loss: 3.3358 - val_accuracy300: 0.3644 - 10s/epoch - 30ms/step
Epoch 17/50
327/327 - 10s - loss: 3.2065 - accuracy300: 0.4158 - val_loss: 3.3207 - val_accuracy300: 0.3712 - 10s/epoch - 29ms/step
Epoch 18/50
327/327 - 10s - loss: 3.2009 - accuracy300: 0.4178 - val_loss: 3.3235 - val_accuracy300: 0.3745 - 10s/epoch - 29ms/step
Epoch 19/50
327/327 - 10s - loss: 3.1920 - accuracy300: 0.4241 - val_loss: 3.3324 - val_accuracy300: 0.3703 - 10s/epoch - 29ms/step
Epoch 20/50
327/327 - 9s - loss: 3.1848 - accuracy300: 0.4272 - val_loss: 3.3461 - val_accuracy300: 0.3724 - 9s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h300
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.063422
{'0': {'precision': 0.32934401151804193, 'recall': 0.139209371909628, 'f1-score': 0.1956992505324695, 'support': 78874}, '1': {'precision': 0.48131558583530204, 'recall': 0.8640974376313894, 'f1-score': 0.6182541080815279, 'support': 136046}, '2': {'precision': 0.33335009807373134, 'recall': 0.08029754188725877, 'f1-score': 0.12942026438599577, 'support': 82543}, 'accuracy': 0.4543926471527551, 'macro avg': {'precision': 0.3813365651423584, 'recall': 0.36120145047609203, 'f1-score': 0.31445787433333106, 'support': 297463}, 'weighted avg': {'precision': 0.3999605224862371, 'recall': 0.4543926471527551, 'f1-score': 0.3705648028755536, 'support': 297463}}
[[ 10980  61516   6378]
 [ 11612 117557   6877]
 [ 10747  65168   6628]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0806496
{'0': {'precision': 0.4044265593561368, 'recall': 0.21297637127821142, 'f1-score': 0.2790181153552507, 'support': 28313}, '1': {'precision': 0.3928605245715368, 'recall': 0.7330388692579505, 'f1-score': 0.5115590900684298, 'support': 28300}, '2': {'precision': 0.38438268103611267, 'recall': 0.22614854091734954, 'f1-score': 0.2847604818377066, 'support': 26969}, 'accuracy': 0.3933143499796607, 'macro avg': {'precision': 0.3938899216545954, 'recall': 0.39072126048450384, 'f1-score': 0.3584458957537957, 'support': 83582}, 'weighted avg': {'precision': 0.3940429583557191, 'recall': 0.3933143499796607, 'f1-score': 0.35960694388350223, 'support': 83582}}
[[ 6030 16260  6023]
 [ 3810 20745  3745]
 [ 5070 15800  6099]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090313
{'0': {'precision': 0.3356150593919871, 'recall': 0.16858818770226539, 'f1-score': 0.22443621676203301, 'support': 9888}, '1': {'precision': 0.4065854431813035, 'recall': 0.7487697055634331, 'f1-score': 0.5270048139016086, 'support': 11989}, '2': {'precision': 0.35714285714285715, 'recall': 0.17095310136157338, 'f1-score': 0.23122570083896055, 'support': 9915}, 'accuracy': 0.3881165072974333, 'macro avg': {'precision': 0.36644778657204924, 'recall': 0.362770331542424, 'f1-score': 0.3275555771675341, 'support': 31792}, 'weighted avg': {'precision': 0.3690924136304744, 'recall': 0.3881165072974333, 'f1-score': 0.34065453098350723, 'support': 31792}}
[[1667 6562 1659]
 [1620 8977 1392]
 [1680 6540 1695]]
training model: results/XRAY/W8/deepVOL_L2/h500
Epoch 1/50
327/327 - 12s - loss: 3.3381 - accuracy500: 0.3593 - val_loss: 3.3333 - val_accuracy500: 0.3369 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.2924 - accuracy500: 0.3695 - val_loss: 3.3183 - val_accuracy500: 0.3334 - 10s/epoch - 30ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2765 - accuracy500: 0.3786 - val_loss: 3.2845 - val_accuracy500: 0.3673 - 10s/epoch - 30ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2642 - accuracy500: 0.3864 - val_loss: 3.3001 - val_accuracy500: 0.3649 - 10s/epoch - 30ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2609 - accuracy500: 0.3878 - val_loss: 3.2722 - val_accuracy500: 0.3860 - 10s/epoch - 30ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2497 - accuracy500: 0.3907 - val_loss: 3.2697 - val_accuracy500: 0.3886 - 10s/epoch - 29ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2447 - accuracy500: 0.3931 - val_loss: 3.2728 - val_accuracy500: 0.3891 - 10s/epoch - 29ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2389 - accuracy500: 0.3989 - val_loss: 3.2774 - val_accuracy500: 0.3849 - 10s/epoch - 29ms/step
Epoch 9/50
327/327 - 9s - loss: 3.2337 - accuracy500: 0.4011 - val_loss: 3.2700 - val_accuracy500: 0.3928 - 9s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2307 - accuracy500: 0.4040 - val_loss: 3.2800 - val_accuracy500: 0.3847 - 10s/epoch - 30ms/step
Epoch 11/50
327/327 - 10s - loss: 3.2256 - accuracy500: 0.4070 - val_loss: 3.2785 - val_accuracy500: 0.3809 - 10s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2170 - accuracy500: 0.4118 - val_loss: 3.2872 - val_accuracy500: 0.3810 - 10s/epoch - 29ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2151 - accuracy500: 0.4116 - val_loss: 3.2912 - val_accuracy500: 0.3847 - 10s/epoch - 29ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2173 - accuracy500: 0.4097 - val_loss: 3.2964 - val_accuracy500: 0.3796 - 10s/epoch - 29ms/step
Epoch 15/50
327/327 - 9s - loss: 3.2114 - accuracy500: 0.4114 - val_loss: 3.3011 - val_accuracy500: 0.3807 - 9s/epoch - 29ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2056 - accuracy500: 0.4150 - val_loss: 3.3036 - val_accuracy500: 0.3789 - 10s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h500
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0614746
{'0': {'precision': 0.3065141820746637, 'recall': 0.08287812121129562, 'f1-score': 0.13047674194171008, 'support': 73409}, '1': {'precision': 0.5233088734044521, 'recall': 0.8171432894537751, 'f1-score': 0.6380210291164119, 'support': 145398}, '2': {'precision': 0.29966782663714014, 'recall': 0.19268714401952808, 'f1-score': 0.23455490900086665, 'support': 78656}, 'accuracy': 0.4708182194088004, 'macro avg': {'precision': 0.37649696070541866, 'recall': 0.3642361848948663, 'f1-score': 0.3343508933529962, 'support': 297463}, 'weighted avg': {'precision': 0.410671699469011, 'recall': 0.4708182194088004, 'f1-score': 0.406081763658133, 'support': 297463}}
[[  6084  50584  16741]
 [  7908 118811  18679]
 [  5857  57643  15156]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.082851
{'0': {'precision': 0.36350949013770006, 'recall': 0.13913322175136214, 'f1-score': 0.20124134023539111, 'support': 28081}, '1': {'precision': 0.4050276371799488, 'recall': 0.6608272001658547, 'f1-score': 0.5022321428571429, 'support': 28941}, '2': {'precision': 0.35893031426898303, 'recall': 0.3461596385542169, 'f1-score': 0.3524293243890752, 'support': 26560}, 'accuracy': 0.385561484530162, 'macro avg': {'precision': 0.3758224805288773, 'recall': 0.38204002015714456, 'f1-score': 0.35196760249386977, 'support': 83582}, 'weighted avg': {'precision': 0.37643037959328374, 'recall': 0.385561484530162, 'f1-score': 0.3535053166633058, 'support': 83582}}
[[ 3907 14471  9703]
 [ 3098 19125  6718]
 [ 3743 13623  9194]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927426
{'0': {'precision': 0.33117350611951046, 'recall': 0.14190231362467867, 'f1-score': 0.19867549668874177, 'support': 9725}, '1': {'precision': 0.4262053735737946, 'recall': 0.6511889460154242, 'f1-score': 0.5152064067117933, 'support': 12448}, '2': {'precision': 0.32430862189170345, 'recall': 0.29015490175693937, 'f1-score': 0.3062825788751714, 'support': 9619}, 'accuracy': 0.3861663311524912, 'macro avg': {'precision': 0.36056250052833616, 'recall': 0.3610820537990141, 'f1-score': 0.34005482742523546, 'support': 31792}, 'weighted avg': {'precision': 0.3663057206603904, 'recall': 0.3861663311524912, 'f1-score': 0.35516924642195175, 'support': 31792}}
[[1380 5439 2906]
 [1433 8106 2909]
 [1354 5474 2791]]
training model: results/XRAY/W8/deepVOL_L2/h1000
Epoch 1/50
327/327 - 12s - loss: 3.3456 - accuracy1000: 0.3660 - val_loss: 3.3555 - val_accuracy1000: 0.3164 - 12s/epoch - 37ms/step
Epoch 2/50
327/327 - 10s - loss: 3.3045 - accuracy1000: 0.3733 - val_loss: 3.3708 - val_accuracy1000: 0.3063 - 10s/epoch - 29ms/step
Epoch 3/50
327/327 - 10s - loss: 3.2834 - accuracy1000: 0.3791 - val_loss: 3.3619 - val_accuracy1000: 0.3286 - 10s/epoch - 29ms/step
Epoch 4/50
327/327 - 10s - loss: 3.2797 - accuracy1000: 0.3803 - val_loss: 3.3356 - val_accuracy1000: 0.3496 - 10s/epoch - 31ms/step
Epoch 5/50
327/327 - 10s - loss: 3.2803 - accuracy1000: 0.3768 - val_loss: 3.3287 - val_accuracy1000: 0.3451 - 10s/epoch - 30ms/step
Epoch 6/50
327/327 - 10s - loss: 3.2664 - accuracy1000: 0.3843 - val_loss: 3.2884 - val_accuracy1000: 0.3815 - 10s/epoch - 29ms/step
Epoch 7/50
327/327 - 10s - loss: 3.2607 - accuracy1000: 0.3901 - val_loss: 3.3038 - val_accuracy1000: 0.3669 - 10s/epoch - 29ms/step
Epoch 8/50
327/327 - 10s - loss: 3.2541 - accuracy1000: 0.3955 - val_loss: 3.2967 - val_accuracy1000: 0.3784 - 10s/epoch - 30ms/step
Epoch 9/50
327/327 - 10s - loss: 3.2476 - accuracy1000: 0.3980 - val_loss: 3.3148 - val_accuracy1000: 0.3635 - 10s/epoch - 29ms/step
Epoch 10/50
327/327 - 10s - loss: 3.2454 - accuracy1000: 0.3996 - val_loss: 3.3003 - val_accuracy1000: 0.3758 - 10s/epoch - 29ms/step
Epoch 11/50
327/327 - 9s - loss: 3.2387 - accuracy1000: 0.4020 - val_loss: 3.3035 - val_accuracy1000: 0.3760 - 9s/epoch - 29ms/step
Epoch 12/50
327/327 - 10s - loss: 3.2357 - accuracy1000: 0.4040 - val_loss: 3.3077 - val_accuracy1000: 0.3769 - 10s/epoch - 30ms/step
Epoch 13/50
327/327 - 10s - loss: 3.2299 - accuracy1000: 0.4067 - val_loss: 3.2936 - val_accuracy1000: 0.3888 - 10s/epoch - 30ms/step
Epoch 14/50
327/327 - 10s - loss: 3.2246 - accuracy1000: 0.4097 - val_loss: 3.2903 - val_accuracy1000: 0.3820 - 10s/epoch - 30ms/step
Epoch 15/50
327/327 - 10s - loss: 3.2308 - accuracy1000: 0.4023 - val_loss: 3.2779 - val_accuracy1000: 0.4009 - 10s/epoch - 30ms/step
Epoch 16/50
327/327 - 10s - loss: 3.2272 - accuracy1000: 0.4089 - val_loss: 3.2915 - val_accuracy1000: 0.3967 - 10s/epoch - 30ms/step
Epoch 17/50
327/327 - 10s - loss: 3.2232 - accuracy1000: 0.4139 - val_loss: 3.3001 - val_accuracy1000: 0.3947 - 10s/epoch - 30ms/step
Epoch 18/50
327/327 - 10s - loss: 3.2156 - accuracy1000: 0.4151 - val_loss: 3.3026 - val_accuracy1000: 0.3937 - 10s/epoch - 29ms/step
Epoch 19/50
327/327 - 10s - loss: 3.2042 - accuracy1000: 0.4190 - val_loss: 3.3084 - val_accuracy1000: 0.3916 - 10s/epoch - 29ms/step
Epoch 20/50
327/327 - 9s - loss: 3.2021 - accuracy1000: 0.4197 - val_loss: 3.3076 - val_accuracy1000: 0.3789 - 9s/epoch - 29ms/step
Epoch 21/50
327/327 - 9s - loss: 3.1938 - accuracy1000: 0.4249 - val_loss: 3.3090 - val_accuracy1000: 0.3789 - 9s/epoch - 29ms/step
Epoch 22/50
327/327 - 10s - loss: 3.1925 - accuracy1000: 0.4233 - val_loss: 3.2995 - val_accuracy1000: 0.3819 - 10s/epoch - 29ms/step
Epoch 23/50
327/327 - 9s - loss: 3.1783 - accuracy1000: 0.4304 - val_loss: 3.3159 - val_accuracy1000: 0.3654 - 9s/epoch - 29ms/step
Epoch 24/50
327/327 - 10s - loss: 3.1711 - accuracy1000: 0.4327 - val_loss: 3.3276 - val_accuracy1000: 0.3629 - 10s/epoch - 29ms/step
Epoch 25/50
327/327 - 10s - loss: 3.1679 - accuracy1000: 0.4335 - val_loss: 3.3413 - val_accuracy1000: 0.3632 - 10s/epoch - 29ms/step
testing model: results/XRAY/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0797672
{'0': {'precision': 0.2528275377590446, 'recall': 0.049397458069120756, 'f1-score': 0.08264728508605743, 'support': 72858}, '1': {'precision': 0.5310494071748606, 'recall': 0.5939430301212212, 'f1-score': 0.5607381589152901, 'support': 146674}, '2': {'precision': 0.26856179153067133, 'recall': 0.41072230562933876, 'f1-score': 0.3247663788467588, 'support': 77931}, 'accuracy': 0.41256559639350104, 'macro avg': {'precision': 0.3508129121548588, 'recall': 0.3513542646065602, 'f1-score': 0.3227172742827021, 'support': 297463}, 'weighted avg': {'precision': 0.39413620675442235, 'recall': 0.41256559639350104, 'f1-score': 0.3818175480226045, 'support': 297463}}
[[ 3599 34652 34607]
 [ 6990 87116 52568]
 [ 3646 42277 32008]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0936567
{'0': {'precision': 0.40593569661995055, 'recall': 0.08243211571299427, 'f1-score': 0.1370366247356117, 'support': 29867}, '1': {'precision': 0.387244736135848, 'recall': 0.585877228599904, 'f1-score': 0.4662886688798143, 'support': 27091}, '2': {'precision': 0.34426498768135777, 'recall': 0.4723557692307692, 'f1-score': 0.3982645596478449, 'support': 26624}, 'accuracy': 0.3698164676605011, 'macro avg': {'precision': 0.37914847347905206, 'recall': 0.3802217045145558, 'f1-score': 0.33386328442109026, 'support': 83582}, 'weighted avg': {'precision': 0.3802330601042424, 'recall': 0.3698164676605011, 'f1-score': 0.32696627067629136, 'support': 83582}}
[[ 2462 13165 14240]
 [ 1505 15872  9714]
 [ 2098 11950 12576]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0904971
{'0': {'precision': 0.3336218087408048, 'recall': 0.07950912653397958, 'f1-score': 0.12841439040639574, 'support': 9697}, '1': {'precision': 0.4440104166666667, 'recall': 0.643953104099457, 'f1-score': 0.5256093253267397, 'support': 12709}, '2': {'precision': 0.3469997284822156, 'recall': 0.40848071595994034, 'f1-score': 0.3752385612919012, 'support': 9386}, 'accuracy': 0.40227101157523903, 'macro avg': {'precision': 0.37487731796322904, 'recall': 0.37731431553112565, 'f1-score': 0.3430874256750122, 'support': 31792}, 'weighted avg': {'precision': 0.38169975202284623, 'recall': 0.40227101157523903, 'f1-score': 0.36006518607304155, 'support': 31792}}
[[ 771 5372 3554]
 [ 864 8184 3661]
 [ 676 4876 3834]]
training model: results/XRAY/W8/deepVOL_L3/h10
Epoch 1/50
327/327 - 16s - loss: 3.3191 - accuracy10: 0.3622 - val_loss: 3.3030 - val_accuracy10: 0.3773 - 16s/epoch - 50ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2636 - accuracy10: 0.3863 - val_loss: 3.3094 - val_accuracy10: 0.3805 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2344 - accuracy10: 0.4019 - val_loss: 3.2645 - val_accuracy10: 0.3874 - 14s/epoch - 42ms/step
Epoch 4/50
327/327 - 14s - loss: 3.1907 - accuracy10: 0.4251 - val_loss: 3.1995 - val_accuracy10: 0.3996 - 14s/epoch - 43ms/step
Epoch 5/50
327/327 - 14s - loss: 3.1495 - accuracy10: 0.4413 - val_loss: 3.1253 - val_accuracy10: 0.4432 - 14s/epoch - 42ms/step
Epoch 6/50
327/327 - 14s - loss: 3.1199 - accuracy10: 0.4530 - val_loss: 3.1120 - val_accuracy10: 0.4467 - 14s/epoch - 42ms/step
Epoch 7/50
327/327 - 14s - loss: 3.0995 - accuracy10: 0.4609 - val_loss: 3.0879 - val_accuracy10: 0.4564 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 14s - loss: 3.0864 - accuracy10: 0.4658 - val_loss: 3.0817 - val_accuracy10: 0.4545 - 14s/epoch - 42ms/step
Epoch 9/50
327/327 - 14s - loss: 3.0783 - accuracy10: 0.4687 - val_loss: 3.0538 - val_accuracy10: 0.4665 - 14s/epoch - 41ms/step
Epoch 10/50
327/327 - 13s - loss: 3.0686 - accuracy10: 0.4732 - val_loss: 3.0446 - val_accuracy10: 0.4732 - 13s/epoch - 41ms/step
Epoch 11/50
327/327 - 14s - loss: 3.0592 - accuracy10: 0.4759 - val_loss: 3.0728 - val_accuracy10: 0.4622 - 14s/epoch - 41ms/step
Epoch 12/50
327/327 - 14s - loss: 3.0549 - accuracy10: 0.4768 - val_loss: 3.0791 - val_accuracy10: 0.4653 - 14s/epoch - 41ms/step
Epoch 13/50
327/327 - 13s - loss: 3.0476 - accuracy10: 0.4801 - val_loss: 3.0356 - val_accuracy10: 0.4771 - 13s/epoch - 41ms/step
Epoch 14/50
327/327 - 14s - loss: 3.0401 - accuracy10: 0.4813 - val_loss: 3.0457 - val_accuracy10: 0.4774 - 14s/epoch - 43ms/step
Epoch 15/50
327/327 - 14s - loss: 3.0367 - accuracy10: 0.4825 - val_loss: 3.0599 - val_accuracy10: 0.4701 - 14s/epoch - 41ms/step
Epoch 16/50
327/327 - 13s - loss: 3.0311 - accuracy10: 0.4853 - val_loss: 3.0577 - val_accuracy10: 0.4727 - 13s/epoch - 41ms/step
Epoch 17/50
327/327 - 13s - loss: 3.0261 - accuracy10: 0.4848 - val_loss: 3.0309 - val_accuracy10: 0.4828 - 13s/epoch - 41ms/step
Epoch 18/50
327/327 - 13s - loss: 3.0187 - accuracy10: 0.4888 - val_loss: 3.0355 - val_accuracy10: 0.4818 - 13s/epoch - 41ms/step
Epoch 19/50
327/327 - 14s - loss: 3.0126 - accuracy10: 0.4917 - val_loss: 3.0331 - val_accuracy10: 0.4807 - 14s/epoch - 41ms/step
Epoch 20/50
327/327 - 13s - loss: 3.0064 - accuracy10: 0.4927 - val_loss: 3.0401 - val_accuracy10: 0.4780 - 13s/epoch - 41ms/step
Epoch 21/50
327/327 - 14s - loss: 3.0000 - accuracy10: 0.4943 - val_loss: 3.0269 - val_accuracy10: 0.4785 - 14s/epoch - 42ms/step
Epoch 22/50
327/327 - 13s - loss: 2.9962 - accuracy10: 0.4961 - val_loss: 3.0195 - val_accuracy10: 0.4837 - 13s/epoch - 41ms/step
Epoch 23/50
327/327 - 13s - loss: 2.9870 - accuracy10: 0.4980 - val_loss: 3.0403 - val_accuracy10: 0.4766 - 13s/epoch - 41ms/step
Epoch 24/50
327/327 - 13s - loss: 2.9825 - accuracy10: 0.4980 - val_loss: 3.0330 - val_accuracy10: 0.4782 - 13s/epoch - 41ms/step
Epoch 25/50
327/327 - 13s - loss: 2.9803 - accuracy10: 0.5000 - val_loss: 3.0387 - val_accuracy10: 0.4815 - 13s/epoch - 41ms/step
Epoch 26/50
327/327 - 14s - loss: 2.9745 - accuracy10: 0.5009 - val_loss: 3.0398 - val_accuracy10: 0.4776 - 14s/epoch - 41ms/step
Epoch 27/50
327/327 - 14s - loss: 2.9696 - accuracy10: 0.5023 - val_loss: 3.0417 - val_accuracy10: 0.4781 - 14s/epoch - 41ms/step
Epoch 28/50
327/327 - 13s - loss: 2.9635 - accuracy10: 0.5056 - val_loss: 3.0307 - val_accuracy10: 0.4801 - 13s/epoch - 41ms/step
Epoch 29/50
327/327 - 13s - loss: 2.9593 - accuracy10: 0.5062 - val_loss: 3.0451 - val_accuracy10: 0.4746 - 13s/epoch - 40ms/step
Epoch 30/50
327/327 - 13s - loss: 2.9558 - accuracy10: 0.5077 - val_loss: 3.0381 - val_accuracy10: 0.4786 - 13s/epoch - 40ms/step
Epoch 31/50
327/327 - 14s - loss: 2.9492 - accuracy10: 0.5094 - val_loss: 3.0455 - val_accuracy10: 0.4764 - 14s/epoch - 42ms/step
Epoch 32/50
327/327 - 13s - loss: 2.9440 - accuracy10: 0.5117 - val_loss: 3.0411 - val_accuracy10: 0.4752 - 13s/epoch - 41ms/step
testing model: results/XRAY/W8/deepVOL_L3/h10
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.939782
{'0': {'precision': 0.4667817479109699, 'recall': 0.40183056731806105, 'f1-score': 0.43187776937591427, 'support': 76042}, '1': {'precision': 0.5934967812628407, 'recall': 0.7392232996458378, 'f1-score': 0.6583927941945129, 'support': 146543}, '2': {'precision': 0.4136669563635629, 'recall': 0.2733379630866209, 'f1-score': 0.3291705198825942, 'support': 74878}, 'accuracy': 0.5357002383489712, 'macro avg': {'precision': 0.49131516184579116, 'recall': 0.4714639433501732, 'f1-score': 0.47314702781767376, 'support': 297463}, 'weighted avg': {'precision': 0.5158368296219606, 'recall': 0.5357002383489712, 'f1-score': 0.5176150807539045, 'support': 297463}}
[[ 30556  34025  11461]
 [ 20666 108328  17549]
 [ 14239  40172  20467]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.019257
{'0': {'precision': 0.4930850620678164, 'recall': 0.427020202020202, 'f1-score': 0.45768085682248777, 'support': 27720}, '1': {'precision': 0.46871020556667276, 'recall': 0.5552602277217054, 'f1-score': 0.5083274419216415, 'support': 27841}, '2': {'precision': 0.4702564488230428, 'recall': 0.4463081260483209, 'f1-score': 0.45796942231987553, 'support': 28021}, 'accuracy': 0.47620301021751094, 'macro avg': {'precision': 0.47735057215251064, 'recall': 0.4761961852634094, 'f1-score': 0.4746592403546683, 'support': 83582}, 'weighted avg': {'precision': 0.4773125159265402, 'recall': 0.47620301021751094, 'f1-score': 0.47464787686924237, 'support': 83582}}
[[11837  8118  7765]
 [ 6059 15459  6323]
 [ 6110  9405 12506]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0069495
{'0': {'precision': 0.4716915191053122, 'recall': 0.4139658521623556, 'f1-score': 0.4409474543969507, 'support': 9781}, '1': {'precision': 0.5031388215151947, 'recall': 0.5866744302112793, 'f1-score': 0.541705069124424, 'support': 12022}, '2': {'precision': 0.4588683351468988, 'recall': 0.4221643808189008, 'f1-score': 0.4397518118775744, 'support': 9989}, 'accuracy': 0.48185078007045795, 'macro avg': {'precision': 0.47789955858913524, 'recall': 0.4742682210641786, 'f1-score': 0.47413477846631635, 'support': 31792}, 'weighted avg': {'precision': 0.4795541475971031, 'recall': 0.48185078007045795, 'f1-score': 0.47867281836045206, 'support': 31792}}
[[4049 3217 2515]
 [2511 7053 2458]
 [2024 3748 4217]]
training model: results/XRAY/W8/deepVOL_L3/h20
Epoch 1/50
327/327 - 16s - loss: 3.3332 - accuracy20: 0.3537 - val_loss: 3.3633 - val_accuracy20: 0.3687 - 16s/epoch - 50ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2974 - accuracy20: 0.3619 - val_loss: 3.3115 - val_accuracy20: 0.3785 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 13s - loss: 3.2809 - accuracy20: 0.3732 - val_loss: 3.3097 - val_accuracy20: 0.3775 - 13s/epoch - 41ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2634 - accuracy20: 0.3847 - val_loss: 3.2545 - val_accuracy20: 0.3974 - 14s/epoch - 42ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2335 - accuracy20: 0.4044 - val_loss: 3.2268 - val_accuracy20: 0.4068 - 14s/epoch - 41ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2115 - accuracy20: 0.4146 - val_loss: 3.2055 - val_accuracy20: 0.4183 - 14s/epoch - 42ms/step
Epoch 7/50
327/327 - 14s - loss: 3.1968 - accuracy20: 0.4206 - val_loss: 3.1735 - val_accuracy20: 0.4296 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 15s - loss: 3.1788 - accuracy20: 0.4311 - val_loss: 3.1569 - val_accuracy20: 0.4340 - 15s/epoch - 45ms/step
Epoch 9/50
327/327 - 14s - loss: 3.1694 - accuracy20: 0.4331 - val_loss: 3.1491 - val_accuracy20: 0.4373 - 14s/epoch - 43ms/step
Epoch 10/50
327/327 - 13s - loss: 3.1577 - accuracy20: 0.4396 - val_loss: 3.1420 - val_accuracy20: 0.4439 - 13s/epoch - 41ms/step
Epoch 11/50
327/327 - 14s - loss: 3.1476 - accuracy20: 0.4426 - val_loss: 3.1424 - val_accuracy20: 0.4423 - 14s/epoch - 41ms/step
Epoch 12/50
327/327 - 14s - loss: 3.1381 - accuracy20: 0.4456 - val_loss: 3.1435 - val_accuracy20: 0.4411 - 14s/epoch - 42ms/step
Epoch 13/50
327/327 - 14s - loss: 3.1312 - accuracy20: 0.4484 - val_loss: 3.1391 - val_accuracy20: 0.4449 - 14s/epoch - 43ms/step
Epoch 14/50
327/327 - 13s - loss: 3.1226 - accuracy20: 0.4532 - val_loss: 3.1518 - val_accuracy20: 0.4376 - 13s/epoch - 41ms/step
Epoch 15/50
327/327 - 14s - loss: 3.1176 - accuracy20: 0.4525 - val_loss: 3.1383 - val_accuracy20: 0.4467 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 14s - loss: 3.1116 - accuracy20: 0.4561 - val_loss: 3.1447 - val_accuracy20: 0.4458 - 14s/epoch - 41ms/step
Epoch 17/50
327/327 - 14s - loss: 3.1055 - accuracy20: 0.4587 - val_loss: 3.1483 - val_accuracy20: 0.4446 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 14s - loss: 3.1026 - accuracy20: 0.4598 - val_loss: 3.1441 - val_accuracy20: 0.4449 - 14s/epoch - 43ms/step
Epoch 19/50
327/327 - 13s - loss: 3.0968 - accuracy20: 0.4605 - val_loss: 3.1479 - val_accuracy20: 0.4434 - 13s/epoch - 41ms/step
Epoch 20/50
327/327 - 13s - loss: 3.0913 - accuracy20: 0.4624 - val_loss: 3.1483 - val_accuracy20: 0.4433 - 13s/epoch - 41ms/step
Epoch 21/50
327/327 - 14s - loss: 3.0879 - accuracy20: 0.4637 - val_loss: 3.1532 - val_accuracy20: 0.4426 - 14s/epoch - 42ms/step
Epoch 22/50
327/327 - 13s - loss: 3.0808 - accuracy20: 0.4671 - val_loss: 3.1591 - val_accuracy20: 0.4475 - 13s/epoch - 41ms/step
Epoch 23/50
327/327 - 14s - loss: 3.0760 - accuracy20: 0.4668 - val_loss: 3.1566 - val_accuracy20: 0.4443 - 14s/epoch - 42ms/step
Epoch 24/50
327/327 - 13s - loss: 3.0724 - accuracy20: 0.4667 - val_loss: 3.1541 - val_accuracy20: 0.4449 - 13s/epoch - 41ms/step
Epoch 25/50
327/327 - 14s - loss: 3.0681 - accuracy20: 0.4698 - val_loss: 3.1558 - val_accuracy20: 0.4434 - 14s/epoch - 41ms/step
testing model: results/XRAY/W8/deepVOL_L3/h20
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0017443
{'0': {'precision': 0.43835018736204506, 'recall': 0.222849984994585, 'f1-score': 0.2954818729941782, 'support': 76639}, '1': {'precision': 0.5424219019604621, 'recall': 0.6823829376701237, 'f1-score': 0.6044055982470383, 'support': 145115}, '2': {'precision': 0.3488846751468226, 'recall': 0.34995839332179796, 'f1-score': 0.3494207093919592, 'support': 75709}, 'accuracy': 0.4793806288513193, 'macro avg': {'precision': 0.4432189214897766, 'recall': 0.41839710532883556, 'f1-score': 0.4164360602110586, 'support': 297463}, 'weighted avg': {'precision': 0.4663503836877965, 'recall': 0.4793806288513193, 'f1-score': 0.45991617828562076, 'support': 297463}}
[[17079 42497 17063]
 [13707 99024 32384]
 [ 8176 41038 26495]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0551983
{'0': {'precision': 0.46708732963149924, 'recall': 0.33345345778226243, 'f1-score': 0.3891166761285982, 'support': 27749}, '1': {'precision': 0.43023882774588473, 'recall': 0.4866542297481524, 'f1-score': 0.45671094052488936, 'support': 27874}, '2': {'precision': 0.43091523741587323, 'recall': 0.49694195071354486, 'f1-score': 0.4615793495232717, 'support': 27959}, 'accuracy': 0.439233327749994, 'macro avg': {'precision': 0.4427471315977524, 'recall': 0.43901654608131996, 'f1-score': 0.4358023220589197, 'support': 83582}, 'weighted avg': {'precision': 0.4426986972965909, 'recall': 0.439233327749994, 'f1-score': 0.4358983565289702, 'support': 83582}}
[[ 9253  9030  9466]
 [ 5426 13565  8883]
 [ 5131  8934 13894]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0463645
{'0': {'precision': 0.43556365529809943, 'recall': 0.34052513739059637, 'f1-score': 0.38222526844870913, 'support': 9826}, '1': {'precision': 0.46918595738157287, 'recall': 0.5116609546100477, 'f1-score': 0.4895037786396897, 'support': 11963}, '2': {'precision': 0.4243492407809111, 'recall': 0.4693591922423273, 'f1-score': 0.44572079555703237, 'support': 10003}, 'accuracy': 0.4454579768495219, 'macro avg': {'precision': 0.4430329511535278, 'recall': 0.4405150947476571, 'f1-score': 0.439149947548477, 'support': 31792}, 'weighted avg': {'precision': 0.4446868879166563, 'recall': 0.4454579768495219, 'f1-score': 0.44257122262206267, 'support': 31792}}
[[3346 3438 3042]
 [2515 6121 3327]
 [1821 3487 4695]]
training model: results/XRAY/W8/deepVOL_L3/h30
Epoch 1/50
327/327 - 16s - loss: 3.3338 - accuracy30: 0.3540 - val_loss: 3.3225 - val_accuracy30: 0.3634 - 16s/epoch - 49ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2914 - accuracy30: 0.3684 - val_loss: 3.2862 - val_accuracy30: 0.3722 - 14s/epoch - 43ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2713 - accuracy30: 0.3800 - val_loss: 3.2686 - val_accuracy30: 0.3881 - 14s/epoch - 43ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2570 - accuracy30: 0.3918 - val_loss: 3.2594 - val_accuracy30: 0.3904 - 14s/epoch - 43ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2363 - accuracy30: 0.4060 - val_loss: 3.2470 - val_accuracy30: 0.3954 - 14s/epoch - 43ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2166 - accuracy30: 0.4152 - val_loss: 3.2245 - val_accuracy30: 0.4041 - 14s/epoch - 42ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2055 - accuracy30: 0.4219 - val_loss: 3.2220 - val_accuracy30: 0.4044 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 14s - loss: 3.1938 - accuracy30: 0.4247 - val_loss: 3.2146 - val_accuracy30: 0.4098 - 14s/epoch - 43ms/step
Epoch 9/50
327/327 - 14s - loss: 3.1844 - accuracy30: 0.4301 - val_loss: 3.2034 - val_accuracy30: 0.4159 - 14s/epoch - 44ms/step
Epoch 10/50
327/327 - 14s - loss: 3.1786 - accuracy30: 0.4300 - val_loss: 3.1996 - val_accuracy30: 0.4164 - 14s/epoch - 42ms/step
Epoch 11/50
327/327 - 13s - loss: 3.1696 - accuracy30: 0.4358 - val_loss: 3.2095 - val_accuracy30: 0.4089 - 13s/epoch - 41ms/step
Epoch 12/50
327/327 - 14s - loss: 3.1604 - accuracy30: 0.4381 - val_loss: 3.1994 - val_accuracy30: 0.4118 - 14s/epoch - 42ms/step
Epoch 13/50
327/327 - 14s - loss: 3.1573 - accuracy30: 0.4403 - val_loss: 3.1975 - val_accuracy30: 0.4154 - 14s/epoch - 41ms/step
Epoch 14/50
327/327 - 14s - loss: 3.1509 - accuracy30: 0.4416 - val_loss: 3.1934 - val_accuracy30: 0.4194 - 14s/epoch - 42ms/step
Epoch 15/50
327/327 - 14s - loss: 3.1464 - accuracy30: 0.4452 - val_loss: 3.1985 - val_accuracy30: 0.4143 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 14s - loss: 3.1413 - accuracy30: 0.4439 - val_loss: 3.2015 - val_accuracy30: 0.4125 - 14s/epoch - 42ms/step
Epoch 17/50
327/327 - 14s - loss: 3.1378 - accuracy30: 0.4465 - val_loss: 3.2022 - val_accuracy30: 0.4145 - 14s/epoch - 43ms/step
Epoch 18/50
327/327 - 14s - loss: 3.1318 - accuracy30: 0.4503 - val_loss: 3.2052 - val_accuracy30: 0.4109 - 14s/epoch - 41ms/step
Epoch 19/50
327/327 - 14s - loss: 3.1279 - accuracy30: 0.4505 - val_loss: 3.2097 - val_accuracy30: 0.4102 - 14s/epoch - 43ms/step
Epoch 20/50
327/327 - 13s - loss: 3.1227 - accuracy30: 0.4537 - val_loss: 3.2029 - val_accuracy30: 0.4213 - 13s/epoch - 41ms/step
Epoch 21/50
327/327 - 14s - loss: 3.1196 - accuracy30: 0.4554 - val_loss: 3.2099 - val_accuracy30: 0.4121 - 14s/epoch - 41ms/step
Epoch 22/50
327/327 - 14s - loss: 3.1151 - accuracy30: 0.4541 - val_loss: 3.2130 - val_accuracy30: 0.4152 - 14s/epoch - 42ms/step
Epoch 23/50
327/327 - 14s - loss: 3.1068 - accuracy30: 0.4601 - val_loss: 3.2275 - val_accuracy30: 0.4098 - 14s/epoch - 41ms/step
Epoch 24/50
327/327 - 14s - loss: 3.1066 - accuracy30: 0.4582 - val_loss: 3.2417 - val_accuracy30: 0.4097 - 14s/epoch - 43ms/step
testing model: results/XRAY/W8/deepVOL_L3/h30
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0213717
{'0': {'precision': 0.43963353913563036, 'recall': 0.13933143131264675, 'f1-score': 0.21160095476375348, 'support': 79214}, '1': {'precision': 0.5023800088580154, 'recall': 0.774307127408078, 'f1-score': 0.6093841012039745, 'support': 139167}, '2': {'precision': 0.3558059554464857, 'recall': 0.26033737133608154, 'f1-score': 0.3006754536492753, 'support': 79082}, 'accuracy': 0.46857256196568986, 'macro avg': {'precision': 0.43260650114671045, 'recall': 0.3913253100189354, 'f1-score': 0.37388683653900107, 'support': 297463}, 'weighted avg': {'precision': 0.4467032754677127, 'recall': 0.46857256196568986, 'f1-score': 0.4213832694096458, 'support': 297463}}
[[ 11037  53463  14714]
 [  8848 107758  22561]
 [  5220  53274  20588]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0743177
{'0': {'precision': 0.4796197718631179, 'recall': 0.22395426461188836, 'f1-score': 0.30533501161890003, 'support': 28162}, '1': {'precision': 0.38399298597194387, 'recall': 0.5657501384019191, 'f1-score': 0.45747966873088114, 'support': 27095}, '2': {'precision': 0.4137388568432092, 'recall': 0.44568402471315094, 'f1-score': 0.429117732039363, 'support': 28325}, 'accuracy': 0.409896867746644, 'macro avg': {'precision': 0.4257838715594236, 'recall': 0.41179614257565283, 'f1-score': 0.3973108041297147, 'support': 83582}, 'weighted avg': {'precision': 0.42629388014408426, 'recall': 0.409896867746644, 'f1-score': 0.3966047232835975, 'support': 83582}}
[[ 6307 12134  9721]
 [ 3599 15329  8167]
 [ 3244 12457 12624]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658329
{'0': {'precision': 0.44141501294219154, 'recall': 0.25346809353943717, 'f1-score': 0.32202429659470005, 'support': 10092}, '1': {'precision': 0.41666139140343106, 'recall': 0.5712054152564436, 'f1-score': 0.4818448023426062, 'support': 11523}, '2': {'precision': 0.4046078431372549, 'recall': 0.4055222560676034, 'f1-score': 0.40506453354271965, 'support': 10177}, 'accuracy': 0.41730624056366383, 'macro avg': {'precision': 0.42089474916095915, 'recall': 0.41006525495449475, 'f1-score': 0.40297787749334196, 'support': 31792}, 'weighted avg': {'precision': 0.4206606549874867, 'recall': 0.41730624056366383, 'f1-score': 0.4065333611126013, 'support': 31792}}
[[2558 4413 3121]
 [1989 6582 2952]
 [1248 4802 4127]]
training model: results/XRAY/W8/deepVOL_L3/h50
Epoch 1/50
327/327 - 17s - loss: 3.3271 - accuracy50: 0.3558 - val_loss: 3.3220 - val_accuracy50: 0.3608 - 17s/epoch - 51ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2921 - accuracy50: 0.3676 - val_loss: 3.3076 - val_accuracy50: 0.3599 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2750 - accuracy50: 0.3751 - val_loss: 3.2958 - val_accuracy50: 0.3664 - 14s/epoch - 42ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2684 - accuracy50: 0.3801 - val_loss: 3.2818 - val_accuracy50: 0.3753 - 14s/epoch - 41ms/step
Epoch 5/50
327/327 - 13s - loss: 3.2600 - accuracy50: 0.3830 - val_loss: 3.2840 - val_accuracy50: 0.3671 - 13s/epoch - 41ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2494 - accuracy50: 0.3946 - val_loss: 3.2854 - val_accuracy50: 0.3698 - 14s/epoch - 43ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2461 - accuracy50: 0.3995 - val_loss: 3.2659 - val_accuracy50: 0.3802 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 14s - loss: 3.2343 - accuracy50: 0.4068 - val_loss: 3.2518 - val_accuracy50: 0.3891 - 14s/epoch - 42ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2282 - accuracy50: 0.4096 - val_loss: 3.2422 - val_accuracy50: 0.3947 - 14s/epoch - 42ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2181 - accuracy50: 0.4126 - val_loss: 3.2314 - val_accuracy50: 0.4005 - 14s/epoch - 43ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2193 - accuracy50: 0.4122 - val_loss: 3.2370 - val_accuracy50: 0.3941 - 14s/epoch - 42ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2073 - accuracy50: 0.4165 - val_loss: 3.2346 - val_accuracy50: 0.3993 - 14s/epoch - 41ms/step
Epoch 13/50
327/327 - 14s - loss: 3.2020 - accuracy50: 0.4218 - val_loss: 3.2439 - val_accuracy50: 0.3959 - 14s/epoch - 41ms/step
Epoch 14/50
327/327 - 14s - loss: 3.1968 - accuracy50: 0.4239 - val_loss: 3.2330 - val_accuracy50: 0.4078 - 14s/epoch - 42ms/step
Epoch 15/50
327/327 - 14s - loss: 3.1915 - accuracy50: 0.4254 - val_loss: 3.2345 - val_accuracy50: 0.4033 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 13s - loss: 3.1854 - accuracy50: 0.4287 - val_loss: 3.2350 - val_accuracy50: 0.4040 - 13s/epoch - 41ms/step
Epoch 17/50
327/327 - 14s - loss: 3.1798 - accuracy50: 0.4330 - val_loss: 3.2455 - val_accuracy50: 0.4015 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 13s - loss: 3.1756 - accuracy50: 0.4333 - val_loss: 3.2484 - val_accuracy50: 0.3994 - 13s/epoch - 41ms/step
Epoch 19/50
327/327 - 14s - loss: 3.1693 - accuracy50: 0.4350 - val_loss: 3.2546 - val_accuracy50: 0.3998 - 14s/epoch - 42ms/step
Epoch 20/50
327/327 - 14s - loss: 3.1654 - accuracy50: 0.4369 - val_loss: 3.2419 - val_accuracy50: 0.4024 - 14s/epoch - 42ms/step
testing model: results/XRAY/W8/deepVOL_L3/h50
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.047586
{'0': {'precision': 0.3766204675906482, 'recall': 0.1725615466522983, 'f1-score': 0.23668003941441443, 'support': 77949}, '1': {'precision': 0.5055260873758318, 'recall': 0.7453785336442751, 'f1-score': 0.6024572735527026, 'support': 140648}, '2': {'precision': 0.3419290759270159, 'recall': 0.23571627824411026, 'f1-score': 0.2790578981341099, 'support': 78866}, 'accuracy': 0.4601479847913858, 'macro avg': {'precision': 0.40802521029783195, 'recall': 0.3845521195135612, 'f1-score': 0.37273173703374235, 'support': 297463}, 'weighted avg': {'precision': 0.4283726058955885, 'recall': 0.4601479847913858, 'f1-score': 0.42086431992281204, 'support': 297463}}
[[ 13451  51407  13091]
 [ 13125 104836  22687]
 [  9139  51137  18590]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776225
{'0': {'precision': 0.4296490147783251, 'recall': 0.1996851971095371, 'f1-score': 0.2726517852781713, 'support': 27954}, '1': {'precision': 0.38979786024275337, 'recall': 0.6040640172630822, 'f1-score': 0.47383417496544133, 'support': 27805}, '2': {'precision': 0.40194902003563504, 'recall': 0.39729720015814257, 'f1-score': 0.3996095726990095, 'support': 27823}, 'accuracy': 0.39999042856117345, 'macro avg': {'precision': 0.4071319650189045, 'recall': 0.4003488048435873, 'f1-score': 0.3820318443142074, 'support': 83582}, 'weighted avg': {'precision': 0.4071709895385912, 'recall': 0.39999042856117345, 'f1-score': 0.38184064011132346, 'support': 83582}}
[[ 5582 13209  9163]
 [ 3725 16796  7284]
 [ 3685 13084 11054]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779489
{'0': {'precision': 0.3885823025689819, 'recall': 0.2036095323561671, 'f1-score': 0.2672075372939021, 'support': 10029}, '1': {'precision': 0.40793587630038086, 'recall': 0.6209761163032191, 'f1-score': 0.4924005901121899, 'support': 11556}, '2': {'precision': 0.3915716521350324, 'recall': 0.3431958459880474, 'f1-score': 0.36579125985485306, 'support': 10207}, 'accuracy': 0.4001321087065928, 'macro avg': {'precision': 0.39602994366813177, 'recall': 0.3892604982158112, 'f1-score': 0.37513312908698165, 'support': 31792}, 'weighted avg': {'precision': 0.3965768354407963, 'recall': 0.4001321087065928, 'f1-score': 0.38071329265838877, 'support': 31792}}
[[2042 5150 2837]
 [1774 7176 2606]
 [1439 5265 3503]]
training model: results/XRAY/W8/deepVOL_L3/h100
Epoch 1/50
327/327 - 16s - loss: 3.3364 - accuracy100: 0.3546 - val_loss: 3.3598 - val_accuracy100: 0.3983 - 16s/epoch - 49ms/step
Epoch 2/50
327/327 - 14s - loss: 3.3100 - accuracy100: 0.3551 - val_loss: 3.2704 - val_accuracy100: 0.3932 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2838 - accuracy100: 0.3711 - val_loss: 3.2690 - val_accuracy100: 0.3904 - 14s/epoch - 42ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2761 - accuracy100: 0.3780 - val_loss: 3.2571 - val_accuracy100: 0.4013 - 14s/epoch - 42ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2700 - accuracy100: 0.3825 - val_loss: 3.2544 - val_accuracy100: 0.3981 - 14s/epoch - 42ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2656 - accuracy100: 0.3887 - val_loss: 3.2711 - val_accuracy100: 0.3829 - 14s/epoch - 41ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2549 - accuracy100: 0.3956 - val_loss: 3.2774 - val_accuracy100: 0.3769 - 14s/epoch - 44ms/step
Epoch 8/50
327/327 - 14s - loss: 3.2520 - accuracy100: 0.3984 - val_loss: 3.2944 - val_accuracy100: 0.3630 - 14s/epoch - 41ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2449 - accuracy100: 0.4009 - val_loss: 3.2871 - val_accuracy100: 0.3696 - 14s/epoch - 41ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2420 - accuracy100: 0.4037 - val_loss: 3.2794 - val_accuracy100: 0.3733 - 14s/epoch - 41ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2363 - accuracy100: 0.4078 - val_loss: 3.2656 - val_accuracy100: 0.3848 - 14s/epoch - 41ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2308 - accuracy100: 0.4105 - val_loss: 3.2428 - val_accuracy100: 0.3996 - 14s/epoch - 42ms/step
Epoch 13/50
327/327 - 14s - loss: 3.2271 - accuracy100: 0.4112 - val_loss: 3.2173 - val_accuracy100: 0.4165 - 14s/epoch - 42ms/step
Epoch 14/50
327/327 - 13s - loss: 3.2188 - accuracy100: 0.4156 - val_loss: 3.2180 - val_accuracy100: 0.4178 - 13s/epoch - 41ms/step
Epoch 15/50
327/327 - 14s - loss: 3.2163 - accuracy100: 0.4173 - val_loss: 3.2264 - val_accuracy100: 0.4128 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 14s - loss: 3.2110 - accuracy100: 0.4177 - val_loss: 3.2259 - val_accuracy100: 0.4164 - 14s/epoch - 41ms/step
Epoch 17/50
327/327 - 14s - loss: 3.2021 - accuracy100: 0.4222 - val_loss: 3.2197 - val_accuracy100: 0.4179 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 13s - loss: 3.1973 - accuracy100: 0.4264 - val_loss: 3.2239 - val_accuracy100: 0.4119 - 13s/epoch - 41ms/step
Epoch 19/50
327/327 - 14s - loss: 3.1905 - accuracy100: 0.4289 - val_loss: 3.2243 - val_accuracy100: 0.4165 - 14s/epoch - 42ms/step
Epoch 20/50
327/327 - 13s - loss: 3.1858 - accuracy100: 0.4307 - val_loss: 3.2228 - val_accuracy100: 0.4214 - 13s/epoch - 41ms/step
Epoch 21/50
327/327 - 14s - loss: 3.1801 - accuracy100: 0.4320 - val_loss: 3.2277 - val_accuracy100: 0.4183 - 14s/epoch - 42ms/step
Epoch 22/50
327/327 - 14s - loss: 3.1741 - accuracy100: 0.4350 - val_loss: 3.2327 - val_accuracy100: 0.4150 - 14s/epoch - 41ms/step
Epoch 23/50
327/327 - 14s - loss: 3.1672 - accuracy100: 0.4376 - val_loss: 3.2280 - val_accuracy100: 0.4214 - 14s/epoch - 42ms/step
testing model: results/XRAY/W8/deepVOL_L3/h100
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0168288
{'0': {'precision': 0.30798035306132376, 'recall': 0.0972153997298293, 'f1-score': 0.147782561517729, 'support': 65144}, '1': {'precision': 0.5895522056108855, 'recall': 0.8092403316603778, 'f1-score': 0.6821446493135527, 'support': 163782}, '2': {'precision': 0.2937777180486494, 'recall': 0.2232662649371872, 'f1-score': 0.25371402042711233, 'support': 68537}, 'accuracy': 0.5182963931648642, 'macro avg': {'precision': 0.3971034255736196, 'recall': 0.3765739987757981, 'f1-score': 0.36121374375279797, 'support': 297463}, 'weighted avg': {'precision': 0.459740387614894, 'recall': 0.5182963931648642, 'f1-score': 0.4664074522189187, 'support': 297463}}
[[  6333  45239  13572]
 [  8030 132539  23213]
 [  6200  47035  15302]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0836731
{'0': {'precision': 0.42218021424070573, 'recall': 0.1664419050322947, 'f1-score': 0.23875582253671698, 'support': 28178}, '1': {'precision': 0.3877951509780338, 'recall': 0.666304111376985, 'f1-score': 0.4902564923372414, 'support': 27582}, '2': {'precision': 0.39020014352922416, 'recall': 0.35177197900941704, 'f1-score': 0.3699909269620445, 'support': 27822}, 'accuracy': 0.39308702830753034, 'macro avg': {'precision': 0.40005850291598793, 'recall': 0.39483933180623226, 'f1-score': 0.36633441394533434, 'support': 83582}, 'weighted avg': {'precision': 0.4001879390828265, 'recall': 0.39308702830753034, 'f1-score': 0.3654351859135149, 'support': 83582}}
[[ 4690 14764  8724]
 [ 2633 18378  6571]
 [ 3786 14249  9787]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0716022
{'0': {'precision': 0.3741250301713734, 'recall': 0.16279802541749816, 'f1-score': 0.2268735362997658, 'support': 9521}, '1': {'precision': 0.4537259923175416, 'recall': 0.6989349112426035, 'f1-score': 0.5502484472049689, 'support': 12675}, '2': {'precision': 0.36472181191531267, 'recall': 0.30877448937057106, 'f1-score': 0.3344243792325057, 'support': 9596}, 'accuracy': 0.42060895822848515, 'macro avg': {'precision': 0.39752427813474256, 'recall': 0.39016914201022423, 'f1-score': 0.3705154542457468, 'support': 31792}, 'weighted avg': {'precision': 0.40302251736367095, 'recall': 0.42060895822848515, 'f1-score': 0.388261145903, 'support': 31792}}
[[1550 5351 2620]
 [1275 8859 2541]
 [1318 5315 2963]]
training model: results/XRAY/W8/deepVOL_L3/h200
Epoch 1/50
327/327 - 16s - loss: 3.3364 - accuracy200: 0.3587 - val_loss: 3.3252 - val_accuracy200: 0.3568 - 16s/epoch - 50ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2912 - accuracy200: 0.3740 - val_loss: 3.3091 - val_accuracy200: 0.3537 - 14s/epoch - 44ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2757 - accuracy200: 0.3837 - val_loss: 3.2927 - val_accuracy200: 0.3700 - 14s/epoch - 43ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2633 - accuracy200: 0.3898 - val_loss: 3.2966 - val_accuracy200: 0.3737 - 14s/epoch - 42ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2581 - accuracy200: 0.3919 - val_loss: 3.3276 - val_accuracy200: 0.3559 - 14s/epoch - 44ms/step
Epoch 6/50
327/327 - 13s - loss: 3.2512 - accuracy200: 0.3942 - val_loss: 3.2948 - val_accuracy200: 0.3710 - 13s/epoch - 41ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2413 - accuracy200: 0.4001 - val_loss: 3.2959 - val_accuracy200: 0.3755 - 14s/epoch - 43ms/step
Epoch 8/50
327/327 - 14s - loss: 3.2339 - accuracy200: 0.4036 - val_loss: 3.2826 - val_accuracy200: 0.3829 - 14s/epoch - 43ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2276 - accuracy200: 0.4073 - val_loss: 3.2772 - val_accuracy200: 0.3842 - 14s/epoch - 43ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2183 - accuracy200: 0.4108 - val_loss: 3.2863 - val_accuracy200: 0.3841 - 14s/epoch - 42ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2141 - accuracy200: 0.4120 - val_loss: 3.2656 - val_accuracy200: 0.3911 - 14s/epoch - 43ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2109 - accuracy200: 0.4147 - val_loss: 3.2881 - val_accuracy200: 0.3765 - 14s/epoch - 43ms/step
Epoch 13/50
327/327 - 14s - loss: 3.2072 - accuracy200: 0.4141 - val_loss: 3.2713 - val_accuracy200: 0.3866 - 14s/epoch - 43ms/step
Epoch 14/50
327/327 - 14s - loss: 3.2018 - accuracy200: 0.4174 - val_loss: 3.2679 - val_accuracy200: 0.3908 - 14s/epoch - 43ms/step
Epoch 15/50
327/327 - 13s - loss: 3.1954 - accuracy200: 0.4231 - val_loss: 3.2817 - val_accuracy200: 0.3863 - 13s/epoch - 41ms/step
Epoch 16/50
327/327 - 13s - loss: 3.1893 - accuracy200: 0.4254 - val_loss: 3.2860 - val_accuracy200: 0.3889 - 13s/epoch - 41ms/step
Epoch 17/50
327/327 - 14s - loss: 3.1838 - accuracy200: 0.4289 - val_loss: 3.2794 - val_accuracy200: 0.3898 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 14s - loss: 3.1766 - accuracy200: 0.4322 - val_loss: 3.2910 - val_accuracy200: 0.3893 - 14s/epoch - 42ms/step
Epoch 19/50
327/327 - 14s - loss: 3.1712 - accuracy200: 0.4313 - val_loss: 3.2840 - val_accuracy200: 0.3880 - 14s/epoch - 42ms/step
Epoch 20/50
327/327 - 14s - loss: 3.1647 - accuracy200: 0.4355 - val_loss: 3.2842 - val_accuracy200: 0.3875 - 14s/epoch - 42ms/step
Epoch 21/50
327/327 - 14s - loss: 3.1605 - accuracy200: 0.4400 - val_loss: 3.2903 - val_accuracy200: 0.3901 - 14s/epoch - 42ms/step
testing model: results/XRAY/W8/deepVOL_L3/h200
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0491091
{'0': {'precision': 0.32963006049325266, 'recall': 0.14532073391201775, 'f1-score': 0.20171387383539335, 'support': 77993}, '1': {'precision': 0.500996083427069, 'recall': 0.8119897791086739, 'f1-score': 0.6196619639614471, 'support': 136583}, '2': {'precision': 0.34098101265822783, 'recall': 0.17159506315827572, 'f1-score': 0.22830038764356053, 'support': 82887}, 'accuracy': 0.4587494915334008, 'macro avg': {'precision': 0.3905357188595165, 'recall': 0.37630185872632244, 'f1-score': 0.3498920751468004, 'support': 297463}, 'weighted avg': {'precision': 0.4114773217743792, 'recall': 0.4587494915334008, 'f1-score': 0.4010269997156015, 'support': 297463}}
[[ 11334  52703  13956]
 [ 12146 110904  13533]
 [ 10904  57760  14223]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0789738
{'0': {'precision': 0.4059926918392205, 'recall': 0.28895901241417576, 'f1-score': 0.3376212953021494, 'support': 28838}, '1': {'precision': 0.39736958770503916, 'recall': 0.5976662344878682, 'f1-score': 0.47735846265366805, 'support': 26995}, '2': {'precision': 0.38111779113783123, 'recall': 0.3084075101805471, 'f1-score': 0.3409290096406661, 'support': 27749}, 'accuracy': 0.3951209590581704, 'macro avg': {'precision': 0.3948266902273636, 'recall': 0.3983442523608636, 'f1-score': 0.38530292253216114, 'support': 83582}, 'weighted avg': {'precision': 0.3949492337302368, 'recall': 0.3951209590581704, 'f1-score': 0.38385123234402135, 'support': 83582}}
[[ 8333 12325  8180]
 [ 5144 16134  5717]
 [ 7048 12143  8558]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088625
{'0': {'precision': 0.35084789311408016, 'recall': 0.27058357277320916, 'f1-score': 0.30553224814006824, 'support': 10093}, '1': {'precision': 0.42177448719504795, 'recall': 0.6014191761855313, 'f1-score': 0.49582649639723186, 'support': 11556}, '2': {'precision': 0.35816733067729084, 'recall': 0.2658976634131914, 'f1-score': 0.30521133933118316, 'support': 10143}, 'accuracy': 0.3893432310015098, 'macro avg': {'precision': 0.37692990366213963, 'recall': 0.3793001374573106, 'f1-score': 0.3688566946228278, 'support': 31792}, 'weighted avg': {'precision': 0.3789640473794082, 'recall': 0.3893432310015098, 'f1-score': 0.3745994774685553, 'support': 31792}}
[[2731 4666 2696]
 [2469 6950 2137]
 [2584 4862 2697]]
training model: results/XRAY/W8/deepVOL_L3/h300
Epoch 1/50
327/327 - 17s - loss: 3.3305 - accuracy300: 0.3621 - val_loss: 3.3241 - val_accuracy300: 0.3414 - 17s/epoch - 51ms/step
Epoch 2/50
327/327 - 14s - loss: 3.2952 - accuracy300: 0.3711 - val_loss: 3.3026 - val_accuracy300: 0.3531 - 14s/epoch - 44ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2841 - accuracy300: 0.3794 - val_loss: 3.3087 - val_accuracy300: 0.3191 - 14s/epoch - 42ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2761 - accuracy300: 0.3819 - val_loss: 3.3154 - val_accuracy300: 0.3362 - 14s/epoch - 43ms/step
Epoch 5/50
327/327 - 15s - loss: 3.2698 - accuracy300: 0.3876 - val_loss: 3.3160 - val_accuracy300: 0.3466 - 15s/epoch - 45ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2649 - accuracy300: 0.3883 - val_loss: 3.3080 - val_accuracy300: 0.3447 - 14s/epoch - 44ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2624 - accuracy300: 0.3913 - val_loss: 3.2740 - val_accuracy300: 0.3752 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 14s - loss: 3.2562 - accuracy300: 0.3924 - val_loss: 3.2610 - val_accuracy300: 0.3917 - 14s/epoch - 42ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2537 - accuracy300: 0.3903 - val_loss: 3.2612 - val_accuracy300: 0.3920 - 14s/epoch - 42ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2519 - accuracy300: 0.3928 - val_loss: 3.2780 - val_accuracy300: 0.3906 - 14s/epoch - 42ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2454 - accuracy300: 0.3999 - val_loss: 3.2834 - val_accuracy300: 0.3901 - 14s/epoch - 41ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2510 - accuracy300: 0.3955 - val_loss: 3.2761 - val_accuracy300: 0.3866 - 14s/epoch - 41ms/step
Epoch 13/50
327/327 - 13s - loss: 3.2397 - accuracy300: 0.4025 - val_loss: 3.2815 - val_accuracy300: 0.3929 - 13s/epoch - 41ms/step
Epoch 14/50
327/327 - 13s - loss: 3.2335 - accuracy300: 0.4051 - val_loss: 3.2800 - val_accuracy300: 0.3925 - 13s/epoch - 41ms/step
Epoch 15/50
327/327 - 14s - loss: 3.2287 - accuracy300: 0.4074 - val_loss: 3.2672 - val_accuracy300: 0.3993 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 13s - loss: 3.2237 - accuracy300: 0.4074 - val_loss: 3.2696 - val_accuracy300: 0.3962 - 13s/epoch - 41ms/step
Epoch 17/50
327/327 - 13s - loss: 3.2166 - accuracy300: 0.4124 - val_loss: 3.2639 - val_accuracy300: 0.3971 - 13s/epoch - 41ms/step
Epoch 18/50
327/327 - 14s - loss: 3.2123 - accuracy300: 0.4170 - val_loss: 3.2711 - val_accuracy300: 0.4006 - 14s/epoch - 42ms/step
testing model: results/XRAY/W8/deepVOL_L3/h300
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0676146
{'0': {'precision': 0.34037906559550735, 'recall': 0.11065750437406496, 'f1-score': 0.16701749014504955, 'support': 78874}, '1': {'precision': 0.5047494662573435, 'recall': 0.7698425532540464, 'f1-score': 0.6097286220356695, 'support': 136046}, '2': {'precision': 0.31607176170636153, 'recall': 0.24630798492906728, 'f1-score': 0.27686273975774, 'support': 82543}, 'accuracy': 0.44978030881151604, 'macro avg': {'precision': 0.3870667645197375, 'recall': 0.3756026808523929, 'f1-score': 0.351202950646153, 'support': 297463}, 'weighted avg': {'precision': 0.4088095518863012, 'recall': 0.44978030881151604, 'f1-score': 0.39997431196144884, 'support': 297463}}
[[  8728  49296  20850]
 [  8169 104734  23143]
 [  8745  53467  20331]]
Evaluating performance on  train set...
327/327 - 8s - 8s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0865346
{'0': {'precision': 0.391395592864638, 'recall': 0.18443824391622224, 'f1-score': 0.25072620333693435, 'support': 28313}, '1': {'precision': 0.4067716659241594, 'recall': 0.5484805653710247, 'f1-score': 0.46711506342256126, 'support': 28300}, '2': {'precision': 0.3457498207661856, 'recall': 0.4112870332604101, 'f1-score': 0.3756816257408976, 'support': 26969}, 'accuracy': 0.38089540810222294, 'macro avg': {'precision': 0.3813056931849943, 'recall': 0.3814019475158857, 'f1-score': 0.36450763083346444, 'support': 83582}, 'weighted avg': {'precision': 0.38187347135356253, 'recall': 0.38089540810222294, 'f1-score': 0.36431199366542283, 'support': 83582}}
[[ 5222 11469 11622]
 [ 3411 15522  9367]
 [ 4709 11168 11092]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0876532
{'0': {'precision': 0.3518987341772152, 'recall': 0.1546318770226537, 'f1-score': 0.21485280685730346, 'support': 9888}, '1': {'precision': 0.43693139906565037, 'recall': 0.5928768037367587, 'f1-score': 0.5030965778391194, 'support': 11989}, '2': {'precision': 0.33267734144377853, 'recall': 0.3750882501260716, 'f1-score': 0.3526121171897222, 'support': 9915}, 'accuracy': 0.38865123301459487, 'macro avg': {'precision': 0.373835824895548, 'recall': 0.37419897696182797, 'f1-score': 0.3568538339620484, 'support': 31792}, 'weighted avg': {'precision': 0.3779705922042479, 'recall': 0.38865123301459487, 'f1-score': 0.36651480145490417, 'support': 31792}}
[[1529 4509 3850]
 [1271 7108 3610]
 [1545 4651 3719]]
training model: results/XRAY/W8/deepVOL_L3/h500
Epoch 1/50
327/327 - 16s - loss: 3.3355 - accuracy500: 0.3599 - val_loss: 3.3322 - val_accuracy500: 0.3219 - 16s/epoch - 50ms/step
Epoch 2/50
327/327 - 14s - loss: 3.3044 - accuracy500: 0.3665 - val_loss: 3.3234 - val_accuracy500: 0.3383 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 14s - loss: 3.2981 - accuracy500: 0.3689 - val_loss: 3.3507 - val_accuracy500: 0.3200 - 14s/epoch - 42ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2839 - accuracy500: 0.3765 - val_loss: 3.3570 - val_accuracy500: 0.3139 - 14s/epoch - 42ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2767 - accuracy500: 0.3793 - val_loss: 3.3159 - val_accuracy500: 0.3315 - 14s/epoch - 41ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2759 - accuracy500: 0.3780 - val_loss: 3.2852 - val_accuracy500: 0.3616 - 14s/epoch - 42ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2717 - accuracy500: 0.3830 - val_loss: 3.3194 - val_accuracy500: 0.3273 - 14s/epoch - 41ms/step
Epoch 8/50
327/327 - 14s - loss: 3.2627 - accuracy500: 0.3864 - val_loss: 3.3346 - val_accuracy500: 0.3550 - 14s/epoch - 41ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2798 - accuracy500: 0.3755 - val_loss: 3.2821 - val_accuracy500: 0.3666 - 14s/epoch - 42ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2645 - accuracy500: 0.3777 - val_loss: 3.2919 - val_accuracy500: 0.3787 - 14s/epoch - 42ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2551 - accuracy500: 0.3862 - val_loss: 3.2731 - val_accuracy500: 0.3928 - 14s/epoch - 43ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2435 - accuracy500: 0.3950 - val_loss: 3.2813 - val_accuracy500: 0.3770 - 14s/epoch - 43ms/step
Epoch 13/50
327/327 - 14s - loss: 3.2403 - accuracy500: 0.3991 - val_loss: 3.2897 - val_accuracy500: 0.3812 - 14s/epoch - 42ms/step
Epoch 14/50
327/327 - 14s - loss: 3.2429 - accuracy500: 0.3981 - val_loss: 3.2974 - val_accuracy500: 0.3668 - 14s/epoch - 42ms/step
Epoch 15/50
327/327 - 14s - loss: 3.2404 - accuracy500: 0.3970 - val_loss: 3.2792 - val_accuracy500: 0.3929 - 14s/epoch - 42ms/step
Epoch 16/50
327/327 - 14s - loss: 3.2324 - accuracy500: 0.4010 - val_loss: 3.2550 - val_accuracy500: 0.4059 - 14s/epoch - 42ms/step
Epoch 17/50
327/327 - 14s - loss: 3.2271 - accuracy500: 0.4050 - val_loss: 3.2513 - val_accuracy500: 0.4067 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 13s - loss: 3.2232 - accuracy500: 0.4056 - val_loss: 3.2452 - val_accuracy500: 0.4070 - 13s/epoch - 41ms/step
Epoch 19/50
327/327 - 13s - loss: 3.2168 - accuracy500: 0.4076 - val_loss: 3.2468 - val_accuracy500: 0.4054 - 13s/epoch - 41ms/step
Epoch 20/50
327/327 - 14s - loss: 3.2143 - accuracy500: 0.4102 - val_loss: 3.2466 - val_accuracy500: 0.4076 - 14s/epoch - 42ms/step
Epoch 21/50
327/327 - 14s - loss: 3.2119 - accuracy500: 0.4134 - val_loss: 3.2532 - val_accuracy500: 0.4041 - 14s/epoch - 42ms/step
Epoch 22/50
327/327 - 13s - loss: 3.2022 - accuracy500: 0.4172 - val_loss: 3.2569 - val_accuracy500: 0.3997 - 13s/epoch - 41ms/step
Epoch 23/50
327/327 - 14s - loss: 3.2011 - accuracy500: 0.4194 - val_loss: 3.2617 - val_accuracy500: 0.4010 - 14s/epoch - 42ms/step
Epoch 24/50
327/327 - 14s - loss: 3.1951 - accuracy500: 0.4218 - val_loss: 3.2656 - val_accuracy500: 0.3943 - 14s/epoch - 42ms/step
Epoch 25/50
327/327 - 14s - loss: 3.1900 - accuracy500: 0.4214 - val_loss: 3.2570 - val_accuracy500: 0.4064 - 14s/epoch - 42ms/step
Epoch 26/50
327/327 - 14s - loss: 3.1895 - accuracy500: 0.4217 - val_loss: 3.2629 - val_accuracy500: 0.4042 - 14s/epoch - 42ms/step
Epoch 27/50
327/327 - 14s - loss: 3.1919 - accuracy500: 0.4221 - val_loss: 3.2586 - val_accuracy500: 0.4028 - 14s/epoch - 41ms/step
Epoch 28/50
327/327 - 14s - loss: 3.1938 - accuracy500: 0.4237 - val_loss: 3.2636 - val_accuracy500: 0.4034 - 14s/epoch - 43ms/step
testing model: results/XRAY/W8/deepVOL_L3/h500
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0494804
{'0': {'precision': 0.32153360864331104, 'recall': 0.2874306965086025, 'f1-score': 0.30352724552620974, 'support': 73409}, '1': {'precision': 0.5480811142811856, 'recall': 0.7610214720972778, 'f1-score': 0.6372327130952585, 'support': 145398}, '2': {'precision': 0.32632211538461536, 'recall': 0.12426261187957689, 'f1-score': 0.17998674130819092, 'support': 78656}, 'accuracy': 0.475773457539257, 'macro avg': {'precision': 0.398645612769704, 'recall': 0.3909049268284857, 'f1-score': 0.3735822333098864, 'support': 297463}, 'weighted avg': {'precision': 0.43353476176480754, 'recall': 0.475773457539257, 'f1-score': 0.43397340412015944, 'support': 297463}}
[[ 21100  42455   9854]
 [ 24423 110651  10324]
 [ 20100  48782   9774]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0810946
{'0': {'precision': 0.36487846533898566, 'recall': 0.4260532032335031, 'f1-score': 0.39310004928536224, 'support': 28081}, '1': {'precision': 0.43059158945117604, 'recall': 0.5218548080577727, 'f1-score': 0.4718507873031742, 'support': 28941}, '2': {'precision': 0.3660134877210841, 'recall': 0.2166039156626506, 'f1-score': 0.2721510005203652, 'support': 26560}, 'accuracy': 0.39266827785886915, 'macro avg': {'precision': 0.3871611808370819, 'recall': 0.38817064231797554, 'f1-score': 0.3790339457029672, 'support': 83582}, 'weighted avg': {'precision': 0.3879928885329681, 'recall': 0.39266827785886915, 'f1-score': 0.38193398929367955, 'support': 83582}}
[[11964 10093  6024]
 [ 9897 15103  3941]
 [10928  9879  5753]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0828248
{'0': {'precision': 0.34729764675459013, 'recall': 0.41429305912596404, 'f1-score': 0.3778486354684423, 'support': 9725}, '1': {'precision': 0.4743741765480896, 'recall': 0.5784865038560412, 'f1-score': 0.5212827566237151, 'support': 12448}, '2': {'precision': 0.34983037317900617, 'recall': 0.18224347645285371, 'f1-score': 0.23964456596035544, 'support': 9619}, 'accuracy': 0.40837317564167086, 'macro avg': {'precision': 0.39050073216056197, 'recall': 0.3916743464782863, 'f1-score': 0.37959198601750427, 'support': 31792}, 'weighted avg': {'precision': 0.3978201347498701, 'recall': 0.40837317564167086, 'f1-score': 0.39219447704942334, 'support': 31792}}
[[4029 3948 1748]
 [3737 7201 1510]
 [3835 4031 1753]]
training model: results/XRAY/W8/deepVOL_L3/h1000
Epoch 1/50
327/327 - 16s - loss: 3.3423 - accuracy1000: 0.3637 - val_loss: 3.3847 - val_accuracy1000: 0.3059 - 16s/epoch - 49ms/step
Epoch 2/50
327/327 - 14s - loss: 3.3167 - accuracy1000: 0.3601 - val_loss: 3.3833 - val_accuracy1000: 0.2983 - 14s/epoch - 42ms/step
Epoch 3/50
327/327 - 14s - loss: 3.3007 - accuracy1000: 0.3519 - val_loss: 3.3473 - val_accuracy1000: 0.3013 - 14s/epoch - 44ms/step
Epoch 4/50
327/327 - 14s - loss: 3.2984 - accuracy1000: 0.3540 - val_loss: 3.3606 - val_accuracy1000: 0.2977 - 14s/epoch - 42ms/step
Epoch 5/50
327/327 - 14s - loss: 3.2962 - accuracy1000: 0.3494 - val_loss: 3.3454 - val_accuracy1000: 0.3116 - 14s/epoch - 43ms/step
Epoch 6/50
327/327 - 14s - loss: 3.2852 - accuracy1000: 0.3647 - val_loss: 3.3482 - val_accuracy1000: 0.3238 - 14s/epoch - 42ms/step
Epoch 7/50
327/327 - 14s - loss: 3.2855 - accuracy1000: 0.3637 - val_loss: 3.3412 - val_accuracy1000: 0.3300 - 14s/epoch - 42ms/step
Epoch 8/50
327/327 - 13s - loss: 3.2767 - accuracy1000: 0.3732 - val_loss: 3.3341 - val_accuracy1000: 0.3564 - 13s/epoch - 41ms/step
Epoch 9/50
327/327 - 14s - loss: 3.2724 - accuracy1000: 0.3750 - val_loss: 3.3352 - val_accuracy1000: 0.3573 - 14s/epoch - 42ms/step
Epoch 10/50
327/327 - 14s - loss: 3.2636 - accuracy1000: 0.3833 - val_loss: 3.3468 - val_accuracy1000: 0.3585 - 14s/epoch - 43ms/step
Epoch 11/50
327/327 - 14s - loss: 3.2643 - accuracy1000: 0.3824 - val_loss: 3.3050 - val_accuracy1000: 0.3725 - 14s/epoch - 44ms/step
Epoch 12/50
327/327 - 14s - loss: 3.2544 - accuracy1000: 0.3919 - val_loss: 3.3224 - val_accuracy1000: 0.3635 - 14s/epoch - 44ms/step
Epoch 13/50
327/327 - 14s - loss: 3.2450 - accuracy1000: 0.3989 - val_loss: 3.3115 - val_accuracy1000: 0.3713 - 14s/epoch - 42ms/step
Epoch 14/50
327/327 - 14s - loss: 3.2388 - accuracy1000: 0.4004 - val_loss: 3.3265 - val_accuracy1000: 0.3662 - 14s/epoch - 41ms/step
Epoch 15/50
327/327 - 13s - loss: 3.2275 - accuracy1000: 0.4102 - val_loss: 3.3619 - val_accuracy1000: 0.3498 - 13s/epoch - 41ms/step
Epoch 16/50
327/327 - 13s - loss: 3.2240 - accuracy1000: 0.4130 - val_loss: 3.3624 - val_accuracy1000: 0.3503 - 13s/epoch - 41ms/step
Epoch 17/50
327/327 - 14s - loss: 3.2140 - accuracy1000: 0.4225 - val_loss: 3.3662 - val_accuracy1000: 0.3422 - 14s/epoch - 42ms/step
Epoch 18/50
327/327 - 14s - loss: 3.2079 - accuracy1000: 0.4225 - val_loss: 3.3789 - val_accuracy1000: 0.3544 - 14s/epoch - 41ms/step
Epoch 19/50
327/327 - 14s - loss: 3.2015 - accuracy1000: 0.4220 - val_loss: 3.3695 - val_accuracy1000: 0.3532 - 14s/epoch - 42ms/step
Epoch 20/50
327/327 - 14s - loss: 3.2048 - accuracy1000: 0.4231 - val_loss: 3.4033 - val_accuracy1000: 0.3389 - 14s/epoch - 42ms/step
Epoch 21/50
327/327 - 14s - loss: 3.1894 - accuracy1000: 0.4274 - val_loss: 3.3853 - val_accuracy1000: 0.3474 - 14s/epoch - 42ms/step
testing model: results/XRAY/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961635
{'0': {'precision': 0.2544831754986903, 'recall': 0.2426912624557358, 'f1-score': 0.2484473795138401, 'support': 72858}, '1': {'precision': 0.5565720109944275, 'recall': 0.45420456249914776, 'f1-score': 0.5002046018523038, 'support': 146674}, '2': {'precision': 0.27643049758043664, 'recall': 0.3840961876531804, 'f1-score': 0.32148860188491796, 'support': 77931}, 'accuracy': 0.3840309551103835, 'macro avg': {'precision': 0.36249522802451817, 'recall': 0.3603306708693546, 'f1-score': 0.3567135277503539, 'support': 297463}, 'weighted avg': {'precision': 0.4091879778258851, 'recall': 0.3840309551103835, 'f1-score': 0.39172037255792386, 'support': 297463}}
[[17682 23277 31899]
 [33602 66620 46452]
 [18198 29800 29933]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0861176
{'0': {'precision': 0.3682123096508838, 'recall': 0.2517829042086584, 'f1-score': 0.2990654205607477, 'support': 29867}, '1': {'precision': 0.43707233007248214, 'recall': 0.318297589605404, 'f1-score': 0.36834686031610425, 'support': 27091}, '2': {'precision': 0.34819249366797145, 'recall': 0.5679837740384616, 'f1-score': 0.43172409855254523, 'support': 26624}, 'accuracy': 0.3740637936397789, 'macro avg': {'precision': 0.3844923777971125, 'recall': 0.3793547559508414, 'f1-score': 0.3663787931431324, 'support': 83582}, 'weighted avg': {'precision': 0.3841544889779215, 'recall': 0.3740637936397789, 'f1-score': 0.3637780157040319, 'support': 83582}}
[[ 7520  6036 16311]
 [ 6471  8623 11997]
 [ 6432  5070 15122]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975949
{'0': {'precision': 0.32554945054945056, 'recall': 0.26884603485614106, 'f1-score': 0.29449308105055066, 'support': 9697}, '1': {'precision': 0.48756218905472637, 'recall': 0.35470926115351326, 'f1-score': 0.41065816442723757, 'support': 12709}, '2': {'precision': 0.3169624432521667, 'recall': 0.4909439590880034, 'f1-score': 0.38521986289918075, 'support': 9386}, 'accuracy': 0.3687405636638148, 'macro avg': {'precision': 0.37669136095211453, 'recall': 0.3714997516992193, 'f1-score': 0.36345703612565633, 'support': 31792}, 'weighted avg': {'precision': 0.38777964189228026, 'recall': 0.3687405636638148, 'f1-score': 0.36771601823806815, 'support': 31792}}
[[2607 2295 4795]
 [3066 4508 5135]
 [2335 2443 4608]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  11.85 (ave)

============================================
