This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-06-26.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-18.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-05.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-06.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-14.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-10.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-12.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-07.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-28.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-24.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-13.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-04.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-06-19.csv
training model: results/AAL/W4/deepLOB_L1/h10
Epoch 1/50
2425/2425 - 47s - loss: 2.6647 - accuracy10: 0.4763 - val_loss: 3.4174 - val_accuracy10: 0.4059 - 47s/epoch - 19ms/step
Epoch 2/50
2425/2425 - 38s - loss: 2.5530 - accuracy10: 0.5074 - val_loss: 3.2801 - val_accuracy10: 0.3954 - 38s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 38s - loss: 2.4077 - accuracy10: 0.5712 - val_loss: 3.3033 - val_accuracy10: 0.3335 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 37s - loss: 2.3140 - accuracy10: 0.6024 - val_loss: 3.1822 - val_accuracy10: 0.3574 - 37s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 38s - loss: 2.2801 - accuracy10: 0.6125 - val_loss: 3.4812 - val_accuracy10: 0.3014 - 38s/epoch - 16ms/step
Epoch 6/50
2425/2425 - 38s - loss: 2.2411 - accuracy10: 0.6222 - val_loss: 3.3354 - val_accuracy10: 0.3843 - 38s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 38s - loss: 2.2139 - accuracy10: 0.6286 - val_loss: 3.4027 - val_accuracy10: 0.4368 - 38s/epoch - 16ms/step
Epoch 8/50
2425/2425 - 38s - loss: 2.1925 - accuracy10: 0.6327 - val_loss: 3.1284 - val_accuracy10: 0.4325 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 37s - loss: 2.1753 - accuracy10: 0.6360 - val_loss: 3.4047 - val_accuracy10: 0.3566 - 37s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 37s - loss: 2.1597 - accuracy10: 0.6383 - val_loss: 3.5251 - val_accuracy10: 0.3331 - 37s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 38s - loss: 2.1468 - accuracy10: 0.6401 - val_loss: 3.6534 - val_accuracy10: 0.3390 - 38s/epoch - 16ms/step
Epoch 12/50
2425/2425 - 37s - loss: 2.1345 - accuracy10: 0.6418 - val_loss: 3.6250 - val_accuracy10: 0.3346 - 37s/epoch - 15ms/step
Epoch 13/50
2425/2425 - 38s - loss: 2.1247 - accuracy10: 0.6434 - val_loss: 3.1956 - val_accuracy10: 0.4661 - 38s/epoch - 16ms/step
Epoch 14/50
2425/2425 - 37s - loss: 2.1161 - accuracy10: 0.6452 - val_loss: 3.1970 - val_accuracy10: 0.3899 - 37s/epoch - 15ms/step
Epoch 15/50
2425/2425 - 38s - loss: 2.1074 - accuracy10: 0.6457 - val_loss: 3.4086 - val_accuracy10: 0.3597 - 38s/epoch - 16ms/step
Epoch 16/50
2425/2425 - 37s - loss: 2.0999 - accuracy10: 0.6470 - val_loss: 3.4383 - val_accuracy10: 0.3507 - 37s/epoch - 15ms/step
Epoch 17/50
2425/2425 - 38s - loss: 2.0929 - accuracy10: 0.6483 - val_loss: 3.5210 - val_accuracy10: 0.3433 - 38s/epoch - 16ms/step
Epoch 18/50
2425/2425 - 38s - loss: 2.0867 - accuracy10: 0.6494 - val_loss: 3.3999 - val_accuracy10: 0.3619 - 38s/epoch - 16ms/step
testing model: results/AAL/W4/deepLOB_L1/h10
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0345987
{'0': {'precision': 0.28871197476854205, 'recall': 0.593099404340304, 'f1-score': 0.3883708110779524, 'support': 172246}, '1': {'precision': 0.8433209352842329, 'recall': 0.41157519689961247, 'f1-score': 0.5531772249311929, 'support': 799900}, '2': {'precision': 0.2941438909487789, 'recall': 0.6912737763086966, 'f1-score': 0.41268583876762904, 'support': 168813}, 'accuracy': 0.4803625721870812, 'macro avg': {'precision': 0.47539226700051795, 'recall': 0.5653161258495376, 'f1-score': 0.4514112915922581, 'support': 1140959}, 'weighted avg': {'precision': 0.6783391967656826, 'recall': 0.4803625721870812, 'f1-score': 0.507510362289332, 'support': 1140959}}
[[102159  36413  33674]
 [224320 329219 246361]
 [ 27365  24752 116696]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9455394
{'0': {'precision': 0.29371972345462244, 'recall': 0.47089501595998695, 'f1-score': 0.36177998339351575, 'support': 79574}, '1': {'precision': 0.8579493464879849, 'recall': 0.5470496546735331, 'f1-score': 0.6681013912972601, 'support': 464488}, '2': {'precision': 0.24679431860868858, 'recall': 0.6340658624062602, 'f1-score': 0.3552978232828709, 'support': 76675}, 'accuracy': 0.5480356415035675, 'macro avg': {'precision': 0.46615446285043194, 'recall': 0.5506701776799267, 'f1-score': 0.4617263993245489, 'support': 620737}, 'weighted avg': {'precision': 0.7101277734451313, 'recall': 0.5480356415035675, 'f1-score': 0.5901949135296455, 'support': 620737}}
[[ 37471  24155  17948]
 [ 79961 254098 130429]
 [ 10142  17916  48617]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2055304
{'0': {'precision': 0.3673355836640825, 'recall': 0.3667098685428624, 'f1-score': 0.36702245941738937, 'support': 27005}, '1': {'precision': 0.8708883525013015, 'recall': 0.3724270534660145, 'f1-score': 0.5217378976617584, 'support': 148225}, '2': {'precision': 0.19864533352574046, 'recall': 0.8473761157279163, 'f1-score': 0.32184294356606363, 'support': 25992}, 'accuracy': 0.4330093130969775, 'macro avg': {'precision': 0.47895642323037485, 'recall': 0.5288376792455978, 'f1-score': 0.40353443354840385, 'support': 201222}, 'weighted avg': {'precision': 0.7164749033175051, 'recall': 0.4330093130969775, 'f1-score': 0.4751537266633363, 'support': 201222}}
[[ 9903  5801 11301]
 [15472 55203 77550]
 [ 1584  2383 22025]]
training model: results/AAL/W4/deepLOB_L1/h20
Epoch 1/50
2425/2425 - 40s - loss: 2.8010 - accuracy20: 0.4656 - val_loss: 3.2631 - val_accuracy20: 0.5305 - 40s/epoch - 17ms/step
Epoch 2/50
2425/2425 - 39s - loss: 2.7045 - accuracy20: 0.4920 - val_loss: 3.0911 - val_accuracy20: 0.5012 - 39s/epoch - 16ms/step
Epoch 3/50
2425/2425 - 39s - loss: 2.5721 - accuracy20: 0.5507 - val_loss: 3.2907 - val_accuracy20: 0.6367 - 39s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 38s - loss: 2.4716 - accuracy20: 0.5884 - val_loss: 3.0236 - val_accuracy20: 0.6113 - 38s/epoch - 16ms/step
Epoch 5/50
2425/2425 - 37s - loss: 2.4187 - accuracy20: 0.6050 - val_loss: 2.9805 - val_accuracy20: 0.6167 - 37s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 38s - loss: 2.3813 - accuracy20: 0.6119 - val_loss: 2.9804 - val_accuracy20: 0.6257 - 38s/epoch - 16ms/step
Epoch 7/50
2425/2425 - 38s - loss: 2.3536 - accuracy20: 0.6172 - val_loss: 2.9519 - val_accuracy20: 0.5983 - 38s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 38s - loss: 2.3343 - accuracy20: 0.6199 - val_loss: 3.0216 - val_accuracy20: 0.6254 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 37s - loss: 2.3175 - accuracy20: 0.6232 - val_loss: 2.9935 - val_accuracy20: 0.6132 - 37s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 37s - loss: 2.3045 - accuracy20: 0.6256 - val_loss: 3.0061 - val_accuracy20: 0.6109 - 37s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 37s - loss: 2.2905 - accuracy20: 0.6271 - val_loss: 2.9983 - val_accuracy20: 0.6165 - 37s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 37s - loss: 2.2803 - accuracy20: 0.6288 - val_loss: 2.9414 - val_accuracy20: 0.6001 - 37s/epoch - 15ms/step
Epoch 13/50
2425/2425 - 38s - loss: 2.2719 - accuracy20: 0.6302 - val_loss: 3.0137 - val_accuracy20: 0.6102 - 38s/epoch - 16ms/step
Epoch 14/50
2425/2425 - 38s - loss: 2.2632 - accuracy20: 0.6317 - val_loss: 3.0202 - val_accuracy20: 0.6254 - 38s/epoch - 16ms/step
Epoch 15/50
2425/2425 - 38s - loss: 2.2560 - accuracy20: 0.6329 - val_loss: 3.0427 - val_accuracy20: 0.6139 - 38s/epoch - 15ms/step
Epoch 16/50
2425/2425 - 38s - loss: 2.2490 - accuracy20: 0.6346 - val_loss: 3.0522 - val_accuracy20: 0.6143 - 38s/epoch - 16ms/step
Epoch 17/50
2425/2425 - 37s - loss: 2.2410 - accuracy20: 0.6355 - val_loss: 3.0189 - val_accuracy20: 0.6203 - 37s/epoch - 15ms/step
Epoch 18/50
2425/2425 - 38s - loss: 2.2354 - accuracy20: 0.6361 - val_loss: 3.0185 - val_accuracy20: 0.6168 - 38s/epoch - 16ms/step
Epoch 19/50
2425/2425 - 37s - loss: 2.2297 - accuracy20: 0.6367 - val_loss: 3.0144 - val_accuracy20: 0.6193 - 37s/epoch - 15ms/step
Epoch 20/50
2425/2425 - 37s - loss: 2.2255 - accuracy20: 0.6375 - val_loss: 3.0376 - val_accuracy20: 0.6142 - 37s/epoch - 15ms/step
Epoch 21/50
2425/2425 - 37s - loss: 2.2201 - accuracy20: 0.6382 - val_loss: 3.0472 - val_accuracy20: 0.6147 - 37s/epoch - 15ms/step
Epoch 22/50
2425/2425 - 38s - loss: 2.2163 - accuracy20: 0.6385 - val_loss: 3.0491 - val_accuracy20: 0.6123 - 38s/epoch - 15ms/step
testing model: results/AAL/W4/deepLOB_L1/h20
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87705296
{'0': {'precision': 0.4490786917948449, 'recall': 0.4481024593384144, 'f1-score': 0.44859004444211387, 'support': 229086}, '1': {'precision': 0.7371556074644168, 'recall': 0.6154442862922826, 'f1-score': 0.6708239573526064, 'support': 687102}, '2': {'precision': 0.39450158835130317, 'recall': 0.5944895026493632, 'f1-score': 0.47427536038985824, 'support': 224771}, 'accuracy': 0.5777166401246671, 'macro avg': {'precision': 0.5269119625368549, 'recall': 0.5526787494266867, 'f1-score': 0.5312297873948595, 'support': 1140959}, 'weighted avg': {'precision': 0.611810985235964, 'recall': 0.5777166401246671, 'f1-score': 0.5874825727271054, 'support': 1140959}}
[[102654  85682  40750]
 [ 99887 422873 164342]
 [ 26047  65100 133624]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78566587
{'0': {'precision': 0.4766850934348664, 'recall': 0.28562155764072505, 'f1-score': 0.35720936895637845, 'support': 104761}, '1': {'precision': 0.7647156559530789, 'recall': 0.779846004516749, 'f1-score': 0.7722067226568492, 'support': 413129}, '2': {'precision': 0.39707162875101526, 'recall': 0.5276284189135317, 'f1-score': 0.45313348085674915, 'support': 102847}, 'accuracy': 0.654647620489837, 'macro avg': {'precision': 0.5461574593796535, 'recall': 0.5310319936903353, 'f1-score': 0.527516524156659, 'support': 620737}, 'weighted avg': {'precision': 0.6551918881969743, 'recall': 0.654647620489837, 'f1-score': 0.6493023952679068, 'support': 620737}}
[[ 29922  57930  16909]
 [ 25463 322177  65489]
 [  7386  41196  54265]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85522187
{'0': {'precision': 0.4832232043250665, 'recall': 0.3185224990808044, 'f1-score': 0.38395581542028195, 'support': 35357}, '1': {'precision': 0.7923868966419375, 'recall': 0.6459440932287303, 'f1-score': 0.7117105020225246, 'support': 131290}, '2': {'precision': 0.35010579771476935, 'recall': 0.7178308026030369, 'f1-score': 0.4706585123026597, 'support': 34575}, 'accuracy': 0.6007643299440419, 'macro avg': {'precision': 0.5419052995605912, 'recall': 0.5607657983041905, 'f1-score': 0.522108276581822, 'support': 201222}, 'weighted avg': {'precision': 0.6620682949748513, 'recall': 0.6007643299440419, 'f1-score': 0.6127014722009354, 'support': 201222}}
[[11262 14895  9200]
 [ 9613 84806 36871]
 [ 2431  7325 24819]]
training model: results/AAL/W4/deepLOB_L1/h30
Epoch 1/50
2425/2425 - 40s - loss: 2.8671 - accuracy30: 0.4794 - val_loss: 3.2104 - val_accuracy30: 0.3929 - 40s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 38s - loss: 2.8009 - accuracy30: 0.4900 - val_loss: 3.0841 - val_accuracy30: 0.5203 - 38s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 38s - loss: 2.6795 - accuracy30: 0.5365 - val_loss: 3.1354 - val_accuracy30: 0.5638 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 38s - loss: 2.5662 - accuracy30: 0.5798 - val_loss: 3.2512 - val_accuracy30: 0.4953 - 38s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 37s - loss: 2.5081 - accuracy30: 0.5950 - val_loss: 3.0998 - val_accuracy30: 0.5108 - 37s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 38s - loss: 2.4758 - accuracy30: 0.6011 - val_loss: 3.0895 - val_accuracy30: 0.5117 - 38s/epoch - 16ms/step
Epoch 7/50
2425/2425 - 37s - loss: 2.4499 - accuracy30: 0.6057 - val_loss: 3.1099 - val_accuracy30: 0.4968 - 37s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 38s - loss: 2.4312 - accuracy30: 0.6087 - val_loss: 3.1394 - val_accuracy30: 0.4473 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 38s - loss: 2.4148 - accuracy30: 0.6114 - val_loss: 3.1235 - val_accuracy30: 0.4506 - 38s/epoch - 16ms/step
Epoch 10/50
2425/2425 - 38s - loss: 2.4019 - accuracy30: 0.6132 - val_loss: 3.1605 - val_accuracy30: 0.4326 - 38s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 37s - loss: 2.3925 - accuracy30: 0.6142 - val_loss: 3.1345 - val_accuracy30: 0.4289 - 37s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 37s - loss: 2.3834 - accuracy30: 0.6158 - val_loss: 3.2383 - val_accuracy30: 0.4075 - 37s/epoch - 15ms/step
testing model: results/AAL/W4/deepLOB_L1/h30
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0037181
{'0': {'precision': 0.3786723783672248, 'recall': 0.48676040973991525, 'f1-score': 0.42596657899769685, 'support': 267682}, '1': {'precision': 0.5461304012065489, 'recall': 0.3688700162201758, 'f1-score': 0.4403301378111633, 'support': 611584}, '2': {'precision': 0.3263182304952435, 'recall': 0.478568398849033, 'f1-score': 0.3880437005409894, 'support': 261693}, 'accuracy': 0.42168912292203314, 'macro avg': {'precision': 0.4170403366896724, 'recall': 0.4447329416030414, 'f1-score': 0.41811347244994984, 'support': 1140959}, 'weighted avg': {'precision': 0.4564262095049807, 'recall': 0.42168912292203314, 'f1-score': 0.42496774461486975, 'support': 1140959}}
[[130297  95018  42367]
 [169803 225595 216186]
 [ 43989  92466 125238]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93368095
{'0': {'precision': 0.34557763754026727, 'recall': 0.4908128562923575, 'f1-score': 0.40558554551397397, 'support': 122617}, '1': {'precision': 0.6605797897379571, 'recall': 0.5367128548776504, 'f1-score': 0.5922389424493008, 'support': 376503}, '2': {'precision': 0.35222910920929174, 'recall': 0.40745126092569295, 'f1-score': 0.3778331001406781, 'support': 121617}, 'accuracy': 0.5023206285431673, 'macro avg': {'precision': 0.45279551216250535, 'recall': 0.4783256573652337, 'f1-score': 0.45855252936798424, 'support': 620737}, 'weighted avg': {'precision': 0.5379428217307676, 'recall': 0.5023206285431673, 'f1-score': 0.513361293950715, 'support': 620737}}
[[ 60182  49403  13032]
 [ 96330 202074  78099]
 [ 17637  54427  49553]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.918599
{'0': {'precision': 0.39991643317111536, 'recall': 0.39393279101297696, 'f1-score': 0.3969020612269789, 'support': 41304}, '1': {'precision': 0.6466993343195266, 'recall': 0.5863216483092759, 'f1-score': 0.6150322257295853, 'support': 119298}, '2': {'precision': 0.3608332060485719, 'recall': 0.4652634170359429, 'f1-score': 0.406447589143619, 'support': 40620}, 'accuracy': 0.5223931776843487, 'macro avg': {'precision': 0.46914965784640467, 'recall': 0.48183928545273186, 'f1-score': 0.4727939587000611, 'support': 201222}, 'weighted avg': {'precision': 0.5383364163513117, 'recall': 0.5223931776843487, 'f1-score': 0.5281512870015257, 'support': 201222}}
[[16271 19982  5051]
 [20925 69947 28426]
 [ 3490 18231 18899]]
training model: results/AAL/W4/deepLOB_L1/h50
Epoch 1/50
2425/2425 - 40s - loss: 2.9754 - accuracy50: 0.4724 - val_loss: 3.3072 - val_accuracy50: 0.4432 - 40s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 39s - loss: 2.9547 - accuracy50: 0.4682 - val_loss: 3.2917 - val_accuracy50: 0.4941 - 39s/epoch - 16ms/step
Epoch 3/50
2425/2425 - 38s - loss: 2.9178 - accuracy50: 0.4789 - val_loss: 3.4493 - val_accuracy50: 0.4928 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 37s - loss: 2.8815 - accuracy50: 0.4955 - val_loss: 3.4843 - val_accuracy50: 0.4960 - 37s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 38s - loss: 2.8122 - accuracy50: 0.5265 - val_loss: 3.7001 - val_accuracy50: 0.4781 - 38s/epoch - 16ms/step
Epoch 6/50
2425/2425 - 38s - loss: 2.7476 - accuracy50: 0.5476 - val_loss: 3.4797 - val_accuracy50: 0.4039 - 38s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 37s - loss: 2.7106 - accuracy50: 0.5569 - val_loss: 3.4141 - val_accuracy50: 0.4167 - 37s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 37s - loss: 2.6826 - accuracy50: 0.5646 - val_loss: 3.4078 - val_accuracy50: 0.4062 - 37s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 38s - loss: 2.6624 - accuracy50: 0.5690 - val_loss: 3.5126 - val_accuracy50: 0.4343 - 38s/epoch - 16ms/step
Epoch 10/50
2425/2425 - 39s - loss: 2.6445 - accuracy50: 0.5724 - val_loss: 3.6387 - val_accuracy50: 0.4727 - 39s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 38s - loss: 2.6340 - accuracy50: 0.5744 - val_loss: 3.9381 - val_accuracy50: 0.5010 - 38s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 37s - loss: 2.6207 - accuracy50: 0.5769 - val_loss: 3.9092 - val_accuracy50: 0.5006 - 37s/epoch - 15ms/step
testing model: results/AAL/W4/deepLOB_L1/h50
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0635691
{'0': {'precision': 0.37234586268995395, 'recall': 0.4322229746100181, 'f1-score': 0.40005635041910625, 'support': 321938}, '1': {'precision': 0.45639350799425443, 'recall': 0.6379433855985178, 'f1-score': 0.5321089353008391, 'support': 509517}, '2': {'precision': 0.4804454051697517, 'recall': 0.08545608457402812, 'f1-score': 0.14510293371370575, 'support': 309504}, 'accuracy': 0.4300250929262138, 'macro avg': {'precision': 0.43639492528465335, 'recall': 0.385207481594188, 'f1-score': 0.35908940647788373, 'support': 1140959}, 'weighted avg': {'precision': 0.4392027303672137, 'recall': 0.4300250929262138, 'f1-score': 0.38986661933078287, 'support': 1140959}}
[[139149 176119   6670]
 [162542 325043  21932]
 [ 72018 211037  26449]]
Evaluating performance on  train set...
2425/2425 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0429488
{'0': {'precision': 0.3183618165496296, 'recall': 0.5105001883441855, 'f1-score': 0.3921612194806873, 'support': 148664}, '1': {'precision': 0.5303366793994848, 'recall': 0.5727079458701714, 'f1-score': 0.5507085086502926, 'support': 323149}, '2': {'precision': 0.43068535825545173, 'recall': 0.09654588917837287, 'f1-score': 0.15773306711718632, 'support': 148924}, 'accuracy': 0.4435711098259005, 'macro avg': {'precision': 0.4264612847348554, 'recall': 0.3932513411309099, 'f1-score': 0.36686759841605543, 'support': 620737}, 'weighted avg': {'precision': 0.45566172952415135, 'recall': 0.4435711098259005, 'f1-score': 0.41845644561556694, 'support': 620737}}
[[ 75893  69755   3016]
 [122089 185070  15990]
 [ 40404  94142  14378]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.010924
{'0': {'precision': 0.4162083379166208, 'recall': 0.30294841770251607, 'f1-score': 0.35065973147365126, 'support': 49959}, '1': {'precision': 0.5197457889563614, 'recall': 0.7579524033930255, 'f1-score': 0.616644168789987, 'support': 101856}, '2': {'precision': 0.44448529411764703, 'recall': 0.14682130062541746, 'f1-score': 0.22073120635355334, 'support': 49407}, 'accuracy': 0.4949309717625309, 'macro avg': {'precision': 0.46014647366354305, 'recall': 0.40257404057365304, 'f1-score': 0.3960117022057305, 'support': 201222}, 'weighted avg': {'precision': 0.4755606462533231, 'recall': 0.4949309717625309, 'f1-score': 0.45339567588670754, 'support': 201222}}
[[15135 33149  1675]
 [17263 77202  7391]
 [ 3966 38187  7254]]
training model: results/AAL/W4/deepLOB_L1/h100
Epoch 1/50
2425/2425 - 40s - loss: 3.1181 - accuracy100: 0.4511 - val_loss: 3.2923 - val_accuracy100: 0.3901 - 40s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 38s - loss: 3.1062 - accuracy100: 0.4433 - val_loss: 3.8331 - val_accuracy100: 0.3361 - 38s/epoch - 16ms/step
Epoch 3/50
2425/2425 - 37s - loss: 3.0681 - accuracy100: 0.4621 - val_loss: 3.6785 - val_accuracy100: 0.3645 - 37s/epoch - 15ms/step
Epoch 4/50
2425/2425 - 38s - loss: 3.0342 - accuracy100: 0.4777 - val_loss: 3.5930 - val_accuracy100: 0.3746 - 38s/epoch - 16ms/step
Epoch 5/50
2425/2425 - 38s - loss: 3.0002 - accuracy100: 0.4902 - val_loss: 3.7273 - val_accuracy100: 0.3758 - 38s/epoch - 16ms/step
Epoch 6/50
2425/2425 - 38s - loss: 2.9719 - accuracy100: 0.4990 - val_loss: 3.9541 - val_accuracy100: 0.3873 - 38s/epoch - 16ms/step
Epoch 7/50
2425/2425 - 37s - loss: 2.9467 - accuracy100: 0.5064 - val_loss: 3.9719 - val_accuracy100: 0.3906 - 37s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 38s - loss: 2.9287 - accuracy100: 0.5109 - val_loss: 4.0324 - val_accuracy100: 0.3933 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 37s - loss: 2.9145 - accuracy100: 0.5143 - val_loss: 4.0848 - val_accuracy100: 0.3963 - 37s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 38s - loss: 2.9040 - accuracy100: 0.5172 - val_loss: 4.0197 - val_accuracy100: 0.3975 - 38s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 38s - loss: 2.8956 - accuracy100: 0.5188 - val_loss: 4.0362 - val_accuracy100: 0.3981 - 38s/epoch - 15ms/step
testing model: results/AAL/W4/deepLOB_L1/h100
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0935016
{'0': {'precision': 0.46703238021263166, 'recall': 0.12223552102948015, 'f1-score': 0.19375888695988433, 'support': 393519}, '1': {'precision': 0.3220412662806309, 'recall': 0.7152542553702212, 'f1-score': 0.444119118041594, 'support': 374938}, '2': {'precision': 0.4333856333992769, 'recall': 0.23876918781644124, 'f1-score': 0.3079026808463498, 'support': 372502}, 'accuracy': 0.35515737200022085, 'macro avg': {'precision': 0.4074864266308465, 'recall': 0.35875298807204753, 'f1-score': 0.3152602286159427, 'support': 1140959}, 'weighted avg': {'precision': 0.4084008616769921, 'recall': 0.35515737200022085, 'f1-score': 0.31329723656895025, 'support': 1140959}}
[[ 48102 300715  44702]
 [ 35180 268176  71582]
 [ 19713 263847  88942]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0756596
{'0': {'precision': 0.41867139800657516, 'recall': 0.1708775498250864, 'f1-score': 0.24269924638601825, 'support': 187807}, '1': {'precision': 0.39668245645143585, 'recall': 0.7675291522862336, 'f1-score': 0.5230412533974246, 'support': 244835}, '2': {'precision': 0.4301104304941658, 'recall': 0.16089210239506632, 'f1-score': 0.234182994397499, 'support': 188095}, 'accuracy': 0.40318685691363654, 'macro avg': {'precision': 0.4151547616507256, 'recall': 0.3664329348354621, 'f1-score': 0.3333078313936473, 'support': 620737}, 'weighted avg': {'precision': 0.4134646233340501, 'recall': 0.40318685691363654, 'f1-score': 0.35069292304595173, 'support': 620737}}
[[ 32092 142773  12942]
 [ 29761 187918  27156]
 [ 14799 143033  30263]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076578
{'0': {'precision': 0.46905940594059403, 'recall': 0.07174067355469674, 'f1-score': 0.12444760640844975, 'support': 63395}, '1': {'precision': 0.37769548324429336, 'recall': 0.818314546148079, 'f1-score': 0.516841331356154, 'support': 76027}, '2': {'precision': 0.4361710064910841, 'recall': 0.18919093851132687, 'f1-score': 0.2639098932352211, 'support': 61800}, 'accuracy': 0.3898877856298019, 'macro avg': {'precision': 0.42764196522532383, 'recall': 0.3597487194047009, 'f1-score': 0.3017329436666083, 'support': 201222}, 'weighted avg': {'precision': 0.42443889706576243, 'recall': 0.3898877856298019, 'f1-score': 0.31553648860072286, 'support': 201222}}
[[ 4548 54058  4789]
 [ 3488 62214 10325]
 [ 1660 48448 11692]]
training model: results/AAL/W4/deepLOB_L1/h200
Epoch 1/50
2425/2425 - 39s - loss: 3.2141 - accuracy200: 0.4188 - val_loss: 3.4411 - val_accuracy200: 0.3323 - 39s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 37s - loss: 3.1921 - accuracy200: 0.4242 - val_loss: 3.3659 - val_accuracy200: 0.3229 - 37s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 37s - loss: 3.1767 - accuracy200: 0.4292 - val_loss: 3.4616 - val_accuracy200: 0.3252 - 37s/epoch - 15ms/step
Epoch 4/50
2425/2425 - 37s - loss: 3.1582 - accuracy200: 0.4388 - val_loss: 3.4886 - val_accuracy200: 0.3241 - 37s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 37s - loss: 3.1409 - accuracy200: 0.4474 - val_loss: 3.5351 - val_accuracy200: 0.3250 - 37s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 37s - loss: 3.1282 - accuracy200: 0.4515 - val_loss: 3.5786 - val_accuracy200: 0.3246 - 37s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 38s - loss: 3.1200 - accuracy200: 0.4539 - val_loss: 3.6235 - val_accuracy200: 0.3254 - 38s/epoch - 16ms/step
Epoch 8/50
2425/2425 - 38s - loss: 3.1149 - accuracy200: 0.4542 - val_loss: 3.6517 - val_accuracy200: 0.3280 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 37s - loss: 3.1098 - accuracy200: 0.4559 - val_loss: 3.6267 - val_accuracy200: 0.3285 - 37s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 38s - loss: 3.1044 - accuracy200: 0.4578 - val_loss: 3.5972 - val_accuracy200: 0.3309 - 38s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 37s - loss: 3.1033 - accuracy200: 0.4576 - val_loss: 3.6141 - val_accuracy200: 0.3328 - 37s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 38s - loss: 3.0987 - accuracy200: 0.4591 - val_loss: 3.6268 - val_accuracy200: 0.3328 - 38s/epoch - 15ms/step
testing model: results/AAL/W4/deepLOB_L1/h200
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1463164
{'0': {'precision': 0.3832478164365397, 'recall': 0.12595566292454172, 'f1-score': 0.1895989903455357, 'support': 422220}, '1': {'precision': 0.28385869187460905, 'recall': 0.8063255251475411, 'f1-score': 0.4198969407549914, 'support': 324147}, '2': {'precision': 0.3884460928193351, 'recall': 0.08015874624929041, 'f1-score': 0.13289385507721332, 'support': 394592}, 'accuracy': 0.30341055200055395, 'macro avg': {'precision': 0.3518508670434946, 'recall': 0.33747997810712443, 'f1-score': 0.24746326205924682, 'support': 1140959}, 'weighted avg': {'precision': 0.3568091027886907, 'recall': 0.30341055200055395, 'f1-score': 0.23541570855852673, 'support': 1140959}}
[[ 53181 341451  27588]
 [ 40570 261368  22209]
 [ 45013 317949  31630]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1368333
{'0': {'precision': 0.3418597432948093, 'recall': 0.1815572578299234, 'f1-score': 0.23716125927004897, 'support': 206260}, '1': {'precision': 0.3295489944227052, 'recall': 0.7543368692492528, 'f1-score': 0.4587031993846538, 'support': 204756}, '2': {'precision': 0.36571079065609635, 'recall': 0.07412705451528459, 'f1-score': 0.12326844546643938, 'support': 209721}, 'accuracy': 0.3341978970159665, 'macro avg': {'precision': 0.34570650945787024, 'recall': 0.33667372719815364, 'f1-score': 0.27304430137371405, 'support': 620737}, 'weighted avg': {'precision': 0.3458571944014775, 'recall': 0.3341978970159665, 'f1-score': 0.27175936875345214, 'support': 620737}}
[[ 37448 157242  11570]
 [ 34908 154455  15393]
 [ 37186 156989  15546]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1220958
{'0': {'precision': 0.47822299651567945, 'recall': 0.007935819601040763, 'f1-score': 0.015612558298259582, 'support': 69180}, '1': {'precision': 0.31731754902284975, 'recall': 0.8943011136826082, 'f1-score': 0.4684269832036351, 'support': 64381}, '2': {'precision': 0.3793214515782693, 'recall': 0.10443239088987748, 'f1-score': 0.16377522048001483, 'support': 67661}, 'accuracy': 0.32397550963612326, 'macro avg': {'precision': 0.39162066570559945, 'recall': 0.3355564413911755, 'f1-score': 0.21593825399396982, 'support': 201222}, 'weighted avg': {'precision': 0.39348558685348556, 'recall': 0.32397550963612326, 'f1-score': 0.2103103516593867, 'support': 201222}}
[[  549 63563  5068]
 [  311 57576  6494]
 [  288 60307  7066]]
training model: results/AAL/W4/deepLOB_L1/h300
Epoch 1/50
2425/2425 - 39s - loss: 3.2346 - accuracy300: 0.4083 - val_loss: 3.4713 - val_accuracy300: 0.3390 - 39s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 38s - loss: 3.2171 - accuracy300: 0.4141 - val_loss: 3.3870 - val_accuracy300: 0.3410 - 38s/epoch - 16ms/step
Epoch 3/50
2425/2425 - 38s - loss: 3.2141 - accuracy300: 0.4146 - val_loss: 3.4147 - val_accuracy300: 0.3391 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 37s - loss: 3.2011 - accuracy300: 0.4190 - val_loss: 3.4271 - val_accuracy300: 0.3369 - 37s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 37s - loss: 3.1927 - accuracy300: 0.4238 - val_loss: 3.4135 - val_accuracy300: 0.3342 - 37s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 38s - loss: 3.1872 - accuracy300: 0.4272 - val_loss: 3.4502 - val_accuracy300: 0.3363 - 38s/epoch - 16ms/step
Epoch 7/50
2425/2425 - 37s - loss: 3.1812 - accuracy300: 0.4309 - val_loss: 3.4656 - val_accuracy300: 0.3383 - 37s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 38s - loss: 3.1750 - accuracy300: 0.4347 - val_loss: 3.5356 - val_accuracy300: 0.3360 - 38s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 37s - loss: 3.1704 - accuracy300: 0.4356 - val_loss: 3.5308 - val_accuracy300: 0.3384 - 37s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 37s - loss: 3.1688 - accuracy300: 0.4355 - val_loss: 3.5537 - val_accuracy300: 0.3365 - 37s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 38s - loss: 3.1637 - accuracy300: 0.4382 - val_loss: 3.5319 - val_accuracy300: 0.3379 - 38s/epoch - 16ms/step
Epoch 12/50
2425/2425 - 38s - loss: 3.1616 - accuracy300: 0.4390 - val_loss: 3.5956 - val_accuracy300: 0.3387 - 38s/epoch - 16ms/step
testing model: results/AAL/W4/deepLOB_L1/h300
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1304415
{'0': {'precision': 0.34447894317900274, 'recall': 0.16696091181077014, 'f1-score': 0.22491214906952015, 'support': 391397}, '1': {'precision': 0.3317600509237157, 'recall': 0.7196237487055575, 'f1-score': 0.4541489256362016, 'support': 382404}, '2': {'precision': 0.33788244568162784, 'recall': 0.11207164218129524, 'f1-score': 0.1683151306908823, 'support': 367158}, 'accuracy': 0.33452823458161074, 'macro avg': {'precision': 0.3380404799281154, 'recall': 0.33288543423254097, 'f1-score': 0.2824587351322014, 'support': 1140959}, 'weighted avg': {'precision': 0.3380933393999607, 'recall': 0.33452823458161074, 'f1-score': 0.28353039234762334, 'support': 1140959}}
[[ 65348 288643  37406]
 [ 63989 275187  43228]
 [ 60364 265646  41148]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1275513
{'0': {'precision': 0.3452667053396315, 'recall': 0.18219231329867352, 'f1-score': 0.2385206718551714, 'support': 205810}, '1': {'precision': 0.3304703485520088, 'recall': 0.7289098786912891, 'f1-score': 0.4547623138123596, 'support': 205179}, '2': {'precision': 0.35935611655700284, 'recall': 0.10207010317142476, 'f1-score': 0.15898323209220122, 'support': 209748}, 'accuracy': 0.33583143907967467, 'macro avg': {'precision': 0.3450310568162143, 'recall': 0.3377240983871292, 'f1-score': 0.28408873925324407, 'support': 620737}, 'weighted avg': {'precision': 0.34513673747029805, 'recall': 0.33583143907967467, 'f1-score': 0.28312156553434703, 'support': 620737}}
[[ 37497 151387  16926]
 [ 34381 149557  21241]
 [ 36725 151614  21409]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1282456
{'0': {'precision': 0.4383726528647087, 'recall': 0.05309347483818298, 'f1-score': 0.09471548944138146, 'support': 68596}, '1': {'precision': 0.3330957962181591, 'recall': 0.8025754951427065, 'f1-score': 0.47079560012369137, 'support': 66395}, '2': {'precision': 0.3663134885697805, 'recall': 0.18218054989355437, 'f1-score': 0.2433397196732883, 'support': 66231}, 'accuracy': 0.3428800031805667, 'macro avg': {'precision': 0.3792606458842161, 'recall': 0.345949839958148, 'f1-score': 0.269616936412787, 'support': 201222}, 'weighted avg': {'precision': 0.3799177751303405, 'recall': 0.3428800031805667, 'f1-score': 0.2677252515014017, 'support': 201222}}
[[ 3642 54882 10072]
 [ 2307 53287 10801]
 [ 2359 51806 12066]]
training model: results/AAL/W4/deepLOB_L1/h500
Epoch 1/50
2425/2425 - 40s - loss: 3.2532 - accuracy500: 0.3978 - val_loss: 4.6698 - val_accuracy500: 0.3107 - 40s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 38s - loss: 3.2222 - accuracy500: 0.4141 - val_loss: 3.7641 - val_accuracy500: 0.3108 - 38s/epoch - 16ms/step
Epoch 3/50
2425/2425 - 38s - loss: 3.2120 - accuracy500: 0.4193 - val_loss: 3.5842 - val_accuracy500: 0.3119 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 38s - loss: 3.1977 - accuracy500: 0.4241 - val_loss: 3.6809 - val_accuracy500: 0.3115 - 38s/epoch - 16ms/step
Epoch 5/50
2425/2425 - 38s - loss: 3.1956 - accuracy500: 0.4252 - val_loss: 3.6562 - val_accuracy500: 0.3129 - 38s/epoch - 16ms/step
Epoch 6/50
2425/2425 - 38s - loss: 3.1872 - accuracy500: 0.4293 - val_loss: 3.6754 - val_accuracy500: 0.3135 - 38s/epoch - 16ms/step
Epoch 7/50
2425/2425 - 38s - loss: 3.1805 - accuracy500: 0.4328 - val_loss: 3.6555 - val_accuracy500: 0.3135 - 38s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 38s - loss: 3.1745 - accuracy500: 0.4354 - val_loss: 3.7930 - val_accuracy500: 0.3130 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 38s - loss: 3.1667 - accuracy500: 0.4388 - val_loss: 3.8268 - val_accuracy500: 0.3130 - 38s/epoch - 16ms/step
Epoch 10/50
2425/2425 - 38s - loss: 3.1629 - accuracy500: 0.4407 - val_loss: 3.8250 - val_accuracy500: 0.3133 - 38s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 38s - loss: 3.1615 - accuracy500: 0.4417 - val_loss: 3.8054 - val_accuracy500: 0.3143 - 38s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 38s - loss: 3.1570 - accuracy500: 0.4418 - val_loss: 3.8044 - val_accuracy500: 0.3150 - 38s/epoch - 16ms/step
Epoch 13/50
2425/2425 - 38s - loss: 3.1510 - accuracy500: 0.4442 - val_loss: 3.8764 - val_accuracy500: 0.3143 - 38s/epoch - 16ms/step
testing model: results/AAL/W4/deepLOB_L1/h500
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2040304
{'0': {'precision': 0.3540213205335715, 'recall': 0.17083555734020203, 'f1-score': 0.2304606537640233, 'support': 408422}, '1': {'precision': 0.31248724978878706, 'recall': 0.8282114286037808, 'f1-score': 0.45376665454322673, 'support': 353254}, '2': {'precision': 0.3630631814002364, 'recall': 0.0072874344486834365, 'f1-score': 0.014288077416153176, 'support': 379283}, 'accuracy': 0.31999922871899866, 'macro avg': {'precision': 0.3431905839075317, 'recall': 0.33544480679755545, 'f1-score': 0.23283846190780108, 'support': 1140959}, 'weighted avg': {'precision': 0.34416763384387733, 'recall': 0.31999922871899866, 'f1-score': 0.22773764156490614, 'support': 1140959}}
[[ 69773 336047   2602]
 [ 58438 292569   2247]
 [ 68876 307643   2764]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2087849
{'0': {'precision': 0.3329300507563338, 'recall': 0.22518884369552586, 'f1-score': 0.2686600790856337, 'support': 206520}, '1': {'precision': 0.3340510095732135, 'recall': 0.7785015649452269, 'f1-score': 0.46750012481314746, 'support': 204480}, '2': {'precision': 0.35305851063829785, 'recall': 0.00759522640258991, 'f1-score': 0.014870547820526584, 'support': 209737}, 'accuracy': 0.333936916922948, 'macro avg': {'precision': 0.34001319032261507, 'recall': 0.33709521168111417, 'f1-score': 0.2503435839064359, 'support': 620737}, 'weighted avg': {'precision': 0.34010039254220936, 'recall': 0.333936916922948, 'f1-score': 0.24840956660033353, 'support': 620737}}
[[ 46506 158595   1419]
 [ 43792 159188   1500]
 [ 49389 158755   1593]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1973822
{'0': {'precision': 0.4916317991631799, 'recall': 0.0032874489396228527, 'f1-score': 0.006531224813095801, 'support': 71484}, '1': {'precision': 0.31108037821505347, 'recall': 0.9933437870011841, 'f1-score': 0.4737872376148084, 'support': 62498}, '2': {'precision': 0.3982978723404255, 'recall': 0.006960142772159429, 'f1-score': 0.013681210260907696, 'support': 67240}, 'accuracy': 0.3120185665583286, 'macro avg': {'precision': 0.40033668323955296, 'recall': 0.3345304595709888, 'f1-score': 0.1646665575629373, 'support': 201222}, 'weighted avg': {'precision': 0.40436561581355607, 'recall': 0.3120185665583286, 'f1-score': 0.15404656264689284, 'support': 201222}}
[[  235 70888   361]
 [   70 62082   346]
 [  173 66599   468]]
training model: results/AAL/W4/deepLOB_L1/h1000
Epoch 1/50
2425/2425 - 40s - loss: 3.1638 - accuracy1000: 0.4498 - val_loss: 3.5168 - val_accuracy1000: 0.3530 - 40s/epoch - 17ms/step
Epoch 2/50
2425/2425 - 37s - loss: 3.1266 - accuracy1000: 0.4680 - val_loss: 3.5464 - val_accuracy1000: 0.3475 - 37s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 38s - loss: 3.1198 - accuracy1000: 0.4668 - val_loss: 3.4978 - val_accuracy1000: 0.3463 - 38s/epoch - 16ms/step
Epoch 4/50
2425/2425 - 38s - loss: 3.0976 - accuracy1000: 0.4752 - val_loss: 3.5280 - val_accuracy1000: 0.3452 - 38s/epoch - 16ms/step
Epoch 5/50
2425/2425 - 38s - loss: 3.0846 - accuracy1000: 0.4798 - val_loss: 3.5066 - val_accuracy1000: 0.3440 - 38s/epoch - 16ms/step
Epoch 6/50
2425/2425 - 37s - loss: 3.0851 - accuracy1000: 0.4792 - val_loss: 3.5079 - val_accuracy1000: 0.3402 - 37s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 38s - loss: 3.0887 - accuracy1000: 0.4789 - val_loss: 3.5085 - val_accuracy1000: 0.3496 - 38s/epoch - 16ms/step
Epoch 8/50
2425/2425 - 38s - loss: 3.0834 - accuracy1000: 0.4812 - val_loss: 3.4906 - val_accuracy1000: 0.3440 - 38s/epoch - 16ms/step
Epoch 9/50
2425/2425 - 39s - loss: 3.0772 - accuracy1000: 0.4826 - val_loss: 3.4807 - val_accuracy1000: 0.3472 - 39s/epoch - 16ms/step
Epoch 10/50
2425/2425 - 38s - loss: 3.0658 - accuracy1000: 0.4865 - val_loss: 3.4678 - val_accuracy1000: 0.3482 - 38s/epoch - 16ms/step
Epoch 11/50
2425/2425 - 37s - loss: 3.0584 - accuracy1000: 0.4886 - val_loss: 3.4763 - val_accuracy1000: 0.3447 - 37s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 38s - loss: 3.0551 - accuracy1000: 0.4897 - val_loss: 3.4930 - val_accuracy1000: 0.3457 - 38s/epoch - 15ms/step
Epoch 13/50
2425/2425 - 38s - loss: 3.0591 - accuracy1000: 0.4871 - val_loss: 3.5099 - val_accuracy1000: 0.3443 - 38s/epoch - 16ms/step
Epoch 14/50
2425/2425 - 38s - loss: 3.0585 - accuracy1000: 0.4868 - val_loss: 3.4894 - val_accuracy1000: 0.3432 - 38s/epoch - 16ms/step
Epoch 15/50
2425/2425 - 38s - loss: 3.0495 - accuracy1000: 0.4903 - val_loss: 3.5400 - val_accuracy1000: 0.3385 - 38s/epoch - 16ms/step
Epoch 16/50
2425/2425 - 38s - loss: 3.0426 - accuracy1000: 0.4925 - val_loss: 3.5297 - val_accuracy1000: 0.3394 - 38s/epoch - 16ms/step
Epoch 17/50
2425/2425 - 38s - loss: 3.0415 - accuracy1000: 0.4935 - val_loss: 3.5675 - val_accuracy1000: 0.3402 - 38s/epoch - 16ms/step
Epoch 18/50
2425/2425 - 38s - loss: 3.0378 - accuracy1000: 0.4930 - val_loss: 3.5819 - val_accuracy1000: 0.3357 - 38s/epoch - 15ms/step
Epoch 19/50
2425/2425 - 38s - loss: 3.0350 - accuracy1000: 0.4942 - val_loss: 3.6354 - val_accuracy1000: 0.3400 - 38s/epoch - 16ms/step
Epoch 20/50
2425/2425 - 38s - loss: 3.0304 - accuracy1000: 0.4957 - val_loss: 3.5899 - val_accuracy1000: 0.3418 - 38s/epoch - 16ms/step
testing model: results/AAL/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173637
{'0': {'precision': 0.3587741614761529, 'recall': 0.10389621387258763, 'f1-score': 0.16113102977292726, 'support': 354267}, '1': {'precision': 0.41626817124202137, 'recall': 0.8891944313295137, 'f1-score': 0.5670684691832728, 'support': 470202}, '2': {'precision': 0.2764021787133814, 'recall': 0.02966286454548327, 'f1-score': 0.05357606540069338, 'support': 316490}, 'accuracy': 0.40693486794880446, 'macro avg': {'precision': 0.3504815038105185, 'recall': 0.3409178365825282, 'f1-score': 0.2605918547856311, 'support': 1140959}, 'weighted avg': {'precision': 0.3596189679550372, 'recall': 0.40693486794880446, 'f1-score': 0.2985877878259818, 'support': 1140959}}
[[ 36807 306890  10570]
 [ 38094 418101  14007]
 [ 27690 279412   9388]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1700844
{'0': {'precision': 0.3538009443203205, 'recall': 0.15757534165996745, 'f1-score': 0.21804024241766515, 'support': 204004}, '1': {'precision': 0.33531295981443715, 'recall': 0.8295742895065584, 'f1-score': 0.4775861536170894, 'support': 204928}, '2': {'precision': 0.3388986013986014, 'recall': 0.03660914520431529, 'f1-score': 0.0660800647676673, 'support': 211805}, 'accuracy': 0.33815126212872765, 'macro avg': {'precision': 0.34267083517778635, 'recall': 0.341252925456947, 'f1-score': 0.25390215360080726, 'support': 620737}, 'weighted avg': {'precision': 0.34261247572354536, 'recall': 0.33815126212872765, 'f1-score': 0.25187469897997383, 'support': 620737}}
[[ 32146 163994   7864]
 [ 27663 170003   7262]
 [ 31050 173001   7754]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1557693
{'0': {'precision': 0.4718019257221458, 'recall': 0.03534781008465219, 'f1-score': 0.06576820883666146, 'support': 67925}, '1': {'precision': 0.3461131591601218, 'recall': 0.920682745192786, 'f1-score': 0.5030966905212148, 'support': 70363}, '2': {'precision': 0.3072631931273011, 'recall': 0.04376012965964344, 'f1-score': 0.07660959428070713, 'support': 62934}, 'accuracy': 0.34756139984693524, 'macro avg': {'precision': 0.3750594260031896, 'recall': 0.3332635616456939, 'f1-score': 0.21515816454619444, 'support': 201222}, 'weighted avg': {'precision': 0.37639029439591093, 'recall': 0.34756139984693524, 'f1-score': 0.22208330215799704, 'support': 201222}}
[[ 2401 63428  2096]
 [ 1468 64782  4113]
 [ 1220 58960  2754]]
training model: results/AAL/W4/deepOF_L1/h10
Epoch 1/50
2425/2425 - 37s - loss: 3.1148 - accuracy10: 0.3775 - val_loss: 3.1993 - val_accuracy10: 0.3782 - 37s/epoch - 15ms/step
Epoch 2/50
2425/2425 - 34s - loss: 3.0564 - accuracy10: 0.3508 - val_loss: 3.1739 - val_accuracy10: 0.4466 - 34s/epoch - 14ms/step
Epoch 3/50
2425/2425 - 34s - loss: 3.0249 - accuracy10: 0.3741 - val_loss: 3.1602 - val_accuracy10: 0.4679 - 34s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 34s - loss: 3.0046 - accuracy10: 0.3918 - val_loss: 3.1399 - val_accuracy10: 0.4965 - 34s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 34s - loss: 2.9870 - accuracy10: 0.4048 - val_loss: 3.1329 - val_accuracy10: 0.5090 - 34s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 34s - loss: 2.9719 - accuracy10: 0.4176 - val_loss: 3.1167 - val_accuracy10: 0.5144 - 34s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 34s - loss: 2.9573 - accuracy10: 0.4271 - val_loss: 3.1098 - val_accuracy10: 0.5404 - 34s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 35s - loss: 2.9422 - accuracy10: 0.4382 - val_loss: 3.1060 - val_accuracy10: 0.5411 - 35s/epoch - 14ms/step
Epoch 9/50
2425/2425 - 33s - loss: 2.9313 - accuracy10: 0.4461 - val_loss: 3.1033 - val_accuracy10: 0.5642 - 33s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 34s - loss: 2.9180 - accuracy10: 0.4527 - val_loss: 3.1102 - val_accuracy10: 0.5663 - 34s/epoch - 14ms/step
Epoch 11/50
2425/2425 - 34s - loss: 2.9021 - accuracy10: 0.4594 - val_loss: 3.1133 - val_accuracy10: 0.5743 - 34s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 34s - loss: 2.8872 - accuracy10: 0.4653 - val_loss: 3.1377 - val_accuracy10: 0.5960 - 34s/epoch - 14ms/step
Epoch 13/50
2425/2425 - 34s - loss: 2.8730 - accuracy10: 0.4697 - val_loss: 3.1394 - val_accuracy10: 0.5989 - 34s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 34s - loss: 2.8582 - accuracy10: 0.4746 - val_loss: 3.1431 - val_accuracy10: 0.6063 - 34s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 34s - loss: 2.8462 - accuracy10: 0.4778 - val_loss: 3.1124 - val_accuracy10: 0.5813 - 34s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 34s - loss: 2.8321 - accuracy10: 0.4812 - val_loss: 3.1243 - val_accuracy10: 0.5947 - 34s/epoch - 14ms/step
Epoch 17/50
2425/2425 - 34s - loss: 2.8188 - accuracy10: 0.4835 - val_loss: 3.1508 - val_accuracy10: 0.6047 - 34s/epoch - 14ms/step
Epoch 18/50
2425/2425 - 34s - loss: 2.8033 - accuracy10: 0.4877 - val_loss: 3.1331 - val_accuracy10: 0.6004 - 34s/epoch - 14ms/step
Epoch 19/50
2425/2425 - 34s - loss: 2.7940 - accuracy10: 0.4906 - val_loss: 3.1631 - val_accuracy10: 0.6115 - 34s/epoch - 14ms/step
testing model: results/AAL/W4/deepOF_L1/h10
Evaluating performance on  test set...
4457/4457 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9362958
{'0': {'precision': 0.30068428367370575, 'recall': 0.3617463496763331, 'f1-score': 0.3284010024534283, 'support': 172245}, '1': {'precision': 0.7477456684318098, 'recall': 0.6439808575593389, 'f1-score': 0.6919949972931111, 'support': 799898}, '2': {'precision': 0.27524659464537343, 'recall': 0.3992014785678743, 'f1-score': 0.32583337966913817, 'support': 168812}, 'accuracy': 0.5651563821535468, 'macro avg': {'precision': 0.4412255155836297, 'recall': 0.46830956193451545, 'f1-score': 0.4487431264718926, 'support': 1140955}, 'weighted avg': {'precision': 0.610345331116407, 'recall': 0.5651563821535468, 'f1-score': 0.5829287127897791, 'support': 1140955}}
[[ 62309  87952  21984]
 [129318 515119 155461]
 [ 15597  85825  67390]]
Evaluating performance on  train set...
2425/2425 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9305268
{'0': {'precision': 0.26949840412676984, 'recall': 0.405418280742663, 'f1-score': 0.3237720510202039, 'support': 79767}, '1': {'precision': 0.8006371614207415, 'recall': 0.6176248231120646, 'f1-score': 0.6973230483397937, 'support': 464277}, '2': {'precision': 0.23940639333454897, 'recall': 0.44511670361194416, 'f1-score': 0.31135190353709474, 'support': 76690}, 'accuracy': 0.5690424561889634, 'macro avg': {'precision': 0.4365139862940201, 'recall': 0.4893866024888906, 'f1-score': 0.4441490009656975, 'support': 620734}, 'weighted avg': {'precision': 0.6630449997901584, 'recall': 0.5690424561889634, 'f1-score': 0.601634445011942, 'support': 620734}}
[[ 32339  37294  10134]
 [ 79212 286749  98316]
 [  8446  34108  34136]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9332578
{'0': {'precision': 0.2762772534982102, 'recall': 0.4081881726395207, 'f1-score': 0.32952170538006803, 'support': 27039}, '1': {'precision': 0.7903436917609327, 'recall': 0.6152029580049659, 'f1-score': 0.6918614577365663, 'support': 148208}, '2': {'precision': 0.24427115099764746, 'recall': 0.4317228103946102, 'f1-score': 0.31200701139351444, 'support': 25975}, 'accuracy': 0.5637007881841946, 'macro avg': {'precision': 0.43696403208559675, 'recall': 0.4850379803463656, 'f1-score': 0.44446339150338293, 'support': 201222}, 'weighted avg': {'precision': 0.650776066598117, 'recall': 0.5637007881841944, 'f1-score': 0.5941384264192743, 'support': 201222}}
[[11037 12352  3650]
 [25986 91178 31044]
 [ 2926 11835 11214]]
training model: results/AAL/W4/deepOF_L1/h20
Epoch 1/50
2425/2425 - 36s - loss: 3.1487 - accuracy20: 0.3928 - val_loss: 3.2178 - val_accuracy20: 0.4302 - 36s/epoch - 15ms/step
Epoch 2/50
2425/2425 - 34s - loss: 3.1054 - accuracy20: 0.3633 - val_loss: 3.1948 - val_accuracy20: 0.4276 - 34s/epoch - 14ms/step
Epoch 3/50
2425/2425 - 34s - loss: 3.0768 - accuracy20: 0.3808 - val_loss: 3.1793 - val_accuracy20: 0.4369 - 34s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 34s - loss: 3.0547 - accuracy20: 0.4000 - val_loss: 3.1681 - val_accuracy20: 0.4761 - 34s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 34s - loss: 3.0376 - accuracy20: 0.4155 - val_loss: 3.1547 - val_accuracy20: 0.4928 - 34s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 34s - loss: 3.0237 - accuracy20: 0.4290 - val_loss: 3.1505 - val_accuracy20: 0.5190 - 34s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 34s - loss: 3.0097 - accuracy20: 0.4416 - val_loss: 3.1471 - val_accuracy20: 0.5235 - 34s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 34s - loss: 2.9973 - accuracy20: 0.4500 - val_loss: 3.1350 - val_accuracy20: 0.5288 - 34s/epoch - 14ms/step
Epoch 9/50
2425/2425 - 34s - loss: 2.9844 - accuracy20: 0.4562 - val_loss: 3.1401 - val_accuracy20: 0.5364 - 34s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 34s - loss: 2.9734 - accuracy20: 0.4608 - val_loss: 3.1327 - val_accuracy20: 0.5454 - 34s/epoch - 14ms/step
Epoch 11/50
2425/2425 - 34s - loss: 2.9600 - accuracy20: 0.4647 - val_loss: 3.1296 - val_accuracy20: 0.5441 - 34s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 34s - loss: 2.9499 - accuracy20: 0.4681 - val_loss: 3.1433 - val_accuracy20: 0.5584 - 34s/epoch - 14ms/step
Epoch 13/50
2425/2425 - 34s - loss: 2.9356 - accuracy20: 0.4736 - val_loss: 3.1404 - val_accuracy20: 0.5655 - 34s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 34s - loss: 2.9201 - accuracy20: 0.4783 - val_loss: 3.1519 - val_accuracy20: 0.5752 - 34s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 34s - loss: 2.9070 - accuracy20: 0.4831 - val_loss: 3.1647 - val_accuracy20: 0.5846 - 34s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 34s - loss: 2.8934 - accuracy20: 0.4872 - val_loss: 3.1668 - val_accuracy20: 0.5844 - 34s/epoch - 14ms/step
Epoch 17/50
2425/2425 - 34s - loss: 2.8777 - accuracy20: 0.4920 - val_loss: 3.1820 - val_accuracy20: 0.5846 - 34s/epoch - 14ms/step
Epoch 18/50
2425/2425 - 34s - loss: 2.8629 - accuracy20: 0.4964 - val_loss: 3.1871 - val_accuracy20: 0.5855 - 34s/epoch - 14ms/step
Epoch 19/50
2425/2425 - 34s - loss: 2.8500 - accuracy20: 0.4996 - val_loss: 3.1912 - val_accuracy20: 0.5871 - 34s/epoch - 14ms/step
Epoch 20/50
2425/2425 - 34s - loss: 2.8375 - accuracy20: 0.5036 - val_loss: 3.2092 - val_accuracy20: 0.5927 - 34s/epoch - 14ms/step
Epoch 21/50
2425/2425 - 34s - loss: 2.8235 - accuracy20: 0.5075 - val_loss: 3.2156 - val_accuracy20: 0.5911 - 34s/epoch - 14ms/step
testing model: results/AAL/W4/deepOF_L1/h20
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9712036
{'0': {'precision': 0.35551347563154695, 'recall': 0.33437516369541304, 'f1-score': 0.34462047882451124, 'support': 229084}, '1': {'precision': 0.6526354580072216, 'recall': 0.6263334992475644, 'f1-score': 0.6392140291256007, 'support': 687102}, '2': {'precision': 0.3333571356090814, 'recall': 0.39462737299182715, 'f1-score': 0.36141387389222773, 'support': 224769}, 'accuracy': 0.5220670403302496, 'macro avg': {'precision': 0.4471686897492833, 'recall': 0.45177867864493493, 'f1-score': 0.44841612728077984, 'support': 1140955}, 'weighted avg': {'precision': 0.530080439222382, 'recall': 0.5220670403302496, 'f1-score': 0.525337906080586, 'support': 1140955}}
[[ 76600 116268  36216]
 [115582 430355 141165]
 [ 23281 112788  88700]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9455792
{'0': {'precision': 0.3325369920169587, 'recall': 0.37675482487491063, 'f1-score': 0.3532676204859653, 'support': 104925}, '1': {'precision': 0.7289371588333338, 'recall': 0.6237414705725673, 'f1-score': 0.6722488631396266, 'support': 412982}, '2': {'precision': 0.3058447943747727, 'recall': 0.44161552899530276, 'f1-score': 0.3613992781564737, 'support': 102827}, 'accuracy': 0.551822519791086, 'macro avg': {'precision': 0.4557729817416884, 'recall': 0.48070394148092693, 'f1-score': 0.46230525392735516, 'support': 620734}, 'weighted avg': {'precision': 0.5918452546305857, 'recall': 0.551822519791086, 'f1-score': 0.566836823263451, 'support': 620734}}
[[ 39531  49381  16013]
 [ 68337 257594  87051]
 [ 11009  46408  45410]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9512783
{'0': {'precision': 0.33821368863670903, 'recall': 0.37734569296857334, 'f1-score': 0.35670967914295637, 'support': 35384}, '1': {'precision': 0.7150858587632124, 'recall': 0.620497897495277, 'f1-score': 0.6644424504445713, 'support': 131272}, '2': {'precision': 0.3071745129191404, 'recall': 0.4250998090609269, 'f1-score': 0.35664182908181835, 'support': 34566}, 'accuracy': 0.5441750901988848, 'macro avg': {'precision': 0.4534913534396872, 'recall': 0.4743144665082591, 'f1-score': 0.45926465288978197, 'support': 201222}, 'weighted avg': {'precision': 0.5787433691338358, 'recall': 0.5441750901988848, 'f1-score': 0.5574548812038259, 'support': 201222}}
[[13352 16324  5708]
 [22384 81454 27434]
 [ 3742 16130 14694]]
training model: results/AAL/W4/deepOF_L1/h30
Epoch 1/50
2425/2425 - 36s - loss: 3.1770 - accuracy30: 0.4021 - val_loss: 3.2375 - val_accuracy30: 0.4521 - 36s/epoch - 15ms/step
Epoch 2/50
2425/2425 - 34s - loss: 3.1401 - accuracy30: 0.3745 - val_loss: 3.2116 - val_accuracy30: 0.4506 - 34s/epoch - 14ms/step
Epoch 3/50
2425/2425 - 33s - loss: 3.1141 - accuracy30: 0.3906 - val_loss: 3.2043 - val_accuracy30: 0.4647 - 33s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 35s - loss: 3.0973 - accuracy30: 0.4044 - val_loss: 3.1987 - val_accuracy30: 0.4707 - 35s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 35s - loss: 3.0839 - accuracy30: 0.4158 - val_loss: 3.1837 - val_accuracy30: 0.4793 - 35s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 35s - loss: 3.0702 - accuracy30: 0.4260 - val_loss: 3.1790 - val_accuracy30: 0.4865 - 35s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.0585 - accuracy30: 0.4346 - val_loss: 3.1787 - val_accuracy30: 0.4968 - 35s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 33s - loss: 3.0471 - accuracy30: 0.4425 - val_loss: 3.1751 - val_accuracy30: 0.4944 - 33s/epoch - 14ms/step
Epoch 9/50
2425/2425 - 35s - loss: 3.0368 - accuracy30: 0.4469 - val_loss: 3.1651 - val_accuracy30: 0.5045 - 35s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 34s - loss: 3.0253 - accuracy30: 0.4534 - val_loss: 3.1675 - val_accuracy30: 0.5109 - 34s/epoch - 14ms/step
Epoch 11/50
2425/2425 - 34s - loss: 3.0125 - accuracy30: 0.4586 - val_loss: 3.1670 - val_accuracy30: 0.5229 - 34s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 33s - loss: 2.9996 - accuracy30: 0.4630 - val_loss: 3.1753 - val_accuracy30: 0.5318 - 33s/epoch - 14ms/step
Epoch 13/50
2425/2425 - 34s - loss: 2.9881 - accuracy30: 0.4664 - val_loss: 3.1784 - val_accuracy30: 0.5380 - 34s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 34s - loss: 2.9733 - accuracy30: 0.4725 - val_loss: 3.2100 - val_accuracy30: 0.5478 - 34s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 34s - loss: 2.9588 - accuracy30: 0.4787 - val_loss: 3.2029 - val_accuracy30: 0.5469 - 34s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 34s - loss: 2.9445 - accuracy30: 0.4832 - val_loss: 3.2238 - val_accuracy30: 0.5560 - 34s/epoch - 14ms/step
Epoch 17/50
2425/2425 - 34s - loss: 2.9286 - accuracy30: 0.4884 - val_loss: 3.2815 - val_accuracy30: 0.5617 - 34s/epoch - 14ms/step
Epoch 18/50
2425/2425 - 34s - loss: 2.9151 - accuracy30: 0.4919 - val_loss: 3.3006 - val_accuracy30: 0.5645 - 34s/epoch - 14ms/step
Epoch 19/50
2425/2425 - 34s - loss: 2.9043 - accuracy30: 0.4941 - val_loss: 3.2777 - val_accuracy30: 0.5647 - 34s/epoch - 14ms/step
testing model: results/AAL/W4/deepOF_L1/h30
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0110029
{'0': {'precision': 0.378238892380691, 'recall': 0.31923939031679616, 'f1-score': 0.3462437652702762, 'support': 267680}, '1': {'precision': 0.5841252642530999, 'recall': 0.5764882665341147, 'f1-score': 0.5802816391424424, 'support': 611584}, '2': {'precision': 0.3562151418727785, 'recall': 0.4239350990290075, 'f1-score': 0.3871359477397877, 'support': 261691}, 'accuracy': 0.4811451810106446, 'macro avg': {'precision': 0.4395264328355231, 'recall': 0.4398875852933061, 'f1-score': 0.43788711738416874, 'support': 1140955}, 'weighted avg': {'precision': 0.4835483862354435, 'recall': 0.4811451810106446, 'f1-score': 0.4810737411912054, 'support': 1140955}}
[[ 85454 129527  52699]
 [111211 352571 147802]
 [ 29261 121490 110940]]
Evaluating performance on  train set...
2425/2425 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98702043
{'0': {'precision': 0.34991409835536663, 'recall': 0.35329087740443343, 'f1-score': 0.3515943802604013, 'support': 122794}, '1': {'precision': 0.6639605066611612, 'recall': 0.5810335803348203, 'f1-score': 0.619735233148141, 'support': 376381}, '2': {'precision': 0.3301291051062533, 'recall': 0.4545776125173784, 'f1-score': 0.3824850662070588, 'support': 121559}, 'accuracy': 0.5112173652482384, 'macro avg': {'precision': 0.4480012367075938, 'recall': 0.46296735675221073, 'f1-score': 0.451271559871867, 'support': 620734}, 'weighted avg': {'precision': 0.5364610850037125, 'recall': 0.5112173652482384, 'f1-score': 0.5202304840403298, 'support': 620734}}
[[ 43382  57703  21709]
 [ 67275 218690  90416]
 [ 13322  52979  55258]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99239606
{'0': {'precision': 0.35096119488315586, 'recall': 0.3571203490486002, 'f1-score': 0.3540139846697263, 'support': 41255}, '1': {'precision': 0.6488761394304263, 'recall': 0.5763231781418933, 'f1-score': 0.6104514645632944, 'support': 119315}, '2': {'precision': 0.33477256941185307, 'recall': 0.43867460395552493, 'f1-score': 0.3797446790387667, 'support': 40652}, 'accuracy': 0.503573167943863, 'macro avg': {'precision': 0.44486996790847844, 'recall': 0.45737271038200616, 'f1-score': 0.4480700427572624, 'support': 201222}, 'weighted avg': {'precision': 0.5243399586664309, 'recall': 0.503573167943863, 'f1-score': 0.5112673769478634, 'support': 201222}}
[[14733 19006  7516]
 [22631 68764 27920]
 [ 4615 18204 17833]]
training model: results/AAL/W4/deepOF_L1/h50
Epoch 1/50
2425/2425 - 37s - loss: 3.2151 - accuracy50: 0.4079 - val_loss: 3.2577 - val_accuracy50: 0.4164 - 37s/epoch - 15ms/step
Epoch 2/50
2425/2425 - 34s - loss: 3.1938 - accuracy50: 0.3748 - val_loss: 3.2465 - val_accuracy50: 0.4216 - 34s/epoch - 14ms/step
Epoch 3/50
2425/2425 - 35s - loss: 3.1716 - accuracy50: 0.3923 - val_loss: 3.2518 - val_accuracy50: 0.4395 - 35s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 35s - loss: 3.1553 - accuracy50: 0.4074 - val_loss: 3.2294 - val_accuracy50: 0.4477 - 35s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 35s - loss: 3.1433 - accuracy50: 0.4155 - val_loss: 3.2248 - val_accuracy50: 0.4529 - 35s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 35s - loss: 3.1330 - accuracy50: 0.4240 - val_loss: 3.2193 - val_accuracy50: 0.4628 - 35s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.1224 - accuracy50: 0.4306 - val_loss: 3.2173 - val_accuracy50: 0.4758 - 35s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 34s - loss: 3.1115 - accuracy50: 0.4374 - val_loss: 3.2184 - val_accuracy50: 0.4830 - 34s/epoch - 14ms/step
Epoch 9/50
2425/2425 - 35s - loss: 3.1021 - accuracy50: 0.4437 - val_loss: 3.2197 - val_accuracy50: 0.4884 - 35s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 34s - loss: 3.0905 - accuracy50: 0.4485 - val_loss: 3.2234 - val_accuracy50: 0.4916 - 34s/epoch - 14ms/step
Epoch 11/50
2425/2425 - 34s - loss: 3.0772 - accuracy50: 0.4549 - val_loss: 3.2302 - val_accuracy50: 0.4945 - 34s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 35s - loss: 3.0647 - accuracy50: 0.4596 - val_loss: 3.2368 - val_accuracy50: 0.4984 - 35s/epoch - 14ms/step
Epoch 13/50
2425/2425 - 35s - loss: 3.0528 - accuracy50: 0.4638 - val_loss: 3.2661 - val_accuracy50: 0.5052 - 35s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 35s - loss: 3.0418 - accuracy50: 0.4677 - val_loss: 3.2952 - val_accuracy50: 0.5082 - 35s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 35s - loss: 3.0299 - accuracy50: 0.4723 - val_loss: 3.3315 - val_accuracy50: 0.5138 - 35s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 35s - loss: 3.0203 - accuracy50: 0.4747 - val_loss: 3.3445 - val_accuracy50: 0.5116 - 35s/epoch - 14ms/step
Epoch 17/50
2425/2425 - 36s - loss: 3.0125 - accuracy50: 0.4772 - val_loss: 3.3868 - val_accuracy50: 0.5181 - 36s/epoch - 15ms/step
testing model: results/AAL/W4/deepOF_L1/h50
Evaluating performance on  test set...
4457/4457 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0477844
{'0': {'precision': 0.42049960057438873, 'recall': 0.26651259877739675, 'f1-score': 0.3262487665857382, 'support': 321936}, '1': {'precision': 0.4775114965021281, 'recall': 0.6130237067654268, 'f1-score': 0.5368480847417864, 'support': 509517}, '2': {'precision': 0.39816478076379064, 'recall': 0.3638134810114313, 'f1-score': 0.38021482284375197, 'support': 309502}, 'accuracy': 0.4476486802722281, 'macro avg': {'precision': 0.43205862594676914, 'recall': 0.4144499288514183, 'f1-score': 0.4144372247237588, 'support': 1140955}, 'weighted avg': {'precision': 0.4399007678214706, 'recall': 0.4476486802722281, 'f1-score': 0.4349353801093942, 'support': 1140955}}
[[ 85800 180380  55756]
 [ 82728 312346 114443]
 [ 35515 161386 112601]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0233614
{'0': {'precision': 0.3936544934292349, 'recall': 0.30404524874719546, 'f1-score': 0.3430953779681252, 'support': 148866}, '1': {'precision': 0.5589253593887155, 'recall': 0.6011856116889549, 'f1-score': 0.5792857622239954, 'support': 323040}, '2': {'precision': 0.37242403184029316, 'recall': 0.3961015400327895, 'f1-score': 0.38389804570230335, 'support': 148828}, 'accuracy': 0.48075343061601267, 'macro avg': {'precision': 0.44166796155274785, 'recall': 0.4337774668229799, 'f1-score': 0.43542639529814137, 'support': 620734}, 'weighted avg': {'precision': 0.4745738782256076, 'recall': 0.48075343061601267, 'f1-score': 0.4757955702623423, 'support': 620734}}
[[ 45262  79596  24008]
 [ 53502 194207  75331]
 [ 16215  73662  58951]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0272144
{'0': {'precision': 0.4025225130338617, 'recall': 0.3058745848173196, 'f1-score': 0.34760562099231435, 'support': 49978}, '1': {'precision': 0.5451130156756516, 'recall': 0.6026570048309179, 'f1-score': 0.5724425127891848, 'support': 101844}, '2': {'precision': 0.379138778653083, 'recall': 0.3887246963562753, 'f1-score': 0.3838719027676439, 'support': 49400}, 'accuracy': 0.47642404906024194, 'macro avg': {'precision': 0.4422581024541987, 'recall': 0.4324187620015043, 'f1-score': 0.43464001218304765, 'support': 201222}, 'weighted avg': {'precision': 0.4689507896270771, 'recall': 0.47642404906024194, 'f1-score': 0.47030514056702166, 'support': 201222}}
[[15287 26573  8118]
 [17139 61377 23328]
 [ 5552 24645 19203]]
training model: results/AAL/W4/deepOF_L1/h100
Epoch 1/50
2425/2425 - 38s - loss: 3.2603 - accuracy100: 0.3961 - val_loss: 3.2851 - val_accuracy100: 0.3934 - 38s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 36s - loss: 3.2477 - accuracy100: 0.3852 - val_loss: 3.2766 - val_accuracy100: 0.3985 - 36s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 35s - loss: 3.2366 - accuracy100: 0.3932 - val_loss: 3.2729 - val_accuracy100: 0.4017 - 35s/epoch - 15ms/step
Epoch 4/50
2425/2425 - 36s - loss: 3.2263 - accuracy100: 0.4010 - val_loss: 3.2707 - val_accuracy100: 0.4052 - 36s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 35s - loss: 3.2176 - accuracy100: 0.4072 - val_loss: 3.2705 - val_accuracy100: 0.4068 - 35s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 35s - loss: 3.2096 - accuracy100: 0.4128 - val_loss: 3.2787 - val_accuracy100: 0.4096 - 35s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.2010 - accuracy100: 0.4192 - val_loss: 3.2830 - val_accuracy100: 0.4098 - 35s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 35s - loss: 3.1915 - accuracy100: 0.4257 - val_loss: 3.2981 - val_accuracy100: 0.4098 - 35s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 35s - loss: 3.1839 - accuracy100: 0.4307 - val_loss: 3.3011 - val_accuracy100: 0.4110 - 35s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 35s - loss: 3.1737 - accuracy100: 0.4357 - val_loss: 3.3157 - val_accuracy100: 0.4098 - 35s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 36s - loss: 3.1660 - accuracy100: 0.4401 - val_loss: 3.3337 - val_accuracy100: 0.4079 - 36s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 36s - loss: 3.1577 - accuracy100: 0.4445 - val_loss: 3.3519 - val_accuracy100: 0.4077 - 36s/epoch - 15ms/step
Epoch 13/50
2425/2425 - 36s - loss: 3.1496 - accuracy100: 0.4476 - val_loss: 3.3613 - val_accuracy100: 0.4089 - 36s/epoch - 15ms/step
Epoch 14/50
2425/2425 - 35s - loss: 3.1442 - accuracy100: 0.4505 - val_loss: 3.3743 - val_accuracy100: 0.4074 - 35s/epoch - 15ms/step
Epoch 15/50
2425/2425 - 36s - loss: 3.1387 - accuracy100: 0.4525 - val_loss: 3.3797 - val_accuracy100: 0.4086 - 36s/epoch - 15ms/step
testing model: results/AAL/W4/deepOF_L1/h100
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908086
{'0': {'precision': 0.46711511613148876, 'recall': 0.14028872958474475, 'f1-score': 0.21577402472532842, 'support': 393517}, '1': {'precision': 0.343810852223146, 'recall': 0.6672729891342035, 'f1-score': 0.45380152599755313, 'support': 374938}, '2': {'precision': 0.4242540285002626, 'recall': 0.33608322147651004, 'f1-score': 0.375056359864287, 'support': 372500}, 'accuracy': 0.3773882405528702, 'macro avg': {'precision': 0.4117266656182991, 'recall': 0.3812149800651528, 'f1-score': 0.34821063686238957, 'support': 1140955}, 'weighted avg': {'precision': 0.4126018274882925, 'recall': 0.3773882405528702, 'f1-score': 0.34599671108129115, 'support': 1140955}}
[[ 55206 258466  79845]
 [ 34703 250186  90049]
 [ 28276 219033 125191]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0709326
{'0': {'precision': 0.43557604183513937, 'recall': 0.17193626473013593, 'f1-score': 0.24655078367873173, 'support': 187965}, '1': {'precision': 0.4143265471214777, 'recall': 0.6280728574815445, 'f1-score': 0.4992851247457319, 'support': 244642}, '2': {'precision': 0.4050532762624653, 'recall': 0.37827106157010953, 'f1-score': 0.39120432087736895, 'support': 188127}, 'accuracy': 0.41424184916566514, 'macro avg': {'precision': 0.41831862173969414, 'recall': 0.39276006126059665, 'f1-score': 0.37901340976727754, 'support': 620734}, 'weighted avg': {'precision': 0.4179506576856807, 'recall': 0.41424184916566514, 'f1-score': 0.3899981712229633, 'support': 620734}}
[[ 32318 116063  39584]
 [ 26048 153653  64941]
 [ 15830 101134  71163]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0749551
{'0': {'precision': 0.4459503726148555, 'recall': 0.17177149706643113, 'f1-score': 0.24801311684467015, 'support': 63404}, '1': {'precision': 0.3968687602863898, 'recall': 0.6246909683867234, 'f1-score': 0.4853760837024435, 'support': 76044}, '2': {'precision': 0.4103987531303084, 'recall': 0.37936672386440895, 'f1-score': 0.3942730721670297, 'support': 61774}, 'accuracy': 0.40666527516871914, 'macro avg': {'precision': 0.41773929534385124, 'recall': 0.39194306310585453, 'f1-score': 0.37588742423804783, 'support': 201222}, 'weighted avg': {'precision': 0.41648774988998316, 'recall': 0.40666527516871914, 'f1-score': 0.3826161519592001, 'support': 201222}}
[[10891 38911 13602]
 [ 8474 47504 20066]
 [ 5057 33282 23435]]
training model: results/AAL/W4/deepOF_L1/h200
Epoch 1/50
2425/2425 - 38s - loss: 3.2816 - accuracy200: 0.3837 - val_loss: 3.3032 - val_accuracy200: 0.3398 - 38s/epoch - 15ms/step
Epoch 2/50
2425/2425 - 35s - loss: 3.2753 - accuracy200: 0.3794 - val_loss: 3.2989 - val_accuracy200: 0.3450 - 35s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 35s - loss: 3.2693 - accuracy200: 0.3835 - val_loss: 3.3011 - val_accuracy200: 0.3438 - 35s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 35s - loss: 3.2637 - accuracy200: 0.3888 - val_loss: 3.3048 - val_accuracy200: 0.3407 - 35s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 37s - loss: 3.2577 - accuracy200: 0.3937 - val_loss: 3.3108 - val_accuracy200: 0.3384 - 37s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 35s - loss: 3.2512 - accuracy200: 0.3985 - val_loss: 3.3168 - val_accuracy200: 0.3380 - 35s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.2456 - accuracy200: 0.4027 - val_loss: 3.3249 - val_accuracy200: 0.3376 - 35s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 36s - loss: 3.2392 - accuracy200: 0.4068 - val_loss: 3.3357 - val_accuracy200: 0.3380 - 36s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 35s - loss: 3.2340 - accuracy200: 0.4101 - val_loss: 3.3424 - val_accuracy200: 0.3373 - 35s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 35s - loss: 3.2291 - accuracy200: 0.4127 - val_loss: 3.3493 - val_accuracy200: 0.3372 - 35s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 36s - loss: 3.2248 - accuracy200: 0.4152 - val_loss: 3.3557 - val_accuracy200: 0.3367 - 36s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 37s - loss: 3.2214 - accuracy200: 0.4179 - val_loss: 3.3686 - val_accuracy200: 0.3364 - 37s/epoch - 15ms/step
testing model: results/AAL/W4/deepOF_L1/h200
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109011
{'0': {'precision': 0.4569317023445464, 'recall': 0.046712835549408124, 'f1-score': 0.08476047633986704, 'support': 422218}, '1': {'precision': 0.28772087355289744, 'recall': 0.8857216016190186, 'f1-score': 0.43434697198115285, 'support': 324147}, '2': {'precision': 0.4279281532996448, 'recall': 0.10837831673382499, 'f1-score': 0.17295384459835197, 'support': 394590}, 'accuracy': 0.30640296944226547, 'macro avg': {'precision': 0.3908602430656962, 'recall': 0.34693758463408386, 'f1-score': 0.2306870976397906, 'support': 1140955}, 'weighted avg': {'precision': 0.3988280146987108, 'recall': 0.30640296944226547, 'f1-score': 0.2145794744456218, 'support': 1140955}}
[[ 19723 371712  30783]
 [ 10656 287104  26387]
 [ 12785 339040  42765]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972497
{'0': {'precision': 0.42785547785547784, 'recall': 0.08893960538047059, 'f1-score': 0.14726648373690204, 'support': 206376}, '1': {'precision': 0.33483094912898664, 'recall': 0.8194760068614658, 'f1-score': 0.4754124156350074, 'support': 204621}, '2': {'precision': 0.423998546172019, 'recall': 0.1557379003227852, 'f1-score': 0.2278022840205736, 'support': 209737}, 'accuracy': 0.35232643934438906, 'macro avg': {'precision': 0.39556165771882784, 'recall': 0.3547178375215739, 'f1-score': 0.2834937277974943, 'support': 620734}, 'weighted avg': {'precision': 0.3958873347007015, 'recall': 0.35232643934438906, 'f1-score': 0.28264957194379686, 'support': 620734}}
[[ 18355 167676  20345]
 [ 12910 167682  24029]
 [ 11635 165438  32664]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100006
{'0': {'precision': 0.44340625949559404, 'recall': 0.0843643406371047, 'f1-score': 0.14175733436953564, 'support': 69188}, '1': {'precision': 0.32436572698032945, 'recall': 0.8259950577374384, 'f1-score': 0.4658094937596409, 'support': 64343}, '2': {'precision': 0.4286422404890743, 'recall': 0.1532995523777164, 'f1-score': 0.22583242655059846, 'support': 67691}, 'accuracy': 0.3446988897834233, 'macro avg': {'precision': 0.3988047423216659, 'recall': 0.35455298358408655, 'f1-score': 0.27779975155992503, 'support': 201222}, 'weighted avg': {'precision': 0.40037509891573697, 'recall': 0.3446988897834233, 'f1-score': 0.27365948799322426, 'support': 201222}}
[[ 5837 56701  6650]
 [ 4014 53147  7182]
 [ 3313 54001 10377]]
training model: results/AAL/W4/deepOF_L1/h300
Epoch 1/50
2425/2425 - 38s - loss: 3.2867 - accuracy300: 0.3765 - val_loss: 3.3189 - val_accuracy300: 0.3317 - 38s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 36s - loss: 3.2822 - accuracy300: 0.3719 - val_loss: 3.3124 - val_accuracy300: 0.3338 - 36s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 36s - loss: 3.2797 - accuracy300: 0.3732 - val_loss: 3.3131 - val_accuracy300: 0.3327 - 36s/epoch - 15ms/step
Epoch 4/50
2425/2425 - 36s - loss: 3.2758 - accuracy300: 0.3776 - val_loss: 3.3151 - val_accuracy300: 0.3333 - 36s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 36s - loss: 3.2716 - accuracy300: 0.3814 - val_loss: 3.3165 - val_accuracy300: 0.3318 - 36s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 36s - loss: 3.2681 - accuracy300: 0.3844 - val_loss: 3.3176 - val_accuracy300: 0.3319 - 36s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 37s - loss: 3.2645 - accuracy300: 0.3872 - val_loss: 3.3165 - val_accuracy300: 0.3329 - 37s/epoch - 15ms/step
Epoch 8/50
2425/2425 - 36s - loss: 3.2609 - accuracy300: 0.3900 - val_loss: 3.3191 - val_accuracy300: 0.3327 - 36s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 36s - loss: 3.2583 - accuracy300: 0.3921 - val_loss: 3.3216 - val_accuracy300: 0.3323 - 36s/epoch - 15ms/step
Epoch 10/50
2425/2425 - 36s - loss: 3.2557 - accuracy300: 0.3934 - val_loss: 3.3232 - val_accuracy300: 0.3315 - 36s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 36s - loss: 3.2535 - accuracy300: 0.3955 - val_loss: 3.3254 - val_accuracy300: 0.3323 - 36s/epoch - 15ms/step
Epoch 12/50
2425/2425 - 37s - loss: 3.2513 - accuracy300: 0.3967 - val_loss: 3.3307 - val_accuracy300: 0.3320 - 37s/epoch - 15ms/step
testing model: results/AAL/W4/deepOF_L1/h300
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045394
{'0': {'precision': 0.36283185840707965, 'recall': 0.0008380280790505755, 'f1-score': 0.0016721939133161187, 'support': 391395}, '1': {'precision': 0.3343605375268527, 'recall': 0.9414362820472589, 'f1-score': 0.4934628092546637, 'support': 382404}, '2': {'precision': 0.36553945249597425, 'recall': 0.06306311213761998, 'f1-score': 0.10756844398812536, 'support': 367156}, 'accuracy': 0.3361140448133362, 'macro avg': {'precision': 0.35424394947663557, 'recall': 0.3351124740879765, 'f1-score': 0.20090114905203504, 'support': 1140955}, 'weighted avg': {'precision': 0.3541606684174831, 'recall': 0.3361140448133362, 'f1-score': 0.20057849789678553, 'support': 1140955}}
[[   328 372923  18144]
 [   351 360009  22044]
 [   225 343777  23154]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026664
{'0': {'precision': 0.41365888181174804, 'recall': 0.005680796574999636, 'f1-score': 0.011207677594711586, 'support': 205781}, '1': {'precision': 0.3311349337409414, 'recall': 0.9457420995702635, 'f1-score': 0.490522171371676, 'support': 205242}, '2': {'precision': 0.3996973899886521, 'recall': 0.06046416258565359, 'f1-score': 0.10503862323192578, 'support': 209711}, 'accuracy': 0.33501467617369113, 'macro avg': {'precision': 0.38149706851378057, 'recall': 0.3372956862436389, 'f1-score': 0.2022561573994378, 'support': 620734}, 'weighted avg': {'precision': 0.3816560294439677, 'recall': 0.33501467617369113, 'f1-score': 0.20139034323296817, 'support': 620734}}
[[  1169 195746   8866]
 [   958 194106  10178]
 [   699 196332  12680]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042194
{'0': {'precision': 0.41097424412094063, 'recall': 0.005352116784063234, 'f1-score': 0.010566624438558103, 'support': 68571}, '1': {'precision': 0.32977323451383334, 'recall': 0.9432249322493225, 'f1-score': 0.48868937112903477, 'support': 66420}, '2': {'precision': 0.3872307543707138, 'recall': 0.06053056725702466, 'f1-score': 0.10469549775410007, 'support': 66231}, 'accuracy': 0.33308982119251374, 'macro avg': {'precision': 0.37599274433516255, 'recall': 0.3363692054301368, 'f1-score': 0.20131716444056433, 'support': 201222}, 'weighted avg': {'precision': 0.37635613015849445, 'recall': 0.33308982119251374, 'f1-score': 0.19936885403444285, 'support': 201222}}
[[  367 65310  2894]
 [  321 62649  3450]
 [  205 62017  4009]]
training model: results/AAL/W4/deepOF_L1/h500
Epoch 1/50
2425/2425 - 38s - loss: 3.2869 - accuracy500: 0.3720 - val_loss: 4.0772 - val_accuracy500: 0.3101 - 38s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 36s - loss: 3.2821 - accuracy500: 0.3736 - val_loss: 3.7727 - val_accuracy500: 0.3102 - 36s/epoch - 15ms/step
Epoch 3/50
2425/2425 - 35s - loss: 3.2805 - accuracy500: 0.3723 - val_loss: 3.7080 - val_accuracy500: 0.3100 - 35s/epoch - 15ms/step
Epoch 4/50
2425/2425 - 36s - loss: 3.2792 - accuracy500: 0.3733 - val_loss: 3.6185 - val_accuracy500: 0.3101 - 36s/epoch - 15ms/step
Epoch 5/50
2425/2425 - 35s - loss: 3.2775 - accuracy500: 0.3745 - val_loss: 3.5970 - val_accuracy500: 0.3100 - 35s/epoch - 15ms/step
Epoch 6/50
2425/2425 - 36s - loss: 3.2755 - accuracy500: 0.3763 - val_loss: 3.5772 - val_accuracy500: 0.3100 - 36s/epoch - 15ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.2737 - accuracy500: 0.3776 - val_loss: 3.5970 - val_accuracy500: 0.3100 - 35s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 35s - loss: 3.2719 - accuracy500: 0.3787 - val_loss: 3.6031 - val_accuracy500: 0.3101 - 35s/epoch - 14ms/step
Epoch 9/50
2425/2425 - 34s - loss: 3.2703 - accuracy500: 0.3797 - val_loss: 3.6212 - val_accuracy500: 0.3100 - 34s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 35s - loss: 3.2697 - accuracy500: 0.3810 - val_loss: 3.6137 - val_accuracy500: 0.3101 - 35s/epoch - 14ms/step
Epoch 11/50
2425/2425 - 34s - loss: 3.2684 - accuracy500: 0.3818 - val_loss: 3.6202 - val_accuracy500: 0.3101 - 34s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 35s - loss: 3.2674 - accuracy500: 0.3821 - val_loss: 3.6234 - val_accuracy500: 0.3101 - 35s/epoch - 14ms/step
Epoch 13/50
2425/2425 - 35s - loss: 3.2668 - accuracy500: 0.3826 - val_loss: 3.6148 - val_accuracy500: 0.3100 - 35s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 35s - loss: 3.2654 - accuracy500: 0.3835 - val_loss: 3.6256 - val_accuracy500: 0.3100 - 35s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 35s - loss: 3.2644 - accuracy500: 0.3847 - val_loss: 3.6219 - val_accuracy500: 0.3100 - 35s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 35s - loss: 3.2635 - accuracy500: 0.3858 - val_loss: 3.6185 - val_accuracy500: 0.3100 - 35s/epoch - 14ms/step
testing model: results/AAL/W4/deepOF_L1/h500
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2006938
{'0': {'precision': 0.42857142857142855, 'recall': 2.2036139268400178e-05, 'f1-score': 4.407001255995358e-05, 'support': 408420}, '1': {'precision': 0.3096143176561228, 'recall': 0.9999688609329265, 'f1-score': 0.4728293423693603, 'support': 353254}, '2': {'precision': 0.3333333333333333, 'recall': 1.8455973275750695e-05, 'f1-score': 3.69099029269553e-05, 'support': 379281}, 'accuracy': 0.30961694370067183, 'macro avg': {'precision': 0.35717302652029487, 'recall': 0.33333645101515685, 'f1-score': 0.15763677409494906, 'support': 1140955}, 'weighted avg': {'precision': 0.3600813695776247, 'recall': 0.30961694370067183, 'f1-score': 0.1464219489890204, 'support': 1140955}}
[[     9 408405      6]
 [     3 353243      8]
 [     9 379265      7]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1777997
{'0': {'precision': 0.3333333333333333, 'recall': 3.390618642590045e-05, 'f1-score': 6.780547577649377e-05, 'support': 206452}, '1': {'precision': 0.3295557438800795, 'recall': 0.9999120088382234, 'f1-score': 0.49572732428227284, 'support': 204566}, '2': {'precision': 0.5142857142857142, 'recall': 8.583036105971886e-05, 'f1-score': 0.00017163207803538483, 'support': 209716}, 'accuracy': 0.32956628765300433, 'macro avg': {'precision': 0.39239159716637567, 'recall': 0.3333439151285697, 'f1-score': 0.16532225394536157, 'support': 620734}, 'weighted avg': {'precision': 0.39322346849544004, 'recall': 0.32956628765300433, 'f1-score': 0.1634499614780078, 'support': 620734}}
[[     7 206436      9]
 [    10 204548      8]
 [     4 209694     18]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1952249
{'0': {'precision': 0.4444444444444444, 'recall': 5.593388614657475e-05, 'f1-score': 0.00011185369536646066, 'support': 71513}, '1': {'precision': 0.3100174943342213, 'recall': 0.9999358789394377, 'f1-score': 0.47329564854508893, 'support': 62382}, '2': {'precision': 0.4, 'recall': 2.9705764403582516e-05, 'f1-score': 5.940711697261332e-05, 'support': 67327}, 'accuracy': 0.3100257427120295, 'macro avg': {'precision': 0.3848206462595553, 'recall': 0.3333405061966626, 'f1-score': 0.15782230311914267, 'support': 201222}, 'weighted avg': {'precision': 0.38789926989649715, 'recall': 0.3100257427120295, 'f1-score': 0.14678875989613907, 'support': 201222}}
[[    4 71507     2]
 [    3 62378     1]
 [    2 67323     2]]
training model: results/AAL/W4/deepOF_L1/h1000
Epoch 1/50
2425/2425 - 38s - loss: 3.2346 - accuracy1000: 0.4119 - val_loss: 3.5208 - val_accuracy1000: 0.3495 - 38s/epoch - 16ms/step
Epoch 2/50
2425/2425 - 35s - loss: 3.2448 - accuracy1000: 0.4012 - val_loss: 3.4537 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 3/50
2425/2425 - 35s - loss: 3.2590 - accuracy1000: 0.3912 - val_loss: 3.4509 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 4/50
2425/2425 - 34s - loss: 3.2588 - accuracy1000: 0.3918 - val_loss: 3.4449 - val_accuracy1000: 0.3496 - 34s/epoch - 14ms/step
Epoch 5/50
2425/2425 - 34s - loss: 3.2534 - accuracy1000: 0.3966 - val_loss: 3.4410 - val_accuracy1000: 0.3496 - 34s/epoch - 14ms/step
Epoch 6/50
2425/2425 - 35s - loss: 3.2559 - accuracy1000: 0.3940 - val_loss: 3.4266 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 7/50
2425/2425 - 35s - loss: 3.2504 - accuracy1000: 0.3968 - val_loss: 3.4369 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 8/50
2425/2425 - 35s - loss: 3.2457 - accuracy1000: 0.3997 - val_loss: 3.4453 - val_accuracy1000: 0.3496 - 35s/epoch - 15ms/step
Epoch 9/50
2425/2425 - 35s - loss: 3.2420 - accuracy1000: 0.4021 - val_loss: 3.4553 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 10/50
2425/2425 - 36s - loss: 3.2378 - accuracy1000: 0.4049 - val_loss: 3.4608 - val_accuracy1000: 0.3496 - 36s/epoch - 15ms/step
Epoch 11/50
2425/2425 - 35s - loss: 3.2357 - accuracy1000: 0.4057 - val_loss: 3.4678 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 12/50
2425/2425 - 35s - loss: 3.2333 - accuracy1000: 0.4073 - val_loss: 3.4797 - val_accuracy1000: 0.3496 - 35s/epoch - 15ms/step
Epoch 13/50
2425/2425 - 35s - loss: 3.2306 - accuracy1000: 0.4090 - val_loss: 3.4957 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 14/50
2425/2425 - 34s - loss: 3.2276 - accuracy1000: 0.4108 - val_loss: 3.5009 - val_accuracy1000: 0.3496 - 34s/epoch - 14ms/step
Epoch 15/50
2425/2425 - 35s - loss: 3.2244 - accuracy1000: 0.4126 - val_loss: 3.5142 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
Epoch 16/50
2425/2425 - 35s - loss: 3.2208 - accuracy1000: 0.4145 - val_loss: 3.5189 - val_accuracy1000: 0.3496 - 35s/epoch - 14ms/step
testing model: results/AAL/W4/deepOF_L1/h1000
Evaluating performance on  test set...
4457/4457 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009396
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 354265}, '1': {'precision': 0.41211446601516283, 'recall': 1.0, 'f1-score': 0.583684220979771, 'support': 470202}, '2': {'precision': 0.5, 'recall': 6.319354920249741e-06, 'f1-score': 1.2638550105531894e-05, 'support': 316488}, 'accuracy': 0.41211441292601375, 'macro avg': {'precision': 0.3040381553383876, 'recall': 0.33333543978497343, 'f1-score': 0.1945656198432922, 'support': 1140955}, 'weighted avg': {'precision': 0.3085319282086161, 'recall': 0.41211441292601375, 'f1-score': 0.240547162703679, 'support': 1140955}}
[[     0 354263      2]
 [     0 470202      0]
 [     1 316485      2]]
Evaluating performance on  train set...
2425/2425 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1543252
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 204042}, '1': {'precision': 0.3301247559333174, 'recall': 1.0, 'f1-score': 0.49638164309133037, 'support': 204919}, '2': {'precision': 0.5, 'recall': 4.722037275762255e-06, 'f1-score': 9.443985361822689e-06, 'support': 211773}, 'accuracy': 0.3301253032699997, 'macro avg': {'precision': 0.27670825197777243, 'recall': 0.3333349073457586, 'f1-score': 0.16546369569223074, 'support': 620734}, 'weighted avg': {'precision': 0.2795647328180823, 'recall': 0.3301253032699997, 'f1-score': 0.16387056275593792, 'support': 620734}}
[[     0 204041      1]
 [     0 204919      0]
 [     0 211772      1]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1427467
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 67948}, '1': {'precision': 0.34956913259981515, 'recall': 1.0, 'f1-score': 0.5180455363948697, 'support': 70341}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 62933}, 'accuracy': 0.34956913259981515, 'macro avg': {'precision': 0.11652304419993838, 'recall': 0.3333333333333333, 'f1-score': 0.17268184546495657, 'support': 201222}, 'weighted avg': {'precision': 0.12219857846658715, 'recall': 0.34956913259981515, 'f1-score': 0.18109272880476054, 'support': 201222}}
[[    0 67948     0]
 [    0 70341     0]
 [    0 62933     0]]
training model: results/AAL/W4/deepLOB_L2/h10
Epoch 1/50
2425/2425 - 101s - loss: 2.7428 - accuracy10: 0.4602 - val_loss: 3.1188 - val_accuracy10: 0.5133 - 101s/epoch - 42ms/step
Epoch 2/50
2425/2425 - 98s - loss: 2.4725 - accuracy10: 0.5307 - val_loss: 3.0243 - val_accuracy10: 0.6467 - 98s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 99s - loss: 2.2953 - accuracy10: 0.6082 - val_loss: 2.5247 - val_accuracy10: 0.5609 - 99s/epoch - 41ms/step
Epoch 4/50
2425/2425 - 99s - loss: 2.2070 - accuracy10: 0.6322 - val_loss: 2.5310 - val_accuracy10: 0.6481 - 99s/epoch - 41ms/step
Epoch 5/50
2425/2425 - 99s - loss: 2.1660 - accuracy10: 0.6418 - val_loss: 2.5187 - val_accuracy10: 0.6239 - 99s/epoch - 41ms/step
Epoch 6/50
2425/2425 - 99s - loss: 2.1360 - accuracy10: 0.6469 - val_loss: 2.5029 - val_accuracy10: 0.6473 - 99s/epoch - 41ms/step
Epoch 7/50
2425/2425 - 99s - loss: 2.1142 - accuracy10: 0.6516 - val_loss: 2.4401 - val_accuracy10: 0.6480 - 99s/epoch - 41ms/step
Epoch 8/50
2425/2425 - 100s - loss: 2.0948 - accuracy10: 0.6543 - val_loss: 2.4365 - val_accuracy10: 0.6531 - 100s/epoch - 41ms/step
Epoch 9/50
2425/2425 - 100s - loss: 2.0793 - accuracy10: 0.6562 - val_loss: 2.3936 - val_accuracy10: 0.6338 - 100s/epoch - 41ms/step
Epoch 10/50
2425/2425 - 99s - loss: 2.0642 - accuracy10: 0.6577 - val_loss: 2.4191 - val_accuracy10: 0.6258 - 99s/epoch - 41ms/step
Epoch 11/50
2425/2425 - 99s - loss: 2.0529 - accuracy10: 0.6589 - val_loss: 2.4135 - val_accuracy10: 0.6510 - 99s/epoch - 41ms/step
Epoch 12/50
2425/2425 - 98s - loss: 2.0418 - accuracy10: 0.6601 - val_loss: 2.4315 - val_accuracy10: 0.6171 - 98s/epoch - 41ms/step
Epoch 13/50
2425/2425 - 99s - loss: 2.0328 - accuracy10: 0.6602 - val_loss: 2.3719 - val_accuracy10: 0.6072 - 99s/epoch - 41ms/step
Epoch 14/50
2425/2425 - 99s - loss: 2.0237 - accuracy10: 0.6616 - val_loss: 2.4143 - val_accuracy10: 0.6165 - 99s/epoch - 41ms/step
Epoch 15/50
2425/2425 - 100s - loss: 2.0170 - accuracy10: 0.6623 - val_loss: 2.4347 - val_accuracy10: 0.6274 - 100s/epoch - 41ms/step
Epoch 16/50
2425/2425 - 99s - loss: 2.0077 - accuracy10: 0.6626 - val_loss: 2.4128 - val_accuracy10: 0.6080 - 99s/epoch - 41ms/step
Epoch 17/50
2425/2425 - 100s - loss: 2.0012 - accuracy10: 0.6635 - val_loss: 2.4098 - val_accuracy10: 0.6147 - 100s/epoch - 41ms/step
Epoch 18/50
2425/2425 - 99s - loss: 1.9944 - accuracy10: 0.6640 - val_loss: 2.3675 - val_accuracy10: 0.6177 - 99s/epoch - 41ms/step
Epoch 19/50
2425/2425 - 99s - loss: 1.9877 - accuracy10: 0.6652 - val_loss: 2.3962 - val_accuracy10: 0.6116 - 99s/epoch - 41ms/step
Epoch 20/50
2425/2425 - 99s - loss: 1.9829 - accuracy10: 0.6658 - val_loss: 2.4736 - val_accuracy10: 0.5812 - 99s/epoch - 41ms/step
Epoch 21/50
2425/2425 - 99s - loss: 1.9754 - accuracy10: 0.6666 - val_loss: 2.4456 - val_accuracy10: 0.5892 - 99s/epoch - 41ms/step
Epoch 22/50
2425/2425 - 98s - loss: 1.9695 - accuracy10: 0.6668 - val_loss: 2.5258 - val_accuracy10: 0.5765 - 98s/epoch - 41ms/step
Epoch 23/50
2425/2425 - 99s - loss: 1.9635 - accuracy10: 0.6678 - val_loss: 2.5440 - val_accuracy10: 0.5735 - 99s/epoch - 41ms/step
Epoch 24/50
2425/2425 - 99s - loss: 1.9592 - accuracy10: 0.6678 - val_loss: 2.5388 - val_accuracy10: 0.5975 - 99s/epoch - 41ms/step
Epoch 25/50
2425/2425 - 100s - loss: 1.9544 - accuracy10: 0.6676 - val_loss: 2.5572 - val_accuracy10: 0.5640 - 100s/epoch - 41ms/step
Epoch 26/50
2425/2425 - 99s - loss: 1.9490 - accuracy10: 0.6688 - val_loss: 2.5830 - val_accuracy10: 0.5466 - 99s/epoch - 41ms/step
Epoch 27/50
2425/2425 - 99s - loss: 1.9435 - accuracy10: 0.6686 - val_loss: 2.5605 - val_accuracy10: 0.5943 - 99s/epoch - 41ms/step
Epoch 28/50
2425/2425 - 99s - loss: 1.9399 - accuracy10: 0.6696 - val_loss: 2.6919 - val_accuracy10: 0.5343 - 99s/epoch - 41ms/step
testing model: results/AAL/W4/deepLOB_L2/h10
Evaluating performance on  test set...
4457/4457 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4153214
{'0': {'precision': 0.2902518258560182, 'recall': 0.71064059542747, 'f1-score': 0.4121616388816869, 'support': 172246}, '1': {'precision': 0.9145704389302141, 'recall': 0.20135641955244404, 'f1-score': 0.3300478478704112, 'support': 799900}, '2': {'precision': 0.24789322610282272, 'recall': 0.7975570601790146, 'f1-score': 0.3782274398757202, 'support': 168813}, 'accuracy': 0.3664531328470173, 'macro avg': {'precision': 0.4842384969630184, 'recall': 0.5698513583863095, 'f1-score': 0.37347897554260606, 'support': 1140959}, 'weighted avg': {'precision': 0.7216799282662828, 'recall': 0.3664531328470173, 'f1-score': 0.34957275061601417, 'support': 1140959}}
[[122405   7992  41849]
 [272193 161065 366642]
 [ 27122   7053 134638]]
Evaluating performance on  train set...
2425/2425 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7956701
{'0': {'precision': 0.36775210670238295, 'recall': 0.6625028275567396, 'f1-score': 0.47296412262365095, 'support': 79574}, '1': {'precision': 0.9290578538112726, 'recall': 0.6170923683711959, 'f1-score': 0.7416025986828063, 'support': 464488}, '2': {'precision': 0.3318370779197707, 'recall': 0.7308249103358331, 'f1-score': 0.45642886524042825, 'support': 76675}, 'accuracy': 0.6369621917172651, 'macro avg': {'precision': 0.5428823461444754, 'recall': 0.6701400354212561, 'f1-score': 0.5569985288489618, 'support': 620737}, 'weighted avg': {'precision': 0.7833322944972255, 'recall': 0.6369621917172651, 'f1-score': 0.6719397074653896, 'support': 620737}}
[[ 52718  12493  14363]
 [ 79389 286632  98467]
 [ 11245   9394  56036]]
Evaluating performance on  val set...
787/787 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8133
{'0': {'precision': 0.39033405071582294, 'recall': 0.6178855767450472, 'f1-score': 0.47843103522429137, 'support': 27005}, '1': {'precision': 0.921183040157571, 'recall': 0.5931927812447293, 'f1-score': 0.7216691152933838, 'support': 148225}, '2': {'precision': 0.3141769139230464, 'recall': 0.7618113265620191, 'f1-score': 0.44488131480503723, 'support': 25992}, 'accuracy': 0.6182872648119987, 'macro avg': {'precision': 0.5418980015988134, 'recall': 0.6576298948505985, 'f1-score': 0.5483271551075708, 'support': 201222}, 'weighted avg': {'precision': 0.7715330009324259, 'recall': 0.6182872648119987, 'f1-score': 0.6532724545775627, 'support': 201222}}
[[16686  4732  5587]
 [22662 87926 37637]
 [ 3400  2791 19801]]
training model: results/AAL/W4/deepLOB_L2/h20
Epoch 1/50
2425/2425 - 103s - loss: 2.8506 - accuracy20: 0.4619 - val_loss: 3.3222 - val_accuracy20: 0.3969 - 103s/epoch - 42ms/step
Epoch 2/50
2425/2425 - 99s - loss: 2.6506 - accuracy20: 0.5069 - val_loss: 3.0844 - val_accuracy20: 0.5627 - 99s/epoch - 41ms/step
Epoch 3/50
2425/2425 - 99s - loss: 2.4832 - accuracy20: 0.5776 - val_loss: 2.9376 - val_accuracy20: 0.5976 - 99s/epoch - 41ms/step
Epoch 4/50
2425/2425 - 100s - loss: 2.3872 - accuracy20: 0.6115 - val_loss: 2.7228 - val_accuracy20: 0.5753 - 100s/epoch - 41ms/step
Epoch 5/50
2425/2425 - 100s - loss: 2.3332 - accuracy20: 0.6246 - val_loss: 2.7607 - val_accuracy20: 0.4750 - 100s/epoch - 41ms/step
Epoch 6/50
2425/2425 - 99s - loss: 2.2967 - accuracy20: 0.6297 - val_loss: 2.6436 - val_accuracy20: 0.5210 - 99s/epoch - 41ms/step
Epoch 7/50
2425/2425 - 99s - loss: 2.2730 - accuracy20: 0.6340 - val_loss: 2.6249 - val_accuracy20: 0.5453 - 99s/epoch - 41ms/step
Epoch 8/50
2425/2425 - 99s - loss: 2.2512 - accuracy20: 0.6371 - val_loss: 2.5825 - val_accuracy20: 0.5724 - 99s/epoch - 41ms/step
Epoch 9/50
2425/2425 - 100s - loss: 2.2350 - accuracy20: 0.6400 - val_loss: 2.5790 - val_accuracy20: 0.5486 - 100s/epoch - 41ms/step
Epoch 10/50
2425/2425 - 98s - loss: 2.2188 - accuracy20: 0.6416 - val_loss: 2.5817 - val_accuracy20: 0.5608 - 98s/epoch - 41ms/step
Epoch 11/50
2425/2425 - 98s - loss: 2.2077 - accuracy20: 0.6432 - val_loss: 2.5988 - val_accuracy20: 0.5581 - 98s/epoch - 41ms/step
Epoch 12/50
2425/2425 - 98s - loss: 2.1981 - accuracy20: 0.6448 - val_loss: 2.6384 - val_accuracy20: 0.5197 - 98s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 99s - loss: 2.1880 - accuracy20: 0.6461 - val_loss: 2.6591 - val_accuracy20: 0.5029 - 99s/epoch - 41ms/step
Epoch 14/50
2425/2425 - 99s - loss: 2.1809 - accuracy20: 0.6474 - val_loss: 2.6161 - val_accuracy20: 0.5310 - 99s/epoch - 41ms/step
Epoch 15/50
2425/2425 - 98s - loss: 2.1734 - accuracy20: 0.6476 - val_loss: 2.6754 - val_accuracy20: 0.5114 - 98s/epoch - 41ms/step
Epoch 16/50
2425/2425 - 99s - loss: 2.1656 - accuracy20: 0.6491 - val_loss: 2.6897 - val_accuracy20: 0.5009 - 99s/epoch - 41ms/step
Epoch 17/50
2425/2425 - 100s - loss: 2.1600 - accuracy20: 0.6499 - val_loss: 2.5980 - val_accuracy20: 0.5514 - 100s/epoch - 41ms/step
Epoch 18/50
2425/2425 - 97s - loss: 2.1541 - accuracy20: 0.6498 - val_loss: 2.6065 - val_accuracy20: 0.5534 - 97s/epoch - 40ms/step
Epoch 19/50
2425/2425 - 97s - loss: 2.1477 - accuracy20: 0.6511 - val_loss: 2.6529 - val_accuracy20: 0.5044 - 97s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h20
Evaluating performance on  test set...
4457/4457 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2446642
{'0': {'precision': 0.37115042459687153, 'recall': 0.5773159424844818, 'f1-score': 0.451826368580721, 'support': 229086}, '1': {'precision': 0.8686300758589915, 'recall': 0.22664466120022936, 'f1-score': 0.35949038645770576, 'support': 687102}, '2': {'precision': 0.3098154593857016, 'recall': 0.8343781003777178, 'f1-score': 0.4518522801742415, 'support': 224771}, 'accuracy': 0.416778341728318, 'macro avg': {'precision': 0.5165319866138549, 'recall': 0.5461129013541429, 'f1-score': 0.42105634507088946, 'support': 1140959}, 'weighted avg': {'precision': 0.6586567608245758, 'recall': 0.416778341728318, 'f1-score': 0.3962254102518934, 'support': 1140959}}
[[132255  12331  84500]
 [198077 155728 333297]
 [ 26006  11221 187544]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81770825
{'0': {'precision': 0.4200022053148087, 'recall': 0.5817432059640515, 'f1-score': 0.4878154203269766, 'support': 104761}, '1': {'precision': 0.8721917355136763, 'recall': 0.5936208787085874, 'f1-score': 0.7064357604982227, 'support': 413129}, '2': {'precision': 0.37389305439846954, 'recall': 0.7069238772156698, 'f1-score': 0.48910027211479273, 'support': 102847}, 'accuracy': 0.6103889408880089, 'macro avg': {'precision': 0.5553623317423182, 'recall': 0.6274293206294362, 'f1-score': 0.5611171509799974, 'support': 620737}, 'weighted avg': {'precision': 0.7133155096244201, 'recall': 0.6103889408880089, 'f1-score': 0.6335301846578095, 'support': 620737}}
[[ 60944  20104  23713]
 [ 69851 245242  98036]
 [ 14309  15833  72705]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89203584
{'0': {'precision': 0.42615122228538943, 'recall': 0.5300223435246203, 'f1-score': 0.47244491504058894, 'support': 35357}, '1': {'precision': 0.8642221745887144, 'recall': 0.491347398887958, 'f1-score': 0.6265016947177251, 'support': 131290}, '2': {'precision': 0.32786944784087746, 'recall': 0.7833116413593637, 'f1-score': 0.4622540067248118, 'support': 34575}, 'accuracy': 0.5483098269572909, 'macro avg': {'precision': 0.5394142815716604, 'recall': 0.601560461257314, 'f1-score': 0.5204002054943753, 'support': 201222}, 'weighted avg': {'precision': 0.6950892259653276, 'recall': 0.5483098269572909, 'f1-score': 0.5712102784143415, 'support': 201222}}
[[18740  6197 10420]
 [21681 64509 45100]
 [ 3554  3938 27083]]
training model: results/AAL/W4/deepLOB_L2/h30
Epoch 1/50
2425/2425 - 99s - loss: 2.8923 - accuracy30: 0.4676 - val_loss: 3.0028 - val_accuracy30: 0.5029 - 99s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 96s - loss: 2.7120 - accuracy30: 0.5179 - val_loss: 2.9519 - val_accuracy30: 0.4694 - 96s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 97s - loss: 2.5899 - accuracy30: 0.5667 - val_loss: 2.8641 - val_accuracy30: 0.5628 - 97s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 97s - loss: 2.5074 - accuracy30: 0.5940 - val_loss: 2.8123 - val_accuracy30: 0.5816 - 97s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 97s - loss: 2.4664 - accuracy30: 0.6057 - val_loss: 2.7719 - val_accuracy30: 0.5897 - 97s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 97s - loss: 2.4403 - accuracy30: 0.6126 - val_loss: 2.7787 - val_accuracy30: 0.6070 - 97s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 97s - loss: 2.4200 - accuracy30: 0.6165 - val_loss: 2.7040 - val_accuracy30: 0.6010 - 97s/epoch - 40ms/step
Epoch 8/50
2425/2425 - 97s - loss: 2.4001 - accuracy30: 0.6197 - val_loss: 2.7117 - val_accuracy30: 0.6097 - 97s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 98s - loss: 2.3853 - accuracy30: 0.6219 - val_loss: 2.6854 - val_accuracy30: 0.6105 - 98s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 97s - loss: 2.3703 - accuracy30: 0.6234 - val_loss: 2.6895 - val_accuracy30: 0.5982 - 97s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 97s - loss: 2.3577 - accuracy30: 0.6250 - val_loss: 2.6611 - val_accuracy30: 0.5901 - 97s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 97s - loss: 2.3460 - accuracy30: 0.6259 - val_loss: 2.6573 - val_accuracy30: 0.5908 - 97s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 97s - loss: 2.3364 - accuracy30: 0.6276 - val_loss: 2.6412 - val_accuracy30: 0.5944 - 97s/epoch - 40ms/step
Epoch 14/50
2425/2425 - 97s - loss: 2.3269 - accuracy30: 0.6294 - val_loss: 2.6354 - val_accuracy30: 0.5922 - 97s/epoch - 40ms/step
Epoch 15/50
2425/2425 - 97s - loss: 2.3195 - accuracy30: 0.6296 - val_loss: 2.6561 - val_accuracy30: 0.5994 - 97s/epoch - 40ms/step
Epoch 16/50
2425/2425 - 98s - loss: 2.3133 - accuracy30: 0.6302 - val_loss: 2.6443 - val_accuracy30: 0.5885 - 98s/epoch - 40ms/step
Epoch 17/50
2425/2425 - 97s - loss: 2.3063 - accuracy30: 0.6313 - val_loss: 2.6286 - val_accuracy30: 0.6029 - 97s/epoch - 40ms/step
Epoch 18/50
2425/2425 - 97s - loss: 2.2991 - accuracy30: 0.6323 - val_loss: 2.6408 - val_accuracy30: 0.5999 - 97s/epoch - 40ms/step
Epoch 19/50
2425/2425 - 97s - loss: 2.2943 - accuracy30: 0.6334 - val_loss: 2.6538 - val_accuracy30: 0.5959 - 97s/epoch - 40ms/step
Epoch 20/50
2425/2425 - 97s - loss: 2.2898 - accuracy30: 0.6336 - val_loss: 2.6449 - val_accuracy30: 0.6015 - 97s/epoch - 40ms/step
Epoch 21/50
2425/2425 - 97s - loss: 2.2839 - accuracy30: 0.6349 - val_loss: 2.6546 - val_accuracy30: 0.5925 - 97s/epoch - 40ms/step
Epoch 22/50
2425/2425 - 97s - loss: 2.2784 - accuracy30: 0.6348 - val_loss: 2.6427 - val_accuracy30: 0.6026 - 97s/epoch - 40ms/step
Epoch 23/50
2425/2425 - 98s - loss: 2.2739 - accuracy30: 0.6363 - val_loss: 2.6824 - val_accuracy30: 0.5936 - 98s/epoch - 40ms/step
Epoch 24/50
2425/2425 - 97s - loss: 2.2687 - accuracy30: 0.6368 - val_loss: 2.7044 - val_accuracy30: 0.5885 - 97s/epoch - 40ms/step
Epoch 25/50
2425/2425 - 98s - loss: 2.2635 - accuracy30: 0.6371 - val_loss: 2.6886 - val_accuracy30: 0.5897 - 98s/epoch - 40ms/step
Epoch 26/50
2425/2425 - 97s - loss: 2.2590 - accuracy30: 0.6372 - val_loss: 2.7098 - val_accuracy30: 0.5799 - 97s/epoch - 40ms/step
Epoch 27/50
2425/2425 - 97s - loss: 2.2535 - accuracy30: 0.6384 - val_loss: 2.7493 - val_accuracy30: 0.5825 - 97s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h30
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1752187
{'0': {'precision': 0.368705023433706, 'recall': 0.5927817335495102, 'f1-score': 0.454632580994062, 'support': 267682}, '1': {'precision': 0.7791106845809341, 'recall': 0.2628306168899121, 'f1-score': 0.39306272160410805, 'support': 611584}, '2': {'precision': 0.3775640517172999, 'recall': 0.7275624491293233, 'f1-score': 0.49714023862459905, 'support': 261693}, 'accuracy': 0.44683288356549183, 'macro avg': {'precision': 0.5084599199106467, 'recall': 0.5277249331895819, 'f1-score': 0.44827851374092303, 'support': 1140959}, 'weighted avg': {'precision': 0.5907251675017092, 'recall': 0.44683288356549183, 'f1-score': 0.4313791736088383, 'support': 1140959}}
[[158677  20684  88321]
 [225280 160743 225561]
 [ 46406  24889 190398]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82124704
{'0': {'precision': 0.4477202672722394, 'recall': 0.5579405792019051, 'f1-score': 0.4967903565463655, 'support': 122617}, '1': {'precision': 0.8184810914951938, 'recall': 0.6352645264446765, 'f1-score': 0.7153273538040991, 'support': 376503}, '2': {'precision': 0.4353057008383084, 'recall': 0.628925232492168, 'f1-score': 0.5145025022870365, 'support': 121617}, 'accuracy': 0.6187483588057422, 'macro avg': {'precision': 0.5671690198685805, 'recall': 0.6073767793795831, 'f1-score': 0.575540070879167, 'support': 620737}, 'weighted avg': {'precision': 0.6701699364178189, 'recall': 0.6187483588057422, 'f1-score': 0.6328124288685754, 'support': 620737}}
[[ 68413  27638  26566]
 [ 64667 239179  72657]
 [ 19723  25406  76488]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8431349
{'0': {'precision': 0.48844298298250244, 'recall': 0.49268835948092193, 'f1-score': 0.49055648631383564, 'support': 41304}, '1': {'precision': 0.8008507559229496, 'recall': 0.6123153782963671, 'f1-score': 0.6940064889720727, 'support': 119298}, '2': {'precision': 0.40953384250724256, 'recall': 0.689069423929099, 'f1-score': 0.5137382302736634, 'support': 40620}, 'accuracy': 0.603254117343034, 'macro avg': {'precision': 0.5662758604708983, 'recall': 0.5980243872354626, 'f1-score': 0.5661004018531907, 'support': 201222}, 'weighted avg': {'precision': 0.6577303035048331, 'recall': 0.603254117343034, 'f1-score': 0.6158550165777757, 'support': 201222}}
[[20350 10621 10333]
 [16227 73048 30023]
 [ 5086  7544 27990]]
training model: results/AAL/W4/deepLOB_L2/h50
Epoch 1/50
2425/2425 - 100s - loss: 2.9640 - accuracy50: 0.4790 - val_loss: 3.5927 - val_accuracy50: 0.4880 - 100s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 98s - loss: 2.8269 - accuracy50: 0.5178 - val_loss: 3.2278 - val_accuracy50: 0.4210 - 98s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 99s - loss: 2.7491 - accuracy50: 0.5457 - val_loss: 3.1391 - val_accuracy50: 0.4782 - 99s/epoch - 41ms/step
Epoch 4/50
2425/2425 - 98s - loss: 2.6987 - accuracy50: 0.5614 - val_loss: 3.0867 - val_accuracy50: 0.5166 - 98s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 98s - loss: 2.6584 - accuracy50: 0.5731 - val_loss: 3.0406 - val_accuracy50: 0.5289 - 98s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 98s - loss: 2.6277 - accuracy50: 0.5795 - val_loss: 2.8974 - val_accuracy50: 0.5571 - 98s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 99s - loss: 2.6046 - accuracy50: 0.5846 - val_loss: 2.9220 - val_accuracy50: 0.5690 - 99s/epoch - 41ms/step
Epoch 8/50
2425/2425 - 97s - loss: 2.5878 - accuracy50: 0.5870 - val_loss: 2.9486 - val_accuracy50: 0.5708 - 97s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 98s - loss: 2.5744 - accuracy50: 0.5895 - val_loss: 2.9243 - val_accuracy50: 0.5707 - 98s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 99s - loss: 2.5625 - accuracy50: 0.5902 - val_loss: 2.9377 - val_accuracy50: 0.5607 - 99s/epoch - 41ms/step
Epoch 11/50
2425/2425 - 98s - loss: 2.5506 - accuracy50: 0.5929 - val_loss: 2.9316 - val_accuracy50: 0.5748 - 98s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 98s - loss: 2.5408 - accuracy50: 0.5939 - val_loss: 2.8912 - val_accuracy50: 0.5652 - 98s/epoch - 41ms/step
Epoch 13/50
2425/2425 - 98s - loss: 2.5322 - accuracy50: 0.5945 - val_loss: 2.9378 - val_accuracy50: 0.5455 - 98s/epoch - 40ms/step
Epoch 14/50
2425/2425 - 98s - loss: 2.5259 - accuracy50: 0.5957 - val_loss: 2.8745 - val_accuracy50: 0.5604 - 98s/epoch - 40ms/step
Epoch 15/50
2425/2425 - 98s - loss: 2.5183 - accuracy50: 0.5964 - val_loss: 2.8878 - val_accuracy50: 0.5673 - 98s/epoch - 40ms/step
Epoch 16/50
2425/2425 - 99s - loss: 2.5111 - accuracy50: 0.5973 - val_loss: 2.8970 - val_accuracy50: 0.5588 - 99s/epoch - 41ms/step
Epoch 17/50
2425/2425 - 98s - loss: 2.5041 - accuracy50: 0.5984 - val_loss: 2.9238 - val_accuracy50: 0.5485 - 98s/epoch - 41ms/step
Epoch 18/50
2425/2425 - 98s - loss: 2.4974 - accuracy50: 0.5992 - val_loss: 2.8913 - val_accuracy50: 0.5537 - 98s/epoch - 40ms/step
Epoch 19/50
2425/2425 - 98s - loss: 2.4919 - accuracy50: 0.6002 - val_loss: 2.9054 - val_accuracy50: 0.5484 - 98s/epoch - 41ms/step
Epoch 20/50
2425/2425 - 98s - loss: 2.4866 - accuracy50: 0.6012 - val_loss: 2.9222 - val_accuracy50: 0.5537 - 98s/epoch - 40ms/step
Epoch 21/50
2425/2425 - 98s - loss: 2.4801 - accuracy50: 0.6017 - val_loss: 2.9737 - val_accuracy50: 0.5386 - 98s/epoch - 40ms/step
Epoch 22/50
2425/2425 - 99s - loss: 2.4747 - accuracy50: 0.6025 - val_loss: 2.9110 - val_accuracy50: 0.5383 - 99s/epoch - 41ms/step
Epoch 23/50
2425/2425 - 98s - loss: 2.4695 - accuracy50: 0.6029 - val_loss: 2.9181 - val_accuracy50: 0.5411 - 98s/epoch - 40ms/step
Epoch 24/50
2425/2425 - 98s - loss: 2.4642 - accuracy50: 0.6041 - val_loss: 2.9332 - val_accuracy50: 0.5334 - 98s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h50
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2258089
{'0': {'precision': 0.3865473865824952, 'recall': 0.7181848678938181, 'f1-score': 0.5025878128253787, 'support': 321938}, '1': {'precision': 0.6558478125696587, 'recall': 0.21943330644512352, 'f1-score': 0.32884258762248325, 'support': 509517}, '2': {'precision': 0.42796253971493875, 'recall': 0.5148495657568238, 'f1-score': 0.4674024155049902, 'support': 309504}, 'accuracy': 0.44029978290192723, 'macro avg': {'precision': 0.49011924628903086, 'recall': 0.48415591336525515, 'f1-score': 0.432944271984284, 'support': 1140959}, 'weighted avg': {'precision': 0.5180431727613197, 'recall': 0.44029978290192723, 'f1-score': 0.4154539481361539, 'support': 1140959}}
[[231211  22991  67736]
 [252455 111805 145257]
 [114478  35678 159348]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90611655
{'0': {'precision': 0.44274479585089, 'recall': 0.5449402679868697, 'f1-score': 0.4885554647618071, 'support': 148664}, '1': {'precision': 0.7018242846811936, 'recall': 0.6366846253585807, 'f1-score': 0.6676694169283066, 'support': 323149}, '2': {'precision': 0.4823930512717666, 'recall': 0.46839327442185275, 'f1-score': 0.4752900935521896, 'support': 148924}, 'accuracy': 0.5743366353222057, 'macro avg': {'precision': 0.5423207106012834, 'recall': 0.5500060559224343, 'f1-score': 0.5438383250807678, 'support': 620737}, 'weighted avg': {'precision': 0.5871309924628568, 'recall': 0.5743366353222057, 'f1-score': 0.578617701081909, 'support': 620737}}
[[ 81013  44531  23120]
 [ 65678 205744  51727]
 [ 36288  42881  69755]]
Evaluating performance on  val set...
787/787 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9125708
{'0': {'precision': 0.49368041989314376, 'recall': 0.4198442723032887, 'f1-score': 0.4537784219977068, 'support': 49959}, '1': {'precision': 0.675666376353451, 'recall': 0.6169396010053408, 'f1-score': 0.6449689262492366, 'support': 101856}, '2': {'precision': 0.43882735958133023, 'recall': 0.5838241544720384, 'f1-score': 0.5010465611130894, 'support': 49407}, 'accuracy': 0.5598741688284581, 'macro avg': {'precision': 0.5360580519426416, 'recall': 0.5402026759268893, 'f1-score': 0.5332646364533443, 'support': 201222}, 'weighted avg': {'precision': 0.5723310467152372, 'recall': 0.5598741688284581, 'f1-score': 0.5621625795466703, 'support': 201222}}
[[20975 17719 11265]
 [13395 62839 25622]
 [ 8117 12445 28845]]
training model: results/AAL/W4/deepLOB_L2/h100
Epoch 1/50
2425/2425 - 99s - loss: 3.1104 - accuracy100: 0.4526 - val_loss: 3.7383 - val_accuracy100: 0.3884 - 99s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 96s - loss: 3.0169 - accuracy100: 0.4808 - val_loss: 3.6159 - val_accuracy100: 0.3976 - 96s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 96s - loss: 2.9756 - accuracy100: 0.4939 - val_loss: 3.3168 - val_accuracy100: 0.4100 - 96s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 96s - loss: 2.9454 - accuracy100: 0.5045 - val_loss: 3.4612 - val_accuracy100: 0.3728 - 96s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 96s - loss: 2.9229 - accuracy100: 0.5106 - val_loss: 3.4452 - val_accuracy100: 0.3869 - 96s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 97s - loss: 2.9035 - accuracy100: 0.5161 - val_loss: 3.5566 - val_accuracy100: 0.3866 - 97s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 97s - loss: 2.8865 - accuracy100: 0.5200 - val_loss: 3.3686 - val_accuracy100: 0.4074 - 97s/epoch - 40ms/step
Epoch 8/50
2425/2425 - 96s - loss: 2.8742 - accuracy100: 0.5237 - val_loss: 3.4989 - val_accuracy100: 0.4193 - 96s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 96s - loss: 2.8631 - accuracy100: 0.5265 - val_loss: 3.3674 - val_accuracy100: 0.4091 - 96s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 97s - loss: 2.8537 - accuracy100: 0.5286 - val_loss: 3.2233 - val_accuracy100: 0.4438 - 97s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 97s - loss: 2.8449 - accuracy100: 0.5305 - val_loss: 3.1627 - val_accuracy100: 0.4599 - 97s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 97s - loss: 2.8367 - accuracy100: 0.5325 - val_loss: 3.2486 - val_accuracy100: 0.4446 - 97s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 97s - loss: 2.8298 - accuracy100: 0.5345 - val_loss: 3.2570 - val_accuracy100: 0.4463 - 97s/epoch - 40ms/step
Epoch 14/50
2425/2425 - 97s - loss: 2.8237 - accuracy100: 0.5352 - val_loss: 3.2936 - val_accuracy100: 0.4396 - 97s/epoch - 40ms/step
Epoch 15/50
2425/2425 - 97s - loss: 2.8158 - accuracy100: 0.5370 - val_loss: 3.2831 - val_accuracy100: 0.4505 - 97s/epoch - 40ms/step
Epoch 16/50
2425/2425 - 97s - loss: 2.8084 - accuracy100: 0.5386 - val_loss: 3.2595 - val_accuracy100: 0.4465 - 97s/epoch - 40ms/step
Epoch 17/50
2425/2425 - 97s - loss: 2.8007 - accuracy100: 0.5403 - val_loss: 3.3010 - val_accuracy100: 0.4538 - 97s/epoch - 40ms/step
Epoch 18/50
2425/2425 - 97s - loss: 2.7933 - accuracy100: 0.5420 - val_loss: 3.3325 - val_accuracy100: 0.4490 - 97s/epoch - 40ms/step
Epoch 19/50
2425/2425 - 97s - loss: 2.7847 - accuracy100: 0.5441 - val_loss: 3.4427 - val_accuracy100: 0.4344 - 97s/epoch - 40ms/step
Epoch 20/50
2425/2425 - 97s - loss: 2.7778 - accuracy100: 0.5452 - val_loss: 3.4690 - val_accuracy100: 0.4401 - 97s/epoch - 40ms/step
Epoch 21/50
2425/2425 - 97s - loss: 2.7691 - accuracy100: 0.5473 - val_loss: 3.4236 - val_accuracy100: 0.4404 - 97s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h100
Evaluating performance on  test set...
4457/4457 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2732785
{'0': {'precision': 0.3838488604957296, 'recall': 0.6254005524510887, 'f1-score': 0.47571846231908566, 'support': 393519}, '1': {'precision': 0.4146879460230959, 'recall': 0.13638521568899392, 'f1-score': 0.20526241846462617, 'support': 374938}, '2': {'precision': 0.3972047140569097, 'recall': 0.4014582472040419, 'f1-score': 0.3993201538599159, 'support': 372502}, 'accuracy': 0.391589005389326, 'macro avg': {'precision': 0.3985805068585784, 'recall': 0.38774800511470814, 'f1-score': 0.3601003448812093, 'support': 1140959}, 'weighted avg': {'precision': 0.3983435331462862, 'recall': 0.391589005389326, 'f1-score': 0.36189949873813226, 'support': 1140959}}
[[246107  37504 109908]
 [206763  51136 117039]
 [188286  34672 149544]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1577466
{'0': {'precision': 0.35744470854272925, 'recall': 0.6093596085342932, 'f1-score': 0.45058211640753265, 'support': 187807}, '1': {'precision': 0.5220324779621502, 'recall': 0.3969203749463925, 'f1-score': 0.45095964658276727, 'support': 244835}, '2': {'precision': 0.4540218331832921, 'recall': 0.2761689571758952, 'f1-score': 0.3434355455062345, 'support': 188095}, 'accuracy': 0.4246049454116639, 'macro avg': {'precision': 0.4444996732293905, 'recall': 0.4274829802188603, 'f1-score': 0.4149924361655115, 'support': 620737}, 'weighted avg': {'precision': 0.4516271413364416, 'recall': 0.4246049454116639, 'f1-score': 0.41826359559561693, 'support': 620737}}
[[114442  47000  26365]
 [111553  97180  36102]
 [ 94172  41977  51946]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0344461
{'0': {'precision': 0.46723417507980586, 'recall': 0.2839813865446802, 'f1-score': 0.3532562839707239, 'support': 63395}, '1': {'precision': 0.47762180016515277, 'recall': 0.6086258829100188, 'f1-score': 0.5352241378313196, 'support': 76027}, '2': {'precision': 0.4323137469420006, 'recall': 0.46037216828478966, 'f1-score': 0.44590199904396954, 'support': 61800}, 'accuracy': 0.46081442387015337, 'macro avg': {'precision': 0.45905657406231976, 'recall': 0.45099314591316286, 'f1-score': 0.4447941402820043, 'support': 201222}, 'weighted avg': {'precision': 0.4604340116456252, 'recall': 0.46081442387015337, 'f1-score': 0.45046223171493716, 'support': 201222}}
[[18003 28130 17262]
 [ 9657 46272 20098]
 [10871 22478 28451]]
training model: results/AAL/W4/deepLOB_L2/h200
Epoch 1/50
2425/2425 - 99s - loss: 3.2329 - accuracy200: 0.4086 - val_loss: 3.3847 - val_accuracy200: 0.3306 - 99s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 97s - loss: 3.1708 - accuracy200: 0.4325 - val_loss: 3.4287 - val_accuracy200: 0.3480 - 97s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 96s - loss: 3.1353 - accuracy200: 0.4442 - val_loss: 3.2972 - val_accuracy200: 0.3792 - 96s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 97s - loss: 3.1187 - accuracy200: 0.4498 - val_loss: 3.3933 - val_accuracy200: 0.3732 - 97s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 96s - loss: 3.1048 - accuracy200: 0.4551 - val_loss: 3.4125 - val_accuracy200: 0.3759 - 96s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 97s - loss: 3.0945 - accuracy200: 0.4583 - val_loss: 3.4077 - val_accuracy200: 0.3835 - 97s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 97s - loss: 3.0873 - accuracy200: 0.4617 - val_loss: 3.3236 - val_accuracy200: 0.3591 - 97s/epoch - 40ms/step
Epoch 8/50
2425/2425 - 96s - loss: 3.0780 - accuracy200: 0.4646 - val_loss: 3.3382 - val_accuracy200: 0.3599 - 96s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 96s - loss: 3.0705 - accuracy200: 0.4667 - val_loss: 3.4005 - val_accuracy200: 0.3556 - 96s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 97s - loss: 3.0632 - accuracy200: 0.4692 - val_loss: 3.3941 - val_accuracy200: 0.3519 - 97s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 97s - loss: 3.0562 - accuracy200: 0.4715 - val_loss: 3.4205 - val_accuracy200: 0.3604 - 97s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 97s - loss: 3.0464 - accuracy200: 0.4757 - val_loss: 3.4544 - val_accuracy200: 0.3579 - 97s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 98s - loss: 3.0377 - accuracy200: 0.4789 - val_loss: 3.4540 - val_accuracy200: 0.3688 - 98s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h200
Evaluating performance on  test set...
4457/4457 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935825
{'0': {'precision': 0.3871955354893716, 'recall': 0.3786083084647814, 'f1-score': 0.38285377618324556, 'support': 422220}, '1': {'precision': 0.34123232719928187, 'recall': 0.15010782145137855, 'f1-score': 0.20849768285915682, 'support': 324147}, '2': {'precision': 0.3673611597390997, 'recall': 0.5451048171275646, 'f1-score': 0.438921215423277, 'support': 394592}, 'accuracy': 0.37127276264966574, 'macro avg': {'precision': 0.3652630074759177, 'recall': 0.3579403156812415, 'f1-score': 0.3434242248218931, 'support': 1140959}, 'weighted avg': {'precision': 0.367277797802339, 'recall': 0.37127276264966574, 'f1-score': 0.35270962411632567, 'support': 1140959}}
[[159856  43659 218705]
 [123778  48657 151712]
 [129222  50276 215094]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1106853
{'0': {'precision': 0.3498115608633939, 'recall': 0.48510617667022204, 'f1-score': 0.40649693069588505, 'support': 206260}, '1': {'precision': 0.39750014596267247, 'recall': 0.3990066225165563, 'f1-score': 0.39825195959911086, 'support': 204756}, '2': {'precision': 0.38723862167204715, 'recall': 0.23850735024151135, 'f1-score': 0.2951972899920919, 'support': 209721}, 'accuracy': 0.3733900186391338, 'macro avg': {'precision': 0.3781834428327045, 'recall': 0.37420671647609655, 'f1-score': 0.3666487267623626, 'support': 620737}, 'weighted avg': {'precision': 0.3781871282138812, 'recall': 0.3733900186391338, 'f1-score': 0.36617376766559795, 'support': 620737}}
[[100058  59913  46289]
 [ 90195  81699  32862]
 [ 95781  63920  50020]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099062
{'0': {'precision': 0.4554526951611844, 'recall': 0.10027464585140214, 'f1-score': 0.1643624646076933, 'support': 69180}, '1': {'precision': 0.3776154135376548, 'recall': 0.5771889221975428, 'f1-score': 0.4565447084551687, 'support': 64381}, '2': {'precision': 0.3720085860431129, 'recall': 0.4815477158185661, 'f1-score': 0.41974942832297335, 'support': 67661}, 'accuracy': 0.3810666825695003, 'macro avg': {'precision': 0.40169223158065065, 'recall': 0.3863370946225037, 'f1-score': 0.3468855337952785, 'support': 201222}, 'weighted avg': {'precision': 0.402490524547423, 'recall': 0.3810666825695003, 'f1-score': 0.3437202008049475, 'support': 201222}}
[[ 6937 30331 31912]
 [ 4131 37160 23090]
 [ 4163 30916 32582]]
training model: results/AAL/W4/deepLOB_L2/h300
Epoch 1/50
2425/2425 - 98s - loss: 3.2493 - accuracy300: 0.3958 - val_loss: 3.3357 - val_accuracy300: 0.3399 - 98s/epoch - 40ms/step
Epoch 2/50
2425/2425 - 96s - loss: 3.2058 - accuracy300: 0.4169 - val_loss: 3.4068 - val_accuracy300: 0.3452 - 96s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 96s - loss: 3.1860 - accuracy300: 0.4263 - val_loss: 3.4026 - val_accuracy300: 0.3553 - 96s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 96s - loss: 3.1729 - accuracy300: 0.4331 - val_loss: 3.4443 - val_accuracy300: 0.3427 - 96s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 96s - loss: 3.1596 - accuracy300: 0.4375 - val_loss: 3.3976 - val_accuracy300: 0.3443 - 96s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 96s - loss: 3.1473 - accuracy300: 0.4428 - val_loss: 3.5769 - val_accuracy300: 0.3450 - 96s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 96s - loss: 3.1384 - accuracy300: 0.4473 - val_loss: 3.5816 - val_accuracy300: 0.3470 - 96s/epoch - 40ms/step
Epoch 8/50
2425/2425 - 96s - loss: 3.1315 - accuracy300: 0.4504 - val_loss: 3.6212 - val_accuracy300: 0.3475 - 96s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 97s - loss: 3.1229 - accuracy300: 0.4524 - val_loss: 3.5732 - val_accuracy300: 0.3506 - 97s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 97s - loss: 3.1120 - accuracy300: 0.4567 - val_loss: 3.6610 - val_accuracy300: 0.3480 - 97s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 97s - loss: 3.1103 - accuracy300: 0.4574 - val_loss: 3.6357 - val_accuracy300: 0.3468 - 97s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h300
Evaluating performance on  test set...
4457/4457 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262008
{'0': {'precision': 0.3404882317746549, 'recall': 0.29225057933504855, 'f1-score': 0.3145306759937526, 'support': 391397}, '1': {'precision': 0.3196378592395385, 'recall': 0.3918264453300698, 'f1-score': 0.3520698519218207, 'support': 382404}, '2': {'precision': 0.3164844577152306, 'recall': 0.2898370728678117, 'f1-score': 0.3025751988194518, 'support': 367158}, 'accuracy': 0.32484778155919714, 'macro avg': {'precision': 0.3255368495764747, 'recall': 0.32463803251097667, 'f1-score': 0.3230585755783417, 'support': 1140959}, 'weighted avg': {'precision': 0.32577565793542956, 'recall': 0.32484778155919714, 'f1-score': 0.32326506692562224, 'support': 1140959}}
[[114386 163996 113015]
 [115755 149836 116813]
 [105806 154936 106416]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1245275
{'0': {'precision': 0.3560761762055664, 'recall': 0.17088576842719014, 'f1-score': 0.2309402096650809, 'support': 205810}, '1': {'precision': 0.3350249584026622, 'recall': 0.5888029476700832, 'f1-score': 0.42705720784970813, 'support': 205179}, '2': {'precision': 0.3428665270255196, 'recall': 0.26377843888857105, 'f1-score': 0.2981671400162753, 'support': 209748}, 'accuracy': 0.3404130896015543, 'macro avg': {'precision': 0.34465588721124946, 'recall': 0.34115571832861485, 'f1-score': 0.31872151917702146, 'support': 620737}, 'weighted avg': {'precision': 0.34465432554449976, 'recall': 0.3404130896015543, 'f1-score': 0.3184809938584284, 'support': 620737}}
[[ 35170 119098  51542]
 [ 29872 120810  54497]
 [ 33729 120692  55327]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117562
{'0': {'precision': 0.36987747235097057, 'recall': 0.11749956265671467, 'f1-score': 0.17834423091816298, 'support': 68596}, '1': {'precision': 0.33286671217187086, 'recall': 0.43334588447925293, 'f1-score': 0.3765180067001675, 'support': 66395}, '2': {'precision': 0.3401724842462955, 'recall': 0.477631320680648, 'f1-score': 0.3973496624273826, 'support': 66231}, 'accuracy': 0.34025106598682053, 'macro avg': {'precision': 0.3476388895897123, 'recall': 0.3428255892722052, 'f1-score': 0.3174039666819044, 'support': 201222}, 'weighted avg': {'precision': 0.3478882242108464, 'recall': 0.34025106598682053, 'f1-score': 0.3158177505995762, 'support': 201222}}
[[ 8060 30024 30512]
 [ 6775 28772 30848]
 [ 6956 27641 31634]]
training model: results/AAL/W4/deepLOB_L2/h500
Epoch 1/50
2425/2425 - 98s - loss: 3.2561 - accuracy500: 0.3935 - val_loss: 4.0109 - val_accuracy500: 0.3135 - 98s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 97s - loss: 3.2211 - accuracy500: 0.4134 - val_loss: 4.0477 - val_accuracy500: 0.3105 - 97s/epoch - 40ms/step
Epoch 3/50
2425/2425 - 97s - loss: 3.2000 - accuracy500: 0.4240 - val_loss: 3.9633 - val_accuracy500: 0.3106 - 97s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 97s - loss: 3.1876 - accuracy500: 0.4315 - val_loss: 3.9628 - val_accuracy500: 0.3106 - 97s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 97s - loss: 3.1783 - accuracy500: 0.4346 - val_loss: 3.7475 - val_accuracy500: 0.3110 - 97s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 97s - loss: 3.1623 - accuracy500: 0.4414 - val_loss: 3.9775 - val_accuracy500: 0.3117 - 97s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 97s - loss: 3.1491 - accuracy500: 0.4467 - val_loss: 3.8534 - val_accuracy500: 0.3120 - 97s/epoch - 40ms/step
Epoch 8/50
2425/2425 - 97s - loss: 3.1392 - accuracy500: 0.4512 - val_loss: 3.8115 - val_accuracy500: 0.3147 - 97s/epoch - 40ms/step
Epoch 9/50
2425/2425 - 97s - loss: 3.1279 - accuracy500: 0.4544 - val_loss: 3.8046 - val_accuracy500: 0.3147 - 97s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 96s - loss: 3.1168 - accuracy500: 0.4585 - val_loss: 3.6773 - val_accuracy500: 0.3186 - 96s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 97s - loss: 3.1087 - accuracy500: 0.4604 - val_loss: 3.5945 - val_accuracy500: 0.3211 - 97s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 97s - loss: 3.0970 - accuracy500: 0.4633 - val_loss: 3.7353 - val_accuracy500: 0.3180 - 97s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 97s - loss: 3.0874 - accuracy500: 0.4674 - val_loss: 3.7694 - val_accuracy500: 0.3161 - 97s/epoch - 40ms/step
Epoch 14/50
2425/2425 - 97s - loss: 3.0805 - accuracy500: 0.4686 - val_loss: 3.6867 - val_accuracy500: 0.3210 - 97s/epoch - 40ms/step
Epoch 15/50
2425/2425 - 97s - loss: 3.0714 - accuracy500: 0.4726 - val_loss: 3.7107 - val_accuracy500: 0.3200 - 97s/epoch - 40ms/step
Epoch 16/50
2425/2425 - 97s - loss: 3.0656 - accuracy500: 0.4746 - val_loss: 3.7442 - val_accuracy500: 0.3181 - 97s/epoch - 40ms/step
Epoch 17/50
2425/2425 - 97s - loss: 3.0518 - accuracy500: 0.4791 - val_loss: 3.8194 - val_accuracy500: 0.3181 - 97s/epoch - 40ms/step
Epoch 18/50
2425/2425 - 97s - loss: 3.0436 - accuracy500: 0.4817 - val_loss: 3.7181 - val_accuracy500: 0.3174 - 97s/epoch - 40ms/step
Epoch 19/50
2425/2425 - 98s - loss: 3.0315 - accuracy500: 0.4853 - val_loss: 3.8401 - val_accuracy500: 0.3171 - 98s/epoch - 40ms/step
Epoch 20/50
2425/2425 - 97s - loss: 3.0218 - accuracy500: 0.4881 - val_loss: 3.8561 - val_accuracy500: 0.3185 - 97s/epoch - 40ms/step
Epoch 21/50
2425/2425 - 98s - loss: 3.0107 - accuracy500: 0.4913 - val_loss: 4.1696 - val_accuracy500: 0.3189 - 98s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h500
Evaluating performance on  test set...
4457/4457 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2278266
{'0': {'precision': 0.37345745236877, 'recall': 0.16620064541087404, 'f1-score': 0.2300303465196388, 'support': 408422}, '1': {'precision': 0.3112752961206527, 'recall': 0.8322283682562689, 'f1-score': 0.4530849175898905, 'support': 353254}, '2': {'precision': 0.3722429589412962, 'recall': 0.01446149708792643, 'f1-score': 0.027841367653254418, 'support': 379283}, 'accuracy': 0.32196862463944803, 'macro avg': {'precision': 0.3523252358102396, 'recall': 0.3376301702516898, 'f1-score': 0.23698554392092788, 'support': 1140959}, 'weighted avg': {'precision': 0.3538014155314033, 'recall': 0.32196862463944803, 'f1-score': 0.23187798256744757, 'support': 1140959}}
[[ 67880 335545   4997]
 [ 55013 293988   4253]
 [ 58868 314930   5485]]
Evaluating performance on  train set...
2425/2425 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2431684
{'0': {'precision': 0.35099895137700754, 'recall': 0.12317935308928918, 'f1-score': 0.18236103743422846, 'support': 206520}, '1': {'precision': 0.332768785910098, 'recall': 0.8667155712050079, 'f1-score': 0.480899791061786, 'support': 204480}, '2': {'precision': 0.3249155028378292, 'recall': 0.02429232801079447, 'f1-score': 0.045204908214960655, 'support': 209737}, 'accuracy': 0.3346989143550328, 'macro avg': {'precision': 0.3362277467083116, 'recall': 0.33806241743503046, 'f1-score': 0.23615524557032505, 'support': 620737}, 'weighted avg': {'precision': 0.3361804880327324, 'recall': 0.3346989143550328, 'f1-score': 0.23436130367854996, 'support': 620737}}
[[ 25439 175653   5428]
 [ 22096 177226   5158]
 [ 24941 179701   5095]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.201654
{'0': {'precision': 0.39389272081966115, 'recall': 0.08228414750153881, 'f1-score': 0.13613062244697224, 'support': 71484}, '1': {'precision': 0.31394933607291386, 'recall': 0.9143652596883101, 'f1-score': 0.4674117969417759, 'support': 62498}, '2': {'precision': 0.36685419596812, 'recall': 0.023274836406900656, 'f1-score': 0.04377255055519817, 'support': 67240}, 'accuracy': 0.3210036675910189, 'macro avg': {'precision': 0.3582320842868983, 'recall': 0.3399747478655832, 'f1-score': 0.21577165664798212, 'support': 201222}, 'weighted avg': {'precision': 0.3600277752822953, 'recall': 0.3210036675910189, 'f1-score': 0.208161782506873, 'support': 201222}}
[[ 5882 64167  1435]
 [ 4086 57146  1266]
 [ 4965 60710  1565]]
training model: results/AAL/W4/deepLOB_L2/h1000
Epoch 1/50
2425/2425 - 100s - loss: 3.1916 - accuracy1000: 0.4365 - val_loss: 3.4759 - val_accuracy1000: 0.3492 - 100s/epoch - 41ms/step
Epoch 2/50
2425/2425 - 99s - loss: 3.1717 - accuracy1000: 0.4444 - val_loss: 3.5090 - val_accuracy1000: 0.3497 - 99s/epoch - 41ms/step
Epoch 3/50
2425/2425 - 98s - loss: 3.1309 - accuracy1000: 0.4663 - val_loss: 3.5581 - val_accuracy1000: 0.3485 - 98s/epoch - 40ms/step
Epoch 4/50
2425/2425 - 98s - loss: 3.1213 - accuracy1000: 0.4657 - val_loss: 3.4308 - val_accuracy1000: 0.3368 - 98s/epoch - 40ms/step
Epoch 5/50
2425/2425 - 97s - loss: 3.1159 - accuracy1000: 0.4680 - val_loss: 3.4756 - val_accuracy1000: 0.3474 - 97s/epoch - 40ms/step
Epoch 6/50
2425/2425 - 97s - loss: 3.0984 - accuracy1000: 0.4759 - val_loss: 3.5723 - val_accuracy1000: 0.3424 - 97s/epoch - 40ms/step
Epoch 7/50
2425/2425 - 99s - loss: 3.0963 - accuracy1000: 0.4769 - val_loss: 3.4477 - val_accuracy1000: 0.3494 - 99s/epoch - 41ms/step
Epoch 8/50
2425/2425 - 98s - loss: 3.0906 - accuracy1000: 0.4763 - val_loss: 3.5396 - val_accuracy1000: 0.3527 - 98s/epoch - 41ms/step
Epoch 9/50
2425/2425 - 98s - loss: 3.0781 - accuracy1000: 0.4819 - val_loss: 3.6333 - val_accuracy1000: 0.3487 - 98s/epoch - 40ms/step
Epoch 10/50
2425/2425 - 98s - loss: 3.0716 - accuracy1000: 0.4856 - val_loss: 3.6763 - val_accuracy1000: 0.3505 - 98s/epoch - 40ms/step
Epoch 11/50
2425/2425 - 98s - loss: 3.0668 - accuracy1000: 0.4863 - val_loss: 3.6223 - val_accuracy1000: 0.3474 - 98s/epoch - 40ms/step
Epoch 12/50
2425/2425 - 98s - loss: 3.0546 - accuracy1000: 0.4902 - val_loss: 3.6780 - val_accuracy1000: 0.3490 - 98s/epoch - 40ms/step
Epoch 13/50
2425/2425 - 99s - loss: 3.0445 - accuracy1000: 0.4935 - val_loss: 3.6316 - val_accuracy1000: 0.3502 - 99s/epoch - 41ms/step
Epoch 14/50
2425/2425 - 98s - loss: 3.0311 - accuracy1000: 0.4967 - val_loss: 3.5900 - val_accuracy1000: 0.3505 - 98s/epoch - 40ms/step
testing model: results/AAL/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1186367
{'0': {'precision': 0.4166860330002324, 'recall': 0.005061154440012759, 'f1-score': 0.010000836656719749, 'support': 354267}, '1': {'precision': 0.41197586655625223, 'recall': 0.9257808346200144, 'f1-score': 0.5702073646850626, 'support': 470202}, '2': {'precision': 0.3104297084879609, 'recall': 0.07849853075926569, 'f1-score': 0.1253098827048252, 'support': 316490}, 'accuracy': 0.4048708148145551, 'macro avg': {'precision': 0.3796972026814818, 'recall': 0.33644683993976426, 'f1-score': 0.23517269468220256, 'support': 1140959}, 'weighted avg': {'precision': 0.38527053618818113, 'recall': 0.4048708148145551, 'f1-score': 0.27285374361985143, 'support': 1140959}}
[[  1793 330570  21904]
 [  1615 435304  33283]
 [   895 290751  24844]]
Evaluating performance on  train set...
2425/2425 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1758684
{'0': {'precision': 0.3641634846556357, 'recall': 0.01262230152349954, 'f1-score': 0.024398910339926565, 'support': 204004}, '1': {'precision': 0.33017431989229357, 'recall': 0.9166829325421612, 'f1-score': 0.4854848672019765, 'support': 204928}, '2': {'precision': 0.3208981928788692, 'recall': 0.06774155473194683, 'f1-score': 0.11186782942261136, 'support': 211805}, 'accuracy': 0.3298933364693904, 'macro avg': {'precision': 0.3384119991422662, 'recall': 0.33234892959920254, 'f1-score': 0.20725053565483811, 'support': 620737}, 'weighted avg': {'precision': 0.338179635325887, 'recall': 0.3298933364693904, 'f1-score': 0.20646599732545218, 'support': 620737}}
[[  2575 185893  15536]
 [  2246 187854  14828]
 [  2250 195207  14348]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1412848
{'0': {'precision': 0.437125748502994, 'recall': 0.0010747147589252853, 'f1-score': 0.0021441579040122186, 'support': 67925}, '1': {'precision': 0.34020284554854513, 'recall': 0.8804911672327785, 'f1-score': 0.49077917551253203, 'support': 70363}, '2': {'precision': 0.3062915655019529, 'recall': 0.09220770966409254, 'f1-score': 0.14174401563263314, 'support': 62934}, 'accuracy': 0.33709037779169276, 'macro avg': {'precision': 0.361206719851164, 'recall': 0.3245911972185988, 'f1-score': 0.21155578301639247, 'support': 201222}, 'weighted avg': {'precision': 0.36231432284590187, 'recall': 0.33709037779169276, 'f1-score': 0.21667041840376525, 'support': 201222}}
[[   73 63089  4763]
 [   29 61954  8380]
 [   65 57066  5803]]
training model: results/AAL/W4/deepOF_L2/h10
Epoch 1/50
2425/2425 - 57s - loss: 2.6091 - accuracy10: 0.5431 - val_loss: 2.9919 - val_accuracy10: 0.7361 - 57s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 54s - loss: 2.2591 - accuracy10: 0.6211 - val_loss: 2.7945 - val_accuracy10: 0.7323 - 54s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 54s - loss: 2.1925 - accuracy10: 0.6306 - val_loss: 2.7757 - val_accuracy10: 0.7321 - 54s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 55s - loss: 2.1601 - accuracy10: 0.6360 - val_loss: 2.7303 - val_accuracy10: 0.7231 - 55s/epoch - 23ms/step
Epoch 5/50
2425/2425 - 54s - loss: 2.1379 - accuracy10: 0.6395 - val_loss: 2.7462 - val_accuracy10: 0.7269 - 54s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 54s - loss: 2.1229 - accuracy10: 0.6414 - val_loss: 2.7636 - val_accuracy10: 0.7257 - 54s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 54s - loss: 2.1090 - accuracy10: 0.6430 - val_loss: 2.7109 - val_accuracy10: 0.7188 - 54s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 54s - loss: 2.0973 - accuracy10: 0.6452 - val_loss: 2.7464 - val_accuracy10: 0.7255 - 54s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 54s - loss: 2.0869 - accuracy10: 0.6461 - val_loss: 2.7689 - val_accuracy10: 0.7208 - 54s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 54s - loss: 2.0790 - accuracy10: 0.6477 - val_loss: 2.7377 - val_accuracy10: 0.7212 - 54s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 54s - loss: 2.0702 - accuracy10: 0.6494 - val_loss: 2.7077 - val_accuracy10: 0.7178 - 54s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 54s - loss: 2.0628 - accuracy10: 0.6493 - val_loss: 2.6914 - val_accuracy10: 0.7162 - 54s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 54s - loss: 2.0544 - accuracy10: 0.6510 - val_loss: 2.6910 - val_accuracy10: 0.7160 - 54s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 55s - loss: 2.0492 - accuracy10: 0.6521 - val_loss: 2.7359 - val_accuracy10: 0.7136 - 55s/epoch - 23ms/step
Epoch 15/50
2425/2425 - 54s - loss: 2.0414 - accuracy10: 0.6526 - val_loss: 2.7183 - val_accuracy10: 0.7158 - 54s/epoch - 22ms/step
Epoch 16/50
2425/2425 - 55s - loss: 2.0359 - accuracy10: 0.6534 - val_loss: 2.6982 - val_accuracy10: 0.7098 - 55s/epoch - 22ms/step
Epoch 17/50
2425/2425 - 54s - loss: 2.0296 - accuracy10: 0.6537 - val_loss: 2.6972 - val_accuracy10: 0.7151 - 54s/epoch - 22ms/step
Epoch 18/50
2425/2425 - 54s - loss: 2.0236 - accuracy10: 0.6549 - val_loss: 2.7289 - val_accuracy10: 0.7182 - 54s/epoch - 22ms/step
Epoch 19/50
2425/2425 - 54s - loss: 2.0184 - accuracy10: 0.6554 - val_loss: 2.6991 - val_accuracy10: 0.7113 - 54s/epoch - 22ms/step
Epoch 20/50
2425/2425 - 54s - loss: 2.0141 - accuracy10: 0.6565 - val_loss: 2.7153 - val_accuracy10: 0.7084 - 54s/epoch - 22ms/step
Epoch 21/50
2425/2425 - 54s - loss: 2.0092 - accuracy10: 0.6564 - val_loss: 2.7353 - val_accuracy10: 0.7013 - 54s/epoch - 22ms/step
Epoch 22/50
2425/2425 - 54s - loss: 2.0048 - accuracy10: 0.6571 - val_loss: 2.7079 - val_accuracy10: 0.7076 - 54s/epoch - 22ms/step
Epoch 23/50
2425/2425 - 54s - loss: 2.0002 - accuracy10: 0.6572 - val_loss: 2.6913 - val_accuracy10: 0.7071 - 54s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h10
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8323276
{'0': {'precision': 0.44466534128561963, 'recall': 0.5025341809631629, 'f1-score': 0.4718320223708525, 'support': 172245}, '1': {'precision': 0.8644931300775436, 'recall': 0.6781927195717454, 'f1-score': 0.7600937638361908, 'support': 799898}, '2': {'precision': 0.3490695660902954, 'recall': 0.6591652252209559, 'f1-score': 0.4564304289687195, 'support': 168812}, 'accuracy': 0.6488590698143222, 'macro avg': {'precision': 0.5527426791511528, 'recall': 0.6132973752519547, 'f1-score': 0.5627854050585875, 'support': 1140955}, 'weighted avg': {'precision': 0.7248531616613657, 'recall': 0.6488590698143222, 'f1-score': 0.6716471042007583, 'support': 1140955}}
[[ 86559  45970  39716]
 [ 89628 542485 167785]
 [ 18474  39063 111275]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6505264
{'0': {'precision': 0.44974435241372573, 'recall': 0.5193877167249614, 'f1-score': 0.4820636933781693, 'support': 79767}, '1': {'precision': 0.8884260268993094, 'recall': 0.7896342054420098, 'f1-score': 0.8361220489276758, 'support': 464277}, '2': {'precision': 0.3952916828353383, 'recall': 0.5977311253096883, 'f1-score': 0.47587656692014224, 'support': 76690}, 'accuracy': 0.7311972600179787, 'macro avg': {'precision': 0.5778206873827911, 'recall': 0.6355843491588865, 'f1-score': 0.5980207697419958, 'support': 620734}, 'weighted avg': {'precision': 0.7711281280006548, 'recall': 0.7311972600179787, 'f1-score': 0.7461166700338578, 'support': 620734}}
[[ 41430  24780  13557]
 [ 41100 366609  56568]
 [  9589  21261  45840]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6787273
{'0': {'precision': 0.46130134691415936, 'recall': 0.5091904286401124, 'f1-score': 0.4840643403357651, 'support': 27039}, '1': {'precision': 0.8814076688272245, 'recall': 0.7734737665982943, 'f1-score': 0.8239209104924407, 'support': 148208}, '2': {'precision': 0.3790933514049907, 'recall': 0.6030028873917228, 'f1-score': 0.46552339059620756, 'support': 25975}, 'accuracy': 0.715955511822763, 'macro avg': {'precision': 0.5739341223821248, 'recall': 0.6285556942100432, 'f1-score': 0.5911695471414711, 'support': 201222}, 'weighted avg': {'precision': 0.76011442438452, 'recall': 0.715955511822763, 'f1-score': 0.7319888286138637, 'support': 201222}}
[[ 13768   8180   5091]
 [ 13010 114635  20563]
 [  3068   7244  15663]]
training model: results/AAL/W4/deepOF_L2/h20
Epoch 1/50
2425/2425 - 56s - loss: 2.6986 - accuracy20: 0.5401 - val_loss: 3.1483 - val_accuracy20: 0.6958 - 56s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 54s - loss: 2.3862 - accuracy20: 0.6116 - val_loss: 2.8973 - val_accuracy20: 0.6986 - 54s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 54s - loss: 2.3259 - accuracy20: 0.6213 - val_loss: 2.8817 - val_accuracy20: 0.6989 - 54s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 55s - loss: 2.2948 - accuracy20: 0.6262 - val_loss: 2.8573 - val_accuracy20: 0.6987 - 55s/epoch - 23ms/step
Epoch 5/50
2425/2425 - 54s - loss: 2.2748 - accuracy20: 0.6295 - val_loss: 2.8597 - val_accuracy20: 0.7008 - 54s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 54s - loss: 2.2601 - accuracy20: 0.6320 - val_loss: 2.8489 - val_accuracy20: 0.6980 - 54s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 54s - loss: 2.2485 - accuracy20: 0.6334 - val_loss: 2.8690 - val_accuracy20: 0.6990 - 54s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 54s - loss: 2.2381 - accuracy20: 0.6350 - val_loss: 2.8525 - val_accuracy20: 0.6962 - 54s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 54s - loss: 2.2290 - accuracy20: 0.6364 - val_loss: 2.8854 - val_accuracy20: 0.7011 - 54s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 54s - loss: 2.2202 - accuracy20: 0.6384 - val_loss: 2.9012 - val_accuracy20: 0.6996 - 54s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 54s - loss: 2.2139 - accuracy20: 0.6387 - val_loss: 2.8741 - val_accuracy20: 0.6951 - 54s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 54s - loss: 2.2056 - accuracy20: 0.6403 - val_loss: 2.8907 - val_accuracy20: 0.6967 - 54s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 54s - loss: 2.1994 - accuracy20: 0.6406 - val_loss: 2.9395 - val_accuracy20: 0.6964 - 54s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 54s - loss: 2.1937 - accuracy20: 0.6418 - val_loss: 2.8904 - val_accuracy20: 0.6906 - 54s/epoch - 22ms/step
Epoch 15/50
2425/2425 - 54s - loss: 2.1876 - accuracy20: 0.6434 - val_loss: 2.8723 - val_accuracy20: 0.6908 - 54s/epoch - 22ms/step
Epoch 16/50
2425/2425 - 53s - loss: 2.1823 - accuracy20: 0.6440 - val_loss: 2.8639 - val_accuracy20: 0.6885 - 53s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h20
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83177596
{'0': {'precision': 0.4791891109180423, 'recall': 0.541713956452655, 'f1-score': 0.5085368777135553, 'support': 229084}, '1': {'precision': 0.7812493651917238, 'recall': 0.7276445127506542, 'f1-score': 0.7534947579572575, 'support': 687102}, '2': {'precision': 0.46255107985604677, 'recall': 0.4980580062197189, 'f1-score': 0.479648323021817, 'support': 224769}, 'accuracy': 0.645084161952049, 'macro avg': {'precision': 0.5743298519886043, 'recall': 0.5891388251410093, 'f1-score': 0.5805599862308766, 'support': 1140955}, 'weighted avg': {'precision': 0.6578170946931969, 'recall': 0.645084161952049, 'f1-score': 0.6503635035504208, 'support': 1140955}}
[[124098  66797  38189]
 [ 95250 499966  91886]
 [ 39627  73194 111948]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70039666
{'0': {'precision': 0.48512654214750267, 'recall': 0.5104312604241125, 'f1-score': 0.4974573083228452, 'support': 104925}, '1': {'precision': 0.8152414086026124, 'recall': 0.8272830292845693, 'f1-score': 0.8212180793785093, 'support': 412982}, '2': {'precision': 0.5074736449909045, 'recall': 0.45035836891088915, 'f1-score': 0.47721312235612967, 'support': 102827}, 'accuracy': 0.7112853492800458, 'macro avg': {'precision': 0.6026138652470066, 'recall': 0.596024219539857, 'f1-score': 0.5986295033524947, 'support': 620734}, 'weighted avg': {'precision': 0.7084579261581136, 'recall': 0.7112853492800458, 'f1-score': 0.7095058216018195, 'support': 620734}}
[[ 53557  37152  14216]
 [ 40600 341653  30729]
 [ 16241  40277  46309]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7211916
{'0': {'precision': 0.4921162745587053, 'recall': 0.5018935111914989, 'f1-score': 0.49695680765625216, 'support': 35384}, '1': {'precision': 0.8042459042301006, 'recall': 0.8141035407398379, 'f1-score': 0.8091447002305482, 'support': 131272}, '2': {'precision': 0.4873814100576673, 'recall': 0.454782155875716, 'f1-score': 0.4705178090392098, 'support': 34566}, 'accuracy': 0.6974784069336355, 'macro avg': {'precision': 0.5945811962821577, 'recall': 0.5902597359356844, 'f1-score': 0.5922064389753366, 'support': 201222}, 'weighted avg': {'precision': 0.6949281709710285, 'recall': 0.6974784069336355, 'f1-score': 0.6960783679618664, 'support': 201222}}
[[ 17759  12409   5216]
 [ 13085 106869  11318]
 [  5243  13603  15720]]
training model: results/AAL/W4/deepOF_L2/h30
Epoch 1/50
2425/2425 - 57s - loss: 2.7805 - accuracy30: 0.5334 - val_loss: 3.2129 - val_accuracy30: 0.6522 - 57s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 55s - loss: 2.4993 - accuracy30: 0.5943 - val_loss: 3.0394 - val_accuracy30: 0.6646 - 55s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 54s - loss: 2.4401 - accuracy30: 0.6072 - val_loss: 3.0170 - val_accuracy30: 0.6669 - 54s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 54s - loss: 2.4124 - accuracy30: 0.6120 - val_loss: 3.0118 - val_accuracy30: 0.6699 - 54s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 53s - loss: 2.3938 - accuracy30: 0.6153 - val_loss: 3.0288 - val_accuracy30: 0.6674 - 53s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 54s - loss: 2.3817 - accuracy30: 0.6172 - val_loss: 2.9896 - val_accuracy30: 0.6682 - 54s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 54s - loss: 2.3700 - accuracy30: 0.6195 - val_loss: 3.0900 - val_accuracy30: 0.6688 - 54s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 53s - loss: 2.3629 - accuracy30: 0.6197 - val_loss: 2.9978 - val_accuracy30: 0.6693 - 53s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 53s - loss: 2.3548 - accuracy30: 0.6219 - val_loss: 2.9875 - val_accuracy30: 0.6663 - 53s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 54s - loss: 2.3447 - accuracy30: 0.6231 - val_loss: 2.9716 - val_accuracy30: 0.6657 - 54s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 54s - loss: 2.3389 - accuracy30: 0.6243 - val_loss: 2.9858 - val_accuracy30: 0.6646 - 54s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 54s - loss: 2.3327 - accuracy30: 0.6256 - val_loss: 2.9873 - val_accuracy30: 0.6675 - 54s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 54s - loss: 2.3252 - accuracy30: 0.6267 - val_loss: 2.9886 - val_accuracy30: 0.6631 - 54s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 55s - loss: 2.3193 - accuracy30: 0.6273 - val_loss: 2.9869 - val_accuracy30: 0.6646 - 55s/epoch - 23ms/step
Epoch 15/50
2425/2425 - 54s - loss: 2.3135 - accuracy30: 0.6282 - val_loss: 2.9729 - val_accuracy30: 0.6661 - 54s/epoch - 22ms/step
Epoch 16/50
2425/2425 - 54s - loss: 2.3075 - accuracy30: 0.6293 - val_loss: 2.9646 - val_accuracy30: 0.6636 - 54s/epoch - 22ms/step
Epoch 17/50
2425/2425 - 54s - loss: 2.3019 - accuracy30: 0.6298 - val_loss: 2.9844 - val_accuracy30: 0.6622 - 54s/epoch - 22ms/step
Epoch 18/50
2425/2425 - 54s - loss: 2.2974 - accuracy30: 0.6303 - val_loss: 3.0337 - val_accuracy30: 0.6661 - 54s/epoch - 22ms/step
Epoch 19/50
2425/2425 - 54s - loss: 2.2918 - accuracy30: 0.6307 - val_loss: 2.9666 - val_accuracy30: 0.6585 - 54s/epoch - 22ms/step
Epoch 20/50
2425/2425 - 54s - loss: 2.2872 - accuracy30: 0.6314 - val_loss: 3.0167 - val_accuracy30: 0.6590 - 54s/epoch - 22ms/step
Epoch 21/50
2425/2425 - 54s - loss: 2.2816 - accuracy30: 0.6326 - val_loss: 3.0341 - val_accuracy30: 0.6580 - 54s/epoch - 22ms/step
Epoch 22/50
2425/2425 - 54s - loss: 2.2755 - accuracy30: 0.6328 - val_loss: 3.0684 - val_accuracy30: 0.6632 - 54s/epoch - 22ms/step
Epoch 23/50
2425/2425 - 54s - loss: 2.2701 - accuracy30: 0.6339 - val_loss: 3.0769 - val_accuracy30: 0.6600 - 54s/epoch - 22ms/step
Epoch 24/50
2425/2425 - 53s - loss: 2.2673 - accuracy30: 0.6331 - val_loss: 3.0897 - val_accuracy30: 0.6609 - 53s/epoch - 22ms/step
Epoch 25/50
2425/2425 - 53s - loss: 2.2607 - accuracy30: 0.6344 - val_loss: 3.0823 - val_accuracy30: 0.6514 - 53s/epoch - 22ms/step
Epoch 26/50
2425/2425 - 54s - loss: 2.2554 - accuracy30: 0.6342 - val_loss: 3.0509 - val_accuracy30: 0.6550 - 54s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h30
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9215354
{'0': {'precision': 0.5240144747068705, 'recall': 0.46848475791990435, 'f1-score': 0.49469618969849743, 'support': 267680}, '1': {'precision': 0.723567871819461, 'recall': 0.7180191110297196, 'f1-score': 0.7207828126564451, 'support': 611584}, '2': {'precision': 0.46466630703620393, 'recall': 0.5233615217947886, 'f1-score': 0.4922704775734224, 'support': 261691}, 'accuracy': 0.6148288056934761, 'macro avg': {'precision': 0.5707495511875118, 'recall': 0.5699551302481375, 'f1-score': 0.5692498266427882, 'support': 1140955}, 'weighted avg': {'precision': 0.6173685364128993, 'recall': 0.6148288056934761, 'f1-score': 0.6153286197096639, 'support': 1140955}}
[[125404  83424  58852]
 [ 73519 439129  98936]
 [ 40391  84341 136959]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77419424
{'0': {'precision': 0.5258953322844084, 'recall': 0.4572943303418734, 'f1-score': 0.48920155072526894, 'support': 122794}, '1': {'precision': 0.7664009748939927, 'recall': 0.8187607769786467, 'f1-score': 0.7917161222696654, 'support': 376381}, '2': {'precision': 0.5137087330037635, 'recall': 0.4727334051777326, 'f1-score': 0.49237004224109127, 'support': 121559}, 'accuracy': 0.6794923429359436, 'macro avg': {'precision': 0.6020016800607216, 'recall': 0.5829295041660841, 'f1-score': 0.5910959050786752, 'support': 620734}, 'weighted avg': {'precision': 0.6693390029212385, 'recall': 0.6794923429359436, 'f1-score': 0.6732512332182907, 'support': 620734}}
[[ 56153  47090  19551]
 [ 33368 308166  34847]
 [ 17255  46839  57465]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8067016
{'0': {'precision': 0.528464323384361, 'recall': 0.4493515937462126, 'f1-score': 0.48570754840569075, 'support': 41255}, '1': {'precision': 0.7514358797313414, 'recall': 0.8026568327536353, 'f1-score': 0.776202266952501, 'support': 119315}, '2': {'precision': 0.49577464788732395, 'recall': 0.47190790121027254, 'f1-score': 0.48354695199566466, 'support': 40652}, 'accuracy': 0.6634016161254733, 'macro avg': {'precision': 0.5918916170010088, 'recall': 0.5746387759033734, 'f1-score': 0.5818189224512854, 'support': 201222}, 'weighted avg': {'precision': 0.6540716156150039, 'recall': 0.6634016161254733, 'f1-score': 0.6575204951915904, 'support': 201222}}
[[18538 15789  6928]
 [10963 95769 12583]
 [ 5578 15890 19184]]
training model: results/AAL/W4/deepOF_L2/h50
Epoch 1/50
2425/2425 - 56s - loss: 2.8990 - accuracy50: 0.5176 - val_loss: 3.4210 - val_accuracy50: 0.5723 - 56s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 54s - loss: 2.6799 - accuracy50: 0.5629 - val_loss: 3.2840 - val_accuracy50: 0.5914 - 54s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 55s - loss: 2.6273 - accuracy50: 0.5737 - val_loss: 3.3072 - val_accuracy50: 0.5971 - 55s/epoch - 23ms/step
Epoch 4/50
2425/2425 - 56s - loss: 2.6015 - accuracy50: 0.5780 - val_loss: 3.2574 - val_accuracy50: 0.6001 - 56s/epoch - 23ms/step
Epoch 5/50
2425/2425 - 55s - loss: 2.5849 - accuracy50: 0.5813 - val_loss: 3.2498 - val_accuracy50: 0.6010 - 55s/epoch - 23ms/step
Epoch 6/50
2425/2425 - 55s - loss: 2.5737 - accuracy50: 0.5837 - val_loss: 3.2562 - val_accuracy50: 0.6020 - 55s/epoch - 23ms/step
Epoch 7/50
2425/2425 - 54s - loss: 2.5636 - accuracy50: 0.5859 - val_loss: 3.2296 - val_accuracy50: 0.6024 - 54s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 55s - loss: 2.5546 - accuracy50: 0.5880 - val_loss: 3.2184 - val_accuracy50: 0.6028 - 55s/epoch - 23ms/step
Epoch 9/50
2425/2425 - 54s - loss: 2.5479 - accuracy50: 0.5889 - val_loss: 3.2422 - val_accuracy50: 0.6021 - 54s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 54s - loss: 2.5389 - accuracy50: 0.5908 - val_loss: 3.2405 - val_accuracy50: 0.6025 - 54s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 53s - loss: 2.5330 - accuracy50: 0.5925 - val_loss: 3.2358 - val_accuracy50: 0.6019 - 53s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 54s - loss: 2.5269 - accuracy50: 0.5932 - val_loss: 3.2195 - val_accuracy50: 0.6024 - 54s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 54s - loss: 2.5209 - accuracy50: 0.5945 - val_loss: 3.2183 - val_accuracy50: 0.6023 - 54s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 54s - loss: 2.5159 - accuracy50: 0.5952 - val_loss: 3.2178 - val_accuracy50: 0.6036 - 54s/epoch - 22ms/step
Epoch 15/50
2425/2425 - 53s - loss: 2.5087 - accuracy50: 0.5967 - val_loss: 3.2600 - val_accuracy50: 0.6020 - 53s/epoch - 22ms/step
Epoch 16/50
2425/2425 - 53s - loss: 2.5043 - accuracy50: 0.5975 - val_loss: 3.2603 - val_accuracy50: 0.6016 - 53s/epoch - 22ms/step
Epoch 17/50
2425/2425 - 53s - loss: 2.4986 - accuracy50: 0.5983 - val_loss: 3.2273 - val_accuracy50: 0.6025 - 53s/epoch - 22ms/step
Epoch 18/50
2425/2425 - 53s - loss: 2.4933 - accuracy50: 0.5987 - val_loss: 3.2653 - val_accuracy50: 0.6010 - 53s/epoch - 22ms/step
Epoch 19/50
2425/2425 - 53s - loss: 2.4878 - accuracy50: 0.5996 - val_loss: 3.2133 - val_accuracy50: 0.5992 - 53s/epoch - 22ms/step
Epoch 20/50
2425/2425 - 54s - loss: 2.4831 - accuracy50: 0.6008 - val_loss: 3.2484 - val_accuracy50: 0.6005 - 54s/epoch - 22ms/step
Epoch 21/50
2425/2425 - 53s - loss: 2.4754 - accuracy50: 0.6011 - val_loss: 3.2754 - val_accuracy50: 0.6019 - 53s/epoch - 22ms/step
Epoch 22/50
2425/2425 - 53s - loss: 2.4717 - accuracy50: 0.6018 - val_loss: 3.2493 - val_accuracy50: 0.6005 - 53s/epoch - 22ms/step
Epoch 23/50
2425/2425 - 53s - loss: 2.4652 - accuracy50: 0.6037 - val_loss: 3.2735 - val_accuracy50: 0.6011 - 53s/epoch - 22ms/step
Epoch 24/50
2425/2425 - 53s - loss: 2.4609 - accuracy50: 0.6037 - val_loss: 3.2312 - val_accuracy50: 0.6003 - 53s/epoch - 22ms/step
Epoch 25/50
2425/2425 - 53s - loss: 2.4544 - accuracy50: 0.6045 - val_loss: 3.2600 - val_accuracy50: 0.5977 - 53s/epoch - 22ms/step
Epoch 26/50
2425/2425 - 53s - loss: 2.4485 - accuracy50: 0.6058 - val_loss: 3.2968 - val_accuracy50: 0.5983 - 53s/epoch - 22ms/step
Epoch 27/50
2425/2425 - 53s - loss: 2.4434 - accuracy50: 0.6071 - val_loss: 3.3146 - val_accuracy50: 0.5940 - 53s/epoch - 22ms/step
Epoch 28/50
2425/2425 - 52s - loss: 2.4373 - accuracy50: 0.6072 - val_loss: 3.3424 - val_accuracy50: 0.5943 - 52s/epoch - 22ms/step
Epoch 29/50
2425/2425 - 52s - loss: 2.4312 - accuracy50: 0.6081 - val_loss: 3.2796 - val_accuracy50: 0.5955 - 52s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h50
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9851018
{'0': {'precision': 0.5558486888098506, 'recall': 0.33835296456438546, 'f1-score': 0.42065019897548384, 'support': 321936}, '1': {'precision': 0.6014280571608566, 'recall': 0.7344897226196574, 'f1-score': 0.6613322070649191, 'support': 509517}, '2': {'precision': 0.4708623553032744, 'recall': 0.4910081356501735, 'f1-score': 0.4807242750448401, 'support': 309502}, 'accuracy': 0.5566661261837671, 'macro avg': {'precision': 0.5427130337579938, 'recall': 0.5212836076114055, 'f1-score': 0.5209022270284144, 'support': 1140955}, 'weighted avg': {'precision': 0.5531492158517999, 'recall': 0.5566661261837671, 'f1-score': 0.5444277549766606, 'support': 1140955}}
[[108928 126275  86733]
 [ 51239 374235  84043]
 [ 35800 121734 151968]]
Evaluating performance on  train set...
2425/2425 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87394583
{'0': {'precision': 0.5449635705915321, 'recall': 0.35924925772170946, 'f1-score': 0.433034684070105, 'support': 148866}, '1': {'precision': 0.660215853196193, 'recall': 0.8301789252105003, 'f1-score': 0.7355061831326226, 'support': 323040}, '2': {'precision': 0.5328230109023429, 'recall': 0.41671594054882144, 'f1-score': 0.4676708455085305, 'support': 148828}, 'accuracy': 0.6181069508034037, 'macro avg': {'precision': 0.5793341448966893, 'recall': 0.5353813744936771, 'f1-score': 0.5454039042370861, 'support': 620734}, 'weighted avg': {'precision': 0.6020318835165321, 'recall': 0.6181069508034037, 'f1-score': 0.5987501494573944, 'support': 620734}}
[[ 53480  69073  26313]
 [ 26794 268181  28065]
 [ 17861  68948  62019]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9172429
{'0': {'precision': 0.5463930426077708, 'recall': 0.34947376845812156, 'f1-score': 0.4262911256467832, 'support': 49978}, '1': {'precision': 0.640120233649928, 'recall': 0.811319272613016, 'f1-score': 0.7156231866485369, 'support': 101844}, '2': {'precision': 0.5121471598546323, 'recall': 0.416497975708502, 'f1-score': 0.459396699935249, 'support': 49400}, 'accuracy': 0.599680949399171, 'macro avg': {'precision': 0.566220145370777, 'recall': 0.5257636722598799, 'f1-score': 0.5337703374101898, 'support': 201222}, 'weighted avg': {'precision': 0.585423593126563, 'recall': 0.599680949399171, 'f1-score': 0.5808574742096283, 'support': 201222}}
[[17466 23388  9124]
 [ 8741 82628 10475]
 [ 5759 23066 20575]]
training model: results/AAL/W4/deepOF_L2/h100
Epoch 1/50
2425/2425 - 56s - loss: 3.0654 - accuracy100: 0.4765 - val_loss: 3.5487 - val_accuracy100: 0.4439 - 56s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 54s - loss: 2.9350 - accuracy100: 0.5077 - val_loss: 3.4930 - val_accuracy100: 0.4605 - 54s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 53s - loss: 2.8935 - accuracy100: 0.5169 - val_loss: 3.4590 - val_accuracy100: 0.4712 - 53s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 53s - loss: 2.8763 - accuracy100: 0.5205 - val_loss: 3.4050 - val_accuracy100: 0.4743 - 53s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 52s - loss: 2.8650 - accuracy100: 0.5232 - val_loss: 3.4264 - val_accuracy100: 0.4746 - 52s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 52s - loss: 2.8570 - accuracy100: 0.5250 - val_loss: 3.4195 - val_accuracy100: 0.4790 - 52s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 53s - loss: 2.8496 - accuracy100: 0.5266 - val_loss: 3.4160 - val_accuracy100: 0.4810 - 53s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 53s - loss: 2.8435 - accuracy100: 0.5282 - val_loss: 3.4097 - val_accuracy100: 0.4842 - 53s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 52s - loss: 2.8387 - accuracy100: 0.5293 - val_loss: 3.4442 - val_accuracy100: 0.4833 - 52s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 52s - loss: 2.8335 - accuracy100: 0.5311 - val_loss: 3.4609 - val_accuracy100: 0.4846 - 52s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 52s - loss: 2.8284 - accuracy100: 0.5319 - val_loss: 3.4313 - val_accuracy100: 0.4861 - 52s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 52s - loss: 2.8236 - accuracy100: 0.5332 - val_loss: 3.4758 - val_accuracy100: 0.4817 - 52s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 53s - loss: 2.8230 - accuracy100: 0.5334 - val_loss: 3.4918 - val_accuracy100: 0.4864 - 53s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 53s - loss: 2.8153 - accuracy100: 0.5349 - val_loss: 3.4843 - val_accuracy100: 0.4884 - 53s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h100
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025906
{'0': {'precision': 0.5199769409543177, 'recall': 0.29110051154079747, 'f1-score': 0.37324562046590126, 'support': 393517}, '1': {'precision': 0.41756150477440435, 'recall': 0.8315748203703012, 'f1-score': 0.5559579468415553, 'support': 374938}, '2': {'precision': 0.5086139996895856, 'recall': 0.2375275167785235, 'f1-score': 0.32382548800371846, 'support': 372500}, 'accuracy': 0.4512193732443436, 'macro avg': {'precision': 0.4820508151394359, 'recall': 0.4534009495632074, 'f1-score': 0.41767635177039164, 'support': 1140955}, 'weighted avg': {'precision': 0.4826116334430337, 'recall': 0.4512193732443436, 'f1-score': 0.41715339499204107, 'support': 1140955}}
[[114553 217736  61228]
 [ 38895 311789  24254]
 [ 66856 217165  88479]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0540266
{'0': {'precision': 0.5222666378565255, 'recall': 0.25718085813848324, 'f1-score': 0.3446466446840745, 'support': 187965}, '1': {'precision': 0.4727655784317084, 'recall': 0.9025760090254331, 'f1-score': 0.6205103850228608, 'support': 244642}, '2': {'precision': 0.5696030629274518, 'recall': 0.18505052437980726, 'f1-score': 0.2793476298421232, 'support': 188127}, 'accuracy': 0.48968157052779454, 'macro avg': {'precision': 0.5215450930718952, 'recall': 0.44826913051457457, 'f1-score': 0.41483488651635286, 'support': 620734}, 'weighted avg': {'precision': 0.5171037524007781, 'recall': 0.48968157052779454, 'f1-score': 0.4335790205468267, 'support': 620734}}
[[ 48341 120749  18875]
 [ 16404 220808   7430]
 [ 27815 125499  34813]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0768601
{'0': {'precision': 0.5257453467303574, 'recall': 0.2517033625638761, 'f1-score': 0.34042598577203254, 'support': 63404}, '1': {'precision': 0.45181565634800136, 'recall': 0.8961390773762559, 'f1-score': 0.6007466798312697, 'support': 76044}, '2': {'precision': 0.5627245508982036, 'recall': 0.18255253019069512, 'f1-score': 0.27567409000904497, 'support': 61774}, 'accuracy': 0.47401377582968063, 'macro avg': {'precision': 0.5134285179921875, 'recall': 0.443464990043609, 'f1-score': 0.4056155852041157, 'support': 201222}, 'weighted avg': {'precision': 0.5091589097743021, 'recall': 0.47401377582968063, 'f1-score': 0.4189255695659409, 'support': 201222}}
[[15959 41051  6394]
 [ 5529 68146  2369]
 [ 8867 41630 11277]]
training model: results/AAL/W4/deepOF_L2/h200
Epoch 1/50
2425/2425 - 55s - loss: 3.1889 - accuracy200: 0.4245 - val_loss: 3.3837 - val_accuracy200: 0.3717 - 55s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 53s - loss: 3.1300 - accuracy200: 0.4450 - val_loss: 3.3468 - val_accuracy200: 0.3789 - 53s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 53s - loss: 3.1055 - accuracy200: 0.4515 - val_loss: 3.3209 - val_accuracy200: 0.3871 - 53s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 53s - loss: 3.0902 - accuracy200: 0.4552 - val_loss: 3.3263 - val_accuracy200: 0.3929 - 53s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 53s - loss: 3.0819 - accuracy200: 0.4576 - val_loss: 3.3175 - val_accuracy200: 0.3955 - 53s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 53s - loss: 3.0753 - accuracy200: 0.4593 - val_loss: 3.3184 - val_accuracy200: 0.3988 - 53s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 53s - loss: 3.0700 - accuracy200: 0.4612 - val_loss: 3.3278 - val_accuracy200: 0.3992 - 53s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 53s - loss: 3.0652 - accuracy200: 0.4619 - val_loss: 3.3258 - val_accuracy200: 0.4010 - 53s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 53s - loss: 3.0606 - accuracy200: 0.4636 - val_loss: 3.3461 - val_accuracy200: 0.4006 - 53s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 53s - loss: 3.0570 - accuracy200: 0.4648 - val_loss: 3.3660 - val_accuracy200: 0.4032 - 53s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 53s - loss: 3.0529 - accuracy200: 0.4658 - val_loss: 3.3837 - val_accuracy200: 0.4027 - 53s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 53s - loss: 3.0488 - accuracy200: 0.4666 - val_loss: 3.4170 - val_accuracy200: 0.4027 - 53s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 53s - loss: 3.0451 - accuracy200: 0.4681 - val_loss: 3.3981 - val_accuracy200: 0.4044 - 53s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 53s - loss: 3.0400 - accuracy200: 0.4702 - val_loss: 3.4079 - val_accuracy200: 0.4037 - 53s/epoch - 22ms/step
Epoch 15/50
2425/2425 - 53s - loss: 3.0364 - accuracy200: 0.4709 - val_loss: 3.4329 - val_accuracy200: 0.4039 - 53s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h200
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176918
{'0': {'precision': 0.5042701863354038, 'recall': 0.20613285080219224, 'f1-score': 0.2926413476572351, 'support': 422218}, '1': {'precision': 0.33276928434445247, 'recall': 0.8372250861491854, 'f1-score': 0.4762463816565893, 'support': 324147}, '2': {'precision': 0.47015984976869873, 'recall': 0.18210040801844954, 'f1-score': 0.26252189813690013, 'support': 394590}, 'accuracy': 0.3771156618797411, 'macro avg': {'precision': 0.435733106816185, 'recall': 0.4084861149899424, 'f1-score': 0.3438032091502415, 'support': 1140955}, 'weighted avg': {'precision': 0.44374974461463734, 'recall': 0.3771156618797411, 'f1-score': 0.3343872424292109, 'support': 1140955}}
[[ 87033 278984  56201]
 [ 27988 271384  24775]
 [ 57571 265164  71855]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093738
{'0': {'precision': 0.49076269108150083, 'recall': 0.17454064426096058, 'f1-score': 0.25750069699114286, 'support': 206376}, '1': {'precision': 0.3769346269346269, 'recall': 0.8931439099603657, 'f1-score': 0.5301355100809464, 'support': 204621}, '2': {'precision': 0.5148028421456919, 'recall': 0.15337780172311039, 'f1-score': 0.23634126182385895, 'support': 209737}, 'accuracy': 0.40427300582858355, 'macro avg': {'precision': 0.46083338672060653, 'recall': 0.40702078531481223, 'f1-score': 0.34132582296531605, 'support': 620734}, 'weighted avg': {'precision': 0.46136281424207, 'recall': 0.40427300582858355, 'f1-score': 0.3402235567596879, 'support': 620734}}
[[ 36021 150053  20302]
 [ 11848 182756  10017]
 [ 25529 152039  32169]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.107295
{'0': {'precision': 0.4943518246336035, 'recall': 0.17014511186911024, 'f1-score': 0.2531585681874388, 'support': 69188}, '1': {'precision': 0.3645158813442195, 'recall': 0.885379917007289, 'f1-score': 0.5164191146142585, 'support': 64343}, '2': {'precision': 0.509396449704142, 'recall': 0.15897238923933757, 'f1-score': 0.24232120338677715, 'support': 67691}, 'accuracy': 0.3950909940264981, 'macro avg': {'precision': 0.4560880518939883, 'recall': 0.40483247270524564, 'f1-score': 0.33729962872949154, 'support': 201222}, 'weighted avg': {'precision': 0.4578963258142944, 'recall': 0.3950909940264981, 'f1-score': 0.33369340671413705, 'support': 201222}}
[[11772 50500  6916]
 [ 3927 56968  3448]
 [ 8114 48816 10761]]
training model: results/AAL/W4/deepOF_L2/h300
Epoch 1/50
2425/2425 - 56s - loss: 3.2514 - accuracy300: 0.3964 - val_loss: 3.3673 - val_accuracy300: 0.3325 - 56s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 53s - loss: 3.2199 - accuracy300: 0.4124 - val_loss: 3.3724 - val_accuracy300: 0.3335 - 53s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 54s - loss: 3.2097 - accuracy300: 0.4167 - val_loss: 3.3743 - val_accuracy300: 0.3359 - 54s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 53s - loss: 3.2021 - accuracy300: 0.4196 - val_loss: 3.3921 - val_accuracy300: 0.3387 - 53s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 53s - loss: 3.1960 - accuracy300: 0.4223 - val_loss: 3.4039 - val_accuracy300: 0.3423 - 53s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 53s - loss: 3.1914 - accuracy300: 0.4242 - val_loss: 3.4178 - val_accuracy300: 0.3435 - 53s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 53s - loss: 3.1880 - accuracy300: 0.4253 - val_loss: 3.4343 - val_accuracy300: 0.3436 - 53s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 53s - loss: 3.1851 - accuracy300: 0.4264 - val_loss: 3.4295 - val_accuracy300: 0.3451 - 53s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 53s - loss: 3.1820 - accuracy300: 0.4274 - val_loss: 3.4351 - val_accuracy300: 0.3479 - 53s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 53s - loss: 3.1791 - accuracy300: 0.4296 - val_loss: 3.4561 - val_accuracy300: 0.3492 - 53s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 53s - loss: 3.1769 - accuracy300: 0.4294 - val_loss: 3.4697 - val_accuracy300: 0.3497 - 53s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h300
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1196855
{'0': {'precision': 0.421211859279108, 'recall': 0.012450337893943458, 'f1-score': 0.024185783345410508, 'support': 391395}, '1': {'precision': 0.3363374114501317, 'recall': 0.980227717283292, 'f1-score': 0.5008293868149208, 'support': 382404}, '2': {'precision': 0.361586470706664, 'recall': 0.014674961051977907, 'f1-score': 0.028205215452144577, 'support': 367156}, 'accuracy': 0.3375277727868321, 'macro avg': {'precision': 0.37304524714530124, 'recall': 0.3357843387430712, 'f1-score': 0.18440679520415867, 'support': 1140955}, 'weighted avg': {'precision': 0.3735779495155362, 'recall': 0.3375277727868321, 'f1-score': 0.18523173095573228, 'support': 1140955}}
[[  4873 381140   5382]
 [  3430 374843   4131]
 [  3266 358502   5388]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214399
{'0': {'precision': 0.4147208121827411, 'recall': 0.011910720620465446, 'f1-score': 0.02315639304457913, 'support': 205781}, '1': {'precision': 0.33173875675613496, 'recall': 0.9835706142017716, 'f1-score': 0.4961395393990633, 'support': 205242}, '2': {'precision': 0.4218626051086784, 'recall': 0.012679353968079881, 'f1-score': 0.024618774709046637, 'support': 209711}, 'accuracy': 0.3334439550596552, 'macro avg': {'precision': 0.38944072468251817, 'recall': 0.33605356293010563, 'f1-score': 0.1813049023842297, 'support': 620734}, 'weighted avg': {'precision': 0.3896960987248408, 'recall': 0.3334439550596552, 'f1-score': 0.18003950955716613, 'support': 620734}}
[[  2451 201417   1913]
 [  1641 201870   1731]
 [  1818 205234   2659]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.123265
{'0': {'precision': 0.4001037882719253, 'recall': 0.011243820273876711, 'f1-score': 0.021872960935061986, 'support': 68571}, '1': {'precision': 0.3311146146475989, 'recall': 0.9833785004516712, 'f1-score': 0.4954168104641594, 'support': 66420}, '2': {'precision': 0.4311701081612586, 'recall': 0.013241533420905617, 'f1-score': 0.025693986669596425, 'support': 66231}, 'accuracy': 0.332786673425371, 'macro avg': {'precision': 0.3874628370269276, 'recall': 0.3359546180488178, 'f1-score': 0.18099458602293927, 'support': 201222}, 'weighted avg': {'precision': 0.3875569122865095, 'recall': 0.332786673425371, 'f1-score': 0.17943949362605302, 'support': 201222}}
[[  771 67199   601]
 [  548 65316   556]
 [  608 64746   877]]
training model: results/AAL/W4/deepOF_L2/h500
Epoch 1/50
2425/2425 - 55s - loss: 3.2670 - accuracy500: 0.3837 - val_loss: 4.7207 - val_accuracy500: 0.3113 - 55s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 53s - loss: 3.2511 - accuracy500: 0.3940 - val_loss: 4.2089 - val_accuracy500: 0.3114 - 53s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 53s - loss: 3.2417 - accuracy500: 0.3973 - val_loss: 4.6042 - val_accuracy500: 0.3112 - 53s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 54s - loss: 3.2369 - accuracy500: 0.3993 - val_loss: 5.0421 - val_accuracy500: 0.3111 - 54s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 53s - loss: 3.2324 - accuracy500: 0.4011 - val_loss: 5.2512 - val_accuracy500: 0.3112 - 53s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 53s - loss: 3.2285 - accuracy500: 0.4034 - val_loss: 5.2687 - val_accuracy500: 0.3114 - 53s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 53s - loss: 3.2258 - accuracy500: 0.4057 - val_loss: 5.0622 - val_accuracy500: 0.3115 - 53s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 53s - loss: 3.2246 - accuracy500: 0.4069 - val_loss: 4.3395 - val_accuracy500: 0.3129 - 53s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 53s - loss: 3.2227 - accuracy500: 0.4078 - val_loss: 4.3292 - val_accuracy500: 0.3129 - 53s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 53s - loss: 3.2200 - accuracy500: 0.4096 - val_loss: 4.1994 - val_accuracy500: 0.3135 - 53s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 53s - loss: 3.2171 - accuracy500: 0.4115 - val_loss: 4.3261 - val_accuracy500: 0.3125 - 53s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 53s - loss: 3.2150 - accuracy500: 0.4125 - val_loss: 4.2405 - val_accuracy500: 0.3133 - 53s/epoch - 22ms/step
Epoch 13/50
2425/2425 - 54s - loss: 3.2122 - accuracy500: 0.4141 - val_loss: 4.3032 - val_accuracy500: 0.3123 - 54s/epoch - 22ms/step
Epoch 14/50
2425/2425 - 53s - loss: 3.2101 - accuracy500: 0.4147 - val_loss: 4.4415 - val_accuracy500: 0.3134 - 53s/epoch - 22ms/step
Epoch 15/50
2425/2425 - 53s - loss: 3.2070 - accuracy500: 0.4159 - val_loss: 4.6562 - val_accuracy500: 0.3116 - 53s/epoch - 22ms/step
Epoch 16/50
2425/2425 - 53s - loss: 3.2040 - accuracy500: 0.4178 - val_loss: 4.3477 - val_accuracy500: 0.3138 - 53s/epoch - 22ms/step
Epoch 17/50
2425/2425 - 54s - loss: 3.2022 - accuracy500: 0.4180 - val_loss: 4.5226 - val_accuracy500: 0.3127 - 54s/epoch - 22ms/step
Epoch 18/50
2425/2425 - 54s - loss: 3.1980 - accuracy500: 0.4205 - val_loss: 4.5185 - val_accuracy500: 0.3132 - 54s/epoch - 22ms/step
Epoch 19/50
2425/2425 - 54s - loss: 3.1955 - accuracy500: 0.4210 - val_loss: 4.6303 - val_accuracy500: 0.3122 - 54s/epoch - 22ms/step
Epoch 20/50
2425/2425 - 54s - loss: 3.1928 - accuracy500: 0.4228 - val_loss: 4.6157 - val_accuracy500: 0.3123 - 54s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h500
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.4180154
{'0': {'precision': 0.43498563218390807, 'recall': 0.0029650849615591793, 'f1-score': 0.005890020525092169, 'support': 408420}, '1': {'precision': 0.31051832949479, 'recall': 0.9755360165773069, 'f1-score': 0.47108711253887425, 'support': 353254}, '2': {'precision': 0.36140969162995595, 'recall': 0.027038000848974772, 'f1-score': 0.050312027788135094, 'support': 379281}, 'accuracy': 0.31208768093395445, 'macro avg': {'precision': 0.3689712177695513, 'recall': 0.33517970079594694, 'f1-score': 0.1757630536173672, 'support': 1140955}, 'weighted avg': {'precision': 0.37199057203395897, 'recall': 0.31208768093395445, 'f1-score': 0.16468783190150116, 'support': 1140955}}
[[  1211 396946  10263]
 [   785 344612   7857]
 [   788 368238  10255]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.3733829
{'0': {'precision': 0.4328485885372113, 'recall': 0.002450932904500804, 'f1-score': 0.004874266090617038, 'support': 206452}, '1': {'precision': 0.33089968146346654, 'recall': 0.9876959025448999, 'f1-score': 0.49572175653942546, 'support': 204566}, '2': {'precision': 0.42299107142857145, 'recall': 0.018072059356463027, 'f1-score': 0.03466315462144909, 'support': 209716}, 'accuracy': 0.3324209725905138, 'macro avg': {'precision': 0.39557978047641645, 'recall': 0.3360729649352879, 'f1-score': 0.17841972575049722, 'support': 620734}, 'weighted avg': {'precision': 0.3959204370546065, 'recall': 0.3324209725905138, 'f1-score': 0.17669974089670615, 'support': 620734}}
[[   506 202982   2964]
 [   311 202049   2206]
 [   352 205574   3790]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.405198
{'0': {'precision': 0.39348370927318294, 'recall': 0.002195405031253059, 'f1-score': 0.00436644788074313, 'support': 71513}, '1': {'precision': 0.3114988297516642, 'recall': 0.9856689429643166, 'f1-score': 0.4733924611973392, 'support': 62382}, '2': {'precision': 0.4330708661417323, 'recall': 0.02205653006966002, 'f1-score': 0.04197523884900221, 'support': 67327}, 'accuracy': 0.31373309081511963, 'macro avg': {'precision': 0.37935113505552653, 'recall': 0.33664029268840984, 'f1-score': 0.17324471597569482, 'support': 201222}, 'weighted avg': {'precision': 0.38131259357101044, 'recall': 0.31373309081511963, 'f1-score': 0.16235547409177312, 'support': 201222}}
[[  157 70209  1147]
 [   97 61488   797]
 [  145 65697  1485]]
training model: results/AAL/W4/deepOF_L2/h1000
Epoch 1/50
2425/2425 - 56s - loss: 3.2189 - accuracy1000: 0.4170 - val_loss: 3.5569 - val_accuracy1000: 0.3512 - 56s/epoch - 23ms/step
Epoch 2/50
2425/2425 - 53s - loss: 3.2107 - accuracy1000: 0.4157 - val_loss: 3.5546 - val_accuracy1000: 0.3508 - 53s/epoch - 22ms/step
Epoch 3/50
2425/2425 - 53s - loss: 3.2056 - accuracy1000: 0.4164 - val_loss: 3.6566 - val_accuracy1000: 0.3503 - 53s/epoch - 22ms/step
Epoch 4/50
2425/2425 - 54s - loss: 3.2023 - accuracy1000: 0.4179 - val_loss: 3.6639 - val_accuracy1000: 0.3513 - 54s/epoch - 22ms/step
Epoch 5/50
2425/2425 - 53s - loss: 3.2010 - accuracy1000: 0.4181 - val_loss: 3.6521 - val_accuracy1000: 0.3516 - 53s/epoch - 22ms/step
Epoch 6/50
2425/2425 - 54s - loss: 3.2034 - accuracy1000: 0.4170 - val_loss: 3.6828 - val_accuracy1000: 0.3505 - 54s/epoch - 22ms/step
Epoch 7/50
2425/2425 - 53s - loss: 3.2021 - accuracy1000: 0.4171 - val_loss: 3.7007 - val_accuracy1000: 0.3505 - 53s/epoch - 22ms/step
Epoch 8/50
2425/2425 - 54s - loss: 3.2033 - accuracy1000: 0.4160 - val_loss: 3.7137 - val_accuracy1000: 0.3500 - 54s/epoch - 22ms/step
Epoch 9/50
2425/2425 - 54s - loss: 3.2080 - accuracy1000: 0.4133 - val_loss: 3.6665 - val_accuracy1000: 0.3497 - 54s/epoch - 22ms/step
Epoch 10/50
2425/2425 - 53s - loss: 3.2064 - accuracy1000: 0.4160 - val_loss: 3.6676 - val_accuracy1000: 0.3497 - 53s/epoch - 22ms/step
Epoch 11/50
2425/2425 - 54s - loss: 3.2047 - accuracy1000: 0.4155 - val_loss: 3.7139 - val_accuracy1000: 0.3496 - 54s/epoch - 22ms/step
Epoch 12/50
2425/2425 - 54s - loss: 3.2042 - accuracy1000: 0.4162 - val_loss: 3.7435 - val_accuracy1000: 0.3497 - 54s/epoch - 22ms/step
testing model: results/AAL/W4/deepOF_L2/h1000
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1258832
{'0': {'precision': 0.38375951590864726, 'recall': 0.0055495180161743325, 'f1-score': 0.01094082161897448, 'support': 354265}, '1': {'precision': 0.41331263441647603, 'recall': 0.9903190543638691, 'f1-score': 0.5832176354291719, 'support': 470202}, '2': {'precision': 0.30174942953384765, 'recall': 0.008774424306766766, 'f1-score': 0.017052973523984393, 'support': 316488}, 'accuracy': 0.4122800636309057, 'macro avg': {'precision': 0.3662738599529903, 'recall': 0.3348809988956034, 'f1-score': 0.2037371435240436, 'support': 1140955}, 'weighted avg': {'precision': 0.3731900606821313, 'recall': 0.4122800636309057, 'f1-score': 0.2484787833609321, 'support': 1140955}}
[[  1966 348797   3502]
 [  1628 465650   2924]
 [  1529 312182   2777]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2001979
{'0': {'precision': 0.41433333333333333, 'recall': 0.006091883043687084, 'f1-score': 0.01200722558707895, 'support': 204042}, '1': {'precision': 0.3309574407451737, 'recall': 0.9917869987653658, 'f1-score': 0.49630038436930707, 'support': 204919}, '2': {'precision': 0.4077829542340367, 'recall': 0.007026391466334235, 'f1-score': 0.013814745012115754, 'support': 211773}, 'accuracy': 0.33181201609707217, 'macro avg': {'precision': 0.38435790943751463, 'recall': 0.33496842442512903, 'f1-score': 0.1740407849895006, 'support': 620734}, 'weighted avg': {'precision': 0.38457421273373926, 'recall': 0.33181201609707217, 'f1-score': 0.17250053450151528, 'support': 620734}}
[[  1243 201567   1232]
 [   754 203236    929]
 [  1003 209282   1488]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1851552
{'0': {'precision': 0.40208333333333335, 'recall': 0.0056808147406840525, 'f1-score': 0.011203343588552852, 'support': 67948}, '1': {'precision': 0.35056399949755057, 'recall': 0.9918966179042095, 'f1-score': 0.518038653727642, 'support': 70341}, '2': {'precision': 0.37105901374292644, 'recall': 0.007293470834061621, 'f1-score': 0.014305750350631136, 'support': 62933}, 'accuracy': 0.350935782369721, 'macro avg': {'precision': 0.37456878219127016, 'recall': 0.3349569678263184, 'f1-score': 0.18118258255560868, 'support': 201222}, 'weighted avg': {'precision': 0.3743707821901886, 'recall': 0.350935782369721, 'f1-score': 0.1893476136745849, 'support': 201222}}
[[  386 67115   447]
 [  239 69771   331]
 [  335 62139   459]]
training model: results/AAL/W4/deepVOL_L2/h10
Epoch 1/50
2425/2425 - 61s - loss: 2.5775 - accuracy10: 0.5359 - val_loss: 2.5820 - val_accuracy10: 0.6579 - 61s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 60s - loss: 2.3177 - accuracy10: 0.6072 - val_loss: 2.5473 - val_accuracy10: 0.7160 - 60s/epoch - 25ms/step
Epoch 3/50
2425/2425 - 61s - loss: 2.2364 - accuracy10: 0.6320 - val_loss: 2.5977 - val_accuracy10: 0.7441 - 61s/epoch - 25ms/step
Epoch 4/50
2425/2425 - 60s - loss: 2.1982 - accuracy10: 0.6410 - val_loss: 2.5489 - val_accuracy10: 0.7353 - 60s/epoch - 25ms/step
Epoch 5/50
2425/2425 - 59s - loss: 2.1716 - accuracy10: 0.6453 - val_loss: 2.4777 - val_accuracy10: 0.7328 - 59s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 59s - loss: 2.1533 - accuracy10: 0.6472 - val_loss: 2.4272 - val_accuracy10: 0.7263 - 59s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 60s - loss: 2.1375 - accuracy10: 0.6504 - val_loss: 2.4029 - val_accuracy10: 0.7157 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 58s - loss: 2.1248 - accuracy10: 0.6520 - val_loss: 2.4294 - val_accuracy10: 0.7333 - 58s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 59s - loss: 2.1145 - accuracy10: 0.6536 - val_loss: 2.4089 - val_accuracy10: 0.7298 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 61s - loss: 2.1039 - accuracy10: 0.6551 - val_loss: 2.4135 - val_accuracy10: 0.7353 - 61s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 60s - loss: 2.0947 - accuracy10: 0.6561 - val_loss: 2.3890 - val_accuracy10: 0.7303 - 60s/epoch - 25ms/step
Epoch 12/50
2425/2425 - 59s - loss: 2.0874 - accuracy10: 0.6574 - val_loss: 2.4246 - val_accuracy10: 0.7362 - 59s/epoch - 25ms/step
Epoch 13/50
2425/2425 - 59s - loss: 2.0800 - accuracy10: 0.6582 - val_loss: 2.4019 - val_accuracy10: 0.7339 - 59s/epoch - 24ms/step
Epoch 14/50
2425/2425 - 58s - loss: 2.0725 - accuracy10: 0.6596 - val_loss: 2.3763 - val_accuracy10: 0.7271 - 58s/epoch - 24ms/step
Epoch 15/50
2425/2425 - 60s - loss: 2.0669 - accuracy10: 0.6601 - val_loss: 2.3944 - val_accuracy10: 0.7314 - 60s/epoch - 25ms/step
Epoch 16/50
2425/2425 - 60s - loss: 2.0602 - accuracy10: 0.6598 - val_loss: 2.3303 - val_accuracy10: 0.7142 - 60s/epoch - 25ms/step
Epoch 17/50
2425/2425 - 59s - loss: 2.0536 - accuracy10: 0.6623 - val_loss: 2.4142 - val_accuracy10: 0.7373 - 59s/epoch - 24ms/step
Epoch 18/50
2425/2425 - 59s - loss: 2.0487 - accuracy10: 0.6621 - val_loss: 2.4016 - val_accuracy10: 0.7372 - 59s/epoch - 24ms/step
Epoch 19/50
2425/2425 - 60s - loss: 2.0422 - accuracy10: 0.6629 - val_loss: 2.3710 - val_accuracy10: 0.7271 - 60s/epoch - 25ms/step
Epoch 20/50
2425/2425 - 61s - loss: 2.0371 - accuracy10: 0.6627 - val_loss: 2.3872 - val_accuracy10: 0.7318 - 61s/epoch - 25ms/step
Epoch 21/50
2425/2425 - 58s - loss: 2.0330 - accuracy10: 0.6635 - val_loss: 2.3516 - val_accuracy10: 0.7217 - 58s/epoch - 24ms/step
Epoch 22/50
2425/2425 - 58s - loss: 2.0291 - accuracy10: 0.6644 - val_loss: 2.3703 - val_accuracy10: 0.7257 - 58s/epoch - 24ms/step
Epoch 23/50
2425/2425 - 57s - loss: 2.0233 - accuracy10: 0.6644 - val_loss: 2.3845 - val_accuracy10: 0.7316 - 57s/epoch - 24ms/step
Epoch 24/50
2425/2425 - 61s - loss: 2.0193 - accuracy10: 0.6656 - val_loss: 2.3912 - val_accuracy10: 0.7340 - 61s/epoch - 25ms/step
Epoch 25/50
2425/2425 - 59s - loss: 2.0147 - accuracy10: 0.6649 - val_loss: 2.3797 - val_accuracy10: 0.7272 - 59s/epoch - 24ms/step
Epoch 26/50
2425/2425 - 59s - loss: 2.0100 - accuracy10: 0.6658 - val_loss: 2.3776 - val_accuracy10: 0.7274 - 59s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h10
Evaluating performance on  test set...
4457/4457 - 45s - 45s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75403994
{'0': {'precision': 0.4340119044612263, 'recall': 0.5985799379956573, 'f1-score': 0.503182008960381, 'support': 172246}, '1': {'precision': 0.8545758370860097, 'recall': 0.7333166645830729, 'f1-score': 0.7893162815826424, 'support': 799900}, '2': {'precision': 0.42508824803458034, 'recall': 0.5464330353704987, 'f1-score': 0.47818254863082044, 'support': 168813}, 'accuracy': 0.6853252395572497, 'macro avg': {'precision': 0.5712253298606055, 'recall': 0.6261098793164096, 'f1-score': 0.5902269463912814, 'support': 1140959}, 'weighted avg': {'precision': 0.7275392446147401, 'recall': 0.6853252395572497, 'f1-score': 0.700085290124676, 'support': 1140959}}
[[103103  47756  21387]
 [109950 586580 103370]
 [ 24505  52063  92245]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6619393
{'0': {'precision': 0.40938790655653073, 'recall': 0.6377836981928771, 'f1-score': 0.49867840543966363, 'support': 79574}, '1': {'precision': 0.9020745617392636, 'recall': 0.7610831711475862, 'f1-score': 0.8256027128207403, 'support': 464488}, '2': {'precision': 0.42369778506660055, 'recall': 0.5795500489077274, 'f1-score': 0.4895182700463774, 'support': 76675}, 'accuracy': 0.7228536401084518, 'macro avg': {'precision': 0.5783867511207983, 'recall': 0.6594723060827302, 'f1-score': 0.6045997961022604, 'support': 620737}, 'weighted avg': {'precision': 0.7798253849528191, 'recall': 0.7228536401084518, 'f1-score': 0.7421793797742712, 'support': 620737}}
[[ 50751  19273   9550]
 [ 60082 353514  50892]
 [ 13135  19103  44437]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6698993
{'0': {'precision': 0.432041198022085, 'recall': 0.6244399185336049, 'f1-score': 0.5107214246774486, 'support': 27005}, '1': {'precision': 0.8957588350890757, 'recall': 0.7503525046382189, 'f1-score': 0.8166335644978322, 'support': 148225}, '2': {'precision': 0.4142056959528756, 'recall': 0.6059941520467836, 'f1-score': 0.4920726659273028, 'support': 25992}, 'accuracy': 0.714807526016042, 'macro avg': {'precision': 0.5806685763546788, 'recall': 0.6602621917395358, 'f1-score': 0.6064758850341946, 'support': 201222}, 'weighted avg': {'precision': 0.7713230180242309, 'recall': 0.714807526016042, 'f1-score': 0.7336548434261072, 'support': 201222}}
[[ 16863   6493   3649]
 [ 18377 111221  18627]
 [  3791   6450  15751]]
training model: results/AAL/W4/deepVOL_L2/h20
Epoch 1/50
2425/2425 - 60s - loss: 2.6569 - accuracy20: 0.5407 - val_loss: 2.7221 - val_accuracy20: 0.6466 - 60s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 57s - loss: 2.4526 - accuracy20: 0.5987 - val_loss: 2.8003 - val_accuracy20: 0.6945 - 57s/epoch - 23ms/step
Epoch 3/50
2425/2425 - 58s - loss: 2.3816 - accuracy20: 0.6190 - val_loss: 2.7421 - val_accuracy20: 0.7043 - 58s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 58s - loss: 2.3478 - accuracy20: 0.6266 - val_loss: 2.6840 - val_accuracy20: 0.7053 - 58s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 61s - loss: 2.3256 - accuracy20: 0.6292 - val_loss: 2.6802 - val_accuracy20: 0.7069 - 61s/epoch - 25ms/step
Epoch 6/50
2425/2425 - 59s - loss: 2.3052 - accuracy20: 0.6327 - val_loss: 2.6176 - val_accuracy20: 0.7005 - 59s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 60s - loss: 2.2870 - accuracy20: 0.6352 - val_loss: 2.6172 - val_accuracy20: 0.7042 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 61s - loss: 2.2746 - accuracy20: 0.6360 - val_loss: 2.6099 - val_accuracy20: 0.7036 - 61s/epoch - 25ms/step
Epoch 9/50
2425/2425 - 59s - loss: 2.2635 - accuracy20: 0.6380 - val_loss: 2.5863 - val_accuracy20: 0.7018 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 59s - loss: 2.2531 - accuracy20: 0.6405 - val_loss: 2.6372 - val_accuracy20: 0.7084 - 59s/epoch - 24ms/step
Epoch 11/50
2425/2425 - 62s - loss: 2.2470 - accuracy20: 0.6400 - val_loss: 2.6251 - val_accuracy20: 0.7077 - 62s/epoch - 25ms/step
Epoch 12/50
2425/2425 - 58s - loss: 2.2386 - accuracy20: 0.6420 - val_loss: 2.6028 - val_accuracy20: 0.7050 - 58s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 58s - loss: 2.2307 - accuracy20: 0.6428 - val_loss: 2.6276 - val_accuracy20: 0.7113 - 58s/epoch - 24ms/step
Epoch 14/50
2425/2425 - 58s - loss: 2.2244 - accuracy20: 0.6436 - val_loss: 2.6106 - val_accuracy20: 0.7093 - 58s/epoch - 24ms/step
Epoch 15/50
2425/2425 - 59s - loss: 2.2182 - accuracy20: 0.6441 - val_loss: 2.5818 - val_accuracy20: 0.7060 - 59s/epoch - 25ms/step
Epoch 16/50
2425/2425 - 59s - loss: 2.2127 - accuracy20: 0.6442 - val_loss: 2.6075 - val_accuracy20: 0.7090 - 59s/epoch - 24ms/step
Epoch 17/50
2425/2425 - 59s - loss: 2.2086 - accuracy20: 0.6457 - val_loss: 2.6200 - val_accuracy20: 0.7100 - 59s/epoch - 24ms/step
Epoch 18/50
2425/2425 - 59s - loss: 2.2021 - accuracy20: 0.6454 - val_loss: 2.6034 - val_accuracy20: 0.7096 - 59s/epoch - 24ms/step
Epoch 19/50
2425/2425 - 58s - loss: 2.1974 - accuracy20: 0.6465 - val_loss: 2.5940 - val_accuracy20: 0.7065 - 58s/epoch - 24ms/step
Epoch 20/50
2425/2425 - 58s - loss: 2.1919 - accuracy20: 0.6477 - val_loss: 2.5970 - val_accuracy20: 0.7069 - 58s/epoch - 24ms/step
Epoch 21/50
2425/2425 - 59s - loss: 2.1868 - accuracy20: 0.6477 - val_loss: 2.6039 - val_accuracy20: 0.7067 - 59s/epoch - 24ms/step
Epoch 22/50
2425/2425 - 59s - loss: 2.1833 - accuracy20: 0.6481 - val_loss: 2.5902 - val_accuracy20: 0.7061 - 59s/epoch - 24ms/step
Epoch 23/50
2425/2425 - 58s - loss: 2.1784 - accuracy20: 0.6491 - val_loss: 2.6174 - val_accuracy20: 0.7075 - 58s/epoch - 24ms/step
Epoch 24/50
2425/2425 - 61s - loss: 2.1753 - accuracy20: 0.6492 - val_loss: 2.6034 - val_accuracy20: 0.7048 - 61s/epoch - 25ms/step
Epoch 25/50
2425/2425 - 62s - loss: 2.1709 - accuracy20: 0.6497 - val_loss: 2.6520 - val_accuracy20: 0.7084 - 62s/epoch - 25ms/step
testing model: results/AAL/W4/deepVOL_L2/h20
Evaluating performance on  test set...
4457/4457 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7834152
{'0': {'precision': 0.5382442394456977, 'recall': 0.4665976969347756, 'f1-score': 0.4998667221601298, 'support': 229086}, '1': {'precision': 0.7558269003398164, 'recall': 0.7982701258328457, 'f1-score': 0.7764689394304027, 'support': 687102}, '2': {'precision': 0.49247511318482007, 'recall': 0.47474985652063656, 'f1-score': 0.48345006931670936, 'support': 224771}, 'accuracy': 0.6679416175340218, 'macro avg': {'precision': 0.595515417656778, 'recall': 0.5798725597627526, 'f1-score': 0.5865952436357473, 'support': 1140959}, 'weighted avg': {'precision': 0.6602590613515567, 'recall': 0.6679416175340218, 'f1-score': 0.6632064646176331, 'support': 1140959}}
[[106891  87194  35001]
 [ 63639 548493  74970]
 [ 28062  89999 106710]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6782368
{'0': {'precision': 0.4939847016083393, 'recall': 0.5165853705100181, 'f1-score': 0.505032312250659, 'support': 104761}, '1': {'precision': 0.8245774091530572, 'recall': 0.8160308281432676, 'f1-score': 0.820281857377831, 'support': 413129}, '2': {'precision': 0.5051106160100063, 'recall': 0.5026009509271053, 'f1-score': 0.503852658358636, 'support': 102847}, 'accuracy': 0.7135630709946402, 'macro avg': {'precision': 0.6078909089238009, 'recall': 0.6117390498601303, 'f1-score': 0.6097222759957087, 'support': 620737}, 'weighted avg': {'precision': 0.7158527416860373, 'recall': 0.7135630709946402, 'f1-score': 0.7146499207789255, 'support': 620737}}
[[ 54118  36127  14516]
 [ 39874 337126  36129]
 [ 15562  35594  51691]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6851732
{'0': {'precision': 0.5165741062131205, 'recall': 0.5051050711316005, 'f1-score': 0.5107752148607874, 'support': 35357}, '1': {'precision': 0.8133121471624027, 'recall': 0.8109147688323558, 'f1-score': 0.812111688717853, 'support': 131290}, '2': {'precision': 0.4984194477858282, 'recall': 0.5153145336225596, 'f1-score': 0.5067262023264412, 'support': 34575}, 'accuracy': 0.7063889634334218, 'macro avg': {'precision': 0.6094352337204505, 'recall': 0.6104447911955053, 'f1-score': 0.6098710353016938, 'support': 201222}, 'weighted avg': {'precision': 0.7070654047843883, 'recall': 0.7063889634334218, 'f1-score': 0.7066905275220229, 'support': 201222}}
[[ 17859  12280   5218]
 [ 12113 106465  12712]
 [  4600  12158  17817]]
training model: results/AAL/W4/deepVOL_L2/h30
Epoch 1/50
2425/2425 - 60s - loss: 2.7672 - accuracy30: 0.5291 - val_loss: 2.8399 - val_accuracy30: 0.6354 - 60s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 58s - loss: 2.5610 - accuracy30: 0.5871 - val_loss: 2.8391 - val_accuracy30: 0.6559 - 58s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 61s - loss: 2.5007 - accuracy30: 0.6020 - val_loss: 2.8512 - val_accuracy30: 0.6595 - 61s/epoch - 25ms/step
Epoch 4/50
2425/2425 - 60s - loss: 2.4746 - accuracy30: 0.6082 - val_loss: 2.8196 - val_accuracy30: 0.6600 - 60s/epoch - 25ms/step
Epoch 5/50
2425/2425 - 58s - loss: 2.4573 - accuracy30: 0.6117 - val_loss: 2.7961 - val_accuracy30: 0.6648 - 58s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 59s - loss: 2.4425 - accuracy30: 0.6146 - val_loss: 2.7636 - val_accuracy30: 0.6633 - 59s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 58s - loss: 2.4266 - accuracy30: 0.6162 - val_loss: 2.7551 - val_accuracy30: 0.6674 - 58s/epoch - 24ms/step
Epoch 8/50
2425/2425 - 57s - loss: 2.4095 - accuracy30: 0.6168 - val_loss: 2.7500 - val_accuracy30: 0.6695 - 57s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 59s - loss: 2.3970 - accuracy30: 0.6189 - val_loss: 2.7601 - val_accuracy30: 0.6743 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 60s - loss: 2.3869 - accuracy30: 0.6205 - val_loss: 2.7747 - val_accuracy30: 0.6729 - 60s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 61s - loss: 2.3780 - accuracy30: 0.6208 - val_loss: 2.7208 - val_accuracy30: 0.6692 - 61s/epoch - 25ms/step
Epoch 12/50
2425/2425 - 58s - loss: 2.3700 - accuracy30: 0.6219 - val_loss: 2.6857 - val_accuracy30: 0.6699 - 58s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 59s - loss: 2.3629 - accuracy30: 0.6232 - val_loss: 2.7296 - val_accuracy30: 0.6726 - 59s/epoch - 24ms/step
Epoch 14/50
2425/2425 - 59s - loss: 2.3568 - accuracy30: 0.6236 - val_loss: 2.6749 - val_accuracy30: 0.6656 - 59s/epoch - 25ms/step
Epoch 15/50
2425/2425 - 60s - loss: 2.3502 - accuracy30: 0.6249 - val_loss: 2.6845 - val_accuracy30: 0.6706 - 60s/epoch - 25ms/step
Epoch 16/50
2425/2425 - 58s - loss: 2.3457 - accuracy30: 0.6245 - val_loss: 2.6828 - val_accuracy30: 0.6719 - 58s/epoch - 24ms/step
Epoch 17/50
2425/2425 - 58s - loss: 2.3416 - accuracy30: 0.6256 - val_loss: 2.7258 - val_accuracy30: 0.6730 - 58s/epoch - 24ms/step
Epoch 18/50
2425/2425 - 58s - loss: 2.3368 - accuracy30: 0.6265 - val_loss: 2.6904 - val_accuracy30: 0.6741 - 58s/epoch - 24ms/step
Epoch 19/50
2425/2425 - 60s - loss: 2.3321 - accuracy30: 0.6273 - val_loss: 2.6859 - val_accuracy30: 0.6734 - 60s/epoch - 25ms/step
Epoch 20/50
2425/2425 - 58s - loss: 2.3279 - accuracy30: 0.6275 - val_loss: 2.7264 - val_accuracy30: 0.6751 - 58s/epoch - 24ms/step
Epoch 21/50
2425/2425 - 62s - loss: 2.3248 - accuracy30: 0.6283 - val_loss: 2.7095 - val_accuracy30: 0.6757 - 62s/epoch - 25ms/step
Epoch 22/50
2425/2425 - 60s - loss: 2.3206 - accuracy30: 0.6288 - val_loss: 2.7023 - val_accuracy30: 0.6742 - 60s/epoch - 25ms/step
Epoch 23/50
2425/2425 - 58s - loss: 2.3162 - accuracy30: 0.6294 - val_loss: 2.6877 - val_accuracy30: 0.6728 - 58s/epoch - 24ms/step
Epoch 24/50
2425/2425 - 58s - loss: 2.3125 - accuracy30: 0.6299 - val_loss: 2.7062 - val_accuracy30: 0.6733 - 58s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h30
Evaluating performance on  test set...
4457/4457 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8531127
{'0': {'precision': 0.5345596780845028, 'recall': 0.4794046667314201, 'f1-score': 0.5054820825414331, 'support': 267682}, '1': {'precision': 0.6957334472144684, 'recall': 0.7698419186898284, 'f1-score': 0.7309139937266796, 'support': 611584}, '2': {'precision': 0.5152230256906681, 'recall': 0.4413415719946655, 'f1-score': 0.47542913596509284, 'support': 261693}, 'accuracy': 0.6263564247269183, 'macro avg': {'precision': 0.5818387169965464, 'recall': 0.5635293858053047, 'f1-score': 0.5706084040777352, 'support': 1140959}, 'weighted avg': {'precision': 0.616517953399112, 'recall': 0.6263564247269183, 'f1-score': 0.6194264961635839, 'support': 1140959}}
[[128328  96684  42670]
 [ 74760 470823  66001]
 [ 36975 109222 115496]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7565263
{'0': {'precision': 0.49239500045951656, 'recall': 0.5243400181051567, 'f1-score': 0.5078656655699892, 'support': 122617}, '1': {'precision': 0.7765383939369296, 'recall': 0.7862115308510158, 'f1-score': 0.781345024917645, 'support': 376503}, '2': {'precision': 0.5239878133832544, 'recall': 0.4695067301446344, 'f1-score': 0.4952534596186288, 'support': 121617}, 'accuracy': 0.6724329305325766, 'macro avg': {'precision': 0.5976404025932336, 'recall': 0.5933527597002689, 'f1-score': 0.5948213833687545, 'support': 620737}, 'weighted avg': {'precision': 0.6709296507281048, 'recall': 0.6724329305325766, 'f1-score': 0.6712713278412633, 'support': 620737}}
[[ 64293  40077  18247]
 [ 46867 296011  33625]
 [ 19412  45105  57100]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7612824
{'0': {'precision': 0.5160180817610063, 'recall': 0.5085221770288592, 'f1-score': 0.5122427080284849, 'support': 41304}, '1': {'precision': 0.7607479688074144, 'recall': 0.7809435195895992, 'f1-score': 0.7707134673213023, 'support': 119298}, '2': {'precision': 0.5153864347094841, 'recall': 0.4828163466272772, 'f1-score': 0.4985700303789101, 'support': 40620}, 'accuracy': 0.6648428104282832, 'macro avg': {'precision': 0.5973841617593015, 'recall': 0.5907606810819118, 'f1-score': 0.5938420685762323, 'support': 201222}, 'weighted avg': {'precision': 0.6609829889860094, 'recall': 0.6648428104282832, 'f1-score': 0.6627215844733506, 'support': 201222}}
[[21004 13849  6451]
 [14143 93165 11990]
 [ 5557 15451 19612]]
training model: results/AAL/W4/deepVOL_L2/h50
Epoch 1/50
2425/2425 - 62s - loss: 2.8968 - accuracy50: 0.5113 - val_loss: 3.1169 - val_accuracy50: 0.5810 - 62s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 58s - loss: 2.7088 - accuracy50: 0.5659 - val_loss: 3.1112 - val_accuracy50: 0.5964 - 58s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 59s - loss: 2.6677 - accuracy50: 0.5732 - val_loss: 3.0805 - val_accuracy50: 0.5988 - 59s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 59s - loss: 2.6472 - accuracy50: 0.5791 - val_loss: 3.0536 - val_accuracy50: 0.6005 - 59s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 60s - loss: 2.6329 - accuracy50: 0.5814 - val_loss: 3.0635 - val_accuracy50: 0.6021 - 60s/epoch - 25ms/step
Epoch 6/50
2425/2425 - 60s - loss: 2.6191 - accuracy50: 0.5841 - val_loss: 3.0774 - val_accuracy50: 0.6024 - 60s/epoch - 25ms/step
Epoch 7/50
2425/2425 - 60s - loss: 2.6081 - accuracy50: 0.5856 - val_loss: 3.0337 - val_accuracy50: 0.6038 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 59s - loss: 2.5961 - accuracy50: 0.5863 - val_loss: 3.0524 - val_accuracy50: 0.6041 - 59s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 59s - loss: 2.5873 - accuracy50: 0.5873 - val_loss: 3.0400 - val_accuracy50: 0.6050 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 61s - loss: 2.5802 - accuracy50: 0.5883 - val_loss: 3.0373 - val_accuracy50: 0.6050 - 61s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 59s - loss: 2.5739 - accuracy50: 0.5890 - val_loss: 3.0241 - val_accuracy50: 0.6050 - 59s/epoch - 24ms/step
Epoch 12/50
2425/2425 - 58s - loss: 2.5678 - accuracy50: 0.5899 - val_loss: 3.0380 - val_accuracy50: 0.6038 - 58s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 60s - loss: 2.5612 - accuracy50: 0.5907 - val_loss: 3.0291 - val_accuracy50: 0.6007 - 60s/epoch - 25ms/step
Epoch 14/50
2425/2425 - 58s - loss: 2.5560 - accuracy50: 0.5916 - val_loss: 3.0329 - val_accuracy50: 0.6023 - 58s/epoch - 24ms/step
Epoch 15/50
2425/2425 - 58s - loss: 2.5501 - accuracy50: 0.5922 - val_loss: 3.0802 - val_accuracy50: 0.6044 - 58s/epoch - 24ms/step
Epoch 16/50
2425/2425 - 60s - loss: 2.5462 - accuracy50: 0.5926 - val_loss: 3.0130 - val_accuracy50: 0.6025 - 60s/epoch - 25ms/step
Epoch 17/50
2425/2425 - 59s - loss: 2.5398 - accuracy50: 0.5937 - val_loss: 3.1255 - val_accuracy50: 0.6009 - 59s/epoch - 24ms/step
Epoch 18/50
2425/2425 - 61s - loss: 2.5368 - accuracy50: 0.5942 - val_loss: 3.0362 - val_accuracy50: 0.6021 - 61s/epoch - 25ms/step
Epoch 19/50
2425/2425 - 60s - loss: 2.5321 - accuracy50: 0.5942 - val_loss: 3.0418 - val_accuracy50: 0.6031 - 60s/epoch - 25ms/step
Epoch 20/50
2425/2425 - 60s - loss: 2.5284 - accuracy50: 0.5949 - val_loss: 3.0435 - val_accuracy50: 0.6032 - 60s/epoch - 25ms/step
Epoch 21/50
2425/2425 - 58s - loss: 2.5233 - accuracy50: 0.5958 - val_loss: 3.0236 - val_accuracy50: 0.6053 - 58s/epoch - 24ms/step
Epoch 22/50
2425/2425 - 58s - loss: 2.5209 - accuracy50: 0.5961 - val_loss: 3.0233 - val_accuracy50: 0.6040 - 58s/epoch - 24ms/step
Epoch 23/50
2425/2425 - 60s - loss: 2.5166 - accuracy50: 0.5961 - val_loss: 3.0330 - val_accuracy50: 0.6045 - 60s/epoch - 25ms/step
Epoch 24/50
2425/2425 - 61s - loss: 2.5119 - accuracy50: 0.5973 - val_loss: 3.0123 - val_accuracy50: 0.6048 - 61s/epoch - 25ms/step
Epoch 25/50
2425/2425 - 60s - loss: 2.5100 - accuracy50: 0.5977 - val_loss: 3.0178 - val_accuracy50: 0.6040 - 60s/epoch - 25ms/step
Epoch 26/50
2425/2425 - 59s - loss: 2.5050 - accuracy50: 0.5982 - val_loss: 3.0447 - val_accuracy50: 0.6052 - 59s/epoch - 24ms/step
Epoch 27/50
2425/2425 - 57s - loss: 2.5015 - accuracy50: 0.5983 - val_loss: 3.0638 - val_accuracy50: 0.6050 - 57s/epoch - 24ms/step
Epoch 28/50
2425/2425 - 60s - loss: 2.4980 - accuracy50: 0.5988 - val_loss: 3.1170 - val_accuracy50: 0.6056 - 60s/epoch - 25ms/step
Epoch 29/50
2425/2425 - 58s - loss: 2.4945 - accuracy50: 0.5995 - val_loss: 3.0488 - val_accuracy50: 0.6033 - 58s/epoch - 24ms/step
Epoch 30/50
2425/2425 - 58s - loss: 2.4899 - accuracy50: 0.6002 - val_loss: 3.0638 - val_accuracy50: 0.6048 - 58s/epoch - 24ms/step
Epoch 31/50
2425/2425 - 59s - loss: 2.4868 - accuracy50: 0.6005 - val_loss: 3.0883 - val_accuracy50: 0.6034 - 59s/epoch - 24ms/step
Epoch 32/50
2425/2425 - 57s - loss: 2.4844 - accuracy50: 0.6009 - val_loss: 3.0939 - val_accuracy50: 0.6038 - 57s/epoch - 24ms/step
Epoch 33/50
2425/2425 - 58s - loss: 2.4799 - accuracy50: 0.6016 - val_loss: 3.0993 - val_accuracy50: 0.6031 - 58s/epoch - 24ms/step
Epoch 34/50
2425/2425 - 58s - loss: 2.4777 - accuracy50: 0.6019 - val_loss: 3.0914 - val_accuracy50: 0.6044 - 58s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h50
Evaluating performance on  test set...
4457/4457 - 45s - 45s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97117054
{'0': {'precision': 0.5753150345693787, 'recall': 0.30163571867875183, 'f1-score': 0.39577037427989786, 'support': 321938}, '1': {'precision': 0.5770716739411009, 'recall': 0.8090897850317065, 'f1-score': 0.6736629324016601, 'support': 509517}, '2': {'precision': 0.5002288649076394, 'recall': 0.41665374276261374, 'f1-score': 0.45463230965030726, 'support': 309504}, 'accuracy': 0.5594495507726395, 'macro avg': {'precision': 0.5508718578060396, 'recall': 0.509126415491024, 'f1-score': 0.5080218721106218, 'support': 1140959}, 'weighted avg': {'precision': 0.5557311299485947, 'recall': 0.5594495507726395, 'f1-score': 0.5358358691674523, 'support': 1140959}}
[[ 97108 156133  68697]
 [ 37131 412245  60141]
 [ 34552 145996 128956]]
Evaluating performance on  train set...
2425/2425 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.858344
{'0': {'precision': 0.545957474450026, 'recall': 0.33921460474627346, 'f1-score': 0.4184423644993196, 'support': 148664}, '1': {'precision': 0.6657305666376921, 'recall': 0.8318886953077373, 'f1-score': 0.7395921601426229, 'support': 323149}, '2': {'precision': 0.5207038838848482, 'recall': 0.4355375896430394, 'f1-score': 0.47432812899923216, 'support': 148924}, 'accuracy': 0.61880474339374, 'macro avg': {'precision': 0.5774639749908554, 'recall': 0.5355469632323501, 'f1-score': 0.5441208845470582, 'support': 620737}, 'weighted avg': {'precision': 0.602251346486047, 'recall': 0.61880474339374, 'f1-score': 0.5990373135755351, 'support': 620737}}
[[ 50429  68975  29260]
 [ 23881 268824  30444]
 [ 18058  66004  64862]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8768251
{'0': {'precision': 0.5605397891024989, 'recall': 0.33091134730478994, 'f1-score': 0.416150631828022, 'support': 49959}, '1': {'precision': 0.6428089387874047, 'recall': 0.8229363022306001, 'f1-score': 0.721804576024525, 'support': 101856}, '2': {'precision': 0.5172872662166412, 'recall': 0.43273220393871314, 'f1-score': 0.4712468866406577, 'support': 49407}, 'accuracy': 0.6049686415998251, 'macro avg': {'precision': 0.5735453313688482, 'recall': 0.5288599511580344, 'f1-score': 0.5364006981644015, 'support': 201222}, 'weighted avg': {'precision': 0.5915633805193629, 'recall': 0.6049686415998251, 'f1-score': 0.584396791798636, 'support': 201222}}
[[16532 24076  9351]
 [ 7435 83821 10600]
 [ 5526 22501 21380]]
training model: results/AAL/W4/deepVOL_L2/h100
Epoch 1/50
2425/2425 - 61s - loss: 3.0804 - accuracy100: 0.4649 - val_loss: 3.3257 - val_accuracy100: 0.4365 - 61s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 60s - loss: 2.9515 - accuracy100: 0.5034 - val_loss: 3.2472 - val_accuracy100: 0.4707 - 60s/epoch - 25ms/step
Epoch 3/50
2425/2425 - 57s - loss: 2.9095 - accuracy100: 0.5121 - val_loss: 3.3184 - val_accuracy100: 0.4735 - 57s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 59s - loss: 2.8932 - accuracy100: 0.5166 - val_loss: 3.3212 - val_accuracy100: 0.4700 - 59s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 59s - loss: 2.8828 - accuracy100: 0.5196 - val_loss: 3.3069 - val_accuracy100: 0.4749 - 59s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 57s - loss: 2.8750 - accuracy100: 0.5211 - val_loss: 3.2438 - val_accuracy100: 0.4827 - 57s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 59s - loss: 2.8707 - accuracy100: 0.5218 - val_loss: 3.2725 - val_accuracy100: 0.4827 - 59s/epoch - 24ms/step
Epoch 8/50
2425/2425 - 59s - loss: 2.8669 - accuracy100: 0.5232 - val_loss: 3.2423 - val_accuracy100: 0.4867 - 59s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 60s - loss: 2.8626 - accuracy100: 0.5248 - val_loss: 3.2164 - val_accuracy100: 0.4879 - 60s/epoch - 25ms/step
Epoch 10/50
2425/2425 - 60s - loss: 2.8588 - accuracy100: 0.5259 - val_loss: 3.2324 - val_accuracy100: 0.4871 - 60s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 58s - loss: 2.8555 - accuracy100: 0.5265 - val_loss: 3.2392 - val_accuracy100: 0.4862 - 58s/epoch - 24ms/step
Epoch 12/50
2425/2425 - 59s - loss: 2.8508 - accuracy100: 0.5280 - val_loss: 3.2463 - val_accuracy100: 0.4874 - 59s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 60s - loss: 2.8479 - accuracy100: 0.5279 - val_loss: 3.2297 - val_accuracy100: 0.4879 - 60s/epoch - 25ms/step
Epoch 14/50
2425/2425 - 60s - loss: 2.8444 - accuracy100: 0.5290 - val_loss: 3.2262 - val_accuracy100: 0.4907 - 60s/epoch - 25ms/step
Epoch 15/50
2425/2425 - 59s - loss: 2.8403 - accuracy100: 0.5301 - val_loss: 3.2478 - val_accuracy100: 0.4879 - 59s/epoch - 24ms/step
Epoch 16/50
2425/2425 - 59s - loss: 2.8370 - accuracy100: 0.5309 - val_loss: 3.2450 - val_accuracy100: 0.4893 - 59s/epoch - 24ms/step
Epoch 17/50
2425/2425 - 60s - loss: 2.8338 - accuracy100: 0.5312 - val_loss: 3.2688 - val_accuracy100: 0.4873 - 60s/epoch - 25ms/step
Epoch 18/50
2425/2425 - 59s - loss: 2.8294 - accuracy100: 0.5321 - val_loss: 3.2429 - val_accuracy100: 0.4875 - 59s/epoch - 25ms/step
Epoch 19/50
2425/2425 - 59s - loss: 2.8262 - accuracy100: 0.5323 - val_loss: 3.2637 - val_accuracy100: 0.4875 - 59s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h100
Evaluating performance on  test set...
4457/4457 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913707
{'0': {'precision': 0.5562986421185835, 'recall': 0.2156058538469553, 'f1-score': 0.3107670556520083, 'support': 393519}, '1': {'precision': 0.41487068965517243, 'recall': 0.839952205431298, 'f1-score': 0.5554115279681, 'support': 374938}, '2': {'precision': 0.49247835073123514, 'recall': 0.3032037411879668, 'f1-score': 0.3753289910939785, 'support': 372502}, 'accuracy': 0.449375481502841, 'macro avg': {'precision': 0.48788256083499704, 'recall': 0.45292060015540675, 'f1-score': 0.413835858238029, 'support': 1140959}, 'weighted avg': {'precision': 0.48898693343922134, 'recall': 0.449375481502841, 'f1-score': 0.41223955311883714, 'support': 1140959}}
[[ 84845 230392  78282]
 [ 21896 314930  38112]
 [ 45776 213782 112944]]
Evaluating performance on  train set...
2425/2425 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0112188
{'0': {'precision': 0.529749804090811, 'recall': 0.24836667429861506, 'f1-score': 0.338181238173263, 'support': 187807}, '1': {'precision': 0.4917020710066143, 'recall': 0.8522882757775645, 'f1-score': 0.6236233932739407, 'support': 244835}, '2': {'precision': 0.5261350101105232, 'recall': 0.30294266195273667, 'f1-score': 0.38449652156897146, 'support': 188095}, 'accuracy': 0.5031067907986796, 'macro avg': {'precision': 0.5158622950693162, 'recall': 0.4678658706763054, 'f1-score': 0.44876705100539177, 'support': 620737}, 'weighted avg': {'precision': 0.5136474267500184, 'recall': 0.5031067907986796, 'f1-score': 0.4648015351337957, 'support': 620737}}
[[ 46645 109906  31256]
 [ 16100 208670  20065]
 [ 25306 105807  56982]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0259416
{'0': {'precision': 0.5524580105836338, 'recall': 0.2272576701632621, 'f1-score': 0.32204128619807093, 'support': 63395}, '1': {'precision': 0.46531501219238647, 'recall': 0.8458442395464769, 'f1-score': 0.6003603637246298, 'support': 76027}, '2': {'precision': 0.5292477600627995, 'recall': 0.31637540453074436, 'f1-score': 0.39601794557588893, 'support': 61800}, 'accuracy': 0.4883462046893481, 'macro avg': {'precision': 0.5156735942796066, 'recall': 0.46315910474682775, 'f1-score': 0.43947319849952987, 'support': 201222}, 'weighted avg': {'precision': 0.5124046654182, 'recall': 0.4883462046893481, 'f1-score': 0.44991757237284724, 'support': 201222}}
[[14407 38708 10280]
 [ 4609 64307  7111]
 [ 7062 35186 19552]]
training model: results/AAL/W4/deepVOL_L2/h200
Epoch 1/50
2425/2425 - 62s - loss: 3.2017 - accuracy200: 0.4170 - val_loss: 3.3876 - val_accuracy200: 0.3685 - 62s/epoch - 26ms/step
Epoch 2/50
2425/2425 - 59s - loss: 3.1269 - accuracy200: 0.4418 - val_loss: 3.3231 - val_accuracy200: 0.3948 - 59s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 60s - loss: 3.1046 - accuracy200: 0.4469 - val_loss: 3.2446 - val_accuracy200: 0.4039 - 60s/epoch - 25ms/step
Epoch 4/50
2425/2425 - 58s - loss: 3.0913 - accuracy200: 0.4506 - val_loss: 3.2593 - val_accuracy200: 0.4011 - 58s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 60s - loss: 3.0839 - accuracy200: 0.4536 - val_loss: 3.2573 - val_accuracy200: 0.4032 - 60s/epoch - 25ms/step
Epoch 6/50
2425/2425 - 59s - loss: 3.0780 - accuracy200: 0.4550 - val_loss: 3.2429 - val_accuracy200: 0.4129 - 59s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 60s - loss: 3.0723 - accuracy200: 0.4576 - val_loss: 3.2533 - val_accuracy200: 0.4094 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 61s - loss: 3.0681 - accuracy200: 0.4591 - val_loss: 3.2704 - val_accuracy200: 0.4073 - 61s/epoch - 25ms/step
Epoch 9/50
2425/2425 - 59s - loss: 3.0651 - accuracy200: 0.4609 - val_loss: 3.2622 - val_accuracy200: 0.4073 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 58s - loss: 3.0610 - accuracy200: 0.4621 - val_loss: 3.2833 - val_accuracy200: 0.4021 - 58s/epoch - 24ms/step
Epoch 11/50
2425/2425 - 59s - loss: 3.0578 - accuracy200: 0.4635 - val_loss: 3.2938 - val_accuracy200: 0.3988 - 59s/epoch - 24ms/step
Epoch 12/50
2425/2425 - 58s - loss: 3.0551 - accuracy200: 0.4647 - val_loss: 3.2697 - val_accuracy200: 0.4045 - 58s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 60s - loss: 3.0509 - accuracy200: 0.4663 - val_loss: 3.2805 - val_accuracy200: 0.4037 - 60s/epoch - 25ms/step
Epoch 14/50
2425/2425 - 60s - loss: 3.0483 - accuracy200: 0.4672 - val_loss: 3.2940 - val_accuracy200: 0.4028 - 60s/epoch - 25ms/step
Epoch 15/50
2425/2425 - 61s - loss: 3.0447 - accuracy200: 0.4693 - val_loss: 3.2932 - val_accuracy200: 0.4035 - 61s/epoch - 25ms/step
Epoch 16/50
2425/2425 - 59s - loss: 3.0414 - accuracy200: 0.4701 - val_loss: 3.2950 - val_accuracy200: 0.4078 - 59s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h200
Evaluating performance on  test set...
4457/4457 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195906
{'0': {'precision': 0.49020005334755934, 'recall': 0.10881530955426082, 'f1-score': 0.17809650253418485, 'support': 422220}, '1': {'precision': 0.34445044215024345, 'recall': 0.7520044917892191, 'f1-score': 0.47248322147651, 'support': 324147}, '2': {'precision': 0.42521704814522493, 'recall': 0.3659095977617387, 'f1-score': 0.39334030740395665, 'support': 394592}, 'accuracy': 0.38045977112236284, 'macro avg': {'precision': 0.41995584788100926, 'recall': 0.4089097997017395, 'f1-score': 0.3479733438048838, 'support': 1140959}, 'weighted avg': {'precision': 0.42631864024719734, 'recall': 0.38045977112236284, 'f1-score': 0.336172345080824, 'support': 1140959}}
[[ 45944 244379 131897]
 [ 17113 243760  63274]
 [ 30668 219539 144385]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.070933
{'0': {'precision': 0.4927180001672101, 'recall': 0.14286337632114807, 'f1-score': 0.22150226448424257, 'support': 206260}, '1': {'precision': 0.40004337497667336, 'recall': 0.7747465275742835, 'f1-score': 0.527638541954239, 'support': 204756}, '2': {'precision': 0.45443761785996717, 'recall': 0.35621134745685934, 'f1-score': 0.399373447987362, 'support': 209721}, 'accuracy': 0.42337737238154, 'macro avg': {'precision': 0.4490663310012835, 'recall': 0.42460708378409695, 'f1-score': 0.38283808480861453, 'support': 620737}, 'weighted avg': {'precision': 0.4492150583200658, 'recall': 0.42337737238154, 'f1-score': 0.3825794390446511, 'support': 620737}}
[[ 29467 120484  56309]
 [ 12746 158634  33376]
 [ 17592 117424  74705]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0816729
{'0': {'precision': 0.5115899628671092, 'recall': 0.13143972246313965, 'f1-score': 0.20914506520689102, 'support': 69180}, '1': {'precision': 0.3819884897797182, 'recall': 0.7474410152063496, 'f1-score': 0.5055895269915317, 'support': 64381}, '2': {'precision': 0.4510465783933325, 'recall': 0.38313060699664503, 'f1-score': 0.41432384483833334, 'support': 67661}, 'accuracy': 0.41316058880241724, 'macro avg': {'precision': 0.4482083436800533, 'recall': 0.42067044822204475, 'f1-score': 0.3763528123455853, 'support': 201222}, 'weighted avg': {'precision': 0.4497662140935183, 'recall': 0.41316058880241724, 'f1-score': 0.37298397100645553, 'support': 201222}}
[[ 9093 40923 19164]
 [ 3874 48121 12386]
 [ 4807 36931 25923]]
training model: results/AAL/W4/deepVOL_L2/h300
Epoch 1/50
2425/2425 - 62s - loss: 3.2472 - accuracy300: 0.3977 - val_loss: 3.3053 - val_accuracy300: 0.3406 - 62s/epoch - 26ms/step
Epoch 2/50
2425/2425 - 59s - loss: 3.2200 - accuracy300: 0.4094 - val_loss: 3.3307 - val_accuracy300: 0.3471 - 59s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 59s - loss: 3.2089 - accuracy300: 0.4154 - val_loss: 3.3408 - val_accuracy300: 0.3503 - 59s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 59s - loss: 3.2027 - accuracy300: 0.4174 - val_loss: 3.3876 - val_accuracy300: 0.3467 - 59s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 58s - loss: 3.1954 - accuracy300: 0.4210 - val_loss: 3.4314 - val_accuracy300: 0.3478 - 58s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 60s - loss: 3.1916 - accuracy300: 0.4233 - val_loss: 3.4157 - val_accuracy300: 0.3445 - 60s/epoch - 25ms/step
Epoch 7/50
2425/2425 - 60s - loss: 3.1847 - accuracy300: 0.4257 - val_loss: 3.4327 - val_accuracy300: 0.3418 - 60s/epoch - 25ms/step
Epoch 8/50
2425/2425 - 59s - loss: 3.1794 - accuracy300: 0.4291 - val_loss: 3.4368 - val_accuracy300: 0.3471 - 59s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 59s - loss: 3.1758 - accuracy300: 0.4309 - val_loss: 3.4555 - val_accuracy300: 0.3516 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 60s - loss: 3.1705 - accuracy300: 0.4330 - val_loss: 3.4585 - val_accuracy300: 0.3538 - 60s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 58s - loss: 3.1679 - accuracy300: 0.4342 - val_loss: 3.5032 - val_accuracy300: 0.3559 - 58s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h300
Evaluating performance on  test set...
4457/4457 - 44s - 44s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040457
{'0': {'precision': 0.42397418567130335, 'recall': 0.02484178468409313, 'f1-score': 0.04693360364926507, 'support': 391397}, '1': {'precision': 0.3383289720873715, 'recall': 0.9013948598864029, 'f1-score': 0.4919934400303734, 'support': 382404}, '2': {'precision': 0.37783758719406474, 'recall': 0.10208956362111135, 'f1-score': 0.16074637298922295, 'support': 367158}, 'accuracy': 0.3434856116652746, 'macro avg': {'precision': 0.38004691498424653, 'recall': 0.3427754027305358, 'f1-score': 0.2332244722229538, 'support': 1140959}, 'weighted avg': {'precision': 0.38042267025396065, 'recall': 0.3434856116652746, 'f1-score': 0.23272461843314562, 'support': 1140959}}
[[  9723 351188  30486]
 [  6472 344697  31235]
 [  6738 322937  37483]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991462
{'0': {'precision': 0.4305267523849025, 'recall': 0.025217433555220835, 'f1-score': 0.047644183324535835, 'support': 205810}, '1': {'precision': 0.3329578377276632, 'recall': 0.8917043167185725, 'f1-score': 0.4848683208003446, 'support': 205179}, '2': {'precision': 0.408356705977765, 'recall': 0.11522875069130575, 'f1-score': 0.17973926688332453, 'support': 209748}, 'accuracy': 0.3420417987005769, 'macro avg': {'precision': 0.3906137653634436, 'recall': 0.3440501669883664, 'f1-score': 0.23741725700273497, 'support': 620737}, 'weighted avg': {'precision': 0.3907849370359512, 'recall': 0.3420417987005769, 'f1-score': 0.2367998013873189, 'support': 620737}}
[[  5190 184239  16381]
 [  3584 182959  18636]
 [  3281 182298  24169]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101875
{'0': {'precision': 0.42965481171548114, 'recall': 0.023951833926176454, 'f1-score': 0.04537420602043635, 'support': 68596}, '1': {'precision': 0.33283034895938124, 'recall': 0.8969651329166353, 'f1-score': 0.4855070986886889, 'support': 66395}, '2': {'precision': 0.4002491064659374, 'recall': 0.11159426854494119, 'f1-score': 0.17452802342467855, 'support': 66231}, 'accuracy': 0.340857361521106, 'macro avg': {'precision': 0.3875780890469333, 'recall': 0.3441704117959177, 'f1-score': 0.2351364427112679, 'support': 201222}, 'weighted avg': {'precision': 0.38802800416425026, 'recall': 0.340857361521106, 'f1-score': 0.23311018861284172, 'support': 201222}}
[[ 1643 61589  5364]
 [ 1130 59554  5711]
 [ 1051 57789  7391]]
training model: results/AAL/W4/deepVOL_L2/h500
Epoch 1/50
2425/2425 - 61s - loss: 3.2662 - accuracy500: 0.3864 - val_loss: 3.9425 - val_accuracy500: 0.3106 - 61s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 60s - loss: 3.2522 - accuracy500: 0.3935 - val_loss: 3.7764 - val_accuracy500: 0.3106 - 60s/epoch - 25ms/step
Epoch 3/50
2425/2425 - 58s - loss: 3.2460 - accuracy500: 0.3981 - val_loss: 3.8757 - val_accuracy500: 0.3106 - 58s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 59s - loss: 3.2403 - accuracy500: 0.4017 - val_loss: 3.8408 - val_accuracy500: 0.3106 - 59s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 59s - loss: 3.2281 - accuracy500: 0.4059 - val_loss: 4.4510 - val_accuracy500: 0.3106 - 59s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 60s - loss: 3.2203 - accuracy500: 0.4095 - val_loss: 4.6368 - val_accuracy500: 0.3106 - 60s/epoch - 25ms/step
Epoch 7/50
2425/2425 - 59s - loss: 3.2140 - accuracy500: 0.4120 - val_loss: 4.9370 - val_accuracy500: 0.3106 - 59s/epoch - 24ms/step
Epoch 8/50
2425/2425 - 59s - loss: 3.2076 - accuracy500: 0.4149 - val_loss: 4.9963 - val_accuracy500: 0.3108 - 59s/epoch - 24ms/step
Epoch 9/50
2425/2425 - 59s - loss: 3.2012 - accuracy500: 0.4179 - val_loss: 5.0455 - val_accuracy500: 0.3110 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 60s - loss: 3.1953 - accuracy500: 0.4213 - val_loss: 5.0573 - val_accuracy500: 0.3116 - 60s/epoch - 25ms/step
Epoch 11/50
2425/2425 - 59s - loss: 3.1881 - accuracy500: 0.4237 - val_loss: 5.0600 - val_accuracy500: 0.3122 - 59s/epoch - 24ms/step
Epoch 12/50
2425/2425 - 58s - loss: 3.1851 - accuracy500: 0.4250 - val_loss: 5.1253 - val_accuracy500: 0.3134 - 58s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h500
Evaluating performance on  test set...
4457/4457 - 47s - 47s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2661465
{'0': {'precision': 0.3, 'recall': 1.4690687573147382e-05, 'f1-score': 2.9379936441404164e-05, 'support': 408422}, '1': {'precision': 0.3096116695474737, 'recall': 0.9999348910415735, 'f1-score': 0.47282245682795027, 'support': 353254}, '2': {'precision': 0.2909090909090909, 'recall': 4.2184859326676916e-05, 'f1-score': 8.435748593602539e-05, 'support': 379283}, 'accuracy': 0.30961059950445197, 'macro avg': {'precision': 0.30017358681885487, 'recall': 0.33333058886282446, 'f1-score': 0.15764539808344258, 'support': 1140959}, 'weighted avg': {'precision': 0.29995384009556525, 'recall': 0.30961059950445197, 'f1-score': 0.14642981819420356, 'support': 1140959}}
[[     6 408394     22]
 [     6 353231     17]
 [     8 379259     16]]
Evaluating performance on  train set...
2425/2425 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2443793
{'0': {'precision': 0.2857142857142857, 'recall': 9.68429207824908e-06, 'f1-score': 1.936792768015804e-05, 'support': 206520}, '1': {'precision': 0.3294167496383081, 'recall': 0.9999364241001565, 'f1-score': 0.4955730548950888, 'support': 204480}, '2': {'precision': 0.4166666666666667, 'recall': 7.151813938408578e-05, 'f1-score': 0.00014301173172905947, 'support': 209737}, 'accuracy': 0.3294213169184373, 'macro avg': {'precision': 0.3439325673397535, 'recall': 0.3333392088438729, 'f1-score': 0.16524514485149933, 'support': 620737}, 'weighted avg': {'precision': 0.3443572203983687, 'recall': 0.3294213169184373, 'f1-score': 0.16330390001071296, 'support': 620737}}
[[     2 206507     11]
 [     3 204467     10]
 [     2 209720     15]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2630147
{'0': {'precision': 0.25, 'recall': 1.3989144423927032e-05, 'f1-score': 2.7976723366159355e-05, 'support': 71484}, '1': {'precision': 0.31059024671477703, 'recall': 0.9999039969279017, 'f1-score': 0.4739592418715064, 'support': 62498}, '2': {'precision': 0.21428571428571427, 'recall': 4.46162998215348e-05, 'f1-score': 8.92140244446427e-05, 'support': 67240}, 'accuracy': 0.3105823418910457, 'macro avg': {'precision': 0.25829198700016376, 'recall': 0.3333208674573824, 'f1-score': 0.1580254775397724, 'support': 201222}, 'weighted avg': {'precision': 0.25688463819935975, 'recall': 0.3105823418910457, 'f1-score': 0.14724783243175285, 'support': 201222}}
[[    1 71476     7]
 [    2 62492     4]
 [    1 67236     3]]
training model: results/AAL/W4/deepVOL_L2/h1000
Epoch 1/50
2425/2425 - 61s - loss: 3.2091 - accuracy1000: 0.4260 - val_loss: 3.4031 - val_accuracy1000: 0.3497 - 61s/epoch - 25ms/step
Epoch 2/50
2425/2425 - 59s - loss: 3.2164 - accuracy1000: 0.4170 - val_loss: 3.3649 - val_accuracy1000: 0.3497 - 59s/epoch - 24ms/step
Epoch 3/50
2425/2425 - 58s - loss: 3.2066 - accuracy1000: 0.4232 - val_loss: 3.4291 - val_accuracy1000: 0.3497 - 58s/epoch - 24ms/step
Epoch 4/50
2425/2425 - 57s - loss: 3.2029 - accuracy1000: 0.4262 - val_loss: 3.4598 - val_accuracy1000: 0.3497 - 57s/epoch - 24ms/step
Epoch 5/50
2425/2425 - 59s - loss: 3.2043 - accuracy1000: 0.4272 - val_loss: 3.4133 - val_accuracy1000: 0.3497 - 59s/epoch - 24ms/step
Epoch 6/50
2425/2425 - 58s - loss: 3.2030 - accuracy1000: 0.4253 - val_loss: 3.4137 - val_accuracy1000: 0.3497 - 58s/epoch - 24ms/step
Epoch 7/50
2425/2425 - 58s - loss: 3.1990 - accuracy1000: 0.4274 - val_loss: 3.4344 - val_accuracy1000: 0.3497 - 58s/epoch - 24ms/step
Epoch 8/50
2425/2425 - 60s - loss: 3.1961 - accuracy1000: 0.4295 - val_loss: 3.3992 - val_accuracy1000: 0.3498 - 60s/epoch - 25ms/step
Epoch 9/50
2425/2425 - 59s - loss: 3.1850 - accuracy1000: 0.4345 - val_loss: 3.3578 - val_accuracy1000: 0.3525 - 59s/epoch - 24ms/step
Epoch 10/50
2425/2425 - 59s - loss: 3.1897 - accuracy1000: 0.4323 - val_loss: 3.4433 - val_accuracy1000: 0.3498 - 59s/epoch - 24ms/step
Epoch 11/50
2425/2425 - 59s - loss: 3.1845 - accuracy1000: 0.4330 - val_loss: 3.4243 - val_accuracy1000: 0.3543 - 59s/epoch - 24ms/step
Epoch 12/50
2425/2425 - 58s - loss: 3.1878 - accuracy1000: 0.4296 - val_loss: 3.3951 - val_accuracy1000: 0.3527 - 58s/epoch - 24ms/step
Epoch 13/50
2425/2425 - 60s - loss: 3.1899 - accuracy1000: 0.4301 - val_loss: 3.3510 - val_accuracy1000: 0.3567 - 60s/epoch - 25ms/step
Epoch 14/50
2425/2425 - 61s - loss: 3.1866 - accuracy1000: 0.4313 - val_loss: 3.5033 - val_accuracy1000: 0.3500 - 61s/epoch - 25ms/step
Epoch 15/50
2425/2425 - 61s - loss: 3.1787 - accuracy1000: 0.4363 - val_loss: 3.3945 - val_accuracy1000: 0.3468 - 61s/epoch - 25ms/step
Epoch 16/50
2425/2425 - 59s - loss: 3.1832 - accuracy1000: 0.4328 - val_loss: 3.6449 - val_accuracy1000: 0.3501 - 59s/epoch - 24ms/step
Epoch 17/50
2425/2425 - 60s - loss: 3.1692 - accuracy1000: 0.4402 - val_loss: 3.5865 - val_accuracy1000: 0.3498 - 60s/epoch - 25ms/step
Epoch 18/50
2425/2425 - 58s - loss: 3.1705 - accuracy1000: 0.4400 - val_loss: 3.6624 - val_accuracy1000: 0.3500 - 58s/epoch - 24ms/step
Epoch 19/50
2425/2425 - 58s - loss: 3.1609 - accuracy1000: 0.4433 - val_loss: 3.6341 - val_accuracy1000: 0.3504 - 58s/epoch - 24ms/step
Epoch 20/50
2425/2425 - 58s - loss: 3.1548 - accuracy1000: 0.4463 - val_loss: 3.6402 - val_accuracy1000: 0.3513 - 58s/epoch - 24ms/step
Epoch 21/50
2425/2425 - 60s - loss: 3.1470 - accuracy1000: 0.4478 - val_loss: 3.5935 - val_accuracy1000: 0.3537 - 60s/epoch - 25ms/step
Epoch 22/50
2425/2425 - 59s - loss: 3.1362 - accuracy1000: 0.4527 - val_loss: 3.6216 - val_accuracy1000: 0.3541 - 59s/epoch - 24ms/step
Epoch 23/50
2425/2425 - 58s - loss: 3.1294 - accuracy1000: 0.4552 - val_loss: 3.6804 - val_accuracy1000: 0.3544 - 58s/epoch - 24ms/step
testing model: results/AAL/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
4457/4457 - 48s - 48s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0866575
{'0': {'precision': 0.36788366336633666, 'recall': 0.03691848238757773, 'f1-score': 0.06710293751715539, 'support': 354267}, '1': {'precision': 0.4204962669803033, 'recall': 0.9375247234167443, 'f1-score': 0.5805884433100281, 'support': 470202}, '2': {'precision': 0.31165439887837365, 'recall': 0.056188189200290686, 'f1-score': 0.09521081515192077, 'support': 316490}, 'accuracy': 0.4134136283600024, 'macro avg': {'precision': 0.36667810974167114, 'recall': 0.343543798334871, 'f1-score': 0.24763406532636809, 'support': 1140959}, 'weighted avg': {'precision': 0.37396850210874444, 'recall': 0.4134136283600024, 'f1-score': 0.2865129022813995, 'support': 1140959}}
[[ 13079 319853  21335]
 [ 11434 440826  17942]
 [ 11039 287668  17783]]
Evaluating performance on  train set...
2425/2425 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1284357
{'0': {'precision': 0.38973078980210374, 'recall': 0.03214642850140193, 'f1-score': 0.0593938351046728, 'support': 204004}, '1': {'precision': 0.3349741840647412, 'recall': 0.9374121642723298, 'f1-score': 0.49357473108679084, 'support': 204928}, '2': {'precision': 0.36980313537318826, 'recall': 0.0531243360638323, 'f1-score': 0.09290267181875228, 'support': 211805}, 'accuracy': 0.33816576102278423, 'macro avg': {'precision': 0.36483603641334444, 'recall': 0.3408943096125214, 'f1-score': 0.21529041267007196, 'support': 620737}, 'weighted avg': {'precision': 0.3648540085777484, 'recall': 0.33816576102278423, 'f1-score': 0.21416656785952562, 'support': 620737}}
[[  6558 186802  10644]
 [  4295 192102   8531]
 [  5974 194579  11252]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1158695
{'0': {'precision': 0.39951256092988374, 'recall': 0.03137283768862716, 'f1-score': 0.05817715229528113, 'support': 67925}, '1': {'precision': 0.35557955988839796, 'recall': 0.93098645594986, 'f1-score': 0.5146098221054326, 'support': 70363}, '2': {'precision': 0.360830046304236, 'recall': 0.06686369847777036, 'f1-score': 0.11282106279157059, 'support': 62934}, 'accuracy': 0.3570484340678455, 'macro avg': {'precision': 0.3719740557075059, 'recall': 0.34307433070541915, 'f1-score': 0.22853601239742807, 'support': 201222}, 'weighted avg': {'precision': 0.3720518303550332, 'recall': 0.3570484340678455, 'f1-score': 0.2348722045710023, 'support': 201222}}
[[ 2131 61818  3976]
 [ 1378 65507  3478]
 [ 1825 56901  4208]]
training model: results/AAL/W4/deepVOL_L3/h10
Epoch 1/50
2425/2425 - 91s - loss: 2.9765 - accuracy10: 0.4118 - val_loss: 2.7970 - val_accuracy10: 0.6427 - 91s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 89s - loss: 2.3915 - accuracy10: 0.5590 - val_loss: 2.4521 - val_accuracy10: 0.6212 - 89s/epoch - 37ms/step
Epoch 3/50
2425/2425 - 89s - loss: 2.2585 - accuracy10: 0.6065 - val_loss: 2.4902 - val_accuracy10: 0.6826 - 89s/epoch - 37ms/step
Epoch 4/50
2425/2425 - 89s - loss: 2.1944 - accuracy10: 0.6252 - val_loss: 2.4605 - val_accuracy10: 0.6998 - 89s/epoch - 37ms/step
Epoch 5/50
2425/2425 - 89s - loss: 2.1613 - accuracy10: 0.6336 - val_loss: 2.4176 - val_accuracy10: 0.7040 - 89s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 90s - loss: 2.1353 - accuracy10: 0.6408 - val_loss: 2.4062 - val_accuracy10: 0.7081 - 90s/epoch - 37ms/step
Epoch 7/50
2425/2425 - 88s - loss: 2.1174 - accuracy10: 0.6451 - val_loss: 2.4073 - val_accuracy10: 0.7155 - 88s/epoch - 36ms/step
Epoch 8/50
2425/2425 - 89s - loss: 2.1022 - accuracy10: 0.6485 - val_loss: 2.3823 - val_accuracy10: 0.7210 - 89s/epoch - 37ms/step
Epoch 9/50
2425/2425 - 89s - loss: 2.0899 - accuracy10: 0.6500 - val_loss: 2.3870 - val_accuracy10: 0.7224 - 89s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 89s - loss: 2.0813 - accuracy10: 0.6534 - val_loss: 2.3324 - val_accuracy10: 0.7156 - 89s/epoch - 37ms/step
Epoch 11/50
2425/2425 - 89s - loss: 2.0695 - accuracy10: 0.6541 - val_loss: 2.3005 - val_accuracy10: 0.7023 - 89s/epoch - 37ms/step
Epoch 12/50
2425/2425 - 89s - loss: 2.0621 - accuracy10: 0.6547 - val_loss: 2.3259 - val_accuracy10: 0.7218 - 89s/epoch - 37ms/step
Epoch 13/50
2425/2425 - 89s - loss: 2.0545 - accuracy10: 0.6564 - val_loss: 2.2826 - val_accuracy10: 0.7023 - 89s/epoch - 37ms/step
Epoch 14/50
2425/2425 - 90s - loss: 2.0446 - accuracy10: 0.6568 - val_loss: 2.3007 - val_accuracy10: 0.7190 - 90s/epoch - 37ms/step
Epoch 15/50
2425/2425 - 91s - loss: 2.0376 - accuracy10: 0.6578 - val_loss: 2.2898 - val_accuracy10: 0.7111 - 91s/epoch - 37ms/step
Epoch 16/50
2425/2425 - 90s - loss: 2.0299 - accuracy10: 0.6592 - val_loss: 2.2948 - val_accuracy10: 0.7147 - 90s/epoch - 37ms/step
Epoch 17/50
2425/2425 - 90s - loss: 2.0252 - accuracy10: 0.6604 - val_loss: 2.2977 - val_accuracy10: 0.7205 - 90s/epoch - 37ms/step
Epoch 18/50
2425/2425 - 90s - loss: 2.0198 - accuracy10: 0.6599 - val_loss: 2.2897 - val_accuracy10: 0.7173 - 90s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 89s - loss: 2.0149 - accuracy10: 0.6609 - val_loss: 2.2636 - val_accuracy10: 0.7144 - 89s/epoch - 37ms/step
Epoch 20/50
2425/2425 - 90s - loss: 2.0105 - accuracy10: 0.6621 - val_loss: 2.2818 - val_accuracy10: 0.7198 - 90s/epoch - 37ms/step
Epoch 21/50
2425/2425 - 89s - loss: 2.0051 - accuracy10: 0.6623 - val_loss: 2.2641 - val_accuracy10: 0.7148 - 89s/epoch - 37ms/step
Epoch 22/50
2425/2425 - 90s - loss: 2.0000 - accuracy10: 0.6626 - val_loss: 2.2842 - val_accuracy10: 0.7171 - 90s/epoch - 37ms/step
Epoch 23/50
2425/2425 - 89s - loss: 1.9959 - accuracy10: 0.6637 - val_loss: 2.2762 - val_accuracy10: 0.7173 - 89s/epoch - 37ms/step
Epoch 24/50
2425/2425 - 89s - loss: 1.9924 - accuracy10: 0.6643 - val_loss: 2.2726 - val_accuracy10: 0.7190 - 89s/epoch - 37ms/step
Epoch 25/50
2425/2425 - 89s - loss: 1.9872 - accuracy10: 0.6646 - val_loss: 2.2447 - val_accuracy10: 0.7132 - 89s/epoch - 37ms/step
Epoch 26/50
2425/2425 - 90s - loss: 1.9848 - accuracy10: 0.6649 - val_loss: 2.2519 - val_accuracy10: 0.7178 - 90s/epoch - 37ms/step
Epoch 27/50
2425/2425 - 89s - loss: 1.9809 - accuracy10: 0.6656 - val_loss: 2.2712 - val_accuracy10: 0.7196 - 89s/epoch - 37ms/step
Epoch 28/50
2425/2425 - 90s - loss: 1.9779 - accuracy10: 0.6656 - val_loss: 2.2468 - val_accuracy10: 0.7138 - 90s/epoch - 37ms/step
Epoch 29/50
2425/2425 - 90s - loss: 1.9738 - accuracy10: 0.6667 - val_loss: 2.2432 - val_accuracy10: 0.7133 - 90s/epoch - 37ms/step
Epoch 30/50
2425/2425 - 89s - loss: 1.9710 - accuracy10: 0.6666 - val_loss: 2.2477 - val_accuracy10: 0.7121 - 89s/epoch - 37ms/step
Epoch 31/50
2425/2425 - 89s - loss: 1.9669 - accuracy10: 0.6679 - val_loss: 2.2354 - val_accuracy10: 0.7075 - 89s/epoch - 37ms/step
Epoch 32/50
2425/2425 - 89s - loss: 1.9635 - accuracy10: 0.6673 - val_loss: 2.2414 - val_accuracy10: 0.7090 - 89s/epoch - 37ms/step
Epoch 33/50
2425/2425 - 89s - loss: 1.9604 - accuracy10: 0.6682 - val_loss: 2.2586 - val_accuracy10: 0.7160 - 89s/epoch - 37ms/step
Epoch 34/50
2425/2425 - 89s - loss: 1.9576 - accuracy10: 0.6676 - val_loss: 2.2281 - val_accuracy10: 0.7117 - 89s/epoch - 37ms/step
Epoch 35/50
2425/2425 - 89s - loss: 1.9542 - accuracy10: 0.6689 - val_loss: 2.2311 - val_accuracy10: 0.7034 - 89s/epoch - 37ms/step
Epoch 36/50
2425/2425 - 89s - loss: 1.9509 - accuracy10: 0.6688 - val_loss: 2.2266 - val_accuracy10: 0.7022 - 89s/epoch - 37ms/step
Epoch 37/50
2425/2425 - 90s - loss: 1.9486 - accuracy10: 0.6686 - val_loss: 2.2462 - val_accuracy10: 0.7099 - 90s/epoch - 37ms/step
Epoch 38/50
2425/2425 - 89s - loss: 1.9452 - accuracy10: 0.6691 - val_loss: 2.2677 - val_accuracy10: 0.7221 - 89s/epoch - 37ms/step
Epoch 39/50
2425/2425 - 90s - loss: 1.9427 - accuracy10: 0.6693 - val_loss: 2.2541 - val_accuracy10: 0.7135 - 90s/epoch - 37ms/step
Epoch 40/50
2425/2425 - 89s - loss: 1.9403 - accuracy10: 0.6692 - val_loss: 2.2948 - val_accuracy10: 0.7245 - 89s/epoch - 37ms/step
Epoch 41/50
2425/2425 - 90s - loss: 1.9374 - accuracy10: 0.6695 - val_loss: 2.2127 - val_accuracy10: 0.6938 - 90s/epoch - 37ms/step
Epoch 42/50
2425/2425 - 89s - loss: 1.9337 - accuracy10: 0.6697 - val_loss: 2.2400 - val_accuracy10: 0.7009 - 89s/epoch - 37ms/step
Epoch 43/50
2425/2425 - 88s - loss: 1.9314 - accuracy10: 0.6702 - val_loss: 2.2409 - val_accuracy10: 0.7000 - 88s/epoch - 36ms/step
Epoch 44/50
2425/2425 - 89s - loss: 1.9271 - accuracy10: 0.6707 - val_loss: 2.2442 - val_accuracy10: 0.7019 - 89s/epoch - 36ms/step
Epoch 45/50
2425/2425 - 89s - loss: 1.9256 - accuracy10: 0.6711 - val_loss: 2.2538 - val_accuracy10: 0.7035 - 89s/epoch - 37ms/step
Epoch 46/50
2425/2425 - 89s - loss: 1.9208 - accuracy10: 0.6712 - val_loss: 2.2437 - val_accuracy10: 0.6953 - 89s/epoch - 37ms/step
Epoch 47/50
2425/2425 - 91s - loss: 1.9203 - accuracy10: 0.6707 - val_loss: 2.2541 - val_accuracy10: 0.6990 - 91s/epoch - 37ms/step
Epoch 48/50
2425/2425 - 90s - loss: 1.9164 - accuracy10: 0.6717 - val_loss: 2.2624 - val_accuracy10: 0.6971 - 90s/epoch - 37ms/step
Epoch 49/50
2425/2425 - 90s - loss: 1.9136 - accuracy10: 0.6712 - val_loss: 2.2517 - val_accuracy10: 0.6940 - 90s/epoch - 37ms/step
Epoch 50/50
2425/2425 - 89s - loss: 1.9105 - accuracy10: 0.6716 - val_loss: 2.2521 - val_accuracy10: 0.6950 - 89s/epoch - 37ms/step
testing model: results/AAL/W4/deepVOL_L3/h10
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8138437
{'0': {'precision': 0.38150167273082464, 'recall': 0.7256075612786363, 'f1-score': 0.5000780227826526, 'support': 172246}, '1': {'precision': 0.8973456507952569, 'recall': 0.6208938617327165, 'f1-score': 0.7339506077056591, 'support': 799900}, '2': {'precision': 0.401135900139294, 'recall': 0.6175353793842892, 'f1-score': 0.48635043562439495, 'support': 168813}, 'accuracy': 0.6362051572405318, 'macro avg': {'precision': 0.5599944078884586, 'recall': 0.6546789341318807, 'f1-score': 0.5734596887042356, 'support': 1140959}, 'weighted avg': {'precision': 0.7460529939310127, 'recall': 0.6362051572405318, 'f1-score': 0.6620095957041737, 'support': 1140959}}
[[124983  26945  20318]
 [167931 496653 135316]
 [ 34694  29871 104248]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6711677
{'0': {'precision': 0.3861593570729902, 'recall': 0.7342725010681881, 'f1-score': 0.5061373342226765, 'support': 79574}, '1': {'precision': 0.9239567822821939, 'recall': 0.7093724703329257, 'f1-score': 0.8025687461104054, 'support': 464488}, '2': {'precision': 0.41885902708835626, 'recall': 0.6162895337463319, 'f1-score': 0.49874664232074345, 'support': 76675}, 'accuracy': 0.7010666353060958, 'macro avg': {'precision': 0.5763250554811802, 'recall': 0.6866448350491486, 'f1-score': 0.6024842408846084, 'support': 620737}, 'weighted avg': {'precision': 0.7926240879316322, 'recall': 0.7010666353060958, 'f1-score': 0.7270395075155955, 'support': 620737}}
[[ 58429  13161   7984]
 [ 77415 329495  57578]
 [ 15464  13957  47254]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67697525
{'0': {'precision': 0.4036851634891895, 'recall': 0.7017589335308276, 'f1-score': 0.5125354969574036, 'support': 27005}, '1': {'precision': 0.9146267661839901, 'recall': 0.7035452858829482, 'f1-score': 0.7953188276477452, 'support': 148225}, '2': {'precision': 0.40481867858917037, 'recall': 0.6270390889504462, 'f1-score': 0.4920002415021433, 'support': 25992}, 'accuracy': 0.6934231843436602, 'macro avg': {'precision': 0.5743768694207833, 'recall': 0.6774477694547407, 'f1-score': 0.599951522035764, 'support': 201222}, 'weighted avg': {'precision': 0.7802035431092882, 'recall': 0.6934231843436602, 'f1-score': 0.7181879943572046, 'support': 201222}}
[[ 18951   4757   3297]
 [ 23277 104283  20665]
 [  4717   4977  16298]]
training model: results/AAL/W4/deepVOL_L3/h20
Epoch 1/50
2425/2425 - 92s - loss: 2.9740 - accuracy20: 0.4163 - val_loss: 2.9925 - val_accuracy20: 0.5010 - 92s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 88s - loss: 2.5919 - accuracy20: 0.5216 - val_loss: 2.7630 - val_accuracy20: 0.6507 - 88s/epoch - 36ms/step
Epoch 3/50
2425/2425 - 89s - loss: 2.4048 - accuracy20: 0.5988 - val_loss: 2.6356 - val_accuracy20: 0.6686 - 89s/epoch - 37ms/step
Epoch 4/50
2425/2425 - 89s - loss: 2.3395 - accuracy20: 0.6157 - val_loss: 2.6275 - val_accuracy20: 0.6875 - 89s/epoch - 37ms/step
Epoch 5/50
2425/2425 - 89s - loss: 2.3055 - accuracy20: 0.6235 - val_loss: 2.6580 - val_accuracy20: 0.7043 - 89s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 89s - loss: 2.2831 - accuracy20: 0.6280 - val_loss: 2.6280 - val_accuracy20: 0.7053 - 89s/epoch - 37ms/step
Epoch 7/50
2425/2425 - 88s - loss: 2.2662 - accuracy20: 0.6309 - val_loss: 2.5690 - val_accuracy20: 0.6964 - 88s/epoch - 36ms/step
Epoch 8/50
2425/2425 - 89s - loss: 2.2519 - accuracy20: 0.6338 - val_loss: 2.5223 - val_accuracy20: 0.7004 - 89s/epoch - 37ms/step
Epoch 9/50
2425/2425 - 89s - loss: 2.2388 - accuracy20: 0.6357 - val_loss: 2.5127 - val_accuracy20: 0.7003 - 89s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 88s - loss: 2.2273 - accuracy20: 0.6370 - val_loss: 2.4464 - val_accuracy20: 0.6826 - 88s/epoch - 36ms/step
Epoch 11/50
2425/2425 - 89s - loss: 2.2178 - accuracy20: 0.6383 - val_loss: 2.4510 - val_accuracy20: 0.6930 - 89s/epoch - 37ms/step
Epoch 12/50
2425/2425 - 89s - loss: 2.2079 - accuracy20: 0.6400 - val_loss: 2.4640 - val_accuracy20: 0.6978 - 89s/epoch - 37ms/step
Epoch 13/50
2425/2425 - 88s - loss: 2.2000 - accuracy20: 0.6406 - val_loss: 2.4167 - val_accuracy20: 0.6880 - 88s/epoch - 36ms/step
Epoch 14/50
2425/2425 - 88s - loss: 2.1930 - accuracy20: 0.6416 - val_loss: 2.4175 - val_accuracy20: 0.6907 - 88s/epoch - 36ms/step
Epoch 15/50
2425/2425 - 89s - loss: 2.1858 - accuracy20: 0.6426 - val_loss: 2.4259 - val_accuracy20: 0.6899 - 89s/epoch - 37ms/step
Epoch 16/50
2425/2425 - 89s - loss: 2.1806 - accuracy20: 0.6436 - val_loss: 2.4170 - val_accuracy20: 0.6938 - 89s/epoch - 37ms/step
Epoch 17/50
2425/2425 - 89s - loss: 2.1761 - accuracy20: 0.6439 - val_loss: 2.3999 - val_accuracy20: 0.6848 - 89s/epoch - 37ms/step
Epoch 18/50
2425/2425 - 89s - loss: 2.1715 - accuracy20: 0.6449 - val_loss: 2.4219 - val_accuracy20: 0.6944 - 89s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 89s - loss: 2.1659 - accuracy20: 0.6453 - val_loss: 2.4193 - val_accuracy20: 0.6909 - 89s/epoch - 37ms/step
Epoch 20/50
2425/2425 - 89s - loss: 2.1618 - accuracy20: 0.6457 - val_loss: 2.4269 - val_accuracy20: 0.6880 - 89s/epoch - 37ms/step
Epoch 21/50
2425/2425 - 89s - loss: 2.1586 - accuracy20: 0.6465 - val_loss: 2.4475 - val_accuracy20: 0.6949 - 89s/epoch - 37ms/step
Epoch 22/50
2425/2425 - 88s - loss: 2.1556 - accuracy20: 0.6468 - val_loss: 2.4494 - val_accuracy20: 0.6981 - 88s/epoch - 36ms/step
Epoch 23/50
2425/2425 - 88s - loss: 2.1518 - accuracy20: 0.6480 - val_loss: 2.4351 - val_accuracy20: 0.6989 - 88s/epoch - 36ms/step
Epoch 24/50
2425/2425 - 89s - loss: 2.1474 - accuracy20: 0.6490 - val_loss: 2.4714 - val_accuracy20: 0.7005 - 89s/epoch - 36ms/step
Epoch 25/50
2425/2425 - 89s - loss: 2.1446 - accuracy20: 0.6491 - val_loss: 2.4488 - val_accuracy20: 0.6987 - 89s/epoch - 37ms/step
Epoch 26/50
2425/2425 - 89s - loss: 2.1410 - accuracy20: 0.6495 - val_loss: 2.4653 - val_accuracy20: 0.6989 - 89s/epoch - 37ms/step
Epoch 27/50
2425/2425 - 89s - loss: 2.1379 - accuracy20: 0.6501 - val_loss: 2.4457 - val_accuracy20: 0.6934 - 89s/epoch - 37ms/step
testing model: results/AAL/W4/deepVOL_L3/h20
Evaluating performance on  test set...
4457/4457 - 78s - 78s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80587494
{'0': {'precision': 0.4573082944064781, 'recall': 0.6350366238006687, 'f1-score': 0.5317139494594337, 'support': 229086}, '1': {'precision': 0.8061751236776077, 'recall': 0.6766418959630448, 'f1-score': 0.7357507459627807, 'support': 687102}, '2': {'precision': 0.4763061672219062, 'recall': 0.5215886391037989, 'f1-score': 0.49791998912745716, 'support': 224771}, 'accuracy': 0.637742460509098, 'macro avg': {'precision': 0.579929861768664, 'recall': 0.6110890529558375, 'f1-score': 0.5884615615165573, 'support': 1140959}, 'weighted avg': {'precision': 0.6711435566695816, 'recall': 0.637742460509098, 'f1-score': 0.6479303855393139, 'support': 1140959}}
[[145478  52592  31016]
 [124294 464922  97886]
 [ 48346  59187 117238]]
Evaluating performance on  train set...
2425/2425 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69101053
{'0': {'precision': 0.4507312526556739, 'recall': 0.6277908763757505, 'f1-score': 0.5247272364615538, 'support': 104761}, '1': {'precision': 0.8507086605593556, 'recall': 0.7559285356389893, 'f1-score': 0.8005229227279136, 'support': 413129}, '2': {'precision': 0.4939009673047288, 'recall': 0.5173121238344337, 'f1-score': 0.5053355432186124, 'support': 102847}, 'accuracy': 0.6947676713326256, 'macro avg': {'precision': 0.5984469601732527, 'recall': 0.6336771786163912, 'f1-score': 0.6101952341360266, 'support': 620737}, 'weighted avg': {'precision': 0.7240871863157449, 'recall': 0.6947676713326256, 'f1-score': 0.7050690214632181, 'support': 620737}}
[[ 65768  26623  12370]
 [ 58685 312296  42148]
 [ 21461  28182  53204]]
Evaluating performance on  val set...
787/787 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7000036
{'0': {'precision': 0.47168682706367143, 'recall': 0.602172129988404, 'f1-score': 0.5290018013541213, 'support': 35357}, '1': {'precision': 0.8365079093921897, 'recall': 0.7459440932287303, 'f1-score': 0.7886345151912902, 'support': 131290}, '2': {'precision': 0.47531275635767023, 'recall': 0.5362545191612437, 'f1-score': 0.503947922753897, 'support': 34575}, 'accuracy': 0.684651777638628, 'macro avg': {'precision': 0.5945024976045105, 'recall': 0.6281235807927926, 'f1-score': 0.6071947464331028, 'support': 201222}, 'weighted avg': {'precision': 0.7103422743022993, 'recall': 0.684651777638628, 'f1-score': 0.6940977707167116, 'support': 201222}}
[[21291  9324  4742]
 [17630 97935 15725]
 [ 6217  9817 18541]]
training model: results/AAL/W4/deepVOL_L3/h30
Epoch 1/50
2425/2425 - 93s - loss: 3.0175 - accuracy30: 0.4422 - val_loss: 3.2492 - val_accuracy30: 0.5023 - 93s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 89s - loss: 2.6318 - accuracy30: 0.5428 - val_loss: 2.9049 - val_accuracy30: 0.6498 - 89s/epoch - 37ms/step
Epoch 3/50
2425/2425 - 88s - loss: 2.4733 - accuracy30: 0.5977 - val_loss: 2.9055 - val_accuracy30: 0.6655 - 88s/epoch - 36ms/step
Epoch 4/50
2425/2425 - 89s - loss: 2.4287 - accuracy30: 0.6079 - val_loss: 2.7950 - val_accuracy30: 0.6691 - 89s/epoch - 37ms/step
Epoch 5/50
2425/2425 - 87s - loss: 2.4057 - accuracy30: 0.6136 - val_loss: 2.7332 - val_accuracy30: 0.6674 - 87s/epoch - 36ms/step
Epoch 6/50
2425/2425 - 88s - loss: 2.3901 - accuracy30: 0.6167 - val_loss: 2.6846 - val_accuracy30: 0.6590 - 88s/epoch - 36ms/step
Epoch 7/50
2425/2425 - 88s - loss: 2.3785 - accuracy30: 0.6186 - val_loss: 2.6436 - val_accuracy30: 0.6559 - 88s/epoch - 36ms/step
Epoch 8/50
2425/2425 - 89s - loss: 2.3678 - accuracy30: 0.6208 - val_loss: 2.6083 - val_accuracy30: 0.6500 - 89s/epoch - 37ms/step
Epoch 9/50
2425/2425 - 88s - loss: 2.3569 - accuracy30: 0.6223 - val_loss: 2.6102 - val_accuracy30: 0.6420 - 88s/epoch - 36ms/step
Epoch 10/50
2425/2425 - 90s - loss: 2.3459 - accuracy30: 0.6233 - val_loss: 2.5640 - val_accuracy30: 0.6453 - 90s/epoch - 37ms/step
Epoch 11/50
2425/2425 - 90s - loss: 2.3355 - accuracy30: 0.6246 - val_loss: 2.6210 - val_accuracy30: 0.6537 - 90s/epoch - 37ms/step
Epoch 12/50
2425/2425 - 88s - loss: 2.3289 - accuracy30: 0.6249 - val_loss: 2.5794 - val_accuracy30: 0.6517 - 88s/epoch - 36ms/step
Epoch 13/50
2425/2425 - 88s - loss: 2.3232 - accuracy30: 0.6260 - val_loss: 2.5713 - val_accuracy30: 0.6456 - 88s/epoch - 36ms/step
Epoch 14/50
2425/2425 - 88s - loss: 2.3179 - accuracy30: 0.6269 - val_loss: 2.5760 - val_accuracy30: 0.6478 - 88s/epoch - 36ms/step
Epoch 15/50
2425/2425 - 88s - loss: 2.3119 - accuracy30: 0.6277 - val_loss: 2.5829 - val_accuracy30: 0.6489 - 88s/epoch - 36ms/step
Epoch 16/50
2425/2425 - 88s - loss: 2.3066 - accuracy30: 0.6286 - val_loss: 2.5508 - val_accuracy30: 0.6462 - 88s/epoch - 36ms/step
Epoch 17/50
2425/2425 - 88s - loss: 2.3024 - accuracy30: 0.6291 - val_loss: 2.5499 - val_accuracy30: 0.6501 - 88s/epoch - 36ms/step
Epoch 18/50
2425/2425 - 89s - loss: 2.2974 - accuracy30: 0.6295 - val_loss: 2.5539 - val_accuracy30: 0.6492 - 89s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 88s - loss: 2.2934 - accuracy30: 0.6304 - val_loss: 2.5303 - val_accuracy30: 0.6450 - 88s/epoch - 36ms/step
Epoch 20/50
2425/2425 - 89s - loss: 2.2890 - accuracy30: 0.6307 - val_loss: 2.5576 - val_accuracy30: 0.6464 - 89s/epoch - 37ms/step
Epoch 21/50
2425/2425 - 88s - loss: 2.2855 - accuracy30: 0.6313 - val_loss: 2.5299 - val_accuracy30: 0.6385 - 88s/epoch - 36ms/step
Epoch 22/50
2425/2425 - 89s - loss: 2.2816 - accuracy30: 0.6320 - val_loss: 2.5465 - val_accuracy30: 0.6469 - 89s/epoch - 37ms/step
Epoch 23/50
2425/2425 - 88s - loss: 2.2788 - accuracy30: 0.6327 - val_loss: 2.5316 - val_accuracy30: 0.6393 - 88s/epoch - 36ms/step
Epoch 24/50
2425/2425 - 90s - loss: 2.2753 - accuracy30: 0.6335 - val_loss: 2.5332 - val_accuracy30: 0.6458 - 90s/epoch - 37ms/step
Epoch 25/50
2425/2425 - 89s - loss: 2.2712 - accuracy30: 0.6335 - val_loss: 2.5307 - val_accuracy30: 0.6438 - 89s/epoch - 37ms/step
Epoch 26/50
2425/2425 - 89s - loss: 2.2690 - accuracy30: 0.6340 - val_loss: 2.5467 - val_accuracy30: 0.6460 - 89s/epoch - 37ms/step
Epoch 27/50
2425/2425 - 88s - loss: 2.2640 - accuracy30: 0.6345 - val_loss: 2.5423 - val_accuracy30: 0.6527 - 88s/epoch - 36ms/step
Epoch 28/50
2425/2425 - 89s - loss: 2.2615 - accuracy30: 0.6349 - val_loss: 2.5545 - val_accuracy30: 0.6399 - 89s/epoch - 37ms/step
Epoch 29/50
2425/2425 - 88s - loss: 2.2582 - accuracy30: 0.6352 - val_loss: 2.5682 - val_accuracy30: 0.6430 - 88s/epoch - 36ms/step
Epoch 30/50
2425/2425 - 89s - loss: 2.2548 - accuracy30: 0.6368 - val_loss: 2.5403 - val_accuracy30: 0.6381 - 89s/epoch - 37ms/step
Epoch 31/50
2425/2425 - 89s - loss: 2.2517 - accuracy30: 0.6370 - val_loss: 2.5471 - val_accuracy30: 0.6342 - 89s/epoch - 37ms/step
testing model: results/AAL/W4/deepVOL_L3/h30
Evaluating performance on  test set...
4457/4457 - 74s - 74s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89156175
{'0': {'precision': 0.47026317229304593, 'recall': 0.57796191002757, 'f1-score': 0.5185798467489457, 'support': 267682}, '1': {'precision': 0.7740196594329496, 'recall': 0.6012730875889494, 'f1-score': 0.6767972731472365, 'support': 611584}, '2': {'precision': 0.4626383640611132, 'recall': 0.5955642680545524, 'f1-score': 0.520752586137767, 'support': 261693}, 'accuracy': 0.5944946312707118, 'macro avg': {'precision': 0.5689737319290362, 'recall': 0.5915997552236906, 'f1-score': 0.5720432353446497, 'support': 1140959}, 'weighted avg': {'precision': 0.6313357861997084, 'recall': 0.5944946312707118, 'f1-score': 0.6038868886279712, 'support': 1140959}}
[[154710  52470  60502]
 [123329 367729 120526]
 [ 50947  54891 155855]]
Evaluating performance on  train set...
2425/2425 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77614695
{'0': {'precision': 0.45381227404135327, 'recall': 0.5722534395720006, 'f1-score': 0.5061968864072487, 'support': 122617}, '1': {'precision': 0.8173643391774366, 'recall': 0.7056783080081699, 'f1-score': 0.7574263070870632, 'support': 376503}, '2': {'precision': 0.4874416032780145, 'recall': 0.5653732619617323, 'f1-score': 0.5235230967191771, 'support': 121617}, 'accuracy': 0.6518332240546318, 'macro avg': {'precision': 0.5862060721656014, 'recall': 0.6144350031806343, 'f1-score': 0.595715430071163, 'support': 620737}, 'weighted avg': {'precision': 0.6809106124901741, 'recall': 0.6518332240546318, 'f1-score': 0.661972669538781, 'support': 620737}}
[[ 70168  29171  23278]
 [ 61789 265690  49024]
 [ 22662  30196  68759]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79386246
{'0': {'precision': 0.4708096753395312, 'recall': 0.5480582994383111, 'f1-score': 0.5065055658108184, 'support': 41304}, '1': {'precision': 0.7994764449046172, 'recall': 0.6860802360475448, 'f1-score': 0.7384504341942031, 'support': 119298}, '2': {'precision': 0.4727168859821921, 'recall': 0.590768094534712, 'f1-score': 0.5251904053225949, 'support': 40620}, 'accuracy': 0.6385087117710787, 'macro avg': {'precision': 0.5810010020754469, 'recall': 0.6083022100068559, 'f1-score': 0.5900488017758722, 'support': 201222}, 'weighted avg': {'precision': 0.6660505494580695, 'recall': 0.6385087117710787, 'f1-score': 0.6477900033443356, 'support': 201222}}
[[22637 10371  8296]
 [18979 81848 18471]
 [ 6465 10158 23997]]
training model: results/AAL/W4/deepVOL_L3/h50
Epoch 1/50
2425/2425 - 91s - loss: 3.1409 - accuracy50: 0.4432 - val_loss: 3.1689 - val_accuracy50: 0.4671 - 91s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 89s - loss: 2.9534 - accuracy50: 0.4768 - val_loss: 3.2815 - val_accuracy50: 0.5583 - 89s/epoch - 37ms/step
Epoch 3/50
2425/2425 - 90s - loss: 2.7395 - accuracy50: 0.5487 - val_loss: 3.0865 - val_accuracy50: 0.5898 - 90s/epoch - 37ms/step
Epoch 4/50
2425/2425 - 90s - loss: 2.6448 - accuracy50: 0.5716 - val_loss: 3.0027 - val_accuracy50: 0.5949 - 90s/epoch - 37ms/step
Epoch 5/50
2425/2425 - 90s - loss: 2.6158 - accuracy50: 0.5795 - val_loss: 3.0371 - val_accuracy50: 0.5933 - 90s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 90s - loss: 2.6011 - accuracy50: 0.5821 - val_loss: 2.9992 - val_accuracy50: 0.5934 - 90s/epoch - 37ms/step
Epoch 7/50
2425/2425 - 89s - loss: 2.5895 - accuracy50: 0.5837 - val_loss: 3.0078 - val_accuracy50: 0.5941 - 89s/epoch - 37ms/step
Epoch 8/50
2425/2425 - 90s - loss: 2.5814 - accuracy50: 0.5854 - val_loss: 3.0242 - val_accuracy50: 0.5955 - 90s/epoch - 37ms/step
Epoch 9/50
2425/2425 - 90s - loss: 2.5746 - accuracy50: 0.5867 - val_loss: 3.0587 - val_accuracy50: 0.5945 - 90s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 90s - loss: 2.5677 - accuracy50: 0.5884 - val_loss: 3.0163 - val_accuracy50: 0.5962 - 90s/epoch - 37ms/step
Epoch 11/50
2425/2425 - 90s - loss: 2.5633 - accuracy50: 0.5886 - val_loss: 3.0243 - val_accuracy50: 0.5975 - 90s/epoch - 37ms/step
Epoch 12/50
2425/2425 - 89s - loss: 2.5568 - accuracy50: 0.5892 - val_loss: 3.0694 - val_accuracy50: 0.5976 - 89s/epoch - 37ms/step
Epoch 13/50
2425/2425 - 89s - loss: 2.5491 - accuracy50: 0.5912 - val_loss: 2.9989 - val_accuracy50: 0.5985 - 89s/epoch - 37ms/step
Epoch 14/50
2425/2425 - 90s - loss: 2.5428 - accuracy50: 0.5920 - val_loss: 3.0096 - val_accuracy50: 0.5984 - 90s/epoch - 37ms/step
Epoch 15/50
2425/2425 - 90s - loss: 2.5372 - accuracy50: 0.5926 - val_loss: 3.0036 - val_accuracy50: 0.5985 - 90s/epoch - 37ms/step
Epoch 16/50
2425/2425 - 90s - loss: 2.5308 - accuracy50: 0.5930 - val_loss: 3.0708 - val_accuracy50: 0.5989 - 90s/epoch - 37ms/step
Epoch 17/50
2425/2425 - 90s - loss: 2.5265 - accuracy50: 0.5937 - val_loss: 2.9224 - val_accuracy50: 0.6036 - 90s/epoch - 37ms/step
Epoch 18/50
2425/2425 - 90s - loss: 2.5220 - accuracy50: 0.5943 - val_loss: 2.9688 - val_accuracy50: 0.6011 - 90s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 90s - loss: 2.5171 - accuracy50: 0.5949 - val_loss: 2.9209 - val_accuracy50: 0.6007 - 90s/epoch - 37ms/step
Epoch 20/50
2425/2425 - 89s - loss: 2.5144 - accuracy50: 0.5959 - val_loss: 2.9432 - val_accuracy50: 0.5961 - 89s/epoch - 37ms/step
Epoch 21/50
2425/2425 - 90s - loss: 2.5115 - accuracy50: 0.5961 - val_loss: 2.8986 - val_accuracy50: 0.5973 - 90s/epoch - 37ms/step
Epoch 22/50
2425/2425 - 91s - loss: 2.5071 - accuracy50: 0.5965 - val_loss: 2.8949 - val_accuracy50: 0.5973 - 91s/epoch - 37ms/step
Epoch 23/50
2425/2425 - 91s - loss: 2.5028 - accuracy50: 0.5966 - val_loss: 2.8672 - val_accuracy50: 0.5935 - 91s/epoch - 37ms/step
Epoch 24/50
2425/2425 - 90s - loss: 2.5006 - accuracy50: 0.5976 - val_loss: 2.8683 - val_accuracy50: 0.5927 - 90s/epoch - 37ms/step
Epoch 25/50
2425/2425 - 90s - loss: 2.4968 - accuracy50: 0.5981 - val_loss: 2.9271 - val_accuracy50: 0.5959 - 90s/epoch - 37ms/step
Epoch 26/50
2425/2425 - 89s - loss: 2.4937 - accuracy50: 0.5987 - val_loss: 2.9263 - val_accuracy50: 0.5938 - 89s/epoch - 37ms/step
Epoch 27/50
2425/2425 - 90s - loss: 2.4897 - accuracy50: 0.5998 - val_loss: 2.9173 - val_accuracy50: 0.5927 - 90s/epoch - 37ms/step
Epoch 28/50
2425/2425 - 90s - loss: 2.4866 - accuracy50: 0.5994 - val_loss: 2.9319 - val_accuracy50: 0.5930 - 90s/epoch - 37ms/step
Epoch 29/50
2425/2425 - 90s - loss: 2.4841 - accuracy50: 0.6008 - val_loss: 2.9224 - val_accuracy50: 0.5894 - 90s/epoch - 37ms/step
Epoch 30/50
2425/2425 - 89s - loss: 2.4810 - accuracy50: 0.6008 - val_loss: 2.9713 - val_accuracy50: 0.5907 - 89s/epoch - 37ms/step
Epoch 31/50
2425/2425 - 90s - loss: 2.4784 - accuracy50: 0.6011 - val_loss: 2.9345 - val_accuracy50: 0.5894 - 90s/epoch - 37ms/step
Epoch 32/50
2425/2425 - 90s - loss: 2.4756 - accuracy50: 0.6009 - val_loss: 2.9239 - val_accuracy50: 0.5914 - 90s/epoch - 37ms/step
Epoch 33/50
2425/2425 - 91s - loss: 2.4721 - accuracy50: 0.6017 - val_loss: 2.8955 - val_accuracy50: 0.5878 - 91s/epoch - 37ms/step
testing model: results/AAL/W4/deepVOL_L3/h50
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9152843
{'0': {'precision': 0.5394407037892563, 'recall': 0.34093521112760844, 'f1-score': 0.4178086363359522, 'support': 321938}, '1': {'precision': 0.6102519384815299, 'recall': 0.700496744956498, 'f1-score': 0.6522676725311637, 'support': 509517}, '2': {'precision': 0.4473348382412995, 'recall': 0.5096573873035567, 'f1-score': 0.4764667858782592, 'support': 309504}, 'accuracy': 0.5472729519640933, 'macro avg': {'precision': 0.5323424935040286, 'recall': 0.5170297811292212, 'f1-score': 0.515514364915125, 'support': 1140959}, 'weighted avg': {'precision': 0.546077571596205, 'recall': 0.5472729519640933, 'f1-score': 0.5384227834359073, 'support': 1140959}}
[[109760 113993  98185]
 [ 55904 356915  96698]
 [ 37806 113957 157741]]
Evaluating performance on  train set...
2425/2425 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8250941
{'0': {'precision': 0.5301617070518639, 'recall': 0.3574839907442286, 'f1-score': 0.4270269618773277, 'support': 148664}, '1': {'precision': 0.6785821818377332, 'recall': 0.7811226400205478, 'f1-score': 0.7262508110005482, 'support': 323149}, '2': {'precision': 0.48607538683221785, 'recall': 0.48473718138110716, 'f1-score': 0.4854053617896839, 'support': 148924}, 'accuracy': 0.6085556362839657, 'macro avg': {'precision': 0.5649397585739383, 'recall': 0.5411146040486279, 'f1-score': 0.5462277115558533, 'support': 620737}, 'weighted avg': {'precision': 0.5968508473064135, 'recall': 0.6085556362839657, 'f1-score': 0.5968055193805332, 'support': 620737}}
[[ 53145  59515  36004]
 [ 30409 252419  40321]
 [ 16689  60046  72189]]
Evaluating performance on  val set...
787/787 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84857965
{'0': {'precision': 0.5477301654645736, 'recall': 0.3359354670830081, 'f1-score': 0.41645161290322585, 'support': 49959}, '1': {'precision': 0.6581547629067281, 'recall': 0.7677309142318567, 'f1-score': 0.7087324964879683, 'support': 101856}, '2': {'precision': 0.472269978944115, 'recall': 0.49482866800250974, 'f1-score': 0.4832862197797853, 'support': 49407}, 'accuracy': 0.5935186013457773, 'macro avg': {'precision': 0.5593849691051389, 'recall': 0.5328316831057915, 'f1-score': 0.5361567763903266, 'support': 201222}, 'weighted avg': {'precision': 0.5850975823556283, 'recall': 0.5935186013457773, 'f1-score': 0.5808106745384233, 'support': 201222}}
[[16783 20709 12467]
 [ 8806 78198 14852]
 [ 5052 19907 24448]]
training model: results/AAL/W4/deepVOL_L3/h100
Epoch 1/50
2425/2425 - 91s - loss: 3.2285 - accuracy100: 0.4049 - val_loss: 3.2449 - val_accuracy100: 0.4134 - 91s/epoch - 37ms/step
Epoch 2/50
2425/2425 - 89s - loss: 3.1227 - accuracy100: 0.4402 - val_loss: 3.2170 - val_accuracy100: 0.4385 - 89s/epoch - 37ms/step
Epoch 3/50
2425/2425 - 88s - loss: 3.0087 - accuracy100: 0.4825 - val_loss: 3.2877 - val_accuracy100: 0.4660 - 88s/epoch - 36ms/step
Epoch 4/50
2425/2425 - 88s - loss: 2.9376 - accuracy100: 0.5055 - val_loss: 3.1432 - val_accuracy100: 0.4915 - 88s/epoch - 36ms/step
Epoch 5/50
2425/2425 - 89s - loss: 2.8954 - accuracy100: 0.5156 - val_loss: 3.0972 - val_accuracy100: 0.4967 - 89s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 89s - loss: 2.8749 - accuracy100: 0.5197 - val_loss: 3.1099 - val_accuracy100: 0.4931 - 89s/epoch - 37ms/step
Epoch 7/50
2425/2425 - 88s - loss: 2.8629 - accuracy100: 0.5220 - val_loss: 3.1199 - val_accuracy100: 0.4954 - 88s/epoch - 36ms/step
Epoch 8/50
2425/2425 - 88s - loss: 2.8523 - accuracy100: 0.5249 - val_loss: 3.1037 - val_accuracy100: 0.4951 - 88s/epoch - 36ms/step
Epoch 9/50
2425/2425 - 89s - loss: 2.8455 - accuracy100: 0.5267 - val_loss: 3.1128 - val_accuracy100: 0.4944 - 89s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 89s - loss: 2.8404 - accuracy100: 0.5288 - val_loss: 3.0978 - val_accuracy100: 0.4983 - 89s/epoch - 37ms/step
Epoch 11/50
2425/2425 - 88s - loss: 2.8352 - accuracy100: 0.5296 - val_loss: 3.0937 - val_accuracy100: 0.5003 - 88s/epoch - 36ms/step
Epoch 12/50
2425/2425 - 88s - loss: 2.8307 - accuracy100: 0.5306 - val_loss: 3.0913 - val_accuracy100: 0.5025 - 88s/epoch - 36ms/step
Epoch 13/50
2425/2425 - 88s - loss: 2.8280 - accuracy100: 0.5318 - val_loss: 3.0892 - val_accuracy100: 0.5039 - 88s/epoch - 36ms/step
Epoch 14/50
2425/2425 - 88s - loss: 2.8247 - accuracy100: 0.5322 - val_loss: 3.0892 - val_accuracy100: 0.5046 - 88s/epoch - 36ms/step
Epoch 15/50
2425/2425 - 88s - loss: 2.8216 - accuracy100: 0.5335 - val_loss: 3.1128 - val_accuracy100: 0.5047 - 88s/epoch - 36ms/step
Epoch 16/50
2425/2425 - 88s - loss: 2.8182 - accuracy100: 0.5342 - val_loss: 3.0856 - val_accuracy100: 0.5059 - 88s/epoch - 36ms/step
Epoch 17/50
2425/2425 - 89s - loss: 2.8150 - accuracy100: 0.5352 - val_loss: 3.0757 - val_accuracy100: 0.5065 - 89s/epoch - 37ms/step
Epoch 18/50
2425/2425 - 89s - loss: 2.8125 - accuracy100: 0.5362 - val_loss: 3.0717 - val_accuracy100: 0.5052 - 89s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 89s - loss: 2.8093 - accuracy100: 0.5366 - val_loss: 3.0629 - val_accuracy100: 0.5085 - 89s/epoch - 37ms/step
Epoch 20/50
2425/2425 - 88s - loss: 2.8064 - accuracy100: 0.5375 - val_loss: 3.0730 - val_accuracy100: 0.5058 - 88s/epoch - 36ms/step
Epoch 21/50
2425/2425 - 89s - loss: 2.8032 - accuracy100: 0.5381 - val_loss: 3.0765 - val_accuracy100: 0.5072 - 89s/epoch - 37ms/step
Epoch 22/50
2425/2425 - 89s - loss: 2.8005 - accuracy100: 0.5386 - val_loss: 3.0786 - val_accuracy100: 0.5084 - 89s/epoch - 37ms/step
Epoch 23/50
2425/2425 - 88s - loss: 2.7977 - accuracy100: 0.5390 - val_loss: 3.1071 - val_accuracy100: 0.5071 - 88s/epoch - 36ms/step
Epoch 24/50
2425/2425 - 88s - loss: 2.7945 - accuracy100: 0.5400 - val_loss: 3.1143 - val_accuracy100: 0.5067 - 88s/epoch - 36ms/step
Epoch 25/50
2425/2425 - 89s - loss: 2.7902 - accuracy100: 0.5417 - val_loss: 3.1243 - val_accuracy100: 0.5050 - 89s/epoch - 37ms/step
Epoch 26/50
2425/2425 - 88s - loss: 2.7864 - accuracy100: 0.5417 - val_loss: 3.1252 - val_accuracy100: 0.5050 - 88s/epoch - 36ms/step
Epoch 27/50
2425/2425 - 88s - loss: 2.7833 - accuracy100: 0.5425 - val_loss: 3.1350 - val_accuracy100: 0.5041 - 88s/epoch - 36ms/step
Epoch 28/50
2425/2425 - 90s - loss: 2.7800 - accuracy100: 0.5431 - val_loss: 3.1372 - val_accuracy100: 0.5027 - 90s/epoch - 37ms/step
Epoch 29/50
2425/2425 - 88s - loss: 2.7771 - accuracy100: 0.5437 - val_loss: 3.1575 - val_accuracy100: 0.5020 - 88s/epoch - 36ms/step
testing model: results/AAL/W4/deepVOL_L3/h100
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0321664
{'0': {'precision': 0.4951370101001702, 'recall': 0.4236796698507569, 'f1-score': 0.45662968369563134, 'support': 393519}, '1': {'precision': 0.4834834896590584, 'recall': 0.6270476718817511, 'f1-score': 0.5459859337280497, 'support': 374938}, '2': {'precision': 0.4673875097889364, 'recall': 0.39895356266543536, 'f1-score': 0.4304676716927627, 'support': 372502}, 'accuracy': 0.48243714278953054, 'macro avg': {'precision': 0.4820026698493883, 'recall': 0.4832269681326478, 'f1-score': 0.47769442970548126, 'support': 1140959}, 'weighted avg': {'precision': 0.4822477721765597, 'recall': 0.48243714278953054, 'f1-score': 0.47745221270812194, 'support': 1140959}}
[[166726 126582 100211]
 [ 70695 235104  69139]
 [ 99306 124585 148611]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97794425
{'0': {'precision': 0.48467830318941446, 'recall': 0.41679490114851947, 'f1-score': 0.44818069909249664, 'support': 187807}, '1': {'precision': 0.5497760032397272, 'recall': 0.7097473808891702, 'f1-score': 0.619602753377987, 'support': 244835}, '2': {'precision': 0.5019698514927563, 'recall': 0.38204630638772963, 'f1-score': 0.4338738064259041, 'support': 188095}, 'accuracy': 0.5218135861081263, 'macro avg': {'precision': 0.512141385973966, 'recall': 0.5028628628084731, 'f1-score': 0.5005524196321293, 'support': 620737}, 'weighted avg': {'precision': 0.5155942130996266, 'recall': 0.5218135861081263, 'f1-score': 0.5114588083156705, 'support': 620737}}
[[ 78277  71580  37950]
 [ 37717 173771  33347]
 [ 45509  70725  71861]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9996635
{'0': {'precision': 0.5007563991366965, 'recall': 0.3916081709914031, 'f1-score': 0.4395071345112063, 'support': 63395}, '1': {'precision': 0.5188822126092595, 'recall': 0.6894655845949466, 'f1-score': 0.5921332068139714, 'support': 76027}, '2': {'precision': 0.4967209228824273, 'recall': 0.40689320388349515, 'f1-score': 0.4473422045114922, 'support': 61800}, 'accuracy': 0.5088409816024093, 'macro avg': {'precision': 0.5054531782094611, 'recall': 0.49598898648994827, 'f1-score': 0.4929941819455566, 'support': 201222}, 'weighted avg': {'precision': 0.506365421949136, 'recall': 0.5088409816024093, 'f1-score': 0.499579640126795, 'support': 201222}}
[[24826 25389 13180]
 [11311 52418 12298]
 [13440 23214 25146]]
training model: results/AAL/W4/deepVOL_L3/h200
Epoch 1/50
2425/2425 - 92s - loss: 3.2637 - accuracy200: 0.3875 - val_loss: 3.3871 - val_accuracy200: 0.3207 - 92s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 88s - loss: 3.2045 - accuracy200: 0.4139 - val_loss: 3.3953 - val_accuracy200: 0.3246 - 88s/epoch - 36ms/step
Epoch 3/50
2425/2425 - 89s - loss: 3.1611 - accuracy200: 0.4331 - val_loss: 3.3744 - val_accuracy200: 0.3266 - 89s/epoch - 37ms/step
Epoch 4/50
2425/2425 - 88s - loss: 3.1360 - accuracy200: 0.4442 - val_loss: 3.3088 - val_accuracy200: 0.3751 - 88s/epoch - 36ms/step
Epoch 5/50
2425/2425 - 89s - loss: 3.1094 - accuracy200: 0.4532 - val_loss: 3.2458 - val_accuracy200: 0.4092 - 89s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 88s - loss: 3.0890 - accuracy200: 0.4575 - val_loss: 3.2428 - val_accuracy200: 0.4048 - 88s/epoch - 36ms/step
Epoch 7/50
2425/2425 - 89s - loss: 3.0749 - accuracy200: 0.4608 - val_loss: 3.2366 - val_accuracy200: 0.4072 - 89s/epoch - 37ms/step
Epoch 8/50
2425/2425 - 88s - loss: 3.0666 - accuracy200: 0.4629 - val_loss: 3.2375 - val_accuracy200: 0.4074 - 88s/epoch - 36ms/step
Epoch 9/50
2425/2425 - 88s - loss: 3.0603 - accuracy200: 0.4646 - val_loss: 3.2547 - val_accuracy200: 0.4070 - 88s/epoch - 36ms/step
Epoch 10/50
2425/2425 - 88s - loss: 3.0549 - accuracy200: 0.4667 - val_loss: 3.2660 - val_accuracy200: 0.4086 - 88s/epoch - 36ms/step
Epoch 11/50
2425/2425 - 88s - loss: 3.0520 - accuracy200: 0.4682 - val_loss: 3.2601 - val_accuracy200: 0.3952 - 88s/epoch - 36ms/step
Epoch 12/50
2425/2425 - 89s - loss: 3.0482 - accuracy200: 0.4694 - val_loss: 3.2212 - val_accuracy200: 0.4087 - 89s/epoch - 37ms/step
Epoch 13/50
2425/2425 - 88s - loss: 3.0452 - accuracy200: 0.4702 - val_loss: 3.2557 - val_accuracy200: 0.4020 - 88s/epoch - 36ms/step
Epoch 14/50
2425/2425 - 88s - loss: 3.0427 - accuracy200: 0.4710 - val_loss: 3.2373 - val_accuracy200: 0.3977 - 88s/epoch - 36ms/step
Epoch 15/50
2425/2425 - 88s - loss: 3.0385 - accuracy200: 0.4720 - val_loss: 3.2632 - val_accuracy200: 0.3937 - 88s/epoch - 36ms/step
Epoch 16/50
2425/2425 - 88s - loss: 3.0348 - accuracy200: 0.4733 - val_loss: 3.2580 - val_accuracy200: 0.3960 - 88s/epoch - 36ms/step
Epoch 17/50
2425/2425 - 88s - loss: 3.0306 - accuracy200: 0.4749 - val_loss: 3.2628 - val_accuracy200: 0.3947 - 88s/epoch - 36ms/step
Epoch 18/50
2425/2425 - 90s - loss: 3.0283 - accuracy200: 0.4755 - val_loss: 3.2734 - val_accuracy200: 0.3975 - 90s/epoch - 37ms/step
Epoch 19/50
2425/2425 - 88s - loss: 3.0234 - accuracy200: 0.4766 - val_loss: 3.2839 - val_accuracy200: 0.3948 - 88s/epoch - 36ms/step
Epoch 20/50
2425/2425 - 88s - loss: 3.0201 - accuracy200: 0.4782 - val_loss: 3.2722 - val_accuracy200: 0.3965 - 88s/epoch - 36ms/step
Epoch 21/50
2425/2425 - 89s - loss: 3.0180 - accuracy200: 0.4789 - val_loss: 3.2824 - val_accuracy200: 0.4026 - 89s/epoch - 37ms/step
Epoch 22/50
2425/2425 - 89s - loss: 3.0150 - accuracy200: 0.4796 - val_loss: 3.2828 - val_accuracy200: 0.4010 - 89s/epoch - 37ms/step
testing model: results/AAL/W4/deepVOL_L3/h200
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0897169
{'0': {'precision': 0.4579261232051876, 'recall': 0.1873265122448013, 'f1-score': 0.2658856355262716, 'support': 422220}, '1': {'precision': 0.34478767666094307, 'recall': 0.644247825832107, 'f1-score': 0.449182482332735, 'support': 324147}, '2': {'precision': 0.4096105737273106, 'recall': 0.37635836509609927, 'f1-score': 0.39228106414704594, 'support': 394592}, 'accuracy': 0.3825133067884122, 'macro avg': {'precision': 0.4041081245311471, 'recall': 0.40264423439100255, 'f1-score': 0.3691163940020175, 'support': 1140959}, 'weighted avg': {'precision': 0.4090738705549594, 'recall': 0.3825133067884122, 'f1-score': 0.3616732562664588, 'support': 1140959}}
[[ 79093 211156 131971]
 [ 33236 208831  82080]
 [ 60391 185693 148508]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0586019
{'0': {'precision': 0.46164736936828843, 'recall': 0.18654125860564336, 'f1-score': 0.26571364444674644, 'support': 206260}, '1': {'precision': 0.40035145723160265, 'recall': 0.7132147531696262, 'f1-score': 0.5128326687420877, 'support': 204756}, '2': {'precision': 0.4456422881969587, 'recall': 0.3668159125695567, 'f1-score': 0.4024051513550554, 'support': 209721}, 'accuracy': 0.4211767624613967, 'macro avg': {'precision': 0.4358803715989499, 'recall': 0.42219064144827545, 'f1-score': 0.3936504881812965, 'support': 620737}, 'weighted avg': {'precision': 0.4360208843773959, 'recall': 0.4211767624613967, 'f1-score': 0.3934105313069374, 'support': 620737}}
[[ 38476 113625  54159]
 [ 17184 146035  41537]
 [ 27685 105107  76929]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0745943
{'0': {'precision': 0.4644953165688523, 'recall': 0.17275224053194566, 'f1-score': 0.25184123739582126, 'support': 69180}, '1': {'precision': 0.37990726967474797, 'recall': 0.6783523089110142, 'f1-score': 0.4870468054734636, 'support': 64381}, '2': {'precision': 0.4357407162680058, 'recall': 0.389855308079987, 'f1-score': 0.41152289055126096, 'support': 67661}, 'accuracy': 0.4075200524793512, 'macro avg': {'precision': 0.42671443417053534, 'recall': 0.41365328584098227, 'f1-score': 0.3834703111401819, 'support': 201222}, 'weighted avg': {'precision': 0.4277626130968417, 'recall': 0.4075200524793512, 'f1-score': 0.3807883207791337, 'support': 201222}}
[[11951 38580 18649]
 [ 5199 43673 15509]
 [ 8579 32704 26378]]
training model: results/AAL/W4/deepVOL_L3/h300
Epoch 1/50
2425/2425 - 91s - loss: 3.2755 - accuracy300: 0.3822 - val_loss: 3.3633 - val_accuracy300: 0.3301 - 91s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 88s - loss: 3.2415 - accuracy300: 0.3963 - val_loss: 3.3138 - val_accuracy300: 0.3569 - 88s/epoch - 36ms/step
Epoch 3/50
2425/2425 - 88s - loss: 3.2093 - accuracy300: 0.4148 - val_loss: 3.3208 - val_accuracy300: 0.3537 - 88s/epoch - 36ms/step
Epoch 4/50
2425/2425 - 88s - loss: 3.1946 - accuracy300: 0.4220 - val_loss: 3.3313 - val_accuracy300: 0.3592 - 88s/epoch - 36ms/step
Epoch 5/50
2425/2425 - 88s - loss: 3.1864 - accuracy300: 0.4261 - val_loss: 3.3388 - val_accuracy300: 0.3559 - 88s/epoch - 36ms/step
Epoch 6/50
2425/2425 - 89s - loss: 3.1814 - accuracy300: 0.4276 - val_loss: 3.3404 - val_accuracy300: 0.3643 - 89s/epoch - 37ms/step
Epoch 7/50
2425/2425 - 90s - loss: 3.1755 - accuracy300: 0.4305 - val_loss: 3.3784 - val_accuracy300: 0.3597 - 90s/epoch - 37ms/step
Epoch 8/50
2425/2425 - 88s - loss: 3.1713 - accuracy300: 0.4323 - val_loss: 3.3572 - val_accuracy300: 0.3596 - 88s/epoch - 36ms/step
Epoch 9/50
2425/2425 - 88s - loss: 3.1676 - accuracy300: 0.4340 - val_loss: 3.3660 - val_accuracy300: 0.3615 - 88s/epoch - 36ms/step
Epoch 10/50
2425/2425 - 88s - loss: 3.1638 - accuracy300: 0.4359 - val_loss: 3.3854 - val_accuracy300: 0.3645 - 88s/epoch - 36ms/step
Epoch 11/50
2425/2425 - 88s - loss: 3.1592 - accuracy300: 0.4373 - val_loss: 3.4133 - val_accuracy300: 0.3594 - 88s/epoch - 36ms/step
Epoch 12/50
2425/2425 - 88s - loss: 3.1546 - accuracy300: 0.4405 - val_loss: 3.4155 - val_accuracy300: 0.3629 - 88s/epoch - 36ms/step
testing model: results/AAL/W4/deepVOL_L3/h300
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1096983
{'0': {'precision': 0.39853483423484887, 'recall': 0.0626857129717397, 'f1-score': 0.10833186153302721, 'support': 391397}, '1': {'precision': 0.35189912671735435, 'recall': 0.6647106201817973, 'f1-score': 0.4601787214320887, 'support': 382404}, '2': {'precision': 0.3596414088230681, 'recall': 0.3497540568365663, 'f1-score': 0.3546288292816291, 'support': 367158}, 'accuracy': 0.35683841400085364, 'macro avg': {'precision': 0.3700251232584238, 'recall': 0.35905012999670105, 'f1-score': 0.30771313741558165, 'support': 1140959}, 'weighted avg': {'precision': 0.37038858762576077, 'recall': 0.35683841400085364, 'f1-score': 0.3055147127112745, 'support': 1140959}}
[[ 24535 244641 122221]
 [ 21788 254188 106428]
 [ 15240 223503 128415]]
Evaluating performance on  train set...
2425/2425 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018268
{'0': {'precision': 0.40423621826343104, 'recall': 0.0700111753559108, 'f1-score': 0.11935143194384047, 'support': 205810}, '1': {'precision': 0.3497557141540238, 'recall': 0.7026888716681532, 'f1-score': 0.46704491894247013, 'support': 205179}, '2': {'precision': 0.3990050326835194, 'recall': 0.328851764975113, 'f1-score': 0.36054759577437545, 'support': 209748}, 'accuracy': 0.3665997032559683, 'macro avg': {'precision': 0.3843323217003247, 'recall': 0.367183937333059, 'f1-score': 0.31564798222022866, 'support': 620737}, 'weighted avg': {'precision': 0.38446055471239515, 'recall': 0.3665997032559683, 'f1-score': 0.3157789285164935, 'support': 620737}}
[[ 14409 136590  54811]
 [ 11919 144177  49083]
 [  9317 131455  68976]]
Evaluating performance on  val set...
787/787 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104403
{'0': {'precision': 0.4229200265629447, 'recall': 0.06498921219896203, 'f1-score': 0.11266537776261419, 'support': 68596}, '1': {'precision': 0.34218869493551524, 'recall': 0.6941335943971685, 'f1-score': 0.4583992281602164, 'support': 66395}, '2': {'precision': 0.38372799028536736, 'recall': 0.32444021681689844, 'f1-score': 0.3516023202349688, 'support': 66231}, 'accuracy': 0.3579777559113815, 'macro avg': {'precision': 0.38294557059460915, 'recall': 0.36118767447100963, 'f1-score': 0.3075556420525998, 'support': 201222}, 'weighted avg': {'precision': 0.383382180213622, 'recall': 0.3579777559113815, 'f1-score': 0.305388000706603, 'support': 201222}}
[[ 4458 46476 17662]
 [ 3460 46087 16848]
 [ 2623 42120 21488]]
training model: results/AAL/W4/deepVOL_L3/h500
Epoch 1/50
2425/2425 - 91s - loss: 3.2725 - accuracy500: 0.3844 - val_loss: 4.6144 - val_accuracy500: 0.3106 - 91s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 88s - loss: 3.2752 - accuracy500: 0.3782 - val_loss: 3.6147 - val_accuracy500: 0.3107 - 88s/epoch - 36ms/step
Epoch 3/50
2425/2425 - 90s - loss: 3.2613 - accuracy500: 0.3869 - val_loss: 3.6457 - val_accuracy500: 0.3112 - 90s/epoch - 37ms/step
Epoch 4/50
2425/2425 - 88s - loss: 3.2519 - accuracy500: 0.3942 - val_loss: 4.0929 - val_accuracy500: 0.3106 - 88s/epoch - 36ms/step
Epoch 5/50
2425/2425 - 88s - loss: 3.2429 - accuracy500: 0.4016 - val_loss: 3.6569 - val_accuracy500: 0.3109 - 88s/epoch - 36ms/step
Epoch 6/50
2425/2425 - 88s - loss: 3.2334 - accuracy500: 0.4059 - val_loss: 3.7792 - val_accuracy500: 0.3109 - 88s/epoch - 36ms/step
Epoch 7/50
2425/2425 - 88s - loss: 3.2288 - accuracy500: 0.4087 - val_loss: 3.6993 - val_accuracy500: 0.3180 - 88s/epoch - 36ms/step
Epoch 8/50
2425/2425 - 88s - loss: 3.2180 - accuracy500: 0.4124 - val_loss: 3.7079 - val_accuracy500: 0.3277 - 88s/epoch - 36ms/step
Epoch 9/50
2425/2425 - 89s - loss: 3.2119 - accuracy500: 0.4164 - val_loss: 3.8201 - val_accuracy500: 0.3225 - 89s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 88s - loss: 3.2097 - accuracy500: 0.4173 - val_loss: 3.8858 - val_accuracy500: 0.3182 - 88s/epoch - 36ms/step
Epoch 11/50
2425/2425 - 88s - loss: 3.2027 - accuracy500: 0.4196 - val_loss: 4.0776 - val_accuracy500: 0.3133 - 88s/epoch - 36ms/step
Epoch 12/50
2425/2425 - 88s - loss: 3.1954 - accuracy500: 0.4229 - val_loss: 4.2113 - val_accuracy500: 0.3147 - 88s/epoch - 36ms/step
testing model: results/AAL/W4/deepVOL_L3/h500
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2108853
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 408422}, '1': {'precision': 0.3096139348142434, 'recall': 0.9998159964218382, 'f1-score': 0.47281180513442495, 'support': 353254}, '2': {'precision': 0.3926940639269406, 'recall': 0.0002267436188808884, 'f1-score': 0.00045322554294839027, 'support': 379283}, 'accuracy': 0.3096298815294853, 'macro avg': {'precision': 0.23410266624706133, 'recall': 0.333347580013573, 'f1-score': 0.1577550102257911, 'support': 1140959}, 'weighted avg': {'precision': 0.22640124980588483, 'recall': 0.3096298815294853, 'f1-score': 0.1465386242227479, 'support': 1140959}}
[[     0 408354     68]
 [     0 353189     65]
 [     0 379197     86]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1911384
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 206520}, '1': {'precision': 0.32941168886424876, 'recall': 0.9995892018779343, 'f1-score': 0.4955246748964808, 'support': 204480}, '2': {'precision': 0.4578313253012048, 'recall': 0.000543537859319052, 'f1-score': 0.0010857866714923852, 'support': 209737}, 'accuracy': 0.3294632026123785, 'macro avg': {'precision': 0.2624143380551512, 'recall': 0.33337757991241784, 'f1-score': 0.16553682052265772, 'support': 620737}, 'weighted avg': {'precision': 0.26320691502787874, 'recall': 0.3294632026123785, 'f1-score': 0.16360006760020943, 'support': 620737}}
[[     0 206469     51]
 [     0 204396     84]
 [     0 209623    114]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.208153
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71484}, '1': {'precision': 0.3105798484758098, 'recall': 0.9996319882236232, 'f1-score': 0.4739165724775653, 'support': 62498}, '2': {'precision': 0.42424242424242425, 'recall': 0.0004164187983343248, 'f1-score': 0.000832020919383116, 'support': 67240}, 'accuracy': 0.31061712933973423, 'macro avg': {'precision': 0.2449407575727447, 'recall': 0.33334946900731915, 'f1-score': 0.15824953113231613, 'support': 201222}, 'weighted avg': {'precision': 0.23822782785233113, 'recall': 0.31061712933973423, 'f1-score': 0.14747285601635107, 'support': 201222}}
[[    0 71469    15]
 [    0 62475    23]
 [    0 67212    28]]
training model: results/AAL/W4/deepVOL_L3/h1000
Epoch 1/50
2425/2425 - 92s - loss: 3.2065 - accuracy1000: 0.4284 - val_loss: 3.6258 - val_accuracy1000: 0.3497 - 92s/epoch - 38ms/step
Epoch 2/50
2425/2425 - 88s - loss: 3.2171 - accuracy1000: 0.4212 - val_loss: 3.7303 - val_accuracy1000: 0.3497 - 88s/epoch - 36ms/step
Epoch 3/50
2425/2425 - 88s - loss: 3.2186 - accuracy1000: 0.4216 - val_loss: 3.4281 - val_accuracy1000: 0.3498 - 88s/epoch - 36ms/step
Epoch 4/50
2425/2425 - 89s - loss: 3.2170 - accuracy1000: 0.4236 - val_loss: 3.5298 - val_accuracy1000: 0.3517 - 89s/epoch - 37ms/step
Epoch 5/50
2425/2425 - 89s - loss: 3.2053 - accuracy1000: 0.4276 - val_loss: 3.5388 - val_accuracy1000: 0.3497 - 89s/epoch - 37ms/step
Epoch 6/50
2425/2425 - 88s - loss: 3.2098 - accuracy1000: 0.4278 - val_loss: 3.5030 - val_accuracy1000: 0.3496 - 88s/epoch - 36ms/step
Epoch 7/50
2425/2425 - 89s - loss: 3.2285 - accuracy1000: 0.4167 - val_loss: 3.4962 - val_accuracy1000: 0.3500 - 89s/epoch - 37ms/step
Epoch 8/50
2425/2425 - 89s - loss: 3.2111 - accuracy1000: 0.4267 - val_loss: 3.4578 - val_accuracy1000: 0.3500 - 89s/epoch - 37ms/step
Epoch 9/50
2425/2425 - 89s - loss: 3.2255 - accuracy1000: 0.4204 - val_loss: 3.4736 - val_accuracy1000: 0.3489 - 89s/epoch - 37ms/step
Epoch 10/50
2425/2425 - 88s - loss: 3.2222 - accuracy1000: 0.4205 - val_loss: 3.4852 - val_accuracy1000: 0.3500 - 88s/epoch - 36ms/step
Epoch 11/50
2425/2425 - 89s - loss: 3.2138 - accuracy1000: 0.4245 - val_loss: 3.5199 - val_accuracy1000: 0.3498 - 89s/epoch - 37ms/step
Epoch 12/50
2425/2425 - 88s - loss: 3.2013 - accuracy1000: 0.4307 - val_loss: 3.5758 - val_accuracy1000: 0.3515 - 88s/epoch - 36ms/step
Epoch 13/50
2425/2425 - 88s - loss: 3.1994 - accuracy1000: 0.4330 - val_loss: 3.5459 - val_accuracy1000: 0.3497 - 88s/epoch - 36ms/step
testing model: results/AAL/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
4457/4457 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080002
{'0': {'precision': 0.3826530612244898, 'recall': 0.0006351141935319971, 'f1-score': 0.0012681235997801918, 'support': 354267}, '1': {'precision': 0.4135957498842625, 'recall': 0.9747087422001608, 'f1-score': 0.5807593297400453, 'support': 470202}, '2': {'precision': 0.3059206447613143, 'recall': 0.031182659799677714, 'f1-score': 0.05659641577060932, 'support': 316490}, 'accuracy': 0.41053534789593665, 'macro avg': {'precision': 0.3673898186233555, 'recall': 0.3355088387311235, 'f1-score': 0.21287462303681162, 'support': 1140959}, 'weighted avg': {'precision': 0.37412012674285816, 'recall': 0.41053534789593665, 'f1-score': 0.2554304338131276, 'support': 1140959}}
[[   225 343321  10721]
 [   222 458310  11670]
 [   141 306480   9869]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1520567
{'0': {'precision': 0.31757575757575757, 'recall': 0.001284288543361895, 'f1-score': 0.002558231500422304, 'support': 204004}, '1': {'precision': 0.3306458427569478, 'recall': 0.9737907948157402, 'f1-score': 0.4936688663083746, 'support': 204928}, '2': {'precision': 0.38363358778625956, 'recall': 0.02965935648355799, 'f1-score': 0.05506179332106232, 'support': 211805}, 'accuracy': 0.3320262848839364, 'macro avg': {'precision': 0.34395172937298835, 'recall': 0.3349114799475534, 'f1-score': 0.18376296370995307, 'support': 620737}, 'weighted avg': {'precision': 0.34443061743387193, 'recall': 0.3320262848839364, 'f1-score': 0.18260684642323938, 'support': 620737}}
[[   262 198736   5006]
 [   284 199557   5087]
 [   279 205244   6282]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1419473
{'0': {'precision': 0.3811188811188811, 'recall': 0.001604711078395289, 'f1-score': 0.003195965460116404, 'support': 67925}, '1': {'precision': 0.35000949940692894, 'recall': 0.9687477793726816, 'f1-score': 0.5142279489423337, 'support': 70363}, '2': {'precision': 0.3321480523678681, 'recall': 0.03265325579178187, 'f1-score': 0.05946094529882381, 'support': 62934}, 'accuracy': 0.34950452733796505, 'macro avg': {'precision': 0.35442547763122606, 'recall': 0.3343352487476196, 'f1-score': 0.19229495323375798, 'support': 201222}, 'weighted avg': {'precision': 0.354924530789323, 'recall': 0.34950452733796505, 'f1-score': 0.1994902260028427, 'support': 201222}}
[[  109 65779  2037]
 [  104 68164  2095]
 [   73 60806  2055]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        21 (peak)  15.35 (ave)

============================================
