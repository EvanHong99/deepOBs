This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-03-13.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-05.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-21.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-01.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-25.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-27.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-22.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-26.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-28.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-19.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-07.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-06.csv
training model: results/AAL/W1/deepLOB_L1/h10
Epoch 1/50
2257/2257 - 87s - loss: 2.7602 - accuracy10: 0.4648 - val_loss: 2.8867 - val_accuracy10: 0.4790 - 87s/epoch - 39ms/step
Epoch 2/50
2257/2257 - 72s - loss: 2.6203 - accuracy10: 0.4957 - val_loss: 2.8355 - val_accuracy10: 0.6304 - 72s/epoch - 32ms/step
Epoch 3/50
2257/2257 - 73s - loss: 2.4713 - accuracy10: 0.5695 - val_loss: 2.6413 - val_accuracy10: 0.6545 - 73s/epoch - 32ms/step
Epoch 4/50
2257/2257 - 70s - loss: 2.3998 - accuracy10: 0.5982 - val_loss: 2.7603 - val_accuracy10: 0.6772 - 70s/epoch - 31ms/step
Epoch 5/50
2257/2257 - 70s - loss: 2.3641 - accuracy10: 0.6104 - val_loss: 2.8879 - val_accuracy10: 0.6703 - 70s/epoch - 31ms/step
Epoch 6/50
2257/2257 - 72s - loss: 2.3336 - accuracy10: 0.6195 - val_loss: 2.8171 - val_accuracy10: 0.5818 - 72s/epoch - 32ms/step
Epoch 7/50
2257/2257 - 73s - loss: 2.3088 - accuracy10: 0.6263 - val_loss: 2.7304 - val_accuracy10: 0.6397 - 73s/epoch - 32ms/step
Epoch 8/50
2257/2257 - 72s - loss: 2.2908 - accuracy10: 0.6297 - val_loss: 2.7691 - val_accuracy10: 0.6803 - 72s/epoch - 32ms/step
Epoch 9/50
2257/2257 - 69s - loss: 2.2731 - accuracy10: 0.6338 - val_loss: 2.7369 - val_accuracy10: 0.6732 - 69s/epoch - 31ms/step
Epoch 10/50
2257/2257 - 70s - loss: 2.2551 - accuracy10: 0.6371 - val_loss: 2.7716 - val_accuracy10: 0.6269 - 70s/epoch - 31ms/step
Epoch 11/50
2257/2257 - 69s - loss: 2.2381 - accuracy10: 0.6399 - val_loss: 2.7795 - val_accuracy10: 0.6167 - 69s/epoch - 30ms/step
Epoch 12/50
2257/2257 - 69s - loss: 2.2297 - accuracy10: 0.6412 - val_loss: 2.7480 - val_accuracy10: 0.6469 - 69s/epoch - 30ms/step
Epoch 13/50
2257/2257 - 69s - loss: 2.2173 - accuracy10: 0.6433 - val_loss: 2.7020 - val_accuracy10: 0.7058 - 69s/epoch - 31ms/step
testing model: results/AAL/W1/deepLOB_L1/h10
Evaluating performance on  test set...
7177/7177 - 86s - 86s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8714399
{'0': {'precision': 0.28127191391609235, 'recall': 0.6725870102586095, 'f1-score': 0.3966620867215218, 'support': 207533}, '1': {'precision': 0.9059569817633447, 'recall': 0.52131931508938, 'f1-score': 0.6618100143255486, 'support': 1423193}, '2': {'precision': 0.2645427823574273, 'recall': 0.669005587241899, 'f1-score': 0.3791567854970291, 'support': 206363}, 'accuracy': 0.5549976076281552, 'macro avg': {'precision': 0.4839238926789548, 'recall': 0.6209706375299628, 'f1-score': 0.47920962884803314, 'support': 1837089}, 'weighted avg': {'precision': 0.7633362787829517, 'recall': 0.5549976076281552, 'f1-score': 0.6001058110342622, 'support': 1837089}}
[[139584  36796  31153]
 [328592 741938 352663]
 [ 28084  40221 138058]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85143363
{'0': {'precision': 0.28889059618930546, 'recall': 0.5584400154453917, 'f1-score': 0.38079131517919534, 'support': 67334}, '1': {'precision': 0.8728887751528702, 'recall': 0.5851875763273912, 'f1-score': 0.7006542095227284, 'support': 442993}, '2': {'precision': 0.2602987416157574, 'recall': 0.5822775398524863, 'f1-score': 0.35976828265473476, 'support': 67248}, 'accuracy': 0.5817305111890231, 'macro avg': {'precision': 0.4740260376526444, 'recall': 0.5753017105417563, 'f1-score': 0.4804046024522195, 'support': 577575}, 'weighted avg': {'precision': 0.7334811000325198, 'recall': 0.5817305111890231, 'f1-score': 0.6236745186812857, 'support': 577575}}
[[ 37602  19153  10579]
 [ 83064 259234 100695]
 [  9494  18597  39157]]
Evaluating performance on  val set...
638/638 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7485336
{'0': {'precision': 0.3203920090463626, 'recall': 0.5263454176987165, 'f1-score': 0.39832151149168205, 'support': 17764}, '1': {'precision': 0.8714367725077203, 'recall': 0.6909668811803484, 'f1-score': 0.7707789820181044, 'support': 127420}, '2': {'precision': 0.28472201250264245, 'recall': 0.519620811287478, 'f1-score': 0.3678717053280527, 'support': 18144}, 'accuracy': 0.6540274784482759, 'macro avg': {'precision': 0.49218359801890843, 'recall': 0.5789777033888476, 'f1-score': 0.5123240662792797, 'support': 163328}, 'weighted avg': {'precision': 0.7463258804153682, 'recall': 0.6540274784482759, 'f1-score': 0.6855107846808709, 'support': 163328}}
[[ 9350  6053  2361]
 [18053 88043 21324]
 [ 1780  6936  9428]]
training model: results/AAL/W1/deepLOB_L1/h20
Epoch 1/50
2257/2257 - 80s - loss: 2.8315 - accuracy20: 0.4684 - val_loss: 3.3445 - val_accuracy20: 0.6185 - 80s/epoch - 35ms/step
Epoch 2/50
2257/2257 - 75s - loss: 2.7481 - accuracy20: 0.4811 - val_loss: 3.2656 - val_accuracy20: 0.6144 - 75s/epoch - 33ms/step
Epoch 3/50
2257/2257 - 70s - loss: 2.5833 - accuracy20: 0.5582 - val_loss: 3.1203 - val_accuracy20: 0.4742 - 70s/epoch - 31ms/step
Epoch 4/50
2257/2257 - 73s - loss: 2.5099 - accuracy20: 0.5831 - val_loss: 3.1667 - val_accuracy20: 0.5414 - 73s/epoch - 32ms/step
Epoch 5/50
2257/2257 - 72s - loss: 2.4634 - accuracy20: 0.5971 - val_loss: 3.2722 - val_accuracy20: 0.6298 - 72s/epoch - 32ms/step
Epoch 6/50
2257/2257 - 70s - loss: 2.4276 - accuracy20: 0.6074 - val_loss: 3.3134 - val_accuracy20: 0.6108 - 70s/epoch - 31ms/step
Epoch 7/50
2257/2257 - 71s - loss: 2.4013 - accuracy20: 0.6148 - val_loss: 3.2248 - val_accuracy20: 0.6072 - 71s/epoch - 32ms/step
Epoch 8/50
2257/2257 - 72s - loss: 2.3804 - accuracy20: 0.6197 - val_loss: 3.3831 - val_accuracy20: 0.6147 - 72s/epoch - 32ms/step
Epoch 9/50
2257/2257 - 74s - loss: 2.3633 - accuracy20: 0.6219 - val_loss: 3.3214 - val_accuracy20: 0.6112 - 74s/epoch - 33ms/step
Epoch 10/50
2257/2257 - 70s - loss: 2.3462 - accuracy20: 0.6253 - val_loss: 3.6083 - val_accuracy20: 0.6274 - 70s/epoch - 31ms/step
Epoch 11/50
2257/2257 - 71s - loss: 2.3348 - accuracy20: 0.6268 - val_loss: 3.5231 - val_accuracy20: 0.5778 - 71s/epoch - 31ms/step
Epoch 12/50
2257/2257 - 72s - loss: 2.3227 - accuracy20: 0.6286 - val_loss: 3.6489 - val_accuracy20: 0.5835 - 72s/epoch - 32ms/step
Epoch 13/50
2257/2257 - 76s - loss: 2.3127 - accuracy20: 0.6302 - val_loss: 3.5746 - val_accuracy20: 0.6321 - 76s/epoch - 34ms/step
testing model: results/AAL/W1/deepLOB_L1/h20
Evaluating performance on  test set...
7177/7177 - 96s - 96s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1038047
{'0': {'precision': 0.22904954100972014, 'recall': 0.689909782329173, 'f1-score': 0.3439184193843523, 'support': 283869}, '1': {'precision': 0.8103748246141511, 'recall': 0.2382449722329603, 'f1-score': 0.3682320859647813, 'support': 1272732}, '2': {'precision': 0.2666869555919294, 'recall': 0.5779748153218676, 'f1-score': 0.3649705697944445, 'support': 280488}, 'accuracy': 0.3599068961819487, 'macro avg': {'precision': 0.4353704404052669, 'recall': 0.5020431899613337, 'f1-score': 0.3590403583811927, 'support': 1837089}, 'weighted avg': {'precision': 0.6375371722533721, 'recall': 0.3599068961819487, 'f1-score': 0.36397714112209534, 'support': 1837089}}
[[195844  33523  54502]
 [578242 303222 391268]
 [ 80943  37430 162115]]
Evaluating performance on  train set...
2257/2257 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0860252
{'0': {'precision': 0.21565154589538124, 'recall': 0.6876000614075487, 'f1-score': 0.3283293713543685, 'support': 91194}, '1': {'precision': 0.7910657645974282, 'recall': 0.2555452083696116, 'f1-score': 0.3863002985245449, 'support': 396243}, '2': {'precision': 0.2876394022782945, 'recall': 0.5067563069959395, 'f1-score': 0.36697852101501965, 'support': 90138}, 'accuracy': 0.3629675799679695, 'macro avg': {'precision': 0.43145223759036794, 'recall': 0.48330052559103326, 'f1-score': 0.360536063631311, 'support': 577575}, 'weighted avg': {'precision': 0.621646780557197, 'recall': 0.3629675799679695, 'f1-score': 0.37413178861066243, 'support': 577575}}
[[ 62705  14021  14468]
 [196328 101258  98657]
 [ 31737  12723  45678]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9779355
{'0': {'precision': 0.22791972416231987, 'recall': 0.5314368171511029, 'f1-score': 0.31901992327682216, 'support': 24255}, '1': {'precision': 0.7991790817877774, 'recall': 0.45827013267779, 'f1-score': 0.5825124380865846, 'support': 114714}, '2': {'precision': 0.2960505452150367, 'recall': 0.4982142124060922, 'f1-score': 0.371404088627739, 'support': 24359}, 'accuracy': 0.4750930642633229, 'macro avg': {'precision': 0.4410497837217114, 'recall': 0.495973720744995, 'f1-score': 0.4243121499970486, 'support': 163328}, 'weighted avg': {'precision': 0.6393068997884823, 'recall': 0.4750930642633229, 'f1-score': 0.5118974839380074, 'support': 163328}}
[[12890  7147  4218]
 [37505 52570 24639]
 [ 6160  6063 12136]]
training model: results/AAL/W1/deepLOB_L1/h30
Epoch 1/50
2257/2257 - 86s - loss: 2.8826 - accuracy30: 0.4682 - val_loss: 3.1996 - val_accuracy30: 0.5608 - 86s/epoch - 38ms/step
Epoch 2/50
2257/2257 - 77s - loss: 2.8287 - accuracy30: 0.4776 - val_loss: 3.0719 - val_accuracy30: 0.4996 - 77s/epoch - 34ms/step
Epoch 3/50
2257/2257 - 78s - loss: 2.7214 - accuracy30: 0.5228 - val_loss: 2.9258 - val_accuracy30: 0.5975 - 78s/epoch - 35ms/step
Epoch 4/50
2257/2257 - 83s - loss: 2.6258 - accuracy30: 0.5604 - val_loss: 2.7944 - val_accuracy30: 0.6300 - 83s/epoch - 37ms/step
Epoch 5/50
2257/2257 - 82s - loss: 2.5667 - accuracy30: 0.5792 - val_loss: 2.8493 - val_accuracy30: 0.6469 - 82s/epoch - 36ms/step
Epoch 6/50
2257/2257 - 81s - loss: 2.5304 - accuracy30: 0.5891 - val_loss: 2.8827 - val_accuracy30: 0.6436 - 81s/epoch - 36ms/step
Epoch 7/50
2257/2257 - 79s - loss: 2.5051 - accuracy30: 0.5937 - val_loss: 2.9146 - val_accuracy30: 0.6513 - 79s/epoch - 35ms/step
Epoch 8/50
2257/2257 - 82s - loss: 2.4826 - accuracy30: 0.5992 - val_loss: 2.8842 - val_accuracy30: 0.6460 - 82s/epoch - 36ms/step
Epoch 9/50
2257/2257 - 82s - loss: 2.4632 - accuracy30: 0.6019 - val_loss: 2.9918 - val_accuracy30: 0.6451 - 82s/epoch - 37ms/step
Epoch 10/50
2257/2257 - 84s - loss: 2.4477 - accuracy30: 0.6052 - val_loss: 2.9865 - val_accuracy30: 0.6252 - 84s/epoch - 37ms/step
Epoch 11/50
2257/2257 - 83s - loss: 2.4353 - accuracy30: 0.6072 - val_loss: 2.9900 - val_accuracy30: 0.6336 - 83s/epoch - 37ms/step
Epoch 12/50
2257/2257 - 82s - loss: 2.4242 - accuracy30: 0.6093 - val_loss: 2.9982 - val_accuracy30: 0.6144 - 82s/epoch - 37ms/step
Epoch 13/50
2257/2257 - 83s - loss: 2.4133 - accuracy30: 0.6117 - val_loss: 2.9866 - val_accuracy30: 0.6284 - 83s/epoch - 37ms/step
Epoch 14/50
2257/2257 - 82s - loss: 2.4052 - accuracy30: 0.6132 - val_loss: 2.9274 - val_accuracy30: 0.6386 - 82s/epoch - 36ms/step
testing model: results/AAL/W1/deepLOB_L1/h30
Evaluating performance on  test set...
7177/7177 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8869599
{'0': {'precision': 0.4408618964223167, 'recall': 0.494543370919222, 'f1-score': 0.466162284901753, 'support': 342061}, '1': {'precision': 0.7805261705345922, 'recall': 0.5689631204902187, 'f1-score': 0.6581609925550382, 'support': 1158177}, '2': {'precision': 0.3608629413290518, 'recall': 0.6525466749393649, 'f1-score': 0.46472800078648846, 'support': 336851}, 'accuracy': 0.570432352488094, 'macro avg': {'precision': 0.5274170027619869, 'recall': 0.5720177221162686, 'f1-score': 0.5296837594144266, 'support': 1837089}, 'weighted avg': {'precision': 0.6403316129011652, 'recall': 0.570432352488094, 'f1-score': 0.5869432308413606, 'support': 1837089}}
[[169164 100741  72156]
 [182058 658960 317159]
 [ 32490  84550 219811]]
Evaluating performance on  train set...
2257/2257 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89277637
{'0': {'precision': 0.4394068263005694, 'recall': 0.4053445331610283, 'f1-score': 0.42168894522547445, 'support': 108335}, '1': {'precision': 0.7517586781788362, 'recall': 0.6116473536636808, 'f1-score': 0.6745036993571162, 'support': 362709}, '2': {'precision': 0.35132307018024433, 'recall': 0.6019562380903212, 'f1-score': 0.44369181591428797, 'support': 106531}, 'accuracy': 0.5711639181058737, 'macro avg': {'precision': 0.5141628582198833, 'recall': 0.5396493749716768, 'f1-score': 0.5132948201656262, 'support': 577575}, 'weighted avg': {'precision': 0.6193127730947691, 'recall': 0.5711639181058737, 'f1-score': 0.5845113916154387, 'support': 577575}}
[[ 43913  40794  23628]
 [ 46084 221850  94775]
 [  9940  32464  64127]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82183063
{'0': {'precision': 0.4961590600994126, 'recall': 0.37987821754774426, 'f1-score': 0.4303013677156406, 'support': 28904}, '1': {'precision': 0.7623045135727364, 'recall': 0.7221311242334342, 'f1-score': 0.7416742112282546, 'support': 105503}, '2': {'precision': 0.38269300690825353, 'recall': 0.5459009024584213, 'f1-score': 0.44995440036479706, 'support': 28921}, 'accuracy': 0.6303573177899686, 'macro avg': {'precision': 0.5470521935268008, 'recall': 0.5493034147465332, 'f1-score': 0.5406433264362308, 'support': 163328}, 'weighted avg': {'precision': 0.6479860098781068, 'recall': 0.6303573177899686, 'f1-score': 0.6349151171423009, 'support': 163328}}
[[10980 12823  5101]
 [ 8950 76187 20366]
 [ 2200 10933 15788]]
training model: results/AAL/W1/deepLOB_L1/h50
Epoch 1/50
2257/2257 - 89s - loss: 2.9424 - accuracy50: 0.4854 - val_loss: 3.2919 - val_accuracy50: 0.5091 - 89s/epoch - 39ms/step
Epoch 2/50
2257/2257 - 78s - loss: 2.9329 - accuracy50: 0.4789 - val_loss: 3.1094 - val_accuracy50: 0.4682 - 78s/epoch - 35ms/step
Epoch 3/50
2257/2257 - 83s - loss: 2.8353 - accuracy50: 0.5200 - val_loss: 3.3271 - val_accuracy50: 0.4598 - 83s/epoch - 37ms/step
Epoch 4/50
2257/2257 - 80s - loss: 2.7578 - accuracy50: 0.5459 - val_loss: 3.2118 - val_accuracy50: 0.4680 - 80s/epoch - 36ms/step
Epoch 5/50
2257/2257 - 82s - loss: 2.7181 - accuracy50: 0.5588 - val_loss: 3.2244 - val_accuracy50: 0.5148 - 82s/epoch - 36ms/step
Epoch 6/50
2257/2257 - 82s - loss: 2.6875 - accuracy50: 0.5674 - val_loss: 3.2268 - val_accuracy50: 0.5231 - 82s/epoch - 36ms/step
Epoch 7/50
2257/2257 - 88s - loss: 2.6669 - accuracy50: 0.5722 - val_loss: 3.2631 - val_accuracy50: 0.5214 - 88s/epoch - 39ms/step
Epoch 8/50
2257/2257 - 88s - loss: 2.6474 - accuracy50: 0.5758 - val_loss: 3.3177 - val_accuracy50: 0.5172 - 88s/epoch - 39ms/step
Epoch 9/50
2257/2257 - 85s - loss: 2.6297 - accuracy50: 0.5784 - val_loss: 3.3861 - val_accuracy50: 0.5213 - 85s/epoch - 38ms/step
Epoch 10/50
2257/2257 - 89s - loss: 2.6154 - accuracy50: 0.5806 - val_loss: 3.2768 - val_accuracy50: 0.5392 - 89s/epoch - 39ms/step
Epoch 11/50
2257/2257 - 89s - loss: 2.6017 - accuracy50: 0.5825 - val_loss: 3.3227 - val_accuracy50: 0.5304 - 89s/epoch - 39ms/step
Epoch 12/50
2257/2257 - 85s - loss: 2.5922 - accuracy50: 0.5841 - val_loss: 3.3398 - val_accuracy50: 0.5306 - 85s/epoch - 37ms/step
testing model: results/AAL/W1/deepLOB_L1/h50
Evaluating performance on  test set...
7177/7177 - 113s - 113s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0377624
{'0': {'precision': 0.34829414813731874, 'recall': 0.5415830443867827, 'f1-score': 0.42394659999155176, 'support': 435490}, '1': {'precision': 0.5605218156379309, 'recall': 0.3476368216612971, 'f1-score': 0.42912771944707345, 'support': 974937}, '2': {'precision': 0.38920185425979087, 'recall': 0.5065110087141578, 'f1-score': 0.4401745959972463, 'support': 426662}, 'accuracy': 0.4305109877637937, 'macro avg': {'precision': 0.43267260601168017, 'recall': 0.4652436249207459, 'f1-score': 0.43108297181195715, 'support': 1837089}, 'weighted avg': {'precision': 0.4704234348401788, 'recall': 0.4305109877637937, 'f1-score': 0.43046513790146773, 'support': 1837089}}
[[235854 134263  65373]
 [362233 338924 273780]
 [ 79082 131471 216109]]
Evaluating performance on  train set...
2257/2257 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0310215
{'0': {'precision': 0.34916742889258673, 'recall': 0.4703092645781845, 'f1-score': 0.4007842517195035, 'support': 134739}, '1': {'precision': 0.5538480400446444, 'recall': 0.4210321643441148, 'f1-score': 0.4783928075838798, 'support': 311152}, '2': {'precision': 0.36928794820529853, 'recall': 0.4474423620181647, 'f1-score': 0.40462578587198744, 'support': 131684}, 'accuracy': 0.438549106176687, 'macro avg': {'precision': 0.42410113904750996, 'recall': 0.44626126364682134, 'f1-score': 0.42793428172512354, 'support': 577575}, 'weighted avg': {'precision': 0.4640206202294004, 'recall': 0.438549106176687, 'f1-score': 0.44346948906123074, 'support': 577575}}
[[ 63369  52496  18874]
 [ 98389 131005  81758]
 [ 19728  53035  58921]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99988186
{'0': {'precision': 0.3600774752193232, 'recall': 0.4382627024628356, 'f1-score': 0.3953415644037478, 'support': 36056}, '1': {'precision': 0.6001391389752824, 'recall': 0.4810772982252791, 'f1-score': 0.5340527679823257, 'support': 91451}, '2': {'precision': 0.36126585022217406, 'recall': 0.4652857262499651, 'f1-score': 0.4067304407242911, 'support': 35821}, 'accuracy': 0.46816222570532917, 'macro avg': {'precision': 0.44049415480559323, 'recall': 0.4615419089793599, 'f1-score': 0.4453749243701215, 'support': 163328}, 'weighted avg': {'precision': 0.494754003390386, 'recall': 0.46816222570532917, 'f1-score': 0.4755068711309637, 'support': 163328}}
[[15802 14798  5456]
 [23444 43995 24012]
 [ 4639 14515 16667]]
training model: results/AAL/W1/deepLOB_L1/h100
Epoch 1/50
2257/2257 - 92s - loss: 3.0899 - accuracy100: 0.4618 - val_loss: 3.4195 - val_accuracy100: 0.4157 - 92s/epoch - 41ms/step
Epoch 2/50
2257/2257 - 91s - loss: 3.0885 - accuracy100: 0.4576 - val_loss: 3.3392 - val_accuracy100: 0.4304 - 91s/epoch - 40ms/step
Epoch 3/50
2257/2257 - 87s - loss: 3.0507 - accuracy100: 0.4756 - val_loss: 3.5008 - val_accuracy100: 0.4001 - 87s/epoch - 39ms/step
Epoch 4/50
2257/2257 - 89s - loss: 3.0123 - accuracy100: 0.4905 - val_loss: 3.6955 - val_accuracy100: 0.4120 - 89s/epoch - 40ms/step
Epoch 5/50
2257/2257 - 87s - loss: 2.9838 - accuracy100: 0.4999 - val_loss: 3.7346 - val_accuracy100: 0.4108 - 87s/epoch - 39ms/step
Epoch 6/50
2257/2257 - 91s - loss: 2.9531 - accuracy100: 0.5083 - val_loss: 3.8187 - val_accuracy100: 0.3643 - 91s/epoch - 40ms/step
Epoch 7/50
2257/2257 - 87s - loss: 2.9326 - accuracy100: 0.5147 - val_loss: 3.6763 - val_accuracy100: 0.3882 - 87s/epoch - 38ms/step
Epoch 8/50
2257/2257 - 92s - loss: 2.9157 - accuracy100: 0.5182 - val_loss: 3.7742 - val_accuracy100: 0.3736 - 92s/epoch - 41ms/step
Epoch 9/50
2257/2257 - 89s - loss: 2.9025 - accuracy100: 0.5206 - val_loss: 3.7900 - val_accuracy100: 0.3957 - 89s/epoch - 39ms/step
Epoch 10/50
2257/2257 - 88s - loss: 2.8915 - accuracy100: 0.5230 - val_loss: 3.7342 - val_accuracy100: 0.3719 - 88s/epoch - 39ms/step
Epoch 11/50
2257/2257 - 94s - loss: 2.8843 - accuracy100: 0.5239 - val_loss: 3.6969 - val_accuracy100: 0.3719 - 94s/epoch - 41ms/step
Epoch 12/50
2257/2257 - 97s - loss: 2.8754 - accuracy100: 0.5261 - val_loss: 3.7131 - val_accuracy100: 0.3842 - 97s/epoch - 43ms/step
testing model: results/AAL/W1/deepLOB_L1/h100
Evaluating performance on  test set...
7177/7177 - 111s - 111s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949405
{'0': {'precision': 0.4421356997322021, 'recall': 0.32951231913885365, 'f1-score': 0.3776052195558938, 'support': 578206}, '1': {'precision': 0.3832861335589639, 'recall': 0.7294046652033898, 'f1-score': 0.5025128171036273, 'support': 694332}, '2': {'precision': 0.47809225183596005, 'recall': 0.07184116226877643, 'f1-score': 0.12491222450814927, 'support': 564551}, 'accuracy': 0.4014683012091412, 'macro avg': {'precision': 0.4345046950423754, 'recall': 0.3769193822036733, 'f1-score': 0.33501008705589014, 'support': 1837089}, 'weighted avg': {'precision': 0.43094308493048694, 'recall': 0.4014683012091412, 'f1-score': 0.34715991123022955, 'support': 1837089}}
[[190526 372917  14763]
 [158371 506449  29512]
 [ 82025 441968  40558]]
Evaluating performance on  train set...
2257/2257 - 36s - 36s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0835632
{'0': {'precision': 0.4173284163407699, 'recall': 0.2990656339362668, 'f1-score': 0.3484355777223608, 'support': 175199}, '1': {'precision': 0.4020964835309991, 'recall': 0.7379471262277979, 'f1-score': 0.5205519191512037, 'support': 231003}, '2': {'precision': 0.45807807379968657, 'recall': 0.07504682767997292, 'f1-score': 0.12896529939984658, 'support': 171373}, 'accuracy': 0.4081288144396832, 'macro avg': {'precision': 0.42583432455715187, 'recall': 0.3706865292813459, 'f1-score': 0.332650932091137, 'support': 577575}, 'weighted avg': {'precision': 0.42332723705297426, 'recall': 0.4081288144396832, 'f1-score': 0.3521547678052466, 'support': 577575}}
[[ 52396 117675   5128]
 [ 50448 170468  10087]
 [ 22707 135805  12861]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0824857
{'0': {'precision': 0.45498000643471065, 'recall': 0.20722210592422022, 'f1-score': 0.28475268600687503, 'support': 47770}, '1': {'precision': 0.43079622197120815, 'recall': 0.7844295654457135, 'f1-score': 0.5561588582066397, 'support': 68553}, '2': {'precision': 0.3975752508361204, 'recall': 0.14162323157110945, 'f1-score': 0.20885033490721425, 'support': 47005}, 'accuracy': 0.430612019984326, 'macro avg': {'precision': 0.427783826414013, 'recall': 0.37775830098034774, 'f1-score': 0.3499206263735763, 'support': 163328}, 'weighted avg': {'precision': 0.4283086364721922, 'recall': 0.430612019984326, 'f1-score': 0.3768245739218125, 'support': 163328}}
[[ 9899 34244  3627]
 [ 8318 53775  6460]
 [ 3540 36808  6657]]
training model: results/AAL/W1/deepLOB_L1/h200
Epoch 1/50
2257/2257 - 101s - loss: 3.1982 - accuracy200: 0.4258 - val_loss: 3.4076 - val_accuracy200: 0.3409 - 101s/epoch - 45ms/step
Epoch 2/50
2257/2257 - 96s - loss: 3.1879 - accuracy200: 0.4288 - val_loss: 3.5860 - val_accuracy200: 0.3434 - 96s/epoch - 42ms/step
Epoch 3/50
2257/2257 - 95s - loss: 3.1636 - accuracy200: 0.4385 - val_loss: 3.6399 - val_accuracy200: 0.3420 - 95s/epoch - 42ms/step
Epoch 4/50
2257/2257 - 95s - loss: 3.1412 - accuracy200: 0.4471 - val_loss: 3.5469 - val_accuracy200: 0.3542 - 95s/epoch - 42ms/step
Epoch 5/50
2257/2257 - 99s - loss: 3.1274 - accuracy200: 0.4526 - val_loss: 3.5606 - val_accuracy200: 0.3561 - 99s/epoch - 44ms/step
Epoch 6/50
2257/2257 - 99s - loss: 3.1180 - accuracy200: 0.4553 - val_loss: 3.5107 - val_accuracy200: 0.3632 - 99s/epoch - 44ms/step
Epoch 7/50
2257/2257 - 94s - loss: 3.1107 - accuracy200: 0.4575 - val_loss: 3.5106 - val_accuracy200: 0.3543 - 94s/epoch - 41ms/step
Epoch 8/50
2257/2257 - 100s - loss: 3.1046 - accuracy200: 0.4590 - val_loss: 3.4958 - val_accuracy200: 0.3560 - 100s/epoch - 44ms/step
Epoch 9/50
2257/2257 - 99s - loss: 3.0986 - accuracy200: 0.4611 - val_loss: 3.4702 - val_accuracy200: 0.3480 - 99s/epoch - 44ms/step
Epoch 10/50
2257/2257 - 100s - loss: 3.0939 - accuracy200: 0.4627 - val_loss: 3.4497 - val_accuracy200: 0.3514 - 100s/epoch - 44ms/step
Epoch 11/50
2257/2257 - 101s - loss: 3.0884 - accuracy200: 0.4641 - val_loss: 3.4678 - val_accuracy200: 0.3506 - 101s/epoch - 45ms/step
testing model: results/AAL/W1/deepLOB_L1/h200
Evaluating performance on  test set...
7177/7177 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1516014
{'0': {'precision': 0.3877259145243727, 'recall': 0.41645493751357815, 'f1-score': 0.40157725988238896, 'support': 649021}, '1': {'precision': 0.3063852146170928, 'recall': 0.5778058070381117, 'f1-score': 0.40043644837056197, 'support': 562111}, '2': {'precision': 0.4265618742490989, 'recall': 0.054451024591146036, 'f1-score': 0.09657425470453813, 'support': 625957}, 'accuracy': 0.3424782359482856, 'macro avg': {'precision': 0.3735576677968548, 'recall': 0.3495705897142786, 'f1-score': 0.2995293209858297, 'support': 1837089}, 'weighted avg': {'precision': 0.3760700495531217, 'recall': 0.3424782359482856, 'f1-score': 0.2973035808108597, 'support': 1837089}}
[[270288 358803  19930]
 [211430 324791  25890]
 [215393 376480  34084]]
Evaluating performance on  train set...
2257/2257 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1521527
{'0': {'precision': 0.35643705618105775, 'recall': 0.4460945870108668, 'f1-score': 0.39625762478360577, 'support': 196010}, '1': {'precision': 0.3213054216080183, 'recall': 0.5074597638491217, 'f1-score': 0.3934759235396951, 'support': 188947}, '2': {'precision': 0.4365323247843045, 'recall': 0.07670103520958581, 'f1-score': 0.13047663625685543, 'support': 192618}, 'accuracy': 0.34297883391767303, 'macro avg': {'precision': 0.3714249341911269, 'recall': 0.34341846202319143, 'f1-score': 0.30673672819338543, 'support': 577575}, 'weighted avg': {'precision': 0.37165546676002686, 'recall': 0.34297883391767303, 'f1-score': 0.3067111649247497, 'support': 577575}}
[[ 87439 101349   7222]
 [ 81216  95883  11848]
 [ 76659 101185  14774]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1375564
{'0': {'precision': 0.36832773673606445, 'recall': 0.24326674000212908, 'f1-score': 0.29301078141194825, 'support': 56362}, '1': {'precision': 0.3227439664218258, 'recall': 0.6978709726213886, 'f1-score': 0.44136850664880894, 'support': 52888}, '2': {'precision': 0.43736694200800474, 'recall': 0.09497392655053812, 'f1-score': 0.15605961623190165, 'support': 54078}, 'accuracy': 0.3413744122257053, 'macro avg': {'precision': 0.3761462150552983, 'recall': 0.34537054639135195, 'f1-score': 0.2968129680975529, 'support': 163328}, 'weighted avg': {'precision': 0.3764259666679594, 'recall': 0.3413744122257053, 'f1-score': 0.2957065730809856, 'support': 163328}}
[[13711 39699  2952]
 [12324 36909  3655]
 [11190 37752  5136]]
training model: results/AAL/W1/deepLOB_L1/h300
Epoch 1/50
2257/2257 - 104s - loss: 3.2263 - accuracy300: 0.4122 - val_loss: 3.4314 - val_accuracy300: 0.3241 - 104s/epoch - 46ms/step
Epoch 2/50
2257/2257 - 101s - loss: 3.2135 - accuracy300: 0.4172 - val_loss: 3.4676 - val_accuracy300: 0.3603 - 101s/epoch - 45ms/step
Epoch 3/50
2257/2257 - 100s - loss: 3.2082 - accuracy300: 0.4189 - val_loss: 3.3723 - val_accuracy300: 0.3446 - 100s/epoch - 44ms/step
Epoch 4/50
2257/2257 - 97s - loss: 3.1966 - accuracy300: 0.4267 - val_loss: 3.4287 - val_accuracy300: 0.3249 - 97s/epoch - 43ms/step
Epoch 5/50
2257/2257 - 105s - loss: 3.1871 - accuracy300: 0.4324 - val_loss: 3.4085 - val_accuracy300: 0.3116 - 105s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 95s - loss: 3.1781 - accuracy300: 0.4378 - val_loss: 3.4391 - val_accuracy300: 0.3201 - 95s/epoch - 42ms/step
Epoch 7/50
2257/2257 - 99s - loss: 3.1700 - accuracy300: 0.4400 - val_loss: 3.4962 - val_accuracy300: 0.3121 - 99s/epoch - 44ms/step
Epoch 8/50
2257/2257 - 92s - loss: 3.1661 - accuracy300: 0.4421 - val_loss: 3.4208 - val_accuracy300: 0.3174 - 92s/epoch - 41ms/step
Epoch 9/50
2257/2257 - 96s - loss: 3.1602 - accuracy300: 0.4436 - val_loss: 3.4624 - val_accuracy300: 0.3133 - 96s/epoch - 42ms/step
Epoch 10/50
2257/2257 - 98s - loss: 3.1548 - accuracy300: 0.4449 - val_loss: 3.4446 - val_accuracy300: 0.3211 - 98s/epoch - 44ms/step
Epoch 11/50
2257/2257 - 99s - loss: 3.1505 - accuracy300: 0.4466 - val_loss: 3.4350 - val_accuracy300: 0.3194 - 99s/epoch - 44ms/step
Epoch 12/50
2257/2257 - 98s - loss: 3.1475 - accuracy300: 0.4474 - val_loss: 3.4821 - val_accuracy300: 0.3273 - 98s/epoch - 43ms/step
Epoch 13/50
2257/2257 - 101s - loss: 3.1439 - accuracy300: 0.4496 - val_loss: 3.4459 - val_accuracy300: 0.3096 - 101s/epoch - 45ms/step
testing model: results/AAL/W1/deepLOB_L1/h300
Evaluating performance on  test set...
7177/7177 - 125s - 125s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227784
{'0': {'precision': 0.3797652920558821, 'recall': 0.5738437137194657, 'f1-score': 0.4570550911647831, 'support': 682184}, '1': {'precision': 0.27467899267419515, 'recall': 0.34791566238551197, 'f1-score': 0.30698986219360674, 'support': 499943}, '2': {'precision': 0.3891004710029763, 'recall': 0.1027968034786751, 'f1-score': 0.16262860855776048, 'support': 654962}, 'accuracy': 0.34442152775396295, 'macro avg': {'precision': 0.3478482519110179, 'recall': 0.3415187265278843, 'f1-score': 0.30889118730538345, 'support': 1837089}, 'weighted avg': {'precision': 0.3544954372485037, 'recall': 0.34442152775396295, 'f1-score': 0.31124712069149757, 'support': 1837089}}
[[391467 233709  57008]
 [277306 173938  48699]
 [362040 225594  67328]]
Evaluating performance on  train set...
2257/2257 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123842
{'0': {'precision': 0.35434274514937875, 'recall': 0.46807320224204757, 'f1-score': 0.4033441811029662, 'support': 196606}, '1': {'precision': 0.32565833523698495, 'recall': 0.4388700756892177, 'f1-score': 0.37388198055618355, 'support': 188402}, '2': {'precision': 0.3659017008504252, 'recall': 0.12154730561311128, 'f1-score': 0.18247802444110942, 'support': 192567}, 'accuracy': 0.34301346145522227, 'macro avg': {'precision': 0.348634260412263, 'recall': 0.3428301945147922, 'f1-score': 0.31990139536675305, 'support': 577575}, 'weighted avg': {'precision': 0.3488398636641493, 'recall': 0.34301346145522227, 'f1-score': 0.32009564940176943, 'support': 577575}}
[[92026 86403 18177]
 [83333 82684 22385]
 [84350 84811 23406]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1256082
{'0': {'precision': 0.37454456563493077, 'recall': 0.5414647280560043, 'f1-score': 0.44279609993738434, 'support': 59424}, '1': {'precision': 0.2917862854280264, 'recall': 0.3194532337678775, 'f1-score': 0.30499360568741374, 'support': 47406}, '2': {'precision': 0.35352664576802506, 'recall': 0.15968706856879888, 'f1-score': 0.2200004876978224, 'support': 56498}, 'accuracy': 0.3449622844827586, 'macro avg': {'precision': 0.3399524989436607, 'recall': 0.3402016767975602, 'f1-score': 0.32259673110754017, 'support': 163328}, 'weighted avg': {'precision': 0.3432534859172526, 'recall': 0.3449622844827586, 'f1-score': 0.32573000261956453, 'support': 163328}}
[[32176 19057  8191]
 [23955 15144  8307]
 [29776 17700  9022]]
training model: results/AAL/W1/deepLOB_L1/h500
Epoch 1/50
2257/2257 - 105s - loss: 3.2250 - accuracy500: 0.4082 - val_loss: 3.4399 - val_accuracy500: 0.3352 - 105s/epoch - 47ms/step
Epoch 2/50
2257/2257 - 104s - loss: 3.2047 - accuracy500: 0.4213 - val_loss: 3.8277 - val_accuracy500: 0.3138 - 104s/epoch - 46ms/step
Epoch 3/50
2257/2257 - 99s - loss: 3.1880 - accuracy500: 0.4280 - val_loss: 3.6340 - val_accuracy500: 0.3139 - 99s/epoch - 44ms/step
Epoch 4/50
2257/2257 - 106s - loss: 3.1770 - accuracy500: 0.4348 - val_loss: 3.5915 - val_accuracy500: 0.3204 - 106s/epoch - 47ms/step
Epoch 5/50
2257/2257 - 105s - loss: 3.1644 - accuracy500: 0.4396 - val_loss: 3.9739 - val_accuracy500: 0.3000 - 105s/epoch - 47ms/step
Epoch 6/50
2257/2257 - 107s - loss: 3.1602 - accuracy500: 0.4420 - val_loss: 3.6088 - val_accuracy500: 0.3173 - 107s/epoch - 48ms/step
Epoch 7/50
2257/2257 - 101s - loss: 3.1516 - accuracy500: 0.4447 - val_loss: 3.7623 - val_accuracy500: 0.3076 - 101s/epoch - 45ms/step
Epoch 8/50
2257/2257 - 109s - loss: 3.1484 - accuracy500: 0.4451 - val_loss: 3.6894 - val_accuracy500: 0.3102 - 109s/epoch - 48ms/step
Epoch 9/50
2257/2257 - 103s - loss: 3.1435 - accuracy500: 0.4474 - val_loss: 3.4974 - val_accuracy500: 0.3214 - 103s/epoch - 46ms/step
Epoch 10/50
2257/2257 - 102s - loss: 3.1369 - accuracy500: 0.4492 - val_loss: 3.6300 - val_accuracy500: 0.3124 - 102s/epoch - 45ms/step
Epoch 11/50
2257/2257 - 101s - loss: 3.1331 - accuracy500: 0.4512 - val_loss: 3.5911 - val_accuracy500: 0.3299 - 101s/epoch - 45ms/step
testing model: results/AAL/W1/deepLOB_L1/h500
Evaluating performance on  test set...
7177/7177 - 134s - 134s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1497977
{'0': {'precision': 0.3762838536602211, 'recall': 0.3087715268777433, 'f1-score': 0.3392010145015392, 'support': 670499}, '1': {'precision': 0.29555913769628256, 'recall': 0.6059196880679577, 'f1-score': 0.3973140475412595, 'support': 529859}, '2': {'precision': 0.3843807473197865, 'recall': 0.12112022188333849, 'f1-score': 0.18419858413505175, 'support': 636731}, 'accuracy': 0.32943640727259266, 'macro avg': {'precision': 0.35207457955876337, 'recall': 0.34527047894301316, 'f1-score': 0.30690454872595013, 'support': 1837089}, 'weighted avg': {'precision': 0.3558073421361807, 'recall': 0.32943640727259266, 'f1-score': 0.30223865779683373, 'support': 1837089}}
[[207031 398049  65419]
 [150710 321052  58097]
 [192458 367152  77121]]
Evaluating performance on  train set...
2257/2257 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1392
{'0': {'precision': 0.36861273028758607, 'recall': 0.18282868545998557, 'f1-score': 0.24442480741470254, 'support': 198191}, '1': {'precision': 0.33221216711332063, 'recall': 0.6870438298214142, 'f1-score': 0.44786456060738283, 'support': 186745}, '2': {'precision': 0.3791702930084131, 'recall': 0.18318720508308287, 'f1-score': 0.24702843462556176, 'support': 192639}, 'accuracy': 0.34597411591568195, 'macro avg': {'precision': 0.3599983968031066, 'recall': 0.3510199067881609, 'f1-score': 0.3131059342158824, 'support': 577575}, 'weighted avg': {'precision': 0.36036475410267366, 'recall': 0.34597411591568195, 'f1-score': 0.3110705535987302, 'support': 577575}}
[[ 36235 132186  29770]
 [ 30433 128302  28010]
 [ 31633 125717  35289]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1509836
{'0': {'precision': 0.3750078087583033, 'recall': 0.30189596499756927, 'f1-score': 0.3345035105315948, 'support': 59653}, '1': {'precision': 0.293501130408646, 'recall': 0.4796267031136548, 'f1-score': 0.36415964717423205, 'support': 46826}, '2': {'precision': 0.36692966171617164, 'recall': 0.25032982110503266, 'f1-score': 0.2976169313939749, 'support': 56849}, 'accuracy': 0.3349027723354232, 'macro avg': {'precision': 0.34514620029437365, 'recall': 0.3439508297387522, 'f1-score': 0.33209336303326725, 'support': 163328}, 'weighted avg': {'precision': 0.34882818063820636, 'recall': 0.3349027723354232, 'f1-score': 0.33016691862471775, 'support': 163328}}
[[18009 27487 14157]
 [13971 22459 10396]
 [16043 26575 14231]]
training model: results/AAL/W1/deepLOB_L1/h1000
Epoch 1/50
2257/2257 - 108s - loss: 3.1414 - accuracy1000: 0.4560 - val_loss: 3.4424 - val_accuracy1000: 0.3635 - 108s/epoch - 48ms/step
Epoch 2/50
2257/2257 - 99s - loss: 3.0917 - accuracy1000: 0.4772 - val_loss: 3.3699 - val_accuracy1000: 0.3537 - 99s/epoch - 44ms/step
Epoch 3/50
2257/2257 - 105s - loss: 3.0726 - accuracy1000: 0.4833 - val_loss: 3.4702 - val_accuracy1000: 0.3005 - 105s/epoch - 46ms/step
Epoch 4/50
2257/2257 - 104s - loss: 3.0537 - accuracy1000: 0.4902 - val_loss: 3.5615 - val_accuracy1000: 0.2858 - 104s/epoch - 46ms/step
Epoch 5/50
2257/2257 - 103s - loss: 3.0490 - accuracy1000: 0.4907 - val_loss: 3.4499 - val_accuracy1000: 0.2945 - 103s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 104s - loss: 3.0515 - accuracy1000: 0.4912 - val_loss: 3.3131 - val_accuracy1000: 0.3443 - 104s/epoch - 46ms/step
Epoch 7/50
2257/2257 - 104s - loss: 3.0454 - accuracy1000: 0.4900 - val_loss: 3.3648 - val_accuracy1000: 0.3678 - 104s/epoch - 46ms/step
Epoch 8/50
2257/2257 - 106s - loss: 3.0316 - accuracy1000: 0.4945 - val_loss: 3.4343 - val_accuracy1000: 0.3125 - 106s/epoch - 47ms/step
Epoch 9/50
2257/2257 - 102s - loss: 3.0197 - accuracy1000: 0.4989 - val_loss: 3.5929 - val_accuracy1000: 0.2981 - 102s/epoch - 45ms/step
Epoch 10/50
2257/2257 - 103s - loss: 3.0101 - accuracy1000: 0.5025 - val_loss: 3.6441 - val_accuracy1000: 0.3311 - 103s/epoch - 45ms/step
Epoch 11/50
2257/2257 - 96s - loss: 3.0084 - accuracy1000: 0.5026 - val_loss: 3.6619 - val_accuracy1000: 0.3359 - 96s/epoch - 42ms/step
Epoch 12/50
2257/2257 - 103s - loss: 2.9980 - accuracy1000: 0.5052 - val_loss: 3.6965 - val_accuracy1000: 0.3417 - 103s/epoch - 46ms/step
Epoch 13/50
2257/2257 - 108s - loss: 2.9902 - accuracy1000: 0.5071 - val_loss: 3.7836 - val_accuracy1000: 0.3757 - 108s/epoch - 48ms/step
Epoch 14/50
2257/2257 - 106s - loss: 2.9875 - accuracy1000: 0.5083 - val_loss: 3.7145 - val_accuracy1000: 0.3752 - 106s/epoch - 47ms/step
Epoch 15/50
2257/2257 - 102s - loss: 2.9781 - accuracy1000: 0.5110 - val_loss: 3.7189 - val_accuracy1000: 0.3830 - 102s/epoch - 45ms/step
Epoch 16/50
2257/2257 - 110s - loss: 2.9817 - accuracy1000: 0.5090 - val_loss: 3.8765 - val_accuracy1000: 0.3940 - 110s/epoch - 49ms/step
testing model: results/AAL/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
7177/7177 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1186167
{'0': {'precision': 0.3995049520383319, 'recall': 0.5186520249305236, 'f1-score': 0.4513477706796995, 'support': 741260}, '1': {'precision': 0.21748687605921568, 'recall': 0.36451652810768015, 'f1-score': 0.27242988753157515, 'support': 404160}, '2': {'precision': 0.40060292850990525, 'recall': 0.11431334930436379, 'f1-score': 0.1778707120834969, 'support': 691669}, 'accuracy': 0.3325075704007808, 'macro avg': {'precision': 0.3391982522024843, 'recall': 0.3324939674475225, 'f1-score': 0.3005494567649239, 'support': 1837089}, 'weighted avg': {'precision': 0.35987432483431353, 'recall': 0.3325075704007808, 'f1-score': 0.3090209398645769, 'support': 1837089}}
[[384456 280295  76509]
 [215043 147323  41794]
 [362832 249770  79067]]
Evaluating performance on  train set...
2257/2257 - 46s - 46s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1181027
{'0': {'precision': 0.35291323942523395, 'recall': 0.5283820993070895, 'f1-score': 0.4231794498970072, 'support': 198294}, '1': {'precision': 0.3725293274489834, 'recall': 0.42208142572480223, 'f1-score': 0.3957603368087819, 'support': 187189}, '2': {'precision': 0.38436757481669365, 'recall': 0.1372675592945047, 'f1-score': 0.2022915843540103, 'support': 192092}, 'accuracy': 0.36385231355235254, 'macro avg': {'precision': 0.3699367138969703, 'recall': 0.36257702810879877, 'f1-score': 0.3404104570199331, 'support': 577575}, 'weighted avg': {'precision': 0.3697319072953702, 'recall': 0.36385231355235254, 'f1-score': 0.34082936856080465, 'support': 577575}}
[[104775  67359  26160]
 [ 92107  79009  16073]
 [100004  65720  26368]]
Evaluating performance on  val set...
638/638 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091663
{'0': {'precision': 0.4128126070572114, 'recall': 0.5244398421202707, 'f1-score': 0.46197879484942234, 'support': 66633}, '1': {'precision': 0.2150408365773605, 'recall': 0.3249235914883801, 'f1-score': 0.25880164435156056, 'support': 34682}, '2': {'precision': 0.39097172001674724, 'recall': 0.16564268782352087, 'f1-score': 0.232698276057359, 'support': 62013}, 'accuracy': 0.3458439459247649, 'macro avg': {'precision': 0.33960838788377307, 'recall': 0.3383353738107239, 'f1-score': 0.3178262384194473, 'support': 163328}, 'weighted avg': {'precision': 0.3625239886217778, 'recall': 0.3458439459247649, 'f1-score': 0.3317808940276461, 'support': 163328}}
[[34945 20993 10695]
 [18107 11269  5306]
 [31599 20142 10272]]
training model: results/AAL/W1/deepOF_L1/h10
Epoch 1/50
2257/2257 - 97s - loss: 3.0837 - accuracy10: 0.3838 - val_loss: 3.1283 - val_accuracy10: 0.6969 - 97s/epoch - 43ms/step
Epoch 2/50
2257/2257 - 91s - loss: 3.0317 - accuracy10: 0.3900 - val_loss: 3.0497 - val_accuracy10: 0.6954 - 91s/epoch - 40ms/step
Epoch 3/50
2257/2257 - 97s - loss: 2.9973 - accuracy10: 0.4076 - val_loss: 3.0880 - val_accuracy10: 0.7002 - 97s/epoch - 43ms/step
Epoch 4/50
2257/2257 - 95s - loss: 2.9727 - accuracy10: 0.4210 - val_loss: 3.1171 - val_accuracy10: 0.7079 - 95s/epoch - 42ms/step
Epoch 5/50
2257/2257 - 93s - loss: 2.9527 - accuracy10: 0.4291 - val_loss: 3.0294 - val_accuracy10: 0.7107 - 93s/epoch - 41ms/step
Epoch 6/50
2257/2257 - 94s - loss: 2.9348 - accuracy10: 0.4402 - val_loss: 3.0561 - val_accuracy10: 0.7172 - 94s/epoch - 42ms/step
Epoch 7/50
2257/2257 - 94s - loss: 2.9210 - accuracy10: 0.4524 - val_loss: 3.0538 - val_accuracy10: 0.7222 - 94s/epoch - 42ms/step
Epoch 8/50
2257/2257 - 86s - loss: 2.9016 - accuracy10: 0.4630 - val_loss: 3.0854 - val_accuracy10: 0.7286 - 86s/epoch - 38ms/step
Epoch 9/50
2257/2257 - 89s - loss: 2.8862 - accuracy10: 0.4716 - val_loss: 3.1005 - val_accuracy10: 0.7325 - 89s/epoch - 39ms/step
Epoch 10/50
2257/2257 - 89s - loss: 2.8715 - accuracy10: 0.4767 - val_loss: 3.1191 - val_accuracy10: 0.7332 - 89s/epoch - 39ms/step
Epoch 11/50
2257/2257 - 88s - loss: 2.8570 - accuracy10: 0.4816 - val_loss: 3.1271 - val_accuracy10: 0.7337 - 88s/epoch - 39ms/step
Epoch 12/50
2257/2257 - 87s - loss: 2.8465 - accuracy10: 0.4837 - val_loss: 3.1338 - val_accuracy10: 0.7363 - 87s/epoch - 39ms/step
Epoch 13/50
2257/2257 - 96s - loss: 2.8319 - accuracy10: 0.4893 - val_loss: 3.1651 - val_accuracy10: 0.7366 - 96s/epoch - 43ms/step
Epoch 14/50
2257/2257 - 90s - loss: 2.8187 - accuracy10: 0.4920 - val_loss: 3.1316 - val_accuracy10: 0.7364 - 90s/epoch - 40ms/step
Epoch 15/50
2257/2257 - 96s - loss: 2.8064 - accuracy10: 0.4941 - val_loss: 3.0838 - val_accuracy10: 0.7334 - 96s/epoch - 43ms/step
testing model: results/AAL/W1/deepOF_L1/h10
Evaluating performance on  test set...
7177/7177 - 119s - 119s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81850284
{'0': {'precision': 0.2833818589025756, 'recall': 0.2438779935431022, 'f1-score': 0.262150053090928, 'support': 207530}, '1': {'precision': 0.8060065260779117, 'recall': 0.8044570264989028, 'f1-score': 0.8052310308667113, 'support': 1423191}, '2': {'precision': 0.26926550966478874, 'recall': 0.31058377713059027, 'f1-score': 0.2884525373994131, 'support': 206363}, 'accuracy': 0.6856523708224556, 'macro avg': {'precision': 0.45288463154842534, 'recall': 0.45297293239086506, 'f1-score': 0.4519445404523508, 'support': 1837084}, 'weighted avg': {'precision': 0.6866740494198172, 'recall': 0.6856523708224556, 'f1-score': 0.6858300913532211, 'support': 1837084}}
[[  50612  145204   11714]
 [ 116073 1144896  162222]
 [  11915  130355   64093]]
Evaluating performance on  train set...
2257/2257 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79415476
{'0': {'precision': 0.3009138831979006, 'recall': 0.1940127936833044, 'f1-score': 0.23591835261419628, 'support': 67377}, '1': {'precision': 0.791069620826166, 'recall': 0.8682562517078856, 'f1-score': 0.827867696379103, 'support': 442799}, '2': {'precision': 0.2951650771883895, 'recall': 0.21077776788628744, 'f1-score': 0.24593385096124712, 'support': 67398}, 'accuracy': 0.7128800811670886, 'macro avg': {'precision': 0.46238286040415205, 'recall': 0.42434893775915916, 'f1-score': 0.43657329998484884, 'support': 577574}, 'weighted avg': {'precision': 0.6760225488210575, 'recall': 0.7128800811670886, 'f1-score': 0.6909069809585322, 'support': 577574}}
[[ 13072  51517   2788]
 [ 27201 384463  31135]
 [  3168  50024  14206]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79584205
{'0': {'precision': 0.3115931189229619, 'recall': 0.23412386197594695, 'f1-score': 0.26735977409831857, 'support': 17794}, '1': {'precision': 0.8108403138384566, 'recall': 0.8394707101148993, 'f1-score': 0.824907164974492, 'support': 127416}, '2': {'precision': 0.2831171710453387, 'recall': 0.2819451344041508, 'f1-score': 0.28252993722171527, 'support': 18117}, 'accuracy': 0.711676575214141, 'macro avg': {'precision': 0.4685168679355857, 'recall': 0.4518465688316657, 'f1-score': 0.45826562543150856, 'support': 163327}, 'weighted avg': {'precision': 0.6979112527260304, 'recall': 0.711676575214141, 'f1-score': 0.7040009675396056, 'support': 163327}}
[[  4166  12659    969]
 [  8489 106962  11965]
 [   715  12294   5108]]
training model: results/AAL/W1/deepOF_L1/h20
Epoch 1/50
2257/2257 - 100s - loss: 3.1012 - accuracy20: 0.3999 - val_loss: 3.1763 - val_accuracy20: 0.6458 - 100s/epoch - 44ms/step
Epoch 2/50
2257/2257 - 101s - loss: 3.0630 - accuracy20: 0.3960 - val_loss: 3.1364 - val_accuracy20: 0.6599 - 101s/epoch - 45ms/step
Epoch 3/50
2257/2257 - 98s - loss: 3.0290 - accuracy20: 0.4170 - val_loss: 3.1599 - val_accuracy20: 0.6689 - 98s/epoch - 43ms/step
Epoch 4/50
2257/2257 - 96s - loss: 3.0046 - accuracy20: 0.4291 - val_loss: 3.1398 - val_accuracy20: 0.6742 - 96s/epoch - 43ms/step
Epoch 5/50
2257/2257 - 93s - loss: 2.9842 - accuracy20: 0.4420 - val_loss: 3.1076 - val_accuracy20: 0.6781 - 93s/epoch - 41ms/step
Epoch 6/50
2257/2257 - 94s - loss: 2.9668 - accuracy20: 0.4534 - val_loss: 3.0670 - val_accuracy20: 0.6815 - 94s/epoch - 42ms/step
Epoch 7/50
2257/2257 - 96s - loss: 2.9485 - accuracy20: 0.4617 - val_loss: 3.0918 - val_accuracy20: 0.6818 - 96s/epoch - 43ms/step
Epoch 8/50
2257/2257 - 90s - loss: 2.9308 - accuracy20: 0.4710 - val_loss: 3.1356 - val_accuracy20: 0.6850 - 90s/epoch - 40ms/step
Epoch 9/50
2257/2257 - 94s - loss: 2.9154 - accuracy20: 0.4756 - val_loss: 3.1120 - val_accuracy20: 0.6851 - 94s/epoch - 42ms/step
Epoch 10/50
2257/2257 - 90s - loss: 2.9044 - accuracy20: 0.4795 - val_loss: 3.0815 - val_accuracy20: 0.6876 - 90s/epoch - 40ms/step
Epoch 11/50
2257/2257 - 94s - loss: 2.8918 - accuracy20: 0.4855 - val_loss: 3.0199 - val_accuracy20: 0.6827 - 94s/epoch - 42ms/step
Epoch 12/50
2257/2257 - 96s - loss: 2.8770 - accuracy20: 0.4897 - val_loss: 3.0416 - val_accuracy20: 0.6821 - 96s/epoch - 43ms/step
Epoch 13/50
2257/2257 - 97s - loss: 2.8654 - accuracy20: 0.4933 - val_loss: 3.0254 - val_accuracy20: 0.6819 - 97s/epoch - 43ms/step
Epoch 14/50
2257/2257 - 94s - loss: 2.8510 - accuracy20: 0.4983 - val_loss: 3.0086 - val_accuracy20: 0.6780 - 94s/epoch - 42ms/step
Epoch 15/50
2257/2257 - 95s - loss: 2.8367 - accuracy20: 0.5033 - val_loss: 3.0023 - val_accuracy20: 0.6781 - 95s/epoch - 42ms/step
Epoch 16/50
2257/2257 - 100s - loss: 2.8276 - accuracy20: 0.5061 - val_loss: 2.9943 - val_accuracy20: 0.6746 - 100s/epoch - 44ms/step
Epoch 17/50
2257/2257 - 101s - loss: 2.8151 - accuracy20: 0.5096 - val_loss: 2.9660 - val_accuracy20: 0.6720 - 101s/epoch - 45ms/step
Epoch 18/50
2257/2257 - 93s - loss: 2.8032 - accuracy20: 0.5137 - val_loss: 2.9692 - val_accuracy20: 0.6688 - 93s/epoch - 41ms/step
Epoch 19/50
2257/2257 - 97s - loss: 2.7916 - accuracy20: 0.5172 - val_loss: 2.9427 - val_accuracy20: 0.6649 - 97s/epoch - 43ms/step
Epoch 20/50
2257/2257 - 94s - loss: 2.7809 - accuracy20: 0.5203 - val_loss: 2.9562 - val_accuracy20: 0.6688 - 94s/epoch - 42ms/step
Epoch 21/50
2257/2257 - 92s - loss: 2.7693 - accuracy20: 0.5232 - val_loss: 2.9816 - val_accuracy20: 0.6678 - 92s/epoch - 41ms/step
Epoch 22/50
2257/2257 - 94s - loss: 2.7591 - accuracy20: 0.5260 - val_loss: 2.9662 - val_accuracy20: 0.6624 - 94s/epoch - 41ms/step
Epoch 23/50
2257/2257 - 92s - loss: 2.7475 - accuracy20: 0.5293 - val_loss: 2.9493 - val_accuracy20: 0.6528 - 92s/epoch - 41ms/step
Epoch 24/50
2257/2257 - 97s - loss: 2.7401 - accuracy20: 0.5301 - val_loss: 2.9457 - val_accuracy20: 0.6609 - 97s/epoch - 43ms/step
Epoch 25/50
2257/2257 - 96s - loss: 2.7325 - accuracy20: 0.5327 - val_loss: 2.9480 - val_accuracy20: 0.6579 - 96s/epoch - 43ms/step
Epoch 26/50
2257/2257 - 93s - loss: 2.7220 - accuracy20: 0.5341 - val_loss: 2.9554 - val_accuracy20: 0.6638 - 93s/epoch - 41ms/step
Epoch 27/50
2257/2257 - 97s - loss: 2.7138 - accuracy20: 0.5383 - val_loss: 2.9596 - val_accuracy20: 0.6636 - 97s/epoch - 43ms/step
Epoch 28/50
2257/2257 - 98s - loss: 2.7061 - accuracy20: 0.5392 - val_loss: 2.9306 - val_accuracy20: 0.6512 - 98s/epoch - 44ms/step
Epoch 29/50
2257/2257 - 95s - loss: 2.6984 - accuracy20: 0.5414 - val_loss: 2.9428 - val_accuracy20: 0.6581 - 95s/epoch - 42ms/step
Epoch 30/50
2257/2257 - 103s - loss: 2.6910 - accuracy20: 0.5427 - val_loss: 2.9472 - val_accuracy20: 0.6569 - 103s/epoch - 46ms/step
Epoch 31/50
2257/2257 - 95s - loss: 2.6852 - accuracy20: 0.5441 - val_loss: 2.9756 - val_accuracy20: 0.6594 - 95s/epoch - 42ms/step
Epoch 32/50
2257/2257 - 92s - loss: 2.6789 - accuracy20: 0.5467 - val_loss: 2.9582 - val_accuracy20: 0.6501 - 92s/epoch - 41ms/step
Epoch 33/50
2257/2257 - 92s - loss: 2.6719 - accuracy20: 0.5477 - val_loss: 2.9668 - val_accuracy20: 0.6581 - 92s/epoch - 41ms/step
Epoch 34/50
2257/2257 - 95s - loss: 2.6658 - accuracy20: 0.5496 - val_loss: 2.9427 - val_accuracy20: 0.6531 - 95s/epoch - 42ms/step
Epoch 35/50
2257/2257 - 97s - loss: 2.6585 - accuracy20: 0.5512 - val_loss: 2.9243 - val_accuracy20: 0.6476 - 97s/epoch - 43ms/step
Epoch 36/50
2257/2257 - 94s - loss: 2.6514 - accuracy20: 0.5528 - val_loss: 2.9651 - val_accuracy20: 0.6537 - 94s/epoch - 42ms/step
Epoch 37/50
2257/2257 - 91s - loss: 2.6452 - accuracy20: 0.5536 - val_loss: 2.9618 - val_accuracy20: 0.6538 - 91s/epoch - 41ms/step
Epoch 38/50
2257/2257 - 94s - loss: 2.6392 - accuracy20: 0.5559 - val_loss: 2.9304 - val_accuracy20: 0.6486 - 94s/epoch - 42ms/step
Epoch 39/50
2257/2257 - 100s - loss: 2.6341 - accuracy20: 0.5563 - val_loss: 2.9527 - val_accuracy20: 0.6505 - 100s/epoch - 44ms/step
Epoch 40/50
2257/2257 - 99s - loss: 2.6245 - accuracy20: 0.5591 - val_loss: 2.9720 - val_accuracy20: 0.6483 - 99s/epoch - 44ms/step
Epoch 41/50
2257/2257 - 97s - loss: 2.6199 - accuracy20: 0.5590 - val_loss: 2.9630 - val_accuracy20: 0.6425 - 97s/epoch - 43ms/step
Epoch 42/50
2257/2257 - 96s - loss: 2.6160 - accuracy20: 0.5604 - val_loss: 2.9469 - val_accuracy20: 0.6512 - 96s/epoch - 43ms/step
Epoch 43/50
2257/2257 - 92s - loss: 2.6091 - accuracy20: 0.5610 - val_loss: 2.9319 - val_accuracy20: 0.6464 - 92s/epoch - 41ms/step
Epoch 44/50
2257/2257 - 100s - loss: 2.6035 - accuracy20: 0.5614 - val_loss: 2.9390 - val_accuracy20: 0.6458 - 100s/epoch - 44ms/step
Epoch 45/50
2257/2257 - 99s - loss: 2.5989 - accuracy20: 0.5622 - val_loss: 2.9428 - val_accuracy20: 0.6457 - 99s/epoch - 44ms/step
testing model: results/AAL/W1/deepOF_L1/h20
Evaluating performance on  test set...
7177/7177 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8252293
{'0': {'precision': 0.3530643766217719, 'recall': 0.40263363699773835, 'f1-score': 0.3762232836174632, 'support': 283866}, '1': {'precision': 0.7755357549618334, 'recall': 0.7329734248635414, 'f1-score': 0.7536541454581149, 'support': 1272731}, '2': {'precision': 0.3667845478964964, 'recall': 0.40600812158852284, 'f1-score': 0.38540092627532074, 'support': 280487}, 'accuracy': 0.6320081172118422, 'macro avg': {'precision': 0.4984615598267006, 'recall': 0.5138717278166008, 'f1-score': 0.5050927851169663, 'support': 1837084}, 'weighted avg': {'precision': 0.6478471679946533, 'recall': 0.6320081172118422, 'f1-score': 0.6391084688770861, 'support': 1837084}}
[[114294 140066  29506]
 [172757 932878 167096]
 [ 36669 129938 113880]]
Evaluating performance on  train set...
2257/2257 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.816577
{'0': {'precision': 0.3690710337260098, 'recall': 0.3910606559175167, 'f1-score': 0.3797477792216091, 'support': 91170}, '1': {'precision': 0.7733967786460602, 'recall': 0.7397692189239473, 'f1-score': 0.7562093409131377, 'support': 396133}, '2': {'precision': 0.36570549562525106, 'recall': 0.4134771964418252, 'f1-score': 0.3881269042395001, 'support': 90271}, 'accuracy': 0.6337283187955136, 'macro avg': {'precision': 0.502724435999107, 'recall': 0.5147690237610963, 'f1-score': 0.508028008124749, 'support': 577574}, 'weighted avg': {'precision': 0.6458545451418989, 'recall': 0.6337283187955136, 'f1-score': 0.6392560670116418, 'support': 577574}}
[[ 35653  44662  10855]
 [ 49203 293047  53883]
 [ 11746  41200  37325]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7996543
{'0': {'precision': 0.3685597079522788, 'recall': 0.4034523956659663, 'f1-score': 0.38521752812524584, 'support': 24273}, '1': {'precision': 0.7919053710810761, 'recall': 0.7446932780068519, 'f1-score': 0.7675740272342949, 'support': 114713}, '2': {'precision': 0.35987812478360226, 'recall': 0.4270161455979623, 'f1-score': 0.39058301861976963, 'support': 24341}, 'accuracy': 0.6466352776944412, 'macro avg': {'precision': 0.5067810679389857, 'recall': 0.5250539397569268, 'f1-score': 0.5144581913264368, 'support': 163327}, 'weighted avg': {'precision': 0.664603427842958, 'recall': 0.6466352776944412, 'f1-score': 0.6545659058363625, 'support': 163327}}
[[ 9793 11441  3039]
 [13838 85426 15449]
 [ 2940 11007 10394]]
training model: results/AAL/W1/deepOF_L1/h30
Epoch 1/50
2257/2257 - 99s - loss: 3.1257 - accuracy30: 0.4036 - val_loss: 3.2149 - val_accuracy30: 0.6131 - 99s/epoch - 44ms/step
Epoch 2/50
2257/2257 - 91s - loss: 3.0881 - accuracy30: 0.3940 - val_loss: 3.1797 - val_accuracy30: 0.6247 - 91s/epoch - 40ms/step
Epoch 3/50
2257/2257 - 94s - loss: 3.0583 - accuracy30: 0.4123 - val_loss: 3.1625 - val_accuracy30: 0.6288 - 94s/epoch - 42ms/step
Epoch 4/50
2257/2257 - 94s - loss: 3.0355 - accuracy30: 0.4281 - val_loss: 3.1470 - val_accuracy30: 0.6396 - 94s/epoch - 42ms/step
Epoch 5/50
2257/2257 - 88s - loss: 3.0123 - accuracy30: 0.4447 - val_loss: 3.1287 - val_accuracy30: 0.6411 - 88s/epoch - 39ms/step
Epoch 6/50
2257/2257 - 98s - loss: 2.9919 - accuracy30: 0.4556 - val_loss: 3.2017 - val_accuracy30: 0.6429 - 98s/epoch - 44ms/step
Epoch 7/50
2257/2257 - 98s - loss: 2.9757 - accuracy30: 0.4652 - val_loss: 3.0988 - val_accuracy30: 0.6456 - 98s/epoch - 43ms/step
Epoch 8/50
2257/2257 - 95s - loss: 2.9611 - accuracy30: 0.4701 - val_loss: 3.1283 - val_accuracy30: 0.6469 - 95s/epoch - 42ms/step
Epoch 9/50
2257/2257 - 98s - loss: 2.9479 - accuracy30: 0.4764 - val_loss: 3.1122 - val_accuracy30: 0.6441 - 98s/epoch - 44ms/step
Epoch 10/50
2257/2257 - 98s - loss: 2.9319 - accuracy30: 0.4814 - val_loss: 3.1539 - val_accuracy30: 0.6481 - 98s/epoch - 43ms/step
Epoch 11/50
2257/2257 - 97s - loss: 2.9207 - accuracy30: 0.4844 - val_loss: 3.1663 - val_accuracy30: 0.6500 - 97s/epoch - 43ms/step
Epoch 12/50
2257/2257 - 100s - loss: 2.9097 - accuracy30: 0.4887 - val_loss: 3.1229 - val_accuracy30: 0.6494 - 100s/epoch - 44ms/step
Epoch 13/50
2257/2257 - 93s - loss: 2.8977 - accuracy30: 0.4932 - val_loss: 3.1239 - val_accuracy30: 0.6463 - 93s/epoch - 41ms/step
Epoch 14/50
2257/2257 - 93s - loss: 2.8888 - accuracy30: 0.4943 - val_loss: 3.0784 - val_accuracy30: 0.6400 - 93s/epoch - 41ms/step
Epoch 15/50
2257/2257 - 98s - loss: 2.8735 - accuracy30: 0.4985 - val_loss: 3.0538 - val_accuracy30: 0.6414 - 98s/epoch - 43ms/step
Epoch 16/50
2257/2257 - 96s - loss: 2.8618 - accuracy30: 0.5027 - val_loss: 3.0457 - val_accuracy30: 0.6382 - 96s/epoch - 43ms/step
Epoch 17/50
2257/2257 - 95s - loss: 2.8479 - accuracy30: 0.5049 - val_loss: 3.0171 - val_accuracy30: 0.6384 - 95s/epoch - 42ms/step
Epoch 18/50
2257/2257 - 97s - loss: 2.8367 - accuracy30: 0.5075 - val_loss: 3.0270 - val_accuracy30: 0.6371 - 97s/epoch - 43ms/step
Epoch 19/50
2257/2257 - 99s - loss: 2.8247 - accuracy30: 0.5119 - val_loss: 3.0433 - val_accuracy30: 0.6391 - 99s/epoch - 44ms/step
Epoch 20/50
2257/2257 - 100s - loss: 2.8149 - accuracy30: 0.5153 - val_loss: 3.0274 - val_accuracy30: 0.6365 - 100s/epoch - 44ms/step
Epoch 21/50
2257/2257 - 93s - loss: 2.8058 - accuracy30: 0.5164 - val_loss: 3.0000 - val_accuracy30: 0.6341 - 93s/epoch - 41ms/step
Epoch 22/50
2257/2257 - 100s - loss: 2.7971 - accuracy30: 0.5193 - val_loss: 3.0348 - val_accuracy30: 0.6400 - 100s/epoch - 44ms/step
Epoch 23/50
2257/2257 - 100s - loss: 2.7854 - accuracy30: 0.5234 - val_loss: 3.0203 - val_accuracy30: 0.6322 - 100s/epoch - 45ms/step
Epoch 24/50
2257/2257 - 101s - loss: 2.7779 - accuracy30: 0.5256 - val_loss: 2.9984 - val_accuracy30: 0.6352 - 101s/epoch - 45ms/step
Epoch 25/50
2257/2257 - 100s - loss: 2.7685 - accuracy30: 0.5275 - val_loss: 3.0195 - val_accuracy30: 0.6373 - 100s/epoch - 44ms/step
Epoch 26/50
2257/2257 - 97s - loss: 2.7606 - accuracy30: 0.5301 - val_loss: 3.0197 - val_accuracy30: 0.6378 - 97s/epoch - 43ms/step
Epoch 27/50
2257/2257 - 98s - loss: 2.7537 - accuracy30: 0.5321 - val_loss: 3.0085 - val_accuracy30: 0.6376 - 98s/epoch - 44ms/step
Epoch 28/50
2257/2257 - 89s - loss: 2.7474 - accuracy30: 0.5336 - val_loss: 3.0166 - val_accuracy30: 0.6373 - 89s/epoch - 39ms/step
Epoch 29/50
2257/2257 - 96s - loss: 2.7407 - accuracy30: 0.5354 - val_loss: 3.0166 - val_accuracy30: 0.6374 - 96s/epoch - 43ms/step
Epoch 30/50
2257/2257 - 90s - loss: 2.7323 - accuracy30: 0.5378 - val_loss: 3.0184 - val_accuracy30: 0.6371 - 90s/epoch - 40ms/step
Epoch 31/50
2257/2257 - 100s - loss: 2.7246 - accuracy30: 0.5397 - val_loss: 3.0133 - val_accuracy30: 0.6390 - 100s/epoch - 44ms/step
Epoch 32/50
2257/2257 - 91s - loss: 2.7202 - accuracy30: 0.5399 - val_loss: 3.0047 - val_accuracy30: 0.6340 - 91s/epoch - 40ms/step
Epoch 33/50
2257/2257 - 99s - loss: 2.7129 - accuracy30: 0.5420 - val_loss: 2.9909 - val_accuracy30: 0.6313 - 99s/epoch - 44ms/step
Epoch 34/50
2257/2257 - 97s - loss: 2.7035 - accuracy30: 0.5440 - val_loss: 2.9988 - val_accuracy30: 0.6347 - 97s/epoch - 43ms/step
Epoch 35/50
2257/2257 - 100s - loss: 2.7005 - accuracy30: 0.5450 - val_loss: 3.0003 - val_accuracy30: 0.6325 - 100s/epoch - 44ms/step
Epoch 36/50
2257/2257 - 99s - loss: 2.6923 - accuracy30: 0.5469 - val_loss: 3.0063 - val_accuracy30: 0.6331 - 99s/epoch - 44ms/step
Epoch 37/50
2257/2257 - 98s - loss: 2.6859 - accuracy30: 0.5479 - val_loss: 3.0114 - val_accuracy30: 0.6325 - 98s/epoch - 43ms/step
Epoch 38/50
2257/2257 - 99s - loss: 2.6795 - accuracy30: 0.5494 - val_loss: 3.0230 - val_accuracy30: 0.6349 - 99s/epoch - 44ms/step
Epoch 39/50
2257/2257 - 98s - loss: 2.6731 - accuracy30: 0.5511 - val_loss: 3.0470 - val_accuracy30: 0.6362 - 98s/epoch - 43ms/step
Epoch 40/50
2257/2257 - 99s - loss: 2.6666 - accuracy30: 0.5517 - val_loss: 3.0251 - val_accuracy30: 0.6311 - 99s/epoch - 44ms/step
Epoch 41/50
2257/2257 - 101s - loss: 2.6631 - accuracy30: 0.5528 - val_loss: 3.0362 - val_accuracy30: 0.6359 - 101s/epoch - 45ms/step
Epoch 42/50
2257/2257 - 97s - loss: 2.6560 - accuracy30: 0.5542 - val_loss: 3.0466 - val_accuracy30: 0.6345 - 97s/epoch - 43ms/step
Epoch 43/50
2257/2257 - 96s - loss: 2.6523 - accuracy30: 0.5555 - val_loss: 3.0304 - val_accuracy30: 0.6301 - 96s/epoch - 43ms/step
testing model: results/AAL/W1/deepOF_L1/h30
Evaluating performance on  test set...
7177/7177 - 129s - 129s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86830914
{'0': {'precision': 0.39693504202359287, 'recall': 0.37361500096474864, 'f1-score': 0.3849221408993705, 'support': 342058}, '1': {'precision': 0.7050656681303771, 'recall': 0.7654138921890974, 'f1-score': 0.734001439877656, 'support': 1158176}, '2': {'precision': 0.42352462036731764, 'recall': 0.3241531839097521, 'f1-score': 0.3672353341797483, 'support': 336850}, 'accuracy': 0.6115523296702818, 'macro avg': {'precision': 0.5085084435070959, 'recall': 0.48772735902119946, 'f1-score': 0.4953863049855916, 'support': 1837084}, 'weighted avg': {'precision': 0.5960692108949861, 'recall': 0.6115523296702818, 'f1-score': 0.6017535244016872, 'support': 1837084}}
[[127798 185673  28587]
 [151655 886484 120037]
 [ 42509 185150 109191]]
Evaluating performance on  train set...
2257/2257 - 43s - 43s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85279894
{'0': {'precision': 0.4072722533559234, 'recall': 0.37532682304899345, 'f1-score': 0.39064753735792446, 'support': 108239}, '1': {'precision': 0.7097958473055932, 'recall': 0.7754567031367587, 'f1-score': 0.7411748897355234, 'support': 362763}, '2': {'precision': 0.43181929721240675, 'recall': 0.33024621851893554, 'f1-score': 0.3742635955677492, 'support': 106572}, 'accuracy': 0.6183225006665812, 'macro avg': {'precision': 0.5162957992913078, 'recall': 0.4936765815682292, 'f1-score': 0.502028674220399, 'support': 577574}, 'weighted avg': {'precision': 0.6018107784104397, 'recall': 0.6183225006665812, 'f1-score': 0.6077838428115847, 'support': 577574}}
[[ 40625  57410  10204]
 [ 45351 281307  36105]
 [ 13773  57604  35195]]
Evaluating performance on  val set...
638/638 - 13s - 13s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83632547
{'0': {'precision': 0.40617054381237905, 'recall': 0.3699747658059387, 'f1-score': 0.38722865412445734, 'support': 28929}, '1': {'precision': 0.7305281609093646, 'recall': 0.7818667626799064, 'f1-score': 0.7553261113323174, 'support': 105541}, '2': {'precision': 0.4194354234324257, 'recall': 0.34910073812246595, 'f1-score': 0.3810496453900709, 'support': 28857}, 'accuracy': 0.6324490133290883, 'macro avg': {'precision': 0.5187113760513897, 'recall': 0.500314088869437, 'f1-score': 0.5078681369489485, 'support': 163327}, 'weighted avg': {'precision': 0.6181123041902018, 'recall': 0.6324490133290883, 'f1-score': 0.6239994640709241, 'support': 163327}}
[[10703 15132  3094]
 [12172 82519 10850]
 [ 3476 15307 10074]]
training model: results/AAL/W1/deepOF_L1/h50
Epoch 1/50
2257/2257 - 107s - loss: 3.1664 - accuracy50: 0.4174 - val_loss: 3.3017 - val_accuracy50: 0.5513 - 107s/epoch - 47ms/step
Epoch 2/50
2257/2257 - 95s - loss: 3.1400 - accuracy50: 0.4068 - val_loss: 3.2376 - val_accuracy50: 0.5560 - 95s/epoch - 42ms/step
Epoch 3/50
2257/2257 - 99s - loss: 3.1141 - accuracy50: 0.4233 - val_loss: 3.2216 - val_accuracy50: 0.5610 - 99s/epoch - 44ms/step
Epoch 4/50
2257/2257 - 102s - loss: 3.0927 - accuracy50: 0.4381 - val_loss: 3.2260 - val_accuracy50: 0.5659 - 102s/epoch - 45ms/step
Epoch 5/50
2257/2257 - 105s - loss: 3.0772 - accuracy50: 0.4454 - val_loss: 3.2067 - val_accuracy50: 0.5694 - 105s/epoch - 47ms/step
Epoch 6/50
2257/2257 - 101s - loss: 3.0611 - accuracy50: 0.4535 - val_loss: 3.2305 - val_accuracy50: 0.5701 - 101s/epoch - 45ms/step
Epoch 7/50
2257/2257 - 103s - loss: 3.0477 - accuracy50: 0.4583 - val_loss: 3.2219 - val_accuracy50: 0.5733 - 103s/epoch - 45ms/step
Epoch 8/50
2257/2257 - 104s - loss: 3.0309 - accuracy50: 0.4640 - val_loss: 3.2139 - val_accuracy50: 0.5736 - 104s/epoch - 46ms/step
Epoch 9/50
2257/2257 - 106s - loss: 3.0207 - accuracy50: 0.4674 - val_loss: 3.1872 - val_accuracy50: 0.5720 - 106s/epoch - 47ms/step
Epoch 10/50
2257/2257 - 90s - loss: 3.0080 - accuracy50: 0.4721 - val_loss: 3.1998 - val_accuracy50: 0.5746 - 90s/epoch - 40ms/step
Epoch 11/50
2257/2257 - 97s - loss: 2.9963 - accuracy50: 0.4766 - val_loss: 3.1825 - val_accuracy50: 0.5722 - 97s/epoch - 43ms/step
Epoch 12/50
2257/2257 - 102s - loss: 2.9859 - accuracy50: 0.4804 - val_loss: 3.1861 - val_accuracy50: 0.5733 - 102s/epoch - 45ms/step
Epoch 13/50
2257/2257 - 99s - loss: 2.9736 - accuracy50: 0.4841 - val_loss: 3.1812 - val_accuracy50: 0.5740 - 99s/epoch - 44ms/step
Epoch 14/50
2257/2257 - 98s - loss: 2.9641 - accuracy50: 0.4873 - val_loss: 3.1753 - val_accuracy50: 0.5727 - 98s/epoch - 44ms/step
Epoch 15/50
2257/2257 - 102s - loss: 2.9548 - accuracy50: 0.4902 - val_loss: 3.1522 - val_accuracy50: 0.5744 - 102s/epoch - 45ms/step
Epoch 16/50
2257/2257 - 98s - loss: 2.9444 - accuracy50: 0.4948 - val_loss: 3.1515 - val_accuracy50: 0.5727 - 98s/epoch - 44ms/step
Epoch 17/50
2257/2257 - 96s - loss: 2.9351 - accuracy50: 0.4973 - val_loss: 3.1417 - val_accuracy50: 0.5729 - 96s/epoch - 42ms/step
Epoch 18/50
2257/2257 - 100s - loss: 2.9248 - accuracy50: 0.5005 - val_loss: 3.1324 - val_accuracy50: 0.5745 - 100s/epoch - 44ms/step
Epoch 19/50
2257/2257 - 99s - loss: 2.9132 - accuracy50: 0.5049 - val_loss: 3.1408 - val_accuracy50: 0.5746 - 99s/epoch - 44ms/step
Epoch 20/50
2257/2257 - 98s - loss: 2.9055 - accuracy50: 0.5074 - val_loss: 3.1363 - val_accuracy50: 0.5761 - 98s/epoch - 43ms/step
Epoch 21/50
2257/2257 - 96s - loss: 2.8963 - accuracy50: 0.5093 - val_loss: 3.1412 - val_accuracy50: 0.5739 - 96s/epoch - 42ms/step
Epoch 22/50
2257/2257 - 102s - loss: 2.8862 - accuracy50: 0.5123 - val_loss: 3.1457 - val_accuracy50: 0.5750 - 102s/epoch - 45ms/step
Epoch 23/50
2257/2257 - 102s - loss: 2.8774 - accuracy50: 0.5144 - val_loss: 3.1377 - val_accuracy50: 0.5741 - 102s/epoch - 45ms/step
Epoch 24/50
2257/2257 - 105s - loss: 2.8720 - accuracy50: 0.5159 - val_loss: 3.1236 - val_accuracy50: 0.5737 - 105s/epoch - 47ms/step
Epoch 25/50
2257/2257 - 105s - loss: 2.8633 - accuracy50: 0.5183 - val_loss: 3.1312 - val_accuracy50: 0.5781 - 105s/epoch - 46ms/step
Epoch 26/50
2257/2257 - 109s - loss: 2.8575 - accuracy50: 0.5191 - val_loss: 3.1077 - val_accuracy50: 0.5735 - 109s/epoch - 48ms/step
Epoch 27/50
2257/2257 - 101s - loss: 2.8500 - accuracy50: 0.5219 - val_loss: 3.1177 - val_accuracy50: 0.5698 - 101s/epoch - 45ms/step
Epoch 28/50
2257/2257 - 104s - loss: 2.8420 - accuracy50: 0.5236 - val_loss: 3.1758 - val_accuracy50: 0.5766 - 104s/epoch - 46ms/step
Epoch 29/50
2257/2257 - 97s - loss: 2.8352 - accuracy50: 0.5258 - val_loss: 3.1210 - val_accuracy50: 0.5771 - 97s/epoch - 43ms/step
Epoch 30/50
2257/2257 - 100s - loss: 2.8302 - accuracy50: 0.5269 - val_loss: 3.1440 - val_accuracy50: 0.5773 - 100s/epoch - 44ms/step
Epoch 31/50
2257/2257 - 99s - loss: 2.8229 - accuracy50: 0.5289 - val_loss: 3.1582 - val_accuracy50: 0.5775 - 99s/epoch - 44ms/step
Epoch 32/50
2257/2257 - 105s - loss: 2.8192 - accuracy50: 0.5289 - val_loss: 3.1564 - val_accuracy50: 0.5777 - 105s/epoch - 47ms/step
Epoch 33/50
2257/2257 - 105s - loss: 2.8101 - accuracy50: 0.5314 - val_loss: 3.1507 - val_accuracy50: 0.5767 - 105s/epoch - 46ms/step
Epoch 34/50
2257/2257 - 106s - loss: 2.8051 - accuracy50: 0.5327 - val_loss: 3.1889 - val_accuracy50: 0.5780 - 106s/epoch - 47ms/step
Epoch 35/50
2257/2257 - 104s - loss: 2.8000 - accuracy50: 0.5342 - val_loss: 3.1458 - val_accuracy50: 0.5755 - 104s/epoch - 46ms/step
Epoch 36/50
2257/2257 - 103s - loss: 2.7924 - accuracy50: 0.5361 - val_loss: 3.1538 - val_accuracy50: 0.5739 - 103s/epoch - 46ms/step
testing model: results/AAL/W1/deepOF_L1/h50
Evaluating performance on  test set...
7177/7177 - 131s - 131s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96628
{'0': {'precision': 0.47287165312514373, 'recall': 0.2596702082955404, 'f1-score': 0.33524549825978167, 'support': 435487}, '1': {'precision': 0.5837455182177073, 'recall': 0.7964042804817132, 'f1-score': 0.6736912614249446, 'support': 974937}, '2': {'precision': 0.44520154124165534, 'recall': 0.27947546055407113, 'f1-score': 0.3433885868313136, 'support': 426660}, 'accuracy': 0.5491137041093385, 'macro avg': {'precision': 0.5006062375281687, 'recall': 0.44518331644377485, 'f1-score': 0.4507751155053466, 'support': 1837084}, 'weighted avg': {'precision': 0.5252858614441642, 'recall': 0.5491137041093385, 'f1-score': 0.5167492439637802, 'support': 1837084}}
[[113083 280873  41531]
 [ 91429 776444 107064]
 [ 34629 272790 119241]]
Evaluating performance on  train set...
2257/2257 - 46s - 46s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94199723
{'0': {'precision': 0.4525570331927776, 'recall': 0.31084161981924446, 'f1-score': 0.3685454793591815, 'support': 134657}, '1': {'precision': 0.6000282128635809, 'recall': 0.7793267268174615, 'f1-score': 0.678024212154177, 'support': 311107}, '2': {'precision': 0.45764260057027883, 'recall': 0.28127607920491615, 'f1-score': 0.34841159085249246, 'support': 131810}, 'accuracy': 0.5564412525494569, 'macro avg': {'precision': 0.503409282208879, 'recall': 0.45714814194720743, 'f1-score': 0.464993760788617, 'support': 577574}, 'weighted avg': {'precision': 0.5331521516189413, 'recall': 0.5564412525494569, 'f1-score': 0.5306496465820585, 'support': 577574}}
[[ 41857  79639  13161]
 [ 37876 242454  30777]
 [ 12757  81978  37075]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92498285
{'0': {'precision': 0.4577508133298162, 'recall': 0.28866894008705535, 'f1-score': 0.3540593386040976, 'support': 36069}, '1': {'precision': 0.6226149138790525, 'recall': 0.7918151411144875, 'f1-score': 0.6970947968089919, 'support': 91486}, '2': {'precision': 0.4456319894358932, 'recall': 0.3018841552051884, 'f1-score': 0.3599366719440047, 'support': 35772}, 'accuracy': 0.5733957030986916, 'macro avg': {'precision': 0.508665905548254, 'recall': 0.46078941213557706, 'f1-score': 0.47036360245236475, 'support': 163327}, 'weighted avg': {'precision': 0.5474435312179426, 'recall': 0.5733957030986916, 'f1-score': 0.5474945079121, 'support': 163327}}
[[10412 21927  3730]
 [ 9342 72440  9704]
 [ 2992 21981 10799]]
training model: results/AAL/W1/deepOF_L1/h100
Epoch 1/50
2257/2257 - 106s - loss: 3.2185 - accuracy100: 0.4184 - val_loss: 3.3634 - val_accuracy100: 0.4230 - 106s/epoch - 47ms/step
Epoch 2/50
2257/2257 - 103s - loss: 3.2020 - accuracy100: 0.4207 - val_loss: 3.3283 - val_accuracy100: 0.4263 - 103s/epoch - 46ms/step
Epoch 3/50
2257/2257 - 100s - loss: 3.1872 - accuracy100: 0.4262 - val_loss: 3.3349 - val_accuracy100: 0.4300 - 100s/epoch - 44ms/step
Epoch 4/50
2257/2257 - 98s - loss: 3.1717 - accuracy100: 0.4335 - val_loss: 3.3538 - val_accuracy100: 0.4330 - 98s/epoch - 43ms/step
Epoch 5/50
2257/2257 - 103s - loss: 3.1587 - accuracy100: 0.4393 - val_loss: 3.3509 - val_accuracy100: 0.4368 - 103s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 99s - loss: 3.1464 - accuracy100: 0.4447 - val_loss: 3.3685 - val_accuracy100: 0.4386 - 99s/epoch - 44ms/step
Epoch 7/50
2257/2257 - 99s - loss: 3.1356 - accuracy100: 0.4494 - val_loss: 3.3517 - val_accuracy100: 0.4424 - 99s/epoch - 44ms/step
Epoch 8/50
2257/2257 - 104s - loss: 3.1273 - accuracy100: 0.4524 - val_loss: 3.3486 - val_accuracy100: 0.4454 - 104s/epoch - 46ms/step
Epoch 9/50
2257/2257 - 101s - loss: 3.1196 - accuracy100: 0.4556 - val_loss: 3.3546 - val_accuracy100: 0.4473 - 101s/epoch - 45ms/step
Epoch 10/50
2257/2257 - 100s - loss: 3.1129 - accuracy100: 0.4574 - val_loss: 3.3283 - val_accuracy100: 0.4495 - 100s/epoch - 44ms/step
Epoch 11/50
2257/2257 - 104s - loss: 3.1045 - accuracy100: 0.4613 - val_loss: 3.3241 - val_accuracy100: 0.4503 - 104s/epoch - 46ms/step
Epoch 12/50
2257/2257 - 98s - loss: 3.0959 - accuracy100: 0.4639 - val_loss: 3.3172 - val_accuracy100: 0.4524 - 98s/epoch - 43ms/step
Epoch 13/50
2257/2257 - 105s - loss: 3.0893 - accuracy100: 0.4667 - val_loss: 3.3150 - val_accuracy100: 0.4525 - 105s/epoch - 46ms/step
Epoch 14/50
2257/2257 - 100s - loss: 3.0843 - accuracy100: 0.4685 - val_loss: 3.3042 - val_accuracy100: 0.4537 - 100s/epoch - 44ms/step
Epoch 15/50
2257/2257 - 103s - loss: 3.0784 - accuracy100: 0.4712 - val_loss: 3.3067 - val_accuracy100: 0.4546 - 103s/epoch - 46ms/step
Epoch 16/50
2257/2257 - 97s - loss: 3.0724 - accuracy100: 0.4727 - val_loss: 3.2933 - val_accuracy100: 0.4547 - 97s/epoch - 43ms/step
Epoch 17/50
2257/2257 - 93s - loss: 3.0657 - accuracy100: 0.4753 - val_loss: 3.2853 - val_accuracy100: 0.4547 - 93s/epoch - 41ms/step
Epoch 18/50
2257/2257 - 99s - loss: 3.0591 - accuracy100: 0.4781 - val_loss: 3.2825 - val_accuracy100: 0.4538 - 99s/epoch - 44ms/step
Epoch 19/50
2257/2257 - 103s - loss: 3.0562 - accuracy100: 0.4791 - val_loss: 3.2721 - val_accuracy100: 0.4557 - 103s/epoch - 46ms/step
Epoch 20/50
2257/2257 - 103s - loss: 3.0498 - accuracy100: 0.4801 - val_loss: 3.2638 - val_accuracy100: 0.4554 - 103s/epoch - 45ms/step
Epoch 21/50
2257/2257 - 102s - loss: 3.0446 - accuracy100: 0.4828 - val_loss: 3.2812 - val_accuracy100: 0.4536 - 102s/epoch - 45ms/step
Epoch 22/50
2257/2257 - 100s - loss: 3.0390 - accuracy100: 0.4842 - val_loss: 3.2750 - val_accuracy100: 0.4560 - 100s/epoch - 44ms/step
Epoch 23/50
2257/2257 - 98s - loss: 3.0336 - accuracy100: 0.4855 - val_loss: 3.2619 - val_accuracy100: 0.4553 - 98s/epoch - 44ms/step
Epoch 24/50
2257/2257 - 99s - loss: 3.0273 - accuracy100: 0.4883 - val_loss: 3.2610 - val_accuracy100: 0.4552 - 99s/epoch - 44ms/step
Epoch 25/50
2257/2257 - 93s - loss: 3.0244 - accuracy100: 0.4882 - val_loss: 3.2736 - val_accuracy100: 0.4560 - 93s/epoch - 41ms/step
Epoch 26/50
2257/2257 - 100s - loss: 3.0183 - accuracy100: 0.4909 - val_loss: 3.2785 - val_accuracy100: 0.4564 - 100s/epoch - 44ms/step
Epoch 27/50
2257/2257 - 102s - loss: 3.0126 - accuracy100: 0.4929 - val_loss: 3.2728 - val_accuracy100: 0.4557 - 102s/epoch - 45ms/step
Epoch 28/50
2257/2257 - 104s - loss: 3.0066 - accuracy100: 0.4944 - val_loss: 3.2641 - val_accuracy100: 0.4576 - 104s/epoch - 46ms/step
Epoch 29/50
2257/2257 - 98s - loss: 3.0027 - accuracy100: 0.4954 - val_loss: 3.2545 - val_accuracy100: 0.4581 - 98s/epoch - 44ms/step
Epoch 30/50
2257/2257 - 99s - loss: 2.9986 - accuracy100: 0.4967 - val_loss: 3.2581 - val_accuracy100: 0.4582 - 99s/epoch - 44ms/step
Epoch 31/50
2257/2257 - 97s - loss: 2.9917 - accuracy100: 0.4993 - val_loss: 3.2648 - val_accuracy100: 0.4603 - 97s/epoch - 43ms/step
Epoch 32/50
2257/2257 - 97s - loss: 2.9881 - accuracy100: 0.4999 - val_loss: 3.2655 - val_accuracy100: 0.4586 - 97s/epoch - 43ms/step
Epoch 33/50
2257/2257 - 100s - loss: 2.9846 - accuracy100: 0.5011 - val_loss: 3.2766 - val_accuracy100: 0.4583 - 100s/epoch - 44ms/step
Epoch 34/50
2257/2257 - 99s - loss: 2.9785 - accuracy100: 0.5023 - val_loss: 3.3002 - val_accuracy100: 0.4580 - 99s/epoch - 44ms/step
Epoch 35/50
2257/2257 - 102s - loss: 2.9729 - accuracy100: 0.5037 - val_loss: 3.3359 - val_accuracy100: 0.4555 - 102s/epoch - 45ms/step
Epoch 36/50
2257/2257 - 104s - loss: 2.9702 - accuracy100: 0.5051 - val_loss: 3.3152 - val_accuracy100: 0.4575 - 104s/epoch - 46ms/step
Epoch 37/50
2257/2257 - 104s - loss: 2.9641 - accuracy100: 0.5064 - val_loss: 3.3090 - val_accuracy100: 0.4584 - 104s/epoch - 46ms/step
Epoch 38/50
2257/2257 - 104s - loss: 2.9617 - accuracy100: 0.5064 - val_loss: 3.2956 - val_accuracy100: 0.4597 - 104s/epoch - 46ms/step
Epoch 39/50
2257/2257 - 103s - loss: 2.9535 - accuracy100: 0.5099 - val_loss: 3.3563 - val_accuracy100: 0.4563 - 103s/epoch - 46ms/step
testing model: results/AAL/W1/deepOF_L1/h100
Evaluating performance on  test set...
7177/7177 - 125s - 125s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0932517
{'0': {'precision': 0.482976812540823, 'recall': 0.20461671765798517, 'f1-score': 0.2874521814027113, 'support': 578203}, '1': {'precision': 0.4031643452102491, 'recall': 0.8018123894621016, 'f1-score': 0.536545076228136, 'support': 694332}, '2': {'precision': 0.49358543443887937, 'recall': 0.184685474600079, 'f1-score': 0.26879542967335107, 'support': 564549}, 'accuracy': 0.424203792532078, 'macro avg': {'precision': 0.45990886406331716, 'recall': 0.39703819390672196, 'f1-score': 0.3642642291013994, 'support': 1837084}, 'weighted avg': {'precision': 0.4560715304836899, 'recall': 0.424203792532078, 'f1-score': 0.3758643156969886, 'support': 1837084}}
[[118310 412688  47205]
 [ 77839 556724  59769]
 [ 48811 411474 104264]]
Evaluating performance on  train set...
2257/2257 - 41s - 41s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0633041
{'0': {'precision': 0.4903117304342603, 'recall': 0.23297069601251155, 'f1-score': 0.3158607507264658, 'support': 175198}, '1': {'precision': 0.42671484820804423, 'recall': 0.8273553572279165, 'f1-score': 0.5630383596441338, 'support': 230931}, '2': {'precision': 0.525097685602645, 'recall': 0.14265799527545278, 'f1-score': 0.22436164991766924, 'support': 171445}, 'accuracy': 0.4438149916720628, 'macro avg': {'precision': 0.4807080880816499, 'recall': 0.400994682838627, 'f1-score': 0.3677535867627563, 'support': 577574}, 'weighted avg': {'precision': 0.47520957291758087, 'recall': 0.4438149916720628, 'f1-score': 0.38752933183780713, 'support': 577574}}
[[ 40816 124660   9722]
 [ 27471 191062  12398]
 [ 14958 132029  24458]]
Evaluating performance on  val set...
638/638 - 13s - 13s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0536724
{'0': {'precision': 0.47704392578213173, 'recall': 0.22102532995879437, 'f1-score': 0.30208690680388794, 'support': 47809}, '1': {'precision': 0.4479918108763813, 'recall': 0.8110344223781938, 'f1-score': 0.5771711025036604, 'support': 68531}, '2': {'precision': 0.49675609328423637, 'recall': 0.18087981782195076, 'f1-score': 0.26519595606590113, 'support': 46987}, 'accuracy': 0.457040170945404, 'macro avg': {'precision': 0.47393060998091646, 'recall': 0.40431319005297967, 'f1-score': 0.3814846551244832, 'support': 163327}, 'weighted avg': {'precision': 0.4705247656176482, 'recall': 0.457040170945404, 'f1-score': 0.4068975009688167, 'support': 163327}}
[[10567 33847  3395]
 [ 7735 55581  5215]
 [ 3849 34639  8499]]
training model: results/AAL/W1/deepOF_L1/h200
Epoch 1/50
2257/2257 - 109s - loss: 3.2589 - accuracy200: 0.4000 - val_loss: 3.3811 - val_accuracy200: 0.3316 - 109s/epoch - 48ms/step
Epoch 2/50
2257/2257 - 105s - loss: 3.2482 - accuracy200: 0.4027 - val_loss: 3.3388 - val_accuracy200: 0.3313 - 105s/epoch - 47ms/step
Epoch 3/50
2257/2257 - 98s - loss: 3.2438 - accuracy200: 0.4035 - val_loss: 3.3730 - val_accuracy200: 0.3320 - 98s/epoch - 44ms/step
Epoch 4/50
2257/2257 - 99s - loss: 3.2372 - accuracy200: 0.4076 - val_loss: 3.4110 - val_accuracy200: 0.3326 - 99s/epoch - 44ms/step
Epoch 5/50
2257/2257 - 99s - loss: 3.2319 - accuracy200: 0.4103 - val_loss: 3.4150 - val_accuracy200: 0.3321 - 99s/epoch - 44ms/step
Epoch 6/50
2257/2257 - 98s - loss: 3.2256 - accuracy200: 0.4145 - val_loss: 3.4287 - val_accuracy200: 0.3319 - 98s/epoch - 43ms/step
Epoch 7/50
2257/2257 - 101s - loss: 3.2225 - accuracy200: 0.4158 - val_loss: 3.4128 - val_accuracy200: 0.3329 - 101s/epoch - 45ms/step
Epoch 8/50
2257/2257 - 96s - loss: 3.2182 - accuracy200: 0.4175 - val_loss: 3.4048 - val_accuracy200: 0.3342 - 96s/epoch - 43ms/step
Epoch 9/50
2257/2257 - 99s - loss: 3.2142 - accuracy200: 0.4193 - val_loss: 3.4042 - val_accuracy200: 0.3357 - 99s/epoch - 44ms/step
Epoch 10/50
2257/2257 - 101s - loss: 3.2102 - accuracy200: 0.4214 - val_loss: 3.3990 - val_accuracy200: 0.3370 - 101s/epoch - 45ms/step
Epoch 11/50
2257/2257 - 100s - loss: 3.2071 - accuracy200: 0.4226 - val_loss: 3.3927 - val_accuracy200: 0.3382 - 100s/epoch - 44ms/step
Epoch 12/50
2257/2257 - 100s - loss: 3.2029 - accuracy200: 0.4251 - val_loss: 3.3815 - val_accuracy200: 0.3397 - 100s/epoch - 45ms/step
testing model: results/AAL/W1/deepOF_L1/h200
Evaluating performance on  test set...
7177/7177 - 123s - 123s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297987
{'0': {'precision': 0.45794406338694416, 'recall': 0.04773203866142594, 'f1-score': 0.08645298304512417, 'support': 649019}, '1': {'precision': 0.3079447213983719, 'recall': 0.9636548006617922, 'f1-score': 0.4667387868048582, 'support': 562110}, '2': {'precision': 0.4897782896631155, 'recall': 0.008152343219560512, 'f1-score': 0.01603773881396789, 'support': 625955}, 'accuracy': 0.31449950029503276, 'macro avg': {'precision': 0.4185556914828105, 'recall': 0.3398463941809262, 'f1-score': 0.1897431695546501, 'support': 1837084}, 'weighted avg': {'precision': 0.42289431225063495, 'recall': 0.31449950029503276, 'f1-score': 0.17881984212651117, 'support': 1837084}}
[[ 30979 615304   2736]
 [ 17850 541680   2580]
 [ 18819 602033   5103]]
Evaluating performance on  train set...
2257/2257 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161091
{'0': {'precision': 0.4730762697468999, 'recall': 0.042629943517238214, 'f1-score': 0.0782120290194243, 'support': 195989}, '1': {'precision': 0.3281765339923706, 'recall': 0.9681285018173738, 'f1-score': 0.4901887247351291, 'support': 189009}, '2': {'precision': 0.46569468267581476, 'recall': 0.005639332003988036, 'f1-score': 0.01114371908797997, 'support': 192576}, 'accuracy': 0.3331625038523202, 'macro avg': {'precision': 0.42231582880502844, 'recall': 0.3387992591128666, 'f1-score': 0.1931814909475111, 'support': 577574}, 'weighted avg': {'precision': 0.4231971708486996, 'recall': 0.3331625038523202, 'f1-score': 0.1906678466759875, 'support': 577574}}
[[  8355 187083    551]
 [  5329 182985    695]
 [  3977 187513   1086]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115464
{'0': {'precision': 0.49210064365125805, 'recall': 0.04477532476751615, 'f1-score': 0.08208214721431477, 'support': 56348}, '1': {'precision': 0.3252266504024752, 'recall': 0.9675657285425369, 'f1-score': 0.4868193316469179, 'support': 52907}, '2': {'precision': 0.5206508135168961, 'recall': 0.0076934457760023675, 'f1-score': 0.015162836470995608, 'support': 54072}, 'accuracy': 0.3314210142842273, 'macro avg': {'precision': 0.4459927025235431, 'recall': 0.34001149969535177, 'f1-score': 0.19468810511074275, 'support': 163327}, 'weighted avg': {'precision': 0.4474966432359037, 'recall': 0.3314210142842273, 'f1-score': 0.1910351632267498, 'support': 163327}}
[[ 2523 53689   136]
 [ 1469 51191   247]
 [ 1135 52521   416]]
training model: results/AAL/W1/deepOF_L1/h300
Epoch 1/50
2257/2257 - 115s - loss: 3.2752 - accuracy300: 0.3849 - val_loss: 3.3252 - val_accuracy300: 0.3156 - 115s/epoch - 51ms/step
Epoch 2/50
2257/2257 - 107s - loss: 3.2632 - accuracy300: 0.3864 - val_loss: 3.2973 - val_accuracy300: 0.3347 - 107s/epoch - 48ms/step
Epoch 3/50
2257/2257 - 96s - loss: 3.2609 - accuracy300: 0.3868 - val_loss: 3.2942 - val_accuracy300: 0.3361 - 96s/epoch - 43ms/step
Epoch 4/50
2257/2257 - 108s - loss: 3.2574 - accuracy300: 0.3886 - val_loss: 3.2955 - val_accuracy300: 0.3353 - 108s/epoch - 48ms/step
Epoch 5/50
2257/2257 - 99s - loss: 3.2527 - accuracy300: 0.3915 - val_loss: 3.3001 - val_accuracy300: 0.3268 - 99s/epoch - 44ms/step
Epoch 6/50
2257/2257 - 100s - loss: 3.2488 - accuracy300: 0.3949 - val_loss: 3.3030 - val_accuracy300: 0.3242 - 100s/epoch - 44ms/step
Epoch 7/50
2257/2257 - 98s - loss: 3.2458 - accuracy300: 0.3971 - val_loss: 3.3080 - val_accuracy300: 0.3201 - 98s/epoch - 43ms/step
Epoch 8/50
2257/2257 - 100s - loss: 3.2433 - accuracy300: 0.3989 - val_loss: 3.3099 - val_accuracy300: 0.3174 - 100s/epoch - 44ms/step
Epoch 9/50
2257/2257 - 99s - loss: 3.2409 - accuracy300: 0.4000 - val_loss: 3.3131 - val_accuracy300: 0.3163 - 99s/epoch - 44ms/step
Epoch 10/50
2257/2257 - 99s - loss: 3.2375 - accuracy300: 0.4025 - val_loss: 3.3205 - val_accuracy300: 0.3151 - 99s/epoch - 44ms/step
Epoch 11/50
2257/2257 - 99s - loss: 3.2354 - accuracy300: 0.4033 - val_loss: 3.3161 - val_accuracy300: 0.3182 - 99s/epoch - 44ms/step
Epoch 12/50
2257/2257 - 100s - loss: 3.2324 - accuracy300: 0.4051 - val_loss: 3.3139 - val_accuracy300: 0.3218 - 100s/epoch - 44ms/step
Epoch 13/50
2257/2257 - 102s - loss: 3.2301 - accuracy300: 0.4068 - val_loss: 3.3138 - val_accuracy300: 0.3207 - 102s/epoch - 45ms/step
testing model: results/AAL/W1/deepOF_L1/h300
Evaluating performance on  test set...
7177/7177 - 138s - 138s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062186
{'0': {'precision': 0.43033242993547044, 'recall': 0.26697235199352665, 'f1-score': 0.3295169169531391, 'support': 682183}, '1': {'precision': 0.2783613119865493, 'recall': 0.7007272843649863, 'f1-score': 0.39844272918193807, 'support': 499942}, '2': {'precision': 0.4299636944151196, 'recall': 0.1019819561224443, 'f1-score': 0.1648609724462457, 'support': 654959}, 'accuracy': 0.32619139897794547, 'macro avg': {'precision': 0.37955247877904646, 'recall': 0.35656053082698574, 'f1-score': 0.297606872860441, 'support': 1837084}, 'weighted avg': {'precision': 0.388843716682678, 'recall': 0.32619139897794547, 'f1-score': 0.2895710111910726, 'support': 1837084}}
[[182124 451890  48169]
 [109234 350323  40385]
 [131859 456306  66794]]
Evaluating performance on  train set...
2257/2257 - 43s - 43s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956088
{'0': {'precision': 0.40949524985510166, 'recall': 0.24800451749767258, 'f1-score': 0.30891774233408736, 'support': 196569}, '1': {'precision': 0.3252790650435308, 'recall': 0.7310193270307714, 'f1-score': 0.45022369627652353, 'support': 188389}, '2': {'precision': 0.40950863516089564, 'recall': 0.07472380279935208, 'f1-score': 0.12638576063715354, 'support': 192616}, 'accuracy': 0.34776323033931583, 'macro avg': {'precision': 0.38142765001984275, 'recall': 0.351249215775932, 'f1-score': 0.29517573308258815, 'support': 577574}, 'weighted avg': {'precision': 0.3820306745514935, 'recall': 0.34776323033931583, 'f1-score': 0.2941350602374642, 'support': 577574}}
[[ 48750 138614   9205]
 [ 39124 137716  11549]
 [ 31175 147048  14393]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003051
{'0': {'precision': 0.4366745682356925, 'recall': 0.26028595458368375, 'f1-score': 0.3261598128280252, 'support': 59450}, '1': {'precision': 0.2934611851762827, 'recall': 0.7212025316455696, 'f1-score': 0.41717259852705185, 'support': 47400}, '2': {'precision': 0.4378179266795299, 'recall': 0.08838996405616445, 'f1-score': 0.14708525464429348, 'support': 56477}, 'accuracy': 0.33461093389335506, 'macro avg': {'precision': 0.38931789336383504, 'recall': 0.35662615009513926, 'f1-score': 0.2968058886664568, 'support': 163327}, 'weighted avg': {'precision': 0.3955072113248118, 'recall': 0.33461093389335506, 'f1-score': 0.2906507556579997, 'support': 163327}}
[[15474 40857  3119]
 [ 9924 34185  3291]
 [10038 41447  4992]]
training model: results/AAL/W1/deepOF_L1/h500
Epoch 1/50
2257/2257 - 113s - loss: 3.2667 - accuracy500: 0.3807 - val_loss: 3.2882 - val_accuracy500: 0.3555 - 113s/epoch - 50ms/step
Epoch 2/50
2257/2257 - 102s - loss: 3.2581 - accuracy500: 0.3833 - val_loss: 3.2815 - val_accuracy500: 0.3767 - 102s/epoch - 45ms/step
Epoch 3/50
2257/2257 - 95s - loss: 3.2595 - accuracy500: 0.3828 - val_loss: 3.2843 - val_accuracy500: 0.3657 - 95s/epoch - 42ms/step
Epoch 4/50
2257/2257 - 102s - loss: 3.2582 - accuracy500: 0.3839 - val_loss: 3.2836 - val_accuracy500: 0.3657 - 102s/epoch - 45ms/step
Epoch 5/50
2257/2257 - 96s - loss: 3.2537 - accuracy500: 0.3856 - val_loss: 3.2866 - val_accuracy500: 0.3523 - 96s/epoch - 42ms/step
Epoch 6/50
2257/2257 - 96s - loss: 3.2514 - accuracy500: 0.3876 - val_loss: 3.2857 - val_accuracy500: 0.3580 - 96s/epoch - 43ms/step
Epoch 7/50
2257/2257 - 99s - loss: 3.2518 - accuracy500: 0.3878 - val_loss: 3.2863 - val_accuracy500: 0.3552 - 99s/epoch - 44ms/step
Epoch 8/50
2257/2257 - 104s - loss: 3.2464 - accuracy500: 0.3890 - val_loss: 3.2864 - val_accuracy500: 0.3532 - 104s/epoch - 46ms/step
Epoch 9/50
2257/2257 - 101s - loss: 3.2453 - accuracy500: 0.3894 - val_loss: 3.2868 - val_accuracy500: 0.3505 - 101s/epoch - 45ms/step
Epoch 10/50
2257/2257 - 100s - loss: 3.2441 - accuracy500: 0.3903 - val_loss: 3.2854 - val_accuracy500: 0.3544 - 100s/epoch - 44ms/step
Epoch 11/50
2257/2257 - 103s - loss: 3.2435 - accuracy500: 0.3908 - val_loss: 3.2862 - val_accuracy500: 0.3523 - 103s/epoch - 45ms/step
Epoch 12/50
2257/2257 - 99s - loss: 3.2409 - accuracy500: 0.3926 - val_loss: 3.2837 - val_accuracy500: 0.3582 - 99s/epoch - 44ms/step
testing model: results/AAL/W1/deepOF_L1/h500
Evaluating performance on  test set...
7177/7177 - 125s - 125s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984298
{'0': {'precision': 0.3879373755435445, 'recall': 0.569485665878198, 'f1-score': 0.46149876297606085, 'support': 670498}, '1': {'precision': 0.3062663812935642, 'recall': 0.252509162832306, 'f1-score': 0.27680190501213914, 'support': 529858}, '2': {'precision': 0.380599544655715, 'recall': 0.24863049842318855, 'f1-score': 0.30077602151467164, 'support': 636728}, 'accuracy': 0.36685475460022515, 'macro avg': {'precision': 0.3582677671642746, 'recall': 0.35687510904456426, 'f1-score': 0.34635889650095725, 'support': 1837084}, 'weighted avg': {'precision': 0.36183827933626606, 'recall': 0.36685475460022515, 'f1-score': 0.3525218313320669, 'support': 1837084}}
[[381839 150795 137864]
 [276289 133794 119775]
 [326152 152266 158310]]
Evaluating performance on  train set...
2257/2257 - 36s - 36s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948753
{'0': {'precision': 0.36561148479302424, 'recall': 0.6327860583591839, 'f1-score': 0.4634503599089007, 'support': 198255}, '1': {'precision': 0.3401379338572364, 'recall': 0.17805357515895248, 'f1-score': 0.23374669062193457, 'support': 186691}, '2': {'precision': 0.3812703892798104, 'recall': 0.270599289822871, 'f1-score': 0.3165402529892938, 'support': 192628}, 'accuracy': 0.3650077738956393, 'macro avg': {'precision': 0.36233993597669034, 'recall': 0.3604796411136691, 'f1-score': 0.33791243450670966, 'support': 577574}, 'weighted avg': {'precision': 0.36260002782946194, 'recall': 0.3650077738956393, 'f1-score': 0.3402062253069916, 'support': 577574}}
[[125453  31966  40836]
 [109697  33241  43753]
 [107982  32521  52125]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095536
{'0': {'precision': 0.3941527150418818, 'recall': 0.6127572568210766, 'f1-score': 0.47972498671512637, 'support': 59668}, '1': {'precision': 0.30574365919724206, 'recall': 0.2123706491063029, 'f1-score': 0.2506434519303558, 'support': 46772}, '2': {'precision': 0.3913283260675456, 'recall': 0.2619403378627806, 'f1-score': 0.31382088137734954, 'support': 56887}, 'accuracy': 0.3759084535930985, 'macro avg': {'precision': 0.36374156676888986, 'recall': 0.36235608126338664, 'f1-score': 0.3480631066742772, 'support': 163327}, 'weighted avg': {'precision': 0.3678512500327373, 'recall': 0.3759084535930985, 'f1-score': 0.35633823262484493, 'support': 163327}}
[[36562 10849 12257]
 [25919  9933 10920]
 [30280 11706 14901]]
training model: results/AAL/W1/deepOF_L1/h1000
Epoch 1/50
2257/2257 - 108s - loss: 3.2075 - accuracy1000: 0.4223 - val_loss: 3.2199 - val_accuracy1000: 0.4095 - 108s/epoch - 48ms/step
Epoch 2/50
2257/2257 - 102s - loss: 3.2034 - accuracy1000: 0.4209 - val_loss: 3.2115 - val_accuracy1000: 0.4142 - 102s/epoch - 45ms/step
Epoch 3/50
2257/2257 - 106s - loss: 3.1973 - accuracy1000: 0.4220 - val_loss: 3.2193 - val_accuracy1000: 0.4139 - 106s/epoch - 47ms/step
Epoch 4/50
2257/2257 - 111s - loss: 3.1878 - accuracy1000: 0.4273 - val_loss: 3.2199 - val_accuracy1000: 0.4159 - 111s/epoch - 49ms/step
Epoch 5/50
2257/2257 - 103s - loss: 3.1844 - accuracy1000: 0.4291 - val_loss: 3.2157 - val_accuracy1000: 0.4182 - 103s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 96s - loss: 3.1831 - accuracy1000: 0.4300 - val_loss: 3.2146 - val_accuracy1000: 0.4172 - 96s/epoch - 43ms/step
Epoch 7/50
2257/2257 - 100s - loss: 3.1808 - accuracy1000: 0.4309 - val_loss: 3.2195 - val_accuracy1000: 0.4184 - 100s/epoch - 44ms/step
Epoch 8/50
2257/2257 - 104s - loss: 3.1789 - accuracy1000: 0.4321 - val_loss: 3.2191 - val_accuracy1000: 0.4198 - 104s/epoch - 46ms/step
Epoch 9/50
2257/2257 - 98s - loss: 3.1780 - accuracy1000: 0.4326 - val_loss: 3.2213 - val_accuracy1000: 0.4192 - 98s/epoch - 43ms/step
Epoch 10/50
2257/2257 - 101s - loss: 3.1756 - accuracy1000: 0.4343 - val_loss: 3.2268 - val_accuracy1000: 0.4179 - 101s/epoch - 45ms/step
Epoch 11/50
2257/2257 - 98s - loss: 3.1741 - accuracy1000: 0.4352 - val_loss: 3.2314 - val_accuracy1000: 0.4173 - 98s/epoch - 43ms/step
Epoch 12/50
2257/2257 - 100s - loss: 3.1731 - accuracy1000: 0.4361 - val_loss: 3.2319 - val_accuracy1000: 0.4165 - 100s/epoch - 44ms/step
testing model: results/AAL/W1/deepOF_L1/h1000
Evaluating performance on  test set...
7177/7177 - 130s - 130s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.077008
{'0': {'precision': 0.40825873336407437, 'recall': 0.8659523864128462, 'f1-score': 0.5549043152164611, 'support': 741259}, '1': {'precision': 0.26257893664697496, 'recall': 0.009567992874109263, 'f1-score': 0.018463213229343474, 'support': 404160}, '2': {'precision': 0.3962820194976048, 'recall': 0.14328179104046035, 'f1-score': 0.21046629296403388, 'support': 691665}, 'accuracy': 0.40546050153395274, 'macro avg': {'precision': 0.35570656316955135, 'recall': 0.3396007234424719, 'f1-score': 0.2612779404699462, 'support': 1837084}, 'weighted avg': {'precision': 0.3716998060435846, 'recall': 0.40546050153395274, 'f1-score': 0.3072053746996755, 'support': 1837084}}
[[641895   5678  93686]
 [343000   3867  57293]
 [587380   5182  99103]]
Evaluating performance on  train set...
2257/2257 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020218
{'0': {'precision': 0.3469945838269182, 'recall': 0.8909643021079764, 'f1-score': 0.4994669705547182, 'support': 198247}, '1': {'precision': 0.3638961657537509, 'recall': 0.00816474837827151, 'f1-score': 0.01597115158483368, 'support': 187146}, '2': {'precision': 0.36903207758299145, 'recall': 0.12355539829639767, 'f1-score': 0.1851281551505701, 'support': 192181}, 'accuracy': 0.3495725223088297, 'macro avg': {'precision': 0.35997427572122015, 'recall': 0.34089481626088186, 'f1-score': 0.23352209243004066, 'support': 577574}, 'weighted avg': {'precision': 0.35980376678670334, 'recall': 0.3495725223088297, 'f1-score': 0.23821169171577705, 'support': 577574}}
[[176631   1424  20192]
 [165211   1528  20407]
 [167189   1247  23745]]
Evaluating performance on  val set...
638/638 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0735027
{'0': {'precision': 0.41519146442214677, 'recall': 0.8820599750978834, 'f1-score': 0.5646149414250048, 'support': 66661}, '1': {'precision': 0.26564885496183205, 'recall': 0.010050831792975971, 'f1-score': 0.01936884287861079, 'support': 34624}, '2': {'precision': 0.41244239631336405, 'recall': 0.13560168917829857, 'f1-score': 0.20409995147986412, 'support': 62042}, 'accuracy': 0.41364869250032144, 'macro avg': {'precision': 0.3644275718991143, 'recall': 0.34257083202305266, 'f1-score': 0.26269457859449324, 'support': 163327}, 'weighted avg': {'precision': 0.3824453722661711, 'recall': 0.41364869250032144, 'f1-score': 0.3120806273051914, 'support': 163327}}
[[58799   471  7391]
 [29682   348  4594]
 [53138   491  8413]]
training model: results/AAL/W1/deepLOB_L2/h10
Epoch 1/50
2257/2257 - 223s - loss: 2.8274 - accuracy10: 0.4305 - val_loss: 2.9810 - val_accuracy10: 0.6787 - 223s/epoch - 99ms/step
Epoch 2/50
2257/2257 - 213s - loss: 2.6485 - accuracy10: 0.4678 - val_loss: 2.6904 - val_accuracy10: 0.5645 - 213s/epoch - 94ms/step
Epoch 3/50
2257/2257 - 217s - loss: 2.4966 - accuracy10: 0.5530 - val_loss: 2.9992 - val_accuracy10: 0.7123 - 217s/epoch - 96ms/step
Epoch 4/50
2257/2257 - 210s - loss: 2.4004 - accuracy10: 0.5934 - val_loss: 2.6043 - val_accuracy10: 0.6514 - 210s/epoch - 93ms/step
Epoch 5/50
2257/2257 - 209s - loss: 2.3091 - accuracy10: 0.6268 - val_loss: 2.6993 - val_accuracy10: 0.5913 - 209s/epoch - 92ms/step
Epoch 6/50
2257/2257 - 213s - loss: 2.2563 - accuracy10: 0.6421 - val_loss: 2.6364 - val_accuracy10: 0.6068 - 213s/epoch - 94ms/step
Epoch 7/50
2257/2257 - 206s - loss: 2.2218 - accuracy10: 0.6517 - val_loss: 2.7377 - val_accuracy10: 0.5962 - 206s/epoch - 91ms/step
Epoch 8/50
2257/2257 - 213s - loss: 2.1957 - accuracy10: 0.6565 - val_loss: 2.5741 - val_accuracy10: 0.6036 - 213s/epoch - 94ms/step
Epoch 9/50
2257/2257 - 210s - loss: 2.1761 - accuracy10: 0.6609 - val_loss: 2.5520 - val_accuracy10: 0.6081 - 210s/epoch - 93ms/step
Epoch 10/50
2257/2257 - 209s - loss: 2.1587 - accuracy10: 0.6631 - val_loss: 2.5294 - val_accuracy10: 0.6505 - 209s/epoch - 93ms/step
Epoch 11/50
2257/2257 - 214s - loss: 2.1456 - accuracy10: 0.6638 - val_loss: 2.4545 - val_accuracy10: 0.6369 - 214s/epoch - 95ms/step
Epoch 12/50
2257/2257 - 202s - loss: 2.1317 - accuracy10: 0.6643 - val_loss: 2.4544 - val_accuracy10: 0.6582 - 202s/epoch - 89ms/step
Epoch 13/50
2257/2257 - 211s - loss: 2.1204 - accuracy10: 0.6660 - val_loss: 2.4597 - val_accuracy10: 0.6439 - 211s/epoch - 93ms/step
Epoch 14/50
2257/2257 - 211s - loss: 2.1079 - accuracy10: 0.6664 - val_loss: 2.5281 - val_accuracy10: 0.6409 - 211s/epoch - 94ms/step
Epoch 15/50
2257/2257 - 214s - loss: 2.0981 - accuracy10: 0.6673 - val_loss: 2.4782 - val_accuracy10: 0.6452 - 214s/epoch - 95ms/step
Epoch 16/50
2257/2257 - 214s - loss: 2.0896 - accuracy10: 0.6674 - val_loss: 2.5168 - val_accuracy10: 0.6442 - 214s/epoch - 95ms/step
Epoch 17/50
2257/2257 - 215s - loss: 2.0809 - accuracy10: 0.6682 - val_loss: 2.4272 - val_accuracy10: 0.6521 - 215s/epoch - 95ms/step
Epoch 18/50
2257/2257 - 214s - loss: 2.0722 - accuracy10: 0.6695 - val_loss: 2.4311 - val_accuracy10: 0.6562 - 214s/epoch - 95ms/step
Epoch 19/50
2257/2257 - 208s - loss: 2.0650 - accuracy10: 0.6705 - val_loss: 2.4912 - val_accuracy10: 0.6252 - 208s/epoch - 92ms/step
Epoch 20/50
2257/2257 - 208s - loss: 2.0576 - accuracy10: 0.6707 - val_loss: 2.4879 - val_accuracy10: 0.6146 - 208s/epoch - 92ms/step
Epoch 21/50
2257/2257 - 210s - loss: 2.0516 - accuracy10: 0.6714 - val_loss: 2.4491 - val_accuracy10: 0.6216 - 210s/epoch - 93ms/step
Epoch 22/50
2257/2257 - 218s - loss: 2.0451 - accuracy10: 0.6714 - val_loss: 2.4680 - val_accuracy10: 0.6259 - 218s/epoch - 97ms/step
Epoch 23/50
2257/2257 - 217s - loss: 2.0388 - accuracy10: 0.6716 - val_loss: 2.4525 - val_accuracy10: 0.6268 - 217s/epoch - 96ms/step
Epoch 24/50
2257/2257 - 213s - loss: 2.0325 - accuracy10: 0.6719 - val_loss: 2.4977 - val_accuracy10: 0.5967 - 213s/epoch - 95ms/step
Epoch 25/50
2257/2257 - 215s - loss: 2.0258 - accuracy10: 0.6726 - val_loss: 2.4628 - val_accuracy10: 0.6334 - 215s/epoch - 95ms/step
Epoch 26/50
2257/2257 - 214s - loss: 2.0184 - accuracy10: 0.6735 - val_loss: 2.4852 - val_accuracy10: 0.6143 - 214s/epoch - 95ms/step
Epoch 27/50
2257/2257 - 217s - loss: 2.0157 - accuracy10: 0.6731 - val_loss: 2.4862 - val_accuracy10: 0.6077 - 217s/epoch - 96ms/step
testing model: results/AAL/W1/deepLOB_L2/h10
Evaluating performance on  test set...
7177/7177 - 322s - 322s/epoch - 45ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8566098
{'0': {'precision': 0.32436005587605676, 'recall': 0.68921569099854, 'f1-score': 0.44111955269703274, 'support': 207533}, '1': {'precision': 0.9329241337490135, 'recall': 0.5664474178835899, 'f1-score': 0.7048986171146219, 'support': 1423193}, '2': {'precision': 0.28112905014596223, 'recall': 0.7247277855041844, 'f1-score': 0.40511139703392707, 'support': 206363}, 'accuracy': 0.5980962272377658, 'macro avg': {'precision': 0.5128044132570108, 'recall': 0.6601302981287714, 'f1-score': 0.5170431889485273, 'support': 1837089}, 'weighted avg': {'precision': 0.7909584926664177, 'recall': 0.5980962272377658, 'f1-score': 0.6414243648202105, 'support': 1837089}}
[[143035  29181  35317]
 [269916 806164 347113]
 [ 28025  28781 149557]]
Evaluating performance on  train set...
2257/2257 - 105s - 105s/epoch - 47ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.838688
{'0': {'precision': 0.3129653346067855, 'recall': 0.6423797784180355, 'f1-score': 0.42087953255068333, 'support': 67334}, '1': {'precision': 0.9169004533453583, 'recall': 0.6012871535216132, 'f1-score': 0.7262876618950239, 'support': 442993}, '2': {'precision': 0.297539315200086, 'recall': 0.6586366880799429, 'f1-score': 0.40990426127556, 'support': 67248}, 'accuracy': 0.6127550534562611, 'macro avg': {'precision': 0.5091350343840766, 'recall': 0.6341012066731971, 'f1-score': 0.5190238185737557, 'support': 577575}, 'weighted avg': {'precision': 0.77438014844446, 'recall': 0.6127550534562611, 'f1-score': 0.6538459843533548, 'support': 577575}}
[[ 43254  12655  11425]
 [ 83483 266366  93144]
 [ 11470  11486  44292]]
Evaluating performance on  val set...
638/638 - 27s - 27s/epoch - 43ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8019994
{'0': {'precision': 0.3604961049610496, 'recall': 0.5939540643999099, 'f1-score': 0.44867324374893697, 'support': 17764}, '1': {'precision': 0.9144350806407878, 'recall': 0.6616700674933291, 'f1-score': 0.7677842081058559, 'support': 127420}, '2': {'precision': 0.28035641766799646, 'recall': 0.6468253968253969, 'f1-score': 0.3911674027164403, 'support': 18144}, 'accuracy': 0.6526560050940439, 'macro avg': {'precision': 0.5184292010899446, 'recall': 0.6341498429062119, 'f1-score': 0.5358749515237443, 'support': 163328}, 'weighted avg': {'precision': 0.7837477813108922, 'recall': 0.6526560050940439, 'f1-score': 0.6912387138377459, 'support': 163328}}
[[10551  3882  3331]
 [16316 84310 26794]
 [ 2401  4007 11736]]
training model: results/AAL/W1/deepLOB_L2/h20
Epoch 1/50
2257/2257 - 223s - loss: 2.8496 - accuracy20: 0.4532 - val_loss: 3.1865 - val_accuracy20: 0.6099 - 223s/epoch - 99ms/step
Epoch 2/50
2257/2257 - 213s - loss: 2.6715 - accuracy20: 0.5109 - val_loss: 2.7485 - val_accuracy20: 0.6080 - 213s/epoch - 94ms/step
Epoch 3/50
2257/2257 - 213s - loss: 2.5384 - accuracy20: 0.5728 - val_loss: 2.7162 - val_accuracy20: 0.6488 - 213s/epoch - 94ms/step
Epoch 4/50
2257/2257 - 214s - loss: 2.4189 - accuracy20: 0.6128 - val_loss: 2.6163 - val_accuracy20: 0.6526 - 214s/epoch - 95ms/step
Epoch 5/50
2257/2257 - 211s - loss: 2.3588 - accuracy20: 0.6289 - val_loss: 2.5403 - val_accuracy20: 0.6663 - 211s/epoch - 93ms/step
Epoch 6/50
2257/2257 - 214s - loss: 2.3156 - accuracy20: 0.6380 - val_loss: 2.5483 - val_accuracy20: 0.6596 - 214s/epoch - 95ms/step
Epoch 7/50
2257/2257 - 211s - loss: 2.2877 - accuracy20: 0.6424 - val_loss: 2.5243 - val_accuracy20: 0.6768 - 211s/epoch - 94ms/step
Epoch 8/50
2257/2257 - 211s - loss: 2.2678 - accuracy20: 0.6451 - val_loss: 2.5853 - val_accuracy20: 0.6524 - 211s/epoch - 94ms/step
Epoch 9/50
2257/2257 - 214s - loss: 2.2499 - accuracy20: 0.6478 - val_loss: 2.4727 - val_accuracy20: 0.6545 - 214s/epoch - 95ms/step
Epoch 10/50
2257/2257 - 216s - loss: 2.2328 - accuracy20: 0.6499 - val_loss: 2.5149 - val_accuracy20: 0.6603 - 216s/epoch - 96ms/step
Epoch 11/50
2257/2257 - 215s - loss: 2.2223 - accuracy20: 0.6508 - val_loss: 2.6216 - val_accuracy20: 0.6285 - 215s/epoch - 95ms/step
Epoch 12/50
2257/2257 - 215s - loss: 2.2093 - accuracy20: 0.6516 - val_loss: 2.5430 - val_accuracy20: 0.6410 - 215s/epoch - 95ms/step
Epoch 13/50
2257/2257 - 219s - loss: 2.1998 - accuracy20: 0.6529 - val_loss: 2.5805 - val_accuracy20: 0.6540 - 219s/epoch - 97ms/step
Epoch 14/50
2257/2257 - 215s - loss: 2.1918 - accuracy20: 0.6538 - val_loss: 2.5969 - val_accuracy20: 0.6345 - 215s/epoch - 95ms/step
Epoch 15/50
2257/2257 - 216s - loss: 2.1835 - accuracy20: 0.6545 - val_loss: 2.5194 - val_accuracy20: 0.6466 - 216s/epoch - 96ms/step
Epoch 16/50
2257/2257 - 215s - loss: 2.1767 - accuracy20: 0.6546 - val_loss: 2.5472 - val_accuracy20: 0.6447 - 215s/epoch - 95ms/step
Epoch 17/50
2257/2257 - 219s - loss: 2.1706 - accuracy20: 0.6548 - val_loss: 2.6267 - val_accuracy20: 0.6552 - 219s/epoch - 97ms/step
Epoch 18/50
2257/2257 - 219s - loss: 2.1642 - accuracy20: 0.6554 - val_loss: 2.6581 - val_accuracy20: 0.5780 - 219s/epoch - 97ms/step
Epoch 19/50
2257/2257 - 215s - loss: 2.1582 - accuracy20: 0.6561 - val_loss: 2.5090 - val_accuracy20: 0.6454 - 215s/epoch - 95ms/step
testing model: results/AAL/W1/deepLOB_L2/h20
Evaluating performance on  test set...
7177/7177 - 325s - 325s/epoch - 45ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8405672
{'0': {'precision': 0.3698161718470847, 'recall': 0.6526320239265295, 'f1-score': 0.4721097415223247, 'support': 283869}, '1': {'precision': 0.8709061028808873, 'recall': 0.5783479947074482, 'f1-score': 0.6950979804270505, 'support': 1272732}, '2': {'precision': 0.36946394780635555, 'recall': 0.6466765066598215, 'f1-score': 0.47025714615343733, 'support': 280488}, 'accuracy': 0.6002588878383137, 'macro avg': {'precision': 0.5367287408447758, 'recall': 0.6258855084312663, 'f1-score': 0.5458216227009375, 'support': 1837089}, 'weighted avg': {'precision': 0.7169166092716066, 'recall': 0.6002588878383137, 'f1-score': 0.6263127423066421, 'support': 1837089}}
[[185262  51136  47471]
 [274565 736082 262085]
 [ 41130  57973 181385]]
Evaluating performance on  train set...
2257/2257 - 106s - 106s/epoch - 47ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8781594
{'0': {'precision': 0.3476878969291417, 'recall': 0.6489571682347522, 'f1-score': 0.4527881808826848, 'support': 91194}, '1': {'precision': 0.8621500751707994, 'recall': 0.5716618337737197, 'f1-score': 0.6874797034195376, 'support': 396243}, '2': {'precision': 0.3663354698638567, 'recall': 0.5877876145465841, 'f1-score': 0.45136200029817053, 'support': 90138}, 'accuracy': 0.586382720858763, 'macro avg': {'precision': 0.5253911473212659, 'recall': 0.6028022055183521, 'f1-score': 0.5305432948667975, 'support': 577575}, 'weighted avg': {'precision': 0.703542793387954, 'recall': 0.586382720858763, 'f1-score': 0.613574779850859, 'support': 577575}}
[[ 59181  16863  15150]
 [ 93231 226517  76495]
 [ 17801  19355  52982]]
Evaluating performance on  val set...
638/638 - 28s - 28s/epoch - 44ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7720362
{'0': {'precision': 0.41942042178728567, 'recall': 0.5698618841475984, 'f1-score': 0.48320223737108897, 'support': 24255}, '1': {'precision': 0.8565103772973673, 'recall': 0.6914413236396604, 'f1-score': 0.7651746092996334, 'support': 114714}, '2': {'precision': 0.36428628167447774, 'recall': 0.5648015107352519, 'f1-score': 0.4429063516080224, 'support': 24359}, 'accuracy': 0.6544989224137931, 'macro avg': {'precision': 0.5467390269197102, 'recall': 0.6087015728408369, 'f1-score': 0.563761066092915, 'support': 163328}, 'weighted avg': {'precision': 0.7181893079389291, 'recall': 0.6544989224137931, 'f1-score': 0.6752367396738693, 'support': 163328}}
[[13822  6236  4197]
 [15584 79318 19812]
 [ 3549  7052 13758]]
training model: results/AAL/W1/deepLOB_L2/h30
Epoch 1/50
2257/2257 - 226s - loss: 2.9463 - accuracy30: 0.4394 - val_loss: 3.3887 - val_accuracy30: 0.6037 - 226s/epoch - 100ms/step
Epoch 2/50
2257/2257 - 214s - loss: 2.7826 - accuracy30: 0.4939 - val_loss: 3.2117 - val_accuracy30: 0.4979 - 214s/epoch - 95ms/step
Epoch 3/50
2257/2257 - 216s - loss: 2.6664 - accuracy30: 0.5403 - val_loss: 2.9566 - val_accuracy30: 0.5171 - 216s/epoch - 96ms/step
Epoch 4/50
2257/2257 - 220s - loss: 2.5550 - accuracy30: 0.5823 - val_loss: 2.9299 - val_accuracy30: 0.5685 - 220s/epoch - 97ms/step
Epoch 5/50
2257/2257 - 222s - loss: 2.4891 - accuracy30: 0.6026 - val_loss: 2.8285 - val_accuracy30: 0.5421 - 222s/epoch - 98ms/step
Epoch 6/50
2257/2257 - 229s - loss: 2.4472 - accuracy30: 0.6123 - val_loss: 2.7953 - val_accuracy30: 0.5842 - 229s/epoch - 101ms/step
Epoch 7/50
2257/2257 - 210s - loss: 2.4141 - accuracy30: 0.6201 - val_loss: 2.8205 - val_accuracy30: 0.5969 - 210s/epoch - 93ms/step
Epoch 8/50
2257/2257 - 223s - loss: 2.3925 - accuracy30: 0.6245 - val_loss: 2.6506 - val_accuracy30: 0.5970 - 223s/epoch - 99ms/step
Epoch 9/50
2257/2257 - 213s - loss: 2.3733 - accuracy30: 0.6270 - val_loss: 2.6780 - val_accuracy30: 0.5971 - 213s/epoch - 94ms/step
Epoch 10/50
2257/2257 - 220s - loss: 2.3570 - accuracy30: 0.6292 - val_loss: 2.6523 - val_accuracy30: 0.5852 - 220s/epoch - 98ms/step
Epoch 11/50
2257/2257 - 215s - loss: 2.3434 - accuracy30: 0.6307 - val_loss: 2.6385 - val_accuracy30: 0.5912 - 215s/epoch - 95ms/step
Epoch 12/50
2257/2257 - 213s - loss: 2.3319 - accuracy30: 0.6319 - val_loss: 2.6761 - val_accuracy30: 0.5652 - 213s/epoch - 94ms/step
Epoch 13/50
2257/2257 - 224s - loss: 2.3217 - accuracy30: 0.6329 - val_loss: 2.6743 - val_accuracy30: 0.5630 - 224s/epoch - 99ms/step
Epoch 14/50
2257/2257 - 220s - loss: 2.3109 - accuracy30: 0.6344 - val_loss: 2.6955 - val_accuracy30: 0.5502 - 220s/epoch - 97ms/step
Epoch 15/50
2257/2257 - 219s - loss: 2.3045 - accuracy30: 0.6352 - val_loss: 2.7541 - val_accuracy30: 0.5415 - 219s/epoch - 97ms/step
Epoch 16/50
2257/2257 - 221s - loss: 2.2983 - accuracy30: 0.6357 - val_loss: 2.7318 - val_accuracy30: 0.5272 - 221s/epoch - 98ms/step
Epoch 17/50
2257/2257 - 218s - loss: 2.2905 - accuracy30: 0.6359 - val_loss: 2.7247 - val_accuracy30: 0.5284 - 218s/epoch - 97ms/step
Epoch 18/50
2257/2257 - 219s - loss: 2.2840 - accuracy30: 0.6374 - val_loss: 2.7569 - val_accuracy30: 0.5023 - 219s/epoch - 97ms/step
Epoch 19/50
2257/2257 - 212s - loss: 2.2760 - accuracy30: 0.6380 - val_loss: 2.8095 - val_accuracy30: 0.4938 - 212s/epoch - 94ms/step
Epoch 20/50
2257/2257 - 218s - loss: 2.2685 - accuracy30: 0.6390 - val_loss: 2.8370 - val_accuracy30: 0.4745 - 218s/epoch - 97ms/step
Epoch 21/50
2257/2257 - 217s - loss: 2.2647 - accuracy30: 0.6388 - val_loss: 2.8753 - val_accuracy30: 0.4612 - 217s/epoch - 96ms/step
testing model: results/AAL/W1/deepLOB_L2/h30
Evaluating performance on  test set...
7177/7177 - 327s - 327s/epoch - 46ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95486486
{'0': {'precision': 0.36968322715204877, 'recall': 0.683477508397625, 'f1-score': 0.4798321138670252, 'support': 342061}, '1': {'precision': 0.8206263845461014, 'recall': 0.4570622625039178, 'f1-score': 0.5871185485713525, 'support': 1158177}, '2': {'precision': 0.3826108399912082, 'recall': 0.635634152785653, 'f1-score': 0.4776856627817737, 'support': 336851}, 'accuracy': 0.5319633398273028, 'macro avg': {'precision': 0.5243068172297861, 'recall': 0.5920579745623986, 'f1-score': 0.5148787750733838, 'support': 1837089}, 'weighted avg': {'precision': 0.6563468958766753, 'recall': 0.5319633398273028, 'f1-score': 0.5470763502061659, 'support': 1837089}}
[[233791  56768  51502]
 [334821 529359 293997]
 [ 63797  58940 214114]]
Evaluating performance on  train set...
2257/2257 - 102s - 102s/epoch - 45ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0410908
{'0': {'precision': 0.3657221774421267, 'recall': 0.65754373009646, 'f1-score': 0.4700211801500425, 'support': 108335}, '1': {'precision': 0.8230417493087377, 'recall': 0.4644908177078595, 'f1-score': 0.5938418101997331, 'support': 362709}, '2': {'precision': 0.3668991229547777, 'recall': 0.6133801428692118, 'f1-score': 0.4591520892108675, 'support': 106531}, 'accuracy': 0.5281634419772324, 'macro avg': {'precision': 0.5185543499018808, 'recall': 0.5784715635578438, 'f1-score': 0.507671693186881, 'support': 577575}, 'weighted avg': {'precision': 0.6531295371349369, 'recall': 0.5281634419772324, 'f1-score': 0.5457740464926853, 'support': 577575}}
[[ 71235  18030  19070]
 [100550 168475  93684]
 [ 22994  18193  65344]]
Evaluating performance on  val set...
638/638 - 28s - 28s/epoch - 44ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9054777
{'0': {'precision': 0.4164634146341463, 'recall': 0.6143786327151951, 'f1-score': 0.4964217823996422, 'support': 28904}, '1': {'precision': 0.8233710001056078, 'recall': 0.5911869804650105, 'f1-score': 0.6882237731372928, 'support': 105503}, '2': {'precision': 0.37050471782090083, 'recall': 0.5756716572732616, 'f1-score': 0.45084419892494954, 'support': 28921}, 'accuracy': 0.5925438381661442, 'macro avg': {'precision': 0.5367797108535517, 'recall': 0.5937457568178225, 'f1-score': 0.5451632514872947, 'support': 163328}, 'weighted avg': {'precision': 0.6711705041684561, 'recall': 0.5925438381661442, 'f1-score': 0.6122472142736795, 'support': 163328}}
[[17758  6368  4778]
 [19622 62372 23509]
 [ 5260  7012 16649]]
training model: results/AAL/W1/deepLOB_L2/h50
Epoch 1/50
2257/2257 - 228s - loss: 3.0010 - accuracy50: 0.4579 - val_loss: 3.4114 - val_accuracy50: 0.5290 - 228s/epoch - 101ms/step
Epoch 2/50
2257/2257 - 219s - loss: 2.9038 - accuracy50: 0.4874 - val_loss: 3.0917 - val_accuracy50: 0.5059 - 219s/epoch - 97ms/step
Epoch 3/50
2257/2257 - 218s - loss: 2.7835 - accuracy50: 0.5371 - val_loss: 3.0723 - val_accuracy50: 0.5399 - 218s/epoch - 97ms/step
Epoch 4/50
2257/2257 - 216s - loss: 2.7129 - accuracy50: 0.5596 - val_loss: 2.9955 - val_accuracy50: 0.5206 - 216s/epoch - 96ms/step
Epoch 5/50
2257/2257 - 214s - loss: 2.6555 - accuracy50: 0.5744 - val_loss: 2.9800 - val_accuracy50: 0.5325 - 214s/epoch - 95ms/step
Epoch 6/50
2257/2257 - 217s - loss: 2.6197 - accuracy50: 0.5816 - val_loss: 2.9403 - val_accuracy50: 0.5274 - 217s/epoch - 96ms/step
Epoch 7/50
2257/2257 - 217s - loss: 2.5895 - accuracy50: 0.5879 - val_loss: 2.9198 - val_accuracy50: 0.5382 - 217s/epoch - 96ms/step
Epoch 8/50
2257/2257 - 218s - loss: 2.5701 - accuracy50: 0.5918 - val_loss: 2.9335 - val_accuracy50: 0.5391 - 218s/epoch - 97ms/step
Epoch 9/50
2257/2257 - 212s - loss: 2.5491 - accuracy50: 0.5956 - val_loss: 2.9609 - val_accuracy50: 0.5260 - 212s/epoch - 94ms/step
Epoch 10/50
2257/2257 - 215s - loss: 2.5345 - accuracy50: 0.5977 - val_loss: 2.9500 - val_accuracy50: 0.5507 - 215s/epoch - 95ms/step
Epoch 11/50
2257/2257 - 214s - loss: 2.5226 - accuracy50: 0.5998 - val_loss: 2.8602 - val_accuracy50: 0.5594 - 214s/epoch - 95ms/step
Epoch 12/50
2257/2257 - 211s - loss: 2.5120 - accuracy50: 0.6011 - val_loss: 2.9012 - val_accuracy50: 0.5650 - 211s/epoch - 93ms/step
Epoch 13/50
2257/2257 - 212s - loss: 2.5017 - accuracy50: 0.6019 - val_loss: 2.9296 - val_accuracy50: 0.5591 - 212s/epoch - 94ms/step
Epoch 14/50
2257/2257 - 209s - loss: 2.4937 - accuracy50: 0.6032 - val_loss: 2.8518 - val_accuracy50: 0.5678 - 209s/epoch - 93ms/step
Epoch 15/50
2257/2257 - 208s - loss: 2.4855 - accuracy50: 0.6046 - val_loss: 2.8802 - val_accuracy50: 0.5630 - 208s/epoch - 92ms/step
Epoch 16/50
2257/2257 - 210s - loss: 2.4774 - accuracy50: 0.6055 - val_loss: 2.8743 - val_accuracy50: 0.5641 - 210s/epoch - 93ms/step
Epoch 17/50
2257/2257 - 222s - loss: 2.4711 - accuracy50: 0.6061 - val_loss: 2.9687 - val_accuracy50: 0.5504 - 222s/epoch - 99ms/step
Epoch 18/50
2257/2257 - 218s - loss: 2.4641 - accuracy50: 0.6072 - val_loss: 2.9179 - val_accuracy50: 0.5521 - 218s/epoch - 96ms/step
Epoch 19/50
2257/2257 - 217s - loss: 2.4581 - accuracy50: 0.6079 - val_loss: 2.9505 - val_accuracy50: 0.5564 - 217s/epoch - 96ms/step
Epoch 20/50
2257/2257 - 214s - loss: 2.4515 - accuracy50: 0.6081 - val_loss: 2.9684 - val_accuracy50: 0.5640 - 214s/epoch - 95ms/step
Epoch 21/50
2257/2257 - 219s - loss: 2.4454 - accuracy50: 0.6096 - val_loss: 2.9364 - val_accuracy50: 0.5623 - 219s/epoch - 97ms/step
Epoch 22/50
2257/2257 - 219s - loss: 2.4391 - accuracy50: 0.6106 - val_loss: 2.9577 - val_accuracy50: 0.5639 - 219s/epoch - 97ms/step
Epoch 23/50
2257/2257 - 215s - loss: 2.4330 - accuracy50: 0.6106 - val_loss: 2.9460 - val_accuracy50: 0.5641 - 215s/epoch - 95ms/step
Epoch 24/50
2257/2257 - 218s - loss: 2.4272 - accuracy50: 0.6116 - val_loss: 2.9783 - val_accuracy50: 0.5673 - 218s/epoch - 96ms/step
testing model: results/AAL/W1/deepLOB_L2/h50
Evaluating performance on  test set...
7177/7177 - 325s - 325s/epoch - 45ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9495095
{'0': {'precision': 0.42620767983743363, 'recall': 0.6049117086500264, 'f1-score': 0.5000740335770747, 'support': 435490}, '1': {'precision': 0.7020738640515616, 'recall': 0.5420022011678703, 'f1-score': 0.6117400540637535, 'support': 974937}, '2': {'precision': 0.45229548622279403, 'recall': 0.49436790714898443, 'f1-score': 0.47239678750117575, 'support': 426662}, 'accuracy': 0.5458521606737616, 'macro avg': {'precision': 0.5268590100372631, 'recall': 0.5470939389889603, 'f1-score': 0.5280702917140013, 'support': 1837089}, 'weighted avg': {'precision': 0.5786678087082504, 'recall': 0.5458521606737616, 'f1-score': 0.5529068064312946, 'support': 1837089}}
[[263433  99150  72907]
 [264004 528418 182515]
 [ 90649 125085 210928]]
Evaluating performance on  train set...
2257/2257 - 106s - 106s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0894728
{'0': {'precision': 0.3859341533707423, 'recall': 0.6191748491528065, 'f1-score': 0.47549215178907284, 'support': 134739}, '1': {'precision': 0.7242685432262026, 'recall': 0.4928555818378156, 'f1-score': 0.5865626798906839, 'support': 311152}, '2': {'precision': 0.4211771151392053, 'recall': 0.478706600650041, 'f1-score': 0.4481029304615166, 'support': 131684}, 'accuracy': 0.5190979526468424, 'macro avg': {'precision': 0.5104599372453834, 'recall': 0.5302456772135544, 'f1-score': 0.5033859207137578, 'support': 577575}, 'weighted avg': {'precision': 0.5762373282827875, 'recall': 0.5190979526468424, 'f1-score': 0.5290836243053254, 'support': 577575}}
[[ 83427  25804  25508]
 [ 96674 153353  61125]
 [ 36068  32578  63038]]
Evaluating performance on  val set...
638/638 - 30s - 30s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92846376
{'0': {'precision': 0.47188722731414484, 'recall': 0.4883514532948746, 'f1-score': 0.47997819272182085, 'support': 36056}, '1': {'precision': 0.7172251108448913, 'recall': 0.6350176597303474, 'f1-score': 0.6736225495882148, 'support': 91451}, '2': {'precision': 0.3784881784881785, 'recall': 0.47594986181290305, 'f1-score': 0.4216605248188361, 'support': 35821}, 'accuracy': 0.5677532327586207, 'macro avg': {'precision': 0.5225335055490715, 'recall': 0.5331063249460416, 'f1-score': 0.5250870890429572, 'support': 163328}, 'weighted avg': {'precision': 0.5887731712966545, 'recall': 0.5677532327586207, 'f1-score': 0.5756138026468538, 'support': 163328}}
[[17608 10391  8057]
 [13439 58073 19939]
 [ 6267 12505 17049]]
training model: results/AAL/W1/deepLOB_L2/h100
Epoch 1/50
2257/2257 - 232s - loss: 3.1115 - accuracy100: 0.4527 - val_loss: 3.3691 - val_accuracy100: 0.4158 - 232s/epoch - 103ms/step
Epoch 2/50
2257/2257 - 227s - loss: 3.0295 - accuracy100: 0.4817 - val_loss: 3.3762 - val_accuracy100: 0.3974 - 227s/epoch - 101ms/step
Epoch 3/50
2257/2257 - 225s - loss: 2.9811 - accuracy100: 0.4951 - val_loss: 3.3851 - val_accuracy100: 0.4087 - 225s/epoch - 100ms/step
Epoch 4/50
2257/2257 - 231s - loss: 2.9546 - accuracy100: 0.5041 - val_loss: 3.4995 - val_accuracy100: 0.4022 - 231s/epoch - 102ms/step
Epoch 5/50
2257/2257 - 224s - loss: 2.9338 - accuracy100: 0.5114 - val_loss: 3.5686 - val_accuracy100: 0.4059 - 224s/epoch - 99ms/step
Epoch 6/50
2257/2257 - 224s - loss: 2.9118 - accuracy100: 0.5163 - val_loss: 3.5562 - val_accuracy100: 0.4091 - 224s/epoch - 99ms/step
Epoch 7/50
2257/2257 - 230s - loss: 2.8937 - accuracy100: 0.5218 - val_loss: 3.5119 - val_accuracy100: 0.4215 - 230s/epoch - 102ms/step
Epoch 8/50
2257/2257 - 228s - loss: 2.8720 - accuracy100: 0.5275 - val_loss: 3.5454 - val_accuracy100: 0.4220 - 228s/epoch - 101ms/step
Epoch 9/50
2257/2257 - 227s - loss: 2.8528 - accuracy100: 0.5317 - val_loss: 3.4506 - val_accuracy100: 0.4463 - 227s/epoch - 100ms/step
Epoch 10/50
2257/2257 - 231s - loss: 2.8380 - accuracy100: 0.5361 - val_loss: 3.5604 - val_accuracy100: 0.4364 - 231s/epoch - 102ms/step
Epoch 11/50
2257/2257 - 221s - loss: 2.8239 - accuracy100: 0.5391 - val_loss: 3.4507 - val_accuracy100: 0.4327 - 221s/epoch - 98ms/step
testing model: results/AAL/W1/deepLOB_L2/h100
Evaluating performance on  test set...
7177/7177 - 337s - 337s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1219081
{'0': {'precision': 0.3960128844996637, 'recall': 0.48372725291678054, 'f1-score': 0.43549729423790623, 'support': 578206}, '1': {'precision': 0.39927420999982793, 'recall': 0.4679360882114032, 'f1-score': 0.43088697709516693, 'support': 694332}, '2': {'precision': 0.44807304150372146, 'recall': 0.2516601688775682, 'f1-score': 0.3223003728317176, 'support': 564551}, 'accuracy': 0.40644301936378696, 'macro avg': {'precision': 0.41445337866773774, 'recall': 0.401107836668584, 'f1-score': 0.3962282147215969, 'support': 1837089}, 'weighted avg': {'precision': 0.41324398019180375, 'recall': 0.40644301936378696, 'f1-score': 0.39896856541794284, 'support': 1837089}}
[[279694 232641  65871]
 [260295 324903 109134]
 [166286 256190 142075]]
Evaluating performance on  train set...
2257/2257 - 116s - 116s/epoch - 51ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0984353
{'0': {'precision': 0.3822952803893657, 'recall': 0.5119949314779194, 'f1-score': 0.4377398819530692, 'support': 175199}, '1': {'precision': 0.4210716676799003, 'recall': 0.4737341073492552, 'f1-score': 0.44585320342149165, 'support': 231003}, '2': {'precision': 0.44776802379490144, 'recall': 0.21697700337859524, 'f1-score': 0.2923086598327149, 'support': 171373}, 'accuracy': 0.40915725230489547, 'macro avg': {'precision': 0.4170449906213891, 'recall': 0.40090201406858994, 'f1-score': 0.39196724840242525, 'support': 577575}, 'weighted avg': {'precision': 0.4172305221309789, 'recall': 0.40915725230489547, 'f1-score': 0.39783375161629647, 'support': 577575}}
[[ 89701  70193  15305]
 [ 91015 109434  30554]
 [ 53922  80267  37184]]
Evaluating performance on  val set...
638/638 - 26s - 26s/epoch - 40ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0969396
{'0': {'precision': 0.36531037757271734, 'recall': 0.37044169981159725, 'f1-score': 0.36785814511854154, 'support': 47770}, '1': {'precision': 0.43903597048046655, 'recall': 0.6204834215862179, 'f1-score': 0.5142228508565142, 'support': 68553}, '2': {'precision': 0.4350072214198422, 'recall': 0.1665992979470269, 'f1-score': 0.24092790007229986, 'support': 47005}, 'accuracy': 0.4167258522727273, 'macro avg': {'precision': 0.4131178564910087, 'recall': 0.3858414731149474, 'f1-score': 0.3743362986824519, 'support': 163328}, 'weighted avg': {'precision': 0.4163133330710951, 'recall': 0.4167258522727273, 'f1-score': 0.39276130626700756, 'support': 163328}}
[[17696 26455  3619]
 [19465 42536  6552]
 [11280 27894  7831]]
training model: results/AAL/W1/deepLOB_L2/h200
Epoch 1/50
2257/2257 - 234s - loss: 3.2137 - accuracy200: 0.4160 - val_loss: 3.4475 - val_accuracy200: 0.3550 - 234s/epoch - 104ms/step
Epoch 2/50
2257/2257 - 232s - loss: 3.1785 - accuracy200: 0.4343 - val_loss: 3.4884 - val_accuracy200: 0.3736 - 232s/epoch - 103ms/step
Epoch 3/50
2257/2257 - 226s - loss: 3.1499 - accuracy200: 0.4464 - val_loss: 3.8191 - val_accuracy200: 0.3657 - 226s/epoch - 100ms/step
Epoch 4/50
2257/2257 - 232s - loss: 3.1330 - accuracy200: 0.4512 - val_loss: 3.6430 - val_accuracy200: 0.3733 - 232s/epoch - 103ms/step
Epoch 5/50
2257/2257 - 221s - loss: 3.1139 - accuracy200: 0.4564 - val_loss: 3.9030 - val_accuracy200: 0.3728 - 221s/epoch - 98ms/step
Epoch 6/50
2257/2257 - 226s - loss: 3.1003 - accuracy200: 0.4611 - val_loss: 3.8187 - val_accuracy200: 0.3632 - 226s/epoch - 100ms/step
Epoch 7/50
2257/2257 - 224s - loss: 3.0904 - accuracy200: 0.4643 - val_loss: 3.7116 - val_accuracy200: 0.3603 - 224s/epoch - 99ms/step
Epoch 8/50
2257/2257 - 218s - loss: 3.0805 - accuracy200: 0.4673 - val_loss: 3.7804 - val_accuracy200: 0.3675 - 218s/epoch - 97ms/step
Epoch 9/50
2257/2257 - 230s - loss: 3.0717 - accuracy200: 0.4705 - val_loss: 3.6448 - val_accuracy200: 0.3610 - 230s/epoch - 102ms/step
Epoch 10/50
2257/2257 - 225s - loss: 3.0643 - accuracy200: 0.4729 - val_loss: 3.8334 - val_accuracy200: 0.3742 - 225s/epoch - 100ms/step
Epoch 11/50
2257/2257 - 219s - loss: 3.0530 - accuracy200: 0.4756 - val_loss: 3.6261 - val_accuracy200: 0.3728 - 219s/epoch - 97ms/step
testing model: results/AAL/W1/deepLOB_L2/h200
Evaluating performance on  test set...
7177/7177 - 330s - 330s/epoch - 46ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1690657
{'0': {'precision': 0.4082894245529602, 'recall': 0.3639081015868516, 'f1-score': 0.3848233757748517, 'support': 649021}, '1': {'precision': 0.3056662011160846, 'recall': 0.6155581370939192, 'f1-score': 0.40848967950019593, 'support': 562111}, '2': {'precision': 0.4422305408137478, 'recall': 0.08945822157113029, 'f1-score': 0.14881321744769002, 'support': 625957}, 'accuracy': 0.3473936211038224, 'macro avg': {'precision': 0.38539538882759755, 'recall': 0.3563081534173003, 'f1-score': 0.31404209090757923, 'support': 1837089}, 'weighted avg': {'precision': 0.3884537152116753, 'recall': 0.3473936211038224, 'f1-score': 0.31164830313403885, 'support': 1837089}}
[[236184 381060  31777]
 [177249 346012  38850]
 [165039 404921  55997]]
Evaluating performance on  train set...
2257/2257 - 117s - 117s/epoch - 52ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1600312
{'0': {'precision': 0.38381803063769876, 'recall': 0.38386306821080557, 'f1-score': 0.3838405481031417, 'support': 196010}, '1': {'precision': 0.3238512035010941, 'recall': 0.5913827687129195, 'f1-score': 0.4185159799393987, 'support': 188947}, '2': {'precision': 0.4402991207165749, 'recall': 0.08345014484627605, 'f1-score': 0.1403076923076923, 'support': 192618}, 'accuracy': 0.35156473185300613, 'macro avg': {'precision': 0.38265611828512264, 'recall': 0.3528986605900004, 'f1-score': 0.3142214067834109, 'support': 577575}, 'weighted avg': {'precision': 0.38303669924668104, 'recall': 0.35156473185300613, 'f1-score': 0.3139673839280257, 'support': 577575}}
[[ 75241 111956   8813]
 [ 65587 111740  11620]
 [ 55205 121339  16074]]
Evaluating performance on  val set...
638/638 - 30s - 30s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1503885
{'0': {'precision': 0.39579454107815976, 'recall': 0.3092509137362052, 'f1-score': 0.34721115537848607, 'support': 56362}, '1': {'precision': 0.3302957309109905, 'recall': 0.6455717743155347, 'f1-score': 0.4370052284988385, 'support': 52888}, '2': {'precision': 0.40505056850304666, 'recall': 0.1192351788157846, 'f1-score': 0.18423646727716902, 'support': 54078}, 'accuracy': 0.35524221199059564, 'macro avg': {'precision': 0.3770469468307323, 'recall': 0.3580192889558415, 'f1-score': 0.32281761705149786, 'support': 163328}, 'weighted avg': {'precision': 0.37764974275185803, 'recall': 0.35524221199059564, 'f1-score': 0.32232677398672327, 'support': 163328}}
[[17430 34312  4620]
 [13894 34143  4851]
 [12714 34916  6448]]
training model: results/AAL/W1/deepLOB_L2/h300
Epoch 1/50
2257/2257 - 237s - loss: 3.2428 - accuracy300: 0.4033 - val_loss: 3.4915 - val_accuracy300: 0.3483 - 237s/epoch - 105ms/step
Epoch 2/50
2257/2257 - 234s - loss: 3.2199 - accuracy300: 0.4132 - val_loss: 3.4784 - val_accuracy300: 0.3326 - 234s/epoch - 103ms/step
Epoch 3/50
2257/2257 - 236s - loss: 3.1929 - accuracy300: 0.4306 - val_loss: 3.4242 - val_accuracy300: 0.3555 - 236s/epoch - 104ms/step
Epoch 4/50
2257/2257 - 228s - loss: 3.1769 - accuracy300: 0.4346 - val_loss: 3.4126 - val_accuracy300: 0.3284 - 228s/epoch - 101ms/step
Epoch 5/50
2257/2257 - 226s - loss: 3.1623 - accuracy300: 0.4412 - val_loss: 3.5294 - val_accuracy300: 0.3448 - 226s/epoch - 100ms/step
Epoch 6/50
2257/2257 - 213s - loss: 3.1502 - accuracy300: 0.4456 - val_loss: 3.5449 - val_accuracy300: 0.3296 - 213s/epoch - 94ms/step
Epoch 7/50
2257/2257 - 230s - loss: 3.1391 - accuracy300: 0.4497 - val_loss: 3.5039 - val_accuracy300: 0.3371 - 230s/epoch - 102ms/step
Epoch 8/50
2257/2257 - 227s - loss: 3.1316 - accuracy300: 0.4529 - val_loss: 3.5665 - val_accuracy300: 0.3426 - 227s/epoch - 101ms/step
Epoch 9/50
2257/2257 - 225s - loss: 3.1228 - accuracy300: 0.4554 - val_loss: 3.4926 - val_accuracy300: 0.3259 - 225s/epoch - 100ms/step
Epoch 10/50
2257/2257 - 222s - loss: 3.1123 - accuracy300: 0.4592 - val_loss: 3.4883 - val_accuracy300: 0.3252 - 222s/epoch - 98ms/step
Epoch 11/50
2257/2257 - 230s - loss: 3.1015 - accuracy300: 0.4623 - val_loss: 3.4321 - val_accuracy300: 0.3399 - 230s/epoch - 102ms/step
Epoch 12/50
2257/2257 - 225s - loss: 3.0972 - accuracy300: 0.4642 - val_loss: 3.4842 - val_accuracy300: 0.3428 - 225s/epoch - 100ms/step
Epoch 13/50
2257/2257 - 235s - loss: 3.0848 - accuracy300: 0.4680 - val_loss: 3.4573 - val_accuracy300: 0.3312 - 235s/epoch - 104ms/step
Epoch 14/50
2257/2257 - 223s - loss: 3.0714 - accuracy300: 0.4732 - val_loss: 3.4887 - val_accuracy300: 0.3394 - 223s/epoch - 99ms/step
testing model: results/AAL/W1/deepLOB_L2/h300
Evaluating performance on  test set...
7177/7177 - 327s - 327s/epoch - 46ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1403701
{'0': {'precision': 0.3925880651630274, 'recall': 0.28811874802106174, 'f1-score': 0.3323368581950498, 'support': 682184}, '1': {'precision': 0.27247715229075975, 'recall': 0.6188405478224518, 'f1-score': 0.37836095966970695, 'support': 499943}, '2': {'precision': 0.39285714285714285, 'recall': 0.12055355883242082, 'f1-score': 0.18449294698497334, 'support': 654962}, 'accuracy': 0.3183803288790037, 'macro avg': {'precision': 0.35264078677031, 'recall': 0.34250428489197815, 'f1-score': 0.29839692161657666, 'support': 1837089}, 'weighted avg': {'precision': 0.359997170301969, 'recall': 0.3183803288790037, 'f1-score': 0.2921522419840608, 'support': 1837089}}
[[196550 419420  66214]
 [134746 309385  55812]
 [169356 406648  78958]]
Evaluating performance on  train set...
2257/2257 - 115s - 115s/epoch - 51ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1226077
{'0': {'precision': 0.36819082962346283, 'recall': 0.2654395084585415, 'f1-score': 0.3084839439034122, 'support': 196606}, '1': {'precision': 0.33058310929822937, 'recall': 0.6246112037027208, 'f1-score': 0.43234326463656364, 'support': 188402}, '2': {'precision': 0.3690978526263069, 'recall': 0.15307918802286996, 'f1-score': 0.2164062958830094, 'support': 192567}, 'accuracy': 0.3451378608838679, 'macro avg': {'precision': 0.35595726384933307, 'recall': 0.3477099667280441, 'f1-score': 0.3190778348076618, 'support': 577575}, 'weighted avg': {'precision': 0.35622579127151555, 'recall': 0.34513786088386794, 'f1-score': 0.3181869734639408, 'support': 577575}}
[[ 52187 119972  24447]
 [ 44784 117678  25940]
 [ 44768 118321  29478]]
Evaluating performance on  val set...
638/638 - 28s - 28s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1407343
{'0': {'precision': 0.3947407225362497, 'recall': 0.27029483037156704, 'f1-score': 0.3208742034081148, 'support': 59424}, '1': {'precision': 0.29073207651025185, 'recall': 0.5348057207948361, 'f1-score': 0.37668821038555833, 'support': 47406}, '2': {'precision': 0.34283456567138904, 'recall': 0.2150164607596729, 'f1-score': 0.26428229560979855, 'support': 56498}, 'accuracy': 0.3279474431818182, 'macro avg': {'precision': 0.3427691215726301, 'recall': 0.3400390039753587, 'f1-score': 0.32061490313449054, 'support': 163328}, 'weighted avg': {'precision': 0.34659693871437375, 'recall': 0.3279474431818182, 'f1-score': 0.31749810872737066, 'support': 163328}}
[[16062 31148 12214]
 [10981 25353 11072]
 [13647 30703 12148]]
training model: results/AAL/W1/deepLOB_L2/h500
Epoch 1/50
2257/2257 - 242s - loss: 3.2438 - accuracy500: 0.3931 - val_loss: 3.3275 - val_accuracy500: 0.3326 - 242s/epoch - 107ms/step
Epoch 2/50
2257/2257 - 223s - loss: 3.2093 - accuracy500: 0.4155 - val_loss: 3.5810 - val_accuracy500: 0.3447 - 223s/epoch - 99ms/step
Epoch 3/50
2257/2257 - 230s - loss: 3.1863 - accuracy500: 0.4286 - val_loss: 3.6670 - val_accuracy500: 0.3454 - 230s/epoch - 102ms/step
Epoch 4/50
2257/2257 - 230s - loss: 3.1663 - accuracy500: 0.4377 - val_loss: 3.7073 - val_accuracy500: 0.3440 - 230s/epoch - 102ms/step
Epoch 5/50
2257/2257 - 222s - loss: 3.1509 - accuracy500: 0.4441 - val_loss: 3.7738 - val_accuracy500: 0.3387 - 222s/epoch - 98ms/step
Epoch 6/50
2257/2257 - 222s - loss: 3.1392 - accuracy500: 0.4485 - val_loss: 3.6678 - val_accuracy500: 0.3366 - 222s/epoch - 99ms/step
Epoch 7/50
2257/2257 - 229s - loss: 3.1313 - accuracy500: 0.4522 - val_loss: 3.6535 - val_accuracy500: 0.3292 - 229s/epoch - 101ms/step
Epoch 8/50
2257/2257 - 221s - loss: 3.1227 - accuracy500: 0.4542 - val_loss: 3.6825 - val_accuracy500: 0.3384 - 221s/epoch - 98ms/step
Epoch 9/50
2257/2257 - 225s - loss: 3.1118 - accuracy500: 0.4591 - val_loss: 3.6593 - val_accuracy500: 0.3392 - 225s/epoch - 100ms/step
Epoch 10/50
2257/2257 - 220s - loss: 3.1042 - accuracy500: 0.4615 - val_loss: 3.6918 - val_accuracy500: 0.3432 - 220s/epoch - 98ms/step
Epoch 11/50
2257/2257 - 220s - loss: 3.0971 - accuracy500: 0.4644 - val_loss: 3.7204 - val_accuracy500: 0.3425 - 220s/epoch - 97ms/step
testing model: results/AAL/W1/deepLOB_L2/h500
Evaluating performance on  test set...
7177/7177 - 336s - 336s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1096808
{'0': {'precision': 0.36989905194099154, 'recall': 0.5550761447817223, 'f1-score': 0.4439516658117925, 'support': 670499}, '1': {'precision': 0.28278768028061024, 'recall': 0.4044283479189747, 'f1-score': 0.33284251139297133, 'support': 529859}, '2': {'precision': 0.37869612172082406, 'recall': 0.043506598547895424, 'f1-score': 0.07804677397088532, 'support': 636731}, 'accuracy': 0.33431695470388206, 'macro avg': {'precision': 0.3437942846474753, 'recall': 0.3343370304161975, 'f1-score': 0.2849469837252164, 'support': 1837089}, 'weighted avg': {'precision': 0.347823160550528, 'recall': 0.33431695470388206, 'f1-score': 0.28508338390604115, 'support': 1837089}}
[[372178 273616  24705]
 [294825 214290  20744]
 [339158 269871  27702]]
Evaluating performance on  train set...
2257/2257 - 106s - 106s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050502
{'0': {'precision': 0.35093451483793087, 'recall': 0.5251348446700406, 'f1-score': 0.42071541468423207, 'support': 198191}, '1': {'precision': 0.32768481337117333, 'recall': 0.44702669415513135, 'f1-score': 0.3781636323278264, 'support': 186745}, '2': {'precision': 0.37425229550043815, 'recall': 0.0509917514106697, 'f1-score': 0.0897544840693329, 'support': 192639}, 'accuracy': 0.34173916807341037, 'macro avg': {'precision': 0.3509572079031808, 'recall': 0.3410510967452805, 'f1-score': 0.29621117702713046, 'support': 577575}, 'weighted avg': {'precision': 0.3511944783900845, 'recall': 0.34173916807341037, 'f1-score': 0.2965716838979783, 'support': 577575}}
[[104077  85617   8497]
 [ 95338  83480   7927]
 [ 97156  85660   9823]]
Evaluating performance on  val set...
638/638 - 29s - 29s/epoch - 45ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108923
{'0': {'precision': 0.37073474808249995, 'recall': 0.4586190132935477, 'f1-score': 0.41002045755993016, 'support': 59653}, '1': {'precision': 0.28577253452212675, 'recall': 0.4490240464699099, 'f1-score': 0.3492633012740652, 'support': 46826}, '2': {'precision': 0.37886953252287253, 'recall': 0.10635191472145508, 'f1-score': 0.16608293158624857, 'support': 56849}, 'accuracy': 0.33325577978056425, 'macro avg': {'precision': 0.3451256050424998, 'recall': 0.3379983248283042, 'f1-score': 0.30845556347341463, 'support': 163328}, 'weighted avg': {'precision': 0.34920759871725154, 'recall': 0.33325577978056425, 'f1-score': 0.30769495908863476, 'support': 163328}}
[[27358 26680  5615]
 [21503 21026  4297]
 [24933 25870  6046]]
training model: results/AAL/W1/deepLOB_L2/h1000
Epoch 1/50
2257/2257 - 232s - loss: 3.1474 - accuracy1000: 0.4568 - val_loss: 3.5097 - val_accuracy1000: 0.3670 - 232s/epoch - 103ms/step
Epoch 2/50
2257/2257 - 228s - loss: 3.0971 - accuracy1000: 0.4822 - val_loss: 3.3976 - val_accuracy1000: 0.3733 - 228s/epoch - 101ms/step
Epoch 3/50
2257/2257 - 221s - loss: 3.0735 - accuracy1000: 0.4857 - val_loss: 3.5152 - val_accuracy1000: 0.3187 - 221s/epoch - 98ms/step
Epoch 4/50
2257/2257 - 220s - loss: 3.0629 - accuracy1000: 0.4894 - val_loss: 3.4635 - val_accuracy1000: 0.3383 - 220s/epoch - 97ms/step
Epoch 5/50
2257/2257 - 217s - loss: 3.0623 - accuracy1000: 0.4879 - val_loss: 3.7189 - val_accuracy1000: 0.2905 - 217s/epoch - 96ms/step
Epoch 6/50
2257/2257 - 221s - loss: 3.0451 - accuracy1000: 0.4927 - val_loss: 3.7766 - val_accuracy1000: 0.3494 - 221s/epoch - 98ms/step
Epoch 7/50
2257/2257 - 214s - loss: 3.0323 - accuracy1000: 0.4954 - val_loss: 3.8660 - val_accuracy1000: 0.3563 - 214s/epoch - 95ms/step
Epoch 8/50
2257/2257 - 219s - loss: 3.0144 - accuracy1000: 0.5002 - val_loss: 4.0140 - val_accuracy1000: 0.3100 - 219s/epoch - 97ms/step
Epoch 9/50
2257/2257 - 221s - loss: 3.0076 - accuracy1000: 0.5016 - val_loss: 3.8960 - val_accuracy1000: 0.3528 - 221s/epoch - 98ms/step
Epoch 10/50
2257/2257 - 218s - loss: 2.9958 - accuracy1000: 0.5052 - val_loss: 3.9628 - val_accuracy1000: 0.3497 - 218s/epoch - 96ms/step
Epoch 11/50
2257/2257 - 221s - loss: 2.9899 - accuracy1000: 0.5071 - val_loss: 3.9079 - val_accuracy1000: 0.3256 - 221s/epoch - 98ms/step
Epoch 12/50
2257/2257 - 222s - loss: 2.9805 - accuracy1000: 0.5094 - val_loss: 3.9536 - val_accuracy1000: 0.3368 - 222s/epoch - 98ms/step
testing model: results/AAL/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
7177/7177 - 339s - 339s/epoch - 47ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1372154
{'0': {'precision': 0.40539029524261244, 'recall': 0.8451730836683485, 'f1-score': 0.5479529813479619, 'support': 741260}, '1': {'precision': 0.21384441542051275, 'recall': 0.07211005542359461, 'f1-score': 0.10785166325590345, 'support': 404160}, '2': {'precision': 0.40225617133002134, 'recall': 0.09037415295466474, 'f1-score': 0.14758961827014455, 'support': 691669}, 'accuracy': 0.39091519245937456, 'macro avg': {'precision': 0.3404969606643822, 'recall': 0.33588576401553594, 'f1-score': 0.26779808762466994, 'support': 1837089}, 'weighted avg': {'precision': 0.36207015172131446, 'recall': 0.39091519245937456, 'f1-score': 0.3003926967364068, 'support': 1837089}}
[[626493  54768  59999]
 [342128  29144  32888]
 [576786  52374  62509]]
Evaluating performance on  train set...
2257/2257 - 97s - 97s/epoch - 43ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1405383
{'0': {'precision': 0.3419304908510273, 'recall': 0.7932010045689734, 'f1-score': 0.4778646525624685, 'support': 198294}, '1': {'precision': 0.357705689725747, 'recall': 0.11204184006538846, 'f1-score': 0.17063635734945345, 'support': 187189}, '2': {'precision': 0.3978895938655719, 'recall': 0.122097744830602, 'f1-score': 0.18685617316900233, 'support': 192092}, 'accuracy': 0.34924295546032985, 'macro avg': {'precision': 0.3658419248141154, 'recall': 0.34244686315498796, 'f1-score': 0.2784523943603081, 'support': 577575}, 'weighted avg': {'precision': 0.3656542318689554, 'recall': 0.34924295546032985, 'f1-score': 0.281508927026774, 'support': 577575}}
[[157287  18815  22192]
 [152916  20973  13300]
 [149794  18844  23454]]
Evaluating performance on  val set...
638/638 - 32s - 32s/epoch - 51ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1356138
{'0': {'precision': 0.408532158325614, 'recall': 0.7346810139120256, 'f1-score': 0.5250828587057953, 'support': 66633}, '1': {'precision': 0.2049494069049153, 'recall': 0.15593103050573784, 'f1-score': 0.17711113658320918, 'support': 34682}, '2': {'precision': 0.37418186068256193, 'recall': 0.1032525438214568, 'f1-score': 0.16184518167456555, 'support': 62013}, 'accuracy': 0.3720427605799373, 'macro avg': {'precision': 0.3292211419710304, 'recall': 0.3312881960797401, 'f1-score': 0.2880130589878567, 'support': 163328}, 'weighted avg': {'precision': 0.35225998213713894, 'recall': 0.3720427605799373, 'f1-score': 0.31327708546181277, 'support': 163328}}
[[48954 10348  7331]
 [25896  5408  3378]
 [44979 10631  6403]]
training model: results/AAL/W1/deepOF_L2/h10
Epoch 1/50
2257/2257 - 161s - loss: 2.6710 - accuracy10: 0.5308 - val_loss: 2.6536 - val_accuracy10: 0.7758 - 161s/epoch - 71ms/step
Epoch 2/50
2257/2257 - 155s - loss: 2.3267 - accuracy10: 0.6264 - val_loss: 2.5465 - val_accuracy10: 0.7807 - 155s/epoch - 68ms/step
Epoch 3/50
2257/2257 - 155s - loss: 2.2550 - accuracy10: 0.6396 - val_loss: 2.5300 - val_accuracy10: 0.7818 - 155s/epoch - 69ms/step
Epoch 4/50
2257/2257 - 161s - loss: 2.2222 - accuracy10: 0.6430 - val_loss: 2.5748 - val_accuracy10: 0.7813 - 161s/epoch - 71ms/step
Epoch 5/50
2257/2257 - 153s - loss: 2.1989 - accuracy10: 0.6459 - val_loss: 2.5485 - val_accuracy10: 0.7815 - 153s/epoch - 68ms/step
Epoch 6/50
2257/2257 - 156s - loss: 2.1828 - accuracy10: 0.6481 - val_loss: 2.6042 - val_accuracy10: 0.7884 - 156s/epoch - 69ms/step
Epoch 7/50
2257/2257 - 156s - loss: 2.1708 - accuracy10: 0.6492 - val_loss: 2.5573 - val_accuracy10: 0.7849 - 156s/epoch - 69ms/step
Epoch 8/50
2257/2257 - 149s - loss: 2.1580 - accuracy10: 0.6500 - val_loss: 2.5762 - val_accuracy10: 0.7879 - 149s/epoch - 66ms/step
Epoch 9/50
2257/2257 - 162s - loss: 2.1486 - accuracy10: 0.6511 - val_loss: 2.5594 - val_accuracy10: 0.7766 - 162s/epoch - 72ms/step
Epoch 10/50
2257/2257 - 160s - loss: 2.1395 - accuracy10: 0.6517 - val_loss: 2.5656 - val_accuracy10: 0.7808 - 160s/epoch - 71ms/step
Epoch 11/50
2257/2257 - 157s - loss: 2.1320 - accuracy10: 0.6525 - val_loss: 2.5879 - val_accuracy10: 0.7834 - 157s/epoch - 69ms/step
Epoch 12/50
2257/2257 - 154s - loss: 2.1257 - accuracy10: 0.6542 - val_loss: 2.5275 - val_accuracy10: 0.7797 - 154s/epoch - 68ms/step
Epoch 13/50
2257/2257 - 159s - loss: 2.1179 - accuracy10: 0.6554 - val_loss: 2.5665 - val_accuracy10: 0.7778 - 159s/epoch - 70ms/step
Epoch 14/50
2257/2257 - 161s - loss: 2.1110 - accuracy10: 0.6557 - val_loss: 2.5626 - val_accuracy10: 0.7792 - 161s/epoch - 71ms/step
Epoch 15/50
2257/2257 - 154s - loss: 2.1056 - accuracy10: 0.6562 - val_loss: 2.5831 - val_accuracy10: 0.7792 - 154s/epoch - 68ms/step
Epoch 16/50
2257/2257 - 151s - loss: 2.0980 - accuracy10: 0.6568 - val_loss: 2.5835 - val_accuracy10: 0.7783 - 151s/epoch - 67ms/step
Epoch 17/50
2257/2257 - 151s - loss: 2.0933 - accuracy10: 0.6569 - val_loss: 2.5674 - val_accuracy10: 0.7752 - 151s/epoch - 67ms/step
Epoch 18/50
2257/2257 - 155s - loss: 2.0855 - accuracy10: 0.6580 - val_loss: 2.5912 - val_accuracy10: 0.7772 - 155s/epoch - 69ms/step
Epoch 19/50
2257/2257 - 107s - loss: 2.0823 - accuracy10: 0.6579 - val_loss: 2.5409 - val_accuracy10: 0.7760 - 107s/epoch - 47ms/step
Epoch 20/50
2257/2257 - 49s - loss: 2.0755 - accuracy10: 0.6589 - val_loss: 2.5587 - val_accuracy10: 0.7739 - 49s/epoch - 22ms/step
Epoch 21/50
2257/2257 - 49s - loss: 2.0705 - accuracy10: 0.6594 - val_loss: 2.5526 - val_accuracy10: 0.7790 - 49s/epoch - 22ms/step
Epoch 22/50
2257/2257 - 49s - loss: 2.0661 - accuracy10: 0.6599 - val_loss: 2.5474 - val_accuracy10: 0.7751 - 49s/epoch - 22ms/step
testing model: results/AAL/W1/deepOF_L2/h10
Evaluating performance on  test set...
7177/7177 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5601191
{'0': {'precision': 0.4257708990869044, 'recall': 0.48622367850431264, 'f1-score': 0.4539936921574891, 'support': 207530}, '1': {'precision': 0.8822289123968615, 'recall': 0.8575967667024313, 'f1-score': 0.8697384707583358, 'support': 1423191}, '2': {'precision': 0.4699976457880378, 'recall': 0.49338786507271165, 'f1-score': 0.48140880764829924, 'support': 206363}, 'accuracy': 0.7747315854909193, 'macro avg': {'precision': 0.5926658190906012, 'recall': 0.6124027700931519, 'f1-score': 0.601713656854708, 'support': 1837084}, 'weighted avg': {'precision': 0.784357496406405, 'recall': 0.7747315854909193, 'f1-score': 0.7791512204358626, 'support': 1837084}}
[[ 100906   82070   24554]
 [ 112405 1220524   90262]
 [  23685   80861  101817]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5895067
{'0': {'precision': 0.4076344258170757, 'recall': 0.5290529409145555, 'f1-score': 0.46047421894679735, 'support': 67377}, '1': {'precision': 0.8865035779663838, 'recall': 0.8421202396572711, 'f1-score': 0.8637421258725385, 'support': 442799}, '2': {'precision': 0.4655817433595211, 'recall': 0.4800884299237366, 'f1-score': 0.472723819541842, 'support': 67398}, 'accuracy': 0.7633532672869624, 'macro avg': {'precision': 0.5865732490476602, 'recall': 0.6170872034985211, 'f1-score': 0.5989800547870593, 'support': 577574}, 'weighted avg': {'precision': 0.7815229924947434, 'recall': 0.7633532672869624, 'f1-score': 0.771070306200926, 'support': 577574}}
[[ 35646  23267   8464]
 [ 41232 372890  28677]
 [ 10568  24473  32357]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5641342
{'0': {'precision': 0.4245538634027843, 'recall': 0.51073395526582, 'f1-score': 0.46367346938775517, 'support': 17794}, '1': {'precision': 0.8948511929162909, 'recall': 0.8566035662711119, 'f1-score': 0.8753097607724571, 'support': 127416}, '2': {'precision': 0.45717006666332516, 'recall': 0.5034497985317657, 'f1-score': 0.47919512451402757, 'support': 18117}, 'accuracy': 0.7797486024968315, 'macro avg': {'precision': 0.5921917076608001, 'recall': 0.6235957733562326, 'f1-score': 0.6060594515580799, 'support': 163327}, 'weighted avg': {'precision': 0.7950640196645424, 'recall': 0.7797486024968315, 'f1-score': 0.7865242872500552, 'support': 163327}}
[[  9088   6274   2432]
 [  9873 109145   8398]
 [  2445   6551   9121]]
training model: results/AAL/W1/deepOF_L2/h20
Epoch 1/50
2257/2257 - 52s - loss: 2.7303 - accuracy20: 0.5261 - val_loss: 2.7484 - val_accuracy20: 0.7357 - 52s/epoch - 23ms/step
Epoch 2/50
2257/2257 - 50s - loss: 2.4061 - accuracy20: 0.6109 - val_loss: 2.6498 - val_accuracy20: 0.7444 - 50s/epoch - 22ms/step
Epoch 3/50
2257/2257 - 50s - loss: 2.3398 - accuracy20: 0.6257 - val_loss: 2.6370 - val_accuracy20: 0.7485 - 50s/epoch - 22ms/step
Epoch 4/50
2257/2257 - 49s - loss: 2.3126 - accuracy20: 0.6301 - val_loss: 2.6380 - val_accuracy20: 0.7459 - 49s/epoch - 22ms/step
Epoch 5/50
2257/2257 - 50s - loss: 2.2923 - accuracy20: 0.6330 - val_loss: 2.6283 - val_accuracy20: 0.7391 - 50s/epoch - 22ms/step
Epoch 6/50
2257/2257 - 49s - loss: 2.2779 - accuracy20: 0.6362 - val_loss: 2.6671 - val_accuracy20: 0.7445 - 49s/epoch - 22ms/step
Epoch 7/50
2257/2257 - 49s - loss: 2.2687 - accuracy20: 0.6380 - val_loss: 2.6557 - val_accuracy20: 0.7418 - 49s/epoch - 22ms/step
Epoch 8/50
2257/2257 - 49s - loss: 2.2559 - accuracy20: 0.6398 - val_loss: 2.6539 - val_accuracy20: 0.7443 - 49s/epoch - 22ms/step
Epoch 9/50
2257/2257 - 50s - loss: 2.2494 - accuracy20: 0.6401 - val_loss: 2.6769 - val_accuracy20: 0.7390 - 50s/epoch - 22ms/step
Epoch 10/50
2257/2257 - 49s - loss: 2.2411 - accuracy20: 0.6420 - val_loss: 2.6668 - val_accuracy20: 0.7431 - 49s/epoch - 22ms/step
Epoch 11/50
2257/2257 - 49s - loss: 2.2336 - accuracy20: 0.6427 - val_loss: 2.6420 - val_accuracy20: 0.7421 - 49s/epoch - 22ms/step
Epoch 12/50
2257/2257 - 50s - loss: 2.2247 - accuracy20: 0.6434 - val_loss: 2.6579 - val_accuracy20: 0.7425 - 50s/epoch - 22ms/step
Epoch 13/50
2257/2257 - 49s - loss: 2.2195 - accuracy20: 0.6441 - val_loss: 2.6668 - val_accuracy20: 0.7459 - 49s/epoch - 22ms/step
Epoch 14/50
2257/2257 - 49s - loss: 2.2129 - accuracy20: 0.6450 - val_loss: 2.6307 - val_accuracy20: 0.7371 - 49s/epoch - 22ms/step
Epoch 15/50
2257/2257 - 49s - loss: 2.2061 - accuracy20: 0.6460 - val_loss: 2.6217 - val_accuracy20: 0.7383 - 49s/epoch - 22ms/step
Epoch 16/50
2257/2257 - 49s - loss: 2.1998 - accuracy20: 0.6464 - val_loss: 2.6026 - val_accuracy20: 0.7382 - 49s/epoch - 22ms/step
Epoch 17/50
2257/2257 - 49s - loss: 2.1944 - accuracy20: 0.6473 - val_loss: 2.6017 - val_accuracy20: 0.7383 - 49s/epoch - 22ms/step
Epoch 18/50
2257/2257 - 49s - loss: 2.1882 - accuracy20: 0.6478 - val_loss: 2.6150 - val_accuracy20: 0.7390 - 49s/epoch - 22ms/step
Epoch 19/50
2257/2257 - 49s - loss: 2.1833 - accuracy20: 0.6486 - val_loss: 2.6311 - val_accuracy20: 0.7366 - 49s/epoch - 22ms/step
Epoch 20/50
2257/2257 - 49s - loss: 2.1776 - accuracy20: 0.6495 - val_loss: 2.6271 - val_accuracy20: 0.7343 - 49s/epoch - 22ms/step
Epoch 21/50
2257/2257 - 49s - loss: 2.1718 - accuracy20: 0.6495 - val_loss: 2.6285 - val_accuracy20: 0.7346 - 49s/epoch - 22ms/step
Epoch 22/50
2257/2257 - 49s - loss: 2.1669 - accuracy20: 0.6495 - val_loss: 2.6150 - val_accuracy20: 0.7296 - 49s/epoch - 22ms/step
Epoch 23/50
2257/2257 - 49s - loss: 2.1626 - accuracy20: 0.6500 - val_loss: 2.6146 - val_accuracy20: 0.7245 - 49s/epoch - 22ms/step
Epoch 24/50
2257/2257 - 49s - loss: 2.1576 - accuracy20: 0.6510 - val_loss: 2.6445 - val_accuracy20: 0.7300 - 49s/epoch - 22ms/step
Epoch 25/50
2257/2257 - 50s - loss: 2.1523 - accuracy20: 0.6509 - val_loss: 2.6412 - val_accuracy20: 0.7318 - 50s/epoch - 22ms/step
Epoch 26/50
2257/2257 - 50s - loss: 2.1488 - accuracy20: 0.6511 - val_loss: 2.6376 - val_accuracy20: 0.7283 - 50s/epoch - 22ms/step
Epoch 27/50
2257/2257 - 50s - loss: 2.1439 - accuracy20: 0.6514 - val_loss: 2.6498 - val_accuracy20: 0.7304 - 50s/epoch - 22ms/step
testing model: results/AAL/W1/deepOF_L2/h20
Evaluating performance on  test set...
7177/7177 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66776514
{'0': {'precision': 0.4825925106143228, 'recall': 0.42244227910352067, 'f1-score': 0.4505185488521671, 'support': 283866}, '1': {'precision': 0.8146904532713393, 'recall': 0.8458543085695249, 'f1-score': 0.8299799510205089, 'support': 1272731}, '2': {'precision': 0.5072141565893039, 'recall': 0.48315608210006167, 'f1-score': 0.4948929099640294, 'support': 280487}, 'accuracy': 0.7250517668217675, 'macro avg': {'precision': 0.601499040158322, 'recall': 0.5838175565910357, 'f1-score': 0.5917971366122351, 'support': 1837084}, 'weighted avg': {'precision': 0.7164290680446808, 'recall': 0.7250517668217675, 'f1-score': 0.7201843459895321, 'support': 1837084}}
[[ 119917  128484   35465]
 [  99987 1076545   96199]
 [  28581  116387  135519]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.675444
{'0': {'precision': 0.4753966659971882, 'recall': 0.46732477788746296, 'f1-score': 0.471326164874552, 'support': 91170}, '1': {'precision': 0.8287415187564517, 'recall': 0.8349821903249666, 'f1-score': 0.8318501500787804, 'support': 396133}, '2': {'precision': 0.5007204286550497, 'recall': 0.4927606872639054, 'f1-score': 0.49670867135287844, 'support': 90271}, 'accuracy': 0.7234605435840256, 'macro avg': {'precision': 0.6016195378028966, 'recall': 0.5983558851587784, 'f1-score': 0.5999616621020704, 'support': 577574}, 'weighted avg': {'precision': 0.7216985388948138, 'recall': 0.7234605435840256, 'f1-score': 0.7225610751600074, 'support': 577574}}
[[ 42606  34835  13729]
 [ 34744 330764  30625]
 [ 12272  33517  44482]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65248513
{'0': {'precision': 0.49086809470124015, 'recall': 0.4484406542248589, 'f1-score': 0.46869617636927313, 'support': 24273}, '1': {'precision': 0.8389291805199056, 'recall': 0.8490580840881156, 'f1-score': 0.8439632426530798, 'support': 114713}, '2': {'precision': 0.49177776003831725, 'recall': 0.5061829834435726, 'f1-score': 0.4988764044943821, 'support': 24341}, 'accuracy': 0.7384204693651386, 'macro avg': {'precision': 0.607191678419821, 'recall': 0.6012272405855157, 'f1-score': 0.6038452745055783, 'support': 163327}, 'weighted avg': {'precision': 0.7354649678544014, 'recall': 0.7384204693651386, 'f1-score': 0.7367634763711564, 'support': 163327}}
[[10885  9619  3769]
 [ 8351 97398  8964]
 [ 2939  9081 12321]]
training model: results/AAL/W1/deepOF_L2/h30
Epoch 1/50
2257/2257 - 52s - loss: 2.7874 - accuracy30: 0.5211 - val_loss: 2.8683 - val_accuracy30: 0.6971 - 52s/epoch - 23ms/step
Epoch 2/50
2257/2257 - 49s - loss: 2.5001 - accuracy30: 0.5954 - val_loss: 2.7644 - val_accuracy30: 0.7080 - 49s/epoch - 22ms/step
Epoch 3/50
2257/2257 - 50s - loss: 2.4346 - accuracy30: 0.6099 - val_loss: 2.7565 - val_accuracy30: 0.7002 - 50s/epoch - 22ms/step
Epoch 4/50
2257/2257 - 50s - loss: 2.4075 - accuracy30: 0.6135 - val_loss: 2.7102 - val_accuracy30: 0.7094 - 50s/epoch - 22ms/step
Epoch 5/50
2257/2257 - 50s - loss: 2.3878 - accuracy30: 0.6165 - val_loss: 2.7183 - val_accuracy30: 0.7106 - 50s/epoch - 22ms/step
Epoch 6/50
2257/2257 - 50s - loss: 2.3723 - accuracy30: 0.6192 - val_loss: 2.7279 - val_accuracy30: 0.7112 - 50s/epoch - 22ms/step
Epoch 7/50
2257/2257 - 50s - loss: 2.3616 - accuracy30: 0.6207 - val_loss: 2.7048 - val_accuracy30: 0.7080 - 50s/epoch - 22ms/step
Epoch 8/50
2257/2257 - 50s - loss: 2.3518 - accuracy30: 0.6216 - val_loss: 2.6915 - val_accuracy30: 0.7131 - 50s/epoch - 22ms/step
Epoch 9/50
2257/2257 - 50s - loss: 2.3430 - accuracy30: 0.6225 - val_loss: 2.6801 - val_accuracy30: 0.7093 - 50s/epoch - 22ms/step
Epoch 10/50
2257/2257 - 50s - loss: 2.3360 - accuracy30: 0.6240 - val_loss: 2.6960 - val_accuracy30: 0.7117 - 50s/epoch - 22ms/step
Epoch 11/50
2257/2257 - 50s - loss: 2.3286 - accuracy30: 0.6246 - val_loss: 2.7053 - val_accuracy30: 0.7106 - 50s/epoch - 22ms/step
Epoch 12/50
2257/2257 - 50s - loss: 2.3204 - accuracy30: 0.6257 - val_loss: 2.6846 - val_accuracy30: 0.7058 - 50s/epoch - 22ms/step
Epoch 13/50
2257/2257 - 50s - loss: 2.3135 - accuracy30: 0.6273 - val_loss: 2.6923 - val_accuracy30: 0.7091 - 50s/epoch - 22ms/step
Epoch 14/50
2257/2257 - 50s - loss: 2.3076 - accuracy30: 0.6276 - val_loss: 2.6879 - val_accuracy30: 0.7074 - 50s/epoch - 22ms/step
Epoch 15/50
2257/2257 - 49s - loss: 2.3001 - accuracy30: 0.6289 - val_loss: 2.6911 - val_accuracy30: 0.7034 - 49s/epoch - 22ms/step
Epoch 16/50
2257/2257 - 49s - loss: 2.2948 - accuracy30: 0.6291 - val_loss: 2.6767 - val_accuracy30: 0.7056 - 49s/epoch - 22ms/step
Epoch 17/50
2257/2257 - 50s - loss: 2.2893 - accuracy30: 0.6296 - val_loss: 2.6768 - val_accuracy30: 0.7014 - 50s/epoch - 22ms/step
Epoch 18/50
2257/2257 - 50s - loss: 2.2834 - accuracy30: 0.6301 - val_loss: 2.7025 - val_accuracy30: 0.7001 - 50s/epoch - 22ms/step
Epoch 19/50
2257/2257 - 50s - loss: 2.2772 - accuracy30: 0.6314 - val_loss: 2.7329 - val_accuracy30: 0.6934 - 50s/epoch - 22ms/step
Epoch 20/50
2257/2257 - 49s - loss: 2.2705 - accuracy30: 0.6322 - val_loss: 2.7192 - val_accuracy30: 0.6948 - 49s/epoch - 22ms/step
Epoch 21/50
2257/2257 - 49s - loss: 2.2644 - accuracy30: 0.6320 - val_loss: 2.7128 - val_accuracy30: 0.6845 - 49s/epoch - 22ms/step
Epoch 22/50
2257/2257 - 49s - loss: 2.2580 - accuracy30: 0.6333 - val_loss: 2.6834 - val_accuracy30: 0.7020 - 49s/epoch - 22ms/step
Epoch 23/50
2257/2257 - 50s - loss: 2.2537 - accuracy30: 0.6331 - val_loss: 2.7223 - val_accuracy30: 0.6841 - 50s/epoch - 22ms/step
Epoch 24/50
2257/2257 - 50s - loss: 2.2456 - accuracy30: 0.6343 - val_loss: 2.7535 - val_accuracy30: 0.6865 - 50s/epoch - 22ms/step
Epoch 25/50
2257/2257 - 50s - loss: 2.2398 - accuracy30: 0.6344 - val_loss: 2.7518 - val_accuracy30: 0.6849 - 50s/epoch - 22ms/step
Epoch 26/50
2257/2257 - 50s - loss: 2.2345 - accuracy30: 0.6354 - val_loss: 2.7608 - val_accuracy30: 0.6862 - 50s/epoch - 22ms/step
testing model: results/AAL/W1/deepOF_L2/h30
Evaluating performance on  test set...
7177/7177 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7400832
{'0': {'precision': 0.5099960037204302, 'recall': 0.42158932110928554, 'f1-score': 0.4615978016103812, 'support': 342058}, '1': {'precision': 0.7453028492069051, 'recall': 0.8544409485259581, 'f1-score': 0.7961490762682581, 'support': 1158176}, '2': {'precision': 0.5660831258717799, 'recall': 0.3807184206620157, 'f1-score': 0.45525543221665676, 'support': 336850}, 'accuracy': 0.6869832843789396, 'macro avg': {'precision': 0.6071273262663718, 'recall': 0.5522495634324198, 'f1-score': 0.5710007700317653, 'support': 1837084}, 'weighted avg': {'precision': 0.6686276657319798, 'recall': 0.6869832843789396, 'f1-score': 0.6713502298868701, 'support': 1837084}}
[[144208 166002  31848]
 [102128 989593  66455]
 [ 36427 172178 128245]]
Evaluating performance on  train set...
2257/2257 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7394313
{'0': {'precision': 0.48637969336101095, 'recall': 0.49355592716118957, 'f1-score': 0.48994153387596007, 'support': 108239}, '1': {'precision': 0.7686744221643962, 'recall': 0.8305836041713185, 'f1-score': 0.7984307241007865, 'support': 362763}, '2': {'precision': 0.5567332822936192, 'recall': 0.3957606125436325, 'f1-score': 0.46264465529534365, 'support': 106572}, 'accuracy': 0.6871915979597419, 'macro avg': {'precision': 0.6039291326063422, 'recall': 0.5733000479587135, 'f1-score': 0.5836723044240301, 'support': 577574}, 'weighted avg': {'precision': 0.6766649302044775, 'recall': 0.6871915979597419, 'f1-score': 0.6786608688346585, 'support': 577574}}
[[ 53422  42181  12636]
 [ 40513 301305  20945]
 [ 15901  48494  42177]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7087617
{'0': {'precision': 0.5079692695791767, 'recall': 0.4594006014725708, 'f1-score': 0.4824656937486386, 'support': 28929}, '1': {'precision': 0.7817313028999584, 'recall': 0.85410409224851, 'f1-score': 0.8163167355661911, 'support': 105541}, '2': {'precision': 0.5444810543657331, 'recall': 0.4123089718265932, 'f1-score': 0.4692658108028161, 'support': 28857}, 'accuracy': 0.7061355440312992, 'macro avg': {'precision': 0.6113938756149561, 'recall': 0.5752712218492246, 'f1-score': 0.5893494133725486, 'support': 163327}, 'weighted avg': {'precision': 0.6913237629103117, 'recall': 0.7061355440312992, 'f1-score': 0.6958661957005431, 'support': 163327}}
[[13290 12096  3543]
 [ 8987 90143  6411]
 [ 3886 13073 11898]]
training model: results/AAL/W1/deepOF_L2/h50
Epoch 1/50
2257/2257 - 57s - loss: 2.8940 - accuracy50: 0.5077 - val_loss: 3.0246 - val_accuracy50: 0.6254 - 57s/epoch - 25ms/step
Epoch 2/50
2257/2257 - 52s - loss: 2.6567 - accuracy50: 0.5689 - val_loss: 2.9670 - val_accuracy50: 0.6377 - 52s/epoch - 23ms/step
Epoch 3/50
2257/2257 - 52s - loss: 2.6028 - accuracy50: 0.5802 - val_loss: 2.9451 - val_accuracy50: 0.6367 - 52s/epoch - 23ms/step
Epoch 4/50
2257/2257 - 52s - loss: 2.5780 - accuracy50: 0.5832 - val_loss: 2.9344 - val_accuracy50: 0.6415 - 52s/epoch - 23ms/step
Epoch 5/50
2257/2257 - 51s - loss: 2.5605 - accuracy50: 0.5864 - val_loss: 2.9353 - val_accuracy50: 0.6437 - 51s/epoch - 23ms/step
Epoch 6/50
2257/2257 - 52s - loss: 2.5489 - accuracy50: 0.5889 - val_loss: 2.9235 - val_accuracy50: 0.6413 - 52s/epoch - 23ms/step
Epoch 7/50
2257/2257 - 51s - loss: 2.5392 - accuracy50: 0.5906 - val_loss: 2.9170 - val_accuracy50: 0.6431 - 51s/epoch - 23ms/step
Epoch 8/50
2257/2257 - 52s - loss: 2.5297 - accuracy50: 0.5921 - val_loss: 2.8913 - val_accuracy50: 0.6446 - 52s/epoch - 23ms/step
Epoch 9/50
2257/2257 - 53s - loss: 2.5232 - accuracy50: 0.5934 - val_loss: 2.8911 - val_accuracy50: 0.6451 - 53s/epoch - 24ms/step
Epoch 10/50
2257/2257 - 51s - loss: 2.5146 - accuracy50: 0.5943 - val_loss: 2.8777 - val_accuracy50: 0.6433 - 51s/epoch - 23ms/step
Epoch 11/50
2257/2257 - 63s - loss: 2.5072 - accuracy50: 0.5963 - val_loss: 2.8707 - val_accuracy50: 0.6435 - 63s/epoch - 28ms/step
Epoch 12/50
2257/2257 - 78s - loss: 2.5017 - accuracy50: 0.5968 - val_loss: 2.8592 - val_accuracy50: 0.6452 - 78s/epoch - 35ms/step
Epoch 13/50
2257/2257 - 81s - loss: 2.4944 - accuracy50: 0.5983 - val_loss: 2.8681 - val_accuracy50: 0.6440 - 81s/epoch - 36ms/step
Epoch 14/50
2257/2257 - 84s - loss: 2.4888 - accuracy50: 0.5992 - val_loss: 2.8406 - val_accuracy50: 0.6424 - 84s/epoch - 37ms/step
Epoch 15/50
2257/2257 - 80s - loss: 2.4824 - accuracy50: 0.5998 - val_loss: 2.8313 - val_accuracy50: 0.6441 - 80s/epoch - 35ms/step
Epoch 16/50
2257/2257 - 79s - loss: 2.4755 - accuracy50: 0.6017 - val_loss: 2.8287 - val_accuracy50: 0.6438 - 79s/epoch - 35ms/step
Epoch 17/50
2257/2257 - 82s - loss: 2.4699 - accuracy50: 0.6017 - val_loss: 2.8645 - val_accuracy50: 0.6413 - 82s/epoch - 36ms/step
Epoch 18/50
2257/2257 - 79s - loss: 2.4636 - accuracy50: 0.6025 - val_loss: 2.8534 - val_accuracy50: 0.6434 - 79s/epoch - 35ms/step
Epoch 19/50
2257/2257 - 79s - loss: 2.4576 - accuracy50: 0.6041 - val_loss: 2.8321 - val_accuracy50: 0.6418 - 79s/epoch - 35ms/step
Epoch 20/50
2257/2257 - 78s - loss: 2.4508 - accuracy50: 0.6050 - val_loss: 2.9012 - val_accuracy50: 0.6406 - 78s/epoch - 35ms/step
Epoch 21/50
2257/2257 - 80s - loss: 2.4436 - accuracy50: 0.6052 - val_loss: 2.8929 - val_accuracy50: 0.6382 - 80s/epoch - 35ms/step
Epoch 22/50
2257/2257 - 81s - loss: 2.4389 - accuracy50: 0.6062 - val_loss: 2.9126 - val_accuracy50: 0.6368 - 81s/epoch - 36ms/step
Epoch 23/50
2257/2257 - 84s - loss: 2.4324 - accuracy50: 0.6078 - val_loss: 2.9288 - val_accuracy50: 0.6379 - 84s/epoch - 37ms/step
Epoch 24/50
2257/2257 - 84s - loss: 2.4263 - accuracy50: 0.6085 - val_loss: 2.9362 - val_accuracy50: 0.6351 - 84s/epoch - 37ms/step
Epoch 25/50
2257/2257 - 86s - loss: 2.4191 - accuracy50: 0.6101 - val_loss: 2.9662 - val_accuracy50: 0.6347 - 86s/epoch - 38ms/step
Epoch 26/50
2257/2257 - 84s - loss: 2.4138 - accuracy50: 0.6105 - val_loss: 2.9962 - val_accuracy50: 0.6297 - 84s/epoch - 37ms/step
testing model: results/AAL/W1/deepOF_L2/h50
Evaluating performance on  test set...
7177/7177 - 105s - 105s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.872217
{'0': {'precision': 0.5680470148346558, 'recall': 0.31118035670410366, 'f1-score': 0.40209183295007783, 'support': 435487}, '1': {'precision': 0.6269212879566957, 'recall': 0.858524191819574, 'f1-score': 0.7246675820893455, 'support': 974937}, '2': {'precision': 0.5683904424214354, 'recall': 0.3509164205690714, 'f1-score': 0.4339302741445121, 'support': 426660}, 'accuracy': 0.610883334676041, 'macro avg': {'precision': 0.5877862484042623, 'recall': 0.5068736563642496, 'f1-score': 0.5202298963946451, 'support': 1837084}, 'weighted avg': {'precision': 0.5993712406343239, 'recall': 0.610883334676041, 'f1-score': 0.5806766023229576, 'support': 1837084}}
[[135515 259195  40777]
 [ 65015 837007  72915]
 [ 38033 238905 149722]]
Evaluating performance on  train set...
2257/2257 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8298835
{'0': {'precision': 0.556519029505942, 'recall': 0.3846290946627357, 'f1-score': 0.4548771972967158, 'support': 134657}, '1': {'precision': 0.6614770825781914, 'recall': 0.8564223884387043, 'f1-score': 0.7464312278593251, 'support': 311107}, '2': {'precision': 0.5735369704089874, 'recall': 0.3555572414839542, 'f1-score': 0.4389764148292463, 'support': 131810}, 'accuracy': 0.6321233296512655, 'macro avg': {'precision': 0.5971776941643736, 'recall': 0.5322029081951314, 'f1-score': 0.5467616133284291, 'support': 577574}, 'weighted avg': {'precision': 0.6169378153369848, 'recall': 0.6321233296512655, 'f1-score': 0.6082923746578929, 'support': 577574}}
[[ 51793  67635  15229]
 [ 25049 266439  19619]
 [ 16224  68720  46866]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81388813
{'0': {'precision': 0.5668097543154625, 'recall': 0.34411821786021235, 'f1-score': 0.4282436558731692, 'support': 36069}, '1': {'precision': 0.6791605870740709, 'recall': 0.8649301532474915, 'f1-score': 0.7608704013538722, 'support': 91486}, '2': {'precision': 0.5466912797463782, 'recall': 0.38082858101308287, 'f1-score': 0.44892982485047206, 'support': 35772}, 'accuracy': 0.643886191505385, 'macro avg': {'precision': 0.5975538737119704, 'recall': 0.5299589840402622, 'f1-score': 0.5460146273591712, 'support': 163327}, 'weighted avg': {'precision': 0.6253355964203733, 'recall': 0.643886191505385, 'f1-score': 0.619091930033006, 'support': 163327}}
[[12412 19325  4332]
 [ 5393 79129  6964]
 [ 4093 18056 13623]]
training model: results/AAL/W1/deepOF_L2/h100
Epoch 1/50
2257/2257 - 88s - loss: 3.0543 - accuracy100: 0.4732 - val_loss: 3.2758 - val_accuracy100: 0.4852 - 88s/epoch - 39ms/step
Epoch 2/50
2257/2257 - 84s - loss: 2.9011 - accuracy100: 0.5154 - val_loss: 3.2085 - val_accuracy100: 0.4956 - 84s/epoch - 37ms/step
Epoch 3/50
2257/2257 - 86s - loss: 2.8617 - accuracy100: 0.5244 - val_loss: 3.1928 - val_accuracy100: 0.4997 - 86s/epoch - 38ms/step
Epoch 4/50
2257/2257 - 86s - loss: 2.8415 - accuracy100: 0.5285 - val_loss: 3.2076 - val_accuracy100: 0.5027 - 86s/epoch - 38ms/step
Epoch 5/50
2257/2257 - 88s - loss: 2.8304 - accuracy100: 0.5311 - val_loss: 3.2041 - val_accuracy100: 0.5024 - 88s/epoch - 39ms/step
Epoch 6/50
2257/2257 - 83s - loss: 2.8200 - accuracy100: 0.5333 - val_loss: 3.2121 - val_accuracy100: 0.5036 - 83s/epoch - 37ms/step
Epoch 7/50
2257/2257 - 81s - loss: 2.8128 - accuracy100: 0.5346 - val_loss: 3.2173 - val_accuracy100: 0.5026 - 81s/epoch - 36ms/step
Epoch 8/50
2257/2257 - 82s - loss: 2.8052 - accuracy100: 0.5371 - val_loss: 3.2341 - val_accuracy100: 0.5026 - 82s/epoch - 36ms/step
Epoch 9/50
2257/2257 - 82s - loss: 2.7998 - accuracy100: 0.5379 - val_loss: 3.2139 - val_accuracy100: 0.5017 - 82s/epoch - 36ms/step
Epoch 10/50
2257/2257 - 83s - loss: 2.7925 - accuracy100: 0.5401 - val_loss: 3.2279 - val_accuracy100: 0.5043 - 83s/epoch - 37ms/step
Epoch 11/50
2257/2257 - 85s - loss: 2.7865 - accuracy100: 0.5411 - val_loss: 3.2330 - val_accuracy100: 0.5038 - 85s/epoch - 38ms/step
Epoch 12/50
2257/2257 - 85s - loss: 2.7806 - accuracy100: 0.5425 - val_loss: 3.2372 - val_accuracy100: 0.5036 - 85s/epoch - 38ms/step
Epoch 13/50
2257/2257 - 87s - loss: 2.7736 - accuracy100: 0.5437 - val_loss: 3.2413 - val_accuracy100: 0.5046 - 87s/epoch - 39ms/step
testing model: results/AAL/W1/deepOF_L2/h100
Evaluating performance on  test set...
7177/7177 - 113s - 113s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0717021
{'0': {'precision': 0.6118428407036002, 'recall': 0.16092272091289736, 'f1-score': 0.254823505569112, 'support': 578203}, '1': {'precision': 0.4231300936698096, 'recall': 0.9473234706163622, 'f1-score': 0.5849757763464194, 'support': 694332}, '2': {'precision': 0.6283542519117895, 'recall': 0.14525577053541855, 'f1-score': 0.23596406039809803, 'support': 564549}, 'accuracy': 0.4533309309753936, 'macro avg': {'precision': 0.5544423954283998, 'recall': 0.4178339873548927, 'f1-score': 0.35858778077120973, 'support': 1837084}, 'weighted avg': {'precision': 0.5455923054056532, 'recall': 0.4533309309753936, 'f1-score': 0.37381001111893913, 'support': 1837084}}
[[ 93046 452174  32983]
 [ 21056 657757  15519]
 [ 37973 444572  82004]]
Evaluating performance on  train set...
2257/2257 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0308653
{'0': {'precision': 0.6059923643976847, 'recall': 0.19660041781298873, 'f1-score': 0.29688368665342163, 'support': 175198}, '1': {'precision': 0.45837488790740943, 'recall': 0.9473609000090937, 'f1-score': 0.6178208594847611, 'support': 230931}, '2': {'precision': 0.6071897079468827, 'recall': 0.1538860859167663, 'f1-score': 0.24554202963293872, 'support': 171445}, 'accuracy': 0.4840972758469045, 'macro avg': {'precision': 0.5571856534173255, 'recall': 0.4326158012462829, 'f1-score': 0.3867488585903738, 'support': 577574}, 'weighted avg': {'precision': 0.5473259893555541, 'recall': 0.4840972758469045, 'f1-score': 0.40996369349451445, 'support': 577574}}
[[ 34444 128149  12605]
 [  7693 218775   4463]
 [ 14702 130360  26383]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0126209
{'0': {'precision': 0.6099561182648731, 'recall': 0.1773515446882386, 'f1-score': 0.2748014908442716, 'support': 47809}, '1': {'precision': 0.4777597390671946, 'recall': 0.9490011819468561, 'f1-score': 0.6355578574988517, 'support': 68531}, '2': {'precision': 0.6065117678020904, 'recall': 0.1716645029476238, 'f1-score': 0.2675911488571144, 'support': 46987}, 'accuracy': 0.49949487837283485, 'macro avg': {'precision': 0.564742541711386, 'recall': 0.4326724098609062, 'f1-score': 0.39265016573341255, 'support': 163327}, 'weighted avg': {'precision': 0.5534964406978395, 'recall': 0.49949487837283485, 'f1-score': 0.42409831393080644, 'support': 163327}}
[[ 8479 35725  3605]
 [ 1867 65036  1628]
 [ 3555 35366  8066]]
training model: results/AAL/W1/deepOF_L2/h200
Epoch 1/50
2257/2257 - 93s - loss: 3.1872 - accuracy200: 0.4250 - val_loss: 3.3152 - val_accuracy200: 0.3741 - 93s/epoch - 41ms/step
Epoch 2/50
2257/2257 - 89s - loss: 3.1196 - accuracy200: 0.4506 - val_loss: 3.2918 - val_accuracy200: 0.3837 - 89s/epoch - 39ms/step
Epoch 3/50
2257/2257 - 86s - loss: 3.0944 - accuracy200: 0.4572 - val_loss: 3.2970 - val_accuracy200: 0.3851 - 86s/epoch - 38ms/step
Epoch 4/50
2257/2257 - 91s - loss: 3.0802 - accuracy200: 0.4617 - val_loss: 3.3110 - val_accuracy200: 0.3849 - 91s/epoch - 40ms/step
Epoch 5/50
2257/2257 - 89s - loss: 3.0727 - accuracy200: 0.4635 - val_loss: 3.3082 - val_accuracy200: 0.3863 - 89s/epoch - 40ms/step
Epoch 6/50
2257/2257 - 89s - loss: 3.0659 - accuracy200: 0.4657 - val_loss: 3.3111 - val_accuracy200: 0.3875 - 89s/epoch - 39ms/step
Epoch 7/50
2257/2257 - 87s - loss: 3.0602 - accuracy200: 0.4674 - val_loss: 3.3198 - val_accuracy200: 0.3877 - 87s/epoch - 39ms/step
Epoch 8/50
2257/2257 - 87s - loss: 3.0552 - accuracy200: 0.4689 - val_loss: 3.3317 - val_accuracy200: 0.3889 - 87s/epoch - 39ms/step
Epoch 9/50
2257/2257 - 87s - loss: 3.0507 - accuracy200: 0.4693 - val_loss: 3.3393 - val_accuracy200: 0.3898 - 87s/epoch - 39ms/step
Epoch 10/50
2257/2257 - 88s - loss: 3.0461 - accuracy200: 0.4712 - val_loss: 3.3469 - val_accuracy200: 0.3904 - 88s/epoch - 39ms/step
Epoch 11/50
2257/2257 - 90s - loss: 3.0416 - accuracy200: 0.4721 - val_loss: 3.3560 - val_accuracy200: 0.3900 - 90s/epoch - 40ms/step
Epoch 12/50
2257/2257 - 92s - loss: 3.0371 - accuracy200: 0.4735 - val_loss: 3.3636 - val_accuracy200: 0.3913 - 92s/epoch - 41ms/step
testing model: results/AAL/W1/deepOF_L2/h200
Evaluating performance on  test set...
7177/7177 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234419
{'0': {'precision': 0.5439862288222843, 'recall': 0.10176435512673743, 'f1-score': 0.17145445672038545, 'support': 649019}, '1': {'precision': 0.3318042871374513, 'recall': 0.9350056038853605, 'f1-score': 0.4897954619161047, 'support': 562110}, '2': {'precision': 0.5291129050631469, 'recall': 0.11130512576782677, 'f1-score': 0.1839204257475925, 'support': 625955}, 'accuracy': 0.35996993060741916, 'macro avg': {'precision': 0.4683011403409609, 'recall': 0.3826916949266415, 'f1-score': 0.2817234481280276, 'support': 1837084}, 'weighted avg': {'precision': 0.4739950783827223, 'recall': 0.35996993060741916, 'f1-score': 0.2731078367906441, 'support': 1837084}}
[[ 66047 540785  42187]
 [ 16716 525576  19818]
 [ 38650 517633  69672]]
Evaluating performance on  train set...
2257/2257 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098739
{'0': {'precision': 0.5448099829835508, 'recall': 0.11761884595564037, 'f1-score': 0.19346960356859602, 'support': 195989}, '1': {'precision': 0.3594973607981321, 'recall': 0.9343576231819649, 'f1-score': 0.5192221751811082, 'support': 189009}, '2': {'precision': 0.5292513915710553, 'recall': 0.12096522931206381, 'f1-score': 0.19692211453521058, 'support': 192576}, 'accuracy': 0.38600941178100123, 'macro avg': {'precision': 0.47785291178424605, 'recall': 0.3909805661498897, 'f1-score': 0.3032046310949716, 'support': 577574}, 'weighted avg': {'precision': 0.47897951847770986, 'recall': 0.38600941178100123, 'f1-score': 0.30122209685918055, 'support': 577574}}
[[ 23052 158468  14469]
 [  6156 176602   6251]
 [ 13104 156177  23295]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010151
{'0': {'precision': 0.5549972082635399, 'recall': 0.10584226591893235, 'f1-score': 0.17778042745998154, 'support': 56348}, '1': {'precision': 0.35452424536089877, 'recall': 0.9334681611128962, 'f1-score': 0.5138805069402534, 'support': 52907}, '2': {'precision': 0.5377372702621271, 'recall': 0.13202766681461756, 'f1-score': 0.21200332600819624, 'support': 54072}, 'accuracy': 0.3826066725036277, 'macro avg': {'precision': 0.4824195746288553, 'recall': 0.3904460312821487, 'f1-score': 0.3012214201361438, 'support': 163327}, 'weighted avg': {'precision': 0.4843432293384239, 'recall': 0.3826066725036277, 'f1-score': 0.2979843586860606, 'support': 163327}}
[[ 5964 46235  4149]
 [ 1532 49387  1988]
 [ 3250 43683  7139]]
training model: results/AAL/W1/deepOF_L2/h300
Epoch 1/50
2257/2257 - 96s - loss: 3.2444 - accuracy300: 0.4004 - val_loss: 3.3060 - val_accuracy300: 0.3298 - 96s/epoch - 43ms/step
Epoch 2/50
2257/2257 - 83s - loss: 3.2118 - accuracy300: 0.4170 - val_loss: 3.3161 - val_accuracy300: 0.3301 - 83s/epoch - 37ms/step
Epoch 3/50
2257/2257 - 86s - loss: 3.1974 - accuracy300: 0.4237 - val_loss: 3.3191 - val_accuracy300: 0.3322 - 86s/epoch - 38ms/step
Epoch 4/50
2257/2257 - 88s - loss: 3.1887 - accuracy300: 0.4270 - val_loss: 3.3264 - val_accuracy300: 0.3339 - 88s/epoch - 39ms/step
Epoch 5/50
2257/2257 - 88s - loss: 3.1822 - accuracy300: 0.4289 - val_loss: 3.3369 - val_accuracy300: 0.3342 - 88s/epoch - 39ms/step
Epoch 6/50
2257/2257 - 90s - loss: 3.1768 - accuracy300: 0.4314 - val_loss: 3.3349 - val_accuracy300: 0.3383 - 90s/epoch - 40ms/step
Epoch 7/50
2257/2257 - 91s - loss: 3.1735 - accuracy300: 0.4327 - val_loss: 3.3374 - val_accuracy300: 0.3385 - 91s/epoch - 40ms/step
Epoch 8/50
2257/2257 - 92s - loss: 3.1702 - accuracy300: 0.4339 - val_loss: 3.3448 - val_accuracy300: 0.3402 - 92s/epoch - 41ms/step
Epoch 9/50
2257/2257 - 94s - loss: 3.1670 - accuracy300: 0.4346 - val_loss: 3.3395 - val_accuracy300: 0.3421 - 94s/epoch - 42ms/step
Epoch 10/50
2257/2257 - 95s - loss: 3.1640 - accuracy300: 0.4364 - val_loss: 3.3457 - val_accuracy300: 0.3402 - 95s/epoch - 42ms/step
Epoch 11/50
2257/2257 - 93s - loss: 3.1607 - accuracy300: 0.4370 - val_loss: 3.3491 - val_accuracy300: 0.3435 - 93s/epoch - 41ms/step
testing model: results/AAL/W1/deepOF_L2/h300
Evaluating performance on  test set...
7177/7177 - 107s - 107s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1099805
{'0': {'precision': 0.45581441171437903, 'recall': 0.12886131727117212, 'f1-score': 0.20092110074968003, 'support': 682183}, '1': {'precision': 0.2867916305867305, 'recall': 0.8108700609270676, 'f1-score': 0.4237202569154468, 'support': 499942}, '2': {'precision': 0.454522993164253, 'recall': 0.1600985710555928, 'f1-score': 0.236791176729618, 'support': 654959}, 'accuracy': 0.32559915605383316, 'macro avg': {'precision': 0.39904301182178753, 'recall': 0.36660998308461085, 'f1-score': 0.2871441781315816, 'support': 1837084}, 'weighted avg': {'precision': 0.40935632191299226, 'recall': 0.32559915605383316, 'f1-score': 0.27434185060410693, 'support': 1837084}}
[[ 87907 520623  73653]
 [ 42366 405388  52188]
 [ 62584 487517 104858]]
Evaluating performance on  train set...
2257/2257 - 41s - 41s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099943
{'0': {'precision': 0.40021079941624776, 'recall': 0.1255589640278986, 'f1-score': 0.1911485097138697, 'support': 196569}, '1': {'precision': 0.3299361645535952, 'recall': 0.790141674938558, 'f1-score': 0.4654967797619885, 'support': 188389}, '2': {'precision': 0.41166749042382306, 'recall': 0.13837375918926775, 'f1-score': 0.20712620453838979, 'support': 192616}, 'accuracy': 0.3466014744431017, 'macro avg': {'precision': 0.38060481813122204, 'recall': 0.3513581327185748, 'f1-score': 0.2879238313380827, 'support': 577574}, 'weighted avg': {'precision': 0.38110982500946156, 'recall': 0.3466014744431017, 'f1-score': 0.2859619118275639, 'support': 577574}}
[[ 24681 153683  18205]
 [ 19649 148854  19886]
 [ 17340 148623  26653]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051351
{'0': {'precision': 0.42262687352090456, 'recall': 0.1081412952060555, 'f1-score': 0.1722161206503978, 'support': 59450}, '1': {'precision': 0.29984849793156504, 'recall': 0.8058649789029536, 'f1-score': 0.4370705585527859, 'support': 47400}, '2': {'precision': 0.4437849835939008, 'recall': 0.1628450519680578, 'f1-score': 0.23826116242017586, 'support': 56477}, 'accuracy': 0.32954747224892394, 'macro avg': {'precision': 0.38875345168212344, 'recall': 0.358950442025689, 'f1-score': 0.2825159472077865, 'support': 163327}, 'weighted avg': {'precision': 0.39431098931105507, 'recall': 0.32954747224892394, 'f1-score': 0.2719187183874832, 'support': 163327}}
[[ 6429 46786  6235]
 [ 3910 38198  5292]
 [ 4873 42407  9197]]
training model: results/AAL/W1/deepOF_L2/h500
Epoch 1/50
2257/2257 - 105s - loss: 3.2487 - accuracy500: 0.3909 - val_loss: 3.2850 - val_accuracy500: 0.3624 - 105s/epoch - 47ms/step
Epoch 2/50
2257/2257 - 94s - loss: 3.2225 - accuracy500: 0.4033 - val_loss: 3.2846 - val_accuracy500: 0.3623 - 94s/epoch - 42ms/step
Epoch 3/50
2257/2257 - 96s - loss: 3.2148 - accuracy500: 0.4082 - val_loss: 3.2953 - val_accuracy500: 0.3491 - 96s/epoch - 43ms/step
Epoch 4/50
2257/2257 - 96s - loss: 3.2080 - accuracy500: 0.4119 - val_loss: 3.2997 - val_accuracy500: 0.3400 - 96s/epoch - 43ms/step
Epoch 5/50
2257/2257 - 98s - loss: 3.2025 - accuracy500: 0.4142 - val_loss: 3.3034 - val_accuracy500: 0.3413 - 98s/epoch - 44ms/step
Epoch 6/50
2257/2257 - 95s - loss: 3.1986 - accuracy500: 0.4164 - val_loss: 3.3094 - val_accuracy500: 0.3419 - 95s/epoch - 42ms/step
Epoch 7/50
2257/2257 - 93s - loss: 3.1952 - accuracy500: 0.4187 - val_loss: 3.3118 - val_accuracy500: 0.3500 - 93s/epoch - 41ms/step
Epoch 8/50
2257/2257 - 93s - loss: 3.1918 - accuracy500: 0.4202 - val_loss: 3.3287 - val_accuracy500: 0.3401 - 93s/epoch - 41ms/step
Epoch 9/50
2257/2257 - 93s - loss: 3.1892 - accuracy500: 0.4221 - val_loss: 3.3264 - val_accuracy500: 0.3519 - 93s/epoch - 41ms/step
Epoch 10/50
2257/2257 - 90s - loss: 3.1875 - accuracy500: 0.4226 - val_loss: 3.3447 - val_accuracy500: 0.3468 - 90s/epoch - 40ms/step
Epoch 11/50
2257/2257 - 94s - loss: 3.1854 - accuracy500: 0.4239 - val_loss: 3.3532 - val_accuracy500: 0.3424 - 94s/epoch - 42ms/step
Epoch 12/50
2257/2257 - 94s - loss: 3.1831 - accuracy500: 0.4242 - val_loss: 3.3563 - val_accuracy500: 0.3465 - 94s/epoch - 42ms/step
testing model: results/AAL/W1/deepOF_L2/h500
Evaluating performance on  test set...
7177/7177 - 119s - 119s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998558
{'0': {'precision': 0.41067926606490435, 'recall': 0.36479452585988326, 'f1-score': 0.38637939722703585, 'support': 670498}, '1': {'precision': 0.30351916081549785, 'recall': 0.47400058128781675, 'f1-score': 0.3700697252248535, 'support': 529858}, '2': {'precision': 0.4023500712508755, 'recall': 0.26162662863891645, 'f1-score': 0.31707586332913945, 'support': 636728}, 'accuracy': 0.36053441214446375, 'macro avg': {'precision': 0.37218283271042596, 'recall': 0.3668072452622055, 'f1-score': 0.35784166192700956, 'support': 1837084}, 'weighted avg': {'precision': 0.37688491011668046, 'recall': 0.36053441214446375, 'f1-score': 0.3576549019293401, 'support': 1837084}}
[[244594 294201 131703]
 [162963 251153 115742]
 [188027 282116 166585]]
Evaluating performance on  train set...
2257/2257 - 43s - 43s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093937
{'0': {'precision': 0.38842771387792796, 'recall': 0.37338276462132103, 'f1-score': 0.38075667835126314, 'support': 198255}, '1': {'precision': 0.335702664648394, 'recall': 0.4763593317299709, 'f1-score': 0.39384947874686677, 'support': 186691}, '2': {'precision': 0.39986894376868576, 'recall': 0.2534314845193845, 'f1-score': 0.31023821704219395, 'support': 192628}, 'accuracy': 0.3666629730562664, 'macro avg': {'precision': 0.3746664407650026, 'recall': 0.3677245269568921, 'f1-score': 0.361614791380108, 'support': 577574}, 'weighted avg': {'precision': 0.375201026155984, 'recall': 0.3666629730562664, 'f1-score': 0.3614699338537828, 'support': 577574}}
[[74025 88915 35315]
 [59807 88932 37952]
 [56744 87066 48818]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979769
{'0': {'precision': 0.41233588363086804, 'recall': 0.3658074679895421, 'f1-score': 0.3876806124170759, 'support': 59668}, '1': {'precision': 0.2975466902420157, 'recall': 0.4605319421876336, 'f1-score': 0.36151857943674265, 'support': 46772}, '2': {'precision': 0.40878947368421054, 'recall': 0.27306766044966335, 'f1-score': 0.32742103765531627, 'support': 56887}, 'accuracy': 0.36063235105034686, 'macro avg': {'precision': 0.37289068251903146, 'recall': 0.36646902354227967, 'f1-score': 0.35887340983637833, 'support': 163327}, 'weighted avg': {'precision': 0.3782284502253753, 'recall': 0.36063235105034686, 'f1-score': 0.3592000976459213, 'support': 163327}}
[[21827 25976 11865]
 [14631 21540 10601]
 [16477 24876 15534]]
training model: results/AAL/W1/deepOF_L2/h1000
Epoch 1/50
2257/2257 - 105s - loss: 3.1945 - accuracy1000: 0.4242 - val_loss: 3.2468 - val_accuracy1000: 0.4098 - 105s/epoch - 47ms/step
Epoch 2/50
2257/2257 - 90s - loss: 3.1756 - accuracy1000: 0.4298 - val_loss: 3.2327 - val_accuracy1000: 0.4174 - 90s/epoch - 40ms/step
Epoch 3/50
2257/2257 - 93s - loss: 3.1619 - accuracy1000: 0.4333 - val_loss: 3.2696 - val_accuracy1000: 0.3885 - 93s/epoch - 41ms/step
Epoch 4/50
2257/2257 - 92s - loss: 3.1584 - accuracy1000: 0.4341 - val_loss: 3.2714 - val_accuracy1000: 0.3827 - 92s/epoch - 41ms/step
Epoch 5/50
2257/2257 - 97s - loss: 3.1564 - accuracy1000: 0.4349 - val_loss: 3.2895 - val_accuracy1000: 0.3587 - 97s/epoch - 43ms/step
Epoch 6/50
2257/2257 - 93s - loss: 3.1560 - accuracy1000: 0.4360 - val_loss: 3.2822 - val_accuracy1000: 0.3726 - 93s/epoch - 41ms/step
Epoch 7/50
2257/2257 - 97s - loss: 3.1548 - accuracy1000: 0.4358 - val_loss: 3.2914 - val_accuracy1000: 0.3625 - 97s/epoch - 43ms/step
Epoch 8/50
2257/2257 - 107s - loss: 3.1528 - accuracy1000: 0.4364 - val_loss: 3.3049 - val_accuracy1000: 0.3447 - 107s/epoch - 48ms/step
Epoch 9/50
2257/2257 - 109s - loss: 3.1525 - accuracy1000: 0.4370 - val_loss: 3.2903 - val_accuracy1000: 0.3667 - 109s/epoch - 48ms/step
Epoch 10/50
2257/2257 - 112s - loss: 3.1514 - accuracy1000: 0.4382 - val_loss: 3.3163 - val_accuracy1000: 0.3385 - 112s/epoch - 50ms/step
Epoch 11/50
2257/2257 - 104s - loss: 3.1498 - accuracy1000: 0.4389 - val_loss: 3.3143 - val_accuracy1000: 0.3366 - 104s/epoch - 46ms/step
Epoch 12/50
2257/2257 - 98s - loss: 3.1484 - accuracy1000: 0.4396 - val_loss: 3.3073 - val_accuracy1000: 0.3445 - 98s/epoch - 43ms/step
testing model: results/AAL/W1/deepOF_L2/h1000
Evaluating performance on  test set...
7177/7177 - 115s - 115s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0849719
{'0': {'precision': 0.42132152296837344, 'recall': 0.6636263438285404, 'f1-score': 0.5154165843732859, 'support': 741259}, '1': {'precision': 0.2731478735393558, 'recall': 0.07975801662707839, 'f1-score': 0.12346482870619507, 'support': 404160}, '2': {'precision': 0.40657904041457166, 'recall': 0.32419162455813144, 'f1-score': 0.3607411351910513, 'support': 691665}, 'accuracy': 0.40737712592347436, 'macro avg': {'precision': 0.367016145640767, 'recall': 0.3558586616712501, 'f1-score': 0.33320751609017735, 'support': 1837084}, 'weighted avg': {'precision': 0.38317262975020433, 'recall': 0.40737712592347436, 'f1-score': 0.3709513252294243, 'support': 1837084}}
[[491919  42619 206721]
 [251369  32235 120556]
 [424274  43159 224232]]
Evaluating performance on  train set...
2257/2257 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974529
{'0': {'precision': 0.36082739145018017, 'recall': 0.6728727294738381, 'f1-score': 0.46975115285268304, 'support': 198247}, '1': {'precision': 0.32688234671185007, 'recall': 0.06597522789693608, 'f1-score': 0.10979112387625713, 'support': 187146}, '2': {'precision': 0.37294103815178414, 'recall': 0.3301106769139509, 'f1-score': 0.35022123099939, 'support': 192181}, 'accuracy': 0.36217523641992194, 'macro avg': {'precision': 0.3535502587712715, 'recall': 0.356319544761575, 'f1-score': 0.30992116924277674, 'support': 577574}, 'weighted avg': {'precision': 0.35385916468471185, 'recall': 0.36217523641992194, 'f1-score': 0.31334442489313175, 'support': 577574}}
[[133395  12495  52357]
 [120487  12347  54312]
 [115810  12930  63441]]
Evaluating performance on  val set...
638/638 - 13s - 13s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0816475
{'0': {'precision': 0.43216567051757365, 'recall': 0.6627413330133062, 'f1-score': 0.5231751219743263, 'support': 66661}, '1': {'precision': 0.2544825416797735, 'recall': 0.07009588724584104, 'f1-score': 0.10991598922125859, 'support': 34624}, '2': {'precision': 0.41902139130772065, 'recall': 0.3482479610586377, 'f1-score': 0.38037058228070947, 'support': 62042}, 'accuracy': 0.4176406840265235, 'macro avg': {'precision': 0.3685565345016893, 'recall': 0.3603617271059283, 'f1-score': 0.33782056449209813, 'support': 163327}, 'weighted avg': {'precision': 0.3895052529282118, 'recall': 0.4176406840265235, 'f1-score': 0.38132127377951713, 'support': 163327}}
[[44179  3469 19013]
 [21253  2427 10944]
 [36795  3641 21606]]
training model: results/AAL/W1/deepVOL_L2/h10
Epoch 1/50
2257/2257 - 108s - loss: 2.6238 - accuracy10: 0.5320 - val_loss: 2.4801 - val_accuracy10: 0.7070 - 108s/epoch - 48ms/step
Epoch 2/50
2257/2257 - 102s - loss: 2.4263 - accuracy10: 0.5933 - val_loss: 2.3691 - val_accuracy10: 0.7233 - 102s/epoch - 45ms/step
Epoch 3/50
2257/2257 - 100s - loss: 2.3484 - accuracy10: 0.6219 - val_loss: 2.3421 - val_accuracy10: 0.7265 - 100s/epoch - 45ms/step
Epoch 4/50
2257/2257 - 96s - loss: 2.2971 - accuracy10: 0.6343 - val_loss: 2.3372 - val_accuracy10: 0.7513 - 96s/epoch - 43ms/step
Epoch 5/50
2257/2257 - 96s - loss: 2.2615 - accuracy10: 0.6441 - val_loss: 2.3116 - val_accuracy10: 0.7392 - 96s/epoch - 42ms/step
Epoch 6/50
2257/2257 - 98s - loss: 2.2361 - accuracy10: 0.6508 - val_loss: 2.3435 - val_accuracy10: 0.7634 - 98s/epoch - 43ms/step
Epoch 7/50
2257/2257 - 102s - loss: 2.2146 - accuracy10: 0.6535 - val_loss: 2.3041 - val_accuracy10: 0.7593 - 102s/epoch - 45ms/step
Epoch 8/50
2257/2257 - 106s - loss: 2.1980 - accuracy10: 0.6556 - val_loss: 2.3802 - val_accuracy10: 0.7784 - 106s/epoch - 47ms/step
Epoch 9/50
2257/2257 - 101s - loss: 2.1843 - accuracy10: 0.6572 - val_loss: 2.3013 - val_accuracy10: 0.7569 - 101s/epoch - 45ms/step
Epoch 10/50
2257/2257 - 106s - loss: 2.1724 - accuracy10: 0.6587 - val_loss: 2.3256 - val_accuracy10: 0.7581 - 106s/epoch - 47ms/step
Epoch 11/50
2257/2257 - 105s - loss: 2.1606 - accuracy10: 0.6602 - val_loss: 2.2827 - val_accuracy10: 0.7603 - 105s/epoch - 47ms/step
Epoch 12/50
2257/2257 - 103s - loss: 2.1525 - accuracy10: 0.6623 - val_loss: 2.3102 - val_accuracy10: 0.7663 - 103s/epoch - 45ms/step
Epoch 13/50
2257/2257 - 100s - loss: 2.1450 - accuracy10: 0.6632 - val_loss: 2.2696 - val_accuracy10: 0.7583 - 100s/epoch - 44ms/step
Epoch 14/50
2257/2257 - 100s - loss: 2.1371 - accuracy10: 0.6644 - val_loss: 2.3100 - val_accuracy10: 0.7588 - 100s/epoch - 44ms/step
Epoch 15/50
2257/2257 - 98s - loss: 2.1306 - accuracy10: 0.6657 - val_loss: 2.2918 - val_accuracy10: 0.7549 - 98s/epoch - 43ms/step
Epoch 16/50
2257/2257 - 102s - loss: 2.1237 - accuracy10: 0.6655 - val_loss: 2.2856 - val_accuracy10: 0.7444 - 102s/epoch - 45ms/step
Epoch 17/50
2257/2257 - 100s - loss: 2.1169 - accuracy10: 0.6664 - val_loss: 2.2990 - val_accuracy10: 0.7542 - 100s/epoch - 44ms/step
Epoch 18/50
2257/2257 - 95s - loss: 2.1127 - accuracy10: 0.6661 - val_loss: 2.2682 - val_accuracy10: 0.7477 - 95s/epoch - 42ms/step
Epoch 19/50
2257/2257 - 97s - loss: 2.1081 - accuracy10: 0.6672 - val_loss: 2.3098 - val_accuracy10: 0.7647 - 97s/epoch - 43ms/step
Epoch 20/50
2257/2257 - 99s - loss: 2.1025 - accuracy10: 0.6668 - val_loss: 2.2863 - val_accuracy10: 0.7597 - 99s/epoch - 44ms/step
Epoch 21/50
2257/2257 - 96s - loss: 2.0979 - accuracy10: 0.6675 - val_loss: 2.2692 - val_accuracy10: 0.7477 - 96s/epoch - 43ms/step
Epoch 22/50
2257/2257 - 97s - loss: 2.0931 - accuracy10: 0.6680 - val_loss: 2.2945 - val_accuracy10: 0.7566 - 97s/epoch - 43ms/step
Epoch 23/50
2257/2257 - 102s - loss: 2.0868 - accuracy10: 0.6691 - val_loss: 2.2552 - val_accuracy10: 0.7479 - 102s/epoch - 45ms/step
Epoch 24/50
2257/2257 - 101s - loss: 2.0823 - accuracy10: 0.6689 - val_loss: 2.2896 - val_accuracy10: 0.7557 - 101s/epoch - 45ms/step
Epoch 25/50
2257/2257 - 104s - loss: 2.0777 - accuracy10: 0.6693 - val_loss: 2.2794 - val_accuracy10: 0.7592 - 104s/epoch - 46ms/step
Epoch 26/50
2257/2257 - 105s - loss: 2.0741 - accuracy10: 0.6693 - val_loss: 2.2847 - val_accuracy10: 0.7653 - 105s/epoch - 47ms/step
Epoch 27/50
2257/2257 - 106s - loss: 2.0691 - accuracy10: 0.6701 - val_loss: 2.2738 - val_accuracy10: 0.7583 - 106s/epoch - 47ms/step
Epoch 28/50
2257/2257 - 99s - loss: 2.0649 - accuracy10: 0.6699 - val_loss: 2.2678 - val_accuracy10: 0.7525 - 99s/epoch - 44ms/step
Epoch 29/50
2257/2257 - 100s - loss: 2.0601 - accuracy10: 0.6698 - val_loss: 2.2947 - val_accuracy10: 0.7610 - 100s/epoch - 44ms/step
Epoch 30/50
2257/2257 - 105s - loss: 2.0577 - accuracy10: 0.6704 - val_loss: 2.2816 - val_accuracy10: 0.7554 - 105s/epoch - 47ms/step
Epoch 31/50
2257/2257 - 97s - loss: 2.0530 - accuracy10: 0.6713 - val_loss: 2.2734 - val_accuracy10: 0.7543 - 97s/epoch - 43ms/step
Epoch 32/50
2257/2257 - 96s - loss: 2.0496 - accuracy10: 0.6715 - val_loss: 2.2946 - val_accuracy10: 0.7563 - 96s/epoch - 43ms/step
Epoch 33/50
2257/2257 - 101s - loss: 2.0464 - accuracy10: 0.6715 - val_loss: 2.2751 - val_accuracy10: 0.7573 - 101s/epoch - 45ms/step
testing model: results/AAL/W1/deepVOL_L2/h10
Evaluating performance on  test set...
7177/7177 - 143s - 143s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.605579
{'0': {'precision': 0.37925582838790145, 'recall': 0.6241850693624629, 'f1-score': 0.47182813871577545, 'support': 207533}, '1': {'precision': 0.9007162918080893, 'recall': 0.7889274328920954, 'f1-score': 0.8411238197405602, 'support': 1423193}, '2': {'precision': 0.44407938337704694, 'recall': 0.5357646477323939, 'f1-score': 0.4856324615884673, 'support': 206363}, 'accuracy': 0.7418785916196766, 'macro avg': {'precision': 0.5746838345243459, 'recall': 0.6496257166623174, 'f1-score': 0.5995281400149343, 'support': 1837089}, 'weighted avg': {'precision': 0.7905130209325154, 'recall': 0.7418785916196766, 'f1-score': 0.7594721938735188, 'support': 1837089}}
[[ 129539   57803   20191]
 [ 182181 1122796  118216]
 [  29841   65960  110562]]
Evaluating performance on  train set...
2257/2257 - 45s - 45s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65145755
{'0': {'precision': 0.3657083420012482, 'recall': 0.6527014584014019, 'f1-score': 0.4687668325253721, 'support': 67334}, '1': {'precision': 0.9077682678758436, 'recall': 0.7474677929448095, 'f1-score': 0.819855922372886, 'support': 442993}, '2': {'precision': 0.4071399270246346, 'recall': 0.5608345229597906, 'f1-score': 0.47178544176330045, 'support': 67248}, 'accuracy': 0.7146898671168247, 'macro avg': {'precision': 0.5602055123005755, 'recall': 0.6536679247686673, 'f1-score': 0.5868027322205195, 'support': 577575}, 'weighted avg': {'precision': 0.7862856591853669, 'recall': 0.7146898671168247, 'f1-score': 0.7383993557697159, 'support': 577575}}
[[ 43949  16307   7078]
 [ 64029 331123  47841]
 [ 12197  17336  37715]]
Evaluating performance on  val set...
638/638 - 14s - 14s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61184263
{'0': {'precision': 0.39327475019488345, 'recall': 0.6248029723035352, 'f1-score': 0.4827121297786282, 'support': 17764}, '1': {'precision': 0.9082072658018614, 'recall': 0.7934233244388637, 'f1-score': 0.8469439045640373, 'support': 127420}, '2': {'precision': 0.4141235813366961, 'recall': 0.542989417989418, 'f1-score': 0.46988124195163833, 'support': 18144}, 'accuracy': 0.7472631759404389, 'macro avg': {'precision': 0.5718685324444803, 'recall': 0.6537385715772723, 'f1-score': 0.599845758764768, 'support': 163328}, 'weighted avg': {'precision': 0.7973143657591356, 'recall': 0.7472631759404389, 'f1-score': 0.7654414175579675, 'support': 163328}}
[[ 11099   4702   1963]
 [ 14347 101098  11975]
 [  2776   5516   9852]]
training model: results/AAL/W1/deepVOL_L2/h20
Epoch 1/50
2257/2257 - 117s - loss: 2.7188 - accuracy20: 0.5206 - val_loss: 2.5529 - val_accuracy20: 0.6728 - 117s/epoch - 52ms/step
Epoch 2/50
2257/2257 - 103s - loss: 2.4765 - accuracy20: 0.5945 - val_loss: 2.4974 - val_accuracy20: 0.7037 - 103s/epoch - 46ms/step
Epoch 3/50
2257/2257 - 101s - loss: 2.4203 - accuracy20: 0.6130 - val_loss: 2.4916 - val_accuracy20: 0.7212 - 101s/epoch - 45ms/step
Epoch 4/50
2257/2257 - 106s - loss: 2.3902 - accuracy20: 0.6211 - val_loss: 2.4970 - val_accuracy20: 0.7237 - 106s/epoch - 47ms/step
Epoch 5/50
2257/2257 - 104s - loss: 2.3667 - accuracy20: 0.6275 - val_loss: 2.4872 - val_accuracy20: 0.7198 - 104s/epoch - 46ms/step
Epoch 6/50
2257/2257 - 107s - loss: 2.3507 - accuracy20: 0.6311 - val_loss: 2.4790 - val_accuracy20: 0.7255 - 107s/epoch - 47ms/step
Epoch 7/50
2257/2257 - 109s - loss: 2.3333 - accuracy20: 0.6349 - val_loss: 2.4840 - val_accuracy20: 0.7353 - 109s/epoch - 48ms/step
Epoch 8/50
2257/2257 - 107s - loss: 2.3153 - accuracy20: 0.6375 - val_loss: 2.4920 - val_accuracy20: 0.7228 - 107s/epoch - 47ms/step
Epoch 9/50
2257/2257 - 109s - loss: 2.3019 - accuracy20: 0.6399 - val_loss: 2.4798 - val_accuracy20: 0.7329 - 109s/epoch - 48ms/step
Epoch 10/50
2257/2257 - 110s - loss: 2.2889 - accuracy20: 0.6414 - val_loss: 2.4442 - val_accuracy20: 0.7278 - 110s/epoch - 49ms/step
Epoch 11/50
2257/2257 - 111s - loss: 2.2792 - accuracy20: 0.6435 - val_loss: 2.4409 - val_accuracy20: 0.7270 - 111s/epoch - 49ms/step
Epoch 12/50
2257/2257 - 114s - loss: 2.2682 - accuracy20: 0.6448 - val_loss: 2.4398 - val_accuracy20: 0.7131 - 114s/epoch - 50ms/step
Epoch 13/50
2257/2257 - 116s - loss: 2.2600 - accuracy20: 0.6463 - val_loss: 2.4096 - val_accuracy20: 0.7153 - 116s/epoch - 51ms/step
Epoch 14/50
2257/2257 - 113s - loss: 2.2534 - accuracy20: 0.6469 - val_loss: 2.3935 - val_accuracy20: 0.7161 - 113s/epoch - 50ms/step
Epoch 15/50
2257/2257 - 121s - loss: 2.2473 - accuracy20: 0.6469 - val_loss: 2.4194 - val_accuracy20: 0.7145 - 121s/epoch - 53ms/step
Epoch 16/50
2257/2257 - 111s - loss: 2.2416 - accuracy20: 0.6485 - val_loss: 2.4389 - val_accuracy20: 0.7226 - 111s/epoch - 49ms/step
Epoch 17/50
2257/2257 - 112s - loss: 2.2366 - accuracy20: 0.6481 - val_loss: 2.4176 - val_accuracy20: 0.7115 - 112s/epoch - 50ms/step
Epoch 18/50
2257/2257 - 114s - loss: 2.2318 - accuracy20: 0.6489 - val_loss: 2.4170 - val_accuracy20: 0.7179 - 114s/epoch - 50ms/step
Epoch 19/50
2257/2257 - 113s - loss: 2.2249 - accuracy20: 0.6493 - val_loss: 2.4168 - val_accuracy20: 0.7190 - 113s/epoch - 50ms/step
Epoch 20/50
2257/2257 - 107s - loss: 2.2216 - accuracy20: 0.6501 - val_loss: 2.4182 - val_accuracy20: 0.7138 - 107s/epoch - 48ms/step
Epoch 21/50
2257/2257 - 112s - loss: 2.2166 - accuracy20: 0.6507 - val_loss: 2.4348 - val_accuracy20: 0.7211 - 112s/epoch - 50ms/step
Epoch 22/50
2257/2257 - 108s - loss: 2.2124 - accuracy20: 0.6513 - val_loss: 2.4161 - val_accuracy20: 0.7158 - 108s/epoch - 48ms/step
Epoch 23/50
2257/2257 - 112s - loss: 2.2076 - accuracy20: 0.6510 - val_loss: 2.4166 - val_accuracy20: 0.7073 - 112s/epoch - 49ms/step
Epoch 24/50
2257/2257 - 111s - loss: 2.2042 - accuracy20: 0.6517 - val_loss: 2.4157 - val_accuracy20: 0.7127 - 111s/epoch - 49ms/step
testing model: results/AAL/W1/deepVOL_L2/h20
Evaluating performance on  test set...
7177/7177 - 152s - 152s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6771559
{'0': {'precision': 0.43591167532976427, 'recall': 0.5917483064371242, 'f1-score': 0.5020142852873494, 'support': 283869}, '1': {'precision': 0.8324512729646554, 'recall': 0.7855180823614084, 'f1-score': 0.808303971204362, 'support': 1272732}, '2': {'precision': 0.519353012019365, 'recall': 0.46431219873934, 'f1-score': 0.49029270588235296, 'support': 280488}, 'accuracy': 0.7065346316917689, 'macro avg': {'precision': 0.5959053201045948, 'recall': 0.6138595291792909, 'f1-score': 0.6002036541246881, 'support': 1837089}, 'weighted avg': {'precision': 0.7233734851944159, 'recall': 0.7065346316917689, 'f1-score': 0.7124215775700764, 'support': 1837089}}
[[167979  93025  22865]
 [175315 999754  97663]
 [ 42057 108197 130234]]
Evaluating performance on  train set...
2257/2257 - 53s - 53s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70648474
{'0': {'precision': 0.4230780616322785, 'recall': 0.6268833475886572, 'f1-score': 0.5052006468774025, 'support': 91194}, '1': {'precision': 0.8463171029091696, 'recall': 0.7497444749812615, 'f1-score': 0.7951091371135772, 'support': 396243}, '2': {'precision': 0.4843967054242368, 'recall': 0.4913022254764916, 'f1-score': 0.4878250285028172, 'support': 90138}, 'accuracy': 0.6900125524823616, 'macro avg': {'precision': 0.5845972899885616, 'recall': 0.6226433493488034, 'f1-score': 0.5960449374979323, 'support': 577575}, 'weighted avg': {'precision': 0.7230090616700204, 'recall': 0.6900125524823616, 'f1-score': 0.7013795092028221, 'support': 577575}}
[[ 57168  25230   8796]
 [ 60820 297081  38342]
 [ 17136  28717  44285]]
Evaluating performance on  val set...
638/638 - 15s - 15s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67156386
{'0': {'precision': 0.4393456177651784, 'recall': 0.6133992991135848, 'f1-score': 0.5119840327603709, 'support': 24255}, '1': {'precision': 0.851543909481664, 'recall': 0.7892410690935718, 'f1-score': 0.8192096274345692, 'support': 114714}, '2': {'precision': 0.4934969537225079, 'recall': 0.46886161172461926, 'f1-score': 0.4808639636225843, 'support': 24359}, 'accuracy': 0.7153458072100314, 'macro avg': {'precision': 0.59479549365645, 'recall': 0.623833993310592, 'f1-score': 0.6040192079391747, 'support': 163328}, 'weighted avg': {'precision': 0.7369307668427985, 'recall': 0.7153458072100314, 'f1-score': 0.7231237216277336, 'support': 163328}}
[[14878  7053  2324]
 [14779 90537  9398]
 [ 4207  8731 11421]]
training model: results/AAL/W1/deepVOL_L2/h30
Epoch 1/50
2257/2257 - 125s - loss: 2.8177 - accuracy30: 0.5114 - val_loss: 2.7314 - val_accuracy30: 0.6531 - 125s/epoch - 55ms/step
Epoch 2/50
2257/2257 - 118s - loss: 2.5822 - accuracy30: 0.5838 - val_loss: 2.6455 - val_accuracy30: 0.6646 - 118s/epoch - 52ms/step
Epoch 3/50
2257/2257 - 113s - loss: 2.5088 - accuracy30: 0.6017 - val_loss: 2.6651 - val_accuracy30: 0.6907 - 113s/epoch - 50ms/step
Epoch 4/50
2257/2257 - 112s - loss: 2.4741 - accuracy30: 0.6093 - val_loss: 2.6704 - val_accuracy30: 0.6883 - 112s/epoch - 50ms/step
Epoch 5/50
2257/2257 - 111s - loss: 2.4516 - accuracy30: 0.6130 - val_loss: 2.6607 - val_accuracy30: 0.6957 - 111s/epoch - 49ms/step
Epoch 6/50
2257/2257 - 113s - loss: 2.4336 - accuracy30: 0.6165 - val_loss: 2.6422 - val_accuracy30: 0.7040 - 113s/epoch - 50ms/step
Epoch 7/50
2257/2257 - 115s - loss: 2.4166 - accuracy30: 0.6201 - val_loss: 2.6478 - val_accuracy30: 0.7010 - 115s/epoch - 51ms/step
Epoch 8/50
2257/2257 - 112s - loss: 2.4032 - accuracy30: 0.6214 - val_loss: 2.6390 - val_accuracy30: 0.7018 - 112s/epoch - 50ms/step
Epoch 9/50
2257/2257 - 111s - loss: 2.3931 - accuracy30: 0.6232 - val_loss: 2.6389 - val_accuracy30: 0.7057 - 111s/epoch - 49ms/step
Epoch 10/50
2257/2257 - 113s - loss: 2.3834 - accuracy30: 0.6241 - val_loss: 2.6330 - val_accuracy30: 0.7089 - 113s/epoch - 50ms/step
Epoch 11/50
2257/2257 - 111s - loss: 2.3738 - accuracy30: 0.6259 - val_loss: 2.6397 - val_accuracy30: 0.7035 - 111s/epoch - 49ms/step
Epoch 12/50
2257/2257 - 112s - loss: 2.3663 - accuracy30: 0.6270 - val_loss: 2.6298 - val_accuracy30: 0.7052 - 112s/epoch - 49ms/step
Epoch 13/50
2257/2257 - 113s - loss: 2.3589 - accuracy30: 0.6277 - val_loss: 2.6781 - val_accuracy30: 0.7018 - 113s/epoch - 50ms/step
Epoch 14/50
2257/2257 - 117s - loss: 2.3536 - accuracy30: 0.6273 - val_loss: 2.6272 - val_accuracy30: 0.7011 - 117s/epoch - 52ms/step
Epoch 15/50
2257/2257 - 115s - loss: 2.3476 - accuracy30: 0.6286 - val_loss: 2.5941 - val_accuracy30: 0.7008 - 115s/epoch - 51ms/step
Epoch 16/50
2257/2257 - 118s - loss: 2.3411 - accuracy30: 0.6297 - val_loss: 2.5976 - val_accuracy30: 0.6983 - 118s/epoch - 52ms/step
Epoch 17/50
2257/2257 - 117s - loss: 2.3367 - accuracy30: 0.6303 - val_loss: 2.6279 - val_accuracy30: 0.6994 - 117s/epoch - 52ms/step
Epoch 18/50
2257/2257 - 119s - loss: 2.3319 - accuracy30: 0.6306 - val_loss: 2.6206 - val_accuracy30: 0.7021 - 119s/epoch - 53ms/step
Epoch 19/50
2257/2257 - 116s - loss: 2.3265 - accuracy30: 0.6310 - val_loss: 2.5900 - val_accuracy30: 0.6953 - 116s/epoch - 51ms/step
Epoch 20/50
2257/2257 - 114s - loss: 2.3223 - accuracy30: 0.6318 - val_loss: 2.5693 - val_accuracy30: 0.6909 - 114s/epoch - 50ms/step
Epoch 21/50
2257/2257 - 115s - loss: 2.3172 - accuracy30: 0.6324 - val_loss: 2.5908 - val_accuracy30: 0.6958 - 115s/epoch - 51ms/step
Epoch 22/50
2257/2257 - 114s - loss: 2.3129 - accuracy30: 0.6331 - val_loss: 2.5442 - val_accuracy30: 0.6903 - 114s/epoch - 51ms/step
Epoch 23/50
2257/2257 - 119s - loss: 2.3089 - accuracy30: 0.6327 - val_loss: 2.6051 - val_accuracy30: 0.6981 - 119s/epoch - 53ms/step
Epoch 24/50
2257/2257 - 116s - loss: 2.3048 - accuracy30: 0.6337 - val_loss: 2.5614 - val_accuracy30: 0.6929 - 116s/epoch - 51ms/step
Epoch 25/50
2257/2257 - 117s - loss: 2.3019 - accuracy30: 0.6333 - val_loss: 2.5709 - val_accuracy30: 0.6929 - 117s/epoch - 52ms/step
Epoch 26/50
2257/2257 - 116s - loss: 2.2977 - accuracy30: 0.6342 - val_loss: 2.5923 - val_accuracy30: 0.6951 - 116s/epoch - 51ms/step
Epoch 27/50
2257/2257 - 115s - loss: 2.2945 - accuracy30: 0.6345 - val_loss: 2.6033 - val_accuracy30: 0.6955 - 115s/epoch - 51ms/step
Epoch 28/50
2257/2257 - 119s - loss: 2.2900 - accuracy30: 0.6348 - val_loss: 2.6095 - val_accuracy30: 0.6967 - 119s/epoch - 53ms/step
Epoch 29/50
2257/2257 - 116s - loss: 2.2861 - accuracy30: 0.6351 - val_loss: 2.5812 - val_accuracy30: 0.6844 - 116s/epoch - 51ms/step
Epoch 30/50
2257/2257 - 115s - loss: 2.2824 - accuracy30: 0.6354 - val_loss: 2.6152 - val_accuracy30: 0.6905 - 115s/epoch - 51ms/step
Epoch 31/50
2257/2257 - 119s - loss: 2.2784 - accuracy30: 0.6363 - val_loss: 2.6109 - val_accuracy30: 0.6841 - 119s/epoch - 53ms/step
Epoch 32/50
2257/2257 - 118s - loss: 2.2753 - accuracy30: 0.6359 - val_loss: 2.6167 - val_accuracy30: 0.6857 - 118s/epoch - 52ms/step
testing model: results/AAL/W1/deepVOL_L2/h30
Evaluating performance on  test set...
7177/7177 - 175s - 175s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72829527
{'0': {'precision': 0.5117940530832169, 'recall': 0.48733705391728377, 'f1-score': 0.4992662210082423, 'support': 342061}, '1': {'precision': 0.7624020418874236, 'recall': 0.806482946907079, 'f1-score': 0.7838232245969694, 'support': 1158177}, '2': {'precision': 0.5248800802143708, 'recall': 0.4460072851201273, 'f1-score': 0.4822399548054516, 'support': 336851}, 'accuracy': 0.6809615647363846, 'macro avg': {'precision': 0.5996920583950037, 'recall': 0.5799424286481634, 'f1-score': 0.5884431334702211, 'support': 1837089}, 'weighted avg': {'precision': 0.672187180457256, 'recall': 0.6809615647363846, 'f1-score': 0.6755407847058666, 'support': 1837089}}
[[166699 148065  27297]
 [115429 934050 108698]
 [ 43587 143026 150238]]
Evaluating performance on  train set...
2257/2257 - 52s - 52s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7388056
{'0': {'precision': 0.4929563147506544, 'recall': 0.5371578898786172, 'f1-score': 0.5141087709378755, 'support': 108335}, '1': {'precision': 0.7820842795861721, 'recall': 0.7690628024118509, 'f1-score': 0.7755188850383458, 'support': 362709}, '2': {'precision': 0.4912985144279381, 'recall': 0.4743501891468211, 'f1-score': 0.4826756197853735, 'support': 106531}, 'accuracy': 0.6712063368393715, 'macro avg': {'precision': 0.5887797029215882, 'recall': 0.5935236271457631, 'f1-score': 0.5907677585871982, 'support': 577575}, 'weighted avg': {'precision': 0.6742188483979668, 'recall': 0.6712063368393715, 'f1-score': 0.6724729592248343, 'support': 577575}}
[[ 58193  40011  10131]
 [ 41571 278946  42192]
 [ 18285  37713  50533]]
Evaluating performance on  val set...
638/638 - 17s - 17s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71288466
{'0': {'precision': 0.5091787763868846, 'recall': 0.5249100470523111, 'f1-score': 0.5169247542631301, 'support': 28904}, '1': {'precision': 0.7912795390130826, 'recall': 0.7991621091343374, 'f1-score': 0.7952012902191391, 'support': 105503}, '2': {'precision': 0.4930867034881566, 'recall': 0.4599426022613326, 'f1-score': 0.47593831621882715, 'support': 28921}, 'accuracy': 0.6905613244514106, 'macro avg': {'precision': 0.5978483396293746, 'recall': 0.5946715861493271, 'f1-score': 0.5960214535670321, 'support': 163328}, 'weighted avg': {'precision': 0.6885544983638123, 'recall': 0.6905613244514106, 'f1-score': 0.6894220639607174, 'support': 163328}}
[[15172 11081  2651]
 [10165 84314 11024]
 [ 4460 11159 13302]]
training model: results/AAL/W1/deepVOL_L2/h50
Epoch 1/50
2257/2257 - 133s - loss: 2.9957 - accuracy50: 0.4684 - val_loss: 2.8417 - val_accuracy50: 0.5824 - 133s/epoch - 59ms/step
Epoch 2/50
2257/2257 - 118s - loss: 2.8029 - accuracy50: 0.5449 - val_loss: 2.8460 - val_accuracy50: 0.6156 - 118s/epoch - 52ms/step
Epoch 3/50
2257/2257 - 120s - loss: 2.6841 - accuracy50: 0.5707 - val_loss: 2.8410 - val_accuracy50: 0.6255 - 120s/epoch - 53ms/step
Epoch 4/50
2257/2257 - 119s - loss: 2.6497 - accuracy50: 0.5784 - val_loss: 2.8719 - val_accuracy50: 0.6317 - 119s/epoch - 53ms/step
Epoch 5/50
2257/2257 - 120s - loss: 2.6317 - accuracy50: 0.5815 - val_loss: 2.8837 - val_accuracy50: 0.6349 - 120s/epoch - 53ms/step
Epoch 6/50
2257/2257 - 119s - loss: 2.6184 - accuracy50: 0.5849 - val_loss: 2.8934 - val_accuracy50: 0.6352 - 119s/epoch - 53ms/step
Epoch 7/50
2257/2257 - 113s - loss: 2.6079 - accuracy50: 0.5864 - val_loss: 2.8630 - val_accuracy50: 0.6325 - 113s/epoch - 50ms/step
Epoch 8/50
2257/2257 - 122s - loss: 2.5972 - accuracy50: 0.5877 - val_loss: 2.8502 - val_accuracy50: 0.6364 - 122s/epoch - 54ms/step
Epoch 9/50
2257/2257 - 115s - loss: 2.5864 - accuracy50: 0.5899 - val_loss: 2.8445 - val_accuracy50: 0.6375 - 115s/epoch - 51ms/step
Epoch 10/50
2257/2257 - 121s - loss: 2.5767 - accuracy50: 0.5913 - val_loss: 2.8660 - val_accuracy50: 0.6392 - 121s/epoch - 54ms/step
Epoch 11/50
2257/2257 - 116s - loss: 2.5682 - accuracy50: 0.5923 - val_loss: 2.8388 - val_accuracy50: 0.6397 - 116s/epoch - 51ms/step
Epoch 12/50
2257/2257 - 121s - loss: 2.5618 - accuracy50: 0.5926 - val_loss: 2.8072 - val_accuracy50: 0.6423 - 121s/epoch - 54ms/step
Epoch 13/50
2257/2257 - 125s - loss: 2.5513 - accuracy50: 0.5946 - val_loss: 2.7888 - val_accuracy50: 0.6380 - 125s/epoch - 55ms/step
Epoch 14/50
2257/2257 - 124s - loss: 2.5439 - accuracy50: 0.5952 - val_loss: 2.7971 - val_accuracy50: 0.6398 - 124s/epoch - 55ms/step
Epoch 15/50
2257/2257 - 122s - loss: 2.5387 - accuracy50: 0.5956 - val_loss: 2.7745 - val_accuracy50: 0.6394 - 122s/epoch - 54ms/step
Epoch 16/50
2257/2257 - 118s - loss: 2.5322 - accuracy50: 0.5967 - val_loss: 2.8046 - val_accuracy50: 0.6413 - 118s/epoch - 52ms/step
Epoch 17/50
2257/2257 - 121s - loss: 2.5271 - accuracy50: 0.5972 - val_loss: 2.8130 - val_accuracy50: 0.6392 - 121s/epoch - 54ms/step
Epoch 18/50
2257/2257 - 123s - loss: 2.5218 - accuracy50: 0.5982 - val_loss: 2.7956 - val_accuracy50: 0.6412 - 123s/epoch - 55ms/step
Epoch 19/50
2257/2257 - 125s - loss: 2.5178 - accuracy50: 0.5985 - val_loss: 2.7955 - val_accuracy50: 0.6403 - 125s/epoch - 55ms/step
Epoch 20/50
2257/2257 - 119s - loss: 2.5135 - accuracy50: 0.5991 - val_loss: 2.8491 - val_accuracy50: 0.6420 - 119s/epoch - 53ms/step
Epoch 21/50
2257/2257 - 126s - loss: 2.5084 - accuracy50: 0.6002 - val_loss: 2.8164 - val_accuracy50: 0.6383 - 126s/epoch - 56ms/step
Epoch 22/50
2257/2257 - 118s - loss: 2.5041 - accuracy50: 0.5999 - val_loss: 2.8131 - val_accuracy50: 0.6394 - 118s/epoch - 52ms/step
Epoch 23/50
2257/2257 - 120s - loss: 2.4999 - accuracy50: 0.6009 - val_loss: 2.8510 - val_accuracy50: 0.6396 - 120s/epoch - 53ms/step
Epoch 24/50
2257/2257 - 119s - loss: 2.4968 - accuracy50: 0.6010 - val_loss: 2.8522 - val_accuracy50: 0.6407 - 119s/epoch - 53ms/step
Epoch 25/50
2257/2257 - 121s - loss: 2.4916 - accuracy50: 0.6017 - val_loss: 2.8313 - val_accuracy50: 0.6393 - 121s/epoch - 54ms/step
testing model: results/AAL/W1/deepVOL_L2/h50
Evaluating performance on  test set...
7177/7177 - 173s - 173s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86042374
{'0': {'precision': 0.5712729443366662, 'recall': 0.35161312544490114, 'f1-score': 0.4353019771722599, 'support': 435490}, '1': {'precision': 0.63014762655877, 'recall': 0.8396183548270298, 'f1-score': 0.7199561293568306, 'support': 974937}, '2': {'precision': 0.5675374405617195, 'recall': 0.3591859598464358, 'f1-score': 0.439940289081227, 'support': 426662}, 'accuracy': 0.6123546545649122, 'macro avg': {'precision': 0.5896526704857186, 'recall': 0.516805813372789, 'f1-score': 0.5317327985367725, 'support': 1837089}, 'weighted avg': {'precision': 0.6016499748180119, 'recall': 0.6123546545649122, 'f1-score': 0.5874442286386137, 'support': 1837089}}
[[153124 245262  37104]
 [ 76689 818575  79673]
 [ 38227 235184 153251]]
Evaluating performance on  train set...
2257/2257 - 59s - 59s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8376561
{'0': {'precision': 0.559316108939524, 'recall': 0.3918687239774675, 'f1-score': 0.460853626603823, 'support': 134739}, '1': {'precision': 0.6608883534557264, 'recall': 0.8110087674191392, 'f1-score': 0.7282930869777281, 'support': 311152}, '2': {'precision': 0.5382065045784654, 'recall': 0.4142036997661067, 'f1-score': 0.46813258492541665, 'support': 131684}, 'accuracy': 0.6227606804311129, 'macro avg': {'precision': 0.5861369889912386, 'recall': 0.5390270637209045, 'f1-score': 0.552426432835656, 'support': 577575}, 'weighted avg': {'precision': 0.609222371996311, 'recall': 0.6227606804311129, 'f1-score': 0.6065885447042985, 'support': 577575}}
[[ 52800  66883  15056]
 [ 27061 252347  31744]
 [ 14540  62600  54544]]
Evaluating performance on  val set...
638/638 - 18s - 18s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8142496
{'0': {'precision': 0.5765008576329331, 'recall': 0.37286443310406037, 'f1-score': 0.45284289948800865, 'support': 36056}, '1': {'precision': 0.676827820335793, 'recall': 0.8414998195755103, 'f1-score': 0.7502339728591484, 'support': 91451}, '2': {'precision': 0.5372334359676132, 'recall': 0.39454509924346054, 'f1-score': 0.4549639454030389, 'support': 35821}, 'accuracy': 0.6400188577586207, 'macro avg': {'precision': 0.5968540379787798, 'recall': 0.5363031173076771, 'f1-score': 0.5526802725833987, 'support': 163328}, 'weighted avg': {'precision': 0.6240640602354618, 'recall': 0.6400188577586207, 'f1-score': 0.6198239990948513, 'support': 163328}}
[[13444 18796  3816]
 [ 6137 76956  8358]
 [ 3739 17949 14133]]
training model: results/AAL/W1/deepVOL_L2/h100
Epoch 1/50
2257/2257 - 127s - loss: 3.1457 - accuracy100: 0.4380 - val_loss: 3.3003 - val_accuracy100: 0.4347 - 127s/epoch - 56ms/step
Epoch 2/50
2257/2257 - 128s - loss: 2.9916 - accuracy100: 0.4974 - val_loss: 3.0507 - val_accuracy100: 0.5129 - 128s/epoch - 57ms/step
Epoch 3/50
2257/2257 - 132s - loss: 2.9142 - accuracy100: 0.5165 - val_loss: 3.0653 - val_accuracy100: 0.5147 - 132s/epoch - 58ms/step
Epoch 4/50
2257/2257 - 126s - loss: 2.8861 - accuracy100: 0.5225 - val_loss: 3.0736 - val_accuracy100: 0.5141 - 126s/epoch - 56ms/step
Epoch 5/50
2257/2257 - 122s - loss: 2.8708 - accuracy100: 0.5258 - val_loss: 3.0717 - val_accuracy100: 0.5179 - 122s/epoch - 54ms/step
Epoch 6/50
2257/2257 - 124s - loss: 2.8622 - accuracy100: 0.5278 - val_loss: 3.0766 - val_accuracy100: 0.5185 - 124s/epoch - 55ms/step
Epoch 7/50
2257/2257 - 129s - loss: 2.8551 - accuracy100: 0.5293 - val_loss: 3.0981 - val_accuracy100: 0.5176 - 129s/epoch - 57ms/step
Epoch 8/50
2257/2257 - 131s - loss: 2.8482 - accuracy100: 0.5305 - val_loss: 3.0962 - val_accuracy100: 0.5159 - 131s/epoch - 58ms/step
Epoch 9/50
2257/2257 - 128s - loss: 2.8425 - accuracy100: 0.5322 - val_loss: 3.0827 - val_accuracy100: 0.5187 - 128s/epoch - 57ms/step
Epoch 10/50
2257/2257 - 128s - loss: 2.8386 - accuracy100: 0.5325 - val_loss: 3.0705 - val_accuracy100: 0.5204 - 128s/epoch - 57ms/step
Epoch 11/50
2257/2257 - 131s - loss: 2.8337 - accuracy100: 0.5338 - val_loss: 3.0631 - val_accuracy100: 0.5217 - 131s/epoch - 58ms/step
Epoch 12/50
2257/2257 - 133s - loss: 2.8289 - accuracy100: 0.5350 - val_loss: 3.0973 - val_accuracy100: 0.5173 - 133s/epoch - 59ms/step
testing model: results/AAL/W1/deepVOL_L2/h100
Evaluating performance on  test set...
7177/7177 - 189s - 189s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0467554
{'0': {'precision': 0.5039996911648325, 'recall': 0.3161105211637375, 'f1-score': 0.38853218176156046, 'support': 578206}, '1': {'precision': 0.44929932314624604, 'recall': 0.7456116094317992, 'f1-score': 0.5607159200140801, 'support': 694332}, '2': {'precision': 0.5006191940855326, 'recall': 0.28570669434648066, 'f1-score': 0.36379383452270325, 'support': 564551}, 'accuracy': 0.4690981220833612, 'macro avg': {'precision': 0.4846394027988703, 'recall': 0.4491429416473391, 'f1-score': 0.4376806454327813, 'support': 1837089}, 'weighted avg': {'precision': 0.48228670995722794, 'recall': 0.4690981220833612, 'f1-score': 0.44600714387624535, 'support': 1837089}}
[[182777 313749  81680]
 [ 97413 517702  79217]
 [ 82463 320792 161296]]
Evaluating performance on  train set...
2257/2257 - 62s - 62s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0022389
{'0': {'precision': 0.5026733525653612, 'recall': 0.379927967625386, 'f1-score': 0.4327654193363825, 'support': 175199}, '1': {'precision': 0.5042119971745226, 'recall': 0.7076185157768514, 'f1-score': 0.58884430003098, 'support': 231003}, '2': {'precision': 0.49737111867993783, 'recall': 0.35107047201134367, 'f1-score': 0.41160715201975806, 'support': 171373}, 'accuracy': 0.5024265246937627, 'macro avg': {'precision': 0.5014188228066072, 'recall': 0.4795389851378604, 'f1-score': 0.4777389571290402, 'support': 577575}, 'weighted avg': {'precision': 0.5017155060398076, 'recall': 0.5024265246937627, 'f1-score': 0.4889117794320277, 'support': 577575}}
[[ 66563  78947  29689]
 [ 36430 163462  31111]
 [ 29425  81784  60164]]
Evaluating performance on  val set...
638/638 - 18s - 18s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9900671
{'0': {'precision': 0.5151599529732072, 'recall': 0.348566045635336, 'f1-score': 0.41579683364131254, 'support': 47770}, '1': {'precision': 0.5164539428119125, 'recall': 0.7614254664274357, 'f1-score': 0.6154589884626495, 'support': 68553}, '2': {'precision': 0.5020042757883485, 'recall': 0.3197106690777577, 'f1-score': 0.3906369815832911, 'support': 47005}, 'accuracy': 0.5135494220219435, 'macro avg': {'precision': 0.511206057191156, 'recall': 0.4765673937135098, 'f1-score': 0.473964267895751, 'support': 163328}, 'weighted avg': {'precision': 0.5119169345032478, 'recall': 0.5135494220219435, 'f1-score': 0.49235933886686967, 'support': 163328}}
[[16651 24156  6963]
 [ 8410 52198  7945]
 [ 7261 24716 15028]]
training model: results/AAL/W1/deepVOL_L2/h200
Epoch 1/50
2257/2257 - 138s - loss: 3.2241 - accuracy200: 0.4130 - val_loss: 3.3228 - val_accuracy200: 0.3531 - 138s/epoch - 61ms/step
Epoch 2/50
2257/2257 - 134s - loss: 3.1551 - accuracy200: 0.4404 - val_loss: 3.2140 - val_accuracy200: 0.4139 - 134s/epoch - 59ms/step
Epoch 3/50
2257/2257 - 133s - loss: 3.1133 - accuracy200: 0.4517 - val_loss: 3.2119 - val_accuracy200: 0.4091 - 133s/epoch - 59ms/step
Epoch 4/50
2257/2257 - 129s - loss: 3.0953 - accuracy200: 0.4562 - val_loss: 3.2256 - val_accuracy200: 0.4116 - 129s/epoch - 57ms/step
Epoch 5/50
2257/2257 - 130s - loss: 3.0847 - accuracy200: 0.4598 - val_loss: 3.2216 - val_accuracy200: 0.4150 - 130s/epoch - 58ms/step
Epoch 6/50
2257/2257 - 136s - loss: 3.0766 - accuracy200: 0.4628 - val_loss: 3.2442 - val_accuracy200: 0.4078 - 136s/epoch - 60ms/step
Epoch 7/50
2257/2257 - 136s - loss: 3.0733 - accuracy200: 0.4641 - val_loss: 3.2409 - val_accuracy200: 0.4084 - 136s/epoch - 60ms/step
Epoch 8/50
2257/2257 - 136s - loss: 3.0671 - accuracy200: 0.4654 - val_loss: 3.2530 - val_accuracy200: 0.4064 - 136s/epoch - 60ms/step
Epoch 9/50
2257/2257 - 132s - loss: 3.0619 - accuracy200: 0.4668 - val_loss: 3.2530 - val_accuracy200: 0.4070 - 132s/epoch - 58ms/step
Epoch 10/50
2257/2257 - 134s - loss: 3.0573 - accuracy200: 0.4683 - val_loss: 3.2585 - val_accuracy200: 0.4068 - 134s/epoch - 59ms/step
Epoch 11/50
2257/2257 - 138s - loss: 3.0538 - accuracy200: 0.4691 - val_loss: 3.2656 - val_accuracy200: 0.4071 - 138s/epoch - 61ms/step
Epoch 12/50
2257/2257 - 132s - loss: 3.0504 - accuracy200: 0.4700 - val_loss: 3.2686 - val_accuracy200: 0.4104 - 132s/epoch - 59ms/step
Epoch 13/50
2257/2257 - 134s - loss: 3.0448 - accuracy200: 0.4727 - val_loss: 3.2787 - val_accuracy200: 0.4116 - 134s/epoch - 59ms/step
testing model: results/AAL/W1/deepVOL_L2/h200
Evaluating performance on  test set...
7177/7177 - 195s - 195s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981568
{'0': {'precision': 0.48364506764351506, 'recall': 0.184305284420689, 'f1-score': 0.2669010996857244, 'support': 649021}, '1': {'precision': 0.34012273556683953, 'recall': 0.7633545687595511, 'f1-score': 0.4705746880629057, 'support': 562111}, '2': {'precision': 0.44790044760793324, 'recall': 0.23483402214529114, 'f1-score': 0.30812056016584466, 'support': 625957}, 'accuracy': 0.37869912671623424, 'macro avg': {'precision': 0.42388941693942933, 'recall': 0.3941646251085104, 'f1-score': 0.3485321159714916, 'support': 1837089}, 'weighted avg': {'precision': 0.4275508464437992, 'recall': 0.37869912671623424, 'f1-score': 0.3432658126963844, 'support': 1837089}}
[[119618 422116 107287]
 [ 59115 429090  73906]
 [ 68593 410368 146996]]
Evaluating performance on  train set...
2257/2257 - 64s - 64s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0696962
{'0': {'precision': 0.49121969724781867, 'recall': 0.20479057190959646, 'f1-score': 0.2890680416380114, 'support': 196010}, '1': {'precision': 0.3771873349398097, 'recall': 0.7596627625736317, 'f1-score': 0.5040861121354194, 'support': 188947}, '2': {'precision': 0.46654815071759964, 'recall': 0.2793093065030267, 'f1-score': 0.34942666099443714, 'support': 192618}, 'accuracy': 0.41116218672899624, 'macro avg': {'precision': 0.44498506096840934, 'recall': 0.41458754699541833, 'f1-score': 0.3808602715892893, 'support': 577575}, 'weighted avg': {'precision': 0.44568750366158466, 'recall': 0.41116218672899624, 'f1-score': 0.3795379821816114, 'support': 577575}}
[[ 40141 119248  36621]
 [ 20517 143536  24894]
 [ 21059 117759  53800]]
Evaluating performance on  val set...
638/638 - 18s - 18s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0728283
{'0': {'precision': 0.5019734155967881, 'recall': 0.19632021574819913, 'f1-score': 0.2822524073719788, 'support': 56362}, '1': {'precision': 0.3715892265388141, 'recall': 0.7971940704885796, 'f1-score': 0.506901029143022, 'support': 52888}, '2': {'precision': 0.477552927644585, 'recall': 0.24568216280187877, 'f1-score': 0.32444840596344277, 'support': 54078}, 'accuracy': 0.40723574647335425, 'macro avg': {'precision': 0.4503718565933957, 'recall': 0.41306548301288587, 'f1-score': 0.3712006141594812, 'support': 163328}, 'weighted avg': {'precision': 0.4516674659838781, 'recall': 0.40723574647335425, 'f1-score': 0.3689680441278083, 'support': 163328}}
[[11065 36419  8878]
 [ 5069 42162  5657]
 [ 5909 34883 13286]]
training model: results/AAL/W1/deepVOL_L2/h300
Epoch 1/50
2257/2257 - 144s - loss: 3.2513 - accuracy300: 0.3966 - val_loss: 3.2948 - val_accuracy300: 0.3325 - 144s/epoch - 64ms/step
Epoch 2/50
2257/2257 - 134s - loss: 3.2277 - accuracy300: 0.4052 - val_loss: 3.2792 - val_accuracy300: 0.3674 - 134s/epoch - 60ms/step
Epoch 3/50
2257/2257 - 136s - loss: 3.2124 - accuracy300: 0.4155 - val_loss: 3.3020 - val_accuracy300: 0.3562 - 136s/epoch - 60ms/step
Epoch 4/50
2257/2257 - 134s - loss: 3.2027 - accuracy300: 0.4212 - val_loss: 3.3114 - val_accuracy300: 0.3559 - 134s/epoch - 59ms/step
Epoch 5/50
2257/2257 - 132s - loss: 3.1948 - accuracy300: 0.4249 - val_loss: 3.3230 - val_accuracy300: 0.3622 - 132s/epoch - 59ms/step
Epoch 6/50
2257/2257 - 133s - loss: 3.1876 - accuracy300: 0.4280 - val_loss: 3.2945 - val_accuracy300: 0.3797 - 133s/epoch - 59ms/step
Epoch 7/50
2257/2257 - 134s - loss: 3.1818 - accuracy300: 0.4300 - val_loss: 3.3136 - val_accuracy300: 0.3727 - 134s/epoch - 60ms/step
Epoch 8/50
2257/2257 - 134s - loss: 3.1740 - accuracy300: 0.4331 - val_loss: 3.2958 - val_accuracy300: 0.3977 - 134s/epoch - 60ms/step
Epoch 9/50
2257/2257 - 138s - loss: 3.1664 - accuracy300: 0.4349 - val_loss: 3.2963 - val_accuracy300: 0.4014 - 138s/epoch - 61ms/step
Epoch 10/50
2257/2257 - 131s - loss: 3.1580 - accuracy300: 0.4386 - val_loss: 3.2985 - val_accuracy300: 0.3971 - 131s/epoch - 58ms/step
Epoch 11/50
2257/2257 - 135s - loss: 3.1509 - accuracy300: 0.4402 - val_loss: 3.3198 - val_accuracy300: 0.3988 - 135s/epoch - 60ms/step
Epoch 12/50
2257/2257 - 137s - loss: 3.1445 - accuracy300: 0.4427 - val_loss: 3.3326 - val_accuracy300: 0.3943 - 137s/epoch - 61ms/step
testing model: results/AAL/W1/deepVOL_L2/h300
Evaluating performance on  test set...
7177/7177 - 198s - 198s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055747
{'0': {'precision': 0.4255438120927251, 'recall': 0.37371882072871837, 'f1-score': 0.3979511241812926, 'support': 682184}, '1': {'precision': 0.27375079359255317, 'recall': 0.492474142052194, 'f1-score': 0.3518945441188451, 'support': 499943}, '2': {'precision': 0.4227777219915297, 'recall': 0.21856229827073936, 'f1-score': 0.288156882953754, 'support': 654962}, 'accuracy': 0.35072007943001127, 'macro avg': {'precision': 0.37402410922560264, 'recall': 0.36158508701721725, 'f1-score': 0.3460008504179639, 'support': 1837089}, 'weighted avg': {'precision': 0.38324888737601803, 'recall': 0.35072007943001127, 'f1-score': 0.34627332270894623, 'support': 1837089}}
[[254945 325713 101526]
 [159816 246209  93918]
 [184343 327469 143150]]
Evaluating performance on  train set...
2257/2257 - 62s - 62s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0902404
{'0': {'precision': 0.4058908232701035, 'recall': 0.3971394565781309, 'f1-score': 0.40146745403922635, 'support': 196606}, '1': {'precision': 0.3399338717465747, 'recall': 0.4894905574250804, 'f1-score': 0.40122864607466285, 'support': 188402}, '2': {'precision': 0.42488829586453297, 'recall': 0.25135147766751315, 'f1-score': 0.31585335612952065, 'support': 192567}, 'accuracy': 0.37865731723152835, 'macro avg': {'precision': 0.3902376636270704, 'recall': 0.3793271638902415, 'f1-score': 0.3728498187478033, 'support': 577575}, 'weighted avg': {'precision': 0.39070987659504935, 'recall': 0.37865731723152835, 'f1-score': 0.3728452977992263, 'support': 577575}}
[[78080 88329 30197]
 [60863 92221 35318]
 [53424 90741 48402]]
Evaluating performance on  val set...
638/638 - 18s - 18s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949178
{'0': {'precision': 0.4352080065725596, 'recall': 0.39223209477652127, 'f1-score': 0.41260400070808995, 'support': 59424}, '1': {'precision': 0.29598158279336256, 'recall': 0.482744800236257, 'f1-score': 0.3669673281218681, 'support': 47406}, '2': {'precision': 0.43296459495270084, 'recall': 0.2486990689935927, 'f1-score': 0.3159267461861025, 'support': 56498}, 'accuracy': 0.3688528605015674, 'macro avg': {'precision': 0.3880513947728743, 'recall': 0.3745586546687903, 'f1-score': 0.3651660250053535, 'support': 163328}, 'weighted avg': {'precision': 0.39402146099938545, 'recall': 0.3688528605015674, 'f1-score': 0.36591559684221464, 'support': 163328}}
[[23308 27229  8887]
 [15006 22885  9515]
 [15242 27205 14051]]
training model: results/AAL/W1/deepVOL_L2/h500
Epoch 1/50
2257/2257 - 140s - loss: 3.2521 - accuracy500: 0.3908 - val_loss: 3.2893 - val_accuracy500: 0.3516 - 140s/epoch - 62ms/step
Epoch 2/50
2257/2257 - 139s - loss: 3.2322 - accuracy500: 0.3975 - val_loss: 3.2844 - val_accuracy500: 0.3709 - 139s/epoch - 62ms/step
Epoch 3/50
2257/2257 - 135s - loss: 3.2165 - accuracy500: 0.4058 - val_loss: 3.2893 - val_accuracy500: 0.3629 - 135s/epoch - 60ms/step
Epoch 4/50
2257/2257 - 135s - loss: 3.2098 - accuracy500: 0.4090 - val_loss: 3.2977 - val_accuracy500: 0.3707 - 135s/epoch - 60ms/step
Epoch 5/50
2257/2257 - 139s - loss: 3.2043 - accuracy500: 0.4123 - val_loss: 3.2997 - val_accuracy500: 0.3717 - 139s/epoch - 62ms/step
Epoch 6/50
2257/2257 - 138s - loss: 3.1953 - accuracy500: 0.4180 - val_loss: 3.2981 - val_accuracy500: 0.3771 - 138s/epoch - 61ms/step
Epoch 7/50
2257/2257 - 140s - loss: 3.1908 - accuracy500: 0.4204 - val_loss: 3.3229 - val_accuracy500: 0.3751 - 140s/epoch - 62ms/step
Epoch 8/50
2257/2257 - 139s - loss: 3.1860 - accuracy500: 0.4229 - val_loss: 3.3198 - val_accuracy500: 0.3689 - 139s/epoch - 62ms/step
Epoch 9/50
2257/2257 - 139s - loss: 3.1812 - accuracy500: 0.4258 - val_loss: 3.3340 - val_accuracy500: 0.3656 - 139s/epoch - 62ms/step
Epoch 10/50
2257/2257 - 139s - loss: 3.1779 - accuracy500: 0.4276 - val_loss: 3.3409 - val_accuracy500: 0.3637 - 139s/epoch - 61ms/step
Epoch 11/50
2257/2257 - 141s - loss: 3.1728 - accuracy500: 0.4305 - val_loss: 3.3257 - val_accuracy500: 0.3691 - 141s/epoch - 62ms/step
Epoch 12/50
2257/2257 - 135s - loss: 3.1665 - accuracy500: 0.4333 - val_loss: 3.3529 - val_accuracy500: 0.3550 - 135s/epoch - 60ms/step
testing model: results/AAL/W1/deepVOL_L2/h500
Evaluating performance on  test set...
7177/7177 - 199s - 199s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099123
{'0': {'precision': 0.41003135070247715, 'recall': 0.4197724381393559, 'f1-score': 0.41484471898635666, 'support': 670499}, '1': {'precision': 0.30198388990173597, 'recall': 0.4073347815173471, 'f1-score': 0.34683576443515246, 'support': 529859}, '2': {'precision': 0.40365497277235673, 'recall': 0.2763725969051295, 'f1-score': 0.3281019124906194, 'support': 636731}, 'accuracy': 0.36648306097309385, 'macro avg': {'precision': 0.3718900711255233, 'recall': 0.3678266055206108, 'f1-score': 0.36326079863737615, 'support': 1837089}, 'weighted avg': {'precision': 0.3766579229435371, 'recall': 0.36648306097309385, 'f1-score': 0.3651644963230105, 'support': 1837089}}
[[281457 253746 135296]
 [189346 215830 124683]
 [215625 245131 175975]]
Evaluating performance on  train set...
2257/2257 - 64s - 64s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0922694
{'0': {'precision': 0.39624929470110176, 'recall': 0.40394871613746336, 'f1-score': 0.4000619639060247, 'support': 198191}, '1': {'precision': 0.3419910163078353, 'recall': 0.41381563094058743, 'f1-score': 0.3744905623803639, 'support': 186745}, '2': {'precision': 0.3952182284980745, 'recall': 0.30685375235544204, 'f1-score': 0.3454751071719748, 'support': 192639}, 'accuracy': 0.3747547937497295, 'macro avg': {'precision': 0.37781951316900386, 'recall': 0.3748726998111643, 'f1-score': 0.37334254448612114, 'support': 577575}, 'weighted avg': {'precision': 0.37836229169571634, 'recall': 0.3747547937497295, 'f1-score': 0.3735876724766863, 'support': 577575}}
[[80059 74931 43201]
 [62212 77278 47255]
 [59771 73756 59112]]
Evaluating performance on  val set...
638/638 - 17s - 17s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970931
{'0': {'precision': 0.4158498227629017, 'recall': 0.4188892427874541, 'f1-score': 0.4173639992650866, 'support': 59653}, '1': {'precision': 0.2951631605101872, 'recall': 0.38053645410669285, 'f1-score': 0.33245643494160226, 'support': 46826}, '2': {'precision': 0.4102031771209965, 'recall': 0.3093282203732695, 'f1-score': 0.35269459876852716, 'support': 56849}, 'accuracy': 0.369759012539185, 'macro avg': {'precision': 0.37373872013136183, 'recall': 0.3695846390891388, 'f1-score': 0.36750501099173866, 'support': 163328}, 'weighted avg': {'precision': 0.3792836503690545, 'recall': 0.369759012539185, 'f1-score': 0.3705118223215106, 'support': 163328}}
[[24988 21723 12942]
 [16665 17819 12342]
 [18436 20828 17585]]
training model: results/AAL/W1/deepVOL_L2/h1000
Epoch 1/50
2257/2257 - 146s - loss: 3.1977 - accuracy1000: 0.4286 - val_loss: 3.2095 - val_accuracy1000: 0.4069 - 146s/epoch - 65ms/step
Epoch 2/50
2257/2257 - 135s - loss: 3.2093 - accuracy1000: 0.4160 - val_loss: 3.2074 - val_accuracy1000: 0.4066 - 135s/epoch - 60ms/step
Epoch 3/50
2257/2257 - 138s - loss: 3.1967 - accuracy1000: 0.4178 - val_loss: 3.2193 - val_accuracy1000: 0.4068 - 138s/epoch - 61ms/step
Epoch 4/50
2257/2257 - 139s - loss: 3.1748 - accuracy1000: 0.4262 - val_loss: 3.2666 - val_accuracy1000: 0.3677 - 139s/epoch - 62ms/step
Epoch 5/50
2257/2257 - 138s - loss: 3.1677 - accuracy1000: 0.4274 - val_loss: 3.2468 - val_accuracy1000: 0.3961 - 138s/epoch - 61ms/step
Epoch 6/50
2257/2257 - 136s - loss: 3.1606 - accuracy1000: 0.4331 - val_loss: 3.2570 - val_accuracy1000: 0.3870 - 136s/epoch - 60ms/step
Epoch 7/50
2257/2257 - 138s - loss: 3.1525 - accuracy1000: 0.4368 - val_loss: 3.2810 - val_accuracy1000: 0.3897 - 138s/epoch - 61ms/step
Epoch 8/50
2257/2257 - 138s - loss: 3.1565 - accuracy1000: 0.4324 - val_loss: 3.2329 - val_accuracy1000: 0.4079 - 138s/epoch - 61ms/step
Epoch 9/50
2257/2257 - 138s - loss: 3.1515 - accuracy1000: 0.4353 - val_loss: 3.2267 - val_accuracy1000: 0.4121 - 138s/epoch - 61ms/step
Epoch 10/50
2257/2257 - 138s - loss: 3.1474 - accuracy1000: 0.4354 - val_loss: 3.2162 - val_accuracy1000: 0.4137 - 138s/epoch - 61ms/step
Epoch 11/50
2257/2257 - 139s - loss: 3.1398 - accuracy1000: 0.4391 - val_loss: 3.2163 - val_accuracy1000: 0.4148 - 139s/epoch - 62ms/step
Epoch 12/50
2257/2257 - 138s - loss: 3.1313 - accuracy1000: 0.4472 - val_loss: 3.2496 - val_accuracy1000: 0.4053 - 138s/epoch - 61ms/step
testing model: results/AAL/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
7177/7177 - 204s - 204s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0753292
{'0': {'precision': 0.4024243850219805, 'recall': 0.9275625286674042, 'f1-score': 0.5613194781487759, 'support': 741260}, '1': {'precision': 0.21544401544401545, 'recall': 0.0006903206650831354, 'f1-score': 0.0013762316409959181, 'support': 404160}, '2': {'precision': 0.37294969230648317, 'recall': 0.06860651554428492, 'f1-score': 0.11589364347067917, 'support': 691669}, 'accuracy': 0.40025115821824636, 'macro avg': {'precision': 0.3302726975908264, 'recall': 0.33228645495892406, 'f1-score': 0.226196451086817, 'support': 1837089}, 'weighted avg': {'precision': 0.35019135907469884, 'recall': 0.40025115821824636, 'f1-score': 0.2704277988917836, 'support': 1837089}}
[[687565    513  53182]
 [377279    279  26602]
 [643713    503  47453]]
Evaluating performance on  train set...
2257/2257 - 57s - 57s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074516
{'0': {'precision': 0.3415962942701964, 'recall': 0.9226703783271304, 'f1-score': 0.4985985771845367, 'support': 198294}, '1': {'precision': 0.3123543123543124, 'recall': 0.0007158540298842347, 'f1-score': 0.0014284343719685746, 'support': 187189}, '2': {'precision': 0.3513467972943697, 'recall': 0.07598442413010432, 'f1-score': 0.12494703276478268, 'support': 192092}, 'accuracy': 0.34227589490542354, 'macro avg': {'precision': 0.33509913463962615, 'recall': 0.333123552162373, 'f1-score': 0.20832468144042934, 'support': 577575}, 'weighted avg': {'precision': 0.3353619805863754, 'recall': 0.34227589490542354, 'f1-score': 0.21319797235638244, 'support': 577575}}
[[182960    141  15193]
 [175301    134  11754]
 [177342    154  14596]]
Evaluating performance on  val set...
638/638 - 18s - 18s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0713612
{'0': {'precision': 0.40892036957914973, 'recall': 0.919259225909084, 'f1-score': 0.5660436640868661, 'support': 66633}, '1': {'precision': 0.17763157894736842, 'recall': 0.0007785018165042385, 'f1-score': 0.00155020956536717, 'support': 34682}, '2': {'precision': 0.38927077106993424, 'recall': 0.08401464209117443, 'f1-score': 0.13820178521691842, 'support': 62013}, 'accuracy': 0.40709492554858934, 'macro avg': {'precision': 0.32527423986548415, 'recall': 0.3346841232722542, 'f1-score': 0.23526521962305058, 'support': 163328}, 'weighted avg': {'precision': 0.35234655254200103, 'recall': 0.40709492554858934, 'f1-score': 0.28373125945277583, 'support': 163328}}
[[61253    53  5327]
 [31808    27  2847]
 [56731    72  5210]]
training model: results/AAL/W1/deepVOL_L3/h10
Epoch 1/50
2257/2257 - 207s - loss: 2.9057 - accuracy10: 0.4177 - val_loss: 2.5720 - val_accuracy10: 0.6619 - 207s/epoch - 92ms/step
Epoch 2/50
2257/2257 - 182s - loss: 2.5082 - accuracy10: 0.5591 - val_loss: 2.3987 - val_accuracy10: 0.6943 - 182s/epoch - 81ms/step
Epoch 3/50
2257/2257 - 183s - loss: 2.3290 - accuracy10: 0.6179 - val_loss: 2.4186 - val_accuracy10: 0.7593 - 183s/epoch - 81ms/step
Epoch 4/50
2257/2257 - 192s - loss: 2.2827 - accuracy10: 0.6326 - val_loss: 2.3369 - val_accuracy10: 0.7403 - 192s/epoch - 85ms/step
Epoch 5/50
2257/2257 - 184s - loss: 2.2429 - accuracy10: 0.6390 - val_loss: 2.4175 - val_accuracy10: 0.7375 - 184s/epoch - 82ms/step
Epoch 6/50
2257/2257 - 187s - loss: 2.2155 - accuracy10: 0.6451 - val_loss: 2.3728 - val_accuracy10: 0.7549 - 187s/epoch - 83ms/step
Epoch 7/50
2257/2257 - 190s - loss: 2.1979 - accuracy10: 0.6485 - val_loss: 2.3640 - val_accuracy10: 0.7352 - 190s/epoch - 84ms/step
Epoch 8/50
2257/2257 - 195s - loss: 2.1807 - accuracy10: 0.6522 - val_loss: 2.3458 - val_accuracy10: 0.7532 - 195s/epoch - 86ms/step
Epoch 9/50
2257/2257 - 192s - loss: 2.1641 - accuracy10: 0.6560 - val_loss: 2.3288 - val_accuracy10: 0.7480 - 192s/epoch - 85ms/step
Epoch 10/50
2257/2257 - 194s - loss: 2.1492 - accuracy10: 0.6586 - val_loss: 2.3071 - val_accuracy10: 0.7523 - 194s/epoch - 86ms/step
Epoch 11/50
2257/2257 - 197s - loss: 2.1374 - accuracy10: 0.6599 - val_loss: 2.3086 - val_accuracy10: 0.7514 - 197s/epoch - 87ms/step
Epoch 12/50
2257/2257 - 195s - loss: 2.1276 - accuracy10: 0.6611 - val_loss: 2.2999 - val_accuracy10: 0.7570 - 195s/epoch - 86ms/step
Epoch 13/50
2257/2257 - 196s - loss: 2.1194 - accuracy10: 0.6620 - val_loss: 2.3329 - val_accuracy10: 0.7649 - 196s/epoch - 87ms/step
Epoch 14/50
2257/2257 - 199s - loss: 2.1113 - accuracy10: 0.6637 - val_loss: 2.2507 - val_accuracy10: 0.7622 - 199s/epoch - 88ms/step
Epoch 15/50
2257/2257 - 194s - loss: 2.1040 - accuracy10: 0.6636 - val_loss: 2.3107 - val_accuracy10: 0.7614 - 194s/epoch - 86ms/step
Epoch 16/50
2257/2257 - 184s - loss: 2.0976 - accuracy10: 0.6654 - val_loss: 2.2721 - val_accuracy10: 0.7619 - 184s/epoch - 82ms/step
Epoch 17/50
2257/2257 - 191s - loss: 2.0907 - accuracy10: 0.6663 - val_loss: 2.2640 - val_accuracy10: 0.7579 - 191s/epoch - 85ms/step
Epoch 18/50
2257/2257 - 198s - loss: 2.0838 - accuracy10: 0.6668 - val_loss: 2.2814 - val_accuracy10: 0.7635 - 198s/epoch - 88ms/step
Epoch 19/50
2257/2257 - 192s - loss: 2.0796 - accuracy10: 0.6677 - val_loss: 2.2961 - val_accuracy10: 0.7673 - 192s/epoch - 85ms/step
Epoch 20/50
2257/2257 - 194s - loss: 2.0746 - accuracy10: 0.6683 - val_loss: 2.2922 - val_accuracy10: 0.7712 - 194s/epoch - 86ms/step
Epoch 21/50
2257/2257 - 191s - loss: 2.0677 - accuracy10: 0.6685 - val_loss: 2.2843 - val_accuracy10: 0.7636 - 191s/epoch - 84ms/step
Epoch 22/50
2257/2257 - 194s - loss: 2.0642 - accuracy10: 0.6694 - val_loss: 2.2416 - val_accuracy10: 0.7620 - 194s/epoch - 86ms/step
Epoch 23/50
2257/2257 - 199s - loss: 2.0600 - accuracy10: 0.6692 - val_loss: 2.2939 - val_accuracy10: 0.7691 - 199s/epoch - 88ms/step
Epoch 24/50
2257/2257 - 202s - loss: 2.0545 - accuracy10: 0.6709 - val_loss: 2.2695 - val_accuracy10: 0.7704 - 202s/epoch - 90ms/step
Epoch 25/50
2257/2257 - 198s - loss: 2.0500 - accuracy10: 0.6706 - val_loss: 2.2931 - val_accuracy10: 0.7624 - 198s/epoch - 88ms/step
Epoch 26/50
2257/2257 - 199s - loss: 2.0478 - accuracy10: 0.6704 - val_loss: 2.2652 - val_accuracy10: 0.7601 - 199s/epoch - 88ms/step
Epoch 27/50
2257/2257 - 204s - loss: 2.0415 - accuracy10: 0.6716 - val_loss: 2.2282 - val_accuracy10: 0.7668 - 204s/epoch - 90ms/step
Epoch 28/50
2257/2257 - 190s - loss: 2.0380 - accuracy10: 0.6715 - val_loss: 2.2480 - val_accuracy10: 0.7640 - 190s/epoch - 84ms/step
Epoch 29/50
2257/2257 - 196s - loss: 2.0337 - accuracy10: 0.6714 - val_loss: 2.2620 - val_accuracy10: 0.7642 - 196s/epoch - 87ms/step
Epoch 30/50
2257/2257 - 193s - loss: 2.0313 - accuracy10: 0.6726 - val_loss: 2.2528 - val_accuracy10: 0.7702 - 193s/epoch - 85ms/step
Epoch 31/50
2257/2257 - 195s - loss: 2.0275 - accuracy10: 0.6723 - val_loss: 2.2260 - val_accuracy10: 0.7670 - 195s/epoch - 86ms/step
Epoch 32/50
2257/2257 - 193s - loss: 2.0248 - accuracy10: 0.6722 - val_loss: 2.2211 - val_accuracy10: 0.7550 - 193s/epoch - 85ms/step
Epoch 33/50
2257/2257 - 191s - loss: 2.0206 - accuracy10: 0.6737 - val_loss: 2.2050 - val_accuracy10: 0.7461 - 191s/epoch - 84ms/step
Epoch 34/50
2257/2257 - 198s - loss: 2.0156 - accuracy10: 0.6733 - val_loss: 2.2306 - val_accuracy10: 0.7581 - 198s/epoch - 88ms/step
Epoch 35/50
2257/2257 - 197s - loss: 2.0140 - accuracy10: 0.6740 - val_loss: 2.2248 - val_accuracy10: 0.7481 - 197s/epoch - 87ms/step
Epoch 36/50
2257/2257 - 192s - loss: 2.0112 - accuracy10: 0.6745 - val_loss: 2.2970 - val_accuracy10: 0.7657 - 192s/epoch - 85ms/step
Epoch 37/50
2257/2257 - 191s - loss: 2.0067 - accuracy10: 0.6750 - val_loss: 2.2223 - val_accuracy10: 0.7527 - 191s/epoch - 85ms/step
Epoch 38/50
2257/2257 - 193s - loss: 2.0045 - accuracy10: 0.6747 - val_loss: 2.2329 - val_accuracy10: 0.7561 - 193s/epoch - 85ms/step
Epoch 39/50
2257/2257 - 190s - loss: 2.0027 - accuracy10: 0.6745 - val_loss: 2.2649 - val_accuracy10: 0.7566 - 190s/epoch - 84ms/step
Epoch 40/50
2257/2257 - 194s - loss: 1.9977 - accuracy10: 0.6753 - val_loss: 2.2363 - val_accuracy10: 0.7459 - 194s/epoch - 86ms/step
Epoch 41/50
2257/2257 - 194s - loss: 1.9937 - accuracy10: 0.6752 - val_loss: 2.2425 - val_accuracy10: 0.7537 - 194s/epoch - 86ms/step
Epoch 42/50
2257/2257 - 197s - loss: 1.9924 - accuracy10: 0.6756 - val_loss: 2.2306 - val_accuracy10: 0.7456 - 197s/epoch - 87ms/step
Epoch 43/50
2257/2257 - 199s - loss: 1.9884 - accuracy10: 0.6755 - val_loss: 2.2711 - val_accuracy10: 0.7494 - 199s/epoch - 88ms/step
testing model: results/AAL/W1/deepVOL_L3/h10
Evaluating performance on  test set...
7177/7177 - 303s - 303s/epoch - 42ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59373945
{'0': {'precision': 0.37978200653465854, 'recall': 0.6401777066779741, 'f1-score': 0.4767403473518014, 'support': 207533}, '1': {'precision': 0.9054975488480156, 'recall': 0.7815630065634106, 'f1-score': 0.8389780490610368, 'support': 1423193}, '2': {'precision': 0.4398980143707023, 'recall': 0.5518043447711072, 'f1-score': 0.48953727567209704, 'support': 206363}, 'accuracy': 0.7397817960915339, 'macro avg': {'precision': 0.5750591899177921, 'recall': 0.6578483526708306, 'f1-score': 0.6017518906949784, 'support': 1837089}, 'weighted avg': {'precision': 0.7938068031213471, 'recall': 0.7397817960915339, 'f1-score': 0.7588034231895169, 'support': 1837089}}
[[ 132858   53746   20929]
 [ 186819 1112315  124059]
 [  30150   62341  113872]]
Evaluating performance on  train set...
2257/2257 - 108s - 108s/epoch - 48ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6331459
{'0': {'precision': 0.3640438768037213, 'recall': 0.6718002792051564, 'f1-score': 0.4722038091559624, 'support': 67334}, '1': {'precision': 0.9127489488824961, 'recall': 0.7448808446183123, 'f1-score': 0.8203148985783947, 'support': 442993}, '2': {'precision': 0.4168282533388527, 'recall': 0.5689983345229598, 'f1-score': 0.4811689699835268, 'support': 67248}, 'accuracy': 0.7158827857853959, 'macro avg': {'precision': 0.5645403596750235, 'recall': 0.6618931527821429, 'f1-score': 0.5912292259059614, 'support': 577575}, 'weighted avg': {'precision': 0.7910397643484163, 'recall': 0.7158827857853959, 'f1-score': 0.7402446090033304, 'support': 577575}}
[[ 45235  14840   7259]
 [ 66741 329977  46275]
 [ 12281  16703  38264]]
Evaluating performance on  val set...
638/638 - 28s - 28s/epoch - 44ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5906928
{'0': {'precision': 0.39021877253837967, 'recall': 0.6396081963521729, 'f1-score': 0.4847166229389305, 'support': 17764}, '1': {'precision': 0.9136788847231828, 'recall': 0.7879924658609323, 'f1-score': 0.8461940399137, 'support': 127420}, '2': {'precision': 0.41761585591512806, 'recall': 0.5597442680776014, 'f1-score': 0.47834585403763275, 'support': 18144}, 'accuracy': 0.7464978448275862, 'macro avg': {'precision': 0.5738378377255636, 'recall': 0.6624483100969022, 'f1-score': 0.6030855056300877, 'support': 163328}, 'weighted avg': {'precision': 0.8016386158927056, 'recall': 0.7464978448275862, 'f1-score': 0.7660147545512688, 'support': 163328}}
[[ 11362   4264   2138]
 [ 14989 100406  12025]
 [  2766   5222  10156]]
training model: results/AAL/W1/deepVOL_L3/h20
Epoch 1/50
2257/2257 - 203s - loss: 3.0289 - accuracy20: 0.3913 - val_loss: 3.1695 - val_accuracy20: 0.6678 - 203s/epoch - 90ms/step
Epoch 2/50
2257/2257 - 199s - loss: 2.8862 - accuracy20: 0.3611 - val_loss: 3.0688 - val_accuracy20: 0.6582 - 199s/epoch - 88ms/step
Epoch 3/50
2257/2257 - 201s - loss: 2.7285 - accuracy20: 0.4552 - val_loss: 2.5425 - val_accuracy20: 0.6776 - 201s/epoch - 89ms/step
Epoch 4/50
2257/2257 - 189s - loss: 2.4882 - accuracy20: 0.5853 - val_loss: 2.4738 - val_accuracy20: 0.6969 - 189s/epoch - 84ms/step
Epoch 5/50
2257/2257 - 189s - loss: 2.4112 - accuracy20: 0.6088 - val_loss: 2.5147 - val_accuracy20: 0.7175 - 189s/epoch - 84ms/step
Epoch 6/50
2257/2257 - 197s - loss: 2.3621 - accuracy20: 0.6195 - val_loss: 2.5202 - val_accuracy20: 0.7262 - 197s/epoch - 87ms/step
Epoch 7/50
2257/2257 - 191s - loss: 2.3303 - accuracy20: 0.6266 - val_loss: 2.5265 - val_accuracy20: 0.7416 - 191s/epoch - 85ms/step
Epoch 8/50
2257/2257 - 197s - loss: 2.3068 - accuracy20: 0.6317 - val_loss: 2.4803 - val_accuracy20: 0.7297 - 197s/epoch - 87ms/step
Epoch 9/50
2257/2257 - 190s - loss: 2.2869 - accuracy20: 0.6356 - val_loss: 2.4244 - val_accuracy20: 0.7333 - 190s/epoch - 84ms/step
Epoch 10/50
2257/2257 - 191s - loss: 2.2729 - accuracy20: 0.6377 - val_loss: 2.4099 - val_accuracy20: 0.7259 - 191s/epoch - 85ms/step
Epoch 11/50
2257/2257 - 193s - loss: 2.2580 - accuracy20: 0.6402 - val_loss: 2.4082 - val_accuracy20: 0.7323 - 193s/epoch - 85ms/step
Epoch 12/50
2257/2257 - 196s - loss: 2.2476 - accuracy20: 0.6428 - val_loss: 2.3755 - val_accuracy20: 0.7276 - 196s/epoch - 87ms/step
Epoch 13/50
2257/2257 - 183s - loss: 2.2384 - accuracy20: 0.6436 - val_loss: 2.3970 - val_accuracy20: 0.7298 - 183s/epoch - 81ms/step
Epoch 14/50
2257/2257 - 196s - loss: 2.2296 - accuracy20: 0.6448 - val_loss: 2.4137 - val_accuracy20: 0.7300 - 196s/epoch - 87ms/step
Epoch 15/50
2257/2257 - 194s - loss: 2.2217 - accuracy20: 0.6467 - val_loss: 2.3768 - val_accuracy20: 0.7261 - 194s/epoch - 86ms/step
Epoch 16/50
2257/2257 - 200s - loss: 2.2150 - accuracy20: 0.6477 - val_loss: 2.3838 - val_accuracy20: 0.7300 - 200s/epoch - 89ms/step
Epoch 17/50
2257/2257 - 192s - loss: 2.2087 - accuracy20: 0.6480 - val_loss: 2.3801 - val_accuracy20: 0.7313 - 192s/epoch - 85ms/step
Epoch 18/50
2257/2257 - 195s - loss: 2.2028 - accuracy20: 0.6495 - val_loss: 2.3983 - val_accuracy20: 0.7309 - 195s/epoch - 86ms/step
Epoch 19/50
2257/2257 - 197s - loss: 2.1977 - accuracy20: 0.6501 - val_loss: 2.3516 - val_accuracy20: 0.7289 - 197s/epoch - 87ms/step
Epoch 20/50
2257/2257 - 200s - loss: 2.1929 - accuracy20: 0.6512 - val_loss: 2.3985 - val_accuracy20: 0.7329 - 200s/epoch - 89ms/step
Epoch 21/50
2257/2257 - 197s - loss: 2.1866 - accuracy20: 0.6517 - val_loss: 2.3463 - val_accuracy20: 0.7274 - 197s/epoch - 87ms/step
Epoch 22/50
2257/2257 - 192s - loss: 2.1832 - accuracy20: 0.6526 - val_loss: 2.3970 - val_accuracy20: 0.7236 - 192s/epoch - 85ms/step
Epoch 23/50
2257/2257 - 196s - loss: 2.1793 - accuracy20: 0.6524 - val_loss: 2.3142 - val_accuracy20: 0.7215 - 196s/epoch - 87ms/step
Epoch 24/50
2257/2257 - 194s - loss: 2.1752 - accuracy20: 0.6527 - val_loss: 2.3280 - val_accuracy20: 0.7178 - 194s/epoch - 86ms/step
Epoch 25/50
2257/2257 - 192s - loss: 2.1722 - accuracy20: 0.6530 - val_loss: 2.3617 - val_accuracy20: 0.7183 - 192s/epoch - 85ms/step
Epoch 26/50
2257/2257 - 200s - loss: 2.1668 - accuracy20: 0.6538 - val_loss: 2.3778 - val_accuracy20: 0.7014 - 200s/epoch - 89ms/step
Epoch 27/50
2257/2257 - 195s - loss: 2.1630 - accuracy20: 0.6547 - val_loss: 2.3486 - val_accuracy20: 0.6999 - 195s/epoch - 86ms/step
Epoch 28/50
2257/2257 - 201s - loss: 2.1592 - accuracy20: 0.6547 - val_loss: 2.3181 - val_accuracy20: 0.7051 - 201s/epoch - 89ms/step
Epoch 29/50
2257/2257 - 194s - loss: 2.1552 - accuracy20: 0.6557 - val_loss: 2.3206 - val_accuracy20: 0.6985 - 194s/epoch - 86ms/step
Epoch 30/50
2257/2257 - 202s - loss: 2.1531 - accuracy20: 0.6556 - val_loss: 2.3723 - val_accuracy20: 0.7023 - 202s/epoch - 90ms/step
Epoch 31/50
2257/2257 - 194s - loss: 2.1487 - accuracy20: 0.6562 - val_loss: 2.3536 - val_accuracy20: 0.6884 - 194s/epoch - 86ms/step
Epoch 32/50
2257/2257 - 197s - loss: 2.1456 - accuracy20: 0.6562 - val_loss: 2.3619 - val_accuracy20: 0.6796 - 197s/epoch - 87ms/step
Epoch 33/50
2257/2257 - 199s - loss: 2.1429 - accuracy20: 0.6572 - val_loss: 2.3152 - val_accuracy20: 0.6755 - 199s/epoch - 88ms/step
testing model: results/AAL/W1/deepVOL_L3/h20
Evaluating performance on  test set...
7177/7177 - 315s - 315s/epoch - 44ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67250824
{'0': {'precision': 0.4248949999394812, 'recall': 0.6183204224483829, 'f1-score': 0.5036759430903174, 'support': 283869}, '1': {'precision': 0.8351469761083427, 'recall': 0.780473029671604, 'f1-score': 0.8068848966124226, 'support': 1272732}, '2': {'precision': 0.5234479906898625, 'recall': 0.43777986937052565, 'f1-score': 0.4767964028260182, 'support': 280488}, 'accuracy': 0.7030944064223345, 'macro avg': {'precision': 0.5944966555792287, 'recall': 0.6121911071635042, 'f1-score': 0.595785747509586, 'support': 1837089}, 'weighted avg': {'precision': 0.7241639789616954, 'recall': 0.7030944064223345, 'f1-score': 0.7096345816453592, 'support': 1837089}}
[[175522  87944  20403]
 [188011 993333  91388]
 [ 49562 108134 122792]]
Evaluating performance on  train set...
2257/2257 - 98s - 98s/epoch - 43ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69239616
{'0': {'precision': 0.41081674673987645, 'recall': 0.6563589709849332, 'f1-score': 0.5053399410706899, 'support': 91194}, '1': {'precision': 0.8488886352612206, 'recall': 0.7508271439495461, 'f1-score': 0.7968523381808003, 'support': 396243}, '2': {'precision': 0.4984337571402248, 'recall': 0.4501431138920322, 'f1-score': 0.4730592329619978, 'support': 90138}, 'accuracy': 0.6889858459940268, 'macro avg': {'precision': 0.5860463797137739, 'recall': 0.6191097429421705, 'f1-score': 0.5917505040711627, 'support': 577575}, 'weighted avg': {'precision': 0.7250279598409103, 'recall': 0.6889858459940268, 'f1-score': 0.7002930264718934, 'support': 577575}}
[[ 59856  23602   7736]
 [ 65639 297510  33094]
 [ 20205  29358  40575]]
Evaluating performance on  val set...
638/638 - 29s - 29s/epoch - 46ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6506349
{'0': {'precision': 0.442674973797601, 'recall': 0.6268810554524841, 'f1-score': 0.5189154138866612, 'support': 24255}, '1': {'precision': 0.8535653176610624, 'recall': 0.8001551685060236, 'f1-score': 0.8259977502812149, 'support': 114714}, '2': {'precision': 0.503917179630666, 'recall': 0.4436142698797159, 'f1-score': 0.4718468222605506, 'support': 24359}, 'accuracy': 0.721248040752351, 'macro avg': {'precision': 0.6000524903631098, 'recall': 0.6235501646127412, 'f1-score': 0.6055866621428089, 'support': 163328}, 'weighted avg': {'precision': 0.7403990247738006, 'recall': 0.721248040752351, 'f1-score': 0.7275758965579999, 'support': 163328}}
[[15205  6902  2148]
 [14435 91789  8490]
 [ 4708  8845 10806]]
training model: results/AAL/W1/deepVOL_L3/h30
Epoch 1/50
2257/2257 - 211s - loss: 3.0475 - accuracy30: 0.4112 - val_loss: 3.1205 - val_accuracy30: 0.6142 - 211s/epoch - 94ms/step
Epoch 2/50
2257/2257 - 196s - loss: 2.9135 - accuracy30: 0.4196 - val_loss: 2.9587 - val_accuracy30: 0.6323 - 196s/epoch - 87ms/step
Epoch 3/50
2257/2257 - 199s - loss: 2.6881 - accuracy30: 0.5435 - val_loss: 2.6389 - val_accuracy30: 0.6572 - 199s/epoch - 88ms/step
Epoch 4/50
2257/2257 - 200s - loss: 2.5531 - accuracy30: 0.5935 - val_loss: 2.6593 - val_accuracy30: 0.6687 - 200s/epoch - 89ms/step
Epoch 5/50
2257/2257 - 200s - loss: 2.4941 - accuracy30: 0.6038 - val_loss: 2.6209 - val_accuracy30: 0.6710 - 200s/epoch - 89ms/step
Epoch 6/50
2257/2257 - 197s - loss: 2.4583 - accuracy30: 0.6113 - val_loss: 2.6470 - val_accuracy30: 0.6859 - 197s/epoch - 87ms/step
Epoch 7/50
2257/2257 - 183s - loss: 2.4326 - accuracy30: 0.6141 - val_loss: 2.6557 - val_accuracy30: 0.6832 - 183s/epoch - 81ms/step
Epoch 8/50
2257/2257 - 171s - loss: 2.4116 - accuracy30: 0.6162 - val_loss: 2.6656 - val_accuracy30: 0.6780 - 171s/epoch - 76ms/step
Epoch 9/50
2257/2257 - 186s - loss: 2.3943 - accuracy30: 0.6182 - val_loss: 2.6531 - val_accuracy30: 0.6709 - 186s/epoch - 82ms/step
Epoch 10/50
2257/2257 - 192s - loss: 2.3808 - accuracy30: 0.6202 - val_loss: 2.5971 - val_accuracy30: 0.6720 - 192s/epoch - 85ms/step
Epoch 11/50
2257/2257 - 193s - loss: 2.3672 - accuracy30: 0.6225 - val_loss: 2.6363 - val_accuracy30: 0.6867 - 193s/epoch - 85ms/step
Epoch 12/50
2257/2257 - 200s - loss: 2.3586 - accuracy30: 0.6226 - val_loss: 2.6012 - val_accuracy30: 0.6843 - 200s/epoch - 89ms/step
Epoch 13/50
2257/2257 - 195s - loss: 2.3478 - accuracy30: 0.6252 - val_loss: 2.6034 - val_accuracy30: 0.6856 - 195s/epoch - 87ms/step
Epoch 14/50
2257/2257 - 197s - loss: 2.3408 - accuracy30: 0.6264 - val_loss: 2.5754 - val_accuracy30: 0.6926 - 197s/epoch - 87ms/step
Epoch 15/50
2257/2257 - 189s - loss: 2.3323 - accuracy30: 0.6275 - val_loss: 2.5928 - val_accuracy30: 0.6875 - 189s/epoch - 84ms/step
Epoch 16/50
2257/2257 - 176s - loss: 2.3277 - accuracy30: 0.6284 - val_loss: 2.5766 - val_accuracy30: 0.6981 - 176s/epoch - 78ms/step
Epoch 17/50
2257/2257 - 183s - loss: 2.3198 - accuracy30: 0.6296 - val_loss: 2.5556 - val_accuracy30: 0.6968 - 183s/epoch - 81ms/step
Epoch 18/50
2257/2257 - 183s - loss: 2.3152 - accuracy30: 0.6305 - val_loss: 2.5541 - val_accuracy30: 0.6941 - 183s/epoch - 81ms/step
Epoch 19/50
2257/2257 - 193s - loss: 2.3085 - accuracy30: 0.6313 - val_loss: 2.5298 - val_accuracy30: 0.6998 - 193s/epoch - 85ms/step
Epoch 20/50
2257/2257 - 202s - loss: 2.3040 - accuracy30: 0.6323 - val_loss: 2.5428 - val_accuracy30: 0.6934 - 202s/epoch - 90ms/step
Epoch 21/50
2257/2257 - 185s - loss: 2.2982 - accuracy30: 0.6325 - val_loss: 2.5492 - val_accuracy30: 0.6940 - 185s/epoch - 82ms/step
Epoch 22/50
2257/2257 - 184s - loss: 2.2943 - accuracy30: 0.6329 - val_loss: 2.5548 - val_accuracy30: 0.6893 - 184s/epoch - 82ms/step
Epoch 23/50
2257/2257 - 187s - loss: 2.2899 - accuracy30: 0.6337 - val_loss: 2.5459 - val_accuracy30: 0.6923 - 187s/epoch - 83ms/step
Epoch 24/50
2257/2257 - 200s - loss: 2.2870 - accuracy30: 0.6341 - val_loss: 2.5673 - val_accuracy30: 0.6878 - 200s/epoch - 88ms/step
Epoch 25/50
2257/2257 - 177s - loss: 2.2824 - accuracy30: 0.6349 - val_loss: 2.5452 - val_accuracy30: 0.6923 - 177s/epoch - 78ms/step
Epoch 26/50
2257/2257 - 201s - loss: 2.2775 - accuracy30: 0.6358 - val_loss: 2.5464 - val_accuracy30: 0.6849 - 201s/epoch - 89ms/step
Epoch 27/50
2257/2257 - 190s - loss: 2.2734 - accuracy30: 0.6357 - val_loss: 2.5485 - val_accuracy30: 0.6866 - 190s/epoch - 84ms/step
Epoch 28/50
2257/2257 - 202s - loss: 2.2708 - accuracy30: 0.6364 - val_loss: 2.5247 - val_accuracy30: 0.6918 - 202s/epoch - 89ms/step
Epoch 29/50
2257/2257 - 177s - loss: 2.2669 - accuracy30: 0.6366 - val_loss: 2.5545 - val_accuracy30: 0.6836 - 177s/epoch - 78ms/step
Epoch 30/50
2257/2257 - 190s - loss: 2.2634 - accuracy30: 0.6368 - val_loss: 2.5115 - val_accuracy30: 0.6884 - 190s/epoch - 84ms/step
Epoch 31/50
2257/2257 - 184s - loss: 2.2601 - accuracy30: 0.6373 - val_loss: 2.5246 - val_accuracy30: 0.6927 - 184s/epoch - 81ms/step
Epoch 32/50
2257/2257 - 202s - loss: 2.2571 - accuracy30: 0.6379 - val_loss: 2.4943 - val_accuracy30: 0.6777 - 202s/epoch - 89ms/step
Epoch 33/50
2257/2257 - 184s - loss: 2.2547 - accuracy30: 0.6386 - val_loss: 2.5064 - val_accuracy30: 0.6837 - 184s/epoch - 82ms/step
Epoch 34/50
2257/2257 - 203s - loss: 2.2508 - accuracy30: 0.6389 - val_loss: 2.5303 - val_accuracy30: 0.6836 - 203s/epoch - 90ms/step
Epoch 35/50
2257/2257 - 179s - loss: 2.2485 - accuracy30: 0.6390 - val_loss: 2.5537 - val_accuracy30: 0.6887 - 179s/epoch - 79ms/step
Epoch 36/50
2257/2257 - 193s - loss: 2.2444 - accuracy30: 0.6392 - val_loss: 2.5331 - val_accuracy30: 0.6790 - 193s/epoch - 85ms/step
Epoch 37/50
2257/2257 - 180s - loss: 2.2419 - accuracy30: 0.6397 - val_loss: 2.5304 - val_accuracy30: 0.6779 - 180s/epoch - 80ms/step
Epoch 38/50
2257/2257 - 198s - loss: 2.2375 - accuracy30: 0.6404 - val_loss: 2.5369 - val_accuracy30: 0.6797 - 198s/epoch - 88ms/step
Epoch 39/50
2257/2257 - 183s - loss: 2.2349 - accuracy30: 0.6405 - val_loss: 2.5251 - val_accuracy30: 0.6838 - 183s/epoch - 81ms/step
Epoch 40/50
2257/2257 - 194s - loss: 2.2309 - accuracy30: 0.6410 - val_loss: 2.5398 - val_accuracy30: 0.6784 - 194s/epoch - 86ms/step
Epoch 41/50
2257/2257 - 196s - loss: 2.2286 - accuracy30: 0.6411 - val_loss: 2.5416 - val_accuracy30: 0.6747 - 196s/epoch - 87ms/step
Epoch 42/50
2257/2257 - 196s - loss: 2.2267 - accuracy30: 0.6413 - val_loss: 2.4965 - val_accuracy30: 0.6802 - 196s/epoch - 87ms/step
testing model: results/AAL/W1/deepVOL_L3/h30
Evaluating performance on  test set...
7177/7177 - 257s - 257s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7612024
{'0': {'precision': 0.44323342415985467, 'recall': 0.5991913722990928, 'f1-score': 0.5095459059940508, 'support': 342061}, '1': {'precision': 0.7801400506270876, 'recall': 0.7378949849634382, 'f1-score': 0.7584297034395053, 'support': 1158177}, '2': {'precision': 0.5354717629867339, 'recall': 0.4438401548459111, 'f1-score': 0.48536909614176565, 'support': 336851}, 'accuracy': 0.6581504761064924, 'macro avg': {'precision': 0.5862817459245587, 'recall': 0.593642170702814, 'f1-score': 0.5844482351917739, 'support': 1837089}, 'weighted avg': {'precision': 0.6725462569045468, 'recall': 0.6581504761064924, 'f1-score': 0.6620194700393595, 'support': 1837089}}
[[204960 112840  24261]
 [198125 854613 105439]
 [ 59335 128008 149508]]
Evaluating performance on  train set...
2257/2257 - 70s - 70s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7632929
{'0': {'precision': 0.4441671785421785, 'recall': 0.6407716804356856, 'f1-score': 0.5246558311257903, 'support': 108335}, '1': {'precision': 0.803955053955054, 'recall': 0.7164531346065303, 'f1-score': 0.7576861566811138, 'support': 362709}, '2': {'precision': 0.5122431288562541, 'recall': 0.47148717274783863, 'f1-score': 0.4910208909700565, 'support': 106531}, 'accuracy': 0.6570748387655283, 'macro avg': {'precision': 0.5867884537844955, 'recall': 0.6095706625966849, 'f1-score': 0.5911209595923202, 'support': 577575}, 'weighted avg': {'precision': 0.6826652083496276, 'recall': 0.6570748387655283, 'f1-score': 0.6647918005533372, 'support': 577575}}
[[ 69418  29794   9123]
 [ 64141 259864  38704]
 [ 22729  33574  50228]]
Evaluating performance on  val set...
638/638 - 24s - 24s/epoch - 38ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73142546
{'0': {'precision': 0.4591194968553459, 'recall': 0.6086700802657071, 'f1-score': 0.5234220430507416, 'support': 28904}, '1': {'precision': 0.8092440464734661, 'recall': 0.7572391306408348, 'f1-score': 0.7823783455583521, 'support': 105503}, '2': {'precision': 0.5053260290649014, 'recall': 0.4592856401922478, 'f1-score': 0.4812070933033854, 'support': 28921}, 'accuracy': 0.6781874510188087, 'macro avg': {'precision': 0.5912298574645711, 'recall': 0.6083982836995966, 'f1-score': 0.595669160637493, 'support': 163328}, 'weighted avg': {'precision': 0.693467125408889, 'recall': 0.6781874510188087, 'f1-score': 0.683221760317941, 'support': 163328}}
[[17593  8748  2563]
 [15172 79891 10440]
 [ 5554 10084 13283]]
training model: results/AAL/W1/deepVOL_L3/h50
Epoch 1/50
2257/2257 - 203s - loss: 3.1041 - accuracy50: 0.4231 - val_loss: 3.1710 - val_accuracy50: 0.5220 - 203s/epoch - 90ms/step
Epoch 2/50
2257/2257 - 191s - loss: 2.9241 - accuracy50: 0.4820 - val_loss: 2.8359 - val_accuracy50: 0.5856 - 191s/epoch - 84ms/step
Epoch 3/50
2257/2257 - 186s - loss: 2.7537 - accuracy50: 0.5487 - val_loss: 2.8297 - val_accuracy50: 0.5936 - 186s/epoch - 82ms/step
Epoch 4/50
2257/2257 - 191s - loss: 2.6720 - accuracy50: 0.5695 - val_loss: 2.8434 - val_accuracy50: 0.6266 - 191s/epoch - 84ms/step
Epoch 5/50
2257/2257 - 191s - loss: 2.6305 - accuracy50: 0.5794 - val_loss: 2.7909 - val_accuracy50: 0.6332 - 191s/epoch - 85ms/step
Epoch 6/50
2257/2257 - 186s - loss: 2.6065 - accuracy50: 0.5856 - val_loss: 2.7714 - val_accuracy50: 0.6341 - 186s/epoch - 82ms/step
Epoch 7/50
2257/2257 - 183s - loss: 2.5951 - accuracy50: 0.5870 - val_loss: 2.7309 - val_accuracy50: 0.6330 - 183s/epoch - 81ms/step
Epoch 8/50
2257/2257 - 184s - loss: 2.5812 - accuracy50: 0.5897 - val_loss: 2.7591 - val_accuracy50: 0.6335 - 184s/epoch - 81ms/step
Epoch 9/50
2257/2257 - 187s - loss: 2.5683 - accuracy50: 0.5919 - val_loss: 2.7862 - val_accuracy50: 0.6337 - 187s/epoch - 83ms/step
Epoch 10/50
2257/2257 - 191s - loss: 2.5598 - accuracy50: 0.5932 - val_loss: 2.8072 - val_accuracy50: 0.6351 - 191s/epoch - 85ms/step
Epoch 11/50
2257/2257 - 200s - loss: 2.5473 - accuracy50: 0.5953 - val_loss: 2.8190 - val_accuracy50: 0.6372 - 200s/epoch - 88ms/step
Epoch 12/50
2257/2257 - 196s - loss: 2.5360 - accuracy50: 0.5969 - val_loss: 2.8071 - val_accuracy50: 0.6383 - 196s/epoch - 87ms/step
Epoch 13/50
2257/2257 - 191s - loss: 2.5248 - accuracy50: 0.5980 - val_loss: 2.7954 - val_accuracy50: 0.6403 - 191s/epoch - 85ms/step
Epoch 14/50
2257/2257 - 193s - loss: 2.5163 - accuracy50: 0.5990 - val_loss: 2.8204 - val_accuracy50: 0.6417 - 193s/epoch - 86ms/step
Epoch 15/50
2257/2257 - 195s - loss: 2.5101 - accuracy50: 0.5999 - val_loss: 2.8193 - val_accuracy50: 0.6420 - 195s/epoch - 87ms/step
Epoch 16/50
2257/2257 - 187s - loss: 2.5046 - accuracy50: 0.6007 - val_loss: 2.7739 - val_accuracy50: 0.6450 - 187s/epoch - 83ms/step
Epoch 17/50
2257/2257 - 197s - loss: 2.4996 - accuracy50: 0.6010 - val_loss: 2.7716 - val_accuracy50: 0.6436 - 197s/epoch - 87ms/step
testing model: results/AAL/W1/deepVOL_L3/h50
Evaluating performance on  test set...
7177/7177 - 314s - 314s/epoch - 44ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86557645
{'0': {'precision': 0.5302788728659257, 'recall': 0.3765115157638522, 'f1-score': 0.44035778213748106, 'support': 435490}, '1': {'precision': 0.6358673787214162, 'recall': 0.804090931003747, 'f1-score': 0.7101527719210201, 'support': 974937}, '2': {'precision': 0.5398249586463107, 'recall': 0.3732626763105221, 'f1-score': 0.4413519602925405, 'support': 426662}, 'accuracy': 0.6026719445818901, 'macro avg': {'precision': 0.5686570700778842, 'recall': 0.5179550410260405, 'f1-score': 0.5306208381170139, 'support': 1837089}, 'weighted avg': {'precision': 0.5885314089077097, 'recall': 0.6026719445818901, 'f1-score': 0.5837679794630262, 'support': 1837089}}
[[163967 234044  37479]
 [ 92719 783938  98280]
 [ 52523 214882 159257]]
Evaluating performance on  train set...
2257/2257 - 102s - 102s/epoch - 45ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8416206
{'0': {'precision': 0.5227589681761334, 'recall': 0.43121145325406895, 'f1-score': 0.472592544391212, 'support': 134739}, '1': {'precision': 0.6702437125239559, 'recall': 0.7856610274078264, 'f1-score': 0.7233774976512276, 'support': 311152}, '2': {'precision': 0.5269668334988544, 'recall': 0.40697427174144163, 'f1-score': 0.45926224275118577, 'support': 131684}, 'accuracy': 0.616635069038653, 'macro avg': {'precision': 0.573323171399648, 'recall': 0.5412822508011123, 'f1-score': 0.5517440949312085, 'support': 577575}, 'weighted avg': {'precision': 0.6031715236199647, 'recall': 0.616635069038653, 'f1-score': 0.6046565228106296, 'support': 577575}}
[[ 58101  62488  14150]
 [ 32735 244460  33957]
 [ 20307  57785  53592]]
Evaluating performance on  val set...
638/638 - 30s - 30s/epoch - 46ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8193271
{'0': {'precision': 0.5478471661087383, 'recall': 0.3948857333037497, 'f1-score': 0.4589572084777178, 'support': 36056}, '1': {'precision': 0.6827029448604368, 'recall': 0.8165246962854424, 'f1-score': 0.7436413249148525, 'support': 91451}, '2': {'precision': 0.5155925899434948, 'recall': 0.4024734094525558, 'f1-score': 0.45206402960036374, 'support': 35821}, 'accuracy': 0.6326349431818182, 'macro avg': {'precision': 0.58204756697089, 'recall': 0.5379612796805826, 'f1-score': 0.5515541876643113, 'support': 163328}, 'weighted avg': {'precision': 0.616281878159375, 'recall': 0.6326349431818182, 'f1-score': 0.6168464042783564, 'support': 163328}}
[[14238 18078  3740]
 [ 6974 74672  9805]
 [ 4777 16627 14417]]
training model: results/AAL/W1/deepVOL_L3/h100
Epoch 1/50
2257/2257 - 194s - loss: 3.1975 - accuracy100: 0.4264 - val_loss: 3.3634 - val_accuracy100: 0.4197 - 194s/epoch - 86ms/step
Epoch 2/50
2257/2257 - 186s - loss: 3.1439 - accuracy100: 0.4260 - val_loss: 3.3567 - val_accuracy100: 0.4218 - 186s/epoch - 82ms/step
Epoch 3/50
2257/2257 - 192s - loss: 3.0479 - accuracy100: 0.4751 - val_loss: 3.0805 - val_accuracy100: 0.4981 - 192s/epoch - 85ms/step
Epoch 4/50
2257/2257 - 196s - loss: 2.9604 - accuracy100: 0.5078 - val_loss: 3.0242 - val_accuracy100: 0.5064 - 196s/epoch - 87ms/step
Epoch 5/50
2257/2257 - 192s - loss: 2.9076 - accuracy100: 0.5196 - val_loss: 3.0321 - val_accuracy100: 0.5151 - 192s/epoch - 85ms/step
Epoch 6/50
2257/2257 - 186s - loss: 2.8747 - accuracy100: 0.5254 - val_loss: 3.0310 - val_accuracy100: 0.5160 - 186s/epoch - 83ms/step
Epoch 7/50
2257/2257 - 181s - loss: 2.8549 - accuracy100: 0.5293 - val_loss: 3.0216 - val_accuracy100: 0.5156 - 181s/epoch - 80ms/step
Epoch 8/50
2257/2257 - 193s - loss: 2.8428 - accuracy100: 0.5315 - val_loss: 3.0384 - val_accuracy100: 0.5157 - 193s/epoch - 85ms/step
Epoch 9/50
2257/2257 - 188s - loss: 2.8340 - accuracy100: 0.5322 - val_loss: 3.0250 - val_accuracy100: 0.5195 - 188s/epoch - 83ms/step
Epoch 10/50
2257/2257 - 178s - loss: 2.8260 - accuracy100: 0.5343 - val_loss: 3.0133 - val_accuracy100: 0.5187 - 178s/epoch - 79ms/step
Epoch 11/50
2257/2257 - 196s - loss: 2.8205 - accuracy100: 0.5347 - val_loss: 3.0061 - val_accuracy100: 0.5202 - 196s/epoch - 87ms/step
Epoch 12/50
2257/2257 - 188s - loss: 2.8149 - accuracy100: 0.5364 - val_loss: 3.0145 - val_accuracy100: 0.5195 - 188s/epoch - 83ms/step
Epoch 13/50
2257/2257 - 190s - loss: 2.8087 - accuracy100: 0.5377 - val_loss: 3.0168 - val_accuracy100: 0.5201 - 190s/epoch - 84ms/step
Epoch 14/50
2257/2257 - 166s - loss: 2.8042 - accuracy100: 0.5391 - val_loss: 3.0162 - val_accuracy100: 0.5178 - 166s/epoch - 74ms/step
Epoch 15/50
2257/2257 - 149s - loss: 2.7993 - accuracy100: 0.5397 - val_loss: 3.0468 - val_accuracy100: 0.5137 - 149s/epoch - 66ms/step
Epoch 16/50
2257/2257 - 178s - loss: 2.7957 - accuracy100: 0.5408 - val_loss: 3.0193 - val_accuracy100: 0.5127 - 178s/epoch - 79ms/step
Epoch 17/50
2257/2257 - 197s - loss: 2.7907 - accuracy100: 0.5411 - val_loss: 3.0334 - val_accuracy100: 0.5121 - 197s/epoch - 87ms/step
Epoch 18/50
2257/2257 - 195s - loss: 2.7874 - accuracy100: 0.5425 - val_loss: 3.0359 - val_accuracy100: 0.5169 - 195s/epoch - 86ms/step
Epoch 19/50
2257/2257 - 196s - loss: 2.7822 - accuracy100: 0.5431 - val_loss: 3.0221 - val_accuracy100: 0.5147 - 196s/epoch - 87ms/step
Epoch 20/50
2257/2257 - 196s - loss: 2.7775 - accuracy100: 0.5446 - val_loss: 3.0369 - val_accuracy100: 0.5159 - 196s/epoch - 87ms/step
Epoch 21/50
2257/2257 - 198s - loss: 2.7733 - accuracy100: 0.5453 - val_loss: 3.0708 - val_accuracy100: 0.5104 - 198s/epoch - 88ms/step
testing model: results/AAL/W1/deepVOL_L3/h100
Evaluating performance on  test set...
7177/7177 - 272s - 272s/epoch - 38ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0288736
{'0': {'precision': 0.5277202655071415, 'recall': 0.31253912965275354, 'f1-score': 0.39257694333863763, 'support': 578206}, '1': {'precision': 0.4458870838815992, 'recall': 0.7833039525760012, 'f1-score': 0.5682845137133266, 'support': 694332}, '2': {'precision': 0.5533349096927918, 'recall': 0.26943358527396105, 'f1-score': 0.3624032993188364, 'support': 564551}, 'accuracy': 0.4772191222091036, 'macro avg': {'precision': 0.5089807530271775, 'recall': 0.4550922225009053, 'f1-score': 0.4410882521236002, 'support': 1837089}, 'weighted avg': {'precision': 0.5046627959589743, 'recall': 0.4772191222091036, 'f1-score': 0.4497134390927223, 'support': 1837089}}
[[180712 337373  60121]
 [ 87794 543873  62665]
 [ 73933 338509 152109]]
Evaluating performance on  train set...
2257/2257 - 95s - 95s/epoch - 42ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.979801
{'0': {'precision': 0.533885099752216, 'recall': 0.35787875501572497, 'f1-score': 0.4285128485511208, 'support': 175199}, '1': {'precision': 0.4944128482231299, 'recall': 0.7692107894702667, 'f1-score': 0.6019319138413174, 'support': 231003}, '2': {'precision': 0.5496833369731382, 'recall': 0.32311974465055754, 'f1-score': 0.4069956745592791, 'support': 171373}, 'accuracy': 0.5120789507856123, 'macro avg': {'precision': 0.5259937616494947, 'recall': 0.48340309637884976, 'f1-score': 0.4791468123172391, 'support': 577575}, 'weighted avg': {'precision': 0.5227855590644916, 'recall': 0.5120789507856123, 'f1-score': 0.49148798023224866, 'support': 577575}}
[[ 62700  90255  22244]
 [ 30193 177690  23120]
 [ 24548  91451  55374]]
Evaluating performance on  val set...
638/638 - 29s - 29s/epoch - 45ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97388786
{'0': {'precision': 0.533749384135326, 'recall': 0.3401716558509525, 'f1-score': 0.41552131944000514, 'support': 47770}, '1': {'precision': 0.5107315684600057, 'recall': 0.785173515382259, 'f1-score': 0.6188923957848261, 'support': 68553}, '2': {'precision': 0.5400283708580366, 'recall': 0.31586001489203275, 'f1-score': 0.3985878815538672, 'support': 47005}, 'accuracy': 0.5199537127742947, 'macro avg': {'precision': 0.5281697744844561, 'recall': 0.48040172870841474, 'f1-score': 0.4776671989262328, 'support': 163328}, 'weighted avg': {'precision': 0.5258952712637472, 'recall': 0.5199537127742947, 'f1-score': 0.4960080770616537, 'support': 163328}}
[[16250 25766  5754]
 [ 7835 53826  6892]
 [ 6360 25798 14847]]
training model: results/AAL/W1/deepVOL_L3/h200
Epoch 1/50
2257/2257 - 205s - loss: 3.2679 - accuracy200: 0.3889 - val_loss: 3.3510 - val_accuracy200: 0.3250 - 205s/epoch - 91ms/step
Epoch 2/50
2257/2257 - 185s - loss: 3.2409 - accuracy200: 0.3982 - val_loss: 3.3566 - val_accuracy200: 0.3264 - 185s/epoch - 82ms/step
Epoch 3/50
2257/2257 - 194s - loss: 3.2259 - accuracy200: 0.4027 - val_loss: 3.3940 - val_accuracy200: 0.3258 - 194s/epoch - 86ms/step
Epoch 4/50
2257/2257 - 194s - loss: 3.2084 - accuracy200: 0.4130 - val_loss: 3.3824 - val_accuracy200: 0.3295 - 194s/epoch - 86ms/step
Epoch 5/50
2257/2257 - 189s - loss: 3.1942 - accuracy200: 0.4215 - val_loss: 3.3565 - val_accuracy200: 0.3331 - 189s/epoch - 84ms/step
Epoch 6/50
2257/2257 - 188s - loss: 3.1732 - accuracy200: 0.4337 - val_loss: 3.3473 - val_accuracy200: 0.3364 - 188s/epoch - 83ms/step
Epoch 7/50
2257/2257 - 188s - loss: 3.1596 - accuracy200: 0.4398 - val_loss: 3.3395 - val_accuracy200: 0.3463 - 188s/epoch - 83ms/step
Epoch 8/50
2257/2257 - 190s - loss: 3.1448 - accuracy200: 0.4468 - val_loss: 3.3095 - val_accuracy200: 0.3706 - 190s/epoch - 84ms/step
Epoch 9/50
2257/2257 - 186s - loss: 3.1319 - accuracy200: 0.4519 - val_loss: 3.2789 - val_accuracy200: 0.3941 - 186s/epoch - 82ms/step
Epoch 10/50
2257/2257 - 194s - loss: 3.1201 - accuracy200: 0.4553 - val_loss: 3.2904 - val_accuracy200: 0.3939 - 194s/epoch - 86ms/step
Epoch 11/50
2257/2257 - 179s - loss: 3.1081 - accuracy200: 0.4590 - val_loss: 3.2581 - val_accuracy200: 0.4109 - 179s/epoch - 79ms/step
Epoch 12/50
2257/2257 - 189s - loss: 3.0949 - accuracy200: 0.4619 - val_loss: 3.2499 - val_accuracy200: 0.4227 - 189s/epoch - 84ms/step
Epoch 13/50
2257/2257 - 176s - loss: 3.0825 - accuracy200: 0.4640 - val_loss: 3.2342 - val_accuracy200: 0.4215 - 176s/epoch - 78ms/step
Epoch 14/50
2257/2257 - 193s - loss: 3.0720 - accuracy200: 0.4661 - val_loss: 3.2260 - val_accuracy200: 0.4216 - 193s/epoch - 86ms/step
Epoch 15/50
2257/2257 - 183s - loss: 3.0643 - accuracy200: 0.4690 - val_loss: 3.2291 - val_accuracy200: 0.4187 - 183s/epoch - 81ms/step
Epoch 16/50
2257/2257 - 189s - loss: 3.0561 - accuracy200: 0.4711 - val_loss: 3.2326 - val_accuracy200: 0.4213 - 189s/epoch - 84ms/step
Epoch 17/50
2257/2257 - 186s - loss: 3.0503 - accuracy200: 0.4722 - val_loss: 3.2446 - val_accuracy200: 0.4125 - 186s/epoch - 82ms/step
Epoch 18/50
2257/2257 - 184s - loss: 3.0454 - accuracy200: 0.4733 - val_loss: 3.2358 - val_accuracy200: 0.4171 - 184s/epoch - 82ms/step
Epoch 19/50
2257/2257 - 182s - loss: 3.0418 - accuracy200: 0.4752 - val_loss: 3.2459 - val_accuracy200: 0.4161 - 182s/epoch - 81ms/step
Epoch 20/50
2257/2257 - 188s - loss: 3.0359 - accuracy200: 0.4768 - val_loss: 3.2482 - val_accuracy200: 0.4160 - 188s/epoch - 83ms/step
Epoch 21/50
2257/2257 - 183s - loss: 3.0327 - accuracy200: 0.4786 - val_loss: 3.2479 - val_accuracy200: 0.4172 - 183s/epoch - 81ms/step
Epoch 22/50
2257/2257 - 203s - loss: 3.0283 - accuracy200: 0.4793 - val_loss: 3.2466 - val_accuracy200: 0.4140 - 203s/epoch - 90ms/step
Epoch 23/50
2257/2257 - 197s - loss: 3.0241 - accuracy200: 0.4810 - val_loss: 3.2574 - val_accuracy200: 0.4152 - 197s/epoch - 88ms/step
Epoch 24/50
2257/2257 - 193s - loss: 3.0195 - accuracy200: 0.4822 - val_loss: 3.2587 - val_accuracy200: 0.4133 - 193s/epoch - 85ms/step
testing model: results/AAL/W1/deepVOL_L3/h200
Evaluating performance on  test set...
7177/7177 - 311s - 311s/epoch - 43ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061347
{'0': {'precision': 0.4856139324864674, 'recall': 0.2200560536561991, 'f1-score': 0.30286759443339956, 'support': 649021}, '1': {'precision': 0.34463834378596786, 'recall': 0.579036880616106, 'f1-score': 0.43209627421956415, 'support': 562111}, '2': {'precision': 0.42637570460066226, 'recall': 0.40771810204215303, 'f1-score': 0.41683823006999465, 'support': 625957}, 'accuracy': 0.39383938393839385, 'macro avg': {'precision': 0.41887599362436584, 'recall': 0.4022703454381527, 'f1-score': 0.38393403290765277, 'support': 1837089}, 'weighted avg': {'precision': 0.4222939123063121, 'recall': 0.39383938393839385, 'f1-score': 0.38124244703687, 'support': 1837089}}
[[142821 323247 182953]
 [ 76229 325483 160399]
 [ 75054 295689 255214]]
Evaluating performance on  train set...
2257/2257 - 98s - 98s/epoch - 43ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0638894
{'0': {'precision': 0.496261229204699, 'recall': 0.24547727156777716, 'f1-score': 0.328473855417163, 'support': 196010}, '1': {'precision': 0.39223048225535345, 'recall': 0.607625418768226, 'f1-score': 0.47672711795787437, 'support': 188947}, '2': {'precision': 0.4524133893885371, 'recall': 0.4413554288799593, 'f1-score': 0.4468160030273725, 'support': 192618}, 'accuracy': 0.42927412024412415, 'macro avg': {'precision': 0.44696836694952985, 'recall': 0.4314860397386541, 'f1-score': 0.4173389921341366, 'support': 577575}, 'weighted avg': {'precision': 0.44760576324175483, 'recall': 0.42927412024412415, 'f1-score': 0.41643963819111124, 'support': 577575}}
[[ 48116  93278  54616]
 [ 25857 114809  48281]
 [ 22984  84621  85013]]
Evaluating performance on  val set...
638/638 - 27s - 27s/epoch - 42ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0779704
{'0': {'precision': 0.5149873899202051, 'recall': 0.22099996451509882, 'f1-score': 0.3092775825894797, 'support': 56362}, '1': {'precision': 0.3811288944317421, 'recall': 0.624054605959764, 'f1-score': 0.47323745752261875, 'support': 52888}, '2': {'precision': 0.44559693964943, 'recall': 0.43294870372425015, 'f1-score': 0.4391817746972923, 'support': 54078}, 'accuracy': 0.42169132053291536, 'macro avg': {'precision': 0.4472377413337924, 'recall': 0.4260010913997043, 'f1-score': 0.40723227160313025, 'support': 163328}, 'weighted avg': {'precision': 0.448666827131603, 'recall': 0.42169132053291536, 'f1-score': 0.4053815498594527, 'support': 163328}}
[[12456 28649 15257]
 [ 6010 33005 13873]
 [ 5721 24944 23413]]
training model: results/AAL/W1/deepVOL_L3/h300
Epoch 1/50
2257/2257 - 199s - loss: 3.2793 - accuracy300: 0.3775 - val_loss: 3.3330 - val_accuracy300: 0.3091 - 199s/epoch - 88ms/step
Epoch 2/50
2257/2257 - 190s - loss: 3.2622 - accuracy300: 0.3860 - val_loss: 3.2910 - val_accuracy300: 0.3666 - 190s/epoch - 84ms/step
Epoch 3/50
2257/2257 - 184s - loss: 3.2476 - accuracy300: 0.3961 - val_loss: 3.2906 - val_accuracy300: 0.3597 - 184s/epoch - 82ms/step
Epoch 4/50
2257/2257 - 198s - loss: 3.2366 - accuracy300: 0.4027 - val_loss: 3.2868 - val_accuracy300: 0.3669 - 198s/epoch - 88ms/step
Epoch 5/50
2257/2257 - 192s - loss: 3.2265 - accuracy300: 0.4066 - val_loss: 3.2998 - val_accuracy300: 0.3533 - 192s/epoch - 85ms/step
Epoch 6/50
2257/2257 - 186s - loss: 3.2143 - accuracy300: 0.4130 - val_loss: 3.2969 - val_accuracy300: 0.3711 - 186s/epoch - 82ms/step
Epoch 7/50
2257/2257 - 183s - loss: 3.2075 - accuracy300: 0.4176 - val_loss: 3.3012 - val_accuracy300: 0.3730 - 183s/epoch - 81ms/step
Epoch 8/50
2257/2257 - 161s - loss: 3.2004 - accuracy300: 0.4220 - val_loss: 3.3018 - val_accuracy300: 0.3711 - 161s/epoch - 71ms/step
Epoch 9/50
2257/2257 - 159s - loss: 3.1929 - accuracy300: 0.4273 - val_loss: 3.3038 - val_accuracy300: 0.3760 - 159s/epoch - 71ms/step
Epoch 10/50
2257/2257 - 186s - loss: 3.1853 - accuracy300: 0.4321 - val_loss: 3.3203 - val_accuracy300: 0.3763 - 186s/epoch - 82ms/step
Epoch 11/50
2257/2257 - 184s - loss: 3.1788 - accuracy300: 0.4342 - val_loss: 3.3228 - val_accuracy300: 0.3679 - 184s/epoch - 81ms/step
Epoch 12/50
2257/2257 - 185s - loss: 3.1743 - accuracy300: 0.4369 - val_loss: 3.3226 - val_accuracy300: 0.3694 - 185s/epoch - 82ms/step
Epoch 13/50
2257/2257 - 171s - loss: 3.1680 - accuracy300: 0.4391 - val_loss: 3.3349 - val_accuracy300: 0.3647 - 171s/epoch - 76ms/step
Epoch 14/50
2257/2257 - 164s - loss: 3.1609 - accuracy300: 0.4413 - val_loss: 3.3334 - val_accuracy300: 0.3715 - 164s/epoch - 73ms/step
testing model: results/AAL/W1/deepVOL_L3/h300
Evaluating performance on  test set...
7177/7177 - 97s - 97s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076453
{'0': {'precision': 0.43130449825119066, 'recall': 0.35086135118970835, 'f1-score': 0.3869462701261708, 'support': 682184}, '1': {'precision': 0.26296586594294225, 'recall': 0.4570020982391993, 'f1-score': 0.3338369440860561, 'support': 499943}, '2': {'precision': 0.4198852652183276, 'recall': 0.2649604099169112, 'f1-score': 0.3248993927525338, 'support': 654962}, 'accuracy': 0.3491208101512774, 'macro avg': {'precision': 0.3713852098041535, 'recall': 0.35760795311527294, 'f1-score': 0.34856086898825356, 'support': 1837089}, 'weighted avg': {'precision': 0.3814218390236014, 'recall': 0.3491208101512774, 'f1-score': 0.35037211248499767, 'support': 1837089}}
[[239352 320410 122422]
 [154128 228475 117340]
 [161469 319954 173539]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0914592
{'0': {'precision': 0.40508133130451557, 'recall': 0.3845559138581732, 'f1-score': 0.39455185909980434, 'support': 196606}, '1': {'precision': 0.319267936019779, 'recall': 0.4496342926295899, 'f1-score': 0.37339939259566174, 'support': 188402}, '2': {'precision': 0.4233393577974347, 'recall': 0.276116883993623, 'f1-score': 0.3342343305067166, 'support': 192567}, 'accuracy': 0.36962991819244256, 'macro avg': {'precision': 0.38256287504057646, 'recall': 0.3701023634937954, 'f1-score': 0.36739519406739424, 'support': 577575}, 'weighted avg': {'precision': 0.38317677880350187, 'recall': 0.36962991819244256, 'f1-score': 0.3675418040889424, 'support': 577575}}
[[75606 88529 32471]
 [63733 84712 39957]
 [47305 92091 53171]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975906
{'0': {'precision': 0.4378214165160932, 'recall': 0.371062197092084, 'f1-score': 0.4016869028209169, 'support': 59424}, '1': {'precision': 0.28491422186490795, 'recall': 0.44106231278741087, 'f1-score': 0.3461955576896012, 'support': 47406}, '2': {'precision': 0.42733336702208297, 'recall': 0.2993557294063507, 'f1-score': 0.3520754402764479, 'support': 56498}, 'accuracy': 0.36657523510971785, 'macro avg': {'precision': 0.38335633513436135, 'recall': 0.3704934130952819, 'f1-score': 0.3666526335956553, 'support': 163328}, 'weighted avg': {'precision': 0.38981205933332796, 'recall': 0.36657523510971785, 'f1-score': 0.36841905457608093, 'support': 163328}}
[[22050 26526 10848]
 [14680 20909 11817]
 [13633 25952 16913]]
training model: results/AAL/W1/deepVOL_L3/h500
Epoch 1/50
2257/2257 - 77s - loss: 3.2642 - accuracy500: 0.3764 - val_loss: 3.3206 - val_accuracy500: 0.3192 - 77s/epoch - 34ms/step
Epoch 2/50
2257/2257 - 74s - loss: 3.2685 - accuracy500: 0.3778 - val_loss: 3.3266 - val_accuracy500: 0.3540 - 74s/epoch - 33ms/step
Epoch 3/50
2257/2257 - 73s - loss: 3.2564 - accuracy500: 0.3873 - val_loss: 3.3318 - val_accuracy500: 0.3613 - 73s/epoch - 32ms/step
Epoch 4/50
2257/2257 - 74s - loss: 3.2492 - accuracy500: 0.3941 - val_loss: 3.3335 - val_accuracy500: 0.3689 - 74s/epoch - 33ms/step
Epoch 5/50
2257/2257 - 75s - loss: 3.2504 - accuracy500: 0.3938 - val_loss: 3.3311 - val_accuracy500: 0.3638 - 75s/epoch - 33ms/step
Epoch 6/50
2257/2257 - 75s - loss: 3.2377 - accuracy500: 0.3978 - val_loss: 3.3320 - val_accuracy500: 0.3649 - 75s/epoch - 33ms/step
Epoch 7/50
2257/2257 - 75s - loss: 3.2399 - accuracy500: 0.4013 - val_loss: 3.3428 - val_accuracy500: 0.3713 - 75s/epoch - 33ms/step
Epoch 8/50
2257/2257 - 75s - loss: 3.2354 - accuracy500: 0.4053 - val_loss: 3.3434 - val_accuracy500: 0.3742 - 75s/epoch - 33ms/step
Epoch 9/50
2257/2257 - 75s - loss: 3.2292 - accuracy500: 0.4086 - val_loss: 3.3271 - val_accuracy500: 0.3783 - 75s/epoch - 33ms/step
Epoch 10/50
2257/2257 - 74s - loss: 3.2187 - accuracy500: 0.4113 - val_loss: 3.3369 - val_accuracy500: 0.3652 - 74s/epoch - 33ms/step
Epoch 11/50
2257/2257 - 75s - loss: 3.2083 - accuracy500: 0.4157 - val_loss: 3.3144 - val_accuracy500: 0.3715 - 75s/epoch - 33ms/step
Epoch 12/50
2257/2257 - 75s - loss: 3.2004 - accuracy500: 0.4198 - val_loss: 3.3218 - val_accuracy500: 0.3560 - 75s/epoch - 33ms/step
Epoch 13/50
2257/2257 - 77s - loss: 3.1992 - accuracy500: 0.4193 - val_loss: 3.3190 - val_accuracy500: 0.3472 - 77s/epoch - 34ms/step
Epoch 14/50
2257/2257 - 75s - loss: 3.1896 - accuracy500: 0.4243 - val_loss: 3.3438 - val_accuracy500: 0.3621 - 75s/epoch - 33ms/step
Epoch 15/50
2257/2257 - 74s - loss: 3.1819 - accuracy500: 0.4285 - val_loss: 3.3558 - val_accuracy500: 0.3534 - 74s/epoch - 33ms/step
Epoch 16/50
2257/2257 - 75s - loss: 3.1787 - accuracy500: 0.4302 - val_loss: 3.3382 - val_accuracy500: 0.3721 - 75s/epoch - 33ms/step
Epoch 17/50
2257/2257 - 75s - loss: 3.1708 - accuracy500: 0.4338 - val_loss: 3.3495 - val_accuracy500: 0.3598 - 75s/epoch - 33ms/step
Epoch 18/50
2257/2257 - 75s - loss: 3.1679 - accuracy500: 0.4351 - val_loss: 3.3572 - val_accuracy500: 0.3595 - 75s/epoch - 33ms/step
Epoch 19/50
2257/2257 - 74s - loss: 3.1602 - accuracy500: 0.4387 - val_loss: 3.3868 - val_accuracy500: 0.3567 - 74s/epoch - 33ms/step
Epoch 20/50
2257/2257 - 75s - loss: 3.1544 - accuracy500: 0.4398 - val_loss: 3.3883 - val_accuracy500: 0.3638 - 75s/epoch - 33ms/step
Epoch 21/50
2257/2257 - 74s - loss: 3.1480 - accuracy500: 0.4426 - val_loss: 3.3828 - val_accuracy500: 0.3672 - 74s/epoch - 33ms/step
testing model: results/AAL/W1/deepVOL_L3/h500
Evaluating performance on  test set...
7177/7177 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1133372
{'0': {'precision': 0.3924038885688321, 'recall': 0.4855831254036173, 'f1-score': 0.4340490317041646, 'support': 670499}, '1': {'precision': 0.295308025949703, 'recall': 0.3297216806735377, 'f1-score': 0.311567458636694, 'support': 529859}, '2': {'precision': 0.38296024956165564, 'recall': 0.250063213507745, 'f1-score': 0.3025615201900237, 'support': 636731}, 'accuracy': 0.3589983936543085, 'macro avg': {'precision': 0.3568907213600636, 'recall': 0.35512267319496665, 'f1-score': 0.3493926701769608, 'support': 1837089}, 'weighted avg': {'precision': 0.36112604934591613, 'recall': 0.3589983936543085, 'f1-score': 0.3531492285275807, 'support': 1837089}}
[[325583 210331 134585]
 [233192 174706 121961]
 [270939 206569 159223]]
Evaluating performance on  train set...
2257/2257 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046864
{'0': {'precision': 0.3782721877060845, 'recall': 0.5498937893244396, 'f1-score': 0.44821622822079327, 'support': 198191}, '1': {'precision': 0.33583488550124474, 'recall': 0.2983426597767008, 'f1-score': 0.3159805128146959, 'support': 186745}, '2': {'precision': 0.3899067719798006, 'recall': 0.2501051189011571, 'f1-score': 0.30473708678176004, 'support': 192639}, 'accuracy': 0.36857204692031337, 'macro avg': {'precision': 0.3680046150623766, 'recall': 0.3661138560007658, 'f1-score': 0.3563112759390831, 'support': 577575}, 'weighted avg': {'precision': 0.36843159675194276, 'recall': 0.36857204692031337, 'f1-score': 0.3576062866527102, 'support': 577575}}
[[108984  53715  35492]
 [ 91135  55714  39896]
 [ 87991  56468  48180]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072887
{'0': {'precision': 0.407514450867052, 'recall': 0.5105526964276734, 'f1-score': 0.4532513821815773, 'support': 59653}, '1': {'precision': 0.2984990363462924, 'recall': 0.32744629052235935, 'f1-score': 0.3123033210106627, 'support': 46826}, '2': {'precision': 0.39543317662860983, 'recall': 0.25893155552428365, 'f1-score': 0.31294512830325066, 'support': 56849}, 'accuracy': 0.370475362460815, 'macro avg': {'precision': 0.3671488879473181, 'recall': 0.36564351415810553, 'f1-score': 0.35949994383183026, 'support': 163328}, 'weighted avg': {'precision': 0.3720547369200846, 'recall': 0.370475362460815, 'f1-score': 0.3640057896370152, 'support': 163328}}
[[30456 17637 11560]
 [20548 15333 10945]
 [23732 18397 14720]]
training model: results/AAL/W1/deepVOL_L3/h1000
Epoch 1/50
2257/2257 - 87s - loss: 3.1934 - accuracy1000: 0.4346 - val_loss: 3.2262 - val_accuracy1000: 0.4030 - 87s/epoch - 38ms/step
Epoch 2/50
2257/2257 - 83s - loss: 3.2023 - accuracy1000: 0.4256 - val_loss: 3.2355 - val_accuracy1000: 0.4071 - 83s/epoch - 37ms/step
Epoch 3/50
2257/2257 - 82s - loss: 3.2161 - accuracy1000: 0.4177 - val_loss: 3.2758 - val_accuracy1000: 0.4039 - 82s/epoch - 36ms/step
Epoch 4/50
2257/2257 - 81s - loss: 3.1997 - accuracy1000: 0.4279 - val_loss: 3.2597 - val_accuracy1000: 0.4017 - 81s/epoch - 36ms/step
Epoch 5/50
2257/2257 - 82s - loss: 3.1904 - accuracy1000: 0.4320 - val_loss: 3.2543 - val_accuracy1000: 0.4083 - 82s/epoch - 36ms/step
Epoch 6/50
2257/2257 - 82s - loss: 3.1809 - accuracy1000: 0.4397 - val_loss: 3.2679 - val_accuracy1000: 0.4049 - 82s/epoch - 36ms/step
Epoch 7/50
2257/2257 - 82s - loss: 3.1758 - accuracy1000: 0.4405 - val_loss: 3.2982 - val_accuracy1000: 0.3698 - 82s/epoch - 36ms/step
Epoch 8/50
2257/2257 - 82s - loss: 3.1646 - accuracy1000: 0.4431 - val_loss: 3.2658 - val_accuracy1000: 0.4048 - 82s/epoch - 36ms/step
Epoch 9/50
2257/2257 - 82s - loss: 3.1599 - accuracy1000: 0.4448 - val_loss: 3.2723 - val_accuracy1000: 0.3969 - 82s/epoch - 37ms/step
Epoch 10/50
2257/2257 - 84s - loss: 3.1498 - accuracy1000: 0.4474 - val_loss: 3.2931 - val_accuracy1000: 0.4017 - 84s/epoch - 37ms/step
Epoch 11/50
2257/2257 - 82s - loss: 3.1419 - accuracy1000: 0.4508 - val_loss: 3.2730 - val_accuracy1000: 0.4040 - 82s/epoch - 36ms/step
testing model: results/AAL/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
7177/7177 - 97s - 97s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0844196
{'0': {'precision': 0.4093646691266147, 'recall': 0.42564956965167416, 'f1-score': 0.417348320908355, 'support': 741260}, '1': {'precision': 0.125, 'recall': 2.4742676167854316e-06, 'f1-score': 4.948437283505869e-06, 'support': 404160}, '2': {'precision': 0.37312828169061635, 'recall': 0.5752448064030627, 'f1-score': 0.45264908686110705, 'support': 691669}, 'accuracy': 0.38833012445232645, 'macro avg': {'precision': 0.3024976502724103, 'recall': 0.33363228344078455, 'f1-score': 0.29000078540224855, 'support': 1837089}, 'weighted avg': {'precision': 0.333161278580113, 'recall': 0.38833012445232645, 'f1-score': 0.33882351784648146, 'support': 1837089}}
[[315517      4 425739]
 [161444      1 242715]
 [293787      3 397879]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112841
{'0': {'precision': 0.3309988433663345, 'recall': 0.4719204817089776, 'f1-score': 0.38909297292577505, 'support': 198294}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 187189}, '2': {'precision': 0.345878355004782, 'recall': 0.5309174770422506, 'f1-score': 0.4188725741862614, 'support': 192092}, 'accuracy': 0.33859498766393975, 'macro avg': {'precision': 0.22562573279037215, 'recall': 0.33427931958374274, 'f1-score': 0.26932184903734546, 'support': 577575}, 'weighted avg': {'precision': 0.22867255268330955, 'recall': 0.33859498766393975, 'f1-score': 0.2728942085338371, 'support': 577575}}
[[ 93579      0 104715]
 [ 99031      0  88158]
 [ 90107      0 101985]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0790101
{'0': {'precision': 0.41649752061868917, 'recall': 0.4865607131601459, 'f1-score': 0.44881121301263194, 'support': 66633}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 34682}, '2': {'precision': 0.39259978475504187, 'recall': 0.5411929756663926, 'f1-score': 0.45507366251516984, 'support': 62013}, 'accuracy': 0.40398461990595613, 'macro avg': {'precision': 0.2696991017912437, 'recall': 0.3425845629421795, 'f1-score': 0.30129495850926724, 'support': 163328}, 'weighted avg': {'precision': 0.31898247540776553, 'recall': 0.40398461990595613, 'f1-score': 0.35588582845699407, 'support': 163328}}
[[32421     2 34210]
 [16969     0 17713]
 [28452     0 33561]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        29 (peak)  21.46 (ave)

============================================
