This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-14.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-01.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-02.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-10.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-08.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-03.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-09.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-30.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-05-15.csv
training model: results/AAPL/W3/deepLOB_L1/h10
Epoch 1/50
5475/5475 - 117s - loss: 3.1379 - accuracy10: 0.4482 - val_loss: 3.2297 - val_accuracy10: 0.4164 - 117s/epoch - 21ms/step
Epoch 2/50
5475/5475 - 93s - loss: 3.0951 - accuracy10: 0.4632 - val_loss: 3.1994 - val_accuracy10: 0.4062 - 93s/epoch - 17ms/step
Epoch 3/50
5475/5475 - 92s - loss: 3.0807 - accuracy10: 0.4682 - val_loss: 3.1941 - val_accuracy10: 0.4156 - 92s/epoch - 17ms/step
Epoch 4/50
5475/5475 - 92s - loss: 3.0727 - accuracy10: 0.4711 - val_loss: 3.1866 - val_accuracy10: 0.4214 - 92s/epoch - 17ms/step
Epoch 5/50
5475/5475 - 91s - loss: 3.0668 - accuracy10: 0.4734 - val_loss: 3.2028 - val_accuracy10: 0.4178 - 91s/epoch - 17ms/step
Epoch 6/50
5475/5475 - 91s - loss: 3.0619 - accuracy10: 0.4753 - val_loss: 3.1917 - val_accuracy10: 0.4248 - 91s/epoch - 17ms/step
Epoch 7/50
5475/5475 - 89s - loss: 3.0580 - accuracy10: 0.4767 - val_loss: 3.1940 - val_accuracy10: 0.4280 - 89s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 91s - loss: 3.0556 - accuracy10: 0.4781 - val_loss: 3.2003 - val_accuracy10: 0.4270 - 91s/epoch - 17ms/step
Epoch 9/50
5475/5475 - 91s - loss: 3.0525 - accuracy10: 0.4789 - val_loss: 3.1929 - val_accuracy10: 0.4275 - 91s/epoch - 17ms/step
Epoch 10/50
5475/5475 - 90s - loss: 3.0497 - accuracy10: 0.4800 - val_loss: 3.2122 - val_accuracy10: 0.4238 - 90s/epoch - 17ms/step
Epoch 11/50
5475/5475 - 91s - loss: 3.0469 - accuracy10: 0.4807 - val_loss: 3.2149 - val_accuracy10: 0.4227 - 91s/epoch - 17ms/step
Epoch 12/50
5475/5475 - 92s - loss: 3.0454 - accuracy10: 0.4814 - val_loss: 3.2302 - val_accuracy10: 0.4204 - 92s/epoch - 17ms/step
Epoch 13/50
5475/5475 - 92s - loss: 3.0427 - accuracy10: 0.4822 - val_loss: 3.2245 - val_accuracy10: 0.4242 - 92s/epoch - 17ms/step
Epoch 14/50
5475/5475 - 89s - loss: 3.0408 - accuracy10: 0.4829 - val_loss: 3.2156 - val_accuracy10: 0.4228 - 89s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h10
Evaluating performance on  test set...
13689/13689 - 90s - 90s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.040115
{'0': {'precision': 0.5090700979505924, 'recall': 0.39666941882757945, 'f1-score': 0.445895395212212, 'support': 1071885}, '1': {'precision': 0.42515928682702553, 'recall': 0.4665231042485175, 'f1-score': 0.4448817926108982, 'support': 1333218}, '2': {'precision': 0.4660136539032354, 'recall': 0.511362033875483, 'f1-score': 0.4876358044372724, 'support': 1099143}, 'accuracy': 0.4592203287097995, 'macro avg': {'precision': 0.46674767956028446, 'recall': 0.45818485231719325, 'f1-score': 0.4594709974201276, 'support': 3504246}, 'weighted avg': {'precision': 0.46364046976122336, 'recall': 0.4592203287097995, 'f1-score': 0.458602073163458, 'support': 3504246}}
[[425184 424221 222480]
 [289679 621977 421562]
 [120354 416729 562060]]
Evaluating performance on  train set...
5475/5475 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0909532
{'0': {'precision': 0.49713560494137615, 'recall': 0.2726947473236589, 'f1-score': 0.35219777390229606, 'support': 463973}, '1': {'precision': 0.3499080437303149, 'recall': 0.6774847652100616, 'f1-score': 0.4614736774267255, 'support': 465054}, '2': {'precision': 0.5105500458168785, 'recall': 0.2664732434783161, 'f1-score': 0.3501772174428128, 'support': 472539}, 'accuracy': 0.40491064994441933, 'macro avg': {'precision': 0.4525312314961898, 'recall': 0.4055509186706789, 'f1-score': 0.3879495562572781, 'support': 1401566}, 'weighted avg': {'precision': 0.4528066758901721, 'recall': 0.40491064994441933, 'f1-score': 0.3877754094248774, 'support': 1401566}}
[[126523 288125  49325]
 [ 78597 315067  71390]
 [ 49384 297236 125919]]
Evaluating performance on  val set...
2036/2036 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621753
{'0': {'precision': 0.4963153430177076, 'recall': 0.23425125426952093, 'f1-score': 0.3182803376086901, 'support': 159854}, '1': {'precision': 0.3797627346988001, 'recall': 0.6663346253696755, 'f1-score': 0.48379638304091377, 'support': 193751}, '2': {'precision': 0.5007040855865648, 'recall': 0.31608903950218065, 'f1-score': 0.38753282471783546, 'support': 167611}, 'accuracy': 0.42118622605599215, 'macro avg': {'precision': 0.45892738776769076, 'recall': 0.40555830638045903, 'f1-score': 0.3965365151224798, 'support': 521216}, 'weighted avg': {'precision': 0.4544006994079798, 'recall': 0.42118622605599215, 'f1-score': 0.40207741585530904, 'support': 521216}}
[[ 37446 106296  16112]
 [ 27929 129103  36719]
 [ 10073 104558  52980]]
training model: results/AAPL/W3/deepLOB_L1/h20
Epoch 1/50
5475/5475 - 92s - loss: 3.1857 - accuracy20: 0.4259 - val_loss: 3.3701 - val_accuracy20: 0.3704 - 92s/epoch - 17ms/step
Epoch 2/50
5475/5475 - 87s - loss: 3.1439 - accuracy20: 0.4442 - val_loss: 3.2687 - val_accuracy20: 0.3761 - 87s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 88s - loss: 3.1294 - accuracy20: 0.4500 - val_loss: 3.2732 - val_accuracy20: 0.3730 - 88s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 85s - loss: 3.1220 - accuracy20: 0.4531 - val_loss: 3.2573 - val_accuracy20: 0.3736 - 85s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 87s - loss: 3.1166 - accuracy20: 0.4554 - val_loss: 3.2588 - val_accuracy20: 0.3740 - 87s/epoch - 16ms/step
Epoch 6/50
5475/5475 - 87s - loss: 3.1125 - accuracy20: 0.4569 - val_loss: 3.2695 - val_accuracy20: 0.3727 - 87s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 87s - loss: 3.1091 - accuracy20: 0.4583 - val_loss: 3.2660 - val_accuracy20: 0.3690 - 87s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 85s - loss: 3.1064 - accuracy20: 0.4597 - val_loss: 3.2631 - val_accuracy20: 0.3722 - 85s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 88s - loss: 3.1038 - accuracy20: 0.4607 - val_loss: 3.2556 - val_accuracy20: 0.3733 - 88s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 86s - loss: 3.1023 - accuracy20: 0.4608 - val_loss: 3.2559 - val_accuracy20: 0.3728 - 86s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 85s - loss: 3.1005 - accuracy20: 0.4619 - val_loss: 3.2441 - val_accuracy20: 0.3743 - 85s/epoch - 16ms/step
Epoch 12/50
5475/5475 - 88s - loss: 3.0985 - accuracy20: 0.4627 - val_loss: 3.2598 - val_accuracy20: 0.3753 - 88s/epoch - 16ms/step
Epoch 13/50
5475/5475 - 88s - loss: 3.0968 - accuracy20: 0.4631 - val_loss: 3.2636 - val_accuracy20: 0.3725 - 88s/epoch - 16ms/step
Epoch 14/50
5475/5475 - 88s - loss: 3.0957 - accuracy20: 0.4635 - val_loss: 3.2640 - val_accuracy20: 0.3731 - 88s/epoch - 16ms/step
Epoch 15/50
5475/5475 - 91s - loss: 3.0946 - accuracy20: 0.4640 - val_loss: 3.2767 - val_accuracy20: 0.3694 - 91s/epoch - 17ms/step
Epoch 16/50
5475/5475 - 93s - loss: 3.0934 - accuracy20: 0.4644 - val_loss: 3.2647 - val_accuracy20: 0.3727 - 93s/epoch - 17ms/step
Epoch 17/50
5475/5475 - 94s - loss: 3.0921 - accuracy20: 0.4650 - val_loss: 3.2724 - val_accuracy20: 0.3702 - 94s/epoch - 17ms/step
Epoch 18/50
5475/5475 - 91s - loss: 3.0913 - accuracy20: 0.4650 - val_loss: 3.2683 - val_accuracy20: 0.3712 - 91s/epoch - 17ms/step
Epoch 19/50
5475/5475 - 94s - loss: 3.0899 - accuracy20: 0.4654 - val_loss: 3.2763 - val_accuracy20: 0.3694 - 94s/epoch - 17ms/step
Epoch 20/50
5475/5475 - 93s - loss: 3.0889 - accuracy20: 0.4662 - val_loss: 3.2791 - val_accuracy20: 0.3668 - 93s/epoch - 17ms/step
Epoch 21/50
5475/5475 - 92s - loss: 3.0882 - accuracy20: 0.4661 - val_loss: 3.2728 - val_accuracy20: 0.3686 - 92s/epoch - 17ms/step
testing model: results/AAPL/W3/deepLOB_L1/h20
Evaluating performance on  test set...
13689/13689 - 92s - 92s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735124
{'0': {'precision': 0.5341139073801843, 'recall': 0.2068230555991422, 'f1-score': 0.29818210153310754, 'support': 1147140}, '1': {'precision': 0.35123144245081983, 'recall': 0.6338868819346308, 'f1-score': 0.452008653948131, 'support': 1186707}, '2': {'precision': 0.4733901976093483, 'recall': 0.37143486964701783, 'f1-score': 0.4162604381809773, 'support': 1170399}, 'accuracy': 0.40642694605344487, 'macro avg': {'precision': 0.4529118491467841, 'recall': 0.4040482690602636, 'f1-score': 0.388817064554072, 'support': 3504246}, 'weighted avg': {'precision': 0.4518996819801958, 'recall': 0.40642694605344487, 'f1-score': 0.3897127228625191, 'support': 3504246}}
[[237255 723129 186756]
 [137625 752238 296844]
 [ 69323 666349 434727]]
Evaluating performance on  train set...
5475/5475 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1140338
{'0': {'precision': 0.47094483104957313, 'recall': 0.14150373994955917, 'f1-score': 0.2176197579976794, 'support': 463910}, '1': {'precision': 0.33484062785904634, 'recall': 0.7947444878458211, 'f1-score': 0.47116899753367425, 'support': 464655}, '2': {'precision': 0.4642254122284502, 'recall': 0.1563611916253877, 'f1-score': 0.23392976318877529, 'support': 473001}, 'accuracy': 0.36308386476270116, 'macro avg': {'precision': 0.4233369570456899, 'recall': 0.3642031398069227, 'f1-score': 0.30757283957337633, 'support': 1401566}, 'weighted avg': {'precision': 0.4235551324158276, 'recall': 0.36308386476270116, 'f1-score': 0.3071821265639768, 'support': 1401566}}
[[ 65645 363024  35241]
 [ 45256 369282  50117]
 [ 28489 370553  73959]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820936
{'0': {'precision': 0.48233473119634274, 'recall': 0.15952545359302825, 'f1-score': 0.23975522583011635, 'support': 167992}, '1': {'precision': 0.3420999228864808, 'recall': 0.750699968271816, 'f1-score': 0.4700117621433239, 'support': 179651}, '2': {'precision': 0.4677660959527376, 'recall': 0.1925011378497808, 'f1-score': 0.27275473053501165, 'support': 173573}, 'accuracy': 0.3742709356581532, 'macro avg': {'precision': 0.4307335833451871, 'recall': 0.36757551990487497, 'f1-score': 0.3275072395028173, 'support': 521216}, 'weighted avg': {'precision': 0.42914748200826464, 'recall': 0.3742709356581532, 'f1-score': 0.33010863024469084, 'support': 521216}}
[[ 26799 127333  13860]
 [ 20629 134864  24158]
 [  8133 132027  33413]]
training model: results/AAPL/W3/deepLOB_L1/h30
Epoch 1/50
5475/5475 - 89s - loss: 3.1935 - accuracy30: 0.4245 - val_loss: 3.3561 - val_accuracy30: 0.3538 - 89s/epoch - 16ms/step
Epoch 2/50
5475/5475 - 88s - loss: 3.1623 - accuracy30: 0.4387 - val_loss: 3.3834 - val_accuracy30: 0.3414 - 88s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 86s - loss: 3.1482 - accuracy30: 0.4447 - val_loss: 3.4201 - val_accuracy30: 0.3386 - 86s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 85s - loss: 3.1394 - accuracy30: 0.4484 - val_loss: 3.3935 - val_accuracy30: 0.3461 - 85s/epoch - 15ms/step
Epoch 5/50
5475/5475 - 84s - loss: 3.1343 - accuracy30: 0.4504 - val_loss: 3.3942 - val_accuracy30: 0.3466 - 84s/epoch - 15ms/step
Epoch 6/50
5475/5475 - 85s - loss: 3.1311 - accuracy30: 0.4518 - val_loss: 3.4665 - val_accuracy30: 0.3301 - 85s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 86s - loss: 3.1283 - accuracy30: 0.4533 - val_loss: 3.5516 - val_accuracy30: 0.3288 - 86s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 86s - loss: 3.1266 - accuracy30: 0.4536 - val_loss: 3.5000 - val_accuracy30: 0.3302 - 86s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 85s - loss: 3.1243 - accuracy30: 0.4544 - val_loss: 3.5348 - val_accuracy30: 0.3293 - 85s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 87s - loss: 3.1226 - accuracy30: 0.4552 - val_loss: 3.5241 - val_accuracy30: 0.3298 - 87s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 86s - loss: 3.1211 - accuracy30: 0.4557 - val_loss: 3.4926 - val_accuracy30: 0.3318 - 86s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h30
Evaluating performance on  test set...
13689/13689 - 81s - 81s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1063411
{'0': {'precision': 0.49220218709455343, 'recall': 0.10656246519520168, 'f1-score': 0.17519497261800174, 'support': 1221096}, '1': {'precision': 0.30011749537296983, 'recall': 0.7231366812748851, 'f1-score': 0.42418780113365306, 'support': 1037772}, '2': {'precision': 0.4239801556225511, 'recall': 0.251707513702667, 'f1-score': 0.31588260575362603, 'support': 1245378}, 'accuracy': 0.34074234514357726, 'macro avg': {'precision': 0.40543327936335816, 'recall': 0.3604688867242512, 'f1-score': 0.30508845983509364, 'support': 3504246}, 'weighted avg': {'precision': 0.41107137270314636, 'recall': 0.34074234514357726, 'f1-score': 0.2989325951517856, 'support': 3504246}}
[[130123 874618 216355]
 [ 77794 750451 209527]
 [ 56452 875455 313471]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1370484
{'0': {'precision': 0.3423585545935051, 'recall': 0.21518411913236069, 'f1-score': 0.26426721206941717, 'support': 464156}, '1': {'precision': 0.3267989324077361, 'recall': 0.5360894115008175, 'f1-score': 0.40606284368148843, 'support': 463654}, '2': {'precision': 0.39084521157491453, 'recall': 0.28811877844291156, 'f1-score': 0.33171080226587313, 'support': 473756}, 'accuracy': 0.34599654957383386, 'macro avg': {'precision': 0.35333423285871857, 'recall': 0.34646410302536323, 'f1-score': 0.3340136193389262, 'support': 1401566}, 'weighted avg': {'precision': 0.3536006677725948, 'recall': 0.34599654957383386, 'f1-score': 0.3339720403090973, 'support': 1401566}}
[[ 99879 254840 109437]
 [111791 248560 103303]
 [ 80068 257190 136498]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1196584
{'0': {'precision': 0.400592234948809, 'recall': 0.2601890602262857, 'f1-score': 0.31547417551418167, 'support': 177298}, '1': {'precision': 0.30376041600466547, 'recall': 0.5025326084939793, 'f1-score': 0.37864525569214424, 'support': 161691}, '2': {'precision': 0.4129775840418008, 'recall': 0.3140204250742206, 'f1-score': 0.3567641035072898, 'support': 182227}, 'accuracy': 0.3541890502210216, 'macro avg': {'precision': 0.3724434116650918, 'recall': 0.3589140312648285, 'f1-score': 0.3502945115712053, 'support': 521216}, 'weighted avg': {'precision': 0.3748833376246116, 'recall': 0.3541890502210216, 'f1-score': 0.34950677396368257, 'support': 521216}}
[[46131 90157 41010]
 [40107 81255 40329]
 [28919 96085 57223]]
training model: results/AAPL/W3/deepLOB_L1/h50
Epoch 1/50
5475/5475 - 91s - loss: 3.2309 - accuracy50: 0.4035 - val_loss: 3.4382 - val_accuracy50: 0.3475 - 91s/epoch - 17ms/step
Epoch 2/50
5475/5475 - 87s - loss: 3.2112 - accuracy50: 0.4148 - val_loss: 3.3981 - val_accuracy50: 0.3488 - 87s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 86s - loss: 3.1985 - accuracy50: 0.4223 - val_loss: 3.4043 - val_accuracy50: 0.3523 - 86s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 89s - loss: 3.1916 - accuracy50: 0.4256 - val_loss: 3.4532 - val_accuracy50: 0.3520 - 89s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 86s - loss: 3.1867 - accuracy50: 0.4282 - val_loss: 3.4792 - val_accuracy50: 0.3505 - 86s/epoch - 16ms/step
Epoch 6/50
5475/5475 - 87s - loss: 3.1816 - accuracy50: 0.4308 - val_loss: 3.4422 - val_accuracy50: 0.3497 - 87s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 84s - loss: 3.1791 - accuracy50: 0.4322 - val_loss: 3.4939 - val_accuracy50: 0.3494 - 84s/epoch - 15ms/step
Epoch 8/50
5475/5475 - 87s - loss: 3.1760 - accuracy50: 0.4336 - val_loss: 3.4997 - val_accuracy50: 0.3486 - 87s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 85s - loss: 3.1730 - accuracy50: 0.4352 - val_loss: 3.4939 - val_accuracy50: 0.3483 - 85s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 86s - loss: 3.1711 - accuracy50: 0.4360 - val_loss: 3.5012 - val_accuracy50: 0.3478 - 86s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 85s - loss: 3.1692 - accuracy50: 0.4369 - val_loss: 3.5001 - val_accuracy50: 0.3483 - 85s/epoch - 16ms/step
Epoch 12/50
5475/5475 - 87s - loss: 3.1681 - accuracy50: 0.4374 - val_loss: 3.5004 - val_accuracy50: 0.3476 - 87s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h50
Evaluating performance on  test set...
13689/13689 - 84s - 84s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1445308
{'0': {'precision': 0.5186835790195407, 'recall': 0.005293610842630536, 'f1-score': 0.010480261625566159, 'support': 1143265}, '1': {'precision': 0.3465145029333486, 'recall': 0.9653555021215708, 'f1-score': 0.5099738246666071, 'support': 1213959}, '2': {'precision': 0.4221342229696131, 'recall': 0.04070628113497387, 'f1-score': 0.0742524226143004, 'support': 1147022}, 'accuracy': 0.34947460880314907, 'macro avg': {'precision': 0.42911076830750083, 'recall': 0.3371184646997251, 'f1-score': 0.19823550296882456, 'support': 3504246}, 'weighted avg': {'precision': 0.4274370070289848, 'recall': 0.34947460880314907, 'f1-score': 0.2043915275405045, 'support': 3504246}}
[[   6052 1111464   25749]
 [   3890 1171902   38167]
 [   1726 1098605   46691]]
Evaluating performance on  train set...
5475/5475 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1562183
{'0': {'precision': 0.39881846202481624, 'recall': 0.043336560942776846, 'f1-score': 0.07817810354677228, 'support': 465773}, '1': {'precision': 0.32863348432703515, 'recall': 0.9398658257723447, 'f1-score': 0.48698706994057955, 'support': 462682}, '2': {'precision': 0.42142857142857143, 'recall': 0.024691879918243287, 'f1-score': 0.04665046692397235, 'support': 473111}, 'accuracy': 0.3330032263910512, 'macro avg': {'precision': 0.3829601725934743, 'recall': 0.33596475554445493, 'f1-score': 0.20393854680377474, 'support': 1401566}, 'weighted avg': {'precision': 0.38328138822233765, 'recall': 0.3330032263910512, 'f1-score': 0.20249082124880702, 'support': 1401566}}
[[ 20185 439041   6547]
 [ 18332 434859   9491]
 [ 12095 449334  11682]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1336297
{'0': {'precision': 0.4196247464503043, 'recall': 0.0973174489303901, 'f1-score': 0.1579937184370555, 'support': 170062}, '1': {'precision': 0.34002522845890093, 'recall': 0.8830655253541573, 'f1-score': 0.49099309444803513, 'support': 179793}, '2': {'precision': 0.44229603179950144, 'recall': 0.038310934226574306, 'f1-score': 0.07051405984833838, 'support': 171361}, 'accuracy': 0.348960891453831, 'macro avg': {'precision': 0.40064866890290224, 'recall': 0.3395646361703739, 'f1-score': 0.23983362424447632, 'support': 521216}, 'weighted avg': {'precision': 0.3996206368114893, 'recall': 0.348960891453831, 'f1-score': 0.2441007355580205, 'support': 521216}}
[[ 16550 150507   3005]
 [ 15751 158769   5273]
 [  7139 157657   6565]]
training model: results/AAPL/W3/deepLOB_L1/h100
Epoch 1/50
5475/5475 - 87s - loss: 3.2500 - accuracy100: 0.3922 - val_loss: 3.4730 - val_accuracy100: 0.3535 - 87s/epoch - 16ms/step
Epoch 2/50
5475/5475 - 82s - loss: 3.2380 - accuracy100: 0.3997 - val_loss: 3.4996 - val_accuracy100: 0.3471 - 82s/epoch - 15ms/step
Epoch 3/50
5475/5475 - 84s - loss: 3.2346 - accuracy100: 0.4018 - val_loss: 3.5534 - val_accuracy100: 0.3555 - 84s/epoch - 15ms/step
Epoch 4/50
5475/5475 - 82s - loss: 3.2323 - accuracy100: 0.4040 - val_loss: 3.5741 - val_accuracy100: 0.3543 - 82s/epoch - 15ms/step
Epoch 5/50
5475/5475 - 82s - loss: 3.2278 - accuracy100: 0.4073 - val_loss: 3.6276 - val_accuracy100: 0.3542 - 82s/epoch - 15ms/step
Epoch 6/50
5475/5475 - 87s - loss: 3.2229 - accuracy100: 0.4100 - val_loss: 3.6240 - val_accuracy100: 0.3568 - 87s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 86s - loss: 3.2198 - accuracy100: 0.4121 - val_loss: 3.6400 - val_accuracy100: 0.3563 - 86s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 84s - loss: 3.2166 - accuracy100: 0.4138 - val_loss: 3.6744 - val_accuracy100: 0.3557 - 84s/epoch - 15ms/step
Epoch 9/50
5475/5475 - 83s - loss: 3.2155 - accuracy100: 0.4145 - val_loss: 3.6880 - val_accuracy100: 0.3533 - 83s/epoch - 15ms/step
Epoch 10/50
5475/5475 - 83s - loss: 3.2125 - accuracy100: 0.4161 - val_loss: 3.6149 - val_accuracy100: 0.3633 - 83s/epoch - 15ms/step
Epoch 11/50
5475/5475 - 84s - loss: 3.2111 - accuracy100: 0.4168 - val_loss: 3.6658 - val_accuracy100: 0.3659 - 84s/epoch - 15ms/step
testing model: results/AAPL/W3/deepLOB_L1/h100
Evaluating performance on  test set...
13689/13689 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.189119
{'0': {'precision': 0.3470319634703196, 'recall': 6.21322140814488e-05, 'f1-score': 0.0001242421839814225, 'support': 1223198}, '1': {'precision': 0.30161083938929073, 'recall': 0.9980310118006828, 'f1-score': 0.46323065224489496, 'support': 1056888}, '2': {'precision': 0.346652904747862, 'recall': 0.0019205005881584108, 'f1-score': 0.0038198387901298356, 'support': 1224160}, 'accuracy': 0.3017008509105811, 'macro avg': {'precision': 0.3317652358691574, 'recall': 0.33333788153430755, 'f1-score': 0.15572491107300207, 'support': 3504246}, 'weighted avg': {'precision': 0.3332004375119725, 'recall': 0.3017008509105811, 'f1-score': 0.14108911995164997, 'support': 3504246}}
[[     76 1220702    2420]
 [     70 1054807    2011]
 [     73 1221736    2351]]
Evaluating performance on  train set...
5475/5475 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1756623
{'0': {'precision': 0.35604395604395606, 'recall': 0.0003450097113844686, 'f1-score': 0.0006893514351913909, 'support': 469552}, '1': {'precision': 0.3275606930611396, 'recall': 0.994901894142407, 'f1-score': 0.4928544022742444, 'support': 458994}, '2': {'precision': 0.3452754781615758, 'recall': 0.005113948670246502, 'f1-score': 0.01007862074137651, 'support': 473020}, 'accuracy': 0.32765849057411495, 'macro avg': {'precision': 0.34296004242222383, 'recall': 0.33345361750801267, 'f1-score': 0.16787412481693742, 'support': 1401566}, 'weighted avg': {'precision': 0.3430817750139807, 'recall': 0.32765849057411495, 'f1-score': 0.16503560235168907, 'support': 1401566}}
[[   162 466994   2396]
 [   149 456654   2191]
 [   144 470457   2419]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1612419
{'0': {'precision': 0.39574468085106385, 'recall': 0.0005508075549474956, 'f1-score': 0.0011000839849063743, 'support': 168843}, '1': {'precision': 0.3533688503735457, 'recall': 0.996537460115563, 'f1-score': 0.521732943833143, 'support': 183969}, '2': {'precision': 0.3582295988934993, 'recall': 0.004613904657846607, 'f1-score': 0.00911046883152668, 'support': 168404}, 'accuracy': 0.3534081839390963, 'macro avg': {'precision': 0.3691143767060363, 'recall': 0.3339007241094523, 'f1-score': 0.17731449888319198, 'support': 521216}, 'weighted avg': {'precision': 0.3686665999419969, 'recall': 0.3534081839390963, 'f1-score': 0.1874513998369341, 'support': 521216}}
[[    93 167927    823]
 [    68 183332    569]
 [    74 167553    777]]
training model: results/AAPL/W3/deepLOB_L1/h200
Epoch 1/50
5475/5475 - 88s - loss: 3.2596 - accuracy200: 0.3884 - val_loss: 3.3881 - val_accuracy200: 0.3394 - 88s/epoch - 16ms/step
Epoch 2/50
5475/5475 - 86s - loss: 3.2459 - accuracy200: 0.3952 - val_loss: 3.4823 - val_accuracy200: 0.3370 - 86s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 85s - loss: 3.2410 - accuracy200: 0.3997 - val_loss: 3.5767 - val_accuracy200: 0.3366 - 85s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 87s - loss: 3.2380 - accuracy200: 0.4018 - val_loss: 3.5988 - val_accuracy200: 0.3365 - 87s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 85s - loss: 3.2341 - accuracy200: 0.4043 - val_loss: 3.5499 - val_accuracy200: 0.3366 - 85s/epoch - 15ms/step
Epoch 6/50
5475/5475 - 87s - loss: 3.2305 - accuracy200: 0.4068 - val_loss: 3.6361 - val_accuracy200: 0.3358 - 87s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 88s - loss: 3.2278 - accuracy200: 0.4090 - val_loss: 3.6531 - val_accuracy200: 0.3363 - 88s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 86s - loss: 3.2247 - accuracy200: 0.4103 - val_loss: 3.5970 - val_accuracy200: 0.3362 - 86s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 86s - loss: 3.2222 - accuracy200: 0.4119 - val_loss: 3.6958 - val_accuracy200: 0.3346 - 86s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 87s - loss: 3.2201 - accuracy200: 0.4128 - val_loss: 3.7178 - val_accuracy200: 0.3341 - 87s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 86s - loss: 3.2175 - accuracy200: 0.4138 - val_loss: 3.6937 - val_accuracy200: 0.3362 - 86s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h200
Evaluating performance on  test set...
13689/13689 - 91s - 91s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1306026
{'0': {'precision': 0.3283801780332235, 'recall': 0.0040117793033290486, 'f1-score': 0.007926718879803193, 'support': 1167811}, '1': {'precision': 0.33343299046858954, 'recall': 0.9033322499529585, 'f1-score': 0.48707832924843664, 'support': 1169180}, '2': {'precision': 0.3341799709724238, 'recall': 0.09231658892015883, 'f1-score': 0.1446687167342303, 'support': 1167255}, 'accuracy': 0.33348115400574047, 'macro avg': {'precision': 0.33199771315807897, 'recall': 0.33322020605881547, 'f1-score': 0.21322458828749002, 'support': 3504246}, 'weighted avg': {'precision': 0.33199792762912156, 'recall': 0.33348115400574047, 'f1-score': 0.21334245182673905, 'support': 3504246}}
[[   4685 1056556  106570]
 [   4897 1056158  108125]
 [   4685 1054813  107757]]
Evaluating performance on  train set...
5475/5475 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1336498
{'0': {'precision': 0.3304812343109043, 'recall': 0.0458738792334169, 'f1-score': 0.08056463529306408, 'support': 470660}, '1': {'precision': 0.3295340745930241, 'recall': 0.8453353913658023, 'f1-score': 0.47420896360962017, 'support': 461282}, '2': {'precision': 0.3391681324501579, 'recall': 0.1104500621774015, 'f1-score': 0.16663534423354007, 'support': 469624}, 'accuracy': 0.3306294530546546, 'macro avg': {'precision': 0.33306114711802876, 'recall': 0.33388644425887354, 'f1-score': 0.2404696477120748, 'support': 1401566}, 'weighted avg': {'precision': 0.3330802329472622, 'recall': 0.3306294530546546, 'f1-score': 0.23896025395817133, 'support': 1401566}}
[[ 21591 397320  51749]
 [ 22030 389938  49314]
 [ 21711 396043  51870]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1310325
{'0': {'precision': 0.332473109399839, 'recall': 0.09272224781206817, 'f1-score': 0.14500465970637097, 'support': 173680}, '1': {'precision': 0.338548883577759, 'recall': 0.8301200560945855, 'f1-score': 0.480950949727682, 'support': 175418}, '2': {'precision': 0.3539092720665807, 'recall': 0.08770727059343009, 'f1-score': 0.14057632942688325, 'support': 172118}, 'accuracy': 0.3392413126227898, 'macro avg': {'precision': 0.3416437550147262, 'recall': 0.33684985816669455, 'f1-score': 0.2555106462869787, 'support': 521216}, 'weighted avg': {'precision': 0.3415966773651674, 'recall': 0.3392413126227898, 'f1-score': 0.2566068187957187, 'support': 521216}}
[[ 16104 142202  15374]
 [ 17615 145618  12185]
 [ 14718 142304  15096]]
training model: results/AAPL/W3/deepLOB_L1/h300
Epoch 1/50
5475/5475 - 90s - loss: 3.2598 - accuracy300: 0.3906 - val_loss: 3.3632 - val_accuracy300: 0.3493 - 90s/epoch - 17ms/step
Epoch 2/50
5475/5475 - 85s - loss: 3.2403 - accuracy300: 0.4004 - val_loss: 3.3705 - val_accuracy300: 0.3429 - 85s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 87s - loss: 3.2308 - accuracy300: 0.4061 - val_loss: 3.4063 - val_accuracy300: 0.3452 - 87s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 86s - loss: 3.2234 - accuracy300: 0.4108 - val_loss: 3.4805 - val_accuracy300: 0.3444 - 86s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 86s - loss: 3.2172 - accuracy300: 0.4147 - val_loss: 3.4768 - val_accuracy300: 0.3423 - 86s/epoch - 16ms/step
Epoch 6/50
5475/5475 - 83s - loss: 3.2118 - accuracy300: 0.4175 - val_loss: 3.4538 - val_accuracy300: 0.3414 - 83s/epoch - 15ms/step
Epoch 7/50
5475/5475 - 83s - loss: 3.2072 - accuracy300: 0.4196 - val_loss: 3.4932 - val_accuracy300: 0.3376 - 83s/epoch - 15ms/step
Epoch 8/50
5475/5475 - 85s - loss: 3.2045 - accuracy300: 0.4212 - val_loss: 3.4474 - val_accuracy300: 0.3375 - 85s/epoch - 15ms/step
Epoch 9/50
5475/5475 - 85s - loss: 3.2012 - accuracy300: 0.4226 - val_loss: 3.4584 - val_accuracy300: 0.3373 - 85s/epoch - 15ms/step
Epoch 10/50
5475/5475 - 84s - loss: 3.1985 - accuracy300: 0.4239 - val_loss: 3.4786 - val_accuracy300: 0.3349 - 84s/epoch - 15ms/step
Epoch 11/50
5475/5475 - 83s - loss: 3.1963 - accuracy300: 0.4242 - val_loss: 3.4854 - val_accuracy300: 0.3365 - 83s/epoch - 15ms/step
testing model: results/AAPL/W3/deepLOB_L1/h300
Evaluating performance on  test set...
13689/13689 - 84s - 84s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1219594
{'0': {'precision': 0.3065662902551234, 'recall': 0.0006463525610728218, 'f1-score': 0.0012899853666735008, 'support': 1134056}, '1': {'precision': 0.3529811123466572, 'recall': 0.9158056920118313, 'f1-score': 0.5095609613045763, 'support': 1237067}, '2': {'precision': 0.3279564006596008, 'recall': 0.08459893586133191, 'f1-score': 0.13450201729874894, 'support': 1133123}, 'accuracy': 0.35086206847350326, 'macro avg': {'precision': 0.3291679344204605, 'recall': 0.3336836601447453, 'f1-score': 0.2151176546566662, 'support': 3504246}, 'weighted avg': {'precision': 0.3298682704220866, 'recall': 0.35086206847350326, 'f1-score': 0.22379458939548394, 'support': 3504246}}
[[    733 1040141   93182]
 [    899 1132913  103255]
 [    759 1036503   95861]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1295927
{'0': {'precision': 0.33935817041682037, 'recall': 0.0019502722961700467, 'f1-score': 0.003878256470786611, 'support': 471729}, '1': {'precision': 0.33029406012009177, 'recall': 0.9285402254634127, 'f1-score': 0.48726242137737147, 'support': 460119}, '2': {'precision': 0.347831865127582, 'recall': 0.07800850723199877, 'f1-score': 0.12743669378258343, 'support': 469718}, 'accuracy': 0.33162976270828487, 'macro avg': {'precision': 0.33916136522149803, 'recall': 0.3361663349971939, 'f1-score': 0.20619245721024715, 'support': 1401566}, 'weighted avg': {'precision': 0.33922237771532016, 'recall': 0.33162976270828487, 'f1-score': 0.20397718911461182, 'support': 1401566}}
[[   920 434104  36705]
 [   883 427239  31997]
 [   908 432168  36642]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228694
{'0': {'precision': 0.3658227848101266, 'recall': 0.0033722877296568786, 'f1-score': 0.0066829694121183746, 'support': 171397}, '1': {'precision': 0.34985450206209306, 'recall': 0.9305828567610159, 'f1-score': 0.5085271836786859, 'support': 179581}, '2': {'precision': 0.3505695086498594, 'recall': 0.08642018820709829, 'f1-score': 0.1386590262200524, 'support': 170238}, 'accuracy': 0.3499604770383104, 'macro avg': {'precision': 0.3554155985073597, 'recall': 0.34012511089925707, 'f1-score': 0.2179563931036189, 'support': 521216}, 'weighted avg': {'precision': 0.35533905558626133, 'recall': 0.3499604770383104, 'f1-score': 0.22269519045113775, 'support': 521216}}
[[   578 155579  15240]
 [   452 167115  12014]
 [   550 154976  14712]]
training model: results/AAPL/W3/deepLOB_L1/h500
Epoch 1/50
5475/5475 - 91s - loss: 3.2385 - accuracy500: 0.4044 - val_loss: 3.5411 - val_accuracy500: 0.3367 - 91s/epoch - 17ms/step
Epoch 2/50
5475/5475 - 87s - loss: 3.2070 - accuracy500: 0.4192 - val_loss: 3.4460 - val_accuracy500: 0.3406 - 87s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 85s - loss: 3.1965 - accuracy500: 0.4242 - val_loss: 3.5664 - val_accuracy500: 0.3400 - 85s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 86s - loss: 3.1884 - accuracy500: 0.4280 - val_loss: 3.7568 - val_accuracy500: 0.3369 - 86s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 87s - loss: 3.1806 - accuracy500: 0.4311 - val_loss: 3.7763 - val_accuracy500: 0.3380 - 87s/epoch - 16ms/step
Epoch 6/50
5475/5475 - 87s - loss: 3.1748 - accuracy500: 0.4336 - val_loss: 3.8920 - val_accuracy500: 0.3328 - 87s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 86s - loss: 3.1689 - accuracy500: 0.4363 - val_loss: 3.9281 - val_accuracy500: 0.3306 - 86s/epoch - 16ms/step
Epoch 8/50
5475/5475 - 86s - loss: 3.1642 - accuracy500: 0.4379 - val_loss: 3.8425 - val_accuracy500: 0.3333 - 86s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 88s - loss: 3.1603 - accuracy500: 0.4393 - val_loss: 4.0298 - val_accuracy500: 0.3380 - 88s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 84s - loss: 3.1562 - accuracy500: 0.4412 - val_loss: 3.9153 - val_accuracy500: 0.3348 - 84s/epoch - 15ms/step
Epoch 11/50
5475/5475 - 87s - loss: 3.1517 - accuracy500: 0.4432 - val_loss: 3.9774 - val_accuracy500: 0.3390 - 87s/epoch - 16ms/step
Epoch 12/50
5475/5475 - 86s - loss: 3.1489 - accuracy500: 0.4437 - val_loss: 3.5911 - val_accuracy500: 0.3439 - 86s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h500
Evaluating performance on  test set...
13689/13689 - 88s - 88s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1213523
{'0': {'precision': 0.32203608010445206, 'recall': 0.01540543060782482, 'f1-score': 0.02940423349097195, 'support': 1136742}, '1': {'precision': 0.35359594589537424, 'recall': 0.9381209957403597, 'f1-score': 0.5136044440712572, 'support': 1238837}, '2': {'precision': 0.32212304749760917, 'recall': 0.04655580432492489, 'f1-score': 0.08135371743571522, 'support': 1128667}, 'accuracy': 0.35164112336862197, 'macro avg': {'precision': 0.3325850244991451, 'recall': 0.3333607435577031, 'f1-score': 0.2081207983326481, 'support': 3504246}, 'weighted avg': {'precision': 0.33322127848480587, 'recall': 0.35164112336862197, 'f1-score': 0.21731307449988238, 'support': 3504246}}
[[  17512 1065979   53251]
 [  19331 1162179   57327]
 [  17536 1058585   52546]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1497526
{'0': {'precision': 0.3423175965665236, 'recall': 0.012711297160038673, 'f1-score': 0.024512375020488447, 'support': 470605}, '1': {'precision': 0.330991429335663, 'recall': 0.9544410620264405, 'f1-score': 0.4915261026302906, 'support': 462851}, '2': {'precision': 0.34071870826757317, 'recall': 0.03597231419965393, 'f1-score': 0.065074236955396, 'support': 468110}, 'accuracy': 0.33147564938076407, 'macro avg': {'precision': 0.3380092447232532, 'recall': 0.33437489112871105, 'f1-score': 0.19370423820205837, 'support': 1401566}, 'weighted avg': {'precision': 0.3380432467102965, 'recall': 0.33147564938076407, 'f1-score': 0.19228555446995718, 'support': 1401566}}
[[  5982 447770  16853]
 [  5357 441764  15730]
 [  6136 445135  16839]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1503675
{'0': {'precision': 0.35128131298589116, 'recall': 0.01416183964618617, 'f1-score': 0.02722606561035483, 'support': 172294}, '1': {'precision': 0.3411637543521258, 'recall': 0.9378233103610966, 'f1-score': 0.5003198707931747, 'support': 178041}, '2': {'precision': 0.3290013679890561, 'recall': 0.04785201397463732, 'f1-score': 0.08355174087414106, 'support': 170881}, 'accuracy': 0.3407186272102161, 'macro avg': {'precision': 0.34048214510902436, 'recall': 0.33327905466064, 'f1-score': 0.20369922575922353, 'support': 521216}, 'weighted avg': {'precision': 0.34052078464885166, 'recall': 0.3407186272102161, 'f1-score': 0.20729552219515937, 'support': 521216}}
[[  2440 162240   7614]
 [  2007 166971   9063]
 [  2499 160205   8177]]
training model: results/AAPL/W3/deepLOB_L1/h1000
Epoch 1/50
5475/5475 - 97s - loss: 3.2195 - accuracy1000: 0.4133 - val_loss: 3.4679 - val_accuracy1000: 0.3506 - 97s/epoch - 18ms/step
Epoch 2/50
5475/5475 - 86s - loss: 3.1699 - accuracy1000: 0.4383 - val_loss: 3.4463 - val_accuracy1000: 0.3380 - 86s/epoch - 16ms/step
Epoch 3/50
5475/5475 - 87s - loss: 3.1503 - accuracy1000: 0.4467 - val_loss: 3.5015 - val_accuracy1000: 0.3329 - 87s/epoch - 16ms/step
Epoch 4/50
5475/5475 - 86s - loss: 3.1371 - accuracy1000: 0.4505 - val_loss: 3.5332 - val_accuracy1000: 0.3225 - 86s/epoch - 16ms/step
Epoch 5/50
5475/5475 - 86s - loss: 3.1205 - accuracy1000: 0.4566 - val_loss: 3.6050 - val_accuracy1000: 0.3173 - 86s/epoch - 16ms/step
Epoch 6/50
5475/5475 - 85s - loss: 3.1103 - accuracy1000: 0.4611 - val_loss: 3.5642 - val_accuracy1000: 0.3127 - 85s/epoch - 16ms/step
Epoch 7/50
5475/5475 - 85s - loss: 3.1035 - accuracy1000: 0.4631 - val_loss: 3.7444 - val_accuracy1000: 0.3273 - 85s/epoch - 15ms/step
Epoch 8/50
5475/5475 - 85s - loss: 3.0979 - accuracy1000: 0.4646 - val_loss: 3.6744 - val_accuracy1000: 0.3260 - 85s/epoch - 16ms/step
Epoch 9/50
5475/5475 - 85s - loss: 3.0878 - accuracy1000: 0.4681 - val_loss: 3.8101 - val_accuracy1000: 0.3136 - 85s/epoch - 16ms/step
Epoch 10/50
5475/5475 - 87s - loss: 3.0809 - accuracy1000: 0.4699 - val_loss: 3.9511 - val_accuracy1000: 0.3098 - 87s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 88s - loss: 3.0775 - accuracy1000: 0.4711 - val_loss: 3.9643 - val_accuracy1000: 0.3180 - 88s/epoch - 16ms/step
Epoch 12/50
5475/5475 - 86s - loss: 3.0708 - accuracy1000: 0.4730 - val_loss: 4.0049 - val_accuracy1000: 0.3189 - 86s/epoch - 16ms/step
testing model: results/AAPL/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
13689/13689 - 80s - 80s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1491892
{'0': {'precision': 0.30158730158730157, 'recall': 3.249051789885531e-05, 'f1-score': 6.497403603323251e-05, 'support': 1169572}, '1': {'precision': 0.33862977677423045, 'recall': 0.9985789540225041, 'f1-score': 0.5057528574325261, 'support': 1186450}, '2': {'precision': 0.2533210332103321, 'recall': 0.0011957597123906137, 'f1-score': 0.00238028369236957, 'support': 1148224}, 'accuracy': 0.3384964982481253, 'macro avg': {'precision': 0.29784603719062136, 'recall': 0.33326906808426454, 'f1-score': 0.1693993717203096, 'support': 3504246}, 'weighted avg': {'precision': 0.2983137177534767, 'recall': 0.3384964982481253, 'f1-score': 0.17203688564572217, 'support': 3504246}}
[[     38 1167137    2397]
 [     36 1184764    1650]
 [     52 1146799    1373]]
Evaluating performance on  train set...
5475/5475 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1494935
{'0': {'precision': 0.3199113409678611, 'recall': 0.0036919876194780057, 'f1-score': 0.0072997315283496785, 'support': 469124}, '1': {'precision': 0.3314408107434169, 'recall': 0.9879931684157385, 'f1-score': 0.4963662629900634, 'support': 465485}, '2': {'precision': 0.3184253435825763, 'recall': 0.00585492882642299, 'f1-score': 0.011498434421282618, 'support': 466957}, 'accuracy': 0.3313165416398514, 'macro avg': {'precision': 0.32325916509795144, 'recall': 0.3325133616205465, 'f1-score': 0.1717214763132319, 'support': 1401566}, 'weighted avg': {'precision': 0.32324539613003983, 'recall': 0.3313165416398514, 'f1-score': 0.17112629988419673, 'support': 1401566}}
[[  1732 464954   2438]
 [  2175 459896   3414]
 [  1507 462716   2734]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1493195
{'0': {'precision': 0.2835083384805435, 'recall': 0.010712722817049334, 'f1-score': 0.020645335402364767, 'support': 171385}, '1': {'precision': 0.3395982603307568, 'recall': 0.9754653749753583, 'f1-score': 0.5038027597461627, 'support': 177545}, '2': {'precision': 0.27154266498528795, 'recall': 0.007499158376188431, 'f1-score': 0.01459524186078037, 'support': 172286}, 'accuracy': 0.33828009884577603, 'macro avg': {'precision': 0.2982164212655294, 'recall': 0.3312257520561987, 'f1-score': 0.17968111233643594, 'support': 521216}, 'weighted avg': {'precision': 0.2986593836347454, 'recall': 0.33828009884577603, 'f1-score': 0.18322637376115306, 'support': 521216}}
[[  1836 168348   1201]
 [  2091 173189   2265]
 [  2549 168445   1292]]
training model: results/AAPL/W3/deepOF_L1/h10
Epoch 1/50
5475/5475 - 82s - loss: 3.1522 - accuracy10: 0.4489 - val_loss: 3.2500 - val_accuracy10: 0.3823 - 82s/epoch - 15ms/step
Epoch 2/50
5475/5475 - 77s - loss: 3.1445 - accuracy10: 0.4508 - val_loss: 3.2483 - val_accuracy10: 0.3815 - 77s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 77s - loss: 3.1424 - accuracy10: 0.4516 - val_loss: 3.2488 - val_accuracy10: 0.3834 - 77s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 78s - loss: 3.1412 - accuracy10: 0.4511 - val_loss: 3.2527 - val_accuracy10: 0.3842 - 78s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 78s - loss: 3.1391 - accuracy10: 0.4518 - val_loss: 3.2531 - val_accuracy10: 0.3851 - 78s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 77s - loss: 3.1378 - accuracy10: 0.4518 - val_loss: 3.2522 - val_accuracy10: 0.3861 - 77s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 77s - loss: 3.1364 - accuracy10: 0.4521 - val_loss: 3.2473 - val_accuracy10: 0.3878 - 77s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 78s - loss: 3.1345 - accuracy10: 0.4525 - val_loss: 3.2479 - val_accuracy10: 0.3890 - 78s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 78s - loss: 3.1329 - accuracy10: 0.4534 - val_loss: 3.2463 - val_accuracy10: 0.3904 - 78s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 77s - loss: 3.1313 - accuracy10: 0.4543 - val_loss: 3.2470 - val_accuracy10: 0.3905 - 77s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 79s - loss: 3.1299 - accuracy10: 0.4545 - val_loss: 3.2454 - val_accuracy10: 0.3907 - 79s/epoch - 14ms/step
Epoch 12/50
5475/5475 - 77s - loss: 3.1280 - accuracy10: 0.4554 - val_loss: 3.2436 - val_accuracy10: 0.3929 - 77s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 79s - loss: 3.1267 - accuracy10: 0.4562 - val_loss: 3.2429 - val_accuracy10: 0.3931 - 79s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 79s - loss: 3.1253 - accuracy10: 0.4568 - val_loss: 3.2381 - val_accuracy10: 0.3942 - 79s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 78s - loss: 3.1245 - accuracy10: 0.4567 - val_loss: 3.2383 - val_accuracy10: 0.3954 - 78s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 80s - loss: 3.1232 - accuracy10: 0.4575 - val_loss: 3.2361 - val_accuracy10: 0.3958 - 80s/epoch - 15ms/step
Epoch 17/50
5475/5475 - 79s - loss: 3.1220 - accuracy10: 0.4577 - val_loss: 3.2351 - val_accuracy10: 0.3967 - 79s/epoch - 14ms/step
Epoch 18/50
5475/5475 - 79s - loss: 3.1209 - accuracy10: 0.4586 - val_loss: 3.2321 - val_accuracy10: 0.3976 - 79s/epoch - 14ms/step
Epoch 19/50
5475/5475 - 78s - loss: 3.1202 - accuracy10: 0.4583 - val_loss: 3.2278 - val_accuracy10: 0.3985 - 78s/epoch - 14ms/step
Epoch 20/50
5475/5475 - 81s - loss: 3.1187 - accuracy10: 0.4589 - val_loss: 3.2291 - val_accuracy10: 0.3990 - 81s/epoch - 15ms/step
Epoch 21/50
5475/5475 - 77s - loss: 3.1176 - accuracy10: 0.4592 - val_loss: 3.2289 - val_accuracy10: 0.3992 - 77s/epoch - 14ms/step
Epoch 22/50
5475/5475 - 79s - loss: 3.1170 - accuracy10: 0.4596 - val_loss: 3.2274 - val_accuracy10: 0.3998 - 79s/epoch - 14ms/step
Epoch 23/50
5475/5475 - 76s - loss: 3.1158 - accuracy10: 0.4600 - val_loss: 3.2277 - val_accuracy10: 0.4010 - 76s/epoch - 14ms/step
Epoch 24/50
5475/5475 - 79s - loss: 3.1152 - accuracy10: 0.4601 - val_loss: 3.2236 - val_accuracy10: 0.4022 - 79s/epoch - 14ms/step
Epoch 25/50
5475/5475 - 75s - loss: 3.1135 - accuracy10: 0.4609 - val_loss: 3.2212 - val_accuracy10: 0.4021 - 75s/epoch - 14ms/step
Epoch 26/50
5475/5475 - 77s - loss: 3.1122 - accuracy10: 0.4612 - val_loss: 3.2216 - val_accuracy10: 0.4031 - 77s/epoch - 14ms/step
Epoch 27/50
5475/5475 - 77s - loss: 3.1107 - accuracy10: 0.4622 - val_loss: 3.2194 - val_accuracy10: 0.4039 - 77s/epoch - 14ms/step
Epoch 28/50
5475/5475 - 76s - loss: 3.1096 - accuracy10: 0.4625 - val_loss: 3.2211 - val_accuracy10: 0.4021 - 76s/epoch - 14ms/step
Epoch 29/50
5475/5475 - 79s - loss: 3.1096 - accuracy10: 0.4625 - val_loss: 3.2200 - val_accuracy10: 0.4027 - 79s/epoch - 14ms/step
Epoch 30/50
5475/5475 - 76s - loss: 3.1087 - accuracy10: 0.4627 - val_loss: 3.2175 - val_accuracy10: 0.4034 - 76s/epoch - 14ms/step
Epoch 31/50
5475/5475 - 76s - loss: 3.1078 - accuracy10: 0.4630 - val_loss: 3.2183 - val_accuracy10: 0.4034 - 76s/epoch - 14ms/step
Epoch 32/50
5475/5475 - 77s - loss: 3.1072 - accuracy10: 0.4637 - val_loss: 3.2161 - val_accuracy10: 0.4039 - 77s/epoch - 14ms/step
Epoch 33/50
5475/5475 - 75s - loss: 3.1075 - accuracy10: 0.4630 - val_loss: 3.2155 - val_accuracy10: 0.4037 - 75s/epoch - 14ms/step
Epoch 34/50
5475/5475 - 78s - loss: 3.1059 - accuracy10: 0.4639 - val_loss: 3.2155 - val_accuracy10: 0.4036 - 78s/epoch - 14ms/step
Epoch 35/50
5475/5475 - 75s - loss: 3.1054 - accuracy10: 0.4637 - val_loss: 3.2144 - val_accuracy10: 0.4041 - 75s/epoch - 14ms/step
Epoch 36/50
5475/5475 - 78s - loss: 3.1044 - accuracy10: 0.4640 - val_loss: 3.2119 - val_accuracy10: 0.4049 - 78s/epoch - 14ms/step
Epoch 37/50
5475/5475 - 78s - loss: 3.1042 - accuracy10: 0.4641 - val_loss: 3.2120 - val_accuracy10: 0.4048 - 78s/epoch - 14ms/step
Epoch 38/50
5475/5475 - 76s - loss: 3.1038 - accuracy10: 0.4644 - val_loss: 3.2126 - val_accuracy10: 0.4050 - 76s/epoch - 14ms/step
Epoch 39/50
5475/5475 - 77s - loss: 3.1033 - accuracy10: 0.4645 - val_loss: 3.2137 - val_accuracy10: 0.4046 - 77s/epoch - 14ms/step
Epoch 40/50
5475/5475 - 78s - loss: 3.1024 - accuracy10: 0.4645 - val_loss: 3.2110 - val_accuracy10: 0.4052 - 78s/epoch - 14ms/step
Epoch 41/50
5475/5475 - 77s - loss: 3.1011 - accuracy10: 0.4653 - val_loss: 3.2094 - val_accuracy10: 0.4051 - 77s/epoch - 14ms/step
Epoch 42/50
5475/5475 - 75s - loss: 3.1014 - accuracy10: 0.4649 - val_loss: 3.2114 - val_accuracy10: 0.4049 - 75s/epoch - 14ms/step
Epoch 43/50
5475/5475 - 77s - loss: 3.1013 - accuracy10: 0.4652 - val_loss: 3.2114 - val_accuracy10: 0.4052 - 77s/epoch - 14ms/step
Epoch 44/50
5475/5475 - 77s - loss: 3.1003 - accuracy10: 0.4656 - val_loss: 3.2091 - val_accuracy10: 0.4060 - 77s/epoch - 14ms/step
Epoch 45/50
5475/5475 - 74s - loss: 3.0987 - accuracy10: 0.4660 - val_loss: 3.2121 - val_accuracy10: 0.4047 - 74s/epoch - 14ms/step
Epoch 46/50
5475/5475 - 77s - loss: 3.0989 - accuracy10: 0.4656 - val_loss: 3.2113 - val_accuracy10: 0.4060 - 77s/epoch - 14ms/step
Epoch 47/50
5475/5475 - 79s - loss: 3.0979 - accuracy10: 0.4662 - val_loss: 3.2138 - val_accuracy10: 0.4060 - 79s/epoch - 14ms/step
Epoch 48/50
5475/5475 - 77s - loss: 3.0972 - accuracy10: 0.4665 - val_loss: 3.2142 - val_accuracy10: 0.4049 - 77s/epoch - 14ms/step
Epoch 49/50
5475/5475 - 80s - loss: 3.0965 - accuracy10: 0.4668 - val_loss: 3.2108 - val_accuracy10: 0.4071 - 80s/epoch - 15ms/step
Epoch 50/50
5475/5475 - 79s - loss: 3.0955 - accuracy10: 0.4671 - val_loss: 3.2129 - val_accuracy10: 0.4067 - 79s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h10
Evaluating performance on  test set...
13689/13689 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0642543
{'0': {'precision': 0.5055707336576264, 'recall': 0.21234873582284633, 'f1-score': 0.29907896560854036, 'support': 1071883}, '1': {'precision': 0.3925259032029509, 'recall': 0.8107196272477569, 'f1-score': 0.5289501533582834, 'support': 1333218}, '2': {'precision': 0.5112061648053526, 'recall': 0.13972183732569343, 'f1-score': 0.21946102906921908, 'support': 1099141}, 'accuracy': 0.4172237533823292, 'macro avg': {'precision': 0.46976760055530997, 'recall': 0.3875967334654322, 'f1-score': 0.349163382678681, 'support': 3504242}, 'weighted avg': {'precision': 0.46432949822297925, 'recall': 0.4172237533823292, 'f1-score': 0.36156239763280434, 'support': 3504242}}
[[ 227613  797616   46654]
 [ 152165 1080866  100187]
 [  70432  875135  153574]]
Evaluating performance on  train set...
5475/5475 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.100873
{'0': {'precision': 0.5459107968927294, 'recall': 0.134772893291415, 'f1-score': 0.21617670185795487, 'support': 464077}, '1': {'precision': 0.33974767568975384, 'recall': 0.8527117947968116, 'f1-score': 0.4858980241856681, 'support': 465061}, '2': {'precision': 0.5260297076824167, 'recall': 0.1333560528928279, 'f1-score': 0.21277149042374627, 'support': 472427}, 'accuracy': 0.3725185774473535, 'macro avg': {'precision': 0.47056272675496663, 'recall': 0.3736135803270182, 'f1-score': 0.3049487388224564, 'support': 1401565}, 'weighted avg': {'precision': 0.4708013366521145, 'recall': 0.3725185774473535, 'f1-score': 0.30452662074207354, 'support': 1401565}}
[[ 62545 379603  21929]
 [ 33661 396563  34837]
 [ 18364 391062  63001]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0703799
{'0': {'precision': 0.5170824842576784, 'recall': 0.1761442874742813, 'f1-score': 0.26277440361237836, 'support': 159903}, '1': {'precision': 0.38023350196315314, 'recall': 0.8321636792720776, 'f1-score': 0.5219684025556519, 'support': 193647}, '2': {'precision': 0.5172927777907166, 'recall': 0.13247169968866676, 'f1-score': 0.21092766959634954, 'support': 167666}, 'accuracy': 0.4058259915275049, 'macro avg': {'precision': 0.471536254670516, 'recall': 0.3802598888116752, 'f1-score': 0.3318901585881266, 'support': 521216}, 'weighted avg': {'precision': 0.4663067294863791, 'recall': 0.4058259915275049, 'f1-score': 0.3423943803740983, 'support': 521216}}
[[ 28166 125058   6679]
 [ 18454 161146  14047]
 [  7851 137604  22211]]
training model: results/AAPL/W3/deepOF_L1/h20
Epoch 1/50
5475/5475 - 81s - loss: 3.1727 - accuracy20: 0.4383 - val_loss: 3.2492 - val_accuracy20: 0.3677 - 81s/epoch - 15ms/step
Epoch 2/50
5475/5475 - 79s - loss: 3.1620 - accuracy20: 0.4421 - val_loss: 3.2485 - val_accuracy20: 0.3685 - 79s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 79s - loss: 3.1605 - accuracy20: 0.4419 - val_loss: 3.2421 - val_accuracy20: 0.3705 - 79s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 76s - loss: 3.1592 - accuracy20: 0.4420 - val_loss: 3.2398 - val_accuracy20: 0.3714 - 76s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 77s - loss: 3.1574 - accuracy20: 0.4427 - val_loss: 3.2370 - val_accuracy20: 0.3725 - 77s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 76s - loss: 3.1562 - accuracy20: 0.4431 - val_loss: 3.2354 - val_accuracy20: 0.3738 - 76s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 78s - loss: 3.1549 - accuracy20: 0.4435 - val_loss: 3.2326 - val_accuracy20: 0.3767 - 78s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 77s - loss: 3.1536 - accuracy20: 0.4438 - val_loss: 3.2318 - val_accuracy20: 0.3759 - 77s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 78s - loss: 3.1526 - accuracy20: 0.4442 - val_loss: 3.2305 - val_accuracy20: 0.3775 - 78s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 78s - loss: 3.1515 - accuracy20: 0.4447 - val_loss: 3.2314 - val_accuracy20: 0.3764 - 78s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 78s - loss: 3.1507 - accuracy20: 0.4450 - val_loss: 3.2312 - val_accuracy20: 0.3767 - 78s/epoch - 14ms/step
Epoch 12/50
5475/5475 - 78s - loss: 3.1495 - accuracy20: 0.4453 - val_loss: 3.2298 - val_accuracy20: 0.3774 - 78s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 78s - loss: 3.1489 - accuracy20: 0.4460 - val_loss: 3.2288 - val_accuracy20: 0.3799 - 78s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 78s - loss: 3.1472 - accuracy20: 0.4467 - val_loss: 3.2314 - val_accuracy20: 0.3787 - 78s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 75s - loss: 3.1459 - accuracy20: 0.4473 - val_loss: 3.2311 - val_accuracy20: 0.3803 - 75s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 78s - loss: 3.1448 - accuracy20: 0.4477 - val_loss: 3.2329 - val_accuracy20: 0.3811 - 78s/epoch - 14ms/step
Epoch 17/50
5475/5475 - 79s - loss: 3.1442 - accuracy20: 0.4479 - val_loss: 3.2312 - val_accuracy20: 0.3814 - 79s/epoch - 14ms/step
Epoch 18/50
5475/5475 - 79s - loss: 3.1433 - accuracy20: 0.4483 - val_loss: 3.2340 - val_accuracy20: 0.3824 - 79s/epoch - 14ms/step
Epoch 19/50
5475/5475 - 79s - loss: 3.1430 - accuracy20: 0.4481 - val_loss: 3.2312 - val_accuracy20: 0.3835 - 79s/epoch - 15ms/step
Epoch 20/50
5475/5475 - 76s - loss: 3.1423 - accuracy20: 0.4484 - val_loss: 3.2302 - val_accuracy20: 0.3836 - 76s/epoch - 14ms/step
Epoch 21/50
5475/5475 - 77s - loss: 3.1417 - accuracy20: 0.4485 - val_loss: 3.2267 - val_accuracy20: 0.3844 - 77s/epoch - 14ms/step
Epoch 22/50
5475/5475 - 78s - loss: 3.1408 - accuracy20: 0.4491 - val_loss: 3.2282 - val_accuracy20: 0.3838 - 78s/epoch - 14ms/step
Epoch 23/50
5475/5475 - 79s - loss: 3.1399 - accuracy20: 0.4491 - val_loss: 3.2277 - val_accuracy20: 0.3838 - 79s/epoch - 14ms/step
Epoch 24/50
5475/5475 - 79s - loss: 3.1394 - accuracy20: 0.4498 - val_loss: 3.2239 - val_accuracy20: 0.3852 - 79s/epoch - 14ms/step
Epoch 25/50
5475/5475 - 78s - loss: 3.1387 - accuracy20: 0.4498 - val_loss: 3.2244 - val_accuracy20: 0.3865 - 78s/epoch - 14ms/step
Epoch 26/50
5475/5475 - 77s - loss: 3.1378 - accuracy20: 0.4504 - val_loss: 3.2237 - val_accuracy20: 0.3857 - 77s/epoch - 14ms/step
Epoch 27/50
5475/5475 - 78s - loss: 3.1374 - accuracy20: 0.4504 - val_loss: 3.2237 - val_accuracy20: 0.3854 - 78s/epoch - 14ms/step
Epoch 28/50
5475/5475 - 79s - loss: 3.1368 - accuracy20: 0.4505 - val_loss: 3.2245 - val_accuracy20: 0.3869 - 79s/epoch - 14ms/step
Epoch 29/50
5475/5475 - 79s - loss: 3.1357 - accuracy20: 0.4508 - val_loss: 3.2253 - val_accuracy20: 0.3867 - 79s/epoch - 14ms/step
Epoch 30/50
5475/5475 - 78s - loss: 3.1353 - accuracy20: 0.4510 - val_loss: 3.2221 - val_accuracy20: 0.3863 - 78s/epoch - 14ms/step
Epoch 31/50
5475/5475 - 77s - loss: 3.1347 - accuracy20: 0.4512 - val_loss: 3.2206 - val_accuracy20: 0.3912 - 77s/epoch - 14ms/step
Epoch 32/50
5475/5475 - 78s - loss: 3.1344 - accuracy20: 0.4514 - val_loss: 3.2202 - val_accuracy20: 0.3894 - 78s/epoch - 14ms/step
Epoch 33/50
5475/5475 - 77s - loss: 3.1338 - accuracy20: 0.4513 - val_loss: 3.2227 - val_accuracy20: 0.3873 - 77s/epoch - 14ms/step
Epoch 34/50
5475/5475 - 79s - loss: 3.1329 - accuracy20: 0.4520 - val_loss: 3.2212 - val_accuracy20: 0.3885 - 79s/epoch - 14ms/step
Epoch 35/50
5475/5475 - 79s - loss: 3.1323 - accuracy20: 0.4523 - val_loss: 3.2252 - val_accuracy20: 0.3886 - 79s/epoch - 14ms/step
Epoch 36/50
5475/5475 - 77s - loss: 3.1317 - accuracy20: 0.4521 - val_loss: 3.2237 - val_accuracy20: 0.3880 - 77s/epoch - 14ms/step
Epoch 37/50
5475/5475 - 76s - loss: 3.1312 - accuracy20: 0.4525 - val_loss: 3.2236 - val_accuracy20: 0.3895 - 76s/epoch - 14ms/step
Epoch 38/50
5475/5475 - 77s - loss: 3.1307 - accuracy20: 0.4525 - val_loss: 3.2231 - val_accuracy20: 0.3896 - 77s/epoch - 14ms/step
Epoch 39/50
5475/5475 - 77s - loss: 3.1299 - accuracy20: 0.4528 - val_loss: 3.2269 - val_accuracy20: 0.3892 - 77s/epoch - 14ms/step
Epoch 40/50
5475/5475 - 79s - loss: 3.1293 - accuracy20: 0.4534 - val_loss: 3.2239 - val_accuracy20: 0.3902 - 79s/epoch - 14ms/step
Epoch 41/50
5475/5475 - 79s - loss: 3.1287 - accuracy20: 0.4536 - val_loss: 3.2285 - val_accuracy20: 0.3875 - 79s/epoch - 14ms/step
Epoch 42/50
5475/5475 - 79s - loss: 3.1283 - accuracy20: 0.4537 - val_loss: 3.2299 - val_accuracy20: 0.3886 - 79s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h20
Evaluating performance on  test set...
13689/13689 - 91s - 91s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.080831
{'0': {'precision': 0.5077922283149761, 'recall': 0.280119985668669, 'f1-score': 0.36106243612871614, 'support': 1147137}, '1': {'precision': 0.3445871795048033, 'recall': 0.7604394011659165, 'f1-score': 0.47426491455623687, 'support': 1186706}, '2': {'precision': 0.5314892673618534, 'recall': 0.11470532698677972, 'f1-score': 0.18868820858570634, 'support': 1170399}, 'accuracy': 0.3875317401024244, 'macro avg': {'precision': 0.4612895583938776, 'recall': 0.38508823794045505, 'f1-score': 0.3413385197568865, 'support': 3504242}, 'weighted avg': {'precision': 0.46043778765422866, 'recall': 0.3875317401024244, 'f1-score': 0.34182616101492497, 'support': 3504242}}
[[321336 786257  39544]
 [205489 902418  78799]
 [105985 930163 134251]]
Evaluating performance on  train set...
5475/5475 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0885171
{'0': {'precision': 0.5138346246904979, 'recall': 0.23529487842731506, 'f1-score': 0.32278172210574874, 'support': 463920}, '1': {'precision': 0.3362039942794711, 'recall': 0.789055671097447, 'f1-score': 0.47150658020425995, 'support': 464478}, '2': {'precision': 0.520127653557939, 'recall': 0.10884529140874152, 'f1-score': 0.18001870024554995, 'support': 473167}, 'accuracy': 0.37612169253655736, 'macro avg': {'precision': 0.456722090842636, 'recall': 0.37773194697783447, 'f1-score': 0.3247690008518529, 'support': 1401565}, 'weighted avg': {'precision': 0.4570924355220095, 'recall': 0.37612169253655736, 'f1-score': 0.3238724127803558, 'support': 1401565}}
[[109158 338225  16537]
 [ 67000 366499  30979]
 [ 36280 385385  51502]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743166
{'0': {'precision': 0.509535099474281, 'recall': 0.2651586946803755, 'f1-score': 0.34880274733029115, 'support': 167775}, '1': {'precision': 0.35034311799026574, 'recall': 0.77229966124285, 'f1-score': 0.48202309113407205, 'support': 180070}, '2': {'precision': 0.5230661002732758, 'recall': 0.11150653800231873, 'f1-score': 0.18382541720154044, 'support': 173371}, 'accuracy': 0.38925704506385067, 'macro avg': {'precision': 0.4609814392459408, 'recall': 0.38298829797518147, 'f1-score': 0.3382170852219679, 'support': 521216}, 'weighted avg': {'precision': 0.45903815201621356, 'recall': 0.38925704506385067, 'f1-score': 0.33995171936299007, 'support': 521216}}
[[ 44487 117600   5688]
 [ 29063 139068  11939]
 [ 13759 140280  19332]]
training model: results/AAPL/W3/deepOF_L1/h30
Epoch 1/50
5475/5475 - 82s - loss: 3.1775 - accuracy30: 0.4382 - val_loss: 3.2302 - val_accuracy30: 0.3919 - 82s/epoch - 15ms/step
Epoch 2/50
5475/5475 - 79s - loss: 3.1678 - accuracy30: 0.4425 - val_loss: 3.2287 - val_accuracy30: 0.3900 - 79s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 79s - loss: 3.1659 - accuracy30: 0.4430 - val_loss: 3.2328 - val_accuracy30: 0.3856 - 79s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 78s - loss: 3.1640 - accuracy30: 0.4435 - val_loss: 3.2325 - val_accuracy30: 0.3867 - 78s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 78s - loss: 3.1621 - accuracy30: 0.4439 - val_loss: 3.2337 - val_accuracy30: 0.3851 - 78s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 78s - loss: 3.1611 - accuracy30: 0.4442 - val_loss: 3.2351 - val_accuracy30: 0.3818 - 78s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 79s - loss: 3.1601 - accuracy30: 0.4442 - val_loss: 3.2339 - val_accuracy30: 0.3832 - 79s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 77s - loss: 3.1587 - accuracy30: 0.4449 - val_loss: 3.2329 - val_accuracy30: 0.3837 - 77s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 78s - loss: 3.1575 - accuracy30: 0.4452 - val_loss: 3.2316 - val_accuracy30: 0.3853 - 78s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 79s - loss: 3.1561 - accuracy30: 0.4458 - val_loss: 3.2318 - val_accuracy30: 0.3861 - 79s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 78s - loss: 3.1544 - accuracy30: 0.4464 - val_loss: 3.2307 - val_accuracy30: 0.3871 - 78s/epoch - 14ms/step
Epoch 12/50
5475/5475 - 80s - loss: 3.1528 - accuracy30: 0.4472 - val_loss: 3.2292 - val_accuracy30: 0.3894 - 80s/epoch - 15ms/step
testing model: results/AAPL/W3/deepOF_L1/h30
Evaluating performance on  test set...
13689/13689 - 75s - 75s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0833296
{'0': {'precision': 0.49011103531703604, 'recall': 0.3712760852153888, 'f1-score': 0.42249646454174167, 'support': 1221094}, '1': {'precision': 0.2962145654642507, 'recall': 0.5542509419235476, 'f1-score': 0.38608785540122603, 'support': 1037770}, '2': {'precision': 0.4983527758080811, 'recall': 0.25507757484073107, 'f1-score': 0.3374395983883697, 'support': 1245378}, 'accuracy': 0.38416753180859087, 'macro avg': {'precision': 0.4282261255297892, 'recall': 0.3935348673265558, 'f1-score': 0.3820079727771124, 'support': 3504242}, 'weighted avg': {'precision': 0.4356182642042338, 'recall': 0.38416753180859087, 'f1-score': 0.3814856804223495, 'support': 3504242}}
[[453363 636051 131680]
 [274497 575185 188088]
 [197161 730549 317668]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790081
{'0': {'precision': 0.46693022950271423, 'recall': 0.3369432186444184, 'f1-score': 0.391427219728809, 'support': 464096}, '1': {'precision': 0.33158199976408603, 'recall': 0.5821217481340869, 'f1-score': 0.42250257547149134, 'support': 463580}, '2': {'precision': 0.4636942221659659, 'recall': 0.2473722749420223, 'f1-score': 0.322628319801844, 'support': 473889}, 'accuracy': 0.3877529761373893, 'macro avg': {'precision': 0.4207354838109221, 'recall': 0.38881241390684257, 'f1-score': 0.37885270500071483, 'support': 1401565}, 'weighted avg': {'precision': 0.42106846738462655, 'recall': 0.3877529761373893, 'f1-score': 0.3784437844458953, 'support': 1401565}}
[[156374 257130  50592]
 [108728 269860  84992]
 [ 69796 286866 117227]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.076906
{'0': {'precision': 0.49264563651416327, 'recall': 0.35894646048381185, 'f1-score': 0.4153007246613138, 'support': 177383}, '1': {'precision': 0.3112802133405806, 'recall': 0.5667227431285717, 'f1-score': 0.4018427844376372, 'support': 161684}, '2': {'precision': 0.48952954675846244, 'recall': 0.26232370202416705, 'f1-score': 0.3415964569251172, 'support': 182149}, 'accuracy': 0.38963308877701375, 'macro avg': {'precision': 0.43115179887106875, 'recall': 0.3959976352121835, 'f1-score': 0.386246655341356, 'support': 521216}, 'weighted avg': {'precision': 0.4352961312930866, 'recall': 0.38963308877701375, 'f1-score': 0.3853686192174951, 'support': 521216}}
[[ 63671  94447  19265]
 [ 39493  91630  30561]
 [ 26079 108288  47782]]
training model: results/AAPL/W3/deepOF_L1/h50
Epoch 1/50
5475/5475 - 79s - loss: 3.2080 - accuracy50: 0.4227 - val_loss: 3.3196 - val_accuracy50: 0.3462 - 79s/epoch - 14ms/step
Epoch 2/50
5475/5475 - 75s - loss: 3.2006 - accuracy50: 0.4252 - val_loss: 3.3156 - val_accuracy50: 0.3472 - 75s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 76s - loss: 3.1996 - accuracy50: 0.4256 - val_loss: 3.3137 - val_accuracy50: 0.3476 - 76s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 77s - loss: 3.1986 - accuracy50: 0.4258 - val_loss: 3.3095 - val_accuracy50: 0.3490 - 77s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 76s - loss: 3.1973 - accuracy50: 0.4258 - val_loss: 3.3108 - val_accuracy50: 0.3494 - 76s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 79s - loss: 3.1962 - accuracy50: 0.4267 - val_loss: 3.3084 - val_accuracy50: 0.3499 - 79s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 76s - loss: 3.1953 - accuracy50: 0.4268 - val_loss: 3.3074 - val_accuracy50: 0.3511 - 76s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 76s - loss: 3.1942 - accuracy50: 0.4274 - val_loss: 3.3055 - val_accuracy50: 0.3517 - 76s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 76s - loss: 3.1931 - accuracy50: 0.4281 - val_loss: 3.3068 - val_accuracy50: 0.3529 - 76s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 78s - loss: 3.1923 - accuracy50: 0.4283 - val_loss: 3.3061 - val_accuracy50: 0.3526 - 78s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 76s - loss: 3.1916 - accuracy50: 0.4287 - val_loss: 3.3028 - val_accuracy50: 0.3531 - 76s/epoch - 14ms/step
Epoch 12/50
5475/5475 - 78s - loss: 3.1907 - accuracy50: 0.4291 - val_loss: 3.3068 - val_accuracy50: 0.3528 - 78s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 77s - loss: 3.1900 - accuracy50: 0.4292 - val_loss: 3.3043 - val_accuracy50: 0.3544 - 77s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 76s - loss: 3.1890 - accuracy50: 0.4299 - val_loss: 3.3074 - val_accuracy50: 0.3538 - 76s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 77s - loss: 3.1882 - accuracy50: 0.4301 - val_loss: 3.3047 - val_accuracy50: 0.3548 - 77s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 75s - loss: 3.1875 - accuracy50: 0.4302 - val_loss: 3.3046 - val_accuracy50: 0.3554 - 75s/epoch - 14ms/step
Epoch 17/50
5475/5475 - 76s - loss: 3.1866 - accuracy50: 0.4308 - val_loss: 3.3069 - val_accuracy50: 0.3563 - 76s/epoch - 14ms/step
Epoch 18/50
5475/5475 - 75s - loss: 3.1861 - accuracy50: 0.4311 - val_loss: 3.3105 - val_accuracy50: 0.3553 - 75s/epoch - 14ms/step
Epoch 19/50
5475/5475 - 76s - loss: 3.1853 - accuracy50: 0.4314 - val_loss: 3.3093 - val_accuracy50: 0.3558 - 76s/epoch - 14ms/step
Epoch 20/50
5475/5475 - 76s - loss: 3.1846 - accuracy50: 0.4320 - val_loss: 3.3091 - val_accuracy50: 0.3557 - 76s/epoch - 14ms/step
Epoch 21/50
5475/5475 - 76s - loss: 3.1839 - accuracy50: 0.4321 - val_loss: 3.3059 - val_accuracy50: 0.3567 - 76s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h50
Evaluating performance on  test set...
13689/13689 - 77s - 77s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1058465
{'0': {'precision': 0.48494260367889674, 'recall': 0.10734362959354059, 'f1-score': 0.17577818392240216, 'support': 1143263}, '1': {'precision': 0.3460956275133684, 'recall': 0.9249685738715837, 'f1-score': 0.5037158290752269, 'support': 1213958}, '2': {'precision': 0.4805194805194805, 'recall': 0.0028386577054822885, 'f1-score': 0.005643973766615791, 'support': 1147021}, 'accuracy': 0.35638263567413436, 'macro avg': {'precision': 0.4371859039039152, 'recall': 0.3450502870568688, 'f1-score': 0.22837932892141496, 'support': 3504242}, 'weighted avg': {'precision': 0.43539470925796664, 'recall': 0.35638263567413436, 'f1-score': 0.23369513599572717, 'support': 3504242}}
[[ 122722 1019274    1267]
 [  88832 1122873    2253]
 [  41511 1102254    3256]]
Evaluating performance on  train set...
5475/5475 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1127415
{'0': {'precision': 0.49206148556403906, 'recall': 0.08359910400384857, 'f1-score': 0.14291719827071878, 'support': 465627}, '1': {'precision': 0.3300773405637086, 'recall': 0.9415172318386968, 'f1-score': 0.48879337915556176, 'support': 462632}, '2': {'precision': 0.4903134906657274, 'recall': 0.0029410149036775365, 'f1-score': 0.005846958384525723, 'support': 473306}, 'accuracy': 0.33954472322011464, 'macro avg': {'precision': 0.43748410559782497, 'recall': 0.3426857835820743, 'f1-score': 0.21251917860360212, 'support': 1401565}, 'weighted avg': {'precision': 0.4380030684066948, 'recall': 0.33954472322011464, 'f1-score': 0.21079647775867844, 'support': 1401565}}
[[ 38926 426183    518]
 [ 26127 435576    929]
 [ 14055 457859   1392]]
Evaluating performance on  val set...
2036/2036 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021416
{'0': {'precision': 0.4860403863037752, 'recall': 0.09757874513075716, 'f1-score': 0.1625279516174017, 'support': 170201}, '1': {'precision': 0.34372396256575577, 'recall': 0.9307392345830315, 'f1-score': 0.5020425517849603, 'support': 179510}, '2': {'precision': 0.49431230610134436, 'recall': 0.0027870907553715634, 'f1-score': 0.005542928707268425, 'support': 171505}, 'accuracy': 0.3533333589145383, 'macro avg': {'precision': 0.4413588849902918, 'recall': 0.34370169015638674, 'f1-score': 0.22337114403654346, 'support': 521216}, 'weighted avg': {'precision': 0.4397475909553405, 'recall': 0.3533333589145383, 'f1-score': 0.2278032876045472, 'support': 521216}}
[[ 16608 153425    168]
 [ 12112 167077    321]
 [  5450 165577    478]]
training model: results/AAPL/W3/deepOF_L1/h100
Epoch 1/50
5475/5475 - 77s - loss: 3.2421 - accuracy100: 0.4037 - val_loss: 3.4680 - val_accuracy100: 0.3534 - 77s/epoch - 14ms/step
Epoch 2/50
5475/5475 - 77s - loss: 3.2375 - accuracy100: 0.4063 - val_loss: 3.4584 - val_accuracy100: 0.3534 - 77s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 75s - loss: 3.2365 - accuracy100: 0.4073 - val_loss: 3.4401 - val_accuracy100: 0.3534 - 75s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 75s - loss: 3.2363 - accuracy100: 0.4069 - val_loss: 3.4227 - val_accuracy100: 0.3534 - 75s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 77s - loss: 3.2358 - accuracy100: 0.4073 - val_loss: 3.4293 - val_accuracy100: 0.3534 - 77s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 77s - loss: 3.2350 - accuracy100: 0.4074 - val_loss: 3.4349 - val_accuracy100: 0.3535 - 77s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 78s - loss: 3.2335 - accuracy100: 0.4083 - val_loss: 3.4392 - val_accuracy100: 0.3536 - 78s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 78s - loss: 3.2334 - accuracy100: 0.4083 - val_loss: 3.4362 - val_accuracy100: 0.3535 - 78s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 80s - loss: 3.2328 - accuracy100: 0.4084 - val_loss: 3.4498 - val_accuracy100: 0.3536 - 80s/epoch - 15ms/step
Epoch 10/50
5475/5475 - 78s - loss: 3.2324 - accuracy100: 0.4085 - val_loss: 3.4401 - val_accuracy100: 0.3536 - 78s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 80s - loss: 3.2314 - accuracy100: 0.4092 - val_loss: 3.4369 - val_accuracy100: 0.3535 - 80s/epoch - 15ms/step
Epoch 12/50
5475/5475 - 79s - loss: 3.2308 - accuracy100: 0.4093 - val_loss: 3.4504 - val_accuracy100: 0.3536 - 79s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 79s - loss: 3.2307 - accuracy100: 0.4095 - val_loss: 3.4462 - val_accuracy100: 0.3535 - 79s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 75s - loss: 3.2302 - accuracy100: 0.4095 - val_loss: 3.4543 - val_accuracy100: 0.3536 - 75s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h100
Evaluating performance on  test set...
13689/13689 - 71s - 71s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1832783
{'0': {'precision': 0.4993132725683606, 'recall': 0.0065386086939460235, 'f1-score': 0.012908182121893394, 'support': 1223196}, '1': {'precision': 0.30155808515405425, 'recall': 0.99457841756025, 'f1-score': 0.4627956430621841, 'support': 1056887}, '2': {'precision': 0.4496155402670983, 'recall': 0.000907561844498958, 'f1-score': 0.001811467190595371, 'support': 1224159}, 'accuracy': 0.3025664323411454, 'macro avg': {'precision': 0.4168289659965044, 'recall': 0.3340081960328983, 'f1-score': 0.15917176412489095, 'support': 3504242}, 'weighted avg': {'precision': 0.42230865558216935, 'recall': 0.3025664323411454, 'f1-score': 0.14471873215731282, 'support': 3504242}}
[[   7998 1214607     591]
 [   4961 1051157     769]
 [   3059 1219989    1111]]
Evaluating performance on  train set...
5475/5475 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1669004
{'0': {'precision': 0.45920090039392236, 'recall': 0.003476038338658147, 'f1-score': 0.006899846529148892, 'support': 469500}, '1': {'precision': 0.3276464339604814, 'recall': 0.9968096064600569, 'f1-score': 0.49318528199771255, 'support': 459191}, '2': {'precision': 0.4754754754754755, 'recall': 0.0010044959122303193, 'f1-score': 0.0020047565486955364, 'support': 472874}, 'accuracy': 0.32808539026017347, 'macro avg': {'precision': 0.4207742699432931, 'recall': 0.33376338023698177, 'f1-score': 0.16736329502518568, 'support': 1401565}, 'weighted avg': {'precision': 0.42159094039997, 'recall': 0.32808539026017347, 'f1-score': 0.16456869144096412, 'support': 1401565}}
[[  1632 467651    217]
 [  1158 457726    307]
 [   764 471635    475]]
Evaluating performance on  val set...
2036/2036 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1443795
{'0': {'precision': 0.4351798972015991, 'recall': 0.004513228735407523, 'f1-score': 0.008933805425938517, 'support': 168837}, '1': {'precision': 0.3529893324806509, 'recall': 0.9956480163430298, 'f1-score': 0.5211973833902162, 'support': 184054}, '2': {'precision': 0.47962382445141066, 'recall': 0.0009089558889053914, 'f1-score': 0.001814473091245464, 'support': 168325}, 'accuracy': 0.35334295186640474, 'macro avg': {'precision': 0.4225976847112202, 'recall': 0.3336900669891143, 'f1-score': 0.17731522063580005, 'support': 521216}, 'weighted avg': {'precision': 0.42050943784343503, 'recall': 0.35334295186640474, 'f1-score': 0.18752732320628282, 'support': 521216}}
[[   762 168010     65]
 [   700 183253    101]
 [   289 167883    153]]
training model: results/AAPL/W3/deepOF_L1/h200
Epoch 1/50
5475/5475 - 79s - loss: 3.2632 - accuracy200: 0.3875 - val_loss: 3.3861 - val_accuracy200: 0.3366 - 79s/epoch - 14ms/step
Epoch 2/50
5475/5475 - 76s - loss: 3.2584 - accuracy200: 0.3898 - val_loss: 3.3752 - val_accuracy200: 0.3366 - 76s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 77s - loss: 3.2575 - accuracy200: 0.3905 - val_loss: 3.3681 - val_accuracy200: 0.3368 - 77s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 78s - loss: 3.2569 - accuracy200: 0.3911 - val_loss: 3.3681 - val_accuracy200: 0.3368 - 78s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 78s - loss: 3.2567 - accuracy200: 0.3912 - val_loss: 3.3672 - val_accuracy200: 0.3370 - 78s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 77s - loss: 3.2561 - accuracy200: 0.3913 - val_loss: 3.3714 - val_accuracy200: 0.3369 - 77s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 78s - loss: 3.2557 - accuracy200: 0.3920 - val_loss: 3.3649 - val_accuracy200: 0.3370 - 78s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 79s - loss: 3.2554 - accuracy200: 0.3919 - val_loss: 3.3753 - val_accuracy200: 0.3369 - 79s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 81s - loss: 3.2551 - accuracy200: 0.3923 - val_loss: 3.3747 - val_accuracy200: 0.3370 - 81s/epoch - 15ms/step
Epoch 10/50
5475/5475 - 76s - loss: 3.2548 - accuracy200: 0.3923 - val_loss: 3.3774 - val_accuracy200: 0.3369 - 76s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 77s - loss: 3.2542 - accuracy200: 0.3928 - val_loss: 3.3828 - val_accuracy200: 0.3369 - 77s/epoch - 14ms/step
Epoch 12/50
5475/5475 - 77s - loss: 3.2536 - accuracy200: 0.3928 - val_loss: 3.3854 - val_accuracy200: 0.3370 - 77s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 77s - loss: 3.2531 - accuracy200: 0.3932 - val_loss: 3.3905 - val_accuracy200: 0.3370 - 77s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 79s - loss: 3.2528 - accuracy200: 0.3931 - val_loss: 3.3949 - val_accuracy200: 0.3370 - 79s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 76s - loss: 3.2523 - accuracy200: 0.3938 - val_loss: 3.3969 - val_accuracy200: 0.3370 - 76s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 79s - loss: 3.2520 - accuracy200: 0.3941 - val_loss: 3.3989 - val_accuracy200: 0.3370 - 79s/epoch - 14ms/step
Epoch 17/50
5475/5475 - 80s - loss: 3.2522 - accuracy200: 0.3938 - val_loss: 3.3999 - val_accuracy200: 0.3369 - 80s/epoch - 15ms/step
testing model: results/AAPL/W3/deepOF_L1/h200
Evaluating performance on  test set...
13689/13689 - 82s - 82s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1255312
{'0': {'precision': 0.4437732809825833, 'recall': 0.0037745898515938823, 'f1-score': 0.0074855104089011, 'support': 1167809}, '1': {'precision': 0.3336800582727138, 'recall': 0.9959766674079269, 'f1-score': 0.49988473867015476, 'support': 1169180}, '2': {'precision': 0.39481268011527376, 'recall': 0.0015258046027724923, 'f1-score': 0.0030398612689927318, 'support': 1167253}, 'accuracy': 0.3340708204513273, 'macro avg': {'precision': 0.39075533979019034, 'recall': 0.3337590206207644, 'f1-score': 0.1701367034493495, 'support': 3504242}, 'weighted avg': {'precision': 0.3907323658939293, 'recall': 0.3340708204513273, 'f1-score': 0.17029222649842551, 'support': 3504242}}
[[   4408 1162203    1198]
 [   3172 1164476    1532]
 [   2353 1163119    1781]]
Evaluating performance on  train set...
5475/5475 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1280075
{'0': {'precision': 0.4355475763016158, 'recall': 0.0025764053940965695, 'f1-score': 0.005122509480654397, 'support': 470811}, '1': {'precision': 0.32890842895616584, 'recall': 0.9970321066185324, 'f1-score': 0.49464098126334644, 'support': 460933}, '2': {'precision': 0.4033832140533507, 'recall': 0.0013196515268581012, 'f1-score': 0.0026306968376478175, 'support': 469821}, 'accuracy': 0.3292019991937584, 'macro avg': {'precision': 0.3892797397703774, 'recall': 0.333642721179829, 'f1-score': 0.1674647291938829, 'support': 1401565}, 'weighted avg': {'precision': 0.38969526482178973, 'recall': 0.3292019991937584, 'f1-score': 0.16527527574298373, 'support': 1401565}}
[[  1213 469183    415]
 [   866 459565    502]
 [   706 468495    620]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1236796
{'0': {'precision': 0.41566265060240964, 'recall': 0.0027799841143764893, 'f1-score': 0.005523029776334447, 'support': 173742}, '1': {'precision': 0.33663070929194, 'recall': 0.9966092229136748, 'f1-score': 0.5032691588247143, 'support': 175476}, '2': {'precision': 0.4309090909090909, 'recall': 0.0013779229991046408, 'f1-score': 0.002747061687182697, 'support': 171998}, 'accuracy': 0.3369063881385069, 'macro avg': {'precision': 0.39440081693448015, 'recall': 0.3335890433423853, 'f1-score': 0.17051308342941052, 'support': 521216}, 'weighted avg': {'precision': 0.3940864678038628, 'recall': 0.3369063881385069, 'f1-score': 0.17218145695718765, 'support': 521216}}
[[   483 173140    119]
 [   401 174881    194]
 [   278 171483    237]]
training model: results/AAPL/W3/deepOF_L1/h300
Epoch 1/50
5475/5475 - 80s - loss: 3.2685 - accuracy300: 0.3835 - val_loss: 3.3779 - val_accuracy300: 0.3446 - 80s/epoch - 15ms/step
Epoch 2/50
5475/5475 - 77s - loss: 3.2637 - accuracy300: 0.3852 - val_loss: 3.3710 - val_accuracy300: 0.3447 - 77s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 78s - loss: 3.2631 - accuracy300: 0.3851 - val_loss: 3.3705 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 4/50
5475/5475 - 78s - loss: 3.2629 - accuracy300: 0.3858 - val_loss: 3.3637 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 76s - loss: 3.2624 - accuracy300: 0.3860 - val_loss: 3.3627 - val_accuracy300: 0.3446 - 76s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 79s - loss: 3.2619 - accuracy300: 0.3862 - val_loss: 3.3595 - val_accuracy300: 0.3446 - 79s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 76s - loss: 3.2617 - accuracy300: 0.3863 - val_loss: 3.3564 - val_accuracy300: 0.3446 - 76s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 78s - loss: 3.2613 - accuracy300: 0.3866 - val_loss: 3.3581 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 79s - loss: 3.2609 - accuracy300: 0.3872 - val_loss: 3.3632 - val_accuracy300: 0.3446 - 79s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 78s - loss: 3.2606 - accuracy300: 0.3872 - val_loss: 3.3589 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 80s - loss: 3.2607 - accuracy300: 0.3871 - val_loss: 3.3585 - val_accuracy300: 0.3446 - 80s/epoch - 15ms/step
Epoch 12/50
5475/5475 - 78s - loss: 3.2605 - accuracy300: 0.3871 - val_loss: 3.3627 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 79s - loss: 3.2602 - accuracy300: 0.3872 - val_loss: 3.3588 - val_accuracy300: 0.3446 - 79s/epoch - 14ms/step
Epoch 14/50
5475/5475 - 76s - loss: 3.2599 - accuracy300: 0.3875 - val_loss: 3.3602 - val_accuracy300: 0.3446 - 76s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 78s - loss: 3.2597 - accuracy300: 0.3876 - val_loss: 3.3636 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 77s - loss: 3.2595 - accuracy300: 0.3876 - val_loss: 3.3635 - val_accuracy300: 0.3446 - 77s/epoch - 14ms/step
Epoch 17/50
5475/5475 - 78s - loss: 3.2591 - accuracy300: 0.3878 - val_loss: 3.3622 - val_accuracy300: 0.3446 - 78s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h300
Evaluating performance on  test set...
13689/13689 - 91s - 91s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116772
{'0': {'precision': 0.42736644798500467, 'recall': 0.0004020972546280865, 'f1-score': 0.0008034385761517936, 'support': 1134054}, '1': {'precision': 0.3530284638951471, 'recall': 0.9996596789017895, 'f1-score': 0.5217881486429098, 'support': 1237067}, '2': {'precision': 0.4312796208530806, 'recall': 8.030916380510114e-05, 'f1-score': 0.00016058842422167556, 'support': 1133121}, 'accuracy': 0.35305581064321473, 'macro avg': {'precision': 0.40389151091107744, 'recall': 0.3333806951067409, 'f1-score': 0.17425072521442778, 'support': 3504242}, 'weighted avg': {'precision': 0.4023890153160735, 'recall': 0.35305581064321473, 'f1-score': 0.18451351491253176, 'support': 3504242}}
[[    456 1133558      40]
 [    341 1236646      80]
 [    270 1132760      91]]
Evaluating performance on  train set...
5475/5475 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1300442
{'0': {'precision': 0.4066265060240964, 'recall': 0.00028609453411094533, 'f1-score': 0.0005717867701247766, 'support': 471872}, '1': {'precision': 0.3281267842868562, 'recall': 0.9996934022779559, 'f1-score': 0.4940822329428277, 'support': 459886}, '2': {'precision': 0.35398230088495575, 'recall': 8.514134527582603e-05, 'f1-score': 0.00017024174327545115, 'support': 469807}, 'accuracy': 0.3281474637280469, 'macro avg': {'precision': 0.3629118637319695, 'recall': 0.33335487938578096, 'f1-score': 0.1649414204854093, 'support': 1401565}, 'weighted avg': {'precision': 0.36322249756593944, 'recall': 0.3281474637280469, 'f1-score': 0.16236941755011047, 'support': 1401565}}
[[   135 471702     35]
 [   103 459745     38]
 [    94 469673     40]]
Evaluating performance on  val set...
2036/2036 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210573
{'0': {'precision': 0.48344370860927155, 'recall': 0.0004256683868334354, 'f1-score': 0.0008505878377591089, 'support': 171495}, '1': {'precision': 0.3445913136272295, 'recall': 0.9997104548086775, 'f1-score': 0.512521142139406, 'support': 179592}, '2': {'precision': 0.5476190476190477, 'recall': 0.00013519153113225845, 'f1-score': 0.0002703163288691963, 'support': 170129}, 'accuracy': 0.3446479002946955, 'macro avg': {'precision': 0.45855135661851626, 'recall': 0.3334237715755477, 'f1-score': 0.17121401543534479, 'support': 521216}, 'weighted avg': {'precision': 0.4565475790406845, 'recall': 0.3446479002946955, 'f1-score': 0.17696417064528125, 'support': 521216}}
[[    73 171416      6]
 [    39 179540     13]
 [    39 170067     23]]
training model: results/AAPL/W3/deepOF_L1/h500
Epoch 1/50
5475/5475 - 79s - loss: 3.2641 - accuracy500: 0.3840 - val_loss: 3.4233 - val_accuracy500: 0.3416 - 79s/epoch - 15ms/step
Epoch 2/50
5475/5475 - 78s - loss: 3.2576 - accuracy500: 0.3861 - val_loss: 3.4110 - val_accuracy500: 0.3415 - 78s/epoch - 14ms/step
Epoch 3/50
5475/5475 - 81s - loss: 3.2578 - accuracy500: 0.3868 - val_loss: 3.4066 - val_accuracy500: 0.3416 - 81s/epoch - 15ms/step
Epoch 4/50
5475/5475 - 76s - loss: 3.2576 - accuracy500: 0.3871 - val_loss: 3.4035 - val_accuracy500: 0.3416 - 76s/epoch - 14ms/step
Epoch 5/50
5475/5475 - 79s - loss: 3.2574 - accuracy500: 0.3875 - val_loss: 3.4012 - val_accuracy500: 0.3416 - 79s/epoch - 14ms/step
Epoch 6/50
5475/5475 - 78s - loss: 3.2572 - accuracy500: 0.3874 - val_loss: 3.3949 - val_accuracy500: 0.3416 - 78s/epoch - 14ms/step
Epoch 7/50
5475/5475 - 79s - loss: 3.2567 - accuracy500: 0.3876 - val_loss: 3.3928 - val_accuracy500: 0.3416 - 79s/epoch - 14ms/step
Epoch 8/50
5475/5475 - 77s - loss: 3.2566 - accuracy500: 0.3880 - val_loss: 3.3916 - val_accuracy500: 0.3416 - 77s/epoch - 14ms/step
Epoch 9/50
5475/5475 - 78s - loss: 3.2559 - accuracy500: 0.3883 - val_loss: 3.3895 - val_accuracy500: 0.3416 - 78s/epoch - 14ms/step
Epoch 10/50
5475/5475 - 77s - loss: 3.2558 - accuracy500: 0.3884 - val_loss: 3.3928 - val_accuracy500: 0.3416 - 77s/epoch - 14ms/step
Epoch 11/50
5475/5475 - 82s - loss: 3.2554 - accuracy500: 0.3889 - val_loss: 3.3948 - val_accuracy500: 0.3416 - 82s/epoch - 15ms/step
Epoch 12/50
5475/5475 - 74s - loss: 3.2551 - accuracy500: 0.3890 - val_loss: 3.3919 - val_accuracy500: 0.3416 - 74s/epoch - 14ms/step
Epoch 13/50
5475/5475 - 72s - loss: 3.2550 - accuracy500: 0.3891 - val_loss: 3.3930 - val_accuracy500: 0.3416 - 72s/epoch - 13ms/step
Epoch 14/50
5475/5475 - 77s - loss: 3.2545 - accuracy500: 0.3896 - val_loss: 3.3902 - val_accuracy500: 0.3416 - 77s/epoch - 14ms/step
Epoch 15/50
5475/5475 - 78s - loss: 3.2542 - accuracy500: 0.3898 - val_loss: 3.3941 - val_accuracy500: 0.3416 - 78s/epoch - 14ms/step
Epoch 16/50
5475/5475 - 78s - loss: 3.2540 - accuracy500: 0.3896 - val_loss: 3.3936 - val_accuracy500: 0.3416 - 78s/epoch - 14ms/step
Epoch 17/50
5475/5475 - 75s - loss: 3.2536 - accuracy500: 0.3901 - val_loss: 3.3897 - val_accuracy500: 0.3416 - 75s/epoch - 14ms/step
Epoch 18/50
5475/5475 - 77s - loss: 3.2534 - accuracy500: 0.3903 - val_loss: 3.3924 - val_accuracy500: 0.3416 - 77s/epoch - 14ms/step
Epoch 19/50
5475/5475 - 76s - loss: 3.2533 - accuracy500: 0.3902 - val_loss: 3.3921 - val_accuracy500: 0.3416 - 76s/epoch - 14ms/step
testing model: results/AAPL/W3/deepOF_L1/h500
Evaluating performance on  test set...
13689/13689 - 96s - 96s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124657
{'0': {'precision': 0.40040241448692154, 'recall': 0.00017506201945915512, 'f1-score': 0.00034997102626805146, 'support': 1136740}, '1': {'precision': 0.35352643635643344, 'recall': 0.9998280644088483, 'f1-score': 0.5223548632375871, 'support': 1238836}, '2': {'precision': 0.3170731707317073, 'recall': 3.4554066482023915e-05, 'f1-score': 6.910060250409954e-05, 'support': 1128666}, 'accuracy': 0.353531805166424, 'macro avg': {'precision': 0.35700067385835416, 'recall': 0.33334589349826316, 'f1-score': 0.17425797828878642, 'support': 3504242}, 'weighted avg': {'precision': 0.35699144758581025, 'recall': 0.353531805166424, 'f1-score': 0.18480111445465958, 'support': 3504242}}
[[    199 1136503      38]
 [    167 1238623      46]
 [    131 1128496      39]]
Evaluating performance on  train set...
5475/5475 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1386741
{'0': {'precision': 0.418848167539267, 'recall': 0.0001699599956660201, 'f1-score': 0.0003397821147189364, 'support': 470699}, '1': {'precision': 0.33013563630317394, 'recall': 0.9998357474141024, 'f1-score': 0.4963737035433576, 'support': 462702}, '2': {'precision': 0.39622641509433965, 'recall': 4.485607607590503e-05, 'f1-score': 8.970199715089372e-05, 'support': 468164}, 'accuracy': 0.330150224927135, 'macro avg': {'precision': 0.38173673964559357, 'recall': 0.33335018782861475, 'f1-score': 0.16560106255174248, 'support': 1401565}, 'weighted avg': {'precision': 0.38200495602954054, 'recall': 0.330150224927135, 'f1-score': 0.1640131108613078, 'support': 1401565}}
[[    80 470598     21]
 [    65 462626     11]
 [    46 468097     21]]
Evaluating performance on  val set...
2036/2036 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1315688
{'0': {'precision': 0.36065573770491804, 'recall': 0.00012768130745658836, 'f1-score': 0.00025527224204449856, 'support': 172304}, '1': {'precision': 0.3415870652303229, 'recall': 0.999848349537466, 'f1-score': 0.5092086575826792, 'support': 178041}, '2': {'precision': 0.5294117647058824, 'recall': 5.267131344698632e-05, 'f1-score': 0.00010533214737137773, 'support': 170871}, 'accuracy': 0.3415954230108055, 'macro avg': {'precision': 0.4105515225470411, 'recall': 0.33334290071945655, 'f1-score': 0.16985642065736503, 'support': 521216}, 'weighted avg': {'precision': 0.4094656467898893, 'recall': 0.3415954230108055, 'f1-score': 0.1740583582284974, 'support': 521216}}
[[    22 172279      3]
 [    22 178014      5]
 [    17 170845      9]]
training model: results/AAPL/W3/deepOF_L1/h1000
Epoch 1/50
5475/5475 - 100s - loss: 3.2641 - accuracy1000: 0.3855 - val_loss: 3.4265 - val_accuracy1000: 0.3407 - 100s/epoch - 18ms/step
Epoch 2/50
5475/5475 - 102s - loss: 3.2588 - accuracy1000: 0.3865 - val_loss: 3.4163 - val_accuracy1000: 0.3407 - 102s/epoch - 19ms/step
Epoch 3/50
5475/5475 - 105s - loss: 3.2580 - accuracy1000: 0.3875 - val_loss: 3.4071 - val_accuracy1000: 0.3407 - 105s/epoch - 19ms/step
Epoch 4/50
5475/5475 - 104s - loss: 3.2566 - accuracy1000: 0.3886 - val_loss: 3.4014 - val_accuracy1000: 0.3407 - 104s/epoch - 19ms/step
Epoch 5/50
5475/5475 - 102s - loss: 3.2560 - accuracy1000: 0.3894 - val_loss: 3.4030 - val_accuracy1000: 0.3407 - 102s/epoch - 19ms/step
Epoch 6/50
5475/5475 - 103s - loss: 3.2553 - accuracy1000: 0.3900 - val_loss: 3.4048 - val_accuracy1000: 0.3407 - 103s/epoch - 19ms/step
Epoch 7/50
5475/5475 - 98s - loss: 3.2548 - accuracy1000: 0.3903 - val_loss: 3.4077 - val_accuracy1000: 0.3407 - 98s/epoch - 18ms/step
Epoch 8/50
5475/5475 - 99s - loss: 3.2541 - accuracy1000: 0.3909 - val_loss: 3.4070 - val_accuracy1000: 0.3407 - 99s/epoch - 18ms/step
Epoch 9/50
5475/5475 - 98s - loss: 3.2536 - accuracy1000: 0.3912 - val_loss: 3.4080 - val_accuracy1000: 0.3407 - 98s/epoch - 18ms/step
Epoch 10/50
5475/5475 - 88s - loss: 3.2530 - accuracy1000: 0.3917 - val_loss: 3.4084 - val_accuracy1000: 0.3407 - 88s/epoch - 16ms/step
Epoch 11/50
5475/5475 - 85s - loss: 3.2525 - accuracy1000: 0.3922 - val_loss: 3.4073 - val_accuracy1000: 0.3407 - 85s/epoch - 15ms/step
Epoch 12/50
5475/5475 - 89s - loss: 3.2520 - accuracy1000: 0.3925 - val_loss: 3.4085 - val_accuracy1000: 0.3407 - 89s/epoch - 16ms/step
Epoch 13/50
5475/5475 - 86s - loss: 3.2515 - accuracy1000: 0.3927 - val_loss: 3.4079 - val_accuracy1000: 0.3407 - 86s/epoch - 16ms/step
Epoch 14/50
5475/5475 - 87s - loss: 3.2512 - accuracy1000: 0.3928 - val_loss: 3.4080 - val_accuracy1000: 0.3407 - 87s/epoch - 16ms/step
testing model: results/AAPL/W3/deepOF_L1/h1000
Evaluating performance on  test set...
13689/13689 - 83s - 83s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1352249
{'0': {'precision': 0.31683168316831684, 'recall': 2.7360506306169196e-05, 'f1-score': 5.4716287499893124e-05, 'support': 1169569}, '1': {'precision': 0.3385754031865658, 'recall': 0.9999384718601474, 'f1-score': 0.5058663605709617, 'support': 1186449}, '2': {'precision': 0.3898305084745763, 'recall': 4.006186946101109e-05, 'f1-score': 8.011550565946382e-05, 'support': 1148224}, 'accuracy': 0.3385765024219218, 'macro avg': {'precision': 0.34841253160981966, 'recall': 0.33333529807863815, 'f1-score': 0.16866706412137367, 'support': 3504242}, 'weighted avg': {'precision': 0.3481128612548719, 'recall': 0.3385765024219218, 'f1-score': 0.17131825446218676, 'support': 3504242}}
[[     32 1169501      36]
 [     37 1186376      36]
 [     32 1148146      46]]
Evaluating performance on  train set...
5475/5475 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.140348
{'0': {'precision': 0.36585365853658536, 'recall': 3.197135366711427e-05, 'f1-score': 6.393711997374316e-05, 'support': 469170}, '1': {'precision': 0.33201734732612004, 'recall': 0.9999269368713078, 'f1-score': 0.49850897374433206, 'support': 465351}, '2': {'precision': 0.25, 'recall': 2.1411258896378073e-05, 'f1-score': 4.281885057077528e-05, 'support': 467044}, 'accuracy': 0.3320159964040198, 'macro avg': {'precision': 0.3159570019542351, 'recall': 0.33332677316129045, 'f1-score': 0.1662052432382922, 'support': 1401565}, 'weighted avg': {'precision': 0.31601328912406274, 'recall': 0.3320159964040198, 'f1-score': 0.1655518260706587, 'support': 1401565}}
[[    15 469141     14]
 [    18 465317     16]
 [     8 467026     10]]
Evaluating performance on  val set...
2036/2036 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1345781
{'0': {'precision': 0.14285714285714285, 'recall': 1.1670722242645986e-05, 'f1-score': 2.3339537760454654e-05, 'support': 171369}, '1': {'precision': 0.340722235972885, 'recall': 0.9999380599242079, 'f1-score': 0.508258703050182, 'support': 177591}, '2': {'precision': 0.3333333333333333, 'recall': 2.902656511239086e-05, 'f1-score': 5.8048075416059584e-05, 'support': 172256}, 'accuracy': 0.3407167086198428, 'macro avg': {'precision': 0.27230423738778703, 'recall': 0.33332625240385433, 'f1-score': 0.16944669688778616, 'support': 521216}, 'weighted avg': {'precision': 0.27322483383014523, 'recall': 0.3407167086198428, 'f1-score': 0.17320299095942984, 'support': 521216}}
[[     2 171363      4]
 [     5 177580      6]
 [     7 172244      5]]
training model: results/AAPL/W3/deepLOB_L2/h10
Epoch 1/50
5475/5475 - 245s - loss: 3.1451 - accuracy10: 0.4453 - val_loss: 3.2536 - val_accuracy10: 0.3867 - 245s/epoch - 45ms/step
Epoch 2/50
5475/5475 - 244s - loss: 3.0813 - accuracy10: 0.4698 - val_loss: 3.2120 - val_accuracy10: 0.3956 - 244s/epoch - 45ms/step
Epoch 3/50
5475/5475 - 243s - loss: 3.0421 - accuracy10: 0.4832 - val_loss: 3.1544 - val_accuracy10: 0.4166 - 243s/epoch - 44ms/step
Epoch 4/50
5475/5475 - 236s - loss: 3.0231 - accuracy10: 0.4888 - val_loss: 3.1523 - val_accuracy10: 0.4134 - 236s/epoch - 43ms/step
Epoch 5/50
5475/5475 - 239s - loss: 3.0111 - accuracy10: 0.4924 - val_loss: 3.1518 - val_accuracy10: 0.4115 - 239s/epoch - 44ms/step
Epoch 6/50
5475/5475 - 238s - loss: 3.0017 - accuracy10: 0.4958 - val_loss: 3.1196 - val_accuracy10: 0.4275 - 238s/epoch - 43ms/step
Epoch 7/50
5475/5475 - 238s - loss: 2.9946 - accuracy10: 0.4976 - val_loss: 3.1251 - val_accuracy10: 0.4308 - 238s/epoch - 43ms/step
Epoch 8/50
5475/5475 - 239s - loss: 2.9886 - accuracy10: 0.4996 - val_loss: 3.1351 - val_accuracy10: 0.4285 - 239s/epoch - 44ms/step
Epoch 9/50
5475/5475 - 237s - loss: 2.9828 - accuracy10: 0.5013 - val_loss: 3.1132 - val_accuracy10: 0.4383 - 237s/epoch - 43ms/step
Epoch 10/50
5475/5475 - 237s - loss: 2.9777 - accuracy10: 0.5027 - val_loss: 3.1283 - val_accuracy10: 0.4352 - 237s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 234s - loss: 2.9738 - accuracy10: 0.5035 - val_loss: 3.1368 - val_accuracy10: 0.4351 - 234s/epoch - 43ms/step
Epoch 12/50
5475/5475 - 237s - loss: 2.9703 - accuracy10: 0.5048 - val_loss: 3.1296 - val_accuracy10: 0.4376 - 237s/epoch - 43ms/step
Epoch 13/50
5475/5475 - 238s - loss: 2.9671 - accuracy10: 0.5058 - val_loss: 3.1547 - val_accuracy10: 0.4332 - 238s/epoch - 43ms/step
Epoch 14/50
5475/5475 - 235s - loss: 2.9638 - accuracy10: 0.5068 - val_loss: 3.1518 - val_accuracy10: 0.4338 - 235s/epoch - 43ms/step
Epoch 15/50
5475/5475 - 238s - loss: 2.9609 - accuracy10: 0.5074 - val_loss: 3.1690 - val_accuracy10: 0.4323 - 238s/epoch - 44ms/step
Epoch 16/50
5475/5475 - 241s - loss: 2.9589 - accuracy10: 0.5078 - val_loss: 3.1754 - val_accuracy10: 0.4321 - 241s/epoch - 44ms/step
Epoch 17/50
5475/5475 - 241s - loss: 2.9560 - accuracy10: 0.5090 - val_loss: 3.1714 - val_accuracy10: 0.4315 - 241s/epoch - 44ms/step
Epoch 18/50
5475/5475 - 239s - loss: 2.9539 - accuracy10: 0.5095 - val_loss: 3.1658 - val_accuracy10: 0.4317 - 239s/epoch - 44ms/step
Epoch 19/50
5475/5475 - 239s - loss: 2.9516 - accuracy10: 0.5098 - val_loss: 3.1511 - val_accuracy10: 0.4376 - 239s/epoch - 44ms/step
testing model: results/AAPL/W3/deepLOB_L2/h10
Evaluating performance on  test set...
13689/13689 - 209s - 209s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0218478
{'0': {'precision': 0.48354503714573654, 'recall': 0.5201490831572417, 'f1-score': 0.5011795977457076, 'support': 1071885}, '1': {'precision': 0.4751461260357552, 'recall': 0.2934636346043933, 'f1-score': 0.3628320020253624, 'support': 1333218}, '2': {'precision': 0.44899583515241326, 'recall': 0.6240953178976711, 'f1-score': 0.5222598242054414, 'support': 1099143}, 'accuracy': 0.46650862981651403, 'macro avg': {'precision': 0.469228999444635, 'recall': 0.4792360118864354, 'f1-score': 0.4620904746588372, 'support': 3504246}, 'weighted avg': {'precision': 0.4695128907157272, 'recall': 0.46650862981651403, 'f1-score': 0.4551561959869681, 'support': 3504246}}
[[557540 219511 294834]
 [394984 391251 546983]
 [200502 212671 685970]]
Evaluating performance on  train set...
5475/5475 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0570266
{'0': {'precision': 0.44307088195600636, 'recall': 0.5087580527315168, 'f1-score': 0.47364788127601004, 'support': 463973}, '1': {'precision': 0.39911614011407764, 'recall': 0.4082020582556004, 'f1-score': 0.40360797070251253, 'support': 465054}, '2': {'precision': 0.4880330445664172, 'recall': 0.40605748943473446, 'f1-score': 0.44328726298219373, 'support': 472539}, 'accuracy': 0.4407669706599618, 'macro avg': {'precision': 0.4434066888788337, 'recall': 0.4410058668072839, 'f1-score': 0.44018103832023875, 'support': 1401566}, 'weighted avg': {'precision': 0.44364527291954614, 'recall': 0.4407669706599618, 'f1-score': 0.4401718146621017, 'support': 1401566}}
[[236050 140754  87169]
 [161099 189836 114119]
 [135610 145051 191878]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0376904
{'0': {'precision': 0.4777177505755773, 'recall': 0.3933026386577752, 'f1-score': 0.43141964104974595, 'support': 159854}, '1': {'precision': 0.39571391749413914, 'recall': 0.49919742349716906, 'f1-score': 0.4414724878471826, 'support': 193751}, '2': {'precision': 0.4738411736345478, 'recall': 0.4104563542965557, 'f1-score': 0.4398771103672942, 'support': 167611}, 'accuracy': 0.438183018172888, 'macro avg': {'precision': 0.4490909472347548, 'recall': 0.43431880548383334, 'f1-score': 0.4375897464214076, 'support': 521216}, 'weighted avg': {'precision': 0.44598794642331674, 'recall': 0.438183018172888, 'f1-score': 0.4378763001116967, 'support': 521216}}
[[62871 71678 25305]
 [45943 96720 51088]
 [22793 76021 68797]]
training model: results/AAPL/W3/deepLOB_L2/h20
Epoch 1/50
5475/5475 - 244s - loss: 3.1935 - accuracy20: 0.4214 - val_loss: 3.3005 - val_accuracy20: 0.3651 - 244s/epoch - 45ms/step
Epoch 2/50
5475/5475 - 238s - loss: 3.1309 - accuracy20: 0.4498 - val_loss: 3.3928 - val_accuracy20: 0.3887 - 238s/epoch - 43ms/step
Epoch 3/50
5475/5475 - 238s - loss: 3.1003 - accuracy20: 0.4617 - val_loss: 3.2638 - val_accuracy20: 0.3990 - 238s/epoch - 43ms/step
Epoch 4/50
5475/5475 - 236s - loss: 3.0854 - accuracy20: 0.4674 - val_loss: 3.3010 - val_accuracy20: 0.4155 - 236s/epoch - 43ms/step
Epoch 5/50
5475/5475 - 234s - loss: 3.0766 - accuracy20: 0.4709 - val_loss: 3.3131 - val_accuracy20: 0.4150 - 234s/epoch - 43ms/step
Epoch 6/50
5475/5475 - 240s - loss: 3.0695 - accuracy20: 0.4731 - val_loss: 3.3202 - val_accuracy20: 0.4128 - 240s/epoch - 44ms/step
Epoch 7/50
5475/5475 - 232s - loss: 3.0643 - accuracy20: 0.4751 - val_loss: 3.2973 - val_accuracy20: 0.4086 - 232s/epoch - 42ms/step
Epoch 8/50
5475/5475 - 234s - loss: 3.0596 - accuracy20: 0.4766 - val_loss: 3.3641 - val_accuracy20: 0.4213 - 234s/epoch - 43ms/step
Epoch 9/50
5475/5475 - 238s - loss: 3.0558 - accuracy20: 0.4781 - val_loss: 3.3769 - val_accuracy20: 0.4213 - 238s/epoch - 43ms/step
Epoch 10/50
5475/5475 - 236s - loss: 3.0521 - accuracy20: 0.4792 - val_loss: 3.3260 - val_accuracy20: 0.4219 - 236s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 238s - loss: 3.0494 - accuracy20: 0.4798 - val_loss: 3.3292 - val_accuracy20: 0.4199 - 238s/epoch - 44ms/step
Epoch 12/50
5475/5475 - 237s - loss: 3.0472 - accuracy20: 0.4806 - val_loss: 3.3362 - val_accuracy20: 0.4276 - 237s/epoch - 43ms/step
Epoch 13/50
5475/5475 - 236s - loss: 3.0448 - accuracy20: 0.4811 - val_loss: 3.3337 - val_accuracy20: 0.4221 - 236s/epoch - 43ms/step
testing model: results/AAPL/W3/deepLOB_L2/h20
Evaluating performance on  test set...
13689/13689 - 206s - 206s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0578696
{'0': {'precision': 0.4790417847472367, 'recall': 0.4566556828285998, 'f1-score': 0.4675809455462711, 'support': 1147140}, '1': {'precision': 0.3652130999854268, 'recall': 0.4645906698115036, 'f1-score': 0.4089511398283665, 'support': 1186707}, '2': {'precision': 0.4857900349908389, 'recall': 0.3740109142266868, 'f1-score': 0.42263450691578824, 'support': 1170399}, 'accuracy': 0.4317399520467456, 'macro avg': {'precision': 0.44334830657450075, 'recall': 0.43175242228893, 'f1-score': 0.4330555307634753, 'support': 3504246}, 'weighted avg': {'precision': 0.4427477712359788, 'recall': 0.4317399520467456, 'f1-score': 0.43271419598566496, 'support': 3504246}}
[[523848 447596 175696]
 [347719 551333 287655]
 [221966 510691 437742]]
Evaluating performance on  train set...
5475/5475 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0875171
{'0': {'precision': 0.4392785756970059, 'recall': 0.3676187191481106, 'f1-score': 0.40026662222962844, 'support': 463910}, '1': {'precision': 0.3487672525657662, 'recall': 0.5471995351389741, 'f1-score': 0.42600971619625744, 'support': 464655}, '2': {'precision': 0.481833338023017, 'recall': 0.2896209521755768, 'f1-score': 0.3617817203718938, 'support': 473001}, 'accuracy': 0.40083164117851033, 'macro avg': {'precision': 0.42329305542859635, 'recall': 0.40147973548755383, 'f1-score': 0.39601935293259327, 'support': 1401566}, 'weighted avg': {'precision': 0.42363315213894254, 'recall': 0.40083164117851033, 'f1-score': 0.39581321815408266, 'support': 1401566}}
[[170542 233266  60102]
 [123177 254259  87219]
 [ 94513 241497 136991]]
Evaluating performance on  val set...
2036/2036 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880454
{'0': {'precision': 0.45080580458366765, 'recall': 0.3077110814800705, 'f1-score': 0.3657609849288898, 'support': 167992}, '1': {'precision': 0.3436662169630934, 'recall': 0.5572526732386683, 'f1-score': 0.4251413089176438, 'support': 179651}, '2': {'precision': 0.4888281487266259, 'recall': 0.32456084759726456, 'f1-score': 0.3901072647826659, 'support': 173573}, 'accuracy': 0.3993334817043222, 'macro avg': {'precision': 0.42776672342446237, 'recall': 0.3965082007720011, 'f1-score': 0.3936698528763998, 'support': 521216}, 'weighted avg': {'precision': 0.4265393167634586, 'recall': 0.3993334817043222, 'f1-score': 0.3943356860469735, 'support': 521216}}
[[ 51693  95668  20631]
 [ 41261 100111  38279]
 [ 21714  95524  56335]]
training model: results/AAPL/W3/deepLOB_L2/h30
Epoch 1/50
5475/5475 - 241s - loss: 3.1996 - accuracy30: 0.4202 - val_loss: 3.3854 - val_accuracy30: 0.3359 - 241s/epoch - 44ms/step
Epoch 2/50
5475/5475 - 241s - loss: 3.1443 - accuracy30: 0.4467 - val_loss: 3.3929 - val_accuracy30: 0.3447 - 241s/epoch - 44ms/step
Epoch 3/50
5475/5475 - 241s - loss: 3.1144 - accuracy30: 0.4583 - val_loss: 3.2999 - val_accuracy30: 0.3715 - 241s/epoch - 44ms/step
Epoch 4/50
5475/5475 - 239s - loss: 3.1023 - accuracy30: 0.4632 - val_loss: 3.3129 - val_accuracy30: 0.3611 - 239s/epoch - 44ms/step
Epoch 5/50
5475/5475 - 236s - loss: 3.0944 - accuracy30: 0.4663 - val_loss: 3.3215 - val_accuracy30: 0.3640 - 236s/epoch - 43ms/step
Epoch 6/50
5475/5475 - 238s - loss: 3.0885 - accuracy30: 0.4683 - val_loss: 3.3545 - val_accuracy30: 0.3644 - 238s/epoch - 43ms/step
Epoch 7/50
5475/5475 - 237s - loss: 3.0840 - accuracy30: 0.4696 - val_loss: 3.3631 - val_accuracy30: 0.3691 - 237s/epoch - 43ms/step
Epoch 8/50
5475/5475 - 240s - loss: 3.0804 - accuracy30: 0.4710 - val_loss: 3.3535 - val_accuracy30: 0.3737 - 240s/epoch - 44ms/step
Epoch 9/50
5475/5475 - 238s - loss: 3.0773 - accuracy30: 0.4715 - val_loss: 3.3950 - val_accuracy30: 0.3697 - 238s/epoch - 44ms/step
Epoch 10/50
5475/5475 - 237s - loss: 3.0744 - accuracy30: 0.4729 - val_loss: 3.3898 - val_accuracy30: 0.3728 - 237s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 236s - loss: 3.0720 - accuracy30: 0.4734 - val_loss: 3.3604 - val_accuracy30: 0.3803 - 236s/epoch - 43ms/step
Epoch 12/50
5475/5475 - 238s - loss: 3.0693 - accuracy30: 0.4743 - val_loss: 3.3829 - val_accuracy30: 0.3738 - 238s/epoch - 43ms/step
Epoch 13/50
5475/5475 - 235s - loss: 3.0671 - accuracy30: 0.4752 - val_loss: 3.3807 - val_accuracy30: 0.3806 - 235s/epoch - 43ms/step
testing model: results/AAPL/W3/deepLOB_L2/h30
Evaluating performance on  test set...
13689/13689 - 200s - 200s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0667669
{'0': {'precision': 0.5007865162285072, 'recall': 0.3683895451299488, 'f1-score': 0.4245043671182021, 'support': 1221096}, '1': {'precision': 0.339676574258691, 'recall': 0.25100118330423254, 'f1-score': 0.2886826903096211, 'support': 1037772}, '2': {'precision': 0.44388373185553154, 'recall': 0.6555110175384502, 'f1-score': 0.529328845526642, 'support': 1245378}, 'accuracy': 0.43566576090833803, 'macro avg': {'precision': 0.42811560744757654, 'recall': 0.4249672486575438, 'f1-score': 0.41417196765148834, 'support': 3504246}, 'weighted avg': {'precision': 0.43285154177330415, 'recall': 0.43566576090833803, 'f1-score': 0.42153487413350615, 'support': 3504246}}
[[449839 272167 499090]
 [253611 260482 523679]
 [194815 234204 816359]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031387
{'0': {'precision': 0.38494205846723506, 'recall': 0.3628435267453184, 'f1-score': 0.37356626511368957, 'support': 464156}, '1': {'precision': 0.34797405083483995, 'recall': 0.3105074042281529, 'f1-score': 0.3281748284107565, 'support': 463654}, '2': {'precision': 0.42516045093435867, 'recall': 0.4938744839115494, 'f1-score': 0.45694867588469645, 'support': 473756}, 'accuracy': 0.389821100112303, 'macro avg': {'precision': 0.38602552007881125, 'recall': 0.3890751382950069, 'f1-score': 0.3862299231363808, 'support': 1401566}, 'weighted avg': {'precision': 0.3863072029776357, 'recall': 0.389821100112303, 'f1-score': 0.38673510354453583, 'support': 1401566}}
[[168416 142507 153233]
 [156571 143968 163115]
 [112523 127257 233976]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0998219
{'0': {'precision': 0.4316154529871119, 'recall': 0.3067547293257679, 'f1-score': 0.35862792031809454, 'support': 177298}, '1': {'precision': 0.2738281642796604, 'recall': 0.3536746015548175, 'f1-score': 0.308671362642701, 'support': 161691}, '2': {'precision': 0.4393273559443899, 'recall': 0.4493132192265691, 'f1-score': 0.4442641808375566, 'support': 182227}, 'accuracy': 0.3711513077111984, 'macro avg': {'precision': 0.3815903244037207, 'recall': 0.3699141833690515, 'f1-score': 0.3705211545994507, 'support': 521216}, 'weighted avg': {'precision': 0.3853630978057655, 'recall': 0.3711513077111984, 'f1-score': 0.3730705181634944, 'support': 521216}}
[[54387 77857 45054]
 [45067 57186 59438]
 [26554 73796 81877]]
training model: results/AAPL/W3/deepLOB_L2/h50
Epoch 1/50
5475/5475 - 246s - loss: 3.2372 - accuracy50: 0.3986 - val_loss: 3.5242 - val_accuracy50: 0.3462 - 246s/epoch - 45ms/step
Epoch 2/50
5475/5475 - 239s - loss: 3.2002 - accuracy50: 0.4217 - val_loss: 3.5520 - val_accuracy50: 0.3487 - 239s/epoch - 44ms/step
Epoch 3/50
5475/5475 - 238s - loss: 3.1797 - accuracy50: 0.4320 - val_loss: 3.5944 - val_accuracy50: 0.3496 - 238s/epoch - 43ms/step
Epoch 4/50
5475/5475 - 239s - loss: 3.1669 - accuracy50: 0.4383 - val_loss: 3.5907 - val_accuracy50: 0.3514 - 239s/epoch - 44ms/step
Epoch 5/50
5475/5475 - 239s - loss: 3.1582 - accuracy50: 0.4421 - val_loss: 3.5544 - val_accuracy50: 0.3511 - 239s/epoch - 44ms/step
Epoch 6/50
5475/5475 - 237s - loss: 3.1517 - accuracy50: 0.4448 - val_loss: 3.6055 - val_accuracy50: 0.3525 - 237s/epoch - 43ms/step
Epoch 7/50
5475/5475 - 237s - loss: 3.1468 - accuracy50: 0.4470 - val_loss: 3.5856 - val_accuracy50: 0.3530 - 237s/epoch - 43ms/step
Epoch 8/50
5475/5475 - 243s - loss: 3.1432 - accuracy50: 0.4483 - val_loss: 3.6015 - val_accuracy50: 0.3534 - 243s/epoch - 44ms/step
Epoch 9/50
5475/5475 - 241s - loss: 3.1402 - accuracy50: 0.4496 - val_loss: 3.5988 - val_accuracy50: 0.3534 - 241s/epoch - 44ms/step
Epoch 10/50
5475/5475 - 239s - loss: 3.1375 - accuracy50: 0.4505 - val_loss: 3.5941 - val_accuracy50: 0.3525 - 239s/epoch - 44ms/step
Epoch 11/50
5475/5475 - 238s - loss: 3.1352 - accuracy50: 0.4512 - val_loss: 3.6126 - val_accuracy50: 0.3528 - 238s/epoch - 43ms/step
testing model: results/AAPL/W3/deepLOB_L2/h50
Evaluating performance on  test set...
13689/13689 - 203s - 203s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1741359
{'0': {'precision': 0.3769389865563599, 'recall': 0.0025505897582800137, 'f1-score': 0.005066893947094747, 'support': 1143265}, '1': {'precision': 0.3464583712062812, 'recall': 0.9921875450488855, 'f1-score': 0.5135811891921855, 'support': 1213959}, '2': {'precision': 0.3672774606989086, 'recall': 0.006395692497615565, 'f1-score': 0.012572450976695721, 'support': 1147022}, 'accuracy': 0.3466443280523114, 'macro avg': {'precision': 0.3635582728205166, 'recall': 0.3337112757682604, 'f1-score': 0.17707351137199198, 'support': 3504246}, 'weighted avg': {'precision': 0.3632172900653511, 'recall': 0.3466443280523114, 'f1-score': 0.18368578781945477, 'support': 3504246}}
[[   2916 1134461    5888]
 [   2734 1204475    6750]
 [   2086 1137600    7336]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1964935
{'0': {'precision': 0.38744740532959326, 'recall': 0.023724002894113656, 'f1-score': 0.044710323633958, 'support': 465773}, '1': {'precision': 0.3297729897151176, 'recall': 0.9517660077547863, 'f1-score': 0.489827812506952, 'support': 462682}, '2': {'precision': 0.3683135215453195, 'recall': 0.02933983779704974, 'f1-score': 0.054350145556275556, 'support': 473111}, 'accuracy': 0.33198293908385335, 'macro avg': {'precision': 0.36184463886334345, 'recall': 0.33494328281531655, 'f1-score': 0.19629609389906189, 'support': 1401566}, 'weighted avg': {'precision': 0.3619492376682784, 'recall': 0.33198293908385335, 'f1-score': 0.19490557364446354, 'support': 1401566}}
[[ 11050 444039  10684]
 [  9194 440365  13123]
 [  8276 450954  13881]]
Evaluating performance on  val set...
2036/2036 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1775054
{'0': {'precision': 0.39408913360628733, 'recall': 0.04924086509625901, 'f1-score': 0.08754331951638954, 'support': 170062}, '1': {'precision': 0.34299826787546256, 'recall': 0.913050007508635, 'f1-score': 0.4986664560538035, 'support': 179793}, '2': {'precision': 0.3714192098857892, 'recall': 0.04630575218398585, 'f1-score': 0.08234531067583344, 'support': 171361}, 'accuracy': 0.3462460860756385, 'macro avg': {'precision': 0.3695022037891797, 'recall': 0.3361988749296266, 'f1-score': 0.22285169541534214, 'support': 521216}, 'weighted avg': {'precision': 0.36901215818532856, 'recall': 0.3462460860756385, 'f1-score': 0.227650925757458, 'support': 521216}}
[[  8374 156303   5385]
 [  7589 164160   8044]
 [  5286 158140   7935]]
training model: results/AAPL/W3/deepLOB_L2/h100
Epoch 1/50
5475/5475 - 242s - loss: 3.2555 - accuracy100: 0.3879 - val_loss: 3.4321 - val_accuracy100: 0.3500 - 242s/epoch - 44ms/step
Epoch 2/50
5475/5475 - 238s - loss: 3.2382 - accuracy100: 0.3990 - val_loss: 3.5803 - val_accuracy100: 0.3469 - 238s/epoch - 43ms/step
Epoch 3/50
5475/5475 - 237s - loss: 3.2281 - accuracy100: 0.4063 - val_loss: 3.5488 - val_accuracy100: 0.3507 - 237s/epoch - 43ms/step
Epoch 4/50
5475/5475 - 240s - loss: 3.2205 - accuracy100: 0.4118 - val_loss: 3.6079 - val_accuracy100: 0.3523 - 240s/epoch - 44ms/step
Epoch 5/50
5475/5475 - 239s - loss: 3.2152 - accuracy100: 0.4143 - val_loss: 3.6770 - val_accuracy100: 0.3526 - 239s/epoch - 44ms/step
Epoch 6/50
5475/5475 - 241s - loss: 3.2109 - accuracy100: 0.4167 - val_loss: 3.6381 - val_accuracy100: 0.3521 - 241s/epoch - 44ms/step
Epoch 7/50
5475/5475 - 241s - loss: 3.2069 - accuracy100: 0.4188 - val_loss: 3.6115 - val_accuracy100: 0.3518 - 241s/epoch - 44ms/step
Epoch 8/50
5475/5475 - 241s - loss: 3.2037 - accuracy100: 0.4203 - val_loss: 3.5707 - val_accuracy100: 0.3528 - 241s/epoch - 44ms/step
Epoch 9/50
5475/5475 - 240s - loss: 3.2011 - accuracy100: 0.4216 - val_loss: 3.6343 - val_accuracy100: 0.3535 - 240s/epoch - 44ms/step
Epoch 10/50
5475/5475 - 238s - loss: 3.1985 - accuracy100: 0.4229 - val_loss: 3.6989 - val_accuracy100: 0.3523 - 238s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 236s - loss: 3.1962 - accuracy100: 0.4241 - val_loss: 3.7097 - val_accuracy100: 0.3522 - 236s/epoch - 43ms/step
testing model: results/AAPL/W3/deepLOB_L2/h100
Evaluating performance on  test set...
13689/13689 - 197s - 197s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.163794
{'0': {'precision': 0.3548230731943771, 'recall': 0.0005984313251002699, 'f1-score': 0.0011948474651523224, 'support': 1223198}, '1': {'precision': 0.30165927134761866, 'recall': 0.9248643186411427, 'f1-score': 0.45493441583011923, 'support': 1056888}, '2': {'precision': 0.352036510149134, 'recall': 0.07529979741210299, 'f1-score': 0.12406283962705375, 'support': 1224160}, 'accuracy': 0.30545486817991657, 'macro avg': {'precision': 0.33617295156370997, 'recall': 0.33358751579278195, 'f1-score': 0.1933973676407751, 'support': 3504246}, 'weighted avg': {'precision': 0.33781531083303556, 'recall': 0.30545486817991657, 'f1-score': 0.1809658984173476, 'support': 3504246}}
[[    732 1131566   90900]
 [    644  977478   78766]
 [    687 1131294   92179]]
Evaluating performance on  train set...
5475/5475 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1574926
{'0': {'precision': 0.33056564608199274, 'recall': 0.0027132245203939074, 'f1-score': 0.0053822722990414145, 'support': 469552}, '1': {'precision': 0.328268173372265, 'recall': 0.9430145056362392, 'f1-score': 0.48700679139306813, 'support': 458994}, '2': {'precision': 0.34239913089613705, 'recall': 0.0573020168280411, 'f1-score': 0.09817415272500733, 'support': 473020}, 'accuracy': 0.32907262305164364, 'macro avg': {'precision': 0.3337443167834649, 'recall': 0.33434324899489143, 'f1-score': 0.1968544054723723, 'support': 1401566}, 'weighted avg': {'precision': 0.3338069838412262, 'recall': 0.32907262305164364, 'f1-score': 0.1944245149020541, 'support': 1401566}}
[[  1274 441019  27259]
 [  1358 432838  24798]
 [  1222 444693  27105]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1467104
{'0': {'precision': 0.34383561643835614, 'recall': 0.002973176264340245, 'f1-score': 0.005895374714479487, 'support': 168843}, '1': {'precision': 0.35216765761955704, 'recall': 0.9233783952731167, 'f1-score': 0.5098741920331127, 'support': 183969}, '2': {'precision': 0.3189452289259735, 'recall': 0.0708177953017743, 'f1-score': 0.11590118369647612, 'support': 168404}, 'accuracy': 0.3497609436394892, 'macro avg': {'precision': 0.3383161676612956, 'recall': 0.3323897889464104, 'f1-score': 0.21055691681468947, 'support': 521216}, 'weighted avg': {'precision': 0.338734461572483, 'recall': 0.3497609436394892, 'f1-score': 0.219323007978032, 'support': 521216}}
[[   502 156476  11865]
 [   495 169873  13601]
 [   463 156015  11926]]
training model: results/AAPL/W3/deepLOB_L2/h200
Epoch 1/50
5475/5475 - 243s - loss: 3.2645 - accuracy200: 0.3836 - val_loss: 3.4332 - val_accuracy200: 0.3325 - 243s/epoch - 44ms/step
Epoch 2/50
5475/5475 - 240s - loss: 3.2484 - accuracy200: 0.3931 - val_loss: 3.4763 - val_accuracy200: 0.3309 - 240s/epoch - 44ms/step
Epoch 3/50
5475/5475 - 240s - loss: 3.2398 - accuracy200: 0.3997 - val_loss: 3.4881 - val_accuracy200: 0.3383 - 240s/epoch - 44ms/step
Epoch 4/50
5475/5475 - 242s - loss: 3.2339 - accuracy200: 0.4046 - val_loss: 3.5749 - val_accuracy200: 0.3421 - 242s/epoch - 44ms/step
Epoch 5/50
5475/5475 - 237s - loss: 3.2301 - accuracy200: 0.4073 - val_loss: 3.5275 - val_accuracy200: 0.3489 - 237s/epoch - 43ms/step
Epoch 6/50
5475/5475 - 238s - loss: 3.2261 - accuracy200: 0.4099 - val_loss: 3.5452 - val_accuracy200: 0.3571 - 238s/epoch - 43ms/step
Epoch 7/50
5475/5475 - 235s - loss: 3.2223 - accuracy200: 0.4121 - val_loss: 3.5098 - val_accuracy200: 0.3547 - 235s/epoch - 43ms/step
Epoch 8/50
5475/5475 - 236s - loss: 3.2195 - accuracy200: 0.4134 - val_loss: 3.4776 - val_accuracy200: 0.3436 - 236s/epoch - 43ms/step
Epoch 9/50
5475/5475 - 237s - loss: 3.2158 - accuracy200: 0.4154 - val_loss: 3.5141 - val_accuracy200: 0.3431 - 237s/epoch - 43ms/step
Epoch 10/50
5475/5475 - 237s - loss: 3.2117 - accuracy200: 0.4177 - val_loss: 3.5335 - val_accuracy200: 0.3420 - 237s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 240s - loss: 3.2095 - accuracy200: 0.4187 - val_loss: 3.5613 - val_accuracy200: 0.3438 - 240s/epoch - 44ms/step
testing model: results/AAPL/W3/deepLOB_L2/h200
Evaluating performance on  test set...
13689/13689 - 199s - 199s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1399294
{'0': {'precision': 0.3189053337056688, 'recall': 0.001955795929307054, 'f1-score': 0.003887748909974952, 'support': 1167811}, '1': {'precision': 0.3336068157852094, 'recall': 0.8082373971501394, 'f1-score': 0.4722772185684324, 'support': 1169180}, '2': {'precision': 0.33194227692807793, 'recall': 0.1889647077973536, 'f1-score': 0.24083138527453163, 'support': 1167255}, 'accuracy': 0.33326113520569045, 'macro avg': {'precision': 0.32815147547298534, 'recall': 0.33305263362560006, 'f1-score': 0.23899878425097967, 'support': 3504246}, 'weighted avg': {'precision': 0.32815300523866925, 'recall': 0.33326113520569045, 'f1-score': 0.23908962811593995, 'support': 3504246}}
[[  2284 943282 222245]
 [  2537 944975 221668]
 [  2341 944344 220570]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1443971
{'0': {'precision': 0.3298429319371728, 'recall': 0.0014724004589300131, 'f1-score': 0.002931713910411392, 'support': 470660}, '1': {'precision': 0.3309148308776755, 'recall': 0.8784951504719456, 'f1-score': 0.4807419793590131, 'support': 461282}, '2': {'precision': 0.3416267340660346, 'recall': 0.12721453758751683, 'f1-score': 0.18539275285414167, 'support': 469624}, 'accuracy': 0.3322497834565051, 'macro avg': {'precision': 0.33412816562696096, 'recall': 0.33572736283946414, 'f1-score': 0.2230221487078554, 'support': 1401566}, 'weighted avg': {'precision': 0.3341441235885381, 'recall': 0.3322497834565051, 'f1-score': 0.22132553754738055, 'support': 1401566}}
[[   693 410152  59815]
 [   728 405234  55320]
 [   680 409201  59743]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1462488
{'0': {'precision': 0.40746268656716417, 'recall': 0.0015718562874251496, 'f1-score': 0.003131631775164898, 'support': 173680}, '1': {'precision': 0.33380305968541263, 'recall': 0.8831362801992954, 'f1-score': 0.4844836267313821, 'support': 175418}, '2': {'precision': 0.32073131842823227, 'recall': 0.10518365307521584, 'f1-score': 0.158415148492326, 'support': 172118}, 'accuracy': 0.33248211873772104, 'macro avg': {'precision': 0.3539990215602697, 'recall': 0.32996392985397877, 'f1-score': 0.21534346899962434, 'support': 521216}, 'weighted avg': {'precision': 0.35403137584439326, 'recall': 0.33248211873772104, 'f1-score': 0.2164115245289446, 'support': 521216}}
[[   273 155405  18002]
 [   160 154918  20340]
 [   237 153777  18104]]
training model: results/AAPL/W3/deepLOB_L2/h300
Epoch 1/50
5475/5475 - 245s - loss: 3.2633 - accuracy300: 0.3867 - val_loss: 3.3912 - val_accuracy300: 0.3438 - 245s/epoch - 45ms/step
Epoch 2/50
5475/5475 - 242s - loss: 3.2442 - accuracy300: 0.3997 - val_loss: 3.3639 - val_accuracy300: 0.3385 - 242s/epoch - 44ms/step
Epoch 3/50
5475/5475 - 240s - loss: 3.2314 - accuracy300: 0.4066 - val_loss: 3.4583 - val_accuracy300: 0.3418 - 240s/epoch - 44ms/step
Epoch 4/50
5475/5475 - 238s - loss: 3.2263 - accuracy300: 0.4095 - val_loss: 3.3981 - val_accuracy300: 0.3387 - 238s/epoch - 44ms/step
Epoch 5/50
5475/5475 - 236s - loss: 3.2194 - accuracy300: 0.4140 - val_loss: 3.4622 - val_accuracy300: 0.3358 - 236s/epoch - 43ms/step
Epoch 6/50
5475/5475 - 241s - loss: 3.2145 - accuracy300: 0.4166 - val_loss: 3.4859 - val_accuracy300: 0.3328 - 241s/epoch - 44ms/step
Epoch 7/50
5475/5475 - 239s - loss: 3.2082 - accuracy300: 0.4197 - val_loss: 3.5433 - val_accuracy300: 0.3367 - 239s/epoch - 44ms/step
Epoch 8/50
5475/5475 - 236s - loss: 3.2044 - accuracy300: 0.4219 - val_loss: 3.5429 - val_accuracy300: 0.3325 - 236s/epoch - 43ms/step
Epoch 9/50
5475/5475 - 238s - loss: 3.2020 - accuracy300: 0.4225 - val_loss: 3.5676 - val_accuracy300: 0.3375 - 238s/epoch - 43ms/step
Epoch 10/50
5475/5475 - 248s - loss: 3.1994 - accuracy300: 0.4234 - val_loss: 3.5899 - val_accuracy300: 0.3390 - 248s/epoch - 45ms/step
Epoch 11/50
5475/5475 - 247s - loss: 3.1953 - accuracy300: 0.4254 - val_loss: 3.5745 - val_accuracy300: 0.3376 - 247s/epoch - 45ms/step
Epoch 12/50
5475/5475 - 250s - loss: 3.1926 - accuracy300: 0.4264 - val_loss: 3.6089 - val_accuracy300: 0.3392 - 250s/epoch - 46ms/step
testing model: results/AAPL/W3/deepLOB_L2/h300
Evaluating performance on  test set...
13689/13689 - 218s - 218s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157786
{'0': {'precision': 0.3197426556080924, 'recall': 0.01454954605416311, 'f1-score': 0.027832599564799353, 'support': 1134056}, '1': {'precision': 0.35330385012338444, 'recall': 0.9087511024059327, 'f1-score': 0.5087975965554127, 'support': 1237067}, '2': {'precision': 0.32040721341026457, 'recall': 0.076549500804414, 'f1-score': 0.12357524819406185, 'support': 1133123}, 'accuracy': 0.3502682174710337, 'macro avg': {'precision': 0.3311512397139138, 'recall': 0.33328338308816996, 'f1-score': 0.2200684814380913, 'support': 3504246}, 'weighted avg': {'precision': 0.3318052995965337, 'recall': 0.3502682174710337, 'f1-score': 0.22858166888667994, 'support': 3504246}}
[[  16500 1028444   89112]
 [  18015 1124186   94866]
 [  17089 1029294   86740]]
Evaluating performance on  train set...
5475/5475 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1268823
{'0': {'precision': 0.34667447611610047, 'recall': 0.01129250056706287, 'f1-score': 0.021872529999281454, 'support': 471729}, '1': {'precision': 0.328492225411206, 'recall': 0.9290748697619529, 'f1-score': 0.4853719101161868, 'support': 460119}, '2': {'precision': 0.3351523366138252, 'recall': 0.060538450730012475, 'f1-score': 0.10255282086976593, 'support': 469718}, 'accuracy': 0.3290947411680934, 'macro avg': {'precision': 0.3367730127137105, 'recall': 0.33363527368634277, 'f1-score': 0.2032657536617447, 'support': 1401566}, 'weighted avg': {'precision': 0.3368439327561623, 'recall': 0.3290947411680934, 'f1-score': 0.20107340683784106, 'support': 1401566}}
[[  5327 437925  28477]
 [  4702 427485  27932]
 [  5337 435945  28436]]
Evaluating performance on  val set...
2036/2036 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229607
{'0': {'precision': 0.3549290515309933, 'recall': 0.011091209297712328, 'f1-score': 0.021510243107613448, 'support': 171397}, '1': {'precision': 0.3406093765942251, 'recall': 0.8922937281783707, 'f1-score': 0.49302108059794253, 'support': 179581}, '2': {'precision': 0.31663436977010484, 'recall': 0.08446410319670108, 'f1-score': 0.13335497333642476, 'support': 170238}, 'accuracy': 0.33866765410117877, 'macro avg': {'precision': 0.3373909326317744, 'recall': 0.3292830135575947, 'f1-score': 0.21596209901399357, 'support': 521216}, 'weighted avg': {'precision': 0.3374876230667292, 'recall': 0.33866765410117877, 'f1-score': 0.22049609713366633, 'support': 521216}}
[[  1901 156222  13274]
 [  1583 160239  17759]
 [  1872 153987  14379]]
training model: results/AAPL/W3/deepLOB_L2/h500
Epoch 1/50
5475/5475 - 256s - loss: 3.2539 - accuracy500: 0.3930 - val_loss: 3.4236 - val_accuracy500: 0.3461 - 256s/epoch - 47ms/step
Epoch 2/50
5475/5475 - 251s - loss: 3.2145 - accuracy500: 0.4152 - val_loss: 3.5246 - val_accuracy500: 0.3406 - 251s/epoch - 46ms/step
Epoch 3/50
5475/5475 - 252s - loss: 3.2007 - accuracy500: 0.4214 - val_loss: 3.5263 - val_accuracy500: 0.3400 - 252s/epoch - 46ms/step
Epoch 4/50
5475/5475 - 249s - loss: 3.1920 - accuracy500: 0.4262 - val_loss: 3.6178 - val_accuracy500: 0.3359 - 249s/epoch - 45ms/step
Epoch 5/50
5475/5475 - 249s - loss: 3.1865 - accuracy500: 0.4294 - val_loss: 3.6850 - val_accuracy500: 0.3319 - 249s/epoch - 46ms/step
Epoch 6/50
5475/5475 - 250s - loss: 3.1792 - accuracy500: 0.4323 - val_loss: 3.7929 - val_accuracy500: 0.3256 - 250s/epoch - 46ms/step
Epoch 7/50
5475/5475 - 250s - loss: 3.1731 - accuracy500: 0.4347 - val_loss: 3.7425 - val_accuracy500: 0.3295 - 250s/epoch - 46ms/step
Epoch 8/50
5475/5475 - 251s - loss: 3.1653 - accuracy500: 0.4378 - val_loss: 3.7796 - val_accuracy500: 0.3295 - 251s/epoch - 46ms/step
Epoch 9/50
5475/5475 - 250s - loss: 3.1603 - accuracy500: 0.4399 - val_loss: 3.7606 - val_accuracy500: 0.3362 - 250s/epoch - 46ms/step
Epoch 10/50
5475/5475 - 251s - loss: 3.1557 - accuracy500: 0.4418 - val_loss: 3.7510 - val_accuracy500: 0.3387 - 251s/epoch - 46ms/step
Epoch 11/50
5475/5475 - 252s - loss: 3.1519 - accuracy500: 0.4431 - val_loss: 3.8164 - val_accuracy500: 0.3243 - 252s/epoch - 46ms/step
testing model: results/AAPL/W3/deepLOB_L2/h500
Evaluating performance on  test set...
13689/13689 - 221s - 221s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1452497
{'0': {'precision': 0.3333333333333333, 'recall': 5.806066811994278e-05, 'f1-score': 0.00011610111351522508, 'support': 1136742}, '1': {'precision': 0.3537277400991398, 'recall': 0.7940996273117448, 'f1-score': 0.4894378275997342, 'support': 1238837}, '2': {'precision': 0.324503476151086, 'recall': 0.2078487277469794, 'f1-score': 0.2533947795222816, 'support': 1128667}, 'accuracy': 0.34769762168523555, 'macro avg': {'precision': 0.33718818319451965, 'recall': 0.3340021385756147, 'f1-score': 0.24764956941184368, 'support': 3504246}, 'weighted avg': {'precision': 0.33769928745819094, 'recall': 0.34769762168523555, 'f1-score': 0.25468074805856283, 'support': 3504246}}
[[    66 903353 233323]
 [    66 983760 255011]
 [    66 894009 234592]]
Evaluating performance on  train set...
5475/5475 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.149454
{'0': {'precision': 0.32965451055662187, 'recall': 0.004379468981417537, 'f1-score': 0.008644100852037402, 'support': 470605}, '1': {'precision': 0.3337769445471971, 'recall': 0.8577728037748649, 'f1-score': 0.48055867740785596, 'support': 462851}, '2': {'precision': 0.3424458544263824, 'recall': 0.1505778556322232, 'f1-score': 0.2091776171313937, 'support': 468110}, 'accuracy': 0.3350316717157808, 'macro avg': {'precision': 0.3352924365100671, 'recall': 0.3375767094628352, 'f1-score': 0.232793465130429, 'support': 1401566}, 'weighted avg': {'precision': 0.33528808662356796, 'recall': 0.3350316717157808, 'f1-score': 0.23146477285675687, 'support': 1401566}}
[[  2061 396915  71629]
 [  2112 397021  63718]
 [  2079 395544  70487]]
Evaluating performance on  val set...
2036/2036 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1425945
{'0': {'precision': 0.29074962766837664, 'recall': 0.010197685351782419, 'f1-score': 0.0197042677627189, 'support': 172294}, '1': {'precision': 0.3470836744273589, 'recall': 0.8596783886857522, 'f1-score': 0.4945139445320375, 'support': 178041}, '2': {'precision': 0.34488475535786495, 'recall': 0.1497357810406072, 'f1-score': 0.20881295624533297, 'support': 170881}, 'accuracy': 0.3461175405206287, 'macro avg': {'precision': 0.32757268581786686, 'recall': 0.33987061835938065, 'f1-score': 0.24101038951336315, 'support': 521216}, 'weighted avg': {'precision': 0.32774088421791353, 'recall': 0.3461175405206287, 'f1-score': 0.2438928411339965, 'support': 521216}}
[[  1757 144734  25803]
 [  2183 153058  22800]
 [  2103 143191  25587]]
training model: results/AAPL/W3/deepLOB_L2/h1000
Epoch 1/50
5475/5475 - 256s - loss: 3.2179 - accuracy1000: 0.4155 - val_loss: 3.3756 - val_accuracy1000: 0.3577 - 256s/epoch - 47ms/step
Epoch 2/50
5475/5475 - 250s - loss: 3.1613 - accuracy1000: 0.4423 - val_loss: 3.5791 - val_accuracy1000: 0.3180 - 250s/epoch - 46ms/step
Epoch 3/50
5475/5475 - 250s - loss: 3.1379 - accuracy1000: 0.4515 - val_loss: 3.6873 - val_accuracy1000: 0.3282 - 250s/epoch - 46ms/step
Epoch 4/50
5475/5475 - 250s - loss: 3.1211 - accuracy1000: 0.4559 - val_loss: 3.6662 - val_accuracy1000: 0.3339 - 250s/epoch - 46ms/step
Epoch 5/50
5475/5475 - 250s - loss: 3.1061 - accuracy1000: 0.4615 - val_loss: 3.7198 - val_accuracy1000: 0.3248 - 250s/epoch - 46ms/step
Epoch 6/50
5475/5475 - 251s - loss: 3.0922 - accuracy1000: 0.4662 - val_loss: 3.7394 - val_accuracy1000: 0.3303 - 251s/epoch - 46ms/step
Epoch 7/50
5475/5475 - 250s - loss: 3.0840 - accuracy1000: 0.4688 - val_loss: 3.7838 - val_accuracy1000: 0.3263 - 250s/epoch - 46ms/step
Epoch 8/50
5475/5475 - 249s - loss: 3.0756 - accuracy1000: 0.4717 - val_loss: 3.7027 - val_accuracy1000: 0.3350 - 249s/epoch - 46ms/step
Epoch 9/50
5475/5475 - 251s - loss: 3.0682 - accuracy1000: 0.4738 - val_loss: 3.7420 - val_accuracy1000: 0.3398 - 251s/epoch - 46ms/step
Epoch 10/50
5475/5475 - 249s - loss: 3.0632 - accuracy1000: 0.4748 - val_loss: 3.7234 - val_accuracy1000: 0.3345 - 249s/epoch - 45ms/step
Epoch 11/50
5475/5475 - 248s - loss: 3.0586 - accuracy1000: 0.4762 - val_loss: 3.8154 - val_accuracy1000: 0.3243 - 248s/epoch - 45ms/step
testing model: results/AAPL/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
13689/13689 - 213s - 213s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271566
{'0': {'precision': 0.3298496718003117, 'recall': 0.2589537027220214, 'f1-score': 0.29013350653306913, 'support': 1169572}, '1': {'precision': 0.3380100113587682, 'recall': 0.6410763201146277, 'f1-score': 0.44263760462816876, 'support': 1186450}, '2': {'precision': 0.3198882704854814, 'recall': 0.093554916113929, 'f1-score': 0.14477017051484636, 'support': 1148224}, 'accuracy': 0.334135217675928, 'macro avg': {'precision': 0.32924931788152045, 'recall': 0.3311949796501927, 'f1-score': 0.2925137605586947, 'support': 3504246}, 'weighted avg': {'precision': 0.3293485411165101, 'recall': 0.334135217675928, 'f1-score': 0.2941368830222606, 'support': 3504246}}
[[302865 753597 113110]
 [310566 760605 115279]
 [304760 736042 107422]]
Evaluating performance on  train set...
5475/5475 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1276335
{'0': {'precision': 0.348596635653376, 'recall': 0.19136091950102746, 'f1-score': 0.24708524622650857, 'support': 469124}, '1': {'precision': 0.3403244201653015, 'recall': 0.7686176783354995, 'f1-score': 0.4717637937309134, 'support': 465485}, '2': {'precision': 0.34002867893607613, 'recall': 0.06753940941028831, 'f1-score': 0.11269447640555433, 'support': 466957}, 'accuracy': 0.3418247874163614, 'macro avg': {'precision': 0.3429832449182513, 'recall': 0.3425060024156051, 'f1-score': 0.2771811721209921, 'support': 1401566}, 'weighted avg': {'precision': 0.34299471637786094, 'recall': 0.3418247874163614, 'f1-score': 0.27693027884131555, 'support': 1401566}}
[[ 89772 346919  32433]
 [ 78925 357780  28780]
 [ 88827 346592  31538]]
Evaluating performance on  val set...
2036/2036 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125879
{'0': {'precision': 0.3635614278205189, 'recall': 0.1775709659538466, 'f1-score': 0.2386031760965609, 'support': 171385}, '1': {'precision': 0.35650540045231227, 'recall': 0.8239432256611, 'f1-score': 0.49767554998375524, 'support': 177545}, '2': {'precision': 0.3498454291182099, 'recall': 0.05517569622604274, 'f1-score': 0.09531831262721978, 'support': 172286}, 'accuracy': 0.3572914108546169, 'macro avg': {'precision': 0.356637419130347, 'recall': 0.35222996261366313, 'f1-score': 0.277199012902512, 'support': 521216}, 'weighted avg': {'precision': 0.356624117892362, 'recall': 0.3572914108546169, 'f1-score': 0.2794903104787039, 'support': 521216}}
[[ 30433 131313   9639]
 [ 23231 146287   8027]
 [ 30044 132736   9506]]
training model: results/AAPL/W3/deepOF_L2/h10
Epoch 1/50
5475/5475 - 179s - loss: 3.0843 - accuracy10: 0.4699 - val_loss: 3.1485 - val_accuracy10: 0.4367 - 179s/epoch - 33ms/step
Epoch 2/50
5475/5475 - 157s - loss: 3.0310 - accuracy10: 0.4870 - val_loss: 3.1148 - val_accuracy10: 0.4480 - 157s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 155s - loss: 3.0101 - accuracy10: 0.4927 - val_loss: 3.0882 - val_accuracy10: 0.4565 - 155s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 186s - loss: 2.9961 - accuracy10: 0.4970 - val_loss: 3.0829 - val_accuracy10: 0.4580 - 186s/epoch - 34ms/step
Epoch 5/50
5475/5475 - 189s - loss: 2.9861 - accuracy10: 0.5000 - val_loss: 3.0691 - val_accuracy10: 0.4632 - 189s/epoch - 35ms/step
Epoch 6/50
5475/5475 - 189s - loss: 2.9789 - accuracy10: 0.5020 - val_loss: 3.0552 - val_accuracy10: 0.4685 - 189s/epoch - 34ms/step
Epoch 7/50
5475/5475 - 190s - loss: 2.9730 - accuracy10: 0.5036 - val_loss: 3.0499 - val_accuracy10: 0.4709 - 190s/epoch - 35ms/step
Epoch 8/50
5475/5475 - 187s - loss: 2.9681 - accuracy10: 0.5048 - val_loss: 3.0407 - val_accuracy10: 0.4736 - 187s/epoch - 34ms/step
Epoch 9/50
5475/5475 - 193s - loss: 2.9637 - accuracy10: 0.5059 - val_loss: 3.0378 - val_accuracy10: 0.4743 - 193s/epoch - 35ms/step
Epoch 10/50
5475/5475 - 192s - loss: 2.9605 - accuracy10: 0.5071 - val_loss: 3.0341 - val_accuracy10: 0.4751 - 192s/epoch - 35ms/step
Epoch 11/50
5475/5475 - 193s - loss: 2.9572 - accuracy10: 0.5079 - val_loss: 3.0267 - val_accuracy10: 0.4777 - 193s/epoch - 35ms/step
Epoch 12/50
5475/5475 - 189s - loss: 2.9538 - accuracy10: 0.5086 - val_loss: 3.0170 - val_accuracy10: 0.4816 - 189s/epoch - 35ms/step
Epoch 13/50
5475/5475 - 194s - loss: 2.9509 - accuracy10: 0.5096 - val_loss: 3.0213 - val_accuracy10: 0.4806 - 194s/epoch - 35ms/step
Epoch 14/50
5475/5475 - 193s - loss: 2.9481 - accuracy10: 0.5108 - val_loss: 3.0212 - val_accuracy10: 0.4821 - 193s/epoch - 35ms/step
Epoch 15/50
5475/5475 - 194s - loss: 2.9458 - accuracy10: 0.5111 - val_loss: 3.0124 - val_accuracy10: 0.4849 - 194s/epoch - 35ms/step
Epoch 16/50
5475/5475 - 192s - loss: 2.9433 - accuracy10: 0.5119 - val_loss: 3.0084 - val_accuracy10: 0.4867 - 192s/epoch - 35ms/step
Epoch 17/50
5475/5475 - 188s - loss: 2.9414 - accuracy10: 0.5124 - val_loss: 3.0149 - val_accuracy10: 0.4851 - 188s/epoch - 34ms/step
Epoch 18/50
5475/5475 - 188s - loss: 2.9393 - accuracy10: 0.5129 - val_loss: 3.0069 - val_accuracy10: 0.4870 - 188s/epoch - 34ms/step
Epoch 19/50
5475/5475 - 193s - loss: 2.9375 - accuracy10: 0.5135 - val_loss: 3.0029 - val_accuracy10: 0.4889 - 193s/epoch - 35ms/step
Epoch 20/50
5475/5475 - 187s - loss: 2.9354 - accuracy10: 0.5139 - val_loss: 3.0055 - val_accuracy10: 0.4883 - 187s/epoch - 34ms/step
Epoch 21/50
5475/5475 - 176s - loss: 2.9337 - accuracy10: 0.5144 - val_loss: 3.0041 - val_accuracy10: 0.4897 - 176s/epoch - 32ms/step
Epoch 22/50
5475/5475 - 182s - loss: 2.9318 - accuracy10: 0.5147 - val_loss: 3.0024 - val_accuracy10: 0.4893 - 182s/epoch - 33ms/step
Epoch 23/50
5475/5475 - 182s - loss: 2.9304 - accuracy10: 0.5153 - val_loss: 3.0031 - val_accuracy10: 0.4899 - 182s/epoch - 33ms/step
Epoch 24/50
5475/5475 - 180s - loss: 2.9286 - accuracy10: 0.5160 - val_loss: 3.0093 - val_accuracy10: 0.4898 - 180s/epoch - 33ms/step
Epoch 25/50
5475/5475 - 188s - loss: 2.9266 - accuracy10: 0.5162 - val_loss: 3.0025 - val_accuracy10: 0.4900 - 188s/epoch - 34ms/step
Epoch 26/50
5475/5475 - 188s - loss: 2.9254 - accuracy10: 0.5168 - val_loss: 3.0031 - val_accuracy10: 0.4907 - 188s/epoch - 34ms/step
Epoch 27/50
5475/5475 - 158s - loss: 2.9243 - accuracy10: 0.5173 - val_loss: 2.9980 - val_accuracy10: 0.4923 - 158s/epoch - 29ms/step
Epoch 28/50
5475/5475 - 160s - loss: 2.9227 - accuracy10: 0.5176 - val_loss: 3.0003 - val_accuracy10: 0.4912 - 160s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 156s - loss: 2.9215 - accuracy10: 0.5179 - val_loss: 3.0044 - val_accuracy10: 0.4914 - 156s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 155s - loss: 2.9202 - accuracy10: 0.5183 - val_loss: 2.9995 - val_accuracy10: 0.4925 - 155s/epoch - 28ms/step
Epoch 31/50
5475/5475 - 156s - loss: 2.9188 - accuracy10: 0.5184 - val_loss: 3.0013 - val_accuracy10: 0.4928 - 156s/epoch - 28ms/step
Epoch 32/50
5475/5475 - 156s - loss: 2.9173 - accuracy10: 0.5191 - val_loss: 3.0009 - val_accuracy10: 0.4922 - 156s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 155s - loss: 2.9161 - accuracy10: 0.5193 - val_loss: 2.9891 - val_accuracy10: 0.4953 - 155s/epoch - 28ms/step
Epoch 34/50
5475/5475 - 176s - loss: 2.9150 - accuracy10: 0.5193 - val_loss: 2.9933 - val_accuracy10: 0.4951 - 176s/epoch - 32ms/step
Epoch 35/50
5475/5475 - 178s - loss: 2.9132 - accuracy10: 0.5199 - val_loss: 2.9978 - val_accuracy10: 0.4948 - 178s/epoch - 32ms/step
Epoch 36/50
5475/5475 - 178s - loss: 2.9128 - accuracy10: 0.5200 - val_loss: 2.9980 - val_accuracy10: 0.4950 - 178s/epoch - 33ms/step
Epoch 37/50
5475/5475 - 179s - loss: 2.9117 - accuracy10: 0.5204 - val_loss: 2.9981 - val_accuracy10: 0.4946 - 179s/epoch - 33ms/step
Epoch 38/50
5475/5475 - 181s - loss: 2.9102 - accuracy10: 0.5207 - val_loss: 2.9986 - val_accuracy10: 0.4943 - 181s/epoch - 33ms/step
Epoch 39/50
5475/5475 - 176s - loss: 2.9090 - accuracy10: 0.5213 - val_loss: 2.9935 - val_accuracy10: 0.4953 - 176s/epoch - 32ms/step
Epoch 40/50
5475/5475 - 178s - loss: 2.9078 - accuracy10: 0.5214 - val_loss: 2.9968 - val_accuracy10: 0.4956 - 178s/epoch - 33ms/step
Epoch 41/50
5475/5475 - 178s - loss: 2.9070 - accuracy10: 0.5213 - val_loss: 2.9925 - val_accuracy10: 0.4971 - 178s/epoch - 32ms/step
Epoch 42/50
5475/5475 - 182s - loss: 2.9055 - accuracy10: 0.5220 - val_loss: 2.9951 - val_accuracy10: 0.4958 - 182s/epoch - 33ms/step
Epoch 43/50
5475/5475 - 183s - loss: 2.9050 - accuracy10: 0.5221 - val_loss: 3.0003 - val_accuracy10: 0.4953 - 183s/epoch - 33ms/step
testing model: results/AAPL/W3/deepOF_L2/h10
Evaluating performance on  test set...
13689/13689 - 207s - 207s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0158882
{'0': {'precision': 0.519721333797777, 'recall': 0.3827908456426681, 'f1-score': 0.44086844121335067, 'support': 1071883}, '1': {'precision': 0.44038611533784594, 'recall': 0.6636214032513812, 'f1-score': 0.5294341694454793, 'support': 1333218}, '2': {'precision': 0.5441826194153572, 'recall': 0.3494055812675535, 'f1-score': 0.42556614849482316, 'support': 1099141}, 'accuracy': 0.4791635395044064, 'macro avg': {'precision': 0.5014300228503267, 'recall': 0.46527261005386755, 'f1-score': 0.46528958638455103, 'support': 3504242}, 'weighted avg': {'precision': 0.49721012043131435, 'recall': 0.4791635395044064, 'f1-score': 0.46976428965682204, 'support': 3504242}}
[[410307 553288 108288]
 [235070 884752 213396]
 [144098 570997 384046]]
Evaluating performance on  train set...
5475/5475 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0248553
{'0': {'precision': 0.5142726655746572, 'recall': 0.43433094077060486, 'f1-score': 0.4709333364485435, 'support': 464077}, '1': {'precision': 0.41950246117424855, 'recall': 0.5578235973345432, 'f1-score': 0.4788747213800169, 'support': 465061}, '2': {'precision': 0.5227760126577425, 'recall': 0.4329176782868041, 'f1-score': 0.4736224164881607, 'support': 472427}, 'accuracy': 0.4748313492417405, 'macro avg': {'precision': 0.4855170464688828, 'recall': 0.47502407213065073, 'f1-score': 0.4744768247722404, 'support': 1401565}, 'weighted avg': {'precision': 0.48569267443886427, 'recall': 0.4748313492417405, 'f1-score': 0.4744748221687864, 'support': 1401565}}
[[201563 181451  81063]
 [100001 259422 105638]
 [ 90374 177531 204522]]
Evaluating performance on  val set...
2036/2036 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9964462
{'0': {'precision': 0.5336222278868213, 'recall': 0.3927506050543142, 'f1-score': 0.4524753866271844, 'support': 159903}, '1': {'precision': 0.4609008761590894, 'recall': 0.6239859125109091, 'f1-score': 0.5301855581443309, 'support': 193647}, '2': {'precision': 0.5302598348884754, 'recall': 0.447061419727315, 'f1-score': 0.48511932691529813, 'support': 167666}, 'accuracy': 0.49613212180746563, 'macro avg': {'precision': 0.5082609796447954, 'recall': 0.48793264576417944, 'f1-score': 0.4892600905622711, 'support': 521216}, 'weighted avg': {'precision': 0.5055224946044955, 'recall': 0.49613212180746563, 'f1-score': 0.4918479701168081, 'support': 521216}}
[[ 62802  70996  26105]
 [ 32517 120833  40297]
 [ 22371  70338  74957]]
training model: results/AAPL/W3/deepOF_L2/h20
Epoch 1/50
5475/5475 - 176s - loss: 3.1353 - accuracy20: 0.4495 - val_loss: 3.2065 - val_accuracy20: 0.4063 - 176s/epoch - 32ms/step
Epoch 2/50
5475/5475 - 180s - loss: 3.0952 - accuracy20: 0.4640 - val_loss: 3.1937 - val_accuracy20: 0.4070 - 180s/epoch - 33ms/step
Epoch 3/50
5475/5475 - 183s - loss: 3.0794 - accuracy20: 0.4687 - val_loss: 3.1654 - val_accuracy20: 0.4168 - 183s/epoch - 34ms/step
Epoch 4/50
5475/5475 - 182s - loss: 3.0683 - accuracy20: 0.4725 - val_loss: 3.1683 - val_accuracy20: 0.4169 - 182s/epoch - 33ms/step
Epoch 5/50
5475/5475 - 181s - loss: 3.0607 - accuracy20: 0.4753 - val_loss: 3.1564 - val_accuracy20: 0.4211 - 181s/epoch - 33ms/step
Epoch 6/50
5475/5475 - 180s - loss: 3.0549 - accuracy20: 0.4771 - val_loss: 3.1445 - val_accuracy20: 0.4262 - 180s/epoch - 33ms/step
Epoch 7/50
5475/5475 - 161s - loss: 3.0496 - accuracy20: 0.4787 - val_loss: 3.1395 - val_accuracy20: 0.4274 - 161s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 154s - loss: 3.0453 - accuracy20: 0.4804 - val_loss: 3.1447 - val_accuracy20: 0.4267 - 154s/epoch - 28ms/step
Epoch 9/50
5475/5475 - 155s - loss: 3.0422 - accuracy20: 0.4810 - val_loss: 3.1315 - val_accuracy20: 0.4323 - 155s/epoch - 28ms/step
Epoch 10/50
5475/5475 - 155s - loss: 3.0389 - accuracy20: 0.4819 - val_loss: 3.1326 - val_accuracy20: 0.4322 - 155s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 155s - loss: 3.0361 - accuracy20: 0.4825 - val_loss: 3.1268 - val_accuracy20: 0.4343 - 155s/epoch - 28ms/step
Epoch 12/50
5475/5475 - 155s - loss: 3.0334 - accuracy20: 0.4836 - val_loss: 3.1296 - val_accuracy20: 0.4352 - 155s/epoch - 28ms/step
Epoch 13/50
5475/5475 - 157s - loss: 3.0315 - accuracy20: 0.4840 - val_loss: 3.1243 - val_accuracy20: 0.4371 - 157s/epoch - 29ms/step
Epoch 14/50
5475/5475 - 155s - loss: 3.0292 - accuracy20: 0.4845 - val_loss: 3.1254 - val_accuracy20: 0.4377 - 155s/epoch - 28ms/step
Epoch 15/50
5475/5475 - 157s - loss: 3.0270 - accuracy20: 0.4854 - val_loss: 3.1265 - val_accuracy20: 0.4387 - 157s/epoch - 29ms/step
Epoch 16/50
5475/5475 - 157s - loss: 3.0250 - accuracy20: 0.4858 - val_loss: 3.1221 - val_accuracy20: 0.4398 - 157s/epoch - 29ms/step
Epoch 17/50
5475/5475 - 157s - loss: 3.0235 - accuracy20: 0.4863 - val_loss: 3.1218 - val_accuracy20: 0.4415 - 157s/epoch - 29ms/step
Epoch 18/50
5475/5475 - 155s - loss: 3.0216 - accuracy20: 0.4867 - val_loss: 3.1185 - val_accuracy20: 0.4425 - 155s/epoch - 28ms/step
Epoch 19/50
5475/5475 - 155s - loss: 3.0199 - accuracy20: 0.4875 - val_loss: 3.1157 - val_accuracy20: 0.4446 - 155s/epoch - 28ms/step
Epoch 20/50
5475/5475 - 158s - loss: 3.0181 - accuracy20: 0.4878 - val_loss: 3.1148 - val_accuracy20: 0.4446 - 158s/epoch - 29ms/step
Epoch 21/50
5475/5475 - 158s - loss: 3.0167 - accuracy20: 0.4887 - val_loss: 3.1079 - val_accuracy20: 0.4482 - 158s/epoch - 29ms/step
Epoch 22/50
5475/5475 - 156s - loss: 3.0150 - accuracy20: 0.4891 - val_loss: 3.1083 - val_accuracy20: 0.4491 - 156s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 155s - loss: 3.0134 - accuracy20: 0.4894 - val_loss: 3.1115 - val_accuracy20: 0.4484 - 155s/epoch - 28ms/step
Epoch 24/50
5475/5475 - 154s - loss: 3.0120 - accuracy20: 0.4900 - val_loss: 3.1050 - val_accuracy20: 0.4512 - 154s/epoch - 28ms/step
Epoch 25/50
5475/5475 - 155s - loss: 3.0105 - accuracy20: 0.4906 - val_loss: 3.1035 - val_accuracy20: 0.4520 - 155s/epoch - 28ms/step
Epoch 26/50
5475/5475 - 156s - loss: 3.0092 - accuracy20: 0.4907 - val_loss: 3.0985 - val_accuracy20: 0.4538 - 156s/epoch - 28ms/step
Epoch 27/50
5475/5475 - 156s - loss: 3.0079 - accuracy20: 0.4914 - val_loss: 3.1011 - val_accuracy20: 0.4531 - 156s/epoch - 28ms/step
Epoch 28/50
5475/5475 - 161s - loss: 3.0065 - accuracy20: 0.4916 - val_loss: 3.1036 - val_accuracy20: 0.4527 - 161s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 157s - loss: 3.0052 - accuracy20: 0.4922 - val_loss: 3.0995 - val_accuracy20: 0.4544 - 157s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 154s - loss: 3.0040 - accuracy20: 0.4925 - val_loss: 3.1038 - val_accuracy20: 0.4535 - 154s/epoch - 28ms/step
Epoch 31/50
5475/5475 - 156s - loss: 3.0026 - accuracy20: 0.4925 - val_loss: 3.0999 - val_accuracy20: 0.4556 - 156s/epoch - 28ms/step
Epoch 32/50
5475/5475 - 154s - loss: 3.0019 - accuracy20: 0.4931 - val_loss: 3.0993 - val_accuracy20: 0.4560 - 154s/epoch - 28ms/step
Epoch 33/50
5475/5475 - 156s - loss: 3.0003 - accuracy20: 0.4936 - val_loss: 3.1016 - val_accuracy20: 0.4549 - 156s/epoch - 28ms/step
Epoch 34/50
5475/5475 - 157s - loss: 2.9990 - accuracy20: 0.4939 - val_loss: 3.1002 - val_accuracy20: 0.4565 - 157s/epoch - 29ms/step
Epoch 35/50
5475/5475 - 158s - loss: 2.9978 - accuracy20: 0.4946 - val_loss: 3.0973 - val_accuracy20: 0.4573 - 158s/epoch - 29ms/step
Epoch 36/50
5475/5475 - 155s - loss: 2.9970 - accuracy20: 0.4945 - val_loss: 3.1003 - val_accuracy20: 0.4573 - 155s/epoch - 28ms/step
Epoch 37/50
5475/5475 - 156s - loss: 2.9957 - accuracy20: 0.4948 - val_loss: 3.1061 - val_accuracy20: 0.4550 - 156s/epoch - 29ms/step
Epoch 38/50
5475/5475 - 155s - loss: 2.9945 - accuracy20: 0.4952 - val_loss: 3.0995 - val_accuracy20: 0.4575 - 155s/epoch - 28ms/step
Epoch 39/50
5475/5475 - 153s - loss: 2.9933 - accuracy20: 0.4957 - val_loss: 3.1041 - val_accuracy20: 0.4554 - 153s/epoch - 28ms/step
Epoch 40/50
5475/5475 - 154s - loss: 2.9922 - accuracy20: 0.4956 - val_loss: 3.1041 - val_accuracy20: 0.4562 - 154s/epoch - 28ms/step
Epoch 41/50
5475/5475 - 155s - loss: 2.9910 - accuracy20: 0.4962 - val_loss: 3.1035 - val_accuracy20: 0.4569 - 155s/epoch - 28ms/step
Epoch 42/50
5475/5475 - 158s - loss: 2.9897 - accuracy20: 0.4969 - val_loss: 3.1078 - val_accuracy20: 0.4552 - 158s/epoch - 29ms/step
Epoch 43/50
5475/5475 - 158s - loss: 2.9888 - accuracy20: 0.4971 - val_loss: 3.1052 - val_accuracy20: 0.4574 - 158s/epoch - 29ms/step
Epoch 44/50
5475/5475 - 156s - loss: 2.9875 - accuracy20: 0.4975 - val_loss: 3.1114 - val_accuracy20: 0.4555 - 156s/epoch - 28ms/step
Epoch 45/50
5475/5475 - 156s - loss: 2.9864 - accuracy20: 0.4980 - val_loss: 3.1070 - val_accuracy20: 0.4569 - 156s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h20
Evaluating performance on  test set...
13689/13689 - 204s - 204s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0688374
{'0': {'precision': 0.5321139642230636, 'recall': 0.3241870848904708, 'f1-score': 0.4029061393059567, 'support': 1147137}, '1': {'precision': 0.3648637197519001, 'recall': 0.7038971741947879, 'f1-score': 0.4806061725390423, 'support': 1186706}, '2': {'precision': 0.5415481165060586, 'recall': 0.23873482461963827, 'f1-score': 0.3313833682706192, 'support': 1170399}, 'accuracy': 0.4242346847049947, 'macro avg': {'precision': 0.47950860016034075, 'recall': 0.4222730279016324, 'f1-score': 0.4049652267052061, 'support': 3504242}, 'weighted avg': {'precision': 0.47862589284627755, 'recall': 0.4242346847049947, 'f1-score': 0.4053308907760076, 'support': 3504242}}
[[371887 685848  89402]
 [204248 835319 147139]
 [122751 768233 279415]]
Evaluating performance on  train set...
5475/5475 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0484118
{'0': {'precision': 0.5146719235591247, 'recall': 0.39731203655802727, 'f1-score': 0.44844067231674845, 'support': 463920}, '1': {'precision': 0.3749519161253536, 'recall': 0.5917933680389599, 'f1-score': 0.4590538188935613, 'support': 464478}, '2': {'precision': 0.5209384606461342, 'recall': 0.34167006574845665, 'f1-score': 0.412676370922968, 'support': 473167}, 'accuracy': 0.44297838487690544, 'macro avg': {'precision': 0.4701874334435375, 'recall': 0.44359182344848125, 'f1-score': 0.4400569540444259, 'support': 1401565}, 'weighted avg': {'precision': 0.4704843539073611, 'recall': 0.44297838487690544, 'f1-score': 0.4398838703832769, 'support': 1401565}}
[[184321 218554  61045]
 [101977 274875  87626]
 [ 71835 239665 161667]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0329959
{'0': {'precision': 0.5385088699962735, 'recall': 0.37036507226940846, 'f1-score': 0.4388834738879236, 'support': 167775}, '1': {'precision': 0.3960982872070731, 'recall': 0.6264674848669962, 'f1-score': 0.48533347100682345, 'support': 180070}, '2': {'precision': 0.5261796759454346, 'recall': 0.36732210115878666, 'f1-score': 0.4326290760869565, 'support': 173371}, 'accuracy': 0.45783130218565815, 'macro avg': {'precision': 0.48692894438292705, 'recall': 0.45471821943173046, 'f1-score': 0.45228200699390114, 'support': 521216}, 'weighted avg': {'precision': 0.4852077465759653, 'recall': 0.4578313021856582, 'f1-score': 0.4528506578961828, 'support': 521216}}
[[ 62138  82525  23112]
 [ 33028 112808  34234]
 [ 20223  89465  63683]]
training model: results/AAPL/W3/deepOF_L2/h30
Epoch 1/50
5475/5475 - 159s - loss: 3.1519 - accuracy30: 0.4449 - val_loss: 3.2073 - val_accuracy30: 0.3982 - 159s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 157s - loss: 3.1184 - accuracy30: 0.4575 - val_loss: 3.1905 - val_accuracy30: 0.4073 - 157s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 155s - loss: 3.1031 - accuracy30: 0.4625 - val_loss: 3.1854 - val_accuracy30: 0.4123 - 155s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 156s - loss: 3.0935 - accuracy30: 0.4660 - val_loss: 3.1797 - val_accuracy30: 0.4165 - 156s/epoch - 28ms/step
Epoch 5/50
5475/5475 - 156s - loss: 3.0865 - accuracy30: 0.4683 - val_loss: 3.1729 - val_accuracy30: 0.4213 - 156s/epoch - 28ms/step
Epoch 6/50
5475/5475 - 157s - loss: 3.0812 - accuracy30: 0.4700 - val_loss: 3.1644 - val_accuracy30: 0.4280 - 157s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 156s - loss: 3.0767 - accuracy30: 0.4714 - val_loss: 3.1662 - val_accuracy30: 0.4276 - 156s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 159s - loss: 3.0732 - accuracy30: 0.4727 - val_loss: 3.1632 - val_accuracy30: 0.4282 - 159s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 157s - loss: 3.0706 - accuracy30: 0.4736 - val_loss: 3.1602 - val_accuracy30: 0.4299 - 157s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 154s - loss: 3.0680 - accuracy30: 0.4745 - val_loss: 3.1592 - val_accuracy30: 0.4315 - 154s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 161s - loss: 3.0653 - accuracy30: 0.4749 - val_loss: 3.1602 - val_accuracy30: 0.4305 - 161s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 172s - loss: 3.0631 - accuracy30: 0.4758 - val_loss: 3.1597 - val_accuracy30: 0.4334 - 172s/epoch - 31ms/step
Epoch 13/50
5475/5475 - 162s - loss: 3.0612 - accuracy30: 0.4765 - val_loss: 3.1575 - val_accuracy30: 0.4332 - 162s/epoch - 30ms/step
Epoch 14/50
5475/5475 - 160s - loss: 3.0590 - accuracy30: 0.4772 - val_loss: 3.1537 - val_accuracy30: 0.4372 - 160s/epoch - 29ms/step
Epoch 15/50
5475/5475 - 166s - loss: 3.0573 - accuracy30: 0.4773 - val_loss: 3.1548 - val_accuracy30: 0.4365 - 166s/epoch - 30ms/step
Epoch 16/50
5475/5475 - 153s - loss: 3.0557 - accuracy30: 0.4782 - val_loss: 3.1490 - val_accuracy30: 0.4406 - 153s/epoch - 28ms/step
Epoch 17/50
5475/5475 - 156s - loss: 3.0541 - accuracy30: 0.4785 - val_loss: 3.1505 - val_accuracy30: 0.4406 - 156s/epoch - 29ms/step
Epoch 18/50
5475/5475 - 155s - loss: 3.0523 - accuracy30: 0.4795 - val_loss: 3.1516 - val_accuracy30: 0.4405 - 155s/epoch - 28ms/step
Epoch 19/50
5475/5475 - 158s - loss: 3.0509 - accuracy30: 0.4794 - val_loss: 3.1524 - val_accuracy30: 0.4410 - 158s/epoch - 29ms/step
Epoch 20/50
5475/5475 - 157s - loss: 3.0495 - accuracy30: 0.4801 - val_loss: 3.1483 - val_accuracy30: 0.4427 - 157s/epoch - 29ms/step
Epoch 21/50
5475/5475 - 153s - loss: 3.0478 - accuracy30: 0.4806 - val_loss: 3.1492 - val_accuracy30: 0.4435 - 153s/epoch - 28ms/step
Epoch 22/50
5475/5475 - 157s - loss: 3.0464 - accuracy30: 0.4812 - val_loss: 3.1481 - val_accuracy30: 0.4431 - 157s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 156s - loss: 3.0451 - accuracy30: 0.4813 - val_loss: 3.1429 - val_accuracy30: 0.4464 - 156s/epoch - 28ms/step
Epoch 24/50
5475/5475 - 157s - loss: 3.0436 - accuracy30: 0.4817 - val_loss: 3.1507 - val_accuracy30: 0.4430 - 157s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 156s - loss: 3.0418 - accuracy30: 0.4826 - val_loss: 3.1485 - val_accuracy30: 0.4452 - 156s/epoch - 29ms/step
Epoch 26/50
5475/5475 - 156s - loss: 3.0408 - accuracy30: 0.4827 - val_loss: 3.1477 - val_accuracy30: 0.4455 - 156s/epoch - 29ms/step
Epoch 27/50
5475/5475 - 156s - loss: 3.0398 - accuracy30: 0.4831 - val_loss: 3.1494 - val_accuracy30: 0.4443 - 156s/epoch - 28ms/step
Epoch 28/50
5475/5475 - 155s - loss: 3.0380 - accuracy30: 0.4833 - val_loss: 3.1445 - val_accuracy30: 0.4481 - 155s/epoch - 28ms/step
Epoch 29/50
5475/5475 - 157s - loss: 3.0367 - accuracy30: 0.4839 - val_loss: 3.1451 - val_accuracy30: 0.4476 - 157s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 158s - loss: 3.0352 - accuracy30: 0.4845 - val_loss: 3.1448 - val_accuracy30: 0.4481 - 158s/epoch - 29ms/step
Epoch 31/50
5475/5475 - 175s - loss: 3.0346 - accuracy30: 0.4847 - val_loss: 3.1491 - val_accuracy30: 0.4470 - 175s/epoch - 32ms/step
Epoch 32/50
5475/5475 - 159s - loss: 3.0331 - accuracy30: 0.4847 - val_loss: 3.1394 - val_accuracy30: 0.4511 - 159s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 157s - loss: 3.0317 - accuracy30: 0.4853 - val_loss: 3.1452 - val_accuracy30: 0.4484 - 157s/epoch - 29ms/step
Epoch 34/50
5475/5475 - 154s - loss: 3.0307 - accuracy30: 0.4855 - val_loss: 3.1501 - val_accuracy30: 0.4464 - 154s/epoch - 28ms/step
Epoch 35/50
5475/5475 - 154s - loss: 3.0292 - accuracy30: 0.4859 - val_loss: 3.1479 - val_accuracy30: 0.4496 - 154s/epoch - 28ms/step
Epoch 36/50
5475/5475 - 155s - loss: 3.0280 - accuracy30: 0.4865 - val_loss: 3.1533 - val_accuracy30: 0.4461 - 155s/epoch - 28ms/step
Epoch 37/50
5475/5475 - 154s - loss: 3.0268 - accuracy30: 0.4870 - val_loss: 3.1530 - val_accuracy30: 0.4465 - 154s/epoch - 28ms/step
Epoch 38/50
5475/5475 - 157s - loss: 3.0257 - accuracy30: 0.4872 - val_loss: 3.1524 - val_accuracy30: 0.4479 - 157s/epoch - 29ms/step
Epoch 39/50
5475/5475 - 154s - loss: 3.0246 - accuracy30: 0.4875 - val_loss: 3.1480 - val_accuracy30: 0.4495 - 154s/epoch - 28ms/step
Epoch 40/50
5475/5475 - 155s - loss: 3.0232 - accuracy30: 0.4880 - val_loss: 3.1474 - val_accuracy30: 0.4502 - 155s/epoch - 28ms/step
Epoch 41/50
5475/5475 - 154s - loss: 3.0213 - accuracy30: 0.4882 - val_loss: 3.1485 - val_accuracy30: 0.4496 - 154s/epoch - 28ms/step
Epoch 42/50
5475/5475 - 155s - loss: 3.0208 - accuracy30: 0.4889 - val_loss: 3.1500 - val_accuracy30: 0.4490 - 155s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h30
Evaluating performance on  test set...
13689/13689 - 216s - 216s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.074708
{'0': {'precision': 0.4984575224341452, 'recall': 0.44129198898692484, 'f1-score': 0.4681360486537132, 'support': 1221094}, '1': {'precision': 0.3211452160500333, 'recall': 0.5138017094346532, 'f1-score': 0.3952465862126094, 'support': 1037770}, '2': {'precision': 0.498588200132135, 'recall': 0.3054100843278105, 'f1-score': 0.37879151533138067, 'support': 1245378}, 'accuracy': 0.41447422866343137, 'macro avg': {'precision': 0.43939697953877116, 'recall': 0.42016792758312954, 'f1-score': 0.4140580500659011, 'support': 3504242}, 'weighted avg': {'precision': 0.4459934948167396, 'recall': 0.41447422866343137, 'f1-score': 0.41479777645179217, 'support': 3504242}}
[[538859 501964 180271]
 [302328 533208 202234]
 [239866 625161 380351]]
Evaluating performance on  train set...
5475/5475 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0541801
{'0': {'precision': 0.45897759575638836, 'recall': 0.5194205509204992, 'f1-score': 0.48733206712968347, 'support': 464096}, '1': {'precision': 0.3806217657550013, 'recall': 0.3738103455714224, 'f1-score': 0.37718530707482284, 'support': 463580}, '2': {'precision': 0.4687366411125994, 'recall': 0.41648993751701346, 'f1-score': 0.44107147047288303, 'support': 473889}, 'accuracy': 0.43645638982137824, 'macro avg': {'precision': 0.43611200087466306, 'recall': 0.4365736113363117, 'f1-score': 0.43519628155912976, 'support': 1401565}, 'weighted avg': {'precision': 0.4363603846907343, 'recall': 0.43645638982137824, 'f1-score': 0.43525868992967726, 'support': 1401565}}
[[241061 124503  98532]
 [165123 173291 125166]
 [119029 157490 197370]]
Evaluating performance on  val set...
2036/2036 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475022
{'0': {'precision': 0.4999796014710253, 'recall': 0.4836258266011963, 'f1-score': 0.49166676218750355, 'support': 177383}, '1': {'precision': 0.3746897751964328, 'recall': 0.4500754558274164, 'f1-score': 0.40893739217416225, 'support': 161684}, '2': {'precision': 0.4919605458721794, 'recall': 0.4197717253457334, 'f1-score': 0.45300826495245433, 'support': 182149}, 'accuracy': 0.4509032723477407, 'macro avg': {'precision': 0.45554330751321254, 'recall': 0.4511576692581154, 'f1-score': 0.45120413977137336, 'support': 521216}, 'weighted avg': {'precision': 0.4583116111759166, 'recall': 0.4509032723477407, 'f1-score': 0.4524937090308391, 'support': 521216}}
[[85787 53410 38186]
 [48140 72770 40774]
 [37654 68034 76461]]
training model: results/AAPL/W3/deepOF_L2/h50
Epoch 1/50
5475/5475 - 160s - loss: 3.1981 - accuracy50: 0.4250 - val_loss: 3.3127 - val_accuracy50: 0.3617 - 160s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 161s - loss: 3.1730 - accuracy50: 0.4358 - val_loss: 3.3117 - val_accuracy50: 0.3637 - 161s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 157s - loss: 3.1614 - accuracy50: 0.4410 - val_loss: 3.3175 - val_accuracy50: 0.3626 - 157s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 157s - loss: 3.1537 - accuracy50: 0.4440 - val_loss: 3.3201 - val_accuracy50: 0.3635 - 157s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 156s - loss: 3.1475 - accuracy50: 0.4466 - val_loss: 3.3157 - val_accuracy50: 0.3650 - 156s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 156s - loss: 3.1427 - accuracy50: 0.4483 - val_loss: 3.3100 - val_accuracy50: 0.3663 - 156s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 157s - loss: 3.1391 - accuracy50: 0.4495 - val_loss: 3.3054 - val_accuracy50: 0.3681 - 157s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 156s - loss: 3.1359 - accuracy50: 0.4514 - val_loss: 3.3021 - val_accuracy50: 0.3709 - 156s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 155s - loss: 3.1333 - accuracy50: 0.4520 - val_loss: 3.3001 - val_accuracy50: 0.3725 - 155s/epoch - 28ms/step
Epoch 10/50
5475/5475 - 155s - loss: 3.1308 - accuracy50: 0.4530 - val_loss: 3.2933 - val_accuracy50: 0.3749 - 155s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 158s - loss: 3.1287 - accuracy50: 0.4538 - val_loss: 3.2965 - val_accuracy50: 0.3742 - 158s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 158s - loss: 3.1269 - accuracy50: 0.4542 - val_loss: 3.2883 - val_accuracy50: 0.3776 - 158s/epoch - 29ms/step
Epoch 13/50
5475/5475 - 153s - loss: 3.1253 - accuracy50: 0.4548 - val_loss: 3.2847 - val_accuracy50: 0.3794 - 153s/epoch - 28ms/step
Epoch 14/50
5475/5475 - 155s - loss: 3.1235 - accuracy50: 0.4556 - val_loss: 3.2827 - val_accuracy50: 0.3820 - 155s/epoch - 28ms/step
Epoch 15/50
5475/5475 - 157s - loss: 3.1214 - accuracy50: 0.4565 - val_loss: 3.2867 - val_accuracy50: 0.3821 - 157s/epoch - 29ms/step
Epoch 16/50
5475/5475 - 161s - loss: 3.1200 - accuracy50: 0.4566 - val_loss: 3.2765 - val_accuracy50: 0.3844 - 161s/epoch - 29ms/step
Epoch 17/50
5475/5475 - 162s - loss: 3.1184 - accuracy50: 0.4575 - val_loss: 3.2784 - val_accuracy50: 0.3849 - 162s/epoch - 30ms/step
Epoch 18/50
5475/5475 - 163s - loss: 3.1168 - accuracy50: 0.4577 - val_loss: 3.2758 - val_accuracy50: 0.3859 - 163s/epoch - 30ms/step
Epoch 19/50
5475/5475 - 159s - loss: 3.1153 - accuracy50: 0.4583 - val_loss: 3.2767 - val_accuracy50: 0.3857 - 159s/epoch - 29ms/step
Epoch 20/50
5475/5475 - 162s - loss: 3.1138 - accuracy50: 0.4592 - val_loss: 3.2684 - val_accuracy50: 0.3884 - 162s/epoch - 30ms/step
Epoch 21/50
5475/5475 - 153s - loss: 3.1122 - accuracy50: 0.4595 - val_loss: 3.2730 - val_accuracy50: 0.3888 - 153s/epoch - 28ms/step
Epoch 22/50
5475/5475 - 157s - loss: 3.1106 - accuracy50: 0.4600 - val_loss: 3.2673 - val_accuracy50: 0.3903 - 157s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 157s - loss: 3.1094 - accuracy50: 0.4605 - val_loss: 3.2719 - val_accuracy50: 0.3904 - 157s/epoch - 29ms/step
Epoch 24/50
5475/5475 - 156s - loss: 3.1076 - accuracy50: 0.4611 - val_loss: 3.2683 - val_accuracy50: 0.3937 - 156s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 154s - loss: 3.1061 - accuracy50: 0.4621 - val_loss: 3.2675 - val_accuracy50: 0.3930 - 154s/epoch - 28ms/step
Epoch 26/50
5475/5475 - 154s - loss: 3.1044 - accuracy50: 0.4625 - val_loss: 3.2721 - val_accuracy50: 0.3944 - 154s/epoch - 28ms/step
Epoch 27/50
5475/5475 - 154s - loss: 3.1029 - accuracy50: 0.4628 - val_loss: 3.2673 - val_accuracy50: 0.3951 - 154s/epoch - 28ms/step
Epoch 28/50
5475/5475 - 157s - loss: 3.1011 - accuracy50: 0.4638 - val_loss: 3.2673 - val_accuracy50: 0.3961 - 157s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 154s - loss: 3.1001 - accuracy50: 0.4640 - val_loss: 3.2714 - val_accuracy50: 0.3935 - 154s/epoch - 28ms/step
Epoch 30/50
5475/5475 - 158s - loss: 3.0979 - accuracy50: 0.4649 - val_loss: 3.2691 - val_accuracy50: 0.3958 - 158s/epoch - 29ms/step
Epoch 31/50
5475/5475 - 157s - loss: 3.0965 - accuracy50: 0.4652 - val_loss: 3.2715 - val_accuracy50: 0.3958 - 157s/epoch - 29ms/step
Epoch 32/50
5475/5475 - 157s - loss: 3.0950 - accuracy50: 0.4663 - val_loss: 3.2600 - val_accuracy50: 0.3993 - 157s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 153s - loss: 3.0933 - accuracy50: 0.4664 - val_loss: 3.2760 - val_accuracy50: 0.3951 - 153s/epoch - 28ms/step
Epoch 34/50
5475/5475 - 157s - loss: 3.0909 - accuracy50: 0.4673 - val_loss: 3.2747 - val_accuracy50: 0.3979 - 157s/epoch - 29ms/step
Epoch 35/50
5475/5475 - 153s - loss: 3.0897 - accuracy50: 0.4678 - val_loss: 3.2804 - val_accuracy50: 0.3956 - 153s/epoch - 28ms/step
Epoch 36/50
5475/5475 - 157s - loss: 3.0879 - accuracy50: 0.4683 - val_loss: 3.2758 - val_accuracy50: 0.3977 - 157s/epoch - 29ms/step
Epoch 37/50
5475/5475 - 171s - loss: 3.0862 - accuracy50: 0.4690 - val_loss: 3.2810 - val_accuracy50: 0.3954 - 171s/epoch - 31ms/step
Epoch 38/50
5475/5475 - 158s - loss: 3.0845 - accuracy50: 0.4698 - val_loss: 3.2743 - val_accuracy50: 0.3989 - 158s/epoch - 29ms/step
Epoch 39/50
5475/5475 - 157s - loss: 3.0827 - accuracy50: 0.4701 - val_loss: 3.2854 - val_accuracy50: 0.3956 - 157s/epoch - 29ms/step
Epoch 40/50
5475/5475 - 160s - loss: 3.0812 - accuracy50: 0.4705 - val_loss: 3.2884 - val_accuracy50: 0.3956 - 160s/epoch - 29ms/step
Epoch 41/50
5475/5475 - 159s - loss: 3.0792 - accuracy50: 0.4717 - val_loss: 3.2913 - val_accuracy50: 0.3958 - 159s/epoch - 29ms/step
Epoch 42/50
5475/5475 - 162s - loss: 3.0775 - accuracy50: 0.4724 - val_loss: 3.2875 - val_accuracy50: 0.3972 - 162s/epoch - 30ms/step
testing model: results/AAPL/W3/deepOF_L2/h50
Evaluating performance on  test set...
13689/13689 - 209s - 209s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1139364
{'0': {'precision': 0.48972755404557355, 'recall': 0.19794920328918192, 'f1-score': 0.28193821622763054, 'support': 1143263}, '1': {'precision': 0.35534251477956574, 'recall': 0.7949854937320731, 'f1-score': 0.4911505978569266, 'support': 1213958}, '2': {'precision': 0.465054257862792, 'recall': 0.13226436133253008, 'f1-score': 0.20595408354776987, 'support': 1147021}, 'accuracy': 0.3832774677091365, 'macro avg': {'precision': 0.43670810889597717, 'recall': 0.375066352784595, 'f1-score': 0.326347632544109, 'support': 3504242}, 'weighted avg': {'precision': 0.43509702842600884, 'recall': 0.3832774677091365, 'f1-score': 0.3295432756177499, 'support': 3504242}}
[[226308 840164  76791]
 [151160 965079  97719]
 [ 84642 910669 151710]]
Evaluating performance on  train set...
5475/5475 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893284
{'0': {'precision': 0.502276575558249, 'recall': 0.2376258249628995, 'f1-score': 0.3226206200777357, 'support': 465627}, '1': {'precision': 0.3512415845054899, 'recall': 0.7060644313406769, 'f1-score': 0.46911525312488117, 'support': 462632}, '2': {'precision': 0.46092472253946526, 'recall': 0.24472328683769062, 'f1-score': 0.31970334100190034, 'support': 473306}, 'accuracy': 0.39464598502388404, 'macro avg': {'precision': 0.4381476275344014, 'recall': 0.39613784771375565, 'f1-score': 0.37047973806817236, 'support': 1401565}, 'weighted avg': {'precision': 0.4384581296598222, 'recall': 0.39464598502388404, 'f1-score': 0.3699907665822501, 'support': 1401565}}
[[110645 290749  64233]
 [ 64749 326648  71235]
 [ 44893 312584 115829]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087894
{'0': {'precision': 0.5082950553904351, 'recall': 0.2210562805153906, 'f1-score': 0.3081143718189672, 'support': 170201}, '1': {'precision': 0.36454055123954676, 'recall': 0.7387109353239374, 'f1-score': 0.4881753523097086, 'support': 179510}, '2': {'precision': 0.4531366109739435, 'recall': 0.2204425526952567, 'f1-score': 0.2965964407171912, 'support': 171505}, 'accuracy': 0.39913778548624756, 'macro avg': {'precision': 0.44199073920130844, 'recall': 0.3934032561781949, 'f1-score': 0.3642953882819557, 'support': 521216}, 'weighted avg': {'precision': 0.4406353518322627, 'recall': 0.39913778548624756, 'f1-score': 0.3663385319258767, 'support': 521216}}
[[ 37624 111395  21182]
 [ 22459 132606  24445]
 [ 13937 119761  37807]]
training model: results/AAPL/W3/deepOF_L2/h100
Epoch 1/50
5475/5475 - 158s - loss: 3.2405 - accuracy100: 0.4030 - val_loss: 3.4273 - val_accuracy100: 0.3534 - 158s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 156s - loss: 3.2238 - accuracy100: 0.4116 - val_loss: 3.4301 - val_accuracy100: 0.3535 - 156s/epoch - 28ms/step
Epoch 3/50
5475/5475 - 153s - loss: 3.2146 - accuracy100: 0.4160 - val_loss: 3.4425 - val_accuracy100: 0.3535 - 153s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 157s - loss: 3.2081 - accuracy100: 0.4191 - val_loss: 3.4480 - val_accuracy100: 0.3536 - 157s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 156s - loss: 3.2041 - accuracy100: 0.4210 - val_loss: 3.4443 - val_accuracy100: 0.3535 - 156s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 156s - loss: 3.2014 - accuracy100: 0.4223 - val_loss: 3.4442 - val_accuracy100: 0.3538 - 156s/epoch - 28ms/step
Epoch 7/50
5475/5475 - 158s - loss: 3.1991 - accuracy100: 0.4234 - val_loss: 3.4519 - val_accuracy100: 0.3538 - 158s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 157s - loss: 3.1975 - accuracy100: 0.4236 - val_loss: 3.4487 - val_accuracy100: 0.3538 - 157s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 156s - loss: 3.1959 - accuracy100: 0.4249 - val_loss: 3.4478 - val_accuracy100: 0.3537 - 156s/epoch - 28ms/step
Epoch 10/50
5475/5475 - 157s - loss: 3.1943 - accuracy100: 0.4255 - val_loss: 3.4383 - val_accuracy100: 0.3540 - 157s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.1933 - accuracy100: 0.4259 - val_loss: 3.4343 - val_accuracy100: 0.3539 - 159s/epoch - 29ms/step
testing model: results/AAPL/W3/deepOF_L2/h100
Evaluating performance on  test set...
13689/13689 - 203s - 203s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1881101
{'0': {'precision': 0.49819382805243057, 'recall': 0.003946219575603583, 'f1-score': 0.007830414028883473, 'support': 1223196}, '1': {'precision': 0.30163020360860104, 'recall': 0.9963591188083494, 'f1-score': 0.4630731527341633, 'support': 1056887}, '2': {'precision': 0.3871538008249853, 'recall': 0.001073389976302098, 'f1-score': 0.002140844427898429, 'support': 1224159}, 'accuracy': 0.3022565222379048, 'macro avg': {'precision': 0.39565927749533897, 'recall': 0.3337929094534183, 'f1-score': 0.15768147039698172, 'support': 3504242}, 'weighted avg': {'precision': 0.40011949755862114, 'recall': 0.3022565222379048, 'f1-score': 0.1431450397165029, 'support': 3504242}}
[[   4827 1217310    1059]
 [   2827 1053039    1021]
 [   2035 1220810    1314]]
Evaluating performance on  train set...
5475/5475 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1694478
{'0': {'precision': 0.4346914319952067, 'recall': 0.003090521831735889, 'f1-score': 0.00613740858391246, 'support': 469500}, '1': {'precision': 0.3276813095048821, 'recall': 0.9964176127145349, 'f1-score': 0.49317679014607874, 'support': 459191}, '2': {'precision': 0.3737584945112389, 'recall': 0.0015120306889361648, 'f1-score': 0.0030118769048015216, 'support': 472874}, 'accuracy': 0.32799905819565983, 'macro avg': {'precision': 0.37871041200377586, 'recall': 0.3336733884117356, 'f1-score': 0.16744202521159757, 'support': 1401565}, 'weighted avg': {'precision': 0.37907382807655254, 'recall': 0.32799905819565983, 'f1-score': 0.16465029809790918, 'support': 1401565}}
[[  1451 467448    601]
 [  1048 457546    597]
 [   839 471320    715]]
Evaluating performance on  val set...
2036/2036 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1459671
{'0': {'precision': 0.4517241379310345, 'recall': 0.0031035851146371946, 'f1-score': 0.006164814673200116, 'support': 168837}, '1': {'precision': 0.3531782850235036, 'recall': 0.996848750910059, 'f1-score': 0.5215678247966024, 'support': 184054}, '2': {'precision': 0.3505338078291815, 'recall': 0.0011703549680677262, 'f1-score': 0.002332920828719795, 'support': 168325}, 'accuracy': 0.3533947538064833, 'macro avg': {'precision': 0.3851454102612399, 'recall': 0.33370756366425464, 'f1-score': 0.17668852009950742, 'support': 521216}, 'weighted avg': {'precision': 0.3842461235848957, 'recall': 0.3533947538064833, 'f1-score': 0.18692860951810228, 'support': 521216}}
[[   524 168138    175]
 [   390 183474    190]
 [   246 167882    197]]
training model: results/AAPL/W3/deepOF_L2/h200
Epoch 1/50
5475/5475 - 161s - loss: 3.2632 - accuracy200: 0.3867 - val_loss: 3.3822 - val_accuracy200: 0.3364 - 161s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 156s - loss: 3.2516 - accuracy200: 0.3933 - val_loss: 3.3860 - val_accuracy200: 0.3367 - 156s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 157s - loss: 3.2449 - accuracy200: 0.3968 - val_loss: 3.4012 - val_accuracy200: 0.3369 - 157s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 156s - loss: 3.2399 - accuracy200: 0.3997 - val_loss: 3.4042 - val_accuracy200: 0.3368 - 156s/epoch - 28ms/step
Epoch 5/50
5475/5475 - 157s - loss: 3.2369 - accuracy200: 0.4016 - val_loss: 3.3949 - val_accuracy200: 0.3368 - 157s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 154s - loss: 3.2351 - accuracy200: 0.4029 - val_loss: 3.3970 - val_accuracy200: 0.3368 - 154s/epoch - 28ms/step
Epoch 7/50
5475/5475 - 155s - loss: 3.2335 - accuracy200: 0.4034 - val_loss: 3.3934 - val_accuracy200: 0.3368 - 155s/epoch - 28ms/step
Epoch 8/50
5475/5475 - 157s - loss: 3.2324 - accuracy200: 0.4044 - val_loss: 3.3874 - val_accuracy200: 0.3369 - 157s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 157s - loss: 3.2311 - accuracy200: 0.4051 - val_loss: 3.3869 - val_accuracy200: 0.3369 - 157s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 156s - loss: 3.2301 - accuracy200: 0.4055 - val_loss: 3.3867 - val_accuracy200: 0.3369 - 156s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 153s - loss: 3.2292 - accuracy200: 0.4063 - val_loss: 3.3854 - val_accuracy200: 0.3370 - 153s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h200
Evaluating performance on  test set...
13689/13689 - 198s - 198s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1308465
{'0': {'precision': 0.3768349275499574, 'recall': 0.0034072352585054577, 'f1-score': 0.00675340810341082, 'support': 1167809}, '1': {'precision': 0.33362494862723346, 'recall': 0.9928650849313194, 'f1-score': 0.4994301571423962, 'support': 1169180}, '2': {'precision': 0.3571378315626539, 'recall': 0.004348671624746306, 'f1-score': 0.008592714475067417, 'support': 1167253}, 'accuracy': 0.3338505160317124, 'macro avg': {'precision': 0.3558659025799482, 'recall': 0.33354033060485705, 'f1-score': 0.17159209324029145, 'support': 3504242}, 'weighted avg': {'precision': 0.35585699921642955, 'recall': 0.3338505160317124, 'f1-score': 0.17174621890861097, 'support': 3504242}}
[[   3979 1159490    4340]
 [   3545 1160838    4797]
 [   3035 1159142    5076]]
Evaluating performance on  train set...
5475/5475 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1343122
{'0': {'precision': 0.3728343728343728, 'recall': 0.0034281272102818327, 'f1-score': 0.006793787094330091, 'support': 470811}, '1': {'precision': 0.32887771069744776, 'recall': 0.9926279958258576, 'f1-score': 0.49406252463374684, 'support': 460933}, '2': {'precision': 0.3584092792046396, 'recall': 0.004603881052571085, 'f1-score': 0.009090985508220973, 'support': 469821}, 'accuracy': 0.3291406392140215, 'macro avg': {'precision': 0.35337378757882004, 'recall': 0.3335533346962369, 'f1-score': 0.1699824324120993, 'support': 1401565}, 'weighted avg': {'precision': 0.35354287507081983, 'recall': 0.3291406392140215, 'f1-score': 0.16781201532938778, 'support': 1401565}}
[[  1614 467291   1906]
 [  1432 457535   1966]
 [  1283 466375   2163]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296548
{'0': {'precision': 0.36234567901234566, 'recall': 0.0033785728263747397, 'f1-score': 0.006694722916025138, 'support': 173742}, '1': {'precision': 0.336517339114004, 'recall': 0.9925972782602749, 'f1-score': 0.5026296310724998, 'support': 175476}, '2': {'precision': 0.34992533598805375, 'recall': 0.004087256828567774, 'f1-score': 0.008080134707224424, 'support': 171998}, 'accuracy': 0.3366492970284872, 'macro avg': {'precision': 0.34959611803813445, 'recall': 0.33335436930507245, 'f1-score': 0.17246816289858313, 'support': 521216}, 'weighted avg': {'precision': 0.3495515055190271, 'recall': 0.3366492970284872, 'f1-score': 0.17411660175498683, 'support': 521216}}
[[   587 172575    580]
 [   573 174177    726]
 [   460 170835    703]]
training model: results/AAPL/W3/deepOF_L2/h300
Epoch 1/50
5475/5475 - 167s - loss: 3.2691 - accuracy300: 0.3824 - val_loss: 3.3694 - val_accuracy300: 0.3444 - 167s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 159s - loss: 3.2597 - accuracy300: 0.3869 - val_loss: 3.3644 - val_accuracy300: 0.3446 - 159s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 159s - loss: 3.2550 - accuracy300: 0.3897 - val_loss: 3.3646 - val_accuracy300: 0.3446 - 159s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 153s - loss: 3.2497 - accuracy300: 0.3931 - val_loss: 3.3731 - val_accuracy300: 0.3446 - 153s/epoch - 28ms/step
Epoch 5/50
5475/5475 - 156s - loss: 3.2467 - accuracy300: 0.3946 - val_loss: 3.3718 - val_accuracy300: 0.3446 - 156s/epoch - 28ms/step
Epoch 6/50
5475/5475 - 154s - loss: 3.2447 - accuracy300: 0.3960 - val_loss: 3.3713 - val_accuracy300: 0.3446 - 154s/epoch - 28ms/step
Epoch 7/50
5475/5475 - 155s - loss: 3.2431 - accuracy300: 0.3971 - val_loss: 3.3719 - val_accuracy300: 0.3446 - 155s/epoch - 28ms/step
Epoch 8/50
5475/5475 - 155s - loss: 3.2422 - accuracy300: 0.3979 - val_loss: 3.3689 - val_accuracy300: 0.3447 - 155s/epoch - 28ms/step
Epoch 9/50
5475/5475 - 155s - loss: 3.2409 - accuracy300: 0.3987 - val_loss: 3.3704 - val_accuracy300: 0.3446 - 155s/epoch - 28ms/step
Epoch 10/50
5475/5475 - 154s - loss: 3.2399 - accuracy300: 0.3993 - val_loss: 3.3681 - val_accuracy300: 0.3447 - 154s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 155s - loss: 3.2391 - accuracy300: 0.3999 - val_loss: 3.3683 - val_accuracy300: 0.3446 - 155s/epoch - 28ms/step
Epoch 12/50
5475/5475 - 155s - loss: 3.2383 - accuracy300: 0.4006 - val_loss: 3.3679 - val_accuracy300: 0.3446 - 155s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h300
Evaluating performance on  test set...
13689/13689 - 187s - 187s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1195674
{'0': {'precision': 0.37254309041427275, 'recall': 0.0010863680212758828, 'f1-score': 0.002166418577742687, 'support': 1134054}, '1': {'precision': 0.3530036995158605, 'recall': 0.997100399574154, 'f1-score': 0.5214118379103622, 'support': 1237067}, '2': {'precision': 0.3298476247385719, 'recall': 0.0019486003701281681, 'f1-score': 0.0038743129367485073, 'support': 1133121}, 'accuracy': 0.3529779050647758, 'macro avg': {'precision': 0.3517981382229018, 'recall': 0.33337845598851934, 'f1-score': 0.1758175231416178, 'support': 3504242}, 'weighted avg': {'precision': 0.35183942199113244, 'recall': 0.3529779050647758, 'f1-score': 0.18602262032451605, 'support': 3504242}}
[[   1232 1130772    2050]
 [   1151 1233480    2436]
 [    924 1129989    2208]]
Evaluating performance on  train set...
5475/5475 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1330115
{'0': {'precision': 0.4109396914446003, 'recall': 0.001241862199918622, 'f1-score': 0.0024762411842010747, 'support': 471872}, '1': {'precision': 0.3281783681893644, 'recall': 0.9967970323080068, 'f1-score': 0.49378610856631056, 'support': 459886}, '2': {'precision': 0.35627653123104913, 'recall': 0.0025010270174773896, 'f1-score': 0.004967184874393633, 'support': 469807}, 'accuracy': 0.32832868971471174, 'macro avg': {'precision': 0.36513153028833795, 'recall': 0.3335133071751342, 'f1-score': 0.16707651154163508, 'support': 1401565}, 'weighted avg': {'precision': 0.3654605954219362, 'recall': 0.32832868971471174, 'f1-score': 0.16452137819400592, 'support': 1401565}}
[[   586 470187   1099]
 [   449 458413   1024]
 [   391 468241   1175]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1238701
{'0': {'precision': 0.36855670103092786, 'recall': 0.0008338435522901543, 'f1-score': 0.0016639225519684902, 'support': 171495}, '1': {'precision': 0.34460651269434883, 'recall': 0.9975555704040269, 'f1-score': 0.5122542957586397, 'support': 179592}, '2': {'precision': 0.3512092534174553, 'recall': 0.0019632161477467097, 'f1-score': 0.0039046060322656066, 'support': 170129}, 'accuracy': 0.3446363887524558, 'macro avg': {'precision': 0.35479082238091064, 'recall': 0.3334508767013546, 'f1-score': 0.17260760811429124, 'support': 521216}, 'weighted avg': {'precision': 0.3546419974554901, 'recall': 0.3446363887524558, 'f1-score': 0.17832609628560667, 'support': 521216}}
[[   143 171033    319]
 [   141 179153    298]
 [   104 169691    334]]
training model: results/AAPL/W3/deepOF_L2/h500
Epoch 1/50
5475/5475 - 158s - loss: 3.2656 - accuracy500: 0.3826 - val_loss: 3.4143 - val_accuracy500: 0.3415 - 158s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 156s - loss: 3.2570 - accuracy500: 0.3852 - val_loss: 3.4056 - val_accuracy500: 0.3416 - 156s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 154s - loss: 3.2538 - accuracy500: 0.3877 - val_loss: 3.4102 - val_accuracy500: 0.3416 - 154s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 158s - loss: 3.2497 - accuracy500: 0.3911 - val_loss: 3.4206 - val_accuracy500: 0.3416 - 158s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 160s - loss: 3.2459 - accuracy500: 0.3933 - val_loss: 3.4277 - val_accuracy500: 0.3415 - 160s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 158s - loss: 3.2428 - accuracy500: 0.3955 - val_loss: 3.4372 - val_accuracy500: 0.3416 - 158s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 156s - loss: 3.2403 - accuracy500: 0.3974 - val_loss: 3.4377 - val_accuracy500: 0.3415 - 156s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 157s - loss: 3.2386 - accuracy500: 0.3993 - val_loss: 3.4407 - val_accuracy500: 0.3415 - 157s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 158s - loss: 3.2370 - accuracy500: 0.4001 - val_loss: 3.4360 - val_accuracy500: 0.3415 - 158s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 152s - loss: 3.2356 - accuracy500: 0.4010 - val_loss: 3.4330 - val_accuracy500: 0.3415 - 152s/epoch - 28ms/step
Epoch 11/50
5475/5475 - 156s - loss: 3.2344 - accuracy500: 0.4023 - val_loss: 3.4318 - val_accuracy500: 0.3415 - 156s/epoch - 28ms/step
Epoch 12/50
5475/5475 - 156s - loss: 3.2336 - accuracy500: 0.4026 - val_loss: 3.4298 - val_accuracy500: 0.3415 - 156s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h500
Evaluating performance on  test set...
13689/13689 - 197s - 197s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1293919
{'0': {'precision': 0.2942271880819367, 'recall': 0.0001389939651987262, 'f1-score': 0.0002778566699229827, 'support': 1136740}, '1': {'precision': 0.35350363856579875, 'recall': 0.9991629239059892, 'f1-score': 0.522239166576835, 'support': 1238836}, '2': {'precision': 0.33180987202925044, 'recall': 0.0006432372375884451, 'f1-score': 0.0012839853774227264, 'support': 1128666}, 'accuracy': 0.35348100958780815, 'macro avg': {'precision': 0.32651356622566197, 'recall': 0.3333150517029254, 'f1-score': 0.17460033620806023, 'support': 3504242}, 'weighted avg': {'precision': 0.3272877182541407, 'recall': 0.35348100958780815, 'f1-score': 0.1851281166073412, 'support': 3504242}}
[[    158 1135929     653]
 [    228 1237799     809]
 [    151 1127789     726]]
Evaluating performance on  train set...
5475/5475 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1442076
{'0': {'precision': 0.36443148688046645, 'recall': 0.0002655624932281564, 'f1-score': 0.0005307382356562684, 'support': 470699}, '1': {'precision': 0.3301375969186062, 'recall': 0.9988178136251843, 'f1-score': 0.4962503785056061, 'support': 462702}, '2': {'precision': 0.33308383233532934, 'recall': 0.0009505216120846541, 'f1-score': 0.0018956336528221512, 'support': 468164}, 'accuracy': 0.33014879795086205, 'macro avg': {'precision': 0.3425509720448006, 'recall': 0.3333446325768324, 'f1-score': 0.16622558346469482, 'support': 1401565}, 'weighted avg': {'precision': 0.3426389229853904, 'recall': 0.33014879795086205, 'f1-score': 0.16463976199857014, 'support': 1401565}}
[[   125 470103    471]
 [   127 462155    420]
 [    91 467628    445]]
Evaluating performance on  val set...
2036/2036 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1370322
{'0': {'precision': 0.3924050632911392, 'recall': 0.00017991456959791995, 'f1-score': 0.00035966423603255536, 'support': 172304}, '1': {'precision': 0.341586592007128, 'recall': 0.9991294140113794, 'f1-score': 0.5091148460586287, 'support': 178041}, '2': {'precision': 0.32707774798927614, 'recall': 0.0007139889156147034, 'f1-score': 0.0014248674406110579, 'support': 170871}, 'accuracy': 0.3415839114685658, 'macro avg': {'precision': 0.3536898010958478, 'recall': 0.33334110583219734, 'f1-score': 0.1702997925784241, 'support': 521216}, 'weighted avg': {'precision': 0.3536297472248226, 'recall': 0.3415839114685658, 'f1-score': 0.17449340852562914, 'support': 521216}}
[[    31 172146    127]
 [    31 177886    124]
 [    17 170732    122]]
training model: results/AAPL/W3/deepOF_L2/h1000
Epoch 1/50
5475/5475 - 160s - loss: 3.2664 - accuracy1000: 0.3830 - val_loss: 3.4064 - val_accuracy1000: 0.3406 - 160s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 156s - loss: 3.2593 - accuracy1000: 0.3838 - val_loss: 3.4105 - val_accuracy1000: 0.3406 - 156s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 156s - loss: 3.2538 - accuracy1000: 0.3884 - val_loss: 3.4209 - val_accuracy1000: 0.3404 - 156s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 155s - loss: 3.2487 - accuracy1000: 0.3924 - val_loss: 3.4299 - val_accuracy1000: 0.3402 - 155s/epoch - 28ms/step
Epoch 5/50
5475/5475 - 157s - loss: 3.2452 - accuracy1000: 0.3948 - val_loss: 3.4319 - val_accuracy1000: 0.3404 - 157s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 162s - loss: 3.2424 - accuracy1000: 0.3968 - val_loss: 3.4409 - val_accuracy1000: 0.3402 - 162s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 158s - loss: 3.2401 - accuracy1000: 0.3979 - val_loss: 3.4359 - val_accuracy1000: 0.3403 - 158s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 174s - loss: 3.2388 - accuracy1000: 0.3991 - val_loss: 3.4376 - val_accuracy1000: 0.3404 - 174s/epoch - 32ms/step
Epoch 9/50
5475/5475 - 158s - loss: 3.2377 - accuracy1000: 0.4000 - val_loss: 3.4290 - val_accuracy1000: 0.3404 - 158s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 175s - loss: 3.2364 - accuracy1000: 0.4011 - val_loss: 3.4303 - val_accuracy1000: 0.3405 - 175s/epoch - 32ms/step
Epoch 11/50
5475/5475 - 154s - loss: 3.2351 - accuracy1000: 0.4020 - val_loss: 3.4308 - val_accuracy1000: 0.3404 - 154s/epoch - 28ms/step
testing model: results/AAPL/W3/deepOF_L2/h1000
Evaluating performance on  test set...
13689/13689 - 200s - 200s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1377075
{'0': {'precision': 0.3132137030995106, 'recall': 0.00016416303783701517, 'f1-score': 0.00032815408201459264, 'support': 1169569}, '1': {'precision': 0.338549774799548, 'recall': 0.9987761800127944, 'f1-score': 0.5056889079310999, 'support': 1186449}, '2': {'precision': 0.3406561218512009, 'recall': 0.0010128685691990413, 'f1-score': 0.0020197318949183684, 'support': 1148224}, 'accuracy': 0.3385473948431644, 'macro avg': {'precision': 0.3308065332500865, 'recall': 0.3333177372066102, 'f1-score': 0.16934559796934426, 'support': 3504242}, 'weighted avg': {'precision': 0.33078383688626917, 'recall': 0.3385473948431644, 'f1-score': 0.17198498351506655, 'support': 3504242}}
[[    192 1168351    1026]
 [    227 1184997    1225]
 [    194 1146867    1163]]
Evaluating performance on  train set...
5475/5475 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1414984
{'0': {'precision': 0.37017994858611825, 'recall': 0.00030692499520429693, 'f1-score': 0.000613341454428517, 'support': 469170}, '1': {'precision': 0.3320524355757501, 'recall': 0.9984592275508165, 'f1-score': 0.49836589564685757, 'support': 465351}, '2': {'precision': 0.34686346863468637, 'recall': 0.001408860835381677, 'f1-score': 0.002806323183513491, 'support': 467044}, 'accuracy': 0.33208306428884854, 'macro avg': {'precision': 0.3496986175988515, 'recall': 0.33339167112713414, 'f1-score': 0.16726185342826652, 'support': 1401565}, 'weighted avg': {'precision': 0.3497510006819366, 'recall': 0.33208306428884854, 'f1-score': 0.16660911603832568, 'support': 1401565}}
[[   144 468383    643]
 [   121 464634    596]
 [   124 466262    658]]
Evaluating performance on  val set...
2036/2036 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1363741
{'0': {'precision': 0.3191489361702128, 'recall': 0.0001750608336396898, 'f1-score': 0.00034992972244740845, 'support': 171369}, '1': {'precision': 0.34066231730370233, 'recall': 0.9985134381809889, 'f1-score': 0.5080078553042641, 'support': 177591}, '2': {'precision': 0.295221843003413, 'recall': 0.0010043191528887239, 'f1-score': 0.002001828259335115, 'support': 172256}, 'accuracy': 0.3406073489685658, 'macro avg': {'precision': 0.3183443654924427, 'recall': 0.3332309393891724, 'f1-score': 0.17011987109534887, 'support': 521216}, 'weighted avg': {'precision': 0.3185714356873751, 'recall': 0.3406073489685658, 'f1-score': 0.17386729698740191, 'support': 521216}}
[[    30 171150    189]
 [    40 177327    224]
 [    24 172059    173]]
training model: results/AAPL/W3/deepVOL_L2/h10
Epoch 1/50
5475/5475 - 166s - loss: 3.1470 - accuracy10: 0.4459 - val_loss: 3.1718 - val_accuracy10: 0.4266 - 166s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 158s - loss: 3.0714 - accuracy10: 0.4731 - val_loss: 3.1092 - val_accuracy10: 0.4456 - 158s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 157s - loss: 3.0380 - accuracy10: 0.4845 - val_loss: 3.0906 - val_accuracy10: 0.4562 - 157s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 156s - loss: 3.0216 - accuracy10: 0.4893 - val_loss: 3.0720 - val_accuracy10: 0.4619 - 156s/epoch - 28ms/step
Epoch 5/50
5475/5475 - 158s - loss: 3.0111 - accuracy10: 0.4927 - val_loss: 3.0703 - val_accuracy10: 0.4659 - 158s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 156s - loss: 3.0026 - accuracy10: 0.4949 - val_loss: 3.0680 - val_accuracy10: 0.4683 - 156s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 159s - loss: 2.9950 - accuracy10: 0.4974 - val_loss: 3.0420 - val_accuracy10: 0.4742 - 159s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 161s - loss: 2.9890 - accuracy10: 0.4990 - val_loss: 3.0317 - val_accuracy10: 0.4772 - 161s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 162s - loss: 2.9838 - accuracy10: 0.5006 - val_loss: 3.0266 - val_accuracy10: 0.4789 - 162s/epoch - 30ms/step
Epoch 10/50
5475/5475 - 161s - loss: 2.9796 - accuracy10: 0.5021 - val_loss: 3.0224 - val_accuracy10: 0.4813 - 161s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 162s - loss: 2.9754 - accuracy10: 0.5031 - val_loss: 3.0187 - val_accuracy10: 0.4825 - 162s/epoch - 30ms/step
Epoch 12/50
5475/5475 - 160s - loss: 2.9716 - accuracy10: 0.5041 - val_loss: 3.0077 - val_accuracy10: 0.4844 - 160s/epoch - 29ms/step
Epoch 13/50
5475/5475 - 154s - loss: 2.9684 - accuracy10: 0.5050 - val_loss: 3.0030 - val_accuracy10: 0.4856 - 154s/epoch - 28ms/step
Epoch 14/50
5475/5475 - 159s - loss: 2.9653 - accuracy10: 0.5058 - val_loss: 3.0011 - val_accuracy10: 0.4869 - 159s/epoch - 29ms/step
Epoch 15/50
5475/5475 - 159s - loss: 2.9627 - accuracy10: 0.5068 - val_loss: 2.9950 - val_accuracy10: 0.4883 - 159s/epoch - 29ms/step
Epoch 16/50
5475/5475 - 160s - loss: 2.9597 - accuracy10: 0.5075 - val_loss: 3.0005 - val_accuracy10: 0.4862 - 160s/epoch - 29ms/step
Epoch 17/50
5475/5475 - 159s - loss: 2.9576 - accuracy10: 0.5081 - val_loss: 2.9952 - val_accuracy10: 0.4882 - 159s/epoch - 29ms/step
Epoch 18/50
5475/5475 - 156s - loss: 2.9547 - accuracy10: 0.5089 - val_loss: 2.9976 - val_accuracy10: 0.4878 - 156s/epoch - 29ms/step
Epoch 19/50
5475/5475 - 161s - loss: 2.9526 - accuracy10: 0.5088 - val_loss: 3.0027 - val_accuracy10: 0.4871 - 161s/epoch - 29ms/step
Epoch 20/50
5475/5475 - 165s - loss: 2.9499 - accuracy10: 0.5099 - val_loss: 2.9932 - val_accuracy10: 0.4890 - 165s/epoch - 30ms/step
Epoch 21/50
5475/5475 - 159s - loss: 2.9480 - accuracy10: 0.5104 - val_loss: 2.9863 - val_accuracy10: 0.4917 - 159s/epoch - 29ms/step
Epoch 22/50
5475/5475 - 157s - loss: 2.9458 - accuracy10: 0.5110 - val_loss: 2.9874 - val_accuracy10: 0.4905 - 157s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 159s - loss: 2.9436 - accuracy10: 0.5114 - val_loss: 2.9882 - val_accuracy10: 0.4906 - 159s/epoch - 29ms/step
Epoch 24/50
5475/5475 - 160s - loss: 2.9420 - accuracy10: 0.5121 - val_loss: 2.9822 - val_accuracy10: 0.4923 - 160s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 158s - loss: 2.9398 - accuracy10: 0.5129 - val_loss: 2.9858 - val_accuracy10: 0.4909 - 158s/epoch - 29ms/step
Epoch 26/50
5475/5475 - 160s - loss: 2.9379 - accuracy10: 0.5129 - val_loss: 2.9846 - val_accuracy10: 0.4914 - 160s/epoch - 29ms/step
Epoch 27/50
5475/5475 - 158s - loss: 2.9363 - accuracy10: 0.5135 - val_loss: 2.9798 - val_accuracy10: 0.4933 - 158s/epoch - 29ms/step
Epoch 28/50
5475/5475 - 157s - loss: 2.9344 - accuracy10: 0.5142 - val_loss: 2.9759 - val_accuracy10: 0.4934 - 157s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 158s - loss: 2.9327 - accuracy10: 0.5145 - val_loss: 2.9771 - val_accuracy10: 0.4929 - 158s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 156s - loss: 2.9315 - accuracy10: 0.5147 - val_loss: 2.9780 - val_accuracy10: 0.4941 - 156s/epoch - 29ms/step
Epoch 31/50
5475/5475 - 158s - loss: 2.9295 - accuracy10: 0.5154 - val_loss: 2.9756 - val_accuracy10: 0.4943 - 158s/epoch - 29ms/step
Epoch 32/50
5475/5475 - 161s - loss: 2.9282 - accuracy10: 0.5157 - val_loss: 2.9774 - val_accuracy10: 0.4950 - 161s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 161s - loss: 2.9269 - accuracy10: 0.5161 - val_loss: 2.9749 - val_accuracy10: 0.4957 - 161s/epoch - 29ms/step
Epoch 34/50
5475/5475 - 158s - loss: 2.9253 - accuracy10: 0.5162 - val_loss: 2.9723 - val_accuracy10: 0.4963 - 158s/epoch - 29ms/step
Epoch 35/50
5475/5475 - 160s - loss: 2.9240 - accuracy10: 0.5165 - val_loss: 2.9735 - val_accuracy10: 0.4962 - 160s/epoch - 29ms/step
Epoch 36/50
5475/5475 - 159s - loss: 2.9227 - accuracy10: 0.5171 - val_loss: 2.9765 - val_accuracy10: 0.4947 - 159s/epoch - 29ms/step
Epoch 37/50
5475/5475 - 161s - loss: 2.9212 - accuracy10: 0.5175 - val_loss: 2.9756 - val_accuracy10: 0.4954 - 161s/epoch - 29ms/step
Epoch 38/50
5475/5475 - 160s - loss: 2.9199 - accuracy10: 0.5181 - val_loss: 2.9734 - val_accuracy10: 0.4954 - 160s/epoch - 29ms/step
Epoch 39/50
5475/5475 - 158s - loss: 2.9183 - accuracy10: 0.5184 - val_loss: 2.9819 - val_accuracy10: 0.4947 - 158s/epoch - 29ms/step
Epoch 40/50
5475/5475 - 159s - loss: 2.9176 - accuracy10: 0.5186 - val_loss: 2.9748 - val_accuracy10: 0.4956 - 159s/epoch - 29ms/step
Epoch 41/50
5475/5475 - 160s - loss: 2.9164 - accuracy10: 0.5190 - val_loss: 2.9731 - val_accuracy10: 0.4959 - 160s/epoch - 29ms/step
Epoch 42/50
5475/5475 - 160s - loss: 2.9154 - accuracy10: 0.5192 - val_loss: 2.9808 - val_accuracy10: 0.4943 - 160s/epoch - 29ms/step
Epoch 43/50
5475/5475 - 159s - loss: 2.9141 - accuracy10: 0.5193 - val_loss: 2.9759 - val_accuracy10: 0.4959 - 159s/epoch - 29ms/step
Epoch 44/50
5475/5475 - 161s - loss: 2.9132 - accuracy10: 0.5195 - val_loss: 2.9703 - val_accuracy10: 0.4970 - 161s/epoch - 29ms/step
Epoch 45/50
5475/5475 - 158s - loss: 2.9118 - accuracy10: 0.5198 - val_loss: 2.9758 - val_accuracy10: 0.4961 - 158s/epoch - 29ms/step
Epoch 46/50
5475/5475 - 159s - loss: 2.9107 - accuracy10: 0.5202 - val_loss: 2.9724 - val_accuracy10: 0.4969 - 159s/epoch - 29ms/step
Epoch 47/50
5475/5475 - 169s - loss: 2.9097 - accuracy10: 0.5204 - val_loss: 2.9720 - val_accuracy10: 0.4953 - 169s/epoch - 31ms/step
Epoch 48/50
5475/5475 - 158s - loss: 2.9089 - accuracy10: 0.5210 - val_loss: 2.9779 - val_accuracy10: 0.4950 - 158s/epoch - 29ms/step
Epoch 49/50
5475/5475 - 159s - loss: 2.9077 - accuracy10: 0.5211 - val_loss: 2.9781 - val_accuracy10: 0.4950 - 159s/epoch - 29ms/step
Epoch 50/50
5475/5475 - 160s - loss: 2.9067 - accuracy10: 0.5217 - val_loss: 2.9751 - val_accuracy10: 0.4967 - 160s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h10
Evaluating performance on  test set...
13689/13689 - 209s - 209s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9915287
{'0': {'precision': 0.529162395477482, 'recall': 0.4228392038325007, 'f1-score': 0.47006350864110596, 'support': 1071885}, '1': {'precision': 0.4563205554949944, 'recall': 0.5400459639758839, 'f1-score': 0.49466550603320997, 'support': 1333218}, '2': {'precision': 0.5122853062353724, 'recall': 0.49865395130569906, 'f1-score': 0.5053777271870169, 'support': 1099143}, 'accuracy': 0.4912115188260185, 'macro avg': {'precision': 0.4992560857359496, 'recall': 0.4871797063713612, 'f1-score': 0.4900355806204442, 'support': 3504246}, 'weighted avg': {'precision': 0.49615546995952114, 'recall': 0.4912115188260185, 'f1-score': 0.49050020226202024, 'support': 3504246}}
[[453235 444745 173905]
 [265320 719999 347899]
 [137959 413092 548092]]
Evaluating performance on  train set...
5475/5475 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0062779
{'0': {'precision': 0.5320730889143218, 'recall': 0.4358723460201348, 'f1-score': 0.479192188214554, 'support': 463973}, '1': {'precision': 0.43154640933163346, 'recall': 0.46801016656130257, 'f1-score': 0.4490392540563626, 'support': 465054}, '2': {'precision': 0.5082512782036308, 'recall': 0.5562144076996819, 'f1-score': 0.5311522718155832, 'support': 472539}, 'accuracy': 0.4871094190355645, 'macro avg': {'precision': 0.490623592149862, 'recall': 0.48669897342703977, 'f1-score': 0.4864612380288333, 'support': 1401566}, 'weighted avg': {'precision': 0.49068576283901266, 'recall': 0.4871094190355645, 'f1-score': 0.4867055149524623, 'support': 1401566}}
[[202233 153796 107944]
 [101049 217650 146355]
 [ 76803 132903 262833]]
Evaluating performance on  val set...
2036/2036 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9898577
{'0': {'precision': 0.5355340189547704, 'recall': 0.4068650143255721, 'f1-score': 0.4624157041745319, 'support': 159854}, '1': {'precision': 0.46417917053954766, 'recall': 0.5412720450475095, 'f1-score': 0.49977006345295594, 'support': 193751}, '2': {'precision': 0.511904693423225, 'recall': 0.5309257745613355, 'f1-score': 0.5212417630692635, 'support': 167611}, 'accuracy': 0.49672304764243613, 'macro avg': {'precision': 0.5038726276391811, 'recall': 0.49302094464480567, 'f1-score': 0.4944758435655838, 'support': 521216}, 'weighted avg': {'precision': 0.5014107224386126, 'recall': 0.49672304764243613, 'f1-score': 0.4952184942307826, 'support': 521216}}
[[ 65039  63824  30991]
 [ 35020 104872  53859]
 [ 21388  57234  88989]]
training model: results/AAPL/W3/deepVOL_L2/h20
Epoch 1/50
5475/5475 - 168s - loss: 3.1851 - accuracy20: 0.4287 - val_loss: 3.2378 - val_accuracy20: 0.4085 - 168s/epoch - 31ms/step
Epoch 2/50
5475/5475 - 158s - loss: 3.1221 - accuracy20: 0.4539 - val_loss: 3.1805 - val_accuracy20: 0.4244 - 158s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 158s - loss: 3.0920 - accuracy20: 0.4655 - val_loss: 3.1561 - val_accuracy20: 0.4320 - 158s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 159s - loss: 3.0796 - accuracy20: 0.4700 - val_loss: 3.1380 - val_accuracy20: 0.4370 - 159s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 158s - loss: 3.0717 - accuracy20: 0.4724 - val_loss: 3.1387 - val_accuracy20: 0.4358 - 158s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 160s - loss: 3.0653 - accuracy20: 0.4746 - val_loss: 3.1443 - val_accuracy20: 0.4363 - 160s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 160s - loss: 3.0603 - accuracy20: 0.4761 - val_loss: 3.1292 - val_accuracy20: 0.4410 - 160s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 160s - loss: 3.0555 - accuracy20: 0.4775 - val_loss: 3.1326 - val_accuracy20: 0.4423 - 160s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 159s - loss: 3.0518 - accuracy20: 0.4786 - val_loss: 3.1290 - val_accuracy20: 0.4422 - 159s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 160s - loss: 3.0483 - accuracy20: 0.4798 - val_loss: 3.1301 - val_accuracy20: 0.4439 - 160s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.0446 - accuracy20: 0.4809 - val_loss: 3.1250 - val_accuracy20: 0.4440 - 159s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 161s - loss: 3.0420 - accuracy20: 0.4816 - val_loss: 3.1155 - val_accuracy20: 0.4483 - 161s/epoch - 29ms/step
Epoch 13/50
5475/5475 - 161s - loss: 3.0396 - accuracy20: 0.4821 - val_loss: 3.1125 - val_accuracy20: 0.4484 - 161s/epoch - 29ms/step
Epoch 14/50
5475/5475 - 161s - loss: 3.0371 - accuracy20: 0.4832 - val_loss: 3.1069 - val_accuracy20: 0.4499 - 161s/epoch - 29ms/step
Epoch 15/50
5475/5475 - 162s - loss: 3.0346 - accuracy20: 0.4839 - val_loss: 3.1054 - val_accuracy20: 0.4532 - 162s/epoch - 30ms/step
Epoch 16/50
5475/5475 - 162s - loss: 3.0321 - accuracy20: 0.4847 - val_loss: 3.0991 - val_accuracy20: 0.4527 - 162s/epoch - 30ms/step
Epoch 17/50
5475/5475 - 163s - loss: 3.0302 - accuracy20: 0.4852 - val_loss: 3.0950 - val_accuracy20: 0.4552 - 163s/epoch - 30ms/step
Epoch 18/50
5475/5475 - 157s - loss: 3.0281 - accuracy20: 0.4860 - val_loss: 3.0972 - val_accuracy20: 0.4542 - 157s/epoch - 29ms/step
Epoch 19/50
5475/5475 - 157s - loss: 3.0260 - accuracy20: 0.4867 - val_loss: 3.0923 - val_accuracy20: 0.4560 - 157s/epoch - 29ms/step
Epoch 20/50
5475/5475 - 156s - loss: 3.0238 - accuracy20: 0.4870 - val_loss: 3.0925 - val_accuracy20: 0.4560 - 156s/epoch - 28ms/step
Epoch 21/50
5475/5475 - 160s - loss: 3.0221 - accuracy20: 0.4877 - val_loss: 3.0912 - val_accuracy20: 0.4551 - 160s/epoch - 29ms/step
Epoch 22/50
5475/5475 - 159s - loss: 3.0201 - accuracy20: 0.4883 - val_loss: 3.0959 - val_accuracy20: 0.4549 - 159s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 161s - loss: 3.0188 - accuracy20: 0.4884 - val_loss: 3.0955 - val_accuracy20: 0.4554 - 161s/epoch - 29ms/step
Epoch 24/50
5475/5475 - 158s - loss: 3.0171 - accuracy20: 0.4891 - val_loss: 3.0886 - val_accuracy20: 0.4572 - 158s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 174s - loss: 3.0156 - accuracy20: 0.4896 - val_loss: 3.0848 - val_accuracy20: 0.4588 - 174s/epoch - 32ms/step
Epoch 26/50
5475/5475 - 160s - loss: 3.0139 - accuracy20: 0.4899 - val_loss: 3.0911 - val_accuracy20: 0.4550 - 160s/epoch - 29ms/step
Epoch 27/50
5475/5475 - 159s - loss: 3.0122 - accuracy20: 0.4904 - val_loss: 3.0883 - val_accuracy20: 0.4564 - 159s/epoch - 29ms/step
Epoch 28/50
5475/5475 - 157s - loss: 3.0113 - accuracy20: 0.4907 - val_loss: 3.0837 - val_accuracy20: 0.4580 - 157s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 160s - loss: 3.0095 - accuracy20: 0.4913 - val_loss: 3.0880 - val_accuracy20: 0.4573 - 160s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 160s - loss: 3.0083 - accuracy20: 0.4915 - val_loss: 3.0833 - val_accuracy20: 0.4594 - 160s/epoch - 29ms/step
Epoch 31/50
5475/5475 - 158s - loss: 3.0069 - accuracy20: 0.4921 - val_loss: 3.0795 - val_accuracy20: 0.4595 - 158s/epoch - 29ms/step
Epoch 32/50
5475/5475 - 161s - loss: 3.0057 - accuracy20: 0.4922 - val_loss: 3.0836 - val_accuracy20: 0.4584 - 161s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 160s - loss: 3.0044 - accuracy20: 0.4928 - val_loss: 3.0813 - val_accuracy20: 0.4595 - 160s/epoch - 29ms/step
Epoch 34/50
5475/5475 - 158s - loss: 3.0031 - accuracy20: 0.4930 - val_loss: 3.0771 - val_accuracy20: 0.4605 - 158s/epoch - 29ms/step
Epoch 35/50
5475/5475 - 160s - loss: 3.0019 - accuracy20: 0.4935 - val_loss: 3.0807 - val_accuracy20: 0.4607 - 160s/epoch - 29ms/step
Epoch 36/50
5475/5475 - 158s - loss: 3.0006 - accuracy20: 0.4936 - val_loss: 3.0798 - val_accuracy20: 0.4602 - 158s/epoch - 29ms/step
Epoch 37/50
5475/5475 - 159s - loss: 2.9992 - accuracy20: 0.4942 - val_loss: 3.0827 - val_accuracy20: 0.4600 - 159s/epoch - 29ms/step
Epoch 38/50
5475/5475 - 160s - loss: 2.9981 - accuracy20: 0.4944 - val_loss: 3.0785 - val_accuracy20: 0.4609 - 160s/epoch - 29ms/step
Epoch 39/50
5475/5475 - 162s - loss: 2.9969 - accuracy20: 0.4946 - val_loss: 3.0821 - val_accuracy20: 0.4604 - 162s/epoch - 30ms/step
Epoch 40/50
5475/5475 - 163s - loss: 2.9960 - accuracy20: 0.4951 - val_loss: 3.0788 - val_accuracy20: 0.4611 - 163s/epoch - 30ms/step
Epoch 41/50
5475/5475 - 157s - loss: 2.9945 - accuracy20: 0.4956 - val_loss: 3.0812 - val_accuracy20: 0.4620 - 157s/epoch - 29ms/step
Epoch 42/50
5475/5475 - 160s - loss: 2.9932 - accuracy20: 0.4959 - val_loss: 3.0712 - val_accuracy20: 0.4650 - 160s/epoch - 29ms/step
Epoch 43/50
5475/5475 - 158s - loss: 2.9923 - accuracy20: 0.4962 - val_loss: 3.0791 - val_accuracy20: 0.4625 - 158s/epoch - 29ms/step
Epoch 44/50
5475/5475 - 156s - loss: 2.9910 - accuracy20: 0.4963 - val_loss: 3.0806 - val_accuracy20: 0.4616 - 156s/epoch - 29ms/step
Epoch 45/50
5475/5475 - 159s - loss: 2.9898 - accuracy20: 0.4968 - val_loss: 3.0841 - val_accuracy20: 0.4606 - 159s/epoch - 29ms/step
Epoch 46/50
5475/5475 - 160s - loss: 2.9887 - accuracy20: 0.4974 - val_loss: 3.0834 - val_accuracy20: 0.4610 - 160s/epoch - 29ms/step
Epoch 47/50
5475/5475 - 160s - loss: 2.9877 - accuracy20: 0.4977 - val_loss: 3.0830 - val_accuracy20: 0.4609 - 160s/epoch - 29ms/step
Epoch 48/50
5475/5475 - 159s - loss: 2.9867 - accuracy20: 0.4981 - val_loss: 3.0798 - val_accuracy20: 0.4640 - 159s/epoch - 29ms/step
Epoch 49/50
5475/5475 - 160s - loss: 2.9855 - accuracy20: 0.4981 - val_loss: 3.0827 - val_accuracy20: 0.4612 - 160s/epoch - 29ms/step
Epoch 50/50
5475/5475 - 157s - loss: 2.9842 - accuracy20: 0.4985 - val_loss: 3.0805 - val_accuracy20: 0.4613 - 157s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h20
Evaluating performance on  test set...
13689/13689 - 208s - 208s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0323696
{'0': {'precision': 0.5243352380391245, 'recall': 0.4344334606063776, 'f1-score': 0.47516939654165513, 'support': 1147140}, '1': {'precision': 0.3781866698552684, 'recall': 0.5223808404264911, 'f1-score': 0.4387399460486454, 'support': 1186707}, '2': {'precision': 0.5276152635900553, 'recall': 0.41231067353953654, 'f1-score': 0.46289052383190565, 'support': 1170399}, 'accuracy': 0.45682780261431416, 'macro avg': {'precision': 0.47671239049481606, 'recall': 0.4563749915241351, 'f1-score': 0.45893328880740203, 'support': 3504246}, 'weighted avg': {'precision': 0.4759377824155822, 'recall': 0.45682780261431416, 'f1-score': 0.45873154821513173, 'support': 3504246}}
[[498356 494942 153842]
 [288583 619913 278211]
 [163514 524317 482568]]
Evaluating performance on  train set...
5475/5475 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034895
{'0': {'precision': 0.5189686575869514, 'recall': 0.4373024940182363, 'f1-score': 0.47464840468965325, 'support': 463910}, '1': {'precision': 0.37376690690177344, 'recall': 0.4987958808147981, 'f1-score': 0.4273237322791963, 'support': 464655}, '2': {'precision': 0.5141497960678084, 'recall': 0.424548785309122, 'f1-score': 0.4650729759649456, 'support': 473001}, 'accuracy': 0.45338499935072624, 'macro avg': {'precision': 0.4689617868521778, 'recall': 0.45354905338071877, 'f1-score': 0.4556817043112651, 'support': 1401566}, 'weighted avg': {'precision': 0.469204289885368, 'recall': 0.45338499935072624, 'f1-score': 0.45572754543572136, 'support': 1401566}}
[[202869 189128  71913]
 [115041 231768 117846]
 [ 72998 199191 200812]]
Evaluating performance on  val set...
2036/2036 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0238104
{'0': {'precision': 0.5333765392093325, 'recall': 0.4213176817943712, 'f1-score': 0.4707705610429346, 'support': 167992}, '1': {'precision': 0.39313014664873197, 'recall': 0.5336123929173787, 'f1-score': 0.45272361918209963, 'support': 179651}, '2': {'precision': 0.5222852008018248, 'recall': 0.43531540043670386, 'f1-score': 0.4748509786546758, 'support': 173573}, 'accuracy': 0.4646845069990177, 'macro avg': {'precision': 0.48293062888662974, 'recall': 0.46341515838281794, 'f1-score': 0.46611505295990335, 'support': 521216}, 'weighted avg': {'precision': 0.48134329089901434, 'recall': 0.4646845069990177, 'f1-score': 0.4659090433110957, 'support': 521216}}
[[70778 72424 24790]
 [39466 95864 44321]
 [22454 75560 75559]]
training model: results/AAPL/W3/deepVOL_L2/h30
Epoch 1/50
5475/5475 - 171s - loss: 3.1925 - accuracy30: 0.4255 - val_loss: 3.2426 - val_accuracy30: 0.4007 - 171s/epoch - 31ms/step
Epoch 2/50
5475/5475 - 159s - loss: 3.1477 - accuracy30: 0.4460 - val_loss: 3.1914 - val_accuracy30: 0.4200 - 159s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 156s - loss: 3.1208 - accuracy30: 0.4570 - val_loss: 3.1728 - val_accuracy30: 0.4278 - 156s/epoch - 28ms/step
Epoch 4/50
5475/5475 - 157s - loss: 3.1077 - accuracy30: 0.4616 - val_loss: 3.1634 - val_accuracy30: 0.4326 - 157s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 161s - loss: 3.0995 - accuracy30: 0.4643 - val_loss: 3.1570 - val_accuracy30: 0.4363 - 161s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 164s - loss: 3.0938 - accuracy30: 0.4665 - val_loss: 3.1531 - val_accuracy30: 0.4372 - 164s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 161s - loss: 3.0889 - accuracy30: 0.4684 - val_loss: 3.1472 - val_accuracy30: 0.4402 - 161s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 159s - loss: 3.0849 - accuracy30: 0.4696 - val_loss: 3.1485 - val_accuracy30: 0.4391 - 159s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 159s - loss: 3.0812 - accuracy30: 0.4709 - val_loss: 3.1401 - val_accuracy30: 0.4428 - 159s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 157s - loss: 3.0782 - accuracy30: 0.4720 - val_loss: 3.1426 - val_accuracy30: 0.4421 - 157s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.0754 - accuracy30: 0.4729 - val_loss: 3.1404 - val_accuracy30: 0.4430 - 159s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 164s - loss: 3.0730 - accuracy30: 0.4735 - val_loss: 3.1354 - val_accuracy30: 0.4471 - 164s/epoch - 30ms/step
Epoch 13/50
5475/5475 - 160s - loss: 3.0707 - accuracy30: 0.4743 - val_loss: 3.1389 - val_accuracy30: 0.4451 - 160s/epoch - 29ms/step
Epoch 14/50
5475/5475 - 162s - loss: 3.0682 - accuracy30: 0.4752 - val_loss: 3.1380 - val_accuracy30: 0.4432 - 162s/epoch - 30ms/step
Epoch 15/50
5475/5475 - 164s - loss: 3.0660 - accuracy30: 0.4760 - val_loss: 3.1334 - val_accuracy30: 0.4469 - 164s/epoch - 30ms/step
Epoch 16/50
5475/5475 - 164s - loss: 3.0642 - accuracy30: 0.4766 - val_loss: 3.1320 - val_accuracy30: 0.4476 - 164s/epoch - 30ms/step
Epoch 17/50
5475/5475 - 170s - loss: 3.0623 - accuracy30: 0.4769 - val_loss: 3.1303 - val_accuracy30: 0.4473 - 170s/epoch - 31ms/step
Epoch 18/50
5475/5475 - 166s - loss: 3.0603 - accuracy30: 0.4779 - val_loss: 3.1317 - val_accuracy30: 0.4473 - 166s/epoch - 30ms/step
Epoch 19/50
5475/5475 - 159s - loss: 3.0588 - accuracy30: 0.4784 - val_loss: 3.1282 - val_accuracy30: 0.4489 - 159s/epoch - 29ms/step
Epoch 20/50
5475/5475 - 159s - loss: 3.0571 - accuracy30: 0.4788 - val_loss: 3.1311 - val_accuracy30: 0.4479 - 159s/epoch - 29ms/step
Epoch 21/50
5475/5475 - 160s - loss: 3.0555 - accuracy30: 0.4792 - val_loss: 3.1280 - val_accuracy30: 0.4500 - 160s/epoch - 29ms/step
Epoch 22/50
5475/5475 - 159s - loss: 3.0544 - accuracy30: 0.4793 - val_loss: 3.1286 - val_accuracy30: 0.4502 - 159s/epoch - 29ms/step
Epoch 23/50
5475/5475 - 159s - loss: 3.0527 - accuracy30: 0.4801 - val_loss: 3.1289 - val_accuracy30: 0.4512 - 159s/epoch - 29ms/step
Epoch 24/50
5475/5475 - 160s - loss: 3.0513 - accuracy30: 0.4806 - val_loss: 3.1286 - val_accuracy30: 0.4526 - 160s/epoch - 29ms/step
Epoch 25/50
5475/5475 - 161s - loss: 3.0497 - accuracy30: 0.4809 - val_loss: 3.1254 - val_accuracy30: 0.4547 - 161s/epoch - 29ms/step
Epoch 26/50
5475/5475 - 159s - loss: 3.0482 - accuracy30: 0.4814 - val_loss: 3.1252 - val_accuracy30: 0.4532 - 159s/epoch - 29ms/step
Epoch 27/50
5475/5475 - 160s - loss: 3.0472 - accuracy30: 0.4820 - val_loss: 3.1275 - val_accuracy30: 0.4542 - 160s/epoch - 29ms/step
Epoch 28/50
5475/5475 - 161s - loss: 3.0457 - accuracy30: 0.4826 - val_loss: 3.1223 - val_accuracy30: 0.4554 - 161s/epoch - 29ms/step
Epoch 29/50
5475/5475 - 158s - loss: 3.0444 - accuracy30: 0.4828 - val_loss: 3.1213 - val_accuracy30: 0.4568 - 158s/epoch - 29ms/step
Epoch 30/50
5475/5475 - 158s - loss: 3.0430 - accuracy30: 0.4831 - val_loss: 3.1172 - val_accuracy30: 0.4584 - 158s/epoch - 29ms/step
Epoch 31/50
5475/5475 - 159s - loss: 3.0417 - accuracy30: 0.4837 - val_loss: 3.1203 - val_accuracy30: 0.4566 - 159s/epoch - 29ms/step
Epoch 32/50
5475/5475 - 158s - loss: 3.0403 - accuracy30: 0.4840 - val_loss: 3.1221 - val_accuracy30: 0.4557 - 158s/epoch - 29ms/step
Epoch 33/50
5475/5475 - 161s - loss: 3.0393 - accuracy30: 0.4844 - val_loss: 3.1229 - val_accuracy30: 0.4565 - 161s/epoch - 29ms/step
Epoch 34/50
5475/5475 - 159s - loss: 3.0376 - accuracy30: 0.4846 - val_loss: 3.1220 - val_accuracy30: 0.4565 - 159s/epoch - 29ms/step
Epoch 35/50
5475/5475 - 160s - loss: 3.0363 - accuracy30: 0.4850 - val_loss: 3.1210 - val_accuracy30: 0.4581 - 160s/epoch - 29ms/step
Epoch 36/50
5475/5475 - 157s - loss: 3.0348 - accuracy30: 0.4855 - val_loss: 3.1246 - val_accuracy30: 0.4569 - 157s/epoch - 29ms/step
Epoch 37/50
5475/5475 - 161s - loss: 3.0338 - accuracy30: 0.4863 - val_loss: 3.1229 - val_accuracy30: 0.4573 - 161s/epoch - 29ms/step
Epoch 38/50
5475/5475 - 159s - loss: 3.0320 - accuracy30: 0.4865 - val_loss: 3.1210 - val_accuracy30: 0.4601 - 159s/epoch - 29ms/step
Epoch 39/50
5475/5475 - 160s - loss: 3.0312 - accuracy30: 0.4870 - val_loss: 3.1247 - val_accuracy30: 0.4579 - 160s/epoch - 29ms/step
Epoch 40/50
5475/5475 - 160s - loss: 3.0298 - accuracy30: 0.4874 - val_loss: 3.1228 - val_accuracy30: 0.4601 - 160s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h30
Evaluating performance on  test set...
13689/13689 - 203s - 203s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0480084
{'0': {'precision': 0.5135691365427838, 'recall': 0.4593979506934754, 'f1-score': 0.48497551862179805, 'support': 1221096}, '1': {'precision': 0.33108147550640266, 'recall': 0.3607035071287335, 'f1-score': 0.34525828793106794, 'support': 1037772}, '2': {'precision': 0.49788305735685373, 'recall': 0.5122557167382112, 'f1-score': 0.5049671370681286, 'support': 1245378}, 'accuracy': 0.44895506765221393, 'macro avg': {'precision': 0.4475112231353467, 'recall': 0.4441190581868067, 'f1-score': 0.4450669812069982, 'support': 3504246}, 'weighted avg': {'precision': 0.453951266423659, 'recall': 0.44895506765221393, 'f1-score': 0.4507035216983726, 'support': 3504246}}
[[560969 375771 284356]
 [304423 374328 359021]
 [226903 380523 637952]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0435761
{'0': {'precision': 0.4907417093838268, 'recall': 0.45479321607390616, 'f1-score': 0.4720840960247609, 'support': 464156}, '1': {'precision': 0.38112126844441074, 'recall': 0.3467240657904386, 'f1-score': 0.36310987936241196, 'support': 463654}, '2': {'precision': 0.46630385933118995, 'recall': 0.5409577926189854, 'f1-score': 0.5008643105694092, 'support': 473756}, 'accuracy': 0.4481679778190966, 'macro avg': {'precision': 0.44605561238647584, 'recall': 0.44749169149444334, 'f1-score': 0.4453527619855273, 'support': 1401566}, 'weighted avg': {'precision': 0.44621755995892565, 'recall': 0.4481679778190966, 'f1-score': 0.44576244429337586, 'support': 1401566}}
[[211095 131926 121135]
 [130708 160760 172186]
 [ 88352 129122 256282]]
Evaluating performance on  val set...
2036/2036 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0393049
{'0': {'precision': 0.5190215426283716, 'recall': 0.4453067716499904, 'f1-score': 0.47934672070185025, 'support': 177298}, '1': {'precision': 0.36585464062814577, 'recall': 0.3933552269452227, 'f1-score': 0.3791068618568499, 'support': 161691}, '2': {'precision': 0.49364929783768835, 'recall': 0.5289391802532006, 'f1-score': 0.5106853060154021, 'support': 182227}, 'accuracy': 0.45842990238212183, 'macro avg': {'precision': 0.4595084936980686, 'recall': 0.4558670596161379, 'f1-score': 0.45637962952470074, 'support': 521216}, 'weighted avg': {'precision': 0.4626356726573992, 'recall': 0.45842990238212183, 'f1-score': 0.4592069962295119, 'support': 521216}}
[[78952 55014 43332]
 [42554 63602 55535]
 [30611 55229 96387]]
training model: results/AAPL/W3/deepVOL_L2/h50
Epoch 1/50
5475/5475 - 164s - loss: 3.2279 - accuracy50: 0.4086 - val_loss: 3.3404 - val_accuracy50: 0.3528 - 164s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 160s - loss: 3.2060 - accuracy50: 0.4202 - val_loss: 3.3502 - val_accuracy50: 0.3608 - 160s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 160s - loss: 3.1890 - accuracy50: 0.4285 - val_loss: 3.3474 - val_accuracy50: 0.3626 - 160s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 159s - loss: 3.1740 - accuracy50: 0.4354 - val_loss: 3.3302 - val_accuracy50: 0.3663 - 159s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 159s - loss: 3.1650 - accuracy50: 0.4398 - val_loss: 3.3263 - val_accuracy50: 0.3688 - 159s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 162s - loss: 3.1580 - accuracy50: 0.4427 - val_loss: 3.3395 - val_accuracy50: 0.3684 - 162s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 161s - loss: 3.1532 - accuracy50: 0.4447 - val_loss: 3.3399 - val_accuracy50: 0.3707 - 161s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 163s - loss: 3.1491 - accuracy50: 0.4465 - val_loss: 3.3422 - val_accuracy50: 0.3713 - 163s/epoch - 30ms/step
Epoch 9/50
5475/5475 - 164s - loss: 3.1455 - accuracy50: 0.4479 - val_loss: 3.3409 - val_accuracy50: 0.3730 - 164s/epoch - 30ms/step
Epoch 10/50
5475/5475 - 163s - loss: 3.1428 - accuracy50: 0.4491 - val_loss: 3.3418 - val_accuracy50: 0.3733 - 163s/epoch - 30ms/step
Epoch 11/50
5475/5475 - 168s - loss: 3.1404 - accuracy50: 0.4502 - val_loss: 3.3350 - val_accuracy50: 0.3750 - 168s/epoch - 31ms/step
Epoch 12/50
5475/5475 - 160s - loss: 3.1380 - accuracy50: 0.4508 - val_loss: 3.3336 - val_accuracy50: 0.3757 - 160s/epoch - 29ms/step
Epoch 13/50
5475/5475 - 156s - loss: 3.1359 - accuracy50: 0.4519 - val_loss: 3.3319 - val_accuracy50: 0.3762 - 156s/epoch - 28ms/step
Epoch 14/50
5475/5475 - 158s - loss: 3.1339 - accuracy50: 0.4526 - val_loss: 3.3385 - val_accuracy50: 0.3763 - 158s/epoch - 29ms/step
Epoch 15/50
5475/5475 - 158s - loss: 3.1323 - accuracy50: 0.4530 - val_loss: 3.3416 - val_accuracy50: 0.3751 - 158s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h50
Evaluating performance on  test set...
13689/13689 - 203s - 203s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1134031
{'0': {'precision': 0.5183637855051951, 'recall': 0.11276038363808916, 'f1-score': 0.18522789072394988, 'support': 1143265}, '1': {'precision': 0.3491568621888443, 'recall': 0.8921874626737806, 'f1-score': 0.50189680447587, 'support': 1213959}, '2': {'precision': 0.5264641912923433, 'recall': 0.07048426272556237, 'f1-score': 0.12432376740366664, 'support': 1147022}, 'accuracy': 0.3689355713040694, 'macro avg': {'precision': 0.4646616129954609, 'recall': 0.35847736967914406, 'f1-score': 0.2704828208678289, 'support': 3504246}, 'weighted avg': {'precision': 0.4623977021379293, 'recall': 0.3689355713040694, 'f1-score': 0.27499462186391244, 'support': 3504246}}
[[ 128915  991088   23262]
 [  81423 1083079   49457]
 [  38358 1027817   80847]]
Evaluating performance on  train set...
5475/5475 - 85s - 85s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1297967
{'0': {'precision': 0.5251643818832786, 'recall': 0.08282360720780295, 'f1-score': 0.1430818018285333, 'support': 465773}, '1': {'precision': 0.3316944771227686, 'recall': 0.9110339282703888, 'f1-score': 0.4863249623446845, 'support': 462682}, '2': {'precision': 0.5285669412257434, 'recall': 0.06402091686728907, 'f1-score': 0.11420868565180095, 'support': 473111}, 'accuracy': 0.34988363016796925, 'macro avg': {'precision': 0.4618086000772636, 'recall': 0.3526261507818269, 'f1-score': 0.24787181660833957, 'support': 1401566}, 'weighted avg': {'precision': 0.46244507061193685, 'recall': 0.34988363016796925, 'f1-score': 0.24664613139021202, 'support': 1401566}}
[[ 38577 417934   9262]
 [ 23410 421519  17753]
 [ 11470 431352  30289]]
Evaluating performance on  val set...
2036/2036 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1105357
{'0': {'precision': 0.532269692505407, 'recall': 0.09985181874845644, 'f1-score': 0.1681578491322754, 'support': 170062}, '1': {'precision': 0.3481251822964491, 'recall': 0.8961861696506538, 'f1-score': 0.5014580525894827, 'support': 179793}, '2': {'precision': 0.5275049115913556, 'recall': 0.08147711556305111, 'f1-score': 0.14115220720925648, 'support': 171361}, 'accuracy': 0.368505571586444, 'macro avg': {'precision': 0.4692999287977373, 'recall': 0.35917170132072046, 'f1-score': 0.2702560363103382, 'support': 521216}, 'weighted avg': {'precision': 0.4671826814654314, 'recall': 0.368505571586444, 'f1-score': 0.27425077351412713, 'support': 521216}}
[[ 16981 148942   4139]
 [ 10298 161128   8367]
 [  4624 152775  13962]]
training model: results/AAPL/W3/deepVOL_L2/h100
Epoch 1/50
5475/5475 - 163s - loss: 3.2527 - accuracy100: 0.3930 - val_loss: 3.4502 - val_accuracy100: 0.3530 - 163s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 162s - loss: 3.2434 - accuracy100: 0.3975 - val_loss: 3.4523 - val_accuracy100: 0.3530 - 162s/epoch - 30ms/step
Epoch 3/50
5475/5475 - 157s - loss: 3.2360 - accuracy100: 0.4025 - val_loss: 3.4757 - val_accuracy100: 0.3530 - 157s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 159s - loss: 3.2289 - accuracy100: 0.4065 - val_loss: 3.4964 - val_accuracy100: 0.3530 - 159s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 159s - loss: 3.2232 - accuracy100: 0.4096 - val_loss: 3.5052 - val_accuracy100: 0.3530 - 159s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 158s - loss: 3.2191 - accuracy100: 0.4117 - val_loss: 3.5136 - val_accuracy100: 0.3530 - 158s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 158s - loss: 3.2160 - accuracy100: 0.4134 - val_loss: 3.5313 - val_accuracy100: 0.3530 - 158s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 159s - loss: 3.2134 - accuracy100: 0.4145 - val_loss: 3.5472 - val_accuracy100: 0.3530 - 159s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 158s - loss: 3.2111 - accuracy100: 0.4163 - val_loss: 3.5352 - val_accuracy100: 0.3531 - 158s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 157s - loss: 3.2089 - accuracy100: 0.4178 - val_loss: 3.5329 - val_accuracy100: 0.3531 - 157s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.2069 - accuracy100: 0.4187 - val_loss: 3.5249 - val_accuracy100: 0.3532 - 159s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h100
Evaluating performance on  test set...
13689/13689 - 188s - 188s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1943816
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1223198}, '1': {'precision': 0.30160068743173984, 'recall': 0.9999413372088622, 'f1-score': 0.4634241368839134, 'support': 1056888}, '2': {'precision': 0.4521276595744681, 'recall': 6.943536792576134e-05, 'f1-score': 0.00013884941209525397, 'support': 1224160}, 'accuracy': 0.30160867701639665, 'macro avg': {'precision': 0.25124278233540265, 'recall': 0.33333692419226263, 'f1-score': 0.15452099543200287, 'support': 3504246}, 'weighted avg': {'precision': 0.24890796567450957, 'recall': 0.30160867701639665, 'f1-score': 0.13981820428111383, 'support': 3504246}}
[[      0 1223157      41]
 [      0 1056826      62]
 [      1 1224074      85]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1766797
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 469552}, '1': {'precision': 0.32748815909833623, 'recall': 0.9999564264456616, 'f1-score': 0.49338992051564856, 'support': 458994}, '2': {'precision': 0.38235294117647056, 'recall': 5.4965963384212086e-05, 'f1-score': 0.00010991612554112553, 'support': 473020}, 'accuracy': 0.32749082098167337, 'macro avg': {'precision': 0.2366137000916023, 'recall': 0.3333371308030153, 'f1-score': 0.16449994554706324, 'support': 1401566}, 'weighted avg': {'precision': 0.23628975612456055, 'recall': 0.32749082098167337, 'f1-score': 0.16161565399193692, 'support': 1401566}}
[[     0 469530     22]
 [     0 458974     20]
 [     0 472994     26]]
Evaluating performance on  val set...
2036/2036 - 33s - 33s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1537485
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 168843}, '1': {'precision': 0.3529699569827279, 'recall': 0.9999673858095658, 'f1-score': 0.5217661365231758, 'support': 183969}, '2': {'precision': 0.5333333333333333, 'recall': 9.500961972399705e-05, 'f1-score': 0.00018998539487276916, 'support': 168404}, 'accuracy': 0.3529803382858546, 'macro avg': {'precision': 0.29543443010535375, 'recall': 0.33335413180976325, 'f1-score': 0.17398537397268288, 'support': 521216}, 'weighted avg': {'precision': 0.2969037724912937, 'recall': 0.3529803382858546, 'f1-score': 0.18422456077800814, 'support': 521216}}
[[     0 168835      8]
 [     0 183963      6]
 [     0 168388     16]]
training model: results/AAPL/W3/deepVOL_L2/h200
Epoch 1/50
5475/5475 - 162s - loss: 3.2681 - accuracy200: 0.3815 - val_loss: 3.3582 - val_accuracy200: 0.3366 - 162s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 158s - loss: 3.2620 - accuracy200: 0.3832 - val_loss: 3.3554 - val_accuracy200: 0.3366 - 158s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 160s - loss: 3.2564 - accuracy200: 0.3866 - val_loss: 3.3684 - val_accuracy200: 0.3366 - 160s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 170s - loss: 3.2504 - accuracy200: 0.3916 - val_loss: 3.3915 - val_accuracy200: 0.3366 - 170s/epoch - 31ms/step
Epoch 5/50
5475/5475 - 160s - loss: 3.2465 - accuracy200: 0.3945 - val_loss: 3.4077 - val_accuracy200: 0.3366 - 160s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 157s - loss: 3.2436 - accuracy200: 0.3967 - val_loss: 3.4040 - val_accuracy200: 0.3366 - 157s/epoch - 29ms/step
Epoch 7/50
5475/5475 - 160s - loss: 3.2418 - accuracy200: 0.3979 - val_loss: 3.4175 - val_accuracy200: 0.3365 - 160s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 160s - loss: 3.2399 - accuracy200: 0.3989 - val_loss: 3.4313 - val_accuracy200: 0.3366 - 160s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 162s - loss: 3.2386 - accuracy200: 0.3997 - val_loss: 3.4222 - val_accuracy200: 0.3365 - 162s/epoch - 30ms/step
Epoch 10/50
5475/5475 - 159s - loss: 3.2373 - accuracy200: 0.4009 - val_loss: 3.4266 - val_accuracy200: 0.3366 - 159s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.2364 - accuracy200: 0.4011 - val_loss: 3.4249 - val_accuracy200: 0.3366 - 159s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 159s - loss: 3.2352 - accuracy200: 0.4019 - val_loss: 3.4243 - val_accuracy200: 0.3366 - 159s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h200
Evaluating performance on  test set...
13689/13689 - 206s - 206s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1218084
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1167811}, '1': {'precision': 0.33364685792427695, 'recall': 1.0, 'f1-score': 0.5003526322456512, 'support': 1169180}, '2': {'precision': 1.0, 'recall': 8.567108301099588e-07, 'f1-score': 1.7134201923142824e-06, 'support': 1167255}, 'accuracy': 0.333646952868035, 'macro avg': {'precision': 0.44454895264142563, 'recall': 0.33333361890361, 'f1-score': 0.16678478188861448, 'support': 3504246}, 'weighted avg': {'precision': 0.4444174961883116, 'recall': 0.333646952868035, 'f1-score': 0.16694155905928326, 'support': 3504246}}
[[      0 1167811       0]
 [      0 1169180       0]
 [      1 1167253       1]]
Evaluating performance on  train set...
5475/5475 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1243973
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 470660}, '1': {'precision': 0.32911899974742537, 'recall': 1.0, 'f1-score': 0.4952438416875666, 'support': 461282}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 469624}, 'accuracy': 0.32911899974742537, 'macro avg': {'precision': 0.1097063332491418, 'recall': 0.3333333333333333, 'f1-score': 0.1650812805625222, 'support': 1401566}, 'weighted avg': {'precision': 0.10831931599474579, 'recall': 0.32911899974742537, 'f1-score': 0.1629941578072842, 'support': 1401566}}
[[     0 470660      0]
 [     0 461282      0]
 [     0 469624      0]]
Evaluating performance on  val set...
2036/2036 - 32s - 32s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1203396
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 173680}, '1': {'precision': 0.33655401321911305, 'recall': 0.9999942993307415, 'f1-score': 0.5036138110023499, 'support': 175418}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172118}, 'accuracy': 0.3365533675098232, 'macro avg': {'precision': 0.11218467107303769, 'recall': 0.33333143311024716, 'f1-score': 0.16787127033411664, 'support': 521216}, 'weighted avg': {'precision': 0.11326903220712789, 'recall': 0.3365533675098232, 'f1-score': 0.16949389024590616, 'support': 521216}}
[[     0 173680      0]
 [     0 175417      1]
 [     0 172118      0]]
training model: results/AAPL/W3/deepVOL_L2/h300
Epoch 1/50
5475/5475 - 171s - loss: 3.2691 - accuracy300: 0.3813 - val_loss: 3.3620 - val_accuracy300: 0.3445 - 171s/epoch - 31ms/step
Epoch 2/50
5475/5475 - 165s - loss: 3.2633 - accuracy300: 0.3827 - val_loss: 3.3613 - val_accuracy300: 0.3445 - 165s/epoch - 30ms/step
Epoch 3/50
5475/5475 - 176s - loss: 3.2585 - accuracy300: 0.3864 - val_loss: 3.3644 - val_accuracy300: 0.3445 - 176s/epoch - 32ms/step
Epoch 4/50
5475/5475 - 167s - loss: 3.2551 - accuracy300: 0.3891 - val_loss: 3.3719 - val_accuracy300: 0.3445 - 167s/epoch - 30ms/step
Epoch 5/50
5475/5475 - 157s - loss: 3.2520 - accuracy300: 0.3909 - val_loss: 3.3690 - val_accuracy300: 0.3445 - 157s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 156s - loss: 3.2499 - accuracy300: 0.3925 - val_loss: 3.3800 - val_accuracy300: 0.3445 - 156s/epoch - 28ms/step
Epoch 7/50
5475/5475 - 160s - loss: 3.2481 - accuracy300: 0.3944 - val_loss: 3.3761 - val_accuracy300: 0.3445 - 160s/epoch - 29ms/step
Epoch 8/50
5475/5475 - 159s - loss: 3.2461 - accuracy300: 0.3956 - val_loss: 3.3780 - val_accuracy300: 0.3445 - 159s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 159s - loss: 3.2447 - accuracy300: 0.3963 - val_loss: 3.3678 - val_accuracy300: 0.3446 - 159s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 160s - loss: 3.2432 - accuracy300: 0.3974 - val_loss: 3.3663 - val_accuracy300: 0.3445 - 160s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.2419 - accuracy300: 0.3986 - val_loss: 3.3667 - val_accuracy300: 0.3446 - 159s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 159s - loss: 3.2408 - accuracy300: 0.3994 - val_loss: 3.3623 - val_accuracy300: 0.3445 - 159s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h300
Evaluating performance on  test set...
13689/13689 - 207s - 207s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1186637
{'0': {'precision': 0.4, 'recall': 1.7635813398985587e-06, 'f1-score': 3.527147128769969e-06, 'support': 1134056}, '1': {'precision': 0.35302044219801143, 'recall': 0.9999959581817315, 'f1-score': 0.5218251829829398, 'support': 1237067}, '2': {'precision': 0.2631578947368421, 'recall': 4.412583629491238e-06, 'f1-score': 8.825019282667132e-06, 'support': 1133123}, 'accuracy': 0.35302002199617266, 'macro avg': {'precision': 0.33872611231161787, 'recall': 0.33333404478223366, 'f1-score': 0.17394584504978375, 'support': 3504246}, 'weighted avg': {'precision': 0.33916642910528033, 'recall': 0.35302002199617266, 'f1-score': 0.1842184348507055, 'support': 3504246}}
[[      2 1134045       9]
 [      0 1237062       5]
 [      3 1133115       5]]
Evaluating performance on  train set...
5475/5475 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311082
{'0': {'precision': 1.0, 'recall': 4.239722382978362e-06, 'f1-score': 8.479408815617375e-06, 'support': 471729}, '1': {'precision': 0.32829011817605186, 'recall': 0.9999934799475788, 'f1-score': 0.4943040449660305, 'support': 460119}, '2': {'precision': 0.2727272727272727, 'recall': 6.386810809890189e-06, 'f1-score': 1.2773322490201797e-05, 'support': 469718}, 'accuracy': 0.32829064061200114, 'macro avg': {'precision': 0.5336724636344415, 'recall': 0.33333470216025723, 'f1-score': 0.16477509923244543, 'support': 1401566}, 'weighted avg': {'precision': 0.5357481773787006, 'recall': 0.32829064061200114, 'f1-score': 0.16228182098328556, 'support': 1401566}}
[[     2 471722      5]
 [     0 460116      3]
 [     0 469715      3]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228147
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 171397}, '1': {'precision': 0.3445430388611226, 'recall': 1.0, 'f1-score': 0.512505779142575, 'support': 179581}, '2': {'precision': 1.0, 'recall': 5.874129160351978e-06, 'f1-score': 1.1748189310322545e-05, 'support': 170238}, 'accuracy': 0.3445442964145383, 'macro avg': {'precision': 0.44818101295370755, 'recall': 0.3333352913763868, 'f1-score': 0.1708391757772951, 'support': 521216}, 'weighted avg': {'precision': 0.44532666583857605, 'recall': 0.3445442964145383, 'f1-score': 0.17658379695261578, 'support': 521216}}
[[     0 171397      0]
 [     0 179581      0]
 [     0 170237      1]]
training model: results/AAPL/W3/deepVOL_L2/h500
Epoch 1/50
5475/5475 - 159s - loss: 3.2646 - accuracy500: 0.3814 - val_loss: 3.4000 - val_accuracy500: 0.3416 - 159s/epoch - 29ms/step
Epoch 2/50
5475/5475 - 160s - loss: 3.2572 - accuracy500: 0.3853 - val_loss: 3.4029 - val_accuracy500: 0.3416 - 160s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 162s - loss: 3.2521 - accuracy500: 0.3904 - val_loss: 3.4117 - val_accuracy500: 0.3416 - 162s/epoch - 30ms/step
Epoch 4/50
5475/5475 - 160s - loss: 3.2475 - accuracy500: 0.3931 - val_loss: 3.4195 - val_accuracy500: 0.3416 - 160s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 163s - loss: 3.2441 - accuracy500: 0.3964 - val_loss: 3.4263 - val_accuracy500: 0.3416 - 163s/epoch - 30ms/step
Epoch 6/50
5475/5475 - 162s - loss: 3.2415 - accuracy500: 0.3977 - val_loss: 3.4350 - val_accuracy500: 0.3416 - 162s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 164s - loss: 3.2398 - accuracy500: 0.3989 - val_loss: 3.4338 - val_accuracy500: 0.3416 - 164s/epoch - 30ms/step
Epoch 8/50
5475/5475 - 156s - loss: 3.2378 - accuracy500: 0.4006 - val_loss: 3.4273 - val_accuracy500: 0.3416 - 156s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 157s - loss: 3.2361 - accuracy500: 0.4019 - val_loss: 3.4375 - val_accuracy500: 0.3416 - 157s/epoch - 29ms/step
Epoch 10/50
5475/5475 - 157s - loss: 3.2343 - accuracy500: 0.4027 - val_loss: 3.4309 - val_accuracy500: 0.3416 - 157s/epoch - 29ms/step
Epoch 11/50
5475/5475 - 159s - loss: 3.2331 - accuracy500: 0.4039 - val_loss: 3.4314 - val_accuracy500: 0.3416 - 159s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h500
Evaluating performance on  test set...
13689/13689 - 207s - 207s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1280725
{'0': {'precision': 1.0, 'recall': 8.797070927264058e-07, 'f1-score': 1.7594126376850352e-06, 'support': 1136742}, '1': {'precision': 0.35352547803599876, 'recall': 0.9999991927913034, 'f1-score': 0.5223771687162178, 'support': 1238837}, '2': {'precision': 0.2727272727272727, 'recall': 2.6580027590068637e-06, 'f1-score': 5.3159537086751045e-06, 'support': 1128667}, 'accuracy': 0.3535254088896727, 'macro avg': {'precision': 0.5420842502544237, 'recall': 0.33333424350038504, 'f1-score': 0.1741280813608547, 'support': 3504246}, 'weighted avg': {'precision': 0.5372113474227994, 'recall': 0.3535254088896727, 'f1-score': 0.18467543788325883, 'support': 3504246}}
[[      1 1136734       7]
 [      0 1238836       1]
 [      0 1128664       3]]
Evaluating performance on  train set...
5475/5475 - 85s - 85s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1414186
{'0': {'precision': 1.0, 'recall': 2.1249242995718276e-06, 'f1-score': 4.249839568556286e-06, 'support': 470605}, '1': {'precision': 0.330238933077619, 'recall': 1.0, 'f1-score': 0.49651070174826956, 'support': 462851}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 468110}, 'accuracy': 0.3302391753224607, 'macro avg': {'precision': 0.4434129776925397, 'recall': 0.3333340416414332, 'f1-score': 0.1655049838626127, 'support': 1401566}, 'weighted avg': {'precision': 0.444828442195308, 'recall': 0.3302391753224607, 'f1-score': 0.16396835740210486, 'support': 1401566}}
[[     1 470603      1]
 [     0 462851      0]
 [     0 468110      0]]
Evaluating performance on  val set...
2036/2036 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1350992
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172294}, '1': {'precision': 0.34158840401753593, 'recall': 1.0, 'f1-score': 0.5092298099694532, 'support': 178041}, '2': {'precision': 1.0, 'recall': 5.852025678688678e-06, 'f1-score': 1.1703982865369084e-05, 'support': 170881}, 'accuracy': 0.34158966723968565, 'macro avg': {'precision': 0.44719613467251196, 'recall': 0.33333528400855955, 'f1-score': 0.16974717131743952, 'support': 521216}, 'weighted avg': {'precision': 0.44453305546968264, 'recall': 0.34158966723968565, 'f1-score': 0.1739505014908741, 'support': 521216}}
[[     0 172294      0]
 [     0 178041      0]
 [     0 170880      1]]
training model: results/AAPL/W3/deepVOL_L2/h1000
Epoch 1/50
5475/5475 - 162s - loss: 3.2674 - accuracy1000: 0.3820 - val_loss: 3.4094 - val_accuracy1000: 0.3406 - 162s/epoch - 30ms/step
Epoch 2/50
5475/5475 - 158s - loss: 3.2610 - accuracy1000: 0.3826 - val_loss: 3.3845 - val_accuracy1000: 0.3406 - 158s/epoch - 29ms/step
Epoch 3/50
5475/5475 - 159s - loss: 3.2603 - accuracy1000: 0.3851 - val_loss: 3.3916 - val_accuracy1000: 0.3406 - 159s/epoch - 29ms/step
Epoch 4/50
5475/5475 - 158s - loss: 3.2560 - accuracy1000: 0.3886 - val_loss: 3.4054 - val_accuracy1000: 0.3406 - 158s/epoch - 29ms/step
Epoch 5/50
5475/5475 - 161s - loss: 3.2523 - accuracy1000: 0.3922 - val_loss: 3.3995 - val_accuracy1000: 0.3406 - 161s/epoch - 29ms/step
Epoch 6/50
5475/5475 - 164s - loss: 3.2465 - accuracy1000: 0.3960 - val_loss: 3.4027 - val_accuracy1000: 0.3406 - 164s/epoch - 30ms/step
Epoch 7/50
5475/5475 - 164s - loss: 3.2423 - accuracy1000: 0.3990 - val_loss: 3.3995 - val_accuracy1000: 0.3407 - 164s/epoch - 30ms/step
Epoch 8/50
5475/5475 - 161s - loss: 3.2392 - accuracy1000: 0.4010 - val_loss: 3.3996 - val_accuracy1000: 0.3411 - 161s/epoch - 29ms/step
Epoch 9/50
5475/5475 - 163s - loss: 3.2365 - accuracy1000: 0.4028 - val_loss: 3.3981 - val_accuracy1000: 0.3417 - 163s/epoch - 30ms/step
Epoch 10/50
5475/5475 - 164s - loss: 3.2346 - accuracy1000: 0.4039 - val_loss: 3.4030 - val_accuracy1000: 0.3423 - 164s/epoch - 30ms/step
Epoch 11/50
5475/5475 - 157s - loss: 3.2327 - accuracy1000: 0.4053 - val_loss: 3.4044 - val_accuracy1000: 0.3418 - 157s/epoch - 29ms/step
Epoch 12/50
5475/5475 - 158s - loss: 3.2312 - accuracy1000: 0.4061 - val_loss: 3.4026 - val_accuracy1000: 0.3422 - 158s/epoch - 29ms/step
testing model: results/AAPL/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
13689/13689 - 210s - 210s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1294117
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1169572}, '1': {'precision': 0.33857497447382406, 'recall': 1.0, 'f1-score': 0.5058737551953911, 'support': 1186450}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1148224}, 'accuracy': 0.33857497447382406, 'macro avg': {'precision': 0.11285832482460802, 'recall': 0.3333333333333333, 'f1-score': 0.16862458506513037, 'support': 3504246}, 'weighted avg': {'precision': 0.1146330133399506, 'recall': 0.33857497447382406, 'f1-score': 0.17127619375225706, 'support': 3504246}}
[[      0 1169572       0]
 [      0 1186450       0]
 [      0 1148224       0]]
Evaluating performance on  train set...
5475/5475 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1331743
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 469124}, '1': {'precision': 0.33211778824543403, 'recall': 1.0, 'f1-score': 0.49863126395583196, 'support': 465485}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 466957}, 'accuracy': 0.33211778824543403, 'macro avg': {'precision': 0.11070592941514468, 'recall': 0.3333333333333333, 'f1-score': 0.16621042131861066, 'support': 1401566}, 'weighted avg': {'precision': 0.11030222526903898, 'recall': 0.33211778824543403, 'f1-score': 0.16560431253503613, 'support': 1401566}}
[[     0 469124      0]
 [     0 465485      0]
 [     0 466957      0]]
Evaluating performance on  val set...
2036/2036 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1288491
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 171385}, '1': {'precision': 0.340636127824165, 'recall': 1.0, 'f1-score': 0.5081708910485846, 'support': 177545}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172286}, 'accuracy': 0.340636127824165, 'macro avg': {'precision': 0.11354537594138835, 'recall': 0.3333333333333333, 'f1-score': 0.16939029701619487, 'support': 521216}, 'weighted avg': {'precision': 0.1160329715790409, 'recall': 0.340636127824165, 'f1-score': 0.1731013645997455, 'support': 521216}}
[[     0 171385      0]
 [     0 177545      0]
 [     0 172286      0]]
training model: results/AAPL/W3/deepVOL_L3/h10
Epoch 1/50
5475/5475 - 228s - loss: 3.1544 - accuracy10: 0.4413 - val_loss: 3.1626 - val_accuracy10: 0.4114 - 228s/epoch - 42ms/step
Epoch 2/50
5475/5475 - 227s - loss: 3.0833 - accuracy10: 0.4689 - val_loss: 3.1499 - val_accuracy10: 0.4390 - 227s/epoch - 42ms/step
Epoch 3/50
5475/5475 - 232s - loss: 3.0558 - accuracy10: 0.4784 - val_loss: 3.1136 - val_accuracy10: 0.4517 - 232s/epoch - 42ms/step
Epoch 4/50
5475/5475 - 229s - loss: 3.0345 - accuracy10: 0.4851 - val_loss: 3.0862 - val_accuracy10: 0.4621 - 229s/epoch - 42ms/step
Epoch 5/50
5475/5475 - 223s - loss: 3.0213 - accuracy10: 0.4894 - val_loss: 3.0525 - val_accuracy10: 0.4693 - 223s/epoch - 41ms/step
Epoch 6/50
5475/5475 - 222s - loss: 3.0121 - accuracy10: 0.4918 - val_loss: 3.0484 - val_accuracy10: 0.4724 - 222s/epoch - 41ms/step
Epoch 7/50
5475/5475 - 224s - loss: 3.0043 - accuracy10: 0.4943 - val_loss: 3.0259 - val_accuracy10: 0.4802 - 224s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 230s - loss: 2.9983 - accuracy10: 0.4964 - val_loss: 3.0313 - val_accuracy10: 0.4805 - 230s/epoch - 42ms/step
Epoch 9/50
5475/5475 - 228s - loss: 2.9921 - accuracy10: 0.4982 - val_loss: 3.0199 - val_accuracy10: 0.4811 - 228s/epoch - 42ms/step
Epoch 10/50
5475/5475 - 232s - loss: 2.9865 - accuracy10: 0.4998 - val_loss: 2.9893 - val_accuracy10: 0.4909 - 232s/epoch - 42ms/step
Epoch 11/50
5475/5475 - 230s - loss: 2.9820 - accuracy10: 0.5011 - val_loss: 2.9937 - val_accuracy10: 0.4905 - 230s/epoch - 42ms/step
Epoch 12/50
5475/5475 - 222s - loss: 2.9777 - accuracy10: 0.5025 - val_loss: 2.9815 - val_accuracy10: 0.4943 - 222s/epoch - 41ms/step
Epoch 13/50
5475/5475 - 222s - loss: 2.9738 - accuracy10: 0.5037 - val_loss: 2.9839 - val_accuracy10: 0.4936 - 222s/epoch - 41ms/step
Epoch 14/50
5475/5475 - 223s - loss: 2.9700 - accuracy10: 0.5050 - val_loss: 2.9700 - val_accuracy10: 0.4977 - 223s/epoch - 41ms/step
Epoch 15/50
5475/5475 - 225s - loss: 2.9664 - accuracy10: 0.5056 - val_loss: 2.9698 - val_accuracy10: 0.4985 - 225s/epoch - 41ms/step
Epoch 16/50
5475/5475 - 226s - loss: 2.9633 - accuracy10: 0.5065 - val_loss: 2.9731 - val_accuracy10: 0.4981 - 226s/epoch - 41ms/step
Epoch 17/50
5475/5475 - 225s - loss: 2.9605 - accuracy10: 0.5072 - val_loss: 2.9788 - val_accuracy10: 0.4976 - 225s/epoch - 41ms/step
Epoch 18/50
5475/5475 - 222s - loss: 2.9576 - accuracy10: 0.5078 - val_loss: 2.9730 - val_accuracy10: 0.4986 - 222s/epoch - 41ms/step
Epoch 19/50
5475/5475 - 224s - loss: 2.9546 - accuracy10: 0.5091 - val_loss: 2.9682 - val_accuracy10: 0.4997 - 224s/epoch - 41ms/step
Epoch 20/50
5475/5475 - 223s - loss: 2.9521 - accuracy10: 0.5096 - val_loss: 2.9664 - val_accuracy10: 0.5007 - 223s/epoch - 41ms/step
Epoch 21/50
5475/5475 - 225s - loss: 2.9498 - accuracy10: 0.5103 - val_loss: 2.9593 - val_accuracy10: 0.5022 - 225s/epoch - 41ms/step
Epoch 22/50
5475/5475 - 224s - loss: 2.9477 - accuracy10: 0.5109 - val_loss: 2.9675 - val_accuracy10: 0.5004 - 224s/epoch - 41ms/step
Epoch 23/50
5475/5475 - 223s - loss: 2.9456 - accuracy10: 0.5113 - val_loss: 2.9733 - val_accuracy10: 0.4996 - 223s/epoch - 41ms/step
Epoch 24/50
5475/5475 - 224s - loss: 2.9435 - accuracy10: 0.5121 - val_loss: 2.9592 - val_accuracy10: 0.5030 - 224s/epoch - 41ms/step
Epoch 25/50
5475/5475 - 228s - loss: 2.9415 - accuracy10: 0.5128 - val_loss: 2.9609 - val_accuracy10: 0.5029 - 228s/epoch - 42ms/step
Epoch 26/50
5475/5475 - 224s - loss: 2.9395 - accuracy10: 0.5133 - val_loss: 2.9595 - val_accuracy10: 0.5027 - 224s/epoch - 41ms/step
Epoch 27/50
5475/5475 - 225s - loss: 2.9378 - accuracy10: 0.5138 - val_loss: 2.9541 - val_accuracy10: 0.5039 - 225s/epoch - 41ms/step
Epoch 28/50
5475/5475 - 223s - loss: 2.9356 - accuracy10: 0.5141 - val_loss: 2.9504 - val_accuracy10: 0.5049 - 223s/epoch - 41ms/step
Epoch 29/50
5475/5475 - 223s - loss: 2.9343 - accuracy10: 0.5146 - val_loss: 2.9554 - val_accuracy10: 0.5038 - 223s/epoch - 41ms/step
Epoch 30/50
5475/5475 - 223s - loss: 2.9325 - accuracy10: 0.5150 - val_loss: 2.9465 - val_accuracy10: 0.5063 - 223s/epoch - 41ms/step
Epoch 31/50
5475/5475 - 223s - loss: 2.9310 - accuracy10: 0.5153 - val_loss: 2.9473 - val_accuracy10: 0.5055 - 223s/epoch - 41ms/step
Epoch 32/50
5475/5475 - 222s - loss: 2.9294 - accuracy10: 0.5160 - val_loss: 2.9397 - val_accuracy10: 0.5073 - 222s/epoch - 40ms/step
Epoch 33/50
5475/5475 - 220s - loss: 2.9276 - accuracy10: 0.5163 - val_loss: 2.9415 - val_accuracy10: 0.5075 - 220s/epoch - 40ms/step
Epoch 34/50
5475/5475 - 224s - loss: 2.9262 - accuracy10: 0.5166 - val_loss: 2.9443 - val_accuracy10: 0.5061 - 224s/epoch - 41ms/step
Epoch 35/50
5475/5475 - 223s - loss: 2.9247 - accuracy10: 0.5171 - val_loss: 2.9447 - val_accuracy10: 0.5062 - 223s/epoch - 41ms/step
Epoch 36/50
5475/5475 - 223s - loss: 2.9238 - accuracy10: 0.5175 - val_loss: 2.9501 - val_accuracy10: 0.5047 - 223s/epoch - 41ms/step
Epoch 37/50
5475/5475 - 224s - loss: 2.9220 - accuracy10: 0.5177 - val_loss: 2.9471 - val_accuracy10: 0.5059 - 224s/epoch - 41ms/step
Epoch 38/50
5475/5475 - 224s - loss: 2.9203 - accuracy10: 0.5184 - val_loss: 2.9505 - val_accuracy10: 0.5047 - 224s/epoch - 41ms/step
Epoch 39/50
5475/5475 - 222s - loss: 2.9192 - accuracy10: 0.5185 - val_loss: 2.9464 - val_accuracy10: 0.5060 - 222s/epoch - 41ms/step
Epoch 40/50
5475/5475 - 225s - loss: 2.9180 - accuracy10: 0.5186 - val_loss: 2.9506 - val_accuracy10: 0.5048 - 225s/epoch - 41ms/step
Epoch 41/50
5475/5475 - 226s - loss: 2.9169 - accuracy10: 0.5190 - val_loss: 2.9391 - val_accuracy10: 0.5074 - 226s/epoch - 41ms/step
Epoch 42/50
5475/5475 - 230s - loss: 2.9151 - accuracy10: 0.5195 - val_loss: 2.9404 - val_accuracy10: 0.5074 - 230s/epoch - 42ms/step
Epoch 43/50
5475/5475 - 224s - loss: 2.9140 - accuracy10: 0.5198 - val_loss: 2.9465 - val_accuracy10: 0.5060 - 224s/epoch - 41ms/step
Epoch 44/50
5475/5475 - 223s - loss: 2.9127 - accuracy10: 0.5204 - val_loss: 2.9447 - val_accuracy10: 0.5059 - 223s/epoch - 41ms/step
Epoch 45/50
5475/5475 - 221s - loss: 2.9116 - accuracy10: 0.5207 - val_loss: 2.9426 - val_accuracy10: 0.5070 - 221s/epoch - 40ms/step
Epoch 46/50
5475/5475 - 225s - loss: 2.9104 - accuracy10: 0.5207 - val_loss: 2.9450 - val_accuracy10: 0.5065 - 225s/epoch - 41ms/step
Epoch 47/50
5475/5475 - 223s - loss: 2.9092 - accuracy10: 0.5213 - val_loss: 2.9438 - val_accuracy10: 0.5062 - 223s/epoch - 41ms/step
Epoch 48/50
5475/5475 - 245s - loss: 2.9083 - accuracy10: 0.5213 - val_loss: 2.9501 - val_accuracy10: 0.5043 - 245s/epoch - 45ms/step
Epoch 49/50
5475/5475 - 242s - loss: 2.9074 - accuracy10: 0.5216 - val_loss: 2.9430 - val_accuracy10: 0.5059 - 242s/epoch - 44ms/step
Epoch 50/50
5475/5475 - 238s - loss: 2.9062 - accuracy10: 0.5219 - val_loss: 2.9486 - val_accuracy10: 0.5057 - 238s/epoch - 43ms/step
testing model: results/AAPL/W3/deepVOL_L3/h10
Evaluating performance on  test set...
13689/13689 - 263s - 263s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98291314
{'0': {'precision': 0.5348504838511019, 'recall': 0.44968536736683506, 'f1-score': 0.48858441471558345, 'support': 1071885}, '1': {'precision': 0.4765285408730577, 'recall': 0.492136319791662, 'f1-score': 0.4842066888232661, 'support': 1333218}, '2': {'precision': 0.4998572773077444, 'recall': 0.5576180715339132, 'f1-score': 0.5271601864191973, 'support': 1099143}, 'accuracy': 0.4996903756186067, 'macro avg': {'precision': 0.5037454340106347, 'recall': 0.4998132528974701, 'f1-score': 0.4999837633193489, 'support': 3504246}, 'weighted avg': {'precision': 0.5016854599934767, 'recall': 0.4996903756186067, 'f1-score': 0.49901856416711216, 'support': 3504246}}
[[482011 376801 213073]
 [276914 656125 400179]
 [142282 343959 612902]]
Evaluating performance on  train set...
5475/5475 - 126s - 126s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99544156
{'0': {'precision': 0.5365378951502061, 'recall': 0.4711631926857813, 'f1-score': 0.5017299489449893, 'support': 463973}, '1': {'precision': 0.46768665666414094, 'recall': 0.40082227010196664, 'f1-score': 0.431680600264005, 'support': 465054}, '2': {'precision': 0.4930972530055746, 'recall': 0.6214703971524044, 'f1-score': 0.5498909745257696, 'support': 472539}, 'accuracy': 0.49849953551955456, 'macro avg': {'precision': 0.49910726827330726, 'recall': 0.4978186199800508, 'f1-score': 0.49443384124492135, 'support': 1401566}, 'weighted avg': {'precision': 0.4990463025592895, 'recall': 0.49849953551955456, 'f1-score': 0.4947243802207408, 'support': 1401566}}
[[218607 113543 131823]
 [108582 186404 170068]
 [ 80251  98619 293669]]
Evaluating performance on  val set...
2036/2036 - 43s - 43s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97918546
{'0': {'precision': 0.5398674891478181, 'recall': 0.4434671637869556, 'f1-score': 0.4869420670137792, 'support': 159854}, '1': {'precision': 0.49135974864723336, 'recall': 0.4939845471765307, 'f1-score': 0.49266865189158304, 'support': 193751}, '2': {'precision': 0.5022755227552276, 'recall': 0.5847110273192093, 'f1-score': 0.5403673796835672, 'support': 167611}, 'accuracy': 0.5076666871316307, 'macro avg': {'precision': 0.511167586850093, 'recall': 0.5073875794275652, 'f1-score': 0.5066593661963098, 'support': 521216}, 'weighted avg': {'precision': 0.5097470586377085, 'recall': 0.5076666871316307, 'f1-score': 0.5062511473730836, 'support': 521216}}
[[70890 52343 36621]
 [37546 95710 60495]
 [22874 46733 98004]]
training model: results/AAPL/W3/deepVOL_L3/h20
Epoch 1/50
5475/5475 - 228s - loss: 3.1918 - accuracy20: 0.4244 - val_loss: 3.2276 - val_accuracy20: 0.3948 - 228s/epoch - 42ms/step
Epoch 2/50
5475/5475 - 221s - loss: 3.1335 - accuracy20: 0.4501 - val_loss: 3.2100 - val_accuracy20: 0.4163 - 221s/epoch - 40ms/step
Epoch 3/50
5475/5475 - 222s - loss: 3.1071 - accuracy20: 0.4594 - val_loss: 3.1651 - val_accuracy20: 0.4204 - 222s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 222s - loss: 3.0911 - accuracy20: 0.4653 - val_loss: 3.1583 - val_accuracy20: 0.4305 - 222s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 222s - loss: 3.0796 - accuracy20: 0.4690 - val_loss: 3.1273 - val_accuracy20: 0.4404 - 222s/epoch - 41ms/step
Epoch 6/50
5475/5475 - 228s - loss: 3.0720 - accuracy20: 0.4718 - val_loss: 3.1004 - val_accuracy20: 0.4487 - 228s/epoch - 42ms/step
Epoch 7/50
5475/5475 - 227s - loss: 3.0662 - accuracy20: 0.4737 - val_loss: 3.1064 - val_accuracy20: 0.4489 - 227s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 232s - loss: 3.0617 - accuracy20: 0.4755 - val_loss: 3.1002 - val_accuracy20: 0.4530 - 232s/epoch - 42ms/step
Epoch 9/50
5475/5475 - 231s - loss: 3.0579 - accuracy20: 0.4766 - val_loss: 3.0830 - val_accuracy20: 0.4580 - 231s/epoch - 42ms/step
Epoch 10/50
5475/5475 - 235s - loss: 3.0539 - accuracy20: 0.4782 - val_loss: 3.0796 - val_accuracy20: 0.4598 - 235s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 230s - loss: 3.0508 - accuracy20: 0.4791 - val_loss: 3.0754 - val_accuracy20: 0.4608 - 230s/epoch - 42ms/step
Epoch 12/50
5475/5475 - 230s - loss: 3.0481 - accuracy20: 0.4800 - val_loss: 3.0726 - val_accuracy20: 0.4618 - 230s/epoch - 42ms/step
Epoch 13/50
5475/5475 - 233s - loss: 3.0449 - accuracy20: 0.4807 - val_loss: 3.0735 - val_accuracy20: 0.4612 - 233s/epoch - 43ms/step
Epoch 14/50
5475/5475 - 235s - loss: 3.0427 - accuracy20: 0.4816 - val_loss: 3.0706 - val_accuracy20: 0.4626 - 235s/epoch - 43ms/step
Epoch 15/50
5475/5475 - 230s - loss: 3.0398 - accuracy20: 0.4824 - val_loss: 3.0681 - val_accuracy20: 0.4642 - 230s/epoch - 42ms/step
Epoch 16/50
5475/5475 - 228s - loss: 3.0377 - accuracy20: 0.4832 - val_loss: 3.0633 - val_accuracy20: 0.4667 - 228s/epoch - 42ms/step
Epoch 17/50
5475/5475 - 234s - loss: 3.0354 - accuracy20: 0.4841 - val_loss: 3.0635 - val_accuracy20: 0.4665 - 234s/epoch - 43ms/step
Epoch 18/50
5475/5475 - 228s - loss: 3.0335 - accuracy20: 0.4846 - val_loss: 3.0535 - val_accuracy20: 0.4707 - 228s/epoch - 42ms/step
Epoch 19/50
5475/5475 - 227s - loss: 3.0311 - accuracy20: 0.4848 - val_loss: 3.0534 - val_accuracy20: 0.4704 - 227s/epoch - 41ms/step
Epoch 20/50
5475/5475 - 226s - loss: 3.0292 - accuracy20: 0.4857 - val_loss: 3.0540 - val_accuracy20: 0.4699 - 226s/epoch - 41ms/step
Epoch 21/50
5475/5475 - 226s - loss: 3.0276 - accuracy20: 0.4860 - val_loss: 3.0549 - val_accuracy20: 0.4701 - 226s/epoch - 41ms/step
Epoch 22/50
5475/5475 - 229s - loss: 3.0255 - accuracy20: 0.4872 - val_loss: 3.0511 - val_accuracy20: 0.4714 - 229s/epoch - 42ms/step
Epoch 23/50
5475/5475 - 225s - loss: 3.0238 - accuracy20: 0.4873 - val_loss: 3.0424 - val_accuracy20: 0.4758 - 225s/epoch - 41ms/step
Epoch 24/50
5475/5475 - 229s - loss: 3.0219 - accuracy20: 0.4877 - val_loss: 3.0420 - val_accuracy20: 0.4753 - 229s/epoch - 42ms/step
Epoch 25/50
5475/5475 - 225s - loss: 3.0204 - accuracy20: 0.4879 - val_loss: 3.0440 - val_accuracy20: 0.4758 - 225s/epoch - 41ms/step
Epoch 26/50
5475/5475 - 222s - loss: 3.0189 - accuracy20: 0.4884 - val_loss: 3.0397 - val_accuracy20: 0.4769 - 222s/epoch - 41ms/step
Epoch 27/50
5475/5475 - 224s - loss: 3.0169 - accuracy20: 0.4891 - val_loss: 3.0408 - val_accuracy20: 0.4777 - 224s/epoch - 41ms/step
Epoch 28/50
5475/5475 - 225s - loss: 3.0152 - accuracy20: 0.4897 - val_loss: 3.0396 - val_accuracy20: 0.4778 - 225s/epoch - 41ms/step
Epoch 29/50
5475/5475 - 228s - loss: 3.0139 - accuracy20: 0.4902 - val_loss: 3.0434 - val_accuracy20: 0.4774 - 228s/epoch - 42ms/step
Epoch 30/50
5475/5475 - 224s - loss: 3.0125 - accuracy20: 0.4901 - val_loss: 3.0370 - val_accuracy20: 0.4799 - 224s/epoch - 41ms/step
Epoch 31/50
5475/5475 - 225s - loss: 3.0108 - accuracy20: 0.4912 - val_loss: 3.0332 - val_accuracy20: 0.4814 - 225s/epoch - 41ms/step
Epoch 32/50
5475/5475 - 223s - loss: 3.0092 - accuracy20: 0.4913 - val_loss: 3.0323 - val_accuracy20: 0.4827 - 223s/epoch - 41ms/step
Epoch 33/50
5475/5475 - 224s - loss: 3.0085 - accuracy20: 0.4917 - val_loss: 3.0317 - val_accuracy20: 0.4812 - 224s/epoch - 41ms/step
Epoch 34/50
5475/5475 - 223s - loss: 3.0070 - accuracy20: 0.4921 - val_loss: 3.0333 - val_accuracy20: 0.4811 - 223s/epoch - 41ms/step
Epoch 35/50
5475/5475 - 221s - loss: 3.0059 - accuracy20: 0.4923 - val_loss: 3.0348 - val_accuracy20: 0.4819 - 221s/epoch - 40ms/step
Epoch 36/50
5475/5475 - 228s - loss: 3.0045 - accuracy20: 0.4927 - val_loss: 3.0314 - val_accuracy20: 0.4828 - 228s/epoch - 42ms/step
Epoch 37/50
5475/5475 - 224s - loss: 3.0033 - accuracy20: 0.4931 - val_loss: 3.0314 - val_accuracy20: 0.4823 - 224s/epoch - 41ms/step
Epoch 38/50
5475/5475 - 224s - loss: 3.0025 - accuracy20: 0.4935 - val_loss: 3.0280 - val_accuracy20: 0.4834 - 224s/epoch - 41ms/step
Epoch 39/50
5475/5475 - 223s - loss: 3.0008 - accuracy20: 0.4937 - val_loss: 3.0311 - val_accuracy20: 0.4825 - 223s/epoch - 41ms/step
Epoch 40/50
5475/5475 - 223s - loss: 2.9999 - accuracy20: 0.4942 - val_loss: 3.0312 - val_accuracy20: 0.4828 - 223s/epoch - 41ms/step
Epoch 41/50
5475/5475 - 221s - loss: 2.9991 - accuracy20: 0.4943 - val_loss: 3.0319 - val_accuracy20: 0.4825 - 221s/epoch - 40ms/step
Epoch 42/50
5475/5475 - 223s - loss: 2.9976 - accuracy20: 0.4949 - val_loss: 3.0296 - val_accuracy20: 0.4830 - 223s/epoch - 41ms/step
Epoch 43/50
5475/5475 - 223s - loss: 2.9966 - accuracy20: 0.4951 - val_loss: 3.0316 - val_accuracy20: 0.4830 - 223s/epoch - 41ms/step
Epoch 44/50
5475/5475 - 224s - loss: 2.9954 - accuracy20: 0.4953 - val_loss: 3.0307 - val_accuracy20: 0.4828 - 224s/epoch - 41ms/step
Epoch 45/50
5475/5475 - 227s - loss: 2.9945 - accuracy20: 0.4956 - val_loss: 3.0372 - val_accuracy20: 0.4813 - 227s/epoch - 41ms/step
Epoch 46/50
5475/5475 - 224s - loss: 2.9934 - accuracy20: 0.4962 - val_loss: 3.0393 - val_accuracy20: 0.4808 - 224s/epoch - 41ms/step
Epoch 47/50
5475/5475 - 226s - loss: 2.9921 - accuracy20: 0.4964 - val_loss: 3.0367 - val_accuracy20: 0.4825 - 226s/epoch - 41ms/step
Epoch 48/50
5475/5475 - 221s - loss: 2.9910 - accuracy20: 0.4969 - val_loss: 3.0379 - val_accuracy20: 0.4803 - 221s/epoch - 40ms/step
testing model: results/AAPL/W3/deepVOL_L3/h20
Evaluating performance on  test set...
13689/13689 - 262s - 262s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0180854
{'0': {'precision': 0.5172829190034667, 'recall': 0.47165123698938227, 'f1-score': 0.4934143029502719, 'support': 1147140}, '1': {'precision': 0.4026018632375315, 'recall': 0.40695049409837475, 'f1-score': 0.40476449900931677, 'support': 1186707}, '2': {'precision': 0.4976409604575877, 'recall': 0.5352174771167781, 'f1-score': 0.5157456814538603, 'support': 1170399}, 'accuracy': 0.4709712160618861, 'macro avg': {'precision': 0.47250858089952863, 'recall': 0.4712730694015117, 'f1-score': 0.4713081611378163, 'support': 3504246}, 'weighted avg': {'precision': 0.4718860660756289, 'recall': 0.4709712160618861, 'f1-score': 0.47085175459717754, 'support': 3504246}}
[[541050 359618 246472]
 [317891 482931 385885]
 [187005 356976 626418]]
Evaluating performance on  train set...
5475/5475 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233628
{'0': {'precision': 0.509657556669507, 'recall': 0.4731715203379966, 'f1-score': 0.4907372941698552, 'support': 463910}, '1': {'precision': 0.4199427389416293, 'recall': 0.3298727012514661, 'f1-score': 0.36949798107635745, 'support': 464655}, '2': {'precision': 0.47248593762378854, 'recall': 0.6052122511368898, 'f1-score': 0.5306759924476745, 'support': 473001}, 'accuracy': 0.47022544782050935, 'macro avg': {'precision': 0.46736207774497496, 'recall': 0.4694188242421175, 'f1-score': 0.4636370892312957, 'support': 1401566}, 'weighted avg': {'precision': 0.4673701070513007, 'recall': 0.47022544782050935, 'f1-score': 0.46402188526199617, 'support': 1401566}}
[[219509 108194 136207]
 [127979 153277 183399]
 [ 83211 103524 286266]]
Evaluating performance on  val set...
2036/2036 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090431
{'0': {'precision': 0.5266299388244837, 'recall': 0.4637542263917329, 'f1-score': 0.49319621304921707, 'support': 167992}, '1': {'precision': 0.4354805539723484, 'recall': 0.4125443220466349, 'f1-score': 0.423702263892065, 'support': 179651}, '2': {'precision': 0.49177712563764203, 'recall': 0.5754120744585851, 'f1-score': 0.530317390784915, 'support': 173573}, 'accuracy': 0.4832871592583497, 'macro avg': {'precision': 0.48462920614482474, 'recall': 0.48390354096565097, 'f1-score': 0.48240528924206566, 'support': 521216}, 'weighted avg': {'precision': 0.48360634499514876, 'recall': 0.4832871592583497, 'f1-score': 0.48160519650921596, 'support': 521216}}
[[77907 48596 41489]
 [43810 74114 61727]
 [26218 47479 99876]]
training model: results/AAPL/W3/deepVOL_L3/h30
Epoch 1/50
5475/5475 - 225s - loss: 3.2037 - accuracy30: 0.4192 - val_loss: 3.2392 - val_accuracy30: 0.3916 - 225s/epoch - 41ms/step
Epoch 2/50
5475/5475 - 239s - loss: 3.1662 - accuracy30: 0.4381 - val_loss: 3.2578 - val_accuracy30: 0.4074 - 239s/epoch - 44ms/step
Epoch 3/50
5475/5475 - 239s - loss: 3.1429 - accuracy30: 0.4485 - val_loss: 3.2455 - val_accuracy30: 0.4115 - 239s/epoch - 44ms/step
Epoch 4/50
5475/5475 - 224s - loss: 3.1263 - accuracy30: 0.4547 - val_loss: 3.2092 - val_accuracy30: 0.4166 - 224s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 238s - loss: 3.1130 - accuracy30: 0.4594 - val_loss: 3.1878 - val_accuracy30: 0.4289 - 238s/epoch - 44ms/step
Epoch 6/50
5475/5475 - 222s - loss: 3.1035 - accuracy30: 0.4630 - val_loss: 3.1646 - val_accuracy30: 0.4321 - 222s/epoch - 41ms/step
Epoch 7/50
5475/5475 - 226s - loss: 3.0958 - accuracy30: 0.4655 - val_loss: 3.1642 - val_accuracy30: 0.4355 - 226s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 226s - loss: 3.0910 - accuracy30: 0.4672 - val_loss: 3.1643 - val_accuracy30: 0.4373 - 226s/epoch - 41ms/step
Epoch 9/50
5475/5475 - 225s - loss: 3.0868 - accuracy30: 0.4689 - val_loss: 3.1611 - val_accuracy30: 0.4395 - 225s/epoch - 41ms/step
Epoch 10/50
5475/5475 - 226s - loss: 3.0829 - accuracy30: 0.4701 - val_loss: 3.1471 - val_accuracy30: 0.4442 - 226s/epoch - 41ms/step
Epoch 11/50
5475/5475 - 226s - loss: 3.0798 - accuracy30: 0.4714 - val_loss: 3.1440 - val_accuracy30: 0.4483 - 226s/epoch - 41ms/step
Epoch 12/50
5475/5475 - 220s - loss: 3.0767 - accuracy30: 0.4721 - val_loss: 3.1389 - val_accuracy30: 0.4492 - 220s/epoch - 40ms/step
Epoch 13/50
5475/5475 - 237s - loss: 3.0742 - accuracy30: 0.4731 - val_loss: 3.1391 - val_accuracy30: 0.4509 - 237s/epoch - 43ms/step
Epoch 14/50
5475/5475 - 239s - loss: 3.0718 - accuracy30: 0.4740 - val_loss: 3.1353 - val_accuracy30: 0.4549 - 239s/epoch - 44ms/step
Epoch 15/50
5475/5475 - 237s - loss: 3.0691 - accuracy30: 0.4749 - val_loss: 3.1267 - val_accuracy30: 0.4578 - 237s/epoch - 43ms/step
Epoch 16/50
5475/5475 - 223s - loss: 3.0666 - accuracy30: 0.4757 - val_loss: 3.1203 - val_accuracy30: 0.4602 - 223s/epoch - 41ms/step
Epoch 17/50
5475/5475 - 221s - loss: 3.0647 - accuracy30: 0.4762 - val_loss: 3.1195 - val_accuracy30: 0.4634 - 221s/epoch - 40ms/step
Epoch 18/50
5475/5475 - 224s - loss: 3.0625 - accuracy30: 0.4771 - val_loss: 3.1214 - val_accuracy30: 0.4636 - 224s/epoch - 41ms/step
Epoch 19/50
5475/5475 - 219s - loss: 3.0607 - accuracy30: 0.4776 - val_loss: 3.1196 - val_accuracy30: 0.4645 - 219s/epoch - 40ms/step
Epoch 20/50
5475/5475 - 226s - loss: 3.0591 - accuracy30: 0.4779 - val_loss: 3.1217 - val_accuracy30: 0.4640 - 226s/epoch - 41ms/step
Epoch 21/50
5475/5475 - 221s - loss: 3.0573 - accuracy30: 0.4785 - val_loss: 3.1257 - val_accuracy30: 0.4638 - 221s/epoch - 40ms/step
Epoch 22/50
5475/5475 - 220s - loss: 3.0555 - accuracy30: 0.4794 - val_loss: 3.1119 - val_accuracy30: 0.4670 - 220s/epoch - 40ms/step
Epoch 23/50
5475/5475 - 238s - loss: 3.0537 - accuracy30: 0.4802 - val_loss: 3.1168 - val_accuracy30: 0.4652 - 238s/epoch - 43ms/step
Epoch 24/50
5475/5475 - 240s - loss: 3.0521 - accuracy30: 0.4803 - val_loss: 3.1098 - val_accuracy30: 0.4681 - 240s/epoch - 44ms/step
Epoch 25/50
5475/5475 - 241s - loss: 3.0507 - accuracy30: 0.4806 - val_loss: 3.1121 - val_accuracy30: 0.4666 - 241s/epoch - 44ms/step
Epoch 26/50
5475/5475 - 239s - loss: 3.0490 - accuracy30: 0.4809 - val_loss: 3.1217 - val_accuracy30: 0.4650 - 239s/epoch - 44ms/step
Epoch 27/50
5475/5475 - 243s - loss: 3.0475 - accuracy30: 0.4816 - val_loss: 3.1127 - val_accuracy30: 0.4668 - 243s/epoch - 44ms/step
Epoch 28/50
5475/5475 - 240s - loss: 3.0460 - accuracy30: 0.4820 - val_loss: 3.1127 - val_accuracy30: 0.4643 - 240s/epoch - 44ms/step
Epoch 29/50
5475/5475 - 244s - loss: 3.0443 - accuracy30: 0.4828 - val_loss: 3.1092 - val_accuracy30: 0.4661 - 244s/epoch - 45ms/step
Epoch 30/50
5475/5475 - 240s - loss: 3.0435 - accuracy30: 0.4830 - val_loss: 3.1123 - val_accuracy30: 0.4657 - 240s/epoch - 44ms/step
Epoch 31/50
5475/5475 - 240s - loss: 3.0419 - accuracy30: 0.4834 - val_loss: 3.1187 - val_accuracy30: 0.4636 - 240s/epoch - 44ms/step
Epoch 32/50
5475/5475 - 239s - loss: 3.0405 - accuracy30: 0.4842 - val_loss: 3.1092 - val_accuracy30: 0.4663 - 239s/epoch - 44ms/step
Epoch 33/50
5475/5475 - 239s - loss: 3.0392 - accuracy30: 0.4842 - val_loss: 3.1167 - val_accuracy30: 0.4645 - 239s/epoch - 44ms/step
Epoch 34/50
5475/5475 - 240s - loss: 3.0378 - accuracy30: 0.4848 - val_loss: 3.1103 - val_accuracy30: 0.4644 - 240s/epoch - 44ms/step
Epoch 35/50
5475/5475 - 240s - loss: 3.0363 - accuracy30: 0.4853 - val_loss: 3.1157 - val_accuracy30: 0.4638 - 240s/epoch - 44ms/step
Epoch 36/50
5475/5475 - 241s - loss: 3.0350 - accuracy30: 0.4856 - val_loss: 3.1194 - val_accuracy30: 0.4628 - 241s/epoch - 44ms/step
Epoch 37/50
5475/5475 - 239s - loss: 3.0335 - accuracy30: 0.4864 - val_loss: 3.1108 - val_accuracy30: 0.4657 - 239s/epoch - 44ms/step
Epoch 38/50
5475/5475 - 240s - loss: 3.0321 - accuracy30: 0.4866 - val_loss: 3.1108 - val_accuracy30: 0.4649 - 240s/epoch - 44ms/step
Epoch 39/50
5475/5475 - 224s - loss: 3.0307 - accuracy30: 0.4870 - val_loss: 3.1068 - val_accuracy30: 0.4663 - 224s/epoch - 41ms/step
Epoch 40/50
5475/5475 - 240s - loss: 3.0295 - accuracy30: 0.4878 - val_loss: 3.1078 - val_accuracy30: 0.4665 - 240s/epoch - 44ms/step
Epoch 41/50
5475/5475 - 239s - loss: 3.0284 - accuracy30: 0.4880 - val_loss: 3.1086 - val_accuracy30: 0.4658 - 239s/epoch - 44ms/step
Epoch 42/50
5475/5475 - 244s - loss: 3.0268 - accuracy30: 0.4880 - val_loss: 3.1180 - val_accuracy30: 0.4637 - 244s/epoch - 44ms/step
Epoch 43/50
5475/5475 - 238s - loss: 3.0256 - accuracy30: 0.4888 - val_loss: 3.1083 - val_accuracy30: 0.4651 - 238s/epoch - 43ms/step
Epoch 44/50
5475/5475 - 226s - loss: 3.0241 - accuracy30: 0.4891 - val_loss: 3.1146 - val_accuracy30: 0.4642 - 226s/epoch - 41ms/step
Epoch 45/50
5475/5475 - 228s - loss: 3.0230 - accuracy30: 0.4894 - val_loss: 3.1156 - val_accuracy30: 0.4625 - 228s/epoch - 42ms/step
Epoch 46/50
5475/5475 - 227s - loss: 3.0221 - accuracy30: 0.4898 - val_loss: 3.1129 - val_accuracy30: 0.4628 - 227s/epoch - 41ms/step
Epoch 47/50
5475/5475 - 221s - loss: 3.0206 - accuracy30: 0.4903 - val_loss: 3.1186 - val_accuracy30: 0.4630 - 221s/epoch - 40ms/step
Epoch 48/50
5475/5475 - 223s - loss: 3.0192 - accuracy30: 0.4909 - val_loss: 3.1141 - val_accuracy30: 0.4635 - 223s/epoch - 41ms/step
Epoch 49/50
5475/5475 - 225s - loss: 3.0177 - accuracy30: 0.4913 - val_loss: 3.1185 - val_accuracy30: 0.4626 - 225s/epoch - 41ms/step
testing model: results/AAPL/W3/deepVOL_L3/h30
Evaluating performance on  test set...
13689/13689 - 265s - 265s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0444142
{'0': {'precision': 0.5161078642468984, 'recall': 0.4328308339393463, 'f1-score': 0.47081523329507324, 'support': 1221096}, '1': {'precision': 0.3486321488288086, 'recall': 0.2931347155251828, 'f1-score': 0.31848383407185615, 'support': 1037772}, '2': {'precision': 0.4744813412224871, 'recall': 0.6124887383589561, 'f1-score': 0.5347239699038131, 'support': 1245378}, 'accuracy': 0.45530907362097295, 'macro avg': {'precision': 0.44640711809939804, 'recall': 0.446151429274495, 'f1-score': 0.4413410124235808, 'support': 3504246}, 'weighted avg': {'precision': 0.45171673299299747, 'recall': 0.45530907362097295, 'f1-score': 0.4484153429179829, 'support': 3504246}}
[[528528 297588 394980]
 [283717 304207 449848]
 [211820 270778 762780]]
Evaluating performance on  train set...
5475/5475 - 105s - 105s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0433854
{'0': {'precision': 0.4979695910850883, 'recall': 0.4203349735864666, 'f1-score': 0.45587061845974475, 'support': 464156}, '1': {'precision': 0.4101299179886178, 'recall': 0.25443757629611735, 'f1-score': 0.3140462426976282, 'support': 463654}, '2': {'precision': 0.4383878249068727, 'recall': 0.6682195053994039, 'f1-score': 0.5294367523325801, 'support': 473756}, 'accuracy': 0.4492439171612325, 'macro avg': {'precision': 0.4488291113268596, 'recall': 0.4476640184273293, 'f1-score': 0.4331178711633177, 'support': 1401566}, 'weighted avg': {'precision': 0.4487714548521905, 'recall': 0.4492439171612325, 'f1-score': 0.43382025351043135, 'support': 1401566}}
[[195101  90245 178810]
 [118936 117971 226747]
 [ 77756  79427 316573]]
Evaluating performance on  val set...
2036/2036 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0352737
{'0': {'precision': 0.5210797331661513, 'recall': 0.41722410856298436, 'f1-score': 0.4634043206299588, 'support': 177298}, '1': {'precision': 0.40162340091269544, 'recall': 0.33202219047442344, 'f1-score': 0.3635212502666228, 'support': 161691}, '2': {'precision': 0.47034224402956204, 'recall': 0.6338742337853337, 'f1-score': 0.539998878011837, 'support': 182227}, 'accuracy': 0.46653786529960706, 'macro avg': {'precision': 0.4643484593694696, 'recall': 0.4610401776075805, 'f1-score': 0.4556414829694728, 'support': 521216}, 'weighted avg': {'precision': 0.4662833450059897, 'recall': 0.46653786529960706, 'f1-score': 0.45919762489903215, 'support': 521216}}
[[ 73973  41814  61511]
 [ 39441  53685  68565]
 [ 28547  38171 115509]]
training model: results/AAPL/W3/deepVOL_L3/h50
Epoch 1/50
5475/5475 - 228s - loss: 3.2352 - accuracy50: 0.4036 - val_loss: 3.3307 - val_accuracy50: 0.3474 - 228s/epoch - 42ms/step
Epoch 2/50
5475/5475 - 221s - loss: 3.2091 - accuracy50: 0.4181 - val_loss: 3.3279 - val_accuracy50: 0.3544 - 221s/epoch - 40ms/step
Epoch 3/50
5475/5475 - 223s - loss: 3.1968 - accuracy50: 0.4245 - val_loss: 3.3320 - val_accuracy50: 0.3550 - 223s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 225s - loss: 3.1871 - accuracy50: 0.4296 - val_loss: 3.3351 - val_accuracy50: 0.3574 - 225s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 227s - loss: 3.1814 - accuracy50: 0.4320 - val_loss: 3.3121 - val_accuracy50: 0.3598 - 227s/epoch - 42ms/step
Epoch 6/50
5475/5475 - 228s - loss: 3.1787 - accuracy50: 0.4335 - val_loss: 3.3121 - val_accuracy50: 0.3625 - 228s/epoch - 42ms/step
Epoch 7/50
5475/5475 - 231s - loss: 3.1743 - accuracy50: 0.4354 - val_loss: 3.3337 - val_accuracy50: 0.3592 - 231s/epoch - 42ms/step
Epoch 8/50
5475/5475 - 229s - loss: 3.1689 - accuracy50: 0.4377 - val_loss: 3.3208 - val_accuracy50: 0.3593 - 229s/epoch - 42ms/step
Epoch 9/50
5475/5475 - 230s - loss: 3.1654 - accuracy50: 0.4391 - val_loss: 3.3095 - val_accuracy50: 0.3616 - 230s/epoch - 42ms/step
Epoch 10/50
5475/5475 - 228s - loss: 3.1622 - accuracy50: 0.4407 - val_loss: 3.3193 - val_accuracy50: 0.3599 - 228s/epoch - 42ms/step
Epoch 11/50
5475/5475 - 229s - loss: 3.1591 - accuracy50: 0.4418 - val_loss: 3.3225 - val_accuracy50: 0.3610 - 229s/epoch - 42ms/step
Epoch 12/50
5475/5475 - 228s - loss: 3.1567 - accuracy50: 0.4428 - val_loss: 3.3218 - val_accuracy50: 0.3621 - 228s/epoch - 42ms/step
Epoch 13/50
5475/5475 - 230s - loss: 3.1542 - accuracy50: 0.4441 - val_loss: 3.3267 - val_accuracy50: 0.3618 - 230s/epoch - 42ms/step
Epoch 14/50
5475/5475 - 235s - loss: 3.1522 - accuracy50: 0.4445 - val_loss: 3.3254 - val_accuracy50: 0.3614 - 235s/epoch - 43ms/step
Epoch 15/50
5475/5475 - 229s - loss: 3.1502 - accuracy50: 0.4456 - val_loss: 3.3301 - val_accuracy50: 0.3622 - 229s/epoch - 42ms/step
Epoch 16/50
5475/5475 - 230s - loss: 3.1482 - accuracy50: 0.4466 - val_loss: 3.3307 - val_accuracy50: 0.3620 - 230s/epoch - 42ms/step
Epoch 17/50
5475/5475 - 227s - loss: 3.1464 - accuracy50: 0.4476 - val_loss: 3.3300 - val_accuracy50: 0.3619 - 227s/epoch - 41ms/step
Epoch 18/50
5475/5475 - 229s - loss: 3.1447 - accuracy50: 0.4480 - val_loss: 3.3316 - val_accuracy50: 0.3626 - 229s/epoch - 42ms/step
Epoch 19/50
5475/5475 - 228s - loss: 3.1432 - accuracy50: 0.4484 - val_loss: 3.3347 - val_accuracy50: 0.3636 - 228s/epoch - 42ms/step
testing model: results/AAPL/W3/deepVOL_L3/h50
Evaluating performance on  test set...
13689/13689 - 261s - 261s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1028999
{'0': {'precision': 0.517619823002734, 'recall': 0.10482609018906378, 'f1-score': 0.17434466545533367, 'support': 1143265}, '1': {'precision': 0.3478338475416365, 'recall': 0.8957353584429129, 'f1-score': 0.5010852224498655, 'support': 1213959}, '2': {'precision': 0.5136675036846989, 'recall': 0.06562995304362078, 'f1-score': 0.1163891667581445, 'support': 1147022}, 'accuracy': 0.3659871481625434, 'macro avg': {'precision': 0.4597070580763565, 'recall': 0.35539713389186584, 'f1-score': 0.26393968488778125, 'support': 3504246}, 'weighted avg': {'precision': 0.45750800146007126, 'recall': 0.3659871481625434, 'f1-score': 0.2685656213476647, 'support': 3504246}}
[[ 119844  999843   23578]
 [  78878 1087386   47695]
 [  32807 1038936   75279]]
Evaluating performance on  train set...
5475/5475 - 125s - 125s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1211867
{'0': {'precision': 0.5229142797625247, 'recall': 0.06467313476736522, 'f1-score': 0.11510970061848105, 'support': 465773}, '1': {'precision': 0.32989453088562143, 'recall': 0.9248792907439667, 'f1-score': 0.4863228965831534, 'support': 462682}, '2': {'precision': 0.500523470717689, 'recall': 0.04951480730737607, 'f1-score': 0.09011490361867538, 'support': 473111}, 'accuracy': 0.3435257419201094, 'macro avg': {'precision': 0.45111076045527837, 'recall': 0.34635574427290267, 'f1-score': 0.23051583360676994, 'support': 1401566}, 'weighted avg': {'precision': 0.4516367933595479, 'recall': 0.3435257419201094, 'f1-score': 0.22921659999528637, 'support': 1401566}}
[[ 30123 427585   8065]
 [ 19445 427925  15312]
 [  8038 441647  23426]]
Evaluating performance on  val set...
2036/2036 - 47s - 47s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1045874
{'0': {'precision': 0.5208171618093289, 'recall': 0.08679775611247663, 'f1-score': 0.1487974032781597, 'support': 170062}, '1': {'precision': 0.3458562622417053, 'recall': 0.9074713698531088, 'f1-score': 0.5008341762068695, 'support': 179793}, '2': {'precision': 0.5085203067310423, 'recall': 0.06269221117990674, 'f1-score': 0.11162312260048729, 'support': 171361}, 'accuracy': 0.361963178413556, 'macro avg': {'precision': 0.45839791026069215, 'recall': 0.3523204457151641, 'f1-score': 0.25375156736183885, 'support': 521216}, 'weighted avg': {'precision': 0.45642169735882854, 'recall': 0.361963178413556, 'f1-score': 0.2580103315151381, 'support': 521216}}
[[ 14761 151807   3494]
 [  9747 163157   6889]
 [  3834 156784  10743]]
training model: results/AAPL/W3/deepVOL_L3/h100
Epoch 1/50
5475/5475 - 244s - loss: 3.2617 - accuracy100: 0.3830 - val_loss: 3.4617 - val_accuracy100: 0.3530 - 244s/epoch - 45ms/step
Epoch 2/50
5475/5475 - 231s - loss: 3.2536 - accuracy100: 0.3887 - val_loss: 3.4402 - val_accuracy100: 0.3530 - 231s/epoch - 42ms/step
Epoch 3/50
5475/5475 - 226s - loss: 3.2492 - accuracy100: 0.3952 - val_loss: 3.4341 - val_accuracy100: 0.3530 - 226s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 225s - loss: 3.2439 - accuracy100: 0.3974 - val_loss: 3.4396 - val_accuracy100: 0.3530 - 225s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 228s - loss: 3.2426 - accuracy100: 0.3980 - val_loss: 3.4438 - val_accuracy100: 0.3529 - 228s/epoch - 42ms/step
Epoch 6/50
5475/5475 - 230s - loss: 3.2378 - accuracy100: 0.4024 - val_loss: 3.4624 - val_accuracy100: 0.3530 - 230s/epoch - 42ms/step
Epoch 7/50
5475/5475 - 228s - loss: 3.2357 - accuracy100: 0.4037 - val_loss: 3.4791 - val_accuracy100: 0.3530 - 228s/epoch - 42ms/step
Epoch 8/50
5475/5475 - 224s - loss: 3.2339 - accuracy100: 0.4051 - val_loss: 3.4669 - val_accuracy100: 0.3530 - 224s/epoch - 41ms/step
Epoch 9/50
5475/5475 - 224s - loss: 3.2263 - accuracy100: 0.4091 - val_loss: 3.4760 - val_accuracy100: 0.3529 - 224s/epoch - 41ms/step
Epoch 10/50
5475/5475 - 224s - loss: 3.2212 - accuracy100: 0.4125 - val_loss: 3.4847 - val_accuracy100: 0.3530 - 224s/epoch - 41ms/step
Epoch 11/50
5475/5475 - 235s - loss: 3.2157 - accuracy100: 0.4147 - val_loss: 3.4931 - val_accuracy100: 0.3531 - 235s/epoch - 43ms/step
Epoch 12/50
5475/5475 - 225s - loss: 3.2119 - accuracy100: 0.4166 - val_loss: 3.4911 - val_accuracy100: 0.3533 - 225s/epoch - 41ms/step
Epoch 13/50
5475/5475 - 240s - loss: 3.2091 - accuracy100: 0.4179 - val_loss: 3.4998 - val_accuracy100: 0.3539 - 240s/epoch - 44ms/step
testing model: results/AAPL/W3/deepVOL_L3/h100
Evaluating performance on  test set...
13689/13689 - 263s - 263s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1861039
{'0': {'precision': 0.38031319910514544, 'recall': 0.00013897995255060915, 'f1-score': 0.0002778583657841939, 'support': 1223198}, '1': {'precision': 0.3015937078282234, 'recall': 0.9997672411835502, 'f1-score': 0.4633971988520345, 'support': 1056888}, '2': {'precision': 0.30996309963099633, 'recall': 6.86184812442818e-05, 'f1-score': 0.00013720658820301024, 'support': 1224160}, 'accuracy': 0.30160439649499493, 'macro avg': {'precision': 0.33062333552145506, 'recall': 0.33332494653911504, 'f1-score': 0.15460408793534056, 'support': 3504246}, 'weighted avg': {'precision': 0.3319953973672087, 'recall': 0.30160439649499493, 'f1-score': 0.13990649552418813, 'support': 3504246}}
[[    170 1222946      82]
 [    141 1056642     105]
 [    136 1223940      84]]
Evaluating performance on  train set...
5475/5475 - 101s - 101s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1707716
{'0': {'precision': 0.5151515151515151, 'recall': 7.240944559920946e-05, 'f1-score': 0.00014479853838651844, 'support': 469552}, '1': {'precision': 0.32748490859532203, 'recall': 0.999919388924474, 'f1-score': 0.49338172295579463, 'support': 458994}, '2': {'precision': 0.325, 'recall': 2.7482981692106043e-05, 'f1-score': 5.496131568934174e-05, 'support': 473020}, 'accuracy': 0.327493674932183, 'macro avg': {'precision': 0.3892121412489457, 'recall': 0.3333397604505884, 'f1-score': 0.16452716093662348, 'support': 1401566}, 'weighted avg': {'precision': 0.38951824771593024, 'recall': 0.327493674932183, 'f1-score': 0.16164293282743433, 'support': 1401566}}
[[    34 469508     10]
 [    20 458957     17]
 [    12 472995     13]]
Evaluating performance on  val set...
2036/2036 - 40s - 40s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1480901
{'0': {'precision': 0.47058823529411764, 'recall': 4.7381295049246935e-05, 'f1-score': 9.475304986379249e-05, 'support': 168843}, '1': {'precision': 0.35295867070877623, 'recall': 0.99992390022232, 'f1-score': 0.5217478859078011, 'support': 183969}, '2': {'precision': 0.5789473684210527, 'recall': 6.531911356024797e-05, 'f1-score': 0.00013062348966590072, 'support': 168404}, 'accuracy': 0.3529707453339882, 'macro avg': {'precision': 0.4674980914746489, 'recall': 0.3333455335436432, 'f1-score': 0.1739910874824436, 'support': 521216}, 'weighted avg': {'precision': 0.4640802195921969, 'recall': 0.3529707453339882, 'f1-score': 0.18422963364502262, 'support': 521216}}
[[     8 168833      2]
 [     8 183955      6]
 [     1 168392     11]]
training model: results/AAPL/W3/deepVOL_L3/h200
Epoch 1/50
5475/5475 - 230s - loss: 3.2695 - accuracy200: 0.3772 - val_loss: 3.3916 - val_accuracy200: 0.3366 - 230s/epoch - 42ms/step
Epoch 2/50
5475/5475 - 237s - loss: 3.2671 - accuracy200: 0.3732 - val_loss: 3.4148 - val_accuracy200: 0.3366 - 237s/epoch - 43ms/step
Epoch 3/50
5475/5475 - 226s - loss: 3.2625 - accuracy200: 0.3774 - val_loss: 3.4221 - val_accuracy200: 0.3365 - 226s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 232s - loss: 3.2549 - accuracy200: 0.3848 - val_loss: 3.4361 - val_accuracy200: 0.3365 - 232s/epoch - 42ms/step
Epoch 5/50
5475/5475 - 223s - loss: 3.2475 - accuracy200: 0.3919 - val_loss: 3.4277 - val_accuracy200: 0.3366 - 223s/epoch - 41ms/step
Epoch 6/50
5475/5475 - 238s - loss: 3.2420 - accuracy200: 0.3969 - val_loss: 3.4319 - val_accuracy200: 0.3366 - 238s/epoch - 44ms/step
Epoch 7/50
5475/5475 - 226s - loss: 3.2375 - accuracy200: 0.4001 - val_loss: 3.4400 - val_accuracy200: 0.3366 - 226s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 235s - loss: 3.2345 - accuracy200: 0.4023 - val_loss: 3.4332 - val_accuracy200: 0.3367 - 235s/epoch - 43ms/step
Epoch 9/50
5475/5475 - 234s - loss: 3.2319 - accuracy200: 0.4040 - val_loss: 3.4324 - val_accuracy200: 0.3366 - 234s/epoch - 43ms/step
Epoch 10/50
5475/5475 - 235s - loss: 3.2297 - accuracy200: 0.4056 - val_loss: 3.4296 - val_accuracy200: 0.3367 - 235s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 223s - loss: 3.2276 - accuracy200: 0.4068 - val_loss: 3.4228 - val_accuracy200: 0.3368 - 223s/epoch - 41ms/step
testing model: results/AAPL/W3/deepVOL_L3/h200
Evaluating performance on  test set...
13689/13689 - 250s - 250s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.134352
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1167811}, '1': {'precision': 0.3336466674999415, 'recall': 1.0, 'f1-score': 0.500352418118956, 'support': 1169180}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1167255}, 'accuracy': 0.3336466674999415, 'macro avg': {'precision': 0.11121555583331383, 'recall': 0.3333333333333333, 'f1-score': 0.16678413937298533, 'support': 3504246}, 'weighted avg': {'precision': 0.11132009873381651, 'recall': 0.3336466674999415, 'f1-score': 0.16694091688092702, 'support': 3504246}}
[[      0 1167811       0]
 [      0 1169180       0]
 [      0 1167255       0]]
Evaluating performance on  train set...
5475/5475 - 102s - 102s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1370305
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 470660}, '1': {'precision': 0.32911852108179074, 'recall': 0.9999978321287195, 'f1-score': 0.49524303391529206, 'support': 461282}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 469624}, 'accuracy': 0.32911828625979794, 'macro avg': {'precision': 0.10970617369393025, 'recall': 0.33333261070957315, 'f1-score': 0.16508101130509736, 'support': 1401566}, 'weighted avg': {'precision': 0.10831915845679091, 'recall': 0.32911828625979794, 'f1-score': 0.16299389195408118, 'support': 1401566}}
[[     0 470660      0]
 [     1 461281      0]
 [     0 469624      0]]
Evaluating performance on  val set...
2036/2036 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327584
{'0': {'precision': 1.0, 'recall': 5.757715338553662e-06, 'f1-score': 1.1515364374917233e-05, 'support': 173680}, '1': {'precision': 0.3365546589308806, 'recall': 0.9999942993307415, 'f1-score': 0.503614533928961, 'support': 175418}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172118}, 'accuracy': 0.33655528610019647, 'macro avg': {'precision': 0.44551821964362687, 'recall': 0.3333333523486934, 'f1-score': 0.16787534976444532, 'support': 521216}, 'weighted avg': {'precision': 0.44649002555627076, 'recall': 0.33655528610019647, 'f1-score': 0.16949797070933187, 'support': 521216}}
[[     1 173679      0]
 [     0 175417      1]
 [     0 172118      0]]
training model: results/AAPL/W3/deepVOL_L3/h300
Epoch 1/50
5475/5475 - 226s - loss: 3.2702 - accuracy300: 0.3786 - val_loss: 3.3649 - val_accuracy300: 0.3445 - 226s/epoch - 41ms/step
Epoch 2/50
5475/5475 - 222s - loss: 3.2717 - accuracy300: 0.3714 - val_loss: 3.3632 - val_accuracy300: 0.3445 - 222s/epoch - 41ms/step
Epoch 3/50
5475/5475 - 223s - loss: 3.2711 - accuracy300: 0.3720 - val_loss: 3.3779 - val_accuracy300: 0.3445 - 223s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 222s - loss: 3.2650 - accuracy300: 0.3797 - val_loss: 3.3658 - val_accuracy300: 0.3445 - 222s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 220s - loss: 3.2604 - accuracy300: 0.3862 - val_loss: 3.3640 - val_accuracy300: 0.3446 - 220s/epoch - 40ms/step
Epoch 6/50
5475/5475 - 222s - loss: 3.2527 - accuracy300: 0.3933 - val_loss: 3.3610 - val_accuracy300: 0.3445 - 222s/epoch - 41ms/step
Epoch 7/50
5475/5475 - 223s - loss: 3.2459 - accuracy300: 0.3975 - val_loss: 3.3645 - val_accuracy300: 0.3446 - 223s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 228s - loss: 3.2408 - accuracy300: 0.4006 - val_loss: 3.3578 - val_accuracy300: 0.3445 - 228s/epoch - 42ms/step
Epoch 9/50
5475/5475 - 229s - loss: 3.2374 - accuracy300: 0.4027 - val_loss: 3.3601 - val_accuracy300: 0.3445 - 229s/epoch - 42ms/step
Epoch 10/50
5475/5475 - 221s - loss: 3.2348 - accuracy300: 0.4041 - val_loss: 3.3572 - val_accuracy300: 0.3446 - 221s/epoch - 40ms/step
Epoch 11/50
5475/5475 - 223s - loss: 3.2326 - accuracy300: 0.4054 - val_loss: 3.3672 - val_accuracy300: 0.3446 - 223s/epoch - 41ms/step
Epoch 12/50
5475/5475 - 223s - loss: 3.2306 - accuracy300: 0.4067 - val_loss: 3.3681 - val_accuracy300: 0.3445 - 223s/epoch - 41ms/step
Epoch 13/50
5475/5475 - 221s - loss: 3.2292 - accuracy300: 0.4076 - val_loss: 3.3743 - val_accuracy300: 0.3445 - 221s/epoch - 40ms/step
Epoch 14/50
5475/5475 - 221s - loss: 3.2280 - accuracy300: 0.4087 - val_loss: 3.3744 - val_accuracy300: 0.3445 - 221s/epoch - 40ms/step
Epoch 15/50
5475/5475 - 220s - loss: 3.2266 - accuracy300: 0.4092 - val_loss: 3.3770 - val_accuracy300: 0.3445 - 220s/epoch - 40ms/step
Epoch 16/50
5475/5475 - 222s - loss: 3.2255 - accuracy300: 0.4101 - val_loss: 3.3777 - val_accuracy300: 0.3445 - 222s/epoch - 40ms/step
Epoch 17/50
5475/5475 - 220s - loss: 3.2245 - accuracy300: 0.4104 - val_loss: 3.3798 - val_accuracy300: 0.3445 - 220s/epoch - 40ms/step
Epoch 18/50
5475/5475 - 229s - loss: 3.2235 - accuracy300: 0.4111 - val_loss: 3.3761 - val_accuracy300: 0.3444 - 229s/epoch - 42ms/step
Epoch 19/50
5475/5475 - 238s - loss: 3.2226 - accuracy300: 0.4115 - val_loss: 3.3776 - val_accuracy300: 0.3444 - 238s/epoch - 43ms/step
Epoch 20/50
5475/5475 - 230s - loss: 3.2214 - accuracy300: 0.4118 - val_loss: 3.3731 - val_accuracy300: 0.3443 - 230s/epoch - 42ms/step
testing model: results/AAPL/W3/deepVOL_L3/h300
Evaluating performance on  test set...
13689/13689 - 276s - 276s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1180549
{'0': {'precision': 0.2995391705069124, 'recall': 0.00011463278709340632, 'f1-score': 0.00022917786846953257, 'support': 1134056}, '1': {'precision': 0.35302798908085803, 'recall': 0.9995182152623908, 'f1-score': 0.521768357266739, 'support': 1237067}, '2': {'precision': 0.4122479462285287, 'recall': 0.0004871492326958327, 'f1-score': 0.0009731485056352703, 'support': 1133123}, 'accuracy': 0.35304399291602245, 'macro avg': {'precision': 0.35493836860543304, 'recall': 0.33337333242739337, 'f1-score': 0.1743235612136146, 'support': 3504246}, 'weighted avg': {'precision': 0.35486695240316635, 'recall': 0.35304399291602245, 'f1-score': 0.18458322101526234, 'support': 3504246}}
[[    130 1133570     356]
 [    165 1236471     431]
 [    139 1132432     552]]
Evaluating performance on  train set...
5475/5475 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.129439
{'0': {'precision': 0.41935483870967744, 'recall': 8.267458646807807e-05, 'f1-score': 0.00016531658125309968, 'support': 471729}, '1': {'precision': 0.328297002403817, 'recall': 0.9993979818264406, 'f1-score': 0.4942390617409212, 'support': 460119}, '2': {'precision': 0.4030612244897959, 'recall': 0.0006727440719751, 'f1-score': 0.0013432461498569612, 'support': 469718}, 'accuracy': 0.32834486567168436, 'macro avg': {'precision': 0.3835710218677635, 'recall': 0.3333844668282946, 'f1-score': 0.16524920815734376, 'support': 1401566}, 'weighted avg': {'precision': 0.3840009242544534, 'recall': 0.32834486567168436, 'f1-score': 0.16275916679610333, 'support': 1401566}}
[[    39 471470    220]
 [    29 459842    248]
 [    25 469377    316]]
Evaluating performance on  val set...
2036/2036 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1212071
{'0': {'precision': 0.3333333333333333, 'recall': 7.584730187809588e-05, 'f1-score': 0.0001516600947292284, 'support': 171397}, '1': {'precision': 0.34457263833519836, 'recall': 0.999671457448171, 'f1-score': 0.5124953609866111, 'support': 179581}, '2': {'precision': 0.39325842696629215, 'recall': 0.00041118904122463846, 'f1-score': 0.0008215191061872126, 'support': 170238}, 'accuracy': 0.3445884239931238, 'macro avg': {'precision': 0.3570547995449413, 'recall': 0.33338616459709125, 'f1-score': 0.17115618006250918, 'support': 521216}, 'weighted avg': {'precision': 0.3567783037897805, 'recall': 0.3445884239931238, 'f1-score': 0.17689456439593568, 'support': 521216}}
[[    13 171317     67]
 [    18 179522     41]
 [     8 170160     70]]
training model: results/AAPL/W3/deepVOL_L3/h500
Epoch 1/50
5475/5475 - 234s - loss: 3.2635 - accuracy500: 0.3816 - val_loss: 3.4078 - val_accuracy500: 0.3416 - 234s/epoch - 43ms/step
Epoch 2/50
5475/5475 - 228s - loss: 3.2618 - accuracy500: 0.3783 - val_loss: 3.4052 - val_accuracy500: 0.3416 - 228s/epoch - 42ms/step
Epoch 3/50
5475/5475 - 225s - loss: 3.2649 - accuracy500: 0.3759 - val_loss: 3.3917 - val_accuracy500: 0.3416 - 225s/epoch - 41ms/step
Epoch 4/50
5475/5475 - 226s - loss: 3.2635 - accuracy500: 0.3765 - val_loss: 3.3877 - val_accuracy500: 0.3416 - 226s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 229s - loss: 3.2653 - accuracy500: 0.3756 - val_loss: 3.3916 - val_accuracy500: 0.3416 - 229s/epoch - 42ms/step
Epoch 6/50
5475/5475 - 228s - loss: 3.2596 - accuracy500: 0.3787 - val_loss: 3.3844 - val_accuracy500: 0.3416 - 228s/epoch - 42ms/step
Epoch 7/50
5475/5475 - 226s - loss: 3.2610 - accuracy500: 0.3790 - val_loss: 3.4127 - val_accuracy500: 0.3416 - 226s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 228s - loss: 3.2533 - accuracy500: 0.3859 - val_loss: 3.4134 - val_accuracy500: 0.3416 - 228s/epoch - 42ms/step
Epoch 9/50
5475/5475 - 227s - loss: 3.2440 - accuracy500: 0.3951 - val_loss: 3.4049 - val_accuracy500: 0.3416 - 227s/epoch - 42ms/step
Epoch 10/50
5475/5475 - 234s - loss: 3.2350 - accuracy500: 0.4030 - val_loss: 3.4079 - val_accuracy500: 0.3416 - 234s/epoch - 43ms/step
Epoch 11/50
5475/5475 - 229s - loss: 3.2290 - accuracy500: 0.4073 - val_loss: 3.4282 - val_accuracy500: 0.3416 - 229s/epoch - 42ms/step
Epoch 12/50
5475/5475 - 231s - loss: 3.2249 - accuracy500: 0.4100 - val_loss: 3.4302 - val_accuracy500: 0.3416 - 231s/epoch - 42ms/step
Epoch 13/50
5475/5475 - 230s - loss: 3.2227 - accuracy500: 0.4112 - val_loss: 3.4289 - val_accuracy500: 0.3416 - 230s/epoch - 42ms/step
Epoch 14/50
5475/5475 - 234s - loss: 3.2211 - accuracy500: 0.4123 - val_loss: 3.4131 - val_accuracy500: 0.3416 - 234s/epoch - 43ms/step
Epoch 15/50
5475/5475 - 248s - loss: 3.2194 - accuracy500: 0.4132 - val_loss: 3.4125 - val_accuracy500: 0.3416 - 248s/epoch - 45ms/step
Epoch 16/50
5475/5475 - 239s - loss: 3.2184 - accuracy500: 0.4139 - val_loss: 3.4114 - val_accuracy500: 0.3416 - 239s/epoch - 44ms/step
testing model: results/AAPL/W3/deepVOL_L3/h500
Evaluating performance on  test set...
13689/13689 - 293s - 293s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1229937
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1136742}, '1': {'precision': 0.35352455278539235, 'recall': 1.0, 'f1-score': 0.522376268768647, 'support': 1238837}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1128667}, 'accuracy': 0.35352455278539235, 'macro avg': {'precision': 0.11784151759513078, 'recall': 0.3333333333333333, 'f1-score': 0.17412542292288233, 'support': 3504246}, 'weighted avg': {'precision': 0.12497960942211167, 'recall': 0.35352455278539235, 'f1-score': 0.1846728368021378, 'support': 3504246}}
[[      0 1136742       0]
 [      0 1238837       0]
 [      0 1128667       0]]
Evaluating performance on  train set...
5475/5475 - 116s - 116s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1360021
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 470605}, '1': {'precision': 0.3302384618348333, 'recall': 1.0, 'f1-score': 0.4965101691306183, 'support': 462851}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 468110}, 'accuracy': 0.3302384618348333, 'macro avg': {'precision': 0.11007948727827777, 'recall': 0.3333333333333333, 'f1-score': 0.1655033897102061, 'support': 1401566}, 'weighted avg': {'precision': 0.10905744167503666, 'recall': 0.3302384618348333, 'f1-score': 0.16396675453904833, 'support': 1401566}}
[[     0 470605      0]
 [     0 462851      0]
 [     0 468110      0]]
Evaluating performance on  val set...
2036/2036 - 44s - 44s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.129783
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172294}, '1': {'precision': 0.34158774864931235, 'recall': 1.0, 'f1-score': 0.509229081725317, 'support': 178041}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 170881}, 'accuracy': 0.34158774864931235, 'macro avg': {'precision': 0.11386258288310412, 'recall': 0.3333333333333333, 'f1-score': 0.16974302724177234, 'support': 521216}, 'weighted avg': {'precision': 0.1166821900273058, 'recall': 0.34158774864931235, 'f1-score': 0.17394641557330773, 'support': 521216}}
[[     0 172294      0]
 [     0 178041      0]
 [     0 170881      0]]
training model: results/AAPL/W3/deepVOL_L3/h1000
Epoch 1/50
5475/5475 - 227s - loss: 3.2646 - accuracy1000: 0.3827 - val_loss: 3.4180 - val_accuracy1000: 0.3406 - 227s/epoch - 41ms/step
Epoch 2/50
5475/5475 - 220s - loss: 3.2627 - accuracy1000: 0.3812 - val_loss: 3.4115 - val_accuracy1000: 0.3406 - 220s/epoch - 40ms/step
Epoch 3/50
5475/5475 - 220s - loss: 3.2601 - accuracy1000: 0.3828 - val_loss: 3.4267 - val_accuracy1000: 0.3406 - 220s/epoch - 40ms/step
Epoch 4/50
5475/5475 - 224s - loss: 3.2618 - accuracy1000: 0.3795 - val_loss: 3.4022 - val_accuracy1000: 0.3406 - 224s/epoch - 41ms/step
Epoch 5/50
5475/5475 - 223s - loss: 3.2696 - accuracy1000: 0.3721 - val_loss: 3.3946 - val_accuracy1000: 0.3406 - 223s/epoch - 41ms/step
Epoch 6/50
5475/5475 - 221s - loss: 3.2670 - accuracy1000: 0.3748 - val_loss: 3.4018 - val_accuracy1000: 0.3406 - 221s/epoch - 40ms/step
Epoch 7/50
5475/5475 - 223s - loss: 3.2642 - accuracy1000: 0.3783 - val_loss: 3.4061 - val_accuracy1000: 0.3406 - 223s/epoch - 41ms/step
Epoch 8/50
5475/5475 - 220s - loss: 3.2529 - accuracy1000: 0.3916 - val_loss: 3.3790 - val_accuracy1000: 0.3369 - 220s/epoch - 40ms/step
Epoch 9/50
5475/5475 - 227s - loss: 3.2386 - accuracy1000: 0.4041 - val_loss: 3.3708 - val_accuracy1000: 0.3405 - 227s/epoch - 41ms/step
Epoch 10/50
5475/5475 - 227s - loss: 3.2282 - accuracy1000: 0.4111 - val_loss: 3.3981 - val_accuracy1000: 0.3406 - 227s/epoch - 41ms/step
Epoch 11/50
5475/5475 - 226s - loss: 3.2216 - accuracy1000: 0.4148 - val_loss: 3.4127 - val_accuracy1000: 0.3406 - 226s/epoch - 41ms/step
Epoch 12/50
5475/5475 - 224s - loss: 3.2157 - accuracy1000: 0.4178 - val_loss: 3.4118 - val_accuracy1000: 0.3406 - 224s/epoch - 41ms/step
Epoch 13/50
5475/5475 - 232s - loss: 3.2119 - accuracy1000: 0.4194 - val_loss: 3.4174 - val_accuracy1000: 0.3406 - 232s/epoch - 42ms/step
Epoch 14/50
5475/5475 - 241s - loss: 3.2097 - accuracy1000: 0.4200 - val_loss: 3.4188 - val_accuracy1000: 0.3406 - 241s/epoch - 44ms/step
Epoch 15/50
5475/5475 - 247s - loss: 3.2070 - accuracy1000: 0.4211 - val_loss: 3.4229 - val_accuracy1000: 0.3406 - 247s/epoch - 45ms/step
Epoch 16/50
5475/5475 - 226s - loss: 3.2060 - accuracy1000: 0.4215 - val_loss: 3.4131 - val_accuracy1000: 0.3406 - 226s/epoch - 41ms/step
Epoch 17/50
5475/5475 - 220s - loss: 3.2035 - accuracy1000: 0.4228 - val_loss: 3.4258 - val_accuracy1000: 0.3406 - 220s/epoch - 40ms/step
Epoch 18/50
5475/5475 - 224s - loss: 3.2012 - accuracy1000: 0.4234 - val_loss: 3.4339 - val_accuracy1000: 0.3406 - 224s/epoch - 41ms/step
Epoch 19/50
5475/5475 - 223s - loss: 3.1997 - accuracy1000: 0.4243 - val_loss: 3.4377 - val_accuracy1000: 0.3406 - 223s/epoch - 41ms/step
testing model: results/AAPL/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
13689/13689 - 256s - 256s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.123844
{'0': {'precision': 0.3385480093676815, 'recall': 0.003090019254906923, 'f1-score': 0.0061241418109938, 'support': 1169572}, '1': {'precision': 0.33853040341816437, 'recall': 0.996822453537865, 'f1-score': 0.5054165355240927, 'support': 1186450}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1148224}, 'accuracy': 0.33853045705124585, 'macro avg': {'precision': 0.2256928042619486, 'recall': 0.33330415759759063, 'f1-score': 0.17051355911169552, 'support': 3504246}, 'weighted avg': {'precision': 0.2276112092437743, 'recall': 0.33853045705124585, 'f1-score': 0.17316537519304506, 'support': 3504246}}
[[   3614 1165958       0]
 [   3770 1182680       0]
 [   3291 1144933       0]]
Evaluating performance on  train set...
5475/5475 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271002
{'0': {'precision': 0.3415073927154706, 'recall': 0.0020186560482942676, 'f1-score': 0.004013587710877586, 'support': 469124}, '1': {'precision': 0.3320641438726102, 'recall': 0.9978602962501477, 'f1-score': 0.4983044374283235, 'support': 465485}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 466957}, 'accuracy': 0.33208282735169087, 'macro avg': {'precision': 0.22452384552936025, 'recall': 0.33329298409948066, 'f1-score': 0.16743934171306704, 'support': 1401566}, 'weighted avg': {'precision': 0.22459177242512615, 'recall': 0.33208282735169087, 'f1-score': 0.16683917230983122, 'support': 1401566}}
[[   947 468177      0]
 [   996 464489      0]
 [   830 466127      0]]
Evaluating performance on  val set...
2036/2036 - 40s - 40s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1240731
{'0': {'precision': 0.31636980491942324, 'recall': 0.0021763864982349682, 'f1-score': 0.004323033772976982, 'support': 171385}, '1': {'precision': 0.34054565453160934, 'recall': 0.9974710636739982, 'f1-score': 0.5077431868127142, 'support': 177545}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 172286}, 'accuracy': 0.3404903149557957, 'macro avg': {'precision': 0.21897181981701086, 'recall': 0.3332158167240777, 'f1-score': 0.1706887401952304, 'support': 521216}, 'weighted avg': {'precision': 0.22003011659260255, 'recall': 0.3404903149557957, 'f1-score': 0.17437716272302656, 'support': 521216}}
[[   373 171011      1]
 [   449 177096      0]
 [   357 171929      0]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        53 (peak)  18.64 (ave)

============================================
