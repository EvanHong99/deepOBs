This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-13.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-05.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-23.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-24.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-01.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-28.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-30.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-25.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-15.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-29.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-11.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-31.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-10-22.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-07.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-06.csv
training model: results/QRTEA/W8/deepLOB_L1/h10
Epoch 1/50
614/614 - 33s - loss: 2.9553 - accuracy10: 0.4550 - val_loss: 2.9144 - val_accuracy10: 0.4526 - 33s/epoch - 53ms/step
Epoch 2/50
614/614 - 11s - loss: 2.8480 - accuracy10: 0.4854 - val_loss: 2.8795 - val_accuracy10: 0.5036 - 11s/epoch - 18ms/step
Epoch 3/50
614/614 - 11s - loss: 2.7968 - accuracy10: 0.5076 - val_loss: 2.8381 - val_accuracy10: 0.5495 - 11s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 2.7374 - accuracy10: 0.5236 - val_loss: 2.8111 - val_accuracy10: 0.6279 - 10s/epoch - 17ms/step
Epoch 5/50
614/614 - 10s - loss: 2.6656 - accuracy10: 0.5474 - val_loss: 2.7802 - val_accuracy10: 0.6091 - 10s/epoch - 17ms/step
Epoch 6/50
614/614 - 11s - loss: 2.6056 - accuracy10: 0.5732 - val_loss: 2.9087 - val_accuracy10: 0.6620 - 11s/epoch - 18ms/step
Epoch 7/50
614/614 - 11s - loss: 2.5556 - accuracy10: 0.5901 - val_loss: 2.7765 - val_accuracy10: 0.6190 - 11s/epoch - 18ms/step
Epoch 8/50
614/614 - 11s - loss: 2.5329 - accuracy10: 0.5931 - val_loss: 2.7552 - val_accuracy10: 0.6134 - 11s/epoch - 17ms/step
Epoch 9/50
614/614 - 10s - loss: 2.4952 - accuracy10: 0.6137 - val_loss: 2.8217 - val_accuracy10: 0.6642 - 10s/epoch - 17ms/step
Epoch 10/50
614/614 - 10s - loss: 2.4678 - accuracy10: 0.6219 - val_loss: 2.8159 - val_accuracy10: 0.6715 - 10s/epoch - 17ms/step
Epoch 11/50
614/614 - 10s - loss: 2.4426 - accuracy10: 0.6266 - val_loss: 2.8553 - val_accuracy10: 0.6648 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 2.4127 - accuracy10: 0.6371 - val_loss: 2.7541 - val_accuracy10: 0.6633 - 10s/epoch - 17ms/step
Epoch 13/50
614/614 - 10s - loss: 2.3758 - accuracy10: 0.6460 - val_loss: 2.7728 - val_accuracy10: 0.6839 - 10s/epoch - 16ms/step
Epoch 14/50
614/614 - 10s - loss: 2.3614 - accuracy10: 0.6507 - val_loss: 2.7790 - val_accuracy10: 0.6813 - 10s/epoch - 17ms/step
Epoch 15/50
614/614 - 10s - loss: 2.3460 - accuracy10: 0.6514 - val_loss: 2.7971 - val_accuracy10: 0.6805 - 10s/epoch - 16ms/step
Epoch 16/50
614/614 - 10s - loss: 2.3299 - accuracy10: 0.6548 - val_loss: 2.7326 - val_accuracy10: 0.6673 - 10s/epoch - 16ms/step
Epoch 17/50
614/614 - 10s - loss: 2.3230 - accuracy10: 0.6574 - val_loss: 2.7867 - val_accuracy10: 0.6797 - 10s/epoch - 17ms/step
Epoch 18/50
614/614 - 10s - loss: 2.3062 - accuracy10: 0.6574 - val_loss: 2.7626 - val_accuracy10: 0.6895 - 10s/epoch - 16ms/step
Epoch 19/50
614/614 - 10s - loss: 2.3002 - accuracy10: 0.6596 - val_loss: 2.8041 - val_accuracy10: 0.6975 - 10s/epoch - 16ms/step
Epoch 20/50
614/614 - 10s - loss: 2.2844 - accuracy10: 0.6621 - val_loss: 2.8282 - val_accuracy10: 0.6795 - 10s/epoch - 16ms/step
Epoch 21/50
614/614 - 10s - loss: 2.2758 - accuracy10: 0.6635 - val_loss: 2.7611 - val_accuracy10: 0.6730 - 10s/epoch - 16ms/step
Epoch 22/50
614/614 - 10s - loss: 2.2640 - accuracy10: 0.6656 - val_loss: 2.8074 - val_accuracy10: 0.6777 - 10s/epoch - 16ms/step
Epoch 23/50
614/614 - 10s - loss: 2.2577 - accuracy10: 0.6674 - val_loss: 2.8352 - val_accuracy10: 0.6757 - 10s/epoch - 16ms/step
Epoch 24/50
614/614 - 10s - loss: 2.2425 - accuracy10: 0.6703 - val_loss: 2.8248 - val_accuracy10: 0.6841 - 10s/epoch - 16ms/step
Epoch 25/50
614/614 - 10s - loss: 2.2343 - accuracy10: 0.6710 - val_loss: 2.7939 - val_accuracy10: 0.6726 - 10s/epoch - 16ms/step
Epoch 26/50
614/614 - 10s - loss: 2.2300 - accuracy10: 0.6712 - val_loss: 2.8035 - val_accuracy10: 0.6645 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h10
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9171475
{'0': {'precision': 0.22825664748049013, 'recall': 0.6502887265849782, 'f1-score': 0.33790565406490464, 'support': 49701}, '1': {'precision': 0.9210211924057375, 'recall': 0.5272372057769753, 'f1-score': 0.6705939224032257, 'support': 459133}, '2': {'precision': 0.21750187473509178, 'recall': 0.6814652882768766, 'f1-score': 0.3297561554317576, 'support': 48946}, 'accuracy': 0.5517354512531822, 'macro avg': {'precision': 0.45559323820710657, 'recall': 0.6196637402129433, 'f1-score': 0.44608524396662935, 'support': 557780}, 'weighted avg': {'precision': 0.7975575559002387, 'recall': 0.5517354512531822, 'f1-score': 0.6110407204833499, 'support': 557780}}
[[ 32320  11781   5600]
 [102661 242072 114400]
 [  6614   8977  33355]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7376218
{'0': {'precision': 0.3196287943209968, 'recall': 0.4800111049416991, 'f1-score': 0.38373615642408504, 'support': 18010}, '1': {'precision': 0.8628445597892336, 'recall': 0.7265172333874118, 'f1-score': 0.7888341661573857, 'support': 120812}, '2': {'precision': 0.3304139002683995, 'recall': 0.5122365179304681, 'f1-score': 0.40170885124836303, 'support': 18265}, 'accuracy': 0.6733402509437445, 'macro avg': {'precision': 0.5042957514595433, 'recall': 0.572921618753193, 'f1-score': 0.5247597246099446, 'support': 157087}, 'weighted avg': {'precision': 0.7386575682989703, 'recall': 0.6733402509437445, 'f1-score': 0.6973774636160548, 'support': 157087}}
[[ 8645  7475  1890]
 [15970 87772 17070]
 [ 2432  6477  9356]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7562426
{'0': {'precision': 0.27278379818795523, 'recall': 0.6028661170003926, 'f1-score': 0.3756115459882583, 'support': 5094}, '1': {'precision': 0.885175326169115, 'recall': 0.7041645970039999, 'f1-score': 0.7843622597553873, 'support': 38251}, '2': {'precision': 0.35573985159319077, 'recall': 0.46883988494726747, 'f1-score': 0.40453342157511585, 'support': 5215}, 'accuracy': 0.6682660626029654, 'macro avg': {'precision': 0.5045663253167536, 'recall': 0.59195686631722, 'f1-score': 0.5215024091062538, 'support': 48560}, 'weighted avg': {'precision': 0.7640771292282281, 'recall': 0.6682660626029654, 'f1-score': 0.700692911999212, 'support': 48560}}
[[ 3071  1563   460]
 [ 7348 26935  3968]
 [  839  1931  2445]]
training model: results/QRTEA/W8/deepLOB_L1/h20
Epoch 1/50
614/614 - 12s - loss: 2.9822 - accuracy20: 0.4563 - val_loss: 2.8587 - val_accuracy20: 0.4635 - 12s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 2.8869 - accuracy20: 0.4892 - val_loss: 2.8936 - val_accuracy20: 0.5189 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 10s - loss: 2.8299 - accuracy20: 0.5025 - val_loss: 2.7286 - val_accuracy20: 0.5222 - 10s/epoch - 16ms/step
Epoch 4/50
614/614 - 10s - loss: 2.7756 - accuracy20: 0.5200 - val_loss: 2.8115 - val_accuracy20: 0.5217 - 10s/epoch - 16ms/step
Epoch 5/50
614/614 - 10s - loss: 2.7353 - accuracy20: 0.5390 - val_loss: 2.7851 - val_accuracy20: 0.5772 - 10s/epoch - 16ms/step
Epoch 6/50
614/614 - 10s - loss: 2.6809 - accuracy20: 0.5539 - val_loss: 2.8143 - val_accuracy20: 0.5961 - 10s/epoch - 16ms/step
Epoch 7/50
614/614 - 10s - loss: 2.6474 - accuracy20: 0.5667 - val_loss: 2.8161 - val_accuracy20: 0.6259 - 10s/epoch - 16ms/step
Epoch 8/50
614/614 - 10s - loss: 2.6113 - accuracy20: 0.5831 - val_loss: 2.7708 - val_accuracy20: 0.5961 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 2.5726 - accuracy20: 0.5964 - val_loss: 2.7283 - val_accuracy20: 0.6282 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 2.5429 - accuracy20: 0.6057 - val_loss: 2.7657 - val_accuracy20: 0.6326 - 10s/epoch - 17ms/step
Epoch 11/50
614/614 - 10s - loss: 2.5186 - accuracy20: 0.6108 - val_loss: 2.6810 - val_accuracy20: 0.6200 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 2.5003 - accuracy20: 0.6138 - val_loss: 2.7121 - val_accuracy20: 0.6409 - 10s/epoch - 16ms/step
Epoch 13/50
614/614 - 10s - loss: 2.4815 - accuracy20: 0.6222 - val_loss: 2.7380 - val_accuracy20: 0.6422 - 10s/epoch - 16ms/step
Epoch 14/50
614/614 - 10s - loss: 2.4656 - accuracy20: 0.6262 - val_loss: 2.7080 - val_accuracy20: 0.6204 - 10s/epoch - 16ms/step
Epoch 15/50
614/614 - 10s - loss: 2.4420 - accuracy20: 0.6299 - val_loss: 2.7826 - val_accuracy20: 0.6360 - 10s/epoch - 17ms/step
Epoch 16/50
614/614 - 10s - loss: 2.4212 - accuracy20: 0.6352 - val_loss: 2.7849 - val_accuracy20: 0.6134 - 10s/epoch - 16ms/step
Epoch 17/50
614/614 - 10s - loss: 2.4108 - accuracy20: 0.6342 - val_loss: 2.8376 - val_accuracy20: 0.5927 - 10s/epoch - 16ms/step
Epoch 18/50
614/614 - 10s - loss: 2.3937 - accuracy20: 0.6397 - val_loss: 2.7619 - val_accuracy20: 0.5978 - 10s/epoch - 16ms/step
Epoch 19/50
614/614 - 10s - loss: 2.3825 - accuracy20: 0.6402 - val_loss: 2.8949 - val_accuracy20: 0.5870 - 10s/epoch - 17ms/step
Epoch 20/50
614/614 - 10s - loss: 2.3714 - accuracy20: 0.6412 - val_loss: 2.8339 - val_accuracy20: 0.5939 - 10s/epoch - 17ms/step
Epoch 21/50
614/614 - 10s - loss: 2.3670 - accuracy20: 0.6418 - val_loss: 2.8331 - val_accuracy20: 0.5986 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h20
Evaluating performance on  test set...
2179/2179 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9378724
{'0': {'precision': 0.325475814687587, 'recall': 0.5083671693735499, 'f1-score': 0.39686421010924317, 'support': 68960}, '1': {'precision': 0.8572938128711671, 'recall': 0.5372484981688459, 'f1-score': 0.6605462018732007, 'support': 421319}, '2': {'precision': 0.25384598845397177, 'recall': 0.6996192648997792, 'f1-score': 0.37252651465849435, 'support': 67501}, 'accuracy': 0.553327476782961, 'macro avg': {'precision': 0.47887187200424197, 'recall': 0.581744977480725, 'f1-score': 0.4766456422136461, 'support': 557780}, 'weighted avg': {'precision': 0.7185159779708036, 'recall': 0.553327476782961, 'f1-score': 0.593091063541381, 'support': 557780}}
[[ 35057  22660  11243]
 [ 67396 226353 127570]
 [  5257  15019  47225]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8524838
{'0': {'precision': 0.35335579806473555, 'recall': 0.47239213093073235, 'f1-score': 0.4042940770740852, 'support': 24196}, '1': {'precision': 0.8335679141554488, 'recall': 0.6381242690193117, 'f1-score': 0.7228684394462583, 'support': 108587}, '2': {'precision': 0.35440847811981835, 'recall': 0.6068136932192232, 'f1-score': 0.4474718206229046, 'support': 24304}, 'accuracy': 0.6077523919866061, 'macro avg': {'precision': 0.5137773967800009, 'recall': 0.5724433643897557, 'f1-score': 0.5248781123810827, 'support': 157087}, 'weighted avg': {'precision': 0.6854671591958349, 'recall': 0.6077523919866061, 'f1-score': 0.6311901675597249, 'support': 157087}}
[[11430  7666  5100]
 [17530 69292 21765]
 [ 3387  6169 14748]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8404339
{'0': {'precision': 0.308055733504164, 'recall': 0.5696727380423515, 'f1-score': 0.39987526635829734, 'support': 6753}, '1': {'precision': 0.8381472999926128, 'recall': 0.6477691187805087, 'f1-score': 0.7307624184848241, 'support': 35031}, '2': {'precision': 0.3969771060235608, 'recall': 0.5271546635182999, 'f1-score': 0.4528971725624445, 'support': 6776}, 'accuracy': 0.6200782537067545, 'macro avg': {'precision': 0.5143933798401125, 'recall': 0.5815321734470533, 'f1-score': 0.5278449524685219, 'support': 48560}, 'weighted avg': {'precision': 0.7028697550414021, 'recall': 0.6200782537067545, 'f1-score': 0.6459746127871207, 'support': 48560}}
[[ 3847  2094   812]
 [ 7725 22692  4614]
 [  916  2288  3572]]
training model: results/QRTEA/W8/deepLOB_L1/h30
Epoch 1/50
614/614 - 13s - loss: 3.0285 - accuracy30: 0.4553 - val_loss: 3.1625 - val_accuracy30: 0.4520 - 13s/epoch - 21ms/step
Epoch 2/50
614/614 - 11s - loss: 2.9565 - accuracy30: 0.4606 - val_loss: 3.1042 - val_accuracy30: 0.4697 - 11s/epoch - 17ms/step
Epoch 3/50
614/614 - 10s - loss: 2.9062 - accuracy30: 0.4798 - val_loss: 2.8233 - val_accuracy30: 0.5152 - 10s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 2.8672 - accuracy30: 0.4986 - val_loss: 2.9639 - val_accuracy30: 0.4710 - 10s/epoch - 17ms/step
Epoch 5/50
614/614 - 10s - loss: 2.8421 - accuracy30: 0.5167 - val_loss: 2.9703 - val_accuracy30: 0.4543 - 10s/epoch - 17ms/step
Epoch 6/50
614/614 - 10s - loss: 2.8049 - accuracy30: 0.5274 - val_loss: 2.8254 - val_accuracy30: 0.5306 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 2.7740 - accuracy30: 0.5342 - val_loss: 2.8717 - val_accuracy30: 0.4992 - 10s/epoch - 17ms/step
Epoch 8/50
614/614 - 10s - loss: 2.7550 - accuracy30: 0.5422 - val_loss: 2.8812 - val_accuracy30: 0.4897 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 2.7276 - accuracy30: 0.5513 - val_loss: 2.8920 - val_accuracy30: 0.5336 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 2.7001 - accuracy30: 0.5604 - val_loss: 2.8745 - val_accuracy30: 0.5346 - 10s/epoch - 16ms/step
Epoch 11/50
614/614 - 10s - loss: 2.6723 - accuracy30: 0.5709 - val_loss: 2.9056 - val_accuracy30: 0.5574 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 2.6517 - accuracy30: 0.5769 - val_loss: 2.8814 - val_accuracy30: 0.5610 - 10s/epoch - 17ms/step
Epoch 13/50
614/614 - 10s - loss: 2.6307 - accuracy30: 0.5839 - val_loss: 2.9108 - val_accuracy30: 0.5471 - 10s/epoch - 17ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h30
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9229563
{'0': {'precision': 0.29878523535592527, 'recall': 0.4639528605300843, 'f1-score': 0.36348588165511786, 'support': 85194}, '1': {'precision': 0.7678094965962229, 'recall': 0.5101336617152826, 'f1-score': 0.6129935708813797, 'support': 389790}, '2': {'precision': 0.2913508774037018, 'recall': 0.5859461809749263, 'f1-score': 0.3891861537844451, 'support': 82796}, 'accuracy': 0.5143336082326365, 'macro avg': {'precision': 0.4526485364519499, 'recall': 0.5200109010734311, 'f1-score': 0.45522186877364756, 'support': 557780}, 'weighted avg': {'precision': 0.6254470584543571, 'recall': 0.5143336082326365, 'f1-score': 0.5416627290048335, 'support': 557780}}
[[ 39526  33802  11866]
 [ 84811 198845 106134]
 [  7952  26330  48514]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95214474
{'0': {'precision': 0.3052393157298683, 'recall': 0.5285557008188261, 'f1-score': 0.3869919518369712, 'support': 29066}, '1': {'precision': 0.7366027587665624, 'recall': 0.49315220909532287, 'f1-score': 0.5907799312947962, 'support': 98864}, '2': {'precision': 0.33009589074863804, 'recall': 0.45927221593442397, 'f1-score': 0.3841145086340428, 'support': 29157}, 'accuracy': 0.49341447732785015, 'macro avg': {'precision': 0.45731265508168956, 'recall': 0.49366004194952434, 'f1-score': 0.4539621305886034, 'support': 157087}, 'weighted avg': {'precision': 0.5813351008056671, 'recall': 0.49341447732785015, 'f1-score': 0.5147135149812838, 'support': 157087}}
[[15363  9239  4464]
 [27397 48755 22712]
 [ 7571  8195 13391]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9194716
{'0': {'precision': 0.2774865955780469, 'recall': 0.5703318474492323, 'f1-score': 0.37333333333333335, 'support': 8076}, '1': {'precision': 0.7610096912328149, 'recall': 0.5203735667611885, 'f1-score': 0.6180966153508209, 'support': 32444}, '2': {'precision': 0.3742839607201309, 'recall': 0.4550995024875622, 'f1-score': 0.41075437808711274, 'support': 8040}, 'accuracy': 0.5178747940691928, 'macro avg': {'precision': 0.47092674917699756, 'recall': 0.5152683055659943, 'f1-score': 0.46739477559042236, 'support': 48560}, 'weighted avg': {'precision': 0.6165655521506509, 'recall': 0.5178747940691928, 'f1-score': 0.5430607864139708, 'support': 48560}}
[[ 4606  2589   881]
 [10325 16883  5236]
 [ 1668  2713  3659]]
training model: results/QRTEA/W8/deepLOB_L1/h50
Epoch 1/50
614/614 - 13s - loss: 3.0957 - accuracy50: 0.4409 - val_loss: 3.0934 - val_accuracy50: 0.4929 - 13s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.0374 - accuracy50: 0.4601 - val_loss: 2.9436 - val_accuracy50: 0.5479 - 10s/epoch - 17ms/step
Epoch 3/50
614/614 - 10s - loss: 3.0096 - accuracy50: 0.4657 - val_loss: 2.9452 - val_accuracy50: 0.5306 - 10s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 2.9795 - accuracy50: 0.4815 - val_loss: 2.8894 - val_accuracy50: 0.5312 - 10s/epoch - 17ms/step
Epoch 5/50
614/614 - 10s - loss: 2.9356 - accuracy50: 0.4903 - val_loss: 2.9558 - val_accuracy50: 0.5561 - 10s/epoch - 17ms/step
Epoch 6/50
614/614 - 10s - loss: 2.9181 - accuracy50: 0.5011 - val_loss: 2.8864 - val_accuracy50: 0.5342 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 2.8872 - accuracy50: 0.5131 - val_loss: 2.9938 - val_accuracy50: 0.5637 - 10s/epoch - 17ms/step
Epoch 8/50
614/614 - 10s - loss: 2.8638 - accuracy50: 0.5174 - val_loss: 3.0092 - val_accuracy50: 0.5750 - 10s/epoch - 17ms/step
Epoch 9/50
614/614 - 10s - loss: 2.8475 - accuracy50: 0.5242 - val_loss: 2.9321 - val_accuracy50: 0.5463 - 10s/epoch - 17ms/step
Epoch 10/50
614/614 - 10s - loss: 2.8306 - accuracy50: 0.5286 - val_loss: 2.9650 - val_accuracy50: 0.5563 - 10s/epoch - 17ms/step
Epoch 11/50
614/614 - 10s - loss: 2.8125 - accuracy50: 0.5380 - val_loss: 3.0065 - val_accuracy50: 0.5517 - 10s/epoch - 17ms/step
Epoch 12/50
614/614 - 11s - loss: 2.7968 - accuracy50: 0.5416 - val_loss: 2.9134 - val_accuracy50: 0.5667 - 11s/epoch - 17ms/step
Epoch 13/50
614/614 - 10s - loss: 2.7775 - accuracy50: 0.5495 - val_loss: 2.9062 - val_accuracy50: 0.5683 - 10s/epoch - 16ms/step
Epoch 14/50
614/614 - 10s - loss: 2.7600 - accuracy50: 0.5540 - val_loss: 2.9043 - val_accuracy50: 0.5575 - 10s/epoch - 17ms/step
Epoch 15/50
614/614 - 10s - loss: 2.7431 - accuracy50: 0.5579 - val_loss: 2.9054 - val_accuracy50: 0.5763 - 10s/epoch - 16ms/step
Epoch 16/50
614/614 - 10s - loss: 2.7328 - accuracy50: 0.5596 - val_loss: 2.9518 - val_accuracy50: 0.5729 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h50
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94773936
{'0': {'precision': 0.41176061141815046, 'recall': 0.26306755014008093, 'f1-score': 0.32103240931686455, 'support': 112435}, '1': {'precision': 0.670935260602929, 'recall': 0.5860614968895224, 'f1-score': 0.6256329951547638, 'support': 336765}, '2': {'precision': 0.33919064776335756, 'recall': 0.5991066494750414, 'f1-score': 0.4331492227737771, 'support': 108580}, 'accuracy': 0.523493133493492, 'macro avg': {'precision': 0.473962173261479, 'recall': 0.4827452321682149, 'f1-score': 0.45993820908180183, 'support': 557780}, 'weighted avg': {'precision': 0.5541129798771746, 'recall': 0.523493133493492, 'f1-score': 0.5267630914762315, 'support': 557780}}
[[ 29578  59534  23323]
 [ 35991 197365 103409]
 [  6264  37265  65051]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97398823
{'0': {'precision': 0.403452224436999, 'recall': 0.2575048046991311, 'f1-score': 0.3143650242886884, 'support': 36943}, '1': {'precision': 0.6590408904215204, 'recall': 0.563116099126831, 'f1-score': 0.6073140170255642, 'support': 83489}, '2': {'precision': 0.37112158401827217, 'recall': 0.6294639203382895, 'f1-score': 0.46694189788112433, 'support': 36655}, 'accuracy': 0.5067255724534812, 'macro avg': {'precision': 0.4778715662922639, 'recall': 0.48336160805475054, 'f1-score': 0.462873646398459, 'support': 157087}, 'weighted avg': {'precision': 0.5317490440963806, 'recall': 0.5067255724534812, 'f1-score': 0.505664901147625, 'support': 157087}}
[[ 9513 13678 13752]
 [11129 47014 25346]
 [ 2937 10645 23073]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93231577
{'0': {'precision': 0.3708869216636045, 'recall': 0.4350935632409131, 'f1-score': 0.40043280284928545, 'support': 10207}, '1': {'precision': 0.6881173428292848, 'recall': 0.5741775733993633, 'f1-score': 0.6260051292928903, 'support': 28270}, '2': {'precision': 0.4052473647764869, 'recall': 0.5223643756818407, 'f1-score': 0.45641247833622184, 'support': 10083}, 'accuracy': 0.5341845140032949, 'macro avg': {'precision': 0.4880838764231254, 'recall': 0.510545170774039, 'f1-score': 0.49428347015946583, 'support': 48560}, 'weighted avg': {'precision': 0.5627024149556343, 'recall': 0.5341845140032949, 'f1-score': 0.5433770519533935, 'support': 48560}}
[[ 4441  3927  1839]
 [ 6147 16232  5891]
 [ 1386  3430  5267]]
training model: results/QRTEA/W8/deepLOB_L1/h100
Epoch 1/50
614/614 - 12s - loss: 3.1998 - accuracy100: 0.4187 - val_loss: 3.2630 - val_accuracy100: 0.4403 - 12s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.1521 - accuracy100: 0.4315 - val_loss: 3.1894 - val_accuracy100: 0.4457 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 10s - loss: 3.1271 - accuracy100: 0.4450 - val_loss: 3.3271 - val_accuracy100: 0.4468 - 10s/epoch - 16ms/step
Epoch 4/50
614/614 - 10s - loss: 3.1099 - accuracy100: 0.4506 - val_loss: 3.1941 - val_accuracy100: 0.4587 - 10s/epoch - 17ms/step
Epoch 5/50
614/614 - 10s - loss: 3.0861 - accuracy100: 0.4621 - val_loss: 3.2636 - val_accuracy100: 0.4460 - 10s/epoch - 16ms/step
Epoch 6/50
614/614 - 10s - loss: 3.0723 - accuracy100: 0.4686 - val_loss: 3.2624 - val_accuracy100: 0.4471 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 3.0560 - accuracy100: 0.4762 - val_loss: 3.2432 - val_accuracy100: 0.4523 - 10s/epoch - 17ms/step
Epoch 8/50
614/614 - 10s - loss: 3.0502 - accuracy100: 0.4765 - val_loss: 3.2893 - val_accuracy100: 0.4485 - 10s/epoch - 17ms/step
Epoch 9/50
614/614 - 10s - loss: 3.0355 - accuracy100: 0.4804 - val_loss: 3.2319 - val_accuracy100: 0.4592 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 3.0262 - accuracy100: 0.4832 - val_loss: 3.2249 - val_accuracy100: 0.4587 - 10s/epoch - 17ms/step
Epoch 11/50
614/614 - 10s - loss: 3.0150 - accuracy100: 0.4881 - val_loss: 3.2038 - val_accuracy100: 0.4582 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 3.0065 - accuracy100: 0.4904 - val_loss: 3.2450 - val_accuracy100: 0.4559 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h100
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0456756
{'0': {'precision': 0.35668041494813146, 'recall': 0.08968911461148754, 'f1-score': 0.14333572745217202, 'support': 159094}, '1': {'precision': 0.4547106822105111, 'recall': 0.725796271120606, 'f1-score': 0.5591281214495776, 'support': 247152}, '2': {'precision': 0.38718992845438766, 'recall': 0.31499201499333485, 'f1-score': 0.3473792993027961, 'support': 151534}, 'accuracy': 0.4327566424038151, 'macro avg': {'precision': 0.39952700853767675, 'recall': 0.37682580024180945, 'f1-score': 0.34994771606818187, 'support': 557780}, 'weighted avg': {'precision': 0.40840619434877096, 'recall': 0.4327566424038151, 'f1-score': 0.3830063150997378, 'support': 557780}}
[[ 14269 121940  22885]
 [ 15109 179382  52661]
 [ 10627  93175  47732]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0611242
{'0': {'precision': 0.4303779748016799, 'recall': 0.18979318859965016, 'f1-score': 0.26342020706890396, 'support': 48595}, '1': {'precision': 0.4290441049093996, 'recall': 0.8104252221004238, 'f1-score': 0.5610597316690548, 'support': 61121}, '2': {'precision': 0.4062360801781737, 'recall': 0.17327056638027485, 'f1-score': 0.24292648277494971, 'support': 47371}, 'accuracy': 0.4262924366752182, 'macro avg': {'precision': 0.4218860532964177, 'recall': 0.3911629923601163, 'f1-score': 0.3558021405043028, 'support': 157087}, 'weighted avg': {'precision': 0.42257877339165756, 'recall': 0.4262924366752182, 'f1-score': 0.37304873883510303, 'support': 157087}}
[[ 9223 34151  5221]
 [ 4811 49534  6776]
 [ 7396 31767  8208]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0413382
{'0': {'precision': 0.35361622631438483, 'recall': 0.09617478406039051, 'f1-score': 0.15122118237845242, 'support': 13777}, '1': {'precision': 0.45194098987966363, 'recall': 0.8424213984045049, 'f1-score': 0.5882815572158867, 'support': 21310}, '2': {'precision': 0.4498133961893538, 'recall': 0.16996956876716396, 'f1-score': 0.24671407024348202, 'support': 13473}, 'accuracy': 0.44413097199341023, 'macro avg': {'precision': 0.4184568707944674, 'recall': 0.3695219170773531, 'f1-score': 0.32873893661260706, 'support': 48560}, 'weighted avg': {'precision': 0.4234548832604629, 'recall': 0.44413097199341023, 'f1-score': 0.36951468044252306, 'support': 48560}}
[[ 1325 11448  1004]
 [ 1561 17952  1797]
 [  861 10322  2290]]
training model: results/QRTEA/W8/deepLOB_L1/h200
Epoch 1/50
614/614 - 12s - loss: 3.2723 - accuracy200: 0.3865 - val_loss: 3.3129 - val_accuracy200: 0.3803 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 10s - loss: 3.2346 - accuracy200: 0.3999 - val_loss: 3.3034 - val_accuracy200: 0.3879 - 10s/epoch - 17ms/step
Epoch 3/50
614/614 - 10s - loss: 3.2308 - accuracy200: 0.4033 - val_loss: 3.2930 - val_accuracy200: 0.3847 - 10s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 3.2094 - accuracy200: 0.4161 - val_loss: 3.3339 - val_accuracy200: 0.3876 - 10s/epoch - 16ms/step
Epoch 5/50
614/614 - 10s - loss: 3.1925 - accuracy200: 0.4267 - val_loss: 3.3126 - val_accuracy200: 0.4000 - 10s/epoch - 16ms/step
Epoch 6/50
614/614 - 10s - loss: 3.1817 - accuracy200: 0.4299 - val_loss: 3.3392 - val_accuracy200: 0.4030 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 3.1780 - accuracy200: 0.4311 - val_loss: 3.3396 - val_accuracy200: 0.3943 - 10s/epoch - 17ms/step
Epoch 8/50
614/614 - 10s - loss: 3.1715 - accuracy200: 0.4350 - val_loss: 3.3061 - val_accuracy200: 0.3992 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 3.1658 - accuracy200: 0.4365 - val_loss: 3.3458 - val_accuracy200: 0.3950 - 10s/epoch - 17ms/step
Epoch 10/50
614/614 - 10s - loss: 3.1561 - accuracy200: 0.4413 - val_loss: 3.4044 - val_accuracy200: 0.3908 - 10s/epoch - 16ms/step
Epoch 11/50
614/614 - 10s - loss: 3.1558 - accuracy200: 0.4395 - val_loss: 3.4169 - val_accuracy200: 0.3803 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 3.1467 - accuracy200: 0.4442 - val_loss: 3.4003 - val_accuracy200: 0.3848 - 10s/epoch - 17ms/step
Epoch 13/50
614/614 - 10s - loss: 3.1402 - accuracy200: 0.4454 - val_loss: 3.4114 - val_accuracy200: 0.3905 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h200
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072665
{'0': {'precision': 0.42771125712584995, 'recall': 0.09746096501066843, 'f1-score': 0.15874850233253743, 'support': 191687}, '1': {'precision': 0.3591736647631844, 'recall': 0.5747133850395859, 'f1-score': 0.44207040398882896, 'support': 186051}, '2': {'precision': 0.393879880407207, 'recall': 0.47342286799746724, 'f1-score': 0.43000380887037987, 'support': 180042}, 'accuracy': 0.37800566531607444, 'macro avg': {'precision': 0.3935882674320805, 'recall': 0.38186573934924056, 'f1-score': 0.34360757173058204, 'support': 557780}, 'weighted avg': {'precision': 0.39392991623186985, 'recall': 0.37800566531607444, 'f1-score': 0.3408089401839142, 'support': 557780}}
[[ 18682 106223  66782]
 [ 14742 106926  64383]
 [ 10255  84551  85236]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150184
{'0': {'precision': 0.38363590519415025, 'recall': 0.27883663819961146, 'f1-score': 0.32294695731539064, 'support': 54566}, '1': {'precision': 0.3314828950107557, 'recall': 0.5691986893059279, 'f1-score': 0.41897077203060934, 'support': 50355}, '2': {'precision': 0.4039921191175996, 'recall': 0.23977303224322355, 'f1-score': 0.3009371203098873, 'support': 52166}, 'accuracy': 0.3589412236531349, 'macro avg': {'precision': 0.37303697310750183, 'recall': 0.36260278658292094, 'f1-score': 0.34761828321862903, 'support': 157087}, 'weighted avg': {'precision': 0.3736779674128305, 'recall': 0.3589412236531349, 'f1-score': 0.34641875340772005, 'support': 157087}}
[[15215 29340 10011]
 [13251 28662  8442]
 [11194 28464 12508]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978979
{'0': {'precision': 0.3959672508288788, 'recall': 0.3598130841121495, 'f1-score': 0.37702541635795506, 'support': 16264}, '1': {'precision': 0.3612164416805703, 'recall': 0.5686485195797517, 'f1-score': 0.4417957517855487, 'support': 16752}, '2': {'precision': 0.44472938318261573, 'recall': 0.2119788986103963, 'f1-score': 0.28710843898401084, 'support': 15544}, 'accuracy': 0.38453459637561777, 'macro avg': {'precision': 0.40063769189735493, 'recall': 0.38014683410076583, 'f1-score': 0.3686432023758382, 'support': 48560}, 'weighted avg': {'precision': 0.39958778275750356, 'recall': 0.38453459637561777, 'f1-score': 0.37058726073156417, 'support': 48560}}
[[5852 8350 2062]
 [5174 9526 2052]
 [3753 8496 3295]]
training model: results/QRTEA/W8/deepLOB_L1/h300
Epoch 1/50
614/614 - 12s - loss: 3.3023 - accuracy300: 0.3739 - val_loss: 3.4211 - val_accuracy300: 0.3592 - 12s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.2666 - accuracy300: 0.3878 - val_loss: 3.3767 - val_accuracy300: 0.3882 - 10s/epoch - 17ms/step
Epoch 3/50
614/614 - 10s - loss: 3.2551 - accuracy300: 0.3960 - val_loss: 3.4187 - val_accuracy300: 0.3784 - 10s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 3.2521 - accuracy300: 0.3956 - val_loss: 3.3191 - val_accuracy300: 0.3827 - 10s/epoch - 16ms/step
Epoch 5/50
614/614 - 10s - loss: 3.2381 - accuracy300: 0.4034 - val_loss: 3.3307 - val_accuracy300: 0.3861 - 10s/epoch - 17ms/step
Epoch 6/50
614/614 - 10s - loss: 3.2217 - accuracy300: 0.4143 - val_loss: 3.3446 - val_accuracy300: 0.3892 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 3.2180 - accuracy300: 0.4168 - val_loss: 3.3654 - val_accuracy300: 0.3799 - 10s/epoch - 16ms/step
Epoch 8/50
614/614 - 10s - loss: 3.2083 - accuracy300: 0.4200 - val_loss: 3.3566 - val_accuracy300: 0.3791 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 3.2005 - accuracy300: 0.4241 - val_loss: 3.3874 - val_accuracy300: 0.3755 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 3.1958 - accuracy300: 0.4264 - val_loss: 3.3806 - val_accuracy300: 0.3671 - 10s/epoch - 16ms/step
Epoch 11/50
614/614 - 10s - loss: 3.1868 - accuracy300: 0.4301 - val_loss: 3.3695 - val_accuracy300: 0.3680 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 3.1821 - accuracy300: 0.4340 - val_loss: 3.3532 - val_accuracy300: 0.3758 - 10s/epoch - 16ms/step
Epoch 13/50
614/614 - 10s - loss: 3.1763 - accuracy300: 0.4357 - val_loss: 3.3906 - val_accuracy300: 0.3659 - 10s/epoch - 16ms/step
Epoch 14/50
614/614 - 10s - loss: 3.1718 - accuracy300: 0.4388 - val_loss: 3.3778 - val_accuracy300: 0.3658 - 10s/epoch - 17ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h300
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1293097
{'0': {'precision': 0.37491891891891893, 'recall': 0.1272820695657645, 'f1-score': 0.19004524886877827, 'support': 190726}, '1': {'precision': 0.3820594623947869, 'recall': 0.29286732644417385, 'f1-score': 0.33156998698108425, 'support': 192186}, '2': {'precision': 0.34198316508055887, 'recall': 0.676092824301759, 'f1-score': 0.454214354044927, 'support': 174868}, 'accuracy': 0.35639140879916814, 'macro avg': {'precision': 0.3663205154647549, 'recall': 0.3654140734372324, 'f1-score': 0.32527652996492984, 'support': 557780}, 'weighted avg': {'precision': 0.36705363706271543, 'recall': 0.3563914087991681, 'f1-score': 0.3216272281487711, 'support': 557780}}
[[ 24276  49239 117211]
 [ 25629  56285 110272]
 [ 14845  41796 118227]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1313385
{'0': {'precision': 0.35049177684617866, 'recall': 0.6524838661263695, 'f1-score': 0.45602349609272563, 'support': 53304}, '1': {'precision': 0.36451268434875467, 'recall': 0.24014146100315625, 'f1-score': 0.2895361232419793, 'support': 52594}, '2': {'precision': 0.3561147978970956, 'recall': 0.16144093457578776, 'f1-score': 0.22216546810941595, 'support': 51189}, 'accuracy': 0.35441506935647127, 'macro avg': {'precision': 0.3570397530306763, 'recall': 0.3513554205684379, 'f1-score': 0.3225750291480403, 'support': 157087}, 'weighted avg': {'precision': 0.3570184304442859, 'recall': 0.35441506935647127, 'f1-score': 0.3240762599614749, 'support': 157087}}
[[34780 11591  6933]
 [31955 12630  8009]
 [32497 10428  8264]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038418
{'0': {'precision': 0.36695479136869597, 'recall': 0.7260981912144703, 'f1-score': 0.48752478519497683, 'support': 16254}, '1': {'precision': 0.4178999295278365, 'recall': 0.2781588976839636, 'f1-score': 0.33400218256063646, 'support': 17055}, '2': {'precision': 0.4286563614744352, 'recall': 0.14182676545800274, 'f1-score': 0.21313494605114053, 'support': 15251}, 'accuracy': 0.3852759472817133, 'macro avg': {'precision': 0.4045036941236559, 'recall': 0.3820279514521456, 'f1-score': 0.3448873046022513, 'support': 48560}, 'weighted avg': {'precision': 0.404225795837122, 'recall': 0.3852759472817133, 'f1-score': 0.3474290804027338, 'support': 48560}}
[[11802  3210  1242]
 [10670  4744  1641]
 [ 9690  3398  2163]]
training model: results/QRTEA/W8/deepLOB_L1/h500
Epoch 1/50
614/614 - 13s - loss: 3.2740 - accuracy500: 0.4020 - val_loss: 3.3694 - val_accuracy500: 0.3551 - 13s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.2503 - accuracy500: 0.4094 - val_loss: 3.3286 - val_accuracy500: 0.3555 - 10s/epoch - 17ms/step
Epoch 3/50
614/614 - 10s - loss: 3.2404 - accuracy500: 0.4116 - val_loss: 3.4164 - val_accuracy500: 0.3597 - 10s/epoch - 17ms/step
Epoch 4/50
614/614 - 10s - loss: 3.2233 - accuracy500: 0.4204 - val_loss: 3.5044 - val_accuracy500: 0.3638 - 10s/epoch - 16ms/step
Epoch 5/50
614/614 - 10s - loss: 3.2198 - accuracy500: 0.4221 - val_loss: 3.4872 - val_accuracy500: 0.3627 - 10s/epoch - 17ms/step
Epoch 6/50
614/614 - 10s - loss: 3.2027 - accuracy500: 0.4294 - val_loss: 3.4352 - val_accuracy500: 0.3693 - 10s/epoch - 17ms/step
Epoch 7/50
614/614 - 10s - loss: 3.1964 - accuracy500: 0.4325 - val_loss: 3.5260 - val_accuracy500: 0.3645 - 10s/epoch - 16ms/step
Epoch 8/50
614/614 - 10s - loss: 3.1855 - accuracy500: 0.4376 - val_loss: 3.5932 - val_accuracy500: 0.3626 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 3.1739 - accuracy500: 0.4404 - val_loss: 3.5671 - val_accuracy500: 0.3636 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 3.1607 - accuracy500: 0.4491 - val_loss: 3.5511 - val_accuracy500: 0.3638 - 10s/epoch - 16ms/step
Epoch 11/50
614/614 - 10s - loss: 3.1547 - accuracy500: 0.4510 - val_loss: 3.5849 - val_accuracy500: 0.3654 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 10s - loss: 3.1411 - accuracy500: 0.4573 - val_loss: 3.6276 - val_accuracy500: 0.3648 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h500
Evaluating performance on  test set...
2179/2179 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.140019
{'0': {'precision': 0.3557939047948563, 'recall': 0.11614172301987304, 'f1-score': 0.17511929469781634, 'support': 212499}, '1': {'precision': 0.28350901586773136, 'recall': 0.3743422328528024, 'f1-score': 0.3226546981258758, 'support': 154690}, '2': {'precision': 0.35485619169279603, 'recall': 0.5290753498328882, 'f1-score': 0.4247968421540419, 'support': 190591}, 'accuracy': 0.3288464986195274, 'macro avg': {'precision': 0.3313863707851279, 'recall': 0.3398531019018545, 'f1-score': 0.3075236116592447, 'support': 557780}, 'weighted avg': {'precision': 0.3354266109765557, 'recall': 0.3288464986195274, 'f1-score': 0.3013492509592743, 'support': 557780}}
[[ 24680  78310 109509]
 [ 22966  57907  73817]
 [ 21720  68034 100837]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172125
{'0': {'precision': 0.34974064824217144, 'recall': 0.47422968145281336, 'f1-score': 0.4025809916441581, 'support': 53744}, '1': {'precision': 0.34265979453735845, 'recall': 0.18862425692889678, 'f1-score': 0.24331221291374652, 'support': 51812}, '2': {'precision': 0.330424477483301, 'recall': 0.35710543168190023, 'f1-score': 0.34324725105621, 'support': 51531}, 'accuracy': 0.34160688026380287, 'macro avg': {'precision': 0.34094164008761024, 'recall': 0.33998645668787014, 'f1-score': 0.3297134852047049, 'support': 157087}, 'weighted avg': {'precision': 0.3410686716462143, 'recall': 0.34160688026380287, 'f1-score': 0.33058546719071746, 'support': 157087}}
[[25487  9506 18751]
 [23500  9773 18539]
 [23887  9242 18402]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091508
{'0': {'precision': 0.36324862271192465, 'recall': 0.6074655254398479, 'f1-score': 0.4546364465401811, 'support': 16824}, '1': {'precision': 0.34532031436056204, 'recall': 0.1834050088540349, 'f1-score': 0.23957042544403137, 'support': 15812}, '2': {'precision': 0.35220753305063607, 'recall': 0.26601356443104746, 'f1-score': 0.3031018568208651, 'support': 15924}, 'accuracy': 0.35741350906095554, 'macro avg': {'precision': 0.3535921567077076, 'recall': 0.3522946995749767, 'f1-score': 0.3324362429350259, 'support': 48560}, 'weighted avg': {'precision': 0.35379020583758153, 'recall': 0.35741350906095554, 'f1-score': 0.33491526177365083, 'support': 48560}}
[[10220  2759  3845]
 [ 8966  2900  3946]
 [ 8949  2739  4236]]
training model: results/QRTEA/W8/deepLOB_L1/h1000
Epoch 1/50
614/614 - 12s - loss: 3.2400 - accuracy1000: 0.4220 - val_loss: 3.3469 - val_accuracy1000: 0.3745 - 12s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.2173 - accuracy1000: 0.4305 - val_loss: 3.4637 - val_accuracy1000: 0.3677 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 10s - loss: 3.1825 - accuracy1000: 0.4408 - val_loss: 3.5762 - val_accuracy1000: 0.3679 - 10s/epoch - 16ms/step
Epoch 4/50
614/614 - 10s - loss: 3.1679 - accuracy1000: 0.4467 - val_loss: 3.5516 - val_accuracy1000: 0.3683 - 10s/epoch - 17ms/step
Epoch 5/50
614/614 - 10s - loss: 3.1494 - accuracy1000: 0.4509 - val_loss: 3.5697 - val_accuracy1000: 0.3683 - 10s/epoch - 16ms/step
Epoch 6/50
614/614 - 10s - loss: 3.1544 - accuracy1000: 0.4486 - val_loss: 3.5393 - val_accuracy1000: 0.3672 - 10s/epoch - 16ms/step
Epoch 7/50
614/614 - 10s - loss: 3.1344 - accuracy1000: 0.4546 - val_loss: 3.5931 - val_accuracy1000: 0.3609 - 10s/epoch - 16ms/step
Epoch 8/50
614/614 - 10s - loss: 3.1212 - accuracy1000: 0.4626 - val_loss: 3.5918 - val_accuracy1000: 0.3638 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 10s - loss: 3.1154 - accuracy1000: 0.4670 - val_loss: 3.8338 - val_accuracy1000: 0.3662 - 10s/epoch - 16ms/step
Epoch 10/50
614/614 - 10s - loss: 3.1099 - accuracy1000: 0.4691 - val_loss: 3.7815 - val_accuracy1000: 0.3665 - 10s/epoch - 16ms/step
Epoch 11/50
614/614 - 10s - loss: 3.0924 - accuracy1000: 0.4756 - val_loss: 3.6732 - val_accuracy1000: 0.3606 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
2179/2179 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2044023
{'0': {'precision': 0.36057239153408926, 'recall': 0.05920867493386864, 'f1-score': 0.10171499014998611, 'support': 213212}, '1': {'precision': 0.30737833594976455, 'recall': 0.00632020658489348, 'f1-score': 0.012385741847740142, 'support': 154900}, '2': {'precision': 0.34295513333743916, 'recall': 0.9395048189467913, 'f1-score': 0.5024843074111881, 'support': 189668}, 'accuracy': 0.3438577933952454, 'macro avg': {'precision': 0.33696862027376434, 'recall': 0.3350112334885178, 'f1-score': 0.20552834646963813, 'support': 557780}, 'weighted avg': {'precision': 0.3398093858012661, 'recall': 0.3438577933952454, 'f1-score': 0.21318548802420131, 'support': 557780}}
[[ 12624   1313 199275]
 [ 11806    979 142115]
 [ 10581    893 178194]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1419204
{'0': {'precision': 0.31306242685928737, 'recall': 0.4403367704096112, 'f1-score': 0.3659491501438702, 'support': 52855}, '1': {'precision': 0.4014386673397274, 'recall': 0.1816952895929325, 'f1-score': 0.2501638398825596, 'support': 52522}, '2': {'precision': 0.38313097741300955, 'recall': 0.43693676271514215, 'f1-score': 0.40826873385012913, 'support': 51710}, 'accuracy': 0.35274083787964633, 'macro avg': {'precision': 0.3658773572040081, 'recall': 0.352989607572562, 'f1-score': 0.34146057462551965, 'support': 157087}, 'weighted avg': {'precision': 0.3656762119060872, 'recall': 0.35274083787964633, 'f1-score': 0.34116714786428054, 'support': 157087}}
[[23274  7492 22089]
 [28690  9543 14289]
 [22379  6737 22594]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1152495
{'0': {'precision': 0.35915935915935915, 'recall': 0.5686917804206456, 'f1-score': 0.4402666908563135, 'support': 17069}, '1': {'precision': 0.377326565143824, 'recall': 0.1869357750838277, 'f1-score': 0.2500107800439826, 'support': 15508}, '2': {'precision': 0.4096028880866426, 'recall': 0.35493962334980916, 'f1-score': 0.3803170985150672, 'support': 15983}, 'accuracy': 0.37642092257001647, 'macro avg': {'precision': 0.38202960412994197, 'recall': 0.3701890596180942, 'f1-score': 0.3568648564717878, 'support': 48560}, 'weighted avg': {'precision': 0.3815641357913989, 'recall': 0.37642092257001647, 'f1-score': 0.35977527818605465, 'support': 48560}}
[[9707 2802 4560]
 [8992 2899 3617]
 [8328 1982 5673]]
training model: results/QRTEA/W8/deepOF_L1/h10
Epoch 1/50
614/614 - 12s - loss: 2.9905 - accuracy10: 0.5039 - val_loss: 3.1198 - val_accuracy10: 0.6647 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 9s - loss: 2.8987 - accuracy10: 0.4958 - val_loss: 3.0179 - val_accuracy10: 0.6541 - 9s/epoch - 14ms/step
Epoch 3/50
614/614 - 9s - loss: 2.8646 - accuracy10: 0.5097 - val_loss: 3.0050 - val_accuracy10: 0.6639 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 2.8353 - accuracy10: 0.5050 - val_loss: 2.9697 - val_accuracy10: 0.6815 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 2.8079 - accuracy10: 0.5349 - val_loss: 2.8897 - val_accuracy10: 0.6709 - 9s/epoch - 14ms/step
Epoch 6/50
614/614 - 9s - loss: 2.7787 - accuracy10: 0.5501 - val_loss: 2.8946 - val_accuracy10: 0.6898 - 9s/epoch - 14ms/step
Epoch 7/50
614/614 - 9s - loss: 2.7692 - accuracy10: 0.5752 - val_loss: 2.9288 - val_accuracy10: 0.6917 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 2.7636 - accuracy10: 0.5518 - val_loss: 2.8190 - val_accuracy10: 0.6897 - 9s/epoch - 15ms/step
Epoch 9/50
614/614 - 9s - loss: 2.7375 - accuracy10: 0.5742 - val_loss: 2.8934 - val_accuracy10: 0.7001 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 2.7122 - accuracy10: 0.5795 - val_loss: 2.8445 - val_accuracy10: 0.7047 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 2.7075 - accuracy10: 0.5745 - val_loss: 2.8749 - val_accuracy10: 0.7158 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 2.6877 - accuracy10: 0.5910 - val_loss: 2.8658 - val_accuracy10: 0.7169 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 2.6754 - accuracy10: 0.5871 - val_loss: 2.8603 - val_accuracy10: 0.7234 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 2.6626 - accuracy10: 0.5943 - val_loss: 2.8523 - val_accuracy10: 0.7167 - 9s/epoch - 15ms/step
Epoch 15/50
614/614 - 9s - loss: 2.6433 - accuracy10: 0.5959 - val_loss: 2.8715 - val_accuracy10: 0.7267 - 9s/epoch - 15ms/step
Epoch 16/50
614/614 - 9s - loss: 2.6346 - accuracy10: 0.5963 - val_loss: 2.8326 - val_accuracy10: 0.7204 - 9s/epoch - 14ms/step
Epoch 17/50
614/614 - 9s - loss: 2.6147 - accuracy10: 0.6017 - val_loss: 2.8412 - val_accuracy10: 0.7246 - 9s/epoch - 14ms/step
Epoch 18/50
614/614 - 9s - loss: 2.6000 - accuracy10: 0.6035 - val_loss: 2.8196 - val_accuracy10: 0.7216 - 9s/epoch - 14ms/step
testing model: results/QRTEA/W8/deepOF_L1/h10
Evaluating performance on  test set...
2179/2179 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74983215
{'0': {'precision': 0.26949923491311545, 'recall': 0.5173947161914727, 'f1-score': 0.35439967473624, 'support': 49699}, '1': {'precision': 0.8869883887093387, 'recall': 0.7543647578474164, 'f1-score': 0.8153184858064957, 'support': 459132}, '2': {'precision': 0.2971660707578013, 'recall': 0.4364171297809742, 'f1-score': 0.3535750643503307, 'support': 48944}, 'accuracy': 0.7053507238581865, 'macro avg': {'precision': 0.4845512314600852, 'recall': 0.5693922012732878, 'f1-score': 0.5077644082976888, 'support': 557775}, 'weighted avg': {'precision': 0.7802126153520916, 'recall': 0.7053507238581865, 'f1-score': 0.7337322296796861, 'support': 557775}}
[[ 25714  20758   3227]
 [ 65487 346353  47292]
 [  4213  23371  21360]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7598551
{'0': {'precision': 0.31568025234498215, 'recall': 0.42326099053978855, 'f1-score': 0.3616394066184861, 'support': 17970}, '1': {'precision': 0.8303942355760114, 'recall': 0.7971339450452165, 'f1-score': 0.8134242353884796, 'support': 120863}, '2': {'precision': 0.37694483734087697, 'recall': 0.35044655087392473, 'f1-score': 0.36321303841676367, 'support': 18251}, 'accuracy': 0.70246492322579, 'macro avg': {'precision': 0.5076731084206235, 'recall': 0.5236138288196432, 'f1-score': 0.5127588934745765, 'support': 157084}, 'weighted avg': {'precision': 0.7188277154603343, 'recall': 0.70246492322579, 'f1-score': 0.7094328808970765, 'support': 157084}}
[[ 7606  9317  1047]
 [14994 96344  9525]
 [ 1494 10361  6396]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78299564
{'0': {'precision': 0.28460228654828507, 'recall': 0.46108374384236456, 'f1-score': 0.35195908851620666, 'support': 5075}, '1': {'precision': 0.8596413483411622, 'recall': 0.7608314812393777, 'f1-score': 0.8072239021277776, 'support': 38245}, '2': {'precision': 0.31437817845584837, 'recall': 0.3893129770992366, 'f1-score': 0.3478557421775087, 'support': 5240}, 'accuracy': 0.6894151565074135, 'macro avg': {'precision': 0.4862072711150986, 'recall': 0.5370760673936595, 'f1-score': 0.502346244273831, 'support': 48560}, 'weighted avg': {'precision': 0.7407059643049618, 'recall': 0.6894151565074135, 'f1-score': 0.7100748476134009, 'support': 48560}}
[[ 2340  2233   502]
 [ 5200 29098  3947]
 [  682  2518  2040]]
training model: results/QRTEA/W8/deepOF_L1/h20
Epoch 1/50
614/614 - 11s - loss: 3.0388 - accuracy20: 0.4879 - val_loss: 3.0199 - val_accuracy20: 0.6234 - 11s/epoch - 18ms/step
Epoch 2/50
614/614 - 9s - loss: 2.9502 - accuracy20: 0.4844 - val_loss: 2.9277 - val_accuracy20: 0.6173 - 9s/epoch - 15ms/step
Epoch 3/50
614/614 - 9s - loss: 2.8978 - accuracy20: 0.5112 - val_loss: 2.9409 - val_accuracy20: 0.6495 - 9s/epoch - 14ms/step
Epoch 4/50
614/614 - 9s - loss: 2.8663 - accuracy20: 0.5190 - val_loss: 2.8743 - val_accuracy20: 0.6564 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 2.8313 - accuracy20: 0.5506 - val_loss: 2.8915 - val_accuracy20: 0.6728 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 2.8051 - accuracy20: 0.5578 - val_loss: 2.9066 - val_accuracy20: 0.6763 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 2.7855 - accuracy20: 0.5561 - val_loss: 2.8915 - val_accuracy20: 0.6819 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 2.7728 - accuracy20: 0.5616 - val_loss: 2.9053 - val_accuracy20: 0.6716 - 9s/epoch - 14ms/step
Epoch 9/50
614/614 - 9s - loss: 2.7552 - accuracy20: 0.5637 - val_loss: 2.9033 - val_accuracy20: 0.6844 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 2.7417 - accuracy20: 0.5661 - val_loss: 2.9263 - val_accuracy20: 0.6835 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 2.7248 - accuracy20: 0.5714 - val_loss: 2.9105 - val_accuracy20: 0.6841 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 2.7110 - accuracy20: 0.5727 - val_loss: 2.9294 - val_accuracy20: 0.6850 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 2.6995 - accuracy20: 0.5768 - val_loss: 2.8999 - val_accuracy20: 0.6869 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 2.6912 - accuracy20: 0.5752 - val_loss: 2.9030 - val_accuracy20: 0.6895 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h20
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7867717
{'0': {'precision': 0.34268069329044937, 'recall': 0.4449874559508099, 'f1-score': 0.38718998618305245, 'support': 68957}, '1': {'precision': 0.8178844808480868, 'recall': 0.760306941550088, 'f1-score': 0.7880454035543484, 'support': 421318}, '2': {'precision': 0.352905070978021, 'recall': 0.4003407407407407, 'f1-score': 0.37512927474266516, 'support': 67500}, 'accuracy': 0.677762538658061, 'macro avg': {'precision': 0.504490081705519, 'recall': 0.5352117127472128, 'f1-score': 0.5167882214933553, 'support': 557775}, 'weighted avg': {'precision': 0.7028654539199503, 'recall': 0.677762538658061, 'f1-score': 0.6885184873059309, 'support': 557775}}
[[ 30685  35000   3272]
 [ 54709 320331  46278]
 [  4150  36327  27023]]
Evaluating performance on  train set...
614/614 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82243615
{'0': {'precision': 0.38003395265490897, 'recall': 0.3342596433015346, 'f1-score': 0.3556801129843764, 'support': 24110}, '1': {'precision': 0.7418080564944268, 'recall': 0.8139436438260358, 'f1-score': 0.7762034936528901, 'support': 108666}, '2': {'precision': 0.4301592069690598, 'recall': 0.29455323350337337, 'f1-score': 0.349669132908456, 'support': 24308}, 'accuracy': 0.6599462707850576, 'macro avg': {'precision': 0.5173337387061319, 'recall': 0.4809188402103146, 'f1-score': 0.4938509131819075, 'support': 157084}, 'weighted avg': {'precision': 0.6380550716084206, 'recall': 0.6599462707850576, 'f1-score': 0.6456554050576572, 'support': 157084}}
[[ 8059 14975  1076]
 [11809 88448  8409]
 [ 1338 15810  7160]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82440567
{'0': {'precision': 0.34447168107340986, 'recall': 0.39473684210526316, 'f1-score': 0.3678952807440578, 'support': 6764}, '1': {'precision': 0.7847002229261997, 'recall': 0.7645831547057647, 'f1-score': 0.7745110811945397, 'support': 34989}, '2': {'precision': 0.3631085305940152, 'recall': 0.35830762450418685, 'f1-score': 0.36069210292812776, 'support': 6807}, 'accuracy': 0.6561161449752883, 'macro avg': {'precision': 0.4974268115312082, 'recall': 0.5058758737717383, 'f1-score': 0.5010328216222418, 'support': 48560}, 'weighted avg': {'precision': 0.6642825848125784, 'recall': 0.6561161449752883, 'f1-score': 0.6598649720654927, 'support': 48560}}
[[ 2670  3590   504]
 [ 4463 26752  3774]
 [  618  3750  2439]]
training model: results/QRTEA/W8/deepOF_L1/h30
Epoch 1/50
614/614 - 11s - loss: 3.0882 - accuracy30: 0.4698 - val_loss: 3.0679 - val_accuracy30: 0.6134 - 11s/epoch - 18ms/step
Epoch 2/50
614/614 - 9s - loss: 2.9909 - accuracy30: 0.4837 - val_loss: 2.9611 - val_accuracy30: 0.6161 - 9s/epoch - 15ms/step
Epoch 3/50
614/614 - 9s - loss: 2.9511 - accuracy30: 0.4967 - val_loss: 2.9790 - val_accuracy30: 0.6314 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 2.9239 - accuracy30: 0.5041 - val_loss: 2.9199 - val_accuracy30: 0.6309 - 9s/epoch - 14ms/step
Epoch 5/50
614/614 - 9s - loss: 2.8914 - accuracy30: 0.5203 - val_loss: 2.9128 - val_accuracy30: 0.6332 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 2.8707 - accuracy30: 0.5251 - val_loss: 2.9128 - val_accuracy30: 0.6363 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 2.8496 - accuracy30: 0.5315 - val_loss: 2.9404 - val_accuracy30: 0.6448 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 2.8356 - accuracy30: 0.5389 - val_loss: 2.9110 - val_accuracy30: 0.6454 - 9s/epoch - 15ms/step
Epoch 9/50
614/614 - 9s - loss: 2.8187 - accuracy30: 0.5458 - val_loss: 2.9197 - val_accuracy30: 0.6454 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 2.8063 - accuracy30: 0.5467 - val_loss: 2.9173 - val_accuracy30: 0.6405 - 9s/epoch - 14ms/step
Epoch 11/50
614/614 - 9s - loss: 2.7952 - accuracy30: 0.5500 - val_loss: 2.9088 - val_accuracy30: 0.6492 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 2.7864 - accuracy30: 0.5508 - val_loss: 2.9180 - val_accuracy30: 0.6489 - 9s/epoch - 14ms/step
Epoch 13/50
614/614 - 9s - loss: 2.7756 - accuracy30: 0.5551 - val_loss: 2.9205 - val_accuracy30: 0.6523 - 9s/epoch - 14ms/step
Epoch 14/50
614/614 - 9s - loss: 2.7640 - accuracy30: 0.5543 - val_loss: 2.9225 - val_accuracy30: 0.6545 - 9s/epoch - 15ms/step
Epoch 15/50
614/614 - 9s - loss: 2.7571 - accuracy30: 0.5572 - val_loss: 2.9370 - val_accuracy30: 0.6546 - 9s/epoch - 14ms/step
Epoch 16/50
614/614 - 9s - loss: 2.7486 - accuracy30: 0.5591 - val_loss: 2.9210 - val_accuracy30: 0.6593 - 9s/epoch - 14ms/step
Epoch 17/50
614/614 - 9s - loss: 2.7397 - accuracy30: 0.5595 - val_loss: 2.9378 - val_accuracy30: 0.6557 - 9s/epoch - 15ms/step
Epoch 18/50
614/614 - 9s - loss: 2.7322 - accuracy30: 0.5605 - val_loss: 2.9373 - val_accuracy30: 0.6661 - 9s/epoch - 14ms/step
Epoch 19/50
614/614 - 9s - loss: 2.7195 - accuracy30: 0.5617 - val_loss: 2.9282 - val_accuracy30: 0.6613 - 9s/epoch - 14ms/step
Epoch 20/50
614/614 - 9s - loss: 2.7109 - accuracy30: 0.5637 - val_loss: 2.9374 - val_accuracy30: 0.6673 - 9s/epoch - 14ms/step
Epoch 21/50
614/614 - 9s - loss: 2.7036 - accuracy30: 0.5647 - val_loss: 2.9489 - val_accuracy30: 0.6642 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h30
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7940957
{'0': {'precision': 0.39370102840352594, 'recall': 0.4529703841955136, 'f1-score': 0.42126119635166775, 'support': 85191}, '1': {'precision': 0.7650698558064605, 'recall': 0.7882777605319802, 'f1-score': 0.7765004384623743, 'support': 389789}, '2': {'precision': 0.4613730953118013, 'recall': 0.32401715079413007, 'f1-score': 0.3806841160485593, 'support': 82795}, 'accuracy': 0.6681511362108377, 'macro avg': {'precision': 0.5400479931739293, 'recall': 0.5217550985072079, 'f1-score': 0.5261485836208671, 'support': 557775}, 'weighted avg': {'precision': 0.6632692102765627, 'recall': 0.6681511362108377, 'f1-score': 0.6634892803988093, 'support': 557775}}
[[ 38589  44096   2506]
 [ 53714 307262  28813]
 [  5713  50255  26827]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8560044
{'0': {'precision': 0.4235763004355329, 'recall': 0.35533572314904177, 'f1-score': 0.38646672914714153, 'support': 29012}, '1': {'precision': 0.6814676969808234, 'recall': 0.8257044923711591, 'f1-score': 0.7466843440693076, 'support': 98901}, '2': {'precision': 0.5422862453531598, 'recall': 0.24003290939631827, 'f1-score': 0.33277095264120904, 'support': 29171}, 'accuracy': 0.6300705355096636, 'macro avg': {'precision': 0.549110080923172, 'recall': 0.47369104163883974, 'f1-score': 0.48864067528588606, 'support': 157084}, 'weighted avg': {'precision': 0.6079910391289572, 'recall': 0.6300705355096636, 'f1-score': 0.6032903575049793, 'support': 157084}}
[[10309 17932   771]
 [12099 81663  5139]
 [ 1930 20239  7002]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8301518
{'0': {'precision': 0.40085731781996325, 'recall': 0.4049239143882222, 'f1-score': 0.4028803545051699, 'support': 8083}, '1': {'precision': 0.7324806289881495, 'recall': 0.793390724798667, 'f1-score': 0.7617199650437694, 'support': 32409}, '2': {'precision': 0.45775845775845775, 'recall': 0.3001983143282102, 'f1-score': 0.36260199116700353, 'support': 8068}, 'accuracy': 0.6467874794069193, 'macro avg': {'precision': 0.5303654681888569, 'recall': 0.4995043178383664, 'f1-score': 0.5090674369053143, 'support': 48560}, 'weighted avg': {'precision': 0.6316369366147228, 'recall': 0.6467874794069193, 'f1-score': 0.6356782767154899, 'support': 48560}}
[[ 3273  4420   390]
 [ 4217 25713  2479]
 [  675  4971  2422]]
training model: results/QRTEA/W8/deepOF_L1/h50
Epoch 1/50
614/614 - 12s - loss: 3.1651 - accuracy50: 0.4415 - val_loss: 3.0455 - val_accuracy50: 0.5451 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 10s - loss: 3.0800 - accuracy50: 0.4663 - val_loss: 3.0154 - val_accuracy50: 0.5585 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 10s - loss: 3.0399 - accuracy50: 0.4795 - val_loss: 3.0078 - val_accuracy50: 0.5672 - 10s/epoch - 16ms/step
Epoch 4/50
614/614 - 9s - loss: 3.0185 - accuracy50: 0.4872 - val_loss: 2.9896 - val_accuracy50: 0.5707 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 2.9953 - accuracy50: 0.4986 - val_loss: 2.9881 - val_accuracy50: 0.5816 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 2.9727 - accuracy50: 0.5091 - val_loss: 2.9894 - val_accuracy50: 0.5867 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 2.9577 - accuracy50: 0.5133 - val_loss: 2.9890 - val_accuracy50: 0.5880 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 2.9397 - accuracy50: 0.5166 - val_loss: 2.9814 - val_accuracy50: 0.5926 - 9s/epoch - 14ms/step
Epoch 9/50
614/614 - 9s - loss: 2.9263 - accuracy50: 0.5184 - val_loss: 3.0001 - val_accuracy50: 0.5915 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 2.9119 - accuracy50: 0.5200 - val_loss: 3.0086 - val_accuracy50: 0.5928 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 2.9024 - accuracy50: 0.5236 - val_loss: 3.0149 - val_accuracy50: 0.5963 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 2.8908 - accuracy50: 0.5237 - val_loss: 3.0446 - val_accuracy50: 0.5960 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 2.8820 - accuracy50: 0.5266 - val_loss: 3.0331 - val_accuracy50: 0.5995 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 2.8695 - accuracy50: 0.5306 - val_loss: 3.0401 - val_accuracy50: 0.6005 - 9s/epoch - 15ms/step
Epoch 15/50
614/614 - 9s - loss: 2.8605 - accuracy50: 0.5308 - val_loss: 3.0637 - val_accuracy50: 0.6028 - 9s/epoch - 15ms/step
Epoch 16/50
614/614 - 9s - loss: 2.8537 - accuracy50: 0.5332 - val_loss: 3.0517 - val_accuracy50: 0.6047 - 9s/epoch - 14ms/step
Epoch 17/50
614/614 - 9s - loss: 2.8450 - accuracy50: 0.5339 - val_loss: 3.0747 - val_accuracy50: 0.6041 - 9s/epoch - 15ms/step
Epoch 18/50
614/614 - 9s - loss: 2.8372 - accuracy50: 0.5346 - val_loss: 3.0776 - val_accuracy50: 0.6021 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h50
Evaluating performance on  test set...
2179/2179 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8852243
{'0': {'precision': 0.4623720361535326, 'recall': 0.3430695887291874, 'f1-score': 0.39388524104690226, 'support': 112432}, '1': {'precision': 0.6535517962903855, 'recall': 0.8208211091446829, 'f1-score': 0.7276980041304745, 'support': 336764}, '2': {'precision': 0.5095529008910853, 'recall': 0.24120686320559223, 'f1-score': 0.32742206692212, 'support': 108579}, 'accuracy': 0.6116893012415401, 'macro avg': {'precision': 0.5418255777783345, 'recall': 0.46836585369315414, 'f1-score': 0.48300177069983224, 'support': 557775}, 'weighted avg': {'precision': 0.5869837736015463, 'recall': 0.6116893012415401, 'f1-score': 0.5824910702141854, 'support': 557775}}
[[ 38572  70962   2898]
 [ 38031 276423  22310]
 [  6819  75570  26190]]
Evaluating performance on  train set...
614/614 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95161706
{'0': {'precision': 0.48327809581199155, 'recall': 0.26074941071283425, 'f1-score': 0.3387360751808246, 'support': 36909}, '1': {'precision': 0.5675684300382139, 'recall': 0.8520527929481652, 'f1-score': 0.6813060528722533, 'support': 83496}, '2': {'precision': 0.5722743804448955, 'recall': 0.18446522533329698, 'f1-score': 0.2789988041730238, 'support': 36679}, 'accuracy': 0.5572368923633215, 'macro avg': {'precision': 0.5410403020983671, 'recall': 0.43242247633143216, 'f1-score': 0.4330136440753673, 'support': 157084}, 'weighted avg': {'precision': 0.5488621175494246, 'recall': 0.5572368923633215, 'f1-score': 0.5068761753439756, 'support': 157084}}
[[ 9624 26360   925]
 [ 8221 71143  4132]
 [ 2069 27844  6766]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9133658
{'0': {'precision': 0.4658420825542931, 'recall': 0.31630859375, 'f1-score': 0.3767812481823998, 'support': 10240}, '1': {'precision': 0.6310263961605584, 'recall': 0.8201665780613149, 'f1-score': 0.7132707630187864, 'support': 28215}, '2': {'precision': 0.4988855116514691, 'recall': 0.24364176150420583, 'f1-score': 0.3273936170212766, 'support': 10105}, 'accuracy': 0.5939456342668863, 'macro avg': {'precision': 0.5319179967887736, 'recall': 0.4600389777718403, 'f1-score': 0.47248187607415426, 'support': 48560}, 'weighted avg': {'precision': 0.5686958564304821, 'recall': 0.5939456342668863, 'f1-score': 0.5620157961277354, 'support': 48560}}
[[ 3239  6576   425]
 [ 3026 23141  2048]
 [  688  6955  2462]]
training model: results/QRTEA/W8/deepOF_L1/h100
Epoch 1/50
614/614 - 12s - loss: 3.2551 - accuracy100: 0.4015 - val_loss: 3.2029 - val_accuracy100: 0.4516 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 9s - loss: 3.2009 - accuracy100: 0.4302 - val_loss: 3.1797 - val_accuracy100: 0.4581 - 9s/epoch - 15ms/step
Epoch 3/50
614/614 - 9s - loss: 3.1685 - accuracy100: 0.4402 - val_loss: 3.1787 - val_accuracy100: 0.4590 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 3.1476 - accuracy100: 0.4489 - val_loss: 3.1868 - val_accuracy100: 0.4606 - 9s/epoch - 14ms/step
Epoch 5/50
614/614 - 9s - loss: 3.1336 - accuracy100: 0.4532 - val_loss: 3.1780 - val_accuracy100: 0.4654 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 3.1212 - accuracy100: 0.4587 - val_loss: 3.1911 - val_accuracy100: 0.4671 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 3.1082 - accuracy100: 0.4624 - val_loss: 3.1940 - val_accuracy100: 0.4701 - 9s/epoch - 14ms/step
Epoch 8/50
614/614 - 9s - loss: 3.0969 - accuracy100: 0.4668 - val_loss: 3.1918 - val_accuracy100: 0.4750 - 9s/epoch - 14ms/step
Epoch 9/50
614/614 - 9s - loss: 3.0872 - accuracy100: 0.4686 - val_loss: 3.2027 - val_accuracy100: 0.4748 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 3.0784 - accuracy100: 0.4709 - val_loss: 3.2037 - val_accuracy100: 0.4773 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 10s - loss: 3.0696 - accuracy100: 0.4750 - val_loss: 3.2105 - val_accuracy100: 0.4790 - 10s/epoch - 16ms/step
Epoch 12/50
614/614 - 9s - loss: 3.0621 - accuracy100: 0.4764 - val_loss: 3.2181 - val_accuracy100: 0.4785 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 3.0534 - accuracy100: 0.4784 - val_loss: 3.2116 - val_accuracy100: 0.4815 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 3.0454 - accuracy100: 0.4821 - val_loss: 3.2116 - val_accuracy100: 0.4827 - 9s/epoch - 15ms/step
Epoch 15/50
614/614 - 9s - loss: 3.0387 - accuracy100: 0.4835 - val_loss: 3.2233 - val_accuracy100: 0.4829 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h100
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0312234
{'0': {'precision': 0.4968968896308932, 'recall': 0.1721153302198113, 'f1-score': 0.25567118120235105, 'support': 159091}, '1': {'precision': 0.4606406463334426, 'recall': 0.8586370275661438, 'f1-score': 0.5996055616931463, 'support': 247151}, '2': {'precision': 0.5449044737719758, 'recall': 0.15095061801719759, 'f1-score': 0.2364103332627086, 'support': 151533}, 'accuracy': 0.4705642956389225, 'macro avg': {'precision': 0.5008140032454372, 'recall': 0.39390099193438427, 'f1-score': 0.36389569205273525, 'support': 557775}, 'weighted avg': {'precision': 0.49387410528315884, 'recall': 0.4705642956389225, 'f1-score': 0.4028363858132474, 'support': 557775}}
[[ 27382 126963   4746]
 [ 20580 212213  14358]
 [  7144 121515  22874]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0827589
{'0': {'precision': 0.49110100932275214, 'recall': 0.13121436070568376, 'f1-score': 0.20709597764637078, 'support': 48577}, '1': {'precision': 0.39993618947274695, 'recall': 0.8818303775930895, 'f1-score': 0.5502965829155989, 'support': 61124}, '2': {'precision': 0.580859500589433, 'recall': 0.11438701644049554, 'f1-score': 0.1911344641534718, 'support': 47383}, 'accuracy': 0.4182157317104224, 'macro avg': {'precision': 0.49063223312831067, 'recall': 0.37581058491308966, 'f1-score': 0.31617567490514714, 'support': 157084}, 'weighted avg': {'precision': 0.4827021153754209, 'recall': 0.4182157317104224, 'f1-score': 0.3358263983298412, 'support': 157084}}
[[ 6374 40965  1238]
 [ 4550 53901  2673]
 [ 2055 39908  5420]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0379713
{'0': {'precision': 0.5003010234798314, 'recall': 0.18125636178566235, 'f1-score': 0.2661044991193895, 'support': 13754}, '1': {'precision': 0.45784960922680024, 'recall': 0.8490220908962994, 'f1-score': 0.5948930296756384, 'support': 21321}, '2': {'precision': 0.5217821782178218, 'recall': 0.15632183908045977, 'f1-score': 0.24057061340941513, 'support': 13485}, 'accuracy': 0.4675247116968699, 'macro avg': {'precision': 0.4933109369748178, 'recall': 0.3955334305874738, 'f1-score': 0.36718938073481433, 'support': 48560}, 'weighted avg': {'precision': 0.4876273572597516, 'recall': 0.4675247116968699, 'f1-score': 0.40337335849316996, 'support': 48560}}
[[ 2493 10717   544]
 [ 1831 18102  1388]
 [  659 10718  2108]]
training model: results/QRTEA/W8/deepOF_L1/h200
Epoch 1/50
614/614 - 12s - loss: 3.2950 - accuracy200: 0.3705 - val_loss: 3.2832 - val_accuracy200: 0.3737 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 10s - loss: 3.2614 - accuracy200: 0.3922 - val_loss: 3.2714 - val_accuracy200: 0.3798 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 10s - loss: 3.2430 - accuracy200: 0.4023 - val_loss: 3.2662 - val_accuracy200: 0.3809 - 10s/epoch - 16ms/step
Epoch 4/50
614/614 - 9s - loss: 3.2327 - accuracy200: 0.4105 - val_loss: 3.2632 - val_accuracy200: 0.3841 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 3.2235 - accuracy200: 0.4123 - val_loss: 3.2650 - val_accuracy200: 0.3832 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 3.2170 - accuracy200: 0.4156 - val_loss: 3.2652 - val_accuracy200: 0.3859 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 3.2108 - accuracy200: 0.4196 - val_loss: 3.2679 - val_accuracy200: 0.3834 - 9s/epoch - 14ms/step
Epoch 8/50
614/614 - 9s - loss: 3.2068 - accuracy200: 0.4197 - val_loss: 3.2690 - val_accuracy200: 0.3831 - 9s/epoch - 15ms/step
Epoch 9/50
614/614 - 9s - loss: 3.2007 - accuracy200: 0.4222 - val_loss: 3.2734 - val_accuracy200: 0.3831 - 9s/epoch - 15ms/step
Epoch 10/50
614/614 - 9s - loss: 3.1980 - accuracy200: 0.4230 - val_loss: 3.2725 - val_accuracy200: 0.3836 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 3.1937 - accuracy200: 0.4244 - val_loss: 3.2739 - val_accuracy200: 0.3829 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 3.1900 - accuracy200: 0.4268 - val_loss: 3.2762 - val_accuracy200: 0.3840 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 3.1852 - accuracy200: 0.4284 - val_loss: 3.2721 - val_accuracy200: 0.3866 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 3.1821 - accuracy200: 0.4290 - val_loss: 3.2833 - val_accuracy200: 0.3843 - 9s/epoch - 14ms/step
testing model: results/QRTEA/W8/deepOF_L1/h200
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951419
{'0': {'precision': 0.48412852969814996, 'recall': 0.18157061398246063, 'f1-score': 0.2640938184108388, 'support': 191683}, '1': {'precision': 0.34226018361224564, 'recall': 0.81434122901785, 'f1-score': 0.4819578733400877, 'support': 186051}, '2': {'precision': 0.5165112350450096, 'recall': 0.12397176198754728, 'f1-score': 0.1999516246069499, 'support': 180041}, 'accuracy': 0.3740450898659854, 'macro avg': {'precision': 0.4476333161184684, 'recall': 0.37329453499595266, 'f1-score': 0.31533443878595885, 'support': 557775}, 'weighted avg': {'precision': 0.4472596614192299, 'recall': 0.3740450898659854, 'f1-score': 0.31606029336757896, 'support': 557775}}
[[ 34804 148146   8733]
 [ 22382 151509  12160]
 [ 14704 143017  22320]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085911
{'0': {'precision': 0.4619592242665341, 'recall': 0.15336781862205592, 'f1-score': 0.23028299938029337, 'support': 54516}, '1': {'precision': 0.32686214198494523, 'recall': 0.8396164611994521, 'f1-score': 0.4705424243604222, 'support': 50373}, '2': {'precision': 0.5243457407986654, 'recall': 0.0963502251173484, 'f1-score': 0.16278768653092937, 'support': 52195}, 'accuracy': 0.35448549820478215, 'macro avg': {'precision': 0.4377223690167149, 'recall': 0.36311150164628553, 'f1-score': 0.287871036757215, 'support': 157084}, 'weighted avg': {'precision': 0.4393663370509305, 'recall': 0.35448549820478215, 'f1-score': 0.2849013574584648, 'support': 157084}}
[[ 8361 44110  2045]
 [ 5562 42294  2517]
 [ 4176 42990  5029]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901608
{'0': {'precision': 0.4865408415841584, 'recall': 0.19351464435146443, 'f1-score': 0.27689734108117625, 'support': 16252}, '1': {'precision': 0.354037103404659, 'recall': 0.8019937917860553, 'f1-score': 0.49122486288848255, 'support': 16752}, '2': {'precision': 0.48866923818707814, 'recall': 0.1303034199022885, 'f1-score': 0.2057450263905806, 'support': 15556}, 'accuracy': 0.38317545304777595, 'macro avg': {'precision': 0.4430823943919651, 'recall': 0.3752706186799361, 'f1-score': 0.3246224101200798, 'support': 48560}, 'weighted avg': {'precision': 0.4415121495654608, 'recall': 0.38317545304777595, 'f1-score': 0.32804168288490543, 'support': 48560}}
[[ 3145 12290   817]
 [ 2013 13435  1304]
 [ 1306 12223  2027]]
training model: results/QRTEA/W8/deepOF_L1/h300
Epoch 1/50
614/614 - 11s - loss: 3.3098 - accuracy300: 0.3556 - val_loss: 3.2911 - val_accuracy300: 0.3583 - 11s/epoch - 18ms/step
Epoch 2/50
614/614 - 9s - loss: 3.2832 - accuracy300: 0.3647 - val_loss: 3.2843 - val_accuracy300: 0.3593 - 9s/epoch - 15ms/step
Epoch 3/50
614/614 - 9s - loss: 3.2694 - accuracy300: 0.3740 - val_loss: 3.2774 - val_accuracy300: 0.3627 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 3.2629 - accuracy300: 0.3781 - val_loss: 3.2749 - val_accuracy300: 0.3608 - 9s/epoch - 14ms/step
Epoch 5/50
614/614 - 9s - loss: 3.2567 - accuracy300: 0.3824 - val_loss: 3.2728 - val_accuracy300: 0.3619 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 3.2519 - accuracy300: 0.3838 - val_loss: 3.2750 - val_accuracy300: 0.3609 - 9s/epoch - 14ms/step
Epoch 7/50
614/614 - 9s - loss: 3.2476 - accuracy300: 0.3864 - val_loss: 3.2731 - val_accuracy300: 0.3638 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 3.2450 - accuracy300: 0.3868 - val_loss: 3.2732 - val_accuracy300: 0.3649 - 9s/epoch - 15ms/step
Epoch 9/50
614/614 - 9s - loss: 3.2416 - accuracy300: 0.3906 - val_loss: 3.2728 - val_accuracy300: 0.3654 - 9s/epoch - 15ms/step
Epoch 10/50
614/614 - 9s - loss: 3.2398 - accuracy300: 0.3907 - val_loss: 3.2748 - val_accuracy300: 0.3654 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 3.2370 - accuracy300: 0.3929 - val_loss: 3.2747 - val_accuracy300: 0.3662 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 3.2357 - accuracy300: 0.3933 - val_loss: 3.2726 - val_accuracy300: 0.3663 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 3.2321 - accuracy300: 0.3958 - val_loss: 3.2739 - val_accuracy300: 0.3659 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 3.2299 - accuracy300: 0.3976 - val_loss: 3.2777 - val_accuracy300: 0.3657 - 9s/epoch - 14ms/step
Epoch 15/50
614/614 - 9s - loss: 3.2286 - accuracy300: 0.3981 - val_loss: 3.2776 - val_accuracy300: 0.3646 - 9s/epoch - 14ms/step
Epoch 16/50
614/614 - 9s - loss: 3.2262 - accuracy300: 0.3982 - val_loss: 3.2754 - val_accuracy300: 0.3653 - 9s/epoch - 15ms/step
Epoch 17/50
614/614 - 9s - loss: 3.2240 - accuracy300: 0.3995 - val_loss: 3.2771 - val_accuracy300: 0.3646 - 9s/epoch - 15ms/step
Epoch 18/50
614/614 - 9s - loss: 3.2202 - accuracy300: 0.4030 - val_loss: 3.2780 - val_accuracy300: 0.3654 - 9s/epoch - 15ms/step
Epoch 19/50
614/614 - 9s - loss: 3.2196 - accuracy300: 0.4034 - val_loss: 3.2778 - val_accuracy300: 0.3661 - 9s/epoch - 15ms/step
Epoch 20/50
614/614 - 9s - loss: 3.2165 - accuracy300: 0.4042 - val_loss: 3.2777 - val_accuracy300: 0.3670 - 9s/epoch - 15ms/step
Epoch 21/50
614/614 - 9s - loss: 3.2144 - accuracy300: 0.4066 - val_loss: 3.2813 - val_accuracy300: 0.3662 - 9s/epoch - 15ms/step
Epoch 22/50
614/614 - 9s - loss: 3.2127 - accuracy300: 0.4052 - val_loss: 3.2815 - val_accuracy300: 0.3659 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h300
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931319
{'0': {'precision': 0.4452434871298425, 'recall': 0.13504472478266796, 'f1-score': 0.20723420861008413, 'support': 190722}, '1': {'precision': 0.34296701133937896, 'recall': 0.8251277408344, 'f1-score': 0.4845353422238246, 'support': 192186}, '2': {'precision': 0.45405650078547277, 'recall': 0.09751982935602486, 'f1-score': 0.16055624599856888, 'support': 174867}, 'accuracy': 0.3610541885168751, 'macro avg': {'precision': 0.4140889997515648, 'recall': 0.35256409832436425, 'f1-score': 0.28410859894415924, 'support': 557775}, 'weighted avg': {'precision': 0.4127662310367101, 'recall': 0.3610541885168751, 'f1-score': 0.28814669191733616, 'support': 557775}}
[[ 25756 157259   7707]
 [ 20811 158578  12797]
 [ 11280 146534  17053]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991881
{'0': {'precision': 0.44235982308460553, 'recall': 0.11631091270585588, 'f1-score': 0.18419176617358757, 'support': 53314}, '1': {'precision': 0.3324917632251138, 'recall': 0.8543814923328641, 'f1-score': 0.47869443097208814, 'support': 52562}, '2': {'precision': 0.4865641794775653, 'recall': 0.07602327761287299, 'f1-score': 0.13150027867385025, 'support': 51208}, 'accuracy': 0.35014387206844744, 'macro avg': {'precision': 0.4204719219290949, 'recall': 0.34890522755053105, 'f1-score': 0.264795491939842, 'support': 157084}, 'weighted avg': {'precision': 0.42000701643234356, 'recall': 0.35014387206844744, 'f1-score': 0.26555857231076413, 'support': 157084}}
[[ 6201 45634  1479]
 [ 5025 44908  2629]
 [ 2792 44523  3893]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0905367
{'0': {'precision': 0.44702380952380955, 'recall': 0.13880845296038444, 'f1-score': 0.2118377133186028, 'support': 16231}, '1': {'precision': 0.3486042238276235, 'recall': 0.8111638259239735, 'f1-score': 0.48764084507042255, 'support': 17073}, '2': {'precision': 0.4323754284207751, 'recall': 0.10749868904037756, 'f1-score': 0.1721875164050606, 'support': 15256}, 'accuracy': 0.3653624382207578, 'macro avg': {'precision': 0.40933448725740273, 'recall': 0.35249032264157854, 'f1-score': 0.2905553582646953, 'support': 48560}, 'weighted avg': {'precision': 0.40781884064615553, 'recall': 0.3653624382207578, 'f1-score': 0.29634931678412624, 'support': 48560}}
[[ 2253 13273   705]
 [ 1776 13849  1448]
 [ 1011 12605  1640]]
training model: results/QRTEA/W8/deepOF_L1/h500
Epoch 1/50
614/614 - 12s - loss: 3.3191 - accuracy500: 0.3619 - val_loss: 3.2953 - val_accuracy500: 0.3522 - 12s/epoch - 19ms/step
Epoch 2/50
614/614 - 9s - loss: 3.2962 - accuracy500: 0.3661 - val_loss: 3.2870 - val_accuracy500: 0.3557 - 9s/epoch - 15ms/step
Epoch 3/50
614/614 - 9s - loss: 3.2887 - accuracy500: 0.3656 - val_loss: 3.2829 - val_accuracy500: 0.3662 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 3.2862 - accuracy500: 0.3645 - val_loss: 3.2800 - val_accuracy500: 0.3690 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 3.2828 - accuracy500: 0.3656 - val_loss: 3.2792 - val_accuracy500: 0.3738 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 3.2805 - accuracy500: 0.3661 - val_loss: 3.2787 - val_accuracy500: 0.3727 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 3.2796 - accuracy500: 0.3673 - val_loss: 3.2763 - val_accuracy500: 0.3766 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 9s - loss: 3.2785 - accuracy500: 0.3674 - val_loss: 3.2755 - val_accuracy500: 0.3762 - 9s/epoch - 15ms/step
Epoch 9/50
614/614 - 9s - loss: 3.2760 - accuracy500: 0.3683 - val_loss: 3.2746 - val_accuracy500: 0.3759 - 9s/epoch - 15ms/step
Epoch 10/50
614/614 - 9s - loss: 3.2748 - accuracy500: 0.3694 - val_loss: 3.2748 - val_accuracy500: 0.3758 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 3.2740 - accuracy500: 0.3695 - val_loss: 3.2744 - val_accuracy500: 0.3748 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 3.2728 - accuracy500: 0.3715 - val_loss: 3.2735 - val_accuracy500: 0.3779 - 9s/epoch - 15ms/step
Epoch 13/50
614/614 - 9s - loss: 3.2715 - accuracy500: 0.3717 - val_loss: 3.2734 - val_accuracy500: 0.3768 - 9s/epoch - 15ms/step
Epoch 14/50
614/614 - 9s - loss: 3.2701 - accuracy500: 0.3739 - val_loss: 3.2744 - val_accuracy500: 0.3768 - 9s/epoch - 15ms/step
Epoch 15/50
614/614 - 9s - loss: 3.2693 - accuracy500: 0.3729 - val_loss: 3.2733 - val_accuracy500: 0.3763 - 9s/epoch - 15ms/step
Epoch 16/50
614/614 - 9s - loss: 3.2673 - accuracy500: 0.3748 - val_loss: 3.2738 - val_accuracy500: 0.3765 - 9s/epoch - 15ms/step
Epoch 17/50
614/614 - 9s - loss: 3.2667 - accuracy500: 0.3740 - val_loss: 3.2743 - val_accuracy500: 0.3760 - 9s/epoch - 15ms/step
Epoch 18/50
614/614 - 9s - loss: 3.2658 - accuracy500: 0.3767 - val_loss: 3.2735 - val_accuracy500: 0.3754 - 9s/epoch - 14ms/step
Epoch 19/50
614/614 - 9s - loss: 3.2645 - accuracy500: 0.3771 - val_loss: 3.2746 - val_accuracy500: 0.3767 - 9s/epoch - 14ms/step
Epoch 20/50
614/614 - 9s - loss: 3.2629 - accuracy500: 0.3784 - val_loss: 3.2749 - val_accuracy500: 0.3760 - 9s/epoch - 14ms/step
Epoch 21/50
614/614 - 9s - loss: 3.2615 - accuracy500: 0.3784 - val_loss: 3.2743 - val_accuracy500: 0.3758 - 9s/epoch - 15ms/step
Epoch 22/50
614/614 - 9s - loss: 3.2611 - accuracy500: 0.3801 - val_loss: 3.2760 - val_accuracy500: 0.3751 - 9s/epoch - 14ms/step
Epoch 23/50
614/614 - 9s - loss: 3.2601 - accuracy500: 0.3809 - val_loss: 3.2761 - val_accuracy500: 0.3754 - 9s/epoch - 14ms/step
Epoch 24/50
614/614 - 9s - loss: 3.2588 - accuracy500: 0.3820 - val_loss: 3.2760 - val_accuracy500: 0.3740 - 9s/epoch - 14ms/step
Epoch 25/50
614/614 - 9s - loss: 3.2581 - accuracy500: 0.3832 - val_loss: 3.2785 - val_accuracy500: 0.3743 - 9s/epoch - 14ms/step
testing model: results/QRTEA/W8/deepOF_L1/h500
Evaluating performance on  test set...
2179/2179 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0874376
{'0': {'precision': 0.41336830296231164, 'recall': 0.6415791356072585, 'f1-score': 0.502789937784203, 'support': 212496}, '1': {'precision': 0.29747899159663865, 'recall': 0.03661540251730892, 'f1-score': 0.06520500319463073, 'support': 154689}, '2': {'precision': 0.3926576522675601, 'recall': 0.43043181698934885, 'f1-score': 0.4106779470107505, 'support': 190590}, 'accuracy': 0.4016547891174757, 'macro avg': {'precision': 0.36783498227550354, 'recall': 0.3695421183713054, 'f1-score': 0.3262242959965281, 'support': 557775}, 'weighted avg': {'precision': 0.3741516930358049, 'recall': 0.4016547891174757, 'f1-score': 0.3499591363530907, 'support': 557775}}
[[136333   6881  69282]
 [ 91418   5664  57607]
 [102059   6495  82036]]
Evaluating performance on  train set...
614/614 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905279
{'0': {'precision': 0.3715019473421698, 'recall': 0.6512082147441264, 'f1-score': 0.47310592750763575, 'support': 53757}, '1': {'precision': 0.37074430617515847, 'recall': 0.030481448592718428, 'f1-score': 0.05633149604894668, 'support': 51802}, '2': {'precision': 0.37351947298358196, 'recall': 0.4247646773410966, 'f1-score': 0.3974972529717851, 'support': 51525}, 'accuracy': 0.3722339639937868, 'macro avg': {'precision': 0.37192190883363674, 'recall': 0.36881811355931376, 'f1-score': 0.3089782255094558, 'support': 157084}, 'weighted avg': {'precision': 0.37191386504823937, 'recall': 0.3722339639937868, 'f1-score': 0.31086479503149106, 'support': 157084}}
[[35007  1341 17409]
 [30924  1579 19299]
 [28300  1339 21886]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908736
{'0': {'precision': 0.38056737090027065, 'recall': 0.6431032434359035, 'f1-score': 0.47816965173030623, 'support': 16834}, '1': {'precision': 0.34923245614035087, 'recall': 0.04026294165981923, 'f1-score': 0.07220175687163502, 'support': 15821}, '2': {'precision': 0.3722456121165728, 'recall': 0.42804149638478467, 'f1-score': 0.3981985143592443, 'support': 15905}, 'accuracy': 0.37625617792421745, 'macro avg': {'precision': 0.36734847971906476, 'recall': 0.3704692271601691, 'f1-score': 0.31618997432039514, 'support': 48560}, 'weighted avg': {'precision': 0.36763270739385784, 'recall': 0.37625617792421745, 'f1-score': 0.31971085839328445, 'support': 48560}}
[[10826   573  5435]
 [ 9138   637  6046]
 [ 8483   614  6808]]
training model: results/QRTEA/W8/deepOF_L1/h1000
Epoch 1/50
614/614 - 12s - loss: 3.3208 - accuracy1000: 0.3726 - val_loss: 3.3470 - val_accuracy1000: 0.3402 - 12s/epoch - 20ms/step
Epoch 2/50
614/614 - 10s - loss: 3.3032 - accuracy1000: 0.3749 - val_loss: 3.3363 - val_accuracy1000: 0.3430 - 10s/epoch - 16ms/step
Epoch 3/50
614/614 - 9s - loss: 3.3009 - accuracy1000: 0.3668 - val_loss: 3.3229 - val_accuracy1000: 0.3473 - 9s/epoch - 15ms/step
Epoch 4/50
614/614 - 9s - loss: 3.2992 - accuracy1000: 0.3647 - val_loss: 3.3040 - val_accuracy1000: 0.3600 - 9s/epoch - 15ms/step
Epoch 5/50
614/614 - 9s - loss: 3.2967 - accuracy1000: 0.3558 - val_loss: 3.3026 - val_accuracy1000: 0.3570 - 9s/epoch - 15ms/step
Epoch 6/50
614/614 - 9s - loss: 3.2940 - accuracy1000: 0.3554 - val_loss: 3.3044 - val_accuracy1000: 0.3599 - 9s/epoch - 15ms/step
Epoch 7/50
614/614 - 9s - loss: 3.2924 - accuracy1000: 0.3589 - val_loss: 3.3037 - val_accuracy1000: 0.3592 - 9s/epoch - 15ms/step
Epoch 8/50
614/614 - 10s - loss: 3.2905 - accuracy1000: 0.3600 - val_loss: 3.3043 - val_accuracy1000: 0.3588 - 10s/epoch - 16ms/step
Epoch 9/50
614/614 - 9s - loss: 3.2893 - accuracy1000: 0.3613 - val_loss: 3.3049 - val_accuracy1000: 0.3613 - 9s/epoch - 14ms/step
Epoch 10/50
614/614 - 9s - loss: 3.2872 - accuracy1000: 0.3631 - val_loss: 3.3054 - val_accuracy1000: 0.3558 - 9s/epoch - 15ms/step
Epoch 11/50
614/614 - 9s - loss: 3.2852 - accuracy1000: 0.3665 - val_loss: 3.3058 - val_accuracy1000: 0.3570 - 9s/epoch - 15ms/step
Epoch 12/50
614/614 - 9s - loss: 3.2840 - accuracy1000: 0.3680 - val_loss: 3.3068 - val_accuracy1000: 0.3574 - 9s/epoch - 14ms/step
Epoch 13/50
614/614 - 9s - loss: 3.2818 - accuracy1000: 0.3701 - val_loss: 3.3072 - val_accuracy1000: 0.3575 - 9s/epoch - 14ms/step
Epoch 14/50
614/614 - 9s - loss: 3.2803 - accuracy1000: 0.3700 - val_loss: 3.3060 - val_accuracy1000: 0.3590 - 9s/epoch - 14ms/step
Epoch 15/50
614/614 - 9s - loss: 3.2783 - accuracy1000: 0.3729 - val_loss: 3.3065 - val_accuracy1000: 0.3592 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W8/deepOF_L1/h1000
Evaluating performance on  test set...
2179/2179 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0899764
{'0': {'precision': 0.400337991451696, 'recall': 0.4955372846616732, 'f1-score': 0.44287950905741286, 'support': 213211}, '1': {'precision': 0.35374149659863946, 'recall': 0.0023499335046288524, 'f1-score': 0.004668851449716854, 'support': 154898}, '2': {'precision': 0.35798097215487273, 'recall': 0.5527031729461264, 'f1-score': 0.43452435233160625, 'support': 189666}, 'accuracy': 0.37801443234279053, 'macro avg': {'precision': 0.37068682006840276, 'recall': 0.35019679703747614, 'f1-score': 0.294024237612912, 'support': 557775}, 'weighted avg': {'precision': 0.37299472529294014, 'recall': 0.37801443234279053, 'f1-score': 0.3183442688661642, 'support': 557775}}
[[105654    349 107208]
 [ 73737    364  80797]
 [ 84521    316 104829]]
Evaluating performance on  train set...
614/614 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057895
{'0': {'precision': 0.35822135287576534, 'recall': 0.5059128493311384, 'f1-score': 0.41944592601888747, 'support': 52851}, '1': {'precision': 0.3821138211382114, 'recall': 0.0017903056851728406, 'f1-score': 0.0035639134803131696, 'support': 52505}, '2': {'precision': 0.3474336046327725, 'recall': 0.5520801113516858, 'f1-score': 0.4264775060668285, 'support': 51728}, 'accuracy': 0.3526138881108197, 'macro avg': {'precision': 0.3625895928822498, 'recall': 0.3532610887893323, 'f1-score': 0.2831624485220097, 'support': 157084}, 'weighted avg': {'precision': 0.36265493875979044, 'recall': 0.3526138881108197, 'f1-score': 0.2827537390640229, 'support': 157084}}
[[26738    65 26048]
 [24820    94 27591]
 [23083    87 28558]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011912
{'0': {'precision': 0.3685900255079602, 'recall': 0.49117974564847916, 'f1-score': 0.4211451973568503, 'support': 17063}, '1': {'precision': 0.3063063063063063, 'recall': 0.002191286414024233, 'f1-score': 0.004351443015294042, 'support': 15516}, '2': {'precision': 0.34883901831900743, 'recall': 0.5612289593892748, 'f1-score': 0.4302504077520867, 'support': 15981}, 'accuracy': 0.3579901153212521, 'macro avg': {'precision': 0.34124511671109126, 'recall': 0.35153333048392604, 'f1-score': 0.28524901604141034, 'support': 48560}, 'weighted avg': {'precision': 0.34218897458086966, 'recall': 0.3579901153212521, 'f1-score': 0.29096682987255634, 'support': 48560}}
[[8381   36 8646]
 [7386   34 8096]
 [6971   41 8969]]
training model: results/QRTEA/W8/deepLOB_L2/h10
Epoch 1/50
614/614 - 28s - loss: 3.1233 - accuracy10: 0.4508 - val_loss: 3.1650 - val_accuracy10: 0.4674 - 28s/epoch - 45ms/step
Epoch 2/50
614/614 - 25s - loss: 2.8582 - accuracy10: 0.4729 - val_loss: 2.8269 - val_accuracy10: 0.5772 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 2.7807 - accuracy10: 0.5121 - val_loss: 2.8101 - val_accuracy10: 0.4156 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 2.6984 - accuracy10: 0.5363 - val_loss: 2.7357 - val_accuracy10: 0.5153 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 2.6138 - accuracy10: 0.5683 - val_loss: 2.6717 - val_accuracy10: 0.5534 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 2.5415 - accuracy10: 0.5951 - val_loss: 2.6565 - val_accuracy10: 0.5936 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 2.4736 - accuracy10: 0.6242 - val_loss: 2.5591 - val_accuracy10: 0.6310 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 2.4007 - accuracy10: 0.6476 - val_loss: 2.5391 - val_accuracy10: 0.6671 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 2.3525 - accuracy10: 0.6600 - val_loss: 2.5468 - val_accuracy10: 0.6861 - 25s/epoch - 41ms/step
Epoch 10/50
614/614 - 25s - loss: 2.3043 - accuracy10: 0.6718 - val_loss: 2.5080 - val_accuracy10: 0.7028 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.2636 - accuracy10: 0.6794 - val_loss: 2.5222 - val_accuracy10: 0.6872 - 25s/epoch - 41ms/step
Epoch 12/50
614/614 - 25s - loss: 2.2346 - accuracy10: 0.6853 - val_loss: 2.5100 - val_accuracy10: 0.6823 - 25s/epoch - 41ms/step
Epoch 13/50
614/614 - 25s - loss: 2.2049 - accuracy10: 0.6916 - val_loss: 2.5114 - val_accuracy10: 0.6717 - 25s/epoch - 41ms/step
Epoch 14/50
614/614 - 25s - loss: 2.1821 - accuracy10: 0.6930 - val_loss: 2.5259 - val_accuracy10: 0.6931 - 25s/epoch - 40ms/step
Epoch 15/50
614/614 - 25s - loss: 2.1576 - accuracy10: 0.6956 - val_loss: 2.5513 - val_accuracy10: 0.6984 - 25s/epoch - 40ms/step
Epoch 16/50
614/614 - 25s - loss: 2.1400 - accuracy10: 0.6985 - val_loss: 2.5326 - val_accuracy10: 0.6842 - 25s/epoch - 41ms/step
Epoch 17/50
614/614 - 25s - loss: 2.1183 - accuracy10: 0.7016 - val_loss: 2.5610 - val_accuracy10: 0.6798 - 25s/epoch - 41ms/step
Epoch 18/50
614/614 - 25s - loss: 2.1019 - accuracy10: 0.7021 - val_loss: 2.5685 - val_accuracy10: 0.6554 - 25s/epoch - 41ms/step
Epoch 19/50
614/614 - 25s - loss: 2.0820 - accuracy10: 0.7056 - val_loss: 2.5923 - val_accuracy10: 0.6798 - 25s/epoch - 41ms/step
Epoch 20/50
614/614 - 25s - loss: 2.0663 - accuracy10: 0.7070 - val_loss: 2.6059 - val_accuracy10: 0.7026 - 25s/epoch - 41ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h10
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7870774
{'0': {'precision': 0.30695753065674447, 'recall': 0.6174724854630691, 'f1-score': 0.41006420406336225, 'support': 49701}, '1': {'precision': 0.9252158109950023, 'recall': 0.620944257981892, 'f1-score': 0.743140968077855, 'support': 459133}, '2': {'precision': 0.22939690769868104, 'recall': 0.7014260613737588, 'f1-score': 0.3457262547329413, 'support': 48946}, 'accuracy': 0.627697300010757, 'macro avg': {'precision': 0.4871900831168093, 'recall': 0.6466142682729067, 'f1-score': 0.4996438089580528, 'support': 557780}, 'weighted avg': {'precision': 0.8090667794201278, 'recall': 0.627697300010757, 'f1-score': 0.6785884405443033, 'support': 557780}}
[[ 30689  13013   5999]
 [ 64706 285096 109331]
 [  4583  10031  34332]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.710552
{'0': {'precision': 0.37820330006111225, 'recall': 0.5154358689616879, 'f1-score': 0.43628245799553517, 'support': 18010}, '1': {'precision': 0.8977627416888367, 'recall': 0.7094742244147932, 'f1-score': 0.7925894417576728, 'support': 120812}, '2': {'precision': 0.31585194777166287, 'recall': 0.6410073911853271, 'f1-score': 0.42318327218838664, 'support': 18265}, 'accuracy': 0.6792669030537218, 'macro avg': {'precision': 0.530605996507204, 'recall': 0.6219724948539361, 'f1-score': 0.5506850573138649, 'support': 157087}, 'weighted avg': {'precision': 0.7705347330400466, 'recall': 0.6792669030537218, 'f1-score': 0.7087868835272711, 'support': 157087}}
[[ 9283  5576  3151]
 [12890 85713 22209]
 [ 2372  4185 11708]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6990289
{'0': {'precision': 0.3153896961690885, 'recall': 0.5624263839811543, 'f1-score': 0.4041472704189589, 'support': 5094}, '1': {'precision': 0.8982285515804098, 'recall': 0.74366683223968, 'f1-score': 0.8136727688787185, 'support': 38251}, '2': {'precision': 0.35519405661585757, 'recall': 0.5317353787152445, 'f1-score': 0.4258946398402703, 'support': 5215}, 'accuracy': 0.7018945634266887, 'macro avg': {'precision': 0.522937434788452, 'recall': 0.6126095316453596, 'f1-score': 0.5479048930459826, 'support': 48560}, 'weighted avg': {'precision': 0.7787700256186014, 'recall': 0.7018945634266887, 'f1-score': 0.7290684477895603, 'support': 48560}}
[[ 2865  1579   650]
 [ 5421 28446  4384]
 [  798  1644  2773]]
training model: results/QRTEA/W8/deepLOB_L2/h20
Epoch 1/50
614/614 - 27s - loss: 3.1335 - accuracy20: 0.4444 - val_loss: 3.0998 - val_accuracy20: 0.6017 - 27s/epoch - 44ms/step
Epoch 2/50
614/614 - 25s - loss: 2.9130 - accuracy20: 0.4643 - val_loss: 2.8449 - val_accuracy20: 0.4960 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 2.8340 - accuracy20: 0.4982 - val_loss: 2.7898 - val_accuracy20: 0.5750 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 2.7866 - accuracy20: 0.5182 - val_loss: 2.8020 - val_accuracy20: 0.5244 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 2.7574 - accuracy20: 0.5304 - val_loss: 2.8572 - val_accuracy20: 0.5811 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 2.7266 - accuracy20: 0.5429 - val_loss: 2.7695 - val_accuracy20: 0.5412 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 2.6858 - accuracy20: 0.5536 - val_loss: 2.7556 - val_accuracy20: 0.5489 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 2.6489 - accuracy20: 0.5658 - val_loss: 3.0446 - val_accuracy20: 0.4937 - 25s/epoch - 40ms/step
Epoch 9/50
614/614 - 25s - loss: 2.6089 - accuracy20: 0.5807 - val_loss: 2.9458 - val_accuracy20: 0.4996 - 25s/epoch - 40ms/step
Epoch 10/50
614/614 - 25s - loss: 2.5520 - accuracy20: 0.5986 - val_loss: 3.3995 - val_accuracy20: 0.4540 - 25s/epoch - 40ms/step
Epoch 11/50
614/614 - 25s - loss: 2.5008 - accuracy20: 0.6162 - val_loss: 3.4520 - val_accuracy20: 0.4308 - 25s/epoch - 40ms/step
Epoch 12/50
614/614 - 25s - loss: 2.4605 - accuracy20: 0.6267 - val_loss: 3.4064 - val_accuracy20: 0.4264 - 25s/epoch - 41ms/step
Epoch 13/50
614/614 - 25s - loss: 2.4216 - accuracy20: 0.6375 - val_loss: 3.3284 - val_accuracy20: 0.4469 - 25s/epoch - 41ms/step
Epoch 14/50
614/614 - 25s - loss: 2.3928 - accuracy20: 0.6423 - val_loss: 3.1373 - val_accuracy20: 0.4702 - 25s/epoch - 41ms/step
Epoch 15/50
614/614 - 25s - loss: 2.3619 - accuracy20: 0.6480 - val_loss: 2.9160 - val_accuracy20: 0.5248 - 25s/epoch - 41ms/step
Epoch 16/50
614/614 - 25s - loss: 2.3279 - accuracy20: 0.6541 - val_loss: 2.9340 - val_accuracy20: 0.5176 - 25s/epoch - 41ms/step
Epoch 17/50
614/614 - 25s - loss: 2.3063 - accuracy20: 0.6578 - val_loss: 2.8663 - val_accuracy20: 0.5477 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h20
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9854056
{'0': {'precision': 0.28958331365306683, 'recall': 0.4445330626450116, 'f1-score': 0.35070558692133, 'support': 68960}, '1': {'precision': 0.8387977075225712, 'recall': 0.45888507283080043, 'f1-score': 0.5932293360662277, 'support': 421319}, '2': {'precision': 0.21540184619831276, 'recall': 0.7065969393046029, 'f1-score': 0.33015723586071316, 'support': 67501}, 'accuracy': 0.4870880992506006, 'macro avg': {'precision': 0.44792762245798357, 'recall': 0.5366716915934716, 'f1-score': 0.424697386282757, 'support': 557780}, 'weighted avg': {'precision': 0.6954550479856753, 'recall': 0.4870880992506006, 'f1-score': 0.5314091424827279, 'support': 557780}}
[[ 30655  24136  14169]
 [ 68419 193337 159563]
 [  6785  13020  47696]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.896248
{'0': {'precision': 0.31780511950219203, 'recall': 0.464374276739957, 'f1-score': 0.3773572232204329, 'support': 24196}, '1': {'precision': 0.8114769078140094, 'recall': 0.5724810520596388, 'f1-score': 0.6713428693309142, 'support': 108587}, '2': {'precision': 0.30332845809511144, 'recall': 0.5631994733377221, 'f1-score': 0.39429641365404, 'support': 24304}, 'accuracy': 0.5543934252993564, 'macro avg': {'precision': 0.4775368284704376, 'recall': 0.5333516007124394, 'f1-score': 0.4809988354017958, 'support': 157087}, 'weighted avg': {'precision': 0.6568178812111662, 'recall': 0.5543934252993564, 'f1-score': 0.5831967225965572, 'support': 157087}}
[[11236  8077  4883]
 [19868 62164 26555]
 [ 4251  6365 13688]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.906231
{'0': {'precision': 0.26365054602184085, 'recall': 0.5755960313934547, 'f1-score': 0.36164867882396723, 'support': 6753}, '1': {'precision': 0.832885847912697, 'recall': 0.5490280037680911, 'f1-score': 0.661803416891764, 'support': 35031}, '2': {'precision': 0.3264335664335664, 'recall': 0.5166765053128689, 'f1-score': 0.4000914233472373, 'support': 6776}, 'accuracy': 0.5482084019769358, 'macro avg': {'precision': 0.47432332012270145, 'recall': 0.5471001801581382, 'f1-score': 0.4745145063543228, 'support': 48560}, 'weighted avg': {'precision': 0.68305539789269, 'recall': 0.5482084019769358, 'f1-score': 0.5835434207132314, 'support': 48560}}
[[ 3887  1898   968]
 [ 9542 19233  6256]
 [ 1314  1961  3501]]
training model: results/QRTEA/W8/deepLOB_L2/h30
Epoch 1/50
614/614 - 27s - loss: 3.1291 - accuracy30: 0.4451 - val_loss: 3.1451 - val_accuracy30: 0.5507 - 27s/epoch - 44ms/step
Epoch 2/50
614/614 - 25s - loss: 2.9429 - accuracy30: 0.4764 - val_loss: 2.8522 - val_accuracy30: 0.5042 - 25s/epoch - 40ms/step
Epoch 3/50
614/614 - 25s - loss: 2.8899 - accuracy30: 0.4961 - val_loss: 2.8204 - val_accuracy30: 0.5355 - 25s/epoch - 40ms/step
Epoch 4/50
614/614 - 25s - loss: 2.8323 - accuracy30: 0.5256 - val_loss: 2.7961 - val_accuracy30: 0.5168 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 2.7887 - accuracy30: 0.5365 - val_loss: 2.8096 - val_accuracy30: 0.5247 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 2.7503 - accuracy30: 0.5492 - val_loss: 2.7990 - val_accuracy30: 0.5338 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 2.7089 - accuracy30: 0.5584 - val_loss: 2.8349 - val_accuracy30: 0.5097 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 2.6707 - accuracy30: 0.5709 - val_loss: 2.8622 - val_accuracy30: 0.4941 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 2.6311 - accuracy30: 0.5845 - val_loss: 2.9461 - val_accuracy30: 0.4539 - 25s/epoch - 41ms/step
Epoch 10/50
614/614 - 25s - loss: 2.5966 - accuracy30: 0.5931 - val_loss: 2.9505 - val_accuracy30: 0.4666 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.5633 - accuracy30: 0.6034 - val_loss: 3.0207 - val_accuracy30: 0.4662 - 25s/epoch - 40ms/step
Epoch 12/50
614/614 - 25s - loss: 2.5343 - accuracy30: 0.6103 - val_loss: 2.8697 - val_accuracy30: 0.5390 - 25s/epoch - 41ms/step
Epoch 13/50
614/614 - 25s - loss: 2.5011 - accuracy30: 0.6174 - val_loss: 2.8849 - val_accuracy30: 0.5281 - 25s/epoch - 41ms/step
Epoch 14/50
614/614 - 25s - loss: 2.4694 - accuracy30: 0.6245 - val_loss: 2.9286 - val_accuracy30: 0.5262 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h30
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99295723
{'0': {'precision': 0.31713384072767775, 'recall': 0.5013263844871705, 'f1-score': 0.38850406378343466, 'support': 85194}, '1': {'precision': 0.802570004031579, 'recall': 0.40346340337104597, 'f1-score': 0.5369795285645753, 'support': 389790}, '2': {'precision': 0.2565506797210678, 'recall': 0.7038504275568868, 'f1-score': 0.37603727076799975, 'support': 82796}, 'accuracy': 0.46299974900498403, 'macro avg': {'precision': 0.4587515081601081, 'recall': 0.5362134051383678, 'f1-score': 0.4338402877053366, 'support': 557780}, 'weighted avg': {'precision': 0.6473753673071972, 'recall': 0.46299974900498403, 'f1-score': 0.4904117170204365, 'support': 557780}}
[[ 42710  22293  20191]
 [ 83839 157266 148685]
 [  8126  16394  58276]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9493559
{'0': {'precision': 0.33424026789451655, 'recall': 0.43955136585701504, 'f1-score': 0.3797295289047407, 'support': 29066}, '1': {'precision': 0.7767063009081546, 'recall': 0.5034795274316233, 'f1-score': 0.6109358698987419, 'support': 98864}, '2': {'precision': 0.32915274659072236, 'recall': 0.6183763761703879, 'f1-score': 0.4296232754306955, 'support': 29157}, 'accuracy': 0.5129768854201812, 'macro avg': {'precision': 0.48003310513113123, 'recall': 0.5204690898196754, 'f1-score': 0.47342955807805936, 'support': 157087}, 'weighted avg': {'precision': 0.6117656202738069, 'recall': 0.5129768854201812, 'f1-score': 0.5345019522337762, 'support': 157087}}
[[12776  7438  8852]
 [21193 49776 27895]
 [ 4255  6872 18030]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94534904
{'0': {'precision': 0.292365605600317, 'recall': 0.5481674096087172, 'f1-score': 0.381342062193126, 'support': 8076}, '1': {'precision': 0.781396014112711, 'recall': 0.5051473307853532, 'f1-score': 0.6136133887453666, 'support': 32444}, '2': {'precision': 0.336628093860495, 'recall': 0.5210199004975125, 'f1-score': 0.4090021480179652, 'support': 8040}, 'accuracy': 0.5149299835255354, 'macro avg': {'precision': 0.4701299045245077, 'recall': 0.5247782136305276, 'f1-score': 0.4679858663188193, 'support': 48560}, 'weighted avg': {'precision': 0.6264260046816174, 'recall': 0.5149299835255354, 'f1-score': 0.5411072600657084, 'support': 48560}}
[[ 4427  2183  1466]
 [ 9266 16389  6789]
 [ 1449  2402  4189]]
training model: results/QRTEA/W8/deepLOB_L2/h50
Epoch 1/50
614/614 - 28s - loss: 3.1963 - accuracy50: 0.4296 - val_loss: 3.1357 - val_accuracy50: 0.5302 - 28s/epoch - 46ms/step
Epoch 2/50
614/614 - 25s - loss: 3.0619 - accuracy50: 0.4617 - val_loss: 3.0784 - val_accuracy50: 0.5124 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 2.9579 - accuracy50: 0.4942 - val_loss: 2.9508 - val_accuracy50: 0.5033 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 2.9077 - accuracy50: 0.5116 - val_loss: 2.9409 - val_accuracy50: 0.5367 - 25s/epoch - 40ms/step
Epoch 5/50
614/614 - 25s - loss: 2.8711 - accuracy50: 0.5248 - val_loss: 2.9463 - val_accuracy50: 0.5379 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 26s - loss: 2.8431 - accuracy50: 0.5341 - val_loss: 2.9457 - val_accuracy50: 0.5060 - 26s/epoch - 42ms/step
Epoch 7/50
614/614 - 25s - loss: 2.8171 - accuracy50: 0.5428 - val_loss: 2.9511 - val_accuracy50: 0.5105 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 2.7975 - accuracy50: 0.5463 - val_loss: 2.9702 - val_accuracy50: 0.4945 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 2.7714 - accuracy50: 0.5542 - val_loss: 3.0015 - val_accuracy50: 0.4898 - 25s/epoch - 41ms/step
Epoch 10/50
614/614 - 25s - loss: 2.7550 - accuracy50: 0.5552 - val_loss: 3.0021 - val_accuracy50: 0.4698 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.7305 - accuracy50: 0.5643 - val_loss: 3.1012 - val_accuracy50: 0.4607 - 25s/epoch - 41ms/step
Epoch 12/50
614/614 - 25s - loss: 2.7067 - accuracy50: 0.5693 - val_loss: 3.3144 - val_accuracy50: 0.4182 - 25s/epoch - 41ms/step
Epoch 13/50
614/614 - 25s - loss: 2.6868 - accuracy50: 0.5725 - val_loss: 3.3998 - val_accuracy50: 0.4078 - 25s/epoch - 41ms/step
Epoch 14/50
614/614 - 25s - loss: 2.6719 - accuracy50: 0.5785 - val_loss: 3.3697 - val_accuracy50: 0.4230 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h50
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9574865
{'0': {'precision': 0.3826863652154833, 'recall': 0.3722951038377729, 'f1-score': 0.3774192239548817, 'support': 112435}, '1': {'precision': 0.6869668274251651, 'recall': 0.5215268807625496, 'f1-score': 0.5929226842755576, 'support': 336765}, '2': {'precision': 0.3285962591122526, 'recall': 0.5832750046048996, 'f1-score': 0.4203707083948691, 'support': 108580}, 'accuracy': 0.5034655240417368, 'macro avg': {'precision': 0.4660831505843004, 'recall': 0.4923656630684074, 'f1-score': 0.4635708722084361, 'support': 557780}, 'weighted avg': {'precision': 0.5558691722995571, 'recall': 0.5034655240417368, 'f1-score': 0.5158926274390265, 'support': 557780}}
[[ 41859  45335  25241]
 [ 56971 175632 104162]
 [ 10552  34696  63332]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9557423
{'0': {'precision': 0.41371827271728384, 'recall': 0.4076821048642503, 'f1-score': 0.4106780100072259, 'support': 36943}, '1': {'precision': 0.6460338473648432, 'recall': 0.6488040340643677, 'f1-score': 0.6474159774346225, 'support': 83489}, '2': {'precision': 0.3840264958193072, 'recall': 0.3859227936161506, 'f1-score': 0.38497230953450085, 'support': 36655}, 'accuracy': 0.530756841750113, 'macro avg': {'precision': 0.4812595386338114, 'recall': 0.4808029775149229, 'f1-score': 0.4810220989921164, 'support': 157087}, 'weighted avg': {'precision': 0.5302616081273098, 'recall': 0.530756841750113, 'f1-score': 0.5305018892061295, 'support': 157087}}
[[15061 15655  6227]
 [12858 54168 16463]
 [ 8485 14024 14146]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94160944
{'0': {'precision': 0.3595352636833984, 'recall': 0.3880670128343294, 'f1-score': 0.37325669053901245, 'support': 10207}, '1': {'precision': 0.6617111315547378, 'recall': 0.6360806508666431, 'f1-score': 0.6486427991703491, 'support': 28270}, '2': {'precision': 0.3913966049382716, 'recall': 0.40245958544084104, 'f1-score': 0.3968510097305756, 'support': 10083}, 'accuracy': 0.5354406919275123, 'macro avg': {'precision': 0.47088100005880257, 'recall': 0.47553574971393786, 'f1-score': 0.4729168331466456, 'support': 48560}, 'weighted avg': {'precision': 0.5420675884073616, 'recall': 0.5354406919275123, 'f1-score': 0.5384763530475877, 'support': 48560}}
[[ 3961  4667  1579]
 [ 5557 17982  4731]
 [ 1499  4526  4058]]
training model: results/QRTEA/W8/deepLOB_L2/h100
Epoch 1/50
614/614 - 27s - loss: 3.2356 - accuracy100: 0.4069 - val_loss: 3.3917 - val_accuracy100: 0.4269 - 27s/epoch - 44ms/step
Epoch 2/50
614/614 - 25s - loss: 3.1445 - accuracy100: 0.4417 - val_loss: 3.3439 - val_accuracy100: 0.4373 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 3.0962 - accuracy100: 0.4574 - val_loss: 3.2311 - val_accuracy100: 0.4535 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 3.0518 - accuracy100: 0.4781 - val_loss: 3.1768 - val_accuracy100: 0.4707 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 3.0213 - accuracy100: 0.4855 - val_loss: 3.1618 - val_accuracy100: 0.4621 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 2.9916 - accuracy100: 0.4959 - val_loss: 3.2089 - val_accuracy100: 0.4516 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 2.9654 - accuracy100: 0.5019 - val_loss: 3.2071 - val_accuracy100: 0.4466 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 2.9367 - accuracy100: 0.5089 - val_loss: 3.2210 - val_accuracy100: 0.4379 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 2.9183 - accuracy100: 0.5136 - val_loss: 3.2775 - val_accuracy100: 0.4392 - 25s/epoch - 40ms/step
Epoch 10/50
614/614 - 25s - loss: 2.8969 - accuracy100: 0.5198 - val_loss: 3.3293 - val_accuracy100: 0.4420 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.8715 - accuracy100: 0.5255 - val_loss: 3.3882 - val_accuracy100: 0.4395 - 25s/epoch - 40ms/step
Epoch 12/50
614/614 - 25s - loss: 2.8494 - accuracy100: 0.5293 - val_loss: 3.4904 - val_accuracy100: 0.4245 - 25s/epoch - 40ms/step
Epoch 13/50
614/614 - 25s - loss: 2.8295 - accuracy100: 0.5338 - val_loss: 3.4903 - val_accuracy100: 0.4316 - 25s/epoch - 40ms/step
Epoch 14/50
614/614 - 25s - loss: 2.8033 - accuracy100: 0.5405 - val_loss: 3.5244 - val_accuracy100: 0.4335 - 25s/epoch - 41ms/step
Epoch 15/50
614/614 - 25s - loss: 2.7822 - accuracy100: 0.5437 - val_loss: 3.5493 - val_accuracy100: 0.4241 - 25s/epoch - 41ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h100
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0487678
{'0': {'precision': 0.44383872122151974, 'recall': 0.23386802770689027, 'f1-score': 0.30632625841827077, 'support': 159094}, '1': {'precision': 0.5006077192102003, 'recall': 0.516609212144753, 'f1-score': 0.5084826086610222, 'support': 247152}, '2': {'precision': 0.37643560014253213, 'recall': 0.543778953898135, 'f1-score': 0.4448913700760193, 'support': 151534}, 'accuracy': 0.44334504643407796, 'macro avg': {'precision': 0.4402940135247508, 'recall': 0.4314187312499261, 'f1-score': 0.4199000790517708, 'support': 557780}, 'weighted avg': {'precision': 0.4506813954682031, 'recall': 0.44334504643407796, 'f1-score': 0.43354607968318126, 'support': 557780}}
[[ 37207  73499  48388]
 [ 31362 127681  88109]
 [ 15261  53872  82401]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0432879
{'0': {'precision': 0.4501928195100755, 'recall': 0.3411256302088692, 'f1-score': 0.3881428755399979, 'support': 48595}, '1': {'precision': 0.48375717498985976, 'recall': 0.6439357994797206, 'f1-score': 0.5524705221785514, 'support': 61121}, '2': {'precision': 0.4432478280984938, 'recall': 0.3640412910852631, 'f1-score': 0.39975891604946856, 'support': 47371}, 'accuracy': 0.46585649990132855, 'macro avg': {'precision': 0.459065940866143, 'recall': 0.4497009069246176, 'f1-score': 0.44679077125600597, 'support': 157087}, 'weighted avg': {'precision': 0.4611580539541852, 'recall': 0.46585649990132855, 'f1-score': 0.45558406128528023, 'support': 157087}}
[[16577 22017 10001]
 [10103 39358 11660]
 [10142 19984 17245]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.04305
{'0': {'precision': 0.3904059530928177, 'recall': 0.42650794802932424, 'f1-score': 0.4076592202025808, 'support': 13777}, '1': {'precision': 0.5080626130732321, 'recall': 0.6061942749882684, 'f1-score': 0.5528072577884287, 'support': 21310}, '2': {'precision': 0.4636892242979092, 'recall': 0.2781860016328954, 'f1-score': 0.3477454073111895, 'support': 13473}, 'accuracy': 0.46420922570016476, 'macro avg': {'precision': 0.45405259682131965, 'recall': 0.4369627415501627, 'f1-score': 0.43607062843406635, 'support': 48560}, 'weighted avg': {'precision': 0.46237071703698635, 'recall': 0.46420922570016476, 'f1-score': 0.4547326526545722, 'support': 48560}}
[[ 5876  6250  1651]
 [ 5708 12918  2684]
 [ 3467  6258  3748]]
training model: results/QRTEA/W8/deepLOB_L2/h200
Epoch 1/50
614/614 - 27s - loss: 3.2897 - accuracy200: 0.3814 - val_loss: 3.3746 - val_accuracy200: 0.3654 - 27s/epoch - 44ms/step
Epoch 2/50
614/614 - 25s - loss: 3.2485 - accuracy200: 0.3932 - val_loss: 3.3002 - val_accuracy200: 0.3851 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 3.2131 - accuracy200: 0.4135 - val_loss: 3.2973 - val_accuracy200: 0.3886 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 3.1808 - accuracy200: 0.4297 - val_loss: 3.3246 - val_accuracy200: 0.3848 - 25s/epoch - 40ms/step
Epoch 5/50
614/614 - 25s - loss: 3.1506 - accuracy200: 0.4457 - val_loss: 3.3144 - val_accuracy200: 0.3921 - 25s/epoch - 40ms/step
Epoch 6/50
614/614 - 25s - loss: 3.1203 - accuracy200: 0.4567 - val_loss: 3.3144 - val_accuracy200: 0.3878 - 25s/epoch - 40ms/step
Epoch 7/50
614/614 - 25s - loss: 3.0903 - accuracy200: 0.4655 - val_loss: 3.3902 - val_accuracy200: 0.3866 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 3.0658 - accuracy200: 0.4749 - val_loss: 3.4195 - val_accuracy200: 0.3860 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 3.0373 - accuracy200: 0.4833 - val_loss: 3.4475 - val_accuracy200: 0.3821 - 25s/epoch - 40ms/step
Epoch 10/50
614/614 - 25s - loss: 3.0045 - accuracy200: 0.4935 - val_loss: 3.5102 - val_accuracy200: 0.3819 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.9913 - accuracy200: 0.4976 - val_loss: 3.5607 - val_accuracy200: 0.3732 - 25s/epoch - 40ms/step
Epoch 12/50
614/614 - 25s - loss: 2.9600 - accuracy200: 0.5086 - val_loss: 3.5444 - val_accuracy200: 0.3792 - 25s/epoch - 40ms/step
Epoch 13/50
614/614 - 25s - loss: 2.9368 - accuracy200: 0.5130 - val_loss: 3.5677 - val_accuracy200: 0.3764 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h200
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026852
{'0': {'precision': 0.3739977229233788, 'recall': 0.16108551962313564, 'f1-score': 0.22518222491239714, 'support': 191687}, '1': {'precision': 0.37821772258987363, 'recall': 0.36524393848998393, 'f1-score': 0.37161763097451606, 'support': 186051}, '2': {'precision': 0.36023129836338474, 'recall': 0.5913397984914631, 'f1-score': 0.44772083576013844, 'support': 180042}, 'accuracy': 0.36806267704112733, 'macro avg': {'precision': 0.3708155812922123, 'recall': 0.37255641886819424, 'f1-score': 0.3481735638823505, 'support': 557780}, 'weighted avg': {'precision': 0.3709617599044835, 'recall': 0.36806267704112733, 'f1-score': 0.3458583881084822, 'support': 557780}}
[[ 30878  61163  99646]
 [ 28660  67954  89437]
 [ 23024  50552 106466]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966371
{'0': {'precision': 0.3833425340071058, 'recall': 0.4963163874940439, 'f1-score': 0.43257489238337876, 'support': 54566}, '1': {'precision': 0.3937288107004908, 'recall': 0.46356866249627643, 'f1-score': 0.42580398022655547, 'support': 50355}, '2': {'precision': 0.38327256656723013, 'recall': 0.19949775715983592, 'f1-score': 0.262408754522876, 'support': 52166}, 'accuracy': 0.3872503771795247, 'macro avg': {'precision': 0.3867813037582755, 'recall': 0.38646093571671875, 'f1-score': 0.3735958757109367, 'support': 157087}, 'weighted avg': {'precision': 0.38664867036101697, 'recall': 0.3872503771795247, 'f1-score': 0.3738950778265547, 'support': 157087}}
[[27082 19075  8409]
 [18675 23343  8337]
 [24890 16869 10407]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977364
{'0': {'precision': 0.36751176054285833, 'recall': 0.5427939006394491, 'f1-score': 0.4382772744197592, 'support': 16264}, '1': {'precision': 0.4144638974711065, 'recall': 0.43242597898758356, 'f1-score': 0.4232544551562956, 'support': 16752}, '2': {'precision': 0.3901713638294859, 'recall': 0.17723880597014927, 'f1-score': 0.24375138243751382, 'support': 15544}, 'accuracy': 0.38770593080724874, 'macro avg': {'precision': 0.390715673947817, 'recall': 0.38415289519906065, 'f1-score': 0.3684277040045229, 'support': 48560}, 'weighted avg': {'precision': 0.39096240039684005, 'recall': 0.38770593080724874, 'f1-score': 0.3708272593193975, 'support': 48560}}
[[8828 5395 2041]
 [7243 7244 2265]
 [7950 4839 2755]]
training model: results/QRTEA/W8/deepLOB_L2/h300
Epoch 1/50
614/614 - 27s - loss: 3.3044 - accuracy300: 0.3700 - val_loss: 3.4050 - val_accuracy300: 0.3493 - 27s/epoch - 44ms/step
Epoch 2/50
614/614 - 25s - loss: 3.2663 - accuracy300: 0.3801 - val_loss: 3.3482 - val_accuracy300: 0.3606 - 25s/epoch - 41ms/step
Epoch 3/50
614/614 - 25s - loss: 3.2611 - accuracy300: 0.3846 - val_loss: 3.3242 - val_accuracy300: 0.3543 - 25s/epoch - 41ms/step
Epoch 4/50
614/614 - 25s - loss: 3.2412 - accuracy300: 0.3962 - val_loss: 3.3502 - val_accuracy300: 0.3651 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 3.2183 - accuracy300: 0.4115 - val_loss: 3.3281 - val_accuracy300: 0.3694 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 3.1912 - accuracy300: 0.4247 - val_loss: 3.3742 - val_accuracy300: 0.3702 - 25s/epoch - 40ms/step
Epoch 7/50
614/614 - 25s - loss: 3.1651 - accuracy300: 0.4368 - val_loss: 3.4135 - val_accuracy300: 0.3628 - 25s/epoch - 40ms/step
Epoch 8/50
614/614 - 25s - loss: 3.1369 - accuracy300: 0.4475 - val_loss: 3.4852 - val_accuracy300: 0.3634 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 3.1167 - accuracy300: 0.4547 - val_loss: 3.5219 - val_accuracy300: 0.3667 - 25s/epoch - 41ms/step
Epoch 10/50
614/614 - 25s - loss: 3.0926 - accuracy300: 0.4657 - val_loss: 3.5751 - val_accuracy300: 0.3644 - 25s/epoch - 40ms/step
Epoch 11/50
614/614 - 25s - loss: 3.0699 - accuracy300: 0.4723 - val_loss: 3.5791 - val_accuracy300: 0.3618 - 25s/epoch - 41ms/step
Epoch 12/50
614/614 - 25s - loss: 3.0475 - accuracy300: 0.4812 - val_loss: 3.5237 - val_accuracy300: 0.3552 - 25s/epoch - 40ms/step
Epoch 13/50
614/614 - 25s - loss: 3.0121 - accuracy300: 0.4900 - val_loss: 3.5949 - val_accuracy300: 0.3562 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h300
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123571
{'0': {'precision': 0.3148381144103338, 'recall': 0.07872025838113314, 'f1-score': 0.12594897950623704, 'support': 190726}, '1': {'precision': 0.3542315653787085, 'recall': 0.6348745486143632, 'f1-score': 0.4547390861165825, 'support': 192186}, '2': {'precision': 0.358743095173413, 'recall': 0.339822037193769, 'f1-score': 0.34902632204937845, 'support': 174868}, 'accuracy': 0.35220337767578613, 'macro avg': {'precision': 0.3426042583208184, 'recall': 0.3511389480630885, 'f1-score': 0.30990479589073266, 'support': 557780}, 'weighted avg': {'precision': 0.34217585678884543, 'recall': 0.35220337767578613, 'f1-score': 0.3091716554086536, 'support': 557780}}
[[ 15014 119880  55832]
 [ 19783 122014  50389]
 [ 12891 102553  59424]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10782
{'0': {'precision': 0.3579433551198257, 'recall': 0.38528065435989794, 'f1-score': 0.37110924384933003, 'support': 53304}, '1': {'precision': 0.349361946913044, 'recall': 0.5658249990493213, 'f1-score': 0.43199419343131923, 'support': 52594}, '2': {'precision': 0.37602367352556604, 'recall': 0.1067416827834105, 'f1-score': 0.16628119293974436, 'support': 51189}, 'accuracy': 0.35496253668349387, 'macro avg': {'precision': 0.36110965851947857, 'recall': 0.3526157787308766, 'f1-score': 0.32312821007346454, 'support': 157087}, 'weighted avg': {'precision': 0.36096195523087227, 'recall': 0.35496253668349387, 'f1-score': 0.324747927765277, 'support': 157087}}
[[20537 28130  4637]
 [18405 29759  4430]
 [18433 27292  5464]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061788
{'0': {'precision': 0.35811378577430675, 'recall': 0.44573643410852715, 'f1-score': 0.3971495134986981, 'support': 16254}, '1': {'precision': 0.3496336412870341, 'recall': 0.514805042509528, 'f1-score': 0.41643939573600214, 'support': 17055}, '2': {'precision': 0.3904258626049114, 'recall': 0.08235525539308898, 'f1-score': 0.1360190599956682, 'support': 15251}, 'accuracy': 0.35586902800658976, 'macro avg': {'precision': 0.3660577632220841, 'recall': 0.34763224400371473, 'f1-score': 0.31653598974345615, 'support': 48560}, 'weighted avg': {'precision': 0.3652835267033248, 'recall': 0.35586902800658976, 'f1-score': 0.32191245409141866, 'support': 48560}}
[[7245 8054  955]
 [7269 8780 1006]
 [5717 8278 1256]]
training model: results/QRTEA/W8/deepLOB_L2/h500
Epoch 1/50
614/614 - 28s - loss: 3.2961 - accuracy500: 0.3879 - val_loss: 3.3657 - val_accuracy500: 0.3472 - 28s/epoch - 46ms/step
Epoch 2/50
614/614 - 26s - loss: 3.2717 - accuracy500: 0.3917 - val_loss: 3.4613 - val_accuracy500: 0.3565 - 26s/epoch - 42ms/step
Epoch 3/50
614/614 - 26s - loss: 3.2529 - accuracy500: 0.3941 - val_loss: 3.5088 - val_accuracy500: 0.3601 - 26s/epoch - 42ms/step
Epoch 4/50
614/614 - 25s - loss: 3.2154 - accuracy500: 0.4181 - val_loss: 3.5158 - val_accuracy500: 0.3577 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 3.1969 - accuracy500: 0.4325 - val_loss: 3.5349 - val_accuracy500: 0.3587 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 3.1875 - accuracy500: 0.4373 - val_loss: 3.6085 - val_accuracy500: 0.3548 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 3.1641 - accuracy500: 0.4466 - val_loss: 3.5829 - val_accuracy500: 0.3544 - 25s/epoch - 41ms/step
Epoch 8/50
614/614 - 25s - loss: 3.1345 - accuracy500: 0.4571 - val_loss: 3.7415 - val_accuracy500: 0.3576 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 3.1103 - accuracy500: 0.4667 - val_loss: 3.8659 - val_accuracy500: 0.3473 - 25s/epoch - 40ms/step
Epoch 10/50
614/614 - 25s - loss: 3.0899 - accuracy500: 0.4726 - val_loss: 3.7762 - val_accuracy500: 0.3514 - 25s/epoch - 40ms/step
Epoch 11/50
614/614 - 25s - loss: 3.0650 - accuracy500: 0.4781 - val_loss: 3.9703 - val_accuracy500: 0.3547 - 25s/epoch - 40ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h500
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198224
{'0': {'precision': 0.38514422191592773, 'recall': 0.3247968225732827, 'f1-score': 0.35240565531960516, 'support': 212499}, '1': {'precision': 0.27780259044216166, 'recall': 0.23723576184627318, 'f1-score': 0.25592155960263746, 'support': 154690}, '2': {'precision': 0.3548459079180123, 'recall': 0.4588936518513466, 'f1-score': 0.4002178155751865, 'support': 190591}, 'accuracy': 0.34633367994549824, 'macro avg': {'precision': 0.3392642400920339, 'recall': 0.34030874542363415, 'f1-score': 0.33618167683247635, 'support': 557780}, 'weighted avg': {'precision': 0.3450221972182807, 'recall': 0.34633367994549824, 'f1-score': 0.3419847773189844, 'support': 557780}}
[[69019 51698 91782]
 [50759 36698 67233]
 [59425 43705 87461]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1206281
{'0': {'precision': 0.3489196945903504, 'recall': 0.4795698124441798, 'f1-score': 0.40394320283358937, 'support': 53744}, '1': {'precision': 0.33651764841698173, 'recall': 0.2250443912607118, 'f1-score': 0.26971698222319895, 'support': 51812}, '2': {'precision': 0.33975705167799053, 'recall': 0.32023442199840874, 'f1-score': 0.3297069959341066, 'support': 51531}, 'accuracy': 0.34335113663129346, 'macro avg': {'precision': 0.34173146489510753, 'recall': 0.34161620856776675, 'f1-score': 0.33445572699696496, 'support': 157087}, 'weighted avg': {'precision': 0.3418234042018944, 'recall': 0.34335113663129346, 'f1-score': 0.33531884231997083, 'support': 157087}}
[[25774 11677 16293]
 [24377 11660 15775]
 [23717 11312 16502]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200798
{'0': {'precision': 0.35051546391752575, 'recall': 0.5779838326200666, 'f1-score': 0.43638648296907956, 'support': 16824}, '1': {'precision': 0.31274442144007364, 'recall': 0.17195800657728308, 'f1-score': 0.22190483963111074, 'support': 15812}, '2': {'precision': 0.3549158693500495, 'recall': 0.27022104998744034, 'f1-score': 0.3068311466058186, 'support': 15924}, 'accuracy': 0.34485172981878087, 'macro avg': {'precision': 0.33939191823588294, 'recall': 0.34005429639493, 'f1-score': 0.3217074897353363, 'support': 48560}, 'weighted avg': {'precision': 0.3396595399565298, 'recall': 0.34485172981878087, 'f1-score': 0.32406311145531247, 'support': 48560}}
[[9724 3083 4017]
 [9289 2719 3804]
 [8729 2892 4303]]
training model: results/QRTEA/W8/deepLOB_L2/h1000
Epoch 1/50
614/614 - 27s - loss: 3.2304 - accuracy1000: 0.4225 - val_loss: 3.5055 - val_accuracy1000: 0.3575 - 27s/epoch - 45ms/step
Epoch 2/50
614/614 - 25s - loss: 3.2020 - accuracy1000: 0.4417 - val_loss: 3.5516 - val_accuracy1000: 0.3666 - 25s/epoch - 40ms/step
Epoch 3/50
614/614 - 25s - loss: 3.1653 - accuracy1000: 0.4510 - val_loss: 3.4603 - val_accuracy1000: 0.3570 - 25s/epoch - 40ms/step
Epoch 4/50
614/614 - 25s - loss: 3.1544 - accuracy1000: 0.4487 - val_loss: 3.5712 - val_accuracy1000: 0.3626 - 25s/epoch - 41ms/step
Epoch 5/50
614/614 - 25s - loss: 3.1348 - accuracy1000: 0.4594 - val_loss: 3.4737 - val_accuracy1000: 0.3628 - 25s/epoch - 41ms/step
Epoch 6/50
614/614 - 25s - loss: 3.1136 - accuracy1000: 0.4672 - val_loss: 3.6130 - val_accuracy1000: 0.3650 - 25s/epoch - 41ms/step
Epoch 7/50
614/614 - 25s - loss: 3.0851 - accuracy1000: 0.4779 - val_loss: 3.5428 - val_accuracy1000: 0.3643 - 25s/epoch - 40ms/step
Epoch 8/50
614/614 - 25s - loss: 3.0454 - accuracy1000: 0.4882 - val_loss: 3.5478 - val_accuracy1000: 0.3624 - 25s/epoch - 41ms/step
Epoch 9/50
614/614 - 25s - loss: 3.0135 - accuracy1000: 0.4998 - val_loss: 3.6213 - val_accuracy1000: 0.3630 - 25s/epoch - 41ms/step
Epoch 10/50
614/614 - 25s - loss: 2.9835 - accuracy1000: 0.5087 - val_loss: 3.6364 - val_accuracy1000: 0.3650 - 25s/epoch - 41ms/step
Epoch 11/50
614/614 - 25s - loss: 2.9387 - accuracy1000: 0.5216 - val_loss: 3.7125 - val_accuracy1000: 0.3624 - 25s/epoch - 41ms/step
Epoch 12/50
614/614 - 25s - loss: 2.9249 - accuracy1000: 0.5241 - val_loss: 3.6634 - val_accuracy1000: 0.3599 - 25s/epoch - 41ms/step
Epoch 13/50
614/614 - 25s - loss: 2.8848 - accuracy1000: 0.5365 - val_loss: 3.8105 - val_accuracy1000: 0.3584 - 25s/epoch - 41ms/step
testing model: results/QRTEA/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1774286
{'0': {'precision': 0.39317598375416685, 'recall': 0.2887689248259948, 'f1-score': 0.3329799949162534, 'support': 213212}, '1': {'precision': 0.268021778584392, 'recall': 0.0715041962556488, 'f1-score': 0.11289081411644795, 'support': 154900}, '2': {'precision': 0.3443607392854463, 'recall': 0.6533627180125271, 'f1-score': 0.45101168455167967, 'support': 189668}, 'accuracy': 0.35240955215317865, 'macro avg': {'precision': 0.3351861672080017, 'recall': 0.3378786130313902, 'f1-score': 0.2989608311947937, 'support': 557780}, 'weighted avg': {'precision': 0.34182047411113303, 'recall': 0.35240955215317865, 'f1-score': 0.3119950553412994, 'support': 557780}}
[[ 61569  16025 135618]
 [ 43503  11076 100321]
 [ 51522  14224 123922]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1509178
{'0': {'precision': 0.32828453651833844, 'recall': 0.5876265253996784, 'f1-score': 0.4212389380530973, 'support': 52855}, '1': {'precision': 0.36795214049081726, 'recall': 0.21781348768135259, 'f1-score': 0.2736416585937594, 'support': 52522}, '2': {'precision': 0.41129803096922196, 'recall': 0.24964223554438214, 'f1-score': 0.31070087609511887, 'support': 51710}, 'accuracy': 0.35272174018219205, 'macro avg': {'precision': 0.3691782359927926, 'recall': 0.35169408287513776, 'f1-score': 0.3351938242473252, 'support': 157087}, 'weighted avg': {'precision': 0.36887382585416967, 'recall': 0.35272174018219205, 'f1-score': 0.33550283324741376, 'support': 157087}}
[[31059 10630 11166]
 [33771 11440  7311]
 [29780  9021 12909]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1513733
{'0': {'precision': 0.3524243314722304, 'recall': 0.702618782588318, 'f1-score': 0.46940253233918466, 'support': 17069}, '1': {'precision': 0.3311781609195402, 'recall': 0.20808614908434356, 'f1-score': 0.2555837161412957, 'support': 15508}, '2': {'precision': 0.4540325950689511, 'recall': 0.1359569542639054, 'f1-score': 0.2092541768982618, 'support': 15983}, 'accuracy': 0.3581754530477759, 'macro avg': {'precision': 0.37921169582024056, 'recall': 0.3488872953121889, 'f1-score': 0.3114134751262474, 'support': 48560}, 'weighted avg': {'precision': 0.3790824711784756, 'recall': 0.3581754530477759, 'f1-score': 0.31549286663471326, 'support': 48560}}
[[11993  3506  1570]
 [11238  3227  1043]
 [10799  3011  2173]]
training model: results/QRTEA/W8/deepOF_L2/h10
Epoch 1/50
614/614 - 16s - loss: 2.8697 - accuracy10: 0.5355 - val_loss: 2.7845 - val_accuracy10: 0.7221 - 16s/epoch - 27ms/step
Epoch 2/50
614/614 - 14s - loss: 2.5775 - accuracy10: 0.6196 - val_loss: 2.8495 - val_accuracy10: 0.7954 - 14s/epoch - 23ms/step
Epoch 3/50
614/614 - 14s - loss: 2.4387 - accuracy10: 0.6570 - val_loss: 2.7832 - val_accuracy10: 0.7911 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 2.3517 - accuracy10: 0.6693 - val_loss: 2.7573 - val_accuracy10: 0.7980 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 2.2948 - accuracy10: 0.6767 - val_loss: 2.7399 - val_accuracy10: 0.7967 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.2474 - accuracy10: 0.6832 - val_loss: 2.7145 - val_accuracy10: 0.7928 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 14s - loss: 2.2195 - accuracy10: 0.6903 - val_loss: 2.6935 - val_accuracy10: 0.7959 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 2.1880 - accuracy10: 0.6929 - val_loss: 2.6529 - val_accuracy10: 0.7982 - 14s/epoch - 22ms/step
Epoch 9/50
614/614 - 14s - loss: 2.1683 - accuracy10: 0.6950 - val_loss: 2.6597 - val_accuracy10: 0.7975 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 14s - loss: 2.1465 - accuracy10: 0.6970 - val_loss: 2.6108 - val_accuracy10: 0.7888 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 2.1288 - accuracy10: 0.6986 - val_loss: 2.6180 - val_accuracy10: 0.7873 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 2.1140 - accuracy10: 0.7000 - val_loss: 2.5947 - val_accuracy10: 0.7886 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 14s - loss: 2.0977 - accuracy10: 0.7001 - val_loss: 2.6383 - val_accuracy10: 0.7872 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 14s - loss: 2.0845 - accuracy10: 0.7008 - val_loss: 2.6239 - val_accuracy10: 0.7876 - 14s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 2.0714 - accuracy10: 0.7027 - val_loss: 2.6173 - val_accuracy10: 0.7813 - 14s/epoch - 22ms/step
Epoch 16/50
614/614 - 14s - loss: 2.0551 - accuracy10: 0.7021 - val_loss: 2.6420 - val_accuracy10: 0.7825 - 14s/epoch - 22ms/step
Epoch 17/50
614/614 - 14s - loss: 2.0422 - accuracy10: 0.7031 - val_loss: 2.6167 - val_accuracy10: 0.7760 - 14s/epoch - 23ms/step
Epoch 18/50
614/614 - 14s - loss: 2.0285 - accuracy10: 0.7044 - val_loss: 2.6434 - val_accuracy10: 0.7746 - 14s/epoch - 23ms/step
Epoch 19/50
614/614 - 14s - loss: 2.0156 - accuracy10: 0.7054 - val_loss: 2.6072 - val_accuracy10: 0.7644 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 14s - loss: 2.0019 - accuracy10: 0.7044 - val_loss: 2.6739 - val_accuracy10: 0.7733 - 14s/epoch - 22ms/step
Epoch 21/50
614/614 - 14s - loss: 1.9956 - accuracy10: 0.7044 - val_loss: 2.6726 - val_accuracy10: 0.7671 - 14s/epoch - 22ms/step
Epoch 22/50
614/614 - 14s - loss: 1.9799 - accuracy10: 0.7055 - val_loss: 2.7043 - val_accuracy10: 0.7601 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W8/deepOF_L2/h10
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49367875
{'0': {'precision': 0.42682677004049857, 'recall': 0.5450009054508139, 'f1-score': 0.47872885699641216, 'support': 49699}, '1': {'precision': 0.9095085245916277, 'recall': 0.8874528458046923, 'f1-score': 0.8983453308787054, 'support': 459132}, '2': {'precision': 0.48538365214387497, 'recall': 0.45934128800261526, 'f1-score': 0.47200352711469423, 'support': 48944}, 'accuracy': 0.8193734032540003, 'macro avg': {'precision': 0.6072396489253338, 'recall': 0.6305983464193738, 'f1-score': 0.6163592383299373, 'support': 557775}, 'weighted avg': {'precision': 0.8292841181974375, 'recall': 0.8193734032540003, 'f1-score': 0.8235456493244911, 'support': 557775}}
[[ 27086  18983   3630]
 [ 31468 407458  20206]
 [  4905  21557  22482]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53483874
{'0': {'precision': 0.4747113105743533, 'recall': 0.523873121869783, 'f1-score': 0.4980820613211291, 'support': 17970}, '1': {'precision': 0.8754776173430399, 'recall': 0.9004823643298611, 'f1-score': 0.8878039628351645, 'support': 120863}, '2': {'precision': 0.5801514917297882, 'recall': 0.4112651361569229, 'f1-score': 0.4813235435570233, 'support': 18251}, 'accuracy': 0.8005589366198976, 'macro avg': {'precision': 0.6434468065490604, 'recall': 0.6118735407855223, 'f1-score': 0.6224031892377723, 'support': 157084}, 'weighted avg': {'precision': 0.795318163476314, 'recall': 0.8005589366198976, 'f1-score': 0.7959933602120293, 'support': 157084}}
[[  9414   7132   1424]
 [  8020 108835   4008]
 [  2397   8348   7506]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5641529
{'0': {'precision': 0.3993993993993994, 'recall': 0.4979310344827586, 'f1-score': 0.44325556919838627, 'support': 5075}, '1': {'precision': 0.8905068682781386, 'recall': 0.8746502810824944, 'f1-score': 0.8825073540080993, 'support': 38245}, '2': {'precision': 0.48425787106446777, 'recall': 0.4314885496183206, 'f1-score': 0.45635281057624383, 'support': 5240}, 'accuracy': 0.7874588138385502, 'macro avg': {'precision': 0.5913880462473353, 'recall': 0.601356621727858, 'f1-score': 0.5940385779275764, 'support': 48560}, 'weighted avg': {'precision': 0.7953438709560786, 'recall': 0.7874588138385502, 'f1-score': 0.790615825682477, 'support': 48560}}
[[ 2527  2003   545]
 [ 2931 33451  1863]
 [  869  2110  2261]]
training model: results/QRTEA/W8/deepOF_L2/h20
Epoch 1/50
614/614 - 16s - loss: 2.9355 - accuracy20: 0.5077 - val_loss: 2.8231 - val_accuracy20: 0.7037 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 14s - loss: 2.6687 - accuracy20: 0.5833 - val_loss: 2.7763 - val_accuracy20: 0.7456 - 14s/epoch - 23ms/step
Epoch 3/50
614/614 - 14s - loss: 2.5443 - accuracy20: 0.6159 - val_loss: 2.7390 - val_accuracy20: 0.7496 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 2.4558 - accuracy20: 0.6300 - val_loss: 2.7556 - val_accuracy20: 0.7525 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 2.3961 - accuracy20: 0.6388 - val_loss: 2.7213 - val_accuracy20: 0.7505 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.3566 - accuracy20: 0.6459 - val_loss: 2.7272 - val_accuracy20: 0.7507 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 14s - loss: 2.3283 - accuracy20: 0.6520 - val_loss: 2.7044 - val_accuracy20: 0.7479 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 2.3007 - accuracy20: 0.6547 - val_loss: 2.7074 - val_accuracy20: 0.7481 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 14s - loss: 2.2751 - accuracy20: 0.6601 - val_loss: 2.6701 - val_accuracy20: 0.7428 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 14s - loss: 2.2584 - accuracy20: 0.6632 - val_loss: 2.6645 - val_accuracy20: 0.7381 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 2.2373 - accuracy20: 0.6657 - val_loss: 2.6484 - val_accuracy20: 0.7357 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 2.2230 - accuracy20: 0.6677 - val_loss: 2.6437 - val_accuracy20: 0.7358 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 14s - loss: 2.2059 - accuracy20: 0.6716 - val_loss: 2.6567 - val_accuracy20: 0.7334 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 14s - loss: 2.1937 - accuracy20: 0.6716 - val_loss: 2.6761 - val_accuracy20: 0.7304 - 14s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 2.1835 - accuracy20: 0.6728 - val_loss: 2.6776 - val_accuracy20: 0.7320 - 14s/epoch - 23ms/step
Epoch 16/50
614/614 - 14s - loss: 2.1696 - accuracy20: 0.6723 - val_loss: 2.6887 - val_accuracy20: 0.7274 - 14s/epoch - 22ms/step
Epoch 17/50
614/614 - 14s - loss: 2.1558 - accuracy20: 0.6739 - val_loss: 2.7493 - val_accuracy20: 0.7206 - 14s/epoch - 22ms/step
Epoch 18/50
614/614 - 14s - loss: 2.1431 - accuracy20: 0.6741 - val_loss: 2.7288 - val_accuracy20: 0.7197 - 14s/epoch - 22ms/step
Epoch 19/50
614/614 - 14s - loss: 2.1287 - accuracy20: 0.6769 - val_loss: 2.7668 - val_accuracy20: 0.7121 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 14s - loss: 2.1141 - accuracy20: 0.6779 - val_loss: 2.8074 - val_accuracy20: 0.7068 - 14s/epoch - 22ms/step
Epoch 21/50
614/614 - 14s - loss: 2.1028 - accuracy20: 0.6769 - val_loss: 2.7944 - val_accuracy20: 0.7065 - 14s/epoch - 22ms/step
Epoch 22/50
614/614 - 14s - loss: 2.0878 - accuracy20: 0.6787 - val_loss: 2.7889 - val_accuracy20: 0.7088 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h20
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59054327
{'0': {'precision': 0.4762193514368574, 'recall': 0.5238917006250272, 'f1-score': 0.49891932576976467, 'support': 68957}, '1': {'precision': 0.8567892461656896, 'recall': 0.8585320351848248, 'f1-score': 0.8576597553269559, 'support': 421318}, '2': {'precision': 0.5200703046534985, 'recall': 0.46028148148148146, 'f1-score': 0.48835271927066953, 'support': 67500}, 'accuracy': 0.7689659809062794, 'macro avg': {'precision': 0.6176929674186818, 'recall': 0.6142350724304445, 'f1-score': 0.6149772667891301, 'support': 557775}, 'weighted avg': {'precision': 0.7689913226608912, 'recall': 0.7689659809062794, 'f1-score': 0.7686168818837672, 'support': 557775}}
[[ 36126  29025   3806]
 [ 34738 361715  24865]
 [  4996  31435  31069]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6391928
{'0': {'precision': 0.5036611749043102, 'recall': 0.5021153048527582, 'f1-score': 0.5028870518838534, 'support': 24110}, '1': {'precision': 0.8114734444311233, 'recall': 0.87202068724348, 'f1-score': 0.8406582682753726, 'support': 108666}, '2': {'precision': 0.6047068944328376, 'recall': 0.4048461411880862, 'f1-score': 0.48499334680400175, 'support': 24308}, 'accuracy': 0.7429528150543658, 'macro avg': {'precision': 0.6399471712560905, 'recall': 0.5929940444281082, 'f1-score': 0.6095128889877426, 'support': 157084}, 'weighted avg': {'precision': 0.7322328144774056, 'recall': 0.7429528150543658, 'f1-score': 0.7337780835441102, 'support': 157084}}
[[12106 10270  1734]
 [ 9208 94759  4699]
 [ 2722 11745  9841]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6628101
{'0': {'precision': 0.43832226129998697, 'recall': 0.49748669426374925, 'f1-score': 0.4660342081573298, 'support': 6764}, '1': {'precision': 0.8351379770938131, 'recall': 0.8398639572437052, 'f1-score': 0.8374943000455995, 'support': 34989}, '2': {'precision': 0.5173806179775281, 'recall': 0.4329366828265021, 'f1-score': 0.47140686235303525, 'support': 6807}, 'accuracy': 0.7351317957166392, 'macro avg': {'precision': 0.5969469521237761, 'recall': 0.5900957781113189, 'f1-score': 0.5916451235186548, 'support': 48560}, 'weighted avg': {'precision': 0.7353225766585991, 'recall': 0.7351317957166392, 'f1-score': 0.734435954701581, 'support': 48560}}
[[ 3365  2814   585]
 [ 3439 29386  2164]
 [  873  2987  2947]]
training model: results/QRTEA/W8/deepOF_L2/h30
Epoch 1/50
614/614 - 16s - loss: 2.9954 - accuracy30: 0.4880 - val_loss: 2.8224 - val_accuracy30: 0.6621 - 16s/epoch - 27ms/step
Epoch 2/50
614/614 - 15s - loss: 2.7495 - accuracy30: 0.5561 - val_loss: 2.8091 - val_accuracy30: 0.7019 - 15s/epoch - 24ms/step
Epoch 3/50
614/614 - 14s - loss: 2.6294 - accuracy30: 0.5899 - val_loss: 2.8395 - val_accuracy30: 0.7079 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 2.5530 - accuracy30: 0.6012 - val_loss: 2.8775 - val_accuracy30: 0.7095 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 2.5042 - accuracy30: 0.6089 - val_loss: 2.8677 - val_accuracy30: 0.7092 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.4680 - accuracy30: 0.6152 - val_loss: 2.8549 - val_accuracy30: 0.7068 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 14s - loss: 2.4450 - accuracy30: 0.6193 - val_loss: 2.8440 - val_accuracy30: 0.7100 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 2.4202 - accuracy30: 0.6259 - val_loss: 2.8497 - val_accuracy30: 0.7103 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 14s - loss: 2.3963 - accuracy30: 0.6307 - val_loss: 2.8099 - val_accuracy30: 0.7080 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 14s - loss: 2.3788 - accuracy30: 0.6336 - val_loss: 2.8501 - val_accuracy30: 0.7062 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 2.3619 - accuracy30: 0.6385 - val_loss: 2.8012 - val_accuracy30: 0.7016 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 2.3455 - accuracy30: 0.6411 - val_loss: 2.7831 - val_accuracy30: 0.6982 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 14s - loss: 2.3239 - accuracy30: 0.6437 - val_loss: 2.8411 - val_accuracy30: 0.6991 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 14s - loss: 2.3136 - accuracy30: 0.6458 - val_loss: 2.8268 - val_accuracy30: 0.6938 - 14s/epoch - 23ms/step
Epoch 15/50
614/614 - 14s - loss: 2.2987 - accuracy30: 0.6472 - val_loss: 2.8282 - val_accuracy30: 0.6987 - 14s/epoch - 22ms/step
Epoch 16/50
614/614 - 14s - loss: 2.2818 - accuracy30: 0.6489 - val_loss: 2.8158 - val_accuracy30: 0.7006 - 14s/epoch - 22ms/step
Epoch 17/50
614/614 - 14s - loss: 2.2662 - accuracy30: 0.6514 - val_loss: 2.8333 - val_accuracy30: 0.6908 - 14s/epoch - 22ms/step
Epoch 18/50
614/614 - 14s - loss: 2.2553 - accuracy30: 0.6517 - val_loss: 2.8128 - val_accuracy30: 0.6904 - 14s/epoch - 22ms/step
Epoch 19/50
614/614 - 14s - loss: 2.2323 - accuracy30: 0.6553 - val_loss: 2.8383 - val_accuracy30: 0.6856 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 14s - loss: 2.2241 - accuracy30: 0.6553 - val_loss: 2.8704 - val_accuracy30: 0.6854 - 14s/epoch - 23ms/step
Epoch 21/50
614/614 - 14s - loss: 2.2045 - accuracy30: 0.6570 - val_loss: 2.8612 - val_accuracy30: 0.6827 - 14s/epoch - 23ms/step
Epoch 22/50
614/614 - 14s - loss: 2.1863 - accuracy30: 0.6589 - val_loss: 2.8331 - val_accuracy30: 0.6714 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h30
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67615527
{'0': {'precision': 0.49565918956387356, 'recall': 0.5120141799016328, 'f1-score': 0.503703960321722, 'support': 85191}, '1': {'precision': 0.8001391093179341, 'recall': 0.8588210544679301, 'f1-score': 0.8284422116770709, 'support': 389789}, '2': {'precision': 0.5985174231959064, 'recall': 0.371544175372909, 'f1-score': 0.4584774055085251, 'support': 82795}, 'accuracy': 0.7335215812827753, 'macro avg': {'precision': 0.6314385740259048, 'recall': 0.580793136580824, 'f1-score': 0.5968745258357727, 'support': 557775}, 'weighted avg': {'precision': 0.7237064682955838, 'recall': 0.7335215812827753, 'f1-score': 0.7239269277401101, 'support': 557775}}
[[ 43619  38318   3254]
 [ 37649 334759  17381]
 [  6734  45299  30762]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7391907
{'0': {'precision': 0.5121027673579164, 'recall': 0.4987936026471805, 'f1-score': 0.5053605727256855, 'support': 29012}, '1': {'precision': 0.7457962155054556, 'recall': 0.8659669770780882, 'f1-score': 0.8014017161197354, 'support': 98901}, '2': {'precision': 0.6604474944599328, 'recall': 0.31671865894210005, 'f1-score': 0.4281278962001853, 'support': 29171}, 'accuracy': 0.6961561966845764, 'macro avg': {'precision': 0.639448825774435, 'recall': 0.5604930795557895, 'f1-score': 0.5782967283485354, 'support': 157084}, 'weighted avg': {'precision': 0.6867856106107791, 'recall': 0.6961561966845764, 'f1-score': 0.6774074439276512, 'support': 157084}}
[[14471 12968  1573]
 [10079 85645  3177]
 [ 3708 16224  9239]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74281377
{'0': {'precision': 0.45411629245826135, 'recall': 0.4879376469132748, 'f1-score': 0.47041984732824427, 'support': 8083}, '1': {'precision': 0.776831052586281, 'recall': 0.8355086550032398, 'f1-score': 0.8051021318348052, 'support': 32409}, '2': {'precision': 0.5717417297728179, 'recall': 0.35560237977193854, 'f1-score': 0.4384838758979062, 'support': 8068}, 'accuracy': 0.6979200988467875, 'macro avg': {'precision': 0.6008963582724535, 'recall': 0.559682893896151, 'f1-score': 0.5713352850203185, 'support': 48560}, 'weighted avg': {'precision': 0.6890393709023065, 'recall': 0.6979200988467875, 'f1-score': 0.6884811887836224, 'support': 48560}}
[[ 3944  3632   507]
 [ 3689 27078  1642]
 [ 1052  4147  2869]]
training model: results/QRTEA/W8/deepOF_L2/h50
Epoch 1/50
614/614 - 17s - loss: 3.0951 - accuracy50: 0.4583 - val_loss: 2.9206 - val_accuracy50: 0.5890 - 17s/epoch - 27ms/step
Epoch 2/50
614/614 - 15s - loss: 2.9004 - accuracy50: 0.5151 - val_loss: 2.8869 - val_accuracy50: 0.6186 - 15s/epoch - 24ms/step
Epoch 3/50
614/614 - 14s - loss: 2.7996 - accuracy50: 0.5440 - val_loss: 2.9519 - val_accuracy50: 0.6353 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 2.7264 - accuracy50: 0.5620 - val_loss: 3.0097 - val_accuracy50: 0.6387 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 2.6842 - accuracy50: 0.5700 - val_loss: 2.9962 - val_accuracy50: 0.6410 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.6499 - accuracy50: 0.5761 - val_loss: 2.9936 - val_accuracy50: 0.6402 - 14s/epoch - 22ms/step
Epoch 7/50
614/614 - 14s - loss: 2.6303 - accuracy50: 0.5796 - val_loss: 2.9573 - val_accuracy50: 0.6430 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 2.6098 - accuracy50: 0.5838 - val_loss: 2.9505 - val_accuracy50: 0.6439 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 14s - loss: 2.5921 - accuracy50: 0.5871 - val_loss: 2.9449 - val_accuracy50: 0.6451 - 14s/epoch - 22ms/step
Epoch 10/50
614/614 - 14s - loss: 2.5751 - accuracy50: 0.5900 - val_loss: 2.9436 - val_accuracy50: 0.6447 - 14s/epoch - 22ms/step
Epoch 11/50
614/614 - 14s - loss: 2.5608 - accuracy50: 0.5927 - val_loss: 2.9362 - val_accuracy50: 0.6440 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 14s - loss: 2.5453 - accuracy50: 0.5970 - val_loss: 2.9614 - val_accuracy50: 0.6480 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h50
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83886373
{'0': {'precision': 0.5231295166385391, 'recall': 0.3225683079550306, 'f1-score': 0.3990668962747374, 'support': 112432}, '1': {'precision': 0.6676369168818982, 'recall': 0.870443396562578, 'f1-score': 0.7556694413438065, 'support': 336764}, '2': {'precision': 0.5890333292836026, 'recall': 0.2679155269435158, 'f1-score': 0.36830943563447605, 'support': 108579}, 'accuracy': 0.6427161489848057, 'macro avg': {'precision': 0.5932665876013467, 'recall': 0.4869757438203748, 'f1-score': 0.5076819244176733, 'support': 557775}, 'weighted avg': {'precision': 0.6232068958841901, 'recall': 0.6427161489848057, 'f1-score': 0.6083829917770118, 'support': 557775}}
[[ 36267  72357   3808]
 [ 27142 293134  16488]
 [  5918  73571  29090]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90754807
{'0': {'precision': 0.5353640416047548, 'recall': 0.2928554011216776, 'f1-score': 0.37860557978248305, 'support': 36909}, '1': {'precision': 0.5982191413891347, 'recall': 0.8826770144677589, 'f1-score': 0.7131280388978931, 'support': 83496}, '2': {'precision': 0.6092004381161008, 'recall': 0.22745985441260666, 'f1-score': 0.33124230753960376, 'support': 36679}, 'accuracy': 0.5910977566142955, 'macro avg': {'precision': 0.5809278737033301, 'recall': 0.46766409000068115, 'f1-score': 0.4743253087399933, 'support': 157084}, 'weighted avg': {'precision': 0.5860146145417582, 'recall': 0.5910977566142955, 'f1-score': 0.5453574436496096, 'support': 157084}}
[[10809 24116  1984]
 [ 6428 73700  3368]
 [ 2953 25383  8343]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8737279
{'0': {'precision': 0.5055373576665106, 'recall': 0.31650390625, 'f1-score': 0.3892859287730467, 'support': 10240}, '1': {'precision': 0.6501873466857159, 'recall': 0.8548644338118022, 'f1-score': 0.738608525232729, 'support': 28215}, '2': {'precision': 0.5399841646872525, 'recall': 0.2699653636813459, 'f1-score': 0.3599656924193442, 'support': 10105}, 'accuracy': 0.6196252059308073, 'macro avg': {'precision': 0.5652362896798263, 'recall': 0.4804445679143827, 'f1-score': 0.4959533821417066, 'support': 48560}, 'weighted avg': {'precision': 0.5967520286945475, 'recall': 0.6196252059308073, 'f1-score': 0.5861528165563205, 'support': 48560}}
[[ 3241  6388   611]
 [ 2382 24120  1713]
 [  788  6589  2728]]
training model: results/QRTEA/W8/deepOF_L2/h100
Epoch 1/50
614/614 - 16s - loss: 3.2079 - accuracy100: 0.4120 - val_loss: 3.1322 - val_accuracy100: 0.4807 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 14s - loss: 3.0864 - accuracy100: 0.4593 - val_loss: 3.1264 - val_accuracy100: 0.4952 - 14s/epoch - 22ms/step
Epoch 3/50
614/614 - 14s - loss: 3.0098 - accuracy100: 0.4836 - val_loss: 3.2228 - val_accuracy100: 0.4996 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 2.9639 - accuracy100: 0.4964 - val_loss: 3.2618 - val_accuracy100: 0.5023 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 2.9386 - accuracy100: 0.5028 - val_loss: 3.2501 - val_accuracy100: 0.5064 - 14s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 2.9208 - accuracy100: 0.5064 - val_loss: 3.2284 - val_accuracy100: 0.5082 - 14s/epoch - 22ms/step
Epoch 7/50
614/614 - 14s - loss: 2.9057 - accuracy100: 0.5092 - val_loss: 3.2181 - val_accuracy100: 0.5121 - 14s/epoch - 22ms/step
Epoch 8/50
614/614 - 14s - loss: 2.8895 - accuracy100: 0.5129 - val_loss: 3.2221 - val_accuracy100: 0.5116 - 14s/epoch - 22ms/step
Epoch 9/50
614/614 - 14s - loss: 2.8790 - accuracy100: 0.5161 - val_loss: 3.2054 - val_accuracy100: 0.5151 - 14s/epoch - 22ms/step
Epoch 10/50
614/614 - 14s - loss: 2.8663 - accuracy100: 0.5194 - val_loss: 3.2273 - val_accuracy100: 0.5160 - 14s/epoch - 22ms/step
Epoch 11/50
614/614 - 14s - loss: 2.8537 - accuracy100: 0.5231 - val_loss: 3.2140 - val_accuracy100: 0.5168 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 14s - loss: 2.8445 - accuracy100: 0.5261 - val_loss: 3.2085 - val_accuracy100: 0.5186 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h100
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0126352
{'0': {'precision': 0.5446337905950557, 'recall': 0.1854221797587544, 'f1-score': 0.27665600645239946, 'support': 159091}, '1': {'precision': 0.48084004086874527, 'recall': 0.8892498917665719, 'f1-score': 0.6241735584132322, 'support': 247151}, '2': {'precision': 0.5786974365585853, 'recall': 0.17773026337497444, 'f1-score': 0.2719415162163254, 'support': 151533}, 'accuracy': 0.49519967728922953, 'macro avg': {'precision': 0.5347237560074621, 'recall': 0.41746744496676685, 'f1-score': 0.3909236936939857, 'support': 557775}, 'weighted avg': {'precision': 0.5256208865121982, 'recall': 0.49519967728922953, 'f1-score': 0.4293607881936549, 'support': 557775}}
[[ 29499 122185   7407]
 [ 15172 219779  12200]
 [  9492 115109  26932]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.055792
{'0': {'precision': 0.5349135169762973, 'recall': 0.18908125244457252, 'f1-score': 0.2794001338443755, 'support': 48577}, '1': {'precision': 0.43349846959704647, 'recall': 0.899024932923238, 'f1-score': 0.5849442220897556, 'support': 61124}, '2': {'precision': 0.568104038329911, 'recall': 0.15765147837832133, 'f1-score': 0.2468116037798189, 'support': 47383}, 'accuracy': 0.4558516462529602, 'macro avg': {'precision': 0.5121720083010849, 'recall': 0.415252554582044, 'f1-score': 0.37038531990465, 'support': 157084}, 'weighted avg': {'precision': 0.5054628607496221, 'recall': 0.4558516462529602, 'f1-score': 0.38846238416816237, 'support': 157084}}
[[ 9185 36240  3152]
 [ 3645 54952  2527]
 [ 4341 35572  7470]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0156577
{'0': {'precision': 0.53557382910261, 'recall': 0.21782754107895885, 'f1-score': 0.3096960926193922, 'support': 13754}, '1': {'precision': 0.4854239590408025, 'recall': 0.8715820083485766, 'f1-score': 0.6235592168179455, 'support': 21321}, '2': {'precision': 0.5318104184457728, 'recall': 0.18472376714868372, 'f1-score': 0.2742033133359018, 'support': 13485}, 'accuracy': 0.49567545304777594, 'macro avg': {'precision': 0.5176027355297285, 'recall': 0.4247111055254063, 'f1-score': 0.40248620759107984, 'support': 48560}, 'weighted avg': {'precision': 0.5125096822266783, 'recall': 0.49567545304777594, 'f1-score': 0.4376461655683107, 'support': 48560}}
[[ 2996  9857   901]
 [ 1446 18583  1292]
 [ 1152  9842  2491]]
training model: results/QRTEA/W8/deepOF_L2/h200
Epoch 1/50
614/614 - 16s - loss: 3.2761 - accuracy200: 0.3736 - val_loss: 3.2467 - val_accuracy200: 0.3955 - 16s/epoch - 27ms/step
Epoch 2/50
614/614 - 14s - loss: 3.2044 - accuracy200: 0.4105 - val_loss: 3.2306 - val_accuracy200: 0.4014 - 14s/epoch - 23ms/step
Epoch 3/50
614/614 - 14s - loss: 3.1627 - accuracy200: 0.4270 - val_loss: 3.2649 - val_accuracy200: 0.4010 - 14s/epoch - 22ms/step
Epoch 4/50
614/614 - 14s - loss: 3.1402 - accuracy200: 0.4378 - val_loss: 3.2583 - val_accuracy200: 0.4022 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 3.1245 - accuracy200: 0.4433 - val_loss: 3.2628 - val_accuracy200: 0.4044 - 14s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 3.1133 - accuracy200: 0.4469 - val_loss: 3.2615 - val_accuracy200: 0.4058 - 14s/epoch - 22ms/step
Epoch 7/50
614/614 - 14s - loss: 3.1065 - accuracy200: 0.4487 - val_loss: 3.2485 - val_accuracy200: 0.4071 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 3.0983 - accuracy200: 0.4521 - val_loss: 3.2385 - val_accuracy200: 0.4086 - 14s/epoch - 22ms/step
Epoch 9/50
614/614 - 14s - loss: 3.0912 - accuracy200: 0.4542 - val_loss: 3.2371 - val_accuracy200: 0.4099 - 14s/epoch - 22ms/step
Epoch 10/50
614/614 - 14s - loss: 3.0829 - accuracy200: 0.4569 - val_loss: 3.2294 - val_accuracy200: 0.4117 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 3.0779 - accuracy200: 0.4578 - val_loss: 3.2309 - val_accuracy200: 0.4120 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 14s - loss: 3.0716 - accuracy200: 0.4610 - val_loss: 3.2179 - val_accuracy200: 0.4153 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 14s - loss: 3.0657 - accuracy200: 0.4615 - val_loss: 3.2336 - val_accuracy200: 0.4143 - 14s/epoch - 22ms/step
Epoch 14/50
614/614 - 14s - loss: 3.0586 - accuracy200: 0.4649 - val_loss: 3.2235 - val_accuracy200: 0.4151 - 14s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 3.0507 - accuracy200: 0.4671 - val_loss: 3.2448 - val_accuracy200: 0.4182 - 14s/epoch - 22ms/step
Epoch 16/50
614/614 - 14s - loss: 3.0446 - accuracy200: 0.4712 - val_loss: 3.2333 - val_accuracy200: 0.4202 - 14s/epoch - 23ms/step
Epoch 17/50
614/614 - 14s - loss: 3.0373 - accuracy200: 0.4710 - val_loss: 3.2359 - val_accuracy200: 0.4216 - 14s/epoch - 23ms/step
Epoch 18/50
614/614 - 14s - loss: 3.0307 - accuracy200: 0.4744 - val_loss: 3.2541 - val_accuracy200: 0.4216 - 14s/epoch - 22ms/step
Epoch 19/50
614/614 - 14s - loss: 3.0231 - accuracy200: 0.4761 - val_loss: 3.2335 - val_accuracy200: 0.4256 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 14s - loss: 3.0177 - accuracy200: 0.4794 - val_loss: 3.2484 - val_accuracy200: 0.4249 - 14s/epoch - 23ms/step
Epoch 21/50
614/614 - 14s - loss: 3.0042 - accuracy200: 0.4827 - val_loss: 3.2825 - val_accuracy200: 0.4243 - 14s/epoch - 22ms/step
Epoch 22/50
614/614 - 14s - loss: 2.9952 - accuracy200: 0.4860 - val_loss: 3.2752 - val_accuracy200: 0.4270 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h200
Evaluating performance on  test set...
2179/2179 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090034
{'0': {'precision': 0.5499721928203656, 'recall': 0.15993071894742883, 'f1-score': 0.24780134505949303, 'support': 191683}, '1': {'precision': 0.3614544632327514, 'recall': 0.8763994818625, 'f1-score': 0.511818870956857, 'support': 186051}, '2': {'precision': 0.5699053528649413, 'recall': 0.16120217061669287, 'f1-score': 0.25131728775106404, 'support': 180041}, 'accuracy': 0.3993258930572363, 'macro avg': {'precision': 0.49377733630601944, 'recall': 0.39917745714220726, 'f1-score': 0.33697916792247135, 'support': 557775}, 'weighted avg': {'precision': 0.49352447458286886, 'recall': 0.3993258930572363, 'f1-score': 0.33700171895374004, 'support': 557775}}
[[ 30656 150232  10795]
 [ 11888 163055  11108]
 [ 13197 137821  29023]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882628
{'0': {'precision': 0.53554965019795, 'recall': 0.1811394819869396, 'f1-score': 0.27071482420670273, 'support': 54516}, '1': {'precision': 0.35680247796044795, 'recall': 0.8918468227026383, 'f1-score': 0.5096918023859363, 'support': 50373}, '2': {'precision': 0.5781703965449548, 'recall': 0.14106715202605613, 'f1-score': 0.22679809025103956, 'support': 52195}, 'accuracy': 0.3957309464999618, 'macro avg': {'precision': 0.49017417490111753, 'recall': 0.404684485571878, 'f1-score': 0.33573490561455954, 'support': 157084}, 'weighted avg': {'precision': 0.49239158539480155, 'recall': 0.3957309464999618, 'f1-score': 0.3327564923142547, 'support': 157084}}
[[ 9875 41444  3197]
 [ 3273 44925  2175]
 [ 5291 39541  7363]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0775181
{'0': {'precision': 0.538961038961039, 'recall': 0.1889613586020182, 'f1-score': 0.27981776765375854, 'support': 16252}, '1': {'precision': 0.3795578222350745, 'recall': 0.8618672397325693, 'f1-score': 0.527020861090325, 'support': 16752}, '2': {'precision': 0.5428156748911466, 'recall': 0.16829519156595527, 'f1-score': 0.2569311546199519, 'support': 15556}, 'accuracy': 0.41447693574958816, 'macro avg': {'precision': 0.4871115120290867, 'recall': 0.4063745966335142, 'f1-score': 0.3545899277880118, 'support': 48560}, 'weighted avg': {'precision': 0.48520568537651254, 'recall': 0.41447693574958816, 'f1-score': 0.35776509197203415, 'support': 48560}}
[[ 3071 12140  1041]
 [ 1150 14438  1164]
 [ 1477 11461  2618]]
training model: results/QRTEA/W8/deepOF_L2/h300
Epoch 1/50
614/614 - 16s - loss: 3.3023 - accuracy300: 0.3572 - val_loss: 3.2932 - val_accuracy300: 0.3609 - 16s/epoch - 27ms/step
Epoch 2/50
614/614 - 14s - loss: 3.2606 - accuracy300: 0.3806 - val_loss: 3.2839 - val_accuracy300: 0.3659 - 14s/epoch - 22ms/step
Epoch 3/50
614/614 - 14s - loss: 3.2403 - accuracy300: 0.3923 - val_loss: 3.2827 - val_accuracy300: 0.3678 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 3.2279 - accuracy300: 0.4019 - val_loss: 3.2845 - val_accuracy300: 0.3716 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 3.2174 - accuracy300: 0.4077 - val_loss: 3.2860 - val_accuracy300: 0.3700 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 15s - loss: 3.2099 - accuracy300: 0.4110 - val_loss: 3.2874 - val_accuracy300: 0.3713 - 15s/epoch - 24ms/step
Epoch 7/50
614/614 - 15s - loss: 3.2034 - accuracy300: 0.4142 - val_loss: 3.2862 - val_accuracy300: 0.3721 - 15s/epoch - 24ms/step
Epoch 8/50
614/614 - 14s - loss: 3.1980 - accuracy300: 0.4158 - val_loss: 3.2852 - val_accuracy300: 0.3719 - 14s/epoch - 24ms/step
Epoch 9/50
614/614 - 14s - loss: 3.1924 - accuracy300: 0.4196 - val_loss: 3.2832 - val_accuracy300: 0.3737 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 14s - loss: 3.1874 - accuracy300: 0.4228 - val_loss: 3.2895 - val_accuracy300: 0.3720 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 3.1821 - accuracy300: 0.4244 - val_loss: 3.2872 - val_accuracy300: 0.3763 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 3.1769 - accuracy300: 0.4264 - val_loss: 3.2941 - val_accuracy300: 0.3754 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 14s - loss: 3.1717 - accuracy300: 0.4307 - val_loss: 3.3005 - val_accuracy300: 0.3747 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W8/deepOF_L2/h300
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947075
{'0': {'precision': 0.43525981599066993, 'recall': 0.17611497362653494, 'f1-score': 0.2507652337509146, 'support': 190722}, '1': {'precision': 0.3473802967203404, 'recall': 0.799470304808883, 'f1-score': 0.4843180643290338, 'support': 192186}, '2': {'precision': 0.4337258178210584, 'recall': 0.09500363133124032, 'f1-score': 0.15586621006708262, 'support': 174867}, 'accuracy': 0.36546815472188604, 'macro avg': {'precision': 0.4054553101773562, 'recall': 0.35686296992221944, 'f1-score': 0.2969831693823437, 'support': 557775}, 'weighted avg': {'precision': 0.40449927823187287, 'recall': 0.36546815472188604, 'f1-score': 0.30148618166533486, 'support': 557775}}
[[ 33589 148292   8841]
 [ 25690 153647  12849]
 [ 17891 140363  16613]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995146
{'0': {'precision': 0.428424497428705, 'recall': 0.1718873091495667, 'f1-score': 0.2453416149068323, 'support': 53314}, '1': {'precision': 0.33899181387333044, 'recall': 0.8232943951904418, 'f1-score': 0.48024326228935116, 'support': 52562}, '2': {'precision': 0.4623709416594104, 'recall': 0.07258631463833776, 'f1-score': 0.12547470758013066, 'support': 51208}, 'accuracy': 0.35748389396755875, 'macro avg': {'precision': 0.4099290843204819, 'recall': 0.3559226729927821, 'f1-score': 0.2836865282587714, 'support': 157084}, 'weighted avg': {'precision': 0.40956559902484696, 'recall': 0.35748389396755875, 'f1-score': 0.2848666830190157, 'support': 157084}}
[[ 9164 42339  1811]
 [ 6777 43274  2511]
 [ 5449 42042  3717]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936261
{'0': {'precision': 0.4284672597345778, 'recall': 0.18101164438420306, 'f1-score': 0.2545045045045045, 'support': 16231}, '1': {'precision': 0.35358596930786096, 'recall': 0.7935336496222105, 'f1-score': 0.4891946054270704, 'support': 17073}, '2': {'precision': 0.4160023619722468, 'recall': 0.09235710540115365, 'f1-score': 0.1511559298396181, 'support': 15256}, 'accuracy': 0.3685131795716639, 'macro avg': {'precision': 0.39935186367156184, 'recall': 0.35563413313585573, 'f1-score': 0.2982850132570643, 'support': 48560}, 'weighted avg': {'precision': 0.3982239987848773, 'recall': 0.3685131795716639, 'f1-score': 0.30454936113472403, 'support': 48560}}
[[ 2938 12550   743]
 [ 2290 13548  1235]
 [ 1629 12218  1409]]
training model: results/QRTEA/W8/deepOF_L2/h500
Epoch 1/50
614/614 - 16s - loss: 3.3170 - accuracy500: 0.3620 - val_loss: 3.3155 - val_accuracy500: 0.3319 - 16s/epoch - 27ms/step
Epoch 2/50
614/614 - 14s - loss: 3.2876 - accuracy500: 0.3781 - val_loss: 3.2991 - val_accuracy500: 0.3384 - 14s/epoch - 23ms/step
Epoch 3/50
614/614 - 14s - loss: 3.2812 - accuracy500: 0.3739 - val_loss: 3.2901 - val_accuracy500: 0.3611 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 3.2798 - accuracy500: 0.3725 - val_loss: 3.2853 - val_accuracy500: 0.3704 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 3.2711 - accuracy500: 0.3782 - val_loss: 3.2788 - val_accuracy500: 0.3719 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 3.2625 - accuracy500: 0.3831 - val_loss: 3.2779 - val_accuracy500: 0.3645 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 14s - loss: 3.2551 - accuracy500: 0.3893 - val_loss: 3.2786 - val_accuracy500: 0.3610 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 14s - loss: 3.2474 - accuracy500: 0.3932 - val_loss: 3.2798 - val_accuracy500: 0.3561 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 14s - loss: 3.2420 - accuracy500: 0.3980 - val_loss: 3.2807 - val_accuracy500: 0.3593 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 14s - loss: 3.2396 - accuracy500: 0.3981 - val_loss: 3.2768 - val_accuracy500: 0.3644 - 14s/epoch - 23ms/step
Epoch 11/50
614/614 - 14s - loss: 3.2398 - accuracy500: 0.3996 - val_loss: 3.2754 - val_accuracy500: 0.3698 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 3.2383 - accuracy500: 0.4004 - val_loss: 3.2745 - val_accuracy500: 0.3718 - 14s/epoch - 22ms/step
Epoch 13/50
614/614 - 14s - loss: 3.2359 - accuracy500: 0.4008 - val_loss: 3.2792 - val_accuracy500: 0.3643 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 14s - loss: 3.2366 - accuracy500: 0.4003 - val_loss: 3.2781 - val_accuracy500: 0.3635 - 14s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 3.2338 - accuracy500: 0.4022 - val_loss: 3.2784 - val_accuracy500: 0.3621 - 14s/epoch - 23ms/step
Epoch 16/50
614/614 - 14s - loss: 3.2328 - accuracy500: 0.4013 - val_loss: 3.2777 - val_accuracy500: 0.3686 - 14s/epoch - 23ms/step
Epoch 17/50
614/614 - 14s - loss: 3.2300 - accuracy500: 0.4037 - val_loss: 3.2797 - val_accuracy500: 0.3643 - 14s/epoch - 22ms/step
Epoch 18/50
614/614 - 14s - loss: 3.2248 - accuracy500: 0.4070 - val_loss: 3.2804 - val_accuracy500: 0.3653 - 14s/epoch - 22ms/step
Epoch 19/50
614/614 - 14s - loss: 3.2213 - accuracy500: 0.4093 - val_loss: 3.2830 - val_accuracy500: 0.3646 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 14s - loss: 3.2182 - accuracy500: 0.4101 - val_loss: 3.2832 - val_accuracy500: 0.3677 - 14s/epoch - 22ms/step
Epoch 21/50
614/614 - 14s - loss: 3.2158 - accuracy500: 0.4127 - val_loss: 3.2832 - val_accuracy500: 0.3671 - 14s/epoch - 22ms/step
Epoch 22/50
614/614 - 14s - loss: 3.2088 - accuracy500: 0.4166 - val_loss: 3.2832 - val_accuracy500: 0.3728 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepOF_L2/h500
Evaluating performance on  test set...
2179/2179 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952761
{'0': {'precision': 0.43490583649663117, 'recall': 0.3617809276409909, 'f1-score': 0.3949874506439091, 'support': 212496}, '1': {'precision': 0.2851194564941236, 'recall': 0.39176024151684996, 'f1-score': 0.330039348101352, 'support': 154689}, '2': {'precision': 0.4025952440312949, 'recall': 0.3558528779054515, 'f1-score': 0.3777837193498435, 'support': 190590}, 'accuracy': 0.36806956209941283, 'macro avg': {'precision': 0.3742068456740166, 'recall': 0.3697980156877641, 'f1-score': 0.36760350603170155, 'support': 557775}, 'weighted avg': {'precision': 0.3823248116135218, 'recall': 0.36806956209941283, 'f1-score': 0.37109678472747043, 'support': 557775}}
[[76877 81235 54384]
 [47832 60601 46256]
 [52058 70710 67822]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0897173
{'0': {'precision': 0.39378663764297034, 'recall': 0.38363375932436705, 'f1-score': 0.38864390170360313, 'support': 53757}, '1': {'precision': 0.3375027813980101, 'recall': 0.4099262576734489, 'f1-score': 0.3702057182705718, 'support': 51802}, '2': {'precision': 0.3861466682617538, 'recall': 0.3132265890344493, 'f1-score': 0.34588512644663527, 'support': 51525}, 'accuracy': 0.3692101041480991, 'macro avg': {'precision': 0.3724786957675781, 'recall': 0.36892886867742175, 'f1-score': 0.3682449154736034, 'support': 157084}, 'weighted avg': {'precision': 0.3727197833257349, 'recall': 0.3692101041480991, 'f1-score': 0.36853822147319676, 'support': 157084}}
[[20623 21422 11712]
 [16623 21235 13944]
 [15125 20261 16139]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0918856
{'0': {'precision': 0.4010722821523157, 'recall': 0.36883687774741597, 'f1-score': 0.38427974624787253, 'support': 16834}, '1': {'precision': 0.33575527826041174, 'recall': 0.4030718665065419, 'f1-score': 0.36634687194806687, 'support': 15821}, '2': {'precision': 0.3847792134033792, 'recall': 0.34077334171644136, 'f1-score': 0.3614417658630923, 'support': 15905}, 'accuracy': 0.3707990115321252, 'macro avg': {'precision': 0.37386892460536886, 'recall': 0.3708940286567997, 'f1-score': 0.3706894613530105, 'support': 48560}, 'weighted avg': {'precision': 0.374455280977982, 'recall': 0.3707990115321252, 'f1-score': 0.370956968605427, 'support': 48560}}
[[6209 6523 4102]
 [4880 6377 4564]
 [4392 6093 5420]]
training model: results/QRTEA/W8/deepOF_L2/h1000
Epoch 1/50
614/614 - 16s - loss: 3.3179 - accuracy1000: 0.3682 - val_loss: 3.3561 - val_accuracy1000: 0.3355 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 14s - loss: 3.3005 - accuracy1000: 0.3685 - val_loss: 3.3451 - val_accuracy1000: 0.3421 - 14s/epoch - 23ms/step
Epoch 3/50
614/614 - 14s - loss: 3.2885 - accuracy1000: 0.3779 - val_loss: 3.3331 - val_accuracy1000: 0.3501 - 14s/epoch - 23ms/step
Epoch 4/50
614/614 - 14s - loss: 3.2824 - accuracy1000: 0.3799 - val_loss: 3.3272 - val_accuracy1000: 0.3531 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 3.2810 - accuracy1000: 0.3777 - val_loss: 3.3180 - val_accuracy1000: 0.3598 - 14s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 3.2749 - accuracy1000: 0.3791 - val_loss: 3.3157 - val_accuracy1000: 0.3642 - 14s/epoch - 22ms/step
Epoch 7/50
614/614 - 14s - loss: 3.2673 - accuracy1000: 0.3860 - val_loss: 3.3159 - val_accuracy1000: 0.3628 - 14s/epoch - 22ms/step
Epoch 8/50
614/614 - 14s - loss: 3.2693 - accuracy1000: 0.3848 - val_loss: 3.3121 - val_accuracy1000: 0.3603 - 14s/epoch - 22ms/step
Epoch 9/50
614/614 - 14s - loss: 3.2647 - accuracy1000: 0.3869 - val_loss: 3.3097 - val_accuracy1000: 0.3615 - 14s/epoch - 22ms/step
Epoch 10/50
614/614 - 14s - loss: 3.2599 - accuracy1000: 0.3912 - val_loss: 3.3161 - val_accuracy1000: 0.3605 - 14s/epoch - 22ms/step
Epoch 11/50
614/614 - 14s - loss: 3.2556 - accuracy1000: 0.3930 - val_loss: 3.3125 - val_accuracy1000: 0.3615 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 14s - loss: 3.2539 - accuracy1000: 0.3967 - val_loss: 3.3168 - val_accuracy1000: 0.3589 - 14s/epoch - 22ms/step
Epoch 13/50
614/614 - 14s - loss: 3.2481 - accuracy1000: 0.3995 - val_loss: 3.3233 - val_accuracy1000: 0.3610 - 14s/epoch - 22ms/step
Epoch 14/50
614/614 - 14s - loss: 3.2456 - accuracy1000: 0.4017 - val_loss: 3.3290 - val_accuracy1000: 0.3626 - 14s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 3.2423 - accuracy1000: 0.4030 - val_loss: 3.3466 - val_accuracy1000: 0.3621 - 14s/epoch - 22ms/step
Epoch 16/50
614/614 - 13s - loss: 3.2405 - accuracy1000: 0.4035 - val_loss: 3.3448 - val_accuracy1000: 0.3609 - 13s/epoch - 22ms/step
Epoch 17/50
614/614 - 14s - loss: 3.2377 - accuracy1000: 0.4046 - val_loss: 3.3467 - val_accuracy1000: 0.3652 - 14s/epoch - 23ms/step
Epoch 18/50
614/614 - 14s - loss: 3.2336 - accuracy1000: 0.4081 - val_loss: 3.3454 - val_accuracy1000: 0.3625 - 14s/epoch - 23ms/step
Epoch 19/50
614/614 - 14s - loss: 3.2309 - accuracy1000: 0.4097 - val_loss: 3.3536 - val_accuracy1000: 0.3650 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W8/deepOF_L2/h1000
Evaluating performance on  test set...
2179/2179 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0914977
{'0': {'precision': 0.4005627489863802, 'recall': 0.5314828972238769, 'f1-score': 0.4568279487530941, 'support': 213211}, '1': {'precision': 0.33832501386577923, 'recall': 0.05119497992227143, 'f1-score': 0.08893275091540172, 'support': 154898}, '2': {'precision': 0.3661047013390922, 'recall': 0.4853426549829701, 'f1-score': 0.4173745480101109, 'support': 189666}, 'accuracy': 0.38241405584689164, 'macro avg': {'precision': 0.3683308213970839, 'recall': 0.35600684404303945, 'f1-score': 0.3210450825595356, 'support': 557775}, 'weighted avg': {'precision': 0.37156177052771605, 'recall': 0.38241405584689164, 'f1-score': 0.3412451437511103, 'support': 557775}}
[[113318   7846  92047]
 [ 79629   7930  67339]
 [ 89950   7663  92053]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050849
{'0': {'precision': 0.36446146210026237, 'recall': 0.5835272747913947, 'f1-score': 0.44868297579817995, 'support': 52851}, '1': {'precision': 0.35174418604651164, 'recall': 0.043786306066088944, 'f1-score': 0.07787808472078725, 'support': 52505}, '2': {'precision': 0.35613529500985897, 'recall': 0.45391277451283635, 'f1-score': 0.3991228815720138, 'support': 51728}, 'accuracy': 0.360437727585241, 'macro avg': {'precision': 0.35744698105221095, 'recall': 0.36040878512343993, 'f1-score': 0.308561314030327, 'support': 157084}, 'weighted avg': {'precision': 0.35746891957235016, 'recall': 0.360437727585241, 'f1-score': 0.30842199848572527, 'support': 157084}}
[[30840  2078 19933]
 [27689  2299 22517]
 [26089  2159 23480]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038511
{'0': {'precision': 0.3758839307485979, 'recall': 0.5420500498153901, 'f1-score': 0.44392714008015555, 'support': 17063}, '1': {'precision': 0.3133360356708553, 'recall': 0.04981954111884506, 'f1-score': 0.0859700828560307, 'support': 15516}, '2': {'precision': 0.34737283008330616, 'recall': 0.46705462737000186, 'f1-score': 0.3984199850539127, 'support': 15981}, 'accuracy': 0.36009060955518946, 'macro avg': {'precision': 0.3455309321675864, 'recall': 0.3529747394347456, 'f1-score': 0.309439069330033, 'support': 48560}, 'weighted avg': {'precision': 0.3465155403087651, 'recall': 0.36009060955518946, 'f1-score': 0.3145755843889713, 'support': 48560}}
[[9249  824 6990]
 [7710  773 7033]
 [7647  870 7464]]
training model: results/QRTEA/W8/deepVOL_L2/h10
Epoch 1/50
614/614 - 18s - loss: 2.9179 - accuracy10: 0.5109 - val_loss: 2.6068 - val_accuracy10: 0.6566 - 18s/epoch - 29ms/step
Epoch 2/50
614/614 - 13s - loss: 2.5704 - accuracy10: 0.6301 - val_loss: 2.5226 - val_accuracy10: 0.7296 - 13s/epoch - 22ms/step
Epoch 3/50
614/614 - 13s - loss: 2.4502 - accuracy10: 0.6692 - val_loss: 2.4677 - val_accuracy10: 0.7095 - 13s/epoch - 22ms/step
Epoch 4/50
614/614 - 14s - loss: 2.3876 - accuracy10: 0.6818 - val_loss: 2.4734 - val_accuracy10: 0.7164 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 14s - loss: 2.3488 - accuracy10: 0.6863 - val_loss: 2.4365 - val_accuracy10: 0.7299 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.3219 - accuracy10: 0.6913 - val_loss: 2.4262 - val_accuracy10: 0.7138 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 13s - loss: 2.2992 - accuracy10: 0.6934 - val_loss: 2.4073 - val_accuracy10: 0.7135 - 13s/epoch - 22ms/step
Epoch 8/50
614/614 - 13s - loss: 2.2838 - accuracy10: 0.6969 - val_loss: 2.4389 - val_accuracy10: 0.7065 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 14s - loss: 2.2619 - accuracy10: 0.6986 - val_loss: 2.4460 - val_accuracy10: 0.7153 - 14s/epoch - 22ms/step
Epoch 10/50
614/614 - 13s - loss: 2.2493 - accuracy10: 0.7030 - val_loss: 2.4172 - val_accuracy10: 0.7098 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 13s - loss: 2.2360 - accuracy10: 0.7028 - val_loss: 2.4240 - val_accuracy10: 0.7026 - 13s/epoch - 22ms/step
Epoch 12/50
614/614 - 13s - loss: 2.2208 - accuracy10: 0.7054 - val_loss: 2.4253 - val_accuracy10: 0.7225 - 13s/epoch - 21ms/step
Epoch 13/50
614/614 - 13s - loss: 2.2121 - accuracy10: 0.7046 - val_loss: 2.3993 - val_accuracy10: 0.7188 - 13s/epoch - 22ms/step
Epoch 14/50
614/614 - 13s - loss: 2.1995 - accuracy10: 0.7066 - val_loss: 2.4138 - val_accuracy10: 0.7117 - 13s/epoch - 21ms/step
Epoch 15/50
614/614 - 14s - loss: 2.1860 - accuracy10: 0.7063 - val_loss: 2.4228 - val_accuracy10: 0.7290 - 14s/epoch - 23ms/step
Epoch 16/50
614/614 - 14s - loss: 2.1742 - accuracy10: 0.7084 - val_loss: 2.4108 - val_accuracy10: 0.7269 - 14s/epoch - 23ms/step
Epoch 17/50
614/614 - 13s - loss: 2.1625 - accuracy10: 0.7072 - val_loss: 2.4343 - val_accuracy10: 0.7193 - 13s/epoch - 22ms/step
Epoch 18/50
614/614 - 14s - loss: 2.1519 - accuracy10: 0.7098 - val_loss: 2.4602 - val_accuracy10: 0.7245 - 14s/epoch - 23ms/step
Epoch 19/50
614/614 - 14s - loss: 2.1420 - accuracy10: 0.7104 - val_loss: 2.4617 - val_accuracy10: 0.7289 - 14s/epoch - 22ms/step
Epoch 20/50
614/614 - 13s - loss: 2.1372 - accuracy10: 0.7099 - val_loss: 2.4271 - val_accuracy10: 0.7126 - 13s/epoch - 21ms/step
Epoch 21/50
614/614 - 14s - loss: 2.1264 - accuracy10: 0.7099 - val_loss: 2.4471 - val_accuracy10: 0.7267 - 14s/epoch - 23ms/step
Epoch 22/50
614/614 - 13s - loss: 2.1163 - accuracy10: 0.7109 - val_loss: 2.4409 - val_accuracy10: 0.7297 - 13s/epoch - 21ms/step
Epoch 23/50
614/614 - 13s - loss: 2.1050 - accuracy10: 0.7110 - val_loss: 2.4398 - val_accuracy10: 0.7174 - 13s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h10
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64799553
{'0': {'precision': 0.36115062811949944, 'recall': 0.6027242912617452, 'f1-score': 0.4516649453059625, 'support': 49701}, '1': {'precision': 0.9305740847733599, 'recall': 0.7717676577375183, 'f1-score': 0.8437635802755761, 'support': 459133}, '2': {'precision': 0.3326174325387543, 'recall': 0.6391533526743759, 'f1-score': 0.4375384615384615, 'support': 48946}, 'accuracy': 0.7450679479364624, 'macro avg': {'precision': 0.5414473818105379, 'recall': 0.6712151005578798, 'f1-score': 0.5776556623733333, 'support': 557780}, 'weighted avg': {'precision': 0.8273640350773713, 'recall': 0.7450679479364624, 'f1-score': 0.7731787817558521, 'support': 557780}}
[[ 29956  14262   5483]
 [ 47502 354344  57287]
 [  5488  12174  31284]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7156868
{'0': {'precision': 0.36525128598357776, 'recall': 0.6347584675180455, 'f1-score': 0.4636881705165386, 'support': 18010}, '1': {'precision': 0.9114465998634033, 'recall': 0.740092043836705, 'f1-score': 0.8168799192365848, 'support': 120812}, '2': {'precision': 0.37809238325688904, 'recall': 0.573172734738571, 'f1-score': 0.4556295425860643, 'support': 18265}, 'accuracy': 0.7086073322426426, 'macro avg': {'precision': 0.5515967563679567, 'recall': 0.6493410820311071, 'f1-score': 0.5787325441130625, 'support': 157087}, 'weighted avg': {'precision': 0.7868106187236932, 'recall': 0.7086073322426426, 'f1-score': 0.7343828219340086, 'support': 157087}}
[[11432  4380  2198]
 [16378 89412 15022]
 [ 3489  4307 10469]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7074058
{'0': {'precision': 0.33063173087598535, 'recall': 0.5846093443266588, 'f1-score': 0.42238139139068154, 'support': 5094}, '1': {'precision': 0.9135204803369904, 'recall': 0.7597187001647016, 'f1-score': 0.8295509691416174, 'support': 38251}, '2': {'precision': 0.3760010333247223, 'recall': 0.5581975071907957, 'f1-score': 0.4493324071930231, 'support': 5215}, 'accuracy': 0.7197075782537068, 'macro avg': {'precision': 0.540051081512566, 'recall': 0.634175183894052, 'f1-score': 0.5670882559084407, 'support': 48560}, 'weighted avg': {'precision': 0.7946489975131985, 'recall': 0.7197075782537068, 'f1-score': 0.7460056308050198, 'support': 48560}}
[[ 2978  1382   734]
 [ 5094 29060  4097]
 [  935  1369  2911]]
training model: results/QRTEA/W8/deepVOL_L2/h20
Epoch 1/50
614/614 - 16s - loss: 2.9167 - accuracy20: 0.5226 - val_loss: 2.6392 - val_accuracy20: 0.6464 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 13s - loss: 2.6559 - accuracy20: 0.6091 - val_loss: 2.6621 - val_accuracy20: 0.6111 - 13s/epoch - 22ms/step
Epoch 3/50
614/614 - 14s - loss: 2.5627 - accuracy20: 0.6320 - val_loss: 2.4870 - val_accuracy20: 0.6370 - 14s/epoch - 22ms/step
Epoch 4/50
614/614 - 13s - loss: 2.5129 - accuracy20: 0.6474 - val_loss: 2.4912 - val_accuracy20: 0.6513 - 13s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 2.4717 - accuracy20: 0.6545 - val_loss: 2.4951 - val_accuracy20: 0.6764 - 14s/epoch - 23ms/step
Epoch 6/50
614/614 - 14s - loss: 2.4446 - accuracy20: 0.6583 - val_loss: 2.5120 - val_accuracy20: 0.6663 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 13s - loss: 2.4254 - accuracy20: 0.6628 - val_loss: 2.5040 - val_accuracy20: 0.6688 - 13s/epoch - 22ms/step
Epoch 8/50
614/614 - 14s - loss: 2.4072 - accuracy20: 0.6650 - val_loss: 2.5237 - val_accuracy20: 0.6635 - 14s/epoch - 22ms/step
Epoch 9/50
614/614 - 13s - loss: 2.3940 - accuracy20: 0.6672 - val_loss: 2.5097 - val_accuracy20: 0.6636 - 13s/epoch - 22ms/step
Epoch 10/50
614/614 - 13s - loss: 2.3828 - accuracy20: 0.6694 - val_loss: 2.4876 - val_accuracy20: 0.6702 - 13s/epoch - 22ms/step
Epoch 11/50
614/614 - 14s - loss: 2.3680 - accuracy20: 0.6734 - val_loss: 2.5016 - val_accuracy20: 0.6819 - 14s/epoch - 23ms/step
Epoch 12/50
614/614 - 14s - loss: 2.3548 - accuracy20: 0.6726 - val_loss: 2.5143 - val_accuracy20: 0.6756 - 14s/epoch - 23ms/step
Epoch 13/50
614/614 - 13s - loss: 2.3434 - accuracy20: 0.6743 - val_loss: 2.5162 - val_accuracy20: 0.6559 - 13s/epoch - 21ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h20
Evaluating performance on  test set...
2179/2179 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77385753
{'0': {'precision': 0.3529596356268044, 'recall': 0.5708671693735499, 'f1-score': 0.4362139461699558, 'support': 68960}, '1': {'precision': 0.8825960790721459, 'recall': 0.6923091529221327, 'f1-score': 0.7759569673930103, 'support': 421319}, '2': {'precision': 0.3466306159999309, 'recall': 0.5944652671812269, 'f1-score': 0.43791470228741053, 'support': 67501}, 'accuracy': 0.6654541216967264, 'macro avg': {'precision': 0.5273954435662936, 'recall': 0.6192138631589699, 'f1-score': 0.5500285386167922, 'support': 557780}, 'weighted avg': {'precision': 0.7522544858582831, 'recall': 0.6654541216967264, 'f1-score': 0.6930445831547175, 'support': 557780}}
[[ 39367  21392   8201]
 [ 62201 291683  67435]
 [  9966  17408  40127]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84051096
{'0': {'precision': 0.3644822209928079, 'recall': 0.5990246321706068, 'f1-score': 0.4532065914136519, 'support': 24196}, '1': {'precision': 0.8507985882634443, 'recall': 0.6549034414801035, 'f1-score': 0.7401078200778469, 'support': 108587}, '2': {'precision': 0.37277685558453877, 'recall': 0.5174456879526004, 'f1-score': 0.4333563059958649, 'support': 24304}, 'accuracy': 0.6250294422835754, 'macro avg': {'precision': 0.5293525549469303, 'recall': 0.5904579205344368, 'f1-score': 0.5422235724957879, 'support': 157087}, 'weighted avg': {'precision': 0.701933621630251, 'recall': 0.6250294422835754, 'f1-score': 0.6484570092086639, 'support': 157087}}
[[14494  6437  3265]
 [19578 71114 17895]
 [ 5694  6034 12576]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82913953
{'0': {'precision': 0.3245570458685213, 'recall': 0.5804827484081149, 'f1-score': 0.41633476713929163, 'support': 6753}, '1': {'precision': 0.8662396801303173, 'recall': 0.6679226970397648, 'f1-score': 0.7542632410302699, 'support': 35031}, '2': {'precision': 0.38338084679548096, 'recall': 0.53586186540732, 'f1-score': 0.4469748261217456, 'support': 6776}, 'accuracy': 0.637335255354201, 'macro avg': {'precision': 0.5247258575981065, 'recall': 0.5947557702850665, 'f1-score': 0.539190944763769, 'support': 48560}, 'weighted avg': {'precision': 0.7235330433130447, 'recall': 0.637335255354201, 'f1-score': 0.6643905622080719, 'support': 48560}}
[[ 3920  1857   976]
 [ 6769 23398  4864]
 [ 1389  1756  3631]]
training model: results/QRTEA/W8/deepVOL_L2/h30
Epoch 1/50
614/614 - 15s - loss: 3.0192 - accuracy30: 0.4741 - val_loss: 2.8007 - val_accuracy30: 0.5836 - 15s/epoch - 25ms/step
Epoch 2/50
614/614 - 15s - loss: 2.7581 - accuracy30: 0.5788 - val_loss: 2.7655 - val_accuracy30: 0.6083 - 15s/epoch - 24ms/step
Epoch 3/50
614/614 - 13s - loss: 2.6580 - accuracy30: 0.6079 - val_loss: 2.7690 - val_accuracy30: 0.6252 - 13s/epoch - 21ms/step
Epoch 4/50
614/614 - 13s - loss: 2.6070 - accuracy30: 0.6177 - val_loss: 2.7343 - val_accuracy30: 0.6338 - 13s/epoch - 21ms/step
Epoch 5/50
614/614 - 13s - loss: 2.5739 - accuracy30: 0.6253 - val_loss: 2.7111 - val_accuracy30: 0.6502 - 13s/epoch - 21ms/step
Epoch 6/50
614/614 - 14s - loss: 2.5517 - accuracy30: 0.6301 - val_loss: 2.7191 - val_accuracy30: 0.6642 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 15s - loss: 2.5321 - accuracy30: 0.6324 - val_loss: 2.6760 - val_accuracy30: 0.6654 - 15s/epoch - 24ms/step
Epoch 8/50
614/614 - 13s - loss: 2.5176 - accuracy30: 0.6361 - val_loss: 2.6531 - val_accuracy30: 0.6676 - 13s/epoch - 22ms/step
Epoch 9/50
614/614 - 13s - loss: 2.5055 - accuracy30: 0.6362 - val_loss: 2.6356 - val_accuracy30: 0.6590 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 2.4897 - accuracy30: 0.6391 - val_loss: 2.6365 - val_accuracy30: 0.6667 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 14s - loss: 2.4775 - accuracy30: 0.6412 - val_loss: 2.6668 - val_accuracy30: 0.6549 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 13s - loss: 2.4652 - accuracy30: 0.6415 - val_loss: 2.6641 - val_accuracy30: 0.6683 - 13s/epoch - 22ms/step
Epoch 13/50
614/614 - 14s - loss: 2.4531 - accuracy30: 0.6436 - val_loss: 2.6684 - val_accuracy30: 0.6543 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 13s - loss: 2.4439 - accuracy30: 0.6446 - val_loss: 2.6907 - val_accuracy30: 0.6680 - 13s/epoch - 21ms/step
Epoch 15/50
614/614 - 13s - loss: 2.4311 - accuracy30: 0.6472 - val_loss: 2.7037 - val_accuracy30: 0.6665 - 13s/epoch - 21ms/step
Epoch 16/50
614/614 - 13s - loss: 2.4190 - accuracy30: 0.6465 - val_loss: 2.6548 - val_accuracy30: 0.6589 - 13s/epoch - 21ms/step
Epoch 17/50
614/614 - 15s - loss: 2.4129 - accuracy30: 0.6492 - val_loss: 2.7095 - val_accuracy30: 0.6699 - 15s/epoch - 24ms/step
Epoch 18/50
614/614 - 14s - loss: 2.4000 - accuracy30: 0.6514 - val_loss: 2.7237 - val_accuracy30: 0.6761 - 14s/epoch - 22ms/step
Epoch 19/50
614/614 - 14s - loss: 2.3929 - accuracy30: 0.6490 - val_loss: 2.6964 - val_accuracy30: 0.6751 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h30
Evaluating performance on  test set...
2179/2179 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7540511
{'0': {'precision': 0.4324131136139714, 'recall': 0.5254595394041834, 'f1-score': 0.4744171259008054, 'support': 85194}, '1': {'precision': 0.8259378027568937, 'recall': 0.7479950742707612, 'f1-score': 0.7850365376227121, 'support': 389790}, '2': {'precision': 0.4337172092288243, 'recall': 0.5303758635682884, 'f1-score': 0.4772011040838061, 'support': 82796}, 'accuracy': 0.6817024633367994, 'macro avg': {'precision': 0.5640227085332298, 'recall': 0.6012768257477443, 'f1-score': 0.5788849225357745, 'support': 557780}, 'weighted avg': {'precision': 0.7076111531305317, 'recall': 0.6817024633367994, 'f1-score': 0.6918986468458405, 'support': 557780}}
[[ 44766  32777   7651]
 [ 48545 291561  49684]
 [ 10215  28668  43913]]
Evaluating performance on  train set...
614/614 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8346936
{'0': {'precision': 0.43092548450616647, 'recall': 0.572214959058694, 'f1-score': 0.49162011173184356, 'support': 29066}, '1': {'precision': 0.7859402577508409, 'recall': 0.7161656416895937, 'f1-score': 0.7494323925250461, 'support': 98864}, '2': {'precision': 0.46493451626531473, 'recall': 0.45292725589052374, 'f1-score': 0.4588523479439204, 'support': 29157}, 'accuracy': 0.6406704564986282, 'macro avg': {'precision': 0.5606000861741073, 'recall': 0.5804359522129371, 'f1-score': 0.5666349507336034, 'support': 157087}, 'weighted avg': {'precision': 0.6606693963579618, 'recall': 0.6406704564986282, 'f1-score': 0.6477943568289852, 'support': 157087}}
[[16632  9639  2795]
 [15658 70803 12403]
 [ 6306  9645 13206]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8109386
{'0': {'precision': 0.3944870390653523, 'recall': 0.5351659237246161, 'f1-score': 0.4541824295922657, 'support': 8076}, '1': {'precision': 0.80787193718695, 'recall': 0.7357600789051905, 'f1-score': 0.7701316298877274, 'support': 32444}, '2': {'precision': 0.47703574975173785, 'recall': 0.4779850746268657, 'f1-score': 0.4775099403578529, 'support': 8040}, 'accuracy': 0.6597199341021417, 'macro avg': {'precision': 0.5597982420013468, 'recall': 0.5829703590855574, 'f1-score': 0.5672746666126153, 'support': 48560}, 'weighted avg': {'precision': 0.6843460025862678, 'recall': 0.6597199341021417, 'f1-score': 0.6691373109955047, 'support': 48560}}
[[ 4322  2876   878]
 [ 5238 23871  3335]
 [ 1396  2801  3843]]
training model: results/QRTEA/W8/deepVOL_L2/h50
Epoch 1/50
614/614 - 16s - loss: 3.1287 - accuracy50: 0.4444 - val_loss: 2.9336 - val_accuracy50: 0.5209 - 16s/epoch - 25ms/step
Epoch 2/50
614/614 - 14s - loss: 2.9444 - accuracy50: 0.5197 - val_loss: 2.8638 - val_accuracy50: 0.5896 - 14s/epoch - 22ms/step
Epoch 3/50
614/614 - 13s - loss: 2.8425 - accuracy50: 0.5574 - val_loss: 2.8708 - val_accuracy50: 0.6039 - 13s/epoch - 21ms/step
Epoch 4/50
614/614 - 14s - loss: 2.7873 - accuracy50: 0.5711 - val_loss: 2.8811 - val_accuracy50: 0.6155 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 13s - loss: 2.7566 - accuracy50: 0.5782 - val_loss: 2.8187 - val_accuracy50: 0.6165 - 13s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 2.7303 - accuracy50: 0.5825 - val_loss: 2.8145 - val_accuracy50: 0.6082 - 14s/epoch - 22ms/step
Epoch 7/50
614/614 - 13s - loss: 2.7104 - accuracy50: 0.5849 - val_loss: 2.8154 - val_accuracy50: 0.6035 - 13s/epoch - 21ms/step
Epoch 8/50
614/614 - 13s - loss: 2.6955 - accuracy50: 0.5870 - val_loss: 2.8183 - val_accuracy50: 0.6071 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 13s - loss: 2.6833 - accuracy50: 0.5892 - val_loss: 2.7945 - val_accuracy50: 0.6078 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 2.6731 - accuracy50: 0.5915 - val_loss: 2.7945 - val_accuracy50: 0.6107 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 13s - loss: 2.6565 - accuracy50: 0.5950 - val_loss: 2.8026 - val_accuracy50: 0.6104 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 2.6440 - accuracy50: 0.5963 - val_loss: 2.8079 - val_accuracy50: 0.6014 - 13s/epoch - 21ms/step
Epoch 13/50
614/614 - 13s - loss: 2.6323 - accuracy50: 0.5978 - val_loss: 2.8385 - val_accuracy50: 0.6011 - 13s/epoch - 21ms/step
Epoch 14/50
614/614 - 13s - loss: 2.6265 - accuracy50: 0.5987 - val_loss: 2.8568 - val_accuracy50: 0.5982 - 13s/epoch - 21ms/step
Epoch 15/50
614/614 - 13s - loss: 2.6200 - accuracy50: 0.6014 - val_loss: 2.8617 - val_accuracy50: 0.6091 - 13s/epoch - 21ms/step
Epoch 16/50
614/614 - 13s - loss: 2.6125 - accuracy50: 0.6051 - val_loss: 2.8605 - val_accuracy50: 0.5960 - 13s/epoch - 21ms/step
Epoch 17/50
614/614 - 13s - loss: 2.6068 - accuracy50: 0.6036 - val_loss: 2.8549 - val_accuracy50: 0.5974 - 13s/epoch - 21ms/step
Epoch 18/50
614/614 - 13s - loss: 2.5951 - accuracy50: 0.6054 - val_loss: 2.8492 - val_accuracy50: 0.6072 - 13s/epoch - 21ms/step
Epoch 19/50
614/614 - 13s - loss: 2.5866 - accuracy50: 0.6068 - val_loss: 2.8516 - val_accuracy50: 0.6078 - 13s/epoch - 21ms/step
Epoch 20/50
614/614 - 13s - loss: 2.5728 - accuracy50: 0.6107 - val_loss: 2.8753 - val_accuracy50: 0.6015 - 13s/epoch - 21ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h50
Evaluating performance on  test set...
2179/2179 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8342126
{'0': {'precision': 0.47844237680303253, 'recall': 0.4321874861030818, 'f1-score': 0.45414018691588787, 'support': 112435}, '1': {'precision': 0.7157544720058274, 'recall': 0.7644618650988078, 'f1-score': 0.7393067957791476, 'support': 336765}, '2': {'precision': 0.4739415536655859, 'recall': 0.42135752440596796, 'f1-score': 0.4461053175566639, 'support': 108580}, 'accuracy': 0.6306931048083474, 'macro avg': {'precision': 0.5560461341581485, 'recall': 0.5393356252026192, 'f1-score': 0.546517433417233, 'support': 557780}, 'weighted avg': {'precision': 0.620845669077236, 'recall': 0.6306931048083474, 'f1-score': 0.624748145105158, 'support': 557780}}
[[ 48593  53671  10171]
 [ 38710 257444  40611]
 [ 14262  48567  45751]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8973469
{'0': {'precision': 0.4784386617100372, 'recall': 0.48772433207914895, 'f1-score': 0.4830368751926866, 'support': 36943}, '1': {'precision': 0.670577971646674, 'recall': 0.736528165387057, 'f1-score': 0.7020075461358876, 'support': 83489}, '2': {'precision': 0.49615897861290437, 'recall': 0.37531032601282227, 'f1-score': 0.4273554720263427, 'support': 36655}, 'accuracy': 0.5937283161560154, 'macro avg': {'precision': 0.5483918706565385, 'recall': 0.5331876078263428, 'f1-score': 0.5374666311183057, 'support': 157087}, 'weighted avg': {'precision': 0.5846922477061697, 'recall': 0.5937283161560154, 'f1-score': 0.5864231548550047, 'support': 157087}}
[[18018 15027  3898]
 [11925 61492 10072]
 [ 7717 15181 13757]]
Evaluating performance on  val set...
190/190 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87339157
{'0': {'precision': 0.4310454835475344, 'recall': 0.46330949348486333, 'f1-score': 0.4465955236566248, 'support': 10207}, '1': {'precision': 0.7061689402593911, 'recall': 0.7434382737884684, 'f1-score': 0.7243245106148333, 'support': 28270}, '2': {'precision': 0.49137600613261784, 'recall': 0.38143409699494196, 'f1-score': 0.42948073701842543, 'support': 10083}, 'accuracy': 0.6093904448105436, 'macro avg': {'precision': 0.5428634766465145, 'recall': 0.5293939547560912, 'f1-score': 0.5334669237632945, 'support': 48560}, 'weighted avg': {'precision': 0.6037401454188192, 'recall': 0.6093904448105436, 'f1-score': 0.6047262911120529, 'support': 48560}}
[[ 4729  4360  1118]
 [ 4390 21017  2863]
 [ 1852  4385  3846]]
training model: results/QRTEA/W8/deepVOL_L2/h100
Epoch 1/50
614/614 - 16s - loss: 3.2321 - accuracy100: 0.4122 - val_loss: 3.2007 - val_accuracy100: 0.4505 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 13s - loss: 3.0870 - accuracy100: 0.4656 - val_loss: 3.1194 - val_accuracy100: 0.4954 - 13s/epoch - 22ms/step
Epoch 3/50
614/614 - 13s - loss: 3.0360 - accuracy100: 0.4823 - val_loss: 3.0844 - val_accuracy100: 0.5051 - 13s/epoch - 21ms/step
Epoch 4/50
614/614 - 13s - loss: 2.9890 - accuracy100: 0.4929 - val_loss: 3.1128 - val_accuracy100: 0.5046 - 13s/epoch - 21ms/step
Epoch 5/50
614/614 - 13s - loss: 2.9604 - accuracy100: 0.5021 - val_loss: 3.0950 - val_accuracy100: 0.5108 - 13s/epoch - 21ms/step
Epoch 6/50
614/614 - 13s - loss: 2.9387 - accuracy100: 0.5067 - val_loss: 3.0978 - val_accuracy100: 0.5098 - 13s/epoch - 21ms/step
Epoch 7/50
614/614 - 13s - loss: 2.9238 - accuracy100: 0.5095 - val_loss: 3.1137 - val_accuracy100: 0.5102 - 13s/epoch - 21ms/step
Epoch 8/50
614/614 - 13s - loss: 2.9130 - accuracy100: 0.5127 - val_loss: 3.1254 - val_accuracy100: 0.5122 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 13s - loss: 2.9019 - accuracy100: 0.5152 - val_loss: 3.1326 - val_accuracy100: 0.5089 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 2.8925 - accuracy100: 0.5185 - val_loss: 3.1302 - val_accuracy100: 0.5073 - 13s/epoch - 22ms/step
Epoch 11/50
614/614 - 13s - loss: 2.8862 - accuracy100: 0.5196 - val_loss: 3.1272 - val_accuracy100: 0.5093 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 2.8745 - accuracy100: 0.5229 - val_loss: 3.1346 - val_accuracy100: 0.5066 - 13s/epoch - 21ms/step
Epoch 13/50
614/614 - 13s - loss: 2.8685 - accuracy100: 0.5240 - val_loss: 3.1345 - val_accuracy100: 0.5018 - 13s/epoch - 21ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h100
Evaluating performance on  test set...
2179/2179 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0031677
{'0': {'precision': 0.45857835551428866, 'recall': 0.30733402893886635, 'f1-score': 0.3680231223444492, 'support': 159094}, '1': {'precision': 0.5204774969042231, 'recall': 0.7890893053667378, 'f1-score': 0.6272352441722842, 'support': 247152}, '2': {'precision': 0.5143290649156999, 'recall': 0.25949291908086636, 'f1-score': 0.3449494927342348, 'support': 151534}, 'accuracy': 0.50780235935315, 'macro avg': {'precision': 0.4977949724447372, 'recall': 0.45197208446215686, 'f1-score': 0.44673595308365605, 'support': 557780}, 'weighted avg': {'precision': 0.501151815644158, 'recall': 0.50780235935315, 'f1-score': 0.47661137388562824, 'support': 557780}}
[[ 48895  93960  16239]
 [ 31235 195025  20892]
 [ 26493  85719  39322]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0326866
{'0': {'precision': 0.4613488335884994, 'recall': 0.3658606852556847, 'f1-score': 0.40809346738282143, 'support': 48595}, '1': {'precision': 0.488514659811197, 'recall': 0.7679193730469069, 'f1-score': 0.5971501272264631, 'support': 61121}, '2': {'precision': 0.4849361399136665, 'recall': 0.23003525363619093, 'f1-score': 0.31204719223389943, 'support': 47371}, 'accuracy': 0.4813383666375957, 'macro avg': {'precision': 0.4782665444377876, 'recall': 0.4546051039795942, 'f1-score': 0.439096928947728, 'support': 157087}, 'weighted avg': {'precision': 0.47903175294202316, 'recall': 0.4813383666375957, 'f1-score': 0.45268992670933245, 'support': 157087}}
[[17779 24962  5854]
 [ 8465 46936  5720]
 [12293 24181 10897]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0084616
{'0': {'precision': 0.4304201680672269, 'recall': 0.3717790520432605, 'f1-score': 0.3989562643611014, 'support': 13777}, '1': {'precision': 0.5294710819074882, 'recall': 0.7638198029094322, 'f1-score': 0.6254130484899715, 'support': 21310}, '2': {'precision': 0.5157147685028726, 'recall': 0.22652712833073554, 'f1-score': 0.31478520963333506, 'support': 13473}, 'accuracy': 0.5035214168039539, 'macro avg': {'precision': 0.4918686728258625, 'recall': 0.4540419944278094, 'f1-score': 0.44638484082813595, 'support': 48560}, 'weighted avg': {'precision': 0.4975525635698097, 'recall': 0.5035214168039539, 'f1-score': 0.47498092353406324, 'support': 48560}}
[[ 5122  7300  1355]
 [ 3522 16277  1511]
 [ 3256  7165  3052]]
training model: results/QRTEA/W8/deepVOL_L2/h200
Epoch 1/50
614/614 - 16s - loss: 3.3035 - accuracy200: 0.3766 - val_loss: 3.3274 - val_accuracy200: 0.3635 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 13s - loss: 3.2372 - accuracy200: 0.3943 - val_loss: 3.2808 - val_accuracy200: 0.3804 - 13s/epoch - 21ms/step
Epoch 3/50
614/614 - 13s - loss: 3.2050 - accuracy200: 0.4127 - val_loss: 3.2238 - val_accuracy200: 0.4120 - 13s/epoch - 22ms/step
Epoch 4/50
614/614 - 13s - loss: 3.1726 - accuracy200: 0.4234 - val_loss: 3.2189 - val_accuracy200: 0.4158 - 13s/epoch - 21ms/step
Epoch 5/50
614/614 - 13s - loss: 3.1520 - accuracy200: 0.4302 - val_loss: 3.2437 - val_accuracy200: 0.4113 - 13s/epoch - 22ms/step
Epoch 6/50
614/614 - 13s - loss: 3.1372 - accuracy200: 0.4348 - val_loss: 3.2327 - val_accuracy200: 0.4159 - 13s/epoch - 21ms/step
Epoch 7/50
614/614 - 14s - loss: 3.1217 - accuracy200: 0.4396 - val_loss: 3.2498 - val_accuracy200: 0.4146 - 14s/epoch - 23ms/step
Epoch 8/50
614/614 - 13s - loss: 3.1089 - accuracy200: 0.4429 - val_loss: 3.2517 - val_accuracy200: 0.4197 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 13s - loss: 3.0958 - accuracy200: 0.4496 - val_loss: 3.2559 - val_accuracy200: 0.4227 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 3.0861 - accuracy200: 0.4534 - val_loss: 3.2743 - val_accuracy200: 0.4213 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 13s - loss: 3.0770 - accuracy200: 0.4570 - val_loss: 3.2977 - val_accuracy200: 0.4235 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 3.0661 - accuracy200: 0.4582 - val_loss: 3.2733 - val_accuracy200: 0.4235 - 13s/epoch - 21ms/step
Epoch 13/50
614/614 - 14s - loss: 3.0532 - accuracy200: 0.4643 - val_loss: 3.2862 - val_accuracy200: 0.4212 - 14s/epoch - 23ms/step
Epoch 14/50
614/614 - 13s - loss: 3.0400 - accuracy200: 0.4694 - val_loss: 3.3014 - val_accuracy200: 0.4164 - 13s/epoch - 22ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h200
Evaluating performance on  test set...
2179/2179 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901103
{'0': {'precision': 0.44850029405998826, 'recall': 0.17902622504395185, 'f1-score': 0.2559041319602389, 'support': 191687}, '1': {'precision': 0.3796195400978742, 'recall': 0.7284024272914416, 'f1-score': 0.4991160872127283, 'support': 186051}, '2': {'precision': 0.44528307959702595, 'recall': 0.3073616156230213, 'f1-score': 0.3636853554505485, 'support': 180042}, 'accuracy': 0.40369859084226756, 'macro avg': {'precision': 0.4244676379182961, 'recall': 0.40493008931947155, 'f1-score': 0.37290185820783855, 'support': 557780}, 'weighted avg': {'precision': 0.42448622600135233, 'recall': 0.40369859084226756, 'f1-score': 0.37181896312364243, 'support': 557780}}
[[ 34317 121910  35460]
 [ 17053 135520  33478]
 [ 25145  99559  55338]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874434
{'0': {'precision': 0.4517220923334613, 'recall': 0.2372356412417989, 'f1-score': 0.31109188565660933, 'support': 54566}, '1': {'precision': 0.3786588247650055, 'recall': 0.7159964253798033, 'f1-score': 0.495349316480044, 'support': 50355}, '2': {'precision': 0.4234833659491194, 'recall': 0.26963922861634015, 'f1-score': 0.32948782516016445, 'support': 52166}, 'accuracy': 0.4014654299846582, 'macro avg': {'precision': 0.4179547610158621, 'recall': 0.4076237650793142, 'f1-score': 0.3786430090989393, 'support': 157087}, 'weighted avg': {'precision': 0.418923692472396, 'recall': 0.4014654299846582, 'f1-score': 0.3762654869683443, 'support': 157087}}
[[12945 31288 10333]
 [ 5485 36054  8816]
 [10227 27873 14066]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0768795
{'0': {'precision': 0.42352541605343597, 'recall': 0.23001721593703886, 'f1-score': 0.29812328166713153, 'support': 16264}, '1': {'precision': 0.39689629315684805, 'recall': 0.7267191977077364, 'f1-score': 0.5134001054296258, 'support': 16752}, '2': {'precision': 0.4676386127678374, 'recall': 0.27238805970149255, 'f1-score': 0.3442556305390682, 'support': 15544}, 'accuracy': 0.4149299835255354, 'macro avg': {'precision': 0.4293534406593738, 'recall': 0.4097081577820893, 'f1-score': 0.3852596725452752, 'support': 48560}, 'weighted avg': {'precision': 0.4284596101013152, 'recall': 0.4149299835255354, 'f1-score': 0.3871553776830847, 'support': 48560}}
[[ 3741 10053  2470]
 [ 2228 12174  2350]
 [ 2864  8446  4234]]
training model: results/QRTEA/W8/deepVOL_L2/h300
Epoch 1/50
614/614 - 16s - loss: 3.3098 - accuracy300: 0.3701 - val_loss: 3.3327 - val_accuracy300: 0.3565 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 13s - loss: 3.2876 - accuracy300: 0.3704 - val_loss: 3.3024 - val_accuracy300: 0.3581 - 13s/epoch - 22ms/step
Epoch 3/50
614/614 - 14s - loss: 3.2766 - accuracy300: 0.3704 - val_loss: 3.3161 - val_accuracy300: 0.3611 - 14s/epoch - 22ms/step
Epoch 4/50
614/614 - 14s - loss: 3.2586 - accuracy300: 0.3840 - val_loss: 3.3207 - val_accuracy300: 0.3619 - 14s/epoch - 22ms/step
Epoch 5/50
614/614 - 13s - loss: 3.2442 - accuracy300: 0.3927 - val_loss: 3.3208 - val_accuracy300: 0.3664 - 13s/epoch - 21ms/step
Epoch 6/50
614/614 - 13s - loss: 3.2289 - accuracy300: 0.4031 - val_loss: 3.3353 - val_accuracy300: 0.3670 - 13s/epoch - 22ms/step
Epoch 7/50
614/614 - 14s - loss: 3.2148 - accuracy300: 0.4111 - val_loss: 3.3524 - val_accuracy300: 0.3728 - 14s/epoch - 24ms/step
Epoch 8/50
614/614 - 14s - loss: 3.1997 - accuracy300: 0.4196 - val_loss: 3.3680 - val_accuracy300: 0.3690 - 14s/epoch - 23ms/step
Epoch 9/50
614/614 - 14s - loss: 3.1912 - accuracy300: 0.4205 - val_loss: 3.3815 - val_accuracy300: 0.3702 - 14s/epoch - 23ms/step
Epoch 10/50
614/614 - 13s - loss: 3.1863 - accuracy300: 0.4254 - val_loss: 3.4249 - val_accuracy300: 0.3704 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 13s - loss: 3.1624 - accuracy300: 0.4360 - val_loss: 3.4500 - val_accuracy300: 0.3671 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 3.1522 - accuracy300: 0.4402 - val_loss: 3.4505 - val_accuracy300: 0.3661 - 13s/epoch - 21ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h300
Evaluating performance on  test set...
2179/2179 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1049948
{'0': {'precision': 0.372659206981472, 'recall': 0.11821670878642661, 'f1-score': 0.1794936094161104, 'support': 190726}, '1': {'precision': 0.34778486704969896, 'recall': 0.8551299262173103, 'f1-score': 0.4944676869289984, 'support': 192186}, '2': {'precision': 0.37562671842147827, 'recall': 0.053125786307386146, 'f1-score': 0.0930861723446894, 'support': 174868}, 'accuracy': 0.35171752303775683, 'macro avg': {'precision': 0.3653569308175497, 'recall': 0.34215747377037437, 'f1-score': 0.25568248956326606, 'support': 557780}, 'weighted avg': {'precision': 0.3650189597448613, 'recall': 0.35171752303775683, 'f1-score': 0.2609302194686161, 'support': 557780}}
[[ 22547 160443   7736]
 [ 20136 164344   7706]
 [ 17820 147758   9290]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046593
{'0': {'precision': 0.3808681987821646, 'recall': 0.1455050277652709, 'f1-score': 0.21056632459141014, 'support': 53304}, '1': {'precision': 0.3424024839899088, 'recall': 0.8386888238202076, 'f1-score': 0.48627762252024315, 'support': 52594}, '2': {'precision': 0.39047860217776653, 'recall': 0.06024731875988982, 'f1-score': 0.10438844415861356, 'support': 51189}, 'accuracy': 0.3498061583708391, 'macro avg': {'precision': 0.37124976164994666, 'recall': 0.3481470567817894, 'f1-score': 0.2670774637567556, 'support': 157087}, 'weighted avg': {'precision': 0.37112125050276257, 'recall': 0.3498061583708391, 'f1-score': 0.26827715032361343, 'support': 157087}}
[[ 7756 43027  2521]
 [ 6191 44110  2293]
 [ 6417 41688  3084]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998838
{'0': {'precision': 0.36988229273285567, 'recall': 0.17786391042204996, 'f1-score': 0.24021603656003326, 'support': 16254}, '1': {'precision': 0.3554070473876063, 'recall': 0.7889182058047494, 'f1-score': 0.49004789394132536, 'support': 17055}, '2': {'precision': 0.3627858627858628, 'recall': 0.0686512359845256, 'f1-score': 0.11545459557810002, 'support': 15251}, 'accuracy': 0.3581754530477759, 'macro avg': {'precision': 0.36269173430210827, 'recall': 0.34514445073710825, 'f1-score': 0.28190617535981954, 'support': 48560}, 'weighted avg': {'precision': 0.36256962876076304, 'recall': 0.3581754530477759, 'f1-score': 0.2887775190810891, 'support': 48560}}
[[ 2891 12459   904]
 [ 2665 13455   935]
 [ 2260 11944  1047]]
training model: results/QRTEA/W8/deepVOL_L2/h500
Epoch 1/50
614/614 - 16s - loss: 3.3066 - accuracy500: 0.3836 - val_loss: 3.3112 - val_accuracy500: 0.3474 - 16s/epoch - 26ms/step
Epoch 2/50
614/614 - 13s - loss: 3.2931 - accuracy500: 0.3606 - val_loss: 3.3014 - val_accuracy500: 0.3454 - 13s/epoch - 22ms/step
Epoch 3/50
614/614 - 14s - loss: 3.2932 - accuracy500: 0.3575 - val_loss: 3.2980 - val_accuracy500: 0.3567 - 14s/epoch - 22ms/step
Epoch 4/50
614/614 - 13s - loss: 3.2827 - accuracy500: 0.3740 - val_loss: 3.2935 - val_accuracy500: 0.3607 - 13s/epoch - 22ms/step
Epoch 5/50
614/614 - 14s - loss: 3.2678 - accuracy500: 0.3851 - val_loss: 3.2922 - val_accuracy500: 0.3533 - 14s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 3.2584 - accuracy500: 0.3922 - val_loss: 3.2954 - val_accuracy500: 0.3588 - 14s/epoch - 24ms/step
Epoch 7/50
614/614 - 13s - loss: 3.2531 - accuracy500: 0.3932 - val_loss: 3.2939 - val_accuracy500: 0.3564 - 13s/epoch - 21ms/step
Epoch 8/50
614/614 - 13s - loss: 3.2471 - accuracy500: 0.3978 - val_loss: 3.3006 - val_accuracy500: 0.3525 - 13s/epoch - 21ms/step
Epoch 9/50
614/614 - 13s - loss: 3.2242 - accuracy500: 0.4114 - val_loss: 3.3221 - val_accuracy500: 0.3366 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 3.2135 - accuracy500: 0.4147 - val_loss: 3.3189 - val_accuracy500: 0.3460 - 13s/epoch - 22ms/step
Epoch 11/50
614/614 - 14s - loss: 3.1992 - accuracy500: 0.4203 - val_loss: 3.3323 - val_accuracy500: 0.3474 - 14s/epoch - 22ms/step
Epoch 12/50
614/614 - 14s - loss: 3.1834 - accuracy500: 0.4304 - val_loss: 3.3560 - val_accuracy500: 0.3454 - 14s/epoch - 22ms/step
Epoch 13/50
614/614 - 14s - loss: 3.1749 - accuracy500: 0.4334 - val_loss: 3.3732 - val_accuracy500: 0.3422 - 14s/epoch - 22ms/step
Epoch 14/50
614/614 - 13s - loss: 3.1637 - accuracy500: 0.4396 - val_loss: 3.3754 - val_accuracy500: 0.3421 - 13s/epoch - 22ms/step
Epoch 15/50
614/614 - 14s - loss: 3.1545 - accuracy500: 0.4446 - val_loss: 3.3878 - val_accuracy500: 0.3459 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h500
Evaluating performance on  test set...
2179/2179 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991389
{'0': {'precision': 0.39479909396549195, 'recall': 0.4437432646741867, 'f1-score': 0.41784278883861903, 'support': 212499}, '1': {'precision': 0.2740224959828602, 'recall': 0.14882668562932316, 'f1-score': 0.19289080664418426, 'support': 154690}, '2': {'precision': 0.35856582184725144, 'recall': 0.4419673541772697, 'f1-score': 0.3959220987372889, 'support': 190591}, 'accuracy': 0.3613467675427588, 'macro avg': {'precision': 0.3424624705985346, 'recall': 0.34484576816025986, 'f1-score': 0.33555189807336405, 'support': 557780}, 'weighted avg': {'precision': 0.34892317961176667, 'recall': 0.3613467675427588, 'f1-score': 0.34796629923203626, 'support': 557780}}
[[94295 33737 84467]
 [65448 23022 66220]
 [79100 27256 84235]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095638
{'0': {'precision': 0.3779510473324847, 'recall': 0.4861379874962787, 'f1-score': 0.4252718275929423, 'support': 53744}, '1': {'precision': 0.35059132720105124, 'recall': 0.15448158727707867, 'f1-score': 0.21446370676026905, 'support': 51812}, '2': {'precision': 0.3457753074667199, 'recall': 0.43701849372222545, 'f1-score': 0.38607920452597294, 'support': 51531}, 'accuracy': 0.36063455282741413, 'macro avg': {'precision': 0.35810589400008536, 'recall': 0.35921268949852764, 'f1-score': 0.3419382462930614, 'support': 157087}, 'weighted avg': {'precision': 0.35837202506792715, 'recall': 0.36063455282741413, 'f1-score': 0.3428841989804762, 'support': 157087}}
[[26127  7807 19810]
 [21009  8004 22799]
 [21992  7019 22520]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097109
{'0': {'precision': 0.3587228714524207, 'recall': 0.5108773181169758, 'f1-score': 0.42148881914476266, 'support': 16824}, '1': {'precision': 0.33193654594432803, 'recall': 0.14027321022008601, 'f1-score': 0.19720814439406062, 'support': 15812}, '2': {'precision': 0.3608103582989173, 'recall': 0.4059909570459683, 'f1-score': 0.38206961763489156, 'support': 15924}, 'accuracy': 0.35580724876441516, 'macro avg': {'precision': 0.35048992523188865, 'recall': 0.3523804951276767, 'f1-score': 0.3335888603912383, 'support': 48560}, 'weighted avg': {'precision': 0.35068530476398685, 'recall': 0.35580724876441516, 'f1-score': 0.3355325301414413, 'support': 48560}}
[[8595 2277 5952]
 [8093 2218 5501]
 [7272 2187 6465]]
training model: results/QRTEA/W8/deepVOL_L2/h1000
Epoch 1/50
614/614 - 16s - loss: 3.2938 - accuracy1000: 0.3981 - val_loss: 3.3305 - val_accuracy1000: 0.3354 - 16s/epoch - 25ms/step
Epoch 2/50
614/614 - 14s - loss: 3.2984 - accuracy1000: 0.3591 - val_loss: 3.3300 - val_accuracy1000: 0.3410 - 14s/epoch - 22ms/step
Epoch 3/50
614/614 - 13s - loss: 3.2992 - accuracy1000: 0.3534 - val_loss: 3.3306 - val_accuracy1000: 0.3390 - 13s/epoch - 22ms/step
Epoch 4/50
614/614 - 14s - loss: 3.2946 - accuracy1000: 0.3587 - val_loss: 3.3404 - val_accuracy1000: 0.3485 - 14s/epoch - 23ms/step
Epoch 5/50
614/614 - 13s - loss: 3.2924 - accuracy1000: 0.3615 - val_loss: 3.3363 - val_accuracy1000: 0.3435 - 13s/epoch - 22ms/step
Epoch 6/50
614/614 - 14s - loss: 3.2800 - accuracy1000: 0.3725 - val_loss: 3.3453 - val_accuracy1000: 0.3498 - 14s/epoch - 23ms/step
Epoch 7/50
614/614 - 13s - loss: 3.2750 - accuracy1000: 0.3739 - val_loss: 3.3691 - val_accuracy1000: 0.3446 - 13s/epoch - 22ms/step
Epoch 8/50
614/614 - 13s - loss: 3.2772 - accuracy1000: 0.3755 - val_loss: 3.4319 - val_accuracy1000: 0.3302 - 13s/epoch - 22ms/step
Epoch 9/50
614/614 - 13s - loss: 3.2674 - accuracy1000: 0.3846 - val_loss: 3.3309 - val_accuracy1000: 0.3472 - 13s/epoch - 21ms/step
Epoch 10/50
614/614 - 13s - loss: 3.2679 - accuracy1000: 0.3796 - val_loss: 3.3419 - val_accuracy1000: 0.3527 - 13s/epoch - 21ms/step
Epoch 11/50
614/614 - 13s - loss: 3.2552 - accuracy1000: 0.3924 - val_loss: 3.3542 - val_accuracy1000: 0.3476 - 13s/epoch - 21ms/step
Epoch 12/50
614/614 - 13s - loss: 3.2460 - accuracy1000: 0.3971 - val_loss: 3.3751 - val_accuracy1000: 0.3419 - 13s/epoch - 21ms/step
testing model: results/QRTEA/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
2179/2179 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0948087
{'0': {'precision': 0.38480775051130994, 'recall': 0.590356077519089, 'f1-score': 0.4659188285308701, 'support': 213212}, '1': {'precision': 0.19003931847968544, 'recall': 0.0009360877985797289, 'f1-score': 0.0018629989143213223, 'support': 154900}, '2': {'precision': 0.34593068772943164, 'recall': 0.4193380011388321, 'f1-score': 0.37911359823062846, 'support': 189668}, 'accuracy': 0.3685162608913909, 'macro avg': {'precision': 0.306925918906809, 'recall': 0.3368767221521669, 'f1-score': 0.2822984752252733, 'support': 557780}, 'weighted avg': {'precision': 0.3174991972010229, 'recall': 0.3685162608913909, 'f1-score': 0.3075294591949498, 'support': 557780}}
[[125871    269  87072]
 [ 91446    145  63309]
 [109784    349  79535]]
Evaluating performance on  train set...
614/614 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098083
{'0': {'precision': 0.34690117797501, 'recall': 0.6056380664080976, 'f1-score': 0.441129454565499, 'support': 52855}, '1': {'precision': 0.4876543209876543, 'recall': 0.0015041316019953543, 'f1-score': 0.002999012983068863, 'support': 52522}, '2': {'precision': 0.327017077094419, 'recall': 0.40883774898472247, 'f1-score': 0.36337853864796577, 'support': 51710}, 'accuracy': 0.3388631777295384, 'macro avg': {'precision': 0.3871908586856945, 'recall': 0.33865998233160516, 'f1-score': 0.26916900206551125, 'support': 157087}, 'weighted avg': {'precision': 0.3874164957337981, 'recall': 0.3388631777295384, 'f1-score': 0.26904655200266414, 'support': 157087}}
[[32011    37 20807]
 [29743    79 22700]
 [30523    46 21141]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101506
{'0': {'precision': 0.3546766297346045, 'recall': 0.6451461714218759, 'f1-score': 0.4577176465698194, 'support': 17069}, '1': {'precision': 0.30434782608695654, 'recall': 0.0009027598658756771, 'f1-score': 0.0018001800180018003, 'support': 15508}, '2': {'precision': 0.32422993244016945, 'recall': 0.3543139585809923, 'f1-score': 0.33860504050943224, 'support': 15983}, 'accuracy': 0.34367792421746296, 'macro avg': {'precision': 0.32775146275391015, 'recall': 0.3334542966229146, 'f1-score': 0.2660409556990845, 'support': 48560}, 'weighted avg': {'precision': 0.32858254715996116, 'recall': 0.34367792421746296, 'f1-score': 0.2729123571557182, 'support': 48560}}
[[11012    18  6039]
 [ 9730    14  5764]
 [10306    14  5663]]
training model: results/QRTEA/W8/deepVOL_L3/h10
Epoch 1/50
614/614 - 24s - loss: 3.2147 - accuracy10: 0.4589 - val_loss: 3.2912 - val_accuracy10: 0.7458 - 24s/epoch - 40ms/step
Epoch 2/50
614/614 - 22s - loss: 2.9277 - accuracy10: 0.4596 - val_loss: 3.0789 - val_accuracy10: 0.7429 - 22s/epoch - 35ms/step
Epoch 3/50
614/614 - 21s - loss: 2.7233 - accuracy10: 0.5556 - val_loss: 2.5797 - val_accuracy10: 0.6256 - 21s/epoch - 35ms/step
Epoch 4/50
614/614 - 22s - loss: 2.4682 - accuracy10: 0.6428 - val_loss: 2.4731 - val_accuracy10: 0.6569 - 22s/epoch - 35ms/step
Epoch 5/50
614/614 - 21s - loss: 2.3863 - accuracy10: 0.6607 - val_loss: 2.4245 - val_accuracy10: 0.6789 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 22s - loss: 2.3278 - accuracy10: 0.6788 - val_loss: 2.4007 - val_accuracy10: 0.6780 - 22s/epoch - 35ms/step
Epoch 7/50
614/614 - 21s - loss: 2.3048 - accuracy10: 0.6850 - val_loss: 2.3942 - val_accuracy10: 0.6776 - 21s/epoch - 34ms/step
Epoch 8/50
614/614 - 21s - loss: 2.2692 - accuracy10: 0.6930 - val_loss: 2.3504 - val_accuracy10: 0.6648 - 21s/epoch - 35ms/step
Epoch 9/50
614/614 - 21s - loss: 2.2602 - accuracy10: 0.6947 - val_loss: 2.3428 - val_accuracy10: 0.6959 - 21s/epoch - 34ms/step
Epoch 10/50
614/614 - 21s - loss: 2.2389 - accuracy10: 0.6965 - val_loss: 2.3198 - val_accuracy10: 0.6840 - 21s/epoch - 35ms/step
Epoch 11/50
614/614 - 21s - loss: 2.2210 - accuracy10: 0.6988 - val_loss: 2.3233 - val_accuracy10: 0.6577 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 2.2029 - accuracy10: 0.6990 - val_loss: 2.3222 - val_accuracy10: 0.6726 - 21s/epoch - 35ms/step
Epoch 13/50
614/614 - 21s - loss: 2.1864 - accuracy10: 0.7026 - val_loss: 2.3477 - val_accuracy10: 0.6391 - 21s/epoch - 34ms/step
Epoch 14/50
614/614 - 21s - loss: 2.1750 - accuracy10: 0.7019 - val_loss: 2.3386 - val_accuracy10: 0.6587 - 21s/epoch - 35ms/step
Epoch 15/50
614/614 - 21s - loss: 2.1616 - accuracy10: 0.7034 - val_loss: 2.3231 - val_accuracy10: 0.6460 - 21s/epoch - 34ms/step
Epoch 16/50
614/614 - 22s - loss: 2.1472 - accuracy10: 0.7047 - val_loss: 2.3227 - val_accuracy10: 0.6342 - 22s/epoch - 35ms/step
Epoch 17/50
614/614 - 21s - loss: 2.1353 - accuracy10: 0.7026 - val_loss: 2.3549 - val_accuracy10: 0.6499 - 21s/epoch - 34ms/step
Epoch 18/50
614/614 - 22s - loss: 2.1195 - accuracy10: 0.7059 - val_loss: 2.3411 - val_accuracy10: 0.6504 - 22s/epoch - 35ms/step
Epoch 19/50
614/614 - 21s - loss: 2.1139 - accuracy10: 0.7050 - val_loss: 2.3248 - val_accuracy10: 0.6363 - 21s/epoch - 34ms/step
Epoch 20/50
614/614 - 21s - loss: 2.0976 - accuracy10: 0.7084 - val_loss: 2.3257 - val_accuracy10: 0.6315 - 21s/epoch - 35ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h10
Evaluating performance on  test set...
2179/2179 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64703894
{'0': {'precision': 0.32515733574918804, 'recall': 0.6788193396511136, 'f1-score': 0.4396976410791086, 'support': 49701}, '1': {'precision': 0.9368977129188438, 'recall': 0.744736274674223, 'f1-score': 0.8298377858890227, 'support': 459133}, '2': {'precision': 0.3354892317366211, 'recall': 0.6104278184121277, 'f1-score': 0.4330019419726964, 'support': 48946}, 'accuracy': 0.7270769837570368, 'macro avg': {'precision': 0.5325147601348844, 'recall': 0.6779944775791549, 'f1-score': 0.5675124563136092, 'support': 557780}, 'weighted avg': {'precision': 0.8296141100545351, 'recall': 0.7270769837570368, 'f1-score': 0.7602514210973019, 'support': 557780}}
[[ 33738  11527   4436]
 [ 62456 341933  54744]
 [  7565  11503  29878]]
Evaluating performance on  train set...
614/614 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7401939
{'0': {'precision': 0.31349985966881844, 'recall': 0.7442531926707385, 'f1-score': 0.44116775828588356, 'support': 18010}, '1': {'precision': 0.9239085285764002, 'recall': 0.6812154421746184, 'f1-score': 0.7842145133856466, 'support': 120812}, '2': {'precision': 0.3745149283281856, 'recall': 0.5178209690665206, 'f1-score': 0.43466072290264024, 'support': 18265}, 'accuracy': 0.669444320663072, 'macro avg': {'precision': 0.5373077721911347, 'recall': 0.6477632013039591, 'f1-score': 0.5533476648580568, 'support': 157087}, 'weighted avg': {'precision': 0.7900455466901894, 'recall': 0.669444320663072, 'f1-score': 0.704240536910707, 'support': 157087}}
[[13404  3101  1505]
 [24222 82299 14291]
 [ 5130  3677  9458]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7263715
{'0': {'precision': 0.29954039243415237, 'recall': 0.6652925009815469, 'f1-score': 0.4130911750365675, 'support': 5094}, '1': {'precision': 0.9264574299676509, 'recall': 0.7037985935008235, 'f1-score': 0.7999227443581097, 'support': 38251}, '2': {'precision': 0.34721543722520765, 'recall': 0.5451581975071907, 'f1-score': 0.42423338058643584, 'support': 5215}, 'accuracy': 0.6827224052718287, 'macro avg': {'precision': 0.5244044198756703, 'recall': 0.6380830973298538, 'f1-score': 0.5457490999937044, 'support': 48560}, 'weighted avg': {'precision': 0.7984866231029993, 'recall': 0.6827224052718287, 'f1-score': 0.7189972903590732, 'support': 48560}}
[[ 3389  1078   627]
 [ 6612 26921  4718]
 [ 1313  1059  2843]]
training model: results/QRTEA/W8/deepVOL_L3/h20
Epoch 1/50
614/614 - 24s - loss: 3.2357 - accuracy20: 0.4528 - val_loss: 2.9821 - val_accuracy20: 0.6532 - 24s/epoch - 38ms/step
Epoch 2/50
614/614 - 21s - loss: 2.8645 - accuracy20: 0.4950 - val_loss: 2.6809 - val_accuracy20: 0.5625 - 21s/epoch - 34ms/step
Epoch 3/50
614/614 - 21s - loss: 2.6266 - accuracy20: 0.6084 - val_loss: 2.6169 - val_accuracy20: 0.6414 - 21s/epoch - 34ms/step
Epoch 4/50
614/614 - 21s - loss: 2.5394 - accuracy20: 0.6406 - val_loss: 2.5400 - val_accuracy20: 0.6119 - 21s/epoch - 35ms/step
Epoch 5/50
614/614 - 21s - loss: 2.4895 - accuracy20: 0.6517 - val_loss: 2.5311 - val_accuracy20: 0.6140 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 21s - loss: 2.4569 - accuracy20: 0.6576 - val_loss: 2.5742 - val_accuracy20: 0.6388 - 21s/epoch - 34ms/step
Epoch 7/50
614/614 - 21s - loss: 2.4287 - accuracy20: 0.6582 - val_loss: 2.5638 - val_accuracy20: 0.6079 - 21s/epoch - 34ms/step
Epoch 8/50
614/614 - 21s - loss: 2.4085 - accuracy20: 0.6607 - val_loss: 2.4577 - val_accuracy20: 0.6333 - 21s/epoch - 34ms/step
Epoch 9/50
614/614 - 21s - loss: 2.3874 - accuracy20: 0.6651 - val_loss: 2.4964 - val_accuracy20: 0.6388 - 21s/epoch - 34ms/step
Epoch 10/50
614/614 - 21s - loss: 2.3737 - accuracy20: 0.6677 - val_loss: 2.5275 - val_accuracy20: 0.6160 - 21s/epoch - 34ms/step
Epoch 11/50
614/614 - 21s - loss: 2.3520 - accuracy20: 0.6677 - val_loss: 2.5147 - val_accuracy20: 0.6178 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 2.3387 - accuracy20: 0.6705 - val_loss: 2.5131 - val_accuracy20: 0.6217 - 21s/epoch - 34ms/step
Epoch 13/50
614/614 - 21s - loss: 2.3298 - accuracy20: 0.6705 - val_loss: 2.4943 - val_accuracy20: 0.6110 - 21s/epoch - 34ms/step
Epoch 14/50
614/614 - 21s - loss: 2.3171 - accuracy20: 0.6711 - val_loss: 2.4490 - val_accuracy20: 0.6306 - 21s/epoch - 35ms/step
Epoch 15/50
614/614 - 21s - loss: 2.3036 - accuracy20: 0.6727 - val_loss: 2.4582 - val_accuracy20: 0.6094 - 21s/epoch - 34ms/step
Epoch 16/50
614/614 - 21s - loss: 2.2922 - accuracy20: 0.6743 - val_loss: 2.4500 - val_accuracy20: 0.6248 - 21s/epoch - 34ms/step
Epoch 17/50
614/614 - 21s - loss: 2.2807 - accuracy20: 0.6756 - val_loss: 2.4405 - val_accuracy20: 0.6351 - 21s/epoch - 34ms/step
Epoch 18/50
614/614 - 21s - loss: 2.2720 - accuracy20: 0.6762 - val_loss: 2.4660 - val_accuracy20: 0.6146 - 21s/epoch - 34ms/step
Epoch 19/50
614/614 - 21s - loss: 2.2575 - accuracy20: 0.6757 - val_loss: 2.4780 - val_accuracy20: 0.6242 - 21s/epoch - 34ms/step
Epoch 20/50
614/614 - 21s - loss: 2.2540 - accuracy20: 0.6768 - val_loss: 2.4963 - val_accuracy20: 0.6073 - 21s/epoch - 34ms/step
Epoch 21/50
614/614 - 21s - loss: 2.2380 - accuracy20: 0.6782 - val_loss: 2.4943 - val_accuracy20: 0.6100 - 21s/epoch - 34ms/step
Epoch 22/50
614/614 - 21s - loss: 2.2347 - accuracy20: 0.6778 - val_loss: 2.4849 - val_accuracy20: 0.6191 - 21s/epoch - 34ms/step
Epoch 23/50
614/614 - 21s - loss: 2.2224 - accuracy20: 0.6787 - val_loss: 2.5453 - val_accuracy20: 0.5992 - 21s/epoch - 35ms/step
Epoch 24/50
614/614 - 21s - loss: 2.2096 - accuracy20: 0.6804 - val_loss: 2.4545 - val_accuracy20: 0.6232 - 21s/epoch - 34ms/step
Epoch 25/50
614/614 - 21s - loss: 2.2002 - accuracy20: 0.6816 - val_loss: 2.4158 - val_accuracy20: 0.6472 - 21s/epoch - 34ms/step
Epoch 26/50
614/614 - 21s - loss: 2.1907 - accuracy20: 0.6814 - val_loss: 2.4660 - val_accuracy20: 0.6187 - 21s/epoch - 34ms/step
Epoch 27/50
614/614 - 21s - loss: 2.1803 - accuracy20: 0.6821 - val_loss: 2.4493 - val_accuracy20: 0.6271 - 21s/epoch - 34ms/step
Epoch 28/50
614/614 - 21s - loss: 2.1736 - accuracy20: 0.6815 - val_loss: 2.4969 - val_accuracy20: 0.6155 - 21s/epoch - 35ms/step
Epoch 29/50
614/614 - 21s - loss: 2.1628 - accuracy20: 0.6832 - val_loss: 2.5254 - val_accuracy20: 0.6066 - 21s/epoch - 34ms/step
Epoch 30/50
614/614 - 21s - loss: 2.1609 - accuracy20: 0.6817 - val_loss: 2.5017 - val_accuracy20: 0.6248 - 21s/epoch - 34ms/step
Epoch 31/50
614/614 - 21s - loss: 2.1518 - accuracy20: 0.6822 - val_loss: 2.5112 - val_accuracy20: 0.6112 - 21s/epoch - 34ms/step
Epoch 32/50
614/614 - 21s - loss: 2.1420 - accuracy20: 0.6828 - val_loss: 2.5354 - val_accuracy20: 0.6178 - 21s/epoch - 34ms/step
Epoch 33/50
614/614 - 21s - loss: 2.1362 - accuracy20: 0.6826 - val_loss: 2.5566 - val_accuracy20: 0.5906 - 21s/epoch - 34ms/step
Epoch 34/50
614/614 - 21s - loss: 2.1232 - accuracy20: 0.6832 - val_loss: 2.5111 - val_accuracy20: 0.5981 - 21s/epoch - 34ms/step
Epoch 35/50
614/614 - 21s - loss: 2.1155 - accuracy20: 0.6848 - val_loss: 2.5801 - val_accuracy20: 0.5891 - 21s/epoch - 34ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h20
Evaluating performance on  test set...
2179/2179 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7602889
{'0': {'precision': 0.3674057504857381, 'recall': 0.6526247099767981, 'f1-score': 0.4701390412318363, 'support': 68960}, '1': {'precision': 0.894809150096352, 'recall': 0.6987437072621933, 'f1-score': 0.7847148087285308, 'support': 421319}, '2': {'precision': 0.390491513303978, 'recall': 0.6148501503681427, 'f1-score': 0.47763615962252204, 'support': 67501}, 'accuracy': 0.6828893111979634, 'macro avg': {'precision': 0.5509021379620226, 'recall': 0.655406189202378, 'f1-score': 0.577496669860963, 'support': 557780}, 'weighted avg': {'precision': 0.7685735675400216, 'recall': 0.6828893111979634, 'f1-score': 0.7086610584687926, 'support': 557780}}
[[ 45005  17079   6876]
 [ 69020 294394  57905]
 [  8469  17529  41503]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8519984
{'0': {'precision': 0.36656971459734594, 'recall': 0.6667217721937511, 'f1-score': 0.4730514339334937, 'support': 24196}, '1': {'precision': 0.8838370123236476, 'recall': 0.6294307790066951, 'f1-score': 0.7352488731591346, 'support': 108587}, '2': {'precision': 0.42648539778449146, 'recall': 0.6273041474654378, 'f1-score': 0.5077599413841338, 'support': 24304}, 'accuracy': 0.6348456587750737, 'macro avg': {'precision': 0.558964041568495, 'recall': 0.641152232888628, 'f1-score': 0.5720200828255874, 'support': 157087}, 'weighted avg': {'precision': 0.7334027104683366, 'recall': 0.6348456587750737, 'f1-score': 0.6596664237052445, 'support': 157087}}
[[16132  4140  3924]
 [23661 68348 16578]
 [ 4215  4843 15246]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83455276
{'0': {'precision': 0.354776157153697, 'recall': 0.623130460536058, 'f1-score': 0.45213280326635863, 'support': 6753}, '1': {'precision': 0.8850486332705394, 'recall': 0.6571608004339013, 'f1-score': 0.7542675534877624, 'support': 35031}, '2': {'precision': 0.38987649700598803, 'recall': 0.6149645808736718, 'f1-score': 0.4772102611085662, 'support': 6776}, 'accuracy': 0.6465403624382208, 'macro avg': {'precision': 0.5432337624767415, 'recall': 0.6317519472812104, 'f1-score': 0.5612035392875624, 'support': 48560}, 'weighted avg': {'precision': 0.7422105684734711, 'recall': 0.6465403624382207, 'f1-score': 0.6735909434917458, 'support': 48560}}
[[ 4208  1520  1025]
 [ 6514 23021  5496]
 [ 1139  1470  4167]]
training model: results/QRTEA/W8/deepVOL_L3/h30
Epoch 1/50
614/614 - 24s - loss: 3.2676 - accuracy30: 0.4396 - val_loss: 3.2786 - val_accuracy30: 0.6657 - 24s/epoch - 39ms/step
Epoch 2/50
614/614 - 21s - loss: 3.0324 - accuracy30: 0.4241 - val_loss: 2.9479 - val_accuracy30: 0.5831 - 21s/epoch - 34ms/step
Epoch 3/50
614/614 - 21s - loss: 2.8180 - accuracy30: 0.5197 - val_loss: 2.8346 - val_accuracy30: 0.5736 - 21s/epoch - 34ms/step
Epoch 4/50
614/614 - 21s - loss: 2.7152 - accuracy30: 0.5773 - val_loss: 2.7223 - val_accuracy30: 0.5541 - 21s/epoch - 34ms/step
Epoch 5/50
614/614 - 21s - loss: 2.6598 - accuracy30: 0.5978 - val_loss: 2.7282 - val_accuracy30: 0.5990 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 21s - loss: 2.6046 - accuracy30: 0.6128 - val_loss: 2.6701 - val_accuracy30: 0.6389 - 21s/epoch - 35ms/step
Epoch 7/50
614/614 - 21s - loss: 2.5639 - accuracy30: 0.6238 - val_loss: 2.6661 - val_accuracy30: 0.6258 - 21s/epoch - 35ms/step
Epoch 8/50
614/614 - 21s - loss: 2.5364 - accuracy30: 0.6244 - val_loss: 2.6228 - val_accuracy30: 0.6458 - 21s/epoch - 34ms/step
Epoch 9/50
614/614 - 21s - loss: 2.5065 - accuracy30: 0.6321 - val_loss: 2.6873 - val_accuracy30: 0.6258 - 21s/epoch - 34ms/step
Epoch 10/50
614/614 - 21s - loss: 2.4844 - accuracy30: 0.6352 - val_loss: 2.6849 - val_accuracy30: 0.6297 - 21s/epoch - 34ms/step
Epoch 11/50
614/614 - 21s - loss: 2.4684 - accuracy30: 0.6366 - val_loss: 2.6176 - val_accuracy30: 0.6309 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 2.4521 - accuracy30: 0.6402 - val_loss: 2.5737 - val_accuracy30: 0.6287 - 21s/epoch - 34ms/step
Epoch 13/50
614/614 - 21s - loss: 2.4394 - accuracy30: 0.6427 - val_loss: 2.5844 - val_accuracy30: 0.6305 - 21s/epoch - 34ms/step
Epoch 14/50
614/614 - 21s - loss: 2.4208 - accuracy30: 0.6428 - val_loss: 2.6025 - val_accuracy30: 0.6152 - 21s/epoch - 34ms/step
Epoch 15/50
614/614 - 21s - loss: 2.4066 - accuracy30: 0.6458 - val_loss: 2.5858 - val_accuracy30: 0.6080 - 21s/epoch - 34ms/step
Epoch 16/50
614/614 - 21s - loss: 2.3996 - accuracy30: 0.6481 - val_loss: 2.5393 - val_accuracy30: 0.6174 - 21s/epoch - 34ms/step
Epoch 17/50
614/614 - 21s - loss: 2.3886 - accuracy30: 0.6504 - val_loss: 2.5999 - val_accuracy30: 0.6294 - 21s/epoch - 34ms/step
Epoch 18/50
614/614 - 21s - loss: 2.3785 - accuracy30: 0.6489 - val_loss: 2.5423 - val_accuracy30: 0.6268 - 21s/epoch - 34ms/step
Epoch 19/50
614/614 - 21s - loss: 2.3632 - accuracy30: 0.6507 - val_loss: 2.5684 - val_accuracy30: 0.6117 - 21s/epoch - 34ms/step
Epoch 20/50
614/614 - 21s - loss: 2.3534 - accuracy30: 0.6515 - val_loss: 2.5704 - val_accuracy30: 0.6107 - 21s/epoch - 34ms/step
Epoch 21/50
614/614 - 21s - loss: 2.3468 - accuracy30: 0.6517 - val_loss: 2.5668 - val_accuracy30: 0.6422 - 21s/epoch - 35ms/step
Epoch 22/50
614/614 - 21s - loss: 2.3344 - accuracy30: 0.6532 - val_loss: 2.5645 - val_accuracy30: 0.6324 - 21s/epoch - 34ms/step
Epoch 23/50
614/614 - 21s - loss: 2.3276 - accuracy30: 0.6543 - val_loss: 2.5494 - val_accuracy30: 0.6208 - 21s/epoch - 34ms/step
Epoch 24/50
614/614 - 21s - loss: 2.3196 - accuracy30: 0.6528 - val_loss: 2.5681 - val_accuracy30: 0.6271 - 21s/epoch - 34ms/step
Epoch 25/50
614/614 - 21s - loss: 2.3144 - accuracy30: 0.6546 - val_loss: 2.5728 - val_accuracy30: 0.6364 - 21s/epoch - 34ms/step
Epoch 26/50
614/614 - 21s - loss: 2.3112 - accuracy30: 0.6539 - val_loss: 2.5715 - val_accuracy30: 0.6098 - 21s/epoch - 34ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h30
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76876867
{'0': {'precision': 0.3938999593330622, 'recall': 0.6253139892480691, 'f1-score': 0.4833355259278077, 'support': 85194}, '1': {'precision': 0.8414917116816097, 'recall': 0.6977911182944663, 'f1-score': 0.762933791107072, 'support': 389790}, '2': {'precision': 0.4420848060095258, 'recall': 0.5302550847867047, 'f1-score': 0.482172373081464, 'support': 82796}, 'accuracy': 0.6618523432177561, 'macro avg': {'precision': 0.5591588256747326, 'recall': 0.6177867307764133, 'f1-score': 0.5761472300387812, 'support': 557780}, 'weighted avg': {'precision': 0.7138402614474528, 'recall': 0.6618523432177561, 'f1-score': 0.6785528219605796, 'support': 557780}}
[[ 53273  24707   7214]
 [ 69606 271992  48192]
 [ 12366  26527  43903]]
Evaluating performance on  train set...
614/614 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8539795
{'0': {'precision': 0.38888252367858234, 'recall': 0.7006468038257758, 'f1-score': 0.5001596384802417, 'support': 29066}, '1': {'precision': 0.8252440024334118, 'recall': 0.6311700922479365, 'f1-score': 0.7152764245348985, 'support': 98864}, '2': {'precision': 0.47940216457653323, 'recall': 0.47854717563535343, 'f1-score': 0.47897428855858026, 'support': 29157}, 'accuracy': 0.6156970341275854, 'macro avg': {'precision': 0.5645095635628424, 'recall': 0.6034546905696886, 'f1-score': 0.5648034505245735, 'support': 157087}, 'weighted avg': {'precision': 0.6803116196908495, 'recall': 0.6156970341275854, 'f1-score': 0.6316129394462142, 'support': 157087}}
[[20365  6128  2573]
 [23885 62400 12579]
 [ 8118  7086 13953]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84776276
{'0': {'precision': 0.364817086369868, 'recall': 0.6260525012382367, 'f1-score': 0.46099840437656714, 'support': 8076}, '1': {'precision': 0.831787707254406, 'recall': 0.6386080631241524, 'f1-score': 0.7225079769148955, 'support': 32444}, '2': {'precision': 0.4290236928104575, 'recall': 0.5225124378109453, 'f1-score': 0.4711754149842978, 'support': 8040}, 'accuracy': 0.6172981878088962, 'macro avg': {'precision': 0.5418761621449105, 'recall': 0.5957243340577781, 'f1-score': 0.5515605987585869, 'support': 48560}, 'weighted avg': {'precision': 0.6874409731029876, 'recall': 0.6172981878088962, 'f1-score': 0.6374036707834798, 'support': 48560}}
[[ 5056  2085   935]
 [ 7069 20719  4656]
 [ 1734  2105  4201]]
training model: results/QRTEA/W8/deepVOL_L3/h50
Epoch 1/50
614/614 - 23s - loss: 3.2840 - accuracy50: 0.4172 - val_loss: 3.2180 - val_accuracy50: 0.5812 - 23s/epoch - 38ms/step
Epoch 2/50
614/614 - 22s - loss: 3.1744 - accuracy50: 0.4130 - val_loss: 3.1766 - val_accuracy50: 0.5683 - 22s/epoch - 36ms/step
Epoch 3/50
614/614 - 22s - loss: 3.0968 - accuracy50: 0.4052 - val_loss: 3.1325 - val_accuracy50: 0.5487 - 22s/epoch - 36ms/step
Epoch 4/50
614/614 - 22s - loss: 3.0408 - accuracy50: 0.4261 - val_loss: 2.9981 - val_accuracy50: 0.5546 - 22s/epoch - 36ms/step
Epoch 5/50
614/614 - 22s - loss: 2.9240 - accuracy50: 0.4972 - val_loss: 2.8607 - val_accuracy50: 0.5463 - 22s/epoch - 36ms/step
Epoch 6/50
614/614 - 22s - loss: 2.8462 - accuracy50: 0.5364 - val_loss: 2.8540 - val_accuracy50: 0.5568 - 22s/epoch - 36ms/step
Epoch 7/50
614/614 - 22s - loss: 2.7948 - accuracy50: 0.5586 - val_loss: 2.8393 - val_accuracy50: 0.5496 - 22s/epoch - 37ms/step
Epoch 8/50
614/614 - 22s - loss: 2.7503 - accuracy50: 0.5713 - val_loss: 2.8125 - val_accuracy50: 0.5747 - 22s/epoch - 36ms/step
Epoch 9/50
614/614 - 22s - loss: 2.7147 - accuracy50: 0.5805 - val_loss: 2.8374 - val_accuracy50: 0.5652 - 22s/epoch - 36ms/step
Epoch 10/50
614/614 - 22s - loss: 2.6928 - accuracy50: 0.5842 - val_loss: 2.8604 - val_accuracy50: 0.5890 - 22s/epoch - 36ms/step
Epoch 11/50
614/614 - 22s - loss: 2.6694 - accuracy50: 0.5903 - val_loss: 2.8602 - val_accuracy50: 0.5811 - 22s/epoch - 36ms/step
Epoch 12/50
614/614 - 22s - loss: 2.6512 - accuracy50: 0.5934 - val_loss: 2.8890 - val_accuracy50: 0.5701 - 22s/epoch - 36ms/step
Epoch 13/50
614/614 - 22s - loss: 2.6348 - accuracy50: 0.5949 - val_loss: 2.8239 - val_accuracy50: 0.5806 - 22s/epoch - 36ms/step
Epoch 14/50
614/614 - 22s - loss: 2.6220 - accuracy50: 0.5968 - val_loss: 2.7825 - val_accuracy50: 0.5847 - 22s/epoch - 36ms/step
Epoch 15/50
614/614 - 22s - loss: 2.6105 - accuracy50: 0.6010 - val_loss: 2.7688 - val_accuracy50: 0.5970 - 22s/epoch - 36ms/step
Epoch 16/50
614/614 - 22s - loss: 2.5980 - accuracy50: 0.6022 - val_loss: 2.7387 - val_accuracy50: 0.5790 - 22s/epoch - 36ms/step
Epoch 17/50
614/614 - 23s - loss: 2.5866 - accuracy50: 0.6032 - val_loss: 2.7378 - val_accuracy50: 0.5991 - 23s/epoch - 37ms/step
Epoch 18/50
614/614 - 22s - loss: 2.5800 - accuracy50: 0.6051 - val_loss: 2.7525 - val_accuracy50: 0.5895 - 22s/epoch - 37ms/step
Epoch 19/50
614/614 - 22s - loss: 2.5644 - accuracy50: 0.6082 - val_loss: 2.7104 - val_accuracy50: 0.5834 - 22s/epoch - 36ms/step
Epoch 20/50
614/614 - 22s - loss: 2.5527 - accuracy50: 0.6111 - val_loss: 2.7158 - val_accuracy50: 0.5993 - 22s/epoch - 36ms/step
Epoch 21/50
614/614 - 22s - loss: 2.5465 - accuracy50: 0.6108 - val_loss: 2.7273 - val_accuracy50: 0.5894 - 22s/epoch - 36ms/step
Epoch 22/50
614/614 - 22s - loss: 2.5343 - accuracy50: 0.6115 - val_loss: 2.7460 - val_accuracy50: 0.5822 - 22s/epoch - 37ms/step
Epoch 23/50
614/614 - 22s - loss: 2.5225 - accuracy50: 0.6144 - val_loss: 2.7362 - val_accuracy50: 0.5920 - 22s/epoch - 36ms/step
Epoch 24/50
614/614 - 22s - loss: 2.5163 - accuracy50: 0.6142 - val_loss: 2.7422 - val_accuracy50: 0.5911 - 22s/epoch - 36ms/step
Epoch 25/50
614/614 - 22s - loss: 2.4992 - accuracy50: 0.6166 - val_loss: 2.7552 - val_accuracy50: 0.5779 - 22s/epoch - 36ms/step
Epoch 26/50
614/614 - 22s - loss: 2.4883 - accuracy50: 0.6179 - val_loss: 2.8002 - val_accuracy50: 0.5729 - 22s/epoch - 36ms/step
Epoch 27/50
614/614 - 22s - loss: 2.4818 - accuracy50: 0.6179 - val_loss: 2.7898 - val_accuracy50: 0.5596 - 22s/epoch - 36ms/step
Epoch 28/50
614/614 - 22s - loss: 2.4719 - accuracy50: 0.6196 - val_loss: 2.8078 - val_accuracy50: 0.5676 - 22s/epoch - 36ms/step
Epoch 29/50
614/614 - 22s - loss: 2.4648 - accuracy50: 0.6180 - val_loss: 2.8334 - val_accuracy50: 0.5628 - 22s/epoch - 36ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h50
Evaluating performance on  test set...
2179/2179 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8597335
{'0': {'precision': 0.43718306049929007, 'recall': 0.5175701516431717, 'f1-score': 0.4739924412732545, 'support': 112435}, '1': {'precision': 0.7468172232213324, 'recall': 0.6856086588570665, 'f1-score': 0.7149051985589747, 'support': 336765}, '2': {'precision': 0.4620152891166769, 'recall': 0.4914901455148278, 'f1-score': 0.47629715244525567, 'support': 108580}, 'accuracy': 0.6139481516009896, 'macro avg': {'precision': 0.5486718576124331, 'recall': 0.564889652005022, 'f1-score': 0.5550649307591616, 'support': 557780}, 'weighted avg': {'precision': 0.6289615971846578, 'recall': 0.6139481516009896, 'f1-score': 0.6198944640176725, 'support': 557780}}
[[ 58193  39646  14596]
 [ 58331 230889  47545]
 [ 16585  38629  53366]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89953536
{'0': {'precision': 0.4404572147651007, 'recall': 0.5684703462090247, 'f1-score': 0.4963426018931024, 'support': 36943}, '1': {'precision': 0.7286298453954739, 'recall': 0.6231958701146258, 'f1-score': 0.6718012614834373, 'support': 83489}, '2': {'precision': 0.48227584936445694, 'recall': 0.49995907788841903, 'f1-score': 0.4909582875666408, 'support': 36655}, 'accuracy': 0.5815694487767925, 'macro avg': {'precision': 0.5504543031750105, 'recall': 0.5638750980706899, 'f1-score': 0.5530340503143935, 'support': 157087}, 'weighted avg': {'precision': 0.6033739857896835, 'recall': 0.5815694487767925, 'f1-score': 0.5883394316046701, 'support': 157087}}
[[21001  9316  6626]
 [18412 52030 13047]
 [ 8267 10062 18326]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9059465
{'0': {'precision': 0.4025680309330999, 'recall': 0.5406093857156853, 'f1-score': 0.46148699506565194, 'support': 10207}, '1': {'precision': 0.7451241873645608, 'recall': 0.6324725857799788, 'f1-score': 0.6841924004132706, 'support': 28270}, '2': {'precision': 0.451505940867643, 'recall': 0.48616483189526927, 'f1-score': 0.46819484240687675, 'support': 10083}, 'accuracy': 0.5827841845140033, 'macro avg': {'precision': 0.5330660530551011, 'recall': 0.5530822677969778, 'f1-score': 0.5379580792952664, 'support': 48560}, 'weighted avg': {'precision': 0.6121541818430545, 'recall': 0.5827841845140033, 'f1-score': 0.5925314150392671, 'support': 48560}}
[[ 5518  3137  1552]
 [ 5987 17880  4403]
 [ 2202  2979  4902]]
training model: results/QRTEA/W8/deepVOL_L3/h100
Epoch 1/50
614/614 - 25s - loss: 3.2857 - accuracy100: 0.3927 - val_loss: 3.2775 - val_accuracy100: 0.4373 - 25s/epoch - 41ms/step
Epoch 2/50
614/614 - 22s - loss: 3.2686 - accuracy100: 0.3897 - val_loss: 3.2458 - val_accuracy100: 0.4397 - 22s/epoch - 36ms/step
Epoch 3/50
614/614 - 22s - loss: 3.2431 - accuracy100: 0.3914 - val_loss: 3.1651 - val_accuracy100: 0.4471 - 22s/epoch - 36ms/step
Epoch 4/50
614/614 - 22s - loss: 3.1427 - accuracy100: 0.4402 - val_loss: 3.1589 - val_accuracy100: 0.4578 - 22s/epoch - 36ms/step
Epoch 5/50
614/614 - 22s - loss: 3.0774 - accuracy100: 0.4662 - val_loss: 3.1445 - val_accuracy100: 0.4591 - 22s/epoch - 36ms/step
Epoch 6/50
614/614 - 22s - loss: 3.0399 - accuracy100: 0.4806 - val_loss: 3.1181 - val_accuracy100: 0.4711 - 22s/epoch - 37ms/step
Epoch 7/50
614/614 - 22s - loss: 3.0063 - accuracy100: 0.4937 - val_loss: 3.0951 - val_accuracy100: 0.4797 - 22s/epoch - 37ms/step
Epoch 8/50
614/614 - 22s - loss: 2.9742 - accuracy100: 0.5010 - val_loss: 3.0947 - val_accuracy100: 0.4895 - 22s/epoch - 36ms/step
Epoch 9/50
614/614 - 22s - loss: 2.9450 - accuracy100: 0.5095 - val_loss: 3.1187 - val_accuracy100: 0.4931 - 22s/epoch - 36ms/step
Epoch 10/50
614/614 - 22s - loss: 2.9223 - accuracy100: 0.5131 - val_loss: 3.0871 - val_accuracy100: 0.4986 - 22s/epoch - 36ms/step
Epoch 11/50
614/614 - 22s - loss: 2.9039 - accuracy100: 0.5195 - val_loss: 3.0781 - val_accuracy100: 0.4959 - 22s/epoch - 36ms/step
Epoch 12/50
614/614 - 22s - loss: 2.8941 - accuracy100: 0.5210 - val_loss: 3.0458 - val_accuracy100: 0.5002 - 22s/epoch - 36ms/step
Epoch 13/50
614/614 - 22s - loss: 2.8744 - accuracy100: 0.5253 - val_loss: 3.0403 - val_accuracy100: 0.5028 - 22s/epoch - 36ms/step
Epoch 14/50
614/614 - 23s - loss: 2.8599 - accuracy100: 0.5285 - val_loss: 3.0324 - val_accuracy100: 0.5041 - 23s/epoch - 37ms/step
Epoch 15/50
614/614 - 23s - loss: 2.8498 - accuracy100: 0.5312 - val_loss: 3.0311 - val_accuracy100: 0.5060 - 23s/epoch - 37ms/step
Epoch 16/50
614/614 - 22s - loss: 2.8393 - accuracy100: 0.5348 - val_loss: 3.0372 - val_accuracy100: 0.5038 - 22s/epoch - 37ms/step
Epoch 17/50
614/614 - 22s - loss: 2.8286 - accuracy100: 0.5365 - val_loss: 3.0499 - val_accuracy100: 0.4985 - 22s/epoch - 37ms/step
Epoch 18/50
614/614 - 22s - loss: 2.8167 - accuracy100: 0.5404 - val_loss: 3.0572 - val_accuracy100: 0.4923 - 22s/epoch - 36ms/step
Epoch 19/50
614/614 - 22s - loss: 2.8053 - accuracy100: 0.5430 - val_loss: 3.0485 - val_accuracy100: 0.4984 - 22s/epoch - 36ms/step
Epoch 20/50
614/614 - 22s - loss: 2.7952 - accuracy100: 0.5451 - val_loss: 3.0692 - val_accuracy100: 0.4971 - 22s/epoch - 36ms/step
Epoch 21/50
614/614 - 22s - loss: 2.7821 - accuracy100: 0.5483 - val_loss: 3.1295 - val_accuracy100: 0.4896 - 22s/epoch - 36ms/step
Epoch 22/50
614/614 - 22s - loss: 2.7692 - accuracy100: 0.5509 - val_loss: 3.1539 - val_accuracy100: 0.4844 - 22s/epoch - 36ms/step
Epoch 23/50
614/614 - 22s - loss: 2.7646 - accuracy100: 0.5525 - val_loss: 3.1719 - val_accuracy100: 0.4923 - 22s/epoch - 36ms/step
Epoch 24/50
614/614 - 22s - loss: 2.7493 - accuracy100: 0.5556 - val_loss: 3.2231 - val_accuracy100: 0.4856 - 22s/epoch - 36ms/step
Epoch 25/50
614/614 - 22s - loss: 2.7420 - accuracy100: 0.5572 - val_loss: 3.2511 - val_accuracy100: 0.4808 - 22s/epoch - 36ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h100
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0071487
{'0': {'precision': 0.4675061332799279, 'recall': 0.3521503010798647, 'f1-score': 0.40171081123714736, 'support': 159094}, '1': {'precision': 0.5330378675959948, 'recall': 0.6832232796012171, 'f1-score': 0.5988580345426818, 'support': 247152}, '2': {'precision': 0.4748749525397428, 'recall': 0.37967056898121876, 'f1-score': 0.42196943026462475, 'support': 151534}, 'accuracy': 0.5063250744020941, 'macro avg': {'precision': 0.4918063178052219, 'recall': 0.47168138322076686, 'f1-score': 0.4741794253481513, 'support': 557780}, 'weighted avg': {'precision': 0.49854511972153814, 'recall': 0.5063250744020941, 'f1-score': 0.49457036179492864, 'support': 557780}}
[[ 56025  77660  25409]
 [ 40080 168860  38212]
 [ 23733  70268  57533]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.999518
{'0': {'precision': 0.4798386172431974, 'recall': 0.43074390369379567, 'f1-score': 0.45396777201847793, 'support': 48595}, '1': {'precision': 0.5191588262344796, 'recall': 0.6834148655944765, 'f1-score': 0.590069218816217, 'support': 61121}, '2': {'precision': 0.49359188001817905, 'recall': 0.34390238753667857, 'f1-score': 0.40536976211804526, 'support': 47371}, 'accuracy': 0.5028678375677172, 'macro avg': {'precision': 0.4975297744986187, 'recall': 0.4860203856083169, 'f1-score': 0.48313558431758, 'support': 157087}, 'weighted avg': {'precision': 0.49928514244687316, 'recall': 0.5028678375677172, 'f1-score': 0.49226833287157984, 'support': 157087}}
[[20932 19044  8619]
 [11255 41771  8095]
 [11436 19644 16291]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99600786
{'0': {'precision': 0.43127224199288255, 'recall': 0.4222254482107861, 'f1-score': 0.4267008985879333, 'support': 13777}, '1': {'precision': 0.5495837079310479, 'recall': 0.659784138901924, 'f1-score': 0.5996630627172498, 'support': 21310}, '2': {'precision': 0.4925703446095479, 'recall': 0.346916054330884, 'f1-score': 0.4071073948262346, 'support': 13473}, 'accuracy': 0.5055807248764416, 'macro avg': {'precision': 0.4911420981778261, 'recall': 0.47630854714786475, 'f1-score': 0.4778237853771392, 'support': 48560}, 'weighted avg': {'precision': 0.5001990680986618, 'recall': 0.5055807248764416, 'f1-score': 0.4971671350256262, 'support': 48560}}
[[ 5817  5792  2168]
 [ 4603 14060  2647]
 [ 3068  5731  4674]]
training model: results/QRTEA/W8/deepVOL_L3/h200
Epoch 1/50
614/614 - 24s - loss: 3.3030 - accuracy200: 0.3700 - val_loss: 3.3608 - val_accuracy200: 0.3454 - 24s/epoch - 39ms/step
Epoch 2/50
614/614 - 21s - loss: 3.2946 - accuracy200: 0.3484 - val_loss: 3.3036 - val_accuracy200: 0.3465 - 21s/epoch - 35ms/step
Epoch 3/50
614/614 - 21s - loss: 3.2726 - accuracy200: 0.3646 - val_loss: 3.2999 - val_accuracy200: 0.3488 - 21s/epoch - 34ms/step
Epoch 4/50
614/614 - 21s - loss: 3.2533 - accuracy200: 0.3779 - val_loss: 3.2763 - val_accuracy200: 0.3637 - 21s/epoch - 34ms/step
Epoch 5/50
614/614 - 21s - loss: 3.2237 - accuracy200: 0.3983 - val_loss: 3.2697 - val_accuracy200: 0.3716 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 21s - loss: 3.2030 - accuracy200: 0.4098 - val_loss: 3.2355 - val_accuracy200: 0.3885 - 21s/epoch - 34ms/step
Epoch 7/50
614/614 - 21s - loss: 3.1813 - accuracy200: 0.4223 - val_loss: 3.2488 - val_accuracy200: 0.3870 - 21s/epoch - 34ms/step
Epoch 8/50
614/614 - 21s - loss: 3.1642 - accuracy200: 0.4328 - val_loss: 3.2369 - val_accuracy200: 0.4058 - 21s/epoch - 34ms/step
Epoch 9/50
614/614 - 21s - loss: 3.1475 - accuracy200: 0.4411 - val_loss: 3.2638 - val_accuracy200: 0.3990 - 21s/epoch - 34ms/step
Epoch 10/50
614/614 - 21s - loss: 3.1335 - accuracy200: 0.4469 - val_loss: 3.2352 - val_accuracy200: 0.4143 - 21s/epoch - 34ms/step
Epoch 11/50
614/614 - 21s - loss: 3.1149 - accuracy200: 0.4543 - val_loss: 3.2414 - val_accuracy200: 0.4154 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 3.0977 - accuracy200: 0.4615 - val_loss: 3.2828 - val_accuracy200: 0.4137 - 21s/epoch - 34ms/step
Epoch 13/50
614/614 - 21s - loss: 3.0859 - accuracy200: 0.4662 - val_loss: 3.3075 - val_accuracy200: 0.4015 - 21s/epoch - 34ms/step
Epoch 14/50
614/614 - 21s - loss: 3.0654 - accuracy200: 0.4743 - val_loss: 3.3037 - val_accuracy200: 0.4042 - 21s/epoch - 34ms/step
Epoch 15/50
614/614 - 21s - loss: 3.0490 - accuracy200: 0.4785 - val_loss: 3.3660 - val_accuracy200: 0.3894 - 21s/epoch - 35ms/step
Epoch 16/50
614/614 - 21s - loss: 3.0369 - accuracy200: 0.4844 - val_loss: 3.3862 - val_accuracy200: 0.3974 - 21s/epoch - 34ms/step
Epoch 17/50
614/614 - 21s - loss: 3.0218 - accuracy200: 0.4878 - val_loss: 3.3760 - val_accuracy200: 0.3982 - 21s/epoch - 34ms/step
Epoch 18/50
614/614 - 21s - loss: 3.0015 - accuracy200: 0.4941 - val_loss: 3.3992 - val_accuracy200: 0.3985 - 21s/epoch - 34ms/step
Epoch 19/50
614/614 - 21s - loss: 2.9770 - accuracy200: 0.5013 - val_loss: 3.4806 - val_accuracy200: 0.3945 - 21s/epoch - 34ms/step
Epoch 20/50
614/614 - 21s - loss: 2.9654 - accuracy200: 0.5048 - val_loss: 3.4905 - val_accuracy200: 0.3959 - 21s/epoch - 34ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h200
Evaluating performance on  test set...
2179/2179 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1055799
{'0': {'precision': 0.3990455059237242, 'recall': 0.34808828976404244, 'f1-score': 0.3718291649948731, 'support': 191687}, '1': {'precision': 0.3721559335820931, 'recall': 0.4229592961069814, 'f1-score': 0.39593459119496854, 'support': 186051}, '2': {'precision': 0.40108976005180824, 'recall': 0.3990402239477455, 'f1-score': 0.4000623670523772, 'support': 180042}, 'accuracy': 0.3895084083330345, 'macro avg': {'precision': 0.39076373318587515, 'recall': 0.3900292699395898, 'f1-score': 0.38927537441407295, 'support': 557780}, 'weighted avg': {'precision': 0.39073617209675965, 'recall': 0.3895084083330345, 'f1-score': 0.38898288297470585, 'support': 557780}}
[[66724 71513 53450]
 [53531 78692 53828]
 [46954 61244 71844]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.074218
{'0': {'precision': 0.4331081440502154, 'recall': 0.44764138841036544, 'f1-score': 0.4402548597280174, 'support': 54566}, '1': {'precision': 0.40325716234652115, 'recall': 0.46960579882831893, 'f1-score': 0.43390981237671455, 'support': 50355}, '2': {'precision': 0.4182877526753864, 'recall': 0.3371736380017636, 'f1-score': 0.373376072004755, 'support': 52166}, 'accuracy': 0.4179976700809106, 'macro avg': {'precision': 0.41821768635737433, 'recall': 0.41814027508014934, 'f1-score': 0.4158469147031623, 'support': 157087}, 'weighted avg': {'precision': 0.41861765966800135, 'recall': 0.4179976700809106, 'f1-score': 0.41601158243742964, 'support': 157087}}
[[24426 17735 12405]
 [14652 23647 12056]
 [17319 17258 17589]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079809
{'0': {'precision': 0.3961936747830954, 'recall': 0.4351942941465814, 'f1-score': 0.4147792200181663, 'support': 16264}, '1': {'precision': 0.406401384083045, 'recall': 0.42066618911174786, 'f1-score': 0.4134107708553326, 'support': 16752}, '2': {'precision': 0.4386372145263946, 'recall': 0.376865671641791, 'f1-score': 0.4054119519706563, 'support': 15544}, 'accuracy': 0.4115115321252059, 'macro avg': {'precision': 0.413744091130845, 'recall': 0.4109087183000401, 'f1-score': 0.41120064761471836, 'support': 48560}, 'weighted avg': {'precision': 0.41330121036716866, 'recall': 0.4115115321252059, 'f1-score': 0.41130868717413244, 'support': 48560}}
[[7078 5580 3606]
 [5814 7047 3891]
 [4973 4713 5858]]
training model: results/QRTEA/W8/deepVOL_L3/h300
Epoch 1/50
614/614 - 24s - loss: 3.3113 - accuracy300: 0.3654 - val_loss: 3.3487 - val_accuracy300: 0.3448 - 24s/epoch - 39ms/step
Epoch 2/50
614/614 - 21s - loss: 3.2825 - accuracy300: 0.3694 - val_loss: 3.2972 - val_accuracy300: 0.3567 - 21s/epoch - 34ms/step
Epoch 3/50
614/614 - 22s - loss: 3.2785 - accuracy300: 0.3639 - val_loss: 3.3102 - val_accuracy300: 0.3571 - 22s/epoch - 36ms/step
Epoch 4/50
614/614 - 21s - loss: 3.2640 - accuracy300: 0.3738 - val_loss: 3.2982 - val_accuracy300: 0.3554 - 21s/epoch - 34ms/step
Epoch 5/50
614/614 - 21s - loss: 3.2520 - accuracy300: 0.3840 - val_loss: 3.3201 - val_accuracy300: 0.3509 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 21s - loss: 3.2402 - accuracy300: 0.3933 - val_loss: 3.3043 - val_accuracy300: 0.3521 - 21s/epoch - 34ms/step
Epoch 7/50
614/614 - 21s - loss: 3.2274 - accuracy300: 0.4041 - val_loss: 3.3167 - val_accuracy300: 0.3628 - 21s/epoch - 34ms/step
Epoch 8/50
614/614 - 21s - loss: 3.2191 - accuracy300: 0.4092 - val_loss: 3.3314 - val_accuracy300: 0.3630 - 21s/epoch - 35ms/step
Epoch 9/50
614/614 - 22s - loss: 3.2022 - accuracy300: 0.4181 - val_loss: 3.3212 - val_accuracy300: 0.3657 - 22s/epoch - 36ms/step
Epoch 10/50
614/614 - 21s - loss: 3.1870 - accuracy300: 0.4247 - val_loss: 3.3101 - val_accuracy300: 0.3740 - 21s/epoch - 34ms/step
Epoch 11/50
614/614 - 21s - loss: 3.1695 - accuracy300: 0.4342 - val_loss: 3.3421 - val_accuracy300: 0.3641 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 3.1561 - accuracy300: 0.4401 - val_loss: 3.3628 - val_accuracy300: 0.3694 - 21s/epoch - 35ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h300
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042098
{'0': {'precision': 0.38747966399946876, 'recall': 0.12237974895923996, 'f1-score': 0.18601074257662456, 'support': 190726}, '1': {'precision': 0.3439392798895998, 'recall': 0.713251745704682, 'f1-score': 0.4640888654153463, 'support': 192186}, '2': {'precision': 0.3829299337320187, 'recall': 0.21677493881098886, 'f1-score': 0.27683487913532456, 'support': 174868}, 'accuracy': 0.3555613324249704, 'macro avg': {'precision': 0.37144962587369573, 'recall': 0.35080214449163694, 'f1-score': 0.30897816237576514, 'support': 557780}, 'weighted avg': {'precision': 0.3710512253803936, 'recall': 0.3555613324249704, 'f1-score': 0.3102980193302359, 'support': 557780}}
[[ 23341 138161  29224]
 [ 23248 137077  31861]
 [ 13649 123312  37907]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066076
{'0': {'precision': 0.39231915245820226, 'recall': 0.13338586222422333, 'f1-score': 0.19908437985635682, 'support': 53304}, '1': {'precision': 0.3319824354346015, 'recall': 0.7273643381374302, 'f1-score': 0.4558888372481022, 'support': 52594}, '2': {'precision': 0.37754930052250124, 'recall': 0.17503760573560725, 'f1-score': 0.23918527515649818, 'support': 51189}, 'accuracy': 0.34582747140119807, 'macro avg': {'precision': 0.36728362947176835, 'recall': 0.34526260203242026, 'f1-score': 0.29805283075365235, 'support': 157087}, 'weighted avg': {'precision': 0.36730496766967197, 'recall': 0.34582747140119807, 'f1-score': 0.2981320309132896, 'support': 157087}}
[[ 7110 39539  6655]
 [ 6222 38255  8117]
 [ 4791 37438  8960]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994403
{'0': {'precision': 0.3773818745158792, 'recall': 0.14987080103359174, 'f1-score': 0.21454049055440577, 'support': 16254}, '1': {'precision': 0.34361610968294776, 'recall': 0.7053649956024626, 'f1-score': 0.4621146643618554, 'support': 17055}, '2': {'precision': 0.38012684989429174, 'recall': 0.17684086289423645, 'f1-score': 0.2413854828604672, 'support': 15251}, 'accuracy': 0.35343904448105434, 'macro avg': {'precision': 0.3670416113643729, 'recall': 0.3440255531767636, 'f1-score': 0.3060135459255761, 'support': 48560}, 'weighted avg': {'precision': 0.3663849325939377, 'recall': 0.35343904448105434, 'f1-score': 0.30992332646762233, 'support': 48560}}
[[ 2436 11899  1919]
 [ 2546 12030  2479]
 [ 1473 11081  2697]]
training model: results/QRTEA/W8/deepVOL_L3/h500
Epoch 1/50
614/614 - 24s - loss: 3.3022 - accuracy500: 0.3847 - val_loss: 3.3091 - val_accuracy500: 0.3306 - 24s/epoch - 38ms/step
Epoch 2/50
614/614 - 21s - loss: 3.2946 - accuracy500: 0.3545 - val_loss: 3.3036 - val_accuracy500: 0.3402 - 21s/epoch - 35ms/step
Epoch 3/50
614/614 - 21s - loss: 3.2982 - accuracy500: 0.3462 - val_loss: 3.3053 - val_accuracy500: 0.3335 - 21s/epoch - 34ms/step
Epoch 4/50
614/614 - 21s - loss: 3.2912 - accuracy500: 0.3503 - val_loss: 3.3014 - val_accuracy500: 0.3327 - 21s/epoch - 35ms/step
Epoch 5/50
614/614 - 21s - loss: 3.2905 - accuracy500: 0.3563 - val_loss: 3.2980 - val_accuracy500: 0.3406 - 21s/epoch - 34ms/step
Epoch 6/50
614/614 - 21s - loss: 3.2856 - accuracy500: 0.3618 - val_loss: 3.3043 - val_accuracy500: 0.3377 - 21s/epoch - 35ms/step
Epoch 7/50
614/614 - 21s - loss: 3.2756 - accuracy500: 0.3698 - val_loss: 3.3087 - val_accuracy500: 0.3298 - 21s/epoch - 34ms/step
Epoch 8/50
614/614 - 21s - loss: 3.2603 - accuracy500: 0.3887 - val_loss: 3.3169 - val_accuracy500: 0.3256 - 21s/epoch - 35ms/step
Epoch 9/50
614/614 - 22s - loss: 3.2557 - accuracy500: 0.3875 - val_loss: 3.3341 - val_accuracy500: 0.3261 - 22s/epoch - 36ms/step
Epoch 10/50
614/614 - 23s - loss: 3.2314 - accuracy500: 0.4073 - val_loss: 3.3475 - val_accuracy500: 0.3333 - 23s/epoch - 37ms/step
Epoch 11/50
614/614 - 21s - loss: 3.2084 - accuracy500: 0.4224 - val_loss: 3.3591 - val_accuracy500: 0.3409 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 21s - loss: 3.1865 - accuracy500: 0.4318 - val_loss: 3.3808 - val_accuracy500: 0.3415 - 21s/epoch - 34ms/step
Epoch 13/50
614/614 - 21s - loss: 3.1725 - accuracy500: 0.4397 - val_loss: 3.3883 - val_accuracy500: 0.3494 - 21s/epoch - 35ms/step
Epoch 14/50
614/614 - 22s - loss: 3.1552 - accuracy500: 0.4464 - val_loss: 3.4051 - val_accuracy500: 0.3492 - 22s/epoch - 36ms/step
Epoch 15/50
614/614 - 22s - loss: 3.1335 - accuracy500: 0.4573 - val_loss: 3.4242 - val_accuracy500: 0.3477 - 22s/epoch - 36ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h500
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955768
{'0': {'precision': 0.38258608379580045, 'recall': 0.4438091473371639, 'f1-score': 0.41092977605810854, 'support': 212499}, '1': {'precision': 0.23570432357043236, 'recall': 0.003277522787510505, 'f1-score': 0.0064651462308962585, 'support': 154690}, '2': {'precision': 0.34827335220380107, 'recall': 0.5648745218819357, 'f1-score': 0.4308847425337592, 'support': 190591}, 'accuracy': 0.3630033346480691, 'macro avg': {'precision': 0.32218791985667794, 'recall': 0.3373203973355367, 'f1-score': 0.28275988827425463, 'support': 557780}, 'weighted avg': {'precision': 0.33012662430260786, 'recall': 0.3630033346480691, 'f1-score': 0.3055774927700546, 'support': 557780}}
[[ 94309    765 117425]
 [ 70143    507  84040]
 [ 82052    879 107660]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098791
{'0': {'precision': 0.3512052528754205, 'recall': 0.44486826436439414, 'f1-score': 0.3925267400530287, 'support': 53744}, '1': {'precision': 0.33037475345167655, 'recall': 0.006465683625414962, 'f1-score': 0.012683148449627079, 'support': 51812}, '2': {'precision': 0.335981180962771, 'recall': 0.5737323164696978, 'f1-score': 0.42378894407534023, 'support': 51531}, 'accuracy': 0.3425426674390624, 'macro avg': {'precision': 0.339187062429956, 'recall': 0.3416887548198357, 'f1-score': 0.27633294419266535, 'support': 157087}, 'weighted avg': {'precision': 0.3393406078960539, 'recall': 0.3425426674390624, 'f1-score': 0.2774982301656306, 'support': 157087}}
[[23909   349 29486]
 [22532   335 28945]
 [21636   330 29565]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994984
{'0': {'precision': 0.34250516675446774, 'recall': 0.502377555872563, 'f1-score': 0.4073154863738223, 'support': 16824}, '1': {'precision': 0.3218390804597701, 'recall': 0.0035416139640779155, 'f1-score': 0.007006130364068559, 'support': 15812}, '2': {'precision': 0.3334598675608419, 'recall': 0.4964832956543582, 'f1-score': 0.39896046224106174, 'support': 15924}, 'accuracy': 0.3380148270181219, 'macro avg': {'precision': 0.33260137159169323, 'recall': 0.33413415516366635, 'f1-score': 0.2710940263263175, 'support': 48560}, 'weighted avg': {'precision': 0.33280974869740315, 'recall': 0.3380148270181219, 'f1-score': 0.274227822833536, 'support': 48560}}
[[8452   54 8318]
 [8271   56 7485]
 [7954   64 7906]]
training model: results/QRTEA/W8/deepVOL_L3/h1000
Epoch 1/50
614/614 - 24s - loss: 3.2966 - accuracy1000: 0.3952 - val_loss: 3.3559 - val_accuracy1000: 0.3317 - 24s/epoch - 40ms/step
Epoch 2/50
614/614 - 21s - loss: 3.2872 - accuracy1000: 0.3815 - val_loss: 3.3193 - val_accuracy1000: 0.3382 - 21s/epoch - 35ms/step
Epoch 3/50
614/614 - 21s - loss: 3.3048 - accuracy1000: 0.3445 - val_loss: 3.3079 - val_accuracy1000: 0.3303 - 21s/epoch - 34ms/step
Epoch 4/50
614/614 - 21s - loss: 3.3036 - accuracy1000: 0.3405 - val_loss: 3.3019 - val_accuracy1000: 0.3348 - 21s/epoch - 34ms/step
Epoch 5/50
614/614 - 21s - loss: 3.2993 - accuracy1000: 0.3488 - val_loss: 3.3010 - val_accuracy1000: 0.3477 - 21s/epoch - 35ms/step
Epoch 6/50
614/614 - 22s - loss: 3.2945 - accuracy1000: 0.3559 - val_loss: 3.3137 - val_accuracy1000: 0.3320 - 22s/epoch - 36ms/step
Epoch 7/50
614/614 - 22s - loss: 3.2892 - accuracy1000: 0.3573 - val_loss: 3.3247 - val_accuracy1000: 0.3379 - 22s/epoch - 36ms/step
Epoch 8/50
614/614 - 22s - loss: 3.2647 - accuracy1000: 0.3981 - val_loss: 3.3206 - val_accuracy1000: 0.3425 - 22s/epoch - 36ms/step
Epoch 9/50
614/614 - 22s - loss: 3.2871 - accuracy1000: 0.3686 - val_loss: 3.3249 - val_accuracy1000: 0.3392 - 22s/epoch - 36ms/step
Epoch 10/50
614/614 - 21s - loss: 3.2774 - accuracy1000: 0.3713 - val_loss: 3.3328 - val_accuracy1000: 0.3451 - 21s/epoch - 34ms/step
Epoch 11/50
614/614 - 21s - loss: 3.2769 - accuracy1000: 0.3703 - val_loss: 3.3377 - val_accuracy1000: 0.3375 - 21s/epoch - 34ms/step
Epoch 12/50
614/614 - 22s - loss: 3.2633 - accuracy1000: 0.3820 - val_loss: 3.3746 - val_accuracy1000: 0.3410 - 22s/epoch - 35ms/step
Epoch 13/50
614/614 - 21s - loss: 3.2561 - accuracy1000: 0.3882 - val_loss: 3.3577 - val_accuracy1000: 0.3358 - 21s/epoch - 34ms/step
Epoch 14/50
614/614 - 21s - loss: 3.2431 - accuracy1000: 0.3977 - val_loss: 3.3789 - val_accuracy1000: 0.3394 - 21s/epoch - 34ms/step
Epoch 15/50
614/614 - 22s - loss: 3.2377 - accuracy1000: 0.4014 - val_loss: 3.4099 - val_accuracy1000: 0.3393 - 22s/epoch - 36ms/step
testing model: results/QRTEA/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
2179/2179 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0937347
{'0': {'precision': 0.3915902880915066, 'recall': 0.44766242050166033, 'f1-score': 0.4177532092945898, 'support': 213212}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 154900}, '2': {'precision': 0.3449946024437078, 'recall': 0.5712033658814349, 'f1-score': 0.43017357588559835, 'support': 189668}, 'accuracy': 0.3653519308688013, 'macro avg': {'precision': 0.24552829684507146, 'recall': 0.3396219287943651, 'f1-score': 0.2826422617267294, 'support': 557780}, 'weighted avg': {'precision': 0.26699807228810546, 'recall': 0.3653519308688013, 'f1-score': 0.30596320960089596, 'support': 557780}}
[[ 95447      4 117761]
 [ 66969      0  87931]
 [ 81326      3 108339]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100416
{'0': {'precision': 0.3661857932966541, 'recall': 0.4797653958944281, 'f1-score': 0.41535084845705306, 'support': 52855}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52522}, '2': {'precision': 0.3540649156961189, 'recall': 0.6014310578224715, 'f1-score': 0.44572796262191233, 'support': 51710}, 'accuracy': 0.35940593429118894, 'macro avg': {'precision': 0.24008356966425767, 'recall': 0.3603988179056332, 'f1-score': 0.2870262703596551, 'support': 157087}, 'weighted avg': {'precision': 0.23976170463081584, 'recall': 0.35940593429118894, 'f1-score': 0.2864779519780544, 'support': 157087}}
[[25358     1 27496]
 [23281     0 29241]
 [20610     0 31100]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101237
{'0': {'precision': 0.35459207901984996, 'recall': 0.4374597223035913, 'f1-score': 0.3916909276890393, 'support': 17069}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15508}, '2': {'precision': 0.3383513326788117, 'recall': 0.5821810673840956, 'f1-score': 0.4279735074970104, 'support': 15983}, 'accuracy': 0.3453871499176277, 'macro avg': {'precision': 0.23098113723288724, 'recall': 0.339880263229229, 'f1-score': 0.2732214783953499, 'support': 48560}, 'weighted avg': {'precision': 0.23600497419677233, 'recall': 0.3453871499176277, 'f1-score': 0.2785435134894755, 'support': 48560}}
[[7467    1 9601]
 [6913    0 8595]
 [6678    0 9305]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  12.88 (ave)

============================================
