This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-02-06.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-16.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-17.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-25.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-23.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-18.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-08.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-22.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-04.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-24.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-31.csv
data/EXC_orderbooks/EXC_orderbooks_2019-01-30.csv
training model: results/EXC/W0/deepLOB_L1/h10
Epoch 1/50
1497/1497 - 147s - loss: 2.7404 - accuracy10: 0.4749 - val_loss: 2.6950 - val_accuracy10: 0.6071 - 147s/epoch - 98ms/step
Epoch 2/50
1497/1497 - 95s - loss: 2.5469 - accuracy10: 0.5494 - val_loss: 2.5232 - val_accuracy10: 0.6336 - 95s/epoch - 64ms/step
Epoch 3/50
1497/1497 - 95s - loss: 2.3870 - accuracy10: 0.6057 - val_loss: 2.3326 - val_accuracy10: 0.6471 - 95s/epoch - 64ms/step
Epoch 4/50
1497/1497 - 97s - loss: 2.2944 - accuracy10: 0.6281 - val_loss: 2.2854 - val_accuracy10: 0.6685 - 97s/epoch - 65ms/step
Epoch 5/50
1497/1497 - 94s - loss: 2.2466 - accuracy10: 0.6341 - val_loss: 2.2375 - val_accuracy10: 0.6667 - 94s/epoch - 63ms/step
Epoch 6/50
1497/1497 - 87s - loss: 2.2126 - accuracy10: 0.6376 - val_loss: 2.2173 - val_accuracy10: 0.6675 - 87s/epoch - 58ms/step
Epoch 7/50
1497/1497 - 96s - loss: 2.1873 - accuracy10: 0.6397 - val_loss: 2.2003 - val_accuracy10: 0.6635 - 96s/epoch - 64ms/step
Epoch 8/50
1497/1497 - 95s - loss: 2.1678 - accuracy10: 0.6429 - val_loss: 2.1713 - val_accuracy10: 0.6642 - 95s/epoch - 63ms/step
Epoch 9/50
1497/1497 - 91s - loss: 2.1514 - accuracy10: 0.6447 - val_loss: 2.1656 - val_accuracy10: 0.6712 - 91s/epoch - 60ms/step
Epoch 10/50
1497/1497 - 94s - loss: 2.1390 - accuracy10: 0.6467 - val_loss: 2.1512 - val_accuracy10: 0.6688 - 94s/epoch - 63ms/step
Epoch 11/50
1497/1497 - 95s - loss: 2.1291 - accuracy10: 0.6481 - val_loss: 2.1372 - val_accuracy10: 0.6779 - 95s/epoch - 63ms/step
Epoch 12/50
1497/1497 - 100s - loss: 2.1174 - accuracy10: 0.6507 - val_loss: 2.1400 - val_accuracy10: 0.6751 - 100s/epoch - 66ms/step
Epoch 13/50
1497/1497 - 97s - loss: 2.1131 - accuracy10: 0.6506 - val_loss: 2.1224 - val_accuracy10: 0.6716 - 97s/epoch - 65ms/step
Epoch 14/50
1497/1497 - 98s - loss: 2.1043 - accuracy10: 0.6513 - val_loss: 2.1291 - val_accuracy10: 0.6710 - 98s/epoch - 66ms/step
Epoch 15/50
1497/1497 - 97s - loss: 2.0972 - accuracy10: 0.6520 - val_loss: 2.1177 - val_accuracy10: 0.6688 - 97s/epoch - 65ms/step
Epoch 16/50
1497/1497 - 92s - loss: 2.0913 - accuracy10: 0.6524 - val_loss: 2.1204 - val_accuracy10: 0.6753 - 92s/epoch - 61ms/step
Epoch 17/50
1497/1497 - 88s - loss: 2.0860 - accuracy10: 0.6538 - val_loss: 2.1082 - val_accuracy10: 0.6705 - 88s/epoch - 59ms/step
Epoch 18/50
1497/1497 - 93s - loss: 2.0806 - accuracy10: 0.6540 - val_loss: 2.1194 - val_accuracy10: 0.6683 - 93s/epoch - 62ms/step
Epoch 19/50
1497/1497 - 96s - loss: 2.0751 - accuracy10: 0.6556 - val_loss: 2.1233 - val_accuracy10: 0.6773 - 96s/epoch - 64ms/step
Epoch 20/50
1497/1497 - 95s - loss: 2.0708 - accuracy10: 0.6556 - val_loss: 2.1149 - val_accuracy10: 0.6700 - 95s/epoch - 63ms/step
Epoch 21/50
1497/1497 - 89s - loss: 2.0668 - accuracy10: 0.6564 - val_loss: 2.1070 - val_accuracy10: 0.6679 - 89s/epoch - 59ms/step
Epoch 22/50
1497/1497 - 91s - loss: 2.0620 - accuracy10: 0.6563 - val_loss: 2.1048 - val_accuracy10: 0.6719 - 91s/epoch - 61ms/step
Epoch 23/50
1497/1497 - 92s - loss: 2.0580 - accuracy10: 0.6568 - val_loss: 2.1127 - val_accuracy10: 0.6638 - 92s/epoch - 61ms/step
Epoch 24/50
1497/1497 - 96s - loss: 2.0525 - accuracy10: 0.6578 - val_loss: 2.1064 - val_accuracy10: 0.6660 - 96s/epoch - 64ms/step
Epoch 25/50
1497/1497 - 96s - loss: 2.0487 - accuracy10: 0.6580 - val_loss: 2.1054 - val_accuracy10: 0.6668 - 96s/epoch - 64ms/step
Epoch 26/50
1497/1497 - 95s - loss: 2.0470 - accuracy10: 0.6584 - val_loss: 2.1121 - val_accuracy10: 0.6702 - 95s/epoch - 64ms/step
Epoch 27/50
1497/1497 - 95s - loss: 2.0417 - accuracy10: 0.6590 - val_loss: 2.1240 - val_accuracy10: 0.6666 - 95s/epoch - 64ms/step
Epoch 28/50
1497/1497 - 92s - loss: 2.0403 - accuracy10: 0.6589 - val_loss: 2.1195 - val_accuracy10: 0.6647 - 92s/epoch - 61ms/step
Epoch 29/50
1497/1497 - 90s - loss: 2.0355 - accuracy10: 0.6590 - val_loss: 2.1113 - val_accuracy10: 0.6618 - 90s/epoch - 60ms/step
Epoch 30/50
1497/1497 - 95s - loss: 2.0324 - accuracy10: 0.6595 - val_loss: 2.1366 - val_accuracy10: 0.6674 - 95s/epoch - 64ms/step
Epoch 31/50
1497/1497 - 95s - loss: 2.0285 - accuracy10: 0.6603 - val_loss: 2.1428 - val_accuracy10: 0.6651 - 95s/epoch - 64ms/step
Epoch 32/50
1497/1497 - 87s - loss: 2.0240 - accuracy10: 0.6599 - val_loss: 2.1315 - val_accuracy10: 0.6577 - 87s/epoch - 58ms/step
testing model: results/EXC/W0/deepLOB_L1/h10
Evaluating performance on  test set...
4693/4693 - 104s - 104s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6752671
{'0': {'precision': 0.34353097144452005, 'recall': 0.7198163688996754, 'f1-score': 0.46509584796578435, 'support': 136796}, '1': {'precision': 0.9318672635903574, 'recall': 0.6828540071553258, 'f1-score': 0.7881599216014352, 'support': 925744}, '2': {'precision': 0.3874253778737457, 'recall': 0.6599688428583792, 'f1-score': 0.48823771082215967, 'support': 138652}, 'accuracy': 0.6844218076710468, 'macro avg': {'precision': 0.5542745376362077, 'recall': 0.6875464063044602, 'f1-score': 0.5804978267964597, 'support': 1201192}, 'weighted avg': {'precision': 0.8020212375106287, 'recall': 0.6844218076710468, 'f1-score': 0.7167486173419741, 'support': 1201192}}
[[ 98468  18442  19886]
 [168798 632148 124798]
 [ 19369  27777  91506]]
Evaluating performance on  train set...
1497/1497 - 37s - 37s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70924056
{'0': {'precision': 0.36550616298847194, 'recall': 0.7058596918085969, 'f1-score': 0.48162085137584215, 'support': 49320}, '1': {'precision': 0.9169578308799976, 'recall': 0.6577352021067887, 'f1-score': 0.7660101766924103, 'support': 282895}, '2': {'precision': 0.3971076227907086, 'recall': 0.6625633172340676, 'f1-score': 0.49658612672533037, 'support': 50934}, 'accuracy': 0.6645717462397135, 'macro avg': {'precision': 0.5598572055530594, 'recall': 0.675386070383151, 'f1-score': 0.5814057182645277, 'support': 383149}, 'weighted avg': {'precision': 0.7768670391534632, 'recall': 0.6645717462397135, 'f1-score': 0.6935868476855843, 'support': 383149}}
[[ 34813   6972   7535]
 [ 53125 186070  43700]
 [  7308   9879  33747]]
Evaluating performance on  val set...
547/547 - 13s - 13s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6951461
{'0': {'precision': 0.35547378104875804, 'recall': 0.6924317543754853, 'f1-score': 0.4697777147372901, 'support': 16741}, '1': {'precision': 0.9216823310731209, 'recall': 0.667067729008176, 'f1-score': 0.7739726403842878, 'support': 105553}, '2': {'precision': 0.3848000259495929, 'recall': 0.6763783568048349, 'f1-score': 0.4905309295401918, 'support': 17539}, 'accuracy': 0.6712721603627184, 'macro avg': {'precision': 0.5539853793571573, 'recall': 0.6786259467294987, 'f1-score': 0.5780937615539232, 'support': 139833}, 'weighted avg': {'precision': 0.7865548855808594, 'recall': 0.6712721603627184, 'f1-score': 0.702002422933822, 'support': 139833}}
[[11592  2667  2482]
 [18658 70411 16484]
 [ 2360  3316 11863]]
training model: results/EXC/W0/deepLOB_L1/h20
Epoch 1/50
1497/1497 - 98s - loss: 2.8120 - accuracy20: 0.4795 - val_loss: 2.7715 - val_accuracy20: 0.4826 - 98s/epoch - 65ms/step
Epoch 2/50
1497/1497 - 97s - loss: 2.6146 - accuracy20: 0.5507 - val_loss: 2.6389 - val_accuracy20: 0.5730 - 97s/epoch - 65ms/step
Epoch 3/50
1497/1497 - 97s - loss: 2.4632 - accuracy20: 0.5968 - val_loss: 2.5292 - val_accuracy20: 0.5895 - 97s/epoch - 65ms/step
Epoch 4/50
1497/1497 - 94s - loss: 2.3930 - accuracy20: 0.6128 - val_loss: 2.4301 - val_accuracy20: 0.6219 - 94s/epoch - 63ms/step
Epoch 5/50
1497/1497 - 92s - loss: 2.3444 - accuracy20: 0.6207 - val_loss: 2.4419 - val_accuracy20: 0.6158 - 92s/epoch - 62ms/step
Epoch 6/50
1497/1497 - 91s - loss: 2.3069 - accuracy20: 0.6276 - val_loss: 2.3918 - val_accuracy20: 0.6237 - 91s/epoch - 60ms/step
Epoch 7/50
1497/1497 - 94s - loss: 2.2826 - accuracy20: 0.6317 - val_loss: 2.3665 - val_accuracy20: 0.6263 - 94s/epoch - 62ms/step
Epoch 8/50
1497/1497 - 93s - loss: 2.2611 - accuracy20: 0.6357 - val_loss: 2.3479 - val_accuracy20: 0.6209 - 93s/epoch - 62ms/step
Epoch 9/50
1497/1497 - 97s - loss: 2.2485 - accuracy20: 0.6374 - val_loss: 2.3247 - val_accuracy20: 0.6272 - 97s/epoch - 65ms/step
Epoch 10/50
1497/1497 - 91s - loss: 2.2371 - accuracy20: 0.6394 - val_loss: 2.2970 - val_accuracy20: 0.6383 - 91s/epoch - 61ms/step
Epoch 11/50
1497/1497 - 93s - loss: 2.2271 - accuracy20: 0.6412 - val_loss: 2.3232 - val_accuracy20: 0.6307 - 93s/epoch - 62ms/step
Epoch 12/50
1497/1497 - 97s - loss: 2.2170 - accuracy20: 0.6430 - val_loss: 2.3391 - val_accuracy20: 0.6346 - 97s/epoch - 65ms/step
Epoch 13/50
1497/1497 - 93s - loss: 2.2101 - accuracy20: 0.6439 - val_loss: 2.3388 - val_accuracy20: 0.6387 - 93s/epoch - 62ms/step
Epoch 14/50
1497/1497 - 93s - loss: 2.2036 - accuracy20: 0.6447 - val_loss: 2.3264 - val_accuracy20: 0.6420 - 93s/epoch - 62ms/step
Epoch 15/50
1497/1497 - 93s - loss: 2.1988 - accuracy20: 0.6460 - val_loss: 2.2960 - val_accuracy20: 0.6460 - 93s/epoch - 62ms/step
Epoch 16/50
1497/1497 - 97s - loss: 2.1919 - accuracy20: 0.6466 - val_loss: 2.3538 - val_accuracy20: 0.6400 - 97s/epoch - 64ms/step
Epoch 17/50
1497/1497 - 93s - loss: 2.1861 - accuracy20: 0.6478 - val_loss: 2.3193 - val_accuracy20: 0.6354 - 93s/epoch - 62ms/step
Epoch 18/50
1497/1497 - 49s - loss: 2.1822 - accuracy20: 0.6490 - val_loss: 2.3096 - val_accuracy20: 0.6488 - 49s/epoch - 33ms/step
Epoch 19/50
1497/1497 - 26s - loss: 2.1760 - accuracy20: 0.6493 - val_loss: 2.3180 - val_accuracy20: 0.6551 - 26s/epoch - 17ms/step
Epoch 20/50
1497/1497 - 26s - loss: 2.1715 - accuracy20: 0.6494 - val_loss: 2.3231 - val_accuracy20: 0.6505 - 26s/epoch - 17ms/step
Epoch 21/50
1497/1497 - 25s - loss: 2.1675 - accuracy20: 0.6512 - val_loss: 2.3216 - val_accuracy20: 0.6453 - 25s/epoch - 17ms/step
Epoch 22/50
1497/1497 - 26s - loss: 2.1644 - accuracy20: 0.6509 - val_loss: 2.3429 - val_accuracy20: 0.6412 - 26s/epoch - 17ms/step
Epoch 23/50
1497/1497 - 25s - loss: 2.1605 - accuracy20: 0.6517 - val_loss: 2.3430 - val_accuracy20: 0.6390 - 25s/epoch - 17ms/step
Epoch 24/50
1497/1497 - 25s - loss: 2.1554 - accuracy20: 0.6521 - val_loss: 2.3347 - val_accuracy20: 0.6443 - 25s/epoch - 17ms/step
Epoch 25/50
1497/1497 - 25s - loss: 2.1515 - accuracy20: 0.6530 - val_loss: 2.3324 - val_accuracy20: 0.6386 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h20
Evaluating performance on  test set...
4693/4693 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73770434
{'0': {'precision': 0.39227219814588854, 'recall': 0.7345869993434012, 'f1-score': 0.5114357811585722, 'support': 190375}, '1': {'precision': 0.8715609481885231, 'recall': 0.6608209916723556, 'f1-score': 0.7517000234773414, 'support': 818839}, '2': {'precision': 0.4817056826304503, 'recall': 0.5616528977278646, 'f1-score': 0.5186163177159239, 'support': 191978}, 'accuracy': 0.6566627150363972, 'macro avg': {'precision': 0.5818462763216207, 'recall': 0.6523536295812072, 'f1-score': 0.5939173741172792, 'support': 1201192}, 'weighted avg': {'precision': 0.7332914376018107, 'recall': 0.6566627150363972, 'f1-score': 0.676368811817506, 'support': 1201192}}
[[139847  29740  20788]
 [182506 541106  95227]
 [ 34152  50001 107825]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7796302
{'0': {'precision': 0.4132743821350236, 'recall': 0.7102279472871899, 'f1-score': 0.5225071784961732, 'support': 67384}, '1': {'precision': 0.8451727364680302, 'recall': 0.6329414909992385, 'f1-score': 0.7238207738364081, 'support': 246868}, '2': {'precision': 0.4704498605553535, 'recall': 0.5631304701220663, 'f1-score': 0.5126348543605938, 'support': 68897}, 'accuracy': 0.6339805141080885, 'macro avg': {'precision': 0.5762989930528024, 'recall': 0.6354333028028315, 'f1-score': 0.5863209355643916, 'support': 383149}, 'weighted avg': {'precision': 0.7018334071467192, 'recall': 0.6339805141080885, 'f1-score': 0.6504409878979571, 'support': 383149}}
[[ 47858  11345   8181]
 [ 55124 156253  35491]
 [ 12820  17279  38798]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7585682
{'0': {'precision': 0.40786765462591335, 'recall': 0.6868717504332755, 'f1-score': 0.5118163621101569, 'support': 23080}, '1': {'precision': 0.8507349747067808, 'recall': 0.654629559741646, 'f1-score': 0.7399088382976649, 'support': 92741}, '2': {'precision': 0.47098169042632254, 'recall': 0.5806263534899218, 'f1-score': 0.5200880367068303, 'support': 24012}, 'accuracy': 0.6472434976007094, 'macro avg': {'precision': 0.5765281065863389, 'recall': 0.6407092212216144, 'f1-score': 0.5906044123715507, 'support': 139833}, 'weighted avg': {'precision': 0.7124270387431042, 'recall': 0.6472434976007094, 'f1-score': 0.6645138211114012, 'support': 139833}}
[[15853  4773  2454]
 [18824 60711 13206]
 [ 4191  5879 13942]]
training model: results/EXC/W0/deepLOB_L1/h30
Epoch 1/50
1497/1497 - 27s - loss: 2.8852 - accuracy30: 0.4778 - val_loss: 2.8510 - val_accuracy30: 0.4810 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 2.7145 - accuracy30: 0.5376 - val_loss: 2.6907 - val_accuracy30: 0.5840 - 25s/epoch - 17ms/step
Epoch 3/50
1497/1497 - 25s - loss: 2.5550 - accuracy30: 0.5859 - val_loss: 2.5153 - val_accuracy30: 0.5930 - 25s/epoch - 17ms/step
Epoch 4/50
1497/1497 - 25s - loss: 2.4877 - accuracy30: 0.6003 - val_loss: 2.4868 - val_accuracy30: 0.6177 - 25s/epoch - 17ms/step
Epoch 5/50
1497/1497 - 25s - loss: 2.4487 - accuracy30: 0.6056 - val_loss: 2.4437 - val_accuracy30: 0.6286 - 25s/epoch - 17ms/step
Epoch 6/50
1497/1497 - 25s - loss: 2.4270 - accuracy30: 0.6096 - val_loss: 2.4405 - val_accuracy30: 0.6180 - 25s/epoch - 17ms/step
Epoch 7/50
1497/1497 - 25s - loss: 2.4046 - accuracy30: 0.6132 - val_loss: 2.4148 - val_accuracy30: 0.6264 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 25s - loss: 2.3888 - accuracy30: 0.6153 - val_loss: 2.4066 - val_accuracy30: 0.6177 - 25s/epoch - 17ms/step
Epoch 9/50
1497/1497 - 25s - loss: 2.3751 - accuracy30: 0.6175 - val_loss: 2.3817 - val_accuracy30: 0.6168 - 25s/epoch - 16ms/step
Epoch 10/50
1497/1497 - 25s - loss: 2.3663 - accuracy30: 0.6182 - val_loss: 2.3882 - val_accuracy30: 0.6166 - 25s/epoch - 17ms/step
Epoch 11/50
1497/1497 - 25s - loss: 2.3560 - accuracy30: 0.6207 - val_loss: 2.3792 - val_accuracy30: 0.6170 - 25s/epoch - 17ms/step
Epoch 12/50
1497/1497 - 25s - loss: 2.3473 - accuracy30: 0.6214 - val_loss: 2.3769 - val_accuracy30: 0.6178 - 25s/epoch - 17ms/step
Epoch 13/50
1497/1497 - 25s - loss: 2.3412 - accuracy30: 0.6227 - val_loss: 2.3718 - val_accuracy30: 0.6129 - 25s/epoch - 17ms/step
Epoch 14/50
1497/1497 - 25s - loss: 2.3325 - accuracy30: 0.6236 - val_loss: 2.3736 - val_accuracy30: 0.6163 - 25s/epoch - 17ms/step
Epoch 15/50
1497/1497 - 25s - loss: 2.3273 - accuracy30: 0.6245 - val_loss: 2.3606 - val_accuracy30: 0.6159 - 25s/epoch - 17ms/step
Epoch 16/50
1497/1497 - 25s - loss: 2.3206 - accuracy30: 0.6252 - val_loss: 2.3527 - val_accuracy30: 0.6200 - 25s/epoch - 17ms/step
Epoch 17/50
1497/1497 - 25s - loss: 2.3161 - accuracy30: 0.6265 - val_loss: 2.3494 - val_accuracy30: 0.6197 - 25s/epoch - 16ms/step
Epoch 18/50
1497/1497 - 25s - loss: 2.3116 - accuracy30: 0.6269 - val_loss: 2.3559 - val_accuracy30: 0.6180 - 25s/epoch - 17ms/step
Epoch 19/50
1497/1497 - 25s - loss: 2.3063 - accuracy30: 0.6277 - val_loss: 2.3547 - val_accuracy30: 0.6206 - 25s/epoch - 17ms/step
Epoch 20/50
1497/1497 - 25s - loss: 2.3025 - accuracy30: 0.6284 - val_loss: 2.3613 - val_accuracy30: 0.6164 - 25s/epoch - 17ms/step
Epoch 21/50
1497/1497 - 24s - loss: 2.2982 - accuracy30: 0.6288 - val_loss: 2.3594 - val_accuracy30: 0.6197 - 24s/epoch - 16ms/step
Epoch 22/50
1497/1497 - 25s - loss: 2.2951 - accuracy30: 0.6291 - val_loss: 2.3585 - val_accuracy30: 0.6215 - 25s/epoch - 17ms/step
Epoch 23/50
1497/1497 - 25s - loss: 2.2892 - accuracy30: 0.6299 - val_loss: 2.3625 - val_accuracy30: 0.6212 - 25s/epoch - 16ms/step
Epoch 24/50
1497/1497 - 25s - loss: 2.2852 - accuracy30: 0.6312 - val_loss: 2.3552 - val_accuracy30: 0.6219 - 25s/epoch - 16ms/step
Epoch 25/50
1497/1497 - 25s - loss: 2.2817 - accuracy30: 0.6306 - val_loss: 2.3645 - val_accuracy30: 0.6158 - 25s/epoch - 17ms/step
Epoch 26/50
1497/1497 - 25s - loss: 2.2763 - accuracy30: 0.6327 - val_loss: 2.3631 - val_accuracy30: 0.6149 - 25s/epoch - 16ms/step
Epoch 27/50
1497/1497 - 25s - loss: 2.2741 - accuracy30: 0.6319 - val_loss: 2.3659 - val_accuracy30: 0.6091 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h30
Evaluating performance on  test set...
4693/4693 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77416164
{'0': {'precision': 0.433143398277133, 'recall': 0.7038031124322434, 'f1-score': 0.536256840520529, 'support': 228760}, '1': {'precision': 0.8277795999870242, 'recall': 0.6184903460190373, 'f1-score': 0.7079918830330575, 'support': 742647}, '2': {'precision': 0.49797890780906323, 'recall': 0.5951084709619862, 'f1-score': 0.5422283198087191, 'support': 229785}, 'accuracy': 0.6302647703281408, 'macro avg': {'precision': 0.5863006353577401, 'recall': 0.6391339764710889, 'f1-score': 0.5954923477874353, 'support': 1201192}, 'weighted avg': {'precision': 0.6895333999163715, 'recall': 0.6302647703281408, 'f1-score': 0.6435757957625207, 'support': 1201192}}
[[161002  39829  27929]
 [173399 459320 109928]
 [ 37305  55733 136747]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.812358
{'0': {'precision': 0.45565302144249514, 'recall': 0.6784516839313416, 'f1-score': 0.5451675814785774, 'support': 79932}, '1': {'precision': 0.7943110512161813, 'recall': 0.5954744518963192, 'f1-score': 0.680668976325992, 'support': 221719}, '2': {'precision': 0.48939907675967154, 'recall': 0.5879898893224373, 'f1-score': 0.5341835085333363, 'support': 81498}, 'accuracy': 0.6111930345635771, 'macro avg': {'precision': 0.5797877164727826, 'recall': 0.6206386750500327, 'f1-score': 0.5866733554459685, 'support': 383149}, 'weighted avg': {'precision': 0.6588041603457186, 'recall': 0.6111930345635771, 'f1-score': 0.6212425648069502, 'support': 383149}}
[[ 54230  14729  10973]
 [ 50668 132028  39023]
 [ 14118  19460  47920]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79617304
{'0': {'precision': 0.45317068494463886, 'recall': 0.6852328320347889, 'f1-score': 0.5455489678452417, 'support': 27595}, '1': {'precision': 0.8098386627437033, 'recall': 0.5991794847259766, 'f1-score': 0.6887614805037673, 'support': 83606}, '2': {'precision': 0.4871858534028525, 'recall': 0.6167924001117631, 'f1-score': 0.5443812518302737, 'support': 28632}, 'accuracy': 0.6197678659543885, 'macro avg': {'precision': 0.5833984003637315, 'recall': 0.6337349056241762, 'f1-score': 0.5928972333930942, 'support': 139833}, 'weighted avg': {'precision': 0.6733869804912135, 'recall': 0.6197678659543885, 'f1-score': 0.6309364750029808, 'support': 139833}}
[[18909  5222  3464]
 [18386 50095 15125]
 [ 4431  6541 17660]]
training model: results/EXC/W0/deepLOB_L1/h50
Epoch 1/50
1497/1497 - 28s - loss: 2.9902 - accuracy50: 0.4708 - val_loss: 2.9892 - val_accuracy50: 0.4659 - 28s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 26s - loss: 2.8824 - accuracy50: 0.5013 - val_loss: 2.9237 - val_accuracy50: 0.4969 - 26s/epoch - 17ms/step
Epoch 3/50
1497/1497 - 25s - loss: 2.7588 - accuracy50: 0.5451 - val_loss: 2.7441 - val_accuracy50: 0.5425 - 25s/epoch - 17ms/step
Epoch 4/50
1497/1497 - 25s - loss: 2.6946 - accuracy50: 0.5621 - val_loss: 2.7139 - val_accuracy50: 0.5442 - 25s/epoch - 17ms/step
Epoch 5/50
1497/1497 - 25s - loss: 2.6559 - accuracy50: 0.5692 - val_loss: 2.6824 - val_accuracy50: 0.5558 - 25s/epoch - 17ms/step
Epoch 6/50
1497/1497 - 25s - loss: 2.6304 - accuracy50: 0.5740 - val_loss: 2.6616 - val_accuracy50: 0.5569 - 25s/epoch - 16ms/step
Epoch 7/50
1497/1497 - 25s - loss: 2.6112 - accuracy50: 0.5777 - val_loss: 2.6576 - val_accuracy50: 0.5549 - 25s/epoch - 16ms/step
Epoch 8/50
1497/1497 - 25s - loss: 2.5966 - accuracy50: 0.5798 - val_loss: 2.6516 - val_accuracy50: 0.5580 - 25s/epoch - 17ms/step
Epoch 9/50
1497/1497 - 25s - loss: 2.5847 - accuracy50: 0.5820 - val_loss: 2.6510 - val_accuracy50: 0.5564 - 25s/epoch - 17ms/step
Epoch 10/50
1497/1497 - 25s - loss: 2.5737 - accuracy50: 0.5833 - val_loss: 2.6594 - val_accuracy50: 0.5631 - 25s/epoch - 17ms/step
Epoch 11/50
1497/1497 - 25s - loss: 2.5657 - accuracy50: 0.5853 - val_loss: 2.6584 - val_accuracy50: 0.5597 - 25s/epoch - 17ms/step
Epoch 12/50
1497/1497 - 25s - loss: 2.5582 - accuracy50: 0.5866 - val_loss: 2.6457 - val_accuracy50: 0.5661 - 25s/epoch - 16ms/step
Epoch 13/50
1497/1497 - 25s - loss: 2.5542 - accuracy50: 0.5874 - val_loss: 2.6357 - val_accuracy50: 0.5634 - 25s/epoch - 16ms/step
Epoch 14/50
1497/1497 - 25s - loss: 2.5476 - accuracy50: 0.5884 - val_loss: 2.6483 - val_accuracy50: 0.5574 - 25s/epoch - 17ms/step
Epoch 15/50
1497/1497 - 25s - loss: 2.5437 - accuracy50: 0.5888 - val_loss: 2.6321 - val_accuracy50: 0.5604 - 25s/epoch - 17ms/step
Epoch 16/50
1497/1497 - 25s - loss: 2.5378 - accuracy50: 0.5900 - val_loss: 2.6496 - val_accuracy50: 0.5575 - 25s/epoch - 16ms/step
Epoch 17/50
1497/1497 - 25s - loss: 2.5335 - accuracy50: 0.5912 - val_loss: 2.6457 - val_accuracy50: 0.5555 - 25s/epoch - 17ms/step
Epoch 18/50
1497/1497 - 25s - loss: 2.5285 - accuracy50: 0.5918 - val_loss: 2.6410 - val_accuracy50: 0.5540 - 25s/epoch - 17ms/step
Epoch 19/50
1497/1497 - 25s - loss: 2.5245 - accuracy50: 0.5923 - val_loss: 2.6464 - val_accuracy50: 0.5578 - 25s/epoch - 17ms/step
Epoch 20/50
1497/1497 - 25s - loss: 2.5201 - accuracy50: 0.5932 - val_loss: 2.6565 - val_accuracy50: 0.5579 - 25s/epoch - 16ms/step
Epoch 21/50
1497/1497 - 25s - loss: 2.5169 - accuracy50: 0.5938 - val_loss: 2.6384 - val_accuracy50: 0.5552 - 25s/epoch - 17ms/step
Epoch 22/50
1497/1497 - 25s - loss: 2.5138 - accuracy50: 0.5941 - val_loss: 2.6439 - val_accuracy50: 0.5578 - 25s/epoch - 16ms/step
Epoch 23/50
1497/1497 - 25s - loss: 2.5103 - accuracy50: 0.5945 - val_loss: 2.6498 - val_accuracy50: 0.5534 - 25s/epoch - 17ms/step
Epoch 24/50
1497/1497 - 25s - loss: 2.5069 - accuracy50: 0.5955 - val_loss: 2.6523 - val_accuracy50: 0.5582 - 25s/epoch - 17ms/step
Epoch 25/50
1497/1497 - 25s - loss: 2.5028 - accuracy50: 0.5964 - val_loss: 2.6633 - val_accuracy50: 0.5581 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h50
Evaluating performance on  test set...
4693/4693 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8617635
{'0': {'precision': 0.46373244641537326, 'recall': 0.6579156166222182, 'f1-score': 0.5440152370162384, 'support': 286099}, '1': {'precision': 0.7051039243400374, 'recall': 0.5613200179776427, 'f1-score': 0.6250496919101571, 'support': 627446}, '2': {'precision': 0.5256360845723713, 'recall': 0.5405236279189423, 'f1-score': 0.5329759135885206, 'support': 287647}, 'accuracy': 0.5793470152981371, 'macro avg': {'precision': 0.5648241517759273, 'recall': 0.5865864208396011, 'f1-score': 0.567346947504972, 'support': 1201192}, 'weighted avg': {'precision': 0.6046374508966426, 'recall': 0.5793470152981371, 'f1-score': 0.5837002468392782, 'support': 1201192}}
[[188229  62444  35426]
 [170360 352198 104888]
 [ 47311  84856 155480]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8920603
{'0': {'precision': 0.4910783060295881, 'recall': 0.6254652479974108, 'f1-score': 0.5501843853007772, 'support': 98872}, '1': {'precision': 0.6647238412434082, 'recall': 0.5474971016780331, 'f1-score': 0.60044231808102, 'support': 183727}, '2': {'precision': 0.5120686724460309, 'recall': 0.5392839383391348, 'f1-score': 0.5253240588246693, 'support': 100550}, 'accuracy': 0.5654614784326724, 'macro avg': {'precision': 0.5559569399063423, 'recall': 0.5707487626715262, 'f1-score': 0.5586502540688222, 'support': 383149}, 'weighted avg': {'precision': 0.5798530505582254, 'recall': 0.5654614784326724, 'f1-score': 0.5677598804442933, 'support': 383149}}
[[ 61841  22127  14904]
 [ 46372 100590  36765]
 [ 17716  28609  54225]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8896411
{'0': {'precision': 0.5008215654990117, 'recall': 0.605661790116346, 'f1-score': 0.5482748282649217, 'support': 34724}, '1': {'precision': 0.6702985320195243, 'recall': 0.527462093966683, 'f1-score': 0.590363482671175, 'support': 69514}, '2': {'precision': 0.4775956790838916, 'recall': 0.5788172496137098, 'f1-score': 0.5233571265272945, 'support': 35595}, 'accuracy': 0.5599536590075304, 'macro avg': {'precision': 0.5495719255341426, 'recall': 0.5706470445655796, 'f1-score': 0.5539984791544638, 'support': 139833}, 'weighted avg': {'precision': 0.5791599864994958, 'recall': 0.5599536590075304, 'f1-score': 0.5628551142420906, 'support': 139833}}
[[21031  8436  5257]
 [15569 36666 17279]
 [ 5393  9599 20603]]
training model: results/EXC/W0/deepLOB_L1/h100
Epoch 1/50
1497/1497 - 27s - loss: 3.1324 - accuracy100: 0.4537 - val_loss: 3.1662 - val_accuracy100: 0.4343 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 3.0860 - accuracy100: 0.4689 - val_loss: 3.1583 - val_accuracy100: 0.4412 - 25s/epoch - 17ms/step
Epoch 3/50
1497/1497 - 25s - loss: 3.0371 - accuracy100: 0.4856 - val_loss: 3.1218 - val_accuracy100: 0.4499 - 25s/epoch - 17ms/step
Epoch 4/50
1497/1497 - 25s - loss: 2.9967 - accuracy100: 0.4965 - val_loss: 3.1080 - val_accuracy100: 0.4650 - 25s/epoch - 17ms/step
Epoch 5/50
1497/1497 - 25s - loss: 2.9727 - accuracy100: 0.5013 - val_loss: 3.0996 - val_accuracy100: 0.4624 - 25s/epoch - 17ms/step
Epoch 6/50
1497/1497 - 25s - loss: 2.9530 - accuracy100: 0.5050 - val_loss: 3.0787 - val_accuracy100: 0.4679 - 25s/epoch - 17ms/step
Epoch 7/50
1497/1497 - 25s - loss: 2.9370 - accuracy100: 0.5092 - val_loss: 3.0843 - val_accuracy100: 0.4660 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 25s - loss: 2.9229 - accuracy100: 0.5122 - val_loss: 3.1031 - val_accuracy100: 0.4601 - 25s/epoch - 16ms/step
Epoch 9/50
1497/1497 - 25s - loss: 2.9124 - accuracy100: 0.5143 - val_loss: 3.0963 - val_accuracy100: 0.4633 - 25s/epoch - 17ms/step
Epoch 10/50
1497/1497 - 26s - loss: 2.9049 - accuracy100: 0.5152 - val_loss: 3.0929 - val_accuracy100: 0.4642 - 26s/epoch - 17ms/step
Epoch 11/50
1497/1497 - 25s - loss: 2.8984 - accuracy100: 0.5167 - val_loss: 3.1109 - val_accuracy100: 0.4606 - 25s/epoch - 17ms/step
Epoch 12/50
1497/1497 - 25s - loss: 2.8918 - accuracy100: 0.5178 - val_loss: 3.1079 - val_accuracy100: 0.4626 - 25s/epoch - 17ms/step
Epoch 13/50
1497/1497 - 25s - loss: 2.8862 - accuracy100: 0.5184 - val_loss: 3.1198 - val_accuracy100: 0.4606 - 25s/epoch - 17ms/step
Epoch 14/50
1497/1497 - 25s - loss: 2.8816 - accuracy100: 0.5196 - val_loss: 3.1171 - val_accuracy100: 0.4624 - 25s/epoch - 16ms/step
Epoch 15/50
1497/1497 - 24s - loss: 2.8780 - accuracy100: 0.5196 - val_loss: 3.1207 - val_accuracy100: 0.4607 - 24s/epoch - 16ms/step
Epoch 16/50
1497/1497 - 25s - loss: 2.8730 - accuracy100: 0.5214 - val_loss: 3.1452 - val_accuracy100: 0.4531 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h100
Evaluating performance on  test set...
4693/4693 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0100968
{'0': {'precision': 0.4534656544940271, 'recall': 0.6141267718359695, 'f1-score': 0.521707332619876, 'support': 379832}, '1': {'precision': 0.5030214828879015, 'recall': 0.3565961032601888, 'f1-score': 0.4173379036084205, 'support': 439085}, '2': {'precision': 0.5093471383376474, 'recall': 0.5003413772807533, 'f1-score': 0.5048040950605114, 'support': 382275}, 'accuracy': 0.4837769482314235, 'macro avg': {'precision': 0.48861142523985873, 'recall': 0.49035475079230384, 'f1-score': 0.48128311042960265, 'support': 1201192}, 'weighted avg': {'precision': 0.4893644243381855, 'recall': 0.4837769482314235, 'f1-score': 0.4781766265583129, 'support': 1201192}}
[[233265  69960  76607]
 [174868 156576 107641]
 [106272  84735 191268]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0237225
{'0': {'precision': 0.4807860319813618, 'recall': 0.5689435058781143, 'f1-score': 0.5211629867451079, 'support': 127677}, '1': {'precision': 0.44758523826902447, 'recall': 0.32094653534440376, 'f1-score': 0.3738321210021937, 'support': 126102}, '2': {'precision': 0.4851311088832093, 'recall': 0.5311355028213651, 'f1-score': 0.5070920415633487, 'support': 129370}, 'accuracy': 0.4745568956202417, 'macro avg': {'precision': 0.47116745971119856, 'recall': 0.473675181347961, 'f1-score': 0.4673623831035501, 'support': 383149}, 'weighted avg': {'precision': 0.471326098926803, 'recall': 0.4745568956202417, 'f1-score': 0.4679224066833639, 'support': 383149}}
[[72641 23450 31586]
 [44291 40472 41339]
 [34156 26501 68713]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0261097
{'0': {'precision': 0.49757889464017363, 'recall': 0.5169011946835498, 'f1-score': 0.5070560335201473, 'support': 46121}, '1': {'precision': 0.4518307415897404, 'recall': 0.30962236515315544, 'f1-score': 0.3674471917471754, 'support': 47109}, '2': {'precision': 0.4533107530307349, 'recall': 0.5801128682702831, 'f1-score': 0.5089324372658648, 'support': 46603}, 'accuracy': 0.46813699198329434, 'macro avg': {'precision': 0.467573463086883, 'recall': 0.4688788093689961, 'f1-score': 0.4611452208443958, 'support': 139833}, 'weighted avg': {'precision': 0.4674130686514761, 'recall': 0.46813699198329434, 'f1-score': 0.46064791180838205, 'support': 139833}}
[[23840  8461 13820]
 [13739 14586 18784]
 [10333  9235 27035]]
training model: results/EXC/W0/deepLOB_L1/h200
Epoch 1/50
1497/1497 - 27s - loss: 3.2303 - accuracy200: 0.4125 - val_loss: 3.2679 - val_accuracy200: 0.3778 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 3.2024 - accuracy200: 0.4221 - val_loss: 3.3755 - val_accuracy200: 0.3570 - 25s/epoch - 17ms/step
Epoch 3/50
1497/1497 - 25s - loss: 3.1924 - accuracy200: 0.4260 - val_loss: 3.4388 - val_accuracy200: 0.3534 - 25s/epoch - 16ms/step
Epoch 4/50
1497/1497 - 25s - loss: 3.1843 - accuracy200: 0.4309 - val_loss: 3.4744 - val_accuracy200: 0.3545 - 25s/epoch - 17ms/step
Epoch 5/50
1497/1497 - 25s - loss: 3.1770 - accuracy200: 0.4333 - val_loss: 3.4762 - val_accuracy200: 0.3513 - 25s/epoch - 16ms/step
Epoch 6/50
1497/1497 - 25s - loss: 3.1717 - accuracy200: 0.4350 - val_loss: 3.4695 - val_accuracy200: 0.3590 - 25s/epoch - 16ms/step
Epoch 7/50
1497/1497 - 25s - loss: 3.1673 - accuracy200: 0.4376 - val_loss: 3.4939 - val_accuracy200: 0.3590 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 25s - loss: 3.1625 - accuracy200: 0.4387 - val_loss: 3.5426 - val_accuracy200: 0.3530 - 25s/epoch - 17ms/step
Epoch 9/50
1497/1497 - 25s - loss: 3.1587 - accuracy200: 0.4408 - val_loss: 3.5686 - val_accuracy200: 0.3583 - 25s/epoch - 16ms/step
Epoch 10/50
1497/1497 - 25s - loss: 3.1573 - accuracy200: 0.4408 - val_loss: 3.5652 - val_accuracy200: 0.3606 - 25s/epoch - 17ms/step
Epoch 11/50
1497/1497 - 25s - loss: 3.1552 - accuracy200: 0.4416 - val_loss: 3.5263 - val_accuracy200: 0.3571 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h200
Evaluating performance on  test set...
4693/4693 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0733559
{'0': {'precision': 0.36526938891109556, 'recall': 0.5190613743142415, 'f1-score': 0.4287925714844888, 'support': 350342}, '1': {'precision': 0.4501306613749551, 'recall': 0.3063489179586563, 'f1-score': 0.36457571313083265, 'support': 495360}, '2': {'precision': 0.38266359376535997, 'recall': 0.3942051815803539, 'f1-score': 0.38834865359940807, 'support': 355490}, 'accuracy': 0.39438990602668017, 'macro avg': {'precision': 0.39935454801713693, 'recall': 0.40653849128441727, 'f1-score': 0.39390564607157647, 'support': 1201192}, 'weighted avg': {'precision': 0.4054131343001257, 'recall': 0.39438990602668017, 'f1-score': 0.3903408740680604, 'support': 1201192}}
[[181849  87249  81244]
 [198775 151753 144832]
 [117225  98129 140136]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920601
{'0': {'precision': 0.3928581079255276, 'recall': 0.4567008285231869, 'f1-score': 0.42238063937420783, 'support': 127335}, '1': {'precision': 0.33997532972767813, 'recall': 0.2818241882708281, 'f1-score': 0.30818059055761504, 'support': 127136}, '2': {'precision': 0.4026254326259722, 'recall': 0.405920203919862, 'f1-score': 0.4042661052827108, 'support': 128678}, 'accuracy': 0.38161916121404466, 'macro avg': {'precision': 0.3784862900930593, 'recall': 0.38148174023795894, 'f1-score': 0.37827577840484455, 'support': 383149}, 'weighted avg': {'precision': 0.37859090357119557, 'recall': 0.38161916121404466, 'f1-score': 0.3784032848093466, 'support': 383149}}
[[58154 33377 35804]
 [49612 35830 41694]
 [40262 36183 52233]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891606
{'0': {'precision': 0.38990105914658063, 'recall': 0.3879143990806791, 'f1-score': 0.38890519199626117, 'support': 46121}, '1': {'precision': 0.35444089622763975, 'recall': 0.2841147946973008, 'f1-score': 0.3154052305701876, 'support': 48051}, '2': {'precision': 0.3798845390582717, 'recall': 0.461159413941876, 'f1-score': 0.41659494910526157, 'support': 45661}, 'accuracy': 0.376162994429069, 'macro avg': {'precision': 0.37474216481083067, 'recall': 0.3777295359066186, 'f1-score': 0.37363512389057013, 'support': 139833}, 'weighted avg': {'precision': 0.3744450465303148, 'recall': 0.376162994429069, 'f1-score': 0.3726901022311113, 'support': 139833}}
[[17891 11921 16309]
 [16335 13652 18064]
 [11660 12944 21057]]
training model: results/EXC/W0/deepLOB_L1/h300
Epoch 1/50
1497/1497 - 27s - loss: 3.2588 - accuracy300: 0.3952 - val_loss: 3.3591 - val_accuracy300: 0.3445 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 3.2228 - accuracy300: 0.4103 - val_loss: 3.4235 - val_accuracy300: 0.3518 - 25s/epoch - 17ms/step
Epoch 3/50
1497/1497 - 25s - loss: 3.2057 - accuracy300: 0.4185 - val_loss: 3.4547 - val_accuracy300: 0.3492 - 25s/epoch - 16ms/step
Epoch 4/50
1497/1497 - 25s - loss: 3.1968 - accuracy300: 0.4222 - val_loss: 3.4551 - val_accuracy300: 0.3448 - 25s/epoch - 16ms/step
Epoch 5/50
1497/1497 - 25s - loss: 3.1902 - accuracy300: 0.4256 - val_loss: 3.4686 - val_accuracy300: 0.3449 - 25s/epoch - 17ms/step
Epoch 6/50
1497/1497 - 25s - loss: 3.1855 - accuracy300: 0.4271 - val_loss: 3.5384 - val_accuracy300: 0.3459 - 25s/epoch - 17ms/step
Epoch 7/50
1497/1497 - 25s - loss: 3.1800 - accuracy300: 0.4296 - val_loss: 3.5305 - val_accuracy300: 0.3455 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 24s - loss: 3.1763 - accuracy300: 0.4308 - val_loss: 3.5342 - val_accuracy300: 0.3407 - 24s/epoch - 16ms/step
Epoch 9/50
1497/1497 - 24s - loss: 3.1732 - accuracy300: 0.4321 - val_loss: 3.5472 - val_accuracy300: 0.3454 - 24s/epoch - 16ms/step
Epoch 10/50
1497/1497 - 25s - loss: 3.1695 - accuracy300: 0.4330 - val_loss: 3.5483 - val_accuracy300: 0.3425 - 25s/epoch - 16ms/step
Epoch 11/50
1497/1497 - 25s - loss: 3.1670 - accuracy300: 0.4341 - val_loss: 3.5573 - val_accuracy300: 0.3421 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h300
Evaluating performance on  test set...
4693/4693 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054294
{'0': {'precision': 0.3538227934505702, 'recall': 0.5360260424773065, 'f1-score': 0.42627067442036104, 'support': 379073}, '1': {'precision': 0.3841491495995469, 'recall': 0.3359380063141717, 'f1-score': 0.3584296661423001, 'support': 432044}, '2': {'precision': 0.3914754045710202, 'recall': 0.249985259245017, 'f1-score': 0.305125741982521, 'support': 390075}, 'accuracy': 0.37116963815942833, 'macro avg': {'precision': 0.37648244920704577, 'recall': 0.37398310267883167, 'f1-score': 0.36327536084839407, 'support': 1201192}, 'weighted avg': {'precision': 0.37695786469549863, 'recall': 0.37116963815942833, 'f1-score': 0.3625290660004107, 'support': 1201192}}
[[203193 107396  68484]
 [203810 145140  83094]
 [167276 125286  97513]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1113651
{'0': {'precision': 0.36266117607510745, 'recall': 0.47650408556014767, 'f1-score': 0.411860547556719, 'support': 126788}, '1': {'precision': 0.35159737781097006, 'recall': 0.3350625113675004, 'f1-score': 0.343130863637652, 'support': 126457}, '2': {'precision': 0.39493602357081137, 'recall': 0.2920156423204828, 'f1-score': 0.3357659711004404, 'support': 129904}, 'accuracy': 0.3672722622269665, 'macro avg': {'precision': 0.369731525818963, 'recall': 0.36786074641604366, 'f1-score': 0.36358579409827047, 'support': 383149}, 'weighted avg': {'precision': 0.3699521700539353, 'recall': 0.3672722622269665, 'f1-score': 0.3633772173135763, 'support': 383149}}
[[60415 37724 28649]
 [54618 42371 29468]
 [51555 40415 37934]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1206733
{'0': {'precision': 0.3633861846091699, 'recall': 0.2983809109190041, 'f1-score': 0.3276908190562923, 'support': 48237}, '1': {'precision': 0.3136521325079927, 'recall': 0.31810969299758535, 'f1-score': 0.31586518701191946, 'support': 43485}, '2': {'precision': 0.35551120772602546, 'recall': 0.41470765521398434, 'f1-score': 0.38283461091976634, 'support': 48111}, 'accuracy': 0.3445395579012107, 'macro avg': {'precision': 0.3441831749477293, 'recall': 0.3437327530435246, 'f1-score': 0.3421302056626594, 'support': 139833}, 'weighted avg': {'precision': 0.34521051600129726, 'recall': 0.3445395579012107, 'f1-score': 0.34298610243642463, 'support': 139833}}
[[14393 14679 19165]
 [12647 13833 17005]
 [12568 15591 19952]]
training model: results/EXC/W0/deepLOB_L1/h500
Epoch 1/50
1497/1497 - 27s - loss: 3.2638 - accuracy500: 0.3964 - val_loss: 3.4655 - val_accuracy500: 0.3597 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 3.2239 - accuracy500: 0.4121 - val_loss: 3.5670 - val_accuracy500: 0.3775 - 25s/epoch - 16ms/step
Epoch 3/50
1497/1497 - 24s - loss: 3.2042 - accuracy500: 0.4214 - val_loss: 3.5716 - val_accuracy500: 0.3752 - 24s/epoch - 16ms/step
Epoch 4/50
1497/1497 - 25s - loss: 3.1937 - accuracy500: 0.4257 - val_loss: 3.5518 - val_accuracy500: 0.3746 - 25s/epoch - 17ms/step
Epoch 5/50
1497/1497 - 25s - loss: 3.1830 - accuracy500: 0.4310 - val_loss: 3.5693 - val_accuracy500: 0.3713 - 25s/epoch - 16ms/step
Epoch 6/50
1497/1497 - 25s - loss: 3.1775 - accuracy500: 0.4326 - val_loss: 3.5802 - val_accuracy500: 0.3665 - 25s/epoch - 17ms/step
Epoch 7/50
1497/1497 - 25s - loss: 3.1673 - accuracy500: 0.4372 - val_loss: 3.6125 - val_accuracy500: 0.3675 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 25s - loss: 3.1622 - accuracy500: 0.4374 - val_loss: 3.6916 - val_accuracy500: 0.3576 - 25s/epoch - 17ms/step
Epoch 9/50
1497/1497 - 25s - loss: 3.1561 - accuracy500: 0.4417 - val_loss: 3.7252 - val_accuracy500: 0.3473 - 25s/epoch - 16ms/step
Epoch 10/50
1497/1497 - 25s - loss: 3.1528 - accuracy500: 0.4419 - val_loss: 3.7029 - val_accuracy500: 0.3526 - 25s/epoch - 17ms/step
Epoch 11/50
1497/1497 - 25s - loss: 3.1474 - accuracy500: 0.4435 - val_loss: 3.7080 - val_accuracy500: 0.3492 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h500
Evaluating performance on  test set...
4693/4693 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.085011
{'0': {'precision': 0.1880246386296427, 'recall': 0.5174683906376398, 'f1-score': 0.2758264167484587, 'support': 223747}, '1': {'precision': 0.6082300392846252, 'recall': 0.3195952360113377, 'f1-score': 0.41901730450778724, 'support': 742655}, '2': {'precision': 0.24796856267483683, 'recall': 0.20613739937816772, 'f1-score': 0.22512628729312606, 'support': 234790}, 'accuracy': 0.33427628555634736, 'macro avg': {'precision': 0.3480744135297016, 'recall': 0.3477336753423817, 'f1-score': 0.30665666951645737, 'support': 1201192}, 'weighted avg': {'precision': 0.4595398299978811, 'recall': 0.33427628555634736, 'f1-score': 0.3544462754838537, 'support': 1201192}}
[[115782  78889  29076]
 [387599 237349 117707]
 [112400  73991  48399]]
Evaluating performance on  train set...
1497/1497 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1484163
{'0': {'precision': 0.33588221325100925, 'recall': 0.4488947426884809, 'f1-score': 0.38425124119616677, 'support': 126034}, '1': {'precision': 0.3319096341044225, 'recall': 0.35943798956130557, 'f1-score': 0.34512574431355847, 'support': 126261}, '2': {'precision': 0.3936724120242126, 'recall': 0.23458969538569704, 'f1-score': 0.29399032706028827, 'support': 130854}, 'accuracy': 0.346225619798042, 'macro avg': {'precision': 0.3538214197932148, 'recall': 0.3476408092118278, 'f1-score': 0.34112243752333776, 'support': 383149}, 'weighted avg': {'precision': 0.3543097619452289, 'recall': 0.346225619798042, 'f1-score': 0.3405318891419235, 'support': 383149}}
[[56576 45626 23832]
 [57431 45383 23447]
 [54433 45724 30697]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1540188
{'0': {'precision': 0.30936179142060616, 'recall': 0.23059906598440327, 'f1-score': 0.26423596886521916, 'support': 44753}, '1': {'precision': 0.3927565928665434, 'recall': 0.46321911348632505, 'f1-score': 0.4250876734311189, 'support': 50896}, '2': {'precision': 0.35027020044351626, 'recall': 0.3682102118413905, 'f1-score': 0.35901623064955696, 'support': 44184}, 'accuracy': 0.35874936531433926, 'macro avg': {'precision': 0.3507961949102219, 'recall': 0.3540094637707063, 'f1-score': 0.3494466243152983, 'support': 139833}, 'weighted avg': {'precision': 0.3526416964405992, 'recall': 0.35874936531433926, 'f1-score': 0.3527306692740298, 'support': 139833}}
[[10320 18934 15499]
 [12641 23576 14679]
 [10398 17517 16269]]
training model: results/EXC/W0/deepLOB_L1/h1000
Epoch 1/50
1497/1497 - 27s - loss: 3.2061 - accuracy1000: 0.4370 - val_loss: 3.4593 - val_accuracy1000: 0.3501 - 27s/epoch - 18ms/step
Epoch 2/50
1497/1497 - 25s - loss: 3.1482 - accuracy1000: 0.4567 - val_loss: 3.6141 - val_accuracy1000: 0.3505 - 25s/epoch - 16ms/step
Epoch 3/50
1497/1497 - 25s - loss: 3.1354 - accuracy1000: 0.4593 - val_loss: 3.6396 - val_accuracy1000: 0.3381 - 25s/epoch - 16ms/step
Epoch 4/50
1497/1497 - 25s - loss: 3.1220 - accuracy1000: 0.4649 - val_loss: 3.6376 - val_accuracy1000: 0.3262 - 25s/epoch - 16ms/step
Epoch 5/50
1497/1497 - 25s - loss: 3.1160 - accuracy1000: 0.4673 - val_loss: 3.8334 - val_accuracy1000: 0.3399 - 25s/epoch - 17ms/step
Epoch 6/50
1497/1497 - 25s - loss: 3.0981 - accuracy1000: 0.4721 - val_loss: 3.8091 - val_accuracy1000: 0.3358 - 25s/epoch - 17ms/step
Epoch 7/50
1497/1497 - 25s - loss: 3.0860 - accuracy1000: 0.4769 - val_loss: 3.7343 - val_accuracy1000: 0.3395 - 25s/epoch - 17ms/step
Epoch 8/50
1497/1497 - 25s - loss: 3.0772 - accuracy1000: 0.4796 - val_loss: 3.7577 - val_accuracy1000: 0.3361 - 25s/epoch - 16ms/step
Epoch 9/50
1497/1497 - 25s - loss: 3.0692 - accuracy1000: 0.4813 - val_loss: 3.7801 - val_accuracy1000: 0.3364 - 25s/epoch - 17ms/step
Epoch 10/50
1497/1497 - 24s - loss: 3.0651 - accuracy1000: 0.4826 - val_loss: 3.7987 - val_accuracy1000: 0.3381 - 24s/epoch - 16ms/step
Epoch 11/50
1497/1497 - 25s - loss: 3.0597 - accuracy1000: 0.4840 - val_loss: 3.7514 - val_accuracy1000: 0.3335 - 25s/epoch - 17ms/step
testing model: results/EXC/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
4693/4693 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0860353
{'0': {'precision': 0.2713249248774316, 'recall': 0.45063730865964896, 'f1-score': 0.33871337928583595, 'support': 304562}, '1': {'precision': 0.4988265794305516, 'recall': 0.5319716282717549, 'f1-score': 0.5148662186295468, 'support': 580155}, '2': {'precision': 0.37364314789687925, 'recall': 0.09049371988308713, 'f1-score': 0.1456999463272309, 'support': 316475}, 'accuracy': 0.39503426596247726, 'macro avg': {'precision': 0.38126488406828746, 'recall': 0.3577008856048303, 'f1-score': 0.3330931814142046, 'support': 1201192}, 'weighted avg': {'precision': 0.40816181858580214, 'recall': 0.39503426596247726, 'f1-score': 0.37293940169846945, 'support': 1201192}}
[[137247 149767  17548]
 [241068 308626  30461]
 [127525 160311  28639]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1480863
{'0': {'precision': 0.32948853421894087, 'recall': 0.38129987692063366, 'f1-score': 0.3535058691883256, 'support': 125935}, '1': {'precision': 0.33774328965780437, 'recall': 0.5245086805692747, 'f1-score': 0.41089911846275756, 'support': 126547}, '2': {'precision': 0.41111872034437213, 'recall': 0.1286399779592399, 'f1-score': 0.19596276369401877, 'support': 130667}, 'accuracy': 0.34243336143380254, 'macro avg': {'precision': 0.35945018140703916, 'recall': 0.34481617848304946, 'f1-score': 0.32012258378170066, 'support': 383149}, 'weighted avg': {'precision': 0.36005363047907357, 'recall': 0.34243336143380254, 'f1-score': 0.3187341708420085, 'support': 383149}}
[[48019 64219 13697]
 [49792 66375 10380]
 [47927 65931 16809]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1524932
{'0': {'precision': 0.2951630633931843, 'recall': 0.24038113102977854, 'f1-score': 0.26497021816515703, 'support': 46913}, '1': {'precision': 0.3677074552986962, 'recall': 0.4382481190150479, 'f1-score': 0.39989077752747626, 'support': 46784}, '2': {'precision': 0.37950204935903026, 'recall': 0.37729755505462115, 'f1-score': 0.3783965914525456, 'support': 46136}, 'accuracy': 0.3517553081175402, 'macro avg': {'precision': 0.34745752268363694, 'recall': 0.35197560169981584, 'f1-score': 0.34775252904839293, 'support': 139833}, 'weighted avg': {'precision': 0.34726078201059035, 'recall': 0.3517553081175402, 'f1-score': 0.3475341523380182, 'support': 139833}}
[[11277 18054 17582]
 [15402 20503 10879]
 [11527 17202 17407]]
training model: results/EXC/W0/deepOF_L1/h10
Epoch 1/50
1497/1497 - 25s - loss: 3.1004 - accuracy10: 0.3871 - val_loss: 2.9216 - val_accuracy10: 0.4749 - 25s/epoch - 17ms/step
Epoch 2/50
1497/1497 - 22s - loss: 3.0339 - accuracy10: 0.4041 - val_loss: 2.8889 - val_accuracy10: 0.4846 - 22s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 23s - loss: 2.9962 - accuracy10: 0.4378 - val_loss: 2.8712 - val_accuracy10: 0.5013 - 23s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 2.9621 - accuracy10: 0.4495 - val_loss: 2.8149 - val_accuracy10: 0.4966 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 2.9300 - accuracy10: 0.4607 - val_loss: 2.7983 - val_accuracy10: 0.4912 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 23s - loss: 2.9116 - accuracy10: 0.4615 - val_loss: 2.7781 - val_accuracy10: 0.5012 - 23s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 2.8874 - accuracy10: 0.4682 - val_loss: 2.7381 - val_accuracy10: 0.5075 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 23s - loss: 2.8705 - accuracy10: 0.4723 - val_loss: 2.7129 - val_accuracy10: 0.5267 - 23s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 2.8488 - accuracy10: 0.4790 - val_loss: 2.6924 - val_accuracy10: 0.5140 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 22s - loss: 2.8300 - accuracy10: 0.4864 - val_loss: 2.6859 - val_accuracy10: 0.5143 - 22s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 2.8102 - accuracy10: 0.4939 - val_loss: 2.6737 - val_accuracy10: 0.5085 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 2.7920 - accuracy10: 0.5001 - val_loss: 2.6683 - val_accuracy10: 0.5048 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 2.7781 - accuracy10: 0.5037 - val_loss: 2.6603 - val_accuracy10: 0.5103 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 2.7679 - accuracy10: 0.5060 - val_loss: 2.6540 - val_accuracy10: 0.5131 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 23s - loss: 2.7516 - accuracy10: 0.5115 - val_loss: 2.6424 - val_accuracy10: 0.5105 - 23s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 2.7354 - accuracy10: 0.5186 - val_loss: 2.6442 - val_accuracy10: 0.5075 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 2.7233 - accuracy10: 0.5237 - val_loss: 2.6246 - val_accuracy10: 0.5138 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 23s - loss: 2.7095 - accuracy10: 0.5267 - val_loss: 2.6242 - val_accuracy10: 0.5176 - 23s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 2.6981 - accuracy10: 0.5307 - val_loss: 2.6320 - val_accuracy10: 0.5115 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 2.6859 - accuracy10: 0.5328 - val_loss: 2.6253 - val_accuracy10: 0.4972 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 2.6723 - accuracy10: 0.5358 - val_loss: 2.6159 - val_accuracy10: 0.5009 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 23s - loss: 2.6623 - accuracy10: 0.5406 - val_loss: 2.6146 - val_accuracy10: 0.5100 - 23s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 22s - loss: 2.6531 - accuracy10: 0.5424 - val_loss: 2.6070 - val_accuracy10: 0.5091 - 22s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 22s - loss: 2.6421 - accuracy10: 0.5435 - val_loss: 2.6048 - val_accuracy10: 0.5039 - 22s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 22s - loss: 2.6322 - accuracy10: 0.5470 - val_loss: 2.5937 - val_accuracy10: 0.5076 - 22s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 2.6198 - accuracy10: 0.5494 - val_loss: 2.6020 - val_accuracy10: 0.5011 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 2.6098 - accuracy10: 0.5533 - val_loss: 2.6006 - val_accuracy10: 0.5039 - 22s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 22s - loss: 2.6026 - accuracy10: 0.5539 - val_loss: 2.5976 - val_accuracy10: 0.5014 - 22s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 22s - loss: 2.5940 - accuracy10: 0.5552 - val_loss: 2.6096 - val_accuracy10: 0.4965 - 22s/epoch - 15ms/step
Epoch 30/50
1497/1497 - 23s - loss: 2.5840 - accuracy10: 0.5575 - val_loss: 2.5945 - val_accuracy10: 0.5152 - 23s/epoch - 15ms/step
Epoch 31/50
1497/1497 - 22s - loss: 2.5746 - accuracy10: 0.5598 - val_loss: 2.5865 - val_accuracy10: 0.5286 - 22s/epoch - 15ms/step
Epoch 32/50
1497/1497 - 22s - loss: 2.5693 - accuracy10: 0.5592 - val_loss: 2.5872 - val_accuracy10: 0.5210 - 22s/epoch - 15ms/step
Epoch 33/50
1497/1497 - 22s - loss: 2.5590 - accuracy10: 0.5628 - val_loss: 2.5849 - val_accuracy10: 0.5179 - 22s/epoch - 15ms/step
Epoch 34/50
1497/1497 - 22s - loss: 2.5518 - accuracy10: 0.5637 - val_loss: 2.5899 - val_accuracy10: 0.5237 - 22s/epoch - 15ms/step
Epoch 35/50
1497/1497 - 22s - loss: 2.5429 - accuracy10: 0.5657 - val_loss: 2.5792 - val_accuracy10: 0.5262 - 22s/epoch - 15ms/step
Epoch 36/50
1497/1497 - 22s - loss: 2.5372 - accuracy10: 0.5658 - val_loss: 2.5919 - val_accuracy10: 0.5178 - 22s/epoch - 15ms/step
Epoch 37/50
1497/1497 - 22s - loss: 2.5306 - accuracy10: 0.5682 - val_loss: 2.6012 - val_accuracy10: 0.5091 - 22s/epoch - 15ms/step
Epoch 38/50
1497/1497 - 22s - loss: 2.5236 - accuracy10: 0.5688 - val_loss: 2.5887 - val_accuracy10: 0.5147 - 22s/epoch - 15ms/step
Epoch 39/50
1497/1497 - 22s - loss: 2.5174 - accuracy10: 0.5692 - val_loss: 2.5829 - val_accuracy10: 0.5183 - 22s/epoch - 15ms/step
Epoch 40/50
1497/1497 - 22s - loss: 2.5080 - accuracy10: 0.5717 - val_loss: 2.5859 - val_accuracy10: 0.5307 - 22s/epoch - 15ms/step
Epoch 41/50
1497/1497 - 22s - loss: 2.5021 - accuracy10: 0.5731 - val_loss: 2.5835 - val_accuracy10: 0.5291 - 22s/epoch - 15ms/step
Epoch 42/50
1497/1497 - 22s - loss: 2.4937 - accuracy10: 0.5737 - val_loss: 2.5899 - val_accuracy10: 0.5205 - 22s/epoch - 15ms/step
Epoch 43/50
1497/1497 - 22s - loss: 2.4871 - accuracy10: 0.5747 - val_loss: 2.6032 - val_accuracy10: 0.5239 - 22s/epoch - 15ms/step
Epoch 44/50
1497/1497 - 22s - loss: 2.4827 - accuracy10: 0.5758 - val_loss: 2.6014 - val_accuracy10: 0.5364 - 22s/epoch - 15ms/step
Epoch 45/50
1497/1497 - 22s - loss: 2.4770 - accuracy10: 0.5760 - val_loss: 2.5885 - val_accuracy10: 0.5213 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h10
Evaluating performance on  test set...
4693/4693 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92343336
{'0': {'precision': 0.25472663741073215, 'recall': 0.6330979428922321, 'f1-score': 0.36328552671871, 'support': 136794}, '1': {'precision': 0.91423703478753, 'recall': 0.5008042188814822, 'f1-score': 0.6471242628328157, 'support': 925743}, '2': {'precision': 0.25770703658936095, 'recall': 0.6581464118283448, 'f1-score': 0.3703845014226512, 'support': 138650}, 'accuracy': 0.5340317535904068, 'macro avg': {'precision': 0.4755569029292077, 'recall': 0.5973495245340197, 'f1-score': 0.46026476365805896, 'support': 1201187}, 'weighted avg': {'precision': 0.7633488304122431, 'recall': 0.5340317535904068, 'f1-score': 0.5828566642095271, 'support': 1201187}}
[[ 86604  21656  28534]
 [227821 463616 234306]
 [ 25563  21835  91252]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9367054
{'0': {'precision': 0.2775979370130583, 'recall': 0.6151991083189786, 'f1-score': 0.3825684778293773, 'support': 49345}, '1': {'precision': 0.8912124582869856, 'recall': 0.48137296827343445, 'f1-score': 0.6251058449351621, 'support': 282949}, '2': {'precision': 0.27395380367388106, 'recall': 0.6516301569198096, 'f1-score': 0.38573823159659176, 'support': 50854}, 'accuracy': 0.5212059047678704, 'macro avg': {'precision': 0.48092139965797503, 'recall': 0.5827340778374075, 'f1-score': 0.46447085145371036, 'support': 383148}, 'weighted avg': {'precision': 0.7302593013503533, 'recall': 0.5212059047678704, 'f1-score': 0.562099364440537, 'support': 383148}}
[[ 30357   7748  11240]
 [ 70161 136204  76584]
 [  8838   8878  33138]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9264688
{'0': {'precision': 0.26217772092107855, 'recall': 0.6345340875260495, 'f1-score': 0.3710460804623714, 'support': 16795}, '1': {'precision': 0.9017559262510975, 'recall': 0.4866065929484446, 'f1-score': 0.6321121074301328, 'support': 105537}, '2': {'precision': 0.27088907304368415, 'recall': 0.6537340723387235, 'f1-score': 0.3830520958885764, 'support': 17501}, 'accuracy': 0.5252908826957872, 'macro avg': {'precision': 0.47827424007195335, 'recall': 0.5916249176044058, 'f1-score': 0.4620700945936935, 'support': 139833}, 'weighted avg': {'precision': 0.7459807032600967, 'recall': 0.5252908826957872, 'f1-score': 0.5695846412031883, 'support': 139833}}
[[10657  2507  3631]
 [27019 51355 27163]
 [ 2972  3088 11441]]
training model: results/EXC/W0/deepOF_L1/h20
Epoch 1/50
1497/1497 - 24s - loss: 3.1119 - accuracy20: 0.4129 - val_loss: 2.9496 - val_accuracy20: 0.4344 - 24s/epoch - 16ms/step
Epoch 2/50
1497/1497 - 23s - loss: 3.0351 - accuracy20: 0.4341 - val_loss: 2.8897 - val_accuracy20: 0.4903 - 23s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 23s - loss: 2.9842 - accuracy20: 0.4676 - val_loss: 2.8529 - val_accuracy20: 0.4921 - 23s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 2.9490 - accuracy20: 0.4781 - val_loss: 2.8213 - val_accuracy20: 0.5057 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 2.9258 - accuracy20: 0.4822 - val_loss: 2.8021 - val_accuracy20: 0.4969 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 2.9014 - accuracy20: 0.4905 - val_loss: 2.7870 - val_accuracy20: 0.4891 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 2.8801 - accuracy20: 0.4951 - val_loss: 2.7741 - val_accuracy20: 0.4893 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 2.8636 - accuracy20: 0.5000 - val_loss: 2.7633 - val_accuracy20: 0.4940 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 2.8449 - accuracy20: 0.5073 - val_loss: 2.7456 - val_accuracy20: 0.4968 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 22s - loss: 2.8285 - accuracy20: 0.5121 - val_loss: 2.7490 - val_accuracy20: 0.4916 - 22s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 2.8128 - accuracy20: 0.5174 - val_loss: 2.7249 - val_accuracy20: 0.5041 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 2.7985 - accuracy20: 0.5209 - val_loss: 2.7265 - val_accuracy20: 0.5075 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 2.7862 - accuracy20: 0.5245 - val_loss: 2.7083 - val_accuracy20: 0.5098 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 2.7728 - accuracy20: 0.5283 - val_loss: 2.7015 - val_accuracy20: 0.5101 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 2.7566 - accuracy20: 0.5317 - val_loss: 2.7018 - val_accuracy20: 0.5053 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 2.7475 - accuracy20: 0.5334 - val_loss: 2.6952 - val_accuracy20: 0.5141 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 2.7330 - accuracy20: 0.5389 - val_loss: 2.7029 - val_accuracy20: 0.5037 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 23s - loss: 2.7233 - accuracy20: 0.5412 - val_loss: 2.6818 - val_accuracy20: 0.5186 - 23s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 2.7119 - accuracy20: 0.5446 - val_loss: 2.6930 - val_accuracy20: 0.5083 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 2.7055 - accuracy20: 0.5447 - val_loss: 2.6922 - val_accuracy20: 0.5091 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 2.6954 - accuracy20: 0.5477 - val_loss: 2.6958 - val_accuracy20: 0.5065 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 23s - loss: 2.6846 - accuracy20: 0.5506 - val_loss: 2.6773 - val_accuracy20: 0.5127 - 23s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 22s - loss: 2.6759 - accuracy20: 0.5526 - val_loss: 2.6738 - val_accuracy20: 0.5132 - 22s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 22s - loss: 2.6665 - accuracy20: 0.5538 - val_loss: 2.6814 - val_accuracy20: 0.5033 - 22s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 22s - loss: 2.6554 - accuracy20: 0.5562 - val_loss: 2.6904 - val_accuracy20: 0.5084 - 22s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 23s - loss: 2.6469 - accuracy20: 0.5589 - val_loss: 2.6738 - val_accuracy20: 0.5111 - 23s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 23s - loss: 2.6376 - accuracy20: 0.5602 - val_loss: 2.6757 - val_accuracy20: 0.5191 - 23s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 22s - loss: 2.6308 - accuracy20: 0.5622 - val_loss: 2.6649 - val_accuracy20: 0.5106 - 22s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 22s - loss: 2.6255 - accuracy20: 0.5626 - val_loss: 2.6733 - val_accuracy20: 0.5082 - 22s/epoch - 15ms/step
Epoch 30/50
1497/1497 - 22s - loss: 2.6191 - accuracy20: 0.5648 - val_loss: 2.6950 - val_accuracy20: 0.5006 - 22s/epoch - 15ms/step
Epoch 31/50
1497/1497 - 22s - loss: 2.6091 - accuracy20: 0.5672 - val_loss: 2.6791 - val_accuracy20: 0.5044 - 22s/epoch - 15ms/step
Epoch 32/50
1497/1497 - 22s - loss: 2.6008 - accuracy20: 0.5685 - val_loss: 2.6830 - val_accuracy20: 0.5052 - 22s/epoch - 15ms/step
Epoch 33/50
1497/1497 - 22s - loss: 2.5928 - accuracy20: 0.5695 - val_loss: 2.6804 - val_accuracy20: 0.5025 - 22s/epoch - 15ms/step
Epoch 34/50
1497/1497 - 22s - loss: 2.5882 - accuracy20: 0.5709 - val_loss: 2.6733 - val_accuracy20: 0.5111 - 22s/epoch - 15ms/step
Epoch 35/50
1497/1497 - 22s - loss: 2.5775 - accuracy20: 0.5721 - val_loss: 2.6727 - val_accuracy20: 0.5096 - 22s/epoch - 15ms/step
Epoch 36/50
1497/1497 - 22s - loss: 2.5724 - accuracy20: 0.5733 - val_loss: 2.6835 - val_accuracy20: 0.5149 - 22s/epoch - 15ms/step
Epoch 37/50
1497/1497 - 23s - loss: 2.5662 - accuracy20: 0.5745 - val_loss: 2.6736 - val_accuracy20: 0.5045 - 23s/epoch - 15ms/step
Epoch 38/50
1497/1497 - 22s - loss: 2.5602 - accuracy20: 0.5747 - val_loss: 2.6624 - val_accuracy20: 0.5190 - 22s/epoch - 15ms/step
Epoch 39/50
1497/1497 - 23s - loss: 2.5520 - accuracy20: 0.5761 - val_loss: 2.6766 - val_accuracy20: 0.5196 - 23s/epoch - 15ms/step
Epoch 40/50
1497/1497 - 23s - loss: 2.5488 - accuracy20: 0.5769 - val_loss: 2.6736 - val_accuracy20: 0.5173 - 23s/epoch - 15ms/step
Epoch 41/50
1497/1497 - 22s - loss: 2.5430 - accuracy20: 0.5782 - val_loss: 2.6816 - val_accuracy20: 0.5160 - 22s/epoch - 15ms/step
Epoch 42/50
1497/1497 - 22s - loss: 2.5340 - accuracy20: 0.5795 - val_loss: 2.6936 - val_accuracy20: 0.5111 - 22s/epoch - 15ms/step
Epoch 43/50
1497/1497 - 22s - loss: 2.5259 - accuracy20: 0.5810 - val_loss: 2.6972 - val_accuracy20: 0.5143 - 22s/epoch - 15ms/step
Epoch 44/50
1497/1497 - 23s - loss: 2.5224 - accuracy20: 0.5814 - val_loss: 2.6927 - val_accuracy20: 0.5115 - 23s/epoch - 15ms/step
Epoch 45/50
1497/1497 - 22s - loss: 2.5166 - accuracy20: 0.5829 - val_loss: 2.6914 - val_accuracy20: 0.5181 - 22s/epoch - 15ms/step
Epoch 46/50
1497/1497 - 23s - loss: 2.5112 - accuracy20: 0.5836 - val_loss: 2.6993 - val_accuracy20: 0.5106 - 23s/epoch - 15ms/step
Epoch 47/50
1497/1497 - 22s - loss: 2.5045 - accuracy20: 0.5842 - val_loss: 2.6864 - val_accuracy20: 0.5152 - 22s/epoch - 15ms/step
Epoch 48/50
1497/1497 - 22s - loss: 2.4983 - accuracy20: 0.5868 - val_loss: 2.7103 - val_accuracy20: 0.5081 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h20
Evaluating performance on  test set...
4693/4693 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9416575
{'0': {'precision': 0.3183682688363544, 'recall': 0.6441617246143098, 'f1-score': 0.4261283378419936, 'support': 190373}, '1': {'precision': 0.8630426918730186, 'recall': 0.4691001150410704, 'f1-score': 0.6078228609451141, 'support': 818838}, '2': {'precision': 0.3341915412155459, 'recall': 0.6457109221986082, 'f1-score': 0.4404338928129841, 'support': 191976}, 'accuracy': 0.5250714501572195, 'macro avg': {'precision': 0.505200833974973, 'recall': 0.5863242539513295, 'f1-score': 0.4914616972000306, 'support': 1201187}, 'weighted avg': {'precision': 0.6921966600433553, 'recall': 0.5250714501572195, 'f1-score': 0.5522741445563718, 'support': 1201187}}
[[122631  30149  37593]
 [225347 384117 209374]
 [ 37208  30807 123961]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95326823
{'0': {'precision': 0.3481383637414348, 'recall': 0.6256026822140134, 'f1-score': 0.4473392490598662, 'support': 67407}, '1': {'precision': 0.8329761615447496, 'recall': 0.45799792682334267, 'f1-score': 0.5910286790697918, 'support': 246964}, '2': {'precision': 0.34638632960730104, 'recall': 0.6357357837649215, 'f1-score': 0.4484374839748521, 'support': 68777}, 'accuracy': 0.5193893743409858, 'macro avg': {'precision': 0.5091669516311618, 'recall': 0.5731121309340925, 'f1-score': 0.4956018040348367, 'support': 383148}, 'weighted avg': {'precision': 0.6603336048625017, 'recall': 0.5193893743409858, 'f1-score': 0.5401536437473481, 'support': 383148}}
[[ 42170  10595  14642]
 [ 65992 113109  67863]
 [ 12968  12085  43724]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94900525
{'0': {'precision': 0.3284634426664309, 'recall': 0.6428046195769713, 'f1-score': 0.43476734490879565, 'support': 23119}, '1': {'precision': 0.8424011642975339, 'recall': 0.45584887747726366, 'f1-score': 0.5915772967826842, 'support': 92693}, '2': {'precision': 0.34512716632905693, 'recall': 0.6383581033262562, 'f1-score': 0.44802851674920746, 'support': 24021}, 'accuracy': 0.5181108894180916, 'macro avg': {'precision': 0.5053305910976739, 'recall': 0.579003866793497, 'f1-score': 0.49145771948022915, 'support': 139833}, 'weighted avg': {'precision': 0.6720068733104975, 'recall': 0.5181108894180916, 'f1-score': 0.5409921378963228, 'support': 139833}}
[[14861  3627  4631]
 [25974 42254 24465]
 [ 4409  4278 15334]]
training model: results/EXC/W0/deepOF_L1/h30
Epoch 1/50
1497/1497 - 25s - loss: 3.1240 - accuracy30: 0.4243 - val_loss: 2.9809 - val_accuracy30: 0.4265 - 25s/epoch - 17ms/step
Epoch 2/50
1497/1497 - 22s - loss: 3.0470 - accuracy30: 0.4504 - val_loss: 2.9294 - val_accuracy30: 0.4727 - 22s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 22s - loss: 3.0073 - accuracy30: 0.4758 - val_loss: 2.8988 - val_accuracy30: 0.4911 - 22s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 23s - loss: 2.9791 - accuracy30: 0.4830 - val_loss: 2.8731 - val_accuracy30: 0.4846 - 23s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 23s - loss: 2.9553 - accuracy30: 0.4872 - val_loss: 2.8513 - val_accuracy30: 0.4889 - 23s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 2.9353 - accuracy30: 0.4907 - val_loss: 2.8297 - val_accuracy30: 0.4936 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 23s - loss: 2.9171 - accuracy30: 0.4923 - val_loss: 2.8213 - val_accuracy30: 0.4911 - 23s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 23s - loss: 2.9014 - accuracy30: 0.4957 - val_loss: 2.8167 - val_accuracy30: 0.4866 - 23s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 23s - loss: 2.8861 - accuracy30: 0.5011 - val_loss: 2.8059 - val_accuracy30: 0.4925 - 23s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 23s - loss: 2.8710 - accuracy30: 0.5046 - val_loss: 2.7967 - val_accuracy30: 0.4982 - 23s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 2.8582 - accuracy30: 0.5095 - val_loss: 2.8055 - val_accuracy30: 0.4904 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 23s - loss: 2.8467 - accuracy30: 0.5138 - val_loss: 2.7966 - val_accuracy30: 0.4942 - 23s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 2.8332 - accuracy30: 0.5172 - val_loss: 2.7895 - val_accuracy30: 0.4945 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 2.8233 - accuracy30: 0.5208 - val_loss: 2.7793 - val_accuracy30: 0.4998 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 2.8114 - accuracy30: 0.5240 - val_loss: 2.7852 - val_accuracy30: 0.4950 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 23s - loss: 2.7987 - accuracy30: 0.5277 - val_loss: 2.7789 - val_accuracy30: 0.5069 - 23s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 2.7899 - accuracy30: 0.5299 - val_loss: 2.7683 - val_accuracy30: 0.5101 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 23s - loss: 2.7790 - accuracy30: 0.5322 - val_loss: 2.7487 - val_accuracy30: 0.5122 - 23s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 2.7697 - accuracy30: 0.5352 - val_loss: 2.7456 - val_accuracy30: 0.5060 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 23s - loss: 2.7585 - accuracy30: 0.5375 - val_loss: 2.7457 - val_accuracy30: 0.5111 - 23s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 23s - loss: 2.7501 - accuracy30: 0.5405 - val_loss: 2.7412 - val_accuracy30: 0.5164 - 23s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 23s - loss: 2.7428 - accuracy30: 0.5419 - val_loss: 2.7375 - val_accuracy30: 0.5130 - 23s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 23s - loss: 2.7342 - accuracy30: 0.5450 - val_loss: 2.7415 - val_accuracy30: 0.5175 - 23s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 22s - loss: 2.7276 - accuracy30: 0.5466 - val_loss: 2.7410 - val_accuracy30: 0.5085 - 22s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 23s - loss: 2.7182 - accuracy30: 0.5486 - val_loss: 2.7296 - val_accuracy30: 0.5157 - 23s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 2.7108 - accuracy30: 0.5502 - val_loss: 2.7426 - val_accuracy30: 0.5114 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 2.7025 - accuracy30: 0.5517 - val_loss: 2.7480 - val_accuracy30: 0.5104 - 22s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 23s - loss: 2.6938 - accuracy30: 0.5536 - val_loss: 2.7501 - val_accuracy30: 0.5131 - 23s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 22s - loss: 2.6900 - accuracy30: 0.5554 - val_loss: 2.7388 - val_accuracy30: 0.5059 - 22s/epoch - 15ms/step
Epoch 30/50
1497/1497 - 23s - loss: 2.6830 - accuracy30: 0.5570 - val_loss: 2.7388 - val_accuracy30: 0.5098 - 23s/epoch - 15ms/step
Epoch 31/50
1497/1497 - 23s - loss: 2.6769 - accuracy30: 0.5583 - val_loss: 2.7239 - val_accuracy30: 0.5118 - 23s/epoch - 15ms/step
Epoch 32/50
1497/1497 - 23s - loss: 2.6677 - accuracy30: 0.5598 - val_loss: 2.7246 - val_accuracy30: 0.5098 - 23s/epoch - 15ms/step
Epoch 33/50
1497/1497 - 23s - loss: 2.6619 - accuracy30: 0.5613 - val_loss: 2.7294 - val_accuracy30: 0.5144 - 23s/epoch - 15ms/step
Epoch 34/50
1497/1497 - 23s - loss: 2.6557 - accuracy30: 0.5635 - val_loss: 2.7450 - val_accuracy30: 0.5014 - 23s/epoch - 15ms/step
Epoch 35/50
1497/1497 - 22s - loss: 2.6486 - accuracy30: 0.5643 - val_loss: 2.7348 - val_accuracy30: 0.5096 - 22s/epoch - 15ms/step
Epoch 36/50
1497/1497 - 23s - loss: 2.6419 - accuracy30: 0.5661 - val_loss: 2.7509 - val_accuracy30: 0.5048 - 23s/epoch - 15ms/step
Epoch 37/50
1497/1497 - 22s - loss: 2.6343 - accuracy30: 0.5674 - val_loss: 2.7347 - val_accuracy30: 0.5114 - 22s/epoch - 15ms/step
Epoch 38/50
1497/1497 - 23s - loss: 2.6271 - accuracy30: 0.5691 - val_loss: 2.7316 - val_accuracy30: 0.5134 - 23s/epoch - 15ms/step
Epoch 39/50
1497/1497 - 22s - loss: 2.6210 - accuracy30: 0.5697 - val_loss: 2.7400 - val_accuracy30: 0.5046 - 22s/epoch - 15ms/step
Epoch 40/50
1497/1497 - 22s - loss: 2.6169 - accuracy30: 0.5712 - val_loss: 2.7338 - val_accuracy30: 0.5147 - 22s/epoch - 15ms/step
Epoch 41/50
1497/1497 - 22s - loss: 2.6097 - accuracy30: 0.5715 - val_loss: 2.7370 - val_accuracy30: 0.5142 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h30
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9600146
{'0': {'precision': 0.36723767095643645, 'recall': 0.6284545239947893, 'f1-score': 0.4635813695520386, 'support': 228758}, '1': {'precision': 0.8103182384912421, 'recall': 0.4506938702962111, 'f1-score': 0.5792259416579201, 'support': 742646}, '2': {'precision': 0.3697164812004296, 'recall': 0.6382151856316611, 'f1-score': 0.46820370952731377, 'support': 229783}, 'accuracy': 0.520419385158181, 'macro avg': {'precision': 0.5157574635493694, 'recall': 0.5724545266408871, 'f1-score': 0.5036703402457575, 'support': 1201187}, 'weighted avg': {'precision': 0.6416508968835808, 'recall': 0.520419385158181, 'f1-score': 0.5359640327366078, 'support': 1201187}}
[[143764  38436  46558]
 [204491 334706 203449]
 [ 43219  39913 146651]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97298497
{'0': {'precision': 0.39493986100486644, 'recall': 0.606629917126036, 'f1-score': 0.4784136669903344, 'support': 80001}, '1': {'precision': 0.7749832245963797, 'recall': 0.43226327205169485, 'f1-score': 0.5549766106247974, 'support': 221763}, '2': {'precision': 0.3765605207471462, 'recall': 0.6319178216848521, 'f1-score': 0.4719095968470845, 'support': 81384}, 'accuracy': 0.5110792696294905, 'macro avg': {'precision': 0.5154945354494641, 'recall': 0.556937003620861, 'f1-score': 0.5017666248207387, 'support': 383148}, 'weighted avg': {'precision': 0.6110019889883361, 'recall': 0.5110792696294905, 'f1-score': 0.5213461652016552, 'support': 383148}}
[[48531 13225 18245]
 [59003 95860 66900]
 [15348 14608 51428]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9701387
{'0': {'precision': 0.3781902047388003, 'recall': 0.6287574606619641, 'f1-score': 0.47229845393038605, 'support': 27645}, '1': {'precision': 0.7858858990040188, 'recall': 0.4304307776966971, 'f1-score': 0.5562194207625776, 'support': 83593}, '2': {'precision': 0.3766636167027117, 'recall': 0.6334324182549397, 'f1-score': 0.4724123990975836, 'support': 28595}, 'accuracy': 0.5111525891599265, 'macro avg': {'precision': 0.513579906815177, 'recall': 0.564206885537867, 'f1-score': 0.5003100912635158, 'support': 139833}, 'weighted avg': {'precision': 0.6216009403006524, 'recall': 0.5111525891599265, 'f1-score': 0.5224902086839807, 'support': 139833}}
[[17382  4476  5787]
 [23424 35981 24188]
 [ 5155  5327 18113]]
training model: results/EXC/W0/deepOF_L1/h50
Epoch 1/50
1497/1497 - 25s - loss: 3.1657 - accuracy50: 0.4292 - val_loss: 3.0720 - val_accuracy50: 0.3894 - 25s/epoch - 16ms/step
Epoch 2/50
1497/1497 - 23s - loss: 3.1017 - accuracy50: 0.4516 - val_loss: 3.0263 - val_accuracy50: 0.4461 - 23s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 23s - loss: 3.0679 - accuracy50: 0.4659 - val_loss: 3.0021 - val_accuracy50: 0.4549 - 23s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 23s - loss: 3.0440 - accuracy50: 0.4735 - val_loss: 2.9815 - val_accuracy50: 0.4613 - 23s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 3.0239 - accuracy50: 0.4769 - val_loss: 2.9707 - val_accuracy50: 0.4602 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 3.0082 - accuracy50: 0.4805 - val_loss: 2.9569 - val_accuracy50: 0.4625 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 2.9939 - accuracy50: 0.4840 - val_loss: 2.9570 - val_accuracy50: 0.4542 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 2.9823 - accuracy50: 0.4857 - val_loss: 2.9450 - val_accuracy50: 0.4590 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 2.9696 - accuracy50: 0.4888 - val_loss: 2.9461 - val_accuracy50: 0.4591 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 22s - loss: 2.9609 - accuracy50: 0.4910 - val_loss: 2.9451 - val_accuracy50: 0.4601 - 22s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 2.9519 - accuracy50: 0.4948 - val_loss: 2.9302 - val_accuracy50: 0.4646 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 2.9432 - accuracy50: 0.4959 - val_loss: 2.9238 - val_accuracy50: 0.4659 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 2.9334 - accuracy50: 0.4998 - val_loss: 2.9224 - val_accuracy50: 0.4716 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 23s - loss: 2.9253 - accuracy50: 0.5021 - val_loss: 2.9169 - val_accuracy50: 0.4724 - 23s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 2.9164 - accuracy50: 0.5053 - val_loss: 2.9053 - val_accuracy50: 0.4768 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 2.9077 - accuracy50: 0.5078 - val_loss: 2.9107 - val_accuracy50: 0.4740 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 2.9000 - accuracy50: 0.5105 - val_loss: 2.9041 - val_accuracy50: 0.4743 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 23s - loss: 2.8923 - accuracy50: 0.5124 - val_loss: 2.8988 - val_accuracy50: 0.4723 - 23s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 2.8846 - accuracy50: 0.5146 - val_loss: 2.8994 - val_accuracy50: 0.4775 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 2.8754 - accuracy50: 0.5177 - val_loss: 2.9104 - val_accuracy50: 0.4711 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 2.8674 - accuracy50: 0.5196 - val_loss: 2.8888 - val_accuracy50: 0.4798 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 23s - loss: 2.8615 - accuracy50: 0.5207 - val_loss: 2.8890 - val_accuracy50: 0.4794 - 23s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 22s - loss: 2.8528 - accuracy50: 0.5239 - val_loss: 2.8931 - val_accuracy50: 0.4771 - 22s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 22s - loss: 2.8468 - accuracy50: 0.5257 - val_loss: 2.8952 - val_accuracy50: 0.4837 - 22s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 23s - loss: 2.8381 - accuracy50: 0.5279 - val_loss: 2.8963 - val_accuracy50: 0.4751 - 23s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 2.8329 - accuracy50: 0.5283 - val_loss: 2.8940 - val_accuracy50: 0.4747 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 2.8246 - accuracy50: 0.5315 - val_loss: 2.9044 - val_accuracy50: 0.4726 - 22s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 22s - loss: 2.8181 - accuracy50: 0.5321 - val_loss: 2.8973 - val_accuracy50: 0.4803 - 22s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 22s - loss: 2.8127 - accuracy50: 0.5340 - val_loss: 2.9057 - val_accuracy50: 0.4789 - 22s/epoch - 15ms/step
Epoch 30/50
1497/1497 - 22s - loss: 2.8071 - accuracy50: 0.5346 - val_loss: 2.8941 - val_accuracy50: 0.4824 - 22s/epoch - 15ms/step
Epoch 31/50
1497/1497 - 22s - loss: 2.7974 - accuracy50: 0.5372 - val_loss: 2.9101 - val_accuracy50: 0.4739 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h50
Evaluating performance on  test set...
4693/4693 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.993452
{'0': {'precision': 0.39343684156142883, 'recall': 0.6122084467855308, 'f1-score': 0.47902647279629257, 'support': 286097}, '1': {'precision': 0.6922988583594181, 'recall': 0.37469997418104506, 'f1-score': 0.4862317679115243, 'support': 627446}, '2': {'precision': 0.41426876654034767, 'recall': 0.5997135347860549, 'f1-score': 0.4900333783111994, 'support': 287644}, 'accuracy': 0.48515260321665155, 'macro avg': {'precision': 0.5000014888203982, 'recall': 0.5288739852508769, 'f1-score': 0.4850972063396721, 'support': 1201187}, 'weighted avg': {'precision': 0.554537448894398, 'recall': 0.48515260321665155, 'f1-score': 0.48542597922518466, 'support': 1201187}}
[[175151  50581  60365]
 [208805 235104 183537]
 [ 61226  53914 172504]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0025157
{'0': {'precision': 0.4219704766771507, 'recall': 0.5929548120878676, 'f1-score': 0.49305978967020847, 'support': 98876}, '1': {'precision': 0.6453064468063971, 'recall': 0.35360364038167397, 'f1-score': 0.45686335873299405, 'support': 183717}, '2': {'precision': 0.420281878540028, 'recall': 0.5999303863557257, 'f1-score': 0.4942890385592318, 'support': 100555}, 'accuracy': 0.48001816530426883, 'macro avg': {'precision': 0.4958529340078586, 'recall': 0.5154962796084225, 'f1-score': 0.4814040623208114, 'support': 383148}, 'weighted avg': {'precision': 0.5286154740112263, 'recall': 0.48001816530426883, 'f1-score': 0.47602644333809535, 'support': 383148}}
[[58629 17311 22936]
 [58479 64963 60275]
 [21833 18396 60326]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9992233
{'0': {'precision': 0.41142606607064564, 'recall': 0.6215764766869222, 'f1-score': 0.49512514051065587, 'support': 34723}, '1': {'precision': 0.6593255147813868, 'recall': 0.3508073212462797, 'f1-score': 0.4579520819842901, 'support': 69551}, '2': {'precision': 0.4198697585768742, 'recall': 0.5947298855423381, 'f1-score': 0.49223177813725605, 'support': 35559}, 'accuracy': 0.48007265809930416, 'macro avg': {'precision': 0.4968737798096356, 'recall': 0.5223712278251801, 'f1-score': 0.4817696668774007, 'support': 139833}, 'weighted avg': {'precision': 0.5368750217471293, 'recall': 0.48007265809930416, 'f1-score': 0.4759000043396305, 'support': 139833}}
[[21583  5815  7325]
 [23257 24399 21895]
 [ 7619  6792 21148]]
training model: results/EXC/W0/deepOF_L1/h100
Epoch 1/50
1497/1497 - 25s - loss: 3.2390 - accuracy100: 0.4145 - val_loss: 3.2212 - val_accuracy100: 0.4100 - 25s/epoch - 17ms/step
Epoch 2/50
1497/1497 - 23s - loss: 3.2021 - accuracy100: 0.4296 - val_loss: 3.1906 - val_accuracy100: 0.4222 - 23s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 22s - loss: 3.1885 - accuracy100: 0.4335 - val_loss: 3.1762 - val_accuracy100: 0.4281 - 22s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 3.1769 - accuracy100: 0.4361 - val_loss: 3.1685 - val_accuracy100: 0.4340 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 3.1686 - accuracy100: 0.4396 - val_loss: 3.1633 - val_accuracy100: 0.4361 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 3.1613 - accuracy100: 0.4422 - val_loss: 3.1583 - val_accuracy100: 0.4370 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 23s - loss: 3.1540 - accuracy100: 0.4437 - val_loss: 3.1528 - val_accuracy100: 0.4393 - 23s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 3.1473 - accuracy100: 0.4465 - val_loss: 3.1474 - val_accuracy100: 0.4411 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 3.1406 - accuracy100: 0.4487 - val_loss: 3.1487 - val_accuracy100: 0.4413 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 23s - loss: 3.1341 - accuracy100: 0.4517 - val_loss: 3.1456 - val_accuracy100: 0.4435 - 23s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 23s - loss: 3.1281 - accuracy100: 0.4542 - val_loss: 3.1490 - val_accuracy100: 0.4414 - 23s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 23s - loss: 3.1237 - accuracy100: 0.4549 - val_loss: 3.1475 - val_accuracy100: 0.4413 - 23s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 3.1182 - accuracy100: 0.4573 - val_loss: 3.1498 - val_accuracy100: 0.4399 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 3.1142 - accuracy100: 0.4591 - val_loss: 3.1433 - val_accuracy100: 0.4424 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 3.1085 - accuracy100: 0.4614 - val_loss: 3.1461 - val_accuracy100: 0.4438 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 3.1049 - accuracy100: 0.4620 - val_loss: 3.1389 - val_accuracy100: 0.4456 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 3.0997 - accuracy100: 0.4638 - val_loss: 3.1444 - val_accuracy100: 0.4443 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 22s - loss: 3.0952 - accuracy100: 0.4662 - val_loss: 3.1393 - val_accuracy100: 0.4453 - 22s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 3.0903 - accuracy100: 0.4686 - val_loss: 3.1408 - val_accuracy100: 0.4446 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 3.0858 - accuracy100: 0.4685 - val_loss: 3.1402 - val_accuracy100: 0.4447 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 3.0805 - accuracy100: 0.4713 - val_loss: 3.1385 - val_accuracy100: 0.4451 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 22s - loss: 3.0768 - accuracy100: 0.4729 - val_loss: 3.1425 - val_accuracy100: 0.4458 - 22s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 22s - loss: 3.0716 - accuracy100: 0.4749 - val_loss: 3.1498 - val_accuracy100: 0.4438 - 22s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 23s - loss: 3.0675 - accuracy100: 0.4759 - val_loss: 3.1485 - val_accuracy100: 0.4434 - 23s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 22s - loss: 3.0617 - accuracy100: 0.4783 - val_loss: 3.1436 - val_accuracy100: 0.4457 - 22s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 3.0574 - accuracy100: 0.4789 - val_loss: 3.1483 - val_accuracy100: 0.4424 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 3.0510 - accuracy100: 0.4820 - val_loss: 3.1498 - val_accuracy100: 0.4424 - 22s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 22s - loss: 3.0467 - accuracy100: 0.4830 - val_loss: 3.1694 - val_accuracy100: 0.4399 - 22s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 23s - loss: 3.0423 - accuracy100: 0.4848 - val_loss: 3.1672 - val_accuracy100: 0.4410 - 23s/epoch - 15ms/step
Epoch 30/50
1497/1497 - 22s - loss: 3.0375 - accuracy100: 0.4861 - val_loss: 3.1730 - val_accuracy100: 0.4395 - 22s/epoch - 15ms/step
Epoch 31/50
1497/1497 - 23s - loss: 3.0317 - accuracy100: 0.4874 - val_loss: 3.1734 - val_accuracy100: 0.4390 - 23s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h100
Evaluating performance on  test set...
4693/4693 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0465333
{'0': {'precision': 0.4108561469521349, 'recall': 0.6715398994286917, 'f1-score': 0.5098065472918819, 'support': 379830}, '1': {'precision': 0.4682383168618082, 'recall': 0.18926176025143196, 'f1-score': 0.2695653161153037, 'support': 439085}, '2': {'precision': 0.46770882717229156, 'recall': 0.49292388665662146, 'f1-score': 0.47998542959143, 'support': 382272}, 'accuracy': 0.4384030130196214, 'macro avg': {'precision': 0.44893443032874486, 'recall': 0.451241848778915, 'f1-score': 0.4197857643328719, 'support': 1201187}, 'weighted avg': {'precision': 0.44992486635045387, 'recall': 0.4384030130196214, 'f1-score': 0.4124977191937132, 'support': 1201187}}
[[255071  42986  81773]
 [223306  83102 132677]
 [142451  51390 188431]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0456781
{'0': {'precision': 0.43578082593706446, 'recall': 0.6510430120151853, 'f1-score': 0.5220939246807296, 'support': 127755}, '1': {'precision': 0.4244723908644117, 'recall': 0.18640450062288239, 'f1-score': 0.2590491313385271, 'support': 126027}, '2': {'precision': 0.4672416059353595, 'recall': 0.4946044555756536, 'f1-score': 0.48053381798519007, 'support': 129366}, 'accuracy': 0.44539185902053513, 'macro avg': {'precision': 0.4424982742456119, 'recall': 0.4440173227379071, 'f1-score': 0.4205589580014823, 'support': 383148}, 'weighted avg': {'precision': 0.4426836079386884, 'recall': 0.44539185902053513, 'f1-score': 0.42153954117014647, 'support': 383148}}
[[83174 14203 30378]
 [59956 23492 42579]
 [47732 17649 63985]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0458051
{'0': {'precision': 0.42995505745818635, 'recall': 0.6551589623561537, 'f1-score': 0.5191876690567171, 'support': 46143}, '1': {'precision': 0.4311273661839569, 'recall': 0.18487590869592863, 'f1-score': 0.2587812982081405, 'support': 47183}, '2': {'precision': 0.47256938808634963, 'recall': 0.5008278323693207, 'f1-score': 0.4862884284148442, 'support': 46507}, 'accuracy': 0.44514528044166973, 'macro avg': {'precision': 0.4445506039094977, 'recall': 0.44695423447380095, 'f1-score': 0.4214191318932339, 'support': 139833}, 'weighted avg': {'precision': 0.44452370518177103, 'recall': 0.44514528044166973, 'f1-score': 0.4203783838359182, 'support': 139833}}
[[30231  5236 10676]
 [23140  8723 15320]
 [16941  6274 23292]]
training model: results/EXC/W0/deepOF_L1/h200
Epoch 1/50
1497/1497 - 25s - loss: 3.2810 - accuracy200: 0.3826 - val_loss: 3.2624 - val_accuracy200: 0.3718 - 25s/epoch - 17ms/step
Epoch 2/50
1497/1497 - 22s - loss: 3.2584 - accuracy200: 0.3923 - val_loss: 3.2533 - val_accuracy200: 0.3857 - 22s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 23s - loss: 3.2553 - accuracy200: 0.3918 - val_loss: 3.2486 - val_accuracy200: 0.3896 - 23s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 3.2542 - accuracy200: 0.3908 - val_loss: 3.2469 - val_accuracy200: 0.3915 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 3.2523 - accuracy200: 0.3913 - val_loss: 3.2445 - val_accuracy200: 0.3914 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 3.2501 - accuracy200: 0.3923 - val_loss: 3.2434 - val_accuracy200: 0.3927 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 3.2476 - accuracy200: 0.3933 - val_loss: 3.2423 - val_accuracy200: 0.3927 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 3.2451 - accuracy200: 0.3946 - val_loss: 3.2404 - val_accuracy200: 0.3940 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 23s - loss: 3.2425 - accuracy200: 0.3963 - val_loss: 3.2400 - val_accuracy200: 0.3939 - 23s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 23s - loss: 3.2400 - accuracy200: 0.3975 - val_loss: 3.2400 - val_accuracy200: 0.3912 - 23s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 23s - loss: 3.2370 - accuracy200: 0.3989 - val_loss: 3.2395 - val_accuracy200: 0.3910 - 23s/epoch - 16ms/step
Epoch 12/50
1497/1497 - 22s - loss: 3.2343 - accuracy200: 0.4012 - val_loss: 3.2391 - val_accuracy200: 0.3925 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 3.2311 - accuracy200: 0.4026 - val_loss: 3.2413 - val_accuracy200: 0.3900 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 3.2287 - accuracy200: 0.4045 - val_loss: 3.2419 - val_accuracy200: 0.3885 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 3.2265 - accuracy200: 0.4051 - val_loss: 3.2444 - val_accuracy200: 0.3880 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 3.2242 - accuracy200: 0.4072 - val_loss: 3.2415 - val_accuracy200: 0.3895 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 3.2216 - accuracy200: 0.4084 - val_loss: 3.2450 - val_accuracy200: 0.3884 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 24s - loss: 3.2175 - accuracy200: 0.4109 - val_loss: 3.2500 - val_accuracy200: 0.3845 - 24s/epoch - 16ms/step
Epoch 19/50
1497/1497 - 23s - loss: 3.2146 - accuracy200: 0.4125 - val_loss: 3.2525 - val_accuracy200: 0.3839 - 23s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 3.2129 - accuracy200: 0.4131 - val_loss: 3.2538 - val_accuracy200: 0.3840 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 3.2086 - accuracy200: 0.4164 - val_loss: 3.2502 - val_accuracy200: 0.3866 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 23s - loss: 3.2066 - accuracy200: 0.4171 - val_loss: 3.2526 - val_accuracy200: 0.3854 - 23s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h200
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0814917
{'0': {'precision': 0.34432667649815113, 'recall': 0.6764495163283772, 'f1-score': 0.4563578488859105, 'support': 350341}, '1': {'precision': 0.44621289289871946, 'recall': 0.04952166004857084, 'f1-score': 0.08914933631333642, 'support': 495359}, '2': {'precision': 0.362651928393304, 'recall': 0.46717601487536814, 'f1-score': 0.40833111024509705, 'support': 355487}, 'accuracy': 0.35597621352878445, 'macro avg': {'precision': 0.38439716593005824, 'recall': 0.39771573041743874, 'f1-score': 0.317946098481448, 'support': 1201187}, 'weighted avg': {'precision': 0.3917669527335927, 'recall': 0.35597621352878445, 'f1-score': 0.2907109322787173, 'support': 1201187}}
[[236988  14738  98615]
 [277572  24531 193256]
 [173705  15707 166075]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0828019
{'0': {'precision': 0.38732583523390457, 'recall': 0.622713211161885, 'f1-score': 0.47759126834776067, 'support': 127362}, '1': {'precision': 0.3609435588108574, 'recall': 0.05273179329011141, 'f1-score': 0.09201999121265378, 'support': 127096}, '2': {'precision': 0.40170319803274995, 'recall': 0.4988654907141192, 'f1-score': 0.4450429279012294, 'support': 128690}, 'accuracy': 0.392044327518348, 'macro avg': {'precision': 0.3833241973591706, 'recall': 0.3914368317220385, 'f1-score': 0.33821806248721464, 'support': 383148}, 'weighted avg': {'precision': 0.3834034371379203, 'recall': 0.392044327518348, 'f1-score': 0.3387592426792783, 'support': 383148}}
[[79310  5783 42269]
 [67045  6702 53349]
 [58408  6083 64199]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0797527
{'0': {'precision': 0.39089258616952094, 'recall': 0.6256044408786348, 'f1-score': 0.4811507191994997, 'support': 46117}, '1': {'precision': 0.3654240065546907, 'recall': 0.055716338045764015, 'f1-score': 0.09669027316086139, 'support': 48029}, '2': {'precision': 0.3968007904330346, 'recall': 0.5098386849650886, 'f1-score': 0.44627307474925515, 'support': 45687}, 'accuracy': 0.39203907518253917, 'macro avg': {'precision': 0.38437246105241546, 'recall': 0.3970531546298291, 'f1-score': 0.3413713557032054, 'support': 139833}, 'weighted avg': {'precision': 0.38407515192915187, 'recall': 0.39203907518253917, 'f1-score': 0.3377031374070181, 'support': 139833}}
[[28851  2329 14937]
 [24881  2676 20472]
 [20076  2318 23293]]
training model: results/EXC/W0/deepOF_L1/h300
Epoch 1/50
1497/1497 - 25s - loss: 3.2966 - accuracy300: 0.3657 - val_loss: 3.2843 - val_accuracy300: 0.3536 - 25s/epoch - 17ms/step
Epoch 2/50
1497/1497 - 23s - loss: 3.2763 - accuracy300: 0.3721 - val_loss: 3.2717 - val_accuracy300: 0.3762 - 23s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 22s - loss: 3.2714 - accuracy300: 0.3745 - val_loss: 3.2660 - val_accuracy300: 0.3877 - 22s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 3.2693 - accuracy300: 0.3771 - val_loss: 3.2625 - val_accuracy300: 0.3931 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 22s - loss: 3.2670 - accuracy300: 0.3784 - val_loss: 3.2611 - val_accuracy300: 0.3941 - 22s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 3.2653 - accuracy300: 0.3787 - val_loss: 3.2602 - val_accuracy300: 0.3954 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 3.2640 - accuracy300: 0.3807 - val_loss: 3.2588 - val_accuracy300: 0.3949 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 3.2617 - accuracy300: 0.3818 - val_loss: 3.2573 - val_accuracy300: 0.3952 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 3.2601 - accuracy300: 0.3825 - val_loss: 3.2570 - val_accuracy300: 0.3955 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 22s - loss: 3.2582 - accuracy300: 0.3835 - val_loss: 3.2549 - val_accuracy300: 0.3967 - 22s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 3.2559 - accuracy300: 0.3860 - val_loss: 3.2538 - val_accuracy300: 0.3975 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 3.2547 - accuracy300: 0.3875 - val_loss: 3.2538 - val_accuracy300: 0.3948 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 23s - loss: 3.2526 - accuracy300: 0.3887 - val_loss: 3.2535 - val_accuracy300: 0.3958 - 23s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 3.2513 - accuracy300: 0.3894 - val_loss: 3.2518 - val_accuracy300: 0.3978 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 3.2495 - accuracy300: 0.3907 - val_loss: 3.2514 - val_accuracy300: 0.3966 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 3.2471 - accuracy300: 0.3925 - val_loss: 3.2518 - val_accuracy300: 0.3958 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 3.2450 - accuracy300: 0.3946 - val_loss: 3.2510 - val_accuracy300: 0.3957 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 22s - loss: 3.2423 - accuracy300: 0.3963 - val_loss: 3.2517 - val_accuracy300: 0.3952 - 22s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 3.2400 - accuracy300: 0.3977 - val_loss: 3.2513 - val_accuracy300: 0.3947 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 3.2377 - accuracy300: 0.4000 - val_loss: 3.2560 - val_accuracy300: 0.3922 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 3.2364 - accuracy300: 0.4007 - val_loss: 3.2523 - val_accuracy300: 0.3934 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 22s - loss: 3.2345 - accuracy300: 0.4030 - val_loss: 3.2558 - val_accuracy300: 0.3925 - 22s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 23s - loss: 3.2318 - accuracy300: 0.4044 - val_loss: 3.2583 - val_accuracy300: 0.3904 - 23s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 22s - loss: 3.2286 - accuracy300: 0.4064 - val_loss: 3.2589 - val_accuracy300: 0.3908 - 22s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 22s - loss: 3.2267 - accuracy300: 0.4071 - val_loss: 3.2629 - val_accuracy300: 0.3888 - 22s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 3.2240 - accuracy300: 0.4091 - val_loss: 3.2596 - val_accuracy300: 0.3899 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 3.2216 - accuracy300: 0.4108 - val_loss: 3.2645 - val_accuracy300: 0.3877 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h300
Evaluating performance on  test set...
4693/4693 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0849001
{'0': {'precision': 0.36290272139904056, 'recall': 0.6122451671450279, 'f1-score': 0.4556958794261906, 'support': 379072}, '1': {'precision': 0.4330238345936632, 'recall': 0.05235358517554966, 'f1-score': 0.09341328740929797, 'support': 432043}, '2': {'precision': 0.38913448024058356, 'recall': 0.5082036136918312, 'f1-score': 0.44076931628682603, 'support': 390072}, 'accuracy': 0.377077007992927, 'macro avg': {'precision': 0.3950203454110958, 'recall': 0.39093412200413624, 'f1-score': 0.3299594943741049, 'support': 1201187}, 'weighted avg': {'precision': 0.39664235622924, 'recall': 0.377077007992927, 'f1-score': 0.3205428247896914, 'support': 1201187}}
[[232085  14890 132097]
 [230329  22619 179095]
 [177110  14726 198236]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0847654
{'0': {'precision': 0.38320481627389036, 'recall': 0.5576874546544273, 'f1-score': 0.454267773691564, 'support': 126804}, '1': {'precision': 0.39213040427484214, 'recall': 0.05744945001937387, 'f1-score': 0.10021657263459921, 'support': 126459}, '2': {'precision': 0.3923311861394936, 'recall': 0.543950417677176, 'f1-score': 0.4558643717839111, 'support': 129885}, 'accuracy': 0.38792581456773884, 'macro avg': {'precision': 0.38922213556274204, 'recall': 0.386362440783659, 'f1-score': 0.3367829060366914, 'support': 383148}, 'weighted avg': {'precision': 0.389244517598199, 'recall': 0.38792581456773884, 'f1-score': 0.33795348602403547, 'support': 383148}}
[[70717  5796 50291]
 [60056  7265 59138]
 [53768  5466 70651]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0838227
{'0': {'precision': 0.3989562412512933, 'recall': 0.5440492986969873, 'f1-score': 0.46034058988764043, 'support': 48196}, '1': {'precision': 0.3363932842130692, 'recall': 0.06397739541935632, 'f1-score': 0.10750820304960432, 'support': 43531}, '2': {'precision': 0.39972656843384474, 'recall': 0.5470003741736997, 'f1-score': 0.46190843982586716, 'support': 48106}, 'accuracy': 0.39561476904593335, 'macro avg': {'precision': 0.3783586979660691, 'recall': 0.3850090227633478, 'f1-score': 0.3432524109210373, 'support': 139833}, 'weighted avg': {'precision': 0.37974496263045904, 'recall': 0.39561476904593335, 'f1-score': 0.3510407562123405, 'support': 139833}}
[[26221  2736 19239]
 [20469  2785 20277]
 [19034  2758 26314]]
training model: results/EXC/W0/deepOF_L1/h500
Epoch 1/50
1497/1497 - 25s - loss: 3.3080 - accuracy500: 0.3595 - val_loss: 3.2978 - val_accuracy500: 0.3439 - 25s/epoch - 16ms/step
Epoch 2/50
1497/1497 - 22s - loss: 3.2898 - accuracy500: 0.3636 - val_loss: 3.2924 - val_accuracy500: 0.3506 - 22s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 22s - loss: 3.2873 - accuracy500: 0.3633 - val_loss: 3.2842 - val_accuracy500: 0.3558 - 22s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 3.2848 - accuracy500: 0.3644 - val_loss: 3.2845 - val_accuracy500: 0.3553 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 23s - loss: 3.2832 - accuracy500: 0.3658 - val_loss: 3.2834 - val_accuracy500: 0.3551 - 23s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 23s - loss: 3.2824 - accuracy500: 0.3659 - val_loss: 3.2830 - val_accuracy500: 0.3567 - 23s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 22s - loss: 3.2817 - accuracy500: 0.3661 - val_loss: 3.2823 - val_accuracy500: 0.3574 - 22s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 22s - loss: 3.2806 - accuracy500: 0.3675 - val_loss: 3.2825 - val_accuracy500: 0.3560 - 22s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 22s - loss: 3.2799 - accuracy500: 0.3674 - val_loss: 3.2824 - val_accuracy500: 0.3561 - 22s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 22s - loss: 3.2789 - accuracy500: 0.3687 - val_loss: 3.2825 - val_accuracy500: 0.3569 - 22s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 3.2785 - accuracy500: 0.3687 - val_loss: 3.2813 - val_accuracy500: 0.3580 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 3.2776 - accuracy500: 0.3693 - val_loss: 3.2813 - val_accuracy500: 0.3582 - 22s/epoch - 15ms/step
Epoch 13/50
1497/1497 - 22s - loss: 3.2767 - accuracy500: 0.3712 - val_loss: 3.2811 - val_accuracy500: 0.3586 - 22s/epoch - 15ms/step
Epoch 14/50
1497/1497 - 22s - loss: 3.2760 - accuracy500: 0.3715 - val_loss: 3.2807 - val_accuracy500: 0.3587 - 22s/epoch - 15ms/step
Epoch 15/50
1497/1497 - 22s - loss: 3.2747 - accuracy500: 0.3717 - val_loss: 3.2808 - val_accuracy500: 0.3578 - 22s/epoch - 15ms/step
Epoch 16/50
1497/1497 - 22s - loss: 3.2740 - accuracy500: 0.3731 - val_loss: 3.2802 - val_accuracy500: 0.3586 - 22s/epoch - 15ms/step
Epoch 17/50
1497/1497 - 22s - loss: 3.2733 - accuracy500: 0.3742 - val_loss: 3.2800 - val_accuracy500: 0.3587 - 22s/epoch - 15ms/step
Epoch 18/50
1497/1497 - 22s - loss: 3.2723 - accuracy500: 0.3743 - val_loss: 3.2802 - val_accuracy500: 0.3580 - 22s/epoch - 15ms/step
Epoch 19/50
1497/1497 - 22s - loss: 3.2713 - accuracy500: 0.3752 - val_loss: 3.2796 - val_accuracy500: 0.3596 - 22s/epoch - 15ms/step
Epoch 20/50
1497/1497 - 22s - loss: 3.2705 - accuracy500: 0.3756 - val_loss: 3.2802 - val_accuracy500: 0.3584 - 22s/epoch - 15ms/step
Epoch 21/50
1497/1497 - 22s - loss: 3.2693 - accuracy500: 0.3765 - val_loss: 3.2804 - val_accuracy500: 0.3577 - 22s/epoch - 15ms/step
Epoch 22/50
1497/1497 - 22s - loss: 3.2684 - accuracy500: 0.3782 - val_loss: 3.2804 - val_accuracy500: 0.3586 - 22s/epoch - 15ms/step
Epoch 23/50
1497/1497 - 22s - loss: 3.2673 - accuracy500: 0.3792 - val_loss: 3.2807 - val_accuracy500: 0.3578 - 22s/epoch - 15ms/step
Epoch 24/50
1497/1497 - 23s - loss: 3.2657 - accuracy500: 0.3805 - val_loss: 3.2809 - val_accuracy500: 0.3570 - 23s/epoch - 15ms/step
Epoch 25/50
1497/1497 - 22s - loss: 3.2646 - accuracy500: 0.3808 - val_loss: 3.2823 - val_accuracy500: 0.3545 - 22s/epoch - 15ms/step
Epoch 26/50
1497/1497 - 22s - loss: 3.2630 - accuracy500: 0.3824 - val_loss: 3.2836 - val_accuracy500: 0.3554 - 22s/epoch - 15ms/step
Epoch 27/50
1497/1497 - 22s - loss: 3.2617 - accuracy500: 0.3838 - val_loss: 3.2839 - val_accuracy500: 0.3549 - 22s/epoch - 15ms/step
Epoch 28/50
1497/1497 - 22s - loss: 3.2598 - accuracy500: 0.3851 - val_loss: 3.2873 - val_accuracy500: 0.3529 - 22s/epoch - 15ms/step
Epoch 29/50
1497/1497 - 22s - loss: 3.2578 - accuracy500: 0.3868 - val_loss: 3.2863 - val_accuracy500: 0.3534 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h500
Evaluating performance on  test set...
4693/4693 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994421
{'0': {'precision': 0.20897162049423204, 'recall': 0.519452948669244, 'f1-score': 0.29804300691993163, 'support': 223745}, '1': {'precision': 0.6496264205437308, 'recall': 0.069659626151613, 'f1-score': 0.12582680784979489, 'support': 742654}, '2': {'precision': 0.22566928911025583, 'recall': 0.5434178918854456, 'f1-score': 0.31890462455196683, 'support': 234788}, 'accuracy': 0.24604495386646708, 'macro avg': {'precision': 0.36142244338273954, 'recall': 0.3775101555687675, 'f1-score': 0.24759147977389775, 'support': 1201187}, 'weighted avg': {'precision': 0.4846776197224783, 'recall': 0.24604495386646708, 'f1-score': 0.19564513579441742, 'support': 1201187}}
[[116225  14457  93063]
 [346196  51733 344725]
 [ 93755  13445 127588]]
Evaluating performance on  train set...
1497/1497 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919727
{'0': {'precision': 0.36673968601679446, 'recall': 0.4783788932279265, 'f1-score': 0.4151855832024469, 'support': 125988}, '1': {'precision': 0.3756558237145855, 'recall': 0.08788267528230469, 'f1-score': 0.14244184180972244, 'support': 126282}, '2': {'precision': 0.3754893931788762, 'recall': 0.5430018796130748, 'f1-score': 0.44397035074950886, 'support': 130878}, 'accuracy': 0.37174929792142986, 'macro avg': {'precision': 0.3726283009700853, 'recall': 0.3697544827077686, 'f1-score': 0.33386592525389275, 'support': 383148}, 'weighted avg': {'precision': 0.37266713931085155, 'recall': 0.37174929792142986, 'f1-score': 0.3351242691840215, 'support': 383148}}
[[60270  9476 56242]
 [53228 11098 61956]
 [50842  8969 71067]]
Evaluating performance on  val set...
547/547 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0921156
{'0': {'precision': 0.36088851634534785, 'recall': 0.481104033970276, 'f1-score': 0.41241438766224436, 'support': 44745}, '1': {'precision': 0.3841037578982374, 'recall': 0.09076977484380526, 'f1-score': 0.14683914439182533, 'support': 50898}, '2': {'precision': 0.35306287139608244, 'recall': 0.5445349626612356, 'f1-score': 0.42837687480528724, 'support': 44190}, 'accuracy': 0.3590711777620447, 'macro avg': {'precision': 0.3660183818798892, 'recall': 0.37213625715843895, 'f1-score': 0.3292101356197856, 'support': 139833}, 'weighted avg': {'precision': 0.366865604116124, 'recall': 0.3590711777620447, 'f1-score': 0.32079176335234094, 'support': 139833}}
[[21527  3855 19363]
 [21549  4620 24729]
 [16574  3553 24063]]
training model: results/EXC/W0/deepOF_L1/h1000
Epoch 1/50
1497/1497 - 25s - loss: 3.2706 - accuracy1000: 0.3925 - val_loss: 3.3229 - val_accuracy1000: 0.3345 - 25s/epoch - 16ms/step
Epoch 2/50
1497/1497 - 22s - loss: 3.2653 - accuracy1000: 0.3867 - val_loss: 3.2995 - val_accuracy1000: 0.3370 - 22s/epoch - 15ms/step
Epoch 3/50
1497/1497 - 23s - loss: 3.2721 - accuracy1000: 0.3792 - val_loss: 3.2999 - val_accuracy1000: 0.3380 - 23s/epoch - 15ms/step
Epoch 4/50
1497/1497 - 22s - loss: 3.2765 - accuracy1000: 0.3749 - val_loss: 3.3011 - val_accuracy1000: 0.3420 - 22s/epoch - 15ms/step
Epoch 5/50
1497/1497 - 23s - loss: 3.2782 - accuracy1000: 0.3730 - val_loss: 3.3007 - val_accuracy1000: 0.3405 - 23s/epoch - 15ms/step
Epoch 6/50
1497/1497 - 22s - loss: 3.2792 - accuracy1000: 0.3712 - val_loss: 3.3020 - val_accuracy1000: 0.3421 - 22s/epoch - 15ms/step
Epoch 7/50
1497/1497 - 23s - loss: 3.2785 - accuracy1000: 0.3722 - val_loss: 3.3018 - val_accuracy1000: 0.3416 - 23s/epoch - 15ms/step
Epoch 8/50
1497/1497 - 23s - loss: 3.2772 - accuracy1000: 0.3735 - val_loss: 3.3013 - val_accuracy1000: 0.3429 - 23s/epoch - 15ms/step
Epoch 9/50
1497/1497 - 23s - loss: 3.2762 - accuracy1000: 0.3745 - val_loss: 3.3018 - val_accuracy1000: 0.3425 - 23s/epoch - 15ms/step
Epoch 10/50
1497/1497 - 23s - loss: 3.2753 - accuracy1000: 0.3746 - val_loss: 3.3022 - val_accuracy1000: 0.3424 - 23s/epoch - 15ms/step
Epoch 11/50
1497/1497 - 22s - loss: 3.2739 - accuracy1000: 0.3757 - val_loss: 3.3021 - val_accuracy1000: 0.3420 - 22s/epoch - 15ms/step
Epoch 12/50
1497/1497 - 22s - loss: 3.2733 - accuracy1000: 0.3768 - val_loss: 3.3027 - val_accuracy1000: 0.3411 - 22s/epoch - 15ms/step
testing model: results/EXC/W0/deepOF_L1/h1000
Evaluating performance on  test set...
4693/4693 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0811841
{'0': {'precision': 0.24852601455021894, 'recall': 0.023666929340688207, 'f1-score': 0.04321822264459787, 'support': 304560}, '1': {'precision': 0.48251658394770236, 'recall': 0.8802813745363284, 'f1-score': 0.6233504520751515, 'support': 580152}, '2': {'precision': 0.29101519585871105, 'recall': 0.10462753772019907, 'f1-score': 0.1539176676211372, 'support': 316475}, 'accuracy': 0.45872707580085365, 'macro avg': {'precision': 0.34068593145221077, 'recall': 0.3361919471990719, 'f1-score': 0.2734954474469622, 'support': 1201187}, 'weighted avg': {'precision': 0.37273386934026725, 'recall': 0.45872707580085365, 'f1-score': 0.35257761466061605, 'support': 1201187}}
[[  7208 271337  26015]
 [ 14801 510697  54654]
 [  6994 276369  33112]]
Evaluating performance on  train set...
1497/1497 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000128
{'0': {'precision': 0.3429047024552643, 'recall': 0.019626056925092294, 'f1-score': 0.037127151482382624, 'support': 125955}, '1': {'precision': 0.3298847159670886, 'recall': 0.8862037900459926, 'f1-score': 0.48079573834099704, 'support': 126542}, '2': {'precision': 0.3609289921102345, 'recall': 0.09944049414087913, 'f1-score': 0.1559223988430635, 'support': 130651}, 'accuracy': 0.33304623800724525, 'macro avg': {'precision': 0.34457280351086245, 'recall': 0.33509011370398806, 'f1-score': 0.2246150962221477, 'support': 383148}, 'weighted avg': {'precision': 0.3447507680422562, 'recall': 0.33304623800724525, 'f1-score': 0.22416565404844874, 'support': 383148}}
[[  2472 112601  10882]
 [  2278 112142  12122]
 [  2459 115200  12992]]
Evaluating performance on  val set...
547/547 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995681
{'0': {'precision': 0.3572949946751864, 'recall': 0.014293017509478976, 'f1-score': 0.02748648205800426, 'support': 46946}, '1': {'precision': 0.3349888114364828, 'recall': 0.8904127174308394, 'f1-score': 0.4868254051809351, 'support': 46739}, '2': {'precision': 0.3681218570075067, 'recall': 0.10945219727832192, 'f1-score': 0.16873507157293421, 'support': 46148}, 'accuracy': 0.3385395435984353, 'macro avg': {'precision': 0.35346855437305863, 'recall': 0.3380526440728801, 'f1-score': 0.22768231960395788, 'support': 139833}, 'weighted avg': {'precision': 0.35341228704907635, 'recall': 0.3385395435984353, 'f1-score': 0.2276351010304761, 'support': 139833}}
[[  671 42088  4187]
 [  639 41617  4483]
 [  568 40529  5051]]
training model: results/EXC/W0/deepLOB_L2/h10
Epoch 1/50
1497/1497 - 66s - loss: 2.8041 - accuracy10: 0.4470 - val_loss: 2.6287 - val_accuracy10: 0.4687 - 66s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 2.5698 - accuracy10: 0.5144 - val_loss: 2.5775 - val_accuracy10: 0.4601 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 2.4560 - accuracy10: 0.5647 - val_loss: 2.4559 - val_accuracy10: 0.6318 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 62s - loss: 2.3111 - accuracy10: 0.6171 - val_loss: 2.3069 - val_accuracy10: 0.6465 - 62s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 62s - loss: 2.2290 - accuracy10: 0.6393 - val_loss: 2.2525 - val_accuracy10: 0.6512 - 62s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 2.1944 - accuracy10: 0.6440 - val_loss: 2.2124 - val_accuracy10: 0.6450 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 2.1593 - accuracy10: 0.6505 - val_loss: 2.2130 - val_accuracy10: 0.6469 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 62s - loss: 2.1317 - accuracy10: 0.6534 - val_loss: 2.1633 - val_accuracy10: 0.6678 - 62s/epoch - 41ms/step
Epoch 9/50
1497/1497 - 62s - loss: 2.1106 - accuracy10: 0.6557 - val_loss: 2.1505 - val_accuracy10: 0.6491 - 62s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 2.0924 - accuracy10: 0.6563 - val_loss: 2.1221 - val_accuracy10: 0.6499 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 2.0747 - accuracy10: 0.6585 - val_loss: 2.0880 - val_accuracy10: 0.6708 - 63s/epoch - 42ms/step
Epoch 12/50
1497/1497 - 63s - loss: 2.0612 - accuracy10: 0.6589 - val_loss: 2.0936 - val_accuracy10: 0.6365 - 63s/epoch - 42ms/step
Epoch 13/50
1497/1497 - 63s - loss: 2.0501 - accuracy10: 0.6609 - val_loss: 2.0832 - val_accuracy10: 0.6289 - 63s/epoch - 42ms/step
Epoch 14/50
1497/1497 - 62s - loss: 2.0392 - accuracy10: 0.6617 - val_loss: 2.0912 - val_accuracy10: 0.6355 - 62s/epoch - 42ms/step
Epoch 15/50
1497/1497 - 63s - loss: 2.0293 - accuracy10: 0.6624 - val_loss: 2.0911 - val_accuracy10: 0.6396 - 63s/epoch - 42ms/step
Epoch 16/50
1497/1497 - 63s - loss: 2.0213 - accuracy10: 0.6631 - val_loss: 2.0761 - val_accuracy10: 0.6324 - 63s/epoch - 42ms/step
Epoch 17/50
1497/1497 - 63s - loss: 2.0118 - accuracy10: 0.6643 - val_loss: 2.0812 - val_accuracy10: 0.6329 - 63s/epoch - 42ms/step
Epoch 18/50
1497/1497 - 63s - loss: 2.0034 - accuracy10: 0.6646 - val_loss: 2.0721 - val_accuracy10: 0.6283 - 63s/epoch - 42ms/step
Epoch 19/50
1497/1497 - 63s - loss: 1.9941 - accuracy10: 0.6662 - val_loss: 2.0813 - val_accuracy10: 0.6317 - 63s/epoch - 42ms/step
Epoch 20/50
1497/1497 - 63s - loss: 1.9866 - accuracy10: 0.6663 - val_loss: 2.0789 - val_accuracy10: 0.6289 - 63s/epoch - 42ms/step
Epoch 21/50
1497/1497 - 63s - loss: 1.9812 - accuracy10: 0.6663 - val_loss: 2.1017 - val_accuracy10: 0.6264 - 63s/epoch - 42ms/step
Epoch 22/50
1497/1497 - 62s - loss: 1.9734 - accuracy10: 0.6672 - val_loss: 2.1206 - val_accuracy10: 0.6177 - 62s/epoch - 42ms/step
Epoch 23/50
1497/1497 - 63s - loss: 1.9651 - accuracy10: 0.6677 - val_loss: 2.1131 - val_accuracy10: 0.6199 - 63s/epoch - 42ms/step
Epoch 24/50
1497/1497 - 63s - loss: 1.9588 - accuracy10: 0.6687 - val_loss: 2.1194 - val_accuracy10: 0.6186 - 63s/epoch - 42ms/step
Epoch 25/50
1497/1497 - 63s - loss: 1.9515 - accuracy10: 0.6695 - val_loss: 2.1185 - val_accuracy10: 0.6255 - 63s/epoch - 42ms/step
Epoch 26/50
1497/1497 - 63s - loss: 1.9437 - accuracy10: 0.6692 - val_loss: 2.1672 - val_accuracy10: 0.6236 - 63s/epoch - 42ms/step
Epoch 27/50
1497/1497 - 63s - loss: 1.9396 - accuracy10: 0.6695 - val_loss: 2.1533 - val_accuracy10: 0.6221 - 63s/epoch - 42ms/step
Epoch 28/50
1497/1497 - 62s - loss: 1.9319 - accuracy10: 0.6703 - val_loss: 2.1486 - val_accuracy10: 0.6326 - 62s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h10
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69999844
{'0': {'precision': 0.33362491615553236, 'recall': 0.7053788122459721, 'f1-score': 0.45299538521484806, 'support': 136796}, '1': {'precision': 0.9377419923924246, 'recall': 0.6545729704972433, 'f1-score': 0.7709788274630998, 'support': 925744}, '2': {'precision': 0.3686410704072725, 'recall': 0.7066107953725875, 'f1-score': 0.4845111517729094, 'support': 138652}, 'accuracy': 0.6663655768603187, 'macro avg': {'precision': 0.5466693263184098, 'recall': 0.6888541927052675, 'f1-score': 0.569495121483619, 'support': 1201192}, 'weighted avg': {'precision': 0.8032524348562545, 'recall': 0.6663655768603187, 'f1-score': 0.7016991626504903, 'support': 1201192}}
[[ 96493  17835  22468]
 [174450 605967 145327]
 [ 18283  22396  97973]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76288575
{'0': {'precision': 0.3587525536261491, 'recall': 0.6836374695863747, 'f1-score': 0.47056606933511974, 'support': 49320}, '1': {'precision': 0.9308542151226576, 'recall': 0.5998373955000972, 'f1-score': 0.7295540971342953, 'support': 282895}, '2': {'precision': 0.3549298674077609, 'recall': 0.7447088388895433, 'f1-score': 0.4807386424846169, 'support': 50934}, 'accuracy': 0.6298828915121794, 'macro avg': {'precision': 0.548178878718856, 'recall': 0.6760612346586717, 'f1-score': 0.560286269651344, 'support': 383149}, 'weighted avg': {'precision': 0.7806510704673973, 'recall': 0.6298828915121794, 'f1-score': 0.6631401018004119, 'support': 383149}}
[[ 33717   5770   9833]
 [ 54099 169691  59105]
 [  6168   6835  37931]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74703556
{'0': {'precision': 0.34880194115862906, 'recall': 0.6869362642613942, 'f1-score': 0.4626742572066545, 'support': 16741}, '1': {'precision': 0.9333825810740932, 'recall': 0.598523964264398, 'f1-score': 0.7293549913991157, 'support': 105553}, '2': {'precision': 0.3368727346980448, 'recall': 0.752494440960146, 'f1-score': 0.4653983814376641, 'support': 17539}, 'accuracy': 0.6284210451038024, 'macro avg': {'precision': 0.5396857523102557, 'recall': 0.6793182231619793, 'f1-score': 0.5524758766811447, 'support': 139833}, 'weighted avg': {'precision': 0.788576629056942, 'recall': 0.6284210451038024, 'f1-score': 0.6643200057145499, 'support': 139833}}
[[11500  2204  3037]
 [19434 63176 22943]
 [ 2036  2305 13198]]
training model: results/EXC/W0/deepLOB_L2/h20
Epoch 1/50
1497/1497 - 66s - loss: 2.8490 - accuracy20: 0.4710 - val_loss: 2.7132 - val_accuracy20: 0.5633 - 66s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 65s - loss: 2.6322 - accuracy20: 0.5311 - val_loss: 2.5999 - val_accuracy20: 0.5153 - 65s/epoch - 43ms/step
Epoch 3/50
1497/1497 - 63s - loss: 2.4855 - accuracy20: 0.5859 - val_loss: 2.4669 - val_accuracy20: 0.6175 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 65s - loss: 2.3575 - accuracy20: 0.6229 - val_loss: 2.3696 - val_accuracy20: 0.5974 - 65s/epoch - 43ms/step
Epoch 5/50
1497/1497 - 64s - loss: 2.2999 - accuracy20: 0.6352 - val_loss: 2.3104 - val_accuracy20: 0.5997 - 64s/epoch - 43ms/step
Epoch 6/50
1497/1497 - 64s - loss: 2.2619 - accuracy20: 0.6411 - val_loss: 2.2733 - val_accuracy20: 0.6125 - 64s/epoch - 43ms/step
Epoch 7/50
1497/1497 - 63s - loss: 2.2299 - accuracy20: 0.6437 - val_loss: 2.2494 - val_accuracy20: 0.6029 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 2.2051 - accuracy20: 0.6466 - val_loss: 2.2347 - val_accuracy20: 0.6101 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 63s - loss: 2.1866 - accuracy20: 0.6491 - val_loss: 2.2212 - val_accuracy20: 0.6143 - 63s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 2.1684 - accuracy20: 0.6506 - val_loss: 2.2161 - val_accuracy20: 0.6121 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 2.1579 - accuracy20: 0.6515 - val_loss: 2.1937 - val_accuracy20: 0.6073 - 63s/epoch - 42ms/step
Epoch 12/50
1497/1497 - 63s - loss: 2.1460 - accuracy20: 0.6528 - val_loss: 2.1999 - val_accuracy20: 0.6087 - 63s/epoch - 42ms/step
Epoch 13/50
1497/1497 - 63s - loss: 2.1373 - accuracy20: 0.6533 - val_loss: 2.1779 - val_accuracy20: 0.6173 - 63s/epoch - 42ms/step
Epoch 14/50
1497/1497 - 62s - loss: 2.1283 - accuracy20: 0.6552 - val_loss: 2.1970 - val_accuracy20: 0.6024 - 62s/epoch - 42ms/step
Epoch 15/50
1497/1497 - 63s - loss: 2.1199 - accuracy20: 0.6563 - val_loss: 2.1699 - val_accuracy20: 0.6138 - 63s/epoch - 42ms/step
Epoch 16/50
1497/1497 - 63s - loss: 2.1129 - accuracy20: 0.6573 - val_loss: 2.1844 - val_accuracy20: 0.6138 - 63s/epoch - 42ms/step
Epoch 17/50
1497/1497 - 62s - loss: 2.1059 - accuracy20: 0.6581 - val_loss: 2.1949 - val_accuracy20: 0.6089 - 62s/epoch - 42ms/step
Epoch 18/50
1497/1497 - 63s - loss: 2.0975 - accuracy20: 0.6589 - val_loss: 2.1970 - val_accuracy20: 0.6072 - 63s/epoch - 42ms/step
Epoch 19/50
1497/1497 - 63s - loss: 2.0929 - accuracy20: 0.6587 - val_loss: 2.2027 - val_accuracy20: 0.6048 - 63s/epoch - 42ms/step
Epoch 20/50
1497/1497 - 62s - loss: 2.0859 - accuracy20: 0.6600 - val_loss: 2.2010 - val_accuracy20: 0.6061 - 62s/epoch - 41ms/step
Epoch 21/50
1497/1497 - 63s - loss: 2.0799 - accuracy20: 0.6603 - val_loss: 2.1974 - val_accuracy20: 0.6079 - 63s/epoch - 42ms/step
Epoch 22/50
1497/1497 - 63s - loss: 2.0737 - accuracy20: 0.6612 - val_loss: 2.2200 - val_accuracy20: 0.5996 - 63s/epoch - 42ms/step
Epoch 23/50
1497/1497 - 63s - loss: 2.0658 - accuracy20: 0.6620 - val_loss: 2.2175 - val_accuracy20: 0.5986 - 63s/epoch - 42ms/step
Epoch 24/50
1497/1497 - 63s - loss: 2.0608 - accuracy20: 0.6620 - val_loss: 2.2105 - val_accuracy20: 0.6031 - 63s/epoch - 42ms/step
Epoch 25/50
1497/1497 - 63s - loss: 2.0545 - accuracy20: 0.6632 - val_loss: 2.2331 - val_accuracy20: 0.5973 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h20
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7438041
{'0': {'precision': 0.3936952310802111, 'recall': 0.7355850295469468, 'f1-score': 0.5128865318619821, 'support': 190375}, '1': {'precision': 0.8949198714838463, 'recall': 0.6194380091812921, 'f1-score': 0.7321220309234304, 'support': 818839}, '2': {'precision': 0.4546599405846812, 'recall': 0.6600808425965475, 'f1-score': 0.5384432348829602, 'support': 191978}, 'accuracy': 0.6443416206568142, 'macro avg': {'precision': 0.5810916810495795, 'recall': 0.6717012937749288, 'f1-score': 0.5944839325561242, 'support': 1201192}, 'weighted avg': {'precision': 0.745117956443618, 'recall': 0.6443416206568142, 'f1-score': 0.6664214384785252, 'support': 1201192}}
[[140037  24710  25628]
 [185252 507220 126367]
 [ 30410  34847 126721]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7898966
{'0': {'precision': 0.43357977148462334, 'recall': 0.7084471091060193, 'f1-score': 0.537935386453016, 'support': 67384}, '1': {'precision': 0.8801775240527564, 'recall': 0.5695796944115884, 'f1-score': 0.6916071722808217, 'support': 246868}, '2': {'precision': 0.41785972778787933, 'recall': 0.6871271608342888, 'f1-score': 0.5196853851178159, 'support': 68897}, 'accuracy': 0.6151392800190004, 'macro avg': {'precision': 0.577205674441753, 'recall': 0.6550513214506322, 'f1-score': 0.5830759812838845, 'support': 383149}, 'weighted avg': {'precision': 0.7185019039459251, 'recall': 0.6151392800190004, 'f1-score': 0.6336664886658562, 'support': 383149}}
[[ 47738   8885  10761]
 [ 51065 140611  55192]
 [ 11299  10257  47341]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78657633
{'0': {'precision': 0.42119926055146195, 'recall': 0.7009098786828423, 'f1-score': 0.5261925285019597, 'support': 23080}, '1': {'precision': 0.8858451346875317, 'recall': 0.5652192665595583, 'f1-score': 0.6901096007635849, 'support': 92741}, '2': {'precision': 0.40693931648206, 'recall': 0.7160586373479927, 'f1-score': 0.5189544850899432, 'support': 24012}, 'accuracy': 0.6135175530811754, 'macro avg': {'precision': 0.5713279039070179, 'recall': 0.6607292608634644, 'f1-score': 0.5784188714518294, 'support': 139833}, 'weighted avg': {'precision': 0.726916174557875, 'recall': 0.6135175530811754, 'f1-score': 0.6336638214028203, 'support': 139833}}
[[16177  3339  3564]
 [18828 52419 21494]
 [ 3402  3416 17194]]
training model: results/EXC/W0/deepLOB_L2/h30
Epoch 1/50
1497/1497 - 66s - loss: 2.9166 - accuracy30: 0.4611 - val_loss: 2.8555 - val_accuracy30: 0.4796 - 66s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 2.7369 - accuracy30: 0.5192 - val_loss: 2.7948 - val_accuracy30: 0.4744 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 64s - loss: 2.6421 - accuracy30: 0.5543 - val_loss: 2.7033 - val_accuracy30: 0.5116 - 64s/epoch - 43ms/step
Epoch 4/50
1497/1497 - 64s - loss: 2.5413 - accuracy30: 0.5866 - val_loss: 2.5858 - val_accuracy30: 0.5867 - 64s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 2.4667 - accuracy30: 0.6059 - val_loss: 2.5395 - val_accuracy30: 0.5969 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 2.4212 - accuracy30: 0.6173 - val_loss: 2.4757 - val_accuracy30: 0.6200 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 2.3860 - accuracy30: 0.6232 - val_loss: 2.4734 - val_accuracy30: 0.6129 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 2.3598 - accuracy30: 0.6265 - val_loss: 2.4255 - val_accuracy30: 0.6196 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 63s - loss: 2.3369 - accuracy30: 0.6288 - val_loss: 2.4087 - val_accuracy30: 0.6189 - 63s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 2.3183 - accuracy30: 0.6306 - val_loss: 2.3838 - val_accuracy30: 0.6161 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 62s - loss: 2.3035 - accuracy30: 0.6316 - val_loss: 2.3559 - val_accuracy30: 0.6164 - 62s/epoch - 42ms/step
Epoch 12/50
1497/1497 - 63s - loss: 2.2893 - accuracy30: 0.6333 - val_loss: 2.3747 - val_accuracy30: 0.6077 - 63s/epoch - 42ms/step
Epoch 13/50
1497/1497 - 63s - loss: 2.2793 - accuracy30: 0.6343 - val_loss: 2.3690 - val_accuracy30: 0.6067 - 63s/epoch - 42ms/step
Epoch 14/50
1497/1497 - 63s - loss: 2.2680 - accuracy30: 0.6360 - val_loss: 2.3717 - val_accuracy30: 0.6032 - 63s/epoch - 42ms/step
Epoch 15/50
1497/1497 - 62s - loss: 2.2604 - accuracy30: 0.6367 - val_loss: 2.3600 - val_accuracy30: 0.6028 - 62s/epoch - 42ms/step
Epoch 16/50
1497/1497 - 62s - loss: 2.2506 - accuracy30: 0.6373 - val_loss: 2.3849 - val_accuracy30: 0.5935 - 62s/epoch - 42ms/step
Epoch 17/50
1497/1497 - 63s - loss: 2.2448 - accuracy30: 0.6385 - val_loss: 2.3950 - val_accuracy30: 0.5923 - 63s/epoch - 42ms/step
Epoch 18/50
1497/1497 - 62s - loss: 2.2341 - accuracy30: 0.6395 - val_loss: 2.4379 - val_accuracy30: 0.5819 - 62s/epoch - 42ms/step
Epoch 19/50
1497/1497 - 63s - loss: 2.2291 - accuracy30: 0.6406 - val_loss: 2.4319 - val_accuracy30: 0.5865 - 63s/epoch - 42ms/step
Epoch 20/50
1497/1497 - 62s - loss: 2.2203 - accuracy30: 0.6413 - val_loss: 2.4276 - val_accuracy30: 0.5948 - 62s/epoch - 42ms/step
Epoch 21/50
1497/1497 - 63s - loss: 2.2126 - accuracy30: 0.6427 - val_loss: 2.4196 - val_accuracy30: 0.5880 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h30
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7535131
{'0': {'precision': 0.46166987185841646, 'recall': 0.6107579996502885, 'f1-score': 0.5258508752451101, 'support': 228760}, '1': {'precision': 0.8160598479112486, 'recall': 0.6675971221859107, 'f1-score': 0.7344004941537728, 'support': 742647}, '2': {'precision': 0.49639884818121216, 'recall': 0.6286789825271449, 'f1-score': 0.5547625493708753, 'support': 229785}, 'accuracy': 0.6493275013486604, 'macro avg': {'precision': 0.591376189316959, 'recall': 0.6356780347877814, 'f1-score': 0.6050046395899193, 'support': 1201192}, 'weighted avg': {'precision': 0.6874180040221681, 'recall': 0.6493275013486604, 'f1-score': 0.6603191516510891, 'support': 1201192}}
[[139717  51378  37665]
 [137966 495789 108892]
 [ 24951  60373 144461]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.799484
{'0': {'precision': 0.4867874630689449, 'recall': 0.5895260971826052, 'f1-score': 0.5332533638122828, 'support': 79932}, '1': {'precision': 0.7914510254935787, 'recall': 0.6145481442727055, 'f1-score': 0.6918706204935514, 'support': 221719}, '2': {'precision': 0.46552116721839804, 'recall': 0.6522368647083364, 'f1-score': 0.5432840702356861, 'support': 81498}, 'accuracy': 0.6173446883588369, 'macro avg': {'precision': 0.5812532185936405, 'recall': 0.6187703687212157, 'f1-score': 0.5894693515138401, 'support': 383149}, 'weighted avg': {'precision': 0.6585653871089385, 'recall': 0.6173446883588369, 'f1-score': 0.6271748983750997, 'support': 383149}}
[[ 47122  16752  16058]
 [ 40490 136257  44972]
 [  9190  19152  53156]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7936295
{'0': {'precision': 0.48750184883892916, 'recall': 0.5972096394274325, 'f1-score': 0.5368078175895765, 'support': 27595}, '1': {'precision': 0.8003926074882697, 'recall': 0.5998492931129344, 'f1-score': 0.6857599956243505, 'support': 83606}, '2': {'precision': 0.4493889785566059, 'recall': 0.6807069013690975, 'f1-score': 0.5413738507263687, 'support': 28632}, 'accuracy': 0.6158846624187424, 'macro avg': {'precision': 0.5790944782946016, 'recall': 0.6259219446364881, 'f1-score': 0.5879805546467652, 'support': 139833}, 'weighted avg': {'precision': 0.6667749608061564, 'recall': 0.6158846624187424, 'f1-score': 0.6268010985572161, 'support': 139833}}
[[16480  6133  4982]
 [14557 50151 18898]
 [ 2768  6374 19490]]
training model: results/EXC/W0/deepLOB_L2/h50
Epoch 1/50
1497/1497 - 65s - loss: 3.0099 - accuracy50: 0.4697 - val_loss: 2.9701 - val_accuracy50: 0.4591 - 65s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 2.8308 - accuracy50: 0.5226 - val_loss: 2.9120 - val_accuracy50: 0.4823 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 2.7415 - accuracy50: 0.5522 - val_loss: 2.8523 - val_accuracy50: 0.4968 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 63s - loss: 2.6751 - accuracy50: 0.5674 - val_loss: 2.8217 - val_accuracy50: 0.5012 - 63s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 2.6252 - accuracy50: 0.5779 - val_loss: 2.7881 - val_accuracy50: 0.5183 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 2.5903 - accuracy50: 0.5830 - val_loss: 2.7295 - val_accuracy50: 0.5254 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 2.5647 - accuracy50: 0.5876 - val_loss: 2.6623 - val_accuracy50: 0.5419 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 2.5435 - accuracy50: 0.5910 - val_loss: 2.6908 - val_accuracy50: 0.5377 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 63s - loss: 2.5259 - accuracy50: 0.5927 - val_loss: 2.7231 - val_accuracy50: 0.5325 - 63s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 2.5130 - accuracy50: 0.5950 - val_loss: 2.6471 - val_accuracy50: 0.5485 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 2.5015 - accuracy50: 0.5963 - val_loss: 2.6950 - val_accuracy50: 0.5418 - 63s/epoch - 42ms/step
Epoch 12/50
1497/1497 - 63s - loss: 2.4900 - accuracy50: 0.5981 - val_loss: 2.6760 - val_accuracy50: 0.5473 - 63s/epoch - 42ms/step
Epoch 13/50
1497/1497 - 63s - loss: 2.4799 - accuracy50: 0.5993 - val_loss: 2.7405 - val_accuracy50: 0.5386 - 63s/epoch - 42ms/step
Epoch 14/50
1497/1497 - 63s - loss: 2.4720 - accuracy50: 0.6004 - val_loss: 2.6988 - val_accuracy50: 0.5510 - 63s/epoch - 42ms/step
Epoch 15/50
1497/1497 - 63s - loss: 2.4612 - accuracy50: 0.6021 - val_loss: 2.7210 - val_accuracy50: 0.5503 - 63s/epoch - 42ms/step
Epoch 16/50
1497/1497 - 63s - loss: 2.4553 - accuracy50: 0.6033 - val_loss: 2.7158 - val_accuracy50: 0.5497 - 63s/epoch - 42ms/step
Epoch 17/50
1497/1497 - 63s - loss: 2.4473 - accuracy50: 0.6050 - val_loss: 2.7349 - val_accuracy50: 0.5467 - 63s/epoch - 42ms/step
Epoch 18/50
1497/1497 - 63s - loss: 2.4406 - accuracy50: 0.6054 - val_loss: 2.6984 - val_accuracy50: 0.5449 - 63s/epoch - 42ms/step
Epoch 19/50
1497/1497 - 63s - loss: 2.4324 - accuracy50: 0.6069 - val_loss: 2.7169 - val_accuracy50: 0.5399 - 63s/epoch - 42ms/step
Epoch 20/50
1497/1497 - 63s - loss: 2.4255 - accuracy50: 0.6080 - val_loss: 2.7169 - val_accuracy50: 0.5377 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h50
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84725916
{'0': {'precision': 0.43929741087709395, 'recall': 0.6854445489148862, 'f1-score': 0.5354366181800807, 'support': 286099}, '1': {'precision': 0.7279929797127006, 'recall': 0.5579539912598056, 'f1-score': 0.6317314754163441, 'support': 627446}, '2': {'precision': 0.5538821587913573, 'recall': 0.5273999033537635, 'f1-score': 0.540316735554483, 'support': 287647}, 'accuracy': 0.5810028704819878, 'macro avg': {'precision': 0.5737241831270506, 'recall': 0.5902661478428184, 'f1-score': 0.5691616097169693, 'support': 1201192}, 'weighted avg': {'precision': 0.6175377245546078, 'recall': 0.5810028704819878, 'f1-score': 0.5869051378803944, 'support': 1201192}}
[[196105  52866  37128]
 [192299 350086  85061]
 [ 58002  77940 151705]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8952041
{'0': {'precision': 0.47257786975340926, 'recall': 0.6305324055344284, 'f1-score': 0.5402463700924213, 'support': 98872}, '1': {'precision': 0.6872092852636058, 'recall': 0.5098216375383041, 'f1-score': 0.5853719506669709, 'support': 183727}, '2': {'precision': 0.4969981205624391, 'recall': 0.5680656389855793, 'f1-score': 0.5301608516878753, 'support': 100550}, 'accuracy': 0.5562561823207159, 'macro avg': {'precision': 0.5522617585264847, 'recall': 0.5694732273527706, 'f1-score': 0.5519263908157558, 'support': 383149}, 'weighted avg': {'precision': 0.5819062049344742, 'recall': 0.5562561823207159, 'f1-score': 0.5592381687572833, 'support': 383149}}
[[62342 17732 18798]
 [51048 93668 39011]
 [18529 24902 57119]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8979301
{'0': {'precision': 0.46692367352525205, 'recall': 0.5894770187766386, 'f1-score': 0.5210916219037193, 'support': 34724}, '1': {'precision': 0.6775156475686086, 'recall': 0.5060851051586731, 'f1-score': 0.5793855351246305, 'support': 69514}, '2': {'precision': 0.4808259587020649, 'recall': 0.5953083298216042, 'f1-score': 0.5319776564363271, 'support': 35595}, 'accuracy': 0.5495054815386926, 'macro avg': {'precision': 0.5417550932653085, 'recall': 0.5636234845856386, 'f1-score': 0.5441516044882256, 'support': 139833}, 'weighted avg': {'precision': 0.5751523629227372, 'recall': 0.5495054815386926, 'f1-score': 0.5528418631402413, 'support': 139833}}
[[20469  8325  5930]
 [17384 35180 16950]
 [ 5985  8420 21190]]
training model: results/EXC/W0/deepLOB_L2/h100
Epoch 1/50
1497/1497 - 65s - loss: 3.1711 - accuracy100: 0.4360 - val_loss: 3.1845 - val_accuracy100: 0.4335 - 65s/epoch - 43ms/step
Epoch 2/50
1497/1497 - 63s - loss: 3.0667 - accuracy100: 0.4741 - val_loss: 3.1985 - val_accuracy100: 0.4272 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 3.0361 - accuracy100: 0.4827 - val_loss: 3.1987 - val_accuracy100: 0.4258 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 63s - loss: 3.0186 - accuracy100: 0.4871 - val_loss: 3.2282 - val_accuracy100: 0.4230 - 63s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 3.0005 - accuracy100: 0.4911 - val_loss: 3.2633 - val_accuracy100: 0.4247 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 2.9837 - accuracy100: 0.4948 - val_loss: 3.3135 - val_accuracy100: 0.4213 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 2.9650 - accuracy100: 0.5008 - val_loss: 3.3202 - val_accuracy100: 0.4225 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 2.9469 - accuracy100: 0.5050 - val_loss: 3.2964 - val_accuracy100: 0.4293 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 63s - loss: 2.9258 - accuracy100: 0.5100 - val_loss: 3.3179 - val_accuracy100: 0.4307 - 63s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 2.9092 - accuracy100: 0.5134 - val_loss: 3.3336 - val_accuracy100: 0.4302 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 2.8929 - accuracy100: 0.5178 - val_loss: 3.4004 - val_accuracy100: 0.4236 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h100
Evaluating performance on  test set...
4693/4693 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.049284
{'0': {'precision': 0.41521581091818965, 'recall': 0.6465911244971461, 'f1-score': 0.5056943011689223, 'support': 379832}, '1': {'precision': 0.5173436411865507, 'recall': 0.1505767675962513, 'f1-score': 0.23326112573295418, 'support': 439085}, '2': {'precision': 0.45039354392896497, 'recall': 0.5677745078804526, 'f1-score': 0.5023178095253524, 'support': 382275}, 'accuracy': 0.4401944068891568, 'macro avg': {'precision': 0.4609843320112352, 'recall': 0.4549807999912833, 'f1-score': 0.413757745475743, 'support': 1201192}, 'weighted avg': {'precision': 0.46374291253065253, 'recall': 0.4401944068891568, 'f1-score': 0.40503423252098947, 'support': 1201192}}
[[245596  24403 109833]
 [217945  66116 155024]
 [127949  37280 217046]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0586065
{'0': {'precision': 0.43267007833367, 'recall': 0.6039223979260164, 'f1-score': 0.5041501982745374, 'support': 127677}, '1': {'precision': 0.4340567612687813, 'recall': 0.144327607809551, 'f1-score': 0.21662540468482192, 'support': 126102}, '2': {'precision': 0.43685853981730843, 'recall': 0.5504444616217052, 'f1-score': 0.48711765973383686, 'support': 129370}, 'accuracy': 0.43460377033477837, 'macro avg': {'precision': 0.43452845980658655, 'recall': 0.4328981557857576, 'f1-score': 0.40263108756439875, 'support': 383149}, 'weighted avg': {'precision': 0.4345406946046813, 'recall': 0.43460377033477837, 'f1-score': 0.4037690122809403, 'support': 383149}}
[[77107  9819 40751]
 [56857 18200 51045]
 [44248 13911 71211]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0606267
{'0': {'precision': 0.4538932729981789, 'recall': 0.5350057457557295, 'f1-score': 0.49112296485012535, 'support': 46121}, '1': {'precision': 0.4612799874970696, 'recall': 0.1253051433908595, 'f1-score': 0.19707541815510968, 'support': 47109}, '2': {'precision': 0.41459689293135005, 'recall': 0.6465249018303543, 'f1-score': 0.5052147959354774, 'support': 46603}, 'accuracy': 0.4341464461178692, 'macro avg': {'precision': 0.44325671780886616, 'recall': 0.43561193032564777, 'f1-score': 0.3978043929802375, 'support': 139833}, 'weighted avg': {'precision': 0.4432852729772526, 'recall': 0.4341464461178692, 'f1-score': 0.39675636845882406, 'support': 139833}}
[[24675  3275 18171]
 [16834  5903 24372]
 [12854  3619 30130]]
training model: results/EXC/W0/deepLOB_L2/h200
Epoch 1/50
1497/1497 - 65s - loss: 3.2515 - accuracy200: 0.3996 - val_loss: 3.2641 - val_accuracy200: 0.3715 - 65s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 3.2102 - accuracy200: 0.4163 - val_loss: 3.2938 - val_accuracy200: 0.3684 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 3.1959 - accuracy200: 0.4223 - val_loss: 3.2806 - val_accuracy200: 0.3641 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 63s - loss: 3.1808 - accuracy200: 0.4311 - val_loss: 3.2971 - val_accuracy200: 0.3552 - 63s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 3.1746 - accuracy200: 0.4331 - val_loss: 3.2948 - val_accuracy200: 0.3584 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 3.1645 - accuracy200: 0.4376 - val_loss: 3.2902 - val_accuracy200: 0.3566 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 3.1578 - accuracy200: 0.4404 - val_loss: 3.3056 - val_accuracy200: 0.3596 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 3.1520 - accuracy200: 0.4425 - val_loss: 3.2962 - val_accuracy200: 0.3633 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 62s - loss: 3.1449 - accuracy200: 0.4446 - val_loss: 3.3005 - val_accuracy200: 0.3639 - 62s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 3.1358 - accuracy200: 0.4486 - val_loss: 3.2969 - val_accuracy200: 0.3651 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 3.1294 - accuracy200: 0.4507 - val_loss: 3.2988 - val_accuracy200: 0.3676 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h200
Evaluating performance on  test set...
4693/4693 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.081505
{'0': {'precision': 0.3540686219719099, 'recall': 0.6058051846481438, 'f1-score': 0.4469266802208111, 'support': 350342}, '1': {'precision': 0.4215120769708328, 'recall': 0.29194323320413434, 'f1-score': 0.3449623174162831, 'support': 495360}, '2': {'precision': 0.4066733160141028, 'recall': 0.29591549691974456, 'f1-score': 0.34256433970190275, 'support': 355490}, 'accuracy': 0.3846604039986946, 'macro avg': {'precision': 0.39408467165228184, 'recall': 0.39788797159067424, 'f1-score': 0.3781511124463323, 'support': 1201192}, 'weighted avg': {'precision': 0.39744989037306944, 'recall': 0.3846604039986946, 'f1-score': 0.3739917662437635, 'support': 1201192}}
[[212239  90459  47644]
 [244910 144617 105833]
 [142280 108015 105195]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912533
{'0': {'precision': 0.3950278729545332, 'recall': 0.5169906153060824, 'f1-score': 0.4478543049961903, 'support': 127335}, '1': {'precision': 0.33269988336908385, 'recall': 0.32085325950163607, 'f1-score': 0.32666920258663834, 'support': 127136}, '2': {'precision': 0.420626045094844, 'recall': 0.3069133806866753, 'f1-score': 0.35488320475897367, 'support': 128678}, 'accuracy': 0.3813555561935435, 'macro avg': {'precision': 0.38278460047282037, 'recall': 0.38158575183146454, 'f1-score': 0.37646890411393413, 'support': 383149}, 'weighted avg': {'precision': 0.38294325394400525, 'recall': 0.3813555561935435, 'f1-score': 0.37641910768061504, 'support': 383149}}
[[65831 38718 22786]
 [54732 40792 31612]
 [46086 43099 39493]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879436
{'0': {'precision': 0.38953207404450235, 'recall': 0.40196439799657424, 'f1-score': 0.395650596495721, 'support': 46121}, '1': {'precision': 0.3307482634309329, 'recall': 0.3914174522902749, 'f1-score': 0.35853444660490297, 'support': 48051}, '2': {'precision': 0.4104028268551237, 'recall': 0.3179518626398896, 'f1-score': 0.35830988696381855, 'support': 45661}, 'accuracy': 0.3709067244498795, 'macro avg': {'precision': 0.3768943881101863, 'recall': 0.37044457097557953, 'f1-score': 0.37083164335481417, 'support': 139833}, 'weighted avg': {'precision': 0.37614724042363423, 'recall': 0.3709067244498795, 'f1-score': 0.3707031073026128, 'support': 139833}}
[[18539 19191  8391]
 [16777 18808 12466]
 [12277 18866 14518]]
training model: results/EXC/W0/deepLOB_L2/h300
Epoch 1/50
1497/1497 - 67s - loss: 3.2773 - accuracy300: 0.3838 - val_loss: 3.3460 - val_accuracy300: 0.3441 - 67s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 3.2305 - accuracy300: 0.4049 - val_loss: 3.3716 - val_accuracy300: 0.3540 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 3.2119 - accuracy300: 0.4155 - val_loss: 3.4154 - val_accuracy300: 0.3531 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 63s - loss: 3.1985 - accuracy300: 0.4218 - val_loss: 3.4400 - val_accuracy300: 0.3465 - 63s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 3.1876 - accuracy300: 0.4268 - val_loss: 3.4245 - val_accuracy300: 0.3486 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 3.1762 - accuracy300: 0.4311 - val_loss: 3.4073 - val_accuracy300: 0.3482 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 3.1642 - accuracy300: 0.4353 - val_loss: 3.4121 - val_accuracy300: 0.3483 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 3.1558 - accuracy300: 0.4388 - val_loss: 3.4176 - val_accuracy300: 0.3493 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 63s - loss: 3.1486 - accuracy300: 0.4421 - val_loss: 3.4371 - val_accuracy300: 0.3437 - 63s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 3.1367 - accuracy300: 0.4458 - val_loss: 3.4473 - val_accuracy300: 0.3491 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 3.1268 - accuracy300: 0.4483 - val_loss: 3.4616 - val_accuracy300: 0.3489 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h300
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998818
{'0': {'precision': 0.35049679225282954, 'recall': 0.6166991582096324, 'f1-score': 0.446964395651459, 'support': 379073}, '1': {'precision': 0.37123955133242836, 'recall': 0.3006777087518864, 'f1-score': 0.33225358038490016, 'support': 432044}, '2': {'precision': 0.3976276263240146, 'recall': 0.187856181503557, 'f1-score': 0.255162675868745, 'support': 390075}, 'accuracy': 0.3637703214806625, 'macro avg': {'precision': 0.37312132330309083, 'recall': 0.3684110161550253, 'f1-score': 0.34479355063503475, 'support': 1201192}, 'weighted avg': {'precision': 0.37326279860660455, 'recall': 0.3637703214806625, 'f1-score': 0.34341960404839533, 'support': 1201192}}
[[233774 100862  44437]
 [235565 129906  66573]
 [197640 119157  73278]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039695
{'0': {'precision': 0.35639129669328196, 'recall': 0.5428510584597912, 'f1-score': 0.4302897689975306, 'support': 126788}, '1': {'precision': 0.3327297100256344, 'recall': 0.3356397826929312, 'f1-score': 0.3341784111487285, 'support': 126457}, '2': {'precision': 0.3924980788934426, 'recall': 0.18873167877817465, 'f1-score': 0.25489686434334197, 'support': 129904}, 'accuracy': 0.3543999853842761, 'macro avg': {'precision': 0.3605396952041197, 'recall': 0.3557408399769657, 'f1-score': 0.3397883481632003, 'support': 383149}, 'weighted avg': {'precision': 0.36082362502951393, 'recall': 0.3543999853842761, 'f1-score': 0.33910280552983607, 'support': 383149}}
[[68827 40151 17810]
 [63876 42444 20137]
 [60419 44968 24517]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164635
{'0': {'precision': 0.35541799996502826, 'recall': 0.42137778054190766, 'f1-score': 0.3855974806973612, 'support': 48237}, '1': {'precision': 0.3096425138053612, 'recall': 0.3185006324019777, 'f1-score': 0.3140091141995602, 'support': 43485}, '2': {'precision': 0.36413029144138204, 'recall': 0.2869614017584336, 'f1-score': 0.3209727291749006, 'support': 48111}, 'accuracy': 0.3431378859067602, 'macro avg': {'precision': 0.3430636017372572, 'recall': 0.34227993823410635, 'f1-score': 0.34019310802394065, 'support': 139833}, 'weighted avg': {'precision': 0.34418038108798016, 'recall': 0.3431378859067602, 'f1-score': 0.3411002480151332, 'support': 139833}}
[[20326 15518 12393]
 [17919 13850 11716]
 [18944 15361 13806]]
training model: results/EXC/W0/deepLOB_L2/h500
Epoch 1/50
1497/1497 - 65s - loss: 3.2756 - accuracy500: 0.3862 - val_loss: 3.3544 - val_accuracy500: 0.3589 - 65s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 62s - loss: 3.2374 - accuracy500: 0.4039 - val_loss: 3.3737 - val_accuracy500: 0.3683 - 62s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 3.2210 - accuracy500: 0.4122 - val_loss: 3.3709 - val_accuracy500: 0.3725 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 62s - loss: 3.1995 - accuracy500: 0.4219 - val_loss: 3.4120 - val_accuracy500: 0.3547 - 62s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 62s - loss: 3.1860 - accuracy500: 0.4290 - val_loss: 3.4355 - val_accuracy500: 0.3624 - 62s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 3.1746 - accuracy500: 0.4342 - val_loss: 3.5665 - val_accuracy500: 0.3533 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 3.1595 - accuracy500: 0.4406 - val_loss: 3.5648 - val_accuracy500: 0.3398 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 3.1480 - accuracy500: 0.4451 - val_loss: 3.5850 - val_accuracy500: 0.3516 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 62s - loss: 3.1358 - accuracy500: 0.4497 - val_loss: 3.4483 - val_accuracy500: 0.3429 - 62s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 62s - loss: 3.1255 - accuracy500: 0.4526 - val_loss: 3.4335 - val_accuracy500: 0.3350 - 62s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 63s - loss: 3.1100 - accuracy500: 0.4579 - val_loss: 3.4266 - val_accuracy500: 0.3303 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h500
Evaluating performance on  test set...
4693/4693 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0887734
{'0': {'precision': 0.1811305985940549, 'recall': 0.4323052376121244, 'f1-score': 0.25529550718230587, 'support': 223747}, '1': {'precision': 0.598587508912089, 'recall': 0.33575886515272907, 'f1-score': 0.4302067590042994, 'support': 742655}, '2': {'precision': 0.22966421260549472, 'recall': 0.24513394948677542, 'f1-score': 0.23714706579177786, 'support': 234790}, 'accuracy': 0.3360287114799299, 'macro avg': {'precision': 0.3364607733705462, 'recall': 0.3377326840838763, 'f1-score': 0.3075497773261277, 'support': 1201192}, 'weighted avg': {'precision': 0.4487161877138506, 'recall': 0.3360287114799299, 'f1-score': 0.3598896463105889, 'support': 1201192}}
[[ 96727  84779  42241]
 [342493 249353 150809]
 [ 94798  82437  57555]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1248372
{'0': {'precision': 0.33822517771153404, 'recall': 0.35109573607121886, 'f1-score': 0.34454030148249654, 'support': 126034}, '1': {'precision': 0.33306195500053826, 'recall': 0.392052969642249, 'f1-score': 0.3601578842061226, 'support': 126261}, '2': {'precision': 0.3723998264140026, 'recall': 0.29510752441652527, 'f1-score': 0.3292787434608547, 'support': 130854}, 'accuracy': 0.34547134404631097, 'macro avg': {'precision': 0.34789565304202497, 'recall': 0.34608541004333104, 'f1-score': 0.34465897638315796, 'support': 383149}, 'weighted avg': {'precision': 0.34819512626575133, 'recall': 0.34547134404631097, 'f1-score': 0.34447467609629906, 'support': 383149}}
[[44250 47971 33813]
 [45494 49501 31266]
 [41086 51152 38616]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177815
{'0': {'precision': 0.3025620496397118, 'recall': 0.1688825330145465, 'f1-score': 0.21676967863135102, 'support': 44753}, '1': {'precision': 0.40125386435467436, 'recall': 0.4564798805407105, 'f1-score': 0.427088982232966, 'support': 50896}, '2': {'precision': 0.34091866835229667, 'recall': 0.43943508962520367, 'f1-score': 0.3839582344565733, 'support': 44184}, 'accuracy': 0.35904972359886433, 'macro avg': {'precision': 0.34824486078222766, 'recall': 0.35493250106015356, 'f1-score': 0.3426056317736301, 'support': 139833}, 'weighted avg': {'precision': 0.350603409282497, 'recall': 0.35904972359886433, 'f1-score': 0.3461487982003327, 'support': 139833}}
[[ 7558 17558 19637]
 [ 9764 23233 17899]
 [ 7658 17110 19416]]
training model: results/EXC/W0/deepLOB_L2/h1000
Epoch 1/50
1497/1497 - 66s - loss: 3.2049 - accuracy1000: 0.4343 - val_loss: 3.5748 - val_accuracy1000: 0.3043 - 66s/epoch - 44ms/step
Epoch 2/50
1497/1497 - 63s - loss: 3.1527 - accuracy1000: 0.4523 - val_loss: 3.5650 - val_accuracy1000: 0.3478 - 63s/epoch - 42ms/step
Epoch 3/50
1497/1497 - 63s - loss: 3.1210 - accuracy1000: 0.4649 - val_loss: 3.7397 - val_accuracy1000: 0.3591 - 63s/epoch - 42ms/step
Epoch 4/50
1497/1497 - 63s - loss: 3.1077 - accuracy1000: 0.4698 - val_loss: 3.7431 - val_accuracy1000: 0.3621 - 63s/epoch - 42ms/step
Epoch 5/50
1497/1497 - 63s - loss: 3.0874 - accuracy1000: 0.4755 - val_loss: 3.8681 - val_accuracy1000: 0.3589 - 63s/epoch - 42ms/step
Epoch 6/50
1497/1497 - 63s - loss: 3.0677 - accuracy1000: 0.4826 - val_loss: 3.8044 - val_accuracy1000: 0.3641 - 63s/epoch - 42ms/step
Epoch 7/50
1497/1497 - 63s - loss: 3.0604 - accuracy1000: 0.4866 - val_loss: 3.7535 - val_accuracy1000: 0.3579 - 63s/epoch - 42ms/step
Epoch 8/50
1497/1497 - 63s - loss: 3.0508 - accuracy1000: 0.4894 - val_loss: 3.8512 - val_accuracy1000: 0.3680 - 63s/epoch - 42ms/step
Epoch 9/50
1497/1497 - 62s - loss: 3.0312 - accuracy1000: 0.4961 - val_loss: 3.8712 - val_accuracy1000: 0.3521 - 62s/epoch - 42ms/step
Epoch 10/50
1497/1497 - 63s - loss: 3.0164 - accuracy1000: 0.5000 - val_loss: 3.9081 - val_accuracy1000: 0.3788 - 63s/epoch - 42ms/step
Epoch 11/50
1497/1497 - 62s - loss: 3.0011 - accuracy1000: 0.5048 - val_loss: 3.8568 - val_accuracy1000: 0.3818 - 62s/epoch - 42ms/step
Epoch 12/50
1497/1497 - 63s - loss: 2.9857 - accuracy1000: 0.5087 - val_loss: 3.9297 - val_accuracy1000: 0.3792 - 63s/epoch - 42ms/step
testing model: results/EXC/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
4693/4693 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014978
{'0': {'precision': 0.2617607513149237, 'recall': 0.4206072983497613, 'f1-score': 0.3226953034470945, 'support': 304562}, '1': {'precision': 0.47643737431031813, 'recall': 0.31852005067611244, 'f1-score': 0.3817936705526257, 'support': 580155}, '2': {'precision': 0.29440037042753514, 'recall': 0.3013539774073781, 'f1-score': 0.2978365928875356, 'support': 316475}, 'accuracy': 0.3398815509926806, 'macro avg': {'precision': 0.344199498684259, 'recall': 0.3468271088110839, 'f1-score': 0.3341085222957519, 'support': 1201192}, 'weighted avg': {'precision': 0.3740453316922129, 'recall': 0.3398815509926806, 'f1-score': 0.3446893333305545, 'support': 1201192}}
[[128101 103740  72721]
 [239506 184791 155858]
 [121775  99329  95371]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1541152
{'0': {'precision': 0.33858447488584476, 'recall': 0.3532774844165641, 'f1-score': 0.3457749625973925, 'support': 125935}, '1': {'precision': 0.37258041616053256, 'recall': 0.37326052770907253, 'f1-score': 0.37292016184742915, 'support': 126547}, '2': {'precision': 0.37730353441998543, 'recall': 0.36085622230555536, 'f1-score': 0.36889664290911367, 'support': 130667}, 'accuracy': 0.3624621230904948, 'macro avg': {'precision': 0.3628228084887876, 'recall': 0.3624647448103973, 'f1-score': 0.3625305891179784, 'support': 383149}, 'weighted avg': {'precision': 0.3630172353331784, 'recall': 0.3624621230904948, 'f1-score': 0.36262580686629586, 'support': 383149}}
[[44490 39327 42118]
 [43611 47235 35701]
 [43299 40216 47152]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1860851
{'0': {'precision': 0.27897957731445244, 'recall': 0.1671391725108179, 'f1-score': 0.20904037643796905, 'support': 46913}, '1': {'precision': 0.384113731242243, 'recall': 0.3638423392612859, 'f1-score': 0.37370333373582587, 'support': 46784}, '2': {'precision': 0.35680590992701594, 'recall': 0.5213499219698283, 'f1-score': 0.4236622397576355, 'support': 46136}, 'accuracy': 0.34981728204358054, 'macro avg': {'precision': 0.33996640616123713, 'recall': 0.350777144580644, 'f1-score': 0.3354686499771435, 'support': 139833}, 'weighted avg': {'precision': 0.33983210811026593, 'recall': 0.34981728204358054, 'f1-score': 0.3349433183782769, 'support': 139833}}
[[ 7841 13968 25104]
 [11507 17022 18255]
 [ 8758 13325 24053]]
training model: results/EXC/W0/deepOF_L2/h10
Epoch 1/50
1497/1497 - 38s - loss: 2.6937 - accuracy10: 0.5423 - val_loss: 2.4100 - val_accuracy10: 0.6889 - 38s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 2.3331 - accuracy10: 0.6278 - val_loss: 2.2532 - val_accuracy10: 0.7127 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 2.2503 - accuracy10: 0.6358 - val_loss: 2.2264 - val_accuracy10: 0.7151 - 35s/epoch - 23ms/step
Epoch 4/50
1497/1497 - 36s - loss: 2.2094 - accuracy10: 0.6403 - val_loss: 2.2092 - val_accuracy10: 0.7065 - 36s/epoch - 24ms/step
Epoch 5/50
1497/1497 - 35s - loss: 2.1844 - accuracy10: 0.6423 - val_loss: 2.1884 - val_accuracy10: 0.7046 - 35s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 35s - loss: 2.1651 - accuracy10: 0.6446 - val_loss: 2.1902 - val_accuracy10: 0.7073 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 2.1512 - accuracy10: 0.6472 - val_loss: 2.1806 - val_accuracy10: 0.7081 - 35s/epoch - 23ms/step
Epoch 8/50
1497/1497 - 35s - loss: 2.1401 - accuracy10: 0.6494 - val_loss: 2.1800 - val_accuracy10: 0.7058 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 2.1272 - accuracy10: 0.6494 - val_loss: 2.1776 - val_accuracy10: 0.7115 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 2.1185 - accuracy10: 0.6517 - val_loss: 2.1778 - val_accuracy10: 0.7107 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 2.1103 - accuracy10: 0.6527 - val_loss: 2.1716 - val_accuracy10: 0.7129 - 35s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 35s - loss: 2.1012 - accuracy10: 0.6536 - val_loss: 2.1871 - val_accuracy10: 0.7083 - 35s/epoch - 23ms/step
Epoch 13/50
1497/1497 - 35s - loss: 2.0935 - accuracy10: 0.6550 - val_loss: 2.1861 - val_accuracy10: 0.7083 - 35s/epoch - 23ms/step
Epoch 14/50
1497/1497 - 36s - loss: 2.0888 - accuracy10: 0.6556 - val_loss: 2.1846 - val_accuracy10: 0.7181 - 36s/epoch - 24ms/step
Epoch 15/50
1497/1497 - 35s - loss: 2.0796 - accuracy10: 0.6561 - val_loss: 2.1934 - val_accuracy10: 0.7179 - 35s/epoch - 24ms/step
Epoch 16/50
1497/1497 - 35s - loss: 2.0708 - accuracy10: 0.6566 - val_loss: 2.2039 - val_accuracy10: 0.7173 - 35s/epoch - 24ms/step
Epoch 17/50
1497/1497 - 35s - loss: 2.0663 - accuracy10: 0.6576 - val_loss: 2.1904 - val_accuracy10: 0.7130 - 35s/epoch - 23ms/step
Epoch 18/50
1497/1497 - 35s - loss: 2.0607 - accuracy10: 0.6586 - val_loss: 2.1932 - val_accuracy10: 0.7152 - 35s/epoch - 23ms/step
Epoch 19/50
1497/1497 - 35s - loss: 2.0523 - accuracy10: 0.6584 - val_loss: 2.1874 - val_accuracy10: 0.7103 - 35s/epoch - 23ms/step
Epoch 20/50
1497/1497 - 36s - loss: 2.0480 - accuracy10: 0.6589 - val_loss: 2.1830 - val_accuracy10: 0.7095 - 36s/epoch - 24ms/step
Epoch 21/50
1497/1497 - 36s - loss: 2.0415 - accuracy10: 0.6601 - val_loss: 2.1872 - val_accuracy10: 0.7170 - 36s/epoch - 24ms/step
testing model: results/EXC/W0/deepOF_L2/h10
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6413723
{'0': {'precision': 0.34131354683985626, 'recall': 0.7199511674488647, 'f1-score': 0.4630872641010389, 'support': 136794}, '1': {'precision': 0.9143507641434875, 'recall': 0.7335869674412877, 'f1-score': 0.8140547927142832, 'support': 925743}, '2': {'precision': 0.4422969401988076, 'recall': 0.5420266858997476, 'f1-score': 0.4871096016048586, 'support': 138650}, 'accuracy': 0.7099227680619254, 'macro avg': {'precision': 0.5659870837273838, 'recall': 0.6651882735966334, 'f1-score': 0.5880838861400602, 'support': 1201187}, 'weighted avg': {'precision': 0.7946039505384762, 'recall': 0.7099227680619254, 'f1-score': 0.7363473226397305, 'support': 1201187}}
[[ 98485  24606  13703]
 [165572 679113  81058]
 [ 24490  39008  75152]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66753155
{'0': {'precision': 0.37667894280762565, 'recall': 0.704731989056642, 'f1-score': 0.490946952317086, 'support': 49345}, '1': {'precision': 0.8958232900331374, 'recall': 0.7289864957995964, 'f1-score': 0.803839423852596, 'support': 282949}, '2': {'precision': 0.438679323153116, 'recall': 0.5225351004837377, 'f1-score': 0.47694944763032965, 'support': 50854}, 'accuracy': 0.6984611690521678, 'macro avg': {'precision': 0.5703938519979598, 'recall': 0.6520845284466588, 'f1-score': 0.5905786079333373, 'support': 383148}, 'weighted avg': {'precision': 0.7682882980572967, 'recall': 0.6984611690521678, 'f1-score': 0.7201554639761856, 'support': 383148}}
[[ 34775   9255   5315]
 [ 47996 206266  28687]
 [  9549  14732  26573]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63737714
{'0': {'precision': 0.3803507134284571, 'recall': 0.679309318249479, 'f1-score': 0.4876578829262037, 'support': 16795}, '1': {'precision': 0.904930966469428, 'recall': 0.7390393890294399, 'f1-score': 0.813615192435077, 'support': 105537}, '2': {'precision': 0.4301179853681228, 'recall': 0.581166790469116, 'f1-score': 0.49436181588412564, 'support': 17501}, 'accuracy': 0.71210658428268, 'macro avg': {'precision': 0.5717998884220027, 'recall': 0.6665051659160116, 'f1-score': 0.5985449637484688, 'support': 139833}, 'weighted avg': {'precision': 0.7824990131245305, 'recall': 0.71210658428268, 'f1-score': 0.7345086413618701, 'support': 139833}}
[[11409  3370  2016]
 [16081 77996 11460]
 [ 2506  4824 10171]]
training model: results/EXC/W0/deepOF_L2/h20
Epoch 1/50
1497/1497 - 38s - loss: 2.7290 - accuracy20: 0.5493 - val_loss: 2.4354 - val_accuracy20: 0.6535 - 38s/epoch - 26ms/step
Epoch 2/50
1497/1497 - 35s - loss: 2.3981 - accuracy20: 0.6227 - val_loss: 2.3295 - val_accuracy20: 0.6790 - 35s/epoch - 24ms/step
Epoch 3/50
1497/1497 - 35s - loss: 2.3235 - accuracy20: 0.6322 - val_loss: 2.3162 - val_accuracy20: 0.6912 - 35s/epoch - 24ms/step
Epoch 4/50
1497/1497 - 35s - loss: 2.2889 - accuracy20: 0.6366 - val_loss: 2.3042 - val_accuracy20: 0.6882 - 35s/epoch - 24ms/step
Epoch 5/50
1497/1497 - 36s - loss: 2.2658 - accuracy20: 0.6395 - val_loss: 2.2803 - val_accuracy20: 0.6830 - 36s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 36s - loss: 2.2487 - accuracy20: 0.6427 - val_loss: 2.2867 - val_accuracy20: 0.6852 - 36s/epoch - 24ms/step
Epoch 7/50
1497/1497 - 36s - loss: 2.2351 - accuracy20: 0.6437 - val_loss: 2.2775 - val_accuracy20: 0.6856 - 36s/epoch - 24ms/step
Epoch 8/50
1497/1497 - 36s - loss: 2.2255 - accuracy20: 0.6462 - val_loss: 2.2659 - val_accuracy20: 0.6888 - 36s/epoch - 24ms/step
Epoch 9/50
1497/1497 - 36s - loss: 2.2138 - accuracy20: 0.6476 - val_loss: 2.2781 - val_accuracy20: 0.6831 - 36s/epoch - 24ms/step
Epoch 10/50
1497/1497 - 36s - loss: 2.2038 - accuracy20: 0.6485 - val_loss: 2.2876 - val_accuracy20: 0.6852 - 36s/epoch - 24ms/step
Epoch 11/50
1497/1497 - 36s - loss: 2.1971 - accuracy20: 0.6493 - val_loss: 2.2680 - val_accuracy20: 0.6863 - 36s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 36s - loss: 2.1893 - accuracy20: 0.6499 - val_loss: 2.2808 - val_accuracy20: 0.6902 - 36s/epoch - 24ms/step
Epoch 13/50
1497/1497 - 36s - loss: 2.1814 - accuracy20: 0.6508 - val_loss: 2.2907 - val_accuracy20: 0.6868 - 36s/epoch - 24ms/step
Epoch 14/50
1497/1497 - 35s - loss: 2.1736 - accuracy20: 0.6520 - val_loss: 2.3056 - val_accuracy20: 0.6854 - 35s/epoch - 23ms/step
Epoch 15/50
1497/1497 - 35s - loss: 2.1671 - accuracy20: 0.6532 - val_loss: 2.2850 - val_accuracy20: 0.6892 - 35s/epoch - 23ms/step
Epoch 16/50
1497/1497 - 35s - loss: 2.1613 - accuracy20: 0.6531 - val_loss: 2.2917 - val_accuracy20: 0.6866 - 35s/epoch - 23ms/step
Epoch 17/50
1497/1497 - 35s - loss: 2.1558 - accuracy20: 0.6541 - val_loss: 2.2898 - val_accuracy20: 0.6862 - 35s/epoch - 23ms/step
Epoch 18/50
1497/1497 - 35s - loss: 2.1516 - accuracy20: 0.6539 - val_loss: 2.2934 - val_accuracy20: 0.6842 - 35s/epoch - 23ms/step
testing model: results/EXC/W0/deepOF_L2/h20
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6934464
{'0': {'precision': 0.42337467715679156, 'recall': 0.6707726410783041, 'f1-score': 0.5191040468302202, 'support': 190373}, '1': {'precision': 0.8588555999867236, 'recall': 0.7268226437952318, 'f1-score': 0.7873421991738299, 'support': 818838}, '2': {'precision': 0.5109359043235421, 'recall': 0.5498916531233071, 'f1-score': 0.5296985114993138, 'support': 191976}, 'accuracy': 0.6896619760287116, 'macro avg': {'precision': 0.5977220604890191, 'recall': 0.6491623126656143, 'f1-score': 0.6120482525011213, 'support': 1201187}, 'weighted avg': {'precision': 0.7342321723134824, 'recall': 0.6896619760287116, 'f1-score': 0.7036527267094151, 'support': 1201187}}
[[127697  40901  21775]
 [144416 595150  79272]
 [ 29504  56906 105566]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.727199
{'0': {'precision': 0.4584810387469085, 'recall': 0.6600353079057071, 'f1-score': 0.5410983477959463, 'support': 67407}, '1': {'precision': 0.8343523262286884, 'recall': 0.7161408140457719, 'f1-score': 0.7707402742854154, 'support': 246964}, '2': {'precision': 0.4966681954298972, 'recall': 0.5353533884874304, 'f1-score': 0.5152857372770466, 'support': 68777}, 'accuracy': 0.67381795024377, 'macro avg': {'precision': 0.5965005201351646, 'recall': 0.6371765034796365, 'f1-score': 0.6090414531194694, 'support': 383148}, 'weighted avg': {'precision': 0.7076095079463725, 'recall': 0.67381795024377, 'f1-score': 0.6844841277553533, 'support': 383148}}
[[ 44491  14264   8652]
 [ 41441 176861  28662]
 [ 11108  20849  36820]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6926368
{'0': {'precision': 0.45985199742070193, 'recall': 0.6477788831696872, 'f1-score': 0.5378730740221959, 'support': 23119}, '1': {'precision': 0.8456164074825332, 'recall': 0.7285987075615203, 'f1-score': 0.782758360908443, 'support': 92693}, '2': {'precision': 0.5047080291970802, 'recall': 0.5757045918154948, 'f1-score': 0.5378736313957333, 'support': 24021}, 'accuracy': 0.6889718449865196, 'macro avg': {'precision': 0.6033921447001052, 'recall': 0.6506940608489008, 'f1-score': 0.6195016887754573, 'support': 139833}, 'weighted avg': {'precision': 0.7232744170295333, 'recall': 0.6889718449865196, 'f1-score': 0.7002036060569563, 'support': 139833}}
[[14976  5245  2898]
 [14484 67536 10673]
 [ 3107  7085 13829]]
training model: results/EXC/W0/deepOF_L2/h30
Epoch 1/50
1497/1497 - 37s - loss: 2.7960 - accuracy30: 0.5371 - val_loss: 2.5226 - val_accuracy30: 0.6346 - 37s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 2.5045 - accuracy30: 0.6026 - val_loss: 2.4421 - val_accuracy30: 0.6620 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 2.4244 - accuracy30: 0.6173 - val_loss: 2.4090 - val_accuracy30: 0.6668 - 35s/epoch - 23ms/step
Epoch 4/50
1497/1497 - 35s - loss: 2.3906 - accuracy30: 0.6214 - val_loss: 2.4018 - val_accuracy30: 0.6675 - 35s/epoch - 24ms/step
Epoch 5/50
1497/1497 - 35s - loss: 2.3707 - accuracy30: 0.6239 - val_loss: 2.3798 - val_accuracy30: 0.6605 - 35s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 35s - loss: 2.3540 - accuracy30: 0.6266 - val_loss: 2.3757 - val_accuracy30: 0.6629 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 2.3411 - accuracy30: 0.6283 - val_loss: 2.3681 - val_accuracy30: 0.6608 - 35s/epoch - 24ms/step
Epoch 8/50
1497/1497 - 35s - loss: 2.3304 - accuracy30: 0.6298 - val_loss: 2.3647 - val_accuracy30: 0.6653 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 2.3208 - accuracy30: 0.6310 - val_loss: 2.3679 - val_accuracy30: 0.6621 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 2.3120 - accuracy30: 0.6318 - val_loss: 2.3747 - val_accuracy30: 0.6630 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 2.3042 - accuracy30: 0.6330 - val_loss: 2.3707 - val_accuracy30: 0.6630 - 35s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 35s - loss: 2.2969 - accuracy30: 0.6346 - val_loss: 2.3806 - val_accuracy30: 0.6645 - 35s/epoch - 24ms/step
Epoch 13/50
1497/1497 - 35s - loss: 2.2905 - accuracy30: 0.6349 - val_loss: 2.3931 - val_accuracy30: 0.6648 - 35s/epoch - 24ms/step
Epoch 14/50
1497/1497 - 35s - loss: 2.2830 - accuracy30: 0.6361 - val_loss: 2.3908 - val_accuracy30: 0.6653 - 35s/epoch - 24ms/step
Epoch 15/50
1497/1497 - 35s - loss: 2.2792 - accuracy30: 0.6361 - val_loss: 2.4013 - val_accuracy30: 0.6603 - 35s/epoch - 23ms/step
Epoch 16/50
1497/1497 - 35s - loss: 2.2721 - accuracy30: 0.6370 - val_loss: 2.4108 - val_accuracy30: 0.6613 - 35s/epoch - 23ms/step
Epoch 17/50
1497/1497 - 35s - loss: 2.2657 - accuracy30: 0.6380 - val_loss: 2.3977 - val_accuracy30: 0.6657 - 35s/epoch - 23ms/step
Epoch 18/50
1497/1497 - 35s - loss: 2.2587 - accuracy30: 0.6388 - val_loss: 2.4023 - val_accuracy30: 0.6618 - 35s/epoch - 24ms/step
testing model: results/EXC/W0/deepOF_L2/h30
Evaluating performance on  test set...
4693/4693 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7354211
{'0': {'precision': 0.45951644730775615, 'recall': 0.6535290569072995, 'f1-score': 0.5396137881248873, 'support': 228758}, '1': {'precision': 0.7946763752378457, 'recall': 0.7271459080100074, 'f1-score': 0.7594128181816264, 'support': 742646}, '2': {'precision': 0.570180532632394, 'recall': 0.4871161051949013, 'f1-score': 0.5253854223628287, 'support': 229783}, 'accuracy': 0.6672091855805965, 'macro avg': {'precision': 0.6081244517259986, 'recall': 0.6225970233707361, 'f1-score': 0.6081373428897808, 'support': 1201187}, 'weighted avg': {'precision': 0.6879021236060515, 'recall': 0.6672091855805965, 'f1-score': 0.6727849212670324, 'support': 1201187}}
[[149500  58335  20923]
 [139180 540012  63454]
 [ 36662  81190 111931]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77218497
{'0': {'precision': 0.49277734700324516, 'recall': 0.6434544568192898, 'f1-score': 0.5581251626333594, 'support': 80001}, '1': {'precision': 0.7644261118044747, 'recall': 0.7153402506279226, 'f1-score': 0.7390690588558676, 'support': 221763}, '2': {'precision': 0.5440965683932436, 'recall': 0.47575690553425737, 'f1-score': 0.5076370406303672, 'support': 81384}, 'accuracy': 0.6494409471013812, 'macro avg': {'precision': 0.6004333424003212, 'recall': 0.6115172043271566, 'f1-score': 0.6016104207065315, 'support': 383148}, 'weighted avg': {'precision': 0.6609061341617811, 'recall': 0.6494409471013812, 'f1-score': 0.6521299230311706, 'support': 383148}}
[[ 51477  20169   8355]
 [ 39039 158636  24088]
 [ 13947  28718  38719]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7409333
{'0': {'precision': 0.5002848840521907, 'recall': 0.6352324109242178, 'f1-score': 0.5597399078840423, 'support': 27645}, '1': {'precision': 0.7799610116319602, 'recall': 0.722727979615518, 'f1-score': 0.7502545761617365, 'support': 83593}, '2': {'precision': 0.5514447051921385, 'recall': 0.5259311068368596, 'f1-score': 0.5383858091538833, 'support': 28595}, 'accuracy': 0.6651863294072214, 'macro avg': {'precision': 0.6105635336254298, 'recall': 0.6279638324588652, 'f1-score': 0.6161267643998873, 'support': 139833}, 'weighted avg': {'precision': 0.6779388113674345, 'recall': 0.6651863294072214, 'f1-score': 0.6692639273368782, 'support': 139833}}
[[17561  7229  2855]
 [13800 60415  9378]
 [ 3741  9815 15039]]
training model: results/EXC/W0/deepOF_L2/h50
Epoch 1/50
1497/1497 - 38s - loss: 2.9088 - accuracy50: 0.5109 - val_loss: 2.7050 - val_accuracy50: 0.5698 - 38s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 2.6798 - accuracy50: 0.5673 - val_loss: 2.6280 - val_accuracy50: 0.6037 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 2.6107 - accuracy50: 0.5801 - val_loss: 2.6077 - val_accuracy50: 0.6062 - 35s/epoch - 23ms/step
Epoch 4/50
1497/1497 - 35s - loss: 2.5832 - accuracy50: 0.5849 - val_loss: 2.6051 - val_accuracy50: 0.6049 - 35s/epoch - 23ms/step
Epoch 5/50
1497/1497 - 35s - loss: 2.5636 - accuracy50: 0.5880 - val_loss: 2.5959 - val_accuracy50: 0.6052 - 35s/epoch - 23ms/step
Epoch 6/50
1497/1497 - 35s - loss: 2.5512 - accuracy50: 0.5911 - val_loss: 2.5994 - val_accuracy50: 0.6034 - 35s/epoch - 24ms/step
Epoch 7/50
1497/1497 - 35s - loss: 2.5408 - accuracy50: 0.5915 - val_loss: 2.5855 - val_accuracy50: 0.6036 - 35s/epoch - 23ms/step
Epoch 8/50
1497/1497 - 35s - loss: 2.5309 - accuracy50: 0.5932 - val_loss: 2.5791 - val_accuracy50: 0.6057 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 2.5224 - accuracy50: 0.5945 - val_loss: 2.5741 - val_accuracy50: 0.6061 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 2.5144 - accuracy50: 0.5966 - val_loss: 2.5830 - val_accuracy50: 0.6031 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 2.5086 - accuracy50: 0.5969 - val_loss: 2.5800 - val_accuracy50: 0.6075 - 35s/epoch - 23ms/step
Epoch 12/50
1497/1497 - 35s - loss: 2.5006 - accuracy50: 0.5992 - val_loss: 2.5815 - val_accuracy50: 0.6044 - 35s/epoch - 24ms/step
Epoch 13/50
1497/1497 - 35s - loss: 2.4932 - accuracy50: 0.5995 - val_loss: 2.5946 - val_accuracy50: 0.6021 - 35s/epoch - 24ms/step
Epoch 14/50
1497/1497 - 35s - loss: 2.4859 - accuracy50: 0.6014 - val_loss: 2.5970 - val_accuracy50: 0.6059 - 35s/epoch - 23ms/step
Epoch 15/50
1497/1497 - 36s - loss: 2.4810 - accuracy50: 0.6023 - val_loss: 2.6148 - val_accuracy50: 0.6031 - 36s/epoch - 24ms/step
Epoch 16/50
1497/1497 - 35s - loss: 2.4744 - accuracy50: 0.6026 - val_loss: 2.6049 - val_accuracy50: 0.6025 - 35s/epoch - 23ms/step
Epoch 17/50
1497/1497 - 35s - loss: 2.4678 - accuracy50: 0.6049 - val_loss: 2.6166 - val_accuracy50: 0.6049 - 35s/epoch - 24ms/step
Epoch 18/50
1497/1497 - 35s - loss: 2.4610 - accuracy50: 0.6058 - val_loss: 2.6239 - val_accuracy50: 0.6000 - 35s/epoch - 24ms/step
Epoch 19/50
1497/1497 - 35s - loss: 2.4541 - accuracy50: 0.6068 - val_loss: 2.6185 - val_accuracy50: 0.6020 - 35s/epoch - 23ms/step
testing model: results/EXC/W0/deepOF_L2/h50
Evaluating performance on  test set...
4693/4693 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.841287
{'0': {'precision': 0.46724549054802167, 'recall': 0.6260044670164315, 'f1-score': 0.5350976915251351, 'support': 286097}, '1': {'precision': 0.6808229182908115, 'recall': 0.6611278102019935, 'f1-score': 0.6708308368526636, 'support': 627446}, '2': {'precision': 0.6018668558771921, 'recall': 0.43644574543532977, 'f1-score': 0.5059790822803942, 'support': 287644}, 'accuracy': 0.5989583636852547, 'macro avg': {'precision': 0.5833117549053418, 'recall': 0.5745260075512516, 'f1-score': 0.5706358702193977, 'support': 1201187}, 'weighted avg': {'precision': 0.6110460234677474, 'recall': 0.5989583636852547, 'f1-score': 0.5990256443464544, 'support': 1201187}}
[[179098  79266  27733]
 [157312 414822  55312]
 [ 46896 115207 125541]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86510885
{'0': {'precision': 0.511155652565333, 'recall': 0.6086916946478418, 'f1-score': 0.5556760948947231, 'support': 98876}, '1': {'precision': 0.646648341151748, 'recall': 0.6632864677738043, 'f1-score': 0.6548617399458836, 'support': 183717}, '2': {'precision': 0.5706396746404023, 'recall': 0.43674605937049377, 'f1-score': 0.49479483539511937, 'support': 100555}, 'accuracy': 0.5897433889776275, 'macro avg': {'precision': 0.5761478894524944, 'recall': 0.56957474059738, 'f1-score': 0.5684442234119088, 'support': 383148}, 'weighted avg': {'precision': 0.5917347658813076, 'recall': 0.5897433889776275, 'f1-score': 0.587257035165536, 'support': 383148}}
[[ 60185  27560  11131]
 [ 39947 121857  21913]
 [ 17611  39027  43917]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8400992
{'0': {'precision': 0.5249494871991611, 'recall': 0.5911067592085937, 'f1-score': 0.5560672970117309, 'support': 34723}, '1': {'precision': 0.6594990086291156, 'recall': 0.6790987908153729, 'f1-score': 0.6691554094737514, 'support': 69551}, '2': {'precision': 0.5832875394971837, 'recall': 0.4776006074411541, 'f1-score': 0.5251797448782374, 'support': 35559}, 'accuracy': 0.6060085959680476, 'macro avg': {'precision': 0.5892453451084868, 'recall': 0.5826020524883736, 'f1-score': 0.5834674837879065, 'support': 139833}, 'weighted avg': {'precision': 0.6067077028323818, 'recall': 0.6060085959680476, 'f1-score': 0.6044611728745893, 'support': 139833}}
[[20525 10455  3743]
 [13929 47232  8390]
 [ 4645 13931 16983]]
training model: results/EXC/W0/deepOF_L2/h100
Epoch 1/50
1497/1497 - 38s - loss: 3.0983 - accuracy100: 0.4593 - val_loss: 3.0545 - val_accuracy100: 0.4638 - 38s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 2.9688 - accuracy100: 0.4948 - val_loss: 2.9760 - val_accuracy100: 0.4844 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 2.9149 - accuracy100: 0.5065 - val_loss: 2.9537 - val_accuracy100: 0.4906 - 35s/epoch - 24ms/step
Epoch 4/50
1497/1497 - 35s - loss: 2.8917 - accuracy100: 0.5108 - val_loss: 2.9468 - val_accuracy100: 0.4955 - 35s/epoch - 23ms/step
Epoch 5/50
1497/1497 - 35s - loss: 2.8783 - accuracy100: 0.5143 - val_loss: 2.9414 - val_accuracy100: 0.4979 - 35s/epoch - 23ms/step
Epoch 6/50
1497/1497 - 35s - loss: 2.8712 - accuracy100: 0.5164 - val_loss: 2.9361 - val_accuracy100: 0.5008 - 35s/epoch - 24ms/step
Epoch 7/50
1497/1497 - 35s - loss: 2.8622 - accuracy100: 0.5179 - val_loss: 2.9335 - val_accuracy100: 0.4993 - 35s/epoch - 24ms/step
Epoch 8/50
1497/1497 - 35s - loss: 2.8559 - accuracy100: 0.5207 - val_loss: 2.9305 - val_accuracy100: 0.5015 - 35s/epoch - 24ms/step
Epoch 9/50
1497/1497 - 35s - loss: 2.8486 - accuracy100: 0.5217 - val_loss: 2.9330 - val_accuracy100: 0.5010 - 35s/epoch - 24ms/step
Epoch 10/50
1497/1497 - 35s - loss: 2.8432 - accuracy100: 0.5234 - val_loss: 2.9365 - val_accuracy100: 0.5034 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 2.8370 - accuracy100: 0.5253 - val_loss: 2.9323 - val_accuracy100: 0.5024 - 35s/epoch - 23ms/step
Epoch 12/50
1497/1497 - 35s - loss: 2.8315 - accuracy100: 0.5263 - val_loss: 2.9410 - val_accuracy100: 0.5015 - 35s/epoch - 23ms/step
Epoch 13/50
1497/1497 - 35s - loss: 2.8251 - accuracy100: 0.5279 - val_loss: 2.9594 - val_accuracy100: 0.4981 - 35s/epoch - 23ms/step
Epoch 14/50
1497/1497 - 35s - loss: 2.8190 - accuracy100: 0.5293 - val_loss: 2.9583 - val_accuracy100: 0.4995 - 35s/epoch - 24ms/step
Epoch 15/50
1497/1497 - 35s - loss: 2.8131 - accuracy100: 0.5313 - val_loss: 2.9805 - val_accuracy100: 0.4955 - 35s/epoch - 24ms/step
Epoch 16/50
1497/1497 - 35s - loss: 2.8069 - accuracy100: 0.5316 - val_loss: 3.0050 - val_accuracy100: 0.4937 - 35s/epoch - 23ms/step
Epoch 17/50
1497/1497 - 35s - loss: 2.7986 - accuracy100: 0.5345 - val_loss: 2.9889 - val_accuracy100: 0.4949 - 35s/epoch - 23ms/step
Epoch 18/50
1497/1497 - 35s - loss: 2.7898 - accuracy100: 0.5366 - val_loss: 2.9917 - val_accuracy100: 0.4943 - 35s/epoch - 23ms/step
testing model: results/EXC/W0/deepOF_L2/h100
Evaluating performance on  test set...
4693/4693 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9712977
{'0': {'precision': 0.46346071750438755, 'recall': 0.6173814601268989, 'f1-score': 0.5294613041681813, 'support': 379830}, '1': {'precision': 0.48581341346810547, 'recall': 0.40500586446815534, 'f1-score': 0.4417445521558496, 'support': 439085}, '2': {'precision': 0.5516813960341596, 'recall': 0.47503348401138457, 'f1-score': 0.5104964206046108, 'support': 382272}, 'accuracy': 0.49444757560646263, 'macro avg': {'precision': 0.5003185090022175, 'recall': 0.4991402695354796, 'f1-score': 0.4939007589762139, 'support': 1201187}, 'weighted avg': {'precision': 0.4997073874485029, 'recall': 0.49444757560646263, 'f1-score': 0.49136161275714546, 'support': 1201187}}
[[234500  83894  61436]
 [175120 177832  86133]
 [ 96356 104324 181592]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9777099
{'0': {'precision': 0.5057135008927345, 'recall': 0.5764314508238425, 'f1-score': 0.5387617741197986, 'support': 127755}, '1': {'precision': 0.4477888877435316, 'recall': 0.41362565164607584, 'f1-score': 0.4300298219345897, 'support': 126027}, '2': {'precision': 0.5297565969814062, 'recall': 0.4959726666975867, 'f1-score': 0.512308269656103, 'support': 129366}, 'accuracy': 0.4957144497687578, 'macro avg': {'precision': 0.4944196618725574, 'recall': 0.4953432563891684, 'f1-score': 0.4936999552368304, 'support': 383148}, 'weighted avg': {'precision': 0.49477854611612726, 'recall': 0.4957144497687578, 'f1-score': 0.4940653492487415, 'support': 383148}}
[[73642 28974 25139]
 [42084 52128 31815]
 [29894 35310 64162]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.976745
{'0': {'precision': 0.5183612440191387, 'recall': 0.5634874195435927, 'f1-score': 0.5399831780941404, 'support': 46143}, '1': {'precision': 0.4532647338088193, 'recall': 0.4350507598075578, 'f1-score': 0.4439710176273386, 'support': 47183}, '2': {'precision': 0.533028432388591, 'recall': 0.5087191175521965, 'f1-score': 0.5205901444555685, 'support': 46507}, 'accuracy': 0.5019344503800962, 'macro avg': {'precision': 0.501551470072183, 'recall': 0.5024190989677823, 'f1-score': 0.5015147800590158, 'support': 139833}, 'weighted avg': {'precision': 0.5012742780543422, 'recall': 0.5019344503800962, 'f1-score': 0.5011364567713185, 'support': 139833}}
[[26001 11464  8678]
 [14607 20527 12049]
 [ 9552 13296 23659]]
training model: results/EXC/W0/deepOF_L2/h200
Epoch 1/50
1497/1497 - 37s - loss: 3.2491 - accuracy200: 0.3977 - val_loss: 3.2317 - val_accuracy200: 0.3904 - 37s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 3.2138 - accuracy200: 0.4140 - val_loss: 3.2168 - val_accuracy200: 0.3987 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 3.1962 - accuracy200: 0.4208 - val_loss: 3.2092 - val_accuracy200: 0.4040 - 35s/epoch - 24ms/step
Epoch 4/50
1497/1497 - 35s - loss: 3.1832 - accuracy200: 0.4250 - val_loss: 3.2057 - val_accuracy200: 0.4042 - 35s/epoch - 24ms/step
Epoch 5/50
1497/1497 - 35s - loss: 3.1736 - accuracy200: 0.4287 - val_loss: 3.2016 - val_accuracy200: 0.4070 - 35s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 35s - loss: 3.1675 - accuracy200: 0.4311 - val_loss: 3.2025 - val_accuracy200: 0.4076 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 3.1617 - accuracy200: 0.4331 - val_loss: 3.1990 - val_accuracy200: 0.4095 - 35s/epoch - 24ms/step
Epoch 8/50
1497/1497 - 35s - loss: 3.1563 - accuracy200: 0.4354 - val_loss: 3.2039 - val_accuracy200: 0.4097 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 3.1519 - accuracy200: 0.4373 - val_loss: 3.2006 - val_accuracy200: 0.4099 - 35s/epoch - 24ms/step
Epoch 10/50
1497/1497 - 35s - loss: 3.1465 - accuracy200: 0.4400 - val_loss: 3.1995 - val_accuracy200: 0.4118 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 3.1424 - accuracy200: 0.4418 - val_loss: 3.2033 - val_accuracy200: 0.4106 - 35s/epoch - 23ms/step
Epoch 12/50
1497/1497 - 35s - loss: 3.1387 - accuracy200: 0.4430 - val_loss: 3.1974 - val_accuracy200: 0.4129 - 35s/epoch - 24ms/step
Epoch 13/50
1497/1497 - 35s - loss: 3.1335 - accuracy200: 0.4448 - val_loss: 3.2046 - val_accuracy200: 0.4124 - 35s/epoch - 23ms/step
Epoch 14/50
1497/1497 - 35s - loss: 3.1273 - accuracy200: 0.4468 - val_loss: 3.2115 - val_accuracy200: 0.4099 - 35s/epoch - 23ms/step
Epoch 15/50
1497/1497 - 36s - loss: 3.1232 - accuracy200: 0.4480 - val_loss: 3.2141 - val_accuracy200: 0.4080 - 36s/epoch - 24ms/step
Epoch 16/50
1497/1497 - 35s - loss: 3.1179 - accuracy200: 0.4497 - val_loss: 3.2170 - val_accuracy200: 0.4084 - 35s/epoch - 24ms/step
Epoch 17/50
1497/1497 - 36s - loss: 3.1100 - accuracy200: 0.4522 - val_loss: 3.2218 - val_accuracy200: 0.4072 - 36s/epoch - 24ms/step
Epoch 18/50
1497/1497 - 35s - loss: 3.1049 - accuracy200: 0.4541 - val_loss: 3.2315 - val_accuracy200: 0.4065 - 35s/epoch - 23ms/step
Epoch 19/50
1497/1497 - 35s - loss: 3.1009 - accuracy200: 0.4555 - val_loss: 3.2180 - val_accuracy200: 0.4066 - 35s/epoch - 23ms/step
Epoch 20/50
1497/1497 - 35s - loss: 3.0942 - accuracy200: 0.4574 - val_loss: 3.2319 - val_accuracy200: 0.4091 - 35s/epoch - 23ms/step
Epoch 21/50
1497/1497 - 35s - loss: 3.0887 - accuracy200: 0.4589 - val_loss: 3.2446 - val_accuracy200: 0.4034 - 35s/epoch - 23ms/step
Epoch 22/50
1497/1497 - 35s - loss: 3.0802 - accuracy200: 0.4617 - val_loss: 3.2469 - val_accuracy200: 0.4028 - 35s/epoch - 24ms/step
testing model: results/EXC/W0/deepOF_L2/h200
Evaluating performance on  test set...
4693/4693 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0590768
{'0': {'precision': 0.3780250000472841, 'recall': 0.5704984572173968, 'f1-score': 0.4547334652924715, 'support': 350341}, '1': {'precision': 0.42215294998665515, 'recall': 0.3288847078583411, 'f1-score': 0.369727531443044, 'support': 495359}, '2': {'precision': 0.4205917969227118, 'recall': 0.33903068185334484, 'f1-score': 0.37543260679274437, 'support': 355487}, 'accuracy': 0.40235700186565454, 'macro avg': {'precision': 0.4069232489855503, 'recall': 0.4128046156430276, 'f1-score': 0.3999645345094199, 'support': 1201187}, 'weighted avg': {'precision': 0.40882047158907736, 'recall': 0.40235700186565454, 'f1-score': 0.39620895689268776, 'support': 1201187}}
[[199869  98649  51823]
 [218236 162916 114207]
 [110614 124352 120521]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0624421
{'0': {'precision': 0.44039164844520984, 'recall': 0.5360861167381166, 'f1-score': 0.48354987092730495, 'support': 127362}, '1': {'precision': 0.3534862549379806, 'recall': 0.3421665512683326, 'f1-score': 0.3477343056588385, 'support': 127096}, '2': {'precision': 0.4626825902840558, 'recall': 0.3778149040329474, 'f1-score': 0.4159640680141161, 'support': 128690}, 'accuracy': 0.4186006451814964, 'macro avg': {'precision': 0.41885349788908205, 'recall': 0.4186891906797989, 'f1-score': 0.41574941486675315, 'support': 383148}, 'weighted avg': {'precision': 0.41905079167979875, 'recall': 0.4186006451814964, 'f1-score': 0.41579737826060886, 'support': 383148}}
[[68277 36101 22984]
 [50128 43488 33480]
 [36632 43437 48621]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0656843
{'0': {'precision': 0.43680554275921796, 'recall': 0.514018691588785, 'f1-score': 0.4722770107385492, 'support': 46117}, '1': {'precision': 0.36007353736346925, 'recall': 0.3466239147181911, 'f1-score': 0.3532207417465841, 'support': 48029}, '2': {'precision': 0.44366752269317805, 'recall': 0.3819248363867183, 'f1-score': 0.41048743765879364, 'support': 45687}, 'accuracy': 0.41336451338382213, 'macro avg': {'precision': 0.41351553427195514, 'recall': 0.41418914756456476, 'f1-score': 0.411995063381309, 'support': 139833}, 'weighted avg': {'precision': 0.4126920773403999, 'recall': 0.41336451338382213, 'f1-score': 0.4111960515321395, 'support': 139833}}
[[23705 13689  8723]
 [18224 16648 13157]
 [12340 15898 17449]]
training model: results/EXC/W0/deepOF_L2/h300
Epoch 1/50
1497/1497 - 37s - loss: 3.2683 - accuracy300: 0.3819 - val_loss: 3.2651 - val_accuracy300: 0.3745 - 37s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 3.2346 - accuracy300: 0.3980 - val_loss: 3.2552 - val_accuracy300: 0.3857 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 3.2192 - accuracy300: 0.4063 - val_loss: 3.2491 - val_accuracy300: 0.3912 - 35s/epoch - 24ms/step
Epoch 4/50
1497/1497 - 35s - loss: 3.2079 - accuracy300: 0.4130 - val_loss: 3.2475 - val_accuracy300: 0.3947 - 35s/epoch - 23ms/step
Epoch 5/50
1497/1497 - 35s - loss: 3.2000 - accuracy300: 0.4176 - val_loss: 3.2459 - val_accuracy300: 0.3973 - 35s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 35s - loss: 3.1939 - accuracy300: 0.4202 - val_loss: 3.2411 - val_accuracy300: 0.4009 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 3.1880 - accuracy300: 0.4231 - val_loss: 3.2461 - val_accuracy300: 0.3987 - 35s/epoch - 23ms/step
Epoch 8/50
1497/1497 - 35s - loss: 3.1835 - accuracy300: 0.4260 - val_loss: 3.2449 - val_accuracy300: 0.4006 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 3.1798 - accuracy300: 0.4272 - val_loss: 3.2476 - val_accuracy300: 0.3987 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 3.1754 - accuracy300: 0.4299 - val_loss: 3.2569 - val_accuracy300: 0.3960 - 35s/epoch - 24ms/step
Epoch 11/50
1497/1497 - 35s - loss: 3.1718 - accuracy300: 0.4324 - val_loss: 3.2512 - val_accuracy300: 0.3986 - 35s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 35s - loss: 3.1685 - accuracy300: 0.4336 - val_loss: 3.2482 - val_accuracy300: 0.4010 - 35s/epoch - 24ms/step
Epoch 13/50
1497/1497 - 35s - loss: 3.1639 - accuracy300: 0.4357 - val_loss: 3.2484 - val_accuracy300: 0.4023 - 35s/epoch - 23ms/step
Epoch 14/50
1497/1497 - 35s - loss: 3.1586 - accuracy300: 0.4379 - val_loss: 3.2669 - val_accuracy300: 0.3957 - 35s/epoch - 24ms/step
Epoch 15/50
1497/1497 - 35s - loss: 3.1548 - accuracy300: 0.4394 - val_loss: 3.2868 - val_accuracy300: 0.3911 - 35s/epoch - 23ms/step
Epoch 16/50
1497/1497 - 35s - loss: 3.1494 - accuracy300: 0.4417 - val_loss: 3.3132 - val_accuracy300: 0.3876 - 35s/epoch - 24ms/step
testing model: results/EXC/W0/deepOF_L2/h300
Evaluating performance on  test set...
4693/4693 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.064433
{'0': {'precision': 0.3944234685502083, 'recall': 0.4690375443187574, 'f1-score': 0.4285067011787616, 'support': 379072}, '1': {'precision': 0.41005584540606616, 'recall': 0.36182972528197427, 'f1-score': 0.38443624166025225, 'support': 432043}, '2': {'precision': 0.4262678303455823, 'recall': 0.4034306487007527, 'f1-score': 0.41453494651272443, 'support': 390072}, 'accuracy': 0.4091719274351121, 'macro avg': {'precision': 0.4102490481006189, 'recall': 0.41143263943382813, 'f1-score': 0.4091592964505794, 'support': 1201187}, 'weighted avg': {'precision': 0.41038722181109155, 'recall': 0.4091719274351121, 'f1-score': 0.40811826554979974, 'support': 1201187}}
[[177799 110641  90632]
 [154542 156326 121175]
 [118441 114264 157367]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0725764
{'0': {'precision': 0.4153318872687133, 'recall': 0.42431626762562696, 'f1-score': 0.41977601023596556, 'support': 126804}, '1': {'precision': 0.37641583539567375, 'recall': 0.35240670889379166, 'f1-score': 0.36401581363435875, 'support': 126459}, '2': {'precision': 0.42797763445949943, 'recall': 0.4455171882819417, 'f1-score': 0.43657131648138575, 'support': 129885}, 'accuracy': 0.4077693215154457, 'macro avg': {'precision': 0.40657511904129545, 'recall': 0.4074133882671201, 'f1-score': 0.40678771345057, 'support': 383148}, 'weighted avg': {'precision': 0.4067743791258091, 'recall': 0.4077693215154457, 'f1-score': 0.40706572504497884, 'support': 383148}}
[[53805 37487 35512]
 [40064 44565 41830]
 [35678 36341 57866]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0811886
{'0': {'precision': 0.4288306804267973, 'recall': 0.4069424848535148, 'f1-score': 0.41759996593280246, 'support': 48196}, '1': {'precision': 0.3415243553008596, 'recall': 0.34226183639245594, 'f1-score': 0.3418926981504429, 'support': 43531}, '2': {'precision': 0.4270090347123157, 'recall': 0.44801064316301503, 'f1-score': 0.437257806001339, 'support': 48106}, 'accuracy': 0.40093540151466395, 'macro avg': {'precision': 0.3991213568133242, 'recall': 0.3990716548029953, 'f1-score': 0.3989168233615281, 'support': 139833}, 'weighted avg': {'precision': 0.4010249140640786, 'recall': 0.40093540151466395, 'f1-score': 0.4007945407506432, 'support': 139833}}
[[19613 14548 14035]
 [13747 14899 14885]
 [12376 14178 21552]]
training model: results/EXC/W0/deepOF_L2/h500
Epoch 1/50
1497/1497 - 39s - loss: 3.2899 - accuracy500: 0.3727 - val_loss: 3.2953 - val_accuracy500: 0.3505 - 39s/epoch - 26ms/step
Epoch 2/50
1497/1497 - 35s - loss: 3.2706 - accuracy500: 0.3838 - val_loss: 3.2742 - val_accuracy500: 0.3683 - 35s/epoch - 24ms/step
Epoch 3/50
1497/1497 - 36s - loss: 3.2617 - accuracy500: 0.3881 - val_loss: 3.2713 - val_accuracy500: 0.3673 - 36s/epoch - 24ms/step
Epoch 4/50
1497/1497 - 35s - loss: 3.2544 - accuracy500: 0.3917 - val_loss: 3.2685 - val_accuracy500: 0.3690 - 35s/epoch - 23ms/step
Epoch 5/50
1497/1497 - 35s - loss: 3.2489 - accuracy500: 0.3958 - val_loss: 3.2643 - val_accuracy500: 0.3703 - 35s/epoch - 24ms/step
Epoch 6/50
1497/1497 - 35s - loss: 3.2443 - accuracy500: 0.3993 - val_loss: 3.2602 - val_accuracy500: 0.3732 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 3.2407 - accuracy500: 0.4016 - val_loss: 3.2585 - val_accuracy500: 0.3741 - 35s/epoch - 23ms/step
Epoch 8/50
1497/1497 - 35s - loss: 3.2384 - accuracy500: 0.4041 - val_loss: 3.2574 - val_accuracy500: 0.3749 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 3.2345 - accuracy500: 0.4065 - val_loss: 3.2564 - val_accuracy500: 0.3754 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 3.2322 - accuracy500: 0.4077 - val_loss: 3.2567 - val_accuracy500: 0.3772 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 36s - loss: 3.2289 - accuracy500: 0.4104 - val_loss: 3.2632 - val_accuracy500: 0.3739 - 36s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 35s - loss: 3.2259 - accuracy500: 0.4122 - val_loss: 3.2670 - val_accuracy500: 0.3733 - 35s/epoch - 23ms/step
Epoch 13/50
1497/1497 - 35s - loss: 3.2247 - accuracy500: 0.4130 - val_loss: 3.2707 - val_accuracy500: 0.3693 - 35s/epoch - 23ms/step
Epoch 14/50
1497/1497 - 35s - loss: 3.2210 - accuracy500: 0.4155 - val_loss: 3.2705 - val_accuracy500: 0.3713 - 35s/epoch - 23ms/step
Epoch 15/50
1497/1497 - 35s - loss: 3.2176 - accuracy500: 0.4182 - val_loss: 3.2715 - val_accuracy500: 0.3739 - 35s/epoch - 24ms/step
Epoch 16/50
1497/1497 - 35s - loss: 3.2122 - accuracy500: 0.4208 - val_loss: 3.2769 - val_accuracy500: 0.3692 - 35s/epoch - 24ms/step
Epoch 17/50
1497/1497 - 35s - loss: 3.2103 - accuracy500: 0.4232 - val_loss: 3.2911 - val_accuracy500: 0.3638 - 35s/epoch - 23ms/step
Epoch 18/50
1497/1497 - 35s - loss: 3.2061 - accuracy500: 0.4242 - val_loss: 3.2794 - val_accuracy500: 0.3689 - 35s/epoch - 24ms/step
Epoch 19/50
1497/1497 - 35s - loss: 3.2005 - accuracy500: 0.4277 - val_loss: 3.2929 - val_accuracy500: 0.3669 - 35s/epoch - 24ms/step
testing model: results/EXC/W0/deepOF_L2/h500
Evaluating performance on  test set...
4693/4693 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0828931
{'0': {'precision': 0.19984817956930775, 'recall': 0.5683210798006659, 'f1-score': 0.2957106961092901, 'support': 223745}, '1': {'precision': 0.5600312415405985, 'recall': 0.16992839195641576, 'f1-score': 0.2607410162242574, 'support': 742654}, '2': {'precision': 0.24205166564576167, 'recall': 0.3500732575770482, 'f1-score': 0.28620925001218755, 'support': 234788}, 'accuracy': 0.2793486775997409, 'macro avg': {'precision': 0.33397702891855596, 'recall': 0.36277424311137657, 'f1-score': 0.2808869874485784, 'support': 1201187}, 'weighted avg': {'precision': 0.4307866294477575, 'recall': 0.2793486775997409, 'f1-score': 0.27223292106544966, 'support': 1201187}}
[[127159  49173  47413]
 [406494 126198 209962]
 [102625  49970  82193]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0842277
{'0': {'precision': 0.3772166859168927, 'recall': 0.557330856907007, 'f1-score': 0.44991718273940917, 'support': 125988}, '1': {'precision': 0.3985623655621205, 'recall': 0.23183034795141033, 'f1-score': 0.2931469539792526, 'support': 126282}, '2': {'precision': 0.4176480586649831, 'recall': 0.39426030348874525, 'f1-score': 0.4056173283495855, 'support': 130878}, 'accuracy': 0.3943463100420725, 'macro avg': {'precision': 0.39780903671466544, 'recall': 0.3944738361157209, 'f1-score': 0.38289382168941577, 'support': 383148}, 'weighted avg': {'precision': 0.3980628140957772, 'recall': 0.3943463100420725, 'f1-score': 0.3831149695708126, 'support': 383148}}
[[70217 22194 33577]
 [58634 29276 38372]
 [57294 21984 51600]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0850273
{'0': {'precision': 0.3649330023283426, 'recall': 0.5289306067717063, 'f1-score': 0.4318874432015183, 'support': 44745}, '1': {'precision': 0.406533377034852, 'recall': 0.21932099493103854, 'f1-score': 0.2849266817259466, 'support': 50898}, '2': {'precision': 0.3762967951011132, 'recall': 0.4046616881647431, 'f1-score': 0.3899641264406669, 'support': 44190}, 'accuracy': 0.37696394985446924, 'macro avg': {'precision': 0.38258772482143594, 'recall': 0.38430442995582936, 'f1-score': 0.3689260837893773, 'support': 139833}, 'weighted avg': {'precision': 0.3836663619390257, 'recall': 0.37696394985446924, 'f1-score': 0.36514640063470166, 'support': 139833}}
[[23667  8216 12862]
 [22958 11163 16777]
 [18228  8080 17882]]
training model: results/EXC/W0/deepOF_L2/h1000
Epoch 1/50
1497/1497 - 38s - loss: 3.2569 - accuracy1000: 0.3987 - val_loss: 3.3408 - val_accuracy1000: 0.3384 - 38s/epoch - 25ms/step
Epoch 2/50
1497/1497 - 35s - loss: 3.2499 - accuracy1000: 0.3987 - val_loss: 3.3050 - val_accuracy1000: 0.3406 - 35s/epoch - 23ms/step
Epoch 3/50
1497/1497 - 35s - loss: 3.2515 - accuracy1000: 0.3962 - val_loss: 3.2953 - val_accuracy1000: 0.3440 - 35s/epoch - 23ms/step
Epoch 4/50
1497/1497 - 35s - loss: 3.2514 - accuracy1000: 0.3965 - val_loss: 3.2922 - val_accuracy1000: 0.3455 - 35s/epoch - 24ms/step
Epoch 5/50
1497/1497 - 35s - loss: 3.2499 - accuracy1000: 0.3980 - val_loss: 3.2919 - val_accuracy1000: 0.3466 - 35s/epoch - 23ms/step
Epoch 6/50
1497/1497 - 35s - loss: 3.2454 - accuracy1000: 0.4009 - val_loss: 3.2912 - val_accuracy1000: 0.3493 - 35s/epoch - 23ms/step
Epoch 7/50
1497/1497 - 35s - loss: 3.2426 - accuracy1000: 0.4017 - val_loss: 3.2948 - val_accuracy1000: 0.3461 - 35s/epoch - 23ms/step
Epoch 8/50
1497/1497 - 35s - loss: 3.2390 - accuracy1000: 0.4049 - val_loss: 3.2974 - val_accuracy1000: 0.3457 - 35s/epoch - 23ms/step
Epoch 9/50
1497/1497 - 35s - loss: 3.2361 - accuracy1000: 0.4063 - val_loss: 3.2995 - val_accuracy1000: 0.3457 - 35s/epoch - 23ms/step
Epoch 10/50
1497/1497 - 35s - loss: 3.2333 - accuracy1000: 0.4081 - val_loss: 3.2979 - val_accuracy1000: 0.3470 - 35s/epoch - 23ms/step
Epoch 11/50
1497/1497 - 35s - loss: 3.2303 - accuracy1000: 0.4093 - val_loss: 3.3029 - val_accuracy1000: 0.3447 - 35s/epoch - 24ms/step
Epoch 12/50
1497/1497 - 35s - loss: 3.2266 - accuracy1000: 0.4121 - val_loss: 3.3066 - val_accuracy1000: 0.3434 - 35s/epoch - 23ms/step
Epoch 13/50
1497/1497 - 36s - loss: 3.2234 - accuracy1000: 0.4125 - val_loss: 3.3095 - val_accuracy1000: 0.3442 - 36s/epoch - 24ms/step
Epoch 14/50
1497/1497 - 35s - loss: 3.2196 - accuracy1000: 0.4155 - val_loss: 3.3096 - val_accuracy1000: 0.3449 - 35s/epoch - 23ms/step
Epoch 15/50
1497/1497 - 35s - loss: 3.2170 - accuracy1000: 0.4179 - val_loss: 3.3106 - val_accuracy1000: 0.3449 - 35s/epoch - 23ms/step
Epoch 16/50
1497/1497 - 35s - loss: 3.2138 - accuracy1000: 0.4206 - val_loss: 3.3114 - val_accuracy1000: 0.3472 - 35s/epoch - 23ms/step
testing model: results/EXC/W0/deepOF_L2/h1000
Evaluating performance on  test set...
4693/4693 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0757593
{'0': {'precision': 0.3027833467857422, 'recall': 0.0381829524560021, 'f1-score': 0.06781410456399595, 'support': 304560}, '1': {'precision': 0.4930202337745867, 'recall': 0.7769101890539031, 'f1-score': 0.6032337459497874, 'support': 580152}, '2': {'precision': 0.3236766090293926, 'recall': 0.25422229244016115, 'f1-score': 0.2847757950308031, 'support': 316475}, 'accuracy': 0.4518946675247068, 'macro avg': {'precision': 0.37316006319657385, 'recall': 0.35643847798335543, 'f1-score': 0.3186078818481955, 'support': 1201187}, 'weighted avg': {'precision': 0.40016910406492634, 'recall': 0.4518946675247068, 'f1-score': 0.3835748701897748, 'support': 1201187}}
[[ 11629 236160  56771]
 [ 18086 450726 111340]
 [  8692 227328  80455]]
Evaluating performance on  train set...
1497/1497 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957214
{'0': {'precision': 0.3916647118617562, 'recall': 0.03976817117224406, 'f1-score': 0.07220492417690134, 'support': 125955}, '1': {'precision': 0.334688018755023, 'recall': 0.7536233029349939, 'f1-score': 0.46352304734871036, 'support': 126542}, '2': {'precision': 0.389618599424036, 'recall': 0.2547397264467934, 'f1-score': 0.3080625529334993, 'support': 130651}, 'accuracy': 0.34883648094209024, 'macro avg': {'precision': 0.37199044334693837, 'recall': 0.3493770668513438, 'f1-score': 0.281263508153037, 'support': 383148}, 'weighted avg': {'precision': 0.3721493513869193, 'recall': 0.34883648094209024, 'f1-score': 0.28187119673237687, 'support': 383148}}
[[ 5009 95961 24985]
 [ 4022 95365 27155]
 [ 3758 93611 33282]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966557
{'0': {'precision': 0.4021884769986601, 'recall': 0.038363225833936865, 'f1-score': 0.07004511512134412, 'support': 46946}, '1': {'precision': 0.3392857142857143, 'recall': 0.7593658400907165, 'f1-score': 0.46901491275017015, 'support': 46739}, '2': {'precision': 0.37642696848473023, 'recall': 0.25080176822397504, 'f1-score': 0.3010338773652383, 'support': 46148}, 'accuracy': 0.3494668640449679, 'macro avg': {'precision': 0.3726337199230349, 'recall': 0.34951027804954277, 'f1-score': 0.2800313017455842, 'support': 139833}, 'weighted avg': {'precision': 0.3726614388793234, 'recall': 0.3494668640449679, 'f1-score': 0.27963168461069876, 'support': 139833}}
[[ 1801 35859  9286]
 [ 1360 35492  9887]
 [ 1317 33257 11574]]
training model: results/EXC/W0/deepVOL_L2/h10
Epoch 1/50
1497/1497 - 43s - loss: 2.5106 - accuracy10: 0.5785 - val_loss: 2.2869 - val_accuracy10: 0.6427 - 43s/epoch - 29ms/step
Epoch 2/50
1497/1497 - 40s - loss: 2.3335 - accuracy10: 0.6191 - val_loss: 2.1970 - val_accuracy10: 0.6843 - 40s/epoch - 27ms/step
Epoch 3/50
1497/1497 - 40s - loss: 2.2672 - accuracy10: 0.6382 - val_loss: 2.1784 - val_accuracy10: 0.6978 - 40s/epoch - 27ms/step
Epoch 4/50
1497/1497 - 41s - loss: 2.2389 - accuracy10: 0.6429 - val_loss: 2.1759 - val_accuracy10: 0.6965 - 41s/epoch - 28ms/step
Epoch 5/50
1497/1497 - 37s - loss: 2.2163 - accuracy10: 0.6468 - val_loss: 2.1712 - val_accuracy10: 0.6933 - 37s/epoch - 25ms/step
Epoch 6/50
1497/1497 - 40s - loss: 2.1967 - accuracy10: 0.6482 - val_loss: 2.1553 - val_accuracy10: 0.7040 - 40s/epoch - 27ms/step
Epoch 7/50
1497/1497 - 41s - loss: 2.1772 - accuracy10: 0.6497 - val_loss: 2.1668 - val_accuracy10: 0.7157 - 41s/epoch - 28ms/step
Epoch 8/50
1497/1497 - 40s - loss: 2.1583 - accuracy10: 0.6517 - val_loss: 2.1373 - val_accuracy10: 0.7101 - 40s/epoch - 27ms/step
Epoch 9/50
1497/1497 - 41s - loss: 2.1420 - accuracy10: 0.6526 - val_loss: 2.1289 - val_accuracy10: 0.7060 - 41s/epoch - 27ms/step
Epoch 10/50
1497/1497 - 42s - loss: 2.1308 - accuracy10: 0.6532 - val_loss: 2.1323 - val_accuracy10: 0.7143 - 42s/epoch - 28ms/step
Epoch 11/50
1497/1497 - 42s - loss: 2.1208 - accuracy10: 0.6548 - val_loss: 2.1101 - val_accuracy10: 0.7071 - 42s/epoch - 28ms/step
Epoch 12/50
1497/1497 - 40s - loss: 2.1128 - accuracy10: 0.6557 - val_loss: 2.1082 - val_accuracy10: 0.7080 - 40s/epoch - 27ms/step
Epoch 13/50
1497/1497 - 41s - loss: 2.1044 - accuracy10: 0.6565 - val_loss: 2.0994 - val_accuracy10: 0.7082 - 41s/epoch - 27ms/step
Epoch 14/50
1497/1497 - 40s - loss: 2.0973 - accuracy10: 0.6579 - val_loss: 2.0959 - val_accuracy10: 0.7038 - 40s/epoch - 27ms/step
Epoch 15/50
1497/1497 - 40s - loss: 2.0871 - accuracy10: 0.6599 - val_loss: 2.0989 - val_accuracy10: 0.7048 - 40s/epoch - 27ms/step
Epoch 16/50
1497/1497 - 41s - loss: 2.0804 - accuracy10: 0.6602 - val_loss: 2.0863 - val_accuracy10: 0.6999 - 41s/epoch - 27ms/step
Epoch 17/50
1497/1497 - 38s - loss: 2.0737 - accuracy10: 0.6614 - val_loss: 2.0894 - val_accuracy10: 0.7030 - 38s/epoch - 25ms/step
Epoch 18/50
1497/1497 - 42s - loss: 2.0686 - accuracy10: 0.6620 - val_loss: 2.0909 - val_accuracy10: 0.7031 - 42s/epoch - 28ms/step
Epoch 19/50
1497/1497 - 41s - loss: 2.0618 - accuracy10: 0.6617 - val_loss: 2.1046 - val_accuracy10: 0.7054 - 41s/epoch - 27ms/step
Epoch 20/50
1497/1497 - 41s - loss: 2.0557 - accuracy10: 0.6628 - val_loss: 2.0942 - val_accuracy10: 0.7050 - 41s/epoch - 27ms/step
Epoch 21/50
1497/1497 - 42s - loss: 2.0504 - accuracy10: 0.6632 - val_loss: 2.0719 - val_accuracy10: 0.6981 - 42s/epoch - 28ms/step
Epoch 22/50
1497/1497 - 41s - loss: 2.0452 - accuracy10: 0.6635 - val_loss: 2.0897 - val_accuracy10: 0.6997 - 41s/epoch - 27ms/step
Epoch 23/50
1497/1497 - 42s - loss: 2.0400 - accuracy10: 0.6644 - val_loss: 2.0874 - val_accuracy10: 0.7002 - 42s/epoch - 28ms/step
Epoch 24/50
1497/1497 - 41s - loss: 2.0359 - accuracy10: 0.6647 - val_loss: 2.1050 - val_accuracy10: 0.7051 - 41s/epoch - 28ms/step
Epoch 25/50
1497/1497 - 41s - loss: 2.0306 - accuracy10: 0.6649 - val_loss: 2.0909 - val_accuracy10: 0.7033 - 41s/epoch - 28ms/step
Epoch 26/50
1497/1497 - 40s - loss: 2.0252 - accuracy10: 0.6663 - val_loss: 2.1092 - val_accuracy10: 0.7039 - 40s/epoch - 27ms/step
Epoch 27/50
1497/1497 - 42s - loss: 2.0193 - accuracy10: 0.6663 - val_loss: 2.0974 - val_accuracy10: 0.7013 - 42s/epoch - 28ms/step
Epoch 28/50
1497/1497 - 41s - loss: 2.0150 - accuracy10: 0.6670 - val_loss: 2.0974 - val_accuracy10: 0.6967 - 41s/epoch - 27ms/step
Epoch 29/50
1497/1497 - 41s - loss: 2.0111 - accuracy10: 0.6670 - val_loss: 2.0955 - val_accuracy10: 0.7005 - 41s/epoch - 28ms/step
Epoch 30/50
1497/1497 - 42s - loss: 2.0093 - accuracy10: 0.6673 - val_loss: 2.0947 - val_accuracy10: 0.6966 - 42s/epoch - 28ms/step
Epoch 31/50
1497/1497 - 40s - loss: 2.0025 - accuracy10: 0.6687 - val_loss: 2.1134 - val_accuracy10: 0.7056 - 40s/epoch - 27ms/step
testing model: results/EXC/W0/deepVOL_L2/h10
Evaluating performance on  test set...
4693/4693 - 56s - 56s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6567969
{'0': {'precision': 0.3593393599572796, 'recall': 0.6886751074592824, 'f1-score': 0.47226079415288513, 'support': 136796}, '1': {'precision': 0.9230094947628535, 'recall': 0.7165890354136781, 'f1-score': 0.806805411637648, 'support': 925744}, '2': {'precision': 0.39994553129680904, 'recall': 0.6354902922424487, 'f1-score': 0.4909266161877858, 'support': 138652}, 'accuracy': 0.7040489780151716, 'macro avg': {'precision': 0.5607647953389807, 'recall': 0.6802514783718031, 'f1-score': 0.5899976073261063, 'support': 1201192}, 'weighted avg': {'precision': 0.7984401632793294, 'recall': 0.7040489780151716, 'f1-score': 0.7322448149635443, 'support': 1201192}}
[[ 94208  23698  18890]
 [149058 663378 113308]
 [ 18904  31636  88112]]
Evaluating performance on  train set...
1497/1497 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68401104
{'0': {'precision': 0.3892183223700005, 'recall': 0.657441200324412, 'f1-score': 0.48896160690050366, 'support': 49320}, '1': {'precision': 0.90275489865941, 'recall': 0.7012637197546793, 'f1-score': 0.7893540024947827, 'support': 282895}, '2': {'precision': 0.4032864260117123, 'recall': 0.6341147367181058, 'f1-score': 0.49302020286824244, 'support': 50934}, 'accuracy': 0.686696298306925, 'macro avg': {'precision': 0.5650865490137077, 'recall': 0.664273218932399, 'f1-score': 0.5904452707545096, 'support': 383149}, 'weighted avg': {'precision': 0.7702540931544197, 'recall': 0.686696298306925, 'f1-score': 0.711293460249108, 'support': 383149}}
[[ 32425   9152   7743]
 [ 44465 198384  40046]
 [  6418  12218  32298]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6570971
{'0': {'precision': 0.3815635537815704, 'recall': 0.662385759512574, 'f1-score': 0.4842040914350588, 'support': 16741}, '1': {'precision': 0.9157529799458526, 'recall': 0.7081939878544428, 'f1-score': 0.7987092776014788, 'support': 105553}, '2': {'precision': 0.40124219339784506, 'recall': 0.6666856719311249, 'f1-score': 0.5009747006276644, 'support': 17539}, 'accuracy': 0.6975034505445782, 'macro avg': {'precision': 0.5661862423750894, 'recall': 0.6790884730993806, 'f1-score': 0.5946293565547339, 'support': 139833}, 'weighted avg': {'precision': 0.7872649272781579, 'recall': 0.6975034505445782, 'f1-score': 0.723711973194395, 'support': 139833}}
[[11089  3046  2606]
 [15958 74752 14843]
 [ 2015  3831 11693]]
training model: results/EXC/W0/deepVOL_L2/h20
Epoch 1/50
1497/1497 - 43s - loss: 2.6079 - accuracy20: 0.5766 - val_loss: 2.4134 - val_accuracy20: 0.6642 - 43s/epoch - 29ms/step
Epoch 2/50
1497/1497 - 40s - loss: 2.4034 - accuracy20: 0.6216 - val_loss: 2.3474 - val_accuracy20: 0.6759 - 40s/epoch - 27ms/step
Epoch 3/50
1497/1497 - 42s - loss: 2.3537 - accuracy20: 0.6314 - val_loss: 2.3141 - val_accuracy20: 0.6872 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 41s - loss: 2.3292 - accuracy20: 0.6350 - val_loss: 2.3081 - val_accuracy20: 0.6794 - 41s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 41s - loss: 2.3034 - accuracy20: 0.6374 - val_loss: 2.2991 - val_accuracy20: 0.6883 - 41s/epoch - 28ms/step
Epoch 6/50
1497/1497 - 42s - loss: 2.2797 - accuracy20: 0.6389 - val_loss: 2.2703 - val_accuracy20: 0.6902 - 42s/epoch - 28ms/step
Epoch 7/50
1497/1497 - 41s - loss: 2.2614 - accuracy20: 0.6399 - val_loss: 2.2599 - val_accuracy20: 0.6942 - 41s/epoch - 27ms/step
Epoch 8/50
1497/1497 - 40s - loss: 2.2452 - accuracy20: 0.6428 - val_loss: 2.2429 - val_accuracy20: 0.6911 - 40s/epoch - 27ms/step
Epoch 9/50
1497/1497 - 41s - loss: 2.2323 - accuracy20: 0.6444 - val_loss: 2.2493 - val_accuracy20: 0.6925 - 41s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 40s - loss: 2.2235 - accuracy20: 0.6453 - val_loss: 2.2496 - val_accuracy20: 0.6896 - 40s/epoch - 27ms/step
Epoch 11/50
1497/1497 - 40s - loss: 2.2128 - accuracy20: 0.6462 - val_loss: 2.2228 - val_accuracy20: 0.6919 - 40s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 40s - loss: 2.2042 - accuracy20: 0.6480 - val_loss: 2.2297 - val_accuracy20: 0.6935 - 40s/epoch - 27ms/step
Epoch 13/50
1497/1497 - 42s - loss: 2.1979 - accuracy20: 0.6488 - val_loss: 2.2189 - val_accuracy20: 0.6910 - 42s/epoch - 28ms/step
Epoch 14/50
1497/1497 - 41s - loss: 2.1897 - accuracy20: 0.6495 - val_loss: 2.2134 - val_accuracy20: 0.6888 - 41s/epoch - 28ms/step
Epoch 15/50
1497/1497 - 41s - loss: 2.1837 - accuracy20: 0.6503 - val_loss: 2.2053 - val_accuracy20: 0.6898 - 41s/epoch - 27ms/step
Epoch 16/50
1497/1497 - 41s - loss: 2.1776 - accuracy20: 0.6505 - val_loss: 2.2096 - val_accuracy20: 0.6835 - 41s/epoch - 28ms/step
Epoch 17/50
1497/1497 - 46s - loss: 2.1736 - accuracy20: 0.6513 - val_loss: 2.2189 - val_accuracy20: 0.6911 - 46s/epoch - 31ms/step
Epoch 18/50
1497/1497 - 41s - loss: 2.1670 - accuracy20: 0.6519 - val_loss: 2.2091 - val_accuracy20: 0.6881 - 41s/epoch - 27ms/step
Epoch 19/50
1497/1497 - 41s - loss: 2.1610 - accuracy20: 0.6527 - val_loss: 2.2093 - val_accuracy20: 0.6850 - 41s/epoch - 27ms/step
Epoch 20/50
1497/1497 - 42s - loss: 2.1584 - accuracy20: 0.6537 - val_loss: 2.2125 - val_accuracy20: 0.6860 - 42s/epoch - 28ms/step
Epoch 21/50
1497/1497 - 42s - loss: 2.1527 - accuracy20: 0.6537 - val_loss: 2.2278 - val_accuracy20: 0.6868 - 42s/epoch - 28ms/step
Epoch 22/50
1497/1497 - 41s - loss: 2.1499 - accuracy20: 0.6537 - val_loss: 2.2205 - val_accuracy20: 0.6845 - 41s/epoch - 27ms/step
Epoch 23/50
1497/1497 - 38s - loss: 2.1451 - accuracy20: 0.6549 - val_loss: 2.2132 - val_accuracy20: 0.6836 - 38s/epoch - 25ms/step
Epoch 24/50
1497/1497 - 41s - loss: 2.1402 - accuracy20: 0.6552 - val_loss: 2.2195 - val_accuracy20: 0.6836 - 41s/epoch - 28ms/step
Epoch 25/50
1497/1497 - 41s - loss: 2.1378 - accuracy20: 0.6551 - val_loss: 2.2148 - val_accuracy20: 0.6823 - 41s/epoch - 27ms/step
testing model: results/EXC/W0/deepVOL_L2/h20
Evaluating performance on  test set...
4693/4693 - 55s - 55s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67432255
{'0': {'precision': 0.4501889459412681, 'recall': 0.6558108995403809, 'f1-score': 0.5338858207024544, 'support': 190375}, '1': {'precision': 0.8543853465574549, 'recall': 0.7430471680025011, 'f1-score': 0.794836221694453, 'support': 818839}, '2': {'precision': 0.515470101213332, 'recall': 0.5685078498577962, 'f1-score': 0.5406914386352546, 'support': 191978}, 'accuracy': 0.7013258496560084, 'macro avg': {'precision': 0.6066814645706851, 'recall': 0.6557886391335594, 'f1-score': 0.6231378270107206, 'support': 1201192}, 'weighted avg': {'precision': 0.7361584846253236, 'recall': 0.7013258496560084, 'f1-score': 0.7128604511673512, 'support': 1201192}}
[[124850  45735  19790]
 [127603 608436  82800]
 [ 24875  57962 109141]]
Evaluating performance on  train set...
1497/1497 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70804405
{'0': {'precision': 0.485839962132145, 'recall': 0.6245102695001781, 'f1-score': 0.5465159317147291, 'support': 67384}, '1': {'precision': 0.8219042493021219, 'recall': 0.7299082910705316, 'f1-score': 0.7731793762765391, 'support': 246868}, '2': {'precision': 0.49160370523701097, 'recall': 0.5515334484810659, 'f1-score': 0.5198470515004138, 'support': 68897}, 'accuracy': 0.6792970880780063, 'macro avg': {'precision': 0.599782638890426, 'recall': 0.6353173363505918, 'f1-score': 0.6131807864972273, 'support': 383149}, 'weighted avg': {'precision': 0.7034070784596672, 'recall': 0.6792970880780063, 'f1-score': 0.6877626670369125, 'support': 383149}}
[[ 42082  17450   7852]
 [ 35232 180191  31445]
 [  9303  21595  37999]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6817959
{'0': {'precision': 0.47867236708984695, 'recall': 0.6354852686308492, 'f1-score': 0.5460434466968225, 'support': 23080}, '1': {'precision': 0.8421604352817851, 'recall': 0.7276609051013037, 'f1-score': 0.7807349904264981, 'support': 92741}, '2': {'precision': 0.49322092222986924, 'recall': 0.5969098783941362, 'f1-score': 0.5401341573711185, 'support': 24012}, 'accuracy': 0.6899944934314504, 'macro avg': {'precision': 0.6046845748671671, 'recall': 0.6533520173754297, 'f1-score': 0.6223041981648131, 'support': 139833}, 'weighted avg': {'precision': 0.7222456783841105, 'recall': 0.6899944934314504, 'f1-score': 0.7006824417962986, 'support': 139833}}
[[14667  5731  2682]
 [13212 67484 12045]
 [ 2762  6917 14333]]
training model: results/EXC/W0/deepVOL_L2/h30
Epoch 1/50
1497/1497 - 41s - loss: 2.7167 - accuracy30: 0.5608 - val_loss: 2.5485 - val_accuracy30: 0.6174 - 41s/epoch - 28ms/step
Epoch 2/50
1497/1497 - 38s - loss: 2.5301 - accuracy30: 0.6011 - val_loss: 2.5159 - val_accuracy30: 0.6184 - 38s/epoch - 26ms/step
Epoch 3/50
1497/1497 - 41s - loss: 2.4747 - accuracy30: 0.6103 - val_loss: 2.4141 - val_accuracy30: 0.6251 - 41s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 41s - loss: 2.4490 - accuracy30: 0.6124 - val_loss: 2.4072 - val_accuracy30: 0.6262 - 41s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 41s - loss: 2.4267 - accuracy30: 0.6163 - val_loss: 2.3805 - val_accuracy30: 0.6357 - 41s/epoch - 27ms/step
Epoch 6/50
1497/1497 - 41s - loss: 2.4077 - accuracy30: 0.6176 - val_loss: 2.3925 - val_accuracy30: 0.6493 - 41s/epoch - 27ms/step
Epoch 7/50
1497/1497 - 41s - loss: 2.3897 - accuracy30: 0.6192 - val_loss: 2.3499 - val_accuracy30: 0.6553 - 41s/epoch - 27ms/step
Epoch 8/50
1497/1497 - 41s - loss: 2.3755 - accuracy30: 0.6214 - val_loss: 2.3469 - val_accuracy30: 0.6614 - 41s/epoch - 28ms/step
Epoch 9/50
1497/1497 - 41s - loss: 2.3623 - accuracy30: 0.6227 - val_loss: 2.3496 - val_accuracy30: 0.6588 - 41s/epoch - 27ms/step
Epoch 10/50
1497/1497 - 40s - loss: 2.3528 - accuracy30: 0.6243 - val_loss: 2.3303 - val_accuracy30: 0.6631 - 40s/epoch - 27ms/step
Epoch 11/50
1497/1497 - 41s - loss: 2.3420 - accuracy30: 0.6250 - val_loss: 2.3375 - val_accuracy30: 0.6641 - 41s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 39s - loss: 2.3362 - accuracy30: 0.6264 - val_loss: 2.3370 - val_accuracy30: 0.6656 - 39s/epoch - 26ms/step
Epoch 13/50
1497/1497 - 41s - loss: 2.3271 - accuracy30: 0.6282 - val_loss: 2.3388 - val_accuracy30: 0.6664 - 41s/epoch - 28ms/step
Epoch 14/50
1497/1497 - 40s - loss: 2.3193 - accuracy30: 0.6286 - val_loss: 2.3392 - val_accuracy30: 0.6661 - 40s/epoch - 27ms/step
Epoch 15/50
1497/1497 - 41s - loss: 2.3133 - accuracy30: 0.6294 - val_loss: 2.3356 - val_accuracy30: 0.6668 - 41s/epoch - 27ms/step
Epoch 16/50
1497/1497 - 40s - loss: 2.3082 - accuracy30: 0.6300 - val_loss: 2.3256 - val_accuracy30: 0.6619 - 40s/epoch - 27ms/step
Epoch 17/50
1497/1497 - 42s - loss: 2.3020 - accuracy30: 0.6303 - val_loss: 2.3364 - val_accuracy30: 0.6654 - 42s/epoch - 28ms/step
Epoch 18/50
1497/1497 - 40s - loss: 2.2952 - accuracy30: 0.6317 - val_loss: 2.3347 - val_accuracy30: 0.6642 - 40s/epoch - 27ms/step
Epoch 19/50
1497/1497 - 40s - loss: 2.2921 - accuracy30: 0.6318 - val_loss: 2.3488 - val_accuracy30: 0.6611 - 40s/epoch - 27ms/step
Epoch 20/50
1497/1497 - 41s - loss: 2.2865 - accuracy30: 0.6328 - val_loss: 2.3536 - val_accuracy30: 0.6641 - 41s/epoch - 27ms/step
Epoch 21/50
1497/1497 - 35s - loss: 2.2827 - accuracy30: 0.6325 - val_loss: 2.3552 - val_accuracy30: 0.6658 - 35s/epoch - 23ms/step
Epoch 22/50
1497/1497 - 40s - loss: 2.2777 - accuracy30: 0.6335 - val_loss: 2.3436 - val_accuracy30: 0.6652 - 40s/epoch - 27ms/step
Epoch 23/50
1497/1497 - 41s - loss: 2.2740 - accuracy30: 0.6340 - val_loss: 2.3411 - val_accuracy30: 0.6599 - 41s/epoch - 27ms/step
Epoch 24/50
1497/1497 - 41s - loss: 2.2693 - accuracy30: 0.6350 - val_loss: 2.3485 - val_accuracy30: 0.6625 - 41s/epoch - 27ms/step
Epoch 25/50
1497/1497 - 41s - loss: 2.2651 - accuracy30: 0.6360 - val_loss: 2.3557 - val_accuracy30: 0.6588 - 41s/epoch - 27ms/step
Epoch 26/50
1497/1497 - 40s - loss: 2.2602 - accuracy30: 0.6357 - val_loss: 2.3439 - val_accuracy30: 0.6590 - 40s/epoch - 27ms/step
testing model: results/EXC/W0/deepVOL_L2/h30
Evaluating performance on  test set...
4693/4693 - 54s - 54s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73416406
{'0': {'precision': 0.47687732246492015, 'recall': 0.6490688931631404, 'f1-score': 0.5498064322624004, 'support': 228760}, '1': {'precision': 0.8082175491873005, 'recall': 0.713878868426049, 'f1-score': 0.7581246795923664, 'support': 742647}, '2': {'precision': 0.5360565102685692, 'recall': 0.5455839153991775, 'f1-score': 0.5407782527488171, 'support': 229785}, 'accuracy': 0.6693417871580897, 'macro avg': {'precision': 0.6070504606402632, 'recall': 0.636177225662789, 'f1-score': 0.6162364548678613, 'support': 1201192}, 'weighted avg': {'precision': 0.6930520181206996, 'recall': 0.6693417871580897, 'f1-score': 0.6768738629440304, 'support': 1201192}}
[[148481  57597  22682]
 [126667 530160  85820]
 [ 36213  68205 125367]]
Evaluating performance on  train set...
1497/1497 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77648836
{'0': {'precision': 0.5054386489468095, 'recall': 0.613308812490617, 'f1-score': 0.554173284423167, 'support': 79932}, '1': {'precision': 0.765538891172058, 'recall': 0.6973195801893387, 'f1-score': 0.7298385574018127, 'support': 221719}, '2': {'precision': 0.5142225970046439, 'recall': 0.5312523006699551, 'f1-score': 0.5225987507166782, 'support': 81498}, 'accuracy': 0.6444699059634763, 'macro avg': {'precision': 0.5950667123745038, 'recall': 0.6139602311166369, 'f1-score': 0.6022035308472193, 'support': 383149}, 'weighted avg': {'precision': 0.6578207243398217, 'recall': 0.6444699059634763, 'f1-score': 0.6491104167438593, 'support': 383149}}
[[ 49023  21478   9431]
 [ 35640 154609  31470]
 [ 12328  25874  43296]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7422343
{'0': {'precision': 0.5098309555209207, 'recall': 0.6164160173944555, 'f1-score': 0.5580800209977197, 'support': 27595}, '1': {'precision': 0.7850947936222533, 'recall': 0.7102719900485611, 'f1-score': 0.7458114591444576, 'support': 83606}, '2': {'precision': 0.5248613408582271, 'recall': 0.5651718357082984, 'f1-score': 0.5442712274859998, 'support': 28632}, 'accuracy': 0.6620397188074346, 'macro avg': {'precision': 0.6065956966671338, 'recall': 0.6306199477171051, 'f1-score': 0.616054235876059, 'support': 139833}, 'weighted avg': {'precision': 0.6774885073239842, 'recall': 0.6620397188074346, 'f1-score': 0.6674969772374385, 'support': 139833}}
[[17010  7513  3072]
 [12646 59383 11577]
 [ 3708  8742 16182]]
training model: results/EXC/W0/deepVOL_L2/h50
Epoch 1/50
1497/1497 - 42s - loss: 2.8798 - accuracy50: 0.5258 - val_loss: 2.7555 - val_accuracy50: 0.5604 - 42s/epoch - 28ms/step
Epoch 2/50
1497/1497 - 40s - loss: 2.7186 - accuracy50: 0.5623 - val_loss: 2.6785 - val_accuracy50: 0.5800 - 40s/epoch - 27ms/step
Epoch 3/50
1497/1497 - 40s - loss: 2.6670 - accuracy50: 0.5709 - val_loss: 2.6660 - val_accuracy50: 0.5843 - 40s/epoch - 27ms/step
Epoch 4/50
1497/1497 - 40s - loss: 2.6430 - accuracy50: 0.5755 - val_loss: 2.6628 - val_accuracy50: 0.5728 - 40s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 40s - loss: 2.6276 - accuracy50: 0.5780 - val_loss: 2.6496 - val_accuracy50: 0.5809 - 40s/epoch - 27ms/step
Epoch 6/50
1497/1497 - 41s - loss: 2.6127 - accuracy50: 0.5791 - val_loss: 2.6378 - val_accuracy50: 0.5816 - 41s/epoch - 28ms/step
Epoch 7/50
1497/1497 - 42s - loss: 2.5992 - accuracy50: 0.5806 - val_loss: 2.6194 - val_accuracy50: 0.5901 - 42s/epoch - 28ms/step
Epoch 8/50
1497/1497 - 41s - loss: 2.5879 - accuracy50: 0.5824 - val_loss: 2.6108 - val_accuracy50: 0.5889 - 41s/epoch - 28ms/step
Epoch 9/50
1497/1497 - 40s - loss: 2.5751 - accuracy50: 0.5854 - val_loss: 2.6055 - val_accuracy50: 0.5922 - 40s/epoch - 27ms/step
Epoch 10/50
1497/1497 - 41s - loss: 2.5638 - accuracy50: 0.5866 - val_loss: 2.5920 - val_accuracy50: 0.5948 - 41s/epoch - 27ms/step
Epoch 11/50
1497/1497 - 40s - loss: 2.5584 - accuracy50: 0.5877 - val_loss: 2.5978 - val_accuracy50: 0.5988 - 40s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 43s - loss: 2.5505 - accuracy50: 0.5882 - val_loss: 2.5891 - val_accuracy50: 0.5949 - 43s/epoch - 29ms/step
Epoch 13/50
1497/1497 - 42s - loss: 2.5420 - accuracy50: 0.5904 - val_loss: 2.5809 - val_accuracy50: 0.5931 - 42s/epoch - 28ms/step
Epoch 14/50
1497/1497 - 41s - loss: 2.5358 - accuracy50: 0.5915 - val_loss: 2.5688 - val_accuracy50: 0.5963 - 41s/epoch - 27ms/step
Epoch 15/50
1497/1497 - 41s - loss: 2.5297 - accuracy50: 0.5919 - val_loss: 2.5845 - val_accuracy50: 0.6004 - 41s/epoch - 27ms/step
Epoch 16/50
1497/1497 - 42s - loss: 2.5222 - accuracy50: 0.5937 - val_loss: 2.5830 - val_accuracy50: 0.5991 - 42s/epoch - 28ms/step
Epoch 17/50
1497/1497 - 43s - loss: 2.5176 - accuracy50: 0.5942 - val_loss: 2.5767 - val_accuracy50: 0.5940 - 43s/epoch - 29ms/step
Epoch 18/50
1497/1497 - 40s - loss: 2.5126 - accuracy50: 0.5949 - val_loss: 2.5764 - val_accuracy50: 0.5923 - 40s/epoch - 27ms/step
Epoch 19/50
1497/1497 - 42s - loss: 2.5077 - accuracy50: 0.5953 - val_loss: 2.5752 - val_accuracy50: 0.5976 - 42s/epoch - 28ms/step
Epoch 20/50
1497/1497 - 41s - loss: 2.5041 - accuracy50: 0.5962 - val_loss: 2.5763 - val_accuracy50: 0.5972 - 41s/epoch - 28ms/step
Epoch 21/50
1497/1497 - 43s - loss: 2.4999 - accuracy50: 0.5969 - val_loss: 2.5734 - val_accuracy50: 0.5983 - 43s/epoch - 28ms/step
Epoch 22/50
1497/1497 - 42s - loss: 2.4949 - accuracy50: 0.5980 - val_loss: 2.5763 - val_accuracy50: 0.5950 - 42s/epoch - 28ms/step
Epoch 23/50
1497/1497 - 39s - loss: 2.4908 - accuracy50: 0.5983 - val_loss: 2.5779 - val_accuracy50: 0.5948 - 39s/epoch - 26ms/step
Epoch 24/50
1497/1497 - 42s - loss: 2.4869 - accuracy50: 0.5994 - val_loss: 2.5857 - val_accuracy50: 0.5953 - 42s/epoch - 28ms/step
testing model: results/EXC/W0/deepVOL_L2/h50
Evaluating performance on  test set...
4693/4693 - 52s - 52s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84240913
{'0': {'precision': 0.4890619072061416, 'recall': 0.612777395237313, 'f1-score': 0.54397420920271, 'support': 286099}, '1': {'precision': 0.6939770276812041, 'recall': 0.6283106434657325, 'f1-score': 0.6595133000591374, 'support': 627446}, '2': {'precision': 0.5427515520034955, 'recall': 0.5182185108831311, 'f1-score': 0.5302013900251116, 'support': 287647}, 'accuracy': 0.598247407575142, 'macro avg': {'precision': 0.5752634956302803, 'recall': 0.5864355165287255, 'f1-score': 0.5778962997623197, 'support': 1201192}, 'weighted avg': {'precision': 0.6089568431852527, 'recall': 0.598247407575142, 'f1-score': 0.6010282274475229, 'support': 1201192}}
[[175315  80637  30147]
 [137781 394231  95434]
 [ 45376  93207 149064]]
Evaluating performance on  train set...
1497/1497 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87239796
{'0': {'precision': 0.5333219233438876, 'recall': 0.5672991342341613, 'f1-score': 0.5497860745039037, 'support': 98872}, '1': {'precision': 0.6429408809244682, 'recall': 0.6268539735585951, 'f1-score': 0.6347955255100494, 'support': 183727}, '2': {'precision': 0.5244617999352541, 'recall': 0.5155842864246644, 'f1-score': 0.5199851553175057, 'support': 100550}, 'accuracy': 0.5822852206321822, 'macro avg': {'precision': 0.5669082014012033, 'recall': 0.5699124647391404, 'f1-score': 0.5681889184438196, 'support': 383149}, 'weighted avg': {'precision': 0.5835610648023521, 'recall': 0.5822852206321822, 'f1-score': 0.5827290000519642, 'support': 383149}}
[[ 56090  30265  12517]
 [ 34068 115170  34489]
 [ 15013  33695  51842]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84696424
{'0': {'precision': 0.5448314139031497, 'recall': 0.565401451445686, 'f1-score': 0.5549258751536907, 'support': 34724}, '1': {'precision': 0.6608456973293768, 'recall': 0.6407486261760221, 'f1-score': 0.6506420088522722, 'support': 69514}, '2': {'precision': 0.5308258695532722, 'recall': 0.5428009551903358, 'f1-score': 0.536746628144403, 'support': 35595}, 'accuracy': 0.597105118248196, 'macro avg': {'precision': 0.5788343269285995, 'recall': 0.5829836776040147, 'f1-score': 0.580771504050122, 'support': 139833}, 'weighted avg': {'precision': 0.5989394538290389, 'recall': 0.597105118248196, 'f1-score': 0.5978808358613034, 'support': 139833}}
[[19633 10933  4158]
 [12054 44541 12919]
 [ 4348 11926 19321]]
training model: results/EXC/W0/deepVOL_L2/h100
Epoch 1/50
1497/1497 - 41s - loss: 3.0856 - accuracy100: 0.4645 - val_loss: 3.0361 - val_accuracy100: 0.4737 - 41s/epoch - 27ms/step
Epoch 2/50
1497/1497 - 42s - loss: 2.9830 - accuracy100: 0.4895 - val_loss: 2.9971 - val_accuracy100: 0.4843 - 42s/epoch - 28ms/step
Epoch 3/50
1497/1497 - 42s - loss: 2.9522 - accuracy100: 0.4964 - val_loss: 2.9700 - val_accuracy100: 0.4915 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 41s - loss: 2.9341 - accuracy100: 0.4998 - val_loss: 2.9660 - val_accuracy100: 0.4935 - 41s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 41s - loss: 2.9193 - accuracy100: 0.5042 - val_loss: 2.9574 - val_accuracy100: 0.4964 - 41s/epoch - 27ms/step
Epoch 6/50
1497/1497 - 42s - loss: 2.9102 - accuracy100: 0.5064 - val_loss: 2.9535 - val_accuracy100: 0.4974 - 42s/epoch - 28ms/step
Epoch 7/50
1497/1497 - 42s - loss: 2.9030 - accuracy100: 0.5085 - val_loss: 2.9549 - val_accuracy100: 0.4951 - 42s/epoch - 28ms/step
Epoch 8/50
1497/1497 - 41s - loss: 2.8977 - accuracy100: 0.5098 - val_loss: 2.9450 - val_accuracy100: 0.4982 - 41s/epoch - 27ms/step
Epoch 9/50
1497/1497 - 41s - loss: 2.8928 - accuracy100: 0.5107 - val_loss: 2.9488 - val_accuracy100: 0.4970 - 41s/epoch - 27ms/step
Epoch 10/50
1497/1497 - 41s - loss: 2.8883 - accuracy100: 0.5115 - val_loss: 2.9479 - val_accuracy100: 0.4980 - 41s/epoch - 27ms/step
Epoch 11/50
1497/1497 - 40s - loss: 2.8821 - accuracy100: 0.5134 - val_loss: 2.9477 - val_accuracy100: 0.4959 - 40s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 39s - loss: 2.8758 - accuracy100: 0.5153 - val_loss: 2.9464 - val_accuracy100: 0.4979 - 39s/epoch - 26ms/step
Epoch 13/50
1497/1497 - 37s - loss: 2.8712 - accuracy100: 0.5172 - val_loss: 2.9507 - val_accuracy100: 0.4966 - 37s/epoch - 25ms/step
Epoch 14/50
1497/1497 - 41s - loss: 2.8658 - accuracy100: 0.5186 - val_loss: 2.9469 - val_accuracy100: 0.4957 - 41s/epoch - 27ms/step
Epoch 15/50
1497/1497 - 42s - loss: 2.8622 - accuracy100: 0.5191 - val_loss: 2.9490 - val_accuracy100: 0.4952 - 42s/epoch - 28ms/step
Epoch 16/50
1497/1497 - 42s - loss: 2.8559 - accuracy100: 0.5205 - val_loss: 2.9485 - val_accuracy100: 0.4962 - 42s/epoch - 28ms/step
Epoch 17/50
1497/1497 - 42s - loss: 2.8517 - accuracy100: 0.5217 - val_loss: 2.9485 - val_accuracy100: 0.4953 - 42s/epoch - 28ms/step
Epoch 18/50
1497/1497 - 42s - loss: 2.8460 - accuracy100: 0.5226 - val_loss: 2.9567 - val_accuracy100: 0.4935 - 42s/epoch - 28ms/step
testing model: results/EXC/W0/deepVOL_L2/h100
Evaluating performance on  test set...
4693/4693 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9727398
{'0': {'precision': 0.47489374384491784, 'recall': 0.5789164683333684, 'f1-score': 0.5217710093206022, 'support': 379832}, '1': {'precision': 0.49542588423868844, 'recall': 0.47867041688966827, 'f1-score': 0.48690404485011346, 'support': 439085}, '2': {'precision': 0.5535048180297841, 'recall': 0.45453927146687595, 'f1-score': 0.4991640333237576, 'support': 382275}, 'accuracy': 0.5026898281040832, 'macro avg': {'precision': 0.5079414820377969, 'recall': 0.5040420522299709, 'f1-score': 0.5026130291648244, 'support': 1201192}, 'weighted avg': {'precision': 0.5074167736759677, 'recall': 0.5026898281040832, 'f1-score': 0.5018311139136079, 'support': 1201192}}
[[219891  98972  60969]
 [149711 210177  79197]
 [ 93430 115086 173759]]
Evaluating performance on  train set...
1497/1497 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9914565
{'0': {'precision': 0.4948233775707752, 'recall': 0.5525192477893435, 'f1-score': 0.5220821414959239, 'support': 127677}, '1': {'precision': 0.43704392892019284, 'recall': 0.45073036113622306, 'f1-score': 0.44378164612555776, 'support': 126102}, '2': {'precision': 0.524444967159426, 'recall': 0.4480868825848342, 'f1-score': 0.48326830732292914, 'support': 129370}, 'accuracy': 0.48375697183080213, 'macro avg': {'precision': 0.48543742455013134, 'recall': 0.48377883050346693, 'f1-score': 0.483044031648137, 'support': 383149}, 'weighted avg': {'precision': 0.48580871489737143, 'recall': 0.48375697183080213, 'f1-score': 0.48320641744560866, 'support': 383149}}
[[70544 34162 22971]
 [39670 56838 29594]
 [32350 39051 57969]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9815552
{'0': {'precision': 0.5214255967384872, 'recall': 0.5157954077318359, 'f1-score': 0.5185952214858738, 'support': 46121}, '1': {'precision': 0.4511039846658557, 'recall': 0.5195610180644887, 'f1-score': 0.4829185040496414, 'support': 47109}, '2': {'precision': 0.5364937925510612, 'recall': 0.4599274724803124, 'f1-score': 0.49526890416498176, 'support': 46603}, 'accuracy': 0.49844457316942353, 'macro avg': {'precision': 0.503007791318468, 'recall': 0.49842796609221235, 'f1-score': 0.49892754323349897, 'support': 139833}, 'weighted avg': {'precision': 0.5027564864878582, 'recall': 0.49844457316942353, 'f1-score': 0.49880181901428977, 'support': 139833}}
[[23789 14348  7984]
 [12099 24476 10534]
 [ 9735 15434 21434]]
training model: results/EXC/W0/deepVOL_L2/h200
Epoch 1/50
1497/1497 - 40s - loss: 3.2492 - accuracy200: 0.3997 - val_loss: 3.2492 - val_accuracy200: 0.3857 - 40s/epoch - 27ms/step
Epoch 2/50
1497/1497 - 39s - loss: 3.2249 - accuracy200: 0.4085 - val_loss: 3.2357 - val_accuracy200: 0.3962 - 39s/epoch - 26ms/step
Epoch 3/50
1497/1497 - 42s - loss: 3.2098 - accuracy200: 0.4148 - val_loss: 3.2243 - val_accuracy200: 0.4000 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 43s - loss: 3.1978 - accuracy200: 0.4192 - val_loss: 3.2173 - val_accuracy200: 0.4012 - 43s/epoch - 28ms/step
Epoch 5/50
1497/1497 - 42s - loss: 3.1920 - accuracy200: 0.4208 - val_loss: 3.2184 - val_accuracy200: 0.3986 - 42s/epoch - 28ms/step
Epoch 6/50
1497/1497 - 42s - loss: 3.1854 - accuracy200: 0.4256 - val_loss: 3.2285 - val_accuracy200: 0.3981 - 42s/epoch - 28ms/step
Epoch 7/50
1497/1497 - 42s - loss: 3.1828 - accuracy200: 0.4260 - val_loss: 3.2330 - val_accuracy200: 0.3921 - 42s/epoch - 28ms/step
Epoch 8/50
1497/1497 - 42s - loss: 3.1789 - accuracy200: 0.4278 - val_loss: 3.2420 - val_accuracy200: 0.3897 - 42s/epoch - 28ms/step
Epoch 9/50
1497/1497 - 42s - loss: 3.1757 - accuracy200: 0.4292 - val_loss: 3.2516 - val_accuracy200: 0.3867 - 42s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 43s - loss: 3.1706 - accuracy200: 0.4309 - val_loss: 3.2492 - val_accuracy200: 0.3875 - 43s/epoch - 29ms/step
Epoch 11/50
1497/1497 - 41s - loss: 3.1681 - accuracy200: 0.4319 - val_loss: 3.2594 - val_accuracy200: 0.3877 - 41s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 41s - loss: 3.1642 - accuracy200: 0.4332 - val_loss: 3.2742 - val_accuracy200: 0.3875 - 41s/epoch - 27ms/step
Epoch 13/50
1497/1497 - 41s - loss: 3.1572 - accuracy200: 0.4354 - val_loss: 3.2806 - val_accuracy200: 0.3843 - 41s/epoch - 28ms/step
Epoch 14/50
1497/1497 - 42s - loss: 3.1522 - accuracy200: 0.4381 - val_loss: 3.2776 - val_accuracy200: 0.3863 - 42s/epoch - 28ms/step
testing model: results/EXC/W0/deepVOL_L2/h200
Evaluating performance on  test set...
4693/4693 - 55s - 55s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0723573
{'0': {'precision': 0.35500813378654666, 'recall': 0.6403485736794332, 'f1-score': 0.45677886210975754, 'support': 350342}, '1': {'precision': 0.44023199692864584, 'recall': 0.06481548772609819, 'f1-score': 0.11299472806233414, 'support': 495360}, '2': {'precision': 0.3770631517867217, 'recall': 0.5264480013502489, 'f1-score': 0.4394060703107941, 'support': 355490}, 'accuracy': 0.36929566630480387, 'macro avg': {'precision': 0.3907677608339714, 'recall': 0.4105373542519268, 'f1-score': 0.3363932201609619, 'support': 1201192}, 'weighted avg': {'precision': 0.3966807649686995, 'recall': 0.36929566630480387, 'f1-score': 0.30986416204653267, 'support': 1201192}}
[[224341  19758 106243]
 [260315  32107 202938]
 [147276  21067 187147]]
Evaluating performance on  train set...
1497/1497 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0767342
{'0': {'precision': 0.402472977825424, 'recall': 0.6073585424274551, 'f1-score': 0.4841310580546618, 'support': 127335}, '1': {'precision': 0.35101280374202243, 'recall': 0.06964982381072238, 'f1-score': 0.11623556900297317, 'support': 127136}, '2': {'precision': 0.401429734865623, 'recall': 0.5171280249926172, 'f1-score': 0.45199240600048224, 'support': 128678}, 'accuracy': 0.39863342981451083, 'macro avg': {'precision': 0.3849718388110232, 'recall': 0.3980454637435982, 'f1-score': 0.3507863443527057, 'support': 383149}, 'weighted avg': {'precision': 0.38504716408234074, 'recall': 0.39863342981451083, 'f1-score': 0.3512629092010742, 'support': 383149}}
[[77338  8024 41973]
 [61032  8855 57249]
 [53787  8348 66543]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0721841
{'0': {'precision': 0.41300513019695423, 'recall': 0.5533271177988335, 'f1-score': 0.47297798205945585, 'support': 46121}, '1': {'precision': 0.3682335477486393, 'recall': 0.07743855486878524, 'f1-score': 0.12796615998349267, 'support': 48051}, '2': {'precision': 0.39530741716590373, 'recall': 0.5881605746698495, 'f1-score': 0.4728252257962288, 'support': 45661}, 'accuracy': 0.40117139730964796, 'macro avg': {'precision': 0.3921820317038324, 'recall': 0.40630874911248943, 'f1-score': 0.3579231226130591, 'support': 139833}, 'weighted avg': {'precision': 0.3918412090700759, 'recall': 0.40117139730964796, 'f1-score': 0.3543712292449749, 'support': 139833}}
[[25520  3380 17221]
 [20470  3721 23860]
 [15801  3004 26856]]
training model: results/EXC/W0/deepVOL_L2/h300
Epoch 1/50
1497/1497 - 43s - loss: 3.2733 - accuracy300: 0.3838 - val_loss: 3.2767 - val_accuracy300: 0.3795 - 43s/epoch - 29ms/step
Epoch 2/50
1497/1497 - 42s - loss: 3.2388 - accuracy300: 0.3996 - val_loss: 3.2607 - val_accuracy300: 0.3930 - 42s/epoch - 28ms/step
Epoch 3/50
1497/1497 - 42s - loss: 3.2252 - accuracy300: 0.4063 - val_loss: 3.2611 - val_accuracy300: 0.3956 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 42s - loss: 3.2148 - accuracy300: 0.4121 - val_loss: 3.2627 - val_accuracy300: 0.3913 - 42s/epoch - 28ms/step
Epoch 5/50
1497/1497 - 41s - loss: 3.2073 - accuracy300: 0.4164 - val_loss: 3.2625 - val_accuracy300: 0.3938 - 41s/epoch - 27ms/step
Epoch 6/50
1497/1497 - 40s - loss: 3.2006 - accuracy300: 0.4189 - val_loss: 3.2840 - val_accuracy300: 0.3840 - 40s/epoch - 27ms/step
Epoch 7/50
1497/1497 - 43s - loss: 3.1973 - accuracy300: 0.4203 - val_loss: 3.2921 - val_accuracy300: 0.3862 - 43s/epoch - 29ms/step
Epoch 8/50
1497/1497 - 41s - loss: 3.1925 - accuracy300: 0.4236 - val_loss: 3.2975 - val_accuracy300: 0.3862 - 41s/epoch - 27ms/step
Epoch 9/50
1497/1497 - 41s - loss: 3.1866 - accuracy300: 0.4275 - val_loss: 3.3073 - val_accuracy300: 0.3851 - 41s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 37s - loss: 3.1836 - accuracy300: 0.4284 - val_loss: 3.3105 - val_accuracy300: 0.3856 - 37s/epoch - 25ms/step
Epoch 11/50
1497/1497 - 41s - loss: 3.1792 - accuracy300: 0.4295 - val_loss: 3.3276 - val_accuracy300: 0.3822 - 41s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 40s - loss: 3.1750 - accuracy300: 0.4319 - val_loss: 3.3143 - val_accuracy300: 0.3816 - 40s/epoch - 27ms/step
testing model: results/EXC/W0/deepVOL_L2/h300
Evaluating performance on  test set...
4693/4693 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0796046
{'0': {'precision': 0.36147773467361094, 'recall': 0.6673701371503642, 'f1-score': 0.4689506621387155, 'support': 379073}, '1': {'precision': 0.4505612189567292, 'recall': 0.23078899371360326, 'f1-score': 0.30523090297972905, 'support': 432044}, '2': {'precision': 0.4218431399156528, 'recall': 0.302839197590207, 'f1-score': 0.3525700334871394, 'support': 390075}, 'accuracy': 0.3919631499377285, 'macro avg': {'precision': 0.41129403118199764, 'recall': 0.4003327761513915, 'f1-score': 0.3755838662018613, 'support': 1201192}, 'weighted avg': {'precision': 0.4131222846984238, 'recall': 0.3919631499377285, 'f1-score': 0.3722706032077963, 'support': 1201192}}
[[252982  59463  66628]
 [237058  99711  95275]
 [209815  62130 118130]]
Evaluating performance on  train set...
1497/1497 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0867487
{'0': {'precision': 0.3774101857821016, 'recall': 0.6094977442660189, 'f1-score': 0.46616437033998503, 'support': 126788}, '1': {'precision': 0.3884916495972454, 'recall': 0.24447045240674695, 'f1-score': 0.30009610064358305, 'support': 126457}, '2': {'precision': 0.4111378724093264, 'recall': 0.31274633575563493, 'f1-score': 0.3552553340328786, 'support': 129904}, 'accuracy': 0.38841025293032216, 'macro avg': {'precision': 0.39234656926289113, 'recall': 0.38890484414280024, 'f1-score': 0.3738386016721489, 'support': 383149}, 'weighted avg': {'precision': 0.39250272177539575, 'recall': 0.38841025293032216, 'f1-score': 0.3737511769519395, 'support': 383149}}
[[77277 23906 25605]
 [62958 30915 32584]
 [64521 24756 40627]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871503
{'0': {'precision': 0.39696797024952013, 'recall': 0.5488110786325849, 'f1-score': 0.460700456819665, 'support': 48237}, '1': {'precision': 0.3503852180726038, 'recall': 0.24682074278486835, 'f1-score': 0.28962316337682315, 'support': 43485}, '2': {'precision': 0.41354409239526735, 'recall': 0.3654257862027395, 'f1-score': 0.3879987641242938, 'support': 48111}, 'accuracy': 0.39180307938755515, 'macro avg': {'precision': 0.3869657602391305, 'recall': 0.3870192025400643, 'f1-score': 0.379440794773594, 'support': 139833}, 'weighted avg': {'precision': 0.38818494216702776, 'recall': 0.39180307938755515, 'f1-score': 0.3824853914014234, 'support': 139833}}
[[26473 10058 11706]
 [19526 10733 13226]
 [20689  9841 17581]]
training model: results/EXC/W0/deepVOL_L2/h500
Epoch 1/50
1497/1497 - 43s - loss: 3.2874 - accuracy500: 0.3703 - val_loss: 3.3003 - val_accuracy500: 0.3496 - 43s/epoch - 28ms/step
Epoch 2/50
1497/1497 - 41s - loss: 3.2740 - accuracy500: 0.3814 - val_loss: 3.2920 - val_accuracy500: 0.3561 - 41s/epoch - 28ms/step
Epoch 3/50
1497/1497 - 39s - loss: 3.2653 - accuracy500: 0.3906 - val_loss: 3.2974 - val_accuracy500: 0.3651 - 39s/epoch - 26ms/step
Epoch 4/50
1497/1497 - 41s - loss: 3.2641 - accuracy500: 0.3896 - val_loss: 3.3041 - val_accuracy500: 0.3494 - 41s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 40s - loss: 3.2576 - accuracy500: 0.3944 - val_loss: 3.3034 - val_accuracy500: 0.3451 - 40s/epoch - 27ms/step
Epoch 6/50
1497/1497 - 40s - loss: 3.2577 - accuracy500: 0.3939 - val_loss: 3.2988 - val_accuracy500: 0.3519 - 40s/epoch - 27ms/step
Epoch 7/50
1497/1497 - 41s - loss: 3.2445 - accuracy500: 0.4013 - val_loss: 3.2974 - val_accuracy500: 0.3484 - 41s/epoch - 27ms/step
Epoch 8/50
1497/1497 - 42s - loss: 3.2414 - accuracy500: 0.4037 - val_loss: 3.3019 - val_accuracy500: 0.3564 - 42s/epoch - 28ms/step
Epoch 9/50
1497/1497 - 42s - loss: 3.2311 - accuracy500: 0.4094 - val_loss: 3.3149 - val_accuracy500: 0.3607 - 42s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 42s - loss: 3.2309 - accuracy500: 0.4092 - val_loss: 3.2942 - val_accuracy500: 0.3648 - 42s/epoch - 28ms/step
Epoch 11/50
1497/1497 - 41s - loss: 3.2365 - accuracy500: 0.4067 - val_loss: 3.3067 - val_accuracy500: 0.3542 - 41s/epoch - 28ms/step
Epoch 12/50
1497/1497 - 42s - loss: 3.2278 - accuracy500: 0.4117 - val_loss: 3.3153 - val_accuracy500: 0.3575 - 42s/epoch - 28ms/step
testing model: results/EXC/W0/deepVOL_L2/h500
Evaluating performance on  test set...
4693/4693 - 54s - 54s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0733423
{'0': {'precision': 0.1969659688010987, 'recall': 0.5044447523318748, 'f1-score': 0.2833103240543186, 'support': 223747}, '1': {'precision': 0.6122349794199923, 'recall': 0.43762985504709456, 'f1-score': 0.5104129531766535, 'support': 742655}, '2': {'precision': 0.23802721368083532, 'recall': 0.09864559819413092, 'f1-score': 0.13948460375676766, 'support': 234790}, 'accuracy': 0.3838162425324178, 'macro avg': {'precision': 0.3490760539673088, 'recall': 0.3469067351910335, 'f1-score': 0.3110692936625799, 'support': 1201192}, 'weighted avg': {'precision': 0.46173827561506997, 'recall': 0.3838162425324178, 'f1-score': 0.39560716099810916, 'support': 1201192}}
[[112868  97342  13537]
 [357041 325008  60606]
 [103124 108505  23161]]
Evaluating performance on  train set...
1497/1497 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10401
{'0': {'precision': 0.3519473113987569, 'recall': 0.48971706047574465, 'f1-score': 0.4095566084059932, 'support': 126034}, '1': {'precision': 0.33809073164961256, 'recall': 0.4527209510458495, 'f1-score': 0.38709786646169886, 'support': 126261}, '2': {'precision': 0.3985378077449689, 'recall': 0.11789475293074725, 'f1-score': 0.1819618666808207, 'support': 130854}, 'accuracy': 0.35053986830188777, 'macro avg': {'precision': 0.36285861693111277, 'recall': 0.35344425481744707, 'f1-score': 0.32620544718283756, 'support': 383149}, 'weighted avg': {'precision': 0.3632927858569455, 'recall': 0.35053986830188777, 'f1-score': 0.3244269446189697, 'support': 383149}}
[[61721 53723 10590]
 [56408 57161 12692]
 [57241 58186 15427]]
Evaluating performance on  val set...
547/547 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973601
{'0': {'precision': 0.34766677263372764, 'recall': 0.46430406900096083, 'f1-score': 0.3976081132797551, 'support': 44753}, '1': {'precision': 0.36990070204288156, 'recall': 0.4596431939641622, 'f1-score': 0.4099176449973716, 'support': 50896}, '2': {'precision': 0.3635715134942337, 'recall': 0.13842114792685134, 'f1-score': 0.20050486837360262, 'support': 44184}, 'accuracy': 0.35963613739246103, 'macro avg': {'precision': 0.36037966272361427, 'recall': 0.3541228036306581, 'f1-score': 0.3360102088835764, 'support': 139833}, 'weighted avg': {'precision': 0.3607849431756519, 'recall': 0.35963613739246103, 'f1-score': 0.33980842474676476, 'support': 139833}}
[[20779 19399  4575]
 [21371 23394  6131]
 [17617 20451  6116]]
training model: results/EXC/W0/deepVOL_L2/h1000
Epoch 1/50
1497/1497 - 44s - loss: 3.2428 - accuracy1000: 0.4052 - val_loss: 3.3638 - val_accuracy1000: 0.3348 - 44s/epoch - 29ms/step
Epoch 2/50
1497/1497 - 42s - loss: 3.2554 - accuracy1000: 0.3959 - val_loss: 3.3055 - val_accuracy1000: 0.3483 - 42s/epoch - 28ms/step
Epoch 3/50
1497/1497 - 42s - loss: 3.2601 - accuracy1000: 0.3930 - val_loss: 3.3087 - val_accuracy1000: 0.3395 - 42s/epoch - 28ms/step
Epoch 4/50
1497/1497 - 41s - loss: 3.2524 - accuracy1000: 0.4035 - val_loss: 3.3145 - val_accuracy1000: 0.3324 - 41s/epoch - 27ms/step
Epoch 5/50
1497/1497 - 42s - loss: 3.2579 - accuracy1000: 0.3982 - val_loss: 3.3076 - val_accuracy1000: 0.3375 - 42s/epoch - 28ms/step
Epoch 6/50
1497/1497 - 41s - loss: 3.2518 - accuracy1000: 0.4009 - val_loss: 3.3296 - val_accuracy1000: 0.3380 - 41s/epoch - 28ms/step
Epoch 7/50
1497/1497 - 41s - loss: 3.2499 - accuracy1000: 0.4039 - val_loss: 3.3056 - val_accuracy1000: 0.3390 - 41s/epoch - 27ms/step
Epoch 8/50
1497/1497 - 43s - loss: 3.2442 - accuracy1000: 0.4069 - val_loss: 3.3180 - val_accuracy1000: 0.3337 - 43s/epoch - 29ms/step
Epoch 9/50
1497/1497 - 42s - loss: 3.2379 - accuracy1000: 0.4098 - val_loss: 3.3181 - val_accuracy1000: 0.3323 - 42s/epoch - 28ms/step
Epoch 10/50
1497/1497 - 43s - loss: 3.2275 - accuracy1000: 0.4168 - val_loss: 3.3348 - val_accuracy1000: 0.3370 - 43s/epoch - 28ms/step
Epoch 11/50
1497/1497 - 41s - loss: 3.2224 - accuracy1000: 0.4182 - val_loss: 3.3241 - val_accuracy1000: 0.3272 - 41s/epoch - 27ms/step
Epoch 12/50
1497/1497 - 42s - loss: 3.2238 - accuracy1000: 0.4183 - val_loss: 3.3303 - val_accuracy1000: 0.3289 - 42s/epoch - 28ms/step
testing model: results/EXC/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
4693/4693 - 56s - 56s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0816021
{'0': {'precision': 0.2914904415496532, 'recall': 0.005657304588228341, 'f1-score': 0.011099193810733946, 'support': 304562}, '1': {'precision': 0.4966911810697472, 'recall': 0.6159388439296395, 'f1-score': 0.549924745844093, 'support': 580155}, '2': {'precision': 0.303093476798924, 'recall': 0.45572004107749425, 'f1-score': 0.36405722471491764, 'support': 316475}, 'accuracy': 0.41898963696061914, 'macro avg': {'precision': 0.3637583664727748, 'recall': 0.35910539653178736, 'f1-score': 0.30836038812324823, 'support': 1201192}, 'weighted avg': {'precision': 0.393655878562881, 'recall': 0.41898963696061914, 'f1-score': 0.36433558813430167, 'support': 1201192}}
[[  1723 191125 111714]
 [  2913 357340 219902]
 [  1275 170976 144224]]
Evaluating performance on  train set...
1497/1497 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005975
{'0': {'precision': 0.3380829015544041, 'recall': 0.006217493151228808, 'f1-score': 0.012210431107749647, 'support': 125935}, '1': {'precision': 0.33834833022901967, 'recall': 0.6115119283744379, 'f1-score': 0.4356515350685834, 'support': 126547}, '2': {'precision': 0.3587060130555683, 'recall': 0.4175958734799146, 'f1-score': 0.3859172660598474, 'support': 130667}, 'accuracy': 0.34642919595248844, 'macro avg': {'precision': 0.34504574827966406, 'recall': 0.3451084316685271, 'f1-score': 0.2779264107453935, 'support': 383149}, 'weighted avg': {'precision': 0.3452037587483657, 'recall': 0.34642919595248844, 'f1-score': 0.2795120615064128, 'support': 383149}}
[[  783 75996 49156]
 [  765 77385 48397]
 [  768 75333 54566]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009574
{'0': {'precision': 0.37777777777777777, 'recall': 0.0043484748363992924, 'f1-score': 0.008597981160305987, 'support': 46913}, '1': {'precision': 0.3463535348634092, 'recall': 0.6102941176470589, 'f1-score': 0.4419130165609039, 'support': 46784}, '2': {'precision': 0.3515837979492411, 'recall': 0.4332842032252471, 'f1-score': 0.38818172108784094, 'support': 46136}, 'accuracy': 0.34860154613002653, 'macro avg': {'precision': 0.3585717035301427, 'recall': 0.34930893190290174, 'f1-score': 0.27956423960301696, 'support': 139833}, 'weighted avg': {'precision': 0.3586218043389244, 'recall': 0.34860154613002653, 'f1-score': 0.2788109211778865, 'support': 139833}}
[[  204 27870 18839]
 [  204 28552 18028]
 [  132 26014 19990]]
training model: results/EXC/W0/deepVOL_L3/h10
Epoch 1/50
1497/1497 - 57s - loss: 2.6897 - accuracy10: 0.5304 - val_loss: 2.2970 - val_accuracy10: 0.6597 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 53s - loss: 2.3301 - accuracy10: 0.6204 - val_loss: 2.2188 - val_accuracy10: 0.6637 - 53s/epoch - 35ms/step
Epoch 3/50
1497/1497 - 55s - loss: 2.2444 - accuracy10: 0.6416 - val_loss: 2.1671 - val_accuracy10: 0.6878 - 55s/epoch - 37ms/step
Epoch 4/50
1497/1497 - 54s - loss: 2.2073 - accuracy10: 0.6465 - val_loss: 2.1202 - val_accuracy10: 0.6904 - 54s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 55s - loss: 2.1749 - accuracy10: 0.6518 - val_loss: 2.0984 - val_accuracy10: 0.6879 - 55s/epoch - 37ms/step
Epoch 6/50
1497/1497 - 54s - loss: 2.1501 - accuracy10: 0.6549 - val_loss: 2.0747 - val_accuracy10: 0.6992 - 54s/epoch - 36ms/step
Epoch 7/50
1497/1497 - 54s - loss: 2.1301 - accuracy10: 0.6563 - val_loss: 2.0711 - val_accuracy10: 0.7053 - 54s/epoch - 36ms/step
Epoch 8/50
1497/1497 - 54s - loss: 2.1177 - accuracy10: 0.6568 - val_loss: 2.0588 - val_accuracy10: 0.6912 - 54s/epoch - 36ms/step
Epoch 9/50
1497/1497 - 54s - loss: 2.1020 - accuracy10: 0.6585 - val_loss: 2.0375 - val_accuracy10: 0.7047 - 54s/epoch - 36ms/step
Epoch 10/50
1497/1497 - 54s - loss: 2.0928 - accuracy10: 0.6596 - val_loss: 2.0369 - val_accuracy10: 0.6962 - 54s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 54s - loss: 2.0811 - accuracy10: 0.6599 - val_loss: 2.0329 - val_accuracy10: 0.6904 - 54s/epoch - 36ms/step
Epoch 12/50
1497/1497 - 53s - loss: 2.0729 - accuracy10: 0.6607 - val_loss: 2.0336 - val_accuracy10: 0.6944 - 53s/epoch - 35ms/step
Epoch 13/50
1497/1497 - 54s - loss: 2.0653 - accuracy10: 0.6609 - val_loss: 2.0199 - val_accuracy10: 0.6993 - 54s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 54s - loss: 2.0586 - accuracy10: 0.6614 - val_loss: 2.0118 - val_accuracy10: 0.6925 - 54s/epoch - 36ms/step
Epoch 15/50
1497/1497 - 53s - loss: 2.0509 - accuracy10: 0.6623 - val_loss: 2.0132 - val_accuracy10: 0.6836 - 53s/epoch - 35ms/step
Epoch 16/50
1497/1497 - 53s - loss: 2.0471 - accuracy10: 0.6624 - val_loss: 2.0110 - val_accuracy10: 0.6824 - 53s/epoch - 36ms/step
Epoch 17/50
1497/1497 - 54s - loss: 2.0390 - accuracy10: 0.6639 - val_loss: 2.0108 - val_accuracy10: 0.6820 - 54s/epoch - 36ms/step
Epoch 18/50
1497/1497 - 53s - loss: 2.0348 - accuracy10: 0.6640 - val_loss: 2.0015 - val_accuracy10: 0.6850 - 53s/epoch - 36ms/step
Epoch 19/50
1497/1497 - 54s - loss: 2.0290 - accuracy10: 0.6639 - val_loss: 1.9943 - val_accuracy10: 0.6719 - 54s/epoch - 36ms/step
Epoch 20/50
1497/1497 - 57s - loss: 2.0238 - accuracy10: 0.6644 - val_loss: 1.9977 - val_accuracy10: 0.6698 - 57s/epoch - 38ms/step
Epoch 21/50
1497/1497 - 53s - loss: 2.0173 - accuracy10: 0.6644 - val_loss: 2.0079 - val_accuracy10: 0.6582 - 53s/epoch - 35ms/step
Epoch 22/50
1497/1497 - 54s - loss: 2.0132 - accuracy10: 0.6655 - val_loss: 2.0009 - val_accuracy10: 0.6715 - 54s/epoch - 36ms/step
Epoch 23/50
1497/1497 - 55s - loss: 2.0082 - accuracy10: 0.6661 - val_loss: 2.0005 - val_accuracy10: 0.6620 - 55s/epoch - 37ms/step
Epoch 24/50
1497/1497 - 53s - loss: 2.0039 - accuracy10: 0.6663 - val_loss: 2.0022 - val_accuracy10: 0.6605 - 53s/epoch - 36ms/step
Epoch 25/50
1497/1497 - 53s - loss: 1.9996 - accuracy10: 0.6668 - val_loss: 2.0049 - val_accuracy10: 0.6651 - 53s/epoch - 35ms/step
Epoch 26/50
1497/1497 - 54s - loss: 1.9932 - accuracy10: 0.6676 - val_loss: 2.0039 - val_accuracy10: 0.6747 - 54s/epoch - 36ms/step
Epoch 27/50
1497/1497 - 53s - loss: 1.9902 - accuracy10: 0.6671 - val_loss: 2.0049 - val_accuracy10: 0.6631 - 53s/epoch - 35ms/step
Epoch 28/50
1497/1497 - 54s - loss: 1.9867 - accuracy10: 0.6676 - val_loss: 2.0029 - val_accuracy10: 0.6687 - 54s/epoch - 36ms/step
Epoch 29/50
1497/1497 - 53s - loss: 1.9800 - accuracy10: 0.6687 - val_loss: 2.0229 - val_accuracy10: 0.6644 - 53s/epoch - 35ms/step
testing model: results/EXC/W0/deepVOL_L3/h10
Evaluating performance on  test set...
4693/4693 - 74s - 74s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70167685
{'0': {'precision': 0.34813723714384337, 'recall': 0.7446562764993129, 'f1-score': 0.47445848732763696, 'support': 136796}, '1': {'precision': 0.9434666412434417, 'recall': 0.6627739418240896, 'f1-score': 0.7785945784065154, 'support': 925744}, '2': {'precision': 0.3679592666447254, 'recall': 0.6853922049447537, 'f1-score': 0.4788457032578599, 'support': 138652}, 'accuracy': 0.6747097882769783, 'macro avg': {'precision': 0.5531877150106701, 'recall': 0.6976074744227186, 'f1-score': 0.5772995896640041, 'support': 1201192}, 'weighted avg': {'precision': 0.8092383666078549, 'recall': 0.6747097882769783, 'f1-score': 0.7093588677521506, 'support': 1201192}}
[[101866  16579  18351]
 [167302 613559 144883]
 [ 23435  20186  95031]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73188406
{'0': {'precision': 0.3803204996596177, 'recall': 0.713625304136253, 'f1-score': 0.49619703516773217, 'support': 49320}, '1': {'precision': 0.9282394554465626, 'recall': 0.6382226621184538, 'f1-score': 0.7563840193714744, 'support': 282895}, '2': {'precision': 0.36698994776166, 'recall': 0.6924058585620607, 'f1-score': 0.479718700691006, 'support': 50934}, 'accuracy': 0.6551315545649342, 'macro avg': {'precision': 0.5585166342892801, 'recall': 0.6814179416055891, 'f1-score': 0.5774332517434042, 'support': 383149}, 'weighted avg': {'precision': 0.7830999788360665, 'recall': 0.6551315545649342, 'f1-score': 0.6861134630014994, 'support': 383149}}
[[ 35196   6707   7417]
 [ 48931 180550  53414]
 [  8416   7251  35267]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7002869
{'0': {'precision': 0.3750867891182226, 'recall': 0.7099336957171017, 'f1-score': 0.49084188572490545, 'support': 16741}, '1': {'precision': 0.9333690627721578, 'recall': 0.6599717677375347, 'f1-score': 0.7732146424845162, 'support': 105553}, '2': {'precision': 0.3717474337550728, 'recall': 0.71030275386282, 'f1-score': 0.48806095864919385, 'support': 17539}, 'accuracy': 0.672266203256742, 'macro avg': {'precision': 0.5600677618818177, 'recall': 0.693402739105819, 'f1-score': 0.5840391622862051, 'support': 139833}, 'weighted avg': {'precision': 0.7960875534390878, 'recall': 0.672266203256742, 'f1-score': 0.7036422755775603, 'support': 139833}}
[[11885  2442  2414]
 [17251 69662 18640]
 [ 2550  2531 12458]]
training model: results/EXC/W0/deepVOL_L3/h20
Epoch 1/50
1497/1497 - 57s - loss: 2.7414 - accuracy20: 0.5440 - val_loss: 2.4134 - val_accuracy20: 0.6508 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 60s - loss: 2.4251 - accuracy20: 0.6219 - val_loss: 2.3384 - val_accuracy20: 0.6713 - 60s/epoch - 40ms/step
Epoch 3/50
1497/1497 - 56s - loss: 2.3484 - accuracy20: 0.6325 - val_loss: 2.3008 - val_accuracy20: 0.6641 - 56s/epoch - 37ms/step
Epoch 4/50
1497/1497 - 54s - loss: 2.3101 - accuracy20: 0.6362 - val_loss: 2.2522 - val_accuracy20: 0.6723 - 54s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 54s - loss: 2.2883 - accuracy20: 0.6395 - val_loss: 2.2323 - val_accuracy20: 0.6708 - 54s/epoch - 36ms/step
Epoch 6/50
1497/1497 - 54s - loss: 2.2698 - accuracy20: 0.6415 - val_loss: 2.2275 - val_accuracy20: 0.6752 - 54s/epoch - 36ms/step
Epoch 7/50
1497/1497 - 56s - loss: 2.2552 - accuracy20: 0.6431 - val_loss: 2.2127 - val_accuracy20: 0.6654 - 56s/epoch - 37ms/step
Epoch 8/50
1497/1497 - 53s - loss: 2.2424 - accuracy20: 0.6440 - val_loss: 2.1871 - val_accuracy20: 0.6656 - 53s/epoch - 35ms/step
Epoch 9/50
1497/1497 - 53s - loss: 2.2319 - accuracy20: 0.6453 - val_loss: 2.1905 - val_accuracy20: 0.6616 - 53s/epoch - 35ms/step
Epoch 10/50
1497/1497 - 54s - loss: 2.2209 - accuracy20: 0.6464 - val_loss: 2.1732 - val_accuracy20: 0.6664 - 54s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 54s - loss: 2.2098 - accuracy20: 0.6483 - val_loss: 2.1720 - val_accuracy20: 0.6557 - 54s/epoch - 36ms/step
Epoch 12/50
1497/1497 - 53s - loss: 2.2007 - accuracy20: 0.6481 - val_loss: 2.1619 - val_accuracy20: 0.6608 - 53s/epoch - 35ms/step
Epoch 13/50
1497/1497 - 54s - loss: 2.1914 - accuracy20: 0.6493 - val_loss: 2.1508 - val_accuracy20: 0.6592 - 54s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 56s - loss: 2.1822 - accuracy20: 0.6501 - val_loss: 2.1472 - val_accuracy20: 0.6550 - 56s/epoch - 38ms/step
Epoch 15/50
1497/1497 - 57s - loss: 2.1757 - accuracy20: 0.6504 - val_loss: 2.1553 - val_accuracy20: 0.6606 - 57s/epoch - 38ms/step
Epoch 16/50
1497/1497 - 54s - loss: 2.1685 - accuracy20: 0.6516 - val_loss: 2.1573 - val_accuracy20: 0.6643 - 54s/epoch - 36ms/step
Epoch 17/50
1497/1497 - 53s - loss: 2.1585 - accuracy20: 0.6523 - val_loss: 2.1602 - val_accuracy20: 0.6685 - 53s/epoch - 36ms/step
Epoch 18/50
1497/1497 - 55s - loss: 2.1546 - accuracy20: 0.6524 - val_loss: 2.1518 - val_accuracy20: 0.6687 - 55s/epoch - 37ms/step
Epoch 19/50
1497/1497 - 56s - loss: 2.1489 - accuracy20: 0.6530 - val_loss: 2.1439 - val_accuracy20: 0.6631 - 56s/epoch - 37ms/step
Epoch 20/50
1497/1497 - 54s - loss: 2.1447 - accuracy20: 0.6534 - val_loss: 2.1523 - val_accuracy20: 0.6569 - 54s/epoch - 36ms/step
Epoch 21/50
1497/1497 - 54s - loss: 2.1387 - accuracy20: 0.6542 - val_loss: 2.1392 - val_accuracy20: 0.6713 - 54s/epoch - 36ms/step
Epoch 22/50
1497/1497 - 53s - loss: 2.1346 - accuracy20: 0.6547 - val_loss: 2.1506 - val_accuracy20: 0.6637 - 53s/epoch - 35ms/step
Epoch 23/50
1497/1497 - 56s - loss: 2.1288 - accuracy20: 0.6552 - val_loss: 2.1575 - val_accuracy20: 0.6665 - 56s/epoch - 37ms/step
Epoch 24/50
1497/1497 - 56s - loss: 2.1236 - accuracy20: 0.6546 - val_loss: 2.1513 - val_accuracy20: 0.6681 - 56s/epoch - 38ms/step
Epoch 25/50
1497/1497 - 55s - loss: 2.1189 - accuracy20: 0.6559 - val_loss: 2.1559 - val_accuracy20: 0.6653 - 55s/epoch - 37ms/step
Epoch 26/50
1497/1497 - 55s - loss: 2.1144 - accuracy20: 0.6564 - val_loss: 2.1776 - val_accuracy20: 0.6747 - 55s/epoch - 36ms/step
Epoch 27/50
1497/1497 - 56s - loss: 2.1106 - accuracy20: 0.6577 - val_loss: 2.1528 - val_accuracy20: 0.6644 - 56s/epoch - 37ms/step
Epoch 28/50
1497/1497 - 54s - loss: 2.1063 - accuracy20: 0.6566 - val_loss: 2.1716 - val_accuracy20: 0.6666 - 54s/epoch - 36ms/step
Epoch 29/50
1497/1497 - 56s - loss: 2.1027 - accuracy20: 0.6578 - val_loss: 2.1702 - val_accuracy20: 0.6724 - 56s/epoch - 38ms/step
Epoch 30/50
1497/1497 - 56s - loss: 2.0975 - accuracy20: 0.6587 - val_loss: 2.1740 - val_accuracy20: 0.6726 - 56s/epoch - 37ms/step
Epoch 31/50
1497/1497 - 55s - loss: 2.0940 - accuracy20: 0.6582 - val_loss: 2.1751 - val_accuracy20: 0.6760 - 55s/epoch - 37ms/step
testing model: results/EXC/W0/deepVOL_L3/h20
Evaluating performance on  test set...
4693/4693 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70614785
{'0': {'precision': 0.42552517995100186, 'recall': 0.6778831254103742, 'f1-score': 0.5228460534951747, 'support': 190375}, '1': {'precision': 0.886971499452098, 'recall': 0.6741593890862551, 'f1-score': 0.7660602561869758, 'support': 818839}, '2': {'precision': 0.4596811363826073, 'recall': 0.6597683067851524, 'f1-score': 0.5418432192060644, 'support': 191978}, 'accuracy': 0.6724495334634263, 'macro avg': {'precision': 0.5907259385952357, 'recall': 0.6706036070939273, 'f1-score': 0.6102498429627383, 'support': 1201192}, 'weighted avg': {'precision': 0.7455468209690779, 'recall': 0.6724495334634263, 'f1-score': 0.6916786068228666, 'support': 1201192}}
[[129052  32452  28871]
 [146802 552028 120009]
 [ 27423  37894 126661]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73299485
{'0': {'precision': 0.46855169531602275, 'recall': 0.6322569155882702, 'f1-score': 0.5382317084725636, 'support': 67384}, '1': {'precision': 0.8608916913237254, 'recall': 0.6564722847837711, 'f1-score': 0.7449122879593304, 'support': 246868}, '2': {'precision': 0.4445961932424764, 'recall': 0.6709435824491632, 'f1-score': 0.5348065019957192, 'support': 68897}, 'accuracy': 0.6548157505304725, 'macro avg': {'precision': 0.5913465266274082, 'recall': 0.6532242609404014, 'f1-score': 0.605983499475871, 'support': 383149}, 'weighted avg': {'precision': 0.7170339513262654, 'recall': 0.6548157505304725, 'f1-score': 0.6707828435299538, 'support': 383149}}
[[ 42604  12535  12245]
 [ 39304 162062  45502]
 [  9019  13652  46226]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70382863
{'0': {'precision': 0.46506016545500123, 'recall': 0.6430242634315425, 'f1-score': 0.5397512365434972, 'support': 23080}, '1': {'precision': 0.8682909994478188, 'recall': 0.6782221455451203, 'f1-score': 0.7615766946561652, 'support': 92741}, '2': {'precision': 0.45720244637975255, 'recall': 0.6755788772280527, 'f1-score': 0.545341468744222, 'support': 24012}, 'accuracy': 0.6719586935844901, 'macro avg': {'precision': 0.5968512037608575, 'recall': 0.6656084287349051, 'f1-score': 0.6155564666479615, 'support': 139833}, 'weighted avg': {'precision': 0.7311443603510059, 'recall': 0.6719586935844901, 'f1-score': 0.6878317859590911, 'support': 139833}}
[[14841  4601  3638]
 [14221 62899 15621]
 [ 2850  4940 16222]]
training model: results/EXC/W0/deepVOL_L3/h30
Epoch 1/50
1497/1497 - 56s - loss: 2.8325 - accuracy30: 0.5237 - val_loss: 2.5700 - val_accuracy30: 0.5963 - 56s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 56s - loss: 2.5530 - accuracy30: 0.6007 - val_loss: 2.5321 - val_accuracy30: 0.6385 - 56s/epoch - 38ms/step
Epoch 3/50
1497/1497 - 53s - loss: 2.4754 - accuracy30: 0.6110 - val_loss: 2.4554 - val_accuracy30: 0.6426 - 53s/epoch - 36ms/step
Epoch 4/50
1497/1497 - 53s - loss: 2.4336 - accuracy30: 0.6169 - val_loss: 2.4043 - val_accuracy30: 0.6248 - 53s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 54s - loss: 2.4109 - accuracy30: 0.6194 - val_loss: 2.3990 - val_accuracy30: 0.6359 - 54s/epoch - 36ms/step
Epoch 6/50
1497/1497 - 53s - loss: 2.3914 - accuracy30: 0.6211 - val_loss: 2.3784 - val_accuracy30: 0.6411 - 53s/epoch - 35ms/step
Epoch 7/50
1497/1497 - 53s - loss: 2.3753 - accuracy30: 0.6224 - val_loss: 2.3674 - val_accuracy30: 0.6314 - 53s/epoch - 36ms/step
Epoch 8/50
1497/1497 - 54s - loss: 2.3591 - accuracy30: 0.6240 - val_loss: 2.3446 - val_accuracy30: 0.6389 - 54s/epoch - 36ms/step
Epoch 9/50
1497/1497 - 53s - loss: 2.3437 - accuracy30: 0.6248 - val_loss: 2.3214 - val_accuracy30: 0.6388 - 53s/epoch - 35ms/step
Epoch 10/50
1497/1497 - 54s - loss: 2.3317 - accuracy30: 0.6259 - val_loss: 2.3287 - val_accuracy30: 0.6324 - 54s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 53s - loss: 2.3210 - accuracy30: 0.6269 - val_loss: 2.3134 - val_accuracy30: 0.6335 - 53s/epoch - 35ms/step
Epoch 12/50
1497/1497 - 54s - loss: 2.3105 - accuracy30: 0.6274 - val_loss: 2.3069 - val_accuracy30: 0.6439 - 54s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 53s - loss: 2.3046 - accuracy30: 0.6288 - val_loss: 2.2883 - val_accuracy30: 0.6466 - 53s/epoch - 35ms/step
Epoch 14/50
1497/1497 - 53s - loss: 2.2964 - accuracy30: 0.6303 - val_loss: 2.2883 - val_accuracy30: 0.6442 - 53s/epoch - 36ms/step
Epoch 15/50
1497/1497 - 53s - loss: 2.2910 - accuracy30: 0.6305 - val_loss: 2.2809 - val_accuracy30: 0.6482 - 53s/epoch - 35ms/step
Epoch 16/50
1497/1497 - 54s - loss: 2.2837 - accuracy30: 0.6318 - val_loss: 2.2949 - val_accuracy30: 0.6496 - 54s/epoch - 36ms/step
Epoch 17/50
1497/1497 - 53s - loss: 2.2781 - accuracy30: 0.6322 - val_loss: 2.2874 - val_accuracy30: 0.6504 - 53s/epoch - 35ms/step
Epoch 18/50
1497/1497 - 53s - loss: 2.2737 - accuracy30: 0.6330 - val_loss: 2.2904 - val_accuracy30: 0.6502 - 53s/epoch - 35ms/step
Epoch 19/50
1497/1497 - 53s - loss: 2.2694 - accuracy30: 0.6338 - val_loss: 2.2939 - val_accuracy30: 0.6495 - 53s/epoch - 35ms/step
Epoch 20/50
1497/1497 - 54s - loss: 2.2653 - accuracy30: 0.6337 - val_loss: 2.2863 - val_accuracy30: 0.6545 - 54s/epoch - 36ms/step
Epoch 21/50
1497/1497 - 53s - loss: 2.2600 - accuracy30: 0.6350 - val_loss: 2.2817 - val_accuracy30: 0.6524 - 53s/epoch - 35ms/step
Epoch 22/50
1497/1497 - 54s - loss: 2.2553 - accuracy30: 0.6355 - val_loss: 2.2931 - val_accuracy30: 0.6497 - 54s/epoch - 36ms/step
Epoch 23/50
1497/1497 - 53s - loss: 2.2520 - accuracy30: 0.6350 - val_loss: 2.2930 - val_accuracy30: 0.6543 - 53s/epoch - 36ms/step
Epoch 24/50
1497/1497 - 54s - loss: 2.2464 - accuracy30: 0.6355 - val_loss: 2.2969 - val_accuracy30: 0.6540 - 54s/epoch - 36ms/step
Epoch 25/50
1497/1497 - 53s - loss: 2.2446 - accuracy30: 0.6359 - val_loss: 2.2980 - val_accuracy30: 0.6535 - 53s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h30
Evaluating performance on  test set...
4693/4693 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7375251
{'0': {'precision': 0.46036542597961283, 'recall': 0.6886081482776709, 'f1-score': 0.5518166659660628, 'support': 228760}, '1': {'precision': 0.8259642085265391, 'recall': 0.6720716571937946, 'f1-score': 0.741113276537298, 'support': 742647}, '2': {'precision': 0.5193532178159521, 'recall': 0.5757512457297038, 'f1-score': 0.5460999787419792, 'support': 229785}, 'accuracy': 0.65679508355034, 'macro avg': {'precision': 0.601894284107368, 'recall': 0.6454770170670564, 'f1-score': 0.6130099737484467, 'support': 1201192}, 'weighted avg': {'precision': 0.6976841467247064, 'recall': 0.65679508355034, 'f1-score': 0.6677572907596929, 'support': 1201192}}
[[157526  46907  24327]
 [145423 499112  98112]
 [ 39227  58259 132299]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.778109
{'0': {'precision': 0.49249589397972476, 'recall': 0.6527548416153731, 'f1-score': 0.561412569805352, 'support': 79932}, '1': {'precision': 0.7906468384860513, 'recall': 0.6378479065844606, 'f1-score': 0.7060753041146911, 'support': 221719}, '2': {'precision': 0.4831650345241364, 'recall': 0.58299590173992, 'f1-score': 0.5284065949342452, 'support': 81498}, 'accuracy': 0.6292904327037262, 'macro avg': {'precision': 0.5887692556633041, 'recall': 0.6245328833132512, 'f1-score': 0.5986314896180961, 'support': 383149}, 'weighted avg': {'precision': 0.6630438606482706, 'recall': 0.6292904327037262, 'f1-score': 0.6381048118529284, 'support': 383149}}
[[ 52176  17381  10375]
 [ 39847 141423  40449]
 [ 13919  20066  47513]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75075054
{'0': {'precision': 0.4973908190316729, 'recall': 0.6459141148758833, 'f1-score': 0.5620053602396342, 'support': 27595}, '1': {'precision': 0.7997787292738298, 'recall': 0.6657775757720737, 'f1-score': 0.7266520456384951, 'support': 83606}, '2': {'precision': 0.5023255813953489, 'recall': 0.6035205364626991, 'f1-score': 0.5482929305749461, 'support': 28632}, 'accuracy': 0.6491100097974012, 'macro avg': {'precision': 0.5998317099002838, 'recall': 0.6384040757035522, 'f1-score': 0.6123167788176919, 'support': 139833}, 'weighted avg': {'precision': 0.679198659381966, 'recall': 0.6491100097974012, 'f1-score': 0.657639699010152, 'support': 139833}}
[[17824  6527  3244]
 [14067 55663 13876]
 [ 3944  7408 17280]]
training model: results/EXC/W0/deepVOL_L3/h50
Epoch 1/50
1497/1497 - 57s - loss: 3.0396 - accuracy50: 0.4651 - val_loss: 2.8022 - val_accuracy50: 0.5744 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 55s - loss: 2.7674 - accuracy50: 0.5556 - val_loss: 2.6969 - val_accuracy50: 0.5756 - 55s/epoch - 36ms/step
Epoch 3/50
1497/1497 - 54s - loss: 2.6895 - accuracy50: 0.5681 - val_loss: 2.6564 - val_accuracy50: 0.5775 - 54s/epoch - 36ms/step
Epoch 4/50
1497/1497 - 54s - loss: 2.6407 - accuracy50: 0.5766 - val_loss: 2.6312 - val_accuracy50: 0.5809 - 54s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 53s - loss: 2.6130 - accuracy50: 0.5806 - val_loss: 2.6049 - val_accuracy50: 0.5767 - 53s/epoch - 36ms/step
Epoch 6/50
1497/1497 - 55s - loss: 2.5931 - accuracy50: 0.5826 - val_loss: 2.5818 - val_accuracy50: 0.5890 - 55s/epoch - 37ms/step
Epoch 7/50
1497/1497 - 53s - loss: 2.5750 - accuracy50: 0.5853 - val_loss: 2.5708 - val_accuracy50: 0.5886 - 53s/epoch - 36ms/step
Epoch 8/50
1497/1497 - 54s - loss: 2.5618 - accuracy50: 0.5874 - val_loss: 2.5501 - val_accuracy50: 0.5981 - 54s/epoch - 36ms/step
Epoch 9/50
1497/1497 - 55s - loss: 2.5481 - accuracy50: 0.5900 - val_loss: 2.5442 - val_accuracy50: 0.5970 - 55s/epoch - 36ms/step
Epoch 10/50
1497/1497 - 53s - loss: 2.5398 - accuracy50: 0.5911 - val_loss: 2.5310 - val_accuracy50: 0.5936 - 53s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 54s - loss: 2.5310 - accuracy50: 0.5916 - val_loss: 2.5243 - val_accuracy50: 0.5939 - 54s/epoch - 36ms/step
Epoch 12/50
1497/1497 - 54s - loss: 2.5234 - accuracy50: 0.5933 - val_loss: 2.5228 - val_accuracy50: 0.5961 - 54s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 53s - loss: 2.5164 - accuracy50: 0.5936 - val_loss: 2.5271 - val_accuracy50: 0.6045 - 53s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 53s - loss: 2.5091 - accuracy50: 0.5944 - val_loss: 2.5170 - val_accuracy50: 0.6003 - 53s/epoch - 35ms/step
Epoch 15/50
1497/1497 - 54s - loss: 2.5041 - accuracy50: 0.5956 - val_loss: 2.5199 - val_accuracy50: 0.5887 - 54s/epoch - 36ms/step
Epoch 16/50
1497/1497 - 55s - loss: 2.5003 - accuracy50: 0.5964 - val_loss: 2.5244 - val_accuracy50: 0.5959 - 55s/epoch - 37ms/step
Epoch 17/50
1497/1497 - 53s - loss: 2.4957 - accuracy50: 0.5972 - val_loss: 2.5216 - val_accuracy50: 0.5974 - 53s/epoch - 35ms/step
Epoch 18/50
1497/1497 - 53s - loss: 2.4888 - accuracy50: 0.5983 - val_loss: 2.5246 - val_accuracy50: 0.6012 - 53s/epoch - 36ms/step
Epoch 19/50
1497/1497 - 53s - loss: 2.4846 - accuracy50: 0.5995 - val_loss: 2.5183 - val_accuracy50: 0.5931 - 53s/epoch - 36ms/step
Epoch 20/50
1497/1497 - 54s - loss: 2.4801 - accuracy50: 0.5996 - val_loss: 2.5213 - val_accuracy50: 0.5962 - 54s/epoch - 36ms/step
Epoch 21/50
1497/1497 - 53s - loss: 2.4753 - accuracy50: 0.6004 - val_loss: 2.5229 - val_accuracy50: 0.5987 - 53s/epoch - 35ms/step
Epoch 22/50
1497/1497 - 53s - loss: 2.4694 - accuracy50: 0.6014 - val_loss: 2.5232 - val_accuracy50: 0.5925 - 53s/epoch - 35ms/step
Epoch 23/50
1497/1497 - 54s - loss: 2.4668 - accuracy50: 0.6017 - val_loss: 2.5246 - val_accuracy50: 0.5905 - 54s/epoch - 36ms/step
Epoch 24/50
1497/1497 - 54s - loss: 2.4630 - accuracy50: 0.6024 - val_loss: 2.5242 - val_accuracy50: 0.5888 - 54s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h50
Evaluating performance on  test set...
4693/4693 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8274939
{'0': {'precision': 0.49646312183204394, 'recall': 0.6179434391591722, 'f1-score': 0.5505820580376328, 'support': 286099}, '1': {'precision': 0.7229822763658026, 'recall': 0.6150856009919579, 'f1-score': 0.6646837510861113, 'support': 627446}, '2': {'precision': 0.5311359547674119, 'recall': 0.5747739416715627, 'f1-score': 0.5520939947606303, 'support': 287647}, 'accuracy': 0.6061129278250271, 'macro avg': {'precision': 0.5835271176550861, 'recall': 0.6026009939408976, 'f1-score': 0.5891199346281247, 'support': 1201192}, 'weighted avg': {'precision': 0.6230890682344081, 'recall': 0.6061129278250271, 'f1-score': 0.6105454568606816, 'support': 1201192}}
[[176793  67705  41601]
 [137166 385933 104347]
 [ 42146  80169 165332]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8535114
{'0': {'precision': 0.5345210957061176, 'recall': 0.5786572538231248, 'f1-score': 0.5557142024593508, 'support': 98872}, '1': {'precision': 0.6682632436057093, 'recall': 0.6075100556804389, 'f1-score': 0.6364400956804114, 'support': 183727}, '2': {'precision': 0.5147081740597127, 'recall': 0.5584186971655892, 'f1-score': 0.5356732287408354, 'support': 100550}, 'accuracy': 0.587181488141689, 'macro avg': {'precision': 0.5724975044571798, 'recall': 0.5815286688897178, 'f1-score': 0.5759425089601992, 'support': 383149}, 'weighted avg': {'precision': 0.5934534022907683, 'recall': 0.587181488141689, 'f1-score': 0.5891643909667698, 'support': 383149}}
[[ 57213  26093  15566]
 [ 34737 111616  37374]
 [ 15086  29315  56149]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83831877
{'0': {'precision': 0.5392524131142162, 'recall': 0.5679357216910494, 'f1-score': 0.5532225261238516, 'support': 34724}, '1': {'precision': 0.6742069562261469, 'recall': 0.6277008947837845, 'f1-score': 0.6501232930799431, 'support': 69514}, '2': {'precision': 0.5261915263471967, 'recall': 0.569771035257761, 'f1-score': 0.5471148398931722, 'support': 35595}, 'accuracy': 0.5981134639176732, 'macro avg': {'precision': 0.5798836318958532, 'recall': 0.5884692172441983, 'f1-score': 0.5834868863656556, 'support': 139833}, 'weighted avg': {'precision': 0.6030165306359077, 'recall': 0.5981134639176732, 'f1-score': 0.5998392533828298, 'support': 139833}}
[[19721 10027  4976]
 [12594 43634 13286]
 [ 4256 11058 20281]]
training model: results/EXC/W0/deepVOL_L3/h100
Epoch 1/50
1497/1497 - 57s - loss: 3.1806 - accuracy100: 0.4347 - val_loss: 3.1822 - val_accuracy100: 0.4314 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 59s - loss: 3.0952 - accuracy100: 0.4654 - val_loss: 3.1016 - val_accuracy100: 0.4652 - 59s/epoch - 40ms/step
Epoch 3/50
1497/1497 - 56s - loss: 2.9970 - accuracy100: 0.4899 - val_loss: 3.0016 - val_accuracy100: 0.4872 - 56s/epoch - 37ms/step
Epoch 4/50
1497/1497 - 59s - loss: 2.9443 - accuracy100: 0.4987 - val_loss: 2.9919 - val_accuracy100: 0.4908 - 59s/epoch - 39ms/step
Epoch 5/50
1497/1497 - 60s - loss: 2.9243 - accuracy100: 0.5031 - val_loss: 2.9774 - val_accuracy100: 0.4904 - 60s/epoch - 40ms/step
Epoch 6/50
1497/1497 - 58s - loss: 2.9132 - accuracy100: 0.5052 - val_loss: 2.9655 - val_accuracy100: 0.4937 - 58s/epoch - 38ms/step
Epoch 7/50
1497/1497 - 60s - loss: 2.9028 - accuracy100: 0.5081 - val_loss: 2.9666 - val_accuracy100: 0.4934 - 60s/epoch - 40ms/step
Epoch 8/50
1497/1497 - 59s - loss: 2.8968 - accuracy100: 0.5088 - val_loss: 2.9654 - val_accuracy100: 0.4933 - 59s/epoch - 39ms/step
Epoch 9/50
1497/1497 - 59s - loss: 2.8899 - accuracy100: 0.5104 - val_loss: 2.9595 - val_accuracy100: 0.4936 - 59s/epoch - 39ms/step
Epoch 10/50
1497/1497 - 59s - loss: 2.8838 - accuracy100: 0.5131 - val_loss: 2.9610 - val_accuracy100: 0.4931 - 59s/epoch - 39ms/step
Epoch 11/50
1497/1497 - 60s - loss: 2.8776 - accuracy100: 0.5146 - val_loss: 2.9596 - val_accuracy100: 0.4931 - 60s/epoch - 40ms/step
Epoch 12/50
1497/1497 - 59s - loss: 2.8714 - accuracy100: 0.5162 - val_loss: 2.9561 - val_accuracy100: 0.4917 - 59s/epoch - 39ms/step
Epoch 13/50
1497/1497 - 58s - loss: 2.8664 - accuracy100: 0.5177 - val_loss: 2.9556 - val_accuracy100: 0.4952 - 58s/epoch - 39ms/step
Epoch 14/50
1497/1497 - 54s - loss: 2.8603 - accuracy100: 0.5197 - val_loss: 2.9635 - val_accuracy100: 0.4956 - 54s/epoch - 36ms/step
Epoch 15/50
1497/1497 - 54s - loss: 2.8536 - accuracy100: 0.5217 - val_loss: 2.9616 - val_accuracy100: 0.4950 - 54s/epoch - 36ms/step
Epoch 16/50
1497/1497 - 53s - loss: 2.8473 - accuracy100: 0.5236 - val_loss: 2.9664 - val_accuracy100: 0.4922 - 53s/epoch - 36ms/step
Epoch 17/50
1497/1497 - 55s - loss: 2.8414 - accuracy100: 0.5250 - val_loss: 2.9584 - val_accuracy100: 0.4942 - 55s/epoch - 37ms/step
Epoch 18/50
1497/1497 - 57s - loss: 2.8358 - accuracy100: 0.5265 - val_loss: 2.9624 - val_accuracy100: 0.4932 - 57s/epoch - 38ms/step
Epoch 19/50
1497/1497 - 54s - loss: 2.8296 - accuracy100: 0.5279 - val_loss: 2.9594 - val_accuracy100: 0.4942 - 54s/epoch - 36ms/step
Epoch 20/50
1497/1497 - 57s - loss: 2.8237 - accuracy100: 0.5292 - val_loss: 2.9677 - val_accuracy100: 0.4938 - 57s/epoch - 38ms/step
Epoch 21/50
1497/1497 - 54s - loss: 2.8175 - accuracy100: 0.5313 - val_loss: 2.9759 - val_accuracy100: 0.4885 - 54s/epoch - 36ms/step
Epoch 22/50
1497/1497 - 59s - loss: 2.8135 - accuracy100: 0.5316 - val_loss: 2.9820 - val_accuracy100: 0.4870 - 59s/epoch - 40ms/step
Epoch 23/50
1497/1497 - 54s - loss: 2.8072 - accuracy100: 0.5337 - val_loss: 2.9877 - val_accuracy100: 0.4872 - 54s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h100
Evaluating performance on  test set...
4693/4693 - 73s - 73s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96981823
{'0': {'precision': 0.4868356088946279, 'recall': 0.5399703026601235, 'f1-score': 0.5120281605751947, 'support': 379832}, '1': {'precision': 0.5070512177215324, 'recall': 0.43727068790780826, 'f1-score': 0.46958274176605613, 'support': 439085}, '2': {'precision': 0.512867417992952, 'recall': 0.5383192727748348, 'f1-score': 0.5252852189028755, 'support': 382275}, 'accuracy': 0.5019039420841964, 'macro avg': {'precision': 0.502251414869704, 'recall': 0.5051867544475889, 'f1-score': 0.5022987070813755, 'support': 1201192}, 'weighted avg': {'precision': 0.5025097729123896, 'recall': 0.5019039420841964, 'f1-score': 0.5007316278430449, 'support': 1201192}}
[[205098  87907  86827]
 [138453 191999 108633]
 [ 77737  98752 205786]]
Evaluating performance on  train set...
1497/1497 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9843323
{'0': {'precision': 0.5238217997260937, 'recall': 0.5092694847153364, 'f1-score': 0.5164431489196091, 'support': 127677}, '1': {'precision': 0.4530061411711188, 'recall': 0.4264405005471761, 'f1-score': 0.43932208374692105, 'support': 126102}, '2': {'precision': 0.49716346427960545, 'recall': 0.5392131096853985, 'f1-score': 0.5173352318656788, 'support': 129370}, 'accuracy': 0.49211925386729444, 'macro avg': {'precision': 0.4913304683922726, 'recall': 0.4916410316493036, 'f1-score': 0.49103348817740294, 'support': 383149}, 'weighted avg': {'precision': 0.49151378109153737, 'recall': 0.49211925386729444, 'f1-score': 0.4913622749262716, 'support': 383149}}
[[65022 31511 31144]
 [32917 53775 39410]
 [26191 33421 69758]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9847986
{'0': {'precision': 0.5393877101534396, 'recall': 0.4778951020142668, 'f1-score': 0.5067828566173089, 'support': 46121}, '1': {'precision': 0.45364841933253724, 'recall': 0.4596573903075845, 'f1-score': 0.4566331372176884, 'support': 47109}, '2': {'precision': 0.4988192126783379, 'recall': 0.548419629637577, 'f1-score': 0.5224448078495503, 'support': 46603}, 'accuracy': 0.4952550542432759, 'macro avg': {'precision': 0.4972851140547716, 'recall': 0.4953240406531427, 'f1-score': 0.4952869338948492, 'support': 139833}, 'weighted avg': {'precision': 0.4969820838769951, 'recall': 0.4952550542432759, 'f1-score': 0.4951074350936301, 'support': 139833}}
[[22041 12928 11152]
 [10928 21654 14527]
 [ 7894 13151 25558]]
training model: results/EXC/W0/deepVOL_L3/h200
Epoch 1/50
1497/1497 - 59s - loss: 3.2625 - accuracy200: 0.3912 - val_loss: 3.2740 - val_accuracy200: 0.3703 - 59s/epoch - 39ms/step
Epoch 2/50
1497/1497 - 56s - loss: 3.2239 - accuracy200: 0.4085 - val_loss: 3.2495 - val_accuracy200: 0.3867 - 56s/epoch - 37ms/step
Epoch 3/50
1497/1497 - 55s - loss: 3.2166 - accuracy200: 0.4125 - val_loss: 3.2490 - val_accuracy200: 0.3862 - 55s/epoch - 37ms/step
Epoch 4/50
1497/1497 - 54s - loss: 3.2093 - accuracy200: 0.4150 - val_loss: 3.2363 - val_accuracy200: 0.3916 - 54s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 55s - loss: 3.2015 - accuracy200: 0.4180 - val_loss: 3.2303 - val_accuracy200: 0.3915 - 55s/epoch - 37ms/step
Epoch 6/50
1497/1497 - 55s - loss: 3.1912 - accuracy200: 0.4236 - val_loss: 3.2344 - val_accuracy200: 0.3908 - 55s/epoch - 37ms/step
Epoch 7/50
1497/1497 - 55s - loss: 3.1850 - accuracy200: 0.4259 - val_loss: 3.2370 - val_accuracy200: 0.3903 - 55s/epoch - 37ms/step
Epoch 8/50
1497/1497 - 53s - loss: 3.1777 - accuracy200: 0.4304 - val_loss: 3.2406 - val_accuracy200: 0.3870 - 53s/epoch - 36ms/step
Epoch 9/50
1497/1497 - 54s - loss: 3.1740 - accuracy200: 0.4316 - val_loss: 3.2340 - val_accuracy200: 0.3931 - 54s/epoch - 36ms/step
Epoch 10/50
1497/1497 - 53s - loss: 3.1704 - accuracy200: 0.4330 - val_loss: 3.2398 - val_accuracy200: 0.3894 - 53s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 54s - loss: 3.1650 - accuracy200: 0.4350 - val_loss: 3.2341 - val_accuracy200: 0.3903 - 54s/epoch - 36ms/step
Epoch 12/50
1497/1497 - 54s - loss: 3.1605 - accuracy200: 0.4359 - val_loss: 3.2341 - val_accuracy200: 0.3883 - 54s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 55s - loss: 3.1568 - accuracy200: 0.4384 - val_loss: 3.2318 - val_accuracy200: 0.3902 - 55s/epoch - 37ms/step
Epoch 14/50
1497/1497 - 55s - loss: 3.1540 - accuracy200: 0.4392 - val_loss: 3.2384 - val_accuracy200: 0.3887 - 55s/epoch - 37ms/step
Epoch 15/50
1497/1497 - 55s - loss: 3.1476 - accuracy200: 0.4400 - val_loss: 3.2378 - val_accuracy200: 0.3913 - 55s/epoch - 37ms/step
testing model: results/EXC/W0/deepVOL_L3/h200
Evaluating performance on  test set...
4693/4693 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.075174
{'0': {'precision': 0.35810479921645444, 'recall': 0.5844289294460842, 'f1-score': 0.4440940373190818, 'support': 350342}, '1': {'precision': 0.4455998758342387, 'recall': 0.0579578488372093, 'f1-score': 0.10257417960306545, 'support': 495360}, '2': {'precision': 0.3651420702935565, 'recall': 0.5803426256716082, 'f1-score': 0.4482515871946742, 'support': 355490}, 'accuracy': 0.3661079993872753, 'macro avg': {'precision': 0.3896155817814166, 'recall': 0.4075764679849672, 'f1-score': 0.33163993470560715, 'support': 1201192}, 'weighted avg': {'precision': 0.39626958939869394, 'recall': 0.3661079993872753, 'f1-score': 0.30448495791051805, 'support': 1201192}}
[[204750  17796 127796]
 [235750  28710 230900]
 [131260  17924 206306]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0753114
{'0': {'precision': 0.40863686642672253, 'recall': 0.5715396395335139, 'f1-score': 0.47655124544906885, 'support': 127335}, '1': {'precision': 0.3632167287692564, 'recall': 0.05137018625723635, 'f1-score': 0.09001012975736819, 'support': 127136}, '2': {'precision': 0.39896082236156327, 'recall': 0.5800059062155147, 'f1-score': 0.4727425898419314, 'support': 128678}, 'accuracy': 0.40178103035633655, 'macro avg': {'precision': 0.39027147251918076, 'recall': 0.400971910668755, 'f1-score': 0.3464346550161228, 'support': 383149}, 'weighted avg': {'precision': 0.39031598181150445, 'recall': 0.40178103035633655, 'f1-score': 0.34701056683371223, 'support': 383149}}
[[72777  5914 48644]
 [56812  6531 63793]
 [48508  5536 74634]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0764521
{'0': {'precision': 0.4064188330934033, 'recall': 0.5203052839270614, 'f1-score': 0.4563642241789171, 'support': 46121}, '1': {'precision': 0.3538995323578217, 'recall': 0.048823125429231444, 'f1-score': 0.08580833942940747, 'support': 48051}, '2': {'precision': 0.3837834922261627, 'recall': 0.6233109217932152, 'f1-score': 0.47506259389083627, 'support': 45661}, 'accuracy': 0.39192465297891055, 'macro avg': {'precision': 0.3813672858924626, 'recall': 0.397479777049836, 'f1-score': 0.33907838583305355, 'support': 139833}, 'weighted avg': {'precision': 0.3809802226153008, 'recall': 0.39192465297891055, 'f1-score': 0.3351353686249152, 'support': 139833}}
[[23997  2344 19780]
 [19787  2346 25918]
 [15261  1939 28461]]
training model: results/EXC/W0/deepVOL_L3/h300
Epoch 1/50
1497/1497 - 57s - loss: 3.2881 - accuracy300: 0.3739 - val_loss: 3.3011 - val_accuracy300: 0.3442 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 54s - loss: 3.2556 - accuracy300: 0.3915 - val_loss: 3.2902 - val_accuracy300: 0.3630 - 54s/epoch - 36ms/step
Epoch 3/50
1497/1497 - 54s - loss: 3.2475 - accuracy300: 0.3958 - val_loss: 3.2818 - val_accuracy300: 0.3771 - 54s/epoch - 36ms/step
Epoch 4/50
1497/1497 - 53s - loss: 3.2398 - accuracy300: 0.4017 - val_loss: 3.2857 - val_accuracy300: 0.3751 - 53s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 54s - loss: 3.2313 - accuracy300: 0.4062 - val_loss: 3.2845 - val_accuracy300: 0.3745 - 54s/epoch - 36ms/step
Epoch 6/50
1497/1497 - 56s - loss: 3.2229 - accuracy300: 0.4112 - val_loss: 3.2749 - val_accuracy300: 0.3802 - 56s/epoch - 37ms/step
Epoch 7/50
1497/1497 - 54s - loss: 3.2152 - accuracy300: 0.4147 - val_loss: 3.2684 - val_accuracy300: 0.3851 - 54s/epoch - 36ms/step
Epoch 8/50
1497/1497 - 55s - loss: 3.2069 - accuracy300: 0.4192 - val_loss: 3.2658 - val_accuracy300: 0.3865 - 55s/epoch - 37ms/step
Epoch 9/50
1497/1497 - 53s - loss: 3.2003 - accuracy300: 0.4220 - val_loss: 3.2685 - val_accuracy300: 0.3854 - 53s/epoch - 36ms/step
Epoch 10/50
1497/1497 - 54s - loss: 3.1945 - accuracy300: 0.4239 - val_loss: 3.2642 - val_accuracy300: 0.3882 - 54s/epoch - 36ms/step
Epoch 11/50
1497/1497 - 54s - loss: 3.1874 - accuracy300: 0.4257 - val_loss: 3.2594 - val_accuracy300: 0.3921 - 54s/epoch - 36ms/step
Epoch 12/50
1497/1497 - 54s - loss: 3.1820 - accuracy300: 0.4290 - val_loss: 3.2659 - val_accuracy300: 0.3907 - 54s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 54s - loss: 3.1772 - accuracy300: 0.4303 - val_loss: 3.2636 - val_accuracy300: 0.3921 - 54s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 55s - loss: 3.1686 - accuracy300: 0.4345 - val_loss: 3.2604 - val_accuracy300: 0.3922 - 55s/epoch - 37ms/step
Epoch 15/50
1497/1497 - 53s - loss: 3.1630 - accuracy300: 0.4368 - val_loss: 3.2693 - val_accuracy300: 0.3903 - 53s/epoch - 35ms/step
Epoch 16/50
1497/1497 - 55s - loss: 3.1573 - accuracy300: 0.4392 - val_loss: 3.2685 - val_accuracy300: 0.3892 - 55s/epoch - 37ms/step
Epoch 17/50
1497/1497 - 54s - loss: 3.1489 - accuracy300: 0.4431 - val_loss: 3.2793 - val_accuracy300: 0.3854 - 54s/epoch - 36ms/step
Epoch 18/50
1497/1497 - 54s - loss: 3.1429 - accuracy300: 0.4448 - val_loss: 3.2863 - val_accuracy300: 0.3838 - 54s/epoch - 36ms/step
Epoch 19/50
1497/1497 - 54s - loss: 3.1377 - accuracy300: 0.4473 - val_loss: 3.2988 - val_accuracy300: 0.3816 - 54s/epoch - 36ms/step
Epoch 20/50
1497/1497 - 54s - loss: 3.1322 - accuracy300: 0.4490 - val_loss: 3.2892 - val_accuracy300: 0.3865 - 54s/epoch - 36ms/step
Epoch 21/50
1497/1497 - 54s - loss: 3.1227 - accuracy300: 0.4524 - val_loss: 3.2937 - val_accuracy300: 0.3866 - 54s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h300
Evaluating performance on  test set...
4693/4693 - 68s - 68s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0749876
{'0': {'precision': 0.38263650977977426, 'recall': 0.4885074906416442, 'f1-score': 0.4291386983781579, 'support': 379073}, '1': {'precision': 0.48574953946682425, 'recall': 0.19408439881123218, 'f1-score': 0.27735128251773694, 'support': 432044}, '2': {'precision': 0.38759988836006815, 'recall': 0.5411523424982375, 'f1-score': 0.45168254905673905, 'support': 390075}, 'accuracy': 0.3997054592438178, 'macro avg': {'precision': 0.4186619792022222, 'recall': 0.4079147439837046, 'f1-score': 0.38605750998421134, 'support': 1201192}, 'weighted avg': {'precision': 0.42133594808590674, 'recall': 0.3997054592438178, 'f1-score': 0.38186478234762145, 'support': 1201192}}
[[185180  43162 150731]
 [165404  83853 182787]
 [133374  45611 211090]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0772899
{'0': {'precision': 0.40618769035254937, 'recall': 0.4386377259677572, 'f1-score': 0.4217894996302686, 'support': 126788}, '1': {'precision': 0.441438556168874, 'recall': 0.18529618763690425, 'f1-score': 0.2610255210596086, 'support': 126457}, '2': {'precision': 0.39513644764976624, 'recall': 0.5875184751816727, 'f1-score': 0.47249539552088654, 'support': 129904}, 'accuracy': 0.4055002101010312, 'macro avg': {'precision': 0.4142542313903965, 'recall': 0.40381746292877807, 'f1-score': 0.3851034720702546, 'support': 383149}, 'weighted avg': {'precision': 0.4140752696140707, 'recall': 0.4055002101010312, 'f1-score': 0.38592138634187395, 'support': 383149}}
[[55614 14935 56239]
 [42434 23432 60591]
 [38869 14714 76321]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0862339
{'0': {'precision': 0.41016731586402266, 'recall': 0.38420714389369154, 'f1-score': 0.3967630404298819, 'support': 48237}, '1': {'precision': 0.3792416140009723, 'recall': 0.17939519374496954, 'f1-score': 0.2435719303723363, 'support': 43485}, '2': {'precision': 0.38531837632797417, 'recall': 0.5932946727359647, 'f1-score': 0.4672068090678451, 'support': 48111}, 'accuracy': 0.3924538556706929, 'macro avg': {'precision': 0.3915757687309897, 'recall': 0.38563233679154196, 'f1-score': 0.3691805932900211, 'support': 139833}, 'weighted avg': {'precision': 0.39200056355567214, 'recall': 0.3924538556706929, 'f1-score': 0.3733608730737405, 'support': 139833}}
[[18533  6516 23188]
 [13337  7801 22347]
 [13314  6253 28544]]
training model: results/EXC/W0/deepVOL_L3/h500
Epoch 1/50
1497/1497 - 57s - loss: 3.2914 - accuracy500: 0.3686 - val_loss: 3.3166 - val_accuracy500: 0.3227 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 55s - loss: 3.2803 - accuracy500: 0.3748 - val_loss: 3.3075 - val_accuracy500: 0.3434 - 55s/epoch - 37ms/step
Epoch 3/50
1497/1497 - 54s - loss: 3.2699 - accuracy500: 0.3816 - val_loss: 3.3088 - val_accuracy500: 0.3433 - 54s/epoch - 36ms/step
Epoch 4/50
1497/1497 - 54s - loss: 3.2669 - accuracy500: 0.3826 - val_loss: 3.3033 - val_accuracy500: 0.3484 - 54s/epoch - 36ms/step
Epoch 5/50
1497/1497 - 56s - loss: 3.2642 - accuracy500: 0.3859 - val_loss: 3.3089 - val_accuracy500: 0.3423 - 56s/epoch - 37ms/step
Epoch 6/50
1497/1497 - 55s - loss: 3.2593 - accuracy500: 0.3892 - val_loss: 3.3139 - val_accuracy500: 0.3485 - 55s/epoch - 37ms/step
Epoch 7/50
1497/1497 - 57s - loss: 3.2533 - accuracy500: 0.3944 - val_loss: 3.3089 - val_accuracy500: 0.3498 - 57s/epoch - 38ms/step
Epoch 8/50
1497/1497 - 54s - loss: 3.2456 - accuracy500: 0.3988 - val_loss: 3.3263 - val_accuracy500: 0.3400 - 54s/epoch - 36ms/step
Epoch 9/50
1497/1497 - 54s - loss: 3.2375 - accuracy500: 0.4038 - val_loss: 3.3271 - val_accuracy500: 0.3389 - 54s/epoch - 36ms/step
Epoch 10/50
1497/1497 - 55s - loss: 3.2304 - accuracy500: 0.4076 - val_loss: 3.3407 - val_accuracy500: 0.3460 - 55s/epoch - 37ms/step
Epoch 11/50
1497/1497 - 55s - loss: 3.2254 - accuracy500: 0.4110 - val_loss: 3.3302 - val_accuracy500: 0.3493 - 55s/epoch - 37ms/step
Epoch 12/50
1497/1497 - 55s - loss: 3.2174 - accuracy500: 0.4157 - val_loss: 3.3271 - val_accuracy500: 0.3515 - 55s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 54s - loss: 3.2094 - accuracy500: 0.4204 - val_loss: 3.3167 - val_accuracy500: 0.3574 - 54s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 54s - loss: 3.2000 - accuracy500: 0.4245 - val_loss: 3.3213 - val_accuracy500: 0.3574 - 54s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h500
Evaluating performance on  test set...
4693/4693 - 80s - 80s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994661
{'0': {'precision': 0.21121359075860813, 'recall': 0.46620066414298295, 'f1-score': 0.2907169891250425, 'support': 223747}, '1': {'precision': 0.6479859749410083, 'recall': 0.1050137681696077, 'f1-score': 0.18073697786007362, 'support': 742655}, '2': {'precision': 0.2209052917435444, 'recall': 0.552259465905703, 'f1-score': 0.31557837376074066, 'support': 234790}, 'accuracy': 0.2597128519004456, 'macro avg': {'precision': 0.3600349524810536, 'recall': 0.3744912994060979, 'f1-score': 0.26234411358195225, 'support': 1201192}, 'weighted avg': {'precision': 0.48314905940078484, 'recall': 0.2597128519004456, 'f1-score': 0.22757970485460954, 'support': 1201192}}
[[104311  21703  97733]
 [305093  77989 359573]
 [ 84461  20664 129665]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956186
{'0': {'precision': 0.365361900837797, 'recall': 0.4221400574448165, 'f1-score': 0.39170415307707596, 'support': 126034}, '1': {'precision': 0.3509546348986864, 'recall': 0.10452950634004166, 'f1-score': 0.16108185296612496, 'support': 126261}, '2': {'precision': 0.37002746057232033, 'recall': 0.5653399972488422, 'f1-score': 0.447292284530061, 'support': 130854}, 'accuracy': 0.36638226903893784, 'macro avg': {'precision': 0.3621146654362679, 'recall': 0.36400318701123346, 'f1-score': 0.3333594301910873, 'support': 383149}, 'weighted avg': {'precision': 0.3622075962428829, 'recall': 0.36638226903893784, 'f1-score': 0.334690633842627, 'support': 383149}}
[[53204 12173 60657]
 [47774 13198 65289]
 [44642 12235 73977]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992166
{'0': {'precision': 0.35927613001628295, 'recall': 0.3894934417804393, 'f1-score': 0.37377506164897617, 'support': 44753}, '1': {'precision': 0.3905112120556637, 'recall': 0.10641307764853819, 'f1-score': 0.16725082992356982, 'support': 50896}, '2': {'precision': 0.33470631528658307, 'recall': 0.5866829621582473, 'f1-score': 0.4262400210472658, 'support': 44184}, 'accuracy': 0.34876602804774265, 'macro avg': {'precision': 0.3614978857861766, 'recall': 0.3608631605290749, 'f1-score': 0.32242197087327057, 'support': 139833}, 'weighted avg': {'precision': 0.36288148813245913, 'recall': 0.34876602804774265, 'f1-score': 0.3151827012487684, 'support': 139833}}
[[17431  4165 23157]
 [17112  5416 28368]
 [13974  4288 25922]]
training model: results/EXC/W0/deepVOL_L3/h1000
Epoch 1/50
1497/1497 - 57s - loss: 3.2373 - accuracy1000: 0.4116 - val_loss: 3.3543 - val_accuracy1000: 0.3361 - 57s/epoch - 38ms/step
Epoch 2/50
1497/1497 - 54s - loss: 3.2324 - accuracy1000: 0.4121 - val_loss: 3.3196 - val_accuracy1000: 0.3398 - 54s/epoch - 36ms/step
Epoch 3/50
1497/1497 - 53s - loss: 3.2309 - accuracy1000: 0.4135 - val_loss: 3.3179 - val_accuracy1000: 0.3419 - 53s/epoch - 36ms/step
Epoch 4/50
1497/1497 - 59s - loss: 3.2186 - accuracy1000: 0.4198 - val_loss: 3.3145 - val_accuracy1000: 0.3426 - 59s/epoch - 39ms/step
Epoch 5/50
1497/1497 - 56s - loss: 3.2032 - accuracy1000: 0.4317 - val_loss: 3.3336 - val_accuracy1000: 0.3429 - 56s/epoch - 38ms/step
Epoch 6/50
1497/1497 - 54s - loss: 3.2067 - accuracy1000: 0.4304 - val_loss: 3.3304 - val_accuracy1000: 0.3507 - 54s/epoch - 36ms/step
Epoch 7/50
1497/1497 - 57s - loss: 3.2040 - accuracy1000: 0.4315 - val_loss: 3.3524 - val_accuracy1000: 0.3400 - 57s/epoch - 38ms/step
Epoch 8/50
1497/1497 - 53s - loss: 3.1986 - accuracy1000: 0.4339 - val_loss: 3.3596 - val_accuracy1000: 0.3388 - 53s/epoch - 35ms/step
Epoch 9/50
1497/1497 - 55s - loss: 3.2017 - accuracy1000: 0.4307 - val_loss: 3.3570 - val_accuracy1000: 0.3524 - 55s/epoch - 37ms/step
Epoch 10/50
1497/1497 - 52s - loss: 3.1846 - accuracy1000: 0.4409 - val_loss: 3.3519 - val_accuracy1000: 0.3436 - 52s/epoch - 35ms/step
Epoch 11/50
1497/1497 - 56s - loss: 3.1835 - accuracy1000: 0.4418 - val_loss: 3.3646 - val_accuracy1000: 0.3433 - 56s/epoch - 37ms/step
Epoch 12/50
1497/1497 - 55s - loss: 3.1782 - accuracy1000: 0.4429 - val_loss: 3.3668 - val_accuracy1000: 0.3410 - 55s/epoch - 36ms/step
Epoch 13/50
1497/1497 - 54s - loss: 3.1713 - accuracy1000: 0.4468 - val_loss: 3.3749 - val_accuracy1000: 0.3401 - 54s/epoch - 36ms/step
Epoch 14/50
1497/1497 - 54s - loss: 3.1638 - accuracy1000: 0.4496 - val_loss: 3.3748 - val_accuracy1000: 0.3426 - 54s/epoch - 36ms/step
testing model: results/EXC/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
4693/4693 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0858425
{'0': {'precision': 0.2655433391885152, 'recall': 0.04020527839980037, 'f1-score': 0.06983674342339773, 'support': 304562}, '1': {'precision': 0.4995673754957311, 'recall': 0.5782092716601598, 'f1-score': 0.5360192004397438, 'support': 580155}, '2': {'precision': 0.3097916442650477, 'recall': 0.4733833636148195, 'f1-score': 0.37450176296853654, 'support': 316475}, 'accuracy': 0.4141802476206968, 'macro avg': {'precision': 0.35830078631643136, 'recall': 0.3639326378915932, 'f1-score': 0.32678590227722604, 'support': 1201192}, 'weighted avg': {'precision': 0.3902308971583555, 'recall': 0.4141802476206968, 'f1-score': 0.3752641400518019, 'support': 1201192}}
[[ 12245 179705 112612]
 [ 23534 335451 221170]
 [ 10334 156327 149814]]
Evaluating performance on  train set...
1497/1497 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099597
{'0': {'precision': 0.36048511955960777, 'recall': 0.033279072537420094, 'f1-score': 0.06093296791968654, 'support': 125935}, '1': {'precision': 0.3411301427777644, 'recall': 0.5579112898764885, 'f1-score': 0.42338506560483585, 'support': 126547}, '2': {'precision': 0.367608988927916, 'recall': 0.462955451644256, 'f1-score': 0.4098094673554069, 'support': 130667}, 'accuracy': 0.3530897901338644, 'macro avg': {'precision': 0.35640808375509603, 'recall': 0.35138193801938816, 'f1-score': 0.29804250029330975, 'support': 383149}, 'weighted avg': {'precision': 0.35652201484561086, 'recall': 0.3530897901338644, 'f1-score': 0.2996230627849475, 'support': 383149}}
[[ 4191 69698 52046]
 [ 3926 70602 52019]
 [ 3509 66665 60493]]
Evaluating performance on  val set...
547/547 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038437
{'0': {'precision': 0.36984949420182583, 'recall': 0.031952763626286955, 'f1-score': 0.058823529411764705, 'support': 46913}, '1': {'precision': 0.341622929867022, 'recall': 0.5370425786593708, 'f1-score': 0.4176015956120668, 'support': 46784}, '2': {'precision': 0.3422727126651027, 'recall': 0.4617001907404196, 'f1-score': 0.3931161760634862, 'support': 46136}, 'accuracy': 0.3427302568063333, 'macro avg': {'precision': 0.3512483789113168, 'recall': 0.34356517767535916, 'f1-score': 0.2898471003624392, 'support': 139833}, 'weighted avg': {'precision': 0.3513071331081089, 'recall': 0.3427302568063333, 'f1-score': 0.28915541526874233, 'support': 139833}}
[[ 1499 24884 20530]
 [ 1256 25125 20403]
 [ 1298 23537 21301]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        23 (peak)  14.34 (ave)

============================================
