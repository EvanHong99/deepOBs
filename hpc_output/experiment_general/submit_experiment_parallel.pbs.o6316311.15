This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-03-13.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-05.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-21.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-01.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-25.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-27.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-22.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-26.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-28.csv
data/EXC_orderbooks/EXC_orderbooks_2019-02-19.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-07.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-06.csv
training model: results/EXC/W1/deepLOB_L1/h10
Epoch 1/50
1290/1290 - 72s - loss: 2.6695 - accuracy10: 0.4593 - val_loss: 2.9734 - val_accuracy10: 0.5582 - 72s/epoch - 56ms/step
Epoch 2/50
1290/1290 - 39s - loss: 2.4028 - accuracy10: 0.5605 - val_loss: 2.7577 - val_accuracy10: 0.6598 - 39s/epoch - 31ms/step
Epoch 3/50
1290/1290 - 38s - loss: 2.2042 - accuracy10: 0.6362 - val_loss: 2.4979 - val_accuracy10: 0.7017 - 38s/epoch - 29ms/step
Epoch 4/50
1290/1290 - 39s - loss: 2.1178 - accuracy10: 0.6579 - val_loss: 2.5848 - val_accuracy10: 0.6926 - 39s/epoch - 31ms/step
Epoch 5/50
1290/1290 - 38s - loss: 2.0674 - accuracy10: 0.6649 - val_loss: 2.4483 - val_accuracy10: 0.6960 - 38s/epoch - 30ms/step
Epoch 6/50
1290/1290 - 39s - loss: 2.0345 - accuracy10: 0.6698 - val_loss: 2.4554 - val_accuracy10: 0.7269 - 39s/epoch - 30ms/step
Epoch 7/50
1290/1290 - 41s - loss: 2.0062 - accuracy10: 0.6719 - val_loss: 2.3998 - val_accuracy10: 0.7215 - 41s/epoch - 32ms/step
Epoch 8/50
1290/1290 - 40s - loss: 1.9877 - accuracy10: 0.6742 - val_loss: 2.3671 - val_accuracy10: 0.7338 - 40s/epoch - 31ms/step
Epoch 9/50
1290/1290 - 39s - loss: 1.9735 - accuracy10: 0.6749 - val_loss: 2.3743 - val_accuracy10: 0.7341 - 39s/epoch - 30ms/step
Epoch 10/50
1290/1290 - 40s - loss: 1.9565 - accuracy10: 0.6768 - val_loss: 2.3075 - val_accuracy10: 0.7312 - 40s/epoch - 31ms/step
Epoch 11/50
1290/1290 - 41s - loss: 1.9442 - accuracy10: 0.6780 - val_loss: 2.4227 - val_accuracy10: 0.7454 - 41s/epoch - 32ms/step
Epoch 12/50
1290/1290 - 41s - loss: 1.9456 - accuracy10: 0.6776 - val_loss: 2.3247 - val_accuracy10: 0.7303 - 41s/epoch - 32ms/step
Epoch 13/50
1290/1290 - 41s - loss: 1.9323 - accuracy10: 0.6787 - val_loss: 2.3290 - val_accuracy10: 0.7252 - 41s/epoch - 32ms/step
Epoch 14/50
1290/1290 - 39s - loss: 1.9183 - accuracy10: 0.6807 - val_loss: 2.4287 - val_accuracy10: 0.7368 - 39s/epoch - 30ms/step
Epoch 15/50
1290/1290 - 42s - loss: 1.9076 - accuracy10: 0.6816 - val_loss: 2.3219 - val_accuracy10: 0.7398 - 42s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 42s - loss: 1.9003 - accuracy10: 0.6812 - val_loss: 2.2939 - val_accuracy10: 0.7368 - 42s/epoch - 32ms/step
Epoch 17/50
1290/1290 - 43s - loss: 1.8932 - accuracy10: 0.6822 - val_loss: 2.2791 - val_accuracy10: 0.7385 - 43s/epoch - 34ms/step
Epoch 18/50
1290/1290 - 41s - loss: 1.8848 - accuracy10: 0.6823 - val_loss: 2.3624 - val_accuracy10: 0.7465 - 41s/epoch - 32ms/step
Epoch 19/50
1290/1290 - 41s - loss: 1.8807 - accuracy10: 0.6819 - val_loss: 2.3745 - val_accuracy10: 0.7507 - 41s/epoch - 32ms/step
Epoch 20/50
1290/1290 - 43s - loss: 1.8733 - accuracy10: 0.6820 - val_loss: 2.3825 - val_accuracy10: 0.7515 - 43s/epoch - 33ms/step
Epoch 21/50
1290/1290 - 43s - loss: 1.8682 - accuracy10: 0.6819 - val_loss: 2.4468 - val_accuracy10: 0.7565 - 43s/epoch - 33ms/step
Epoch 22/50
1290/1290 - 42s - loss: 1.8630 - accuracy10: 0.6833 - val_loss: 2.3575 - val_accuracy10: 0.7503 - 42s/epoch - 33ms/step
Epoch 23/50
1290/1290 - 43s - loss: 1.8577 - accuracy10: 0.6832 - val_loss: 2.3098 - val_accuracy10: 0.7503 - 43s/epoch - 33ms/step
Epoch 24/50
1290/1290 - 42s - loss: 1.8536 - accuracy10: 0.6840 - val_loss: 2.3514 - val_accuracy10: 0.7464 - 42s/epoch - 33ms/step
Epoch 25/50
1290/1290 - 43s - loss: 1.8474 - accuracy10: 0.6836 - val_loss: 2.3152 - val_accuracy10: 0.7466 - 43s/epoch - 33ms/step
Epoch 26/50
1290/1290 - 45s - loss: 1.8413 - accuracy10: 0.6843 - val_loss: 2.4724 - val_accuracy10: 0.7362 - 45s/epoch - 35ms/step
Epoch 27/50
1290/1290 - 44s - loss: 1.8371 - accuracy10: 0.6840 - val_loss: 2.4212 - val_accuracy10: 0.7469 - 44s/epoch - 34ms/step
testing model: results/EXC/W1/deepLOB_L1/h10
Evaluating performance on  test set...
5343/5343 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60311157
{'0': {'precision': 0.4190154493604297, 'recall': 0.4398196883294692, 'f1-score': 0.4291655901239547, 'support': 154843}, '1': {'precision': 0.8364178223186728, 'recall': 0.8799750378078726, 'f1-score': 0.8576437503518711, 'support': 1055997}, '2': {'precision': 0.37120368307715157, 'recall': 0.22295777609287093, 'f1-score': 0.27858672547349317, 'support': 156949}, 'accuracy': 0.7547560332770624, 'macro avg': {'precision': 0.5422123182520847, 'recall': 0.5142508340767376, 'f1-score': 0.5217986886497731, 'support': 1367789}, 'weighted avg': {'precision': 0.7357833461123349, 'recall': 0.7547560332770624, 'f1-score': 0.7426923472028417, 'support': 1367789}}
[[ 68103  69340  17400]
 [ 84870 929251  41876]
 [  9558 112398  34993]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.587607
{'0': {'precision': 0.34750946693853774, 'recall': 0.6376269374665954, 'f1-score': 0.44984917043740574, 'support': 31807}, '1': {'precision': 0.9260536416036538, 'recall': 0.7604693460259602, 'f1-score': 0.8351328886481211, 'support': 265561}, '2': {'precision': 0.3872420402314892, 'recall': 0.6342771800420617, 'f1-score': 0.48088921754402175, 'support': 32809}, 'accuracy': 0.7360960939132647, 'macro avg': {'precision': 0.5536017162578936, 'recall': 0.6774578211782057, 'f1-score': 0.5886237588765162, 'support': 330177}, 'weighted avg': {'precision': 0.8167800568506495, 'recall': 0.7360960939132647, 'f1-score': 0.7628168283823162, 'support': 330177}}
[[ 20281   7620   3906]
 [ 34587 201951  29023]
 [  3493   8506  20810]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59618354
{'0': {'precision': 0.35224316263722316, 'recall': 0.6115456648672469, 'f1-score': 0.44701240135287484, 'support': 9077}, '1': {'precision': 0.9233684957579277, 'recall': 0.7653649210529834, 'f1-score': 0.8369750356372674, 'support': 74797}, '2': {'precision': 0.37601908928216343, 'recall': 0.6324414715719063, 'f1-score': 0.4716298790372864, 'support': 8970}, 'accuracy': 0.7374843824048942, 'macro avg': {'precision': 0.5505435825591047, 'recall': 0.6697840191640455, 'f1-score': 0.5852057720091429, 'support': 92844}, 'weighted avg': {'precision': 0.8146503359972083, 'recall': 0.7374843824048942, 'f1-score': 0.7635525539895435, 'support': 92844}}
[[ 5551  2466  1060]
 [ 9196 57247  8354]
 [ 1012  2285  5673]]
training model: results/EXC/W1/deepLOB_L1/h20
Epoch 1/50
1290/1290 - 45s - loss: 2.7157 - accuracy20: 0.4693 - val_loss: 2.9045 - val_accuracy20: 0.5472 - 45s/epoch - 35ms/step
Epoch 2/50
1290/1290 - 41s - loss: 2.4481 - accuracy20: 0.5780 - val_loss: 2.7460 - val_accuracy20: 0.6713 - 41s/epoch - 32ms/step
Epoch 3/50
1290/1290 - 38s - loss: 2.2768 - accuracy20: 0.6292 - val_loss: 2.5968 - val_accuracy20: 0.6585 - 38s/epoch - 30ms/step
Epoch 4/50
1290/1290 - 39s - loss: 2.1990 - accuracy20: 0.6409 - val_loss: 2.5178 - val_accuracy20: 0.6630 - 39s/epoch - 30ms/step
Epoch 5/50
1290/1290 - 42s - loss: 2.1528 - accuracy20: 0.6449 - val_loss: 2.4934 - val_accuracy20: 0.6762 - 42s/epoch - 33ms/step
Epoch 6/50
1290/1290 - 41s - loss: 2.1232 - accuracy20: 0.6484 - val_loss: 2.5422 - val_accuracy20: 0.6730 - 41s/epoch - 32ms/step
Epoch 7/50
1290/1290 - 41s - loss: 2.1004 - accuracy20: 0.6507 - val_loss: 2.5184 - val_accuracy20: 0.6791 - 41s/epoch - 32ms/step
Epoch 8/50
1290/1290 - 43s - loss: 2.0808 - accuracy20: 0.6524 - val_loss: 2.4798 - val_accuracy20: 0.6962 - 43s/epoch - 33ms/step
Epoch 9/50
1290/1290 - 41s - loss: 2.0656 - accuracy20: 0.6550 - val_loss: 2.4412 - val_accuracy20: 0.6937 - 41s/epoch - 31ms/step
Epoch 10/50
1290/1290 - 42s - loss: 2.0530 - accuracy20: 0.6563 - val_loss: 2.4889 - val_accuracy20: 0.6961 - 42s/epoch - 33ms/step
Epoch 11/50
1290/1290 - 40s - loss: 2.0431 - accuracy20: 0.6599 - val_loss: 2.4980 - val_accuracy20: 0.7036 - 40s/epoch - 31ms/step
Epoch 12/50
1290/1290 - 42s - loss: 2.0337 - accuracy20: 0.6601 - val_loss: 2.4384 - val_accuracy20: 0.7046 - 42s/epoch - 33ms/step
Epoch 13/50
1290/1290 - 40s - loss: 2.0243 - accuracy20: 0.6607 - val_loss: 2.4730 - val_accuracy20: 0.7114 - 40s/epoch - 31ms/step
Epoch 14/50
1290/1290 - 42s - loss: 2.0165 - accuracy20: 0.6620 - val_loss: 2.4231 - val_accuracy20: 0.7055 - 42s/epoch - 33ms/step
Epoch 15/50
1290/1290 - 43s - loss: 2.0074 - accuracy20: 0.6634 - val_loss: 2.4100 - val_accuracy20: 0.6982 - 43s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 44s - loss: 2.0015 - accuracy20: 0.6632 - val_loss: 2.4393 - val_accuracy20: 0.7086 - 44s/epoch - 34ms/step
Epoch 17/50
1290/1290 - 42s - loss: 1.9960 - accuracy20: 0.6645 - val_loss: 2.4497 - val_accuracy20: 0.7131 - 42s/epoch - 32ms/step
Epoch 18/50
1290/1290 - 42s - loss: 1.9883 - accuracy20: 0.6651 - val_loss: 2.4731 - val_accuracy20: 0.7121 - 42s/epoch - 33ms/step
Epoch 19/50
1290/1290 - 40s - loss: 1.9832 - accuracy20: 0.6664 - val_loss: 2.4754 - val_accuracy20: 0.7099 - 40s/epoch - 31ms/step
Epoch 20/50
1290/1290 - 42s - loss: 1.9788 - accuracy20: 0.6658 - val_loss: 2.5188 - val_accuracy20: 0.7097 - 42s/epoch - 33ms/step
Epoch 21/50
1290/1290 - 43s - loss: 1.9736 - accuracy20: 0.6666 - val_loss: 2.5506 - val_accuracy20: 0.7081 - 43s/epoch - 33ms/step
Epoch 22/50
1290/1290 - 42s - loss: 1.9672 - accuracy20: 0.6676 - val_loss: 2.5641 - val_accuracy20: 0.7097 - 42s/epoch - 33ms/step
Epoch 23/50
1290/1290 - 44s - loss: 1.9613 - accuracy20: 0.6674 - val_loss: 2.5785 - val_accuracy20: 0.7073 - 44s/epoch - 34ms/step
Epoch 24/50
1290/1290 - 42s - loss: 1.9577 - accuracy20: 0.6683 - val_loss: 2.5631 - val_accuracy20: 0.7125 - 42s/epoch - 33ms/step
Epoch 25/50
1290/1290 - 42s - loss: 1.9542 - accuracy20: 0.6683 - val_loss: 2.5348 - val_accuracy20: 0.7093 - 42s/epoch - 33ms/step
testing model: results/EXC/W1/deepLOB_L1/h20
Evaluating performance on  test set...
5343/5343 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7033498
{'0': {'precision': 0.4712698758440427, 'recall': 0.5429310557220877, 'f1-score': 0.5045687560687073, 'support': 219177}, '1': {'precision': 0.765472924471715, 'recall': 0.8397061266403902, 'f1-score': 0.8008730291002841, 'support': 927066}, '2': {'precision': 0.5414793417010803, 'recall': 0.2402886985095646, 'f1-score': 0.3328643781654474, 'support': 221546}, 'accuracy': 0.6950604223312221, 'macro avg': {'precision': 0.5927407140056126, 'recall': 0.5409752936240142, 'f1-score': 0.546102054444813, 'support': 1367789}, 'weighted avg': {'precision': 0.6820481975017142, 'recall': 0.6950604223312221, 'f1-score': 0.6775875470337875, 'support': 1367789}}
[[118998  88149  12030]
 [115554 778463  33049]
 [ 17953 150358  53235]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65197384
{'0': {'precision': 0.4248671693550953, 'recall': 0.5960143714712905, 'f1-score': 0.4960946569706426, 'support': 44811}, '1': {'precision': 0.8755808838030128, 'recall': 0.7239454638955436, 'f1-score': 0.7925756396759281, 'support': 239181}, '2': {'precision': 0.43094772557363853, 'recall': 0.6490202446681823, 'f1-score': 0.5179668397542789, 'support': 46185}, 'accuracy': 0.6961023935646637, 'macro avg': {'precision': 0.5771319262439155, 'recall': 0.6563266933450055, 'f1-score': 0.6022123788002832, 'support': 330177}, 'weighted avg': {'precision': 0.7522157957715955, 'recall': 0.6961023935646637, 'f1-score': 0.7139256527283578, 'support': 330177}}
[[ 26708  11848   6255]
 [ 32701 173154  33326]
 [  3453  12757  29975]]
Evaluating performance on  val set...
363/363 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65965873
{'0': {'precision': 0.42696696696696695, 'recall': 0.5584884908476707, 'f1-score': 0.48395112154940606, 'support': 12729}, '1': {'precision': 0.8698746306236995, 'recall': 0.7367275312097383, 'f1-score': 0.7977838002533716, 'support': 67527}, '2': {'precision': 0.41809188022943744, 'recall': 0.6311566571337782, 'f1-score': 0.5029913582982495, 'support': 12588}, 'accuracy': 0.6979772521649218, 'macro avg': {'precision': 0.5716444926067012, 'recall': 0.6421242263970625, 'f1-score': 0.5949087600336757, 'support': 92844}, 'weighted avg': {'precision': 0.7478978425420839, 'recall': 0.6979772521649218, 'f1-score': 0.7147884163130646, 'support': 92844}}
[[ 7109  3797  1823]
 [ 8543 49749  9235]
 [  998  3645  7945]]
training model: results/EXC/W1/deepLOB_L1/h30
Epoch 1/50
1290/1290 - 48s - loss: 2.8023 - accuracy30: 0.4702 - val_loss: 3.1230 - val_accuracy30: 0.5284 - 48s/epoch - 37ms/step
Epoch 2/50
1290/1290 - 44s - loss: 2.6003 - accuracy30: 0.5379 - val_loss: 2.8826 - val_accuracy30: 0.5563 - 44s/epoch - 34ms/step
Epoch 3/50
1290/1290 - 40s - loss: 2.4172 - accuracy30: 0.6034 - val_loss: 2.8357 - val_accuracy30: 0.5945 - 40s/epoch - 31ms/step
Epoch 4/50
1290/1290 - 45s - loss: 2.3245 - accuracy30: 0.6234 - val_loss: 2.7667 - val_accuracy30: 0.6163 - 45s/epoch - 35ms/step
Epoch 5/50
1290/1290 - 44s - loss: 2.2762 - accuracy30: 0.6280 - val_loss: 2.7309 - val_accuracy30: 0.6457 - 44s/epoch - 34ms/step
Epoch 6/50
1290/1290 - 45s - loss: 2.2443 - accuracy30: 0.6316 - val_loss: 2.7077 - val_accuracy30: 0.6384 - 45s/epoch - 35ms/step
Epoch 7/50
1290/1290 - 44s - loss: 2.2163 - accuracy30: 0.6356 - val_loss: 2.7271 - val_accuracy30: 0.6540 - 44s/epoch - 34ms/step
Epoch 8/50
1290/1290 - 47s - loss: 2.1985 - accuracy30: 0.6376 - val_loss: 2.7510 - val_accuracy30: 0.6529 - 47s/epoch - 36ms/step
Epoch 9/50
1290/1290 - 46s - loss: 2.1866 - accuracy30: 0.6388 - val_loss: 2.7230 - val_accuracy30: 0.6485 - 46s/epoch - 35ms/step
Epoch 10/50
1290/1290 - 45s - loss: 2.1724 - accuracy30: 0.6408 - val_loss: 2.7423 - val_accuracy30: 0.6509 - 45s/epoch - 35ms/step
Epoch 11/50
1290/1290 - 46s - loss: 2.1654 - accuracy30: 0.6406 - val_loss: 2.7523 - val_accuracy30: 0.6547 - 46s/epoch - 35ms/step
Epoch 12/50
1290/1290 - 47s - loss: 2.1552 - accuracy30: 0.6431 - val_loss: 2.7198 - val_accuracy30: 0.6516 - 47s/epoch - 36ms/step
Epoch 13/50
1290/1290 - 43s - loss: 2.1479 - accuracy30: 0.6435 - val_loss: 2.7374 - val_accuracy30: 0.6451 - 43s/epoch - 33ms/step
Epoch 14/50
1290/1290 - 45s - loss: 2.1416 - accuracy30: 0.6439 - val_loss: 2.7556 - val_accuracy30: 0.6519 - 45s/epoch - 35ms/step
Epoch 15/50
1290/1290 - 45s - loss: 2.1364 - accuracy30: 0.6450 - val_loss: 2.7661 - val_accuracy30: 0.6535 - 45s/epoch - 35ms/step
Epoch 16/50
1290/1290 - 47s - loss: 2.1311 - accuracy30: 0.6468 - val_loss: 2.7546 - val_accuracy30: 0.6511 - 47s/epoch - 37ms/step
testing model: results/EXC/W1/deepLOB_L1/h30
Evaluating performance on  test set...
5343/5343 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8219167
{'0': {'precision': 0.4966064276242943, 'recall': 0.541590261937773, 'f1-score': 0.5181237966198389, 'support': 268308}, '1': {'precision': 0.699578961639564, 'recall': 0.7843543405877528, 'f1-score': 0.7395450918478134, 'support': 828920}, '2': {'precision': 0.49495912432788325, 'recall': 0.26673836953589025, 'f1-score': 0.34665885308464367, 'support': 270561}, 'accuracy': 0.6343441861281236, 'macro avg': {'precision': 0.5637148378639139, 'recall': 0.530894324020472, 'f1-score': 0.5347759138507653, 'support': 1367789}, 'weighted avg': {'precision': 0.6192878476889074, 'recall': 0.6343441861281236, 'f1-score': 0.6183942429039855, 'support': 1367789}}
[[145313 109254  13741]
 [118855 650167  59898]
 [ 28444 169948  72169]]
Evaluating performance on  train set...
1290/1290 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74753666
{'0': {'precision': 0.42969350985869875, 'recall': 0.5822041801525043, 'f1-score': 0.4944558330227357, 'support': 54687}, '1': {'precision': 0.7985083232001342, 'recall': 0.6946837082263676, 'f1-score': 0.7429864496133861, 'support': 219307}, '2': {'precision': 0.4749877465996814, 'recall': 0.5519641172596693, 'f1-score': 0.5105910052605149, 'support': 56183}, 'accuracy': 0.6517685968435112, 'macro avg': {'precision': 0.5677298598861714, 'recall': 0.609617335212847, 'f1-score': 0.5826777626322123, 'support': 330177}, 'weighted avg': {'precision': 0.6823714261650702, 'recall': 0.6517685968435112, 'f1-score': 0.6622780202571007, 'support': 330177}}
[[ 31839  17841   5007]
 [ 37688 152349  29270]
 [  4570  20602  31011]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76549846
{'0': {'precision': 0.41881064941527746, 'recall': 0.5433884297520661, 'f1-score': 0.47303487620492934, 'support': 15488}, '1': {'precision': 0.792686561603517, 'recall': 0.6857083004334724, 'f1-score': 0.7353268993165656, 'support': 62057}, '2': {'precision': 0.43635600776210204, 'recall': 0.5438263938819531, 'f1-score': 0.484199499505325, 'support': 15299}, 'accuracy': 0.6385873077420189, 'macro avg': {'precision': 0.5492844062602988, 'recall': 0.5909743746891638, 'f1-score': 0.5641870916756067, 'support': 92844}, 'weighted avg': {'precision': 0.6716007480755426, 'recall': 0.6385873077420189, 'f1-score': 0.6501907898892983, 'support': 92844}}
[[ 8416  5474  1598]
 [10355 42553  9149]
 [ 1324  5655  8320]]
training model: results/EXC/W1/deepLOB_L1/h50
Epoch 1/50
1290/1290 - 55s - loss: 2.9066 - accuracy50: 0.4765 - val_loss: 3.2169 - val_accuracy50: 0.4943 - 55s/epoch - 42ms/step
Epoch 2/50
1290/1290 - 53s - loss: 2.7709 - accuracy50: 0.5148 - val_loss: 3.1046 - val_accuracy50: 0.5269 - 53s/epoch - 41ms/step
Epoch 3/50
1290/1290 - 51s - loss: 2.6192 - accuracy50: 0.5694 - val_loss: 3.0221 - val_accuracy50: 0.5603 - 51s/epoch - 39ms/step
Epoch 4/50
1290/1290 - 48s - loss: 2.5331 - accuracy50: 0.5868 - val_loss: 3.0527 - val_accuracy50: 0.5747 - 48s/epoch - 37ms/step
Epoch 5/50
1290/1290 - 46s - loss: 2.4902 - accuracy50: 0.5928 - val_loss: 2.9306 - val_accuracy50: 0.5940 - 46s/epoch - 36ms/step
Epoch 6/50
1290/1290 - 46s - loss: 2.4615 - accuracy50: 0.5985 - val_loss: 2.9146 - val_accuracy50: 0.5979 - 46s/epoch - 36ms/step
Epoch 7/50
1290/1290 - 49s - loss: 2.4387 - accuracy50: 0.6018 - val_loss: 2.9301 - val_accuracy50: 0.6028 - 49s/epoch - 38ms/step
Epoch 8/50
1290/1290 - 48s - loss: 2.4267 - accuracy50: 0.6035 - val_loss: 2.9853 - val_accuracy50: 0.6039 - 48s/epoch - 37ms/step
Epoch 9/50
1290/1290 - 48s - loss: 2.4139 - accuracy50: 0.6046 - val_loss: 2.9868 - val_accuracy50: 0.6089 - 48s/epoch - 37ms/step
Epoch 10/50
1290/1290 - 48s - loss: 2.4037 - accuracy50: 0.6067 - val_loss: 2.9965 - val_accuracy50: 0.6025 - 48s/epoch - 37ms/step
Epoch 11/50
1290/1290 - 49s - loss: 2.3940 - accuracy50: 0.6083 - val_loss: 2.9846 - val_accuracy50: 0.6010 - 49s/epoch - 38ms/step
Epoch 12/50
1290/1290 - 50s - loss: 2.3866 - accuracy50: 0.6087 - val_loss: 2.9455 - val_accuracy50: 0.6064 - 50s/epoch - 39ms/step
Epoch 13/50
1290/1290 - 46s - loss: 2.3873 - accuracy50: 0.6085 - val_loss: 2.9744 - val_accuracy50: 0.6056 - 46s/epoch - 35ms/step
Epoch 14/50
1290/1290 - 49s - loss: 2.3780 - accuracy50: 0.6098 - val_loss: 3.0258 - val_accuracy50: 0.5982 - 49s/epoch - 38ms/step
Epoch 15/50
1290/1290 - 50s - loss: 2.3699 - accuracy50: 0.6110 - val_loss: 3.0017 - val_accuracy50: 0.5988 - 50s/epoch - 39ms/step
Epoch 16/50
1290/1290 - 47s - loss: 2.3655 - accuracy50: 0.6113 - val_loss: 3.0551 - val_accuracy50: 0.5943 - 47s/epoch - 37ms/step
testing model: results/EXC/W1/deepLOB_L1/h50
Evaluating performance on  test set...
5343/5343 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9795832
{'0': {'precision': 0.516950790921833, 'recall': 0.43237756987756987, 'f1-score': 0.4708969750716215, 'support': 346320}, '1': {'precision': 0.5528713376560999, 'recall': 0.7660835306666349, 'f1-score': 0.642244304984563, 'support': 673142}, '2': {'precision': 0.4912202268365992, 'recall': 0.2050343499068404, 'f1-score': 0.2893109021749258, 'support': 348327}, 'accuracy': 0.5387110146374916, 'macro avg': {'precision': 0.5203474518048441, 'recall': 0.467831816817015, 'f1-score': 0.4674840607437034, 'support': 1367789}, 'weighted avg': {'precision': 0.5280760291520576, 'recall': 0.5387110146374916, 'f1-score': 0.5089801533530449, 'support': 1367789}}
[[149741 178660  17919]
 [101406 515683  56053]
 [ 38515 238393  71419]]
Evaluating performance on  train set...
1290/1290 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83545077
{'0': {'precision': 0.48140900195694714, 'recall': 0.5167040390565127, 'f1-score': 0.4984324731330002, 'support': 70462}, '1': {'precision': 0.6884506177576548, 'recall': 0.717872117959606, 'f1-score': 0.7028536061151315, 'support': 187454}, '2': {'precision': 0.547017805158757, 'recall': 0.4472675440417376, 'f1-score': 0.4921390231832197, 'support': 72261}, 'accuracy': 0.6157182359764611, 'macro avg': {'precision': 0.5722924749577863, 'recall': 0.5606145670192855, 'f1-score': 0.5644750341437837, 'support': 330177}, 'weighted avg': {'precision': 0.6133132132632216, 'recall': 0.6157182359764611, 'f1-score': 0.6131127448515371, 'support': 330177}}
[[ 36408  28132   5922]
 [ 32044 134568  20842]
 [  7176  32765  32320]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8631181
{'0': {'precision': 0.46586386893379506, 'recall': 0.4544262956241178, 'f1-score': 0.46007400791119046, 'support': 19836}, '1': {'precision': 0.6800973253681477, 'recall': 0.7011943986820428, 'f1-score': 0.6904847496059509, 'support': 53416}, '2': {'precision': 0.4826837476929758, 'recall': 0.453858717844018, 'f1-score': 0.46782764244751934, 'support': 19592}, 'accuracy': 0.5962797811382534, 'macro avg': {'precision': 0.5428816473316395, 'recall': 0.5364931373833929, 'f1-score': 0.5394621333215536, 'support': 92844}, 'weighted avg': {'precision': 0.5926682868126806, 'recall': 0.5962797811382534, 'f1-score': 0.594272549402327, 'support': 92844}}
[[ 9014  8767  2055]
 [ 8486 37455  7475]
 [ 1849  8851  8892]]
training model: results/EXC/W1/deepLOB_L1/h100
Epoch 1/50
1290/1290 - 57s - loss: 3.1231 - accuracy100: 0.4451 - val_loss: 3.3211 - val_accuracy100: 0.4031 - 57s/epoch - 44ms/step
Epoch 2/50
1290/1290 - 50s - loss: 3.0454 - accuracy100: 0.4715 - val_loss: 3.3183 - val_accuracy100: 0.4058 - 50s/epoch - 39ms/step
Epoch 3/50
1290/1290 - 48s - loss: 2.9993 - accuracy100: 0.4926 - val_loss: 3.2777 - val_accuracy100: 0.4297 - 48s/epoch - 37ms/step
Epoch 4/50
1290/1290 - 49s - loss: 2.9591 - accuracy100: 0.5046 - val_loss: 3.2580 - val_accuracy100: 0.4518 - 49s/epoch - 38ms/step
Epoch 5/50
1290/1290 - 51s - loss: 2.9190 - accuracy100: 0.5158 - val_loss: 3.3433 - val_accuracy100: 0.4411 - 51s/epoch - 40ms/step
Epoch 6/50
1290/1290 - 49s - loss: 2.8950 - accuracy100: 0.5211 - val_loss: 3.2938 - val_accuracy100: 0.4610 - 49s/epoch - 38ms/step
Epoch 7/50
1290/1290 - 50s - loss: 2.8774 - accuracy100: 0.5252 - val_loss: 3.2489 - val_accuracy100: 0.4639 - 50s/epoch - 39ms/step
Epoch 8/50
1290/1290 - 50s - loss: 2.8650 - accuracy100: 0.5275 - val_loss: 3.2147 - val_accuracy100: 0.4710 - 50s/epoch - 39ms/step
Epoch 9/50
1290/1290 - 53s - loss: 2.8544 - accuracy100: 0.5283 - val_loss: 3.2040 - val_accuracy100: 0.4749 - 53s/epoch - 41ms/step
Epoch 10/50
1290/1290 - 50s - loss: 2.8440 - accuracy100: 0.5310 - val_loss: 3.3118 - val_accuracy100: 0.4581 - 50s/epoch - 39ms/step
Epoch 11/50
1290/1290 - 48s - loss: 2.8347 - accuracy100: 0.5328 - val_loss: 3.2431 - val_accuracy100: 0.4704 - 48s/epoch - 37ms/step
Epoch 12/50
1290/1290 - 51s - loss: 2.8280 - accuracy100: 0.5343 - val_loss: 3.2483 - val_accuracy100: 0.4746 - 51s/epoch - 39ms/step
Epoch 13/50
1290/1290 - 52s - loss: 2.8212 - accuracy100: 0.5363 - val_loss: 3.2023 - val_accuracy100: 0.4719 - 52s/epoch - 40ms/step
Epoch 14/50
1290/1290 - 51s - loss: 2.8140 - accuracy100: 0.5368 - val_loss: 3.2356 - val_accuracy100: 0.4702 - 51s/epoch - 39ms/step
Epoch 15/50
1290/1290 - 50s - loss: 2.8086 - accuracy100: 0.5386 - val_loss: 3.2864 - val_accuracy100: 0.4585 - 50s/epoch - 39ms/step
Epoch 16/50
1290/1290 - 50s - loss: 2.8053 - accuracy100: 0.5384 - val_loss: 3.2191 - val_accuracy100: 0.4744 - 50s/epoch - 39ms/step
Epoch 17/50
1290/1290 - 50s - loss: 2.7994 - accuracy100: 0.5397 - val_loss: 3.2861 - val_accuracy100: 0.4613 - 50s/epoch - 38ms/step
Epoch 18/50
1290/1290 - 51s - loss: 2.7946 - accuracy100: 0.5413 - val_loss: 3.2641 - val_accuracy100: 0.4656 - 51s/epoch - 40ms/step
Epoch 19/50
1290/1290 - 55s - loss: 2.7901 - accuracy100: 0.5410 - val_loss: 3.2427 - val_accuracy100: 0.4676 - 55s/epoch - 42ms/step
Epoch 20/50
1290/1290 - 54s - loss: 2.7866 - accuracy100: 0.5421 - val_loss: 3.2811 - val_accuracy100: 0.4636 - 54s/epoch - 42ms/step
Epoch 21/50
1290/1290 - 54s - loss: 2.7822 - accuracy100: 0.5424 - val_loss: 3.2378 - val_accuracy100: 0.4658 - 54s/epoch - 42ms/step
Epoch 22/50
1290/1290 - 53s - loss: 2.7772 - accuracy100: 0.5439 - val_loss: 3.2843 - val_accuracy100: 0.4505 - 53s/epoch - 41ms/step
Epoch 23/50
1290/1290 - 53s - loss: 2.7752 - accuracy100: 0.5443 - val_loss: 3.3508 - val_accuracy100: 0.4524 - 53s/epoch - 41ms/step
testing model: results/EXC/W1/deepLOB_L1/h100
Evaluating performance on  test set...
5343/5343 - 82s - 82s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1340853
{'0': {'precision': 0.47503396092272143, 'recall': 0.4056746969664115, 'f1-score': 0.4376231717943169, 'support': 461170}, '1': {'precision': 0.35800329307379614, 'recall': 0.6627824411599761, 'f1-score': 0.46489344153083817, 'support': 442216}, '2': {'precision': 0.4856890755220074, 'recall': 0.16238267194656364, 'f1-score': 0.243391229833992, 'support': 464403}, 'accuracy': 0.40619496135734384, 'macro avg': {'precision': 0.43957544317284164, 'recall': 0.4102799366909838, 'f1-score': 0.38196928105304906, 'support': 1367789}, 'weighted avg': {'precision': 0.4408148184758761, 'recall': 0.40619496135734384, 'f1-score': 0.3804926151511539, 'support': 1367789}}
[[187085 233064  41021]
 [110289 293093  38834]
 [ 96461 292531  75411]]
Evaluating performance on  train set...
1290/1290 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0430943
{'0': {'precision': 0.45177343467245745, 'recall': 0.5120185405471922, 'f1-score': 0.4800130746601549, 'support': 97516}, '1': {'precision': 0.4703264884030137, 'recall': 0.5975659198750676, 'f1-score': 0.5263659119692345, 'support': 133192}, '2': {'precision': 0.5863340736040609, 'recall': 0.2972785490956982, 'f1-score': 0.39452705452265163, 'support': 99469}, 'accuracy': 0.48183550035284106, 'macro avg': {'precision': 0.5028113322265106, 'recall': 0.468954336505986, 'f1-score': 0.4669686803840137, 'support': 330177}, 'weighted avg': {'precision': 0.4997953457273398, 'recall': 0.48183550035284106, 'f1-score': 0.47295812585940145, 'support': 330177}}
[[49930 39306  8280]
 [41019 79591 12582]
 [19571 50328 29570]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0491425
{'0': {'precision': 0.43319492844961816, 'recall': 0.43228145462616996, 'f1-score': 0.43273770947134527, 'support': 27031}, '1': {'precision': 0.4807513483355031, 'recall': 0.5915331807780321, 'f1-score': 0.5304196162921925, 'support': 39330}, '2': {'precision': 0.5012301882474108, 'recall': 0.3307782350942114, 'f1-score': 0.3985441310282074, 'support': 26483}, 'accuracy': 0.4707897117745896, 'macro avg': {'precision': 0.4717254883441773, 'recall': 0.4515309568328045, 'f1-score': 0.4539004855972484, 'support': 92844}, 'weighted avg': {'precision': 0.4727469919037649, 'recall': 0.4707897117745896, 'f1-score': 0.46436367191753786, 'support': 92844}}
[[11685 11938  3408]
 [10756 23265  5309]
 [ 4533 13190  8760]]
training model: results/EXC/W1/deepLOB_L1/h200
Epoch 1/50
1290/1290 - 59s - loss: 3.2449 - accuracy200: 0.4062 - val_loss: 3.3458 - val_accuracy200: 0.3684 - 59s/epoch - 45ms/step
Epoch 2/50
1290/1290 - 55s - loss: 3.2057 - accuracy200: 0.4177 - val_loss: 3.4640 - val_accuracy200: 0.3653 - 55s/epoch - 43ms/step
Epoch 3/50
1290/1290 - 54s - loss: 3.1973 - accuracy200: 0.4208 - val_loss: 3.4483 - val_accuracy200: 0.3583 - 54s/epoch - 41ms/step
Epoch 4/50
1290/1290 - 56s - loss: 3.1880 - accuracy200: 0.4238 - val_loss: 3.4377 - val_accuracy200: 0.3693 - 56s/epoch - 43ms/step
Epoch 5/50
1290/1290 - 52s - loss: 3.1802 - accuracy200: 0.4297 - val_loss: 3.5010 - val_accuracy200: 0.3524 - 52s/epoch - 40ms/step
Epoch 6/50
1290/1290 - 52s - loss: 3.1735 - accuracy200: 0.4319 - val_loss: 3.4907 - val_accuracy200: 0.3563 - 52s/epoch - 41ms/step
Epoch 7/50
1290/1290 - 55s - loss: 3.1681 - accuracy200: 0.4338 - val_loss: 3.4697 - val_accuracy200: 0.3556 - 55s/epoch - 43ms/step
Epoch 8/50
1290/1290 - 54s - loss: 3.1629 - accuracy200: 0.4359 - val_loss: 3.4141 - val_accuracy200: 0.3608 - 54s/epoch - 42ms/step
Epoch 9/50
1290/1290 - 54s - loss: 3.1588 - accuracy200: 0.4368 - val_loss: 3.4323 - val_accuracy200: 0.3581 - 54s/epoch - 42ms/step
Epoch 10/50
1290/1290 - 56s - loss: 3.1536 - accuracy200: 0.4392 - val_loss: 3.4266 - val_accuracy200: 0.3612 - 56s/epoch - 43ms/step
Epoch 11/50
1290/1290 - 52s - loss: 3.1484 - accuracy200: 0.4398 - val_loss: 3.4207 - val_accuracy200: 0.3595 - 52s/epoch - 41ms/step
testing model: results/EXC/W1/deepLOB_L1/h200
Evaluating performance on  test set...
5343/5343 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1386817
{'0': {'precision': 0.3959175972332132, 'recall': 0.45002394486434716, 'f1-score': 0.4212404523989109, 'support': 480270}, '1': {'precision': 0.3013204504219105, 'recall': 0.5204662071915892, 'f1-score': 0.38167354149016014, 'support': 402053}, '2': {'precision': 0.41678634490876987, 'recall': 0.10939798049708939, 'f1-score': 0.1733065096403765, 'support': 485466}, 'accuracy': 0.3498324668497846, 'macro avg': {'precision': 0.3713414641879645, 'recall': 0.3599627108510086, 'f1-score': 0.32540683450981583, 'support': 1367789}, 'weighted avg': {'precision': 0.37551825259170574, 'recall': 0.3498324668497846, 'f1-score': 0.3216114199335155, 'support': 1367789}}
[[216133 226517  37620]
 [156102 209255  36696]
 [173669 258688  53109]]
Evaluating performance on  train set...
1290/1290 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1262196
{'0': {'precision': 0.37510353520196865, 'recall': 0.5732841653365622, 'f1-score': 0.45348735959132735, 'support': 109014}, '1': {'precision': 0.3300319365885567, 'recall': 0.39261029176164713, 'f1-score': 0.35861157798794197, 'support': 109233}, '2': {'precision': 0.4591041579917911, 'recall': 0.1379076208344501, 'f1-score': 0.2121028910629878, 'support': 111930}, 'accuracy': 0.3659188859308795, 'macro avg': {'precision': 0.38807987659410553, 'recall': 0.36793402597755315, 'f1-score': 0.3414006095474191, 'support': 330177}, 'weighted avg': {'precision': 0.38866863445941535, 'recall': 0.3659188859308795, 'f1-score': 0.3402701160696416, 'support': 330177}}
[[62496 38909  7609]
 [55770 42886 10577]
 [48344 48150 15436]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1171165
{'0': {'precision': 0.3698094328466821, 'recall': 0.5367173834119938, 'f1-score': 0.43789802485425394, 'support': 30299}, '1': {'precision': 0.35176974524686255, 'recall': 0.42729347329986306, 'f1-score': 0.38587090924078804, 'support': 32865}, '2': {'precision': 0.4235110068164041, 'recall': 0.1276954177897574, 'f1-score': 0.1962256335913433, 'support': 29680}, 'accuracy': 0.3672289000904743, 'macro avg': {'precision': 0.3816967283033163, 'recall': 0.36390209150053804, 'f1-score': 0.3399981892287951, 'support': 92844}, 'weighted avg': {'precision': 0.38059083371753294, 'recall': 0.3672289000904743, 'f1-score': 0.3422245540072445, 'support': 92844}}
[[16262 12059  1978]
 [15641 14043  3181]
 [12071 13819  3790]]
training model: results/EXC/W1/deepLOB_L1/h300
Epoch 1/50
1290/1290 - 60s - loss: 3.2698 - accuracy300: 0.3936 - val_loss: 3.3530 - val_accuracy300: 0.3580 - 60s/epoch - 46ms/step
Epoch 2/50
1290/1290 - 57s - loss: 3.2288 - accuracy300: 0.4078 - val_loss: 3.3839 - val_accuracy300: 0.3565 - 57s/epoch - 44ms/step
Epoch 3/50
1290/1290 - 54s - loss: 3.2118 - accuracy300: 0.4143 - val_loss: 3.4661 - val_accuracy300: 0.3454 - 54s/epoch - 42ms/step
Epoch 4/50
1290/1290 - 56s - loss: 3.2027 - accuracy300: 0.4191 - val_loss: 3.4664 - val_accuracy300: 0.3507 - 56s/epoch - 44ms/step
Epoch 5/50
1290/1290 - 55s - loss: 3.1951 - accuracy300: 0.4231 - val_loss: 3.4783 - val_accuracy300: 0.3504 - 55s/epoch - 43ms/step
Epoch 6/50
1290/1290 - 54s - loss: 3.1898 - accuracy300: 0.4261 - val_loss: 3.4099 - val_accuracy300: 0.3543 - 54s/epoch - 42ms/step
Epoch 7/50
1290/1290 - 54s - loss: 3.1849 - accuracy300: 0.4294 - val_loss: 3.5437 - val_accuracy300: 0.3525 - 54s/epoch - 42ms/step
Epoch 8/50
1290/1290 - 55s - loss: 3.1790 - accuracy300: 0.4317 - val_loss: 3.5123 - val_accuracy300: 0.3531 - 55s/epoch - 43ms/step
Epoch 9/50
1290/1290 - 54s - loss: 3.1760 - accuracy300: 0.4325 - val_loss: 3.4538 - val_accuracy300: 0.3543 - 54s/epoch - 42ms/step
Epoch 10/50
1290/1290 - 56s - loss: 3.1714 - accuracy300: 0.4341 - val_loss: 3.4376 - val_accuracy300: 0.3529 - 56s/epoch - 44ms/step
Epoch 11/50
1290/1290 - 57s - loss: 3.1674 - accuracy300: 0.4362 - val_loss: 3.4576 - val_accuracy300: 0.3513 - 57s/epoch - 44ms/step
testing model: results/EXC/W1/deepLOB_L1/h300
Evaluating performance on  test set...
5343/5343 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.122109
{'0': {'precision': 0.34475913441695, 'recall': 0.3542936524322917, 'f1-score': 0.3494613718443518, 'support': 445588}, '1': {'precision': 0.3437752339689859, 'recall': 0.4872088850954689, 'f1-score': 0.40311323555504025, 'support': 470991}, '2': {'precision': 0.3488437338834451, 'recall': 0.187387247623058, 'f1-score': 0.2438086175450738, 'support': 451210}, 'accuracy': 0.34500277455075307, 'macro avg': {'precision': 0.34579270075646035, 'recall': 0.3429632617169395, 'f1-score': 0.33212774164815523, 'support': 1367789}, 'weighted avg': {'precision': 0.3457677723496942, 'recall': 0.34500277455075307, 'f1-score': 0.33308308957536414, 'support': 1367789}}
[[157869 215727  71992]
 [155688 229471  85832]
 [144354 222305  84551]]
Evaluating performance on  train set...
1290/1290 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1403084
{'0': {'precision': 0.34738473881383475, 'recall': 0.4697731723687719, 'f1-score': 0.39941369606003757, 'support': 108761}, '1': {'precision': 0.33261806851926895, 'recall': 0.4592888856272704, 'f1-score': 0.3858225546064368, 'support': 109012}, '2': {'precision': 0.43096619692364374, 'recall': 0.12487989751254404, 'f1-score': 0.1936471805483704, 'support': 112404}, 'accuracy': 0.3488977124390857, 'macro avg': {'precision': 0.37032300141891583, 'recall': 0.3513139851695288, 'f1-score': 0.3262944770716149, 'support': 330177}, 'weighted avg': {'precision': 0.3709634434335501, 'recall': 0.3488977124390857, 'f1-score': 0.3248761694554789, 'support': 330177}}
[[51093 48688  8980]
 [49390 50068  9554]
 [46596 51771 14037]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1193763
{'0': {'precision': 0.34714199837955095, 'recall': 0.43917600767119663, 'f1-score': 0.3877729767604811, 'support': 30243}, '1': {'precision': 0.36511297675693183, 'recall': 0.4407686986857538, 'f1-score': 0.39938957924569435, 'support': 33251}, '2': {'precision': 0.3711397313391497, 'recall': 0.1826235093696763, 'f1-score': 0.24479356960175372, 'support': 29350}, 'accuracy': 0.35864460815992416, 'macro avg': {'precision': 0.3611315688252108, 'recall': 0.35418940524220893, 'f1-score': 0.3439853752026431, 'support': 92844}, 'weighted avg': {'precision': 0.36116429884474543, 'recall': 0.35864460815992416, 'f1-score': 0.34673443952735, 'support': 92844}}
[[13282 12716  4245]
 [13758 14656  4837]
 [11221 12769  5360]]
training model: results/EXC/W1/deepLOB_L1/h500
Epoch 1/50
1290/1290 - 66s - loss: 3.2816 - accuracy500: 0.3845 - val_loss: 3.4482 - val_accuracy500: 0.3449 - 66s/epoch - 51ms/step
Epoch 2/50
1290/1290 - 59s - loss: 3.2448 - accuracy500: 0.4015 - val_loss: 3.5557 - val_accuracy500: 0.3430 - 59s/epoch - 46ms/step
Epoch 3/50
1290/1290 - 56s - loss: 3.2227 - accuracy500: 0.4134 - val_loss: 3.5479 - val_accuracy500: 0.3448 - 56s/epoch - 43ms/step
Epoch 4/50
1290/1290 - 58s - loss: 3.2085 - accuracy500: 0.4205 - val_loss: 3.5583 - val_accuracy500: 0.3422 - 58s/epoch - 45ms/step
Epoch 5/50
1290/1290 - 53s - loss: 3.2005 - accuracy500: 0.4243 - val_loss: 3.5284 - val_accuracy500: 0.3413 - 53s/epoch - 41ms/step
Epoch 6/50
1290/1290 - 60s - loss: 3.1929 - accuracy500: 0.4277 - val_loss: 3.5804 - val_accuracy500: 0.3418 - 60s/epoch - 47ms/step
Epoch 7/50
1290/1290 - 56s - loss: 3.1876 - accuracy500: 0.4290 - val_loss: 3.5918 - val_accuracy500: 0.3398 - 56s/epoch - 44ms/step
Epoch 8/50
1290/1290 - 59s - loss: 3.1822 - accuracy500: 0.4325 - val_loss: 3.5788 - val_accuracy500: 0.3411 - 59s/epoch - 46ms/step
Epoch 9/50
1290/1290 - 60s - loss: 3.1766 - accuracy500: 0.4344 - val_loss: 3.5302 - val_accuracy500: 0.3422 - 60s/epoch - 46ms/step
Epoch 10/50
1290/1290 - 54s - loss: 3.1732 - accuracy500: 0.4352 - val_loss: 3.6078 - val_accuracy500: 0.3407 - 54s/epoch - 42ms/step
Epoch 11/50
1290/1290 - 57s - loss: 3.1690 - accuracy500: 0.4376 - val_loss: 3.6444 - val_accuracy500: 0.3410 - 57s/epoch - 44ms/step
testing model: results/EXC/W1/deepLOB_L1/h500
Evaluating performance on  test set...
5343/5343 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1548353
{'0': {'precision': 0.33708058620571857, 'recall': 0.5333316037307527, 'f1-score': 0.41308182883036004, 'support': 462534}, '1': {'precision': 0.3179381368989161, 'recall': 0.241450881198439, 'f1-score': 0.27446532140347785, 'support': 438437}, '2': {'precision': 0.343343135216483, 'recall': 0.2228577304217061, 'f1-score': 0.2702810133784347, 'support': 466818}, 'accuracy': 0.33380806542529584, 'macro avg': {'precision': 0.3327872861070393, 'recall': 0.3325467384502993, 'f1-score': 0.3192760545374242, 'support': 1367789}, 'weighted avg': {'precision': 0.3330819523209458, 'recall': 0.33380806542529584, 'f1-score': 0.3199120513761205, 'support': 1367789}}
[[246684 112343 103507]
 [237114 105861  95462]
 [248027 114757 104034]]
Evaluating performance on  train set...
1290/1290 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1599181
{'0': {'precision': 0.3437422687761289, 'recall': 0.7542253585919458, 'f1-score': 0.47225278681913757, 'support': 108689}, '1': {'precision': 0.33484449644145464, 'recall': 0.19114182357851775, 'f1-score': 0.24336293636921913, 'support': 107810}, '2': {'precision': 0.4036943689062811, 'recall': 0.1070831647284435, 'f1-score': 0.1692669225207186, 'support': 113678}, 'accuracy': 0.3475590365167774, 'macro avg': {'precision': 0.3607603780412882, 'recall': 0.3508167822996357, 'f1-score': 0.2949608819030251, 'support': 330177}, 'weighted avg': {'precision': 0.361478107442039, 'recall': 0.3475590365167774, 'f1-score': 0.2931990009445267, 'support': 330177}}
[[81976 18050  8663]
 [77885 20607  9318]
 [78620 22885 12173]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1496615
{'0': {'precision': 0.3451238973747435, 'recall': 0.6416275430359938, 'f1-score': 0.4488283254461486, 'support': 30672}, '1': {'precision': 0.34105701640197866, 'recall': 0.2064357527813672, 'f1-score': 0.2571955864452036, 'support': 31729}, '2': {'precision': 0.3604959075589793, 'recall': 0.19676116020103143, 'f1-score': 0.25457404534732997, 'support': 30443}, 'accuracy': 0.3470337340054285, 'macro avg': {'precision': 0.34889227377856713, 'recall': 0.34827481867279747, 'f1-score': 0.32019931907956073, 'support': 92844}, 'weighted avg': {'precision': 0.34877445141866487, 'recall': 0.3470337340054285, 'f1-score': 0.3196439061534714, 'support': 92844}}
[[19680  5811  5181]
 [19734  6550  5445]
 [17609  6844  5990]]
training model: results/EXC/W1/deepLOB_L1/h1000
Epoch 1/50
1290/1290 - 67s - loss: 3.1864 - accuracy1000: 0.4427 - val_loss: 3.5014 - val_accuracy1000: 0.3320 - 67s/epoch - 52ms/step
Epoch 2/50
1290/1290 - 57s - loss: 3.1337 - accuracy1000: 0.4615 - val_loss: 3.8461 - val_accuracy1000: 0.3283 - 57s/epoch - 44ms/step
Epoch 3/50
1290/1290 - 61s - loss: 3.1284 - accuracy1000: 0.4619 - val_loss: 3.7566 - val_accuracy1000: 0.3281 - 61s/epoch - 48ms/step
Epoch 4/50
1290/1290 - 57s - loss: 3.1072 - accuracy1000: 0.4663 - val_loss: 4.0630 - val_accuracy1000: 0.3275 - 57s/epoch - 44ms/step
Epoch 5/50
1290/1290 - 57s - loss: 3.0899 - accuracy1000: 0.4741 - val_loss: 4.1226 - val_accuracy1000: 0.3261 - 57s/epoch - 44ms/step
Epoch 6/50
1290/1290 - 61s - loss: 3.0738 - accuracy1000: 0.4800 - val_loss: 4.4148 - val_accuracy1000: 0.3267 - 61s/epoch - 47ms/step
Epoch 7/50
1290/1290 - 60s - loss: 3.0602 - accuracy1000: 0.4850 - val_loss: 4.0953 - val_accuracy1000: 0.3250 - 60s/epoch - 47ms/step
Epoch 8/50
1290/1290 - 62s - loss: 3.0516 - accuracy1000: 0.4894 - val_loss: 4.0436 - val_accuracy1000: 0.3233 - 62s/epoch - 48ms/step
Epoch 9/50
1290/1290 - 58s - loss: 3.0440 - accuracy1000: 0.4908 - val_loss: 4.0426 - val_accuracy1000: 0.3199 - 58s/epoch - 45ms/step
Epoch 10/50
1290/1290 - 63s - loss: 3.0439 - accuracy1000: 0.4916 - val_loss: 4.0475 - val_accuracy1000: 0.3216 - 63s/epoch - 49ms/step
Epoch 11/50
1290/1290 - 62s - loss: 3.0327 - accuracy1000: 0.4946 - val_loss: 3.9528 - val_accuracy1000: 0.3188 - 62s/epoch - 48ms/step
testing model: results/EXC/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
5343/5343 - 94s - 94s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.251108
{'0': {'precision': 0.25506895308337374, 'recall': 0.5506464103836262, 'f1-score': 0.3486412442510708, 'support': 350706}, '1': {'precision': 0.4385642533382335, 'recall': 0.010755724869759588, 'f1-score': 0.020996513288505582, 'support': 665692}, '2': {'precision': 0.25100697564077973, 'recall': 0.42456124374272536, 'f1-score': 0.31549096215153133, 'support': 351391}, 'accuracy': 0.2554940857105884, 'macro avg': {'precision': 0.3148800606874624, 'recall': 0.3286544596653704, 'f1-score': 0.22837623989703593, 'support': 1367789}, 'weighted avg': {'precision': 0.3433311127452277, 'recall': 0.2554940857105884, 'f1-score': 0.18066271319023372, 'support': 1367789}}
[[193115   4199 153392]
 [366757   7160 291775]
 [197237   4967 149187]]
Evaluating performance on  train set...
1290/1290 - 29s - 29s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1854951
{'0': {'precision': 0.32464647773745753, 'recall': 0.8490072210663077, 'f1-score': 0.4696908537395213, 'support': 106217}, '1': {'precision': 0.41423199305756436, 'recall': 0.02615740106492771, 'f1-score': 0.04920750826854517, 'support': 109491}, '2': {'precision': 0.4457977004418845, 'recall': 0.17714839825629647, 'f1-score': 0.2535447247993198, 'support': 114469}, 'accuracy': 0.34321288278711115, 'macro avg': {'precision': 0.39489205707896885, 'recall': 0.350771006795844, 'f1-score': 0.25748102893579544, 'support': 330177}, 'weighted avg': {'precision': 0.39635609703155394, 'recall': 0.34321288278711115, 'f1-score': 0.2553174321728508, 'support': 330177}}
[[90179  1860 14178]
 [95596  2864 11031]
 [92001  2190 20278]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.168796
{'0': {'precision': 0.298757327080891, 'recall': 0.6592280895388543, 'f1-score': 0.41117373719989675, 'support': 28993}, '1': {'precision': 0.5, 'recall': 0.023536100056850483, 'f1-score': 0.044956021283526985, 'support': 35180}, '2': {'precision': 0.39815529342593614, 'recall': 0.3779079906525758, 'f1-score': 0.38776751843103574, 'support': 28671}, 'accuracy': 0.3314807634311318, 'macro avg': {'precision': 0.39897087350227567, 'recall': 0.35355739341609355, 'f1-score': 0.2812990923048198, 'support': 92844}, 'weighted avg': {'precision': 0.40570614796724924, 'recall': 0.3314807634311318, 'f1-score': 0.26518025410718316, 'support': 92844}}
[[19113   388  9492]
 [27466   828  6886]
 [17396   440 10835]]
training model: results/EXC/W1/deepOF_L1/h10
Epoch 1/50
1290/1290 - 61s - loss: 2.9714 - accuracy10: 0.3888 - val_loss: 3.0375 - val_accuracy10: 0.6518 - 61s/epoch - 47ms/step
Epoch 2/50
1290/1290 - 51s - loss: 2.8570 - accuracy10: 0.4202 - val_loss: 2.9532 - val_accuracy10: 0.6608 - 51s/epoch - 39ms/step
Epoch 3/50
1290/1290 - 50s - loss: 2.8044 - accuracy10: 0.4500 - val_loss: 2.8965 - val_accuracy10: 0.6648 - 50s/epoch - 39ms/step
Epoch 4/50
1290/1290 - 54s - loss: 2.7589 - accuracy10: 0.4750 - val_loss: 2.8818 - val_accuracy10: 0.6846 - 54s/epoch - 42ms/step
Epoch 5/50
1290/1290 - 50s - loss: 2.7288 - accuracy10: 0.4871 - val_loss: 2.8458 - val_accuracy10: 0.6783 - 50s/epoch - 39ms/step
Epoch 6/50
1290/1290 - 53s - loss: 2.7023 - accuracy10: 0.4917 - val_loss: 2.8488 - val_accuracy10: 0.6846 - 53s/epoch - 41ms/step
Epoch 7/50
1290/1290 - 54s - loss: 2.6810 - accuracy10: 0.4964 - val_loss: 2.8219 - val_accuracy10: 0.6606 - 54s/epoch - 42ms/step
Epoch 8/50
1290/1290 - 51s - loss: 2.6591 - accuracy10: 0.5012 - val_loss: 2.8043 - val_accuracy10: 0.6778 - 51s/epoch - 40ms/step
Epoch 9/50
1290/1290 - 52s - loss: 2.6377 - accuracy10: 0.5064 - val_loss: 2.7840 - val_accuracy10: 0.6720 - 52s/epoch - 41ms/step
Epoch 10/50
1290/1290 - 55s - loss: 2.6172 - accuracy10: 0.5140 - val_loss: 2.7687 - val_accuracy10: 0.6685 - 55s/epoch - 43ms/step
Epoch 11/50
1290/1290 - 51s - loss: 2.5998 - accuracy10: 0.5190 - val_loss: 2.7460 - val_accuracy10: 0.6491 - 51s/epoch - 39ms/step
Epoch 12/50
1290/1290 - 53s - loss: 2.5780 - accuracy10: 0.5252 - val_loss: 2.7110 - val_accuracy10: 0.6291 - 53s/epoch - 41ms/step
Epoch 13/50
1290/1290 - 54s - loss: 2.5596 - accuracy10: 0.5305 - val_loss: 2.6974 - val_accuracy10: 0.6207 - 54s/epoch - 42ms/step
Epoch 14/50
1290/1290 - 54s - loss: 2.5434 - accuracy10: 0.5344 - val_loss: 2.6787 - val_accuracy10: 0.6108 - 54s/epoch - 42ms/step
Epoch 15/50
1290/1290 - 54s - loss: 2.5273 - accuracy10: 0.5386 - val_loss: 2.6821 - val_accuracy10: 0.6222 - 54s/epoch - 42ms/step
Epoch 16/50
1290/1290 - 51s - loss: 2.5122 - accuracy10: 0.5438 - val_loss: 2.6746 - val_accuracy10: 0.6269 - 51s/epoch - 40ms/step
Epoch 17/50
1290/1290 - 54s - loss: 2.4969 - accuracy10: 0.5476 - val_loss: 2.6758 - val_accuracy10: 0.6244 - 54s/epoch - 42ms/step
Epoch 18/50
1290/1290 - 54s - loss: 2.4825 - accuracy10: 0.5487 - val_loss: 2.6591 - val_accuracy10: 0.6161 - 54s/epoch - 42ms/step
Epoch 19/50
1290/1290 - 54s - loss: 2.4672 - accuracy10: 0.5524 - val_loss: 2.6756 - val_accuracy10: 0.6267 - 54s/epoch - 42ms/step
Epoch 20/50
1290/1290 - 50s - loss: 2.4555 - accuracy10: 0.5548 - val_loss: 2.6875 - val_accuracy10: 0.6231 - 50s/epoch - 39ms/step
Epoch 21/50
1290/1290 - 54s - loss: 2.4441 - accuracy10: 0.5580 - val_loss: 2.6738 - val_accuracy10: 0.6138 - 54s/epoch - 42ms/step
Epoch 22/50
1290/1290 - 50s - loss: 2.4280 - accuracy10: 0.5605 - val_loss: 2.6823 - val_accuracy10: 0.6225 - 50s/epoch - 39ms/step
Epoch 23/50
1290/1290 - 55s - loss: 2.4178 - accuracy10: 0.5613 - val_loss: 2.6743 - val_accuracy10: 0.6354 - 55s/epoch - 43ms/step
Epoch 24/50
1290/1290 - 53s - loss: 2.4041 - accuracy10: 0.5660 - val_loss: 2.6858 - val_accuracy10: 0.6190 - 53s/epoch - 41ms/step
Epoch 25/50
1290/1290 - 52s - loss: 2.3935 - accuracy10: 0.5672 - val_loss: 2.6895 - val_accuracy10: 0.6254 - 52s/epoch - 40ms/step
Epoch 26/50
1290/1290 - 50s - loss: 2.3858 - accuracy10: 0.5677 - val_loss: 2.6986 - val_accuracy10: 0.6269 - 50s/epoch - 39ms/step
Epoch 27/50
1290/1290 - 56s - loss: 2.3775 - accuracy10: 0.5713 - val_loss: 2.7030 - val_accuracy10: 0.6223 - 56s/epoch - 43ms/step
Epoch 28/50
1290/1290 - 55s - loss: 2.3660 - accuracy10: 0.5707 - val_loss: 2.6991 - val_accuracy10: 0.6261 - 55s/epoch - 43ms/step
testing model: results/EXC/W1/deepOF_L1/h10
Evaluating performance on  test set...
5343/5343 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86407185
{'0': {'precision': 0.25302360288920595, 'recall': 0.6219113677167694, 'f1-score': 0.3597027441444369, 'support': 154842}, '1': {'precision': 0.871065393007353, 'recall': 0.5640538070729502, 'f1-score': 0.6847204763308864, 'support': 1055995}, '2': {'precision': 0.2806081920689803, 'recall': 0.5424378930466973, 'f1-score': 0.36987604759980713, 'support': 156947}, 'accuracy': 0.5681233294145859, 'macro avg': {'precision': 0.4682323959885131, 'recall': 0.5761343559454722, 'f1-score': 0.47143308935837686, 'support': 1367784}, 'weighted avg': {'precision': 0.7333467816029581, 'recall': 0.5681233294145859, 'f1-score': 0.6117993979710935, 'support': 1367784}}
[[ 96298  41268  17276]
 [259376 595638 200981]
 [ 24915  46898  85134]]
Evaluating performance on  train set...
1290/1290 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8062136
{'0': {'precision': 0.24794641882135968, 'recall': 0.641500549364307, 'f1-score': 0.35765541865023803, 'support': 31855}, '1': {'precision': 0.9141789119429427, 'recall': 0.6004820366046547, 'f1-score': 0.7248460659012957, 'support': 265540}, '2': {'precision': 0.2671429934959571, 'recall': 0.5976450491123177, 'f1-score': 0.36923888768481267, 'support': 32782}, 'accuracy': 0.6041577699234048, 'macro avg': {'precision': 0.47642277475341976, 'recall': 0.6132092116937599, 'f1-score': 0.4839134574121155, 'support': 330177}, 'weighted avg': {'precision': 0.785660064334184, 'recall': 0.6041577699234048, 'f1-score': 0.6541131784364658, 'support': 330177}}
[[ 20435   7270   4150]
 [ 56491 159452  49597]
 [  5491   7699  19592]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79918885
{'0': {'precision': 0.24160136899936954, 'recall': 0.5967078189300411, 'f1-score': 0.34394332788409143, 'support': 8991}, '1': {'precision': 0.9066169762611852, 'recall': 0.6237963593626882, 'f1-score': 0.7390740213297889, 'support': 74877}, '2': {'precision': 0.253308227417752, 'recall': 0.5395499108734403, 'f1-score': 0.3447588538885923, 'support': 8976}, 'accuracy': 0.6130283055447848, 'macro avg': {'precision': 0.46717552422610226, 'recall': 0.5866846963887232, 'f1-score': 0.4759254010341576, 'support': 92844}, 'weighted avg': {'precision': 0.7790561790690171, 'recall': 0.6130283055447848, 'f1-score': 0.6626879004418216, 'support': 92844}}
[[ 5365  2347  1279]
 [15172 46708 12997]
 [ 1669  2464  4843]]
training model: results/EXC/W1/deepOF_L1/h20
Epoch 1/50
1290/1290 - 63s - loss: 2.9960 - accuracy20: 0.4023 - val_loss: 3.0972 - val_accuracy20: 0.6324 - 63s/epoch - 49ms/step
Epoch 2/50
1290/1290 - 57s - loss: 2.8720 - accuracy20: 0.4502 - val_loss: 3.0030 - val_accuracy20: 0.6456 - 57s/epoch - 44ms/step
Epoch 3/50
1290/1290 - 54s - loss: 2.8120 - accuracy20: 0.4758 - val_loss: 2.9322 - val_accuracy20: 0.6485 - 54s/epoch - 42ms/step
Epoch 4/50
1290/1290 - 54s - loss: 2.7750 - accuracy20: 0.4861 - val_loss: 2.8979 - val_accuracy20: 0.6360 - 54s/epoch - 42ms/step
Epoch 5/50
1290/1290 - 49s - loss: 2.7440 - accuracy20: 0.4971 - val_loss: 2.8721 - val_accuracy20: 0.6396 - 49s/epoch - 38ms/step
Epoch 6/50
1290/1290 - 53s - loss: 2.7192 - accuracy20: 0.5019 - val_loss: 2.8591 - val_accuracy20: 0.6438 - 53s/epoch - 41ms/step
Epoch 7/50
1290/1290 - 54s - loss: 2.6983 - accuracy20: 0.5078 - val_loss: 2.8347 - val_accuracy20: 0.6400 - 54s/epoch - 42ms/step
Epoch 8/50
1290/1290 - 57s - loss: 2.6786 - accuracy20: 0.5131 - val_loss: 2.8295 - val_accuracy20: 0.6438 - 57s/epoch - 44ms/step
Epoch 9/50
1290/1290 - 58s - loss: 2.6595 - accuracy20: 0.5182 - val_loss: 2.8067 - val_accuracy20: 0.6357 - 58s/epoch - 45ms/step
Epoch 10/50
1290/1290 - 56s - loss: 2.6425 - accuracy20: 0.5239 - val_loss: 2.7923 - val_accuracy20: 0.6386 - 56s/epoch - 44ms/step
Epoch 11/50
1290/1290 - 54s - loss: 2.6246 - accuracy20: 0.5280 - val_loss: 2.7848 - val_accuracy20: 0.6407 - 54s/epoch - 42ms/step
Epoch 12/50
1290/1290 - 57s - loss: 2.6087 - accuracy20: 0.5327 - val_loss: 2.7659 - val_accuracy20: 0.6376 - 57s/epoch - 44ms/step
Epoch 13/50
1290/1290 - 55s - loss: 2.5906 - accuracy20: 0.5380 - val_loss: 2.7751 - val_accuracy20: 0.6368 - 55s/epoch - 42ms/step
Epoch 14/50
1290/1290 - 53s - loss: 2.5754 - accuracy20: 0.5428 - val_loss: 2.7485 - val_accuracy20: 0.6357 - 53s/epoch - 41ms/step
Epoch 15/50
1290/1290 - 55s - loss: 2.5568 - accuracy20: 0.5489 - val_loss: 2.7362 - val_accuracy20: 0.6275 - 55s/epoch - 43ms/step
Epoch 16/50
1290/1290 - 55s - loss: 2.5417 - accuracy20: 0.5531 - val_loss: 2.7300 - val_accuracy20: 0.6261 - 55s/epoch - 43ms/step
Epoch 17/50
1290/1290 - 55s - loss: 2.5297 - accuracy20: 0.5561 - val_loss: 2.7194 - val_accuracy20: 0.6250 - 55s/epoch - 42ms/step
Epoch 18/50
1290/1290 - 54s - loss: 2.5138 - accuracy20: 0.5610 - val_loss: 2.7209 - val_accuracy20: 0.6255 - 54s/epoch - 42ms/step
Epoch 19/50
1290/1290 - 54s - loss: 2.4989 - accuracy20: 0.5649 - val_loss: 2.7143 - val_accuracy20: 0.6228 - 54s/epoch - 42ms/step
Epoch 20/50
1290/1290 - 58s - loss: 2.4903 - accuracy20: 0.5663 - val_loss: 2.6977 - val_accuracy20: 0.6158 - 58s/epoch - 45ms/step
Epoch 21/50
1290/1290 - 56s - loss: 2.4794 - accuracy20: 0.5686 - val_loss: 2.6985 - val_accuracy20: 0.6065 - 56s/epoch - 43ms/step
Epoch 22/50
1290/1290 - 54s - loss: 2.4667 - accuracy20: 0.5708 - val_loss: 2.6929 - val_accuracy20: 0.6128 - 54s/epoch - 42ms/step
Epoch 23/50
1290/1290 - 57s - loss: 2.4560 - accuracy20: 0.5722 - val_loss: 2.6886 - val_accuracy20: 0.6158 - 57s/epoch - 44ms/step
Epoch 24/50
1290/1290 - 58s - loss: 2.4475 - accuracy20: 0.5732 - val_loss: 2.6882 - val_accuracy20: 0.6105 - 58s/epoch - 45ms/step
Epoch 25/50
1290/1290 - 60s - loss: 2.4362 - accuracy20: 0.5759 - val_loss: 2.7036 - val_accuracy20: 0.6167 - 60s/epoch - 47ms/step
Epoch 26/50
1290/1290 - 60s - loss: 2.4244 - accuracy20: 0.5788 - val_loss: 2.6986 - val_accuracy20: 0.6165 - 60s/epoch - 47ms/step
Epoch 27/50
1290/1290 - 56s - loss: 2.4158 - accuracy20: 0.5795 - val_loss: 2.7096 - val_accuracy20: 0.6141 - 56s/epoch - 44ms/step
Epoch 28/50
1290/1290 - 56s - loss: 2.4080 - accuracy20: 0.5803 - val_loss: 2.7259 - val_accuracy20: 0.6239 - 56s/epoch - 43ms/step
Epoch 29/50
1290/1290 - 59s - loss: 2.3986 - accuracy20: 0.5815 - val_loss: 2.7070 - val_accuracy20: 0.6146 - 59s/epoch - 46ms/step
Epoch 30/50
1290/1290 - 52s - loss: 2.3896 - accuracy20: 0.5841 - val_loss: 2.7108 - val_accuracy20: 0.6158 - 52s/epoch - 41ms/step
Epoch 31/50
1290/1290 - 53s - loss: 2.3814 - accuracy20: 0.5846 - val_loss: 2.7189 - val_accuracy20: 0.6116 - 53s/epoch - 41ms/step
Epoch 32/50
1290/1290 - 56s - loss: 2.3725 - accuracy20: 0.5855 - val_loss: 2.7463 - val_accuracy20: 0.6208 - 56s/epoch - 44ms/step
Epoch 33/50
1290/1290 - 56s - loss: 2.3683 - accuracy20: 0.5868 - val_loss: 2.7374 - val_accuracy20: 0.6223 - 56s/epoch - 44ms/step
Epoch 34/50
1290/1290 - 58s - loss: 2.3535 - accuracy20: 0.5897 - val_loss: 2.7534 - val_accuracy20: 0.6165 - 58s/epoch - 45ms/step
testing model: results/EXC/W1/deepOF_L1/h20
Evaluating performance on  test set...
5343/5343 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8714205
{'0': {'precision': 0.3487167283479536, 'recall': 0.5816676172008669, 'f1-score': 0.436028893707547, 'support': 219175}, '1': {'precision': 0.810157909787652, 'recall': 0.5836867789063107, 'f1-score': 0.6785238909401201, 'support': 927064}, '2': {'precision': 0.3716263514039045, 'recall': 0.5607348394231421, 'f1-score': 0.44700239462998376, 'support': 221545}, 'accuracy': 0.5796456165593398, 'macro avg': {'precision': 0.51016699651317, 'recall': 0.5753630785101066, 'f1-score': 0.5205183930925502, 'support': 1367784}, 'weighted avg': {'precision': 0.6651855712867095, 'recall': 0.5796456165593398, 'f1-score': 0.6021658761377257, 'support': 1367784}}
[[127487  63553  28135]
 [204030 541115 181919]
 [ 34072  63245 124228]]
Evaluating performance on  train set...
1290/1290 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8000261
{'0': {'precision': 0.34596814335490295, 'recall': 0.6201789020500122, 'f1-score': 0.4441604294307008, 'support': 44829}, '1': {'precision': 0.871910046386002, 'recall': 0.6208062810152302, 'f1-score': 0.7252379080211083, 'support': 239197}, '2': {'precision': 0.3566729973461456, 'recall': 0.6144612251088817, 'f1-score': 0.45135208263699883, 'support': 46151}, 'accuracy': 0.6198342101357757, 'macro avg': {'precision': 0.5248503956956835, 'recall': 0.6184821360580414, 'f1-score': 0.5402501400296026, 'support': 330177}, 'weighted avg': {'precision': 0.7284834763304878, 'recall': 0.6198342101357757, 'f1-score': 0.6487924650767741, 'support': 330177}}
[[ 27802  10993   6034]
 [ 45587 148495  45115]
 [  6971  10822  28358]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8196912
{'0': {'precision': 0.326272151610405, 'recall': 0.5648710466125089, 'f1-score': 0.4136298007507941, 'support': 12679}, '1': {'precision': 0.8595392484594627, 'recall': 0.631807214648371, 'f1-score': 0.7282856289724011, 'support': 67557}, '2': {'precision': 0.32917353425947726, 'recall': 0.5544098984771574, 'f1-score': 0.4130839464586473, 'support': 12608}, 'accuracy': 0.6121558743699108, 'macro avg': {'precision': 0.5049949781097817, 'recall': 0.5836960532460124, 'f1-score': 0.5183331253939475, 'support': 92844}, 'weighted avg': {'precision': 0.7146925761318742, 'recall': 0.6121558743699108, 'f1-score': 0.6425118141954078, 'support': 92844}}
[[ 7162  3520  1997]
 [12626 42683 12248]
 [ 2163  3455  6990]]
training model: results/EXC/W1/deepOF_L1/h30
Epoch 1/50
1290/1290 - 54s - loss: 3.0232 - accuracy30: 0.4062 - val_loss: 3.0991 - val_accuracy30: 0.6008 - 54s/epoch - 42ms/step
Epoch 2/50
1290/1290 - 55s - loss: 2.8956 - accuracy30: 0.4570 - val_loss: 3.0112 - val_accuracy30: 0.6065 - 55s/epoch - 43ms/step
Epoch 3/50
1290/1290 - 55s - loss: 2.8408 - accuracy30: 0.4734 - val_loss: 2.9458 - val_accuracy30: 0.5973 - 55s/epoch - 43ms/step
Epoch 4/50
1290/1290 - 55s - loss: 2.8073 - accuracy30: 0.4874 - val_loss: 2.9192 - val_accuracy30: 0.6025 - 55s/epoch - 43ms/step
Epoch 5/50
1290/1290 - 60s - loss: 2.7787 - accuracy30: 0.4951 - val_loss: 2.9025 - val_accuracy30: 0.6049 - 60s/epoch - 46ms/step
Epoch 6/50
1290/1290 - 55s - loss: 2.7577 - accuracy30: 0.4987 - val_loss: 2.8742 - val_accuracy30: 0.5911 - 55s/epoch - 43ms/step
Epoch 7/50
1290/1290 - 58s - loss: 2.7399 - accuracy30: 0.5037 - val_loss: 2.8687 - val_accuracy30: 0.5921 - 58s/epoch - 45ms/step
Epoch 8/50
1290/1290 - 55s - loss: 2.7251 - accuracy30: 0.5086 - val_loss: 2.8562 - val_accuracy30: 0.5816 - 55s/epoch - 43ms/step
Epoch 9/50
1290/1290 - 58s - loss: 2.7094 - accuracy30: 0.5121 - val_loss: 2.8520 - val_accuracy30: 0.5910 - 58s/epoch - 45ms/step
Epoch 10/50
1290/1290 - 53s - loss: 2.6933 - accuracy30: 0.5174 - val_loss: 2.8313 - val_accuracy30: 0.5933 - 53s/epoch - 41ms/step
Epoch 11/50
1290/1290 - 57s - loss: 2.6774 - accuracy30: 0.5207 - val_loss: 2.8106 - val_accuracy30: 0.5809 - 57s/epoch - 44ms/step
Epoch 12/50
1290/1290 - 56s - loss: 2.6627 - accuracy30: 0.5258 - val_loss: 2.8035 - val_accuracy30: 0.5756 - 56s/epoch - 44ms/step
Epoch 13/50
1290/1290 - 56s - loss: 2.6468 - accuracy30: 0.5306 - val_loss: 2.7967 - val_accuracy30: 0.5797 - 56s/epoch - 44ms/step
Epoch 14/50
1290/1290 - 58s - loss: 2.6302 - accuracy30: 0.5358 - val_loss: 2.7714 - val_accuracy30: 0.5766 - 58s/epoch - 45ms/step
Epoch 15/50
1290/1290 - 59s - loss: 2.6143 - accuracy30: 0.5407 - val_loss: 2.7652 - val_accuracy30: 0.5796 - 59s/epoch - 46ms/step
Epoch 16/50
1290/1290 - 58s - loss: 2.5992 - accuracy30: 0.5459 - val_loss: 2.7670 - val_accuracy30: 0.5862 - 58s/epoch - 45ms/step
Epoch 17/50
1290/1290 - 56s - loss: 2.5882 - accuracy30: 0.5483 - val_loss: 2.7557 - val_accuracy30: 0.5771 - 56s/epoch - 43ms/step
Epoch 18/50
1290/1290 - 59s - loss: 2.5745 - accuracy30: 0.5526 - val_loss: 2.7513 - val_accuracy30: 0.5814 - 59s/epoch - 46ms/step
Epoch 19/50
1290/1290 - 56s - loss: 2.5640 - accuracy30: 0.5545 - val_loss: 2.7476 - val_accuracy30: 0.5841 - 56s/epoch - 44ms/step
Epoch 20/50
1290/1290 - 56s - loss: 2.5525 - accuracy30: 0.5585 - val_loss: 2.7470 - val_accuracy30: 0.5809 - 56s/epoch - 43ms/step
Epoch 21/50
1290/1290 - 55s - loss: 2.5407 - accuracy30: 0.5590 - val_loss: 2.7461 - val_accuracy30: 0.5867 - 55s/epoch - 43ms/step
Epoch 22/50
1290/1290 - 57s - loss: 2.5294 - accuracy30: 0.5615 - val_loss: 2.7513 - val_accuracy30: 0.5790 - 57s/epoch - 44ms/step
Epoch 23/50
1290/1290 - 58s - loss: 2.5164 - accuracy30: 0.5637 - val_loss: 2.7376 - val_accuracy30: 0.5817 - 58s/epoch - 45ms/step
Epoch 24/50
1290/1290 - 57s - loss: 2.5061 - accuracy30: 0.5648 - val_loss: 2.7359 - val_accuracy30: 0.5755 - 57s/epoch - 44ms/step
Epoch 25/50
1290/1290 - 57s - loss: 2.5022 - accuracy30: 0.5659 - val_loss: 2.7367 - val_accuracy30: 0.5741 - 57s/epoch - 44ms/step
Epoch 26/50
1290/1290 - 57s - loss: 2.4906 - accuracy30: 0.5692 - val_loss: 2.7403 - val_accuracy30: 0.5753 - 57s/epoch - 44ms/step
Epoch 27/50
1290/1290 - 56s - loss: 2.4808 - accuracy30: 0.5709 - val_loss: 2.7352 - val_accuracy30: 0.5712 - 56s/epoch - 44ms/step
Epoch 28/50
1290/1290 - 54s - loss: 2.4707 - accuracy30: 0.5727 - val_loss: 2.7567 - val_accuracy30: 0.5699 - 54s/epoch - 42ms/step
Epoch 29/50
1290/1290 - 55s - loss: 2.4638 - accuracy30: 0.5744 - val_loss: 2.7455 - val_accuracy30: 0.5755 - 55s/epoch - 43ms/step
Epoch 30/50
1290/1290 - 54s - loss: 2.4565 - accuracy30: 0.5752 - val_loss: 2.7506 - val_accuracy30: 0.5755 - 54s/epoch - 42ms/step
Epoch 31/50
1290/1290 - 52s - loss: 2.4451 - accuracy30: 0.5773 - val_loss: 2.7405 - val_accuracy30: 0.5693 - 52s/epoch - 40ms/step
Epoch 32/50
1290/1290 - 53s - loss: 2.4363 - accuracy30: 0.5780 - val_loss: 2.7549 - val_accuracy30: 0.5746 - 53s/epoch - 41ms/step
Epoch 33/50
1290/1290 - 58s - loss: 2.4301 - accuracy30: 0.5811 - val_loss: 2.7505 - val_accuracy30: 0.5685 - 58s/epoch - 45ms/step
Epoch 34/50
1290/1290 - 54s - loss: 2.4166 - accuracy30: 0.5826 - val_loss: 2.7658 - val_accuracy30: 0.5748 - 54s/epoch - 42ms/step
Epoch 35/50
1290/1290 - 55s - loss: 2.4130 - accuracy30: 0.5825 - val_loss: 2.7662 - val_accuracy30: 0.5764 - 55s/epoch - 43ms/step
Epoch 36/50
1290/1290 - 50s - loss: 2.4012 - accuracy30: 0.5854 - val_loss: 2.7728 - val_accuracy30: 0.5759 - 50s/epoch - 39ms/step
Epoch 37/50
1290/1290 - 52s - loss: 2.3963 - accuracy30: 0.5846 - val_loss: 2.7776 - val_accuracy30: 0.5764 - 52s/epoch - 40ms/step
testing model: results/EXC/W1/deepOF_L1/h30
Evaluating performance on  test set...
5343/5343 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92149365
{'0': {'precision': 0.38590124271417575, 'recall': 0.5885257877199913, 'f1-score': 0.4661464137530978, 'support': 268306}, '1': {'precision': 0.7513777518837084, 'recall': 0.5320954158367706, 'f1-score': 0.6230043095472504, 'support': 828919}, '2': {'precision': 0.4038515360933497, 'recall': 0.5546590577286286, 'f1-score': 0.4673916259571347, 'support': 270559}, 'accuracy': 0.547628134266814, 'macro avg': {'precision': 0.5137101768970779, 'recall': 0.5584267537617968, 'f1-score': 0.5188474497524943, 'support': 1367784}, 'weighted avg': {'precision': 0.6109419186766638, 'recall': 0.547628134266814, 'f1-score': 0.561453416534608, 'support': 1367784}}
[[157905  71702  38699]
 [205030 441064 182825]
 [ 46250  74241 150068]]
Evaluating performance on  train set...
1290/1290 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84675825
{'0': {'precision': 0.37663170479865227, 'recall': 0.6342106226435814, 'f1-score': 0.47260353375203734, 'support': 54638}, '1': {'precision': 0.8321100429481298, 'recall': 0.5706151068641039, 'f1-score': 0.6769887331714256, 'support': 219344}, '2': {'precision': 0.39314934251008454, 'recall': 0.6139692143429131, 'f1-score': 0.4793508992518391, 'support': 56195}, 'accuracy': 0.5885176738537209, 'macro avg': {'precision': 0.5339636967522888, 'recall': 0.6062649812835329, 'f1-score': 0.5429810553917674, 'support': 330177}, 'weighted avg': {'precision': 0.6820274448237084, 'recall': 0.5885176738537209, 'f1-score': 0.609529592761925, 'support': 330177}}
[[ 34652  12063   7923]
 [ 48850 125161  45333]
 [  8503  13190  34502]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87823373
{'0': {'precision': 0.3501962323390895, 'recall': 0.5772415577694398, 'f1-score': 0.4359275001221359, 'support': 15458}, '1': {'precision': 0.8172802577082374, 'recall': 0.5724254633360193, 'f1-score': 0.6732821533503932, 'support': 62050}, '2': {'precision': 0.3569277108433735, 'recall': 0.5563380281690141, 'f1-score': 0.4348623853211009, 'support': 15336}, 'accuracy': 0.5705699883675843, 'macro avg': {'precision': 0.5081347336302334, 'recall': 0.5686683497581577, 'f1-score': 0.5146906795978766, 'support': 92844}, 'weighted avg': {'precision': 0.6634722407887181, 'recall': 0.5705699883675843, 'f1-score': 0.5943816989096148, 'support': 92844}}
[[ 8923  3871  2664]
 [13823 35519 12708]
 [ 2734  4070  8532]]
training model: results/EXC/W1/deepOF_L1/h50
Epoch 1/50
1290/1290 - 62s - loss: 3.0995 - accuracy50: 0.4097 - val_loss: 3.1420 - val_accuracy50: 0.5422 - 62s/epoch - 48ms/step
Epoch 2/50
1290/1290 - 56s - loss: 2.9879 - accuracy50: 0.4487 - val_loss: 3.0484 - val_accuracy50: 0.5431 - 56s/epoch - 44ms/step
Epoch 3/50
1290/1290 - 55s - loss: 2.9380 - accuracy50: 0.4650 - val_loss: 3.0173 - val_accuracy50: 0.5299 - 55s/epoch - 42ms/step
Epoch 4/50
1290/1290 - 54s - loss: 2.9085 - accuracy50: 0.4750 - val_loss: 2.9908 - val_accuracy50: 0.5382 - 54s/epoch - 42ms/step
Epoch 5/50
1290/1290 - 55s - loss: 2.8877 - accuracy50: 0.4816 - val_loss: 2.9706 - val_accuracy50: 0.5343 - 55s/epoch - 42ms/step
Epoch 6/50
1290/1290 - 56s - loss: 2.8716 - accuracy50: 0.4882 - val_loss: 2.9616 - val_accuracy50: 0.5368 - 56s/epoch - 43ms/step
Epoch 7/50
1290/1290 - 58s - loss: 2.8557 - accuracy50: 0.4939 - val_loss: 2.9549 - val_accuracy50: 0.5378 - 58s/epoch - 45ms/step
Epoch 8/50
1290/1290 - 56s - loss: 2.8422 - accuracy50: 0.4975 - val_loss: 2.9517 - val_accuracy50: 0.5411 - 56s/epoch - 44ms/step
Epoch 9/50
1290/1290 - 57s - loss: 2.8318 - accuracy50: 0.5002 - val_loss: 2.9478 - val_accuracy50: 0.5442 - 57s/epoch - 44ms/step
Epoch 10/50
1290/1290 - 57s - loss: 2.8217 - accuracy50: 0.5035 - val_loss: 2.9404 - val_accuracy50: 0.5427 - 57s/epoch - 44ms/step
Epoch 11/50
1290/1290 - 56s - loss: 2.8117 - accuracy50: 0.5071 - val_loss: 2.9385 - val_accuracy50: 0.5444 - 56s/epoch - 43ms/step
Epoch 12/50
1290/1290 - 58s - loss: 2.8018 - accuracy50: 0.5097 - val_loss: 2.9295 - val_accuracy50: 0.5453 - 58s/epoch - 45ms/step
Epoch 13/50
1290/1290 - 59s - loss: 2.7923 - accuracy50: 0.5114 - val_loss: 2.9223 - val_accuracy50: 0.5410 - 59s/epoch - 46ms/step
Epoch 14/50
1290/1290 - 55s - loss: 2.7792 - accuracy50: 0.5152 - val_loss: 2.9030 - val_accuracy50: 0.5375 - 55s/epoch - 42ms/step
Epoch 15/50
1290/1290 - 58s - loss: 2.7668 - accuracy50: 0.5189 - val_loss: 2.9003 - val_accuracy50: 0.5315 - 58s/epoch - 45ms/step
Epoch 16/50
1290/1290 - 57s - loss: 2.7555 - accuracy50: 0.5246 - val_loss: 2.9028 - val_accuracy50: 0.5392 - 57s/epoch - 44ms/step
Epoch 17/50
1290/1290 - 53s - loss: 2.7454 - accuracy50: 0.5281 - val_loss: 2.8906 - val_accuracy50: 0.5300 - 53s/epoch - 41ms/step
Epoch 18/50
1290/1290 - 57s - loss: 2.7320 - accuracy50: 0.5310 - val_loss: 2.8878 - val_accuracy50: 0.5364 - 57s/epoch - 44ms/step
Epoch 19/50
1290/1290 - 60s - loss: 2.7211 - accuracy50: 0.5344 - val_loss: 2.8847 - val_accuracy50: 0.5261 - 60s/epoch - 47ms/step
Epoch 20/50
1290/1290 - 55s - loss: 2.7116 - accuracy50: 0.5376 - val_loss: 2.8812 - val_accuracy50: 0.5354 - 55s/epoch - 43ms/step
Epoch 21/50
1290/1290 - 56s - loss: 2.7028 - accuracy50: 0.5385 - val_loss: 2.8750 - val_accuracy50: 0.5325 - 56s/epoch - 43ms/step
Epoch 22/50
1290/1290 - 57s - loss: 2.6939 - accuracy50: 0.5414 - val_loss: 2.8779 - val_accuracy50: 0.5231 - 57s/epoch - 44ms/step
Epoch 23/50
1290/1290 - 55s - loss: 2.6830 - accuracy50: 0.5436 - val_loss: 2.8693 - val_accuracy50: 0.5317 - 55s/epoch - 42ms/step
Epoch 24/50
1290/1290 - 58s - loss: 2.6730 - accuracy50: 0.5452 - val_loss: 2.8810 - val_accuracy50: 0.5270 - 58s/epoch - 45ms/step
Epoch 25/50
1290/1290 - 57s - loss: 2.6634 - accuracy50: 0.5476 - val_loss: 2.8737 - val_accuracy50: 0.5269 - 57s/epoch - 44ms/step
Epoch 26/50
1290/1290 - 55s - loss: 2.6507 - accuracy50: 0.5507 - val_loss: 2.8851 - val_accuracy50: 0.5186 - 55s/epoch - 43ms/step
Epoch 27/50
1290/1290 - 56s - loss: 2.6432 - accuracy50: 0.5521 - val_loss: 2.8946 - val_accuracy50: 0.5217 - 56s/epoch - 44ms/step
Epoch 28/50
1290/1290 - 55s - loss: 2.6348 - accuracy50: 0.5548 - val_loss: 2.8878 - val_accuracy50: 0.5188 - 55s/epoch - 42ms/step
Epoch 29/50
1290/1290 - 55s - loss: 2.6262 - accuracy50: 0.5557 - val_loss: 2.8985 - val_accuracy50: 0.5308 - 55s/epoch - 43ms/step
Epoch 30/50
1290/1290 - 56s - loss: 2.6188 - accuracy50: 0.5564 - val_loss: 2.8898 - val_accuracy50: 0.5254 - 56s/epoch - 44ms/step
Epoch 31/50
1290/1290 - 56s - loss: 2.6101 - accuracy50: 0.5575 - val_loss: 2.8909 - val_accuracy50: 0.5213 - 56s/epoch - 44ms/step
Epoch 32/50
1290/1290 - 55s - loss: 2.5951 - accuracy50: 0.5617 - val_loss: 2.9115 - val_accuracy50: 0.5253 - 55s/epoch - 43ms/step
Epoch 33/50
1290/1290 - 59s - loss: 2.5881 - accuracy50: 0.5628 - val_loss: 2.8960 - val_accuracy50: 0.5237 - 59s/epoch - 45ms/step
testing model: results/EXC/W1/deepOF_L1/h50
Evaluating performance on  test set...
5343/5343 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9847983
{'0': {'precision': 0.42844186385678346, 'recall': 0.5428925354947317, 'f1-score': 0.47892443619125497, 'support': 346319}, '1': {'precision': 0.6231255797298816, 'recall': 0.48601780902097924, 'f1-score': 0.546097343367516, 'support': 673142}, '2': {'precision': 0.44740210386633095, 'recall': 0.5188173046281755, 'f1-score': 0.48047048438941514, 'support': 348323}, 'accuracy': 0.5087711217560668, 'macro avg': {'precision': 0.49965651581766535, 'recall': 0.5159092163812954, 'f1-score': 0.5018307546493954, 'support': 1367784}, 'weighted avg': {'precision': 0.5290820771880511, 'recall': 0.5087711217560668, 'f1-score': 0.5123766693135685, 'support': 1367784}}
[[188014 101294  57011]
 [179787 327159 166196]
 [ 71031  96576 180716]]
Evaluating performance on  train set...
1290/1290 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9119744
{'0': {'precision': 0.4184076114171257, 'recall': 0.5931341927423477, 'f1-score': 0.4906803847644551, 'support': 70436}, '1': {'precision': 0.7288556662156467, 'recall': 0.5257159618153698, 'f1-score': 0.6108396667482549, 'support': 187510}, '2': {'precision': 0.4420475819853173, 'recall': 0.5818692805028312, 'f1-score': 0.5024117052878206, 'support': 72231}, 'accuracy': 0.5523825099870675, 'macro avg': {'precision': 0.5297702865393633, 'recall': 0.5669064783535162, 'f1-score': 0.5346439189335102, 'support': 330177}, 'weighted avg': {'precision': 0.599884981038213, 'recall': 0.5523825099870675, 'f1-score': 0.5614861403970567, 'support': 330177}}
[[41778 18595 10063]
 [45947 98577 42986]
 [12125 18077 42029]]
Evaluating performance on  val set...
363/363 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94331956
{'0': {'precision': 0.39076633620377743, 'recall': 0.5451241671714112, 'f1-score': 0.45521601685985247, 'support': 19812}, '1': {'precision': 0.719682775966943, 'recall': 0.5250337028160575, 'f1-score': 0.6071386041073498, 'support': 53408}, '2': {'precision': 0.3951910985786686, 'recall': 0.5284855279249898, 'f1-score': 0.4522205507227418, 'support': 19624}, 'accuracy': 0.5300504071345483, 'macro avg': {'precision': 0.5018800702497963, 'recall': 0.5328811326374862, 'f1-score': 0.5048583905633146, 'support': 92844}, 'weighted avg': {'precision': 0.5809089490997751, 'recall': 0.5300504071345483, 'f1-score': 0.5419755114124318, 'support': 92844}}
[[10800  5567  3445]
 [12940 28041 12427]
 [ 3898  5355 10371]]
training model: results/EXC/W1/deepOF_L1/h100
Epoch 1/50
1290/1290 - 64s - loss: 3.2212 - accuracy100: 0.4063 - val_loss: 3.2202 - val_accuracy100: 0.4503 - 64s/epoch - 50ms/step
Epoch 2/50
1290/1290 - 57s - loss: 3.1536 - accuracy100: 0.4312 - val_loss: 3.1688 - val_accuracy100: 0.4575 - 57s/epoch - 45ms/step
Epoch 3/50
1290/1290 - 60s - loss: 3.1255 - accuracy100: 0.4417 - val_loss: 3.1428 - val_accuracy100: 0.4600 - 60s/epoch - 46ms/step
Epoch 4/50
1290/1290 - 59s - loss: 3.1081 - accuracy100: 0.4483 - val_loss: 3.1363 - val_accuracy100: 0.4603 - 59s/epoch - 46ms/step
Epoch 5/50
1290/1290 - 52s - loss: 3.0948 - accuracy100: 0.4527 - val_loss: 3.1279 - val_accuracy100: 0.4591 - 52s/epoch - 40ms/step
Epoch 6/50
1290/1290 - 56s - loss: 3.0844 - accuracy100: 0.4564 - val_loss: 3.1214 - val_accuracy100: 0.4604 - 56s/epoch - 43ms/step
Epoch 7/50
1290/1290 - 57s - loss: 3.0755 - accuracy100: 0.4597 - val_loss: 3.1170 - val_accuracy100: 0.4621 - 57s/epoch - 44ms/step
Epoch 8/50
1290/1290 - 59s - loss: 3.0659 - accuracy100: 0.4630 - val_loss: 3.1123 - val_accuracy100: 0.4647 - 59s/epoch - 45ms/step
Epoch 9/50
1290/1290 - 57s - loss: 3.0579 - accuracy100: 0.4660 - val_loss: 3.1118 - val_accuracy100: 0.4649 - 57s/epoch - 44ms/step
Epoch 10/50
1290/1290 - 56s - loss: 3.0505 - accuracy100: 0.4686 - val_loss: 3.1061 - val_accuracy100: 0.4647 - 56s/epoch - 44ms/step
Epoch 11/50
1290/1290 - 55s - loss: 3.0426 - accuracy100: 0.4712 - val_loss: 3.1005 - val_accuracy100: 0.4693 - 55s/epoch - 43ms/step
Epoch 12/50
1290/1290 - 59s - loss: 3.0357 - accuracy100: 0.4738 - val_loss: 3.1021 - val_accuracy100: 0.4669 - 59s/epoch - 46ms/step
Epoch 13/50
1290/1290 - 56s - loss: 3.0318 - accuracy100: 0.4752 - val_loss: 3.1029 - val_accuracy100: 0.4674 - 56s/epoch - 44ms/step
Epoch 14/50
1290/1290 - 60s - loss: 3.0229 - accuracy100: 0.4776 - val_loss: 3.1004 - val_accuracy100: 0.4701 - 60s/epoch - 47ms/step
Epoch 15/50
1290/1290 - 54s - loss: 3.0172 - accuracy100: 0.4800 - val_loss: 3.1010 - val_accuracy100: 0.4679 - 54s/epoch - 42ms/step
Epoch 16/50
1290/1290 - 60s - loss: 3.0119 - accuracy100: 0.4817 - val_loss: 3.1021 - val_accuracy100: 0.4688 - 60s/epoch - 46ms/step
Epoch 17/50
1290/1290 - 55s - loss: 3.0035 - accuracy100: 0.4857 - val_loss: 3.0992 - val_accuracy100: 0.4701 - 55s/epoch - 42ms/step
Epoch 18/50
1290/1290 - 56s - loss: 2.9971 - accuracy100: 0.4876 - val_loss: 3.0998 - val_accuracy100: 0.4679 - 56s/epoch - 44ms/step
Epoch 19/50
1290/1290 - 59s - loss: 2.9915 - accuracy100: 0.4890 - val_loss: 3.0974 - val_accuracy100: 0.4679 - 59s/epoch - 46ms/step
Epoch 20/50
1290/1290 - 58s - loss: 2.9832 - accuracy100: 0.4921 - val_loss: 3.0960 - val_accuracy100: 0.4661 - 58s/epoch - 45ms/step
Epoch 21/50
1290/1290 - 60s - loss: 2.9769 - accuracy100: 0.4940 - val_loss: 3.0952 - val_accuracy100: 0.4656 - 60s/epoch - 47ms/step
Epoch 22/50
1290/1290 - 59s - loss: 2.9696 - accuracy100: 0.4968 - val_loss: 3.0865 - val_accuracy100: 0.4645 - 59s/epoch - 46ms/step
Epoch 23/50
1290/1290 - 56s - loss: 2.9608 - accuracy100: 0.5010 - val_loss: 3.0849 - val_accuracy100: 0.4614 - 56s/epoch - 44ms/step
Epoch 24/50
1290/1290 - 56s - loss: 2.9516 - accuracy100: 0.5028 - val_loss: 3.0889 - val_accuracy100: 0.4611 - 56s/epoch - 43ms/step
Epoch 25/50
1290/1290 - 57s - loss: 2.9445 - accuracy100: 0.5058 - val_loss: 3.0832 - val_accuracy100: 0.4617 - 57s/epoch - 44ms/step
Epoch 26/50
1290/1290 - 58s - loss: 2.9355 - accuracy100: 0.5074 - val_loss: 3.0930 - val_accuracy100: 0.4576 - 58s/epoch - 45ms/step
Epoch 27/50
1290/1290 - 58s - loss: 2.9290 - accuracy100: 0.5106 - val_loss: 3.0927 - val_accuracy100: 0.4597 - 58s/epoch - 45ms/step
Epoch 28/50
1290/1290 - 58s - loss: 2.9235 - accuracy100: 0.5118 - val_loss: 3.1038 - val_accuracy100: 0.4550 - 58s/epoch - 45ms/step
Epoch 29/50
1290/1290 - 56s - loss: 2.9152 - accuracy100: 0.5143 - val_loss: 3.1034 - val_accuracy100: 0.4559 - 56s/epoch - 44ms/step
Epoch 30/50
1290/1290 - 57s - loss: 2.9093 - accuracy100: 0.5160 - val_loss: 3.1155 - val_accuracy100: 0.4540 - 57s/epoch - 44ms/step
Epoch 31/50
1290/1290 - 53s - loss: 2.9013 - accuracy100: 0.5178 - val_loss: 3.1030 - val_accuracy100: 0.4537 - 53s/epoch - 41ms/step
Epoch 32/50
1290/1290 - 57s - loss: 2.8918 - accuracy100: 0.5200 - val_loss: 3.1132 - val_accuracy100: 0.4521 - 57s/epoch - 44ms/step
Epoch 33/50
1290/1290 - 54s - loss: 2.8846 - accuracy100: 0.5225 - val_loss: 3.1221 - val_accuracy100: 0.4516 - 54s/epoch - 42ms/step
Epoch 34/50
1290/1290 - 59s - loss: 2.8777 - accuracy100: 0.5238 - val_loss: 3.1125 - val_accuracy100: 0.4547 - 59s/epoch - 46ms/step
Epoch 35/50
1290/1290 - 60s - loss: 2.8681 - accuracy100: 0.5270 - val_loss: 3.1231 - val_accuracy100: 0.4502 - 60s/epoch - 46ms/step
testing model: results/EXC/W1/deepOF_L1/h100
Evaluating performance on  test set...
5343/5343 - 93s - 93s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0646304
{'0': {'precision': 0.4643124092120665, 'recall': 0.4997322022946035, 'f1-score': 0.4813716295672771, 'support': 461169}, '1': {'precision': 0.3896800353517746, 'recall': 0.396831857806723, 'f1-score': 0.393223430501061, 'support': 442215}, '2': {'precision': 0.4839897032562027, 'recall': 0.4388673557278208, 'f1-score': 0.4603254191962995, 'support': 464400}, 'accuracy': 0.4457984594058711, 'macro avg': {'precision': 0.445994049273348, 'recall': 0.4451438052763825, 'f1-score': 0.44497349308821255, 'support': 1367784}, 'weighted avg': {'precision': 0.4468641718788822, 'recall': 0.4457984594058711, 'f1-score': 0.4457268816053556, 'support': 1367784}}
[[230461 135134  95574]
 [145010 175485 121720]
 [120878 139712 203810]]
Evaluating performance on  train set...
1290/1290 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0011497
{'0': {'precision': 0.4580004820604642, 'recall': 0.545759478089611, 'f1-score': 0.49804358407908045, 'support': 97488}, '1': {'precision': 0.5197037171680451, 'recall': 0.4290215850007878, 'f1-score': 0.4700288101530103, 'support': 133287}, '2': {'precision': 0.4944075245963127, 'recall': 0.5171726927023601, 'f1-score': 0.5055339485989351, 'support': 99402}, 'accuracy': 0.4900280758502258, 'macro avg': {'precision': 0.49070390794160734, 'recall': 0.4973179185975863, 'f1-score': 0.49120211427700866, 'support': 330177}, 'weighted avg': {'precision': 0.49386964296486563, 'recall': 0.4900280758502258, 'f1-score': 0.4889895071497925, 'support': 330177}}
[[53205 26295 17988]
 [41521 57183 34583]
 [21442 26552 51408]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0300472
{'0': {'precision': 0.42714808043875685, 'recall': 0.5192029924817599, 'f1-score': 0.4686982832115812, 'support': 27001}, '1': {'precision': 0.5211742660836977, 'recall': 0.4238006958376717, 'f1-score': 0.46747062201493056, 'support': 39377}, '2': {'precision': 0.4311169832881017, 'recall': 0.4561701806090834, 'f1-score': 0.4432898843400037, 'support': 26466}, 'accuracy': 0.46077290939640686, 'macro avg': {'precision': 0.4598131099368521, 'recall': 0.4663912896428384, 'f1-score': 0.4598195965221718, 'support': 92844}, 'weighted avg': {'precision': 0.46815783976570957, 'recall': 0.46077290939640686, 'f1-score': 0.46093471960514804, 'support': 92844}}
[[14019  7410  5572]
 [12330 16688 10359]
 [ 6471  7922 12073]]
training model: results/EXC/W1/deepOF_L1/h200
Epoch 1/50
1290/1290 - 62s - loss: 3.2848 - accuracy200: 0.3816 - val_loss: 3.2711 - val_accuracy200: 0.3868 - 62s/epoch - 48ms/step
Epoch 2/50
1290/1290 - 59s - loss: 3.2520 - accuracy200: 0.3963 - val_loss: 3.2564 - val_accuracy200: 0.3929 - 59s/epoch - 46ms/step
Epoch 3/50
1290/1290 - 59s - loss: 3.2405 - accuracy200: 0.4007 - val_loss: 3.2482 - val_accuracy200: 0.3942 - 59s/epoch - 46ms/step
Epoch 4/50
1290/1290 - 59s - loss: 3.2327 - accuracy200: 0.4051 - val_loss: 3.2430 - val_accuracy200: 0.3968 - 59s/epoch - 45ms/step
Epoch 5/50
1290/1290 - 61s - loss: 3.2266 - accuracy200: 0.4077 - val_loss: 3.2411 - val_accuracy200: 0.3965 - 61s/epoch - 47ms/step
Epoch 6/50
1290/1290 - 58s - loss: 3.2219 - accuracy200: 0.4096 - val_loss: 3.2399 - val_accuracy200: 0.3943 - 58s/epoch - 45ms/step
Epoch 7/50
1290/1290 - 59s - loss: 3.2189 - accuracy200: 0.4115 - val_loss: 3.2355 - val_accuracy200: 0.3971 - 59s/epoch - 46ms/step
Epoch 8/50
1290/1290 - 60s - loss: 3.2143 - accuracy200: 0.4125 - val_loss: 3.2358 - val_accuracy200: 0.3969 - 60s/epoch - 46ms/step
Epoch 9/50
1290/1290 - 56s - loss: 3.2106 - accuracy200: 0.4153 - val_loss: 3.2352 - val_accuracy200: 0.3982 - 56s/epoch - 44ms/step
Epoch 10/50
1290/1290 - 58s - loss: 3.2063 - accuracy200: 0.4174 - val_loss: 3.2340 - val_accuracy200: 0.3984 - 58s/epoch - 45ms/step
Epoch 11/50
1290/1290 - 56s - loss: 3.2037 - accuracy200: 0.4188 - val_loss: 3.2357 - val_accuracy200: 0.3947 - 56s/epoch - 44ms/step
Epoch 12/50
1290/1290 - 62s - loss: 3.2000 - accuracy200: 0.4204 - val_loss: 3.2342 - val_accuracy200: 0.3982 - 62s/epoch - 48ms/step
Epoch 13/50
1290/1290 - 58s - loss: 3.1976 - accuracy200: 0.4221 - val_loss: 3.2370 - val_accuracy200: 0.3954 - 58s/epoch - 45ms/step
Epoch 14/50
1290/1290 - 51s - loss: 3.1945 - accuracy200: 0.4236 - val_loss: 3.2382 - val_accuracy200: 0.3943 - 51s/epoch - 39ms/step
Epoch 15/50
1290/1290 - 54s - loss: 3.1915 - accuracy200: 0.4250 - val_loss: 3.2337 - val_accuracy200: 0.4000 - 54s/epoch - 42ms/step
Epoch 16/50
1290/1290 - 57s - loss: 3.1879 - accuracy200: 0.4273 - val_loss: 3.2380 - val_accuracy200: 0.3957 - 57s/epoch - 44ms/step
Epoch 17/50
1290/1290 - 53s - loss: 3.1847 - accuracy200: 0.4280 - val_loss: 3.2347 - val_accuracy200: 0.4005 - 53s/epoch - 41ms/step
Epoch 18/50
1290/1290 - 55s - loss: 3.1817 - accuracy200: 0.4297 - val_loss: 3.2406 - val_accuracy200: 0.3968 - 55s/epoch - 43ms/step
Epoch 19/50
1290/1290 - 56s - loss: 3.1779 - accuracy200: 0.4319 - val_loss: 3.2380 - val_accuracy200: 0.3983 - 56s/epoch - 43ms/step
Epoch 20/50
1290/1290 - 59s - loss: 3.1738 - accuracy200: 0.4326 - val_loss: 3.2441 - val_accuracy200: 0.3961 - 59s/epoch - 46ms/step
Epoch 21/50
1290/1290 - 55s - loss: 3.1715 - accuracy200: 0.4337 - val_loss: 3.2518 - val_accuracy200: 0.3928 - 55s/epoch - 43ms/step
Epoch 22/50
1290/1290 - 60s - loss: 3.1673 - accuracy200: 0.4353 - val_loss: 3.2456 - val_accuracy200: 0.3946 - 60s/epoch - 47ms/step
Epoch 23/50
1290/1290 - 58s - loss: 3.1656 - accuracy200: 0.4364 - val_loss: 3.2536 - val_accuracy200: 0.3927 - 58s/epoch - 45ms/step
Epoch 24/50
1290/1290 - 58s - loss: 3.1602 - accuracy200: 0.4386 - val_loss: 3.2501 - val_accuracy200: 0.3921 - 58s/epoch - 45ms/step
Epoch 25/50
1290/1290 - 54s - loss: 3.1565 - accuracy200: 0.4402 - val_loss: 3.2551 - val_accuracy200: 0.3912 - 54s/epoch - 42ms/step
testing model: results/EXC/W1/deepOF_L1/h200
Evaluating performance on  test set...
5343/5343 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0885917
{'0': {'precision': 0.4161074040702987, 'recall': 0.5404107706530521, 'f1-score': 0.47018222727050396, 'support': 480268}, '1': {'precision': 0.3109393705416912, 'recall': 0.21835483967248018, 'f1-score': 0.2565496281360043, 'support': 402052}, '2': {'precision': 0.4362952342172975, 'recall': 0.41494528945503684, 'f1-score': 0.4253525230897872, 'support': 485464}, 'accuracy': 0.40121320325431503, 'macro avg': {'precision': 0.3877806696097625, 'recall': 0.391236966593523, 'f1-score': 0.38402812616543186, 'support': 1367784}, 'weighted avg': {'precision': 0.3923590977282439, 'recall': 0.40121320325431503, 'f1-score': 0.39147490121784406, 'support': 1367784}}
[[259542  92733 127993]
 [181988  87790 132274]
 [182208 101815 201441]]
Evaluating performance on  train set...
1290/1290 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0682467
{'0': {'precision': 0.4121157549507391, 'recall': 0.5752832698747649, 'f1-score': 0.4802178108629721, 'support': 108995}, '1': {'precision': 0.3609321076260575, 'recall': 0.2162785377682207, 'f1-score': 0.27047965623587433, 'support': 109285}, '2': {'precision': 0.4584510671571502, 'recall': 0.46109368437044784, 'f1-score': 0.4597685785447271, 'support': 111897}, 'accuracy': 0.4177577481169191, 'macro avg': {'precision': 0.410499643244649, 'recall': 0.4175518306711445, 'f1-score': 0.4034886818811912, 'support': 330177}, 'weighted avg': {'precision': 0.4108775631084332, 'recall': 0.4177577481169191, 'f1-score': 0.40386651450636024, 'support': 330177}}
[[62703 19973 26319]
 [51021 23636 34628]
 [38425 21877 51595]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0776751
{'0': {'precision': 0.39413134606427574, 'recall': 0.5594895699031373, 'f1-score': 0.4624738690240337, 'support': 30249}, '1': {'precision': 0.383212566259787, 'recall': 0.23979063964457428, 'f1-score': 0.29499298081422554, 'support': 32862}, '2': {'precision': 0.41736818785999114, 'recall': 0.4118656038744829, 'f1-score': 0.4145986389951586, 'support': 29733}, 'accuracy': 0.3990564818405067, 'macro avg': {'precision': 0.39823736672801796, 'recall': 0.40371527114073147, 'f1-score': 0.39068849627780594, 'support': 92844}, 'weighted avg': {'precision': 0.3977081854419081, 'recall': 0.3990564818405067, 'f1-score': 0.38786235764150756, 'support': 92844}}
[[16924  6065  7260]
 [15147  7880  9835]
 [10869  6618 12246]]
training model: results/EXC/W1/deepOF_L1/h300
Epoch 1/50
1290/1290 - 67s - loss: 3.2975 - accuracy300: 0.3693 - val_loss: 3.2899 - val_accuracy300: 0.3586 - 67s/epoch - 52ms/step
Epoch 2/50
1290/1290 - 56s - loss: 3.2721 - accuracy300: 0.3794 - val_loss: 3.2786 - val_accuracy300: 0.3600 - 56s/epoch - 43ms/step
Epoch 3/50
1290/1290 - 52s - loss: 3.2643 - accuracy300: 0.3826 - val_loss: 3.2731 - val_accuracy300: 0.3654 - 52s/epoch - 40ms/step
Epoch 4/50
1290/1290 - 60s - loss: 3.2602 - accuracy300: 0.3852 - val_loss: 3.2713 - val_accuracy300: 0.3664 - 60s/epoch - 46ms/step
Epoch 5/50
1290/1290 - 58s - loss: 3.2571 - accuracy300: 0.3866 - val_loss: 3.2696 - val_accuracy300: 0.3659 - 58s/epoch - 45ms/step
Epoch 6/50
1290/1290 - 56s - loss: 3.2548 - accuracy300: 0.3878 - val_loss: 3.2675 - val_accuracy300: 0.3662 - 56s/epoch - 43ms/step
Epoch 7/50
1290/1290 - 58s - loss: 3.2523 - accuracy300: 0.3891 - val_loss: 3.2676 - val_accuracy300: 0.3678 - 58s/epoch - 45ms/step
Epoch 8/50
1290/1290 - 54s - loss: 3.2499 - accuracy300: 0.3916 - val_loss: 3.2670 - val_accuracy300: 0.3670 - 54s/epoch - 42ms/step
Epoch 9/50
1290/1290 - 57s - loss: 3.2481 - accuracy300: 0.3924 - val_loss: 3.2656 - val_accuracy300: 0.3671 - 57s/epoch - 45ms/step
Epoch 10/50
1290/1290 - 54s - loss: 3.2462 - accuracy300: 0.3952 - val_loss: 3.2658 - val_accuracy300: 0.3688 - 54s/epoch - 42ms/step
Epoch 11/50
1290/1290 - 55s - loss: 3.2439 - accuracy300: 0.3954 - val_loss: 3.2662 - val_accuracy300: 0.3676 - 55s/epoch - 42ms/step
Epoch 12/50
1290/1290 - 57s - loss: 3.2418 - accuracy300: 0.3977 - val_loss: 3.2657 - val_accuracy300: 0.3684 - 57s/epoch - 44ms/step
Epoch 13/50
1290/1290 - 58s - loss: 3.2392 - accuracy300: 0.3998 - val_loss: 3.2673 - val_accuracy300: 0.3667 - 58s/epoch - 45ms/step
Epoch 14/50
1290/1290 - 58s - loss: 3.2369 - accuracy300: 0.4011 - val_loss: 3.2681 - val_accuracy300: 0.3682 - 58s/epoch - 45ms/step
Epoch 15/50
1290/1290 - 60s - loss: 3.2346 - accuracy300: 0.4034 - val_loss: 3.2670 - val_accuracy300: 0.3704 - 60s/epoch - 46ms/step
Epoch 16/50
1290/1290 - 57s - loss: 3.2330 - accuracy300: 0.4041 - val_loss: 3.2687 - val_accuracy300: 0.3677 - 57s/epoch - 44ms/step
Epoch 17/50
1290/1290 - 57s - loss: 3.2298 - accuracy300: 0.4066 - val_loss: 3.2708 - val_accuracy300: 0.3684 - 57s/epoch - 44ms/step
Epoch 18/50
1290/1290 - 58s - loss: 3.2271 - accuracy300: 0.4072 - val_loss: 3.2756 - val_accuracy300: 0.3646 - 58s/epoch - 45ms/step
Epoch 19/50
1290/1290 - 62s - loss: 3.2257 - accuracy300: 0.4093 - val_loss: 3.2781 - val_accuracy300: 0.3687 - 62s/epoch - 48ms/step
testing model: results/EXC/W1/deepOF_L1/h300
Evaluating performance on  test set...
5343/5343 - 92s - 92s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913224
{'0': {'precision': 0.3655620728959024, 'recall': 0.63052250295117, 'f1-score': 0.4628022936512774, 'support': 445586}, '1': {'precision': 0.34523976700163456, 'recall': 0.13049506253835, 'f1-score': 0.18939998582473827, 'support': 470991}, '2': {'precision': 0.3869124353943054, 'recall': 0.36118898864600946, 'f1-score': 0.37360846201811976, 'support': 451207}, 'accuracy': 0.36949182034590256, 'macro avg': {'precision': 0.36590475843061415, 'recall': 0.37406885137850976, 'f1-score': 0.3419369138313784, 'support': 1367784}, 'weighted avg': {'precision': 0.3656072626600536, 'recall': 0.36949182034590256, 'f1-score': 0.3392338738165435, 'support': 1367784}}
[[280952  55708 108926]
 [260217  61462 149312]
 [227379  60857 162971]]
Evaluating performance on  train set...
1290/1290 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855424
{'0': {'precision': 0.37555605457889557, 'recall': 0.6455143639605198, 'f1-score': 0.47484840085720276, 'support': 108814}, '1': {'precision': 0.34337587810428416, 'recall': 0.12740455212922172, 'f1-score': 0.18585160789353894, 'support': 108960}, '2': {'precision': 0.42253959909265265, 'recall': 0.3861284841151926, 'f1-score': 0.4035143175901822, 'support': 112403}, 'accuracy': 0.3862322330144135, 'macro avg': {'precision': 0.3804905105919441, 'recall': 0.38634913340164473, 'f1-score': 0.3547381087803079, 'support': 330177}, 'weighted avg': {'precision': 0.38093116951817413, 'recall': 0.3862322330144135, 'f1-score': 0.35519362319920805, 'support': 330177}}
[[70241 12676 25897]
 [61660 13882 33418]
 [55131 13870 43402]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0883317
{'0': {'precision': 0.36412219386811645, 'recall': 0.6519119351100812, 'f1-score': 0.46725911512404644, 'support': 30205}, '1': {'precision': 0.3637295081967213, 'recall': 0.12813956986012934, 'f1-score': 0.18951442489489956, 'support': 33245}, '2': {'precision': 0.3782065498632365, 'recall': 0.34809825134381167, 'f1-score': 0.3625283446712019, 'support': 29394}, 'accuracy': 0.36817672655206585, 'macro avg': {'precision': 0.3686860839760247, 'recall': 0.3760499187713407, 'f1-score': 0.3397672948967159, 'support': 92844}, 'weighted avg': {'precision': 0.3684406282847188, 'recall': 0.36817672655206585, 'f1-score': 0.3346487311104441, 'support': 92844}}
[[19691  3534  6980]
 [19143  4260  9842]
 [15244  3918 10232]]
training model: results/EXC/W1/deepOF_L1/h500
Epoch 1/50
1290/1290 - 65s - loss: 3.3102 - accuracy500: 0.3569 - val_loss: 3.2974 - val_accuracy500: 0.3487 - 65s/epoch - 50ms/step
Epoch 2/50
1290/1290 - 58s - loss: 3.2881 - accuracy500: 0.3658 - val_loss: 3.2887 - val_accuracy500: 0.3539 - 58s/epoch - 45ms/step
Epoch 3/50
1290/1290 - 60s - loss: 3.2813 - accuracy500: 0.3700 - val_loss: 3.2855 - val_accuracy500: 0.3563 - 60s/epoch - 46ms/step
Epoch 4/50
1290/1290 - 58s - loss: 3.2771 - accuracy500: 0.3721 - val_loss: 3.2834 - val_accuracy500: 0.3577 - 58s/epoch - 45ms/step
Epoch 5/50
1290/1290 - 60s - loss: 3.2746 - accuracy500: 0.3743 - val_loss: 3.2826 - val_accuracy500: 0.3602 - 60s/epoch - 47ms/step
Epoch 6/50
1290/1290 - 59s - loss: 3.2728 - accuracy500: 0.3752 - val_loss: 3.2812 - val_accuracy500: 0.3619 - 59s/epoch - 46ms/step
Epoch 7/50
1290/1290 - 62s - loss: 3.2709 - accuracy500: 0.3775 - val_loss: 3.2812 - val_accuracy500: 0.3624 - 62s/epoch - 48ms/step
Epoch 8/50
1290/1290 - 59s - loss: 3.2690 - accuracy500: 0.3788 - val_loss: 3.2805 - val_accuracy500: 0.3629 - 59s/epoch - 46ms/step
Epoch 9/50
1290/1290 - 57s - loss: 3.2671 - accuracy500: 0.3803 - val_loss: 3.2807 - val_accuracy500: 0.3638 - 57s/epoch - 44ms/step
Epoch 10/50
1290/1290 - 60s - loss: 3.2662 - accuracy500: 0.3810 - val_loss: 3.2796 - val_accuracy500: 0.3641 - 60s/epoch - 47ms/step
Epoch 11/50
1290/1290 - 55s - loss: 3.2642 - accuracy500: 0.3824 - val_loss: 3.2799 - val_accuracy500: 0.3632 - 55s/epoch - 43ms/step
Epoch 12/50
1290/1290 - 59s - loss: 3.2631 - accuracy500: 0.3839 - val_loss: 3.2795 - val_accuracy500: 0.3639 - 59s/epoch - 46ms/step
Epoch 13/50
1290/1290 - 57s - loss: 3.2616 - accuracy500: 0.3851 - val_loss: 3.2790 - val_accuracy500: 0.3640 - 57s/epoch - 45ms/step
Epoch 14/50
1290/1290 - 58s - loss: 3.2603 - accuracy500: 0.3863 - val_loss: 3.2787 - val_accuracy500: 0.3652 - 58s/epoch - 45ms/step
Epoch 15/50
1290/1290 - 62s - loss: 3.2590 - accuracy500: 0.3873 - val_loss: 3.2801 - val_accuracy500: 0.3653 - 62s/epoch - 48ms/step
Epoch 16/50
1290/1290 - 57s - loss: 3.2580 - accuracy500: 0.3893 - val_loss: 3.2805 - val_accuracy500: 0.3653 - 57s/epoch - 44ms/step
Epoch 17/50
1290/1290 - 59s - loss: 3.2555 - accuracy500: 0.3903 - val_loss: 3.2812 - val_accuracy500: 0.3643 - 59s/epoch - 45ms/step
Epoch 18/50
1290/1290 - 57s - loss: 3.2545 - accuracy500: 0.3921 - val_loss: 3.2805 - val_accuracy500: 0.3655 - 57s/epoch - 44ms/step
Epoch 19/50
1290/1290 - 55s - loss: 3.2527 - accuracy500: 0.3931 - val_loss: 3.2811 - val_accuracy500: 0.3645 - 55s/epoch - 43ms/step
Epoch 20/50
1290/1290 - 61s - loss: 3.2513 - accuracy500: 0.3943 - val_loss: 3.2840 - val_accuracy500: 0.3645 - 61s/epoch - 48ms/step
Epoch 21/50
1290/1290 - 61s - loss: 3.2497 - accuracy500: 0.3951 - val_loss: 3.2835 - val_accuracy500: 0.3651 - 61s/epoch - 48ms/step
Epoch 22/50
1290/1290 - 58s - loss: 3.2482 - accuracy500: 0.3963 - val_loss: 3.2811 - val_accuracy500: 0.3666 - 58s/epoch - 45ms/step
Epoch 23/50
1290/1290 - 59s - loss: 3.2453 - accuracy500: 0.3996 - val_loss: 3.2850 - val_accuracy500: 0.3652 - 59s/epoch - 45ms/step
Epoch 24/50
1290/1290 - 60s - loss: 3.2441 - accuracy500: 0.4007 - val_loss: 3.2876 - val_accuracy500: 0.3633 - 60s/epoch - 47ms/step
testing model: results/EXC/W1/deepOF_L1/h500
Evaluating performance on  test set...
5343/5343 - 94s - 94s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961921
{'0': {'precision': 0.366363986236487, 'recall': 0.6236079311440746, 'f1-score': 0.4615635726458798, 'support': 462531}, '1': {'precision': 0.34431833910034604, 'recall': 0.17022096725633845, 'f1-score': 0.22781622317937197, 'support': 438436}, '2': {'precision': 0.3894181203348592, 'recall': 0.30342725307775853, 'f1-score': 0.3410864100020228, 'support': 466817}, 'accuracy': 0.36900124581074206, 'macro avg': {'precision': 0.36670014855723077, 'recall': 0.36575205049272386, 'f1-score': 0.34348873527575813, 'support': 1367784}, 'weighted avg': {'precision': 0.36716561600377395, 'recall': 0.36900124581074206, 'f1-score': 0.34551890437617117, 'support': 1367784}}
[[288438  70223 103870]
 [245585  74631 118220]
 [253276  71896 141645]]
Evaluating performance on  train set...
1290/1290 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895879
{'0': {'precision': 0.36718914702534045, 'recall': 0.6411415004049179, 'f1-score': 0.4669504021447721, 'support': 108664}, '1': {'precision': 0.3666634844868735, 'recall': 0.17813975492333237, 'f1-score': 0.23978324114422706, 'support': 107803}, '2': {'precision': 0.41703949310744215, 'recall': 0.3229883035792806, 'f1-score': 0.36403734834668144, 'support': 113710}, 'accuracy': 0.3804020267916905, 'macro avg': {'precision': 0.38363070820655204, 'recall': 0.3807565196358436, 'f1-score': 0.3569236638785602, 'support': 330177}, 'weighted avg': {'precision': 0.38418553034205066, 'recall': 0.3804020267916905, 'f1-score': 0.35733784644064176, 'support': 330177}}
[[69669 15962 23033]
 [60293 19204 28306]
 [59774 17209 36727]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0930195
{'0': {'precision': 0.3580554580554581, 'recall': 0.6661442518039639, 'f1-score': 0.4657618683438538, 'support': 30627}, '1': {'precision': 0.3660741415982984, 'recall': 0.15171740704593395, 'f1-score': 0.21452578627551358, 'support': 31763}, '2': {'precision': 0.37969162995594713, 'recall': 0.28301700925986734, 'f1-score': 0.3243029687323626, 'support': 30454}, 'accuracy': 0.3644823575029081, 'macro avg': {'precision': 0.36794040986990123, 'recall': 0.36695955603658836, 'f1-score': 0.3348635411172433, 'support': 92844}, 'weighted avg': {'precision': 0.3678956784728111, 'recall': 0.3644823575029081, 'f1-score': 0.3334108170803899, 'support': 92844}}
[[20402  3981  6244]
 [19107  4819  7837]
 [17471  4364  8619]]
training model: results/EXC/W1/deepOF_L1/h1000
Epoch 1/50
1290/1290 - 65s - loss: 3.2737 - accuracy1000: 0.3908 - val_loss: 3.4459 - val_accuracy1000: 0.3237 - 65s/epoch - 51ms/step
Epoch 2/50
1290/1290 - 64s - loss: 3.2661 - accuracy1000: 0.3865 - val_loss: 3.3761 - val_accuracy1000: 0.3244 - 64s/epoch - 50ms/step
Epoch 3/50
1290/1290 - 63s - loss: 3.2749 - accuracy1000: 0.3802 - val_loss: 3.3494 - val_accuracy1000: 0.3256 - 63s/epoch - 49ms/step
Epoch 4/50
1290/1290 - 59s - loss: 3.2734 - accuracy1000: 0.3797 - val_loss: 3.3423 - val_accuracy1000: 0.3251 - 59s/epoch - 46ms/step
Epoch 5/50
1290/1290 - 63s - loss: 3.2734 - accuracy1000: 0.3780 - val_loss: 3.3418 - val_accuracy1000: 0.3257 - 63s/epoch - 49ms/step
Epoch 6/50
1290/1290 - 64s - loss: 3.2707 - accuracy1000: 0.3812 - val_loss: 3.3462 - val_accuracy1000: 0.3270 - 64s/epoch - 50ms/step
Epoch 7/50
1290/1290 - 64s - loss: 3.2683 - accuracy1000: 0.3850 - val_loss: 3.3465 - val_accuracy1000: 0.3289 - 64s/epoch - 50ms/step
Epoch 8/50
1290/1290 - 62s - loss: 3.2654 - accuracy1000: 0.3867 - val_loss: 3.3527 - val_accuracy1000: 0.3286 - 62s/epoch - 48ms/step
Epoch 9/50
1290/1290 - 63s - loss: 3.2621 - accuracy1000: 0.3883 - val_loss: 3.3546 - val_accuracy1000: 0.3287 - 63s/epoch - 49ms/step
Epoch 10/50
1290/1290 - 59s - loss: 3.2582 - accuracy1000: 0.3915 - val_loss: 3.3586 - val_accuracy1000: 0.3289 - 59s/epoch - 46ms/step
Epoch 11/50
1290/1290 - 62s - loss: 3.2555 - accuracy1000: 0.3924 - val_loss: 3.3591 - val_accuracy1000: 0.3286 - 62s/epoch - 48ms/step
Epoch 12/50
1290/1290 - 61s - loss: 3.2535 - accuracy1000: 0.3929 - val_loss: 3.3604 - val_accuracy1000: 0.3275 - 61s/epoch - 48ms/step
Epoch 13/50
1290/1290 - 65s - loss: 3.2534 - accuracy1000: 0.3937 - val_loss: 3.3622 - val_accuracy1000: 0.3280 - 65s/epoch - 50ms/step
Epoch 14/50
1290/1290 - 64s - loss: 3.2482 - accuracy1000: 0.3952 - val_loss: 3.3621 - val_accuracy1000: 0.3294 - 64s/epoch - 49ms/step
Epoch 15/50
1290/1290 - 69s - loss: 3.2456 - accuracy1000: 0.3964 - val_loss: 3.3623 - val_accuracy1000: 0.3298 - 69s/epoch - 53ms/step
testing model: results/EXC/W1/deepOF_L1/h1000
Evaluating performance on  test set...
5343/5343 - 109s - 109s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1405574
{'0': {'precision': 0.26337999885527025, 'recall': 0.7741450743221472, 'f1-score': 0.3930398099476371, 'support': 350703}, '1': {'precision': 0.44763271162123386, 'recall': 0.0009373704355768133, 'f1-score': 0.0018708232521743825, 'support': 665692}, '2': {'precision': 0.286251523486273, 'recall': 0.2733722455739935, 'f1-score': 0.2796636815688649, 'support': 351389}, 'accuracy': 0.2691791978850462, 'macro avg': {'precision': 0.3324214113209257, 'recall': 0.3494848967772392, 'f1-score': 0.22485810492289213, 'support': 1367784}, 'weighted avg': {'precision': 0.35893043593829166, 'recall': 0.2691791978850462, 'f1-score': 0.17353352133323283, 'support': 1367784}}
[[271495    370  78838]
 [504387    624 160681]
 [254929    400  96060]]
Evaluating performance on  train set...
1290/1290 - 28s - 28s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1029296
{'0': {'precision': 0.335540251031845, 'recall': 0.7828567125402414, 'f1-score': 0.46974365346761143, 'support': 106234}, '1': {'precision': 0.39065420560747666, 'recall': 0.0019092511898563037, 'f1-score': 0.0037999309103470846, 'support': 109467}, '2': {'precision': 0.3843369811090053, 'recall': 0.27458157168314756, 'f1-score': 0.3203183515828412, 'support': 114476}, 'accuracy': 0.3477165278017548, 'macro avg': {'precision': 0.370177145916109, 'recall': 0.35311584513774835, 'f1-score': 0.2646206453202666, 'support': 330177}, 'weighted avg': {'precision': 0.37073111453185764, 'recall': 0.3477165278017548, 'f1-score': 0.26345710917246973, 'support': 330177}}
[[83166   142 22926]
 [81832   209 27426]
 [82859   184 31433]]
Evaluating performance on  val set...
363/363 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1130055
{'0': {'precision': 0.323895540152629, 'recall': 0.7982813362782993, 'f1-score': 0.46081820083473624, 'support': 28976}, '1': {'precision': 0.4897959183673469, 'recall': 0.002045047859800608, 'f1-score': 0.004073089325111728, 'support': 35207}, '2': {'precision': 0.33572972464993894, 'recall': 0.24929346498726493, 'f1-score': 0.28612618384958854, 'support': 28661}, 'accuracy': 0.32687088018611865, 'macro avg': {'precision': 0.3831403943899716, 'recall': 0.34987328304178833, 'f1-score': 0.2503391580031455, 'support': 92844}, 'weighted avg': {'precision': 0.39045917568839844, 'recall': 0.32687088018611865, 'f1-score': 0.23369018998071586, 'support': 92844}}
[[23131    28  5817]
 [26815    72  8320]
 [21469    47  7145]]
training model: results/EXC/W1/deepLOB_L2/h10
Epoch 1/50
1290/1290 - 134s - loss: 2.7128 - accuracy10: 0.4593 - val_loss: 2.6645 - val_accuracy10: 0.4207 - 134s/epoch - 103ms/step
Epoch 2/50
1290/1290 - 125s - loss: 2.4074 - accuracy10: 0.5484 - val_loss: 2.4772 - val_accuracy10: 0.4977 - 125s/epoch - 97ms/step
Epoch 3/50
1290/1290 - 126s - loss: 2.2748 - accuracy10: 0.6001 - val_loss: 2.4273 - val_accuracy10: 0.5628 - 126s/epoch - 98ms/step
Epoch 4/50
1290/1290 - 120s - loss: 2.1299 - accuracy10: 0.6541 - val_loss: 2.3786 - val_accuracy10: 0.5784 - 120s/epoch - 93ms/step
Epoch 5/50
1290/1290 - 128s - loss: 2.0371 - accuracy10: 0.6735 - val_loss: 2.2611 - val_accuracy10: 0.6123 - 128s/epoch - 100ms/step
Epoch 6/50
1290/1290 - 125s - loss: 1.9838 - accuracy10: 0.6813 - val_loss: 2.2677 - val_accuracy10: 0.6380 - 125s/epoch - 97ms/step
Epoch 7/50
1290/1290 - 126s - loss: 1.9483 - accuracy10: 0.6835 - val_loss: 2.3291 - val_accuracy10: 0.6138 - 126s/epoch - 98ms/step
Epoch 8/50
1290/1290 - 122s - loss: 1.9234 - accuracy10: 0.6847 - val_loss: 2.1626 - val_accuracy10: 0.6575 - 122s/epoch - 94ms/step
Epoch 9/50
1290/1290 - 123s - loss: 1.9012 - accuracy10: 0.6857 - val_loss: 2.0913 - val_accuracy10: 0.6881 - 123s/epoch - 95ms/step
Epoch 10/50
1290/1290 - 127s - loss: 1.8837 - accuracy10: 0.6862 - val_loss: 2.0908 - val_accuracy10: 0.7038 - 127s/epoch - 98ms/step
Epoch 11/50
1290/1290 - 125s - loss: 1.8676 - accuracy10: 0.6862 - val_loss: 2.0770 - val_accuracy10: 0.7193 - 125s/epoch - 97ms/step
Epoch 12/50
1290/1290 - 122s - loss: 1.8519 - accuracy10: 0.6874 - val_loss: 2.1300 - val_accuracy10: 0.6897 - 122s/epoch - 94ms/step
Epoch 13/50
1290/1290 - 126s - loss: 1.8389 - accuracy10: 0.6870 - val_loss: 2.2101 - val_accuracy10: 0.6766 - 126s/epoch - 98ms/step
Epoch 14/50
1290/1290 - 127s - loss: 1.8237 - accuracy10: 0.6872 - val_loss: 2.2711 - val_accuracy10: 0.6510 - 127s/epoch - 98ms/step
Epoch 15/50
1290/1290 - 132s - loss: 1.8138 - accuracy10: 0.6877 - val_loss: 2.1630 - val_accuracy10: 0.6954 - 132s/epoch - 102ms/step
Epoch 16/50
1290/1290 - 128s - loss: 1.8058 - accuracy10: 0.6882 - val_loss: 2.1477 - val_accuracy10: 0.6985 - 128s/epoch - 99ms/step
Epoch 17/50
1290/1290 - 129s - loss: 1.7963 - accuracy10: 0.6881 - val_loss: 2.1851 - val_accuracy10: 0.6815 - 129s/epoch - 100ms/step
Epoch 18/50
1290/1290 - 127s - loss: 1.7841 - accuracy10: 0.6883 - val_loss: 2.1812 - val_accuracy10: 0.6906 - 127s/epoch - 98ms/step
Epoch 19/50
1290/1290 - 129s - loss: 1.7737 - accuracy10: 0.6891 - val_loss: 2.3150 - val_accuracy10: 0.6532 - 129s/epoch - 100ms/step
Epoch 20/50
1290/1290 - 129s - loss: 1.7649 - accuracy10: 0.6898 - val_loss: 2.1369 - val_accuracy10: 0.7184 - 129s/epoch - 100ms/step
Epoch 21/50
1290/1290 - 128s - loss: 1.7568 - accuracy10: 0.6900 - val_loss: 2.1832 - val_accuracy10: 0.6953 - 128s/epoch - 100ms/step
testing model: results/EXC/W1/deepLOB_L2/h10
Evaluating performance on  test set...
5343/5343 - 235s - 235s/epoch - 44ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68237877
{'0': {'precision': 0.36782243489081806, 'recall': 0.6413916031076639, 'f1-score': 0.467528615914756, 'support': 154843}, '1': {'precision': 0.871102003141685, 'recall': 0.7793052442383832, 'f1-score': 0.8226507250165317, 'support': 1055997}, '2': {'precision': 0.35531963544899225, 'recall': 0.34652657869753867, 'f1-score': 0.35086802531498573, 'support': 156949}, 'accuracy': 0.7140326468483077, 'macro avg': {'precision': 0.5314146911604984, 'recall': 0.589074475347862, 'f1-score': 0.5470157887487578, 'support': 1367789}, 'weighted avg': {'precision': 0.7549431182452065, 'recall': 0.7140326468483077, 'f1-score': 0.7283130781462146, 'support': 1367789}}
[[ 99315  43661  11867]
 [146242 822944  86811]
 [ 24451  78111  54387]]
Evaluating performance on  train set...
1290/1290 - 63s - 63s/epoch - 49ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62087023
{'0': {'precision': 0.36990393428154383, 'recall': 0.6851950828433993, 'f1-score': 0.4804408928079361, 'support': 31807}, '1': {'precision': 0.9416102100042977, 'recall': 0.734290803242946, 'f1-score': 0.8251271548623511, 'support': 265561}, '2': {'precision': 0.35852761501059716, 'recall': 0.7012100338321802, 'f1-score': 0.47446301700403176, 'support': 32809}, 'accuracy': 0.7262740893520748, 'macro avg': {'precision': 0.5566805864321462, 'recall': 0.7068986399728417, 'f1-score': 0.593343688224773, 'support': 330177}, 'weighted avg': {'precision': 0.8285962254715714, 'recall': 0.7262740893520748, 'f1-score': 0.7570776673566848, 'support': 330177}}
[[ 21794   6178   3835]
 [ 33235 194999  37327]
 [  3889   5914  23006]]
Evaluating performance on  val set...
363/363 - 17s - 17s/epoch - 48ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6418917
{'0': {'precision': 0.3534094234708809, 'recall': 0.665197752561419, 'f1-score': 0.4615855056952832, 'support': 9077}, '1': {'precision': 0.9383911525429559, 'recall': 0.7294276508416113, 'f1-score': 0.8208187275271179, 'support': 74797}, '2': {'precision': 0.3483936882733568, 'recall': 0.6842809364548496, 'f1-score': 0.4617120505491199, 'support': 8970}, 'accuracy': 0.7187863512989531, 'macro avg': {'precision': 0.5467314214290645, 'recall': 0.6929687799526266, 'f1-score': 0.581372094590507, 'support': 92844}, 'weighted avg': {'precision': 0.82419792078554, 'recall': 0.7187863512989531, 'f1-score': 0.7510032645240139, 'support': 92844}}
[[ 6038  1898  1141]
 [ 9899 54559 10339]
 [ 1148  1684  6138]]
training model: results/EXC/W1/deepLOB_L2/h20
Epoch 1/50
1290/1290 - 131s - loss: 2.7653 - accuracy20: 0.4630 - val_loss: 2.7643 - val_accuracy20: 0.5295 - 131s/epoch - 102ms/step
Epoch 2/50
1290/1290 - 120s - loss: 2.5017 - accuracy20: 0.5436 - val_loss: 2.5559 - val_accuracy20: 0.4882 - 120s/epoch - 93ms/step
Epoch 3/50
1290/1290 - 117s - loss: 2.3721 - accuracy20: 0.5919 - val_loss: 2.5210 - val_accuracy20: 0.5270 - 117s/epoch - 90ms/step
Epoch 4/50
1290/1290 - 125s - loss: 2.2532 - accuracy20: 0.6297 - val_loss: 2.3767 - val_accuracy20: 0.6360 - 125s/epoch - 97ms/step
Epoch 5/50
1290/1290 - 129s - loss: 2.1598 - accuracy20: 0.6519 - val_loss: 2.3138 - val_accuracy20: 0.6651 - 129s/epoch - 100ms/step
Epoch 6/50
1290/1290 - 131s - loss: 2.1066 - accuracy20: 0.6604 - val_loss: 2.2928 - val_accuracy20: 0.6687 - 131s/epoch - 101ms/step
Epoch 7/50
1290/1290 - 129s - loss: 2.0667 - accuracy20: 0.6644 - val_loss: 2.2663 - val_accuracy20: 0.6734 - 129s/epoch - 100ms/step
Epoch 8/50
1290/1290 - 127s - loss: 2.0382 - accuracy20: 0.6664 - val_loss: 2.2507 - val_accuracy20: 0.6791 - 127s/epoch - 99ms/step
Epoch 9/50
1290/1290 - 130s - loss: 2.0167 - accuracy20: 0.6669 - val_loss: 2.3097 - val_accuracy20: 0.6675 - 130s/epoch - 101ms/step
Epoch 10/50
1290/1290 - 125s - loss: 1.9977 - accuracy20: 0.6674 - val_loss: 2.3090 - val_accuracy20: 0.6785 - 125s/epoch - 97ms/step
Epoch 11/50
1290/1290 - 123s - loss: 1.9817 - accuracy20: 0.6693 - val_loss: 2.2846 - val_accuracy20: 0.6768 - 123s/epoch - 95ms/step
Epoch 12/50
1290/1290 - 127s - loss: 1.9681 - accuracy20: 0.6701 - val_loss: 2.2422 - val_accuracy20: 0.6880 - 127s/epoch - 99ms/step
Epoch 13/50
1290/1290 - 126s - loss: 1.9552 - accuracy20: 0.6711 - val_loss: 2.2649 - val_accuracy20: 0.6852 - 126s/epoch - 98ms/step
Epoch 14/50
1290/1290 - 123s - loss: 1.9424 - accuracy20: 0.6723 - val_loss: 2.2606 - val_accuracy20: 0.6876 - 123s/epoch - 96ms/step
Epoch 15/50
1290/1290 - 123s - loss: 1.9331 - accuracy20: 0.6722 - val_loss: 2.2595 - val_accuracy20: 0.6816 - 123s/epoch - 96ms/step
Epoch 16/50
1290/1290 - 122s - loss: 1.9216 - accuracy20: 0.6724 - val_loss: 2.2685 - val_accuracy20: 0.6802 - 122s/epoch - 95ms/step
Epoch 17/50
1290/1290 - 120s - loss: 1.9115 - accuracy20: 0.6737 - val_loss: 2.3472 - val_accuracy20: 0.6529 - 120s/epoch - 93ms/step
Epoch 18/50
1290/1290 - 122s - loss: 1.9032 - accuracy20: 0.6754 - val_loss: 2.3870 - val_accuracy20: 0.6527 - 122s/epoch - 94ms/step
Epoch 19/50
1290/1290 - 119s - loss: 1.8928 - accuracy20: 0.6751 - val_loss: 2.3873 - val_accuracy20: 0.6558 - 119s/epoch - 93ms/step
Epoch 20/50
1290/1290 - 116s - loss: 1.8845 - accuracy20: 0.6759 - val_loss: 2.4303 - val_accuracy20: 0.6598 - 116s/epoch - 90ms/step
Epoch 21/50
1290/1290 - 119s - loss: 1.8762 - accuracy20: 0.6765 - val_loss: 2.4442 - val_accuracy20: 0.6393 - 119s/epoch - 92ms/step
Epoch 22/50
1290/1290 - 121s - loss: 1.8644 - accuracy20: 0.6782 - val_loss: 2.4753 - val_accuracy20: 0.6580 - 121s/epoch - 94ms/step
testing model: results/EXC/W1/deepLOB_L2/h20
Evaluating performance on  test set...
5343/5343 - 242s - 242s/epoch - 45ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8085485
{'0': {'precision': 0.41696718221778994, 'recall': 0.6409659772695128, 'f1-score': 0.5052526712917507, 'support': 219177}, '1': {'precision': 0.7963741325423713, 'recall': 0.7333026990527104, 'f1-score': 0.7635381392815225, 'support': 927066}, '2': {'precision': 0.4185494064009389, 'recall': 0.3348153430890199, 'f1-score': 0.3720289891416104, 'support': 221546}, 'accuracy': 0.6539619780536325, 'macro avg': {'precision': 0.5439635737203667, 'recall': 0.569694673137081, 'f1-score': 0.5469399332382945, 'support': 1367789}, 'weighted avg': {'precision': 0.6743795603320226, 'recall': 0.6539619780536325, 'f1-score': 0.6587357756168847, 'support': 1367789}}
[[140485  63865  14827]
 [159026 679820  88220]
 [ 37410 109959  74177]]
Evaluating performance on  train set...
1290/1290 - 56s - 56s/epoch - 43ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66397774
{'0': {'precision': 0.42632456227828985, 'recall': 0.6678047800763205, 'f1-score': 0.5204166811589162, 'support': 44811}, '1': {'precision': 0.8922315726711193, 'recall': 0.7132339107203332, 'f1-score': 0.7927542764732398, 'support': 239181}, '2': {'precision': 0.43617253260063676, 'recall': 0.649626502111075, 'f1-score': 0.5219183801273354, 'support': 46185}, 'accuracy': 0.6981709810192714, 'macro avg': {'precision': 0.5849095558500153, 'recall': 0.6768883976359096, 'f1-score': 0.6116964459198305, 'support': 330177}, 'weighted avg': {'precision': 0.7652062322980215, 'recall': 0.6981709810192714, 'f1-score': 0.7179087364860035, 'support': 330177}}
[[ 29925  10204   4682]
 [ 34487 170592  34102]
 [  5781  10401  30003]]
Evaluating performance on  val set...
363/363 - 17s - 17s/epoch - 48ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6883815
{'0': {'precision': 0.39851247600767753, 'recall': 0.6524471678843585, 'f1-score': 0.4948017516160743, 'support': 12729}, '1': {'precision': 0.8858430619181321, 'recall': 0.7101751891835858, 'f1-score': 0.7883415664581672, 'support': 67527}, '2': {'precision': 0.4296507723304231, 'recall': 0.6098665395614872, 'f1-score': 0.5041371158392435, 'support': 12588}, 'accuracy': 0.6886605488776874, 'macro avg': {'precision': 0.5713354367520775, 'recall': 0.6574962988764771, 'f1-score': 0.5957601446378283, 'support': 92844}, 'weighted avg': {'precision': 0.7571779939612986, 'recall': 0.6886605488776874, 'f1-score': 0.7095638971686492, 'support': 92844}}
[[ 8305  3075  1349]
 [10729 47956  8842]
 [ 1806  3105  7677]]
training model: results/EXC/W1/deepLOB_L2/h30
Epoch 1/50
1290/1290 - 127s - loss: 2.8297 - accuracy30: 0.4673 - val_loss: 2.8457 - val_accuracy30: 0.4991 - 127s/epoch - 98ms/step
Epoch 2/50
1290/1290 - 122s - loss: 2.6200 - accuracy30: 0.5236 - val_loss: 2.7168 - val_accuracy30: 0.4959 - 122s/epoch - 94ms/step
Epoch 3/50
1290/1290 - 124s - loss: 2.5024 - accuracy30: 0.5667 - val_loss: 2.7222 - val_accuracy30: 0.5205 - 124s/epoch - 96ms/step
Epoch 4/50
1290/1290 - 123s - loss: 2.3920 - accuracy30: 0.6028 - val_loss: 2.6065 - val_accuracy30: 0.5161 - 123s/epoch - 95ms/step
Epoch 5/50
1290/1290 - 127s - loss: 2.2874 - accuracy30: 0.6290 - val_loss: 2.4839 - val_accuracy30: 0.5822 - 127s/epoch - 99ms/step
Epoch 6/50
1290/1290 - 124s - loss: 2.2280 - accuracy30: 0.6380 - val_loss: 2.4047 - val_accuracy30: 0.6126 - 124s/epoch - 96ms/step
Epoch 7/50
1290/1290 - 133s - loss: 2.1880 - accuracy30: 0.6434 - val_loss: 2.3547 - val_accuracy30: 0.6264 - 133s/epoch - 103ms/step
Epoch 8/50
1290/1290 - 129s - loss: 2.1560 - accuracy30: 0.6482 - val_loss: 2.3269 - val_accuracy30: 0.6501 - 129s/epoch - 100ms/step
Epoch 9/50
1290/1290 - 124s - loss: 2.1352 - accuracy30: 0.6504 - val_loss: 2.3389 - val_accuracy30: 0.6471 - 124s/epoch - 96ms/step
Epoch 10/50
1290/1290 - 121s - loss: 2.1163 - accuracy30: 0.6516 - val_loss: 2.3256 - val_accuracy30: 0.6427 - 121s/epoch - 94ms/step
Epoch 11/50
1290/1290 - 123s - loss: 2.0997 - accuracy30: 0.6539 - val_loss: 2.3087 - val_accuracy30: 0.6516 - 123s/epoch - 95ms/step
Epoch 12/50
1290/1290 - 120s - loss: 2.0874 - accuracy30: 0.6545 - val_loss: 2.3131 - val_accuracy30: 0.6519 - 120s/epoch - 93ms/step
Epoch 13/50
1290/1290 - 127s - loss: 2.0738 - accuracy30: 0.6559 - val_loss: 2.3308 - val_accuracy30: 0.6522 - 127s/epoch - 98ms/step
Epoch 14/50
1290/1290 - 121s - loss: 2.0642 - accuracy30: 0.6570 - val_loss: 2.3174 - val_accuracy30: 0.6425 - 121s/epoch - 93ms/step
Epoch 15/50
1290/1290 - 123s - loss: 2.0527 - accuracy30: 0.6573 - val_loss: 2.3294 - val_accuracy30: 0.6457 - 123s/epoch - 95ms/step
Epoch 16/50
1290/1290 - 115s - loss: 2.0450 - accuracy30: 0.6572 - val_loss: 2.3357 - val_accuracy30: 0.6547 - 115s/epoch - 89ms/step
Epoch 17/50
1290/1290 - 120s - loss: 2.0376 - accuracy30: 0.6576 - val_loss: 2.3386 - val_accuracy30: 0.6460 - 120s/epoch - 93ms/step
Epoch 18/50
1290/1290 - 123s - loss: 2.0282 - accuracy30: 0.6591 - val_loss: 2.3719 - val_accuracy30: 0.6435 - 123s/epoch - 95ms/step
Epoch 19/50
1290/1290 - 121s - loss: 2.0199 - accuracy30: 0.6602 - val_loss: 2.3623 - val_accuracy30: 0.6407 - 121s/epoch - 94ms/step
Epoch 20/50
1290/1290 - 126s - loss: 2.0120 - accuracy30: 0.6605 - val_loss: 2.4441 - val_accuracy30: 0.6343 - 126s/epoch - 97ms/step
Epoch 21/50
1290/1290 - 123s - loss: 2.0041 - accuracy30: 0.6614 - val_loss: 2.4155 - val_accuracy30: 0.6429 - 123s/epoch - 96ms/step
testing model: results/EXC/W1/deepLOB_L2/h30
Evaluating performance on  test set...
5343/5343 - 252s - 252s/epoch - 47ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8021176
{'0': {'precision': 0.49123121914989093, 'recall': 0.5916111334734708, 'f1-score': 0.5367685474339878, 'support': 268308}, '1': {'precision': 0.7322894710658169, 'recall': 0.7724508999662211, 'f1-score': 0.7518342324697749, 'support': 828920}, '2': {'precision': 0.5261491839575271, 'recall': 0.3311231108696375, 'f1-score': 0.4064523153840221, 'support': 270561}, 'accuracy': 0.6496784226222027, 'macro avg': {'precision': 0.5832232913910783, 'recall': 0.5650617147697765, 'f1-score': 0.5650183650959283, 'support': 1367789}, 'weighted avg': {'precision': 0.6442266341257886, 'recall': 0.6496784226222027, 'f1-score': 0.6413268949424075, 'support': 1367789}}
[[158734  94885  14689]
 [122625 640300  65995]
 [ 41776 139196  89589]]
Evaluating performance on  train set...
1290/1290 - 62s - 62s/epoch - 48ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71448654
{'0': {'precision': 0.4723213670502308, 'recall': 0.6267303015341854, 'f1-score': 0.5386791563197435, 'support': 54687}, '1': {'precision': 0.8449968841055698, 'recall': 0.6862982029757372, 'f1-score': 0.7574240235918133, 'support': 219307}, '2': {'precision': 0.46331123495150517, 'recall': 0.655536372212235, 'f1-score': 0.5429110528022641, 'support': 56183}, 'accuracy': 0.6711975697883257, 'macro avg': {'precision': 0.5935431620357686, 'recall': 0.6561882922407193, 'f1-score': 0.6130047442379403, 'support': 330177}, 'weighted avg': {'precision': 0.7183231581112453, 'recall': 0.6711975697883257, 'f1-score': 0.6846918744888264, 'support': 330177}}
[[ 34274  14412   6001]
 [ 32135 150510  36662]
 [  6156  13197  36830]]
Evaluating performance on  val set...
363/363 - 17s - 17s/epoch - 48ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7452142
{'0': {'precision': 0.4400718860881987, 'recall': 0.6166064049586777, 'f1-score': 0.5135927290327785, 'support': 15488}, '1': {'precision': 0.8434086686674425, 'recall': 0.6656944422063586, 'f1-score': 0.7440876096471477, 'support': 62057}, '2': {'precision': 0.438182474505911, 'recall': 0.6347473691090921, 'f1-score': 0.5184591975654681, 'support': 15299}, 'accuracy': 0.6524061867218129, 'macro avg': {'precision': 0.5738876764205174, 'recall': 0.6390160720913761, 'f1-score': 0.5920465120817981, 'support': 92844}, 'weighted avg': {'precision': 0.7093511567866038, 'recall': 0.6524061867218129, 'f1-score': 0.668457587379764, 'support': 92844}}
[[ 9550  4040  1898]
 [10193 41311 10553]
 [ 1958  3630  9711]]
training model: results/EXC/W1/deepLOB_L2/h50
Epoch 1/50
1290/1290 - 132s - loss: 2.9510 - accuracy50: 0.4510 - val_loss: 2.9779 - val_accuracy50: 0.4626 - 132s/epoch - 103ms/step
Epoch 2/50
1290/1290 - 118s - loss: 2.7557 - accuracy50: 0.5116 - val_loss: 2.9546 - val_accuracy50: 0.4898 - 118s/epoch - 92ms/step
Epoch 3/50
1290/1290 - 120s - loss: 2.6686 - accuracy50: 0.5488 - val_loss: 2.8962 - val_accuracy50: 0.5054 - 120s/epoch - 93ms/step
Epoch 4/50
1290/1290 - 125s - loss: 2.5824 - accuracy50: 0.5804 - val_loss: 2.8968 - val_accuracy50: 0.5001 - 125s/epoch - 97ms/step
Epoch 5/50
1290/1290 - 129s - loss: 2.5155 - accuracy50: 0.5953 - val_loss: 2.8373 - val_accuracy50: 0.5504 - 129s/epoch - 100ms/step
Epoch 6/50
1290/1290 - 127s - loss: 2.4656 - accuracy50: 0.6044 - val_loss: 2.7714 - val_accuracy50: 0.5663 - 127s/epoch - 98ms/step
Epoch 7/50
1290/1290 - 126s - loss: 2.4336 - accuracy50: 0.6078 - val_loss: 2.7275 - val_accuracy50: 0.5793 - 126s/epoch - 98ms/step
Epoch 8/50
1290/1290 - 126s - loss: 2.4058 - accuracy50: 0.6118 - val_loss: 2.6866 - val_accuracy50: 0.5773 - 126s/epoch - 97ms/step
Epoch 9/50
1290/1290 - 135s - loss: 2.3874 - accuracy50: 0.6136 - val_loss: 2.6978 - val_accuracy50: 0.5779 - 135s/epoch - 105ms/step
Epoch 10/50
1290/1290 - 131s - loss: 2.3695 - accuracy50: 0.6149 - val_loss: 2.6811 - val_accuracy50: 0.5846 - 131s/epoch - 102ms/step
Epoch 11/50
1290/1290 - 124s - loss: 2.3554 - accuracy50: 0.6168 - val_loss: 2.6699 - val_accuracy50: 0.5843 - 124s/epoch - 96ms/step
Epoch 12/50
1290/1290 - 122s - loss: 2.3423 - accuracy50: 0.6186 - val_loss: 2.6860 - val_accuracy50: 0.5738 - 122s/epoch - 94ms/step
Epoch 13/50
1290/1290 - 122s - loss: 2.3292 - accuracy50: 0.6198 - val_loss: 2.7066 - val_accuracy50: 0.5669 - 122s/epoch - 95ms/step
Epoch 14/50
1290/1290 - 123s - loss: 2.3191 - accuracy50: 0.6215 - val_loss: 2.6669 - val_accuracy50: 0.5769 - 123s/epoch - 96ms/step
Epoch 15/50
1290/1290 - 119s - loss: 2.3090 - accuracy50: 0.6222 - val_loss: 2.6969 - val_accuracy50: 0.5777 - 119s/epoch - 92ms/step
Epoch 16/50
1290/1290 - 116s - loss: 2.2974 - accuracy50: 0.6231 - val_loss: 2.7253 - val_accuracy50: 0.5686 - 116s/epoch - 90ms/step
Epoch 17/50
1290/1290 - 129s - loss: 2.2886 - accuracy50: 0.6232 - val_loss: 2.7091 - val_accuracy50: 0.5870 - 129s/epoch - 100ms/step
Epoch 18/50
1290/1290 - 122s - loss: 2.2777 - accuracy50: 0.6243 - val_loss: 2.7110 - val_accuracy50: 0.5854 - 122s/epoch - 95ms/step
Epoch 19/50
1290/1290 - 119s - loss: 2.2669 - accuracy50: 0.6262 - val_loss: 2.8176 - val_accuracy50: 0.5613 - 119s/epoch - 93ms/step
Epoch 20/50
1290/1290 - 124s - loss: 2.2572 - accuracy50: 0.6269 - val_loss: 2.8140 - val_accuracy50: 0.5684 - 124s/epoch - 96ms/step
Epoch 21/50
1290/1290 - 125s - loss: 2.2478 - accuracy50: 0.6289 - val_loss: 2.8319 - val_accuracy50: 0.5739 - 125s/epoch - 97ms/step
Epoch 22/50
1290/1290 - 132s - loss: 2.2390 - accuracy50: 0.6296 - val_loss: 2.7849 - val_accuracy50: 0.5742 - 132s/epoch - 102ms/step
Epoch 23/50
1290/1290 - 132s - loss: 2.2286 - accuracy50: 0.6315 - val_loss: 2.7917 - val_accuracy50: 0.5738 - 132s/epoch - 102ms/step
Epoch 24/50
1290/1290 - 127s - loss: 2.2212 - accuracy50: 0.6327 - val_loss: 2.8116 - val_accuracy50: 0.5717 - 127s/epoch - 98ms/step
testing model: results/EXC/W1/deepLOB_L2/h50
Evaluating performance on  test set...
5343/5343 - 247s - 247s/epoch - 46ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9787347
{'0': {'precision': 0.43652658192831617, 'recall': 0.6196869946869947, 'f1-score': 0.5122256551994091, 'support': 346320}, '1': {'precision': 0.6190285114186743, 'recall': 0.5867023599775382, 'f1-score': 0.6024320968445588, 'support': 673142}, '2': {'precision': 0.4914388162977394, 'recall': 0.3360204635299589, 'f1-score': 0.3991338374581198, 'support': 348327}, 'accuracy': 0.531214244302301, 'macro avg': {'precision': 0.5156646365482433, 'recall': 0.5141366060648306, 'f1-score': 0.5045971965006958, 'support': 1367789}, 'weighted avg': {'precision': 0.5403270421471048, 'recall': 0.531214244302301, 'f1-score': 0.527819296428816, 'support': 1367789}}
[[214610 100946  30764]
 [187849 394934  90359]
 [ 89172 142110 117045]]
Evaluating performance on  train set...
1290/1290 - 63s - 63s/epoch - 49ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86007494
{'0': {'precision': 0.44665874576914244, 'recall': 0.6348954046152536, 'f1-score': 0.5243964622931795, 'support': 70462}, '1': {'precision': 0.7397955823663448, 'recall': 0.5992670201756164, 'f1-score': 0.662157382847038, 'support': 187454}, '2': {'precision': 0.5180878552971576, 'recall': 0.5604821411273024, 'f1-score': 0.5384518230464984, 'support': 72261}, 'accuracy': 0.5983820799147124, 'macro avg': {'precision': 0.5681807278108816, 'recall': 0.5982148553060574, 'f1-score': 0.5750018893955718, 'support': 330177}, 'weighted avg': {'precision': 0.6287162829419191, 'recall': 0.5983820799147124, 'f1-score': 0.6056846502193481, 'support': 330177}}
[[ 44736  18279   7447]
 [ 44893 112335  30226]
 [ 10528  21232  40501]]
Evaluating performance on  val set...
363/363 - 18s - 18s/epoch - 50ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8832159
{'0': {'precision': 0.43414990016894484, 'recall': 0.5700241984271023, 'f1-score': 0.4928945074106364, 'support': 19836}, '1': {'precision': 0.7289023208600562, 'recall': 0.5914894413658829, 'f1-score': 0.6530456170810855, 'support': 53416}, '2': {'precision': 0.4560416133708536, 'recall': 0.54593711719069, 'f1-score': 0.4969567439483344, 'support': 19592}, 'accuracy': 0.5772909396406876, 'macro avg': {'precision': 0.5396979447999516, 'recall': 0.5691502523278916, 'f1-score': 0.5476322894800189, 'support': 92844}, 'weighted avg': {'precision': 0.6083496088058864, 'recall': 0.5772909396406876, 'f1-score': 0.5858915671280471, 'support': 92844}}
[[11307  5763  2766]
 [11829 31595  9992]
 [ 2908  5988 10696]]
training model: results/EXC/W1/deepLOB_L2/h100
Epoch 1/50
1290/1290 - 129s - loss: 3.1345 - accuracy100: 0.4454 - val_loss: 3.2319 - val_accuracy100: 0.4201 - 129s/epoch - 100ms/step
Epoch 2/50
1290/1290 - 124s - loss: 3.0258 - accuracy100: 0.4784 - val_loss: 3.1332 - val_accuracy100: 0.4447 - 124s/epoch - 97ms/step
Epoch 3/50
1290/1290 - 124s - loss: 2.9794 - accuracy100: 0.4933 - val_loss: 3.0988 - val_accuracy100: 0.4617 - 124s/epoch - 96ms/step
Epoch 4/50
1290/1290 - 124s - loss: 2.9446 - accuracy100: 0.5051 - val_loss: 3.1278 - val_accuracy100: 0.4457 - 124s/epoch - 96ms/step
Epoch 5/50
1290/1290 - 127s - loss: 2.9121 - accuracy100: 0.5146 - val_loss: 3.1577 - val_accuracy100: 0.4547 - 127s/epoch - 98ms/step
Epoch 6/50
1290/1290 - 128s - loss: 2.8835 - accuracy100: 0.5232 - val_loss: 3.1686 - val_accuracy100: 0.4593 - 128s/epoch - 99ms/step
Epoch 7/50
1290/1290 - 139s - loss: 2.8590 - accuracy100: 0.5294 - val_loss: 3.1164 - val_accuracy100: 0.4667 - 139s/epoch - 108ms/step
Epoch 8/50
1290/1290 - 134s - loss: 2.8369 - accuracy100: 0.5344 - val_loss: 3.1133 - val_accuracy100: 0.4806 - 134s/epoch - 104ms/step
Epoch 9/50
1290/1290 - 128s - loss: 2.8171 - accuracy100: 0.5406 - val_loss: 3.1107 - val_accuracy100: 0.4828 - 128s/epoch - 99ms/step
Epoch 10/50
1290/1290 - 124s - loss: 2.8014 - accuracy100: 0.5436 - val_loss: 3.0822 - val_accuracy100: 0.4821 - 124s/epoch - 96ms/step
Epoch 11/50
1290/1290 - 131s - loss: 2.7829 - accuracy100: 0.5477 - val_loss: 3.1047 - val_accuracy100: 0.4826 - 131s/epoch - 102ms/step
Epoch 12/50
1290/1290 - 124s - loss: 2.7680 - accuracy100: 0.5510 - val_loss: 3.1022 - val_accuracy100: 0.4823 - 124s/epoch - 96ms/step
Epoch 13/50
1290/1290 - 127s - loss: 2.7526 - accuracy100: 0.5550 - val_loss: 3.1222 - val_accuracy100: 0.4841 - 127s/epoch - 98ms/step
Epoch 14/50
1290/1290 - 129s - loss: 2.7384 - accuracy100: 0.5583 - val_loss: 3.1557 - val_accuracy100: 0.4809 - 129s/epoch - 100ms/step
Epoch 15/50
1290/1290 - 126s - loss: 2.7245 - accuracy100: 0.5605 - val_loss: 3.1507 - val_accuracy100: 0.4808 - 126s/epoch - 98ms/step
Epoch 16/50
1290/1290 - 126s - loss: 2.7132 - accuracy100: 0.5622 - val_loss: 3.1878 - val_accuracy100: 0.4784 - 126s/epoch - 98ms/step
Epoch 17/50
1290/1290 - 126s - loss: 2.6988 - accuracy100: 0.5661 - val_loss: 3.1844 - val_accuracy100: 0.4764 - 126s/epoch - 98ms/step
Epoch 18/50
1290/1290 - 122s - loss: 2.6886 - accuracy100: 0.5685 - val_loss: 3.1791 - val_accuracy100: 0.4768 - 122s/epoch - 95ms/step
Epoch 19/50
1290/1290 - 125s - loss: 2.6750 - accuracy100: 0.5717 - val_loss: 3.1945 - val_accuracy100: 0.4754 - 125s/epoch - 97ms/step
Epoch 20/50
1290/1290 - 126s - loss: 2.6634 - accuracy100: 0.5738 - val_loss: 3.2205 - val_accuracy100: 0.4721 - 126s/epoch - 97ms/step
testing model: results/EXC/W1/deepLOB_L2/h100
Evaluating performance on  test set...
5343/5343 - 242s - 242s/epoch - 45ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0818108
{'0': {'precision': 0.4939775303798436, 'recall': 0.4204544961727779, 'f1-score': 0.4542602787864589, 'support': 461170}, '1': {'precision': 0.38303003176980177, 'recall': 0.4141347214935688, 'f1-score': 0.39797553738117203, 'support': 442216}, '2': {'precision': 0.44886267631132176, 'recall': 0.4804964653544443, 'f1-score': 0.46414119090828726, 'support': 464403}, 'accuracy': 0.438797212143101, 'macro avg': {'precision': 0.4419567461536557, 'recall': 0.4383618943402637, 'f1-score': 0.43879233569197273, 'support': 1367789}, 'weighted avg': {'precision': 0.4427896405669251, 'recall': 0.438797212143101, 'f1-score': 0.43941786670888927, 'support': 1367789}}
[[193901 151481 115788]
 [100879 183137 158200]
 [ 97750 143509 223144]]
Evaluating performance on  train set...
1290/1290 - 54s - 54s/epoch - 42ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99332297
{'0': {'precision': 0.4819710620752844, 'recall': 0.5178534804544895, 'f1-score': 0.4992683843157416, 'support': 97516}, '1': {'precision': 0.51443811319138, 'recall': 0.5409108655174485, 'f1-score': 0.5273424633469722, 'support': 133192}, '2': {'precision': 0.5147677347548474, 'recall': 0.4417255627381395, 'f1-score': 0.47545773276197895, 'support': 99469}, 'accuracy': 0.50422046356954, 'macro avg': {'precision': 0.5037256366738373, 'recall': 0.5001633029033592, 'f1-score': 0.5006895268082309, 'support': 330177}, 'weighted avg': {'precision': 0.5049484460451504, 'recall': 0.50422046356954, 'f1-score': 0.5034201605900626, 'support': 330177}}
[[50499 31648 15369]
 [35099 72045 26048]
 [19178 36353 43938]]
Evaluating performance on  val set...
363/363 - 17s - 17s/epoch - 46ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0226663
{'0': {'precision': 0.46954751839674336, 'recall': 0.44378676334578815, 'f1-score': 0.45630384754369613, 'support': 27031}, '1': {'precision': 0.5225278695293146, 'recall': 0.5148487159928807, 'f1-score': 0.5186598703926641, 'support': 39330}, '2': {'precision': 0.4395319506726457, 'recall': 0.4737378695767096, 'f1-score': 0.45599433005615425, 'support': 26483}, 'accuracy': 0.48243289819482144, 'macro avg': {'precision': 0.4772024461995679, 'recall': 0.4774577829717928, 'f1-score': 0.47698601599750484, 'support': 92844}, 'weighted avg': {'precision': 0.483429028564409, 'recall': 0.48243289819482144, 'f1-score': 0.4826304322128976, 'support': 92844}}
[[11996  9116  5919]
 [ 9002 20249 10079]
 [ 4550  9387 12546]]
training model: results/EXC/W1/deepLOB_L2/h200
Epoch 1/50
1290/1290 - 138s - loss: 3.2581 - accuracy200: 0.3984 - val_loss: 3.2818 - val_accuracy200: 0.3736 - 138s/epoch - 107ms/step
Epoch 2/50
1290/1290 - 121s - loss: 3.2083 - accuracy200: 0.4176 - val_loss: 3.2775 - val_accuracy200: 0.3759 - 121s/epoch - 94ms/step
Epoch 3/50
1290/1290 - 129s - loss: 3.1879 - accuracy200: 0.4259 - val_loss: 3.3257 - val_accuracy200: 0.3712 - 129s/epoch - 100ms/step
Epoch 4/50
1290/1290 - 128s - loss: 3.1725 - accuracy200: 0.4322 - val_loss: 3.3062 - val_accuracy200: 0.3777 - 128s/epoch - 99ms/step
Epoch 5/50
1290/1290 - 126s - loss: 3.1580 - accuracy200: 0.4387 - val_loss: 3.3307 - val_accuracy200: 0.3771 - 126s/epoch - 98ms/step
Epoch 6/50
1290/1290 - 127s - loss: 3.1435 - accuracy200: 0.4437 - val_loss: 3.3483 - val_accuracy200: 0.3733 - 127s/epoch - 98ms/step
Epoch 7/50
1290/1290 - 125s - loss: 3.1306 - accuracy200: 0.4487 - val_loss: 3.3564 - val_accuracy200: 0.3743 - 125s/epoch - 97ms/step
Epoch 8/50
1290/1290 - 125s - loss: 3.1139 - accuracy200: 0.4544 - val_loss: 3.3635 - val_accuracy200: 0.3726 - 125s/epoch - 97ms/step
Epoch 9/50
1290/1290 - 125s - loss: 3.1013 - accuracy200: 0.4581 - val_loss: 3.3487 - val_accuracy200: 0.3795 - 125s/epoch - 97ms/step
Epoch 10/50
1290/1290 - 127s - loss: 3.0877 - accuracy200: 0.4635 - val_loss: 3.3773 - val_accuracy200: 0.3800 - 127s/epoch - 99ms/step
Epoch 11/50
1290/1290 - 128s - loss: 3.0770 - accuracy200: 0.4672 - val_loss: 3.3636 - val_accuracy200: 0.3826 - 128s/epoch - 99ms/step
Epoch 12/50
1290/1290 - 127s - loss: 3.0664 - accuracy200: 0.4710 - val_loss: 3.3796 - val_accuracy200: 0.3819 - 127s/epoch - 98ms/step
testing model: results/EXC/W1/deepLOB_L2/h200
Evaluating performance on  test set...
5343/5343 - 238s - 238s/epoch - 45ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038256
{'0': {'precision': 0.4027370850647927, 'recall': 0.37493701459595646, 'f1-score': 0.38834015536107863, 'support': 480270}, '1': {'precision': 0.29767451763895936, 'recall': 0.20863418504525522, 'f1-score': 0.2453249571539708, 'support': 402053}, '2': {'precision': 0.38988385925369395, 'recall': 0.5130925749692048, 'f1-score': 0.44308246749666025, 'support': 485466}, 'accuracy': 0.37508855532541935, 'macro avg': {'precision': 0.36343182065248203, 'recall': 0.3655545915368055, 'f1-score': 0.35891586000390324, 'support': 1367789}, 'weighted avg': {'precision': 0.3672926381926001, 'recall': 0.37508855532541935, 'f1-score': 0.3657312893871966, 'support': 1367789}}
[[180071  97448 202751]
 [131131  83882 187040]
 [135916 100461 249089]]
Evaluating performance on  train set...
1290/1290 - 61s - 61s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992789
{'0': {'precision': 0.3837537628637435, 'recall': 0.6034087364925605, 'f1-score': 0.46914337472274326, 'support': 109014}, '1': {'precision': 0.3318630841304433, 'recall': 0.23281425942709622, 'f1-score': 0.27365170231997593, 'support': 109233}, '2': {'precision': 0.4262911827014391, 'recall': 0.3128115786652372, 'f1-score': 0.3608397229779866, 'support': 111930}, 'accuracy': 0.38229192221141994, 'macro avg': {'precision': 0.38063600989854196, 'recall': 0.3830115248616313, 'f1-score': 0.36787826667356854, 'support': 330177}, 'weighted avg': {'precision': 0.3810068692047627, 'recall': 0.38229192221141994, 'f1-score': 0.36775360623080683, 'support': 330177}}
[[65780 22934 20300]
 [56981 25431 26821]
 [48651 28266 35013]]
Evaluating performance on  val set...
363/363 - 17s - 17s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925689
{'0': {'precision': 0.37998554913294796, 'recall': 0.5207102544638437, 'f1-score': 0.43935448836658825, 'support': 30299}, '1': {'precision': 0.34324728769173213, 'recall': 0.22333789745930321, 'f1-score': 0.2706040664344043, 'support': 32865}, '2': {'precision': 0.38867735470941883, 'recall': 0.3920822102425876, 'f1-score': 0.3903723582690372, 'support': 29680}, 'accuracy': 0.37432682779716514, 'macro avg': {'precision': 0.3706367305113663, 'recall': 0.37871012072191146, 'f1-score': 0.3667769710233433, 'support': 92844}, 'weighted avg': {'precision': 0.36975946911963636, 'recall': 0.37432682779716514, 'f1-score': 0.36396165481680004, 'support': 92844}}
[[15777  6629  7893]
 [15115  7340 10410]
 [10628  7415 11637]]
training model: results/EXC/W1/deepLOB_L2/h300
Epoch 1/50
1290/1290 - 134s - loss: 3.2826 - accuracy300: 0.3838 - val_loss: 3.3188 - val_accuracy300: 0.3548 - 134s/epoch - 104ms/step
Epoch 2/50
1290/1290 - 131s - loss: 3.2322 - accuracy300: 0.4038 - val_loss: 3.3260 - val_accuracy300: 0.3594 - 131s/epoch - 102ms/step
Epoch 3/50
1290/1290 - 126s - loss: 3.2161 - accuracy300: 0.4113 - val_loss: 3.3511 - val_accuracy300: 0.3611 - 126s/epoch - 98ms/step
Epoch 4/50
1290/1290 - 130s - loss: 3.2066 - accuracy300: 0.4162 - val_loss: 3.3671 - val_accuracy300: 0.3683 - 130s/epoch - 101ms/step
Epoch 5/50
1290/1290 - 127s - loss: 3.1919 - accuracy300: 0.4236 - val_loss: 3.4035 - val_accuracy300: 0.3601 - 127s/epoch - 99ms/step
Epoch 6/50
1290/1290 - 128s - loss: 3.1761 - accuracy300: 0.4318 - val_loss: 3.4349 - val_accuracy300: 0.3582 - 128s/epoch - 99ms/step
Epoch 7/50
1290/1290 - 126s - loss: 3.1610 - accuracy300: 0.4399 - val_loss: 3.3721 - val_accuracy300: 0.3654 - 126s/epoch - 97ms/step
Epoch 8/50
1290/1290 - 130s - loss: 3.1465 - accuracy300: 0.4456 - val_loss: 3.4304 - val_accuracy300: 0.3609 - 130s/epoch - 101ms/step
Epoch 9/50
1290/1290 - 129s - loss: 3.1356 - accuracy300: 0.4494 - val_loss: 3.4444 - val_accuracy300: 0.3631 - 129s/epoch - 100ms/step
Epoch 10/50
1290/1290 - 127s - loss: 3.1209 - accuracy300: 0.4550 - val_loss: 3.4793 - val_accuracy300: 0.3496 - 127s/epoch - 98ms/step
Epoch 11/50
1290/1290 - 128s - loss: 3.1073 - accuracy300: 0.4588 - val_loss: 3.5362 - val_accuracy300: 0.3507 - 128s/epoch - 99ms/step
testing model: results/EXC/W1/deepLOB_L2/h300
Evaluating performance on  test set...
5343/5343 - 248s - 248s/epoch - 46ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162438
{'0': {'precision': 0.3618416237710717, 'recall': 0.2662953221361437, 'f1-score': 0.3068016692608814, 'support': 445588}, '1': {'precision': 0.33958989257903827, 'recall': 0.5782403485416919, 'f1-score': 0.42788866404394116, 'support': 470991}, '2': {'precision': 0.32481629084060604, 'recall': 0.17124177212384478, 'f1-score': 0.22425647887201308, 'support': 451210}, 'accuracy': 0.3423554364013748, 'macro avg': {'precision': 0.3420826023969053, 'recall': 0.33859248093389344, 'f1-score': 0.31964893739227856, 'support': 1367789}, 'weighted avg': {'precision': 0.3419653375913887, 'recall': 0.3423554364013748, 'f1-score': 0.32126710903595407, 'support': 1367789}}
[[118658 255031  71899]
 [109934 272346  88711]
 [ 99336 274608  77266]]
Evaluating performance on  train set...
1290/1290 - 62s - 62s/epoch - 48ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.107902
{'0': {'precision': 0.3739570141639497, 'recall': 0.38282104798595085, 'f1-score': 0.3783371194911404, 'support': 108761}, '1': {'precision': 0.3300065435716521, 'recall': 0.532023997358089, 'f1-score': 0.40734380542005993, 'support': 109012}, '2': {'precision': 0.4215533845404126, 'recall': 0.16161346571296395, 'f1-score': 0.23365080998347232, 'support': 112404}, 'accuracy': 0.3567753053665155, 'macro avg': {'precision': 0.37517231409200474, 'recall': 0.3588195036856679, 'f1-score': 0.33977724496489087, 'support': 330177}, 'weighted avg': {'precision': 0.37564972357613885, 'recall': 0.3567753053665155, 'f1-score': 0.3386576654788484, 'support': 330177}}
[[41636 55457 11668]
 [37756 57997 13259]
 [31947 62291 18166]]
Evaluating performance on  val set...
363/363 - 19s - 19s/epoch - 52ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063865
{'0': {'precision': 0.3534855468610426, 'recall': 0.3271170188142711, 'f1-score': 0.33979048600377815, 'support': 30243}, '1': {'precision': 0.3553164986977692, 'recall': 0.4718354335207964, 'f1-score': 0.4053690928351807, 'support': 33251}, '2': {'precision': 0.3566322094483625, 'recall': 0.2515502555366269, 'f1-score': 0.2950131862862623, 'support': 29350}, 'accuracy': 0.35505794666322005, 'macro avg': {'precision': 0.35514475166905807, 'recall': 0.3501675692905648, 'f1-score': 0.34672425504174037, 'support': 92844}, 'weighted avg': {'precision': 0.35513600921144584, 'recall': 0.35505794666322005, 'f1-score': 0.3491216275858069, 'support': 92844}}
[[ 9893 13933  6417]
 [10660 15689  6902]
 [ 7434 14533  7383]]
training model: results/EXC/W1/deepLOB_L2/h500
Epoch 1/50
1290/1290 - 147s - loss: 3.2840 - accuracy500: 0.3850 - val_loss: 3.4069 - val_accuracy500: 0.3438 - 147s/epoch - 114ms/step
Epoch 2/50
1290/1290 - 129s - loss: 3.2392 - accuracy500: 0.4036 - val_loss: 3.4153 - val_accuracy500: 0.3419 - 129s/epoch - 100ms/step
Epoch 3/50
1290/1290 - 128s - loss: 3.2158 - accuracy500: 0.4166 - val_loss: 3.4533 - val_accuracy500: 0.3370 - 128s/epoch - 99ms/step
Epoch 4/50
1290/1290 - 130s - loss: 3.1957 - accuracy500: 0.4241 - val_loss: 3.4730 - val_accuracy500: 0.3373 - 130s/epoch - 101ms/step
Epoch 5/50
1290/1290 - 129s - loss: 3.1781 - accuracy500: 0.4322 - val_loss: 3.5239 - val_accuracy500: 0.3390 - 129s/epoch - 100ms/step
Epoch 6/50
1290/1290 - 128s - loss: 3.1637 - accuracy500: 0.4389 - val_loss: 3.6226 - val_accuracy500: 0.3363 - 128s/epoch - 99ms/step
Epoch 7/50
1290/1290 - 130s - loss: 3.1481 - accuracy500: 0.4445 - val_loss: 3.6003 - val_accuracy500: 0.3388 - 130s/epoch - 101ms/step
Epoch 8/50
1290/1290 - 129s - loss: 3.1363 - accuracy500: 0.4494 - val_loss: 3.5334 - val_accuracy500: 0.3369 - 129s/epoch - 100ms/step
Epoch 9/50
1290/1290 - 125s - loss: 3.1149 - accuracy500: 0.4563 - val_loss: 3.5486 - val_accuracy500: 0.3389 - 125s/epoch - 97ms/step
Epoch 10/50
1290/1290 - 125s - loss: 3.0991 - accuracy500: 0.4622 - val_loss: 3.5227 - val_accuracy500: 0.3415 - 125s/epoch - 97ms/step
Epoch 11/50
1290/1290 - 129s - loss: 3.0786 - accuracy500: 0.4683 - val_loss: 3.5761 - val_accuracy500: 0.3390 - 129s/epoch - 100ms/step
testing model: results/EXC/W1/deepLOB_L2/h500
Evaluating performance on  test set...
5343/5343 - 242s - 242s/epoch - 45ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1401217
{'0': {'precision': 0.3349533196210517, 'recall': 0.473545728530227, 'f1-score': 0.3923708113850253, 'support': 462534}, '1': {'precision': 0.31107821188705137, 'recall': 0.27509083403088697, 'f1-score': 0.2919798148769054, 'support': 438437}, '2': {'precision': 0.33868554504258674, 'recall': 0.23663397726737187, 'f1-score': 0.27860868424769475, 'support': 466818}, 'accuracy': 0.32907561034633265, 'macro avg': {'precision': 0.3282390255168966, 'recall': 0.328423513276162, 'f1-score': 0.3209864368365418, 'support': 1367789}, 'weighted avg': {'precision': 0.3285740750133368, 'recall': 0.32907561034633265, 'f1-score': 0.3213647307673095, 'support': 1367789}}
[[219031 132806 110697]
 [212831 120610 104996]
 [222053 134300 110465]]
Evaluating performance on  train set...
1290/1290 - 66s - 66s/epoch - 51ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1485989
{'0': {'precision': 0.3372753980209226, 'recall': 0.7457240383111446, 'f1-score': 0.46447738271590794, 'support': 108689}, '1': {'precision': 0.32753260082105773, 'recall': 0.2012893052592524, 'f1-score': 0.24934220353199366, 'support': 107810}, '2': {'precision': 0.389291311899013, 'recall': 0.08084237935220535, 'f1-score': 0.13388207014604656, 'support': 113678}, 'accuracy': 0.3390393637352087, 'macro avg': {'precision': 0.3513664369136644, 'recall': 0.3426185743075341, 'f1-score': 0.2825672187979827, 'support': 330177}, 'weighted avg': {'precision': 0.35200293534701166, 'recall': 0.3390393637352087, 'f1-score': 0.2804090266216479, 'support': 330177}}
[[81052 20905  6732]
 [78424 21701  7685]
 [80838 23650  9190]]
Evaluating performance on  val set...
363/363 - 19s - 19s/epoch - 53ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1370692
{'0': {'precision': 0.34053617692336574, 'recall': 0.5913862806468441, 'f1-score': 0.4321999571112011, 'support': 30672}, '1': {'precision': 0.34515332073826477, 'recall': 0.2245579753537773, 'f1-score': 0.27209195753456045, 'support': 31729}, '2': {'precision': 0.3519936625297069, 'recall': 0.21893374503169857, 'f1-score': 0.26995828101583697, 'support': 30443}, 'accuracy': 0.34389944422902935, 'macro avg': {'precision': 0.3458943867304458, 'recall': 0.34495933367743997, 'f1-score': 0.32475006522053285, 'support': 92844}, 'weighted avg': {'precision': 0.3458709060433603, 'recall': 0.34389944422902935, 'f1-score': 0.3242857131757998, 'support': 92844}}
[[18139  6507  6026]
 [18360  7125  6244]
 [16767  7011  6665]]
training model: results/EXC/W1/deepLOB_L2/h1000
Epoch 1/50
1290/1290 - 140s - loss: 3.1889 - accuracy1000: 0.4430 - val_loss: 3.6570 - val_accuracy1000: 0.3136 - 140s/epoch - 108ms/step
Epoch 2/50
1290/1290 - 130s - loss: 3.1345 - accuracy1000: 0.4557 - val_loss: 3.4568 - val_accuracy1000: 0.3233 - 130s/epoch - 100ms/step
Epoch 3/50
1290/1290 - 129s - loss: 3.1142 - accuracy1000: 0.4648 - val_loss: 3.5266 - val_accuracy1000: 0.3206 - 129s/epoch - 100ms/step
Epoch 4/50
1290/1290 - 130s - loss: 3.0928 - accuracy1000: 0.4714 - val_loss: 3.4016 - val_accuracy1000: 0.3404 - 130s/epoch - 101ms/step
Epoch 5/50
1290/1290 - 128s - loss: 3.0741 - accuracy1000: 0.4790 - val_loss: 3.4174 - val_accuracy1000: 0.3382 - 128s/epoch - 99ms/step
Epoch 6/50
1290/1290 - 123s - loss: 3.0524 - accuracy1000: 0.4911 - val_loss: 3.4900 - val_accuracy1000: 0.3418 - 123s/epoch - 95ms/step
Epoch 7/50
1290/1290 - 130s - loss: 3.0395 - accuracy1000: 0.4938 - val_loss: 3.4664 - val_accuracy1000: 0.3583 - 130s/epoch - 101ms/step
Epoch 8/50
1290/1290 - 126s - loss: 3.0230 - accuracy1000: 0.4976 - val_loss: 3.4495 - val_accuracy1000: 0.3540 - 126s/epoch - 98ms/step
Epoch 9/50
1290/1290 - 132s - loss: 3.0006 - accuracy1000: 0.5053 - val_loss: 3.4308 - val_accuracy1000: 0.4064 - 132s/epoch - 102ms/step
Epoch 10/50
1290/1290 - 124s - loss: 2.9808 - accuracy1000: 0.5129 - val_loss: 3.4491 - val_accuracy1000: 0.3978 - 124s/epoch - 96ms/step
Epoch 11/50
1290/1290 - 132s - loss: 2.9629 - accuracy1000: 0.5172 - val_loss: 3.5033 - val_accuracy1000: 0.3758 - 132s/epoch - 103ms/step
Epoch 12/50
1290/1290 - 126s - loss: 2.9454 - accuracy1000: 0.5235 - val_loss: 3.4757 - val_accuracy1000: 0.3814 - 126s/epoch - 98ms/step
Epoch 13/50
1290/1290 - 125s - loss: 2.9302 - accuracy1000: 0.5267 - val_loss: 3.5905 - val_accuracy1000: 0.3570 - 125s/epoch - 97ms/step
Epoch 14/50
1290/1290 - 127s - loss: 2.9106 - accuracy1000: 0.5336 - val_loss: 3.6629 - val_accuracy1000: 0.3381 - 127s/epoch - 99ms/step
testing model: results/EXC/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
5343/5343 - 247s - 247s/epoch - 46ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2085639
{'0': {'precision': 0.2556350912560603, 'recall': 0.5553768683740797, 'f1-score': 0.35011522269797274, 'support': 350706}, '1': {'precision': 0.43968588451101376, 'recall': 0.043568196703580635, 'f1-score': 0.07928053522493525, 'support': 665692}, '2': {'precision': 0.25189292911332384, 'recall': 0.3870275561980813, 'f1-score': 0.30516944446002725, 'support': 351391}, 'accuracy': 0.2630339913539296, 'macro avg': {'precision': 0.31573796829346595, 'recall': 0.3286575404252472, 'f1-score': 0.2448550674609784, 'support': 1367789}, 'weighted avg': {'precision': 0.3442497668865692, 'recall': 0.2630339913539296, 'f1-score': 0.2067553720674214, 'support': 1367789}}
[[194774  17900 138032]
 [370815  29003 265874]
 [196333  19060 135998]]
Evaluating performance on  train set...
1290/1290 - 63s - 63s/epoch - 49ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1428354
{'0': {'precision': 0.3267527514726858, 'recall': 0.8130995979927883, 'f1-score': 0.4661700806952203, 'support': 106217}, '1': {'precision': 0.4024718504757933, 'recall': 0.09695774081888009, 'f1-score': 0.15626932022256895, 'support': 109491}, '2': {'precision': 0.45189556056423635, 'recall': 0.15588499943216066, 'f1-score': 0.23180649016602145, 'support': 114469}, 'accuracy': 0.34776801533722823, 'macro avg': {'precision': 0.3937067208375718, 'recall': 0.35531411274794306, 'f1-score': 0.28474863036127024, 'support': 330177}, 'weighted avg': {'precision': 0.3952479285530093, 'recall': 0.34776801533722823, 'f1-score': 0.28215147852366407, 'support': 330177}}
[[86365  7587 12265]
 [89497 10616  9378]
 [88451  8174 17844]]
Evaluating performance on  val set...
363/363 - 19s - 19s/epoch - 52ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357785
{'0': {'precision': 0.3020657398986618, 'recall': 0.6415341634187562, 'f1-score': 0.4107365654915037, 'support': 28993}, '1': {'precision': 0.5297858099062919, 'recall': 0.08999431495167709, 'f1-score': 0.1538536300903878, 'support': 35180}, '2': {'precision': 0.3860509251937371, 'recall': 0.3405531721949008, 'f1-score': 0.36187758278820675, 'support': 28671}, 'accuracy': 0.33960191288613156, 'macro avg': {'precision': 0.4059674916662303, 'recall': 0.3573605501884447, 'f1-score': 0.30882259279003277, 'support': 92844}, 'weighted avg': {'precision': 0.4142876531129086, 'recall': 0.33960191288613156, 'f1-score': 0.29831166393084835, 'support': 92844}}
[[18600  1383  9010]
 [25496  3166  6518]
 [17480  1427  9764]]
training model: results/EXC/W1/deepOF_L2/h10
Epoch 1/50
1290/1290 - 99s - loss: 2.6104 - accuracy10: 0.5187 - val_loss: 2.5513 - val_accuracy10: 0.7533 - 99s/epoch - 77ms/step
Epoch 2/50
1290/1290 - 90s - loss: 2.1407 - accuracy10: 0.6349 - val_loss: 2.4431 - val_accuracy10: 0.7308 - 90s/epoch - 69ms/step
Epoch 3/50
1290/1290 - 93s - loss: 2.0316 - accuracy10: 0.6520 - val_loss: 2.3477 - val_accuracy10: 0.7241 - 93s/epoch - 72ms/step
Epoch 4/50
1290/1290 - 92s - loss: 1.9882 - accuracy10: 0.6578 - val_loss: 2.3166 - val_accuracy10: 0.7335 - 92s/epoch - 72ms/step
Epoch 5/50
1290/1290 - 91s - loss: 1.9627 - accuracy10: 0.6613 - val_loss: 2.2837 - val_accuracy10: 0.7366 - 91s/epoch - 71ms/step
Epoch 6/50
1290/1290 - 90s - loss: 1.9432 - accuracy10: 0.6634 - val_loss: 2.2491 - val_accuracy10: 0.7397 - 90s/epoch - 70ms/step
Epoch 7/50
1290/1290 - 93s - loss: 1.9260 - accuracy10: 0.6654 - val_loss: 2.2386 - val_accuracy10: 0.7281 - 93s/epoch - 72ms/step
Epoch 8/50
1290/1290 - 92s - loss: 1.9158 - accuracy10: 0.6671 - val_loss: 2.2246 - val_accuracy10: 0.7383 - 92s/epoch - 71ms/step
Epoch 9/50
1290/1290 - 90s - loss: 1.9030 - accuracy10: 0.6694 - val_loss: 2.2069 - val_accuracy10: 0.7351 - 90s/epoch - 70ms/step
Epoch 10/50
1290/1290 - 95s - loss: 1.8963 - accuracy10: 0.6694 - val_loss: 2.2166 - val_accuracy10: 0.7302 - 95s/epoch - 74ms/step
Epoch 11/50
1290/1290 - 91s - loss: 1.8866 - accuracy10: 0.6715 - val_loss: 2.2281 - val_accuracy10: 0.7330 - 91s/epoch - 70ms/step
Epoch 12/50
1290/1290 - 90s - loss: 1.8782 - accuracy10: 0.6728 - val_loss: 2.2147 - val_accuracy10: 0.7426 - 90s/epoch - 70ms/step
Epoch 13/50
1290/1290 - 93s - loss: 1.8691 - accuracy10: 0.6734 - val_loss: 2.2120 - val_accuracy10: 0.7343 - 93s/epoch - 72ms/step
Epoch 14/50
1290/1290 - 96s - loss: 1.8614 - accuracy10: 0.6739 - val_loss: 2.2036 - val_accuracy10: 0.7321 - 96s/epoch - 74ms/step
Epoch 15/50
1290/1290 - 91s - loss: 1.8516 - accuracy10: 0.6758 - val_loss: 2.2264 - val_accuracy10: 0.7392 - 91s/epoch - 71ms/step
Epoch 16/50
1290/1290 - 89s - loss: 1.8439 - accuracy10: 0.6759 - val_loss: 2.2363 - val_accuracy10: 0.7342 - 89s/epoch - 69ms/step
Epoch 17/50
1290/1290 - 85s - loss: 1.8398 - accuracy10: 0.6759 - val_loss: 2.2146 - val_accuracy10: 0.7330 - 85s/epoch - 66ms/step
Epoch 18/50
1290/1290 - 91s - loss: 1.8357 - accuracy10: 0.6765 - val_loss: 2.2359 - val_accuracy10: 0.7329 - 91s/epoch - 71ms/step
Epoch 19/50
1290/1290 - 91s - loss: 1.8270 - accuracy10: 0.6775 - val_loss: 2.2394 - val_accuracy10: 0.7303 - 91s/epoch - 71ms/step
Epoch 20/50
1290/1290 - 91s - loss: 1.8234 - accuracy10: 0.6783 - val_loss: 2.2278 - val_accuracy10: 0.7321 - 91s/epoch - 71ms/step
Epoch 21/50
1290/1290 - 92s - loss: 1.8137 - accuracy10: 0.6794 - val_loss: 2.2434 - val_accuracy10: 0.7369 - 92s/epoch - 72ms/step
Epoch 22/50
1290/1290 - 94s - loss: 1.8060 - accuracy10: 0.6799 - val_loss: 2.2295 - val_accuracy10: 0.7308 - 94s/epoch - 73ms/step
Epoch 23/50
1290/1290 - 88s - loss: 1.8007 - accuracy10: 0.6801 - val_loss: 2.2410 - val_accuracy10: 0.7255 - 88s/epoch - 68ms/step
Epoch 24/50
1290/1290 - 90s - loss: 1.7950 - accuracy10: 0.6811 - val_loss: 2.2182 - val_accuracy10: 0.7298 - 90s/epoch - 70ms/step
testing model: results/EXC/W1/deepOF_L2/h10
Evaluating performance on  test set...
5343/5343 - 170s - 170s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6964657
{'0': {'precision': 0.36799697604363135, 'recall': 0.6161635731907363, 'f1-score': 0.4607913451902295, 'support': 154842}, '1': {'precision': 0.9165919825004506, 'recall': 0.7031387459220925, 'f1-score': 0.7958005930100269, 'support': 1055995}, '2': {'precision': 0.3702750608994012, 'recall': 0.7040975615972271, 'f1-score': 0.48532466676914293, 'support': 156947}, 'accuracy': 0.6934026132781199, 'macro avg': {'precision': 0.5516213398144943, 'recall': 0.674466626903352, 'f1-score': 0.580638868323133, 'support': 1367784}, 'weighted avg': {'precision': 0.7918000929299432, 'recall': 0.6934026132781199, 'f1-score': 0.7222496762376117, 'support': 1367784}}
[[ 95408  37651  21783]
 [147330 742511 166154]
 [ 16525  29916 110506]]
Evaluating performance on  train set...
1290/1290 - 41s - 41s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.587835
{'0': {'precision': 0.3909830007390983, 'recall': 0.5978339350180505, 'f1-score': 0.47277286099077737, 'support': 31855}, '1': {'precision': 0.932791165878017, 'recall': 0.7520185282819914, 'f1-score': 0.8327067943513496, 'support': 265540}, '2': {'precision': 0.35343522777860215, 'recall': 0.7265572570312977, 'f1-score': 0.475542067643653, 'support': 32782}, 'accuracy': 0.7346150700987653, 'macro avg': {'precision': 0.5590697981319058, 'recall': 0.6921365734437798, 'f1-score': 0.5936739076619267, 'support': 330177}, 'weighted avg': {'precision': 0.8229962817301955, 'recall': 0.7346150700987653, 'f1-score': 0.7625193811816475, 'support': 330177}}
[[ 19044   8575   4236]
 [ 26513 199691  39336]
 [  3151   5813  23818]]
Evaluating performance on  val set...
363/363 - 11s - 11s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5986851
{'0': {'precision': 0.3877774304470147, 'recall': 0.5518852185518852, 'f1-score': 0.4555009868270069, 'support': 8991}, '1': {'precision': 0.9277256424114381, 'recall': 0.7565206939380584, 'f1-score': 0.8334216101694916, 'support': 74877}, '2': {'precision': 0.3359839907314761, 'recall': 0.7107843137254902, 'f1-score': 0.4562846415161809, 'support': 8976}, 'accuracy': 0.7322821076213865, 'macro avg': {'precision': 0.5504956878633096, 'recall': 0.673063408738478, 'f1-score': 0.5817357461708931, 'support': 92844}, 'weighted avg': {'precision': 0.8182285565550393, 'recall': 0.7322821076213865, 'f1-score': 0.7603628691080941, 'support': 92844}}
[[ 4962  2752  1277]
 [ 6899 56646 11332]
 [  935  1661  6380]]
training model: results/EXC/W1/deepOF_L2/h20
Epoch 1/50
1290/1290 - 98s - loss: 2.6554 - accuracy20: 0.5203 - val_loss: 2.5984 - val_accuracy20: 0.7161 - 98s/epoch - 76ms/step
Epoch 2/50
1290/1290 - 87s - loss: 2.2338 - accuracy20: 0.6243 - val_loss: 2.4874 - val_accuracy20: 0.7183 - 87s/epoch - 67ms/step
Epoch 3/50
1290/1290 - 92s - loss: 2.1225 - accuracy20: 0.6470 - val_loss: 2.4011 - val_accuracy20: 0.7119 - 92s/epoch - 72ms/step
Epoch 4/50
1290/1290 - 90s - loss: 2.0809 - accuracy20: 0.6517 - val_loss: 2.3358 - val_accuracy20: 0.7187 - 90s/epoch - 69ms/step
Epoch 5/50
1290/1290 - 90s - loss: 2.0549 - accuracy20: 0.6550 - val_loss: 2.3489 - val_accuracy20: 0.7111 - 90s/epoch - 70ms/step
Epoch 6/50
1290/1290 - 88s - loss: 2.0374 - accuracy20: 0.6556 - val_loss: 2.3308 - val_accuracy20: 0.7036 - 88s/epoch - 68ms/step
Epoch 7/50
1290/1290 - 92s - loss: 2.0237 - accuracy20: 0.6576 - val_loss: 2.3223 - val_accuracy20: 0.7070 - 92s/epoch - 71ms/step
Epoch 8/50
1290/1290 - 90s - loss: 2.0097 - accuracy20: 0.6607 - val_loss: 2.3173 - val_accuracy20: 0.7041 - 90s/epoch - 70ms/step
Epoch 9/50
1290/1290 - 88s - loss: 1.9966 - accuracy20: 0.6621 - val_loss: 2.3183 - val_accuracy20: 0.7019 - 88s/epoch - 68ms/step
Epoch 10/50
1290/1290 - 89s - loss: 1.9879 - accuracy20: 0.6630 - val_loss: 2.2860 - val_accuracy20: 0.7033 - 89s/epoch - 69ms/step
Epoch 11/50
1290/1290 - 89s - loss: 1.9804 - accuracy20: 0.6639 - val_loss: 2.3083 - val_accuracy20: 0.7029 - 89s/epoch - 69ms/step
Epoch 12/50
1290/1290 - 87s - loss: 1.9716 - accuracy20: 0.6647 - val_loss: 2.3033 - val_accuracy20: 0.7075 - 87s/epoch - 68ms/step
Epoch 13/50
1290/1290 - 91s - loss: 1.9626 - accuracy20: 0.6659 - val_loss: 2.3035 - val_accuracy20: 0.7063 - 91s/epoch - 70ms/step
Epoch 14/50
1290/1290 - 93s - loss: 1.9527 - accuracy20: 0.6670 - val_loss: 2.3003 - val_accuracy20: 0.7106 - 93s/epoch - 72ms/step
Epoch 15/50
1290/1290 - 92s - loss: 1.9488 - accuracy20: 0.6671 - val_loss: 2.2886 - val_accuracy20: 0.7116 - 92s/epoch - 72ms/step
Epoch 16/50
1290/1290 - 91s - loss: 1.9411 - accuracy20: 0.6678 - val_loss: 2.3202 - val_accuracy20: 0.7062 - 91s/epoch - 70ms/step
Epoch 17/50
1290/1290 - 90s - loss: 1.9322 - accuracy20: 0.6690 - val_loss: 2.3232 - val_accuracy20: 0.7089 - 90s/epoch - 70ms/step
Epoch 18/50
1290/1290 - 94s - loss: 1.9253 - accuracy20: 0.6709 - val_loss: 2.3314 - val_accuracy20: 0.7099 - 94s/epoch - 73ms/step
Epoch 19/50
1290/1290 - 92s - loss: 1.9174 - accuracy20: 0.6713 - val_loss: 2.3382 - val_accuracy20: 0.7037 - 92s/epoch - 71ms/step
Epoch 20/50
1290/1290 - 91s - loss: 1.9116 - accuracy20: 0.6716 - val_loss: 2.3187 - val_accuracy20: 0.7072 - 91s/epoch - 71ms/step
testing model: results/EXC/W1/deepOF_L2/h20
Evaluating performance on  test set...
5343/5343 - 166s - 166s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7525738
{'0': {'precision': 0.43796450732667447, 'recall': 0.6253815444279686, 'f1-score': 0.5151566971911581, 'support': 219175}, '1': {'precision': 0.8573302002356682, 'recall': 0.6741562610564104, 'f1-score': 0.7547889411885476, 'support': 927064}, '2': {'precision': 0.4505397035850313, 'recall': 0.6626103049041956, 'f1-score': 0.536373800632842, 'support': 221545}, 'accuracy': 0.6644704134570956, 'macro avg': {'precision': 0.5819448037157914, 'recall': 0.6540493701295248, 'f1-score': 0.6021064796708492, 'support': 1367784}, 'weighted avg': {'precision': 0.7242412941483078, 'recall': 0.6644704134570956, 'f1-score': 0.6810125412653568, 'support': 1367784}}
[[137068  56004  26103]
 [149152 624986 152926]
 [ 26746  48001 146798]]
Evaluating performance on  train set...
1290/1290 - 44s - 44s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65149736
{'0': {'precision': 0.4572289782766864, 'recall': 0.5887706618483571, 'f1-score': 0.5147286821705427, 'support': 44829}, '1': {'precision': 0.8871210242028157, 'recall': 0.7326220646580016, 'f1-score': 0.8025031140093787, 'support': 239197}, '2': {'precision': 0.4278353267834259, 'recall': 0.694459491668653, 'f1-score': 0.5294763883267389, 'support': 46151}, 'accuracy': 0.7077567486529952, 'macro avg': {'precision': 0.5907284430876426, 'recall': 0.6719507393916705, 'f1-score': 0.6155693948355534, 'support': 330177}, 'weighted avg': {'precision': 0.7645560825247923, 'recall': 0.7077567486529952, 'f1-score': 0.7252684900898365, 'support': 330177}}
[[ 26394  13020   5415]
 [ 26509 175241  37447]
 [  4823   9278  32050]]
Evaluating performance on  val set...
363/363 - 13s - 13s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6680797
{'0': {'precision': 0.4529366005445352, 'recall': 0.5510686962694219, 'f1-score': 0.4972069026863547, 'support': 12679}, '1': {'precision': 0.8811694046988164, 'recall': 0.7383838832393387, 'f1-score': 0.8034824067586396, 'support': 67557}, '2': {'precision': 0.40998654363706266, 'recall': 0.676633883248731, 'f1-score': 0.5105937275556619, 'support': 12608}, 'accuracy': 0.7044181638016458, 'macro avg': {'precision': 0.5813641829601381, 'recall': 0.6553621542524972, 'f1-score': 0.6037610123335521, 'support': 92844}, 'weighted avg': {'precision': 0.7587033623467128, 'recall': 0.7044181638016458, 'f1-score': 0.7218830833395319, 'support': 92844}}
[[ 6987  4009  1683]
 [ 7080 49883 10594]
 [ 1359  2718  8531]]
training model: results/EXC/W1/deepOF_L2/h30
Epoch 1/50
1290/1290 - 96s - loss: 2.6938 - accuracy30: 0.5176 - val_loss: 2.6734 - val_accuracy30: 0.6666 - 96s/epoch - 75ms/step
Epoch 2/50
1290/1290 - 90s - loss: 2.3285 - accuracy30: 0.6041 - val_loss: 2.5607 - val_accuracy30: 0.6623 - 90s/epoch - 70ms/step
Epoch 3/50
1290/1290 - 90s - loss: 2.2240 - accuracy30: 0.6258 - val_loss: 2.5107 - val_accuracy30: 0.6599 - 90s/epoch - 70ms/step
Epoch 4/50
1290/1290 - 93s - loss: 2.1874 - accuracy30: 0.6329 - val_loss: 2.4895 - val_accuracy30: 0.6639 - 93s/epoch - 72ms/step
Epoch 5/50
1290/1290 - 91s - loss: 2.1647 - accuracy30: 0.6386 - val_loss: 2.4959 - val_accuracy30: 0.6608 - 91s/epoch - 71ms/step
Epoch 6/50
1290/1290 - 90s - loss: 2.1471 - accuracy30: 0.6408 - val_loss: 2.4709 - val_accuracy30: 0.6593 - 90s/epoch - 70ms/step
Epoch 7/50
1290/1290 - 91s - loss: 2.1336 - accuracy30: 0.6423 - val_loss: 2.4377 - val_accuracy30: 0.6628 - 91s/epoch - 71ms/step
Epoch 8/50
1290/1290 - 96s - loss: 2.1222 - accuracy30: 0.6444 - val_loss: 2.4441 - val_accuracy30: 0.6575 - 96s/epoch - 74ms/step
Epoch 9/50
1290/1290 - 95s - loss: 2.1119 - accuracy30: 0.6462 - val_loss: 2.4366 - val_accuracy30: 0.6616 - 95s/epoch - 73ms/step
Epoch 10/50
1290/1290 - 90s - loss: 2.1022 - accuracy30: 0.6468 - val_loss: 2.4146 - val_accuracy30: 0.6619 - 90s/epoch - 70ms/step
Epoch 11/50
1290/1290 - 90s - loss: 2.0910 - accuracy30: 0.6483 - val_loss: 2.4352 - val_accuracy30: 0.6578 - 90s/epoch - 69ms/step
Epoch 12/50
1290/1290 - 91s - loss: 2.0840 - accuracy30: 0.6491 - val_loss: 2.4357 - val_accuracy30: 0.6643 - 91s/epoch - 70ms/step
Epoch 13/50
1290/1290 - 90s - loss: 2.0750 - accuracy30: 0.6500 - val_loss: 2.4443 - val_accuracy30: 0.6640 - 90s/epoch - 70ms/step
Epoch 14/50
1290/1290 - 92s - loss: 2.0684 - accuracy30: 0.6514 - val_loss: 2.4031 - val_accuracy30: 0.6641 - 92s/epoch - 71ms/step
Epoch 15/50
1290/1290 - 88s - loss: 2.0586 - accuracy30: 0.6530 - val_loss: 2.4268 - val_accuracy30: 0.6707 - 88s/epoch - 69ms/step
Epoch 16/50
1290/1290 - 93s - loss: 2.0520 - accuracy30: 0.6532 - val_loss: 2.4415 - val_accuracy30: 0.6662 - 93s/epoch - 72ms/step
Epoch 17/50
1290/1290 - 91s - loss: 2.0435 - accuracy30: 0.6546 - val_loss: 2.4558 - val_accuracy30: 0.6655 - 91s/epoch - 70ms/step
Epoch 18/50
1290/1290 - 90s - loss: 2.0331 - accuracy30: 0.6560 - val_loss: 2.4942 - val_accuracy30: 0.6572 - 90s/epoch - 70ms/step
Epoch 19/50
1290/1290 - 86s - loss: 2.0256 - accuracy30: 0.6568 - val_loss: 2.4629 - val_accuracy30: 0.6519 - 86s/epoch - 66ms/step
Epoch 20/50
1290/1290 - 94s - loss: 2.0166 - accuracy30: 0.6571 - val_loss: 2.5025 - val_accuracy30: 0.6543 - 94s/epoch - 73ms/step
Epoch 21/50
1290/1290 - 93s - loss: 2.0088 - accuracy30: 0.6580 - val_loss: 2.5019 - val_accuracy30: 0.6592 - 93s/epoch - 72ms/step
Epoch 22/50
1290/1290 - 87s - loss: 2.0002 - accuracy30: 0.6593 - val_loss: 2.5166 - val_accuracy30: 0.6587 - 87s/epoch - 67ms/step
Epoch 23/50
1290/1290 - 91s - loss: 1.9933 - accuracy30: 0.6591 - val_loss: 2.5589 - val_accuracy30: 0.6471 - 91s/epoch - 70ms/step
Epoch 24/50
1290/1290 - 91s - loss: 1.9842 - accuracy30: 0.6604 - val_loss: 2.5501 - val_accuracy30: 0.6483 - 91s/epoch - 70ms/step
testing model: results/EXC/W1/deepOF_L2/h30
Evaluating performance on  test set...
5343/5343 - 170s - 170s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81624043
{'0': {'precision': 0.4776985762057013, 'recall': 0.5824729972494093, 'f1-score': 0.5249084741208477, 'support': 268306}, '1': {'precision': 0.7953397640325456, 'recall': 0.6330256635449302, 'f1-score': 0.7049603303886487, 'support': 828919}, '2': {'precision': 0.4710300936257804, 'recall': 0.6630901208239238, 'f1-score': 0.5507976980122407, 'support': 270559}, 'accuracy': 0.6290561960075568, 'macro avg': {'precision': 0.5813561446213424, 'recall': 0.626196260539421, 'f1-score': 0.5935555008405791, 'support': 1367784}, 'weighted avg': {'precision': 0.6688797844914388, 'recall': 0.6290561960075568, 'f1-score': 0.639146516949599, 'support': 1367784}}
[[156281  75279  36746]
 [139465 524727 164727]
 [ 31408  59746 179405]]
Evaluating performance on  train set...
1290/1290 - 39s - 39s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6965285
{'0': {'precision': 0.5118895640776864, 'recall': 0.5504044803982576, 'f1-score': 0.5304488168837698, 'support': 54638}, '1': {'precision': 0.8416150432757787, 'recall': 0.698665110511343, 'f1-score': 0.7635066462065805, 'support': 219344}, '2': {'precision': 0.4473136333109469, 'recall': 0.7111486787080701, 'f1-score': 0.5491874806747518, 'support': 56195}, 'accuracy': 0.6762554629789477, 'macro avg': {'precision': 0.6002727468881374, 'recall': 0.6534060898725569, 'f1-score': 0.6143809812550339, 'support': 330177}, 'weighted avg': {'precision': 0.7199430053524858, 'recall': 0.6762554629789477, 'f1-score': 0.6884636262942279, 'support': 330177}}
[[ 30073  17402   7163]
 [ 23882 153248  42214]
 [  4794  11438  39963]]
Evaluating performance on  val set...
363/363 - 13s - 13s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72590196
{'0': {'precision': 0.49837260773336806, 'recall': 0.49527752620002585, 'f1-score': 0.49682024659312135, 'support': 15458}, '1': {'precision': 0.8340310600945308, 'recall': 0.6967284448025786, 'f1-score': 0.7592220222153928, 'support': 62050}, '2': {'precision': 0.41638398253207004, 'recall': 0.6963354199269692, 'f1-score': 0.5211429129151112, 'support': 15336}, 'accuracy': 0.6631230881909439, 'macro avg': {'precision': 0.5829292167866563, 'recall': 0.6294471303098579, 'f1-score': 0.5923950605745417, 'support': 92844}, 'weighted avg': {'precision': 0.7091587588354644, 'recall': 0.6631230881909439, 'f1-score': 0.6762076339102984, 'support': 92844}}
[[ 7656  5316  2486]
 [ 6336 43232 12482]
 [ 1370  3287 10679]]
training model: results/EXC/W1/deepOF_L2/h50
Epoch 1/50
1290/1290 - 101s - loss: 2.8415 - accuracy50: 0.4998 - val_loss: 2.7925 - val_accuracy50: 0.6186 - 101s/epoch - 78ms/step
Epoch 2/50
1290/1290 - 91s - loss: 2.5570 - accuracy50: 0.5675 - val_loss: 2.7188 - val_accuracy50: 0.6198 - 91s/epoch - 70ms/step
Epoch 3/50
1290/1290 - 94s - loss: 2.4577 - accuracy50: 0.5907 - val_loss: 2.6883 - val_accuracy50: 0.6152 - 94s/epoch - 73ms/step
Epoch 4/50
1290/1290 - 91s - loss: 2.4203 - accuracy50: 0.6000 - val_loss: 2.6327 - val_accuracy50: 0.6214 - 91s/epoch - 71ms/step
Epoch 5/50
1290/1290 - 91s - loss: 2.3985 - accuracy50: 0.6049 - val_loss: 2.6095 - val_accuracy50: 0.6177 - 91s/epoch - 70ms/step
Epoch 6/50
1290/1290 - 91s - loss: 2.3815 - accuracy50: 0.6083 - val_loss: 2.6247 - val_accuracy50: 0.6157 - 91s/epoch - 70ms/step
Epoch 7/50
1290/1290 - 88s - loss: 2.3668 - accuracy50: 0.6109 - val_loss: 2.6284 - val_accuracy50: 0.6170 - 88s/epoch - 69ms/step
Epoch 8/50
1290/1290 - 88s - loss: 2.3550 - accuracy50: 0.6131 - val_loss: 2.6262 - val_accuracy50: 0.6128 - 88s/epoch - 69ms/step
Epoch 9/50
1290/1290 - 92s - loss: 2.3456 - accuracy50: 0.6147 - val_loss: 2.6147 - val_accuracy50: 0.6172 - 92s/epoch - 72ms/step
Epoch 10/50
1290/1290 - 93s - loss: 2.3353 - accuracy50: 0.6169 - val_loss: 2.6173 - val_accuracy50: 0.6130 - 93s/epoch - 72ms/step
Epoch 11/50
1290/1290 - 88s - loss: 2.3259 - accuracy50: 0.6182 - val_loss: 2.6058 - val_accuracy50: 0.6193 - 88s/epoch - 68ms/step
Epoch 12/50
1290/1290 - 92s - loss: 2.3167 - accuracy50: 0.6198 - val_loss: 2.5899 - val_accuracy50: 0.6198 - 92s/epoch - 71ms/step
Epoch 13/50
1290/1290 - 87s - loss: 2.3069 - accuracy50: 0.6203 - val_loss: 2.6263 - val_accuracy50: 0.6123 - 87s/epoch - 67ms/step
Epoch 14/50
1290/1290 - 89s - loss: 2.2999 - accuracy50: 0.6215 - val_loss: 2.6020 - val_accuracy50: 0.6148 - 89s/epoch - 69ms/step
Epoch 15/50
1290/1290 - 88s - loss: 2.2894 - accuracy50: 0.6234 - val_loss: 2.6045 - val_accuracy50: 0.6097 - 88s/epoch - 69ms/step
Epoch 16/50
1290/1290 - 83s - loss: 2.2815 - accuracy50: 0.6241 - val_loss: 2.6358 - val_accuracy50: 0.6076 - 83s/epoch - 65ms/step
Epoch 17/50
1290/1290 - 89s - loss: 2.2727 - accuracy50: 0.6243 - val_loss: 2.6390 - val_accuracy50: 0.6072 - 89s/epoch - 69ms/step
Epoch 18/50
1290/1290 - 88s - loss: 2.2641 - accuracy50: 0.6259 - val_loss: 2.6644 - val_accuracy50: 0.6077 - 88s/epoch - 68ms/step
Epoch 19/50
1290/1290 - 88s - loss: 2.2541 - accuracy50: 0.6278 - val_loss: 2.7271 - val_accuracy50: 0.6025 - 88s/epoch - 68ms/step
Epoch 20/50
1290/1290 - 93s - loss: 2.2439 - accuracy50: 0.6284 - val_loss: 2.7381 - val_accuracy50: 0.5961 - 93s/epoch - 72ms/step
Epoch 21/50
1290/1290 - 89s - loss: 2.2355 - accuracy50: 0.6297 - val_loss: 2.7413 - val_accuracy50: 0.5938 - 89s/epoch - 69ms/step
Epoch 22/50
1290/1290 - 90s - loss: 2.2231 - accuracy50: 0.6314 - val_loss: 2.7417 - val_accuracy50: 0.6041 - 90s/epoch - 69ms/step
testing model: results/EXC/W1/deepOF_L2/h50
Evaluating performance on  test set...
5343/5343 - 150s - 150s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8730637
{'0': {'precision': 0.5088647561332705, 'recall': 0.5770662308449724, 'f1-score': 0.5408238098975177, 'support': 346319}, '1': {'precision': 0.6559084950504753, 'recall': 0.6362743670726236, 'f1-score': 0.6459422652612783, 'support': 673142}, '2': {'precision': 0.5571311910624517, 'recall': 0.5151195872796227, 'f1-score': 0.5353023658223695, 'support': 348323}, 'accuracy': 0.5904294830177864, 'macro avg': {'precision': 0.5739681474153991, 'recall': 0.5761533950657395, 'f1-score': 0.5740228136603885, 'support': 1367784}, 'weighted avg': {'precision': 0.5935225865480453, 'recall': 0.5904294830177864, 'f1-score': 0.591150763068402, 'support': 1367784}}
[[199849 115805  30665]
 [132875 428303 111964]
 [ 60011 108884 179428]]
Evaluating performance on  train set...
1290/1290 - 44s - 44s/epoch - 34ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77450246
{'0': {'precision': 0.5372778291024917, 'recall': 0.5531972286898745, 'f1-score': 0.5451213284927847, 'support': 70436}, '1': {'precision': 0.7332715603735938, 'recall': 0.6879206442323076, 'f1-score': 0.7098725176997602, 'support': 187510}, '2': {'precision': 0.5213173315716715, 'recall': 0.5899544516897177, 'f1-score': 0.5535162237289897, 'support': 72231}, 'accuracy': 0.6377488438019607, 'macro avg': {'precision': 0.597288907015919, 'recall': 0.6103574415373, 'f1-score': 0.6028366899738449, 'support': 330177}, 'weighted avg': {'precision': 0.6450925522767154, 'recall': 0.6377488438019607, 'f1-score': 0.6405212720564076, 'support': 330177}}
[[ 38965  24882   6589]
 [ 25979 128992  32539]
 [  7579  22039  42613]]
Evaluating performance on  val set...
363/363 - 14s - 14s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80550796
{'0': {'precision': 0.5256220222339862, 'recall': 0.5011609125782354, 'f1-score': 0.5131000981861402, 'support': 19812}, '1': {'precision': 0.7281322459422723, 'recall': 0.682051378070701, 'f1-score': 0.7043389148845663, 'support': 53408}, '2': {'precision': 0.47425394967817436, 'recall': 0.5782205462698736, 'f1-score': 0.5211021814006889, 'support': 19624}, 'accuracy': 0.6215048899228814, 'macro avg': {'precision': 0.5760027392848109, 'recall': 0.5871442789729366, 'f1-score': 0.5795137314904651, 'support': 92844}, 'weighted avg': {'precision': 0.631257485720877, 'recall': 0.6215048899228814, 'f1-score': 0.6248005376677636, 'support': 92844}}
[[ 9929  7514  2369]
 [ 6771 36427 10210]
 [ 2190  6087 11347]]
training model: results/EXC/W1/deepOF_L2/h100
Epoch 1/50
1290/1290 - 97s - loss: 3.0873 - accuracy100: 0.4567 - val_loss: 3.0293 - val_accuracy100: 0.5007 - 97s/epoch - 75ms/step
Epoch 2/50
1290/1290 - 95s - loss: 2.9252 - accuracy100: 0.5040 - val_loss: 2.9631 - val_accuracy100: 0.5062 - 95s/epoch - 74ms/step
Epoch 3/50
1290/1290 - 88s - loss: 2.8558 - accuracy100: 0.5215 - val_loss: 2.9352 - val_accuracy100: 0.5172 - 88s/epoch - 68ms/step
Epoch 4/50
1290/1290 - 90s - loss: 2.8239 - accuracy100: 0.5281 - val_loss: 2.9209 - val_accuracy100: 0.5179 - 90s/epoch - 70ms/step
Epoch 5/50
1290/1290 - 90s - loss: 2.8049 - accuracy100: 0.5324 - val_loss: 2.9082 - val_accuracy100: 0.5181 - 90s/epoch - 70ms/step
Epoch 6/50
1290/1290 - 94s - loss: 2.7924 - accuracy100: 0.5359 - val_loss: 2.8964 - val_accuracy100: 0.5197 - 94s/epoch - 73ms/step
Epoch 7/50
1290/1290 - 87s - loss: 2.7814 - accuracy100: 0.5382 - val_loss: 2.8844 - val_accuracy100: 0.5244 - 87s/epoch - 67ms/step
Epoch 8/50
1290/1290 - 90s - loss: 2.7716 - accuracy100: 0.5404 - val_loss: 2.8910 - val_accuracy100: 0.5215 - 90s/epoch - 70ms/step
Epoch 9/50
1290/1290 - 87s - loss: 2.7641 - accuracy100: 0.5425 - val_loss: 2.8896 - val_accuracy100: 0.5209 - 87s/epoch - 68ms/step
Epoch 10/50
1290/1290 - 91s - loss: 2.7564 - accuracy100: 0.5433 - val_loss: 2.8825 - val_accuracy100: 0.5231 - 91s/epoch - 70ms/step
Epoch 11/50
1290/1290 - 93s - loss: 2.7480 - accuracy100: 0.5450 - val_loss: 2.8869 - val_accuracy100: 0.5221 - 93s/epoch - 72ms/step
Epoch 12/50
1290/1290 - 88s - loss: 2.7382 - accuracy100: 0.5489 - val_loss: 2.8893 - val_accuracy100: 0.5222 - 88s/epoch - 68ms/step
Epoch 13/50
1290/1290 - 89s - loss: 2.7297 - accuracy100: 0.5494 - val_loss: 2.9049 - val_accuracy100: 0.5193 - 89s/epoch - 69ms/step
Epoch 14/50
1290/1290 - 90s - loss: 2.7205 - accuracy100: 0.5528 - val_loss: 2.9013 - val_accuracy100: 0.5204 - 90s/epoch - 70ms/step
Epoch 15/50
1290/1290 - 91s - loss: 2.7113 - accuracy100: 0.5546 - val_loss: 2.9327 - val_accuracy100: 0.5148 - 91s/epoch - 70ms/step
Epoch 16/50
1290/1290 - 93s - loss: 2.7032 - accuracy100: 0.5576 - val_loss: 2.9442 - val_accuracy100: 0.5118 - 93s/epoch - 72ms/step
Epoch 17/50
1290/1290 - 90s - loss: 2.6918 - accuracy100: 0.5590 - val_loss: 2.9809 - val_accuracy100: 0.5063 - 90s/epoch - 70ms/step
Epoch 18/50
1290/1290 - 90s - loss: 2.6821 - accuracy100: 0.5601 - val_loss: 2.9742 - val_accuracy100: 0.5120 - 90s/epoch - 70ms/step
Epoch 19/50
1290/1290 - 91s - loss: 2.6757 - accuracy100: 0.5621 - val_loss: 2.9966 - val_accuracy100: 0.5075 - 91s/epoch - 70ms/step
Epoch 20/50
1290/1290 - 91s - loss: 2.6644 - accuracy100: 0.5640 - val_loss: 3.0099 - val_accuracy100: 0.5089 - 91s/epoch - 70ms/step
testing model: results/EXC/W1/deepOF_L2/h100
Evaluating performance on  test set...
5343/5343 - 156s - 156s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0165632
{'0': {'precision': 0.5104245640636846, 'recall': 0.5021976759062297, 'f1-score': 0.506277700963488, 'support': 461169}, '1': {'precision': 0.41157740173892005, 'recall': 0.5077168345714189, 'f1-score': 0.45462000595306806, 'support': 442215}, '2': {'precision': 0.5511631125233016, 'recall': 0.43739018087855297, 'f1-score': 0.48772956418072433, 'support': 464400}, 'accuracy': 0.481978148596562, 'macro avg': {'precision': 0.49105502610863544, 'recall': 0.48243489711873383, 'f1-score': 0.48287575703242674, 'support': 1367784}, 'weighted avg': {'precision': 0.4922983716365181, 'recall': 0.481978148596562, 'f1-score': 0.48327877545993747, 'support': 1367784}}
[[231598 164454  65117]
 [117399 224520 100296]
 [104739 156537 203124]]
Evaluating performance on  train set...
1290/1290 - 48s - 48s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9354545
{'0': {'precision': 0.5553773880363295, 'recall': 0.45475340554734944, 'f1-score': 0.5000535775718644, 'support': 97488}, '1': {'precision': 0.5180507439623159, 'recall': 0.6237892667702026, 'f1-score': 0.566024120171966, 'support': 133287}, '2': {'precision': 0.5533273981749388, 'recall': 0.5002112633548621, 'f1-score': 0.5254303558030667, 'support': 99402}, 'accuracy': 0.536675782989124, 'macro avg': {'precision': 0.5422518433911948, 'recall': 0.5262513118908047, 'f1-score': 0.5305026845156324, 'support': 330177}, 'weighted avg': {'precision': 0.5396920753074145, 'recall': 0.536675782989124, 'f1-score': 0.5343246449729181, 'support': 330177}}
[[44333 39961 13194]
 [23200 83143 26944]
 [12292 37388 49722]]
Evaluating performance on  val set...
363/363 - 14s - 14s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95300376
{'0': {'precision': 0.5319914752545584, 'recall': 0.4160216288285619, 'f1-score': 0.4669132928755507, 'support': 27001}, '1': {'precision': 0.5255588689380961, 'recall': 0.6310790563019021, 'f1-score': 0.5735056542810985, 'support': 39377}, '2': {'precision': 0.505154217458889, 'recall': 0.4665986548779566, 'f1-score': 0.4851115650534255, 'support': 26466}, 'accuracy': 0.5216492180431692, 'macro avg': {'precision': 0.5209015205505144, 'recall': 0.5045664466694736, 'f1-score': 0.5085101707366916, 'support': 92844}, 'weighted avg': {'precision': 0.5216130813492601, 'recall': 0.5216492180431692, 'f1-score': 0.5173088260982242, 'support': 92844}}
[[11233 11806  3962]
 [ 6392 24850  8135]
 [ 3490 10627 12349]]
training model: results/EXC/W1/deepOF_L2/h200
Epoch 1/50
1290/1290 - 99s - loss: 3.2309 - accuracy200: 0.4032 - val_loss: 3.1904 - val_accuracy200: 0.4137 - 99s/epoch - 77ms/step
Epoch 2/50
1290/1290 - 90s - loss: 3.1691 - accuracy200: 0.4265 - val_loss: 3.1615 - val_accuracy200: 0.4261 - 90s/epoch - 70ms/step
Epoch 3/50
1290/1290 - 86s - loss: 3.1437 - accuracy200: 0.4344 - val_loss: 3.1429 - val_accuracy200: 0.4313 - 86s/epoch - 67ms/step
Epoch 4/50
1290/1290 - 92s - loss: 3.1257 - accuracy200: 0.4403 - val_loss: 3.1367 - val_accuracy200: 0.4339 - 92s/epoch - 72ms/step
Epoch 5/50
1290/1290 - 91s - loss: 3.1154 - accuracy200: 0.4424 - val_loss: 3.1325 - val_accuracy200: 0.4363 - 91s/epoch - 71ms/step
Epoch 6/50
1290/1290 - 90s - loss: 3.1072 - accuracy200: 0.4453 - val_loss: 3.1300 - val_accuracy200: 0.4378 - 90s/epoch - 70ms/step
Epoch 7/50
1290/1290 - 88s - loss: 3.1005 - accuracy200: 0.4478 - val_loss: 3.1355 - val_accuracy200: 0.4356 - 88s/epoch - 68ms/step
Epoch 8/50
1290/1290 - 86s - loss: 3.0945 - accuracy200: 0.4498 - val_loss: 3.1507 - val_accuracy200: 0.4297 - 86s/epoch - 67ms/step
Epoch 9/50
1290/1290 - 91s - loss: 3.0897 - accuracy200: 0.4512 - val_loss: 3.1387 - val_accuracy200: 0.4361 - 91s/epoch - 71ms/step
Epoch 10/50
1290/1290 - 92s - loss: 3.0852 - accuracy200: 0.4524 - val_loss: 3.1390 - val_accuracy200: 0.4357 - 92s/epoch - 72ms/step
Epoch 11/50
1290/1290 - 88s - loss: 3.0799 - accuracy200: 0.4546 - val_loss: 3.1476 - val_accuracy200: 0.4323 - 88s/epoch - 68ms/step
Epoch 12/50
1290/1290 - 92s - loss: 3.0731 - accuracy200: 0.4580 - val_loss: 3.1585 - val_accuracy200: 0.4313 - 92s/epoch - 72ms/step
Epoch 13/50
1290/1290 - 97s - loss: 3.0693 - accuracy200: 0.4581 - val_loss: 3.1608 - val_accuracy200: 0.4309 - 97s/epoch - 75ms/step
Epoch 14/50
1290/1290 - 91s - loss: 3.0621 - accuracy200: 0.4599 - val_loss: 3.1718 - val_accuracy200: 0.4294 - 91s/epoch - 71ms/step
Epoch 15/50
1290/1290 - 91s - loss: 3.0516 - accuracy200: 0.4635 - val_loss: 3.1657 - val_accuracy200: 0.4326 - 91s/epoch - 71ms/step
Epoch 16/50
1290/1290 - 96s - loss: 3.0466 - accuracy200: 0.4656 - val_loss: 3.2001 - val_accuracy200: 0.4231 - 96s/epoch - 74ms/step
testing model: results/EXC/W1/deepOF_L2/h200
Evaluating performance on  test set...
5343/5343 - 158s - 158s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0659729
{'0': {'precision': 0.4574961182620839, 'recall': 0.4147288597199897, 'f1-score': 0.435063998951553, 'support': 480268}, '1': {'precision': 0.3224490884837706, 'recall': 0.45092923303453286, 'f1-score': 0.3760170568971132, 'support': 402052}, '2': {'precision': 0.4908553552228484, 'recall': 0.3742728606034639, 'f1-score': 0.4247089265637089, 'support': 485464}, 'accuracy': 0.4110108028753078, 'macro avg': {'precision': 0.423600187322901, 'recall': 0.41331031778599553, 'f1-score': 0.41192999413745834, 'support': 1367784}, 'weighted avg': {'precision': 0.4296399510569478, 'recall': 0.4110108028753078, 'f1-score': 0.41403220152698594, 'support': 1367784}}
[[199181 193493  87594]
 [119883 181297 100872]
 [116308 187460 181696]]
Evaluating performance on  train set...
1290/1290 - 40s - 40s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0401062
{'0': {'precision': 0.4871526084836665, 'recall': 0.36667737052158356, 'f1-score': 0.41841547360431336, 'support': 108995}, '1': {'precision': 0.3723338485316847, 'recall': 0.46290890790135886, 'f1-score': 0.4127103261202097, 'support': 109285}, '2': {'precision': 0.47898313841110923, 'recall': 0.4805669499629123, 'f1-score': 0.47977373708534826, 'support': 111897}, 'accuracy': 0.43712614749058837, 'macro avg': {'precision': 0.44615653180882014, 'recall': 0.4367177427952849, 'f1-score': 0.4369665122699571, 'support': 330177}, 'weighted avg': {'precision': 0.4463802125443332, 'recall': 0.43712614749058837, 'f1-score': 0.43732144999254474, 'support': 330177}}
[[39966 44817 24212]
 [24415 50589 34281]
 [17659 40464 53774]]
Evaluating performance on  val set...
363/363 - 11s - 11s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0427859
{'0': {'precision': 0.486652977412731, 'recall': 0.34473866904691064, 'f1-score': 0.40358379936915845, 'support': 30249}, '1': {'precision': 0.4021670814792468, 'recall': 0.4867932566490171, 'f1-score': 0.4404520987348394, 'support': 32862}, '2': {'precision': 0.44587376339328044, 'recall': 0.4744559916590993, 'f1-score': 0.45972104542788245, 'support': 29733}, 'accuracy': 0.4365602516048425, 'macro avg': {'precision': 0.44489794076175276, 'recall': 0.435329305785009, 'f1-score': 0.4345856478439601, 'support': 92844}, 'weighted avg': {'precision': 0.44368990082612897, 'recall': 0.4365602516048425, 'f1-score': 0.43461105789764765, 'support': 92844}}
[[10428 12800  7021]
 [ 6354 15997 10511]
 [ 4646 10980 14107]]
training model: results/EXC/W1/deepOF_L2/h300
Epoch 1/50
1290/1290 - 101s - loss: 3.2765 - accuracy300: 0.3793 - val_loss: 3.2578 - val_accuracy300: 0.3746 - 101s/epoch - 78ms/step
Epoch 2/50
1290/1290 - 91s - loss: 3.2387 - accuracy300: 0.3997 - val_loss: 3.2388 - val_accuracy300: 0.3844 - 91s/epoch - 71ms/step
Epoch 3/50
1290/1290 - 87s - loss: 3.2248 - accuracy300: 0.4070 - val_loss: 3.2292 - val_accuracy300: 0.3909 - 87s/epoch - 68ms/step
Epoch 4/50
1290/1290 - 87s - loss: 3.2154 - accuracy300: 0.4115 - val_loss: 3.2250 - val_accuracy300: 0.3949 - 87s/epoch - 68ms/step
Epoch 5/50
1290/1290 - 92s - loss: 3.2083 - accuracy300: 0.4163 - val_loss: 3.2216 - val_accuracy300: 0.3943 - 92s/epoch - 71ms/step
Epoch 6/50
1290/1290 - 92s - loss: 3.2032 - accuracy300: 0.4179 - val_loss: 3.2209 - val_accuracy300: 0.3951 - 92s/epoch - 71ms/step
Epoch 7/50
1290/1290 - 89s - loss: 3.1977 - accuracy300: 0.4202 - val_loss: 3.2212 - val_accuracy300: 0.3949 - 89s/epoch - 69ms/step
Epoch 8/50
1290/1290 - 90s - loss: 3.1925 - accuracy300: 0.4228 - val_loss: 3.2248 - val_accuracy300: 0.3954 - 90s/epoch - 70ms/step
Epoch 9/50
1290/1290 - 94s - loss: 3.1878 - accuracy300: 0.4251 - val_loss: 3.2314 - val_accuracy300: 0.3931 - 94s/epoch - 73ms/step
Epoch 10/50
1290/1290 - 91s - loss: 3.1837 - accuracy300: 0.4268 - val_loss: 3.2438 - val_accuracy300: 0.3891 - 91s/epoch - 71ms/step
Epoch 11/50
1290/1290 - 90s - loss: 3.1795 - accuracy300: 0.4283 - val_loss: 3.2426 - val_accuracy300: 0.3911 - 90s/epoch - 69ms/step
Epoch 12/50
1290/1290 - 92s - loss: 3.1737 - accuracy300: 0.4305 - val_loss: 3.2476 - val_accuracy300: 0.3894 - 92s/epoch - 71ms/step
Epoch 13/50
1290/1290 - 94s - loss: 3.1659 - accuracy300: 0.4333 - val_loss: 3.2696 - val_accuracy300: 0.3839 - 94s/epoch - 73ms/step
Epoch 14/50
1290/1290 - 94s - loss: 3.1593 - accuracy300: 0.4370 - val_loss: 3.2934 - val_accuracy300: 0.3802 - 94s/epoch - 73ms/step
Epoch 15/50
1290/1290 - 94s - loss: 3.1523 - accuracy300: 0.4402 - val_loss: 3.3280 - val_accuracy300: 0.3739 - 94s/epoch - 73ms/step
Epoch 16/50
1290/1290 - 91s - loss: 3.1449 - accuracy300: 0.4434 - val_loss: 3.4287 - val_accuracy300: 0.3655 - 91s/epoch - 70ms/step
testing model: results/EXC/W1/deepOF_L2/h300
Evaluating performance on  test set...
5343/5343 - 169s - 169s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0802836
{'0': {'precision': 0.39299697703213715, 'recall': 0.5534666708559066, 'f1-score': 0.4596282784230954, 'support': 445586}, '1': {'precision': 0.3301271489211755, 'recall': 0.2148257610018026, 'f1-score': 0.2602786945549865, 'support': 470991}, '2': {'precision': 0.41172388672181187, 'recall': 0.3958072458982241, 'f1-score': 0.40360870582199865, 'support': 451207}, 'accuracy': 0.3848480461827306, 'macro avg': {'precision': 0.3782826708917082, 'recall': 0.3880332259186445, 'f1-score': 0.37450522626669347, 'support': 1367784}, 'weighted avg': {'precision': 0.37752566688999417, 'recall': 0.3848480461827306, 'f1-score': 0.37250320374006973, 'support': 1367784}}
[[246617  98847 100122]
 [214759 101181 155051]
 [166153 106463 178591]]
Evaluating performance on  train set...
1290/1290 - 42s - 42s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0734825
{'0': {'precision': 0.414922883941044, 'recall': 0.5350138768908412, 'f1-score': 0.4673774295325182, 'support': 108814}, '1': {'precision': 0.33692125811063456, 'recall': 0.22493575624082232, 'f1-score': 0.2697684145643464, 'support': 108960}, '2': {'precision': 0.43872785485592314, 'recall': 0.45715861676289776, 'f1-score': 0.4477536509706877, 'support': 112403}, 'accuracy': 0.40618213867107644, 'macro avg': {'precision': 0.3968573323025339, 'recall': 0.4057027499648538, 'f1-score': 0.39496649835585074, 'support': 330177}, 'weighted avg': {'precision': 0.3972859588834651, 'recall': 0.40618213867107644, 'f1-score': 0.39548492989560396, 'support': 330177}}
[[58217 23387 27210]
 [45922 24509 38529]
 [36169 24848 51386]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0733703
{'0': {'precision': 0.4037510830232914, 'recall': 0.5245489157424268, 'f1-score': 0.4562904085129668, 'support': 30205}, '1': {'precision': 0.3621059659497353, 'recall': 0.22839524740562492, 'f1-score': 0.28011214815361346, 'support': 33245}, '2': {'precision': 0.40590812980725033, 'recall': 0.4506361842552902, 'f1-score': 0.4271043255356538, 'support': 29394}, 'accuracy': 0.39510361466546035, 'macro avg': {'precision': 0.390588392926759, 'recall': 0.40119344913444727, 'f1-score': 0.3878356274007447, 'support': 92844}, 'weighted avg': {'precision': 0.38952197092188817, 'recall': 0.39510361466546035, 'f1-score': 0.38396541186609845, 'support': 92844}}
[[15844  6613  7748]
 [14013  7593 11639]
 [ 9385  6763 13246]]
training model: results/EXC/W1/deepOF_L2/h500
Epoch 1/50
1290/1290 - 95s - loss: 3.2906 - accuracy500: 0.3696 - val_loss: 3.2772 - val_accuracy500: 0.3632 - 95s/epoch - 74ms/step
Epoch 2/50
1290/1290 - 95s - loss: 3.2605 - accuracy500: 0.3881 - val_loss: 3.2620 - val_accuracy500: 0.3774 - 95s/epoch - 74ms/step
Epoch 3/50
1290/1290 - 92s - loss: 3.2488 - accuracy500: 0.3965 - val_loss: 3.2538 - val_accuracy500: 0.3854 - 92s/epoch - 71ms/step
Epoch 4/50
1290/1290 - 95s - loss: 3.2403 - accuracy500: 0.4024 - val_loss: 3.2504 - val_accuracy500: 0.3913 - 95s/epoch - 74ms/step
Epoch 5/50
1290/1290 - 96s - loss: 3.2344 - accuracy500: 0.4056 - val_loss: 3.2472 - val_accuracy500: 0.3938 - 96s/epoch - 74ms/step
Epoch 6/50
1290/1290 - 86s - loss: 3.2287 - accuracy500: 0.4093 - val_loss: 3.2451 - val_accuracy500: 0.3943 - 86s/epoch - 66ms/step
Epoch 7/50
1290/1290 - 91s - loss: 3.2251 - accuracy500: 0.4116 - val_loss: 3.2427 - val_accuracy500: 0.3984 - 91s/epoch - 71ms/step
Epoch 8/50
1290/1290 - 91s - loss: 3.2206 - accuracy500: 0.4143 - val_loss: 3.2432 - val_accuracy500: 0.3976 - 91s/epoch - 70ms/step
Epoch 9/50
1290/1290 - 93s - loss: 3.2167 - accuracy500: 0.4163 - val_loss: 3.2433 - val_accuracy500: 0.3975 - 93s/epoch - 72ms/step
Epoch 10/50
1290/1290 - 91s - loss: 3.2130 - accuracy500: 0.4187 - val_loss: 3.2413 - val_accuracy500: 0.3987 - 91s/epoch - 70ms/step
Epoch 11/50
1290/1290 - 94s - loss: 3.2089 - accuracy500: 0.4213 - val_loss: 3.2456 - val_accuracy500: 0.3972 - 94s/epoch - 73ms/step
Epoch 12/50
1290/1290 - 95s - loss: 3.2044 - accuracy500: 0.4240 - val_loss: 3.2516 - val_accuracy500: 0.3959 - 95s/epoch - 73ms/step
Epoch 13/50
1290/1290 - 94s - loss: 3.2012 - accuracy500: 0.4248 - val_loss: 3.2491 - val_accuracy500: 0.3973 - 94s/epoch - 73ms/step
Epoch 14/50
1290/1290 - 96s - loss: 3.1962 - accuracy500: 0.4287 - val_loss: 3.2655 - val_accuracy500: 0.3941 - 96s/epoch - 75ms/step
Epoch 15/50
1290/1290 - 91s - loss: 3.1897 - accuracy500: 0.4319 - val_loss: 3.2908 - val_accuracy500: 0.3881 - 91s/epoch - 70ms/step
Epoch 16/50
1290/1290 - 94s - loss: 3.1844 - accuracy500: 0.4346 - val_loss: 3.2942 - val_accuracy500: 0.3895 - 94s/epoch - 73ms/step
Epoch 17/50
1290/1290 - 88s - loss: 3.1769 - accuracy500: 0.4380 - val_loss: 3.3208 - val_accuracy500: 0.3877 - 88s/epoch - 68ms/step
Epoch 18/50
1290/1290 - 95s - loss: 3.1698 - accuracy500: 0.4416 - val_loss: 3.3257 - val_accuracy500: 0.3879 - 95s/epoch - 74ms/step
Epoch 19/50
1290/1290 - 94s - loss: 3.1602 - accuracy500: 0.4448 - val_loss: 3.3632 - val_accuracy500: 0.3797 - 94s/epoch - 73ms/step
Epoch 20/50
1290/1290 - 93s - loss: 3.1559 - accuracy500: 0.4463 - val_loss: 3.3814 - val_accuracy500: 0.3808 - 93s/epoch - 72ms/step
testing model: results/EXC/W1/deepOF_L2/h500
Evaluating performance on  test set...
5343/5343 - 158s - 158s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0899544
{'0': {'precision': 0.39212818044702474, 'recall': 0.5592814319472641, 'f1-score': 0.46102122032460485, 'support': 462531}, '1': {'precision': 0.36089116910398317, 'recall': 0.285261702962348, 'f1-score': 0.3186503811503811, 'support': 438436}, '2': {'precision': 0.4139760409146606, 'recall': 0.3206095750583205, 'f1-score': 0.3613593287861411, 'support': 466817}, 'accuracy': 0.3899884777128552, 'macro avg': {'precision': 0.38899846348855616, 'recall': 0.38838423665597754, 'f1-score': 0.3803436434203757, 'support': 1367784}, 'weighted avg': {'precision': 0.38957187212255434, 'recall': 0.3899884777128552, 'f1-score': 0.3813709491805492, 'support': 1367784}}
[[258685 106948  96898]
 [198398 125069 114969]
 [202612 114539 149666]]
Evaluating performance on  train set...
1290/1290 - 42s - 42s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0768849
{'0': {'precision': 0.4078170691032632, 'recall': 0.48384929691526174, 'f1-score': 0.44259155593529953, 'support': 108664}, '1': {'precision': 0.38059912392256606, 'recall': 0.2998246802037049, 'f1-score': 0.33541745577941856, 'support': 107803}, '2': {'precision': 0.432786039714605, 'recall': 0.44275789288541023, 'f1-score': 0.43771517996870113, 'support': 113710}, 'accuracy': 0.4096136314764505, 'macro avg': {'precision': 0.40706741091347814, 'recall': 0.4088106233347923, 'f1-score': 0.4052413972278064, 'support': 330177}, 'weighted avg': {'precision': 0.4075294824570128, 'recall': 0.4096136314764505, 'f1-score': 0.4059197640471112, 'support': 330177}}
[[52577 25416 30671]
 [40168 32322 35313]
 [36178 27186 50346]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 33ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0803987
{'0': {'precision': 0.3993581940909594, 'recall': 0.4713488098736409, 'f1-score': 0.4323773867465369, 'support': 30627}, '1': {'precision': 0.3877900183608746, 'recall': 0.2925731196675377, 'f1-score': 0.33351876110323536, 'support': 31763}, '2': {'precision': 0.4041916167664671, 'recall': 0.43442569120640967, 'f1-score': 0.41876365017567185, 'support': 30454}, 'accuracy': 0.3980763431131791, 'macro avg': {'precision': 0.39711327640610045, 'recall': 0.3994492069158628, 'f1-score': 0.39488659934181475, 'support': 92844}, 'weighted avg': {'precision': 0.396986011596078, 'recall': 0.3980763431131791, 'f1-score': 0.3940912372932894, 'support': 92844}}
[[14436  7266  8925]
 [11893  9293 10577]
 [ 9819  7405 13230]]
training model: results/EXC/W1/deepOF_L2/h1000
Epoch 1/50
1290/1290 - 95s - loss: 3.2542 - accuracy1000: 0.3961 - val_loss: 3.4379 - val_accuracy1000: 0.3206 - 95s/epoch - 74ms/step
Epoch 2/50
1290/1290 - 87s - loss: 3.2562 - accuracy1000: 0.3939 - val_loss: 3.3924 - val_accuracy1000: 0.3341 - 87s/epoch - 68ms/step
Epoch 3/50
1290/1290 - 91s - loss: 3.2631 - accuracy1000: 0.3887 - val_loss: 3.3513 - val_accuracy1000: 0.3387 - 91s/epoch - 71ms/step
Epoch 4/50
1290/1290 - 90s - loss: 3.2631 - accuracy1000: 0.3865 - val_loss: 3.3404 - val_accuracy1000: 0.3402 - 90s/epoch - 70ms/step
Epoch 5/50
1290/1290 - 88s - loss: 3.2604 - accuracy1000: 0.3875 - val_loss: 3.3366 - val_accuracy1000: 0.3428 - 88s/epoch - 68ms/step
Epoch 6/50
1290/1290 - 93s - loss: 3.2568 - accuracy1000: 0.3889 - val_loss: 3.3300 - val_accuracy1000: 0.3435 - 93s/epoch - 72ms/step
Epoch 7/50
1290/1290 - 91s - loss: 3.2538 - accuracy1000: 0.3913 - val_loss: 3.3322 - val_accuracy1000: 0.3448 - 91s/epoch - 70ms/step
Epoch 8/50
1290/1290 - 95s - loss: 3.2501 - accuracy1000: 0.3950 - val_loss: 3.3370 - val_accuracy1000: 0.3455 - 95s/epoch - 74ms/step
Epoch 9/50
1290/1290 - 99s - loss: 3.2473 - accuracy1000: 0.3960 - val_loss: 3.3386 - val_accuracy1000: 0.3469 - 99s/epoch - 76ms/step
Epoch 10/50
1290/1290 - 91s - loss: 3.2446 - accuracy1000: 0.3985 - val_loss: 3.3401 - val_accuracy1000: 0.3465 - 91s/epoch - 70ms/step
Epoch 11/50
1290/1290 - 91s - loss: 3.2413 - accuracy1000: 0.4018 - val_loss: 3.3476 - val_accuracy1000: 0.3469 - 91s/epoch - 71ms/step
Epoch 12/50
1290/1290 - 91s - loss: 3.2381 - accuracy1000: 0.4037 - val_loss: 3.3462 - val_accuracy1000: 0.3466 - 91s/epoch - 70ms/step
Epoch 13/50
1290/1290 - 91s - loss: 3.2365 - accuracy1000: 0.4039 - val_loss: 3.3448 - val_accuracy1000: 0.3462 - 91s/epoch - 70ms/step
Epoch 14/50
1290/1290 - 91s - loss: 3.2341 - accuracy1000: 0.4046 - val_loss: 3.3433 - val_accuracy1000: 0.3478 - 91s/epoch - 70ms/step
Epoch 15/50
1290/1290 - 90s - loss: 3.2304 - accuracy1000: 0.4074 - val_loss: 3.3465 - val_accuracy1000: 0.3482 - 90s/epoch - 69ms/step
Epoch 16/50
1290/1290 - 91s - loss: 3.2280 - accuracy1000: 0.4086 - val_loss: 3.3498 - val_accuracy1000: 0.3483 - 91s/epoch - 71ms/step
testing model: results/EXC/W1/deepOF_L2/h1000
Evaluating performance on  test set...
5343/5343 - 171s - 171s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1344485
{'0': {'precision': 0.2808540677940595, 'recall': 0.5853671054995252, 'f1-score': 0.37958604061195284, 'support': 350703}, '1': {'precision': 0.41910392034847543, 'recall': 0.006070374888086382, 'f1-score': 0.011967411680738714, 'support': 665692}, '2': {'precision': 0.28187017393370145, 'recall': 0.5031090899259795, 'f1-score': 0.36131259311943204, 'support': 351389}, 'accuracy': 0.28229457282728854, 'macro avg': {'precision': 0.3272760540254121, 'recall': 0.364848856771197, 'f1-score': 0.2509553484707079, 'support': 1367784}, 'weighted avg': {'precision': 0.3484004562347467, 'recall': 0.28229457282728854, 'f1-score': 0.19597381180138976, 'support': 1367784}}
[[205290   3020 142393]
 [353638   4041 308013]
 [172021   2581 176787]]
Evaluating performance on  train set...
1290/1290 - 45s - 45s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967757
{'0': {'precision': 0.35809954751131223, 'recall': 0.5587194306907393, 'f1-score': 0.4364594976175069, 'support': 106234}, '1': {'precision': 0.4205056179775281, 'recall': 0.013675354216339171, 'f1-score': 0.026489245932387835, 'support': 109467}, '2': {'precision': 0.38424910018835434, 'recall': 0.5399647087599148, 'f1-score': 0.4489890790759162, 'support': 114476}, 'accuracy': 0.3715128552261363, 'macro avg': {'precision': 0.38761808855906493, 'recall': 0.3707864978889977, 'f1-score': 0.30397927420860366, 'support': 330177}, 'weighted avg': {'precision': 0.3878560160357168, 'recall': 0.3715128552261363, 'f1-score': 0.3048819583758818, 'support': 330177}}
[[59355   999 45880]
 [54796  1497 53174]
 [51599  1064 61813]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 33ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1082811
{'0': {'precision': 0.34113690319177, 'recall': 0.5355811706239647, 'f1-score': 0.4167964763388301, 'support': 28976}, '1': {'precision': 0.42394822006472493, 'recall': 0.011162552901411651, 'f1-score': 0.021752366192505673, 'support': 35207}, '2': {'precision': 0.34507269789983847, 'recall': 0.5589476989637486, 'f1-score': 0.4267107050581999, 'support': 28661}, 'accuracy': 0.34393175649476543, 'macro avg': {'precision': 0.3700526070521111, 'recall': 0.368563807496375, 'f1-score': 0.2884198491965119, 'support': 92844}, 'weighted avg': {'precision': 0.3737544320064923, 'recall': 0.34393175649476543, 'f1-score': 0.2700539159515591, 'support': 92844}}
[[15519   281 13176]
 [17585   393 17229]
 [12388   253 16020]]
training model: results/EXC/W1/deepVOL_L2/h10
Epoch 1/50
1290/1290 - 86s - loss: 2.3804 - accuracy10: 0.5867 - val_loss: 2.3876 - val_accuracy10: 0.7582 - 86s/epoch - 67ms/step
Epoch 2/50
1290/1290 - 84s - loss: 2.1283 - accuracy10: 0.6579 - val_loss: 2.3782 - val_accuracy10: 0.7590 - 84s/epoch - 65ms/step
Epoch 3/50
1290/1290 - 80s - loss: 2.0593 - accuracy10: 0.6738 - val_loss: 2.3523 - val_accuracy10: 0.7768 - 80s/epoch - 62ms/step
Epoch 4/50
1290/1290 - 85s - loss: 2.0234 - accuracy10: 0.6773 - val_loss: 2.3302 - val_accuracy10: 0.7712 - 85s/epoch - 66ms/step
Epoch 5/50
1290/1290 - 82s - loss: 1.9976 - accuracy10: 0.6810 - val_loss: 2.3234 - val_accuracy10: 0.7633 - 82s/epoch - 63ms/step
Epoch 6/50
1290/1290 - 83s - loss: 1.9723 - accuracy10: 0.6821 - val_loss: 2.2961 - val_accuracy10: 0.7678 - 83s/epoch - 65ms/step
Epoch 7/50
1290/1290 - 81s - loss: 1.9578 - accuracy10: 0.6820 - val_loss: 2.2725 - val_accuracy10: 0.7698 - 81s/epoch - 63ms/step
Epoch 8/50
1290/1290 - 81s - loss: 1.9435 - accuracy10: 0.6833 - val_loss: 2.2881 - val_accuracy10: 0.7661 - 81s/epoch - 63ms/step
Epoch 9/50
1290/1290 - 82s - loss: 1.9300 - accuracy10: 0.6840 - val_loss: 2.2732 - val_accuracy10: 0.7673 - 82s/epoch - 63ms/step
Epoch 10/50
1290/1290 - 84s - loss: 1.9227 - accuracy10: 0.6848 - val_loss: 2.2981 - val_accuracy10: 0.7664 - 84s/epoch - 65ms/step
Epoch 11/50
1290/1290 - 81s - loss: 1.9123 - accuracy10: 0.6839 - val_loss: 2.3015 - val_accuracy10: 0.7656 - 81s/epoch - 63ms/step
Epoch 12/50
1290/1290 - 83s - loss: 1.9015 - accuracy10: 0.6846 - val_loss: 2.2998 - val_accuracy10: 0.7722 - 83s/epoch - 64ms/step
Epoch 13/50
1290/1290 - 77s - loss: 1.8928 - accuracy10: 0.6854 - val_loss: 2.2827 - val_accuracy10: 0.7685 - 77s/epoch - 60ms/step
Epoch 14/50
1290/1290 - 80s - loss: 1.8872 - accuracy10: 0.6857 - val_loss: 2.3146 - val_accuracy10: 0.7691 - 80s/epoch - 62ms/step
Epoch 15/50
1290/1290 - 81s - loss: 1.8790 - accuracy10: 0.6856 - val_loss: 2.2801 - val_accuracy10: 0.7619 - 81s/epoch - 63ms/step
Epoch 16/50
1290/1290 - 81s - loss: 1.8745 - accuracy10: 0.6850 - val_loss: 2.2863 - val_accuracy10: 0.7663 - 81s/epoch - 63ms/step
Epoch 17/50
1290/1290 - 78s - loss: 1.8687 - accuracy10: 0.6862 - val_loss: 2.2943 - val_accuracy10: 0.7701 - 78s/epoch - 61ms/step
testing model: results/EXC/W1/deepVOL_L2/h10
Evaluating performance on  test set...
5343/5343 - 140s - 140s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5526055
{'0': {'precision': 0.486097822288173, 'recall': 0.5479356509496716, 'f1-score': 0.5151677069924465, 'support': 154843}, '1': {'precision': 0.9033265891577211, 'recall': 0.8134615912734601, 'f1-score': 0.8560421058715727, 'support': 1055997}, '2': {'precision': 0.42375693343898574, 'recall': 0.654212514893373, 'f1-score': 0.5143505496514741, 'support': 156949}, 'accuracy': 0.7651289782269048, 'macro avg': {'precision': 0.6043937816282933, 'recall': 0.6718699190388349, 'f1-score': 0.6285201208384977, 'support': 1367789}, 'weighted avg': {'precision': 0.8010645210728182, 'recall': 0.7651289782269048, 'f1-score': 0.7782448998677016, 'support': 1367789}}
[[ 84844  49666  20333]
 [ 77691 859013 119293]
 [ 12006  42265 102678]]
Evaluating performance on  train set...
1290/1290 - 36s - 36s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5268922
{'0': {'precision': 0.4352387564606958, 'recall': 0.5321470116640991, 'f1-score': 0.4788389725019803, 'support': 31807}, '1': {'precision': 0.9174877001988904, 'recall': 0.8251173929906876, 'f1-score': 0.8688544091231716, 'support': 265561}, '2': {'precision': 0.39677486990831634, 'recall': 0.6344600566917614, 'f1-score': 0.48822591237451923, 'support': 32809}, 'accuracy': 0.7779494028960224, 'macro avg': {'precision': 0.5831671088559675, 'recall': 0.6639081537821827, 'f1-score': 0.6119730979998904, 'support': 330177}, 'weighted avg': {'precision': 0.8192889782937176, 'recall': 0.7779494028960224, 'f1-score': 0.7934607222750969, 'support': 330177}}
[[ 16926  10445   4436]
 [ 19231 219119  27211]
 [  2732   9261  20816]]
Evaluating performance on  val set...
363/363 - 10s - 10s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5410205
{'0': {'precision': 0.3934672571970895, 'recall': 0.5480885755205465, 'f1-score': 0.45808204042171174, 'support': 9077}, '1': {'precision': 0.9170161278201139, 'recall': 0.8156744254448708, 'f1-score': 0.8633816370429072, 'support': 74797}, '2': {'precision': 0.40171190284585556, 'recall': 0.6121516164994426, 'f1-score': 0.48509209770749595, 'support': 8970}, 'accuracy': 0.7698505019171944, 'macro avg': {'precision': 0.5707317626210197, 'recall': 0.6586382058216199, 'f1-score': 0.6021852583907049, 'support': 92844}, 'weighted avg': {'precision': 0.8160453381442675, 'recall': 0.7698505019171944, 'f1-score': 0.7872091153250877, 'support': 92844}}
[[ 4975  2907  1195]
 [ 6804 61010  6983]
 [  865  2614  5491]]
training model: results/EXC/W1/deepVOL_L2/h20
Epoch 1/50
1290/1290 - 87s - loss: 2.4918 - accuracy20: 0.5797 - val_loss: 2.5028 - val_accuracy20: 0.7020 - 87s/epoch - 67ms/step
Epoch 2/50
1290/1290 - 75s - loss: 2.2447 - accuracy20: 0.6441 - val_loss: 2.4338 - val_accuracy20: 0.7220 - 75s/epoch - 58ms/step
Epoch 3/50
1290/1290 - 79s - loss: 2.1790 - accuracy20: 0.6572 - val_loss: 2.4005 - val_accuracy20: 0.7254 - 79s/epoch - 61ms/step
Epoch 4/50
1290/1290 - 83s - loss: 2.1368 - accuracy20: 0.6628 - val_loss: 2.4137 - val_accuracy20: 0.7307 - 83s/epoch - 64ms/step
Epoch 5/50
1290/1290 - 79s - loss: 2.1028 - accuracy20: 0.6647 - val_loss: 2.4120 - val_accuracy20: 0.7236 - 79s/epoch - 61ms/step
Epoch 6/50
1290/1290 - 80s - loss: 2.0808 - accuracy20: 0.6651 - val_loss: 2.3820 - val_accuracy20: 0.7309 - 80s/epoch - 62ms/step
Epoch 7/50
1290/1290 - 81s - loss: 2.0626 - accuracy20: 0.6663 - val_loss: 2.4031 - val_accuracy20: 0.7335 - 81s/epoch - 63ms/step
Epoch 8/50
1290/1290 - 78s - loss: 2.0504 - accuracy20: 0.6678 - val_loss: 2.3752 - val_accuracy20: 0.7284 - 78s/epoch - 61ms/step
Epoch 9/50
1290/1290 - 80s - loss: 2.0422 - accuracy20: 0.6665 - val_loss: 2.3779 - val_accuracy20: 0.7273 - 80s/epoch - 62ms/step
Epoch 10/50
1290/1290 - 80s - loss: 2.0267 - accuracy20: 0.6685 - val_loss: 2.3959 - val_accuracy20: 0.7245 - 80s/epoch - 62ms/step
Epoch 11/50
1290/1290 - 80s - loss: 2.0192 - accuracy20: 0.6682 - val_loss: 2.3930 - val_accuracy20: 0.7240 - 80s/epoch - 62ms/step
Epoch 12/50
1290/1290 - 81s - loss: 2.0081 - accuracy20: 0.6681 - val_loss: 2.3779 - val_accuracy20: 0.7210 - 81s/epoch - 63ms/step
Epoch 13/50
1290/1290 - 81s - loss: 2.0017 - accuracy20: 0.6694 - val_loss: 2.3942 - val_accuracy20: 0.7207 - 81s/epoch - 63ms/step
Epoch 14/50
1290/1290 - 76s - loss: 1.9945 - accuracy20: 0.6701 - val_loss: 2.4094 - val_accuracy20: 0.7291 - 76s/epoch - 59ms/step
Epoch 15/50
1290/1290 - 79s - loss: 1.9893 - accuracy20: 0.6692 - val_loss: 2.3707 - val_accuracy20: 0.7230 - 79s/epoch - 61ms/step
Epoch 16/50
1290/1290 - 77s - loss: 1.9812 - accuracy20: 0.6709 - val_loss: 2.3891 - val_accuracy20: 0.7204 - 77s/epoch - 60ms/step
Epoch 17/50
1290/1290 - 78s - loss: 1.9775 - accuracy20: 0.6711 - val_loss: 2.4155 - val_accuracy20: 0.7300 - 78s/epoch - 61ms/step
Epoch 18/50
1290/1290 - 82s - loss: 1.9724 - accuracy20: 0.6719 - val_loss: 2.4009 - val_accuracy20: 0.7237 - 82s/epoch - 64ms/step
Epoch 19/50
1290/1290 - 79s - loss: 1.9650 - accuracy20: 0.6724 - val_loss: 2.3851 - val_accuracy20: 0.7225 - 79s/epoch - 61ms/step
Epoch 20/50
1290/1290 - 71s - loss: 1.9619 - accuracy20: 0.6731 - val_loss: 2.3857 - val_accuracy20: 0.7238 - 71s/epoch - 55ms/step
Epoch 21/50
1290/1290 - 81s - loss: 1.9568 - accuracy20: 0.6731 - val_loss: 2.3864 - val_accuracy20: 0.7251 - 81s/epoch - 63ms/step
Epoch 22/50
1290/1290 - 79s - loss: 1.9511 - accuracy20: 0.6727 - val_loss: 2.3898 - val_accuracy20: 0.7233 - 79s/epoch - 61ms/step
Epoch 23/50
1290/1290 - 72s - loss: 1.9459 - accuracy20: 0.6732 - val_loss: 2.4093 - val_accuracy20: 0.7254 - 72s/epoch - 56ms/step
Epoch 24/50
1290/1290 - 77s - loss: 1.9418 - accuracy20: 0.6740 - val_loss: 2.3951 - val_accuracy20: 0.7228 - 77s/epoch - 60ms/step
Epoch 25/50
1290/1290 - 80s - loss: 1.9373 - accuracy20: 0.6742 - val_loss: 2.4211 - val_accuracy20: 0.7247 - 80s/epoch - 62ms/step
testing model: results/EXC/W1/deepVOL_L2/h20
Evaluating performance on  test set...
5343/5343 - 147s - 147s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6302199
{'0': {'precision': 0.5604278999198168, 'recall': 0.5325467544496001, 'f1-score': 0.5461317113112645, 'support': 219177}, '1': {'precision': 0.8371737875487867, 'recall': 0.7852817383012645, 'f1-score': 0.8103979143614737, 'support': 927066}, '2': {'precision': 0.4895210303745249, 'recall': 0.6405847995450155, 'f1-score': 0.5549563993274156, 'support': 221546}, 'accuracy': 0.7213459093471288, 'macro avg': {'precision': 0.6290409059477094, 'recall': 0.6528044307652934, 'f1-score': 0.6371620083333845, 'support': 1367789}, 'weighted avg': {'precision': 0.7365168798285289, 'recall': 0.7213459093471288, 'f1-score': 0.7266765805331777, 'support': 1367789}}
[[116722  77173  25282]
 [ 76345 728008 122713]
 [ 15206  64421 141919]]
Evaluating performance on  train set...
1290/1290 - 38s - 38s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.603355
{'0': {'precision': 0.5001567561918696, 'recall': 0.5340206645689675, 'f1-score': 0.5165342773268866, 'support': 44811}, '1': {'precision': 0.8673917810221645, 'recall': 0.7938715867899206, 'f1-score': 0.8290048440368575, 'support': 239181}, '2': {'precision': 0.45889568617558024, 'recall': 0.6301829598354444, 'f1-score': 0.5310695289620377, 'support': 46185}, 'accuracy': 0.7357084230579356, 'macro avg': {'precision': 0.6088147411298714, 'recall': 0.6526917370647776, 'f1-score': 0.6255362167752606, 'support': 330177}, 'weighted avg': {'precision': 0.7604110984241645, 'recall': 0.7357084230579356, 'f1-score': 0.7449218791677992, 'support': 330177}}
[[ 23930  15652   5229]
 [ 20212 189879  29090]
 [  3703  13377  29105]]
Evaluating performance on  val set...
363/363 - 10s - 10s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6211613
{'0': {'precision': 0.4488940478493584, 'recall': 0.5468614973682143, 'f1-score': 0.49305850687066155, 'support': 12729}, '1': {'precision': 0.8663564922894814, 'recall': 0.7803841426392406, 'f1-score': 0.8211261131411031, 'support': 67527}, '2': {'precision': 0.4559384652655805, 'recall': 0.598029869717191, 'f1-score': 0.5174060964294305, 'support': 12588}, 'accuracy': 0.7236439619146094, 'macro avg': {'precision': 0.5903963351348067, 'recall': 0.6417585032415487, 'f1-score': 0.6105302388137317, 'support': 92844}, 'weighted avg': {'precision': 0.7534765907400525, 'recall': 0.7236439619146094, 'f1-score': 0.7349686863759596, 'support': 92844}}
[[ 6961  4226  1542]
 [ 7389 52697  7441]
 [ 1157  3903  7528]]
training model: results/EXC/W1/deepVOL_L2/h30
Epoch 1/50
1290/1290 - 89s - loss: 2.6016 - accuracy30: 0.5676 - val_loss: 2.5588 - val_accuracy30: 0.6659 - 89s/epoch - 69ms/step
Epoch 2/50
1290/1290 - 81s - loss: 2.3702 - accuracy30: 0.6237 - val_loss: 2.5652 - val_accuracy30: 0.6910 - 81s/epoch - 63ms/step
Epoch 3/50
1290/1290 - 78s - loss: 2.2974 - accuracy30: 0.6358 - val_loss: 2.5294 - val_accuracy30: 0.6820 - 78s/epoch - 61ms/step
Epoch 4/50
1290/1290 - 80s - loss: 2.2557 - accuracy30: 0.6414 - val_loss: 2.5336 - val_accuracy30: 0.6770 - 80s/epoch - 62ms/step
Epoch 5/50
1290/1290 - 82s - loss: 2.2202 - accuracy30: 0.6447 - val_loss: 2.5351 - val_accuracy30: 0.6950 - 82s/epoch - 64ms/step
Epoch 6/50
1290/1290 - 84s - loss: 2.1945 - accuracy30: 0.6466 - val_loss: 2.5088 - val_accuracy30: 0.6836 - 84s/epoch - 65ms/step
Epoch 7/50
1290/1290 - 85s - loss: 2.1753 - accuracy30: 0.6487 - val_loss: 2.4918 - val_accuracy30: 0.6917 - 85s/epoch - 66ms/step
Epoch 8/50
1290/1290 - 78s - loss: 2.1609 - accuracy30: 0.6484 - val_loss: 2.5004 - val_accuracy30: 0.6889 - 78s/epoch - 61ms/step
Epoch 9/50
1290/1290 - 80s - loss: 2.1501 - accuracy30: 0.6504 - val_loss: 2.5055 - val_accuracy30: 0.6950 - 80s/epoch - 62ms/step
Epoch 10/50
1290/1290 - 83s - loss: 2.1402 - accuracy30: 0.6505 - val_loss: 2.5163 - val_accuracy30: 0.6946 - 83s/epoch - 64ms/step
Epoch 11/50
1290/1290 - 86s - loss: 2.1323 - accuracy30: 0.6511 - val_loss: 2.5365 - val_accuracy30: 0.6903 - 86s/epoch - 67ms/step
Epoch 12/50
1290/1290 - 82s - loss: 2.1226 - accuracy30: 0.6519 - val_loss: 2.5063 - val_accuracy30: 0.6863 - 82s/epoch - 64ms/step
Epoch 13/50
1290/1290 - 81s - loss: 2.1163 - accuracy30: 0.6526 - val_loss: 2.5407 - val_accuracy30: 0.6839 - 81s/epoch - 63ms/step
Epoch 14/50
1290/1290 - 81s - loss: 2.1112 - accuracy30: 0.6520 - val_loss: 2.5388 - val_accuracy30: 0.6898 - 81s/epoch - 63ms/step
Epoch 15/50
1290/1290 - 81s - loss: 2.1042 - accuracy30: 0.6530 - val_loss: 2.5346 - val_accuracy30: 0.6877 - 81s/epoch - 63ms/step
Epoch 16/50
1290/1290 - 82s - loss: 2.0991 - accuracy30: 0.6537 - val_loss: 2.5317 - val_accuracy30: 0.6826 - 82s/epoch - 64ms/step
Epoch 17/50
1290/1290 - 78s - loss: 2.0943 - accuracy30: 0.6542 - val_loss: 2.5744 - val_accuracy30: 0.6838 - 78s/epoch - 60ms/step
testing model: results/EXC/W1/deepVOL_L2/h30
Evaluating performance on  test set...
5343/5343 - 155s - 155s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7143069
{'0': {'precision': 0.5813354826505687, 'recall': 0.5268870104506761, 'f1-score': 0.5527736829551542, 'support': 268308}, '1': {'precision': 0.7621655623187995, 'recall': 0.7776383728224678, 'f1-score': 0.7698242278469524, 'support': 828920}, '2': {'precision': 0.5438225938901898, 'recall': 0.5605094599739061, 'f1-score': 0.5520399545706048, 'support': 270561}, 'accuracy': 0.6855004682739808, 'macro avg': {'precision': 0.6291078796198527, 'recall': 0.62167828108235, 'f1-score': 0.6248792884575706, 'support': 1367789}, 'weighted avg': {'precision': 0.6835033937411631, 'recall': 0.6855004682739808, 'f1-score': 0.6841675012898953, 'support': 1367789}}
[[141368 104246  22694]
 [ 79803 644600 104517]
 [ 22007  96902 151652]]
Evaluating performance on  train set...
1290/1290 - 37s - 37s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6714466
{'0': {'precision': 0.5273342134293, 'recall': 0.5332163036919195, 'f1-score': 0.5302589467558918, 'support': 54687}, '1': {'precision': 0.809950904139281, 'recall': 0.7906131587227038, 'f1-score': 0.8001652137395069, 'support': 219307}, '2': {'precision': 0.514463319574405, 'recall': 0.5568232383461189, 'f1-score': 0.5348057986870897, 'support': 56183}, 'accuracy': 0.7081989357223549, 'macro avg': {'precision': 0.617249479047662, 'recall': 0.6268842335869141, 'f1-score': 0.6217433197274961, 'support': 330177}, 'weighted avg': {'precision': 0.7128610464918217, 'recall': 0.7081989357223549, 'f1-score': 0.7103071920165435, 'support': 330177}}
[[ 29160  20838   4689]
 [ 21084 173387  24836]
 [  5053  19846  31284]]
Evaluating performance on  val set...
363/363 - 11s - 11s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69469863
{'0': {'precision': 0.4696795398520953, 'recall': 0.5535898760330579, 'f1-score': 0.5081942921494829, 'support': 15488}, '1': {'precision': 0.8078159363897818, 'recall': 0.7694538891664116, 'f1-score': 0.7881683956852938, 'support': 62057}, '2': {'precision': 0.5106919051618322, 'recall': 0.5167004379371201, 'f1-score': 0.5136786015985444, 'support': 15299}, 'accuracy': 0.6917948386540864, 'macro avg': {'precision': 0.5960624604679031, 'recall': 0.6132480677121964, 'f1-score': 0.6033470964777737, 'support': 92844}, 'weighted avg': {'precision': 0.7024482544358366, 'recall': 0.6917948386540864, 'f1-score': 0.6962329095440697, 'support': 92844}}
[[ 8574  5623  1291]
 [ 8024 47750  6283]
 [ 1657  5737  7905]]
training model: results/EXC/W1/deepVOL_L2/h50
Epoch 1/50
1290/1290 - 90s - loss: 2.7826 - accuracy50: 0.5423 - val_loss: 2.8349 - val_accuracy50: 0.6071 - 90s/epoch - 70ms/step
Epoch 2/50
1290/1290 - 84s - loss: 2.5849 - accuracy50: 0.5917 - val_loss: 2.7879 - val_accuracy50: 0.6128 - 84s/epoch - 65ms/step
Epoch 3/50
1290/1290 - 83s - loss: 2.5294 - accuracy50: 0.5995 - val_loss: 2.7464 - val_accuracy50: 0.6154 - 83s/epoch - 64ms/step
Epoch 4/50
1290/1290 - 83s - loss: 2.5026 - accuracy50: 0.6032 - val_loss: 2.7621 - val_accuracy50: 0.6036 - 83s/epoch - 64ms/step
Epoch 5/50
1290/1290 - 82s - loss: 2.4869 - accuracy50: 0.6046 - val_loss: 2.7540 - val_accuracy50: 0.6093 - 82s/epoch - 64ms/step
Epoch 6/50
1290/1290 - 80s - loss: 2.4674 - accuracy50: 0.6067 - val_loss: 2.7338 - val_accuracy50: 0.6047 - 80s/epoch - 62ms/step
Epoch 7/50
1290/1290 - 83s - loss: 2.4541 - accuracy50: 0.6077 - val_loss: 2.7177 - val_accuracy50: 0.6146 - 83s/epoch - 64ms/step
Epoch 8/50
1290/1290 - 83s - loss: 2.4389 - accuracy50: 0.6096 - val_loss: 2.7331 - val_accuracy50: 0.6138 - 83s/epoch - 65ms/step
Epoch 9/50
1290/1290 - 81s - loss: 2.4247 - accuracy50: 0.6109 - val_loss: 2.7082 - val_accuracy50: 0.6143 - 81s/epoch - 63ms/step
Epoch 10/50
1290/1290 - 81s - loss: 2.4138 - accuracy50: 0.6110 - val_loss: 2.7019 - val_accuracy50: 0.6243 - 81s/epoch - 63ms/step
Epoch 11/50
1290/1290 - 82s - loss: 2.4010 - accuracy50: 0.6121 - val_loss: 2.6965 - val_accuracy50: 0.6218 - 82s/epoch - 63ms/step
Epoch 12/50
1290/1290 - 83s - loss: 2.3885 - accuracy50: 0.6132 - val_loss: 2.6985 - val_accuracy50: 0.6228 - 83s/epoch - 64ms/step
Epoch 13/50
1290/1290 - 83s - loss: 2.3792 - accuracy50: 0.6140 - val_loss: 2.6935 - val_accuracy50: 0.6249 - 83s/epoch - 64ms/step
Epoch 14/50
1290/1290 - 83s - loss: 2.3705 - accuracy50: 0.6159 - val_loss: 2.6822 - val_accuracy50: 0.6258 - 83s/epoch - 64ms/step
Epoch 15/50
1290/1290 - 83s - loss: 2.3637 - accuracy50: 0.6157 - val_loss: 2.6987 - val_accuracy50: 0.6301 - 83s/epoch - 64ms/step
Epoch 16/50
1290/1290 - 83s - loss: 2.3557 - accuracy50: 0.6168 - val_loss: 2.6707 - val_accuracy50: 0.6242 - 83s/epoch - 64ms/step
Epoch 17/50
1290/1290 - 83s - loss: 2.3475 - accuracy50: 0.6177 - val_loss: 2.6986 - val_accuracy50: 0.6243 - 83s/epoch - 65ms/step
Epoch 18/50
1290/1290 - 81s - loss: 2.3438 - accuracy50: 0.6177 - val_loss: 2.6979 - val_accuracy50: 0.6274 - 81s/epoch - 63ms/step
Epoch 19/50
1290/1290 - 81s - loss: 2.3393 - accuracy50: 0.6185 - val_loss: 2.6896 - val_accuracy50: 0.6273 - 81s/epoch - 63ms/step
Epoch 20/50
1290/1290 - 79s - loss: 2.3334 - accuracy50: 0.6193 - val_loss: 2.6820 - val_accuracy50: 0.6245 - 79s/epoch - 61ms/step
Epoch 21/50
1290/1290 - 81s - loss: 2.3284 - accuracy50: 0.6202 - val_loss: 2.6970 - val_accuracy50: 0.6236 - 81s/epoch - 63ms/step
Epoch 22/50
1290/1290 - 81s - loss: 2.3230 - accuracy50: 0.6208 - val_loss: 2.6906 - val_accuracy50: 0.6223 - 81s/epoch - 63ms/step
Epoch 23/50
1290/1290 - 83s - loss: 2.3176 - accuracy50: 0.6216 - val_loss: 2.7030 - val_accuracy50: 0.6237 - 83s/epoch - 64ms/step
Epoch 24/50
1290/1290 - 85s - loss: 2.3121 - accuracy50: 0.6220 - val_loss: 2.6942 - val_accuracy50: 0.6232 - 85s/epoch - 66ms/step
Epoch 25/50
1290/1290 - 81s - loss: 2.3067 - accuracy50: 0.6228 - val_loss: 2.6919 - val_accuracy50: 0.6207 - 81s/epoch - 63ms/step
Epoch 26/50
1290/1290 - 84s - loss: 2.3013 - accuracy50: 0.6242 - val_loss: 2.7016 - val_accuracy50: 0.6217 - 84s/epoch - 65ms/step
testing model: results/EXC/W1/deepVOL_L2/h50
Evaluating performance on  test set...
5343/5343 - 151s - 151s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84568244
{'0': {'precision': 0.6183429257259652, 'recall': 0.45075363825363823, 'f1-score': 0.5214128131174042, 'support': 346320}, '1': {'precision': 0.6284109963346386, 'recall': 0.7454920358557333, 'f1-score': 0.6819628198429162, 'support': 673142}, '2': {'precision': 0.5678951937495067, 'recall': 0.5164543661559396, 'f1-score': 0.5409546204943001, 'support': 348327}, 'accuracy': 0.6125374600907011, 'macro avg': {'precision': 0.6048830386033702, 'recall': 0.5709000134217704, 'f1-score': 0.5814434178182069, 'support': 1367789}, 'weighted avg': {'precision': 0.6104505783313743, 'recall': 0.6125374600907011, 'f1-score': 0.6054022967039783, 'support': 1367789}}
[[156105 155858  34357]
 [ 68797 501822 102523]
 [ 27555 140877 179895]]
Evaluating performance on  train set...
1290/1290 - 39s - 39s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7827434
{'0': {'precision': 0.5688289518607033, 'recall': 0.4729073827027334, 'f1-score': 0.5164520078734055, 'support': 70462}, '1': {'precision': 0.7072988817232103, 'recall': 0.7588368346367642, 'f1-score': 0.7321620209642095, 'support': 187454}, '2': {'precision': 0.544251177572215, 'recall': 0.5308672728027567, 'f1-score': 0.5374759185960979, 'support': 72261}, 'accuracy': 0.6479252037543499, 'macro avg': {'precision': 0.6067930037187096, 'recall': 0.5875371633807515, 'f1-score': 0.5953633158112376, 'support': 330177}, 'weighted avg': {'precision': 0.64206460329792, 'recall': 0.6479252037543499, 'f1-score': 0.6435199550855252, 'support': 330177}}
[[ 33322  30699   6441]
 [ 19525 142247  25682]
 [  5733  28167  38361]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80721104
{'0': {'precision': 0.5016440608302507, 'recall': 0.4922363379713652, 'f1-score': 0.4968956743002545, 'support': 19836}, '1': {'precision': 0.7059017112768758, 'recall': 0.7228171334431631, 'f1-score': 0.7142592866656801, 'support': 53416}, '2': {'precision': 0.5192678227360308, 'recall': 0.495202123315639, 'f1-score': 0.506949524506218, 'support': 19592}, 'accuracy': 0.6255223816293999, 'macro avg': {'precision': 0.5756045316143857, 'recall': 0.5700851982433891, 'f1-score': 0.5727014951573842, 'support': 92844}, 'weighted avg': {'precision': 0.6228787275778593, 'recall': 0.6255223816293999, 'f1-score': 0.6240731952100258, 'support': 92844}}
[[ 9764  8220  1852]
 [ 7676 38610  7130]
 [ 2024  7866  9702]]
training model: results/EXC/W1/deepVOL_L2/h100
Epoch 1/50
1290/1290 - 89s - loss: 3.0706 - accuracy100: 0.4719 - val_loss: 3.0111 - val_accuracy100: 0.4993 - 89s/epoch - 69ms/step
Epoch 2/50
1290/1290 - 80s - loss: 2.9333 - accuracy100: 0.5117 - val_loss: 3.0175 - val_accuracy100: 0.5049 - 80s/epoch - 62ms/step
Epoch 3/50
1290/1290 - 83s - loss: 2.8924 - accuracy100: 0.5190 - val_loss: 3.0002 - val_accuracy100: 0.5040 - 83s/epoch - 65ms/step
Epoch 4/50
1290/1290 - 81s - loss: 2.8724 - accuracy100: 0.5240 - val_loss: 3.0019 - val_accuracy100: 0.5021 - 81s/epoch - 63ms/step
Epoch 5/50
1290/1290 - 81s - loss: 2.8579 - accuracy100: 0.5276 - val_loss: 2.9881 - val_accuracy100: 0.5027 - 81s/epoch - 63ms/step
Epoch 6/50
1290/1290 - 81s - loss: 2.8460 - accuracy100: 0.5303 - val_loss: 2.9918 - val_accuracy100: 0.5073 - 81s/epoch - 63ms/step
Epoch 7/50
1290/1290 - 80s - loss: 2.8357 - accuracy100: 0.5315 - val_loss: 2.9931 - val_accuracy100: 0.5075 - 80s/epoch - 62ms/step
Epoch 8/50
1290/1290 - 82s - loss: 2.8257 - accuracy100: 0.5340 - val_loss: 2.9866 - val_accuracy100: 0.5084 - 82s/epoch - 63ms/step
Epoch 9/50
1290/1290 - 83s - loss: 2.8156 - accuracy100: 0.5369 - val_loss: 2.9849 - val_accuracy100: 0.5071 - 83s/epoch - 64ms/step
Epoch 10/50
1290/1290 - 80s - loss: 2.8063 - accuracy100: 0.5382 - val_loss: 2.9711 - val_accuracy100: 0.5104 - 80s/epoch - 62ms/step
Epoch 11/50
1290/1290 - 78s - loss: 2.7976 - accuracy100: 0.5401 - val_loss: 2.9553 - val_accuracy100: 0.5135 - 78s/epoch - 60ms/step
Epoch 12/50
1290/1290 - 82s - loss: 2.7902 - accuracy100: 0.5418 - val_loss: 2.9734 - val_accuracy100: 0.5098 - 82s/epoch - 64ms/step
Epoch 13/50
1290/1290 - 82s - loss: 2.7824 - accuracy100: 0.5434 - val_loss: 2.9687 - val_accuracy100: 0.5114 - 82s/epoch - 64ms/step
Epoch 14/50
1290/1290 - 80s - loss: 2.7779 - accuracy100: 0.5433 - val_loss: 2.9610 - val_accuracy100: 0.5129 - 80s/epoch - 62ms/step
Epoch 15/50
1290/1290 - 84s - loss: 2.7702 - accuracy100: 0.5460 - val_loss: 2.9670 - val_accuracy100: 0.5115 - 84s/epoch - 65ms/step
Epoch 16/50
1290/1290 - 81s - loss: 2.7670 - accuracy100: 0.5462 - val_loss: 2.9609 - val_accuracy100: 0.5119 - 81s/epoch - 63ms/step
Epoch 17/50
1290/1290 - 82s - loss: 2.7593 - accuracy100: 0.5485 - val_loss: 2.9597 - val_accuracy100: 0.5106 - 82s/epoch - 63ms/step
Epoch 18/50
1290/1290 - 84s - loss: 2.7539 - accuracy100: 0.5492 - val_loss: 2.9645 - val_accuracy100: 0.5098 - 84s/epoch - 65ms/step
Epoch 19/50
1290/1290 - 81s - loss: 2.7491 - accuracy100: 0.5501 - val_loss: 2.9750 - val_accuracy100: 0.5095 - 81s/epoch - 63ms/step
Epoch 20/50
1290/1290 - 81s - loss: 2.7421 - accuracy100: 0.5520 - val_loss: 2.9701 - val_accuracy100: 0.5118 - 81s/epoch - 63ms/step
Epoch 21/50
1290/1290 - 84s - loss: 2.7369 - accuracy100: 0.5524 - val_loss: 2.9839 - val_accuracy100: 0.5097 - 84s/epoch - 65ms/step
testing model: results/EXC/W1/deepVOL_L2/h100
Evaluating performance on  test set...
5343/5343 - 146s - 146s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0251979
{'0': {'precision': 0.594279469319831, 'recall': 0.36317193225925365, 'f1-score': 0.45083358344650115, 'support': 461170}, '1': {'precision': 0.39467019965329275, 'recall': 0.6770062593845542, 'f1-score': 0.49864713049257114, 'support': 442216}, '2': {'precision': 0.5680840081002575, 'recall': 0.40049052224038173, 'f1-score': 0.46978782520838597, 'support': 464403}, 'accuracy': 0.47730753793165465, 'macro avg': {'precision': 0.5190112256911271, 'recall': 0.4802229046280632, 'f1-score': 0.47308951304915275, 'support': 1367789}, 'weighted avg': {'precision': 0.5208502608881127, 'recall': 0.47730753793165465, 'f1-score': 0.4727275468118078, 'support': 1367789}}
[[167484 236330  57356]
 [ 58781 299383  84052]
 [ 55562 222852 185989]]
Evaluating performance on  train set...
1290/1290 - 38s - 38s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96494037
{'0': {'precision': 0.564763621491434, 'recall': 0.3823372574756963, 'f1-score': 0.4559813615600521, 'support': 97516}, '1': {'precision': 0.490453081074426, 'recall': 0.7177983662682443, 'f1-score': 0.5827370140556619, 'support': 133192}, '2': {'precision': 0.5732362627838447, 'recall': 0.3989584694729011, 'f1-score': 0.47047665340818157, 'support': 99469}, 'accuracy': 0.5226681446618026, 'macro avg': {'precision': 0.5428176551165681, 'recall': 0.49969803107228056, 'f1-score': 0.5030650096746317, 'support': 330177}, 'weighted avg': {'precision': 0.5373395297391093, 'recall': 0.5226681446618026, 'f1-score': 0.5114808998441751, 'support': 330177}}
[[37284 50522  9710]
 [17753 95605 19834]
 [10980 48805 39684]]
Evaluating performance on  val set...
363/363 - 11s - 11s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9708754
{'0': {'precision': 0.5141240295575717, 'recall': 0.40668121786097444, 'f1-score': 0.45413422014748106, 'support': 27031}, '1': {'precision': 0.5035455642727822, 'recall': 0.6788710907704043, 'f1-score': 0.5782099313511055, 'support': 39330}, '2': {'precision': 0.5374769497776332, 'recall': 0.3742023184684515, 'f1-score': 0.44121902896195553, 'support': 26483}, 'accuracy': 0.5127202619447676, 'macro avg': {'precision': 0.5183821812026624, 'recall': 0.4865848756999434, 'f1-score': 0.49118772682018075, 'support': 92844}, 'weighted avg': {'precision': 0.5163040772347195, 'recall': 0.5127202619447676, 'f1-score': 0.5030104503128366, 'support': 92844}}
[[10993 13299  2739]
 [ 6841 26700  5789]
 [ 3548 13025  9910]]
training model: results/EXC/W1/deepVOL_L2/h200
Epoch 1/50
1290/1290 - 85s - loss: 3.2346 - accuracy200: 0.4051 - val_loss: 3.2214 - val_accuracy200: 0.4039 - 85s/epoch - 66ms/step
Epoch 2/50
1290/1290 - 81s - loss: 3.1734 - accuracy200: 0.4237 - val_loss: 3.1761 - val_accuracy200: 0.4136 - 81s/epoch - 63ms/step
Epoch 3/50
1290/1290 - 82s - loss: 3.1553 - accuracy200: 0.4288 - val_loss: 3.1650 - val_accuracy200: 0.4191 - 82s/epoch - 64ms/step
Epoch 4/50
1290/1290 - 81s - loss: 3.1440 - accuracy200: 0.4320 - val_loss: 3.1620 - val_accuracy200: 0.4211 - 81s/epoch - 63ms/step
Epoch 5/50
1290/1290 - 80s - loss: 3.1378 - accuracy200: 0.4325 - val_loss: 3.1579 - val_accuracy200: 0.4233 - 80s/epoch - 62ms/step
Epoch 6/50
1290/1290 - 81s - loss: 3.1305 - accuracy200: 0.4358 - val_loss: 3.1616 - val_accuracy200: 0.4228 - 81s/epoch - 63ms/step
Epoch 7/50
1290/1290 - 82s - loss: 3.1248 - accuracy200: 0.4381 - val_loss: 3.1620 - val_accuracy200: 0.4223 - 82s/epoch - 64ms/step
Epoch 8/50
1290/1290 - 78s - loss: 3.1196 - accuracy200: 0.4403 - val_loss: 3.1609 - val_accuracy200: 0.4230 - 78s/epoch - 60ms/step
Epoch 9/50
1290/1290 - 79s - loss: 3.1157 - accuracy200: 0.4425 - val_loss: 3.1624 - val_accuracy200: 0.4214 - 79s/epoch - 61ms/step
Epoch 10/50
1290/1290 - 79s - loss: 3.1102 - accuracy200: 0.4446 - val_loss: 3.1637 - val_accuracy200: 0.4234 - 79s/epoch - 61ms/step
Epoch 11/50
1290/1290 - 78s - loss: 3.1051 - accuracy200: 0.4456 - val_loss: 3.1607 - val_accuracy200: 0.4236 - 78s/epoch - 60ms/step
Epoch 12/50
1290/1290 - 81s - loss: 3.1000 - accuracy200: 0.4490 - val_loss: 3.1625 - val_accuracy200: 0.4224 - 81s/epoch - 63ms/step
Epoch 13/50
1290/1290 - 76s - loss: 3.0971 - accuracy200: 0.4501 - val_loss: 3.1667 - val_accuracy200: 0.4210 - 76s/epoch - 59ms/step
Epoch 14/50
1290/1290 - 78s - loss: 3.0961 - accuracy200: 0.4494 - val_loss: 3.1617 - val_accuracy200: 0.4167 - 78s/epoch - 61ms/step
Epoch 15/50
1290/1290 - 81s - loss: 3.0908 - accuracy200: 0.4520 - val_loss: 3.1684 - val_accuracy200: 0.4196 - 81s/epoch - 63ms/step
testing model: results/EXC/W1/deepVOL_L2/h200
Evaluating performance on  test set...
5343/5343 - 152s - 152s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0723214
{'0': {'precision': 0.47196660658381556, 'recall': 0.3211214525162929, 'f1-score': 0.3821986739211515, 'support': 480270}, '1': {'precision': 0.32443776369010013, 'recall': 0.44449861087966014, 'f1-score': 0.37509510551596253, 'support': 402053}, '2': {'precision': 0.445287668661844, 'recall': 0.4496133611828635, 'f1-score': 0.4474400603496343, 'support': 485466}, 'accuracy': 0.40299271305735024, 'macro avg': {'precision': 0.4138973463119198, 'recall': 0.40507780819293887, 'f1-score': 0.4015779465955827, 'support': 1367789}, 'weighted avg': {'precision': 0.41913233817752277, 'recall': 0.40299271305735024, 'f1-score': 0.4032665900367793, 'support': 1367789}}
[[154225 193117 132928]
 [ 84359 178712 138982]
 [ 88187 179007 218272]]
Evaluating performance on  train set...
1290/1290 - 40s - 40s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0554458
{'0': {'precision': 0.46304057915793484, 'recall': 0.35672482433448915, 'f1-score': 0.4029886320065493, 'support': 109014}, '1': {'precision': 0.3674381573617532, 'recall': 0.48164931842941233, 'f1-score': 0.4168624390398504, 'support': 109233}, '2': {'precision': 0.4571048569514693, 'recall': 0.42066470115250604, 'f1-score': 0.438128381804901, 'support': 111930}, 'accuracy': 0.4197294178576945, 'macro avg': {'precision': 0.4291945311570524, 'recall': 0.4196796146388025, 'f1-score': 0.4193264842837669, 'support': 330177}, 'weighted avg': {'precision': 0.4294000629298753, 'recall': 0.4197294178576945, 'f1-score': 0.4194909012699991, 'support': 330177}}
[[38888 45860 24266]
 [24965 52612 31656]
 [20131 44714 47085]]
Evaluating performance on  val set...
363/363 - 10s - 10s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0521464
{'0': {'precision': 0.44739954973861945, 'recall': 0.3869764678702267, 'f1-score': 0.4150001769723569, 'support': 30299}, '1': {'precision': 0.39282108239095315, 'recall': 0.4735128556214818, 'f1-score': 0.42940908651922577, 'support': 32865}, '2': {'precision': 0.4449872321527701, 'recall': 0.4051212938005391, 'f1-score': 0.424119504065184, 'support': 29680}, 'accuracy': 0.42340915945026064, 'macro avg': {'precision': 0.4284026214274476, 'recall': 0.4218702057640826, 'f1-score': 0.42284292251892225, 'support': 92844}, 'weighted avg': {'precision': 0.4273086562470738, 'recall': 0.42340915945026064, 'f1-score': 0.4230158854766539, 'support': 92844}}
[[11725 12266  6308]
 [ 8614 15562  8689]
 [ 5868 11788 12024]]
training model: results/EXC/W1/deepVOL_L2/h300
Epoch 1/50
1290/1290 - 90s - loss: 3.2817 - accuracy300: 0.3881 - val_loss: 3.2787 - val_accuracy300: 0.3612 - 90s/epoch - 70ms/step
Epoch 2/50
1290/1290 - 80s - loss: 3.2485 - accuracy300: 0.3952 - val_loss: 3.2641 - val_accuracy300: 0.3684 - 80s/epoch - 62ms/step
Epoch 3/50
1290/1290 - 82s - loss: 3.2348 - accuracy300: 0.3999 - val_loss: 3.2578 - val_accuracy300: 0.3731 - 82s/epoch - 63ms/step
Epoch 4/50
1290/1290 - 78s - loss: 3.2248 - accuracy300: 0.4062 - val_loss: 3.2505 - val_accuracy300: 0.3772 - 78s/epoch - 61ms/step
Epoch 5/50
1290/1290 - 80s - loss: 3.2172 - accuracy300: 0.4122 - val_loss: 3.2520 - val_accuracy300: 0.3785 - 80s/epoch - 62ms/step
Epoch 6/50
1290/1290 - 80s - loss: 3.2078 - accuracy300: 0.4165 - val_loss: 3.2549 - val_accuracy300: 0.3762 - 80s/epoch - 62ms/step
Epoch 7/50
1290/1290 - 58s - loss: 3.1988 - accuracy300: 0.4205 - val_loss: 3.2571 - val_accuracy300: 0.3756 - 58s/epoch - 45ms/step
Epoch 8/50
1290/1290 - 27s - loss: 3.1908 - accuracy300: 0.4243 - val_loss: 3.2632 - val_accuracy300: 0.3768 - 27s/epoch - 21ms/step
Epoch 9/50
1290/1290 - 27s - loss: 3.1857 - accuracy300: 0.4261 - val_loss: 3.2601 - val_accuracy300: 0.3801 - 27s/epoch - 21ms/step
Epoch 10/50
1290/1290 - 29s - loss: 3.1794 - accuracy300: 0.4284 - val_loss: 3.2639 - val_accuracy300: 0.3799 - 29s/epoch - 23ms/step
Epoch 11/50
1290/1290 - 27s - loss: 3.1757 - accuracy300: 0.4292 - val_loss: 3.2722 - val_accuracy300: 0.3758 - 27s/epoch - 21ms/step
Epoch 12/50
1290/1290 - 27s - loss: 3.1664 - accuracy300: 0.4339 - val_loss: 3.2676 - val_accuracy300: 0.3787 - 27s/epoch - 21ms/step
Epoch 13/50
1290/1290 - 28s - loss: 3.1633 - accuracy300: 0.4357 - val_loss: 3.2701 - val_accuracy300: 0.3787 - 28s/epoch - 21ms/step
Epoch 14/50
1290/1290 - 27s - loss: 3.1574 - accuracy300: 0.4382 - val_loss: 3.2697 - val_accuracy300: 0.3812 - 27s/epoch - 21ms/step
testing model: results/EXC/W1/deepVOL_L2/h300
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0882194
{'0': {'precision': 0.3837735394880262, 'recall': 0.5080769679614352, 'f1-score': 0.43726273562266, 'support': 445588}, '1': {'precision': 0.35689346567795627, 'recall': 0.16298825242945195, 'f1-score': 0.22377952618184893, 'support': 470991}, '2': {'precision': 0.3727275796446575, 'recall': 0.4648921788080938, 'f1-score': 0.41373937244018927, 'support': 451210}, 'accuracy': 0.37500155360220033, 'macro avg': {'precision': 0.3711315282702133, 'recall': 0.37865246639966027, 'f1-score': 0.3582605447482327, 'support': 1367789}, 'weighted avg': {'precision': 0.3708736547946963, 'recall': 0.37500155360220033, 'f1-score': 0.35599095539976033, 'support': 1367789}}
[[226393  67668 151527]
 [192735  76766 201490]
 [170785  70661 209764]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0829383
{'0': {'precision': 0.3900573005768216, 'recall': 0.5639245685493881, 'f1-score': 0.46114690866985963, 'support': 108761}, '1': {'precision': 0.3344434050514499, 'recall': 0.1639819469416211, 'f1-score': 0.2200637687582327, 'support': 109012}, '2': {'precision': 0.4082988802035385, 'recall': 0.4340237002241913, 'f1-score': 0.4207684678080124, 'support': 112404}, 'accuracy': 0.3876557119363251, 'macro avg': {'precision': 0.3775998619439367, 'recall': 0.38731007190506683, 'f1-score': 0.36732638174536825, 'support': 330177}, 'weighted avg': {'precision': 0.37790577135870423, 'recall': 0.3876557119363251, 'f1-score': 0.3678040849278021, 'support': 330177}}
[[61333 16902 30526]
 [50962 17876 40174]
 [44946 18672 48786]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0828098
{'0': {'precision': 0.3782450164843562, 'recall': 0.5728267698310353, 'f1-score': 0.45563095050234076, 'support': 30243}, '1': {'precision': 0.36057418988061396, 'recall': 0.15259691437851494, 'f1-score': 0.21444118082116517, 'support': 33251}, '2': {'precision': 0.3862181917442601, 'recall': 0.4338671209540034, 'f1-score': 0.40865839765087214, 'support': 29350}, 'accuracy': 0.3783981732799104, 'macro avg': {'precision': 0.3750124660364101, 'recall': 0.3864302683878513, 'f1-score': 0.35957684299145937, 'support': 92844}, 'weighted avg': {'precision': 0.37443690867423535, 'recall': 0.3783981732799104, 'f1-score': 0.3544025947888927, 'support': 92844}}
[[17324  4412  8507]
 [16447  5074 11730]
 [12030  4586 12734]]
training model: results/EXC/W1/deepVOL_L2/h500
Epoch 1/50
1290/1290 - 30s - loss: 3.2920 - accuracy500: 0.3740 - val_loss: 3.2826 - val_accuracy500: 0.3612 - 30s/epoch - 23ms/step
Epoch 2/50
1290/1290 - 29s - loss: 3.2558 - accuracy500: 0.3934 - val_loss: 3.2697 - val_accuracy500: 0.3791 - 29s/epoch - 22ms/step
Epoch 3/50
1290/1290 - 28s - loss: 3.2435 - accuracy500: 0.4020 - val_loss: 3.2692 - val_accuracy500: 0.3816 - 28s/epoch - 22ms/step
Epoch 4/50
1290/1290 - 28s - loss: 3.2370 - accuracy500: 0.4046 - val_loss: 3.2664 - val_accuracy500: 0.3840 - 28s/epoch - 21ms/step
Epoch 5/50
1290/1290 - 28s - loss: 3.2276 - accuracy500: 0.4093 - val_loss: 3.2702 - val_accuracy500: 0.3799 - 28s/epoch - 21ms/step
Epoch 6/50
1290/1290 - 27s - loss: 3.2203 - accuracy500: 0.4136 - val_loss: 3.2703 - val_accuracy500: 0.3782 - 27s/epoch - 21ms/step
Epoch 7/50
1290/1290 - 29s - loss: 3.2115 - accuracy500: 0.4176 - val_loss: 3.2730 - val_accuracy500: 0.3797 - 29s/epoch - 22ms/step
Epoch 8/50
1290/1290 - 27s - loss: 3.2040 - accuracy500: 0.4215 - val_loss: 3.2753 - val_accuracy500: 0.3785 - 27s/epoch - 21ms/step
Epoch 9/50
1290/1290 - 27s - loss: 3.1965 - accuracy500: 0.4247 - val_loss: 3.2717 - val_accuracy500: 0.3817 - 27s/epoch - 21ms/step
Epoch 10/50
1290/1290 - 27s - loss: 3.1899 - accuracy500: 0.4277 - val_loss: 3.2720 - val_accuracy500: 0.3828 - 27s/epoch - 21ms/step
Epoch 11/50
1290/1290 - 27s - loss: 3.1836 - accuracy500: 0.4307 - val_loss: 3.2732 - val_accuracy500: 0.3819 - 27s/epoch - 21ms/step
Epoch 12/50
1290/1290 - 27s - loss: 3.1772 - accuracy500: 0.4340 - val_loss: 3.2761 - val_accuracy500: 0.3825 - 27s/epoch - 21ms/step
Epoch 13/50
1290/1290 - 27s - loss: 3.1699 - accuracy500: 0.4363 - val_loss: 3.2788 - val_accuracy500: 0.3801 - 27s/epoch - 21ms/step
Epoch 14/50
1290/1290 - 27s - loss: 3.1610 - accuracy500: 0.4407 - val_loss: 3.2916 - val_accuracy500: 0.3782 - 27s/epoch - 21ms/step
testing model: results/EXC/W1/deepVOL_L2/h500
Evaluating performance on  test set...
5343/5343 - 56s - 56s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947467
{'0': {'precision': 0.3848681811102634, 'recall': 0.42207491773577727, 'f1-score': 0.4026137806086516, 'support': 462534}, '1': {'precision': 0.37564468295438497, 'recall': 0.3033434678186376, 'f1-score': 0.3356446225616319, 'support': 438437}, '2': {'precision': 0.37807261742581294, 'recall': 0.41020269141292753, 'f1-score': 0.3934828440740239, 'support': 466818}, 'accuracy': 0.37996430736027265, 'macro avg': {'precision': 0.37952849383015375, 'recall': 0.3785403589891141, 'f1-score': 0.3772470824147691, 'support': 1367789}, 'weighted avg': {'precision': 0.3795923569085651, 'recall': 0.37996430736027265, 'f1-score': 0.37803086447328055, 'support': 1367789}}
[[195224 109662 157648]
 [148088 132997 157352]
 [163937 111391 191490]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0872003
{'0': {'precision': 0.38140428379224256, 'recall': 0.4877310491402074, 'f1-score': 0.4280638571047893, 'support': 108689}, '1': {'precision': 0.3744365433289141, 'recall': 0.28816436323161115, 'f1-score': 0.3256840339658245, 'support': 107810}, '2': {'precision': 0.39839028627400247, 'recall': 0.3792554408064885, 'f1-score': 0.38858744637127296, 'support': 113678}, 'accuracy': 0.3852206543762891, 'macro avg': {'precision': 0.384743704465053, 'recall': 0.385050284392769, 'f1-score': 0.38077844581396225, 'support': 330177}, 'weighted avg': {'precision': 0.38497734518286053, 'recall': 0.3852206543762891, 'f1-score': 0.3810431132250628, 'support': 330177}}
[[53011 24588 31090]
 [42728 31067 34015]
 [43250 27315 43113]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0885615
{'0': {'precision': 0.3769553038002925, 'recall': 0.4957616066770996, 'f1-score': 0.4282716762191773, 'support': 30672}, '1': {'precision': 0.3889244421690345, 'recall': 0.28730814081754863, 'f1-score': 0.3304814385150812, 'support': 31729}, '2': {'precision': 0.38622445468932776, 'recall': 0.3687547219393621, 'f1-score': 0.37728746912231764, 'support': 30443}, 'accuracy': 0.3828788074619792, 'macro avg': {'precision': 0.38403473355288487, 'recall': 0.38394148981133674, 'f1-score': 0.3786801946188587, 'support': 92844}, 'weighted avg': {'precision': 0.3840850004076846, 'recall': 0.3828788074619792, 'f1-score': 0.37813490196598953, 'support': 92844}}
[[15206  7006  8460]
 [13233  9116  9380]
 [11900  7317 11226]]
training model: results/EXC/W1/deepVOL_L2/h1000
Epoch 1/50
1290/1290 - 30s - loss: 3.2299 - accuracy1000: 0.4203 - val_loss: 3.4642 - val_accuracy1000: 0.3191 - 30s/epoch - 23ms/step
Epoch 2/50
1290/1290 - 28s - loss: 3.2364 - accuracy1000: 0.4082 - val_loss: 3.4973 - val_accuracy1000: 0.3224 - 28s/epoch - 22ms/step
Epoch 3/50
1290/1290 - 27s - loss: 3.2428 - accuracy1000: 0.4088 - val_loss: 3.4262 - val_accuracy1000: 0.3247 - 27s/epoch - 21ms/step
Epoch 4/50
1290/1290 - 27s - loss: 3.2434 - accuracy1000: 0.4073 - val_loss: 3.3525 - val_accuracy1000: 0.3313 - 27s/epoch - 21ms/step
Epoch 5/50
1290/1290 - 27s - loss: 3.2436 - accuracy1000: 0.4055 - val_loss: 3.3363 - val_accuracy1000: 0.3279 - 27s/epoch - 21ms/step
Epoch 6/50
1290/1290 - 27s - loss: 3.2471 - accuracy1000: 0.4013 - val_loss: 3.3340 - val_accuracy1000: 0.3365 - 27s/epoch - 21ms/step
Epoch 7/50
1290/1290 - 27s - loss: 3.2312 - accuracy1000: 0.4135 - val_loss: 3.3821 - val_accuracy1000: 0.3322 - 27s/epoch - 21ms/step
Epoch 8/50
1290/1290 - 27s - loss: 3.2231 - accuracy1000: 0.4172 - val_loss: 3.3624 - val_accuracy1000: 0.3346 - 27s/epoch - 21ms/step
Epoch 9/50
1290/1290 - 27s - loss: 3.2306 - accuracy1000: 0.4133 - val_loss: 3.3470 - val_accuracy1000: 0.3330 - 27s/epoch - 21ms/step
Epoch 10/50
1290/1290 - 27s - loss: 3.2161 - accuracy1000: 0.4203 - val_loss: 3.3673 - val_accuracy1000: 0.3314 - 27s/epoch - 21ms/step
Epoch 11/50
1290/1290 - 27s - loss: 3.2006 - accuracy1000: 0.4229 - val_loss: 3.3802 - val_accuracy1000: 0.3358 - 27s/epoch - 21ms/step
Epoch 12/50
1290/1290 - 27s - loss: 3.2109 - accuracy1000: 0.4212 - val_loss: 3.3884 - val_accuracy1000: 0.3342 - 27s/epoch - 21ms/step
Epoch 13/50
1290/1290 - 27s - loss: 3.1920 - accuracy1000: 0.4283 - val_loss: 3.3757 - val_accuracy1000: 0.3345 - 27s/epoch - 21ms/step
Epoch 14/50
1290/1290 - 27s - loss: 3.1829 - accuracy1000: 0.4333 - val_loss: 3.4145 - val_accuracy1000: 0.3304 - 27s/epoch - 21ms/step
Epoch 15/50
1290/1290 - 27s - loss: 3.1733 - accuracy1000: 0.4408 - val_loss: 3.4365 - val_accuracy1000: 0.3261 - 27s/epoch - 21ms/step
Epoch 16/50
1290/1290 - 27s - loss: 3.1639 - accuracy1000: 0.4478 - val_loss: 3.4567 - val_accuracy1000: 0.3305 - 27s/epoch - 21ms/step
testing model: results/EXC/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
5343/5343 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1262522
{'0': {'precision': 0.27416204641488445, 'recall': 0.5607545921655176, 'f1-score': 0.3682706019274938, 'support': 350706}, '1': {'precision': 0.4474789915966387, 'recall': 0.00031996779291323913, 'f1-score': 0.0006394783297906834, 'support': 665692}, '2': {'precision': 0.2696815384615385, 'recall': 0.49885455233628634, 'f1-score': 0.350099012273927, 'support': 351391}, 'accuracy': 0.27209313717247324, 'macro avg': {'precision': 0.33044085882435387, 'recall': 0.3533097040982391, 'f1-score': 0.2396696975104038, 'support': 1367789}, 'weighted avg': {'precision': 0.35736295949555563, 'recall': 0.27209313717247324, 'f1-score': 0.18467910426962503, 'support': 1367789}}
[[196660    119 153927]
 [344699    213 320780]
 [175954    144 175293]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995156
{'0': {'precision': 0.34426340051983717, 'recall': 0.5287195081766572, 'f1-score': 0.41700421392637693, 'support': 106217}, '1': {'precision': 0.31446540880503143, 'recall': 0.0004566585381446877, 'f1-score': 0.0009119927040583675, 'support': 109491}, '2': {'precision': 0.3779435556354485, 'recall': 0.5510225475893037, 'f1-score': 0.4483595690914454, 'support': 114469}, 'accuracy': 0.3612728930240447, 'macro avg': {'precision': 0.34555745498677237, 'recall': 0.36006623810136856, 'f1-score': 0.2887585919072935, 'support': 330177}, 'weighted avg': {'precision': 0.34605856422016495, 'recall': 0.3612728930240447, 'f1-score': 0.2898931878904548, 'support': 330177}}
[[56159    47 50011]
 [55637    50 53804]
 [51332    62 63075]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110068
{'0': {'precision': 0.3237704918032787, 'recall': 0.5613079019073569, 'f1-score': 0.4106640422927943, 'support': 28993}, '1': {'precision': 0.3404255319148936, 'recall': 0.00045480386583285955, 'f1-score': 0.0009083941295029381, 'support': 35180}, '2': {'precision': 0.3505748477652646, 'recall': 0.5200725471731017, 'f1-score': 0.41882478512443116, 'support': 28671}, 'accuracy': 0.33605833441040883, 'macro avg': {'precision': 0.3382569571611456, 'recall': 0.36061175098209713, 'f1-score': 0.27679907384890945, 'support': 92844}, 'weighted avg': {'precision': 0.3383587473815897, 'recall': 0.33605833441040883, 'f1-score': 0.25792151671592634, 'support': 92844}}
[[16274    16 12703]
 [20245    16 14919]
 [13745    15 14911]]
training model: results/EXC/W1/deepVOL_L3/h10
Epoch 1/50
1290/1290 - 47s - loss: 2.6086 - accuracy10: 0.5092 - val_loss: 2.3210 - val_accuracy10: 0.7158 - 47s/epoch - 36ms/step
Epoch 2/50
1290/1290 - 43s - loss: 2.1441 - accuracy10: 0.6547 - val_loss: 2.2241 - val_accuracy10: 0.7025 - 43s/epoch - 33ms/step
Epoch 3/50
1290/1290 - 43s - loss: 2.0371 - accuracy10: 0.6734 - val_loss: 2.1532 - val_accuracy10: 0.7191 - 43s/epoch - 34ms/step
Epoch 4/50
1290/1290 - 43s - loss: 1.9882 - accuracy10: 0.6815 - val_loss: 2.0867 - val_accuracy10: 0.7097 - 43s/epoch - 33ms/step
Epoch 5/50
1290/1290 - 42s - loss: 1.9610 - accuracy10: 0.6844 - val_loss: 2.0882 - val_accuracy10: 0.7063 - 42s/epoch - 33ms/step
Epoch 6/50
1290/1290 - 43s - loss: 1.9419 - accuracy10: 0.6855 - val_loss: 2.0930 - val_accuracy10: 0.7193 - 43s/epoch - 33ms/step
Epoch 7/50
1290/1290 - 43s - loss: 1.9224 - accuracy10: 0.6877 - val_loss: 2.0714 - val_accuracy10: 0.7138 - 43s/epoch - 33ms/step
Epoch 8/50
1290/1290 - 44s - loss: 1.9057 - accuracy10: 0.6872 - val_loss: 2.0868 - val_accuracy10: 0.7221 - 44s/epoch - 34ms/step
Epoch 9/50
1290/1290 - 43s - loss: 1.8952 - accuracy10: 0.6877 - val_loss: 2.0781 - val_accuracy10: 0.6890 - 43s/epoch - 33ms/step
Epoch 10/50
1290/1290 - 43s - loss: 1.8800 - accuracy10: 0.6897 - val_loss: 2.1228 - val_accuracy10: 0.7114 - 43s/epoch - 34ms/step
Epoch 11/50
1290/1290 - 43s - loss: 1.8736 - accuracy10: 0.6895 - val_loss: 2.0584 - val_accuracy10: 0.7302 - 43s/epoch - 34ms/step
Epoch 12/50
1290/1290 - 44s - loss: 1.8646 - accuracy10: 0.6893 - val_loss: 2.0307 - val_accuracy10: 0.7146 - 44s/epoch - 34ms/step
Epoch 13/50
1290/1290 - 43s - loss: 1.8550 - accuracy10: 0.6900 - val_loss: 2.0563 - val_accuracy10: 0.7016 - 43s/epoch - 33ms/step
Epoch 14/50
1290/1290 - 43s - loss: 1.8490 - accuracy10: 0.6902 - val_loss: 2.1516 - val_accuracy10: 0.7015 - 43s/epoch - 33ms/step
Epoch 15/50
1290/1290 - 43s - loss: 1.8440 - accuracy10: 0.6895 - val_loss: 2.0498 - val_accuracy10: 0.7164 - 43s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 43s - loss: 1.8367 - accuracy10: 0.6899 - val_loss: 2.0721 - val_accuracy10: 0.7161 - 43s/epoch - 34ms/step
Epoch 17/50
1290/1290 - 43s - loss: 1.8321 - accuracy10: 0.6902 - val_loss: 2.0449 - val_accuracy10: 0.7167 - 43s/epoch - 33ms/step
Epoch 18/50
1290/1290 - 43s - loss: 1.8279 - accuracy10: 0.6905 - val_loss: 2.0905 - val_accuracy10: 0.7028 - 43s/epoch - 33ms/step
Epoch 19/50
1290/1290 - 42s - loss: 1.8203 - accuracy10: 0.6907 - val_loss: 2.0814 - val_accuracy10: 0.7052 - 42s/epoch - 33ms/step
Epoch 20/50
1290/1290 - 42s - loss: 1.8140 - accuracy10: 0.6908 - val_loss: 2.0945 - val_accuracy10: 0.7208 - 42s/epoch - 33ms/step
Epoch 21/50
1290/1290 - 42s - loss: 1.8114 - accuracy10: 0.6903 - val_loss: 2.0777 - val_accuracy10: 0.7138 - 42s/epoch - 33ms/step
Epoch 22/50
1290/1290 - 43s - loss: 1.8054 - accuracy10: 0.6911 - val_loss: 2.1587 - val_accuracy10: 0.7138 - 43s/epoch - 34ms/step
testing model: results/EXC/W1/deepVOL_L3/h10
Evaluating performance on  test set...
5343/5343 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.618603
{'0': {'precision': 0.45927535473061415, 'recall': 0.5664899285082309, 'f1-score': 0.5072795250886988, 'support': 154843}, '1': {'precision': 0.9299849673606392, 'recall': 0.7270257396564573, 'f1-score': 0.8160756063935066, 'support': 1055997}, '2': {'precision': 0.36224242872841356, 'recall': 0.8107219542653983, 'f1-score': 0.500744769396963, 'support': 156949}, 'accuracy': 0.7184558437010387, 'macro avg': {'precision': 0.5838342502732223, 'recall': 0.7014125408100288, 'f1-score': 0.6080333002930561, 'support': 1367789}, 'weighted avg': {'precision': 0.8115509748045796, 'recall': 0.7184558437010387, 'f1-score': 0.7449346839608427, 'support': 1367789}}
[[ 87717  36710  30416]
 [ 94656 767737 193604]
 [  8617  21090 127242]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6075633
{'0': {'precision': 0.41419669341672605, 'recall': 0.5663218788317037, 'f1-score': 0.4784583510412239, 'support': 31807}, '1': {'precision': 0.9440613401054894, 'recall': 0.7279156201400055, 'f1-score': 0.8220173030759843, 'support': 265561}, '2': {'precision': 0.32461429547895715, 'recall': 0.8106007497942638, 'f1-score': 0.463581930850554, 'support': 32809}, 'accuracy': 0.7205650302716422, 'macro avg': {'precision': 0.5609574430003909, 'recall': 0.7016127495886577, 'f1-score': 0.588019194989254, 'support': 330177}, 'weighted avg': {'precision': 0.831464633174415, 'recall': 0.7205650302716422, 'f1-score': 0.753304201573718, 'support': 330177}}
[[ 18013   7223   6571]
 [ 23493 193306  48762]
 [  1983   4231  26595]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6205128
{'0': {'precision': 0.3952311584758108, 'recall': 0.5679189159413903, 'f1-score': 0.46609403254972875, 'support': 9077}, '1': {'precision': 0.9446446691626719, 'recall': 0.7218738719467358, 'f1-score': 0.8183698988291462, 'support': 74797}, '2': {'precision': 0.3177582475820342, 'recall': 0.8021181716833891, 'f1-score': 0.45519248410464047, 'support': 8970}, 'accuracy': 0.7145749859980182, 'macro avg': {'precision': 0.5525446917401723, 'recall': 0.697303653190505, 'f1-score': 0.5798854718278385, 'support': 92844}, 'weighted avg': {'precision': 0.8303648272980068, 'recall': 0.7145749859980182, 'f1-score': 0.7488413407284926, 'support': 92844}}
[[ 5155  1940  1982]
 [ 7337 53994 13466]
 [  551  1224  7195]]
training model: results/EXC/W1/deepVOL_L3/h20
Epoch 1/50
1290/1290 - 46s - loss: 2.7695 - accuracy20: 0.4774 - val_loss: 2.5238 - val_accuracy20: 0.6299 - 46s/epoch - 36ms/step
Epoch 2/50
1290/1290 - 43s - loss: 2.2868 - accuracy20: 0.6354 - val_loss: 2.3384 - val_accuracy20: 0.6447 - 43s/epoch - 33ms/step
Epoch 3/50
1290/1290 - 44s - loss: 2.1547 - accuracy20: 0.6541 - val_loss: 2.2565 - val_accuracy20: 0.6722 - 44s/epoch - 34ms/step
Epoch 4/50
1290/1290 - 42s - loss: 2.1059 - accuracy20: 0.6630 - val_loss: 2.2578 - val_accuracy20: 0.6785 - 42s/epoch - 33ms/step
Epoch 5/50
1290/1290 - 42s - loss: 2.0788 - accuracy20: 0.6656 - val_loss: 2.2578 - val_accuracy20: 0.6927 - 42s/epoch - 33ms/step
Epoch 6/50
1290/1290 - 42s - loss: 2.0576 - accuracy20: 0.6685 - val_loss: 2.2156 - val_accuracy20: 0.6974 - 42s/epoch - 33ms/step
Epoch 7/50
1290/1290 - 43s - loss: 2.0356 - accuracy20: 0.6689 - val_loss: 2.2294 - val_accuracy20: 0.6795 - 43s/epoch - 33ms/step
Epoch 8/50
1290/1290 - 43s - loss: 2.0153 - accuracy20: 0.6703 - val_loss: 2.2189 - val_accuracy20: 0.6849 - 43s/epoch - 33ms/step
Epoch 9/50
1290/1290 - 43s - loss: 1.9950 - accuracy20: 0.6708 - val_loss: 2.1653 - val_accuracy20: 0.7010 - 43s/epoch - 33ms/step
Epoch 10/50
1290/1290 - 43s - loss: 1.9861 - accuracy20: 0.6711 - val_loss: 2.2323 - val_accuracy20: 0.7047 - 43s/epoch - 33ms/step
Epoch 11/50
1290/1290 - 43s - loss: 1.9742 - accuracy20: 0.6717 - val_loss: 2.1856 - val_accuracy20: 0.7082 - 43s/epoch - 33ms/step
Epoch 12/50
1290/1290 - 43s - loss: 1.9661 - accuracy20: 0.6715 - val_loss: 2.1221 - val_accuracy20: 0.6845 - 43s/epoch - 33ms/step
Epoch 13/50
1290/1290 - 42s - loss: 1.9592 - accuracy20: 0.6740 - val_loss: 2.1773 - val_accuracy20: 0.6935 - 42s/epoch - 33ms/step
Epoch 14/50
1290/1290 - 43s - loss: 1.9525 - accuracy20: 0.6738 - val_loss: 2.1655 - val_accuracy20: 0.6905 - 43s/epoch - 33ms/step
Epoch 15/50
1290/1290 - 43s - loss: 1.9423 - accuracy20: 0.6739 - val_loss: 2.1352 - val_accuracy20: 0.6918 - 43s/epoch - 33ms/step
Epoch 16/50
1290/1290 - 43s - loss: 1.9367 - accuracy20: 0.6749 - val_loss: 2.1449 - val_accuracy20: 0.6940 - 43s/epoch - 33ms/step
Epoch 17/50
1290/1290 - 43s - loss: 1.9333 - accuracy20: 0.6746 - val_loss: 2.1561 - val_accuracy20: 0.7038 - 43s/epoch - 33ms/step
Epoch 18/50
1290/1290 - 44s - loss: 1.9268 - accuracy20: 0.6756 - val_loss: 2.1757 - val_accuracy20: 0.6967 - 44s/epoch - 34ms/step
Epoch 19/50
1290/1290 - 44s - loss: 1.9231 - accuracy20: 0.6760 - val_loss: 2.1540 - val_accuracy20: 0.6905 - 44s/epoch - 34ms/step
Epoch 20/50
1290/1290 - 43s - loss: 1.9158 - accuracy20: 0.6769 - val_loss: 2.1488 - val_accuracy20: 0.6821 - 43s/epoch - 33ms/step
Epoch 21/50
1290/1290 - 43s - loss: 1.9172 - accuracy20: 0.6762 - val_loss: 2.2245 - val_accuracy20: 0.6867 - 43s/epoch - 33ms/step
Epoch 22/50
1290/1290 - 43s - loss: 1.9280 - accuracy20: 0.6758 - val_loss: 2.1606 - val_accuracy20: 0.6853 - 43s/epoch - 33ms/step
testing model: results/EXC/W1/deepVOL_L3/h20
Evaluating performance on  test set...
5343/5343 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66537255
{'0': {'precision': 0.5135107880743588, 'recall': 0.6040734201125119, 'f1-score': 0.5551227652366417, 'support': 219177}, '1': {'precision': 0.8687939392164744, 'recall': 0.7040965799630231, 'f1-score': 0.7778225297130342, 'support': 927066}, '2': {'precision': 0.44922428311714385, 'recall': 0.7271988661496935, 'f1-score': 0.5553705561358333, 'support': 221546}, 'accuracy': 0.6918106520815711, 'macro avg': {'precision': 0.6105096701359923, 'recall': 0.6784562887417428, 'f1-score': 0.629438617028503, 'support': 1367789}, 'weighted avg': {'precision': 0.7439034230271662, 'recall': 0.6918106520815711, 'f1-score': 0.7061053195170341, 'support': 1367789}}
[[132399  56060  30718]
 [107512 652744 166810]
 [ 17920  42518 161108]]
Evaluating performance on  train set...
1290/1290 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6555796
{'0': {'precision': 0.4506447453255964, 'recall': 0.6239093079824151, 'f1-score': 0.523308158089302, 'support': 44811}, '1': {'precision': 0.9016708719712432, 'recall': 0.7037097428307433, 'f1-score': 0.7904849125278853, 'support': 239181}, '2': {'precision': 0.4141380664800903, 'recall': 0.7305185666341886, 'f1-score': 0.5286048898184923, 'support': 46185}, 'accuracy': 0.6966293836336268, 'macro avg': {'precision': 0.58881789459231, 'recall': 0.686045872482449, 'f1-score': 0.6141326534785598, 'support': 330177}, 'weighted avg': {'precision': 0.7722626019138892, 'recall': 0.6966293836336268, 'f1-score': 0.7175925354332341, 'support': 330177}}
[[ 27958  10182   6671]
 [ 29809 168314  41058]
 [  4273   8173  33739]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6741627
{'0': {'precision': 0.42094976493581954, 'recall': 0.6260507502553225, 'f1-score': 0.5034112444725205, 'support': 12729}, '1': {'precision': 0.9018105849582173, 'recall': 0.6903905104624817, 'f1-score': 0.7820638635162678, 'support': 67527}, '2': {'precision': 0.40405995408921097, 'recall': 0.7131394979345408, 'f1-score': 0.515845424507973, 'support': 12588}, 'accuracy': 0.6846538279264142, 'macro avg': {'precision': 0.5756067679944159, 'recall': 0.6765269195507817, 'f1-score': 0.6004401774989204, 'support': 92844}, 'weighted avg': {'precision': 0.7683979538841128, 'recall': 0.6846538279264142, 'f1-score': 0.7077658270460137, 'support': 92844}}
[[ 7969  2708  2052]
 [ 9719 46620 11188]
 [ 1243  2368  8977]]
training model: results/EXC/W1/deepVOL_L3/h30
Epoch 1/50
1290/1290 - 49s - loss: 2.7795 - accuracy30: 0.5115 - val_loss: 2.5755 - val_accuracy30: 0.6257 - 49s/epoch - 38ms/step
Epoch 2/50
1290/1290 - 48s - loss: 2.3869 - accuracy30: 0.6255 - val_loss: 2.5014 - val_accuracy30: 0.6449 - 48s/epoch - 37ms/step
Epoch 3/50
1290/1290 - 43s - loss: 2.2870 - accuracy30: 0.6362 - val_loss: 2.4773 - val_accuracy30: 0.6375 - 43s/epoch - 34ms/step
Epoch 4/50
1290/1290 - 49s - loss: 2.2434 - accuracy30: 0.6413 - val_loss: 2.4632 - val_accuracy30: 0.6336 - 49s/epoch - 38ms/step
Epoch 5/50
1290/1290 - 60s - loss: 2.2162 - accuracy30: 0.6454 - val_loss: 2.4030 - val_accuracy30: 0.6450 - 60s/epoch - 46ms/step
Epoch 6/50
1290/1290 - 59s - loss: 2.1953 - accuracy30: 0.6472 - val_loss: 2.4308 - val_accuracy30: 0.6437 - 59s/epoch - 46ms/step
Epoch 7/50
1290/1290 - 62s - loss: 2.1820 - accuracy30: 0.6483 - val_loss: 2.4121 - val_accuracy30: 0.6360 - 62s/epoch - 48ms/step
Epoch 8/50
1290/1290 - 61s - loss: 2.1651 - accuracy30: 0.6484 - val_loss: 2.4057 - val_accuracy30: 0.6481 - 61s/epoch - 47ms/step
Epoch 9/50
1290/1290 - 63s - loss: 2.1487 - accuracy30: 0.6510 - val_loss: 2.4137 - val_accuracy30: 0.6465 - 63s/epoch - 49ms/step
Epoch 10/50
1290/1290 - 62s - loss: 2.1343 - accuracy30: 0.6520 - val_loss: 2.4321 - val_accuracy30: 0.6527 - 62s/epoch - 48ms/step
Epoch 11/50
1290/1290 - 63s - loss: 2.1241 - accuracy30: 0.6511 - val_loss: 2.4395 - val_accuracy30: 0.6480 - 63s/epoch - 49ms/step
Epoch 12/50
1290/1290 - 62s - loss: 2.1134 - accuracy30: 0.6525 - val_loss: 2.3887 - val_accuracy30: 0.6717 - 62s/epoch - 48ms/step
Epoch 13/50
1290/1290 - 59s - loss: 2.1022 - accuracy30: 0.6539 - val_loss: 2.4043 - val_accuracy30: 0.6555 - 59s/epoch - 46ms/step
Epoch 14/50
1290/1290 - 60s - loss: 2.0925 - accuracy30: 0.6543 - val_loss: 2.3916 - val_accuracy30: 0.6581 - 60s/epoch - 46ms/step
Epoch 15/50
1290/1290 - 59s - loss: 2.0863 - accuracy30: 0.6551 - val_loss: 2.4057 - val_accuracy30: 0.6487 - 59s/epoch - 46ms/step
Epoch 16/50
1290/1290 - 61s - loss: 2.0802 - accuracy30: 0.6559 - val_loss: 2.3936 - val_accuracy30: 0.6599 - 61s/epoch - 47ms/step
Epoch 17/50
1290/1290 - 62s - loss: 2.0749 - accuracy30: 0.6559 - val_loss: 2.3805 - val_accuracy30: 0.6661 - 62s/epoch - 48ms/step
Epoch 18/50
1290/1290 - 61s - loss: 2.0703 - accuracy30: 0.6559 - val_loss: 2.4498 - val_accuracy30: 0.6563 - 61s/epoch - 47ms/step
Epoch 19/50
1290/1290 - 61s - loss: 2.0657 - accuracy30: 0.6555 - val_loss: 2.3801 - val_accuracy30: 0.6634 - 61s/epoch - 48ms/step
Epoch 20/50
1290/1290 - 63s - loss: 2.0587 - accuracy30: 0.6571 - val_loss: 2.3820 - val_accuracy30: 0.6580 - 63s/epoch - 49ms/step
Epoch 21/50
1290/1290 - 66s - loss: 2.0538 - accuracy30: 0.6571 - val_loss: 2.3930 - val_accuracy30: 0.6637 - 66s/epoch - 51ms/step
Epoch 22/50
1290/1290 - 67s - loss: 2.0468 - accuracy30: 0.6584 - val_loss: 2.3514 - val_accuracy30: 0.6563 - 67s/epoch - 52ms/step
Epoch 23/50
1290/1290 - 65s - loss: 2.0451 - accuracy30: 0.6583 - val_loss: 2.3828 - val_accuracy30: 0.6712 - 65s/epoch - 51ms/step
Epoch 24/50
1290/1290 - 65s - loss: 2.0394 - accuracy30: 0.6587 - val_loss: 2.3751 - val_accuracy30: 0.6603 - 65s/epoch - 51ms/step
Epoch 25/50
1290/1290 - 66s - loss: 2.0352 - accuracy30: 0.6594 - val_loss: 2.4047 - val_accuracy30: 0.6575 - 66s/epoch - 51ms/step
Epoch 26/50
1290/1290 - 66s - loss: 2.0281 - accuracy30: 0.6602 - val_loss: 2.4015 - val_accuracy30: 0.6562 - 66s/epoch - 51ms/step
Epoch 27/50
1290/1290 - 68s - loss: 2.0262 - accuracy30: 0.6593 - val_loss: 2.4150 - val_accuracy30: 0.6539 - 68s/epoch - 53ms/step
Epoch 28/50
1290/1290 - 67s - loss: 2.0224 - accuracy30: 0.6605 - val_loss: 2.4102 - val_accuracy30: 0.6553 - 67s/epoch - 52ms/step
Epoch 29/50
1290/1290 - 65s - loss: 2.0163 - accuracy30: 0.6608 - val_loss: 2.4098 - val_accuracy30: 0.6595 - 65s/epoch - 50ms/step
Epoch 30/50
1290/1290 - 66s - loss: 2.0117 - accuracy30: 0.6605 - val_loss: 2.4409 - val_accuracy30: 0.6546 - 66s/epoch - 51ms/step
Epoch 31/50
1290/1290 - 67s - loss: 2.0075 - accuracy30: 0.6612 - val_loss: 2.4427 - val_accuracy30: 0.6538 - 67s/epoch - 52ms/step
Epoch 32/50
1290/1290 - 68s - loss: 2.0065 - accuracy30: 0.6612 - val_loss: 2.4617 - val_accuracy30: 0.6461 - 68s/epoch - 53ms/step
testing model: results/EXC/W1/deepVOL_L3/h30
Evaluating performance on  test set...
5343/5343 - 118s - 118s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73156273
{'0': {'precision': 0.5896471479597359, 'recall': 0.48729817970392236, 'f1-score': 0.5336092269265618, 'support': 268308}, '1': {'precision': 0.7879011941853385, 'recall': 0.6916035323070984, 'f1-score': 0.7366184632602413, 'support': 828920}, '2': {'precision': 0.4672333693397444, 'recall': 0.72261338478199, 'f1-score': 0.5675169265825357, 'support': 270561}, 'accuracy': 0.657660647950817, 'macro avg': {'precision': 0.6149272371616062, 'recall': 0.6338383655976703, 'f1-score': 0.612581538923113, 'support': 1367789}, 'weighted avg': {'precision': 0.6855803289109813, 'recall': 0.657660647950817, 'f1-score': 0.6633459899129095, 'support': 1367789}}
[[130746  93410  44152]
 [ 76855 573284 178781]
 [ 14135  60915 195511]]
Evaluating performance on  train set...
1290/1290 - 31s - 31s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70077467
{'0': {'precision': 0.52902018291977, 'recall': 0.5013440122881123, 'f1-score': 0.5148103987306714, 'support': 54687}, '1': {'precision': 0.8383711074663995, 'recall': 0.6945833922309821, 'f1-score': 0.7597337662499595, 'support': 219307}, '2': {'precision': 0.4295498515368778, 'recall': 0.7389957816421338, 'f1-score': 0.5433001831981156, 'support': 56183}, 'accuracy': 0.6701345036147278, 'macro avg': {'precision': 0.5989803806410158, 'recall': 0.644974395387076, 'f1-score': 0.6059481160595821, 'support': 330177}, 'weighted avg': {'precision': 0.7175683906430902, 'recall': 0.6701345036147278, 'f1-score': 0.6823388774596166, 'support': 330177}}
[[ 27417  17766   9504]
 [ 21346 152327  45634]
 [  3063  11601  41519]]
Evaluating performance on  val set...
363/363 - 10s - 10s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7210193
{'0': {'precision': 0.48248713656933856, 'recall': 0.5025180785123967, 'f1-score': 0.4922989341851419, 'support': 15488}, '1': {'precision': 0.8368388769069431, 'recall': 0.6815186038641894, 'f1-score': 0.7512345021137518, 'support': 62057}, '2': {'precision': 0.4159089172461221, 'recall': 0.7115497744950651, 'f1-score': 0.5249680515033878, 'support': 15299}, 'accuracy': 0.6566067812675025, 'macro avg': {'precision': 0.5784116435741345, 'recall': 0.6318621522905504, 'f1-score': 0.5895004959340938, 'support': 92844}, 'weighted avg': {'precision': 0.7083652307133311, 'recall': 0.6566067812675025, 'f1-score': 0.6707549395791101, 'support': 92844}}
[[ 7783  4734  2971]
 [ 7447 42293 12317]
 [  901  3512 10886]]
training model: results/EXC/W1/deepVOL_L3/h50
Epoch 1/50
1290/1290 - 74s - loss: 2.9853 - accuracy50: 0.4645 - val_loss: 2.9110 - val_accuracy50: 0.5592 - 74s/epoch - 57ms/step
Epoch 2/50
1290/1290 - 66s - loss: 2.6682 - accuracy50: 0.5745 - val_loss: 2.7511 - val_accuracy50: 0.5804 - 66s/epoch - 51ms/step
Epoch 3/50
1290/1290 - 64s - loss: 2.5600 - accuracy50: 0.5954 - val_loss: 2.7369 - val_accuracy50: 0.5864 - 64s/epoch - 50ms/step
Epoch 4/50
1290/1290 - 66s - loss: 2.5030 - accuracy50: 0.6033 - val_loss: 2.7275 - val_accuracy50: 0.6012 - 66s/epoch - 51ms/step
Epoch 5/50
1290/1290 - 67s - loss: 2.4698 - accuracy50: 0.6067 - val_loss: 2.7095 - val_accuracy50: 0.5978 - 67s/epoch - 52ms/step
Epoch 6/50
1290/1290 - 67s - loss: 2.4468 - accuracy50: 0.6098 - val_loss: 2.6923 - val_accuracy50: 0.5923 - 67s/epoch - 52ms/step
Epoch 7/50
1290/1290 - 67s - loss: 2.4276 - accuracy50: 0.6126 - val_loss: 2.6976 - val_accuracy50: 0.5912 - 67s/epoch - 52ms/step
Epoch 8/50
1290/1290 - 68s - loss: 2.4045 - accuracy50: 0.6138 - val_loss: 2.6781 - val_accuracy50: 0.5990 - 68s/epoch - 52ms/step
Epoch 9/50
1290/1290 - 68s - loss: 2.3859 - accuracy50: 0.6148 - val_loss: 2.6622 - val_accuracy50: 0.6017 - 68s/epoch - 53ms/step
Epoch 10/50
1290/1290 - 70s - loss: 2.3717 - accuracy50: 0.6160 - val_loss: 2.6448 - val_accuracy50: 0.6086 - 70s/epoch - 54ms/step
Epoch 11/50
1290/1290 - 70s - loss: 2.3617 - accuracy50: 0.6170 - val_loss: 2.6153 - val_accuracy50: 0.6098 - 70s/epoch - 54ms/step
Epoch 12/50
1290/1290 - 73s - loss: 2.3532 - accuracy50: 0.6165 - val_loss: 2.6419 - val_accuracy50: 0.6115 - 73s/epoch - 57ms/step
Epoch 13/50
1290/1290 - 70s - loss: 2.3447 - accuracy50: 0.6179 - val_loss: 2.6420 - val_accuracy50: 0.6016 - 70s/epoch - 54ms/step
Epoch 14/50
1290/1290 - 71s - loss: 2.3379 - accuracy50: 0.6185 - val_loss: 2.6461 - val_accuracy50: 0.6045 - 71s/epoch - 55ms/step
Epoch 15/50
1290/1290 - 70s - loss: 2.3326 - accuracy50: 0.6196 - val_loss: 2.6460 - val_accuracy50: 0.6080 - 70s/epoch - 54ms/step
Epoch 16/50
1290/1290 - 69s - loss: 2.3261 - accuracy50: 0.6209 - val_loss: 2.5947 - val_accuracy50: 0.6044 - 69s/epoch - 54ms/step
Epoch 17/50
1290/1290 - 70s - loss: 2.3211 - accuracy50: 0.6209 - val_loss: 2.6046 - val_accuracy50: 0.6025 - 70s/epoch - 54ms/step
Epoch 18/50
1290/1290 - 70s - loss: 2.3133 - accuracy50: 0.6210 - val_loss: 2.6307 - val_accuracy50: 0.6002 - 70s/epoch - 54ms/step
Epoch 19/50
1290/1290 - 70s - loss: 2.3092 - accuracy50: 0.6224 - val_loss: 2.6351 - val_accuracy50: 0.6023 - 70s/epoch - 54ms/step
Epoch 20/50
1290/1290 - 69s - loss: 2.3041 - accuracy50: 0.6232 - val_loss: 2.6349 - val_accuracy50: 0.5972 - 69s/epoch - 54ms/step
Epoch 21/50
1290/1290 - 70s - loss: 2.3041 - accuracy50: 0.6227 - val_loss: 2.6342 - val_accuracy50: 0.5965 - 70s/epoch - 54ms/step
Epoch 22/50
1290/1290 - 71s - loss: 2.2959 - accuracy50: 0.6239 - val_loss: 2.6437 - val_accuracy50: 0.5963 - 71s/epoch - 55ms/step
Epoch 23/50
1290/1290 - 69s - loss: 2.2911 - accuracy50: 0.6244 - val_loss: 2.6558 - val_accuracy50: 0.5968 - 69s/epoch - 53ms/step
Epoch 24/50
1290/1290 - 72s - loss: 2.2871 - accuracy50: 0.6252 - val_loss: 2.6461 - val_accuracy50: 0.6046 - 72s/epoch - 56ms/step
Epoch 25/50
1290/1290 - 73s - loss: 2.2835 - accuracy50: 0.6255 - val_loss: 2.6652 - val_accuracy50: 0.6043 - 73s/epoch - 57ms/step
Epoch 26/50
1290/1290 - 73s - loss: 2.2797 - accuracy50: 0.6261 - val_loss: 2.6429 - val_accuracy50: 0.5968 - 73s/epoch - 56ms/step
testing model: results/EXC/W1/deepVOL_L3/h50
Evaluating performance on  test set...
5343/5343 - 131s - 131s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84757096
{'0': {'precision': 0.6064822923926046, 'recall': 0.4699064449064449, 'f1-score': 0.5295297656719017, 'support': 346320}, '1': {'precision': 0.6491288269259882, 'recall': 0.6688618449004816, 'f1-score': 0.65884761407927, 'support': 673142}, '2': {'precision': 0.5211689946852678, 'recall': 0.6072397488566778, 'f1-score': 0.5609217958577527, 'support': 348327}, 'accuracy': 0.6027939981970903, 'macro avg': {'precision': 0.5922600380012869, 'recall': 0.5820026795545347, 'f1-score': 0.5830997252029748, 'support': 1367789}, 'weighted avg': {'precision': 0.6057440560844952, 'recall': 0.6027939981970903, 'f1-score': 0.6011665216417037, 'support': 1367789}}
[[162738 134263  49319]
 [ 77887 450239 145016]
 [ 27706 109103 211518]]
Evaluating performance on  train set...
1290/1290 - 32s - 32s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7922775
{'0': {'precision': 0.5489961134921733, 'recall': 0.507195367715932, 'f1-score': 0.5272685694052037, 'support': 70462}, '1': {'precision': 0.7334263334228314, 'recall': 0.6703244529324528, 'f1-score': 0.7004571046323653, 'support': 187454}, '2': {'precision': 0.49024041640889987, 'recall': 0.6360554102489586, 'f1-score': 0.5537090021985965, 'support': 72261}, 'accuracy': 0.6280116422403741, 'macro avg': {'precision': 0.5908876211079681, 'recall': 0.6045250769657812, 'f1-score': 0.5938115587453886, 'support': 330177}, 'weighted avg': {'precision': 0.6408451430125431, 'recall': 0.6280116422403741, 'f1-score': 0.631380896419368, 'support': 330177}}
[[ 35738  25228   9496]
 [ 23503 125655  38296]
 [  5856  20443  45962]]
Evaluating performance on  val set...
363/363 - 10s - 10s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8238495
{'0': {'precision': 0.4959559195227985, 'recall': 0.4946057672917927, 'f1-score': 0.4952799232672017, 'support': 19836}, '1': {'precision': 0.7290186125211506, 'recall': 0.6452748240227647, 'f1-score': 0.6845952172876777, 'support': 53416}, '2': {'precision': 0.46132960980529053, 'recall': 0.6070845242956309, 'f1-score': 0.5242649975757041, 'support': 19592}, 'accuracy': 0.6050256343974839, 'macro avg': {'precision': 0.5621013806164132, 'recall': 0.5823217052033961, 'f1-score': 0.5680467127101945, 'support': 92844}, 'weighted avg': {'precision': 0.6227371670909188, 'recall': 0.6050256343974839, 'f1-score': 0.6103152655752659, 'support': 92844}}
[[ 9811  6970  3055]
 [ 8115 34468 10833]
 [ 1856  5842 11894]]
training model: results/EXC/W1/deepVOL_L3/h100
Epoch 1/50
1290/1290 - 85s - loss: 3.1980 - accuracy100: 0.4234 - val_loss: 3.2278 - val_accuracy100: 0.4312 - 85s/epoch - 66ms/step
Epoch 2/50
1290/1290 - 75s - loss: 3.0683 - accuracy100: 0.4664 - val_loss: 3.0209 - val_accuracy100: 0.4895 - 75s/epoch - 58ms/step
Epoch 3/50
1290/1290 - 80s - loss: 2.9387 - accuracy100: 0.5115 - val_loss: 3.0030 - val_accuracy100: 0.5044 - 80s/epoch - 62ms/step
Epoch 4/50
1290/1290 - 79s - loss: 2.8865 - accuracy100: 0.5219 - val_loss: 2.9992 - val_accuracy100: 0.5093 - 79s/epoch - 61ms/step
Epoch 5/50
1290/1290 - 78s - loss: 2.8580 - accuracy100: 0.5272 - val_loss: 2.9990 - val_accuracy100: 0.5065 - 78s/epoch - 61ms/step
Epoch 6/50
1290/1290 - 76s - loss: 2.8430 - accuracy100: 0.5302 - val_loss: 2.9898 - val_accuracy100: 0.5097 - 76s/epoch - 59ms/step
Epoch 7/50
1290/1290 - 78s - loss: 2.8308 - accuracy100: 0.5339 - val_loss: 2.9825 - val_accuracy100: 0.5092 - 78s/epoch - 61ms/step
Epoch 8/50
1290/1290 - 81s - loss: 2.8201 - accuracy100: 0.5359 - val_loss: 2.9767 - val_accuracy100: 0.5089 - 81s/epoch - 63ms/step
Epoch 9/50
1290/1290 - 81s - loss: 2.8070 - accuracy100: 0.5373 - val_loss: 3.0002 - val_accuracy100: 0.5074 - 81s/epoch - 63ms/step
Epoch 10/50
1290/1290 - 81s - loss: 2.7988 - accuracy100: 0.5400 - val_loss: 2.9921 - val_accuracy100: 0.5096 - 81s/epoch - 63ms/step
Epoch 11/50
1290/1290 - 78s - loss: 2.7905 - accuracy100: 0.5416 - val_loss: 3.0103 - val_accuracy100: 0.5096 - 78s/epoch - 61ms/step
Epoch 12/50
1290/1290 - 82s - loss: 2.7830 - accuracy100: 0.5443 - val_loss: 2.9688 - val_accuracy100: 0.5066 - 82s/epoch - 64ms/step
Epoch 13/50
1290/1290 - 82s - loss: 2.7748 - accuracy100: 0.5453 - val_loss: 3.0216 - val_accuracy100: 0.5075 - 82s/epoch - 64ms/step
Epoch 14/50
1290/1290 - 82s - loss: 2.7646 - accuracy100: 0.5479 - val_loss: 3.0225 - val_accuracy100: 0.5077 - 82s/epoch - 64ms/step
Epoch 15/50
1290/1290 - 79s - loss: 2.7550 - accuracy100: 0.5496 - val_loss: 3.0074 - val_accuracy100: 0.5074 - 79s/epoch - 62ms/step
Epoch 16/50
1290/1290 - 78s - loss: 2.7483 - accuracy100: 0.5498 - val_loss: 3.0232 - val_accuracy100: 0.5095 - 78s/epoch - 61ms/step
Epoch 17/50
1290/1290 - 77s - loss: 2.7407 - accuracy100: 0.5523 - val_loss: 3.0700 - val_accuracy100: 0.5039 - 77s/epoch - 60ms/step
Epoch 18/50
1290/1290 - 80s - loss: 2.7340 - accuracy100: 0.5539 - val_loss: 3.0605 - val_accuracy100: 0.5042 - 80s/epoch - 62ms/step
Epoch 19/50
1290/1290 - 77s - loss: 2.7295 - accuracy100: 0.5541 - val_loss: 3.0518 - val_accuracy100: 0.5090 - 77s/epoch - 60ms/step
Epoch 20/50
1290/1290 - 82s - loss: 2.7219 - accuracy100: 0.5557 - val_loss: 3.0280 - val_accuracy100: 0.5055 - 82s/epoch - 63ms/step
Epoch 21/50
1290/1290 - 81s - loss: 2.7160 - accuracy100: 0.5568 - val_loss: 3.0394 - val_accuracy100: 0.5061 - 81s/epoch - 63ms/step
Epoch 22/50
1290/1290 - 85s - loss: 2.7096 - accuracy100: 0.5585 - val_loss: 3.0689 - val_accuracy100: 0.5041 - 85s/epoch - 66ms/step
testing model: results/EXC/W1/deepVOL_L3/h100
Evaluating performance on  test set...
5343/5343 - 160s - 160s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.023486
{'0': {'precision': 0.5780720060548675, 'recall': 0.39582583429104234, 'f1-score': 0.46989699452602424, 'support': 461170}, '1': {'precision': 0.41201883024345953, 'recall': 0.5603076324692006, 'f1-score': 0.4748555226243281, 'support': 442216}, '2': {'precision': 0.5199217995859194, 'recall': 0.5045100914507443, 'f1-score': 0.5121000174855744, 'support': 464403}, 'accuracy': 0.48590535528506223, 'macro avg': {'precision': 0.5033375452947488, 'recall': 0.4868811860703291, 'f1-score': 0.4856175115453089, 'support': 1367789}, 'weighted avg': {'precision': 0.5046421849864012, 'recall': 0.48590535528506223, 'f1-score': 0.4858292406056488, 'support': 1367789}}
[[182543 184880  93747]
 [ 71845 247777 122594]
 [ 61391 168716 234296]]
Evaluating performance on  train set...
1290/1290 - 41s - 41s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9671769
{'0': {'precision': 0.5436654204623242, 'recall': 0.4235099881045162, 'f1-score': 0.47612404888171544, 'support': 97516}, '1': {'precision': 0.522983444874956, 'recall': 0.5796669469637816, 'f1-score': 0.5498682430026351, 'support': 133192}, '2': {'precision': 0.5042172913637003, 'recall': 0.5402889342408187, 'f1-score': 0.5216302522639695, 'support': 99469}, 'accuracy': 0.5216838241306936, 'macro avg': {'precision': 0.5236220522336602, 'recall': 0.5144886231030389, 'f1-score': 0.5158741813827733, 'support': 330177}, 'weighted avg': {'precision': 0.523438270643458, 'recall': 0.5216838241306936, 'f1-score': 0.5195813255774967, 'support': 330177}}
[[41299 37370 18847]
 [21989 77207 33996]
 [12676 33051 53742]]
Evaluating performance on  val set...
363/363 - 11s - 11s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9859551
{'0': {'precision': 0.5043631517860981, 'recall': 0.4340571935925419, 'f1-score': 0.466576530003579, 'support': 27031}, '1': {'precision': 0.5377539096491882, 'recall': 0.5499364352911263, 'f1-score': 0.5437769481213309, 'support': 39330}, '2': {'precision': 0.4646117166212534, 'recall': 0.515085148963486, 'f1-score': 0.4885482513475279, 'support': 26483}, 'accuracy': 0.5062578087975529, 'macro avg': {'precision': 0.5022429260188466, 'recall': 0.4996929259490514, 'f1-score': 0.49963390982414596, 'support': 92844}, 'weighted avg': {'precision': 0.5071691623983591, 'recall': 0.5062578087975529, 'f1-score': 0.5055469485650691, 'support': 92844}}
[[11733  9518  5780]
 [ 7762 21629  9939]
 [ 3768  9074 13641]]
training model: results/EXC/W1/deepVOL_L3/h200
Epoch 1/50
1290/1290 - 84s - loss: 3.2789 - accuracy200: 0.3840 - val_loss: 3.2456 - val_accuracy200: 0.3802 - 84s/epoch - 65ms/step
Epoch 2/50
1290/1290 - 82s - loss: 3.2340 - accuracy200: 0.4011 - val_loss: 3.2334 - val_accuracy200: 0.3853 - 82s/epoch - 64ms/step
Epoch 3/50
1290/1290 - 81s - loss: 3.2156 - accuracy200: 0.4101 - val_loss: 3.2134 - val_accuracy200: 0.4029 - 81s/epoch - 63ms/step
Epoch 4/50
1290/1290 - 81s - loss: 3.1788 - accuracy200: 0.4241 - val_loss: 3.1823 - val_accuracy200: 0.4155 - 81s/epoch - 63ms/step
Epoch 5/50
1290/1290 - 79s - loss: 3.1554 - accuracy200: 0.4301 - val_loss: 3.1754 - val_accuracy200: 0.4158 - 79s/epoch - 61ms/step
Epoch 6/50
1290/1290 - 80s - loss: 3.1419 - accuracy200: 0.4344 - val_loss: 3.1718 - val_accuracy200: 0.4190 - 80s/epoch - 62ms/step
Epoch 7/50
1290/1290 - 87s - loss: 3.1328 - accuracy200: 0.4379 - val_loss: 3.1713 - val_accuracy200: 0.4177 - 87s/epoch - 67ms/step
Epoch 8/50
1290/1290 - 87s - loss: 3.1236 - accuracy200: 0.4398 - val_loss: 3.1733 - val_accuracy200: 0.4180 - 87s/epoch - 68ms/step
Epoch 9/50
1290/1290 - 86s - loss: 3.1162 - accuracy200: 0.4418 - val_loss: 3.1735 - val_accuracy200: 0.4200 - 86s/epoch - 67ms/step
Epoch 10/50
1290/1290 - 90s - loss: 3.1094 - accuracy200: 0.4448 - val_loss: 3.1822 - val_accuracy200: 0.4202 - 90s/epoch - 69ms/step
Epoch 11/50
1290/1290 - 87s - loss: 3.1056 - accuracy200: 0.4458 - val_loss: 3.1818 - val_accuracy200: 0.4227 - 87s/epoch - 68ms/step
Epoch 12/50
1290/1290 - 86s - loss: 3.0973 - accuracy200: 0.4488 - val_loss: 3.1920 - val_accuracy200: 0.4185 - 86s/epoch - 67ms/step
Epoch 13/50
1290/1290 - 91s - loss: 3.0926 - accuracy200: 0.4518 - val_loss: 3.2009 - val_accuracy200: 0.4179 - 91s/epoch - 71ms/step
Epoch 14/50
1290/1290 - 93s - loss: 3.0873 - accuracy200: 0.4526 - val_loss: 3.1958 - val_accuracy200: 0.4185 - 93s/epoch - 72ms/step
Epoch 15/50
1290/1290 - 91s - loss: 3.0817 - accuracy200: 0.4544 - val_loss: 3.2103 - val_accuracy200: 0.4174 - 91s/epoch - 71ms/step
Epoch 16/50
1290/1290 - 88s - loss: 3.0757 - accuracy200: 0.4565 - val_loss: 3.2126 - val_accuracy200: 0.4175 - 88s/epoch - 68ms/step
Epoch 17/50
1290/1290 - 85s - loss: 3.0707 - accuracy200: 0.4590 - val_loss: 3.2192 - val_accuracy200: 0.4160 - 85s/epoch - 66ms/step
testing model: results/EXC/W1/deepVOL_L3/h200
Evaluating performance on  test set...
5343/5343 - 163s - 163s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0747607
{'0': {'precision': 0.4563441455753857, 'recall': 0.3911549753263789, 'f1-score': 0.4212424027365284, 'support': 480270}, '1': {'precision': 0.32291295935601183, 'recall': 0.37235389364088817, 'f1-score': 0.3458755360047317, 'support': 402053}, '2': {'precision': 0.44405348060465166, 'recall': 0.4505011679499697, 'f1-score': 0.4472540877583511, 'support': 485466}, 'accuracy': 0.40669211406145245, 'macro avg': {'precision': 0.407770195178683, 'recall': 0.4046700123057456, 'f1-score': 0.4047906754998704, 'support': 1367789}, 'weighted avg': {'precision': 0.4127605894320476, 'recall': 0.40669211406145245, 'f1-score': 0.40832104850037443, 'support': 1367789}}
[[187860 162472 129938]
 [108473 149706 143874]
 [115330 151433 218703]]
Evaluating performance on  train set...
1290/1290 - 40s - 40s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0530847
{'0': {'precision': 0.456385043889264, 'recall': 0.39681141871686204, 'f1-score': 0.424518395666297, 'support': 109014}, '1': {'precision': 0.37638327220289036, 'recall': 0.43965651405710726, 'f1-score': 0.405566885812126, 'support': 109233}, '2': {'precision': 0.46305555813241556, 'recall': 0.44595729473778256, 'f1-score': 0.4543456197918326, 'support': 111930}, 'accuracy': 0.4276463836063687, 'macro avg': {'precision': 0.43194129140819, 'recall': 0.4274750758372506, 'f1-score': 0.42814363375675185, 'support': 330177}, 'weighted avg': {'precision': 0.43217923043956363, 'recall': 0.4276463836063687, 'f1-score': 0.42836006519649006, 'support': 330177}}
[[43258 40531 25225]
 [28552 48025 32656]
 [22974 39040 49916]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 34ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0569988
{'0': {'precision': 0.4341048969761841, 'recall': 0.4283309680187465, 'f1-score': 0.4311986045352604, 'support': 30299}, '1': {'precision': 0.39494175543512117, 'recall': 0.38582078198691616, 'f1-score': 0.39032799248895667, 'support': 32865}, '2': {'precision': 0.42506971013552947, 'recall': 0.441711590296496, 'f1-score': 0.43323089124615843, 'support': 29680}, 'accuracy': 0.41756063935203136, 'macro avg': {'precision': 0.4180387875156116, 'recall': 0.4186211134340529, 'f1-score': 0.4182524960901251, 'support': 92844}, 'weighted avg': {'precision': 0.41735356148678615, 'recall': 0.41756063935203136, 'f1-score': 0.4173808629976024, 'support': 92844}}
[[12978  9793  7528]
 [ 9981 12680 10204]
 [ 6937  9633 13110]]
training model: results/EXC/W1/deepVOL_L3/h300
Epoch 1/50
1290/1290 - 95s - loss: 3.2920 - accuracy300: 0.3724 - val_loss: 3.2865 - val_accuracy300: 0.3551 - 95s/epoch - 73ms/step
Epoch 2/50
1290/1290 - 91s - loss: 3.2645 - accuracy300: 0.3854 - val_loss: 3.2631 - val_accuracy300: 0.3745 - 91s/epoch - 70ms/step
Epoch 3/50
1290/1290 - 88s - loss: 3.2487 - accuracy300: 0.3942 - val_loss: 3.2636 - val_accuracy300: 0.3746 - 88s/epoch - 68ms/step
Epoch 4/50
1290/1290 - 87s - loss: 3.2423 - accuracy300: 0.3971 - val_loss: 3.2578 - val_accuracy300: 0.3758 - 87s/epoch - 67ms/step
Epoch 5/50
1290/1290 - 89s - loss: 3.2347 - accuracy300: 0.4005 - val_loss: 3.2574 - val_accuracy300: 0.3778 - 89s/epoch - 69ms/step
Epoch 6/50
1290/1290 - 91s - loss: 3.2290 - accuracy300: 0.4050 - val_loss: 3.2581 - val_accuracy300: 0.3738 - 91s/epoch - 71ms/step
Epoch 7/50
1290/1290 - 89s - loss: 3.2228 - accuracy300: 0.4070 - val_loss: 3.2660 - val_accuracy300: 0.3734 - 89s/epoch - 69ms/step
Epoch 8/50
1290/1290 - 91s - loss: 3.2147 - accuracy300: 0.4120 - val_loss: 3.2623 - val_accuracy300: 0.3779 - 91s/epoch - 70ms/step
Epoch 9/50
1290/1290 - 86s - loss: 3.2037 - accuracy300: 0.4179 - val_loss: 3.2657 - val_accuracy300: 0.3775 - 86s/epoch - 67ms/step
Epoch 10/50
1290/1290 - 88s - loss: 3.1965 - accuracy300: 0.4220 - val_loss: 3.2728 - val_accuracy300: 0.3762 - 88s/epoch - 68ms/step
Epoch 11/50
1290/1290 - 89s - loss: 3.1879 - accuracy300: 0.4260 - val_loss: 3.2775 - val_accuracy300: 0.3741 - 89s/epoch - 69ms/step
Epoch 12/50
1290/1290 - 91s - loss: 3.1832 - accuracy300: 0.4280 - val_loss: 3.2735 - val_accuracy300: 0.3765 - 91s/epoch - 70ms/step
Epoch 13/50
1290/1290 - 85s - loss: 3.1782 - accuracy300: 0.4306 - val_loss: 3.2769 - val_accuracy300: 0.3731 - 85s/epoch - 66ms/step
Epoch 14/50
1290/1290 - 89s - loss: 3.1700 - accuracy300: 0.4352 - val_loss: 3.2755 - val_accuracy300: 0.3739 - 89s/epoch - 69ms/step
Epoch 15/50
1290/1290 - 91s - loss: 3.1666 - accuracy300: 0.4360 - val_loss: 3.2800 - val_accuracy300: 0.3780 - 91s/epoch - 70ms/step
testing model: results/EXC/W1/deepVOL_L3/h300
Evaluating performance on  test set...
5343/5343 - 166s - 166s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904927
{'0': {'precision': 0.37877133050414236, 'recall': 0.5237955241164484, 'f1-score': 0.4396322035670189, 'support': 445588}, '1': {'precision': 0.3464336535549168, 'recall': 0.12870734260314953, 'f1-score': 0.18768557248434148, 'support': 470991}, '2': {'precision': 0.3748974612000118, 'recall': 0.4790895591853017, 'f1-score': 0.4206374456252596, 'support': 451210}, 'accuracy': 0.37300124507508103, 'macro avg': {'precision': 0.36670081508635693, 'recall': 0.3771974753016332, 'f1-score': 0.34931840722554003, 'support': 1367789}, 'weighted avg': {'precision': 0.36635809763510374, 'recall': 0.37300124507508103, 'f1-score': 0.3466096537065049, 'support': 1367789}}
[[233397  55512 156679]
 [206609  60620 203762]
 [176189  58851 216170]]
Evaluating performance on  train set...
1290/1290 - 47s - 47s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0822883
{'0': {'precision': 0.3930975345574582, 'recall': 0.5605961695828467, 'f1-score': 0.462137835635647, 'support': 108761}, '1': {'precision': 0.3372460890624659, 'recall': 0.14179172935089715, 'f1-score': 0.199644806096419, 'support': 109012}, '2': {'precision': 0.4114206128133705, 'recall': 0.4730436639265507, 'f1-score': 0.44008541490788106, 'support': 112404}, 'accuracy': 0.39251674102072526, 'macro avg': {'precision': 0.3805880788110982, 'recall': 0.3918105209534315, 'f1-score': 0.36728935221331566, 'support': 330177}, 'weighted avg': {'precision': 0.38089532032684087, 'recall': 0.39251674102072526, 'f1-score': 0.3679651027208342, 'support': 330177}}
[[60971 14682 33108]
 [50595 15457 42960]
 [43538 15694 53172]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855584
{'0': {'precision': 0.37712292096370736, 'recall': 0.5682967959527825, 'f1-score': 0.45338116781196824, 'support': 30243}, '1': {'precision': 0.3749888422743908, 'recall': 0.12634206490030375, 'f1-score': 0.18900436406172674, 'support': 33251}, '2': {'precision': 0.3788504727313056, 'recall': 0.4655536626916525, 'f1-score': 0.4177507375758595, 'support': 29350}, 'accuracy': 0.3775365128602818, 'macro avg': {'precision': 0.3769874119898013, 'recall': 0.3867308411815796, 'f1-score': 0.3533787564831848, 'support': 92844}, 'weighted avg': {'precision': 0.3769047420170931, 'recall': 0.3775365128602818, 'f1-score': 0.34743413592052597, 'support': 92844}}
[[17187  3320  9736]
 [16383  4201 12667]
 [12004  3682 13664]]
training model: results/EXC/W1/deepVOL_L3/h500
Epoch 1/50
1290/1290 - 106s - loss: 3.3043 - accuracy500: 0.3623 - val_loss: 3.3013 - val_accuracy500: 0.3427 - 106s/epoch - 82ms/step
Epoch 2/50
1290/1290 - 98s - loss: 3.2832 - accuracy500: 0.3704 - val_loss: 3.2939 - val_accuracy500: 0.3480 - 98s/epoch - 76ms/step
Epoch 3/50
1290/1290 - 90s - loss: 3.2699 - accuracy500: 0.3808 - val_loss: 3.2943 - val_accuracy500: 0.3577 - 90s/epoch - 70ms/step
Epoch 4/50
1290/1290 - 94s - loss: 3.2590 - accuracy500: 0.3891 - val_loss: 3.3004 - val_accuracy500: 0.3564 - 94s/epoch - 73ms/step
Epoch 5/50
1290/1290 - 94s - loss: 3.2530 - accuracy500: 0.3933 - val_loss: 3.3060 - val_accuracy500: 0.3558 - 94s/epoch - 73ms/step
Epoch 6/50
1290/1290 - 94s - loss: 3.2453 - accuracy500: 0.3970 - val_loss: 3.3090 - val_accuracy500: 0.3557 - 94s/epoch - 73ms/step
Epoch 7/50
1290/1290 - 90s - loss: 3.2353 - accuracy500: 0.4039 - val_loss: 3.3067 - val_accuracy500: 0.3589 - 90s/epoch - 70ms/step
Epoch 8/50
1290/1290 - 95s - loss: 3.2281 - accuracy500: 0.4069 - val_loss: 3.3194 - val_accuracy500: 0.3604 - 95s/epoch - 73ms/step
Epoch 9/50
1290/1290 - 97s - loss: 3.2157 - accuracy500: 0.4141 - val_loss: 3.3133 - val_accuracy500: 0.3625 - 97s/epoch - 75ms/step
Epoch 10/50
1290/1290 - 94s - loss: 3.2047 - accuracy500: 0.4204 - val_loss: 3.3430 - val_accuracy500: 0.3598 - 94s/epoch - 73ms/step
Epoch 11/50
1290/1290 - 95s - loss: 3.1950 - accuracy500: 0.4251 - val_loss: 3.3408 - val_accuracy500: 0.3625 - 95s/epoch - 73ms/step
Epoch 12/50
1290/1290 - 89s - loss: 3.1846 - accuracy500: 0.4301 - val_loss: 3.3627 - val_accuracy500: 0.3551 - 89s/epoch - 69ms/step
testing model: results/EXC/W1/deepVOL_L3/h500
Evaluating performance on  test set...
5343/5343 - 169s - 169s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005999
{'0': {'precision': 0.36944823761040274, 'recall': 0.2462564914146852, 'f1-score': 0.29552810775819016, 'support': 462534}, '1': {'precision': 0.3227774735928352, 'recall': 0.7005248188451249, 'f1-score': 0.441929296722682, 'support': 438437}, '2': {'precision': 0.36403724118764186, 'recall': 0.08417841642781555, 'f1-score': 0.13673809900776493, 'support': 466818}, 'accuracy': 0.3365533719016603, 'macro avg': {'precision': 0.3520876507969599, 'recall': 0.3436532422292085, 'f1-score': 0.291398501162879, 'support': 1367789}, 'weighted avg': {'precision': 0.3526414492156645, 'recall': 0.3365533719016603, 'f1-score': 0.2882621213971132, 'support': 1367789}}
[[113902 315378  33254]
 [ 95906 307136  35395]
 [ 98495 329027  39296]]
Evaluating performance on  train set...
1290/1290 - 49s - 49s/epoch - 38ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968654
{'0': {'precision': 0.37615653485025013, 'recall': 0.3029837426050474, 'f1-score': 0.33562820088159606, 'support': 108689}, '1': {'precision': 0.3300305014802189, 'recall': 0.6824691587051294, 'f1-score': 0.4449100529100529, 'support': 107810}, '2': {'precision': 0.3903306078919303, 'recall': 0.0676120269533243, 'f1-score': 0.11525916817251385, 'support': 113678}, 'accuracy': 0.345856919167598, 'macro avg': {'precision': 0.3655058814074665, 'recall': 0.3510216427545003, 'f1-score': 0.29859914065472093, 'support': 330177}, 'weighted avg': {'precision': 0.36597542780042247, 'recall': 0.345856919167598, 'f1-score': 0.2954393493470703, 'support': 330177}}
[[32931 70164  5594]
 [27822 73577  6411]
 [26793 79199  7686]]
Evaluating performance on  val set...
363/363 - 12s - 12s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975902
{'0': {'precision': 0.3641888132836907, 'recall': 0.27745174752217006, 'f1-score': 0.3149577157238291, 'support': 30672}, '1': {'precision': 0.34088540414000995, 'recall': 0.6700494815468498, 'f1-score': 0.45187893215439545, 'support': 31729}, '2': {'precision': 0.36849507735583686, 'recall': 0.08606247741681175, 'f1-score': 0.13953612228051024, 'support': 30443}, 'accuracy': 0.34886476239713926, 'macro avg': {'precision': 0.35785643159317915, 'recall': 0.3445212354952772, 'f1-score': 0.30212425671957827, 'support': 92844}, 'weighted avg': {'precision': 0.3576369814844198, 'recall': 0.34886476239713926, 'f1-score': 0.3042301911334461, 'support': 92844}}
[[ 8510 20114  2048]
 [ 8027 21260  2442]
 [ 6830 20993  2620]]
training model: results/EXC/W1/deepVOL_L3/h1000
Epoch 1/50
1290/1290 - 101s - loss: 3.2410 - accuracy1000: 0.4090 - val_loss: 3.4732 - val_accuracy1000: 0.3123 - 101s/epoch - 79ms/step
Epoch 2/50
1290/1290 - 95s - loss: 3.2480 - accuracy1000: 0.3988 - val_loss: 3.4054 - val_accuracy1000: 0.3204 - 95s/epoch - 74ms/step
Epoch 3/50
1290/1290 - 94s - loss: 3.2414 - accuracy1000: 0.4043 - val_loss: 3.3728 - val_accuracy1000: 0.3209 - 94s/epoch - 73ms/step
Epoch 4/50
1290/1290 - 86s - loss: 3.2485 - accuracy1000: 0.4037 - val_loss: 3.4805 - val_accuracy1000: 0.3229 - 86s/epoch - 67ms/step
Epoch 5/50
1290/1290 - 91s - loss: 3.2438 - accuracy1000: 0.4045 - val_loss: 3.3549 - val_accuracy1000: 0.3147 - 91s/epoch - 71ms/step
Epoch 6/50
1290/1290 - 92s - loss: 3.2456 - accuracy1000: 0.3979 - val_loss: 3.3718 - val_accuracy1000: 0.3152 - 92s/epoch - 71ms/step
Epoch 7/50
1290/1290 - 98s - loss: 3.2382 - accuracy1000: 0.4018 - val_loss: 3.3748 - val_accuracy1000: 0.3148 - 98s/epoch - 76ms/step
Epoch 8/50
1290/1290 - 100s - loss: 3.2298 - accuracy1000: 0.4074 - val_loss: 3.3853 - val_accuracy1000: 0.3227 - 100s/epoch - 78ms/step
Epoch 9/50
1290/1290 - 100s - loss: 3.2123 - accuracy1000: 0.4210 - val_loss: 3.4165 - val_accuracy1000: 0.3236 - 100s/epoch - 77ms/step
Epoch 10/50
1290/1290 - 100s - loss: 3.2139 - accuracy1000: 0.4218 - val_loss: 3.4257 - val_accuracy1000: 0.3233 - 100s/epoch - 77ms/step
Epoch 11/50
1290/1290 - 101s - loss: 3.2066 - accuracy1000: 0.4252 - val_loss: 3.4095 - val_accuracy1000: 0.3219 - 101s/epoch - 78ms/step
Epoch 12/50
1290/1290 - 100s - loss: 3.1897 - accuracy1000: 0.4351 - val_loss: 3.4549 - val_accuracy1000: 0.3243 - 100s/epoch - 78ms/step
Epoch 13/50
1290/1290 - 96s - loss: 3.1812 - accuracy1000: 0.4433 - val_loss: 3.4426 - val_accuracy1000: 0.3264 - 96s/epoch - 74ms/step
Epoch 14/50
1290/1290 - 96s - loss: 3.1714 - accuracy1000: 0.4454 - val_loss: 3.4599 - val_accuracy1000: 0.3271 - 96s/epoch - 74ms/step
Epoch 15/50
1290/1290 - 99s - loss: 3.1576 - accuracy1000: 0.4498 - val_loss: 3.5136 - val_accuracy1000: 0.3260 - 99s/epoch - 77ms/step
testing model: results/EXC/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
5343/5343 - 195s - 195s/epoch - 36ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1275847
{'0': {'precision': 0.2715296893432953, 'recall': 0.4252792937674291, 'f1-score': 0.33144220961473075, 'support': 350706}, '1': {'precision': 0.6, 'recall': 9.013177265161666e-06, 'f1-score': 1.8026083743176374e-05, 'support': 665692}, '2': {'precision': 0.2541836135033861, 'recall': 0.5920669567518804, 'f1-score': 0.3556717686057226, 'support': 351391}, 'accuracy': 0.26115212214749495, 'macro avg': {'precision': 0.3752377676155605, 'recall': 0.33911842123219155, 'f1-score': 0.22904400143473216, 'support': 1367789}, 'weighted avg': {'precision': 0.42693728737648723, 'recall': 0.26115212214749495, 'f1-score': 0.1763653822534151, 'support': 1367789}}
[[149148      3 201555]
 [256797      6 408889]
 [143343      1 208047]]
Evaluating performance on  train set...
1290/1290 - 44s - 44s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001295
{'0': {'precision': 0.35366082090425904, 'recall': 0.568816667765047, 'f1-score': 0.43614759630828753, 'support': 106217}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 109491}, '2': {'precision': 0.3583406552027112, 'recall': 0.4988075374118757, 'f1-score': 0.4170644500363392, 'support': 114469}, 'accuracy': 0.35591818933481134, 'macro avg': {'precision': 0.23733382536899006, 'recall': 0.3558747350589742, 'f1-score': 0.28440401544820887, 'support': 330177}, 'weighted avg': {'precision': 0.23800473041546452, 'recall': 0.35591818933481134, 'f1-score': 0.2848994320267223, 'support': 330177}}
[[60418     1 45798]
 [53047     0 56444]
 [57371     0 57098]]
Evaluating performance on  val set...
363/363 - 13s - 13s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1165547
{'0': {'precision': 0.30042234992730044, 'recall': 0.44897044114096507, 'f1-score': 0.35997345206161335, 'support': 28993}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 35180}, '2': {'precision': 0.3245279208320711, 'recall': 0.5604617906595515, 'f1-score': 0.4110454557081831, 'support': 28671}, 'accuracy': 0.3132781870664771, 'macro avg': {'precision': 0.20831675691979049, 'recall': 0.33647741060017217, 'f1-score': 0.2570063025899321, 'support': 92844}, 'weighted avg': {'precision': 0.19403176521496845, 'recall': 0.3132781870664771, 'f1-score': 0.23934551027779583, 'support': 92844}}
[[13017     0 15976]
 [17710     0 17470]
 [12602     0 16069]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        23 (peak)  18.88 (ave)

============================================
