This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-13.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-05.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-23.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-01.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-28.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-30.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-25.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-31.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-10-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-06.csv
training model: results/PCAR/W8/deepLOB_L1/h10
Epoch 1/50
494/494 - 42s - loss: 3.2715 - accuracy10: 0.3902 - val_loss: 3.3144 - val_accuracy10: 0.3531 - 42s/epoch - 84ms/step
Epoch 2/50
494/494 - 12s - loss: 3.2353 - accuracy10: 0.4042 - val_loss: 3.3426 - val_accuracy10: 0.3469 - 12s/epoch - 24ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2052 - accuracy10: 0.4201 - val_loss: 3.3640 - val_accuracy10: 0.3448 - 11s/epoch - 23ms/step
Epoch 4/50
494/494 - 11s - loss: 3.1799 - accuracy10: 0.4336 - val_loss: 3.2759 - val_accuracy10: 0.3948 - 11s/epoch - 23ms/step
Epoch 5/50
494/494 - 11s - loss: 3.1604 - accuracy10: 0.4436 - val_loss: 3.3438 - val_accuracy10: 0.3593 - 11s/epoch - 23ms/step
Epoch 6/50
494/494 - 11s - loss: 3.1459 - accuracy10: 0.4502 - val_loss: 3.3202 - val_accuracy10: 0.3773 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.1333 - accuracy10: 0.4528 - val_loss: 3.3784 - val_accuracy10: 0.3633 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.1235 - accuracy10: 0.4560 - val_loss: 3.3813 - val_accuracy10: 0.3604 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.1161 - accuracy10: 0.4578 - val_loss: 3.3832 - val_accuracy10: 0.3703 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.1082 - accuracy10: 0.4581 - val_loss: 3.3792 - val_accuracy10: 0.3761 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.0991 - accuracy10: 0.4626 - val_loss: 3.4325 - val_accuracy10: 0.3707 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.0968 - accuracy10: 0.4623 - val_loss: 3.4106 - val_accuracy10: 0.3725 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.0887 - accuracy10: 0.4650 - val_loss: 3.4100 - val_accuracy10: 0.3802 - 11s/epoch - 22ms/step
Epoch 14/50
494/494 - 11s - loss: 3.0814 - accuracy10: 0.4679 - val_loss: 3.4386 - val_accuracy10: 0.3836 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h10
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0773058
{'0': {'precision': 0.42221982700547006, 'recall': 0.3841508262098949, 'f1-score': 0.4022867021253835, 'support': 122366}, '1': {'precision': 0.3787550148406667, 'recall': 0.37401863289019155, 'f1-score': 0.3763719234275297, 'support': 124189}, '2': {'precision': 0.41298495762398496, 'recall': 0.45537053950029355, 'f1-score': 0.4331433003684313, 'support': 122632}, 'accuracy': 0.40439939651179485, 'macro avg': {'precision': 0.4046532664900406, 'recall': 0.40451333286679336, 'f1-score': 0.4039339753071148, 'support': 369187}, 'weighted avg': {'precision': 0.4045313871093604, 'recall': 0.40439939651179485, 'f1-score': 0.4038189226641177, 'support': 369187}}
[[47007 35222 40137]
 [38502 46449 39238]
 [25824 40965 55843]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1002833
{'0': {'precision': 0.44756563133336474, 'recall': 0.2262945928556109, 'f1-score': 0.3006014561570117, 'support': 41963}, '1': {'precision': 0.3503940100007854, 'recall': 0.6425965047052046, 'f1-score': 0.45350275307073273, 'support': 41656}, '2': {'precision': 0.4198598375230989, 'recall': 0.2821924870527031, 'f1-score': 0.337528379628332, 'support': 42673}, 'accuracy': 0.3824945364710354, 'macro avg': {'precision': 0.40593982628574965, 'recall': 0.38369452820450617, 'f1-score': 0.3638775296186922, 'support': 126292}, 'weighted avg': {'precision': 0.4061531079946307, 'recall': 0.3824945364710354, 'f1-score': 0.36351152987133734, 'support': 126292}}
[[ 9496 24246  8221]
 [ 6470 26768  8418]
 [ 5251 25380 12042]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0938793
{'0': {'precision': 0.43232564550215935, 'recall': 0.36427686590275626, 'f1-score': 0.39539476448590277, 'support': 12916}, '1': {'precision': 0.36706514688166064, 'recall': 0.621723434311725, 'f1-score': 0.46160121197995574, 'support': 12742}, '2': {'precision': 0.44026042583142705, 'recall': 0.20032025620496396, 'f1-score': 0.27535354647003796, 'support': 12490}, 'accuracy': 0.396586977036804, 'macro avg': {'precision': 0.4132170727384157, 'recall': 0.3954401854731484, 'f1-score': 0.37744984097863216, 'support': 38148}, 'weighted avg': {'precision': 0.4131255860728356, 'recall': 0.396586977036804, 'f1-score': 0.37820612395300646, 'support': 38148}}
[[4705 6661 1550]
 [3189 7922 1631]
 [2989 6999 2502]]
training model: results/PCAR/W8/deepLOB_L1/h20
Epoch 1/50
494/494 - 13s - loss: 3.2870 - accuracy20: 0.3845 - val_loss: 3.3585 - val_accuracy20: 0.3494 - 13s/epoch - 26ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2621 - accuracy20: 0.3949 - val_loss: 3.3165 - val_accuracy20: 0.3635 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2302 - accuracy20: 0.4066 - val_loss: 3.3198 - val_accuracy20: 0.3810 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2203 - accuracy20: 0.4133 - val_loss: 3.2962 - val_accuracy20: 0.3817 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2091 - accuracy20: 0.4194 - val_loss: 3.3545 - val_accuracy20: 0.3611 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.1951 - accuracy20: 0.4270 - val_loss: 3.3617 - val_accuracy20: 0.3573 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.1806 - accuracy20: 0.4316 - val_loss: 3.3736 - val_accuracy20: 0.3630 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.1695 - accuracy20: 0.4364 - val_loss: 3.3938 - val_accuracy20: 0.3633 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.1617 - accuracy20: 0.4390 - val_loss: 3.3709 - val_accuracy20: 0.3645 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.1539 - accuracy20: 0.4415 - val_loss: 3.3921 - val_accuracy20: 0.3670 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.1485 - accuracy20: 0.4435 - val_loss: 3.3817 - val_accuracy20: 0.3723 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.1410 - accuracy20: 0.4471 - val_loss: 3.3800 - val_accuracy20: 0.3685 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.1362 - accuracy20: 0.4470 - val_loss: 3.4014 - val_accuracy20: 0.3689 - 11s/epoch - 22ms/step
Epoch 14/50
494/494 - 11s - loss: 3.1306 - accuracy20: 0.4502 - val_loss: 3.3811 - val_accuracy20: 0.3697 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h20
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0812466
{'0': {'precision': 0.40963855421686746, 'recall': 0.33141275254525593, 'f1-score': 0.3663968730986928, 'support': 119929}, '1': {'precision': 0.3784382570298366, 'recall': 0.38717950729025324, 'f1-score': 0.38275898163547756, 'support': 127499}, '2': {'precision': 0.3985576787377572, 'recall': 0.4638835732882169, 'f1-score': 0.42874656039472436, 'support': 121759}, 'accuracy': 0.3943611232248156, 'macro avg': {'precision': 0.3955448299948204, 'recall': 0.39415861104124206, 'f1-score': 0.3926341383762983, 'support': 369187}, 'weighted avg': {'precision': 0.3952090022323441, 'recall': 0.3943611232248156, 'f1-score': 0.39261065649791604, 'support': 369187}}
[[39746 39852 40331]
 [33231 49365 44903]
 [24050 41227 56482]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0978026
{'0': {'precision': 0.4114469221765359, 'recall': 0.32941657054978857, 'f1-score': 0.36589043837992924, 'support': 41616}, '1': {'precision': 0.36129230435646786, 'recall': 0.47723041672633537, 'f1-score': 0.4112462850032394, 'support': 41898}, '2': {'precision': 0.3949242625564709, 'recall': 0.3473981953340502, 'f1-score': 0.369639836832156, 'support': 42778}, 'accuracy': 0.38454533937224844, 'macro avg': {'precision': 0.38922116302982485, 'recall': 0.3846817275367247, 'f1-score': 0.3822588534051082, 'support': 126292}, 'weighted avg': {'precision': 0.3892112737534184, 'recall': 0.38454533937224844, 'f1-score': 0.3822074737330221, 'support': 126292}}
[[13709 16766 11141]
 [10275 19995 11628]
 [ 9335 18582 14861]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0992181
{'0': {'precision': 0.41408714931354995, 'recall': 0.37984981226533165, 'f1-score': 0.3962302639631186, 'support': 12784}, '1': {'precision': 0.36251824056702103, 'recall': 0.532822673305247, 'f1-score': 0.4314734981236237, 'support': 13055}, '2': {'precision': 0.39029448361675656, 'recall': 0.22934438215939557, 'f1-score': 0.28891618053423396, 'support': 12309}, 'accuracy': 0.383637412184125, 'macro avg': {'precision': 0.3889666244991092, 'recall': 0.38067228924332475, 'f1-score': 0.3722066475403254, 'support': 38148}, 'weighted avg': {'precision': 0.3887622036873634, 'recall': 0.383637412184125, 'f1-score': 0.3736647656156103, 'support': 38148}}
[[4856 5938 1990]
 [3679 6956 2420]
 [3192 6294 2823]]
training model: results/PCAR/W8/deepLOB_L1/h30
Epoch 1/50
494/494 - 13s - loss: 3.2955 - accuracy30: 0.3787 - val_loss: 3.3568 - val_accuracy30: 0.3534 - 13s/epoch - 27ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2728 - accuracy30: 0.3867 - val_loss: 3.3047 - val_accuracy30: 0.3564 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2483 - accuracy30: 0.3993 - val_loss: 3.2801 - val_accuracy30: 0.3719 - 11s/epoch - 23ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2396 - accuracy30: 0.4039 - val_loss: 3.2834 - val_accuracy30: 0.3675 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2254 - accuracy30: 0.4099 - val_loss: 3.2826 - val_accuracy30: 0.3679 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2187 - accuracy30: 0.4137 - val_loss: 3.3265 - val_accuracy30: 0.3539 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2109 - accuracy30: 0.4164 - val_loss: 3.3376 - val_accuracy30: 0.3644 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2054 - accuracy30: 0.4196 - val_loss: 3.3415 - val_accuracy30: 0.3638 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.1949 - accuracy30: 0.4238 - val_loss: 3.3626 - val_accuracy30: 0.3583 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.1879 - accuracy30: 0.4260 - val_loss: 3.3912 - val_accuracy30: 0.3624 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.1821 - accuracy30: 0.4283 - val_loss: 3.5222 - val_accuracy30: 0.3549 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.1772 - accuracy30: 0.4300 - val_loss: 3.5899 - val_accuracy30: 0.3554 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.1701 - accuracy30: 0.4322 - val_loss: 3.5927 - val_accuracy30: 0.3597 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h30
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088596
{'0': {'precision': 0.38694268760798356, 'recall': 0.4088333443467918, 'f1-score': 0.3975869256999643, 'support': 121064}, '1': {'precision': 0.3663937068798762, 'recall': 0.23007903601969423, 'f1-score': 0.2826600607860401, 'support': 123488}, '2': {'precision': 0.3925388904836651, 'recall': 0.5156657439723994, 'f1-score': 0.44575605831518494, 'support': 124635}, 'accuracy': 0.38510835972014185, 'macro avg': {'precision': 0.3819584283238416, 'recall': 0.38485937477962845, 'f1-score': 0.3753343482670631, 'support': 369187}, 'weighted avg': {'precision': 0.38195857444380943, 'recall': 0.38510835972014185, 'f1-score': 0.37540703082015364, 'support': 369187}}
[[49495 23668 47901]
 [43518 28412 51558]
 [34900 25465 64270]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0893728
{'0': {'precision': 0.3924324324324324, 'recall': 0.38402539010843695, 'f1-score': 0.3881833979414517, 'support': 41591}, '1': {'precision': 0.36013243205959444, 'recall': 0.31243716788740483, 'f1-score': 0.33459364546351716, 'support': 41778}, '2': {'precision': 0.3946947129511419, 'recall': 0.45376604617571, 'f1-score': 0.42217405440554895, 'support': 42923}, 'accuracy': 0.3840464954233047, 'macro avg': {'precision': 0.382419859147723, 'recall': 0.3834095347238506, 'f1-score': 0.38165036593683926, 'support': 126292}, 'weighted avg': {'precision': 0.382516320969538, 'recall': 0.3840464954233047, 'f1-score': 0.3820080920502258, 'support': 126292}}
[[15972 11204 14415]
 [13270 13053 15455]
 [11458 11988 19477]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0940927
{'0': {'precision': 0.3961515229959444, 'recall': 0.3558638865204248, 'f1-score': 0.37492854226214783, 'support': 12901}, '1': {'precision': 0.34594144791587866, 'recall': 0.3590609296482412, 'f1-score': 0.352379117703718, 'support': 12736}, '2': {'precision': 0.37466266866566716, 'recall': 0.3994884501638558, 'f1-score': 0.3866774979691308, 'support': 12511}, 'accuracy': 0.371238334906155, 'macro avg': {'precision': 0.3722518798591634, 'recall': 0.37147108877750723, 'f1-score': 0.37132838597833223, 'support': 38148}, 'weighted avg': {'precision': 0.37234103299002497, 'recall': 0.371238334906155, 'f1-score': 0.37125342728033756, 'support': 38148}}
[[4591 4311 3999]
 [3820 4573 4343]
 [3178 4335 4998]]
training model: results/PCAR/W8/deepLOB_L1/h50
Epoch 1/50
494/494 - 13s - loss: 3.3081 - accuracy50: 0.3686 - val_loss: 3.3513 - val_accuracy50: 0.3389 - 13s/epoch - 27ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2732 - accuracy50: 0.3814 - val_loss: 3.3360 - val_accuracy50: 0.3463 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2650 - accuracy50: 0.3883 - val_loss: 3.3653 - val_accuracy50: 0.3473 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2540 - accuracy50: 0.3920 - val_loss: 3.3846 - val_accuracy50: 0.3423 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2450 - accuracy50: 0.3972 - val_loss: 3.4171 - val_accuracy50: 0.3431 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2345 - accuracy50: 0.4034 - val_loss: 3.4877 - val_accuracy50: 0.3428 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2289 - accuracy50: 0.4054 - val_loss: 3.5440 - val_accuracy50: 0.3404 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2223 - accuracy50: 0.4068 - val_loss: 3.5723 - val_accuracy50: 0.3413 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.2184 - accuracy50: 0.4084 - val_loss: 3.6180 - val_accuracy50: 0.3391 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.2164 - accuracy50: 0.4119 - val_loss: 3.5366 - val_accuracy50: 0.3428 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.2103 - accuracy50: 0.4131 - val_loss: 3.5326 - val_accuracy50: 0.3380 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.2058 - accuracy50: 0.4148 - val_loss: 3.6343 - val_accuracy50: 0.3381 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h50
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1113522
{'0': {'precision': 0.3404041093552681, 'recall': 0.16564524165421027, 'f1-score': 0.2228490989732876, 'support': 120420}, '1': {'precision': 0.3428748283879979, 'recall': 0.3450986030239858, 'f1-score': 0.3439831216910155, 'support': 125199}, '2': {'precision': 0.3402518176597428, 'recall': 0.5082464715784022, 'f1-score': 0.407618466571041, 'support': 123568}, 'accuracy': 0.34117127634505007, 'macro avg': {'precision': 0.34117691846766957, 'recall': 0.33966343875219945, 'f1-score': 0.32481689574511474, 'support': 369187}, 'weighted avg': {'precision': 0.34119100914303435, 'recall': 0.34117127634505007, 'f1-score': 0.32577103210082464, 'support': 369187}}
[[19947 40139 60334]
 [20552 43206 61441]
 [18099 42666 62803]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052014
{'0': {'precision': 0.36555929619513433, 'recall': 0.2764434623883178, 'f1-score': 0.3148163343453406, 'support': 41636}, '1': {'precision': 0.3454490448612672, 'recall': 0.3807459629400276, 'f1-score': 0.36223969545217644, 'support': 41986}, '2': {'precision': 0.35526478466927675, 'recall': 0.40405437075228495, 'f1-score': 0.37809210526315784, 'support': 42670}, 'accuracy': 0.3542346308554778, 'macro avg': {'precision': 0.3554243752418928, 'recall': 0.3537479320268768, 'f1-score': 0.35171604502022497, 'support': 126292}, 'weighted avg': {'precision': 0.3553954234295427, 'recall': 0.3542346308554778, 'f1-score': 0.3519611604981838, 'support': 126292}}
[[11510 14584 15542]
 [10253 15986 15747]
 [ 9723 15706 17241]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.111293
{'0': {'precision': 0.36205840310394116, 'recall': 0.28207779810675365, 'f1-score': 0.317102615694165, 'support': 12571}, '1': {'precision': 0.3581583882872527, 'recall': 0.4476709013914096, 'f1-score': 0.39794306456491785, 'support': 13224}, '2': {'precision': 0.31983086680761097, 'recall': 0.306160446855015, 'f1-score': 0.3128463892795103, 'support': 12353}, 'accuracy': 0.3472790185592954, 'macro avg': {'precision': 0.3466825527329349, 'recall': 0.3453030487843927, 'f1-score': 0.3426306898461977, 'support': 38148}, 'weighted avg': {'precision': 0.3470324370820146, 'recall': 0.3472790185592954, 'f1-score': 0.3437477066810216, 'support': 38148}}
[[3546 5163 3862]
 [3123 5920 4181]
 [3125 5446 3782]]
training model: results/PCAR/W8/deepLOB_L1/h100
Epoch 1/50
494/494 - 13s - loss: 3.3120 - accuracy100: 0.3694 - val_loss: 3.3124 - val_accuracy100: 0.3467 - 13s/epoch - 26ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2972 - accuracy100: 0.3615 - val_loss: 3.3181 - val_accuracy100: 0.3414 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2965 - accuracy100: 0.3608 - val_loss: 3.3112 - val_accuracy100: 0.3376 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2799 - accuracy100: 0.3717 - val_loss: 3.3016 - val_accuracy100: 0.3433 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2729 - accuracy100: 0.3743 - val_loss: 3.3201 - val_accuracy100: 0.3314 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2624 - accuracy100: 0.3848 - val_loss: 3.3077 - val_accuracy100: 0.3405 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2434 - accuracy100: 0.3923 - val_loss: 3.3276 - val_accuracy100: 0.3323 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2324 - accuracy100: 0.3996 - val_loss: 3.3581 - val_accuracy100: 0.3272 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.2291 - accuracy100: 0.4016 - val_loss: 3.3545 - val_accuracy100: 0.3302 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.2209 - accuracy100: 0.4066 - val_loss: 3.3593 - val_accuracy100: 0.3276 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.2136 - accuracy100: 0.4093 - val_loss: 3.3803 - val_accuracy100: 0.3323 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.2113 - accuracy100: 0.4096 - val_loss: 3.3839 - val_accuracy100: 0.3295 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.2095 - accuracy100: 0.4108 - val_loss: 3.3919 - val_accuracy100: 0.3291 - 11s/epoch - 22ms/step
Epoch 14/50
494/494 - 11s - loss: 3.2069 - accuracy100: 0.4116 - val_loss: 3.4299 - val_accuracy100: 0.3302 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h100
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980462
{'0': {'precision': 0.3167553064060179, 'recall': 0.0560943532306648, 'f1-score': 0.09531017977884462, 'support': 117855}, '1': {'precision': 0.36451783271867144, 'recall': 0.6189125802841946, 'f1-score': 0.4588116646070369, 'support': 130474}, '2': {'precision': 0.335591749812675, 'recall': 0.35204951265121054, 'f1-score': 0.3436236840936348, 'support': 120858}, 'accuracy': 0.3518840045830433, 'macro avg': {'precision': 0.3389549629791215, 'recall': 0.3423521487220233, 'f1-score': 0.2992485094931721, 'support': 369187}, 'weighted avg': {'precision': 0.3398013582316751, 'recall': 0.3518840045830433, 'f1-score': 0.3050634111655144, 'support': 369187}}
[[ 6611 69034 42210]
 [ 7695 80752 42027]
 [ 6565 71745 42548]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003189
{'0': {'precision': 0.3283800243605359, 'recall': 0.06479523168621419, 'f1-score': 0.10823397165683087, 'support': 41608}, '1': {'precision': 0.332169491882997, 'recall': 0.7575538876058506, 'f1-score': 0.46183516781673245, 'support': 41568}, '2': {'precision': 0.3631716850650745, 'recall': 0.19609889600148436, 'f1-score': 0.25468018133349396, 'support': 43116}, 'accuracy': 0.3376381718556995, 'macro avg': {'precision': 0.34124040043620246, 'recall': 0.33948267176451635, 'f1-score': 0.2749164402690191, 'support': 126292}, 'weighted avg': {'precision': 0.34150514573727037, 'recall': 0.3376381718556995, 'f1-score': 0.2746156054768178, 'support': 126292}}
[[ 2696 31419  7493]
 [ 2745 31490  7333]
 [ 2769 31892  8455]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005532
{'0': {'precision': 0.35847750865051903, 'recall': 0.12470909236818875, 'f1-score': 0.18504405810907357, 'support': 12461}, '1': {'precision': 0.3499732399163139, 'recall': 0.5473291736417593, 'f1-score': 0.42694761834100015, 'support': 13142}, '2': {'precision': 0.32526395173454, 'recall': 0.3438023116779593, 'f1-score': 0.33427630304204614, 'support': 12545}, 'accuracy': 0.3423508440809479, 'macro avg': {'precision': 0.3445715667671243, 'recall': 0.3386135258959691, 'f1-score': 0.3154226598307066, 'support': 38148}, 'weighted avg': {'precision': 0.3446254804651389, 'recall': 0.3423508440809479, 'f1-score': 0.31745506527202105, 'support': 38148}}
[[1554 6648 4259]
 [1261 7193 4688]
 [1520 6712 4313]]
training model: results/PCAR/W8/deepLOB_L1/h200
Epoch 1/50
494/494 - 13s - loss: 3.3186 - accuracy200: 0.3658 - val_loss: 3.3725 - val_accuracy200: 0.3330 - 13s/epoch - 27ms/step
Epoch 2/50
494/494 - 11s - loss: 3.3021 - accuracy200: 0.3643 - val_loss: 3.3315 - val_accuracy200: 0.3273 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2920 - accuracy200: 0.3608 - val_loss: 3.3267 - val_accuracy200: 0.3205 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2905 - accuracy200: 0.3606 - val_loss: 3.3393 - val_accuracy200: 0.3281 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2814 - accuracy200: 0.3619 - val_loss: 3.3433 - val_accuracy200: 0.3251 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2770 - accuracy200: 0.3635 - val_loss: 3.3181 - val_accuracy200: 0.3336 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2686 - accuracy200: 0.3682 - val_loss: 3.3133 - val_accuracy200: 0.3320 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2649 - accuracy200: 0.3760 - val_loss: 3.3371 - val_accuracy200: 0.3291 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.2583 - accuracy200: 0.3828 - val_loss: 3.3421 - val_accuracy200: 0.3331 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.2466 - accuracy200: 0.3906 - val_loss: 3.3415 - val_accuracy200: 0.3245 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.2374 - accuracy200: 0.3959 - val_loss: 3.3629 - val_accuracy200: 0.3210 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.2283 - accuracy200: 0.4056 - val_loss: 3.3776 - val_accuracy200: 0.3204 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.2279 - accuracy200: 0.4073 - val_loss: 3.3470 - val_accuracy200: 0.3273 - 11s/epoch - 22ms/step
Epoch 14/50
494/494 - 11s - loss: 3.2202 - accuracy200: 0.4104 - val_loss: 3.3707 - val_accuracy200: 0.3175 - 11s/epoch - 22ms/step
Epoch 15/50
494/494 - 11s - loss: 3.2159 - accuracy200: 0.4107 - val_loss: 3.3794 - val_accuracy200: 0.3257 - 11s/epoch - 22ms/step
Epoch 16/50
494/494 - 11s - loss: 3.2147 - accuracy200: 0.4118 - val_loss: 3.3757 - val_accuracy200: 0.3239 - 11s/epoch - 22ms/step
Epoch 17/50
494/494 - 11s - loss: 3.2105 - accuracy200: 0.4157 - val_loss: 3.3735 - val_accuracy200: 0.3343 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h200
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102792
{'0': {'precision': 0.31886465405171166, 'recall': 0.10894419951306179, 'f1-score': 0.1624017558272129, 'support': 121576}, '1': {'precision': 0.3370775938237808, 'recall': 0.3812187730362847, 'f1-score': 0.3577918883183174, 'support': 122090}, '2': {'precision': 0.351367033987266, 'recall': 0.5306602082520057, 'f1-score': 0.4227908039556701, 'support': 125521}, 'accuracy': 0.3423657929450387, 'macro avg': {'precision': 0.3357697606209194, 'recall': 0.3402743936004507, 'f1-score': 0.3143281493670668, 'support': 369187}, 'weighted avg': {'precision': 0.3359382483241607, 'recall': 0.3423657929450387, 'f1-score': 0.315547654750986, 'support': 369187}}
[[13245 45007 63324]
 [15909 46543 59638]
 [12384 46528 66609]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995201
{'0': {'precision': 0.3416766181036542, 'recall': 0.1726443328827959, 'f1-score': 0.22938412942742153, 'support': 41432}, '1': {'precision': 0.34940549866846704, 'recall': 0.4479251815165649, 'f1-score': 0.392578701167348, 'support': 41594}, '2': {'precision': 0.35841260689920246, 'recall': 0.431054407617991, 'f1-score': 0.3913914859235475, 'support': 43266}, 'accuracy': 0.3518354290057961, 'macro avg': {'precision': 0.3498315745571079, 'recall': 0.35054130733911726, 'f1-score': 0.3377847721727723, 'support': 126292}, 'weighted avg': {'precision': 0.3499556409193592, 'recall': 0.3518354290057961, 'f1-score': 0.3386335300475074, 'support': 126292}}
[[ 7153 17280 16999]
 [ 6577 18631 16386]
 [ 7205 17411 18650]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041507
{'0': {'precision': 0.3709970887918486, 'recall': 0.1601602387872123, 'f1-score': 0.22373402095791958, 'support': 12731}, '1': {'precision': 0.3207467630231858, 'recall': 0.4303490627020039, 'f1-score': 0.3675511542044788, 'support': 12376}, '2': {'precision': 0.3312768741820901, 'recall': 0.407637451115712, 'f1-score': 0.3655115511551155, 'support': 13041}, 'accuracy': 0.3324158540421516, 'macro avg': {'precision': 0.34100690866570815, 'recall': 0.3327155842016427, 'f1-score': 0.318932242105838, 'support': 38148}, 'weighted avg': {'precision': 0.3411163781271, 'recall': 0.3324158540421516, 'f1-score': 0.31885831613357885, 'support': 38148}}
[[2039 5436 5256]
 [1575 5326 5475]
 [1882 5843 5316]]
training model: results/PCAR/W8/deepLOB_L1/h300
Epoch 1/50
494/494 - 13s - loss: 3.3143 - accuracy300: 0.3717 - val_loss: 3.4753 - val_accuracy300: 0.3293 - 13s/epoch - 26ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2864 - accuracy300: 0.3740 - val_loss: 3.3437 - val_accuracy300: 0.3357 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2765 - accuracy300: 0.3782 - val_loss: 3.3667 - val_accuracy300: 0.3239 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2658 - accuracy300: 0.3876 - val_loss: 3.3936 - val_accuracy300: 0.3254 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2502 - accuracy300: 0.3942 - val_loss: 3.3975 - val_accuracy300: 0.3196 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2419 - accuracy300: 0.3990 - val_loss: 3.4166 - val_accuracy300: 0.3236 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2451 - accuracy300: 0.3988 - val_loss: 3.4195 - val_accuracy300: 0.3226 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2378 - accuracy300: 0.4021 - val_loss: 3.4779 - val_accuracy300: 0.3302 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.2360 - accuracy300: 0.4046 - val_loss: 3.4109 - val_accuracy300: 0.3264 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.2308 - accuracy300: 0.4051 - val_loss: 3.4326 - val_accuracy300: 0.3270 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.2251 - accuracy300: 0.4088 - val_loss: 3.4463 - val_accuracy300: 0.3280 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.2178 - accuracy300: 0.4105 - val_loss: 3.4530 - val_accuracy300: 0.3329 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h300
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041259
{'0': {'precision': 0.32263228850690934, 'recall': 0.031718025182239894, 'f1-score': 0.057757866473587355, 'support': 120720}, '1': {'precision': 0.3430059462784499, 'recall': 0.3391643553436167, 'f1-score': 0.34107433399529424, 'support': 123306}, '2': {'precision': 0.34286770266022076, 'recall': 0.6448414442198448, 'f1-score': 0.4476931397428963, 'support': 125161}, 'accuracy': 0.34226286407701245, 'macro avg': {'precision': 0.33616864581519335, 'recall': 0.33857460824856717, 'f1-score': 0.2821751134039259, 'support': 369187}, 'weighted avg': {'precision': 0.33629712208994506, 'recall': 0.34226286407701245, 'f1-score': 0.28457871629194925, 'support': 369187}}
[[ 3829 39296 77595]
 [ 4395 41821 77090]
 [ 3644 40808 80709]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079714
{'0': {'precision': 0.32763758439892876, 'recall': 0.20910973084886128, 'f1-score': 0.25528663169186905, 'support': 41538}, '1': {'precision': 0.3399868030353019, 'recall': 0.4014022787028922, 'f1-score': 0.3681507613986513, 'support': 41076}, '2': {'precision': 0.3605732670371454, 'recall': 0.4233710334722286, 'f1-score': 0.3894569463896465, 'support': 43678}, 'accuracy': 0.3457542837234346, 'macro avg': {'precision': 0.34273255149045867, 'recall': 0.344627681007994, 'f1-score': 0.33763144649338894, 'support': 126292}, 'weighted avg': {'precision': 0.34304490434777496, 'recall': 0.3457542837234346, 'f1-score': 0.3383979768064077, 'support': 126292}}
[[ 8686 15801 17051]
 [ 8846 16488 15742]
 [ 8979 16207 18492]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1154909
{'0': {'precision': 0.34210011732499024, 'recall': 0.2778086542278682, 'f1-score': 0.3066205143933752, 'support': 12595}, '1': {'precision': 0.3262170467410642, 'recall': 0.3274616446140109, 'f1-score': 0.32683816082641276, 'support': 12319}, '2': {'precision': 0.33888388838883887, 'recall': 0.39829227746713014, 'f1-score': 0.366194247603168, 'support': 13234}, 'accuracy': 0.3356401384083045, 'macro avg': {'precision': 0.33573368415163113, 'recall': 0.33452085876966975, 'f1-score': 0.3332176409409853, 'support': 38148}, 'weighted avg': {'precision': 0.33585530448383444, 'recall': 0.3356401384083045, 'f1-score': 0.33381617266397884, 'support': 38148}}
[[3499 4023 5073]
 [3075 4034 5210]
 [3654 4309 5271]]
training model: results/PCAR/W8/deepLOB_L1/h500
Epoch 1/50
494/494 - 14s - loss: 3.3187 - accuracy500: 0.3776 - val_loss: 3.3726 - val_accuracy500: 0.3435 - 14s/epoch - 27ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2846 - accuracy500: 0.3813 - val_loss: 3.3651 - val_accuracy500: 0.3306 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2805 - accuracy500: 0.3860 - val_loss: 3.3369 - val_accuracy500: 0.3322 - 11s/epoch - 22ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2671 - accuracy500: 0.3878 - val_loss: 3.3512 - val_accuracy500: 0.3238 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2508 - accuracy500: 0.3960 - val_loss: 3.4280 - val_accuracy500: 0.3107 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.2275 - accuracy500: 0.4131 - val_loss: 3.4530 - val_accuracy500: 0.3140 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.2240 - accuracy500: 0.4119 - val_loss: 3.4591 - val_accuracy500: 0.3183 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.2162 - accuracy500: 0.4188 - val_loss: 3.4580 - val_accuracy500: 0.3151 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.2154 - accuracy500: 0.4166 - val_loss: 3.5068 - val_accuracy500: 0.3142 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.2057 - accuracy500: 0.4204 - val_loss: 3.5696 - val_accuracy500: 0.3222 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.1891 - accuracy500: 0.4309 - val_loss: 3.4960 - val_accuracy500: 0.3163 - 11s/epoch - 22ms/step
Epoch 12/50
494/494 - 11s - loss: 3.1913 - accuracy500: 0.4303 - val_loss: 3.5356 - val_accuracy500: 0.3265 - 11s/epoch - 22ms/step
Epoch 13/50
494/494 - 11s - loss: 3.1847 - accuracy500: 0.4339 - val_loss: 3.5143 - val_accuracy500: 0.3188 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h500
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060474
{'0': {'precision': 0.3374106740487993, 'recall': 0.04389300190948377, 'f1-score': 0.07768069543564775, 'support': 119404}, '1': {'precision': 0.3532723398412271, 'recall': 0.5504576251040058, 'f1-score': 0.4303530053155241, 'support': 126195}, '2': {'precision': 0.3339680679654314, 'recall': 0.4243130401009807, 'f1-score': 0.3737585038256079, 'support': 123588}, 'accuracy': 0.3443945751069241, 'macro avg': {'precision': 0.3415503606184859, 'recall': 0.3395545557048234, 'f1-score': 0.29393073485892657, 'support': 369187}, 'weighted avg': {'precision': 0.34168005003994784, 'recall': 0.3443945751069241, 'f1-score': 0.2973448394293132, 'support': 369187}}
[[ 5241 61017 53146]
 [ 5295 69465 51435]
 [ 4997 66151 52440]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124638
{'0': {'precision': 0.3301158301158301, 'recall': 0.029251484567825812, 'f1-score': 0.053740992659438346, 'support': 40921}, '1': {'precision': 0.33407298569672256, 'recall': 0.7985425875044797, 'f1-score': 0.47107158461473414, 'support': 41855}, '2': {'precision': 0.3484681020381096, 'recall': 0.1811287802187701, 'f1-score': 0.23836092840402207, 'support': 43516}, 'accuracy': 0.3365375479048554, 'macro avg': {'precision': 0.33755230595022073, 'recall': 0.33630761743035853, 'f1-score': 0.2543911685593982, 'support': 126292}, 'weighted avg': {'precision': 0.33775086805812393, 'recall': 0.3365375479048554, 'f1-score': 0.25566425818813543, 'support': 126292}}
[[ 1197 32270  7454]
 [ 1149 33423  7283]
 [ 1280 34354  7882]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137928
{'0': {'precision': 0.3322354878550844, 'recall': 0.06612044244162228, 'f1-score': 0.1102911029110291, 'support': 12205}, '1': {'precision': 0.3285673738735542, 'recall': 0.7347084490281635, 'f1-score': 0.4540707509009341, 'support': 12605}, '2': {'precision': 0.34873224478959247, 'recall': 0.19695606537711802, 'f1-score': 0.25173685975755833, 'support': 13338}, 'accuracy': 0.3327828457586243, 'macro avg': {'precision': 0.3365117021727437, 'recall': 0.33259498561563455, 'f1-score': 0.2720329045231738, 'support': 38148}, 'weighted avg': {'precision': 0.3367913536214491, 'recall': 0.3327828457586243, 'f1-score': 0.2733388634156888, 'support': 38148}}
[[ 807 9061 2337]
 [ 775 9261 2569]
 [ 847 9864 2627]]
training model: results/PCAR/W8/deepLOB_L1/h1000
Epoch 1/50
494/494 - 13s - loss: 3.3202 - accuracy1000: 0.3724 - val_loss: 3.4193 - val_accuracy1000: 0.3511 - 13s/epoch - 27ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2764 - accuracy1000: 0.3859 - val_loss: 3.5137 - val_accuracy1000: 0.3370 - 11s/epoch - 23ms/step
Epoch 3/50
494/494 - 11s - loss: 3.2644 - accuracy1000: 0.3919 - val_loss: 3.5007 - val_accuracy1000: 0.3424 - 11s/epoch - 23ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2324 - accuracy1000: 0.4053 - val_loss: 3.5389 - val_accuracy1000: 0.3390 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 11s - loss: 3.2065 - accuracy1000: 0.4187 - val_loss: 3.5611 - val_accuracy1000: 0.3199 - 11s/epoch - 22ms/step
Epoch 6/50
494/494 - 11s - loss: 3.1941 - accuracy1000: 0.4252 - val_loss: 3.6425 - val_accuracy1000: 0.3356 - 11s/epoch - 22ms/step
Epoch 7/50
494/494 - 11s - loss: 3.1825 - accuracy1000: 0.4356 - val_loss: 3.7775 - val_accuracy1000: 0.3258 - 11s/epoch - 22ms/step
Epoch 8/50
494/494 - 11s - loss: 3.1669 - accuracy1000: 0.4410 - val_loss: 3.6952 - val_accuracy1000: 0.3298 - 11s/epoch - 22ms/step
Epoch 9/50
494/494 - 11s - loss: 3.1452 - accuracy1000: 0.4520 - val_loss: 3.7444 - val_accuracy1000: 0.3415 - 11s/epoch - 22ms/step
Epoch 10/50
494/494 - 11s - loss: 3.1345 - accuracy1000: 0.4548 - val_loss: 3.8067 - val_accuracy1000: 0.3402 - 11s/epoch - 22ms/step
Epoch 11/50
494/494 - 11s - loss: 3.1276 - accuracy1000: 0.4558 - val_loss: 3.8141 - val_accuracy1000: 0.3307 - 11s/epoch - 22ms/step
testing model: results/PCAR/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1435354
{'0': {'precision': 0.3064941436193046, 'recall': 0.04006541291905151, 'f1-score': 0.07086697907878597, 'support': 124746}, '1': {'precision': 0.3074307916464303, 'recall': 0.44256088038208, 'f1-score': 0.362822273585011, 'support': 110134}, '2': {'precision': 0.3684681764151963, 'recall': 0.5331591056311287, 'f1-score': 0.43577244678131966, 'support': 134307}, 'accuracy': 0.3395189971477869, 'macro avg': {'precision': 0.3274643705603104, 'recall': 0.3385951329774201, 'f1-score': 0.28982056648170557, 'support': 369187}, 'weighted avg': {'precision': 0.3293191705474935, 'recall': 0.3395189971477869, 'f1-score': 0.2907110230344853, 'support': 369187}}
[[ 4998 52198 67550]
 [ 6213 48741 55180]
 [ 5096 57604 71607]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120197
{'0': {'precision': 0.3240033927056828, 'recall': 0.08507163536485784, 'f1-score': 0.1347601128880527, 'support': 40413}, '1': {'precision': 0.33277885235332044, 'recall': 0.6246248426759609, 'f1-score': 0.4342200461023337, 'support': 41316}, '2': {'precision': 0.37166609845008, 'recall': 0.31802167717613267, 'f1-score': 0.34275763658790237, 'support': 44563}, 'accuracy': 0.3437826624014189, 'macro avg': {'precision': 0.34281611450302774, 'recall': 0.34257271840565046, 'f1-score': 0.30391259852609626, 'support': 126292}, 'weighted avg': {'precision': 0.34369236783387275, 'recall': 0.3437826624014189, 'f1-score': 0.3061207711191175, 'support': 126292}}
[[ 3438 24953 12022]
 [ 3572 25807 11937]
 [ 3601 26790 14172]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13795
{'0': {'precision': 0.3268683734160848, 'recall': 0.10027766759222531, 'f1-score': 0.15347255949490046, 'support': 12605}, '1': {'precision': 0.33174359847839663, 'recall': 0.49935902914280833, 'f1-score': 0.3986491096404448, 'support': 11701}, '2': {'precision': 0.36909047276217904, 'recall': 0.4444444444444444, 'f1-score': 0.4032776138970829, 'support': 13842}, 'accuracy': 0.34756736919366676, 'macro avg': {'precision': 0.34256748155222017, 'recall': 0.34802704705982607, 'f1-score': 0.318466427677476, 'support': 38148}, 'weighted avg': {'precision': 0.34368402056934966, 'recall': 0.34756736919366676, 'f1-score': 0.3193164405971345, 'support': 38148}}
[[1264 5548 5793]
 [1135 5843 4723]
 [1468 6222 6152]]
training model: results/PCAR/W8/deepOF_L1/h10
Epoch 1/50
494/494 - 13s - loss: 3.2748 - accuracy10: 0.3876 - val_loss: 3.2802 - val_accuracy10: 0.3963 - 13s/epoch - 25ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2394 - accuracy10: 0.4052 - val_loss: 3.2652 - val_accuracy10: 0.3977 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2211 - accuracy10: 0.4124 - val_loss: 3.2559 - val_accuracy10: 0.4033 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2072 - accuracy10: 0.4174 - val_loss: 3.2509 - val_accuracy10: 0.4061 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.1967 - accuracy10: 0.4200 - val_loss: 3.2520 - val_accuracy10: 0.4066 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.1857 - accuracy10: 0.4245 - val_loss: 3.2485 - val_accuracy10: 0.4054 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.1805 - accuracy10: 0.4262 - val_loss: 3.2453 - val_accuracy10: 0.4098 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.1760 - accuracy10: 0.4266 - val_loss: 3.2442 - val_accuracy10: 0.4079 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.1716 - accuracy10: 0.4284 - val_loss: 3.2465 - val_accuracy10: 0.4064 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.1673 - accuracy10: 0.4300 - val_loss: 3.2449 - val_accuracy10: 0.4081 - 10s/epoch - 20ms/step
Epoch 11/50
494/494 - 10s - loss: 3.1621 - accuracy10: 0.4328 - val_loss: 3.2422 - val_accuracy10: 0.4093 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.1581 - accuracy10: 0.4326 - val_loss: 3.2437 - val_accuracy10: 0.4074 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.1554 - accuracy10: 0.4359 - val_loss: 3.2415 - val_accuracy10: 0.4082 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.1538 - accuracy10: 0.4355 - val_loss: 3.2408 - val_accuracy10: 0.4078 - 10s/epoch - 20ms/step
Epoch 15/50
494/494 - 10s - loss: 3.1481 - accuracy10: 0.4363 - val_loss: 3.2461 - val_accuracy10: 0.4089 - 10s/epoch - 20ms/step
Epoch 16/50
494/494 - 10s - loss: 3.1464 - accuracy10: 0.4364 - val_loss: 3.2410 - val_accuracy10: 0.4109 - 10s/epoch - 20ms/step
Epoch 17/50
494/494 - 10s - loss: 3.1423 - accuracy10: 0.4387 - val_loss: 3.2441 - val_accuracy10: 0.4112 - 10s/epoch - 20ms/step
Epoch 18/50
494/494 - 10s - loss: 3.1395 - accuracy10: 0.4398 - val_loss: 3.2467 - val_accuracy10: 0.4060 - 10s/epoch - 20ms/step
Epoch 19/50
494/494 - 10s - loss: 3.1370 - accuracy10: 0.4405 - val_loss: 3.2481 - val_accuracy10: 0.4077 - 10s/epoch - 20ms/step
Epoch 20/50
494/494 - 10s - loss: 3.1350 - accuracy10: 0.4412 - val_loss: 3.2428 - val_accuracy10: 0.4082 - 10s/epoch - 21ms/step
Epoch 21/50
494/494 - 10s - loss: 3.1321 - accuracy10: 0.4430 - val_loss: 3.2438 - val_accuracy10: 0.4105 - 10s/epoch - 20ms/step
Epoch 22/50
494/494 - 10s - loss: 3.1306 - accuracy10: 0.4428 - val_loss: 3.2439 - val_accuracy10: 0.4102 - 10s/epoch - 21ms/step
Epoch 23/50
494/494 - 10s - loss: 3.1282 - accuracy10: 0.4447 - val_loss: 3.2461 - val_accuracy10: 0.4089 - 10s/epoch - 20ms/step
Epoch 24/50
494/494 - 10s - loss: 3.1257 - accuracy10: 0.4448 - val_loss: 3.2504 - val_accuracy10: 0.4111 - 10s/epoch - 20ms/step
testing model: results/PCAR/W8/deepOF_L1/h10
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083696
{'0': {'precision': 0.41543034015057595, 'recall': 0.4135155234834059, 'f1-score': 0.4144707202594998, 'support': 122363}, '1': {'precision': 0.39458959866339627, 'recall': 0.44691113473121397, 'f1-score': 0.4191237827694143, 'support': 124188}, '2': {'precision': 0.4152518551832696, 'recall': 0.3614012770017369, 'f1-score': 0.38645965495140805, 'support': 122631}, 'accuracy': 0.4074386075160761, 'macro avg': {'precision': 0.4084239313324139, 'recall': 0.40727597840545227, 'f1-score': 0.406684719326774, 'support': 369182}, 'weighted avg': {'precision': 0.40836049981752714, 'recall': 0.4074386075160761, 'f1-score': 0.4067315281460833, 'support': 369182}}
[[50599 41422 30342]
 [36620 55501 32067]
 [34580 43732 44319]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0656542
{'0': {'precision': 0.43467261904761906, 'recall': 0.4154163407523288, 'f1-score': 0.42482638257644617, 'support': 42189}, '1': {'precision': 0.4028857058848238, 'recall': 0.4610522267887615, 'f1-score': 0.4300108718799386, 'support': 41607}, '2': {'precision': 0.4417937687394082, 'recall': 0.3987715623749794, 'f1-score': 0.4191816742529191, 'support': 42493}, 'accuracy': 0.424850937136251, 'macro avg': {'precision': 0.426450697890617, 'recall': 0.4250800433053566, 'f1-score': 0.4246729762364346, 'support': 126289}, 'weighted avg': {'precision': 0.42659623011341874, 'recall': 0.424850937136251, 'f1-score': 0.4246351581282264, 'support': 126289}}
[[17526 14144 10519]
 [11533 19183 10891]
 [11261 14287 16945]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807916
{'0': {'precision': 0.4178344946371252, 'recall': 0.41117103235747304, 'f1-score': 0.41447598338057706, 'support': 12980}, '1': {'precision': 0.3909937215847586, 'recall': 0.42775935575556606, 'f1-score': 0.4085510688836104, 'support': 12666}, '2': {'precision': 0.42168779301962145, 'recall': 0.3884978403455447, 'f1-score': 0.4044129891756869, 'support': 12502}, 'accuracy': 0.4092481912551117, 'macro avg': {'precision': 0.4101720030805018, 'recall': 0.40914274281952795, 'f1-score': 0.4091466804799581, 'support': 38148}, 'weighted avg': {'precision': 0.41018556690557156, 'recall': 0.4092481912551117, 'f1-score': 0.4092108968604943, 'support': 38148}}
[[5337 4295 3348]
 [3935 5418 3313]
 [3501 4144 4857]]
training model: results/PCAR/W8/deepOF_L1/h20
Epoch 1/50
494/494 - 12s - loss: 3.2861 - accuracy20: 0.3793 - val_loss: 3.2830 - val_accuracy20: 0.3814 - 12s/epoch - 24ms/step
Epoch 2/50
494/494 - 10s - loss: 3.2488 - accuracy20: 0.3969 - val_loss: 3.2686 - val_accuracy20: 0.3863 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2386 - accuracy20: 0.4012 - val_loss: 3.2590 - val_accuracy20: 0.3916 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2259 - accuracy20: 0.4059 - val_loss: 3.2567 - val_accuracy20: 0.3919 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2147 - accuracy20: 0.4106 - val_loss: 3.2548 - val_accuracy20: 0.3956 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2066 - accuracy20: 0.4132 - val_loss: 3.2506 - val_accuracy20: 0.3951 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2007 - accuracy20: 0.4147 - val_loss: 3.2492 - val_accuracy20: 0.4004 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.1972 - accuracy20: 0.4168 - val_loss: 3.2485 - val_accuracy20: 0.3981 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.1925 - accuracy20: 0.4183 - val_loss: 3.2473 - val_accuracy20: 0.4005 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.1902 - accuracy20: 0.4177 - val_loss: 3.2455 - val_accuracy20: 0.4006 - 10s/epoch - 20ms/step
Epoch 11/50
494/494 - 10s - loss: 3.1840 - accuracy20: 0.4210 - val_loss: 3.2432 - val_accuracy20: 0.4011 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.1825 - accuracy20: 0.4229 - val_loss: 3.2445 - val_accuracy20: 0.4007 - 10s/epoch - 20ms/step
Epoch 13/50
494/494 - 10s - loss: 3.1783 - accuracy20: 0.4236 - val_loss: 3.2424 - val_accuracy20: 0.4002 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.1768 - accuracy20: 0.4243 - val_loss: 3.2472 - val_accuracy20: 0.3986 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.1733 - accuracy20: 0.4261 - val_loss: 3.2460 - val_accuracy20: 0.3999 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.1702 - accuracy20: 0.4280 - val_loss: 3.2489 - val_accuracy20: 0.4021 - 10s/epoch - 20ms/step
Epoch 17/50
494/494 - 10s - loss: 3.1674 - accuracy20: 0.4279 - val_loss: 3.2471 - val_accuracy20: 0.3996 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.1653 - accuracy20: 0.4283 - val_loss: 3.2473 - val_accuracy20: 0.3995 - 10s/epoch - 20ms/step
Epoch 19/50
494/494 - 10s - loss: 3.1627 - accuracy20: 0.4308 - val_loss: 3.2489 - val_accuracy20: 0.3982 - 10s/epoch - 20ms/step
Epoch 20/50
494/494 - 10s - loss: 3.1605 - accuracy20: 0.4310 - val_loss: 3.2508 - val_accuracy20: 0.4009 - 10s/epoch - 21ms/step
Epoch 21/50
494/494 - 10s - loss: 3.1584 - accuracy20: 0.4339 - val_loss: 3.2473 - val_accuracy20: 0.4020 - 10s/epoch - 21ms/step
Epoch 22/50
494/494 - 10s - loss: 3.1558 - accuracy20: 0.4332 - val_loss: 3.2531 - val_accuracy20: 0.3996 - 10s/epoch - 21ms/step
Epoch 23/50
494/494 - 10s - loss: 3.1560 - accuracy20: 0.4336 - val_loss: 3.2489 - val_accuracy20: 0.4009 - 10s/epoch - 21ms/step
testing model: results/PCAR/W8/deepOF_L1/h20
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879285
{'0': {'precision': 0.40504325891888854, 'recall': 0.4204342677984757, 'f1-score': 0.4125952808611794, 'support': 119926}, '1': {'precision': 0.3701117204625276, 'recall': 0.3562302449430976, 'f1-score': 0.3630383348786649, 'support': 127499}, '2': {'precision': 0.4036989063960256, 'recall': 0.4044449189779643, 'f1-score': 0.4040715683579567, 'support': 121757}, 'accuracy': 0.39298774046405294, 'macro avg': {'precision': 0.39295129525914724, 'recall': 0.39370314390651256, 'f1-score': 0.39323506136593367, 'support': 369182}, 'weighted avg': {'precision': 0.3925360929363277, 'recall': 0.39298774046405294, 'f1-score': 0.3926693832847009, 'support': 369182}}
[[50421 37660 31845]
 [41187 45419 40893]
 [32875 39638 49244]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0676538
{'0': {'precision': 0.4228460967879701, 'recall': 0.4494994145898545, 'f1-score': 0.43576557794764886, 'support': 41851}, '1': {'precision': 0.38819938962360123, 'recall': 0.3657011428160713, 'f1-score': 0.37661456469978655, 'support': 41739}, '2': {'precision': 0.43542843691148775, 'recall': 0.4331951567952411, 'f1-score': 0.4343089259089682, 'support': 42699}, 'accuracy': 0.41629120509308015, 'macro avg': {'precision': 0.415491307774353, 'recall': 0.41613190473372236, 'f1-score': 0.41556302285213453, 'support': 126289}, 'weighted avg': {'precision': 0.41564938472754115, 'recall': 0.41629120509308015, 'f1-score': 0.4157234386690723, 'support': 126289}}
[[18812 11878 11161]
 [13653 15264 12822]
 [12024 12178 18497]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0807556
{'0': {'precision': 0.41527949407574327, 'recall': 0.44744674185463656, 'f1-score': 0.4307634307257305, 'support': 12768}, '1': {'precision': 0.37388724035608306, 'recall': 0.328125, 'f1-score': 0.3495145631067961, 'support': 13056}, '2': {'precision': 0.4051650815742674, 'recall': 0.4251866277182733, 'f1-score': 0.41493447361127606, 'support': 12324}, 'accuracy': 0.39941805599245045, 'macro avg': {'precision': 0.3981106053353645, 'recall': 0.4002527898576367, 'f1-score': 0.3984041558146009, 'support': 38148}, 'weighted avg': {'precision': 0.3978456237750179, 'recall': 0.39941805599245045, 'f1-score': 0.3978426673014004, 'support': 38148}}
[[5713 3567 3488]
 [4567 4284 4205]
 [3477 3607 5240]]
training model: results/PCAR/W8/deepOF_L1/h30
Epoch 1/50
494/494 - 13s - loss: 3.2889 - accuracy30: 0.3771 - val_loss: 3.2896 - val_accuracy30: 0.3794 - 13s/epoch - 26ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2532 - accuracy30: 0.3920 - val_loss: 3.2762 - val_accuracy30: 0.3826 - 11s/epoch - 22ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2397 - accuracy30: 0.3977 - val_loss: 3.2668 - val_accuracy30: 0.3851 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2272 - accuracy30: 0.4044 - val_loss: 3.2672 - val_accuracy30: 0.3880 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2189 - accuracy30: 0.4068 - val_loss: 3.2650 - val_accuracy30: 0.3895 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2122 - accuracy30: 0.4103 - val_loss: 3.2634 - val_accuracy30: 0.3870 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2054 - accuracy30: 0.4112 - val_loss: 3.2607 - val_accuracy30: 0.3887 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2015 - accuracy30: 0.4131 - val_loss: 3.2599 - val_accuracy30: 0.3894 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.1965 - accuracy30: 0.4152 - val_loss: 3.2568 - val_accuracy30: 0.3927 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.1927 - accuracy30: 0.4173 - val_loss: 3.2563 - val_accuracy30: 0.3929 - 10s/epoch - 21ms/step
Epoch 11/50
494/494 - 10s - loss: 3.1899 - accuracy30: 0.4186 - val_loss: 3.2570 - val_accuracy30: 0.3896 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.1863 - accuracy30: 0.4204 - val_loss: 3.2581 - val_accuracy30: 0.3931 - 10s/epoch - 20ms/step
Epoch 13/50
494/494 - 10s - loss: 3.1845 - accuracy30: 0.4209 - val_loss: 3.2580 - val_accuracy30: 0.3911 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.1825 - accuracy30: 0.4219 - val_loss: 3.2559 - val_accuracy30: 0.3933 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.1804 - accuracy30: 0.4250 - val_loss: 3.2562 - val_accuracy30: 0.3925 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.1774 - accuracy30: 0.4243 - val_loss: 3.2568 - val_accuracy30: 0.3952 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.1747 - accuracy30: 0.4266 - val_loss: 3.2577 - val_accuracy30: 0.3928 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.1727 - accuracy30: 0.4263 - val_loss: 3.2590 - val_accuracy30: 0.3916 - 10s/epoch - 20ms/step
Epoch 19/50
494/494 - 10s - loss: 3.1707 - accuracy30: 0.4277 - val_loss: 3.2598 - val_accuracy30: 0.3912 - 10s/epoch - 20ms/step
Epoch 20/50
494/494 - 10s - loss: 3.1668 - accuracy30: 0.4294 - val_loss: 3.2614 - val_accuracy30: 0.3901 - 10s/epoch - 21ms/step
Epoch 21/50
494/494 - 10s - loss: 3.1653 - accuracy30: 0.4297 - val_loss: 3.2636 - val_accuracy30: 0.3940 - 10s/epoch - 21ms/step
Epoch 22/50
494/494 - 10s - loss: 3.1627 - accuracy30: 0.4306 - val_loss: 3.2628 - val_accuracy30: 0.3926 - 10s/epoch - 21ms/step
Epoch 23/50
494/494 - 10s - loss: 3.1607 - accuracy30: 0.4314 - val_loss: 3.2605 - val_accuracy30: 0.3902 - 10s/epoch - 21ms/step
Epoch 24/50
494/494 - 10s - loss: 3.1584 - accuracy30: 0.4340 - val_loss: 3.2683 - val_accuracy30: 0.3908 - 10s/epoch - 20ms/step
testing model: results/PCAR/W8/deepOF_L1/h30
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.091968
{'0': {'precision': 0.3943709986432034, 'recall': 0.4777842941278508, 'f1-score': 0.4320888052231336, 'support': 121063}, '1': {'precision': 0.3462808006055, 'recall': 0.2667589848241906, 'f1-score': 0.3013622183391732, 'support': 123486}, '2': {'precision': 0.39748793029006557, 'recall': 0.40626479343352084, 'f1-score': 0.40182844082565533, 'support': 124633}, 'accuracy': 0.38305497017731094, 'macro avg': {'precision': 0.3793799098462563, 'recall': 0.38360269079518744, 'f1-score': 0.3784264881293207, 'support': 369182}, 'weighted avg': {'precision': 0.37933778019555303, 'recall': 0.38305497017731094, 'f1-score': 0.37814700062837103, 'support': 369182}}
[[57842 28773 34448]
 [48242 32941 42303]
 [40585 33414 50634]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0695817
{'0': {'precision': 0.41685704960835507, 'recall': 0.48952020504467386, 'f1-score': 0.4502759691972106, 'support': 41747}, '1': {'precision': 0.3949616648411829, 'recall': 0.2586615020443297, 'f1-score': 0.3126002340600754, 'support': 41823}, '2': {'precision': 0.42237593984962407, 'recall': 0.49312952082211664, 'f1-score': 0.4550186837160075, 'support': 42719}, 'accuracy': 0.41428786355106145, 'macro avg': {'precision': 0.41139821809972066, 'recall': 0.41377040930370673, 'f1-score': 0.4059649623244312, 'support': 126289}, 'weighted avg': {'precision': 0.4114728181638059, 'recall': 0.41428786355106145, 'f1-score': 0.406286324421245, 'support': 126289}}
[[20436  7985 13326]
 [15522 10818 15483]
 [13066  8587 21066]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850383
{'0': {'precision': 0.410112004049864, 'recall': 0.5034959602237414, 'f1-score': 0.4520313862249346, 'support': 12872}, '1': {'precision': 0.364127174565087, 'recall': 0.23705381551198937, 'f1-score': 0.2871605639133314, 'support': 12803}, '2': {'precision': 0.3945753033547466, 'recall': 0.4431973061813517, 'f1-score': 0.4174753615526942, 'support': 12473}, 'accuracy': 0.39435881304393416, 'macro avg': {'precision': 0.3896048273232325, 'recall': 0.3945823606390275, 'f1-score': 0.3855557705636534, 'support': 38148}, 'weighted avg': {'precision': 0.38959892237680643, 'recall': 0.39435881304393416, 'f1-score': 0.38539988696436234, 'support': 38148}}
[[6481 2520 3871]
 [5157 3035 4611]
 [4165 2780 5528]]
training model: results/PCAR/W8/deepOF_L1/h50
Epoch 1/50
494/494 - 12s - loss: 3.2979 - accuracy50: 0.3713 - val_loss: 3.3049 - val_accuracy50: 0.3613 - 12s/epoch - 25ms/step
Epoch 2/50
494/494 - 10s - loss: 3.2577 - accuracy50: 0.3878 - val_loss: 3.2888 - val_accuracy50: 0.3651 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2440 - accuracy50: 0.3913 - val_loss: 3.2774 - val_accuracy50: 0.3728 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2333 - accuracy50: 0.3952 - val_loss: 3.2733 - val_accuracy50: 0.3764 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2238 - accuracy50: 0.4005 - val_loss: 3.2750 - val_accuracy50: 0.3745 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2193 - accuracy50: 0.4021 - val_loss: 3.2719 - val_accuracy50: 0.3782 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2142 - accuracy50: 0.4048 - val_loss: 3.2698 - val_accuracy50: 0.3756 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2103 - accuracy50: 0.4064 - val_loss: 3.2712 - val_accuracy50: 0.3788 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2056 - accuracy50: 0.4084 - val_loss: 3.2704 - val_accuracy50: 0.3778 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2043 - accuracy50: 0.4088 - val_loss: 3.2687 - val_accuracy50: 0.3768 - 10s/epoch - 21ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2007 - accuracy50: 0.4108 - val_loss: 3.2691 - val_accuracy50: 0.3775 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.1978 - accuracy50: 0.4121 - val_loss: 3.2689 - val_accuracy50: 0.3785 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.1948 - accuracy50: 0.4157 - val_loss: 3.2690 - val_accuracy50: 0.3762 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.1924 - accuracy50: 0.4166 - val_loss: 3.2726 - val_accuracy50: 0.3777 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.1897 - accuracy50: 0.4171 - val_loss: 3.2734 - val_accuracy50: 0.3749 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.1874 - accuracy50: 0.4188 - val_loss: 3.2742 - val_accuracy50: 0.3757 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.1847 - accuracy50: 0.4200 - val_loss: 3.2718 - val_accuracy50: 0.3771 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.1825 - accuracy50: 0.4217 - val_loss: 3.2706 - val_accuracy50: 0.3774 - 10s/epoch - 21ms/step
Epoch 19/50
494/494 - 10s - loss: 3.1804 - accuracy50: 0.4233 - val_loss: 3.2741 - val_accuracy50: 0.3739 - 10s/epoch - 21ms/step
Epoch 20/50
494/494 - 10s - loss: 3.1766 - accuracy50: 0.4245 - val_loss: 3.2747 - val_accuracy50: 0.3746 - 10s/epoch - 21ms/step
testing model: results/PCAR/W8/deepOF_L1/h50
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0975411
{'0': {'precision': 0.38110882620415054, 'recall': 0.3862960686940491, 'f1-score': 0.38368491597071863, 'support': 120418}, '1': {'precision': 0.3440576766563673, 'recall': 0.3815556159044074, 'f1-score': 0.36183774489567905, 'support': 125198}, '2': {'precision': 0.3892798433719362, 'recall': 0.34112943690011815, 'f1-score': 0.3636175425278631, 'support': 123566}, 'accuracy': 0.36957110585023106, 'macro avg': {'precision': 0.37148211541081805, 'recall': 0.36966037383285816, 'f1-score': 0.36971340113142026, 'support': 369182}, 'weighted avg': {'precision': 0.371278796804752, 'recall': 0.36957110585023106, 'f1-score': 0.3695594515897556, 'support': 369182}}
[[46517 43686 30215]
 [41513 47770 35915]
 [34027 47387 42152]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0742441
{'0': {'precision': 0.40434255894138477, 'recall': 0.41651067914566836, 'f1-score': 0.4103364304797031, 'support': 41670}, '1': {'precision': 0.38077945990180034, 'recall': 0.3552512287063988, 'f1-score': 0.3675726381791701, 'support': 41914}, '2': {'precision': 0.41180723435982014, 'recall': 0.42681184872965694, 'f1-score': 0.41917530989122187, 'support': 42705}, 'accuracy': 0.3996626784597233, 'macro avg': {'precision': 0.39897641773433506, 'recall': 0.39952458552724135, 'f1-score': 0.39902812618336503, 'support': 126289}, 'weighted avg': {'precision': 0.3990464146263545, 'recall': 0.3996626784597233, 'f1-score': 0.3991324677813238, 'support': 126289}}
[[17356 11794 12520]
 [13510 14890 13514]
 [12058 12420 18227]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892549
{'0': {'precision': 0.39101289134438305, 'recall': 0.4233530068591482, 'f1-score': 0.40654080343124116, 'support': 12538}, '1': {'precision': 0.3633316574493045, 'recall': 0.325647765677807, 'f1-score': 0.3434591468969068, 'support': 13315}, '2': {'precision': 0.381201044386423, 'recall': 0.39186661244408294, 'f1-score': 0.38646025507339377, 'support': 12295}, 'accuracy': 0.37910244311628394, 'macro avg': {'precision': 0.37851519772670345, 'recall': 0.3802891283270127, 'f1-score': 0.3788200684671806, 'support': 38148}, 'weighted avg': {'precision': 0.37818883011807786, 'recall': 0.37910244311628394, 'f1-score': 0.37805116835694114, 'support': 38148}}
[[5308 3689 3541]
 [4699 4336 4280]
 [3568 3909 4818]]
training model: results/PCAR/W8/deepOF_L1/h100
Epoch 1/50
494/494 - 13s - loss: 3.3112 - accuracy100: 0.3639 - val_loss: 3.3216 - val_accuracy100: 0.3483 - 13s/epoch - 26ms/step
Epoch 2/50
494/494 - 10s - loss: 3.2888 - accuracy100: 0.3673 - val_loss: 3.3072 - val_accuracy100: 0.3531 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2716 - accuracy100: 0.3729 - val_loss: 3.3000 - val_accuracy100: 0.3530 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2580 - accuracy100: 0.3793 - val_loss: 3.2966 - val_accuracy100: 0.3563 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2533 - accuracy100: 0.3812 - val_loss: 3.2948 - val_accuracy100: 0.3562 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2480 - accuracy100: 0.3825 - val_loss: 3.2937 - val_accuracy100: 0.3573 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2429 - accuracy100: 0.3839 - val_loss: 3.2951 - val_accuracy100: 0.3562 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2387 - accuracy100: 0.3885 - val_loss: 3.2945 - val_accuracy100: 0.3577 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2355 - accuracy100: 0.3908 - val_loss: 3.2922 - val_accuracy100: 0.3561 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2322 - accuracy100: 0.3911 - val_loss: 3.2925 - val_accuracy100: 0.3574 - 10s/epoch - 20ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2316 - accuracy100: 0.3930 - val_loss: 3.2932 - val_accuracy100: 0.3581 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.2281 - accuracy100: 0.3945 - val_loss: 3.2926 - val_accuracy100: 0.3563 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.2248 - accuracy100: 0.3968 - val_loss: 3.2932 - val_accuracy100: 0.3583 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.2235 - accuracy100: 0.3983 - val_loss: 3.2909 - val_accuracy100: 0.3563 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.2209 - accuracy100: 0.4008 - val_loss: 3.2920 - val_accuracy100: 0.3563 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.2187 - accuracy100: 0.4015 - val_loss: 3.2912 - val_accuracy100: 0.3559 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.2173 - accuracy100: 0.4024 - val_loss: 3.2901 - val_accuracy100: 0.3579 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.2171 - accuracy100: 0.4023 - val_loss: 3.2901 - val_accuracy100: 0.3606 - 10s/epoch - 21ms/step
Epoch 19/50
494/494 - 10s - loss: 3.2131 - accuracy100: 0.4049 - val_loss: 3.2935 - val_accuracy100: 0.3595 - 10s/epoch - 21ms/step
Epoch 20/50
494/494 - 10s - loss: 3.2114 - accuracy100: 0.4056 - val_loss: 3.2954 - val_accuracy100: 0.3578 - 10s/epoch - 20ms/step
Epoch 21/50
494/494 - 10s - loss: 3.2098 - accuracy100: 0.4055 - val_loss: 3.2919 - val_accuracy100: 0.3566 - 10s/epoch - 20ms/step
Epoch 22/50
494/494 - 10s - loss: 3.2085 - accuracy100: 0.4069 - val_loss: 3.2923 - val_accuracy100: 0.3566 - 10s/epoch - 20ms/step
Epoch 23/50
494/494 - 10s - loss: 3.2067 - accuracy100: 0.4080 - val_loss: 3.2936 - val_accuracy100: 0.3593 - 10s/epoch - 21ms/step
Epoch 24/50
494/494 - 10s - loss: 3.2046 - accuracy100: 0.4087 - val_loss: 3.2931 - val_accuracy100: 0.3578 - 10s/epoch - 20ms/step
Epoch 25/50
494/494 - 10s - loss: 3.2024 - accuracy100: 0.4116 - val_loss: 3.2954 - val_accuracy100: 0.3603 - 10s/epoch - 21ms/step
Epoch 26/50
494/494 - 10s - loss: 3.2007 - accuracy100: 0.4123 - val_loss: 3.2952 - val_accuracy100: 0.3597 - 10s/epoch - 21ms/step
Epoch 27/50
494/494 - 10s - loss: 3.1987 - accuracy100: 0.4138 - val_loss: 3.2945 - val_accuracy100: 0.3605 - 10s/epoch - 20ms/step
testing model: results/PCAR/W8/deepOF_L1/h100
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1001129
{'0': {'precision': 0.3679669277302638, 'recall': 0.16464299350897288, 'f1-score': 0.22749548620067062, 'support': 117855}, '1': {'precision': 0.35311825718666306, 'recall': 0.6760889393045197, 'f1-score': 0.4639286409273313, 'support': 130471}, '2': {'precision': 0.36977463013534195, 'recall': 0.2039120937313828, 'f1-score': 0.26286652942368616, 'support': 120856}, 'accuracy': 0.3582460683348592, 'macro avg': {'precision': 0.3636199383507563, 'recall': 0.34821467551495844, 'f1-score': 0.31809688551722937, 'support': 369182}, 'weighted avg': {'precision': 0.36331109615498114, 'recall': 0.3582460683348592, 'f1-score': 0.3226314162571276, 'support': 369182}}
[[19404 79988 18463]
 [18722 88210 23539]
 [14607 81605 24644]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0850232
{'0': {'precision': 0.4060844479412536, 'recall': 0.1859225282774189, 'f1-score': 0.25506539716008303, 'support': 41641}, '1': {'precision': 0.3434288291281954, 'recall': 0.6959763342071719, 'f1-score': 0.4599137006222137, 'support': 41579}, '2': {'precision': 0.41272537235432455, 'recall': 0.2200422577724117, 'f1-score': 0.2870469930790084, 'support': 43069}, 'accuracy': 0.36548709705516713, 'macro avg': {'precision': 0.3874128831412578, 'recall': 0.36731370675233416, 'f1-score': 0.33400869695376834, 'support': 126289}, 'weighted avg': {'precision': 0.3877206949534115, 'recall': 0.36548709705516713, 'f1-score': 0.33341587079028145, 'support': 126289}}
[[ 7742 27208  6691]
 [ 5847 28938  6794]
 [ 5476 28116  9477]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965962
{'0': {'precision': 0.39413177762525736, 'recall': 0.18392185122908158, 'f1-score': 0.2508052628705574, 'support': 12489}, '1': {'precision': 0.34488442211055276, 'recall': 0.6538373599573203, 'f1-score': 0.4515738498789346, 'support': 13121}, '2': {'precision': 0.3822699798522498, 'recall': 0.226989950550327, 'f1-score': 0.2848421157984287, 'support': 12538}, 'accuracy': 0.35970430953129917, 'macro avg': {'precision': 0.3737620598626867, 'recall': 0.3549163872455763, 'f1-score': 0.3290737428493069, 'support': 38148}, 'weighted avg': {'precision': 0.37329457063704286, 'recall': 0.35970430953129917, 'f1-score': 0.3310463945719983, 'support': 38148}}
[[2297 8132 2060]
 [2003 8579 2539]
 [1528 8164 2846]]
training model: results/PCAR/W8/deepOF_L1/h200
Epoch 1/50
494/494 - 12s - loss: 3.3272 - accuracy200: 0.3499 - val_loss: 3.3358 - val_accuracy200: 0.3372 - 12s/epoch - 25ms/step
Epoch 2/50
494/494 - 11s - loss: 3.2969 - accuracy200: 0.3562 - val_loss: 3.3164 - val_accuracy200: 0.3371 - 11s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2869 - accuracy200: 0.3595 - val_loss: 3.3097 - val_accuracy200: 0.3389 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 11s - loss: 3.2760 - accuracy200: 0.3643 - val_loss: 3.3059 - val_accuracy200: 0.3396 - 11s/epoch - 22ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2690 - accuracy200: 0.3659 - val_loss: 3.3081 - val_accuracy200: 0.3400 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2648 - accuracy200: 0.3692 - val_loss: 3.3084 - val_accuracy200: 0.3417 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2606 - accuracy200: 0.3701 - val_loss: 3.3055 - val_accuracy200: 0.3392 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2569 - accuracy200: 0.3724 - val_loss: 3.3080 - val_accuracy200: 0.3384 - 10s/epoch - 20ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2535 - accuracy200: 0.3764 - val_loss: 3.3085 - val_accuracy200: 0.3412 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2517 - accuracy200: 0.3778 - val_loss: 3.3070 - val_accuracy200: 0.3396 - 10s/epoch - 20ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2491 - accuracy200: 0.3787 - val_loss: 3.3092 - val_accuracy200: 0.3363 - 10s/epoch - 20ms/step
Epoch 12/50
494/494 - 10s - loss: 3.2464 - accuracy200: 0.3810 - val_loss: 3.3109 - val_accuracy200: 0.3401 - 10s/epoch - 20ms/step
Epoch 13/50
494/494 - 10s - loss: 3.2443 - accuracy200: 0.3826 - val_loss: 3.3132 - val_accuracy200: 0.3362 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.2411 - accuracy200: 0.3838 - val_loss: 3.3138 - val_accuracy200: 0.3391 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.2399 - accuracy200: 0.3865 - val_loss: 3.3150 - val_accuracy200: 0.3372 - 10s/epoch - 20ms/step
Epoch 16/50
494/494 - 10s - loss: 3.2377 - accuracy200: 0.3875 - val_loss: 3.3156 - val_accuracy200: 0.3378 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.2355 - accuracy200: 0.3879 - val_loss: 3.3185 - val_accuracy200: 0.3367 - 10s/epoch - 20ms/step
testing model: results/PCAR/W8/deepOF_L1/h200
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033471
{'0': {'precision': 0.3612043468146622, 'recall': 0.17880467863194432, 'f1-score': 0.23919980633376609, 'support': 121574}, '1': {'precision': 0.3293008354286641, 'recall': 0.665080392172923, 'f1-score': 0.4404981161963713, 'support': 122089}, '2': {'precision': 0.3650913168856136, 'recall': 0.1815581704761829, 'f1-score': 0.24251485854452778, 'support': 125519}, 'accuracy': 0.3405528980286146, 'macro avg': {'precision': 0.35186549970964665, 'recall': 0.34181441376035004, 'f1-score': 0.3074042603582217, 'support': 369182}, 'weighted avg': {'precision': 0.3519753508038346, 'recall': 0.3405528980286146, 'f1-score': 0.30689652879384866, 'support': 369182}}
[[21738 80873 18963]
 [20222 81199 20668]
 [18222 84508 22789]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0906799
{'0': {'precision': 0.37616556743234025, 'recall': 0.15966406834471608, 'f1-score': 0.22417619652689538, 'support': 41437}, '1': {'precision': 0.34163116685309025, 'recall': 0.6897131600442031, 'f1-score': 0.45693277310924363, 'support': 41626}, '2': {'precision': 0.3916798443011799, 'recall': 0.22347661129875537, 'f1-score': 0.2845821856265374, 'support': 43226}, 'accuracy': 0.3562147138705667, 'macro avg': {'precision': 0.3698255261955368, 'recall': 0.3576179465625582, 'f1-score': 0.32189705175422545, 'support': 126289}, 'weighted avg': {'precision': 0.37009291798084887, 'recall': 0.3562147138705667, 'f1-score': 0.32157054236570914, 'support': 126289}}
[[ 6616 27280  7541]
 [ 5454 28710  7462]
 [ 5518 28048  9660]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021994
{'0': {'precision': 0.3660310595635935, 'recall': 0.14669502875600726, 'f1-score': 0.2094488188976378, 'support': 12693}, '1': {'precision': 0.32661086237103365, 'recall': 0.6762595727529223, 'f1-score': 0.440483066421633, 'support': 12405}, '2': {'precision': 0.3686279826464208, 'recall': 0.20835249042145593, 'f1-score': 0.2662293155781847, 'support': 13050}, 'accuracy': 0.3399916116179092, 'macro avg': {'precision': 0.35375663486034936, 'recall': 0.3437690306434618, 'f1-score': 0.3053870669658185, 'support': 38148}, 'weighted avg': {'precision': 0.3541007434279426, 'recall': 0.3399916116179092, 'f1-score': 0.30400070424461, 'support': 38148}}
[[1862 8565 2266]
 [1625 8389 2391]
 [1600 8731 2719]]
training model: results/PCAR/W8/deepOF_L1/h300
Epoch 1/50
494/494 - 12s - loss: 3.3271 - accuracy300: 0.3527 - val_loss: 3.3366 - val_accuracy300: 0.3351 - 12s/epoch - 25ms/step
Epoch 2/50
494/494 - 10s - loss: 3.3001 - accuracy300: 0.3611 - val_loss: 3.3288 - val_accuracy300: 0.3282 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2918 - accuracy300: 0.3642 - val_loss: 3.3260 - val_accuracy300: 0.3303 - 10s/epoch - 20ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2831 - accuracy300: 0.3659 - val_loss: 3.3231 - val_accuracy300: 0.3331 - 10s/epoch - 20ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2759 - accuracy300: 0.3689 - val_loss: 3.3164 - val_accuracy300: 0.3327 - 10s/epoch - 20ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2703 - accuracy300: 0.3702 - val_loss: 3.3153 - val_accuracy300: 0.3318 - 10s/epoch - 20ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2669 - accuracy300: 0.3718 - val_loss: 3.3155 - val_accuracy300: 0.3339 - 10s/epoch - 20ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2623 - accuracy300: 0.3728 - val_loss: 3.3150 - val_accuracy300: 0.3305 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2592 - accuracy300: 0.3735 - val_loss: 3.3135 - val_accuracy300: 0.3336 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2566 - accuracy300: 0.3774 - val_loss: 3.3140 - val_accuracy300: 0.3338 - 10s/epoch - 20ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2532 - accuracy300: 0.3782 - val_loss: 3.3115 - val_accuracy300: 0.3363 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.2518 - accuracy300: 0.3792 - val_loss: 3.3153 - val_accuracy300: 0.3357 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.2483 - accuracy300: 0.3811 - val_loss: 3.3168 - val_accuracy300: 0.3325 - 10s/epoch - 20ms/step
Epoch 14/50
494/494 - 10s - loss: 3.2471 - accuracy300: 0.3822 - val_loss: 3.3159 - val_accuracy300: 0.3332 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.2452 - accuracy300: 0.3850 - val_loss: 3.3164 - val_accuracy300: 0.3326 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.2425 - accuracy300: 0.3852 - val_loss: 3.3223 - val_accuracy300: 0.3314 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.2412 - accuracy300: 0.3862 - val_loss: 3.3212 - val_accuracy300: 0.3315 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.2385 - accuracy300: 0.3894 - val_loss: 3.3182 - val_accuracy300: 0.3339 - 10s/epoch - 21ms/step
Epoch 19/50
494/494 - 10s - loss: 3.2356 - accuracy300: 0.3907 - val_loss: 3.3236 - val_accuracy300: 0.3322 - 10s/epoch - 21ms/step
Epoch 20/50
494/494 - 10s - loss: 3.2352 - accuracy300: 0.3914 - val_loss: 3.3234 - val_accuracy300: 0.3321 - 10s/epoch - 21ms/step
Epoch 21/50
494/494 - 10s - loss: 3.2333 - accuracy300: 0.3935 - val_loss: 3.3292 - val_accuracy300: 0.3335 - 10s/epoch - 21ms/step
testing model: results/PCAR/W8/deepOF_L1/h300
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045951
{'0': {'precision': 0.3402418792527229, 'recall': 0.11722361205454034, 'f1-score': 0.1743711069626453, 'support': 120718}, '1': {'precision': 0.33444314086099924, 'recall': 0.7698408836552966, 'f1-score': 0.4663075755454525, 'support': 123306}, '2': {'precision': 0.3713149595502537, 'recall': 0.12981990763674714, 'f1-score': 0.19237964432025384, 'support': 125158}, 'accuracy': 0.33946671289499486, 'macro avg': {'precision': 0.34866665988799195, 'recall': 0.33896146778219466, 'f1-score': 0.27768610894278384, 'support': 369182}, 'weighted avg': {'precision': 0.348839333483288, 'recall': 0.33946671289499486, 'f1-score': 0.27798241713940147, 'support': 369182}}
[[14151 93331 13236]
 [14106 94926 14274]
 [13334 95576 16248]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981185
{'0': {'precision': 0.3795515326064596, 'recall': 0.08884501480750247, 'f1-score': 0.14398595258999122, 'support': 41533}, '1': {'precision': 0.3292525576811712, 'recall': 0.7884582633871007, 'f1-score': 0.46452426683484793, 'support': 41103}, '2': {'precision': 0.38593009152056457, 'recall': 0.160355531120427, 'f1-score': 0.22657021249049214, 'support': 43653}, 'accuracy': 0.3412648765925773, 'macro avg': {'precision': 0.3649113939360651, 'recall': 0.3458862697716767, 'f1-score': 0.2783601439717771, 'support': 126289}, 'weighted avg': {'precision': 0.36538564694676867, 'recall': 0.3412648765925773, 'f1-score': 0.27685688377040213, 'support': 126289}}
[[ 3690 32399  5444]
 [ 3001 32408  5694]
 [ 3031 33622  7000]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1043104
{'0': {'precision': 0.35624776226279986, 'recall': 0.07912524850894632, 'f1-score': 0.12948984903695993, 'support': 12575}, '1': {'precision': 0.32565844516582443, 'recall': 0.7888933927847588, 'f1-score': 0.4610100435853705, 'support': 12335}, '2': {'precision': 0.37760321519912315, 'recall': 0.15614141108928842, 'f1-score': 0.2209277469003848, 'support': 13238}, 'accuracy': 0.3353517877739331, 'macro avg': {'precision': 0.3531698075425825, 'recall': 0.3413866841276645, 'f1-score': 0.27047587984090504, 'support': 38148}, 'weighted avg': {'precision': 0.3537675341926482, 'recall': 0.3353517877739331, 'f1-score': 0.2684160441630652, 'support': 38148}}
[[  995  9893  1687]
 [  884  9731  1720]
 [  914 10257  2067]]
training model: results/PCAR/W8/deepOF_L1/h500
Epoch 1/50
494/494 - 12s - loss: 3.3301 - accuracy500: 0.3536 - val_loss: 3.3555 - val_accuracy500: 0.3349 - 12s/epoch - 24ms/step
Epoch 2/50
494/494 - 10s - loss: 3.3052 - accuracy500: 0.3636 - val_loss: 3.3422 - val_accuracy500: 0.3358 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.2941 - accuracy500: 0.3661 - val_loss: 3.3380 - val_accuracy500: 0.3339 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2853 - accuracy500: 0.3685 - val_loss: 3.3362 - val_accuracy500: 0.3315 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2798 - accuracy500: 0.3688 - val_loss: 3.3276 - val_accuracy500: 0.3320 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2755 - accuracy500: 0.3687 - val_loss: 3.3270 - val_accuracy500: 0.3332 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2720 - accuracy500: 0.3692 - val_loss: 3.3241 - val_accuracy500: 0.3336 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2683 - accuracy500: 0.3714 - val_loss: 3.3251 - val_accuracy500: 0.3334 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2651 - accuracy500: 0.3707 - val_loss: 3.3209 - val_accuracy500: 0.3350 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2631 - accuracy500: 0.3739 - val_loss: 3.3192 - val_accuracy500: 0.3347 - 10s/epoch - 21ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2600 - accuracy500: 0.3757 - val_loss: 3.3213 - val_accuracy500: 0.3337 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.2571 - accuracy500: 0.3771 - val_loss: 3.3207 - val_accuracy500: 0.3356 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.2548 - accuracy500: 0.3794 - val_loss: 3.3243 - val_accuracy500: 0.3348 - 10s/epoch - 21ms/step
Epoch 14/50
494/494 - 10s - loss: 3.2531 - accuracy500: 0.3804 - val_loss: 3.3251 - val_accuracy500: 0.3336 - 10s/epoch - 21ms/step
Epoch 15/50
494/494 - 10s - loss: 3.2510 - accuracy500: 0.3813 - val_loss: 3.3275 - val_accuracy500: 0.3337 - 10s/epoch - 21ms/step
Epoch 16/50
494/494 - 10s - loss: 3.2493 - accuracy500: 0.3825 - val_loss: 3.3340 - val_accuracy500: 0.3320 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.2457 - accuracy500: 0.3848 - val_loss: 3.3321 - val_accuracy500: 0.3357 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.2452 - accuracy500: 0.3863 - val_loss: 3.3353 - val_accuracy500: 0.3344 - 10s/epoch - 21ms/step
Epoch 19/50
494/494 - 10s - loss: 3.2429 - accuracy500: 0.3879 - val_loss: 3.3382 - val_accuracy500: 0.3343 - 10s/epoch - 20ms/step
Epoch 20/50
494/494 - 10s - loss: 3.2415 - accuracy500: 0.3879 - val_loss: 3.3452 - val_accuracy500: 0.3351 - 10s/epoch - 21ms/step
testing model: results/PCAR/W8/deepOF_L1/h500
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065663
{'0': {'precision': 0.3285294980921632, 'recall': 0.09374136328232958, 'f1-score': 0.14586279019762433, 'support': 119403}, '1': {'precision': 0.34103091743899866, 'recall': 0.857560581327163, 'f1-score': 0.4879972402784072, 'support': 126194}, '2': {'precision': 0.3552831355789237, 'recall': 0.0511227090666343, 'f1-score': 0.08938373606473883, 'support': 123585}, 'accuracy': 0.34056373279303975, 'macro avg': {'precision': 0.34161451703669515, 'recall': 0.33414155122537564, 'f1-score': 0.24108125551359014, 'support': 369182}, 'weighted avg': {'precision': 0.3417586165265827, 'recall': 0.34056373279303975, 'f1-score': 0.2439048152380696, 'support': 369182}}
[[ 11193 102717   5493]
 [ 12003 108219   5972]
 [ 10874 106393   6318]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003625
{'0': {'precision': 0.37374388044318474, 'recall': 0.07079235706093365, 'f1-score': 0.11903736074352188, 'support': 40979}, '1': {'precision': 0.33342779214338847, 'recall': 0.9007655502392344, 'f1-score': 0.48669889609885986, 'support': 41800}, '2': {'precision': 0.3833660538996966, 'recall': 0.049367961388186624, 'f1-score': 0.08747174882414026, 'support': 43510}, 'accuracy': 0.3381212932242713, 'macro avg': {'precision': 0.3635125754954232, 'recall': 0.34030862289611824, 'f1-score': 0.231069335222174, 'support': 126289}, 'weighted avg': {'precision': 0.36371488564681564, 'recall': 0.3381212932242713, 'f1-score': 0.22985328614669107, 'support': 126289}}
[[ 2901 36361  1717]
 [ 2410 37652  1738]
 [ 2451 38911  2148]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078159
{'0': {'precision': 0.339041095890411, 'recall': 0.06485955286217344, 'f1-score': 0.1088884306042483, 'support': 12211}, '1': {'precision': 0.33186244226752565, 'recall': 0.8943237672427462, 'f1-score': 0.48409037269079747, 'support': 12614}, '2': {'precision': 0.3958218801539307, 'recall': 0.05404188245890565, 'f1-score': 0.095099722625809, 'support': 13323}, 'accuracy': 0.3353517877739331, 'macro avg': {'precision': 0.3555751394372891, 'recall': 0.3377417341879418, 'f1-score': 0.22935950864028495, 'support': 38148}, 'weighted avg': {'precision': 0.3564978132004613, 'recall': 0.3353517877739331, 'f1-score': 0.2281368929373453, 'support': 38148}}
[[  792 10888   531]
 [  765 11281   568]
 [  779 11824   720]]
training model: results/PCAR/W8/deepOF_L1/h1000
Epoch 1/50
494/494 - 12s - loss: 3.3430 - accuracy1000: 0.3412 - val_loss: 3.3489 - val_accuracy1000: 0.3358 - 12s/epoch - 24ms/step
Epoch 2/50
494/494 - 10s - loss: 3.3147 - accuracy1000: 0.3470 - val_loss: 3.3343 - val_accuracy1000: 0.3294 - 10s/epoch - 21ms/step
Epoch 3/50
494/494 - 10s - loss: 3.3061 - accuracy1000: 0.3495 - val_loss: 3.3299 - val_accuracy1000: 0.3247 - 10s/epoch - 21ms/step
Epoch 4/50
494/494 - 10s - loss: 3.2970 - accuracy1000: 0.3520 - val_loss: 3.3224 - val_accuracy1000: 0.3217 - 10s/epoch - 21ms/step
Epoch 5/50
494/494 - 10s - loss: 3.2916 - accuracy1000: 0.3534 - val_loss: 3.3255 - val_accuracy1000: 0.3191 - 10s/epoch - 21ms/step
Epoch 6/50
494/494 - 10s - loss: 3.2859 - accuracy1000: 0.3558 - val_loss: 3.3182 - val_accuracy1000: 0.3252 - 10s/epoch - 21ms/step
Epoch 7/50
494/494 - 10s - loss: 3.2833 - accuracy1000: 0.3563 - val_loss: 3.3177 - val_accuracy1000: 0.3231 - 10s/epoch - 21ms/step
Epoch 8/50
494/494 - 10s - loss: 3.2799 - accuracy1000: 0.3587 - val_loss: 3.3206 - val_accuracy1000: 0.3199 - 10s/epoch - 21ms/step
Epoch 9/50
494/494 - 10s - loss: 3.2784 - accuracy1000: 0.3597 - val_loss: 3.3168 - val_accuracy1000: 0.3201 - 10s/epoch - 21ms/step
Epoch 10/50
494/494 - 10s - loss: 3.2758 - accuracy1000: 0.3625 - val_loss: 3.3174 - val_accuracy1000: 0.3205 - 10s/epoch - 21ms/step
Epoch 11/50
494/494 - 10s - loss: 3.2735 - accuracy1000: 0.3628 - val_loss: 3.3192 - val_accuracy1000: 0.3194 - 10s/epoch - 21ms/step
Epoch 12/50
494/494 - 10s - loss: 3.2709 - accuracy1000: 0.3648 - val_loss: 3.3221 - val_accuracy1000: 0.3191 - 10s/epoch - 21ms/step
Epoch 13/50
494/494 - 10s - loss: 3.2682 - accuracy1000: 0.3664 - val_loss: 3.3249 - val_accuracy1000: 0.3163 - 10s/epoch - 20ms/step
Epoch 14/50
494/494 - 10s - loss: 3.2663 - accuracy1000: 0.3682 - val_loss: 3.3265 - val_accuracy1000: 0.3182 - 10s/epoch - 20ms/step
Epoch 15/50
494/494 - 10s - loss: 3.2650 - accuracy1000: 0.3697 - val_loss: 3.3291 - val_accuracy1000: 0.3178 - 10s/epoch - 20ms/step
Epoch 16/50
494/494 - 10s - loss: 3.2622 - accuracy1000: 0.3711 - val_loss: 3.3316 - val_accuracy1000: 0.3181 - 10s/epoch - 21ms/step
Epoch 17/50
494/494 - 10s - loss: 3.2607 - accuracy1000: 0.3747 - val_loss: 3.3307 - val_accuracy1000: 0.3214 - 10s/epoch - 21ms/step
Epoch 18/50
494/494 - 10s - loss: 3.2591 - accuracy1000: 0.3751 - val_loss: 3.3257 - val_accuracy1000: 0.3214 - 10s/epoch - 20ms/step
Epoch 19/50
494/494 - 10s - loss: 3.2578 - accuracy1000: 0.3754 - val_loss: 3.3241 - val_accuracy1000: 0.3240 - 10s/epoch - 21ms/step
testing model: results/PCAR/W8/deepOF_L1/h1000
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095219
{'0': {'precision': 0.3442810806611378, 'recall': 0.14210015792469316, 'f1-score': 0.20116892697043637, 'support': 124743}, '1': {'precision': 0.2986003169814203, 'recall': 0.7099325361154241, 'f1-score': 0.42038507653678436, 'support': 110133}, '2': {'precision': 0.37384064458370636, 'recall': 0.15545843074769555, 'f1-score': 0.21959864532278758, 'support': 134306}, 'accuracy': 0.3163534516850767, 'macro avg': {'precision': 0.3389073474087548, 'recall': 0.335830374929271, 'f1-score': 0.28038421627666943, 'support': 369182}, 'weighted avg': {'precision': 0.34140734154559627, 'recall': 0.3163534516850767, 'f1-score': 0.2732692838492156, 'support': 369182}}
[[17726 88519 18498]
 [15473 78187 16473]
 [18288 95139 20879]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959537
{'0': {'precision': 0.3612923268095682, 'recall': 0.14387510206101392, 'f1-score': 0.20579699886749717, 'support': 40417}, '1': {'precision': 0.3369825370091304, 'recall': 0.7366712690453697, 'f1-score': 0.4624309098235396, 'support': 41283}, '2': {'precision': 0.38283365085731474, 'recall': 0.17125299961874005, 'f1-score': 0.23664678081661117, 'support': 44589}, 'accuracy': 0.34732241129472874, 'macro avg': {'precision': 0.3603695048920044, 'recall': 0.3505997902417079, 'f1-score': 0.3016248965025493, 'support': 126289}, 'weighted avg': {'precision': 0.36095124441627585, 'recall': 0.34732241129472874, 'f1-score': 0.30058101547486077, 'support': 126289}}
[[ 5815 28345  6257]
 [ 4818 30412  6053]
 [ 5462 31491  7636]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069269
{'0': {'precision': 0.32942326490713586, 'recall': 0.10697563685421792, 'f1-score': 0.1615048223806386, 'support': 12601}, '1': {'precision': 0.3049994647254041, 'recall': 0.7303255575493464, 'f1-score': 0.43029753813623317, 'support': 11703}, '2': {'precision': 0.3759323719542516, 'recall': 0.1638254839641722, 'f1-score': 0.22820345122503394, 'support': 13844}, 'accuracy': 0.31883716053266226, 'macro avg': {'precision': 0.3367850338622638, 'recall': 0.33370889278924554, 'f1-score': 0.2733352705806352, 'support': 38148}, 'weighted avg': {'precision': 0.3388088249478579, 'recall': 0.31883716053266226, 'f1-score': 0.26816983680366296, 'support': 38148}}
[[ 1348  9340  1913]
 [ 1304  8547  1852]
 [ 1440 10136  2268]]
training model: results/PCAR/W8/deepLOB_L2/h10
Epoch 1/50
494/494 - 26s - loss: 3.2992 - accuracy10: 0.3713 - val_loss: 3.3628 - val_accuracy10: 0.3472 - 26s/epoch - 52ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2724 - accuracy10: 0.3811 - val_loss: 3.3485 - val_accuracy10: 0.3546 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2287 - accuracy10: 0.4072 - val_loss: 3.2696 - val_accuracy10: 0.3972 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.1959 - accuracy10: 0.4214 - val_loss: 3.2462 - val_accuracy10: 0.4059 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.1583 - accuracy10: 0.4419 - val_loss: 3.1930 - val_accuracy10: 0.4341 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.1384 - accuracy10: 0.4497 - val_loss: 3.1713 - val_accuracy10: 0.4429 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1209 - accuracy10: 0.4550 - val_loss: 3.1678 - val_accuracy10: 0.4443 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1029 - accuracy10: 0.4604 - val_loss: 3.1631 - val_accuracy10: 0.4468 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.0825 - accuracy10: 0.4667 - val_loss: 3.1643 - val_accuracy10: 0.4467 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.0705 - accuracy10: 0.4709 - val_loss: 3.1678 - val_accuracy10: 0.4448 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.0579 - accuracy10: 0.4746 - val_loss: 3.1705 - val_accuracy10: 0.4462 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.0486 - accuracy10: 0.4753 - val_loss: 3.1748 - val_accuracy10: 0.4450 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.0395 - accuracy10: 0.4795 - val_loss: 3.1800 - val_accuracy10: 0.4472 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.0306 - accuracy10: 0.4820 - val_loss: 3.1850 - val_accuracy10: 0.4480 - 23s/epoch - 46ms/step
Epoch 15/50
494/494 - 23s - loss: 3.0218 - accuracy10: 0.4831 - val_loss: 3.1982 - val_accuracy10: 0.4415 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 3.0146 - accuracy10: 0.4855 - val_loss: 3.2056 - val_accuracy10: 0.4400 - 23s/epoch - 46ms/step
Epoch 17/50
494/494 - 23s - loss: 3.0058 - accuracy10: 0.4866 - val_loss: 3.2281 - val_accuracy10: 0.4319 - 23s/epoch - 46ms/step
Epoch 18/50
494/494 - 23s - loss: 3.0002 - accuracy10: 0.4896 - val_loss: 3.2338 - val_accuracy10: 0.4311 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h10
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0606898
{'0': {'precision': 0.4354196301564723, 'recall': 0.4252570158377327, 'f1-score': 0.4302783244307, 'support': 122366}, '1': {'precision': 0.43594080338266383, 'recall': 0.46490429909251224, 'f1-score': 0.4499569417330076, 'support': 124189}, '2': {'precision': 0.4427356551259415, 'recall': 0.4232582034053102, 'f1-score': 0.43277789126564914, 'support': 122632}, 'accuracy': 0.4379298295985503, 'macro avg': {'precision': 0.4380320295550259, 'recall': 0.4378065061118517, 'f1-score': 0.43767105247645227, 'support': 369187}, 'weighted avg': {'precision': 0.43802509230937436, 'recall': 0.4379298295985503, 'f1-score': 0.43772819315375844, 'support': 369187}}
[[52037 37075 33254]
 [34375 57736 32078]
 [33098 37629 51905]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0446613
{'0': {'precision': 0.4572839197550153, 'recall': 0.3487357910540238, 'f1-score': 0.3957006692354492, 'support': 41963}, '1': {'precision': 0.4495381083395587, 'recall': 0.5922796235836374, 'f1-score': 0.5111302168035716, 'support': 41656}, '2': {'precision': 0.4598929124267262, 'recall': 0.4246947718698006, 'f1-score': 0.441593567251462, 'support': 42673}, 'accuracy': 0.4547318911728376, 'macro avg': {'precision': 0.4555716468404334, 'recall': 0.4552367288358206, 'f1-score': 0.44947481776349424, 'support': 126292}, 'weighted avg': {'precision': 0.4556106073041685, 'recall': 0.4547318911728376, 'f1-score': 0.4492806336871565, 'support': 126292}}
[[14634 15337 11992]
 [ 7692 24672  9292]
 [ 9676 14874 18123]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0557444
{'0': {'precision': 0.44527843305454284, 'recall': 0.4822700526478786, 'f1-score': 0.4630366102954841, 'support': 12916}, '1': {'precision': 0.4478732846316652, 'recall': 0.5148328362894365, 'f1-score': 0.47902442586439814, 'support': 12742}, '2': {'precision': 0.45216568544995794, 'recall': 0.34435548438751, 'f1-score': 0.3909644577765658, 'support': 12490}, 'accuracy': 0.44799203103701374, 'macro avg': {'precision': 0.44843913437872196, 'recall': 0.44715279110827505, 'f1-score': 0.4443418313121494, 'support': 38148}, 'weighted avg': {'precision': 0.4484001008015919, 'recall': 0.44799203103701374, 'f1-score': 0.44477970458660854, 'support': 38148}}
[[6229 4017 2670]
 [3641 6560 2541]
 [4119 4070 4301]]
training model: results/PCAR/W8/deepLOB_L2/h20
Epoch 1/50
494/494 - 25s - loss: 3.3125 - accuracy20: 0.3666 - val_loss: 3.3069 - val_accuracy20: 0.3624 - 25s/epoch - 51ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2777 - accuracy20: 0.3820 - val_loss: 3.2986 - val_accuracy20: 0.3775 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2428 - accuracy20: 0.3998 - val_loss: 3.2734 - val_accuracy20: 0.3869 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2183 - accuracy20: 0.4147 - val_loss: 3.2689 - val_accuracy20: 0.3952 - 23s/epoch - 47ms/step
Epoch 5/50
494/494 - 22s - loss: 3.1942 - accuracy20: 0.4261 - val_loss: 3.2701 - val_accuracy20: 0.3902 - 22s/epoch - 45ms/step
Epoch 6/50
494/494 - 23s - loss: 3.1732 - accuracy20: 0.4359 - val_loss: 3.2747 - val_accuracy20: 0.3912 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1566 - accuracy20: 0.4425 - val_loss: 3.2657 - val_accuracy20: 0.3983 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1437 - accuracy20: 0.4476 - val_loss: 3.2866 - val_accuracy20: 0.3926 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1311 - accuracy20: 0.4525 - val_loss: 3.2586 - val_accuracy20: 0.4076 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1200 - accuracy20: 0.4556 - val_loss: 3.2875 - val_accuracy20: 0.3952 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1143 - accuracy20: 0.4565 - val_loss: 3.2761 - val_accuracy20: 0.3950 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1047 - accuracy20: 0.4592 - val_loss: 3.2715 - val_accuracy20: 0.3959 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.0993 - accuracy20: 0.4617 - val_loss: 3.2685 - val_accuracy20: 0.3951 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.0923 - accuracy20: 0.4626 - val_loss: 3.2605 - val_accuracy20: 0.4032 - 23s/epoch - 46ms/step
Epoch 15/50
494/494 - 23s - loss: 3.0894 - accuracy20: 0.4628 - val_loss: 3.2792 - val_accuracy20: 0.4025 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 3.0829 - accuracy20: 0.4657 - val_loss: 3.2775 - val_accuracy20: 0.4043 - 23s/epoch - 46ms/step
Epoch 17/50
494/494 - 23s - loss: 3.0775 - accuracy20: 0.4654 - val_loss: 3.2837 - val_accuracy20: 0.4035 - 23s/epoch - 46ms/step
Epoch 18/50
494/494 - 23s - loss: 3.0704 - accuracy20: 0.4686 - val_loss: 3.2846 - val_accuracy20: 0.4082 - 23s/epoch - 46ms/step
Epoch 19/50
494/494 - 23s - loss: 3.0661 - accuracy20: 0.4703 - val_loss: 3.3020 - val_accuracy20: 0.4005 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h20
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.107715
{'0': {'precision': 0.43904421674118127, 'recall': 0.1711345879645457, 'f1-score': 0.24627420864431593, 'support': 119929}, '1': {'precision': 0.3764620417216522, 'recall': 0.6868995050941576, 'f1-score': 0.48636626163449365, 'support': 127499}, '2': {'precision': 0.42339342783648654, 'recall': 0.3122726040785486, 'f1-score': 0.3594407313222601, 'support': 121759}, 'accuracy': 0.39580212737718284, 'macro avg': {'precision': 0.41296656209977334, 'recall': 0.390102232379084, 'f1-score': 0.36402706720035655, 'support': 369187}, 'weighted avg': {'precision': 0.41226973893166563, 'recall': 0.39580212737718284, 'f1-score': 0.36651283919993805, 'support': 369187}}
[[20524 73321 26084]
 [14223 87579 25697]
 [12000 71737 38022]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0884933
{'0': {'precision': 0.4466644090755164, 'recall': 0.2535563244905805, 'f1-score': 0.32348252605763334, 'support': 41616}, '1': {'precision': 0.39496466431095406, 'recall': 0.640269225261349, 'f1-score': 0.4885537889963394, 'support': 41898}, '2': {'precision': 0.4447737999309313, 'recall': 0.3612838374865585, 'f1-score': 0.398704950597219, 'support': 42778}, 'accuracy': 0.4183400373737054, 'macro avg': {'precision': 0.42880095777246724, 'recall': 0.4183697957461627, 'f1-score': 0.4035804218837306, 'support': 126292}, 'weighted avg': {'precision': 0.4288723685334972, 'recall': 0.4183400373737054, 'f1-score': 0.40372530193861, 'support': 126292}}
[[10552 20544 10520]
 [ 6299 26826  8773]
 [ 6773 20550 15455]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864053
{'0': {'precision': 0.4355882030479114, 'recall': 0.310779098873592, 'f1-score': 0.3627482309974892, 'support': 12784}, '1': {'precision': 0.38639275458360944, 'recall': 0.669934890846419, 'f1-score': 0.49010927430652834, 'support': 13055}, '2': {'precision': 0.43100750938673343, 'recall': 0.22381996912828012, 'f1-score': 0.29463665044650017, 'support': 12309}, 'accuracy': 0.40563070147845237, 'macro avg': {'precision': 0.4176628223394181, 'recall': 0.40151131961609704, 'f1-score': 0.3824980519168392, 'support': 38148}, 'weighted avg': {'precision': 0.4172745211254803, 'recall': 0.40563070147845237, 'f1-score': 0.38435651912261715, 'support': 38148}}
[[3973 6922 1889]
 [2561 8746 1748]
 [2587 6967 2755]]
training model: results/PCAR/W8/deepLOB_L2/h30
Epoch 1/50
494/494 - 25s - loss: 3.3106 - accuracy30: 0.3670 - val_loss: 3.3622 - val_accuracy30: 0.3521 - 25s/epoch - 51ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2751 - accuracy30: 0.3789 - val_loss: 3.2855 - val_accuracy30: 0.3831 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2477 - accuracy30: 0.3955 - val_loss: 3.2748 - val_accuracy30: 0.3945 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2199 - accuracy30: 0.4100 - val_loss: 3.2588 - val_accuracy30: 0.3943 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.2044 - accuracy30: 0.4193 - val_loss: 3.2418 - val_accuracy30: 0.4010 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.1911 - accuracy30: 0.4263 - val_loss: 3.2377 - val_accuracy30: 0.4064 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1813 - accuracy30: 0.4308 - val_loss: 3.2446 - val_accuracy30: 0.3975 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1745 - accuracy30: 0.4332 - val_loss: 3.2404 - val_accuracy30: 0.4012 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1663 - accuracy30: 0.4355 - val_loss: 3.2509 - val_accuracy30: 0.3935 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1600 - accuracy30: 0.4391 - val_loss: 3.2564 - val_accuracy30: 0.3945 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1506 - accuracy30: 0.4431 - val_loss: 3.2570 - val_accuracy30: 0.3925 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1443 - accuracy30: 0.4449 - val_loss: 3.2630 - val_accuracy30: 0.3929 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.1359 - accuracy30: 0.4464 - val_loss: 3.2677 - val_accuracy30: 0.3898 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.1281 - accuracy30: 0.4498 - val_loss: 3.2733 - val_accuracy30: 0.3857 - 23s/epoch - 46ms/step
Epoch 15/50
494/494 - 23s - loss: 3.1201 - accuracy30: 0.4509 - val_loss: 3.2839 - val_accuracy30: 0.3877 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 3.1151 - accuracy30: 0.4542 - val_loss: 3.2866 - val_accuracy30: 0.3869 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h30
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852947
{'0': {'precision': 0.40324244832125616, 'recall': 0.2808514504724774, 'f1-score': 0.33109848429519484, 'support': 121064}, '1': {'precision': 0.39286295983185066, 'recall': 0.410185605079036, 'f1-score': 0.40133744815209504, 'support': 123488}, '2': {'precision': 0.4041940552153141, 'recall': 0.5057006458859871, 'f1-score': 0.449285383326799, 'support': 124635}, 'accuracy': 0.40001950231183653, 'macro avg': {'precision': 0.400099821122807, 'recall': 0.3989125671458335, 'f1-score': 0.39390710525802963, 'support': 369187}, 'weighted avg': {'precision': 0.40009190740475914, 'recall': 0.40001950231183653, 'f1-score': 0.39449154344832016, 'support': 369187}}
[[34001 40145 46918]
 [26846 50653 45989]
 [23472 38135 63028]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800294
{'0': {'precision': 0.39490236693864145, 'recall': 0.3758745882522661, 'f1-score': 0.3851536130478701, 'support': 41591}, '1': {'precision': 0.42161700765557897, 'recall': 0.3783330939729044, 'f1-score': 0.398804042035147, 'support': 41778}, '2': {'precision': 0.40734720416124837, 'recall': 0.46706893739952937, 'f1-score': 0.43516860395706486, 'support': 42923}, 'accuracy': 0.40768219681373324, 'macro avg': {'precision': 0.4079555262518229, 'recall': 0.4070922065415666, 'f1-score': 0.4063754196800273, 'support': 126292}, 'weighted avg': {'precision': 0.40796933878149905, 'recall': 0.40768219681373324, 'f1-score': 0.406667890096502, 'support': 126292}}
[[15633 11047 14911]
 [11715 15806 14257]
 [12239 10636 20048]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0787336
{'0': {'precision': 0.40132762578323716, 'recall': 0.5014339973645454, 'f1-score': 0.4458304617505169, 'support': 12901}, '1': {'precision': 0.4199186018673689, 'recall': 0.41315954773869346, 'f1-score': 0.41651165551905645, 'support': 12736}, '2': {'precision': 0.40608549168245944, 'recall': 0.3082887059387739, 'f1-score': 0.3504929801444863, 'support': 12511}, 'accuracy': 0.40861906259830133, 'macro avg': {'precision': 0.40911057311102184, 'recall': 0.40762741701400423, 'f1-score': 0.4042783658046865, 'support': 38148}, 'weighted avg': {'precision': 0.4090947520198072, 'recall': 0.40861906259830133, 'f1-score': 0.4047753199727847, 'support': 38148}}
[[6469 3562 2870]
 [4703 5262 2771]
 [4947 3707 3857]]
training model: results/PCAR/W8/deepLOB_L2/h50
Epoch 1/50
494/494 - 25s - loss: 3.3062 - accuracy50: 0.3677 - val_loss: 3.4095 - val_accuracy50: 0.3394 - 25s/epoch - 50ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2773 - accuracy50: 0.3758 - val_loss: 3.3565 - val_accuracy50: 0.3452 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2652 - accuracy50: 0.3800 - val_loss: 3.3180 - val_accuracy50: 0.3626 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2527 - accuracy50: 0.3873 - val_loss: 3.3192 - val_accuracy50: 0.3564 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.2269 - accuracy50: 0.4048 - val_loss: 3.2926 - val_accuracy50: 0.3695 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.2138 - accuracy50: 0.4132 - val_loss: 3.2914 - val_accuracy50: 0.3700 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.2002 - accuracy50: 0.4191 - val_loss: 3.3028 - val_accuracy50: 0.3665 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1872 - accuracy50: 0.4268 - val_loss: 3.3181 - val_accuracy50: 0.3668 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1790 - accuracy50: 0.4314 - val_loss: 3.3130 - val_accuracy50: 0.3719 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 22s - loss: 3.1686 - accuracy50: 0.4343 - val_loss: 3.3532 - val_accuracy50: 0.3650 - 22s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1616 - accuracy50: 0.4378 - val_loss: 3.3432 - val_accuracy50: 0.3662 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1536 - accuracy50: 0.4412 - val_loss: 3.3439 - val_accuracy50: 0.3691 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.1481 - accuracy50: 0.4418 - val_loss: 3.3785 - val_accuracy50: 0.3622 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.1387 - accuracy50: 0.4460 - val_loss: 3.3733 - val_accuracy50: 0.3636 - 23s/epoch - 46ms/step
Epoch 15/50
494/494 - 23s - loss: 3.1331 - accuracy50: 0.4470 - val_loss: 3.3722 - val_accuracy50: 0.3654 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 3.1230 - accuracy50: 0.4481 - val_loss: 3.4104 - val_accuracy50: 0.3647 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h50
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.09512
{'0': {'precision': 0.35879173110483675, 'recall': 0.2099983391463212, 'f1-score': 0.2649331328803935, 'support': 120420}, '1': {'precision': 0.3799744306431195, 'recall': 0.484277030966701, 'f1-score': 0.42583182624269134, 'support': 125199}, '2': {'precision': 0.3635618801207417, 'recall': 0.4093778324485304, 'f1-score': 0.3851119874537509, 'support': 123568}, 'accuracy': 0.36974487184001603, 'macro avg': {'precision': 0.36744268062289925, 'recall': 0.3678844008538509, 'f1-score': 0.35862564885894527, 'support': 369187}, 'weighted avg': {'precision': 0.36757180887867713, 'recall': 0.36974487184001603, 'f1-score': 0.3597214548207298, 'support': 369187}}
[[25288 47519 47613]
 [23627 60631 40941]
 [21566 51416 50586]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0949385
{'0': {'precision': 0.3614251166975986, 'recall': 0.3086992026131233, 'f1-score': 0.33298790124096483, 'support': 41636}, '1': {'precision': 0.37518113095549854, 'recall': 0.511837279093031, 'f1-score': 0.4329824207928273, 'support': 41986}, '2': {'precision': 0.3838151325819856, 'recall': 0.3008905554253574, 'f1-score': 0.3373313540284547, 'support': 42670}, 'accuracy': 0.3735945269692459, 'macro avg': {'precision': 0.37347379341169423, 'recall': 0.3738090123771705, 'f1-score': 0.36776722535408224, 'support': 126292}, 'weighted avg': {'precision': 0.3735631934753753, 'recall': 0.3735945269692459, 'f1-score': 0.36769876992897904, 'support': 126292}}
[[12853 17595 11188]
 [11072 21490  9424]
 [11637 18194 12839]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973214
{'0': {'precision': 0.3556858745537991, 'recall': 0.33290907644578793, 'f1-score': 0.3439207790606895, 'support': 12571}, '1': {'precision': 0.4094292803970223, 'recall': 0.3867967332123412, 'f1-score': 0.39779134424699614, 'support': 13224}, '2': {'precision': 0.345453236374109, 'recall': 0.3884076742491702, 'f1-score': 0.3656733480679827, 'support': 12353}, 'accuracy': 0.36956065848799413, 'macro avg': {'precision': 0.3701894637749768, 'recall': 0.36937116130243314, 'f1-score': 0.3691284904585561, 'support': 38148}, 'weighted avg': {'precision': 0.3710025102735504, 'recall': 0.36956065848799413, 'f1-score': 0.3696388727738805, 'support': 38148}}
[[4185 3626 4760]
 [3778 5115 4331]
 [3803 3752 4798]]
training model: results/PCAR/W8/deepLOB_L2/h100
Epoch 1/50
494/494 - 26s - loss: 3.3175 - accuracy100: 0.3662 - val_loss: 3.3802 - val_accuracy100: 0.3400 - 26s/epoch - 52ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2752 - accuracy100: 0.3811 - val_loss: 3.3297 - val_accuracy100: 0.3534 - 23s/epoch - 47ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2697 - accuracy100: 0.3818 - val_loss: 3.2944 - val_accuracy100: 0.3613 - 23s/epoch - 47ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2727 - accuracy100: 0.3770 - val_loss: 3.2856 - val_accuracy100: 0.3631 - 23s/epoch - 47ms/step
Epoch 5/50
494/494 - 23s - loss: 3.2489 - accuracy100: 0.3882 - val_loss: 3.2868 - val_accuracy100: 0.3727 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.2383 - accuracy100: 0.3987 - val_loss: 3.2836 - val_accuracy100: 0.3681 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.2302 - accuracy100: 0.4024 - val_loss: 3.2991 - val_accuracy100: 0.3631 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.2135 - accuracy100: 0.4120 - val_loss: 3.2921 - val_accuracy100: 0.3687 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1976 - accuracy100: 0.4218 - val_loss: 3.2980 - val_accuracy100: 0.3662 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1835 - accuracy100: 0.4285 - val_loss: 3.3264 - val_accuracy100: 0.3771 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1722 - accuracy100: 0.4330 - val_loss: 3.3225 - val_accuracy100: 0.3723 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1617 - accuracy100: 0.4366 - val_loss: 3.2998 - val_accuracy100: 0.3796 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.1537 - accuracy100: 0.4401 - val_loss: 3.2934 - val_accuracy100: 0.3803 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.1459 - accuracy100: 0.4427 - val_loss: 3.3129 - val_accuracy100: 0.3766 - 23s/epoch - 46ms/step
Epoch 15/50
494/494 - 23s - loss: 3.1396 - accuracy100: 0.4452 - val_loss: 3.3062 - val_accuracy100: 0.3766 - 23s/epoch - 46ms/step
Epoch 16/50
494/494 - 23s - loss: 3.1302 - accuracy100: 0.4470 - val_loss: 3.3144 - val_accuracy100: 0.3744 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h100
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014524
{'0': {'precision': 0.3449112822229662, 'recall': 0.03496669636417632, 'f1-score': 0.06349622119673659, 'support': 117855}, '1': {'precision': 0.3737710060816929, 'recall': 0.8035930530220581, 'f1-score': 0.5102241427973565, 'support': 130474}, '2': {'precision': 0.345206907787553, 'recall': 0.219149745982889, 'f1-score': 0.2680999883593224, 'support': 120858}, 'accuracy': 0.36690078469718596, 'macro avg': {'precision': 0.3546297320307374, 'recall': 0.35256983178970785, 'f1-score': 0.2806067841178052, 'support': 369187}, 'weighted avg': {'precision': 0.35520734444950275, 'recall': 0.36690078469718596, 'f1-score': 0.28835349118364045, 'support': 369187}}
[[  4121  85274  28460]
 [  3847 104848  21779]
 [  3980  90392  26486]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1012825
{'0': {'precision': 0.3598110777157578, 'recall': 0.14098250336473755, 'f1-score': 0.20258672791006893, 'support': 41608}, '1': {'precision': 0.3601142313184198, 'recall': 0.7280600461893765, 'f1-score': 0.4818801350232469, 'support': 41568}, '2': {'precision': 0.38105514663378165, 'recall': 0.22933481770108544, 'f1-score': 0.2863389560558893, 'support': 43116}, 'accuracy': 0.3643777911506667, 'macro avg': {'precision': 0.36699348522265307, 'recall': 0.3661257890850665, 'f1-score': 0.3236019396630684, 'support': 126292}, 'weighted avg': {'precision': 0.3671635684865507, 'recall': 0.3643777911506667, 'f1-score': 0.32310686707657016, 'support': 126292}}
[[ 5866 26512  9230]
 [ 4473 30264  6831]
 [ 5964 27264  9888]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946481
{'0': {'precision': 0.3958926392842619, 'recall': 0.15624749217558784, 'f1-score': 0.22406352494389778, 'support': 12461}, '1': {'precision': 0.37411376087657106, 'recall': 0.7066656521077461, 'f1-score': 0.4892272032871517, 'support': 13142}, '2': {'precision': 0.33226266952177014, 'recall': 0.22263850139497807, 'f1-score': 0.26662211827597726, 'support': 12545}, 'accuracy': 0.3676994862115969, 'macro avg': {'precision': 0.36742302322753434, 'recall': 0.3618505485594374, 'f1-score': 0.3266376155023422, 'support': 38148}, 'weighted avg': {'precision': 0.3674650417508569, 'recall': 0.3676994862115969, 'f1-score': 0.32940793655493844, 'support': 38148}}
[[1947 7466 3048]
 [1290 9287 2565]
 [1681 8071 2793]]
training model: results/PCAR/W8/deepLOB_L2/h200
Epoch 1/50
494/494 - 25s - loss: 3.3152 - accuracy200: 0.3672 - val_loss: 3.3599 - val_accuracy200: 0.3445 - 25s/epoch - 50ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2790 - accuracy200: 0.3799 - val_loss: 3.3159 - val_accuracy200: 0.3691 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2575 - accuracy200: 0.3931 - val_loss: 3.3348 - val_accuracy200: 0.3761 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2386 - accuracy200: 0.4038 - val_loss: 3.3284 - val_accuracy200: 0.3741 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 22s - loss: 3.2205 - accuracy200: 0.4120 - val_loss: 3.3594 - val_accuracy200: 0.3696 - 22s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.2057 - accuracy200: 0.4213 - val_loss: 3.3624 - val_accuracy200: 0.3749 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1899 - accuracy200: 0.4281 - val_loss: 3.3775 - val_accuracy200: 0.3779 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1799 - accuracy200: 0.4323 - val_loss: 3.3737 - val_accuracy200: 0.3831 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1677 - accuracy200: 0.4374 - val_loss: 3.3927 - val_accuracy200: 0.3772 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1574 - accuracy200: 0.4428 - val_loss: 3.4047 - val_accuracy200: 0.3754 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1510 - accuracy200: 0.4449 - val_loss: 3.3969 - val_accuracy200: 0.3813 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1429 - accuracy200: 0.4456 - val_loss: 3.4183 - val_accuracy200: 0.3791 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h200
Evaluating performance on  test set...
1443/1443 - 31s - 31s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1386486
{'0': {'precision': 0.34946060173302196, 'recall': 0.14894387050075672, 'f1-score': 0.20886656324073055, 'support': 121576}, '1': {'precision': 0.33191974666164714, 'recall': 0.7365959538045704, 'f1-score': 0.4576268598994484, 'support': 122090}, '2': {'precision': 0.32361936762298615, 'recall': 0.11970108587407685, 'f1-score': 0.17476112103007288, 'support': 125521}, 'accuracy': 0.3333378477573696, 'macro avg': {'precision': 0.33499990533921836, 'recall': 0.33508030339313466, 'f1-score': 0.28041818139008395, 'support': 369187}, 'weighted avg': {'precision': 0.33487400864499356, 'recall': 0.3333378477573696, 'f1-score': 0.27953588639495563, 'support': 369187}}
[[18108 87039 16429]
 [17185 89931 14974]
 [16524 93972 15025]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083617
{'0': {'precision': 0.3555531040569238, 'recall': 0.311160455686426, 'f1-score': 0.3318788534064435, 'support': 41432}, '1': {'precision': 0.3804150415339268, 'recall': 0.6143674568447373, 'f1-score': 0.46988084730803176, 'support': 41594}, '2': {'precision': 0.3804190909488604, 'recall': 0.20098922941801878, 'f1-score': 0.2630170132325142, 'support': 43266}, 'accuracy': 0.3732778006524562, 'macro avg': {'precision': 0.3721290788465703, 'recall': 0.37550571398306065, 'f1-score': 0.35492557131566316, 'support': 126292}, 'weighted avg': {'precision': 0.37226009433568247, 'recall': 0.3732778006524562, 'f1-score': 0.3537383421894023, 'support': 126292}}
[[12892 20479  8061]
 [ 9938 25554  6102]
 [13429 21141  8696]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1067814
{'0': {'precision': 0.37925673674859345, 'recall': 0.40240358180818475, 'f1-score': 0.39048744235679717, 'support': 12731}, '1': {'precision': 0.3723963599595551, 'recall': 0.5951842275371687, 'f1-score': 0.45814155989550936, 'support': 12376}, '2': {'precision': 0.33168724279835393, 'recall': 0.12361015259565984, 'f1-score': 0.18010167029774873, 'support': 13041}, 'accuracy': 0.3696392995700954, 'macro avg': {'precision': 0.3611134465021675, 'recall': 0.3737326539803378, 'f1-score': 0.34291022418335176, 'support': 38148}, 'weighted avg': {'precision': 0.36076932472840334, 'recall': 0.3696392995700954, 'f1-score': 0.340514875124886, 'support': 38148}}
[[5123 5768 1840]
 [3602 7366 1408]
 [4783 6646 1612]]
training model: results/PCAR/W8/deepLOB_L2/h300
Epoch 1/50
494/494 - 25s - loss: 3.3058 - accuracy300: 0.3730 - val_loss: 3.3636 - val_accuracy300: 0.3414 - 25s/epoch - 50ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2766 - accuracy300: 0.3770 - val_loss: 3.3183 - val_accuracy300: 0.3529 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2641 - accuracy300: 0.3893 - val_loss: 3.2981 - val_accuracy300: 0.3785 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2565 - accuracy300: 0.3940 - val_loss: 3.3977 - val_accuracy300: 0.3559 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.2483 - accuracy300: 0.3932 - val_loss: 3.3026 - val_accuracy300: 0.3685 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.2260 - accuracy300: 0.4076 - val_loss: 3.3057 - val_accuracy300: 0.3691 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.2219 - accuracy300: 0.4081 - val_loss: 3.3085 - val_accuracy300: 0.3709 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.2032 - accuracy300: 0.4184 - val_loss: 3.3100 - val_accuracy300: 0.3718 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1949 - accuracy300: 0.4197 - val_loss: 3.3040 - val_accuracy300: 0.3735 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1845 - accuracy300: 0.4261 - val_loss: 3.3122 - val_accuracy300: 0.3636 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1788 - accuracy300: 0.4330 - val_loss: 3.3348 - val_accuracy300: 0.3559 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1725 - accuracy300: 0.4319 - val_loss: 3.3414 - val_accuracy300: 0.3553 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.1627 - accuracy300: 0.4371 - val_loss: 3.3427 - val_accuracy300: 0.3573 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h300
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023889
{'0': {'precision': 0.3266694859866979, 'recall': 0.0703860172299536, 'f1-score': 0.11581738010372722, 'support': 120720}, '1': {'precision': 0.38678647054160864, 'recall': 0.5540281900313042, 'f1-score': 0.45554266357259077, 'support': 123306}, '2': {'precision': 0.365515088199623, 'recall': 0.4863975199942474, 'f1-score': 0.4173799770323775, 'support': 125161}, 'accuracy': 0.3729546273297814, 'macro avg': {'precision': 0.35965701490930985, 'recall': 0.37027057575183503, 'f1-score': 0.3295800069028985, 'support': 369187}, 'weighted avg': {'precision': 0.359917512910993, 'recall': 0.3729546273297814, 'f1-score': 0.331518480081783, 'support': 369187}}
[[ 8497 52026 60197]
 [ 9512 68315 45479]
 [ 8002 56281 60878]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950764
{'0': {'precision': 0.35162803924356606, 'recall': 0.2381433867783716, 'f1-score': 0.28396727429309604, 'support': 41538}, '1': {'precision': 0.40804070580013974, 'recall': 0.45488849936702697, 'f1-score': 0.43019293640926465, 'support': 41076}, '2': {'precision': 0.381034219370608, 'recall': 0.45684326205412334, 'f1-score': 0.4155092351581533, 'support': 43678}, 'accuracy': 0.3842761220029772, 'macro avg': {'precision': 0.38023432147143793, 'recall': 0.3832917160665073, 'f1-score': 0.3765564819535047, 'support': 126292}, 'weighted avg': {'precision': 0.3801461546195737, 'recall': 0.3842761220029772, 'f1-score': 0.37702031853776485, 'support': 126292}}
[[ 9892 13482 18164]
 [ 8141 18685 14250]
 [10099 13625 19954]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001226
{'0': {'precision': 0.38035284683239773, 'recall': 0.37657800714569273, 'f1-score': 0.3784560143626571, 'support': 12595}, '1': {'precision': 0.4009488994322159, 'recall': 0.41845929052682845, 'f1-score': 0.40951700031776295, 'support': 12319}, '2': {'precision': 0.3464628344122923, 'recall': 0.3356505969472571, 'f1-score': 0.3409710228363078, 'support': 13234}, 'accuracy': 0.37590437244416486, 'macro avg': {'precision': 0.375921526892302, 'recall': 0.37689596487325944, 'f1-score': 0.37631467917224265, 'support': 38148}, 'weighted avg': {'precision': 0.37524700504801806, 'recall': 0.37590437244416486, 'f1-score': 0.3754824353577615, 'support': 38148}}
[[4743 3479 4373]
 [3158 5155 4006]
 [4569 4223 4442]]
training model: results/PCAR/W8/deepLOB_L2/h500
Epoch 1/50
494/494 - 25s - loss: 3.2966 - accuracy500: 0.3829 - val_loss: 3.5324 - val_accuracy500: 0.3425 - 25s/epoch - 51ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2765 - accuracy500: 0.3883 - val_loss: 3.3748 - val_accuracy500: 0.3423 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2607 - accuracy500: 0.3894 - val_loss: 3.3055 - val_accuracy500: 0.3535 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.2652 - accuracy500: 0.3920 - val_loss: 3.3032 - val_accuracy500: 0.3739 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.2402 - accuracy500: 0.4087 - val_loss: 3.3684 - val_accuracy500: 0.3756 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.2098 - accuracy500: 0.4218 - val_loss: 3.4062 - val_accuracy500: 0.3582 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1979 - accuracy500: 0.4269 - val_loss: 3.4148 - val_accuracy500: 0.3560 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1822 - accuracy500: 0.4371 - val_loss: 3.4630 - val_accuracy500: 0.3497 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.1570 - accuracy500: 0.4480 - val_loss: 3.5201 - val_accuracy500: 0.3454 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.1400 - accuracy500: 0.4530 - val_loss: 3.5706 - val_accuracy500: 0.3401 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.1250 - accuracy500: 0.4575 - val_loss: 3.5763 - val_accuracy500: 0.3441 - 23s/epoch - 46ms/step
Epoch 12/50
494/494 - 23s - loss: 3.1117 - accuracy500: 0.4625 - val_loss: 3.5518 - val_accuracy500: 0.3415 - 23s/epoch - 46ms/step
Epoch 13/50
494/494 - 23s - loss: 3.0981 - accuracy500: 0.4670 - val_loss: 3.5506 - val_accuracy500: 0.3377 - 23s/epoch - 46ms/step
Epoch 14/50
494/494 - 23s - loss: 3.0865 - accuracy500: 0.4720 - val_loss: 3.5683 - val_accuracy500: 0.3438 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h500
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185501
{'0': {'precision': 0.3221957040572792, 'recall': 0.028265384744229675, 'f1-score': 0.0519714503499411, 'support': 119404}, '1': {'precision': 0.3507706940442555, 'recall': 0.7948967867189667, 'f1-score': 0.4867494316679242, 'support': 126195}, '2': {'precision': 0.330455345358557, 'recall': 0.1944849014467424, 'f1-score': 0.24486053666388216, 'support': 123588}, 'accuracy': 0.34595746870826977, 'macro avg': {'precision': 0.3344739144866972, 'recall': 0.33921569096997956, 'f1-score': 0.26119380622724914, 'support': 369187}, 'weighted avg': {'precision': 0.3347281426603416, 'recall': 0.34595746870826977, 'f1-score': 0.26515767779508465, 'support': 369187}}
[[  3375  88709  27320]
 [  4503 100312  21380]
 [  2597  96955  24036]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015277
{'0': {'precision': 0.34016129032258063, 'recall': 0.2061533198113438, 'f1-score': 0.2567215958369471, 'support': 40921}, '1': {'precision': 0.35937059463233223, 'recall': 0.6395173814359096, 'f1-score': 0.4601591913218381, 'support': 41855}, '2': {'precision': 0.3975341552815728, 'recall': 0.24673683242945124, 'f1-score': 0.3044877702942219, 'support': 43516}, 'accuracy': 0.3637601748329269, 'macro avg': {'precision': 0.36568868007882854, 'recall': 0.3641358445589016, 'f1-score': 0.34045618581766907, 'support': 126292}, 'weighted avg': {'precision': 0.36629630301887306, 'recall': 0.3637601748329269, 'f1-score': 0.340602391189803, 'support': 126292}}
[[ 8436 23170  9315]
 [ 8131 26767  6957]
 [ 8233 24546 10737]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001848
{'0': {'precision': 0.3532332693826882, 'recall': 0.2564522736583367, 'f1-score': 0.2971613025728662, 'support': 12205}, '1': {'precision': 0.39409110915492956, 'recall': 0.5682665608885363, 'f1-score': 0.46541697800591275, 'support': 12605}, '2': {'precision': 0.3473134731347313, 'recall': 0.2893237366921577, 'f1-score': 0.3156775328234283, 'support': 13338}, 'accuracy': 0.3709761979658173, 'macro avg': {'precision': 0.36487928389078306, 'recall': 0.37134752374634356, 'f1-score': 0.3594186044674024, 'support': 38148}, 'weighted avg': {'precision': 0.36466387722514004, 'recall': 0.3709761979658173, 'f1-score': 0.35923093316727617, 'support': 38148}}
[[3130 4891 4184]
 [2374 7163 3068]
 [3357 6122 3859]]
training model: results/PCAR/W8/deepLOB_L2/h1000
Epoch 1/50
494/494 - 25s - loss: 3.3041 - accuracy1000: 0.3796 - val_loss: 3.4379 - val_accuracy1000: 0.3209 - 25s/epoch - 51ms/step
Epoch 2/50
494/494 - 23s - loss: 3.2611 - accuracy1000: 0.3958 - val_loss: 3.4572 - val_accuracy1000: 0.3429 - 23s/epoch - 46ms/step
Epoch 3/50
494/494 - 23s - loss: 3.2185 - accuracy1000: 0.4178 - val_loss: 3.5302 - val_accuracy1000: 0.3328 - 23s/epoch - 46ms/step
Epoch 4/50
494/494 - 23s - loss: 3.1873 - accuracy1000: 0.4281 - val_loss: 3.6632 - val_accuracy1000: 0.3282 - 23s/epoch - 46ms/step
Epoch 5/50
494/494 - 23s - loss: 3.1732 - accuracy1000: 0.4375 - val_loss: 3.5466 - val_accuracy1000: 0.3252 - 23s/epoch - 46ms/step
Epoch 6/50
494/494 - 23s - loss: 3.1400 - accuracy1000: 0.4501 - val_loss: 3.6775 - val_accuracy1000: 0.3259 - 23s/epoch - 46ms/step
Epoch 7/50
494/494 - 23s - loss: 3.1271 - accuracy1000: 0.4546 - val_loss: 3.7526 - val_accuracy1000: 0.3342 - 23s/epoch - 46ms/step
Epoch 8/50
494/494 - 23s - loss: 3.1037 - accuracy1000: 0.4616 - val_loss: 3.6616 - val_accuracy1000: 0.3399 - 23s/epoch - 46ms/step
Epoch 9/50
494/494 - 23s - loss: 3.0837 - accuracy1000: 0.4701 - val_loss: 3.6296 - val_accuracy1000: 0.3447 - 23s/epoch - 46ms/step
Epoch 10/50
494/494 - 23s - loss: 3.0682 - accuracy1000: 0.4771 - val_loss: 3.7503 - val_accuracy1000: 0.3331 - 23s/epoch - 46ms/step
Epoch 11/50
494/494 - 23s - loss: 3.0539 - accuracy1000: 0.4815 - val_loss: 3.7557 - val_accuracy1000: 0.3433 - 23s/epoch - 46ms/step
testing model: results/PCAR/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1435262
{'0': {'precision': 0.3395734179446501, 'recall': 0.07721289660590319, 'f1-score': 0.12581721757417821, 'support': 124746}, '1': {'precision': 0.3013917867981791, 'recall': 0.46167396081137524, 'f1-score': 0.3646992160322481, 'support': 110134}, '2': {'precision': 0.35901532669447705, 'recall': 0.4600877095013663, 'f1-score': 0.4033156563596313, 'support': 134307}, 'accuracy': 0.3311898848009274, 'macro avg': {'precision': 0.33332684381243544, 'recall': 0.3329915223062149, 'f1-score': 0.29794402998868585, 'support': 369187}, 'weighted avg': {'precision': 0.33525606298301164, 'recall': 0.3311898848009274, 'f1-score': 0.2980307918228352, 'support': 369187}}
[[ 9632 55433 59681]
 [ 8644 50846 50644]
 [10089 62425 61793]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1391015
{'0': {'precision': 0.3107195784620451, 'recall': 0.04669289585034519, 'f1-score': 0.08118573333906982, 'support': 40413}, '1': {'precision': 0.3305624565824022, 'recall': 0.6795188304772969, 'f1-score': 0.44476304387430987, 'support': 41316}, '2': {'precision': 0.36992745409204264, 'recall': 0.29293359962300564, 'f1-score': 0.3269589610649835, 'support': 44563}, 'accuracy': 0.34060748107560257, 'macro avg': {'precision': 0.3370698297121633, 'recall': 0.3397151086502159, 'f1-score': 0.2843025794261211, 'support': 126292}, 'weighted avg': {'precision': 0.3381030145792992, 'recall': 0.34060748107560257, 'f1-score': 0.2868515911069717, 'support': 126292}}
[[ 1887 27218 11308]
 [ 2315 28075 10926]
 [ 1871 29638 13054]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1446558
{'0': {'precision': 0.32688172043010755, 'recall': 0.12058706862356208, 'f1-score': 0.176180817154448, 'support': 12605}, '1': {'precision': 0.3056685652291836, 'recall': 0.5778993248440304, 'f1-score': 0.39984625846317595, 'support': 11701}, '2': {'precision': 0.3555731364275668, 'recall': 0.2922265568559457, 'f1-score': 0.32080260131651994, 'support': 13842}, 'accuracy': 0.32313620635419943, 'macro avg': {'precision': 0.32937447402895265, 'recall': 0.33023765010784606, 'f1-score': 0.29894322564471465, 'support': 38148}, 'weighted avg': {'precision': 0.3307857639246766, 'recall': 0.32313620635419943, 'f1-score': 0.2972609279105774, 'support': 38148}}
[[1520 7281 3804]
 [1412 6762 3527]
 [1718 8079 4045]]
training model: results/PCAR/W8/deepOF_L2/h10
Epoch 1/50
494/494 - 16s - loss: 3.2723 - accuracy10: 0.3832 - val_loss: 3.2438 - val_accuracy10: 0.4060 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 14s - loss: 3.1786 - accuracy10: 0.4268 - val_loss: 3.1960 - val_accuracy10: 0.4259 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.1243 - accuracy10: 0.4478 - val_loss: 3.1830 - val_accuracy10: 0.4325 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.0893 - accuracy10: 0.4592 - val_loss: 3.1802 - val_accuracy10: 0.4327 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.0613 - accuracy10: 0.4685 - val_loss: 3.1757 - val_accuracy10: 0.4352 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.0407 - accuracy10: 0.4760 - val_loss: 3.1636 - val_accuracy10: 0.4380 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.0261 - accuracy10: 0.4808 - val_loss: 3.1665 - val_accuracy10: 0.4363 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.0134 - accuracy10: 0.4847 - val_loss: 3.1611 - val_accuracy10: 0.4425 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.0015 - accuracy10: 0.4882 - val_loss: 3.1536 - val_accuracy10: 0.4437 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 2.9906 - accuracy10: 0.4913 - val_loss: 3.1573 - val_accuracy10: 0.4405 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 2.9812 - accuracy10: 0.4955 - val_loss: 3.1510 - val_accuracy10: 0.4449 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 2.9705 - accuracy10: 0.4983 - val_loss: 3.1487 - val_accuracy10: 0.4473 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 2.9632 - accuracy10: 0.5004 - val_loss: 3.1526 - val_accuracy10: 0.4464 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 2.9559 - accuracy10: 0.5027 - val_loss: 3.1436 - val_accuracy10: 0.4519 - 14s/epoch - 29ms/step
Epoch 15/50
494/494 - 14s - loss: 2.9477 - accuracy10: 0.5059 - val_loss: 3.1531 - val_accuracy10: 0.4485 - 14s/epoch - 28ms/step
Epoch 16/50
494/494 - 14s - loss: 2.9400 - accuracy10: 0.5085 - val_loss: 3.1610 - val_accuracy10: 0.4469 - 14s/epoch - 28ms/step
Epoch 17/50
494/494 - 14s - loss: 2.9323 - accuracy10: 0.5105 - val_loss: 3.1543 - val_accuracy10: 0.4504 - 14s/epoch - 28ms/step
Epoch 18/50
494/494 - 14s - loss: 2.9243 - accuracy10: 0.5116 - val_loss: 3.1574 - val_accuracy10: 0.4510 - 14s/epoch - 28ms/step
Epoch 19/50
494/494 - 14s - loss: 2.9171 - accuracy10: 0.5147 - val_loss: 3.1574 - val_accuracy10: 0.4517 - 14s/epoch - 28ms/step
Epoch 20/50
494/494 - 14s - loss: 2.9108 - accuracy10: 0.5165 - val_loss: 3.1674 - val_accuracy10: 0.4508 - 14s/epoch - 28ms/step
Epoch 21/50
494/494 - 14s - loss: 2.9033 - accuracy10: 0.5182 - val_loss: 3.1684 - val_accuracy10: 0.4522 - 14s/epoch - 28ms/step
Epoch 22/50
494/494 - 14s - loss: 2.8956 - accuracy10: 0.5209 - val_loss: 3.1804 - val_accuracy10: 0.4497 - 14s/epoch - 28ms/step
Epoch 23/50
494/494 - 14s - loss: 2.8888 - accuracy10: 0.5237 - val_loss: 3.1687 - val_accuracy10: 0.4528 - 14s/epoch - 28ms/step
Epoch 24/50
494/494 - 14s - loss: 2.8803 - accuracy10: 0.5252 - val_loss: 3.1748 - val_accuracy10: 0.4520 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h10
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.060873
{'0': {'precision': 0.46581744177281975, 'recall': 0.3535382427694646, 'f1-score': 0.40198483496877785, 'support': 122363}, '1': {'precision': 0.41835788985897987, 'recall': 0.6397316971043902, 'f1-score': 0.5058868477188068, 'support': 124188}, '2': {'precision': 0.4607862424922753, 'recall': 0.3246895157015763, 'f1-score': 0.38094736942815316, 'support': 122631}, 'accuracy': 0.4402273133576393, 'macro avg': {'precision': 0.448320524708025, 'recall': 0.4393198185251437, 'f1-score': 0.4296063507052459, 'support': 369182}, 'weighted avg': {'precision': 0.44818145780814006, 'recall': 0.4402273133576393, 'f1-score': 0.429948109783607, 'support': 369182}}
[[43260 55350 23753]
 [21900 79447 22841]
 [27709 55105 39817]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0135736
{'0': {'precision': 0.5101585321823613, 'recall': 0.36841356751759935, 'f1-score': 0.4278517947588637, 'support': 42189}, '1': {'precision': 0.4478215066274627, 'recall': 0.6845242387098325, 'f1-score': 0.5414329981179781, 'support': 41607}, '2': {'precision': 0.5135462247462992, 'recall': 0.3894288471042289, 'f1-score': 0.44295733176294233, 'support': 42493}, 'accuracy': 0.4796300548741379, 'macro avg': {'precision': 0.4905087545187077, 'recall': 0.48078888444388695, 'f1-score': 0.470747374879928, 'support': 126289}, 'weighted avg': {'precision': 0.49076093300790224, 'recall': 0.4796300548741379, 'f1-score': 0.47035472622618857, 'support': 126289}}
[[15543 18117  8529]
 [ 5980 28481  7146]
 [ 8944 17001 16548]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0493616
{'0': {'precision': 0.4823243014394581, 'recall': 0.3510785824345146, 'f1-score': 0.40636704119850187, 'support': 12980}, '1': {'precision': 0.42191930749713946, 'recall': 0.6695878730459498, 'f1-score': 0.5176549577318643, 'support': 12666}, '2': {'precision': 0.4785440167461333, 'recall': 0.32914733642617183, 'f1-score': 0.39002890858253164, 'support': 12502}, 'accuracy': 0.4496434937611408, 'macro avg': {'precision': 0.46092920856091024, 'recall': 0.4499379306355454, 'f1-score': 0.43801696917096594, 'support': 38148}, 'weighted avg': {'precision': 0.46102958684080675, 'recall': 0.4496434937611408, 'f1-score': 0.4379627583225112, 'support': 38148}}
[[4557 6036 2387]
 [2088 8481 2097]
 [2803 5584 4115]]
training model: results/PCAR/W8/deepOF_L2/h20
Epoch 1/50
494/494 - 16s - loss: 3.2952 - accuracy20: 0.3670 - val_loss: 3.2723 - val_accuracy20: 0.3830 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2259 - accuracy20: 0.4037 - val_loss: 3.2468 - val_accuracy20: 0.4017 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.1889 - accuracy20: 0.4212 - val_loss: 3.2323 - val_accuracy20: 0.4077 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.1628 - accuracy20: 0.4320 - val_loss: 3.2279 - val_accuracy20: 0.4090 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.1432 - accuracy20: 0.4414 - val_loss: 3.2291 - val_accuracy20: 0.4090 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.1271 - accuracy20: 0.4468 - val_loss: 3.2322 - val_accuracy20: 0.4099 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.1132 - accuracy20: 0.4546 - val_loss: 3.2327 - val_accuracy20: 0.4079 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1030 - accuracy20: 0.4561 - val_loss: 3.2276 - val_accuracy20: 0.4102 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.0949 - accuracy20: 0.4592 - val_loss: 3.2254 - val_accuracy20: 0.4116 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.0882 - accuracy20: 0.4624 - val_loss: 3.2281 - val_accuracy20: 0.4131 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.0787 - accuracy20: 0.4655 - val_loss: 3.2205 - val_accuracy20: 0.4130 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.0704 - accuracy20: 0.4676 - val_loss: 3.2265 - val_accuracy20: 0.4133 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.0640 - accuracy20: 0.4712 - val_loss: 3.2257 - val_accuracy20: 0.4152 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 3.0580 - accuracy20: 0.4728 - val_loss: 3.2245 - val_accuracy20: 0.4166 - 14s/epoch - 28ms/step
Epoch 15/50
494/494 - 14s - loss: 3.0499 - accuracy20: 0.4754 - val_loss: 3.2281 - val_accuracy20: 0.4152 - 14s/epoch - 28ms/step
Epoch 16/50
494/494 - 14s - loss: 3.0427 - accuracy20: 0.4775 - val_loss: 3.2320 - val_accuracy20: 0.4153 - 14s/epoch - 28ms/step
Epoch 17/50
494/494 - 14s - loss: 3.0358 - accuracy20: 0.4817 - val_loss: 3.2351 - val_accuracy20: 0.4153 - 14s/epoch - 28ms/step
Epoch 18/50
494/494 - 14s - loss: 3.0285 - accuracy20: 0.4843 - val_loss: 3.2406 - val_accuracy20: 0.4148 - 14s/epoch - 28ms/step
Epoch 19/50
494/494 - 14s - loss: 3.0233 - accuracy20: 0.4866 - val_loss: 3.2357 - val_accuracy20: 0.4174 - 14s/epoch - 28ms/step
Epoch 20/50
494/494 - 14s - loss: 3.0159 - accuracy20: 0.4882 - val_loss: 3.2391 - val_accuracy20: 0.4182 - 14s/epoch - 28ms/step
Epoch 21/50
494/494 - 14s - loss: 3.0074 - accuracy20: 0.4914 - val_loss: 3.2368 - val_accuracy20: 0.4190 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h20
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0818032
{'0': {'precision': 0.4270372385753447, 'recall': 0.3468222070276671, 'f1-score': 0.3827723455653974, 'support': 119926}, '1': {'precision': 0.3848474358340339, 'recall': 0.6103577282959082, 'f1-score': 0.472052628226709, 'support': 127499}, '2': {'precision': 0.4417374556221523, 'recall': 0.2524125922944882, 'f1-score': 0.3212564678827157, 'support': 121757}, 'accuracy': 0.4066991348440607, 'macro avg': {'precision': 0.41787404334384365, 'recall': 0.40319750920602115, 'f1-score': 0.39202714722494075, 'support': 369182}, 'weighted avg': {'precision': 0.41731492456018077, 'recall': 0.4066991348440607, 'f1-score': 0.3933177081237678, 'support': 369182}}
[[41593 60979 17354]
 [28193 77820 21486]
 [27613 63411 30733]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0500587
{'0': {'precision': 0.4660333627134136, 'recall': 0.3411149076485628, 'f1-score': 0.393907620992219, 'support': 41851}, '1': {'precision': 0.3979339271687095, 'recall': 0.643259301851985, 'f1-score': 0.49169489973445657, 'support': 41739}, '2': {'precision': 0.49192833067234343, 'recall': 0.3247148645167334, 'f1-score': 0.39120252807403644, 'support': 42699}, 'accuracy': 0.4354298474134723, 'macro avg': {'precision': 0.45196520685148883, 'recall': 0.43636302467242705, 'f1-score': 0.42560168293357065, 'support': 126289}, 'weighted avg': {'precision': 0.4522814674309895, 'recall': 0.4354298474134723, 'f1-score': 0.42531208586967284, 'support': 126289}}
[[14276 20575  7000]
 [ 7570 26849  7320]
 [ 8787 20047 13865]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0742084
{'0': {'precision': 0.44588506757499174, 'recall': 0.31782581453634084, 'f1-score': 0.3711189354794458, 'support': 12768}, '1': {'precision': 0.38677618442548556, 'recall': 0.6528033088235294, 'f1-score': 0.48575173828792895, 'support': 13056}, '2': {'precision': 0.45699614890885754, 'recall': 0.2599805258033106, 'f1-score': 0.3314197051978277, 'support': 12324}, 'accuracy': 0.4137831603229527, 'macro avg': {'precision': 0.4298858003031116, 'recall': 0.41020321638772694, 'f1-score': 0.3960967929884009, 'support': 38148}, 'weighted avg': {'precision': 0.42924480826804534, 'recall': 0.4137831603229527, 'f1-score': 0.3975264158054628, 'support': 38148}}
[[4058 6898 1812]
 [2538 8523 1995]
 [2505 6615 3204]]
training model: results/PCAR/W8/deepOF_L2/h30
Epoch 1/50
494/494 - 17s - loss: 3.3018 - accuracy30: 0.3635 - val_loss: 3.2920 - val_accuracy30: 0.3718 - 17s/epoch - 34ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2412 - accuracy30: 0.3980 - val_loss: 3.2694 - val_accuracy30: 0.3843 - 14s/epoch - 29ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2097 - accuracy30: 0.4098 - val_loss: 3.2580 - val_accuracy30: 0.3897 - 14s/epoch - 29ms/step
Epoch 4/50
494/494 - 14s - loss: 3.1905 - accuracy30: 0.4176 - val_loss: 3.2537 - val_accuracy30: 0.3944 - 14s/epoch - 29ms/step
Epoch 5/50
494/494 - 14s - loss: 3.1747 - accuracy30: 0.4261 - val_loss: 3.2507 - val_accuracy30: 0.3961 - 14s/epoch - 29ms/step
Epoch 6/50
494/494 - 14s - loss: 3.1628 - accuracy30: 0.4325 - val_loss: 3.2469 - val_accuracy30: 0.3966 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.1526 - accuracy30: 0.4382 - val_loss: 3.2479 - val_accuracy30: 0.3991 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1419 - accuracy30: 0.4421 - val_loss: 3.2495 - val_accuracy30: 0.3980 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1369 - accuracy30: 0.4442 - val_loss: 3.2511 - val_accuracy30: 0.3989 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1286 - accuracy30: 0.4479 - val_loss: 3.2503 - val_accuracy30: 0.3983 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1214 - accuracy30: 0.4507 - val_loss: 3.2460 - val_accuracy30: 0.4007 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1138 - accuracy30: 0.4532 - val_loss: 3.2538 - val_accuracy30: 0.3992 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1080 - accuracy30: 0.4552 - val_loss: 3.2455 - val_accuracy30: 0.4017 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 3.1009 - accuracy30: 0.4580 - val_loss: 3.2579 - val_accuracy30: 0.3977 - 14s/epoch - 28ms/step
Epoch 15/50
494/494 - 14s - loss: 3.0934 - accuracy30: 0.4620 - val_loss: 3.2546 - val_accuracy30: 0.3984 - 14s/epoch - 28ms/step
Epoch 16/50
494/494 - 14s - loss: 3.0879 - accuracy30: 0.4628 - val_loss: 3.2534 - val_accuracy30: 0.4017 - 14s/epoch - 28ms/step
Epoch 17/50
494/494 - 14s - loss: 3.0800 - accuracy30: 0.4658 - val_loss: 3.2607 - val_accuracy30: 0.4004 - 14s/epoch - 28ms/step
Epoch 18/50
494/494 - 14s - loss: 3.0734 - accuracy30: 0.4687 - val_loss: 3.2634 - val_accuracy30: 0.3979 - 14s/epoch - 28ms/step
Epoch 19/50
494/494 - 14s - loss: 3.0692 - accuracy30: 0.4702 - val_loss: 3.2635 - val_accuracy30: 0.3982 - 14s/epoch - 28ms/step
Epoch 20/50
494/494 - 14s - loss: 3.0621 - accuracy30: 0.4719 - val_loss: 3.2700 - val_accuracy30: 0.3993 - 14s/epoch - 28ms/step
Epoch 21/50
494/494 - 14s - loss: 3.0560 - accuracy30: 0.4759 - val_loss: 3.2697 - val_accuracy30: 0.3990 - 14s/epoch - 28ms/step
Epoch 22/50
494/494 - 14s - loss: 3.0471 - accuracy30: 0.4776 - val_loss: 3.2771 - val_accuracy30: 0.3973 - 14s/epoch - 28ms/step
Epoch 23/50
494/494 - 14s - loss: 3.0403 - accuracy30: 0.4818 - val_loss: 3.2873 - val_accuracy30: 0.3959 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h30
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885928
{'0': {'precision': 0.4125351940261966, 'recall': 0.3618777000404748, 'f1-score': 0.3855495907770835, 'support': 121063}, '1': {'precision': 0.36360261819621625, 'recall': 0.47594059245582493, 'f1-score': 0.41225572031817737, 'support': 123486}, '2': {'precision': 0.4144671277886864, 'recall': 0.33702951866680575, 'f1-score': 0.37175856270466406, 'support': 124633}, 'accuracy': 0.39164152098423, 'macro avg': {'precision': 0.39686831333703304, 'recall': 0.39161593705436853, 'f1-score': 0.389854624599975, 'support': 369182}, 'weighted avg': {'precision': 0.39682016632083567, 'recall': 0.39164152098423, 'f1-score': 0.389826657131244, 'support': 369182}}
[[43810 50449 26804]
 [32176 58772 32538]
 [30211 52417 42005]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0509633
{'0': {'precision': 0.4523296644929033, 'recall': 0.3671880614175869, 'f1-score': 0.4053360833465546, 'support': 41747}, '1': {'precision': 0.4024861414412901, 'recall': 0.5156014633096622, 'f1-score': 0.4520754716981132, 'support': 41823}, '2': {'precision': 0.4602683975993612, 'recall': 0.4182916266766544, 'f1-score': 0.4382772068381938, 'support': 42719}, 'accuracy': 0.43362446452185066, 'macro avg': {'precision': 0.43836140117785155, 'recall': 0.4336937171346345, 'f1-score': 0.4318962539609538, 'support': 126289}, 'weighted avg': {'precision': 0.43850842174798615, 'recall': 0.43362446452185066, 'f1-score': 0.43195750954730505, 'support': 126289}}
[[15329 16417 10001]
 [ 9306 21564 10953]
 [ 9254 15596 17869]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816529
{'0': {'precision': 0.4354096348573182, 'recall': 0.33071783716594155, 'f1-score': 0.37591063623118015, 'support': 12872}, '1': {'precision': 0.3723192571302233, 'recall': 0.5261266890572522, 'f1-score': 0.4360576145007283, 'support': 12803}, '2': {'precision': 0.42270648895806984, 'recall': 0.34835244127315, 'f1-score': 0.3819444444444444, 'support': 12473}, 'accuracy': 0.40206563908986054, 'macro avg': {'precision': 0.4101451269818705, 'recall': 0.40173232249878127, 'f1-score': 0.3979708983921176, 'support': 38148}, 'weighted avg': {'precision': 0.41008216173051415, 'recall': 0.40206563908986054, 'f1-score': 0.3980696341505749, 'support': 38148}}
[[4257 5903 2712]
 [2845 6736 3222]
 [2675 5453 4345]]
training model: results/PCAR/W8/deepOF_L2/h50
Epoch 1/50
494/494 - 16s - loss: 3.3061 - accuracy50: 0.3587 - val_loss: 3.3042 - val_accuracy50: 0.3552 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2548 - accuracy50: 0.3880 - val_loss: 3.2802 - val_accuracy50: 0.3702 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2273 - accuracy50: 0.4010 - val_loss: 3.2709 - val_accuracy50: 0.3793 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2069 - accuracy50: 0.4099 - val_loss: 3.2763 - val_accuracy50: 0.3730 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.1874 - accuracy50: 0.4198 - val_loss: 3.2787 - val_accuracy50: 0.3747 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.1739 - accuracy50: 0.4265 - val_loss: 3.2866 - val_accuracy50: 0.3738 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.1618 - accuracy50: 0.4323 - val_loss: 3.2877 - val_accuracy50: 0.3734 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1530 - accuracy50: 0.4362 - val_loss: 3.3017 - val_accuracy50: 0.3694 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1468 - accuracy50: 0.4395 - val_loss: 3.2940 - val_accuracy50: 0.3725 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1386 - accuracy50: 0.4437 - val_loss: 3.3029 - val_accuracy50: 0.3718 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1318 - accuracy50: 0.4453 - val_loss: 3.2943 - val_accuracy50: 0.3736 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1254 - accuracy50: 0.4485 - val_loss: 3.2970 - val_accuracy50: 0.3740 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1198 - accuracy50: 0.4514 - val_loss: 3.3003 - val_accuracy50: 0.3721 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h50
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0964731
{'0': {'precision': 0.3844528813289089, 'recall': 0.32039230015446196, 'f1-score': 0.34951148475116744, 'support': 120418}, '1': {'precision': 0.3500513585560909, 'recall': 0.45729963737439894, 'f1-score': 0.39655208239539536, 'support': 125198}, '2': {'precision': 0.3792995354934314, 'recall': 0.3231471440363854, 'f1-score': 0.3489789764856515, 'support': 123566}, 'accuracy': 0.3677427393534896, 'macro avg': {'precision': 0.3712679251261437, 'recall': 0.3669463605217487, 'f1-score': 0.3650141812107381, 'support': 369182}, 'weighted avg': {'precision': 0.3710617079249567, 'recall': 0.3677427393534896, 'f1-score': 0.36528578801493794, 'support': 369182}}
[[38581 51192 30645]
 [33247 57253 34698]
 [28525 55111 39930]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784515
{'0': {'precision': 0.40589738436360506, 'recall': 0.3392608591312695, 'f1-score': 0.36959960260918445, 'support': 41670}, '1': {'precision': 0.3768634226704705, 'recall': 0.44753542968936394, 'f1-score': 0.4091702294738679, 'support': 41914}, '2': {'precision': 0.4054358777527227, 'recall': 0.3957616204191547, 'f1-score': 0.4005403419795949, 'support': 42705}, 'accuracy': 0.3943019582069697, 'macro avg': {'precision': 0.39606556159559947, 'recall': 0.3941859697465961, 'f1-score': 0.39310339135421574, 'support': 126289}, 'weighted avg': {'precision': 0.39610525591042406, 'recall': 0.3943019582069697, 'f1-score': 0.3931953831539644, 'support': 126289}}
[[14137 15299 12234]
 [10605 18758 12551]
 [10087 15717 16901]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898535
{'0': {'precision': 0.4049512825611454, 'recall': 0.32485244855638856, 'f1-score': 0.36050628429810583, 'support': 12538}, '1': {'precision': 0.3700273126707042, 'recall': 0.4680435598948554, 'f1-score': 0.4133037105812912, 'support': 13315}, '2': {'precision': 0.37971194879089615, 'recall': 0.34737698251321675, 'f1-score': 0.36282546829206136, 'support': 12295}, 'accuracy': 0.38209080423613295, 'macro avg': {'precision': 0.3848968480075819, 'recall': 0.3800909969881536, 'f1-score': 0.37887848772381943, 'support': 38148}, 'weighted avg': {'precision': 0.3846270121460138, 'recall': 0.38209080423613295, 'f1-score': 0.37968191862143336, 'support': 38148}}
[[4073 5233 3232]
 [3338 6232 3745]
 [2647 5377 4271]]
training model: results/PCAR/W8/deepOF_L2/h100
Epoch 1/50
494/494 - 16s - loss: 3.3174 - accuracy100: 0.3526 - val_loss: 3.3205 - val_accuracy100: 0.3473 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2771 - accuracy100: 0.3712 - val_loss: 3.3114 - val_accuracy100: 0.3496 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2502 - accuracy100: 0.3876 - val_loss: 3.3037 - val_accuracy100: 0.3561 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2256 - accuracy100: 0.3996 - val_loss: 3.2982 - val_accuracy100: 0.3625 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.2111 - accuracy100: 0.4070 - val_loss: 3.2924 - val_accuracy100: 0.3663 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.1987 - accuracy100: 0.4161 - val_loss: 3.2975 - val_accuracy100: 0.3642 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.1884 - accuracy100: 0.4218 - val_loss: 3.2983 - val_accuracy100: 0.3665 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1821 - accuracy100: 0.4242 - val_loss: 3.3027 - val_accuracy100: 0.3646 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1758 - accuracy100: 0.4282 - val_loss: 3.3015 - val_accuracy100: 0.3683 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1702 - accuracy100: 0.4313 - val_loss: 3.3069 - val_accuracy100: 0.3668 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1659 - accuracy100: 0.4325 - val_loss: 3.3080 - val_accuracy100: 0.3685 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1599 - accuracy100: 0.4348 - val_loss: 3.3085 - val_accuracy100: 0.3686 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1560 - accuracy100: 0.4378 - val_loss: 3.3058 - val_accuracy100: 0.3698 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 3.1519 - accuracy100: 0.4384 - val_loss: 3.3077 - val_accuracy100: 0.3709 - 14s/epoch - 28ms/step
Epoch 15/50
494/494 - 14s - loss: 3.1475 - accuracy100: 0.4411 - val_loss: 3.3083 - val_accuracy100: 0.3708 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h100
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976671
{'0': {'precision': 0.3716964900206469, 'recall': 0.18330151457299224, 'f1-score': 0.24552351186248048, 'support': 117855}, '1': {'precision': 0.367413882952723, 'recall': 0.6970897747392141, 'f1-score': 0.4812016549739162, 'support': 130471}, '2': {'precision': 0.36162843783945464, 'recall': 0.19006917323095254, 'f1-score': 0.24917424624546447, 'support': 120856}, 'accuracy': 0.36709265348798154, 'macro avg': {'precision': 0.36691293693760824, 'recall': 0.35682015418105295, 'f1-score': 0.3252998043606204, 'support': 369182}, 'weighted avg': {'precision': 0.36688709914793566, 'recall': 0.36709265348798154, 'f1-score': 0.33000860638085366, 'support': 369182}}
[[21603 76046 20206]
 [19177 90950 20344]
 [17340 80545 22971]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0836517
{'0': {'precision': 0.4090614886731392, 'recall': 0.21248288945990731, 'f1-score': 0.27968579602029364, 'support': 41641}, '1': {'precision': 0.36334632181803916, 'recall': 0.6683181413694413, 'f1-score': 0.47075565193084695, 'support': 41579}, '2': {'precision': 0.40506014690749087, 'recall': 0.2650398198240033, 'f1-score': 0.32042105263157894, 'support': 43069}, 'accuracy': 0.3804844444092518, 'macro avg': {'precision': 0.39248931913288976, 'recall': 0.38194695021778396, 'f1-score': 0.3569541668609065, 'support': 126289}, 'weighted avg': {'precision': 0.39264576987599203, 'recall': 0.3804844444092518, 'f1-score': 0.35648520298286634, 'support': 126289}}
[[ 8848 23791  9002]
 [ 6027 27788  7764]
 [ 6755 24899 11415]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985526
{'0': {'precision': 0.40434350132625996, 'recall': 0.19529185683401393, 'f1-score': 0.26337670752119213, 'support': 12489}, '1': {'precision': 0.3566770738647591, 'recall': 0.6878286715951528, 'f1-score': 0.46975848428065786, 'support': 13121}, '2': {'precision': 0.3669455452810803, 'recall': 0.19939384271813687, 'f1-score': 0.25838457960828903, 'support': 12538}, 'accuracy': 0.36604802348746984, 'macro avg': {'precision': 0.3759887068240331, 'recall': 0.3608381237157679, 'f1-score': 0.3305065904700464, 'support': 38148}, 'weighted avg': {'precision': 0.3756571542669956, 'recall': 0.36604802348746984, 'f1-score': 0.3327209455700799, 'support': 38148}}
[[2439 7952 2098]
 [1881 9025 2215]
 [1712 8326 2500]]
training model: results/PCAR/W8/deepOF_L2/h200
Epoch 1/50
494/494 - 16s - loss: 3.3232 - accuracy200: 0.3473 - val_loss: 3.3340 - val_accuracy200: 0.3374 - 16s/epoch - 33ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2836 - accuracy200: 0.3645 - val_loss: 3.3279 - val_accuracy200: 0.3378 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2626 - accuracy200: 0.3750 - val_loss: 3.3269 - val_accuracy200: 0.3390 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2423 - accuracy200: 0.3869 - val_loss: 3.3330 - val_accuracy200: 0.3377 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.2253 - accuracy200: 0.3979 - val_loss: 3.3496 - val_accuracy200: 0.3366 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.2136 - accuracy200: 0.4048 - val_loss: 3.3734 - val_accuracy200: 0.3347 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.2035 - accuracy200: 0.4119 - val_loss: 3.3810 - val_accuracy200: 0.3348 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1972 - accuracy200: 0.4148 - val_loss: 3.3909 - val_accuracy200: 0.3322 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1891 - accuracy200: 0.4194 - val_loss: 3.3999 - val_accuracy200: 0.3331 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1832 - accuracy200: 0.4221 - val_loss: 3.4018 - val_accuracy200: 0.3355 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1787 - accuracy200: 0.4247 - val_loss: 3.3996 - val_accuracy200: 0.3362 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1729 - accuracy200: 0.4276 - val_loss: 3.4081 - val_accuracy200: 0.3349 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1669 - accuracy200: 0.4308 - val_loss: 3.4104 - val_accuracy200: 0.3366 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h200
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091136
{'0': {'precision': 0.35233368271780013, 'recall': 0.09400858736242947, 'f1-score': 0.14841700646702857, 'support': 121574}, '1': {'precision': 0.34117799343693367, 'recall': 0.7987861314287118, 'f1-score': 0.47813478259803743, 'support': 122089}, '2': {'precision': 0.36061451416447293, 'recall': 0.146240808164501, 'f1-score': 0.20809314083924252, 'support': 125519}, 'accuracy': 0.3448380473587553, 'macro avg': {'precision': 0.3513753967730689, 'recall': 0.3463451756518807, 'f1-score': 0.2782149766347695, 'support': 369182}, 'weighted avg': {'precision': 0.35145989887607226, 'recall': 0.3448380473587553, 'f1-score': 0.2777445529896777, 'support': 369182}}
[[11429 92198 17947]
 [ 9967 97523 14599]
 [11042 96121 18356]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953832
{'0': {'precision': 0.3855629019110588, 'recall': 0.10273427130342448, 'f1-score': 0.16223941461183733, 'support': 41437}, '1': {'precision': 0.35231769513602107, 'recall': 0.7849661269398933, 'f1-score': 0.4863472973676964, 'support': 41626}, '2': {'precision': 0.3930237724950011, 'recall': 0.20462221810947115, 'f1-score': 0.2691272002555872, 'support': 43226}, 'accuracy': 0.3624781255691311, 'macro avg': {'precision': 0.37696812318069367, 'recall': 0.364107538784263, 'f1-score': 0.3059046374117069, 'support': 126289}, 'weighted avg': {'precision': 0.37715867521390994, 'recall': 0.3624781255691311, 'f1-score': 0.30565369574346496, 'support': 126289}}
[[ 4257 29454  7726]
 [ 3017 32675  5934]
 [ 3767 30614  8845]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090308
{'0': {'precision': 0.3547860176412937, 'recall': 0.08555896951075397, 'f1-score': 0.1378697473657484, 'support': 12693}, '1': {'precision': 0.3341247283063033, 'recall': 0.8054816606207175, 'f1-score': 0.47232332781848263, 'support': 12405}, '2': {'precision': 0.34947896565032804, 'recall': 0.13877394636015325, 'f1-score': 0.19866169372531814, 'support': 13050}, 'accuracy': 0.3378683024011744, 'macro avg': {'precision': 0.34612990386597503, 'recall': 0.34327152549720824, 'f1-score': 0.2696182563031831, 'support': 38148}, 'weighted avg': {'precision': 0.3462518789529573, 'recall': 0.3378683024011744, 'f1-score': 0.26742389346799633, 'support': 38148}}
[[ 1086  9750  1857]
 [  899  9992  1514]
 [ 1076 10163  1811]]
training model: results/PCAR/W8/deepOF_L2/h300
Epoch 1/50
494/494 - 16s - loss: 3.3214 - accuracy300: 0.3537 - val_loss: 3.3412 - val_accuracy300: 0.3338 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2827 - accuracy300: 0.3714 - val_loss: 3.3415 - val_accuracy300: 0.3351 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2597 - accuracy300: 0.3842 - val_loss: 3.3410 - val_accuracy300: 0.3365 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2402 - accuracy300: 0.3922 - val_loss: 3.3561 - val_accuracy300: 0.3335 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.2194 - accuracy300: 0.4031 - val_loss: 3.3751 - val_accuracy300: 0.3322 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.2077 - accuracy300: 0.4089 - val_loss: 3.4045 - val_accuracy300: 0.3296 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.1980 - accuracy300: 0.4147 - val_loss: 3.4119 - val_accuracy300: 0.3301 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1913 - accuracy300: 0.4184 - val_loss: 3.4288 - val_accuracy300: 0.3301 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1845 - accuracy300: 0.4223 - val_loss: 3.4302 - val_accuracy300: 0.3296 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1799 - accuracy300: 0.4238 - val_loss: 3.4245 - val_accuracy300: 0.3290 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1739 - accuracy300: 0.4279 - val_loss: 3.4240 - val_accuracy300: 0.3308 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1699 - accuracy300: 0.4284 - val_loss: 3.4325 - val_accuracy300: 0.3296 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1644 - accuracy300: 0.4321 - val_loss: 3.4350 - val_accuracy300: 0.3305 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h300
Evaluating performance on  test set...
1443/1443 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1124701
{'0': {'precision': 0.34470163179417956, 'recall': 0.0719196805778757, 'f1-score': 0.11900894417600494, 'support': 120718}, '1': {'precision': 0.34152599992154914, 'recall': 0.8473310301201888, 'f1-score': 0.4868299047130909, 'support': 123306}, '2': {'precision': 0.3564918179191511, 'recall': 0.1084389331884498, 'f1-score': 0.16629397962371884, 'support': 125158}, 'accuracy': 0.3432859673548548, 'macro avg': {'precision': 0.3475731498782933, 'recall': 0.34256321462883815, 'f1-score': 0.2573776095042715, 'support': 369182}, 'weighted avg': {'precision': 0.34763801994783444, 'recall': 0.3432859673548548, 'f1-score': 0.2578906660003379, 'support': 369182}}
[[  8682  98321  13715]
 [  8041 104481  10784]
 [  8464 103122  13572]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020677
{'0': {'precision': 0.37920636835122423, 'recall': 0.07569884188476633, 'f1-score': 0.12620423892100194, 'support': 41533}, '1': {'precision': 0.34323126907551443, 'recall': 0.8481619346519719, 'f1-score': 0.4886979316338761, 'support': 41103}, '2': {'precision': 0.398526905283662, 'recall': 0.14997823746363365, 'f1-score': 0.21793911552737136, 'support': 43653}, 'accuracy': 0.35278607004568885, 'macro avg': {'precision': 0.37365484757013356, 'recall': 0.35794633800012393, 'f1-score': 0.27761376202741644, 'support': 126289}, 'weighted avg': {'precision': 0.37417596105670303, 'recall': 0.35278607004568885, 'f1-score': 0.2758932919665967, 'support': 126289}}
[[ 3144 32501  5888]
 [ 2248 34862  3993]
 [ 2899 34207  6547]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162926
{'0': {'precision': 0.3435873166114529, 'recall': 0.057733598409542744, 'f1-score': 0.09885620915032681, 'support': 12575}, '1': {'precision': 0.33105854743083, 'recall': 0.8691528171868667, 'f1-score': 0.47948299380576487, 'support': 12335}, '2': {'precision': 0.3546973431936456, 'recall': 0.09782444478017828, 'f1-score': 0.15335425424832733, 'support': 13238}, 'accuracy': 0.33401488937821117, 'macro avg': {'precision': 0.34311440241197616, 'recall': 0.3415702867921959, 'f1-score': 0.24389781906813965, 'support': 38148}, 'weighted avg': {'precision': 0.3433915570448199, 'recall': 0.33401488937821117, 'f1-score': 0.2408420671175114, 'support': 38148}}
[[  726 10478  1371]
 [  629 10721   985]
 [  758 11185  1295]]
training model: results/PCAR/W8/deepOF_L2/h500
Epoch 1/50
494/494 - 16s - loss: 3.3226 - accuracy500: 0.3540 - val_loss: 3.3645 - val_accuracy500: 0.3350 - 16s/epoch - 33ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2911 - accuracy500: 0.3682 - val_loss: 3.3599 - val_accuracy500: 0.3350 - 14s/epoch - 29ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2679 - accuracy500: 0.3803 - val_loss: 3.3756 - val_accuracy500: 0.3330 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2482 - accuracy500: 0.3911 - val_loss: 3.3844 - val_accuracy500: 0.3359 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.2321 - accuracy500: 0.3990 - val_loss: 3.4060 - val_accuracy500: 0.3347 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.2215 - accuracy500: 0.4043 - val_loss: 3.4347 - val_accuracy500: 0.3333 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.2125 - accuracy500: 0.4099 - val_loss: 3.4452 - val_accuracy500: 0.3340 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.2060 - accuracy500: 0.4117 - val_loss: 3.4749 - val_accuracy500: 0.3329 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1996 - accuracy500: 0.4166 - val_loss: 3.4835 - val_accuracy500: 0.3330 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.1953 - accuracy500: 0.4168 - val_loss: 3.5000 - val_accuracy500: 0.3316 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.1897 - accuracy500: 0.4210 - val_loss: 3.4994 - val_accuracy500: 0.3343 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.1845 - accuracy500: 0.4241 - val_loss: 3.5116 - val_accuracy500: 0.3336 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h500
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1149467
{'0': {'precision': 0.3386189776584427, 'recall': 0.055978493002688375, 'f1-score': 0.09607451380603989, 'support': 119403}, '1': {'precision': 0.34534580585799723, 'recall': 0.8922769703789404, 'f1-score': 0.4979612775404428, 'support': 126194}, '2': {'precision': 0.3419826443807977, 'recall': 0.06473277501314885, 'f1-score': 0.1088598293622175, 'support': 123585}, 'accuracy': 0.3447730387722045, 'macro avg': {'precision': 0.3419824759657459, 'recall': 0.3376627461315926, 'f1-score': 0.2342985402362334, 'support': 369182}, 'weighted avg': {'precision': 0.34204434538952605, 'recall': 0.3447730387722045, 'f1-score': 0.23772760492562167, 'support': 369182}}
[[  6684 104510   8209]
 [  6410 112600   7184]
 [  6645 108940   8000]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137263
{'0': {'precision': 0.3704173940644342, 'recall': 0.05695600185460846, 'f1-score': 0.09873096446700506, 'support': 40979}, '1': {'precision': 0.33700753420962726, 'recall': 0.8967464114832536, 'f1-score': 0.4899036764994184, 'support': 41800}, '2': {'precision': 0.37217530244236474, 'recall': 0.07494828774994254, 'f1-score': 0.1247704315886134, 'support': 43510}, 'accuracy': 0.3411144280182755, 'macro avg': {'precision': 0.35986674357214204, 'recall': 0.3428835670292682, 'f1-score': 0.237801690851679, 'support': 126289}, 'weighted avg': {'precision': 0.35996481665541863, 'recall': 0.3411144280182755, 'f1-score': 0.23717529910752053, 'support': 126289}}
[[ 2334 35578  3067]
 [ 1882 37484  2434]
 [ 2085 38164  3261]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1201886
{'0': {'precision': 0.3429095354523227, 'recall': 0.04594218327737286, 'f1-score': 0.08102838159890229, 'support': 12211}, '1': {'precision': 0.33345965485074625, 'recall': 0.9068495322657365, 'f1-score': 0.48761669295366383, 'support': 12614}, '2': {'precision': 0.35643115942028986, 'recall': 0.05907077985438715, 'f1-score': 0.10134569570536346, 'support': 13323}, 'accuracy': 0.3351945056097305, 'macro avg': {'precision': 0.34426678324111964, 'recall': 0.3372874984658322, 'f1-score': 0.22333025675264317, 'support': 38148}, 'weighted avg': {'precision': 0.3445072024916679, 'recall': 0.3351945056097305, 'f1-score': 0.22256640548663806, 'support': 38148}}
[[  561 10896   754]
 [  508 11439   667]
 [  567 11969   787]]
training model: results/PCAR/W8/deepOF_L2/h1000
Epoch 1/50
494/494 - 16s - loss: 3.3350 - accuracy1000: 0.3477 - val_loss: 3.3469 - val_accuracy1000: 0.3422 - 16s/epoch - 33ms/step
Epoch 2/50
494/494 - 14s - loss: 3.3032 - accuracy1000: 0.3572 - val_loss: 3.3328 - val_accuracy1000: 0.3362 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 14s - loss: 3.2815 - accuracy1000: 0.3706 - val_loss: 3.3254 - val_accuracy1000: 0.3384 - 14s/epoch - 28ms/step
Epoch 4/50
494/494 - 14s - loss: 3.2653 - accuracy1000: 0.3779 - val_loss: 3.3248 - val_accuracy1000: 0.3405 - 14s/epoch - 28ms/step
Epoch 5/50
494/494 - 14s - loss: 3.2526 - accuracy1000: 0.3880 - val_loss: 3.3336 - val_accuracy1000: 0.3378 - 14s/epoch - 28ms/step
Epoch 6/50
494/494 - 14s - loss: 3.2432 - accuracy1000: 0.3917 - val_loss: 3.3432 - val_accuracy1000: 0.3351 - 14s/epoch - 28ms/step
Epoch 7/50
494/494 - 14s - loss: 3.2348 - accuracy1000: 0.3979 - val_loss: 3.3556 - val_accuracy1000: 0.3282 - 14s/epoch - 28ms/step
Epoch 8/50
494/494 - 14s - loss: 3.2273 - accuracy1000: 0.4020 - val_loss: 3.3746 - val_accuracy1000: 0.3263 - 14s/epoch - 28ms/step
Epoch 9/50
494/494 - 14s - loss: 3.2206 - accuracy1000: 0.4066 - val_loss: 3.3749 - val_accuracy1000: 0.3275 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 14s - loss: 3.2157 - accuracy1000: 0.4080 - val_loss: 3.3852 - val_accuracy1000: 0.3257 - 14s/epoch - 28ms/step
Epoch 11/50
494/494 - 14s - loss: 3.2098 - accuracy1000: 0.4107 - val_loss: 3.3969 - val_accuracy1000: 0.3233 - 14s/epoch - 28ms/step
Epoch 12/50
494/494 - 14s - loss: 3.2043 - accuracy1000: 0.4150 - val_loss: 3.4053 - val_accuracy1000: 0.3231 - 14s/epoch - 28ms/step
Epoch 13/50
494/494 - 14s - loss: 3.1996 - accuracy1000: 0.4167 - val_loss: 3.4110 - val_accuracy1000: 0.3258 - 14s/epoch - 28ms/step
Epoch 14/50
494/494 - 14s - loss: 3.1941 - accuracy1000: 0.4190 - val_loss: 3.4077 - val_accuracy1000: 0.3254 - 14s/epoch - 28ms/step
testing model: results/PCAR/W8/deepOF_L2/h1000
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1131411
{'0': {'precision': 0.36169425691297513, 'recall': 0.09405738197734542, 'f1-score': 0.14929190365309003, 'support': 124743}, '1': {'precision': 0.3133851707858928, 'recall': 0.7377625234943205, 'f1-score': 0.43990741868680716, 'support': 110133}, '2': {'precision': 0.3802455112235546, 'recall': 0.21933495152859886, 'f1-score': 0.2781982934879614, 'support': 134306}, 'accuracy': 0.3316602651266855, 'macro avg': {'precision': 0.35177497964080745, 'recall': 0.35038495233342165, 'f1-score': 0.2891325386092862, 'support': 369182}, 'weighted avg': {'precision': 0.35403169530109463, 'recall': 0.3316602651266855, 'f1-score': 0.28288254488253944, 'support': 369182}}
[[11733 84711 28299]
 [ 9167 81252 19714]
 [11539 93309 29458]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0951198
{'0': {'precision': 0.37623301693653455, 'recall': 0.10003216468317787, 'f1-score': 0.15804389891132262, 'support': 40417}, '1': {'precision': 0.3584143794921492, 'recall': 0.7525373640481554, 'f1-score': 0.48556602741438865, 'support': 41283}, '2': {'precision': 0.40954129711751663, 'recall': 0.2651102289802418, 'f1-score': 0.32186568281758404, 'support': 44589}, 'accuracy': 0.3716158968714615, 'macro avg': {'precision': 0.3813962311820667, 'recall': 0.37255991923719173, 'f1-score': 0.3218252030477651, 'support': 126289}, 'weighted avg': {'precision': 0.3821684198249353, 'recall': 0.3716158968714615, 'f1-score': 0.3229493582433972, 'support': 126289}}
[[ 4043 26623  9751]
 [ 2924 31067  7292]
 [ 3779 28989 11821]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091951
{'0': {'precision': 0.3513318934485241, 'recall': 0.07745417030394414, 'f1-score': 0.12692632810976007, 'support': 12601}, '1': {'precision': 0.3250138453018276, 'recall': 0.7522002905237973, 'f1-score': 0.45390326905228423, 'support': 11703}, '2': {'precision': 0.3745322872661436, 'recall': 0.22414042184339786, 'f1-score': 0.2804464729540422, 'support': 13844}, 'accuracy': 0.33768480654293803, 'macro avg': {'precision': 0.3502926753388318, 'recall': 0.35126496089037973, 'f1-score': 0.2870920233720288, 'support': 38148}, 'weighted avg': {'precision': 0.35167755074511464, 'recall': 0.33768480654293803, 'f1-score': 0.28294876768915095, 'support': 38148}}
[[ 976 8565 3060]
 [ 778 8803 2122]
 [1024 9717 3103]]
training model: results/PCAR/W8/deepVOL_L2/h10
Epoch 1/50
494/494 - 17s - loss: 3.2881 - accuracy10: 0.3824 - val_loss: 3.3664 - val_accuracy10: 0.3654 - 17s/epoch - 35ms/step
Epoch 2/50
494/494 - 14s - loss: 3.1918 - accuracy10: 0.4243 - val_loss: 3.2729 - val_accuracy10: 0.4053 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 13s - loss: 3.1159 - accuracy10: 0.4550 - val_loss: 3.2573 - val_accuracy10: 0.4079 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 14s - loss: 3.0894 - accuracy10: 0.4652 - val_loss: 3.2372 - val_accuracy10: 0.4128 - 14s/epoch - 29ms/step
Epoch 5/50
494/494 - 13s - loss: 3.0695 - accuracy10: 0.4721 - val_loss: 3.2438 - val_accuracy10: 0.4199 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.0537 - accuracy10: 0.4769 - val_loss: 3.2393 - val_accuracy10: 0.4253 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.0392 - accuracy10: 0.4823 - val_loss: 3.1832 - val_accuracy10: 0.4418 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.0278 - accuracy10: 0.4857 - val_loss: 3.1830 - val_accuracy10: 0.4478 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.0201 - accuracy10: 0.4892 - val_loss: 3.1860 - val_accuracy10: 0.4442 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.0145 - accuracy10: 0.4901 - val_loss: 3.1676 - val_accuracy10: 0.4446 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.0048 - accuracy10: 0.4928 - val_loss: 3.1645 - val_accuracy10: 0.4469 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 2.9983 - accuracy10: 0.4929 - val_loss: 3.1427 - val_accuracy10: 0.4517 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 2.9911 - accuracy10: 0.4952 - val_loss: 3.1491 - val_accuracy10: 0.4489 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 2.9844 - accuracy10: 0.4958 - val_loss: 3.1634 - val_accuracy10: 0.4515 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 2.9787 - accuracy10: 0.4979 - val_loss: 3.1743 - val_accuracy10: 0.4475 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 2.9746 - accuracy10: 0.4991 - val_loss: 3.1642 - val_accuracy10: 0.4532 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 2.9679 - accuracy10: 0.5016 - val_loss: 3.1575 - val_accuracy10: 0.4537 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 2.9647 - accuracy10: 0.5019 - val_loss: 3.1641 - val_accuracy10: 0.4540 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 2.9609 - accuracy10: 0.5037 - val_loss: 3.1575 - val_accuracy10: 0.4558 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 2.9554 - accuracy10: 0.5047 - val_loss: 3.1503 - val_accuracy10: 0.4549 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 2.9500 - accuracy10: 0.5062 - val_loss: 3.1515 - val_accuracy10: 0.4569 - 13s/epoch - 27ms/step
Epoch 22/50
494/494 - 13s - loss: 2.9459 - accuracy10: 0.5077 - val_loss: 3.1648 - val_accuracy10: 0.4551 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h10
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0589719
{'0': {'precision': 0.4823517952589093, 'recall': 0.3237582334962326, 'f1-score': 0.38745421738003605, 'support': 122366}, '1': {'precision': 0.4508443822151103, 'recall': 0.5081851049609869, 'f1-score': 0.47780053222698765, 'support': 124189}, '2': {'precision': 0.42247909158903924, 'recall': 0.5066703633635593, 'f1-score': 0.46076039480611936, 'support': 122632}, 'accuracy': 0.4465541852773798, 'macro avg': {'precision': 0.45189175635435297, 'recall': 0.446204567273593, 'f1-score': 0.4420050481377144, 'support': 369187}, 'weighted avg': {'precision': 0.4518653926636395, 'recall': 0.4465541852773798, 'f1-score': 0.44219531510190474, 'support': 369187}}
[[39617 36138 46611]
 [22753 63111 38325]
 [19763 40735 62134]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0266573
{'0': {'precision': 0.4943944127917662, 'recall': 0.320520458499154, 'f1-score': 0.3889081656257229, 'support': 41963}, '1': {'precision': 0.4717119350839626, 'recall': 0.602866333781448, 'f1-score': 0.5292853078171433, 'support': 41656}, '2': {'precision': 0.45726188139326923, 'recall': 0.4912942610081316, 'f1-score': 0.4736675628657283, 'support': 42673}, 'accuracy': 0.47135210464637506, 'macro avg': {'precision': 0.4744560764229993, 'recall': 0.47156035109624456, 'f1-score': 0.46395367876953153, 'support': 126292}, 'weighted avg': {'precision': 0.4743660831765544, 'recall': 0.47135210464637506, 'f1-score': 0.4638494761881383, 'support': 126292}}
[[13450 13496 15017]
 [ 6676 25113  9867]
 [ 7079 14629 20965]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0481308
{'0': {'precision': 0.49475863854018376, 'recall': 0.29598947042428, 'f1-score': 0.37039190040207337, 'support': 12916}, '1': {'precision': 0.45052950075642967, 'recall': 0.5842881808193376, 'f1-score': 0.5087641370827212, 'support': 12742}, '2': {'precision': 0.4363126079447323, 'recall': 0.4854283426741393, 'f1-score': 0.45956188888046695, 'support': 12490}, 'accuracy': 0.4543095312991507, 'macro avg': {'precision': 0.46053358241378195, 'recall': 0.455235331305919, 'f1-score': 0.4462393087884205, 'support': 38148}, 'weighted avg': {'precision': 0.46084968929572057, 'recall': 0.4543095312991507, 'f1-score': 0.4458053479191109, 'support': 38148}}
[[3823 4538 4555]
 [2019 7445 3278]
 [1885 4542 6063]]
training model: results/PCAR/W8/deepVOL_L2/h20
Epoch 1/50
494/494 - 17s - loss: 3.2959 - accuracy20: 0.3812 - val_loss: 3.2692 - val_accuracy20: 0.3842 - 17s/epoch - 35ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2199 - accuracy20: 0.4115 - val_loss: 3.2479 - val_accuracy20: 0.3954 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.1830 - accuracy20: 0.4281 - val_loss: 3.2237 - val_accuracy20: 0.4106 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.1592 - accuracy20: 0.4374 - val_loss: 3.2100 - val_accuracy20: 0.4184 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.1406 - accuracy20: 0.4452 - val_loss: 3.2073 - val_accuracy20: 0.4241 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 14s - loss: 3.1296 - accuracy20: 0.4504 - val_loss: 3.1943 - val_accuracy20: 0.4277 - 14s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.1197 - accuracy20: 0.4548 - val_loss: 3.1840 - val_accuracy20: 0.4305 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.1125 - accuracy20: 0.4570 - val_loss: 3.1838 - val_accuracy20: 0.4318 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.1063 - accuracy20: 0.4610 - val_loss: 3.1903 - val_accuracy20: 0.4321 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.0997 - accuracy20: 0.4635 - val_loss: 3.1899 - val_accuracy20: 0.4298 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.0946 - accuracy20: 0.4641 - val_loss: 3.1844 - val_accuracy20: 0.4318 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.0904 - accuracy20: 0.4650 - val_loss: 3.1831 - val_accuracy20: 0.4327 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.0817 - accuracy20: 0.4672 - val_loss: 3.1890 - val_accuracy20: 0.4306 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.0779 - accuracy20: 0.4690 - val_loss: 3.1832 - val_accuracy20: 0.4319 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.0733 - accuracy20: 0.4717 - val_loss: 3.1877 - val_accuracy20: 0.4299 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.0689 - accuracy20: 0.4724 - val_loss: 3.1848 - val_accuracy20: 0.4292 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.0654 - accuracy20: 0.4724 - val_loss: 3.1857 - val_accuracy20: 0.4321 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.0608 - accuracy20: 0.4733 - val_loss: 3.1790 - val_accuracy20: 0.4331 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.0574 - accuracy20: 0.4757 - val_loss: 3.1796 - val_accuracy20: 0.4360 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.0526 - accuracy20: 0.4771 - val_loss: 3.1820 - val_accuracy20: 0.4329 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 3.0506 - accuracy20: 0.4764 - val_loss: 3.1945 - val_accuracy20: 0.4322 - 13s/epoch - 27ms/step
Epoch 22/50
494/494 - 13s - loss: 3.0481 - accuracy20: 0.4788 - val_loss: 3.1915 - val_accuracy20: 0.4340 - 13s/epoch - 27ms/step
Epoch 23/50
494/494 - 13s - loss: 3.0432 - accuracy20: 0.4802 - val_loss: 3.1885 - val_accuracy20: 0.4332 - 13s/epoch - 27ms/step
Epoch 24/50
494/494 - 13s - loss: 3.0393 - accuracy20: 0.4814 - val_loss: 3.1910 - val_accuracy20: 0.4342 - 13s/epoch - 27ms/step
Epoch 25/50
494/494 - 13s - loss: 3.0350 - accuracy20: 0.4835 - val_loss: 3.1953 - val_accuracy20: 0.4337 - 13s/epoch - 27ms/step
Epoch 26/50
494/494 - 13s - loss: 3.0287 - accuracy20: 0.4846 - val_loss: 3.2106 - val_accuracy20: 0.4274 - 13s/epoch - 27ms/step
Epoch 27/50
494/494 - 13s - loss: 3.0247 - accuracy20: 0.4858 - val_loss: 3.1965 - val_accuracy20: 0.4292 - 13s/epoch - 27ms/step
Epoch 28/50
494/494 - 13s - loss: 3.0228 - accuracy20: 0.4861 - val_loss: 3.1941 - val_accuracy20: 0.4323 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h20
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0678011
{'0': {'precision': 0.45164343598055107, 'recall': 0.2904468477182333, 'f1-score': 0.3535376089802795, 'support': 119929}, '1': {'precision': 0.44401891252955084, 'recall': 0.36827739825410394, 'f1-score': 0.40261694583899615, 'support': 127499}, '2': {'precision': 0.40508931255098973, 'recall': 0.6198556164226053, 'f1-score': 0.4899714676162314, 'support': 121759}, 'accuracy': 0.4259657030177119, 'macro avg': {'precision': 0.4335838870203639, 'recall': 0.4261932874649809, 'f1-score': 0.4153753408118357, 'support': 369187}, 'weighted avg': {'precision': 0.43365660916882953, 'recall': 0.4259657030177119, 'f1-score': 0.41548349700939313, 'support': 369187}}
[[34833 29632 55464]
 [25169 46955 55375]
 [17123 29163 75473]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.042615
{'0': {'precision': 0.4834217238168495, 'recall': 0.2869329104190696, 'f1-score': 0.36011882322783, 'support': 41616}, '1': {'precision': 0.4586816758118833, 'recall': 0.46486705809346507, 'f1-score': 0.46175365393961665, 'support': 41898}, '2': {'precision': 0.4325023677445542, 'recall': 0.5978072841180045, 'f1-score': 0.5018939022236177, 'support': 42778}, 'accuracy': 0.4512637380039908, 'macro avg': {'precision': 0.4582019224577623, 'recall': 0.4498690842101798, 'f1-score': 0.44125545979702147, 'support': 126292}, 'weighted avg': {'precision': 0.45796653468869636, 'recall': 0.4512637380039908, 'f1-score': 0.4418591588503892, 'support': 126292}}
[[11941 11617 18058]
 [ 6924 19477 15497]
 [ 5836 11369 25573]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059747
{'0': {'precision': 0.483539974348012, 'recall': 0.265409887359199, 'f1-score': 0.3427099641432251, 'support': 12784}, '1': {'precision': 0.4461353624349219, 'recall': 0.4266564534661049, 'f1-score': 0.43617854346123724, 'support': 13055}, '2': {'precision': 0.40512710500911725, 'recall': 0.6136972946624422, 'f1-score': 0.4880633177192699, 'support': 12309}, 'accuracy': 0.4329715843556674, 'macro avg': {'precision': 0.4449341472640171, 'recall': 0.43525454516258205, 'f1-score': 0.42231727510791073, 'support': 38148}, 'weighted avg': {'precision': 0.44543833816216094, 'recall': 0.4329715843556674, 'f1-score': 0.4215971071694436, 'support': 38148}}
[[3393 3748 5643]
 [2036 5570 5449]
 [1588 3167 7554]]
training model: results/PCAR/W8/deepVOL_L2/h30
Epoch 1/50
494/494 - 19s - loss: 3.2949 - accuracy30: 0.3805 - val_loss: 3.3028 - val_accuracy30: 0.3637 - 19s/epoch - 38ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2387 - accuracy30: 0.4038 - val_loss: 3.2670 - val_accuracy30: 0.3851 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2177 - accuracy30: 0.4137 - val_loss: 3.2443 - val_accuracy30: 0.4002 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.1999 - accuracy30: 0.4220 - val_loss: 3.2236 - val_accuracy30: 0.4124 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.1865 - accuracy30: 0.4298 - val_loss: 3.2122 - val_accuracy30: 0.4159 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.1790 - accuracy30: 0.4319 - val_loss: 3.2126 - val_accuracy30: 0.4181 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.1722 - accuracy30: 0.4331 - val_loss: 3.2096 - val_accuracy30: 0.4173 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 17s - loss: 3.1608 - accuracy30: 0.4377 - val_loss: 3.2030 - val_accuracy30: 0.4237 - 17s/epoch - 35ms/step
Epoch 9/50
494/494 - 14s - loss: 3.1551 - accuracy30: 0.4417 - val_loss: 3.2036 - val_accuracy30: 0.4186 - 14s/epoch - 28ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1477 - accuracy30: 0.4418 - val_loss: 3.1996 - val_accuracy30: 0.4232 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1418 - accuracy30: 0.4441 - val_loss: 3.2005 - val_accuracy30: 0.4226 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1375 - accuracy30: 0.4464 - val_loss: 3.2026 - val_accuracy30: 0.4233 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1328 - accuracy30: 0.4480 - val_loss: 3.2010 - val_accuracy30: 0.4195 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1298 - accuracy30: 0.4499 - val_loss: 3.2047 - val_accuracy30: 0.4201 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1232 - accuracy30: 0.4522 - val_loss: 3.2049 - val_accuracy30: 0.4221 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1189 - accuracy30: 0.4532 - val_loss: 3.2084 - val_accuracy30: 0.4198 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1160 - accuracy30: 0.4536 - val_loss: 3.2081 - val_accuracy30: 0.4184 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1102 - accuracy30: 0.4562 - val_loss: 3.2090 - val_accuracy30: 0.4178 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.1074 - accuracy30: 0.4580 - val_loss: 3.2091 - val_accuracy30: 0.4185 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.1015 - accuracy30: 0.4596 - val_loss: 3.2076 - val_accuracy30: 0.4197 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h30
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0720218
{'0': {'precision': 0.4129052338207103, 'recall': 0.4821581973171215, 'f1-score': 0.4448525909470226, 'support': 121064}, '1': {'precision': 0.4051189869342419, 'recall': 0.24455817569318478, 'f1-score': 0.30499813163396183, 'support': 123488}, '2': {'precision': 0.42176653270003656, 'recall': 0.5186745296265094, 'f1-score': 0.46522757613158355, 'support': 124635}, 'accuracy': 0.4150119045361836, 'macro avg': {'precision': 0.4132635844849963, 'recall': 0.4151303008789386, 'f1-score': 0.40502609957085606, 'support': 369187}, 'weighted avg': {'precision': 0.41329235452189594, 'recall': 0.4150119045361836, 'f1-score': 0.4049516432073311, 'support': 369187}}
[[58372 21530 41162]
 [45823 30200 47465]
 [37174 22816 64645]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0586784
{'0': {'precision': 0.43162356930902923, 'recall': 0.4896251592892693, 'f1-score': 0.4587984814860709, 'support': 41591}, '1': {'precision': 0.4325154387239523, 'recall': 0.31349035377471396, 'f1-score': 0.3635076812056787, 'support': 41778}, '2': {'precision': 0.43750895947246626, 'recall': 0.49772849055285046, 'f1-score': 0.4656799703555159, 'support': 42923}, 'accuracy': 0.43411300794983054, 'macro avg': {'precision': 0.43388265583514923, 'recall': 0.4336146678722779, 'f1-score': 0.42932871101575515, 'support': 126292}, 'weighted avg': {'precision': 0.43391887797784334, 'recall': 0.43411300794983054, 'f1-score': 0.429614646347099, 'support': 126292}}
[[20364  8393 12834]
 [14048 13097 14633]
 [12768  8791 21364]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664027
{'0': {'precision': 0.44147592436653144, 'recall': 0.4470196108828773, 'f1-score': 0.44423047296256357, 'support': 12901}, '1': {'precision': 0.41553748870822044, 'recall': 0.2889447236180904, 'f1-score': 0.34086698777324936, 'support': 12736}, '2': {'precision': 0.41518269764002713, 'recall': 0.5385660618655583, 'f1-score': 0.4688935281837161, 'support': 12511}, 'accuracy': 0.424268637936458, 'macro avg': {'precision': 0.4240653702382597, 'recall': 0.42484346545550866, 'f1-score': 0.4179969963065097, 'support': 38148}, 'weighted avg': {'precision': 0.4241930661270551, 'recall': 0.424268637936458, 'f1-score': 0.41781027102539087, 'support': 38148}}
[[5767 2741 4393]
 [3958 3680 5098]
 [3338 2435 6738]]
training model: results/PCAR/W8/deepVOL_L2/h50
Epoch 1/50
494/494 - 16s - loss: 3.3077 - accuracy50: 0.3725 - val_loss: 3.3211 - val_accuracy50: 0.3515 - 16s/epoch - 31ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2718 - accuracy50: 0.3853 - val_loss: 3.3220 - val_accuracy50: 0.3478 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2470 - accuracy50: 0.3976 - val_loss: 3.3174 - val_accuracy50: 0.3557 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2354 - accuracy50: 0.4021 - val_loss: 3.2866 - val_accuracy50: 0.3616 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2121 - accuracy50: 0.4147 - val_loss: 3.2821 - val_accuracy50: 0.3665 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2027 - accuracy50: 0.4194 - val_loss: 3.2753 - val_accuracy50: 0.3786 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.1978 - accuracy50: 0.4203 - val_loss: 3.2911 - val_accuracy50: 0.3734 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.1900 - accuracy50: 0.4244 - val_loss: 3.2760 - val_accuracy50: 0.3827 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.1840 - accuracy50: 0.4286 - val_loss: 3.2741 - val_accuracy50: 0.3834 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1795 - accuracy50: 0.4310 - val_loss: 3.2661 - val_accuracy50: 0.3892 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1743 - accuracy50: 0.4339 - val_loss: 3.2714 - val_accuracy50: 0.3809 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1688 - accuracy50: 0.4360 - val_loss: 3.2708 - val_accuracy50: 0.3859 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1607 - accuracy50: 0.4379 - val_loss: 3.2692 - val_accuracy50: 0.3858 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1580 - accuracy50: 0.4387 - val_loss: 3.2647 - val_accuracy50: 0.3912 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1549 - accuracy50: 0.4402 - val_loss: 3.2620 - val_accuracy50: 0.3919 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1514 - accuracy50: 0.4424 - val_loss: 3.2722 - val_accuracy50: 0.3914 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1473 - accuracy50: 0.4431 - val_loss: 3.2795 - val_accuracy50: 0.3895 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1433 - accuracy50: 0.4449 - val_loss: 3.2671 - val_accuracy50: 0.3965 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.1369 - accuracy50: 0.4457 - val_loss: 3.2699 - val_accuracy50: 0.3929 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.1333 - accuracy50: 0.4461 - val_loss: 3.2632 - val_accuracy50: 0.3959 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 3.1290 - accuracy50: 0.4468 - val_loss: 3.2701 - val_accuracy50: 0.3902 - 13s/epoch - 27ms/step
Epoch 22/50
494/494 - 13s - loss: 3.1236 - accuracy50: 0.4488 - val_loss: 3.2661 - val_accuracy50: 0.3948 - 13s/epoch - 27ms/step
Epoch 23/50
494/494 - 13s - loss: 3.1175 - accuracy50: 0.4509 - val_loss: 3.2787 - val_accuracy50: 0.3894 - 13s/epoch - 27ms/step
Epoch 24/50
494/494 - 13s - loss: 3.1141 - accuracy50: 0.4530 - val_loss: 3.2745 - val_accuracy50: 0.3918 - 13s/epoch - 27ms/step
Epoch 25/50
494/494 - 13s - loss: 3.1098 - accuracy50: 0.4545 - val_loss: 3.2707 - val_accuracy50: 0.3919 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h50
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909631
{'0': {'precision': 0.4001703410095981, 'recall': 0.30433482810164425, 'f1-score': 0.3457342182348197, 'support': 120420}, '1': {'precision': 0.3687634224532354, 'recall': 0.5678000623008171, 'f1-score': 0.4471323036861621, 'support': 125199}, '2': {'precision': 0.3922694266314598, 'recall': 0.26930111355690795, 'f1-score': 0.31935700575815734, 'support': 123568}, 'accuracy': 0.3819554859732331, 'macro avg': {'precision': 0.3870677300314311, 'recall': 0.38047866798645646, 'f1-score': 0.3707411758930464, 'support': 369187}, 'weighted avg': {'precision': 0.38687514105885273, 'recall': 0.3819554859732331, 'f1-score': 0.37129188822077913, 'support': 369187}}
[[36648 58417 25355]
 [27911 71088 26200]
 [27022 63269 33277]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0757246
{'0': {'precision': 0.4319244056086161, 'recall': 0.3062974349120953, 'f1-score': 0.35842162952137374, 'support': 41636}, '1': {'precision': 0.3821722482569436, 'recall': 0.6370933168198923, 'f1-score': 0.47775455893121865, 'support': 41986}, '2': {'precision': 0.42429222379920817, 'recall': 0.26622920084368407, 'f1-score': 0.32717009388860085, 'support': 42670}, 'accuracy': 0.4027333481138948, 'macro avg': {'precision': 0.4127962925549227, 'recall': 0.4032066508585572, 'f1-score': 0.3877820941137311, 'support': 126292}, 'weighted avg': {'precision': 0.4128055439517039, 'recall': 0.4027333481138948, 'f1-score': 0.38753518658556885, 'support': 126292}}
[[12753 20943  7940]
 [ 7763 26749  7474]
 [ 9010 22300 11360]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869727
{'0': {'precision': 0.4288755321813173, 'recall': 0.27245246997056716, 'f1-score': 0.3332198277958846, 'support': 12571}, '1': {'precision': 0.3828894564027727, 'recall': 0.6349062310949788, 'f1-score': 0.477696859353664, 'support': 13224}, '2': {'precision': 0.38668933689579793, 'recall': 0.2577511535659354, 'f1-score': 0.30932141642784283, 'support': 12353}, 'accuracy': 0.3933364789766174, 'macro avg': {'precision': 0.39948477515996267, 'recall': 0.3883699515438271, 'f1-score': 0.3734127011924638, 'support': 38148}, 'weighted avg': {'precision': 0.39927382471415007, 'recall': 0.3933364789766174, 'f1-score': 0.3755640447847347, 'support': 38148}}
[[3425 6677 2469]
 [2247 8396 2581]
 [2314 6855 3184]]
training model: results/PCAR/W8/deepVOL_L2/h100
Epoch 1/50
494/494 - 16s - loss: 3.3157 - accuracy100: 0.3715 - val_loss: 3.3333 - val_accuracy100: 0.3560 - 16s/epoch - 32ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2831 - accuracy100: 0.3757 - val_loss: 3.3025 - val_accuracy100: 0.3488 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2647 - accuracy100: 0.3813 - val_loss: 3.2827 - val_accuracy100: 0.3629 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2563 - accuracy100: 0.3866 - val_loss: 3.2730 - val_accuracy100: 0.3756 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2359 - accuracy100: 0.3935 - val_loss: 3.2653 - val_accuracy100: 0.3811 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2266 - accuracy100: 0.3982 - val_loss: 3.2636 - val_accuracy100: 0.3801 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.2228 - accuracy100: 0.4004 - val_loss: 3.2648 - val_accuracy100: 0.3756 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.2123 - accuracy100: 0.4056 - val_loss: 3.2620 - val_accuracy100: 0.3777 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.2094 - accuracy100: 0.4056 - val_loss: 3.2631 - val_accuracy100: 0.3838 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.2044 - accuracy100: 0.4069 - val_loss: 3.2635 - val_accuracy100: 0.3838 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.2008 - accuracy100: 0.4106 - val_loss: 3.2663 - val_accuracy100: 0.3806 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1956 - accuracy100: 0.4110 - val_loss: 3.2615 - val_accuracy100: 0.3860 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1916 - accuracy100: 0.4142 - val_loss: 3.2662 - val_accuracy100: 0.3868 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1876 - accuracy100: 0.4155 - val_loss: 3.2753 - val_accuracy100: 0.3853 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1810 - accuracy100: 0.4184 - val_loss: 3.2687 - val_accuracy100: 0.3847 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1778 - accuracy100: 0.4201 - val_loss: 3.2682 - val_accuracy100: 0.3854 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1744 - accuracy100: 0.4203 - val_loss: 3.2709 - val_accuracy100: 0.3829 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1692 - accuracy100: 0.4226 - val_loss: 3.2675 - val_accuracy100: 0.3837 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.1641 - accuracy100: 0.4291 - val_loss: 3.2690 - val_accuracy100: 0.3850 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.1648 - accuracy100: 0.4271 - val_loss: 3.2670 - val_accuracy100: 0.3889 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 3.1599 - accuracy100: 0.4287 - val_loss: 3.2710 - val_accuracy100: 0.3894 - 13s/epoch - 27ms/step
Epoch 22/50
494/494 - 13s - loss: 3.1571 - accuracy100: 0.4295 - val_loss: 3.2694 - val_accuracy100: 0.3889 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h100
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0893763
{'0': {'precision': 0.35703504146127096, 'recall': 0.3171100080607526, 'f1-score': 0.33589028045530733, 'support': 117855}, '1': {'precision': 0.4119103241936145, 'recall': 0.3851418673452182, 'f1-score': 0.3980765955424231, 'support': 130474}, '2': {'precision': 0.36580454124449185, 'recall': 0.4313574608217909, 'f1-score': 0.39588569866425694, 'support': 120858}, 'accuracy': 0.37855341601952397, 'macro avg': {'precision': 0.3782499689664591, 'recall': 0.37786977874258726, 'f1-score': 0.37661752488732914, 'support': 369187}, 'weighted avg': {'precision': 0.37929926486030807, 'recall': 0.37855341601952397, 'f1-score': 0.3775077359143933, 'support': 369187}}
[[37373 33564 46918]
 [36758 50251 43465]
 [30545 38180 52133]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0775979
{'0': {'precision': 0.3944099378881988, 'recall': 0.31133435877715826, 'f1-score': 0.34798259281147587, 'support': 41608}, '1': {'precision': 0.4102055982164974, 'recall': 0.4780600461893764, 'f1-score': 0.44154112784961996, 'support': 41568}, '2': {'precision': 0.4008310372411341, 'recall': 0.4183829668800445, 'f1-score': 0.4094189741261915, 'support': 43116}, 'accuracy': 0.402757102587654, 'macro avg': {'precision': 0.4018155244486101, 'recall': 0.40259245728219306, 'f1-score': 0.3996475649290958, 'support': 126292}, 'weighted avg': {'precision': 0.40180111174107846, 'recall': 0.402757102587654, 'f1-score': 0.39975097244938523, 'support': 126292}}
[[12954 13718 14936]
 [ 9667 19872 12029]
 [10223 14854 18039]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872321
{'0': {'precision': 0.3887317569860844, 'recall': 0.2757403097664714, 'f1-score': 0.3226291079812207, 'support': 12461}, '1': {'precision': 0.39806635598525425, 'recall': 0.43547405265560796, 'f1-score': 0.4159308114393692, 'support': 13142}, '2': {'precision': 0.3769086525582641, 'recall': 0.44862495017935433, 'f1-score': 0.4096517087018233, 'support': 12545}, 'accuracy': 0.387621893677257, 'macro avg': {'precision': 0.38790225517653426, 'recall': 0.3866131042004779, 'f1-score': 0.3827372093741377, 'support': 38148}, 'weighted avg': {'precision': 0.38805949251612754, 'recall': 0.387621893677257, 'f1-score': 0.383389030202227, 'support': 38148}}
[[3436 4294 4731]
 [2846 5723 4573]
 [2557 4360 5628]]
training model: results/PCAR/W8/deepVOL_L2/h200
Epoch 1/50
494/494 - 16s - loss: 3.3268 - accuracy200: 0.3632 - val_loss: 3.3254 - val_accuracy200: 0.3473 - 16s/epoch - 33ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2788 - accuracy200: 0.3745 - val_loss: 3.3232 - val_accuracy200: 0.3441 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2559 - accuracy200: 0.3858 - val_loss: 3.3220 - val_accuracy200: 0.3436 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2238 - accuracy200: 0.4013 - val_loss: 3.2832 - val_accuracy200: 0.3685 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2138 - accuracy200: 0.4026 - val_loss: 3.2909 - val_accuracy200: 0.3595 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2042 - accuracy200: 0.4123 - val_loss: 3.2828 - val_accuracy200: 0.3680 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.1996 - accuracy200: 0.4146 - val_loss: 3.2922 - val_accuracy200: 0.3535 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.1955 - accuracy200: 0.4173 - val_loss: 3.2994 - val_accuracy200: 0.3554 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.1912 - accuracy200: 0.4180 - val_loss: 3.2872 - val_accuracy200: 0.3676 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1851 - accuracy200: 0.4192 - val_loss: 3.2858 - val_accuracy200: 0.3696 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1783 - accuracy200: 0.4213 - val_loss: 3.2810 - val_accuracy200: 0.3746 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1728 - accuracy200: 0.4237 - val_loss: 3.2898 - val_accuracy200: 0.3680 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1690 - accuracy200: 0.4245 - val_loss: 3.3673 - val_accuracy200: 0.3522 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1642 - accuracy200: 0.4266 - val_loss: 3.3116 - val_accuracy200: 0.3672 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1603 - accuracy200: 0.4284 - val_loss: 3.3170 - val_accuracy200: 0.3675 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1556 - accuracy200: 0.4310 - val_loss: 3.3230 - val_accuracy200: 0.3656 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1521 - accuracy200: 0.4307 - val_loss: 3.3072 - val_accuracy200: 0.3722 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1472 - accuracy200: 0.4348 - val_loss: 3.3056 - val_accuracy200: 0.3722 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.1433 - accuracy200: 0.4356 - val_loss: 3.3160 - val_accuracy200: 0.3726 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.1391 - accuracy200: 0.4373 - val_loss: 3.3170 - val_accuracy200: 0.3738 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 3.1354 - accuracy200: 0.4397 - val_loss: 3.3418 - val_accuracy200: 0.3689 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h200
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0889711
{'0': {'precision': 0.36483498334694325, 'recall': 0.3270629071527275, 'f1-score': 0.3449179190250038, 'support': 121576}, '1': {'precision': 0.3887861645917578, 'recall': 0.5803833237775412, 'f1-score': 0.46564612103947145, 'support': 122090}, '2': {'precision': 0.3724868811023723, 'recall': 0.23129197504799995, 'f1-score': 0.28538007097148366, 'support': 125521}, 'accuracy': 0.37827442461408445, 'macro avg': {'precision': 0.3753693430136911, 'recall': 0.37957940199275625, 'f1-score': 0.365314703678653, 'support': 369187}, 'weighted avg': {'precision': 0.3753572216065207, 'recall': 0.37827442461408445, 'f1-score': 0.3646002370871795, 'support': 369187}}
[[39763 52701 29112]
 [31434 70859 19797]
 [37792 58697 29032]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.075714
{'0': {'precision': 0.3900313593052708, 'recall': 0.3121983008302761, 'f1-score': 0.346801437074374, 'support': 41432}, '1': {'precision': 0.39810934885516924, 'recall': 0.6692551810357263, 'f1-score': 0.4992422679950142, 'support': 41594}, '2': {'precision': 0.41111829347123463, 'recall': 0.22049646373595896, 'f1-score': 0.28704246964841806, 'support': 43266}, 'accuracy': 0.39837836125803694, 'macro avg': {'precision': 0.39975300054389157, 'recall': 0.4006499818673204, 'f1-score': 0.37769539157260207, 'support': 126292}, 'weighted avg': {'precision': 0.3999159378293504, 'recall': 0.39837836125803694, 'f1-score': 0.37653485199108844, 'support': 126292}}
[[12935 20155  8342]
 [ 8434 27837  5323]
 [11795 21931  9540]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941552
{'0': {'precision': 0.3834658187599364, 'recall': 0.2841882020265494, 'f1-score': 0.32644590814761343, 'support': 12731}, '1': {'precision': 0.3654317624625443, 'recall': 0.650371687136393, 'f1-score': 0.4679379105865939, 'support': 12376}, '2': {'precision': 0.39359952145954835, 'recall': 0.20182501341921633, 'f1-score': 0.26682887266828875, 'support': 13041}, 'accuracy': 0.37482961098878054, 'macro avg': {'precision': 0.3808323675606764, 'recall': 0.3787949675273863, 'f1-score': 0.35373756380083204, 'support': 38148}, 'weighted avg': {'precision': 0.38107943247937426, 'recall': 0.37482961098878054, 'f1-score': 0.35196858987401974, 'support': 38148}}
[[3618 6822 2291]
 [2563 8049 1764]
 [3254 7155 2632]]
training model: results/PCAR/W8/deepVOL_L2/h300
Epoch 1/50
494/494 - 15s - loss: 3.3090 - accuracy300: 0.3727 - val_loss: 3.3234 - val_accuracy300: 0.3446 - 15s/epoch - 31ms/step
Epoch 2/50
494/494 - 13s - loss: 3.2712 - accuracy300: 0.3807 - val_loss: 3.3069 - val_accuracy300: 0.3603 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2357 - accuracy300: 0.3985 - val_loss: 3.2926 - val_accuracy300: 0.3649 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2228 - accuracy300: 0.4026 - val_loss: 3.2830 - val_accuracy300: 0.3612 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2112 - accuracy300: 0.4096 - val_loss: 3.2808 - val_accuracy300: 0.3677 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2063 - accuracy300: 0.4125 - val_loss: 3.2715 - val_accuracy300: 0.3738 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.1983 - accuracy300: 0.4125 - val_loss: 3.2717 - val_accuracy300: 0.3743 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 14s - loss: 3.1993 - accuracy300: 0.4124 - val_loss: 3.2674 - val_accuracy300: 0.3767 - 14s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.1919 - accuracy300: 0.4154 - val_loss: 3.2744 - val_accuracy300: 0.3746 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1878 - accuracy300: 0.4164 - val_loss: 3.2729 - val_accuracy300: 0.3753 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1851 - accuracy300: 0.4173 - val_loss: 3.2884 - val_accuracy300: 0.3662 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1851 - accuracy300: 0.4181 - val_loss: 3.2847 - val_accuracy300: 0.3712 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1775 - accuracy300: 0.4225 - val_loss: 3.2875 - val_accuracy300: 0.3687 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1755 - accuracy300: 0.4209 - val_loss: 3.2842 - val_accuracy300: 0.3726 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1737 - accuracy300: 0.4226 - val_loss: 3.2861 - val_accuracy300: 0.3766 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1639 - accuracy300: 0.4278 - val_loss: 3.2878 - val_accuracy300: 0.3708 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1631 - accuracy300: 0.4269 - val_loss: 3.2899 - val_accuracy300: 0.3723 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1560 - accuracy300: 0.4317 - val_loss: 3.2902 - val_accuracy300: 0.3714 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h300
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0885258
{'0': {'precision': 0.37122053560409723, 'recall': 0.323923127899271, 'f1-score': 0.34596277962832706, 'support': 120720}, '1': {'precision': 0.4014978330237653, 'recall': 0.5469482425834915, 'f1-score': 0.4630701519489704, 'support': 123306}, '2': {'precision': 0.354201435246996, 'recall': 0.27131454686363965, 'f1-score': 0.30726633579601237, 'support': 125161}, 'accuracy': 0.3805767808725659, 'macro avg': {'precision': 0.3756399346249528, 'recall': 0.3807286391154674, 'f1-score': 0.37209975579110327, 'support': 369187}, 'weighted avg': {'precision': 0.37556317176364357, 'recall': 0.3805767808725659, 'f1-score': 0.3719570753236601, 'support': 369187}}
[[39104 47057 34559]
 [28509 67442 27355]
 [37726 53477 33958]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0793924
{'0': {'precision': 0.38882688305028507, 'recall': 0.31031826279551256, 'f1-score': 0.34516461594076775, 'support': 41538}, '1': {'precision': 0.3960677925678596, 'recall': 0.6468740870581361, 'f1-score': 0.49131403529857715, 'support': 41076}, '2': {'precision': 0.404467644123743, 'recall': 0.24126562571546317, 'f1-score': 0.30224287271267136, 'support': 43678}, 'accuracy': 0.3958999778291578, 'macro avg': {'precision': 0.39645410658062924, 'recall': 0.3994859918563706, 'f1-score': 0.3795738413173388, 'support': 126292}, 'weighted avg': {'precision': 0.39659130804561643, 'recall': 0.3958999778291578, 'f1-score': 0.37785471229544254, 'support': 126292}}
[[12890 19640  9008]
 [ 7997 26571  6508]
 [12264 20876 10538]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911587
{'0': {'precision': 0.3770119686339249, 'recall': 0.2901151250496229, 'f1-score': 0.3279041593754206, 'support': 12595}, '1': {'precision': 0.37746181672025725, 'recall': 0.6098709310820684, 'f1-score': 0.4663128821028458, 'support': 12319}, '2': {'precision': 0.3747661365762395, 'recall': 0.24217923530300742, 'f1-score': 0.2942256494996787, 'support': 13234}, 'accuracy': 0.37674321065324523, 'macro avg': {'precision': 0.3764133073101405, 'recall': 0.38072176381156625, 'f1-score': 0.36281423032598176, 'support': 38148}, 'weighted avg': {'precision': 0.37637813034945705, 'recall': 0.37674321065324523, 'f1-score': 0.36091652321057804, 'support': 38148}}
[[3654 5881 3060]
 [2519 7513 2287]
 [3519 6510 3205]]
training model: results/PCAR/W8/deepVOL_L2/h500
Epoch 1/50
494/494 - 16s - loss: 3.3086 - accuracy500: 0.3729 - val_loss: 3.3565 - val_accuracy500: 0.3438 - 16s/epoch - 31ms/step
Epoch 2/50
494/494 - 14s - loss: 3.2715 - accuracy500: 0.3821 - val_loss: 3.3192 - val_accuracy500: 0.3502 - 14s/epoch - 28ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2499 - accuracy500: 0.3888 - val_loss: 3.3117 - val_accuracy500: 0.3495 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2376 - accuracy500: 0.3971 - val_loss: 3.3183 - val_accuracy500: 0.3493 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2240 - accuracy500: 0.4030 - val_loss: 3.3049 - val_accuracy500: 0.3535 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2177 - accuracy500: 0.4069 - val_loss: 3.3199 - val_accuracy500: 0.3483 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.2130 - accuracy500: 0.4095 - val_loss: 3.2941 - val_accuracy500: 0.3585 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.2075 - accuracy500: 0.4116 - val_loss: 3.2929 - val_accuracy500: 0.3618 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.2033 - accuracy500: 0.4120 - val_loss: 3.3084 - val_accuracy500: 0.3635 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1960 - accuracy500: 0.4157 - val_loss: 3.2990 - val_accuracy500: 0.3665 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1868 - accuracy500: 0.4186 - val_loss: 3.2936 - val_accuracy500: 0.3666 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1823 - accuracy500: 0.4212 - val_loss: 3.2869 - val_accuracy500: 0.3710 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1754 - accuracy500: 0.4244 - val_loss: 3.2909 - val_accuracy500: 0.3703 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1687 - accuracy500: 0.4286 - val_loss: 3.3065 - val_accuracy500: 0.3655 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1612 - accuracy500: 0.4320 - val_loss: 3.3112 - val_accuracy500: 0.3662 - 13s/epoch - 27ms/step
Epoch 16/50
494/494 - 13s - loss: 3.1550 - accuracy500: 0.4348 - val_loss: 3.3182 - val_accuracy500: 0.3633 - 13s/epoch - 27ms/step
Epoch 17/50
494/494 - 13s - loss: 3.1478 - accuracy500: 0.4371 - val_loss: 3.3244 - val_accuracy500: 0.3614 - 13s/epoch - 27ms/step
Epoch 18/50
494/494 - 13s - loss: 3.1418 - accuracy500: 0.4391 - val_loss: 3.3237 - val_accuracy500: 0.3674 - 13s/epoch - 27ms/step
Epoch 19/50
494/494 - 13s - loss: 3.1351 - accuracy500: 0.4410 - val_loss: 3.3471 - val_accuracy500: 0.3642 - 13s/epoch - 27ms/step
Epoch 20/50
494/494 - 13s - loss: 3.1289 - accuracy500: 0.4458 - val_loss: 3.3380 - val_accuracy500: 0.3638 - 13s/epoch - 27ms/step
Epoch 21/50
494/494 - 13s - loss: 3.1210 - accuracy500: 0.4484 - val_loss: 3.3702 - val_accuracy500: 0.3592 - 13s/epoch - 27ms/step
Epoch 22/50
494/494 - 13s - loss: 3.1145 - accuracy500: 0.4497 - val_loss: 3.3738 - val_accuracy500: 0.3610 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h500
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0924361
{'0': {'precision': 0.3748215767634855, 'recall': 0.3782620347727044, 'f1-score': 0.3765339469120982, 'support': 119404}, '1': {'precision': 0.383795969486508, 'recall': 0.6677919093466461, 'f1-score': 0.4874454116898516, 'support': 126195}, '2': {'precision': 0.3433979115141522, 'recall': 0.08088973039453669, 'f1-score': 0.13093647675180092, 'support': 123588}, 'accuracy': 0.3776812292957228, 'macro avg': {'precision': 0.36733848592138196, 'recall': 0.3756478915046291, 'f1-score': 0.33163861178458354, 'support': 369187}, 'weighted avg': {'precision': 0.36736989387337077, 'recall': 0.3776812292957228, 'f1-score': 0.33223003630706, 'support': 369187}}
[[45166 63730 10508]
 [33316 84272  8607]
 [42018 71573  9997]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0830055
{'0': {'precision': 0.38610112760295207, 'recall': 0.3439065516482979, 'f1-score': 0.3637844125630089, 'support': 40921}, '1': {'precision': 0.38480545823345014, 'recall': 0.747867638274997, 'f1-score': 0.5081493506493507, 'support': 41855}, '2': {'precision': 0.41492115791951045, 'recall': 0.08102766798418973, 'f1-score': 0.1355788826085285, 'support': 43516}, 'accuracy': 0.3872058404332816, 'macro avg': {'precision': 0.3952759145853042, 'recall': 0.3909339526358282, 'f1-score': 0.3358375486069627, 'support': 126292}, 'weighted avg': {'precision': 0.39560214269333666, 'recall': 0.3872058404332816, 'f1-score': 0.3329970518600718, 'support': 126292}}
[[14073 23867  2981]
 [ 8562 31302  1991]
 [13814 26176  3526]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974994
{'0': {'precision': 0.37000179307871617, 'recall': 0.3381401065137239, 'f1-score': 0.35335416755854276, 'support': 12205}, '1': {'precision': 0.3680038433821763, 'recall': 0.7292344307814359, 'f1-score': 0.48915733177234383, 'support': 12605}, '2': {'precision': 0.37797619047619047, 'recall': 0.05713000449842555, 'f1-score': 0.09925752246971473, 'support': 13338}, 'accuracy': 0.3691150256894202, 'macro avg': {'precision': 0.371993942312361, 'recall': 0.3748348472645284, 'f1-score': 0.3139230072668671, 'support': 38148}, 'weighted avg': {'precision': 0.37212977767981265, 'recall': 0.3691150256894202, 'f1-score': 0.30938483319554005, 'support': 38148}}
[[4127 7366  712]
 [2871 9192  542]
 [4156 8420  762]]
training model: results/PCAR/W8/deepVOL_L2/h1000
Epoch 1/50
494/494 - 17s - loss: 3.3306 - accuracy1000: 0.3637 - val_loss: 3.4086 - val_accuracy1000: 0.3232 - 17s/epoch - 34ms/step
Epoch 2/50
494/494 - 13s - loss: 3.3020 - accuracy1000: 0.3663 - val_loss: 3.3427 - val_accuracy1000: 0.3357 - 13s/epoch - 27ms/step
Epoch 3/50
494/494 - 13s - loss: 3.2709 - accuracy1000: 0.3802 - val_loss: 3.3092 - val_accuracy1000: 0.3483 - 13s/epoch - 27ms/step
Epoch 4/50
494/494 - 13s - loss: 3.2489 - accuracy1000: 0.3929 - val_loss: 3.3046 - val_accuracy1000: 0.3465 - 13s/epoch - 27ms/step
Epoch 5/50
494/494 - 13s - loss: 3.2344 - accuracy1000: 0.3991 - val_loss: 3.2988 - val_accuracy1000: 0.3506 - 13s/epoch - 27ms/step
Epoch 6/50
494/494 - 13s - loss: 3.2242 - accuracy1000: 0.4024 - val_loss: 3.3070 - val_accuracy1000: 0.3467 - 13s/epoch - 27ms/step
Epoch 7/50
494/494 - 13s - loss: 3.2196 - accuracy1000: 0.4049 - val_loss: 3.3149 - val_accuracy1000: 0.3450 - 13s/epoch - 27ms/step
Epoch 8/50
494/494 - 13s - loss: 3.2122 - accuracy1000: 0.4082 - val_loss: 3.3198 - val_accuracy1000: 0.3444 - 13s/epoch - 27ms/step
Epoch 9/50
494/494 - 13s - loss: 3.2069 - accuracy1000: 0.4104 - val_loss: 3.3085 - val_accuracy1000: 0.3514 - 13s/epoch - 27ms/step
Epoch 10/50
494/494 - 13s - loss: 3.1978 - accuracy1000: 0.4147 - val_loss: 3.3306 - val_accuracy1000: 0.3470 - 13s/epoch - 27ms/step
Epoch 11/50
494/494 - 13s - loss: 3.1936 - accuracy1000: 0.4182 - val_loss: 3.3229 - val_accuracy1000: 0.3514 - 13s/epoch - 27ms/step
Epoch 12/50
494/494 - 13s - loss: 3.1863 - accuracy1000: 0.4230 - val_loss: 3.3172 - val_accuracy1000: 0.3510 - 13s/epoch - 27ms/step
Epoch 13/50
494/494 - 13s - loss: 3.1767 - accuracy1000: 0.4269 - val_loss: 3.3317 - val_accuracy1000: 0.3461 - 13s/epoch - 27ms/step
Epoch 14/50
494/494 - 13s - loss: 3.1705 - accuracy1000: 0.4290 - val_loss: 3.3406 - val_accuracy1000: 0.3463 - 13s/epoch - 27ms/step
Epoch 15/50
494/494 - 13s - loss: 3.1618 - accuracy1000: 0.4318 - val_loss: 3.3425 - val_accuracy1000: 0.3448 - 13s/epoch - 27ms/step
testing model: results/PCAR/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031024
{'0': {'precision': 0.35055656555991455, 'recall': 0.2643211004761676, 'f1-score': 0.3013916500994036, 'support': 124746}, '1': {'precision': 0.32817632850241546, 'recall': 0.49345342945865944, 'f1-score': 0.39419150340545595, 'support': 110134}, '2': {'precision': 0.35581769045358264, 'recall': 0.29017102608203593, 'f1-score': 0.3196587856542334, 'support': 134307}, 'accuracy': 0.3420786755763339, 'macro avg': {'precision': 0.34485019483863755, 'recall': 0.3493151853389544, 'f1-score': 0.33841397971969767, 'support': 369187}, 'weighted avg': {'precision': 0.3457941575471819, 'recall': 0.3420786755763339, 'f1-score': 0.3357206574018582, 'support': 369187}}
[[32973 51058 40715]
 [25947 54346 29841]
 [35139 60196 38972]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0889575
{'0': {'precision': 0.36125719620351643, 'recall': 0.28725905030559473, 'f1-score': 0.320036389700612, 'support': 40413}, '1': {'precision': 0.38136843870534964, 'recall': 0.5504163036111918, 'f1-score': 0.450557723931607, 'support': 41316}, '2': {'precision': 0.3957482549888493, 'recall': 0.30662208558669746, 'f1-score': 0.34553040839549876, 'support': 44563}, 'accuracy': 0.3801824343584708, 'macro avg': {'precision': 0.3794579632992385, 'recall': 0.38143247983449463, 'f1-score': 0.3720415073425725, 'support': 126292}, 'weighted avg': {'precision': 0.38000692815689846, 'recall': 0.3801824343584708, 'f1-score': 0.37173174174340196, 'support': 126292}}
[[11609 17596 11208]
 [ 8920 22741  9655]
 [11606 19293 13664]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010488
{'0': {'precision': 0.3379224030037547, 'recall': 0.257040856802856, 'f1-score': 0.2919839589059613, 'support': 12605}, '1': {'precision': 0.3484348813321079, 'recall': 0.5508076232800615, 'f1-score': 0.4268494602291542, 'support': 11701}, '2': {'precision': 0.3647023750372652, 'recall': 0.26513509608438085, 'f1-score': 0.3070487345743568, 'support': 13842}, 'accuracy': 0.35008388382090805, 'macro avg': {'precision': 0.3503532197910426, 'recall': 0.35766119205576613, 'f1-score': 0.34196071790315746, 'support': 38148}, 'weighted avg': {'precision': 0.35086396958150223, 'recall': 0.35008388382090805, 'f1-score': 0.3388170263219362, 'support': 38148}}
[[3240 5630 3735]
 [2598 6445 2658]
 [3750 6422 3670]]
training model: results/PCAR/W8/deepVOL_L3/h10
Epoch 1/50
494/494 - 21s - loss: 3.3099 - accuracy10: 0.3620 - val_loss: 3.3587 - val_accuracy10: 0.3345 - 21s/epoch - 43ms/step
Epoch 2/50
494/494 - 19s - loss: 3.2813 - accuracy10: 0.3727 - val_loss: 3.2614 - val_accuracy10: 0.3925 - 19s/epoch - 39ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2436 - accuracy10: 0.3934 - val_loss: 3.2274 - val_accuracy10: 0.4158 - 19s/epoch - 39ms/step
Epoch 4/50
494/494 - 19s - loss: 3.1976 - accuracy10: 0.4192 - val_loss: 3.1919 - val_accuracy10: 0.4261 - 19s/epoch - 38ms/step
Epoch 5/50
494/494 - 19s - loss: 3.1456 - accuracy10: 0.4427 - val_loss: 3.1622 - val_accuracy10: 0.4412 - 19s/epoch - 38ms/step
Epoch 6/50
494/494 - 19s - loss: 3.1116 - accuracy10: 0.4554 - val_loss: 3.1807 - val_accuracy10: 0.4406 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 19s - loss: 3.0862 - accuracy10: 0.4648 - val_loss: 3.1398 - val_accuracy10: 0.4506 - 19s/epoch - 38ms/step
Epoch 8/50
494/494 - 19s - loss: 3.0657 - accuracy10: 0.4712 - val_loss: 3.1511 - val_accuracy10: 0.4470 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.0516 - accuracy10: 0.4745 - val_loss: 3.1559 - val_accuracy10: 0.4447 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.0412 - accuracy10: 0.4778 - val_loss: 3.1845 - val_accuracy10: 0.4432 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.0304 - accuracy10: 0.4828 - val_loss: 3.1179 - val_accuracy10: 0.4597 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.0202 - accuracy10: 0.4857 - val_loss: 3.1641 - val_accuracy10: 0.4493 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.0122 - accuracy10: 0.4885 - val_loss: 3.1232 - val_accuracy10: 0.4580 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.0085 - accuracy10: 0.4889 - val_loss: 3.1262 - val_accuracy10: 0.4552 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.0008 - accuracy10: 0.4933 - val_loss: 3.1172 - val_accuracy10: 0.4563 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 2.9960 - accuracy10: 0.4929 - val_loss: 3.1368 - val_accuracy10: 0.4558 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 2.9868 - accuracy10: 0.4954 - val_loss: 3.1055 - val_accuracy10: 0.4637 - 19s/epoch - 38ms/step
Epoch 18/50
494/494 - 19s - loss: 2.9816 - accuracy10: 0.4968 - val_loss: 3.1183 - val_accuracy10: 0.4598 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 2.9797 - accuracy10: 0.4974 - val_loss: 3.1076 - val_accuracy10: 0.4628 - 19s/epoch - 38ms/step
Epoch 20/50
494/494 - 19s - loss: 2.9726 - accuracy10: 0.4987 - val_loss: 3.0953 - val_accuracy10: 0.4663 - 19s/epoch - 38ms/step
Epoch 21/50
494/494 - 19s - loss: 2.9688 - accuracy10: 0.5004 - val_loss: 3.1183 - val_accuracy10: 0.4581 - 19s/epoch - 38ms/step
Epoch 22/50
494/494 - 19s - loss: 2.9655 - accuracy10: 0.5016 - val_loss: 3.1099 - val_accuracy10: 0.4638 - 19s/epoch - 38ms/step
Epoch 23/50
494/494 - 19s - loss: 2.9623 - accuracy10: 0.5010 - val_loss: 3.1021 - val_accuracy10: 0.4652 - 19s/epoch - 38ms/step
Epoch 24/50
494/494 - 19s - loss: 2.9564 - accuracy10: 0.5031 - val_loss: 3.1113 - val_accuracy10: 0.4596 - 19s/epoch - 38ms/step
Epoch 25/50
494/494 - 19s - loss: 2.9520 - accuracy10: 0.5052 - val_loss: 3.0973 - val_accuracy10: 0.4631 - 19s/epoch - 38ms/step
Epoch 26/50
494/494 - 19s - loss: 2.9492 - accuracy10: 0.5046 - val_loss: 3.1095 - val_accuracy10: 0.4601 - 19s/epoch - 37ms/step
Epoch 27/50
494/494 - 19s - loss: 2.9458 - accuracy10: 0.5054 - val_loss: 3.1142 - val_accuracy10: 0.4612 - 19s/epoch - 38ms/step
Epoch 28/50
494/494 - 18s - loss: 2.9428 - accuracy10: 0.5062 - val_loss: 3.1179 - val_accuracy10: 0.4571 - 18s/epoch - 37ms/step
Epoch 29/50
494/494 - 19s - loss: 2.9395 - accuracy10: 0.5077 - val_loss: 3.1171 - val_accuracy10: 0.4619 - 19s/epoch - 38ms/step
Epoch 30/50
494/494 - 19s - loss: 2.9346 - accuracy10: 0.5101 - val_loss: 3.1334 - val_accuracy10: 0.4559 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h10
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0387244
{'0': {'precision': 0.4664934876201203, 'recall': 0.4197244332576042, 'f1-score': 0.4418748709477596, 'support': 122366}, '1': {'precision': 0.47218423366220574, 'recall': 0.467070352446674, 'f1-score': 0.46961337149287746, 'support': 124189}, '2': {'precision': 0.447979742375867, 'recall': 0.4977085915584839, 'f1-score': 0.4715366757185845, 'support': 122632}, 'accuracy': 0.461554713464992, 'macro avg': {'precision': 0.46221915455273105, 'recall': 0.461501125754254, 'f1-score': 0.46100830605307386, 'support': 369187}, 'weighted avg': {'precision': 0.4622581013617397, 'recall': 0.461554713464992, 'f1-score': 0.4610583825200886, 'support': 369187}}
[[51360 31735 39271]
 [30245 58005 35939]
 [28493 33104 61035]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.009475
{'0': {'precision': 0.48494136835297097, 'recall': 0.4109572718823726, 'f1-score': 0.44489448428873646, 'support': 41963}, '1': {'precision': 0.48536221962710907, 'recall': 0.5786921451891684, 'f1-score': 0.5279341232123694, 'support': 41656}, '2': {'precision': 0.4822598319737002, 'recall': 0.46408736203219836, 'f1-score': 0.47299911629128955, 'support': 42673}, 'accuracy': 0.4842349475817946, 'macro avg': {'precision': 0.4841878066512601, 'recall': 0.48457892636791317, 'f1-score': 0.4819425745974651, 'support': 126292}, 'weighted avg': {'precision': 0.4841741129350734, 'recall': 0.4842349475817946, 'f1-score': 0.48178049575777493, 'support': 126292}}
[[17245 12819 11899]
 [ 8188 24106  9362]
 [10128 12741 19804]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0315961
{'0': {'precision': 0.48880482568244554, 'recall': 0.37016104056983584, 'f1-score': 0.42128915715733356, 'support': 12916}, '1': {'precision': 0.45839954236318564, 'recall': 0.566002197457228, 'f1-score': 0.5065496049165934, 'support': 12742}, '2': {'precision': 0.45670413170808927, 'recall': 0.46196957566052843, 'f1-score': 0.45932176405031044, 'support': 12490}, 'accuracy': 0.4656338471217364, 'macro avg': {'precision': 0.4679694999179069, 'recall': 0.46604427122919745, 'f1-score': 0.4623868420414125, 'support': 38148}, 'weighted avg': {'precision': 0.4681389509893104, 'recall': 0.4656338471217364, 'f1-score': 0.4622196354377616, 'support': 38148}}
[[4781 4391 3744]
 [2410 7212 3120]
 [2590 4130 5770]]
training model: results/PCAR/W8/deepVOL_L3/h20
Epoch 1/50
494/494 - 21s - loss: 3.3123 - accuracy20: 0.3582 - val_loss: 3.2870 - val_accuracy20: 0.3620 - 21s/epoch - 43ms/step
Epoch 2/50
494/494 - 19s - loss: 3.2735 - accuracy20: 0.3798 - val_loss: 3.2636 - val_accuracy20: 0.3876 - 19s/epoch - 39ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2622 - accuracy20: 0.3838 - val_loss: 3.2608 - val_accuracy20: 0.3963 - 19s/epoch - 39ms/step
Epoch 4/50
494/494 - 20s - loss: 3.2473 - accuracy20: 0.3924 - val_loss: 3.2369 - val_accuracy20: 0.4096 - 20s/epoch - 40ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2163 - accuracy20: 0.4096 - val_loss: 3.2762 - val_accuracy20: 0.3863 - 19s/epoch - 39ms/step
Epoch 6/50
494/494 - 19s - loss: 3.1878 - accuracy20: 0.4244 - val_loss: 3.2876 - val_accuracy20: 0.3755 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 20s - loss: 3.1722 - accuracy20: 0.4343 - val_loss: 3.2088 - val_accuracy20: 0.4154 - 20s/epoch - 40ms/step
Epoch 8/50
494/494 - 19s - loss: 3.1475 - accuracy20: 0.4445 - val_loss: 3.2023 - val_accuracy20: 0.4217 - 19s/epoch - 39ms/step
Epoch 9/50
494/494 - 19s - loss: 3.1333 - accuracy20: 0.4510 - val_loss: 3.1998 - val_accuracy20: 0.4221 - 19s/epoch - 39ms/step
Epoch 10/50
494/494 - 19s - loss: 3.1262 - accuracy20: 0.4542 - val_loss: 3.1705 - val_accuracy20: 0.4365 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.1192 - accuracy20: 0.4570 - val_loss: 3.1643 - val_accuracy20: 0.4370 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.1115 - accuracy20: 0.4594 - val_loss: 3.1525 - val_accuracy20: 0.4457 - 19s/epoch - 39ms/step
Epoch 13/50
494/494 - 19s - loss: 3.1045 - accuracy20: 0.4608 - val_loss: 3.1445 - val_accuracy20: 0.4472 - 19s/epoch - 39ms/step
Epoch 14/50
494/494 - 19s - loss: 3.0962 - accuracy20: 0.4638 - val_loss: 3.1386 - val_accuracy20: 0.4516 - 19s/epoch - 39ms/step
Epoch 15/50
494/494 - 19s - loss: 3.0907 - accuracy20: 0.4650 - val_loss: 3.1399 - val_accuracy20: 0.4484 - 19s/epoch - 39ms/step
Epoch 16/50
494/494 - 19s - loss: 3.0863 - accuracy20: 0.4657 - val_loss: 3.1356 - val_accuracy20: 0.4482 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.0812 - accuracy20: 0.4678 - val_loss: 3.1351 - val_accuracy20: 0.4504 - 19s/epoch - 38ms/step
Epoch 18/50
494/494 - 19s - loss: 3.0748 - accuracy20: 0.4698 - val_loss: 3.1490 - val_accuracy20: 0.4421 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 3.0706 - accuracy20: 0.4707 - val_loss: 3.1448 - val_accuracy20: 0.4458 - 19s/epoch - 38ms/step
Epoch 20/50
494/494 - 19s - loss: 3.0648 - accuracy20: 0.4726 - val_loss: 3.1508 - val_accuracy20: 0.4436 - 19s/epoch - 38ms/step
Epoch 21/50
494/494 - 19s - loss: 3.0609 - accuracy20: 0.4733 - val_loss: 3.1542 - val_accuracy20: 0.4440 - 19s/epoch - 38ms/step
Epoch 22/50
494/494 - 19s - loss: 3.0542 - accuracy20: 0.4769 - val_loss: 3.1599 - val_accuracy20: 0.4447 - 19s/epoch - 38ms/step
Epoch 23/50
494/494 - 19s - loss: 3.0510 - accuracy20: 0.4762 - val_loss: 3.1567 - val_accuracy20: 0.4447 - 19s/epoch - 38ms/step
Epoch 24/50
494/494 - 19s - loss: 3.0502 - accuracy20: 0.4779 - val_loss: 3.1563 - val_accuracy20: 0.4418 - 19s/epoch - 38ms/step
Epoch 25/50
494/494 - 19s - loss: 3.0459 - accuracy20: 0.4786 - val_loss: 3.1589 - val_accuracy20: 0.4412 - 19s/epoch - 38ms/step
Epoch 26/50
494/494 - 19s - loss: 3.0441 - accuracy20: 0.4790 - val_loss: 3.1517 - val_accuracy20: 0.4458 - 19s/epoch - 38ms/step
Epoch 27/50
494/494 - 19s - loss: 3.0400 - accuracy20: 0.4808 - val_loss: 3.1534 - val_accuracy20: 0.4464 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h20
Evaluating performance on  test set...
1443/1443 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0569791
{'0': {'precision': 0.4183869338272436, 'recall': 0.5179731341043451, 'f1-score': 0.462884308728633, 'support': 119929}, '1': {'precision': 0.45409872910792365, 'recall': 0.3486223421360167, 'f1-score': 0.3944308133266484, 'support': 127499}, '2': {'precision': 0.4428469078711694, 'recall': 0.4467349436181309, 'f1-score': 0.4447824291560875, 'support': 121759}, 'accuracy': 0.43599314168700415, 'macro avg': {'precision': 0.43844419026877884, 'recall': 0.4377768066194976, 'f1-score': 0.43403251707045637, 'support': 369187}, 'weighted avg': {'precision': 0.4387870025352582, 'recall': 0.43599314168700415, 'f1-score': 0.4332737889510374, 'support': 369187}}
[[62120 25340 32469]
 [47085 44449 35965]
 [39270 28095 54394]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0370114
{'0': {'precision': 0.4440922622234596, 'recall': 0.4982698961937716, 'f1-score': 0.4696237076628656, 'support': 41616}, '1': {'precision': 0.4651436211904652, 'recall': 0.48157429948923575, 'f1-score': 0.47321637975514796, 'support': 41898}, '2': {'precision': 0.4745037409237735, 'recall': 0.4017719388470709, 'f1-score': 0.4351194318915429, 'support': 42778}, 'accuracy': 0.4600449751369841, 'macro avg': {'precision': 0.46124654144589944, 'recall': 0.46053871151002607, 'f1-score': 0.45931983976985213, 'support': 126292}, 'weighted avg': {'precision': 0.461377221475365, 'recall': 0.4600449751369841, 'f1-score': 0.45912820411851446, 'support': 126292}}
[[20736 11177  9703]
 [12390 20177  9331]
 [13567 12024 17187]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0452696
{'0': {'precision': 0.45469218353700713, 'recall': 0.4627659574468085, 'f1-score': 0.45869354526070943, 'support': 12784}, '1': {'precision': 0.45399370597931965, 'recall': 0.46411336652623514, 'f1-score': 0.4589977652361653, 'support': 13055}, '2': {'precision': 0.4469510643711305, 'recall': 0.4281420099114469, 'f1-score': 0.43734439834024896, 'support': 12309}, 'accuracy': 0.452055153612247, 'macro avg': {'precision': 0.45187898462915244, 'recall': 0.4516737779614968, 'f1-score': 0.45167856961237457, 'support': 38148}, 'weighted avg': {'precision': 0.45195536744367626, 'recall': 0.452055153612247, 'f1-score': 0.4519090465277648, 'support': 38148}}
[[5916 3671 3197]
 [3672 6059 3324]
 [3423 3616 5270]]
training model: results/PCAR/W8/deepVOL_L3/h30
Epoch 1/50
494/494 - 21s - loss: 3.3194 - accuracy30: 0.3612 - val_loss: 3.3000 - val_accuracy30: 0.3620 - 21s/epoch - 43ms/step
Epoch 2/50
494/494 - 20s - loss: 3.2764 - accuracy30: 0.3720 - val_loss: 3.2626 - val_accuracy30: 0.3879 - 20s/epoch - 40ms/step
Epoch 3/50
494/494 - 20s - loss: 3.2541 - accuracy30: 0.3914 - val_loss: 3.2474 - val_accuracy30: 0.3958 - 20s/epoch - 40ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2300 - accuracy30: 0.4059 - val_loss: 3.2351 - val_accuracy30: 0.4090 - 19s/epoch - 39ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2147 - accuracy30: 0.4142 - val_loss: 3.2310 - val_accuracy30: 0.4082 - 19s/epoch - 39ms/step
Epoch 6/50
494/494 - 19s - loss: 3.1912 - accuracy30: 0.4245 - val_loss: 3.2174 - val_accuracy30: 0.4164 - 19s/epoch - 39ms/step
Epoch 7/50
494/494 - 19s - loss: 3.1815 - accuracy30: 0.4276 - val_loss: 3.2276 - val_accuracy30: 0.4088 - 19s/epoch - 39ms/step
Epoch 8/50
494/494 - 19s - loss: 3.1823 - accuracy30: 0.4277 - val_loss: 3.2166 - val_accuracy30: 0.4147 - 19s/epoch - 39ms/step
Epoch 9/50
494/494 - 19s - loss: 3.1757 - accuracy30: 0.4298 - val_loss: 3.2100 - val_accuracy30: 0.4189 - 19s/epoch - 39ms/step
Epoch 10/50
494/494 - 19s - loss: 3.1651 - accuracy30: 0.4350 - val_loss: 3.2020 - val_accuracy30: 0.4229 - 19s/epoch - 39ms/step
Epoch 11/50
494/494 - 19s - loss: 3.1590 - accuracy30: 0.4380 - val_loss: 3.2098 - val_accuracy30: 0.4193 - 19s/epoch - 39ms/step
Epoch 12/50
494/494 - 19s - loss: 3.1497 - accuracy30: 0.4409 - val_loss: 3.2072 - val_accuracy30: 0.4220 - 19s/epoch - 39ms/step
Epoch 13/50
494/494 - 19s - loss: 3.1466 - accuracy30: 0.4424 - val_loss: 3.2079 - val_accuracy30: 0.4216 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.1419 - accuracy30: 0.4431 - val_loss: 3.2026 - val_accuracy30: 0.4225 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.1397 - accuracy30: 0.4443 - val_loss: 3.1975 - val_accuracy30: 0.4263 - 19s/epoch - 39ms/step
Epoch 16/50
494/494 - 19s - loss: 3.1364 - accuracy30: 0.4464 - val_loss: 3.2002 - val_accuracy30: 0.4233 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.1367 - accuracy30: 0.4461 - val_loss: 3.2048 - val_accuracy30: 0.4237 - 19s/epoch - 39ms/step
Epoch 18/50
494/494 - 19s - loss: 3.1319 - accuracy30: 0.4472 - val_loss: 3.2018 - val_accuracy30: 0.4243 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 3.1261 - accuracy30: 0.4495 - val_loss: 3.1985 - val_accuracy30: 0.4264 - 19s/epoch - 39ms/step
Epoch 20/50
494/494 - 19s - loss: 3.1204 - accuracy30: 0.4515 - val_loss: 3.2010 - val_accuracy30: 0.4219 - 19s/epoch - 39ms/step
Epoch 21/50
494/494 - 19s - loss: 3.1176 - accuracy30: 0.4518 - val_loss: 3.2045 - val_accuracy30: 0.4196 - 19s/epoch - 39ms/step
Epoch 22/50
494/494 - 21s - loss: 3.1138 - accuracy30: 0.4544 - val_loss: 3.2032 - val_accuracy30: 0.4231 - 21s/epoch - 42ms/step
Epoch 23/50
494/494 - 19s - loss: 3.1082 - accuracy30: 0.4555 - val_loss: 3.1954 - val_accuracy30: 0.4234 - 19s/epoch - 39ms/step
Epoch 24/50
494/494 - 19s - loss: 3.1043 - accuracy30: 0.4559 - val_loss: 3.2019 - val_accuracy30: 0.4231 - 19s/epoch - 38ms/step
Epoch 25/50
494/494 - 19s - loss: 3.1020 - accuracy30: 0.4565 - val_loss: 3.2061 - val_accuracy30: 0.4231 - 19s/epoch - 38ms/step
Epoch 26/50
494/494 - 19s - loss: 3.1008 - accuracy30: 0.4574 - val_loss: 3.2185 - val_accuracy30: 0.4156 - 19s/epoch - 38ms/step
Epoch 27/50
494/494 - 19s - loss: 3.0991 - accuracy30: 0.4578 - val_loss: 3.2148 - val_accuracy30: 0.4207 - 19s/epoch - 38ms/step
Epoch 28/50
494/494 - 19s - loss: 3.0929 - accuracy30: 0.4598 - val_loss: 3.2188 - val_accuracy30: 0.4192 - 19s/epoch - 39ms/step
Epoch 29/50
494/494 - 19s - loss: 3.0891 - accuracy30: 0.4615 - val_loss: 3.2221 - val_accuracy30: 0.4162 - 19s/epoch - 39ms/step
Epoch 30/50
494/494 - 19s - loss: 3.0860 - accuracy30: 0.4620 - val_loss: 3.2204 - val_accuracy30: 0.4167 - 19s/epoch - 39ms/step
Epoch 31/50
494/494 - 19s - loss: 3.0833 - accuracy30: 0.4635 - val_loss: 3.2144 - val_accuracy30: 0.4192 - 19s/epoch - 39ms/step
Epoch 32/50
494/494 - 19s - loss: 3.0805 - accuracy30: 0.4645 - val_loss: 3.2114 - val_accuracy30: 0.4184 - 19s/epoch - 38ms/step
Epoch 33/50
494/494 - 19s - loss: 3.0747 - accuracy30: 0.4655 - val_loss: 3.2157 - val_accuracy30: 0.4204 - 19s/epoch - 39ms/step
testing model: results/PCAR/W8/deepVOL_L3/h30
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703045
{'0': {'precision': 0.4234884477192871, 'recall': 0.4410311901143197, 'f1-score': 0.43208183116657156, 'support': 121064}, '1': {'precision': 0.4441161042140234, 'recall': 0.2056799041202384, 'f1-score': 0.2811521048495113, 'support': 123488}, '2': {'precision': 0.41187512774448953, 'recall': 0.6143940305692622, 'f1-score': 0.49315253757007665, 'support': 124635}, 'accuracy': 0.4208355115429308, 'macro avg': {'precision': 0.4264932265592667, 'recall': 0.42036837493460677, 'f1-score': 0.40212882452871984, 'support': 369187}, 'weighted avg': {'precision': 0.42646753937246856, 'recall': 0.4208355115429308, 'f1-score': 0.4022149546220554, 'support': 369187}}
[[53393 15867 51804]
 [40550 25399 57539]
 [32136 15924 76575]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0497203
{'0': {'precision': 0.4459384179074243, 'recall': 0.42343295424490873, 'f1-score': 0.4343943859995313, 'support': 41591}, '1': {'precision': 0.47454144719638386, 'recall': 0.30405955287471875, 'f1-score': 0.3706362058149883, 'support': 41778}, '2': {'precision': 0.42932818044010596, 'recall': 0.6004473126295925, 'f1-score': 0.5006702022262369, 'support': 42923}, 'accuracy': 0.4441057232445444, 'macro avg': {'precision': 0.4499360151813047, 'recall': 0.44264660658307325, 'f1-score': 0.4352335980135855, 'support': 126292}, 'weighted avg': {'precision': 0.4497550977828277, 'recall': 0.4441057232445444, 'f1-score': 0.43582810791500537, 'support': 126292}}
[[17611  7301 16679]
 [11496 12703 17579]
 [10385  6765 25773]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0641294
{'0': {'precision': 0.4530505465757264, 'recall': 0.37586233625300364, 'f1-score': 0.41086256566683615, 'support': 12901}, '1': {'precision': 0.4485774110112083, 'recall': 0.28596105527638194, 'f1-score': 0.34926876048909133, 'support': 12736}, '2': {'precision': 0.4017385904998448, 'recall': 0.6205738949724242, 'f1-score': 0.4877343970851525, 'support': 12511}, 'accuracy': 0.42610359651882146, 'macro avg': {'precision': 0.4344555160289265, 'recall': 0.42746576216726995, 'f1-score': 0.41595524108035997, 'support': 38148}, 'weighted avg': {'precision': 0.43472891144373893, 'recall': 0.42610359651882146, 'f1-score': 0.4155098546500279, 'support': 38148}}
[[4849 2355 5697]
 [3229 3642 5865]
 [2625 2122 7764]]
training model: results/PCAR/W8/deepVOL_L3/h50
Epoch 1/50
494/494 - 22s - loss: 3.3248 - accuracy50: 0.3595 - val_loss: 3.3389 - val_accuracy50: 0.3422 - 22s/epoch - 45ms/step
Epoch 2/50
494/494 - 20s - loss: 3.2968 - accuracy50: 0.3578 - val_loss: 3.2890 - val_accuracy50: 0.3587 - 20s/epoch - 40ms/step
Epoch 3/50
494/494 - 20s - loss: 3.2830 - accuracy50: 0.3697 - val_loss: 3.2751 - val_accuracy50: 0.3808 - 20s/epoch - 40ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2756 - accuracy50: 0.3777 - val_loss: 3.2620 - val_accuracy50: 0.3899 - 19s/epoch - 39ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2614 - accuracy50: 0.3899 - val_loss: 3.2558 - val_accuracy50: 0.3898 - 19s/epoch - 38ms/step
Epoch 6/50
494/494 - 19s - loss: 3.2558 - accuracy50: 0.3920 - val_loss: 3.2406 - val_accuracy50: 0.4066 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 19s - loss: 3.2371 - accuracy50: 0.4050 - val_loss: 3.2414 - val_accuracy50: 0.4006 - 19s/epoch - 38ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2359 - accuracy50: 0.4033 - val_loss: 3.2481 - val_accuracy50: 0.3988 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2301 - accuracy50: 0.4096 - val_loss: 3.2467 - val_accuracy50: 0.4003 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2213 - accuracy50: 0.4140 - val_loss: 3.2337 - val_accuracy50: 0.4083 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2093 - accuracy50: 0.4185 - val_loss: 3.2329 - val_accuracy50: 0.4095 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2075 - accuracy50: 0.4205 - val_loss: 3.2297 - val_accuracy50: 0.4118 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.1927 - accuracy50: 0.4267 - val_loss: 3.2339 - val_accuracy50: 0.4063 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 21s - loss: 3.1824 - accuracy50: 0.4295 - val_loss: 3.2229 - val_accuracy50: 0.4124 - 21s/epoch - 42ms/step
Epoch 15/50
494/494 - 19s - loss: 3.1755 - accuracy50: 0.4332 - val_loss: 3.2265 - val_accuracy50: 0.4126 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.1717 - accuracy50: 0.4337 - val_loss: 3.2316 - val_accuracy50: 0.4117 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.1656 - accuracy50: 0.4364 - val_loss: 3.2389 - val_accuracy50: 0.4089 - 19s/epoch - 38ms/step
Epoch 18/50
494/494 - 19s - loss: 3.1617 - accuracy50: 0.4368 - val_loss: 3.2308 - val_accuracy50: 0.4118 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 3.1588 - accuracy50: 0.4381 - val_loss: 3.2406 - val_accuracy50: 0.4066 - 19s/epoch - 38ms/step
Epoch 20/50
494/494 - 19s - loss: 3.1522 - accuracy50: 0.4395 - val_loss: 3.2392 - val_accuracy50: 0.4068 - 19s/epoch - 38ms/step
Epoch 21/50
494/494 - 19s - loss: 3.1498 - accuracy50: 0.4413 - val_loss: 3.2413 - val_accuracy50: 0.4044 - 19s/epoch - 38ms/step
Epoch 22/50
494/494 - 19s - loss: 3.1517 - accuracy50: 0.4395 - val_loss: 3.2320 - val_accuracy50: 0.4085 - 19s/epoch - 37ms/step
Epoch 23/50
494/494 - 19s - loss: 3.1503 - accuracy50: 0.4414 - val_loss: 3.2355 - val_accuracy50: 0.4057 - 19s/epoch - 38ms/step
Epoch 24/50
494/494 - 19s - loss: 3.1431 - accuracy50: 0.4433 - val_loss: 3.2372 - val_accuracy50: 0.4077 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h50
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822444
{'0': {'precision': 0.3843965867533523, 'recall': 0.49491778774289985, 'f1-score': 0.4327114712320711, 'support': 120420}, '1': {'precision': 0.4223676953696377, 'recall': 0.28137604932946747, 'f1-score': 0.3377483761175427, 'support': 125199}, '2': {'precision': 0.4084351909926724, 'recall': 0.4321345332124822, 'f1-score': 0.41995076797244263, 'support': 123568}, 'accuracy': 0.4014875930084212, 'macro avg': {'precision': 0.40506649103855413, 'recall': 0.4028094567616165, 'f1-score': 0.39680353844068544, 'support': 369187}, 'weighted avg': {'precision': 0.40531917361663466, 'recall': 0.4014875930084212, 'f1-score': 0.3962364622918061, 'support': 369187}}
[[59598 22462 38360]
 [50991 35228 38980]
 [44454 25716 53398]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0689185
{'0': {'precision': 0.4044904366505556, 'recall': 0.47033816889230473, 'f1-score': 0.43493614658523044, 'support': 41636}, '1': {'precision': 0.4493994750377814, 'recall': 0.4037059972371743, 'f1-score': 0.4253290340388693, 'support': 41986}, '2': {'precision': 0.42484001892383155, 'recall': 0.3998593859854699, 'f1-score': 0.4119713633784452, 'support': 42670}, 'accuracy': 0.42437367370854845, 'macro avg': {'precision': 0.42624331020405615, 'recall': 0.4246345173716497, 'f1-score': 0.42407884800084833, 'support': 126292}, 'weighted avg': {'precision': 0.42629599489119435, 'recall': 0.42437367370854845, 'f1-score': 0.4239831841901061, 'support': 126292}}
[[19583 10121 11932]
 [13869 16950 11167]
 [14962 10646 17062]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744874
{'0': {'precision': 0.4078385719829259, 'recall': 0.41802561450958553, 'f1-score': 0.41286926461345064, 'support': 12571}, '1': {'precision': 0.44328358208955226, 'recall': 0.38180580762250454, 'f1-score': 0.41025432680588286, 'support': 13224}, '2': {'precision': 0.38946154400634325, 'recall': 0.43738363150651666, 'f1-score': 0.412033859528712, 'support': 12353}, 'accuracy': 0.4117384921883192, 'macro avg': {'precision': 0.41352789935960715, 'recall': 0.4124050178795356, 'f1-score': 0.4117191503160152, 'support': 38148}, 'weighted avg': {'precision': 0.41417477275505815, 'recall': 0.4117384921883192, 'f1-score': 0.41169227770511857, 'support': 38148}}
[[5255 3039 4277]
 [3982 5049 4193]
 [3648 3302 5403]]
training model: results/PCAR/W8/deepVOL_L3/h100
Epoch 1/50
494/494 - 21s - loss: 3.3136 - accuracy100: 0.3660 - val_loss: 3.3178 - val_accuracy100: 0.3352 - 21s/epoch - 43ms/step
Epoch 2/50
494/494 - 19s - loss: 3.3071 - accuracy100: 0.3524 - val_loss: 3.3046 - val_accuracy100: 0.3437 - 19s/epoch - 38ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2991 - accuracy100: 0.3539 - val_loss: 3.2920 - val_accuracy100: 0.3470 - 19s/epoch - 39ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2874 - accuracy100: 0.3638 - val_loss: 3.2816 - val_accuracy100: 0.3594 - 19s/epoch - 39ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2871 - accuracy100: 0.3626 - val_loss: 3.2744 - val_accuracy100: 0.3689 - 19s/epoch - 39ms/step
Epoch 6/50
494/494 - 19s - loss: 3.2810 - accuracy100: 0.3674 - val_loss: 3.2718 - val_accuracy100: 0.3776 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 19s - loss: 3.2738 - accuracy100: 0.3700 - val_loss: 3.2726 - val_accuracy100: 0.3803 - 19s/epoch - 38ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2652 - accuracy100: 0.3743 - val_loss: 3.2688 - val_accuracy100: 0.3840 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2609 - accuracy100: 0.3799 - val_loss: 3.2707 - val_accuracy100: 0.3813 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2596 - accuracy100: 0.3793 - val_loss: 3.2692 - val_accuracy100: 0.3801 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2651 - accuracy100: 0.3760 - val_loss: 3.2677 - val_accuracy100: 0.3836 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2540 - accuracy100: 0.3821 - val_loss: 3.2656 - val_accuracy100: 0.3863 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.2498 - accuracy100: 0.3849 - val_loss: 3.2662 - val_accuracy100: 0.3858 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.2391 - accuracy100: 0.3907 - val_loss: 3.2710 - val_accuracy100: 0.3850 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.2291 - accuracy100: 0.3976 - val_loss: 3.2719 - val_accuracy100: 0.3852 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.2195 - accuracy100: 0.4011 - val_loss: 3.2640 - val_accuracy100: 0.3899 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.2110 - accuracy100: 0.4044 - val_loss: 3.2661 - val_accuracy100: 0.3866 - 19s/epoch - 38ms/step
Epoch 18/50
494/494 - 19s - loss: 3.2083 - accuracy100: 0.4055 - val_loss: 3.2627 - val_accuracy100: 0.3894 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 3.2054 - accuracy100: 0.4065 - val_loss: 3.2630 - val_accuracy100: 0.3891 - 19s/epoch - 38ms/step
Epoch 20/50
494/494 - 19s - loss: 3.2048 - accuracy100: 0.4081 - val_loss: 3.2624 - val_accuracy100: 0.3902 - 19s/epoch - 38ms/step
Epoch 21/50
494/494 - 19s - loss: 3.2027 - accuracy100: 0.4115 - val_loss: 3.2604 - val_accuracy100: 0.3904 - 19s/epoch - 38ms/step
Epoch 22/50
494/494 - 19s - loss: 3.1940 - accuracy100: 0.4128 - val_loss: 3.2659 - val_accuracy100: 0.3877 - 19s/epoch - 38ms/step
Epoch 23/50
494/494 - 19s - loss: 3.1908 - accuracy100: 0.4157 - val_loss: 3.2697 - val_accuracy100: 0.3885 - 19s/epoch - 38ms/step
Epoch 24/50
494/494 - 19s - loss: 3.1855 - accuracy100: 0.4186 - val_loss: 3.2659 - val_accuracy100: 0.3923 - 19s/epoch - 38ms/step
Epoch 25/50
494/494 - 19s - loss: 3.1775 - accuracy100: 0.4222 - val_loss: 3.2676 - val_accuracy100: 0.3930 - 19s/epoch - 38ms/step
Epoch 26/50
494/494 - 19s - loss: 3.1742 - accuracy100: 0.4246 - val_loss: 3.2670 - val_accuracy100: 0.3905 - 19s/epoch - 38ms/step
Epoch 27/50
494/494 - 19s - loss: 3.1762 - accuracy100: 0.4238 - val_loss: 3.2718 - val_accuracy100: 0.3871 - 19s/epoch - 38ms/step
Epoch 28/50
494/494 - 19s - loss: 3.1697 - accuracy100: 0.4259 - val_loss: 3.2675 - val_accuracy100: 0.3907 - 19s/epoch - 38ms/step
Epoch 29/50
494/494 - 19s - loss: 3.1617 - accuracy100: 0.4301 - val_loss: 3.2664 - val_accuracy100: 0.3921 - 19s/epoch - 38ms/step
Epoch 30/50
494/494 - 19s - loss: 3.1566 - accuracy100: 0.4323 - val_loss: 3.2703 - val_accuracy100: 0.3920 - 19s/epoch - 38ms/step
Epoch 31/50
494/494 - 19s - loss: 3.1512 - accuracy100: 0.4354 - val_loss: 3.2706 - val_accuracy100: 0.3941 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h100
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880882
{'0': {'precision': 0.3657991282599033, 'recall': 0.4678460820499767, 'f1-score': 0.41057679419780485, 'support': 117855}, '1': {'precision': 0.4307223544553074, 'recall': 0.4257936447108236, 'f1-score': 0.4282438187739685, 'support': 130474}, '2': {'precision': 0.3687816436243336, 'recall': 0.2730146121895117, 'f1-score': 0.3137530844240744, 'support': 120858}, 'accuracy': 0.38920384520581713, 'macro avg': {'precision': 0.38843437544651477, 'recall': 0.388884779650104, 'f1-score': 0.3841912324652826, 'support': 369187}, 'weighted avg': {'precision': 0.38971994306793684, 'recall': 0.38920384520581713, 'f1-score': 0.38512402215739405, 'support': 369187}}
[[55138 34800 27917]
 [46359 55555 28560]
 [49236 38626 32996]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0742354
{'0': {'precision': 0.383818942058804, 'recall': 0.4169630840223034, 'f1-score': 0.39970509970164386, 'support': 41608}, '1': {'precision': 0.4313618782919671, 'recall': 0.5339203233256351, 'f1-score': 0.47719283157204445, 'support': 41568}, '2': {'precision': 0.3976720647773279, 'recall': 0.27337879209574173, 'f1-score': 0.3240145142668646, 'support': 43116}, 'accuracy': 0.4064390460203338, 'macro avg': {'precision': 0.4042842950426997, 'recall': 0.40808739981456005, 'f1-score': 0.40030414851351764, 'support': 126292}, 'weighted avg': {'precision': 0.40419676498085766, 'recall': 0.4064390460203338, 'f1-score': 0.39936885319975035, 'support': 126292}}
[[17349 14328  9931]
 [11452 22194  7922]
 [16400 14929 11787]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866985
{'0': {'precision': 0.38525330486903686, 'recall': 0.3765347885402456, 'f1-score': 0.3808441558441558, 'support': 12461}, '1': {'precision': 0.4102469816755531, 'recall': 0.5093593060416983, 'f1-score': 0.45446213381309614, 'support': 13142}, '2': {'precision': 0.3708039784500622, 'recall': 0.28529294539657235, 'f1-score': 0.32247601027165834, 'support': 12545}, 'accuracy': 0.39228793121526684, 'macro avg': {'precision': 0.38876808833155074, 'recall': 0.39039567999283875, 'f1-score': 0.38592743330963675, 'support': 38148}, 'weighted avg': {'precision': 0.38911196326961356, 'recall': 0.39228793121526684, 'f1-score': 0.38701116539277786, 'support': 38148}}
[[4692 4682 3087]
 [3462 6694 2986]
 [4025 4941 3579]]
training model: results/PCAR/W8/deepVOL_L3/h200
Epoch 1/50
494/494 - 21s - loss: 3.3280 - accuracy200: 0.3583 - val_loss: 3.3482 - val_accuracy200: 0.3287 - 21s/epoch - 43ms/step
Epoch 2/50
494/494 - 19s - loss: 3.3081 - accuracy200: 0.3510 - val_loss: 3.4310 - val_accuracy200: 0.3239 - 19s/epoch - 39ms/step
Epoch 3/50
494/494 - 19s - loss: 3.3012 - accuracy200: 0.3562 - val_loss: 3.2880 - val_accuracy200: 0.3538 - 19s/epoch - 38ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2792 - accuracy200: 0.3675 - val_loss: 3.2660 - val_accuracy200: 0.3757 - 19s/epoch - 38ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2724 - accuracy200: 0.3702 - val_loss: 3.2643 - val_accuracy200: 0.3769 - 19s/epoch - 38ms/step
Epoch 6/50
494/494 - 19s - loss: 3.2643 - accuracy200: 0.3754 - val_loss: 3.2614 - val_accuracy200: 0.3775 - 19s/epoch - 39ms/step
Epoch 7/50
494/494 - 19s - loss: 3.2545 - accuracy200: 0.3815 - val_loss: 3.2603 - val_accuracy200: 0.3761 - 19s/epoch - 39ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2474 - accuracy200: 0.3854 - val_loss: 3.2635 - val_accuracy200: 0.3752 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2393 - accuracy200: 0.3891 - val_loss: 3.2626 - val_accuracy200: 0.3781 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2253 - accuracy200: 0.3953 - val_loss: 3.2695 - val_accuracy200: 0.3731 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2208 - accuracy200: 0.3992 - val_loss: 3.2722 - val_accuracy200: 0.3713 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2204 - accuracy200: 0.3959 - val_loss: 3.2777 - val_accuracy200: 0.3726 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.2113 - accuracy200: 0.4021 - val_loss: 3.2959 - val_accuracy200: 0.3703 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.2064 - accuracy200: 0.4055 - val_loss: 3.2886 - val_accuracy200: 0.3730 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.2003 - accuracy200: 0.4096 - val_loss: 3.2875 - val_accuracy200: 0.3735 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.1927 - accuracy200: 0.4130 - val_loss: 3.2987 - val_accuracy200: 0.3729 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.1850 - accuracy200: 0.4142 - val_loss: 3.2983 - val_accuracy200: 0.3724 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h200
Evaluating performance on  test set...
1443/1443 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0858932
{'0': {'precision': 0.3687492714768621, 'recall': 0.1561245640586958, 'f1-score': 0.21937012424154867, 'support': 121576}, '1': {'precision': 0.4162482586487114, 'recall': 0.46989106396920305, 'f1-score': 0.44144601675938966, 'support': 122090}, '2': {'precision': 0.3542907014881399, 'recall': 0.5077477075549112, 'f1-score': 0.4173602698012508, 'support': 125521}, 'accuracy': 0.3794364373610122, 'macro avg': {'precision': 0.3797627438712378, 'recall': 0.3779211118609367, 'f1-score': 0.3593921369340631, 'support': 369187}, 'weighted avg': {'precision': 0.37954135565170216, 'recall': 0.3794364373610122, 'f1-score': 0.3601258030122058, 'support': 369187}}
[[18981 37055 65540]
 [14105 57369 50616]
 [18388 43400 63733]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.076457
{'0': {'precision': 0.37224106133618895, 'recall': 0.15101853639698784, 'f1-score': 0.21486581617760686, 'support': 41432}, '1': {'precision': 0.42601246105919005, 'recall': 0.5786411501658894, 'f1-score': 0.4907330003058416, 'support': 41594}, '2': {'precision': 0.3835846528393757, 'recall': 0.46976840937456665, 'f1-score': 0.4223244989766553, 'support': 43266}, 'accuracy': 0.40105469863490956, 'macro avg': {'precision': 0.39394605841158487, 'recall': 0.3998093653124813, 'f1-score': 0.37597443848670126, 'support': 126292}, 'weighted avg': {'precision': 0.39383672400726377, 'recall': 0.40105469863490956, 'f1-score': 0.3767947350846907, 'support': 126292}}
[[ 6257 15942 19233]
 [ 4097 24068 13429]
 [ 6455 16486 20325]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874106
{'0': {'precision': 0.36405919661733616, 'recall': 0.13526038802922002, 'f1-score': 0.19723956245346774, 'support': 12731}, '1': {'precision': 0.3943298969072165, 'recall': 0.5439560439560439, 'f1-score': 0.4572127139364303, 'support': 12376}, '2': {'precision': 0.3619845833843142, 'recall': 0.4537228740127291, 'f1-score': 0.40269506924830706, 'support': 13041}, 'accuracy': 0.3767169969592115, 'macro avg': {'precision': 0.3734578923029556, 'recall': 0.37764643533266434, 'f1-score': 0.3523824485460684, 'support': 38148}, 'weighted avg': {'precision': 0.37317042540038425, 'recall': 0.3767169969592115, 'f1-score': 0.3518157653176977, 'support': 38148}}
[[1722 4968 6041]
 [1256 6732 4388]
 [1752 5372 5917]]
training model: results/PCAR/W8/deepVOL_L3/h300
Epoch 1/50
494/494 - 22s - loss: 3.3110 - accuracy300: 0.3642 - val_loss: 3.3747 - val_accuracy300: 0.3290 - 22s/epoch - 44ms/step
Epoch 2/50
494/494 - 19s - loss: 3.2969 - accuracy300: 0.3647 - val_loss: 3.3101 - val_accuracy300: 0.3244 - 19s/epoch - 38ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2831 - accuracy300: 0.3686 - val_loss: 3.3480 - val_accuracy300: 0.3299 - 19s/epoch - 39ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2969 - accuracy300: 0.3602 - val_loss: 3.2841 - val_accuracy300: 0.3625 - 19s/epoch - 39ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2821 - accuracy300: 0.3700 - val_loss: 3.2762 - val_accuracy300: 0.3764 - 19s/epoch - 38ms/step
Epoch 6/50
494/494 - 20s - loss: 3.2758 - accuracy300: 0.3716 - val_loss: 3.2659 - val_accuracy300: 0.3783 - 20s/epoch - 40ms/step
Epoch 7/50
494/494 - 19s - loss: 3.2679 - accuracy300: 0.3738 - val_loss: 3.2702 - val_accuracy300: 0.3761 - 19s/epoch - 38ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2699 - accuracy300: 0.3749 - val_loss: 3.2709 - val_accuracy300: 0.3739 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2664 - accuracy300: 0.3764 - val_loss: 3.2689 - val_accuracy300: 0.3798 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2573 - accuracy300: 0.3824 - val_loss: 3.2783 - val_accuracy300: 0.3730 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2468 - accuracy300: 0.3858 - val_loss: 3.2760 - val_accuracy300: 0.3723 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2480 - accuracy300: 0.3807 - val_loss: 3.2792 - val_accuracy300: 0.3627 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.2546 - accuracy300: 0.3826 - val_loss: 3.2993 - val_accuracy300: 0.3561 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.2694 - accuracy300: 0.3736 - val_loss: 3.2859 - val_accuracy300: 0.3600 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.2464 - accuracy300: 0.3840 - val_loss: 3.2858 - val_accuracy300: 0.3602 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.2369 - accuracy300: 0.3904 - val_loss: 3.2820 - val_accuracy300: 0.3675 - 19s/epoch - 38ms/step
testing model: results/PCAR/W8/deepVOL_L3/h300
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910221
{'0': {'precision': 0.3571678834881585, 'recall': 0.3124420145791915, 'f1-score': 0.3333112410139491, 'support': 120720}, '1': {'precision': 0.4177674831720931, 'recall': 0.38908082331760013, 'f1-score': 0.40291419093409486, 'support': 123306}, '2': {'precision': 0.3525227738747521, 'recall': 0.4189483944679253, 'f1-score': 0.3828758771257293, 'support': 125161}, 'accuracy': 0.37414643527534824, 'macro avg': {'precision': 0.37581938017833455, 'recall': 0.373490410788239, 'f1-score': 0.37303376969125773, 'support': 369187}, 'weighted avg': {'precision': 0.3758329710299833, 'recall': 0.37414643527534824, 'f1-score': 0.3733614615342816, 'support': 369187}}
[[37718 31490 51512]
 [30533 47976 44797]
 [37352 35373 52436]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0846567
{'0': {'precision': 0.372660457642753, 'recall': 0.30150705378207904, 'f1-score': 0.33332889746490124, 'support': 41538}, '1': {'precision': 0.42972635499777784, 'recall': 0.4943275878858701, 'f1-score': 0.4597688136130515, 'support': 41076}, '2': {'precision': 0.3749174626931373, 'recall': 0.38999038417509957, 'f1-score': 0.38230541341233504, 'support': 43678}, 'accuracy': 0.39482310835207296, 'macro avg': {'precision': 0.39243475844455605, 'recall': 0.39527500861434955, 'f1-score': 0.39180104149676254, 'support': 126292}, 'weighted avg': {'precision': 0.3920015106496393, 'recall': 0.39482310835207296, 'f1-score': 0.39139150047422433, 'support': 126292}}
[[12524 13102 15912]
 [ 8283 20305 12488]
 [12800 13844 17034]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.089759
{'0': {'precision': 0.36220953933958416, 'recall': 0.28217546645494246, 'f1-score': 0.3172222966037399, 'support': 12595}, '1': {'precision': 0.40342872943453617, 'recall': 0.4737397516032145, 'f1-score': 0.43576628710098936, 'support': 12319}, '2': {'precision': 0.3530641672674838, 'recall': 0.37003173643645154, 'f1-score': 0.36134887839433294, 'support': 13234}, 'accuracy': 0.3745150466603754, 'macro avg': {'precision': 0.372900812013868, 'recall': 0.37531565149820284, 'f1-score': 0.37144582069968735, 'support': 38148}, 'weighted avg': {'precision': 0.37234766843619577, 'recall': 0.3745150466603754, 'f1-score': 0.3708113340985581, 'support': 38148}}
[[3554 3972 5069]
 [2579 5836 3904]
 [3679 4658 4897]]
training model: results/PCAR/W8/deepVOL_L3/h500
Epoch 1/50
494/494 - 22s - loss: 3.3158 - accuracy500: 0.3679 - val_loss: 3.3723 - val_accuracy500: 0.3315 - 22s/epoch - 45ms/step
Epoch 2/50
494/494 - 19s - loss: 3.3068 - accuracy500: 0.3547 - val_loss: 3.3275 - val_accuracy500: 0.3308 - 19s/epoch - 38ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2982 - accuracy500: 0.3543 - val_loss: 3.3160 - val_accuracy500: 0.3328 - 19s/epoch - 38ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2877 - accuracy500: 0.3613 - val_loss: 3.3140 - val_accuracy500: 0.3308 - 19s/epoch - 38ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2822 - accuracy500: 0.3751 - val_loss: 3.3770 - val_accuracy500: 0.3313 - 19s/epoch - 39ms/step
Epoch 6/50
494/494 - 19s - loss: 3.2871 - accuracy500: 0.3667 - val_loss: 3.2936 - val_accuracy500: 0.3417 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 20s - loss: 3.2730 - accuracy500: 0.3754 - val_loss: 3.2912 - val_accuracy500: 0.3357 - 20s/epoch - 41ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2704 - accuracy500: 0.3762 - val_loss: 3.2773 - val_accuracy500: 0.3653 - 19s/epoch - 38ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2626 - accuracy500: 0.3789 - val_loss: 3.2989 - val_accuracy500: 0.3576 - 19s/epoch - 38ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2545 - accuracy500: 0.3840 - val_loss: 3.2772 - val_accuracy500: 0.3718 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2480 - accuracy500: 0.3880 - val_loss: 3.2860 - val_accuracy500: 0.3679 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2474 - accuracy500: 0.3902 - val_loss: 3.2843 - val_accuracy500: 0.3696 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.2351 - accuracy500: 0.3957 - val_loss: 3.2931 - val_accuracy500: 0.3695 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.2223 - accuracy500: 0.4005 - val_loss: 3.3229 - val_accuracy500: 0.3638 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.2089 - accuracy500: 0.4096 - val_loss: 3.3351 - val_accuracy500: 0.3659 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.2025 - accuracy500: 0.4112 - val_loss: 3.3369 - val_accuracy500: 0.3613 - 19s/epoch - 38ms/step
Epoch 17/50
494/494 - 19s - loss: 3.1929 - accuracy500: 0.4151 - val_loss: 3.3689 - val_accuracy500: 0.3547 - 19s/epoch - 38ms/step
Epoch 18/50
494/494 - 19s - loss: 3.1893 - accuracy500: 0.4177 - val_loss: 3.3294 - val_accuracy500: 0.3614 - 19s/epoch - 38ms/step
Epoch 19/50
494/494 - 19s - loss: 3.1790 - accuracy500: 0.4212 - val_loss: 3.3569 - val_accuracy500: 0.3581 - 19s/epoch - 39ms/step
Epoch 20/50
494/494 - 19s - loss: 3.1767 - accuracy500: 0.4215 - val_loss: 3.3921 - val_accuracy500: 0.3510 - 19s/epoch - 39ms/step
testing model: results/PCAR/W8/deepVOL_L3/h500
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091718
{'0': {'precision': 0.35963395075316834, 'recall': 0.1915513718133396, 'f1-score': 0.24996448126249984, 'support': 119404}, '1': {'precision': 0.38889946083095467, 'recall': 0.6315860374816752, 'f1-score': 0.4813855166998853, 'support': 126195}, '2': {'precision': 0.3508306506100711, 'recall': 0.2856992588277179, 'f1-score': 0.3149327482250527, 'support': 123588}, 'accuracy': 0.37348010628759953, 'macro avg': {'precision': 0.36645468739806475, 'recall': 0.36961222270757754, 'f1-score': 0.3487609153958126, 'support': 369187}, 'weighted avg': {'precision': 0.36669047979178876, 'recall': 0.37348010628759953, 'f1-score': 0.3508170999743961, 'support': 369187}}
[[22872 58807 37725]
 [18882 79703 27610]
 [21844 66435 35309]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0880425
{'0': {'precision': 0.368069607446378, 'recall': 0.17780601647076075, 'f1-score': 0.23977986125986592, 'support': 40921}, '1': {'precision': 0.38344093415339164, 'recall': 0.7194361486082905, 'f1-score': 0.5002575050255013, 'support': 41855}, '2': {'precision': 0.3909906047940557, 'recall': 0.25151668351870576, 'f1-score': 0.3061153141562601, 'support': 43516}, 'accuracy': 0.3827083267348684, 'macro avg': {'precision': 0.3808337154646084, 'recall': 0.38291961619925236, 'f1-score': 0.34871756014720906, 'support': 126292}, 'weighted avg': {'precision': 0.38106169720585287, 'recall': 0.3827083267348684, 'f1-score': 0.3489629080724127, 'support': 126292}}
[[ 7276 23523 10122]
 [ 4817 30112  6926]
 [ 7675 24896 10945]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.092981
{'0': {'precision': 0.3642256482130343, 'recall': 0.17034002458009012, 'f1-score': 0.23212192262602577, 'support': 12205}, '1': {'precision': 0.372373110482979, 'recall': 0.7211424038080126, 'f1-score': 0.49113896693321807, 'support': 12605}, '2': {'precision': 0.37875202391331425, 'recall': 0.2279952016794122, 'f1-score': 0.284644545326906, 'support': 13338}, 'accuracy': 0.3724965922197756, 'macro avg': {'precision': 0.3717835942031092, 'recall': 0.37315921002250496, 'f1-score': 0.3359684782953833, 'support': 38148}, 'weighted avg': {'precision': 0.37199673872899813, 'recall': 0.3724965922197756, 'f1-score': 0.3360711882513927, 'support': 38148}}
[[2079 7189 2937]
 [1464 9090 2051]
 [2165 8132 3041]]
training model: results/PCAR/W8/deepVOL_L3/h1000
Epoch 1/50
494/494 - 22s - loss: 3.3319 - accuracy1000: 0.3544 - val_loss: 3.3495 - val_accuracy1000: 0.3566 - 22s/epoch - 44ms/step
Epoch 2/50
494/494 - 19s - loss: 3.3001 - accuracy1000: 0.3547 - val_loss: 3.3141 - val_accuracy1000: 0.3560 - 19s/epoch - 39ms/step
Epoch 3/50
494/494 - 19s - loss: 3.2910 - accuracy1000: 0.3628 - val_loss: 3.3026 - val_accuracy1000: 0.3502 - 19s/epoch - 39ms/step
Epoch 4/50
494/494 - 19s - loss: 3.2786 - accuracy1000: 0.3710 - val_loss: 3.2780 - val_accuracy1000: 0.3556 - 19s/epoch - 39ms/step
Epoch 5/50
494/494 - 19s - loss: 3.2682 - accuracy1000: 0.3782 - val_loss: 3.2798 - val_accuracy1000: 0.3551 - 19s/epoch - 38ms/step
Epoch 6/50
494/494 - 19s - loss: 3.2536 - accuracy1000: 0.3898 - val_loss: 3.2740 - val_accuracy1000: 0.3675 - 19s/epoch - 38ms/step
Epoch 7/50
494/494 - 19s - loss: 3.2458 - accuracy1000: 0.3970 - val_loss: 3.2695 - val_accuracy1000: 0.3757 - 19s/epoch - 38ms/step
Epoch 8/50
494/494 - 19s - loss: 3.2327 - accuracy1000: 0.4035 - val_loss: 3.2890 - val_accuracy1000: 0.3664 - 19s/epoch - 39ms/step
Epoch 9/50
494/494 - 19s - loss: 3.2355 - accuracy1000: 0.3999 - val_loss: 3.2888 - val_accuracy1000: 0.3676 - 19s/epoch - 39ms/step
Epoch 10/50
494/494 - 19s - loss: 3.2304 - accuracy1000: 0.4051 - val_loss: 3.2843 - val_accuracy1000: 0.3705 - 19s/epoch - 38ms/step
Epoch 11/50
494/494 - 19s - loss: 3.2280 - accuracy1000: 0.4058 - val_loss: 3.3095 - val_accuracy1000: 0.3544 - 19s/epoch - 38ms/step
Epoch 12/50
494/494 - 19s - loss: 3.2303 - accuracy1000: 0.4014 - val_loss: 3.2949 - val_accuracy1000: 0.3644 - 19s/epoch - 38ms/step
Epoch 13/50
494/494 - 19s - loss: 3.2173 - accuracy1000: 0.4112 - val_loss: 3.2920 - val_accuracy1000: 0.3682 - 19s/epoch - 38ms/step
Epoch 14/50
494/494 - 19s - loss: 3.2126 - accuracy1000: 0.4145 - val_loss: 3.3018 - val_accuracy1000: 0.3640 - 19s/epoch - 38ms/step
Epoch 15/50
494/494 - 19s - loss: 3.2079 - accuracy1000: 0.4171 - val_loss: 3.3102 - val_accuracy1000: 0.3649 - 19s/epoch - 38ms/step
Epoch 16/50
494/494 - 19s - loss: 3.2003 - accuracy1000: 0.4197 - val_loss: 3.3247 - val_accuracy1000: 0.3609 - 19s/epoch - 39ms/step
Epoch 17/50
494/494 - 19s - loss: 3.1911 - accuracy1000: 0.4248 - val_loss: 3.3225 - val_accuracy1000: 0.3620 - 19s/epoch - 39ms/step
testing model: results/PCAR/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
1443/1443 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974637
{'0': {'precision': 0.34413841852085847, 'recall': 0.4410161448062463, 'f1-score': 0.3866005642829285, 'support': 124746}, '1': {'precision': 0.3465103294249023, 'recall': 0.3944467648500917, 'f1-score': 0.3689279162986616, 'support': 110134}, '2': {'precision': 0.36611715939681255, 'recall': 0.22885627703693776, 'f1-score': 0.2816536165416634, 'support': 134307}, 'accuracy': 0.34994189936265363, 'macro avg': {'precision': 0.3522553024475245, 'recall': 0.3547730622310919, 'f1-score': 0.34572736570775114, 'support': 369187}, 'weighted avg': {'precision': 0.3528416685982792, 'recall': 0.34994189936265363, 'f1-score': 0.3431497680106184, 'support': 369187}}
[[55015 37365 32366]
 [45841 43442 20851]
 [59007 44563 30737]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0857637
{'0': {'precision': 0.3551239115874079, 'recall': 0.45918392596441737, 'f1-score': 0.40050502870462296, 'support': 40413}, '1': {'precision': 0.42346732449045615, 'recall': 0.5068980540226546, 'f1-score': 0.461441854316309, 'support': 41316}, '2': {'precision': 0.405841910418616, 'recall': 0.223862845858672, 'f1-score': 0.2885572139303483, 'support': 44563}, 'accuracy': 0.391758781237133, 'macro avg': {'precision': 0.39481104883216006, 'recall': 0.39664827528191465, 'f1-score': 0.38350136565042675, 'support': 126292}, 'weighted avg': {'precision': 0.3953784220030912, 'recall': 0.391758781237133, 'f1-score': 0.3809387491080247, 'support': 126292}}
[[18557 13420  8436]
 [14204 20943  6169]
 [19494 15093  9976]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0921619
{'0': {'precision': 0.3653262763828826, 'recall': 0.4490281634272114, 'f1-score': 0.40287564951242083, 'support': 12605}, '1': {'precision': 0.38683154214683413, 'recall': 0.5106401162293821, 'f1-score': 0.4401959700887759, 'support': 11701}, '2': {'precision': 0.36343459564433345, 'recall': 0.18927900592399943, 'f1-score': 0.24891929124507148, 'support': 13842}, 'accuracy': 0.37367620845129496, 'macro avg': {'precision': 0.3718641380580167, 'recall': 0.3829824285268643, 'f1-score': 0.3639969702820894, 'support': 38148}, 'weighted avg': {'precision': 0.37123611359377173, 'recall': 0.37367620845129496, 'f1-score': 0.35845972102147194, 'support': 38148}}
[[5660 4266 2679]
 [3816 5975 1910]
 [6017 5205 2620]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  11.23 (ave)

============================================
