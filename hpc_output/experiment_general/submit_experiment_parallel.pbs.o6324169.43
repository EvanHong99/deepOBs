This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-26.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-18.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-05.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-14.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-10.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-12.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-28.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-13.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-04.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-06-19.csv
training model: results/CHTR/W4/deepLOB_L1/h10
Epoch 1/50
346/346 - 27s - loss: 3.3244 - accuracy10: 0.3664 - val_loss: 3.3282 - val_accuracy10: 0.3679 - 27s/epoch - 77ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2866 - accuracy10: 0.3783 - val_loss: 3.3309 - val_accuracy10: 0.3505 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2739 - accuracy10: 0.3811 - val_loss: 3.3016 - val_accuracy10: 0.3688 - 15s/epoch - 42ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2596 - accuracy10: 0.3896 - val_loss: 3.3006 - val_accuracy10: 0.3611 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2449 - accuracy10: 0.3990 - val_loss: 3.2867 - val_accuracy10: 0.3698 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2392 - accuracy10: 0.4034 - val_loss: 3.2770 - val_accuracy10: 0.3728 - 6s/epoch - 17ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2330 - accuracy10: 0.4070 - val_loss: 3.2819 - val_accuracy10: 0.3706 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2248 - accuracy10: 0.4123 - val_loss: 3.2694 - val_accuracy10: 0.3763 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2150 - accuracy10: 0.4172 - val_loss: 3.2655 - val_accuracy10: 0.3877 - 6s/epoch - 18ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2106 - accuracy10: 0.4201 - val_loss: 3.2624 - val_accuracy10: 0.3871 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2074 - accuracy10: 0.4230 - val_loss: 3.2652 - val_accuracy10: 0.3854 - 6s/epoch - 17ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2015 - accuracy10: 0.4257 - val_loss: 3.2709 - val_accuracy10: 0.3890 - 6s/epoch - 17ms/step
Epoch 13/50
346/346 - 6s - loss: 3.1930 - accuracy10: 0.4297 - val_loss: 3.2787 - val_accuracy10: 0.3852 - 6s/epoch - 17ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1876 - accuracy10: 0.4322 - val_loss: 3.2680 - val_accuracy10: 0.3855 - 6s/epoch - 17ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1843 - accuracy10: 0.4339 - val_loss: 3.2693 - val_accuracy10: 0.3866 - 6s/epoch - 17ms/step
Epoch 16/50
346/346 - 6s - loss: 3.1794 - accuracy10: 0.4362 - val_loss: 3.2535 - val_accuracy10: 0.3944 - 6s/epoch - 17ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1769 - accuracy10: 0.4370 - val_loss: 3.2588 - val_accuracy10: 0.3928 - 6s/epoch - 18ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1716 - accuracy10: 0.4408 - val_loss: 3.2737 - val_accuracy10: 0.3881 - 6s/epoch - 17ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1703 - accuracy10: 0.4387 - val_loss: 3.2687 - val_accuracy10: 0.3921 - 6s/epoch - 17ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1654 - accuracy10: 0.4416 - val_loss: 3.2662 - val_accuracy10: 0.3935 - 6s/epoch - 17ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1617 - accuracy10: 0.4424 - val_loss: 3.2649 - val_accuracy10: 0.3889 - 6s/epoch - 17ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1588 - accuracy10: 0.4432 - val_loss: 3.2656 - val_accuracy10: 0.3901 - 6s/epoch - 18ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1547 - accuracy10: 0.4470 - val_loss: 3.2756 - val_accuracy10: 0.3897 - 6s/epoch - 17ms/step
Epoch 24/50
346/346 - 6s - loss: 3.1509 - accuracy10: 0.4480 - val_loss: 3.2840 - val_accuracy10: 0.3866 - 6s/epoch - 17ms/step
Epoch 25/50
346/346 - 6s - loss: 3.1476 - accuracy10: 0.4492 - val_loss: 3.2833 - val_accuracy10: 0.3884 - 6s/epoch - 17ms/step
Epoch 26/50
346/346 - 6s - loss: 3.1443 - accuracy10: 0.4514 - val_loss: 3.2763 - val_accuracy10: 0.3913 - 6s/epoch - 17ms/step
testing model: results/CHTR/W4/deepLOB_L1/h10
Evaluating performance on  test set...
925/925 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.084998
{'0': {'precision': 0.35134153617348746, 'recall': 0.5796433666191155, 'f1-score': 0.4374996635280564, 'support': 70100}, '1': {'precision': 0.55592911892167, 'recall': 0.3443344859866649, 'f1-score': 0.42526559191161295, 'support': 104686}, '2': {'precision': 0.34014803743639016, 'recall': 0.30879692446856627, 'f1-score': 0.3237151807636949, 'support': 61908}, 'accuracy': 0.40472931295258857, 'macro avg': {'precision': 0.4158062308438492, 'recall': 0.4109249256914489, 'f1-score': 0.3954934787344548, 'support': 236694}, 'weighted avg': {'precision': 0.4388996853777766, 'recall': 0.40472931295258857, 'f1-score': 0.402328067373464, 'support': 236694}}
[[40633 15521 13946]
 [45500 36047 23139]
 [29518 13273 19117]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0929074
{'0': {'precision': 0.3938578064439776, 'recall': 0.44747722612524793, 'f1-score': 0.41895889721155666, 'support': 29749}, '1': {'precision': 0.3878350097886991, 'recall': 0.396904901723721, 'f1-score': 0.39231754161331633, 'support': 28949}, '2': {'precision': 0.4154305030821237, 'recall': 0.349692019282271, 'f1-score': 0.37973717214679104, 'support': 29872}, 'accuracy': 0.3979677091565993, 'macro avg': {'precision': 0.3990411064382668, 'recall': 0.3980247157104133, 'f1-score': 0.39700453699055466, 'support': 88570}, 'weighted avg': {'precision': 0.3991650849084807, 'recall': 0.3979677091565993, 'f1-score': 0.3970228920817369, 'support': 88570}}
[[13312  9311  7126]
 [ 9886 11490  7573]
 [10601  8825 10446]]
Evaluating performance on  val set...
127/127 - 1s - 876ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0865608
{'0': {'precision': 0.41380456459118103, 'recall': 0.34382767191383595, 'f1-score': 0.3755844939413746, 'support': 10863}, '1': {'precision': 0.37785067166510466, 'recall': 0.4396183552930486, 'f1-score': 0.40640094082069805, 'support': 11005}, '2': {'precision': 0.3893305238961785, 'recall': 0.3907526674997597, 'f1-score': 0.39004029936672424, 'support': 10403}, 'accuracy': 0.391620959995042, 'macro avg': {'precision': 0.3936619200508214, 'recall': 0.3913995649022148, 'f1-score': 0.39067524470959897, 'support': 32271}, 'weighted avg': {'precision': 0.3936540877853311, 'recall': 0.391620959995042, 'f1-score': 0.39075349216723887, 'support': 32271}}
[[3735 4242 2886]
 [2677 4838 3490]
 [2614 3724 4065]]
training model: results/CHTR/W4/deepLOB_L1/h20
Epoch 1/50
346/346 - 8s - loss: 3.3169 - accuracy20: 0.3698 - val_loss: 3.3459 - val_accuracy20: 0.3483 - 8s/epoch - 23ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2874 - accuracy20: 0.3798 - val_loss: 3.3058 - val_accuracy20: 0.3670 - 6s/epoch - 17ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2672 - accuracy20: 0.3911 - val_loss: 3.3190 - val_accuracy20: 0.3604 - 6s/epoch - 17ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2720 - accuracy20: 0.3850 - val_loss: 3.2953 - val_accuracy20: 0.3677 - 6s/epoch - 17ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2547 - accuracy20: 0.3970 - val_loss: 3.2764 - val_accuracy20: 0.3801 - 6s/epoch - 17ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2481 - accuracy20: 0.4009 - val_loss: 3.2786 - val_accuracy20: 0.3811 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2417 - accuracy20: 0.4009 - val_loss: 3.2895 - val_accuracy20: 0.3702 - 6s/epoch - 17ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2370 - accuracy20: 0.4060 - val_loss: 3.2941 - val_accuracy20: 0.3692 - 6s/epoch - 17ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2296 - accuracy20: 0.4108 - val_loss: 3.2781 - val_accuracy20: 0.3823 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2217 - accuracy20: 0.4164 - val_loss: 3.2835 - val_accuracy20: 0.3794 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2151 - accuracy20: 0.4189 - val_loss: 3.2796 - val_accuracy20: 0.3856 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2105 - accuracy20: 0.4208 - val_loss: 3.2683 - val_accuracy20: 0.3899 - 6s/epoch - 18ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2020 - accuracy20: 0.4246 - val_loss: 3.2726 - val_accuracy20: 0.3906 - 6s/epoch - 18ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1977 - accuracy20: 0.4255 - val_loss: 3.2694 - val_accuracy20: 0.3848 - 6s/epoch - 17ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1921 - accuracy20: 0.4289 - val_loss: 3.2687 - val_accuracy20: 0.3864 - 6s/epoch - 17ms/step
Epoch 16/50
346/346 - 6s - loss: 3.1874 - accuracy20: 0.4305 - val_loss: 3.2690 - val_accuracy20: 0.3842 - 6s/epoch - 17ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1810 - accuracy20: 0.4360 - val_loss: 3.2707 - val_accuracy20: 0.3853 - 6s/epoch - 18ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1769 - accuracy20: 0.4368 - val_loss: 3.2733 - val_accuracy20: 0.3842 - 6s/epoch - 18ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1716 - accuracy20: 0.4372 - val_loss: 3.2766 - val_accuracy20: 0.3849 - 6s/epoch - 18ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1700 - accuracy20: 0.4410 - val_loss: 3.2837 - val_accuracy20: 0.3802 - 6s/epoch - 18ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1655 - accuracy20: 0.4406 - val_loss: 3.2902 - val_accuracy20: 0.3771 - 6s/epoch - 18ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1613 - accuracy20: 0.4435 - val_loss: 3.2920 - val_accuracy20: 0.3815 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h20
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713634
{'0': {'precision': 0.35596272280594216, 'recall': 0.5221416729888448, 'f1-score': 0.4233277330068059, 'support': 71178}, '1': {'precision': 0.5211087264035901, 'recall': 0.4181474813104231, 'f1-score': 0.46398479913137897, 'support': 102196}, '2': {'precision': 0.36797724877195076, 'recall': 0.2922141503474416, 'f1-score': 0.3257484397419082, 'support': 63320}, 'accuracy': 0.415730859252875, 'macro avg': {'precision': 0.4150162326604943, 'recall': 0.41083443488223653, 'f1-score': 0.40435365729336437, 'support': 236694}, 'weighted avg': {'precision': 0.4304809647885564, 'recall': 0.415730859252875, 'f1-score': 0.4147777430625469, 'support': 236694}}
[[37165 21087 12926]
 [40609 42733 18854]
 [26633 18184 18503]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0928141
{'0': {'precision': 0.3910583330231173, 'recall': 0.35215044752103514, 'f1-score': 0.3705859526581296, 'support': 29831}, '1': {'precision': 0.3729050647945314, 'recall': 0.4829436696745967, 'f1-score': 0.4208503983915407, 'support': 29256}, '2': {'precision': 0.4064153161474515, 'recall': 0.32832479734084047, 'f1-score': 0.36322020224761253, 'support': 29483}, 'accuracy': 0.38742237778028676, 'macro avg': {'precision': 0.39012623798836676, 'recall': 0.3878063048454908, 'f1-score': 0.3848855177657609, 'support': 88570}, 'weighted avg': {'precision': 0.3901740371911114, 'recall': 0.38742237778028676, 'f1-score': 0.3847371574116963, 'support': 88570}}
[[10505 12228  7098]
 [ 8087 14129  7040]
 [ 8271 11532  9680]]
Evaluating performance on  val set...
127/127 - 1s - 969ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0909364
{'0': {'precision': 0.3958427474017171, 'recall': 0.24243542435424353, 'f1-score': 0.3007037015847588, 'support': 10840}, '1': {'precision': 0.3784171896606744, 'recall': 0.6441828881846989, 'f1-score': 0.47676483398666525, 'support': 11045}, '2': {'precision': 0.3995607613469985, 'recall': 0.2627575582514924, 'f1-score': 0.3170306691449814, 'support': 10386}, 'accuracy': 0.3864770227138917, 'macro avg': {'precision': 0.3912735661364633, 'recall': 0.3831252902634783, 'f1-score': 0.36483306823880185, 'support': 32271}, 'weighted avg': {'precision': 0.39107530937952617, 'recall': 0.3864770227138917, 'f1-score': 0.36621661077441914, 'support': 32271}}
[[2628 6085 2127]
 [1956 7115 1974]
 [2055 5602 2729]]
training model: results/CHTR/W4/deepLOB_L1/h30
Epoch 1/50
346/346 - 8s - loss: 3.3235 - accuracy30: 0.3682 - val_loss: 3.3849 - val_accuracy30: 0.3583 - 8s/epoch - 24ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2924 - accuracy30: 0.3746 - val_loss: 3.3480 - val_accuracy30: 0.3441 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2743 - accuracy30: 0.3818 - val_loss: 3.3024 - val_accuracy30: 0.3697 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2690 - accuracy30: 0.3840 - val_loss: 3.3038 - val_accuracy30: 0.3632 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2616 - accuracy30: 0.3885 - val_loss: 3.2990 - val_accuracy30: 0.3633 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2554 - accuracy30: 0.3910 - val_loss: 3.2990 - val_accuracy30: 0.3685 - 6s/epoch - 17ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2454 - accuracy30: 0.3971 - val_loss: 3.2858 - val_accuracy30: 0.3757 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2392 - accuracy30: 0.4037 - val_loss: 3.2916 - val_accuracy30: 0.3701 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2337 - accuracy30: 0.4100 - val_loss: 3.2857 - val_accuracy30: 0.3767 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2253 - accuracy30: 0.4135 - val_loss: 3.2885 - val_accuracy30: 0.3691 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2196 - accuracy30: 0.4174 - val_loss: 3.2756 - val_accuracy30: 0.3861 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2119 - accuracy30: 0.4221 - val_loss: 3.2812 - val_accuracy30: 0.3807 - 6s/epoch - 18ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2124 - accuracy30: 0.4212 - val_loss: 3.2838 - val_accuracy30: 0.3805 - 6s/epoch - 18ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2051 - accuracy30: 0.4241 - val_loss: 3.2865 - val_accuracy30: 0.3776 - 6s/epoch - 19ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1981 - accuracy30: 0.4276 - val_loss: 3.2871 - val_accuracy30: 0.3797 - 6s/epoch - 18ms/step
Epoch 16/50
346/346 - 6s - loss: 3.1962 - accuracy30: 0.4300 - val_loss: 3.2961 - val_accuracy30: 0.3792 - 6s/epoch - 18ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1917 - accuracy30: 0.4330 - val_loss: 3.2997 - val_accuracy30: 0.3751 - 6s/epoch - 17ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1894 - accuracy30: 0.4324 - val_loss: 3.2995 - val_accuracy30: 0.3740 - 6s/epoch - 18ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1861 - accuracy30: 0.4328 - val_loss: 3.3084 - val_accuracy30: 0.3699 - 6s/epoch - 17ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1810 - accuracy30: 0.4355 - val_loss: 3.3088 - val_accuracy30: 0.3694 - 6s/epoch - 18ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1789 - accuracy30: 0.4360 - val_loss: 3.3173 - val_accuracy30: 0.3701 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h30
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826169
{'0': {'precision': 0.34703029034059185, 'recall': 0.5562267528036469, 'f1-score': 0.42740332441521883, 'support': 71514}, '1': {'precision': 0.5020170397021946, 'recall': 0.3211922509666361, 'f1-score': 0.39174480860037314, 'support': 100348}, '2': {'precision': 0.36497485613562136, 'recall': 0.32576505429417574, 'f1-score': 0.3442570844098159, 'support': 64832}, 'accuracy': 0.39345737534538266, 'macro avg': {'precision': 0.40467406205946926, 'recall': 0.40106135268815285, 'f1-score': 0.38780173914180266, 'support': 236694}, 'weighted avg': {'precision': 0.4176530877691767, 'recall': 0.39345737534538266, 'f1-score': 0.3895113720335851, 'support': 236694}}
[[39778 16398 15338]
 [46708 32231 21409]
 [28138 15574 21120]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0934764
{'0': {'precision': 0.37641094317964413, 'recall': 0.393028365960847, 'f1-score': 0.38454021303625524, 'support': 30036}, '1': {'precision': 0.38344286958587376, 'recall': 0.3302530177999045, 'f1-score': 0.3548658947676975, 'support': 29326}, '2': {'precision': 0.3875743348982786, 'recall': 0.4239591892632156, 'f1-score': 0.40495111023905295, 'support': 29208}, 'accuracy': 0.38244326521395505, 'macro avg': {'precision': 0.3824760492212655, 'recall': 0.3824135243413223, 'f1-score': 0.3814524060143352, 'support': 88570}, 'weighted avg': {'precision': 0.38242063742269444, 'recall': 0.38244326521395505, 'f1-score': 0.38144585182992796, 'support': 88570}}
[[11805  8105 10126]
 [10200  9685  9441]
 [ 9357  7468 12383]]
Evaluating performance on  val set...
127/127 - 1s - 879ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0944163
{'0': {'precision': 0.38390763124661736, 'recall': 0.3895295625114406, 'f1-score': 0.3866981646374705, 'support': 10926}, '1': {'precision': 0.3725992317541613, 'recall': 0.3510579064587973, 'f1-score': 0.3615079554684887, 'support': 10776}, '2': {'precision': 0.38143582306018853, 'recall': 0.39814551991673763, 'f1-score': 0.3896115920559234, 'support': 10569}, 'accuracy': 0.3795048185677543, 'macro avg': {'precision': 0.3793142286869891, 'recall': 0.37957766296232515, 'f1-score': 0.3792725707206275, 'support': 32271}, 'weighted avg': {'precision': 0.3793219706332781, 'recall': 0.3795048185677543, 'f1-score': 0.3792407669857299, 'support': 32271}}
[[4256 3362 3308]
 [3477 3783 3516]
 [3353 3008 4208]]
training model: results/CHTR/W4/deepLOB_L1/h50
Epoch 1/50
346/346 - 8s - loss: 3.3288 - accuracy50: 0.3623 - val_loss: 3.3742 - val_accuracy50: 0.3420 - 8s/epoch - 24ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3006 - accuracy50: 0.3730 - val_loss: 3.3331 - val_accuracy50: 0.3404 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2835 - accuracy50: 0.3754 - val_loss: 3.3131 - val_accuracy50: 0.3533 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2875 - accuracy50: 0.3748 - val_loss: 3.3162 - val_accuracy50: 0.3518 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2762 - accuracy50: 0.3808 - val_loss: 3.3061 - val_accuracy50: 0.3538 - 6s/epoch - 17ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2612 - accuracy50: 0.3870 - val_loss: 3.3051 - val_accuracy50: 0.3551 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2575 - accuracy50: 0.3918 - val_loss: 3.2905 - val_accuracy50: 0.3657 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2485 - accuracy50: 0.3965 - val_loss: 3.2937 - val_accuracy50: 0.3613 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2408 - accuracy50: 0.4023 - val_loss: 3.2836 - val_accuracy50: 0.3701 - 6s/epoch - 18ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2348 - accuracy50: 0.4070 - val_loss: 3.2845 - val_accuracy50: 0.3778 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2269 - accuracy50: 0.4134 - val_loss: 3.2868 - val_accuracy50: 0.3723 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2208 - accuracy50: 0.4141 - val_loss: 3.2836 - val_accuracy50: 0.3689 - 6s/epoch - 18ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2169 - accuracy50: 0.4188 - val_loss: 3.3065 - val_accuracy50: 0.3653 - 6s/epoch - 17ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2154 - accuracy50: 0.4187 - val_loss: 3.3006 - val_accuracy50: 0.3612 - 6s/epoch - 18ms/step
Epoch 15/50
346/346 - 7s - loss: 3.2113 - accuracy50: 0.4227 - val_loss: 3.2900 - val_accuracy50: 0.3714 - 7s/epoch - 19ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2080 - accuracy50: 0.4232 - val_loss: 3.3077 - val_accuracy50: 0.3649 - 6s/epoch - 18ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2025 - accuracy50: 0.4260 - val_loss: 3.3177 - val_accuracy50: 0.3635 - 6s/epoch - 18ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2017 - accuracy50: 0.4268 - val_loss: 3.3321 - val_accuracy50: 0.3593 - 6s/epoch - 18ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1982 - accuracy50: 0.4274 - val_loss: 3.3264 - val_accuracy50: 0.3635 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h50
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1078354
{'0': {'precision': 0.3312159709618875, 'recall': 0.5715627936110241, 'f1-score': 0.41939561070895093, 'support': 73439}, '1': {'precision': 0.42426541041200894, 'recall': 0.11192795829164252, 'f1-score': 0.17712699907494606, 'support': 94945}, '2': {'precision': 0.34213811295868857, 'recall': 0.42531108183282096, 'f1-score': 0.3792176262514194, 'support': 68310}, 'accuracy': 0.34498128385172416, 'macro avg': {'precision': 0.36587316477752835, 'recall': 0.36960061124516247, 'f1-score': 0.32524674534510545, 'support': 236694}, 'weighted avg': {'precision': 0.3716930026922789, 'recall': 0.34498128385172416, 'f1-score': 0.3106190829985545, 'support': 236694}}
[[41975  7079 24385]
 [52840 10627 31478]
 [31915  7342 29053]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1065546
{'0': {'precision': 0.36936759449494805, 'recall': 0.43312101910828027, 'f1-score': 0.39871187264552194, 'support': 30301}, '1': {'precision': 0.356453835553514, 'recall': 0.13389929944438692, 'f1-score': 0.19467161707892228, 'support': 28977}, '2': {'precision': 0.34784362100868244, 'recall': 0.5005803632391097, 'f1-score': 0.4104638468213756, 'support': 29292}, 'accuracy': 0.3575364118776109, 'macro avg': {'precision': 0.3578883503523815, 'recall': 0.3558668939305923, 'f1-score': 0.3346157788486066, 'support': 88570}, 'weighted avg': {'precision': 0.35802422513505616, 'recall': 0.3575364118776109, 'f1-score': 0.3358436818586386, 'support': 88570}}
[[13124  3424 13753]
 [11359  3880 13738]
 [11048  3581 14663]]
Evaluating performance on  val set...
127/127 - 1s - 997ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094875
{'0': {'precision': 0.3845451779738363, 'recall': 0.3460485490052929, 'f1-score': 0.36428262644699555, 'support': 10958}, '1': {'precision': 0.38849887976101566, 'recall': 0.24710241307239217, 'f1-score': 0.3020730503455084, 'support': 10526}, '2': {'precision': 0.3564747056951957, 'recall': 0.5193288217298601, 'f1-score': 0.42276054637385857, 'support': 10787}, 'accuracy': 0.37169594992408045, 'macro avg': {'precision': 0.37650625447668257, 'recall': 0.37082659460251505, 'f1-score': 0.36303874105545414, 'support': 32271}, 'weighted avg': {'precision': 0.3764518582918355, 'recall': 0.37169594992408045, 'f1-score': 0.36353840792903264, 'support': 32271}}
[[3792 1876 5290]
 [3102 2601 4823]
 [2967 2218 5602]]
training model: results/CHTR/W4/deepLOB_L1/h100
Epoch 1/50
346/346 - 8s - loss: 3.3432 - accuracy100: 0.3592 - val_loss: 3.4098 - val_accuracy100: 0.3386 - 8s/epoch - 24ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3038 - accuracy100: 0.3681 - val_loss: 3.3603 - val_accuracy100: 0.3458 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2902 - accuracy100: 0.3793 - val_loss: 3.3263 - val_accuracy100: 0.3399 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2903 - accuracy100: 0.3751 - val_loss: 3.3145 - val_accuracy100: 0.3467 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2774 - accuracy100: 0.3794 - val_loss: 3.3303 - val_accuracy100: 0.3482 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2811 - accuracy100: 0.3743 - val_loss: 3.3418 - val_accuracy100: 0.3321 - 6s/epoch - 17ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2652 - accuracy100: 0.3863 - val_loss: 3.3224 - val_accuracy100: 0.3454 - 6s/epoch - 19ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2620 - accuracy100: 0.3907 - val_loss: 3.3198 - val_accuracy100: 0.3485 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2519 - accuracy100: 0.3947 - val_loss: 3.3152 - val_accuracy100: 0.3594 - 6s/epoch - 18ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2395 - accuracy100: 0.4059 - val_loss: 3.3276 - val_accuracy100: 0.3504 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2320 - accuracy100: 0.4112 - val_loss: 3.3265 - val_accuracy100: 0.3549 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2297 - accuracy100: 0.4130 - val_loss: 3.3219 - val_accuracy100: 0.3498 - 6s/epoch - 17ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2252 - accuracy100: 0.4142 - val_loss: 3.3122 - val_accuracy100: 0.3544 - 6s/epoch - 17ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2210 - accuracy100: 0.4172 - val_loss: 3.3159 - val_accuracy100: 0.3529 - 6s/epoch - 18ms/step
Epoch 15/50
346/346 - 6s - loss: 3.2172 - accuracy100: 0.4182 - val_loss: 3.3157 - val_accuracy100: 0.3538 - 6s/epoch - 17ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2116 - accuracy100: 0.4215 - val_loss: 3.3308 - val_accuracy100: 0.3577 - 6s/epoch - 18ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2073 - accuracy100: 0.4223 - val_loss: 3.3314 - val_accuracy100: 0.3547 - 6s/epoch - 18ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2065 - accuracy100: 0.4212 - val_loss: 3.3309 - val_accuracy100: 0.3586 - 6s/epoch - 17ms/step
Epoch 19/50
346/346 - 6s - loss: 3.2024 - accuracy100: 0.4237 - val_loss: 3.3459 - val_accuracy100: 0.3497 - 6s/epoch - 18ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1965 - accuracy100: 0.4251 - val_loss: 3.3368 - val_accuracy100: 0.3547 - 6s/epoch - 18ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1907 - accuracy100: 0.4307 - val_loss: 3.3492 - val_accuracy100: 0.3535 - 6s/epoch - 17ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1886 - accuracy100: 0.4314 - val_loss: 3.3482 - val_accuracy100: 0.3590 - 6s/epoch - 18ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1840 - accuracy100: 0.4330 - val_loss: 3.3379 - val_accuracy100: 0.3612 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h100
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1105684
{'0': {'precision': 0.32453734556825753, 'recall': 0.6826710519221437, 'f1-score': 0.4399332881638609, 'support': 74188}, '1': {'precision': 0.4182816229116945, 'recall': 0.0946839546191248, 'f1-score': 0.15441409691629956, 'support': 92550}, '2': {'precision': 0.3591006567484251, 'recall': 0.306392589627766, 'f1-score': 0.3306593440498596, 'support': 69956}, 'accuracy': 0.34155069414518324, 'macro avg': {'precision': 0.36730654174279237, 'recall': 0.36124919872301153, 'f1-score': 0.30833557637667336, 'support': 236694}, 'weighted avg': {'precision': 0.3714077515145633, 'recall': 0.34155069414518324, 'f1-score': 0.2959956759539997, 'support': 236694}}
[[50646  6371 17171]
 [62704  8763 21083]
 [42706  5816 21434]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1131495
{'0': {'precision': 0.3564686021351975, 'recall': 0.4941983122362869, 'f1-score': 0.4141836917934054, 'support': 30336}, '1': {'precision': 0.32797303803562833, 'recall': 0.11720981451529647, 'f1-score': 0.17270053747084474, 'support': 29059}, '2': {'precision': 0.3428642604074402, 'recall': 0.4245758354755784, 'f1-score': 0.3793700136287766, 'support': 29175}, 'accuracy': 0.3475781867449475, 'macro avg': {'precision': 0.3424353001927553, 'recall': 0.34532798740905396, 'f1-score': 0.3220847476310089, 'support': 88570}, 'weighted avg': {'precision': 0.3426381937906486, 'recall': 0.3475781867449475, 'f1-score': 0.3234876542873386, 'support': 88570}}
[[14992  3634 11710]
 [13622  3406 12031]
 [13443  3345 12387]]
Evaluating performance on  val set...
127/127 - 1s - 961ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1045436
{'0': {'precision': 0.37047551454932576, 'recall': 0.3322120192744795, 'f1-score': 0.35030198446937016, 'support': 10999}, '1': {'precision': 0.3307849133537207, 'recall': 0.12964442668797443, 'f1-score': 0.18628013777267508, 'support': 10012}, '2': {'precision': 0.34851763687513526, 'recall': 0.5721136767317939, 'f1-score': 0.4331629908552986, 'support': 11260}, 'accuracy': 0.3530724179603979, 'macro avg': {'precision': 0.3499260215927273, 'recall': 0.3446567075647493, 'f1-score': 0.3232483710324479, 'support': 32271}, 'weighted avg': {'precision': 0.35050005665270706, 'recall': 0.3530724179603979, 'f1-score': 0.3283264709364224, 'support': 32271}}
[[3654 1322 6023]
 [2695 1298 6019]
 [3514 1304 6442]]
training model: results/CHTR/W4/deepLOB_L1/h200
Epoch 1/50
346/346 - 8s - loss: 3.3362 - accuracy200: 0.3597 - val_loss: 3.4016 - val_accuracy200: 0.3391 - 8s/epoch - 23ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2960 - accuracy200: 0.3724 - val_loss: 3.3817 - val_accuracy200: 0.3483 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2737 - accuracy200: 0.3832 - val_loss: 3.3766 - val_accuracy200: 0.3457 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2796 - accuracy200: 0.3812 - val_loss: 3.4215 - val_accuracy200: 0.3305 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2739 - accuracy200: 0.3837 - val_loss: 3.3482 - val_accuracy200: 0.3510 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2675 - accuracy200: 0.3828 - val_loss: 3.3646 - val_accuracy200: 0.3476 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2593 - accuracy200: 0.3930 - val_loss: 3.3876 - val_accuracy200: 0.3640 - 6s/epoch - 17ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2559 - accuracy200: 0.3924 - val_loss: 3.3831 - val_accuracy200: 0.3636 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 13s - loss: 3.2508 - accuracy200: 0.4001 - val_loss: 3.3303 - val_accuracy200: 0.3636 - 13s/epoch - 38ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2344 - accuracy200: 0.4092 - val_loss: 3.3409 - val_accuracy200: 0.3550 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2304 - accuracy200: 0.4134 - val_loss: 3.3181 - val_accuracy200: 0.3612 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2222 - accuracy200: 0.4160 - val_loss: 3.3368 - val_accuracy200: 0.3588 - 6s/epoch - 18ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2157 - accuracy200: 0.4172 - val_loss: 3.3301 - val_accuracy200: 0.3650 - 6s/epoch - 17ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2136 - accuracy200: 0.4184 - val_loss: 3.3237 - val_accuracy200: 0.3681 - 6s/epoch - 17ms/step
Epoch 15/50
346/346 - 6s - loss: 3.2136 - accuracy200: 0.4211 - val_loss: 3.3309 - val_accuracy200: 0.3586 - 6s/epoch - 18ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2063 - accuracy200: 0.4231 - val_loss: 3.3346 - val_accuracy200: 0.3696 - 6s/epoch - 17ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2052 - accuracy200: 0.4240 - val_loss: 3.3319 - val_accuracy200: 0.3644 - 6s/epoch - 17ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1973 - accuracy200: 0.4257 - val_loss: 3.3298 - val_accuracy200: 0.3662 - 6s/epoch - 17ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1897 - accuracy200: 0.4309 - val_loss: 3.3650 - val_accuracy200: 0.3581 - 6s/epoch - 17ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1893 - accuracy200: 0.4312 - val_loss: 3.3872 - val_accuracy200: 0.3613 - 6s/epoch - 17ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1838 - accuracy200: 0.4344 - val_loss: 3.3784 - val_accuracy200: 0.3589 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h200
Evaluating performance on  test set...
925/925 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1300185
{'0': {'precision': 0.32815445003544813, 'recall': 0.5094152227307501, 'f1-score': 0.39917126345513726, 'support': 74507}, '1': {'precision': 0.3291891891891892, 'recall': 0.020670928324942016, 'f1-score': 0.038899238835364884, 'support': 88385}, '2': {'precision': 0.34210526315789475, 'recall': 0.5353106961870951, 'f1-score': 0.4174362333847551, 'support': 73802}, 'accuracy': 0.33498525522404454, 'macro avg': {'precision': 0.3331496341275107, 'recall': 0.3551322824142624, 'f1-score': 0.2851689118917524, 'support': 236694}, 'weighted avg': {'precision': 0.3328907480834181, 'recall': 0.33498525522404454, 'f1-score': 0.2703355025770714, 'support': 236694}}
[[37955  1815 34737]
 [45320  1827 41238]
 [32387  1908 39507]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1355959
{'0': {'precision': 0.3591639746234383, 'recall': 0.30821643286573147, 'f1-score': 0.3317455467078892, 'support': 29940}, '1': {'precision': 0.29616052479259114, 'recall': 0.10466741672633051, 'f1-score': 0.15467163765523842, 'support': 29331}, '2': {'precision': 0.3200662718287597, 'recall': 0.57363732550599, 'f1-score': 0.4108788656643442, 'support': 29299}, 'accuracy': 0.3286101388732076, 'macro avg': {'precision': 0.3251302570815964, 'recall': 0.3288403916993507, 'f1-score': 0.2990986833424906, 'support': 88570}, 'weighted avg': {'precision': 0.32536609970902186, 'recall': 0.3286101388732076, 'f1-score': 0.29928277472733006, 'support': 88570}}
[[ 9228  3699 17013]
 [ 7570  3070 18691]
 [ 8895  3597 16807]]
Evaluating performance on  val set...
127/127 - 1s - 979ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1092871
{'0': {'precision': 0.37734223562351926, 'recall': 0.15858073859522084, 'f1-score': 0.22331272704097888, 'support': 11048}, '1': {'precision': 0.3446702162338368, 'recall': 0.32959268495428096, 'f1-score': 0.33696287247038825, 'support': 9624}, '2': {'precision': 0.3618995929443691, 'recall': 0.5748771445814295, 'f1-score': 0.4441779909405809, 'support': 11599}, 'accuracy': 0.3592079576089988, 'macro avg': {'precision': 0.3613040149339084, 'recall': 0.3543501893769771, 'f1-score': 0.3348178634839827, 'support': 32271}, 'weighted avg': {'precision': 0.3620481720047356, 'recall': 0.3592079576089988, 'f1-score': 0.3365904437396904, 'support': 32271}}
[[1752 2772 6524]
 [1219 3172 5233]
 [1672 3259 6668]]
training model: results/CHTR/W4/deepLOB_L1/h300
Epoch 1/50
346/346 - 8s - loss: 3.3394 - accuracy300: 0.3574 - val_loss: 3.3521 - val_accuracy300: 0.3476 - 8s/epoch - 23ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3064 - accuracy300: 0.3678 - val_loss: 3.3526 - val_accuracy300: 0.3511 - 6s/epoch - 17ms/step
Epoch 3/50
346/346 - 6s - loss: 3.3055 - accuracy300: 0.3658 - val_loss: 3.3663 - val_accuracy300: 0.3432 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2909 - accuracy300: 0.3722 - val_loss: 3.3784 - val_accuracy300: 0.3532 - 6s/epoch - 17ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2745 - accuracy300: 0.3825 - val_loss: 3.3168 - val_accuracy300: 0.3645 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2710 - accuracy300: 0.3851 - val_loss: 3.3722 - val_accuracy300: 0.3555 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2580 - accuracy300: 0.3949 - val_loss: 3.3706 - val_accuracy300: 0.3584 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2508 - accuracy300: 0.3977 - val_loss: 3.3743 - val_accuracy300: 0.3567 - 6s/epoch - 17ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2401 - accuracy300: 0.4025 - val_loss: 3.3662 - val_accuracy300: 0.3637 - 6s/epoch - 18ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2295 - accuracy300: 0.4084 - val_loss: 3.3884 - val_accuracy300: 0.3625 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2175 - accuracy300: 0.4146 - val_loss: 3.3766 - val_accuracy300: 0.3620 - 6s/epoch - 18ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2079 - accuracy300: 0.4189 - val_loss: 3.3590 - val_accuracy300: 0.3691 - 6s/epoch - 18ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2011 - accuracy300: 0.4226 - val_loss: 3.4074 - val_accuracy300: 0.3492 - 6s/epoch - 18ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1940 - accuracy300: 0.4278 - val_loss: 3.4330 - val_accuracy300: 0.3546 - 6s/epoch - 18ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1894 - accuracy300: 0.4306 - val_loss: 3.4260 - val_accuracy300: 0.3508 - 6s/epoch - 17ms/step
testing model: results/CHTR/W4/deepLOB_L1/h300
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263741
{'0': {'precision': 0.30786993579393984, 'recall': 0.6824102201323291, 'f1-score': 0.42431142217679857, 'support': 72093}, '1': {'precision': 0.37757044935262757, 'recall': 0.06657192095073969, 'f1-score': 0.1131870849902015, 'support': 89362}, '2': {'precision': 0.36553810925744196, 'recall': 0.2970400988848868, 'f1-score': 0.32774840701280983, 'support': 75239}, 'accuracy': 0.3274058489019578, 'macro avg': {'precision': 0.35032616480133644, 'recall': 0.3486740799893185, 'f1-score': 0.28841563805993664, 'support': 236694}, 'weighted avg': {'precision': 0.35251607382807626, 'recall': 0.3274058489019578, 'f1-score': 0.27615389508446825, 'support': 236694}}
[[49197  4887 18009]
 [62631  5949 20782]
 [47970  4920 22349]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1236862
{'0': {'precision': 0.3521855188521855, 'recall': 0.4236828901154039, 'f1-score': 0.3846399125404273, 'support': 29895}, '1': {'precision': 0.3128068211179054, 'recall': 0.12391675196178778, 'f1-score': 0.17751276850516848, 'support': 29310}, '2': {'precision': 0.32455177460665935, 'recall': 0.453090413757875, 'f1-score': 0.3781978396816373, 'support': 29365}, 'accuracy': 0.3342328102066162, 'macro avg': {'precision': 0.3298480381922501, 'recall': 0.33356335194502224, 'f1-score': 0.3134501735757444, 'support': 88570}, 'weighted avg': {'precision': 0.32999228716694645, 'recall': 0.3342328102066162, 'f1-score': 0.31396058476384603, 'support': 88570}}
[[12666  3976 13253]
 [11241  3632 14437]
 [12057  4003 13305]]
Evaluating performance on  val set...
127/127 - 1s - 807ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042581
{'0': {'precision': 0.37073290101553896, 'recall': 0.27995934583756815, 'f1-score': 0.31901452937460517, 'support': 10823}, '1': {'precision': 0.3600151028884274, 'recall': 0.19030036922462829, 'f1-score': 0.24898811855333597, 'support': 10021}, '2': {'precision': 0.36870379235147066, 'recall': 0.606633412094163, 'f1-score': 0.45864761148603944, 'support': 11427}, 'accuracy': 0.3677915156022435, 'macro avg': {'precision': 0.3664839320851457, 'recall': 0.3589643757187864, 'f1-score': 0.34221675313799355, 'support': 32271}, 'weighted avg': {'precision': 0.3666862436533223, 'recall': 0.3677915156022435, 'f1-score': 0.3467128519071397, 'support': 32271}}
[[3030 1722 6071]
 [2316 1907 5798]
 [2827 1668 6932]]
training model: results/CHTR/W4/deepLOB_L1/h500
Epoch 1/50
346/346 - 8s - loss: 3.3432 - accuracy500: 0.3604 - val_loss: 3.3778 - val_accuracy500: 0.3340 - 8s/epoch - 23ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3119 - accuracy500: 0.3668 - val_loss: 3.3027 - val_accuracy500: 0.3613 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.3064 - accuracy500: 0.3656 - val_loss: 3.3473 - val_accuracy500: 0.3340 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.3004 - accuracy500: 0.3632 - val_loss: 3.3554 - val_accuracy500: 0.3247 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2840 - accuracy500: 0.3729 - val_loss: 3.3529 - val_accuracy500: 0.3443 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2710 - accuracy500: 0.3825 - val_loss: 3.3261 - val_accuracy500: 0.3460 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2568 - accuracy500: 0.3930 - val_loss: 3.3284 - val_accuracy500: 0.3627 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2440 - accuracy500: 0.3977 - val_loss: 3.3453 - val_accuracy500: 0.3594 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2279 - accuracy500: 0.4111 - val_loss: 3.3644 - val_accuracy500: 0.3657 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2128 - accuracy500: 0.4165 - val_loss: 3.3622 - val_accuracy500: 0.3588 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2013 - accuracy500: 0.4242 - val_loss: 3.3845 - val_accuracy500: 0.3635 - 6s/epoch - 17ms/step
Epoch 12/50
346/346 - 6s - loss: 3.1936 - accuracy500: 0.4308 - val_loss: 3.3671 - val_accuracy500: 0.3611 - 6s/epoch - 17ms/step
testing model: results/CHTR/W4/deepLOB_L1/h500
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11692
{'0': {'precision': 0.3084572301918185, 'recall': 0.44728721315154574, 'f1-score': 0.3651207126540754, 'support': 71292}, '1': {'precision': 0.36183028124544614, 'recall': 0.1690879375312117, 'f1-score': 0.23047291966399033, 'support': 88108}, '2': {'precision': 0.3447542353566816, 'recall': 0.4109762724144177, 'f1-score': 0.3749638504441231, 'support': 77294}, 'accuracy': 0.33187153033029987, 'macro avg': {'precision': 0.33834724893131546, 'recall': 0.34245047436572507, 'f1-score': 0.3235191609207296, 'support': 236694}, 'weighted avg': {'precision': 0.3401780744018363, 'recall': 0.33187153033029987, 'f1-score': 0.31821317696484597, 'support': 236694}}
[[31888 11867 27537]
 [40372 14898 32838]
 [31119 14409 31766]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.116985
{'0': {'precision': 0.3504651162790698, 'recall': 0.3033922759453746, 'f1-score': 0.32523424995054223, 'support': 29803}, '1': {'precision': 0.3226891530734495, 'recall': 0.2394924934167778, 'f1-score': 0.2749347309738335, 'support': 29241}, '2': {'precision': 0.3296727378981202, 'recall': 0.45854501117659013, 'f1-score': 0.3835736748165567, 'support': 29526}, 'accuracy': 0.3340182906175906, 'macro avg': {'precision': 0.33427566908354645, 'recall': 0.3338099268462475, 'f1-score': 0.32791421858031083, 'support': 88570}, 'weighted avg': {'precision': 0.33436358411048606, 'recall': 0.3340182906175906, 'f1-score': 0.3280763141279838, 'support': 88570}}
[[ 9042  7280 13481]
 [ 8190  7003 14048]
 [ 8568  7419 13539]]
Evaluating performance on  val set...
127/127 - 1s - 796ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006353
{'0': {'precision': 0.36074794770446944, 'recall': 0.22004821958456974, 'f1-score': 0.2733556041930653, 'support': 10784}, '1': {'precision': 0.3494530300399375, 'recall': 0.409211061407076, 'f1-score': 0.3769785520277231, 'support': 9836}, '2': {'precision': 0.3801058201058201, 'recall': 0.4624495751437645, 'f1-score': 0.417253930147913, 'support': 11651}, 'accuracy': 0.36521954696166836, 'macro avg': {'precision': 0.363435599283409, 'recall': 0.36390295204513673, 'f1-score': 0.35586269545623384, 'support': 32271}, 'weighted avg': {'precision': 0.364294220246374, 'recall': 0.36521954696166836, 'f1-score': 0.3568917422303627, 'support': 32271}}
[[2373 3564 4847]
 [1871 4025 3940]
 [2334 3929 5388]]
training model: results/CHTR/W4/deepLOB_L1/h1000
Epoch 1/50
346/346 - 9s - loss: 3.3345 - accuracy1000: 0.3640 - val_loss: 3.4580 - val_accuracy1000: 0.3314 - 9s/epoch - 25ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2876 - accuracy1000: 0.3811 - val_loss: 3.5431 - val_accuracy1000: 0.3547 - 6s/epoch - 18ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2750 - accuracy1000: 0.3878 - val_loss: 3.5371 - val_accuracy1000: 0.3573 - 6s/epoch - 18ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2496 - accuracy1000: 0.3985 - val_loss: 3.5219 - val_accuracy1000: 0.3396 - 6s/epoch - 18ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2190 - accuracy1000: 0.4159 - val_loss: 3.5679 - val_accuracy1000: 0.3667 - 6s/epoch - 18ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2122 - accuracy1000: 0.4186 - val_loss: 3.5050 - val_accuracy1000: 0.3577 - 6s/epoch - 18ms/step
Epoch 7/50
346/346 - 6s - loss: 3.1814 - accuracy1000: 0.4354 - val_loss: 3.5678 - val_accuracy1000: 0.3618 - 6s/epoch - 18ms/step
Epoch 8/50
346/346 - 6s - loss: 3.1667 - accuracy1000: 0.4432 - val_loss: 3.5396 - val_accuracy1000: 0.3606 - 6s/epoch - 18ms/step
Epoch 9/50
346/346 - 6s - loss: 3.1533 - accuracy1000: 0.4478 - val_loss: 3.5049 - val_accuracy1000: 0.3577 - 6s/epoch - 18ms/step
Epoch 10/50
346/346 - 6s - loss: 3.1394 - accuracy1000: 0.4532 - val_loss: 3.5937 - val_accuracy1000: 0.3699 - 6s/epoch - 18ms/step
Epoch 11/50
346/346 - 6s - loss: 3.1304 - accuracy1000: 0.4539 - val_loss: 3.5959 - val_accuracy1000: 0.3633 - 6s/epoch - 18ms/step
testing model: results/CHTR/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1348021
{'0': {'precision': 0.2840332596568782, 'recall': 0.38355813920434356, 'f1-score': 0.3263770885364069, 'support': 70357}, '1': {'precision': 0.3596533065802674, 'recall': 0.24811373203081566, 'f1-score': 0.2936484490398818, 'support': 88137}, '2': {'precision': 0.3812514682063773, 'recall': 0.3943222506393862, 'f1-score': 0.38767671814987337, 'support': 78200}, 'accuracy': 0.3366794257564619, 'macro avg': {'precision': 0.3416460114811743, 'recall': 0.34199804062484845, 'f1-score': 0.3359007519087207, 'support': 236694}, 'weighted avg': {'precision': 0.34431103595985835, 'recall': 0.3366794257564619, 'f1-score': 0.33444246804103245, 'support': 236694}}
[[26986 19642 23729]
 [39953 21868 26316]
 [28071 19293 30836]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1590657
{'0': {'precision': 0.35364622206611934, 'recall': 0.27277345072807313, 'f1-score': 0.3079893704475501, 'support': 29530}, '1': {'precision': 0.31355224711284263, 'recall': 0.3078551912568306, 'f1-score': 0.31067760391535115, 'support': 29280}, '2': {'precision': 0.33405317856660816, 'recall': 0.4158266129032258, 'f1-score': 0.37048125140333804, 'support': 29760}, 'accuracy': 0.3324376199616123, 'macro avg': {'precision': 0.3337505492485234, 'recall': 0.33215175162937655, 'f1-score': 0.3297160752554131, 'support': 88570}, 'weighted avg': {'precision': 0.333808347377428, 'recall': 0.3324376199616123, 'f1-score': 0.3298756734077112, 'support': 88570}}
[[ 8055  9841 11634]
 [ 7230  9014 13036]
 [ 7492  9893 12375]]
Evaluating performance on  val set...
127/127 - 1s - 858ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1542584
{'0': {'precision': 0.3418275418275418, 'recall': 0.24976490502162874, 'f1-score': 0.2886329058900239, 'support': 10634}, '1': {'precision': 0.30187611191978003, 'recall': 0.38138536984062116, 'f1-score': 0.33700460413469346, 'support': 9788}, '2': {'precision': 0.3392665842604038, 'recall': 0.34745548147523, 'f1-score': 0.3433122081387592, 'support': 11849}, 'accuracy': 0.3255554522636423, 'macro avg': {'precision': 0.3276567460025752, 'recall': 0.32620191877916, 'f1-score': 0.3229832393878255, 'support': 32271}, 'weighted avg': {'precision': 0.3287697071725825, 'recall': 0.3255554522636423, 'f1-score': 0.32338104616346103, 'support': 32271}}
[[2656 3897 4081]
 [2118 3733 3937]
 [2996 4736 4117]]
training model: results/CHTR/W4/deepOF_L1/h10
Epoch 1/50
346/346 - 8s - loss: 3.3127 - accuracy10: 0.3665 - val_loss: 3.2722 - val_accuracy10: 0.3911 - 8s/epoch - 25ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2627 - accuracy10: 0.3944 - val_loss: 3.2493 - val_accuracy10: 0.4078 - 6s/epoch - 17ms/step
Epoch 3/50
346/346 - 5s - loss: 3.2458 - accuracy10: 0.4024 - val_loss: 3.2347 - val_accuracy10: 0.4134 - 5s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2305 - accuracy10: 0.4103 - val_loss: 3.2285 - val_accuracy10: 0.4177 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2198 - accuracy10: 0.4158 - val_loss: 3.2226 - val_accuracy10: 0.4196 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2129 - accuracy10: 0.4180 - val_loss: 3.2160 - val_accuracy10: 0.4239 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2047 - accuracy10: 0.4225 - val_loss: 3.2139 - val_accuracy10: 0.4259 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 5s - loss: 3.1935 - accuracy10: 0.4267 - val_loss: 3.2082 - val_accuracy10: 0.4255 - 5s/epoch - 16ms/step
Epoch 9/50
346/346 - 6s - loss: 3.1906 - accuracy10: 0.4290 - val_loss: 3.2078 - val_accuracy10: 0.4252 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.1849 - accuracy10: 0.4300 - val_loss: 3.2067 - val_accuracy10: 0.4256 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.1783 - accuracy10: 0.4337 - val_loss: 3.2088 - val_accuracy10: 0.4279 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.1746 - accuracy10: 0.4352 - val_loss: 3.2057 - val_accuracy10: 0.4292 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.1676 - accuracy10: 0.4360 - val_loss: 3.2056 - val_accuracy10: 0.4281 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1643 - accuracy10: 0.4384 - val_loss: 3.2062 - val_accuracy10: 0.4285 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1606 - accuracy10: 0.4418 - val_loss: 3.2051 - val_accuracy10: 0.4281 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 5s - loss: 3.1552 - accuracy10: 0.4422 - val_loss: 3.2087 - val_accuracy10: 0.4268 - 5s/epoch - 16ms/step
Epoch 17/50
346/346 - 5s - loss: 3.1495 - accuracy10: 0.4472 - val_loss: 3.2108 - val_accuracy10: 0.4274 - 5s/epoch - 16ms/step
Epoch 18/50
346/346 - 5s - loss: 3.1482 - accuracy10: 0.4464 - val_loss: 3.2130 - val_accuracy10: 0.4271 - 5s/epoch - 16ms/step
Epoch 19/50
346/346 - 5s - loss: 3.1438 - accuracy10: 0.4464 - val_loss: 3.2055 - val_accuracy10: 0.4289 - 5s/epoch - 15ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1379 - accuracy10: 0.4495 - val_loss: 3.2094 - val_accuracy10: 0.4285 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1363 - accuracy10: 0.4509 - val_loss: 3.2073 - val_accuracy10: 0.4272 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1317 - accuracy10: 0.4513 - val_loss: 3.2226 - val_accuracy10: 0.4212 - 6s/epoch - 17ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1263 - accuracy10: 0.4543 - val_loss: 3.2153 - val_accuracy10: 0.4278 - 6s/epoch - 16ms/step
Epoch 24/50
346/346 - 6s - loss: 3.1236 - accuracy10: 0.4547 - val_loss: 3.2239 - val_accuracy10: 0.4275 - 6s/epoch - 16ms/step
Epoch 25/50
346/346 - 6s - loss: 3.1178 - accuracy10: 0.4581 - val_loss: 3.2186 - val_accuracy10: 0.4245 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h10
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0570785
{'0': {'precision': 0.38317887876164775, 'recall': 0.4294069815546584, 'f1-score': 0.4049779691231375, 'support': 70099}, '1': {'precision': 0.5370499052432091, 'recall': 0.48727109463809787, 'f1-score': 0.5109509523547177, 'support': 104683}, '2': {'precision': 0.37562149665896066, 'recall': 0.3831814951217936, 'f1-score': 0.3793638355375734, 'support': 61908}, 'accuracy': 0.4429084456462039, 'macro avg': {'precision': 0.43195009355460584, 'recall': 0.4332865237715166, 'f1-score': 0.4317642523384762, 'support': 236690}, 'weighted avg': {'precision': 0.44925610320693965, 'recall': 0.4429084456462039, 'f1-score': 0.44514802287114724, 'support': 236690}}
[[30101 24344 15654]
 [29896 51009 23778]
 [18559 19627 23722]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.059613
{'0': {'precision': 0.4281562802712302, 'recall': 0.4021838034576888, 'f1-score': 0.4147638411010322, 'support': 29673}, '1': {'precision': 0.43545389021660785, 'recall': 0.39496954891098646, 'f1-score': 0.41422488452655887, 'support': 29063}, '2': {'precision': 0.4418523372651813, 'recall': 0.5085308215734254, 'f1-score': 0.4728525121555916, 'support': 29833}, 'accuracy': 0.4356377513576985, 'macro avg': {'precision': 0.4351541692510064, 'recall': 0.4352280579807002, 'f1-score': 0.4339470792610609, 'support': 88569}, 'weighted avg': {'precision': 0.4351642052353041, 'recall': 0.4356377513576985, 'f1-score': 0.43415319435834293, 'support': 88569}}
[[11934  8068  9671]
 [ 8091 11479  9493]
 [ 7848  6814 15171]]
Evaluating performance on  val set...
127/127 - 1s - 948ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0679741
{'0': {'precision': 0.4361135328877264, 'recall': 0.4129138769146107, 'f1-score': 0.424196739847357, 'support': 10903}, '1': {'precision': 0.4411890504704876, 'recall': 0.37464814310360484, 'f1-score': 0.4052050085931746, 'support': 11013}, '2': {'precision': 0.41579992060341403, 'recall': 0.5057948618891249, 'f1-score': 0.45640332912109455, 'support': 10354}, 'accuracy': 0.42965602726991015, 'macro avg': {'precision': 0.43103416798720934, 'recall': 0.43111896063578015, 'f1-score': 0.42860169252054203, 'support': 32270}, 'weighted avg': {'precision': 0.43132795908999416, 'recall': 0.42965602726991015, 'f1-score': 0.42804895828671147, 'support': 32270}}
[[4502 2853 3548]
 [3077 4126 3810]
 [2744 2373 5237]]
training model: results/CHTR/W4/deepOF_L1/h20
Epoch 1/50
346/346 - 7s - loss: 3.3141 - accuracy20: 0.3646 - val_loss: 3.2718 - val_accuracy20: 0.3799 - 7s/epoch - 21ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2650 - accuracy20: 0.3930 - val_loss: 3.2459 - val_accuracy20: 0.4054 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2468 - accuracy20: 0.4023 - val_loss: 3.2284 - val_accuracy20: 0.4153 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2332 - accuracy20: 0.4113 - val_loss: 3.2236 - val_accuracy20: 0.4206 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2190 - accuracy20: 0.4199 - val_loss: 3.2180 - val_accuracy20: 0.4239 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2091 - accuracy20: 0.4240 - val_loss: 3.2138 - val_accuracy20: 0.4276 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2035 - accuracy20: 0.4273 - val_loss: 3.2110 - val_accuracy20: 0.4286 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 6s - loss: 3.1942 - accuracy20: 0.4300 - val_loss: 3.2052 - val_accuracy20: 0.4307 - 6s/epoch - 16ms/step
Epoch 9/50
346/346 - 6s - loss: 3.1883 - accuracy20: 0.4336 - val_loss: 3.2051 - val_accuracy20: 0.4322 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.1828 - accuracy20: 0.4352 - val_loss: 3.2066 - val_accuracy20: 0.4322 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.1786 - accuracy20: 0.4363 - val_loss: 3.2072 - val_accuracy20: 0.4289 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.1717 - accuracy20: 0.4405 - val_loss: 3.2020 - val_accuracy20: 0.4306 - 6s/epoch - 17ms/step
Epoch 13/50
346/346 - 5s - loss: 3.1685 - accuracy20: 0.4406 - val_loss: 3.2032 - val_accuracy20: 0.4338 - 5s/epoch - 16ms/step
Epoch 14/50
346/346 - 5s - loss: 3.1653 - accuracy20: 0.4423 - val_loss: 3.2033 - val_accuracy20: 0.4323 - 5s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1600 - accuracy20: 0.4450 - val_loss: 3.2048 - val_accuracy20: 0.4291 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 5s - loss: 3.1538 - accuracy20: 0.4451 - val_loss: 3.2050 - val_accuracy20: 0.4319 - 5s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1516 - accuracy20: 0.4474 - val_loss: 3.1997 - val_accuracy20: 0.4344 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1489 - accuracy20: 0.4475 - val_loss: 3.2052 - val_accuracy20: 0.4333 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 5s - loss: 3.1440 - accuracy20: 0.4512 - val_loss: 3.2121 - val_accuracy20: 0.4336 - 5s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1410 - accuracy20: 0.4510 - val_loss: 3.2030 - val_accuracy20: 0.4386 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1363 - accuracy20: 0.4549 - val_loss: 3.2024 - val_accuracy20: 0.4375 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1338 - accuracy20: 0.4551 - val_loss: 3.2089 - val_accuracy20: 0.4319 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1288 - accuracy20: 0.4573 - val_loss: 3.2089 - val_accuracy20: 0.4343 - 6s/epoch - 16ms/step
Epoch 24/50
346/346 - 6s - loss: 3.1276 - accuracy20: 0.4568 - val_loss: 3.2140 - val_accuracy20: 0.4329 - 6s/epoch - 16ms/step
Epoch 25/50
346/346 - 6s - loss: 3.1233 - accuracy20: 0.4590 - val_loss: 3.2157 - val_accuracy20: 0.4335 - 6s/epoch - 16ms/step
Epoch 26/50
346/346 - 6s - loss: 3.1190 - accuracy20: 0.4599 - val_loss: 3.2256 - val_accuracy20: 0.4280 - 6s/epoch - 16ms/step
Epoch 27/50
346/346 - 6s - loss: 3.1161 - accuracy20: 0.4620 - val_loss: 3.2257 - val_accuracy20: 0.4289 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h20
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079127
{'0': {'precision': 0.3859751572441817, 'recall': 0.44573387470671705, 'f1-score': 0.41370766883565663, 'support': 71177}, '1': {'precision': 0.5121895702802104, 'recall': 0.41836525006605146, 'f1-score': 0.46054743464069886, 'support': 102193}, '2': {'precision': 0.36292593635595605, 'recall': 0.40705938092229943, 'f1-score': 0.3837278546970374, 'support': 63320}, 'accuracy': 0.423570915543538, 'macro avg': {'precision': 0.4203635546267827, 'recall': 0.42371950189835594, 'f1-score': 0.41932765272446426, 'support': 236690}, 'weighted avg': {'precision': 0.4343031510113389, 'recall': 0.423570915543538, 'f1-score': 0.4259108643895766, 'support': 236690}}
[[31726 22915 16536]
 [30730 42754 28709]
 [19741 17804 25775]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603822
{'0': {'precision': 0.4242880064179703, 'recall': 0.42616841257050764, 'f1-score': 0.4252261306532663, 'support': 29784}, '1': {'precision': 0.4546488235808624, 'recall': 0.35487284519542583, 'f1-score': 0.398611989800809, 'support': 29295}, '2': {'precision': 0.4354653924609495, 'recall': 0.5284503221430994, 'f1-score': 0.47747292308163675, 'support': 29490}, 'accuracy': 0.43664261762016054, 'macro avg': {'precision': 0.4381340741532607, 'recall': 0.4364971933030109, 'f1-score': 0.4337703478452373, 'support': 88569}, 'weighted avg': {'precision': 0.4380517527986947, 'recall': 0.43664261762016054, 'f1-score': 0.4338193929960714, 'support': 88569}}
[[12693  6928 10163]
 [ 8859 10396 10040]
 [ 8364  5542 15584]]
Evaluating performance on  val set...
127/127 - 1s - 933ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0657642
{'0': {'precision': 0.4417728852838934, 'recall': 0.42049632352941174, 'f1-score': 0.43087210397438314, 'support': 10880}, '1': {'precision': 0.4581251487033072, 'recall': 0.3497411679229861, 'f1-score': 0.3966627182365968, 'support': 11011}, '2': {'precision': 0.4185667752442997, 'recall': 0.544753829848733, 'f1-score': 0.4733955708125758, 'support': 10379}, 'accuracy': 0.43631856213201115, 'macro avg': {'precision': 0.4394882697438334, 'recall': 0.4383304404337103, 'f1-score': 0.4336434643411853, 'support': 32270}, 'weighted avg': {'precision': 0.4398887376672284, 'recall': 0.43631856213201115, 'f1-score': 0.432876179461053, 'support': 32270}}
[[4575 2601 3704]
 [3010 3851 4150]
 [2771 1954 5654]]
training model: results/CHTR/W4/deepOF_L1/h30
Epoch 1/50
346/346 - 8s - loss: 3.3136 - accuracy30: 0.3667 - val_loss: 3.2681 - val_accuracy30: 0.3891 - 8s/epoch - 22ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2628 - accuracy30: 0.3960 - val_loss: 3.2420 - val_accuracy30: 0.4046 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2494 - accuracy30: 0.4011 - val_loss: 3.2301 - val_accuracy30: 0.4109 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2349 - accuracy30: 0.4089 - val_loss: 3.2155 - val_accuracy30: 0.4255 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2216 - accuracy30: 0.4167 - val_loss: 3.2163 - val_accuracy30: 0.4208 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2133 - accuracy30: 0.4217 - val_loss: 3.2091 - val_accuracy30: 0.4278 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2057 - accuracy30: 0.4249 - val_loss: 3.2049 - val_accuracy30: 0.4271 - 6s/epoch - 17ms/step
Epoch 8/50
346/346 - 5s - loss: 3.1984 - accuracy30: 0.4286 - val_loss: 3.2035 - val_accuracy30: 0.4315 - 5s/epoch - 16ms/step
Epoch 9/50
346/346 - 5s - loss: 3.1917 - accuracy30: 0.4301 - val_loss: 3.2000 - val_accuracy30: 0.4354 - 5s/epoch - 16ms/step
Epoch 10/50
346/346 - 6s - loss: 3.1864 - accuracy30: 0.4344 - val_loss: 3.1983 - val_accuracy30: 0.4341 - 6s/epoch - 16ms/step
Epoch 11/50
346/346 - 6s - loss: 3.1808 - accuracy30: 0.4364 - val_loss: 3.2036 - val_accuracy30: 0.4314 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.1768 - accuracy30: 0.4388 - val_loss: 3.1968 - val_accuracy30: 0.4360 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.1708 - accuracy30: 0.4401 - val_loss: 3.1998 - val_accuracy30: 0.4366 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1645 - accuracy30: 0.4431 - val_loss: 3.2090 - val_accuracy30: 0.4282 - 6s/epoch - 17ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1611 - accuracy30: 0.4459 - val_loss: 3.2032 - val_accuracy30: 0.4334 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.1558 - accuracy30: 0.4476 - val_loss: 3.2061 - val_accuracy30: 0.4272 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 5s - loss: 3.1530 - accuracy30: 0.4494 - val_loss: 3.2043 - val_accuracy30: 0.4272 - 5s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1500 - accuracy30: 0.4500 - val_loss: 3.2139 - val_accuracy30: 0.4218 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1467 - accuracy30: 0.4514 - val_loss: 3.2165 - val_accuracy30: 0.4224 - 6s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1410 - accuracy30: 0.4524 - val_loss: 3.2094 - val_accuracy30: 0.4302 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1374 - accuracy30: 0.4546 - val_loss: 3.2115 - val_accuracy30: 0.4297 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1351 - accuracy30: 0.4551 - val_loss: 3.2155 - val_accuracy30: 0.4216 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h30
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.079193
{'0': {'precision': 0.3912367405978785, 'recall': 0.4538551891937243, 'f1-score': 0.42022605745950775, 'support': 71514}, '1': {'precision': 0.5036941972317509, 'recall': 0.41850198313834136, 'f1-score': 0.4571630742434139, 'support': 100346}, '2': {'precision': 0.3661379271135369, 'recall': 0.3973469072960049, 'f1-score': 0.38110455224653444, 'support': 64830}, 'accuracy': 0.4233892433140395, 'macro avg': {'precision': 0.42035628831438876, 'recall': 0.42323469320935686, 'f1-score': 0.4194978946498187, 'support': 236690}, 'weighted avg': {'precision': 0.43203905529301856, 'recall': 0.4233892433140395, 'f1-score': 0.42517022368216517, 'support': 236690}}
[[32457 22500 16557]
 [30312 41995 28039]
 [20191 18879 25760]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063999
{'0': {'precision': 0.4289137098763257, 'recall': 0.4056314561812729, 'f1-score': 0.41694781730061137, 'support': 30010}, '1': {'precision': 0.4446461728904477, 'recall': 0.36734276461564686, 'f1-score': 0.40231472839275717, 'support': 29335}, '2': {'precision': 0.4253608878257725, 'recall': 0.5233027648508075, 'f1-score': 0.46927597158506834, 'support': 29224}, 'accuracy': 0.4317763551581253, 'macro avg': {'precision': 0.43297359019751536, 'recall': 0.4320923285492424, 'f1-score': 0.4295128390928123, 'support': 88569}, 'weighted avg': {'precision': 0.43295218982883626, 'recall': 0.4317763551581253, 'f1-score': 0.4293672452911845, 'support': 88569}}
[[12173  7391 10446]
 [ 8345 10776 10214]
 [ 7863  6068 15293]]
Evaluating performance on  val set...
127/127 - 1s - 893ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664302
{'0': {'precision': 0.44530464508345063, 'recall': 0.40395840933965704, 'f1-score': 0.4236250597800095, 'support': 10964}, '1': {'precision': 0.43806811959259667, 'recall': 0.3704389701796629, 'f1-score': 0.4014250589593056, 'support': 10798}, '2': {'precision': 0.4237853407109831, 'recall': 0.5320708031975637, 'f1-score': 0.47179443905320445, 'support': 10508}, 'accuracy': 0.4344592500774713, 'macro avg': {'precision': 0.4357193684623435, 'recall': 0.4354893942389612, 'f1-score': 0.4322815192641732, 'support': 32270}, 'weighted avg': {'precision': 0.4358759232800378, 'recall': 0.4344592500774713, 'f1-score': 0.4318818998339535, 'support': 32270}}
[[4429 2825 3710]
 [2906 4000 3892]
 [2611 2306 5591]]
training model: results/CHTR/W4/deepOF_L1/h50
Epoch 1/50
346/346 - 7s - loss: 3.3186 - accuracy50: 0.3637 - val_loss: 3.2799 - val_accuracy50: 0.3741 - 7s/epoch - 21ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2738 - accuracy50: 0.3883 - val_loss: 3.2599 - val_accuracy50: 0.3908 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2567 - accuracy50: 0.3982 - val_loss: 3.2434 - val_accuracy50: 0.4041 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2436 - accuracy50: 0.4047 - val_loss: 3.2276 - val_accuracy50: 0.4186 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2306 - accuracy50: 0.4119 - val_loss: 3.2273 - val_accuracy50: 0.4229 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2227 - accuracy50: 0.4194 - val_loss: 3.2254 - val_accuracy50: 0.4238 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2124 - accuracy50: 0.4241 - val_loss: 3.2183 - val_accuracy50: 0.4263 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 5s - loss: 3.2077 - accuracy50: 0.4268 - val_loss: 3.2154 - val_accuracy50: 0.4232 - 5s/epoch - 16ms/step
Epoch 9/50
346/346 - 5s - loss: 3.2000 - accuracy50: 0.4305 - val_loss: 3.2158 - val_accuracy50: 0.4263 - 5s/epoch - 16ms/step
Epoch 10/50
346/346 - 5s - loss: 3.1968 - accuracy50: 0.4311 - val_loss: 3.2145 - val_accuracy50: 0.4254 - 5s/epoch - 16ms/step
Epoch 11/50
346/346 - 5s - loss: 3.1921 - accuracy50: 0.4351 - val_loss: 3.2138 - val_accuracy50: 0.4241 - 5s/epoch - 16ms/step
Epoch 12/50
346/346 - 5s - loss: 3.1882 - accuracy50: 0.4370 - val_loss: 3.2105 - val_accuracy50: 0.4293 - 5s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.1833 - accuracy50: 0.4360 - val_loss: 3.2060 - val_accuracy50: 0.4320 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.1789 - accuracy50: 0.4374 - val_loss: 3.2146 - val_accuracy50: 0.4260 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 5s - loss: 3.1744 - accuracy50: 0.4404 - val_loss: 3.2088 - val_accuracy50: 0.4314 - 5s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.1720 - accuracy50: 0.4416 - val_loss: 3.2089 - val_accuracy50: 0.4283 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1684 - accuracy50: 0.4431 - val_loss: 3.2064 - val_accuracy50: 0.4289 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.1652 - accuracy50: 0.4434 - val_loss: 3.2138 - val_accuracy50: 0.4317 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 6s - loss: 3.1597 - accuracy50: 0.4459 - val_loss: 3.2125 - val_accuracy50: 0.4305 - 6s/epoch - 16ms/step
Epoch 20/50
346/346 - 5s - loss: 3.1569 - accuracy50: 0.4480 - val_loss: 3.2144 - val_accuracy50: 0.4287 - 5s/epoch - 15ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1522 - accuracy50: 0.4477 - val_loss: 3.2195 - val_accuracy50: 0.4229 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1498 - accuracy50: 0.4508 - val_loss: 3.2145 - val_accuracy50: 0.4284 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1446 - accuracy50: 0.4523 - val_loss: 3.2212 - val_accuracy50: 0.4271 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h50
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.089135
{'0': {'precision': 0.3867883195688843, 'recall': 0.48086114628865556, 'f1-score': 0.428724921844174, 'support': 73437}, '1': {'precision': 0.450344105326152, 'recall': 0.31703617884038127, 'f1-score': 0.3721111351484996, 'support': 94945}, '2': {'precision': 0.35538242183521745, 'recall': 0.40867833928675995, 'f1-score': 0.3801715919923737, 'support': 68308}, 'accuracy': 0.39431323672313995, 'macro avg': {'precision': 0.3975049489100846, 'recall': 0.4021918881385989, 'f1-score': 0.39366921632834906, 'support': 236690}, 'weighted avg': {'precision': 0.403219220816645, 'recall': 0.39431323672313995, 'f1-score': 0.3920027247368286, 'support': 236690}}
[[35313 19722 18402]
 [32610 30101 32234]
 [23375 17017 27916]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.068203
{'0': {'precision': 0.42087636059168293, 'recall': 0.44749249892841836, 'f1-score': 0.4337765277422653, 'support': 30329}, '1': {'precision': 0.44785825361670045, 'recall': 0.327961627385348, 'f1-score': 0.37864541832669324, 'support': 28979}, '2': {'precision': 0.4221817042249509, 'recall': 0.5064420218037661, 'f1-score': 0.46048910848015917, 'support': 29261}, 'accuracy': 0.4278585057977396, 'macro avg': {'precision': 0.4303054394777781, 'recall': 0.4272987160391775, 'f1-score': 0.42430368484970593, 'support': 88569}, 'weighted avg': {'precision': 0.43013585249093694, 'recall': 0.4278585057977396, 'f1-score': 0.4245632861477757, 'support': 88569}}
[[13572  6341 10416]
 [ 9609  9504  9866]
 [ 9066  5376 14819]]
Evaluating performance on  val set...
127/127 - 1s - 871ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0684083
{'0': {'precision': 0.43392763502884113, 'recall': 0.45177434030937214, 'f1-score': 0.44267118402282457, 'support': 10990}, '1': {'precision': 0.43901128425577646, 'recall': 0.31079410366143606, 'f1-score': 0.36394008575087705, 'support': 10515}, '2': {'precision': 0.4245367603108189, 'recall': 0.5278216442173711, 'f1-score': 0.4705784918630171, 'support': 10765}, 'accuracy': 0.43120545398202664, 'macro avg': {'precision': 0.43249189319847875, 'recall': 0.43013002939605977, 'f1-score': 0.4257299205455729, 'support': 32270}, 'weighted avg': {'precision': 0.43245139720057074, 'recall': 0.43120545398202664, 'f1-score': 0.4263267362561727, 'support': 32270}}
[[4965 2250 3775]
 [3320 3268 3927]
 [3157 1926 5682]]
training model: results/CHTR/W4/deepOF_L1/h100
Epoch 1/50
346/346 - 8s - loss: 3.3253 - accuracy100: 0.3628 - val_loss: 3.3195 - val_accuracy100: 0.3485 - 8s/epoch - 22ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2834 - accuracy100: 0.3817 - val_loss: 3.3006 - val_accuracy100: 0.3587 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2648 - accuracy100: 0.3920 - val_loss: 3.2773 - val_accuracy100: 0.3750 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 5s - loss: 3.2544 - accuracy100: 0.3967 - val_loss: 3.2797 - val_accuracy100: 0.3738 - 5s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2461 - accuracy100: 0.4017 - val_loss: 3.2684 - val_accuracy100: 0.3874 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2383 - accuracy100: 0.4082 - val_loss: 3.2665 - val_accuracy100: 0.3905 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2326 - accuracy100: 0.4119 - val_loss: 3.2530 - val_accuracy100: 0.4028 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2258 - accuracy100: 0.4157 - val_loss: 3.2509 - val_accuracy100: 0.4033 - 6s/epoch - 17ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2200 - accuracy100: 0.4185 - val_loss: 3.2452 - val_accuracy100: 0.4086 - 6s/epoch - 16ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2151 - accuracy100: 0.4200 - val_loss: 3.2443 - val_accuracy100: 0.4090 - 6s/epoch - 16ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2115 - accuracy100: 0.4227 - val_loss: 3.2435 - val_accuracy100: 0.4108 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2081 - accuracy100: 0.4231 - val_loss: 3.2463 - val_accuracy100: 0.4095 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2035 - accuracy100: 0.4248 - val_loss: 3.2424 - val_accuracy100: 0.4127 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2006 - accuracy100: 0.4283 - val_loss: 3.2436 - val_accuracy100: 0.4134 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.1985 - accuracy100: 0.4288 - val_loss: 3.2415 - val_accuracy100: 0.4120 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 5s - loss: 3.1945 - accuracy100: 0.4309 - val_loss: 3.2449 - val_accuracy100: 0.4090 - 5s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.1908 - accuracy100: 0.4315 - val_loss: 3.2390 - val_accuracy100: 0.4129 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 5s - loss: 3.1900 - accuracy100: 0.4336 - val_loss: 3.2451 - val_accuracy100: 0.4113 - 5s/epoch - 16ms/step
Epoch 19/50
346/346 - 5s - loss: 3.1865 - accuracy100: 0.4346 - val_loss: 3.2408 - val_accuracy100: 0.4140 - 5s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.1819 - accuracy100: 0.4362 - val_loss: 3.2395 - val_accuracy100: 0.4125 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.1789 - accuracy100: 0.4376 - val_loss: 3.2406 - val_accuracy100: 0.4133 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.1767 - accuracy100: 0.4382 - val_loss: 3.2410 - val_accuracy100: 0.4143 - 6s/epoch - 17ms/step
Epoch 23/50
346/346 - 6s - loss: 3.1724 - accuracy100: 0.4398 - val_loss: 3.2418 - val_accuracy100: 0.4120 - 6s/epoch - 17ms/step
Epoch 24/50
346/346 - 6s - loss: 3.1697 - accuracy100: 0.4411 - val_loss: 3.2383 - val_accuracy100: 0.4145 - 6s/epoch - 17ms/step
Epoch 25/50
346/346 - 6s - loss: 3.1682 - accuracy100: 0.4423 - val_loss: 3.2460 - val_accuracy100: 0.4132 - 6s/epoch - 17ms/step
Epoch 26/50
346/346 - 6s - loss: 3.1630 - accuracy100: 0.4460 - val_loss: 3.2408 - val_accuracy100: 0.4156 - 6s/epoch - 17ms/step
Epoch 27/50
346/346 - 6s - loss: 3.1608 - accuracy100: 0.4448 - val_loss: 3.2451 - val_accuracy100: 0.4136 - 6s/epoch - 16ms/step
Epoch 28/50
346/346 - 6s - loss: 3.1555 - accuracy100: 0.4483 - val_loss: 3.2424 - val_accuracy100: 0.4163 - 6s/epoch - 16ms/step
Epoch 29/50
346/346 - 6s - loss: 3.1535 - accuracy100: 0.4484 - val_loss: 3.2433 - val_accuracy100: 0.4147 - 6s/epoch - 16ms/step
Epoch 30/50
346/346 - 6s - loss: 3.1512 - accuracy100: 0.4501 - val_loss: 3.2466 - val_accuracy100: 0.4142 - 6s/epoch - 16ms/step
Epoch 31/50
346/346 - 6s - loss: 3.1433 - accuracy100: 0.4527 - val_loss: 3.2459 - val_accuracy100: 0.4141 - 6s/epoch - 16ms/step
Epoch 32/50
346/346 - 5s - loss: 3.1415 - accuracy100: 0.4543 - val_loss: 3.2572 - val_accuracy100: 0.4088 - 5s/epoch - 16ms/step
Epoch 33/50
346/346 - 6s - loss: 3.1385 - accuracy100: 0.4562 - val_loss: 3.2554 - val_accuracy100: 0.4088 - 6s/epoch - 16ms/step
Epoch 34/50
346/346 - 6s - loss: 3.1353 - accuracy100: 0.4560 - val_loss: 3.2577 - val_accuracy100: 0.4080 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h100
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1071224
{'0': {'precision': 0.3775378242264302, 'recall': 0.4840201113402618, 'f1-score': 0.4241987501329017, 'support': 74187}, '1': {'precision': 0.35949678978416927, 'recall': 0.16395461912479742, 'f1-score': 0.2252020273228504, 'support': 92550}, '2': {'precision': 0.32372949582368926, 'recall': 0.45986590996812143, 'f1-score': 0.3799720061657306, 'support': 69953}, 'accuracy': 0.3517301111158055, 'macro avg': {'precision': 0.3535880366114295, 'recall': 0.3692802134777269, 'f1-score': 0.34312426120716094, 'support': 236690}, 'weighted avg': {'precision': 0.35458057324671755, 'recall': 0.3517301111158055, 'f1-score': 0.3333164140950219, 'support': 236690}}
[[35908 14366 23913]
 [34088 15174 43288]
 [25115 12669 32169]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0750542
{'0': {'precision': 0.4128525770316815, 'recall': 0.4398928783971434, 'f1-score': 0.4259440078113744, 'support': 30246}, '1': {'precision': 0.4449138771530712, 'recall': 0.2812628407067525, 'f1-score': 0.34464817689757893, 'support': 29204}, '2': {'precision': 0.4045142555438226, 'recall': 0.5262199938184691, 'f1-score': 0.4574098120867476, 'support': 29119}, 'accuracy': 0.4159694701306326, 'macro avg': {'precision': 0.42076023657619177, 'recall': 0.415791904307455, 'f1-score': 0.4093339989319003, 'support': 88569}, 'weighted avg': {'precision': 0.4206827955657069, 'recall': 0.4159694701306326, 'f1-score': 0.4094832744700034, 'support': 88569}}
[[13305  5514 11427]
 [ 9860  8214 11130]
 [ 9062  4734 15323]]
Evaluating performance on  val set...
127/127 - 1s - 934ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0796783
{'0': {'precision': 0.41595092024539876, 'recall': 0.43047619047619046, 'f1-score': 0.4230889235569423, 'support': 11025}, '1': {'precision': 0.4004162664105027, 'recall': 0.24850953895071543, 'f1-score': 0.3066830165542612, 'support': 10064}, '2': {'precision': 0.4221978924319146, 'recall': 0.5518289956175655, 'f1-score': 0.4783872843574336, 'support': 11181}, 'accuracy': 0.41577316392934616, 'macro avg': {'precision': 0.41285502636260535, 'recall': 0.4102715750148238, 'f1-score': 0.40271974148954576, 'support': 32270}, 'weighted avg': {'precision': 0.41327061779182084, 'recall': 0.41577316392934616, 'f1-score': 0.40594550626643444, 'support': 32270}}
[[4746 2008 4271]
 [3390 2501 4173]
 [3274 1737 6170]]
training model: results/CHTR/W4/deepOF_L1/h200
Epoch 1/50
346/346 - 8s - loss: 3.3342 - accuracy200: 0.3546 - val_loss: 3.3439 - val_accuracy200: 0.3339 - 8s/epoch - 22ms/step
Epoch 2/50
346/346 - 6s - loss: 3.2971 - accuracy200: 0.3721 - val_loss: 3.3182 - val_accuracy200: 0.3490 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2839 - accuracy200: 0.3783 - val_loss: 3.3127 - val_accuracy200: 0.3445 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2739 - accuracy200: 0.3851 - val_loss: 3.3064 - val_accuracy200: 0.3462 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2666 - accuracy200: 0.3866 - val_loss: 3.3014 - val_accuracy200: 0.3535 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2593 - accuracy200: 0.3933 - val_loss: 3.2947 - val_accuracy200: 0.3642 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2526 - accuracy200: 0.3968 - val_loss: 3.2800 - val_accuracy200: 0.3819 - 6s/epoch - 17ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2446 - accuracy200: 0.4017 - val_loss: 3.2746 - val_accuracy200: 0.3826 - 6s/epoch - 16ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2394 - accuracy200: 0.4044 - val_loss: 3.2685 - val_accuracy200: 0.3848 - 6s/epoch - 16ms/step
Epoch 10/50
346/346 - 5s - loss: 3.2362 - accuracy200: 0.4070 - val_loss: 3.2687 - val_accuracy200: 0.3854 - 5s/epoch - 16ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2317 - accuracy200: 0.4091 - val_loss: 3.2710 - val_accuracy200: 0.3845 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2298 - accuracy200: 0.4098 - val_loss: 3.2682 - val_accuracy200: 0.3872 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2255 - accuracy200: 0.4123 - val_loss: 3.2659 - val_accuracy200: 0.3898 - 6s/epoch - 17ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2231 - accuracy200: 0.4145 - val_loss: 3.2675 - val_accuracy200: 0.3905 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.2193 - accuracy200: 0.4140 - val_loss: 3.2703 - val_accuracy200: 0.3873 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2178 - accuracy200: 0.4160 - val_loss: 3.2685 - val_accuracy200: 0.3876 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2140 - accuracy200: 0.4179 - val_loss: 3.2703 - val_accuracy200: 0.3897 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2129 - accuracy200: 0.4181 - val_loss: 3.2691 - val_accuracy200: 0.3913 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 6s - loss: 3.2113 - accuracy200: 0.4198 - val_loss: 3.2691 - val_accuracy200: 0.3875 - 6s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.2083 - accuracy200: 0.4186 - val_loss: 3.2694 - val_accuracy200: 0.3901 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.2053 - accuracy200: 0.4224 - val_loss: 3.2708 - val_accuracy200: 0.3914 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.2035 - accuracy200: 0.4239 - val_loss: 3.2736 - val_accuracy200: 0.3893 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 6s - loss: 3.2034 - accuracy200: 0.4229 - val_loss: 3.2723 - val_accuracy200: 0.3872 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h200
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1087197
{'0': {'precision': 0.33649883810999226, 'recall': 0.5830671355327087, 'f1-score': 0.4267261279137157, 'support': 74506}, '1': {'precision': 0.3570137340063388, 'recall': 0.17205408157492788, 'f1-score': 0.23220338983050848, 'support': 88385}, '2': {'precision': 0.33799523040233864, 'recall': 0.29767341020881044, 'f1-score': 0.31655547069758055, 'support': 73799}, 'accuracy': 0.3406016308251299, 'macro avg': {'precision': 0.3438359341728899, 'recall': 0.3509315424388157, 'f1-score': 0.32516166281393494, 'support': 236690}, 'weighted avg': {'precision': 0.34462609878252365, 'recall': 0.3406016308251299, 'f1-score': 0.3197364936352171, 'support': 236690}}
[[43442 13679 17385]
 [47536 15207 25642]
 [38122 13709 21968]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0875763
{'0': {'precision': 0.3737073657474601, 'recall': 0.5509160203262905, 'f1-score': 0.4453302345692358, 'support': 29912}, '1': {'precision': 0.41852593769427365, 'recall': 0.20644655695253672, 'f1-score': 0.27650253274312053, 'support': 29349}, '2': {'precision': 0.39171889585278036, 'recall': 0.40091442609526406, 'f1-score': 0.3962633211924997, 'support': 29308}, 'accuracy': 0.38713319558762094, 'macro avg': {'precision': 0.3946507330981714, 'recall': 0.38609233445803043, 'f1-score': 0.3726986961682854, 'support': 88569}, 'weighted avg': {'precision': 0.39451896114081164, 'recall': 0.38713319558762094, 'f1-score': 0.3731494792469443, 'support': 88569}}
[[16479  4311  9122]
 [14166  6059  9124]
 [13451  4107 11750]]
Evaluating performance on  val set...
127/127 - 1s - 937ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0892895
{'0': {'precision': 0.3705671568021747, 'recall': 0.5426581018727947, 'f1-score': 0.4403979588090606, 'support': 11053}, '1': {'precision': 0.34822680825485874, 'recall': 0.18096626405664307, 'f1-score': 0.2381637547105173, 'support': 9604}, '2': {'precision': 0.4234201748850627, 'recall': 0.40446051838456903, 'f1-score': 0.4137232449572801, 'support': 11613}, 'accuracy': 0.3852804462348931, 'macro avg': {'precision': 0.3807380466473654, 'recall': 0.3760282947713356, 'f1-score': 0.36409498615895264, 'support': 32270}, 'weighted avg': {'precision': 0.3829385665185725, 'recall': 0.3852804462348931, 'f1-score': 0.370610826856066, 'support': 32270}}
[[5998 1624 3431]
 [4901 1738 2965]
 [5287 1629 4697]]
training model: results/CHTR/W4/deepOF_L1/h300
Epoch 1/50
346/346 - 8s - loss: 3.3425 - accuracy300: 0.3467 - val_loss: 3.3365 - val_accuracy300: 0.3342 - 8s/epoch - 23ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3095 - accuracy300: 0.3612 - val_loss: 3.3174 - val_accuracy300: 0.3398 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.2952 - accuracy300: 0.3673 - val_loss: 3.3119 - val_accuracy300: 0.3433 - 6s/epoch - 17ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2874 - accuracy300: 0.3723 - val_loss: 3.3080 - val_accuracy300: 0.3474 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2781 - accuracy300: 0.3777 - val_loss: 3.3019 - val_accuracy300: 0.3500 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2714 - accuracy300: 0.3820 - val_loss: 3.2983 - val_accuracy300: 0.3563 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2657 - accuracy300: 0.3873 - val_loss: 3.2900 - val_accuracy300: 0.3645 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2595 - accuracy300: 0.3908 - val_loss: 3.2888 - val_accuracy300: 0.3663 - 6s/epoch - 17ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2559 - accuracy300: 0.3929 - val_loss: 3.2854 - val_accuracy300: 0.3700 - 6s/epoch - 16ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2532 - accuracy300: 0.3949 - val_loss: 3.2866 - val_accuracy300: 0.3687 - 6s/epoch - 16ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2488 - accuracy300: 0.3976 - val_loss: 3.2818 - val_accuracy300: 0.3734 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2478 - accuracy300: 0.3973 - val_loss: 3.2844 - val_accuracy300: 0.3719 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2458 - accuracy300: 0.3981 - val_loss: 3.2829 - val_accuracy300: 0.3758 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2444 - accuracy300: 0.3990 - val_loss: 3.2818 - val_accuracy300: 0.3760 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.2394 - accuracy300: 0.4023 - val_loss: 3.2867 - val_accuracy300: 0.3716 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2377 - accuracy300: 0.4014 - val_loss: 3.2811 - val_accuracy300: 0.3768 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2364 - accuracy300: 0.4043 - val_loss: 3.2821 - val_accuracy300: 0.3799 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2356 - accuracy300: 0.4032 - val_loss: 3.2874 - val_accuracy300: 0.3727 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 6s - loss: 3.2319 - accuracy300: 0.4063 - val_loss: 3.2883 - val_accuracy300: 0.3738 - 6s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.2322 - accuracy300: 0.4051 - val_loss: 3.2868 - val_accuracy300: 0.3761 - 6s/epoch - 17ms/step
Epoch 21/50
346/346 - 6s - loss: 3.2271 - accuracy300: 0.4077 - val_loss: 3.2877 - val_accuracy300: 0.3756 - 6s/epoch - 17ms/step
Epoch 22/50
346/346 - 6s - loss: 3.2263 - accuracy300: 0.4107 - val_loss: 3.2887 - val_accuracy300: 0.3738 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 6s - loss: 3.2234 - accuracy300: 0.4113 - val_loss: 3.2919 - val_accuracy300: 0.3745 - 6s/epoch - 16ms/step
Epoch 24/50
346/346 - 6s - loss: 3.2210 - accuracy300: 0.4121 - val_loss: 3.2911 - val_accuracy300: 0.3758 - 6s/epoch - 17ms/step
Epoch 25/50
346/346 - 6s - loss: 3.2197 - accuracy300: 0.4130 - val_loss: 3.2929 - val_accuracy300: 0.3733 - 6s/epoch - 16ms/step
Epoch 26/50
346/346 - 6s - loss: 3.2160 - accuracy300: 0.4144 - val_loss: 3.2905 - val_accuracy300: 0.3749 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h300
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1136447
{'0': {'precision': 0.322870986537459, 'recall': 0.5841702269322532, 'f1-score': 0.41588323589824616, 'support': 72092}, '1': {'precision': 0.3495223485112614, 'recall': 0.1121841498623576, 'f1-score': 0.16985191962319135, 'support': 89362}, '2': {'precision': 0.32772134275253956, 'recall': 0.3378967515551066, 'f1-score': 0.33273127061410396, 'support': 75236}, 'accuracy': 0.3276902277240272, 'macro avg': {'precision': 0.33337155926708667, 'recall': 0.34475037611657244, 'f1-score': 0.30615547537851384, 'support': 236690}, 'weighted avg': {'precision': 0.3344749428047315, 'recall': 0.3276902277240272, 'f1-score': 0.2965631474065939, 'support': 236690}}
[[42114  9037 20941]
 [48128 10025 31209]
 [40194  9620 25422]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0928948
{'0': {'precision': 0.36607629427792915, 'recall': 0.539522120340004, 'f1-score': 0.4361894970374178, 'support': 29882}, '1': {'precision': 0.40897936926292827, 'recall': 0.15360983102918588, 'f1-score': 0.22333614571442753, 'support': 29295}, '2': {'precision': 0.37907892382031855, 'recall': 0.4323965704953729, 'f1-score': 0.4039861406910582, 'support': 29392}, 'accuracy': 0.37632806060811347, 'macro avg': {'precision': 0.38471152912039197, 'recall': 0.37517617395485425, 'f1-score': 0.3545039278143012, 'support': 88569}, 'weighted avg': {'precision': 0.38458185343740314, 'recall': 0.37632806060811347, 'f1-score': 0.3550994996710796, 'support': 88569}}
[[16122  3292 10468]
 [14446  4500 10349]
 [13472  3211 12709]]
Evaluating performance on  val set...
127/127 - 1s - 910ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936577
{'0': {'precision': 0.3550164015596955, 'recall': 0.5285174606099696, 'f1-score': 0.42473158089596447, 'support': 10853}, '1': {'precision': 0.38681626928471247, 'recall': 0.13816250876665664, 'f1-score': 0.2036025394950539, 'support': 9981}, '2': {'precision': 0.39799171182658594, 'recall': 0.4366911507520112, 'f1-score': 0.416444296197465, 'support': 11436}, 'accuracy': 0.37524016114037806, 'macro avg': {'precision': 0.3799414608903313, 'recall': 0.3677903733762125, 'f1-score': 0.34825947219616116, 'support': 32270}, 'weighted avg': {'precision': 0.38008179133272163, 'recall': 0.37524016114037806, 'f1-score': 0.35340024064078845, 'support': 32270}}
[[5736 1082 4035]
 [5083 1379 3519]
 [5338 1104 4994]]
training model: results/CHTR/W4/deepOF_L1/h500
Epoch 1/50
346/346 - 8s - loss: 3.3490 - accuracy500: 0.3443 - val_loss: 3.3471 - val_accuracy500: 0.3280 - 8s/epoch - 22ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3191 - accuracy500: 0.3515 - val_loss: 3.3286 - val_accuracy500: 0.3279 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.3063 - accuracy500: 0.3576 - val_loss: 3.3244 - val_accuracy500: 0.3271 - 6s/epoch - 16ms/step
Epoch 4/50
346/346 - 6s - loss: 3.2975 - accuracy500: 0.3605 - val_loss: 3.3216 - val_accuracy500: 0.3286 - 6s/epoch - 16ms/step
Epoch 5/50
346/346 - 5s - loss: 3.2917 - accuracy500: 0.3642 - val_loss: 3.3171 - val_accuracy500: 0.3315 - 5s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2854 - accuracy500: 0.3681 - val_loss: 3.3191 - val_accuracy500: 0.3304 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2822 - accuracy500: 0.3698 - val_loss: 3.3120 - val_accuracy500: 0.3364 - 6s/epoch - 16ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2775 - accuracy500: 0.3759 - val_loss: 3.3081 - val_accuracy500: 0.3450 - 6s/epoch - 16ms/step
Epoch 9/50
346/346 - 5s - loss: 3.2751 - accuracy500: 0.3782 - val_loss: 3.3088 - val_accuracy500: 0.3414 - 5s/epoch - 15ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2699 - accuracy500: 0.3808 - val_loss: 3.3015 - val_accuracy500: 0.3541 - 6s/epoch - 17ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2671 - accuracy500: 0.3833 - val_loss: 3.3010 - val_accuracy500: 0.3574 - 6s/epoch - 17ms/step
Epoch 12/50
346/346 - 5s - loss: 3.2639 - accuracy500: 0.3856 - val_loss: 3.2993 - val_accuracy500: 0.3606 - 5s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2622 - accuracy500: 0.3859 - val_loss: 3.2965 - val_accuracy500: 0.3611 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 6s - loss: 3.2581 - accuracy500: 0.3879 - val_loss: 3.2986 - val_accuracy500: 0.3620 - 6s/epoch - 16ms/step
Epoch 15/50
346/346 - 5s - loss: 3.2565 - accuracy500: 0.3892 - val_loss: 3.2973 - val_accuracy500: 0.3626 - 5s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2542 - accuracy500: 0.3906 - val_loss: 3.2993 - val_accuracy500: 0.3616 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2509 - accuracy500: 0.3909 - val_loss: 3.2947 - val_accuracy500: 0.3629 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2505 - accuracy500: 0.3929 - val_loss: 3.2978 - val_accuracy500: 0.3622 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 6s - loss: 3.2496 - accuracy500: 0.3936 - val_loss: 3.2981 - val_accuracy500: 0.3622 - 6s/epoch - 16ms/step
Epoch 20/50
346/346 - 5s - loss: 3.2465 - accuracy500: 0.3950 - val_loss: 3.3005 - val_accuracy500: 0.3621 - 5s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.2448 - accuracy500: 0.3948 - val_loss: 3.2990 - val_accuracy500: 0.3597 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.2421 - accuracy500: 0.3977 - val_loss: 3.3006 - val_accuracy500: 0.3607 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 5s - loss: 3.2405 - accuracy500: 0.3967 - val_loss: 3.3014 - val_accuracy500: 0.3657 - 5s/epoch - 16ms/step
Epoch 24/50
346/346 - 6s - loss: 3.2377 - accuracy500: 0.3981 - val_loss: 3.3045 - val_accuracy500: 0.3639 - 6s/epoch - 16ms/step
Epoch 25/50
346/346 - 5s - loss: 3.2359 - accuracy500: 0.3998 - val_loss: 3.3013 - val_accuracy500: 0.3674 - 5s/epoch - 16ms/step
Epoch 26/50
346/346 - 5s - loss: 3.2342 - accuracy500: 0.4017 - val_loss: 3.3071 - val_accuracy500: 0.3607 - 5s/epoch - 16ms/step
Epoch 27/50
346/346 - 6s - loss: 3.2319 - accuracy500: 0.4030 - val_loss: 3.3071 - val_accuracy500: 0.3613 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h500
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1175722
{'0': {'precision': 0.29992599474090287, 'recall': 0.5343732027885708, 'f1-score': 0.3842084827214095, 'support': 71291}, '1': {'precision': 0.3372483536276478, 'recall': 0.20401330200778597, 'f1-score': 0.25423249367070705, 'support': 88107}, '2': {'precision': 0.3423447395029535, 'recall': 0.24968948920975004, 'f1-score': 0.2887666928515318, 'support': 77292}, 'accuracy': 0.31843339389074315, 'macro avg': {'precision': 0.32650636262383476, 'recall': 0.3293586646687023, 'f1-score': 0.30906922308121615, 'support': 236690}, 'weighted avg': {'precision': 0.3276711073125487, 'recall': 0.31843339389074315, 'f1-score': 0.3046585174084988, 'support': 236690}}
[[38096 17054 16141]
 [49199 17975 20933]
 [39723 18270 19299]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946378
{'0': {'precision': 0.36229337001095235, 'recall': 0.4766915781359965, 'f1-score': 0.41169319826338635, 'support': 29839}, '1': {'precision': 0.38559035894239263, 'recall': 0.25422974176313445, 'f1-score': 0.306425313215959, 'support': 29198}, '2': {'precision': 0.3739228798615963, 'recall': 0.38057022890423947, 'f1-score': 0.3772172716440954, 'support': 29532}, 'accuracy': 0.3713037292958033, 'macro avg': {'precision': 0.37393553627164705, 'recall': 0.37049718293445677, 'f1-score': 0.3651119277078136, 'support': 88569}, 'weighted avg': {'precision': 0.3738512307492401, 'recall': 0.3713037292958033, 'f1-score': 0.3654947002275534, 'support': 88569}}
[[14224  5933  9682]
 [12639  7423  9136]
 [12398  5895 11239]]
Evaluating performance on  val set...
127/127 - 1s - 887ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991654
{'0': {'precision': 0.34728115412233174, 'recall': 0.49304911955514363, 'f1-score': 0.40752231031445096, 'support': 10790}, '1': {'precision': 0.3597224412553225, 'recall': 0.23178538766385529, 'f1-score': 0.2819181806945989, 'support': 9841}, '2': {'precision': 0.39330819981149856, 'recall': 0.35853595669731075, 'f1-score': 0.375117982830689, 'support': 11639}, 'accuracy': 0.3648590021691974, 'macro avg': {'precision': 0.36677059839638426, 'recall': 0.36112348797210325, 'f1-score': 0.3548528246132463, 'support': 32270}, 'weighted avg': {'precision': 0.3676760562435581, 'recall': 0.3648590021691974, 'f1-score': 0.3575308567299306, 'support': 32270}}
[[5320 2021 3449]
 [4572 2281 2988]
 [5427 2039 4173]]
training model: results/CHTR/W4/deepOF_L1/h1000
Epoch 1/50
346/346 - 7s - loss: 3.3570 - accuracy1000: 0.3364 - val_loss: 3.3353 - val_accuracy1000: 0.3300 - 7s/epoch - 22ms/step
Epoch 2/50
346/346 - 6s - loss: 3.3241 - accuracy1000: 0.3465 - val_loss: 3.3173 - val_accuracy1000: 0.3389 - 6s/epoch - 16ms/step
Epoch 3/50
346/346 - 6s - loss: 3.3109 - accuracy1000: 0.3512 - val_loss: 3.3140 - val_accuracy1000: 0.3379 - 6s/epoch - 17ms/step
Epoch 4/50
346/346 - 6s - loss: 3.3025 - accuracy1000: 0.3560 - val_loss: 3.3121 - val_accuracy1000: 0.3337 - 6s/epoch - 17ms/step
Epoch 5/50
346/346 - 6s - loss: 3.2961 - accuracy1000: 0.3587 - val_loss: 3.3149 - val_accuracy1000: 0.3351 - 6s/epoch - 16ms/step
Epoch 6/50
346/346 - 6s - loss: 3.2884 - accuracy1000: 0.3622 - val_loss: 3.3102 - val_accuracy1000: 0.3383 - 6s/epoch - 16ms/step
Epoch 7/50
346/346 - 6s - loss: 3.2860 - accuracy1000: 0.3641 - val_loss: 3.3100 - val_accuracy1000: 0.3374 - 6s/epoch - 17ms/step
Epoch 8/50
346/346 - 6s - loss: 3.2826 - accuracy1000: 0.3666 - val_loss: 3.3076 - val_accuracy1000: 0.3396 - 6s/epoch - 17ms/step
Epoch 9/50
346/346 - 6s - loss: 3.2789 - accuracy1000: 0.3696 - val_loss: 3.3071 - val_accuracy1000: 0.3416 - 6s/epoch - 17ms/step
Epoch 10/50
346/346 - 6s - loss: 3.2755 - accuracy1000: 0.3733 - val_loss: 3.3033 - val_accuracy1000: 0.3429 - 6s/epoch - 16ms/step
Epoch 11/50
346/346 - 6s - loss: 3.2703 - accuracy1000: 0.3774 - val_loss: 3.3040 - val_accuracy1000: 0.3469 - 6s/epoch - 16ms/step
Epoch 12/50
346/346 - 6s - loss: 3.2697 - accuracy1000: 0.3766 - val_loss: 3.3030 - val_accuracy1000: 0.3490 - 6s/epoch - 16ms/step
Epoch 13/50
346/346 - 6s - loss: 3.2657 - accuracy1000: 0.3784 - val_loss: 3.3041 - val_accuracy1000: 0.3484 - 6s/epoch - 16ms/step
Epoch 14/50
346/346 - 5s - loss: 3.2640 - accuracy1000: 0.3817 - val_loss: 3.3048 - val_accuracy1000: 0.3466 - 5s/epoch - 16ms/step
Epoch 15/50
346/346 - 6s - loss: 3.2598 - accuracy1000: 0.3828 - val_loss: 3.3023 - val_accuracy1000: 0.3523 - 6s/epoch - 16ms/step
Epoch 16/50
346/346 - 6s - loss: 3.2587 - accuracy1000: 0.3842 - val_loss: 3.3070 - val_accuracy1000: 0.3498 - 6s/epoch - 16ms/step
Epoch 17/50
346/346 - 6s - loss: 3.2546 - accuracy1000: 0.3869 - val_loss: 3.3087 - val_accuracy1000: 0.3458 - 6s/epoch - 16ms/step
Epoch 18/50
346/346 - 6s - loss: 3.2543 - accuracy1000: 0.3875 - val_loss: 3.3052 - val_accuracy1000: 0.3513 - 6s/epoch - 16ms/step
Epoch 19/50
346/346 - 5s - loss: 3.2524 - accuracy1000: 0.3888 - val_loss: 3.3074 - val_accuracy1000: 0.3507 - 5s/epoch - 16ms/step
Epoch 20/50
346/346 - 6s - loss: 3.2499 - accuracy1000: 0.3913 - val_loss: 3.3053 - val_accuracy1000: 0.3506 - 6s/epoch - 16ms/step
Epoch 21/50
346/346 - 6s - loss: 3.2478 - accuracy1000: 0.3915 - val_loss: 3.3069 - val_accuracy1000: 0.3471 - 6s/epoch - 16ms/step
Epoch 22/50
346/346 - 6s - loss: 3.2482 - accuracy1000: 0.3907 - val_loss: 3.3086 - val_accuracy1000: 0.3496 - 6s/epoch - 16ms/step
Epoch 23/50
346/346 - 6s - loss: 3.2460 - accuracy1000: 0.3929 - val_loss: 3.3118 - val_accuracy1000: 0.3460 - 6s/epoch - 16ms/step
Epoch 24/50
346/346 - 6s - loss: 3.2421 - accuracy1000: 0.3959 - val_loss: 3.3094 - val_accuracy1000: 0.3525 - 6s/epoch - 16ms/step
Epoch 25/50
346/346 - 6s - loss: 3.2407 - accuracy1000: 0.3976 - val_loss: 3.3117 - val_accuracy1000: 0.3493 - 6s/epoch - 16ms/step
testing model: results/CHTR/W4/deepOF_L1/h1000
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102105
{'0': {'precision': 0.29651195818894505, 'recall': 0.5934959349593496, 'f1-score': 0.39545411497300875, 'support': 70356}, '1': {'precision': 0.33045255776645016, 'recall': 0.14489941795159808, 'f1-score': 0.20146075214538114, 'support': 88137}, '2': {'precision': 0.34967405931596146, 'recall': 0.2558665933475709, 'f1-score': 0.2955042240207952, 'support': 78197}, 'accuracy': 0.31490557269001646, 'macro avg': {'precision': 0.3255461917571189, 'recall': 0.33142064875283955, 'f1-score': 0.2974730303797284, 'support': 236690}, 'weighted avg': {'precision': 0.32671407676933234, 'recall': 0.31490557269001646, 'f1-score': 0.29019502231033245, 'support': 236690}}
[[41756 12133 16467]
 [54622 12771 20744]
 [44446 13743 20008]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980676
{'0': {'precision': 0.3509154929577465, 'recall': 0.5063852850513194, 'f1-score': 0.41455332011480706, 'support': 29521}, '1': {'precision': 0.3760538381896169, 'recall': 0.1734606856558076, 'f1-score': 0.23741158344421875, 'support': 29315}, '2': {'precision': 0.3659198076863809, 'recall': 0.39932062018632497, 'f1-score': 0.3818912833708588, 'support': 29733}, 'accuracy': 0.3602502004087209, 'macro avg': {'precision': 0.3642963796112481, 'recall': 0.359722196964484, 'f1-score': 0.3446187289766282, 'support': 88569}, 'weighted avg': {'precision': 0.364272919148612, 'recall': 0.3602502004087209, 'f1-score': 0.3449572949930815, 'support': 88569}}
[[14949  4236 10336]
 [13992  5085 10238]
 [13659  4201 11873]]
Evaluating performance on  val set...
127/127 - 1s - 882ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003859
{'0': {'precision': 0.3346480956489585, 'recall': 0.510818438381938, 'f1-score': 0.40437890974084006, 'support': 10630}, '1': {'precision': 0.32898611695414387, 'recall': 0.15942915392456677, 'f1-score': 0.21477616039549577, 'support': 9810}, '2': {'precision': 0.39211691762621786, 'recall': 0.374218089602705, 'f1-score': 0.38295847750865053, 'support': 11830}, 'accuracy': 0.3539200495816548, 'macro avg': {'precision': 0.35191704340977337, 'recall': 0.3481552273030699, 'f1-score': 0.3340378492149954, 'support': 32270}, 'weighted avg': {'precision': 0.35399461417994227, 'recall': 0.3539200495816548, 'f1-score': 0.33888753433381713, 'support': 32270}}
[[5430 1562 3638]
 [5021 1564 3225]
 [5775 1628 4427]]
training model: results/CHTR/W4/deepLOB_L2/h10
Epoch 1/50
346/346 - 18s - loss: 3.3409 - accuracy10: 0.3530 - val_loss: 3.3606 - val_accuracy10: 0.3384 - 18s/epoch - 51ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3065 - accuracy10: 0.3612 - val_loss: 3.3462 - val_accuracy10: 0.3419 - 15s/epoch - 43ms/step
Epoch 3/50
346/346 - 15s - loss: 3.3005 - accuracy10: 0.3629 - val_loss: 3.3360 - val_accuracy10: 0.3389 - 15s/epoch - 43ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2841 - accuracy10: 0.3708 - val_loss: 3.3194 - val_accuracy10: 0.3373 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2723 - accuracy10: 0.3787 - val_loss: 3.3167 - val_accuracy10: 0.3448 - 15s/epoch - 43ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2585 - accuracy10: 0.3867 - val_loss: 3.2989 - val_accuracy10: 0.3653 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2406 - accuracy10: 0.3997 - val_loss: 3.2900 - val_accuracy10: 0.3707 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2240 - accuracy10: 0.4116 - val_loss: 3.3051 - val_accuracy10: 0.3672 - 15s/epoch - 42ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2109 - accuracy10: 0.4180 - val_loss: 3.2881 - val_accuracy10: 0.3782 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.1985 - accuracy10: 0.4256 - val_loss: 3.2917 - val_accuracy10: 0.3790 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.1873 - accuracy10: 0.4323 - val_loss: 3.3140 - val_accuracy10: 0.3760 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.1777 - accuracy10: 0.4367 - val_loss: 3.2989 - val_accuracy10: 0.3803 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1708 - accuracy10: 0.4407 - val_loss: 3.2990 - val_accuracy10: 0.3846 - 15s/epoch - 42ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1620 - accuracy10: 0.4430 - val_loss: 3.3113 - val_accuracy10: 0.3784 - 15s/epoch - 42ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1535 - accuracy10: 0.4476 - val_loss: 3.3254 - val_accuracy10: 0.3792 - 15s/epoch - 42ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1420 - accuracy10: 0.4531 - val_loss: 3.3390 - val_accuracy10: 0.3754 - 15s/epoch - 42ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1312 - accuracy10: 0.4565 - val_loss: 3.3172 - val_accuracy10: 0.3827 - 15s/epoch - 43ms/step
Epoch 18/50
346/346 - 15s - loss: 3.1264 - accuracy10: 0.4584 - val_loss: 3.3414 - val_accuracy10: 0.3771 - 15s/epoch - 43ms/step
Epoch 19/50
346/346 - 15s - loss: 3.1169 - accuracy10: 0.4624 - val_loss: 3.3142 - val_accuracy10: 0.3899 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h10
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067612
{'0': {'precision': 0.35202331760877453, 'recall': 0.4290014265335235, 'f1-score': 0.38671887557947393, 'support': 70100}, '1': {'precision': 0.5323367284440714, 'recall': 0.4483311999694324, 'f1-score': 0.48673594258809866, 'support': 104686}, '2': {'precision': 0.3578345140176548, 'recall': 0.3647186147186147, 'f1-score': 0.36124377034886046, 'support': 61908}, 'accuracy': 0.4207373232950561, 'macro avg': {'precision': 0.41406485335683363, 'recall': 0.41401708040719026, 'f1-score': 0.41156619617214435, 'support': 236694}, 'weighted avg': {'precision': 0.43329301297065465, 'recall': 0.4207373232950561, 'f1-score': 0.4242917496795697, 'support': 236694}}
[[30073 23055 16972]
 [34204 46934 23548]
 [21152 18177 22579]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0815192
{'0': {'precision': 0.40568316119418324, 'recall': 0.2653870718343474, 'f1-score': 0.3208697419223735, 'support': 29749}, '1': {'precision': 0.4084936817920735, 'recall': 0.3930705723859201, 'f1-score': 0.4006337470293108, 'support': 28949}, '2': {'precision': 0.40174047948028024, 'recall': 0.5548004820567756, 'f1-score': 0.4660246045694201, 'support': 29872}, 'accuracy': 0.4047307214632494, 'macro avg': {'precision': 0.4053057741555124, 'recall': 0.404419375425681, 'f1-score': 0.39584269784036813, 'support': 88570}, 'weighted avg': {'precision': 0.40527202844754906, 'recall': 0.4047307214632494, 'f1-score': 0.39589688701476705, 'support': 88570}}
[[ 7895  8852 13002]
 [ 5892 11379 11678]
 [ 5674  7625 16573]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0962585
{'0': {'precision': 0.39896530736457697, 'recall': 0.24136978735156034, 'f1-score': 0.30077430455979354, 'support': 10863}, '1': {'precision': 0.3990450204638472, 'recall': 0.31894593366651525, 'f1-score': 0.3545275491136812, 'support': 11005}, '2': {'precision': 0.3566230846595279, 'recall': 0.5794482360857445, 'f1-score': 0.4415146854171244, 'support': 10403}, 'accuracy': 0.37680889963124786, 'macro avg': {'precision': 0.38487780416265066, 'recall': 0.3799213190346067, 'f1-score': 0.36560551303019967, 'support': 32271}, 'weighted avg': {'precision': 0.38534289404787914, 'recall': 0.37680889963124786, 'f1-score': 0.3644747364761998, 'support': 32271}}
[[2622 2873 5368]
 [1988 3510 5507]
 [1962 2413 6028]]
training model: results/CHTR/W4/deepLOB_L2/h20
Epoch 1/50
346/346 - 17s - loss: 3.3431 - accuracy20: 0.3537 - val_loss: 3.3734 - val_accuracy20: 0.3403 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3036 - accuracy20: 0.3647 - val_loss: 3.3961 - val_accuracy20: 0.3415 - 15s/epoch - 43ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2928 - accuracy20: 0.3701 - val_loss: 3.3744 - val_accuracy20: 0.3343 - 15s/epoch - 42ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2761 - accuracy20: 0.3790 - val_loss: 3.3530 - val_accuracy20: 0.3393 - 15s/epoch - 42ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2735 - accuracy20: 0.3816 - val_loss: 3.3291 - val_accuracy20: 0.3517 - 15s/epoch - 43ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2548 - accuracy20: 0.3919 - val_loss: 3.3442 - val_accuracy20: 0.3451 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2433 - accuracy20: 0.4007 - val_loss: 3.3438 - val_accuracy20: 0.3460 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2307 - accuracy20: 0.4096 - val_loss: 3.3134 - val_accuracy20: 0.3668 - 15s/epoch - 44ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2207 - accuracy20: 0.4150 - val_loss: 3.3021 - val_accuracy20: 0.3693 - 15s/epoch - 44ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2127 - accuracy20: 0.4220 - val_loss: 3.2991 - val_accuracy20: 0.3758 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.2018 - accuracy20: 0.4262 - val_loss: 3.2834 - val_accuracy20: 0.3792 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.1911 - accuracy20: 0.4319 - val_loss: 3.2861 - val_accuracy20: 0.3822 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1822 - accuracy20: 0.4360 - val_loss: 3.2878 - val_accuracy20: 0.3798 - 15s/epoch - 42ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1716 - accuracy20: 0.4424 - val_loss: 3.2908 - val_accuracy20: 0.3805 - 15s/epoch - 43ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1622 - accuracy20: 0.4440 - val_loss: 3.3168 - val_accuracy20: 0.3692 - 15s/epoch - 43ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1560 - accuracy20: 0.4483 - val_loss: 3.3072 - val_accuracy20: 0.3747 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1468 - accuracy20: 0.4511 - val_loss: 3.3335 - val_accuracy20: 0.3657 - 15s/epoch - 43ms/step
Epoch 18/50
346/346 - 15s - loss: 3.1386 - accuracy20: 0.4537 - val_loss: 3.3180 - val_accuracy20: 0.3742 - 15s/epoch - 43ms/step
Epoch 19/50
346/346 - 15s - loss: 3.1302 - accuracy20: 0.4563 - val_loss: 3.3382 - val_accuracy20: 0.3707 - 15s/epoch - 43ms/step
Epoch 20/50
346/346 - 15s - loss: 3.1201 - accuracy20: 0.4624 - val_loss: 3.3360 - val_accuracy20: 0.3723 - 15s/epoch - 43ms/step
Epoch 21/50
346/346 - 15s - loss: 3.1126 - accuracy20: 0.4629 - val_loss: 3.3360 - val_accuracy20: 0.3744 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h20
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0928816
{'0': {'precision': 0.3362002289391455, 'recall': 0.4580207367444997, 'f1-score': 0.38776784599189995, 'support': 71178}, '1': {'precision': 0.5040911459433577, 'recall': 0.3502485420173001, 'f1-score': 0.4133184760079214, 'support': 102196}, '2': {'precision': 0.3508105590965977, 'recall': 0.3807169930511687, 'f1-score': 0.3651524561111195, 'support': 63320}, 'accuracy': 0.39080838551040586, 'macro avg': {'precision': 0.39703397799303364, 'recall': 0.3963287572709895, 'f1-score': 0.38874625937031365, 'support': 236694}, 'weighted avg': {'precision': 0.41259805169651304, 'recall': 0.39080838551040586, 'f1-score': 0.3927496609000358, 'support': 236694}}
[[32601 19149 19428]
 [41219 35794 25183]
 [23149 16064 24107]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0857617
{'0': {'precision': 0.3929545067302777, 'recall': 0.309242063625088, 'f1-score': 0.3461083910180652, 'support': 29831}, '1': {'precision': 0.40363705127801064, 'recall': 0.4377563576702215, 'f1-score': 0.4200049192424366, 'support': 29256}, '2': {'precision': 0.4037164693541136, 'recall': 0.4568734524980497, 'f1-score': 0.4286532586558045, 'support': 29483}, 'accuracy': 0.4008354973467314, 'macro avg': {'precision': 0.4001026757874673, 'recall': 0.40129062459778636, 'f1-score': 0.3982555229721021, 'support': 88570}, 'weighted avg': {'precision': 0.4000655315392089, 'recall': 0.4008354973467314, 'f1-score': 0.39799488940686145, 'support': 88570}}
[[ 9225 10060 10546]
 [ 7100 12807  9349]
 [ 7151  8862 13470]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0948278
{'0': {'precision': 0.3864210369930174, 'recall': 0.23994464944649446, 'f1-score': 0.296056001365887, 'support': 10840}, '1': {'precision': 0.37920510037981553, 'recall': 0.5062019013128112, 'f1-score': 0.4335957191050448, 'support': 11045}, '2': {'precision': 0.3812523156724713, 'recall': 0.3963027151935298, 'f1-score': 0.38863185723727695, 'support': 10386}, 'accuracy': 0.38139506058070716, 'macro avg': {'precision': 0.3822928176817681, 'recall': 0.38081642198427845, 'f1-score': 0.37276119256940293, 'support': 32271}, 'weighted avg': {'precision': 0.38228784125913845, 'recall': 0.38139506058070716, 'f1-score': 0.3729243668181275, 'support': 32271}}
[[2601 4989 3250]
 [2024 5591 3430]
 [2106 4164 4116]]
training model: results/CHTR/W4/deepLOB_L2/h30
Epoch 1/50
346/346 - 17s - loss: 3.3314 - accuracy30: 0.3633 - val_loss: 3.3964 - val_accuracy30: 0.3460 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3040 - accuracy30: 0.3703 - val_loss: 3.3342 - val_accuracy30: 0.3438 - 15s/epoch - 43ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2984 - accuracy30: 0.3667 - val_loss: 3.3361 - val_accuracy30: 0.3494 - 15s/epoch - 43ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2847 - accuracy30: 0.3734 - val_loss: 3.3602 - val_accuracy30: 0.3290 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2783 - accuracy30: 0.3738 - val_loss: 3.3372 - val_accuracy30: 0.3429 - 15s/epoch - 42ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2613 - accuracy30: 0.3902 - val_loss: 3.3185 - val_accuracy30: 0.3478 - 15s/epoch - 42ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2456 - accuracy30: 0.3995 - val_loss: 3.3145 - val_accuracy30: 0.3533 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2333 - accuracy30: 0.4099 - val_loss: 3.3267 - val_accuracy30: 0.3508 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2155 - accuracy30: 0.4195 - val_loss: 3.3333 - val_accuracy30: 0.3498 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2036 - accuracy30: 0.4241 - val_loss: 3.3468 - val_accuracy30: 0.3461 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.1932 - accuracy30: 0.4311 - val_loss: 3.3380 - val_accuracy30: 0.3504 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.1826 - accuracy30: 0.4367 - val_loss: 3.3227 - val_accuracy30: 0.3590 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1754 - accuracy30: 0.4397 - val_loss: 3.3195 - val_accuracy30: 0.3637 - 15s/epoch - 43ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1658 - accuracy30: 0.4424 - val_loss: 3.3314 - val_accuracy30: 0.3626 - 15s/epoch - 43ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1547 - accuracy30: 0.4473 - val_loss: 3.3465 - val_accuracy30: 0.3659 - 15s/epoch - 43ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1468 - accuracy30: 0.4505 - val_loss: 3.3478 - val_accuracy30: 0.3651 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1349 - accuracy30: 0.4556 - val_loss: 3.3346 - val_accuracy30: 0.3686 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h30
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0957713
{'0': {'precision': 0.3259561554962591, 'recall': 0.6098106664429342, 'f1-score': 0.4248313484815275, 'support': 71514}, '1': {'precision': 0.4718559432968296, 'recall': 0.29455494877825167, 'f1-score': 0.36269709798147126, 'support': 100348}, '2': {'precision': 0.3562504657112342, 'recall': 0.2212333415597236, 'f1-score': 0.27295823699009447, 'support': 64832}, 'accuracy': 0.3697220884348568, 'macro avg': {'precision': 0.384687521501441, 'recall': 0.37519965226030316, 'f1-score': 0.3534955611510311, 'support': 236694}, 'weighted avg': {'precision': 0.39610914892266164, 'recall': 0.3697220884348568, 'f1-score': 0.35689010225901135, 'support': 236694}}
[[43610 16691 11213]
 [56085 29558 14705]
 [34096 16393 14343]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932382
{'0': {'precision': 0.3756224667052693, 'recall': 0.43194832867225996, 'f1-score': 0.4018211100099108, 'support': 30036}, '1': {'precision': 0.39280070237050047, 'recall': 0.30512173497919937, 'f1-score': 0.3434537289371666, 'support': 29326}, '2': {'precision': 0.376224, 'recall': 0.4025267050123254, 'f1-score': 0.38893115882099966, 'support': 29208}, 'accuracy': 0.38025290730495653, 'macro avg': {'precision': 0.38154905635858993, 'recall': 0.3798655895545949, 'f1-score': 0.37806866592269234, 'support': 88570}, 'weighted avg': {'precision': 0.38150864174863686, 'recall': 0.38025290730495653, 'f1-score': 0.3782445997732052, 'support': 88570}}
[[12974  6959 10103]
 [10988  8948  9390]
 [10578  6873 11757]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1064605
{'0': {'precision': 0.39831578947368423, 'recall': 0.3463298553908109, 'f1-score': 0.37050817585430335, 'support': 10926}, '1': {'precision': 0.3454978183260611, 'recall': 0.24248329621380846, 'f1-score': 0.2849664649108457, 'support': 10776}, '2': {'precision': 0.3283798001052078, 'recall': 0.47251395590878986, 'f1-score': 0.3874772083640454, 'support': 10569}, 'accuracy': 0.35297945523844937, 'macro avg': {'precision': 0.3573978026349844, 'recall': 0.3537757025044697, 'f1-score': 0.34765061637639816, 'support': 32271}, 'weighted avg': {'precision': 0.35777412888918997, 'recall': 0.35297945523844937, 'f1-score': 0.3475013966243063, 'support': 32271}}
[[3784 2461 4681]
 [2630 2613 5533]
 [3086 2489 4994]]
training model: results/CHTR/W4/deepLOB_L2/h50
Epoch 1/50
346/346 - 18s - loss: 3.3415 - accuracy50: 0.3556 - val_loss: 3.3822 - val_accuracy50: 0.3451 - 18s/epoch - 51ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3065 - accuracy50: 0.3659 - val_loss: 3.3643 - val_accuracy50: 0.3383 - 15s/epoch - 44ms/step
Epoch 3/50
346/346 - 16s - loss: 3.2876 - accuracy50: 0.3790 - val_loss: 3.3315 - val_accuracy50: 0.3465 - 16s/epoch - 46ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2855 - accuracy50: 0.3812 - val_loss: 3.3833 - val_accuracy50: 0.3439 - 15s/epoch - 44ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2858 - accuracy50: 0.3751 - val_loss: 3.3332 - val_accuracy50: 0.3395 - 15s/epoch - 44ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2797 - accuracy50: 0.3772 - val_loss: 3.3277 - val_accuracy50: 0.3491 - 15s/epoch - 44ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2687 - accuracy50: 0.3874 - val_loss: 3.2987 - val_accuracy50: 0.3664 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2530 - accuracy50: 0.3989 - val_loss: 3.3450 - val_accuracy50: 0.3426 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2442 - accuracy50: 0.4027 - val_loss: 3.3707 - val_accuracy50: 0.3413 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2264 - accuracy50: 0.4140 - val_loss: 3.3816 - val_accuracy50: 0.3424 - 15s/epoch - 42ms/step
Epoch 11/50
346/346 - 15s - loss: 3.2161 - accuracy50: 0.4198 - val_loss: 3.3642 - val_accuracy50: 0.3468 - 15s/epoch - 42ms/step
Epoch 12/50
346/346 - 15s - loss: 3.2061 - accuracy50: 0.4249 - val_loss: 3.3543 - val_accuracy50: 0.3514 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1941 - accuracy50: 0.4306 - val_loss: 3.3454 - val_accuracy50: 0.3504 - 15s/epoch - 42ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1872 - accuracy50: 0.4338 - val_loss: 3.3180 - val_accuracy50: 0.3588 - 15s/epoch - 42ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1768 - accuracy50: 0.4376 - val_loss: 3.3213 - val_accuracy50: 0.3553 - 15s/epoch - 43ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1678 - accuracy50: 0.4422 - val_loss: 3.3712 - val_accuracy50: 0.3434 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1596 - accuracy50: 0.4457 - val_loss: 3.3377 - val_accuracy50: 0.3534 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h50
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0972046
{'0': {'precision': 0.33512855803562525, 'recall': 0.6863247048570923, 'f1-score': 0.45035248706653924, 'support': 73439}, '1': {'precision': 0.42768262509308413, 'recall': 0.1875190899994734, 'f1-score': 0.26072312445999973, 'support': 94945}, '2': {'precision': 0.3644830519858505, 'recall': 0.23832528180354268, 'f1-score': 0.28820280413539157, 'support': 68310}, 'accuracy': 0.35694609918291126, 'macro avg': {'precision': 0.37576474503818663, 'recall': 0.3707230255533695, 'f1-score': 0.3330928052206435, 'support': 236694}, 'weighted avg': {'precision': 0.3807264666370699, 'recall': 0.35694609918291126, 'f1-score': 0.3274900373478958, 'support': 236694}}
[[50403 10848 12188]
 [60943 17804 16198]
 [39053 12977 16280]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923765
{'0': {'precision': 0.3819552136964208, 'recall': 0.40642223028942936, 'f1-score': 0.3938090593671554, 'support': 30301}, '1': {'precision': 0.3718405568906936, 'recall': 0.3096938951582289, 'f1-score': 0.3379337613677016, 'support': 28977}, '2': {'precision': 0.3806609927315649, 'recall': 0.41837361736993034, 'f1-score': 0.39862732979865334, 'support': 29292}, 'accuracy': 0.378728689172406, 'macro avg': {'precision': 0.37815225443955974, 'recall': 0.3781632476058629, 'f1-score': 0.37679005017783673, 'support': 88570}, 'weighted avg': {'precision': 0.3782180258138182, 'recall': 0.378728689172406, 'f1-score': 0.3771221254995847, 'support': 88570}}
[[12315  7665 10321]
 [10385  8974  9618]
 [ 9542  7495 12255]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1010609
{'0': {'precision': 0.3855654602083557, 'recall': 0.3276145281985764, 'f1-score': 0.3542355320933445, 'support': 10958}, '1': {'precision': 0.34481201309698545, 'recall': 0.29013870416112486, 'f1-score': 0.3151214982200898, 'support': 10526}, '2': {'precision': 0.3618379068283344, 'recall': 0.47306943543153795, 'f1-score': 0.4100441944556047, 'support': 10787}, 'accuracy': 0.3640110315763379, 'macro avg': {'precision': 0.36407179337789186, 'recall': 0.36360755593041305, 'f1-score': 0.35980040825634635, 'support': 32271}, 'weighted avg': {'precision': 0.36434145405408186, 'recall': 0.3640110315763379, 'f1-score': 0.36013227283121513, 'support': 32271}}
[[3590 3012 4356]
 [2828 3054 4644]
 [2893 2791 5103]]
training model: results/CHTR/W4/deepLOB_L2/h100
Epoch 1/50
346/346 - 16s - loss: 3.3448 - accuracy100: 0.3543 - val_loss: 3.3641 - val_accuracy100: 0.3368 - 16s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3044 - accuracy100: 0.3671 - val_loss: 3.3703 - val_accuracy100: 0.3476 - 15s/epoch - 42ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2887 - accuracy100: 0.3772 - val_loss: 3.3420 - val_accuracy100: 0.3358 - 15s/epoch - 42ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2864 - accuracy100: 0.3711 - val_loss: 3.3547 - val_accuracy100: 0.3264 - 15s/epoch - 42ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2798 - accuracy100: 0.3729 - val_loss: 3.3459 - val_accuracy100: 0.3289 - 15s/epoch - 42ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2674 - accuracy100: 0.3800 - val_loss: 3.3626 - val_accuracy100: 0.3408 - 15s/epoch - 42ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2571 - accuracy100: 0.3912 - val_loss: 3.3331 - val_accuracy100: 0.3465 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2513 - accuracy100: 0.3957 - val_loss: 3.3625 - val_accuracy100: 0.3526 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2350 - accuracy100: 0.4065 - val_loss: 3.3487 - val_accuracy100: 0.3521 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2331 - accuracy100: 0.4075 - val_loss: 3.3747 - val_accuracy100: 0.3584 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.2253 - accuracy100: 0.4154 - val_loss: 3.3549 - val_accuracy100: 0.3546 - 15s/epoch - 42ms/step
Epoch 12/50
346/346 - 15s - loss: 3.2138 - accuracy100: 0.4166 - val_loss: 3.3465 - val_accuracy100: 0.3529 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.2064 - accuracy100: 0.4224 - val_loss: 3.3875 - val_accuracy100: 0.3498 - 15s/epoch - 43ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1976 - accuracy100: 0.4244 - val_loss: 3.3745 - val_accuracy100: 0.3530 - 15s/epoch - 43ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1911 - accuracy100: 0.4281 - val_loss: 3.3746 - val_accuracy100: 0.3527 - 15s/epoch - 43ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1865 - accuracy100: 0.4310 - val_loss: 3.3781 - val_accuracy100: 0.3515 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1775 - accuracy100: 0.4350 - val_loss: 3.3892 - val_accuracy100: 0.3514 - 15s/epoch - 42ms/step
testing model: results/CHTR/W4/deepLOB_L2/h100
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1030145
{'0': {'precision': 0.3245428806159654, 'recall': 0.6442955734080984, 'f1-score': 0.43165409154328604, 'support': 74188}, '1': {'precision': 0.38468269802933247, 'recall': 0.11874662344678552, 'f1-score': 0.18147441772141448, 'support': 92550}, '2': {'precision': 0.3539050687002827, 'recall': 0.3078077648807822, 'f1-score': 0.3292507645259939, 'support': 69956}, 'accuracy': 0.33934953991229183, 'macro avg': {'precision': 0.3543768824485269, 'recall': 0.35694998724522203, 'f1-score': 0.31412642459689816, 'support': 236694}, 'weighted avg': {'precision': 0.3567363512203475, 'recall': 0.33934953991229183, 'f1-score': 0.30356526818048046, 'support': 236694}}
[[47799  9126 17263]
 [59512 10990 22048]
 [39970  8453 21533]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093621
{'0': {'precision': 0.3707212811433311, 'recall': 0.38307621308016876, 'f1-score': 0.376797496879205, 'support': 30336}, '1': {'precision': 0.3355911330049261, 'recall': 0.22505936198768023, 'f1-score': 0.26942962489958183, 'support': 29059}, '2': {'precision': 0.3469458062806413, 'recall': 0.44874035989717226, 'f1-score': 0.39133163951576744, 'support': 29175}, 'accuracy': 0.35286214293778934, 'macro avg': {'precision': 0.3510860734762995, 'recall': 0.35229197832167375, 'f1-score': 0.3458529204315181, 'support': 88570}, 'weighted avg': {'precision': 0.35136375089750416, 'recall': 0.35286214293778934, 'f1-score': 0.34635864195728827, 'support': 88570}}
[[11621  6529 12186]
 [10062  6540 12457]
 [ 9664  6419 13092]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11248
{'0': {'precision': 0.3887058823529412, 'recall': 0.2252932084734976, 'f1-score': 0.28525382755842066, 'support': 10999}, '1': {'precision': 0.32789153292750417, 'recall': 0.3550739113064323, 'f1-score': 0.34094178574853745, 'support': 10012}, '2': {'precision': 0.3454895708781719, 'recall': 0.4619005328596803, 'f1-score': 0.39530288059588053, 'support': 11260}, 'accuracy': 0.3481144061231446, 'macro avg': {'precision': 0.35402899538620575, 'recall': 0.34742255087987006, 'f1-score': 0.34049949796761286, 'support': 32271}, 'weighted avg': {'precision': 0.35475933797398246, 'recall': 0.3481144061231446, 'f1-score': 0.3409292071438456, 'support': 32271}}
[[2478 3521 5000]
 [1604 3555 4853]
 [2293 3766 5201]]
training model: results/CHTR/W4/deepLOB_L2/h200
Epoch 1/50
346/346 - 17s - loss: 3.3389 - accuracy200: 0.3576 - val_loss: 3.4053 - val_accuracy200: 0.3596 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.2891 - accuracy200: 0.3772 - val_loss: 3.3155 - val_accuracy200: 0.3604 - 15s/epoch - 44ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2891 - accuracy200: 0.3747 - val_loss: 3.3565 - val_accuracy200: 0.3627 - 15s/epoch - 44ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2846 - accuracy200: 0.3797 - val_loss: 3.3170 - val_accuracy200: 0.3519 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2973 - accuracy200: 0.3673 - val_loss: 3.3331 - val_accuracy200: 0.3109 - 15s/epoch - 44ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2844 - accuracy200: 0.3677 - val_loss: 3.3255 - val_accuracy200: 0.3259 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2684 - accuracy200: 0.3818 - val_loss: 3.3363 - val_accuracy200: 0.3181 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2578 - accuracy200: 0.3888 - val_loss: 3.3320 - val_accuracy200: 0.3338 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2418 - accuracy200: 0.4017 - val_loss: 3.3336 - val_accuracy200: 0.3508 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2331 - accuracy200: 0.4065 - val_loss: 3.3447 - val_accuracy200: 0.3600 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.2224 - accuracy200: 0.4119 - val_loss: 3.3547 - val_accuracy200: 0.3606 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.2129 - accuracy200: 0.4196 - val_loss: 3.3551 - val_accuracy200: 0.3611 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h200
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1300855
{'0': {'precision': 0.3229415872921527, 'recall': 0.5833814272484464, 'f1-score': 0.41574167507568116, 'support': 74507}, '1': {'precision': 0.370188069350573, 'recall': 0.05701193641454998, 'f1-score': 0.09880682765179367, 'support': 88385}, '2': {'precision': 0.343504203959859, 'recall': 0.4118587572152516, 'f1-score': 0.3745886992420975, 'support': 73802}, 'accuracy': 0.3333460079258452, 'macro avg': {'precision': 0.3455446202008616, 'recall': 0.350750706959416, 'f1-score': 0.2963790673231908, 'support': 236694}, 'weighted avg': {'precision': 0.3469956087377472, 'recall': 0.3333460079258452, 'f1-score': 0.2845619307136338, 'support': 236694}}
[[43466  4532 26509]
 [51763  5039 31583]
 [39365  4041 30396]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1285667
{'0': {'precision': 0.3476377018043685, 'recall': 0.39124916499665996, 'f1-score': 0.36815638946508267, 'support': 29940}, '1': {'precision': 0.3208239853151132, 'recall': 0.10725853192867614, 'f1-score': 0.16076858216010426, 'support': 29331}, '2': {'precision': 0.3305671429839354, 'recall': 0.5084815181405509, 'f1-score': 0.40066158376699346, 'support': 29299}, 'accuracy': 0.33598283843287796, 'macro avg': {'precision': 0.3330096100344724, 'recall': 0.335663071688629, 'f1-score': 0.3098621851307268, 'support': 88570}, 'weighted avg': {'precision': 0.33311107403846335, 'recall': 0.33598283843287796, 'f1-score': 0.31023020578877425, 'support': 88570}}
[[11714  3343 14883]
 [10898  3146 15287]
 [11084  3317 14898]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050508
{'0': {'precision': 0.3679757677041989, 'recall': 0.318881245474294, 'f1-score': 0.34167394045194455, 'support': 11048}, '1': {'precision': 0.33480753480753483, 'recall': 0.21238570241064006, 'f1-score': 0.2599020916777926, 'support': 9624}, '2': {'precision': 0.3674662487945998, 'recall': 0.5256487628243814, 'f1-score': 0.43254939519704877, 'support': 11599}, 'accuracy': 0.3614390629357628, 'macro avg': {'precision': 0.3567498504354445, 'recall': 0.35230523690310517, 'f1-score': 0.3447084757755953, 'support': 32271}, 'weighted avg': {'precision': 0.3579010571829899, 'recall': 0.3614390629357628, 'f1-score': 0.34995047749715624, 'support': 32271}}
[[3523 1952 5573]
 [2658 2044 4922]
 [3393 2109 6097]]
training model: results/CHTR/W4/deepLOB_L2/h300
Epoch 1/50
346/346 - 17s - loss: 3.3433 - accuracy300: 0.3530 - val_loss: 3.3882 - val_accuracy300: 0.3381 - 17s/epoch - 49ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3123 - accuracy300: 0.3633 - val_loss: 3.3996 - val_accuracy300: 0.3251 - 15s/epoch - 43ms/step
Epoch 3/50
346/346 - 15s - loss: 3.3124 - accuracy300: 0.3573 - val_loss: 3.3554 - val_accuracy300: 0.3390 - 15s/epoch - 43ms/step
Epoch 4/50
346/346 - 15s - loss: 3.3010 - accuracy300: 0.3606 - val_loss: 3.3346 - val_accuracy300: 0.3290 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2883 - accuracy300: 0.3627 - val_loss: 3.3653 - val_accuracy300: 0.3232 - 15s/epoch - 43ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2809 - accuracy300: 0.3699 - val_loss: 3.3296 - val_accuracy300: 0.3395 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2592 - accuracy300: 0.3882 - val_loss: 3.3363 - val_accuracy300: 0.3438 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2424 - accuracy300: 0.3988 - val_loss: 3.3301 - val_accuracy300: 0.3466 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2314 - accuracy300: 0.4076 - val_loss: 3.3252 - val_accuracy300: 0.3454 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.2195 - accuracy300: 0.4152 - val_loss: 3.3237 - val_accuracy300: 0.3496 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.2089 - accuracy300: 0.4227 - val_loss: 3.3457 - val_accuracy300: 0.3432 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.2025 - accuracy300: 0.4253 - val_loss: 3.3575 - val_accuracy300: 0.3521 - 15s/epoch - 43ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1906 - accuracy300: 0.4302 - val_loss: 3.3478 - val_accuracy300: 0.3514 - 15s/epoch - 42ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1863 - accuracy300: 0.4305 - val_loss: 3.3442 - val_accuracy300: 0.3513 - 15s/epoch - 43ms/step
Epoch 15/50
346/346 - 15s - loss: 3.1720 - accuracy300: 0.4392 - val_loss: 3.3608 - val_accuracy300: 0.3549 - 15s/epoch - 43ms/step
Epoch 16/50
346/346 - 15s - loss: 3.1617 - accuracy300: 0.4435 - val_loss: 3.3863 - val_accuracy300: 0.3522 - 15s/epoch - 43ms/step
Epoch 17/50
346/346 - 15s - loss: 3.1516 - accuracy300: 0.4474 - val_loss: 3.3763 - val_accuracy300: 0.3569 - 15s/epoch - 43ms/step
Epoch 18/50
346/346 - 15s - loss: 3.1384 - accuracy300: 0.4513 - val_loss: 3.3957 - val_accuracy300: 0.3509 - 15s/epoch - 44ms/step
Epoch 19/50
346/346 - 15s - loss: 3.1299 - accuracy300: 0.4565 - val_loss: 3.3983 - val_accuracy300: 0.3523 - 15s/epoch - 43ms/step
Epoch 20/50
346/346 - 15s - loss: 3.1267 - accuracy300: 0.4551 - val_loss: 3.4277 - val_accuracy300: 0.3543 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h300
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117804
{'0': {'precision': 0.3022300307113411, 'recall': 0.6060782600252451, 'f1-score': 0.40333233332564095, 'support': 72093}, '1': {'precision': 0.416951122085845, 'recall': 0.06424430966182494, 'f1-score': 0.11133412843858784, 'support': 89362}, '2': {'precision': 0.37003050298010287, 'recall': 0.3853453661000279, 'f1-score': 0.377532683993958, 'support': 75239}, 'accuracy': 0.33134764717314336, 'macro avg': {'precision': 0.36307055192576304, 'recall': 0.35188931192903267, 'f1-score': 0.29739971525272896, 'support': 236694}, 'weighted avg': {'precision': 0.36709414175952054, 'recall': 0.33134764717314336, 'f1-score': 0.2848896038893927, 'support': 236694}}
[[43694  4083 24316]
 [58577  5741 25044]
 [42301  3945 28993]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1134076
{'0': {'precision': 0.35318509615384613, 'recall': 0.393176116407426, 'f1-score': 0.3721092204194697, 'support': 29895}, '1': {'precision': 0.3305785123966942, 'recall': 0.06823609689525759, 'f1-score': 0.11312217194570136, 'support': 29310}, '2': {'precision': 0.33164094232331437, 'recall': 0.5561042056870424, 'f1-score': 0.4154951975065199, 'support': 29365}, 'accuracy': 0.3396635429603703, 'macro avg': {'precision': 0.3384681836246182, 'recall': 0.33917213966324206, 'f1-score': 0.300242196623897, 'support': 88570}, 'weighted avg': {'precision': 0.3385611484609965, 'recall': 0.3396635429603703, 'f1-score': 0.3007884439307611, 'support': 88570}}
[[11754  2047 16094]
 [10494  2000 16816]
 [11032  2003 16330]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077464
{'0': {'precision': 0.3498017983177028, 'recall': 0.33428809017832395, 'f1-score': 0.3418690352452046, 'support': 10823}, '1': {'precision': 0.31129765652325986, 'recall': 0.08881349166749826, 'f1-score': 0.13819875776397517, 'support': 10021}, '2': {'precision': 0.357281451570612, 'recall': 0.5962194801785246, 'f1-score': 0.4468126967471144, 'support': 11427}, 'accuracy': 0.3508103250596511, 'macro avg': {'precision': 0.3394603021371916, 'recall': 0.3397736873414489, 'f1-score': 0.308960163252098, 'support': 32271}, 'weighted avg': {'precision': 0.34049375062159426, 'recall': 0.3508103250596511, 'f1-score': 0.31578404777481084, 'support': 32271}}
[[3618  948 6257]
 [3132  890 5999]
 [3593 1021 6813]]
training model: results/CHTR/W4/deepLOB_L2/h500
Epoch 1/50
346/346 - 17s - loss: 3.3483 - accuracy500: 0.3573 - val_loss: 3.3529 - val_accuracy500: 0.3442 - 17s/epoch - 49ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3206 - accuracy500: 0.3632 - val_loss: 3.3332 - val_accuracy500: 0.3418 - 15s/epoch - 42ms/step
Epoch 3/50
346/346 - 15s - loss: 3.2963 - accuracy500: 0.3668 - val_loss: 3.3175 - val_accuracy500: 0.3477 - 15s/epoch - 43ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2959 - accuracy500: 0.3669 - val_loss: 3.3054 - val_accuracy500: 0.3414 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2750 - accuracy500: 0.3771 - val_loss: 3.3144 - val_accuracy500: 0.3472 - 15s/epoch - 43ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2659 - accuracy500: 0.3832 - val_loss: 3.3340 - val_accuracy500: 0.3294 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2473 - accuracy500: 0.3984 - val_loss: 3.3078 - val_accuracy500: 0.3576 - 15s/epoch - 42ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2205 - accuracy500: 0.4141 - val_loss: 3.3183 - val_accuracy500: 0.3678 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2070 - accuracy500: 0.4202 - val_loss: 3.3149 - val_accuracy500: 0.3648 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.1953 - accuracy500: 0.4253 - val_loss: 3.3210 - val_accuracy500: 0.3773 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.1850 - accuracy500: 0.4316 - val_loss: 3.3264 - val_accuracy500: 0.3779 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.1703 - accuracy500: 0.4399 - val_loss: 3.3315 - val_accuracy500: 0.3750 - 15s/epoch - 42ms/step
Epoch 13/50
346/346 - 15s - loss: 3.1587 - accuracy500: 0.4467 - val_loss: 3.3214 - val_accuracy500: 0.3702 - 15s/epoch - 43ms/step
Epoch 14/50
346/346 - 15s - loss: 3.1374 - accuracy500: 0.4541 - val_loss: 3.3523 - val_accuracy500: 0.3618 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h500
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989784
{'0': {'precision': 0.3001819476307254, 'recall': 0.2661308421702295, 'f1-score': 0.28213268697443067, 'support': 71292}, '1': {'precision': 0.38098971628619355, 'recall': 0.4743042629500159, 'f1-score': 0.4225565734393011, 'support': 88108}, '2': {'precision': 0.3712951207661322, 'recall': 0.30647915750252286, 'f1-score': 0.3357879442928523, 'support': 77294}, 'accuracy': 0.3567982289369397, 'macro avg': {'precision': 0.35082226156101703, 'recall': 0.34897142087425603, 'f1-score': 0.34682573490219476, 'support': 236694}, 'weighted avg': {'precision': 0.35348466119771116, 'recall': 0.3567982289369397, 'f1-score': 0.3519261639861711, 'support': 236694}}
[[18973 33174 19145]
 [25351 41790 20967]
 [18881 34724 23689]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1074336
{'0': {'precision': 0.3609516519964281, 'recall': 0.18988021340133543, 'f1-score': 0.24885116861986323, 'support': 29803}, '1': {'precision': 0.3196911196911197, 'recall': 0.41058787319175133, 'f1-score': 0.3594826037487275, 'support': 29241}, '2': {'precision': 0.33211647847864845, 'recall': 0.39748018695387116, 'f1-score': 0.3618704037741085, 'support': 29526}, 'accuracy': 0.3319521282601332, 'macro avg': {'precision': 0.3375864167220654, 'recall': 0.3326494245156526, 'f1-score': 0.3234013920475664, 'support': 88570}, 'weighted avg': {'precision': 0.33771707416617536, 'recall': 0.3319521282601332, 'f1-score': 0.3230521365747843, 'support': 88570}}
[[ 5659 13018 11126]
 [ 4760 12006 12475]
 [ 5259 12531 11736]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008853
{'0': {'precision': 0.36877234803337305, 'recall': 0.14345326409495548, 'f1-score': 0.2065558448494559, 'support': 10784}, '1': {'precision': 0.3099699124726477, 'recall': 0.46085807238714926, 'f1-score': 0.3706459525756337, 'support': 9836}, '2': {'precision': 0.37920011894142136, 'recall': 0.43781649643807397, 'f1-score': 0.40640560889136756, 'support': 11651}, 'accuracy': 0.3464720647020545, 'macro avg': {'precision': 0.352647459815814, 'recall': 0.3473759443067263, 'f1-score': 0.32786913543881907, 'support': 32271}, 'weighted avg': {'precision': 0.3546145345994657, 'recall': 0.3464720647020545, 'f1-score': 0.32872249293742956, 'support': 32271}}
[[1547 5028 4209]
 [1161 4533 4142]
 [1487 5063 5101]]
training model: results/CHTR/W4/deepLOB_L2/h1000
Epoch 1/50
346/346 - 17s - loss: 3.3374 - accuracy1000: 0.3665 - val_loss: 3.4099 - val_accuracy1000: 0.3345 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3015 - accuracy1000: 0.3800 - val_loss: 3.3711 - val_accuracy1000: 0.3349 - 15s/epoch - 43ms/step
Epoch 3/50
346/346 - 15s - loss: 3.3019 - accuracy1000: 0.3719 - val_loss: 3.3497 - val_accuracy1000: 0.3664 - 15s/epoch - 43ms/step
Epoch 4/50
346/346 - 15s - loss: 3.2597 - accuracy1000: 0.3844 - val_loss: 3.3923 - val_accuracy1000: 0.3705 - 15s/epoch - 43ms/step
Epoch 5/50
346/346 - 15s - loss: 3.2485 - accuracy1000: 0.3983 - val_loss: 3.4020 - val_accuracy1000: 0.3533 - 15s/epoch - 43ms/step
Epoch 6/50
346/346 - 15s - loss: 3.2070 - accuracy1000: 0.4195 - val_loss: 3.4044 - val_accuracy1000: 0.3552 - 15s/epoch - 43ms/step
Epoch 7/50
346/346 - 15s - loss: 3.1846 - accuracy1000: 0.4302 - val_loss: 3.4209 - val_accuracy1000: 0.3610 - 15s/epoch - 43ms/step
Epoch 8/50
346/346 - 15s - loss: 3.1651 - accuracy1000: 0.4358 - val_loss: 3.4543 - val_accuracy1000: 0.3694 - 15s/epoch - 43ms/step
Epoch 9/50
346/346 - 15s - loss: 3.1479 - accuracy1000: 0.4442 - val_loss: 3.4567 - val_accuracy1000: 0.3528 - 15s/epoch - 43ms/step
Epoch 10/50
346/346 - 15s - loss: 3.1338 - accuracy1000: 0.4523 - val_loss: 3.4100 - val_accuracy1000: 0.3556 - 15s/epoch - 43ms/step
Epoch 11/50
346/346 - 15s - loss: 3.1194 - accuracy1000: 0.4572 - val_loss: 3.4255 - val_accuracy1000: 0.3716 - 15s/epoch - 43ms/step
Epoch 12/50
346/346 - 15s - loss: 3.0978 - accuracy1000: 0.4660 - val_loss: 3.4202 - val_accuracy1000: 0.3706 - 15s/epoch - 42ms/step
Epoch 13/50
346/346 - 15s - loss: 3.0865 - accuracy1000: 0.4710 - val_loss: 3.4612 - val_accuracy1000: 0.3700 - 15s/epoch - 43ms/step
testing model: results/CHTR/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1149112
{'0': {'precision': 0.28753747927616496, 'recall': 0.579288485864946, 'f1-score': 0.384315093681342, 'support': 70357}, '1': {'precision': 0.3634478441192582, 'recall': 0.21078548169327296, 'f1-score': 0.26682369500118486, 'support': 88137}, '2': {'precision': 0.4084137521958342, 'recall': 0.22892583120204604, 'f1-score': 0.2933960486098023, 'support': 78200}, 'accuracy': 0.32631583394593866, 'macro avg': {'precision': 0.3531330251970857, 'recall': 0.339666599586755, 'f1-score': 0.3148449457641097, 'support': 236694}, 'weighted avg': {'precision': 0.3557396152343804, 'recall': 0.32631583394593866, 'f1-score': 0.3105269590853344, 'support': 236694}}
[[40757 15973 13627]
 [57255 18578 12304]
 [43733 16565 17902]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1251295
{'0': {'precision': 0.3537450896246658, 'recall': 0.36288520149001013, 'f1-score': 0.3582568577303044, 'support': 29530}, '1': {'precision': 0.3438728323699422, 'recall': 0.20317622950819672, 'f1-score': 0.2554315156719622, 'support': 29280}, '2': {'precision': 0.3360909778656319, 'recall': 0.4627688172043011, 'f1-score': 0.3893860355966467, 'support': 29760}, 'accuracy': 0.3436490911143728, 'macro avg': {'precision': 0.34456963328674667, 'recall': 0.34294341606750267, 'f1-score': 0.3343581363329711, 'support': 88570}, 'weighted avg': {'precision': 0.344549582586536, 'recall': 0.3436490911143728, 'f1-score': 0.33472381401159707, 'support': 88570}}
[[10716  5723 13091]
 [ 9217  5949 14114]
 [10360  5628 13772]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173424
{'0': {'precision': 0.3978214176127646, 'recall': 0.24384051156667294, 'f1-score': 0.3023554104477612, 'support': 10634}, '1': {'precision': 0.2980980980980981, 'recall': 0.15212505108295873, 'f1-score': 0.20144760873976866, 'support': 9788}, '2': {'precision': 0.37628865979381443, 'recall': 0.6592117478268208, 'f1-score': 0.47909957984481855, 'support': 11849}, 'accuracy': 0.3685352173778315, 'macro avg': {'precision': 0.35740272516822574, 'recall': 0.3517257701588175, 'f1-score': 0.3276341996774495, 'support': 32271}, 'weighted avg': {'precision': 0.3596684784783623, 'recall': 0.3685352173778315, 'f1-score': 0.33664489946477033, 'support': 32271}}
[[2593 1707 6334]
 [1686 1489 6613]
 [2239 1799 7811]]
training model: results/CHTR/W4/deepOF_L2/h10
Epoch 1/50
346/346 - 10s - loss: 3.3295 - accuracy10: 0.3532 - val_loss: 3.3054 - val_accuracy10: 0.3713 - 10s/epoch - 30ms/step
Epoch 2/50
346/346 - 8s - loss: 3.2847 - accuracy10: 0.3781 - val_loss: 3.2850 - val_accuracy10: 0.3832 - 8s/epoch - 24ms/step
Epoch 3/50
346/346 - 8s - loss: 3.2569 - accuracy10: 0.3919 - val_loss: 3.2654 - val_accuracy10: 0.3904 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2349 - accuracy10: 0.4048 - val_loss: 3.2562 - val_accuracy10: 0.3952 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2150 - accuracy10: 0.4176 - val_loss: 3.2484 - val_accuracy10: 0.4029 - 9s/epoch - 25ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2007 - accuracy10: 0.4220 - val_loss: 3.2363 - val_accuracy10: 0.4049 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.1853 - accuracy10: 0.4295 - val_loss: 3.2331 - val_accuracy10: 0.4096 - 8s/epoch - 25ms/step
Epoch 8/50
346/346 - 8s - loss: 3.1708 - accuracy10: 0.4371 - val_loss: 3.2177 - val_accuracy10: 0.4156 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 8s - loss: 3.1580 - accuracy10: 0.4409 - val_loss: 3.2183 - val_accuracy10: 0.4167 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.1473 - accuracy10: 0.4445 - val_loss: 3.2096 - val_accuracy10: 0.4199 - 8s/epoch - 25ms/step
Epoch 11/50
346/346 - 8s - loss: 3.1338 - accuracy10: 0.4505 - val_loss: 3.2109 - val_accuracy10: 0.4202 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 3.1220 - accuracy10: 0.4569 - val_loss: 3.2135 - val_accuracy10: 0.4189 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.1114 - accuracy10: 0.4608 - val_loss: 3.2116 - val_accuracy10: 0.4224 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.1016 - accuracy10: 0.4640 - val_loss: 3.2090 - val_accuracy10: 0.4245 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.0922 - accuracy10: 0.4669 - val_loss: 3.2164 - val_accuracy10: 0.4234 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.0833 - accuracy10: 0.4702 - val_loss: 3.2194 - val_accuracy10: 0.4223 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.0711 - accuracy10: 0.4747 - val_loss: 3.2251 - val_accuracy10: 0.4239 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.0632 - accuracy10: 0.4773 - val_loss: 3.2288 - val_accuracy10: 0.4229 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.0534 - accuracy10: 0.4812 - val_loss: 3.2299 - val_accuracy10: 0.4202 - 8s/epoch - 24ms/step
Epoch 20/50
346/346 - 8s - loss: 3.0439 - accuracy10: 0.4848 - val_loss: 3.2308 - val_accuracy10: 0.4257 - 8s/epoch - 24ms/step
Epoch 21/50
346/346 - 8s - loss: 3.0320 - accuracy10: 0.4885 - val_loss: 3.2399 - val_accuracy10: 0.4246 - 8s/epoch - 24ms/step
Epoch 22/50
346/346 - 8s - loss: 3.0219 - accuracy10: 0.4903 - val_loss: 3.2508 - val_accuracy10: 0.4204 - 8s/epoch - 24ms/step
Epoch 23/50
346/346 - 9s - loss: 3.0137 - accuracy10: 0.4937 - val_loss: 3.2594 - val_accuracy10: 0.4205 - 9s/epoch - 25ms/step
Epoch 24/50
346/346 - 9s - loss: 3.0092 - accuracy10: 0.4944 - val_loss: 3.2543 - val_accuracy10: 0.4231 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepOF_L2/h10
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.071606
{'0': {'precision': 0.3792778364625572, 'recall': 0.47635486954164824, 'f1-score': 0.42230934614898186, 'support': 70099}, '1': {'precision': 0.5725094746427758, 'recall': 0.40838531566730035, 'f1-score': 0.47671669751778584, 'support': 104683}, '2': {'precision': 0.33929923218341085, 'recall': 0.40544033081346514, 'f1-score': 0.36943275146448434, 'support': 61908}, 'accuracy': 0.42774515188643375, 'macro avg': {'precision': 0.4303621810962479, 'recall': 0.43006017200747126, 'f1-score': 0.422819598377084, 'support': 236690}, 'weighted avg': {'precision': 0.45428342244382564, 'recall': 0.42774515188643375, 'f1-score': 0.4325423113761255, 'support': 236690}}
[[33392 17159 19548]
 [32604 42751 29328]
 [22045 14763 25100]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0375956
{'0': {'precision': 0.4609900107690594, 'recall': 0.4183601253664948, 'f1-score': 0.438641744107982, 'support': 29673}, '1': {'precision': 0.47576003242805026, 'recall': 0.4038468155386574, 'f1-score': 0.4368637522565277, 'support': 29063}, '2': {'precision': 0.44671355152826614, 'recall': 0.5535816042637348, 'f1-score': 0.49443887250572577, 'support': 29833}, 'accuracy': 0.45914484752001267, 'macro avg': {'precision': 0.46115453157512526, 'recall': 0.4585961817229623, 'f1-score': 0.4566481229567452, 'support': 88569}, 'weighted avg': {'precision': 0.4610278516721369, 'recall': 0.45914484752001267, 'f1-score': 0.4568526526009205, 'support': 88569}}
[[12414  6930 10329]
 [ 7200 11737 10126]
 [ 7315  6003 16515]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0688776
{'0': {'precision': 0.42908907901358834, 'recall': 0.3909933045950656, 'f1-score': 0.40915634897782893, 'support': 10903}, '1': {'precision': 0.45803439243821886, 'recall': 0.3652047580132571, 'f1-score': 0.40638577346670707, 'support': 11013}, '2': {'precision': 0.40084108012394865, 'recall': 0.5247247440602666, 'f1-score': 0.4544922201773465, 'support': 10354}, 'accuracy': 0.4251007127362876, 'macro avg': {'precision': 0.42932151719191863, 'recall': 0.4269742688895297, 'f1-score': 0.4233447808739608, 'support': 32270}, 'weighted avg': {'precision': 0.4299039211654981, 'recall': 0.4251007127362876, 'f1-score': 0.4227570698422795, 'support': 32270}}
[[4263 2629 4011]
 [2881 4022 4110]
 [2791 2130 5433]]
training model: results/CHTR/W4/deepOF_L2/h20
Epoch 1/50
346/346 - 11s - loss: 3.3338 - accuracy20: 0.3545 - val_loss: 3.2861 - val_accuracy20: 0.3786 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2868 - accuracy20: 0.3783 - val_loss: 3.2627 - val_accuracy20: 0.3922 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 8s - loss: 3.2584 - accuracy20: 0.3926 - val_loss: 3.2504 - val_accuracy20: 0.3986 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2424 - accuracy20: 0.4016 - val_loss: 3.2355 - val_accuracy20: 0.4053 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2268 - accuracy20: 0.4116 - val_loss: 3.2319 - val_accuracy20: 0.4086 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2107 - accuracy20: 0.4192 - val_loss: 3.2229 - val_accuracy20: 0.4124 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 9s - loss: 3.1987 - accuracy20: 0.4254 - val_loss: 3.2163 - val_accuracy20: 0.4172 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 8s - loss: 3.1824 - accuracy20: 0.4340 - val_loss: 3.2133 - val_accuracy20: 0.4183 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 8s - loss: 3.1693 - accuracy20: 0.4391 - val_loss: 3.2145 - val_accuracy20: 0.4200 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.1574 - accuracy20: 0.4455 - val_loss: 3.2090 - val_accuracy20: 0.4201 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.1485 - accuracy20: 0.4468 - val_loss: 3.2047 - val_accuracy20: 0.4235 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 3.1375 - accuracy20: 0.4514 - val_loss: 3.2089 - val_accuracy20: 0.4235 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.1256 - accuracy20: 0.4562 - val_loss: 3.2046 - val_accuracy20: 0.4266 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.1179 - accuracy20: 0.4587 - val_loss: 3.2087 - val_accuracy20: 0.4259 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.1089 - accuracy20: 0.4613 - val_loss: 3.2099 - val_accuracy20: 0.4277 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.0998 - accuracy20: 0.4669 - val_loss: 3.2167 - val_accuracy20: 0.4241 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.0886 - accuracy20: 0.4677 - val_loss: 3.2161 - val_accuracy20: 0.4268 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.0786 - accuracy20: 0.4729 - val_loss: 3.2217 - val_accuracy20: 0.4248 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.0691 - accuracy20: 0.4773 - val_loss: 3.2336 - val_accuracy20: 0.4248 - 8s/epoch - 24ms/step
Epoch 20/50
346/346 - 8s - loss: 3.0607 - accuracy20: 0.4804 - val_loss: 3.2365 - val_accuracy20: 0.4242 - 8s/epoch - 24ms/step
Epoch 21/50
346/346 - 8s - loss: 3.0508 - accuracy20: 0.4836 - val_loss: 3.2409 - val_accuracy20: 0.4242 - 8s/epoch - 24ms/step
Epoch 22/50
346/346 - 8s - loss: 3.0425 - accuracy20: 0.4856 - val_loss: 3.2517 - val_accuracy20: 0.4203 - 8s/epoch - 24ms/step
Epoch 23/50
346/346 - 8s - loss: 3.0275 - accuracy20: 0.4924 - val_loss: 3.2548 - val_accuracy20: 0.4244 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h20
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801682
{'0': {'precision': 0.37386275856149687, 'recall': 0.48958230889191734, 'f1-score': 0.4239681236122517, 'support': 71177}, '1': {'precision': 0.5351866224511395, 'recall': 0.3711213096787451, 'f1-score': 0.43830392122872097, 'support': 102193}, '2': {'precision': 0.33828166958150296, 'recall': 0.38795009475679093, 'f1-score': 0.36141742130545773, 'support': 63320}, 'accuracy': 0.4112467784866281, 'macro avg': {'precision': 0.4157770168647131, 'recall': 0.41621790444248447, 'f1-score': 0.4078964887154768, 'support': 236690}, 'weighted avg': {'precision': 0.4339970061776236, 'recall': 0.4112467784866281, 'f1-score': 0.4134239844249335, 'support': 236690}}
[[34847 17557 18773]
 [34988 37926 29279]
 [23373 15382 24565]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0457389
{'0': {'precision': 0.45457585553450003, 'recall': 0.41075745366639804, 'f1-score': 0.43155722525001317, 'support': 29784}, '1': {'precision': 0.46748636879276906, 'recall': 0.43608124253285546, 'f1-score': 0.45123803468616436, 'support': 29295}, '2': {'precision': 0.44557080019808326, 'recall': 0.5186842997626314, 'f1-score': 0.47935567777621085, 'support': 29490}, 'accuracy': 0.45506892930935205, 'macro avg': {'precision': 0.45587767484178415, 'recall': 0.45517433198729496, 'f1-score': 0.45405031257079614, 'support': 88569}, 'weighted avg': {'precision': 0.45584779497188854, 'recall': 0.45506892930935205, 'f1-score': 0.4539818397023568, 'support': 88569}}
[[12234  7733  9817]
 [ 7304 12775  9216]
 [ 7375  6819 15296]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0674776
{'0': {'precision': 0.4330660086366441, 'recall': 0.3871323529411765, 'f1-score': 0.4088129670969621, 'support': 10880}, '1': {'precision': 0.44350899074940237, 'recall': 0.3875215693397512, 'f1-score': 0.4136293136874758, 'support': 11011}, '2': {'precision': 0.4077226650158632, 'recall': 0.5076596974660372, 'f1-score': 0.45223585958286844, 'support': 10379}, 'accuracy': 0.4260303687635575, 'macro avg': {'precision': 0.42809922146730317, 'recall': 0.4274378732489883, 'f1-score': 0.42489271345576873, 'support': 32270}, 'weighted avg': {'precision': 0.42847812864295004, 'recall': 0.4260303687635575, 'f1-score': 0.42442248037305036, 'support': 32270}}
[[4212 2846 3822]
 [2912 4267 3832]
 [2602 2508 5269]]
training model: results/CHTR/W4/deepOF_L2/h30
Epoch 1/50
346/346 - 10s - loss: 3.3361 - accuracy30: 0.3530 - val_loss: 3.2908 - val_accuracy30: 0.3729 - 10s/epoch - 29ms/step
Epoch 2/50
346/346 - 8s - loss: 3.2903 - accuracy30: 0.3774 - val_loss: 3.2642 - val_accuracy30: 0.3897 - 8s/epoch - 24ms/step
Epoch 3/50
346/346 - 8s - loss: 3.2627 - accuracy30: 0.3900 - val_loss: 3.2480 - val_accuracy30: 0.3954 - 8s/epoch - 25ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2423 - accuracy30: 0.4036 - val_loss: 3.2366 - val_accuracy30: 0.4009 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2250 - accuracy30: 0.4129 - val_loss: 3.2292 - val_accuracy30: 0.4109 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2106 - accuracy30: 0.4210 - val_loss: 3.2284 - val_accuracy30: 0.4120 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2001 - accuracy30: 0.4259 - val_loss: 3.2194 - val_accuracy30: 0.4145 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 8s - loss: 3.1848 - accuracy30: 0.4351 - val_loss: 3.2221 - val_accuracy30: 0.4156 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 8s - loss: 3.1724 - accuracy30: 0.4402 - val_loss: 3.2192 - val_accuracy30: 0.4193 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.1610 - accuracy30: 0.4450 - val_loss: 3.2217 - val_accuracy30: 0.4186 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.1516 - accuracy30: 0.4486 - val_loss: 3.2208 - val_accuracy30: 0.4222 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 9s - loss: 3.1409 - accuracy30: 0.4522 - val_loss: 3.2190 - val_accuracy30: 0.4218 - 9s/epoch - 25ms/step
Epoch 13/50
346/346 - 8s - loss: 3.1301 - accuracy30: 0.4570 - val_loss: 3.2244 - val_accuracy30: 0.4206 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.1225 - accuracy30: 0.4597 - val_loss: 3.2285 - val_accuracy30: 0.4176 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.1099 - accuracy30: 0.4644 - val_loss: 3.2279 - val_accuracy30: 0.4198 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 9s - loss: 3.0990 - accuracy30: 0.4697 - val_loss: 3.2345 - val_accuracy30: 0.4192 - 9s/epoch - 25ms/step
Epoch 17/50
346/346 - 9s - loss: 3.0927 - accuracy30: 0.4720 - val_loss: 3.2378 - val_accuracy30: 0.4198 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 8s - loss: 3.0805 - accuracy30: 0.4759 - val_loss: 3.2499 - val_accuracy30: 0.4153 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.0694 - accuracy30: 0.4778 - val_loss: 3.2486 - val_accuracy30: 0.4202 - 8s/epoch - 24ms/step
Epoch 20/50
346/346 - 8s - loss: 3.0568 - accuracy30: 0.4849 - val_loss: 3.2596 - val_accuracy30: 0.4162 - 8s/epoch - 24ms/step
Epoch 21/50
346/346 - 9s - loss: 3.0479 - accuracy30: 0.4867 - val_loss: 3.2657 - val_accuracy30: 0.4174 - 9s/epoch - 25ms/step
Epoch 22/50
346/346 - 9s - loss: 3.0390 - accuracy30: 0.4918 - val_loss: 3.2785 - val_accuracy30: 0.4191 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepOF_L2/h30
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0965836
{'0': {'precision': 0.3746387915936953, 'recall': 0.4786055877170904, 'f1-score': 0.4202880754448224, 'support': 71514}, '1': {'precision': 0.4951767959438994, 'recall': 0.2997727861598868, 'f1-score': 0.3734589742634735, 'support': 100346}, '2': {'precision': 0.32232626327114516, 'recall': 0.42053061854079904, 'f1-score': 0.36493722057130623, 'support': 64830}, 'accuracy': 0.3868815750559804, 'macro avg': {'precision': 0.3973806169362466, 'recall': 0.3996363308059254, 'f1-score': 0.3862280900932007, 'support': 236690}, 'weighted avg': {'precision': 0.4114129914896548, 'recall': 0.3868815750559804, 'f1-score': 0.3852738842724295, 'support': 236690}}
[[34227 16847 20440]
 [33386 30081 36879]
 [23747 13820 27263]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0540242
{'0': {'precision': 0.4502451904941531, 'recall': 0.39773408863712095, 'f1-score': 0.42236376503892425, 'support': 30010}, '1': {'precision': 0.46072388177651336, 'recall': 0.3974774160559059, 'f1-score': 0.4267701260911736, 'support': 29335}, '2': {'precision': 0.43239639737694213, 'recall': 0.5437653983027648, 'f1-score': 0.4817279272451686, 'support': 29224}, 'accuracy': 0.4458331922004313, 'macro avg': {'precision': 0.4477884898825362, 'recall': 0.44632563433193057, 'f1-score': 0.44362060612508886, 'support': 88569}, 'weighted avg': {'precision': 0.4478265031284909, 'recall': 0.4458331922004313, 'f1-score': 0.4434108455951349, 'support': 88569}}
[[11936  7487 10587]
 [ 7402 11660 10273]
 [ 7172  6161 15891]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0744503
{'0': {'precision': 0.42371123327455656, 'recall': 0.37258299890550894, 'f1-score': 0.3965057024993934, 'support': 10964}, '1': {'precision': 0.4287983660501532, 'recall': 0.3499722170772365, 'f1-score': 0.3853959512518485, 'support': 10798}, '2': {'precision': 0.4064128546612623, 'recall': 0.5343547773125238, 'f1-score': 0.46168393356355863, 'support': 10508}, 'accuracy': 0.41769445305237063, 'macro avg': {'precision': 0.419640817995324, 'recall': 0.4189699977650898, 'f1-score': 0.4145285291049335, 'support': 32270}, 'weighted avg': {'precision': 0.4197806320115382, 'recall': 0.41769445305237063, 'f1-score': 0.4140120476512762, 'support': 32270}}
[[4085 2806 4073]
 [2891 3779 4128]
 [2665 2228 5615]]
training model: results/CHTR/W4/deepOF_L2/h50
Epoch 1/50
346/346 - 10s - loss: 3.3384 - accuracy50: 0.3509 - val_loss: 3.3036 - val_accuracy50: 0.3699 - 10s/epoch - 29ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2948 - accuracy50: 0.3740 - val_loss: 3.2789 - val_accuracy50: 0.3778 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 8s - loss: 3.2761 - accuracy50: 0.3819 - val_loss: 3.2572 - val_accuracy50: 0.3879 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2578 - accuracy50: 0.3946 - val_loss: 3.2493 - val_accuracy50: 0.3968 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2422 - accuracy50: 0.4033 - val_loss: 3.2432 - val_accuracy50: 0.3978 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2289 - accuracy50: 0.4103 - val_loss: 3.2385 - val_accuracy50: 0.4043 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2163 - accuracy50: 0.4188 - val_loss: 3.2369 - val_accuracy50: 0.4063 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 8s - loss: 3.2035 - accuracy50: 0.4272 - val_loss: 3.2323 - val_accuracy50: 0.4132 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 8s - loss: 3.1928 - accuracy50: 0.4308 - val_loss: 3.2314 - val_accuracy50: 0.4164 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.1835 - accuracy50: 0.4362 - val_loss: 3.2320 - val_accuracy50: 0.4173 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.1757 - accuracy50: 0.4388 - val_loss: 3.2333 - val_accuracy50: 0.4178 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 3.1646 - accuracy50: 0.4451 - val_loss: 3.2318 - val_accuracy50: 0.4189 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.1559 - accuracy50: 0.4466 - val_loss: 3.2435 - val_accuracy50: 0.4116 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.1469 - accuracy50: 0.4508 - val_loss: 3.2440 - val_accuracy50: 0.4143 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.1370 - accuracy50: 0.4556 - val_loss: 3.2472 - val_accuracy50: 0.4172 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.1305 - accuracy50: 0.4575 - val_loss: 3.2504 - val_accuracy50: 0.4148 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.1187 - accuracy50: 0.4615 - val_loss: 3.2578 - val_accuracy50: 0.4103 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.1105 - accuracy50: 0.4652 - val_loss: 3.2605 - val_accuracy50: 0.4103 - 8s/epoch - 25ms/step
Epoch 19/50
346/346 - 8s - loss: 3.0994 - accuracy50: 0.4680 - val_loss: 3.2636 - val_accuracy50: 0.4122 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h50
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.096332
{'0': {'precision': 0.37297855258630574, 'recall': 0.48711140160954286, 'f1-score': 0.4224723347466134, 'support': 73437}, '1': {'precision': 0.46621779754082127, 'recall': 0.2727579124756438, 'f1-score': 0.34416447385907556, 'support': 94945}, '2': {'precision': 0.33494849473214916, 'recall': 0.4179451894360836, 'f1-score': 0.3718721913222441, 'support': 68308}, 'accuracy': 0.38116523723013224, 'macro avg': {'precision': 0.39138161495309204, 'recall': 0.39260483450709005, 'f1-score': 0.37950299997597764, 'support': 236690}, 'weighted avg': {'precision': 0.39940486092339117, 'recall': 0.38116523723013224, 'f1-score': 0.3764571484311835, 'support': 236690}}
[[35772 15980 21685]
 [34048 25897 35000]
 [26089 13670 28549]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0682219
{'0': {'precision': 0.4272646798465624, 'recall': 0.3819446734148834, 'f1-score': 0.40333559652513007, 'support': 30329}, '1': {'precision': 0.43898759637948376, 'recall': 0.36150315745884953, 'f1-score': 0.3964952784664005, 'support': 28979}, '2': {'precision': 0.4200516053520602, 'recall': 0.5396602986910906, 'f1-score': 0.4724025488377659, 'support': 29261}, 'accuracy': 0.4273617179825899, 'macro avg': {'precision': 0.42876796052603544, 'recall': 0.42770270985494113, 'f1-score': 0.42407780794309885, 'support': 88569}, 'weighted avg': {'precision': 0.4287172944794916, 'recall': 0.4273617179825899, 'f1-score': 0.4239155117843756, 'support': 88569}}
[[11584  7401 11344]
 [ 8045 10476 10458]
 [ 7483  5987 15791]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0767822
{'0': {'precision': 0.41201672957257984, 'recall': 0.36751592356687895, 'f1-score': 0.3884961285047852, 'support': 10990}, '1': {'precision': 0.41916596964989844, 'recall': 0.33361864003804087, 'f1-score': 0.3715314552001694, 'support': 10515}, '2': {'precision': 0.4179316215065967, 'recall': 0.547329307942406, 'f1-score': 0.47395728592687936, 'support': 10765}, 'accuracy': 0.4164549116826774, 'macro avg': {'precision': 0.41637144024302497, 'recall': 0.41615462384910856, 'f1-score': 0.41132828987727804, 'support': 32270}, 'weighted avg': {'precision': 0.41631942777780756, 'recall': 0.4164549116826774, 'f1-score': 0.4114774058475434, 'support': 32270}}
[[4039 2756 4195]
 [2996 3508 4011]
 [2768 2105 5892]]
training model: results/CHTR/W4/deepOF_L2/h100
Epoch 1/50
346/346 - 11s - loss: 3.3448 - accuracy100: 0.3488 - val_loss: 3.3314 - val_accuracy100: 0.3506 - 11s/epoch - 31ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3062 - accuracy100: 0.3649 - val_loss: 3.2994 - val_accuracy100: 0.3641 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 8s - loss: 3.2906 - accuracy100: 0.3709 - val_loss: 3.2873 - val_accuracy100: 0.3702 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2782 - accuracy100: 0.3797 - val_loss: 3.2795 - val_accuracy100: 0.3746 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2654 - accuracy100: 0.3882 - val_loss: 3.2733 - val_accuracy100: 0.3797 - 8s/epoch - 25ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2542 - accuracy100: 0.3957 - val_loss: 3.2690 - val_accuracy100: 0.3823 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2428 - accuracy100: 0.4047 - val_loss: 3.2628 - val_accuracy100: 0.3883 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 8s - loss: 3.2291 - accuracy100: 0.4113 - val_loss: 3.2620 - val_accuracy100: 0.3917 - 8s/epoch - 24ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2196 - accuracy100: 0.4165 - val_loss: 3.2585 - val_accuracy100: 0.3966 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 8s - loss: 3.2103 - accuracy100: 0.4224 - val_loss: 3.2568 - val_accuracy100: 0.3988 - 8s/epoch - 25ms/step
Epoch 11/50
346/346 - 9s - loss: 3.1998 - accuracy100: 0.4275 - val_loss: 3.2583 - val_accuracy100: 0.4004 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 8s - loss: 3.1915 - accuracy100: 0.4306 - val_loss: 3.2635 - val_accuracy100: 0.3987 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.1846 - accuracy100: 0.4343 - val_loss: 3.2610 - val_accuracy100: 0.4017 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 9s - loss: 3.1763 - accuracy100: 0.4373 - val_loss: 3.2659 - val_accuracy100: 0.4014 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 8s - loss: 3.1676 - accuracy100: 0.4413 - val_loss: 3.2754 - val_accuracy100: 0.3989 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.1592 - accuracy100: 0.4483 - val_loss: 3.2762 - val_accuracy100: 0.3958 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.1518 - accuracy100: 0.4488 - val_loss: 3.2849 - val_accuracy100: 0.3949 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.1442 - accuracy100: 0.4537 - val_loss: 3.2877 - val_accuracy100: 0.3940 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.1331 - accuracy100: 0.4572 - val_loss: 3.2964 - val_accuracy100: 0.3914 - 8s/epoch - 24ms/step
Epoch 20/50
346/346 - 8s - loss: 3.1236 - accuracy100: 0.4594 - val_loss: 3.3002 - val_accuracy100: 0.3945 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h100
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987614
{'0': {'precision': 0.3694083880643326, 'recall': 0.3851483413536064, 'f1-score': 0.37711419804005675, 'support': 74187}, '1': {'precision': 0.425550274976495, 'recall': 0.3570070232306861, 'f1-score': 0.388276838647888, 'support': 92550}, '2': {'precision': 0.3312402844588061, 'recall': 0.38685974868840506, 'f1-score': 0.35689605148629755, 'support': 69953}, 'accuracy': 0.37465038658160466, 'macro avg': {'precision': 0.37539964916654456, 'recall': 0.3763383710908992, 'f1-score': 0.37409569605808074, 'support': 236690}, 'weighted avg': {'precision': 0.3800803990584737, 'recall': 0.37465038658160466, 'f1-score': 0.37550357816756386, 'support': 236690}}
[[28573 23547 22067]
 [26939 33041 32570]
 [21836 21055 27062]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0771862
{'0': {'precision': 0.4272539633744675, 'recall': 0.32166236857766317, 'f1-score': 0.36701435388648923, 'support': 30246}, '1': {'precision': 0.40729370487821337, 'recall': 0.4134022736611423, 'f1-score': 0.4103252557523026, 'support': 29204}, '2': {'precision': 0.4046354685252793, 'recall': 0.5024210996256739, 'f1-score': 0.4482573726541555, 'support': 29119}, 'accuracy': 0.41134031094400975, 'macro avg': {'precision': 0.4130610455926534, 'recall': 0.4124952472881598, 'f1-score': 0.40853232743098244, 'support': 88569}, 'weighted avg': {'precision': 0.4132361090389989, 'recall': 0.41134031094400975, 'f1-score': 0.4080057508943011, 'support': 88569}}
[[ 9729  9516 11001]
 [ 6606 12073 10525]
 [ 6436  8053 14630]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865713
{'0': {'precision': 0.4072512647554806, 'recall': 0.30666666666666664, 'f1-score': 0.3498732343353857, 'support': 11025}, '1': {'precision': 0.37543119969336913, 'recall': 0.38930842607313193, 'f1-score': 0.38224390243902434, 'support': 10064}, '2': {'precision': 0.417307123854567, 'recall': 0.5050532152759145, 'f1-score': 0.45700643386072104, 'support': 11181}, 'accuracy': 0.40117756430120854, 'macro avg': {'precision': 0.3999965294344722, 'recall': 0.400342769338571, 'f1-score': 0.3963745235450437, 'support': 32270}, 'weighted avg': {'precision': 0.4008117675692951, 'recall': 0.40117756430120854, 'f1-score': 0.39708844064737187, 'support': 32270}}
[[3381 3471 4173]
 [2434 3918 3712]
 [2487 3047 5647]]
training model: results/CHTR/W4/deepOF_L2/h200
Epoch 1/50
346/346 - 10s - loss: 3.3461 - accuracy200: 0.3474 - val_loss: 3.3459 - val_accuracy200: 0.3423 - 10s/epoch - 29ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3144 - accuracy200: 0.3560 - val_loss: 3.3286 - val_accuracy200: 0.3477 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 8s - loss: 3.3005 - accuracy200: 0.3615 - val_loss: 3.3152 - val_accuracy200: 0.3497 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2881 - accuracy200: 0.3691 - val_loss: 3.3058 - val_accuracy200: 0.3536 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2773 - accuracy200: 0.3799 - val_loss: 3.3024 - val_accuracy200: 0.3615 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2665 - accuracy200: 0.3855 - val_loss: 3.2953 - val_accuracy200: 0.3655 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2605 - accuracy200: 0.3907 - val_loss: 3.2908 - val_accuracy200: 0.3698 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2471 - accuracy200: 0.4005 - val_loss: 3.2882 - val_accuracy200: 0.3750 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 8s - loss: 3.2415 - accuracy200: 0.4022 - val_loss: 3.2830 - val_accuracy200: 0.3823 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.2309 - accuracy200: 0.4091 - val_loss: 3.2843 - val_accuracy200: 0.3823 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.2231 - accuracy200: 0.4135 - val_loss: 3.2833 - val_accuracy200: 0.3858 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 3.2158 - accuracy200: 0.4168 - val_loss: 3.2849 - val_accuracy200: 0.3874 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.2084 - accuracy200: 0.4221 - val_loss: 3.2859 - val_accuracy200: 0.3865 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.2018 - accuracy200: 0.4229 - val_loss: 3.2912 - val_accuracy200: 0.3886 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.1941 - accuracy200: 0.4280 - val_loss: 3.2914 - val_accuracy200: 0.3899 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.1844 - accuracy200: 0.4328 - val_loss: 3.3025 - val_accuracy200: 0.3833 - 8s/epoch - 25ms/step
Epoch 17/50
346/346 - 8s - loss: 3.1777 - accuracy200: 0.4355 - val_loss: 3.3063 - val_accuracy200: 0.3807 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.1678 - accuracy200: 0.4412 - val_loss: 3.3093 - val_accuracy200: 0.3837 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.1588 - accuracy200: 0.4432 - val_loss: 3.3247 - val_accuracy200: 0.3816 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h200
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101504
{'0': {'precision': 0.35612750226686196, 'recall': 0.3426435454862696, 'f1-score': 0.34925542612062305, 'support': 74506}, '1': {'precision': 0.40648618270609665, 'recall': 0.4746393618826724, 'f1-score': 0.4379270208623668, 'support': 88385}, '2': {'precision': 0.34124043300270224, 'recall': 0.2857626797111072, 'f1-score': 0.311047197640118, 'support': 73799}, 'accuracy': 0.3741983184756432, 'macro avg': {'precision': 0.36795137265855365, 'recall': 0.36768186236001643, 'f1-score': 0.3660765482077026, 'support': 236690}, 'weighted avg': {'precision': 0.3702907586190358, 'recall': 0.3741983184756432, 'f1-score': 0.37045408194730023, 'support': 236690}}
[[25529 30658 18319]
 [24041 41951 22393]
 [22115 30595 21089]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088274
{'0': {'precision': 0.4005656375206222, 'recall': 0.284100026745119, 'f1-score': 0.3324270933166429, 'support': 29912}, '1': {'precision': 0.37844639561545773, 'recall': 0.4611400729156019, 'f1-score': 0.4157208459400101, 'support': 29349}, '2': {'precision': 0.3955431754874652, 'recall': 0.42636822710522726, 'f1-score': 0.4103776683087028, 'support': 29308}, 'accuracy': 0.3898429473066197, 'macro avg': {'precision': 0.39151840287451506, 'recall': 0.3905361089219827, 'f1-score': 0.3861752025217853, 'support': 88569}, 'weighted avg': {'precision': 0.39157404962934605, 'recall': 0.3898429473066197, 'f1-score': 0.3858223421916499, 'support': 88569}}
[[ 8498 11644  9770]
 [ 6489 13534  9326]
 [ 6228 10584 12496]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959797
{'0': {'precision': 0.38924256203715735, 'recall': 0.2710576314122863, 'f1-score': 0.3195733333333333, 'support': 11053}, '1': {'precision': 0.3322098812715435, 'recall': 0.45158267388588086, 'f1-score': 0.38280594907100934, 'support': 9604}, '2': {'precision': 0.42698385136308387, 'recall': 0.42349091535348315, 'f1-score': 0.42523021053996796, 'support': 11613}, 'accuracy': 0.379640533002789, 'macro avg': {'precision': 0.38281209822392825, 'recall': 0.38204374021721677, 'f1-score': 0.37586983098143684, 'support': 32270}, 'weighted avg': {'precision': 0.38585079652333737, 'recall': 0.379640533002789, 'f1-score': 0.3764149619836366, 'support': 32270}}
[[2996 4447 3610]
 [2277 4337 2990]
 [2424 4271 4918]]
training model: results/CHTR/W4/deepOF_L2/h300
Epoch 1/50
346/346 - 10s - loss: 3.3465 - accuracy300: 0.3453 - val_loss: 3.3406 - val_accuracy300: 0.3487 - 10s/epoch - 29ms/step
Epoch 2/50
346/346 - 8s - loss: 3.3173 - accuracy300: 0.3529 - val_loss: 3.3196 - val_accuracy300: 0.3556 - 8s/epoch - 24ms/step
Epoch 3/50
346/346 - 8s - loss: 3.3050 - accuracy300: 0.3579 - val_loss: 3.3140 - val_accuracy300: 0.3520 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.2968 - accuracy300: 0.3621 - val_loss: 3.3088 - val_accuracy300: 0.3574 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2872 - accuracy300: 0.3698 - val_loss: 3.3071 - val_accuracy300: 0.3586 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2794 - accuracy300: 0.3745 - val_loss: 3.3053 - val_accuracy300: 0.3563 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2741 - accuracy300: 0.3796 - val_loss: 3.2995 - val_accuracy300: 0.3645 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2638 - accuracy300: 0.3869 - val_loss: 3.2941 - val_accuracy300: 0.3694 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2569 - accuracy300: 0.3919 - val_loss: 3.2910 - val_accuracy300: 0.3744 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 8s - loss: 3.2484 - accuracy300: 0.3981 - val_loss: 3.2932 - val_accuracy300: 0.3754 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2415 - accuracy300: 0.4014 - val_loss: 3.2954 - val_accuracy300: 0.3701 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 8s - loss: 3.2340 - accuracy300: 0.4066 - val_loss: 3.2970 - val_accuracy300: 0.3708 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2276 - accuracy300: 0.4101 - val_loss: 3.2986 - val_accuracy300: 0.3739 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 8s - loss: 3.2206 - accuracy300: 0.4144 - val_loss: 3.2975 - val_accuracy300: 0.3754 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.2145 - accuracy300: 0.4191 - val_loss: 3.3061 - val_accuracy300: 0.3700 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.2084 - accuracy300: 0.4211 - val_loss: 3.3062 - val_accuracy300: 0.3724 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.1989 - accuracy300: 0.4260 - val_loss: 3.3118 - val_accuracy300: 0.3720 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.1929 - accuracy300: 0.4284 - val_loss: 3.3141 - val_accuracy300: 0.3705 - 8s/epoch - 24ms/step
Epoch 19/50
346/346 - 8s - loss: 3.1861 - accuracy300: 0.4305 - val_loss: 3.3208 - val_accuracy300: 0.3733 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h300
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005853
{'0': {'precision': 0.3306985935138905, 'recall': 0.3551711701714476, 'f1-score': 0.3424982778108468, 'support': 72092}, '1': {'precision': 0.415304052655545, 'recall': 0.4490723126161008, 'f1-score': 0.43152857680520457, 'support': 89362}, '2': {'precision': 0.34277959607248343, 'recall': 0.28536870647030677, 'f1-score': 0.31145055885574197, 'support': 75236}, 'accuracy': 0.368435506358528, 'macro avg': {'precision': 0.3629274140806397, 'recall': 0.3632040630859517, 'f1-score': 0.36182580449059776, 'support': 236690}, 'weighted avg': {'precision': 0.36648142907227843, 'recall': 0.368435506358528, 'f1-score': 0.3662424976571755, 'support': 236690}}
[[25605 27535 18952]
 [27019 40130 22213]
 [24803 28963 21470]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0892646
{'0': {'precision': 0.3887759815242494, 'recall': 0.281674586707717, 'f1-score': 0.3266708064891718, 'support': 29882}, '1': {'precision': 0.3783415538054882, 'recall': 0.47393753200204813, 'f1-score': 0.42077827615468544, 'support': 29295}, '2': {'precision': 0.39203229435510556, 'recall': 0.40310288513881326, 'f1-score': 0.39749052236051935, 'support': 29392}, 'accuracy': 0.3855637977170342, 'macro avg': {'precision': 0.3863832765616144, 'recall': 0.3862383346161928, 'f1-score': 0.38164653500145884, 'support': 88569}, 'weighted avg': {'precision': 0.38640532121085996, 'recall': 0.3855637977170342, 'f1-score': 0.381299530001257, 'support': 88569}}
[[ 8417 11927  9538]
 [ 6575 13884  8836]
 [ 6658 10886 11848]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968136
{'0': {'precision': 0.3694482672338296, 'recall': 0.2720906661752511, 'f1-score': 0.31338215005836784, 'support': 10853}, '1': {'precision': 0.3527275478550352, 'recall': 0.4670874661857529, 'f1-score': 0.40193120096560053, 'support': 9981}, '2': {'precision': 0.40415913200723325, 'recall': 0.39087093389296956, 'f1-score': 0.3974039829302987, 'support': 11436}, 'accuracy': 0.3744964363185621, 'macro avg': {'precision': 0.37544498236536605, 'recall': 0.3766830220846578, 'f1-score': 0.3709057779847557, 'support': 32270}, 'weighted avg': {'precision': 0.37657761180863275, 'recall': 0.3744964363185621, 'f1-score': 0.37054613387703816, 'support': 32270}}
[[2953 4298 3602]
 [2331 4662 2988]
 [2709 4257 4470]]
training model: results/CHTR/W4/deepOF_L2/h500
Epoch 1/50
346/346 - 11s - loss: 3.3493 - accuracy500: 0.3423 - val_loss: 3.3496 - val_accuracy500: 0.3411 - 11s/epoch - 31ms/step
Epoch 2/50
346/346 - 8s - loss: 3.3233 - accuracy500: 0.3471 - val_loss: 3.3296 - val_accuracy500: 0.3433 - 8s/epoch - 24ms/step
Epoch 3/50
346/346 - 8s - loss: 3.3107 - accuracy500: 0.3515 - val_loss: 3.3268 - val_accuracy500: 0.3398 - 8s/epoch - 24ms/step
Epoch 4/50
346/346 - 8s - loss: 3.3016 - accuracy500: 0.3543 - val_loss: 3.3220 - val_accuracy500: 0.3418 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2924 - accuracy500: 0.3603 - val_loss: 3.3196 - val_accuracy500: 0.3388 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2866 - accuracy500: 0.3645 - val_loss: 3.3162 - val_accuracy500: 0.3447 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 8s - loss: 3.2823 - accuracy500: 0.3693 - val_loss: 3.3159 - val_accuracy500: 0.3462 - 8s/epoch - 24ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2741 - accuracy500: 0.3756 - val_loss: 3.3137 - val_accuracy500: 0.3481 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 8s - loss: 3.2711 - accuracy500: 0.3782 - val_loss: 3.3156 - val_accuracy500: 0.3513 - 8s/epoch - 24ms/step
Epoch 10/50
346/346 - 8s - loss: 3.2619 - accuracy500: 0.3863 - val_loss: 3.3147 - val_accuracy500: 0.3540 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.2558 - accuracy500: 0.3897 - val_loss: 3.3153 - val_accuracy500: 0.3546 - 8s/epoch - 25ms/step
Epoch 12/50
346/346 - 8s - loss: 3.2509 - accuracy500: 0.3920 - val_loss: 3.3190 - val_accuracy500: 0.3532 - 8s/epoch - 25ms/step
Epoch 13/50
346/346 - 8s - loss: 3.2444 - accuracy500: 0.3979 - val_loss: 3.3235 - val_accuracy500: 0.3529 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 8s - loss: 3.2375 - accuracy500: 0.4016 - val_loss: 3.3228 - val_accuracy500: 0.3604 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.2295 - accuracy500: 0.4052 - val_loss: 3.3263 - val_accuracy500: 0.3589 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.2245 - accuracy500: 0.4087 - val_loss: 3.3303 - val_accuracy500: 0.3575 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.2160 - accuracy500: 0.4152 - val_loss: 3.3342 - val_accuracy500: 0.3618 - 8s/epoch - 24ms/step
Epoch 18/50
346/346 - 8s - loss: 3.2079 - accuracy500: 0.4189 - val_loss: 3.3340 - val_accuracy500: 0.3618 - 8s/epoch - 25ms/step
testing model: results/CHTR/W4/deepOF_L2/h500
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100693
{'0': {'precision': 0.32909988029546583, 'recall': 0.3162250494452315, 'f1-score': 0.3225340324622835, 'support': 71291}, '1': {'precision': 0.401382618510158, 'recall': 0.5489348178918815, 'f1-score': 0.4637037818248059, 'support': 88107}, '2': {'precision': 0.3393860605552294, 'recall': 0.20941365212441132, 'f1-score': 0.259009153171606, 'support': 77292}, 'accuracy': 0.36797076344585744, 'macro avg': {'precision': 0.3566228531202844, 'recall': 0.35819117315384147, 'f1-score': 0.3484156558195652, 'support': 236690}, 'weighted avg': {'precision': 0.3593658596799752, 'recall': 0.36797076344585744, 'f1-score': 0.35433967755480417, 'support': 236690}}
[[22544 33780 14967]
 [23203 48365 16539]
 [22755 38351 16186]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944299
{'0': {'precision': 0.3856146515466113, 'recall': 0.24273601662254096, 'f1-score': 0.297930977746699, 'support': 29839}, '1': {'precision': 0.35821946169772256, 'recall': 0.5925748338927324, 'f1-score': 0.4465147487677101, 'support': 29198}, '2': {'precision': 0.38518104812436005, 'recall': 0.2802383854801571, 'f1-score': 0.3244345133090282, 'support': 29532}, 'accuracy': 0.3705698382052411, 'macro avg': {'precision': 0.37633838712289797, 'recall': 0.37184974533181014, 'f1-score': 0.3562934132744791, 'support': 88569}, 'weighted avg': {'precision': 0.376438868490759, 'recall': 0.3705698382052411, 'f1-score': 0.35575088492074625, 'support': 88569}}
[[ 7243 15714  6882]
 [ 5568 17302  6328]
 [ 5972 15284  8276]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052635
{'0': {'precision': 0.34927759854116985, 'recall': 0.23076923076923078, 'f1-score': 0.27791729449188013, 'support': 10790}, '1': {'precision': 0.3276283618581907, 'recall': 0.5718931002946855, 'f1-score': 0.41659572893149266, 'support': 9841}, '2': {'precision': 0.3895516765038302, 'recall': 0.26651774207406137, 'f1-score': 0.3164983164983165, 'support': 11639}, 'accuracy': 0.34769135419894637, 'macro avg': {'precision': 0.35548587896773026, 'recall': 0.35639335771265923, 'f1-score': 0.33700377997389647, 'support': 32270}, 'weighted avg': {'precision': 0.35720136226011023, 'recall': 0.34769135419894637, 'f1-score': 0.33412364678357953, 'support': 32270}}
[[2490 5704 2596]
 [1948 5628 2265]
 [2691 5846 3102]]
training model: results/CHTR/W4/deepOF_L2/h1000
Epoch 1/50
346/346 - 10s - loss: 3.3593 - accuracy1000: 0.3376 - val_loss: 3.3369 - val_accuracy1000: 0.3423 - 10s/epoch - 29ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3303 - accuracy1000: 0.3440 - val_loss: 3.3213 - val_accuracy1000: 0.3436 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3157 - accuracy1000: 0.3437 - val_loss: 3.3159 - val_accuracy1000: 0.3460 - 9s/epoch - 25ms/step
Epoch 4/50
346/346 - 8s - loss: 3.3063 - accuracy1000: 0.3487 - val_loss: 3.3130 - val_accuracy1000: 0.3485 - 8s/epoch - 24ms/step
Epoch 5/50
346/346 - 8s - loss: 3.2975 - accuracy1000: 0.3562 - val_loss: 3.3102 - val_accuracy1000: 0.3518 - 8s/epoch - 24ms/step
Epoch 6/50
346/346 - 8s - loss: 3.2908 - accuracy1000: 0.3611 - val_loss: 3.3082 - val_accuracy1000: 0.3509 - 8s/epoch - 24ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2860 - accuracy1000: 0.3650 - val_loss: 3.3062 - val_accuracy1000: 0.3533 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2788 - accuracy1000: 0.3695 - val_loss: 3.3076 - val_accuracy1000: 0.3539 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 8s - loss: 3.2745 - accuracy1000: 0.3759 - val_loss: 3.3083 - val_accuracy1000: 0.3545 - 8s/epoch - 25ms/step
Epoch 10/50
346/346 - 8s - loss: 3.2698 - accuracy1000: 0.3794 - val_loss: 3.3106 - val_accuracy1000: 0.3556 - 8s/epoch - 24ms/step
Epoch 11/50
346/346 - 8s - loss: 3.2642 - accuracy1000: 0.3851 - val_loss: 3.3161 - val_accuracy1000: 0.3524 - 8s/epoch - 24ms/step
Epoch 12/50
346/346 - 8s - loss: 3.2604 - accuracy1000: 0.3863 - val_loss: 3.3148 - val_accuracy1000: 0.3563 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2533 - accuracy1000: 0.3917 - val_loss: 3.3188 - val_accuracy1000: 0.3569 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 8s - loss: 3.2463 - accuracy1000: 0.3956 - val_loss: 3.3201 - val_accuracy1000: 0.3586 - 8s/epoch - 24ms/step
Epoch 15/50
346/346 - 8s - loss: 3.2426 - accuracy1000: 0.3989 - val_loss: 3.3241 - val_accuracy1000: 0.3578 - 8s/epoch - 24ms/step
Epoch 16/50
346/346 - 8s - loss: 3.2355 - accuracy1000: 0.4029 - val_loss: 3.3271 - val_accuracy1000: 0.3550 - 8s/epoch - 24ms/step
Epoch 17/50
346/346 - 8s - loss: 3.2286 - accuracy1000: 0.4064 - val_loss: 3.3312 - val_accuracy1000: 0.3606 - 8s/epoch - 24ms/step
testing model: results/CHTR/W4/deepOF_L2/h1000
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001093
{'0': {'precision': 0.32306403115295507, 'recall': 0.2794644380010234, 'f1-score': 0.2996867783899952, 'support': 70356}, '1': {'precision': 0.3977204395123818, 'recall': 0.49528574832363254, 'f1-score': 0.4411733495035246, 'support': 88137}, '2': {'precision': 0.3416173510314662, 'recall': 0.288642786807678, 'f1-score': 0.31290376244212165, 'support': 78197}, 'accuracy': 0.3628628163420508, 'macro avg': {'precision': 0.354133940565601, 'recall': 0.35446432437744463, 'f1-score': 0.35125463011188046, 'support': 236690}, 'weighted avg': {'precision': 0.35699366830752316, 'recall': 0.3628628163420508, 'f1-score': 0.35673916936619726, 'support': 236690}}
[[19662 30270 20424]
 [21408 43653 23076]
 [19791 35835 22571]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096007
{'0': {'precision': 0.3722160970231532, 'recall': 0.22871853934487313, 'f1-score': 0.28333438240909753, 'support': 29521}, '1': {'precision': 0.36391429947039, 'recall': 0.515674569333106, 'f1-score': 0.4267024204361019, 'support': 29315}, '2': {'precision': 0.3707293433486794, 'recall': 0.3602058319039451, 'f1-score': 0.36539183241786355, 'support': 29733}, 'accuracy': 0.3678375052219174, 'macro avg': {'precision': 0.3689532466140742, 'recall': 0.36819964686064144, 'f1-score': 0.35847621175435435, 'support': 88569}, 'weighted avg': {'precision': 0.3689692178412455, 'recall': 0.3678375052219174, 'f1-score': 0.3583340797735509, 'support': 88569}}
[[ 6752 13303  9466]
 [ 5485 15117  8713]
 [ 5903 13120 10710]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10307
{'0': {'precision': 0.3345842089462624, 'recall': 0.209689557855127, 'f1-score': 0.2578070784177654, 'support': 10630}, '1': {'precision': 0.3322751322751323, 'recall': 0.5121304791029562, 'f1-score': 0.4030485359005215, 'support': 9810}, '2': {'precision': 0.3913996948893974, 'recall': 0.34699915469146236, 'f1-score': 0.36786450398781256, 'support': 11830}, 'accuracy': 0.351967771924388, 'macro avg': {'precision': 0.3527530120369307, 'recall': 0.35627306388318186, 'f1-score': 0.34290670610203317, 'support': 32270}, 'weighted avg': {'precision': 0.3547104920749733, 'recall': 0.351967771924388, 'f1-score': 0.3423065529265815, 'support': 32270}}
[[2229 4921 3480]
 [1883 5024 2903]
 [2550 5175 4105]]
training model: results/CHTR/W4/deepVOL_L2/h10
Epoch 1/50
346/346 - 11s - loss: 3.3301 - accuracy10: 0.3613 - val_loss: 3.3595 - val_accuracy10: 0.3437 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2955 - accuracy10: 0.3695 - val_loss: 3.3094 - val_accuracy10: 0.3542 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 9s - loss: 3.2885 - accuracy10: 0.3694 - val_loss: 3.3084 - val_accuracy10: 0.3482 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.2816 - accuracy10: 0.3700 - val_loss: 3.2935 - val_accuracy10: 0.3549 - 9s/epoch - 25ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2704 - accuracy10: 0.3791 - val_loss: 3.2718 - val_accuracy10: 0.3765 - 9s/epoch - 26ms/step
Epoch 6/50
346/346 - 9s - loss: 3.2633 - accuracy10: 0.3840 - val_loss: 3.2755 - val_accuracy10: 0.3631 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2575 - accuracy10: 0.3874 - val_loss: 3.2581 - val_accuracy10: 0.3889 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2519 - accuracy10: 0.3887 - val_loss: 3.2588 - val_accuracy10: 0.3851 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2439 - accuracy10: 0.3943 - val_loss: 3.2588 - val_accuracy10: 0.3784 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2409 - accuracy10: 0.3963 - val_loss: 3.2506 - val_accuracy10: 0.3956 - 9s/epoch - 26ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2353 - accuracy10: 0.3971 - val_loss: 3.2412 - val_accuracy10: 0.4051 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2310 - accuracy10: 0.4002 - val_loss: 3.2416 - val_accuracy10: 0.4027 - 9s/epoch - 25ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2257 - accuracy10: 0.4045 - val_loss: 3.2407 - val_accuracy10: 0.4074 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2218 - accuracy10: 0.4043 - val_loss: 3.2311 - val_accuracy10: 0.4116 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2173 - accuracy10: 0.4082 - val_loss: 3.2297 - val_accuracy10: 0.4126 - 9s/epoch - 25ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2143 - accuracy10: 0.4078 - val_loss: 3.2346 - val_accuracy10: 0.4052 - 9s/epoch - 26ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2093 - accuracy10: 0.4096 - val_loss: 3.2307 - val_accuracy10: 0.4118 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2068 - accuracy10: 0.4100 - val_loss: 3.2340 - val_accuracy10: 0.4119 - 9s/epoch - 25ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2023 - accuracy10: 0.4146 - val_loss: 3.2327 - val_accuracy10: 0.4133 - 9s/epoch - 25ms/step
Epoch 20/50
346/346 - 9s - loss: 3.1971 - accuracy10: 0.4150 - val_loss: 3.2334 - val_accuracy10: 0.4094 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 9s - loss: 3.1954 - accuracy10: 0.4166 - val_loss: 3.2357 - val_accuracy10: 0.4090 - 9s/epoch - 25ms/step
Epoch 22/50
346/346 - 9s - loss: 3.1924 - accuracy10: 0.4183 - val_loss: 3.2403 - val_accuracy10: 0.4005 - 9s/epoch - 25ms/step
Epoch 23/50
346/346 - 9s - loss: 3.1894 - accuracy10: 0.4196 - val_loss: 3.2329 - val_accuracy10: 0.4073 - 9s/epoch - 25ms/step
Epoch 24/50
346/346 - 9s - loss: 3.1878 - accuracy10: 0.4197 - val_loss: 3.2375 - val_accuracy10: 0.3966 - 9s/epoch - 25ms/step
Epoch 25/50
346/346 - 9s - loss: 3.1828 - accuracy10: 0.4194 - val_loss: 3.2333 - val_accuracy10: 0.4140 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepVOL_L2/h10
Evaluating performance on  test set...
925/925 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0608978
{'0': {'precision': 0.368326439707286, 'recall': 0.33028530670470757, 'f1-score': 0.34827015643802645, 'support': 70100}, '1': {'precision': 0.5027488446372798, 'recall': 0.6796133198326424, 'f1-score': 0.5779528838342812, 'support': 104686}, '2': {'precision': 0.3703898514851485, 'recall': 0.1933675776959359, 'f1-score': 0.25408583435921384, 'support': 61908}, 'accuracy': 0.44897631541145955, 'macro avg': {'precision': 0.4138217119432381, 'recall': 0.4010887347444286, 'f1-score': 0.3934362915438405, 'support': 236694}, 'weighted avg': {'precision': 0.42831902751620915, 'recall': 0.44897631541145955, 'f1-score': 0.4252210000967132, 'support': 236694}}
[[23153 37182  9765]
 [22956 71146 10584]
 [16751 33186 11971]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0689725
{'0': {'precision': 0.4102354543685542, 'recall': 0.35433123802480754, 'f1-score': 0.38023952095808383, 'support': 29749}, '1': {'precision': 0.3979993803390431, 'recall': 0.6212304397388511, 'f1-score': 0.485168948539826, 'support': 28949}, '2': {'precision': 0.4442874102549607, 'recall': 0.2630891805034815, 'f1-score': 0.3304808561636635, 'support': 29872}, 'accuracy': 0.41079372247939483, 'macro avg': {'precision': 0.4175074149875193, 'recall': 0.4128836194223801, 'f1-score': 0.3986297752205245, 'support': 88570}, 'weighted avg': {'precision': 0.41772080967123476, 'recall': 0.41079372247939483, 'f1-score': 0.39775347787718657, 'support': 88570}}
[[10541 13753  5455]
 [ 6590 17984  4375]
 [ 8564 13449  7859]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0769358
{'0': {'precision': 0.4000827044350253, 'recall': 0.35625517812758906, 'f1-score': 0.3768991040124659, 'support': 10863}, '1': {'precision': 0.41661620443260267, 'recall': 0.6251703771013176, 'f1-score': 0.5000181692648716, 'support': 11005}, '2': {'precision': 0.4095989480604865, 'recall': 0.23954628472555994, 'f1-score': 0.3022987808576454, 'support': 10403}, 'accuracy': 0.41033745468067306, 'macro avg': {'precision': 0.40876595230937146, 'recall': 0.4069906133181555, 'f1-score': 0.3930720180449943, 'support': 32271}, 'weighted avg': {'precision': 0.4087886215094579, 'recall': 0.41033745468067306, 'f1-score': 0.39483651380215723, 'support': 32271}}
[[3870 4946 2047]
 [2580 6880 1545]
 [3223 4688 2492]]
training model: results/CHTR/W4/deepVOL_L2/h20
Epoch 1/50
346/346 - 11s - loss: 3.3230 - accuracy20: 0.3649 - val_loss: 3.3510 - val_accuracy20: 0.3353 - 11s/epoch - 31ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2942 - accuracy20: 0.3750 - val_loss: 3.3415 - val_accuracy20: 0.3438 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 9s - loss: 3.2859 - accuracy20: 0.3751 - val_loss: 3.3276 - val_accuracy20: 0.3477 - 9s/epoch - 25ms/step
Epoch 4/50
346/346 - 9s - loss: 3.2825 - accuracy20: 0.3749 - val_loss: 3.2915 - val_accuracy20: 0.3510 - 9s/epoch - 25ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2808 - accuracy20: 0.3732 - val_loss: 3.2863 - val_accuracy20: 0.3732 - 9s/epoch - 25ms/step
Epoch 6/50
346/346 - 9s - loss: 3.2672 - accuracy20: 0.3802 - val_loss: 3.2792 - val_accuracy20: 0.3730 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2699 - accuracy20: 0.3801 - val_loss: 3.2818 - val_accuracy20: 0.3658 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2678 - accuracy20: 0.3805 - val_loss: 3.2685 - val_accuracy20: 0.3745 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2630 - accuracy20: 0.3827 - val_loss: 3.2579 - val_accuracy20: 0.3960 - 9s/epoch - 26ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2549 - accuracy20: 0.3904 - val_loss: 3.2529 - val_accuracy20: 0.3998 - 9s/epoch - 25ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2486 - accuracy20: 0.3949 - val_loss: 3.2538 - val_accuracy20: 0.4008 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2431 - accuracy20: 0.3984 - val_loss: 3.2538 - val_accuracy20: 0.3991 - 9s/epoch - 25ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2429 - accuracy20: 0.3984 - val_loss: 3.2473 - val_accuracy20: 0.4035 - 9s/epoch - 26ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2375 - accuracy20: 0.4012 - val_loss: 3.2427 - val_accuracy20: 0.4036 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2319 - accuracy20: 0.4043 - val_loss: 3.2476 - val_accuracy20: 0.4016 - 9s/epoch - 25ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2283 - accuracy20: 0.4049 - val_loss: 3.2478 - val_accuracy20: 0.4032 - 9s/epoch - 25ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2268 - accuracy20: 0.4072 - val_loss: 3.2440 - val_accuracy20: 0.4059 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2256 - accuracy20: 0.4063 - val_loss: 3.2460 - val_accuracy20: 0.3956 - 9s/epoch - 25ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2210 - accuracy20: 0.4074 - val_loss: 3.2389 - val_accuracy20: 0.4084 - 9s/epoch - 25ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2195 - accuracy20: 0.4100 - val_loss: 3.2438 - val_accuracy20: 0.4044 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2129 - accuracy20: 0.4122 - val_loss: 3.2423 - val_accuracy20: 0.4075 - 9s/epoch - 25ms/step
Epoch 22/50
346/346 - 9s - loss: 3.2093 - accuracy20: 0.4139 - val_loss: 3.2433 - val_accuracy20: 0.4076 - 9s/epoch - 25ms/step
Epoch 23/50
346/346 - 9s - loss: 3.2090 - accuracy20: 0.4144 - val_loss: 3.2486 - val_accuracy20: 0.4087 - 9s/epoch - 25ms/step
Epoch 24/50
346/346 - 9s - loss: 3.2048 - accuracy20: 0.4167 - val_loss: 3.2458 - val_accuracy20: 0.4078 - 9s/epoch - 25ms/step
Epoch 25/50
346/346 - 9s - loss: 3.2022 - accuracy20: 0.4176 - val_loss: 3.2442 - val_accuracy20: 0.4081 - 9s/epoch - 25ms/step
Epoch 26/50
346/346 - 9s - loss: 3.1982 - accuracy20: 0.4187 - val_loss: 3.2444 - val_accuracy20: 0.4068 - 9s/epoch - 25ms/step
Epoch 27/50
346/346 - 9s - loss: 3.1951 - accuracy20: 0.4197 - val_loss: 3.2488 - val_accuracy20: 0.4044 - 9s/epoch - 25ms/step
Epoch 28/50
346/346 - 9s - loss: 3.1920 - accuracy20: 0.4189 - val_loss: 3.2684 - val_accuracy20: 0.3763 - 9s/epoch - 26ms/step
Epoch 29/50
346/346 - 9s - loss: 3.1898 - accuracy20: 0.4207 - val_loss: 3.2446 - val_accuracy20: 0.4089 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepVOL_L2/h20
Evaluating performance on  test set...
925/925 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0709988
{'0': {'precision': 0.3728441304162765, 'recall': 0.3076652898367473, 'f1-score': 0.3371333122936119, 'support': 71178}, '1': {'precision': 0.4802491440944273, 'recall': 0.6684606051117461, 'f1-score': 0.5589360300765415, 'support': 102196}, '2': {'precision': 0.36091509856630827, 'recall': 0.20355337965887554, 'f1-score': 0.26029970110671297, 'support': 63320}, 'accuracy': 0.43559194571894516, 'macro avg': {'precision': 0.40466945769233736, 'recall': 0.393226424869123, 'f1-score': 0.3854563478256221, 'support': 236694}, 'weighted avg': {'precision': 0.4160265367346129, 'recall': 0.43559194571894516, 'f1-score': 0.4123453847846333, 'support': 236694}}
[[21899 38761 10518]
 [21577 68314 12305]
 [15259 35172 12889]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0722305
{'0': {'precision': 0.4231512383629018, 'recall': 0.32301967751667726, 'f1-score': 0.3663669372469251, 'support': 29831}, '1': {'precision': 0.39786537038993974, 'recall': 0.6434577522559475, 'f1-score': 0.49170051324914127, 'support': 29256}, '2': {'precision': 0.44565276199751125, 'recall': 0.27938133839839907, 'f1-score': 0.34345161155818704, 'support': 29483}, 'accuracy': 0.4143389409506605, 'macro avg': {'precision': 0.422223123583451, 'recall': 0.4152862560570079, 'f1-score': 0.4005063540180845, 'support': 88570}, 'weighted avg': {'precision': 0.4222891978063049, 'recall': 0.4143389409506605, 'f1-score': 0.4001384914101832, 'support': 88570}}
[[ 9636 14514  5681]
 [ 5866 18825  4565]
 [ 7270 13976  8237]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.080299
{'0': {'precision': 0.40707151876937203, 'recall': 0.3271217712177122, 'f1-score': 0.36274359367807274, 'support': 10840}, '1': {'precision': 0.41065341729735977, 'recall': 0.6435491172476233, 'f1-score': 0.5013754673062002, 'support': 11045}, '2': {'precision': 0.4039353703407455, 'recall': 0.2431157327171192, 'f1-score': 0.303540301737092, 'support': 10386}, 'accuracy': 0.4083852375197546, 'macro avg': {'precision': 0.40722010213582577, 'recall': 0.4045955403941515, 'f1-score': 0.38921978757378833, 'support': 32271}, 'weighted avg': {'precision': 0.4072881228926378, 'recall': 0.4083852375197546, 'f1-score': 0.3911376209509692, 'support': 32271}}
[[3546 5169 2125]
 [2336 7108 1601]
 [2829 5032 2525]]
training model: results/CHTR/W4/deepVOL_L2/h30
Epoch 1/50
346/346 - 11s - loss: 3.3166 - accuracy30: 0.3711 - val_loss: 3.3272 - val_accuracy30: 0.3471 - 11s/epoch - 33ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2911 - accuracy30: 0.3778 - val_loss: 3.3380 - val_accuracy30: 0.3465 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 9s - loss: 3.2933 - accuracy30: 0.3746 - val_loss: 3.2969 - val_accuracy30: 0.3539 - 9s/epoch - 25ms/step
Epoch 4/50
346/346 - 9s - loss: 3.2926 - accuracy30: 0.3569 - val_loss: 3.2867 - val_accuracy30: 0.3607 - 9s/epoch - 25ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2881 - accuracy30: 0.3595 - val_loss: 3.2798 - val_accuracy30: 0.3709 - 9s/epoch - 25ms/step
Epoch 6/50
346/346 - 9s - loss: 3.2816 - accuracy30: 0.3677 - val_loss: 3.2749 - val_accuracy30: 0.3765 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2768 - accuracy30: 0.3729 - val_loss: 3.2704 - val_accuracy30: 0.3838 - 9s/epoch - 26ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2697 - accuracy30: 0.3792 - val_loss: 3.2707 - val_accuracy30: 0.3778 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2662 - accuracy30: 0.3831 - val_loss: 3.2687 - val_accuracy30: 0.3870 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2637 - accuracy30: 0.3838 - val_loss: 3.2623 - val_accuracy30: 0.3926 - 9s/epoch - 25ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2591 - accuracy30: 0.3881 - val_loss: 3.2627 - val_accuracy30: 0.3915 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 8s - loss: 3.2552 - accuracy30: 0.3871 - val_loss: 3.2721 - val_accuracy30: 0.3767 - 8s/epoch - 24ms/step
Epoch 13/50
346/346 - 8s - loss: 3.2504 - accuracy30: 0.3920 - val_loss: 3.2625 - val_accuracy30: 0.3912 - 8s/epoch - 24ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2502 - accuracy30: 0.3917 - val_loss: 3.2606 - val_accuracy30: 0.3974 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2464 - accuracy30: 0.3923 - val_loss: 3.2593 - val_accuracy30: 0.3970 - 9s/epoch - 26ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2416 - accuracy30: 0.3948 - val_loss: 3.2613 - val_accuracy30: 0.3949 - 9s/epoch - 25ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2348 - accuracy30: 0.4025 - val_loss: 3.2559 - val_accuracy30: 0.3995 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2352 - accuracy30: 0.4002 - val_loss: 3.2552 - val_accuracy30: 0.3970 - 9s/epoch - 25ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2338 - accuracy30: 0.3993 - val_loss: 3.2507 - val_accuracy30: 0.4002 - 9s/epoch - 25ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2285 - accuracy30: 0.4034 - val_loss: 3.2545 - val_accuracy30: 0.3971 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2251 - accuracy30: 0.4043 - val_loss: 3.2542 - val_accuracy30: 0.3994 - 9s/epoch - 25ms/step
Epoch 22/50
346/346 - 9s - loss: 3.2225 - accuracy30: 0.4055 - val_loss: 3.2529 - val_accuracy30: 0.3993 - 9s/epoch - 25ms/step
Epoch 23/50
346/346 - 9s - loss: 3.2192 - accuracy30: 0.4084 - val_loss: 3.2532 - val_accuracy30: 0.4010 - 9s/epoch - 25ms/step
Epoch 24/50
346/346 - 9s - loss: 3.2157 - accuracy30: 0.4104 - val_loss: 3.2557 - val_accuracy30: 0.4022 - 9s/epoch - 25ms/step
Epoch 25/50
346/346 - 9s - loss: 3.2129 - accuracy30: 0.4091 - val_loss: 3.2687 - val_accuracy30: 0.3767 - 9s/epoch - 25ms/step
Epoch 26/50
346/346 - 9s - loss: 3.2131 - accuracy30: 0.4095 - val_loss: 3.2547 - val_accuracy30: 0.3999 - 9s/epoch - 25ms/step
Epoch 27/50
346/346 - 9s - loss: 3.2063 - accuracy30: 0.4145 - val_loss: 3.2557 - val_accuracy30: 0.4019 - 9s/epoch - 25ms/step
Epoch 28/50
346/346 - 9s - loss: 3.2043 - accuracy30: 0.4143 - val_loss: 3.2558 - val_accuracy30: 0.3978 - 9s/epoch - 25ms/step
Epoch 29/50
346/346 - 9s - loss: 3.2001 - accuracy30: 0.4151 - val_loss: 3.2621 - val_accuracy30: 0.4009 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepVOL_L2/h30
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0783517
{'0': {'precision': 0.3622009061841766, 'recall': 0.33422826299745506, 'f1-score': 0.3476528126249955, 'support': 71514}, '1': {'precision': 0.46121476943827805, 'recall': 0.6542531988679395, 'f1-score': 0.5410307545241784, 'support': 100348}, '2': {'precision': 0.37467818726855934, 'recall': 0.16386969397828233, 'f1-score': 0.22801463723480744, 'support': 64832}, 'accuracy': 0.4232426677482319, 'macro avg': {'precision': 0.39936462096367137, 'recall': 0.3841170519478923, 'f1-score': 0.3722327347946604, 'support': 236694}, 'weighted avg': {'precision': 0.4075961009803492, 'recall': 0.4232426677482319, 'f1-score': 0.3968670196889791, 'support': 236694}}
[[23902 39571  8041]
 [25005 65653  9690]
 [17084 37124 10624]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0756226
{'0': {'precision': 0.4116354791887333, 'recall': 0.3493474497269943, 'f1-score': 0.37794226232283396, 'support': 30036}, '1': {'precision': 0.3922163098626408, 'recall': 0.6484689354156721, 'f1-score': 0.48879350228756496, 'support': 29326}, '2': {'precision': 0.4414445281984513, 'recall': 0.22055601205149275, 'f1-score': 0.2941485354215657, 'support': 29208}, 'accuracy': 0.4059162244552332, 'macro avg': {'precision': 0.4150987724166085, 'recall': 0.40612413239805306, 'f1-score': 0.3869614333439882, 'support': 88570}, 'weighted avg': {'precision': 0.41503590985169875, 'recall': 0.4059162244552332, 'f1-score': 0.38701278606533657, 'support': 88570}}
[[10493 15090  4453]
 [ 6611 19017  3698]
 [ 8387 14379  6442]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084133
{'0': {'precision': 0.40663176265270506, 'recall': 0.36252974556104706, 'f1-score': 0.3833163981226109, 'support': 10926}, '1': {'precision': 0.3946493945367502, 'recall': 0.6502412769116556, 'f1-score': 0.4911850268129403, 'support': 10776}, '2': {'precision': 0.4144502617801047, 'recall': 0.18724571861103226, 'f1-score': 0.2579509906152242, 'support': 10569}, 'accuracy': 0.4011961203557374, 'macro avg': {'precision': 0.40524380632318663, 'recall': 0.400005580361245, 'f1-score': 0.37748413851692514, 'support': 32271}, 'weighted avg': {'precision': 0.40519120358914823, 'recall': 0.4011961203557374, 'f1-score': 0.3782779844019769, 'support': 32271}}
[[3961 5345 1620]
 [2593 7007 1176]
 [3187 5403 1979]]
training model: results/CHTR/W4/deepVOL_L2/h50
Epoch 1/50
346/346 - 11s - loss: 3.3256 - accuracy50: 0.3650 - val_loss: 3.3328 - val_accuracy50: 0.3382 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.2888 - accuracy50: 0.3756 - val_loss: 3.3303 - val_accuracy50: 0.3419 - 9s/epoch - 27ms/step
Epoch 3/50
346/346 - 9s - loss: 3.2965 - accuracy50: 0.3722 - val_loss: 3.3116 - val_accuracy50: 0.3368 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.2960 - accuracy50: 0.3677 - val_loss: 3.3171 - val_accuracy50: 0.3427 - 9s/epoch - 25ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2907 - accuracy50: 0.3679 - val_loss: 3.3027 - val_accuracy50: 0.3455 - 9s/epoch - 26ms/step
Epoch 6/50
346/346 - 9s - loss: 3.2880 - accuracy50: 0.3698 - val_loss: 3.2886 - val_accuracy50: 0.3622 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2871 - accuracy50: 0.3649 - val_loss: 3.2910 - val_accuracy50: 0.3585 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2852 - accuracy50: 0.3653 - val_loss: 3.2883 - val_accuracy50: 0.3619 - 9s/epoch - 26ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2850 - accuracy50: 0.3628 - val_loss: 3.2865 - val_accuracy50: 0.3655 - 9s/epoch - 26ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2821 - accuracy50: 0.3681 - val_loss: 3.2866 - val_accuracy50: 0.3677 - 9s/epoch - 25ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2781 - accuracy50: 0.3711 - val_loss: 3.2822 - val_accuracy50: 0.3710 - 9s/epoch - 26ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2760 - accuracy50: 0.3714 - val_loss: 3.2894 - val_accuracy50: 0.3679 - 9s/epoch - 25ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2711 - accuracy50: 0.3767 - val_loss: 3.2887 - val_accuracy50: 0.3665 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2685 - accuracy50: 0.3783 - val_loss: 3.2868 - val_accuracy50: 0.3716 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2665 - accuracy50: 0.3803 - val_loss: 3.2845 - val_accuracy50: 0.3732 - 9s/epoch - 26ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2662 - accuracy50: 0.3803 - val_loss: 3.2846 - val_accuracy50: 0.3736 - 9s/epoch - 26ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2616 - accuracy50: 0.3830 - val_loss: 3.2841 - val_accuracy50: 0.3748 - 9s/epoch - 26ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2576 - accuracy50: 0.3858 - val_loss: 3.2831 - val_accuracy50: 0.3764 - 9s/epoch - 26ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2547 - accuracy50: 0.3880 - val_loss: 3.2834 - val_accuracy50: 0.3748 - 9s/epoch - 26ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2542 - accuracy50: 0.3881 - val_loss: 3.2887 - val_accuracy50: 0.3764 - 9s/epoch - 26ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2539 - accuracy50: 0.3882 - val_loss: 3.2895 - val_accuracy50: 0.3749 - 9s/epoch - 26ms/step
testing model: results/CHTR/W4/deepVOL_L2/h50
Evaluating performance on  test set...
925/925 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901389
{'0': {'precision': 0.3555082571023156, 'recall': 0.32068791786380535, 'f1-score': 0.3372015606543294, 'support': 73439}, '1': {'precision': 0.4239774510745972, 'recall': 0.557670230133235, 'f1-score': 0.4817198822721297, 'support': 94945}, '2': {'precision': 0.3352646826441928, 'recall': 0.22362758014931927, 'f1-score': 0.2682965382791507, 'support': 68310}, 'accuracy': 0.38773690925836735, 'macro avg': {'precision': 0.3715834636070352, 'recall': 0.36732857604878655, 'f1-score': 0.36240599373520327, 'support': 236694}, 'weighted avg': {'precision': 0.37713098116994687, 'recall': 0.38773690925836735, 'f1-score': 0.3752861338482152, 'support': 236694}}
[[23551 36756 13132]
 [24841 52948 17156]
 [17854 35180 15276]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913111
{'0': {'precision': 0.3909666782367234, 'recall': 0.29738292465595195, 'f1-score': 0.3378132673527151, 'support': 30301}, '1': {'precision': 0.3636178539918105, 'recall': 0.5546812989612451, 'f1-score': 0.4392730254167806, 'support': 28977}, '2': {'precision': 0.39256062667104463, 'recall': 0.2857094087122764, 'f1-score': 0.3307186184821482, 'support': 29292}, 'accuracy': 0.3777012532460201, 'macro avg': {'precision': 0.38238171963319284, 'recall': 0.3792578774431578, 'f1-score': 0.369268303750548, 'support': 88570}, 'weighted avg': {'precision': 0.3825462543617465, 'recall': 0.3777012532460201, 'f1-score': 0.36866099180462636, 'support': 88570}}
[[ 9011 14384  6906]
 [ 6860 16073  6044]
 [ 7177 13746  8369]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0947808
{'0': {'precision': 0.3701125420582434, 'recall': 0.29111151670012775, 'f1-score': 0.3258926291055831, 'support': 10958}, '1': {'precision': 0.3641572691252667, 'recall': 0.5675470264107924, 'f1-score': 0.44365229660985483, 'support': 10526}, '2': {'precision': 0.37974334207258176, 'recall': 0.25512190599796053, 'f1-score': 0.3052012864589109, 'support': 10787}, 'accuracy': 0.36924793157943664, 'macro avg': {'precision': 0.37133771775203056, 'recall': 0.37126014970296023, 'f1-score': 0.3582487373914496, 'support': 32271}, 'weighted avg': {'precision': 0.3713892994212677, 'recall': 0.36924793157943664, 'f1-score': 0.3573865631956426, 'support': 32271}}
[[3190 5281 2487]
 [2544 5974 2008]
 [2885 5150 2752]]
training model: results/CHTR/W4/deepVOL_L2/h100
Epoch 1/50
346/346 - 11s - loss: 3.3297 - accuracy100: 0.3658 - val_loss: 3.3444 - val_accuracy100: 0.3389 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3056 - accuracy100: 0.3754 - val_loss: 3.3230 - val_accuracy100: 0.3422 - 9s/epoch - 25ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3039 - accuracy100: 0.3640 - val_loss: 3.3542 - val_accuracy100: 0.3140 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.3060 - accuracy100: 0.3526 - val_loss: 3.3331 - val_accuracy100: 0.3247 - 9s/epoch - 25ms/step
Epoch 5/50
346/346 - 9s - loss: 3.3016 - accuracy100: 0.3472 - val_loss: 3.3320 - val_accuracy100: 0.3218 - 9s/epoch - 25ms/step
Epoch 6/50
346/346 - 9s - loss: 3.3023 - accuracy100: 0.3443 - val_loss: 3.3195 - val_accuracy100: 0.3248 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2977 - accuracy100: 0.3504 - val_loss: 3.3194 - val_accuracy100: 0.3211 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.3007 - accuracy100: 0.3455 - val_loss: 3.3133 - val_accuracy100: 0.3285 - 9s/epoch - 26ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2967 - accuracy100: 0.3469 - val_loss: 3.3065 - val_accuracy100: 0.3414 - 9s/epoch - 26ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2940 - accuracy100: 0.3531 - val_loss: 3.3050 - val_accuracy100: 0.3415 - 9s/epoch - 25ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2903 - accuracy100: 0.3573 - val_loss: 3.3052 - val_accuracy100: 0.3407 - 9s/epoch - 25ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2886 - accuracy100: 0.3597 - val_loss: 3.3053 - val_accuracy100: 0.3454 - 9s/epoch - 25ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2874 - accuracy100: 0.3601 - val_loss: 3.3055 - val_accuracy100: 0.3465 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2838 - accuracy100: 0.3649 - val_loss: 3.3043 - val_accuracy100: 0.3476 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2832 - accuracy100: 0.3652 - val_loss: 3.3018 - val_accuracy100: 0.3491 - 9s/epoch - 25ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2796 - accuracy100: 0.3693 - val_loss: 3.3040 - val_accuracy100: 0.3511 - 9s/epoch - 25ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2776 - accuracy100: 0.3686 - val_loss: 3.3073 - val_accuracy100: 0.3472 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2762 - accuracy100: 0.3705 - val_loss: 3.3048 - val_accuracy100: 0.3510 - 9s/epoch - 25ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2747 - accuracy100: 0.3720 - val_loss: 3.3068 - val_accuracy100: 0.3476 - 9s/epoch - 25ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2728 - accuracy100: 0.3745 - val_loss: 3.3096 - val_accuracy100: 0.3487 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2709 - accuracy100: 0.3758 - val_loss: 3.3055 - val_accuracy100: 0.3507 - 9s/epoch - 25ms/step
Epoch 22/50
346/346 - 9s - loss: 3.2676 - accuracy100: 0.3791 - val_loss: 3.3143 - val_accuracy100: 0.3447 - 9s/epoch - 25ms/step
Epoch 23/50
346/346 - 9s - loss: 3.2671 - accuracy100: 0.3789 - val_loss: 3.3118 - val_accuracy100: 0.3506 - 9s/epoch - 25ms/step
Epoch 24/50
346/346 - 9s - loss: 3.2663 - accuracy100: 0.3815 - val_loss: 3.3114 - val_accuracy100: 0.3484 - 9s/epoch - 25ms/step
Epoch 25/50
346/346 - 9s - loss: 3.2645 - accuracy100: 0.3828 - val_loss: 3.3149 - val_accuracy100: 0.3497 - 9s/epoch - 25ms/step
testing model: results/CHTR/W4/deepVOL_L2/h100
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097814
{'0': {'precision': 0.3349383644886857, 'recall': 0.3900496037094948, 'f1-score': 0.3603992950685938, 'support': 74188}, '1': {'precision': 0.39962049640999253, 'recall': 0.5370286331712588, 'f1-score': 0.4582455525693449, 'support': 92550}, '2': {'precision': 0.32018051376996065, 'recall': 0.11866030076047801, 'f1-score': 0.17315033061471394, 'support': 69956}, 'accuracy': 0.3673096909934346, 'macro avg': {'precision': 0.35157979155621294, 'recall': 0.3485795125470772, 'f1-score': 0.3305983927508842, 'support': 236694}, 'weighted avg': {'precision': 0.3558680505155297, 'recall': 0.3673096909934346, 'f1-score': 0.34331598317373757, 'support': 236694}}
[[28937 37794  7457]
 [32680 49702 10168]
 [24778 36877  8301]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944694
{'0': {'precision': 0.3726470309089183, 'recall': 0.38828454641350213, 'f1-score': 0.38030510937121637, 'support': 30336}, '1': {'precision': 0.3543806127271946, 'recall': 0.5676382532089886, 'f1-score': 0.4363468024601548, 'support': 29059}, '2': {'precision': 0.3915506481036966, 'recall': 0.13977720651242503, 'f1-score': 0.20601161909573126, 'support': 29175}, 'accuracy': 0.3652704075872191, 'macro avg': {'precision': 0.3728594305799365, 'recall': 0.36523333537830527, 'f1-score': 0.34088784364236746, 'support': 88570}, 'weighted avg': {'precision': 0.372880848067267, 'recall': 0.3652704075872191, 'f1-score': 0.3412795135790089, 'support': 88570}}
[[11779 15131  3426]
 [ 9653 16495  2911]
 [10177 14920  4078]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005145
{'0': {'precision': 0.36302142051860203, 'recall': 0.3805800527320666, 'f1-score': 0.37159343098091435, 'support': 10999}, '1': {'precision': 0.3331015299026426, 'recall': 0.5741110667199361, 'f1-score': 0.42159307613319646, 'support': 10012}, '2': {'precision': 0.37083811710677383, 'recall': 0.1147424511545293, 'f1-score': 0.17525773195876287, 'support': 11260}, 'accuracy': 0.34786650553128196, 'macro avg': {'precision': 0.3556536891760061, 'recall': 0.356477856868844, 'f1-score': 0.3228147463576246, 'support': 32271}, 'weighted avg': {'precision': 0.35646624896320644, 'recall': 0.34786650553128196, 'f1-score': 0.3186002320182303, 'support': 32271}}
[[4186 5551 1262]
 [3334 5748  930]
 [4011 5957 1292]]
training model: results/CHTR/W4/deepVOL_L2/h200
Epoch 1/50
346/346 - 11s - loss: 3.3438 - accuracy200: 0.3541 - val_loss: 3.3322 - val_accuracy200: 0.3433 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3046 - accuracy200: 0.3695 - val_loss: 3.3207 - val_accuracy200: 0.3440 - 9s/epoch - 26ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3066 - accuracy200: 0.3608 - val_loss: 3.3326 - val_accuracy200: 0.3172 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.3021 - accuracy200: 0.3571 - val_loss: 3.3303 - val_accuracy200: 0.3161 - 9s/epoch - 26ms/step
Epoch 5/50
346/346 - 9s - loss: 3.3007 - accuracy200: 0.3580 - val_loss: 3.3020 - val_accuracy200: 0.3482 - 9s/epoch - 26ms/step
Epoch 6/50
346/346 - 9s - loss: 3.3011 - accuracy200: 0.3535 - val_loss: 3.3482 - val_accuracy200: 0.3029 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2988 - accuracy200: 0.3506 - val_loss: 3.3420 - val_accuracy200: 0.3032 - 9s/epoch - 26ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2972 - accuracy200: 0.3498 - val_loss: 3.3303 - val_accuracy200: 0.3063 - 9s/epoch - 26ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2947 - accuracy200: 0.3534 - val_loss: 3.3259 - val_accuracy200: 0.3072 - 9s/epoch - 26ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2919 - accuracy200: 0.3521 - val_loss: 3.3271 - val_accuracy200: 0.3056 - 9s/epoch - 26ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2912 - accuracy200: 0.3528 - val_loss: 3.3322 - val_accuracy200: 0.3040 - 9s/epoch - 26ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2895 - accuracy200: 0.3544 - val_loss: 3.3260 - val_accuracy200: 0.3053 - 9s/epoch - 26ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2854 - accuracy200: 0.3603 - val_loss: 3.3289 - val_accuracy200: 0.3072 - 9s/epoch - 26ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2865 - accuracy200: 0.3593 - val_loss: 3.3256 - val_accuracy200: 0.3062 - 9s/epoch - 26ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2850 - accuracy200: 0.3593 - val_loss: 3.3237 - val_accuracy200: 0.3063 - 9s/epoch - 26ms/step
testing model: results/CHTR/W4/deepVOL_L2/h200
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140033
{'0': {'precision': 0.31629152978016706, 'recall': 0.46905659870884614, 'f1-score': 0.37781621621621625, 'support': 74507}, '1': {'precision': 0.3724166628138148, 'recall': 0.09113537364937489, 'f1-score': 0.14643590815714363, 'support': 88385}, '2': {'precision': 0.3184313200474314, 'recall': 0.4511937345871386, 'f1-score': 0.37336158857232554, 'support': 73802}, 'accuracy': 0.32236558594641185, 'macro avg': {'precision': 0.3357131708804711, 'recall': 0.3371285689817865, 'f1-score': 0.2992045709818951, 'support': 236694}, 'weighted avg': {'precision': 0.33791666892388683, 'recall': 0.32236558594641185, 'f1-score': 0.2900264583128661, 'support': 236694}}
[[34948  6939 32620]
 [41677  8055 38653]
 [33868  6635 33299]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052529
{'0': {'precision': 0.34141661269818424, 'recall': 0.4754175016700067, 'f1-score': 0.39742569557872987, 'support': 29940}, '1': {'precision': 0.35570560432140447, 'recall': 0.08980259793392656, 'f1-score': 0.14340156794425085, 'support': 29331}, '2': {'precision': 0.3389066220803567, 'recall': 0.4566026144237005, 'f1-score': 0.3890480275689588, 'support': 29299}, 'accuracy': 0.34149260471943094, 'macro avg': {'precision': 0.3453429463666485, 'recall': 0.34060757134254455, 'f1-score': 0.3099584303639798, 'support': 88570}, 'weighted avg': {'precision': 0.3453182746400262, 'recall': 0.34149260471943094, 'f1-score': 0.31053127328376334, 'support': 88570}}
[[14234  2454 13252]
 [13853  2634 12844]
 [13604  2317 13378]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013427
{'0': {'precision': 0.34395863332896975, 'recall': 0.47565170166545984, 'f1-score': 0.3992251006609436, 'support': 11048}, '1': {'precision': 0.3111988513998564, 'recall': 0.09008728179551122, 'f1-score': 0.13972602739726026, 'support': 9624}, '2': {'precision': 0.36165270641233194, 'recall': 0.44296922148461076, 'f1-score': 0.39820196853444934, 'support': 11599}, 'accuracy': 0.34892008304669825, 'macro avg': {'precision': 0.338936730380386, 'recall': 0.3362360683151939, 'f1-score': 0.3123843655308844, 'support': 32271}, 'weighted avg': {'precision': 0.3405485565544084, 'recall': 0.34892008304669825, 'f1-score': 0.3214684029873389, 'support': 32271}}
[[5255  910 4883]
 [4571  867 4186]
 [5452 1009 5138]]
training model: results/CHTR/W4/deepVOL_L2/h300
Epoch 1/50
346/346 - 11s - loss: 3.3330 - accuracy300: 0.3624 - val_loss: 3.3282 - val_accuracy300: 0.3460 - 11s/epoch - 33ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3195 - accuracy300: 0.3646 - val_loss: 3.3371 - val_accuracy300: 0.3486 - 9s/epoch - 26ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3055 - accuracy300: 0.3652 - val_loss: 3.3074 - val_accuracy300: 0.3416 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.2970 - accuracy300: 0.3620 - val_loss: 3.3118 - val_accuracy300: 0.3425 - 9s/epoch - 26ms/step
Epoch 5/50
346/346 - 9s - loss: 3.3024 - accuracy300: 0.3565 - val_loss: 3.3264 - val_accuracy300: 0.3104 - 9s/epoch - 25ms/step
Epoch 6/50
346/346 - 9s - loss: 3.3034 - accuracy300: 0.3394 - val_loss: 3.3148 - val_accuracy300: 0.3104 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2992 - accuracy300: 0.3426 - val_loss: 3.3091 - val_accuracy300: 0.3158 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2966 - accuracy300: 0.3470 - val_loss: 3.3099 - val_accuracy300: 0.3173 - 9s/epoch - 26ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2948 - accuracy300: 0.3480 - val_loss: 3.3076 - val_accuracy300: 0.3250 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2939 - accuracy300: 0.3511 - val_loss: 3.3043 - val_accuracy300: 0.3358 - 9s/epoch - 26ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2924 - accuracy300: 0.3532 - val_loss: 3.3040 - val_accuracy300: 0.3396 - 9s/epoch - 27ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2911 - accuracy300: 0.3550 - val_loss: 3.3066 - val_accuracy300: 0.3387 - 9s/epoch - 26ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2899 - accuracy300: 0.3580 - val_loss: 3.3067 - val_accuracy300: 0.3425 - 9s/epoch - 26ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2879 - accuracy300: 0.3605 - val_loss: 3.3065 - val_accuracy300: 0.3436 - 9s/epoch - 26ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2868 - accuracy300: 0.3624 - val_loss: 3.3056 - val_accuracy300: 0.3450 - 9s/epoch - 27ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2851 - accuracy300: 0.3637 - val_loss: 3.3090 - val_accuracy300: 0.3448 - 9s/epoch - 26ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2831 - accuracy300: 0.3649 - val_loss: 3.3130 - val_accuracy300: 0.3454 - 9s/epoch - 25ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2817 - accuracy300: 0.3660 - val_loss: 3.3122 - val_accuracy300: 0.3446 - 9s/epoch - 25ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2783 - accuracy300: 0.3669 - val_loss: 3.3178 - val_accuracy300: 0.3399 - 9s/epoch - 26ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2771 - accuracy300: 0.3689 - val_loss: 3.3177 - val_accuracy300: 0.3423 - 9s/epoch - 25ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2755 - accuracy300: 0.3721 - val_loss: 3.3138 - val_accuracy300: 0.3419 - 9s/epoch - 26ms/step
testing model: results/CHTR/W4/deepVOL_L2/h300
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098134
{'0': {'precision': 0.2766890579026259, 'recall': 0.06913292552675017, 'f1-score': 0.11062526357845205, 'support': 72093}, '1': {'precision': 0.37662993717046067, 'recall': 0.5339629820281552, 'f1-score': 0.44170438871763545, 'support': 89362}, '2': {'precision': 0.32943069280022613, 'recall': 0.40276984010951766, 'f1-score': 0.3624273447030401, 'support': 75239}, 'accuracy': 0.3506806256178864, 'macro avg': {'precision': 0.3275832292911042, 'recall': 0.3352885825548077, 'f1-score': 0.3049189989997092, 'support': 236694}, 'weighted avg': {'precision': 0.33118619226679563, 'recall': 0.3506806256178864, 'f1-score': 0.3156631165127072, 'support': 236694}}
[[ 4984 39548 27561]
 [ 7522 47716 34124]
 [ 5507 39428 30304]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957575
{'0': {'precision': 0.3565350578624915, 'recall': 0.07007860846295368, 'f1-score': 0.11713399122193957, 'support': 29895}, '1': {'precision': 0.3552562814070352, 'recall': 0.6030023882633914, 'f1-score': 0.4471034657222363, 'support': 29310}, '2': {'precision': 0.3662275376396309, 'recall': 0.41086327260343947, 'f1-score': 0.3872634771862813, 'support': 29365}, 'accuracy': 0.3594219261600994, 'macro avg': {'precision': 0.3593396256363859, 'recall': 0.3613147564432615, 'f1-score': 0.31716697804348576, 'support': 88570}, 'weighted avg': {'precision': 0.3593253788599655, 'recall': 0.3594219261600994, 'f1-score': 0.315889299485986, 'support': 88570}}
[[ 2095 16756 11044]
 [ 1801 17674  9835]
 [ 1980 15320 12065]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016746
{'0': {'precision': 0.3611365719523373, 'recall': 0.07280790908250948, 'f1-score': 0.1211841599384852, 'support': 10823}, '1': {'precision': 0.31852304954679417, 'recall': 0.5715996407544157, 'f1-score': 0.40908441651192684, 'support': 10021}, '2': {'precision': 0.36750371716504215, 'recall': 0.38934103439222895, 'f1-score': 0.37810733863085877, 'support': 11427}, 'accuracy': 0.33977874872176256, 'macro avg': {'precision': 0.3490544462213912, 'recall': 0.344582861409718, 'f1-score': 0.30279197169375693, 'support': 32271}, 'weighted avg': {'precision': 0.3501585192213909, 'recall': 0.33977874872176256, 'f1-score': 0.3015600278706909, 'support': 32271}}
[[ 788 6027 4008]
 [ 644 5728 3649]
 [ 750 6228 4449]]
training model: results/CHTR/W4/deepVOL_L2/h500
Epoch 1/50
346/346 - 11s - loss: 3.3344 - accuracy500: 0.3617 - val_loss: 3.3281 - val_accuracy500: 0.3486 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3187 - accuracy500: 0.3584 - val_loss: 3.3190 - val_accuracy500: 0.3467 - 9s/epoch - 26ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3101 - accuracy500: 0.3550 - val_loss: 3.3117 - val_accuracy500: 0.3454 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.3056 - accuracy500: 0.3470 - val_loss: 3.3099 - val_accuracy500: 0.3332 - 9s/epoch - 26ms/step
Epoch 5/50
346/346 - 9s - loss: 3.2995 - accuracy500: 0.3477 - val_loss: 3.3159 - val_accuracy500: 0.3247 - 9s/epoch - 26ms/step
Epoch 6/50
346/346 - 9s - loss: 3.2959 - accuracy500: 0.3501 - val_loss: 3.3130 - val_accuracy500: 0.3276 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.2937 - accuracy500: 0.3511 - val_loss: 3.3082 - val_accuracy500: 0.3352 - 9s/epoch - 26ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2909 - accuracy500: 0.3537 - val_loss: 3.3096 - val_accuracy500: 0.3428 - 9s/epoch - 26ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2891 - accuracy500: 0.3544 - val_loss: 3.3086 - val_accuracy500: 0.3408 - 9s/epoch - 25ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2880 - accuracy500: 0.3566 - val_loss: 3.3073 - val_accuracy500: 0.3428 - 9s/epoch - 26ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2868 - accuracy500: 0.3594 - val_loss: 3.3081 - val_accuracy500: 0.3441 - 9s/epoch - 26ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2851 - accuracy500: 0.3604 - val_loss: 3.3108 - val_accuracy500: 0.3418 - 9s/epoch - 26ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2819 - accuracy500: 0.3645 - val_loss: 3.3119 - val_accuracy500: 0.3431 - 9s/epoch - 26ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2797 - accuracy500: 0.3668 - val_loss: 3.3149 - val_accuracy500: 0.3447 - 9s/epoch - 26ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2775 - accuracy500: 0.3695 - val_loss: 3.3184 - val_accuracy500: 0.3409 - 9s/epoch - 26ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2780 - accuracy500: 0.3675 - val_loss: 3.3171 - val_accuracy500: 0.3433 - 9s/epoch - 25ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2746 - accuracy500: 0.3685 - val_loss: 3.3165 - val_accuracy500: 0.3452 - 9s/epoch - 26ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2723 - accuracy500: 0.3738 - val_loss: 3.3261 - val_accuracy500: 0.3397 - 9s/epoch - 26ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2710 - accuracy500: 0.3747 - val_loss: 3.3187 - val_accuracy500: 0.3443 - 9s/epoch - 26ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2675 - accuracy500: 0.3770 - val_loss: 3.3195 - val_accuracy500: 0.3450 - 9s/epoch - 26ms/step
testing model: results/CHTR/W4/deepVOL_L2/h500
Evaluating performance on  test set...
925/925 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100271
{'0': {'precision': 0.26329545454545455, 'recall': 0.06500028053638557, 'f1-score': 0.10426135085272015, 'support': 71292}, '1': {'precision': 0.38133178432095954, 'recall': 0.5513574249784355, 'f1-score': 0.45084709583714233, 'support': 88108}, '2': {'precision': 0.3368883654485774, 'recall': 0.39968173467539525, 'f1-score': 0.3656084499541407, 'support': 77294}, 'accuracy': 0.35533642593390624, 'macro avg': {'precision': 0.32717186810499715, 'recall': 0.3386798133967388, 'f1-score': 0.3069056322146677, 'support': 236694}, 'weighted avg': {'precision': 0.3312660638520114, 'recall': 0.35533642593390624, 'f1-score': 0.31862056357899404, 'support': 236694}}
[[ 4634 37956 28702]
 [ 7423 48579 32106]
 [ 5543 40858 30893]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959316
{'0': {'precision': 0.36658887592376505, 'recall': 0.06324866624165353, 'f1-score': 0.1078838174273859, 'support': 29803}, '1': {'precision': 0.3546296112751997, 'recall': 0.6118121815259396, 'f1-score': 0.4490011043067965, 'support': 29241}, '2': {'precision': 0.37078924229101606, 'recall': 0.4141773352299668, 'f1-score': 0.39128417617226874, 'support': 29526}, 'accuracy': 0.3613413119566445, 'macro avg': {'precision': 0.3640025764966603, 'recall': 0.36307939433251996, 'f1-score': 0.3160563659688171, 'support': 88570}, 'weighted avg': {'precision': 0.36404082533971577, 'recall': 0.3613413119566445, 'f1-score': 0.3149775238510311, 'support': 88570}}
[[ 1885 16998 10920]
 [ 1519 17890  9832]
 [ 1738 15559 12229]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102905
{'0': {'precision': 0.3385866802236909, 'recall': 0.061758160237388726, 'f1-score': 0.10446239510626619, 'support': 10784}, '1': {'precision': 0.31791875654522406, 'recall': 0.5864172427816186, 'f1-score': 0.412309231923943, 'support': 9836}, '2': {'precision': 0.38047857906422167, 'recall': 0.39713329327954683, 'f1-score': 0.38862758273139597, 'support': 11651}, 'accuracy': 0.34275355582411454, 'macro avg': {'precision': 0.3456613386110455, 'recall': 0.348436232099518, 'f1-score': 0.3017997365872017, 'support': 32271}, 'weighted avg': {'precision': 0.34741171868204745, 'recall': 0.34275355582411454, 'f1-score': 0.3008861219185452, 'support': 32271}}
[[ 666 6078 4040]
 [ 574 5768 3494]
 [ 727 6297 4627]]
training model: results/CHTR/W4/deepVOL_L2/h1000
Epoch 1/50
346/346 - 11s - loss: 3.3430 - accuracy1000: 0.3636 - val_loss: 3.3256 - val_accuracy1000: 0.3485 - 11s/epoch - 32ms/step
Epoch 2/50
346/346 - 9s - loss: 3.3302 - accuracy1000: 0.3447 - val_loss: 3.3113 - val_accuracy1000: 0.3278 - 9s/epoch - 26ms/step
Epoch 3/50
346/346 - 9s - loss: 3.3121 - accuracy1000: 0.3354 - val_loss: 3.3126 - val_accuracy1000: 0.3079 - 9s/epoch - 26ms/step
Epoch 4/50
346/346 - 9s - loss: 3.3065 - accuracy1000: 0.3366 - val_loss: 3.3068 - val_accuracy1000: 0.3168 - 9s/epoch - 26ms/step
Epoch 5/50
346/346 - 9s - loss: 3.3046 - accuracy1000: 0.3386 - val_loss: 3.3040 - val_accuracy1000: 0.3314 - 9s/epoch - 26ms/step
Epoch 6/50
346/346 - 9s - loss: 3.3026 - accuracy1000: 0.3391 - val_loss: 3.3045 - val_accuracy1000: 0.3401 - 9s/epoch - 25ms/step
Epoch 7/50
346/346 - 9s - loss: 3.3021 - accuracy1000: 0.3428 - val_loss: 3.3051 - val_accuracy1000: 0.3473 - 9s/epoch - 25ms/step
Epoch 8/50
346/346 - 9s - loss: 3.2994 - accuracy1000: 0.3465 - val_loss: 3.3054 - val_accuracy1000: 0.3473 - 9s/epoch - 25ms/step
Epoch 9/50
346/346 - 9s - loss: 3.2973 - accuracy1000: 0.3473 - val_loss: 3.3053 - val_accuracy1000: 0.3504 - 9s/epoch - 26ms/step
Epoch 10/50
346/346 - 9s - loss: 3.2964 - accuracy1000: 0.3514 - val_loss: 3.3031 - val_accuracy1000: 0.3525 - 9s/epoch - 27ms/step
Epoch 11/50
346/346 - 9s - loss: 3.2956 - accuracy1000: 0.3507 - val_loss: 3.3028 - val_accuracy1000: 0.3503 - 9s/epoch - 27ms/step
Epoch 12/50
346/346 - 9s - loss: 3.2942 - accuracy1000: 0.3516 - val_loss: 3.3005 - val_accuracy1000: 0.3546 - 9s/epoch - 26ms/step
Epoch 13/50
346/346 - 9s - loss: 3.2926 - accuracy1000: 0.3551 - val_loss: 3.3037 - val_accuracy1000: 0.3535 - 9s/epoch - 25ms/step
Epoch 14/50
346/346 - 9s - loss: 3.2906 - accuracy1000: 0.3567 - val_loss: 3.3028 - val_accuracy1000: 0.3555 - 9s/epoch - 25ms/step
Epoch 15/50
346/346 - 9s - loss: 3.2882 - accuracy1000: 0.3620 - val_loss: 3.3038 - val_accuracy1000: 0.3536 - 9s/epoch - 25ms/step
Epoch 16/50
346/346 - 9s - loss: 3.2883 - accuracy1000: 0.3613 - val_loss: 3.3032 - val_accuracy1000: 0.3566 - 9s/epoch - 26ms/step
Epoch 17/50
346/346 - 9s - loss: 3.2861 - accuracy1000: 0.3623 - val_loss: 3.3056 - val_accuracy1000: 0.3588 - 9s/epoch - 26ms/step
Epoch 18/50
346/346 - 9s - loss: 3.2829 - accuracy1000: 0.3649 - val_loss: 3.3063 - val_accuracy1000: 0.3579 - 9s/epoch - 26ms/step
Epoch 19/50
346/346 - 9s - loss: 3.2829 - accuracy1000: 0.3650 - val_loss: 3.3070 - val_accuracy1000: 0.3540 - 9s/epoch - 26ms/step
Epoch 20/50
346/346 - 9s - loss: 3.2823 - accuracy1000: 0.3662 - val_loss: 3.3087 - val_accuracy1000: 0.3565 - 9s/epoch - 26ms/step
Epoch 21/50
346/346 - 9s - loss: 3.2849 - accuracy1000: 0.3589 - val_loss: 3.3078 - val_accuracy1000: 0.3562 - 9s/epoch - 26ms/step
Epoch 22/50
346/346 - 9s - loss: 3.2796 - accuracy1000: 0.3649 - val_loss: 3.3109 - val_accuracy1000: 0.3550 - 9s/epoch - 26ms/step
testing model: results/CHTR/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
925/925 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996625
{'0': {'precision': 0.2569799449469131, 'recall': 0.01857668746535526, 'f1-score': 0.03464867515872911, 'support': 70357}, '1': {'precision': 0.3928221249204745, 'recall': 0.5954706876794081, 'f1-score': 0.47336995246728175, 'support': 88137}, '2': {'precision': 0.34510168056079915, 'recall': 0.4324936061381074, 'f1-score': 0.3838867669676453, 'support': 78200}, 'accuracy': 0.3701445748519185, 'macro avg': {'precision': 0.3316345834760623, 'recall': 0.3488469937609569, 'f1-score': 0.2973017981978854, 'support': 236694}, 'weighted avg': {'precision': 0.3366771148850428, 'recall': 0.3701445748519185, 'f1-score': 0.3133967464981004, 'support': 236694}}
[[ 1307 38761 30289]
 [ 1761 52483 33893]
 [ 2018 42361 33821]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945064
{'0': {'precision': 0.4001536098310292, 'recall': 0.01764307483914663, 'f1-score': 0.033796056045666836, 'support': 29530}, '1': {'precision': 0.3581138071046076, 'recall': 0.6235314207650273, 'f1-score': 0.45494075578425386, 'support': 29280}, '2': {'precision': 0.3820376443354369, 'recall': 0.4658266129032258, 'f1-score': 0.41979196632700955, 'support': 29760}, 'accuracy': 0.36853336344134585, 'macro avg': {'precision': 0.3801016870903579, 'recall': 0.3690003695024666, 'f1-score': 0.30284292605231006, 'support': 88570}, 'weighted avg': {'precision': 0.3801687779807588, 'recall': 0.36853336344134585, 'f1-score': 0.30271730588555157, 'support': 88570}}
[[  521 17220 11789]
 [  388 18257 10635]
 [  393 15504 13863]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012428
{'0': {'precision': 0.354916067146283, 'recall': 0.01391762271957871, 'f1-score': 0.026784906343317347, 'support': 10634}, '1': {'precision': 0.32215314136125656, 'recall': 0.6034940743767879, 'f1-score': 0.4200682690940123, 'support': 9788}, '2': {'precision': 0.39732208906642996, 'recall': 0.4532871972318339, 'f1-score': 0.4234635550124177, 'support': 11849}, 'accuracy': 0.3540640203278485, 'macro avg': {'precision': 0.35813043252465654, 'recall': 0.3568996314427335, 'f1-score': 0.2901055768165825, 'support': 32271}, 'weighted avg': {'precision': 0.36054915679792016, 'recall': 0.3540640203278485, 'f1-score': 0.29171945633197505, 'support': 32271}}
[[ 148 6093 4393]
 [ 127 5907 3754]
 [ 142 6336 5371]]
training model: results/CHTR/W4/deepVOL_L3/h10
Epoch 1/50
346/346 - 17s - loss: 3.3156 - accuracy10: 0.3623 - val_loss: 3.3526 - val_accuracy10: 0.3408 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 13s - loss: 3.2897 - accuracy10: 0.3704 - val_loss: 3.3601 - val_accuracy10: 0.3361 - 13s/epoch - 39ms/step
Epoch 3/50
346/346 - 14s - loss: 3.2882 - accuracy10: 0.3667 - val_loss: 3.3302 - val_accuracy10: 0.3406 - 14s/epoch - 40ms/step
Epoch 4/50
346/346 - 14s - loss: 3.2847 - accuracy10: 0.3663 - val_loss: 3.2928 - val_accuracy10: 0.3556 - 14s/epoch - 40ms/step
Epoch 5/50
346/346 - 14s - loss: 3.2788 - accuracy10: 0.3685 - val_loss: 3.2807 - val_accuracy10: 0.3665 - 14s/epoch - 39ms/step
Epoch 6/50
346/346 - 14s - loss: 3.2737 - accuracy10: 0.3719 - val_loss: 3.2725 - val_accuracy10: 0.3762 - 14s/epoch - 39ms/step
Epoch 7/50
346/346 - 14s - loss: 3.2646 - accuracy10: 0.3786 - val_loss: 3.2618 - val_accuracy10: 0.3902 - 14s/epoch - 39ms/step
Epoch 8/50
346/346 - 14s - loss: 3.2599 - accuracy10: 0.3817 - val_loss: 3.2569 - val_accuracy10: 0.3924 - 14s/epoch - 39ms/step
Epoch 9/50
346/346 - 14s - loss: 3.2534 - accuracy10: 0.3864 - val_loss: 3.2479 - val_accuracy10: 0.4002 - 14s/epoch - 39ms/step
Epoch 10/50
346/346 - 14s - loss: 3.2454 - accuracy10: 0.3906 - val_loss: 3.2922 - val_accuracy10: 0.3676 - 14s/epoch - 40ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2422 - accuracy10: 0.3924 - val_loss: 3.2501 - val_accuracy10: 0.3954 - 14s/epoch - 40ms/step
Epoch 12/50
346/346 - 14s - loss: 3.2348 - accuracy10: 0.3963 - val_loss: 3.2593 - val_accuracy10: 0.3776 - 14s/epoch - 40ms/step
Epoch 13/50
346/346 - 14s - loss: 3.2295 - accuracy10: 0.3982 - val_loss: 3.2385 - val_accuracy10: 0.4044 - 14s/epoch - 40ms/step
Epoch 14/50
346/346 - 14s - loss: 3.2246 - accuracy10: 0.3993 - val_loss: 3.2452 - val_accuracy10: 0.4019 - 14s/epoch - 39ms/step
Epoch 15/50
346/346 - 13s - loss: 3.2200 - accuracy10: 0.4028 - val_loss: 3.2656 - val_accuracy10: 0.3825 - 13s/epoch - 39ms/step
Epoch 16/50
346/346 - 13s - loss: 3.2159 - accuracy10: 0.4056 - val_loss: 3.2478 - val_accuracy10: 0.3864 - 13s/epoch - 39ms/step
Epoch 17/50
346/346 - 14s - loss: 3.2143 - accuracy10: 0.4062 - val_loss: 3.2390 - val_accuracy10: 0.4064 - 14s/epoch - 40ms/step
Epoch 18/50
346/346 - 14s - loss: 3.2110 - accuracy10: 0.4083 - val_loss: 3.2418 - val_accuracy10: 0.4017 - 14s/epoch - 41ms/step
Epoch 19/50
346/346 - 14s - loss: 3.2047 - accuracy10: 0.4101 - val_loss: 3.2434 - val_accuracy10: 0.3909 - 14s/epoch - 40ms/step
Epoch 20/50
346/346 - 13s - loss: 3.2035 - accuracy10: 0.4107 - val_loss: 3.2494 - val_accuracy10: 0.3844 - 13s/epoch - 38ms/step
Epoch 21/50
346/346 - 14s - loss: 3.2006 - accuracy10: 0.4123 - val_loss: 3.2594 - val_accuracy10: 0.3867 - 14s/epoch - 39ms/step
Epoch 22/50
346/346 - 14s - loss: 3.1998 - accuracy10: 0.4128 - val_loss: 3.2277 - val_accuracy10: 0.4138 - 14s/epoch - 40ms/step
Epoch 23/50
346/346 - 14s - loss: 3.1937 - accuracy10: 0.4165 - val_loss: 3.2674 - val_accuracy10: 0.3813 - 14s/epoch - 39ms/step
Epoch 24/50
346/346 - 14s - loss: 3.1954 - accuracy10: 0.4165 - val_loss: 3.2253 - val_accuracy10: 0.4166 - 14s/epoch - 39ms/step
Epoch 25/50
346/346 - 14s - loss: 3.1872 - accuracy10: 0.4183 - val_loss: 3.2238 - val_accuracy10: 0.4183 - 14s/epoch - 39ms/step
Epoch 26/50
346/346 - 14s - loss: 3.1840 - accuracy10: 0.4210 - val_loss: 3.2284 - val_accuracy10: 0.4135 - 14s/epoch - 40ms/step
Epoch 27/50
346/346 - 14s - loss: 3.1815 - accuracy10: 0.4216 - val_loss: 3.2291 - val_accuracy10: 0.4094 - 14s/epoch - 39ms/step
Epoch 28/50
346/346 - 14s - loss: 3.1776 - accuracy10: 0.4228 - val_loss: 3.3068 - val_accuracy10: 0.3841 - 14s/epoch - 39ms/step
Epoch 29/50
346/346 - 14s - loss: 3.1780 - accuracy10: 0.4233 - val_loss: 3.2426 - val_accuracy10: 0.3931 - 14s/epoch - 39ms/step
Epoch 30/50
346/346 - 14s - loss: 3.1737 - accuracy10: 0.4226 - val_loss: 3.2384 - val_accuracy10: 0.3995 - 14s/epoch - 39ms/step
Epoch 31/50
346/346 - 13s - loss: 3.1688 - accuracy10: 0.4246 - val_loss: 3.2325 - val_accuracy10: 0.3988 - 13s/epoch - 39ms/step
Epoch 32/50
346/346 - 13s - loss: 3.1680 - accuracy10: 0.4256 - val_loss: 3.2358 - val_accuracy10: 0.4008 - 13s/epoch - 39ms/step
Epoch 33/50
346/346 - 14s - loss: 3.1661 - accuracy10: 0.4273 - val_loss: 3.2284 - val_accuracy10: 0.4151 - 14s/epoch - 39ms/step
Epoch 34/50
346/346 - 14s - loss: 3.1623 - accuracy10: 0.4278 - val_loss: 3.2351 - val_accuracy10: 0.4015 - 14s/epoch - 40ms/step
Epoch 35/50
346/346 - 14s - loss: 3.1554 - accuracy10: 0.4318 - val_loss: 3.2414 - val_accuracy10: 0.3926 - 14s/epoch - 40ms/step
testing model: results/CHTR/W4/deepVOL_L3/h10
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0526444
{'0': {'precision': 0.38079797190737985, 'recall': 0.3685592011412268, 'f1-score': 0.3745786425221281, 'support': 70100}, '1': {'precision': 0.5142772077049839, 'recall': 0.7095027033223162, 'f1-score': 0.5963181219692346, 'support': 104686}, '2': {'precision': 0.3984275828180664, 'recall': 0.15716870194482135, 'f1-score': 0.22541671975813463, 'support': 61908}, 'accuracy': 0.4640633053647325, 'macro avg': {'precision': 0.43116758747681, 'recall': 0.4117435354694548, 'f1-score': 0.3987711614164991, 'support': 236694}, 'weighted avg': {'precision': 0.44444479536284026, 'recall': 0.4640633053647325, 'f1-score': 0.43363676326421063, 'support': 236694}}
[[25836 37069  7195]
 [22915 74275  7496]
 [19096 33082  9730]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625379
{'0': {'precision': 0.413380234052628, 'recall': 0.41083733907022085, 'f1-score': 0.4121048638624294, 'support': 29749}, '1': {'precision': 0.40762622048842084, 'recall': 0.6244429859407924, 'f1-score': 0.4932602051953722, 'support': 28949}, '2': {'precision': 0.4767687794228014, 'recall': 0.23393144081414033, 'f1-score': 0.3138628758786409, 'support': 29872}, 'accuracy': 0.420989048210455, 'macro avg': {'precision': 0.43259174465461675, 'recall': 0.42307058860838453, 'f1-score': 0.40640931497881416, 'support': 88570}, 'weighted avg': {'precision': 0.4328785934138969, 'recall': 0.420989048210455, 'f1-score': 0.4054963204639382, 'support': 88570}}
[[12222 13326  4201]
 [ 7404 18077  3468]
 [ 9940 12944  6988]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0749252
{'0': {'precision': 0.40317545268040317, 'recall': 0.41609131915677067, 'f1-score': 0.40953157560931414, 'support': 10863}, '1': {'precision': 0.41907443682664053, 'recall': 0.6220808723307587, 'f1-score': 0.5007863648001171, 'support': 11005}, '2': {'precision': 0.4386113463166808, 'recall': 0.1991733153897914, 'f1-score': 0.27394724664507175, 'support': 10403}, 'accuracy': 0.4164110191813083, 'macro avg': {'precision': 0.4202870786079082, 'recall': 0.41244850229244023, 'f1-score': 0.394755062351501, 'support': 32271}, 'weighted avg': {'precision': 0.42002054338188555, 'recall': 0.4164110191813083, 'f1-score': 0.3969436539716138, 'support': 32271}}
[[4520 4867 1476]
 [2983 6846 1176]
 [3708 4623 2072]]
training model: results/CHTR/W4/deepVOL_L3/h20
Epoch 1/50
346/346 - 16s - loss: 3.3142 - accuracy20: 0.3710 - val_loss: 3.4112 - val_accuracy20: 0.3364 - 16s/epoch - 46ms/step
Epoch 2/50
346/346 - 14s - loss: 3.2880 - accuracy20: 0.3743 - val_loss: 3.3427 - val_accuracy20: 0.3405 - 14s/epoch - 40ms/step
Epoch 3/50
346/346 - 14s - loss: 3.2903 - accuracy20: 0.3705 - val_loss: 3.3524 - val_accuracy20: 0.3352 - 14s/epoch - 40ms/step
Epoch 4/50
346/346 - 14s - loss: 3.2900 - accuracy20: 0.3664 - val_loss: 3.2985 - val_accuracy20: 0.3452 - 14s/epoch - 40ms/step
Epoch 5/50
346/346 - 14s - loss: 3.2909 - accuracy20: 0.3592 - val_loss: 3.2895 - val_accuracy20: 0.3562 - 14s/epoch - 40ms/step
Epoch 6/50
346/346 - 14s - loss: 3.2879 - accuracy20: 0.3689 - val_loss: 3.2838 - val_accuracy20: 0.3712 - 14s/epoch - 40ms/step
Epoch 7/50
346/346 - 14s - loss: 3.2866 - accuracy20: 0.3622 - val_loss: 3.2778 - val_accuracy20: 0.3741 - 14s/epoch - 40ms/step
Epoch 8/50
346/346 - 14s - loss: 3.2811 - accuracy20: 0.3665 - val_loss: 3.2720 - val_accuracy20: 0.3786 - 14s/epoch - 40ms/step
Epoch 9/50
346/346 - 14s - loss: 3.2748 - accuracy20: 0.3744 - val_loss: 3.2721 - val_accuracy20: 0.3828 - 14s/epoch - 39ms/step
Epoch 10/50
346/346 - 14s - loss: 3.2723 - accuracy20: 0.3781 - val_loss: 3.2676 - val_accuracy20: 0.3853 - 14s/epoch - 40ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2683 - accuracy20: 0.3784 - val_loss: 3.2662 - val_accuracy20: 0.3877 - 14s/epoch - 40ms/step
Epoch 12/50
346/346 - 14s - loss: 3.2653 - accuracy20: 0.3805 - val_loss: 3.2635 - val_accuracy20: 0.3861 - 14s/epoch - 41ms/step
Epoch 13/50
346/346 - 14s - loss: 3.2583 - accuracy20: 0.3848 - val_loss: 3.2584 - val_accuracy20: 0.3973 - 14s/epoch - 40ms/step
Epoch 14/50
346/346 - 13s - loss: 3.2550 - accuracy20: 0.3865 - val_loss: 3.2566 - val_accuracy20: 0.3954 - 13s/epoch - 39ms/step
Epoch 15/50
346/346 - 14s - loss: 3.2511 - accuracy20: 0.3904 - val_loss: 3.2561 - val_accuracy20: 0.3932 - 14s/epoch - 39ms/step
Epoch 16/50
346/346 - 14s - loss: 3.2457 - accuracy20: 0.3906 - val_loss: 3.2551 - val_accuracy20: 0.3964 - 14s/epoch - 40ms/step
Epoch 17/50
346/346 - 14s - loss: 3.2428 - accuracy20: 0.3950 - val_loss: 3.2587 - val_accuracy20: 0.3878 - 14s/epoch - 40ms/step
Epoch 18/50
346/346 - 14s - loss: 3.2390 - accuracy20: 0.3951 - val_loss: 3.2495 - val_accuracy20: 0.3997 - 14s/epoch - 40ms/step
Epoch 19/50
346/346 - 14s - loss: 3.2340 - accuracy20: 0.3995 - val_loss: 3.2623 - val_accuracy20: 0.3808 - 14s/epoch - 40ms/step
Epoch 20/50
346/346 - 14s - loss: 3.2317 - accuracy20: 0.3988 - val_loss: 3.2495 - val_accuracy20: 0.3951 - 14s/epoch - 40ms/step
Epoch 21/50
346/346 - 14s - loss: 3.2270 - accuracy20: 0.4011 - val_loss: 3.2503 - val_accuracy20: 0.4002 - 14s/epoch - 40ms/step
Epoch 22/50
346/346 - 14s - loss: 3.2233 - accuracy20: 0.4043 - val_loss: 3.2387 - val_accuracy20: 0.4058 - 14s/epoch - 39ms/step
Epoch 23/50
346/346 - 14s - loss: 3.2200 - accuracy20: 0.4056 - val_loss: 3.2459 - val_accuracy20: 0.4006 - 14s/epoch - 40ms/step
Epoch 24/50
346/346 - 14s - loss: 3.2162 - accuracy20: 0.4070 - val_loss: 3.2439 - val_accuracy20: 0.4053 - 14s/epoch - 40ms/step
Epoch 25/50
346/346 - 14s - loss: 3.2139 - accuracy20: 0.4063 - val_loss: 3.2617 - val_accuracy20: 0.3735 - 14s/epoch - 39ms/step
Epoch 26/50
346/346 - 14s - loss: 3.2091 - accuracy20: 0.4084 - val_loss: 3.2681 - val_accuracy20: 0.3768 - 14s/epoch - 39ms/step
Epoch 27/50
346/346 - 14s - loss: 3.2057 - accuracy20: 0.4126 - val_loss: 3.2639 - val_accuracy20: 0.3784 - 14s/epoch - 39ms/step
Epoch 28/50
346/346 - 14s - loss: 3.2089 - accuracy20: 0.4085 - val_loss: 3.2372 - val_accuracy20: 0.4064 - 14s/epoch - 40ms/step
Epoch 29/50
346/346 - 14s - loss: 3.1969 - accuracy20: 0.4165 - val_loss: 3.2776 - val_accuracy20: 0.3798 - 14s/epoch - 40ms/step
Epoch 30/50
346/346 - 14s - loss: 3.1985 - accuracy20: 0.4163 - val_loss: 3.2482 - val_accuracy20: 0.3953 - 14s/epoch - 40ms/step
Epoch 31/50
346/346 - 13s - loss: 3.1957 - accuracy20: 0.4175 - val_loss: 3.2373 - val_accuracy20: 0.4089 - 13s/epoch - 39ms/step
Epoch 32/50
346/346 - 14s - loss: 3.1884 - accuracy20: 0.4187 - val_loss: 3.2874 - val_accuracy20: 0.3809 - 14s/epoch - 40ms/step
Epoch 33/50
346/346 - 14s - loss: 3.1872 - accuracy20: 0.4197 - val_loss: 3.2643 - val_accuracy20: 0.3759 - 14s/epoch - 40ms/step
Epoch 34/50
346/346 - 14s - loss: 3.1883 - accuracy20: 0.4210 - val_loss: 3.2376 - val_accuracy20: 0.4078 - 14s/epoch - 40ms/step
Epoch 35/50
346/346 - 13s - loss: 3.1837 - accuracy20: 0.4227 - val_loss: 3.2869 - val_accuracy20: 0.3798 - 13s/epoch - 38ms/step
Epoch 36/50
346/346 - 14s - loss: 3.1782 - accuracy20: 0.4258 - val_loss: 3.2354 - val_accuracy20: 0.4154 - 14s/epoch - 39ms/step
Epoch 37/50
346/346 - 13s - loss: 3.1731 - accuracy20: 0.4256 - val_loss: 3.2584 - val_accuracy20: 0.3814 - 13s/epoch - 39ms/step
Epoch 38/50
346/346 - 14s - loss: 3.1692 - accuracy20: 0.4270 - val_loss: 3.2617 - val_accuracy20: 0.3894 - 14s/epoch - 39ms/step
Epoch 39/50
346/346 - 13s - loss: 3.1648 - accuracy20: 0.4301 - val_loss: 3.2487 - val_accuracy20: 0.4029 - 13s/epoch - 39ms/step
Epoch 40/50
346/346 - 13s - loss: 3.1622 - accuracy20: 0.4315 - val_loss: 3.2802 - val_accuracy20: 0.3789 - 13s/epoch - 39ms/step
Epoch 41/50
346/346 - 13s - loss: 3.1609 - accuracy20: 0.4320 - val_loss: 3.2859 - val_accuracy20: 0.3849 - 13s/epoch - 39ms/step
Epoch 42/50
346/346 - 14s - loss: 3.1538 - accuracy20: 0.4350 - val_loss: 3.2464 - val_accuracy20: 0.4054 - 14s/epoch - 39ms/step
Epoch 43/50
346/346 - 14s - loss: 3.1503 - accuracy20: 0.4371 - val_loss: 3.2896 - val_accuracy20: 0.3797 - 14s/epoch - 39ms/step
Epoch 44/50
346/346 - 14s - loss: 3.1467 - accuracy20: 0.4378 - val_loss: 3.2907 - val_accuracy20: 0.3802 - 14s/epoch - 39ms/step
Epoch 45/50
346/346 - 13s - loss: 3.1412 - accuracy20: 0.4384 - val_loss: 3.2860 - val_accuracy20: 0.3798 - 13s/epoch - 39ms/step
Epoch 46/50
346/346 - 13s - loss: 3.1401 - accuracy20: 0.4399 - val_loss: 3.2875 - val_accuracy20: 0.3794 - 13s/epoch - 39ms/step
testing model: results/CHTR/W4/deepVOL_L3/h20
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631311
{'0': {'precision': 0.38190030779070233, 'recall': 0.26845373570485265, 'f1-score': 0.31528231528231526, 'support': 71178}, '1': {'precision': 0.4850676734282579, 'recall': 0.6876981486555247, 'f1-score': 0.5688776645904412, 'support': 102196}, '2': {'precision': 0.36214779881741793, 'recall': 0.23891345546430828, 'f1-score': 0.28789738612467053, 'support': 63320}, 'accuracy': 0.44156590365619747, 'macro avg': {'precision': 0.40970526001212604, 'recall': 0.3983551132748952, 'f1-score': 0.390685788665809, 'support': 236694}, 'weighted avg': {'precision': 0.4211601252364646, 'recall': 0.44156590365619747, 'f1-score': 0.4174497407499282, 'support': 236694}}
[[19108 39709 12361]
 [17632 70280 14284]
 [13294 34898 15128]]
Evaluating performance on  train set...
346/346 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0623417
{'0': {'precision': 0.4297152171828555, 'recall': 0.3004592537963863, 'f1-score': 0.3536467478151078, 'support': 29831}, '1': {'precision': 0.40643863179074446, 'recall': 0.649029258955428, 'f1-score': 0.49985521362571395, 'support': 29256}, '2': {'precision': 0.446746689530342, 'recall': 0.3181155242003867, 'f1-score': 0.3716147948570636, 'support': 29483}, 'accuracy': 0.42147453991193407, 'macro avg': {'precision': 0.42763351283464734, 'recall': 0.42253467898406694, 'f1-score': 0.4083722520992951, 'support': 88570}, 'weighted avg': {'precision': 0.4276960133552541, 'recall': 0.42147453991193407, 'f1-score': 0.40792276460062293, 'support': 88570}}
[[ 8963 14428  6440]
 [ 5093 18988  5175]
 [ 6802 13302  9379]]
Evaluating performance on  val set...
127/127 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0783345
{'0': {'precision': 0.42631045834388454, 'recall': 0.31060885608856087, 'f1-score': 0.3593766677340164, 'support': 10840}, '1': {'precision': 0.4117059411177058, 'recall': 0.6343141693073789, 'f1-score': 0.49932292780272247, 'support': 11045}, '2': {'precision': 0.40715062533985863, 'recall': 0.28836895821297903, 'f1-score': 0.3376169541201669, 'support': 10386}, 'accuracy': 0.41424188900250997, 'macro avg': {'precision': 0.41505567493381634, 'recall': 0.41109732786963954, 'f1-score': 0.39877218321896857, 'support': 32271}, 'weighted avg': {'precision': 0.4151456069806495, 'recall': 0.41424188900250997, 'f1-score': 0.4002712807570221, 'support': 32271}}
[[3367 5118 2355]
 [2033 7006 2006]
 [2498 4893 2995]]
training model: results/CHTR/W4/deepVOL_L3/h30
Epoch 1/50
346/346 - 17s - loss: 3.3194 - accuracy30: 0.3644 - val_loss: 3.3332 - val_accuracy30: 0.3393 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 15s - loss: 3.3057 - accuracy30: 0.3558 - val_loss: 3.3053 - val_accuracy30: 0.3362 - 15s/epoch - 42ms/step
Epoch 3/50
346/346 - 15s - loss: 3.3087 - accuracy30: 0.3386 - val_loss: 3.3034 - val_accuracy30: 0.3339 - 15s/epoch - 42ms/step
Epoch 4/50
346/346 - 14s - loss: 3.3085 - accuracy30: 0.3397 - val_loss: 3.3016 - val_accuracy30: 0.3354 - 14s/epoch - 40ms/step
Epoch 5/50
346/346 - 14s - loss: 3.3049 - accuracy30: 0.3439 - val_loss: 3.2983 - val_accuracy30: 0.3379 - 14s/epoch - 42ms/step
Epoch 6/50
346/346 - 14s - loss: 3.3015 - accuracy30: 0.3467 - val_loss: 3.2913 - val_accuracy30: 0.3524 - 14s/epoch - 42ms/step
Epoch 7/50
346/346 - 15s - loss: 3.2955 - accuracy30: 0.3541 - val_loss: 3.2892 - val_accuracy30: 0.3582 - 15s/epoch - 42ms/step
Epoch 8/50
346/346 - 15s - loss: 3.2929 - accuracy30: 0.3513 - val_loss: 3.2851 - val_accuracy30: 0.3660 - 15s/epoch - 42ms/step
Epoch 9/50
346/346 - 15s - loss: 3.2910 - accuracy30: 0.3559 - val_loss: 3.2825 - val_accuracy30: 0.3719 - 15s/epoch - 42ms/step
Epoch 10/50
346/346 - 14s - loss: 3.2886 - accuracy30: 0.3621 - val_loss: 3.2805 - val_accuracy30: 0.3736 - 14s/epoch - 41ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2826 - accuracy30: 0.3682 - val_loss: 3.2766 - val_accuracy30: 0.3776 - 14s/epoch - 41ms/step
Epoch 12/50
346/346 - 15s - loss: 3.2753 - accuracy30: 0.3751 - val_loss: 3.2707 - val_accuracy30: 0.3845 - 15s/epoch - 42ms/step
Epoch 13/50
346/346 - 14s - loss: 3.2713 - accuracy30: 0.3757 - val_loss: 3.2717 - val_accuracy30: 0.3821 - 14s/epoch - 41ms/step
Epoch 14/50
346/346 - 14s - loss: 3.2654 - accuracy30: 0.3797 - val_loss: 3.2695 - val_accuracy30: 0.3855 - 14s/epoch - 41ms/step
Epoch 15/50
346/346 - 14s - loss: 3.2574 - accuracy30: 0.3840 - val_loss: 3.2620 - val_accuracy30: 0.3919 - 14s/epoch - 42ms/step
Epoch 16/50
346/346 - 14s - loss: 3.2575 - accuracy30: 0.3865 - val_loss: 3.2727 - val_accuracy30: 0.3827 - 14s/epoch - 41ms/step
Epoch 17/50
346/346 - 14s - loss: 3.2565 - accuracy30: 0.3890 - val_loss: 3.2624 - val_accuracy30: 0.3906 - 14s/epoch - 41ms/step
Epoch 18/50
346/346 - 14s - loss: 3.2520 - accuracy30: 0.3891 - val_loss: 3.2642 - val_accuracy30: 0.3891 - 14s/epoch - 40ms/step
Epoch 19/50
346/346 - 14s - loss: 3.2486 - accuracy30: 0.3938 - val_loss: 3.2635 - val_accuracy30: 0.3882 - 14s/epoch - 40ms/step
Epoch 20/50
346/346 - 14s - loss: 3.2454 - accuracy30: 0.3917 - val_loss: 3.2624 - val_accuracy30: 0.3931 - 14s/epoch - 41ms/step
Epoch 21/50
346/346 - 14s - loss: 3.2420 - accuracy30: 0.3962 - val_loss: 3.2587 - val_accuracy30: 0.3927 - 14s/epoch - 42ms/step
Epoch 22/50
346/346 - 14s - loss: 3.2411 - accuracy30: 0.3981 - val_loss: 3.2732 - val_accuracy30: 0.3831 - 14s/epoch - 42ms/step
Epoch 23/50
346/346 - 14s - loss: 3.2352 - accuracy30: 0.3994 - val_loss: 3.2643 - val_accuracy30: 0.3947 - 14s/epoch - 41ms/step
Epoch 24/50
346/346 - 14s - loss: 3.2313 - accuracy30: 0.4033 - val_loss: 3.2617 - val_accuracy30: 0.3936 - 14s/epoch - 40ms/step
Epoch 25/50
346/346 - 14s - loss: 3.2280 - accuracy30: 0.4037 - val_loss: 3.2583 - val_accuracy30: 0.3943 - 14s/epoch - 41ms/step
Epoch 26/50
346/346 - 14s - loss: 3.2266 - accuracy30: 0.4053 - val_loss: 3.2626 - val_accuracy30: 0.3927 - 14s/epoch - 41ms/step
Epoch 27/50
346/346 - 14s - loss: 3.2239 - accuracy30: 0.4059 - val_loss: 3.2599 - val_accuracy30: 0.3981 - 14s/epoch - 41ms/step
Epoch 28/50
346/346 - 14s - loss: 3.2201 - accuracy30: 0.4074 - val_loss: 3.2601 - val_accuracy30: 0.3967 - 14s/epoch - 41ms/step
Epoch 29/50
346/346 - 14s - loss: 3.2171 - accuracy30: 0.4090 - val_loss: 3.2570 - val_accuracy30: 0.3970 - 14s/epoch - 41ms/step
Epoch 30/50
346/346 - 14s - loss: 3.2094 - accuracy30: 0.4119 - val_loss: 3.2584 - val_accuracy30: 0.3973 - 14s/epoch - 41ms/step
Epoch 31/50
346/346 - 14s - loss: 3.2069 - accuracy30: 0.4134 - val_loss: 3.2560 - val_accuracy30: 0.4021 - 14s/epoch - 41ms/step
Epoch 32/50
346/346 - 14s - loss: 3.2019 - accuracy30: 0.4137 - val_loss: 3.2588 - val_accuracy30: 0.4037 - 14s/epoch - 41ms/step
Epoch 33/50
346/346 - 14s - loss: 3.2003 - accuracy30: 0.4167 - val_loss: 3.2538 - val_accuracy30: 0.4038 - 14s/epoch - 41ms/step
Epoch 34/50
346/346 - 14s - loss: 3.1963 - accuracy30: 0.4163 - val_loss: 3.2598 - val_accuracy30: 0.4022 - 14s/epoch - 41ms/step
Epoch 35/50
346/346 - 14s - loss: 3.1919 - accuracy30: 0.4195 - val_loss: 3.2545 - val_accuracy30: 0.4034 - 14s/epoch - 41ms/step
Epoch 36/50
346/346 - 14s - loss: 3.1896 - accuracy30: 0.4189 - val_loss: 3.2586 - val_accuracy30: 0.4012 - 14s/epoch - 41ms/step
Epoch 37/50
346/346 - 14s - loss: 3.1877 - accuracy30: 0.4190 - val_loss: 3.3046 - val_accuracy30: 0.3762 - 14s/epoch - 41ms/step
Epoch 38/50
346/346 - 14s - loss: 3.1864 - accuracy30: 0.4196 - val_loss: 3.2613 - val_accuracy30: 0.4018 - 14s/epoch - 41ms/step
Epoch 39/50
346/346 - 14s - loss: 3.1818 - accuracy30: 0.4234 - val_loss: 3.2611 - val_accuracy30: 0.4019 - 14s/epoch - 41ms/step
Epoch 40/50
346/346 - 14s - loss: 3.1770 - accuracy30: 0.4224 - val_loss: 3.2578 - val_accuracy30: 0.4031 - 14s/epoch - 41ms/step
Epoch 41/50
346/346 - 14s - loss: 3.1764 - accuracy30: 0.4242 - val_loss: 3.2585 - val_accuracy30: 0.4027 - 14s/epoch - 40ms/step
Epoch 42/50
346/346 - 14s - loss: 3.1739 - accuracy30: 0.4242 - val_loss: 3.2634 - val_accuracy30: 0.4018 - 14s/epoch - 40ms/step
Epoch 43/50
346/346 - 14s - loss: 3.1726 - accuracy30: 0.4267 - val_loss: 3.2560 - val_accuracy30: 0.4046 - 14s/epoch - 41ms/step
testing model: results/CHTR/W4/deepVOL_L3/h30
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746515
{'0': {'precision': 0.36070586915048813, 'recall': 0.35956595911290096, 'f1-score': 0.36013501211467625, 'support': 71514}, '1': {'precision': 0.4693266034895307, 'recall': 0.6430721090604695, 'f1-score': 0.5426307048708193, 'support': 100348}, '2': {'precision': 0.38281557920384107, 'recall': 0.16479516288252716, 'f1-score': 0.23040510669498923, 'support': 64832}, 'accuracy': 0.4264113158761946, 'macro avg': {'precision': 0.40428268394795325, 'recall': 0.38914441035196584, 'f1-score': 0.3777236078934949, 'support': 236694}, 'weighted avg': {'precision': 0.4128123449024431, 'recall': 0.4264113158761946, 'f1-score': 0.40197142769143057, 'support': 236694}}
[[25714 37625  8175]
 [26767 64531  9050]
 [18807 35341 10684]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0710982
{'0': {'precision': 0.40969966791957085, 'recall': 0.3737847915834332, 'f1-score': 0.3909190619613851, 'support': 30036}, '1': {'precision': 0.400373937430702, 'recall': 0.6279751756120848, 'f1-score': 0.4889874274789904, 'support': 29326}, '2': {'precision': 0.45240606460118654, 'recall': 0.23496987126814572, 'f1-score': 0.30929739961242053, 'support': 29208}, 'accuracy': 0.4121711640510331, 'macro avg': {'precision': 0.42082655665048646, 'recall': 0.4122432794878879, 'f1-score': 0.39640129635093196, 'support': 88570}, 'weighted avg': {'precision': 0.42069528790331323, 'recall': 0.4121711640510331, 'f1-score': 0.3964733960844599, 'support': 88570}}
[[11227 14191  4618]
 [ 7221 18416  3689]
 [ 8955 13390  6863]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0844117
{'0': {'precision': 0.40711847879083374, 'recall': 0.3821160534504851, 'f1-score': 0.3942212360134083, 'support': 10926}, '1': {'precision': 0.4017179502265106, 'recall': 0.6336302895322939, 'f1-score': 0.4917005724984697, 'support': 10776}, '2': {'precision': 0.41920701334927274, 'recall': 0.19907275995836882, 'f1-score': 0.2699512445470875, 'support': 10569}, 'accuracy': 0.4061541321929906, 'macro avg': {'precision': 0.4093478141222057, 'recall': 0.4049397009803826, 'f1-score': 0.38529101768632185, 'support': 32271}, 'weighted avg': {'precision': 0.4092742107464284, 'recall': 0.4061541321929906, 'f1-score': 0.3860723652054221, 'support': 32271}}
[[4175 5092 1659]
 [2692 6828 1256]
 [3388 5077 2104]]
training model: results/CHTR/W4/deepVOL_L3/h50
Epoch 1/50
346/346 - 16s - loss: 3.3118 - accuracy50: 0.3686 - val_loss: 3.3571 - val_accuracy50: 0.3370 - 16s/epoch - 46ms/step
Epoch 2/50
346/346 - 14s - loss: 3.3046 - accuracy50: 0.3601 - val_loss: 3.3076 - val_accuracy50: 0.3329 - 14s/epoch - 40ms/step
Epoch 3/50
346/346 - 14s - loss: 3.3066 - accuracy50: 0.3403 - val_loss: 3.3064 - val_accuracy50: 0.3274 - 14s/epoch - 40ms/step
Epoch 4/50
346/346 - 14s - loss: 3.3098 - accuracy50: 0.3297 - val_loss: 3.3005 - val_accuracy50: 0.3274 - 14s/epoch - 41ms/step
Epoch 5/50
346/346 - 14s - loss: 3.3075 - accuracy50: 0.3312 - val_loss: 3.2991 - val_accuracy50: 0.3312 - 14s/epoch - 40ms/step
Epoch 6/50
346/346 - 14s - loss: 3.3067 - accuracy50: 0.3317 - val_loss: 3.2971 - val_accuracy50: 0.3336 - 14s/epoch - 39ms/step
Epoch 7/50
346/346 - 14s - loss: 3.3028 - accuracy50: 0.3344 - val_loss: 3.2926 - val_accuracy50: 0.3520 - 14s/epoch - 41ms/step
Epoch 8/50
346/346 - 14s - loss: 3.2996 - accuracy50: 0.3413 - val_loss: 3.2906 - val_accuracy50: 0.3550 - 14s/epoch - 40ms/step
Epoch 9/50
346/346 - 14s - loss: 3.2980 - accuracy50: 0.3441 - val_loss: 3.2885 - val_accuracy50: 0.3578 - 14s/epoch - 39ms/step
Epoch 10/50
346/346 - 14s - loss: 3.2955 - accuracy50: 0.3476 - val_loss: 3.2867 - val_accuracy50: 0.3605 - 14s/epoch - 40ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2933 - accuracy50: 0.3527 - val_loss: 3.2861 - val_accuracy50: 0.3619 - 14s/epoch - 39ms/step
Epoch 12/50
346/346 - 14s - loss: 3.2899 - accuracy50: 0.3558 - val_loss: 3.2829 - val_accuracy50: 0.3675 - 14s/epoch - 39ms/step
Epoch 13/50
346/346 - 13s - loss: 3.2871 - accuracy50: 0.3619 - val_loss: 3.2843 - val_accuracy50: 0.3655 - 13s/epoch - 39ms/step
Epoch 14/50
346/346 - 14s - loss: 3.2847 - accuracy50: 0.3659 - val_loss: 3.2827 - val_accuracy50: 0.3670 - 14s/epoch - 39ms/step
Epoch 15/50
346/346 - 14s - loss: 3.2822 - accuracy50: 0.3662 - val_loss: 3.2849 - val_accuracy50: 0.3682 - 14s/epoch - 40ms/step
Epoch 16/50
346/346 - 14s - loss: 3.2783 - accuracy50: 0.3712 - val_loss: 3.2827 - val_accuracy50: 0.3697 - 14s/epoch - 40ms/step
Epoch 17/50
346/346 - 14s - loss: 3.2798 - accuracy50: 0.3682 - val_loss: 3.2841 - val_accuracy50: 0.3673 - 14s/epoch - 41ms/step
Epoch 18/50
346/346 - 14s - loss: 3.2762 - accuracy50: 0.3739 - val_loss: 3.2785 - val_accuracy50: 0.3739 - 14s/epoch - 41ms/step
Epoch 19/50
346/346 - 14s - loss: 3.2747 - accuracy50: 0.3756 - val_loss: 3.2802 - val_accuracy50: 0.3751 - 14s/epoch - 40ms/step
Epoch 20/50
346/346 - 14s - loss: 3.2720 - accuracy50: 0.3775 - val_loss: 3.2805 - val_accuracy50: 0.3766 - 14s/epoch - 39ms/step
Epoch 21/50
346/346 - 13s - loss: 3.2735 - accuracy50: 0.3762 - val_loss: 3.2809 - val_accuracy50: 0.3741 - 13s/epoch - 38ms/step
Epoch 22/50
346/346 - 13s - loss: 3.2703 - accuracy50: 0.3780 - val_loss: 3.2798 - val_accuracy50: 0.3779 - 13s/epoch - 38ms/step
Epoch 23/50
346/346 - 13s - loss: 3.2668 - accuracy50: 0.3802 - val_loss: 3.2797 - val_accuracy50: 0.3779 - 13s/epoch - 38ms/step
Epoch 24/50
346/346 - 13s - loss: 3.2639 - accuracy50: 0.3828 - val_loss: 3.2777 - val_accuracy50: 0.3800 - 13s/epoch - 38ms/step
Epoch 25/50
346/346 - 13s - loss: 3.2618 - accuracy50: 0.3832 - val_loss: 3.2848 - val_accuracy50: 0.3747 - 13s/epoch - 38ms/step
Epoch 26/50
346/346 - 13s - loss: 3.2586 - accuracy50: 0.3875 - val_loss: 3.2866 - val_accuracy50: 0.3719 - 13s/epoch - 38ms/step
Epoch 27/50
346/346 - 13s - loss: 3.2579 - accuracy50: 0.3876 - val_loss: 3.2826 - val_accuracy50: 0.3757 - 13s/epoch - 38ms/step
Epoch 28/50
346/346 - 13s - loss: 3.2555 - accuracy50: 0.3871 - val_loss: 3.2780 - val_accuracy50: 0.3823 - 13s/epoch - 38ms/step
Epoch 29/50
346/346 - 13s - loss: 3.2508 - accuracy50: 0.3922 - val_loss: 3.2838 - val_accuracy50: 0.3759 - 13s/epoch - 38ms/step
Epoch 30/50
346/346 - 13s - loss: 3.2485 - accuracy50: 0.3928 - val_loss: 3.2865 - val_accuracy50: 0.3792 - 13s/epoch - 38ms/step
Epoch 31/50
346/346 - 13s - loss: 3.2443 - accuracy50: 0.3945 - val_loss: 3.2843 - val_accuracy50: 0.3771 - 13s/epoch - 38ms/step
Epoch 32/50
346/346 - 13s - loss: 3.2431 - accuracy50: 0.3945 - val_loss: 3.2870 - val_accuracy50: 0.3786 - 13s/epoch - 38ms/step
Epoch 33/50
346/346 - 13s - loss: 3.2379 - accuracy50: 0.3940 - val_loss: 3.2953 - val_accuracy50: 0.3741 - 13s/epoch - 38ms/step
Epoch 34/50
346/346 - 13s - loss: 3.2353 - accuracy50: 0.3970 - val_loss: 3.2943 - val_accuracy50: 0.3769 - 13s/epoch - 38ms/step
testing model: results/CHTR/W4/deepVOL_L3/h50
Evaluating performance on  test set...
925/925 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893527
{'0': {'precision': 0.3342290097107192, 'recall': 0.26760985307534146, 'f1-score': 0.2972323049001815, 'support': 73439}, '1': {'precision': 0.4290360571860888, 'recall': 0.5793670019484966, 'f1-score': 0.4929959938698142, 'support': 94945}, '2': {'precision': 0.3494162640901771, 'recall': 0.25412091933831066, 'f1-score': 0.2942452750233071, 'support': 68310}, 'accuracy': 0.3887720009801685, 'macro avg': {'precision': 0.37089377699566173, 'recall': 0.36703259145404954, 'f1-score': 0.36149119126443424, 'support': 236694}, 'weighted avg': {'precision': 0.3766419837160161, 'recall': 0.3887720009801685, 'f1-score': 0.37489688211097894, 'support': 236694}}
[[19653 37482 16304]
 [23920 55008 16017]
 [15228 35723 17359]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861948
{'0': {'precision': 0.39606182727133604, 'recall': 0.25622916735421275, 'f1-score': 0.3111574222507214, 'support': 30301}, '1': {'precision': 0.3802520527892775, 'recall': 0.5737308900162198, 'f1-score': 0.45737159206580646, 'support': 28977}, '2': {'precision': 0.4008159708468668, 'recall': 0.3454526833265055, 'f1-score': 0.37108071436429646, 'support': 29292}, 'accuracy': 0.3896127356892853, 'macro avg': {'precision': 0.3923766169691601, 'recall': 0.39180424689897936, 'f1-score': 0.3798699095602747, 'support': 88570}, 'weighted avg': {'precision': 0.392461720445637, 'recall': 0.3896127356892853, 'f1-score': 0.3788114932829283, 'support': 88570}}
[[ 7764 14045  8492]
 [ 5717 16625  6635]
 [ 6122 13051 10119]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930805
{'0': {'precision': 0.37877821706415, 'recall': 0.271034860375981, 'f1-score': 0.3159742539496782, 'support': 10958}, '1': {'precision': 0.3760090817356206, 'recall': 0.5664069922097663, 'f1-score': 0.45197483132438787, 'support': 10526}, '2': {'precision': 0.3824352694191743, 'recall': 0.3039770093631223, 'f1-score': 0.33872217344145444, 'support': 10787}, 'accuracy': 0.37838926590437233, 'macro avg': {'precision': 0.37907418940631493, 'recall': 0.38047295398295655, 'f1-score': 0.36889041957184016, 'support': 32271}, 'weighted avg': {'precision': 0.37909741093126115, 'recall': 0.37838926590437233, 'f1-score': 0.36793805689981873, 'support': 32271}}
[[2970 4967 3021]
 [2290 5962 2274]
 [2581 4927 3279]]
training model: results/CHTR/W4/deepVOL_L3/h100
Epoch 1/50
346/346 - 16s - loss: 3.3126 - accuracy100: 0.3712 - val_loss: 3.4245 - val_accuracy100: 0.3513 - 16s/epoch - 47ms/step
Epoch 2/50
346/346 - 14s - loss: 3.2920 - accuracy100: 0.3742 - val_loss: 3.3153 - val_accuracy100: 0.3417 - 14s/epoch - 39ms/step
Epoch 3/50
346/346 - 13s - loss: 3.2837 - accuracy100: 0.3775 - val_loss: 3.3045 - val_accuracy100: 0.3410 - 13s/epoch - 38ms/step
Epoch 4/50
346/346 - 13s - loss: 3.2967 - accuracy100: 0.3633 - val_loss: 3.3146 - val_accuracy100: 0.3218 - 13s/epoch - 38ms/step
Epoch 5/50
346/346 - 13s - loss: 3.3009 - accuracy100: 0.3506 - val_loss: 3.3178 - val_accuracy100: 0.3116 - 13s/epoch - 38ms/step
Epoch 6/50
346/346 - 13s - loss: 3.3021 - accuracy100: 0.3360 - val_loss: 3.3064 - val_accuracy100: 0.3164 - 13s/epoch - 38ms/step
Epoch 7/50
346/346 - 13s - loss: 3.2991 - accuracy100: 0.3366 - val_loss: 3.3007 - val_accuracy100: 0.3283 - 13s/epoch - 38ms/step
Epoch 8/50
346/346 - 13s - loss: 3.2976 - accuracy100: 0.3381 - val_loss: 3.3015 - val_accuracy100: 0.3318 - 13s/epoch - 37ms/step
Epoch 9/50
346/346 - 13s - loss: 3.2955 - accuracy100: 0.3426 - val_loss: 3.3010 - val_accuracy100: 0.3317 - 13s/epoch - 38ms/step
Epoch 10/50
346/346 - 13s - loss: 3.2940 - accuracy100: 0.3430 - val_loss: 3.3022 - val_accuracy100: 0.3381 - 13s/epoch - 38ms/step
Epoch 11/50
346/346 - 13s - loss: 3.2907 - accuracy100: 0.3505 - val_loss: 3.3089 - val_accuracy100: 0.3299 - 13s/epoch - 38ms/step
Epoch 12/50
346/346 - 13s - loss: 3.2920 - accuracy100: 0.3472 - val_loss: 3.3042 - val_accuracy100: 0.3381 - 13s/epoch - 38ms/step
Epoch 13/50
346/346 - 13s - loss: 3.2889 - accuracy100: 0.3510 - val_loss: 3.3019 - val_accuracy100: 0.3388 - 13s/epoch - 38ms/step
Epoch 14/50
346/346 - 13s - loss: 3.2880 - accuracy100: 0.3553 - val_loss: 3.3060 - val_accuracy100: 0.3341 - 13s/epoch - 38ms/step
Epoch 15/50
346/346 - 13s - loss: 3.2891 - accuracy100: 0.3512 - val_loss: 3.3043 - val_accuracy100: 0.3387 - 13s/epoch - 38ms/step
Epoch 16/50
346/346 - 13s - loss: 3.2857 - accuracy100: 0.3561 - val_loss: 3.3051 - val_accuracy100: 0.3442 - 13s/epoch - 38ms/step
Epoch 17/50
346/346 - 13s - loss: 3.2833 - accuracy100: 0.3570 - val_loss: 3.3068 - val_accuracy100: 0.3442 - 13s/epoch - 38ms/step
testing model: results/CHTR/W4/deepVOL_L3/h100
Evaluating performance on  test set...
925/925 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095918
{'0': {'precision': 0.3333428685851593, 'recall': 0.3141478406211247, 'f1-score': 0.32346083384222507, 'support': 74188}, '1': {'precision': 0.39820707249663384, 'recall': 0.6071420853592653, 'f1-score': 0.48096379354617824, 'support': 92550}, '2': {'precision': 0.30002337540906965, 'recall': 0.11008348104522843, 'f1-score': 0.16106835104157954, 'support': 69956}, 'accuracy': 0.3683997059494537, 'macro avg': {'precision': 0.3438577721636209, 'recall': 0.34379113567520614, 'f1-score': 0.3218309928099943, 'support': 236694}, 'weighted avg': {'precision': 0.34885776802232477, 'recall': 0.3683997059494537, 'f1-score': 0.3370504068512532, 'support': 236694}}
[[23306 42605  8277]
 [26669 56191  9690]
 [19941 42314  7701]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980597
{'0': {'precision': 0.36282245206655495, 'recall': 0.2925566983122363, 'f1-score': 0.32392284249137726, 'support': 30336}, '1': {'precision': 0.33190625171524235, 'recall': 0.6242816339172029, 'f1-score': 0.43339385541593006, 'support': 29059}, '2': {'precision': 0.35823106220905626, 'recall': 0.11605826906598114, 'f1-score': 0.1753177828979729, 'support': 29175}, 'accuracy': 0.34325392345037825, 'macro avg': {'precision': 0.35098658866361787, 'recall': 0.34429886709847346, 'f1-score': 0.31087816026842674, 'support': 88570}, 'weighted avg': {'precision': 0.3511667259166022, 'recall': 0.34325392345037825, 'f1-score': 0.3108886949350603, 'support': 88570}}
[[ 8875 18294  3167]
 [ 8019 18141  2899]
 [ 7567 18222  3386]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004672
{'0': {'precision': 0.3384115604346365, 'recall': 0.27466133284844074, 'f1-score': 0.3032219211081, 'support': 10999}, '1': {'precision': 0.31587254611818094, 'recall': 0.6396324410707152, 'f1-score': 0.4229016707389553, 'support': 10012}, '2': {'precision': 0.35765472312703583, 'recall': 0.0975133214920071, 'f1-score': 0.15324494068387998, 'support': 11260}, 'accuracy': 0.3260822410213504, 'macro avg': {'precision': 0.33731294322661776, 'recall': 0.33726903180372103, 'f1-score': 0.29312284417697837, 'support': 32271}, 'weighted avg': {'precision': 0.3381332114705531, 'recall': 0.3260822410213504, 'f1-score': 0.28802229462386975, 'support': 32271}}
[[3021 6833 1145]
 [2781 6404  827]
 [3125 7037 1098]]
training model: results/CHTR/W4/deepVOL_L3/h200
Epoch 1/50
346/346 - 15s - loss: 3.3173 - accuracy200: 0.3726 - val_loss: 3.3319 - val_accuracy200: 0.3473 - 15s/epoch - 45ms/step
Epoch 2/50
346/346 - 13s - loss: 3.3111 - accuracy200: 0.3533 - val_loss: 3.3543 - val_accuracy200: 0.2994 - 13s/epoch - 38ms/step
Epoch 3/50
346/346 - 13s - loss: 3.3081 - accuracy200: 0.3449 - val_loss: 3.3386 - val_accuracy200: 0.2979 - 13s/epoch - 38ms/step
Epoch 4/50
346/346 - 13s - loss: 3.3065 - accuracy200: 0.3331 - val_loss: 3.3155 - val_accuracy200: 0.3010 - 13s/epoch - 38ms/step
Epoch 5/50
346/346 - 13s - loss: 3.3045 - accuracy200: 0.3300 - val_loss: 3.3133 - val_accuracy200: 0.2984 - 13s/epoch - 38ms/step
Epoch 6/50
346/346 - 13s - loss: 3.3040 - accuracy200: 0.3330 - val_loss: 3.3156 - val_accuracy200: 0.3000 - 13s/epoch - 38ms/step
Epoch 7/50
346/346 - 13s - loss: 3.3028 - accuracy200: 0.3358 - val_loss: 3.3101 - val_accuracy200: 0.2985 - 13s/epoch - 39ms/step
Epoch 8/50
346/346 - 13s - loss: 3.3025 - accuracy200: 0.3314 - val_loss: 3.3088 - val_accuracy200: 0.3009 - 13s/epoch - 38ms/step
Epoch 9/50
346/346 - 13s - loss: 3.3024 - accuracy200: 0.3280 - val_loss: 3.3081 - val_accuracy200: 0.3000 - 13s/epoch - 38ms/step
Epoch 10/50
346/346 - 13s - loss: 3.3011 - accuracy200: 0.3315 - val_loss: 3.3086 - val_accuracy200: 0.2998 - 13s/epoch - 38ms/step
Epoch 11/50
346/346 - 13s - loss: 3.2997 - accuracy200: 0.3328 - val_loss: 3.3064 - val_accuracy200: 0.3034 - 13s/epoch - 39ms/step
Epoch 12/50
346/346 - 13s - loss: 3.2987 - accuracy200: 0.3355 - val_loss: 3.3046 - val_accuracy200: 0.3088 - 13s/epoch - 38ms/step
Epoch 13/50
346/346 - 13s - loss: 3.2981 - accuracy200: 0.3382 - val_loss: 3.3107 - val_accuracy200: 0.3042 - 13s/epoch - 38ms/step
Epoch 14/50
346/346 - 13s - loss: 3.2974 - accuracy200: 0.3379 - val_loss: 3.3053 - val_accuracy200: 0.3103 - 13s/epoch - 38ms/step
Epoch 15/50
346/346 - 13s - loss: 3.2950 - accuracy200: 0.3413 - val_loss: 3.3067 - val_accuracy200: 0.3132 - 13s/epoch - 38ms/step
Epoch 16/50
346/346 - 13s - loss: 3.2934 - accuracy200: 0.3456 - val_loss: 3.3082 - val_accuracy200: 0.3160 - 13s/epoch - 37ms/step
Epoch 17/50
346/346 - 13s - loss: 3.2929 - accuracy200: 0.3450 - val_loss: 3.3042 - val_accuracy200: 0.3253 - 13s/epoch - 38ms/step
Epoch 18/50
346/346 - 13s - loss: 3.2908 - accuracy200: 0.3487 - val_loss: 3.3111 - val_accuracy200: 0.3166 - 13s/epoch - 37ms/step
Epoch 19/50
346/346 - 13s - loss: 3.2883 - accuracy200: 0.3520 - val_loss: 3.3095 - val_accuracy200: 0.3257 - 13s/epoch - 38ms/step
Epoch 20/50
346/346 - 13s - loss: 3.2853 - accuracy200: 0.3559 - val_loss: 3.3153 - val_accuracy200: 0.3220 - 13s/epoch - 37ms/step
Epoch 21/50
346/346 - 13s - loss: 3.2838 - accuracy200: 0.3568 - val_loss: 3.3211 - val_accuracy200: 0.3142 - 13s/epoch - 38ms/step
Epoch 22/50
346/346 - 13s - loss: 3.2814 - accuracy200: 0.3598 - val_loss: 3.3178 - val_accuracy200: 0.3190 - 13s/epoch - 38ms/step
Epoch 23/50
346/346 - 13s - loss: 3.2809 - accuracy200: 0.3597 - val_loss: 3.3190 - val_accuracy200: 0.3192 - 13s/epoch - 38ms/step
Epoch 24/50
346/346 - 13s - loss: 3.2784 - accuracy200: 0.3619 - val_loss: 3.3253 - val_accuracy200: 0.3164 - 13s/epoch - 37ms/step
Epoch 25/50
346/346 - 13s - loss: 3.2739 - accuracy200: 0.3658 - val_loss: 3.3257 - val_accuracy200: 0.3168 - 13s/epoch - 38ms/step
Epoch 26/50
346/346 - 13s - loss: 3.2708 - accuracy200: 0.3691 - val_loss: 3.3259 - val_accuracy200: 0.3178 - 13s/epoch - 37ms/step
Epoch 27/50
346/346 - 13s - loss: 3.2667 - accuracy200: 0.3714 - val_loss: 3.3398 - val_accuracy200: 0.3166 - 13s/epoch - 38ms/step
testing model: results/CHTR/W4/deepVOL_L3/h200
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984864
{'0': {'precision': 0.2939638783269962, 'recall': 0.09961480129383816, 'f1-score': 0.14880457119943863, 'support': 74507}, '1': {'precision': 0.3674356250971452, 'recall': 0.641907563500594, 'f1-score': 0.4673528478992393, 'support': 88385}, '2': {'precision': 0.3230127283565342, 'recall': 0.24964093114007752, 'f1-score': 0.28162641394069093, 'support': 73802}, 'accuracy': 0.34889350807371544, 'macro avg': {'precision': 0.32813741059355855, 'recall': 0.3303877653115032, 'f1-score': 0.2992612776797896, 'support': 236694}, 'weighted avg': {'precision': 0.33045683365395667, 'recall': 0.34889350807371544, 'f1-score': 0.3091694603563323, 'support': 236694}}
[[ 7422 49781 17304]
 [10340 56735 21310]
 [ 7486 47892 18424]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095668
{'0': {'precision': 0.36325031562033744, 'recall': 0.10571142284569138, 'f1-score': 0.16376477893048405, 'support': 29940}, '1': {'precision': 0.3458646616541353, 'recall': 0.7026013432886707, 'f1-score': 0.46354383399876287, 'support': 29331}, '2': {'precision': 0.3535243920485375, 'recall': 0.24461585719649134, 'f1-score': 0.28915516824013554, 'support': 29299}, 'accuracy': 0.3493282149712092, 'macro avg': {'precision': 0.3542131231076701, 'recall': 0.35097620777695115, 'f1-score': 0.30548792705646083, 'support': 88570}, 'weighted avg': {'precision': 0.3542755109323749, 'recall': 0.3493282149712092, 'f1-score': 0.3045193513657462, 'support': 88570}}
[[ 3165 19841  6934]
 [ 2551 20608  6172]
 [ 2997 19135  7167]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016508
{'0': {'precision': 0.3490866917947231, 'recall': 0.10897900072411296, 'f1-score': 0.1661033317238049, 'support': 11048}, '1': {'precision': 0.30646916852018363, 'recall': 0.6729010806317539, 'f1-score': 0.4211347748333604, 'support': 9624}, '2': {'precision': 0.37082303991678583, 'recall': 0.24588326579877576, 'f1-score': 0.29569725246241574, 'support': 11599}, 'accuracy': 0.32636112918719595, 'macro avg': {'precision': 0.3421263000772308, 'recall': 0.34258778238488086, 'f1-score': 0.2943117863398604, 'support': 32271}, 'weighted avg': {'precision': 0.34418969008649086, 'recall': 0.32636112918719595, 'f1-score': 0.2887392120849189, 'support': 32271}}
[[1204 7184 2660]
 [ 969 6476 2179]
 [1276 7471 2852]]
training model: results/CHTR/W4/deepVOL_L3/h300
Epoch 1/50
346/346 - 15s - loss: 3.3281 - accuracy300: 0.3679 - val_loss: 3.3357 - val_accuracy300: 0.3501 - 15s/epoch - 45ms/step
Epoch 2/50
346/346 - 13s - loss: 3.2990 - accuracy300: 0.3674 - val_loss: 3.3191 - val_accuracy300: 0.3424 - 13s/epoch - 38ms/step
Epoch 3/50
346/346 - 13s - loss: 3.3020 - accuracy300: 0.3574 - val_loss: 3.3124 - val_accuracy300: 0.3192 - 13s/epoch - 38ms/step
Epoch 4/50
346/346 - 13s - loss: 3.2974 - accuracy300: 0.3516 - val_loss: 3.3057 - val_accuracy300: 0.3209 - 13s/epoch - 38ms/step
Epoch 5/50
346/346 - 13s - loss: 3.2985 - accuracy300: 0.3458 - val_loss: 3.3111 - val_accuracy300: 0.3109 - 13s/epoch - 38ms/step
Epoch 6/50
346/346 - 13s - loss: 3.2991 - accuracy300: 0.3411 - val_loss: 3.3051 - val_accuracy300: 0.3138 - 13s/epoch - 37ms/step
Epoch 7/50
346/346 - 13s - loss: 3.2971 - accuracy300: 0.3442 - val_loss: 3.3021 - val_accuracy300: 0.3205 - 13s/epoch - 38ms/step
Epoch 8/50
346/346 - 13s - loss: 3.2962 - accuracy300: 0.3471 - val_loss: 3.3027 - val_accuracy300: 0.3293 - 13s/epoch - 37ms/step
Epoch 9/50
346/346 - 13s - loss: 3.2948 - accuracy300: 0.3500 - val_loss: 3.3009 - val_accuracy300: 0.3396 - 13s/epoch - 38ms/step
Epoch 10/50
346/346 - 13s - loss: 3.2932 - accuracy300: 0.3510 - val_loss: 3.3002 - val_accuracy300: 0.3405 - 13s/epoch - 38ms/step
Epoch 11/50
346/346 - 13s - loss: 3.2924 - accuracy300: 0.3525 - val_loss: 3.3002 - val_accuracy300: 0.3432 - 13s/epoch - 38ms/step
Epoch 12/50
346/346 - 13s - loss: 3.2912 - accuracy300: 0.3532 - val_loss: 3.3019 - val_accuracy300: 0.3432 - 13s/epoch - 38ms/step
Epoch 13/50
346/346 - 13s - loss: 3.2901 - accuracy300: 0.3551 - val_loss: 3.3009 - val_accuracy300: 0.3455 - 13s/epoch - 38ms/step
Epoch 14/50
346/346 - 13s - loss: 3.2881 - accuracy300: 0.3563 - val_loss: 3.3022 - val_accuracy300: 0.3466 - 13s/epoch - 38ms/step
Epoch 15/50
346/346 - 13s - loss: 3.2858 - accuracy300: 0.3601 - val_loss: 3.3035 - val_accuracy300: 0.3452 - 13s/epoch - 39ms/step
Epoch 16/50
346/346 - 13s - loss: 3.2845 - accuracy300: 0.3623 - val_loss: 3.3052 - val_accuracy300: 0.3444 - 13s/epoch - 38ms/step
Epoch 17/50
346/346 - 13s - loss: 3.2826 - accuracy300: 0.3633 - val_loss: 3.3039 - val_accuracy300: 0.3496 - 13s/epoch - 39ms/step
Epoch 18/50
346/346 - 14s - loss: 3.2812 - accuracy300: 0.3651 - val_loss: 3.3067 - val_accuracy300: 0.3488 - 14s/epoch - 39ms/step
Epoch 19/50
346/346 - 13s - loss: 3.2801 - accuracy300: 0.3658 - val_loss: 3.3105 - val_accuracy300: 0.3432 - 13s/epoch - 39ms/step
Epoch 20/50
346/346 - 13s - loss: 3.2791 - accuracy300: 0.3635 - val_loss: 3.3139 - val_accuracy300: 0.3440 - 13s/epoch - 38ms/step
testing model: results/CHTR/W4/deepVOL_L3/h300
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966344
{'0': {'precision': 0.29171615201900236, 'recall': 0.02725646040530981, 'f1-score': 0.049854748886830995, 'support': 72093}, '1': {'precision': 0.38195880461258824, 'recall': 0.5808285400953426, 'f1-score': 0.46085477977900213, 'support': 89362}, '2': {'precision': 0.3364020027851896, 'recall': 0.4205930435013756, 'f1-score': 0.3738157677132799, 'support': 75239}, 'accuracy': 0.3612850346861348, 'macro avg': {'precision': 0.3366923198055934, 'recall': 0.34289268133400935, 'f1-score': 0.29484176545970436, 'support': 236694}, 'weighted avg': {'precision': 0.33999106666350193, 'recall': 0.3612850346861348, 'f1-score': 0.3080036155926596, 'support': 236694}}
[[ 1965 42378 27750]
 [ 2784 51904 34674]
 [ 1987 41607 31645]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959487
{'0': {'precision': 0.37573385518590996, 'recall': 0.025689914701455093, 'f1-score': 0.04809167475500172, 'support': 29895}, '1': {'precision': 0.35137353721627246, 'recall': 0.6279767997270557, 'f1-score': 0.4506138836864848, 'support': 29310}, '2': {'precision': 0.3616553905632194, 'recall': 0.4205005959475566, 'f1-score': 0.3888643950368458, 'support': 29365}, 'accuracy': 0.3558992886982048, 'macro avg': {'precision': 0.36292092765513395, 'recall': 0.3580557701253558, 'f1-score': 0.2958566511594441, 'support': 88570}, 'weighted avg': {'precision': 0.36300477046946666, 'recall': 0.3558992886982048, 'f1-score': 0.2942779327978844, 'support': 88570}}
[[  768 17604 11523]
 [  632 18406 10272]
 [  644 16373 12348]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003921
{'0': {'precision': 0.3224852071005917, 'recall': 0.020142289568511502, 'f1-score': 0.03791634055135229, 'support': 10823}, '1': {'precision': 0.32031667914838985, 'recall': 0.5975451551741343, 'f1-score': 0.4170642521330315, 'support': 10021}, '2': {'precision': 0.37268428803968684, 'recall': 0.4207578542049532, 'f1-score': 0.3952647155540941, 'support': 11427}, 'accuracy': 0.3412971398469214, 'macro avg': {'precision': 0.3384953914295561, 'recall': 0.346148432982533, 'f1-score': 0.2834151027461593, 'support': 32271}, 'weighted avg': {'precision': 0.3395870657130309, 'recall': 0.3412971398469214, 'f1-score': 0.2821870821805655, 'support': 32271}}
[[ 218 6344 4261]
 [ 201 5988 3832]
 [ 257 6362 4808]]
training model: results/CHTR/W4/deepVOL_L3/h500
Epoch 1/50
346/346 - 16s - loss: 3.3270 - accuracy500: 0.3674 - val_loss: 3.3318 - val_accuracy500: 0.3503 - 16s/epoch - 47ms/step
Epoch 2/50
346/346 - 13s - loss: 3.3190 - accuracy500: 0.3677 - val_loss: 3.3059 - val_accuracy500: 0.3409 - 13s/epoch - 39ms/step
Epoch 3/50
346/346 - 13s - loss: 3.3010 - accuracy500: 0.3675 - val_loss: 3.3207 - val_accuracy500: 0.3349 - 13s/epoch - 38ms/step
Epoch 4/50
346/346 - 13s - loss: 3.3052 - accuracy500: 0.3551 - val_loss: 3.3236 - val_accuracy500: 0.3278 - 13s/epoch - 38ms/step
Epoch 5/50
346/346 - 13s - loss: 3.2955 - accuracy500: 0.3638 - val_loss: 3.3141 - val_accuracy500: 0.3356 - 13s/epoch - 38ms/step
Epoch 6/50
346/346 - 13s - loss: 3.2963 - accuracy500: 0.3571 - val_loss: 3.3197 - val_accuracy500: 0.3201 - 13s/epoch - 38ms/step
Epoch 7/50
346/346 - 13s - loss: 3.2987 - accuracy500: 0.3488 - val_loss: 3.3136 - val_accuracy500: 0.3209 - 13s/epoch - 38ms/step
Epoch 8/50
346/346 - 13s - loss: 3.2932 - accuracy500: 0.3522 - val_loss: 3.3129 - val_accuracy500: 0.3291 - 13s/epoch - 39ms/step
Epoch 9/50
346/346 - 13s - loss: 3.2894 - accuracy500: 0.3570 - val_loss: 3.3147 - val_accuracy500: 0.3358 - 13s/epoch - 38ms/step
Epoch 10/50
346/346 - 13s - loss: 3.2863 - accuracy500: 0.3590 - val_loss: 3.3130 - val_accuracy500: 0.3393 - 13s/epoch - 38ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2831 - accuracy500: 0.3618 - val_loss: 3.3154 - val_accuracy500: 0.3386 - 14s/epoch - 39ms/step
Epoch 12/50
346/346 - 14s - loss: 3.2811 - accuracy500: 0.3650 - val_loss: 3.3141 - val_accuracy500: 0.3463 - 14s/epoch - 40ms/step
testing model: results/CHTR/W4/deepVOL_L3/h500
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079917
{'0': {'precision': 0.3006047614204461, 'recall': 0.5389524771362846, 'f1-score': 0.3859455278713883, 'support': 71292}, '1': {'precision': 0.3766379034835411, 'recall': 0.16050755890498025, 'f1-score': 0.22509072388107215, 'support': 88108}, '2': {'precision': 0.33343614619989626, 'recall': 0.307695293295728, 'f1-score': 0.32004898365641465, 'support': 77294}, 'accuracy': 0.3225599296982602, 'macro avg': {'precision': 0.33689293703462786, 'recall': 0.33571844311233096, 'f1-score': 0.3103617451362917, 'support': 236694}, 'weighted avg': {'precision': 0.33962897469175, 'recall': 0.3225599296982602, 'f1-score': 0.3045492839508371, 'support': 236694}}
[[38423 11425 21444]
 [47866 14142 26100]
 [41530 11981 23783]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986526
{'0': {'precision': 0.3404884020346567, 'recall': 0.5412877898198168, 'f1-score': 0.41802492809204217, 'support': 29803}, '1': {'precision': 0.3681456818645104, 'recall': 0.1852877808556479, 'f1-score': 0.24650803039264757, 'support': 29241}, '2': {'precision': 0.3527989725768679, 'recall': 0.3163313689629479, 'f1-score': 0.3335714285714286, 'support': 29526}, 'accuracy': 0.3487636897369312, 'macro avg': {'precision': 0.353811018825345, 'recall': 0.3476356465461376, 'f1-score': 0.33270146235203946, 'support': 88570}, 'weighted avg': {'precision': 0.3537232267533434, 'recall': 0.3487636897369312, 'f1-score': 0.333245661608203, 'support': 88570}}
[[16132  4735  8936]
 [15625  5418  8198]
 [15622  4564  9340]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016445
{'0': {'precision': 0.3352709864934177, 'recall': 0.545530415430267, 'f1-score': 0.4153047898062194, 'support': 10784}, '1': {'precision': 0.31313131313131315, 'recall': 0.1481293208621391, 'f1-score': 0.20111808958520258, 'support': 9836}, '2': {'precision': 0.37761890576903984, 'recall': 0.32640975023603125, 'f1-score': 0.3501519197127337, 'support': 11651}, 'accuracy': 0.3452945368907068, 'macro avg': {'precision': 0.3420070684645902, 'recall': 0.3400231621761458, 'f1-score': 0.32219159970138517, 'support': 32271}, 'weighted avg': {'precision': 0.34381208470204505, 'recall': 0.3452945368907068, 'f1-score': 0.3264994700816022, 'support': 32271}}
[[5883 1595 3306]
 [5417 1457 2962]
 [6247 1601 3803]]
training model: results/CHTR/W4/deepVOL_L3/h1000
Epoch 1/50
346/346 - 17s - loss: 3.3239 - accuracy1000: 0.3756 - val_loss: 3.3123 - val_accuracy1000: 0.3542 - 17s/epoch - 48ms/step
Epoch 2/50
346/346 - 14s - loss: 3.3309 - accuracy1000: 0.3404 - val_loss: 3.3151 - val_accuracy1000: 0.3124 - 14s/epoch - 40ms/step
Epoch 3/50
346/346 - 14s - loss: 3.3102 - accuracy1000: 0.3405 - val_loss: 3.3108 - val_accuracy1000: 0.3386 - 14s/epoch - 41ms/step
Epoch 4/50
346/346 - 14s - loss: 3.3072 - accuracy1000: 0.3415 - val_loss: 3.3125 - val_accuracy1000: 0.3486 - 14s/epoch - 40ms/step
Epoch 5/50
346/346 - 14s - loss: 3.3056 - accuracy1000: 0.3428 - val_loss: 3.3124 - val_accuracy1000: 0.3499 - 14s/epoch - 40ms/step
Epoch 6/50
346/346 - 14s - loss: 3.3033 - accuracy1000: 0.3457 - val_loss: 3.3121 - val_accuracy1000: 0.3515 - 14s/epoch - 40ms/step
Epoch 7/50
346/346 - 14s - loss: 3.3026 - accuracy1000: 0.3455 - val_loss: 3.3118 - val_accuracy1000: 0.3560 - 14s/epoch - 40ms/step
Epoch 8/50
346/346 - 14s - loss: 3.3012 - accuracy1000: 0.3467 - val_loss: 3.3121 - val_accuracy1000: 0.3559 - 14s/epoch - 40ms/step
Epoch 9/50
346/346 - 14s - loss: 3.3008 - accuracy1000: 0.3475 - val_loss: 3.3116 - val_accuracy1000: 0.3560 - 14s/epoch - 40ms/step
Epoch 10/50
346/346 - 14s - loss: 3.2990 - accuracy1000: 0.3477 - val_loss: 3.3120 - val_accuracy1000: 0.3562 - 14s/epoch - 40ms/step
Epoch 11/50
346/346 - 14s - loss: 3.2990 - accuracy1000: 0.3477 - val_loss: 3.3109 - val_accuracy1000: 0.3567 - 14s/epoch - 40ms/step
Epoch 12/50
346/346 - 14s - loss: 3.2975 - accuracy1000: 0.3490 - val_loss: 3.3136 - val_accuracy1000: 0.3588 - 14s/epoch - 39ms/step
Epoch 13/50
346/346 - 14s - loss: 3.2966 - accuracy1000: 0.3511 - val_loss: 3.3131 - val_accuracy1000: 0.3583 - 14s/epoch - 39ms/step
testing model: results/CHTR/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095953
{'0': {'precision': 0.29713804713804715, 'recall': 0.005017269070597098, 'f1-score': 0.009867915298064156, 'support': 70357}, '1': {'precision': 0.3812090874085483, 'recall': 0.741345859287246, 'f1-score': 0.5035081432848243, 'support': 88137}, '2': {'precision': 0.33564208161737175, 'recall': 0.2751406649616368, 'f1-score': 0.30239487294805484, 'support': 78200}, 'accuracy': 0.36844617945533054, 'macro avg': {'precision': 0.3379964053879891, 'recall': 0.34050126443982665, 'f1-score': 0.2719236438436478, 'support': 236694}, 'weighted avg': {'precision': 0.3411644473535336, 'recall': 0.36844617945533054, 'f1-score': 0.29032951070098245, 'support': 236694}}
[[  353 49772 20232]
 [  441 65340 22356]
 [  394 56290 21516]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099611
{'0': {'precision': 0.3578199052132701, 'recall': 0.005113443955299695, 'f1-score': 0.010082799145299146, 'support': 29530}, '1': {'precision': 0.34450264978542083, 'recall': 0.7703893442622951, 'f1-score': 0.47610202940152174, 'support': 29280}, '2': {'precision': 0.38013320982753296, 'recall': 0.28958333333333336, 'f1-score': 0.3287368160057981, 'support': 29760}, 'accuracy': 0.35368634977983515, 'macro avg': {'precision': 0.36081858827540797, 'recall': 0.3550287071836427, 'f1-score': 0.27164054818420635, 'support': 88570}, 'weighted avg': {'precision': 0.36091479859018144, 'recall': 0.35368634977983515, 'f1-score': 0.2712116983625357, 'support': 88570}}
[[  151 21919  7460]
 [  130 22557  6593]
 [  141 21001  8618]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043962
{'0': {'precision': 0.3806818181818182, 'recall': 0.006300545420349821, 'f1-score': 0.012395929694727104, 'support': 10634}, '1': {'precision': 0.31455656203918264, 'recall': 0.7627707396812423, 'f1-score': 0.4454255287414611, 'support': 9788}, '2': {'precision': 0.4034688995215311, 'recall': 0.28466537260528313, 'f1-score': 0.33381166806868223, 'support': 11849}, 'accuracy': 0.33795048185677545, 'macro avg': {'precision': 0.3662357599141773, 'recall': 0.35124555256895845, 'f1-score': 0.2638777088349568, 'support': 32271}, 'weighted avg': {'precision': 0.3689923793565615, 'recall': 0.33795048185677545, 'f1-score': 0.26175135095413726, 'support': 32271}}
[[  67 7864 2703]
 [  38 7466 2284]
 [  71 8405 3373]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        11 (peak)   9.46 (ave)

============================================
