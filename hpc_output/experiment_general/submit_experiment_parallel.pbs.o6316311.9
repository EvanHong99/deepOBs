This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-17.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-25.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-23.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-18.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-08.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-04.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-31.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-01-30.csv
training model: results/AAPL/W0/deepLOB_L1/h10
Epoch 1/50
4812/4812 - 133s - loss: 3.1579 - accuracy10: 0.4410 - val_loss: 3.3487 - val_accuracy10: 0.3794 - 133s/epoch - 28ms/step
Epoch 2/50
4812/4812 - 119s - loss: 3.1360 - accuracy10: 0.4511 - val_loss: 3.3406 - val_accuracy10: 0.4027 - 119s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 119s - loss: 3.1226 - accuracy10: 0.4570 - val_loss: 3.2183 - val_accuracy10: 0.4270 - 119s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 124s - loss: 3.1102 - accuracy10: 0.4615 - val_loss: 3.2261 - val_accuracy10: 0.4240 - 124s/epoch - 26ms/step
Epoch 5/50
4812/4812 - 121s - loss: 3.1021 - accuracy10: 0.4647 - val_loss: 3.1954 - val_accuracy10: 0.4317 - 121s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 126s - loss: 3.0959 - accuracy10: 0.4665 - val_loss: 3.1991 - val_accuracy10: 0.4315 - 126s/epoch - 26ms/step
Epoch 7/50
4812/4812 - 123s - loss: 3.0910 - accuracy10: 0.4681 - val_loss: 3.2064 - val_accuracy10: 0.4297 - 123s/epoch - 26ms/step
Epoch 8/50
4812/4812 - 123s - loss: 3.0861 - accuracy10: 0.4696 - val_loss: 3.2231 - val_accuracy10: 0.4265 - 123s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 120s - loss: 3.0826 - accuracy10: 0.4708 - val_loss: 3.2189 - val_accuracy10: 0.4261 - 120s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 124s - loss: 3.0784 - accuracy10: 0.4724 - val_loss: 3.2014 - val_accuracy10: 0.4290 - 124s/epoch - 26ms/step
Epoch 11/50
4812/4812 - 119s - loss: 3.0751 - accuracy10: 0.4731 - val_loss: 3.2021 - val_accuracy10: 0.4277 - 119s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 121s - loss: 3.0716 - accuracy10: 0.4742 - val_loss: 3.2023 - val_accuracy10: 0.4293 - 121s/epoch - 25ms/step
Epoch 13/50
4812/4812 - 117s - loss: 3.0684 - accuracy10: 0.4753 - val_loss: 3.1968 - val_accuracy10: 0.4326 - 117s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 118s - loss: 3.0657 - accuracy10: 0.4757 - val_loss: 3.1970 - val_accuracy10: 0.4310 - 118s/epoch - 24ms/step
Epoch 15/50
4812/4812 - 127s - loss: 3.0627 - accuracy10: 0.4767 - val_loss: 3.1783 - val_accuracy10: 0.4381 - 127s/epoch - 26ms/step
Epoch 16/50
4812/4812 - 122s - loss: 3.0601 - accuracy10: 0.4776 - val_loss: 3.1886 - val_accuracy10: 0.4331 - 122s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 116s - loss: 3.0574 - accuracy10: 0.4782 - val_loss: 3.1916 - val_accuracy10: 0.4324 - 116s/epoch - 24ms/step
Epoch 18/50
4812/4812 - 115s - loss: 3.0552 - accuracy10: 0.4793 - val_loss: 3.1925 - val_accuracy10: 0.4311 - 115s/epoch - 24ms/step
Epoch 19/50
4812/4812 - 121s - loss: 3.0531 - accuracy10: 0.4800 - val_loss: 3.1818 - val_accuracy10: 0.4366 - 121s/epoch - 25ms/step
Epoch 20/50
4812/4812 - 115s - loss: 3.0510 - accuracy10: 0.4801 - val_loss: 3.1846 - val_accuracy10: 0.4365 - 115s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 116s - loss: 3.0492 - accuracy10: 0.4812 - val_loss: 3.1839 - val_accuracy10: 0.4370 - 116s/epoch - 24ms/step
Epoch 22/50
4812/4812 - 116s - loss: 3.0469 - accuracy10: 0.4813 - val_loss: 3.1899 - val_accuracy10: 0.4358 - 116s/epoch - 24ms/step
Epoch 23/50
4812/4812 - 111s - loss: 3.0455 - accuracy10: 0.4817 - val_loss: 3.1860 - val_accuracy10: 0.4370 - 111s/epoch - 23ms/step
Epoch 24/50
4812/4812 - 111s - loss: 3.0438 - accuracy10: 0.4820 - val_loss: 3.1774 - val_accuracy10: 0.4391 - 111s/epoch - 23ms/step
Epoch 25/50
4812/4812 - 114s - loss: 3.0415 - accuracy10: 0.4831 - val_loss: 3.1745 - val_accuracy10: 0.4400 - 114s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 113s - loss: 3.0403 - accuracy10: 0.4832 - val_loss: 3.1748 - val_accuracy10: 0.4398 - 113s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 111s - loss: 3.0385 - accuracy10: 0.4840 - val_loss: 3.1777 - val_accuracy10: 0.4392 - 111s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 115s - loss: 3.0369 - accuracy10: 0.4842 - val_loss: 3.1868 - val_accuracy10: 0.4359 - 115s/epoch - 24ms/step
Epoch 29/50
4812/4812 - 112s - loss: 3.0357 - accuracy10: 0.4843 - val_loss: 3.1995 - val_accuracy10: 0.4329 - 112s/epoch - 23ms/step
Epoch 30/50
4812/4812 - 112s - loss: 3.0341 - accuracy10: 0.4851 - val_loss: 3.1917 - val_accuracy10: 0.4355 - 112s/epoch - 23ms/step
Epoch 31/50
4812/4812 - 110s - loss: 3.0327 - accuracy10: 0.4854 - val_loss: 3.2001 - val_accuracy10: 0.4324 - 110s/epoch - 23ms/step
Epoch 32/50
4812/4812 - 112s - loss: 3.0312 - accuracy10: 0.4857 - val_loss: 3.2074 - val_accuracy10: 0.4294 - 112s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 110s - loss: 3.0299 - accuracy10: 0.4865 - val_loss: 3.2129 - val_accuracy10: 0.4284 - 110s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 117s - loss: 3.0282 - accuracy10: 0.4870 - val_loss: 3.1979 - val_accuracy10: 0.4337 - 117s/epoch - 24ms/step
Epoch 35/50
4812/4812 - 121s - loss: 3.0272 - accuracy10: 0.4873 - val_loss: 3.2100 - val_accuracy10: 0.4297 - 121s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h10
Evaluating performance on  test set...
19053/19053 - 268s - 268s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0602756
{'0': {'precision': 0.41307098186527164, 'recall': 0.3413679143921744, 'f1-score': 0.37381206158585245, 'support': 1177369}, '1': {'precision': 0.6259616828728218, 'recall': 0.3198035218275634, 'f1-score': 0.42332864376260176, 'support': 2541351}, '2': {'precision': 0.32948400299146496, 'recall': 0.7410365304803271, 'f1-score': 0.4561513297343931, 'support': 1158731}, 'accuracy': 0.4250808465323383, 'macro avg': {'precision': 0.45617222257651946, 'recall': 0.46740265556668836, 'f1-score': 0.41776401169428246, 'support': 4877451}, 'weighted avg': {'precision': 0.5041380519965377, 'recall': 0.4250808465323383, 'f1-score': 0.4191734764216941, 'support': 4877451}}
[[ 401916  310214  465239]
 [ 446438  812733 1282180]
 [ 124641  175428  858662]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0576836
{'0': {'precision': 0.46857005293435644, 'recall': 0.41633659593195504, 'f1-score': 0.44091173016786395, 'support': 406731}, '1': {'precision': 0.4559014606496621, 'recall': 0.25703736298313884, 'f1-score': 0.3287342625793257, 'support': 406793}, '2': {'precision': 0.43072901312844414, 'recall': 0.66010747136328, 'f1-score': 0.5213016684741726, 'support': 418344}, 'accuracy': 0.446516996950972, 'macro avg': {'precision': 0.45173350890415415, 'recall': 0.44449381009279126, 'f1-score': 0.4303158870737874, 'support': 1231868}, 'weighted avg': {'precision': 0.4515357062203966, 'recall': 0.446516996950972, 'f1-score': 0.43116851074668416, 'support': 1231868}}
[[169337  71927 165467]
 [102724 104561 199508]
 [ 89330  52862 276152]]
Evaluating performance on  val set...
1767/1767 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0564331
{'0': {'precision': 0.4640441925140191, 'recall': 0.41369850022354393, 'f1-score': 0.4374274786196226, 'support': 147622}, '1': {'precision': 0.4393955371831105, 'recall': 0.27077416965057416, 'f1-score': 0.3350662822817027, 'support': 153881}, '2': {'precision': 0.4251989072828623, 'recall': 0.6368791033888189, 'f1-score': 0.509944271722479, 'support': 150790}, 'accuracy': 0.43947839121985083, 'macro avg': {'precision': 0.44287954565999726, 'recall': 0.4404505910876457, 'f1-score': 0.4274793442079348, 'support': 452293}, 'weighted avg': {'precision': 0.44270749198807313, 'recall': 0.43947839121985083, 'f1-score': 0.42677810747813755, 'support': 452293}}
[[61071 30069 56482]
 [38872 41667 73342]
 [31663 23092 96035]]
training model: results/AAPL/W0/deepLOB_L1/h20
Epoch 1/50
4812/4812 - 119s - loss: 3.2033 - accuracy20: 0.4223 - val_loss: 3.3543 - val_accuracy20: 0.3592 - 119s/epoch - 25ms/step
Epoch 2/50
4812/4812 - 117s - loss: 3.1908 - accuracy20: 0.4291 - val_loss: 3.2777 - val_accuracy20: 0.3956 - 117s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 117s - loss: 3.1785 - accuracy20: 0.4346 - val_loss: 3.3597 - val_accuracy20: 0.3453 - 117s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 115s - loss: 3.1705 - accuracy20: 0.4373 - val_loss: 3.3713 - val_accuracy20: 0.3475 - 115s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 120s - loss: 3.1643 - accuracy20: 0.4403 - val_loss: 3.4022 - val_accuracy20: 0.3418 - 120s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 120s - loss: 3.1609 - accuracy20: 0.4421 - val_loss: 3.4296 - val_accuracy20: 0.3368 - 120s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 118s - loss: 3.1582 - accuracy20: 0.4433 - val_loss: 3.3685 - val_accuracy20: 0.3439 - 118s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 121s - loss: 3.1552 - accuracy20: 0.4448 - val_loss: 3.3612 - val_accuracy20: 0.3445 - 121s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 122s - loss: 3.1525 - accuracy20: 0.4458 - val_loss: 3.3317 - val_accuracy20: 0.3574 - 122s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 121s - loss: 3.1497 - accuracy20: 0.4471 - val_loss: 3.3021 - val_accuracy20: 0.3641 - 121s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 120s - loss: 3.1471 - accuracy20: 0.4478 - val_loss: 3.3132 - val_accuracy20: 0.3659 - 120s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 118s - loss: 3.1448 - accuracy20: 0.4489 - val_loss: 3.2770 - val_accuracy20: 0.3752 - 118s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 122s - loss: 3.1424 - accuracy20: 0.4500 - val_loss: 3.2706 - val_accuracy20: 0.3777 - 122s/epoch - 25ms/step
Epoch 14/50
4812/4812 - 122s - loss: 3.1410 - accuracy20: 0.4502 - val_loss: 3.2660 - val_accuracy20: 0.3753 - 122s/epoch - 25ms/step
Epoch 15/50
4812/4812 - 120s - loss: 3.1385 - accuracy20: 0.4513 - val_loss: 3.2610 - val_accuracy20: 0.3791 - 120s/epoch - 25ms/step
Epoch 16/50
4812/4812 - 120s - loss: 3.1369 - accuracy20: 0.4516 - val_loss: 3.2656 - val_accuracy20: 0.3763 - 120s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 124s - loss: 3.1349 - accuracy20: 0.4524 - val_loss: 3.2672 - val_accuracy20: 0.3747 - 124s/epoch - 26ms/step
Epoch 18/50
4812/4812 - 120s - loss: 3.1334 - accuracy20: 0.4532 - val_loss: 3.2755 - val_accuracy20: 0.3738 - 120s/epoch - 25ms/step
Epoch 19/50
4812/4812 - 116s - loss: 3.1315 - accuracy20: 0.4536 - val_loss: 3.2935 - val_accuracy20: 0.3660 - 116s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 118s - loss: 3.1297 - accuracy20: 0.4541 - val_loss: 3.2963 - val_accuracy20: 0.3636 - 118s/epoch - 25ms/step
Epoch 21/50
4812/4812 - 121s - loss: 3.1288 - accuracy20: 0.4546 - val_loss: 3.2882 - val_accuracy20: 0.3735 - 121s/epoch - 25ms/step
Epoch 22/50
4812/4812 - 119s - loss: 3.1268 - accuracy20: 0.4549 - val_loss: 3.3097 - val_accuracy20: 0.3636 - 119s/epoch - 25ms/step
Epoch 23/50
4812/4812 - 119s - loss: 3.1254 - accuracy20: 0.4554 - val_loss: 3.3146 - val_accuracy20: 0.3577 - 119s/epoch - 25ms/step
Epoch 24/50
4812/4812 - 120s - loss: 3.1243 - accuracy20: 0.4561 - val_loss: 3.3153 - val_accuracy20: 0.3596 - 120s/epoch - 25ms/step
Epoch 25/50
4812/4812 - 126s - loss: 3.1226 - accuracy20: 0.4567 - val_loss: 3.3377 - val_accuracy20: 0.3471 - 126s/epoch - 26ms/step
testing model: results/AAPL/W0/deepLOB_L1/h20
Evaluating performance on  test set...
19053/19053 - 273s - 273s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0724145
{'0': {'precision': 0.3081055180066579, 'recall': 0.3427859783182928, 'f1-score': 0.32452183508770194, 'support': 1247411}, '1': {'precision': 0.5030056321800869, 'recall': 0.42310817765093445, 'f1-score': 0.45961045850013826, 'support': 2395957}, '2': {'precision': 0.343020305945811, 'recall': 0.4097755175300203, 'f1-score': 0.37343810634667624, 'support': 1234083}, 'accuracy': 0.3991923240233474, 'macro avg': {'precision': 0.38471048537751856, 'recall': 0.39188989116641587, 'f1-score': 0.3858567999781721, 'support': 4877451}, 'weighted avg': {'precision': 0.41268064118041, 'recall': 0.3991923240233474, 'f1-score': 0.4032583045405943, 'support': 4877451}}
[[ 427595  563601  256215]
 [ 669872 1013749  712336]
 [ 290353  438033  505697]]
Evaluating performance on  train set...
4812/4812 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0818373
{'0': {'precision': 0.4067615291846763, 'recall': 0.30099665160462385, 'f1-score': 0.34597652590783023, 'support': 406762}, '1': {'precision': 0.36041999175493267, 'recall': 0.38461954384585134, 'f1-score': 0.3721267562262285, 'support': 406880}, '2': {'precision': 0.41637539462663486, 'recall': 0.49447427945656175, 'f1-score': 0.4520766249352387, 'support': 418226}, 'accuracy': 0.3943036104517692, 'macro avg': {'precision': 0.39451897185541457, 'recall': 0.39336349163567896, 'f1-score': 0.3900599690230992, 'support': 1231868}, 'weighted avg': {'precision': 0.3947191055962029, 'recall': 0.3943036104517692, 'f1-score': 0.3906353901106399, 'support': 1231868}}
[[122434 150805 133523]
 [ 94039 156494 156347]
 [ 84524 126900 206802]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0872303
{'0': {'precision': 0.3862809002024457, 'recall': 0.28825374458889125, 'f1-score': 0.33014439452837074, 'support': 147613}, '1': {'precision': 0.3500794844483458, 'recall': 0.4239782192979613, 'f1-score': 0.3835013222161633, 'support': 154265}, '2': {'precision': 0.40910817649747927, 'recall': 0.42242462520360335, 'f1-score': 0.4156597737843691, 'support': 150415}, 'accuracy': 0.3791657177979761, 'macro avg': {'precision': 0.3818228537160903, 'recall': 0.378218863030152, 'f1-score': 0.37643516350963435, 'support': 452293}, 'weighted avg': {'precision': 0.381525030362787, 'recall': 0.3791657177979761, 'f1-score': 0.3767820878390086, 'support': 452293}}
[[42550 66494 38569]
 [35657 65405 53203]
 [31946 54930 63539]]
training model: results/AAPL/W0/deepLOB_L1/h30
Epoch 1/50
4812/4812 - 124s - loss: 3.2277 - accuracy30: 0.4108 - val_loss: 3.3072 - val_accuracy30: 0.3751 - 124s/epoch - 26ms/step
Epoch 2/50
4812/4812 - 126s - loss: 3.2136 - accuracy30: 0.4180 - val_loss: 3.3118 - val_accuracy30: 0.3670 - 126s/epoch - 26ms/step
Epoch 3/50
4812/4812 - 122s - loss: 3.2055 - accuracy30: 0.4215 - val_loss: 3.2912 - val_accuracy30: 0.3858 - 122s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 119s - loss: 3.1980 - accuracy30: 0.4248 - val_loss: 3.3046 - val_accuracy30: 0.3721 - 119s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 122s - loss: 3.1920 - accuracy30: 0.4283 - val_loss: 3.3233 - val_accuracy30: 0.3653 - 122s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 119s - loss: 3.1891 - accuracy30: 0.4294 - val_loss: 3.3697 - val_accuracy30: 0.3530 - 119s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 119s - loss: 3.1867 - accuracy30: 0.4303 - val_loss: 3.4124 - val_accuracy30: 0.3490 - 119s/epoch - 25ms/step
Epoch 8/50
4812/4812 - 116s - loss: 3.1845 - accuracy30: 0.4316 - val_loss: 3.4440 - val_accuracy30: 0.3452 - 116s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 121s - loss: 3.1830 - accuracy30: 0.4316 - val_loss: 3.4180 - val_accuracy30: 0.3484 - 121s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 121s - loss: 3.1810 - accuracy30: 0.4330 - val_loss: 3.4356 - val_accuracy30: 0.3440 - 121s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 123s - loss: 3.1797 - accuracy30: 0.4332 - val_loss: 3.4298 - val_accuracy30: 0.3446 - 123s/epoch - 26ms/step
Epoch 12/50
4812/4812 - 116s - loss: 3.1781 - accuracy30: 0.4340 - val_loss: 3.4612 - val_accuracy30: 0.3439 - 116s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 120s - loss: 3.1763 - accuracy30: 0.4350 - val_loss: 3.4108 - val_accuracy30: 0.3532 - 120s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h30
Evaluating performance on  test set...
19053/19053 - 267s - 267s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1285225
{'0': {'precision': 0.357456645190735, 'recall': 0.5400218236656924, 'f1-score': 0.4301705191062392, 'support': 1316919}, '1': {'precision': 0.5023890784982935, 'recall': 0.0003257085377678079, 'f1-score': 0.0006509950228953888, 'support': 2259689}, '2': {'precision': 0.31916089953410254, 'recall': 0.7081938404557659, 'f1-score': 0.4400189620317555, 'support': 1300843}, 'accuracy': 0.33483678257352045, 'macro avg': {'precision': 0.3930022077410437, 'recall': 0.41618045755307537, 'f1-score': 0.2902801587202967, 'support': 4877451}, 'weighted avg': {'precision': 0.4143891438711139, 'recall': 0.33483678257352045, 'f1-score': 0.23380375584899488, 'support': 4877451}}
[[ 711165     413  605341]
 [ 899071     736 1359882]
 [ 379278     316  921249]]
Evaluating performance on  train set...
4812/4812 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920154
{'0': {'precision': 0.38858210062511694, 'recall': 0.5943128616744695, 'f1-score': 0.4699166219708421, 'support': 405406}, '1': {'precision': 0.3548387096774194, 'recall': 0.00048627381636532426, 'f1-score': 0.0009712166696097474, 'support': 407178}, '2': {'precision': 0.3984124750926765, 'recall': 0.5808378092176186, 'f1-score': 0.472633060016496, 'support': 419284}, 'accuracy': 0.3934447521974757, 'macro avg': {'precision': 0.38061109513173763, 'recall': 0.39187898156948453, 'f1-score': 0.3145069662189826, 'support': 1231868}, 'weighted avg': {'precision': 0.3807745695332748, 'recall': 0.3934447521974757, 'f1-score': 0.31583737546861035, 'support': 1231868}}
[[240938    196 164272]
 [203522    198 203458]
 [175584    164 243536]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0957915
{'0': {'precision': 0.3846548561312586, 'recall': 0.610933021828011, 'f1-score': 0.4720795799538705, 'support': 147242}, '1': {'precision': 0.42105263157894735, 'recall': 0.00041383769802780474, 'f1-score': 0.0008268627020322734, 'support': 154650}, '2': {'precision': 0.3863671764048341, 'recall': 0.5607476014122247, 'f1-score': 0.45750414312566623, 'support': 150401}, 'accuracy': 0.3854934743628577, 'macro avg': {'precision': 0.39735822137168003, 'recall': 0.39069815364608784, 'f1-score': 0.31013686192718964, 'support': 452293}, 'weighted avg': {'precision': 0.397669540538161, 'recall': 0.3854934743628577, 'f1-score': 0.30610002024944094, 'support': 452293}}
[[89955    50 57237]
 [77878    64 76708]
 [66026    38 84337]]
training model: results/AAPL/W0/deepLOB_L1/h50
Epoch 1/50
4812/4812 - 119s - loss: 3.2069 - accuracy50: 0.4208 - val_loss: 3.2910 - val_accuracy50: 0.3596 - 119s/epoch - 25ms/step
Epoch 2/50
4812/4812 - 117s - loss: 3.1983 - accuracy50: 0.4254 - val_loss: 3.4387 - val_accuracy50: 0.3701 - 117s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 118s - loss: 3.1932 - accuracy50: 0.4276 - val_loss: 3.5347 - val_accuracy50: 0.3700 - 118s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 116s - loss: 3.1863 - accuracy50: 0.4312 - val_loss: 3.5920 - val_accuracy50: 0.3701 - 116s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 112s - loss: 3.1807 - accuracy50: 0.4342 - val_loss: 3.6773 - val_accuracy50: 0.3700 - 112s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 112s - loss: 3.1755 - accuracy50: 0.4369 - val_loss: 3.6218 - val_accuracy50: 0.3701 - 112s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 116s - loss: 3.1715 - accuracy50: 0.4392 - val_loss: 3.6964 - val_accuracy50: 0.3702 - 116s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 118s - loss: 3.1684 - accuracy50: 0.4405 - val_loss: 3.6793 - val_accuracy50: 0.3699 - 118s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 113s - loss: 3.1663 - accuracy50: 0.4418 - val_loss: 3.6562 - val_accuracy50: 0.3698 - 113s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 113s - loss: 3.1635 - accuracy50: 0.4432 - val_loss: 3.6567 - val_accuracy50: 0.3699 - 113s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 116s - loss: 3.1620 - accuracy50: 0.4437 - val_loss: 3.5159 - val_accuracy50: 0.3692 - 116s/epoch - 24ms/step
testing model: results/AAPL/W0/deepLOB_L1/h50
Evaluating performance on  test set...
19053/19053 - 258s - 258s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0718648
{'0': {'precision': 0.22648271117990026, 'recall': 0.10804492653389604, 'f1-score': 0.14629767547974848, 'support': 1133584}, '1': {'precision': 0.5381637834411418, 'recall': 0.8034491752716079, 'f1-score': 0.644578222294007, 'support': 2630078}, '2': {'precision': 0.26069177405786326, 'recall': 0.09598855797642103, 'f1-score': 0.14031290890311268, 'support': 1113789}, 'accuracy': 0.48027607043105097, 'macro avg': {'precision': 0.3417794228929685, 'recall': 0.3358275532606417, 'f1-score': 0.3103962688922894, 'support': 4877451}, 'weighted avg': {'precision': 0.402362942289241, 'recall': 0.48027607043105097, 'f1-score': 0.4136198765276989, 'support': 4877451}}
[[ 122478  919209   91897]
 [ 305647 2113134  211297]
 [ 112658  894220  106911]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0982088
{'0': {'precision': 0.3597176162318027, 'recall': 0.1515040288907556, 'f1-score': 0.21320954870379744, 'support': 405943}, '1': {'precision': 0.33649278399530397, 'recall': 0.6233059530574642, 'f1-score': 0.43704569995411724, 'support': 406497}, '2': {'precision': 0.3781453383390275, 'recall': 0.2776090294400946, 'f1-score': 0.32017037330341624, 'support': 419428}, 'accuracy': 0.3501276110752126, 'macro avg': {'precision': 0.35811857952204473, 'recall': 0.3508063371294381, 'f1-score': 0.32347520732044366, 'support': 1231868}, 'weighted avg': {'precision': 0.3583280826116007, 'recall': 0.3501276110752126, 'f1-score': 0.32349010531779354, 'support': 1231868}}
[[ 61502 248338  96103]
 [ 57749 253372  95376]
 [ 51722 251269 116437]]
Evaluating performance on  val set...
1767/1767 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967779
{'0': {'precision': 0.32702450541708716, 'recall': 0.12133950333816101, 'f1-score': 0.17700346277516696, 'support': 141545}, '1': {'precision': 0.36851697757917257, 'recall': 0.7643110511292384, 'f1-score': 0.4972715917236663, 'support': 167458}, '2': {'precision': 0.33867678173188726, 'recall': 0.12400027915416288, 'f1-score': 0.18153489346267998, 'support': 143290}, 'accuracy': 0.36023772200763665, 'macro avg': {'precision': 0.34473942157604903, 'recall': 0.33655027787385405, 'f1-score': 0.2852699826538378, 'support': 452293}, 'weighted avg': {'precision': 0.3460783069936453, 'recall': 0.36023772200763665, 'f1-score': 0.2970158641182599, 'support': 452293}}
[[ 17175 109691  14679]
 [ 19452 127990  20016]
 [ 15892 109630  17768]]
training model: results/AAPL/W0/deepLOB_L1/h100
Epoch 1/50
4812/4812 - 118s - loss: 3.2629 - accuracy100: 0.3865 - val_loss: 3.4166 - val_accuracy100: 0.3274 - 118s/epoch - 25ms/step
Epoch 2/50
4812/4812 - 118s - loss: 3.2496 - accuracy100: 0.3961 - val_loss: 3.4440 - val_accuracy100: 0.3280 - 118s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 117s - loss: 3.2448 - accuracy100: 0.3989 - val_loss: 3.4015 - val_accuracy100: 0.3273 - 117s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 121s - loss: 3.2408 - accuracy100: 0.4017 - val_loss: 3.3716 - val_accuracy100: 0.3291 - 121s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 114s - loss: 3.2377 - accuracy100: 0.4041 - val_loss: 3.3426 - val_accuracy100: 0.3364 - 114s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 114s - loss: 3.2349 - accuracy100: 0.4060 - val_loss: 3.3513 - val_accuracy100: 0.3335 - 114s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 115s - loss: 3.2325 - accuracy100: 0.4077 - val_loss: 3.3515 - val_accuracy100: 0.3358 - 115s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 119s - loss: 3.2308 - accuracy100: 0.4088 - val_loss: 3.3504 - val_accuracy100: 0.3357 - 119s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 114s - loss: 3.2287 - accuracy100: 0.4102 - val_loss: 3.3633 - val_accuracy100: 0.3370 - 114s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 113s - loss: 3.2264 - accuracy100: 0.4114 - val_loss: 3.3653 - val_accuracy100: 0.3364 - 113s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 118s - loss: 3.2252 - accuracy100: 0.4121 - val_loss: 3.3708 - val_accuracy100: 0.3351 - 118s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 121s - loss: 3.2225 - accuracy100: 0.4137 - val_loss: 3.3957 - val_accuracy100: 0.3309 - 121s/epoch - 25ms/step
Epoch 13/50
4812/4812 - 113s - loss: 3.2208 - accuracy100: 0.4146 - val_loss: 3.4060 - val_accuracy100: 0.3304 - 113s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 116s - loss: 3.2194 - accuracy100: 0.4155 - val_loss: 3.4046 - val_accuracy100: 0.3339 - 116s/epoch - 24ms/step
Epoch 15/50
4812/4812 - 119s - loss: 3.2190 - accuracy100: 0.4155 - val_loss: 3.4215 - val_accuracy100: 0.3305 - 119s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h100
Evaluating performance on  test set...
19053/19053 - 262s - 262s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062375
{'0': {'precision': 0.2837872875374092, 'recall': 0.25148641586592646, 'f1-score': 0.2666622602878697, 'support': 1379661}, '1': {'precision': 0.4408876340990323, 'recall': 0.4637897450760464, 'f1-score': 0.4520488035467931, 'support': 2149543}, '2': {'precision': 0.2765534700227178, 'recall': 0.28586082520487716, 'f1-score': 0.28113013422596045, 'support': 1348247}, 'accuracy': 0.35455261365003976, 'macro avg': {'precision': 0.3337427972197198, 'recall': 0.3337123287156167, 'f1-score': 0.3332803993535411, 'support': 4877451}, 'weighted avg': {'precision': 0.35102342737487363, 'recall': 0.35455261365003976, 'f1-score': 0.35236329838949804, 'support': 4877451}}
[[346966 638990 393705]
 [538101 996936 614506]
 [337560 625276 385411]]
Evaluating performance on  train set...
4812/4812 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1146752
{'0': {'precision': 0.3337725841751395, 'recall': 0.24880398011900184, 'f1-score': 0.28509196039492796, 'support': 408229}, '1': {'precision': 0.3323804029499197, 'recall': 0.4455724760293288, 'f1-score': 0.3807417213246723, 'support': 406017}, '2': {'precision': 0.3417015414479383, 'recall': 0.3135993793430423, 'f1-score': 0.3270478887448839, 'support': 417622}, 'accuracy': 0.3356244337867369, 'macro avg': {'precision': 0.33595150952433245, 'recall': 0.335991945163791, 'f1-score': 0.33096052348816135, 'support': 1231868}, 'weighted avg': {'precision': 0.3360017659946694, 'recall': 0.3356244337867369, 'f1-score': 0.33084130017222335, 'support': 1231868}}
[[101569 179464 127196]
 [ 99993 180910 125114]
 [102744 183912 130966]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1141437
{'0': {'precision': 0.32579631959593397, 'recall': 0.2445940986993218, 'f1-score': 0.27941513249570127, 'support': 147154}, '1': {'precision': 0.34844618283288414, 'recall': 0.4640511250301744, 'f1-score': 0.3980243173515173, 'support': 157418}, '2': {'precision': 0.32795393845851206, 'recall': 0.2934315364775489, 'f1-score': 0.3097337544481442, 'support': 147721}, 'accuracy': 0.33692540012779326, 'macro avg': {'precision': 0.33406548029577676, 'recall': 0.33402558673568167, 'f1-score': 0.3290577347651209, 'support': 452293}, 'weighted avg': {'precision': 0.33438416373022994, 'recall': 0.33692540012779326, 'f1-score': 0.33059858617521803, 'support': 452293}}
[[35993 68247 42914]
 [38457 73050 45911]
 [36027 68348 43346]]
training model: results/AAPL/W0/deepLOB_L1/h200
Epoch 1/50
4812/4812 - 114s - loss: 3.2498 - accuracy200: 0.3952 - val_loss: 3.3263 - val_accuracy200: 0.3297 - 114s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 116s - loss: 3.2332 - accuracy200: 0.4070 - val_loss: 3.3766 - val_accuracy200: 0.3282 - 116s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 116s - loss: 3.2246 - accuracy200: 0.4119 - val_loss: 3.3719 - val_accuracy200: 0.3324 - 116s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 115s - loss: 3.2193 - accuracy200: 0.4159 - val_loss: 3.3643 - val_accuracy200: 0.3349 - 115s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 113s - loss: 3.2151 - accuracy200: 0.4186 - val_loss: 3.3645 - val_accuracy200: 0.3349 - 113s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 115s - loss: 3.2120 - accuracy200: 0.4203 - val_loss: 3.3716 - val_accuracy200: 0.3322 - 115s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 116s - loss: 3.2099 - accuracy200: 0.4214 - val_loss: 3.3756 - val_accuracy200: 0.3337 - 116s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 114s - loss: 3.2083 - accuracy200: 0.4223 - val_loss: 3.4042 - val_accuracy200: 0.3327 - 114s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 115s - loss: 3.2056 - accuracy200: 0.4236 - val_loss: 3.4514 - val_accuracy200: 0.3335 - 115s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 113s - loss: 3.2043 - accuracy200: 0.4245 - val_loss: 3.4847 - val_accuracy200: 0.3309 - 113s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 113s - loss: 3.2022 - accuracy200: 0.4250 - val_loss: 3.3966 - val_accuracy200: 0.3363 - 113s/epoch - 24ms/step
testing model: results/AAPL/W0/deepLOB_L1/h200
Evaluating performance on  test set...
19053/19053 - 265s - 265s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1239218
{'0': {'precision': 0.2531633000121192, 'recall': 0.2604965079354863, 'f1-score': 0.25677755810440117, 'support': 1242961}, '1': {'precision': 0.4931449724557795, 'recall': 0.12307306007166954, 'f1-score': 0.19698502028626838, 'support': 2421391}, '2': {'precision': 0.24963353967774202, 'recall': 0.6161483934946776, 'f1-score': 0.355311882915439, 'support': 1213099}, 'accuracy': 0.2807294219870174, 'macro avg': {'precision': 0.3319806040485469, 'recall': 0.33323932050061117, 'f1-score': 0.2696914871020362, 'support': 4877451}, 'weighted avg': {'precision': 0.3714233323708563, 'recall': 0.2807294219870174, 'f1-score': 0.2516008332032097, 'support': 4877451}}
[[ 323787  156423  762751]
 [ 639398  298008 1483985]
 [ 315780  149870  747449]]
Evaluating performance on  train set...
4812/4812 - 75s - 75s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1055087
{'0': {'precision': 0.336280011074413, 'recall': 0.2113712735267517, 'f1-score': 0.2595810005418096, 'support': 407993}, '1': {'precision': 0.33793534458269414, 'recall': 0.18982807847065206, 'f1-score': 0.24309989782284053, 'support': 407337}, '2': {'precision': 0.3400070719842273, 'recall': 0.6094329929082101, 'f1-score': 0.43649206548447056, 'support': 416538}, 'accuracy': 0.33884636990326883, 'macro avg': {'precision': 0.3380741425471115, 'recall': 0.3368774483018713, 'f1-score': 0.3130576546163735, 'support': 1231868}, 'weighted avg': {'precision': 0.338087624457109, 'recall': 0.33884636990326883, 'f1-score': 0.31395112642449297, 'support': 1231868}}
[[ 86238  75176 246579]
 [ 83836  77324 246177]
 [ 86373  76313 253852]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083099
{'0': {'precision': 0.3275971480831685, 'recall': 0.23860956096765204, 'f1-score': 0.27611051027430933, 'support': 147119}, '1': {'precision': 0.35559398139755405, 'recall': 0.16059856028114194, 'f1-score': 0.22126581399788278, 'support': 158781}, '2': {'precision': 0.32331599774710523, 'recall': 0.6038745021961432, 'f1-score': 0.42114816146958567, 'support': 146393}, 'accuracy': 0.32944794635335944, 'macro avg': {'precision': 0.3355023757426092, 'recall': 0.33436087448164575, 'f1-score': 0.3061748285805926, 'support': 452293}, 'weighted avg': {'precision': 0.3360399821516687, 'recall': 0.32944794635335944, 'f1-score': 0.30380097011331375, 'support': 452293}}
[[35104 23076 88939]
 [37197 25500 96084]
 [34855 23135 88403]]
training model: results/AAPL/W0/deepLOB_L1/h300
Epoch 1/50
4812/4812 - 124s - loss: 3.2658 - accuracy300: 0.3878 - val_loss: 3.3176 - val_accuracy300: 0.3293 - 124s/epoch - 26ms/step
Epoch 2/50
4812/4812 - 121s - loss: 3.2412 - accuracy300: 0.4042 - val_loss: 3.3021 - val_accuracy300: 0.3336 - 121s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 123s - loss: 3.2273 - accuracy300: 0.4144 - val_loss: 3.3209 - val_accuracy300: 0.3407 - 123s/epoch - 26ms/step
Epoch 4/50
4812/4812 - 124s - loss: 3.2210 - accuracy300: 0.4182 - val_loss: 3.3341 - val_accuracy300: 0.3386 - 124s/epoch - 26ms/step
Epoch 5/50
4812/4812 - 125s - loss: 3.2163 - accuracy300: 0.4198 - val_loss: 3.4059 - val_accuracy300: 0.3418 - 125s/epoch - 26ms/step
Epoch 6/50
4812/4812 - 125s - loss: 3.2113 - accuracy300: 0.4224 - val_loss: 3.5018 - val_accuracy300: 0.3413 - 125s/epoch - 26ms/step
Epoch 7/50
4812/4812 - 117s - loss: 3.2074 - accuracy300: 0.4242 - val_loss: 3.5972 - val_accuracy300: 0.3396 - 117s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 124s - loss: 3.2041 - accuracy300: 0.4253 - val_loss: 3.6749 - val_accuracy300: 0.3385 - 124s/epoch - 26ms/step
Epoch 9/50
4812/4812 - 122s - loss: 3.2005 - accuracy300: 0.4266 - val_loss: 3.7679 - val_accuracy300: 0.3386 - 122s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 123s - loss: 3.2000 - accuracy300: 0.4267 - val_loss: 3.7344 - val_accuracy300: 0.3388 - 123s/epoch - 26ms/step
Epoch 11/50
4812/4812 - 123s - loss: 3.1971 - accuracy300: 0.4279 - val_loss: 3.8811 - val_accuracy300: 0.3396 - 123s/epoch - 26ms/step
Epoch 12/50
4812/4812 - 122s - loss: 3.1949 - accuracy300: 0.4287 - val_loss: 3.9454 - val_accuracy300: 0.3384 - 122s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h300
Evaluating performance on  test set...
19053/19053 - 281s - 281s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985801
{'0': {'precision': 0.27853515905721943, 'recall': 0.4794767410943769, 'f1-score': 0.35237212059137946, 'support': 1353976}, '1': {'precision': 0.451825033541157, 'recall': 0.41610713255518683, 'f1-score': 0.43323113595168306, 'support': 2201385}, '2': {'precision': 0.2709492688600224, 'recall': 0.10643072710632408, 'f1-score': 0.1528291271499759, 'support': 1322090}, 'accuracy': 0.3497570759808761, 'macro avg': {'precision': 0.33376982048613296, 'recall': 0.3340048669186293, 'f1-score': 0.31281079456434613, 'support': 4877451}, 'weighted avg': {'precision': 0.3546914342858195, 'recall': 0.3497570759808761, 'f1-score': 0.33477851018504157, 'support': 4877451}}
[[ 649200  561340  143436]
 [1050194  916012  235179]
 [ 631371  550008  140711]]
Evaluating performance on  train set...
4812/4812 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008544
{'0': {'precision': 0.33114827804495245, 'recall': 0.5898039292750149, 'f1-score': 0.42415350983726013, 'support': 407098}, '1': {'precision': 0.33516616241220837, 'recall': 0.27296580826660893, 'f1-score': 0.3008850277164116, 'support': 406648}, '2': {'precision': 0.3472088560381302, 'recall': 0.1458258594381544, 'f1-score': 0.20538930930000288, 'support': 418122}, 'accuracy': 0.3345179840697218, 'macro avg': {'precision': 0.33784109883176366, 'recall': 0.33619853232659275, 'f1-score': 0.3101426156178915, 'support': 1231868}, 'weighted avg': {'precision': 0.33792590814317675, 'recall': 0.3345179840697218, 'f1-score': 0.3092085589378798, 'support': 1231868}}
[[240108 108614  58376]
 [239387 111001  56260]
 [245582 111567  60973]]
Evaluating performance on  val set...
1767/1767 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005294
{'0': {'precision': 0.3310325197466733, 'recall': 0.5591644852823334, 'f1-score': 0.41586666203135786, 'support': 149752}, '1': {'precision': 0.3402846105589857, 'recall': 0.3330274340000646, 'f1-score': 0.33661691217297574, 'support': 154735}, '2': {'precision': 0.32696643286573146, 'recall': 0.10596998768656211, 'f1-score': 0.16006335905165806, 'support': 147806}, 'accuracy': 0.33369961507253043, 'macro avg': {'precision': 0.3327611877237968, 'recall': 0.33272063565632004, 'f1-score': 0.30418231108533056, 'support': 452293}, 'weighted avg': {'precision': 0.33286900679006926, 'recall': 0.33369961507253043, 'f1-score': 0.3051597241734775, 'support': 452293}}
[[83736 50126 15890]
 [86853 51531 16351]
 [82365 49778 15663]]
training model: results/AAPL/W0/deepLOB_L1/h500
Epoch 1/50
4812/4812 - 117s - loss: 3.2413 - accuracy500: 0.4062 - val_loss: 3.3627 - val_accuracy500: 0.3402 - 117s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 121s - loss: 3.2101 - accuracy500: 0.4238 - val_loss: 3.3120 - val_accuracy500: 0.3362 - 121s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 116s - loss: 3.1998 - accuracy500: 0.4286 - val_loss: 3.3218 - val_accuracy500: 0.3359 - 116s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 119s - loss: 3.1935 - accuracy500: 0.4312 - val_loss: 3.4227 - val_accuracy500: 0.3335 - 119s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 117s - loss: 3.1861 - accuracy500: 0.4339 - val_loss: 3.5250 - val_accuracy500: 0.3310 - 117s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 116s - loss: 3.1801 - accuracy500: 0.4357 - val_loss: 3.6233 - val_accuracy500: 0.3288 - 116s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 117s - loss: 3.1755 - accuracy500: 0.4373 - val_loss: 3.6841 - val_accuracy500: 0.3299 - 117s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 113s - loss: 3.1708 - accuracy500: 0.4384 - val_loss: 3.6517 - val_accuracy500: 0.3301 - 113s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 115s - loss: 3.1661 - accuracy500: 0.4399 - val_loss: 3.6399 - val_accuracy500: 0.3342 - 115s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 116s - loss: 3.1627 - accuracy500: 0.4412 - val_loss: 3.6649 - val_accuracy500: 0.3307 - 116s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 115s - loss: 3.1593 - accuracy500: 0.4416 - val_loss: 3.5122 - val_accuracy500: 0.3336 - 115s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 118s - loss: 3.1553 - accuracy500: 0.4433 - val_loss: 3.6903 - val_accuracy500: 0.3298 - 118s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h500
Evaluating performance on  test set...
19053/19053 - 276s - 276s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952412
{'0': {'precision': 0.2779826620048853, 'recall': 0.27322222696239457, 'f1-score': 0.2755818879335736, 'support': 1359538}, '1': {'precision': 0.44853502434502107, 'recall': 0.5397910015628701, 'f1-score': 0.489950003704121, 'support': 2187002}, '2': {'precision': 0.27526505653072897, 'recall': 0.18805314555218192, 'f1-score': 0.22345100843648488, 'support': 1330911}, 'accuracy': 0.36950899147936084, 'macro avg': {'precision': 0.33392758096021175, 'recall': 0.33368879135914886, 'f1-score': 0.32966096669139316, 'support': 4877451}, 'weighted avg': {'precision': 0.35371514327909737, 'recall': 0.36950899147936084, 'f1-score': 0.357477520911551, 'support': 4877451}}
[[ 371456  734471  253611]
 [ 601131 1180524  405347]
 [ 363669  716960  250282]]
Evaluating performance on  train set...
4812/4812 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044363
{'0': {'precision': 0.3327447171699335, 'recall': 0.2784893688296845, 'f1-score': 0.30320909251819633, 'support': 405976}, '1': {'precision': 0.33494201040878413, 'recall': 0.5341166272228693, 'f1-score': 0.4117054688100623, 'support': 406063}, '2': {'precision': 0.34656809427620444, 'recall': 0.20188219489363526, 'f1-score': 0.2551404527782753, 'support': 419829}, 'accuracy': 0.33664402354797757, 'macro avg': {'precision': 0.33808494061830735, 'recall': 0.3381627303153964, 'f1-score': 0.32335167136884463, 'support': 1231868}, 'weighted avg': {'precision': 0.3381801161506652, 'recall': 0.33664402354797757, 'f1-score': 0.3225908404756339, 'support': 1231868}}
[[113060 212264  80652]
 [110028 216885  79150]
 [116692 218381  84756]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036488
{'0': {'precision': 0.3326011081008518, 'recall': 0.2717880530532194, 'f1-score': 0.29913510507522095, 'support': 150415}, '1': {'precision': 0.34141175252724326, 'recall': 0.5542592317288364, 'f1-score': 0.422544927736194, 'support': 154711}, '2': {'precision': 0.3261311479601621, 'recall': 0.1733336957334185, 'f1-score': 0.22636034501118094, 'support': 147167}, 'accuracy': 0.33637487204091154, 'macro avg': {'precision': 0.33338133619608573, 'recall': 0.3331269935051581, 'f1-score': 0.31601345927419866, 'support': 452293}, 'weighted avg': {'precision': 0.3335096761879692, 'recall': 0.33637487204091154, 'f1-score': 0.3176691393391986, 'support': 452293}}
[[40881 83617 25917]
 [42170 85750 26791]
 [39862 81796 25509]]
training model: results/AAPL/W0/deepLOB_L1/h1000
Epoch 1/50
4812/4812 - 122s - loss: 3.1985 - accuracy1000: 0.4296 - val_loss: 3.3208 - val_accuracy1000: 0.3319 - 122s/epoch - 25ms/step
Epoch 2/50
4812/4812 - 117s - loss: 3.1448 - accuracy1000: 0.4522 - val_loss: 3.3157 - val_accuracy1000: 0.3365 - 117s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 115s - loss: 3.1256 - accuracy1000: 0.4595 - val_loss: 3.4571 - val_accuracy1000: 0.3285 - 115s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 118s - loss: 3.1112 - accuracy1000: 0.4638 - val_loss: 3.7171 - val_accuracy1000: 0.3228 - 118s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 117s - loss: 3.0983 - accuracy1000: 0.4678 - val_loss: 3.7873 - val_accuracy1000: 0.3229 - 117s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 115s - loss: 3.0892 - accuracy1000: 0.4699 - val_loss: 4.1090 - val_accuracy1000: 0.3218 - 115s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 118s - loss: 3.0811 - accuracy1000: 0.4720 - val_loss: 3.8485 - val_accuracy1000: 0.3222 - 118s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 122s - loss: 3.0763 - accuracy1000: 0.4734 - val_loss: 3.8254 - val_accuracy1000: 0.3220 - 122s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 121s - loss: 3.0705 - accuracy1000: 0.4749 - val_loss: 3.8304 - val_accuracy1000: 0.3218 - 121s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 121s - loss: 3.0653 - accuracy1000: 0.4768 - val_loss: 3.6686 - val_accuracy1000: 0.3256 - 121s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 113s - loss: 3.0622 - accuracy1000: 0.4772 - val_loss: 3.7071 - val_accuracy1000: 0.3225 - 113s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 121s - loss: 3.0586 - accuracy1000: 0.4787 - val_loss: 3.5904 - val_accuracy1000: 0.3256 - 121s/epoch - 25ms/step
testing model: results/AAPL/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
19053/19053 - 300s - 300s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011524
{'0': {'precision': 0.2624659823267923, 'recall': 0.1866148174619595, 'f1-score': 0.21813464928773846, 'support': 1276008}, '1': {'precision': 0.4864849652591925, 'recall': 0.5650054931962389, 'f1-score': 0.522813451170229, 'support': 2371115}, '2': {'precision': 0.25179302520593894, 'recall': 0.24893849445026042, 'f1-score': 0.25035762338619894, 'support': 1230328}, 'accuracy': 0.3862859924169407, 'macro avg': {'precision': 0.33358132426397463, 'recall': 0.33351960170281963, 'f1-score': 0.3304352412813888, 'support': 4877451}, 'weighted avg': {'precision': 0.3686779222780441, 'recall': 0.3862859924169407, 'f1-score': 0.37437882367354214, 'support': 4877451}}
[[ 238122  719381  318505]
 [ 439823 1339693  591599]
 [ 229304  694748  306276]]
Evaluating performance on  train set...
4812/4812 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049702
{'0': {'precision': 0.3336906641818429, 'recall': 0.19984887806781226, 'f1-score': 0.2499822396565304, 'support': 404971}, '1': {'precision': 0.33759137230924857, 'recall': 0.5185163333136665, 'f1-score': 0.4089360237699396, 'support': 406776}, '2': {'precision': 0.3488273213550953, 'recall': 0.30268660695371097, 'f1-score': 0.324123103823131, 'support': 420121}, 'accuracy': 0.3401484574645985, 'macro avg': {'precision': 0.34003645261539556, 'recall': 0.3403506061117299, 'f1-score': 0.327680455749867, 'support': 1231868}, 'weighted avg': {'precision': 0.3401409835322258, 'recall': 0.3401484574645985, 'f1-score': 0.32775576610664725, 'support': 1231868}}
[[ 80933 204293 119745]
 [ 78216 210920 117640]
 [ 83390 209566 127165]]
Evaluating performance on  val set...
1767/1767 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042147
{'0': {'precision': 0.33504780274076984, 'recall': 0.1870380709310363, 'f1-score': 0.2400627860454602, 'support': 150456}, '1': {'precision': 0.345734506503443, 'recall': 0.5549656504663093, 'f1-score': 0.42604805562785125, 'support': 156334}, '2': {'precision': 0.32221067162017075, 'recall': 0.25988467591733505, 'f1-score': 0.28771099554517404, 'support': 145503}, 'accuracy': 0.3376461718399356, 'macro avg': {'precision': 0.3343309936214612, 'recall': 0.3339627991048935, 'f1-score': 0.31794061240616184, 'support': 452293}, 'weighted avg': {'precision': 0.3346119217003673, 'recall': 0.3376461718399356, 'f1-score': 0.31967661726046986, 'support': 452293}}
[[28141 83400 38915]
 [28945 86760 40629]
 [26905 80784 37814]]
training model: results/AAPL/W0/deepOF_L1/h10
Epoch 1/50
4812/4812 - 117s - loss: 3.2031 - accuracy10: 0.4271 - val_loss: 3.3392 - val_accuracy10: 0.3859 - 117s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 109s - loss: 3.1957 - accuracy10: 0.4292 - val_loss: 3.3272 - val_accuracy10: 0.3862 - 109s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 111s - loss: 3.1921 - accuracy10: 0.4304 - val_loss: 3.3170 - val_accuracy10: 0.3861 - 111s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 113s - loss: 3.1872 - accuracy10: 0.4317 - val_loss: 3.3128 - val_accuracy10: 0.3865 - 113s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 112s - loss: 3.1825 - accuracy10: 0.4336 - val_loss: 3.3067 - val_accuracy10: 0.3897 - 112s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 112s - loss: 3.1791 - accuracy10: 0.4350 - val_loss: 3.3046 - val_accuracy10: 0.3904 - 112s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 111s - loss: 3.1752 - accuracy10: 0.4360 - val_loss: 3.3003 - val_accuracy10: 0.3925 - 111s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 112s - loss: 3.1719 - accuracy10: 0.4373 - val_loss: 3.3003 - val_accuracy10: 0.3929 - 112s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 111s - loss: 3.1691 - accuracy10: 0.4386 - val_loss: 3.2984 - val_accuracy10: 0.3941 - 111s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 115s - loss: 3.1656 - accuracy10: 0.4390 - val_loss: 3.2915 - val_accuracy10: 0.3971 - 115s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 115s - loss: 3.1621 - accuracy10: 0.4405 - val_loss: 3.2902 - val_accuracy10: 0.3969 - 115s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 116s - loss: 3.1584 - accuracy10: 0.4419 - val_loss: 3.2886 - val_accuracy10: 0.3970 - 116s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 115s - loss: 3.1550 - accuracy10: 0.4429 - val_loss: 3.2849 - val_accuracy10: 0.3980 - 115s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 111s - loss: 3.1515 - accuracy10: 0.4440 - val_loss: 3.2851 - val_accuracy10: 0.3969 - 111s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 113s - loss: 3.1492 - accuracy10: 0.4452 - val_loss: 3.2840 - val_accuracy10: 0.3979 - 113s/epoch - 23ms/step
Epoch 16/50
4812/4812 - 116s - loss: 3.1463 - accuracy10: 0.4464 - val_loss: 3.2851 - val_accuracy10: 0.3976 - 116s/epoch - 24ms/step
Epoch 17/50
4812/4812 - 112s - loss: 3.1437 - accuracy10: 0.4472 - val_loss: 3.2856 - val_accuracy10: 0.3972 - 112s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 113s - loss: 3.1413 - accuracy10: 0.4481 - val_loss: 3.2792 - val_accuracy10: 0.3986 - 113s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 117s - loss: 3.1389 - accuracy10: 0.4490 - val_loss: 3.2760 - val_accuracy10: 0.3989 - 117s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 114s - loss: 3.1366 - accuracy10: 0.4494 - val_loss: 3.2802 - val_accuracy10: 0.3982 - 114s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 114s - loss: 3.1349 - accuracy10: 0.4498 - val_loss: 3.2685 - val_accuracy10: 0.4012 - 114s/epoch - 24ms/step
Epoch 22/50
4812/4812 - 116s - loss: 3.1328 - accuracy10: 0.4507 - val_loss: 3.2686 - val_accuracy10: 0.4011 - 116s/epoch - 24ms/step
Epoch 23/50
4812/4812 - 116s - loss: 3.1309 - accuracy10: 0.4512 - val_loss: 3.2733 - val_accuracy10: 0.3995 - 116s/epoch - 24ms/step
Epoch 24/50
4812/4812 - 115s - loss: 3.1295 - accuracy10: 0.4517 - val_loss: 3.2724 - val_accuracy10: 0.4005 - 115s/epoch - 24ms/step
Epoch 25/50
4812/4812 - 113s - loss: 3.1274 - accuracy10: 0.4526 - val_loss: 3.2660 - val_accuracy10: 0.4029 - 113s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 108s - loss: 3.1249 - accuracy10: 0.4534 - val_loss: 3.2625 - val_accuracy10: 0.4034 - 108s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 113s - loss: 3.1235 - accuracy10: 0.4538 - val_loss: 3.2639 - val_accuracy10: 0.4026 - 113s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 113s - loss: 3.1223 - accuracy10: 0.4543 - val_loss: 3.2646 - val_accuracy10: 0.4017 - 113s/epoch - 24ms/step
Epoch 29/50
4812/4812 - 114s - loss: 3.1202 - accuracy10: 0.4550 - val_loss: 3.2615 - val_accuracy10: 0.4017 - 114s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 114s - loss: 3.1186 - accuracy10: 0.4560 - val_loss: 3.2585 - val_accuracy10: 0.4031 - 114s/epoch - 24ms/step
Epoch 31/50
4812/4812 - 115s - loss: 3.1173 - accuracy10: 0.4564 - val_loss: 3.2597 - val_accuracy10: 0.4034 - 115s/epoch - 24ms/step
Epoch 32/50
4812/4812 - 111s - loss: 3.1157 - accuracy10: 0.4565 - val_loss: 3.2590 - val_accuracy10: 0.4031 - 111s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 114s - loss: 3.1142 - accuracy10: 0.4571 - val_loss: 3.2581 - val_accuracy10: 0.4040 - 114s/epoch - 24ms/step
Epoch 34/50
4812/4812 - 114s - loss: 3.1127 - accuracy10: 0.4578 - val_loss: 3.2577 - val_accuracy10: 0.4054 - 114s/epoch - 24ms/step
Epoch 35/50
4812/4812 - 115s - loss: 3.1115 - accuracy10: 0.4581 - val_loss: 3.2623 - val_accuracy10: 0.4026 - 115s/epoch - 24ms/step
Epoch 36/50
4812/4812 - 116s - loss: 3.1101 - accuracy10: 0.4588 - val_loss: 3.2525 - val_accuracy10: 0.4067 - 116s/epoch - 24ms/step
Epoch 37/50
4812/4812 - 113s - loss: 3.1089 - accuracy10: 0.4594 - val_loss: 3.2601 - val_accuracy10: 0.4040 - 113s/epoch - 23ms/step
Epoch 38/50
4812/4812 - 108s - loss: 3.1072 - accuracy10: 0.4597 - val_loss: 3.2533 - val_accuracy10: 0.4061 - 108s/epoch - 22ms/step
Epoch 39/50
4812/4812 - 115s - loss: 3.1058 - accuracy10: 0.4601 - val_loss: 3.2543 - val_accuracy10: 0.4071 - 115s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 114s - loss: 3.1049 - accuracy10: 0.4607 - val_loss: 3.2540 - val_accuracy10: 0.4059 - 114s/epoch - 24ms/step
Epoch 41/50
4812/4812 - 110s - loss: 3.1042 - accuracy10: 0.4606 - val_loss: 3.2516 - val_accuracy10: 0.4069 - 110s/epoch - 23ms/step
Epoch 42/50
4812/4812 - 113s - loss: 3.1028 - accuracy10: 0.4610 - val_loss: 3.2531 - val_accuracy10: 0.4055 - 113s/epoch - 23ms/step
Epoch 43/50
4812/4812 - 114s - loss: 3.1013 - accuracy10: 0.4616 - val_loss: 3.2474 - val_accuracy10: 0.4090 - 114s/epoch - 24ms/step
Epoch 44/50
4812/4812 - 111s - loss: 3.1006 - accuracy10: 0.4617 - val_loss: 3.2504 - val_accuracy10: 0.4069 - 111s/epoch - 23ms/step
Epoch 45/50
4812/4812 - 116s - loss: 3.0991 - accuracy10: 0.4628 - val_loss: 3.2483 - val_accuracy10: 0.4090 - 116s/epoch - 24ms/step
Epoch 46/50
4812/4812 - 116s - loss: 3.0979 - accuracy10: 0.4626 - val_loss: 3.2501 - val_accuracy10: 0.4082 - 116s/epoch - 24ms/step
Epoch 47/50
4812/4812 - 117s - loss: 3.0970 - accuracy10: 0.4636 - val_loss: 3.2524 - val_accuracy10: 0.4065 - 117s/epoch - 24ms/step
Epoch 48/50
4812/4812 - 116s - loss: 3.0960 - accuracy10: 0.4638 - val_loss: 3.2512 - val_accuracy10: 0.4087 - 116s/epoch - 24ms/step
Epoch 49/50
4812/4812 - 109s - loss: 3.0946 - accuracy10: 0.4640 - val_loss: 3.2553 - val_accuracy10: 0.4074 - 109s/epoch - 23ms/step
Epoch 50/50
4812/4812 - 113s - loss: 3.0940 - accuracy10: 0.4641 - val_loss: 3.2526 - val_accuracy10: 0.4072 - 113s/epoch - 24ms/step
testing model: results/AAPL/W0/deepOF_L1/h10
Evaluating performance on  test set...
19053/19053 - 285s - 285s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1236002
{'0': {'precision': 0.3064782329477398, 'recall': 0.6371901345885647, 'f1-score': 0.4138846086581849, 'support': 1177366}, '1': {'precision': 0.6569279212992737, 'recall': 0.13947468864973342, 'f1-score': 0.23009672782061683, 'support': 2541350}, '2': {'precision': 0.32208851065180644, 'recall': 0.5253726062154255, 'f1-score': 0.3993492489631115, 'support': 1158730}, 'accuracy': 0.3512955345892092, 'macro avg': {'precision': 0.42849822163294, 'recall': 0.4340124764845745, 'f1-score': 0.3477768618139711, 'support': 4877446}, 'weighted avg': {'precision': 0.49278545450922984, 'recall': 0.3512955345892092, 'f1-score': 0.31467041165712617, 'support': 4877446}}
[[ 750206   85010  342150]
 [1247756  354454  939140]
 [ 449866  100099  608765]]
Evaluating performance on  train set...
4812/4812 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0695066
{'0': {'precision': 0.40748811376761673, 'recall': 0.5890838446310664, 'f1-score': 0.4817407567545827, 'support': 406645}, '1': {'precision': 0.4706477809254013, 'recall': 0.1530742865566762, 'f1-score': 0.23101338573918198, 'support': 407005}, '2': {'precision': 0.42494825331735814, 'recall': 0.5198616985918794, 'f1-score': 0.46763758221809254, 'support': 418217}, 'accuracy': 0.42152683690690634, 'macro avg': {'precision': 0.43436138267012536, 'recall': 0.4206732765932073, 'f1-score': 0.3934639082372857, 'support': 1231867}, 'weighted avg': {'precision': 0.4342835612579938, 'recall': 0.42152683690690634, 'f1-score': 0.3941132117474915, 'support': 1231867}}
[[239548  32701 134396]
 [184887  62302 159816]
 [163430  37372 217415]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0816327
{'0': {'precision': 0.39884863828440587, 'recall': 0.57981868615114, 'f1-score': 0.4726016443976332, 'support': 147810}, '1': {'precision': 0.45308373465900265, 'recall': 0.15166209487656165, 'f1-score': 0.22725457538302699, 'support': 153842}, '2': {'precision': 0.40803889824172634, 'recall': 0.503601277208728, 'f1-score': 0.450811440388398, 'support': 150641}, 'accuracy': 0.4088013743303566, 'macro avg': {'precision': 0.4199904237283783, 'recall': 0.41169401941214323, 'f1-score': 0.3835558867230194, 'support': 452293}, 'weighted avg': {'precision': 0.4203569650696788, 'recall': 0.4088013743303566, 'f1-score': 0.38189234331735944, 'support': 452293}}
[[85703 13125 48982]
 [69434 23332 61076]
 [59739 15039 75863]]
training model: results/AAPL/W0/deepOF_L1/h20
Epoch 1/50
4812/4812 - 116s - loss: 3.2262 - accuracy20: 0.4153 - val_loss: 3.3262 - val_accuracy20: 0.3832 - 116s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 115s - loss: 3.2196 - accuracy20: 0.4183 - val_loss: 3.3176 - val_accuracy20: 0.3828 - 115s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 114s - loss: 3.2190 - accuracy20: 0.4181 - val_loss: 3.3158 - val_accuracy20: 0.3834 - 114s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 117s - loss: 3.2168 - accuracy20: 0.4186 - val_loss: 3.3108 - val_accuracy20: 0.3849 - 117s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 117s - loss: 3.2143 - accuracy20: 0.4197 - val_loss: 3.3103 - val_accuracy20: 0.3851 - 117s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 118s - loss: 3.2124 - accuracy20: 0.4204 - val_loss: 3.3114 - val_accuracy20: 0.3853 - 118s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 118s - loss: 3.2102 - accuracy20: 0.4214 - val_loss: 3.3072 - val_accuracy20: 0.3860 - 118s/epoch - 25ms/step
Epoch 8/50
4812/4812 - 118s - loss: 3.2081 - accuracy20: 0.4220 - val_loss: 3.3033 - val_accuracy20: 0.3870 - 118s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 111s - loss: 3.2058 - accuracy20: 0.4228 - val_loss: 3.3015 - val_accuracy20: 0.3873 - 111s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 114s - loss: 3.2039 - accuracy20: 0.4238 - val_loss: 3.3017 - val_accuracy20: 0.3872 - 114s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 115s - loss: 3.2013 - accuracy20: 0.4251 - val_loss: 3.3005 - val_accuracy20: 0.3868 - 115s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 114s - loss: 3.1981 - accuracy20: 0.4269 - val_loss: 3.3006 - val_accuracy20: 0.3872 - 114s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 114s - loss: 3.1963 - accuracy20: 0.4279 - val_loss: 3.2961 - val_accuracy20: 0.3881 - 114s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 114s - loss: 3.1944 - accuracy20: 0.4283 - val_loss: 3.2966 - val_accuracy20: 0.3878 - 114s/epoch - 24ms/step
Epoch 15/50
4812/4812 - 113s - loss: 3.1926 - accuracy20: 0.4290 - val_loss: 3.2931 - val_accuracy20: 0.3883 - 113s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 113s - loss: 3.1911 - accuracy20: 0.4295 - val_loss: 3.2913 - val_accuracy20: 0.3887 - 113s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 116s - loss: 3.1891 - accuracy20: 0.4303 - val_loss: 3.2901 - val_accuracy20: 0.3897 - 116s/epoch - 24ms/step
Epoch 18/50
4812/4812 - 114s - loss: 3.1875 - accuracy20: 0.4310 - val_loss: 3.2874 - val_accuracy20: 0.3892 - 114s/epoch - 24ms/step
Epoch 19/50
4812/4812 - 114s - loss: 3.1861 - accuracy20: 0.4316 - val_loss: 3.2875 - val_accuracy20: 0.3897 - 114s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 113s - loss: 3.1834 - accuracy20: 0.4325 - val_loss: 3.2863 - val_accuracy20: 0.3893 - 113s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 116s - loss: 3.1820 - accuracy20: 0.4329 - val_loss: 3.2852 - val_accuracy20: 0.3904 - 116s/epoch - 24ms/step
Epoch 22/50
4812/4812 - 119s - loss: 3.1803 - accuracy20: 0.4337 - val_loss: 3.2847 - val_accuracy20: 0.3898 - 119s/epoch - 25ms/step
Epoch 23/50
4812/4812 - 111s - loss: 3.1788 - accuracy20: 0.4346 - val_loss: 3.2814 - val_accuracy20: 0.3916 - 111s/epoch - 23ms/step
Epoch 24/50
4812/4812 - 112s - loss: 3.1773 - accuracy20: 0.4349 - val_loss: 3.2831 - val_accuracy20: 0.3908 - 112s/epoch - 23ms/step
Epoch 25/50
4812/4812 - 116s - loss: 3.1761 - accuracy20: 0.4353 - val_loss: 3.2804 - val_accuracy20: 0.3923 - 116s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 117s - loss: 3.1745 - accuracy20: 0.4359 - val_loss: 3.2801 - val_accuracy20: 0.3920 - 117s/epoch - 24ms/step
Epoch 27/50
4812/4812 - 116s - loss: 3.1730 - accuracy20: 0.4365 - val_loss: 3.2786 - val_accuracy20: 0.3925 - 116s/epoch - 24ms/step
Epoch 28/50
4812/4812 - 116s - loss: 3.1721 - accuracy20: 0.4370 - val_loss: 3.2784 - val_accuracy20: 0.3924 - 116s/epoch - 24ms/step
Epoch 29/50
4812/4812 - 114s - loss: 3.1706 - accuracy20: 0.4368 - val_loss: 3.2746 - val_accuracy20: 0.3939 - 114s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 114s - loss: 3.1694 - accuracy20: 0.4374 - val_loss: 3.2763 - val_accuracy20: 0.3934 - 114s/epoch - 24ms/step
Epoch 31/50
4812/4812 - 115s - loss: 3.1684 - accuracy20: 0.4379 - val_loss: 3.2733 - val_accuracy20: 0.3944 - 115s/epoch - 24ms/step
Epoch 32/50
4812/4812 - 114s - loss: 3.1675 - accuracy20: 0.4383 - val_loss: 3.2723 - val_accuracy20: 0.3936 - 114s/epoch - 24ms/step
Epoch 33/50
4812/4812 - 113s - loss: 3.1663 - accuracy20: 0.4390 - val_loss: 3.2716 - val_accuracy20: 0.3940 - 113s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 113s - loss: 3.1652 - accuracy20: 0.4387 - val_loss: 3.2706 - val_accuracy20: 0.3946 - 113s/epoch - 24ms/step
Epoch 35/50
4812/4812 - 113s - loss: 3.1639 - accuracy20: 0.4395 - val_loss: 3.2712 - val_accuracy20: 0.3938 - 113s/epoch - 24ms/step
Epoch 36/50
4812/4812 - 116s - loss: 3.1631 - accuracy20: 0.4399 - val_loss: 3.2711 - val_accuracy20: 0.3942 - 116s/epoch - 24ms/step
Epoch 37/50
4812/4812 - 112s - loss: 3.1616 - accuracy20: 0.4404 - val_loss: 3.2716 - val_accuracy20: 0.3947 - 112s/epoch - 23ms/step
Epoch 38/50
4812/4812 - 114s - loss: 3.1609 - accuracy20: 0.4410 - val_loss: 3.2706 - val_accuracy20: 0.3946 - 114s/epoch - 24ms/step
Epoch 39/50
4812/4812 - 114s - loss: 3.1599 - accuracy20: 0.4414 - val_loss: 3.2690 - val_accuracy20: 0.3953 - 114s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 114s - loss: 3.1589 - accuracy20: 0.4415 - val_loss: 3.2697 - val_accuracy20: 0.3943 - 114s/epoch - 24ms/step
Epoch 41/50
4812/4812 - 111s - loss: 3.1582 - accuracy20: 0.4413 - val_loss: 3.2709 - val_accuracy20: 0.3952 - 111s/epoch - 23ms/step
Epoch 42/50
4812/4812 - 110s - loss: 3.1575 - accuracy20: 0.4420 - val_loss: 3.2687 - val_accuracy20: 0.3953 - 110s/epoch - 23ms/step
Epoch 43/50
4812/4812 - 111s - loss: 3.1562 - accuracy20: 0.4422 - val_loss: 3.2678 - val_accuracy20: 0.3949 - 111s/epoch - 23ms/step
Epoch 44/50
4812/4812 - 115s - loss: 3.1552 - accuracy20: 0.4427 - val_loss: 3.2694 - val_accuracy20: 0.3957 - 115s/epoch - 24ms/step
Epoch 45/50
4812/4812 - 113s - loss: 3.1545 - accuracy20: 0.4431 - val_loss: 3.2697 - val_accuracy20: 0.3948 - 113s/epoch - 23ms/step
Epoch 46/50
4812/4812 - 117s - loss: 3.1537 - accuracy20: 0.4432 - val_loss: 3.2667 - val_accuracy20: 0.3958 - 117s/epoch - 24ms/step
Epoch 47/50
4812/4812 - 112s - loss: 3.1532 - accuracy20: 0.4435 - val_loss: 3.2687 - val_accuracy20: 0.3955 - 112s/epoch - 23ms/step
Epoch 48/50
4812/4812 - 114s - loss: 3.1522 - accuracy20: 0.4442 - val_loss: 3.2699 - val_accuracy20: 0.3950 - 114s/epoch - 24ms/step
Epoch 49/50
4812/4812 - 112s - loss: 3.1508 - accuracy20: 0.4444 - val_loss: 3.2682 - val_accuracy20: 0.3958 - 112s/epoch - 23ms/step
Epoch 50/50
4812/4812 - 113s - loss: 3.1506 - accuracy20: 0.4445 - val_loss: 3.2659 - val_accuracy20: 0.3957 - 113s/epoch - 23ms/step
testing model: results/AAPL/W0/deepOF_L1/h20
Evaluating performance on  test set...
19053/19053 - 304s - 304s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.113164
{'0': {'precision': 0.31220134278259837, 'recall': 0.6843457117914012, 'f1-score': 0.42878788145155966, 'support': 1247409}, '1': {'precision': 0.6103668823810843, 'recall': 0.06070105657243145, 'f1-score': 0.11042075625049115, 'support': 2395955}, '2': {'precision': 0.34142340115683895, 'recall': 0.5269982059538993, 'f1-score': 0.41438287211430147, 'support': 1234082}, 'accuracy': 0.33818006391049743, 'macro avg': {'precision': 0.4213305421068405, 'recall': 0.424014991439244, 'f1-score': 0.31786383660545076, 'support': 4877446}, 'weighted avg': {'precision': 0.4660633500034451, 'recall': 0.33818006391049743, 'f1-score': 0.26875120073914005, 'support': 4877446}}
[[ 853659   42019  351731]
 [1347762  145437  902756]
 [ 532901   50822  650359]]
Evaluating performance on  train set...
4812/4812 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0771396
{'0': {'precision': 0.39738956468764014, 'recall': 0.6380048019620709, 'f1-score': 0.489738902753962, 'support': 406917}, '1': {'precision': 0.43776836787757223, 'recall': 0.072462378046831, 'f1-score': 0.12434271052253987, 'support': 406611}, '2': {'precision': 0.4218119512343011, 'recall': 0.5155053676563743, 'f1-score': 0.46397590361445784, 'support': 418339}, 'accuracy': 0.40973173240292987, 'macro avg': {'precision': 0.41898996126650445, 'recall': 0.4086575158884254, 'f1-score': 0.3593525056303199, 'support': 1231867}, 'weighted avg': {'precision': 0.41901146243261184, 'recall': 0.40973173240292987, 'f1-score': 0.3603809619889023, 'support': 1231867}}
[[259615  17901 129401]
 [210943  29464 166204]
 [182743  19940 215656]]
Evaluating performance on  val set...
1767/1767 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0879669
{'0': {'precision': 0.3877696717260258, 'recall': 0.6210185911833951, 'f1-score': 0.4774285825737579, 'support': 147812}, '1': {'precision': 0.4208418348069221, 'recall': 0.07222243836646824, 'f1-score': 0.12328706470965886, 'support': 154218}, '2': {'precision': 0.4014140367205347, 'recall': 0.5051742611288208, 'f1-score': 0.4473564017715334, 'support': 150263}, 'accuracy': 0.39540961279524556, 'macro avg': {'precision': 0.40334184775116083, 'recall': 0.3994717635595613, 'f1-score': 0.3493573496849834, 'support': 452293}, 'weighted avg': {'precision': 0.40357925989824944, 'recall': 0.39540961279524556, 'f1-score': 0.346686491261599, 'support': 452293}}
[[91794  7352 48666]
 [78551 11138 64529]
 [66378  7976 75909]]
training model: results/AAPL/W0/deepOF_L1/h30
Epoch 1/50
4812/4812 - 106s - loss: 3.2415 - accuracy30: 0.4062 - val_loss: 3.3077 - val_accuracy30: 0.3791 - 106s/epoch - 22ms/step
Epoch 2/50
4812/4812 - 108s - loss: 3.2325 - accuracy30: 0.4107 - val_loss: 3.2962 - val_accuracy30: 0.3825 - 108s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 108s - loss: 3.2314 - accuracy30: 0.4115 - val_loss: 3.2920 - val_accuracy30: 0.3823 - 108s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 108s - loss: 3.2292 - accuracy30: 0.4120 - val_loss: 3.2909 - val_accuracy30: 0.3834 - 108s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 110s - loss: 3.2269 - accuracy30: 0.4131 - val_loss: 3.2884 - val_accuracy30: 0.3835 - 110s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 111s - loss: 3.2249 - accuracy30: 0.4138 - val_loss: 3.2870 - val_accuracy30: 0.3841 - 111s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 109s - loss: 3.2232 - accuracy30: 0.4147 - val_loss: 3.2858 - val_accuracy30: 0.3846 - 109s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 109s - loss: 3.2211 - accuracy30: 0.4159 - val_loss: 3.2838 - val_accuracy30: 0.3853 - 109s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 110s - loss: 3.2187 - accuracy30: 0.4174 - val_loss: 3.2820 - val_accuracy30: 0.3864 - 110s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 110s - loss: 3.2173 - accuracy30: 0.4176 - val_loss: 3.2805 - val_accuracy30: 0.3867 - 110s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 112s - loss: 3.2153 - accuracy30: 0.4189 - val_loss: 3.2801 - val_accuracy30: 0.3863 - 112s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 110s - loss: 3.2136 - accuracy30: 0.4196 - val_loss: 3.2783 - val_accuracy30: 0.3872 - 110s/epoch - 23ms/step
Epoch 13/50
4812/4812 - 110s - loss: 3.2118 - accuracy30: 0.4209 - val_loss: 3.2805 - val_accuracy30: 0.3863 - 110s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 108s - loss: 3.2101 - accuracy30: 0.4213 - val_loss: 3.2785 - val_accuracy30: 0.3873 - 108s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.2089 - accuracy30: 0.4222 - val_loss: 3.2775 - val_accuracy30: 0.3871 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 110s - loss: 3.2075 - accuracy30: 0.4228 - val_loss: 3.2789 - val_accuracy30: 0.3868 - 110s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 107s - loss: 3.2061 - accuracy30: 0.4228 - val_loss: 3.2776 - val_accuracy30: 0.3868 - 107s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 110s - loss: 3.2046 - accuracy30: 0.4236 - val_loss: 3.2760 - val_accuracy30: 0.3874 - 110s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 108s - loss: 3.2029 - accuracy30: 0.4246 - val_loss: 3.2737 - val_accuracy30: 0.3879 - 108s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 109s - loss: 3.2014 - accuracy30: 0.4248 - val_loss: 3.2762 - val_accuracy30: 0.3877 - 109s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 109s - loss: 3.2007 - accuracy30: 0.4251 - val_loss: 3.2737 - val_accuracy30: 0.3880 - 109s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 110s - loss: 3.1991 - accuracy30: 0.4261 - val_loss: 3.2732 - val_accuracy30: 0.3882 - 110s/epoch - 23ms/step
Epoch 23/50
4812/4812 - 109s - loss: 3.1982 - accuracy30: 0.4261 - val_loss: 3.2730 - val_accuracy30: 0.3884 - 109s/epoch - 23ms/step
Epoch 24/50
4812/4812 - 108s - loss: 3.1968 - accuracy30: 0.4272 - val_loss: 3.2730 - val_accuracy30: 0.3881 - 108s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 105s - loss: 3.1956 - accuracy30: 0.4274 - val_loss: 3.2707 - val_accuracy30: 0.3889 - 105s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 108s - loss: 3.1944 - accuracy30: 0.4280 - val_loss: 3.2708 - val_accuracy30: 0.3895 - 108s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 107s - loss: 3.1936 - accuracy30: 0.4282 - val_loss: 3.2703 - val_accuracy30: 0.3888 - 107s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 107s - loss: 3.1929 - accuracy30: 0.4290 - val_loss: 3.2714 - val_accuracy30: 0.3888 - 107s/epoch - 22ms/step
Epoch 29/50
4812/4812 - 110s - loss: 3.1918 - accuracy30: 0.4290 - val_loss: 3.2690 - val_accuracy30: 0.3899 - 110s/epoch - 23ms/step
Epoch 30/50
4812/4812 - 107s - loss: 3.1908 - accuracy30: 0.4296 - val_loss: 3.2703 - val_accuracy30: 0.3889 - 107s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 105s - loss: 3.1901 - accuracy30: 0.4298 - val_loss: 3.2711 - val_accuracy30: 0.3888 - 105s/epoch - 22ms/step
Epoch 32/50
4812/4812 - 108s - loss: 3.1887 - accuracy30: 0.4306 - val_loss: 3.2707 - val_accuracy30: 0.3886 - 108s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 107s - loss: 3.1880 - accuracy30: 0.4310 - val_loss: 3.2689 - val_accuracy30: 0.3901 - 107s/epoch - 22ms/step
Epoch 34/50
4812/4812 - 105s - loss: 3.1873 - accuracy30: 0.4312 - val_loss: 3.2715 - val_accuracy30: 0.3892 - 105s/epoch - 22ms/step
Epoch 35/50
4812/4812 - 107s - loss: 3.1862 - accuracy30: 0.4313 - val_loss: 3.2710 - val_accuracy30: 0.3889 - 107s/epoch - 22ms/step
Epoch 36/50
4812/4812 - 106s - loss: 3.1857 - accuracy30: 0.4322 - val_loss: 3.2698 - val_accuracy30: 0.3903 - 106s/epoch - 22ms/step
Epoch 37/50
4812/4812 - 106s - loss: 3.1846 - accuracy30: 0.4322 - val_loss: 3.2678 - val_accuracy30: 0.3902 - 106s/epoch - 22ms/step
Epoch 38/50
4812/4812 - 106s - loss: 3.1837 - accuracy30: 0.4328 - val_loss: 3.2676 - val_accuracy30: 0.3906 - 106s/epoch - 22ms/step
Epoch 39/50
4812/4812 - 106s - loss: 3.1829 - accuracy30: 0.4331 - val_loss: 3.2682 - val_accuracy30: 0.3898 - 106s/epoch - 22ms/step
Epoch 40/50
4812/4812 - 108s - loss: 3.1826 - accuracy30: 0.4334 - val_loss: 3.2697 - val_accuracy30: 0.3903 - 108s/epoch - 22ms/step
Epoch 41/50
4812/4812 - 105s - loss: 3.1818 - accuracy30: 0.4334 - val_loss: 3.2709 - val_accuracy30: 0.3897 - 105s/epoch - 22ms/step
Epoch 42/50
4812/4812 - 106s - loss: 3.1806 - accuracy30: 0.4340 - val_loss: 3.2696 - val_accuracy30: 0.3902 - 106s/epoch - 22ms/step
Epoch 43/50
4812/4812 - 106s - loss: 3.1799 - accuracy30: 0.4345 - val_loss: 3.2680 - val_accuracy30: 0.3901 - 106s/epoch - 22ms/step
Epoch 44/50
4812/4812 - 107s - loss: 3.1790 - accuracy30: 0.4349 - val_loss: 3.2713 - val_accuracy30: 0.3892 - 107s/epoch - 22ms/step
Epoch 45/50
4812/4812 - 107s - loss: 3.1789 - accuracy30: 0.4350 - val_loss: 3.2702 - val_accuracy30: 0.3898 - 107s/epoch - 22ms/step
Epoch 46/50
4812/4812 - 109s - loss: 3.1781 - accuracy30: 0.4352 - val_loss: 3.2700 - val_accuracy30: 0.3900 - 109s/epoch - 23ms/step
Epoch 47/50
4812/4812 - 109s - loss: 3.1769 - accuracy30: 0.4352 - val_loss: 3.2709 - val_accuracy30: 0.3905 - 109s/epoch - 23ms/step
Epoch 48/50
4812/4812 - 110s - loss: 3.1762 - accuracy30: 0.4361 - val_loss: 3.2705 - val_accuracy30: 0.3904 - 110s/epoch - 23ms/step
testing model: results/AAPL/W0/deepOF_L1/h30
Evaluating performance on  test set...
19053/19053 - 284s - 284s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1011615
{'0': {'precision': 0.3285805346503116, 'recall': 0.6783474749376954, 'f1-score': 0.4427164084648213, 'support': 1316918}, '1': {'precision': 0.5332238748309832, 'recall': 0.026875857973187426, 'f1-score': 0.051172490499582904, 'support': 2259686}, '2': {'precision': 0.35098882386224983, 'recall': 0.5517218847484937, 'f1-score': 0.4290371512817409, 'support': 1300842}, 'accuracy': 0.34275356405791063, 'macro avg': {'precision': 0.4042644111145149, 'recall': 0.41898173921979226, 'f1-score': 0.30764201674871505, 'support': 4877446}, 'weighted avg': {'precision': 0.42936675238691746, 'recall': 0.34275356405791063, 'f1-score': 0.25766856537568195, 'support': 4877446}}
[[ 893328   26540  397050]
 [1268905   60731  930050]
 [ 556516   26623  717703]]
Evaluating performance on  train set...
4812/4812 - 75s - 75s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0801771
{'0': {'precision': 0.39622635582945415, 'recall': 0.6220811819764374, 'f1-score': 0.4841071103051934, 'support': 405558}, '1': {'precision': 0.4037959161912886, 'recall': 0.037211907417324615, 'f1-score': 0.06814398949139427, 'support': 407074}, '2': {'precision': 0.4135030782556611, 'recall': 0.5499970183787136, 'f1-score': 0.47208186262867813, 'support': 419235}, 'accuracy': 0.40427740981778065, 'macro avg': {'precision': 0.4045084500921346, 'recall': 0.4030967025908252, 'f1-score': 0.34144432080842196, 'support': 1231867}, 'weighted avg': {'precision': 0.4046074375055476, 'recall': 0.40427740981778065, 'f1-score': 0.3425584072781455, 'support': 1231867}}
[[252290  10749 142519]
 [207402  15148 184524]
 [177040  11617 230578]]
Evaluating performance on  val set...
1767/1767 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.088354
{'0': {'precision': 0.3853438566626258, 'recall': 0.60877980536106, 'f1-score': 0.47195246832494014, 'support': 147247}, '1': {'precision': 0.4041807054940521, 'recall': 0.03796274768141776, 'f1-score': 0.06940647896138247, 'support': 154836}, '2': {'precision': 0.39516585089994344, 'recall': 0.539631183010452, 'f1-score': 0.45623554177196657, 'support': 150210}, 'accuracy': 0.390404008021349, 'macro avg': {'precision': 0.39489680435220714, 'recall': 0.3954579120176433, 'f1-score': 0.3325314963527631, 'support': 452293}, 'weighted avg': {'precision': 0.3950543409726863, 'recall': 0.390404008021349, 'f1-score': 0.3289269288038377, 'support': 452293}}
[[89641  4283 53323]
 [78215  5878 70743]
 [64770  4382 81058]]
training model: results/AAPL/W0/deepOF_L1/h50
Epoch 1/50
4812/4812 - 110s - loss: 3.2123 - accuracy50: 0.4224 - val_loss: 3.2869 - val_accuracy50: 0.3628 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 109s - loss: 3.2064 - accuracy50: 0.4254 - val_loss: 3.2755 - val_accuracy50: 0.3656 - 109s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 109s - loss: 3.2081 - accuracy50: 0.4243 - val_loss: 3.2729 - val_accuracy50: 0.3673 - 109s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 109s - loss: 3.2072 - accuracy50: 0.4247 - val_loss: 3.2726 - val_accuracy50: 0.3691 - 109s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 109s - loss: 3.2044 - accuracy50: 0.4260 - val_loss: 3.2723 - val_accuracy50: 0.3701 - 109s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 111s - loss: 3.2017 - accuracy50: 0.4277 - val_loss: 3.2729 - val_accuracy50: 0.3700 - 111s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 110s - loss: 3.2008 - accuracy50: 0.4282 - val_loss: 3.2713 - val_accuracy50: 0.3714 - 110s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 108s - loss: 3.1990 - accuracy50: 0.4291 - val_loss: 3.2711 - val_accuracy50: 0.3709 - 108s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 113s - loss: 3.1976 - accuracy50: 0.4296 - val_loss: 3.2706 - val_accuracy50: 0.3711 - 113s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.1964 - accuracy50: 0.4303 - val_loss: 3.2700 - val_accuracy50: 0.3727 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 108s - loss: 3.1948 - accuracy50: 0.4312 - val_loss: 3.2696 - val_accuracy50: 0.3723 - 108s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 110s - loss: 3.1943 - accuracy50: 0.4313 - val_loss: 3.2689 - val_accuracy50: 0.3725 - 110s/epoch - 23ms/step
Epoch 13/50
4812/4812 - 110s - loss: 3.1936 - accuracy50: 0.4314 - val_loss: 3.2689 - val_accuracy50: 0.3728 - 110s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 110s - loss: 3.1928 - accuracy50: 0.4319 - val_loss: 3.2682 - val_accuracy50: 0.3732 - 110s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 109s - loss: 3.1920 - accuracy50: 0.4321 - val_loss: 3.2677 - val_accuracy50: 0.3745 - 109s/epoch - 23ms/step
Epoch 16/50
4812/4812 - 111s - loss: 3.1910 - accuracy50: 0.4327 - val_loss: 3.2676 - val_accuracy50: 0.3741 - 111s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 111s - loss: 3.1897 - accuracy50: 0.4329 - val_loss: 3.2678 - val_accuracy50: 0.3750 - 111s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 109s - loss: 3.1890 - accuracy50: 0.4334 - val_loss: 3.2667 - val_accuracy50: 0.3751 - 109s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 110s - loss: 3.1877 - accuracy50: 0.4342 - val_loss: 3.2671 - val_accuracy50: 0.3751 - 110s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 110s - loss: 3.1868 - accuracy50: 0.4343 - val_loss: 3.2672 - val_accuracy50: 0.3748 - 110s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 111s - loss: 3.1858 - accuracy50: 0.4346 - val_loss: 3.2671 - val_accuracy50: 0.3747 - 111s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 111s - loss: 3.1847 - accuracy50: 0.4354 - val_loss: 3.2674 - val_accuracy50: 0.3751 - 111s/epoch - 23ms/step
Epoch 23/50
4812/4812 - 109s - loss: 3.1842 - accuracy50: 0.4357 - val_loss: 3.2667 - val_accuracy50: 0.3755 - 109s/epoch - 23ms/step
Epoch 24/50
4812/4812 - 110s - loss: 3.1825 - accuracy50: 0.4366 - val_loss: 3.2657 - val_accuracy50: 0.3760 - 110s/epoch - 23ms/step
Epoch 25/50
4812/4812 - 110s - loss: 3.1817 - accuracy50: 0.4364 - val_loss: 3.2661 - val_accuracy50: 0.3769 - 110s/epoch - 23ms/step
Epoch 26/50
4812/4812 - 109s - loss: 3.1804 - accuracy50: 0.4370 - val_loss: 3.2664 - val_accuracy50: 0.3765 - 109s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 108s - loss: 3.1790 - accuracy50: 0.4378 - val_loss: 3.2667 - val_accuracy50: 0.3756 - 108s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 111s - loss: 3.1788 - accuracy50: 0.4375 - val_loss: 3.2684 - val_accuracy50: 0.3756 - 111s/epoch - 23ms/step
Epoch 29/50
4812/4812 - 111s - loss: 3.1773 - accuracy50: 0.4386 - val_loss: 3.2677 - val_accuracy50: 0.3765 - 111s/epoch - 23ms/step
Epoch 30/50
4812/4812 - 110s - loss: 3.1757 - accuracy50: 0.4392 - val_loss: 3.2678 - val_accuracy50: 0.3763 - 110s/epoch - 23ms/step
Epoch 31/50
4812/4812 - 110s - loss: 3.1743 - accuracy50: 0.4400 - val_loss: 3.2663 - val_accuracy50: 0.3769 - 110s/epoch - 23ms/step
Epoch 32/50
4812/4812 - 110s - loss: 3.1735 - accuracy50: 0.4401 - val_loss: 3.2697 - val_accuracy50: 0.3762 - 110s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 109s - loss: 3.1722 - accuracy50: 0.4409 - val_loss: 3.2665 - val_accuracy50: 0.3780 - 109s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 106s - loss: 3.1714 - accuracy50: 0.4415 - val_loss: 3.2689 - val_accuracy50: 0.3770 - 106s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L1/h50
Evaluating performance on  test set...
19053/19053 - 248s - 248s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0959483
{'0': {'precision': 0.28984866658358777, 'recall': 0.6565774186804142, 'f1-score': 0.4021615470590635, 'support': 1133583}, '1': {'precision': 0.5887251677410867, 'recall': 0.05104301168483344, 'f1-score': 0.0939412324105544, 'support': 2630076}, '2': {'precision': 0.3033879137730258, 'recall': 0.5670069770970572, 'f1-score': 0.3952759044903506, 'support': 1113787}, 'accuracy': 0.30959994226486565, 'macro avg': {'precision': 0.39398724936590007, 'recall': 0.4248758024874349, 'f1-score': 0.29712622798665617, 'support': 4877446}, 'weighted avg': {'precision': 0.4541042524307079, 'recall': 0.30959994226486565, 'f1-score': 0.23438685689351965, 'support': 4877446}}
[[ 744285   45718  343580]
 [1389358  134247 1106471]
 [ 434197   48065  631525]]
Evaluating performance on  train set...
4812/4812 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822364
{'0': {'precision': 0.39352241227437185, 'recall': 0.5842589810404363, 'f1-score': 0.47028713203989936, 'support': 406022}, '1': {'precision': 0.3690120190925298, 'recall': 0.06314875274632, 'f1-score': 0.10784249877628364, 'support': 406453}, '2': {'precision': 0.40796505413820344, 'recall': 0.5442497710972074, 'f1-score': 0.4663546112621899, 'support': 419392}, 'accuracy': 0.39869807373685634, 'macro avg': {'precision': 0.3901664951683683, 'recall': 0.3972191682946546, 'f1-score': 0.34816141402612427, 'support': 1231867}, 'weighted avg': {'precision': 0.3903522694071766, 'recall': 0.39869807373685634, 'f1-score': 0.34936013563695856, 'support': 1231867}}
[[237222  21018 147782]
 [197328  25667 183458]
 [168267  22871 228254]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876861
{'0': {'precision': 0.37102363786624537, 'recall': 0.5734580098800283, 'f1-score': 0.4505465564035674, 'support': 141700}, '1': {'precision': 0.417462219301975, 'recall': 0.06454446582447922, 'f1-score': 0.11180291385244419, 'support': 167342}, '2': {'precision': 0.3764385965758147, 'recall': 0.5450293540708268, 'f1-score': 0.4453113860228485, 'support': 143251}, 'accuracy': 0.376163239316107, 'macro avg': {'precision': 0.3883081512480117, 'recall': 0.3943439432584448, 'f1-score': 0.33588695209295333, 'support': 452293}, 'weighted avg': {'precision': 0.38992028969309744, 'recall': 0.376163239316107, 'f1-score': 0.3235581174403324, 'support': 452293}}
[[81259  7363 53078]
 [80288 10801 76253]
 [57466  7709 78076]]
training model: results/AAPL/W0/deepOF_L1/h100
Epoch 1/50
4812/4812 - 112s - loss: 3.2624 - accuracy100: 0.3903 - val_loss: 3.3354 - val_accuracy100: 0.3650 - 112s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 110s - loss: 3.2555 - accuracy100: 0.3954 - val_loss: 3.3212 - val_accuracy100: 0.3691 - 110s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 107s - loss: 3.2552 - accuracy100: 0.3963 - val_loss: 3.3185 - val_accuracy100: 0.3703 - 107s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 109s - loss: 3.2542 - accuracy100: 0.3970 - val_loss: 3.3151 - val_accuracy100: 0.3720 - 109s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 110s - loss: 3.2523 - accuracy100: 0.3983 - val_loss: 3.3157 - val_accuracy100: 0.3726 - 110s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 109s - loss: 3.2504 - accuracy100: 0.3997 - val_loss: 3.3157 - val_accuracy100: 0.3725 - 109s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 111s - loss: 3.2489 - accuracy100: 0.4003 - val_loss: 3.3150 - val_accuracy100: 0.3723 - 111s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 107s - loss: 3.2469 - accuracy100: 0.4018 - val_loss: 3.3143 - val_accuracy100: 0.3727 - 107s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 105s - loss: 3.2458 - accuracy100: 0.4029 - val_loss: 3.3126 - val_accuracy100: 0.3736 - 105s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.2439 - accuracy100: 0.4040 - val_loss: 3.3145 - val_accuracy100: 0.3733 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.2423 - accuracy100: 0.4051 - val_loss: 3.3148 - val_accuracy100: 0.3721 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 108s - loss: 3.2410 - accuracy100: 0.4060 - val_loss: 3.3124 - val_accuracy100: 0.3728 - 108s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 107s - loss: 3.2395 - accuracy100: 0.4070 - val_loss: 3.3125 - val_accuracy100: 0.3718 - 107s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 109s - loss: 3.2381 - accuracy100: 0.4084 - val_loss: 3.3152 - val_accuracy100: 0.3723 - 109s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 105s - loss: 3.2369 - accuracy100: 0.4090 - val_loss: 3.3147 - val_accuracy100: 0.3712 - 105s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 108s - loss: 3.2356 - accuracy100: 0.4096 - val_loss: 3.3137 - val_accuracy100: 0.3715 - 108s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 107s - loss: 3.2340 - accuracy100: 0.4108 - val_loss: 3.3112 - val_accuracy100: 0.3719 - 107s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 107s - loss: 3.2330 - accuracy100: 0.4113 - val_loss: 3.3144 - val_accuracy100: 0.3711 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.2318 - accuracy100: 0.4120 - val_loss: 3.3158 - val_accuracy100: 0.3712 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 105s - loss: 3.2307 - accuracy100: 0.4128 - val_loss: 3.3159 - val_accuracy100: 0.3704 - 105s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 107s - loss: 3.2296 - accuracy100: 0.4132 - val_loss: 3.3148 - val_accuracy100: 0.3706 - 107s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 107s - loss: 3.2288 - accuracy100: 0.4134 - val_loss: 3.3122 - val_accuracy100: 0.3704 - 107s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 104s - loss: 3.2274 - accuracy100: 0.4143 - val_loss: 3.3111 - val_accuracy100: 0.3693 - 104s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 103s - loss: 3.2263 - accuracy100: 0.4152 - val_loss: 3.3114 - val_accuracy100: 0.3696 - 103s/epoch - 21ms/step
Epoch 25/50
4812/4812 - 104s - loss: 3.2250 - accuracy100: 0.4159 - val_loss: 3.3125 - val_accuracy100: 0.3696 - 104s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 104s - loss: 3.2234 - accuracy100: 0.4168 - val_loss: 3.3154 - val_accuracy100: 0.3690 - 104s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 105s - loss: 3.2230 - accuracy100: 0.4167 - val_loss: 3.3112 - val_accuracy100: 0.3693 - 105s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 104s - loss: 3.2223 - accuracy100: 0.4172 - val_loss: 3.3127 - val_accuracy100: 0.3692 - 104s/epoch - 22ms/step
Epoch 29/50
4812/4812 - 104s - loss: 3.2208 - accuracy100: 0.4184 - val_loss: 3.3146 - val_accuracy100: 0.3682 - 104s/epoch - 22ms/step
Epoch 30/50
4812/4812 - 104s - loss: 3.2195 - accuracy100: 0.4190 - val_loss: 3.3135 - val_accuracy100: 0.3695 - 104s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 102s - loss: 3.2182 - accuracy100: 0.4202 - val_loss: 3.3217 - val_accuracy100: 0.3657 - 102s/epoch - 21ms/step
Epoch 32/50
4812/4812 - 105s - loss: 3.2176 - accuracy100: 0.4205 - val_loss: 3.3169 - val_accuracy100: 0.3672 - 105s/epoch - 22ms/step
Epoch 33/50
4812/4812 - 103s - loss: 3.2158 - accuracy100: 0.4210 - val_loss: 3.3145 - val_accuracy100: 0.3682 - 103s/epoch - 21ms/step
testing model: results/AAPL/W0/deepOF_L1/h100
Evaluating performance on  test set...
19053/19053 - 259s - 259s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1189783
{'0': {'precision': 0.3297609450837564, 'recall': 0.6250184828146065, 'f1-score': 0.4317367541976417, 'support': 1379660}, '1': {'precision': 0.4915078886110872, 'recall': 0.0026521941195818085, 'f1-score': 0.00527591919079745, 'support': 2149541}, '2': {'precision': 0.33521466908764247, 'recall': 0.5596378996399023, 'f1-score': 0.4192843377618134, 'support': 1348245}, 'accuracy': 0.33266242209549834, 'macro avg': {'precision': 0.3854945009274953, 'recall': 0.39576952552469685, 'f1-score': 0.2854323370500842, 'support': 4877446}, 'weighted avg': {'precision': 0.4025520416651028, 'recall': 0.33266242209549834, 'f1-score': 0.24034889302214735, 'support': 4877446}}
[[ 862313    2979  514368]
 [1161854    5701  981986]
 [ 590797    2919  754529]]
Evaluating performance on  train set...
4812/4812 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0952657
{'0': {'precision': 0.37997859132169165, 'recall': 0.5851151376214199, 'f1-score': 0.4607453537137022, 'support': 408294}, '1': {'precision': 0.3452029938761624, 'recall': 0.003750385018172858, 'f1-score': 0.007420155325984681, 'support': 405825}, '2': {'precision': 0.3902254898194712, 'recall': 0.5592941199000354, 'f1-score': 0.45970787681912934, 'support': 417748}, 'accuracy': 0.38483456412096434, 'macro avg': {'precision': 0.3718023583391084, 'recall': 0.3827198808465427, 'f1-score': 0.3092911286196054, 'support': 1231867}, 'weighted avg': {'precision': 0.37199705964685864, 'recall': 0.38483456412096434, 'f1-score': 0.31105053882422995, 'support': 1231867}}
[[238899   1433 167962]
 [207168   1522 197135]
 [182650   1454 233644]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026492
{'0': {'precision': 0.3687716458692285, 'recall': 0.5758730805816008, 'f1-score': 0.44962017527107606, 'support': 147180}, '1': {'precision': 0.37640449438202245, 'recall': 0.0034079565612700996, 'f1-score': 0.006754755738706894, 'support': 157279}, '2': {'precision': 0.37028407522858575, 'recall': 0.5536277175751181, 'f1-score': 0.4437642836035753, 'support': 147834}, 'accuracy': 0.36953479271180406, 'macro avg': {'precision': 0.37182007182661225, 'recall': 0.377636251572663, 'f1-score': 0.3000464048711194, 'support': 452293}, 'weighted avg': {'precision': 0.37192021386200075, 'recall': 0.36953479271180406, 'f1-score': 0.29370546907972483, 'support': 452293}}
[[84757   424 61999]
 [79554   536 77189]
 [65525   464 81845]]
training model: results/AAPL/W0/deepOF_L1/h200
Epoch 1/50
4812/4812 - 109s - loss: 3.2581 - accuracy200: 0.3917 - val_loss: 3.3418 - val_accuracy200: 0.3519 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 103s - loss: 3.2572 - accuracy200: 0.3927 - val_loss: 3.3341 - val_accuracy200: 0.3544 - 103s/epoch - 21ms/step
Epoch 3/50
4812/4812 - 102s - loss: 3.2593 - accuracy200: 0.3915 - val_loss: 3.3296 - val_accuracy200: 0.3559 - 102s/epoch - 21ms/step
Epoch 4/50
4812/4812 - 105s - loss: 3.2592 - accuracy200: 0.3917 - val_loss: 3.3270 - val_accuracy200: 0.3563 - 105s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 103s - loss: 3.2572 - accuracy200: 0.3930 - val_loss: 3.3263 - val_accuracy200: 0.3575 - 103s/epoch - 21ms/step
Epoch 6/50
4812/4812 - 105s - loss: 3.2555 - accuracy200: 0.3947 - val_loss: 3.3268 - val_accuracy200: 0.3572 - 105s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 105s - loss: 3.2531 - accuracy200: 0.3963 - val_loss: 3.3256 - val_accuracy200: 0.3576 - 105s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 103s - loss: 3.2501 - accuracy200: 0.3980 - val_loss: 3.3244 - val_accuracy200: 0.3582 - 103s/epoch - 21ms/step
Epoch 9/50
4812/4812 - 103s - loss: 3.2467 - accuracy200: 0.4004 - val_loss: 3.3227 - val_accuracy200: 0.3588 - 103s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 105s - loss: 3.2437 - accuracy200: 0.4025 - val_loss: 3.3209 - val_accuracy200: 0.3598 - 105s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 105s - loss: 3.2414 - accuracy200: 0.4034 - val_loss: 3.3187 - val_accuracy200: 0.3591 - 105s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 103s - loss: 3.2391 - accuracy200: 0.4048 - val_loss: 3.3169 - val_accuracy200: 0.3591 - 103s/epoch - 21ms/step
Epoch 13/50
4812/4812 - 105s - loss: 3.2371 - accuracy200: 0.4062 - val_loss: 3.3139 - val_accuracy200: 0.3591 - 105s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 104s - loss: 3.2351 - accuracy200: 0.4070 - val_loss: 3.3133 - val_accuracy200: 0.3590 - 104s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 101s - loss: 3.2339 - accuracy200: 0.4076 - val_loss: 3.3114 - val_accuracy200: 0.3589 - 101s/epoch - 21ms/step
Epoch 16/50
4812/4812 - 104s - loss: 3.2324 - accuracy200: 0.4084 - val_loss: 3.3092 - val_accuracy200: 0.3590 - 104s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 102s - loss: 3.2308 - accuracy200: 0.4091 - val_loss: 3.3092 - val_accuracy200: 0.3585 - 102s/epoch - 21ms/step
Epoch 18/50
4812/4812 - 102s - loss: 3.2299 - accuracy200: 0.4097 - val_loss: 3.3091 - val_accuracy200: 0.3573 - 102s/epoch - 21ms/step
Epoch 19/50
4812/4812 - 105s - loss: 3.2288 - accuracy200: 0.4106 - val_loss: 3.3064 - val_accuracy200: 0.3582 - 105s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 104s - loss: 3.2283 - accuracy200: 0.4108 - val_loss: 3.3072 - val_accuracy200: 0.3579 - 104s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 106s - loss: 3.2272 - accuracy200: 0.4113 - val_loss: 3.3071 - val_accuracy200: 0.3577 - 106s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 103s - loss: 3.2264 - accuracy200: 0.4113 - val_loss: 3.3065 - val_accuracy200: 0.3575 - 103s/epoch - 21ms/step
Epoch 23/50
4812/4812 - 103s - loss: 3.2256 - accuracy200: 0.4123 - val_loss: 3.3056 - val_accuracy200: 0.3567 - 103s/epoch - 21ms/step
Epoch 24/50
4812/4812 - 107s - loss: 3.2247 - accuracy200: 0.4127 - val_loss: 3.3071 - val_accuracy200: 0.3577 - 107s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 104s - loss: 3.2249 - accuracy200: 0.4126 - val_loss: 3.3070 - val_accuracy200: 0.3572 - 104s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 104s - loss: 3.2243 - accuracy200: 0.4131 - val_loss: 3.3066 - val_accuracy200: 0.3581 - 104s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 104s - loss: 3.2231 - accuracy200: 0.4139 - val_loss: 3.3076 - val_accuracy200: 0.3563 - 104s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 102s - loss: 3.2223 - accuracy200: 0.4142 - val_loss: 3.3082 - val_accuracy200: 0.3570 - 102s/epoch - 21ms/step
Epoch 29/50
4812/4812 - 104s - loss: 3.2214 - accuracy200: 0.4146 - val_loss: 3.3088 - val_accuracy200: 0.3574 - 104s/epoch - 22ms/step
Epoch 30/50
4812/4812 - 105s - loss: 3.2206 - accuracy200: 0.4151 - val_loss: 3.3099 - val_accuracy200: 0.3569 - 105s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 107s - loss: 3.2199 - accuracy200: 0.4157 - val_loss: 3.3093 - val_accuracy200: 0.3561 - 107s/epoch - 22ms/step
Epoch 32/50
4812/4812 - 106s - loss: 3.2191 - accuracy200: 0.4161 - val_loss: 3.3106 - val_accuracy200: 0.3567 - 106s/epoch - 22ms/step
Epoch 33/50
4812/4812 - 109s - loss: 3.2185 - accuracy200: 0.4172 - val_loss: 3.3137 - val_accuracy200: 0.3568 - 109s/epoch - 23ms/step
testing model: results/AAPL/W0/deepOF_L1/h200
Evaluating performance on  test set...
19053/19053 - 268s - 268s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217697
{'0': {'precision': 0.2815536982813223, 'recall': 0.6372972581579456, 'f1-score': 0.3905604030369771, 'support': 1242960}, '1': {'precision': 0.5262026523359625, 'recall': 0.012535774906148947, 'f1-score': 0.02448816594899307, 'support': 2421390}, '2': {'precision': 0.2946331066993833, 'recall': 0.4872887224094383, 'f1-score': 0.3672269651473948, 'support': 1213096}, 'accuracy': 0.2898272989593324, 'macro avg': {'precision': 0.3674631524388894, 'recall': 0.3790405851578443, 'f1-score': 0.2607585113777883, 'support': 4877446}, 'weighted avg': {'precision': 0.4062618157864021, 'recall': 0.2898272989593324, 'f1-score': 0.20302181125501287, 'support': 4877446}}
[[ 792135   13726  437099]
 [1412944   30354  978092]
 [ 608363   13605  591128]]
Evaluating performance on  train set...
4812/4812 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972747
{'0': {'precision': 0.3651293455924731, 'recall': 0.5931602270610496, 'f1-score': 0.45201411289192883, 'support': 407996}, '1': {'precision': 0.34599455040871935, 'recall': 0.015583083187500154, 'f1-score': 0.029822983284755706, 'support': 407429}, '2': {'precision': 0.3781075285218051, 'recall': 0.5000240129477814, 'f1-score': 0.43060255738186304, 'support': 416442}, 'accuracy': 0.3706463441264357, 'macro avg': {'precision': 0.3630771415076659, 'recall': 0.36958910773211046, 'f1-score': 0.3041465511861825, 'support': 1231867}, 'weighted avg': {'precision': 0.36318805646672764, 'recall': 0.3706463441264357, 'f1-score': 0.30513983121668, 'support': 1231867}}
[[242007   5859 160130]
 [218722   6349 182358]
 [202069   6142 208231]]
Evaluating performance on  val set...
1767/1767 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101499
{'0': {'precision': 0.35528380744705457, 'recall': 0.5841447681129898, 'f1-score': 0.4418370543853972, 'support': 147270}, '1': {'precision': 0.37324426173347036, 'recall': 0.01374260522963206, 'f1-score': 0.026509160806832285, 'support': 158558}, '2': {'precision': 0.3589729785286733, 'recall': 0.5007681015942376, 'f1-score': 0.4181775679620508, 'support': 146465}, 'accuracy': 0.3571821805776344, 'macro avg': {'precision': 0.3625003492363994, 'recall': 0.36621849164561987, 'f1-score': 0.2955079277180934, 'support': 452293}, 'weighted avg': {'precision': 0.3627747660805395, 'recall': 0.3571821805776344, 'f1-score': 0.2885761221378817, 'support': 452293}}
[[86027  1791 59452]
 [84857  2179 71522]
 [71252  1868 73345]]
training model: results/AAPL/W0/deepOF_L1/h300
Epoch 1/50
4812/4812 - 110s - loss: 3.2760 - accuracy300: 0.3794 - val_loss: 3.3528 - val_accuracy300: 0.3507 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 106s - loss: 3.2740 - accuracy300: 0.3780 - val_loss: 3.3390 - val_accuracy300: 0.3543 - 106s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 104s - loss: 3.2746 - accuracy300: 0.3770 - val_loss: 3.3361 - val_accuracy300: 0.3544 - 104s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 107s - loss: 3.2726 - accuracy300: 0.3791 - val_loss: 3.3365 - val_accuracy300: 0.3552 - 107s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 108s - loss: 3.2699 - accuracy300: 0.3816 - val_loss: 3.3353 - val_accuracy300: 0.3559 - 108s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 110s - loss: 3.2667 - accuracy300: 0.3846 - val_loss: 3.3335 - val_accuracy300: 0.3560 - 110s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 110s - loss: 3.2641 - accuracy300: 0.3871 - val_loss: 3.3315 - val_accuracy300: 0.3559 - 110s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 104s - loss: 3.2615 - accuracy300: 0.3896 - val_loss: 3.3278 - val_accuracy300: 0.3562 - 104s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 105s - loss: 3.2596 - accuracy300: 0.3911 - val_loss: 3.3255 - val_accuracy300: 0.3562 - 105s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 109s - loss: 3.2576 - accuracy300: 0.3928 - val_loss: 3.3250 - val_accuracy300: 0.3566 - 109s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 109s - loss: 3.2557 - accuracy300: 0.3937 - val_loss: 3.3230 - val_accuracy300: 0.3561 - 109s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 108s - loss: 3.2539 - accuracy300: 0.3950 - val_loss: 3.3217 - val_accuracy300: 0.3560 - 108s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 110s - loss: 3.2526 - accuracy300: 0.3957 - val_loss: 3.3196 - val_accuracy300: 0.3558 - 110s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 110s - loss: 3.2516 - accuracy300: 0.3966 - val_loss: 3.3188 - val_accuracy300: 0.3553 - 110s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 109s - loss: 3.2503 - accuracy300: 0.3969 - val_loss: 3.3187 - val_accuracy300: 0.3560 - 109s/epoch - 23ms/step
Epoch 16/50
4812/4812 - 109s - loss: 3.2485 - accuracy300: 0.3987 - val_loss: 3.3175 - val_accuracy300: 0.3558 - 109s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 107s - loss: 3.2478 - accuracy300: 0.3993 - val_loss: 3.3181 - val_accuracy300: 0.3548 - 107s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 107s - loss: 3.2475 - accuracy300: 0.3988 - val_loss: 3.3185 - val_accuracy300: 0.3550 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 104s - loss: 3.2468 - accuracy300: 0.3999 - val_loss: 3.3174 - val_accuracy300: 0.3539 - 104s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 104s - loss: 3.2459 - accuracy300: 0.4003 - val_loss: 3.3181 - val_accuracy300: 0.3543 - 104s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 108s - loss: 3.2449 - accuracy300: 0.4009 - val_loss: 3.3199 - val_accuracy300: 0.3533 - 108s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 110s - loss: 3.2444 - accuracy300: 0.4015 - val_loss: 3.3186 - val_accuracy300: 0.3545 - 110s/epoch - 23ms/step
Epoch 23/50
4812/4812 - 120s - loss: 3.2436 - accuracy300: 0.4019 - val_loss: 3.3174 - val_accuracy300: 0.3527 - 120s/epoch - 25ms/step
Epoch 24/50
4812/4812 - 172s - loss: 3.2428 - accuracy300: 0.4025 - val_loss: 3.3163 - val_accuracy300: 0.3527 - 172s/epoch - 36ms/step
Epoch 25/50
4812/4812 - 172s - loss: 3.2422 - accuracy300: 0.4034 - val_loss: 3.3196 - val_accuracy300: 0.3512 - 172s/epoch - 36ms/step
Epoch 26/50
4812/4812 - 174s - loss: 3.2417 - accuracy300: 0.4036 - val_loss: 3.3205 - val_accuracy300: 0.3535 - 174s/epoch - 36ms/step
Epoch 27/50
4812/4812 - 176s - loss: 3.2412 - accuracy300: 0.4040 - val_loss: 3.3204 - val_accuracy300: 0.3538 - 176s/epoch - 37ms/step
Epoch 28/50
4812/4812 - 177s - loss: 3.2401 - accuracy300: 0.4048 - val_loss: 3.3195 - val_accuracy300: 0.3526 - 177s/epoch - 37ms/step
Epoch 29/50
4812/4812 - 179s - loss: 3.2392 - accuracy300: 0.4048 - val_loss: 3.3201 - val_accuracy300: 0.3508 - 179s/epoch - 37ms/step
Epoch 30/50
4812/4812 - 173s - loss: 3.2387 - accuracy300: 0.4053 - val_loss: 3.3220 - val_accuracy300: 0.3517 - 173s/epoch - 36ms/step
Epoch 31/50
4812/4812 - 178s - loss: 3.2379 - accuracy300: 0.4062 - val_loss: 3.3202 - val_accuracy300: 0.3491 - 178s/epoch - 37ms/step
Epoch 32/50
4812/4812 - 180s - loss: 3.2375 - accuracy300: 0.4063 - val_loss: 3.3194 - val_accuracy300: 0.3504 - 180s/epoch - 37ms/step
Epoch 33/50
4812/4812 - 177s - loss: 3.2358 - accuracy300: 0.4078 - val_loss: 3.3228 - val_accuracy300: 0.3485 - 177s/epoch - 37ms/step
Epoch 34/50
4812/4812 - 181s - loss: 3.2361 - accuracy300: 0.4071 - val_loss: 3.3232 - val_accuracy300: 0.3488 - 181s/epoch - 38ms/step
testing model: results/AAPL/W0/deepOF_L1/h300
Evaluating performance on  test set...
19053/19053 - 323s - 323s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1226063
{'0': {'precision': 0.3051481967926249, 'recall': 0.5388065058856374, 'f1-score': 0.38963189178132157, 'support': 1353974}, '1': {'precision': 0.4958673335088181, 'recall': 0.004278671962728901, 'f1-score': 0.008484137167573643, 'support': 2201384}, '2': {'precision': 0.29988317108445844, 'recall': 0.5597395937335488, 'f1-score': 0.3905352236358709, 'support': 1322088}, 'accuracy': 0.3032271397776623, 'macro avg': {'precision': 0.3669662337953005, 'recall': 0.36760825719397167, 'f1-score': 0.2628837508615887, 'support': 4877446}, 'weighted avg': {'precision': 0.38980012912614165, 'recall': 0.3032271397776623, 'f1-score': 0.21784971634817205, 'support': 4877446}}
[[ 729530    4619  619825]
 [1084104    9419 1107861]
 [ 577106    4957  740025]]
Evaluating performance on  train set...
4812/4812 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000377
{'0': {'precision': 0.361793784708301, 'recall': 0.5208758062693738, 'f1-score': 0.426999255983094, 'support': 407122}, '1': {'precision': 0.34748904617458715, 'recall': 0.0050719842970185485, 'f1-score': 0.009998036273185917, 'support': 406547}, '2': {'precision': 0.3668329691558898, 'recall': 0.5612150225491275, 'f1-score': 0.44366708380750025, 'support': 418198}, 'accuracy': 0.3643420921252051, 'macro avg': {'precision': 0.3587052666795927, 'recall': 0.3623876043718399, 'f1-score': 0.29355479202126006, 'support': 1231867}, 'weighted avg': {'precision': 0.3587835801334135, 'recall': 0.3643420921252051, 'f1-score': 0.29503684233868843, 'support': 1231867}}
[[212060   1805 193257]
 [192643   2062 211842]
 [181432   2067 234699]]
Evaluating performance on  val set...
1767/1767 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042814
{'0': {'precision': 0.3568928988025805, 'recall': 0.5001467880114228, 'f1-score': 0.41654742422432206, 'support': 149876}, '1': {'precision': 0.3560948081264108, 'recall': 0.004081104679364874, 'f1-score': 0.00806972446558857, 'support': 154615}, '2': {'precision': 0.34952138586029957, 'recall': 0.5687000175911016, 'f1-score': 0.4329518295698039, 'support': 147802}, 'accuracy': 0.35297030906956334, 'macro avg': {'precision': 0.3541696975964303, 'recall': 0.35764263676062974, 'f1-score': 0.28585632608657147, 'support': 452293}, 'weighted avg': {'precision': 0.3542111833088829, 'recall': 0.35297030906956334, 'f1-score': 0.282271245664575, 'support': 452293}}
[[74960   534 74382]
 [71935   631 82049]
 [63140   607 84055]]
training model: results/AAPL/W0/deepOF_L1/h500
Epoch 1/50
4812/4812 - 196s - loss: 3.2786 - accuracy500: 0.3770 - val_loss: 3.4021 - val_accuracy500: 0.3422 - 196s/epoch - 41ms/step
Epoch 2/50
4812/4812 - 192s - loss: 3.2772 - accuracy500: 0.3732 - val_loss: 3.3766 - val_accuracy500: 0.3461 - 192s/epoch - 40ms/step
Epoch 3/50
4812/4812 - 188s - loss: 3.2769 - accuracy500: 0.3733 - val_loss: 3.3732 - val_accuracy500: 0.3461 - 188s/epoch - 39ms/step
Epoch 4/50
4812/4812 - 190s - loss: 3.2757 - accuracy500: 0.3743 - val_loss: 3.3741 - val_accuracy500: 0.3461 - 190s/epoch - 39ms/step
Epoch 5/50
4812/4812 - 190s - loss: 3.2745 - accuracy500: 0.3760 - val_loss: 3.3721 - val_accuracy500: 0.3466 - 190s/epoch - 39ms/step
Epoch 6/50
4812/4812 - 195s - loss: 3.2730 - accuracy500: 0.3776 - val_loss: 3.3746 - val_accuracy500: 0.3467 - 195s/epoch - 40ms/step
Epoch 7/50
4812/4812 - 208s - loss: 3.2714 - accuracy500: 0.3790 - val_loss: 3.3725 - val_accuracy500: 0.3464 - 208s/epoch - 43ms/step
Epoch 8/50
4812/4812 - 213s - loss: 3.2697 - accuracy500: 0.3803 - val_loss: 3.3753 - val_accuracy500: 0.3469 - 213s/epoch - 44ms/step
Epoch 9/50
4812/4812 - 208s - loss: 3.2684 - accuracy500: 0.3817 - val_loss: 3.3725 - val_accuracy500: 0.3472 - 208s/epoch - 43ms/step
Epoch 10/50
4812/4812 - 214s - loss: 3.2672 - accuracy500: 0.3828 - val_loss: 3.3743 - val_accuracy500: 0.3468 - 214s/epoch - 44ms/step
Epoch 11/50
4812/4812 - 217s - loss: 3.2659 - accuracy500: 0.3841 - val_loss: 3.3728 - val_accuracy500: 0.3472 - 217s/epoch - 45ms/step
Epoch 12/50
4812/4812 - 216s - loss: 3.2648 - accuracy500: 0.3849 - val_loss: 3.3724 - val_accuracy500: 0.3475 - 216s/epoch - 45ms/step
Epoch 13/50
4812/4812 - 216s - loss: 3.2639 - accuracy500: 0.3855 - val_loss: 3.3715 - val_accuracy500: 0.3472 - 216s/epoch - 45ms/step
Epoch 14/50
4812/4812 - 219s - loss: 3.2626 - accuracy500: 0.3865 - val_loss: 3.3708 - val_accuracy500: 0.3476 - 219s/epoch - 45ms/step
Epoch 15/50
4812/4812 - 215s - loss: 3.2618 - accuracy500: 0.3873 - val_loss: 3.3714 - val_accuracy500: 0.3473 - 215s/epoch - 45ms/step
Epoch 16/50
4812/4812 - 224s - loss: 3.2605 - accuracy500: 0.3882 - val_loss: 3.3719 - val_accuracy500: 0.3474 - 224s/epoch - 47ms/step
Epoch 17/50
4812/4812 - 223s - loss: 3.2596 - accuracy500: 0.3884 - val_loss: 3.3714 - val_accuracy500: 0.3474 - 223s/epoch - 46ms/step
Epoch 18/50
4812/4812 - 226s - loss: 3.2585 - accuracy500: 0.3895 - val_loss: 3.3715 - val_accuracy500: 0.3473 - 226s/epoch - 47ms/step
Epoch 19/50
4812/4812 - 225s - loss: 3.2574 - accuracy500: 0.3902 - val_loss: 3.3689 - val_accuracy500: 0.3481 - 225s/epoch - 47ms/step
Epoch 20/50
4812/4812 - 219s - loss: 3.2564 - accuracy500: 0.3910 - val_loss: 3.3713 - val_accuracy500: 0.3479 - 219s/epoch - 45ms/step
Epoch 21/50
4812/4812 - 221s - loss: 3.2553 - accuracy500: 0.3922 - val_loss: 3.3700 - val_accuracy500: 0.3481 - 221s/epoch - 46ms/step
Epoch 22/50
4812/4812 - 226s - loss: 3.2544 - accuracy500: 0.3925 - val_loss: 3.3728 - val_accuracy500: 0.3482 - 226s/epoch - 47ms/step
Epoch 23/50
4812/4812 - 223s - loss: 3.2539 - accuracy500: 0.3928 - val_loss: 3.3703 - val_accuracy500: 0.3483 - 223s/epoch - 46ms/step
Epoch 24/50
4812/4812 - 229s - loss: 3.2529 - accuracy500: 0.3934 - val_loss: 3.3683 - val_accuracy500: 0.3487 - 229s/epoch - 48ms/step
Epoch 25/50
4812/4812 - 225s - loss: 3.2524 - accuracy500: 0.3940 - val_loss: 3.3672 - val_accuracy500: 0.3488 - 225s/epoch - 47ms/step
Epoch 26/50
4812/4812 - 219s - loss: 3.2516 - accuracy500: 0.3948 - val_loss: 3.3633 - val_accuracy500: 0.3492 - 219s/epoch - 45ms/step
Epoch 27/50
4812/4812 - 220s - loss: 3.2509 - accuracy500: 0.3950 - val_loss: 3.3614 - val_accuracy500: 0.3491 - 220s/epoch - 46ms/step
Epoch 28/50
4812/4812 - 224s - loss: 3.2501 - accuracy500: 0.3959 - val_loss: 3.3540 - val_accuracy500: 0.3487 - 224s/epoch - 47ms/step
Epoch 29/50
4812/4812 - 214s - loss: 3.2495 - accuracy500: 0.3958 - val_loss: 3.3546 - val_accuracy500: 0.3489 - 214s/epoch - 45ms/step
Epoch 30/50
4812/4812 - 221s - loss: 3.2489 - accuracy500: 0.3964 - val_loss: 3.3572 - val_accuracy500: 0.3483 - 221s/epoch - 46ms/step
Epoch 31/50
4812/4812 - 221s - loss: 3.2485 - accuracy500: 0.3967 - val_loss: 3.3576 - val_accuracy500: 0.3479 - 221s/epoch - 46ms/step
Epoch 32/50
4812/4812 - 221s - loss: 3.2479 - accuracy500: 0.3971 - val_loss: 3.3525 - val_accuracy500: 0.3483 - 221s/epoch - 46ms/step
Epoch 33/50
4812/4812 - 229s - loss: 3.2471 - accuracy500: 0.3979 - val_loss: 3.3493 - val_accuracy500: 0.3482 - 229s/epoch - 48ms/step
Epoch 34/50
4812/4812 - 223s - loss: 3.2467 - accuracy500: 0.3977 - val_loss: 3.3527 - val_accuracy500: 0.3477 - 223s/epoch - 46ms/step
Epoch 35/50
4812/4812 - 234s - loss: 3.2460 - accuracy500: 0.3984 - val_loss: 3.3534 - val_accuracy500: 0.3473 - 234s/epoch - 49ms/step
Epoch 36/50
4812/4812 - 237s - loss: 3.2457 - accuracy500: 0.3987 - val_loss: 3.3468 - val_accuracy500: 0.3477 - 237s/epoch - 49ms/step
Epoch 37/50
4812/4812 - 232s - loss: 3.2458 - accuracy500: 0.3984 - val_loss: 3.3487 - val_accuracy500: 0.3476 - 232s/epoch - 48ms/step
Epoch 38/50
4812/4812 - 233s - loss: 3.2450 - accuracy500: 0.3987 - val_loss: 3.3445 - val_accuracy500: 0.3465 - 233s/epoch - 48ms/step
Epoch 39/50
4812/4812 - 236s - loss: 3.2457 - accuracy500: 0.3985 - val_loss: 3.3483 - val_accuracy500: 0.3475 - 236s/epoch - 49ms/step
Epoch 40/50
4812/4812 - 237s - loss: 3.2466 - accuracy500: 0.3977 - val_loss: 3.3478 - val_accuracy500: 0.3465 - 237s/epoch - 49ms/step
Epoch 41/50
4812/4812 - 234s - loss: 3.2453 - accuracy500: 0.3992 - val_loss: 3.3549 - val_accuracy500: 0.3476 - 234s/epoch - 49ms/step
Epoch 42/50
4812/4812 - 246s - loss: 3.2456 - accuracy500: 0.3986 - val_loss: 3.3511 - val_accuracy500: 0.3468 - 246s/epoch - 51ms/step
Epoch 43/50
4812/4812 - 241s - loss: 3.2439 - accuracy500: 0.4000 - val_loss: 3.3414 - val_accuracy500: 0.3470 - 241s/epoch - 50ms/step
Epoch 44/50
4812/4812 - 243s - loss: 3.2432 - accuracy500: 0.4002 - val_loss: 3.3419 - val_accuracy500: 0.3460 - 243s/epoch - 51ms/step
Epoch 45/50
4812/4812 - 245s - loss: 3.2440 - accuracy500: 0.3999 - val_loss: 3.3543 - val_accuracy500: 0.3414 - 245s/epoch - 51ms/step
Epoch 46/50
4812/4812 - 247s - loss: 3.2450 - accuracy500: 0.3986 - val_loss: 3.3545 - val_accuracy500: 0.3456 - 247s/epoch - 51ms/step
Epoch 47/50
4812/4812 - 252s - loss: 3.2437 - accuracy500: 0.4000 - val_loss: 3.3416 - val_accuracy500: 0.3457 - 252s/epoch - 52ms/step
Epoch 48/50
4812/4812 - 251s - loss: 3.2443 - accuracy500: 0.3995 - val_loss: 3.3452 - val_accuracy500: 0.3481 - 251s/epoch - 52ms/step
Epoch 49/50
4812/4812 - 248s - loss: 3.2445 - accuracy500: 0.3995 - val_loss: 3.3517 - val_accuracy500: 0.3450 - 248s/epoch - 52ms/step
Epoch 50/50
4812/4812 - 248s - loss: 3.2427 - accuracy500: 0.4003 - val_loss: 3.3365 - val_accuracy500: 0.3429 - 248s/epoch - 52ms/step
testing model: results/AAPL/W0/deepOF_L1/h500
Evaluating performance on  test set...
19053/19053 - 434s - 434s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.139554
{'0': {'precision': 0.288508625017629, 'recall': 0.5913480775794094, 'f1-score': 0.38781092481462875, 'support': 1359536}, '1': {'precision': 0.4910449866027359, 'recall': 0.0015921338892236952, 'f1-score': 0.00317397667282107, 'support': 2187002}, '2': {'precision': 0.28756301133724166, 'recall': 0.4502264619342584, 'f1-score': 0.3509631998500583, 'support': 1330908}, 'accuracy': 0.28839909247585727, 'macro avg': {'precision': 0.3557055409858689, 'recall': 0.3477222244676305, 'f1-score': 0.24731603377916936, 'support': 4877446}, 'weighted avg': {'precision': 0.3790660403221172, 'recall': 0.28839909247585727, 'f1-score': 0.20528861563946285, 'support': 4877446}}
[[ 803959    1761  553816]
 [1252794    3482  930726]
 [ 729850    1848  599210]]
Evaluating performance on  train set...
4812/4812 - 116s - 116s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057085
{'0': {'precision': 0.35018293283127894, 'recall': 0.6220398754876079, 'f1-score': 0.44810252561943, 'support': 406064}, '1': {'precision': 0.36189516129032256, 'recall': 0.0017684685505700724, 'f1-score': 0.003519737245241859, 'support': 406001}, '2': {'precision': 0.3616579495851194, 'recall': 0.4381398849934017, 'f1-score': 0.39624206415031743, 'support': 419802}, 'accuracy': 0.35493929133583413, 'macro avg': {'precision': 0.357912014568907, 'recall': 0.3539827430105265, 'f1-score': 0.28262144233832975, 'support': 1231867}, 'weighted avg': {'precision': 0.3579535861971828, 'recall': 0.35493929133583413, 'f1-score': 0.2839028335192559, 'support': 1231867}}
[[252588    582 152894]
 [233529    718 171754]
 [235186    684 183932]]
Evaluating performance on  val set...
1767/1767 - 42s - 42s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108248
{'0': {'precision': 0.345953232374141, 'recall': 0.5747693984422765, 'f1-score': 0.4319288450301889, 'support': 150476}, '1': {'precision': 0.36541598694942906, 'recall': 0.0014478514918041263, 'f1-score': 0.002884274907452116, 'support': 154712}, '2': {'precision': 0.33913961859994646, 'recall': 0.4649536045681656, 'f1-score': 0.39220374846251105, 'support': 147105}, 'accuracy': 0.34294141187239247, 'macro avg': {'precision': 0.3501696126411722, 'recall': 0.3470569515007487, 'f1-score': 0.27567228946671735, 'support': 452293}, 'weighted avg': {'precision': 0.35039461225753316, 'recall': 0.34294141187239247, 'f1-score': 0.2722489387229564, 'support': 452293}}
[[86489   166 63821]
 [85028   224 69460]
 [78485   223 68397]]
training model: results/AAPL/W0/deepOF_L1/h1000
Epoch 1/50
4812/4812 - 268s - loss: 3.2719 - accuracy1000: 0.3806 - val_loss: 3.4721 - val_accuracy1000: 0.3352 - 268s/epoch - 56ms/step
Epoch 2/50
4812/4812 - 255s - loss: 3.2762 - accuracy1000: 0.3713 - val_loss: 3.4410 - val_accuracy1000: 0.3326 - 255s/epoch - 53ms/step
Epoch 3/50
4812/4812 - 257s - loss: 3.2798 - accuracy1000: 0.3674 - val_loss: 3.4247 - val_accuracy1000: 0.3312 - 257s/epoch - 53ms/step
Epoch 4/50
4812/4812 - 249s - loss: 3.2792 - accuracy1000: 0.3681 - val_loss: 3.4217 - val_accuracy1000: 0.3343 - 249s/epoch - 52ms/step
Epoch 5/50
4812/4812 - 266s - loss: 3.2778 - accuracy1000: 0.3702 - val_loss: 3.4304 - val_accuracy1000: 0.3367 - 266s/epoch - 55ms/step
Epoch 6/50
4812/4812 - 268s - loss: 3.2751 - accuracy1000: 0.3726 - val_loss: 3.4398 - val_accuracy1000: 0.3376 - 268s/epoch - 56ms/step
Epoch 7/50
4812/4812 - 265s - loss: 3.2728 - accuracy1000: 0.3745 - val_loss: 3.4399 - val_accuracy1000: 0.3383 - 265s/epoch - 55ms/step
Epoch 8/50
4812/4812 - 266s - loss: 3.2709 - accuracy1000: 0.3760 - val_loss: 3.4455 - val_accuracy1000: 0.3379 - 266s/epoch - 55ms/step
Epoch 9/50
4812/4812 - 266s - loss: 3.2699 - accuracy1000: 0.3775 - val_loss: 3.4476 - val_accuracy1000: 0.3379 - 266s/epoch - 55ms/step
Epoch 10/50
4812/4812 - 259s - loss: 3.2679 - accuracy1000: 0.3796 - val_loss: 3.4522 - val_accuracy1000: 0.3385 - 259s/epoch - 54ms/step
Epoch 11/50
4812/4812 - 269s - loss: 3.2661 - accuracy1000: 0.3812 - val_loss: 3.4464 - val_accuracy1000: 0.3384 - 269s/epoch - 56ms/step
Epoch 12/50
4812/4812 - 261s - loss: 3.2646 - accuracy1000: 0.3829 - val_loss: 3.4392 - val_accuracy1000: 0.3382 - 261s/epoch - 54ms/step
Epoch 13/50
4812/4812 - 270s - loss: 3.2635 - accuracy1000: 0.3840 - val_loss: 3.4385 - val_accuracy1000: 0.3378 - 270s/epoch - 56ms/step
Epoch 14/50
4812/4812 - 270s - loss: 3.2623 - accuracy1000: 0.3850 - val_loss: 3.4377 - val_accuracy1000: 0.3366 - 270s/epoch - 56ms/step
testing model: results/AAPL/W0/deepOF_L1/h1000
Evaluating performance on  test set...
19053/19053 - 476s - 476s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2165809
{'0': {'precision': 0.27633881850627184, 'recall': 0.3631686396213181, 'f1-score': 0.3138590223335987, 'support': 1276005}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2371114}, '2': {'precision': 0.25957123587838277, 'recall': 0.675233494835113, 'f1-score': 0.37498995673043506, 'support': 1230327}, 'accuracy': 0.2653362025945546, 'macro avg': {'precision': 0.1786366847948849, 'recall': 0.3461340448188104, 'f1-score': 0.2296163263546779, 'support': 4877446}, 'weighted avg': {'precision': 0.13777030315305147, 'recall': 0.2653362025945546, 'f1-score': 0.17670025465931752, 'support': 4877446}}
[[ 463405       0  812600]
 [ 813971       0 1557143]
 [ 399569       0  830758]]
Evaluating performance on  train set...
4812/4812 - 115s - 115s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1285743
{'0': {'precision': 0.34370602765063274, 'recall': 0.36251077269550747, 'f1-score': 0.35285803906864055, 'support': 404959}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 406721}, '2': {'precision': 0.3486813328826769, 'recall': 0.6678026688117433, 'f1-score': 0.4581485282124252, 'support': 420187}, 'accuracy': 0.346956286677052, 'macro avg': {'precision': 0.23079578684443655, 'recall': 0.3434378138357503, 'f1-score': 0.2703355224270219, 'support': 1231867}, 'weighted avg': {'precision': 0.23192293686846543, 'recall': 0.346956286677052, 'f1-score': 0.2722705407866206, 'support': 1231867}}
[[146802      0 258157]
 [140728      0 265993]
 [139585      0 280602]]
Evaluating performance on  val set...
1767/1767 - 42s - 42s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378298
{'0': {'precision': 0.34691730196949255, 'recall': 0.3571466546160185, 'f1-score': 0.35195766710654275, 'support': 150476}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 156298}, '2': {'precision': 0.32799448517048896, 'recall': 0.6702836055772786, 'f1-score': 0.44045707937927164, 'support': 145519}, 'accuracy': 0.33447566068897816, 'macro avg': {'precision': 0.22497059571332714, 'recall': 0.34247675339776573, 'f1-score': 0.2641382488286048, 'support': 452293}, 'weighted avg': {'precision': 0.220945620247684, 'recall': 0.33447566068897816, 'f1-score': 0.2588058087339763, 'support': 452293}}
[[ 53742      0  96734]
 [ 53191      0 103107]
 [ 47980      0  97539]]
training model: results/AAPL/W0/deepLOB_L2/h10
Epoch 1/50
4812/4812 - 499s - loss: 3.1683 - accuracy10: 0.4361 - val_loss: 3.3683 - val_accuracy10: 0.3418 - 499s/epoch - 104ms/step
Epoch 2/50
4812/4812 - 488s - loss: 3.1104 - accuracy10: 0.4592 - val_loss: 3.4352 - val_accuracy10: 0.3725 - 488s/epoch - 101ms/step
Epoch 3/50
4812/4812 - 494s - loss: 3.0686 - accuracy10: 0.4736 - val_loss: 3.2665 - val_accuracy10: 0.4256 - 494s/epoch - 103ms/step
Epoch 4/50
4812/4812 - 487s - loss: 3.0427 - accuracy10: 0.4819 - val_loss: 3.1822 - val_accuracy10: 0.4375 - 487s/epoch - 101ms/step
Epoch 5/50
4812/4812 - 496s - loss: 3.0263 - accuracy10: 0.4870 - val_loss: 3.1337 - val_accuracy10: 0.4511 - 496s/epoch - 103ms/step
Epoch 6/50
4812/4812 - 501s - loss: 3.0135 - accuracy10: 0.4909 - val_loss: 3.1091 - val_accuracy10: 0.4595 - 501s/epoch - 104ms/step
Epoch 7/50
4812/4812 - 490s - loss: 3.0027 - accuracy10: 0.4937 - val_loss: 3.0949 - val_accuracy10: 0.4648 - 490s/epoch - 102ms/step
Epoch 8/50
4812/4812 - 494s - loss: 2.9941 - accuracy10: 0.4964 - val_loss: 3.0879 - val_accuracy10: 0.4669 - 494s/epoch - 103ms/step
Epoch 9/50
4812/4812 - 511s - loss: 2.9869 - accuracy10: 0.4979 - val_loss: 3.0923 - val_accuracy10: 0.4657 - 511s/epoch - 106ms/step
Epoch 10/50
4812/4812 - 513s - loss: 2.9797 - accuracy10: 0.5001 - val_loss: 3.0704 - val_accuracy10: 0.4735 - 513s/epoch - 107ms/step
Epoch 11/50
4812/4812 - 504s - loss: 2.9736 - accuracy10: 0.5017 - val_loss: 3.0779 - val_accuracy10: 0.4708 - 504s/epoch - 105ms/step
Epoch 12/50
4812/4812 - 516s - loss: 2.9682 - accuracy10: 0.5032 - val_loss: 3.0721 - val_accuracy10: 0.4725 - 516s/epoch - 107ms/step
Epoch 13/50
4812/4812 - 523s - loss: 2.9626 - accuracy10: 0.5046 - val_loss: 3.0773 - val_accuracy10: 0.4720 - 523s/epoch - 109ms/step
Epoch 14/50
4812/4812 - 515s - loss: 2.9582 - accuracy10: 0.5058 - val_loss: 3.0565 - val_accuracy10: 0.4781 - 515s/epoch - 107ms/step
Epoch 15/50
4812/4812 - 517s - loss: 2.9540 - accuracy10: 0.5067 - val_loss: 3.0746 - val_accuracy10: 0.4726 - 517s/epoch - 107ms/step
Epoch 16/50
4812/4812 - 526s - loss: 2.9504 - accuracy10: 0.5078 - val_loss: 3.0638 - val_accuracy10: 0.4756 - 526s/epoch - 109ms/step
Epoch 17/50
4812/4812 - 515s - loss: 2.9469 - accuracy10: 0.5086 - val_loss: 3.0622 - val_accuracy10: 0.4762 - 515s/epoch - 107ms/step
Epoch 18/50
4812/4812 - 527s - loss: 2.9441 - accuracy10: 0.5089 - val_loss: 3.0682 - val_accuracy10: 0.4739 - 527s/epoch - 109ms/step
Epoch 19/50
4812/4812 - 522s - loss: 2.9410 - accuracy10: 0.5103 - val_loss: 3.0612 - val_accuracy10: 0.4759 - 522s/epoch - 108ms/step
Epoch 20/50
4812/4812 - 539s - loss: 2.9385 - accuracy10: 0.5108 - val_loss: 3.0425 - val_accuracy10: 0.4814 - 539s/epoch - 112ms/step
Epoch 21/50
4812/4812 - 555s - loss: 2.9353 - accuracy10: 0.5114 - val_loss: 3.0466 - val_accuracy10: 0.4802 - 555s/epoch - 115ms/step
Epoch 22/50
4812/4812 - 523s - loss: 2.9334 - accuracy10: 0.5119 - val_loss: 3.0572 - val_accuracy10: 0.4771 - 523s/epoch - 109ms/step
Epoch 23/50
4812/4812 - 542s - loss: 2.9306 - accuracy10: 0.5128 - val_loss: 3.0510 - val_accuracy10: 0.4793 - 542s/epoch - 113ms/step
Epoch 24/50
4812/4812 - 534s - loss: 2.9281 - accuracy10: 0.5134 - val_loss: 3.0558 - val_accuracy10: 0.4779 - 534s/epoch - 111ms/step
Epoch 25/50
4812/4812 - 528s - loss: 2.9258 - accuracy10: 0.5138 - val_loss: 3.0599 - val_accuracy10: 0.4779 - 528s/epoch - 110ms/step
Epoch 26/50
4812/4812 - 541s - loss: 2.9236 - accuracy10: 0.5146 - val_loss: 3.0666 - val_accuracy10: 0.4754 - 541s/epoch - 112ms/step
Epoch 27/50
4812/4812 - 541s - loss: 2.9220 - accuracy10: 0.5150 - val_loss: 3.0598 - val_accuracy10: 0.4778 - 541s/epoch - 112ms/step
Epoch 28/50
4812/4812 - 536s - loss: 2.9195 - accuracy10: 0.5156 - val_loss: 3.0586 - val_accuracy10: 0.4778 - 536s/epoch - 111ms/step
Epoch 29/50
4812/4812 - 540s - loss: 2.9172 - accuracy10: 0.5164 - val_loss: 3.0648 - val_accuracy10: 0.4777 - 540s/epoch - 112ms/step
Epoch 30/50
4812/4812 - 540s - loss: 2.9153 - accuracy10: 0.5170 - val_loss: 3.0788 - val_accuracy10: 0.4733 - 540s/epoch - 112ms/step
testing model: results/AAPL/W0/deepLOB_L2/h10
Evaluating performance on  test set...
19053/19053 - 963s - 963s/epoch - 51ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97957045
{'0': {'precision': 0.43831440368689467, 'recall': 0.5092354223697074, 'f1-score': 0.47112080938504447, 'support': 1177369}, '1': {'precision': 0.6957827346725594, 'recall': 0.45185572555699705, 'f1-score': 0.5478962640248469, 'support': 2541351}, '2': {'precision': 0.3912594470767379, 'recall': 0.6277721058640875, 'f1-score': 0.48206901213557485, 'support': 1158731}, 'accuracy': 0.5074988964522658, 'macro avg': {'precision': 0.5084521951453973, 'recall': 0.5296210845969306, 'f1-score': 0.5003620285151554, 'support': 4877451}, 'weighted avg': {'precision': 0.5612871128931801, 'recall': 0.5074988964522658, 'f1-score': 0.5137249073750891, 'support': 4877451}}
[[ 599558  270296  307515]
 [ 568788 1148324  824239]
 [ 199526  231786  727419]]
Evaluating performance on  train set...
4812/4812 - 247s - 247s/epoch - 51ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0058662
{'0': {'precision': 0.49006850257228535, 'recall': 0.5255611202490098, 'f1-score': 0.5071946414780069, 'support': 406731}, '1': {'precision': 0.521483371917543, 'recall': 0.32449181770581104, 'f1-score': 0.40005212760960057, 'support': 406793}, '2': {'precision': 0.47379062729239857, 'recall': 0.6144632168741514, 'f1-score': 0.5350349360702177, 'support': 418344}, 'accuracy': 0.48935437887825645, 'macro avg': {'precision': 0.49511416726074237, 'recall': 0.48817205160965743, 'f1-score': 0.48076056838594167, 'support': 1231868}, 'weighted avg': {'precision': 0.49491447429123286, 'recall': 0.48935437887825645, 'f1-score': 0.48126815873538603, 'support': 1231868}}
[[213762  62526 130443]
 [119738 132001 155054]
 [102688  58599 257057]]
Evaluating performance on  val set...
1767/1767 - 91s - 91s/epoch - 51ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0128411
{'0': {'precision': 0.4888729265599851, 'recall': 0.4979203641733617, 'f1-score': 0.4933551695438559, 'support': 147622}, '1': {'precision': 0.49924993327627304, 'recall': 0.3525256529396092, 'f1-score': 0.4132506532387692, 'support': 153881}, '2': {'precision': 0.4640939145911156, 'recall': 0.5948736653624246, 'f1-score': 0.5214083098886279, 'support': 150790}, 'accuracy': 0.48077684156066974, 'macro avg': {'precision': 0.4840722581424579, 'recall': 0.48177322749179846, 'f1-score': 0.47600471089041757, 'support': 452293}, 'weighted avg': {'precision': 0.4841423580031497, 'recall': 0.48077684156066974, 'f1-score': 0.4754543175718933, 'support': 452293}}
[[73504 28406 45712]
 [41765 54247 57869]
 [35085 26004 89701]]
training model: results/AAPL/W0/deepLOB_L2/h20
Epoch 1/50
4812/4812 - 555s - loss: 3.2026 - accuracy20: 0.4222 - val_loss: 3.3344 - val_accuracy20: 0.3392 - 555s/epoch - 115ms/step
Epoch 2/50
4812/4812 - 556s - loss: 3.1797 - accuracy20: 0.4327 - val_loss: 3.3148 - val_accuracy20: 0.3424 - 556s/epoch - 116ms/step
Epoch 3/50
4812/4812 - 555s - loss: 3.1649 - accuracy20: 0.4382 - val_loss: 3.3288 - val_accuracy20: 0.3366 - 555s/epoch - 115ms/step
Epoch 4/50
4812/4812 - 544s - loss: 3.1460 - accuracy20: 0.4452 - val_loss: 3.3647 - val_accuracy20: 0.3425 - 544s/epoch - 113ms/step
Epoch 5/50
4812/4812 - 553s - loss: 3.1319 - accuracy20: 0.4508 - val_loss: 3.4332 - val_accuracy20: 0.3440 - 553s/epoch - 115ms/step
Epoch 6/50
4812/4812 - 548s - loss: 3.1219 - accuracy20: 0.4545 - val_loss: 3.4491 - val_accuracy20: 0.3437 - 548s/epoch - 114ms/step
Epoch 7/50
4812/4812 - 548s - loss: 3.1147 - accuracy20: 0.4571 - val_loss: 3.4738 - val_accuracy20: 0.3352 - 548s/epoch - 114ms/step
Epoch 8/50
4812/4812 - 532s - loss: 3.1076 - accuracy20: 0.4595 - val_loss: 3.4628 - val_accuracy20: 0.3387 - 532s/epoch - 110ms/step
Epoch 9/50
4812/4812 - 547s - loss: 3.1022 - accuracy20: 0.4613 - val_loss: 3.4881 - val_accuracy20: 0.3367 - 547s/epoch - 114ms/step
Epoch 10/50
4812/4812 - 545s - loss: 3.0968 - accuracy20: 0.4632 - val_loss: 3.4611 - val_accuracy20: 0.3336 - 545s/epoch - 113ms/step
Epoch 11/50
4812/4812 - 558s - loss: 3.0920 - accuracy20: 0.4650 - val_loss: 3.4515 - val_accuracy20: 0.3367 - 558s/epoch - 116ms/step
Epoch 12/50
4812/4812 - 542s - loss: 3.0872 - accuracy20: 0.4662 - val_loss: 3.4760 - val_accuracy20: 0.3365 - 542s/epoch - 113ms/step
testing model: results/AAPL/W0/deepLOB_L2/h20
Evaluating performance on  test set...
19053/19053 - 1017s - 1017s/epoch - 53ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.104051
{'0': {'precision': 0.26247626762051895, 'recall': 0.450958825920246, 'f1-score': 0.3318199246146677, 'support': 1247411}, '1': {'precision': 0.49286504560582195, 'recall': 0.2764736595857104, 'f1-score': 0.3542372219699923, 'support': 2395957}, '2': {'precision': 0.26562993386153, 'recall': 0.2992472953601986, 'f1-score': 0.2814382848616114, 'support': 1234083}, 'accuracy': 0.3268604851181488, 'macro avg': {'precision': 0.3403237490292903, 'recall': 0.34222659362205166, 'f1-score': 0.3224984771487571, 'support': 4877451}, 'weighted avg': {'precision': 0.37644840003784885, 'recall': 0.3268604851181488, 'f1-score': 0.33008454180676267, 'support': 4877451}}
[[ 562531  346376  338504]
 [1051073  662419  682465]
 [ 529565  335222  369296]]
Evaluating performance on  train set...
4812/4812 - 254s - 254s/epoch - 53ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010492
{'0': {'precision': 0.3493833462555321, 'recall': 0.3567221126850591, 'f1-score': 0.3530145924668033, 'support': 406762}, '1': {'precision': 0.3409686782644989, 'recall': 0.22086118757373183, 'f1-score': 0.2680766964731854, 'support': 406880}, '2': {'precision': 0.36165003336304963, 'recall': 0.4781983903439767, 'f1-score': 0.41183732430837916, 'support': 418226}, 'accuracy': 0.35308977909970873, 'macro avg': {'precision': 0.35066735262769355, 'recall': 0.3519272302009225, 'f1-score': 0.3443095377494559, 'support': 1231868}, 'weighted avg': {'precision': 0.3507686305311501, 'recall': 0.35308977909970873, 'f1-score': 0.3449306619850403, 'support': 1231868}}
[[145101  87357 174304]
 [138308  89864 178708]
 [131897  86334 199995]]
Evaluating performance on  val set...
1767/1767 - 95s - 95s/epoch - 53ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1048778
{'0': {'precision': 0.3398094052845669, 'recall': 0.39954475554321095, 'f1-score': 0.36726395267377593, 'support': 147613}, '1': {'precision': 0.3398295199641095, 'recall': 0.2455125919683661, 'f1-score': 0.28507235195604314, 'support': 154265}, '2': {'precision': 0.3457894201971533, 'recall': 0.38456270983612006, 'f1-score': 0.3641468573730862, 'support': 150415}, 'accuracy': 0.3420260760170951, 'macro avg': {'precision': 0.34180944848194317, 'recall': 0.34320668578256575, 'f1-score': 0.3388277206676351, 'support': 452293}, 'weighted avg': {'precision': 0.34180498543751275, 'recall': 0.3420260760170951, 'f1-score': 0.33819397994730377, 'support': 452293}}
[[58978 36688 51947]
 [58901 37874 57490]
 [55683 36888 57844]]
training model: results/AAPL/W0/deepLOB_L2/h30
Epoch 1/50
4812/4812 - 560s - loss: 3.2287 - accuracy30: 0.4094 - val_loss: 3.3125 - val_accuracy30: 0.3427 - 560s/epoch - 116ms/step
Epoch 2/50
4812/4812 - 544s - loss: 3.2040 - accuracy30: 0.4216 - val_loss: 3.2969 - val_accuracy30: 0.3471 - 544s/epoch - 113ms/step
Epoch 3/50
4812/4812 - 546s - loss: 3.1948 - accuracy30: 0.4255 - val_loss: 3.3085 - val_accuracy30: 0.3499 - 546s/epoch - 114ms/step
Epoch 4/50
4812/4812 - 532s - loss: 3.1809 - accuracy30: 0.4317 - val_loss: 3.3139 - val_accuracy30: 0.3508 - 532s/epoch - 110ms/step
Epoch 5/50
4812/4812 - 527s - loss: 3.1676 - accuracy30: 0.4366 - val_loss: 3.3240 - val_accuracy30: 0.3556 - 527s/epoch - 110ms/step
Epoch 6/50
4812/4812 - 529s - loss: 3.1600 - accuracy30: 0.4397 - val_loss: 3.3587 - val_accuracy30: 0.3507 - 529s/epoch - 110ms/step
Epoch 7/50
4812/4812 - 528s - loss: 3.1537 - accuracy30: 0.4422 - val_loss: 3.3827 - val_accuracy30: 0.3499 - 528s/epoch - 110ms/step
Epoch 8/50
4812/4812 - 523s - loss: 3.1487 - accuracy30: 0.4445 - val_loss: 3.3960 - val_accuracy30: 0.3532 - 523s/epoch - 109ms/step
Epoch 9/50
4812/4812 - 532s - loss: 3.1451 - accuracy30: 0.4459 - val_loss: 3.4040 - val_accuracy30: 0.3524 - 532s/epoch - 110ms/step
Epoch 10/50
4812/4812 - 537s - loss: 3.1414 - accuracy30: 0.4475 - val_loss: 3.3894 - val_accuracy30: 0.3516 - 537s/epoch - 112ms/step
Epoch 11/50
4812/4812 - 527s - loss: 3.1376 - accuracy30: 0.4486 - val_loss: 3.4123 - val_accuracy30: 0.3457 - 527s/epoch - 109ms/step
Epoch 12/50
4812/4812 - 526s - loss: 3.1346 - accuracy30: 0.4501 - val_loss: 3.4029 - val_accuracy30: 0.3488 - 526s/epoch - 109ms/step
testing model: results/AAPL/W0/deepLOB_L2/h30
Evaluating performance on  test set...
19053/19053 - 960s - 960s/epoch - 50ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0980023
{'0': {'precision': 0.28990217420225217, 'recall': 0.22338655604482888, 'f1-score': 0.2523345807876032, 'support': 1316919}, '1': {'precision': 0.4794511694043563, 'recall': 0.20681341547443033, 'f1-score': 0.288975815108508, 'support': 2259689}, '2': {'precision': 0.2811561513469192, 'recall': 0.624186008611339, 'f1-score': 0.3876848857096203, 'support': 1300843}, 'accuracy': 0.32260375347696985, 'macro avg': {'precision': 0.3501698316511759, 'recall': 0.35146199337686607, 'f1-score': 0.30966509386857716, 'support': 4877451}, 'weighted avg': {'precision': 0.3753862880990494, 'recall': 0.32260375347696985, 'f1-score': 0.3054088794011705, 'support': 4877451}}
[[ 294182  263478  759259]
 [ 475621  467334 1316734]
 [ 244960  243915  811968]]
Evaluating performance on  train set...
4812/4812 - 238s - 238s/epoch - 50ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.095897
{'0': {'precision': 0.36310558351955097, 'recall': 0.2380823174792677, 'f1-score': 0.2875940073656484, 'support': 405406}, '1': {'precision': 0.3509182622625677, 'recall': 0.1807636954845301, 'f1-score': 0.23861363349013331, 'support': 407178}, '2': {'precision': 0.35967320105883066, 'recall': 0.6487798246534568, 'f1-score': 0.46278549494296484, 'support': 419284}, 'accuracy': 0.35892319631648845, 'macro avg': {'precision': 0.35789901561364973, 'recall': 0.35587527920575157, 'f1-score': 0.32966437859958214, 'support': 1231868}, 'weighted avg': {'precision': 0.35790896168796144, 'recall': 0.35892319631648845, 'f1-score': 0.3310331234101297, 'support': 1231868}}
[[ 96520  69617 239269]
 [ 88561  73603 245014]
 [ 80737  66524 272023]]
Evaluating performance on  val set...
1767/1767 - 96s - 96s/epoch - 54ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0983661
{'0': {'precision': 0.3483021755314749, 'recall': 0.22877304030100107, 'f1-score': 0.27615862006771763, 'support': 147242}, '1': {'precision': 0.34780333587703044, 'recall': 0.20629809246686065, 'f1-score': 0.2589820602321617, 'support': 154650}, '2': {'precision': 0.3453426365638182, 'recall': 0.6058403866995565, 'f1-score': 0.43992062802352194, 'support': 150401}, 'accuracy': 0.3464745198355933, 'macro avg': {'precision': 0.34714938265744116, 'recall': 0.34697050648913946, 'f1-score': 0.3250204361078004, 'support': 452293}, 'weighted avg': {'precision': 0.3471474745459757, 'recall': 0.3464745198355933, 'f1-score': 0.3247413192914337, 'support': 452293}}
[[33685 30428 83129]
 [33143 31904 89603]
 [29884 29398 91119]]
training model: results/AAPL/W0/deepLOB_L2/h50
Epoch 1/50
4812/4812 - 567s - loss: 3.2094 - accuracy50: 0.4166 - val_loss: 3.3087 - val_accuracy50: 0.3672 - 567s/epoch - 118ms/step
Epoch 2/50
4812/4812 - 537s - loss: 3.1883 - accuracy50: 0.4308 - val_loss: 3.3014 - val_accuracy50: 0.3698 - 537s/epoch - 112ms/step
Epoch 3/50
4812/4812 - 534s - loss: 3.1772 - accuracy50: 0.4351 - val_loss: 3.3348 - val_accuracy50: 0.3702 - 534s/epoch - 111ms/step
Epoch 4/50
4812/4812 - 536s - loss: 3.1723 - accuracy50: 0.4373 - val_loss: 3.3328 - val_accuracy50: 0.3704 - 536s/epoch - 111ms/step
Epoch 5/50
4812/4812 - 532s - loss: 3.1670 - accuracy50: 0.4395 - val_loss: 3.3371 - val_accuracy50: 0.3703 - 532s/epoch - 111ms/step
Epoch 6/50
4812/4812 - 523s - loss: 3.1612 - accuracy50: 0.4426 - val_loss: 3.3698 - val_accuracy50: 0.3702 - 523s/epoch - 109ms/step
Epoch 7/50
4812/4812 - 524s - loss: 3.1544 - accuracy50: 0.4455 - val_loss: 3.3697 - val_accuracy50: 0.3702 - 524s/epoch - 109ms/step
Epoch 8/50
4812/4812 - 514s - loss: 3.1482 - accuracy50: 0.4487 - val_loss: 3.4434 - val_accuracy50: 0.3702 - 514s/epoch - 107ms/step
Epoch 9/50
4812/4812 - 531s - loss: 3.1426 - accuracy50: 0.4513 - val_loss: 3.4875 - val_accuracy50: 0.3702 - 531s/epoch - 110ms/step
Epoch 10/50
4812/4812 - 527s - loss: 3.1387 - accuracy50: 0.4531 - val_loss: 3.4525 - val_accuracy50: 0.3703 - 527s/epoch - 109ms/step
Epoch 11/50
4812/4812 - 532s - loss: 3.1346 - accuracy50: 0.4545 - val_loss: 3.4847 - val_accuracy50: 0.3702 - 532s/epoch - 111ms/step
Epoch 12/50
4812/4812 - 533s - loss: 3.1314 - accuracy50: 0.4561 - val_loss: 3.5113 - val_accuracy50: 0.3702 - 533s/epoch - 111ms/step
testing model: results/AAPL/W0/deepLOB_L2/h50
Evaluating performance on  test set...
19053/19053 - 939s - 939s/epoch - 49ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0450675
{'0': {'precision': 0.2765934692713532, 'recall': 0.006844662592273709, 'f1-score': 0.013358745768898346, 'support': 1133584}, '1': {'precision': 0.5391289746874248, 'recall': 0.9668747466805167, 'f1-score': 0.692256178962888, 'support': 2630078}, '2': {'precision': 0.2640992964490661, 'recall': 0.03144491461129532, 'f1-score': 0.05619856194069008, 'support': 1113789}, 'accuracy': 0.5301412561602361, 'macro avg': {'precision': 0.35994058013594804, 'recall': 0.3350547746280286, 'f1-score': 0.2539378288908255, 'support': 4877451}, 'weighted avg': {'precision': 0.4153079299107586, 'recall': 0.5301412561602361, 'f1-score': 0.3892246887202772, 'support': 4877451}}
[[   7759 1100795   25030]
 [  14562 2542956   72560]
 [   5731 1073035   35023]]
Evaluating performance on  train set...
4812/4812 - 246s - 246s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1114616
{'0': {'precision': 0.37863584402387906, 'recall': 0.022030186504016575, 'f1-score': 0.041637761254487135, 'support': 405943}, '1': {'precision': 0.330999359683828, 'recall': 0.9601128667616243, 'f1-score': 0.49228368783591353, 'support': 406497}, '2': {'precision': 0.39102388141641503, 'recall': 0.027170336744327988, 'f1-score': 0.05081012635652692, 'support': 419428}, 'accuracy': 0.33333279214980827, 'macro avg': {'precision': 0.3668863617080407, 'recall': 0.33643779666998963, 'f1-score': 0.19491052514897586, 'support': 1231868}, 'weighted avg': {'precision': 0.36713445083296803, 'recall': 0.33333279214980827, 'f1-score': 0.19346682408231322, 'support': 1231868}}
[[  8943 388351   8649]
 [  7115 390283   9099]
 [  7561 400471  11396]]
Evaluating performance on  val set...
1767/1767 - 91s - 91s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000125
{'0': {'precision': 0.33984375, 'recall': 0.0067611007100215476, 'f1-score': 0.01325842852293902, 'support': 141545}, '1': {'precision': 0.370644821373942, 'recall': 0.9767225214680696, 'f1-score': 0.5373696288910098, 'support': 167458}, '2': {'precision': 0.364990234375, 'recall': 0.02086677367576244, 'f1-score': 0.03947663748828244, 'support': 143290}, 'accuracy': 0.3703506355393517, 'macro avg': {'precision': 0.3584929352496473, 'recall': 0.33478346528461783, 'f1-score': 0.19670156496741042, 'support': 452293}, 'weighted avg': {'precision': 0.35921421462410724, 'recall': 0.3703506355393517, 'f1-score': 0.21561270009884326, 'support': 452293}}
[[   957 138285   2303]
 [   999 163560   2899]
 [   860 139440   2990]]
training model: results/AAPL/W0/deepLOB_L2/h100
Epoch 1/50
4812/4812 - 553s - loss: 3.2611 - accuracy100: 0.3871 - val_loss: 3.3500 - val_accuracy100: 0.3286 - 553s/epoch - 115ms/step
Epoch 2/50
4812/4812 - 544s - loss: 3.2434 - accuracy100: 0.4006 - val_loss: 3.3873 - val_accuracy100: 0.3304 - 544s/epoch - 113ms/step
Epoch 3/50
4812/4812 - 551s - loss: 3.2358 - accuracy100: 0.4060 - val_loss: 3.3908 - val_accuracy100: 0.3291 - 551s/epoch - 114ms/step
Epoch 4/50
4812/4812 - 545s - loss: 3.2308 - accuracy100: 0.4085 - val_loss: 3.4161 - val_accuracy100: 0.3288 - 545s/epoch - 113ms/step
Epoch 5/50
4812/4812 - 552s - loss: 3.2275 - accuracy100: 0.4102 - val_loss: 3.4334 - val_accuracy100: 0.3388 - 552s/epoch - 115ms/step
Epoch 6/50
4812/4812 - 578s - loss: 3.2245 - accuracy100: 0.4115 - val_loss: 3.4326 - val_accuracy100: 0.3423 - 578s/epoch - 120ms/step
Epoch 7/50
4812/4812 - 550s - loss: 3.2222 - accuracy100: 0.4129 - val_loss: 3.4828 - val_accuracy100: 0.3446 - 550s/epoch - 114ms/step
Epoch 8/50
4812/4812 - 544s - loss: 3.2196 - accuracy100: 0.4140 - val_loss: 3.4473 - val_accuracy100: 0.3412 - 544s/epoch - 113ms/step
Epoch 9/50
4812/4812 - 550s - loss: 3.2176 - accuracy100: 0.4152 - val_loss: 3.4698 - val_accuracy100: 0.3423 - 550s/epoch - 114ms/step
Epoch 10/50
4812/4812 - 549s - loss: 3.2155 - accuracy100: 0.4164 - val_loss: 3.4509 - val_accuracy100: 0.3431 - 549s/epoch - 114ms/step
Epoch 11/50
4812/4812 - 538s - loss: 3.2136 - accuracy100: 0.4173 - val_loss: 3.4673 - val_accuracy100: 0.3431 - 538s/epoch - 112ms/step
testing model: results/AAPL/W0/deepLOB_L2/h100
Evaluating performance on  test set...
19053/19053 - 1002s - 1002s/epoch - 53ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1161509
{'0': {'precision': 0.30288987578039517, 'recall': 0.0034109828428867672, 'f1-score': 0.006745995908824412, 'support': 1379661}, '1': {'precision': 0.4438350380139572, 'recall': 0.08997540407426137, 'f1-score': 0.14961954184111423, 'support': 2149543}, '2': {'precision': 0.2767949955638678, 'recall': 0.9086888381728274, 'f1-score': 0.4243339567747298, 'support': 1348247}, 'accuracy': 0.29180180385205307, 'macro avg': {'precision': 0.3411733031194067, 'recall': 0.33402507502999185, 'f1-score': 0.19356649817488947, 'support': 4877451}, 'weighted avg': {'precision': 0.35779259912825145, 'recall': 0.29180180385205307, 'f1-score': 0.18514338955101708, 'support': 4877451}}
[[   4706  122860 1252095]
 [   7216  193406 1948921]
 [   3615  119495 1225137]]
Evaluating performance on  train set...
4812/4812 - 248s - 248s/epoch - 52ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125299
{'0': {'precision': 0.38460611416864177, 'recall': 0.02345252297117549, 'f1-score': 0.04420925282022155, 'support': 408229}, '1': {'precision': 0.3392304751312085, 'recall': 0.07211520699872173, 'f1-score': 0.11894461032234477, 'support': 406017}, '2': {'precision': 0.3393654821882066, 'recall': 0.9106656258530441, 'f1-score': 0.4944652612911529, 'support': 417622}, 'accuracy': 0.3402702237577403, 'macro avg': {'precision': 0.3544006904960189, 'recall': 0.3354111186076471, 'f1-score': 0.21920637481123975, 'support': 1231868}, 'weighted avg': {'precision': 0.3543132873040793, 'recall': 0.3402702237577403, 'f1-score': 0.2214852600032857, 'support': 1231868}}
[[  9574  28228 370427]
 [  6816  29280 369921]
 [  8503  28805 380314]]
Evaluating performance on  val set...
1767/1767 - 93s - 93s/epoch - 53ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1146328
{'0': {'precision': 0.3292943692088382, 'recall': 0.0031395680715440967, 'f1-score': 0.006219834810880673, 'support': 147154}, '1': {'precision': 0.34936977072693687, 'recall': 0.0816996785628073, 'f1-score': 0.13243062348761778, 'support': 157418}, '2': {'precision': 0.3267138075435063, 'recall': 0.9158142714982974, 'f1-score': 0.48161353081796154, 'support': 147721}, 'accuracy': 0.3285657748406453, 'macro avg': {'precision': 0.33512598249309383, 'recall': 0.3335511727108829, 'f1-score': 0.20675466303881998, 'support': 452293}, 'weighted avg': {'precision': 0.3354386747948445, 'recall': 0.3285657748406453, 'f1-score': 0.20541257513579525, 'support': 452293}}
[[   462  11925 134767]
 [   531  12861 144026]
 [   410  12026 135285]]
training model: results/AAPL/W0/deepLOB_L2/h200
Epoch 1/50
4812/4812 - 543s - loss: 3.2448 - accuracy200: 0.3994 - val_loss: 3.3305 - val_accuracy200: 0.3350 - 543s/epoch - 113ms/step
Epoch 2/50
4812/4812 - 536s - loss: 3.2256 - accuracy200: 0.4121 - val_loss: 3.3335 - val_accuracy200: 0.3292 - 536s/epoch - 111ms/step
Epoch 3/50
4812/4812 - 534s - loss: 3.2172 - accuracy200: 0.4179 - val_loss: 3.3303 - val_accuracy200: 0.3304 - 534s/epoch - 111ms/step
Epoch 4/50
4812/4812 - 528s - loss: 3.2112 - accuracy200: 0.4215 - val_loss: 3.3486 - val_accuracy200: 0.3318 - 528s/epoch - 110ms/step
Epoch 5/50
4812/4812 - 522s - loss: 3.2069 - accuracy200: 0.4236 - val_loss: 3.3519 - val_accuracy200: 0.3323 - 522s/epoch - 108ms/step
Epoch 6/50
4812/4812 - 529s - loss: 3.2029 - accuracy200: 0.4253 - val_loss: 3.3772 - val_accuracy200: 0.3269 - 529s/epoch - 110ms/step
Epoch 7/50
4812/4812 - 539s - loss: 3.1991 - accuracy200: 0.4272 - val_loss: 3.3601 - val_accuracy200: 0.3276 - 539s/epoch - 112ms/step
Epoch 8/50
4812/4812 - 534s - loss: 3.1960 - accuracy200: 0.4286 - val_loss: 3.3696 - val_accuracy200: 0.3309 - 534s/epoch - 111ms/step
Epoch 9/50
4812/4812 - 542s - loss: 3.1938 - accuracy200: 0.4294 - val_loss: 3.4172 - val_accuracy200: 0.3258 - 542s/epoch - 113ms/step
Epoch 10/50
4812/4812 - 531s - loss: 3.1912 - accuracy200: 0.4310 - val_loss: 3.3560 - val_accuracy200: 0.3314 - 531s/epoch - 110ms/step
Epoch 11/50
4812/4812 - 520s - loss: 3.1882 - accuracy200: 0.4321 - val_loss: 3.3777 - val_accuracy200: 0.3275 - 520s/epoch - 108ms/step
Epoch 12/50
4812/4812 - 542s - loss: 3.1857 - accuracy200: 0.4332 - val_loss: 3.3868 - val_accuracy200: 0.3282 - 542s/epoch - 113ms/step
Epoch 13/50
4812/4812 - 544s - loss: 3.1840 - accuracy200: 0.4339 - val_loss: 3.3810 - val_accuracy200: 0.3272 - 544s/epoch - 113ms/step
testing model: results/AAPL/W0/deepLOB_L2/h200
Evaluating performance on  test set...
19053/19053 - 961s - 961s/epoch - 50ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150708
{'0': {'precision': 0.2557346550442062, 'recall': 0.14553795332275107, 'f1-score': 0.18550530244415422, 'support': 1242961}, '1': {'precision': 0.4999223559425434, 'recall': 0.2605886451217503, 'f1-score': 0.3425961997100089, 'support': 2421391}, '2': {'precision': 0.24911422789180565, 'recall': 0.5971507684038978, 'f1-score': 0.35156541569623406, 'support': 1213099}, 'accuracy': 0.31497763893476327, 'macro avg': {'precision': 0.33492374629285177, 'recall': 0.3344257889494664, 'f1-score': 0.2932223059501324, 'support': 4877451}, 'weighted avg': {'precision': 0.37531405578196364, 'recall': 0.31497763893476327, 'f1-score': 0.3047942183445805, 'support': 4877451}}
[[ 180898  319286  742777]
 [ 349669  630987 1440735]
 [ 176799  311897  724403]]
Evaluating performance on  train set...
4812/4812 - 251s - 251s/epoch - 52ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1078051
{'0': {'precision': 0.3369467754914358, 'recall': 0.14368383771290194, 'f1-score': 0.20145951788141375, 'support': 407993}, '1': {'precision': 0.33488074329306716, 'recall': 0.2452784794899555, 'f1-score': 0.28316033357659576, 'support': 407337}, '2': {'precision': 0.33876030228822707, 'recall': 0.6177155505620135, 'f1-score': 0.4375594135763104, 'support': 416538}, 'accuracy': 0.33756457672412954, 'macro avg': {'precision': 0.3368626070242433, 'recall': 0.335559289254957, 'f1-score': 0.3073930883447733, 'support': 1231868}, 'weighted avg': {'precision': 0.3368768260060161, 'recall': 0.33756457672412954, 'f1-score': 0.3083089071956822, 'support': 1231868}}
[[ 58622  98352 251019]
 [ 56207  99911 251219]
 [ 59151 100085 257302]]
Evaluating performance on  val set...
1767/1767 - 96s - 96s/epoch - 55ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1092521
{'0': {'precision': 0.327275152566112, 'recall': 0.13341580625208166, 'f1-score': 0.1895573486308084, 'support': 147119}, '1': {'precision': 0.35206460649256244, 'recall': 0.2501243851594334, 'f1-score': 0.29246613424059326, 'support': 158781}, '2': {'precision': 0.3230869405000841, 'recall': 0.6168805885527313, 'f1-score': 0.4240700999751119, 'support': 146393}, 'accuracy': 0.3308695911720942, 'macro avg': {'precision': 0.33414223318625286, 'recall': 0.33347359332141546, 'f1-score': 0.3020311942821712, 'support': 452293}, 'weighted avg': {'precision': 0.3346220921714424, 'recall': 0.3308695911720942, 'f1-score': 0.3015886758798568, 'support': 452293}}
[[19628 36458 91033]
 [20893 39715 98173]
 [19453 36633 90307]]
training model: results/AAPL/W0/deepLOB_L2/h300
Epoch 1/50
4812/4812 - 493s - loss: 3.2524 - accuracy300: 0.3989 - val_loss: 3.3508 - val_accuracy300: 0.3328 - 493s/epoch - 102ms/step
Epoch 2/50
4812/4812 - 222s - loss: 3.2308 - accuracy300: 0.4109 - val_loss: 3.4556 - val_accuracy300: 0.3308 - 222s/epoch - 46ms/step
Epoch 3/50
4812/4812 - 224s - loss: 3.2224 - accuracy300: 0.4160 - val_loss: 3.5238 - val_accuracy300: 0.3281 - 224s/epoch - 47ms/step
Epoch 4/50
4812/4812 - 220s - loss: 3.2162 - accuracy300: 0.4193 - val_loss: 3.5092 - val_accuracy300: 0.3299 - 220s/epoch - 46ms/step
Epoch 5/50
4812/4812 - 221s - loss: 3.2104 - accuracy300: 0.4221 - val_loss: 3.5097 - val_accuracy300: 0.3295 - 221s/epoch - 46ms/step
Epoch 6/50
4812/4812 - 222s - loss: 3.2063 - accuracy300: 0.4244 - val_loss: 3.4526 - val_accuracy300: 0.3290 - 222s/epoch - 46ms/step
Epoch 7/50
4812/4812 - 222s - loss: 3.2019 - accuracy300: 0.4258 - val_loss: 3.5220 - val_accuracy300: 0.3294 - 222s/epoch - 46ms/step
Epoch 8/50
4812/4812 - 220s - loss: 3.1977 - accuracy300: 0.4274 - val_loss: 3.5234 - val_accuracy300: 0.3295 - 220s/epoch - 46ms/step
Epoch 9/50
4812/4812 - 221s - loss: 3.1936 - accuracy300: 0.4287 - val_loss: 3.5238 - val_accuracy300: 0.3316 - 221s/epoch - 46ms/step
Epoch 10/50
4812/4812 - 222s - loss: 3.1904 - accuracy300: 0.4299 - val_loss: 3.5188 - val_accuracy300: 0.3309 - 222s/epoch - 46ms/step
Epoch 11/50
4812/4812 - 225s - loss: 3.1870 - accuracy300: 0.4315 - val_loss: 3.5391 - val_accuracy300: 0.3298 - 225s/epoch - 47ms/step
testing model: results/AAPL/W0/deepLOB_L2/h300
Evaluating performance on  test set...
19053/19053 - 336s - 336s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118082
{'0': {'precision': 0.27640963325720846, 'recall': 0.13372910598119908, 'f1-score': 0.18025126428542987, 'support': 1353976}, '1': {'precision': 0.4542476565059202, 'recall': 0.3773192785450977, 'f1-score': 0.41222513981535286, 'support': 2201385}, '2': {'precision': 0.2721836366568163, 'recall': 0.49282348402907517, 'f1-score': 0.35068559359983464, 'support': 1322090}, 'accuracy': 0.34100762877986884, 'macro avg': {'precision': 0.33428030880664833, 'recall': 0.3346239561851239, 'f1-score': 0.31438733256687246, 'support': 4877451}, 'weighted avg': {'precision': 0.35552940482722584, 'recall': 0.34100762877986884, 'f1-score': 0.33114838912107064, 'support': 4877451}}
[[ 181066  505993  666917]
 [ 295420  830625 1075340]
 [ 178578  491955  651557]]
Evaluating performance on  train set...
4812/4812 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1136725
{'0': {'precision': 0.3314355779427359, 'recall': 0.12283774422866238, 'f1-score': 0.17924362609278502, 'support': 407098}, '1': {'precision': 0.33419636391175317, 'recall': 0.3472585626881234, 'f1-score': 0.340602274508858, 'support': 406648}, '2': {'precision': 0.34118515413564665, 'recall': 0.5372881599150487, 'f1-score': 0.41734846289319394, 'support': 418122}, 'accuracy': 0.3375938006344836, 'macro avg': {'precision': 0.3356056986633786, 'recall': 0.3357948222772782, 'f1-score': 0.31239812116494564, 'support': 1231868}, 'weighted avg': {'precision': 0.33565614409889966, 'recall': 0.3375938006344836, 'f1-score': 0.31332701995784185, 'support': 1231868}}
[[ 50007 139242 217849]
 [ 49491 141212 215945]
 [ 51382 142088 224652]]
Evaluating performance on  val set...
1767/1767 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1155567
{'0': {'precision': 0.33150557287746835, 'recall': 0.12353758213579785, 'f1-score': 0.17999785948491423, 'support': 149752}, '1': {'precision': 0.3443953052088342, 'recall': 0.32863282386014797, 'f1-score': 0.3363294839742318, 'support': 154735}, '2': {'precision': 0.32826301871930685, 'recall': 0.5526365641448926, 'f1-score': 0.41187474788221057, 'support': 147806}, 'accuracy': 0.33392955451444084, 'macro avg': {'precision': 0.33472129893520314, 'recall': 0.3349356567136128, 'f1-score': 0.30940069711378554, 'support': 452293}, 'weighted avg': {'precision': 0.33485566622932805, 'recall': 0.33392955451444084, 'f1-score': 0.30925648007334994, 'support': 452293}}
[[18500 48843 82409]
 [19142 50851 84742]
 [18164 47959 81683]]
training model: results/AAPL/W0/deepLOB_L2/h500
Epoch 1/50
4812/4812 - 228s - loss: 3.2522 - accuracy500: 0.3979 - val_loss: 3.4084 - val_accuracy500: 0.3275 - 228s/epoch - 47ms/step
Epoch 2/50
4812/4812 - 224s - loss: 3.2157 - accuracy500: 0.4193 - val_loss: 3.4181 - val_accuracy500: 0.3293 - 224s/epoch - 47ms/step
Epoch 3/50
4812/4812 - 224s - loss: 3.1968 - accuracy500: 0.4296 - val_loss: 3.4690 - val_accuracy500: 0.3321 - 224s/epoch - 47ms/step
Epoch 4/50
4812/4812 - 224s - loss: 3.1881 - accuracy500: 0.4323 - val_loss: 3.5373 - val_accuracy500: 0.3317 - 224s/epoch - 47ms/step
Epoch 5/50
4812/4812 - 225s - loss: 3.1782 - accuracy500: 0.4362 - val_loss: 3.6061 - val_accuracy500: 0.3346 - 225s/epoch - 47ms/step
Epoch 6/50
4812/4812 - 225s - loss: 3.1729 - accuracy500: 0.4383 - val_loss: 3.5578 - val_accuracy500: 0.3345 - 225s/epoch - 47ms/step
Epoch 7/50
4812/4812 - 224s - loss: 3.1669 - accuracy500: 0.4403 - val_loss: 3.5608 - val_accuracy500: 0.3347 - 224s/epoch - 47ms/step
Epoch 8/50
4812/4812 - 224s - loss: 3.1608 - accuracy500: 0.4426 - val_loss: 3.5753 - val_accuracy500: 0.3316 - 224s/epoch - 47ms/step
Epoch 9/50
4812/4812 - 223s - loss: 3.1569 - accuracy500: 0.4437 - val_loss: 3.5371 - val_accuracy500: 0.3342 - 223s/epoch - 46ms/step
Epoch 10/50
4812/4812 - 224s - loss: 3.1549 - accuracy500: 0.4445 - val_loss: 3.5552 - val_accuracy500: 0.3328 - 224s/epoch - 47ms/step
Epoch 11/50
4812/4812 - 224s - loss: 3.1509 - accuracy500: 0.4458 - val_loss: 3.5715 - val_accuracy500: 0.3332 - 224s/epoch - 47ms/step
testing model: results/AAPL/W0/deepLOB_L2/h500
Evaluating performance on  test set...
19053/19053 - 345s - 345s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1794298
{'0': {'precision': 0.27825999817674063, 'recall': 0.2941116761723468, 'f1-score': 0.2859663332171177, 'support': 1359538}, '1': {'precision': 0.44661087096477514, 'recall': 0.004440782404405666, 'f1-score': 0.008794122281038852, 'support': 2187002}, '2': {'precision': 0.27284701458265936, 'recall': 0.7008635438432773, 'f1-score': 0.39278309947998047, 'support': 1330911}, 'accuracy': 0.2752165014061648, 'macro avg': {'precision': 0.33257262790805836, 'recall': 0.33313866747334325, 'f1-score': 0.22918118499271234, 'support': 4877451}, 'weighted avg': {'precision': 0.3522698644124024, 'recall': 0.2752165014061648, 'f1-score': 0.19083209804838852, 'support': 4877451}}
[[ 399856    6128  953554]
 [ 644913    9712 1532377]
 [ 392218    5906  932787]]
Evaluating performance on  train set...
4812/4812 - 87s - 87s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269176
{'0': {'precision': 0.33134415661188654, 'recall': 0.262320925374899, 'f1-score': 0.2928200037944299, 'support': 405976}, '1': {'precision': 0.3327280980481162, 'recall': 0.0036102772229924915, 'f1-score': 0.007143048561523526, 'support': 406063}, '2': {'precision': 0.3412460156988089, 'recall': 0.7364617499029367, 'f1-score': 0.4663873563695193, 'support': 419829}, 'accuracy': 0.3386320612273393, 'macro avg': {'precision': 0.3351060901196039, 'recall': 0.3341309841669427, 'f1-score': 0.2554501362418242, 'support': 1231868}, 'weighted avg': {'precision': 0.335174968849905, 'recall': 0.3386320612273393, 'f1-score': 0.2578046990633285, 'support': 1231868}}
[[106496   1485 297995]
 [105724   1466 298873]
 [109186   1455 309188]]
Evaluating performance on  val set...
1767/1767 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.132937
{'0': {'precision': 0.33129463820509325, 'recall': 0.2747731276800851, 'f1-score': 0.30039830212815444, 'support': 150415}, '1': {'precision': 0.349438202247191, 'recall': 0.004020399325193425, 'f1-score': 0.00794933893961953, 'support': 154711}, '2': {'precision': 0.32553106581532415, 'recall': 0.7205759443353469, 'f1-score': 0.4484624476927728, 'support': 147167}, 'accuracy': 0.3272148806194215, 'macro avg': {'precision': 0.3354213020892028, 'recall': 0.3331231571135418, 'f1-score': 0.2522700295868489, 'support': 452293}, 'weighted avg': {'precision': 0.3356254619822285, 'recall': 0.3272148806194215, 'f1-score': 0.24854051208154035, 'support': 452293}}
[[ 41330    603 108482]
 [ 42856    622 111233]
 [ 40567    555 106045]]
training model: results/AAPL/W0/deepLOB_L2/h1000
Epoch 1/50
4812/4812 - 230s - loss: 3.1925 - accuracy1000: 0.4323 - val_loss: 3.4287 - val_accuracy1000: 0.3266 - 230s/epoch - 48ms/step
Epoch 2/50
4812/4812 - 224s - loss: 3.1403 - accuracy1000: 0.4526 - val_loss: 3.4613 - val_accuracy1000: 0.3278 - 224s/epoch - 46ms/step
Epoch 3/50
4812/4812 - 225s - loss: 3.1208 - accuracy1000: 0.4592 - val_loss: 3.7129 - val_accuracy1000: 0.3223 - 225s/epoch - 47ms/step
Epoch 4/50
4812/4812 - 224s - loss: 3.1040 - accuracy1000: 0.4653 - val_loss: 3.9371 - val_accuracy1000: 0.3220 - 224s/epoch - 47ms/step
Epoch 5/50
4812/4812 - 224s - loss: 3.0918 - accuracy1000: 0.4694 - val_loss: 4.0306 - val_accuracy1000: 0.3222 - 224s/epoch - 47ms/step
Epoch 6/50
4812/4812 - 222s - loss: 3.0820 - accuracy1000: 0.4725 - val_loss: 4.2160 - val_accuracy1000: 0.3218 - 222s/epoch - 46ms/step
Epoch 7/50
4812/4812 - 224s - loss: 3.0755 - accuracy1000: 0.4739 - val_loss: 4.1998 - val_accuracy1000: 0.3223 - 224s/epoch - 47ms/step
Epoch 8/50
4812/4812 - 224s - loss: 3.0690 - accuracy1000: 0.4759 - val_loss: 4.0647 - val_accuracy1000: 0.3244 - 224s/epoch - 47ms/step
Epoch 9/50
4812/4812 - 224s - loss: 3.0632 - accuracy1000: 0.4776 - val_loss: 4.0551 - val_accuracy1000: 0.3238 - 224s/epoch - 47ms/step
Epoch 10/50
4812/4812 - 224s - loss: 3.0589 - accuracy1000: 0.4784 - val_loss: 3.9438 - val_accuracy1000: 0.3263 - 224s/epoch - 47ms/step
Epoch 11/50
4812/4812 - 224s - loss: 3.0551 - accuracy1000: 0.4799 - val_loss: 4.2976 - val_accuracy1000: 0.3219 - 224s/epoch - 47ms/step
testing model: results/AAPL/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
19053/19053 - 344s - 344s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.203694
{'0': {'precision': 0.2620539847589203, 'recall': 0.37486833938345215, 'f1-score': 0.30847008613701565, 'support': 1276008}, '1': {'precision': 0.4866169873013459, 'recall': 0.021591529723357997, 'f1-score': 0.041348402449922717, 'support': 2371115}, '2': {'precision': 0.2523406697109823, 'recall': 0.6044128069913064, 'f1-score': 0.35603691527493864, 'support': 1230328}, 'accuracy': 0.2610291728199832, 'macro avg': {'precision': 0.33367054725708284, 'recall': 0.33362422536603886, 'f1-score': 0.23528513462062564, 'support': 4877451}, 'weighted avg': {'precision': 0.3687724613355346, 'recall': 0.2610291728199832, 'f1-score': 0.190610690059819, 'support': 4877451}}
[[ 478335   27442  770231]
 [ 886863   51196 1433056]
 [ 460132   26570  743626]]
Evaluating performance on  train set...
4812/4812 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1333148
{'0': {'precision': 0.33061624728525424, 'recall': 0.34884226277931013, 'f1-score': 0.339484804756166, 'support': 404971}, '1': {'precision': 0.3386841510287135, 'recall': 0.018413082384408128, 'f1-score': 0.03492728921800644, 'support': 406776}, '2': {'precision': 0.3424891080276616, 'recall': 0.6378709943087825, 'f1-score': 0.44568086228086656, 'support': 420121}, 'accuracy': 0.3383024804605688, 'macro avg': {'precision': 0.33726316878054313, 'recall': 0.33504211315750027, 'f1-score': 0.27336431875167966, 'support': 1231868}, 'weighted avg': {'precision': 0.3373295215493071, 'recall': 0.3383024804605688, 'f1-score': 0.27513416486843806, 'support': 1231868}}
[[141271   7331 256369]
 [141181   7490 258105]
 [144844   7294 267983]]
Evaluating performance on  val set...
1767/1767 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1396167
{'0': {'precision': 0.33303492578120275, 'recall': 0.36594087307917267, 'f1-score': 0.3487133365845626, 'support': 150456}, '1': {'precision': 0.3448832454535672, 'recall': 0.02050097867386493, 'f1-score': 0.038701419454557524, 'support': 156334}, '2': {'precision': 0.32151988994446806, 'recall': 0.6135887232565651, 'f1-score': 0.4219423839917199, 'support': 145503}, 'accuracy': 0.3262088955610633, 'macro avg': {'precision': 0.33314602039307933, 'recall': 0.3333435250032009, 'f1-score': 0.26978571334361334, 'support': 452293}, 'weighted avg': {'precision': 0.3334258735701515, 'recall': 0.3262088955610633, 'f1-score': 0.26511629447310253, 'support': 452293}}
[[55058  3029 92369]
 [57099  3205 96030]
 [53165  3059 89279]]
training model: results/AAPL/W0/deepOF_L2/h10
Epoch 1/50
4812/4812 - 134s - loss: 3.1117 - accuracy10: 0.4573 - val_loss: 3.1927 - val_accuracy10: 0.4340 - 134s/epoch - 28ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.0397 - accuracy10: 0.4829 - val_loss: 3.1441 - val_accuracy10: 0.4493 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 108s - loss: 3.0123 - accuracy10: 0.4909 - val_loss: 3.1281 - val_accuracy10: 0.4531 - 108s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 109s - loss: 2.9963 - accuracy10: 0.4948 - val_loss: 3.1121 - val_accuracy10: 0.4581 - 109s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 109s - loss: 2.9862 - accuracy10: 0.4982 - val_loss: 3.1047 - val_accuracy10: 0.4596 - 109s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 110s - loss: 2.9769 - accuracy10: 0.5003 - val_loss: 3.0977 - val_accuracy10: 0.4609 - 110s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 111s - loss: 2.9704 - accuracy10: 0.5020 - val_loss: 3.0939 - val_accuracy10: 0.4631 - 111s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 108s - loss: 2.9648 - accuracy10: 0.5032 - val_loss: 3.0913 - val_accuracy10: 0.4630 - 108s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 108s - loss: 2.9596 - accuracy10: 0.5050 - val_loss: 3.0821 - val_accuracy10: 0.4659 - 108s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 107s - loss: 2.9551 - accuracy10: 0.5061 - val_loss: 3.0815 - val_accuracy10: 0.4662 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 108s - loss: 2.9508 - accuracy10: 0.5072 - val_loss: 3.0788 - val_accuracy10: 0.4680 - 108s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 108s - loss: 2.9469 - accuracy10: 0.5083 - val_loss: 3.0726 - val_accuracy10: 0.4695 - 108s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 108s - loss: 2.9437 - accuracy10: 0.5091 - val_loss: 3.0716 - val_accuracy10: 0.4704 - 108s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 108s - loss: 2.9406 - accuracy10: 0.5103 - val_loss: 3.0719 - val_accuracy10: 0.4704 - 108s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 108s - loss: 2.9374 - accuracy10: 0.5112 - val_loss: 3.0676 - val_accuracy10: 0.4720 - 108s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 109s - loss: 2.9343 - accuracy10: 0.5118 - val_loss: 3.0692 - val_accuracy10: 0.4711 - 109s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 108s - loss: 2.9318 - accuracy10: 0.5127 - val_loss: 3.0652 - val_accuracy10: 0.4728 - 108s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 108s - loss: 2.9287 - accuracy10: 0.5135 - val_loss: 3.0656 - val_accuracy10: 0.4718 - 108s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 109s - loss: 2.9267 - accuracy10: 0.5140 - val_loss: 3.0611 - val_accuracy10: 0.4734 - 109s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 109s - loss: 2.9236 - accuracy10: 0.5144 - val_loss: 3.0657 - val_accuracy10: 0.4721 - 109s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 109s - loss: 2.9212 - accuracy10: 0.5153 - val_loss: 3.0603 - val_accuracy10: 0.4747 - 109s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 109s - loss: 2.9188 - accuracy10: 0.5159 - val_loss: 3.0597 - val_accuracy10: 0.4746 - 109s/epoch - 23ms/step
Epoch 23/50
4812/4812 - 108s - loss: 2.9167 - accuracy10: 0.5162 - val_loss: 3.0580 - val_accuracy10: 0.4759 - 108s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 107s - loss: 2.9147 - accuracy10: 0.5171 - val_loss: 3.0615 - val_accuracy10: 0.4739 - 107s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 107s - loss: 2.9125 - accuracy10: 0.5175 - val_loss: 3.0550 - val_accuracy10: 0.4764 - 107s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 106s - loss: 2.9100 - accuracy10: 0.5180 - val_loss: 3.0564 - val_accuracy10: 0.4750 - 106s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 108s - loss: 2.9083 - accuracy10: 0.5183 - val_loss: 3.0545 - val_accuracy10: 0.4765 - 108s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 108s - loss: 2.9059 - accuracy10: 0.5190 - val_loss: 3.0584 - val_accuracy10: 0.4755 - 108s/epoch - 23ms/step
Epoch 29/50
4812/4812 - 108s - loss: 2.9046 - accuracy10: 0.5196 - val_loss: 3.0557 - val_accuracy10: 0.4764 - 108s/epoch - 22ms/step
Epoch 30/50
4812/4812 - 107s - loss: 2.9027 - accuracy10: 0.5200 - val_loss: 3.0575 - val_accuracy10: 0.4758 - 107s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 108s - loss: 2.9010 - accuracy10: 0.5204 - val_loss: 3.0535 - val_accuracy10: 0.4772 - 108s/epoch - 22ms/step
Epoch 32/50
4812/4812 - 108s - loss: 2.8994 - accuracy10: 0.5207 - val_loss: 3.0521 - val_accuracy10: 0.4781 - 108s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 108s - loss: 2.8973 - accuracy10: 0.5215 - val_loss: 3.0528 - val_accuracy10: 0.4768 - 108s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 109s - loss: 2.8958 - accuracy10: 0.5220 - val_loss: 3.0578 - val_accuracy10: 0.4766 - 109s/epoch - 23ms/step
Epoch 35/50
4812/4812 - 107s - loss: 2.8944 - accuracy10: 0.5224 - val_loss: 3.0603 - val_accuracy10: 0.4750 - 107s/epoch - 22ms/step
Epoch 36/50
4812/4812 - 108s - loss: 2.8926 - accuracy10: 0.5224 - val_loss: 3.0558 - val_accuracy10: 0.4766 - 108s/epoch - 22ms/step
Epoch 37/50
4812/4812 - 108s - loss: 2.8904 - accuracy10: 0.5235 - val_loss: 3.0592 - val_accuracy10: 0.4763 - 108s/epoch - 22ms/step
Epoch 38/50
4812/4812 - 109s - loss: 2.8895 - accuracy10: 0.5237 - val_loss: 3.0575 - val_accuracy10: 0.4765 - 109s/epoch - 23ms/step
Epoch 39/50
4812/4812 - 108s - loss: 2.8879 - accuracy10: 0.5234 - val_loss: 3.0560 - val_accuracy10: 0.4771 - 108s/epoch - 22ms/step
Epoch 40/50
4812/4812 - 109s - loss: 2.8866 - accuracy10: 0.5244 - val_loss: 3.0563 - val_accuracy10: 0.4766 - 109s/epoch - 23ms/step
Epoch 41/50
4812/4812 - 109s - loss: 2.8852 - accuracy10: 0.5249 - val_loss: 3.0555 - val_accuracy10: 0.4773 - 109s/epoch - 23ms/step
Epoch 42/50
4812/4812 - 109s - loss: 2.8839 - accuracy10: 0.5250 - val_loss: 3.0568 - val_accuracy10: 0.4779 - 109s/epoch - 23ms/step
testing model: results/AAPL/W0/deepOF_L2/h10
Evaluating performance on  test set...
19053/19053 - 147s - 147s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9885838
{'0': {'precision': 0.3875083396737405, 'recall': 0.6324388507906632, 'f1-score': 0.48056474159896523, 'support': 1177366}, '1': {'precision': 0.6886946215241693, 'recall': 0.40652291105121297, 'f1-score': 0.5112594238862748, 'support': 2541350}, '2': {'precision': 0.4194933503869696, 'recall': 0.5270408119233989, 'f1-score': 0.4671571820392889, 'support': 1158730}, 'accuracy': 0.48968804575181357, 'macro avg': {'precision': 0.49856543719495977, 'recall': 0.5220008579217584, 'f1-score': 0.4863271158415096, 'support': 4877446}, 'weighted avg': {'precision': 0.5520374290464013, 'recall': 0.48968804575181357, 'f1-score': 0.49337271309516845, 'support': 4877446}}
[[ 744612  219889  212865]
 [ 875997 1033117  632236]
 [ 300929  247103  610698]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0015596
{'0': {'precision': 0.4715301310143037, 'recall': 0.611491595863714, 'f1-score': 0.5324670875125268, 'support': 406645}, '1': {'precision': 0.5331507403200031, 'recall': 0.2721367059372735, 'f1-score': 0.3603430971463336, 'support': 407005}, '2': {'precision': 0.48818170106205666, 'recall': 0.5798783884920986, 'f1-score': 0.5300938044063918, 'support': 418217}, 'accuracy': 0.48863716618758357, 'macro avg': {'precision': 0.4976208574654544, 'recall': 0.48783556343102874, 'f1-score': 0.4743013296884174, 'support': 1231867}, 'weighted avg': {'precision': 0.49754257047499817, 'recall': 0.48863716618758357, 'f1-score': 0.474792133934104, 'support': 1231867}}
[[248660  45260 112725]
 [154712 110761 141532]
 [123975  51727 242515]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0161765
{'0': {'precision': 0.46820843629521086, 'recall': 0.585819633313037, 'f1-score': 0.5204523529747648, 'support': 147810}, '1': {'precision': 0.5359645988511118, 'recall': 0.2535068446848065, 'f1-score': 0.34420673586104644, 'support': 153842}, '2': {'precision': 0.4651057619174872, 'recall': 0.6007926129008703, 'f1-score': 0.5243128474143249, 'support': 150641}, 'accuracy': 0.47777436307880067, 'macro avg': {'precision': 0.48975959902127, 'recall': 0.48003969696623794, 'f1-score': 0.4629906454167121, 'support': 452293}, 'weighted avg': {'precision': 0.4902214977155517, 'recall': 0.47777436307880067, 'f1-score': 0.46179031424071654, 'support': 452293}}
[[86590 16236 44984]
 [55742 39000 59100]
 [42607 17530 90504]]
training model: results/AAPL/W0/deepOF_L2/h20
Epoch 1/50
4812/4812 - 111s - loss: 3.1788 - accuracy20: 0.4315 - val_loss: 3.2438 - val_accuracy20: 0.4073 - 111s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 110s - loss: 3.1305 - accuracy20: 0.4510 - val_loss: 3.2137 - val_accuracy20: 0.4160 - 110s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 108s - loss: 3.1097 - accuracy20: 0.4585 - val_loss: 3.1983 - val_accuracy20: 0.4203 - 108s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 107s - loss: 3.0973 - accuracy20: 0.4628 - val_loss: 3.1877 - val_accuracy20: 0.4259 - 107s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 107s - loss: 3.0894 - accuracy20: 0.4653 - val_loss: 3.1799 - val_accuracy20: 0.4288 - 107s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 107s - loss: 3.0832 - accuracy20: 0.4671 - val_loss: 3.1764 - val_accuracy20: 0.4302 - 107s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 107s - loss: 3.0781 - accuracy20: 0.4690 - val_loss: 3.1717 - val_accuracy20: 0.4314 - 107s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 108s - loss: 3.0741 - accuracy20: 0.4701 - val_loss: 3.1714 - val_accuracy20: 0.4322 - 108s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 108s - loss: 3.0701 - accuracy20: 0.4715 - val_loss: 3.1654 - val_accuracy20: 0.4332 - 108s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 109s - loss: 3.0671 - accuracy20: 0.4728 - val_loss: 3.1664 - val_accuracy20: 0.4331 - 109s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.0638 - accuracy20: 0.4733 - val_loss: 3.1631 - val_accuracy20: 0.4337 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 107s - loss: 3.0616 - accuracy20: 0.4740 - val_loss: 3.1626 - val_accuracy20: 0.4346 - 107s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 107s - loss: 3.0592 - accuracy20: 0.4747 - val_loss: 3.1593 - val_accuracy20: 0.4355 - 107s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 107s - loss: 3.0565 - accuracy20: 0.4758 - val_loss: 3.1556 - val_accuracy20: 0.4366 - 107s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.0543 - accuracy20: 0.4763 - val_loss: 3.1565 - val_accuracy20: 0.4361 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 107s - loss: 3.0518 - accuracy20: 0.4773 - val_loss: 3.1568 - val_accuracy20: 0.4361 - 107s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 107s - loss: 3.0500 - accuracy20: 0.4778 - val_loss: 3.1553 - val_accuracy20: 0.4377 - 107s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 107s - loss: 3.0483 - accuracy20: 0.4783 - val_loss: 3.1537 - val_accuracy20: 0.4378 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 108s - loss: 3.0466 - accuracy20: 0.4785 - val_loss: 3.1541 - val_accuracy20: 0.4375 - 108s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 109s - loss: 3.0454 - accuracy20: 0.4795 - val_loss: 3.1529 - val_accuracy20: 0.4385 - 109s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 107s - loss: 3.0434 - accuracy20: 0.4800 - val_loss: 3.1530 - val_accuracy20: 0.4379 - 107s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 108s - loss: 3.0415 - accuracy20: 0.4804 - val_loss: 3.1561 - val_accuracy20: 0.4377 - 108s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 107s - loss: 3.0396 - accuracy20: 0.4812 - val_loss: 3.1553 - val_accuracy20: 0.4383 - 107s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 107s - loss: 3.0387 - accuracy20: 0.4814 - val_loss: 3.1516 - val_accuracy20: 0.4391 - 107s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 108s - loss: 3.0369 - accuracy20: 0.4822 - val_loss: 3.1524 - val_accuracy20: 0.4386 - 108s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 107s - loss: 3.0356 - accuracy20: 0.4826 - val_loss: 3.1520 - val_accuracy20: 0.4394 - 107s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 106s - loss: 3.0337 - accuracy20: 0.4830 - val_loss: 3.1561 - val_accuracy20: 0.4380 - 106s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 107s - loss: 3.0330 - accuracy20: 0.4831 - val_loss: 3.1538 - val_accuracy20: 0.4389 - 107s/epoch - 22ms/step
Epoch 29/50
4812/4812 - 107s - loss: 3.0315 - accuracy20: 0.4836 - val_loss: 3.1517 - val_accuracy20: 0.4395 - 107s/epoch - 22ms/step
Epoch 30/50
4812/4812 - 107s - loss: 3.0298 - accuracy20: 0.4843 - val_loss: 3.1532 - val_accuracy20: 0.4398 - 107s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 108s - loss: 3.0284 - accuracy20: 0.4853 - val_loss: 3.1510 - val_accuracy20: 0.4394 - 108s/epoch - 22ms/step
Epoch 32/50
4812/4812 - 108s - loss: 3.0272 - accuracy20: 0.4850 - val_loss: 3.1528 - val_accuracy20: 0.4398 - 108s/epoch - 22ms/step
Epoch 33/50
4812/4812 - 107s - loss: 3.0258 - accuracy20: 0.4854 - val_loss: 3.1509 - val_accuracy20: 0.4398 - 107s/epoch - 22ms/step
Epoch 34/50
4812/4812 - 107s - loss: 3.0248 - accuracy20: 0.4856 - val_loss: 3.1507 - val_accuracy20: 0.4394 - 107s/epoch - 22ms/step
Epoch 35/50
4812/4812 - 107s - loss: 3.0233 - accuracy20: 0.4863 - val_loss: 3.1520 - val_accuracy20: 0.4397 - 107s/epoch - 22ms/step
Epoch 36/50
4812/4812 - 107s - loss: 3.0216 - accuracy20: 0.4869 - val_loss: 3.1513 - val_accuracy20: 0.4398 - 107s/epoch - 22ms/step
Epoch 37/50
4812/4812 - 107s - loss: 3.0205 - accuracy20: 0.4872 - val_loss: 3.1537 - val_accuracy20: 0.4399 - 107s/epoch - 22ms/step
Epoch 38/50
4812/4812 - 108s - loss: 3.0194 - accuracy20: 0.4877 - val_loss: 3.1548 - val_accuracy20: 0.4395 - 108s/epoch - 22ms/step
Epoch 39/50
4812/4812 - 107s - loss: 3.0177 - accuracy20: 0.4882 - val_loss: 3.1544 - val_accuracy20: 0.4396 - 107s/epoch - 22ms/step
Epoch 40/50
4812/4812 - 107s - loss: 3.0167 - accuracy20: 0.4886 - val_loss: 3.1561 - val_accuracy20: 0.4397 - 107s/epoch - 22ms/step
Epoch 41/50
4812/4812 - 108s - loss: 3.0154 - accuracy20: 0.4886 - val_loss: 3.1532 - val_accuracy20: 0.4408 - 108s/epoch - 22ms/step
Epoch 42/50
4812/4812 - 108s - loss: 3.0144 - accuracy20: 0.4894 - val_loss: 3.1548 - val_accuracy20: 0.4402 - 108s/epoch - 22ms/step
Epoch 43/50
4812/4812 - 107s - loss: 3.0133 - accuracy20: 0.4898 - val_loss: 3.1552 - val_accuracy20: 0.4402 - 107s/epoch - 22ms/step
Epoch 44/50
4812/4812 - 107s - loss: 3.0116 - accuracy20: 0.4903 - val_loss: 3.1504 - val_accuracy20: 0.4414 - 107s/epoch - 22ms/step
Epoch 45/50
4812/4812 - 107s - loss: 3.0105 - accuracy20: 0.4903 - val_loss: 3.1573 - val_accuracy20: 0.4398 - 107s/epoch - 22ms/step
Epoch 46/50
4812/4812 - 107s - loss: 3.0092 - accuracy20: 0.4906 - val_loss: 3.1567 - val_accuracy20: 0.4395 - 107s/epoch - 22ms/step
Epoch 47/50
4812/4812 - 107s - loss: 3.0087 - accuracy20: 0.4911 - val_loss: 3.1535 - val_accuracy20: 0.4401 - 107s/epoch - 22ms/step
Epoch 48/50
4812/4812 - 106s - loss: 3.0071 - accuracy20: 0.4913 - val_loss: 3.1563 - val_accuracy20: 0.4404 - 106s/epoch - 22ms/step
Epoch 49/50
4812/4812 - 107s - loss: 3.0058 - accuracy20: 0.4919 - val_loss: 3.1552 - val_accuracy20: 0.4407 - 107s/epoch - 22ms/step
Epoch 50/50
4812/4812 - 107s - loss: 3.0047 - accuracy20: 0.4925 - val_loss: 3.1527 - val_accuracy20: 0.4412 - 107s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h20
Evaluating performance on  test set...
19053/19053 - 146s - 146s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0287797
{'0': {'precision': 0.37792282753158507, 'recall': 0.6261939748711128, 'f1-score': 0.47136547660642447, 'support': 1247409}, '1': {'precision': 0.6430060577658341, 'recall': 0.2565532324271533, 'f1-score': 0.36676911547358854, 'support': 2395955}, '2': {'precision': 0.39005751086753737, 'recall': 0.5861871415351654, 'f1-score': 0.46842089586257984, 'support': 1234082}, 'accuracy': 0.4344923552203346, 'macro avg': {'precision': 0.47032879872165223, 'recall': 0.48964478294447716, 'f1-score': 0.4355184959808643, 'support': 4877446}, 'weighted avg': {'precision': 0.5112103483317126, 'recall': 0.4344923552203346, 'f1-score': 0.41923941954058525, 'support': 4877446}}
[[781120 168904 297385]
 [947447 614690 833818]
 [338310 172369 723403]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0352803
{'0': {'precision': 0.4469530170631045, 'recall': 0.6240879589695196, 'f1-score': 0.5208726881905689, 'support': 406917}, '1': {'precision': 0.48629669121322183, 'recall': 0.14356965256719567, 'f1-score': 0.22168972097483172, 'support': 406611}, '2': {'precision': 0.4589818960411156, 'recall': 0.5964540719368742, 'f1-score': 0.5187650016580438, 'support': 418339}, 'accuracy': 0.4560955038165646, 'macro avg': {'precision': 0.46407720143914727, 'recall': 0.4547038944911965, 'f1-score': 0.4204424702744815, 'support': 1231867}, 'weighted avg': {'precision': 0.4640244378355057, 'recall': 0.4560955038165646, 'f1-score': 0.4214034979623315, 'support': 1231867}}
[[253952  29936 123029]
 [177145  58377 171089]
 [137088  31731 249520]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0490717
{'0': {'precision': 0.439390178518239, 'recall': 0.5987944145265608, 'f1-score': 0.5068547278724574, 'support': 147812}, '1': {'precision': 0.48379507971068897, 'recall': 0.12534853259671375, 'f1-score': 0.1991090511136861, 'support': 154218}, '2': {'precision': 0.43383594120436225, 'recall': 0.6089057186399846, 'f1-score': 0.5066742717277241, 'support': 150263}, 'accuracy': 0.44072315954480834, 'macro avg': {'precision': 0.4523403998110967, 'recall': 0.44434955525441966, 'f1-score': 0.40421268357128914, 'support': 452293}, 'weighted avg': {'precision': 0.45268562790746714, 'recall': 0.44072315954480834, 'f1-score': 0.401862966646747, 'support': 452293}}
[[88509 10200 49103]
 [64586 19331 70301]
 [48341 10426 91496]]
training model: results/AAPL/W0/deepOF_L2/h30
Epoch 1/50
4812/4812 - 109s - loss: 3.2117 - accuracy30: 0.4170 - val_loss: 3.2623 - val_accuracy30: 0.3975 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.1775 - accuracy30: 0.4319 - val_loss: 3.2481 - val_accuracy30: 0.3995 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 107s - loss: 3.1600 - accuracy30: 0.4394 - val_loss: 3.2343 - val_accuracy30: 0.4022 - 107s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 108s - loss: 3.1499 - accuracy30: 0.4436 - val_loss: 3.2199 - val_accuracy30: 0.4074 - 108s/epoch - 23ms/step
Epoch 5/50
4812/4812 - 107s - loss: 3.1433 - accuracy30: 0.4464 - val_loss: 3.2131 - val_accuracy30: 0.4104 - 107s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 106s - loss: 3.1386 - accuracy30: 0.4478 - val_loss: 3.2179 - val_accuracy30: 0.4081 - 106s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 106s - loss: 3.1347 - accuracy30: 0.4494 - val_loss: 3.2156 - val_accuracy30: 0.4090 - 106s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 107s - loss: 3.1311 - accuracy30: 0.4504 - val_loss: 3.1995 - val_accuracy30: 0.4154 - 107s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 107s - loss: 3.1279 - accuracy30: 0.4514 - val_loss: 3.2031 - val_accuracy30: 0.4148 - 107s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.1256 - accuracy30: 0.4527 - val_loss: 3.1977 - val_accuracy30: 0.4169 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 109s - loss: 3.1231 - accuracy30: 0.4534 - val_loss: 3.1994 - val_accuracy30: 0.4158 - 109s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 109s - loss: 3.1212 - accuracy30: 0.4544 - val_loss: 3.1935 - val_accuracy30: 0.4190 - 109s/epoch - 23ms/step
Epoch 13/50
4812/4812 - 108s - loss: 3.1188 - accuracy30: 0.4554 - val_loss: 3.1966 - val_accuracy30: 0.4184 - 108s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 109s - loss: 3.1172 - accuracy30: 0.4559 - val_loss: 3.1931 - val_accuracy30: 0.4197 - 109s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.1153 - accuracy30: 0.4561 - val_loss: 3.1948 - val_accuracy30: 0.4189 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 109s - loss: 3.1134 - accuracy30: 0.4573 - val_loss: 3.1921 - val_accuracy30: 0.4200 - 109s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 108s - loss: 3.1116 - accuracy30: 0.4579 - val_loss: 3.1964 - val_accuracy30: 0.4188 - 108s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 108s - loss: 3.1100 - accuracy30: 0.4582 - val_loss: 3.1939 - val_accuracy30: 0.4187 - 108s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 107s - loss: 3.1083 - accuracy30: 0.4587 - val_loss: 3.1922 - val_accuracy30: 0.4205 - 107s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 107s - loss: 3.1065 - accuracy30: 0.4598 - val_loss: 3.1940 - val_accuracy30: 0.4208 - 107s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 108s - loss: 3.1052 - accuracy30: 0.4605 - val_loss: 3.1963 - val_accuracy30: 0.4190 - 108s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 107s - loss: 3.1036 - accuracy30: 0.4608 - val_loss: 3.1925 - val_accuracy30: 0.4209 - 107s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 107s - loss: 3.1018 - accuracy30: 0.4614 - val_loss: 3.1942 - val_accuracy30: 0.4205 - 107s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 107s - loss: 3.1006 - accuracy30: 0.4618 - val_loss: 3.1922 - val_accuracy30: 0.4216 - 107s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 109s - loss: 3.0990 - accuracy30: 0.4627 - val_loss: 3.1924 - val_accuracy30: 0.4219 - 109s/epoch - 23ms/step
Epoch 26/50
4812/4812 - 108s - loss: 3.0974 - accuracy30: 0.4630 - val_loss: 3.1896 - val_accuracy30: 0.4223 - 108s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 108s - loss: 3.0963 - accuracy30: 0.4633 - val_loss: 3.1918 - val_accuracy30: 0.4210 - 108s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 107s - loss: 3.0948 - accuracy30: 0.4641 - val_loss: 3.1919 - val_accuracy30: 0.4216 - 107s/epoch - 22ms/step
Epoch 29/50
4812/4812 - 106s - loss: 3.0930 - accuracy30: 0.4646 - val_loss: 3.1951 - val_accuracy30: 0.4208 - 106s/epoch - 22ms/step
Epoch 30/50
4812/4812 - 107s - loss: 3.0912 - accuracy30: 0.4654 - val_loss: 3.1927 - val_accuracy30: 0.4219 - 107s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 107s - loss: 3.0900 - accuracy30: 0.4656 - val_loss: 3.1948 - val_accuracy30: 0.4214 - 107s/epoch - 22ms/step
Epoch 32/50
4812/4812 - 106s - loss: 3.0885 - accuracy30: 0.4664 - val_loss: 3.1962 - val_accuracy30: 0.4210 - 106s/epoch - 22ms/step
Epoch 33/50
4812/4812 - 107s - loss: 3.0874 - accuracy30: 0.4663 - val_loss: 3.1932 - val_accuracy30: 0.4225 - 107s/epoch - 22ms/step
Epoch 34/50
4812/4812 - 107s - loss: 3.0856 - accuracy30: 0.4673 - val_loss: 3.1935 - val_accuracy30: 0.4214 - 107s/epoch - 22ms/step
Epoch 35/50
4812/4812 - 107s - loss: 3.0846 - accuracy30: 0.4676 - val_loss: 3.1971 - val_accuracy30: 0.4223 - 107s/epoch - 22ms/step
Epoch 36/50
4812/4812 - 108s - loss: 3.0827 - accuracy30: 0.4681 - val_loss: 3.1951 - val_accuracy30: 0.4217 - 108s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h30
Evaluating performance on  test set...
19053/19053 - 146s - 146s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0557132
{'0': {'precision': 0.35849320336826745, 'recall': 0.6894218166962559, 'f1-score': 0.4717043477899445, 'support': 1316918}, '1': {'precision': 0.5618370029017826, 'recall': 0.16099936008808302, 'f1-score': 0.2502790467453604, 'support': 2259686}, '2': {'precision': 0.3993554601772779, 'recall': 0.5210778864766051, 'f1-score': 0.4521681008159291, 'support': 1300842}, 'accuracy': 0.39970919206486344, 'macro avg': {'precision': 0.4398952221491093, 'recall': 0.45716635442031467, 'f1-score': 0.39138383178374464, 'support': 4877446}, 'weighted avg': {'precision': 0.4635991290647564, 'recall': 0.3997091920648634, 'f1-score': 0.3639091567406937, 'support': 4877446}}
[[ 907912  126697  282309]
 [1158692  363808  737186]
 [ 465974  157028  677840]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0569942
{'0': {'precision': 0.4181154638191634, 'recall': 0.6483265032375147, 'f1-score': 0.5083733479760987, 'support': 405558}, '1': {'precision': 0.4174850524928205, 'recall': 0.10892122808138079, 'f1-score': 0.17276763709405607, 'support': 407074}, '2': {'precision': 0.45130000181156865, 'recall': 0.5348050616002957, 'f1-score': 0.4895168562140163, 'support': 419235}, 'accuracy': 0.4314443036464164, 'macro avg': {'precision': 0.4289668393745176, 'recall': 0.43068426430639706, 'f1-score': 0.39021928042805704, 'support': 1231867}, 'weighted avg': {'precision': 0.4292006667874922, 'recall': 0.4314443036464164, 'f1-score': 0.39105414024062624, 'support': 1231867}}
[[262934  28018 114606]
 [204743  44339 157992]
 [161178  33848 224209]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0627389
{'0': {'precision': 0.41443745974728097, 'recall': 0.6205627279333366, 'f1-score': 0.49697467428459546, 'support': 147247}, '1': {'precision': 0.432011587905124, 'recall': 0.09245911803456561, 'f1-score': 0.15231893772543012, 'support': 154836}, '2': {'precision': 0.42819104760083154, 'recall': 0.5663404566939618, 'f1-score': 0.4876706517657783, 'support': 150210}, 'accuracy': 0.4217664213242301, 'macro avg': {'precision': 0.4248800317510788, 'recall': 0.42645410088728797, 'f1-score': 0.3789880879252679, 'support': 452293}, 'weighted avg': {'precision': 0.42502138242335513, 'recall': 0.4217664213242301, 'f1-score': 0.3758968047433325, 'support': 452293}}
[[91376  8911 46960]
 [73877 14316 66643]
 [55229  9911 85070]]
training model: results/AAPL/W0/deepOF_L2/h50
Epoch 1/50
4812/4812 - 110s - loss: 3.1965 - accuracy50: 0.4285 - val_loss: 3.2624 - val_accuracy50: 0.3724 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.1679 - accuracy50: 0.4402 - val_loss: 3.2453 - val_accuracy50: 0.3808 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 106s - loss: 3.1547 - accuracy50: 0.4455 - val_loss: 3.2384 - val_accuracy50: 0.3851 - 106s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 106s - loss: 3.1464 - accuracy50: 0.4495 - val_loss: 3.2301 - val_accuracy50: 0.3909 - 106s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 106s - loss: 3.1406 - accuracy50: 0.4515 - val_loss: 3.2258 - val_accuracy50: 0.3938 - 106s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 106s - loss: 3.1369 - accuracy50: 0.4529 - val_loss: 3.2235 - val_accuracy50: 0.3953 - 106s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 106s - loss: 3.1336 - accuracy50: 0.4542 - val_loss: 3.2211 - val_accuracy50: 0.3976 - 106s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 105s - loss: 3.1311 - accuracy50: 0.4552 - val_loss: 3.2211 - val_accuracy50: 0.3985 - 105s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 107s - loss: 3.1283 - accuracy50: 0.4562 - val_loss: 3.2187 - val_accuracy50: 0.4000 - 107s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 106s - loss: 3.1260 - accuracy50: 0.4574 - val_loss: 3.2213 - val_accuracy50: 0.3998 - 106s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.1240 - accuracy50: 0.4579 - val_loss: 3.2232 - val_accuracy50: 0.3990 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 107s - loss: 3.1220 - accuracy50: 0.4589 - val_loss: 3.2211 - val_accuracy50: 0.4000 - 107s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 106s - loss: 3.1202 - accuracy50: 0.4595 - val_loss: 3.2240 - val_accuracy50: 0.3993 - 106s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 107s - loss: 3.1181 - accuracy50: 0.4602 - val_loss: 3.2262 - val_accuracy50: 0.3993 - 107s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.1165 - accuracy50: 0.4610 - val_loss: 3.2260 - val_accuracy50: 0.3993 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 107s - loss: 3.1147 - accuracy50: 0.4614 - val_loss: 3.2297 - val_accuracy50: 0.3980 - 107s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 108s - loss: 3.1129 - accuracy50: 0.4620 - val_loss: 3.2293 - val_accuracy50: 0.3993 - 108s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 106s - loss: 3.1114 - accuracy50: 0.4632 - val_loss: 3.2282 - val_accuracy50: 0.4000 - 106s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.1093 - accuracy50: 0.4637 - val_loss: 3.2290 - val_accuracy50: 0.3994 - 106s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h50
Evaluating performance on  test set...
19053/19053 - 143s - 143s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0533305
{'0': {'precision': 0.3155972392960262, 'recall': 0.5883777367868078, 'f1-score': 0.4108308179011918, 'support': 1133583}, '1': {'precision': 0.5855044620955934, 'recall': 0.23778096146271058, 'f1-score': 0.3382103216064966, 'support': 2630076}, '2': {'precision': 0.3334722906854155, 'recall': 0.5077784172377663, 'f1-score': 0.4025673449355477, 'support': 1113787}, 'accuracy': 0.3809194402152274, 'macro avg': {'precision': 0.4115246640256784, 'recall': 0.44464570516242824, 'f1-score': 0.38386949481441207, 'support': 4877446}, 'weighted avg': {'precision': 0.4652217576963587, 'recall': 0.3809194402152274, 'f1-score': 0.36978450530711027, 'support': 4877446}}
[[ 666975  219603  247005]
 [1121292  625382  883402]
 [ 325107  223123  565557]]
Evaluating performance on  train set...
4812/4812 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0747803
{'0': {'precision': 0.41801271427511316, 'recall': 0.49945076867755933, 'f1-score': 0.45511734328606085, 'support': 406022}, '1': {'precision': 0.3476208317721993, 'recall': 0.2625075962042352, 'f1-score': 0.29912754349666665, 'support': 406453}, '2': {'precision': 0.43216130675203723, 'recall': 0.4531989165267816, 'f1-score': 0.4424301675977653, 'support': 419392}, 'accuracy': 0.405525109447692, 'macro avg': {'precision': 0.3992649509331166, 'recall': 0.405052427136192, 'f1-score': 0.3988916847934976, 'support': 1231867}, 'weighted avg': {'precision': 0.39960392069360257, 'recall': 0.405525109447692, 'f1-score': 0.39932932227400003, 'support': 1231867}}
[[202788  96832 106402]
 [156418 106697 143338]
 [125918 103406 190068]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723866
{'0': {'precision': 0.40162242146696375, 'recall': 0.48460832745236415, 'f1-score': 0.43923000905081566, 'support': 141700}, '1': {'precision': 0.3943270406603485, 'recall': 0.24665057188273118, 'f1-score': 0.30347702691773215, 'support': 167342}, '2': {'precision': 0.4011050599517669, 'recall': 0.494600386733775, 'f1-score': 0.44297311913671134, 'support': 143251}, 'accuracy': 0.3997320321119274, 'macro avg': {'precision': 0.3990181740263597, 'recall': 0.4086197620229568, 'f1-score': 0.3952267183684197, 'support': 452293}, 'weighted avg': {'precision': 0.39875937435070485, 'recall': 0.3997320321119274, 'f1-score': 0.3901888537085932, 'support': 452293}}
[[68669 31760 41271]
 [61548 41275 64519]
 [40762 31637 70852]]
training model: results/AAPL/W0/deepOF_L2/h100
Epoch 1/50
4812/4812 - 109s - loss: 3.2558 - accuracy100: 0.3938 - val_loss: 3.3164 - val_accuracy100: 0.3714 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.2343 - accuracy100: 0.4072 - val_loss: 3.2985 - val_accuracy100: 0.3759 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 107s - loss: 3.2245 - accuracy100: 0.4126 - val_loss: 3.2861 - val_accuracy100: 0.3771 - 107s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 107s - loss: 3.2175 - accuracy100: 0.4162 - val_loss: 3.2813 - val_accuracy100: 0.3788 - 107s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 107s - loss: 3.2139 - accuracy100: 0.4180 - val_loss: 3.2784 - val_accuracy100: 0.3792 - 107s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 106s - loss: 3.2109 - accuracy100: 0.4191 - val_loss: 3.2751 - val_accuracy100: 0.3806 - 106s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 105s - loss: 3.2085 - accuracy100: 0.4207 - val_loss: 3.2742 - val_accuracy100: 0.3811 - 105s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 107s - loss: 3.2060 - accuracy100: 0.4219 - val_loss: 3.2742 - val_accuracy100: 0.3806 - 107s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 106s - loss: 3.2044 - accuracy100: 0.4229 - val_loss: 3.2735 - val_accuracy100: 0.3810 - 106s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.2024 - accuracy100: 0.4238 - val_loss: 3.2770 - val_accuracy100: 0.3794 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.2006 - accuracy100: 0.4247 - val_loss: 3.2733 - val_accuracy100: 0.3808 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 106s - loss: 3.1987 - accuracy100: 0.4255 - val_loss: 3.2744 - val_accuracy100: 0.3802 - 106s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 107s - loss: 3.1971 - accuracy100: 0.4268 - val_loss: 3.2750 - val_accuracy100: 0.3807 - 107s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 107s - loss: 3.1953 - accuracy100: 0.4280 - val_loss: 3.2752 - val_accuracy100: 0.3801 - 107s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.1933 - accuracy100: 0.4291 - val_loss: 3.2747 - val_accuracy100: 0.3809 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 106s - loss: 3.1913 - accuracy100: 0.4298 - val_loss: 3.2754 - val_accuracy100: 0.3806 - 106s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 105s - loss: 3.1893 - accuracy100: 0.4307 - val_loss: 3.2760 - val_accuracy100: 0.3804 - 105s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 106s - loss: 3.1879 - accuracy100: 0.4319 - val_loss: 3.2797 - val_accuracy100: 0.3799 - 106s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.1855 - accuracy100: 0.4333 - val_loss: 3.2788 - val_accuracy100: 0.3807 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 107s - loss: 3.1836 - accuracy100: 0.4343 - val_loss: 3.2756 - val_accuracy100: 0.3804 - 107s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 107s - loss: 3.1815 - accuracy100: 0.4354 - val_loss: 3.2784 - val_accuracy100: 0.3798 - 107s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h100
Evaluating performance on  test set...
19053/19053 - 145s - 145s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989724
{'0': {'precision': 0.3355337481125525, 'recall': 0.7061058521664758, 'f1-score': 0.4549027189023155, 'support': 1379660}, '1': {'precision': 0.5266989320427183, 'recall': 0.042881712886611606, 'f1-score': 0.07930660068107866, 'support': 2149541}, '2': {'precision': 0.3609466567577167, 'recall': 0.4816335309977044, 'f1-score': 0.4126468087486003, 'support': 1348245}, 'accuracy': 0.3517664777836597, 'macro avg': {'precision': 0.4077264456376625, 'recall': 0.4102070320169306, 'f1-score': 0.31561870944399817, 'support': 4877446}, 'weighted avg': {'precision': 0.42680697341258284, 'recall': 0.3517664777836597, 'f1-score': 0.2776930531996934, 'support': 4877446}}
[[ 974186   37662  367812]
 [1275490   92176  781875]
 [ 653716   45169  649360]]
Evaluating performance on  train set...
4812/4812 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879631
{'0': {'precision': 0.37907178368712663, 'recall': 0.6853566302713241, 'f1-score': 0.48814811196667374, 'support': 408294}, '1': {'precision': 0.3770987470508739, 'recall': 0.04056674675044662, 'f1-score': 0.07325321147454181, 'support': 405825}, '2': {'precision': 0.4114394915781521, 'recall': 0.4432241446996754, 'f1-score': 0.42674078786034975, 'support': 417748}, 'accuracy': 0.39082628238275724, 'macro avg': {'precision': 0.3892033407720508, 'recall': 0.3897158405738154, 'f1-score': 0.3293807037671884, 'support': 1231867}, 'weighted avg': {'precision': 0.3893982537063355, 'recall': 0.39082628238275724, 'f1-score': 0.33064124651529947, 'support': 1231867}}
[[279827  12496 115971]
 [240469  16463 148893]
 [217894  14698 185156]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0905529
{'0': {'precision': 0.3758698309590591, 'recall': 0.6455496670743307, 'f1-score': 0.4751086986416107, 'support': 147180}, '1': {'precision': 0.38930348258706465, 'recall': 0.03383159862410112, 'f1-score': 0.062253212984141285, 'support': 157279}, '2': {'precision': 0.38659965778117367, 'recall': 0.48600457269640274, 'f1-score': 0.43064013426036923, 'support': 147834}, 'accuracy': 0.38068464468828833, 'macro avg': {'precision': 0.38392432377576585, 'recall': 0.3884619461316115, 'f1-score': 0.32266734862870705, 'support': 452293}, 'weighted avg': {'precision': 0.3840483004751064, 'recall': 0.38068464468828833, 'f1-score': 0.31700883046886075, 'support': 452293}}
[[95012  3982 48186]
 [86146  5321 65812]
 [71621  4365 71848]]
training model: results/AAPL/W0/deepOF_L2/h200
Epoch 1/50
4812/4812 - 109s - loss: 3.2567 - accuracy200: 0.3915 - val_loss: 3.3259 - val_accuracy200: 0.3572 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.2380 - accuracy200: 0.4023 - val_loss: 3.3035 - val_accuracy200: 0.3596 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 107s - loss: 3.2273 - accuracy200: 0.4080 - val_loss: 3.2935 - val_accuracy200: 0.3610 - 107s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 107s - loss: 3.2230 - accuracy200: 0.4109 - val_loss: 3.2904 - val_accuracy200: 0.3623 - 107s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 106s - loss: 3.2206 - accuracy200: 0.4124 - val_loss: 3.2875 - val_accuracy200: 0.3628 - 106s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 106s - loss: 3.2187 - accuracy200: 0.4138 - val_loss: 3.2865 - val_accuracy200: 0.3637 - 106s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 106s - loss: 3.2170 - accuracy200: 0.4150 - val_loss: 3.2874 - val_accuracy200: 0.3638 - 106s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 107s - loss: 3.2154 - accuracy200: 0.4157 - val_loss: 3.2860 - val_accuracy200: 0.3642 - 107s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 106s - loss: 3.2142 - accuracy200: 0.4168 - val_loss: 3.2867 - val_accuracy200: 0.3647 - 106s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 106s - loss: 3.2128 - accuracy200: 0.4177 - val_loss: 3.2870 - val_accuracy200: 0.3643 - 106s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.2116 - accuracy200: 0.4183 - val_loss: 3.2871 - val_accuracy200: 0.3642 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 106s - loss: 3.2102 - accuracy200: 0.4196 - val_loss: 3.2896 - val_accuracy200: 0.3644 - 106s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 106s - loss: 3.2091 - accuracy200: 0.4201 - val_loss: 3.2885 - val_accuracy200: 0.3643 - 106s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 106s - loss: 3.2077 - accuracy200: 0.4212 - val_loss: 3.2909 - val_accuracy200: 0.3638 - 106s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 106s - loss: 3.2065 - accuracy200: 0.4221 - val_loss: 3.2917 - val_accuracy200: 0.3633 - 106s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 106s - loss: 3.2053 - accuracy200: 0.4227 - val_loss: 3.2922 - val_accuracy200: 0.3629 - 106s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 106s - loss: 3.2034 - accuracy200: 0.4241 - val_loss: 3.2946 - val_accuracy200: 0.3629 - 106s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 108s - loss: 3.2021 - accuracy200: 0.4246 - val_loss: 3.2971 - val_accuracy200: 0.3624 - 108s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h200
Evaluating performance on  test set...
19053/19053 - 145s - 145s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1046115
{'0': {'precision': 0.29460187170777485, 'recall': 0.6131983330115209, 'f1-score': 0.3979936900083444, 'support': 1242960}, '1': {'precision': 0.5508955950560761, 'recall': 0.026635527527577134, 'f1-score': 0.05081421316757423, 'support': 2421390}, '2': {'precision': 0.29566444584226975, 'recall': 0.5296720127673326, 'f1-score': 0.3794941578052589, 'support': 1213096}, 'accuracy': 0.30122711763492616, 'macro avg': {'precision': 0.38038730420204026, 'recall': 0.3898352911021436, 'f1-score': 0.27610068699372586, 'support': 4877446}, 'weighted avg': {'precision': 0.4221022198839725, 'recall': 0.30122711763492616, 'f1-score': 0.2210366059227581, 'support': 4877446}}
[[ 762181   25607  455172]
 [1281393   64495 1075502]
 [ 543582   26971  642543]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931125
{'0': {'precision': 0.36909688100084564, 'recall': 0.580878243904352, 'f1-score': 0.45138097292335055, 'support': 407996}, '1': {'precision': 0.3671439753211474, 'recall': 0.01957150816461273, 'f1-score': 0.037162004716321646, 'support': 407429}, '2': {'precision': 0.37999052901940145, 'recall': 0.518329083041576, 'f1-score': 0.43850794266693616, 'support': 416442}, 'accuracy': 0.37408583881214447, 'macro avg': {'precision': 0.37207712844713153, 'recall': 0.3729262783701803, 'f1-score': 0.30901697343553614, 'support': 1231867}, 'weighted avg': {'precision': 0.3721336553928617, 'recall': 0.37408583881214447, 'f1-score': 0.3100299257212879, 'support': 1231867}}
[[236996   6658 164342]
 [211600   7974 187855]
 [193501   7087 215854]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948478
{'0': {'precision': 0.364669691748383, 'recall': 0.548978067495077, 'f1-score': 0.4382337955183591, 'support': 147270}, '1': {'precision': 0.37548387096774194, 'recall': 0.016517615005234677, 'f1-score': 0.03164323730011538, 'support': 158558}, '2': {'precision': 0.3633818689181454, 'recall': 0.5547946608404738, 'f1-score': 0.4391362971889937, 'support': 146465}, 'accuracy': 0.36419975546824734, 'macro avg': {'precision': 0.3678451438780901, 'recall': 0.3734301144469285, 'f1-score': 0.3030044433358227, 'support': 452293}, 'weighted avg': {'precision': 0.36804372950229997, 'recall': 0.36419975546824734, 'f1-score': 0.2959897174035557, 'support': 452293}}
[[80848  2168 64254]
 [77835  2619 78104]
 [63019  2188 81258]]
training model: results/AAPL/W0/deepOF_L2/h300
Epoch 1/50
4812/4812 - 109s - loss: 3.2730 - accuracy300: 0.3803 - val_loss: 3.3340 - val_accuracy300: 0.3526 - 109s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 107s - loss: 3.2542 - accuracy300: 0.3911 - val_loss: 3.3158 - val_accuracy300: 0.3561 - 107s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 106s - loss: 3.2469 - accuracy300: 0.3960 - val_loss: 3.3101 - val_accuracy300: 0.3571 - 106s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 106s - loss: 3.2441 - accuracy300: 0.3986 - val_loss: 3.3081 - val_accuracy300: 0.3575 - 106s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 106s - loss: 3.2424 - accuracy300: 0.3995 - val_loss: 3.3052 - val_accuracy300: 0.3578 - 106s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 107s - loss: 3.2409 - accuracy300: 0.4004 - val_loss: 3.3047 - val_accuracy300: 0.3580 - 107s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 106s - loss: 3.2395 - accuracy300: 0.4019 - val_loss: 3.3049 - val_accuracy300: 0.3581 - 106s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 106s - loss: 3.2384 - accuracy300: 0.4030 - val_loss: 3.3036 - val_accuracy300: 0.3591 - 106s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 107s - loss: 3.2373 - accuracy300: 0.4036 - val_loss: 3.3037 - val_accuracy300: 0.3583 - 107s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.2362 - accuracy300: 0.4045 - val_loss: 3.3032 - val_accuracy300: 0.3583 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 107s - loss: 3.2353 - accuracy300: 0.4053 - val_loss: 3.3032 - val_accuracy300: 0.3588 - 107s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 107s - loss: 3.2341 - accuracy300: 0.4059 - val_loss: 3.3027 - val_accuracy300: 0.3591 - 107s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 107s - loss: 3.2333 - accuracy300: 0.4065 - val_loss: 3.3029 - val_accuracy300: 0.3592 - 107s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 107s - loss: 3.2320 - accuracy300: 0.4076 - val_loss: 3.3025 - val_accuracy300: 0.3595 - 107s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 107s - loss: 3.2309 - accuracy300: 0.4086 - val_loss: 3.3036 - val_accuracy300: 0.3584 - 107s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 106s - loss: 3.2298 - accuracy300: 0.4091 - val_loss: 3.3047 - val_accuracy300: 0.3583 - 106s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 106s - loss: 3.2284 - accuracy300: 0.4104 - val_loss: 3.3059 - val_accuracy300: 0.3582 - 106s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 106s - loss: 3.2274 - accuracy300: 0.4113 - val_loss: 3.3067 - val_accuracy300: 0.3586 - 106s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.2257 - accuracy300: 0.4125 - val_loss: 3.3042 - val_accuracy300: 0.3592 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 107s - loss: 3.2246 - accuracy300: 0.4136 - val_loss: 3.3086 - val_accuracy300: 0.3575 - 107s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 107s - loss: 3.2228 - accuracy300: 0.4149 - val_loss: 3.3095 - val_accuracy300: 0.3588 - 107s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 106s - loss: 3.2216 - accuracy300: 0.4152 - val_loss: 3.3135 - val_accuracy300: 0.3577 - 106s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 106s - loss: 3.2196 - accuracy300: 0.4170 - val_loss: 3.3163 - val_accuracy300: 0.3570 - 106s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 107s - loss: 3.2176 - accuracy300: 0.4184 - val_loss: 3.3181 - val_accuracy300: 0.3573 - 107s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h300
Evaluating performance on  test set...
19053/19053 - 143s - 143s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1144413
{'0': {'precision': 0.3076687248292074, 'recall': 0.6085220247951586, 'f1-score': 0.4086991611211408, 'support': 1353974}, '1': {'precision': 0.4904062945750702, 'recall': 0.014524499133272523, 'f1-score': 0.028213394347350172, 'support': 2201384}, '2': {'precision': 0.3038661064184282, 'recall': 0.4905414768154616, 'f1-score': 0.3752706588974592, 'support': 1322088}, 'accuracy': 0.30844749485693945, 'macro avg': {'precision': 0.3673137086075686, 'recall': 0.37119600024796423, 'f1-score': 0.2707277381219834, 'support': 4877446}, 'weighted avg': {'precision': 0.3891146631477364, 'recall': 0.30844749485693945, 'f1-score': 0.22790972729625436, 'support': 4877446}}
[[ 823923   16770  513281]
 [1196938   31974  972472]
 [ 657094   16455  648539]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975509
{'0': {'precision': 0.36056336757388335, 'recall': 0.5889512234661846, 'f1-score': 0.44729009637886696, 'support': 407122}, '1': {'precision': 0.3661454204799308, 'recall': 0.012497939967580625, 'f1-score': 0.024170837059730176, 'support': 406547}, '2': {'precision': 0.37413040765729516, 'recall': 0.4947178130933194, 'f1-score': 0.4260559500899415, 'support': 418198}, 'accuracy': 0.36671653676898563, 'macro avg': {'precision': 0.36694639857036976, 'recall': 0.3653889921756949, 'f1-score': 0.2991722945095129, 'support': 1231867}, 'weighted avg': {'precision': 0.36701136552463415, 'recall': 0.36671653676898563, 'f1-score': 0.3004414974407079, 'support': 1231867}}
[[239775   4224 163123]
 [218490   5081 182976]
 [206736   4572 206890]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999265
{'0': {'precision': 0.3627291546813918, 'recall': 0.5342750006672182, 'f1-score': 0.4320985988835317, 'support': 149876}, '1': {'precision': 0.3552421500798297, 'recall': 0.008634349836691136, 'f1-score': 0.01685893428804152, 'support': 154615}, '2': {'precision': 0.3556928237143183, 'recall': 0.5481590235585445, 'f1-score': 0.4314340486713882, 'support': 147802}, 'accuracy': 0.3591234000968399, 'macro avg': {'precision': 0.35788804282518, 'recall': 0.3636894580208179, 'f1-score': 0.29346386061432045, 'support': 452293}, 'weighted avg': {'precision': 0.35787038612634914, 'recall': 0.3591234000968399, 'f1-score': 0.28993300580142134, 'support': 452293}}
[[80075  1238 68563]
 [75084  1335 78196]
 [65598  1185 81019]]
training model: results/AAPL/W0/deepOF_L2/h500
Epoch 1/50
4812/4812 - 110s - loss: 3.2765 - accuracy500: 0.3776 - val_loss: 3.3966 - val_accuracy500: 0.3430 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 106s - loss: 3.2623 - accuracy500: 0.3839 - val_loss: 3.3837 - val_accuracy500: 0.3474 - 106s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 106s - loss: 3.2540 - accuracy500: 0.3892 - val_loss: 3.3749 - val_accuracy500: 0.3480 - 106s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 106s - loss: 3.2502 - accuracy500: 0.3922 - val_loss: 3.3662 - val_accuracy500: 0.3483 - 106s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 107s - loss: 3.2483 - accuracy500: 0.3937 - val_loss: 3.3598 - val_accuracy500: 0.3487 - 107s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 106s - loss: 3.2467 - accuracy500: 0.3956 - val_loss: 3.3568 - val_accuracy500: 0.3493 - 106s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 107s - loss: 3.2455 - accuracy500: 0.3962 - val_loss: 3.3550 - val_accuracy500: 0.3485 - 107s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 106s - loss: 3.2445 - accuracy500: 0.3975 - val_loss: 3.3554 - val_accuracy500: 0.3490 - 106s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 107s - loss: 3.2431 - accuracy500: 0.3985 - val_loss: 3.3544 - val_accuracy500: 0.3493 - 107s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.2424 - accuracy500: 0.3996 - val_loss: 3.3541 - val_accuracy500: 0.3487 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.2415 - accuracy500: 0.4002 - val_loss: 3.3511 - val_accuracy500: 0.3490 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 106s - loss: 3.2402 - accuracy500: 0.4013 - val_loss: 3.3544 - val_accuracy500: 0.3488 - 106s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 107s - loss: 3.2391 - accuracy500: 0.4020 - val_loss: 3.3527 - val_accuracy500: 0.3496 - 107s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 106s - loss: 3.2383 - accuracy500: 0.4029 - val_loss: 3.3527 - val_accuracy500: 0.3488 - 106s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 106s - loss: 3.2373 - accuracy500: 0.4035 - val_loss: 3.3552 - val_accuracy500: 0.3486 - 106s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 107s - loss: 3.2362 - accuracy500: 0.4044 - val_loss: 3.3560 - val_accuracy500: 0.3483 - 107s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 106s - loss: 3.2349 - accuracy500: 0.4053 - val_loss: 3.3564 - val_accuracy500: 0.3481 - 106s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 106s - loss: 3.2340 - accuracy500: 0.4059 - val_loss: 3.3566 - val_accuracy500: 0.3479 - 106s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.2328 - accuracy500: 0.4066 - val_loss: 3.3566 - val_accuracy500: 0.3484 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 107s - loss: 3.2313 - accuracy500: 0.4078 - val_loss: 3.3631 - val_accuracy500: 0.3476 - 107s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 108s - loss: 3.2302 - accuracy500: 0.4088 - val_loss: 3.3634 - val_accuracy500: 0.3475 - 108s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h500
Evaluating performance on  test set...
19053/19053 - 145s - 145s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1500139
{'0': {'precision': 0.2944611530424687, 'recall': 0.6096815384072213, 'f1-score': 0.3971221146525989, 'support': 1359536}, '1': {'precision': 0.5431438127090301, 'recall': 0.0022277071534456756, 'f1-score': 0.004437215046457787, 'support': 2187002}, '2': {'precision': 0.2942629329193527, 'recall': 0.45404039948666625, 'f1-score': 0.35709385173318337, 'support': 1330908}, 'accuracy': 0.2948350427662346, 'macro avg': {'precision': 0.3772892995569505, 'recall': 0.355316548349111, 'f1-score': 0.2528843938107467, 'support': 4877446}, 'weighted avg': {'precision': 0.4059140858496127, 'recall': 0.2948350427662346, 'f1-score': 0.21012330499812332, 'support': 4877446}}
[[ 828884    2137  528515]
 [1261373    4872  920757]
 [ 724661    1961  604286]]
Evaluating performance on  train set...
4812/4812 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1101421
{'0': {'precision': 0.34768757196161654, 'recall': 0.5807976082587967, 'f1-score': 0.4349797164639235, 'support': 406064}, '1': {'precision': 0.38675340035481964, 'recall': 0.0016108334708535201, 'f1-score': 0.003208304308154195, 'support': 406001}, '2': {'precision': 0.3665076296109723, 'recall': 0.48180332633003176, 'f1-score': 0.41632043965770094, 'support': 419802}, 'accuracy': 0.35617237899870685, 'macro avg': {'precision': 0.3669828673091362, 'recall': 0.354737256019894, 'f1-score': 0.2848361534765929, 'support': 1231867}, 'weighted avg': {'precision': 0.36697655627143544, 'recall': 0.35617237899870685, 'f1-score': 0.28631689261324783, 'support': 1231867}}
[[235841    475 169748]
 [225494    654 179853]
 [216978    562 202262]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152163
{'0': {'precision': 0.3521601294618578, 'recall': 0.5293003535447514, 'f1-score': 0.4229309983193634, 'support': 150476}, '1': {'precision': 0.39603960396039606, 'recall': 0.0007756347277522106, 'f1-score': 0.0015482372673612233, 'support': 154712}, '2': {'precision': 0.3461383472896915, 'recall': 0.531361952346963, 'f1-score': 0.41920156169555517, 'support': 147105}, 'accuracy': 0.3491829411465577, 'macro avg': {'precision': 0.3647793602373151, 'recall': 0.3538126468731555, 'f1-score': 0.2812269324274266, 'support': 452293}, 'weighted avg': {'precision': 0.3652110654528666, 'recall': 0.3491829411465577, 'f1-score': 0.27757922744866087, 'support': 452293}}
[[79647    81 70748]
 [77683   120 76909]
 [68837   102 78166]]
training model: results/AAPL/W0/deepOF_L2/h1000
Epoch 1/50
4812/4812 - 110s - loss: 3.2726 - accuracy1000: 0.3807 - val_loss: 3.4614 - val_accuracy1000: 0.3320 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 109s - loss: 3.2686 - accuracy1000: 0.3765 - val_loss: 3.4544 - val_accuracy1000: 0.3344 - 109s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 108s - loss: 3.2586 - accuracy1000: 0.3840 - val_loss: 3.4510 - val_accuracy1000: 0.3350 - 108s/epoch - 22ms/step
Epoch 4/50
4812/4812 - 106s - loss: 3.2508 - accuracy1000: 0.3887 - val_loss: 3.4512 - val_accuracy1000: 0.3360 - 106s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 106s - loss: 3.2468 - accuracy1000: 0.3917 - val_loss: 3.4352 - val_accuracy1000: 0.3366 - 106s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 107s - loss: 3.2446 - accuracy1000: 0.3931 - val_loss: 3.4270 - val_accuracy1000: 0.3373 - 107s/epoch - 22ms/step
Epoch 7/50
4812/4812 - 107s - loss: 3.2430 - accuracy1000: 0.3945 - val_loss: 3.4255 - val_accuracy1000: 0.3371 - 107s/epoch - 22ms/step
Epoch 8/50
4812/4812 - 106s - loss: 3.2414 - accuracy1000: 0.3959 - val_loss: 3.4265 - val_accuracy1000: 0.3379 - 106s/epoch - 22ms/step
Epoch 9/50
4812/4812 - 106s - loss: 3.2396 - accuracy1000: 0.3974 - val_loss: 3.4213 - val_accuracy1000: 0.3379 - 106s/epoch - 22ms/step
Epoch 10/50
4812/4812 - 107s - loss: 3.2380 - accuracy1000: 0.3990 - val_loss: 3.4242 - val_accuracy1000: 0.3386 - 107s/epoch - 22ms/step
Epoch 11/50
4812/4812 - 106s - loss: 3.2368 - accuracy1000: 0.4000 - val_loss: 3.4238 - val_accuracy1000: 0.3380 - 106s/epoch - 22ms/step
Epoch 12/50
4812/4812 - 106s - loss: 3.2355 - accuracy1000: 0.4017 - val_loss: 3.4207 - val_accuracy1000: 0.3388 - 106s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 106s - loss: 3.2344 - accuracy1000: 0.4028 - val_loss: 3.4160 - val_accuracy1000: 0.3392 - 106s/epoch - 22ms/step
Epoch 14/50
4812/4812 - 106s - loss: 3.2332 - accuracy1000: 0.4036 - val_loss: 3.4147 - val_accuracy1000: 0.3395 - 106s/epoch - 22ms/step
Epoch 15/50
4812/4812 - 105s - loss: 3.2320 - accuracy1000: 0.4045 - val_loss: 3.4174 - val_accuracy1000: 0.3395 - 105s/epoch - 22ms/step
Epoch 16/50
4812/4812 - 106s - loss: 3.2311 - accuracy1000: 0.4057 - val_loss: 3.4163 - val_accuracy1000: 0.3401 - 106s/epoch - 22ms/step
Epoch 17/50
4812/4812 - 107s - loss: 3.2298 - accuracy1000: 0.4065 - val_loss: 3.4145 - val_accuracy1000: 0.3397 - 107s/epoch - 22ms/step
Epoch 18/50
4812/4812 - 107s - loss: 3.2287 - accuracy1000: 0.4072 - val_loss: 3.4141 - val_accuracy1000: 0.3396 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.2276 - accuracy1000: 0.4083 - val_loss: 3.4132 - val_accuracy1000: 0.3398 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 106s - loss: 3.2269 - accuracy1000: 0.4088 - val_loss: 3.4157 - val_accuracy1000: 0.3397 - 106s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 106s - loss: 3.2261 - accuracy1000: 0.4095 - val_loss: 3.4166 - val_accuracy1000: 0.3398 - 106s/epoch - 22ms/step
Epoch 22/50
4812/4812 - 107s - loss: 3.2249 - accuracy1000: 0.4101 - val_loss: 3.4167 - val_accuracy1000: 0.3397 - 107s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 107s - loss: 3.2238 - accuracy1000: 0.4111 - val_loss: 3.4159 - val_accuracy1000: 0.3401 - 107s/epoch - 22ms/step
Epoch 24/50
4812/4812 - 106s - loss: 3.2227 - accuracy1000: 0.4120 - val_loss: 3.4174 - val_accuracy1000: 0.3396 - 106s/epoch - 22ms/step
Epoch 25/50
4812/4812 - 105s - loss: 3.2219 - accuracy1000: 0.4125 - val_loss: 3.4199 - val_accuracy1000: 0.3396 - 105s/epoch - 22ms/step
Epoch 26/50
4812/4812 - 106s - loss: 3.2209 - accuracy1000: 0.4126 - val_loss: 3.4185 - val_accuracy1000: 0.3392 - 106s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 106s - loss: 3.2199 - accuracy1000: 0.4140 - val_loss: 3.4185 - val_accuracy1000: 0.3387 - 106s/epoch - 22ms/step
Epoch 28/50
4812/4812 - 106s - loss: 3.2188 - accuracy1000: 0.4149 - val_loss: 3.4145 - val_accuracy1000: 0.3395 - 106s/epoch - 22ms/step
Epoch 29/50
4812/4812 - 107s - loss: 3.2174 - accuracy1000: 0.4158 - val_loss: 3.4215 - val_accuracy1000: 0.3396 - 107s/epoch - 22ms/step
testing model: results/AAPL/W0/deepOF_L2/h1000
Evaluating performance on  test set...
19053/19053 - 149s - 149s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.208161
{'0': {'precision': 0.2637712724711543, 'recall': 0.7152487646991978, 'f1-score': 0.3854100419505529, 'support': 1276005}, '1': {'precision': 0.5340572556762093, 'recall': 0.0002281627960528258, 'f1-score': 0.0004561307215001557, 'support': 2371114}, '2': {'precision': 0.2774109600066649, 'recall': 0.3193630636408044, 'f1-score': 0.2969124344044859, 'support': 1230327}, 'accuracy': 0.2677883056009231, 'macro avg': {'precision': 0.35841316271800955, 'recall': 0.3449466637120184, 'f1-score': 0.22759286902551298, 'support': 4877446}, 'weighted avg': {'precision': 0.3986082659771353, 'recall': 0.2677883056009231, 'f1-score': 0.17594578457706395, 'support': 4877446}}
[[ 912661     258  363086]
 [1710194     541  660379]
 [ 837192     214  392921]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271391
{'0': {'precision': 0.3370623803476316, 'recall': 0.6586740879940932, 'f1-score': 0.4459297475411974, 'support': 404959}, '1': {'precision': 0.39058171745152354, 'recall': 0.00034667499342300986, 'f1-score': 0.0006927351246186273, 'support': 406721}, '2': {'precision': 0.3668763674284507, 'recall': 0.38430746310571245, 'f1-score': 0.37538967243106774, 'support': 420187}, 'accuracy': 0.34773072093010043, 'macro avg': {'precision': 0.36484015507586864, 'recall': 0.3477760753644095, 'f1-score': 0.27400405169896125, 'support': 1231867}, 'weighted avg': {'precision': 0.36490214559482154, 'recall': 0.34773072093010043, 'f1-score': 0.27486642214374507, 'support': 1231867}}
[[266736    113 138110]
 [266020    141 140560]
 [258599    107 161481]]
Evaluating performance on  val set...
1767/1767 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357553
{'0': {'precision': 0.34002980603831784, 'recall': 0.6095390627076743, 'f1-score': 0.4365380039027176, 'support': 150476}, '1': {'precision': 0.36585365853658536, 'recall': 0.0001919410357138287, 'f1-score': 0.0003836807775930426, 'support': 156298}, '2': {'precision': 0.3380556484186182, 'recall': 0.42388966389268756, 'f1-score': 0.3761380058904953, 'support': 145519}, 'accuracy': 0.339238060283931, 'macro avg': {'precision': 0.3479797043311738, 'recall': 0.3445402225453586, 'f1-score': 0.2710198968569353, 'support': 452293}, 'weighted avg': {'precision': 0.3483185459814811, 'recall': 0.339238060283931, 'f1-score': 0.26638415295532003, 'support': 452293}}
[[91721    26 58729]
 [94214    30 62054]
 [83809    26 61684]]
training model: results/AAPL/W0/deepVOL_L2/h10
Epoch 1/50
4812/4812 - 118s - loss: 3.1828 - accuracy10: 0.4302 - val_loss: 3.3065 - val_accuracy10: 0.4042 - 118s/epoch - 25ms/step
Epoch 2/50
4812/4812 - 122s - loss: 3.1352 - accuracy10: 0.4492 - val_loss: 3.2556 - val_accuracy10: 0.4161 - 122s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 114s - loss: 3.0960 - accuracy10: 0.4653 - val_loss: 3.1994 - val_accuracy10: 0.4353 - 114s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 107s - loss: 3.0669 - accuracy10: 0.4754 - val_loss: 3.1738 - val_accuracy10: 0.4459 - 107s/epoch - 22ms/step
Epoch 5/50
4812/4812 - 124s - loss: 3.0455 - accuracy10: 0.4823 - val_loss: 3.1628 - val_accuracy10: 0.4477 - 124s/epoch - 26ms/step
Epoch 6/50
4812/4812 - 119s - loss: 3.0307 - accuracy10: 0.4865 - val_loss: 3.1536 - val_accuracy10: 0.4514 - 119s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 109s - loss: 3.0182 - accuracy10: 0.4900 - val_loss: 3.1286 - val_accuracy10: 0.4595 - 109s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 117s - loss: 3.0079 - accuracy10: 0.4929 - val_loss: 3.1174 - val_accuracy10: 0.4632 - 117s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 115s - loss: 2.9992 - accuracy10: 0.4953 - val_loss: 3.1023 - val_accuracy10: 0.4679 - 115s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 121s - loss: 2.9914 - accuracy10: 0.4971 - val_loss: 3.0961 - val_accuracy10: 0.4694 - 121s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 112s - loss: 2.9849 - accuracy10: 0.4990 - val_loss: 3.0833 - val_accuracy10: 0.4732 - 112s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 119s - loss: 2.9789 - accuracy10: 0.5007 - val_loss: 3.0782 - val_accuracy10: 0.4731 - 119s/epoch - 25ms/step
Epoch 13/50
4812/4812 - 113s - loss: 2.9730 - accuracy10: 0.5022 - val_loss: 3.0760 - val_accuracy10: 0.4744 - 113s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 120s - loss: 2.9678 - accuracy10: 0.5036 - val_loss: 3.0654 - val_accuracy10: 0.4769 - 120s/epoch - 25ms/step
Epoch 15/50
4812/4812 - 118s - loss: 2.9624 - accuracy10: 0.5050 - val_loss: 3.0632 - val_accuracy10: 0.4774 - 118s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 119s - loss: 2.9584 - accuracy10: 0.5055 - val_loss: 3.0585 - val_accuracy10: 0.4787 - 119s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 119s - loss: 2.9545 - accuracy10: 0.5062 - val_loss: 3.0541 - val_accuracy10: 0.4785 - 119s/epoch - 25ms/step
Epoch 18/50
4812/4812 - 108s - loss: 2.9504 - accuracy10: 0.5073 - val_loss: 3.0499 - val_accuracy10: 0.4808 - 108s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 115s - loss: 2.9464 - accuracy10: 0.5085 - val_loss: 3.0447 - val_accuracy10: 0.4812 - 115s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 120s - loss: 2.9434 - accuracy10: 0.5089 - val_loss: 3.0440 - val_accuracy10: 0.4812 - 120s/epoch - 25ms/step
Epoch 21/50
4812/4812 - 117s - loss: 2.9403 - accuracy10: 0.5099 - val_loss: 3.0386 - val_accuracy10: 0.4828 - 117s/epoch - 24ms/step
Epoch 22/50
4812/4812 - 114s - loss: 2.9375 - accuracy10: 0.5107 - val_loss: 3.0379 - val_accuracy10: 0.4825 - 114s/epoch - 24ms/step
Epoch 23/50
4812/4812 - 117s - loss: 2.9348 - accuracy10: 0.5116 - val_loss: 3.0339 - val_accuracy10: 0.4840 - 117s/epoch - 24ms/step
Epoch 24/50
4812/4812 - 117s - loss: 2.9322 - accuracy10: 0.5119 - val_loss: 3.0339 - val_accuracy10: 0.4847 - 117s/epoch - 24ms/step
Epoch 25/50
4812/4812 - 119s - loss: 2.9297 - accuracy10: 0.5125 - val_loss: 3.0316 - val_accuracy10: 0.4843 - 119s/epoch - 25ms/step
Epoch 26/50
4812/4812 - 113s - loss: 2.9275 - accuracy10: 0.5129 - val_loss: 3.0296 - val_accuracy10: 0.4852 - 113s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 112s - loss: 2.9248 - accuracy10: 0.5143 - val_loss: 3.0280 - val_accuracy10: 0.4857 - 112s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 116s - loss: 2.9231 - accuracy10: 0.5144 - val_loss: 3.0287 - val_accuracy10: 0.4866 - 116s/epoch - 24ms/step
Epoch 29/50
4812/4812 - 114s - loss: 2.9210 - accuracy10: 0.5148 - val_loss: 3.0275 - val_accuracy10: 0.4863 - 114s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 118s - loss: 2.9187 - accuracy10: 0.5151 - val_loss: 3.0278 - val_accuracy10: 0.4860 - 118s/epoch - 25ms/step
Epoch 31/50
4812/4812 - 120s - loss: 2.9170 - accuracy10: 0.5163 - val_loss: 3.0273 - val_accuracy10: 0.4875 - 120s/epoch - 25ms/step
Epoch 32/50
4812/4812 - 117s - loss: 2.9150 - accuracy10: 0.5165 - val_loss: 3.0256 - val_accuracy10: 0.4867 - 117s/epoch - 24ms/step
Epoch 33/50
4812/4812 - 115s - loss: 2.9136 - accuracy10: 0.5169 - val_loss: 3.0282 - val_accuracy10: 0.4867 - 115s/epoch - 24ms/step
Epoch 34/50
4812/4812 - 116s - loss: 2.9114 - accuracy10: 0.5170 - val_loss: 3.0251 - val_accuracy10: 0.4875 - 116s/epoch - 24ms/step
Epoch 35/50
4812/4812 - 119s - loss: 2.9103 - accuracy10: 0.5178 - val_loss: 3.0227 - val_accuracy10: 0.4887 - 119s/epoch - 25ms/step
Epoch 36/50
4812/4812 - 116s - loss: 2.9086 - accuracy10: 0.5180 - val_loss: 3.0209 - val_accuracy10: 0.4888 - 116s/epoch - 24ms/step
Epoch 37/50
4812/4812 - 114s - loss: 2.9065 - accuracy10: 0.5186 - val_loss: 3.0188 - val_accuracy10: 0.4888 - 114s/epoch - 24ms/step
Epoch 38/50
4812/4812 - 113s - loss: 2.9055 - accuracy10: 0.5189 - val_loss: 3.0184 - val_accuracy10: 0.4894 - 113s/epoch - 23ms/step
Epoch 39/50
4812/4812 - 114s - loss: 2.9035 - accuracy10: 0.5194 - val_loss: 3.0185 - val_accuracy10: 0.4888 - 114s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 114s - loss: 2.9025 - accuracy10: 0.5197 - val_loss: 3.0179 - val_accuracy10: 0.4899 - 114s/epoch - 24ms/step
Epoch 41/50
4812/4812 - 104s - loss: 2.9012 - accuracy10: 0.5201 - val_loss: 3.0182 - val_accuracy10: 0.4897 - 104s/epoch - 22ms/step
Epoch 42/50
4812/4812 - 117s - loss: 2.8999 - accuracy10: 0.5205 - val_loss: 3.0204 - val_accuracy10: 0.4893 - 117s/epoch - 24ms/step
Epoch 43/50
4812/4812 - 116s - loss: 2.8978 - accuracy10: 0.5210 - val_loss: 3.0162 - val_accuracy10: 0.4905 - 116s/epoch - 24ms/step
Epoch 44/50
4812/4812 - 115s - loss: 2.8965 - accuracy10: 0.5216 - val_loss: 3.0188 - val_accuracy10: 0.4900 - 115s/epoch - 24ms/step
Epoch 45/50
4812/4812 - 113s - loss: 2.8950 - accuracy10: 0.5215 - val_loss: 3.0195 - val_accuracy10: 0.4894 - 113s/epoch - 23ms/step
Epoch 46/50
4812/4812 - 116s - loss: 2.8941 - accuracy10: 0.5219 - val_loss: 3.0171 - val_accuracy10: 0.4906 - 116s/epoch - 24ms/step
Epoch 47/50
4812/4812 - 114s - loss: 2.8925 - accuracy10: 0.5222 - val_loss: 3.0134 - val_accuracy10: 0.4916 - 114s/epoch - 24ms/step
Epoch 48/50
4812/4812 - 113s - loss: 2.8910 - accuracy10: 0.5227 - val_loss: 3.0146 - val_accuracy10: 0.4910 - 113s/epoch - 23ms/step
Epoch 49/50
4812/4812 - 112s - loss: 2.8893 - accuracy10: 0.5232 - val_loss: 3.0127 - val_accuracy10: 0.4915 - 112s/epoch - 23ms/step
Epoch 50/50
4812/4812 - 108s - loss: 2.8882 - accuracy10: 0.5234 - val_loss: 3.0161 - val_accuracy10: 0.4911 - 108s/epoch - 22ms/step
testing model: results/AAPL/W0/deepVOL_L2/h10
Evaluating performance on  test set...
19053/19053 - 192s - 192s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9531285
{'0': {'precision': 0.44000810226491377, 'recall': 0.5424365683146065, 'f1-score': 0.4858828027076839, 'support': 1177369}, '1': {'precision': 0.684984999920526, 'recall': 0.5256818125477354, 'f1-score': 0.5948526095170753, 'support': 2541351}, '2': {'precision': 0.4292754129954828, 'recall': 0.5466963428095045, 'f1-score': 0.4809223155215222, 'support': 1158731}, 'accuracy': 0.5347186470966084, 'macro avg': {'precision': 0.5180895050603075, 'recall': 0.5382715745572821, 'f1-score': 0.5205525759154271, 'support': 4877451}, 'weighted avg': {'precision': 0.5651013085450242, 'recall': 0.5347186470966084, 'f1-score': 0.5414820608503377, 'support': 4877451}}
[[ 638648  327378  211343]
 [ 574544 1335942  630865]
 [ 238254  287003  633474]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.990984
{'0': {'precision': 0.4842476509305718, 'recall': 0.5981889750228038, 'f1-score': 0.5352213682019966, 'support': 406731}, '1': {'precision': 0.5362373233875193, 'recall': 0.3371788600098822, 'f1-score': 0.41402459178452683, 'support': 406793}, '2': {'precision': 0.49924311040454006, 'recall': 0.5652429579484826, 'f1-score': 0.5301969858507858, 'support': 418344}, 'accuracy': 0.5008085281864615, 'macro avg': {'precision': 0.506576028240877, 'recall': 0.5002035976603895, 'f1-score': 0.49314764861243643, 'support': 1231868}, 'weighted avg': {'precision': 0.5065083926057812, 'recall': 0.5008085281864615, 'f1-score': 0.49349293587034526, 'support': 1231868}}
[[243302  58689 104740]
 [137188 137162 132443]
 [121943  59935 236466]]
Evaluating performance on  val set...
1767/1767 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0036799
{'0': {'precision': 0.4754641478332538, 'recall': 0.5939968297408246, 'f1-score': 0.5281617607199003, 'support': 147622}, '1': {'precision': 0.5355052861869403, 'recall': 0.3229053619355216, 'f1-score': 0.40287833948189894, 'support': 153881}, '2': {'precision': 0.4842300662554261, 'recall': 0.5622322435174746, 'f1-score': 0.5203240556049958, 'support': 150790}, 'accuracy': 0.49117496843860065, 'macro avg': {'precision': 0.49839983342520666, 'recall': 0.49304481173127357, 'f1-score': 0.4837880519355983, 'support': 452293}, 'weighted avg': {'precision': 0.4988140631533737, 'recall': 0.49117496843860065, 'f1-score': 0.48292430248419616, 'support': 452293}}
[[87687 21663 38272]
 [52163 49689 52029]
 [44574 21437 84779]]
training model: results/AAPL/W0/deepVOL_L2/h20
Epoch 1/50
4812/4812 - 110s - loss: 3.2131 - accuracy20: 0.4170 - val_loss: 3.2864 - val_accuracy20: 0.3926 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 117s - loss: 3.1855 - accuracy20: 0.4296 - val_loss: 3.2764 - val_accuracy20: 0.3998 - 117s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 117s - loss: 3.1685 - accuracy20: 0.4382 - val_loss: 3.2665 - val_accuracy20: 0.4044 - 117s/epoch - 24ms/step
Epoch 4/50
4812/4812 - 113s - loss: 3.1531 - accuracy20: 0.4445 - val_loss: 3.2534 - val_accuracy20: 0.4086 - 113s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 119s - loss: 3.1374 - accuracy20: 0.4509 - val_loss: 3.2354 - val_accuracy20: 0.4117 - 119s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 111s - loss: 3.1240 - accuracy20: 0.4562 - val_loss: 3.2297 - val_accuracy20: 0.4108 - 111s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 109s - loss: 3.1137 - accuracy20: 0.4594 - val_loss: 3.2045 - val_accuracy20: 0.4191 - 109s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 112s - loss: 3.1055 - accuracy20: 0.4623 - val_loss: 3.1938 - val_accuracy20: 0.4241 - 112s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 112s - loss: 3.0986 - accuracy20: 0.4642 - val_loss: 3.1929 - val_accuracy20: 0.4244 - 112s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 119s - loss: 3.0927 - accuracy20: 0.4657 - val_loss: 3.1826 - val_accuracy20: 0.4295 - 119s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 120s - loss: 3.0874 - accuracy20: 0.4675 - val_loss: 3.1814 - val_accuracy20: 0.4282 - 120s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 119s - loss: 3.0831 - accuracy20: 0.4689 - val_loss: 3.1826 - val_accuracy20: 0.4276 - 119s/epoch - 25ms/step
Epoch 13/50
4812/4812 - 112s - loss: 3.0790 - accuracy20: 0.4696 - val_loss: 3.1734 - val_accuracy20: 0.4308 - 112s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 120s - loss: 3.0753 - accuracy20: 0.4712 - val_loss: 3.1739 - val_accuracy20: 0.4308 - 120s/epoch - 25ms/step
Epoch 15/50
4812/4812 - 113s - loss: 3.0726 - accuracy20: 0.4719 - val_loss: 3.1731 - val_accuracy20: 0.4320 - 113s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 109s - loss: 3.0692 - accuracy20: 0.4728 - val_loss: 3.1792 - val_accuracy20: 0.4273 - 109s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 110s - loss: 3.0663 - accuracy20: 0.4736 - val_loss: 3.1717 - val_accuracy20: 0.4320 - 110s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 107s - loss: 3.0634 - accuracy20: 0.4743 - val_loss: 3.1685 - val_accuracy20: 0.4333 - 107s/epoch - 22ms/step
Epoch 19/50
4812/4812 - 111s - loss: 3.0612 - accuracy20: 0.4747 - val_loss: 3.1617 - val_accuracy20: 0.4364 - 111s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 110s - loss: 3.0585 - accuracy20: 0.4757 - val_loss: 3.1645 - val_accuracy20: 0.4361 - 110s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 110s - loss: 3.0559 - accuracy20: 0.4766 - val_loss: 3.1595 - val_accuracy20: 0.4371 - 110s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 106s - loss: 3.0536 - accuracy20: 0.4775 - val_loss: 3.1607 - val_accuracy20: 0.4362 - 106s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 116s - loss: 3.0516 - accuracy20: 0.4775 - val_loss: 3.1572 - val_accuracy20: 0.4380 - 116s/epoch - 24ms/step
Epoch 24/50
4812/4812 - 109s - loss: 3.0496 - accuracy20: 0.4785 - val_loss: 3.1556 - val_accuracy20: 0.4390 - 109s/epoch - 23ms/step
Epoch 25/50
4812/4812 - 115s - loss: 3.0473 - accuracy20: 0.4791 - val_loss: 3.1577 - val_accuracy20: 0.4376 - 115s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 111s - loss: 3.0456 - accuracy20: 0.4797 - val_loss: 3.1538 - val_accuracy20: 0.4404 - 111s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 110s - loss: 3.0440 - accuracy20: 0.4803 - val_loss: 3.1469 - val_accuracy20: 0.4417 - 110s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 120s - loss: 3.0422 - accuracy20: 0.4803 - val_loss: 3.1529 - val_accuracy20: 0.4400 - 120s/epoch - 25ms/step
Epoch 29/50
4812/4812 - 114s - loss: 3.0403 - accuracy20: 0.4812 - val_loss: 3.1506 - val_accuracy20: 0.4413 - 114s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 112s - loss: 3.0392 - accuracy20: 0.4817 - val_loss: 3.1468 - val_accuracy20: 0.4431 - 112s/epoch - 23ms/step
Epoch 31/50
4812/4812 - 111s - loss: 3.0373 - accuracy20: 0.4820 - val_loss: 3.1439 - val_accuracy20: 0.4437 - 111s/epoch - 23ms/step
Epoch 32/50
4812/4812 - 110s - loss: 3.0361 - accuracy20: 0.4827 - val_loss: 3.1460 - val_accuracy20: 0.4435 - 110s/epoch - 23ms/step
Epoch 33/50
4812/4812 - 118s - loss: 3.0344 - accuracy20: 0.4831 - val_loss: 3.1403 - val_accuracy20: 0.4451 - 118s/epoch - 25ms/step
Epoch 34/50
4812/4812 - 116s - loss: 3.0329 - accuracy20: 0.4839 - val_loss: 3.1446 - val_accuracy20: 0.4440 - 116s/epoch - 24ms/step
Epoch 35/50
4812/4812 - 109s - loss: 3.0316 - accuracy20: 0.4842 - val_loss: 3.1442 - val_accuracy20: 0.4443 - 109s/epoch - 23ms/step
Epoch 36/50
4812/4812 - 120s - loss: 3.0306 - accuracy20: 0.4843 - val_loss: 3.1384 - val_accuracy20: 0.4455 - 120s/epoch - 25ms/step
Epoch 37/50
4812/4812 - 116s - loss: 3.0286 - accuracy20: 0.4849 - val_loss: 3.1416 - val_accuracy20: 0.4461 - 116s/epoch - 24ms/step
Epoch 38/50
4812/4812 - 119s - loss: 3.0271 - accuracy20: 0.4854 - val_loss: 3.1413 - val_accuracy20: 0.4461 - 119s/epoch - 25ms/step
Epoch 39/50
4812/4812 - 118s - loss: 3.0263 - accuracy20: 0.4856 - val_loss: 3.1431 - val_accuracy20: 0.4455 - 118s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 118s - loss: 3.0248 - accuracy20: 0.4861 - val_loss: 3.1440 - val_accuracy20: 0.4451 - 118s/epoch - 24ms/step
Epoch 41/50
4812/4812 - 118s - loss: 3.0240 - accuracy20: 0.4865 - val_loss: 3.1458 - val_accuracy20: 0.4440 - 118s/epoch - 25ms/step
Epoch 42/50
4812/4812 - 120s - loss: 3.0221 - accuracy20: 0.4866 - val_loss: 3.1448 - val_accuracy20: 0.4451 - 120s/epoch - 25ms/step
Epoch 43/50
4812/4812 - 111s - loss: 3.0211 - accuracy20: 0.4871 - val_loss: 3.1449 - val_accuracy20: 0.4450 - 111s/epoch - 23ms/step
Epoch 44/50
4812/4812 - 120s - loss: 3.0197 - accuracy20: 0.4877 - val_loss: 3.1444 - val_accuracy20: 0.4456 - 120s/epoch - 25ms/step
Epoch 45/50
4812/4812 - 120s - loss: 3.0183 - accuracy20: 0.4880 - val_loss: 3.1430 - val_accuracy20: 0.4456 - 120s/epoch - 25ms/step
Epoch 46/50
4812/4812 - 110s - loss: 3.0172 - accuracy20: 0.4885 - val_loss: 3.1411 - val_accuracy20: 0.4468 - 110s/epoch - 23ms/step
testing model: results/AAPL/W0/deepVOL_L2/h20
Evaluating performance on  test set...
19053/19053 - 169s - 169s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0171769
{'0': {'precision': 0.3885422610815045, 'recall': 0.6440948492517703, 'f1-score': 0.48469702778445567, 'support': 1247411}, '1': {'precision': 0.6588746443104978, 'recall': 0.2965921341660138, 'f1-score': 0.4090504061596272, 'support': 2395957}, '2': {'precision': 0.40250437306331643, 'recall': 0.5645941156307963, 'f1-score': 0.4699657857062157, 'support': 1234083}, 'accuracy': 0.45327549164512365, 'macro avg': {'precision': 0.4833070928184396, 'recall': 0.5017603663495268, 'f1-score': 0.4545710732167662, 'support': 4877451}, 'weighted avg': {'precision': 0.5248706774951271, 'recall': 0.45327549164512365, 'f1-score': 0.44380976350932516, 'support': 4877451}}
[[803451 191634 252326]
 [903365 710622 781970]
 [361044 176283 696756]]
Evaluating performance on  train set...
4812/4812 - 44s - 44s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.037476
{'0': {'precision': 0.4291730875916908, 'recall': 0.6846731012238114, 'f1-score': 0.5276191125736727, 'support': 406762}, '1': {'precision': 0.5099889220601213, 'recall': 0.1335111089264648, 'f1-score': 0.21162139314917472, 'support': 406880}, '2': {'precision': 0.4710828453287996, 'recall': 0.5366428677318005, 'f1-score': 0.5017302739824022, 'support': 418226}, 'accuracy': 0.45236989677465445, 'macro avg': {'precision': 0.47008161832687057, 'recall': 0.4516090259606922, 'f1-score': 0.4136569265684165, 'support': 1231868}, 'weighted avg': {'precision': 0.47009475863751315, 'recall': 0.45236989677465445, 'f1-score': 0.414457201160995, 'support': 1231868}}
[[278499  25430 102833]
 [203398  54323 149159]
 [167023  26765 224438]]
Evaluating performance on  val set...
1767/1767 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0454255
{'0': {'precision': 0.42689071331747613, 'recall': 0.678436181095161, 'f1-score': 0.5240406376649304, 'support': 147613}, '1': {'precision': 0.5106837063949795, 'recall': 0.13029527112436393, 'f1-score': 0.20761889022022065, 'support': 154265}, '2': {'precision': 0.4563025681282943, 'recall': 0.541016520958681, 'f1-score': 0.49506167206582413, 'support': 150415}, 'accuracy': 0.44577961631066587, 'macro avg': {'precision': 0.46462566261358323, 'recall': 0.44991599105940194, 'f1-score': 0.408907066650325, 'support': 452293}, 'weighted avg': {'precision': 0.4652514887848618, 'recall': 0.44577961631066587, 'f1-score': 0.406480401313389, 'support': 452293}}
[[100146   9480  37987]
 [ 75189  20100  58976]
 [ 59259   9779  81377]]
training model: results/AAPL/W0/deepVOL_L2/h30
Epoch 1/50
4812/4812 - 110s - loss: 3.2396 - accuracy30: 0.4049 - val_loss: 3.2856 - val_accuracy30: 0.3829 - 110s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 117s - loss: 3.2209 - accuracy30: 0.4131 - val_loss: 3.2770 - val_accuracy30: 0.3865 - 117s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 111s - loss: 3.2119 - accuracy30: 0.4167 - val_loss: 3.2666 - val_accuracy30: 0.3890 - 111s/epoch - 23ms/step
Epoch 4/50
4812/4812 - 115s - loss: 3.2022 - accuracy30: 0.4209 - val_loss: 3.2453 - val_accuracy30: 0.3980 - 115s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 108s - loss: 3.1902 - accuracy30: 0.4271 - val_loss: 3.2336 - val_accuracy30: 0.4022 - 108s/epoch - 22ms/step
Epoch 6/50
4812/4812 - 119s - loss: 3.1804 - accuracy30: 0.4315 - val_loss: 3.2307 - val_accuracy30: 0.4047 - 119s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 116s - loss: 3.1714 - accuracy30: 0.4358 - val_loss: 3.2229 - val_accuracy30: 0.4062 - 116s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 118s - loss: 3.1650 - accuracy30: 0.4384 - val_loss: 3.2205 - val_accuracy30: 0.4069 - 118s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 112s - loss: 3.1585 - accuracy30: 0.4411 - val_loss: 3.2195 - val_accuracy30: 0.4070 - 112s/epoch - 23ms/step
Epoch 10/50
4812/4812 - 113s - loss: 3.1531 - accuracy30: 0.4435 - val_loss: 3.2109 - val_accuracy30: 0.4100 - 113s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 109s - loss: 3.1485 - accuracy30: 0.4451 - val_loss: 3.2162 - val_accuracy30: 0.4079 - 109s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 115s - loss: 3.1446 - accuracy30: 0.4464 - val_loss: 3.2161 - val_accuracy30: 0.4085 - 115s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 113s - loss: 3.1411 - accuracy30: 0.4479 - val_loss: 3.2064 - val_accuracy30: 0.4126 - 113s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 122s - loss: 3.1379 - accuracy30: 0.4487 - val_loss: 3.2090 - val_accuracy30: 0.4116 - 122s/epoch - 25ms/step
Epoch 15/50
4812/4812 - 123s - loss: 3.1352 - accuracy30: 0.4501 - val_loss: 3.2040 - val_accuracy30: 0.4129 - 123s/epoch - 26ms/step
Epoch 16/50
4812/4812 - 121s - loss: 3.1323 - accuracy30: 0.4513 - val_loss: 3.2029 - val_accuracy30: 0.4143 - 121s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 116s - loss: 3.1296 - accuracy30: 0.4521 - val_loss: 3.2056 - val_accuracy30: 0.4139 - 116s/epoch - 24ms/step
Epoch 18/50
4812/4812 - 110s - loss: 3.1268 - accuracy30: 0.4531 - val_loss: 3.2037 - val_accuracy30: 0.4151 - 110s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 120s - loss: 3.1244 - accuracy30: 0.4539 - val_loss: 3.1989 - val_accuracy30: 0.4167 - 120s/epoch - 25ms/step
Epoch 20/50
4812/4812 - 122s - loss: 3.1223 - accuracy30: 0.4548 - val_loss: 3.1976 - val_accuracy30: 0.4171 - 122s/epoch - 25ms/step
Epoch 21/50
4812/4812 - 119s - loss: 3.1197 - accuracy30: 0.4553 - val_loss: 3.1982 - val_accuracy30: 0.4177 - 119s/epoch - 25ms/step
Epoch 22/50
4812/4812 - 114s - loss: 3.1179 - accuracy30: 0.4561 - val_loss: 3.1990 - val_accuracy30: 0.4162 - 114s/epoch - 24ms/step
Epoch 23/50
4812/4812 - 120s - loss: 3.1159 - accuracy30: 0.4569 - val_loss: 3.1964 - val_accuracy30: 0.4178 - 120s/epoch - 25ms/step
Epoch 24/50
4812/4812 - 121s - loss: 3.1142 - accuracy30: 0.4571 - val_loss: 3.1964 - val_accuracy30: 0.4188 - 121s/epoch - 25ms/step
Epoch 25/50
4812/4812 - 111s - loss: 3.1122 - accuracy30: 0.4580 - val_loss: 3.1982 - val_accuracy30: 0.4174 - 111s/epoch - 23ms/step
Epoch 26/50
4812/4812 - 109s - loss: 3.1105 - accuracy30: 0.4584 - val_loss: 3.1917 - val_accuracy30: 0.4199 - 109s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 112s - loss: 3.1090 - accuracy30: 0.4587 - val_loss: 3.1988 - val_accuracy30: 0.4189 - 112s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 111s - loss: 3.1073 - accuracy30: 0.4594 - val_loss: 3.1946 - val_accuracy30: 0.4195 - 111s/epoch - 23ms/step
Epoch 29/50
4812/4812 - 112s - loss: 3.1059 - accuracy30: 0.4601 - val_loss: 3.1955 - val_accuracy30: 0.4194 - 112s/epoch - 23ms/step
Epoch 30/50
4812/4812 - 108s - loss: 3.1044 - accuracy30: 0.4608 - val_loss: 3.1925 - val_accuracy30: 0.4213 - 108s/epoch - 22ms/step
Epoch 31/50
4812/4812 - 116s - loss: 3.1025 - accuracy30: 0.4611 - val_loss: 3.1931 - val_accuracy30: 0.4203 - 116s/epoch - 24ms/step
Epoch 32/50
4812/4812 - 116s - loss: 3.1008 - accuracy30: 0.4618 - val_loss: 3.1943 - val_accuracy30: 0.4207 - 116s/epoch - 24ms/step
Epoch 33/50
4812/4812 - 109s - loss: 3.0997 - accuracy30: 0.4623 - val_loss: 3.1943 - val_accuracy30: 0.4208 - 109s/epoch - 23ms/step
Epoch 34/50
4812/4812 - 112s - loss: 3.0986 - accuracy30: 0.4624 - val_loss: 3.1897 - val_accuracy30: 0.4215 - 112s/epoch - 23ms/step
Epoch 35/50
4812/4812 - 117s - loss: 3.0963 - accuracy30: 0.4633 - val_loss: 3.1946 - val_accuracy30: 0.4204 - 117s/epoch - 24ms/step
Epoch 36/50
4812/4812 - 107s - loss: 3.0955 - accuracy30: 0.4635 - val_loss: 3.1951 - val_accuracy30: 0.4195 - 107s/epoch - 22ms/step
Epoch 37/50
4812/4812 - 119s - loss: 3.0935 - accuracy30: 0.4639 - val_loss: 3.1902 - val_accuracy30: 0.4206 - 119s/epoch - 25ms/step
Epoch 38/50
4812/4812 - 117s - loss: 3.0922 - accuracy30: 0.4650 - val_loss: 3.1889 - val_accuracy30: 0.4223 - 117s/epoch - 24ms/step
Epoch 39/50
4812/4812 - 118s - loss: 3.0904 - accuracy30: 0.4652 - val_loss: 3.1930 - val_accuracy30: 0.4207 - 118s/epoch - 24ms/step
Epoch 40/50
4812/4812 - 118s - loss: 3.0890 - accuracy30: 0.4660 - val_loss: 3.1897 - val_accuracy30: 0.4225 - 118s/epoch - 25ms/step
Epoch 41/50
4812/4812 - 115s - loss: 3.0881 - accuracy30: 0.4663 - val_loss: 3.1924 - val_accuracy30: 0.4211 - 115s/epoch - 24ms/step
Epoch 42/50
4812/4812 - 107s - loss: 3.0862 - accuracy30: 0.4673 - val_loss: 3.1938 - val_accuracy30: 0.4209 - 107s/epoch - 22ms/step
Epoch 43/50
4812/4812 - 111s - loss: 3.0849 - accuracy30: 0.4675 - val_loss: 3.1919 - val_accuracy30: 0.4210 - 111s/epoch - 23ms/step
Epoch 44/50
4812/4812 - 114s - loss: 3.0836 - accuracy30: 0.4680 - val_loss: 3.1901 - val_accuracy30: 0.4221 - 114s/epoch - 24ms/step
Epoch 45/50
4812/4812 - 113s - loss: 3.0821 - accuracy30: 0.4682 - val_loss: 3.1949 - val_accuracy30: 0.4204 - 113s/epoch - 23ms/step
Epoch 46/50
4812/4812 - 116s - loss: 3.0809 - accuracy30: 0.4694 - val_loss: 3.1943 - val_accuracy30: 0.4212 - 116s/epoch - 24ms/step
Epoch 47/50
4812/4812 - 111s - loss: 3.0795 - accuracy30: 0.4695 - val_loss: 3.1954 - val_accuracy30: 0.4209 - 111s/epoch - 23ms/step
Epoch 48/50
4812/4812 - 111s - loss: 3.0776 - accuracy30: 0.4703 - val_loss: 3.1973 - val_accuracy30: 0.4194 - 111s/epoch - 23ms/step
testing model: results/AAPL/W0/deepVOL_L2/h30
Evaluating performance on  test set...
19053/19053 - 185s - 185s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0657843
{'0': {'precision': 0.36479781795300575, 'recall': 0.6312916739753925, 'f1-score': 0.4623958530318031, 'support': 1316919}, '1': {'precision': 0.530389700812986, 'recall': 0.13754193608058454, 'f1-score': 0.21843800262644003, 'support': 2259689}, '2': {'precision': 0.3811131616266717, 'recall': 0.5896107370374442, 'f1-score': 0.46297080442875704, 'support': 1300843}, 'accuracy': 0.39142433209477656, 'macro avg': {'precision': 0.4254335601308878, 'recall': 0.4528147823644737, 'f1-score': 0.38126822002900007, 'support': 4877451}, 'weighted avg': {'precision': 0.4458667731918115, 'recall': 0.39142433209477656, 'f1-score': 0.3495252266483547, 'support': 4877451}}
[[ 831360  148244  337315]
 [1040691  310802  908196]
 [ 406910  126942  766991]]
Evaluating performance on  train set...
4812/4812 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0536108
{'0': {'precision': 0.42392898651494926, 'recall': 0.618106293444103, 'f1-score': 0.5029257254103091, 'support': 405406}, '1': {'precision': 0.42055597816143975, 'recall': 0.10726512729076718, 'f1-score': 0.17093287882731184, 'support': 407178}, '2': {'precision': 0.44860648593076013, 'recall': 0.5744650404022095, 'f1-score': 0.5037941853168794, 'support': 419284}, 'accuracy': 0.43440043900807557, 'macro avg': {'precision': 0.4310304835357164, 'recall': 0.43327882037902654, 'f1-score': 0.39255092985150003, 'support': 1231868}, 'weighted avg': {'precision': 0.4312134243521961, 'recall': 0.43440043900807557, 'f1-score': 0.3934853860699697, 'support': 1231868}}
[[250584  28972 125850]
 [193300  43676 170202]
 [147215  31205 240864]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0623326
{'0': {'precision': 0.41599412035594174, 'recall': 0.6073674630879776, 'f1-score': 0.4937869422258787, 'support': 147242}, '1': {'precision': 0.4198386114494519, 'recall': 0.10698351115421921, 'f1-score': 0.17051603128961446, 'support': 154650}, '2': {'precision': 0.43049730680221926, 'recall': 0.5664722973916397, 'f1-score': 0.48921210311592944, 'support': 150401}, 'accuracy': 0.4226751243110108, 'macro avg': {'precision': 0.4221100128692043, 'recall': 0.4269410905446122, 'f1-score': 0.38450502554380755, 'support': 452293}, 'weighted avg': {'precision': 0.42213139042715203, 'recall': 0.4226751243110108, 'f1-score': 0.38173146767007365, 'support': 452293}}
[[89430 11199 46613]
 [72010 16545 66095]
 [53539 11664 85198]]
training model: results/AAPL/W0/deepVOL_L2/h50
Epoch 1/50
4812/4812 - 113s - loss: 3.2141 - accuracy50: 0.4174 - val_loss: 3.2816 - val_accuracy50: 0.3535 - 113s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 112s - loss: 3.1991 - accuracy50: 0.4251 - val_loss: 3.2753 - val_accuracy50: 0.3614 - 112s/epoch - 23ms/step
Epoch 3/50
4812/4812 - 120s - loss: 3.1918 - accuracy50: 0.4280 - val_loss: 3.2688 - val_accuracy50: 0.3659 - 120s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 114s - loss: 3.1838 - accuracy50: 0.4315 - val_loss: 3.2579 - val_accuracy50: 0.3783 - 114s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 113s - loss: 3.1784 - accuracy50: 0.4339 - val_loss: 3.2504 - val_accuracy50: 0.3861 - 113s/epoch - 23ms/step
Epoch 6/50
4812/4812 - 110s - loss: 3.1723 - accuracy50: 0.4371 - val_loss: 3.2461 - val_accuracy50: 0.3888 - 110s/epoch - 23ms/step
Epoch 7/50
4812/4812 - 117s - loss: 3.1661 - accuracy50: 0.4395 - val_loss: 3.2404 - val_accuracy50: 0.3914 - 117s/epoch - 24ms/step
Epoch 8/50
4812/4812 - 110s - loss: 3.1602 - accuracy50: 0.4424 - val_loss: 3.2333 - val_accuracy50: 0.3955 - 110s/epoch - 23ms/step
Epoch 9/50
4812/4812 - 116s - loss: 3.1545 - accuracy50: 0.4455 - val_loss: 3.2307 - val_accuracy50: 0.3976 - 116s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 111s - loss: 3.1500 - accuracy50: 0.4474 - val_loss: 3.2271 - val_accuracy50: 0.3997 - 111s/epoch - 23ms/step
Epoch 11/50
4812/4812 - 120s - loss: 3.1470 - accuracy50: 0.4487 - val_loss: 3.2247 - val_accuracy50: 0.4012 - 120s/epoch - 25ms/step
Epoch 12/50
4812/4812 - 116s - loss: 3.1435 - accuracy50: 0.4503 - val_loss: 3.2229 - val_accuracy50: 0.4029 - 116s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 111s - loss: 3.1405 - accuracy50: 0.4515 - val_loss: 3.2206 - val_accuracy50: 0.4035 - 111s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 127s - loss: 3.1383 - accuracy50: 0.4524 - val_loss: 3.2185 - val_accuracy50: 0.4036 - 127s/epoch - 26ms/step
Epoch 15/50
4812/4812 - 124s - loss: 3.1356 - accuracy50: 0.4534 - val_loss: 3.2154 - val_accuracy50: 0.4060 - 124s/epoch - 26ms/step
Epoch 16/50
4812/4812 - 122s - loss: 3.1331 - accuracy50: 0.4546 - val_loss: 3.2139 - val_accuracy50: 0.4066 - 122s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 115s - loss: 3.1307 - accuracy50: 0.4556 - val_loss: 3.2134 - val_accuracy50: 0.4071 - 115s/epoch - 24ms/step
Epoch 18/50
4812/4812 - 110s - loss: 3.1289 - accuracy50: 0.4563 - val_loss: 3.2136 - val_accuracy50: 0.4073 - 110s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 111s - loss: 3.1266 - accuracy50: 0.4570 - val_loss: 3.2107 - val_accuracy50: 0.4078 - 111s/epoch - 23ms/step
Epoch 20/50
4812/4812 - 115s - loss: 3.1249 - accuracy50: 0.4577 - val_loss: 3.2112 - val_accuracy50: 0.4077 - 115s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 116s - loss: 3.1232 - accuracy50: 0.4580 - val_loss: 3.2103 - val_accuracy50: 0.4086 - 116s/epoch - 24ms/step
Epoch 22/50
4812/4812 - 112s - loss: 3.1213 - accuracy50: 0.4587 - val_loss: 3.2101 - val_accuracy50: 0.4080 - 112s/epoch - 23ms/step
Epoch 23/50
4812/4812 - 115s - loss: 3.1198 - accuracy50: 0.4595 - val_loss: 3.2085 - val_accuracy50: 0.4103 - 115s/epoch - 24ms/step
Epoch 24/50
4812/4812 - 111s - loss: 3.1185 - accuracy50: 0.4598 - val_loss: 3.2090 - val_accuracy50: 0.4092 - 111s/epoch - 23ms/step
Epoch 25/50
4812/4812 - 115s - loss: 3.1167 - accuracy50: 0.4612 - val_loss: 3.2083 - val_accuracy50: 0.4102 - 115s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 106s - loss: 3.1155 - accuracy50: 0.4614 - val_loss: 3.2095 - val_accuracy50: 0.4098 - 106s/epoch - 22ms/step
Epoch 27/50
4812/4812 - 111s - loss: 3.1140 - accuracy50: 0.4620 - val_loss: 3.2100 - val_accuracy50: 0.4101 - 111s/epoch - 23ms/step
Epoch 28/50
4812/4812 - 113s - loss: 3.1127 - accuracy50: 0.4623 - val_loss: 3.2095 - val_accuracy50: 0.4109 - 113s/epoch - 23ms/step
Epoch 29/50
4812/4812 - 125s - loss: 3.1109 - accuracy50: 0.4633 - val_loss: 3.2115 - val_accuracy50: 0.4097 - 125s/epoch - 26ms/step
Epoch 30/50
4812/4812 - 123s - loss: 3.1090 - accuracy50: 0.4639 - val_loss: 3.2100 - val_accuracy50: 0.4102 - 123s/epoch - 25ms/step
Epoch 31/50
4812/4812 - 125s - loss: 3.1076 - accuracy50: 0.4645 - val_loss: 3.2087 - val_accuracy50: 0.4108 - 125s/epoch - 26ms/step
Epoch 32/50
4812/4812 - 126s - loss: 3.1065 - accuracy50: 0.4649 - val_loss: 3.2142 - val_accuracy50: 0.4079 - 126s/epoch - 26ms/step
Epoch 33/50
4812/4812 - 115s - loss: 3.1050 - accuracy50: 0.4655 - val_loss: 3.2092 - val_accuracy50: 0.4104 - 115s/epoch - 24ms/step
Epoch 34/50
4812/4812 - 120s - loss: 3.1031 - accuracy50: 0.4661 - val_loss: 3.2140 - val_accuracy50: 0.4095 - 120s/epoch - 25ms/step
Epoch 35/50
4812/4812 - 124s - loss: 3.1018 - accuracy50: 0.4666 - val_loss: 3.2125 - val_accuracy50: 0.4098 - 124s/epoch - 26ms/step
testing model: results/AAPL/W0/deepVOL_L2/h50
Evaluating performance on  test set...
19053/19053 - 144s - 144s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.040905
{'0': {'precision': 0.33646692790671157, 'recall': 0.5231751683157136, 'f1-score': 0.4095451872676052, 'support': 1133584}, '1': {'precision': 0.5848115210373794, 'recall': 0.387944007744257, 'f1-score': 0.46645661429529517, 'support': 2630078}, '2': {'precision': 0.34655156306564056, 'recall': 0.4263105489459853, 'f1-score': 0.3823155121527812, 'support': 1113789}, 'accuracy': 0.4281346957662927, 'macro avg': {'precision': 0.4226100040032439, 'recall': 0.44580990833531864, 'f1-score': 0.4194391045718939, 'support': 4877451}, 'weighted avg': {'precision': 0.47268517110811925, 'recall': 0.4281346957662927, 'f1-score': 0.4340156288071856, 'support': 4877451}}
[[ 593063  351155  189366]
 [ 903813 1020323  705942]
 [ 265743  373226  474820]]
Evaluating performance on  train set...
4812/4812 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0703286
{'0': {'precision': 0.42829559224227604, 'recall': 0.4797594736206807, 'f1-score': 0.45256917914540407, 'support': 405943}, '1': {'precision': 0.36671879775739635, 'recall': 0.4043670678996401, 'f1-score': 0.3846238443664987, 'support': 406497}, '2': {'precision': 0.4576703008044558, 'recall': 0.3589078459234958, 'f1-score': 0.40231657548780914, 'support': 419428}, 'accuracy': 0.41373345196076206, 'macro avg': {'precision': 0.4175615636013761, 'recall': 0.41434479581460554, 'f1-score': 0.41316986633323727, 'support': 1231868}, 'weighted avg': {'precision': 0.4179777603277347, 'recall': 0.41373345196076206, 'f1-score': 0.4130382198230429, 'support': 1231868}}
[[194755 133605  77583]
 [141324 164374 100799]
 [118642 150250 150536]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0695544
{'0': {'precision': 0.4080418274617204, 'recall': 0.4631459959730121, 'f1-score': 0.433851193726113, 'support': 141545}, '1': {'precision': 0.3994146919293682, 'recall': 0.41076568452985224, 'f1-score': 0.4050106719658497, 'support': 167458}, '2': {'precision': 0.4265006364306291, 'recall': 0.3554400167492498, 'f1-score': 0.3877414295828797, 'support': 143290}, 'accuracy': 0.4096304828949376, 'macro avg': {'precision': 0.4113190519405725, 'recall': 0.40978389908403806, 'f1-score': 0.40886776509161415, 'support': 452293}, 'weighted avg': {'precision': 0.41069559366013225, 'recall': 0.4096304828949376, 'f1-score': 0.40856527464928877, 'support': 452293}}
[[65556 49378 26611]
 [56798 68786 41874]
 [38306 54053 50931]]
training model: results/AAPL/W0/deepVOL_L2/h100
Epoch 1/50
4812/4812 - 113s - loss: 3.2673 - accuracy100: 0.3839 - val_loss: 3.3285 - val_accuracy100: 0.3479 - 113s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 120s - loss: 3.2581 - accuracy100: 0.3884 - val_loss: 3.3292 - val_accuracy100: 0.3551 - 120s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 120s - loss: 3.2543 - accuracy100: 0.3909 - val_loss: 3.3273 - val_accuracy100: 0.3576 - 120s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 120s - loss: 3.2498 - accuracy100: 0.3948 - val_loss: 3.3240 - val_accuracy100: 0.3574 - 120s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 124s - loss: 3.2444 - accuracy100: 0.3978 - val_loss: 3.3147 - val_accuracy100: 0.3581 - 124s/epoch - 26ms/step
Epoch 6/50
4812/4812 - 121s - loss: 3.2401 - accuracy100: 0.4006 - val_loss: 3.3136 - val_accuracy100: 0.3581 - 121s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 109s - loss: 3.2369 - accuracy100: 0.4021 - val_loss: 3.3036 - val_accuracy100: 0.3580 - 109s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 119s - loss: 3.2338 - accuracy100: 0.4043 - val_loss: 3.3016 - val_accuracy100: 0.3602 - 119s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 115s - loss: 3.2313 - accuracy100: 0.4055 - val_loss: 3.2963 - val_accuracy100: 0.3608 - 115s/epoch - 24ms/step
Epoch 10/50
4812/4812 - 116s - loss: 3.2289 - accuracy100: 0.4067 - val_loss: 3.2870 - val_accuracy100: 0.3632 - 116s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 115s - loss: 3.2267 - accuracy100: 0.4079 - val_loss: 3.2858 - val_accuracy100: 0.3644 - 115s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 117s - loss: 3.2244 - accuracy100: 0.4094 - val_loss: 3.2806 - val_accuracy100: 0.3682 - 117s/epoch - 24ms/step
Epoch 13/50
4812/4812 - 117s - loss: 3.2223 - accuracy100: 0.4110 - val_loss: 3.2801 - val_accuracy100: 0.3691 - 117s/epoch - 24ms/step
Epoch 14/50
4812/4812 - 111s - loss: 3.2194 - accuracy100: 0.4131 - val_loss: 3.2791 - val_accuracy100: 0.3708 - 111s/epoch - 23ms/step
Epoch 15/50
4812/4812 - 115s - loss: 3.2172 - accuracy100: 0.4152 - val_loss: 3.2796 - val_accuracy100: 0.3691 - 115s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 114s - loss: 3.2150 - accuracy100: 0.4164 - val_loss: 3.2777 - val_accuracy100: 0.3716 - 114s/epoch - 24ms/step
Epoch 17/50
4812/4812 - 112s - loss: 3.2130 - accuracy100: 0.4177 - val_loss: 3.2762 - val_accuracy100: 0.3738 - 112s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 113s - loss: 3.2110 - accuracy100: 0.4189 - val_loss: 3.2761 - val_accuracy100: 0.3747 - 113s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 106s - loss: 3.2092 - accuracy100: 0.4198 - val_loss: 3.2734 - val_accuracy100: 0.3751 - 106s/epoch - 22ms/step
Epoch 20/50
4812/4812 - 107s - loss: 3.2082 - accuracy100: 0.4209 - val_loss: 3.2739 - val_accuracy100: 0.3753 - 107s/epoch - 22ms/step
Epoch 21/50
4812/4812 - 122s - loss: 3.2060 - accuracy100: 0.4222 - val_loss: 3.2735 - val_accuracy100: 0.3758 - 122s/epoch - 25ms/step
Epoch 22/50
4812/4812 - 116s - loss: 3.2042 - accuracy100: 0.4229 - val_loss: 3.2755 - val_accuracy100: 0.3758 - 116s/epoch - 24ms/step
Epoch 23/50
4812/4812 - 118s - loss: 3.2032 - accuracy100: 0.4238 - val_loss: 3.2736 - val_accuracy100: 0.3766 - 118s/epoch - 25ms/step
Epoch 24/50
4812/4812 - 120s - loss: 3.2013 - accuracy100: 0.4246 - val_loss: 3.2727 - val_accuracy100: 0.3771 - 120s/epoch - 25ms/step
Epoch 25/50
4812/4812 - 122s - loss: 3.1999 - accuracy100: 0.4255 - val_loss: 3.2707 - val_accuracy100: 0.3792 - 122s/epoch - 25ms/step
Epoch 26/50
4812/4812 - 120s - loss: 3.1981 - accuracy100: 0.4262 - val_loss: 3.2713 - val_accuracy100: 0.3788 - 120s/epoch - 25ms/step
Epoch 27/50
4812/4812 - 120s - loss: 3.1966 - accuracy100: 0.4273 - val_loss: 3.2710 - val_accuracy100: 0.3782 - 120s/epoch - 25ms/step
Epoch 28/50
4812/4812 - 111s - loss: 3.1954 - accuracy100: 0.4277 - val_loss: 3.2708 - val_accuracy100: 0.3780 - 111s/epoch - 23ms/step
Epoch 29/50
4812/4812 - 117s - loss: 3.1936 - accuracy100: 0.4291 - val_loss: 3.2739 - val_accuracy100: 0.3773 - 117s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 120s - loss: 3.1920 - accuracy100: 0.4298 - val_loss: 3.2740 - val_accuracy100: 0.3773 - 120s/epoch - 25ms/step
Epoch 31/50
4812/4812 - 118s - loss: 3.1903 - accuracy100: 0.4307 - val_loss: 3.2725 - val_accuracy100: 0.3788 - 118s/epoch - 25ms/step
Epoch 32/50
4812/4812 - 120s - loss: 3.1915 - accuracy100: 0.4301 - val_loss: 3.2745 - val_accuracy100: 0.3771 - 120s/epoch - 25ms/step
Epoch 33/50
4812/4812 - 122s - loss: 3.1881 - accuracy100: 0.4316 - val_loss: 3.2760 - val_accuracy100: 0.3765 - 122s/epoch - 25ms/step
Epoch 34/50
4812/4812 - 123s - loss: 3.1862 - accuracy100: 0.4326 - val_loss: 3.2744 - val_accuracy100: 0.3781 - 123s/epoch - 26ms/step
Epoch 35/50
4812/4812 - 111s - loss: 3.1848 - accuracy100: 0.4334 - val_loss: 3.2779 - val_accuracy100: 0.3771 - 111s/epoch - 23ms/step
testing model: results/AAPL/W0/deepVOL_L2/h100
Evaluating performance on  test set...
19053/19053 - 203s - 203s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953013
{'0': {'precision': 0.334819975759796, 'recall': 0.646547956345798, 'f1-score': 0.4411743322543233, 'support': 1379661}, '1': {'precision': 0.4961925761931118, 'recall': 0.10343128748761946, 'f1-score': 0.17118010174717962, 'support': 2149543}, '2': {'precision': 0.35248723947858895, 'recall': 0.46149852363847277, 'f1-score': 0.3996933312391981, 'support': 1348247}, 'accuracy': 0.3560386357546185, 'macro avg': {'precision': 0.39449993047716553, 'recall': 0.40382592249063004, 'f1-score': 0.33734925508023367, 'support': 4877451}, 'weighted avg': {'precision': 0.41082221114059275, 'recall': 0.3560386357546185, 'f1-score': 0.31071872267410267, 'support': 4877451}}
[[ 892017  108245  379399]
 [1163616  222330  763597]
 [ 608536  117497  622214]]
Evaluating performance on  train set...
4812/4812 - 48s - 48s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0870166
{'0': {'precision': 0.3796126688419514, 'recall': 0.6081684544704076, 'f1-score': 0.46744859697828084, 'support': 408229}, '1': {'precision': 0.3726635113351854, 'recall': 0.10704724186425692, 'f1-score': 0.16631939461776157, 'support': 406017}, '2': {'precision': 0.4048926122985261, 'recall': 0.44716753427740874, 'f1-score': 0.4249813392076901, 'support': 417622}, 'accuracy': 0.38841986316715754, 'macro avg': {'precision': 0.38572293082522097, 'recall': 0.38746107687069103, 'f1-score': 0.3529164436012442, 'support': 1231868}, 'weighted avg': {'precision': 0.38589254985420024, 'recall': 0.38841986316715754, 'f1-score': 0.3538010012298073, 'support': 1231868}}
[[248272  34409 125548]
 [213623  43463 148931]
 [192119  38756 186747]]
Evaluating performance on  val set...
1767/1767 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899373
{'0': {'precision': 0.3717199685015368, 'recall': 0.596660641232994, 'f1-score': 0.45806508832521203, 'support': 147154}, '1': {'precision': 0.38226360274696247, 'recall': 0.11032410524844681, 'f1-score': 0.17122997288636924, 'support': 157418}, '2': {'precision': 0.3887987155673009, 'recall': 0.44917107249477056, 'f1-score': 0.4168101011370061, 'support': 147721}, 'accuracy': 0.3792232026584537, 'macro avg': {'precision': 0.38092742893860004, 'recall': 0.3853852729920704, 'f1-score': 0.34870172078286243, 'support': 452293}, 'weighted avg': {'precision': 0.38096761861097506, 'recall': 0.3792232026584537, 'f1-score': 0.34475969079621926, 'support': 452293}}
[[87801 13540 45813]
 [81557 17367 58494]
 [66844 14525 66352]]
training model: results/AAPL/W0/deepVOL_L2/h200
Epoch 1/50
4812/4812 - 123s - loss: 3.2607 - accuracy200: 0.3848 - val_loss: 3.3345 - val_accuracy200: 0.3369 - 123s/epoch - 26ms/step
Epoch 2/50
4812/4812 - 113s - loss: 3.2607 - accuracy200: 0.3859 - val_loss: 3.3358 - val_accuracy200: 0.3379 - 113s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 123s - loss: 3.2618 - accuracy200: 0.3837 - val_loss: 3.3341 - val_accuracy200: 0.3408 - 123s/epoch - 26ms/step
Epoch 4/50
4812/4812 - 122s - loss: 3.2573 - accuracy200: 0.3882 - val_loss: 3.3226 - val_accuracy200: 0.3432 - 122s/epoch - 25ms/step
Epoch 5/50
4812/4812 - 121s - loss: 3.2508 - accuracy200: 0.3933 - val_loss: 3.3179 - val_accuracy200: 0.3417 - 121s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 119s - loss: 3.2455 - accuracy200: 0.3962 - val_loss: 3.3216 - val_accuracy200: 0.3454 - 119s/epoch - 25ms/step
Epoch 7/50
4812/4812 - 121s - loss: 3.2400 - accuracy200: 0.3992 - val_loss: 3.3154 - val_accuracy200: 0.3453 - 121s/epoch - 25ms/step
Epoch 8/50
4812/4812 - 120s - loss: 3.2363 - accuracy200: 0.4010 - val_loss: 3.3118 - val_accuracy200: 0.3466 - 120s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 124s - loss: 3.2334 - accuracy200: 0.4027 - val_loss: 3.3079 - val_accuracy200: 0.3481 - 124s/epoch - 26ms/step
Epoch 10/50
4812/4812 - 116s - loss: 3.2317 - accuracy200: 0.4036 - val_loss: 3.3053 - val_accuracy200: 0.3479 - 116s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 123s - loss: 3.2299 - accuracy200: 0.4048 - val_loss: 3.3064 - val_accuracy200: 0.3483 - 123s/epoch - 26ms/step
Epoch 12/50
4812/4812 - 122s - loss: 3.2283 - accuracy200: 0.4058 - val_loss: 3.3032 - val_accuracy200: 0.3486 - 122s/epoch - 25ms/step
Epoch 13/50
4812/4812 - 123s - loss: 3.2271 - accuracy200: 0.4065 - val_loss: 3.3025 - val_accuracy200: 0.3493 - 123s/epoch - 25ms/step
Epoch 14/50
4812/4812 - 118s - loss: 3.2257 - accuracy200: 0.4069 - val_loss: 3.3008 - val_accuracy200: 0.3494 - 118s/epoch - 24ms/step
Epoch 15/50
4812/4812 - 116s - loss: 3.2248 - accuracy200: 0.4076 - val_loss: 3.2973 - val_accuracy200: 0.3491 - 116s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 113s - loss: 3.2231 - accuracy200: 0.4082 - val_loss: 3.2968 - val_accuracy200: 0.3503 - 113s/epoch - 23ms/step
Epoch 17/50
4812/4812 - 122s - loss: 3.2220 - accuracy200: 0.4087 - val_loss: 3.2983 - val_accuracy200: 0.3492 - 122s/epoch - 25ms/step
Epoch 18/50
4812/4812 - 113s - loss: 3.2211 - accuracy200: 0.4091 - val_loss: 3.2961 - val_accuracy200: 0.3496 - 113s/epoch - 23ms/step
Epoch 19/50
4812/4812 - 115s - loss: 3.2199 - accuracy200: 0.4100 - val_loss: 3.2969 - val_accuracy200: 0.3490 - 115s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 113s - loss: 3.2187 - accuracy200: 0.4105 - val_loss: 3.2958 - val_accuracy200: 0.3500 - 113s/epoch - 24ms/step
Epoch 21/50
4812/4812 - 112s - loss: 3.2175 - accuracy200: 0.4110 - val_loss: 3.2957 - val_accuracy200: 0.3496 - 112s/epoch - 23ms/step
Epoch 22/50
4812/4812 - 107s - loss: 3.2164 - accuracy200: 0.4119 - val_loss: 3.2947 - val_accuracy200: 0.3494 - 107s/epoch - 22ms/step
Epoch 23/50
4812/4812 - 121s - loss: 3.2153 - accuracy200: 0.4123 - val_loss: 3.2959 - val_accuracy200: 0.3489 - 121s/epoch - 25ms/step
Epoch 24/50
4812/4812 - 121s - loss: 3.2144 - accuracy200: 0.4130 - val_loss: 3.2969 - val_accuracy200: 0.3479 - 121s/epoch - 25ms/step
Epoch 25/50
4812/4812 - 115s - loss: 3.2133 - accuracy200: 0.4135 - val_loss: 3.2961 - val_accuracy200: 0.3493 - 115s/epoch - 24ms/step
Epoch 26/50
4812/4812 - 110s - loss: 3.2120 - accuracy200: 0.4141 - val_loss: 3.2970 - val_accuracy200: 0.3482 - 110s/epoch - 23ms/step
Epoch 27/50
4812/4812 - 120s - loss: 3.2112 - accuracy200: 0.4149 - val_loss: 3.2954 - val_accuracy200: 0.3494 - 120s/epoch - 25ms/step
Epoch 28/50
4812/4812 - 118s - loss: 3.2102 - accuracy200: 0.4155 - val_loss: 3.2954 - val_accuracy200: 0.3510 - 118s/epoch - 25ms/step
Epoch 29/50
4812/4812 - 114s - loss: 3.2089 - accuracy200: 0.4161 - val_loss: 3.2972 - val_accuracy200: 0.3499 - 114s/epoch - 24ms/step
Epoch 30/50
4812/4812 - 120s - loss: 3.2080 - accuracy200: 0.4168 - val_loss: 3.2958 - val_accuracy200: 0.3511 - 120s/epoch - 25ms/step
Epoch 31/50
4812/4812 - 117s - loss: 3.2071 - accuracy200: 0.4169 - val_loss: 3.2968 - val_accuracy200: 0.3506 - 117s/epoch - 24ms/step
Epoch 32/50
4812/4812 - 126s - loss: 3.2059 - accuracy200: 0.4178 - val_loss: 3.2974 - val_accuracy200: 0.3515 - 126s/epoch - 26ms/step
testing model: results/AAPL/W0/deepVOL_L2/h200
Evaluating performance on  test set...
19053/19053 - 215s - 215s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994127
{'0': {'precision': 0.2711971678434497, 'recall': 0.7201601659263646, 'f1-score': 0.39401614481473607, 'support': 1242961}, '1': {'precision': 0.5287587350186004, 'recall': 0.13765269632207272, 'f1-score': 0.21843882669518797, 'support': 2421391}, '2': {'precision': 0.30818103148598774, 'recall': 0.2404329737309156, 'f1-score': 0.2701239164258724, 'support': 1213099}, 'accuracy': 0.31166094749081025, 'macro avg': {'precision': 0.3693789781160126, 'recall': 0.366081945326451, 'f1-score': 0.29419296264526545, 'support': 4877451}, 'weighted avg': {'precision': 0.4082610458208409, 'recall': 0.31166094749081025, 'f1-score': 0.2760375374919536, 'support': 4877451}}
[[ 895131  137807  210023]
 [1643351  333311  444729]
 [ 762183  159247  291669]]
Evaluating performance on  train set...
4812/4812 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096018
{'0': {'precision': 0.34711808984136594, 'recall': 0.6858524533509154, 'f1-score': 0.4609459487285082, 'support': 407993}, '1': {'precision': 0.366341441070038, 'recall': 0.09816932908132578, 'f1-score': 0.15484460553116022, 'support': 407337}, '2': {'precision': 0.3853926799144611, 'recall': 0.29290965050007445, 'f1-score': 0.33284637282623974, 'support': 416538}, 'accuracy': 0.3586577457974393, 'macro avg': {'precision': 0.36628407027528836, 'recall': 0.3589771443107719, 'f1-score': 0.31621230902863606, 'support': 1231868}, 'weighted avg': {'precision': 0.36641658888452683, 'recall': 0.3586577457974393, 'f1-score': 0.31641362547540214, 'support': 1231868}}
[[279823  32187  95983]
 [268759  39988  98590]
 [257550  36980 122008]]
Evaluating performance on  val set...
1767/1767 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983377
{'0': {'precision': 0.34055852812364085, 'recall': 0.6865870485797212, 'f1-score': 0.45528711800234384, 'support': 147119}, '1': {'precision': 0.3644626162139639, 'recall': 0.08814026867194438, 'f1-score': 0.1419515163809717, 'support': 158781}, '2': {'precision': 0.36611733010495084, 'recall': 0.29334052857718607, 'f1-score': 0.32571315883285423, 'support': 146393}, 'accuracy': 0.3492161054891409, 'macro avg': {'precision': 0.35704615814751856, 'recall': 0.3560226152762838, 'f1-score': 0.3076505977387233, 'support': 452293}, 'weighted avg': {'precision': 0.35722282474003664, 'recall': 0.3492161054891409, 'f1-score': 0.30334919111481257, 'support': 452293}}
[[101010  11598  34511]
 [104947  13995  39839]
 [ 90644  12806  42943]]
training model: results/AAPL/W0/deepVOL_L2/h300
Epoch 1/50
4812/4812 - 114s - loss: 3.2750 - accuracy300: 0.3756 - val_loss: 3.3459 - val_accuracy300: 0.3328 - 114s/epoch - 24ms/step
Epoch 2/50
4812/4812 - 116s - loss: 3.2751 - accuracy300: 0.3744 - val_loss: 3.3408 - val_accuracy300: 0.3398 - 116s/epoch - 24ms/step
Epoch 3/50
4812/4812 - 123s - loss: 3.2744 - accuracy300: 0.3753 - val_loss: 3.3429 - val_accuracy300: 0.3397 - 123s/epoch - 26ms/step
Epoch 4/50
4812/4812 - 114s - loss: 3.2690 - accuracy300: 0.3802 - val_loss: 3.3368 - val_accuracy300: 0.3402 - 114s/epoch - 24ms/step
Epoch 5/50
4812/4812 - 120s - loss: 3.2654 - accuracy300: 0.3827 - val_loss: 3.3321 - val_accuracy300: 0.3419 - 120s/epoch - 25ms/step
Epoch 6/50
4812/4812 - 124s - loss: 3.2599 - accuracy300: 0.3862 - val_loss: 3.3274 - val_accuracy300: 0.3422 - 124s/epoch - 26ms/step
Epoch 7/50
4812/4812 - 111s - loss: 3.2556 - accuracy300: 0.3897 - val_loss: 3.3236 - val_accuracy300: 0.3429 - 111s/epoch - 23ms/step
Epoch 8/50
4812/4812 - 121s - loss: 3.2526 - accuracy300: 0.3924 - val_loss: 3.3172 - val_accuracy300: 0.3446 - 121s/epoch - 25ms/step
Epoch 9/50
4812/4812 - 120s - loss: 3.2499 - accuracy300: 0.3942 - val_loss: 3.3190 - val_accuracy300: 0.3458 - 120s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 115s - loss: 3.2479 - accuracy300: 0.3953 - val_loss: 3.3166 - val_accuracy300: 0.3447 - 115s/epoch - 24ms/step
Epoch 11/50
4812/4812 - 109s - loss: 3.2461 - accuracy300: 0.3964 - val_loss: 3.3176 - val_accuracy300: 0.3459 - 109s/epoch - 23ms/step
Epoch 12/50
4812/4812 - 108s - loss: 3.2445 - accuracy300: 0.3979 - val_loss: 3.3175 - val_accuracy300: 0.3463 - 108s/epoch - 22ms/step
Epoch 13/50
4812/4812 - 111s - loss: 3.2431 - accuracy300: 0.3991 - val_loss: 3.3159 - val_accuracy300: 0.3465 - 111s/epoch - 23ms/step
Epoch 14/50
4812/4812 - 122s - loss: 3.2417 - accuracy300: 0.3992 - val_loss: 3.3190 - val_accuracy300: 0.3458 - 122s/epoch - 25ms/step
Epoch 15/50
4812/4812 - 117s - loss: 3.2399 - accuracy300: 0.4005 - val_loss: 3.3208 - val_accuracy300: 0.3453 - 117s/epoch - 24ms/step
Epoch 16/50
4812/4812 - 120s - loss: 3.2386 - accuracy300: 0.4009 - val_loss: 3.3191 - val_accuracy300: 0.3448 - 120s/epoch - 25ms/step
Epoch 17/50
4812/4812 - 109s - loss: 3.2374 - accuracy300: 0.4017 - val_loss: 3.3203 - val_accuracy300: 0.3459 - 109s/epoch - 23ms/step
Epoch 18/50
4812/4812 - 118s - loss: 3.2361 - accuracy300: 0.4026 - val_loss: 3.3213 - val_accuracy300: 0.3443 - 118s/epoch - 25ms/step
Epoch 19/50
4812/4812 - 118s - loss: 3.2348 - accuracy300: 0.4025 - val_loss: 3.3217 - val_accuracy300: 0.3451 - 118s/epoch - 24ms/step
Epoch 20/50
4812/4812 - 112s - loss: 3.2338 - accuracy300: 0.4037 - val_loss: 3.3206 - val_accuracy300: 0.3454 - 112s/epoch - 23ms/step
Epoch 21/50
4812/4812 - 122s - loss: 3.2325 - accuracy300: 0.4045 - val_loss: 3.3218 - val_accuracy300: 0.3441 - 122s/epoch - 25ms/step
Epoch 22/50
4812/4812 - 119s - loss: 3.2313 - accuracy300: 0.4051 - val_loss: 3.3222 - val_accuracy300: 0.3447 - 119s/epoch - 25ms/step
Epoch 23/50
4812/4812 - 114s - loss: 3.2301 - accuracy300: 0.4056 - val_loss: 3.3242 - val_accuracy300: 0.3432 - 114s/epoch - 24ms/step
testing model: results/AAPL/W0/deepVOL_L2/h300
Evaluating performance on  test set...
19053/19053 - 182s - 182s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.115263
{'0': {'precision': 0.29085173285043114, 'recall': 0.6884900470909381, 'f1-score': 0.40894512487491885, 'support': 1353976}, '1': {'precision': 0.5044832741352713, 'recall': 0.06729399900517175, 'f1-score': 0.11874797597786323, 'support': 2201385}, '2': {'precision': 0.309126171905032, 'recall': 0.3223713968035459, 'f1-score': 0.31560987963691134, 'support': 1322090}, 'accuracy': 0.30887916659747067, 'macro avg': {'precision': 0.36815372629691145, 'recall': 0.3593851476332186, 'f1-score': 0.2811009934965645, 'support': 4877451}, 'weighted avg': {'precision': 0.3922255290486964, 'recall': 0.30887916659747067, 'f1-score': 0.25266815868879783, 'support': 4877451}}
[[ 932199   76828  344949]
 [1445660  148140  607585]
 [ 827207   68679  426204]]
Evaluating performance on  train set...
4812/4812 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010857
{'0': {'precision': 0.34007295855845643, 'recall': 0.6482861620543456, 'f1-score': 0.44612244380491145, 'support': 407098}, '1': {'precision': 0.3742929326804838, 'recall': 0.0411682831343078, 'f1-score': 0.0741777900858488, 'support': 406648}, '2': {'precision': 0.36979546759299803, 'recall': 0.36357091949239695, 'f1-score': 0.3666567776885358, 'support': 418122}, 'accuracy': 0.35123406079222774, 'macro avg': {'precision': 0.3613871196106461, 'recall': 0.35100845489368343, 'f1-score': 0.2956523371930987, 'support': 1231868}, 'weighted avg': {'precision': 0.36145765152825093, 'recall': 0.35123406079222774, 'f1-score': 0.2963686610997347, 'support': 1231868}}
[[263916  13991 129191]
 [260031  16741 129876]
 [252110  13995 152017]]
Evaluating performance on  val set...
1767/1767 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10462
{'0': {'precision': 0.34272004787885535, 'recall': 0.6577207649981303, 'f1-score': 0.45062954083780177, 'support': 149752}, '1': {'precision': 0.3572497381415532, 'recall': 0.030859210908973405, 'f1-score': 0.05681108381270784, 'support': 154735}, '2': {'precision': 0.3530801465008084, 'recall': 0.3619880113121254, 'f1-score': 0.3574785946462396, 'support': 147806}, 'accuracy': 0.3466204429429595, 'macro avg': {'precision': 0.351016644173739, 'recall': 0.35018932907307637, 'f1-score': 0.28830640643224975, 'support': 452293}, 'weighted avg': {'precision': 0.3510764371214812, 'recall': 0.3466204429429595, 'f1-score': 0.28545836264011143, 'support': 452293}}
[[98495  4383 46874]
 [98803  4775 51157]
 [90094  4208 53504]]
training model: results/AAPL/W0/deepVOL_L2/h500
Epoch 1/50
4812/4812 - 107s - loss: 3.2771 - accuracy500: 0.3747 - val_loss: 3.3923 - val_accuracy500: 0.3321 - 107s/epoch - 22ms/step
Epoch 2/50
4812/4812 - 106s - loss: 3.2780 - accuracy500: 0.3698 - val_loss: 3.4197 - val_accuracy500: 0.3328 - 106s/epoch - 22ms/step
Epoch 3/50
4812/4812 - 122s - loss: 3.2751 - accuracy500: 0.3715 - val_loss: 3.4022 - val_accuracy500: 0.3336 - 122s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 123s - loss: 3.2723 - accuracy500: 0.3764 - val_loss: 3.4117 - val_accuracy500: 0.3334 - 123s/epoch - 26ms/step
Epoch 5/50
4812/4812 - 123s - loss: 3.2732 - accuracy500: 0.3761 - val_loss: 3.4139 - val_accuracy500: 0.3342 - 123s/epoch - 26ms/step
Epoch 6/50
4812/4812 - 123s - loss: 3.2700 - accuracy500: 0.3799 - val_loss: 3.4276 - val_accuracy500: 0.3343 - 123s/epoch - 26ms/step
Epoch 7/50
4812/4812 - 121s - loss: 3.2650 - accuracy500: 0.3839 - val_loss: 3.4256 - val_accuracy500: 0.3338 - 121s/epoch - 25ms/step
Epoch 8/50
4812/4812 - 117s - loss: 3.2620 - accuracy500: 0.3863 - val_loss: 3.4367 - val_accuracy500: 0.3339 - 117s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 124s - loss: 3.2587 - accuracy500: 0.3886 - val_loss: 3.4493 - val_accuracy500: 0.3355 - 124s/epoch - 26ms/step
Epoch 10/50
4812/4812 - 121s - loss: 3.2557 - accuracy500: 0.3906 - val_loss: 3.4408 - val_accuracy500: 0.3360 - 121s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 122s - loss: 3.2523 - accuracy500: 0.3928 - val_loss: 3.4459 - val_accuracy500: 0.3357 - 122s/epoch - 25ms/step
testing model: results/AAPL/W0/deepVOL_L2/h500
Evaluating performance on  test set...
19053/19053 - 182s - 182s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1809554
{'0': {'precision': 0.2787228094257058, 'recall': 0.8543122737282812, 'f1-score': 0.4203158765350385, 'support': 1359538}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2187002}, '2': {'precision': 0.2778670938823317, 'recall': 0.1483036807119334, 'f1-score': 0.1933906087798292, 'support': 1330911}, 'accuracy': 0.27859818581468065, 'macro avg': {'precision': 0.18552996776934583, 'recall': 0.3342053181467382, 'f1-score': 0.20456882843828925, 'support': 4877451}, 'weighted avg': {'precision': 0.15351268985932062, 'recall': 0.27859818581468065, 'f1-score': 0.1699291483757529, 'support': 4877451}}
[[1161470       0  198068]
 [1872113       0  314889]
 [1133532       0  197379]]
Evaluating performance on  train set...
4812/4812 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.122541
{'0': {'precision': 0.3297744014553234, 'recall': 0.8323250635505547, 'f1-score': 0.4723855537568117, 'support': 405976}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 406063}, '2': {'precision': 0.347569685738553, 'recall': 0.1715507980630209, 'f1-score': 0.22971876021657137, 'support': 419829}, 'accuracy': 0.3327677965496303, 'macro avg': {'precision': 0.2257813623979588, 'recall': 0.3346252872045252, 'f1-score': 0.23403477132446102, 'support': 1231868}, 'weighted avg': {'precision': 0.22713499011189295, 'recall': 0.3327677965496303, 'f1-score': 0.23396970694501223, 'support': 1231868}}
[[337904      0  68072]
 [338941      0  67122]
 [347807      0  72022]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1284653
{'0': {'precision': 0.33295200915178036, 'recall': 0.8301033806468769, 'f1-score': 0.4752733030847468, 'support': 150415}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 154711}, '2': {'precision': 0.3261477149215879, 'recall': 0.1712748102495804, 'f1-score': 0.22460136065332745, 'support': 147167}, 'accuracy': 0.331789348939736, 'macro avg': {'precision': 0.21969990802445608, 'recall': 0.3337927302988191, 'f1-score': 0.2332915545793581, 'support': 452293}, 'weighted avg': {'precision': 0.21684871801781228, 'recall': 0.331789348939736, 'f1-score': 0.2311380948340134, 'support': 452293}}
[[124860      0  25555]
 [128188      0  26523]
 [121961      0  25206]]
training model: results/AAPL/W0/deepVOL_L2/h1000
Epoch 1/50
4812/4812 - 112s - loss: 3.2702 - accuracy1000: 0.3790 - val_loss: 3.4636 - val_accuracy1000: 0.3288 - 112s/epoch - 23ms/step
Epoch 2/50
4812/4812 - 122s - loss: 3.2728 - accuracy1000: 0.3756 - val_loss: 3.4607 - val_accuracy1000: 0.3331 - 122s/epoch - 25ms/step
Epoch 3/50
4812/4812 - 121s - loss: 3.2715 - accuracy1000: 0.3762 - val_loss: 3.4763 - val_accuracy1000: 0.3346 - 121s/epoch - 25ms/step
Epoch 4/50
4812/4812 - 123s - loss: 3.2676 - accuracy1000: 0.3807 - val_loss: 3.4639 - val_accuracy1000: 0.3332 - 123s/epoch - 26ms/step
Epoch 5/50
4812/4812 - 116s - loss: 3.2618 - accuracy1000: 0.3857 - val_loss: 3.4775 - val_accuracy1000: 0.3334 - 116s/epoch - 24ms/step
Epoch 6/50
4812/4812 - 116s - loss: 3.2588 - accuracy1000: 0.3868 - val_loss: 3.4741 - val_accuracy1000: 0.3345 - 116s/epoch - 24ms/step
Epoch 7/50
4812/4812 - 126s - loss: 3.2557 - accuracy1000: 0.3891 - val_loss: 3.4892 - val_accuracy1000: 0.3325 - 126s/epoch - 26ms/step
Epoch 8/50
4812/4812 - 114s - loss: 3.2511 - accuracy1000: 0.3926 - val_loss: 3.5079 - val_accuracy1000: 0.3328 - 114s/epoch - 24ms/step
Epoch 9/50
4812/4812 - 119s - loss: 3.2463 - accuracy1000: 0.3952 - val_loss: 3.5206 - val_accuracy1000: 0.3330 - 119s/epoch - 25ms/step
Epoch 10/50
4812/4812 - 118s - loss: 3.2417 - accuracy1000: 0.3982 - val_loss: 3.5270 - val_accuracy1000: 0.3308 - 118s/epoch - 25ms/step
Epoch 11/50
4812/4812 - 116s - loss: 3.2387 - accuracy1000: 0.4004 - val_loss: 3.5201 - val_accuracy1000: 0.3302 - 116s/epoch - 24ms/step
Epoch 12/50
4812/4812 - 109s - loss: 3.2363 - accuracy1000: 0.4020 - val_loss: 3.5091 - val_accuracy1000: 0.3306 - 109s/epoch - 23ms/step
testing model: results/AAPL/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
19053/19053 - 192s - 192s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2353822
{'0': {'precision': 0.26088824962267015, 'recall': 0.9391633908251359, 'f1-score': 0.4083435826988778, 'support': 1276008}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2371115}, '2': {'precision': 0.2714999524629475, 'recall': 0.06266865421253519, 'f1-score': 0.10183204705487686, 'support': 1230328}, 'accuracy': 0.26150606126027715, 'macro avg': {'precision': 0.1774627340285392, 'recall': 0.333944015012557, 'f1-score': 0.17005854325125158, 'support': 4877451}, 'weighted avg': {'precision': 0.13673730133595546, 'recall': 0.26150606126027715, 'f1-score': 0.1325152209753337, 'support': 4877451}}
[[1198380       0   77628]
 [2241857       0  129258]
 [1153224       1   77103]]
Evaluating performance on  train set...
4812/4812 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1412504
{'0': {'precision': 0.3285968492986366, 'recall': 0.899664420415289, 'f1-score': 0.4813746085853581, 'support': 404971}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 406776}, '2': {'precision': 0.3676065605731972, 'recall': 0.10771182587873493, 'f1-score': 0.16660653142373255, 'support': 420121}, 'accuracy': 0.3324950400529927, 'macro avg': {'precision': 0.23206780329061125, 'recall': 0.335792082098008, 'f1-score': 0.21599371333636355, 'support': 1231868}, 'weighted avg': {'precision': 0.2333946741792873, 'recall': 0.3324950400529927, 'f1-score': 0.21506984449769861, 'support': 1231868}}
[[364338      0  40633]
 [369562      0  37214]
 [374869      0  45252]]
Evaluating performance on  val set...
1767/1767 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.151416
{'0': {'precision': 0.33274007679284523, 'recall': 0.8921877492423034, 'f1-score': 0.48470875407805675, 'support': 150456}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 156334}, '2': {'precision': 0.3317986494782075, 'recall': 0.11144100121646976, 'f1-score': 0.16684416045438408, 'support': 145503}, 'accuracy': 0.33263835610986686, 'macro avg': {'precision': 0.22151290875701757, 'recall': 0.33454291681959103, 'f1-score': 0.21718430484414694, 'support': 452293}, 'weighted avg': {'precision': 0.2174264025509392, 'recall': 0.33263835610986686, 'f1-score': 0.21491304570745592, 'support': 452293}}
[[134235      0  16221]
 [139900      0  16434]
 [129288      0  16215]]
training model: results/AAPL/W0/deepVOL_L3/h10
Epoch 1/50
4812/4812 - 171s - loss: 3.2075 - accuracy10: 0.4125 - val_loss: 3.2961 - val_accuracy10: 0.4121 - 171s/epoch - 35ms/step
Epoch 2/50
4812/4812 - 179s - loss: 3.1310 - accuracy10: 0.4493 - val_loss: 3.2387 - val_accuracy10: 0.4214 - 179s/epoch - 37ms/step
Epoch 3/50
4812/4812 - 169s - loss: 3.0876 - accuracy10: 0.4675 - val_loss: 3.1936 - val_accuracy10: 0.4342 - 169s/epoch - 35ms/step
Epoch 4/50
4812/4812 - 169s - loss: 3.0634 - accuracy10: 0.4763 - val_loss: 3.1626 - val_accuracy10: 0.4462 - 169s/epoch - 35ms/step
Epoch 5/50
4812/4812 - 169s - loss: 3.0456 - accuracy10: 0.4821 - val_loss: 3.1451 - val_accuracy10: 0.4498 - 169s/epoch - 35ms/step
Epoch 6/50
4812/4812 - 169s - loss: 3.0306 - accuracy10: 0.4867 - val_loss: 3.1199 - val_accuracy10: 0.4601 - 169s/epoch - 35ms/step
Epoch 7/50
4812/4812 - 169s - loss: 3.0189 - accuracy10: 0.4899 - val_loss: 3.1319 - val_accuracy10: 0.4545 - 169s/epoch - 35ms/step
Epoch 8/50
4812/4812 - 170s - loss: 3.0084 - accuracy10: 0.4926 - val_loss: 3.1012 - val_accuracy10: 0.4670 - 170s/epoch - 35ms/step
Epoch 9/50
4812/4812 - 171s - loss: 2.9987 - accuracy10: 0.4954 - val_loss: 3.0877 - val_accuracy10: 0.4706 - 171s/epoch - 36ms/step
Epoch 10/50
4812/4812 - 170s - loss: 2.9910 - accuracy10: 0.4975 - val_loss: 3.0832 - val_accuracy10: 0.4742 - 170s/epoch - 35ms/step
Epoch 11/50
4812/4812 - 170s - loss: 2.9834 - accuracy10: 0.4995 - val_loss: 3.0748 - val_accuracy10: 0.4755 - 170s/epoch - 35ms/step
Epoch 12/50
4812/4812 - 168s - loss: 2.9770 - accuracy10: 0.5012 - val_loss: 3.0832 - val_accuracy10: 0.4737 - 168s/epoch - 35ms/step
Epoch 13/50
4812/4812 - 170s - loss: 2.9713 - accuracy10: 0.5027 - val_loss: 3.0601 - val_accuracy10: 0.4804 - 170s/epoch - 35ms/step
Epoch 14/50
4812/4812 - 169s - loss: 2.9660 - accuracy10: 0.5042 - val_loss: 3.0631 - val_accuracy10: 0.4808 - 169s/epoch - 35ms/step
Epoch 15/50
4812/4812 - 167s - loss: 2.9615 - accuracy10: 0.5056 - val_loss: 3.0516 - val_accuracy10: 0.4835 - 167s/epoch - 35ms/step
Epoch 16/50
4812/4812 - 170s - loss: 2.9566 - accuracy10: 0.5071 - val_loss: 3.0512 - val_accuracy10: 0.4833 - 170s/epoch - 35ms/step
Epoch 17/50
4812/4812 - 166s - loss: 2.9524 - accuracy10: 0.5078 - val_loss: 3.0523 - val_accuracy10: 0.4846 - 166s/epoch - 34ms/step
Epoch 18/50
4812/4812 - 167s - loss: 2.9487 - accuracy10: 0.5090 - val_loss: 3.0484 - val_accuracy10: 0.4858 - 167s/epoch - 35ms/step
Epoch 19/50
4812/4812 - 169s - loss: 2.9448 - accuracy10: 0.5094 - val_loss: 3.0411 - val_accuracy10: 0.4866 - 169s/epoch - 35ms/step
Epoch 20/50
4812/4812 - 168s - loss: 2.9415 - accuracy10: 0.5107 - val_loss: 3.0346 - val_accuracy10: 0.4886 - 168s/epoch - 35ms/step
Epoch 21/50
4812/4812 - 166s - loss: 2.9381 - accuracy10: 0.5117 - val_loss: 3.0432 - val_accuracy10: 0.4879 - 166s/epoch - 35ms/step
Epoch 22/50
4812/4812 - 163s - loss: 2.9354 - accuracy10: 0.5122 - val_loss: 3.0440 - val_accuracy10: 0.4887 - 163s/epoch - 34ms/step
Epoch 23/50
4812/4812 - 163s - loss: 2.9324 - accuracy10: 0.5129 - val_loss: 3.0368 - val_accuracy10: 0.4891 - 163s/epoch - 34ms/step
Epoch 24/50
4812/4812 - 164s - loss: 2.9292 - accuracy10: 0.5136 - val_loss: 3.0325 - val_accuracy10: 0.4903 - 164s/epoch - 34ms/step
Epoch 25/50
4812/4812 - 162s - loss: 2.9260 - accuracy10: 0.5145 - val_loss: 3.0312 - val_accuracy10: 0.4893 - 162s/epoch - 34ms/step
Epoch 26/50
4812/4812 - 166s - loss: 2.9239 - accuracy10: 0.5153 - val_loss: 3.0199 - val_accuracy10: 0.4918 - 166s/epoch - 35ms/step
Epoch 27/50
4812/4812 - 168s - loss: 2.9221 - accuracy10: 0.5155 - val_loss: 3.0201 - val_accuracy10: 0.4918 - 168s/epoch - 35ms/step
Epoch 28/50
4812/4812 - 169s - loss: 2.9185 - accuracy10: 0.5165 - val_loss: 3.0231 - val_accuracy10: 0.4932 - 169s/epoch - 35ms/step
Epoch 29/50
4812/4812 - 168s - loss: 2.9172 - accuracy10: 0.5169 - val_loss: 3.0265 - val_accuracy10: 0.4927 - 168s/epoch - 35ms/step
Epoch 30/50
4812/4812 - 170s - loss: 2.9148 - accuracy10: 0.5174 - val_loss: 3.0271 - val_accuracy10: 0.4915 - 170s/epoch - 35ms/step
Epoch 31/50
4812/4812 - 169s - loss: 2.9125 - accuracy10: 0.5183 - val_loss: 3.0203 - val_accuracy10: 0.4934 - 169s/epoch - 35ms/step
Epoch 32/50
4812/4812 - 171s - loss: 2.9101 - accuracy10: 0.5184 - val_loss: 3.0229 - val_accuracy10: 0.4927 - 171s/epoch - 36ms/step
Epoch 33/50
4812/4812 - 169s - loss: 2.9085 - accuracy10: 0.5194 - val_loss: 3.0182 - val_accuracy10: 0.4938 - 169s/epoch - 35ms/step
Epoch 34/50
4812/4812 - 170s - loss: 2.9067 - accuracy10: 0.5197 - val_loss: 3.0197 - val_accuracy10: 0.4946 - 170s/epoch - 35ms/step
Epoch 35/50
4812/4812 - 169s - loss: 2.9047 - accuracy10: 0.5203 - val_loss: 3.0172 - val_accuracy10: 0.4943 - 169s/epoch - 35ms/step
Epoch 36/50
4812/4812 - 170s - loss: 2.9028 - accuracy10: 0.5209 - val_loss: 3.0217 - val_accuracy10: 0.4941 - 170s/epoch - 35ms/step
Epoch 37/50
4812/4812 - 169s - loss: 2.9014 - accuracy10: 0.5210 - val_loss: 3.0149 - val_accuracy10: 0.4953 - 169s/epoch - 35ms/step
Epoch 38/50
4812/4812 - 168s - loss: 2.8996 - accuracy10: 0.5215 - val_loss: 3.0159 - val_accuracy10: 0.4942 - 168s/epoch - 35ms/step
Epoch 39/50
4812/4812 - 174s - loss: 2.8979 - accuracy10: 0.5222 - val_loss: 3.0193 - val_accuracy10: 0.4942 - 174s/epoch - 36ms/step
Epoch 40/50
4812/4812 - 168s - loss: 2.8963 - accuracy10: 0.5224 - val_loss: 3.0132 - val_accuracy10: 0.4953 - 168s/epoch - 35ms/step
Epoch 41/50
4812/4812 - 168s - loss: 2.8949 - accuracy10: 0.5225 - val_loss: 3.0136 - val_accuracy10: 0.4950 - 168s/epoch - 35ms/step
Epoch 42/50
4812/4812 - 169s - loss: 2.8929 - accuracy10: 0.5233 - val_loss: 3.0091 - val_accuracy10: 0.4960 - 169s/epoch - 35ms/step
Epoch 43/50
4812/4812 - 168s - loss: 2.8916 - accuracy10: 0.5235 - val_loss: 3.0216 - val_accuracy10: 0.4939 - 168s/epoch - 35ms/step
Epoch 44/50
4812/4812 - 168s - loss: 2.8902 - accuracy10: 0.5241 - val_loss: 3.0204 - val_accuracy10: 0.4949 - 168s/epoch - 35ms/step
Epoch 45/50
4812/4812 - 171s - loss: 2.8885 - accuracy10: 0.5243 - val_loss: 3.0129 - val_accuracy10: 0.4950 - 171s/epoch - 35ms/step
Epoch 46/50
4812/4812 - 169s - loss: 2.8869 - accuracy10: 0.5246 - val_loss: 3.0083 - val_accuracy10: 0.4964 - 169s/epoch - 35ms/step
Epoch 47/50
4812/4812 - 169s - loss: 2.8859 - accuracy10: 0.5253 - val_loss: 3.0097 - val_accuracy10: 0.4962 - 169s/epoch - 35ms/step
Epoch 48/50
4812/4812 - 171s - loss: 2.8842 - accuracy10: 0.5254 - val_loss: 3.0148 - val_accuracy10: 0.4950 - 171s/epoch - 35ms/step
Epoch 49/50
4812/4812 - 169s - loss: 2.8835 - accuracy10: 0.5258 - val_loss: 3.0121 - val_accuracy10: 0.4956 - 169s/epoch - 35ms/step
Epoch 50/50
4812/4812 - 166s - loss: 2.8819 - accuracy10: 0.5260 - val_loss: 3.0118 - val_accuracy10: 0.4954 - 166s/epoch - 34ms/step
testing model: results/AAPL/W0/deepVOL_L3/h10
Evaluating performance on  test set...
19053/19053 - 280s - 280s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9331243
{'0': {'precision': 0.4654163803254362, 'recall': 0.4837599766937978, 'f1-score': 0.47441092613431446, 'support': 1177369}, '1': {'precision': 0.6748035623162907, 'recall': 0.5749894445906921, 'f1-score': 0.6209107001875586, 'support': 2541351}, '2': {'precision': 0.4352235167477136, 'recall': 0.5589856489556247, 'f1-score': 0.4894014425583424, 'support': 1158731}, 'accuracy': 0.5491655374907918, 'macro avg': {'precision': 0.5251478197964802, 'recall': 0.5392450234133715, 'f1-score': 0.5282410229600718, 'support': 4877451}, 'weighted avg': {'precision': 0.5673427589468436, 'recall': 0.5491655374907918, 'f1-score': 0.5543045679928419, 'support': 4877451}}
[[ 569564  388099  219706]
 [ 459288 1461250  620813]
 [ 194921  316096  647714]]
Evaluating performance on  train set...
4812/4812 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.990038
{'0': {'precision': 0.49445877305822394, 'recall': 0.5698655868374921, 'f1-score': 0.5294909136597791, 'support': 406731}, '1': {'precision': 0.5433911829402662, 'recall': 0.33581698800126847, 'f1-score': 0.4151007608722075, 'support': 406793}, '2': {'precision': 0.49512028297277755, 'recall': 0.605621211251984, 'f1-score': 0.5448242790203579, 'support': 418344}, 'accuracy': 0.5047196615221761, 'macro avg': {'precision': 0.5109900796570893, 'recall': 0.5037679286969149, 'f1-score': 0.4964719845174481, 'support': 1231868}, 'weighted avg': {'precision': 0.5108421035098955, 'recall': 0.5047196615221761, 'f1-score': 0.49692371325802454, 'support': 1231868}}
[[231782  58453 116496]
 [128329 136608 141856]
 [108648  56338 253358]]
Evaluating performance on  val set...
1767/1767 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.001264
{'0': {'precision': 0.4868134526977982, 'recall': 0.572435002912845, 'f1-score': 0.5261637319120321, 'support': 147622}, '1': {'precision': 0.5426964078541252, 'recall': 0.32222301648676577, 'f1-score': 0.4043596863570197, 'support': 153881}, '2': {'precision': 0.48283077382954076, 'recall': 0.5998673652098946, 'f1-score': 0.5350234080873981, 'support': 150790}, 'accuracy': 0.49645252082167973, 'macro avg': {'precision': 0.5041135447938214, 'recall': 0.4981751282031685, 'f1-score': 0.48851560878548334, 'support': 452293}, 'weighted avg': {'precision': 0.5044983978016716, 'recall': 0.49645252082167973, 'f1-score': 0.48767678260358066, 'support': 452293}}
[[84504 21622 41496]
 [48906 49584 55391]
 [40176 20160 90454]]
training model: results/AAPL/W0/deepVOL_L3/h20
Epoch 1/50
4812/4812 - 173s - loss: 3.2288 - accuracy20: 0.4063 - val_loss: 3.2932 - val_accuracy20: 0.3912 - 173s/epoch - 36ms/step
Epoch 2/50
4812/4812 - 169s - loss: 3.1848 - accuracy20: 0.4277 - val_loss: 3.2581 - val_accuracy20: 0.4024 - 169s/epoch - 35ms/step
Epoch 3/50
4812/4812 - 179s - loss: 3.1685 - accuracy20: 0.4359 - val_loss: 3.2607 - val_accuracy20: 0.4028 - 179s/epoch - 37ms/step
Epoch 4/50
4812/4812 - 178s - loss: 3.1512 - accuracy20: 0.4437 - val_loss: 3.2380 - val_accuracy20: 0.4119 - 178s/epoch - 37ms/step
Epoch 5/50
4812/4812 - 168s - loss: 3.1370 - accuracy20: 0.4499 - val_loss: 3.2171 - val_accuracy20: 0.4201 - 168s/epoch - 35ms/step
Epoch 6/50
4812/4812 - 166s - loss: 3.1284 - accuracy20: 0.4534 - val_loss: 3.2014 - val_accuracy20: 0.4229 - 166s/epoch - 35ms/step
Epoch 7/50
4812/4812 - 167s - loss: 3.1197 - accuracy20: 0.4568 - val_loss: 3.1894 - val_accuracy20: 0.4262 - 167s/epoch - 35ms/step
Epoch 8/50
4812/4812 - 167s - loss: 3.1129 - accuracy20: 0.4589 - val_loss: 3.1851 - val_accuracy20: 0.4285 - 167s/epoch - 35ms/step
Epoch 9/50
4812/4812 - 165s - loss: 3.1072 - accuracy20: 0.4614 - val_loss: 3.1721 - val_accuracy20: 0.4324 - 165s/epoch - 34ms/step
Epoch 10/50
4812/4812 - 166s - loss: 3.1022 - accuracy20: 0.4628 - val_loss: 3.1645 - val_accuracy20: 0.4343 - 166s/epoch - 35ms/step
Epoch 11/50
4812/4812 - 169s - loss: 3.0975 - accuracy20: 0.4645 - val_loss: 3.1582 - val_accuracy20: 0.4373 - 169s/epoch - 35ms/step
Epoch 12/50
4812/4812 - 168s - loss: 3.0924 - accuracy20: 0.4661 - val_loss: 3.1536 - val_accuracy20: 0.4397 - 168s/epoch - 35ms/step
Epoch 13/50
4812/4812 - 171s - loss: 3.0883 - accuracy20: 0.4671 - val_loss: 3.1438 - val_accuracy20: 0.4435 - 171s/epoch - 36ms/step
Epoch 14/50
4812/4812 - 172s - loss: 3.0845 - accuracy20: 0.4685 - val_loss: 3.1401 - val_accuracy20: 0.4446 - 172s/epoch - 36ms/step
Epoch 15/50
4812/4812 - 170s - loss: 3.0814 - accuracy20: 0.4693 - val_loss: 3.1334 - val_accuracy20: 0.4468 - 170s/epoch - 35ms/step
Epoch 16/50
4812/4812 - 169s - loss: 3.0784 - accuracy20: 0.4701 - val_loss: 3.1291 - val_accuracy20: 0.4489 - 169s/epoch - 35ms/step
Epoch 17/50
4812/4812 - 166s - loss: 3.0754 - accuracy20: 0.4708 - val_loss: 3.1287 - val_accuracy20: 0.4487 - 166s/epoch - 35ms/step
Epoch 18/50
4812/4812 - 167s - loss: 3.0720 - accuracy20: 0.4722 - val_loss: 3.1223 - val_accuracy20: 0.4525 - 167s/epoch - 35ms/step
Epoch 19/50
4812/4812 - 178s - loss: 3.0696 - accuracy20: 0.4728 - val_loss: 3.1231 - val_accuracy20: 0.4516 - 178s/epoch - 37ms/step
Epoch 20/50
4812/4812 - 178s - loss: 3.0668 - accuracy20: 0.4739 - val_loss: 3.1204 - val_accuracy20: 0.4527 - 178s/epoch - 37ms/step
Epoch 21/50
4812/4812 - 167s - loss: 3.0641 - accuracy20: 0.4748 - val_loss: 3.1224 - val_accuracy20: 0.4525 - 167s/epoch - 35ms/step
Epoch 22/50
4812/4812 - 167s - loss: 3.0616 - accuracy20: 0.4755 - val_loss: 3.1179 - val_accuracy20: 0.4532 - 167s/epoch - 35ms/step
Epoch 23/50
4812/4812 - 167s - loss: 3.0598 - accuracy20: 0.4756 - val_loss: 3.1172 - val_accuracy20: 0.4544 - 167s/epoch - 35ms/step
Epoch 24/50
4812/4812 - 166s - loss: 3.0571 - accuracy20: 0.4766 - val_loss: 3.1136 - val_accuracy20: 0.4556 - 166s/epoch - 35ms/step
Epoch 25/50
4812/4812 - 169s - loss: 3.0548 - accuracy20: 0.4770 - val_loss: 3.1136 - val_accuracy20: 0.4557 - 169s/epoch - 35ms/step
Epoch 26/50
4812/4812 - 169s - loss: 3.0525 - accuracy20: 0.4781 - val_loss: 3.1135 - val_accuracy20: 0.4560 - 169s/epoch - 35ms/step
Epoch 27/50
4812/4812 - 168s - loss: 3.0504 - accuracy20: 0.4784 - val_loss: 3.1129 - val_accuracy20: 0.4562 - 168s/epoch - 35ms/step
Epoch 28/50
4812/4812 - 169s - loss: 3.0487 - accuracy20: 0.4789 - val_loss: 3.1124 - val_accuracy20: 0.4555 - 169s/epoch - 35ms/step
Epoch 29/50
4812/4812 - 168s - loss: 3.0465 - accuracy20: 0.4795 - val_loss: 3.1106 - val_accuracy20: 0.4564 - 168s/epoch - 35ms/step
Epoch 30/50
4812/4812 - 168s - loss: 3.0450 - accuracy20: 0.4803 - val_loss: 3.1103 - val_accuracy20: 0.4574 - 168s/epoch - 35ms/step
Epoch 31/50
4812/4812 - 167s - loss: 3.0433 - accuracy20: 0.4805 - val_loss: 3.1118 - val_accuracy20: 0.4566 - 167s/epoch - 35ms/step
Epoch 32/50
4812/4812 - 179s - loss: 3.0420 - accuracy20: 0.4808 - val_loss: 3.1120 - val_accuracy20: 0.4564 - 179s/epoch - 37ms/step
Epoch 33/50
4812/4812 - 166s - loss: 3.0403 - accuracy20: 0.4812 - val_loss: 3.1110 - val_accuracy20: 0.4572 - 166s/epoch - 35ms/step
Epoch 34/50
4812/4812 - 165s - loss: 3.0384 - accuracy20: 0.4820 - val_loss: 3.1122 - val_accuracy20: 0.4567 - 165s/epoch - 34ms/step
Epoch 35/50
4812/4812 - 165s - loss: 3.0369 - accuracy20: 0.4826 - val_loss: 3.1097 - val_accuracy20: 0.4577 - 165s/epoch - 34ms/step
Epoch 36/50
4812/4812 - 166s - loss: 3.0354 - accuracy20: 0.4834 - val_loss: 3.1101 - val_accuracy20: 0.4580 - 166s/epoch - 35ms/step
Epoch 37/50
4812/4812 - 169s - loss: 3.0341 - accuracy20: 0.4832 - val_loss: 3.1107 - val_accuracy20: 0.4579 - 169s/epoch - 35ms/step
Epoch 38/50
4812/4812 - 179s - loss: 3.0329 - accuracy20: 0.4839 - val_loss: 3.1073 - val_accuracy20: 0.4593 - 179s/epoch - 37ms/step
Epoch 39/50
4812/4812 - 179s - loss: 3.0312 - accuracy20: 0.4845 - val_loss: 3.1091 - val_accuracy20: 0.4582 - 179s/epoch - 37ms/step
Epoch 40/50
4812/4812 - 167s - loss: 3.0295 - accuracy20: 0.4850 - val_loss: 3.1110 - val_accuracy20: 0.4584 - 167s/epoch - 35ms/step
Epoch 41/50
4812/4812 - 166s - loss: 3.0287 - accuracy20: 0.4852 - val_loss: 3.1087 - val_accuracy20: 0.4594 - 166s/epoch - 35ms/step
Epoch 42/50
4812/4812 - 169s - loss: 3.0269 - accuracy20: 0.4856 - val_loss: 3.1099 - val_accuracy20: 0.4590 - 169s/epoch - 35ms/step
Epoch 43/50
4812/4812 - 168s - loss: 3.0260 - accuracy20: 0.4863 - val_loss: 3.1111 - val_accuracy20: 0.4582 - 168s/epoch - 35ms/step
Epoch 44/50
4812/4812 - 168s - loss: 3.0241 - accuracy20: 0.4867 - val_loss: 3.1107 - val_accuracy20: 0.4590 - 168s/epoch - 35ms/step
Epoch 45/50
4812/4812 - 169s - loss: 3.0234 - accuracy20: 0.4867 - val_loss: 3.1109 - val_accuracy20: 0.4582 - 169s/epoch - 35ms/step
Epoch 46/50
4812/4812 - 177s - loss: 3.0222 - accuracy20: 0.4871 - val_loss: 3.1100 - val_accuracy20: 0.4595 - 177s/epoch - 37ms/step
Epoch 47/50
4812/4812 - 176s - loss: 3.0210 - accuracy20: 0.4874 - val_loss: 3.1143 - val_accuracy20: 0.4584 - 176s/epoch - 36ms/step
Epoch 48/50
4812/4812 - 164s - loss: 3.0190 - accuracy20: 0.4882 - val_loss: 3.1102 - val_accuracy20: 0.4589 - 164s/epoch - 34ms/step
testing model: results/AAPL/W0/deepVOL_L3/h20
Evaluating performance on  test set...
19053/19053 - 255s - 255s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9706967
{'0': {'precision': 0.43875036769276443, 'recall': 0.517750765385266, 'f1-score': 0.4749881225022321, 'support': 1247411}, '1': {'precision': 0.6184203508885239, 'recall': 0.5275207359731414, 'f1-score': 0.5693653231946014, 'support': 2395957}, '2': {'precision': 0.43846477548211693, 'recall': 0.4837891778753941, 'f1-score': 0.4600132371036478, 'support': 1234083}, 'accuracy': 0.5139571878835892, 'macro avg': {'precision': 0.4985451646878018, 'recall': 0.5096868930779338, 'f1-score': 0.5014555609334937, 'support': 4877451}, 'weighted avg': {'precision': 0.5269376420366112, 'recall': 0.5139571878835892, 'f1-score': 0.5175602494476276, 'support': 4877451}}
[[ 645848  390164  211399]
 [ 578824 1263917  553216]
 [ 247345  389702  597036]]
Evaluating performance on  train set...
4812/4812 - 80s - 80s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0289882
{'0': {'precision': 0.45234285714285716, 'recall': 0.5838303479676076, 'f1-score': 0.5097439045593187, 'support': 406762}, '1': {'precision': 0.4800212928768673, 'recall': 0.24822060558395595, 'f1-score': 0.3272296643819083, 'support': 406880}, '2': {'precision': 0.471487645754317, 'recall': 0.5596949974415747, 'f1-score': 0.511818693662915, 'support': 418226}, 'accuracy': 0.46478599979867974, 'macro avg': {'precision': 0.4679505985913471, 'recall': 0.46391531699771277, 'f1-score': 0.4495974208680473, 'support': 1231868}, 'weighted avg': {'precision': 0.46798467127657156, 'recall': 0.46478599979867974, 'f1-score': 0.45016474242851895, 'support': 1231868}}
[[237480  53410 115872]
 [159366 100996 146518]
 [128154  55993 234079]]
Evaluating performance on  val set...
1767/1767 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0351831
{'0': {'precision': 0.45017427411833966, 'recall': 0.5853549484124027, 'f1-score': 0.5089411931014984, 'support': 147613}, '1': {'precision': 0.4808914347086727, 'recall': 0.2438077334456941, 'f1-score': 0.323568884530016, 'support': 154265}, '2': {'precision': 0.45866160104972464, 'recall': 0.5554100322441246, 'f1-score': 0.5024206303862785, 'support': 150415}, 'accuracy': 0.45890385214893886, 'macro avg': {'precision': 0.46324243662557896, 'recall': 0.4615242380340738, 'f1-score': 0.4449769026725976, 'support': 452293}, 'weighted avg': {'precision': 0.4634736266593961, 'recall': 0.45890385214893886, 'f1-score': 0.4435471904912667, 'support': 452293}}
[[86406 19977 41230]
 [59283 37611 57371]
 [46250 20623 83542]]
training model: results/AAPL/W0/deepVOL_L3/h30
Epoch 1/50
4812/4812 - 164s - loss: 3.2456 - accuracy30: 0.3991 - val_loss: 3.2736 - val_accuracy30: 0.3894 - 164s/epoch - 34ms/step
Epoch 2/50
4812/4812 - 173s - loss: 3.2080 - accuracy30: 0.4191 - val_loss: 3.2673 - val_accuracy30: 0.3914 - 173s/epoch - 36ms/step
Epoch 3/50
4812/4812 - 167s - loss: 3.1971 - accuracy30: 0.4243 - val_loss: 3.2529 - val_accuracy30: 0.3961 - 167s/epoch - 35ms/step
Epoch 4/50
4812/4812 - 159s - loss: 3.1859 - accuracy30: 0.4302 - val_loss: 3.2456 - val_accuracy30: 0.3972 - 159s/epoch - 33ms/step
Epoch 5/50
4812/4812 - 158s - loss: 3.1785 - accuracy30: 0.4332 - val_loss: 3.2403 - val_accuracy30: 0.4007 - 158s/epoch - 33ms/step
Epoch 6/50
4812/4812 - 159s - loss: 3.1734 - accuracy30: 0.4354 - val_loss: 3.2301 - val_accuracy30: 0.4021 - 159s/epoch - 33ms/step
Epoch 7/50
4812/4812 - 160s - loss: 3.1688 - accuracy30: 0.4374 - val_loss: 3.2264 - val_accuracy30: 0.4041 - 160s/epoch - 33ms/step
Epoch 8/50
4812/4812 - 159s - loss: 3.1648 - accuracy30: 0.4391 - val_loss: 3.2224 - val_accuracy30: 0.4064 - 159s/epoch - 33ms/step
Epoch 9/50
4812/4812 - 158s - loss: 3.1614 - accuracy30: 0.4405 - val_loss: 3.2160 - val_accuracy30: 0.4080 - 158s/epoch - 33ms/step
Epoch 10/50
4812/4812 - 158s - loss: 3.1580 - accuracy30: 0.4419 - val_loss: 3.2118 - val_accuracy30: 0.4094 - 158s/epoch - 33ms/step
Epoch 11/50
4812/4812 - 158s - loss: 3.1553 - accuracy30: 0.4430 - val_loss: 3.2097 - val_accuracy30: 0.4117 - 158s/epoch - 33ms/step
Epoch 12/50
4812/4812 - 160s - loss: 3.1525 - accuracy30: 0.4441 - val_loss: 3.2050 - val_accuracy30: 0.4137 - 160s/epoch - 33ms/step
Epoch 13/50
4812/4812 - 160s - loss: 3.1496 - accuracy30: 0.4452 - val_loss: 3.2052 - val_accuracy30: 0.4138 - 160s/epoch - 33ms/step
Epoch 14/50
4812/4812 - 158s - loss: 3.1468 - accuracy30: 0.4460 - val_loss: 3.2020 - val_accuracy30: 0.4154 - 158s/epoch - 33ms/step
Epoch 15/50
4812/4812 - 156s - loss: 3.1438 - accuracy30: 0.4468 - val_loss: 3.1994 - val_accuracy30: 0.4167 - 156s/epoch - 33ms/step
Epoch 16/50
4812/4812 - 158s - loss: 3.1412 - accuracy30: 0.4481 - val_loss: 3.1967 - val_accuracy30: 0.4180 - 158s/epoch - 33ms/step
Epoch 17/50
4812/4812 - 157s - loss: 3.1386 - accuracy30: 0.4487 - val_loss: 3.1942 - val_accuracy30: 0.4193 - 157s/epoch - 33ms/step
Epoch 18/50
4812/4812 - 157s - loss: 3.1363 - accuracy30: 0.4499 - val_loss: 3.1890 - val_accuracy30: 0.4219 - 157s/epoch - 33ms/step
Epoch 19/50
4812/4812 - 157s - loss: 3.1338 - accuracy30: 0.4505 - val_loss: 3.1890 - val_accuracy30: 0.4220 - 157s/epoch - 33ms/step
Epoch 20/50
4812/4812 - 159s - loss: 3.1315 - accuracy30: 0.4514 - val_loss: 3.1892 - val_accuracy30: 0.4216 - 159s/epoch - 33ms/step
Epoch 21/50
4812/4812 - 158s - loss: 3.1299 - accuracy30: 0.4519 - val_loss: 3.1851 - val_accuracy30: 0.4239 - 158s/epoch - 33ms/step
Epoch 22/50
4812/4812 - 158s - loss: 3.1275 - accuracy30: 0.4531 - val_loss: 3.1856 - val_accuracy30: 0.4242 - 158s/epoch - 33ms/step
Epoch 23/50
4812/4812 - 158s - loss: 3.1253 - accuracy30: 0.4533 - val_loss: 3.1830 - val_accuracy30: 0.4251 - 158s/epoch - 33ms/step
Epoch 24/50
4812/4812 - 157s - loss: 3.1238 - accuracy30: 0.4539 - val_loss: 3.1822 - val_accuracy30: 0.4254 - 157s/epoch - 33ms/step
Epoch 25/50
4812/4812 - 158s - loss: 3.1219 - accuracy30: 0.4545 - val_loss: 3.1826 - val_accuracy30: 0.4260 - 158s/epoch - 33ms/step
Epoch 26/50
4812/4812 - 161s - loss: 3.1201 - accuracy30: 0.4548 - val_loss: 3.1836 - val_accuracy30: 0.4263 - 161s/epoch - 34ms/step
Epoch 27/50
4812/4812 - 163s - loss: 3.1185 - accuracy30: 0.4556 - val_loss: 3.1798 - val_accuracy30: 0.4275 - 163s/epoch - 34ms/step
Epoch 28/50
4812/4812 - 159s - loss: 3.1166 - accuracy30: 0.4566 - val_loss: 3.1798 - val_accuracy30: 0.4269 - 159s/epoch - 33ms/step
Epoch 29/50
4812/4812 - 160s - loss: 3.1151 - accuracy30: 0.4567 - val_loss: 3.1812 - val_accuracy30: 0.4277 - 160s/epoch - 33ms/step
Epoch 30/50
4812/4812 - 159s - loss: 3.1134 - accuracy30: 0.4574 - val_loss: 3.1788 - val_accuracy30: 0.4285 - 159s/epoch - 33ms/step
Epoch 31/50
4812/4812 - 157s - loss: 3.1119 - accuracy30: 0.4579 - val_loss: 3.1799 - val_accuracy30: 0.4278 - 157s/epoch - 33ms/step
Epoch 32/50
4812/4812 - 159s - loss: 3.1106 - accuracy30: 0.4581 - val_loss: 3.1785 - val_accuracy30: 0.4285 - 159s/epoch - 33ms/step
Epoch 33/50
4812/4812 - 160s - loss: 3.1090 - accuracy30: 0.4586 - val_loss: 3.1773 - val_accuracy30: 0.4297 - 160s/epoch - 33ms/step
Epoch 34/50
4812/4812 - 171s - loss: 3.1074 - accuracy30: 0.4591 - val_loss: 3.1774 - val_accuracy30: 0.4298 - 171s/epoch - 35ms/step
Epoch 35/50
4812/4812 - 181s - loss: 3.1063 - accuracy30: 0.4594 - val_loss: 3.1794 - val_accuracy30: 0.4288 - 181s/epoch - 38ms/step
Epoch 36/50
4812/4812 - 165s - loss: 3.1047 - accuracy30: 0.4601 - val_loss: 3.1798 - val_accuracy30: 0.4298 - 165s/epoch - 34ms/step
Epoch 37/50
4812/4812 - 159s - loss: 3.1035 - accuracy30: 0.4604 - val_loss: 3.1790 - val_accuracy30: 0.4297 - 159s/epoch - 33ms/step
Epoch 38/50
4812/4812 - 161s - loss: 3.1027 - accuracy30: 0.4609 - val_loss: 3.1769 - val_accuracy30: 0.4309 - 161s/epoch - 33ms/step
Epoch 39/50
4812/4812 - 160s - loss: 3.1013 - accuracy30: 0.4608 - val_loss: 3.1775 - val_accuracy30: 0.4314 - 160s/epoch - 33ms/step
Epoch 40/50
4812/4812 - 161s - loss: 3.0999 - accuracy30: 0.4618 - val_loss: 3.1765 - val_accuracy30: 0.4310 - 161s/epoch - 33ms/step
Epoch 41/50
4812/4812 - 157s - loss: 3.0988 - accuracy30: 0.4623 - val_loss: 3.1799 - val_accuracy30: 0.4308 - 157s/epoch - 33ms/step
Epoch 42/50
4812/4812 - 163s - loss: 3.0973 - accuracy30: 0.4628 - val_loss: 3.1777 - val_accuracy30: 0.4309 - 163s/epoch - 34ms/step
Epoch 43/50
4812/4812 - 164s - loss: 3.0961 - accuracy30: 0.4630 - val_loss: 3.1768 - val_accuracy30: 0.4310 - 164s/epoch - 34ms/step
Epoch 44/50
4812/4812 - 158s - loss: 3.0947 - accuracy30: 0.4635 - val_loss: 3.1761 - val_accuracy30: 0.4314 - 158s/epoch - 33ms/step
Epoch 45/50
4812/4812 - 159s - loss: 3.0938 - accuracy30: 0.4638 - val_loss: 3.1756 - val_accuracy30: 0.4321 - 159s/epoch - 33ms/step
Epoch 46/50
4812/4812 - 159s - loss: 3.0926 - accuracy30: 0.4641 - val_loss: 3.1778 - val_accuracy30: 0.4311 - 159s/epoch - 33ms/step
Epoch 47/50
4812/4812 - 163s - loss: 3.0916 - accuracy30: 0.4648 - val_loss: 3.1742 - val_accuracy30: 0.4331 - 163s/epoch - 34ms/step
Epoch 48/50
4812/4812 - 160s - loss: 3.0900 - accuracy30: 0.4652 - val_loss: 3.1785 - val_accuracy30: 0.4315 - 160s/epoch - 33ms/step
Epoch 49/50
4812/4812 - 159s - loss: 3.0890 - accuracy30: 0.4655 - val_loss: 3.1728 - val_accuracy30: 0.4332 - 159s/epoch - 33ms/step
Epoch 50/50
4812/4812 - 166s - loss: 3.0877 - accuracy30: 0.4661 - val_loss: 3.1740 - val_accuracy30: 0.4325 - 166s/epoch - 35ms/step
testing model: results/AAPL/W0/deepVOL_L3/h30
Evaluating performance on  test set...
19053/19053 - 265s - 265s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0146184
{'0': {'precision': 0.4085665901903194, 'recall': 0.5173689497987348, 'f1-score': 0.4565753415018812, 'support': 1316919}, '1': {'precision': 0.5628545075689996, 'recall': 0.4439695019978413, 'f1-score': 0.49639307972037244, 'support': 2259689}, '2': {'precision': 0.4216484019192521, 'recall': 0.46267996983494547, 'f1-score': 0.4412122829305267, 'support': 1300843}, 'accuracy': 0.4687776463566728, 'macro avg': {'precision': 0.46435649989285704, 'recall': 0.47467280721050725, 'f1-score': 0.46472690138426015, 'support': 4877451}, 'weighted avg': {'precision': 0.4835360963828803, 'recall': 0.4687776463566728, 'f1-score': 0.47092520946694494, 'support': 4877451}}
[[ 681333  387867  247719]
 [ 678618 1003233  577838]
 [ 307667  391302  601874]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0517226
{'0': {'precision': 0.43007106642977855, 'recall': 0.5875443382683039, 'f1-score': 0.49662341778090063, 'support': 405406}, '1': {'precision': 0.43318832636843185, 'recall': 0.18635338844436586, 'f1-score': 0.26059944156526577, 'support': 407178}, '2': {'precision': 0.4529229043702372, 'recall': 0.5431998359107431, 'f1-score': 0.4939705467716399, 'support': 419284}, 'accuracy': 0.43984258053622627, 'macro avg': {'precision': 0.43872743238948253, 'recall': 0.4390325208744709, 'f1-score': 0.41706446870593544, 'support': 1231868}, 'weighted avg': {'precision': 0.43887938817068606, 'recall': 0.43984258053622627, 'f1-score': 0.41770580894961623, 'support': 1231868}}
[[238194  48926 118286]
 [174484  75879 156815]
 [141170  50359 227755]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0571021
{'0': {'precision': 0.42446085701193825, 'recall': 0.5850844188478831, 'f1-score': 0.491994643106998, 'support': 147242}, '1': {'precision': 0.4371643878886332, 'recall': 0.18793404461687682, 'f1-score': 0.262864430003663, 'support': 154650}, '2': {'precision': 0.44060946464022227, 'recall': 0.5356679809309779, 'f1-score': 0.48351087771942985, 'support': 150401}, 'accuracy': 0.43285657748406453, 'macro avg': {'precision': 0.43407823651359795, 'recall': 0.4362288147985793, 'f1-score': 0.41278998361003033, 'support': 452293}, 'weighted avg': {'precision': 0.4341744006351701, 'recall': 0.43285657748406453, 'f1-score': 0.4108283322101095, 'support': 452293}}
[[86149 18707 42386]
 [65688 29064 59898]
 [51124 18712 80565]]
training model: results/AAPL/W0/deepVOL_L3/h50
Epoch 1/50
4812/4812 - 165s - loss: 3.2176 - accuracy50: 0.4117 - val_loss: 3.2839 - val_accuracy50: 0.3607 - 165s/epoch - 34ms/step
Epoch 2/50
4812/4812 - 161s - loss: 3.1920 - accuracy50: 0.4281 - val_loss: 3.2655 - val_accuracy50: 0.3732 - 161s/epoch - 33ms/step
Epoch 3/50
4812/4812 - 161s - loss: 3.1849 - accuracy50: 0.4324 - val_loss: 3.2700 - val_accuracy50: 0.3702 - 161s/epoch - 33ms/step
Epoch 4/50
4812/4812 - 158s - loss: 3.1797 - accuracy50: 0.4351 - val_loss: 3.2604 - val_accuracy50: 0.3723 - 158s/epoch - 33ms/step
Epoch 5/50
4812/4812 - 158s - loss: 3.1742 - accuracy50: 0.4380 - val_loss: 3.2480 - val_accuracy50: 0.3828 - 158s/epoch - 33ms/step
Epoch 6/50
4812/4812 - 156s - loss: 3.1676 - accuracy50: 0.4411 - val_loss: 3.2450 - val_accuracy50: 0.3882 - 156s/epoch - 32ms/step
Epoch 7/50
4812/4812 - 162s - loss: 3.1628 - accuracy50: 0.4431 - val_loss: 3.2387 - val_accuracy50: 0.3935 - 162s/epoch - 34ms/step
Epoch 8/50
4812/4812 - 172s - loss: 3.1595 - accuracy50: 0.4445 - val_loss: 3.2381 - val_accuracy50: 0.3934 - 172s/epoch - 36ms/step
Epoch 9/50
4812/4812 - 169s - loss: 3.1569 - accuracy50: 0.4457 - val_loss: 3.2368 - val_accuracy50: 0.3948 - 169s/epoch - 35ms/step
Epoch 10/50
4812/4812 - 161s - loss: 3.1543 - accuracy50: 0.4468 - val_loss: 3.2331 - val_accuracy50: 0.3972 - 161s/epoch - 33ms/step
Epoch 11/50
4812/4812 - 163s - loss: 3.1519 - accuracy50: 0.4475 - val_loss: 3.2312 - val_accuracy50: 0.3997 - 163s/epoch - 34ms/step
Epoch 12/50
4812/4812 - 162s - loss: 3.1499 - accuracy50: 0.4483 - val_loss: 3.2290 - val_accuracy50: 0.4007 - 162s/epoch - 34ms/step
Epoch 13/50
4812/4812 - 164s - loss: 3.1476 - accuracy50: 0.4494 - val_loss: 3.2279 - val_accuracy50: 0.4015 - 164s/epoch - 34ms/step
Epoch 14/50
4812/4812 - 163s - loss: 3.1459 - accuracy50: 0.4500 - val_loss: 3.2263 - val_accuracy50: 0.4028 - 163s/epoch - 34ms/step
Epoch 15/50
4812/4812 - 164s - loss: 3.1436 - accuracy50: 0.4507 - val_loss: 3.2227 - val_accuracy50: 0.4046 - 164s/epoch - 34ms/step
Epoch 16/50
4812/4812 - 163s - loss: 3.1418 - accuracy50: 0.4512 - val_loss: 3.2216 - val_accuracy50: 0.4063 - 163s/epoch - 34ms/step
Epoch 17/50
4812/4812 - 163s - loss: 3.1404 - accuracy50: 0.4517 - val_loss: 3.2198 - val_accuracy50: 0.4079 - 163s/epoch - 34ms/step
Epoch 18/50
4812/4812 - 161s - loss: 3.1391 - accuracy50: 0.4518 - val_loss: 3.2180 - val_accuracy50: 0.4096 - 161s/epoch - 34ms/step
Epoch 19/50
4812/4812 - 161s - loss: 3.1379 - accuracy50: 0.4524 - val_loss: 3.2176 - val_accuracy50: 0.4107 - 161s/epoch - 33ms/step
Epoch 20/50
4812/4812 - 173s - loss: 3.1365 - accuracy50: 0.4527 - val_loss: 3.2168 - val_accuracy50: 0.4114 - 173s/epoch - 36ms/step
Epoch 21/50
4812/4812 - 172s - loss: 3.1353 - accuracy50: 0.4533 - val_loss: 3.2159 - val_accuracy50: 0.4119 - 172s/epoch - 36ms/step
Epoch 22/50
4812/4812 - 158s - loss: 3.1342 - accuracy50: 0.4538 - val_loss: 3.2143 - val_accuracy50: 0.4120 - 158s/epoch - 33ms/step
Epoch 23/50
4812/4812 - 157s - loss: 3.1331 - accuracy50: 0.4542 - val_loss: 3.2135 - val_accuracy50: 0.4137 - 157s/epoch - 33ms/step
Epoch 24/50
4812/4812 - 160s - loss: 3.1315 - accuracy50: 0.4548 - val_loss: 3.2130 - val_accuracy50: 0.4131 - 160s/epoch - 33ms/step
Epoch 25/50
4812/4812 - 164s - loss: 3.1311 - accuracy50: 0.4549 - val_loss: 3.2130 - val_accuracy50: 0.4130 - 164s/epoch - 34ms/step
Epoch 26/50
4812/4812 - 158s - loss: 3.1295 - accuracy50: 0.4556 - val_loss: 3.2118 - val_accuracy50: 0.4140 - 158s/epoch - 33ms/step
Epoch 27/50
4812/4812 - 157s - loss: 3.1281 - accuracy50: 0.4557 - val_loss: 3.2106 - val_accuracy50: 0.4151 - 157s/epoch - 33ms/step
Epoch 28/50
4812/4812 - 161s - loss: 3.1271 - accuracy50: 0.4564 - val_loss: 3.2103 - val_accuracy50: 0.4150 - 161s/epoch - 33ms/step
Epoch 29/50
4812/4812 - 162s - loss: 3.1261 - accuracy50: 0.4567 - val_loss: 3.2105 - val_accuracy50: 0.4155 - 162s/epoch - 34ms/step
Epoch 30/50
4812/4812 - 160s - loss: 3.1249 - accuracy50: 0.4570 - val_loss: 3.2088 - val_accuracy50: 0.4162 - 160s/epoch - 33ms/step
Epoch 31/50
4812/4812 - 159s - loss: 3.1241 - accuracy50: 0.4570 - val_loss: 3.2078 - val_accuracy50: 0.4170 - 159s/epoch - 33ms/step
Epoch 32/50
4812/4812 - 173s - loss: 3.1231 - accuracy50: 0.4577 - val_loss: 3.2068 - val_accuracy50: 0.4162 - 173s/epoch - 36ms/step
Epoch 33/50
4812/4812 - 157s - loss: 3.1219 - accuracy50: 0.4585 - val_loss: 3.2078 - val_accuracy50: 0.4165 - 157s/epoch - 33ms/step
Epoch 34/50
4812/4812 - 173s - loss: 3.1205 - accuracy50: 0.4585 - val_loss: 3.2074 - val_accuracy50: 0.4174 - 173s/epoch - 36ms/step
Epoch 35/50
4812/4812 - 162s - loss: 3.1200 - accuracy50: 0.4592 - val_loss: 3.2083 - val_accuracy50: 0.4158 - 162s/epoch - 34ms/step
Epoch 36/50
4812/4812 - 162s - loss: 3.1187 - accuracy50: 0.4594 - val_loss: 3.2086 - val_accuracy50: 0.4166 - 162s/epoch - 34ms/step
Epoch 37/50
4812/4812 - 163s - loss: 3.1179 - accuracy50: 0.4598 - val_loss: 3.2065 - val_accuracy50: 0.4178 - 163s/epoch - 34ms/step
Epoch 38/50
4812/4812 - 158s - loss: 3.1167 - accuracy50: 0.4602 - val_loss: 3.2083 - val_accuracy50: 0.4163 - 158s/epoch - 33ms/step
Epoch 39/50
4812/4812 - 160s - loss: 3.1162 - accuracy50: 0.4605 - val_loss: 3.2047 - val_accuracy50: 0.4182 - 160s/epoch - 33ms/step
Epoch 40/50
4812/4812 - 157s - loss: 3.1148 - accuracy50: 0.4610 - val_loss: 3.2055 - val_accuracy50: 0.4177 - 157s/epoch - 33ms/step
Epoch 41/50
4812/4812 - 162s - loss: 3.1137 - accuracy50: 0.4615 - val_loss: 3.2048 - val_accuracy50: 0.4178 - 162s/epoch - 34ms/step
Epoch 42/50
4812/4812 - 173s - loss: 3.1131 - accuracy50: 0.4616 - val_loss: 3.2033 - val_accuracy50: 0.4190 - 173s/epoch - 36ms/step
Epoch 43/50
4812/4812 - 159s - loss: 3.1118 - accuracy50: 0.4624 - val_loss: 3.2045 - val_accuracy50: 0.4196 - 159s/epoch - 33ms/step
Epoch 44/50
4812/4812 - 175s - loss: 3.1119 - accuracy50: 0.4624 - val_loss: 3.2102 - val_accuracy50: 0.4144 - 175s/epoch - 36ms/step
Epoch 45/50
4812/4812 - 176s - loss: 3.1133 - accuracy50: 0.4617 - val_loss: 3.2034 - val_accuracy50: 0.4193 - 176s/epoch - 37ms/step
Epoch 46/50
4812/4812 - 157s - loss: 3.1097 - accuracy50: 0.4630 - val_loss: 3.2028 - val_accuracy50: 0.4197 - 157s/epoch - 33ms/step
Epoch 47/50
4812/4812 - 162s - loss: 3.1087 - accuracy50: 0.4635 - val_loss: 3.2029 - val_accuracy50: 0.4195 - 162s/epoch - 34ms/step
Epoch 48/50
4812/4812 - 159s - loss: 3.1077 - accuracy50: 0.4636 - val_loss: 3.2035 - val_accuracy50: 0.4199 - 159s/epoch - 33ms/step
Epoch 49/50
4812/4812 - 165s - loss: 3.1075 - accuracy50: 0.4640 - val_loss: 3.2025 - val_accuracy50: 0.4203 - 165s/epoch - 34ms/step
Epoch 50/50
4812/4812 - 163s - loss: 3.1059 - accuracy50: 0.4641 - val_loss: 3.2047 - val_accuracy50: 0.4196 - 163s/epoch - 34ms/step
testing model: results/AAPL/W0/deepVOL_L3/h50
Evaluating performance on  test set...
19053/19053 - 255s - 255s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0040851
{'0': {'precision': 0.35737990964998745, 'recall': 0.4202608717130799, 'f1-score': 0.3862780758462383, 'support': 1133584}, '1': {'precision': 0.594126549334912, 'recall': 0.6166170737141636, 'f1-score': 0.605162921848299, 'support': 2630078}, '2': {'precision': 0.38992039510342746, 'recall': 0.28523984345329323, 'f1-score': 0.3294649954396097, 'support': 1113789}, 'accuracy': 0.4953097427324231, 'macro avg': {'precision': 0.447142284696109, 'recall': 0.4407059296268456, 'f1-score': 0.4403019977113824, 'support': 4877451}, 'weighted avg': {'precision': 0.49247206400724264, 'recall': 0.4953097427324231, 'f1-score': 0.491334268925449, 'support': 4877451}}
[[ 476401  526300  130883]
 [ 642133 1621751  366194]
 [ 214504  581588  317697]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0698043
{'0': {'precision': 0.4315399606448195, 'recall': 0.4494768970027812, 'f1-score': 0.4403258365821668, 'support': 405943}, '1': {'precision': 0.3828121841022705, 'recall': 0.44251249086709127, 'f1-score': 0.4105031104944385, 'support': 406497}, '2': {'precision': 0.4625119043757979, 'recall': 0.3739998283376408, 'f1-score': 0.41357309425789196, 'support': 419428}, 'accuracy': 0.4214802235304432, 'macro avg': {'precision': 0.4256213497076293, 'recall': 0.42199640540250444, 'f1-score': 0.4214673471114991, 'support': 1231868}, 'weighted avg': {'precision': 0.42600593056528197, 'recall': 0.4214802235304432, 'f1-score': 0.42137599951028143, 'support': 1231868}}
[[182462 138505  84976]
 [129298 179880  97319]
 [111056 151506 156866]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674393
{'0': {'precision': 0.4121662210779945, 'recall': 0.4411106008689816, 'f1-score': 0.42614749343070674, 'support': 141545}, '1': {'precision': 0.41675720164609054, 'recall': 0.4535704475151978, 'f1-score': 0.43438525855856885, 'support': 167458}, '2': {'precision': 0.4334840331314631, 'recall': 0.3586642473305883, 'f1-score': 0.3925407106412881, 'support': 143290}, 'accuracy': 0.419604106187803, 'macro avg': {'precision': 0.42080248528518266, 'recall': 0.4177817652382559, 'f1-score': 0.41769115421018793, 'support': 452293}, 'weighted avg': {'precision': 0.4206196477574119, 'recall': 0.419604106187803, 'f1-score': 0.4185505679131457, 'support': 452293}}
[[62437 51197 27911]
 [52250 75954 39254]
 [36798 55099 51393]]
training model: results/AAPL/W0/deepVOL_L3/h100
Epoch 1/50
4812/4812 - 167s - loss: 3.2696 - accuracy100: 0.3793 - val_loss: 3.3510 - val_accuracy100: 0.3463 - 167s/epoch - 35ms/step
Epoch 2/50
4812/4812 - 158s - loss: 3.2586 - accuracy100: 0.3898 - val_loss: 3.3562 - val_accuracy100: 0.3546 - 158s/epoch - 33ms/step
Epoch 3/50
4812/4812 - 168s - loss: 3.2508 - accuracy100: 0.3960 - val_loss: 3.3171 - val_accuracy100: 0.3621 - 168s/epoch - 35ms/step
Epoch 4/50
4812/4812 - 160s - loss: 3.2400 - accuracy100: 0.4030 - val_loss: 3.3155 - val_accuracy100: 0.3643 - 160s/epoch - 33ms/step
Epoch 5/50
4812/4812 - 158s - loss: 3.2325 - accuracy100: 0.4081 - val_loss: 3.3035 - val_accuracy100: 0.3652 - 158s/epoch - 33ms/step
Epoch 6/50
4812/4812 - 162s - loss: 3.2270 - accuracy100: 0.4112 - val_loss: 3.2940 - val_accuracy100: 0.3679 - 162s/epoch - 34ms/step
Epoch 7/50
4812/4812 - 158s - loss: 3.2231 - accuracy100: 0.4136 - val_loss: 3.2975 - val_accuracy100: 0.3693 - 158s/epoch - 33ms/step
Epoch 8/50
4812/4812 - 159s - loss: 3.2205 - accuracy100: 0.4150 - val_loss: 3.2885 - val_accuracy100: 0.3716 - 159s/epoch - 33ms/step
Epoch 9/50
4812/4812 - 160s - loss: 3.2177 - accuracy100: 0.4163 - val_loss: 3.2865 - val_accuracy100: 0.3735 - 160s/epoch - 33ms/step
Epoch 10/50
4812/4812 - 174s - loss: 3.2158 - accuracy100: 0.4170 - val_loss: 3.2806 - val_accuracy100: 0.3768 - 174s/epoch - 36ms/step
Epoch 11/50
4812/4812 - 160s - loss: 3.2136 - accuracy100: 0.4185 - val_loss: 3.2762 - val_accuracy100: 0.3779 - 160s/epoch - 33ms/step
Epoch 12/50
4812/4812 - 160s - loss: 3.2117 - accuracy100: 0.4191 - val_loss: 3.2753 - val_accuracy100: 0.3790 - 160s/epoch - 33ms/step
Epoch 13/50
4812/4812 - 160s - loss: 3.2101 - accuracy100: 0.4199 - val_loss: 3.2777 - val_accuracy100: 0.3779 - 160s/epoch - 33ms/step
Epoch 14/50
4812/4812 - 158s - loss: 3.2085 - accuracy100: 0.4208 - val_loss: 3.2762 - val_accuracy100: 0.3794 - 158s/epoch - 33ms/step
Epoch 15/50
4812/4812 - 157s - loss: 3.2067 - accuracy100: 0.4219 - val_loss: 3.2758 - val_accuracy100: 0.3799 - 157s/epoch - 33ms/step
Epoch 16/50
4812/4812 - 158s - loss: 3.2052 - accuracy100: 0.4225 - val_loss: 3.2761 - val_accuracy100: 0.3800 - 158s/epoch - 33ms/step
Epoch 17/50
4812/4812 - 161s - loss: 3.2039 - accuracy100: 0.4230 - val_loss: 3.2740 - val_accuracy100: 0.3801 - 161s/epoch - 34ms/step
Epoch 18/50
4812/4812 - 163s - loss: 3.2029 - accuracy100: 0.4235 - val_loss: 3.2717 - val_accuracy100: 0.3828 - 163s/epoch - 34ms/step
Epoch 19/50
4812/4812 - 158s - loss: 3.2017 - accuracy100: 0.4240 - val_loss: 3.2706 - val_accuracy100: 0.3826 - 158s/epoch - 33ms/step
Epoch 20/50
4812/4812 - 158s - loss: 3.2008 - accuracy100: 0.4247 - val_loss: 3.2718 - val_accuracy100: 0.3823 - 158s/epoch - 33ms/step
Epoch 21/50
4812/4812 - 160s - loss: 3.1994 - accuracy100: 0.4253 - val_loss: 3.2727 - val_accuracy100: 0.3809 - 160s/epoch - 33ms/step
Epoch 22/50
4812/4812 - 164s - loss: 3.1984 - accuracy100: 0.4256 - val_loss: 3.2731 - val_accuracy100: 0.3827 - 164s/epoch - 34ms/step
Epoch 23/50
4812/4812 - 160s - loss: 3.1974 - accuracy100: 0.4262 - val_loss: 3.2750 - val_accuracy100: 0.3812 - 160s/epoch - 33ms/step
Epoch 24/50
4812/4812 - 158s - loss: 3.1965 - accuracy100: 0.4266 - val_loss: 3.2725 - val_accuracy100: 0.3817 - 158s/epoch - 33ms/step
Epoch 25/50
4812/4812 - 173s - loss: 3.1954 - accuracy100: 0.4271 - val_loss: 3.2736 - val_accuracy100: 0.3812 - 173s/epoch - 36ms/step
Epoch 26/50
4812/4812 - 162s - loss: 3.1943 - accuracy100: 0.4276 - val_loss: 3.2745 - val_accuracy100: 0.3827 - 162s/epoch - 34ms/step
Epoch 27/50
4812/4812 - 160s - loss: 3.1934 - accuracy100: 0.4280 - val_loss: 3.2766 - val_accuracy100: 0.3819 - 160s/epoch - 33ms/step
Epoch 28/50
4812/4812 - 162s - loss: 3.1923 - accuracy100: 0.4286 - val_loss: 3.2784 - val_accuracy100: 0.3811 - 162s/epoch - 34ms/step
Epoch 29/50
4812/4812 - 160s - loss: 3.1910 - accuracy100: 0.4295 - val_loss: 3.2812 - val_accuracy100: 0.3798 - 160s/epoch - 33ms/step
testing model: results/AAPL/W0/deepVOL_L3/h100
Evaluating performance on  test set...
19053/19053 - 257s - 257s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084924
{'0': {'precision': 0.34414204124806785, 'recall': 0.517854748376594, 'f1-score': 0.4134947886613958, 'support': 1379661}, '1': {'precision': 0.4998608001970531, 'recall': 0.2246914809333891, 'f1-score': 0.310024456155441, 'support': 2149543}, '2': {'precision': 0.3462742099925837, 'recall': 0.4713246163351374, 'f1-score': 0.39923628536640837, 'support': 1348247}, 'accuracy': 0.37579260150435134, 'macro avg': {'precision': 0.3967590171459015, 'recall': 0.40462361521504014, 'f1-score': 0.3742518433944151, 'support': 4877451}, 'weighted avg': {'precision': 0.41335828932124496, 'recall': 0.37579260150435134, 'f1-score': 0.36395294534245637, 'support': 4877451}}
[[714464 251053 414144]
 [881024 482984 785535]
 [480585 232200 635462]]
Evaluating performance on  train set...
4812/4812 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0877122
{'0': {'precision': 0.383125298989289, 'recall': 0.5532360513339327, 'f1-score': 0.45272848458728193, 'support': 408229}, '1': {'precision': 0.40041416704210436, 'recall': 0.12477310063371731, 'f1-score': 0.1902594378596001, 'support': 406017}, '2': {'precision': 0.3976443358023351, 'recall': 0.4911858091767196, 'f1-score': 0.43949286812321564, 'support': 417622}, 'accuracy': 0.3909810141995733, 'macro avg': {'precision': 0.3937279339445761, 'recall': 0.38973165371478985, 'f1-score': 0.3608269301900326, 'support': 1231868}, 'weighted avg': {'precision': 0.39374579041543034, 'recall': 0.3909810141995733, 'f1-score': 0.36173303737687507, 'support': 1231868}}
[[225847  38632 143750]
 [188374  50660 166983]
 [175265  37227 205130]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0896773
{'0': {'precision': 0.3762746541133777, 'recall': 0.552414477350259, 'f1-score': 0.4476407860283651, 'support': 147154}, '1': {'precision': 0.40578619507504493, 'recall': 0.12331499574381583, 'f1-score': 0.18914916007327434, 'support': 157418}, '2': {'precision': 0.3829186480978261, 'recall': 0.4884072000595718, 'f1-score': 0.4292773482240872, 'support': 147721}, 'accuracy': 0.3821637743675007, 'macro avg': {'precision': 0.3883264990954163, 'recall': 0.38804555771788224, 'f1-score': 0.35535576477524217, 'support': 452293}, 'weighted avg': {'precision': 0.388715937065978, 'recall': 0.3821637743675007, 'f1-score': 0.35167666504819467, 'support': 452293}}
[[81290 14641 51223]
 [72961 19412 65045]
 [61788 13785 72148]]
training model: results/AAPL/W0/deepVOL_L3/h200
Epoch 1/50
4812/4812 - 166s - loss: 3.2559 - accuracy200: 0.3874 - val_loss: 3.3541 - val_accuracy200: 0.3381 - 166s/epoch - 35ms/step
Epoch 2/50
4812/4812 - 166s - loss: 3.2587 - accuracy200: 0.3834 - val_loss: 3.3597 - val_accuracy200: 0.3386 - 166s/epoch - 34ms/step
Epoch 3/50
4812/4812 - 160s - loss: 3.2593 - accuracy200: 0.3861 - val_loss: 3.3591 - val_accuracy200: 0.3426 - 160s/epoch - 33ms/step
Epoch 4/50
4812/4812 - 162s - loss: 3.2526 - accuracy200: 0.3929 - val_loss: 3.3386 - val_accuracy200: 0.3478 - 162s/epoch - 34ms/step
Epoch 5/50
4812/4812 - 157s - loss: 3.2424 - accuracy200: 0.4002 - val_loss: 3.3406 - val_accuracy200: 0.3457 - 157s/epoch - 33ms/step
Epoch 6/50
4812/4812 - 162s - loss: 3.2296 - accuracy200: 0.4079 - val_loss: 3.3292 - val_accuracy200: 0.3468 - 162s/epoch - 34ms/step
Epoch 7/50
4812/4812 - 158s - loss: 3.2242 - accuracy200: 0.4112 - val_loss: 3.3197 - val_accuracy200: 0.3499 - 158s/epoch - 33ms/step
Epoch 8/50
4812/4812 - 161s - loss: 3.2196 - accuracy200: 0.4140 - val_loss: 3.3110 - val_accuracy200: 0.3534 - 161s/epoch - 33ms/step
Epoch 9/50
4812/4812 - 160s - loss: 3.2163 - accuracy200: 0.4161 - val_loss: 3.3084 - val_accuracy200: 0.3559 - 160s/epoch - 33ms/step
Epoch 10/50
4812/4812 - 160s - loss: 3.2134 - accuracy200: 0.4180 - val_loss: 3.3074 - val_accuracy200: 0.3569 - 160s/epoch - 33ms/step
Epoch 11/50
4812/4812 - 159s - loss: 3.2119 - accuracy200: 0.4188 - val_loss: 3.3061 - val_accuracy200: 0.3598 - 159s/epoch - 33ms/step
Epoch 12/50
4812/4812 - 159s - loss: 3.2100 - accuracy200: 0.4204 - val_loss: 3.3023 - val_accuracy200: 0.3609 - 159s/epoch - 33ms/step
Epoch 13/50
4812/4812 - 158s - loss: 3.2083 - accuracy200: 0.4207 - val_loss: 3.3015 - val_accuracy200: 0.3640 - 158s/epoch - 33ms/step
Epoch 14/50
4812/4812 - 159s - loss: 3.2069 - accuracy200: 0.4211 - val_loss: 3.3013 - val_accuracy200: 0.3651 - 159s/epoch - 33ms/step
Epoch 15/50
4812/4812 - 159s - loss: 3.2056 - accuracy200: 0.4222 - val_loss: 3.2986 - val_accuracy200: 0.3668 - 159s/epoch - 33ms/step
Epoch 16/50
4812/4812 - 161s - loss: 3.2037 - accuracy200: 0.4231 - val_loss: 3.3024 - val_accuracy200: 0.3676 - 161s/epoch - 34ms/step
Epoch 17/50
4812/4812 - 160s - loss: 3.2030 - accuracy200: 0.4232 - val_loss: 3.2999 - val_accuracy200: 0.3686 - 160s/epoch - 33ms/step
Epoch 18/50
4812/4812 - 159s - loss: 3.2015 - accuracy200: 0.4242 - val_loss: 3.3042 - val_accuracy200: 0.3698 - 159s/epoch - 33ms/step
Epoch 19/50
4812/4812 - 161s - loss: 3.2004 - accuracy200: 0.4249 - val_loss: 3.3042 - val_accuracy200: 0.3688 - 161s/epoch - 34ms/step
Epoch 20/50
4812/4812 - 160s - loss: 3.1989 - accuracy200: 0.4252 - val_loss: 3.3040 - val_accuracy200: 0.3702 - 160s/epoch - 33ms/step
Epoch 21/50
4812/4812 - 162s - loss: 3.1978 - accuracy200: 0.4262 - val_loss: 3.3042 - val_accuracy200: 0.3696 - 162s/epoch - 34ms/step
Epoch 22/50
4812/4812 - 161s - loss: 3.1964 - accuracy200: 0.4269 - val_loss: 3.3052 - val_accuracy200: 0.3692 - 161s/epoch - 34ms/step
Epoch 23/50
4812/4812 - 162s - loss: 3.1959 - accuracy200: 0.4272 - val_loss: 3.3063 - val_accuracy200: 0.3693 - 162s/epoch - 34ms/step
Epoch 24/50
4812/4812 - 160s - loss: 3.1942 - accuracy200: 0.4277 - val_loss: 3.3060 - val_accuracy200: 0.3685 - 160s/epoch - 33ms/step
Epoch 25/50
4812/4812 - 163s - loss: 3.1934 - accuracy200: 0.4282 - val_loss: 3.3053 - val_accuracy200: 0.3695 - 163s/epoch - 34ms/step
testing model: results/AAPL/W0/deepVOL_L3/h200
Evaluating performance on  test set...
19053/19053 - 254s - 254s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0872071
{'0': {'precision': 0.2916989626205914, 'recall': 0.4102582462362053, 'f1-score': 0.34096638177857364, 'support': 1242961}, '1': {'precision': 0.5348076418013901, 'recall': 0.326298809238161, 'f1-score': 0.4053089986275049, 'support': 2421391}, '2': {'precision': 0.2936182010571761, 'recall': 0.3998371113981629, 'f1-score': 0.338592700224464, 'support': 1213099}, 'accuracy': 0.3659850196342311, 'macro avg': {'precision': 0.37337493515971926, 'recall': 0.3787980556241764, 'f1-score': 0.36162269354351423, 'support': 4877451}, 'weighted avg': {'precision': 0.4128666368870178, 'recall': 0.3659850196342311, 'f1-score': 0.37231864398168785, 'support': 4877451}}
[[509935 360671 372355]
 [836743 790097 794551]
 [401477 326580 485042]]
Evaluating performance on  train set...
4812/4812 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982335
{'0': {'precision': 0.3709670477532353, 'recall': 0.4013941415661543, 'f1-score': 0.3855812584613574, 'support': 407993}, '1': {'precision': 0.3686687065409438, 'recall': 0.24639549071162206, 'f1-score': 0.29537829470140203, 'support': 407337}, '2': {'precision': 0.383222173332407, 'recall': 0.47672721336348667, 'f1-score': 0.4248911427073638, 'support': 416538}, 'accuracy': 0.37561410800507844, 'macro avg': {'precision': 0.37428597587552875, 'recall': 0.3748389485470877, 'f1-score': 0.36861689862337443, 'support': 1231868}, 'weighted avg': {'precision': 0.3743509542140784, 'recall': 0.37561410800507844, 'f1-score': 0.369046253018383, 'support': 1231868}}
[[163766  87700 156527]
 [143901 100366 163070]
 [133790  84173 198575]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099152
{'0': {'precision': 0.3618138141700525, 'recall': 0.4146303332676269, 'f1-score': 0.3864256890730218, 'support': 147119}, '1': {'precision': 0.37878212030995967, 'recall': 0.2259653233069448, 'f1-score': 0.2830656836408248, 'support': 158781}, '2': {'precision': 0.3658930234527136, 'recall': 0.4723244963898547, 'f1-score': 0.4123517677543243, 'support': 146393}, 'accuracy': 0.36707178753595565, 'macro avg': {'precision': 0.3688296526442419, 'recall': 0.3709733843214755, 'f1-score': 0.360614380156057, 'support': 452293}, 'weighted avg': {'precision': 0.36909098251384115, 'recall': 0.36707178753595565, 'f1-score': 0.3585318048295386, 'support': 452293}}
[[61000 30434 55685]
 [58756 35879 64146]
 [48839 28409 69145]]
training model: results/AAPL/W0/deepVOL_L3/h300
Epoch 1/50
4812/4812 - 166s - loss: 3.2717 - accuracy300: 0.3798 - val_loss: 3.3703 - val_accuracy300: 0.3387 - 166s/epoch - 34ms/step
Epoch 2/50
4812/4812 - 175s - loss: 3.2707 - accuracy300: 0.3752 - val_loss: 3.3796 - val_accuracy300: 0.3395 - 175s/epoch - 36ms/step
Epoch 3/50
4812/4812 - 175s - loss: 3.2630 - accuracy300: 0.3822 - val_loss: 3.3653 - val_accuracy300: 0.3408 - 175s/epoch - 36ms/step
Epoch 4/50
4812/4812 - 175s - loss: 3.2522 - accuracy300: 0.3912 - val_loss: 3.3546 - val_accuracy300: 0.3431 - 175s/epoch - 36ms/step
Epoch 5/50
4812/4812 - 174s - loss: 3.2447 - accuracy300: 0.3987 - val_loss: 3.3431 - val_accuracy300: 0.3446 - 174s/epoch - 36ms/step
Epoch 6/50
4812/4812 - 174s - loss: 3.2391 - accuracy300: 0.4024 - val_loss: 3.3387 - val_accuracy300: 0.3473 - 174s/epoch - 36ms/step
Epoch 7/50
4812/4812 - 174s - loss: 3.2349 - accuracy300: 0.4056 - val_loss: 3.3402 - val_accuracy300: 0.3481 - 174s/epoch - 36ms/step
Epoch 8/50
4812/4812 - 177s - loss: 3.2315 - accuracy300: 0.4078 - val_loss: 3.3371 - val_accuracy300: 0.3485 - 177s/epoch - 37ms/step
Epoch 9/50
4812/4812 - 178s - loss: 3.2287 - accuracy300: 0.4101 - val_loss: 3.3343 - val_accuracy300: 0.3506 - 178s/epoch - 37ms/step
Epoch 10/50
4812/4812 - 176s - loss: 3.2269 - accuracy300: 0.4107 - val_loss: 3.3331 - val_accuracy300: 0.3506 - 176s/epoch - 37ms/step
Epoch 11/50
4812/4812 - 176s - loss: 3.2250 - accuracy300: 0.4120 - val_loss: 3.3342 - val_accuracy300: 0.3518 - 176s/epoch - 37ms/step
Epoch 12/50
4812/4812 - 175s - loss: 3.2231 - accuracy300: 0.4133 - val_loss: 3.3349 - val_accuracy300: 0.3520 - 175s/epoch - 36ms/step
Epoch 13/50
4812/4812 - 176s - loss: 3.2215 - accuracy300: 0.4139 - val_loss: 3.3346 - val_accuracy300: 0.3520 - 176s/epoch - 36ms/step
Epoch 14/50
4812/4812 - 176s - loss: 3.2200 - accuracy300: 0.4145 - val_loss: 3.3382 - val_accuracy300: 0.3516 - 176s/epoch - 37ms/step
Epoch 15/50
4812/4812 - 178s - loss: 3.2184 - accuracy300: 0.4155 - val_loss: 3.3414 - val_accuracy300: 0.3514 - 178s/epoch - 37ms/step
Epoch 16/50
4812/4812 - 176s - loss: 3.2172 - accuracy300: 0.4159 - val_loss: 3.3406 - val_accuracy300: 0.3514 - 176s/epoch - 37ms/step
Epoch 17/50
4812/4812 - 160s - loss: 3.2160 - accuracy300: 0.4164 - val_loss: 3.3455 - val_accuracy300: 0.3515 - 160s/epoch - 33ms/step
Epoch 18/50
4812/4812 - 162s - loss: 3.2146 - accuracy300: 0.4171 - val_loss: 3.3421 - val_accuracy300: 0.3517 - 162s/epoch - 34ms/step
Epoch 19/50
4812/4812 - 159s - loss: 3.2130 - accuracy300: 0.4179 - val_loss: 3.3440 - val_accuracy300: 0.3520 - 159s/epoch - 33ms/step
Epoch 20/50
4812/4812 - 159s - loss: 3.2124 - accuracy300: 0.4177 - val_loss: 3.3469 - val_accuracy300: 0.3511 - 159s/epoch - 33ms/step
testing model: results/AAPL/W0/deepVOL_L3/h300
Evaluating performance on  test set...
19053/19053 - 255s - 255s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1231385
{'0': {'precision': 0.2909647461837717, 'recall': 0.5387436704934209, 'f1-score': 0.37785663539729814, 'support': 1353976}, '1': {'precision': 0.5015151036899088, 'recall': 0.043305010254907704, 'f1-score': 0.07972582565291404, 'support': 2201385}, '2': {'precision': 0.28812167086930957, 'recall': 0.47516659228948105, 'f1-score': 0.35872631381792935, 'support': 1322090}, 'accuracy': 0.2978994560888464, 'macro avg': {'precision': 0.36020050691433, 'recall': 0.35240509101260326, 'f1-score': 0.27210292495604715, 'support': 4877451}, 'weighted avg': {'precision': 0.3852237346013182, 'recall': 0.2978994560888464, 'f1-score': 0.2381130071238396, 'support': 4877451}}
[[ 729446   49660  574870]
 [1128763   95331  977291]
 [ 648782   45095  628213]]
Evaluating performance on  train set...
4812/4812 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062278
{'0': {'precision': 0.35300302532568373, 'recall': 0.48410210809190907, 'f1-score': 0.4082868492881079, 'support': 407098}, '1': {'precision': 0.38213045156310305, 'recall': 0.024347838917196198, 'f1-score': 0.04577883197166622, 'support': 406648}, '2': {'precision': 0.3639795513462854, 'recall': 0.563804344186625, 'f1-score': 0.4423729560993552, 'support': 418122}, 'accuracy': 0.3593867200057149, 'macro avg': {'precision': 0.3663710094116907, 'recall': 0.3574180970652434, 'f1-score': 0.2988128791197098, 'support': 1231868}, 'weighted avg': {'precision': 0.3663438513211476, 'recall': 0.3593867200057149, 'f1-score': 0.3001900328487134, 'support': 1231868}}
[[197077   8215 201806]
 [186621   9901 210126]
 [174589   7794 235739]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101245
{'0': {'precision': 0.35031400039308547, 'recall': 0.4998931566857204, 'f1-score': 0.41194565354963325, 'support': 149752}, '1': {'precision': 0.375786350148368, 'recall': 0.0204607877984942, 'f1-score': 0.03880853150281932, 'support': 154735}, '2': {'precision': 0.3492010392138122, 'recall': 0.5438006576187705, 'f1-score': 0.4252976347954918, 'support': 147806}, 'accuracy': 0.3502220905474991, 'macro avg': {'precision': 0.3584337965850885, 'recall': 0.354718200700995, 'f1-score': 0.2920172732826481, 'support': 452293}, 'weighted avg': {'precision': 0.3586646971744197, 'recall': 0.3502220905474991, 'f1-score': 0.28865418178268487, 'support': 452293}}
[[74860  2689 72203]
 [73975  3166 77594]
 [64859  2570 80377]]
training model: results/AAPL/W0/deepVOL_L3/h500
Epoch 1/50
4812/4812 - 168s - loss: 3.2752 - accuracy500: 0.3763 - val_loss: 3.4089 - val_accuracy500: 0.3349 - 168s/epoch - 35ms/step
Epoch 2/50
4812/4812 - 169s - loss: 3.2787 - accuracy500: 0.3690 - val_loss: 3.3899 - val_accuracy500: 0.3340 - 169s/epoch - 35ms/step
Epoch 3/50
4812/4812 - 166s - loss: 3.2785 - accuracy500: 0.3682 - val_loss: 3.4148 - val_accuracy500: 0.3362 - 166s/epoch - 34ms/step
Epoch 4/50
4812/4812 - 165s - loss: 3.2819 - accuracy500: 0.3645 - val_loss: 3.3801 - val_accuracy500: 0.3356 - 165s/epoch - 34ms/step
Epoch 5/50
4812/4812 - 168s - loss: 3.2756 - accuracy500: 0.3718 - val_loss: 3.4301 - val_accuracy500: 0.3373 - 168s/epoch - 35ms/step
Epoch 6/50
4812/4812 - 170s - loss: 3.2753 - accuracy500: 0.3728 - val_loss: 3.4139 - val_accuracy500: 0.3376 - 170s/epoch - 35ms/step
Epoch 7/50
4812/4812 - 179s - loss: 3.2713 - accuracy500: 0.3771 - val_loss: 3.4166 - val_accuracy500: 0.3375 - 179s/epoch - 37ms/step
Epoch 8/50
4812/4812 - 179s - loss: 3.2652 - accuracy500: 0.3824 - val_loss: 3.4329 - val_accuracy500: 0.3382 - 179s/epoch - 37ms/step
Epoch 9/50
4812/4812 - 169s - loss: 3.2509 - accuracy500: 0.3961 - val_loss: 3.4251 - val_accuracy500: 0.3389 - 169s/epoch - 35ms/step
Epoch 10/50
4812/4812 - 168s - loss: 3.2428 - accuracy500: 0.4020 - val_loss: 3.4122 - val_accuracy500: 0.3390 - 168s/epoch - 35ms/step
Epoch 11/50
4812/4812 - 168s - loss: 3.2381 - accuracy500: 0.4047 - val_loss: 3.4103 - val_accuracy500: 0.3398 - 168s/epoch - 35ms/step
Epoch 12/50
4812/4812 - 168s - loss: 3.2340 - accuracy500: 0.4068 - val_loss: 3.4121 - val_accuracy500: 0.3405 - 168s/epoch - 35ms/step
Epoch 13/50
4812/4812 - 169s - loss: 3.2299 - accuracy500: 0.4090 - val_loss: 3.4166 - val_accuracy500: 0.3402 - 169s/epoch - 35ms/step
Epoch 14/50
4812/4812 - 169s - loss: 3.2265 - accuracy500: 0.4105 - val_loss: 3.4153 - val_accuracy500: 0.3397 - 169s/epoch - 35ms/step
testing model: results/AAPL/W0/deepVOL_L3/h500
Evaluating performance on  test set...
19053/19053 - 276s - 276s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1698037
{'0': {'precision': 0.2810873606454999, 'recall': 0.5684386902021128, 'f1-score': 0.3761648767763527, 'support': 1359538}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2187002}, '2': {'precision': 0.26963626333245305, 'recall': 0.43113852090785937, 'f1-score': 0.33177729099456515, 'support': 1330911}, 'accuracy': 0.2760911385885783, 'macro avg': {'precision': 0.1835745413259843, 'recall': 0.33319240370332404, 'f1-score': 0.23598072259030597, 'support': 4877451}, 'weighted avg': {'precision': 0.1519258352334693, 'recall': 0.2760911385885783, 'f1-score': 0.19538412387487575, 'support': 4877451}}
[[ 772814       0  586724]
 [1219455       0  967547]
 [ 757104       0  573807]]
Evaluating performance on  train set...
4812/4812 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186097
{'0': {'precision': 0.3394651458844234, 'recall': 0.5530548603858356, 'f1-score': 0.42070283588941254, 'support': 405976}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 406063}, '2': {'precision': 0.34810694639708023, 'recall': 0.47299972131510687, 'f1-score': 0.40105505193969804, 'support': 419829}, 'accuracy': 0.34346699484035625, 'macro avg': {'precision': 0.22919069742716788, 'recall': 0.3420181939003142, 'f1-score': 0.2739192959430368, 'support': 1231868}, 'weighted avg': {'precision': 0.23051178638012715, 'recall': 0.34346699484035625, 'f1-score': 0.27532965861913095, 'support': 1231868}}
[[224527      0 181449]
 [215637      0 190426]
 [221250      0 198579]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246995
{'0': {'precision': 0.3377185919938166, 'recall': 0.5577369278329953, 'f1-score': 0.4206979035812879, 'support': 150415}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 154711}, '2': {'precision': 0.331942026142188, 'recall': 0.45987211806994777, 'f1-score': 0.38557250777662566, 'support': 147167}, 'accuracy': 0.3351146270227485, 'macro avg': {'precision': 0.22322020604533485, 'recall': 0.339203015300981, 'f1-score': 0.26875680378597117, 'support': 452293}, 'weighted avg': {'precision': 0.22031924919469748, 'recall': 0.3351146270227485, 'f1-score': 0.26536520445627526, 'support': 452293}}
[[83892     0 66523]
 [85027     0 69684]
 [79489     0 67678]]
training model: results/AAPL/W0/deepVOL_L3/h1000
Epoch 1/50
4812/4812 - 172s - loss: 3.2666 - accuracy1000: 0.3841 - val_loss: 3.5090 - val_accuracy1000: 0.3331 - 172s/epoch - 36ms/step
Epoch 2/50
4812/4812 - 172s - loss: 3.2668 - accuracy1000: 0.3780 - val_loss: 3.5106 - val_accuracy1000: 0.3327 - 172s/epoch - 36ms/step
Epoch 3/50
4812/4812 - 172s - loss: 3.2624 - accuracy1000: 0.3822 - val_loss: 3.5196 - val_accuracy1000: 0.3334 - 172s/epoch - 36ms/step
Epoch 4/50
4812/4812 - 172s - loss: 3.2447 - accuracy1000: 0.3973 - val_loss: 3.4691 - val_accuracy1000: 0.3336 - 172s/epoch - 36ms/step
Epoch 5/50
4812/4812 - 171s - loss: 3.2249 - accuracy1000: 0.4111 - val_loss: 3.4700 - val_accuracy1000: 0.3342 - 171s/epoch - 35ms/step
Epoch 6/50
4812/4812 - 170s - loss: 3.2133 - accuracy1000: 0.4176 - val_loss: 3.4683 - val_accuracy1000: 0.3349 - 170s/epoch - 35ms/step
Epoch 7/50
4812/4812 - 170s - loss: 3.2067 - accuracy1000: 0.4213 - val_loss: 3.4699 - val_accuracy1000: 0.3348 - 170s/epoch - 35ms/step
Epoch 8/50
4812/4812 - 171s - loss: 3.2030 - accuracy1000: 0.4233 - val_loss: 3.4594 - val_accuracy1000: 0.3354 - 171s/epoch - 36ms/step
Epoch 9/50
4812/4812 - 169s - loss: 3.1999 - accuracy1000: 0.4249 - val_loss: 3.4552 - val_accuracy1000: 0.3357 - 169s/epoch - 35ms/step
Epoch 10/50
4812/4812 - 169s - loss: 3.1977 - accuracy1000: 0.4260 - val_loss: 3.4547 - val_accuracy1000: 0.3370 - 169s/epoch - 35ms/step
Epoch 11/50
4812/4812 - 169s - loss: 3.1954 - accuracy1000: 0.4268 - val_loss: 3.4574 - val_accuracy1000: 0.3354 - 169s/epoch - 35ms/step
Epoch 12/50
4812/4812 - 174s - loss: 3.1929 - accuracy1000: 0.4283 - val_loss: 3.4466 - val_accuracy1000: 0.3359 - 174s/epoch - 36ms/step
Epoch 13/50
4812/4812 - 172s - loss: 3.1907 - accuracy1000: 0.4288 - val_loss: 3.4545 - val_accuracy1000: 0.3363 - 172s/epoch - 36ms/step
Epoch 14/50
4812/4812 - 174s - loss: 3.1898 - accuracy1000: 0.4297 - val_loss: 3.4485 - val_accuracy1000: 0.3360 - 174s/epoch - 36ms/step
Epoch 15/50
4812/4812 - 174s - loss: 3.1870 - accuracy1000: 0.4310 - val_loss: 3.4495 - val_accuracy1000: 0.3365 - 174s/epoch - 36ms/step
Epoch 16/50
4812/4812 - 175s - loss: 3.1851 - accuracy1000: 0.4317 - val_loss: 3.4556 - val_accuracy1000: 0.3372 - 175s/epoch - 36ms/step
Epoch 17/50
4812/4812 - 169s - loss: 3.1832 - accuracy1000: 0.4322 - val_loss: 3.4457 - val_accuracy1000: 0.3385 - 169s/epoch - 35ms/step
Epoch 18/50
4812/4812 - 172s - loss: 3.1816 - accuracy1000: 0.4327 - val_loss: 3.4462 - val_accuracy1000: 0.3372 - 172s/epoch - 36ms/step
Epoch 19/50
4812/4812 - 176s - loss: 3.1802 - accuracy1000: 0.4333 - val_loss: 3.4503 - val_accuracy1000: 0.3374 - 176s/epoch - 37ms/step
Epoch 20/50
4812/4812 - 181s - loss: 3.1787 - accuracy1000: 0.4343 - val_loss: 3.4479 - val_accuracy1000: 0.3370 - 181s/epoch - 38ms/step
Epoch 21/50
4812/4812 - 179s - loss: 3.1762 - accuracy1000: 0.4354 - val_loss: 3.4447 - val_accuracy1000: 0.3377 - 179s/epoch - 37ms/step
Epoch 22/50
4812/4812 - 179s - loss: 3.1753 - accuracy1000: 0.4359 - val_loss: 3.4412 - val_accuracy1000: 0.3382 - 179s/epoch - 37ms/step
Epoch 23/50
4812/4812 - 181s - loss: 3.1733 - accuracy1000: 0.4364 - val_loss: 3.4381 - val_accuracy1000: 0.3373 - 181s/epoch - 38ms/step
Epoch 24/50
4812/4812 - 180s - loss: 3.1719 - accuracy1000: 0.4371 - val_loss: 3.4511 - val_accuracy1000: 0.3373 - 180s/epoch - 37ms/step
Epoch 25/50
4812/4812 - 178s - loss: 3.1711 - accuracy1000: 0.4380 - val_loss: 3.4448 - val_accuracy1000: 0.3373 - 178s/epoch - 37ms/step
Epoch 26/50
4812/4812 - 181s - loss: 3.1693 - accuracy1000: 0.4386 - val_loss: 3.4273 - val_accuracy1000: 0.3378 - 181s/epoch - 38ms/step
Epoch 27/50
4812/4812 - 179s - loss: 3.1668 - accuracy1000: 0.4393 - val_loss: 3.4290 - val_accuracy1000: 0.3371 - 179s/epoch - 37ms/step
Epoch 28/50
4812/4812 - 178s - loss: 3.1647 - accuracy1000: 0.4405 - val_loss: 3.4324 - val_accuracy1000: 0.3375 - 178s/epoch - 37ms/step
Epoch 29/50
4812/4812 - 175s - loss: 3.1632 - accuracy1000: 0.4413 - val_loss: 3.4365 - val_accuracy1000: 0.3370 - 175s/epoch - 36ms/step
Epoch 30/50
4812/4812 - 180s - loss: 3.1605 - accuracy1000: 0.4418 - val_loss: 3.4324 - val_accuracy1000: 0.3372 - 180s/epoch - 37ms/step
Epoch 31/50
4812/4812 - 181s - loss: 3.1585 - accuracy1000: 0.4424 - val_loss: 3.4311 - val_accuracy1000: 0.3361 - 181s/epoch - 38ms/step
Epoch 32/50
4812/4812 - 180s - loss: 3.1566 - accuracy1000: 0.4430 - val_loss: 3.4304 - val_accuracy1000: 0.3366 - 180s/epoch - 37ms/step
Epoch 33/50
4812/4812 - 175s - loss: 3.1539 - accuracy1000: 0.4445 - val_loss: 3.4330 - val_accuracy1000: 0.3368 - 175s/epoch - 36ms/step
Epoch 34/50
4812/4812 - 177s - loss: 3.1517 - accuracy1000: 0.4450 - val_loss: 3.4480 - val_accuracy1000: 0.3367 - 177s/epoch - 37ms/step
Epoch 35/50
4812/4812 - 175s - loss: 3.1498 - accuracy1000: 0.4458 - val_loss: 3.4524 - val_accuracy1000: 0.3360 - 175s/epoch - 36ms/step
Epoch 36/50
4812/4812 - 175s - loss: 3.1477 - accuracy1000: 0.4467 - val_loss: 3.4466 - val_accuracy1000: 0.3360 - 175s/epoch - 36ms/step
testing model: results/AAPL/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
19053/19053 - 282s - 282s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.210712
{'0': {'precision': 0.26549021941194256, 'recall': 0.5175312380486643, 'f1-score': 0.35094691373508524, 'support': 1276008}, '1': {'precision': 0.6279456036541057, 'recall': 0.002551120464422856, 'f1-score': 0.00508159620421817, 'support': 2371115}, '2': {'precision': 0.2573740507015084, 'recall': 0.49796802153572056, 'f1-score': 0.33935365586841587, 'support': 1230328}, 'accuracy': 0.26224497181007045, 'macro avg': {'precision': 0.3836032912558522, 'recall': 0.3393501266829359, 'f1-score': 0.23179405526923977, 'support': 4877451}, 'weighted avg': {'precision': 0.43964632037332296, 'recall': 0.26224497181007045, 'f1-score': 0.17988421066707175, 'support': 4877451}}
[[ 660374    2016  613618]
 [1210906    6049 1154160]
 [ 616096    1568  612664]]
Evaluating performance on  train set...
4812/4812 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1306909
{'0': {'precision': 0.3366522348664985, 'recall': 0.4702237938025192, 'f1-score': 0.3923821887041273, 'support': 404971}, '1': {'precision': 0.41013824884792627, 'recall': 0.00021879363580938895, 'f1-score': 0.0004373539594047072, 'support': 406776}, '2': {'precision': 0.35539382764616323, 'recall': 0.5633924512223859, 'f1-score': 0.43584934671303344, 'support': 420121}, 'accuracy': 0.34679770884542827, 'macro avg': {'precision': 0.36739477045352936, 'recall': 0.34461167955357147, 'f1-score': 0.2762229631255218, 'support': 1231868}, 'weighted avg': {'precision': 0.36730980818076164, 'recall': 0.34679770884542827, 'f1-score': 0.277782015464576, 'support': 1231868}}
[[190427     69 214475]
 [191853     89 214834]
 [183369     59 236693]]
Evaluating performance on  val set...
1767/1767 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1397351
{'0': {'precision': 0.34501545392634503, 'recall': 0.48150954431860477, 'f1-score': 0.4019920373992536, 'support': 150456}, '1': {'precision': 0.3877551020408163, 'recall': 0.00024306932593037983, 'f1-score': 0.0004858341004398077, 'support': 156334}, '2': {'precision': 0.3322736730851802, 'recall': 0.5531294887390638, 'f1-score': 0.4151563374505763, 'support': 145503}, 'accuracy': 0.3382011218391618, 'macro avg': {'precision': 0.3550147430174471, 'recall': 0.344960700794533, 'f1-score': 0.2725447363167566, 'support': 452293}, 'weighted avg': {'precision': 0.3556892711434935, 'recall': 0.3382011218391618, 'f1-score': 0.2674473381973001, 'support': 452293}}
[[72446    18 77992]
 [72554    38 83742]
 [64979    42 80482]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        50 (peak)  22.29 (ave)

============================================
