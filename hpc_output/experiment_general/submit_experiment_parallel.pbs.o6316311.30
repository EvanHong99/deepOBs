This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-14.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-01.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-02.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-10.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-08.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-03.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-09.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-30.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-05-15.csv
training model: results/LILAK/W3/deepLOB_L1/h10
Epoch 1/50
260/260 - 30s - loss: 3.3359 - accuracy10: 0.3622 - val_loss: 3.4341 - val_accuracy10: 0.3230 - 30s/epoch - 114ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3058 - accuracy10: 0.3614 - val_loss: 3.3517 - val_accuracy10: 0.3185 - 5s/epoch - 17ms/step
Epoch 3/50
260/260 - 5s - loss: 3.2731 - accuracy10: 0.3727 - val_loss: 3.3513 - val_accuracy10: 0.3204 - 5s/epoch - 17ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2543 - accuracy10: 0.3820 - val_loss: 3.3109 - val_accuracy10: 0.3349 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2430 - accuracy10: 0.3876 - val_loss: 3.3369 - val_accuracy10: 0.3300 - 4s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2256 - accuracy10: 0.3970 - val_loss: 3.3238 - val_accuracy10: 0.3334 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2136 - accuracy10: 0.4044 - val_loss: 3.2970 - val_accuracy10: 0.3461 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2062 - accuracy10: 0.4105 - val_loss: 3.2930 - val_accuracy10: 0.3540 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.1998 - accuracy10: 0.4170 - val_loss: 3.2781 - val_accuracy10: 0.3654 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.1896 - accuracy10: 0.4246 - val_loss: 3.2659 - val_accuracy10: 0.3714 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.1817 - accuracy10: 0.4315 - val_loss: 3.2724 - val_accuracy10: 0.3727 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.1774 - accuracy10: 0.4365 - val_loss: 3.2647 - val_accuracy10: 0.3772 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 4s - loss: 3.1704 - accuracy10: 0.4421 - val_loss: 3.2810 - val_accuracy10: 0.3747 - 4s/epoch - 17ms/step
Epoch 14/50
260/260 - 4s - loss: 3.1610 - accuracy10: 0.4443 - val_loss: 3.2660 - val_accuracy10: 0.3846 - 4s/epoch - 17ms/step
Epoch 15/50
260/260 - 4s - loss: 3.1577 - accuracy10: 0.4471 - val_loss: 3.2850 - val_accuracy10: 0.3715 - 4s/epoch - 17ms/step
Epoch 16/50
260/260 - 4s - loss: 3.1531 - accuracy10: 0.4479 - val_loss: 3.2821 - val_accuracy10: 0.3870 - 4s/epoch - 17ms/step
Epoch 17/50
260/260 - 4s - loss: 3.1486 - accuracy10: 0.4513 - val_loss: 3.2796 - val_accuracy10: 0.3824 - 4s/epoch - 17ms/step
Epoch 18/50
260/260 - 4s - loss: 3.1445 - accuracy10: 0.4533 - val_loss: 3.2861 - val_accuracy10: 0.3858 - 4s/epoch - 17ms/step
Epoch 19/50
260/260 - 5s - loss: 3.1425 - accuracy10: 0.4540 - val_loss: 3.2853 - val_accuracy10: 0.3880 - 5s/epoch - 17ms/step
Epoch 20/50
260/260 - 4s - loss: 3.1371 - accuracy10: 0.4537 - val_loss: 3.2867 - val_accuracy10: 0.3847 - 4s/epoch - 17ms/step
Epoch 21/50
260/260 - 4s - loss: 3.1332 - accuracy10: 0.4567 - val_loss: 3.2802 - val_accuracy10: 0.3925 - 4s/epoch - 17ms/step
Epoch 22/50
260/260 - 4s - loss: 3.1315 - accuracy10: 0.4582 - val_loss: 3.2767 - val_accuracy10: 0.3922 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h10
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.082935
{'0': {'precision': 0.3317155843155381, 'recall': 0.44194925691764514, 'f1-score': 0.3789792379929766, 'support': 48716}, '1': {'precision': 0.4695477211092643, 'recall': 0.356908222839892, 'f1-score': 0.4055520294979901, 'support': 75193}, '2': {'precision': 0.37997740201044183, 'recall': 0.39417577753976113, 'f1-score': 0.3869463869463869, 'support': 49483}, 'accuracy': 0.3914367444864815, 'macro avg': {'precision': 0.39374690247841476, 'recall': 0.3976777524324328, 'f1-score': 0.3904925514791178, 'support': 173392}, 'weighted avg': {'precision': 0.4052607962453133, 'recall': 0.3914367444864815, 'f1-score': 0.39277645091686053, 'support': 173392}}
[[21530 15926 11260]
 [27789 26837 20567]
 [15586 14392 19505]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0790163
{'0': {'precision': 0.34793573023993085, 'recall': 0.5083693020317929, 'f1-score': 0.41312344939686885, 'support': 18998}, '1': {'precision': 0.5240957272429243, 'recall': 0.33240920432492377, 'f1-score': 0.40680266338691207, 'support': 28856}, '2': {'precision': 0.363856134984459, 'recall': 0.39918809201623817, 'f1-score': 0.3807041090233326, 'support': 18475}, 'accuracy': 0.40140813218954, 'macro avg': {'precision': 0.4119625308224381, 'recall': 0.41332219945765153, 'f1-score': 0.40021007393570446, 'support': 66329}, 'weighted avg': {'precision': 0.42900739348185424, 'recall': 0.40140813218954, 'f1-score': 0.4013436861786024, 'support': 66329}}
[[ 9658  4702  4638]
 [11008  9592  8256]
 [ 7092  4008  7375]]
Evaluating performance on  val set...
86/86 - 1s - 622ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0908602
{'0': {'precision': 0.3408960036853622, 'recall': 0.4625, 'f1-score': 0.3924948617649009, 'support': 6400}, '1': {'precision': 0.4819912824042212, 'recall': 0.22581685296646603, 'f1-score': 0.30754592695601257, 'support': 9304}, '2': {'precision': 0.34772829509671616, 'recall': 0.4963081861958267, 'f1-score': 0.4089406163205925, 'support': 6230}, 'accuracy': 0.37170602717242635, 'macro avg': {'precision': 0.3902051937287665, 'recall': 0.3948750130540976, 'f1-score': 0.36966046834716865, 'support': 21934}, 'weighted avg': {'precision': 0.402686632330069, 'recall': 0.37170602717242635, 'f1-score': 0.36113223576964515, 'support': 21934}}
[[2960 1267 2173]
 [3576 2101 3627]
 [2147  991 3092]]
training model: results/LILAK/W3/deepLOB_L1/h20
Epoch 1/50
260/260 - 6s - loss: 3.3424 - accuracy20: 0.3602 - val_loss: 3.3478 - val_accuracy20: 0.3410 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 4s - loss: 3.2985 - accuracy20: 0.3689 - val_loss: 3.3636 - val_accuracy20: 0.3490 - 4s/epoch - 17ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2863 - accuracy20: 0.3753 - val_loss: 3.3327 - val_accuracy20: 0.3460 - 4s/epoch - 17ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2706 - accuracy20: 0.3852 - val_loss: 3.3339 - val_accuracy20: 0.3557 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 5s - loss: 3.2619 - accuracy20: 0.3914 - val_loss: 3.2960 - val_accuracy20: 0.3710 - 5s/epoch - 18ms/step
Epoch 6/50
260/260 - 5s - loss: 3.2516 - accuracy20: 0.3975 - val_loss: 3.2772 - val_accuracy20: 0.3794 - 5s/epoch - 17ms/step
Epoch 7/50
260/260 - 5s - loss: 3.2366 - accuracy20: 0.4085 - val_loss: 3.2673 - val_accuracy20: 0.3893 - 5s/epoch - 18ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2312 - accuracy20: 0.4135 - val_loss: 3.2711 - val_accuracy20: 0.3858 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2225 - accuracy20: 0.4188 - val_loss: 3.2695 - val_accuracy20: 0.3876 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 5s - loss: 3.2137 - accuracy20: 0.4213 - val_loss: 3.2619 - val_accuracy20: 0.3986 - 5s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2078 - accuracy20: 0.4246 - val_loss: 3.2670 - val_accuracy20: 0.3894 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2005 - accuracy20: 0.4282 - val_loss: 3.2672 - val_accuracy20: 0.3946 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 5s - loss: 3.1921 - accuracy20: 0.4342 - val_loss: 3.2706 - val_accuracy20: 0.3929 - 5s/epoch - 18ms/step
Epoch 14/50
260/260 - 5s - loss: 3.1868 - accuracy20: 0.4361 - val_loss: 3.2644 - val_accuracy20: 0.3961 - 5s/epoch - 17ms/step
Epoch 15/50
260/260 - 5s - loss: 3.1835 - accuracy20: 0.4365 - val_loss: 3.2706 - val_accuracy20: 0.3907 - 5s/epoch - 18ms/step
Epoch 16/50
260/260 - 4s - loss: 3.1855 - accuracy20: 0.4363 - val_loss: 3.2621 - val_accuracy20: 0.3913 - 4s/epoch - 17ms/step
Epoch 17/50
260/260 - 5s - loss: 3.1803 - accuracy20: 0.4388 - val_loss: 3.2485 - val_accuracy20: 0.4007 - 5s/epoch - 18ms/step
Epoch 18/50
260/260 - 5s - loss: 3.1759 - accuracy20: 0.4398 - val_loss: 3.2740 - val_accuracy20: 0.3920 - 5s/epoch - 17ms/step
Epoch 19/50
260/260 - 5s - loss: 3.1718 - accuracy20: 0.4418 - val_loss: 3.2626 - val_accuracy20: 0.3911 - 5s/epoch - 17ms/step
Epoch 20/50
260/260 - 5s - loss: 3.1647 - accuracy20: 0.4452 - val_loss: 3.2491 - val_accuracy20: 0.4003 - 5s/epoch - 17ms/step
Epoch 21/50
260/260 - 5s - loss: 3.1634 - accuracy20: 0.4452 - val_loss: 3.2551 - val_accuracy20: 0.3957 - 5s/epoch - 17ms/step
Epoch 22/50
260/260 - 5s - loss: 3.1609 - accuracy20: 0.4450 - val_loss: 3.2561 - val_accuracy20: 0.3972 - 5s/epoch - 18ms/step
Epoch 23/50
260/260 - 5s - loss: 3.1520 - accuracy20: 0.4488 - val_loss: 3.2854 - val_accuracy20: 0.3876 - 5s/epoch - 17ms/step
Epoch 24/50
260/260 - 4s - loss: 3.1511 - accuracy20: 0.4472 - val_loss: 3.2655 - val_accuracy20: 0.3961 - 4s/epoch - 17ms/step
Epoch 25/50
260/260 - 4s - loss: 3.1481 - accuracy20: 0.4505 - val_loss: 3.2692 - val_accuracy20: 0.3932 - 4s/epoch - 17ms/step
Epoch 26/50
260/260 - 4s - loss: 3.1463 - accuracy20: 0.4514 - val_loss: 3.2548 - val_accuracy20: 0.4014 - 4s/epoch - 17ms/step
Epoch 27/50
260/260 - 5s - loss: 3.1393 - accuracy20: 0.4548 - val_loss: 3.2741 - val_accuracy20: 0.3862 - 5s/epoch - 18ms/step
testing model: results/LILAK/W3/deepLOB_L1/h20
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.083782
{'0': {'precision': 0.4464942577148794, 'recall': 0.2694125819623524, 'f1-score': 0.3360525815246106, 'support': 59021}, '1': {'precision': 0.3573232149016902, 'recall': 0.4671513096182986, 'f1-score': 0.4049221724480303, 'support': 55436}, '2': {'precision': 0.41522724488545876, 'recall': 0.46010011029099857, 'f1-score': 0.4365134941523998, 'support': 58935}, 'accuracy': 0.39744624896188985, 'macro avg': {'precision': 0.4063482391673428, 'recall': 0.39888800062388313, 'f1-score': 0.39249608270834696, 'support': 173392}, 'weighted avg': {'precision': 0.40735746172375026, 'recall': 0.39744624896188985, 'f1-score': 0.3922173326558592, 'support': 173392}}
[[15901 24529 18591]
 [ 9942 25897 19597]
 [ 9770 22049 27116]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0776623
{'0': {'precision': 0.4227963695083245, 'recall': 0.33540948847071295, 'f1-score': 0.37406704928935636, 'support': 22638}, '1': {'precision': 0.4008046614872364, 'recall': 0.4049432322571602, 'f1-score': 0.4028633183814814, 'support': 21403}, '2': {'precision': 0.4098182905855081, 'recall': 0.49178930366116297, 'f1-score': 0.447077538034833, 'support': 22288}, 'accuracy': 0.4103936438058768, 'macro avg': {'precision': 0.41113977386035633, 'recall': 0.41071400812967873, 'f1-score': 0.40800263523522357, 'support': 66329}, 'weighted avg': {'precision': 0.4113391795943038, 'recall': 0.4103936438058768, 'f1-score': 0.40789213817261916, 'support': 66329}}
[[ 7593  6789  8256]
 [ 5207  8667  7529]
 [ 5159  6168 10961]]
Evaluating performance on  val set...
86/86 - 1s - 657ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0823158
{'0': {'precision': 0.4371574716843259, 'recall': 0.3121168644841529, 'f1-score': 0.3642036374705121, 'support': 7667}, '1': {'precision': 0.3686573866187696, 'recall': 0.36029842012873026, 'f1-score': 0.36442997706591695, 'support': 6836}, '2': {'precision': 0.3976889252479804, 'recall': 0.5233481361862468, 'f1-score': 0.4519465427077281, 'support': 7431}, 'accuracy': 0.39869608826479436, 'macro avg': {'precision': 0.40116792785035865, 'recall': 0.3985878069330433, 'f1-score': 0.39352671908138576, 'support': 21934}, 'weighted avg': {'precision': 0.4024370672858293, 'recall': 0.39869608826479436, 'f1-score': 0.39400051839929573, 'support': 21934}}
[[2393 2247 3027]
 [1510 2463 2863]
 [1571 1971 3889]]
training model: results/LILAK/W3/deepLOB_L1/h30
Epoch 1/50
260/260 - 7s - loss: 3.3485 - accuracy30: 0.3491 - val_loss: 3.3850 - val_accuracy30: 0.3340 - 7s/epoch - 25ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3140 - accuracy30: 0.3577 - val_loss: 3.3237 - val_accuracy30: 0.3535 - 5s/epoch - 18ms/step
Epoch 3/50
260/260 - 5s - loss: 3.2942 - accuracy30: 0.3675 - val_loss: 3.2924 - val_accuracy30: 0.3648 - 5s/epoch - 18ms/step
Epoch 4/50
260/260 - 5s - loss: 3.2824 - accuracy30: 0.3751 - val_loss: 3.2918 - val_accuracy30: 0.3634 - 5s/epoch - 17ms/step
Epoch 5/50
260/260 - 5s - loss: 3.2680 - accuracy30: 0.3853 - val_loss: 3.2769 - val_accuracy30: 0.3783 - 5s/epoch - 18ms/step
Epoch 6/50
260/260 - 5s - loss: 3.2550 - accuracy30: 0.3936 - val_loss: 3.2751 - val_accuracy30: 0.3840 - 5s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2473 - accuracy30: 0.3992 - val_loss: 3.2669 - val_accuracy30: 0.3838 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2425 - accuracy30: 0.4026 - val_loss: 3.2716 - val_accuracy30: 0.3876 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2385 - accuracy30: 0.4069 - val_loss: 3.2726 - val_accuracy30: 0.3854 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2349 - accuracy30: 0.4089 - val_loss: 3.2703 - val_accuracy30: 0.3829 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 5s - loss: 3.2310 - accuracy30: 0.4094 - val_loss: 3.2684 - val_accuracy30: 0.3872 - 5s/epoch - 18ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2272 - accuracy30: 0.4139 - val_loss: 3.2684 - val_accuracy30: 0.3872 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2217 - accuracy30: 0.4154 - val_loss: 3.2768 - val_accuracy30: 0.3877 - 4s/epoch - 17ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2197 - accuracy30: 0.4175 - val_loss: 3.2802 - val_accuracy30: 0.3836 - 4s/epoch - 17ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2141 - accuracy30: 0.4180 - val_loss: 3.2889 - val_accuracy30: 0.3841 - 4s/epoch - 17ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2111 - accuracy30: 0.4196 - val_loss: 3.2724 - val_accuracy30: 0.3905 - 4s/epoch - 17ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2080 - accuracy30: 0.4225 - val_loss: 3.2736 - val_accuracy30: 0.3876 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h30
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874852
{'0': {'precision': 0.3862326065282414, 'recall': 0.4560966453946695, 'f1-score': 0.4182673124017119, 'support': 58606}, '1': {'precision': 0.37520046654031197, 'recall': 0.18115266168059832, 'f1-score': 0.24433605107938425, 'support': 56825}, '2': {'precision': 0.3935425868740961, 'recall': 0.5211090215834785, 'f1-score': 0.4484299606562245, 'support': 57961}, 'accuracy': 0.3877226169604134, 'macro avg': {'precision': 0.38499188664754985, 'recall': 0.3861194428862487, 'f1-score': 0.3703444413791069, 'support': 173392}, 'weighted avg': {'precision': 0.3850606517437761, 'recall': 0.3877226169604134, 'f1-score': 0.37134826960180495, 'support': 173392}}
[[26730  8475 23401]
 [23387 10294 23144]
 [19090  8667 30204]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0872144
{'0': {'precision': 0.3859250851305335, 'recall': 0.44106463878326996, 'f1-score': 0.4116566466265865, 'support': 22355}, '1': {'precision': 0.3751399776035834, 'recall': 0.2448718534423683, 'f1-score': 0.296320866849103, 'support': 21889}, '2': {'precision': 0.3971010116261513, 'recall': 0.4763414081956079, 'f1-score': 0.43312678839780144, 'support': 22085}, 'accuracy': 0.3880655520209863, 'macro avg': {'precision': 0.3860553581200894, 'recall': 0.387425966807082, 'f1-score': 0.380368100624497, 'support': 66329}, 'weighted avg': {'precision': 0.38608708241676293, 'recall': 0.3880655520209863, 'f1-score': 0.38074382112745264, 'support': 66329}}
[[ 9860  4601  7894]
 [ 8451  5360  8078]
 [ 7238  4327 10520]]
Evaluating performance on  val set...
86/86 - 1s - 629ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0880272
{'0': {'precision': 0.40167077513010135, 'recall': 0.38729697609930014, 'f1-score': 0.3943529411764706, 'support': 7573}, '1': {'precision': 0.3452717562048382, 'recall': 0.156686626746507, 'f1-score': 0.2155535941943709, 'support': 7014}, '2': {'precision': 0.38361428945759457, 'recall': 0.5977950183748468, 'f1-score': 0.4673334752074909, 'support': 7347}, 'accuracy': 0.38406127473329077, 'macro avg': {'precision': 0.37685227359751144, 'recall': 0.380592873740218, 'f1-score': 0.3590800035261108, 'support': 21934}, 'weighted avg': {'precision': 0.3775874470103921, 'recall': 0.38406127473329077, 'f1-score': 0.3616224480513433, 'support': 21934}}
[[2933 1102 3538]
 [2396 1099 3519]
 [1973  982 4392]]
training model: results/LILAK/W3/deepLOB_L1/h50
Epoch 1/50
260/260 - 7s - loss: 3.3561 - accuracy50: 0.3445 - val_loss: 3.3918 - val_accuracy50: 0.3321 - 7s/epoch - 26ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3144 - accuracy50: 0.3490 - val_loss: 3.3529 - val_accuracy50: 0.3333 - 5s/epoch - 18ms/step
Epoch 3/50
260/260 - 5s - loss: 3.3056 - accuracy50: 0.3550 - val_loss: 3.3272 - val_accuracy50: 0.3412 - 5s/epoch - 17ms/step
Epoch 4/50
260/260 - 5s - loss: 3.2938 - accuracy50: 0.3615 - val_loss: 3.3127 - val_accuracy50: 0.3450 - 5s/epoch - 17ms/step
Epoch 5/50
260/260 - 5s - loss: 3.2831 - accuracy50: 0.3691 - val_loss: 3.2970 - val_accuracy50: 0.3552 - 5s/epoch - 18ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2777 - accuracy50: 0.3739 - val_loss: 3.3082 - val_accuracy50: 0.3516 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2717 - accuracy50: 0.3803 - val_loss: 3.3059 - val_accuracy50: 0.3539 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2662 - accuracy50: 0.3846 - val_loss: 3.3060 - val_accuracy50: 0.3551 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2636 - accuracy50: 0.3861 - val_loss: 3.3017 - val_accuracy50: 0.3665 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 5s - loss: 3.2620 - accuracy50: 0.3880 - val_loss: 3.3079 - val_accuracy50: 0.3588 - 5s/epoch - 17ms/step
Epoch 11/50
260/260 - 5s - loss: 3.2586 - accuracy50: 0.3903 - val_loss: 3.2987 - val_accuracy50: 0.3648 - 5s/epoch - 18ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2522 - accuracy50: 0.3957 - val_loss: 3.3071 - val_accuracy50: 0.3677 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 5s - loss: 3.2478 - accuracy50: 0.3994 - val_loss: 3.3153 - val_accuracy50: 0.3652 - 5s/epoch - 17ms/step
Epoch 14/50
260/260 - 5s - loss: 3.2422 - accuracy50: 0.4019 - val_loss: 3.3127 - val_accuracy50: 0.3582 - 5s/epoch - 17ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2399 - accuracy50: 0.4024 - val_loss: 3.3076 - val_accuracy50: 0.3635 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h50
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0998611
{'0': {'precision': 0.3421115737611999, 'recall': 0.27485769331815396, 'f1-score': 0.3048190664879669, 'support': 57095}, '1': {'precision': 0.3459059376194898, 'recall': 0.2125856049415872, 'f1-score': 0.2633329867969643, 'support': 59576}, '2': {'precision': 0.3586302484957154, 'recall': 0.574778300805698, 'f1-score': 0.441677730511827, 'support': 56721}, 'accuracy': 0.35157331364768846, 'macro avg': {'precision': 0.34888258662546834, 'recall': 0.35407386635514637, 'f1-score': 0.33660992793225275, 'support': 173392}, 'weighted avg': {'precision': 0.3488189695513052, 'recall': 0.35157331364768846, 'f1-score': 0.33533480884301325, 'support': 173392}}
[[15693 12733 28669]
 [17275 12665 29636]
 [12903 11216 32602]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995637
{'0': {'precision': 0.37398426834817655, 'recall': 0.2574049217002237, 'f1-score': 0.30493202236768874, 'support': 22350}, '1': {'precision': 0.34029274425287354, 'recall': 0.35117227319062183, 'f1-score': 0.34564691932320885, 'support': 21582}, '2': {'precision': 0.36133779730766546, 'recall': 0.4626065990980935, 'f1-score': 0.4057488594309882, 'support': 22397}, 'accuracy': 0.3572042394729304, 'macro avg': {'precision': 0.35853826996957183, 'recall': 0.35706126466297966, 'f1-score': 0.35210926704062856, 'support': 66329}, 'weighted avg': {'precision': 0.35875151216431794, 'recall': 0.3572042394729304, 'f1-score': 0.3522221007014606, 'support': 66329}}
[[ 5753  7410  9187]
 [ 4877  7579  9126]
 [ 4753  7283 10361]]
Evaluating performance on  val set...
86/86 - 1s - 613ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987643
{'0': {'precision': 0.39799240368963645, 'recall': 0.19593962868972886, 'f1-score': 0.2625973328559921, 'support': 7487}, '1': {'precision': 0.3421240199572345, 'recall': 0.2670375521557719, 'f1-score': 0.2999531323230746, 'support': 7190}, '2': {'precision': 0.3555713833491611, 'recall': 0.6191263607551329, 'f1-score': 0.4517166842607952, 'support': 7257}, 'accuracy': 0.3592595969727364, 'macro avg': {'precision': 0.36522926899867736, 'recall': 0.36070118053354455, 'f1-score': 0.3380890498132873, 'support': 21934}, 'weighted avg': {'precision': 0.3656434010614428, 'recall': 0.3592595969727364, 'f1-score': 0.33741393408299036, 'support': 21934}}
[[1467 1937 4083]
 [1210 1920 4060]
 [1009 1755 4493]]
training model: results/LILAK/W3/deepLOB_L1/h100
Epoch 1/50
260/260 - 6s - loss: 3.3509 - accuracy100: 0.3507 - val_loss: 3.3886 - val_accuracy100: 0.3472 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3239 - accuracy100: 0.3527 - val_loss: 3.3696 - val_accuracy100: 0.3428 - 5s/epoch - 17ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3204 - accuracy100: 0.3509 - val_loss: 3.3467 - val_accuracy100: 0.3457 - 4s/epoch - 17ms/step
Epoch 4/50
260/260 - 5s - loss: 3.2981 - accuracy100: 0.3593 - val_loss: 3.3127 - val_accuracy100: 0.3537 - 5s/epoch - 17ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2937 - accuracy100: 0.3597 - val_loss: 3.3301 - val_accuracy100: 0.3483 - 4s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2916 - accuracy100: 0.3614 - val_loss: 3.3200 - val_accuracy100: 0.3485 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 5s - loss: 3.2853 - accuracy100: 0.3641 - val_loss: 3.3016 - val_accuracy100: 0.3621 - 5s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2754 - accuracy100: 0.3717 - val_loss: 3.3097 - val_accuracy100: 0.3559 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2726 - accuracy100: 0.3715 - val_loss: 3.3311 - val_accuracy100: 0.3542 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2666 - accuracy100: 0.3759 - val_loss: 3.3202 - val_accuracy100: 0.3578 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2624 - accuracy100: 0.3827 - val_loss: 3.3395 - val_accuracy100: 0.3516 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2583 - accuracy100: 0.3858 - val_loss: 3.3349 - val_accuracy100: 0.3578 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 5s - loss: 3.2529 - accuracy100: 0.3922 - val_loss: 3.3535 - val_accuracy100: 0.3529 - 5s/epoch - 17ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2495 - accuracy100: 0.3918 - val_loss: 3.3528 - val_accuracy100: 0.3547 - 4s/epoch - 17ms/step
Epoch 15/50
260/260 - 5s - loss: 3.2472 - accuracy100: 0.3938 - val_loss: 3.3668 - val_accuracy100: 0.3504 - 5s/epoch - 17ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2430 - accuracy100: 0.3962 - val_loss: 3.3662 - val_accuracy100: 0.3502 - 4s/epoch - 17ms/step
Epoch 17/50
260/260 - 5s - loss: 3.2414 - accuracy100: 0.3995 - val_loss: 3.3463 - val_accuracy100: 0.3614 - 5s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h100
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103355
{'0': {'precision': 0.3508298304102044, 'recall': 0.2944002675951407, 'f1-score': 0.3201474831146714, 'support': 65771}, '1': {'precision': 0.24396604338900293, 'recall': 0.4934350802379082, 'f1-score': 0.3265018192618995, 'support': 44555}, '2': {'precision': 0.4035606195478013, 'recall': 0.17971648748929692, 'f1-score': 0.24868624589966098, 'support': 63066}, 'accuracy': 0.3038317800129187, 'macro avg': {'precision': 0.3327854977823362, 'recall': 0.32251727844078193, 'f1-score': 0.298445182758744, 'support': 173392}, 'weighted avg': {'precision': 0.34254919414683616, 'recall': 0.3038317800129187, 'f1-score': 0.29578847612956194, 'support': 173392}}
[[19363 36867  9541]
 [15360 21985  7210]
 [20469 31263 11334]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1051562
{'0': {'precision': 0.3487120338331411, 'recall': 0.28938012762078397, 'f1-score': 0.31628764291229733, 'support': 21940}, '1': {'precision': 0.34681867363365265, 'recall': 0.5996532213907647, 'f1-score': 0.43946563226270297, 'support': 21916}, '2': {'precision': 0.36152116531430245, 'recall': 0.16455301917856985, 'f1-score': 0.2261635373983243, 'support': 22473}, 'accuracy': 0.34960575313965236, 'macro avg': {'precision': 0.3523506242603654, 'recall': 0.3511954560633728, 'f1-score': 0.32730560419110816, 'support': 66329}, 'weighted avg': {'precision': 0.3524263176252102, 'recall': 0.34960575313965236, 'f1-score': 0.3264522736377413, 'support': 66329}}
[[ 6349 12268  3323]
 [ 5566 13142  3208]
 [ 6292 12483  3698]]
Evaluating performance on  val set...
86/86 - 1s - 616ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003597
{'0': {'precision': 0.36630676405208, 'recall': 0.3108745452095405, 'f1-score': 0.3363218893505357, 'support': 7421}, '1': {'precision': 0.3675593988749895, 'recall': 0.5838111748233098, 'f1-score': 0.4511076764554353, 'support': 7499}, '2': {'precision': 0.3232214765100671, 'recall': 0.17165668662674652, 'f1-score': 0.22422944408231676, 'support': 7014}, 'accuracy': 0.3596699188474514, 'macro avg': {'precision': 0.3523625464790456, 'recall': 0.3554474688865323, 'f1-score': 0.3372196699627626, 'support': 21934}, 'weighted avg': {'precision': 0.35295732034447175, 'recall': 0.3596699188474514, 'f1-score': 0.3397212787181091, 'support': 21934}}
[[2307 3799 1315]
 [1915 4378 1206]
 [2076 3734 1204]]
training model: results/LILAK/W3/deepLOB_L1/h200
Epoch 1/50
260/260 - 6s - loss: 3.3532 - accuracy200: 0.3490 - val_loss: 3.4358 - val_accuracy200: 0.3283 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3246 - accuracy200: 0.3461 - val_loss: 3.3635 - val_accuracy200: 0.3375 - 5s/epoch - 17ms/step
Epoch 3/50
260/260 - 5s - loss: 3.3055 - accuracy200: 0.3567 - val_loss: 3.3692 - val_accuracy200: 0.3346 - 5s/epoch - 17ms/step
Epoch 4/50
260/260 - 5s - loss: 3.2993 - accuracy200: 0.3583 - val_loss: 3.3464 - val_accuracy200: 0.3261 - 5s/epoch - 18ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2922 - accuracy200: 0.3608 - val_loss: 3.3496 - val_accuracy200: 0.3209 - 4s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2884 - accuracy200: 0.3612 - val_loss: 3.3506 - val_accuracy200: 0.3237 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2878 - accuracy200: 0.3598 - val_loss: 3.3299 - val_accuracy200: 0.3304 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2778 - accuracy200: 0.3716 - val_loss: 3.3210 - val_accuracy200: 0.3400 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2749 - accuracy200: 0.3711 - val_loss: 3.3370 - val_accuracy200: 0.3401 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2671 - accuracy200: 0.3805 - val_loss: 3.3320 - val_accuracy200: 0.3498 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2636 - accuracy200: 0.3818 - val_loss: 3.3475 - val_accuracy200: 0.3340 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2606 - accuracy200: 0.3825 - val_loss: 3.3248 - val_accuracy200: 0.3380 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2583 - accuracy200: 0.3841 - val_loss: 3.3249 - val_accuracy200: 0.3459 - 4s/epoch - 17ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2539 - accuracy200: 0.3909 - val_loss: 3.3292 - val_accuracy200: 0.3413 - 4s/epoch - 17ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2501 - accuracy200: 0.3906 - val_loss: 3.3430 - val_accuracy200: 0.3271 - 4s/epoch - 17ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2418 - accuracy200: 0.3984 - val_loss: 3.3475 - val_accuracy200: 0.3343 - 4s/epoch - 17ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2395 - accuracy200: 0.4012 - val_loss: 3.3433 - val_accuracy200: 0.3443 - 4s/epoch - 17ms/step
Epoch 18/50
260/260 - 4s - loss: 3.2345 - accuracy200: 0.4013 - val_loss: 3.3653 - val_accuracy200: 0.3375 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h200
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1204766
{'0': {'precision': 0.31210884353741497, 'recall': 0.02031742657739044, 'f1-score': 0.038151308021087994, 'support': 56454}, '1': {'precision': 0.3645216578373325, 'recall': 0.07329145846712927, 'f1-score': 0.12204442009989958, 'support': 63841}, '2': {'precision': 0.30953397798331217, 'recall': 0.9145526112586398, 'f1-score': 0.462524645439046, 'support': 53097}, 'accuracy': 0.3136592230322045, 'macro avg': {'precision': 0.3287214931193532, 'recall': 0.33605383210105316, 'f1-score': 0.2075734578533445, 'support': 173392}, 'weighted avg': {'precision': 0.3306181683124613, 'recall': 0.3136592230322045, 'f1-score': 0.1989936263812472, 'support': 173392}}
[[ 1147  4723 50584]
 [ 1425  4679 57737]
 [ 1103  3434 48560]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027657
{'0': {'precision': 0.35287958115183243, 'recall': 0.046092823926324425, 'f1-score': 0.08153554578813661, 'support': 21934}, '1': {'precision': 0.38009671064414063, 'recall': 0.2904653284671533, 'f1-score': 0.32929068294070496, 'support': 21920}, '2': {'precision': 0.34474343330550383, 'recall': 0.7165294771968854, 'f1-score': 0.46551425102618954, 'support': 22475}, 'accuracy': 0.35402312713895884, 'macro avg': {'precision': 0.3592399083671589, 'recall': 0.3510292098634544, 'f1-score': 0.29211349325167707, 'support': 66329}, 'weighted avg': {'precision': 0.35911726837197994, 'recall': 0.35402312713895884, 'f1-score': 0.2935199569297118, 'support': 66329}}
[[ 1011  5020 15903]
 [  847  6367 14706]
 [ 1007  5364 16104]]
Evaluating performance on  val set...
86/86 - 1s - 639ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1048002
{'0': {'precision': 0.3303030303030303, 'recall': 0.028078310149407523, 'f1-score': 0.051756885090218425, 'support': 7764}, '1': {'precision': 0.39860308285163776, 'recall': 0.2286227379472303, 'f1-score': 0.29058028267930824, 'support': 7239}, '2': {'precision': 0.3255460810652961, 'recall': 0.8042129562833646, 'f1-score': 0.4634764894191992, 'support': 6931}, 'accuracy': 0.339518555667001, 'macro avg': {'precision': 0.3514840647399881, 'recall': 0.35363800146000085, 'f1-score': 0.268604552396242, 'support': 21934}, 'weighted avg': {'precision': 0.3513413117488511, 'recall': 0.339518555667001, 'f1-score': 0.26067779111518363, 'support': 21934}}
[[ 218 1355 6191]
 [ 227 1655 5357]
 [ 215 1142 5574]]
training model: results/LILAK/W3/deepLOB_L1/h300
Epoch 1/50
260/260 - 7s - loss: 3.3536 - accuracy300: 0.3489 - val_loss: 3.4127 - val_accuracy300: 0.3234 - 7s/epoch - 26ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3243 - accuracy300: 0.3528 - val_loss: 3.3865 - val_accuracy300: 0.3351 - 5s/epoch - 18ms/step
Epoch 3/50
260/260 - 5s - loss: 3.3065 - accuracy300: 0.3590 - val_loss: 3.3396 - val_accuracy300: 0.3425 - 5s/epoch - 18ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2980 - accuracy300: 0.3655 - val_loss: 3.3725 - val_accuracy300: 0.3311 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2943 - accuracy300: 0.3652 - val_loss: 3.3912 - val_accuracy300: 0.3187 - 4s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2806 - accuracy300: 0.3750 - val_loss: 3.3825 - val_accuracy300: 0.3347 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2777 - accuracy300: 0.3766 - val_loss: 3.4027 - val_accuracy300: 0.3000 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2688 - accuracy300: 0.3845 - val_loss: 3.3993 - val_accuracy300: 0.3204 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2642 - accuracy300: 0.3882 - val_loss: 3.3934 - val_accuracy300: 0.3141 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2549 - accuracy300: 0.3955 - val_loss: 3.4253 - val_accuracy300: 0.3106 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2476 - accuracy300: 0.4024 - val_loss: 3.4387 - val_accuracy300: 0.3172 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2343 - accuracy300: 0.4099 - val_loss: 3.4479 - val_accuracy300: 0.3172 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2289 - accuracy300: 0.4128 - val_loss: 3.4677 - val_accuracy300: 0.3111 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h300
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1155928
{'0': {'precision': 0.27931433378904197, 'recall': 0.050525034241363564, 'f1-score': 0.08557114551283083, 'support': 52568}, '1': {'precision': 0.4131279821668724, 'recall': 0.3046295541608933, 'f1-score': 0.3506782907854099, 'support': 73614}, '2': {'precision': 0.2851772777869017, 'recall': 0.6620631222198686, 'f1-score': 0.3986429609978828, 'support': 47210}, 'accuracy': 0.3249111839069853, 'macro avg': {'precision': 0.325873197914272, 'recall': 0.3390725702073752, 'f1-score': 0.2782974657653745, 'support': 173392}, 'weighted avg': {'precision': 0.33772156998116487, 'recall': 0.3249111839069853, 'f1-score': 0.2833641105927938, 'support': 173392}}
[[ 2656 18446 31466]
 [ 4309 22425 46880]
 [ 2544 13410 31256]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1124928
{'0': {'precision': 0.3281322775966465, 'recall': 0.06434671416175732, 'f1-score': 0.1075942117521286, 'support': 21897}, '1': {'precision': 0.35188824180928224, 'recall': 0.44745808913724955, 'f1-score': 0.39396, 'support': 22011}, '2': {'precision': 0.3420959877812372, 'recall': 0.5194683555595201, 'f1-score': 0.4125241291373723, 'support': 22421}, 'accuracy': 0.34532406639629726, 'macro avg': {'precision': 0.340705502395722, 'recall': 0.34375771961950896, 'f1-score': 0.30469278029650027, 'support': 66329}, 'weighted avg': {'precision': 0.3407357070819852, 'recall': 0.34532406639629726, 'f1-score': 0.30569807345392486, 'support': 66329}}
[[ 1409  8910 11578]
 [ 1341  9849 10821]
 [ 1544  9230 11647]]
Evaluating performance on  val set...
86/86 - 1s - 621ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123236
{'0': {'precision': 0.3472222222222222, 'recall': 0.04435043668122271, 'f1-score': 0.07865440464666021, 'support': 7328}, '1': {'precision': 0.4010666666666667, 'recall': 0.46517382160089077, 'f1-score': 0.4307480811089472, 'support': 8083}, '2': {'precision': 0.30104103931859244, 'recall': 0.536409627472022, 'f1-score': 0.385649729968037, 'support': 6523}, 'accuracy': 0.3457645664265524, 'macro avg': {'precision': 0.3497766427358271, 'recall': 0.34864462858471185, 'f1-score': 0.29835073857454814, 'support': 21934}, 'weighted avg': {'precision': 0.35333076550498266, 'recall': 0.3457645664265524, 'f1-score': 0.299704085230047, 'support': 21934}}
[[ 325 2877 4126]
 [ 325 3760 3998]
 [ 286 2738 3499]]
training model: results/LILAK/W3/deepLOB_L1/h500
Epoch 1/50
260/260 - 7s - loss: 3.3476 - accuracy500: 0.3518 - val_loss: 3.4641 - val_accuracy500: 0.3156 - 7s/epoch - 25ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3290 - accuracy500: 0.3542 - val_loss: 3.3815 - val_accuracy500: 0.3484 - 4s/epoch - 17ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3091 - accuracy500: 0.3591 - val_loss: 3.3627 - val_accuracy500: 0.3598 - 4s/epoch - 17ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2964 - accuracy500: 0.3632 - val_loss: 3.3628 - val_accuracy500: 0.3536 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2783 - accuracy500: 0.3746 - val_loss: 3.4223 - val_accuracy500: 0.3356 - 4s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2701 - accuracy500: 0.3815 - val_loss: 3.4087 - val_accuracy500: 0.3377 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2623 - accuracy500: 0.3919 - val_loss: 3.3665 - val_accuracy500: 0.3530 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2524 - accuracy500: 0.3941 - val_loss: 3.4374 - val_accuracy500: 0.3492 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2427 - accuracy500: 0.3997 - val_loss: 3.4252 - val_accuracy500: 0.3430 - 4s/epoch - 17ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2367 - accuracy500: 0.4043 - val_loss: 3.4520 - val_accuracy500: 0.3459 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2235 - accuracy500: 0.4096 - val_loss: 3.4188 - val_accuracy500: 0.3433 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2157 - accuracy500: 0.4171 - val_loss: 3.4952 - val_accuracy500: 0.3412 - 4s/epoch - 17ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2171 - accuracy500: 0.4163 - val_loss: 3.4515 - val_accuracy500: 0.3449 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h500
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955518
{'0': {'precision': 0.32857142857142857, 'recall': 0.012209988202909949, 'f1-score': 0.023545023696682463, 'support': 50860}, '1': {'precision': 0.4414077692927951, 'recall': 0.6034053479264465, 'f1-score': 0.5098477502205129, 'support': 77114}, '2': {'precision': 0.268797191580795, 'recall': 0.3911224624598177, 'f1-score': 0.3186224832967131, 'support': 45418}, 'accuracy': 0.37438866845067825, 'macro avg': {'precision': 0.34625879648167285, 'recall': 0.3355792661963914, 'f1-score': 0.28400508573796945, 'support': 173392}, 'weighted avg': {'precision': 0.3630968696687506, 'recall': 0.3743886684506782, 'f1-score': 0.3171143724167667, 'support': 173392}}
[[  621 31738 18501]
 [  761 46531 29822]
 [  508 27146 17764]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1210145
{'0': {'precision': 0.3226890756302521, 'recall': 0.008781157100388749, 'f1-score': 0.01709706144256456, 'support': 21865}, '1': {'precision': 0.33367867595638323, 'recall': 0.5877817319098458, 'f1-score': 0.4256943182381417, 'support': 21918}, '2': {'precision': 0.34919815668202764, 'recall': 0.420118868091901, 'f1-score': 0.3813895431942179, 'support': 22546}, 'accuracy': 0.33992672888178627, 'macro avg': {'precision': 0.33518863608955435, 'recall': 0.3388939190340452, 'f1-score': 0.2747269742916414, 'support': 66329}, 'weighted avg': {'precision': 0.33533126534126045, 'recall': 0.33992672888178627, 'f1-score': 0.27594270916857033, 'support': 66329}}
[[  192 12875  8798]
 [  180 12883  8855]
 [  223 12851  9472]]
Evaluating performance on  val set...
86/86 - 1s - 627ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179957
{'0': {'precision': 0.3765432098765432, 'recall': 0.008521933500977926, 'f1-score': 0.016666666666666666, 'support': 7158}, '1': {'precision': 0.4003017891787023, 'recall': 0.6388028895768834, 'f1-score': 0.49218128809965545, 'support': 8721}, '2': {'precision': 0.27472947167409295, 'recall': 0.3563996696944674, 'f1-score': 0.3102803738317757, 'support': 6055}, 'accuracy': 0.3551563782255858, 'macro avg': {'precision': 0.35052482357644615, 'recall': 0.3345748309241096, 'f1-score': 0.27304277619936596, 'support': 21934}, 'weighted avg': {'precision': 0.3578834298673471, 'recall': 0.3551563782255858, 'f1-score': 0.2867858428498449, 'support': 21934}}
[[  61 4495 2602]
 [  55 5571 3095]
 [  46 3851 2158]]
training model: results/LILAK/W3/deepLOB_L1/h1000
Epoch 1/50
260/260 - 6s - loss: 3.3556 - accuracy1000: 0.3542 - val_loss: 3.5649 - val_accuracy1000: 0.3402 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 5s - loss: 3.3278 - accuracy1000: 0.3585 - val_loss: 3.4456 - val_accuracy1000: 0.3022 - 5s/epoch - 17ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3138 - accuracy1000: 0.3601 - val_loss: 3.4597 - val_accuracy1000: 0.3346 - 4s/epoch - 17ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2955 - accuracy1000: 0.3640 - val_loss: 3.4532 - val_accuracy1000: 0.3201 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 5s - loss: 3.2824 - accuracy1000: 0.3744 - val_loss: 3.7956 - val_accuracy1000: 0.3156 - 5s/epoch - 17ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2664 - accuracy1000: 0.3810 - val_loss: 3.6175 - val_accuracy1000: 0.3387 - 4s/epoch - 17ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2486 - accuracy1000: 0.3989 - val_loss: 3.6415 - val_accuracy1000: 0.3451 - 4s/epoch - 17ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2352 - accuracy1000: 0.4042 - val_loss: 3.6908 - val_accuracy1000: 0.3293 - 4s/epoch - 17ms/step
Epoch 9/50
260/260 - 5s - loss: 3.2077 - accuracy1000: 0.4181 - val_loss: 3.7294 - val_accuracy1000: 0.3286 - 5s/epoch - 18ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2105 - accuracy1000: 0.4174 - val_loss: 3.7776 - val_accuracy1000: 0.3302 - 4s/epoch - 17ms/step
Epoch 11/50
260/260 - 4s - loss: 3.1940 - accuracy1000: 0.4244 - val_loss: 3.8333 - val_accuracy1000: 0.3436 - 4s/epoch - 17ms/step
Epoch 12/50
260/260 - 4s - loss: 3.1832 - accuracy1000: 0.4281 - val_loss: 3.8606 - val_accuracy1000: 0.3191 - 4s/epoch - 17ms/step
testing model: results/LILAK/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302238
{'0': {'precision': 0.33214931542237147, 'recall': 0.09213873660826256, 'f1-score': 0.14425962806092396, 'support': 55818}, '1': {'precision': 0.40828654679837967, 'recall': 0.31170310889262653, 'f1-score': 0.3535167066642053, 'support': 73724}, '2': {'precision': 0.2607159726048965, 'recall': 0.6042189281641961, 'f1-score': 0.3642575305552882, 'support': 43850}, 'accuracy': 0.31499723170619176, 'macro avg': {'precision': 0.33371727827521586, 'recall': 0.33602025788836176, 'f1-score': 0.28734462176013914, 'support': 173392}, 'weighted avg': {'precision': 0.3464567180904216, 'recall': 0.31499723170619176, 'f1-score': 0.28886939602787853, 'support': 173392}}
[[ 5143 19780 30895]
 [ 6510 22980 44234]
 [ 3831 13524 26495]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120598
{'0': {'precision': 0.3250630224227146, 'recall': 0.11423509115494009, 'f1-score': 0.169058791057135, 'support': 21447}, '1': {'precision': 0.34717059066501443, 'recall': 0.22750033834077682, 'f1-score': 0.2748753168179217, 'support': 22167}, '2': {'precision': 0.3441241584963629, 'recall': 0.6706141316310807, 'f1-score': 0.4548454039205147, 'support': 22715}, 'accuracy': 0.34262539763904176, 'macro avg': {'precision': 0.33878592386136397, 'recall': 0.33744985370893255, 'f1-score': 0.2995931705985238, 'support': 66329}, 'weighted avg': {'precision': 0.33897898936236365, 'recall': 0.34262539763904176, 'f1-score': 0.30229278882177835, 'support': 66329}}
[[ 2450  4587 14410]
 [ 2501  5043 14623]
 [ 2586  4896 15233]]
Evaluating performance on  val set...
86/86 - 1s - 638ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1430937
{'0': {'precision': 0.28498827208756844, 'recall': 0.09732977303070761, 'f1-score': 0.14510350318471338, 'support': 7490}, '1': {'precision': 0.41417994166479694, 'recall': 0.22057593499820768, 'f1-score': 0.28785279900202715, 'support': 8369}, '2': {'precision': 0.2765600911589249, 'recall': 0.6791769547325103, 'f1-score': 0.3930646851481376, 'support': 6075}, 'accuracy': 0.3055074313850643, 'macro avg': {'precision': 0.3252427683037634, 'recall': 0.33236088758714183, 'f1-score': 0.27534032911162604, 'support': 21934}, 'weighted avg': {'precision': 0.33194750813891866, 'recall': 0.3055074313850643, 'f1-score': 0.26824716312466507, 'support': 21934}}
[[ 729 1516 5245]
 [ 975 1846 5548]
 [ 854 1095 4126]]
training model: results/LILAK/W3/deepOF_L1/h10
Epoch 1/50
260/260 - 6s - loss: 3.2976 - accuracy10: 0.3896 - val_loss: 3.2830 - val_accuracy10: 0.4103 - 6s/epoch - 23ms/step
Epoch 2/50
260/260 - 4s - loss: 3.2609 - accuracy10: 0.4136 - val_loss: 3.2691 - val_accuracy10: 0.4162 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2502 - accuracy10: 0.4165 - val_loss: 3.2692 - val_accuracy10: 0.4193 - 4s/epoch - 15ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2449 - accuracy10: 0.4182 - val_loss: 3.2638 - val_accuracy10: 0.4187 - 4s/epoch - 15ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2378 - accuracy10: 0.4217 - val_loss: 3.2613 - val_accuracy10: 0.4141 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2305 - accuracy10: 0.4234 - val_loss: 3.2566 - val_accuracy10: 0.4228 - 4s/epoch - 15ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2279 - accuracy10: 0.4245 - val_loss: 3.2564 - val_accuracy10: 0.4188 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2243 - accuracy10: 0.4262 - val_loss: 3.2600 - val_accuracy10: 0.4166 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2213 - accuracy10: 0.4297 - val_loss: 3.2568 - val_accuracy10: 0.4197 - 4s/epoch - 15ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2163 - accuracy10: 0.4316 - val_loss: 3.2542 - val_accuracy10: 0.4173 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2142 - accuracy10: 0.4321 - val_loss: 3.2575 - val_accuracy10: 0.4218 - 4s/epoch - 15ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2119 - accuracy10: 0.4347 - val_loss: 3.2556 - val_accuracy10: 0.4226 - 4s/epoch - 15ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2096 - accuracy10: 0.4345 - val_loss: 3.2567 - val_accuracy10: 0.4152 - 4s/epoch - 15ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2061 - accuracy10: 0.4394 - val_loss: 3.2536 - val_accuracy10: 0.4188 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2021 - accuracy10: 0.4410 - val_loss: 3.2555 - val_accuracy10: 0.4189 - 4s/epoch - 16ms/step
Epoch 16/50
260/260 - 4s - loss: 3.1988 - accuracy10: 0.4405 - val_loss: 3.2585 - val_accuracy10: 0.4246 - 4s/epoch - 15ms/step
Epoch 17/50
260/260 - 4s - loss: 3.1983 - accuracy10: 0.4403 - val_loss: 3.2557 - val_accuracy10: 0.4253 - 4s/epoch - 15ms/step
Epoch 18/50
260/260 - 4s - loss: 3.1945 - accuracy10: 0.4428 - val_loss: 3.2574 - val_accuracy10: 0.4209 - 4s/epoch - 15ms/step
Epoch 19/50
260/260 - 4s - loss: 3.1911 - accuracy10: 0.4435 - val_loss: 3.2576 - val_accuracy10: 0.4199 - 4s/epoch - 15ms/step
Epoch 20/50
260/260 - 4s - loss: 3.1873 - accuracy10: 0.4453 - val_loss: 3.2561 - val_accuracy10: 0.4231 - 4s/epoch - 15ms/step
Epoch 21/50
260/260 - 4s - loss: 3.1864 - accuracy10: 0.4453 - val_loss: 3.2601 - val_accuracy10: 0.4116 - 4s/epoch - 15ms/step
Epoch 22/50
260/260 - 4s - loss: 3.1834 - accuracy10: 0.4465 - val_loss: 3.2572 - val_accuracy10: 0.4183 - 4s/epoch - 15ms/step
Epoch 23/50
260/260 - 4s - loss: 3.1796 - accuracy10: 0.4477 - val_loss: 3.2590 - val_accuracy10: 0.4134 - 4s/epoch - 15ms/step
Epoch 24/50
260/260 - 4s - loss: 3.1786 - accuracy10: 0.4492 - val_loss: 3.2680 - val_accuracy10: 0.4157 - 4s/epoch - 15ms/step
testing model: results/LILAK/W3/deepOF_L1/h10
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.086843
{'0': {'precision': 0.32800016059742243, 'recall': 0.3353997741968593, 'f1-score': 0.3316586994691918, 'support': 48715}, '1': {'precision': 0.5132385492933764, 'recall': 0.48104211828228693, 'f1-score': 0.4966190472921486, 'support': 75193}, '2': {'precision': 0.33364721835097366, 'recall': 0.3580436540016168, 'f1-score': 0.34541519624090933, 'support': 49480}, 'accuracy': 0.4050222622096108, 'macro avg': {'precision': 0.3916286427472575, 'recall': 0.39149518216025436, 'f1-score': 0.39123098100074993, 'support': 173388}, 'weighted avg': {'precision': 0.4099438163225049, 'recall': 0.4050222622096108, 'f1-score': 0.40712260062795813, 'support': 173388}}
[[16339 17208 15168]
 [18808 36171 20214]
 [14667 17097 17716]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0687897
{'0': {'precision': 0.3609989773400075, 'recall': 0.3533905895990305, 'f1-score': 0.35715426806539213, 'support': 18979}, '1': {'precision': 0.5352802339098883, 'recall': 0.5264707920449033, 'f1-score': 0.5308389666195042, 'support': 28862}, '2': {'precision': 0.3564382005061722, 'recall': 0.3733095315373796, 'f1-score': 0.3646788384812535, 'support': 18486}, 'accuracy': 0.4342575421773938, 'macro avg': {'precision': 0.417572470585356, 'recall': 0.41772363772710447, 'f1-score': 0.41755735772205, 'support': 66327}, 'weighted avg': {'precision': 0.43556582201215643, 'recall': 0.4342575421773938, 'f1-score': 0.43482982972770756, 'support': 66327}}
[[ 6707  6715  5557]
 [ 6764 15195  6903]
 [ 5108  6477  6901]]
Evaluating performance on  val set...
86/86 - 1s - 603ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0759236
{'0': {'precision': 0.3468453188602442, 'recall': 0.31784271059993785, 'f1-score': 0.33171127331711275, 'support': 6434}, '1': {'precision': 0.5167792101493759, 'recall': 0.5414299496194662, 'f1-score': 0.5288174632256714, 'support': 9329}, '2': {'precision': 0.33620689655172414, 'recall': 0.3412736995624696, 'f1-score': 0.33872135102533174, 'support': 6171}, 'accuracy': 0.4195313212364366, 'macro avg': {'precision': 0.3999438085204481, 'recall': 0.40018211992729125, 'f1-score': 0.3997500291893719, 'support': 21934}, 'weighted avg': {'precision': 0.41612878597843656, 'recall': 0.4195313212364366, 'f1-score': 0.41751700119138846, 'support': 21934}}
[[2045 2421 1968]
 [2088 5051 2190]
 [1763 2302 2106]]
training model: results/LILAK/W3/deepOF_L1/h20
Epoch 1/50
260/260 - 6s - loss: 3.3132 - accuracy20: 0.3627 - val_loss: 3.2798 - val_accuracy20: 0.3766 - 6s/epoch - 24ms/step
Epoch 2/50
260/260 - 4s - loss: 3.2796 - accuracy20: 0.3820 - val_loss: 3.2715 - val_accuracy20: 0.3795 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2687 - accuracy20: 0.3882 - val_loss: 3.2663 - val_accuracy20: 0.3841 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2640 - accuracy20: 0.3893 - val_loss: 3.2611 - val_accuracy20: 0.3848 - 4s/epoch - 15ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2567 - accuracy20: 0.3931 - val_loss: 3.2633 - val_accuracy20: 0.3832 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2510 - accuracy20: 0.3972 - val_loss: 3.2580 - val_accuracy20: 0.3893 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2481 - accuracy20: 0.3986 - val_loss: 3.2584 - val_accuracy20: 0.3900 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2461 - accuracy20: 0.3997 - val_loss: 3.2604 - val_accuracy20: 0.3868 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2402 - accuracy20: 0.4034 - val_loss: 3.2591 - val_accuracy20: 0.3878 - 4s/epoch - 15ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2405 - accuracy20: 0.4032 - val_loss: 3.2611 - val_accuracy20: 0.3888 - 4s/epoch - 15ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2374 - accuracy20: 0.4037 - val_loss: 3.2594 - val_accuracy20: 0.3887 - 4s/epoch - 15ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2323 - accuracy20: 0.4093 - val_loss: 3.2560 - val_accuracy20: 0.3873 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2306 - accuracy20: 0.4106 - val_loss: 3.2583 - val_accuracy20: 0.3873 - 4s/epoch - 15ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2289 - accuracy20: 0.4103 - val_loss: 3.2574 - val_accuracy20: 0.3868 - 4s/epoch - 15ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2259 - accuracy20: 0.4116 - val_loss: 3.2576 - val_accuracy20: 0.3887 - 4s/epoch - 15ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2213 - accuracy20: 0.4133 - val_loss: 3.2570 - val_accuracy20: 0.3877 - 4s/epoch - 15ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2199 - accuracy20: 0.4123 - val_loss: 3.2582 - val_accuracy20: 0.3912 - 4s/epoch - 15ms/step
Epoch 18/50
260/260 - 4s - loss: 3.2165 - accuracy20: 0.4172 - val_loss: 3.2600 - val_accuracy20: 0.3873 - 4s/epoch - 16ms/step
Epoch 19/50
260/260 - 4s - loss: 3.2134 - accuracy20: 0.4168 - val_loss: 3.2591 - val_accuracy20: 0.3911 - 4s/epoch - 15ms/step
Epoch 20/50
260/260 - 4s - loss: 3.2109 - accuracy20: 0.4195 - val_loss: 3.2594 - val_accuracy20: 0.3916 - 4s/epoch - 15ms/step
Epoch 21/50
260/260 - 4s - loss: 3.2096 - accuracy20: 0.4197 - val_loss: 3.2608 - val_accuracy20: 0.3907 - 4s/epoch - 15ms/step
Epoch 22/50
260/260 - 4s - loss: 3.2057 - accuracy20: 0.4223 - val_loss: 3.2636 - val_accuracy20: 0.3871 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h20
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0914125
{'0': {'precision': 0.3744294920765509, 'recall': 0.323867775876383, 'f1-score': 0.3473181190493495, 'support': 59021}, '1': {'precision': 0.39462751225055037, 'recall': 0.40094884190778557, 'f1-score': 0.39776306370794556, 'support': 55436}, '2': {'precision': 0.3730174359595837, 'recall': 0.4178445979196009, 'f1-score': 0.39416058394160586, 'support': 58931}, 'accuracy': 0.38045308787228643, 'macro avg': {'precision': 0.38069148009556164, 'recall': 0.3808870719012565, 'f1-score': 0.37974725556630035, 'support': 173388}, 'weighted avg': {'precision': 0.3804073196501825, 'recall': 0.38045308787228643, 'f1-score': 0.3793672761459161, 'support': 173388}}
[[19115 17320 22586]
 [14406 22227 18803]
 [17530 16777 24624]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0771481
{'0': {'precision': 0.4088307844104588, 'recall': 0.3654846961277234, 'f1-score': 0.3859444858420268, 'support': 22674}, '1': {'precision': 0.4173954662141583, 'recall': 0.44764349043397106, 'f1-score': 0.4319906333731115, 'support': 21430}, '2': {'precision': 0.3999306578833319, 'recall': 0.4152454664086757, 'f1-score': 0.40744420160275513, 'support': 22223}, 'accuracy': 0.40870233841422043, 'macro avg': {'precision': 0.40871896950264963, 'recall': 0.4094578843234567, 'f1-score': 0.40845977360596447, 'support': 66327}, 'weighted avg': {'precision': 0.4086159943436827, 'recall': 0.40870233841422043, 'f1-score': 0.4080253446919946, 'support': 66327}}
[[8287 6768 7619]
 [5610 9593 6227]
 [6373 6622 9228]]
Evaluating performance on  val set...
86/86 - 1s - 635ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0869557
{'0': {'precision': 0.3937569323403581, 'recall': 0.32411634276770573, 'f1-score': 0.3555587351552439, 'support': 7667}, '1': {'precision': 0.3986648192467565, 'recall': 0.46278695715747914, 'f1-score': 0.4283394234673163, 'support': 6839}, '2': {'precision': 0.37246225923997917, 'recall': 0.3852988691437803, 'f1-score': 0.37877183695076755, 'support': 7428}, 'accuracy': 0.3880733108416158, 'macro avg': {'precision': 0.3882946702756979, 'recall': 0.3907340563563217, 'f1-score': 0.38755666519110926, 'support': 21934}, 'weighted avg': {'precision': 0.38807571627230136, 'recall': 0.3880733108416158, 'f1-score': 0.3861128542171301, 'support': 21934}}
[[2485 2398 2784]
 [1636 3165 2038]
 [2190 2376 2862]]
training model: results/LILAK/W3/deepOF_L1/h30
Epoch 1/50
260/260 - 6s - loss: 3.3183 - accuracy30: 0.3531 - val_loss: 3.3064 - val_accuracy30: 0.3606 - 6s/epoch - 23ms/step
Epoch 2/50
260/260 - 4s - loss: 3.2931 - accuracy30: 0.3746 - val_loss: 3.2905 - val_accuracy30: 0.3704 - 4s/epoch - 15ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2831 - accuracy30: 0.3788 - val_loss: 3.2851 - val_accuracy30: 0.3748 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2759 - accuracy30: 0.3805 - val_loss: 3.2898 - val_accuracy30: 0.3704 - 4s/epoch - 15ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2721 - accuracy30: 0.3854 - val_loss: 3.2872 - val_accuracy30: 0.3750 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2674 - accuracy30: 0.3892 - val_loss: 3.2817 - val_accuracy30: 0.3775 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2636 - accuracy30: 0.3909 - val_loss: 3.2841 - val_accuracy30: 0.3743 - 4s/epoch - 15ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2611 - accuracy30: 0.3922 - val_loss: 3.2816 - val_accuracy30: 0.3756 - 4s/epoch - 15ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2571 - accuracy30: 0.3932 - val_loss: 3.2807 - val_accuracy30: 0.3779 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2558 - accuracy30: 0.3942 - val_loss: 3.2844 - val_accuracy30: 0.3753 - 4s/epoch - 15ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2521 - accuracy30: 0.3983 - val_loss: 3.2832 - val_accuracy30: 0.3811 - 4s/epoch - 15ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2470 - accuracy30: 0.4003 - val_loss: 3.2801 - val_accuracy30: 0.3797 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2483 - accuracy30: 0.4005 - val_loss: 3.2827 - val_accuracy30: 0.3774 - 4s/epoch - 15ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2461 - accuracy30: 0.3999 - val_loss: 3.2822 - val_accuracy30: 0.3771 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2432 - accuracy30: 0.4021 - val_loss: 3.2803 - val_accuracy30: 0.3778 - 4s/epoch - 16ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2423 - accuracy30: 0.4034 - val_loss: 3.2851 - val_accuracy30: 0.3771 - 4s/epoch - 16ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2379 - accuracy30: 0.4047 - val_loss: 3.2810 - val_accuracy30: 0.3804 - 4s/epoch - 15ms/step
Epoch 18/50
260/260 - 4s - loss: 3.2372 - accuracy30: 0.4061 - val_loss: 3.2868 - val_accuracy30: 0.3755 - 4s/epoch - 16ms/step
Epoch 19/50
260/260 - 4s - loss: 3.2340 - accuracy30: 0.4082 - val_loss: 3.2807 - val_accuracy30: 0.3790 - 4s/epoch - 16ms/step
Epoch 20/50
260/260 - 4s - loss: 3.2297 - accuracy30: 0.4093 - val_loss: 3.2846 - val_accuracy30: 0.3804 - 4s/epoch - 15ms/step
Epoch 21/50
260/260 - 4s - loss: 3.2278 - accuracy30: 0.4108 - val_loss: 3.2871 - val_accuracy30: 0.3785 - 4s/epoch - 16ms/step
Epoch 22/50
260/260 - 4s - loss: 3.2258 - accuracy30: 0.4117 - val_loss: 3.2883 - val_accuracy30: 0.3798 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h30
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0985401
{'0': {'precision': 0.36954470877768664, 'recall': 0.3074599870320445, 'f1-score': 0.3356556079205708, 'support': 58606}, '1': {'precision': 0.3867266179731847, 'recall': 0.33450654652963535, 'f1-score': 0.35872611464968157, 'support': 56824}, '2': {'precision': 0.3524119930574877, 'recall': 0.4589357810828531, 'f1-score': 0.39868100573312854, 'support': 57958}, 'accuracy': 0.3669573442222068, 'macro avg': {'precision': 0.36956110660278635, 'recall': 0.3669674382148443, 'f1-score': 0.36435424276779366, 'support': 173388}, 'weighted avg': {'precision': 0.36944877866956893, 'recall': 0.3669573442222068, 'f1-score': 0.36428379718854326, 'support': 173388}}
[[18019 14976 25611]
 [14549 19008 23267]
 [16192 15167 26599]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.083302
{'0': {'precision': 0.406428497247897, 'recall': 0.3503424197663489, 'f1-score': 0.37630712276737427, 'support': 22341}, '1': {'precision': 0.40428393524283934, 'recall': 0.3707798437571383, 'f1-score': 0.3868077399675912, 'support': 21889}, '2': {'precision': 0.38741942653923095, 'recall': 0.47327691541838257, 'f1-score': 0.42606587765578213, 'support': 22097}, 'accuracy': 0.39804302923394697, 'macro avg': {'precision': 0.3993772863433224, 'recall': 0.3981330596472899, 'f1-score': 0.3963935801302492, 'support': 66327}, 'weighted avg': {'precision': 0.3993878387954101, 'recall': 0.39804302923394697, 'f1-score': 0.39634974819389285, 'support': 66327}}
[[ 7827  5934  8580]
 [ 5817  8116  7956]
 [ 5614  6025 10458]]
Evaluating performance on  val set...
86/86 - 1s - 644ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.093834
{'0': {'precision': 0.3837829106767889, 'recall': 0.313953488372093, 'f1-score': 0.34537393705937935, 'support': 7568}, '1': {'precision': 0.3874730021598272, 'recall': 0.3843736609055849, 'f1-score': 0.38591710884841524, 'support': 7001}, '2': {'precision': 0.36962946124119117, 'recall': 0.4415478615071283, 'f1-score': 0.4024005444533812, 'support': 7365}, 'accuracy': 0.37927418619494846, 'macro avg': {'precision': 0.38029512469260246, 'recall': 0.3799583369282688, 'f1-score': 0.3778971967870586, 'support': 21934}, 'weighted avg': {'precision': 0.38020828568269643, 'recall': 0.37927418619494846, 'f1-score': 0.37746310042000053, 'support': 21934}}
[[2376 2121 3071]
 [1835 2691 2475]
 [1980 2133 3252]]
training model: results/LILAK/W3/deepOF_L1/h50
Epoch 1/50
260/260 - 6s - loss: 3.3259 - accuracy50: 0.3456 - val_loss: 3.3120 - val_accuracy50: 0.3519 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 4s - loss: 3.2998 - accuracy50: 0.3597 - val_loss: 3.3040 - val_accuracy50: 0.3495 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2910 - accuracy50: 0.3666 - val_loss: 3.3068 - val_accuracy50: 0.3530 - 4s/epoch - 15ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2809 - accuracy50: 0.3707 - val_loss: 3.3047 - val_accuracy50: 0.3548 - 4s/epoch - 15ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2780 - accuracy50: 0.3757 - val_loss: 3.3005 - val_accuracy50: 0.3592 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2739 - accuracy50: 0.3817 - val_loss: 3.2988 - val_accuracy50: 0.3594 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2722 - accuracy50: 0.3805 - val_loss: 3.3012 - val_accuracy50: 0.3625 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2699 - accuracy50: 0.3826 - val_loss: 3.3016 - val_accuracy50: 0.3623 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2670 - accuracy50: 0.3844 - val_loss: 3.3017 - val_accuracy50: 0.3642 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2648 - accuracy50: 0.3859 - val_loss: 3.3031 - val_accuracy50: 0.3614 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2613 - accuracy50: 0.3918 - val_loss: 3.3037 - val_accuracy50: 0.3657 - 4s/epoch - 16ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2587 - accuracy50: 0.3917 - val_loss: 3.3048 - val_accuracy50: 0.3647 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2576 - accuracy50: 0.3935 - val_loss: 3.3044 - val_accuracy50: 0.3649 - 4s/epoch - 16ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2552 - accuracy50: 0.3933 - val_loss: 3.3036 - val_accuracy50: 0.3685 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2531 - accuracy50: 0.3959 - val_loss: 3.3063 - val_accuracy50: 0.3667 - 4s/epoch - 15ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2506 - accuracy50: 0.3972 - val_loss: 3.3070 - val_accuracy50: 0.3673 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h50
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026614
{'0': {'precision': 0.36164305360942445, 'recall': 0.2441019353708731, 'f1-score': 0.2914684261708825, 'support': 57095}, '1': {'precision': 0.3587642445778704, 'recall': 0.3931682752832564, 'f1-score': 0.3751791963992536, 'support': 59575}, '2': {'precision': 0.34214082401311063, 'recall': 0.41961987376141613, 'f1-score': 0.376940133037694, 'support': 56718}, 'accuracy': 0.35273490668327684, 'macro avg': {'precision': 0.35418270740013513, 'recall': 0.35229669480518183, 'f1-score': 0.34786258520261004, 'support': 173388}, 'weighted avg': {'precision': 0.3542744207957432, 'recall': 0.35273490668327684, 'f1-score': 0.34819007591842577, 'support': 173388}}
[[13937 21034 22124]
 [12514 23423 23638]
 [12087 20831 23800]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0899698
{'0': {'precision': 0.40406206635549385, 'recall': 0.28684010209107597, 'f1-score': 0.33550684788016866, 'support': 22333}, '1': {'precision': 0.36071972210296244, 'recall': 0.42568283358666115, 'f1-score': 0.39051804276176794, 'support': 21711}, '2': {'precision': 0.3929261226460647, 'recall': 0.43822645065745186, 'f1-score': 0.4143417842367667, 'support': 22283}, 'accuracy': 0.3831471346510471, 'macro avg': {'precision': 0.38590263703484035, 'recall': 0.38358312877839634, 'f1-score': 0.38012222495956777, 'support': 66327}, 'weighted avg': {'precision': 0.3861335022753467, 'recall': 0.3831471346510471, 'f1-score': 0.379998939168912, 'support': 66327}}
[[6406 8328 7599]
 [4981 9242 7488]
 [4467 8051 9765]]
Evaluating performance on  val set...
86/86 - 1s - 629ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001809
{'0': {'precision': 0.3765367784955199, 'recall': 0.24119060331019754, 'f1-score': 0.2940362867138557, 'support': 7492}, '1': {'precision': 0.3574578762863282, 'recall': 0.44086471408647143, 'f1-score': 0.3948042215699744, 'support': 7170}, '2': {'precision': 0.3615533043897733, 'recall': 0.41226622662266227, 'f1-score': 0.3852480082241069, 'support': 7272}, 'accuracy': 0.3631804504422358, 'macro avg': {'precision': 0.36518265305720715, 'recall': 0.36477384800644375, 'f1-score': 0.3580295055026457, 'support': 21934}, 'weighted avg': {'precision': 0.3653324586023452, 'recall': 0.3631804504422358, 'f1-score': 0.35721663374316714, 'support': 21934}}
[[1807 2892 2793]
 [1508 3161 2501]
 [1484 2790 2998]]
training model: results/LILAK/W3/deepOF_L1/h100
Epoch 1/50
260/260 - 6s - loss: 3.3281 - accuracy100: 0.3433 - val_loss: 3.3253 - val_accuracy100: 0.3477 - 6s/epoch - 24ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3030 - accuracy100: 0.3539 - val_loss: 3.3118 - val_accuracy100: 0.3500 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.2933 - accuracy100: 0.3646 - val_loss: 3.3080 - val_accuracy100: 0.3525 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2886 - accuracy100: 0.3654 - val_loss: 3.3053 - val_accuracy100: 0.3507 - 4s/epoch - 16ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2843 - accuracy100: 0.3701 - val_loss: 3.3063 - val_accuracy100: 0.3589 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2802 - accuracy100: 0.3740 - val_loss: 3.3062 - val_accuracy100: 0.3541 - 4s/epoch - 15ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2791 - accuracy100: 0.3735 - val_loss: 3.3021 - val_accuracy100: 0.3569 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2770 - accuracy100: 0.3779 - val_loss: 3.3041 - val_accuracy100: 0.3564 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2740 - accuracy100: 0.3798 - val_loss: 3.3051 - val_accuracy100: 0.3539 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2720 - accuracy100: 0.3821 - val_loss: 3.3044 - val_accuracy100: 0.3575 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2675 - accuracy100: 0.3843 - val_loss: 3.3059 - val_accuracy100: 0.3564 - 4s/epoch - 16ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2667 - accuracy100: 0.3854 - val_loss: 3.3049 - val_accuracy100: 0.3547 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2641 - accuracy100: 0.3862 - val_loss: 3.3076 - val_accuracy100: 0.3552 - 4s/epoch - 16ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2601 - accuracy100: 0.3885 - val_loss: 3.3054 - val_accuracy100: 0.3600 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2594 - accuracy100: 0.3891 - val_loss: 3.3082 - val_accuracy100: 0.3573 - 4s/epoch - 15ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2567 - accuracy100: 0.3926 - val_loss: 3.3132 - val_accuracy100: 0.3571 - 4s/epoch - 15ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2550 - accuracy100: 0.3939 - val_loss: 3.3053 - val_accuracy100: 0.3583 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h100
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1168389
{'0': {'precision': 0.41058972733037413, 'recall': 0.1575186255131519, 'f1-score': 0.22768730357574563, 'support': 65770}, '1': {'precision': 0.25947969266820814, 'recall': 0.5616653574234093, 'f1-score': 0.35496957403651114, 'support': 44555}, '2': {'precision': 0.3817415350105389, 'recall': 0.3130361701790273, 'f1-score': 0.34399177528403146, 'support': 63063}, 'accuracy': 0.3179343437838835, 'macro avg': {'precision': 0.3506036516697071, 'recall': 0.3440733843718628, 'f1-score': 0.3088828842987627, 'support': 173388}, 'weighted avg': {'precision': 0.36126704556094047, 'recall': 0.3179343437838835, 'f1-score': 0.30269578432250455, 'support': 173388}}
[[10360 36785 18625]
 [ 6183 25025 13347]
 [ 8689 34633 19741]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936166
{'0': {'precision': 0.40761689291101055, 'recall': 0.1969303638930637, 'f1-score': 0.26556118532166434, 'support': 21957}, '1': {'precision': 0.34618691890148867, 'recall': 0.5870853080568721, 'f1-score': 0.43554548835322354, 'support': 21944}, '2': {'precision': 0.40199945960551203, 'recall': 0.33171319004726657, 'f1-score': 0.36348977547580075, 'support': 22426}, 'accuracy': 0.3715832164880064, 'macro avg': {'precision': 0.3852677571393371, 'recall': 0.37190962066573413, 'f1-score': 0.3548654830502295, 'support': 66327}, 'weighted avg': {'precision': 0.3853937272473434, 'recall': 0.3715832164880064, 'f1-score': 0.35491065248467785, 'support': 66327}}
[[ 4324 12314  5319]
 [ 3314 12883  5747]
 [ 2970 12017  7439]]
Evaluating performance on  val set...
86/86 - 1s - 610ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005844
{'0': {'precision': 0.3794147325933401, 'recall': 0.1522472668376299, 'f1-score': 0.2172991716432287, 'support': 7409}, '1': {'precision': 0.35259846189699373, 'recall': 0.6049580167932826, 'f1-score': 0.4455241460541814, 'support': 7503}, '2': {'precision': 0.35413929040735875, 'recall': 0.3070350327542011, 'f1-score': 0.32890922959572844, 'support': 7022}, 'accuracy': 0.3566608917662077, 'macro avg': {'precision': 0.3620508282992309, 'recall': 0.3547467721283712, 'f1-score': 0.3305775157643795, 'support': 21934}, 'weighted avg': {'precision': 0.36214990930234675, 'recall': 0.3566608917662077, 'f1-score': 0.3310995641821104, 'support': 21934}}
[[1128 4322 1959]
 [ 991 4539 1973]
 [ 854 4012 2156]]
training model: results/LILAK/W3/deepOF_L1/h200
Epoch 1/50
260/260 - 6s - loss: 3.3305 - accuracy200: 0.3377 - val_loss: 3.3338 - val_accuracy200: 0.3345 - 6s/epoch - 23ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3091 - accuracy200: 0.3480 - val_loss: 3.3267 - val_accuracy200: 0.3352 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3022 - accuracy200: 0.3519 - val_loss: 3.3233 - val_accuracy200: 0.3349 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.2959 - accuracy200: 0.3548 - val_loss: 3.3244 - val_accuracy200: 0.3339 - 4s/epoch - 16ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2915 - accuracy200: 0.3580 - val_loss: 3.3199 - val_accuracy200: 0.3339 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2879 - accuracy200: 0.3623 - val_loss: 3.3196 - val_accuracy200: 0.3386 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2867 - accuracy200: 0.3629 - val_loss: 3.3210 - val_accuracy200: 0.3391 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2843 - accuracy200: 0.3624 - val_loss: 3.3215 - val_accuracy200: 0.3384 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2821 - accuracy200: 0.3656 - val_loss: 3.3204 - val_accuracy200: 0.3377 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2785 - accuracy200: 0.3696 - val_loss: 3.3208 - val_accuracy200: 0.3370 - 4s/epoch - 15ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2772 - accuracy200: 0.3723 - val_loss: 3.3236 - val_accuracy200: 0.3393 - 4s/epoch - 16ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2759 - accuracy200: 0.3739 - val_loss: 3.3253 - val_accuracy200: 0.3381 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2747 - accuracy200: 0.3744 - val_loss: 3.3245 - val_accuracy200: 0.3392 - 4s/epoch - 16ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2728 - accuracy200: 0.3752 - val_loss: 3.3221 - val_accuracy200: 0.3417 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2700 - accuracy200: 0.3760 - val_loss: 3.3236 - val_accuracy200: 0.3405 - 4s/epoch - 17ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2691 - accuracy200: 0.3790 - val_loss: 3.3239 - val_accuracy200: 0.3407 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h200
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1111504
{'0': {'precision': 0.3476141370582169, 'recall': 0.2627364840926805, 'f1-score': 0.299273607748184, 'support': 56452}, '1': {'precision': 0.3827006845052894, 'recall': 0.03853323099575508, 'f1-score': 0.07001665030098621, 'support': 63841}, '2': {'precision': 0.31054291507096193, 'recall': 0.7269611074489123, 'f1-score': 0.4351840890256896, 'support': 53095}, 'accuracy': 0.3223406464115164, 'macro avg': {'precision': 0.34695257887815606, 'recall': 0.34274360751244926, 'f1-score': 0.26815811569161996, 'support': 173388}, 'weighted avg': {'precision': 0.349180933746311, 'recall': 0.3223406464115164, 'f1-score': 0.256480413196327, 'support': 173388}}
[[14832  2036 39584]
 [15271  2460 46110]
 [12565  1932 38598]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973486
{'0': {'precision': 0.3805513900103818, 'recall': 0.30060595015718256, 'f1-score': 0.335887189146537, 'support': 21949}, '1': {'precision': 0.3684375982395473, 'recall': 0.05356979614224335, 'f1-score': 0.0935392473761922, 'support': 21878}, '2': {'precision': 0.3561386657352428, 'recall': 0.7250666666666666, 'f1-score': 0.4776600105404931, 'support': 22500}, 'accuracy': 0.3631100456827536, 'macro avg': {'precision': 0.36837588466172394, 'recall': 0.35974747098869747, 'f1-score': 0.3023621490210741, 'support': 66327}, 'weighted avg': {'precision': 0.36827416003536495, 'recall': 0.3631100456827536, 'f1-score': 0.3040419407757741, 'support': 66327}}
[[ 6598  1015 14336]
 [ 5548  1172 15158]
 [ 5192   994 16314]]
Evaluating performance on  val set...
86/86 - 1s - 590ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049215
{'0': {'precision': 0.37980503954386613, 'recall': 0.26597114889232354, 'f1-score': 0.3128550867358534, 'support': 7764}, '1': {'precision': 0.30098039215686273, 'recall': 0.04239745891451457, 'f1-score': 0.07432514223459628, 'support': 7241}, '2': {'precision': 0.32499838469987724, 'recall': 0.725934478279694, 'f1-score': 0.44898687851468355, 'support': 6929}, 'accuracy': 0.3374669462934257, 'macro avg': {'precision': 0.33526127213353535, 'recall': 0.3447676953621774, 'f1-score': 0.27872236916171106, 'support': 21934}, 'weighted avg': {'precision': 0.33646936966407714, 'recall': 0.3374669462934257, 'f1-score': 0.27711431246312207, 'support': 21934}}
[[2065  400 5299]
 [1786  307 5148]
 [1586  313 5030]]
training model: results/LILAK/W3/deepOF_L1/h300
Epoch 1/50
260/260 - 6s - loss: 3.3287 - accuracy300: 0.3398 - val_loss: 3.3270 - val_accuracy300: 0.3366 - 6s/epoch - 25ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3140 - accuracy300: 0.3428 - val_loss: 3.3296 - val_accuracy300: 0.3192 - 4s/epoch - 15ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3063 - accuracy300: 0.3457 - val_loss: 3.3337 - val_accuracy300: 0.3141 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.3016 - accuracy300: 0.3480 - val_loss: 3.3327 - val_accuracy300: 0.3123 - 4s/epoch - 16ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2953 - accuracy300: 0.3566 - val_loss: 3.3374 - val_accuracy300: 0.3108 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2939 - accuracy300: 0.3563 - val_loss: 3.3345 - val_accuracy300: 0.3139 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2925 - accuracy300: 0.3582 - val_loss: 3.3359 - val_accuracy300: 0.3112 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2897 - accuracy300: 0.3595 - val_loss: 3.3354 - val_accuracy300: 0.3128 - 4s/epoch - 15ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2888 - accuracy300: 0.3591 - val_loss: 3.3344 - val_accuracy300: 0.3133 - 4s/epoch - 15ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2853 - accuracy300: 0.3633 - val_loss: 3.3361 - val_accuracy300: 0.3126 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2834 - accuracy300: 0.3664 - val_loss: 3.3328 - val_accuracy300: 0.3175 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h300
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080259
{'0': {'precision': 0.30703176452707837, 'recall': 0.2305819240207735, 'f1-score': 0.2633711771416155, 'support': 52567}, '1': {'precision': 0.42461135044015735, 'recall': 0.30796190890196024, 'f1-score': 0.3569994409580876, 'support': 73613}, '2': {'precision': 0.2708643815201192, 'recall': 0.46199796644636504, 'f1-score': 0.34150695227358135, 'support': 47208}, 'accuracy': 0.3264412762128867, 'macro avg': {'precision': 0.334169165495785, 'recall': 0.33351393312303285, 'f1-score': 0.32062585679109484, 'support': 173388}, 'weighted avg': {'precision': 0.34710372014584645, 'recall': 0.3264412762128867, 'f1-score': 0.32439553324902665, 'support': 173388}}
[[12121 16058 24388]
 [16621 22670 34322]
 [10736 14662 21810]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045547
{'0': {'precision': 0.3395671222127771, 'recall': 0.23718827075911209, 'f1-score': 0.279291150133111, 'support': 21894}, '1': {'precision': 0.3328201817549784, 'recall': 0.3049829351535836, 'f1-score': 0.31829407294832823, 'support': 21975}, '2': {'precision': 0.34579409004110434, 'recall': 0.47573247840413213, 'f1-score': 0.40048730203354893, 'support': 22458}, 'accuracy': 0.3404194370316764, 'macro avg': {'precision': 0.3393937980029533, 'recall': 0.3393012281056093, 'f1-score': 0.3326908417049961, 'support': 66327}, 'weighted avg': {'precision': 0.339440193917037, 'recall': 0.3404194370316764, 'f1-score': 0.3332497553503594, 'support': 66327}}
[[ 5193  6649 10052]
 [ 5112  6702 10161]
 [ 4988  6786 10684]]
Evaluating performance on  val set...
86/86 - 1s - 726ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073594
{'0': {'precision': 0.3319510678001244, 'recall': 0.21880552138854722, 'f1-score': 0.26375617792421746, 'support': 7317}, '1': {'precision': 0.37364594153435227, 'recall': 0.3106724244293646, 'f1-score': 0.3392616545405551, 'support': 8105}, '2': {'precision': 0.30524489008870037, 'recall': 0.48617936117936117, 'f1-score': 0.375029613835584, 'support': 6512}, 'accuracy': 0.33213276192213004, 'macro avg': {'precision': 0.33694729980772564, 'recall': 0.33855243566575766, 'f1-score': 0.3260158154334522, 'support': 21934}, 'weighted avg': {'precision': 0.33942924425490345, 'recall': 0.33213276192213004, 'f1-score': 0.3246928289058093, 'support': 21934}}
[[1601 2291 3425]
 [1806 2518 3781]
 [1416 1930 3166]]
training model: results/LILAK/W3/deepOF_L1/h500
Epoch 1/50
260/260 - 6s - loss: 3.3319 - accuracy500: 0.3392 - val_loss: 3.3073 - val_accuracy500: 0.3763 - 6s/epoch - 23ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3153 - accuracy500: 0.3436 - val_loss: 3.3153 - val_accuracy500: 0.3546 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3082 - accuracy500: 0.3490 - val_loss: 3.3076 - val_accuracy500: 0.3578 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.3014 - accuracy500: 0.3525 - val_loss: 3.3056 - val_accuracy500: 0.3635 - 4s/epoch - 17ms/step
Epoch 5/50
260/260 - 4s - loss: 3.2985 - accuracy500: 0.3514 - val_loss: 3.3085 - val_accuracy500: 0.3513 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.2972 - accuracy500: 0.3548 - val_loss: 3.3068 - val_accuracy500: 0.3542 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.2951 - accuracy500: 0.3566 - val_loss: 3.3062 - val_accuracy500: 0.3597 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2941 - accuracy500: 0.3567 - val_loss: 3.3097 - val_accuracy500: 0.3463 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2915 - accuracy500: 0.3575 - val_loss: 3.3061 - val_accuracy500: 0.3555 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2893 - accuracy500: 0.3570 - val_loss: 3.3070 - val_accuracy500: 0.3486 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2889 - accuracy500: 0.3590 - val_loss: 3.3075 - val_accuracy500: 0.3505 - 4s/epoch - 15ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2860 - accuracy500: 0.3630 - val_loss: 3.3071 - val_accuracy500: 0.3504 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2850 - accuracy500: 0.3648 - val_loss: 3.3063 - val_accuracy500: 0.3508 - 4s/epoch - 15ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2849 - accuracy500: 0.3650 - val_loss: 3.3075 - val_accuracy500: 0.3471 - 4s/epoch - 15ms/step
testing model: results/LILAK/W3/deepOF_L1/h500
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976036
{'0': {'precision': 0.29215306823147513, 'recall': 0.09202092099571356, 'f1-score': 0.13995843114972262, 'support': 50858}, '1': {'precision': 0.44162730723537424, 'recall': 0.592927354306611, 'f1-score': 0.5062137760383512, 'support': 77114}, '2': {'precision': 0.2622408797087451, 'recall': 0.3108596089483882, 'f1-score': 0.2844879700157176, 'support': 45416}, 'accuracy': 0.3721191777977715, 'macro avg': {'precision': 0.3320070850585315, 'recall': 0.33193596141690423, 'f1-score': 0.31022005906793043, 'support': 173388}, 'weighted avg': {'precision': 0.35079648365006444, 'recall': 0.3721191777977715, 'f1-score': 0.3407068578163877, 'support': 173388}}
[[ 4680 30701 15477]
 [ 7150 45723 24241]
 [ 4189 27109 14118]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020507
{'0': {'precision': 0.3508485639686684, 'recall': 0.09829020755234524, 'f1-score': 0.1535604599671452, 'support': 21874}, '1': {'precision': 0.3350217629241225, 'recall': 0.6010869068822213, 'f1-score': 0.43024320083682005, 'support': 21897}, '2': {'precision': 0.35477237949502677, 'recall': 0.3289147011881539, 'f1-score': 0.3413545596760835, 'support': 22556}, 'accuracy': 0.3427111131213533, 'macro avg': {'precision': 0.34688090212927253, 'recall': 0.34276393854090687, 'f1-score': 0.3083860734933496, 'support': 66327}, 'weighted avg': {'precision': 0.3469579330120462, 'recall': 0.3427111131213533, 'f1-score': 0.30876732428873493, 'support': 66327}}
[[ 2150 13000  6724]
 [ 1966 13162  6769]
 [ 2012 13125  7419]]
Evaluating performance on  val set...
86/86 - 1s - 610ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004403
{'0': {'precision': 0.3310924369747899, 'recall': 0.08276151799467861, 'f1-score': 0.13242213757562177, 'support': 7141}, '1': {'precision': 0.40387758134006835, 'recall': 0.622794959908362, 'f1-score': 0.4899963950973324, 'support': 8730}, '2': {'precision': 0.2788993569612681, 'recall': 0.30760349661883557, 'f1-score': 0.29254901960784313, 'support': 6063}, 'accuracy': 0.35985228412510256, 'macro avg': {'precision': 0.3379564584253754, 'recall': 0.337719991507292, 'f1-score': 0.30498918409359904, 'support': 21934}, 'weighted avg': {'precision': 0.345634593726267, 'recall': 0.35985228412510256, 'f1-score': 0.3190033609697082, 'support': 21934}}
[[ 591 4340 2210]
 [ 681 5437 2612]
 [ 513 3685 1865]]
training model: results/LILAK/W3/deepOF_L1/h1000
Epoch 1/50
260/260 - 6s - loss: 3.3337 - accuracy1000: 0.3396 - val_loss: 3.3410 - val_accuracy1000: 0.3309 - 6s/epoch - 23ms/step
Epoch 2/50
260/260 - 4s - loss: 3.3234 - accuracy1000: 0.3386 - val_loss: 3.3394 - val_accuracy1000: 0.3224 - 4s/epoch - 16ms/step
Epoch 3/50
260/260 - 4s - loss: 3.3137 - accuracy1000: 0.3384 - val_loss: 3.3364 - val_accuracy1000: 0.3189 - 4s/epoch - 16ms/step
Epoch 4/50
260/260 - 4s - loss: 3.3095 - accuracy1000: 0.3417 - val_loss: 3.3290 - val_accuracy1000: 0.3204 - 4s/epoch - 16ms/step
Epoch 5/50
260/260 - 4s - loss: 3.3026 - accuracy1000: 0.3445 - val_loss: 3.3316 - val_accuracy1000: 0.3112 - 4s/epoch - 16ms/step
Epoch 6/50
260/260 - 4s - loss: 3.3039 - accuracy1000: 0.3438 - val_loss: 3.3242 - val_accuracy1000: 0.3135 - 4s/epoch - 16ms/step
Epoch 7/50
260/260 - 4s - loss: 3.3003 - accuracy1000: 0.3471 - val_loss: 3.3221 - val_accuracy1000: 0.3149 - 4s/epoch - 16ms/step
Epoch 8/50
260/260 - 4s - loss: 3.2988 - accuracy1000: 0.3463 - val_loss: 3.3214 - val_accuracy1000: 0.3161 - 4s/epoch - 16ms/step
Epoch 9/50
260/260 - 4s - loss: 3.2965 - accuracy1000: 0.3479 - val_loss: 3.3215 - val_accuracy1000: 0.3141 - 4s/epoch - 16ms/step
Epoch 10/50
260/260 - 4s - loss: 3.2934 - accuracy1000: 0.3526 - val_loss: 3.3202 - val_accuracy1000: 0.3166 - 4s/epoch - 16ms/step
Epoch 11/50
260/260 - 4s - loss: 3.2946 - accuracy1000: 0.3487 - val_loss: 3.3201 - val_accuracy1000: 0.3151 - 4s/epoch - 16ms/step
Epoch 12/50
260/260 - 4s - loss: 3.2920 - accuracy1000: 0.3504 - val_loss: 3.3227 - val_accuracy1000: 0.3105 - 4s/epoch - 16ms/step
Epoch 13/50
260/260 - 4s - loss: 3.2892 - accuracy1000: 0.3529 - val_loss: 3.3209 - val_accuracy1000: 0.3112 - 4s/epoch - 16ms/step
Epoch 14/50
260/260 - 4s - loss: 3.2886 - accuracy1000: 0.3556 - val_loss: 3.3189 - val_accuracy1000: 0.3161 - 4s/epoch - 16ms/step
Epoch 15/50
260/260 - 4s - loss: 3.2874 - accuracy1000: 0.3569 - val_loss: 3.3200 - val_accuracy1000: 0.3111 - 4s/epoch - 15ms/step
Epoch 16/50
260/260 - 4s - loss: 3.2865 - accuracy1000: 0.3558 - val_loss: 3.3219 - val_accuracy1000: 0.3118 - 4s/epoch - 16ms/step
Epoch 17/50
260/260 - 4s - loss: 3.2865 - accuracy1000: 0.3601 - val_loss: 3.3213 - val_accuracy1000: 0.3135 - 4s/epoch - 16ms/step
Epoch 18/50
260/260 - 4s - loss: 3.2847 - accuracy1000: 0.3605 - val_loss: 3.3245 - val_accuracy1000: 0.3087 - 4s/epoch - 16ms/step
Epoch 19/50
260/260 - 4s - loss: 3.2834 - accuracy1000: 0.3614 - val_loss: 3.3274 - val_accuracy1000: 0.3072 - 4s/epoch - 15ms/step
Epoch 20/50
260/260 - 4s - loss: 3.2819 - accuracy1000: 0.3621 - val_loss: 3.3270 - val_accuracy1000: 0.3084 - 4s/epoch - 16ms/step
Epoch 21/50
260/260 - 4s - loss: 3.2802 - accuracy1000: 0.3637 - val_loss: 3.3255 - val_accuracy1000: 0.3160 - 4s/epoch - 16ms/step
Epoch 22/50
260/260 - 4s - loss: 3.2798 - accuracy1000: 0.3655 - val_loss: 3.3304 - val_accuracy1000: 0.3060 - 4s/epoch - 16ms/step
Epoch 23/50
260/260 - 4s - loss: 3.2787 - accuracy1000: 0.3680 - val_loss: 3.3272 - val_accuracy1000: 0.3110 - 4s/epoch - 16ms/step
Epoch 24/50
260/260 - 4s - loss: 3.2771 - accuracy1000: 0.3655 - val_loss: 3.3312 - val_accuracy1000: 0.3074 - 4s/epoch - 16ms/step
testing model: results/LILAK/W3/deepOF_L1/h1000
Evaluating performance on  test set...
678/678 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032586
{'0': {'precision': 0.3142452100695936, 'recall': 0.1310509154752947, 'f1-score': 0.18496510569434613, 'support': 55818}, '1': {'precision': 0.4379740686769047, 'recall': 0.31798760224082034, 'f1-score': 0.36845869122743596, 'support': 73723}, '2': {'precision': 0.2509421850410006, 'recall': 0.5527630168540607, 'f1-score': 0.3451801952560332, 'support': 43847}, 'accuracy': 0.31717881283595173, 'macro avg': {'precision': 0.33438715459583296, 'recall': 0.3339338448567252, 'f1-score': 0.29953466405927176, 'support': 173388}, 'weighted avg': {'precision': 0.3508452914170806, 'recall': 0.31717881283595173, 'f1-score': 0.3035006943064028, 'support': 173388}}
[[ 7315 16483 32020]
 [ 9953 23443 40327]
 [ 6010 13600 24237]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964458
{'0': {'precision': 0.3543607587832529, 'recall': 0.14744757367708186, 'f1-score': 0.20824538258575198, 'support': 21411}, '1': {'precision': 0.3595061975209916, 'recall': 0.32400900900900903, 'f1-score': 0.34083586050037906, 'support': 22200}, '2': {'precision': 0.3566426089280941, 'recall': 0.5873393203028702, 'f1-score': 0.443801350497289, 'support': 22716}, 'accuracy': 0.3571999336620079, 'macro avg': {'precision': 0.3568365217441129, 'recall': 0.352931967662987, 'f1-score': 0.33096086452780665, 'support': 66327}, 'weighted avg': {'precision': 0.35686446387873455, 'recall': 0.3571999336620079, 'f1-score': 0.3332984978598213, 'support': 66327}}
[[ 3157  6376 11878]
 [ 2817  7193 12190]
 [ 2935  6439 13342]]
Evaluating performance on  val set...
86/86 - 1s - 605ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042775
{'0': {'precision': 0.3442796610169492, 'recall': 0.1302431204915843, 'f1-score': 0.18899011436324872, 'support': 7486}, '1': {'precision': 0.3698609878734102, 'recall': 0.29805744249791444, 'f1-score': 0.33009965023427706, 'support': 8391}, '2': {'precision': 0.273419773095624, 'recall': 0.5570414396565957, 'f1-score': 0.3667989346089036, 'support': 6057}, 'accuracy': 0.31230053797756907, 'macro avg': {'precision': 0.3291868073286612, 'recall': 0.3284473342153648, 'f1-score': 0.2952962330688098, 'support': 21934}, 'weighted avg': {'precision': 0.3344982519038416, 'recall': 0.31230053797756907, 'f1-score': 0.29207382639578866, 'support': 21934}}
[[ 975 2375 4136]
 [1060 2501 4830]
 [ 797 1886 3374]]
training model: results/LILAK/W3/deepLOB_L2/h10
Epoch 1/50
260/260 - 14s - loss: 3.3591 - accuracy10: 0.3466 - val_loss: 3.3708 - val_accuracy10: 0.3530 - 14s/epoch - 53ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3136 - accuracy10: 0.3488 - val_loss: 3.3242 - val_accuracy10: 0.3480 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2929 - accuracy10: 0.3628 - val_loss: 3.3111 - val_accuracy10: 0.3705 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2755 - accuracy10: 0.3702 - val_loss: 3.3052 - val_accuracy10: 0.3542 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2650 - accuracy10: 0.3767 - val_loss: 3.2919 - val_accuracy10: 0.3583 - 11s/epoch - 43ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2439 - accuracy10: 0.3860 - val_loss: 3.2871 - val_accuracy10: 0.3578 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2271 - accuracy10: 0.3928 - val_loss: 3.2815 - val_accuracy10: 0.3578 - 11s/epoch - 44ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2088 - accuracy10: 0.4044 - val_loss: 3.2590 - val_accuracy10: 0.3707 - 11s/epoch - 43ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2016 - accuracy10: 0.4108 - val_loss: 3.2622 - val_accuracy10: 0.3646 - 11s/epoch - 43ms/step
Epoch 10/50
260/260 - 11s - loss: 3.1877 - accuracy10: 0.4200 - val_loss: 3.2696 - val_accuracy10: 0.3673 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.1756 - accuracy10: 0.4274 - val_loss: 3.2627 - val_accuracy10: 0.3769 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.1620 - accuracy10: 0.4351 - val_loss: 3.2667 - val_accuracy10: 0.3750 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1542 - accuracy10: 0.4395 - val_loss: 3.2541 - val_accuracy10: 0.3908 - 11s/epoch - 43ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1396 - accuracy10: 0.4465 - val_loss: 3.2464 - val_accuracy10: 0.3936 - 11s/epoch - 43ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1291 - accuracy10: 0.4516 - val_loss: 3.2508 - val_accuracy10: 0.3943 - 11s/epoch - 43ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1239 - accuracy10: 0.4542 - val_loss: 3.2703 - val_accuracy10: 0.3840 - 11s/epoch - 42ms/step
Epoch 17/50
260/260 - 11s - loss: 3.1134 - accuracy10: 0.4583 - val_loss: 3.2706 - val_accuracy10: 0.3935 - 11s/epoch - 42ms/step
Epoch 18/50
260/260 - 11s - loss: 3.0998 - accuracy10: 0.4636 - val_loss: 3.2719 - val_accuracy10: 0.3896 - 11s/epoch - 43ms/step
Epoch 19/50
260/260 - 11s - loss: 3.0951 - accuracy10: 0.4655 - val_loss: 3.2794 - val_accuracy10: 0.3893 - 11s/epoch - 43ms/step
Epoch 20/50
260/260 - 11s - loss: 3.0848 - accuracy10: 0.4679 - val_loss: 3.2865 - val_accuracy10: 0.3874 - 11s/epoch - 43ms/step
Epoch 21/50
260/260 - 11s - loss: 3.0780 - accuracy10: 0.4718 - val_loss: 3.2941 - val_accuracy10: 0.3774 - 11s/epoch - 43ms/step
Epoch 22/50
260/260 - 11s - loss: 3.0681 - accuracy10: 0.4747 - val_loss: 3.3026 - val_accuracy10: 0.3776 - 11s/epoch - 43ms/step
Epoch 23/50
260/260 - 11s - loss: 3.0548 - accuracy10: 0.4771 - val_loss: 3.2963 - val_accuracy10: 0.3816 - 11s/epoch - 42ms/step
Epoch 24/50
260/260 - 11s - loss: 3.0449 - accuracy10: 0.4830 - val_loss: 3.2831 - val_accuracy10: 0.3855 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h10
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0956049
{'0': {'precision': 0.3293180780490425, 'recall': 0.5033869775843666, 'f1-score': 0.39815882190579793, 'support': 48716}, '1': {'precision': 0.4744844376551461, 'recall': 0.2643730134454005, 'f1-score': 0.33955367284715043, 'support': 75193}, '2': {'precision': 0.3698930387515343, 'recall': 0.42630802497827536, 'f1-score': 0.39610188427703663, 'support': 49483}, 'accuracy': 0.37773945741441356, 'macro avg': {'precision': 0.3912318514852409, 'recall': 0.39802267200268077, 'f1-score': 0.3779381263433283, 'support': 173392}, 'weighted avg': {'precision': 0.4038501490690615, 'recall': 0.37773945741441356, 'f1-score': 0.3721571585196505, 'support': 173392}}
[[24523 11339 12854]
 [32233 19879 23081]
 [17710 10678 21095]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0647297
{'0': {'precision': 0.38474504846186264, 'recall': 0.43251921254868936, 'f1-score': 0.40723578243092556, 'support': 18998}, '1': {'precision': 0.5235077146864772, 'recall': 0.34921680066537286, 'f1-score': 0.4189585282195198, 'support': 28856}, '2': {'precision': 0.36418769194883954, 'recall': 0.507063599458728, 'f1-score': 0.4239105841893298, 'support': 18475}, 'accuracy': 0.4170423193474951, 'macro avg': {'precision': 0.42414681836572643, 'recall': 0.4295998708909301, 'f1-score': 0.41670163161325835, 'support': 66329}, 'weighted avg': {'precision': 0.43938688438580803, 'recall': 0.4170423193474951, 'f1-score': 0.41698021570991656, 'support': 66329}}
[[ 8217  4719  6062]
 [ 8486 10077 10293]
 [ 4654  4453  9368]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807959
{'0': {'precision': 0.40241762526808345, 'recall': 0.3225, 'f1-score': 0.35805360395524327, 'support': 6400}, '1': {'precision': 0.4802101576182137, 'recall': 0.2947119518486672, 'f1-score': 0.36525909151458635, 'support': 9304}, '2': {'precision': 0.34718341595313207, 'recall': 0.618298555377207, 'f1-score': 0.44467532467532467, 'support': 6230}, 'accuracy': 0.3947296434758822, 'macro avg': {'precision': 0.4099370662798097, 'recall': 0.4118368357419581, 'f1-score': 0.38932934004838476, 'support': 21934}, 'weighted avg': {'precision': 0.41972739990807, 'recall': 0.3947296434758822, 'f1-score': 0.3857135463432361, 'support': 21934}}
[[2064 1616 2720]
 [2039 2742 4523]
 [1026 1352 3852]]
training model: results/LILAK/W3/deepLOB_L2/h20
Epoch 1/50
260/260 - 13s - loss: 3.3628 - accuracy20: 0.3401 - val_loss: 3.3761 - val_accuracy20: 0.3292 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3169 - accuracy20: 0.3523 - val_loss: 3.3333 - val_accuracy20: 0.3415 - 11s/epoch - 42ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2982 - accuracy20: 0.3583 - val_loss: 3.3186 - val_accuracy20: 0.3443 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2791 - accuracy20: 0.3738 - val_loss: 3.3045 - val_accuracy20: 0.3623 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2629 - accuracy20: 0.3844 - val_loss: 3.2956 - val_accuracy20: 0.3678 - 11s/epoch - 43ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2506 - accuracy20: 0.3963 - val_loss: 3.2892 - val_accuracy20: 0.3710 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2371 - accuracy20: 0.4056 - val_loss: 3.2892 - val_accuracy20: 0.3718 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2230 - accuracy20: 0.4143 - val_loss: 3.2844 - val_accuracy20: 0.3761 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2126 - accuracy20: 0.4184 - val_loss: 3.2896 - val_accuracy20: 0.3753 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.1964 - accuracy20: 0.4287 - val_loss: 3.2915 - val_accuracy20: 0.3745 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.1849 - accuracy20: 0.4322 - val_loss: 3.3057 - val_accuracy20: 0.3757 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.1749 - accuracy20: 0.4373 - val_loss: 3.3085 - val_accuracy20: 0.3749 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1629 - accuracy20: 0.4420 - val_loss: 3.3470 - val_accuracy20: 0.3679 - 11s/epoch - 42ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1524 - accuracy20: 0.4470 - val_loss: 3.3476 - val_accuracy20: 0.3673 - 11s/epoch - 42ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1387 - accuracy20: 0.4522 - val_loss: 3.3670 - val_accuracy20: 0.3661 - 11s/epoch - 43ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1262 - accuracy20: 0.4585 - val_loss: 3.3429 - val_accuracy20: 0.3754 - 11s/epoch - 43ms/step
Epoch 17/50
260/260 - 11s - loss: 3.1201 - accuracy20: 0.4597 - val_loss: 3.3511 - val_accuracy20: 0.3727 - 11s/epoch - 43ms/step
Epoch 18/50
260/260 - 11s - loss: 3.1100 - accuracy20: 0.4639 - val_loss: 3.3903 - val_accuracy20: 0.3706 - 11s/epoch - 43ms/step
testing model: results/LILAK/W3/deepLOB_L2/h20
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1098677
{'0': {'precision': 0.368894188005072, 'recall': 0.3302553328476305, 'f1-score': 0.3485070623994278, 'support': 59021}, '1': {'precision': 0.3344004580828193, 'recall': 0.46352550689082905, 'f1-score': 0.3885150969926972, 'support': 55436}, '2': {'precision': 0.3883004278099334, 'recall': 0.28799524900313905, 'f1-score': 0.33070942852132573, 'support': 58935}, 'accuracy': 0.35849981544707943, 'macro avg': {'precision': 0.3638650246326082, 'recall': 0.3605920295805329, 'f1-score': 0.3559105293044836, 'support': 173392}, 'weighted avg': {'precision': 0.3644621053883971, 'recall': 0.35849981544707943, 'f1-score': 0.3552489066200755, 'support': 173392}}
[[19492 25659 13870]
 [16872 25696 12868]
 [16475 25487 16973]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1011754
{'0': {'precision': 0.40584972930146573, 'recall': 0.27153458786111845, 'f1-score': 0.3253758204531018, 'support': 22638}, '1': {'precision': 0.3518177916743302, 'recall': 0.5362332383310751, 'f1-score': 0.42487737158722816, 'support': 21403}, '2': {'precision': 0.4034804159258661, 'recall': 0.33601040918880115, 'f1-score': 0.36666748268011456, 'support': 22288}, 'accuracy': 0.3786126731897059, 'macro avg': {'precision': 0.387049312300554, 'recall': 0.3812594117936649, 'f1-score': 0.3723068915734815, 'support': 66329}, 'weighted avg': {'precision': 0.38761859634983153, 'recall': 0.3786126731897059, 'f1-score': 0.37135782329709716, 'support': 66329}}
[[ 6147 10895  5596]
 [ 4450 11477  5476]
 [ 4549 10250  7489]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0971733
{'0': {'precision': 0.40792813903534464, 'recall': 0.2724664145037172, 'f1-score': 0.326712543009071, 'support': 7667}, '1': {'precision': 0.3413810357768326, 'recall': 0.3992100643651258, 'f1-score': 0.36803776129467297, 'support': 6836}, '2': {'precision': 0.3914275995010772, 'recall': 0.4645404387027318, 'f1-score': 0.4248615384615384, 'support': 7431}, 'accuracy': 0.3770402115437221, 'macro avg': {'precision': 0.38024559143775144, 'recall': 0.3787389725238583, 'f1-score': 0.37320394758842745, 'support': 21934}, 'weighted avg': {'precision': 0.3815977156217252, 'recall': 0.3770402115437221, 'f1-score': 0.372843863215493, 'support': 21934}}
[[2089 2776 2802]
 [1542 2729 2565]
 [1490 2489 3452]]
training model: results/LILAK/W3/deepLOB_L2/h30
Epoch 1/50
260/260 - 13s - loss: 3.3649 - accuracy30: 0.3383 - val_loss: 3.4025 - val_accuracy30: 0.3356 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3173 - accuracy30: 0.3490 - val_loss: 3.3539 - val_accuracy30: 0.3323 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2964 - accuracy30: 0.3593 - val_loss: 3.3182 - val_accuracy30: 0.3414 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2804 - accuracy30: 0.3703 - val_loss: 3.3083 - val_accuracy30: 0.3542 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2687 - accuracy30: 0.3815 - val_loss: 3.3177 - val_accuracy30: 0.3541 - 11s/epoch - 43ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2552 - accuracy30: 0.3904 - val_loss: 3.2956 - val_accuracy30: 0.3623 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2443 - accuracy30: 0.3972 - val_loss: 3.3068 - val_accuracy30: 0.3641 - 11s/epoch - 43ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2358 - accuracy30: 0.4046 - val_loss: 3.3095 - val_accuracy30: 0.3670 - 11s/epoch - 43ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2264 - accuracy30: 0.4099 - val_loss: 3.3172 - val_accuracy30: 0.3651 - 11s/epoch - 43ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2146 - accuracy30: 0.4160 - val_loss: 3.3125 - val_accuracy30: 0.3725 - 11s/epoch - 43ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2058 - accuracy30: 0.4230 - val_loss: 3.3191 - val_accuracy30: 0.3687 - 11s/epoch - 43ms/step
Epoch 12/50
260/260 - 11s - loss: 3.1980 - accuracy30: 0.4268 - val_loss: 3.3159 - val_accuracy30: 0.3712 - 11s/epoch - 44ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1859 - accuracy30: 0.4350 - val_loss: 3.3109 - val_accuracy30: 0.3717 - 11s/epoch - 44ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1773 - accuracy30: 0.4363 - val_loss: 3.3168 - val_accuracy30: 0.3697 - 11s/epoch - 44ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1681 - accuracy30: 0.4393 - val_loss: 3.3468 - val_accuracy30: 0.3667 - 11s/epoch - 43ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1642 - accuracy30: 0.4431 - val_loss: 3.3449 - val_accuracy30: 0.3684 - 11s/epoch - 43ms/step
testing model: results/LILAK/W3/deepLOB_L2/h30
Evaluating performance on  test set...
678/678 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1065211
{'0': {'precision': 0.3738858748304592, 'recall': 0.26340306453264173, 'f1-score': 0.3090676116683685, 'support': 58606}, '1': {'precision': 0.32836495960198187, 'recall': 0.281073471183458, 'f1-score': 0.3028843418732103, 'support': 56825}, '2': {'precision': 0.3592490085427075, 'recall': 0.5173133658839565, 'f1-score': 0.42402986763208506, 'support': 57961}, 'accuracy': 0.3540705453538802, 'macro avg': {'precision': 0.3538332809917162, 'recall': 0.3539299672000187, 'f1-score': 0.3453272737245546, 'support': 173392}, 'weighted avg': {'precision': 0.3540747335161967, 'recall': 0.3540705453538802, 'f1-score': 0.34547046192560704, 'support': 173392}}
[[15437 17033 26136]
 [13510 15972 27343]
 [12341 15636 29984]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.09716
{'0': {'precision': 0.38705245292168433, 'recall': 0.21422500559159025, 'f1-score': 0.2758005067956692, 'support': 22355}, '1': {'precision': 0.3666168585743166, 'recall': 0.3811046644433277, 'f1-score': 0.37372040409470686, 'support': 21889}, '2': {'precision': 0.3722197295045189, 'recall': 0.5258772922798279, 'f1-score': 0.43590369133184453, 'support': 22085}, 'accuracy': 0.37306457205747107, 'macro avg': {'precision': 0.3752963470001733, 'recall': 0.3737356541049153, 'f1-score': 0.3618082007407402, 'support': 66329}, 'weighted avg': {'precision': 0.37536984921383965, 'recall': 0.37306457205747107, 'f1-score': 0.36142289613457174, 'support': 66329}}
[[ 4789  7646  9920]
 [ 3879  8342  9668]
 [ 3705  6766 11614]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.099589
{'0': {'precision': 0.3932522123893805, 'recall': 0.18777234913508517, 'f1-score': 0.2541782107426937, 'support': 7573}, '1': {'precision': 0.341161536020311, 'recall': 0.3065297975477616, 'f1-score': 0.3229197957344548, 'support': 7014}, '2': {'precision': 0.3665945406125166, 'recall': 0.5995644480740439, 'f1-score': 0.45499147859319317, 'support': 7347}, 'accuracy': 0.36368195495577643, 'macro avg': {'precision': 0.3670027630074027, 'recall': 0.36462219825229686, 'f1-score': 0.3440298283567806, 'support': 21934}, 'weighted avg': {'precision': 0.3676655470024346, 'recall': 0.36368195495577643, 'f1-score': 0.34342452040029525, 'support': 21934}}
[[1422 2312 3839]
 [1092 2150 3772]
 [1102 1840 4405]]
training model: results/LILAK/W3/deepLOB_L2/h50
Epoch 1/50
260/260 - 13s - loss: 3.3682 - accuracy50: 0.3359 - val_loss: 3.3638 - val_accuracy50: 0.3375 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3122 - accuracy50: 0.3502 - val_loss: 3.3240 - val_accuracy50: 0.3449 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3048 - accuracy50: 0.3529 - val_loss: 3.3409 - val_accuracy50: 0.3357 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2932 - accuracy50: 0.3605 - val_loss: 3.3542 - val_accuracy50: 0.3388 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2873 - accuracy50: 0.3642 - val_loss: 3.3361 - val_accuracy50: 0.3399 - 11s/epoch - 43ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2768 - accuracy50: 0.3735 - val_loss: 3.3302 - val_accuracy50: 0.3418 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2678 - accuracy50: 0.3816 - val_loss: 3.3123 - val_accuracy50: 0.3547 - 11s/epoch - 43ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2586 - accuracy50: 0.3870 - val_loss: 3.3189 - val_accuracy50: 0.3544 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2474 - accuracy50: 0.3952 - val_loss: 3.3205 - val_accuracy50: 0.3526 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2376 - accuracy50: 0.4033 - val_loss: 3.3344 - val_accuracy50: 0.3542 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2274 - accuracy50: 0.4084 - val_loss: 3.3458 - val_accuracy50: 0.3526 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2199 - accuracy50: 0.4135 - val_loss: 3.3406 - val_accuracy50: 0.3542 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.2109 - accuracy50: 0.4213 - val_loss: 3.3511 - val_accuracy50: 0.3554 - 11s/epoch - 42ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1996 - accuracy50: 0.4245 - val_loss: 3.3641 - val_accuracy50: 0.3571 - 11s/epoch - 42ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1900 - accuracy50: 0.4281 - val_loss: 3.3738 - val_accuracy50: 0.3620 - 11s/epoch - 42ms/step
Epoch 16/50
260/260 - 11s - loss: 3.1846 - accuracy50: 0.4313 - val_loss: 3.3700 - val_accuracy50: 0.3627 - 11s/epoch - 43ms/step
Epoch 17/50
260/260 - 11s - loss: 3.1771 - accuracy50: 0.4368 - val_loss: 3.3658 - val_accuracy50: 0.3581 - 11s/epoch - 43ms/step
testing model: results/LILAK/W3/deepLOB_L2/h50
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.112172
{'0': {'precision': 0.3425101214574899, 'recall': 0.22966984849811717, 'f1-score': 0.27496330467603275, 'support': 57095}, '1': {'precision': 0.35616099306983473, 'recall': 0.31400228279844233, 'f1-score': 0.33375557537912576, 'support': 59576}, '2': {'precision': 0.3441870602908589, 'recall': 0.501119514818145, 'f1-score': 0.4080859128237524, 'support': 56721}, 'accuracy': 0.3474439420503829, 'macro avg': {'precision': 0.3476193916060611, 'recall': 0.34826388203823483, 'f1-score': 0.338934930959637, 'support': 173392}, 'weighted avg': {'precision': 0.3477490135329292, 'recall': 0.3474439420503829, 'f1-score': 0.3387116654778822, 'support': 173392}}
[[13113 17187 26795]
 [13505 18707 27364]
 [11667 16630 28424]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052505
{'0': {'precision': 0.36629116739613976, 'recall': 0.22841163310961968, 'f1-score': 0.28136798302422356, 'support': 22350}, '1': {'precision': 0.34683579463913705, 'recall': 0.34714113613196185, 'f1-score': 0.34698839821225946, 'support': 21582}, '2': {'precision': 0.36367769802864475, 'recall': 0.4999776755815511, 'f1-score': 0.4210724223509062, 'support': 22397}, 'accuracy': 0.35874202837371283, 'macro avg': {'precision': 0.35893488668797385, 'recall': 0.35851014827437755, 'f1-score': 0.34980960119579635, 'support': 66329}, 'weighted avg': {'precision': 0.35907833849376797, 'recall': 0.35874202837371283, 'f1-score': 0.3498927629574036, 'support': 66329}}
[[ 5105  7144 10101]
 [ 4598  7492  9492]
 [ 4234  6965 11198]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1050816
{'0': {'precision': 0.35842771485676217, 'recall': 0.21557366101242154, 'f1-score': 0.2692243536280233, 'support': 7487}, '1': {'precision': 0.34636621399791073, 'recall': 0.3228094575799722, 'f1-score': 0.3341732056727377, 'support': 7190}, '2': {'precision': 0.3562907735321528, 'recall': 0.526801708695053, 'f1-score': 0.4250847834547173, 'support': 7257}, 'accuracy': 0.35369745600437674, 'macro avg': {'precision': 0.35369490079560856, 'recall': 0.35506160909581563, 'f1-score': 0.34282744758515943, 'support': 21934}, 'weighted avg': {'precision': 0.35376691544179767, 'recall': 0.35369745600437674, 'f1-score': 0.342082080693484, 'support': 21934}}
[[1614 2315 3558]
 [1520 2321 3349]
 [1369 2065 3823]]
training model: results/LILAK/W3/deepLOB_L2/h100
Epoch 1/50
260/260 - 14s - loss: 3.3654 - accuracy100: 0.3375 - val_loss: 3.3852 - val_accuracy100: 0.3362 - 14s/epoch - 52ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3175 - accuracy100: 0.3509 - val_loss: 3.3578 - val_accuracy100: 0.3472 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3038 - accuracy100: 0.3571 - val_loss: 3.3356 - val_accuracy100: 0.3508 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2908 - accuracy100: 0.3608 - val_loss: 3.3367 - val_accuracy100: 0.3455 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2809 - accuracy100: 0.3695 - val_loss: 3.3331 - val_accuracy100: 0.3553 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2697 - accuracy100: 0.3769 - val_loss: 3.3431 - val_accuracy100: 0.3559 - 11s/epoch - 42ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2565 - accuracy100: 0.3889 - val_loss: 3.3501 - val_accuracy100: 0.3524 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2536 - accuracy100: 0.3896 - val_loss: 3.3583 - val_accuracy100: 0.3480 - 11s/epoch - 43ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2413 - accuracy100: 0.3963 - val_loss: 3.3657 - val_accuracy100: 0.3483 - 11s/epoch - 43ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2319 - accuracy100: 0.4026 - val_loss: 3.3754 - val_accuracy100: 0.3557 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2223 - accuracy100: 0.4102 - val_loss: 3.3880 - val_accuracy100: 0.3499 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.2111 - accuracy100: 0.4145 - val_loss: 3.4020 - val_accuracy100: 0.3492 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1979 - accuracy100: 0.4225 - val_loss: 3.3917 - val_accuracy100: 0.3513 - 11s/epoch - 42ms/step
Epoch 14/50
260/260 - 11s - loss: 3.1917 - accuracy100: 0.4264 - val_loss: 3.4051 - val_accuracy100: 0.3527 - 11s/epoch - 42ms/step
Epoch 15/50
260/260 - 11s - loss: 3.1784 - accuracy100: 0.4309 - val_loss: 3.4242 - val_accuracy100: 0.3499 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h100
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1380193
{'0': {'precision': 0.3799011532125206, 'recall': 0.07012209028295145, 'f1-score': 0.11839149799129776, 'support': 65771}, '1': {'precision': 0.2501932863781956, 'recall': 0.660935921894288, 'f1-score': 0.3629819544423627, 'support': 44555}, '2': {'precision': 0.37457234047438637, 'recall': 0.25866552500554973, 'f1-score': 0.30601123648198697, 'support': 63066}, 'accuracy': 0.2905151333394851, 'macro avg': {'precision': 0.3348889266883675, 'recall': 0.3299078457275964, 'f1-score': 0.2624615629718825, 'support': 173392}, 'weighted avg': {'precision': 0.3446330848417392, 'recall': 0.2905151333394851, 'f1-score': 0.24948263376936713, 'support': 173392}}
[[ 4612 45898 15261]
 [ 3130 29448 11977]
 [ 4398 42355 16313]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1189023
{'0': {'precision': 0.3638568829593693, 'recall': 0.054694621695533276, 'f1-score': 0.09509469847056026, 'support': 21940}, '1': {'precision': 0.3410730961881314, 'recall': 0.7332542434750867, 'f1-score': 0.46558117974272795, 'support': 21916}, '2': {'precision': 0.3542569902607603, 'recall': 0.2508788323766297, 'f1-score': 0.2937376263415651, 'support': 22473}, 'accuracy': 0.3453692954816144, 'macro avg': {'precision': 0.35306232313608704, 'recall': 0.3462758991824166, 'f1-score': 0.28480450151828446, 'support': 66329}, 'weighted avg': {'precision': 0.35307626121783403, 'recall': 0.3453692954816144, 'f1-score': 0.2848108745263717, 'support': 66329}}
[[ 1200 15315  5425]
 [  994 16070  4852]
 [ 1104 15731  5638]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1123669
{'0': {'precision': 0.33033932135728544, 'recall': 0.04460315321385258, 'f1-score': 0.07859432506232933, 'support': 7421}, '1': {'precision': 0.3583644584234323, 'recall': 0.7292972396319509, 'f1-score': 0.48057996485061516, 'support': 7499}, '2': {'precision': 0.33591959090107565, 'recall': 0.27159965782720275, 'f1-score': 0.3003547497043753, 'support': 7014}, 'accuracy': 0.3512811160754992, 'macro avg': {'precision': 0.3415411235605978, 'recall': 0.34850001689100213, 'f1-score': 0.28650967987243997, 'support': 21934}, 'weighted avg': {'precision': 0.341705260695262, 'recall': 0.3512811160754992, 'f1-score': 0.28694291315440856, 'support': 21934}}
[[ 331 5007 2083]
 [ 347 5469 1683]
 [ 324 4785 1905]]
training model: results/LILAK/W3/deepLOB_L2/h200
Epoch 1/50
260/260 - 13s - loss: 3.3534 - accuracy200: 0.3491 - val_loss: 3.3873 - val_accuracy200: 0.3331 - 13s/epoch - 52ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3171 - accuracy200: 0.3542 - val_loss: 3.3575 - val_accuracy200: 0.3341 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3027 - accuracy200: 0.3606 - val_loss: 3.3494 - val_accuracy200: 0.3441 - 11s/epoch - 43ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2862 - accuracy200: 0.3719 - val_loss: 3.3512 - val_accuracy200: 0.3409 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2731 - accuracy200: 0.3788 - val_loss: 3.3683 - val_accuracy200: 0.3426 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2682 - accuracy200: 0.3816 - val_loss: 3.3708 - val_accuracy200: 0.3367 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2516 - accuracy200: 0.3908 - val_loss: 3.3856 - val_accuracy200: 0.3473 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2435 - accuracy200: 0.3969 - val_loss: 3.3909 - val_accuracy200: 0.3412 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2304 - accuracy200: 0.4071 - val_loss: 3.4306 - val_accuracy200: 0.3503 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.2211 - accuracy200: 0.4115 - val_loss: 3.4454 - val_accuracy200: 0.3403 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.2104 - accuracy200: 0.4169 - val_loss: 3.4675 - val_accuracy200: 0.3382 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.1987 - accuracy200: 0.4246 - val_loss: 3.4705 - val_accuracy200: 0.3423 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1901 - accuracy200: 0.4298 - val_loss: 3.4822 - val_accuracy200: 0.3418 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h200
Evaluating performance on  test set...
678/678 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1320813
{'0': {'precision': 0.34290466602468705, 'recall': 0.2081517695823148, 'f1-score': 0.2590522800171952, 'support': 56454}, '1': {'precision': 0.377193698473594, 'recall': 0.14476590278974327, 'f1-score': 0.2092299333280509, 'support': 63841}, '2': {'precision': 0.30463876602018825, 'recall': 0.6576266079062847, 'f1-score': 0.4163894155666058, 'support': 53097}, 'accuracy': 0.3224543231521639, 'macro avg': {'precision': 0.3415790435061565, 'recall': 0.3368480934261142, 'f1-score': 0.2948905429706173, 'support': 173392}, 'weighted avg': {'precision': 0.3438115223273527, 'recall': 0.3224543231521639, 'f1-score': 0.28888884370690054, 'support': 173392}}
[[11751  7432 37271]
 [12167  9242 42432]
 [10351  7828 34918]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165537
{'0': {'precision': 0.34374302922150346, 'recall': 0.1405124464301997, 'f1-score': 0.1994822006472492, 'support': 21934}, '1': {'precision': 0.36517520215633426, 'recall': 0.3090328467153285, 'f1-score': 0.3347664936990363, 'support': 21920}, '2': {'precision': 0.3484914848117899, 'recall': 0.6018242491657397, 'f1-score': 0.44139146325544965, 'support': 22475}, 'accuracy': 0.35251549096172113, 'macro avg': {'precision': 0.35246990539654255, 'recall': 0.35045651410375595, 'f1-score': 0.3252133858672451, 'support': 66329}, 'weighted avg': {'precision': 0.35243477446299937, 'recall': 0.35251549096172113, 'f1-score': 0.3261589541157845, 'support': 66329}}
[[ 3082  5824 13028]
 [ 2887  6774 12259]
 [ 2997  5952 13526]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157843
{'0': {'precision': 0.3535952557449963, 'recall': 0.12287480680061824, 'f1-score': 0.18237430701586693, 'support': 7764}, '1': {'precision': 0.3993339388434756, 'recall': 0.36441497444398396, 'f1-score': 0.3810762007945107, 'support': 7239}, '2': {'precision': 0.3231195566112431, 'recall': 0.5888039243976338, 'f1-score': 0.41725883134809055, 'support': 6931}, 'accuracy': 0.34982219385429014, 'macro avg': {'precision': 0.3586829170665717, 'recall': 0.3586979018807453, 'f1-score': 0.32690311305282277, 'support': 21934}, 'weighted avg': {'precision': 0.3590605268425548, 'recall': 0.34982219385429014, 'f1-score': 0.32217496568324383, 'support': 21934}}
[[ 954 2036 4774]
 [ 826 2638 3775]
 [ 918 1932 4081]]
training model: results/LILAK/W3/deepLOB_L2/h300
Epoch 1/50
260/260 - 13s - loss: 3.3535 - accuracy300: 0.3503 - val_loss: 3.3790 - val_accuracy300: 0.3411 - 13s/epoch - 50ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3201 - accuracy300: 0.3530 - val_loss: 3.3603 - val_accuracy300: 0.3478 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3007 - accuracy300: 0.3611 - val_loss: 3.3381 - val_accuracy300: 0.3533 - 11s/epoch - 44ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2783 - accuracy300: 0.3738 - val_loss: 3.3696 - val_accuracy300: 0.3480 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2633 - accuracy300: 0.3842 - val_loss: 3.3683 - val_accuracy300: 0.3529 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2497 - accuracy300: 0.3914 - val_loss: 3.3831 - val_accuracy300: 0.3490 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2323 - accuracy300: 0.4027 - val_loss: 3.3944 - val_accuracy300: 0.3561 - 11s/epoch - 43ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2152 - accuracy300: 0.4108 - val_loss: 3.4322 - val_accuracy300: 0.3489 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.2066 - accuracy300: 0.4178 - val_loss: 3.4780 - val_accuracy300: 0.3480 - 11s/epoch - 43ms/step
Epoch 10/50
260/260 - 11s - loss: 3.1932 - accuracy300: 0.4228 - val_loss: 3.4956 - val_accuracy300: 0.3463 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.1811 - accuracy300: 0.4311 - val_loss: 3.5278 - val_accuracy300: 0.3401 - 11s/epoch - 42ms/step
Epoch 12/50
260/260 - 11s - loss: 3.1744 - accuracy300: 0.4350 - val_loss: 3.5779 - val_accuracy300: 0.3368 - 11s/epoch - 42ms/step
Epoch 13/50
260/260 - 11s - loss: 3.1517 - accuracy300: 0.4466 - val_loss: 3.6203 - val_accuracy300: 0.3373 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h300
Evaluating performance on  test set...
678/678 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1397709
{'0': {'precision': 0.2909312233718807, 'recall': 0.09092984325064678, 'f1-score': 0.13855474071712223, 'support': 52568}, '1': {'precision': 0.40324113175675674, 'recall': 0.3113130654495069, 'f1-score': 0.3513637827146865, 'support': 73614}, '2': {'precision': 0.2707080794966544, 'recall': 0.5741580173692015, 'f1-score': 0.36793810234831004, 'support': 47210}, 'accuracy': 0.3160641782781213, 'macro avg': {'precision': 0.3216268115417639, 'recall': 0.3254669753564517, 'f1-score': 0.28595220859337295, 'support': 173392}, 'weighted avg': {'precision': 0.3331064504498014, 'recall': 0.3160641782781213, 'f1-score': 0.2913582917472567, 'support': 173392}}
[[ 4780 18305 29483]
 [ 7156 22917 43541]
 [ 4494 15610 27106]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.120097
{'0': {'precision': 0.3364969801553063, 'recall': 0.07124263597753117, 'f1-score': 0.11758941695247427, 'support': 21897}, '1': {'precision': 0.36649233037312645, 'recall': 0.4743537322247967, 'f1-score': 0.41350495049504954, 'support': 22011}, '2': {'precision': 0.35089145886037826, 'recall': 0.5196467597341777, 'f1-score': 0.4189123595505618, 'support': 22421}, 'accuracy': 0.3565861086402629, 'macro avg': {'precision': 0.35129358979627034, 'recall': 0.35508104264550183, 'f1-score': 0.3166689089993619, 'support': 66329}, 'weighted avg': {'precision': 0.35131653511152244, 'recall': 0.3565861086402629, 'f1-score': 0.3176430662581678, 'support': 66329}}
[[ 1560  8888 11449]
 [ 1466 10441 10104]
 [ 1610  9160 11651]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101371
{'0': {'precision': 0.3724364232977851, 'recall': 0.06195414847161572, 'f1-score': 0.10623610623610624, 'support': 7328}, '1': {'precision': 0.40948905109489053, 'recall': 0.48583446740071756, 'f1-score': 0.44440672211848586, 'support': 8083}, '2': {'precision': 0.30552808988764046, 'recall': 0.521079258010118, 'f1-score': 0.3851994560290118, 'support': 6523}, 'accuracy': 0.354700465031458, 'macro avg': {'precision': 0.362484521426772, 'recall': 0.35628929129415043, 'f1-score': 0.31194742812786797, 'support': 21934}, 'weighted avg': {'precision': 0.3661928439985068, 'recall': 0.354700465031458, 'f1-score': 0.3138184450195656, 'support': 21934}}
[[ 454 2876 3998]
 [ 428 3927 3728]
 [ 337 2787 3399]]
training model: results/LILAK/W3/deepLOB_L2/h500
Epoch 1/50
260/260 - 13s - loss: 3.3641 - accuracy500: 0.3442 - val_loss: 3.3934 - val_accuracy500: 0.3521 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3147 - accuracy500: 0.3549 - val_loss: 3.4684 - val_accuracy500: 0.3228 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.2905 - accuracy500: 0.3695 - val_loss: 3.3974 - val_accuracy500: 0.3347 - 11s/epoch - 42ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2662 - accuracy500: 0.3860 - val_loss: 3.4377 - val_accuracy500: 0.3226 - 11s/epoch - 42ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2521 - accuracy500: 0.3915 - val_loss: 3.4442 - val_accuracy500: 0.3161 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2330 - accuracy500: 0.4028 - val_loss: 3.4279 - val_accuracy500: 0.3262 - 11s/epoch - 43ms/step
Epoch 7/50
260/260 - 11s - loss: 3.2216 - accuracy500: 0.4051 - val_loss: 3.4468 - val_accuracy500: 0.3328 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.2034 - accuracy500: 0.4168 - val_loss: 3.4577 - val_accuracy500: 0.3354 - 11s/epoch - 42ms/step
Epoch 9/50
260/260 - 11s - loss: 3.1869 - accuracy500: 0.4268 - val_loss: 3.4831 - val_accuracy500: 0.3336 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.1736 - accuracy500: 0.4334 - val_loss: 3.5151 - val_accuracy500: 0.3242 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.1645 - accuracy500: 0.4366 - val_loss: 3.5524 - val_accuracy500: 0.3271 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h500
Evaluating performance on  test set...
678/678 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1326838
{'0': {'precision': 0.3009263972309885, 'recall': 0.05812033031852143, 'f1-score': 0.09742431982598092, 'support': 50860}, '1': {'precision': 0.431142453379146, 'recall': 0.40354540031641467, 'f1-score': 0.4168877099911583, 'support': 77114}, '2': {'precision': 0.26140429582781677, 'recall': 0.5260029063366947, 'f1-score': 0.34924602913551006, 'support': 45418}, 'accuracy': 0.33430031373996494, 'macro avg': {'precision': 0.3311577154793171, 'recall': 0.3292228789905436, 'f1-score': 0.28785268631754973, 'support': 173392}, 'weighted avg': {'precision': 0.3484860663753537, 'recall': 0.33430031373996494, 'f1-score': 0.30546355037074474, 'support': 173392}}
[[ 2956 22154 25750]
 [ 4244 31119 41751]
 [ 2623 18905 23890]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1529841
{'0': {'precision': 0.30531047111703014, 'recall': 0.08387834438600503, 'f1-score': 0.131601607347876, 'support': 21865}, '1': {'precision': 0.3353063463648438, 'recall': 0.529838488913222, 'f1-score': 0.4107016551138775, 'support': 21918}, '2': {'precision': 0.34638741824976643, 'recall': 0.3946598066175818, 'f1-score': 0.3689513621097151, 'support': 22546}, 'accuracy': 0.3368813038037661, 'macro avg': {'precision': 0.3290014119105468, 'recall': 0.33612554663893635, 'f1-score': 0.30375154152382283, 'support': 66329}, 'weighted avg': {'precision': 0.3291849520188416, 'recall': 0.3368813038037661, 'f1-score': 0.30450640642212173, 'support': 66329}}
[[ 1834 11487  8544]
 [ 2059 11613  8246]
 [ 2114 11534  8898]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1290541
{'0': {'precision': 0.32166566083283044, 'recall': 0.0744621402626432, 'f1-score': 0.12093023255813953, 'support': 7158}, '1': {'precision': 0.41199703776845226, 'recall': 0.5741314069487444, 'f1-score': 0.4797355561943087, 'support': 8721}, '2': {'precision': 0.2760955194485475, 'recall': 0.3704376548307184, 'f1-score': 0.31638338387756537, 'support': 6055}, 'accuracy': 0.3548372389896964, 'macro avg': {'precision': 0.3365860726832767, 'recall': 0.33967706734736863, 'f1-score': 0.30568305754333785, 'support': 21934}, 'weighted avg': {'precision': 0.34500170223766885, 'recall': 0.3548372389896964, 'f1-score': 0.31754781524575487, 'support': 21934}}
[[ 533 3782 2843]
 [ 676 5007 3038]
 [ 448 3364 2243]]
training model: results/LILAK/W3/deepLOB_L2/h1000
Epoch 1/50
260/260 - 13s - loss: 3.3567 - accuracy1000: 0.3490 - val_loss: 3.5374 - val_accuracy1000: 0.3385 - 13s/epoch - 51ms/step
Epoch 2/50
260/260 - 11s - loss: 3.3268 - accuracy1000: 0.3579 - val_loss: 3.5829 - val_accuracy1000: 0.3438 - 11s/epoch - 43ms/step
Epoch 3/50
260/260 - 11s - loss: 3.3077 - accuracy1000: 0.3641 - val_loss: 3.6325 - val_accuracy1000: 0.2997 - 11s/epoch - 44ms/step
Epoch 4/50
260/260 - 11s - loss: 3.2824 - accuracy1000: 0.3735 - val_loss: 3.6967 - val_accuracy1000: 0.3078 - 11s/epoch - 43ms/step
Epoch 5/50
260/260 - 11s - loss: 3.2595 - accuracy1000: 0.3910 - val_loss: 3.6426 - val_accuracy1000: 0.2956 - 11s/epoch - 42ms/step
Epoch 6/50
260/260 - 11s - loss: 3.2250 - accuracy1000: 0.4106 - val_loss: 3.6263 - val_accuracy1000: 0.3131 - 11s/epoch - 42ms/step
Epoch 7/50
260/260 - 11s - loss: 3.1975 - accuracy1000: 0.4253 - val_loss: 3.6669 - val_accuracy1000: 0.3076 - 11s/epoch - 42ms/step
Epoch 8/50
260/260 - 11s - loss: 3.1717 - accuracy1000: 0.4351 - val_loss: 3.6744 - val_accuracy1000: 0.3075 - 11s/epoch - 43ms/step
Epoch 9/50
260/260 - 11s - loss: 3.1546 - accuracy1000: 0.4419 - val_loss: 3.6886 - val_accuracy1000: 0.3131 - 11s/epoch - 42ms/step
Epoch 10/50
260/260 - 11s - loss: 3.1298 - accuracy1000: 0.4523 - val_loss: 3.7579 - val_accuracy1000: 0.3161 - 11s/epoch - 42ms/step
Epoch 11/50
260/260 - 11s - loss: 3.1110 - accuracy1000: 0.4584 - val_loss: 3.7600 - val_accuracy1000: 0.3247 - 11s/epoch - 42ms/step
testing model: results/LILAK/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1632471
{'0': {'precision': 0.29934682173012583, 'recall': 0.03366297610089935, 'f1-score': 0.06052017070617602, 'support': 55818}, '1': {'precision': 0.4112208981807387, 'recall': 0.39459334816342034, 'f1-score': 0.4027355728297812, 'support': 73724}, '2': {'precision': 0.2566928153405553, 'recall': 0.5641505131128849, 'f1-score': 0.3528404957852548, 'support': 43850}, 'accuracy': 0.32128356556242504, 'macro avg': {'precision': 0.32242017841713994, 'recall': 0.33080227912573484, 'f1-score': 0.27203207977373733, 'support': 173392}, 'weighted avg': {'precision': 0.33612721662759704, 'recall': 0.32128356556242504, 'f1-score': 0.27995206237867687, 'support': 173392}}
[[ 1879 24343 29596]
 [ 2595 29091 42038]
 [ 1803 17309 24738]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1616992
{'0': {'precision': 0.3143302720499047, 'recall': 0.084580594022474, 'f1-score': 0.13329414358145347, 'support': 21447}, '1': {'precision': 0.34524730880180116, 'recall': 0.44273018450850365, 'f1-score': 0.3879588085308245, 'support': 22167}, '2': {'precision': 0.34610357276235526, 'recall': 0.48958837772397096, 'f1-score': 0.40552810545699847, 'support': 22715}, 'accuracy': 0.3429721539598064, 'macro avg': {'precision': 0.33522705120468704, 'recall': 0.3389663854183162, 'f1-score': 0.3089270191897588, 'support': 66329}, 'weighted avg': {'precision': 0.33554374548328386, 'recall': 0.3429721539598064, 'f1-score': 0.31163161394789524, 'support': 66329}}
[[ 1814  8986 10647]
 [ 1989  9814 10364]
 [ 1968  9626 11121]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1724813
{'0': {'precision': 0.27049180327868855, 'recall': 0.039652870493991986, 'f1-score': 0.06916627852817886, 'support': 7490}, '1': {'precision': 0.399624765478424, 'recall': 0.4835703190345322, 'f1-score': 0.4376081314878893, 'support': 8369}, '2': {'precision': 0.28079185731627604, 'recall': 0.4949794238683128, 'f1-score': 0.3583174451858913, 'support': 6075}, 'accuracy': 0.33514178900337377, 'macro avg': {'precision': 0.31696947535779624, 'recall': 0.33940087113227896, 'f1-score': 0.2883639517339865, 'support': 21934}, 'weighted avg': {'precision': 0.3226157473348539, 'recall': 0.33514178900337377, 'f1-score': 0.28983205790564853, 'support': 21934}}
[[ 297 3285 3908]
 [ 528 4047 3794]
 [ 273 2795 3007]]
training model: results/LILAK/W3/deepOF_L2/h10
Epoch 1/50
260/260 - 8s - loss: 3.3345 - accuracy10: 0.3513 - val_loss: 3.3287 - val_accuracy10: 0.3613 - 8s/epoch - 31ms/step
Epoch 2/50
260/260 - 6s - loss: 3.2842 - accuracy10: 0.3877 - val_loss: 3.3012 - val_accuracy10: 0.3778 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2540 - accuracy10: 0.4102 - val_loss: 3.2849 - val_accuracy10: 0.3914 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2278 - accuracy10: 0.4267 - val_loss: 3.2643 - val_accuracy10: 0.4106 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2035 - accuracy10: 0.4405 - val_loss: 3.2561 - val_accuracy10: 0.4108 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.1854 - accuracy10: 0.4474 - val_loss: 3.2446 - val_accuracy10: 0.4223 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.1697 - accuracy10: 0.4513 - val_loss: 3.2410 - val_accuracy10: 0.4202 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.1521 - accuracy10: 0.4577 - val_loss: 3.2272 - val_accuracy10: 0.4268 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.1436 - accuracy10: 0.4616 - val_loss: 3.2286 - val_accuracy10: 0.4289 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.1288 - accuracy10: 0.4643 - val_loss: 3.2250 - val_accuracy10: 0.4253 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.1156 - accuracy10: 0.4703 - val_loss: 3.2259 - val_accuracy10: 0.4210 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.1073 - accuracy10: 0.4725 - val_loss: 3.2262 - val_accuracy10: 0.4239 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.0952 - accuracy10: 0.4747 - val_loss: 3.2264 - val_accuracy10: 0.4246 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.0832 - accuracy10: 0.4767 - val_loss: 3.2260 - val_accuracy10: 0.4284 - 6s/epoch - 23ms/step
Epoch 15/50
260/260 - 6s - loss: 3.0721 - accuracy10: 0.4806 - val_loss: 3.2256 - val_accuracy10: 0.4257 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.0590 - accuracy10: 0.4833 - val_loss: 3.2366 - val_accuracy10: 0.4210 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.0422 - accuracy10: 0.4879 - val_loss: 3.2380 - val_accuracy10: 0.4209 - 6s/epoch - 24ms/step
Epoch 18/50
260/260 - 6s - loss: 3.0299 - accuracy10: 0.4915 - val_loss: 3.2489 - val_accuracy10: 0.4301 - 6s/epoch - 24ms/step
Epoch 19/50
260/260 - 6s - loss: 3.0241 - accuracy10: 0.4919 - val_loss: 3.2512 - val_accuracy10: 0.4264 - 6s/epoch - 24ms/step
Epoch 20/50
260/260 - 6s - loss: 3.0057 - accuracy10: 0.4979 - val_loss: 3.2691 - val_accuracy10: 0.4131 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h10
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0804499
{'0': {'precision': 0.3508023877819986, 'recall': 0.46443600533716517, 'f1-score': 0.3996996731737479, 'support': 48715}, '1': {'precision': 0.5250979112271541, 'recall': 0.42793877089622706, 'f1-score': 0.4715658042250116, 'support': 75193}, '2': {'precision': 0.37727091340600255, 'recall': 0.36303556992724334, 'f1-score': 0.3700163760518266, 'support': 49480}, 'accuracy': 0.4196714882229451, 'macro avg': {'precision': 0.4177237374717184, 'recall': 0.41847011538687856, 'f1-score': 0.413760617816862, 'support': 173388}, 'weighted avg': {'precision': 0.43394231639463204, 'recall': 0.4196714882229451, 'f1-score': 0.42239501801044366, 'support': 173388}}
[[22625 14334 11756]
 [25121 32178 17894]
 [16749 14768 17963]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0503678
{'0': {'precision': 0.3884126741160263, 'recall': 0.5348016228463038, 'f1-score': 0.4500011083771142, 'support': 18979}, '1': {'precision': 0.5762337004100816, 'recall': 0.4333033053842423, 'f1-score': 0.4946504499159498, 'support': 28862}, '2': {'precision': 0.4042829331602855, 'recall': 0.4044141512495943, 'f1-score': 0.40434853155930556, 'support': 18486}, 'accuracy': 0.4542946311456873, 'macro avg': {'precision': 0.4563097692287978, 'recall': 0.45750635982671345, 'f1-score': 0.4496666966174565, 'support': 66327}, 'weighted avg': {'precision': 0.47456564454422595, 'recall': 0.4542946311456873, 'f1-score': 0.4567063077746426, 'support': 66327}}
[[10150  4555  4274]
 [ 9614 12506  6742]
 [ 6368  4642  7476]]
Evaluating performance on  val set...
86/86 - 1s - 849ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0765386
{'0': {'precision': 0.36749814769078787, 'recall': 0.46254274168479953, 'f1-score': 0.4095788604459125, 'support': 6434}, '1': {'precision': 0.5430291421535094, 'recall': 0.42544752920999035, 'f1-score': 0.47710061305445367, 'support': 9329}, '2': {'precision': 0.3675501761912058, 'recall': 0.38875384864689677, 'f1-score': 0.37785478028035907, 'support': 6171}, 'accuracy': 0.42600528859305187, 'macro avg': {'precision': 0.4260258220118344, 'recall': 0.4255813731805622, 'f1-score': 0.42151141792690844, 'support': 21934}, 'weighted avg': {'precision': 0.4421698772074655, 'recall': 0.42600528859305187, 'f1-score': 0.4293719274370427, 'support': 21934}}
[[2976 1682 1776]
 [3008 3969 2352]
 [2114 1658 2399]]
training model: results/LILAK/W3/deepOF_L2/h20
Epoch 1/50
260/260 - 8s - loss: 3.3424 - accuracy20: 0.3427 - val_loss: 3.3253 - val_accuracy20: 0.3474 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3016 - accuracy20: 0.3661 - val_loss: 3.3073 - val_accuracy20: 0.3542 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2797 - accuracy20: 0.3763 - val_loss: 3.2916 - val_accuracy20: 0.3652 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2614 - accuracy20: 0.3898 - val_loss: 3.2857 - val_accuracy20: 0.3740 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2467 - accuracy20: 0.3981 - val_loss: 3.2793 - val_accuracy20: 0.3801 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2309 - accuracy20: 0.4099 - val_loss: 3.2713 - val_accuracy20: 0.3873 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2200 - accuracy20: 0.4154 - val_loss: 3.2694 - val_accuracy20: 0.3906 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2061 - accuracy20: 0.4201 - val_loss: 3.2683 - val_accuracy20: 0.3926 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.1976 - accuracy20: 0.4263 - val_loss: 3.2596 - val_accuracy20: 0.3948 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.1841 - accuracy20: 0.4335 - val_loss: 3.2620 - val_accuracy20: 0.3971 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.1729 - accuracy20: 0.4380 - val_loss: 3.2566 - val_accuracy20: 0.3997 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.1620 - accuracy20: 0.4427 - val_loss: 3.2568 - val_accuracy20: 0.4024 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.1514 - accuracy20: 0.4458 - val_loss: 3.2611 - val_accuracy20: 0.4021 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1426 - accuracy20: 0.4502 - val_loss: 3.2625 - val_accuracy20: 0.4056 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1330 - accuracy20: 0.4532 - val_loss: 3.2637 - val_accuracy20: 0.4007 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.1206 - accuracy20: 0.4567 - val_loss: 3.2699 - val_accuracy20: 0.4050 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.1121 - accuracy20: 0.4617 - val_loss: 3.2721 - val_accuracy20: 0.4007 - 6s/epoch - 24ms/step
Epoch 18/50
260/260 - 6s - loss: 3.0938 - accuracy20: 0.4670 - val_loss: 3.2831 - val_accuracy20: 0.3984 - 6s/epoch - 23ms/step
Epoch 19/50
260/260 - 6s - loss: 3.0846 - accuracy20: 0.4706 - val_loss: 3.2834 - val_accuracy20: 0.4037 - 6s/epoch - 24ms/step
Epoch 20/50
260/260 - 6s - loss: 3.0701 - accuracy20: 0.4766 - val_loss: 3.2911 - val_accuracy20: 0.4028 - 6s/epoch - 24ms/step
Epoch 21/50
260/260 - 6s - loss: 3.0565 - accuracy20: 0.4814 - val_loss: 3.2974 - val_accuracy20: 0.4001 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h20
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0923303
{'0': {'precision': 0.39427442608848035, 'recall': 0.4193253248843632, 'f1-score': 0.40641421439831843, 'support': 59021}, '1': {'precision': 0.3811899313501144, 'recall': 0.4507359838372177, 'f1-score': 0.41305605607260343, 'support': 55436}, '2': {'precision': 0.4138283000865378, 'recall': 0.31647180601041897, 'f1-score': 0.3586607434758361, 'support': 58931}, 'accuracy': 0.3944102244676679, 'macro avg': {'precision': 0.3964308858417109, 'recall': 0.39551103824399997, 'f1-score': 0.3927103379822527, 'support': 173388}, 'weighted avg': {'precision': 0.3967369800037655, 'recall': 0.3944102244676679, 'f1-score': 0.39230734045157967, 'support': 173388}}
[[24749 20390 13882]
 [17914 24987 12535]
 [20108 20173 18650]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0555885
{'0': {'precision': 0.4442348597343179, 'recall': 0.48818029461056717, 'f1-score': 0.4651719862999307, 'support': 22674}, '1': {'precision': 0.43586315012910365, 'recall': 0.4411105926271582, 'f1-score': 0.43847117213228815, 'support': 21430}, '2': {'precision': 0.4439711996754893, 'recall': 0.3940062097826576, 'f1-score': 0.4174991059721063, 'support': 22223}, 'accuracy': 0.44141902995763416, 'macro avg': {'precision': 0.4413564031796369, 'recall': 0.44109903234012765, 'f1-score': 0.44038075480144173, 'support': 66327}, 'weighted avg': {'precision': 0.4414416525286989, 'recall': 0.44141902995763416, 'f1-score': 0.4405721571634128, 'support': 66327}}
[[11069  5969  5636]
 [ 6647  9453  5330]
 [ 7201  6266  8756]]
Evaluating performance on  val set...
86/86 - 1s - 858ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864581
{'0': {'precision': 0.4028992751812047, 'recall': 0.42050345637146214, 'f1-score': 0.41151317888825073, 'support': 7667}, '1': {'precision': 0.3939476927290155, 'recall': 0.42067553735926305, 'f1-score': 0.40687314382689854, 'support': 6839}, '2': {'precision': 0.3977975561924876, 'recall': 0.3550080775444265, 'f1-score': 0.37518673970263927, 'support': 7428}, 'accuracy': 0.3983769490289049, 'macro avg': {'precision': 0.39821484136756924, 'recall': 0.39872902375838387, 'f1-score': 0.39785768747259614, 'support': 21934}, 'weighted avg': {'precision': 0.3983804714500698, 'recall': 0.3983769490289049, 'f1-score': 0.39776438751160675, 'support': 21934}}
[[3224 2269 2174]
 [2144 2877 1818]
 [2634 2157 2637]]
training model: results/LILAK/W3/deepOF_L2/h30
Epoch 1/50
260/260 - 9s - loss: 3.3418 - accuracy30: 0.3420 - val_loss: 3.3405 - val_accuracy30: 0.3375 - 9s/epoch - 33ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3076 - accuracy30: 0.3545 - val_loss: 3.3256 - val_accuracy30: 0.3455 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2887 - accuracy30: 0.3688 - val_loss: 3.3125 - val_accuracy30: 0.3540 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2748 - accuracy30: 0.3796 - val_loss: 3.3059 - val_accuracy30: 0.3554 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2620 - accuracy30: 0.3888 - val_loss: 3.2992 - val_accuracy30: 0.3656 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2510 - accuracy30: 0.3965 - val_loss: 3.2923 - val_accuracy30: 0.3713 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2409 - accuracy30: 0.4026 - val_loss: 3.2930 - val_accuracy30: 0.3744 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2297 - accuracy30: 0.4094 - val_loss: 3.2915 - val_accuracy30: 0.3744 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2230 - accuracy30: 0.4123 - val_loss: 3.2902 - val_accuracy30: 0.3770 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2138 - accuracy30: 0.4161 - val_loss: 3.2923 - val_accuracy30: 0.3777 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2046 - accuracy30: 0.4198 - val_loss: 3.2960 - val_accuracy30: 0.3773 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.1966 - accuracy30: 0.4265 - val_loss: 3.2999 - val_accuracy30: 0.3794 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.1886 - accuracy30: 0.4291 - val_loss: 3.3007 - val_accuracy30: 0.3790 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1775 - accuracy30: 0.4353 - val_loss: 3.3007 - val_accuracy30: 0.3794 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1696 - accuracy30: 0.4379 - val_loss: 3.3063 - val_accuracy30: 0.3812 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.1584 - accuracy30: 0.4421 - val_loss: 3.3154 - val_accuracy30: 0.3768 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.1471 - accuracy30: 0.4468 - val_loss: 3.3199 - val_accuracy30: 0.3798 - 6s/epoch - 24ms/step
Epoch 18/50
260/260 - 6s - loss: 3.1359 - accuracy30: 0.4514 - val_loss: 3.3325 - val_accuracy30: 0.3799 - 6s/epoch - 24ms/step
Epoch 19/50
260/260 - 6s - loss: 3.1252 - accuracy30: 0.4562 - val_loss: 3.3365 - val_accuracy30: 0.3805 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h30
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0994414
{'0': {'precision': 0.3805293691080493, 'recall': 0.42978534621028563, 'f1-score': 0.40366031506915173, 'support': 58606}, '1': {'precision': 0.3708819618850643, 'recall': 0.35344220751795014, 'f1-score': 0.3619521337946943, 'support': 56824}, '2': {'precision': 0.3774790739763215, 'recall': 0.34547430898236653, 'f1-score': 0.3607682744455055, 'support': 57958}, 'accuracy': 0.37658315454356706, 'macro avg': {'precision': 0.37629680165647833, 'recall': 0.3762339542368675, 'f1-score': 0.3754602411031172, 'support': 173388}, 'weighted avg': {'precision': 0.37634803433699493, 'recall': 0.37658315454356706, 'f1-score': 0.37565397908739373, 'support': 173388}}
[[25188 16977 16441]
 [20160 20084 16580]
 [20844 17091 20023]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724679
{'0': {'precision': 0.41550628121689115, 'recall': 0.4915178371603778, 'f1-score': 0.45032705202075085, 'support': 22341}, '1': {'precision': 0.41500151837230487, 'recall': 0.3121659280917356, 'f1-score': 0.35631224904833914, 'support': 21889}, '2': {'precision': 0.4148246138089955, 'recall': 0.43992397157985247, 'f1-score': 0.4270057762842899, 'support': 22097}, 'accuracy': 0.41514013900824703, 'macro avg': {'precision': 0.41511080446606385, 'recall': 0.41453591227732195, 'f1-score': 0.41121502578445995, 'support': 66327}, 'weighted avg': {'precision': 0.41511260204223493, 'recall': 0.41514013900824703, 'f1-score': 0.41153108277426453, 'support': 66327}}
[[10981  4713  6647]
 [ 7990  6833  7066]
 [ 7457  4919  9721]]
Evaluating performance on  val set...
86/86 - 1s - 868ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975578
{'0': {'precision': 0.3866921514753315, 'recall': 0.42772198731501054, 'f1-score': 0.4061735366083192, 'support': 7568}, '1': {'precision': 0.3668017686072218, 'recall': 0.2843879445793458, 'f1-score': 0.32037975701987287, 'support': 7001}, '2': {'precision': 0.3777504609711125, 'recall': 0.4172437202987101, 'f1-score': 0.3965161290322581, 'support': 7365}, 'accuracy': 0.3784535424455184, 'macro avg': {'precision': 0.37708146035122186, 'recall': 0.37645121739768883, 'f1-score': 0.37435647422015, 'support': 21934}, 'weighted avg': {'precision': 0.3773410016156064, 'recall': 0.3784535424455184, 'f1-score': 0.3755466989272577, 'support': 21934}}
[[3237 1729 2602]
 [2550 1991 2460]
 [2584 1708 3073]]
training model: results/LILAK/W3/deepOF_L2/h50
Epoch 1/50
260/260 - 8s - loss: 3.3445 - accuracy50: 0.3397 - val_loss: 3.3402 - val_accuracy50: 0.3309 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3124 - accuracy50: 0.3523 - val_loss: 3.3219 - val_accuracy50: 0.3434 - 6s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2943 - accuracy50: 0.3602 - val_loss: 3.3162 - val_accuracy50: 0.3480 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2810 - accuracy50: 0.3699 - val_loss: 3.3099 - val_accuracy50: 0.3489 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2751 - accuracy50: 0.3773 - val_loss: 3.3084 - val_accuracy50: 0.3558 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2633 - accuracy50: 0.3869 - val_loss: 3.3045 - val_accuracy50: 0.3606 - 6s/epoch - 25ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2553 - accuracy50: 0.3936 - val_loss: 3.3077 - val_accuracy50: 0.3612 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2447 - accuracy50: 0.3989 - val_loss: 3.3048 - val_accuracy50: 0.3587 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2410 - accuracy50: 0.3980 - val_loss: 3.3058 - val_accuracy50: 0.3599 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2327 - accuracy50: 0.4051 - val_loss: 3.3047 - val_accuracy50: 0.3618 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2256 - accuracy50: 0.4101 - val_loss: 3.3110 - val_accuracy50: 0.3636 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2162 - accuracy50: 0.4153 - val_loss: 3.3110 - val_accuracy50: 0.3651 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2079 - accuracy50: 0.4195 - val_loss: 3.3152 - val_accuracy50: 0.3635 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1981 - accuracy50: 0.4248 - val_loss: 3.3213 - val_accuracy50: 0.3672 - 6s/epoch - 25ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1931 - accuracy50: 0.4245 - val_loss: 3.3250 - val_accuracy50: 0.3685 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.1836 - accuracy50: 0.4303 - val_loss: 3.3413 - val_accuracy50: 0.3658 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h50
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1063474
{'0': {'precision': 0.36121630403119187, 'recall': 0.28233645678255537, 'f1-score': 0.31694225437958357, 'support': 57095}, '1': {'precision': 0.3539522860859114, 'recall': 0.3608560637851448, 'f1-score': 0.3573708358268502, 'support': 59575}, '2': {'precision': 0.3489209690697401, 'recall': 0.418473853097782, 'f1-score': 0.3805454458001315, 'support': 56718}, 'accuracy': 0.3538480171638176, 'macro avg': {'precision': 0.3546965197289478, 'recall': 0.35388879122182737, 'f1-score': 0.3516195120021884, 'support': 173388}, 'weighted avg': {'precision': 0.35469843268234585, 'recall': 0.3538480171638176, 'f1-score': 0.35163888015940425, 'support': 173388}}
[[16120 19930 21045]
 [14833 21498 23244]
 [13674 19309 23735]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861801
{'0': {'precision': 0.40919199406968126, 'recall': 0.34603501544799176, 'f1-score': 0.374972706761445, 'support': 22333}, '1': {'precision': 0.36637695555003724, 'recall': 0.33978167749067295, 'f1-score': 0.35257850212684605, 'support': 21711}, '2': {'precision': 0.3922214897824654, 'recall': 0.48063546201139884, 'f1-score': 0.4319506342132328, 'support': 22283}, 'accuracy': 0.3892080148355873, 'macro avg': {'precision': 0.38926347980072795, 'recall': 0.3888173849833545, 'f1-score': 0.3865006143671746, 'support': 66327}, 'weighted avg': {'precision': 0.38947587471659695, 'recall': 0.3892080148355873, 'f1-score': 0.3867844663855258, 'support': 66327}}
[[ 7728  6534  8071]
 [ 5809  7377  8525]
 [ 5349  6224 10710]]
Evaluating performance on  val set...
86/86 - 1s - 853ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1023316
{'0': {'precision': 0.37489759134851713, 'recall': 0.30539241857981847, 'f1-score': 0.33659433615299744, 'support': 7492}, '1': {'precision': 0.3360793287566743, 'recall': 0.30725244072524405, 'f1-score': 0.3210200364298725, 'support': 7170}, '2': {'precision': 0.35952996981457525, 'recall': 0.4586083608360836, 'f1-score': 0.4030698573845781, 'support': 7272}, 'accuracy': 0.35679766572444604, 'macro avg': {'precision': 0.3568356299732556, 'recall': 0.3570844067137154, 'f1-score': 0.3535614099891493, 'support': 21934}, 'weighted avg': {'precision': 0.35711331640649385, 'recall': 0.35679766572444604, 'f1-score': 0.3535425563308605, 'support': 21934}}
[[2288 2236 2968]
 [1994 2203 2973]
 [1821 2116 3335]]
training model: results/LILAK/W3/deepOF_L2/h100
Epoch 1/50
260/260 - 8s - loss: 3.3461 - accuracy100: 0.3389 - val_loss: 3.3444 - val_accuracy100: 0.3390 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3147 - accuracy100: 0.3499 - val_loss: 3.3288 - val_accuracy100: 0.3408 - 7s/epoch - 25ms/step
Epoch 3/50
260/260 - 7s - loss: 3.2971 - accuracy100: 0.3585 - val_loss: 3.3271 - val_accuracy100: 0.3430 - 7s/epoch - 25ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2863 - accuracy100: 0.3681 - val_loss: 3.3179 - val_accuracy100: 0.3454 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 7s - loss: 3.2762 - accuracy100: 0.3745 - val_loss: 3.3179 - val_accuracy100: 0.3468 - 7s/epoch - 25ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2683 - accuracy100: 0.3801 - val_loss: 3.3189 - val_accuracy100: 0.3488 - 6s/epoch - 25ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2616 - accuracy100: 0.3875 - val_loss: 3.3203 - val_accuracy100: 0.3510 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2560 - accuracy100: 0.3890 - val_loss: 3.3216 - val_accuracy100: 0.3523 - 6s/epoch - 25ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2484 - accuracy100: 0.3958 - val_loss: 3.3224 - val_accuracy100: 0.3507 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2412 - accuracy100: 0.3978 - val_loss: 3.3260 - val_accuracy100: 0.3507 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2348 - accuracy100: 0.4035 - val_loss: 3.3288 - val_accuracy100: 0.3514 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2278 - accuracy100: 0.4060 - val_loss: 3.3385 - val_accuracy100: 0.3500 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2192 - accuracy100: 0.4129 - val_loss: 3.3412 - val_accuracy100: 0.3504 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2107 - accuracy100: 0.4183 - val_loss: 3.3479 - val_accuracy100: 0.3526 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2039 - accuracy100: 0.4192 - val_loss: 3.3516 - val_accuracy100: 0.3478 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h100
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1208904
{'0': {'precision': 0.3905733102673829, 'recall': 0.1956667173483351, 'f1-score': 0.2607198209058033, 'support': 65770}, '1': {'precision': 0.26184179625677734, 'recall': 0.5755582987319043, 'f1-score': 0.3599359964068158, 'support': 44555}, '2': {'precision': 0.37704108041974493, 'recall': 0.2541109683966827, 'f1-score': 0.3036044143418747, 'support': 63063}, 'accuracy': 0.3145431056359148, 'macro avg': {'precision': 0.3431520623146351, 'recall': 0.34177866149230735, 'f1-score': 0.30808674388483126, 'support': 173388}, 'weighted avg': {'precision': 0.35257174373668804, 'recall': 0.3145431056359148, 'f1-score': 0.3018126751708423, 'support': 173388}}
[[12869 37219 15682]
 [ 8116 25644 10795]
 [11964 35074 16025]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920086
{'0': {'precision': 0.39645776566757496, 'recall': 0.2385571799426151, 'f1-score': 0.29787597031476587, 'support': 21957}, '1': {'precision': 0.3522664455500276, 'recall': 0.5807965730951513, 'f1-score': 0.43854517927190145, 'support': 21944}, '2': {'precision': 0.39905521110126957, 'recall': 0.3013466512084188, 'f1-score': 0.34338558471583547, 'support': 22426}, 'accuracy': 0.3730155140440545, 'macro avg': {'precision': 0.3825931407729574, 'recall': 0.37356680141539506, 'f1-score': 0.35993557810083426, 'support': 66327}, 'weighted avg': {'precision': 0.38271548850498016, 'recall': 0.3730155140440545, 'f1-score': 0.35980314527991986, 'support': 66327}}
[[ 5238 11755  4964]
 [ 3986 12745  5213]
 [ 3988 11680  6758]]
Evaluating performance on  val set...
86/86 - 1s - 881ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1064951
{'0': {'precision': 0.3469158036920306, 'recall': 0.2079902820893508, 'f1-score': 0.26006244198801787, 'support': 7409}, '1': {'precision': 0.3480231679677663, 'recall': 0.552578968412635, 'f1-score': 0.42707045735475896, 'support': 7503}, '2': {'precision': 0.346836350600466, 'recall': 0.2755625178011962, 'f1-score': 0.30711848266010633, 'support': 7022}, 'accuracy': 0.3474970365642382, 'macro avg': {'precision': 0.34725844075342094, 'recall': 0.3453772561010607, 'f1-score': 0.33141712733429435, 'support': 21934}, 'weighted avg': {'precision': 0.34726916534753705, 'recall': 0.3474970365642382, 'f1-score': 0.33225577913108634, 'support': 21934}}
[[1541 4080 1788]
 [1501 4146 1856]
 [1400 3687 1935]]
training model: results/LILAK/W3/deepOF_L2/h200
Epoch 1/50
260/260 - 9s - loss: 3.3489 - accuracy200: 0.3348 - val_loss: 3.3453 - val_accuracy200: 0.3269 - 9s/epoch - 33ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3200 - accuracy200: 0.3446 - val_loss: 3.3417 - val_accuracy200: 0.3330 - 7s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3051 - accuracy200: 0.3521 - val_loss: 3.3365 - val_accuracy200: 0.3294 - 6s/epoch - 25ms/step
Epoch 4/50
260/260 - 7s - loss: 3.2941 - accuracy200: 0.3557 - val_loss: 3.3324 - val_accuracy200: 0.3322 - 7s/epoch - 25ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2872 - accuracy200: 0.3650 - val_loss: 3.3291 - val_accuracy200: 0.3344 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2791 - accuracy200: 0.3695 - val_loss: 3.3299 - val_accuracy200: 0.3362 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2724 - accuracy200: 0.3725 - val_loss: 3.3272 - val_accuracy200: 0.3414 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2682 - accuracy200: 0.3772 - val_loss: 3.3323 - val_accuracy200: 0.3338 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2612 - accuracy200: 0.3845 - val_loss: 3.3356 - val_accuracy200: 0.3344 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2549 - accuracy200: 0.3847 - val_loss: 3.3432 - val_accuracy200: 0.3330 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2484 - accuracy200: 0.3936 - val_loss: 3.3432 - val_accuracy200: 0.3365 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2441 - accuracy200: 0.3959 - val_loss: 3.3471 - val_accuracy200: 0.3381 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2363 - accuracy200: 0.4019 - val_loss: 3.3545 - val_accuracy200: 0.3384 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2301 - accuracy200: 0.4051 - val_loss: 3.3603 - val_accuracy200: 0.3404 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2227 - accuracy200: 0.4078 - val_loss: 3.3669 - val_accuracy200: 0.3371 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2145 - accuracy200: 0.4136 - val_loss: 3.3720 - val_accuracy200: 0.3450 - 6s/epoch - 24ms/step
Epoch 17/50
260/260 - 6s - loss: 3.2024 - accuracy200: 0.4208 - val_loss: 3.3807 - val_accuracy200: 0.3397 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h200
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159383
{'0': {'precision': 0.33270305113880533, 'recall': 0.27428611918089707, 'f1-score': 0.3006835482367563, 'support': 56452}, '1': {'precision': 0.35965424173900357, 'recall': 0.15446186619883773, 'f1-score': 0.2161101918714866, 'support': 63841}, '2': {'precision': 0.30496831942069796, 'recall': 0.5711083906205857, 'f1-score': 0.3976135059826258, 'support': 53095}, 'accuracy': 0.3210602809883037, 'macro avg': {'precision': 0.33244187076616893, 'recall': 0.3332854586667735, 'f1-score': 0.3048024153636229, 'support': 173388}, 'weighted avg': {'precision': 0.33413345796358185, 'recall': 0.3210602809883037, 'f1-score': 0.29922582603453796, 'support': 173388}}
[[15484  8808 32160]
 [17033  9861 36947]
 [14023  8749 30323]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916044
{'0': {'precision': 0.387527352297593, 'recall': 0.3227481889835528, 'f1-score': 0.3521837480424569, 'support': 21949}, '1': {'precision': 0.382588887788452, 'recall': 0.17657007039034647, 'f1-score': 0.24162627052384678, 'support': 21878}, '2': {'precision': 0.36569169960474307, 'recall': 0.6168, 'f1-score': 0.45915632754342434, 'support': 22500}, 'accuracy': 0.3742819666199285, 'macro avg': {'precision': 0.37860264656359605, 'recall': 0.3720394197912998, 'f1-score': 0.350988782036576, 'support': 66327}, 'weighted avg': {'precision': 0.3784911240327821, 'recall': 0.3742819666199285, 'f1-score': 0.3520044326146464, 'support': 66327}}
[[ 7084  3084 11781]
 [ 5724  3863 12291]
 [ 5472  3150 13878]]
Evaluating performance on  val set...
86/86 - 1s - 871ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095707
{'0': {'precision': 0.3658019252732909, 'recall': 0.288768675940237, 'f1-score': 0.32275246527027995, 'support': 7764}, '1': {'precision': 0.3353090601185436, 'recall': 0.16406573677668831, 'f1-score': 0.220326409495549, 'support': 7241}, '2': {'precision': 0.3280867721415756, 'recall': 0.5806032616539183, 'f1-score': 0.4192590276692199, 'support': 6929}, 'accuracy': 0.3397921035834777, 'macro avg': {'precision': 0.3430659191778034, 'recall': 0.3444792247902812, 'f1-score': 0.320779300811683, 'support': 21934}, 'weighted avg': {'precision': 0.3438211131717508, 'recall': 0.3397921035834777, 'f1-score': 0.319425525405113, 'support': 21934}}
[[2242 1304 4218]
 [2032 1188 4021]
 [1855 1051 4023]]
training model: results/LILAK/W3/deepOF_L2/h300
Epoch 1/50
260/260 - 8s - loss: 3.3519 - accuracy300: 0.3351 - val_loss: 3.3490 - val_accuracy300: 0.3321 - 8s/epoch - 31ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3225 - accuracy300: 0.3422 - val_loss: 3.3420 - val_accuracy300: 0.3286 - 6s/epoch - 24ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3079 - accuracy300: 0.3505 - val_loss: 3.3416 - val_accuracy300: 0.3292 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2971 - accuracy300: 0.3562 - val_loss: 3.3373 - val_accuracy300: 0.3289 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2904 - accuracy300: 0.3605 - val_loss: 3.3433 - val_accuracy300: 0.3277 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2835 - accuracy300: 0.3662 - val_loss: 3.3390 - val_accuracy300: 0.3280 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2778 - accuracy300: 0.3691 - val_loss: 3.3413 - val_accuracy300: 0.3268 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2702 - accuracy300: 0.3781 - val_loss: 3.3429 - val_accuracy300: 0.3294 - 6s/epoch - 23ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2668 - accuracy300: 0.3831 - val_loss: 3.3482 - val_accuracy300: 0.3252 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2601 - accuracy300: 0.3855 - val_loss: 3.3500 - val_accuracy300: 0.3289 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2542 - accuracy300: 0.3883 - val_loss: 3.3552 - val_accuracy300: 0.3293 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2486 - accuracy300: 0.3951 - val_loss: 3.3639 - val_accuracy300: 0.3260 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2445 - accuracy300: 0.3943 - val_loss: 3.3672 - val_accuracy300: 0.3239 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2365 - accuracy300: 0.4007 - val_loss: 3.3760 - val_accuracy300: 0.3240 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h300
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1098619
{'0': {'precision': 0.30379108990129533, 'recall': 0.1949702284703331, 'f1-score': 0.237509269558769, 'support': 52567}, '1': {'precision': 0.42822258014235987, 'recall': 0.3358917582492223, 'f1-score': 0.3764788282046988, 'support': 73613}, '2': {'precision': 0.2722622390428519, 'recall': 0.47239874597525844, 'f1-score': 0.3454359578060379, 'support': 47208}, 'accuracy': 0.3303342791888712, 'macro avg': {'precision': 0.33475863636216907, 'recall': 0.3344202442316046, 'f1-score': 0.3198080185231686, 'support': 173388}, 'weighted avg': {'precision': 0.34803498970860663, 'recall': 0.3303342791888712, 'f1-score': 0.3258946781186457, 'support': 173388}}
[[10249 17492 24826]
 [14104 24726 34783]
 [ 9384 15523 22301]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971555
{'0': {'precision': 0.3724731182795699, 'recall': 0.23732529460126062, 'f1-score': 0.28992299966521595, 'support': 21894}, '1': {'precision': 0.3542110063849194, 'recall': 0.3180887372013652, 'f1-score': 0.33517945767100626, 'support': 21975}, '2': {'precision': 0.357779615844132, 'recall': 0.5200374031525514, 'f1-score': 0.42391245167964287, 'support': 22458}, 'accuracy': 0.35980822289565334, 'macro avg': {'precision': 0.36148791350287374, 'recall': 0.35848381165172577, 'f1-score': 0.3496716363386217, 'support': 66327}, 'weighted avg': {'precision': 0.3614474939247821, 'recall': 0.35980822289565334, 'f1-score': 0.3502852319087554, 'support': 66327}}
[[ 5196  6358 10340]
 [ 4361  6990 10624]
 [ 4393  6386 11679]]
Evaluating performance on  val set...
86/86 - 1s - 847ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105243
{'0': {'precision': 0.3393599334995844, 'recall': 0.22317889845565123, 'f1-score': 0.26927199274466157, 'support': 7317}, '1': {'precision': 0.37874744938000315, 'recall': 0.2977174583590376, 'f1-score': 0.33337938657087596, 'support': 8105}, '2': {'precision': 0.2984838619663287, 'recall': 0.49278255528255527, 'f1-score': 0.37177779065052424, 'support': 6512}, 'accuracy': 0.33076502233974653, 'macro avg': {'precision': 0.3388637482819721, 'recall': 0.33789297069908136, 'f1-score': 0.32480972332202057, 'support': 21934}, 'weighted avg': {'precision': 0.3417785912175671, 'recall': 0.33076502233974653, 'f1-score': 0.32339382108989934, 'support': 21934}}
[[1633 2097 3587]
 [1737 2413 3955]
 [1442 1861 3209]]
training model: results/LILAK/W3/deepOF_L2/h500
Epoch 1/50
260/260 - 9s - loss: 3.3453 - accuracy500: 0.3385 - val_loss: 3.3329 - val_accuracy500: 0.3550 - 9s/epoch - 34ms/step
Epoch 2/50
260/260 - 7s - loss: 3.3201 - accuracy500: 0.3450 - val_loss: 3.3231 - val_accuracy500: 0.3613 - 7s/epoch - 25ms/step
Epoch 3/50
260/260 - 7s - loss: 3.3087 - accuracy500: 0.3504 - val_loss: 3.3186 - val_accuracy500: 0.3585 - 7s/epoch - 25ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2956 - accuracy500: 0.3583 - val_loss: 3.3160 - val_accuracy500: 0.3619 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2901 - accuracy500: 0.3619 - val_loss: 3.3149 - val_accuracy500: 0.3618 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2844 - accuracy500: 0.3657 - val_loss: 3.3143 - val_accuracy500: 0.3598 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2789 - accuracy500: 0.3685 - val_loss: 3.3174 - val_accuracy500: 0.3553 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2732 - accuracy500: 0.3737 - val_loss: 3.3197 - val_accuracy500: 0.3521 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2693 - accuracy500: 0.3765 - val_loss: 3.3221 - val_accuracy500: 0.3514 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2620 - accuracy500: 0.3811 - val_loss: 3.3196 - val_accuracy500: 0.3558 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2578 - accuracy500: 0.3855 - val_loss: 3.3279 - val_accuracy500: 0.3483 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2523 - accuracy500: 0.3911 - val_loss: 3.3283 - val_accuracy500: 0.3505 - 6s/epoch - 25ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2448 - accuracy500: 0.3955 - val_loss: 3.3291 - val_accuracy500: 0.3539 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2386 - accuracy500: 0.3969 - val_loss: 3.3411 - val_accuracy500: 0.3473 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2316 - accuracy500: 0.4004 - val_loss: 3.3417 - val_accuracy500: 0.3458 - 6s/epoch - 24ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2249 - accuracy500: 0.4054 - val_loss: 3.3527 - val_accuracy500: 0.3469 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h500
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994602
{'0': {'precision': 0.2953207769276045, 'recall': 0.15785127216957018, 'f1-score': 0.205735373260552, 'support': 50858}, '1': {'precision': 0.451496850833134, 'recall': 0.5875068081022902, 'f1-score': 0.5105996911945362, 'support': 77114}, '2': {'precision': 0.26360662887047537, 'recall': 0.2661837237977805, 'f1-score': 0.26488890836583545, 'support': 45416}, 'accuracy': 0.37731561584423373, 'macro avg': {'precision': 0.33680808554373803, 'recall': 0.337180601356547, 'f1-score': 0.3270746576069746, 'support': 173388}, 'weighted avg': {'precision': 0.35647282905917316, 'recall': 0.3773156158442338, 'f1-score': 0.3568174779246741, 'support': 173388}}
[[ 8028 29199 13631]
 [11669 45305 20140]
 [ 7487 25840 12089]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0940317
{'0': {'precision': 0.39458819241982507, 'recall': 0.1979976227484685, 'f1-score': 0.26368340943683405, 'support': 21874}, '1': {'precision': 0.35368328670945093, 'recall': 0.5889391240809243, 'f1-score': 0.44195411161945886, 'support': 21897}, '2': {'precision': 0.3868389009476415, 'recall': 0.323949281787551, 'f1-score': 0.35261189528290504, 'support': 22556}, 'accuracy': 0.3698946130535076, 'macro avg': {'precision': 0.37837012669230585, 'recall': 0.3702953428723146, 'f1-score': 0.3527498054463993, 'support': 66327}, 'weighted avg': {'precision': 0.37844864534568273, 'recall': 0.3698946130535076, 'f1-score': 0.35277932049020466, 'support': 66327}}
[[ 4331 11715  5828]
 [ 3247 12896  5754]
 [ 3398 11851  7307]]
Evaluating performance on  val set...
86/86 - 1s - 843ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020896
{'0': {'precision': 0.34411845352344395, 'recall': 0.1757456938804089, 'f1-score': 0.23266592510196518, 'support': 7141}, '1': {'precision': 0.39984996249062266, 'recall': 0.5494845360824743, 'f1-score': 0.46287451150673037, 'support': 8730}, '2': {'precision': 0.278060413354531, 'recall': 0.2884710539336962, 'f1-score': 0.2831700801424755, 'support': 6063}, 'accuracy': 0.35565788273912646, 'macro avg': {'precision': 0.3406762764561992, 'recall': 0.33790042796552644, 'f1-score': 0.32623683891705707, 'support': 21934}, 'weighted avg': {'precision': 0.348040500379437, 'recall': 0.35565788273912646, 'f1-score': 0.33825212239038566, 'support': 21934}}
[[1255 3899 1987]
 [1379 4797 2554]
 [1013 3301 1749]]
training model: results/LILAK/W3/deepOF_L2/h1000
Epoch 1/50
260/260 - 8s - loss: 3.3489 - accuracy1000: 0.3355 - val_loss: 3.3464 - val_accuracy1000: 0.3351 - 8s/epoch - 31ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3272 - accuracy1000: 0.3408 - val_loss: 3.3406 - val_accuracy1000: 0.3361 - 6s/epoch - 25ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3116 - accuracy1000: 0.3483 - val_loss: 3.3375 - val_accuracy1000: 0.3399 - 6s/epoch - 24ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2996 - accuracy1000: 0.3539 - val_loss: 3.3375 - val_accuracy1000: 0.3352 - 6s/epoch - 24ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2933 - accuracy1000: 0.3576 - val_loss: 3.3295 - val_accuracy1000: 0.3415 - 6s/epoch - 24ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2893 - accuracy1000: 0.3602 - val_loss: 3.3344 - val_accuracy1000: 0.3399 - 6s/epoch - 24ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2820 - accuracy1000: 0.3669 - val_loss: 3.3318 - val_accuracy1000: 0.3392 - 6s/epoch - 24ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2787 - accuracy1000: 0.3689 - val_loss: 3.3324 - val_accuracy1000: 0.3365 - 6s/epoch - 24ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2718 - accuracy1000: 0.3747 - val_loss: 3.3367 - val_accuracy1000: 0.3410 - 6s/epoch - 24ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2667 - accuracy1000: 0.3773 - val_loss: 3.3377 - val_accuracy1000: 0.3428 - 6s/epoch - 24ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2618 - accuracy1000: 0.3820 - val_loss: 3.3447 - val_accuracy1000: 0.3405 - 6s/epoch - 24ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2569 - accuracy1000: 0.3868 - val_loss: 3.3491 - val_accuracy1000: 0.3372 - 6s/epoch - 24ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2496 - accuracy1000: 0.3915 - val_loss: 3.3550 - val_accuracy1000: 0.3364 - 6s/epoch - 24ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2454 - accuracy1000: 0.3929 - val_loss: 3.3627 - val_accuracy1000: 0.3339 - 6s/epoch - 24ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2366 - accuracy1000: 0.4005 - val_loss: 3.3665 - val_accuracy1000: 0.3422 - 6s/epoch - 24ms/step
testing model: results/LILAK/W3/deepOF_L2/h1000
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104658
{'0': {'precision': 0.3312103899347507, 'recall': 0.19006413701673294, 'f1-score': 0.24152807658596, 'support': 55818}, '1': {'precision': 0.42190539539903865, 'recall': 0.45599066776989544, 'f1-score': 0.43828633264233846, 'support': 73723}, '2': {'precision': 0.24743020201692661, 'recall': 0.34805117795972357, 'f1-score': 0.28923951670220327, 'support': 43847}, 'accuracy': 0.34308602671465155, 'macro avg': {'precision': 0.3335153291169053, 'recall': 0.33136866091545064, 'f1-score': 0.32301797531016724, 'support': 173388}, 'weighted avg': {'precision': 0.3485864366520026, 'recall': 0.34308602671465155, 'f1-score': 0.3372533426137203, 'support': 173388}}
[[10609 25565 19644]
 [13333 33617 26773]
 [ 8089 20497 15261]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939891
{'0': {'precision': 0.38267296243071236, 'recall': 0.2611741628135071, 'f1-score': 0.3104596935376416, 'support': 21411}, '1': {'precision': 0.3606867693942614, 'recall': 0.48923423423423423, 'f1-score': 0.41523933323138096, 'support': 22200}, '2': {'precision': 0.38167762244236647, 'recall': 0.36296002817397427, 'f1-score': 0.3720835777787806, 'support': 22716}, 'accuracy': 0.37236721093973796, 'macro avg': {'precision': 0.3750124514224467, 'recall': 0.3711228084072385, 'f1-score': 0.3659275348492677, 'support': 66327}, 'weighted avg': {'precision': 0.37497317759822374, 'recall': 0.37236721093973796, 'f1-score': 0.36663525033385924, 'support': 66327}}
[[ 5592  9342  6477]
 [ 4459 10861  6880]
 [ 4562  9909  8245]]
Evaluating performance on  val set...
86/86 - 1s - 853ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070697
{'0': {'precision': 0.3464770523594053, 'recall': 0.21480096179535133, 'f1-score': 0.26519337016574585, 'support': 7486}, '1': {'precision': 0.3888390632785252, 'recall': 0.4650220474317721, 'f1-score': 0.42353196570064033, 'support': 8391}, '2': {'precision': 0.281482502066685, 'recall': 0.337295690936107, 'f1-score': 0.3068719489297784, 'support': 6057}, 'accuracy': 0.3443512355247561, 'macro avg': {'precision': 0.3389328725682052, 'recall': 0.3390395667210768, 'f1-score': 0.33186576159872155, 'support': 21934}, 'weighted avg': {'precision': 0.34473490056307665, 'recall': 0.3443512355247561, 'f1-score': 0.33727626916761716, 'support': 21934}}
[[1608 3433 2445]
 [1719 3902 2770]
 [1314 2700 2043]]
training model: results/LILAK/W3/deepVOL_L2/h10
Epoch 1/50
260/260 - 8s - loss: 3.3477 - accuracy10: 0.3465 - val_loss: 3.3429 - val_accuracy10: 0.3446 - 8s/epoch - 31ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3017 - accuracy10: 0.3625 - val_loss: 3.3324 - val_accuracy10: 0.3399 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2855 - accuracy10: 0.3730 - val_loss: 3.3148 - val_accuracy10: 0.3500 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2712 - accuracy10: 0.3831 - val_loss: 3.3165 - val_accuracy10: 0.3453 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2595 - accuracy10: 0.3897 - val_loss: 3.3158 - val_accuracy10: 0.3506 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2521 - accuracy10: 0.3924 - val_loss: 3.3155 - val_accuracy10: 0.3628 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2400 - accuracy10: 0.4006 - val_loss: 3.3028 - val_accuracy10: 0.3659 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2305 - accuracy10: 0.4061 - val_loss: 3.3127 - val_accuracy10: 0.3685 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2192 - accuracy10: 0.4110 - val_loss: 3.3093 - val_accuracy10: 0.3643 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2080 - accuracy10: 0.4173 - val_loss: 3.3257 - val_accuracy10: 0.3661 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.1985 - accuracy10: 0.4197 - val_loss: 3.3273 - val_accuracy10: 0.3615 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.1884 - accuracy10: 0.4262 - val_loss: 3.3116 - val_accuracy10: 0.3622 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.1792 - accuracy10: 0.4274 - val_loss: 3.3267 - val_accuracy10: 0.3590 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1715 - accuracy10: 0.4324 - val_loss: 3.3423 - val_accuracy10: 0.3605 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1634 - accuracy10: 0.4356 - val_loss: 3.3289 - val_accuracy10: 0.3645 - 6s/epoch - 22ms/step
Epoch 16/50
260/260 - 6s - loss: 3.1550 - accuracy10: 0.4380 - val_loss: 3.3378 - val_accuracy10: 0.3645 - 6s/epoch - 22ms/step
Epoch 17/50
260/260 - 6s - loss: 3.1465 - accuracy10: 0.4431 - val_loss: 3.3605 - val_accuracy10: 0.3701 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h10
Evaluating performance on  test set...
678/678 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.095246
{'0': {'precision': 0.3182270365867138, 'recall': 0.47278101650381804, 'f1-score': 0.38040498133650447, 'support': 48716}, '1': {'precision': 0.4670874966243586, 'recall': 0.3680395781522216, 'f1-score': 0.4116898862698135, 'support': 75193}, '2': {'precision': 0.34248707144225243, 'recall': 0.2890891821433624, 'f1-score': 0.31353081062125343, 'support': 49483}, 'accuracy': 0.37493655993356095, 'macro avg': {'precision': 0.375933868217775, 'recall': 0.37663659226646734, 'f1-score': 0.36854189274252375, 'support': 173392}, 'weighted avg': {'precision': 0.3897050971452589, 'recall': 0.37493655993356095, 'f1-score': 0.37488726002956724, 'support': 173392}}
[[23032 15141 10543]
 [30599 27674 16920]
 [18745 16433 14305]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0905074
{'0': {'precision': 0.3338059119586021, 'recall': 0.4957363933045584, 'f1-score': 0.39896636448360584, 'support': 18998}, '1': {'precision': 0.502501236875378, 'recall': 0.31677987247019684, 'f1-score': 0.3885901332709844, 'support': 28856}, '2': {'precision': 0.3269925717727364, 'recall': 0.352638700947226, 'f1-score': 0.3393317534310789, 'support': 18475}, 'accuracy': 0.3780246950805832, 'macro avg': {'precision': 0.38776657353557215, 'recall': 0.38838498890732703, 'f1-score': 0.37562941706188974, 'support': 66329}, 'weighted avg': {'precision': 0.40529795670320273, 'recall': 0.3780246950805832, 'f1-score': 0.3778418794609636, 'support': 66329}}
[[ 9418  4411  5169]
 [11475  9141  8240]
 [ 7321  4639  6515]]
Evaluating performance on  val set...
86/86 - 1s - 760ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0969841
{'0': {'precision': 0.33455708195168166, 'recall': 0.44140625, 'f1-score': 0.3806251684182161, 'support': 6400}, '1': {'precision': 0.4506329113924051, 'recall': 0.3252364574376612, 'f1-score': 0.3778013608839503, 'support': 9304}, '2': {'precision': 0.33047970479704797, 'recall': 0.3593900481540931, 'f1-score': 0.34432910419069584, 'support': 6230}, 'accuracy': 0.36883377404942097, 'macro avg': {'precision': 0.37188989938037825, 'recall': 0.37534425186391807, 'f1-score': 0.36758521116428744, 'support': 21934}, 'weighted avg': {'precision': 0.38263620374629836, 'recall': 0.36883377404942097, 'f1-score': 0.3691180477181039, 'support': 21934}}
[[2825 1831 1744]
 [3486 3026 2792]
 [2133 1858 2239]]
training model: results/LILAK/W3/deepVOL_L2/h20
Epoch 1/50
260/260 - 8s - loss: 3.3524 - accuracy20: 0.3485 - val_loss: 3.3329 - val_accuracy20: 0.3476 - 8s/epoch - 30ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3081 - accuracy20: 0.3569 - val_loss: 3.3173 - val_accuracy20: 0.3416 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2898 - accuracy20: 0.3671 - val_loss: 3.3025 - val_accuracy20: 0.3472 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2771 - accuracy20: 0.3764 - val_loss: 3.2988 - val_accuracy20: 0.3570 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2692 - accuracy20: 0.3807 - val_loss: 3.2999 - val_accuracy20: 0.3576 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2612 - accuracy20: 0.3888 - val_loss: 3.2950 - val_accuracy20: 0.3650 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2486 - accuracy20: 0.3962 - val_loss: 3.2932 - val_accuracy20: 0.3698 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2398 - accuracy20: 0.3997 - val_loss: 3.2951 - val_accuracy20: 0.3681 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2285 - accuracy20: 0.4083 - val_loss: 3.2927 - val_accuracy20: 0.3713 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2185 - accuracy20: 0.4131 - val_loss: 3.2984 - val_accuracy20: 0.3711 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2157 - accuracy20: 0.4145 - val_loss: 3.2931 - val_accuracy20: 0.3806 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2086 - accuracy20: 0.4171 - val_loss: 3.3033 - val_accuracy20: 0.3812 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2013 - accuracy20: 0.4220 - val_loss: 3.3156 - val_accuracy20: 0.3765 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1915 - accuracy20: 0.4262 - val_loss: 3.3141 - val_accuracy20: 0.3842 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1815 - accuracy20: 0.4342 - val_loss: 3.3265 - val_accuracy20: 0.3783 - 6s/epoch - 22ms/step
Epoch 16/50
260/260 - 6s - loss: 3.1811 - accuracy20: 0.4335 - val_loss: 3.3123 - val_accuracy20: 0.3831 - 6s/epoch - 22ms/step
Epoch 17/50
260/260 - 6s - loss: 3.1738 - accuracy20: 0.4363 - val_loss: 3.3522 - val_accuracy20: 0.3823 - 6s/epoch - 22ms/step
Epoch 18/50
260/260 - 6s - loss: 3.1649 - accuracy20: 0.4383 - val_loss: 3.3349 - val_accuracy20: 0.3889 - 6s/epoch - 22ms/step
Epoch 19/50
260/260 - 6s - loss: 3.1605 - accuracy20: 0.4416 - val_loss: 3.3286 - val_accuracy20: 0.3828 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h20
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0966742
{'0': {'precision': 0.3627875079130618, 'recall': 0.5825892478948171, 'f1-score': 0.4471362344848213, 'support': 59021}, '1': {'precision': 0.36148552579195814, 'recall': 0.22930947398802223, 'f1-score': 0.28061190702192, 'support': 55436}, '2': {'precision': 0.41265018643833723, 'recall': 0.30419954186815984, 'f1-score': 0.35022123245524067, 'support': 58935}, 'accuracy': 0.37501730183630155, 'macro avg': {'precision': 0.3789744067144524, 'recall': 0.3720327545836664, 'f1-score': 0.359323124653994, 'support': 173392}, 'weighted avg': {'precision': 0.3793192987570546, 'recall': 0.37501730183630155, 'f1-score': 0.36095504814492835, 'support': 173392}}
[[34385 11892 12744]
 [29950 12712 12774]
 [30445 10562 17928]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0880058
{'0': {'precision': 0.3811629112418819, 'recall': 0.5522130930294196, 'f1-score': 0.4510147019031298, 'support': 22638}, '1': {'precision': 0.4139660205074471, 'recall': 0.2584217165817876, 'f1-score': 0.31820273846507885, 'support': 21403}, '2': {'precision': 0.4021615190124436, 'recall': 0.3639626704953338, 'f1-score': 0.3821098000423938, 'support': 22288}, 'accuracy': 0.39415640217702663, 'macro avg': {'precision': 0.39909681692059085, 'recall': 0.39153249336884705, 'f1-score': 0.3837757468035341, 'support': 66329}, 'weighted avg': {'precision': 0.39880379106218933, 'recall': 0.39415640217702663, 'f1-score': 0.3850054615084806, 'support': 66329}}
[[12501  4107  6030]
 [ 9843  5531  6029]
 [10453  3723  8112]]
Evaluating performance on  val set...
86/86 - 1s - 784ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0961242
{'0': {'precision': 0.37600556162478893, 'recall': 0.4938046171905569, 'f1-score': 0.42692828146143436, 'support': 7667}, '1': {'precision': 0.33387064275639733, 'recall': 0.24239321240491515, 'f1-score': 0.2808712602762946, 'support': 6836}, '2': {'precision': 0.3982903506230078, 'recall': 0.36993675144664245, 'f1-score': 0.3835903160538617, 'support': 7431}, 'accuracy': 0.3734840886295249, 'macro avg': {'precision': 0.36938885166806473, 'recall': 0.3687115270140382, 'f1-score': 0.36379661926386353, 'support': 21934}, 'weighted avg': {'precision': 0.37042354109325976, 'recall': 0.3734840886295249, 'f1-score': 0.3667253901618407, 'support': 21934}}
[[3786 1779 2102]
 [3128 1657 2051]
 [3155 1527 2749]]
training model: results/LILAK/W3/deepVOL_L2/h30
Epoch 1/50
260/260 - 8s - loss: 3.3520 - accuracy30: 0.3455 - val_loss: 3.3325 - val_accuracy30: 0.3492 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3148 - accuracy30: 0.3558 - val_loss: 3.3270 - val_accuracy30: 0.3549 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2939 - accuracy30: 0.3650 - val_loss: 3.3186 - val_accuracy30: 0.3517 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2838 - accuracy30: 0.3691 - val_loss: 3.3122 - val_accuracy30: 0.3557 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2697 - accuracy30: 0.3815 - val_loss: 3.3051 - val_accuracy30: 0.3627 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2572 - accuracy30: 0.3906 - val_loss: 3.3090 - val_accuracy30: 0.3635 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2505 - accuracy30: 0.3986 - val_loss: 3.3084 - val_accuracy30: 0.3677 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2425 - accuracy30: 0.4023 - val_loss: 3.3166 - val_accuracy30: 0.3655 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2329 - accuracy30: 0.4059 - val_loss: 3.3171 - val_accuracy30: 0.3685 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2237 - accuracy30: 0.4113 - val_loss: 3.3224 - val_accuracy30: 0.3721 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2159 - accuracy30: 0.4170 - val_loss: 3.3328 - val_accuracy30: 0.3697 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2098 - accuracy30: 0.4188 - val_loss: 3.3268 - val_accuracy30: 0.3759 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2017 - accuracy30: 0.4236 - val_loss: 3.3324 - val_accuracy30: 0.3746 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.1954 - accuracy30: 0.4270 - val_loss: 3.3574 - val_accuracy30: 0.3762 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.1898 - accuracy30: 0.4284 - val_loss: 3.3579 - val_accuracy30: 0.3769 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h30
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1020428
{'0': {'precision': 0.3568481254908902, 'recall': 0.5504214585537317, 'f1-score': 0.4329845707804541, 'support': 58606}, '1': {'precision': 0.3633431661750246, 'recall': 0.1625692916849978, 'f1-score': 0.22463221884498483, 'support': 56825}, '2': {'precision': 0.3720166753517457, 'recall': 0.3695070823484757, 'f1-score': 0.37075763215067814, 'support': 57961}, 'accuracy': 0.3628368090800037, 'macro avg': {'precision': 0.3640693223392202, 'recall': 0.36083261086240176, 'f1-score': 0.34279147392537235, 'support': 173392}, 'weighted avg': {'precision': 0.36404721775213056, 'recall': 0.3628368090800037, 'f1-score': 0.34390111832213144, 'support': 173392}}
[[32258  8459 17889]
 [29323  9238 18264]
 [28816  7728 21417]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0980287
{'0': {'precision': 0.3627801730728068, 'recall': 0.5307090136434802, 'f1-score': 0.43096371099567726, 'support': 22355}, '1': {'precision': 0.4075772200772201, 'recall': 0.15432408972543288, 'f1-score': 0.22387911323193163, 'support': 21889}, '2': {'precision': 0.36822164338148233, 'recall': 0.4224586823635952, 'f1-score': 0.39347995698289856, 'support': 22085}, 'accuracy': 0.37045636147084987, 'macro avg': {'precision': 0.3795263455105031, 'recall': 0.3691639285775028, 'f1-score': 0.3494409270701691, 'support': 66329}, 'weighted avg': {'precision': 0.3793752888388624, 'recall': 0.37045636147084987, 'f1-score': 0.35014380616034363, 'support': 66329}}
[[11864  2548  7943]
 [10446  3378  8065]
 [10393  2362  9330]]
Evaluating performance on  val set...
86/86 - 1s - 751ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1027325
{'0': {'precision': 0.3637274549098196, 'recall': 0.47933447774990096, 'f1-score': 0.4136045120492223, 'support': 7573}, '1': {'precision': 0.3409295352323838, 'recall': 0.1621043627031651, 'f1-score': 0.21973137501207848, 'support': 7014}, '2': {'precision': 0.36906833739412925, 'recall': 0.4329658363958078, 'f1-score': 0.3984717524740073, 'support': 7347}, 'accuracy': 0.3623598066928057, 'macro avg': {'precision': 0.3579084425121109, 'recall': 0.358134892282958, 'f1-score': 0.34393587984510265, 'support': 21934}, 'weighted avg': {'precision': 0.3582261717418926, 'recall': 0.3623598066928057, 'f1-score': 0.3465393817593695, 'support': 21934}}
[[3630 1179 2764]
 [3203 1137 2674]
 [3147 1019 3181]]
training model: results/LILAK/W3/deepVOL_L2/h50
Epoch 1/50
260/260 - 8s - loss: 3.3571 - accuracy50: 0.3396 - val_loss: 3.3535 - val_accuracy50: 0.3381 - 8s/epoch - 30ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3193 - accuracy50: 0.3478 - val_loss: 3.3275 - val_accuracy50: 0.3418 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2984 - accuracy50: 0.3594 - val_loss: 3.3265 - val_accuracy50: 0.3508 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2848 - accuracy50: 0.3690 - val_loss: 3.3197 - val_accuracy50: 0.3526 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2752 - accuracy50: 0.3769 - val_loss: 3.3156 - val_accuracy50: 0.3557 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2713 - accuracy50: 0.3799 - val_loss: 3.3116 - val_accuracy50: 0.3561 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2639 - accuracy50: 0.3864 - val_loss: 3.3221 - val_accuracy50: 0.3504 - 6s/epoch - 21ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2568 - accuracy50: 0.3914 - val_loss: 3.3174 - val_accuracy50: 0.3586 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2513 - accuracy50: 0.3935 - val_loss: 3.3243 - val_accuracy50: 0.3605 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2479 - accuracy50: 0.3975 - val_loss: 3.3243 - val_accuracy50: 0.3614 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2390 - accuracy50: 0.4036 - val_loss: 3.3254 - val_accuracy50: 0.3655 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2271 - accuracy50: 0.4100 - val_loss: 3.3371 - val_accuracy50: 0.3648 - 6s/epoch - 23ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2243 - accuracy50: 0.4114 - val_loss: 3.3472 - val_accuracy50: 0.3601 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2217 - accuracy50: 0.4149 - val_loss: 3.3533 - val_accuracy50: 0.3652 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2129 - accuracy50: 0.4180 - val_loss: 3.3605 - val_accuracy50: 0.3636 - 6s/epoch - 22ms/step
Epoch 16/50
260/260 - 6s - loss: 3.2073 - accuracy50: 0.4207 - val_loss: 3.3679 - val_accuracy50: 0.3622 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h50
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011465
{'0': {'precision': 0.3498633523468242, 'recall': 0.5403625536386724, 'f1-score': 0.4247305166646016, 'support': 57095}, '1': {'precision': 0.36784281546316555, 'recall': 0.27088089163421514, 'f1-score': 0.3120021653391076, 'support': 59576}, '2': {'precision': 0.37223310835329126, 'recall': 0.27127518908340825, 'f1-score': 0.3138346692773665, 'support': 56721}, 'accuracy': 0.35974554766079175, 'macro avg': {'precision': 0.36331309205442697, 'recall': 0.36083954478543195, 'f1-score': 0.35018911709369194, 'support': 173392}, 'weighted avg': {'precision': 0.3633586660006373, 'recall': 0.35974554766079175, 'f1-score': 0.34972112973660613, 'support': 173392}}
[[30852 13904 12339]
 [29827 16138 13611]
 [27504 13830 15387]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0956353
{'0': {'precision': 0.36687130844656524, 'recall': 0.5641610738255034, 'f1-score': 0.444612916306705, 'support': 22350}, '1': {'precision': 0.3771892353695002, 'recall': 0.2454823463997776, 'f1-score': 0.2974065341865948, 'support': 21582}, '2': {'precision': 0.3853410740203193, 'recall': 0.3082109211055052, 'f1-score': 0.3424871623130163, 'support': 22397}, 'accuracy': 0.3740445355726756, 'macro avg': {'precision': 0.3764672059454616, 'recall': 0.3726181137769287, 'f1-score': 0.36150220426877205, 'support': 66329}, 'weighted avg': {'precision': 0.37646513374780827, 'recall': 0.3740445355726756, 'f1-score': 0.36223087148297983, 'support': 66329}}
[[12609  4239  5502]
 [10775  5298  5509]
 [10985  4509  6903]]
Evaluating performance on  val set...
86/86 - 1s - 781ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1037438
{'0': {'precision': 0.36010185094505925, 'recall': 0.4911179377587819, 'f1-score': 0.41552717821222734, 'support': 7487}, '1': {'precision': 0.33300099700897307, 'recall': 0.23226703755215578, 'f1-score': 0.2736583367472347, 'support': 7190}, '2': {'precision': 0.3688133571854502, 'recall': 0.34091222268154886, 'f1-score': 0.35431435732187616, 'support': 7257}, 'accuracy': 0.3565697091273822, 'macro avg': {'precision': 0.35397206837982753, 'recall': 0.35476573266416217, 'f1-score': 0.34783329076044606, 'support': 21934}, 'weighted avg': {'precision': 0.3541004039215368, 'recall': 0.3565697091273822, 'f1-score': 0.3487697052782173, 'support': 21934}}
[[3677 1718 2092]
 [3378 1670 2142]
 [3156 1627 2474]]
training model: results/LILAK/W3/deepVOL_L2/h100
Epoch 1/50
260/260 - 8s - loss: 3.3509 - accuracy100: 0.3436 - val_loss: 3.3521 - val_accuracy100: 0.3370 - 8s/epoch - 30ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3113 - accuracy100: 0.3545 - val_loss: 3.3328 - val_accuracy100: 0.3419 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.2937 - accuracy100: 0.3640 - val_loss: 3.3277 - val_accuracy100: 0.3385 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2836 - accuracy100: 0.3693 - val_loss: 3.3343 - val_accuracy100: 0.3462 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2707 - accuracy100: 0.3792 - val_loss: 3.3170 - val_accuracy100: 0.3518 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2626 - accuracy100: 0.3857 - val_loss: 3.3240 - val_accuracy100: 0.3477 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2579 - accuracy100: 0.3875 - val_loss: 3.3340 - val_accuracy100: 0.3491 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2491 - accuracy100: 0.3931 - val_loss: 3.3393 - val_accuracy100: 0.3495 - 6s/epoch - 21ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2435 - accuracy100: 0.3980 - val_loss: 3.3477 - val_accuracy100: 0.3512 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2335 - accuracy100: 0.4029 - val_loss: 3.3524 - val_accuracy100: 0.3576 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2324 - accuracy100: 0.4076 - val_loss: 3.3601 - val_accuracy100: 0.3543 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2245 - accuracy100: 0.4098 - val_loss: 3.3682 - val_accuracy100: 0.3563 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2204 - accuracy100: 0.4136 - val_loss: 3.3788 - val_accuracy100: 0.3527 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2090 - accuracy100: 0.4179 - val_loss: 3.3950 - val_accuracy100: 0.3566 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2038 - accuracy100: 0.4218 - val_loss: 3.4119 - val_accuracy100: 0.3521 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h100
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1160234
{'0': {'precision': 0.4049357794533832, 'recall': 0.3110945553511426, 'f1-score': 0.35186586414445403, 'support': 65771}, '1': {'precision': 0.2677690480540837, 'recall': 0.5262709011334306, 'f1-score': 0.35494198587679654, 'support': 44555}, '2': {'precision': 0.4192661850120414, 'recall': 0.2346430723369169, 'f1-score': 0.3008916135460193, 'support': 63066}, 'accuracy': 0.33857963458521734, 'macro avg': {'precision': 0.3639903375065028, 'recall': 0.35733617627383, 'f1-score': 0.33589982118908995, 'support': 173392}, 'weighted avg': {'precision': 0.37490150820365165, 'recall': 0.33857963458521734, 'f1-score': 0.33411599399787073, 'support': 173392}}
[[20461 33509 11801]
 [12411 23448  8696]
 [17657 30611 14798]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977341
{'0': {'precision': 0.36877989213391676, 'recall': 0.33035551504102095, 'f1-score': 0.34851180458720005, 'support': 21940}, '1': {'precision': 0.3622582498244718, 'recall': 0.5179321043986129, 'f1-score': 0.4263286384976526, 'support': 21916}, '2': {'precision': 0.3840036503487387, 'recall': 0.26213678636586124, 'f1-score': 0.31157772253662663, 'support': 22473}, 'accuracy': 0.36922009980551496, 'macro avg': {'precision': 0.3716805974357091, 'recall': 0.37014146860183167, 'f1-score': 0.3621393885404931, 'support': 66329}, 'weighted avg': {'precision': 0.37178303111547684, 'recall': 0.36922009980551496, 'f1-score': 0.3617098643507867, 'support': 66329}}
[[ 7248  9926  4766]
 [ 5881 11351  4684]
 [ 6525 10057  5891]]
Evaluating performance on  val set...
86/86 - 1s - 772ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1071888
{'0': {'precision': 0.343708229902616, 'recall': 0.24255491173696267, 'f1-score': 0.28440511929214723, 'support': 7421}, '1': {'precision': 0.35138101335284433, 'recall': 0.5123349779970663, 'f1-score': 0.4168610643953779, 'support': 7499}, '2': {'precision': 0.34443866041992016, 'recall': 0.28300541773595667, 'f1-score': 0.3107145652344056, 'support': 7014}, 'accuracy': 0.34772499316130207, 'macro avg': {'precision': 0.3465093012251268, 'recall': 0.34596510248999524, 'f1-score': 0.33732691630731026, 'support': 21934}, 'weighted avg': {'precision': 0.3465650477535157, 'recall': 0.34772499316130207, 'f1-score': 0.3381035594384099, 'support': 21934}}
[[1800 3720 1901]
 [1780 3842 1877]
 [1657 3372 1985]]
training model: results/LILAK/W3/deepVOL_L2/h200
Epoch 1/50
260/260 - 8s - loss: 3.3564 - accuracy200: 0.3448 - val_loss: 3.3674 - val_accuracy200: 0.3314 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3172 - accuracy200: 0.3521 - val_loss: 3.3664 - val_accuracy200: 0.3280 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3021 - accuracy200: 0.3578 - val_loss: 3.3639 - val_accuracy200: 0.3327 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2928 - accuracy200: 0.3631 - val_loss: 3.3419 - val_accuracy200: 0.3384 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2812 - accuracy200: 0.3716 - val_loss: 3.3517 - val_accuracy200: 0.3367 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2749 - accuracy200: 0.3760 - val_loss: 3.3580 - val_accuracy200: 0.3366 - 6s/epoch - 21ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2684 - accuracy200: 0.3810 - val_loss: 3.3499 - val_accuracy200: 0.3397 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2604 - accuracy200: 0.3879 - val_loss: 3.3716 - val_accuracy200: 0.3437 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2520 - accuracy200: 0.3936 - val_loss: 3.3617 - val_accuracy200: 0.3467 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2457 - accuracy200: 0.3959 - val_loss: 3.3736 - val_accuracy200: 0.3419 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2363 - accuracy200: 0.4046 - val_loss: 3.3726 - val_accuracy200: 0.3426 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2297 - accuracy200: 0.4070 - val_loss: 3.3840 - val_accuracy200: 0.3453 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2210 - accuracy200: 0.4132 - val_loss: 3.3816 - val_accuracy200: 0.3511 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2138 - accuracy200: 0.4170 - val_loss: 3.3846 - val_accuracy200: 0.3509 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h200
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129855
{'0': {'precision': 0.3605008311050083, 'recall': 0.353438197470507, 'f1-score': 0.3569345807767303, 'support': 56454}, '1': {'precision': 0.42112222130402444, 'recall': 0.07982331103836093, 'f1-score': 0.13420768481209344, 'support': 63841}, '2': {'precision': 0.32327761154583123, 'recall': 0.6450270260090024, 'f1-score': 0.4306966800804829, 'support': 53097}, 'accuracy': 0.3419880963366245, 'macro avg': {'precision': 0.368300221318288, 'recall': 0.35942951150595676, 'f1-score': 0.3072796485564355, 'support': 173392}, 'weighted avg': {'precision': 0.37142226279021734, 'recall': 0.3419880963366245, 'f1-score': 0.29751683613714464, 'support': 173392}}
[[19953  3765 32736]
 [19787  5096 38958]
 [15608  3240 34249]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028167
{'0': {'precision': 0.35000635835700056, 'recall': 0.37644752439135587, 'f1-score': 0.3627457440966502, 'support': 21934}, '1': {'precision': 0.39214686384497704, 'recall': 0.07016423357664234, 'f1-score': 0.11903103474963239, 'support': 21920}, '2': {'precision': 0.35475061830173127, 'recall': 0.6126807563959955, 'f1-score': 0.4493318758055832, 'support': 22475}, 'accuracy': 0.35527446516606614, 'macro avg': {'precision': 0.36563461350123627, 'recall': 0.3530975047879979, 'f1-score': 0.31036955155062196, 'support': 66329}, 'weighted avg': {'precision': 0.3655402443277565, 'recall': 0.35527446516606614, 'f1-score': 0.3115433572262261, 'support': 66329}}
[[ 8257  1201 12476]
 [ 7812  1538 12570]
 [ 7522  1183 13770]]
Evaluating performance on  val set...
86/86 - 1s - 764ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138741
{'0': {'precision': 0.36957403651115617, 'recall': 0.3520092735703246, 'f1-score': 0.36057787452998213, 'support': 7764}, '1': {'precision': 0.3132848645076008, 'recall': 0.06547865727310402, 'f1-score': 0.1083180987202925, 'support': 7239}, '2': {'precision': 0.3248886841701213, 'recall': 0.6105901024383206, 'f1-score': 0.4241118404569825, 'support': 6931}, 'accuracy': 0.3391538251116987, 'macro avg': {'precision': 0.33591586172962606, 'recall': 0.34269267776058304, 'f1-score': 0.29766927123575243, 'support': 21934}, 'weighted avg': {'precision': 0.3368763300641128, 'recall': 0.3391538251116987, 'f1-score': 0.2973994939680097, 'support': 21934}}
[[2733  560 4471]
 [2442  474 4323]
 [2220  479 4232]]
training model: results/LILAK/W3/deepVOL_L2/h300
Epoch 1/50
260/260 - 8s - loss: 3.3548 - accuracy300: 0.3462 - val_loss: 3.3892 - val_accuracy300: 0.3459 - 8s/epoch - 31ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3241 - accuracy300: 0.3502 - val_loss: 3.3762 - val_accuracy300: 0.3248 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3044 - accuracy300: 0.3587 - val_loss: 3.3418 - val_accuracy300: 0.3300 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2905 - accuracy300: 0.3638 - val_loss: 3.3310 - val_accuracy300: 0.3347 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2822 - accuracy300: 0.3706 - val_loss: 3.3290 - val_accuracy300: 0.3389 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2787 - accuracy300: 0.3708 - val_loss: 3.3415 - val_accuracy300: 0.3312 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2749 - accuracy300: 0.3739 - val_loss: 3.3608 - val_accuracy300: 0.3244 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2638 - accuracy300: 0.3853 - val_loss: 3.3437 - val_accuracy300: 0.3295 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2608 - accuracy300: 0.3867 - val_loss: 3.3426 - val_accuracy300: 0.3361 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2525 - accuracy300: 0.3911 - val_loss: 3.3439 - val_accuracy300: 0.3392 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2397 - accuracy300: 0.3979 - val_loss: 3.3557 - val_accuracy300: 0.3348 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2382 - accuracy300: 0.4003 - val_loss: 3.3623 - val_accuracy300: 0.3347 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2286 - accuracy300: 0.4067 - val_loss: 3.3716 - val_accuracy300: 0.3407 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2225 - accuracy300: 0.4101 - val_loss: 3.3841 - val_accuracy300: 0.3418 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2152 - accuracy300: 0.4148 - val_loss: 3.3874 - val_accuracy300: 0.3384 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h300
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003381
{'0': {'precision': 0.3230527966544694, 'recall': 0.21161162684522905, 'f1-score': 0.2557182593503598, 'support': 52568}, '1': {'precision': 0.43988476412657157, 'recall': 0.38165294645040343, 'f1-score': 0.40870507626397445, 'support': 73614}, '2': {'precision': 0.2943040924769274, 'recall': 0.46809997881804705, 'f1-score': 0.3613929795010589, 'support': 47210}, 'accuracy': 0.3536379994463412, 'macro avg': {'precision': 0.35241388441932275, 'recall': 0.3537881840378932, 'f1-score': 0.34193877170513104, 'support': 173392}, 'weighted avg': {'precision': 0.36482659319219646, 'recall': 0.3536379994463412, 'f1-score': 0.34944158613933124, 'support': 173392}}
[[11124 19778 21666]
 [14195 28095 31324]
 [ 9115 15996 22099]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982937
{'0': {'precision': 0.361186532717893, 'recall': 0.2430013243823355, 'f1-score': 0.29053482213546644, 'support': 21897}, '1': {'precision': 0.3706116381760154, 'recall': 0.3851256190086775, 'f1-score': 0.3777292576419214, 'support': 22011}, '2': {'precision': 0.36126584041219884, 'recall': 0.46282503010570447, 'f1-score': 0.4057874670055724, 'support': 22421}, 'accuracy': 0.3644710458472161, 'macro avg': {'precision': 0.36435467043536907, 'recall': 0.36365065783223915, 'f1-score': 0.3580171822609867, 'support': 66329}, 'weighted avg': {'precision': 0.36434102251952977, 'recall': 0.3644710458472161, 'f1-score': 0.35842844740593977, 'support': 66329}}
[[ 5321  7036  9540]
 [ 4727  8477  8807]
 [ 4684  7360 10377]]
Evaluating performance on  val set...
86/86 - 1s - 777ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088315
{'0': {'precision': 0.34354382657869936, 'recall': 0.19896288209606988, 'f1-score': 0.2519875561700657, 'support': 7328}, '1': {'precision': 0.3724984653161449, 'recall': 0.375355684770506, 'f1-score': 0.3739216169583436, 'support': 8083}, '2': {'precision': 0.29900471451021476, 'recall': 0.4375287444427411, 'f1-score': 0.3552402290266368, 'support': 6523}, 'accuracy': 0.33491383240630984, 'macro avg': {'precision': 0.33834900213501967, 'recall': 0.3372824371031056, 'f1-score': 0.32704980071834866, 'support': 21934}, 'weighted avg': {'precision': 0.34096845122044495, 'recall': 0.33491383240630984, 'f1-score': 0.3276285791661021, 'support': 21934}}
[[1458 2756 3114]
 [1472 3034 3577]
 [1314 2355 2854]]
training model: results/LILAK/W3/deepVOL_L2/h500
Epoch 1/50
260/260 - 8s - loss: 3.3562 - accuracy500: 0.3472 - val_loss: 3.3681 - val_accuracy500: 0.3565 - 8s/epoch - 30ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3291 - accuracy500: 0.3533 - val_loss: 3.3295 - val_accuracy500: 0.3616 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3080 - accuracy500: 0.3587 - val_loss: 3.3292 - val_accuracy500: 0.3519 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.3012 - accuracy500: 0.3576 - val_loss: 3.3070 - val_accuracy500: 0.3674 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2913 - accuracy500: 0.3659 - val_loss: 3.3049 - val_accuracy500: 0.3624 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2827 - accuracy500: 0.3714 - val_loss: 3.3169 - val_accuracy500: 0.3583 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2787 - accuracy500: 0.3730 - val_loss: 3.3213 - val_accuracy500: 0.3576 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2700 - accuracy500: 0.3771 - val_loss: 3.3239 - val_accuracy500: 0.3618 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2621 - accuracy500: 0.3873 - val_loss: 3.3282 - val_accuracy500: 0.3588 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2551 - accuracy500: 0.3904 - val_loss: 3.3579 - val_accuracy500: 0.3510 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2457 - accuracy500: 0.3987 - val_loss: 3.3742 - val_accuracy500: 0.3473 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2407 - accuracy500: 0.4003 - val_loss: 3.3777 - val_accuracy500: 0.3559 - 6s/epoch - 22ms/step
Epoch 13/50
260/260 - 6s - loss: 3.2371 - accuracy500: 0.4026 - val_loss: 3.3681 - val_accuracy500: 0.3567 - 6s/epoch - 22ms/step
Epoch 14/50
260/260 - 6s - loss: 3.2355 - accuracy500: 0.4053 - val_loss: 3.4064 - val_accuracy500: 0.3461 - 6s/epoch - 22ms/step
Epoch 15/50
260/260 - 6s - loss: 3.2226 - accuracy500: 0.4110 - val_loss: 3.4362 - val_accuracy500: 0.3419 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h500
Evaluating performance on  test set...
678/678 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0910246
{'0': {'precision': 0.31607104643697836, 'recall': 0.14520251671254425, 'f1-score': 0.198989558773998, 'support': 50860}, '1': {'precision': 0.4516687936061405, 'recall': 0.6287833597012216, 'f1-score': 0.5257092054405395, 'support': 77114}, '2': {'precision': 0.27461686272671887, 'recall': 0.2580254524637809, 'f1-score': 0.26606275257685147, 'support': 45418}, 'accuracy': 0.3898219064316693, 'macro avg': {'precision': 0.3474522342566126, 'recall': 0.3440037762925156, 'f1-score': 0.330253838930463, 'support': 173392}, 'weighted avg': {'precision': 0.3655180714407283, 'recall': 0.3898219064316693, 'f1-score': 0.3618632158584176, 'support': 173392}}
[[ 7385 31817 11658]
 [ 9329 48488 19297]
 [ 6651 27048 11719]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992551
{'0': {'precision': 0.38409579367516117, 'recall': 0.17164418019666133, 'f1-score': 0.23726134783158426, 'support': 21865}, '1': {'precision': 0.34523692489186003, 'recall': 0.6408887672232868, 'f1-score': 0.44874293198734944, 'support': 21918}, '2': {'precision': 0.36212980466288597, 'recall': 0.2549010911026346, 'f1-score': 0.2991982507288629, 'support': 22546}, 'accuracy': 0.35500309065416336, 'macro avg': {'precision': 0.3638208410766357, 'recall': 0.35581134617419424, 'f1-score': 0.3284008435159322, 'support': 66329}, 'weighted avg': {'precision': 0.36378862977606496, 'recall': 0.35500309065416336, 'f1-score': 0.32819717943236376, 'support': 66329}}
[[ 3753 12923  5189]
 [ 2937 14047  4934]
 [ 3081 13718  5747]]
Evaluating performance on  val set...
86/86 - 1s - 764ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994973
{'0': {'precision': 0.32712456344586727, 'recall': 0.15702710254260968, 'f1-score': 0.212195582405135, 'support': 7158}, '1': {'precision': 0.40440849042600563, 'recall': 0.6248136681573214, 'f1-score': 0.49101148907411585, 'support': 8721}, '2': {'precision': 0.28662420382165604, 'recall': 0.23781998348472336, 'f1-score': 0.25995125913891143, 'support': 6055}, 'accuracy': 0.36532324245463665, 'macro avg': {'precision': 0.33938575256450965, 'recall': 0.3398869180615515, 'f1-score': 0.32105277687272077, 'support': 21934}, 'weighted avg': {'precision': 0.3466724548322623, 'recall': 0.36532324245463665, 'f1-score': 0.33623653000626563, 'support': 21934}}
[[1124 4346 1688]
 [1376 5449 1896]
 [ 936 3679 1440]]
training model: results/LILAK/W3/deepVOL_L2/h1000
Epoch 1/50
260/260 - 8s - loss: 3.3590 - accuracy1000: 0.3470 - val_loss: 3.3836 - val_accuracy1000: 0.3402 - 8s/epoch - 32ms/step
Epoch 2/50
260/260 - 6s - loss: 3.3231 - accuracy1000: 0.3530 - val_loss: 3.3576 - val_accuracy1000: 0.3395 - 6s/epoch - 22ms/step
Epoch 3/50
260/260 - 6s - loss: 3.3018 - accuracy1000: 0.3605 - val_loss: 3.3587 - val_accuracy1000: 0.3394 - 6s/epoch - 22ms/step
Epoch 4/50
260/260 - 6s - loss: 3.2903 - accuracy1000: 0.3629 - val_loss: 3.3676 - val_accuracy1000: 0.3411 - 6s/epoch - 22ms/step
Epoch 5/50
260/260 - 6s - loss: 3.2773 - accuracy1000: 0.3725 - val_loss: 3.3942 - val_accuracy1000: 0.3334 - 6s/epoch - 22ms/step
Epoch 6/50
260/260 - 6s - loss: 3.2647 - accuracy1000: 0.3799 - val_loss: 3.4525 - val_accuracy1000: 0.3267 - 6s/epoch - 22ms/step
Epoch 7/50
260/260 - 6s - loss: 3.2603 - accuracy1000: 0.3818 - val_loss: 3.4659 - val_accuracy1000: 0.3296 - 6s/epoch - 22ms/step
Epoch 8/50
260/260 - 6s - loss: 3.2502 - accuracy1000: 0.3882 - val_loss: 3.5489 - val_accuracy1000: 0.3272 - 6s/epoch - 22ms/step
Epoch 9/50
260/260 - 6s - loss: 3.2429 - accuracy1000: 0.3947 - val_loss: 3.5912 - val_accuracy1000: 0.3241 - 6s/epoch - 22ms/step
Epoch 10/50
260/260 - 6s - loss: 3.2298 - accuracy1000: 0.4000 - val_loss: 3.6408 - val_accuracy1000: 0.3249 - 6s/epoch - 22ms/step
Epoch 11/50
260/260 - 6s - loss: 3.2245 - accuracy1000: 0.4044 - val_loss: 3.6311 - val_accuracy1000: 0.3322 - 6s/epoch - 22ms/step
Epoch 12/50
260/260 - 6s - loss: 3.2168 - accuracy1000: 0.4099 - val_loss: 3.6629 - val_accuracy1000: 0.3330 - 6s/epoch - 22ms/step
testing model: results/LILAK/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
678/678 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054319
{'0': {'precision': 0.36052260862359475, 'recall': 0.23383138055824287, 'f1-score': 0.283674378674433, 'support': 55818}, '1': {'precision': 0.42870959454762514, 'recall': 0.384800065107699, 'f1-score': 0.4055698120760273, 'support': 73724}, '2': {'precision': 0.27555762081784385, 'recall': 0.44627137970353475, 'f1-score': 0.3407274563404315, 'support': 43850}, 'accuracy': 0.35174633201070404, 'macro avg': {'precision': 0.35492994132968797, 'recall': 0.35496760845649217, 'f1-score': 0.3433238823636306, 'support': 173392}, 'weighted avg': {'precision': 0.3680275836800047, 'recall': 0.35174633201070404, 'f1-score': 0.34993116323054385, 'support': 173392}}
[[13052 22234 20532]
 [14440 28369 30915]
 [ 8711 15570 19569]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1059774
{'0': {'precision': 0.34539367797592224, 'recall': 0.2501515363454096, 'f1-score': 0.2901568415359654, 'support': 21447}, '1': {'precision': 0.3473357648933048, 'recall': 0.3737537781386746, 'f1-score': 0.3600608431116905, 'support': 22167}, '2': {'precision': 0.36926103255019854, 'recall': 0.43799251595861766, 'f1-score': 0.400700793427041, 'support': 22715}, 'accuracy': 0.35578706146632694, 'macro avg': {'precision': 0.3539968251398085, 'recall': 0.3539659434809006, 'f1-score': 0.35030615935823234, 'support': 66329}, 'weighted avg': {'precision': 0.3542163226690776, 'recall': 0.35578706146632694, 'f1-score': 0.3513754317474096, 'support': 66329}}
[[5365 7634 8448]
 [5336 8285 8546]
 [4832 7934 9949]]
Evaluating performance on  val set...
86/86 - 1s - 761ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161181
{'0': {'precision': 0.35947103743713915, 'recall': 0.2576769025367156, 'f1-score': 0.30017886305311453, 'support': 7490}, '1': {'precision': 0.3897462058410917, 'recall': 0.3651571274943243, 'f1-score': 0.37705120296113503, 'support': 8369}, '2': {'precision': 0.2879413113250802, 'recall': 0.4134979423868313, 'f1-score': 0.3394823974592878, 'support': 6075}, 'accuracy': 0.34184371295705296, 'macro avg': {'precision': 0.3457195182011037, 'recall': 0.34544399080595706, 'f1-score': 0.3389041544911791, 'support': 21934}, 'weighted avg': {'precision': 0.3512112489007081, 'recall': 0.34184371295705296, 'f1-score': 0.34039558522908453, 'support': 21934}}
[[1930 2652 2908]
 [2009 3056 3304]
 [1430 2133 2512]]
training model: results/LILAK/W3/deepVOL_L3/h10
Epoch 1/50
260/260 - 11s - loss: 3.3486 - accuracy10: 0.3498 - val_loss: 3.3540 - val_accuracy10: 0.3408 - 11s/epoch - 44ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3180 - accuracy10: 0.3542 - val_loss: 3.3374 - val_accuracy10: 0.3861 - 9s/epoch - 34ms/step
Epoch 3/50
260/260 - 9s - loss: 3.2998 - accuracy10: 0.3661 - val_loss: 3.3097 - val_accuracy10: 0.3542 - 9s/epoch - 35ms/step
Epoch 4/50
260/260 - 10s - loss: 3.2869 - accuracy10: 0.3766 - val_loss: 3.3056 - val_accuracy10: 0.3580 - 10s/epoch - 37ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2730 - accuracy10: 0.3806 - val_loss: 3.3029 - val_accuracy10: 0.3563 - 9s/epoch - 34ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2678 - accuracy10: 0.3820 - val_loss: 3.3000 - val_accuracy10: 0.3666 - 9s/epoch - 34ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2549 - accuracy10: 0.3880 - val_loss: 3.3042 - val_accuracy10: 0.3680 - 9s/epoch - 33ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2475 - accuracy10: 0.3914 - val_loss: 3.3252 - val_accuracy10: 0.3800 - 9s/epoch - 35ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2367 - accuracy10: 0.3978 - val_loss: 3.3119 - val_accuracy10: 0.3720 - 9s/epoch - 34ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2266 - accuracy10: 0.4028 - val_loss: 3.3005 - val_accuracy10: 0.3663 - 9s/epoch - 34ms/step
Epoch 11/50
260/260 - 10s - loss: 3.2199 - accuracy10: 0.4067 - val_loss: 3.3001 - val_accuracy10: 0.3680 - 10s/epoch - 38ms/step
Epoch 12/50
260/260 - 10s - loss: 3.2156 - accuracy10: 0.4079 - val_loss: 3.3057 - val_accuracy10: 0.3710 - 10s/epoch - 39ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2034 - accuracy10: 0.4147 - val_loss: 3.3162 - val_accuracy10: 0.3663 - 9s/epoch - 34ms/step
Epoch 14/50
260/260 - 9s - loss: 3.1948 - accuracy10: 0.4184 - val_loss: 3.3299 - val_accuracy10: 0.3630 - 9s/epoch - 35ms/step
Epoch 15/50
260/260 - 9s - loss: 3.1846 - accuracy10: 0.4231 - val_loss: 3.3091 - val_accuracy10: 0.3573 - 9s/epoch - 34ms/step
Epoch 16/50
260/260 - 9s - loss: 3.1779 - accuracy10: 0.4252 - val_loss: 3.3119 - val_accuracy10: 0.3529 - 9s/epoch - 35ms/step
testing model: results/LILAK/W3/deepVOL_L3/h10
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1008322
{'0': {'precision': 0.30121845352514415, 'recall': 0.39886279661712787, 'f1-score': 0.3432311170776514, 'support': 48716}, '1': {'precision': 0.46763485477178424, 'recall': 0.25479765403694493, 'f1-score': 0.32986407031498843, 'support': 75193}, '2': {'precision': 0.3177253585416851, 'recall': 0.43606895297374854, 'f1-score': 0.3676073494211948, 'support': 49483}, 'accuracy': 0.34700562886407676, 'macro avg': {'precision': 0.3621928889462045, 'recall': 0.3632431345426071, 'f1-score': 0.3469008456046116, 'support': 173392}, 'weighted avg': {'precision': 0.3780972001793849, 'recall': 0.34700562886407676, 'f1-score': 0.3443909212083532, 'support': 173392}}
[[19431 10971 18314]
 [28012 19159 28022]
 [17065 10840 21578]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.091771
{'0': {'precision': 0.3155957161981258, 'recall': 0.39709443099273606, 'f1-score': 0.35168523611952823, 'support': 18998}, '1': {'precision': 0.48494983277591974, 'recall': 0.2914471860271694, 'f1-score': 0.36408502532577175, 'support': 28856}, '2': {'precision': 0.3176254833951282, 'recall': 0.4312313937753721, 'f1-score': 0.36581110243812853, 'support': 18475}, 'accuracy': 0.36064164995703235, 'macro avg': {'precision': 0.3727236774563913, 'recall': 0.3732576702650925, 'f1-score': 0.3605271212944762, 'support': 66329}, 'weighted avg': {'precision': 0.3898374858152381, 'recall': 0.36064164995703235, 'f1-score': 0.36101424300296536, 'support': 66329}}
[[ 7544  4587  6867]
 [10197  8410 10249]
 [ 6163  4345  7967]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0929253
{'0': {'precision': 0.3020733214334752, 'recall': 0.34375, 'f1-score': 0.3215669078418475, 'support': 6400}, '1': {'precision': 0.4560487380330722, 'recall': 0.3379191745485813, 'f1-score': 0.388196073589332, 'support': 9304}, '2': {'precision': 0.3346654634523656, 'recall': 0.41669341894060996, 'f1-score': 0.37120183027096587, 'support': 6230}, 'accuracy': 0.3619950761375034, 'macro avg': {'precision': 0.3642625076396377, 'recall': 0.3661208644963971, 'f1-score': 0.3603216039007151, 'support': 21934}, 'weighted avg': {'precision': 0.37664413937914576, 'recall': 0.3619950761375034, 'f1-score': 0.3639277779452488, 'support': 21934}}
[[2200 1967 2233]
 [3232 3144 2928]
 [1851 1783 2596]]
training model: results/LILAK/W3/deepVOL_L3/h20
Epoch 1/50
260/260 - 11s - loss: 3.3530 - accuracy20: 0.3454 - val_loss: 3.3294 - val_accuracy20: 0.3352 - 11s/epoch - 43ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3184 - accuracy20: 0.3477 - val_loss: 3.3198 - val_accuracy20: 0.3372 - 9s/epoch - 35ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3008 - accuracy20: 0.3528 - val_loss: 3.3133 - val_accuracy20: 0.3386 - 9s/epoch - 36ms/step
Epoch 4/50
260/260 - 9s - loss: 3.2951 - accuracy20: 0.3593 - val_loss: 3.3028 - val_accuracy20: 0.3461 - 9s/epoch - 36ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2800 - accuracy20: 0.3728 - val_loss: 3.3034 - val_accuracy20: 0.3478 - 9s/epoch - 35ms/step
Epoch 6/50
260/260 - 10s - loss: 3.2699 - accuracy20: 0.3814 - val_loss: 3.3032 - val_accuracy20: 0.3559 - 10s/epoch - 37ms/step
Epoch 7/50
260/260 - 10s - loss: 3.2592 - accuracy20: 0.3863 - val_loss: 3.3035 - val_accuracy20: 0.3570 - 10s/epoch - 37ms/step
Epoch 8/50
260/260 - 10s - loss: 3.2509 - accuracy20: 0.3977 - val_loss: 3.2962 - val_accuracy20: 0.3630 - 10s/epoch - 37ms/step
Epoch 9/50
260/260 - 10s - loss: 3.2456 - accuracy20: 0.3979 - val_loss: 3.2969 - val_accuracy20: 0.3699 - 10s/epoch - 37ms/step
Epoch 10/50
260/260 - 10s - loss: 3.2345 - accuracy20: 0.4046 - val_loss: 3.2957 - val_accuracy20: 0.3646 - 10s/epoch - 38ms/step
Epoch 11/50
260/260 - 10s - loss: 3.2252 - accuracy20: 0.4100 - val_loss: 3.2903 - val_accuracy20: 0.3667 - 10s/epoch - 38ms/step
Epoch 12/50
260/260 - 10s - loss: 3.2171 - accuracy20: 0.4170 - val_loss: 3.2909 - val_accuracy20: 0.3684 - 10s/epoch - 37ms/step
Epoch 13/50
260/260 - 10s - loss: 3.2095 - accuracy20: 0.4181 - val_loss: 3.2812 - val_accuracy20: 0.3757 - 10s/epoch - 37ms/step
Epoch 14/50
260/260 - 10s - loss: 3.1999 - accuracy20: 0.4236 - val_loss: 3.2834 - val_accuracy20: 0.3776 - 10s/epoch - 37ms/step
Epoch 15/50
260/260 - 10s - loss: 3.1891 - accuracy20: 0.4294 - val_loss: 3.2894 - val_accuracy20: 0.3750 - 10s/epoch - 37ms/step
Epoch 16/50
260/260 - 10s - loss: 3.1845 - accuracy20: 0.4301 - val_loss: 3.2913 - val_accuracy20: 0.3737 - 10s/epoch - 37ms/step
Epoch 17/50
260/260 - 10s - loss: 3.1737 - accuracy20: 0.4359 - val_loss: 3.2879 - val_accuracy20: 0.3793 - 10s/epoch - 37ms/step
Epoch 18/50
260/260 - 9s - loss: 3.1645 - accuracy20: 0.4412 - val_loss: 3.2939 - val_accuracy20: 0.3770 - 9s/epoch - 36ms/step
Epoch 19/50
260/260 - 10s - loss: 3.1578 - accuracy20: 0.4437 - val_loss: 3.3025 - val_accuracy20: 0.3782 - 10s/epoch - 37ms/step
Epoch 20/50
260/260 - 10s - loss: 3.1500 - accuracy20: 0.4482 - val_loss: 3.3083 - val_accuracy20: 0.3728 - 10s/epoch - 37ms/step
Epoch 21/50
260/260 - 10s - loss: 3.1452 - accuracy20: 0.4488 - val_loss: 3.3226 - val_accuracy20: 0.3692 - 10s/epoch - 37ms/step
Epoch 22/50
260/260 - 10s - loss: 3.1325 - accuracy20: 0.4553 - val_loss: 3.2978 - val_accuracy20: 0.3801 - 10s/epoch - 37ms/step
Epoch 23/50
260/260 - 10s - loss: 3.1280 - accuracy20: 0.4571 - val_loss: 3.3060 - val_accuracy20: 0.3802 - 10s/epoch - 37ms/step
testing model: results/LILAK/W3/deepVOL_L3/h20
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1013093
{'0': {'precision': 0.3624339746717295, 'recall': 0.5789634197997323, 'f1-score': 0.44579688590569005, 'support': 59021}, '1': {'precision': 0.35330833374451076, 'recall': 0.25833393462731796, 'f1-score': 0.29844743148900693, 'support': 55436}, '2': {'precision': 0.40151907922024055, 'recall': 0.262814965640112, 'f1-score': 0.3176872352862754, 'support': 58935}, 'accuracy': 0.36899626280335884, 'macro avg': {'precision': 0.3724204625454936, 'recall': 0.3667041066890541, 'f1-score': 0.3539771842269908, 'support': 173392}, 'weighted avg': {'precision': 0.372801186573808, 'recall': 0.36899626280335884, 'f1-score': 0.35514329972928954, 'support': 173392}}
[[34171 13467 11383]
 [29411 14321 11704]
 [30700 12746 15489]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0795872
{'0': {'precision': 0.3986430637828902, 'recall': 0.5113084194716848, 'f1-score': 0.44800092890041415, 'support': 22638}, '1': {'precision': 0.413475997686524, 'recall': 0.334018595523992, 'f1-score': 0.3695242033442742, 'support': 21403}, '2': {'precision': 0.4126880967854822, 'recall': 0.3703786791098349, 'f1-score': 0.3903903903903904, 'support': 22288}, 'accuracy': 0.4067451642569615, 'macro avg': {'precision': 0.40826905275163217, 'recall': 0.4052352313685039, 'f1-score': 0.4026385075450263, 'support': 66329}, 'weighted avg': {'precision': 0.40814878495916673, 'recall': 0.4067451642569615, 'f1-score': 0.40331970289987934, 'support': 66329}}
[[11575  5200  5863]
 [ 8369  7149  5885]
 [ 9092  4941  8255]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0959872
{'0': {'precision': 0.3798233379823338, 'recall': 0.4262423372896831, 'f1-score': 0.40169626943642067, 'support': 7667}, '1': {'precision': 0.3424147684978413, 'recall': 0.33645406670567585, 'f1-score': 0.3394082490961411, 'support': 6836}, '2': {'precision': 0.390443066686829, 'recall': 0.3474633292961916, 'f1-score': 0.36770150954144115, 'support': 7431}, 'accuracy': 0.37156925321418804, 'macro avg': {'precision': 0.37089372438900137, 'recall': 0.37005324443051685, 'f1-score': 0.36960200935800097, 'support': 21934}, 'weighted avg': {'precision': 0.371762346964148, 'recall': 0.37156925321418804, 'f1-score': 0.3707663903525443, 'support': 21934}}
[[3268 2334 2065]
 [2570 2300 1966]
 [2766 2083 2582]]
training model: results/LILAK/W3/deepVOL_L3/h30
Epoch 1/50
260/260 - 11s - loss: 3.3500 - accuracy30: 0.3443 - val_loss: 3.3324 - val_accuracy30: 0.3388 - 11s/epoch - 44ms/step
Epoch 2/50
260/260 - 10s - loss: 3.3203 - accuracy30: 0.3471 - val_loss: 3.3102 - val_accuracy30: 0.3457 - 10s/epoch - 38ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3042 - accuracy30: 0.3524 - val_loss: 3.3067 - val_accuracy30: 0.3475 - 9s/epoch - 36ms/step
Epoch 4/50
260/260 - 9s - loss: 3.2964 - accuracy30: 0.3560 - val_loss: 3.2964 - val_accuracy30: 0.3507 - 9s/epoch - 34ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2851 - accuracy30: 0.3663 - val_loss: 3.2939 - val_accuracy30: 0.3584 - 9s/epoch - 36ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2749 - accuracy30: 0.3779 - val_loss: 3.2946 - val_accuracy30: 0.3597 - 9s/epoch - 36ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2671 - accuracy30: 0.3818 - val_loss: 3.2950 - val_accuracy30: 0.3604 - 9s/epoch - 36ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2597 - accuracy30: 0.3861 - val_loss: 3.2963 - val_accuracy30: 0.3654 - 9s/epoch - 36ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2543 - accuracy30: 0.3940 - val_loss: 3.3017 - val_accuracy30: 0.3580 - 9s/epoch - 36ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2480 - accuracy30: 0.3946 - val_loss: 3.3066 - val_accuracy30: 0.3638 - 9s/epoch - 36ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2385 - accuracy30: 0.3993 - val_loss: 3.3096 - val_accuracy30: 0.3581 - 9s/epoch - 36ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2319 - accuracy30: 0.4039 - val_loss: 3.3094 - val_accuracy30: 0.3618 - 9s/epoch - 36ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2241 - accuracy30: 0.4072 - val_loss: 3.3125 - val_accuracy30: 0.3636 - 9s/epoch - 37ms/step
Epoch 14/50
260/260 - 10s - loss: 3.2196 - accuracy30: 0.4092 - val_loss: 3.3210 - val_accuracy30: 0.3681 - 10s/epoch - 37ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2146 - accuracy30: 0.4130 - val_loss: 3.3548 - val_accuracy30: 0.3659 - 9s/epoch - 37ms/step
testing model: results/LILAK/W3/deepVOL_L3/h30
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0994712
{'0': {'precision': 0.3544305752950627, 'recall': 0.3914786881889226, 'f1-score': 0.3720345716648559, 'support': 58606}, '1': {'precision': 0.3512218812777324, 'recall': 0.2799824021117466, 'f1-score': 0.31158199835494105, 'support': 56825}, '2': {'precision': 0.3595429365066839, 'recall': 0.39304014768551265, 'f1-score': 0.37554606748982045, 'support': 57961}, 'accuracy': 0.3554604595367722, 'macro avg': {'precision': 0.35506513102649295, 'recall': 0.3548337459953939, 'f1-score': 0.35305421250320573, 'support': 173392}, 'weighted avg': {'precision': 0.35508795009120087, 'recall': 0.3554604595367722, 'f1-score': 0.3533965279902623, 'support': 173392}}
[[22943 14828 20835]
 [21170 15910 19745]
 [20619 14561 22781]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0946065
{'0': {'precision': 0.37181136595537023, 'recall': 0.3749049429657795, 'f1-score': 0.3733517462580186, 'support': 22355}, '1': {'precision': 0.36377763296405835, 'recall': 0.33153638814016173, 'f1-score': 0.34690950810268173, 'support': 21889}, '2': {'precision': 0.3633961156088762, 'recall': 0.3922571881367444, 'f1-score': 0.37727549864994336, 'support': 22085}, 'accuracy': 0.36637066743053565, 'macro avg': {'precision': 0.366328371509435, 'recall': 0.3662328397475618, 'f1-score': 0.36584558433688125, 'support': 66329}, 'weighted avg': {'precision': 0.3663582280315489, 'recall': 0.36637066743053565, 'f1-score': 0.36593209453092324, 'support': 66329}}
[[8381 6237 7737]
 [7193 7257 7439]
 [6967 6455 8663]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.098739
{'0': {'precision': 0.36255823803473103, 'recall': 0.3390994321933184, 'f1-score': 0.35043668122270744, 'support': 7573}, '1': {'precision': 0.3419209935262254, 'recall': 0.36897633304818933, 'f1-score': 0.3549338270589042, 'support': 7014}, '2': {'precision': 0.35910464158198296, 'recall': 0.3559275894923098, 'f1-score': 0.3575090573518354, 'support': 7347}, 'accuracy': 0.35429014315674295, 'macro avg': {'precision': 0.35452795771431317, 'recall': 0.3546677849112725, 'f1-score': 0.3542931885444824, 'support': 21934}, 'weighted avg': {'precision': 0.3548020966049417, 'recall': 0.35429014315674295, 'f1-score': 0.3542437263725108, 'support': 21934}}
[[2568 2504 2501]
 [2260 2588 2166]
 [2255 2477 2615]]
training model: results/LILAK/W3/deepVOL_L3/h50
Epoch 1/50
260/260 - 11s - loss: 3.3560 - accuracy50: 0.3421 - val_loss: 3.3424 - val_accuracy50: 0.3310 - 11s/epoch - 44ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3179 - accuracy50: 0.3465 - val_loss: 3.3152 - val_accuracy50: 0.3407 - 9s/epoch - 34ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3032 - accuracy50: 0.3497 - val_loss: 3.3139 - val_accuracy50: 0.3410 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 9s - loss: 3.2966 - accuracy50: 0.3543 - val_loss: 3.3089 - val_accuracy50: 0.3430 - 9s/epoch - 36ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2938 - accuracy50: 0.3556 - val_loss: 3.2983 - val_accuracy50: 0.3508 - 9s/epoch - 36ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2901 - accuracy50: 0.3614 - val_loss: 3.2986 - val_accuracy50: 0.3520 - 9s/epoch - 34ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2805 - accuracy50: 0.3702 - val_loss: 3.2997 - val_accuracy50: 0.3514 - 9s/epoch - 35ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2724 - accuracy50: 0.3748 - val_loss: 3.2996 - val_accuracy50: 0.3584 - 9s/epoch - 35ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2669 - accuracy50: 0.3840 - val_loss: 3.2988 - val_accuracy50: 0.3628 - 9s/epoch - 36ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2615 - accuracy50: 0.3876 - val_loss: 3.3044 - val_accuracy50: 0.3619 - 9s/epoch - 35ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2541 - accuracy50: 0.3936 - val_loss: 3.3126 - val_accuracy50: 0.3635 - 9s/epoch - 35ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2470 - accuracy50: 0.3985 - val_loss: 3.3064 - val_accuracy50: 0.3692 - 9s/epoch - 35ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2426 - accuracy50: 0.4027 - val_loss: 3.3111 - val_accuracy50: 0.3651 - 9s/epoch - 35ms/step
Epoch 14/50
260/260 - 9s - loss: 3.2375 - accuracy50: 0.4049 - val_loss: 3.3059 - val_accuracy50: 0.3736 - 9s/epoch - 35ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2284 - accuracy50: 0.4079 - val_loss: 3.3038 - val_accuracy50: 0.3740 - 9s/epoch - 35ms/step
testing model: results/LILAK/W3/deepVOL_L3/h50
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1013569
{'0': {'precision': 0.3329768175619669, 'recall': 0.436220334530169, 'f1-score': 0.377669777774408, 'support': 57095}, '1': {'precision': 0.36043692070614364, 'recall': 0.2669699207734658, 'f1-score': 0.306741367173563, 'support': 59576}, '2': {'precision': 0.35608717204913065, 'recall': 0.34193684878616387, 'f1-score': 0.3488685829406051, 'support': 56721}, 'accuracy': 0.34722478545722985, 'macro avg': {'precision': 0.34983363677241375, 'recall': 0.34837570136326623, 'f1-score': 0.3444265759628587, 'support': 173392}, 'weighted avg': {'precision': 0.34997186647877904, 'recall': 0.34722478545722985, 'f1-score': 0.34387777144122034, 'support': 173392}}
[[24906 14965 17224]
 [25823 15905 17848]
 [24069 13257 19395]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953981
{'0': {'precision': 0.3647281682136768, 'recall': 0.43073825503355706, 'f1-score': 0.3949943583957329, 'support': 22350}, '1': {'precision': 0.3611223253936213, 'recall': 0.3315726068019646, 'f1-score': 0.3457171844050437, 'support': 21582}, '2': {'precision': 0.36390297246247144, 'recall': 0.3268741349287851, 'f1-score': 0.3443960954957074, 'support': 22397}, 'accuracy': 0.36340062416137736, 'macro avg': {'precision': 0.36325115535658986, 'recall': 0.36306166558810227, 'f1-score': 0.36170254609882796, 'support': 66329}, 'weighted avg': {'precision': 0.3632762661952206, 'recall': 0.36340062416137736, 'f1-score': 0.36187537177994006, 'support': 66329}}
[[9627 6177 6546]
 [8175 7156 6251]
 [8593 6483 7321]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0998456
{'0': {'precision': 0.3529563313152132, 'recall': 0.3659676773073327, 'f1-score': 0.359344262295082, 'support': 7487}, '1': {'precision': 0.33516483516483514, 'recall': 0.3308762169680111, 'f1-score': 0.33300671892497197, 'support': 7190}, '2': {'precision': 0.36010179556058247, 'recall': 0.3509714758164531, 'f1-score': 0.35547801814375435, 'support': 7257}, 'accuracy': 0.34950305461840064, 'macro avg': {'precision': 0.3494076540135436, 'recall': 0.349271790030599, 'f1-score': 0.3492763331212694, 'support': 21934}, 'weighted avg': {'precision': 0.3494883718325573, 'recall': 0.34950305461840064, 'f1-score': 0.34943160292436637, 'support': 21934}}
[[2740 2406 2341]
 [2626 2379 2185]
 [2397 2313 2547]]
training model: results/LILAK/W3/deepVOL_L3/h100
Epoch 1/50
260/260 - 11s - loss: 3.3510 - accuracy100: 0.3445 - val_loss: 3.3589 - val_accuracy100: 0.3378 - 11s/epoch - 44ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3208 - accuracy100: 0.3487 - val_loss: 3.3488 - val_accuracy100: 0.3375 - 9s/epoch - 35ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3079 - accuracy100: 0.3528 - val_loss: 3.3378 - val_accuracy100: 0.3416 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 9s - loss: 3.3014 - accuracy100: 0.3551 - val_loss: 3.3240 - val_accuracy100: 0.3485 - 9s/epoch - 34ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2903 - accuracy100: 0.3607 - val_loss: 3.3167 - val_accuracy100: 0.3495 - 9s/epoch - 35ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2757 - accuracy100: 0.3743 - val_loss: 3.3217 - val_accuracy100: 0.3470 - 9s/epoch - 34ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2776 - accuracy100: 0.3749 - val_loss: 3.3215 - val_accuracy100: 0.3549 - 9s/epoch - 35ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2653 - accuracy100: 0.3814 - val_loss: 3.3199 - val_accuracy100: 0.3557 - 9s/epoch - 34ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2544 - accuracy100: 0.3902 - val_loss: 3.3139 - val_accuracy100: 0.3566 - 9s/epoch - 34ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2445 - accuracy100: 0.3998 - val_loss: 3.3117 - val_accuracy100: 0.3594 - 9s/epoch - 34ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2369 - accuracy100: 0.4043 - val_loss: 3.3174 - val_accuracy100: 0.3625 - 9s/epoch - 35ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2282 - accuracy100: 0.4075 - val_loss: 3.3248 - val_accuracy100: 0.3607 - 9s/epoch - 34ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2215 - accuracy100: 0.4104 - val_loss: 3.3313 - val_accuracy100: 0.3619 - 9s/epoch - 35ms/step
Epoch 14/50
260/260 - 9s - loss: 3.2162 - accuracy100: 0.4161 - val_loss: 3.3391 - val_accuracy100: 0.3609 - 9s/epoch - 34ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2057 - accuracy100: 0.4198 - val_loss: 3.3435 - val_accuracy100: 0.3605 - 9s/epoch - 34ms/step
Epoch 16/50
260/260 - 9s - loss: 3.2003 - accuracy100: 0.4239 - val_loss: 3.3528 - val_accuracy100: 0.3566 - 9s/epoch - 34ms/step
Epoch 17/50
260/260 - 9s - loss: 3.1928 - accuracy100: 0.4268 - val_loss: 3.3617 - val_accuracy100: 0.3551 - 9s/epoch - 34ms/step
Epoch 18/50
260/260 - 9s - loss: 3.1851 - accuracy100: 0.4281 - val_loss: 3.3684 - val_accuracy100: 0.3576 - 9s/epoch - 34ms/step
Epoch 19/50
260/260 - 9s - loss: 3.1729 - accuracy100: 0.4369 - val_loss: 3.3876 - val_accuracy100: 0.3599 - 9s/epoch - 33ms/step
Epoch 20/50
260/260 - 9s - loss: 3.1646 - accuracy100: 0.4386 - val_loss: 3.3928 - val_accuracy100: 0.3628 - 9s/epoch - 34ms/step
testing model: results/LILAK/W3/deepVOL_L3/h100
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1154703
{'0': {'precision': 0.3974093368465515, 'recall': 0.3004059539918809, 'f1-score': 0.34216541978387366, 'support': 65771}, '1': {'precision': 0.26049389923521515, 'recall': 0.4005835484232971, 'f1-score': 0.3156954479928541, 'support': 44555}, '2': {'precision': 0.3984843815152559, 'recall': 0.3485237687501982, 'f1-score': 0.37183336857686616, 'support': 63066}, 'accuracy': 0.34364907262157424, 'macro avg': {'precision': 0.3521292058656742, 'recall': 0.3498377570551254, 'f1-score': 0.3432314121178646, 'support': 173392}, 'weighted avg': {'precision': 0.36261840903156245, 'recall': 0.34364907262157424, 'f1-score': 0.34615446925230353, 'support': 173392}}
[[19758 26434 19579]
 [13107 17848 13600]
 [16852 24234 21980]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0892696
{'0': {'precision': 0.38894260849781015, 'recall': 0.31166818596171375, 'f1-score': 0.34604387540801096, 'support': 21940}, '1': {'precision': 0.3789051505769772, 'recall': 0.4914217922978646, 'f1-score': 0.42789034564958284, 'support': 21916}, '2': {'precision': 0.3843731548907695, 'recall': 0.3476171405686824, 'f1-score': 0.3650723181531416, 'support': 22473}, 'accuracy': 0.3832411162538256, 'macro avg': {'precision': 0.38407363798851896, 'recall': 0.38356903960942024, 'f1-score': 0.37966884640357845, 'support': 66329}, 'weighted avg': {'precision': 0.38407791494440213, 'recall': 0.3832411162538256, 'f1-score': 0.37953410495505085, 'support': 66329}}
[[ 6838  8435  6667]
 [ 5301 10770  5845]
 [ 5442  9219  7812]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104121
{'0': {'precision': 0.37026534332590644, 'recall': 0.24632798814175988, 'f1-score': 0.2958407509305713, 'support': 7421}, '1': {'precision': 0.3569679934717563, 'recall': 0.525003333777837, 'f1-score': 0.4249784110535406, 'support': 7499}, '2': {'precision': 0.3599195710455764, 'recall': 0.30624465355004277, 'f1-score': 0.3309197350177168, 'support': 7014}, 'accuracy': 0.36076411051335827, 'macro avg': {'precision': 0.36238430261441307, 'recall': 0.3591919918232132, 'f1-score': 0.3505796323339429, 'support': 21934}, 'weighted avg': {'precision': 0.3624107762915987, 'recall': 0.36076411051335827, 'f1-score': 0.3512090060436097, 'support': 21934}}
[[1828 3729 1864]
 [1606 3937 1956]
 [1503 3363 2148]]
training model: results/LILAK/W3/deepVOL_L3/h200
Epoch 1/50
260/260 - 11s - loss: 3.3462 - accuracy200: 0.3465 - val_loss: 3.3728 - val_accuracy200: 0.3273 - 11s/epoch - 44ms/step
Epoch 2/50
260/260 - 10s - loss: 3.3240 - accuracy200: 0.3456 - val_loss: 3.3531 - val_accuracy200: 0.3225 - 10s/epoch - 38ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3098 - accuracy200: 0.3483 - val_loss: 3.3296 - val_accuracy200: 0.3222 - 9s/epoch - 35ms/step
Epoch 4/50
260/260 - 9s - loss: 3.2995 - accuracy200: 0.3513 - val_loss: 3.3267 - val_accuracy200: 0.3277 - 9s/epoch - 35ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2921 - accuracy200: 0.3567 - val_loss: 3.3353 - val_accuracy200: 0.3288 - 9s/epoch - 34ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2878 - accuracy200: 0.3613 - val_loss: 3.3353 - val_accuracy200: 0.3258 - 9s/epoch - 34ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2844 - accuracy200: 0.3669 - val_loss: 3.3528 - val_accuracy200: 0.3303 - 9s/epoch - 34ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2867 - accuracy200: 0.3648 - val_loss: 3.3377 - val_accuracy200: 0.3320 - 9s/epoch - 34ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2756 - accuracy200: 0.3737 - val_loss: 3.3505 - val_accuracy200: 0.3383 - 9s/epoch - 35ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2688 - accuracy200: 0.3798 - val_loss: 3.3495 - val_accuracy200: 0.3364 - 9s/epoch - 34ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2623 - accuracy200: 0.3868 - val_loss: 3.3639 - val_accuracy200: 0.3365 - 9s/epoch - 35ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2583 - accuracy200: 0.3916 - val_loss: 3.3692 - val_accuracy200: 0.3357 - 9s/epoch - 34ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2562 - accuracy200: 0.3908 - val_loss: 3.3833 - val_accuracy200: 0.3385 - 9s/epoch - 34ms/step
Epoch 14/50
260/260 - 9s - loss: 3.2448 - accuracy200: 0.4004 - val_loss: 3.3918 - val_accuracy200: 0.3340 - 9s/epoch - 34ms/step
testing model: results/LILAK/W3/deepVOL_L3/h200
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108438
{'0': {'precision': 0.3289453590299624, 'recall': 0.19077479009459028, 'f1-score': 0.241493357250967, 'support': 56454}, '1': {'precision': 0.39914441977581633, 'recall': 0.11545871775191491, 'f1-score': 0.17910774165330223, 'support': 63841}, '2': {'precision': 0.31339618935376157, 'recall': 0.7211706876094695, 'f1-score': 0.4369212863915656, 'support': 53097}, 'accuracy': 0.32546484266863523, 'macro avg': {'precision': 0.34716198938651344, 'recall': 0.3424680651519916, 'f1-score': 0.2858407950986116, 'support': 173392}, 'weighted avg': {'precision': 0.3500303224353031, 'recall': 0.32546484266863523, 'f1-score': 0.27836862639953125, 'support': 173392}}
[[10770  6144 39540]
 [12118  7371 44352]
 [ 9853  4952 38292]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977557
{'0': {'precision': 0.3527489700241512, 'recall': 0.22640649220388437, 'f1-score': 0.2757969565700322, 'support': 21934}, '1': {'precision': 0.39861332120936577, 'recall': 0.15999087591240876, 'f1-score': 0.228335178071489, 'support': 21920}, '2': {'precision': 0.3493199548937933, 'recall': 0.6753726362625139, 'f1-score': 0.4604720300934353, 'support': 22475}, 'accuracy': 0.3565861086402629, 'macro avg': {'precision': 0.36689408204243673, 'recall': 0.35392333479293564, 'f1-score': 0.32153472157831886, 'support': 66329}, 'weighted avg': {'precision': 0.3667440470330781, 'recall': 0.3565861086402629, 'f1-score': 0.32268760911643596, 'support': 66329}}
[[ 4966  2605 14363]
 [ 4502  3507 13911]
 [ 4610  2686 15179]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062303
{'0': {'precision': 0.35846894338757734, 'recall': 0.20144255538382277, 'f1-score': 0.2579368351612105, 'support': 7764}, '1': {'precision': 0.3298785904649097, 'recall': 0.1538886586545103, 'f1-score': 0.20987189148455163, 'support': 7239}, '2': {'precision': 0.3219670283218261, 'recall': 0.6593565142115135, 'f1-score': 0.43266272189349114, 'support': 6931}, 'accuracy': 0.33044588310385703, 'macro avg': {'precision': 0.336771520724771, 'recall': 0.33822924274994887, 'f1-score': 0.3001571495130844, 'support': 21934}, 'weighted avg': {'precision': 0.33749874469477564, 'recall': 0.33044588310385703, 'f1-score': 0.2972859276051835, 'support': 21934}}
[[1564 1230 4970]
 [1471 1114 4654]
 [1328 1033 4570]]
training model: results/LILAK/W3/deepVOL_L3/h300
Epoch 1/50
260/260 - 12s - loss: 3.3517 - accuracy300: 0.3463 - val_loss: 3.3592 - val_accuracy300: 0.3465 - 12s/epoch - 45ms/step
Epoch 2/50
260/260 - 9s - loss: 3.3252 - accuracy300: 0.3473 - val_loss: 3.3602 - val_accuracy300: 0.3291 - 9s/epoch - 35ms/step
Epoch 3/50
260/260 - 9s - loss: 3.3145 - accuracy300: 0.3498 - val_loss: 3.3285 - val_accuracy300: 0.3410 - 9s/epoch - 34ms/step
Epoch 4/50
260/260 - 9s - loss: 3.3032 - accuracy300: 0.3544 - val_loss: 3.3350 - val_accuracy300: 0.3433 - 9s/epoch - 34ms/step
Epoch 5/50
260/260 - 9s - loss: 3.2969 - accuracy300: 0.3552 - val_loss: 3.3421 - val_accuracy300: 0.3247 - 9s/epoch - 34ms/step
Epoch 6/50
260/260 - 9s - loss: 3.2926 - accuracy300: 0.3614 - val_loss: 3.3155 - val_accuracy300: 0.3344 - 9s/epoch - 35ms/step
Epoch 7/50
260/260 - 9s - loss: 3.2831 - accuracy300: 0.3680 - val_loss: 3.3356 - val_accuracy300: 0.3332 - 9s/epoch - 35ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2796 - accuracy300: 0.3720 - val_loss: 3.3250 - val_accuracy300: 0.3360 - 9s/epoch - 35ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2763 - accuracy300: 0.3737 - val_loss: 3.3187 - val_accuracy300: 0.3439 - 9s/epoch - 34ms/step
Epoch 10/50
260/260 - 9s - loss: 3.2717 - accuracy300: 0.3766 - val_loss: 3.3306 - val_accuracy300: 0.3404 - 9s/epoch - 35ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2633 - accuracy300: 0.3835 - val_loss: 3.3438 - val_accuracy300: 0.3337 - 9s/epoch - 34ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2563 - accuracy300: 0.3895 - val_loss: 3.3573 - val_accuracy300: 0.3286 - 9s/epoch - 34ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2465 - accuracy300: 0.3967 - val_loss: 3.3648 - val_accuracy300: 0.3361 - 9s/epoch - 33ms/step
Epoch 14/50
260/260 - 9s - loss: 3.2402 - accuracy300: 0.3981 - val_loss: 3.3725 - val_accuracy300: 0.3350 - 9s/epoch - 34ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2340 - accuracy300: 0.4025 - val_loss: 3.3702 - val_accuracy300: 0.3327 - 9s/epoch - 34ms/step
Epoch 16/50
260/260 - 9s - loss: 3.2229 - accuracy300: 0.4092 - val_loss: 3.3826 - val_accuracy300: 0.3280 - 9s/epoch - 35ms/step
testing model: results/LILAK/W3/deepVOL_L3/h300
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081302
{'0': {'precision': 0.31791626095423564, 'recall': 0.1863300867447877, 'f1-score': 0.23495406462136295, 'support': 52568}, '1': {'precision': 0.4267158671586716, 'recall': 0.19636210503436846, 'f1-score': 0.26895775381666964, 'support': 73614}, '2': {'precision': 0.2858969523581738, 'recall': 0.6583139165431052, 'f1-score': 0.3986608259522694, 'support': 47210}, 'accuracy': 0.31909776690966135, 'macro avg': {'precision': 0.3435096934903603, 'recall': 0.3470020361074204, 'f1-score': 0.3008575481301006, 'support': 173392}, 'weighted avg': {'precision': 0.3553894007318106, 'recall': 0.31909776690966135, 'f1-score': 0.29396338326844823, 'support': 173392}}
[[ 9795 10909 31864]
 [13395 14455 45764]
 [ 7620  8511 31079]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930228
{'0': {'precision': 0.3655584495173893, 'recall': 0.217929396721012, 'f1-score': 0.2730680094990129, 'support': 21897}, '1': {'precision': 0.3953365129835718, 'recall': 0.23724501385670801, 'f1-score': 0.2965360590573538, 'support': 22011}, '2': {'precision': 0.3683921529476364, 'recall': 0.658311404486865, 'f1-score': 0.4724182629987037, 'support': 22421}, 'accuracy': 0.3732002593134225, 'macro avg': {'precision': 0.37642903848286585, 'recall': 0.37116193835486166, 'f1-score': 0.34734077718502343, 'support': 66329}, 'weighted avg': {'precision': 0.37639804335362553, 'recall': 0.3732002593134225, 'f1-score': 0.34824157268472666, 'support': 66329}}
[[ 4772  4071 13054]
 [ 4537  5222 12252]
 [ 3745  3916 14760]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037216
{'0': {'precision': 0.3602680331099724, 'recall': 0.24945414847161573, 'f1-score': 0.29479116271569106, 'support': 7328}, '1': {'precision': 0.35688972274338127, 'recall': 0.21180254855870345, 'f1-score': 0.2658385093167701, 'support': 8083}, '2': {'precision': 0.31625632098151374, 'recall': 0.5848535949716388, 'f1-score': 0.4105240503604864, 'support': 6523}, 'accuracy': 0.3353241542810249, 'macro avg': {'precision': 0.3444713589449558, 'recall': 0.34870343066731935, 'f1-score': 0.3237179074643159, 'support': 21934}, 'weighted avg': {'precision': 0.3459343374362653, 'recall': 0.3353241542810249, 'f1-score': 0.318539741574245, 'support': 21934}}
[[1828 1767 3733]
 [1856 1712 4515]
 [1390 1318 3815]]
training model: results/LILAK/W3/deepVOL_L3/h500
Epoch 1/50
260/260 - 11s - loss: 3.3453 - accuracy500: 0.3482 - val_loss: 3.3890 - val_accuracy500: 0.3645 - 11s/epoch - 43ms/step
Epoch 2/50
260/260 - 10s - loss: 3.3245 - accuracy500: 0.3497 - val_loss: 3.3327 - val_accuracy500: 0.3601 - 10s/epoch - 37ms/step
Epoch 3/50
260/260 - 10s - loss: 3.3027 - accuracy500: 0.3564 - val_loss: 3.3160 - val_accuracy500: 0.3609 - 10s/epoch - 37ms/step
Epoch 4/50
260/260 - 10s - loss: 3.2948 - accuracy500: 0.3581 - val_loss: 3.3116 - val_accuracy500: 0.3637 - 10s/epoch - 37ms/step
Epoch 5/50
260/260 - 10s - loss: 3.2869 - accuracy500: 0.3621 - val_loss: 3.3110 - val_accuracy500: 0.3605 - 10s/epoch - 37ms/step
Epoch 6/50
260/260 - 10s - loss: 3.2860 - accuracy500: 0.3677 - val_loss: 3.3177 - val_accuracy500: 0.3578 - 10s/epoch - 37ms/step
Epoch 7/50
260/260 - 10s - loss: 3.2777 - accuracy500: 0.3741 - val_loss: 3.3199 - val_accuracy500: 0.3707 - 10s/epoch - 37ms/step
Epoch 8/50
260/260 - 9s - loss: 3.2722 - accuracy500: 0.3776 - val_loss: 3.3302 - val_accuracy500: 0.3542 - 9s/epoch - 36ms/step
Epoch 9/50
260/260 - 9s - loss: 3.2715 - accuracy500: 0.3791 - val_loss: 3.3293 - val_accuracy500: 0.3515 - 9s/epoch - 36ms/step
Epoch 10/50
260/260 - 10s - loss: 3.2636 - accuracy500: 0.3837 - val_loss: 3.3359 - val_accuracy500: 0.3505 - 10s/epoch - 37ms/step
Epoch 11/50
260/260 - 10s - loss: 3.2550 - accuracy500: 0.3892 - val_loss: 3.3571 - val_accuracy500: 0.3478 - 10s/epoch - 37ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2484 - accuracy500: 0.3937 - val_loss: 3.3395 - val_accuracy500: 0.3587 - 9s/epoch - 35ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2417 - accuracy500: 0.3967 - val_loss: 3.3535 - val_accuracy500: 0.3624 - 9s/epoch - 35ms/step
Epoch 14/50
260/260 - 9s - loss: 3.2403 - accuracy500: 0.4025 - val_loss: 3.3588 - val_accuracy500: 0.3564 - 9s/epoch - 34ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2386 - accuracy500: 0.4024 - val_loss: 3.3716 - val_accuracy500: 0.3452 - 9s/epoch - 35ms/step
testing model: results/LILAK/W3/deepVOL_L3/h500
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956914
{'0': {'precision': 0.28927353789666926, 'recall': 0.043373967754620525, 'f1-score': 0.07543685668365079, 'support': 50860}, '1': {'precision': 0.44251531354352325, 'recall': 0.5602225276862827, 'f1-score': 0.4944603410781732, 'support': 77114}, '2': {'precision': 0.27359847373055474, 'recall': 0.4104760227222687, 'f1-score': 0.32834322548829675, 'support': 45418}, 'accuracy': 0.36939420503829473, 'macro avg': {'precision': 0.33512910839024906, 'recall': 0.33802417272105734, 'f1-score': 0.2994134744167069, 'support': 173392}, 'weighted avg': {'precision': 0.35332006958749074, 'recall': 0.36939420503829473, 'f1-score': 0.32803835175821366, 'support': 173392}}
[[ 2206 29819 18835]
 [ 3251 43201 30662]
 [ 2169 24606 18643]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973815
{'0': {'precision': 0.37752305008721654, 'recall': 0.06928881774525497, 'f1-score': 0.11708787386969625, 'support': 21865}, '1': {'precision': 0.35237624984569804, 'recall': 0.6511999270006388, 'f1-score': 0.45729939285199356, 'support': 21918}, '2': {'precision': 0.3639447984961717, 'recall': 0.35208019160826753, 'f1-score': 0.35791419618098613, 'support': 22546}, 'accuracy': 0.35770175941141885, 'macro avg': {'precision': 0.3646146994763621, 'recall': 0.35752297878472045, 'f1-score': 0.310767154300892, 'support': 66329}, 'weighted avg': {'precision': 0.3645980425028221, 'recall': 0.35770175941141885, 'f1-score': 0.3113682992625762, 'support': 66329}}
[[ 1515 12930  7420]
 [ 1192 14273  6453]
 [ 1306 13302  7938]]
Evaluating performance on  val set...
86/86 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014428
{'0': {'precision': 0.32275132275132273, 'recall': 0.05113160100586756, 'f1-score': 0.08827785817655572, 'support': 7158}, '1': {'precision': 0.3947497032744537, 'recall': 0.6483201467721592, 'f1-score': 0.49071341780940814, 'support': 8721}, '2': {'precision': 0.2970511039061294, 'recall': 0.3177539223781998, 'f1-score': 0.3070539419087137, 'support': 6055}, 'accuracy': 0.36217744141515457, 'macro avg': {'precision': 0.3381840433106353, 'recall': 0.3390685567187422, 'f1-score': 0.29534840596489254, 'support': 21934}, 'weighted avg': {'precision': 0.34428333020252083, 'recall': 0.3621774414151546, 'f1-score': 0.3086813277925092, 'support': 21934}}
[[ 366 4857 1935]
 [ 449 5654 2618]
 [ 319 3812 1924]]
training model: results/LILAK/W3/deepVOL_L3/h1000
Epoch 1/50
260/260 - 11s - loss: 3.3510 - accuracy1000: 0.3494 - val_loss: 3.5040 - val_accuracy1000: 0.3607 - 11s/epoch - 43ms/step
Epoch 2/50
260/260 - 10s - loss: 3.3368 - accuracy1000: 0.3538 - val_loss: 3.3548 - val_accuracy1000: 0.3633 - 10s/epoch - 39ms/step
Epoch 3/50
260/260 - 10s - loss: 3.3093 - accuracy1000: 0.3501 - val_loss: 3.3356 - val_accuracy1000: 0.3569 - 10s/epoch - 37ms/step
Epoch 4/50
260/260 - 10s - loss: 3.3026 - accuracy1000: 0.3552 - val_loss: 3.3196 - val_accuracy1000: 0.3604 - 10s/epoch - 38ms/step
Epoch 5/50
260/260 - 10s - loss: 3.2926 - accuracy1000: 0.3598 - val_loss: 3.3137 - val_accuracy1000: 0.3519 - 10s/epoch - 37ms/step
Epoch 6/50
260/260 - 10s - loss: 3.2794 - accuracy1000: 0.3715 - val_loss: 3.3308 - val_accuracy1000: 0.3544 - 10s/epoch - 38ms/step
Epoch 7/50
260/260 - 10s - loss: 3.2826 - accuracy1000: 0.3657 - val_loss: 3.3184 - val_accuracy1000: 0.3666 - 10s/epoch - 37ms/step
Epoch 8/50
260/260 - 10s - loss: 3.2757 - accuracy1000: 0.3723 - val_loss: 3.3357 - val_accuracy1000: 0.3650 - 10s/epoch - 37ms/step
Epoch 9/50
260/260 - 10s - loss: 3.2714 - accuracy1000: 0.3717 - val_loss: 3.3339 - val_accuracy1000: 0.3638 - 10s/epoch - 37ms/step
Epoch 10/50
260/260 - 10s - loss: 3.2729 - accuracy1000: 0.3727 - val_loss: 3.3365 - val_accuracy1000: 0.3630 - 10s/epoch - 37ms/step
Epoch 11/50
260/260 - 9s - loss: 3.2719 - accuracy1000: 0.3708 - val_loss: 3.3707 - val_accuracy1000: 0.3522 - 9s/epoch - 36ms/step
Epoch 12/50
260/260 - 9s - loss: 3.2590 - accuracy1000: 0.3824 - val_loss: 3.3686 - val_accuracy1000: 0.3565 - 9s/epoch - 34ms/step
Epoch 13/50
260/260 - 9s - loss: 3.2557 - accuracy1000: 0.3833 - val_loss: 3.3668 - val_accuracy1000: 0.3602 - 9s/epoch - 34ms/step
Epoch 14/50
260/260 - 10s - loss: 3.2614 - accuracy1000: 0.3850 - val_loss: 3.3740 - val_accuracy1000: 0.3578 - 10s/epoch - 37ms/step
Epoch 15/50
260/260 - 9s - loss: 3.2617 - accuracy1000: 0.3826 - val_loss: 3.3770 - val_accuracy1000: 0.3544 - 9s/epoch - 36ms/step
testing model: results/LILAK/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
678/678 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025721
{'0': {'precision': 0.30928112792420637, 'recall': 0.12340105342362678, 'f1-score': 0.17641409161341545, 'support': 55818}, '1': {'precision': 0.42172633016171013, 'recall': 0.4022028104823395, 'f1-score': 0.41173325927725896, 'support': 73724}, '2': {'precision': 0.2705729488924638, 'recall': 0.49863169897377424, 'f1-score': 0.3507941601155142, 'support': 43850}, 'accuracy': 0.33683791639752697, 'macro avg': {'precision': 0.3338601356594601, 'recall': 0.3414118542932469, 'f1-score': 0.3129805036687295, 'support': 173392}, 'weighted avg': {'precision': 0.3473022386975743, 'recall': 0.33683791639752697, 'f1-score': 0.32056858732640237, 'support': 173392}}
[[ 6888 24717 24213]
 [ 9340 29652 34732]
 [ 6043 15942 21865]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0930136
{'0': {'precision': 0.367843053630451, 'recall': 0.16086165897328297, 'f1-score': 0.22383702069681438, 'support': 21447}, '1': {'precision': 0.372436245252306, 'recall': 0.4644742184328055, 'f1-score': 0.4133943628041436, 'support': 22167}, '2': {'precision': 0.3619860092134448, 'recall': 0.46700418225841955, 'f1-score': 0.40784313725490196, 'support': 22715}, 'accuracy': 0.3671697146044717, 'macro avg': {'precision': 0.36742176936540066, 'recall': 0.3641133532215027, 'f1-score': 0.3483581735852866, 'support': 66329}, 'weighted avg': {'precision': 0.3673722869182944, 'recall': 0.3671697146044717, 'f1-score': 0.3502013038928542, 'support': 66329}}
[[ 3450  8268  9729]
 [ 2903 10296  8968]
 [ 3026  9081 10608]]
Evaluating performance on  val set...
86/86 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011688
{'0': {'precision': 0.36845983787767134, 'recall': 0.13351134846461948, 'f1-score': 0.19600156801254406, 'support': 7490}, '1': {'precision': 0.38713152482616786, 'recall': 0.4723383916835942, 'f1-score': 0.4255113024757804, 'support': 8369}, '2': {'precision': 0.31124431124431123, 'recall': 0.46156378600823045, 'f1-score': 0.37178467250066294, 'support': 6075}, 'accuracy': 0.35365186468496396, 'macro avg': {'precision': 0.35561189131605014, 'recall': 0.3558045087188147, 'f1-score': 0.3310991809963291, 'support': 21934}, 'weighted avg': {'precision': 0.3597372621402001, 'recall': 0.35365186468496396, 'f1-score': 0.3322580341148577, 'support': 21934}}
[[1000 3724 2766]
 [ 977 3953 3439]
 [ 737 2534 2804]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        14 (peak)  12.35 (ave)

============================================
