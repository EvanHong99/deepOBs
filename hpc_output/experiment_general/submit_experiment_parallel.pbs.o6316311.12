This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-13.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-05.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-21.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-01.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-25.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-27.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-26.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-28.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-19.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-06.csv
training model: results/XRAY/W1/deepLOB_L1/h10
Epoch 1/50
524/524 - 24s - loss: 3.1897 - accuracy10: 0.4245 - val_loss: 3.7738 - val_accuracy10: 0.3854 - 24s/epoch - 46ms/step
Epoch 2/50
524/524 - 13s - loss: 3.1063 - accuracy10: 0.4389 - val_loss: 3.3501 - val_accuracy10: 0.4131 - 13s/epoch - 26ms/step
Epoch 3/50
524/524 - 13s - loss: 3.0509 - accuracy10: 0.4601 - val_loss: 3.4790 - val_accuracy10: 0.4044 - 13s/epoch - 25ms/step
Epoch 4/50
524/524 - 13s - loss: 3.0010 - accuracy10: 0.4760 - val_loss: 3.4617 - val_accuracy10: 0.4142 - 13s/epoch - 25ms/step
Epoch 5/50
524/524 - 13s - loss: 2.9561 - accuracy10: 0.4965 - val_loss: 3.5271 - val_accuracy10: 0.4139 - 13s/epoch - 25ms/step
Epoch 6/50
524/524 - 13s - loss: 2.9299 - accuracy10: 0.5043 - val_loss: 3.5712 - val_accuracy10: 0.4099 - 13s/epoch - 24ms/step
Epoch 7/50
524/524 - 13s - loss: 2.9029 - accuracy10: 0.5149 - val_loss: 3.5264 - val_accuracy10: 0.4330 - 13s/epoch - 25ms/step
Epoch 8/50
524/524 - 13s - loss: 2.8894 - accuracy10: 0.5164 - val_loss: 3.5334 - val_accuracy10: 0.4373 - 13s/epoch - 25ms/step
Epoch 9/50
524/524 - 14s - loss: 2.8858 - accuracy10: 0.5187 - val_loss: 3.5344 - val_accuracy10: 0.4429 - 14s/epoch - 26ms/step
Epoch 10/50
524/524 - 12s - loss: 2.8625 - accuracy10: 0.5299 - val_loss: 3.4995 - val_accuracy10: 0.4427 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 12s - loss: 2.8489 - accuracy10: 0.5311 - val_loss: 3.5647 - val_accuracy10: 0.4356 - 12s/epoch - 24ms/step
Epoch 12/50
524/524 - 13s - loss: 2.8415 - accuracy10: 0.5324 - val_loss: 3.5145 - val_accuracy10: 0.4438 - 13s/epoch - 25ms/step
testing model: results/XRAY/W1/deepLOB_L1/h10
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0798254
{'0': {'precision': 0.3991427255659074, 'recall': 0.5209009458822224, 'f1-score': 0.4519651180514886, 'support': 108153}, '1': {'precision': 0.4402959719128695, 'recall': 0.2002850666300316, 'f1-score': 0.2753272506226319, 'support': 116464}, '2': {'precision': 0.40631199786129363, 'recall': 0.517286471768415, 'f1-score': 0.4551321959100043, 'support': 111648}, 'accuracy': 0.4086568628908748, 'macro avg': {'precision': 0.4152502317800235, 'recall': 0.4128241614268897, 'f1-score': 0.39414152152804166, 'support': 336265}, 'weighted avg': {'precision': 0.4157763526034756, 'recall': 0.4086568628908748, 'f1-score': 0.39183886440187654, 'support': 336265}}
[[56337 14010 37806]
 [46556 23326 46582]
 [38252 15642 57754]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767349
{'0': {'precision': 0.353491124260355, 'recall': 0.5031160518780529, 'f1-score': 0.4152359769236115, 'support': 35622}, '1': {'precision': 0.5848705915152642, 'recall': 0.2020774466992037, 'f1-score': 0.30037346824326744, 'support': 62288}, '2': {'precision': 0.33595481981325953, 'recall': 0.5749695358369337, 'f1-score': 0.42410499974465043, 'support': 36108}, 'accuracy': 0.38256055156769986, 'macro avg': {'precision': 0.4247721785296263, 'recall': 0.4267210114713967, 'f1-score': 0.3799048149705098, 'support': 134018}, 'weighted avg': {'precision': 0.456305398278756, 'recall': 0.38256055156769986, 'f1-score': 0.36424048926778024, 'support': 134018}}
[[17922  4293 13407]
 [22072 12587 27629]
 [10706  4641 20761]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0717517
{'0': {'precision': 0.4201881677563387, 'recall': 0.6069330876425199, 'f1-score': 0.49658421672555947, 'support': 8683}, '1': {'precision': 0.4822840409956076, 'recall': 0.16688620934238524, 'f1-score': 0.24796747967479674, 'support': 9869}, '2': {'precision': 0.38428609649513956, 'recall': 0.5, 'f1-score': 0.43457213453683624, 'support': 8618}, 'accuracy': 0.4131762973868237, 'macro avg': {'precision': 0.42891943508236197, 'recall': 0.4246064323283017, 'f1-score': 0.39304127697906416, 'support': 27170}, 'weighted avg': {'precision': 0.4313556363934138, 'recall': 0.4131762973868237, 'f1-score': 0.3866092920933771, 'support': 27170}}
[[5270  833 2580]
 [3898 1647 4324]
 [3374  935 4309]]
training model: results/XRAY/W1/deepLOB_L1/h20
Epoch 1/50
524/524 - 16s - loss: 3.1992 - accuracy20: 0.4184 - val_loss: 3.3920 - val_accuracy20: 0.3546 - 16s/epoch - 30ms/step
Epoch 2/50
524/524 - 13s - loss: 3.1452 - accuracy20: 0.4359 - val_loss: 3.5280 - val_accuracy20: 0.2926 - 13s/epoch - 25ms/step
Epoch 3/50
524/524 - 13s - loss: 3.1421 - accuracy20: 0.4355 - val_loss: 3.2453 - val_accuracy20: 0.4471 - 13s/epoch - 25ms/step
Epoch 4/50
524/524 - 14s - loss: 3.0997 - accuracy20: 0.4575 - val_loss: 3.2212 - val_accuracy20: 0.4553 - 14s/epoch - 26ms/step
Epoch 5/50
524/524 - 14s - loss: 3.0657 - accuracy20: 0.4700 - val_loss: 3.2496 - val_accuracy20: 0.4546 - 14s/epoch - 28ms/step
Epoch 6/50
524/524 - 14s - loss: 3.0338 - accuracy20: 0.4810 - val_loss: 3.3074 - val_accuracy20: 0.4377 - 14s/epoch - 27ms/step
Epoch 7/50
524/524 - 14s - loss: 3.0196 - accuracy20: 0.4854 - val_loss: 3.3288 - val_accuracy20: 0.4292 - 14s/epoch - 27ms/step
Epoch 8/50
524/524 - 13s - loss: 2.9981 - accuracy20: 0.4927 - val_loss: 3.3536 - val_accuracy20: 0.4177 - 13s/epoch - 25ms/step
Epoch 9/50
524/524 - 12s - loss: 2.9864 - accuracy20: 0.4968 - val_loss: 3.3775 - val_accuracy20: 0.4146 - 12s/epoch - 22ms/step
Epoch 10/50
524/524 - 12s - loss: 2.9648 - accuracy20: 0.5031 - val_loss: 3.4833 - val_accuracy20: 0.3897 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 12s - loss: 2.9498 - accuracy20: 0.5083 - val_loss: 3.4382 - val_accuracy20: 0.4058 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 13s - loss: 2.9373 - accuracy20: 0.5099 - val_loss: 3.4670 - val_accuracy20: 0.4035 - 13s/epoch - 25ms/step
Epoch 13/50
524/524 - 13s - loss: 2.9252 - accuracy20: 0.5164 - val_loss: 3.5530 - val_accuracy20: 0.3758 - 13s/epoch - 25ms/step
Epoch 14/50
524/524 - 13s - loss: 2.9123 - accuracy20: 0.5189 - val_loss: 3.4959 - val_accuracy20: 0.3914 - 13s/epoch - 24ms/step
testing model: results/XRAY/W1/deepLOB_L1/h20
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0784599
{'0': {'precision': 0.46311013495939657, 'recall': 0.5010905168033396, 'f1-score': 0.4813522920554344, 'support': 127921}, '1': {'precision': 0.3877744087325652, 'recall': 0.20917512823196902, 'f1-score': 0.27175751600098597, 'support': 76424}, '2': {'precision': 0.4785415123732666, 'recall': 0.5681701030927835, 'f1-score': 0.5195184163466736, 'support': 131920}, 'accuracy': 0.4610619600612612, 'macro avg': {'precision': 0.4431420186884094, 'recall': 0.4261452493760307, 'f1-score': 0.42420940813436464, 'support': 336265}, 'weighted avg': {'precision': 0.4520422265159914, 'recall': 0.4610619600612612, 'f1-score': 0.44868996904029784, 'support': 336265}}
[[64100 12180 51641]
 [30404 15986 30034]
 [43908 13059 74953]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401238
{'0': {'precision': 0.41220366598778, 'recall': 0.5900366163677496, 'f1-score': 0.48534320684495263, 'support': 42877}, '1': {'precision': 0.5521936459909228, 'recall': 0.27702816663855623, 'f1-score': 0.36895602852810694, 'support': 47432}, '2': {'precision': 0.4311216656089422, 'recall': 0.48180008693861676, 'f1-score': 0.45505423743463413, 'support': 43709}, 'accuracy': 0.4439552895879658, 'macro avg': {'precision': 0.465172992529215, 'recall': 0.4496216233149742, 'f1-score': 0.43645115760256453, 'support': 134018}, 'weighted avg': {'precision': 0.4679192532741927, 'recall': 0.4439552895879658, 'f1-score': 0.4342726252374056, 'support': 134018}}
[[25299  5170 12408]
 [18912 13140 15380]
 [17164  5486 21059]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631062
{'0': {'precision': 0.46827326995357066, 'recall': 0.6158170188020934, 'f1-score': 0.5320048561979319, 'support': 10318}, '1': {'precision': 0.38647686832740213, 'recall': 0.1667946551988942, 'f1-score': 0.2330222079176054, 'support': 6511}, '2': {'precision': 0.4665925308127143, 'recall': 0.4868968184895078, 'f1-score': 0.4765284876017414, 'support': 10341}, 'accuracy': 0.4591461170408539, 'macro avg': {'precision': 0.4404475563645624, 'recall': 0.4231694974968318, 'f1-score': 0.41385185057242624, 'support': 27170}, 'weighted avg': {'precision': 0.44803194148674774, 'recall': 0.4591461170408539, 'f1-score': 0.4392423552554802, 'support': 27170}}
[[6354  891 3073]
 [2742 1086 2683]
 [4473  833 5035]]
training model: results/XRAY/W1/deepLOB_L1/h30
Epoch 1/50
524/524 - 15s - loss: 3.2270 - accuracy30: 0.4091 - val_loss: 3.3328 - val_accuracy30: 0.4090 - 15s/epoch - 29ms/step
Epoch 2/50
524/524 - 13s - loss: 3.1605 - accuracy30: 0.4276 - val_loss: 3.2626 - val_accuracy30: 0.4227 - 13s/epoch - 24ms/step
Epoch 3/50
524/524 - 13s - loss: 3.1374 - accuracy30: 0.4363 - val_loss: 3.2690 - val_accuracy30: 0.4227 - 13s/epoch - 25ms/step
Epoch 4/50
524/524 - 12s - loss: 3.1086 - accuracy30: 0.4513 - val_loss: 3.2253 - val_accuracy30: 0.4444 - 12s/epoch - 24ms/step
Epoch 5/50
524/524 - 12s - loss: 3.0755 - accuracy30: 0.4647 - val_loss: 3.3604 - val_accuracy30: 0.4086 - 12s/epoch - 23ms/step
Epoch 6/50
524/524 - 13s - loss: 3.0443 - accuracy30: 0.4768 - val_loss: 3.4127 - val_accuracy30: 0.3834 - 13s/epoch - 24ms/step
Epoch 7/50
524/524 - 12s - loss: 3.0311 - accuracy30: 0.4821 - val_loss: 3.5179 - val_accuracy30: 0.3689 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.0079 - accuracy30: 0.4880 - val_loss: 3.5324 - val_accuracy30: 0.3714 - 12s/epoch - 22ms/step
Epoch 9/50
524/524 - 12s - loss: 2.9978 - accuracy30: 0.4898 - val_loss: 3.6112 - val_accuracy30: 0.3668 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 2.9848 - accuracy30: 0.4954 - val_loss: 3.6224 - val_accuracy30: 0.3553 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 13s - loss: 2.9730 - accuracy30: 0.4978 - val_loss: 3.6561 - val_accuracy30: 0.3417 - 13s/epoch - 25ms/step
Epoch 12/50
524/524 - 13s - loss: 2.9678 - accuracy30: 0.5012 - val_loss: 3.6095 - val_accuracy30: 0.3526 - 13s/epoch - 24ms/step
Epoch 13/50
524/524 - 12s - loss: 2.9585 - accuracy30: 0.5031 - val_loss: 3.6221 - val_accuracy30: 0.3523 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 2.9492 - accuracy30: 0.5055 - val_loss: 3.6432 - val_accuracy30: 0.3582 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepLOB_L1/h30
Evaluating performance on  test set...
1314/1314 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782243
{'0': {'precision': 0.4598662420382166, 'recall': 0.5481913988944906, 'f1-score': 0.5001593327421857, 'support': 131704}, '1': {'precision': 0.3259626616390352, 'recall': 0.22771001546126096, 'f1-score': 0.2681185682138071, 'support': 69852}, '2': {'precision': 0.4757565073427967, 'recall': 0.4607784186654195, 'f1-score': 0.46814769003344936, 'support': 134709}, 'accuracy': 0.4466001516660967, 'macro avg': {'precision': 0.4205284703400161, 'recall': 0.4122266110070571, 'f1-score': 0.41214186366314737, 'support': 336265}, 'weighted avg': {'precision': 0.4384162809981769, 'recall': 0.4466001516660967, 'f1-score': 0.4391337491652822, 'support': 336265}}
[[72199 16718 42787]
 [28336 15906 25610]
 [56465 16173 62071]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0598301
{'0': {'precision': 0.4267389632986687, 'recall': 0.47042555089660093, 'f1-score': 0.447518618319153, 'support': 44836}, '1': {'precision': 0.49689965144010273, 'recall': 0.3088060926669099, 'f1-score': 0.38089747015229714, 'support': 43856}, '2': {'precision': 0.4152292585939271, 'recall': 0.5252614393504832, 'f1-score': 0.46380877239122176, 'support': 45326}, 'accuracy': 0.4360832127027713, 'macro avg': {'precision': 0.44628929111089954, 'recall': 0.434831027637998, 'f1-score': 0.4307416202875573, 'support': 134018}, 'weighted avg': {'precision': 0.4458056428766628, 'recall': 0.4360832127027713, 'f1-score': 0.4312270041290066, 'support': 134018}}
[[21092  7385 16359]
 [13143 13543 17170]
 [15191  6327 23808]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0791516
{'0': {'precision': 0.45576124909414323, 'recall': 0.6515351290261819, 'f1-score': 0.5363414350505874, 'support': 10618}, '1': {'precision': 0.33044871794871794, 'recall': 0.17632974174790492, 'f1-score': 0.22995427679268432, 'support': 5847}, '2': {'precision': 0.4683801149814001, 'recall': 0.3881363848668846, 'f1-score': 0.4244993870044953, 'support': 10705}, 'accuracy': 0.44549135075450863, 'macro avg': {'precision': 0.41819669400808707, 'recall': 0.4053337518803238, 'f1-score': 0.3969316996159223, 'support': 27170}, 'weighted avg': {'precision': 0.43376576104540504, 'recall': 0.44549135075450863, 'f1-score': 0.42634088890898353, 'support': 27170}}
[[6918 1118 2582]
 [2682 1031 2134]
 [5579  971 4155]]
training model: results/XRAY/W1/deepLOB_L1/h50
Epoch 1/50
524/524 - 14s - loss: 3.2702 - accuracy50: 0.3913 - val_loss: 3.5483 - val_accuracy50: 0.3568 - 14s/epoch - 26ms/step
Epoch 2/50
524/524 - 11s - loss: 3.2216 - accuracy50: 0.4075 - val_loss: 3.4332 - val_accuracy50: 0.3828 - 11s/epoch - 21ms/step
Epoch 3/50
524/524 - 11s - loss: 3.1964 - accuracy50: 0.4191 - val_loss: 3.3703 - val_accuracy50: 0.3290 - 11s/epoch - 21ms/step
Epoch 4/50
524/524 - 12s - loss: 3.1767 - accuracy50: 0.4284 - val_loss: 3.5138 - val_accuracy50: 0.2925 - 12s/epoch - 22ms/step
Epoch 5/50
524/524 - 12s - loss: 3.1593 - accuracy50: 0.4365 - val_loss: 3.5112 - val_accuracy50: 0.2949 - 12s/epoch - 23ms/step
Epoch 6/50
524/524 - 11s - loss: 3.1441 - accuracy50: 0.4401 - val_loss: 3.5026 - val_accuracy50: 0.3094 - 11s/epoch - 22ms/step
Epoch 7/50
524/524 - 12s - loss: 3.1333 - accuracy50: 0.4469 - val_loss: 3.7070 - val_accuracy50: 0.2901 - 12s/epoch - 22ms/step
Epoch 8/50
524/524 - 12s - loss: 3.1306 - accuracy50: 0.4460 - val_loss: 3.6618 - val_accuracy50: 0.2881 - 12s/epoch - 22ms/step
Epoch 9/50
524/524 - 12s - loss: 3.1153 - accuracy50: 0.4527 - val_loss: 3.7129 - val_accuracy50: 0.2899 - 12s/epoch - 22ms/step
Epoch 10/50
524/524 - 12s - loss: 3.1142 - accuracy50: 0.4525 - val_loss: 3.7551 - val_accuracy50: 0.2844 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 12s - loss: 3.1056 - accuracy50: 0.4540 - val_loss: 3.7410 - val_accuracy50: 0.2964 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 12s - loss: 3.1004 - accuracy50: 0.4578 - val_loss: 3.7094 - val_accuracy50: 0.2911 - 12s/epoch - 24ms/step
Epoch 13/50
524/524 - 13s - loss: 3.1005 - accuracy50: 0.4580 - val_loss: 3.7213 - val_accuracy50: 0.2948 - 13s/epoch - 24ms/step
testing model: results/XRAY/W1/deepLOB_L1/h50
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1292374
{'0': {'precision': 0.4219055742310973, 'recall': 0.2689115939943397, 'f1-score': 0.32846693944513344, 'support': 125082}, '1': {'precision': 0.2678559783199403, 'recall': 0.43475601867642044, 'f1-score': 0.3314830922639598, 'support': 85027}, '2': {'precision': 0.40695496650749996, 'recall': 0.382367862012112, 'f1-score': 0.3942784748048552, 'support': 126156}, 'accuracy': 0.35341174371403505, 'macro avg': {'precision': 0.36557217301951256, 'recall': 0.36201182489429073, 'f1-score': 0.3514095021713161, 'support': 336265}, 'weighted avg': {'precision': 0.37734404133437566, 'recall': 0.35341174371403505, 'f1-score': 0.35392000319118905, 'support': 336265}}
[[33636 50494 40952]
 [18717 36966 29344]
 [27371 50547 48238]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898025
{'0': {'precision': 0.40709949854842964, 'recall': 0.27360812398838164, 'f1-score': 0.3272645299881983, 'support': 45101}, '1': {'precision': 0.37088791438119545, 'recall': 0.5956160413034125, 'f1-score': 0.4571254779283976, 'support': 44161}, '2': {'precision': 0.41391405130082043, 'recall': 0.30322191438019486, 'f1-score': 0.35002514733760626, 'support': 44756}, 'accuracy': 0.3896043815009924, 'macro avg': {'precision': 0.3973004880768152, 'recall': 0.39081535989066296, 'f1-score': 0.378138385084734, 'support': 134018}, 'weighted avg': {'precision': 0.3974429774436286, 'recall': 0.3896043815009924, 'f1-score': 0.3776567423184617, 'support': 134018}}
[[12340 22978  9783]
 [ 8425 26303  9433]
 [ 9547 21638 13571]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1243882
{'0': {'precision': 0.42087737078326337, 'recall': 0.28629111680126057, 'f1-score': 0.34077721118340076, 'support': 10154}, '1': {'precision': 0.2540141081625798, 'recall': 0.5524547048509644, 'f1-score': 0.3480141746053661, 'support': 6844}, '2': {'precision': 0.4254369654146523, 'recall': 0.22493118364136847, 'f1-score': 0.2942765273311897, 'support': 10172}, 'accuracy': 0.3303643724696356, 'macro avg': {'precision': 0.3667761481201652, 'recall': 0.3545590017645312, 'f1-score': 0.32768930437331883, 'support': 27170}, 'weighted avg': {'precision': 0.3805523073756274, 'recall': 0.3303643724696356, 'f1-score': 0.3251910802123018, 'support': 27170}}
[[2907 5678 1569]
 [1542 3781 1521]
 [2458 5426 2288]]
training model: results/XRAY/W1/deepLOB_L1/h100
Epoch 1/50
524/524 - 15s - loss: 3.2918 - accuracy100: 0.3800 - val_loss: 3.3643 - val_accuracy100: 0.3453 - 15s/epoch - 28ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2537 - accuracy100: 0.3920 - val_loss: 3.3266 - val_accuracy100: 0.3718 - 12s/epoch - 24ms/step
Epoch 3/50
524/524 - 13s - loss: 3.2353 - accuracy100: 0.3979 - val_loss: 3.2888 - val_accuracy100: 0.3741 - 13s/epoch - 24ms/step
Epoch 4/50
524/524 - 13s - loss: 3.2201 - accuracy100: 0.4085 - val_loss: 3.2746 - val_accuracy100: 0.3788 - 13s/epoch - 24ms/step
Epoch 5/50
524/524 - 13s - loss: 3.2078 - accuracy100: 0.4145 - val_loss: 3.2884 - val_accuracy100: 0.3723 - 13s/epoch - 24ms/step
Epoch 6/50
524/524 - 12s - loss: 3.1998 - accuracy100: 0.4186 - val_loss: 3.2866 - val_accuracy100: 0.3707 - 12s/epoch - 24ms/step
Epoch 7/50
524/524 - 13s - loss: 3.1955 - accuracy100: 0.4195 - val_loss: 3.2950 - val_accuracy100: 0.3718 - 13s/epoch - 25ms/step
Epoch 8/50
524/524 - 13s - loss: 3.1902 - accuracy100: 0.4223 - val_loss: 3.2969 - val_accuracy100: 0.3731 - 13s/epoch - 25ms/step
Epoch 9/50
524/524 - 13s - loss: 3.1873 - accuracy100: 0.4232 - val_loss: 3.2895 - val_accuracy100: 0.3804 - 13s/epoch - 25ms/step
Epoch 10/50
524/524 - 14s - loss: 3.1813 - accuracy100: 0.4280 - val_loss: 3.2974 - val_accuracy100: 0.3792 - 14s/epoch - 26ms/step
Epoch 11/50
524/524 - 13s - loss: 3.1793 - accuracy100: 0.4275 - val_loss: 3.2849 - val_accuracy100: 0.3833 - 13s/epoch - 26ms/step
Epoch 12/50
524/524 - 14s - loss: 3.1743 - accuracy100: 0.4283 - val_loss: 3.3037 - val_accuracy100: 0.3781 - 14s/epoch - 26ms/step
Epoch 13/50
524/524 - 12s - loss: 3.1728 - accuracy100: 0.4285 - val_loss: 3.3048 - val_accuracy100: 0.3821 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.1699 - accuracy100: 0.4303 - val_loss: 3.2989 - val_accuracy100: 0.3852 - 12s/epoch - 22ms/step
testing model: results/XRAY/W1/deepLOB_L1/h100
Evaluating performance on  test set...
1314/1314 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1009525
{'0': {'precision': 0.4000922413711962, 'recall': 0.34576527624129627, 'f1-score': 0.3709502179519066, 'support': 122936}, '1': {'precision': 0.29646991294365255, 'recall': 0.19984093547138987, 'f1-score': 0.2387488604409291, 'support': 93044}, '2': {'precision': 0.37926768039018793, 'recall': 0.5275221349295424, 'f1-score': 0.4412755703451801, 'support': 120285}, 'accuracy': 0.37040429423222754, 'macro avg': {'precision': 0.3586099449016789, 'recall': 0.3577094488807428, 'f1-score': 0.35032488291267194, 'support': 336265}, 'weighted avg': {'precision': 0.36397097319338123, 'recall': 0.37040429423222754, 'f1-score': 0.35952631687499853, 'support': 336265}}
[[42507 21669 58760]
 [29359 18594 45091]
 [34377 22455 63453]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925095
{'0': {'precision': 0.37215466593796964, 'recall': 0.3030013126571295, 'f1-score': 0.33403644747492084, 'support': 44947}, '1': {'precision': 0.3988191919973187, 'recall': 0.34476687171257914, 'f1-score': 0.36982846213615445, 'support': 44868}, '2': {'precision': 0.3651852104509175, 'recall': 0.4844241341085447, 'f1-score': 0.4164373438092553, 'support': 44203}, 'accuracy': 0.3768225163783969, 'macro avg': {'precision': 0.3787196894620686, 'recall': 0.3773974394927511, 'f1-score': 0.37343408447344356, 'support': 134018}, 'weighted avg': {'precision': 0.3787829779135006, 'recall': 0.3768225163783969, 'f1-score': 0.373197477593911, 'support': 134018}}
[[13619 12142 19186]
 [11362 15469 18037]
 [11614 11176 21413]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092277
{'0': {'precision': 0.38639652677279307, 'recall': 0.2919192923168671, 'f1-score': 0.33257841694032386, 'support': 10061}, '1': {'precision': 0.31968066643526555, 'recall': 0.12594010665937372, 'f1-score': 0.1806945261918776, 'support': 7313}, '2': {'precision': 0.3706255992329818, 'recall': 0.6313801551653736, 'f1-score': 0.4670744600513517, 'support': 9796}, 'accuracy': 0.3696356275303644, 'macro avg': {'precision': 0.35890093081368013, 'recall': 0.3497465180472048, 'f1-score': 0.326782467727851, 'support': 27170}, 'weighted avg': {'precision': 0.3627533507393617, 'recall': 0.3696356275303644, 'f1-score': 0.3401896184593611, 'support': 27170}}
[[2937  937 6187]
 [2076  921 4316]
 [2588 1023 6185]]
training model: results/XRAY/W1/deepLOB_L1/h200
Epoch 1/50
524/524 - 15s - loss: 3.3134 - accuracy200: 0.3673 - val_loss: 3.4293 - val_accuracy200: 0.3492 - 15s/epoch - 28ms/step
Epoch 2/50
524/524 - 13s - loss: 3.2831 - accuracy200: 0.3725 - val_loss: 3.3930 - val_accuracy200: 0.3424 - 13s/epoch - 24ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2725 - accuracy200: 0.3747 - val_loss: 3.3730 - val_accuracy200: 0.3466 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2640 - accuracy200: 0.3806 - val_loss: 3.3277 - val_accuracy200: 0.3535 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 13s - loss: 3.2534 - accuracy200: 0.3882 - val_loss: 3.4288 - val_accuracy200: 0.3502 - 13s/epoch - 24ms/step
Epoch 6/50
524/524 - 13s - loss: 3.2417 - accuracy200: 0.3970 - val_loss: 3.3922 - val_accuracy200: 0.3505 - 13s/epoch - 25ms/step
Epoch 7/50
524/524 - 13s - loss: 3.2350 - accuracy200: 0.4026 - val_loss: 3.4024 - val_accuracy200: 0.3558 - 13s/epoch - 25ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2286 - accuracy200: 0.4055 - val_loss: 3.3856 - val_accuracy200: 0.3527 - 12s/epoch - 24ms/step
Epoch 9/50
524/524 - 13s - loss: 3.2268 - accuracy200: 0.4072 - val_loss: 3.3901 - val_accuracy200: 0.3585 - 13s/epoch - 25ms/step
Epoch 10/50
524/524 - 13s - loss: 3.2222 - accuracy200: 0.4105 - val_loss: 3.4218 - val_accuracy200: 0.3719 - 13s/epoch - 24ms/step
Epoch 11/50
524/524 - 13s - loss: 3.2182 - accuracy200: 0.4121 - val_loss: 3.4130 - val_accuracy200: 0.3661 - 13s/epoch - 24ms/step
Epoch 12/50
524/524 - 13s - loss: 3.2118 - accuracy200: 0.4161 - val_loss: 3.4681 - val_accuracy200: 0.3544 - 13s/epoch - 24ms/step
Epoch 13/50
524/524 - 13s - loss: 3.2094 - accuracy200: 0.4164 - val_loss: 3.4639 - val_accuracy200: 0.3494 - 13s/epoch - 25ms/step
Epoch 14/50
524/524 - 13s - loss: 3.2082 - accuracy200: 0.4165 - val_loss: 3.4570 - val_accuracy200: 0.3526 - 13s/epoch - 24ms/step
testing model: results/XRAY/W1/deepLOB_L1/h200
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1179291
{'0': {'precision': 0.379307290282576, 'recall': 0.03807745320350362, 'f1-score': 0.06920739591414532, 'support': 112455}, '1': {'precision': 0.3409445139601032, 'recall': 0.9532402170958606, 'f1-score': 0.5022498175199341, 'support': 114051}, '2': {'precision': 0.37932164509257743, 'recall': 0.02109166446487304, 'f1-score': 0.03996133331031744, 'support': 109759}, 'accuracy': 0.342928939972938, 'macro avg': {'precision': 0.36652448311175223, 'recall': 0.3374697782547458, 'f1-score': 0.2038061822481323, 'support': 336265}, 'weighted avg': {'precision': 0.3663004729427892, 'recall': 0.342928939972938, 'f1-score': 0.2065362961601664, 'support': 336265}}
[[  4282 106465   1708]
 [  3253 108718   2080]
 [  3754 103690   2315]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113435
{'0': {'precision': 0.36517498565691336, 'recall': 0.056097829679409496, 'f1-score': 0.09725538132436923, 'support': 45385}, '1': {'precision': 0.34153875856742927, 'recall': 0.8718775903398526, 'f1-score': 0.4908125559633259, 'support': 44637}, '2': {'precision': 0.35809727418492787, 'recall': 0.10660060005455041, 'f1-score': 0.16429334594433642, 'support': 43996}, 'accuracy': 0.3443865749376949, 'macro avg': {'precision': 0.3549370061364235, 'recall': 0.34485867335793746, 'f1-score': 0.2507870944106772, 'support': 134018}, 'weighted avg': {'precision': 0.3549790324079858, 'recall': 0.3443865749376949, 'f1-score': 0.25034387612192766, 'support': 134018}}
[[ 2546 38095  4744]
 [ 2056 38918  3663]
 [ 2370 36936  4690]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1078985
{'0': {'precision': 0.41702432045779686, 'recall': 0.06453398273190171, 'f1-score': 0.11177147239263806, 'support': 9034}, '1': {'precision': 0.3538848694558037, 'recall': 0.950168918918919, 'f1-score': 0.5157002062800825, 'support': 9472}, '2': {'precision': 0.3941176470588235, 'recall': 0.015466297322253, 'f1-score': 0.029764549089293647, 'support': 8664}, 'accuracy': 0.3576370997423629, 'macro avg': {'precision': 0.38834227899080803, 'recall': 0.34338973299102454, 'f1-score': 0.21907874258733806, 'support': 27170}, 'weighted avg': {'precision': 0.38770815195505176, 'recall': 0.3576370997423629, 'f1-score': 0.226438567861232, 'support': 27170}}
[[ 583 8352   99]
 [ 365 9000  107]
 [ 450 8080  134]]
training model: results/XRAY/W1/deepLOB_L1/h300
Epoch 1/50
524/524 - 15s - loss: 3.3010 - accuracy300: 0.3760 - val_loss: 3.4262 - val_accuracy300: 0.3299 - 15s/epoch - 29ms/step
Epoch 2/50
524/524 - 14s - loss: 3.2786 - accuracy300: 0.3807 - val_loss: 3.3328 - val_accuracy300: 0.3465 - 14s/epoch - 26ms/step
Epoch 3/50
524/524 - 13s - loss: 3.2715 - accuracy300: 0.3792 - val_loss: 3.3705 - val_accuracy300: 0.3072 - 13s/epoch - 24ms/step
Epoch 4/50
524/524 - 13s - loss: 3.2667 - accuracy300: 0.3785 - val_loss: 3.4502 - val_accuracy300: 0.3025 - 13s/epoch - 25ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2616 - accuracy300: 0.3814 - val_loss: 3.5122 - val_accuracy300: 0.3016 - 12s/epoch - 24ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2422 - accuracy300: 0.3930 - val_loss: 3.4920 - val_accuracy300: 0.3191 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2367 - accuracy300: 0.4014 - val_loss: 3.5352 - val_accuracy300: 0.3013 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2236 - accuracy300: 0.4058 - val_loss: 3.5190 - val_accuracy300: 0.3073 - 12s/epoch - 24ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2263 - accuracy300: 0.3991 - val_loss: 3.5037 - val_accuracy300: 0.3071 - 12s/epoch - 24ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2165 - accuracy300: 0.4079 - val_loss: 3.4920 - val_accuracy300: 0.3241 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 12s - loss: 3.2065 - accuracy300: 0.4148 - val_loss: 3.5145 - val_accuracy300: 0.3093 - 12s/epoch - 22ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2055 - accuracy300: 0.4146 - val_loss: 3.4363 - val_accuracy300: 0.3317 - 12s/epoch - 22ms/step
testing model: results/XRAY/W1/deepLOB_L1/h300
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1418246
{'0': {'precision': 0.3745965600359521, 'recall': 0.0763587001782175, 'f1-score': 0.12685828923247208, 'support': 120078}, '1': {'precision': 0.29973975708059725, 'recall': 0.7807770878009614, 'f1-score': 0.4331814644818603, 'support': 98393}, '2': {'precision': 0.38059795635170934, 'recall': 0.1792875698252882, 'f1-score': 0.24375155093113582, 'support': 117794}, 'accuracy': 0.31853151532273655, 'macro avg': {'precision': 0.35164475782275284, 'recall': 0.34547445260148907, 'f1-score': 0.2679304348818227, 'support': 336265}, 'weighted avg': {'precision': 0.3547953409510996, 'recall': 0.31853151532273655, 'f1-score': 0.25743798396979367, 'support': 336265}}
[[ 9169 91532 19377]
 [ 6577 76823 14993]
 [ 8731 87944 21119]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1336089
{'0': {'precision': 0.3312219279051019, 'recall': 0.0607122501108273, 'f1-score': 0.10261533521247368, 'support': 47371}, '1': {'precision': 0.3332751091703057, 'recall': 0.6435385949696444, 'f1-score': 0.43913265054497036, 'support': 41508}, '2': {'precision': 0.3604514772601527, 'recall': 0.3608188041383283, 'f1-score': 0.3606350471635445, 'support': 45139}, 'accuracy': 0.34230476503156293, 'macro avg': {'precision': 0.34164950477852, 'recall': 0.3550232164062666, 'f1-score': 0.3007943443069962, 'support': 134018}, 'weighted avg': {'precision': 0.3417027295608028, 'recall': 0.34230476503156293, 'f1-score': 0.29374572443318026, 'support': 134018}}
[[ 2876 27554 16941]
 [ 2839 26712 11957]
 [ 2968 25884 16287]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1186049
{'0': {'precision': 0.381622823267877, 'recall': 0.21123872026251025, 'f1-score': 0.271947194719472, 'support': 9752}, '1': {'precision': 0.33249067812677746, 'recall': 0.6451256897608829, 'f1-score': 0.4388189173408958, 'support': 8155}, '2': {'precision': 0.3482938308959489, 'recall': 0.22368563100507394, 'f1-score': 0.2724165132789903, 'support': 9263}, 'accuracy': 0.3457121825542878, 'macro avg': {'precision': 0.35413577743020114, 'recall': 0.36001668034282236, 'f1-score': 0.327727541779786, 'support': 27170}, 'weighted avg': {'precision': 0.3555131765999772, 'recall': 0.3457121825542878, 'f1-score': 0.3221932821613023, 'support': 27170}}
[[2060 5333 2359]
 [1376 5261 1518]
 [1962 5229 2072]]
training model: results/XRAY/W1/deepLOB_L1/h500
Epoch 1/50
524/524 - 14s - loss: 3.2954 - accuracy500: 0.3806 - val_loss: 3.3711 - val_accuracy500: 0.3407 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2689 - accuracy500: 0.3854 - val_loss: 3.3654 - val_accuracy500: 0.3254 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2526 - accuracy500: 0.3892 - val_loss: 3.3709 - val_accuracy500: 0.2994 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2421 - accuracy500: 0.3968 - val_loss: 3.4702 - val_accuracy500: 0.2800 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2276 - accuracy500: 0.4086 - val_loss: 3.4891 - val_accuracy500: 0.2888 - 12s/epoch - 22ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2200 - accuracy500: 0.4044 - val_loss: 3.7122 - val_accuracy500: 0.2919 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.1949 - accuracy500: 0.4214 - val_loss: 3.7054 - val_accuracy500: 0.2837 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.1823 - accuracy500: 0.4281 - val_loss: 3.6011 - val_accuracy500: 0.2901 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.1708 - accuracy500: 0.4345 - val_loss: 3.5477 - val_accuracy500: 0.2954 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.1588 - accuracy500: 0.4418 - val_loss: 3.6542 - val_accuracy500: 0.3042 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 12s - loss: 3.1479 - accuracy500: 0.4477 - val_loss: 3.4995 - val_accuracy500: 0.3287 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 11s - loss: 3.1425 - accuracy500: 0.4489 - val_loss: 3.5181 - val_accuracy500: 0.3159 - 11s/epoch - 22ms/step
testing model: results/XRAY/W1/deepLOB_L1/h500
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1309347
{'0': {'precision': 0.4038015865941706, 'recall': 0.2845522710320732, 'f1-score': 0.33384764896346214, 'support': 127365}, '1': {'precision': 0.24484742668941709, 'recall': 0.37221759745195265, 'f1-score': 0.29538708997951096, 'support': 82887}, '2': {'precision': 0.37841471105652735, 'recall': 0.3618832977549935, 'f1-score': 0.36996442493742926, 'support': 126013}, 'accuracy': 0.33514043983168035, 'macro avg': {'precision': 0.34235457478003833, 'recall': 0.3395510554130065, 'f1-score': 0.3330663879601341, 'support': 336265}, 'weighted avg': {'precision': 0.355106926730223, 'recall': 0.33514043983168035, 'f1-score': 0.33790190063492587, 'support': 336265}}
[[36242 46189 44934]
 [22063 30852 29972]
 [31447 48964 45602]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.130323
{'0': {'precision': 0.3668371595099322, 'recall': 0.2683781137822256, 'f1-score': 0.3099770080283442, 'support': 45965}, '1': {'precision': 0.3442662863900386, 'recall': 0.44871591450007936, 'f1-score': 0.38961217882482607, 'support': 44117}, '2': {'precision': 0.3247528446185413, 'recall': 0.31700655498907504, 'f1-score': 0.32083294941490836, 'support': 43936}, 'accuracy': 0.34368517661806625, 'macro avg': {'precision': 0.34528543017283736, 'recall': 0.34470019442379335, 'f1-score': 0.34014071208935953, 'support': 134018}, 'weighted avg': {'precision': 0.3456103417056186, 'recall': 0.34368517661806625, 'f1-score': 0.33975085535324445, 'support': 134018}}
[[12336 19061 14568]
 [ 9929 19796 14392]
 [11363 18645 13928]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1233854
{'0': {'precision': 0.4031164505769002, 'recall': 0.3219952494061758, 'f1-score': 0.35801817029368266, 'support': 10525}, '1': {'precision': 0.25587307152875177, 'recall': 0.4010717230008244, 'f1-score': 0.312426415498234, 'support': 7278}, '2': {'precision': 0.35254928619986403, 'recall': 0.27682288886516493, 'f1-score': 0.3101303671809592, 'support': 9367}, 'accuracy': 0.327603974972396, 'macro avg': {'precision': 0.3371796027685054, 'recall': 0.33329662042405506, 'f1-score': 0.3268583176576253, 'support': 27170}, 'weighted avg': {'precision': 0.34624122269938373, 'recall': 0.327603974972396, 'f1-score': 0.32929598247041597, 'support': 27170}}
[[3389 4426 2710]
 [2307 2919 2052]
 [2711 4063 2593]]
training model: results/XRAY/W1/deepLOB_L1/h1000
Epoch 1/50
524/524 - 14s - loss: 3.3022 - accuracy1000: 0.3844 - val_loss: 3.3423 - val_accuracy1000: 0.3843 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2513 - accuracy1000: 0.4021 - val_loss: 3.5145 - val_accuracy1000: 0.3819 - 12s/epoch - 24ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2391 - accuracy1000: 0.4073 - val_loss: 3.4942 - val_accuracy1000: 0.3796 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2075 - accuracy1000: 0.4159 - val_loss: 3.5004 - val_accuracy1000: 0.3331 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.1912 - accuracy1000: 0.4290 - val_loss: 3.4895 - val_accuracy1000: 0.3472 - 12s/epoch - 24ms/step
Epoch 6/50
524/524 - 13s - loss: 3.1832 - accuracy1000: 0.4336 - val_loss: 3.4416 - val_accuracy1000: 0.3547 - 13s/epoch - 24ms/step
Epoch 7/50
524/524 - 13s - loss: 3.1600 - accuracy1000: 0.4391 - val_loss: 3.4477 - val_accuracy1000: 0.3312 - 13s/epoch - 24ms/step
Epoch 8/50
524/524 - 12s - loss: 3.1445 - accuracy1000: 0.4504 - val_loss: 3.4180 - val_accuracy1000: 0.3069 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 11s - loss: 3.1275 - accuracy1000: 0.4542 - val_loss: 3.4428 - val_accuracy1000: 0.3156 - 11s/epoch - 22ms/step
Epoch 10/50
524/524 - 12s - loss: 3.1152 - accuracy1000: 0.4590 - val_loss: 3.4639 - val_accuracy1000: 0.3147 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 12s - loss: 3.0990 - accuracy1000: 0.4659 - val_loss: 3.5092 - val_accuracy1000: 0.2977 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1325691
{'0': {'precision': 0.39198025813884696, 'recall': 0.4228466338038814, 'f1-score': 0.406828822932952, 'support': 119081}, '1': {'precision': 0.31817756455446655, 'recall': 0.5148963665182583, 'f1-score': 0.39331076339351123, 'support': 99051}, '2': {'precision': 0.3684232679518478, 'recall': 0.14818890572490329, 'f1-score': 0.2113625799129485, 'support': 118133}, 'accuracy': 0.35347122061469377, 'macro avg': {'precision': 0.3595270302150538, 'recall': 0.36197730201568096, 'f1-score': 0.33716738874647056, 'support': 336265}, 'weighted avg': {'precision': 0.36196497696481095, 'recall': 0.35347122061469377, 'f1-score': 0.33417781553663295, 'support': 336265}}
[[50353 52270 16458]
 [34498 51001 13552]
 [43607 57020 17506]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1263487
{'0': {'precision': 0.3504152490437649, 'recall': 0.3565868134703884, 'f1-score': 0.35347409483815273, 'support': 46502}, '1': {'precision': 0.3642420370539381, 'recall': 0.5397741361044114, 'f1-score': 0.4349666227691749, 'support': 44363}, '2': {'precision': 0.3554760200429492, 'recall': 0.1726183579357171, 'f1-score': 0.23238909340487923, 'support': 43153}, 'accuracy': 0.35798922532794103, 'macro avg': {'precision': 0.35671110204688405, 'recall': 0.35632643583683893, 'f1-score': 0.3402766036707356, 'support': 134018}, 'weighted avg': {'precision': 0.35662176792498324, 'recall': 0.35798922532794103, 'f1-score': 0.34146132005979374, 'support': 134018}}
[[16582 22246  7674]
 [14585 23946  5832]
 [16154 19550  7449]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093175
{'0': {'precision': 0.41193927633831756, 'recall': 0.6855351885269256, 'f1-score': 0.5146340593918219, 'support': 10529}, '1': {'precision': 0.33740685543964233, 'recall': 0.28782100177981185, 'f1-score': 0.3106476399560922, 'support': 7866}, '2': {'precision': 0.3495575221238938, 'recall': 0.11703703703703704, 'f1-score': 0.1753607103218646, 'support': 8775}, 'accuracy': 0.3867868973132131, 'macro avg': {'precision': 0.3663012179672846, 'recall': 0.3634644091145915, 'f1-score': 0.3335474698899263, 'support': 27170}, 'weighted avg': {'precision': 0.3702141414093316, 'recall': 0.3867868973132131, 'f1-score': 0.34600392272011327, 'support': 27170}}
[[7218 2236 1075]
 [4766 2264  836]
 [5538 2210 1027]]
training model: results/XRAY/W1/deepOF_L1/h10
Epoch 1/50
524/524 - 13s - loss: 3.2843 - accuracy10: 0.3793 - val_loss: 3.4098 - val_accuracy10: 0.3819 - 13s/epoch - 26ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2332 - accuracy10: 0.3954 - val_loss: 3.4002 - val_accuracy10: 0.3814 - 12s/epoch - 22ms/step
Epoch 3/50
524/524 - 11s - loss: 3.2172 - accuracy10: 0.3991 - val_loss: 3.3939 - val_accuracy10: 0.3838 - 11s/epoch - 22ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2076 - accuracy10: 0.4029 - val_loss: 3.3922 - val_accuracy10: 0.3846 - 12s/epoch - 22ms/step
Epoch 5/50
524/524 - 12s - loss: 3.1969 - accuracy10: 0.4087 - val_loss: 3.3871 - val_accuracy10: 0.3912 - 12s/epoch - 22ms/step
Epoch 6/50
524/524 - 12s - loss: 3.1904 - accuracy10: 0.4140 - val_loss: 3.3875 - val_accuracy10: 0.3906 - 12s/epoch - 22ms/step
Epoch 7/50
524/524 - 11s - loss: 3.1829 - accuracy10: 0.4180 - val_loss: 3.3827 - val_accuracy10: 0.3911 - 11s/epoch - 22ms/step
Epoch 8/50
524/524 - 12s - loss: 3.1742 - accuracy10: 0.4232 - val_loss: 3.3791 - val_accuracy10: 0.3967 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.1695 - accuracy10: 0.4257 - val_loss: 3.3764 - val_accuracy10: 0.3941 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 11s - loss: 3.1614 - accuracy10: 0.4310 - val_loss: 3.3756 - val_accuracy10: 0.3955 - 11s/epoch - 21ms/step
Epoch 11/50
524/524 - 11s - loss: 3.1563 - accuracy10: 0.4348 - val_loss: 3.3724 - val_accuracy10: 0.3972 - 11s/epoch - 21ms/step
Epoch 12/50
524/524 - 12s - loss: 3.1509 - accuracy10: 0.4371 - val_loss: 3.3728 - val_accuracy10: 0.3989 - 12s/epoch - 22ms/step
Epoch 13/50
524/524 - 11s - loss: 3.1436 - accuracy10: 0.4402 - val_loss: 3.3766 - val_accuracy10: 0.3979 - 11s/epoch - 21ms/step
Epoch 14/50
524/524 - 11s - loss: 3.1373 - accuracy10: 0.4441 - val_loss: 3.3771 - val_accuracy10: 0.3976 - 11s/epoch - 21ms/step
Epoch 15/50
524/524 - 11s - loss: 3.1324 - accuracy10: 0.4463 - val_loss: 3.3782 - val_accuracy10: 0.4015 - 11s/epoch - 22ms/step
Epoch 16/50
524/524 - 12s - loss: 3.1262 - accuracy10: 0.4488 - val_loss: 3.3796 - val_accuracy10: 0.4033 - 12s/epoch - 22ms/step
Epoch 17/50
524/524 - 12s - loss: 3.1209 - accuracy10: 0.4506 - val_loss: 3.3825 - val_accuracy10: 0.4000 - 12s/epoch - 22ms/step
Epoch 18/50
524/524 - 11s - loss: 3.1161 - accuracy10: 0.4529 - val_loss: 3.3820 - val_accuracy10: 0.4050 - 11s/epoch - 21ms/step
Epoch 19/50
524/524 - 12s - loss: 3.1100 - accuracy10: 0.4555 - val_loss: 3.3870 - val_accuracy10: 0.4022 - 12s/epoch - 22ms/step
Epoch 20/50
524/524 - 11s - loss: 3.1058 - accuracy10: 0.4557 - val_loss: 3.3882 - val_accuracy10: 0.4027 - 11s/epoch - 22ms/step
Epoch 21/50
524/524 - 12s - loss: 3.1008 - accuracy10: 0.4591 - val_loss: 3.3953 - val_accuracy10: 0.4034 - 12s/epoch - 22ms/step
testing model: results/XRAY/W1/deepOF_L1/h10
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0756927
{'0': {'precision': 0.42323914823914827, 'recall': 0.38225830312892967, 'f1-score': 0.4017062458704186, 'support': 108152}, '1': {'precision': 0.3908648285906021, 'recall': 0.23505117461189723, 'f1-score': 0.29356410957581996, 'support': 116464}, '2': {'precision': 0.39026835881644445, 'recall': 0.589167353373222, 'f1-score': 0.46952214057040476, 'support': 111644}, 'accuracy': 0.39997026110747635, 'macro avg': {'precision': 0.4014574452153983, 'recall': 0.402158943704683, 'f1-score': 0.38826416533888103, 'support': 336260}, 'weighted avg': {'precision': 0.40107941000725444, 'recall': 0.39997026110747635, 'f1-score': 0.38676712729095963, 'support': 336260}}
[[41342 21551 45259]
 [31582 27375 57507]
 [24756 21111 65777]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0600358
{'0': {'precision': 0.37075114868123776, 'recall': 0.41061036295650705, 'f1-score': 0.38966409647554756, 'support': 35569}, '1': {'precision': 0.5479897116556112, 'recall': 0.2602880658436214, 'f1-score': 0.35293604777889187, 'support': 62208}, '2': {'precision': 0.3423790279207708, 'recall': 0.6148009160895119, 'f1-score': 0.4398231311316844, 'support': 36241}, 'accuracy': 0.3960512766941754, 'macro avg': {'precision': 0.42037329608587326, 'recall': 0.42856644829654683, 'f1-score': 0.39414109179537465, 'support': 134018}, 'weighted avg': {'precision': 0.4453487586816089, 'recall': 0.3960512766941754, 'f1-score': 0.386179751996832, 'support': 134018}}
[[14605  6899 14065]
 [17285 16192 28731]
 [ 7503  6457 22281]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0718585
{'0': {'precision': 0.4217695735200509, 'recall': 0.38229863835679667, 'f1-score': 0.4010653108165365, 'support': 8666}, '1': {'precision': 0.41044463087248323, 'recall': 0.19779664443096825, 'f1-score': 0.2669485745464466, 'support': 9894}, '2': {'precision': 0.37492266446690037, 'recall': 0.6334494773519164, 'f1-score': 0.4710454722114263, 'support': 8610}, 'accuracy': 0.39470003680529997, 'macro avg': {'precision': 0.40237895628647813, 'recall': 0.40451492004656037, 'f1-score': 0.37968645252480315, 'support': 27170}, 'weighted avg': {'precision': 0.4028000899167142, 'recall': 0.39470003680529997, 'f1-score': 0.37440274920276145, 'support': 27170}}
[[3313 1449 3904]
 [2748 1957 5189]
 [1794 1362 5454]]
training model: results/XRAY/W1/deepOF_L1/h20
Epoch 1/50
524/524 - 15s - loss: 3.3068 - accuracy20: 0.3750 - val_loss: 3.2688 - val_accuracy20: 0.4238 - 15s/epoch - 28ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2601 - accuracy20: 0.3932 - val_loss: 3.2666 - val_accuracy20: 0.4282 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2428 - accuracy20: 0.3985 - val_loss: 3.2641 - val_accuracy20: 0.4311 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2340 - accuracy20: 0.4018 - val_loss: 3.2713 - val_accuracy20: 0.4250 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2239 - accuracy20: 0.4064 - val_loss: 3.2690 - val_accuracy20: 0.4247 - 12s/epoch - 23ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2160 - accuracy20: 0.4099 - val_loss: 3.2664 - val_accuracy20: 0.4252 - 12s/epoch - 22ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2102 - accuracy20: 0.4142 - val_loss: 3.2626 - val_accuracy20: 0.4253 - 12s/epoch - 24ms/step
Epoch 8/50
524/524 - 13s - loss: 3.2031 - accuracy20: 0.4186 - val_loss: 3.2620 - val_accuracy20: 0.4187 - 13s/epoch - 25ms/step
Epoch 9/50
524/524 - 12s - loss: 3.1953 - accuracy20: 0.4224 - val_loss: 3.2634 - val_accuracy20: 0.4145 - 12s/epoch - 24ms/step
Epoch 10/50
524/524 - 12s - loss: 3.1894 - accuracy20: 0.4266 - val_loss: 3.2645 - val_accuracy20: 0.4156 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 13s - loss: 3.1829 - accuracy20: 0.4289 - val_loss: 3.2596 - val_accuracy20: 0.4172 - 13s/epoch - 24ms/step
Epoch 12/50
524/524 - 13s - loss: 3.1761 - accuracy20: 0.4327 - val_loss: 3.2626 - val_accuracy20: 0.4107 - 13s/epoch - 25ms/step
Epoch 13/50
524/524 - 12s - loss: 3.1695 - accuracy20: 0.4353 - val_loss: 3.2600 - val_accuracy20: 0.4128 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.1611 - accuracy20: 0.4381 - val_loss: 3.2652 - val_accuracy20: 0.4089 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 13s - loss: 3.1529 - accuracy20: 0.4421 - val_loss: 3.2698 - val_accuracy20: 0.4081 - 13s/epoch - 24ms/step
Epoch 16/50
524/524 - 12s - loss: 3.1476 - accuracy20: 0.4445 - val_loss: 3.2753 - val_accuracy20: 0.4055 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.1407 - accuracy20: 0.4456 - val_loss: 3.2760 - val_accuracy20: 0.4041 - 12s/epoch - 22ms/step
Epoch 18/50
524/524 - 12s - loss: 3.1330 - accuracy20: 0.4497 - val_loss: 3.2839 - val_accuracy20: 0.3969 - 12s/epoch - 22ms/step
Epoch 19/50
524/524 - 12s - loss: 3.1274 - accuracy20: 0.4524 - val_loss: 3.2962 - val_accuracy20: 0.3939 - 12s/epoch - 23ms/step
Epoch 20/50
524/524 - 12s - loss: 3.1203 - accuracy20: 0.4561 - val_loss: 3.3031 - val_accuracy20: 0.3887 - 12s/epoch - 23ms/step
Epoch 21/50
524/524 - 12s - loss: 3.1136 - accuracy20: 0.4577 - val_loss: 3.3095 - val_accuracy20: 0.3872 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepOF_L1/h20
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796663
{'0': {'precision': 0.46882505253677575, 'recall': 0.3906551699877268, 'f1-score': 0.42618532874510157, 'support': 127921}, '1': {'precision': 0.2542032286154464, 'recall': 0.2482858787815346, 'f1-score': 0.25120971211830356, 'support': 76424}, '2': {'precision': 0.45355850422195415, 'recall': 0.5330098927339575, 'f1-score': 0.49008496609023555, 'support': 131915}, 'accuracy': 0.4141438172842443, 'macro avg': {'precision': 0.3921955951247254, 'recall': 0.39065031383440624, 'f1-score': 0.3891600023178802, 'support': 336260}, 'weighted avg': {'precision': 0.41405747687415345, 'recall': 0.4141438172842443, 'f1-score': 0.4114853469907952, 'support': 336260}}
[[49973 28066 49882]
 [22620 18975 34829]
 [33999 27604 70312]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0644234
{'0': {'precision': 0.42083539706125145, 'recall': 0.41700944189959804, 'f1-score': 0.41891368401281887, 'support': 42788}, '1': {'precision': 0.4318671531588474, 'recall': 0.3165231306984481, 'f1-score': 0.3653065688109067, 'support': 47491}, '2': {'precision': 0.40984299091741183, 'recall': 0.5323395596607147, 'f1-score': 0.4631281638173663, 'support': 43739}, 'accuracy': 0.41904072587264396, 'macro avg': {'precision': 0.42084851371250354, 'recall': 0.4219573774195869, 'f1-score': 0.4157828055470307, 'support': 134018}, 'weighted avg': {'precision': 0.4211570872558934, 'recall': 0.41904072587264396, 'f1-score': 0.41434744383699984, 'support': 134018}}
[[17843  9957 14988]
 [13919 15032 18540]
 [10637  9818 23284]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0760083
{'0': {'precision': 0.47054614834247555, 'recall': 0.3819202477739063, 'f1-score': 0.4216262421198846, 'support': 10332}, '1': {'precision': 0.25967741935483873, 'recall': 0.22299168975069253, 'f1-score': 0.2399403874813711, 'support': 6498}, '2': {'precision': 0.4369887912753711, 'recall': 0.558027079303675, 'f1-score': 0.4901461094121644, 'support': 10340}, 'accuracy': 0.4109311740890688, 'macro avg': {'precision': 0.3890707863242285, 'recall': 0.38764633894275796, 'f1-score': 0.3839042463378067, 'support': 27170}, 'weighted avg': {'precision': 0.4073437901151835, 'recall': 0.4109311740890688, 'f1-score': 0.4042504874036944, 'support': 27170}}
[[3946 2109 4277]
 [1892 1449 3157]
 [2548 2022 5770]]
training model: results/XRAY/W1/deepOF_L1/h30
Epoch 1/50
524/524 - 14s - loss: 3.3099 - accuracy30: 0.3714 - val_loss: 3.2164 - val_accuracy30: 0.4349 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2619 - accuracy30: 0.3904 - val_loss: 3.2194 - val_accuracy30: 0.4377 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2480 - accuracy30: 0.3949 - val_loss: 3.2211 - val_accuracy30: 0.4411 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2382 - accuracy30: 0.4014 - val_loss: 3.2277 - val_accuracy30: 0.4369 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 11s - loss: 3.2307 - accuracy30: 0.4037 - val_loss: 3.2263 - val_accuracy30: 0.4355 - 11s/epoch - 21ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2231 - accuracy30: 0.4094 - val_loss: 3.2248 - val_accuracy30: 0.4339 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2178 - accuracy30: 0.4112 - val_loss: 3.2231 - val_accuracy30: 0.4327 - 12s/epoch - 22ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2103 - accuracy30: 0.4146 - val_loss: 3.2198 - val_accuracy30: 0.4322 - 12s/epoch - 22ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2044 - accuracy30: 0.4199 - val_loss: 3.2130 - val_accuracy30: 0.4374 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.1988 - accuracy30: 0.4233 - val_loss: 3.2144 - val_accuracy30: 0.4348 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 11s - loss: 3.1928 - accuracy30: 0.4241 - val_loss: 3.2111 - val_accuracy30: 0.4361 - 11s/epoch - 21ms/step
Epoch 12/50
524/524 - 11s - loss: 3.1863 - accuracy30: 0.4282 - val_loss: 3.2144 - val_accuracy30: 0.4318 - 11s/epoch - 22ms/step
Epoch 13/50
524/524 - 12s - loss: 3.1808 - accuracy30: 0.4310 - val_loss: 3.2140 - val_accuracy30: 0.4314 - 12s/epoch - 22ms/step
Epoch 14/50
524/524 - 11s - loss: 3.1734 - accuracy30: 0.4342 - val_loss: 3.2135 - val_accuracy30: 0.4312 - 11s/epoch - 21ms/step
Epoch 15/50
524/524 - 12s - loss: 3.1690 - accuracy30: 0.4365 - val_loss: 3.2173 - val_accuracy30: 0.4281 - 12s/epoch - 22ms/step
Epoch 16/50
524/524 - 12s - loss: 3.1629 - accuracy30: 0.4391 - val_loss: 3.2244 - val_accuracy30: 0.4256 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.1568 - accuracy30: 0.4410 - val_loss: 3.2181 - val_accuracy30: 0.4267 - 12s/epoch - 23ms/step
Epoch 18/50
524/524 - 12s - loss: 3.1504 - accuracy30: 0.4432 - val_loss: 3.2295 - val_accuracy30: 0.4215 - 12s/epoch - 22ms/step
Epoch 19/50
524/524 - 12s - loss: 3.1474 - accuracy30: 0.4454 - val_loss: 3.2361 - val_accuracy30: 0.4174 - 12s/epoch - 22ms/step
Epoch 20/50
524/524 - 12s - loss: 3.1417 - accuracy30: 0.4482 - val_loss: 3.2332 - val_accuracy30: 0.4197 - 12s/epoch - 23ms/step
Epoch 21/50
524/524 - 12s - loss: 3.1351 - accuracy30: 0.4494 - val_loss: 3.2376 - val_accuracy30: 0.4152 - 12s/epoch - 22ms/step
testing model: results/XRAY/W1/deepOF_L1/h30
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790544
{'0': {'precision': 0.47258323842701144, 'recall': 0.42849116199963555, 'f1-score': 0.4494584262503982, 'support': 131704}, '1': {'precision': 0.23440318775647762, 'recall': 0.16927217545667983, 'f1-score': 0.19658339914377154, 'support': 69852}, '2': {'precision': 0.46011141759965385, 'recall': 0.5683795581422972, 'f1-score': 0.5085468524268942, 'support': 134704}, 'accuracy': 0.4306816154166419, 'macro avg': {'precision': 0.389032614594381, 'recall': 0.38871429853287087, 'f1-score': 0.3848628926070214, 'support': 336260}, 'weighted avg': {'precision': 0.4181094471578551, 'recall': 0.4306816154166419, 'f1-score': 0.4205986777409907, 'support': 336260}}
[[56434 19897 55373]
 [23563 11824 34465]
 [39419 18722 76563]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0667192
{'0': {'precision': 0.42579085926373483, 'recall': 0.4409484010815884, 'f1-score': 0.4332370925777519, 'support': 44749}, '1': {'precision': 0.41977974519542216, 'recall': 0.22176591375770022, 'f1-score': 0.290214227065761, 'support': 43830}, '2': {'precision': 0.4143457168983742, 'recall': 0.5883492154316776, 'f1-score': 0.48624954528919606, 'support': 45439}, 'accuracy': 0.41924219134743096, 'macro avg': {'precision': 0.4199721071191771, 'recall': 0.41702117675698874, 'f1-score': 0.40323362164423626, 'support': 134018}, 'weighted avg': {'precision': 0.4199444583806164, 'recall': 0.41924219134743096, 'f1-score': 0.40443604080384654, 'support': 134018}}
[[19732  6994 18023]
 [14346  9720 19764]
 [12264  6441 26734]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0742927
{'0': {'precision': 0.47305582445950306, 'recall': 0.4136957953155865, 'f1-score': 0.4413890004014452, 'support': 10631}, '1': {'precision': 0.25204531151667714, 'recall': 0.13573970513472292, 'f1-score': 0.17645115100782022, 'support': 5901}, '2': {'precision': 0.44783940115685605, 'recall': 0.618631321677007, 'f1-score': 0.5195594678877354, 'support': 10638}, 'accuracy': 0.43356643356643354, 'macro avg': {'precision': 0.39098017904434545, 'recall': 0.3893556073757722, 'f1-score': 0.3791332064323336, 'support': 27170}, 'weighted avg': {'precision': 0.4151818698047672, 'recall': 0.43356643356643354, 'f1-score': 0.41445411574363783, 'support': 27170}}
[[4398 1223 5010]
 [1996  801 3104]
 [2903 1154 6581]]
training model: results/XRAY/W1/deepOF_L1/h50
Epoch 1/50
524/524 - 14s - loss: 3.3087 - accuracy50: 0.3665 - val_loss: 3.2458 - val_accuracy50: 0.4153 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2670 - accuracy50: 0.3873 - val_loss: 3.2429 - val_accuracy50: 0.4196 - 12s/epoch - 22ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2519 - accuracy50: 0.3911 - val_loss: 3.2405 - val_accuracy50: 0.4219 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2445 - accuracy50: 0.3959 - val_loss: 3.2426 - val_accuracy50: 0.4169 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2399 - accuracy50: 0.3966 - val_loss: 3.2424 - val_accuracy50: 0.4169 - 12s/epoch - 22ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2339 - accuracy50: 0.4006 - val_loss: 3.2421 - val_accuracy50: 0.4200 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2285 - accuracy50: 0.4046 - val_loss: 3.2399 - val_accuracy50: 0.4205 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2235 - accuracy50: 0.4083 - val_loss: 3.2413 - val_accuracy50: 0.4179 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2182 - accuracy50: 0.4117 - val_loss: 3.2406 - val_accuracy50: 0.4183 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2153 - accuracy50: 0.4130 - val_loss: 3.2402 - val_accuracy50: 0.4177 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 12s - loss: 3.2095 - accuracy50: 0.4171 - val_loss: 3.2411 - val_accuracy50: 0.4147 - 12s/epoch - 22ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2058 - accuracy50: 0.4180 - val_loss: 3.2401 - val_accuracy50: 0.4162 - 12s/epoch - 22ms/step
Epoch 13/50
524/524 - 12s - loss: 3.1995 - accuracy50: 0.4230 - val_loss: 3.2435 - val_accuracy50: 0.4150 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.1959 - accuracy50: 0.4241 - val_loss: 3.2438 - val_accuracy50: 0.4152 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 12s - loss: 3.1927 - accuracy50: 0.4264 - val_loss: 3.2425 - val_accuracy50: 0.4101 - 12s/epoch - 23ms/step
Epoch 16/50
524/524 - 12s - loss: 3.1882 - accuracy50: 0.4295 - val_loss: 3.2464 - val_accuracy50: 0.4119 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.1841 - accuracy50: 0.4316 - val_loss: 3.2472 - val_accuracy50: 0.4089 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepOF_L1/h50
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835955
{'0': {'precision': 0.4365726955154234, 'recall': 0.5415370839695877, 'f1-score': 0.48342284154370435, 'support': 125081}, '1': {'precision': 0.26289652376608896, 'recall': 0.12203182518494125, 'f1-score': 0.1666894252781236, 'support': 85027}, '2': {'precision': 0.4442522486903232, 'recall': 0.4987871773733274, 'f1-score': 0.46994286567833005, 'support': 126152}, 'accuracy': 0.41942247070719085, 'macro avg': {'precision': 0.3812404893239452, 'recall': 0.3874520288426188, 'f1-score': 0.373351710833386, 'support': 336260}, 'weighted avg': {'precision': 0.3955378627574067, 'recall': 0.41942247070719085, 'f1-score': 0.39827617497562545, 'support': 336260}}
[[67736 14246 43099]
 [39035 10376 35616]
 [48383 14846 62923]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756865
{'0': {'precision': 0.40231924261729274, 'recall': 0.5529570845894662, 'f1-score': 0.4657610978854502, 'support': 45112}, '1': {'precision': 0.3930092623892908, 'recall': 0.13173340585129287, 'f1-score': 0.19732509589599104, 'support': 44127}, '2': {'precision': 0.4115930378862016, 'recall': 0.5259831617499274, 'f1-score': 0.4618099467662716, 'support': 44779}, 'accuracy': 0.40525153337611364, 'macro avg': {'precision': 0.4023071809642617, 'recall': 0.40355788406356224, 'f1-score': 0.374965380182571, 'support': 134018}, 'weighted avg': {'precision': 0.4023524454767999, 'recall': 0.40525153337611364, 'f1-score': 0.3760552072158792, 'support': 134018}}
[[24945  4502 15665]
 [20308  5813 18006]
 [16750  4476 23553]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812086
{'0': {'precision': 0.43895817425977773, 'recall': 0.5105585158871127, 'f1-score': 0.4720587564435929, 'support': 10134}, '1': {'precision': 0.2594594594594595, 'recall': 0.0975043528728961, 'f1-score': 0.14174224847078676, 'support': 6892}, '2': {'precision': 0.43007894942546704, 'recall': 0.5423895899053628, 'f1-score': 0.47974887735972443, 'support': 10144}, 'accuracy': 0.41766654398233344, 'macro avg': {'precision': 0.3761655277149014, 'recall': 0.38348415288845716, 'f1-score': 0.36451662742470137, 'support': 27170}, 'weighted avg': {'precision': 0.3901110635081016, 'recall': 0.41766654398233344, 'f1-score': 0.3911410977621302, 'support': 27170}}
[[5174  929 4031]
 [2960  672 3260]
 [3653  989 5502]]
training model: results/XRAY/W1/deepOF_L1/h100
Epoch 1/50
524/524 - 14s - loss: 3.3143 - accuracy100: 0.3589 - val_loss: 3.2677 - val_accuracy100: 0.3932 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2801 - accuracy100: 0.3740 - val_loss: 3.2572 - val_accuracy100: 0.4036 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2696 - accuracy100: 0.3756 - val_loss: 3.2546 - val_accuracy100: 0.4039 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2648 - accuracy100: 0.3806 - val_loss: 3.2527 - val_accuracy100: 0.4084 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2605 - accuracy100: 0.3816 - val_loss: 3.2525 - val_accuracy100: 0.4087 - 12s/epoch - 24ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2576 - accuracy100: 0.3852 - val_loss: 3.2520 - val_accuracy100: 0.4106 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2538 - accuracy100: 0.3874 - val_loss: 3.2508 - val_accuracy100: 0.4097 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2506 - accuracy100: 0.3889 - val_loss: 3.2520 - val_accuracy100: 0.4057 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2482 - accuracy100: 0.3915 - val_loss: 3.2530 - val_accuracy100: 0.4074 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2451 - accuracy100: 0.3942 - val_loss: 3.2516 - val_accuracy100: 0.4074 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 12s - loss: 3.2425 - accuracy100: 0.3963 - val_loss: 3.2527 - val_accuracy100: 0.4082 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2397 - accuracy100: 0.3961 - val_loss: 3.2536 - val_accuracy100: 0.4061 - 12s/epoch - 23ms/step
Epoch 13/50
524/524 - 12s - loss: 3.2366 - accuracy100: 0.3988 - val_loss: 3.2541 - val_accuracy100: 0.4072 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.2340 - accuracy100: 0.3997 - val_loss: 3.2508 - val_accuracy100: 0.4058 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 12s - loss: 3.2303 - accuracy100: 0.4009 - val_loss: 3.2514 - val_accuracy100: 0.4079 - 12s/epoch - 24ms/step
Epoch 16/50
524/524 - 12s - loss: 3.2273 - accuracy100: 0.4034 - val_loss: 3.2533 - val_accuracy100: 0.4093 - 12s/epoch - 24ms/step
Epoch 17/50
524/524 - 12s - loss: 3.2261 - accuracy100: 0.4032 - val_loss: 3.2542 - val_accuracy100: 0.4058 - 12s/epoch - 24ms/step
testing model: results/XRAY/W1/deepOF_L1/h100
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0888835
{'0': {'precision': 0.40882052479495634, 'recall': 0.5696703976052581, 'f1-score': 0.4760247552176617, 'support': 122936}, '1': {'precision': 0.2914534458696086, 'recall': 0.09426824156572768, 'f1-score': 0.1424592120970951, 'support': 93043}, '2': {'precision': 0.4144711962687508, 'recall': 0.4647117998686409, 'f1-score': 0.43815600724302545, 'support': 120281}, 'accuracy': 0.4005828822934634, 'macro avg': {'precision': 0.37158172231110526, 'recall': 0.37621681301320886, 'f1-score': 0.3522133248525941, 'support': 336260}, 'weighted avg': {'precision': 0.3783663622156675, 'recall': 0.4005828822934634, 'f1-score': 0.3701815692790901, 'support': 336260}}
[[70033 10840 42063]
 [47370  8771 36902]
 [53902 10483 55896]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0835354
{'0': {'precision': 0.3790988272799727, 'recall': 0.5922228645115389, 'f1-score': 0.4622793773103556, 'support': 44978}, '1': {'precision': 0.44138872635069243, 'recall': 0.10091415830546266, 'f1-score': 0.16427119628339143, 'support': 44850}, '2': {'precision': 0.3937009345794393, 'recall': 0.47664630006788866, 'f1-score': 0.4312212099498413, 'support': 44190}, 'accuracy': 0.38969392171200884, 'macro avg': {'precision': 0.4047294960700348, 'recall': 0.3899277742949634, 'f1-score': 0.3525905945145295, 'support': 134018}, 'weighted avg': {'precision': 0.4047593288162231, 'recall': 0.38969392171200884, 'f1-score': 0.35230812468219774, 'support': 134018}}
[[26637  3114 15227]
 [23114  4526 17210]
 [20513  2614 21063]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0830101
{'0': {'precision': 0.41543403555953984, 'recall': 0.5537741485759808, 'f1-score': 0.47473109100221955, 'support': 10042}, '1': {'precision': 0.3142857142857143, 'recall': 0.06882480957562569, 'f1-score': 0.11292122294130774, 'support': 7352}, '2': {'precision': 0.41761130277640873, 'recall': 0.5200490998363339, 'f1-score': 0.46323462414578587, 'support': 9776}, 'accuracy': 0.4104158998895841, 'macro avg': {'precision': 0.38244368420722097, 'recall': 0.38088268599598013, 'f1-score': 0.35029564602977104, 'support': 27170}, 'weighted avg': {'precision': 0.38884745132350546, 'recall': 0.4104158998895841, 'f1-score': 0.37269150285454494, 'support': 27170}}
[[5561  551 3930]
 [3686  506 3160]
 [4139  553 5084]]
training model: results/XRAY/W1/deepOF_L1/h200
Epoch 1/50
524/524 - 15s - loss: 3.3158 - accuracy200: 0.3530 - val_loss: 3.3721 - val_accuracy200: 0.3493 - 15s/epoch - 28ms/step
Epoch 2/50
524/524 - 13s - loss: 3.2911 - accuracy200: 0.3663 - val_loss: 3.3503 - val_accuracy200: 0.3511 - 13s/epoch - 24ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2810 - accuracy200: 0.3706 - val_loss: 3.3435 - val_accuracy200: 0.3499 - 12s/epoch - 22ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2761 - accuracy200: 0.3754 - val_loss: 3.3372 - val_accuracy200: 0.3494 - 12s/epoch - 22ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2734 - accuracy200: 0.3773 - val_loss: 3.3334 - val_accuracy200: 0.3513 - 12s/epoch - 22ms/step
Epoch 6/50
524/524 - 11s - loss: 3.2710 - accuracy200: 0.3784 - val_loss: 3.3236 - val_accuracy200: 0.3505 - 11s/epoch - 22ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2692 - accuracy200: 0.3792 - val_loss: 3.3192 - val_accuracy200: 0.3513 - 12s/epoch - 22ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2674 - accuracy200: 0.3804 - val_loss: 3.3133 - val_accuracy200: 0.3499 - 12s/epoch - 22ms/step
Epoch 9/50
524/524 - 11s - loss: 3.2657 - accuracy200: 0.3812 - val_loss: 3.3074 - val_accuracy200: 0.3495 - 11s/epoch - 21ms/step
Epoch 10/50
524/524 - 11s - loss: 3.2650 - accuracy200: 0.3811 - val_loss: 3.3083 - val_accuracy200: 0.3506 - 11s/epoch - 21ms/step
Epoch 11/50
524/524 - 11s - loss: 3.2624 - accuracy200: 0.3822 - val_loss: 3.3038 - val_accuracy200: 0.3517 - 11s/epoch - 22ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2603 - accuracy200: 0.3841 - val_loss: 3.3087 - val_accuracy200: 0.3491 - 12s/epoch - 24ms/step
Epoch 13/50
524/524 - 12s - loss: 3.2596 - accuracy200: 0.3848 - val_loss: 3.3042 - val_accuracy200: 0.3512 - 12s/epoch - 22ms/step
Epoch 14/50
524/524 - 12s - loss: 3.2579 - accuracy200: 0.3847 - val_loss: 3.3043 - val_accuracy200: 0.3512 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 12s - loss: 3.2579 - accuracy200: 0.3852 - val_loss: 3.3051 - val_accuracy200: 0.3512 - 12s/epoch - 23ms/step
Epoch 16/50
524/524 - 12s - loss: 3.2556 - accuracy200: 0.3871 - val_loss: 3.3037 - val_accuracy200: 0.3502 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.2546 - accuracy200: 0.3869 - val_loss: 3.3011 - val_accuracy200: 0.3524 - 12s/epoch - 22ms/step
Epoch 18/50
524/524 - 12s - loss: 3.2530 - accuracy200: 0.3896 - val_loss: 3.3016 - val_accuracy200: 0.3520 - 12s/epoch - 23ms/step
Epoch 19/50
524/524 - 12s - loss: 3.2527 - accuracy200: 0.3883 - val_loss: 3.3028 - val_accuracy200: 0.3501 - 12s/epoch - 23ms/step
Epoch 20/50
524/524 - 12s - loss: 3.2504 - accuracy200: 0.3900 - val_loss: 3.3026 - val_accuracy200: 0.3514 - 12s/epoch - 23ms/step
Epoch 21/50
524/524 - 12s - loss: 3.2477 - accuracy200: 0.3918 - val_loss: 3.3075 - val_accuracy200: 0.3510 - 12s/epoch - 23ms/step
Epoch 22/50
524/524 - 12s - loss: 3.2471 - accuracy200: 0.3931 - val_loss: 3.3107 - val_accuracy200: 0.3510 - 12s/epoch - 24ms/step
Epoch 23/50
524/524 - 12s - loss: 3.2456 - accuracy200: 0.3933 - val_loss: 3.3103 - val_accuracy200: 0.3523 - 12s/epoch - 23ms/step
Epoch 24/50
524/524 - 12s - loss: 3.2442 - accuracy200: 0.3940 - val_loss: 3.3104 - val_accuracy200: 0.3528 - 12s/epoch - 23ms/step
Epoch 25/50
524/524 - 12s - loss: 3.2430 - accuracy200: 0.3949 - val_loss: 3.3160 - val_accuracy200: 0.3520 - 12s/epoch - 23ms/step
Epoch 26/50
524/524 - 12s - loss: 3.2405 - accuracy200: 0.3972 - val_loss: 3.3199 - val_accuracy200: 0.3521 - 12s/epoch - 24ms/step
Epoch 27/50
524/524 - 12s - loss: 3.2382 - accuracy200: 0.3981 - val_loss: 3.3244 - val_accuracy200: 0.3524 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepOF_L1/h200
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072738
{'0': {'precision': 0.39673340358271864, 'recall': 0.026784285129919788, 'f1-score': 0.050180764040451166, 'support': 112454}, '1': {'precision': 0.3387474105571391, 'recall': 0.9534761374496927, 'f1-score': 0.4998942684294725, 'support': 114049}, '2': {'precision': 0.3863844244087286, 'recall': 0.026941334037920133, 'f1-score': 0.05037049655054936, 'support': 109757}, 'accuracy': 0.3411407839172069, 'macro avg': {'precision': 0.37395507951619544, 'recall': 0.33573391887251086, 'f1-score': 0.200148509673491, 'support': 336260}, 'weighted avg': {'precision': 0.373688386554901, 'recall': 0.3411407839172069, 'f1-score': 0.20277161615837877, 'support': 336260}}
[[  3012 107453   1989]
 [  2599 108743   2707]
 [  1981 104819   2957]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026534
{'0': {'precision': 0.4496996996996997, 'recall': 0.026398131417742717, 'f1-score': 0.04986887566082504, 'support': 45382}, '1': {'precision': 0.3340135315477484, 'recall': 0.964424132446177, 'f1-score': 0.4961820183147861, 'support': 44637}, '2': {'precision': 0.457085020242915, 'recall': 0.025659674083501897, 'f1-score': 0.04859153414104026, 'support': 43999}, 'accuracy': 0.3385813845901297, 'macro avg': {'precision': 0.41359941716345433, 'recall': 0.33882731264914057, 'f1-score': 0.19821414270555046, 'support': 134018}, 'weighted avg': {'precision': 0.41359308141545637, 'recall': 0.3385813845901297, 'f1-score': 0.19810178466645004, 'support': 134018}}
[[ 1198 43566   618]
 [  865 43049   723]
 [  601 42269  1129]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009766
{'0': {'precision': 0.40831758034026466, 'recall': 0.023981347840568448, 'f1-score': 0.045302013422818796, 'support': 9007}, '1': {'precision': 0.349658925423469, 'recall': 0.9588062211013031, 'f1-score': 0.5124403257511935, 'support': 9516}, '2': {'precision': 0.40219378427787933, 'recall': 0.02544234994795883, 'f1-score': 0.04785729823798129, 'support': 8647}, 'accuracy': 0.35185866764814133, 'macro avg': {'precision': 0.38672343001387094, 'recall': 0.3360766396299435, 'f1-score': 0.20186654580399785, 'support': 27170}, 'weighted avg': {'precision': 0.38582408660674705, 'recall': 0.35185866764814133, 'f1-score': 0.209725411579371, 'support': 27170}}
[[ 216 8656  135]
 [ 200 9124  192]
 [ 113 8314  220]]
training model: results/XRAY/W1/deepOF_L1/h300
Epoch 1/50
524/524 - 14s - loss: 3.3212 - accuracy300: 0.3590 - val_loss: 3.3526 - val_accuracy300: 0.3105 - 14s/epoch - 28ms/step
Epoch 2/50
524/524 - 12s - loss: 3.2960 - accuracy300: 0.3648 - val_loss: 3.3336 - val_accuracy300: 0.3137 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2873 - accuracy300: 0.3697 - val_loss: 3.3268 - val_accuracy300: 0.3117 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2825 - accuracy300: 0.3717 - val_loss: 3.3234 - val_accuracy300: 0.3071 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2798 - accuracy300: 0.3733 - val_loss: 3.3229 - val_accuracy300: 0.3043 - 12s/epoch - 24ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2772 - accuracy300: 0.3735 - val_loss: 3.3215 - val_accuracy300: 0.3045 - 12s/epoch - 23ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2758 - accuracy300: 0.3749 - val_loss: 3.3160 - val_accuracy300: 0.3069 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2736 - accuracy300: 0.3762 - val_loss: 3.3165 - val_accuracy300: 0.3064 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2717 - accuracy300: 0.3768 - val_loss: 3.3173 - val_accuracy300: 0.3085 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2700 - accuracy300: 0.3780 - val_loss: 3.3193 - val_accuracy300: 0.3106 - 12s/epoch - 23ms/step
Epoch 11/50
524/524 - 12s - loss: 3.2682 - accuracy300: 0.3787 - val_loss: 3.3177 - val_accuracy300: 0.3091 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2663 - accuracy300: 0.3796 - val_loss: 3.3189 - val_accuracy300: 0.3090 - 12s/epoch - 23ms/step
Epoch 13/50
524/524 - 12s - loss: 3.2643 - accuracy300: 0.3813 - val_loss: 3.3182 - val_accuracy300: 0.3112 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.2628 - accuracy300: 0.3813 - val_loss: 3.3215 - val_accuracy300: 0.3082 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 12s - loss: 3.2607 - accuracy300: 0.3840 - val_loss: 3.3209 - val_accuracy300: 0.3129 - 12s/epoch - 23ms/step
Epoch 16/50
524/524 - 12s - loss: 3.2583 - accuracy300: 0.3832 - val_loss: 3.3258 - val_accuracy300: 0.3101 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.2563 - accuracy300: 0.3844 - val_loss: 3.3282 - val_accuracy300: 0.3123 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepOF_L1/h300
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157144
{'0': {'precision': 0.3974796898079764, 'recall': 0.07171291515373597, 'f1-score': 0.12150416255115, 'support': 120076}, '1': {'precision': 0.29267152526416595, 'recall': 0.9162846950494445, 'f1-score': 0.44363962031109294, 'support': 98393}, '2': {'precision': 0.40711341779880933, 'recall': 0.0226417977604401, 'f1-score': 0.04289781409338759, 'support': 117791}, 'accuracy': 0.3016534824243145, 'macro avg': {'precision': 0.36575487762365055, 'recall': 0.33687980265454026, 'f1-score': 0.20268053231854352, 'support': 336260}, 'weighted avg': {'precision': 0.3701864545727687, 'recall': 0.3016534824243145, 'f1-score': 0.1882285832499717, 'support': 336260}}
[[  8611 109521   1944]
 [  6297  90156   1940]
 [  6756 108368   2667]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071557
{'0': {'precision': 0.40759493670886077, 'recall': 0.0679324894514768, 'f1-score': 0.11645569620253166, 'support': 47400}, '1': {'precision': 0.3106311890177469, 'recall': 0.9286558737664969, 'f1-score': 0.46554101453832947, 'support': 41447}, '2': {'precision': 0.4345857854232684, 'recall': 0.021252573553828785, 'f1-score': 0.040523427606585054, 'support': 45171}, 'accuracy': 0.3183900670059246, 'macro avg': {'precision': 0.3842706370499587, 'recall': 0.33928031225726746, 'f1-score': 0.20750671278248203, 'support': 134018}, 'weighted avg': {'precision': 0.3867048113281277, 'recall': 0.3183900670059246, 'f1-score': 0.19882226400921663, 'support': 134018}}
[[ 3220 43546   634]
 [ 2342 38490   615]
 [ 2338 41873   960]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117619
{'0': {'precision': 0.38508474576271184, 'recall': 0.05834018077239113, 'f1-score': 0.10132905182410133, 'support': 9736}, '1': {'precision': 0.30063643595863165, 'recall': 0.9267933782955242, 'f1-score': 0.4540021024177804, 'support': 8155}, '2': {'precision': 0.418018018018018, 'recall': 0.025002694255846534, 'f1-score': 0.04718324181411429, 'support': 9279}, 'accuracy': 0.3076186970923813, 'macro avg': {'precision': 0.3679130665797872, 'recall': 0.33671208444125394, 'f1-score': 0.20083813201866532, 'support': 27170}, 'weighted avg': {'precision': 0.370985072108119, 'recall': 0.3076186970923813, 'f1-score': 0.18869120701397188, 'support': 27170}}
[[ 568 9000  168]
 [ 442 7558  155]
 [ 465 8582  232]]
training model: results/XRAY/W1/deepOF_L1/h500
Epoch 1/50
524/524 - 14s - loss: 3.3331 - accuracy500: 0.3526 - val_loss: 3.3098 - val_accuracy500: 0.3724 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.3071 - accuracy500: 0.3605 - val_loss: 3.2971 - val_accuracy500: 0.3755 - 12s/epoch - 23ms/step
Epoch 3/50
524/524 - 12s - loss: 3.2976 - accuracy500: 0.3633 - val_loss: 3.2956 - val_accuracy500: 0.3774 - 12s/epoch - 23ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2940 - accuracy500: 0.3626 - val_loss: 3.2919 - val_accuracy500: 0.3728 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2875 - accuracy500: 0.3658 - val_loss: 3.2904 - val_accuracy500: 0.3699 - 12s/epoch - 23ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2842 - accuracy500: 0.3671 - val_loss: 3.2901 - val_accuracy500: 0.3710 - 12s/epoch - 24ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2816 - accuracy500: 0.3683 - val_loss: 3.2912 - val_accuracy500: 0.3623 - 12s/epoch - 23ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2780 - accuracy500: 0.3697 - val_loss: 3.2889 - val_accuracy500: 0.3628 - 12s/epoch - 23ms/step
Epoch 9/50
524/524 - 12s - loss: 3.2747 - accuracy500: 0.3714 - val_loss: 3.2890 - val_accuracy500: 0.3599 - 12s/epoch - 23ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2707 - accuracy500: 0.3740 - val_loss: 3.2896 - val_accuracy500: 0.3605 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 12s - loss: 3.2675 - accuracy500: 0.3766 - val_loss: 3.2912 - val_accuracy500: 0.3574 - 12s/epoch - 23ms/step
Epoch 12/50
524/524 - 12s - loss: 3.2654 - accuracy500: 0.3784 - val_loss: 3.2937 - val_accuracy500: 0.3531 - 12s/epoch - 24ms/step
Epoch 13/50
524/524 - 12s - loss: 3.2619 - accuracy500: 0.3798 - val_loss: 3.2946 - val_accuracy500: 0.3548 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.2585 - accuracy500: 0.3807 - val_loss: 3.2957 - val_accuracy500: 0.3501 - 12s/epoch - 23ms/step
Epoch 15/50
524/524 - 12s - loss: 3.2557 - accuracy500: 0.3838 - val_loss: 3.2959 - val_accuracy500: 0.3486 - 12s/epoch - 23ms/step
Epoch 16/50
524/524 - 12s - loss: 3.2530 - accuracy500: 0.3863 - val_loss: 3.2987 - val_accuracy500: 0.3455 - 12s/epoch - 23ms/step
Epoch 17/50
524/524 - 12s - loss: 3.2499 - accuracy500: 0.3871 - val_loss: 3.3016 - val_accuracy500: 0.3443 - 12s/epoch - 24ms/step
Epoch 18/50
524/524 - 12s - loss: 3.2480 - accuracy500: 0.3886 - val_loss: 3.3067 - val_accuracy500: 0.3394 - 12s/epoch - 23ms/step
testing model: results/XRAY/W1/deepOF_L1/h500
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049546
{'0': {'precision': 0.38671924551195436, 'recall': 0.5505323325272448, 'f1-score': 0.454310140955491, 'support': 127364}, '1': {'precision': 0.24635602673340645, 'recall': 0.3170822927600227, 'f1-score': 0.27728016036292663, 'support': 82887}, '2': {'precision': 0.39979694169325763, 'recall': 0.15312398320754866, 'f1-score': 0.2214367278548927, 'support': 126009}, 'accuracy': 0.34406411705228096, 'macro avg': {'precision': 0.34429073797953946, 'recall': 0.34024620283160534, 'f1-score': 0.31767567639110345, 'support': 336260}, 'weighted avg': {'precision': 0.35702086123553833, 'recall': 0.34406411705228096, 'f1-score': 0.32340658444335996, 'support': 336260}}
[[70118 40197 17049]
 [44687 26282 11918]
 [66510 40204 19295]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947037
{'0': {'precision': 0.3585044907052844, 'recall': 0.5604388428132959, 'f1-score': 0.4372845083818808, 'support': 45939}, '1': {'precision': 0.3565652592009791, 'recall': 0.36950219685645697, 'f1-score': 0.36291847402958516, 'support': 44154}, '2': {'precision': 0.3749619991487809, 'recall': 0.140398406374502, 'f1-score': 0.20430000662558803, 'support': 43925}, 'accuracy': 0.3598621080750347, 'macro avg': {'precision': 0.36334391635168145, 'recall': 0.356779815348085, 'f1-score': 0.334834329679018, 'support': 134018}, 'weighted avg': {'precision': 0.3632596074100516, 'recall': 0.3598621080750347, 'f1-score': 0.33642192186039555, 'support': 134018}}
[[25746 14975  5218]
 [22777 16315  5062]
 [23292 14466  6167]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976609
{'0': {'precision': 0.4037769173289858, 'recall': 0.5639468690702087, 'f1-score': 0.4706068643363287, 'support': 10540}, '1': {'precision': 0.2731008717310087, 'recall': 0.302190988011575, 'f1-score': 0.28691044678484984, 'support': 7257}, '2': {'precision': 0.37587689522516404, 'recall': 0.17721113837618693, 'f1-score': 0.2408642691415313, 'support': 9373}, 'accuracy': 0.3606183290393817, 'macro avg': {'precision': 0.35091822809505285, 'recall': 0.3477829984859902, 'f1-score': 0.33279386008756995, 'support': 27170}, 'weighted avg': {'precision': 0.35924902001269426, 'recall': 0.3606183290393817, 'f1-score': 0.3422865755276457, 'support': 27170}}
[[5944 3014 1582]
 [3888 2193 1176]
 [4889 2823 1661]]
training model: results/XRAY/W1/deepOF_L1/h1000
Epoch 1/50
524/524 - 14s - loss: 3.3293 - accuracy1000: 0.3526 - val_loss: 3.3798 - val_accuracy1000: 0.3217 - 14s/epoch - 27ms/step
Epoch 2/50
524/524 - 12s - loss: 3.3093 - accuracy1000: 0.3550 - val_loss: 3.3514 - val_accuracy1000: 0.3336 - 12s/epoch - 22ms/step
Epoch 3/50
524/524 - 12s - loss: 3.3018 - accuracy1000: 0.3525 - val_loss: 3.3217 - val_accuracy1000: 0.3443 - 12s/epoch - 22ms/step
Epoch 4/50
524/524 - 12s - loss: 3.2982 - accuracy1000: 0.3516 - val_loss: 3.3142 - val_accuracy1000: 0.3275 - 12s/epoch - 23ms/step
Epoch 5/50
524/524 - 12s - loss: 3.2951 - accuracy1000: 0.3526 - val_loss: 3.3106 - val_accuracy1000: 0.3264 - 12s/epoch - 24ms/step
Epoch 6/50
524/524 - 12s - loss: 3.2936 - accuracy1000: 0.3510 - val_loss: 3.3076 - val_accuracy1000: 0.3182 - 12s/epoch - 24ms/step
Epoch 7/50
524/524 - 12s - loss: 3.2923 - accuracy1000: 0.3523 - val_loss: 3.3065 - val_accuracy1000: 0.3162 - 12s/epoch - 24ms/step
Epoch 8/50
524/524 - 12s - loss: 3.2916 - accuracy1000: 0.3515 - val_loss: 3.3070 - val_accuracy1000: 0.3108 - 12s/epoch - 24ms/step
Epoch 9/50
524/524 - 13s - loss: 3.2896 - accuracy1000: 0.3529 - val_loss: 3.3057 - val_accuracy1000: 0.3140 - 13s/epoch - 24ms/step
Epoch 10/50
524/524 - 12s - loss: 3.2888 - accuracy1000: 0.3534 - val_loss: 3.3067 - val_accuracy1000: 0.3146 - 12s/epoch - 24ms/step
Epoch 11/50
524/524 - 13s - loss: 3.2884 - accuracy1000: 0.3545 - val_loss: 3.3083 - val_accuracy1000: 0.3126 - 13s/epoch - 24ms/step
Epoch 12/50
524/524 - 13s - loss: 3.2873 - accuracy1000: 0.3544 - val_loss: 3.3084 - val_accuracy1000: 0.3143 - 13s/epoch - 25ms/step
Epoch 13/50
524/524 - 12s - loss: 3.2864 - accuracy1000: 0.3571 - val_loss: 3.3095 - val_accuracy1000: 0.3150 - 12s/epoch - 23ms/step
Epoch 14/50
524/524 - 12s - loss: 3.2854 - accuracy1000: 0.3581 - val_loss: 3.3082 - val_accuracy1000: 0.3155 - 12s/epoch - 24ms/step
Epoch 15/50
524/524 - 12s - loss: 3.2842 - accuracy1000: 0.3599 - val_loss: 3.3089 - val_accuracy1000: 0.3154 - 12s/epoch - 23ms/step
Epoch 16/50
524/524 - 11s - loss: 3.2839 - accuracy1000: 0.3584 - val_loss: 3.3109 - val_accuracy1000: 0.3152 - 11s/epoch - 21ms/step
Epoch 17/50
524/524 - 12s - loss: 3.2813 - accuracy1000: 0.3619 - val_loss: 3.3118 - val_accuracy1000: 0.3136 - 12s/epoch - 22ms/step
Epoch 18/50
524/524 - 12s - loss: 3.2802 - accuracy1000: 0.3618 - val_loss: 3.3124 - val_accuracy1000: 0.3139 - 12s/epoch - 23ms/step
Epoch 19/50
524/524 - 12s - loss: 3.2787 - accuracy1000: 0.3647 - val_loss: 3.3145 - val_accuracy1000: 0.3129 - 12s/epoch - 22ms/step
testing model: results/XRAY/W1/deepOF_L1/h1000
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080467
{'0': {'precision': 0.35874795534310533, 'recall': 0.18970440040309036, 'f1-score': 0.2481749419112437, 'support': 119080}, '1': {'precision': 0.2942397156644871, 'recall': 0.7873296314992428, 'f1-score': 0.4283842686815586, 'support': 99050}, '2': {'precision': 0.36669898206495394, 'recall': 0.025615846948277322, 'f1-score': 0.04788656612492285, 'support': 118130}, 'accuracy': 0.30809790043418783, 'macro avg': {'precision': 0.3398955510241821, 'recall': 0.3342166262835368, 'f1-score': 0.24148192557257506, 'support': 336260}, 'weighted avg': {'precision': 0.34253940733407906, 'recall': 0.30809790043418783, 'f1-score': 0.23089565797905318, 'support': 336260}}
[[22590 93762  2728]
 [18567 77985  2498]
 [21812 93292  3026]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975899
{'0': {'precision': 0.36769553491159723, 'recall': 0.18471364975590873, 'f1-score': 0.2458988233273211, 'support': 46499}, '1': {'precision': 0.33487605753744193, 'recall': 0.8162721960244579, 'f1-score': 0.47491713432443966, 'support': 44321}, '2': {'precision': 0.37066666666666664, 'recall': 0.022524190934765497, 'f1-score': 0.04246775636688999, 'support': 43198}, 'accuracy': 0.3412974376576281, 'macro avg': {'precision': 0.357746086371902, 'recall': 0.3411700122383774, 'f1-score': 0.2544279046728836, 'support': 134018}, 'weighted avg': {'precision': 0.35779951268216204, 'recall': 0.3412974376576281, 'f1-score': 0.2560654078991442, 'support': 134018}}
[[ 8589 37070   840]
 [ 7331 36178   812]
 [ 7439 34786   973]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035271
{'0': {'precision': 0.4061613295500608, 'recall': 0.1904038004750594, 'f1-score': 0.25926644673006016, 'support': 10525}, '1': {'precision': 0.29246772545741617, 'recall': 0.8005592983348163, 'f1-score': 0.428420802013537, 'support': 7867}, '2': {'precision': 0.31196581196581197, 'recall': 0.024948735475051265, 'f1-score': 0.04620253164556962, 'support': 8778}, 'accuracy': 0.31361796098638206, 'macro avg': {'precision': 0.336864955657763, 'recall': 0.3386372780949756, 'f1-score': 0.24462992679638895, 'support': 27170}, 'weighted avg': {'precision': 0.3428092560590276, 'recall': 0.31361796098638206, 'f1-score': 0.23940859860357708, 'support': 27170}}
[[2004 8259  262]
 [1348 6298  221]
 [1582 6977  219]]
training model: results/XRAY/W1/deepLOB_L2/h10
Epoch 1/50
524/524 - 27s - loss: 3.2143 - accuracy10: 0.4309 - val_loss: 3.4292 - val_accuracy10: 0.3784 - 27s/epoch - 52ms/step
Epoch 2/50
524/524 - 24s - loss: 3.0649 - accuracy10: 0.4661 - val_loss: 3.3407 - val_accuracy10: 0.4298 - 24s/epoch - 47ms/step
Epoch 3/50
524/524 - 25s - loss: 2.9933 - accuracy10: 0.4845 - val_loss: 3.3046 - val_accuracy10: 0.4446 - 25s/epoch - 47ms/step
Epoch 4/50
524/524 - 24s - loss: 2.9539 - accuracy10: 0.4945 - val_loss: 3.2474 - val_accuracy10: 0.4423 - 24s/epoch - 47ms/step
Epoch 5/50
524/524 - 25s - loss: 2.9181 - accuracy10: 0.5073 - val_loss: 3.2204 - val_accuracy10: 0.4508 - 25s/epoch - 47ms/step
Epoch 6/50
524/524 - 25s - loss: 2.8869 - accuracy10: 0.5170 - val_loss: 3.2070 - val_accuracy10: 0.4490 - 25s/epoch - 47ms/step
Epoch 7/50
524/524 - 25s - loss: 2.8636 - accuracy10: 0.5245 - val_loss: 3.1941 - val_accuracy10: 0.4548 - 25s/epoch - 47ms/step
Epoch 8/50
524/524 - 24s - loss: 2.8490 - accuracy10: 0.5287 - val_loss: 3.1800 - val_accuracy10: 0.4663 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 2.8269 - accuracy10: 0.5376 - val_loss: 3.2052 - val_accuracy10: 0.4534 - 24s/epoch - 47ms/step
Epoch 10/50
524/524 - 25s - loss: 2.8196 - accuracy10: 0.5389 - val_loss: 3.1761 - val_accuracy10: 0.4621 - 25s/epoch - 47ms/step
Epoch 11/50
524/524 - 24s - loss: 2.8029 - accuracy10: 0.5441 - val_loss: 3.1711 - val_accuracy10: 0.4635 - 24s/epoch - 47ms/step
Epoch 12/50
524/524 - 24s - loss: 2.7873 - accuracy10: 0.5490 - val_loss: 3.1730 - val_accuracy10: 0.4717 - 24s/epoch - 46ms/step
Epoch 13/50
524/524 - 24s - loss: 2.7700 - accuracy10: 0.5548 - val_loss: 3.1842 - val_accuracy10: 0.4686 - 24s/epoch - 46ms/step
Epoch 14/50
524/524 - 24s - loss: 2.7565 - accuracy10: 0.5595 - val_loss: 3.1747 - val_accuracy10: 0.4790 - 24s/epoch - 46ms/step
Epoch 15/50
524/524 - 24s - loss: 2.7406 - accuracy10: 0.5636 - val_loss: 3.1752 - val_accuracy10: 0.4718 - 24s/epoch - 47ms/step
Epoch 16/50
524/524 - 24s - loss: 2.7370 - accuracy10: 0.5624 - val_loss: 3.1887 - val_accuracy10: 0.4776 - 24s/epoch - 45ms/step
Epoch 17/50
524/524 - 24s - loss: 2.7219 - accuracy10: 0.5694 - val_loss: 3.1877 - val_accuracy10: 0.4825 - 24s/epoch - 46ms/step
Epoch 18/50
524/524 - 24s - loss: 2.7109 - accuracy10: 0.5719 - val_loss: 3.2190 - val_accuracy10: 0.4790 - 24s/epoch - 46ms/step
Epoch 19/50
524/524 - 24s - loss: 2.7057 - accuracy10: 0.5722 - val_loss: 3.1919 - val_accuracy10: 0.4774 - 24s/epoch - 45ms/step
Epoch 20/50
524/524 - 24s - loss: 2.6924 - accuracy10: 0.5764 - val_loss: 3.2130 - val_accuracy10: 0.4736 - 24s/epoch - 47ms/step
Epoch 21/50
524/524 - 24s - loss: 2.6830 - accuracy10: 0.5778 - val_loss: 3.1980 - val_accuracy10: 0.4816 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h10
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0790219
{'0': {'precision': 0.4408176186727814, 'recall': 0.47637143676088506, 'f1-score': 0.4579054255229326, 'support': 108153}, '1': {'precision': 0.5433218101822753, 'recall': 0.2968900261024866, 'f1-score': 0.3839670412650468, 'support': 116464}, '2': {'precision': 0.4335372939794156, 'recall': 0.6047846804241903, 'f1-score': 0.5050393235526203, 'support': 111648}, 'accuracy': 0.4568450478045589, 'macro avg': {'precision': 0.4725589076114907, 'recall': 0.4593487144291873, 'f1-score': 0.44897059678019985, 'support': 336265}, 'weighted avg': {'precision': 0.4739022824605583, 'recall': 0.4568450478045589, 'f1-score': 0.4479467484765798, 'support': 336265}}
[[51521 14113 42519]
 [36180 34577 45707]
 [29175 14950 67523]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0202291
{'0': {'precision': 0.41137651936038805, 'recall': 0.4094941328392566, 'f1-score': 0.41043316779448796, 'support': 35622}, '1': {'precision': 0.5920046801872075, 'recall': 0.4873811970202928, 'f1-score': 0.5346224288531981, 'support': 62288}, '2': {'precision': 0.4035618350641934, 'recall': 0.5284147557328016, 'f1-score': 0.45762528931368196, 'support': 36108}, 'accuracy': 0.47773433419391426, 'macro avg': {'precision': 0.468981011537263, 'recall': 0.4750966951974503, 'f1-score': 0.467560295320456, 'support': 134018}, 'weighted avg': {'precision': 0.49322219875430484, 'recall': 0.47773433419391426, 'f1-score': 0.4808678393806928, 'support': 134018}}
[[14587 10036 10999]
 [14730 30358 17200]
 [ 6142 10886 19080]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0565035
{'0': {'precision': 0.47039059218815626, 'recall': 0.5159507082805482, 'f1-score': 0.49211841599384853, 'support': 8683}, '1': {'precision': 0.6003954305799648, 'recall': 0.27692775357179045, 'f1-score': 0.3790305804035781, 'support': 9869}, '2': {'precision': 0.4172139911409806, 'recall': 0.6339057786029241, 'f1-score': 0.5032240235814296, 'support': 8618}, 'accuracy': 0.466543982333456, 'macro avg': {'precision': 0.4960000046363673, 'recall': 0.47559474681842095, 'f1-score': 0.45812433999295205, 'support': 27170}, 'weighted avg': {'precision': 0.5007454616126759, 'recall': 0.466543982333456, 'f1-score': 0.45456391753044756, 'support': 27170}}
[[4480  952 3251]
 [2756 2733 4380]
 [2288  867 5463]]
training model: results/XRAY/W1/deepLOB_L2/h20
Epoch 1/50
524/524 - 27s - loss: 3.2229 - accuracy20: 0.4138 - val_loss: 3.6408 - val_accuracy20: 0.2953 - 27s/epoch - 51ms/step
Epoch 2/50
524/524 - 25s - loss: 3.1101 - accuracy20: 0.4476 - val_loss: 3.3533 - val_accuracy20: 0.3756 - 25s/epoch - 47ms/step
Epoch 3/50
524/524 - 24s - loss: 3.0319 - accuracy20: 0.4745 - val_loss: 3.2103 - val_accuracy20: 0.4403 - 24s/epoch - 46ms/step
Epoch 4/50
524/524 - 24s - loss: 2.9779 - accuracy20: 0.4884 - val_loss: 3.2265 - val_accuracy20: 0.4435 - 24s/epoch - 45ms/step
Epoch 5/50
524/524 - 24s - loss: 2.9437 - accuracy20: 0.4966 - val_loss: 3.1562 - val_accuracy20: 0.4562 - 24s/epoch - 46ms/step
Epoch 6/50
524/524 - 25s - loss: 2.9236 - accuracy20: 0.5040 - val_loss: 3.1516 - val_accuracy20: 0.4584 - 25s/epoch - 47ms/step
Epoch 7/50
524/524 - 24s - loss: 2.9084 - accuracy20: 0.5092 - val_loss: 3.1247 - val_accuracy20: 0.4600 - 24s/epoch - 47ms/step
Epoch 8/50
524/524 - 25s - loss: 2.8942 - accuracy20: 0.5108 - val_loss: 3.1108 - val_accuracy20: 0.4648 - 25s/epoch - 47ms/step
Epoch 9/50
524/524 - 24s - loss: 2.8748 - accuracy20: 0.5186 - val_loss: 3.1219 - val_accuracy20: 0.4627 - 24s/epoch - 47ms/step
Epoch 10/50
524/524 - 24s - loss: 2.8666 - accuracy20: 0.5201 - val_loss: 3.1060 - val_accuracy20: 0.4652 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 24s - loss: 2.8630 - accuracy20: 0.5225 - val_loss: 3.1054 - val_accuracy20: 0.4701 - 24s/epoch - 46ms/step
Epoch 12/50
524/524 - 24s - loss: 2.8456 - accuracy20: 0.5250 - val_loss: 3.1061 - val_accuracy20: 0.4734 - 24s/epoch - 46ms/step
Epoch 13/50
524/524 - 24s - loss: 2.8329 - accuracy20: 0.5296 - val_loss: 3.1025 - val_accuracy20: 0.4683 - 24s/epoch - 46ms/step
Epoch 14/50
524/524 - 24s - loss: 2.8282 - accuracy20: 0.5326 - val_loss: 3.1119 - val_accuracy20: 0.4695 - 24s/epoch - 46ms/step
Epoch 15/50
524/524 - 24s - loss: 2.8094 - accuracy20: 0.5357 - val_loss: 3.1464 - val_accuracy20: 0.4650 - 24s/epoch - 46ms/step
Epoch 16/50
524/524 - 24s - loss: 2.8008 - accuracy20: 0.5380 - val_loss: 3.1146 - val_accuracy20: 0.4675 - 24s/epoch - 46ms/step
Epoch 17/50
524/524 - 24s - loss: 2.7907 - accuracy20: 0.5405 - val_loss: 3.1319 - val_accuracy20: 0.4636 - 24s/epoch - 46ms/step
Epoch 18/50
524/524 - 24s - loss: 2.7826 - accuracy20: 0.5429 - val_loss: 3.1395 - val_accuracy20: 0.4640 - 24s/epoch - 46ms/step
Epoch 19/50
524/524 - 24s - loss: 2.7701 - accuracy20: 0.5466 - val_loss: 3.1551 - val_accuracy20: 0.4627 - 24s/epoch - 46ms/step
Epoch 20/50
524/524 - 24s - loss: 2.7593 - accuracy20: 0.5496 - val_loss: 3.1838 - val_accuracy20: 0.4581 - 24s/epoch - 46ms/step
Epoch 21/50
524/524 - 24s - loss: 2.7496 - accuracy20: 0.5530 - val_loss: 3.1663 - val_accuracy20: 0.4653 - 24s/epoch - 46ms/step
Epoch 22/50
524/524 - 24s - loss: 2.7403 - accuracy20: 0.5549 - val_loss: 3.1769 - val_accuracy20: 0.4612 - 24s/epoch - 46ms/step
Epoch 23/50
524/524 - 24s - loss: 2.7300 - accuracy20: 0.5572 - val_loss: 3.2400 - val_accuracy20: 0.4553 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h20
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0500623
{'0': {'precision': 0.4862485117900489, 'recall': 0.4437895263482931, 'f1-score': 0.46404982997645833, 'support': 127921}, '1': {'precision': 0.3867115507578892, 'recall': 0.26906469171987857, 'f1-score': 0.31733514406086516, 'support': 76424}, '2': {'precision': 0.47622940964290006, 'recall': 0.6004851425106125, 'f1-score': 0.5311875544826661, 'support': 131920}, 'accuracy': 0.46555246606099354, 'macro avg': {'precision': 0.4497298240636127, 'recall': 0.43777978685959473, 'f1-score': 0.4375241761733299, 'support': 336265}, 'weighted avg': {'precision': 0.4596958445033148, 'recall': 0.46555246606099354, 'f1-score': 0.45704429999399104, 'support': 336265}}
[[56770 16382 54769]
 [23506 20563 32355]
 [36475 16229 79216]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0120546
{'0': {'precision': 0.4549527828008841, 'recall': 0.5280919840473913, 'f1-score': 0.48880158019147946, 'support': 42877}, '1': {'precision': 0.5660455486542443, 'recall': 0.46112329229212345, 'f1-score': 0.5082256715308114, 'support': 47432}, '2': {'precision': 0.45566567268900193, 'recall': 0.47546271934841794, 'f1-score': 0.46535374004948665, 'support': 43709}, 'accuracy': 0.48722559656165587, 'macro avg': {'precision': 0.49222133471471013, 'recall': 0.48822599856264426, 'f1-score': 0.4874603305905925, 'support': 134018}, 'weighted avg': {'precision': 0.4945035280297065, 'recall': 0.48722559656165587, 'f1-score': 0.4880288620166136, 'support': 134018}}
[[22643  8360 11874]
 [12608 21872 12952]
 [14519  8408 20782]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0338702
{'0': {'precision': 0.4932246922327517, 'recall': 0.5397363830199651, 'f1-score': 0.515433384238049, 'support': 10318}, '1': {'precision': 0.4287257019438445, 'recall': 0.18292121025956073, 'f1-score': 0.2564323393260846, 'support': 6511}, '2': {'precision': 0.463323410426685, 'recall': 0.5869838506914224, 'f1-score': 0.5178739015442368, 'support': 10341}, 'accuracy': 0.472211998527788, 'macro avg': {'precision': 0.46175793486776046, 'recall': 0.4365471479903161, 'f1-score': 0.4299132083694568, 'support': 27170}, 'weighted avg': {'precision': 0.46638766312242375, 'recall': 0.472211998527788, 'f1-score': 0.4542954227379198, 'support': 27170}}
[[5569  866 3883]
 [2172 1191 3148]
 [3550  721 6070]]
training model: results/XRAY/W1/deepLOB_L2/h30
Epoch 1/50
524/524 - 26s - loss: 3.2438 - accuracy30: 0.4025 - val_loss: 3.3648 - val_accuracy30: 0.3381 - 26s/epoch - 50ms/step
Epoch 2/50
524/524 - 24s - loss: 3.1566 - accuracy30: 0.4284 - val_loss: 3.1937 - val_accuracy30: 0.4144 - 24s/epoch - 45ms/step
Epoch 3/50
524/524 - 24s - loss: 3.0739 - accuracy30: 0.4587 - val_loss: 3.1670 - val_accuracy30: 0.4351 - 24s/epoch - 46ms/step
Epoch 4/50
524/524 - 24s - loss: 3.0245 - accuracy30: 0.4733 - val_loss: 3.1569 - val_accuracy30: 0.4384 - 24s/epoch - 47ms/step
Epoch 5/50
524/524 - 24s - loss: 2.9988 - accuracy30: 0.4818 - val_loss: 3.1156 - val_accuracy30: 0.4520 - 24s/epoch - 46ms/step
Epoch 6/50
524/524 - 24s - loss: 2.9816 - accuracy30: 0.4876 - val_loss: 3.1284 - val_accuracy30: 0.4470 - 24s/epoch - 46ms/step
Epoch 7/50
524/524 - 24s - loss: 2.9680 - accuracy30: 0.4917 - val_loss: 3.1140 - val_accuracy30: 0.4515 - 24s/epoch - 45ms/step
Epoch 8/50
524/524 - 24s - loss: 2.9613 - accuracy30: 0.4939 - val_loss: 3.1260 - val_accuracy30: 0.4469 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 2.9447 - accuracy30: 0.4993 - val_loss: 3.1035 - val_accuracy30: 0.4580 - 24s/epoch - 46ms/step
Epoch 10/50
524/524 - 24s - loss: 2.9348 - accuracy30: 0.5019 - val_loss: 3.1014 - val_accuracy30: 0.4600 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 24s - loss: 2.9247 - accuracy30: 0.5064 - val_loss: 3.0973 - val_accuracy30: 0.4631 - 24s/epoch - 47ms/step
Epoch 12/50
524/524 - 24s - loss: 2.9163 - accuracy30: 0.5069 - val_loss: 3.0988 - val_accuracy30: 0.4576 - 24s/epoch - 46ms/step
Epoch 13/50
524/524 - 24s - loss: 2.9025 - accuracy30: 0.5123 - val_loss: 3.0925 - val_accuracy30: 0.4650 - 24s/epoch - 47ms/step
Epoch 14/50
524/524 - 24s - loss: 2.8943 - accuracy30: 0.5124 - val_loss: 3.0978 - val_accuracy30: 0.4656 - 24s/epoch - 46ms/step
Epoch 15/50
524/524 - 24s - loss: 2.8894 - accuracy30: 0.5152 - val_loss: 3.1073 - val_accuracy30: 0.4641 - 24s/epoch - 46ms/step
Epoch 16/50
524/524 - 24s - loss: 2.8781 - accuracy30: 0.5193 - val_loss: 3.1165 - val_accuracy30: 0.4633 - 24s/epoch - 46ms/step
Epoch 17/50
524/524 - 24s - loss: 2.8665 - accuracy30: 0.5223 - val_loss: 3.1038 - val_accuracy30: 0.4657 - 24s/epoch - 46ms/step
Epoch 18/50
524/524 - 24s - loss: 2.8602 - accuracy30: 0.5239 - val_loss: 3.1289 - val_accuracy30: 0.4580 - 24s/epoch - 46ms/step
Epoch 19/50
524/524 - 24s - loss: 2.8503 - accuracy30: 0.5264 - val_loss: 3.1240 - val_accuracy30: 0.4609 - 24s/epoch - 46ms/step
Epoch 20/50
524/524 - 24s - loss: 2.8359 - accuracy30: 0.5320 - val_loss: 3.1420 - val_accuracy30: 0.4606 - 24s/epoch - 46ms/step
Epoch 21/50
524/524 - 24s - loss: 2.8261 - accuracy30: 0.5348 - val_loss: 3.1300 - val_accuracy30: 0.4616 - 24s/epoch - 46ms/step
Epoch 22/50
524/524 - 24s - loss: 2.8162 - accuracy30: 0.5372 - val_loss: 3.1331 - val_accuracy30: 0.4595 - 24s/epoch - 47ms/step
Epoch 23/50
524/524 - 25s - loss: 2.8087 - accuracy30: 0.5391 - val_loss: 3.1513 - val_accuracy30: 0.4622 - 25s/epoch - 48ms/step
testing model: results/XRAY/W1/deepLOB_L2/h30
Evaluating performance on  test set...
1314/1314 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0626065
{'0': {'precision': 0.46753171480942135, 'recall': 0.48997752535989797, 'f1-score': 0.47849153415810575, 'support': 131704}, '1': {'precision': 0.3546624361008285, 'recall': 0.2304300521101758, 'f1-score': 0.2793571453365268, 'support': 69852}, '2': {'precision': 0.4749826631949442, 'recall': 0.538961762020355, 'f1-score': 0.5049536971028956, 'support': 134709}, 'accuracy': 0.45568524824171414, 'macro avg': {'precision': 0.43239227136839803, 'recall': 0.4197897798301429, 'f1-score': 0.42093412553250936, 'support': 336265}, 'weighted avg': {'precision': 0.44707036721069054, 'recall': 0.45568524824171414, 'f1-score': 0.4477263822099838, 'support': 336265}}
[[64532 14952 52220]
 [25725 16096 28031]
 [47770 14336 72603]]
Evaluating performance on  train set...
524/524 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0313845
{'0': {'precision': 0.4441828147919401, 'recall': 0.5132928896422517, 'f1-score': 0.47624368843638776, 'support': 44836}, '1': {'precision': 0.5225236098120267, 'recall': 0.39488325428675664, 'f1-score': 0.4498240236886193, 'support': 43856}, '2': {'precision': 0.4498094286937203, 'recall': 0.48689493888717295, 'f1-score': 0.4676180487133035, 'support': 45326}, 'accuracy': 0.4656165589696906, 'macro avg': {'precision': 0.47217195109922905, 'recall': 0.4650236942720604, 'f1-score': 0.4645619202794369, 'support': 134018}, 'weighted avg': {'precision': 0.47172199466414394, 'recall': 0.4656165589696906, 'f1-score': 0.4646808643137576, 'support': 134018}}
[[23014  7859 13963]
 [13507 17318 13031]
 [15291  7966 22069]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0328418
{'0': {'precision': 0.4752411575562701, 'recall': 0.5567903559992465, 'f1-score': 0.5127938242692341, 'support': 10618}, '1': {'precision': 0.3780769230769231, 'recall': 0.168120403625791, 'f1-score': 0.2327453533798982, 'support': 5847}, '2': {'precision': 0.4679307502061006, 'recall': 0.5302195235871088, 'f1-score': 0.49713159623385156, 'support': 10705}, 'accuracy': 0.4626794258373206, 'macro avg': {'precision': 0.44041627694643126, 'recall': 0.4183767610707154, 'f1-score': 0.41422359129432795, 'support': 27170}, 'weighted avg': {'precision': 0.45145105120057244, 'recall': 0.4626794258373206, 'f1-score': 0.44635629904256063, 'support': 27170}}
[[5912  832 3874]
 [2284  983 2580]
 [4244  785 5676]]
training model: results/XRAY/W1/deepLOB_L2/h50
Epoch 1/50
524/524 - 27s - loss: 3.2925 - accuracy50: 0.3818 - val_loss: 3.5311 - val_accuracy50: 0.3511 - 27s/epoch - 52ms/step
Epoch 2/50
524/524 - 24s - loss: 3.2256 - accuracy50: 0.4051 - val_loss: 3.3506 - val_accuracy50: 0.3759 - 24s/epoch - 47ms/step
Epoch 3/50
524/524 - 25s - loss: 3.1715 - accuracy50: 0.4281 - val_loss: 3.2855 - val_accuracy50: 0.4006 - 25s/epoch - 47ms/step
Epoch 4/50
524/524 - 25s - loss: 3.1395 - accuracy50: 0.4411 - val_loss: 3.2942 - val_accuracy50: 0.3935 - 25s/epoch - 47ms/step
Epoch 5/50
524/524 - 25s - loss: 3.1204 - accuracy50: 0.4468 - val_loss: 3.2566 - val_accuracy50: 0.4073 - 25s/epoch - 47ms/step
Epoch 6/50
524/524 - 24s - loss: 3.1088 - accuracy50: 0.4524 - val_loss: 3.2957 - val_accuracy50: 0.3946 - 24s/epoch - 46ms/step
Epoch 7/50
524/524 - 24s - loss: 3.0988 - accuracy50: 0.4558 - val_loss: 3.2627 - val_accuracy50: 0.4060 - 24s/epoch - 46ms/step
Epoch 8/50
524/524 - 24s - loss: 3.0854 - accuracy50: 0.4602 - val_loss: 3.2728 - val_accuracy50: 0.4064 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 25s - loss: 3.0751 - accuracy50: 0.4639 - val_loss: 3.2696 - val_accuracy50: 0.4022 - 25s/epoch - 47ms/step
Epoch 10/50
524/524 - 25s - loss: 3.0653 - accuracy50: 0.4659 - val_loss: 3.3102 - val_accuracy50: 0.3989 - 25s/epoch - 47ms/step
Epoch 11/50
524/524 - 24s - loss: 3.0551 - accuracy50: 0.4691 - val_loss: 3.3029 - val_accuracy50: 0.4006 - 24s/epoch - 47ms/step
Epoch 12/50
524/524 - 24s - loss: 3.0465 - accuracy50: 0.4732 - val_loss: 3.3378 - val_accuracy50: 0.3986 - 24s/epoch - 47ms/step
Epoch 13/50
524/524 - 25s - loss: 3.0365 - accuracy50: 0.4763 - val_loss: 3.3274 - val_accuracy50: 0.3980 - 25s/epoch - 47ms/step
Epoch 14/50
524/524 - 24s - loss: 3.0279 - accuracy50: 0.4784 - val_loss: 3.3462 - val_accuracy50: 0.3972 - 24s/epoch - 46ms/step
Epoch 15/50
524/524 - 24s - loss: 3.0164 - accuracy50: 0.4828 - val_loss: 3.3486 - val_accuracy50: 0.3997 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h50
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987949
{'0': {'precision': 0.4153580817900537, 'recall': 0.5140787643305992, 'f1-score': 0.4594755853129589, 'support': 125082}, '1': {'precision': 0.3181220563516235, 'recall': 0.22481094240652968, 'f1-score': 0.26344804774177544, 'support': 85027}, '2': {'precision': 0.42076511737127886, 'recall': 0.4047924791527949, 'f1-score': 0.41262428137991214, 'support': 126156}, 'accuracy': 0.3999345754092754, 'macro avg': {'precision': 0.3847484185043187, 'recall': 0.38122739529664124, 'f1-score': 0.37851597147821553, 'support': 336265}, 'weighted avg': {'precision': 0.39279980913554496, 'recall': 0.3999345754092754, 'f1-score': 0.3923314979531609, 'support': 336265}}
[[64302 20146 40634]
 [36246 19115 29666]
 [54263 20826 51067]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0665641
{'0': {'precision': 0.42249466324592155, 'recall': 0.4783264229174519, 'f1-score': 0.44868035190615835, 'support': 45101}, '1': {'precision': 0.45153019218555196, 'recall': 0.43465954122415706, 'f1-score': 0.44293428096732507, 'support': 44161}, '2': {'precision': 0.41104188300449984, 'recall': 0.37145857538654037, 'f1-score': 0.390249055186498, 'support': 44756}, 'accuracy': 0.42824844423883357, 'macro avg': {'precision': 0.42835557947865777, 'recall': 0.42814817984271647, 'f1-score': 0.4272878960199938, 'support': 134018}, 'weighted avg': {'precision': 0.42823760345557954, 'recall': 0.42824844423883357, 'f1-score': 0.4272735009255816, 'support': 134018}}
[[21573 11602 11926]
 [13071 19195 11895]
 [16417 11714 16625]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0867262
{'0': {'precision': 0.4138869097739491, 'recall': 0.6293086468386843, 'f1-score': 0.4993552924627828, 'support': 10154}, '1': {'precision': 0.32900662251655627, 'recall': 0.18147282291057862, 'f1-score': 0.23392033148130711, 'support': 6844}, '2': {'precision': 0.41704374057315236, 'recall': 0.326189539913488, 'f1-score': 0.36606354810238306, 'support': 10172}, 'accuracy': 0.403018034596982, 'macro avg': {'precision': 0.3866457576212192, 'recall': 0.37899033655425035, 'f1-score': 0.36644639068215773, 'support': 27170}, 'weighted avg': {'precision': 0.3936878150702281, 'recall': 0.403018034596982, 'f1-score': 0.3825911961583586, 'support': 27170}}
[[6390 1266 2498]
 [3462 1242 2140]
 [5587 1267 3318]]
training model: results/XRAY/W1/deepLOB_L2/h100
Epoch 1/50
524/524 - 27s - loss: 3.3029 - accuracy100: 0.3760 - val_loss: 3.3347 - val_accuracy100: 0.3620 - 27s/epoch - 51ms/step
Epoch 2/50
524/524 - 25s - loss: 3.2576 - accuracy100: 0.3856 - val_loss: 3.2873 - val_accuracy100: 0.3719 - 25s/epoch - 47ms/step
Epoch 3/50
524/524 - 25s - loss: 3.2339 - accuracy100: 0.3974 - val_loss: 3.2734 - val_accuracy100: 0.3713 - 25s/epoch - 47ms/step
Epoch 4/50
524/524 - 25s - loss: 3.2171 - accuracy100: 0.4063 - val_loss: 3.2599 - val_accuracy100: 0.3811 - 25s/epoch - 47ms/step
Epoch 5/50
524/524 - 25s - loss: 3.2010 - accuracy100: 0.4144 - val_loss: 3.2613 - val_accuracy100: 0.3846 - 25s/epoch - 47ms/step
Epoch 6/50
524/524 - 25s - loss: 3.1894 - accuracy100: 0.4189 - val_loss: 3.2595 - val_accuracy100: 0.3851 - 25s/epoch - 47ms/step
Epoch 7/50
524/524 - 24s - loss: 3.1770 - accuracy100: 0.4236 - val_loss: 3.3072 - val_accuracy100: 0.3892 - 24s/epoch - 46ms/step
Epoch 8/50
524/524 - 25s - loss: 3.1647 - accuracy100: 0.4279 - val_loss: 3.3051 - val_accuracy100: 0.3844 - 25s/epoch - 47ms/step
Epoch 9/50
524/524 - 25s - loss: 3.1560 - accuracy100: 0.4301 - val_loss: 3.2934 - val_accuracy100: 0.3863 - 25s/epoch - 47ms/step
Epoch 10/50
524/524 - 24s - loss: 3.1489 - accuracy100: 0.4332 - val_loss: 3.2980 - val_accuracy100: 0.3858 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 24s - loss: 3.1392 - accuracy100: 0.4383 - val_loss: 3.3207 - val_accuracy100: 0.3853 - 24s/epoch - 45ms/step
Epoch 12/50
524/524 - 23s - loss: 3.1300 - accuracy100: 0.4394 - val_loss: 3.2944 - val_accuracy100: 0.3879 - 23s/epoch - 44ms/step
Epoch 13/50
524/524 - 23s - loss: 3.1167 - accuracy100: 0.4467 - val_loss: 3.3147 - val_accuracy100: 0.3852 - 23s/epoch - 44ms/step
Epoch 14/50
524/524 - 23s - loss: 3.1054 - accuracy100: 0.4497 - val_loss: 3.3460 - val_accuracy100: 0.3819 - 23s/epoch - 45ms/step
Epoch 15/50
524/524 - 24s - loss: 3.0950 - accuracy100: 0.4553 - val_loss: 3.3352 - val_accuracy100: 0.3769 - 24s/epoch - 46ms/step
Epoch 16/50
524/524 - 24s - loss: 3.0831 - accuracy100: 0.4580 - val_loss: 3.3644 - val_accuracy100: 0.3763 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h100
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004763
{'0': {'precision': 0.3865586133317744, 'recall': 0.4302970651395848, 'f1-score': 0.40725685382359056, 'support': 122936}, '1': {'precision': 0.3057411869922739, 'recall': 0.1322707536219423, 'f1-score': 0.1846553185743115, 'support': 93044}, '2': {'precision': 0.37189475139162886, 'recall': 0.4921062476618032, 'f1-score': 0.42363777549552517, 'support': 120285}, 'accuracy': 0.3699433482521226, 'macro avg': {'precision': 0.35473151723855906, 'recall': 0.3515580221411101, 'f1-score': 0.3385166492978091, 'support': 336265}, 'weighted avg': {'precision': 0.3589511631070918, 'recall': 0.3699433482521226, 'f1-score': 0.3515229591797077, 'support': 336265}}
[[52899 14011 56026]
 [36790 12307 43947]
 [47157 13935 59193]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0797814
{'0': {'precision': 0.3752053875170674, 'recall': 0.3607137295036376, 'f1-score': 0.36781687424850834, 'support': 44947}, '1': {'precision': 0.4481265298437206, 'recall': 0.26522243023981457, 'f1-score': 0.3332259916273469, 'support': 44868}, '2': {'precision': 0.3796457697814854, 'recall': 0.5518403728253738, 'f1-score': 0.4498271172375639, 'support': 44203}, 'accuracy': 0.3917831933023922, 'macro avg': {'precision': 0.4009925623807578, 'recall': 0.392592177522942, 'f1-score': 0.383623327704473, 'support': 134018}, 'weighted avg': {'precision': 0.4010832847483822, 'recall': 0.3917831933023922, 'f1-score': 0.3832855056965149, 'support': 134018}}
[[16213  7741 20993]
 [14102 11900 18866]
 [12896  6914 24393]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085332
{'0': {'precision': 0.39522218096299044, 'recall': 0.6347281582347679, 'f1-score': 0.4871276555169915, 'support': 10061}, '1': {'precision': 0.3551561831407788, 'recall': 0.11349651305893614, 'f1-score': 0.17202072538860103, 'support': 7313}, '2': {'precision': 0.37890489913544667, 'recall': 0.33554512045732954, 'f1-score': 0.35590926316929244, 'support': 9796}, 'accuracy': 0.3865660655134339, 'macro avg': {'precision': 0.3764277544130719, 'recall': 0.36125659725034454, 'f1-score': 0.3383525480249616, 'support': 27170}, 'weighted avg': {'precision': 0.37855502104924543, 'recall': 0.3865660655134339, 'f1-score': 0.3550042712156673, 'support': 27170}}
[[6386  767 2908]
 [4003  830 2480]
 [5769  740 3287]]
training model: results/XRAY/W1/deepLOB_L2/h200
Epoch 1/50
524/524 - 26s - loss: 3.3064 - accuracy200: 0.3737 - val_loss: 3.4498 - val_accuracy200: 0.3689 - 26s/epoch - 50ms/step
Epoch 2/50
524/524 - 24s - loss: 3.2739 - accuracy200: 0.3790 - val_loss: 3.3352 - val_accuracy200: 0.3666 - 24s/epoch - 46ms/step
Epoch 3/50
524/524 - 24s - loss: 3.2586 - accuracy200: 0.3861 - val_loss: 3.3440 - val_accuracy200: 0.3612 - 24s/epoch - 46ms/step
Epoch 4/50
524/524 - 24s - loss: 3.2469 - accuracy200: 0.3932 - val_loss: 3.3769 - val_accuracy200: 0.3504 - 24s/epoch - 46ms/step
Epoch 5/50
524/524 - 24s - loss: 3.2365 - accuracy200: 0.3997 - val_loss: 3.3338 - val_accuracy200: 0.3508 - 24s/epoch - 46ms/step
Epoch 6/50
524/524 - 24s - loss: 3.2171 - accuracy200: 0.4117 - val_loss: 3.3510 - val_accuracy200: 0.3610 - 24s/epoch - 46ms/step
Epoch 7/50
524/524 - 24s - loss: 3.2028 - accuracy200: 0.4155 - val_loss: 3.3393 - val_accuracy200: 0.3639 - 24s/epoch - 46ms/step
Epoch 8/50
524/524 - 24s - loss: 3.1969 - accuracy200: 0.4205 - val_loss: 3.3364 - val_accuracy200: 0.3698 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 3.1801 - accuracy200: 0.4272 - val_loss: 3.3409 - val_accuracy200: 0.3654 - 24s/epoch - 46ms/step
Epoch 10/50
524/524 - 24s - loss: 3.1661 - accuracy200: 0.4316 - val_loss: 3.3460 - val_accuracy200: 0.3654 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 24s - loss: 3.1528 - accuracy200: 0.4372 - val_loss: 3.3985 - val_accuracy200: 0.3636 - 24s/epoch - 46ms/step
Epoch 12/50
524/524 - 24s - loss: 3.1412 - accuracy200: 0.4440 - val_loss: 3.3780 - val_accuracy200: 0.3554 - 24s/epoch - 46ms/step
Epoch 13/50
524/524 - 24s - loss: 3.1224 - accuracy200: 0.4487 - val_loss: 3.3829 - val_accuracy200: 0.3639 - 24s/epoch - 47ms/step
Epoch 14/50
524/524 - 25s - loss: 3.1139 - accuracy200: 0.4521 - val_loss: 3.3744 - val_accuracy200: 0.3677 - 25s/epoch - 47ms/step
Epoch 15/50
524/524 - 25s - loss: 3.0961 - accuracy200: 0.4593 - val_loss: 3.3777 - val_accuracy200: 0.3692 - 25s/epoch - 47ms/step
testing model: results/XRAY/W1/deepLOB_L2/h200
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1306124
{'0': {'precision': 0.35918019237870824, 'recall': 0.363265306122449, 'f1-score': 0.3612111994836177, 'support': 112455}, '1': {'precision': 0.3501644418649642, 'recall': 0.3015317708744334, 'f1-score': 0.3240335057617473, 'support': 114051}, '2': {'precision': 0.32557110682110685, 'recall': 0.3687624705035578, 'f1-score': 0.3458234185894506, 'support': 109759}, 'accuracy': 0.34412145183114506, 'macro avg': {'precision': 0.3449719136882598, 'recall': 0.3445198491668134, 'f1-score': 0.3436893746116052, 'support': 336265}, 'weighted avg': {'precision': 0.34515210446126277, 'recall': 0.34412145183114506, 'f1-score': 0.34357897314476016, 'support': 336265}}
[[40851 31891 39713]
 [35529 34390 44132]
 [37354 31930 40475]]
Evaluating performance on  train set...
524/524 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034411
{'0': {'precision': 0.35730136578893185, 'recall': 0.3441225074363777, 'f1-score': 0.3505881296578971, 'support': 45385}, '1': {'precision': 0.3596980737597811, 'recall': 0.5241839729372494, 'f1-score': 0.42663603376912274, 'support': 44637}, '2': {'precision': 0.372674004275873, 'recall': 0.2139512682971179, 'f1-score': 0.2718398937245502, 'support': 43996}, 'accuracy': 0.3613619066095599, 'macro avg': {'precision': 0.36322448127486195, 'recall': 0.3607525828902483, 'f1-score': 0.3496880190505234, 'support': 134018}, 'weighted avg': {'precision': 0.3631462258567306, 'recall': 0.3613619066095599, 'f1-score': 0.3500653857555053, 'support': 134018}}
[[15618 21252  8515]
 [13909 23398  7330]
 [14184 20399  9413]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108811
{'0': {'precision': 0.3623743417903303, 'recall': 0.5027673234447643, 'f1-score': 0.421179525222552, 'support': 9034}, '1': {'precision': 0.36289500509684, 'recall': 0.37584459459459457, 'f1-score': 0.36925630121356706, 'support': 9472}, '2': {'precision': 0.30915872358060503, 'recall': 0.1722068328716528, 'f1-score': 0.22120088954781317, 'support': 8664}, 'accuracy': 0.35311004784688993, 'macro avg': {'precision': 0.3448093568225918, 'recall': 0.3502729169703372, 'f1-score': 0.3372122386613108, 'support': 27170}, 'weighted avg': {'precision': 0.34558639945209696, 'recall': 0.35311004784688993, 'f1-score': 0.33930865009192845, 'support': 27170}}
[[4542 3219 1273]
 [3851 3560 2061]
 [4141 3031 1492]]
training model: results/XRAY/W1/deepLOB_L2/h300
Epoch 1/50
524/524 - 27s - loss: 3.3091 - accuracy300: 0.3692 - val_loss: 3.4232 - val_accuracy300: 0.3044 - 27s/epoch - 51ms/step
Epoch 2/50
524/524 - 24s - loss: 3.2808 - accuracy300: 0.3752 - val_loss: 3.4540 - val_accuracy300: 0.3005 - 24s/epoch - 46ms/step
Epoch 3/50
524/524 - 24s - loss: 3.2722 - accuracy300: 0.3782 - val_loss: 3.4562 - val_accuracy300: 0.3066 - 24s/epoch - 46ms/step
Epoch 4/50
524/524 - 24s - loss: 3.2593 - accuracy300: 0.3788 - val_loss: 3.5160 - val_accuracy300: 0.2993 - 24s/epoch - 46ms/step
Epoch 5/50
524/524 - 24s - loss: 3.2384 - accuracy300: 0.3943 - val_loss: 3.4862 - val_accuracy300: 0.3112 - 24s/epoch - 46ms/step
Epoch 6/50
524/524 - 24s - loss: 3.2184 - accuracy300: 0.4064 - val_loss: 3.5171 - val_accuracy300: 0.3123 - 24s/epoch - 46ms/step
Epoch 7/50
524/524 - 24s - loss: 3.2016 - accuracy300: 0.4149 - val_loss: 3.4941 - val_accuracy300: 0.3253 - 24s/epoch - 46ms/step
Epoch 8/50
524/524 - 24s - loss: 3.1909 - accuracy300: 0.4212 - val_loss: 3.5129 - val_accuracy300: 0.3330 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 3.1745 - accuracy300: 0.4285 - val_loss: 3.4886 - val_accuracy300: 0.3616 - 24s/epoch - 46ms/step
Epoch 10/50
524/524 - 25s - loss: 3.1607 - accuracy300: 0.4367 - val_loss: 3.4934 - val_accuracy300: 0.3690 - 25s/epoch - 47ms/step
Epoch 11/50
524/524 - 24s - loss: 3.1526 - accuracy300: 0.4378 - val_loss: 3.6754 - val_accuracy300: 0.3451 - 24s/epoch - 47ms/step
testing model: results/XRAY/W1/deepLOB_L2/h300
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1561433
{'0': {'precision': 0.34975702922902113, 'recall': 0.12048002131947567, 'f1-score': 0.1792233695281868, 'support': 120078}, '1': {'precision': 0.2929080152240268, 'recall': 0.7899850599127987, 'f1-score': 0.4273606716460992, 'support': 98393}, '2': {'precision': 0.33627929026141135, 'recall': 0.08430819905937484, 'f1-score': 0.13481666508287743, 'support': 117794}, 'accuracy': 0.3037098716785868, 'macro avg': {'precision': 0.3263147782381531, 'recall': 0.3315910934305497, 'f1-score': 0.24713356875238782, 'support': 336265}, 'weighted avg': {'precision': 0.3284014262999502, 'recall': 0.3037098716785868, 'f1-score': 0.2362739999055885, 'support': 336265}}
[[14467 94605 11006]
 [12069 77729  8595]
 [14827 93036  9931]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1463482
{'0': {'precision': 0.36670469671040123, 'recall': 0.08142112262776804, 'f1-score': 0.1332550225431429, 'support': 47371}, '1': {'precision': 0.3191567979012323, 'recall': 0.8323696636792908, 'f1-score': 0.4613987526875976, 'support': 41508}, '2': {'precision': 0.37176964449691724, 'recall': 0.1255676909102993, 'f1-score': 0.18772874058127018, 'support': 45139}, 'accuracy': 0.3288737333790983, 'macro avg': {'precision': 0.35254371303618354, 'recall': 0.34645282573911934, 'f1-score': 0.2607941719373369, 'support': 134018}, 'weighted avg': {'precision': 0.35368412107402825, 'recall': 0.3288737333790983, 'f1-score': 0.25323501858366765, 'support': 134018}}
[[ 3857 37872  5642]
 [ 3022 34550  3936]
 [ 3639 35832  5668]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1494417
{'0': {'precision': 0.332994923857868, 'recall': 0.06726825266611977, 'f1-score': 0.11192629244156287, 'support': 9752}, '1': {'precision': 0.2994047619047619, 'recall': 0.863519313304721, 'f1-score': 0.44464088397790047, 'support': 8155}, '2': {'precision': 0.3601190476190476, 'recall': 0.06531361330022671, 'f1-score': 0.11057296902129216, 'support': 9263}, 'accuracy': 0.3055944055944056, 'macro avg': {'precision': 0.33083957779389256, 'recall': 0.33203372642368917, 'f1-score': 0.22238004848025184, 'support': 27170}, 'weighted avg': {'precision': 0.3321602896168752, 'recall': 0.3055944055944056, 'f1-score': 0.211328267382191, 'support': 27170}}
[[ 656 8573  523]
 [ 561 7042  552]
 [ 753 7905  605]]
training model: results/XRAY/W1/deepLOB_L2/h500
Epoch 1/50
524/524 - 27s - loss: 3.2915 - accuracy500: 0.3803 - val_loss: 3.5833 - val_accuracy500: 0.3340 - 27s/epoch - 51ms/step
Epoch 2/50
524/524 - 25s - loss: 3.2596 - accuracy500: 0.3909 - val_loss: 3.3405 - val_accuracy500: 0.3478 - 25s/epoch - 47ms/step
Epoch 3/50
524/524 - 25s - loss: 3.2399 - accuracy500: 0.3957 - val_loss: 3.3529 - val_accuracy500: 0.3069 - 25s/epoch - 47ms/step
Epoch 4/50
524/524 - 25s - loss: 3.2184 - accuracy500: 0.4045 - val_loss: 3.3528 - val_accuracy500: 0.2982 - 25s/epoch - 48ms/step
Epoch 5/50
524/524 - 25s - loss: 3.1852 - accuracy500: 0.4201 - val_loss: 3.3876 - val_accuracy500: 0.3759 - 25s/epoch - 47ms/step
Epoch 6/50
524/524 - 25s - loss: 3.1568 - accuracy500: 0.4370 - val_loss: 3.3265 - val_accuracy500: 0.3512 - 25s/epoch - 47ms/step
Epoch 7/50
524/524 - 24s - loss: 3.1344 - accuracy500: 0.4478 - val_loss: 3.3771 - val_accuracy500: 0.3493 - 24s/epoch - 46ms/step
Epoch 8/50
524/524 - 24s - loss: 3.1111 - accuracy500: 0.4580 - val_loss: 3.3740 - val_accuracy500: 0.3457 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 3.0924 - accuracy500: 0.4627 - val_loss: 3.3820 - val_accuracy500: 0.3625 - 24s/epoch - 46ms/step
Epoch 10/50
524/524 - 24s - loss: 3.0675 - accuracy500: 0.4720 - val_loss: 3.3711 - val_accuracy500: 0.3768 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 24s - loss: 3.0502 - accuracy500: 0.4789 - val_loss: 3.4360 - val_accuracy500: 0.3564 - 24s/epoch - 45ms/step
Epoch 12/50
524/524 - 23s - loss: 3.0350 - accuracy500: 0.4854 - val_loss: 3.3677 - val_accuracy500: 0.3748 - 23s/epoch - 45ms/step
Epoch 13/50
524/524 - 23s - loss: 3.0152 - accuracy500: 0.4905 - val_loss: 3.3448 - val_accuracy500: 0.3798 - 23s/epoch - 45ms/step
Epoch 14/50
524/524 - 23s - loss: 3.0036 - accuracy500: 0.4938 - val_loss: 3.3834 - val_accuracy500: 0.3778 - 23s/epoch - 45ms/step
Epoch 15/50
524/524 - 24s - loss: 2.9737 - accuracy500: 0.5018 - val_loss: 3.3890 - val_accuracy500: 0.3741 - 24s/epoch - 45ms/step
Epoch 16/50
524/524 - 24s - loss: 2.9692 - accuracy500: 0.5037 - val_loss: 3.3755 - val_accuracy500: 0.3737 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h500
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1393777
{'0': {'precision': 0.4078492244887982, 'recall': 0.26199505358615005, 'f1-score': 0.3190427474639309, 'support': 127365}, '1': {'precision': 0.24714670553480564, 'recall': 0.2291191622329195, 'f1-score': 0.23779174596814584, 'support': 82887}, '2': {'precision': 0.37098199958334976, 'recall': 0.5228746240467254, 'f1-score': 0.43402279164745405, 'support': 126013}, 'accuracy': 0.35165420129957026, 'macro avg': {'precision': 0.34199264320231787, 'recall': 0.337996279955265, 'f1-score': 0.33028576169317697, 'support': 336265}, 'weighted avg': {'precision': 0.3544214240916416, 'recall': 0.35165420129957026, 'f1-score': 0.3421029188963344, 'support': 336265}}
[[33369 28120 65876]
 [18054 18991 45842]
 [30394 29730 65889]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1144159
{'0': {'precision': 0.36991612814519453, 'recall': 0.2926574567605787, 'f1-score': 0.3267824608283736, 'support': 45965}, '1': {'precision': 0.3640248898336987, 'recall': 0.37262279846771085, 'f1-score': 0.3682736681750975, 'support': 44117}, '2': {'precision': 0.3353716615232217, 'recall': 0.4006964675892207, 'f1-score': 0.36513533132842474, 'support': 43936}, 'accuracy': 0.3544001552030324, 'macro avg': {'precision': 0.3564375598340383, 'recall': 0.3553255742725034, 'f1-score': 0.3533971534439653, 'support': 134018}, 'weighted avg': {'precision': 0.3566518692688402, 'recall': 0.3544001552030324, 'f1-score': 0.353014305153805, 'support': 134018}}
[[13452 14951 17562]
 [10351 16439 17327]
 [12562 13769 17605]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1110644
{'0': {'precision': 0.40950317039890843, 'recall': 0.484750593824228, 'f1-score': 0.44396101635920643, 'support': 10525}, '1': {'precision': 0.25315020161290325, 'recall': 0.27603737290464414, 'f1-score': 0.2640988563165506, 'support': 7278}, '2': {'precision': 0.356309963099631, 'recall': 0.2577132486388385, 'f1-score': 0.29909552719613436, 'support': 9367}, 'accuracy': 0.35057048214942954, 'macro avg': {'precision': 0.33965444503714753, 'recall': 0.33950040512257024, 'f1-score': 0.3357184666239638, 'support': 27170}, 'weighted avg': {'precision': 0.3492824240022622, 'recall': 0.35057048214942954, 'f1-score': 0.34583838707025, 'support': 27170}}
[[5102 3159 2264]
 [3172 2009 2097]
 [4185 2768 2414]]
training model: results/XRAY/W1/deepLOB_L2/h1000
Epoch 1/50
524/524 - 27s - loss: 3.2790 - accuracy1000: 0.3954 - val_loss: 3.5618 - val_accuracy1000: 0.3317 - 27s/epoch - 51ms/step
Epoch 2/50
524/524 - 24s - loss: 3.2538 - accuracy1000: 0.3926 - val_loss: 3.3523 - val_accuracy1000: 0.3350 - 24s/epoch - 46ms/step
Epoch 3/50
524/524 - 24s - loss: 3.2240 - accuracy1000: 0.4059 - val_loss: 3.4382 - val_accuracy1000: 0.2923 - 24s/epoch - 47ms/step
Epoch 4/50
524/524 - 24s - loss: 3.2117 - accuracy1000: 0.4200 - val_loss: 3.4043 - val_accuracy1000: 0.3011 - 24s/epoch - 47ms/step
Epoch 5/50
524/524 - 24s - loss: 3.1914 - accuracy1000: 0.4232 - val_loss: 3.4428 - val_accuracy1000: 0.2969 - 24s/epoch - 46ms/step
Epoch 6/50
524/524 - 24s - loss: 3.1694 - accuracy1000: 0.4327 - val_loss: 3.5476 - val_accuracy1000: 0.3291 - 24s/epoch - 46ms/step
Epoch 7/50
524/524 - 24s - loss: 3.1492 - accuracy1000: 0.4444 - val_loss: 3.4874 - val_accuracy1000: 0.3349 - 24s/epoch - 47ms/step
Epoch 8/50
524/524 - 24s - loss: 3.1234 - accuracy1000: 0.4514 - val_loss: 3.5292 - val_accuracy1000: 0.3082 - 24s/epoch - 46ms/step
Epoch 9/50
524/524 - 24s - loss: 3.1269 - accuracy1000: 0.4518 - val_loss: 3.4710 - val_accuracy1000: 0.3033 - 24s/epoch - 46ms/step
Epoch 10/50
524/524 - 24s - loss: 3.1070 - accuracy1000: 0.4580 - val_loss: 3.5441 - val_accuracy1000: 0.3353 - 24s/epoch - 46ms/step
Epoch 11/50
524/524 - 25s - loss: 3.0943 - accuracy1000: 0.4628 - val_loss: 3.5253 - val_accuracy1000: 0.3456 - 25s/epoch - 47ms/step
Epoch 12/50
524/524 - 24s - loss: 3.0770 - accuracy1000: 0.4669 - val_loss: 3.4766 - val_accuracy1000: 0.3747 - 24s/epoch - 46ms/step
testing model: results/XRAY/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1245465
{'0': {'precision': 0.39559167473835904, 'recall': 0.28123714110563397, 'f1-score': 0.32875394499825755, 'support': 119081}, '1': {'precision': 0.3034697556535242, 'recall': 0.6866159857043341, 'f1-score': 0.4209073552028568, 'support': 99051}, '2': {'precision': 0.35270373468126115, 'recall': 0.08210237613537284, 'f1-score': 0.13319874752801583, 'support': 118133}, 'accuracy': 0.3306885938173762, 'macro avg': {'precision': 0.3505883883577148, 'recall': 0.34998516764844695, 'f1-score': 0.29428668257637675, 'support': 336265}, 'weighted avg': {'precision': 0.3533890987044657, 'recall': 0.3306885938173762, 'f1-score': 0.28719852082810515, 'support': 336265}}
[[33490 76276  9315]
 [22556 68010  8485]
 [28612 79822  9699]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1121091
{'0': {'precision': 0.3433454346188095, 'recall': 0.2155821254999785, 'f1-score': 0.26486129458388374, 'support': 46502}, '1': {'precision': 0.346614044979014, 'recall': 0.7483263079593355, 'f1-score': 0.47377997873570193, 'support': 44363}, '2': {'precision': 0.41008626410086263, 'recall': 0.08592681852941858, 'f1-score': 0.14208257495928728, 'support': 43153}, 'accuracy': 0.35018430360100883, 'macro avg': {'precision': 0.36668191456622873, 'recall': 0.3499450839962442, 'f1-score': 0.2935746160929577, 'support': 134018}, 'weighted avg': {'precision': 0.3659175695264249, 'recall': 0.35018430360100883, 'f1-score': 0.294484102692249, 'support': 134018}}
[[10025 33125  3352]
 [ 9183 33198  1982]
 [ 9990 29455  3708]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1155037
{'0': {'precision': 0.39930162325405816, 'recall': 0.40184253015481053, 'f1-score': 0.40056804733727813, 'support': 10529}, '1': {'precision': 0.2932345876701361, 'recall': 0.5587337909992373, 'f1-score': 0.3846153846153846, 'support': 7866}, '2': {'precision': 0.31778058007566207, 'recall': 0.057435897435897436, 'f1-score': 0.09728790657272465, 'support': 8775}, 'accuracy': 0.3360323886639676, 'macro avg': {'precision': 0.3367722636666188, 'recall': 0.3393374061966484, 'f1-score': 0.2941571128417958, 'support': 27170}, 'weighted avg': {'precision': 0.34226553728447556, 'recall': 0.3360323886639676, 'f1-score': 0.29800025638478006, 'support': 27170}}
[[4231 5640  658]
 [3047 4395  424]
 [3318 4953  504]]
training model: results/XRAY/W1/deepOF_L2/h10
Epoch 1/50
524/524 - 19s - loss: 3.1419 - accuracy10: 0.4477 - val_loss: 3.3288 - val_accuracy10: 0.4495 - 19s/epoch - 35ms/step
Epoch 2/50
524/524 - 16s - loss: 2.9424 - accuracy10: 0.5166 - val_loss: 3.3627 - val_accuracy10: 0.4633 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 2.8715 - accuracy10: 0.5414 - val_loss: 3.3329 - val_accuracy10: 0.4745 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 2.8283 - accuracy10: 0.5524 - val_loss: 3.2917 - val_accuracy10: 0.4870 - 16s/epoch - 30ms/step
Epoch 5/50
524/524 - 16s - loss: 2.7968 - accuracy10: 0.5604 - val_loss: 3.2457 - val_accuracy10: 0.4934 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 2.7734 - accuracy10: 0.5663 - val_loss: 3.2494 - val_accuracy10: 0.4906 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 2.7537 - accuracy10: 0.5697 - val_loss: 3.2258 - val_accuracy10: 0.4959 - 16s/epoch - 31ms/step
Epoch 8/50
524/524 - 17s - loss: 2.7371 - accuracy10: 0.5728 - val_loss: 3.2314 - val_accuracy10: 0.4992 - 17s/epoch - 32ms/step
Epoch 9/50
524/524 - 16s - loss: 2.7248 - accuracy10: 0.5758 - val_loss: 3.2114 - val_accuracy10: 0.5026 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 2.7113 - accuracy10: 0.5769 - val_loss: 3.2078 - val_accuracy10: 0.4989 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 16s - loss: 2.7012 - accuracy10: 0.5784 - val_loss: 3.2189 - val_accuracy10: 0.4999 - 16s/epoch - 31ms/step
Epoch 12/50
524/524 - 16s - loss: 2.6902 - accuracy10: 0.5807 - val_loss: 3.2141 - val_accuracy10: 0.4999 - 16s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 2.6832 - accuracy10: 0.5823 - val_loss: 3.2090 - val_accuracy10: 0.5030 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 15s - loss: 2.6725 - accuracy10: 0.5846 - val_loss: 3.2071 - val_accuracy10: 0.4998 - 15s/epoch - 29ms/step
Epoch 15/50
524/524 - 16s - loss: 2.6622 - accuracy10: 0.5851 - val_loss: 3.2077 - val_accuracy10: 0.5039 - 16s/epoch - 31ms/step
Epoch 16/50
524/524 - 16s - loss: 2.6563 - accuracy10: 0.5882 - val_loss: 3.2099 - val_accuracy10: 0.5020 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 16s - loss: 2.6484 - accuracy10: 0.5898 - val_loss: 3.2158 - val_accuracy10: 0.5004 - 16s/epoch - 31ms/step
Epoch 18/50
524/524 - 16s - loss: 2.6400 - accuracy10: 0.5907 - val_loss: 3.2226 - val_accuracy10: 0.5004 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 16s - loss: 2.6313 - accuracy10: 0.5922 - val_loss: 3.2102 - val_accuracy10: 0.5006 - 16s/epoch - 30ms/step
Epoch 20/50
524/524 - 16s - loss: 2.6233 - accuracy10: 0.5944 - val_loss: 3.2165 - val_accuracy10: 0.5007 - 16s/epoch - 31ms/step
Epoch 21/50
524/524 - 16s - loss: 2.6166 - accuracy10: 0.5947 - val_loss: 3.2229 - val_accuracy10: 0.4990 - 16s/epoch - 31ms/step
Epoch 22/50
524/524 - 16s - loss: 2.6105 - accuracy10: 0.5970 - val_loss: 3.2248 - val_accuracy10: 0.5038 - 16s/epoch - 31ms/step
Epoch 23/50
524/524 - 16s - loss: 2.6026 - accuracy10: 0.5989 - val_loss: 3.2442 - val_accuracy10: 0.4964 - 16s/epoch - 31ms/step
Epoch 24/50
524/524 - 17s - loss: 2.5929 - accuracy10: 0.6002 - val_loss: 3.2515 - val_accuracy10: 0.5012 - 17s/epoch - 32ms/step
testing model: results/XRAY/W1/deepOF_L2/h10
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0336144
{'0': {'precision': 0.507164999707551, 'recall': 0.4008709963754716, 'f1-score': 0.44779665043354316, 'support': 108152}, '1': {'precision': 0.5186577411603158, 'recall': 0.5189071301002885, 'f1-score': 0.5187824056587578, 'support': 116464}, '2': {'precision': 0.46681315407247403, 'recall': 0.5613557378811221, 'f1-score': 0.5097377378517196, 'support': 111644}, 'accuracy': 0.49503657883780405, 'macro avg': {'precision': 0.49754529831344696, 'recall': 0.49371128811896076, 'f1-score': 0.4921055979813402, 'support': 336260}, 'weighted avg': {'precision': 0.4977480282761356, 'recall': 0.49503657883780405, 'f1-score': 0.4929481277435541, 'support': 336260}}
[[43355 28257 36540]
 [20987 60434 35043]
 [21143 27829 62672]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8964921
{'0': {'precision': 0.5184692520208738, 'recall': 0.42736652703196604, 'f1-score': 0.4685303908272716, 'support': 35569}, '1': {'precision': 0.674534689635625, 'recall': 0.6886091820987654, 'f1-score': 0.6814992761347185, 'support': 62208}, '2': {'precision': 0.4768285873813512, 'recall': 0.5419828371181811, 'f1-score': 0.5073223648526487, 'support': 36241}, 'accuracy': 0.579623632646361, 'macro avg': {'precision': 0.5566108430126167, 'recall': 0.5526528487496375, 'f1-score': 0.5524506772715463, 'support': 134018}, 'weighted avg': {'precision': 0.5796507307471457, 'recall': 0.579623632646361, 'f1-score': 0.5778756157064621, 'support': 134018}}
[[15201 10319 10049]
 [ 7869 42837 11502]
 [ 6249 10350 19642]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0106465
{'0': {'precision': 0.5135214579659024, 'recall': 0.4031848603738749, 'f1-score': 0.4517129928894635, 'support': 8666}, '1': {'precision': 0.5437929212889593, 'recall': 0.5202142712755206, 'f1-score': 0.5317423420631231, 'support': 9894}, '2': {'precision': 0.451976882854784, 'recall': 0.5722415795586527, 'f1-score': 0.5050484342165957, 'support': 8610}, 'accuracy': 0.4993743099006257, 'macro avg': {'precision': 0.5030970873698819, 'recall': 0.4985469037360161, 'f1-score': 0.49616792305639407, 'support': 27170}, 'weighted avg': {'precision': 0.5050417769357808, 'recall': 0.4993743099006257, 'f1-score': 0.49775747321890035, 'support': 27170}}
[[3494 2241 2931]
 [1704 5147 3043]
 [1606 2077 4927]]
training model: results/XRAY/W1/deepOF_L2/h20
Epoch 1/50
524/524 - 17s - loss: 3.1819 - accuracy20: 0.4253 - val_loss: 3.2054 - val_accuracy20: 0.4164 - 17s/epoch - 33ms/step
Epoch 2/50
524/524 - 15s - loss: 2.9960 - accuracy20: 0.4875 - val_loss: 3.2401 - val_accuracy20: 0.4159 - 15s/epoch - 30ms/step
Epoch 3/50
524/524 - 15s - loss: 2.9207 - accuracy20: 0.5120 - val_loss: 3.2188 - val_accuracy20: 0.4307 - 15s/epoch - 29ms/step
Epoch 4/50
524/524 - 15s - loss: 2.8794 - accuracy20: 0.5246 - val_loss: 3.2133 - val_accuracy20: 0.4369 - 15s/epoch - 29ms/step
Epoch 5/50
524/524 - 15s - loss: 2.8549 - accuracy20: 0.5317 - val_loss: 3.1905 - val_accuracy20: 0.4452 - 15s/epoch - 29ms/step
Epoch 6/50
524/524 - 16s - loss: 2.8295 - accuracy20: 0.5383 - val_loss: 3.1759 - val_accuracy20: 0.4476 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 2.8117 - accuracy20: 0.5418 - val_loss: 3.1704 - val_accuracy20: 0.4530 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 2.7968 - accuracy20: 0.5465 - val_loss: 3.1524 - val_accuracy20: 0.4568 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 2.7828 - accuracy20: 0.5503 - val_loss: 3.1592 - val_accuracy20: 0.4572 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 2.7734 - accuracy20: 0.5528 - val_loss: 3.1330 - val_accuracy20: 0.4604 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 16s - loss: 2.7602 - accuracy20: 0.5547 - val_loss: 3.1400 - val_accuracy20: 0.4611 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 16s - loss: 2.7497 - accuracy20: 0.5573 - val_loss: 3.1371 - val_accuracy20: 0.4610 - 16s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 2.7404 - accuracy20: 0.5601 - val_loss: 3.1419 - val_accuracy20: 0.4639 - 16s/epoch - 31ms/step
Epoch 14/50
524/524 - 16s - loss: 2.7327 - accuracy20: 0.5626 - val_loss: 3.1309 - val_accuracy20: 0.4651 - 16s/epoch - 30ms/step
Epoch 15/50
524/524 - 16s - loss: 2.7235 - accuracy20: 0.5639 - val_loss: 3.1324 - val_accuracy20: 0.4654 - 16s/epoch - 31ms/step
Epoch 16/50
524/524 - 16s - loss: 2.7143 - accuracy20: 0.5665 - val_loss: 3.1461 - val_accuracy20: 0.4663 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 16s - loss: 2.7096 - accuracy20: 0.5670 - val_loss: 3.1369 - val_accuracy20: 0.4657 - 16s/epoch - 30ms/step
Epoch 18/50
524/524 - 16s - loss: 2.7011 - accuracy20: 0.5683 - val_loss: 3.1429 - val_accuracy20: 0.4629 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 15s - loss: 2.6953 - accuracy20: 0.5704 - val_loss: 3.1498 - val_accuracy20: 0.4661 - 15s/epoch - 29ms/step
Epoch 20/50
524/524 - 15s - loss: 2.6884 - accuracy20: 0.5724 - val_loss: 3.1527 - val_accuracy20: 0.4638 - 15s/epoch - 29ms/step
Epoch 21/50
524/524 - 15s - loss: 2.6795 - accuracy20: 0.5740 - val_loss: 3.1278 - val_accuracy20: 0.4715 - 15s/epoch - 29ms/step
Epoch 22/50
524/524 - 15s - loss: 2.6727 - accuracy20: 0.5746 - val_loss: 3.1467 - val_accuracy20: 0.4679 - 15s/epoch - 28ms/step
Epoch 23/50
524/524 - 15s - loss: 2.6666 - accuracy20: 0.5765 - val_loss: 3.1685 - val_accuracy20: 0.4630 - 15s/epoch - 29ms/step
Epoch 24/50
524/524 - 15s - loss: 2.6558 - accuracy20: 0.5808 - val_loss: 3.1592 - val_accuracy20: 0.4696 - 15s/epoch - 29ms/step
Epoch 25/50
524/524 - 16s - loss: 2.6523 - accuracy20: 0.5812 - val_loss: 3.1806 - val_accuracy20: 0.4667 - 16s/epoch - 30ms/step
Epoch 26/50
524/524 - 16s - loss: 2.6443 - accuracy20: 0.5832 - val_loss: 3.1627 - val_accuracy20: 0.4683 - 16s/epoch - 30ms/step
Epoch 27/50
524/524 - 15s - loss: 2.6363 - accuracy20: 0.5857 - val_loss: 3.1795 - val_accuracy20: 0.4665 - 15s/epoch - 30ms/step
Epoch 28/50
524/524 - 16s - loss: 2.6293 - accuracy20: 0.5863 - val_loss: 3.1842 - val_accuracy20: 0.4664 - 16s/epoch - 31ms/step
Epoch 29/50
524/524 - 17s - loss: 2.6235 - accuracy20: 0.5878 - val_loss: 3.1741 - val_accuracy20: 0.4698 - 17s/epoch - 32ms/step
Epoch 30/50
524/524 - 17s - loss: 2.6155 - accuracy20: 0.5897 - val_loss: 3.1997 - val_accuracy20: 0.4661 - 17s/epoch - 32ms/step
Epoch 31/50
524/524 - 15s - loss: 2.6066 - accuracy20: 0.5924 - val_loss: 3.1959 - val_accuracy20: 0.4724 - 15s/epoch - 29ms/step
testing model: results/XRAY/W1/deepOF_L2/h20
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0665656
{'0': {'precision': 0.5344018717512693, 'recall': 0.3463934772242243, 'f1-score': 0.4203321981805936, 'support': 127921}, '1': {'precision': 0.36616321746315406, 'recall': 0.49867842562545794, 'f1-score': 0.4222685118500216, 'support': 76424}, '2': {'precision': 0.4938262506615928, 'recall': 0.5587613235795778, 'f1-score': 0.5242908356331977, 'support': 131915}, 'accuracy': 0.46431630286088144, 'macro avg': {'precision': 0.4647971132920054, 'recall': 0.4679444088097533, 'f1-score': 0.45563051522127096, 'support': 336260}, 'weighted avg': {'precision': 0.4802473366553328, 'recall': 0.46431630286088144, 'f1-score': 0.4615553127212247, 'support': 336260}}
[[44311 32876 50734]
 [13495 38111 24818]
 [25111 33095 73709]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9319282
{'0': {'precision': 0.5589084655569616, 'recall': 0.40256614003926333, 'f1-score': 0.46802613881831895, 'support': 42788}, '1': {'precision': 0.5635925976509151, 'recall': 0.6951422374765746, 'f1-score': 0.6224933296878389, 'support': 47491}, '2': {'precision': 0.5229814221365664, 'recall': 0.5335512928964997, 'f1-score': 0.5282134854349154, 'support': 43739}, 'accuracy': 0.5489934187944903, 'macro avg': {'precision': 0.548494161781481, 'recall': 0.5437532234707793, 'f1-score': 0.5395776513136911, 'support': 134018}, 'weighted avg': {'precision': 0.5488429606629123, 'recall': 0.5489934187944903, 'f1-score': 0.5424067124371439, 'support': 134018}}
[[17225 12780 12783]
 [ 5975 33013  8503]
 [ 7619 12783 23337]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0317149
{'0': {'precision': 0.540405524537173, 'recall': 0.35598141695702673, 'f1-score': 0.4292216127902906, 'support': 10332}, '1': {'precision': 0.3927846135467686, 'recall': 0.5060018467220684, 'f1-score': 0.4422624251799045, 'support': 6498}, '2': {'precision': 0.49028600016676394, 'recall': 0.5686653771760155, 'f1-score': 0.5265750235078135, 'support': 10340}, 'accuracy': 0.4728008833271991, 'macro avg': {'precision': 0.4744920460835685, 'recall': 0.4768828802850369, 'f1-score': 0.4660196871593362, 'support': 27170}, 'weighted avg': {'precision': 0.4860265564986865, 'recall': 0.4728008833271991, 'f1-score': 0.4693899405682405, 'support': 27170}}
[[3678 2616 4038]
 [1135 3288 2075]
 [1993 2467 5880]]
training model: results/XRAY/W1/deepOF_L2/h30
Epoch 1/50
524/524 - 18s - loss: 3.2117 - accuracy30: 0.4121 - val_loss: 3.1929 - val_accuracy30: 0.4120 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 16s - loss: 3.0609 - accuracy30: 0.4677 - val_loss: 3.2548 - val_accuracy30: 0.3824 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 2.9999 - accuracy30: 0.4871 - val_loss: 3.2517 - val_accuracy30: 0.3906 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 2.9668 - accuracy30: 0.4972 - val_loss: 3.2248 - val_accuracy30: 0.4033 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 2.9436 - accuracy30: 0.5052 - val_loss: 3.1823 - val_accuracy30: 0.4214 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 2.9214 - accuracy30: 0.5118 - val_loss: 3.1791 - val_accuracy30: 0.4262 - 16s/epoch - 31ms/step
Epoch 7/50
524/524 - 16s - loss: 2.9075 - accuracy30: 0.5148 - val_loss: 3.1861 - val_accuracy30: 0.4248 - 16s/epoch - 31ms/step
Epoch 8/50
524/524 - 16s - loss: 2.8909 - accuracy30: 0.5198 - val_loss: 3.1791 - val_accuracy30: 0.4293 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 2.8772 - accuracy30: 0.5229 - val_loss: 3.1785 - val_accuracy30: 0.4324 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 17s - loss: 2.8655 - accuracy30: 0.5262 - val_loss: 3.1720 - val_accuracy30: 0.4342 - 17s/epoch - 32ms/step
Epoch 11/50
524/524 - 16s - loss: 2.8598 - accuracy30: 0.5283 - val_loss: 3.1698 - val_accuracy30: 0.4365 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 16s - loss: 2.8481 - accuracy30: 0.5315 - val_loss: 3.1577 - val_accuracy30: 0.4421 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 2.8396 - accuracy30: 0.5342 - val_loss: 3.1763 - val_accuracy30: 0.4413 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 2.8347 - accuracy30: 0.5366 - val_loss: 3.1699 - val_accuracy30: 0.4413 - 16s/epoch - 31ms/step
Epoch 15/50
524/524 - 16s - loss: 2.8233 - accuracy30: 0.5377 - val_loss: 3.1690 - val_accuracy30: 0.4424 - 16s/epoch - 30ms/step
Epoch 16/50
524/524 - 16s - loss: 2.8156 - accuracy30: 0.5427 - val_loss: 3.1708 - val_accuracy30: 0.4444 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 16s - loss: 2.8082 - accuracy30: 0.5423 - val_loss: 3.1648 - val_accuracy30: 0.4462 - 16s/epoch - 31ms/step
Epoch 18/50
524/524 - 16s - loss: 2.8025 - accuracy30: 0.5451 - val_loss: 3.1820 - val_accuracy30: 0.4435 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 16s - loss: 2.7950 - accuracy30: 0.5462 - val_loss: 3.1888 - val_accuracy30: 0.4416 - 16s/epoch - 30ms/step
Epoch 20/50
524/524 - 16s - loss: 2.7879 - accuracy30: 0.5496 - val_loss: 3.1824 - val_accuracy30: 0.4470 - 16s/epoch - 30ms/step
Epoch 21/50
524/524 - 16s - loss: 2.7779 - accuracy30: 0.5523 - val_loss: 3.1732 - val_accuracy30: 0.4498 - 16s/epoch - 30ms/step
Epoch 22/50
524/524 - 16s - loss: 2.7722 - accuracy30: 0.5542 - val_loss: 3.1867 - val_accuracy30: 0.4463 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepOF_L2/h30
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0889944
{'0': {'precision': 0.5221800717834745, 'recall': 0.31040818805806963, 'f1-score': 0.3893616514678921, 'support': 131704}, '1': {'precision': 0.30246181360293445, 'recall': 0.4745461833591021, 'f1-score': 0.3694481905420015, 'support': 69852}, '2': {'precision': 0.486530749789385, 'recall': 0.5359083620382469, 'f1-score': 0.5100272362132126, 'support': 134704}, 'accuracy': 0.4348391125914471, 'macro avg': {'precision': 0.437057545058598, 'recall': 0.4402875778184729, 'f1-score': 0.4229456927410354, 'support': 336260}, 'weighted avg': {'precision': 0.4622566017295908, 'recall': 0.4348391125914471, 'f1-score': 0.4335629892866583, 'support': 336260}}
[[40882 38665 52157]
 [12675 33148 24029]
 [24734 37781 72189]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9881963
{'0': {'precision': 0.5211142708620005, 'recall': 0.38083532592907104, 'f1-score': 0.4400661054588648, 'support': 44749}, '1': {'precision': 0.4982957807118255, 'recall': 0.6337440109514032, 'f1-score': 0.5579167252495632, 'support': 43830}, '2': {'precision': 0.5013056549121152, 'recall': 0.5027619445850481, 'f1-score': 0.5020327436545434, 'support': 45439}, 'accuracy': 0.5048874031846469, 'macro avg': {'precision': 0.5069052354953137, 'recall': 0.5057804271551741, 'f1-score': 0.5000051914543238, 'support': 134018}, 'weighted avg': {'precision': 0.5069354432162438, 'recall': 0.5048874031846469, 'f1-score': 0.4996185143770679, 'support': 134018}}
[[17042 13742 13965]
 [ 7292 27777  8761]
 [ 8369 14225 22845]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0551374
{'0': {'precision': 0.5164631318596383, 'recall': 0.3142695889380115, 'f1-score': 0.3907602339181287, 'support': 10631}, '1': {'precision': 0.3330201972757163, 'recall': 0.48059650906625995, 'f1-score': 0.39342442949295975, 'support': 5901}, '2': {'precision': 0.479524004924087, 'recall': 0.5492573792066178, 'f1-score': 0.5120273408403803, 'support': 10638}, 'accuracy': 0.4423997055576003, 'macro avg': {'precision': 0.4430024446864806, 'recall': 0.4480411590702964, 'f1-score': 0.4320706680838229, 'support': 27170}, 'weighted avg': {'precision': 0.46215856103445907, 'recall': 0.4423997055576003, 'f1-score': 0.4388191555790043, 'support': 27170}}
[[3341 2933 4357]
 [1080 2836 1985]
 [2048 2747 5843]]
training model: results/XRAY/W1/deepOF_L2/h50
Epoch 1/50
524/524 - 19s - loss: 3.2536 - accuracy50: 0.3931 - val_loss: 3.2700 - val_accuracy50: 0.3884 - 19s/epoch - 36ms/step
Epoch 2/50
524/524 - 16s - loss: 3.1663 - accuracy50: 0.4352 - val_loss: 3.2758 - val_accuracy50: 0.3842 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 3.1333 - accuracy50: 0.4495 - val_loss: 3.2961 - val_accuracy50: 0.3715 - 16s/epoch - 31ms/step
Epoch 4/50
524/524 - 16s - loss: 3.1142 - accuracy50: 0.4563 - val_loss: 3.2987 - val_accuracy50: 0.3759 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 3.1013 - accuracy50: 0.4608 - val_loss: 3.2886 - val_accuracy50: 0.3840 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 16s - loss: 3.0877 - accuracy50: 0.4654 - val_loss: 3.2904 - val_accuracy50: 0.3883 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.0781 - accuracy50: 0.4704 - val_loss: 3.2857 - val_accuracy50: 0.3937 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 3.0657 - accuracy50: 0.4754 - val_loss: 3.2838 - val_accuracy50: 0.3965 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 3.0588 - accuracy50: 0.4792 - val_loss: 3.2830 - val_accuracy50: 0.3996 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 3.0509 - accuracy50: 0.4812 - val_loss: 3.2819 - val_accuracy50: 0.4006 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 16s - loss: 3.0416 - accuracy50: 0.4839 - val_loss: 3.2730 - val_accuracy50: 0.4054 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepOF_L2/h50
Evaluating performance on  test set...
1314/1314 - 24s - 24s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991999
{'0': {'precision': 0.432874992370672, 'recall': 0.3969108018004333, 'f1-score': 0.414113525461901, 'support': 125081}, '1': {'precision': 0.2729407598617078, 'recall': 0.3444670516424195, 'f1-score': 0.304560768654854, 'support': 85027}, '2': {'precision': 0.4287427141131785, 'recall': 0.3883331219481261, 'f1-score': 0.40753866247389914, 'support': 126152}, 'accuracy': 0.38043180871944327, 'macro avg': {'precision': 0.37818615544851947, 'recall': 0.3765703251303263, 'f1-score': 0.37540431886355136, 'support': 336260}, 'weighted avg': {'precision': 0.39088360726902743, 'recall': 0.38043180871944327, 'f1-score': 0.3839452795548791, 'support': 336260}}
[[49646 37810 37625]
 [28090 29289 27648]
 [36953 40210 48989]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0712183
{'0': {'precision': 0.40764895964691045, 'recall': 0.4586141159780103, 'f1-score': 0.431632312442627, 'support': 45112}, '1': {'precision': 0.3898265518126853, 'recall': 0.378430439413511, 'f1-score': 0.3840439722183892, 'support': 44127}, '2': {'precision': 0.42358208216874027, 'recall': 0.3824337300966971, 'f1-score': 0.40195756267017185, 'support': 44779}, 'accuracy': 0.40675879359489026, 'macro avg': {'precision': 0.40701919787611196, 'recall': 0.40649276182940614, 'f1-score': 0.40587794911039604, 'support': 134018}, 'weighted avg': {'precision': 0.40710440520574703, 'recall': 0.40675879359489026, 'f1-score': 0.40604816472265126, 'support': 134018}}
[[20689 12284 12139]
 [16263 16699 11165]
 [13800 13854 17125]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906781
{'0': {'precision': 0.4310774340876064, 'recall': 0.409808565225972, 'f1-score': 0.4201740186159449, 'support': 10134}, '1': {'precision': 0.29068766145897407, 'recall': 0.3428612884503772, 'f1-score': 0.3146261900006657, 'support': 6892}, '2': {'precision': 0.42712873392154777, 'recall': 0.396096214511041, 'f1-score': 0.41102756892230574, 'support': 10144}, 'accuracy': 0.387707029812293, 'macro avg': {'precision': 0.38296460982270936, 'recall': 0.38292202272913006, 'f1-score': 0.3819425925129721, 'support': 27170}, 'weighted avg': {'precision': 0.39399160679864675, 'recall': 0.387707029812293, 'f1-score': 0.38998567778014137, 'support': 27170}}
[[4153 2742 3239]
 [2379 2363 2150]
 [3102 3024 4018]]
training model: results/XRAY/W1/deepOF_L2/h100
Epoch 1/50
524/524 - 18s - loss: 3.2917 - accuracy100: 0.3721 - val_loss: 3.2765 - val_accuracy100: 0.3864 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 17s - loss: 3.2359 - accuracy100: 0.4012 - val_loss: 3.2710 - val_accuracy100: 0.3892 - 17s/epoch - 32ms/step
Epoch 3/50
524/524 - 18s - loss: 3.2140 - accuracy100: 0.4113 - val_loss: 3.2685 - val_accuracy100: 0.3910 - 18s/epoch - 34ms/step
Epoch 4/50
524/524 - 16s - loss: 3.1996 - accuracy100: 0.4179 - val_loss: 3.2625 - val_accuracy100: 0.3916 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 3.1943 - accuracy100: 0.4207 - val_loss: 3.2591 - val_accuracy100: 0.3928 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 3.1873 - accuracy100: 0.4228 - val_loss: 3.2597 - val_accuracy100: 0.3908 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.1797 - accuracy100: 0.4272 - val_loss: 3.2560 - val_accuracy100: 0.3948 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 3.1737 - accuracy100: 0.4286 - val_loss: 3.2596 - val_accuracy100: 0.3926 - 16s/epoch - 31ms/step
Epoch 9/50
524/524 - 16s - loss: 3.1690 - accuracy100: 0.4302 - val_loss: 3.2585 - val_accuracy100: 0.3934 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 3.1639 - accuracy100: 0.4318 - val_loss: 3.2551 - val_accuracy100: 0.3968 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 16s - loss: 3.1590 - accuracy100: 0.4345 - val_loss: 3.2566 - val_accuracy100: 0.3960 - 16s/epoch - 31ms/step
Epoch 12/50
524/524 - 16s - loss: 3.1562 - accuracy100: 0.4360 - val_loss: 3.2571 - val_accuracy100: 0.3979 - 16s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 3.1492 - accuracy100: 0.4397 - val_loss: 3.2589 - val_accuracy100: 0.3955 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 3.1445 - accuracy100: 0.4408 - val_loss: 3.2602 - val_accuracy100: 0.3955 - 16s/epoch - 31ms/step
Epoch 15/50
524/524 - 16s - loss: 3.1377 - accuracy100: 0.4438 - val_loss: 3.2598 - val_accuracy100: 0.3978 - 16s/epoch - 31ms/step
Epoch 16/50
524/524 - 16s - loss: 3.1325 - accuracy100: 0.4442 - val_loss: 3.2541 - val_accuracy100: 0.4024 - 16s/epoch - 31ms/step
Epoch 17/50
524/524 - 16s - loss: 3.1282 - accuracy100: 0.4471 - val_loss: 3.2614 - val_accuracy100: 0.4035 - 16s/epoch - 31ms/step
Epoch 18/50
524/524 - 16s - loss: 3.1223 - accuracy100: 0.4485 - val_loss: 3.2580 - val_accuracy100: 0.3997 - 16s/epoch - 31ms/step
Epoch 19/50
524/524 - 16s - loss: 3.1136 - accuracy100: 0.4520 - val_loss: 3.2705 - val_accuracy100: 0.3982 - 16s/epoch - 30ms/step
Epoch 20/50
524/524 - 16s - loss: 3.1070 - accuracy100: 0.4565 - val_loss: 3.2836 - val_accuracy100: 0.3926 - 16s/epoch - 30ms/step
Epoch 21/50
524/524 - 16s - loss: 3.0989 - accuracy100: 0.4603 - val_loss: 3.2795 - val_accuracy100: 0.3965 - 16s/epoch - 31ms/step
Epoch 22/50
524/524 - 16s - loss: 3.0909 - accuracy100: 0.4630 - val_loss: 3.2891 - val_accuracy100: 0.3953 - 16s/epoch - 30ms/step
Epoch 23/50
524/524 - 16s - loss: 3.0840 - accuracy100: 0.4653 - val_loss: 3.2902 - val_accuracy100: 0.3901 - 16s/epoch - 30ms/step
Epoch 24/50
524/524 - 16s - loss: 3.0743 - accuracy100: 0.4694 - val_loss: 3.2956 - val_accuracy100: 0.3901 - 16s/epoch - 30ms/step
Epoch 25/50
524/524 - 15s - loss: 3.0643 - accuracy100: 0.4729 - val_loss: 3.3065 - val_accuracy100: 0.3922 - 15s/epoch - 29ms/step
Epoch 26/50
524/524 - 15s - loss: 3.0577 - accuracy100: 0.4759 - val_loss: 3.3107 - val_accuracy100: 0.3899 - 15s/epoch - 29ms/step
testing model: results/XRAY/W1/deepOF_L2/h100
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1097114
{'0': {'precision': 0.42037710131758294, 'recall': 0.36126114400989134, 'f1-score': 0.3885836279004655, 'support': 122936}, '1': {'precision': 0.302492987858698, 'recall': 0.3315026385649646, 'f1-score': 0.3163341179125066, 'support': 93043}, '2': {'precision': 0.4033238499448098, 'recall': 0.43137320108745353, 'f1-score': 0.4168772371016402, 'support': 120281}, 'accuracy': 0.37810622732409443, 'macro avg': {'precision': 0.3753979797070302, 'recall': 0.37471232788743647, 'f1-score': 0.37393166097153746, 'support': 336260}, 'weighted avg': {'precision': 0.381658628418863, 'recall': 0.37810622732409443, 'f1-score': 0.37871291015383146, 'support': 336260}}
[[44412 36341 42183]
 [27622 30844 34577]
 [33614 34781 51886]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0615058
{'0': {'precision': 0.41996172827072215, 'recall': 0.46353772955667216, 'f1-score': 0.4406751001342169, 'support': 44978}, '1': {'precision': 0.4238334920418991, 'recall': 0.3473355629877369, 'f1-score': 0.3817903314747871, 'support': 44850}, '2': {'precision': 0.41643916166155653, 'recall': 0.4487440597420231, 'f1-score': 0.43198849773440223, 'support': 44190}, 'accuracy': 0.41977197092927815, 'macro avg': {'precision': 0.4200781273247259, 'recall': 0.4198724507621441, 'f1-score': 0.4181513097811354, 'support': 134018}, 'weighted avg': {'precision': 0.4200959370089383, 'recall': 0.41977197092927815, 'f1-score': 0.41810467799373396, 'support': 134018}}
[[20849 11168 12961]
 [14445 15578 14827]
 [14351 10009 19830]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0848838
{'0': {'precision': 0.4298758592387401, 'recall': 0.41724756024696275, 'f1-score': 0.4234675830006569, 'support': 10042}, '1': {'precision': 0.33169861792242533, 'recall': 0.30359085963003263, 'f1-score': 0.3170229387117392, 'support': 7352}, '2': {'precision': 0.4187394800822891, 'recall': 0.4580605564648118, 'f1-score': 0.4375183194919394, 'support': 9776}, 'accuracy': 0.40117776959882223, 'macro avg': {'precision': 0.39343798574781824, 'recall': 0.39296632544726906, 'f1-score': 0.3926696137347785, 'support': 27170}, 'weighted avg': {'precision': 0.39930286252210373, 'recall': 0.40117776959882223, 'f1-score': 0.39972002963763353, 'support': 27170}}
[[4190 2319 3533]
 [2437 2232 2683]
 [3120 2178 4478]]
training model: results/XRAY/W1/deepOF_L2/h200
Epoch 1/50
524/524 - 18s - loss: 3.3067 - accuracy200: 0.3569 - val_loss: 3.3437 - val_accuracy200: 0.3594 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 16s - loss: 3.2713 - accuracy200: 0.3769 - val_loss: 3.3426 - val_accuracy200: 0.3603 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2542 - accuracy200: 0.3856 - val_loss: 3.3441 - val_accuracy200: 0.3612 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 3.2444 - accuracy200: 0.3900 - val_loss: 3.3462 - val_accuracy200: 0.3590 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2388 - accuracy200: 0.3935 - val_loss: 3.3453 - val_accuracy200: 0.3625 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 3.2333 - accuracy200: 0.3968 - val_loss: 3.3569 - val_accuracy200: 0.3566 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.2291 - accuracy200: 0.3984 - val_loss: 3.3450 - val_accuracy200: 0.3624 - 16s/epoch - 31ms/step
Epoch 8/50
524/524 - 16s - loss: 3.2261 - accuracy200: 0.4017 - val_loss: 3.3481 - val_accuracy200: 0.3608 - 16s/epoch - 31ms/step
Epoch 9/50
524/524 - 16s - loss: 3.2218 - accuracy200: 0.4035 - val_loss: 3.3476 - val_accuracy200: 0.3615 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 15s - loss: 3.2196 - accuracy200: 0.4051 - val_loss: 3.3431 - val_accuracy200: 0.3626 - 15s/epoch - 29ms/step
Epoch 11/50
524/524 - 16s - loss: 3.2165 - accuracy200: 0.4055 - val_loss: 3.3445 - val_accuracy200: 0.3638 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 16s - loss: 3.2124 - accuracy200: 0.4078 - val_loss: 3.3401 - val_accuracy200: 0.3653 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 3.2095 - accuracy200: 0.4094 - val_loss: 3.3383 - val_accuracy200: 0.3660 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 3.2058 - accuracy200: 0.4114 - val_loss: 3.3394 - val_accuracy200: 0.3660 - 16s/epoch - 30ms/step
Epoch 15/50
524/524 - 16s - loss: 3.2020 - accuracy200: 0.4135 - val_loss: 3.3368 - val_accuracy200: 0.3681 - 16s/epoch - 30ms/step
Epoch 16/50
524/524 - 16s - loss: 3.1973 - accuracy200: 0.4150 - val_loss: 3.3496 - val_accuracy200: 0.3687 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 16s - loss: 3.1955 - accuracy200: 0.4143 - val_loss: 3.3380 - val_accuracy200: 0.3707 - 16s/epoch - 31ms/step
Epoch 18/50
524/524 - 16s - loss: 3.1897 - accuracy200: 0.4196 - val_loss: 3.3408 - val_accuracy200: 0.3713 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 16s - loss: 3.1851 - accuracy200: 0.4217 - val_loss: 3.3450 - val_accuracy200: 0.3708 - 16s/epoch - 30ms/step
Epoch 20/50
524/524 - 15s - loss: 3.1824 - accuracy200: 0.4231 - val_loss: 3.3413 - val_accuracy200: 0.3726 - 15s/epoch - 30ms/step
Epoch 21/50
524/524 - 16s - loss: 3.1748 - accuracy200: 0.4264 - val_loss: 3.3515 - val_accuracy200: 0.3738 - 16s/epoch - 30ms/step
Epoch 22/50
524/524 - 16s - loss: 3.1708 - accuracy200: 0.4291 - val_loss: 3.3469 - val_accuracy200: 0.3751 - 16s/epoch - 31ms/step
Epoch 23/50
524/524 - 16s - loss: 3.1653 - accuracy200: 0.4319 - val_loss: 3.3609 - val_accuracy200: 0.3732 - 16s/epoch - 30ms/step
Epoch 24/50
524/524 - 16s - loss: 3.1598 - accuracy200: 0.4334 - val_loss: 3.3627 - val_accuracy200: 0.3746 - 16s/epoch - 30ms/step
Epoch 25/50
524/524 - 16s - loss: 3.1540 - accuracy200: 0.4373 - val_loss: 3.3655 - val_accuracy200: 0.3763 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepOF_L2/h200
Evaluating performance on  test set...
1314/1314 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1394228
{'0': {'precision': 0.38388685440080816, 'recall': 0.0540665516566774, 'f1-score': 0.09478377451438906, 'support': 112454}, '1': {'precision': 0.3432269526045302, 'recall': 0.9486448807091689, 'f1-score': 0.5040755330573604, 'support': 114049}, '2': {'precision': 0.3677431757016532, 'recall': 0.017429412247054858, 'f1-score': 0.033281430770970524, 'support': 109757}, 'accuracy': 0.34552132278593944, 'macro avg': {'precision': 0.3649523275689972, 'recall': 0.3400469482043004, 'f1-score': 0.21071357944757332, 'support': 336260}, 'weighted avg': {'precision': 0.3648268922199159, 'recall': 0.34552132278593944, 'f1-score': 0.21352820747644508, 'support': 336260}}
[[  6080 104497   1877]
 [  4445 108192   1412]
 [  5313 102531   1913]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217266
{'0': {'precision': 0.44440393729493255, 'recall': 0.08058260984531312, 'f1-score': 0.1364272257559083, 'support': 45382}, '1': {'precision': 0.3436560359849252, 'recall': 0.9499294307413133, 'f1-score': 0.5047196200497555, 'support': 44637}, '2': {'precision': 0.47254575707154745, 'recall': 0.025818768608377462, 'f1-score': 0.048962351572096635, 'support': 43999}, 'accuracy': 0.3521541882433703, 'macro avg': {'precision': 0.42020191011713504, 'recall': 0.352110269731668, 'f1-score': 0.2300363991259201, 'support': 134018}, 'weighted avg': {'precision': 0.4200872623525851, 'recall': 0.3521541882433703, 'f1-score': 0.23037804284675376, 'support': 134018}}
[[ 3657 40904   821]
 [ 1788 42402   447]
 [ 2784 40079  1136]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135771
{'0': {'precision': 0.4324618736383442, 'recall': 0.08815365826579327, 'f1-score': 0.14645393341326202, 'support': 9007}, '1': {'precision': 0.3625322788896062, 'recall': 0.9441992433795713, 'f1-score': 0.5239067055393586, 'support': 9516}, '2': {'precision': 0.41454545454545455, 'recall': 0.026367526309702786, 'f1-score': 0.04958138523431553, 'support': 8647}, 'accuracy': 0.36831063673168934, 'macro avg': {'precision': 0.40317986902446834, 'recall': 0.3529068093183558, 'f1-score': 0.23998067472897874, 'support': 27170}, 'weighted avg': {'precision': 0.40226778826752313, 'recall': 0.36831063673168934, 'f1-score': 0.24782248900577528, 'support': 27170}}
[[ 794 7993  220]
 [ 429 8985  102]
 [ 613 7806  228]]
training model: results/XRAY/W1/deepOF_L2/h300
Epoch 1/50
524/524 - 18s - loss: 3.3075 - accuracy300: 0.3644 - val_loss: 3.3389 - val_accuracy300: 0.3295 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 16s - loss: 3.2736 - accuracy300: 0.3769 - val_loss: 3.3286 - val_accuracy300: 0.3287 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2549 - accuracy300: 0.3835 - val_loss: 3.3250 - val_accuracy300: 0.3382 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 3.2460 - accuracy300: 0.3888 - val_loss: 3.3264 - val_accuracy300: 0.3374 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2401 - accuracy300: 0.3912 - val_loss: 3.3303 - val_accuracy300: 0.3406 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 16s - loss: 3.2341 - accuracy300: 0.3940 - val_loss: 3.3357 - val_accuracy300: 0.3403 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.2311 - accuracy300: 0.3938 - val_loss: 3.3264 - val_accuracy300: 0.3434 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 3.2276 - accuracy300: 0.3976 - val_loss: 3.3326 - val_accuracy300: 0.3429 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 3.2242 - accuracy300: 0.3980 - val_loss: 3.3357 - val_accuracy300: 0.3430 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 3.2209 - accuracy300: 0.4005 - val_loss: 3.3382 - val_accuracy300: 0.3392 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 16s - loss: 3.2176 - accuracy300: 0.4017 - val_loss: 3.3379 - val_accuracy300: 0.3436 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 16s - loss: 3.2146 - accuracy300: 0.4036 - val_loss: 3.3350 - val_accuracy300: 0.3483 - 16s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 3.2120 - accuracy300: 0.4036 - val_loss: 3.3405 - val_accuracy300: 0.3482 - 16s/epoch - 30ms/step
testing model: results/XRAY/W1/deepOF_L2/h300
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1340746
{'0': {'precision': 0.38605430545106356, 'recall': 0.09401545687731104, 'f1-score': 0.1512074900547824, 'support': 120076}, '1': {'precision': 0.29903268902882796, 'recall': 0.8894636813594463, 'f1-score': 0.4475886053291055, 'support': 98393}, '2': {'precision': 0.37432931503031147, 'recall': 0.04560620081330492, 'f1-score': 0.08130647333928653, 'support': 117791}, 'accuracy': 0.309813834532802, 'macro avg': {'precision': 0.3531387698367343, 'recall': 0.3430284463500208, 'f1-score': 0.22670085624105815, 'support': 336260}, 'weighted avg': {'precision': 0.35648368672958664, 'recall': 0.309813834532802, 'f1-score': 0.21344539053432648, 'support': 336260}}
[[ 11289 103385   5402]
 [  7299  87517   3577]
 [ 10654 101765   5372]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1177404
{'0': {'precision': 0.405902567212452, 'recall': 0.1270886075949367, 'f1-score': 0.1935701547211645, 'support': 47400}, '1': {'precision': 0.3271366341493343, 'recall': 0.900523560209424, 'f1-score': 0.4799279927992799, 'support': 41447}, '2': {'precision': 0.4150275373721479, 'recall': 0.046711385623519515, 'f1-score': 0.08397174410506417, 'support': 45171}, 'accuracy': 0.33919324269874196, 'macro avg': {'precision': 0.3826889129113114, 'recall': 0.3581078511426268, 'f1-score': 0.25248996387516953, 'support': 134018}, 'weighted avg': {'precision': 0.3846186531070079, 'recall': 0.33919324269874196, 'f1-score': 0.2451901125543196, 'support': 134018}}
[[ 6024 39482  1894]
 [ 3043 37324  1080]
 [ 5774 37287  2110]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1177795
{'0': {'precision': 0.42592592592592593, 'recall': 0.14410435497124074, 'f1-score': 0.2153491941673062, 'support': 9736}, '1': {'precision': 0.3204483786308438, 'recall': 0.8833844267320662, 'f1-score': 0.47029638333986157, 'support': 8155}, '2': {'precision': 0.38064516129032255, 'recall': 0.05722599418040737, 'f1-score': 0.09949409780775717, 'support': 9279}, 'accuracy': 0.33632683106367317, 'macro avg': {'precision': 0.37567315528236406, 'recall': 0.3615715919612381, 'f1-score': 0.26171322510497497, 'support': 27170}, 'weighted avg': {'precision': 0.3788030104586768, 'recall': 0.33632683106367317, 'f1-score': 0.25230447162707553, 'support': 27170}}
[[1403 7754  579]
 [ 666 7204  285]
 [1225 7523  531]]
training model: results/XRAY/W1/deepOF_L2/h500
Epoch 1/50
524/524 - 18s - loss: 3.3019 - accuracy500: 0.3735 - val_loss: 3.3024 - val_accuracy500: 0.3633 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 16s - loss: 3.2453 - accuracy500: 0.3951 - val_loss: 3.3033 - val_accuracy500: 0.3555 - 16s/epoch - 31ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2212 - accuracy500: 0.4043 - val_loss: 3.2946 - val_accuracy500: 0.3642 - 16s/epoch - 31ms/step
Epoch 4/50
524/524 - 17s - loss: 3.2120 - accuracy500: 0.4081 - val_loss: 3.2847 - val_accuracy500: 0.3704 - 17s/epoch - 32ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2060 - accuracy500: 0.4117 - val_loss: 3.2851 - val_accuracy500: 0.3597 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 16s - loss: 3.2000 - accuracy500: 0.4145 - val_loss: 3.2916 - val_accuracy500: 0.3607 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.1968 - accuracy500: 0.4146 - val_loss: 3.2877 - val_accuracy500: 0.3581 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 3.1923 - accuracy500: 0.4184 - val_loss: 3.2963 - val_accuracy500: 0.3474 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 3.1900 - accuracy500: 0.4182 - val_loss: 3.2965 - val_accuracy500: 0.3468 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 3.1865 - accuracy500: 0.4205 - val_loss: 3.2955 - val_accuracy500: 0.3494 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 16s - loss: 3.1831 - accuracy500: 0.4227 - val_loss: 3.2960 - val_accuracy500: 0.3537 - 16s/epoch - 31ms/step
Epoch 12/50
524/524 - 16s - loss: 3.1806 - accuracy500: 0.4235 - val_loss: 3.2947 - val_accuracy500: 0.3522 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 3.1780 - accuracy500: 0.4239 - val_loss: 3.3024 - val_accuracy500: 0.3485 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 3.1744 - accuracy500: 0.4273 - val_loss: 3.2973 - val_accuracy500: 0.3499 - 16s/epoch - 30ms/step
testing model: results/XRAY/W1/deepOF_L2/h500
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1143411
{'0': {'precision': 0.3856020808894782, 'recall': 0.47489086398040264, 'f1-score': 0.4256139610161143, 'support': 127364}, '1': {'precision': 0.2542256753000795, 'recall': 0.47451349427533873, 'f1-score': 0.33107459721544136, 'support': 82887}, '2': {'precision': 0.3887426604575825, 'recall': 0.07618503440230459, 'f1-score': 0.12740205966663126, 'support': 126009}, 'accuracy': 0.32538809254743356, 'macro avg': {'precision': 0.3428568055490468, 'recall': 0.34186313088601533, 'f1-score': 0.294696872632729, 'support': 336260}, 'weighted avg': {'precision': 0.35439511354488995, 'recall': 0.32538809254743356, 'f1-score': 0.29055933743765305, 'support': 336260}}
[[60484 57517  9363]
 [37824 39331  5732]
 [58548 57861  9600]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0870019
{'0': {'precision': 0.36824982712013576, 'recall': 0.5100459304730186, 'f1-score': 0.42770177151879674, 'support': 45939}, '1': {'precision': 0.39097051597051596, 'recall': 0.5477872899397563, 'f1-score': 0.4562810088852836, 'support': 44154}, '2': {'precision': 0.42059582453671124, 'recall': 0.08163915765509391, 'f1-score': 0.13673714514499247, 'support': 43925}, 'accuracy': 0.3820680804071095, 'macro avg': {'precision': 0.3932720558757876, 'recall': 0.37982412602262294, 'f1-score': 0.34023997518302423, 'support': 134018}, 'weighted avg': {'precision': 0.39289209332335295, 'recall': 0.3820680804071095, 'f1-score': 0.3417526186677656, 'support': 134018}}
[[23431 19383  3125]
 [18152 24187  1815]
 [22045 18294  3586]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959705
{'0': {'precision': 0.4028319606993209, 'recall': 0.5290322580645161, 'f1-score': 0.45738659666967435, 'support': 10540}, '1': {'precision': 0.3133237046398267, 'recall': 0.47829681686647374, 'f1-score': 0.37862012544314155, 'support': 7257}, '2': {'precision': 0.356, 'recall': 0.08545823108929905, 'f1-score': 0.13783016432934697, 'support': 9373}, 'accuracy': 0.3624585940375414, 'macro avg': {'precision': 0.35738522177971593, 'recall': 0.3642624353400963, 'f1-score': 0.32461229548072096, 'support': 27170}, 'weighted avg': {'precision': 0.362768751944868, 'recall': 0.3624585940375414, 'f1-score': 0.32610905813390556, 'support': 27170}}
[[5576 3938 1026]
 [3363 3471  423]
 [4903 3669  801]]
training model: results/XRAY/W1/deepOF_L2/h1000
Epoch 1/50
524/524 - 18s - loss: 3.3108 - accuracy1000: 0.3658 - val_loss: 3.3447 - val_accuracy1000: 0.3372 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 16s - loss: 3.2706 - accuracy1000: 0.3847 - val_loss: 3.3553 - val_accuracy1000: 0.3356 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2499 - accuracy1000: 0.3939 - val_loss: 3.3634 - val_accuracy1000: 0.3353 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 3.2385 - accuracy1000: 0.3975 - val_loss: 3.3651 - val_accuracy1000: 0.3336 - 16s/epoch - 30ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2335 - accuracy1000: 0.3974 - val_loss: 3.3752 - val_accuracy1000: 0.3327 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 3.2282 - accuracy1000: 0.3991 - val_loss: 3.3682 - val_accuracy1000: 0.3337 - 16s/epoch - 31ms/step
Epoch 7/50
524/524 - 16s - loss: 3.2258 - accuracy1000: 0.3982 - val_loss: 3.3644 - val_accuracy1000: 0.3340 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 15s - loss: 3.2228 - accuracy1000: 0.3996 - val_loss: 3.3649 - val_accuracy1000: 0.3332 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 16s - loss: 3.2201 - accuracy1000: 0.4010 - val_loss: 3.3637 - val_accuracy1000: 0.3340 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 3.2170 - accuracy1000: 0.4026 - val_loss: 3.3640 - val_accuracy1000: 0.3319 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 16s - loss: 3.2148 - accuracy1000: 0.4029 - val_loss: 3.3592 - val_accuracy1000: 0.3335 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepOF_L2/h1000
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271658
{'0': {'precision': 0.362610514949045, 'recall': 0.22559623782331206, 'f1-score': 0.27814562679574456, 'support': 119080}, '1': {'precision': 0.2997610784465726, 'recall': 0.7612720848056537, 'f1-score': 0.4301462933225327, 'support': 99050}, '2': {'precision': 0.36065111027474595, 'recall': 0.032447303817827816, 'f1-score': 0.059538048121281786, 'support': 118130}, 'accuracy': 0.3155326235650984, 'macro avg': {'precision': 0.34100756789012115, 'recall': 0.3397718754822645, 'f1-score': 0.2559433227465197, 'support': 336260}, 'weighted avg': {'precision': 0.3434090007643521, 'recall': 0.3155326235650984, 'f1-score': 0.2461214572562932, 'support': 336260}}
[[26864 88291  3925]
 [20776 75404  2870]
 [26445 87852  3833]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074893
{'0': {'precision': 0.3760531704205968, 'recall': 0.24092991247123594, 'f1-score': 0.2936951107615677, 'support': 46499}, '1': {'precision': 0.35504811515826307, 'recall': 0.8058256808285011, 'f1-score': 0.49291643951888375, 'support': 44321}, '2': {'precision': 0.37276478679504815, 'recall': 0.031367192925598406, 'f1-score': 0.05786518053509277, 'support': 43198}, 'accuracy': 0.3601978838663463, 'macro avg': {'precision': 0.3679553574579693, 'recall': 0.35937426207511175, 'f1-score': 0.2814922436051814, 'support': 134018}, 'weighted avg': {'precision': 0.3680466589808026, 'recall': 0.3601978838663463, 'f1-score': 0.2835644356726225, 'support': 134018}}
[[11203 33988  1308]
 [ 7634 35715   972]
 [10954 30889  1355]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1145555
{'0': {'precision': 0.4321439463250991, 'recall': 0.26926365795724466, 'f1-score': 0.33179183984077737, 'support': 10525}, '1': {'precision': 0.30554143365531267, 'recall': 0.7639506800559298, 'f1-score': 0.43650361332026, 'support': 7867}, '2': {'precision': 0.351380042462845, 'recall': 0.03770790612895876, 'f1-score': 0.06810699588477366, 'support': 8778}, 'accuracy': 0.33768862716231135, 'macro avg': {'precision': 0.3630218074810856, 'recall': 0.356974081380711, 'f1-score': 0.27880081634860365, 'support': 27170}, 'weighted avg': {'precision': 0.36939357770985887, 'recall': 0.33768862716231135, 'f1-score': 0.2769203625392422, 'support': 27170}}
[[2834 7309  382]
 [1628 6010  229]
 [2096 6351  331]]
training model: results/XRAY/W1/deepVOL_L2/h10
Epoch 1/50
524/524 - 18s - loss: 3.1729 - accuracy10: 0.4467 - val_loss: 3.3423 - val_accuracy10: 0.4473 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 15s - loss: 2.9483 - accuracy10: 0.5096 - val_loss: 3.2986 - val_accuracy10: 0.4678 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 15s - loss: 2.8610 - accuracy10: 0.5374 - val_loss: 3.2519 - val_accuracy10: 0.4850 - 15s/epoch - 29ms/step
Epoch 4/50
524/524 - 15s - loss: 2.8180 - accuracy10: 0.5492 - val_loss: 3.2472 - val_accuracy10: 0.4817 - 15s/epoch - 29ms/step
Epoch 5/50
524/524 - 15s - loss: 2.7980 - accuracy10: 0.5552 - val_loss: 3.2594 - val_accuracy10: 0.4888 - 15s/epoch - 29ms/step
Epoch 6/50
524/524 - 15s - loss: 2.7816 - accuracy10: 0.5583 - val_loss: 3.2643 - val_accuracy10: 0.4916 - 15s/epoch - 29ms/step
Epoch 7/50
524/524 - 15s - loss: 2.7648 - accuracy10: 0.5640 - val_loss: 3.2578 - val_accuracy10: 0.4923 - 15s/epoch - 29ms/step
Epoch 8/50
524/524 - 15s - loss: 2.7550 - accuracy10: 0.5661 - val_loss: 3.2587 - val_accuracy10: 0.4903 - 15s/epoch - 28ms/step
Epoch 9/50
524/524 - 16s - loss: 2.7424 - accuracy10: 0.5687 - val_loss: 3.2562 - val_accuracy10: 0.4863 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 15s - loss: 2.7329 - accuracy10: 0.5702 - val_loss: 3.2582 - val_accuracy10: 0.4901 - 15s/epoch - 29ms/step
Epoch 11/50
524/524 - 15s - loss: 2.7241 - accuracy10: 0.5731 - val_loss: 3.2492 - val_accuracy10: 0.4939 - 15s/epoch - 29ms/step
Epoch 12/50
524/524 - 15s - loss: 2.7171 - accuracy10: 0.5754 - val_loss: 3.2376 - val_accuracy10: 0.4931 - 15s/epoch - 29ms/step
Epoch 13/50
524/524 - 16s - loss: 2.7091 - accuracy10: 0.5773 - val_loss: 3.2508 - val_accuracy10: 0.4912 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 2.6996 - accuracy10: 0.5795 - val_loss: 3.2320 - val_accuracy10: 0.4968 - 16s/epoch - 31ms/step
Epoch 15/50
524/524 - 17s - loss: 2.6934 - accuracy10: 0.5802 - val_loss: 3.2153 - val_accuracy10: 0.5002 - 17s/epoch - 32ms/step
Epoch 16/50
524/524 - 17s - loss: 2.6902 - accuracy10: 0.5798 - val_loss: 3.2186 - val_accuracy10: 0.5021 - 17s/epoch - 32ms/step
Epoch 17/50
524/524 - 15s - loss: 2.6836 - accuracy10: 0.5816 - val_loss: 3.2283 - val_accuracy10: 0.5002 - 15s/epoch - 30ms/step
Epoch 18/50
524/524 - 16s - loss: 2.6765 - accuracy10: 0.5843 - val_loss: 3.2158 - val_accuracy10: 0.5020 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 15s - loss: 2.6702 - accuracy10: 0.5859 - val_loss: 3.2096 - val_accuracy10: 0.5024 - 15s/epoch - 29ms/step
Epoch 20/50
524/524 - 15s - loss: 2.6661 - accuracy10: 0.5867 - val_loss: 3.2153 - val_accuracy10: 0.5019 - 15s/epoch - 29ms/step
Epoch 21/50
524/524 - 16s - loss: 2.6583 - accuracy10: 0.5878 - val_loss: 3.2127 - val_accuracy10: 0.5049 - 16s/epoch - 30ms/step
Epoch 22/50
524/524 - 16s - loss: 2.6551 - accuracy10: 0.5883 - val_loss: 3.2073 - val_accuracy10: 0.5061 - 16s/epoch - 30ms/step
Epoch 23/50
524/524 - 15s - loss: 2.6502 - accuracy10: 0.5905 - val_loss: 3.2014 - val_accuracy10: 0.5072 - 15s/epoch - 29ms/step
Epoch 24/50
524/524 - 16s - loss: 2.6447 - accuracy10: 0.5904 - val_loss: 3.1965 - val_accuracy10: 0.5052 - 16s/epoch - 30ms/step
Epoch 25/50
524/524 - 15s - loss: 2.6387 - accuracy10: 0.5931 - val_loss: 3.1981 - val_accuracy10: 0.5088 - 15s/epoch - 29ms/step
Epoch 26/50
524/524 - 16s - loss: 2.6343 - accuracy10: 0.5933 - val_loss: 3.2039 - val_accuracy10: 0.5046 - 16s/epoch - 30ms/step
Epoch 27/50
524/524 - 15s - loss: 2.6287 - accuracy10: 0.5932 - val_loss: 3.2070 - val_accuracy10: 0.5040 - 15s/epoch - 29ms/step
Epoch 28/50
524/524 - 15s - loss: 2.6229 - accuracy10: 0.5949 - val_loss: 3.2262 - val_accuracy10: 0.5060 - 15s/epoch - 30ms/step
Epoch 29/50
524/524 - 16s - loss: 2.6201 - accuracy10: 0.5970 - val_loss: 3.2030 - val_accuracy10: 0.5058 - 16s/epoch - 30ms/step
Epoch 30/50
524/524 - 15s - loss: 2.6135 - accuracy10: 0.5977 - val_loss: 3.2200 - val_accuracy10: 0.5060 - 15s/epoch - 29ms/step
Epoch 31/50
524/524 - 16s - loss: 2.6089 - accuracy10: 0.5986 - val_loss: 3.2284 - val_accuracy10: 0.5066 - 16s/epoch - 30ms/step
Epoch 32/50
524/524 - 15s - loss: 2.6055 - accuracy10: 0.5991 - val_loss: 3.2245 - val_accuracy10: 0.5080 - 15s/epoch - 29ms/step
Epoch 33/50
524/524 - 16s - loss: 2.6024 - accuracy10: 0.5993 - val_loss: 3.2310 - val_accuracy10: 0.5045 - 16s/epoch - 31ms/step
Epoch 34/50
524/524 - 16s - loss: 2.5967 - accuracy10: 0.6008 - val_loss: 3.2260 - val_accuracy10: 0.5042 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepVOL_L2/h10
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0340012
{'0': {'precision': 0.4827893858285846, 'recall': 0.4653130287648054, 'f1-score': 0.4738901365877085, 'support': 108153}, '1': {'precision': 0.5307316111927197, 'recall': 0.5087666575078994, 'f1-score': 0.5195170708611709, 'support': 116464}, '2': {'precision': 0.4681059618052383, 'recall': 0.5047291487532244, 'f1-score': 0.485728200111192, 'support': 111648}, 'accuracy': 0.49345010631495995, 'macro avg': {'precision': 0.4938756529421809, 'recall': 0.4929362783419764, 'f1-score': 0.49304513585335713, 'support': 336265}, 'weighted avg': {'precision': 0.49451873146208813, 'recall': 0.49345010631495995, 'f1-score': 0.4936233570819449, 'support': 336265}}
[[50325 26057 31771]
 [24951 59253 32260]
 [28962 26334 56352]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89356077
{'0': {'precision': 0.513934118236473, 'recall': 0.46075458986019874, 'f1-score': 0.4858936025341188, 'support': 35622}, '1': {'precision': 0.6861172046380445, 'recall': 0.7029925507320832, 'f1-score': 0.6944523741554858, 'support': 62288}, '2': {'precision': 0.47883017092676805, 'recall': 0.5073944832170156, 'f1-score': 0.49269866881807184, 'support': 36108}, 'accuracy': 0.5859063707860138, 'macro avg': {'precision': 0.5596271646004286, 'recall': 0.5570472079364325, 'f1-score': 0.5576815485025588, 'support': 134018}, 'weighted avg': {'precision': 0.5845023012889157, 'recall': 0.5859063707860138, 'f1-score': 0.5846596347098914, 'support': 134018}}
[[16413 10136  9073]
 [ 7632 43788 10868]
 [ 7891  9896 18321]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0100139
{'0': {'precision': 0.5030295217223153, 'recall': 0.44938385350685245, 'f1-score': 0.47469586374695866, 'support': 8683}, '1': {'precision': 0.5431905088734189, 'recall': 0.561353733914277, 'f1-score': 0.5521227825393661, 'support': 9869}, '2': {'precision': 0.46863468634686345, 'recall': 0.5010443258296589, 'f1-score': 0.48429789143113505, 'support': 8618}, 'accuracy': 0.5064409274935591, 'macro avg': {'precision': 0.5049515723141993, 'recall': 0.5039273044169295, 'f1-score': 0.5037055125724866, 'support': 27170}, 'weighted avg': {'precision': 0.5067076259154915, 'recall': 0.5064409274935591, 'f1-score': 0.5058654086915483, 'support': 27170}}
[[3902 2386 2395]
 [1828 5540 2501]
 [2027 2273 4318]]
training model: results/XRAY/W1/deepVOL_L2/h20
Epoch 1/50
524/524 - 18s - loss: 3.1476 - accuracy20: 0.4464 - val_loss: 3.2968 - val_accuracy20: 0.4070 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 15s - loss: 2.9547 - accuracy20: 0.5026 - val_loss: 3.2741 - val_accuracy20: 0.4200 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 15s - loss: 2.8997 - accuracy20: 0.5182 - val_loss: 3.2444 - val_accuracy20: 0.4332 - 15s/epoch - 30ms/step
Epoch 4/50
524/524 - 16s - loss: 2.8578 - accuracy20: 0.5308 - val_loss: 3.2618 - val_accuracy20: 0.4322 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 15s - loss: 2.8356 - accuracy20: 0.5377 - val_loss: 3.2651 - val_accuracy20: 0.4308 - 15s/epoch - 29ms/step
Epoch 6/50
524/524 - 16s - loss: 2.8227 - accuracy20: 0.5392 - val_loss: 3.2372 - val_accuracy20: 0.4397 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 15s - loss: 2.8146 - accuracy20: 0.5414 - val_loss: 3.1963 - val_accuracy20: 0.4445 - 15s/epoch - 30ms/step
Epoch 8/50
524/524 - 15s - loss: 2.8009 - accuracy20: 0.5441 - val_loss: 3.1803 - val_accuracy20: 0.4504 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 16s - loss: 2.7885 - accuracy20: 0.5487 - val_loss: 3.1863 - val_accuracy20: 0.4497 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 2.7830 - accuracy20: 0.5495 - val_loss: 3.1675 - val_accuracy20: 0.4511 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 15s - loss: 2.7720 - accuracy20: 0.5501 - val_loss: 3.1789 - val_accuracy20: 0.4475 - 15s/epoch - 29ms/step
Epoch 12/50
524/524 - 16s - loss: 2.7654 - accuracy20: 0.5534 - val_loss: 3.1708 - val_accuracy20: 0.4503 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 2.7598 - accuracy20: 0.5554 - val_loss: 3.1804 - val_accuracy20: 0.4516 - 16s/epoch - 31ms/step
Epoch 14/50
524/524 - 17s - loss: 2.7538 - accuracy20: 0.5559 - val_loss: 3.1673 - val_accuracy20: 0.4561 - 17s/epoch - 32ms/step
Epoch 15/50
524/524 - 17s - loss: 2.7454 - accuracy20: 0.5576 - val_loss: 3.1732 - val_accuracy20: 0.4507 - 17s/epoch - 32ms/step
Epoch 16/50
524/524 - 16s - loss: 2.7384 - accuracy20: 0.5593 - val_loss: 3.2005 - val_accuracy20: 0.4491 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 16s - loss: 2.7374 - accuracy20: 0.5600 - val_loss: 3.2018 - val_accuracy20: 0.4510 - 16s/epoch - 30ms/step
Epoch 18/50
524/524 - 17s - loss: 2.7294 - accuracy20: 0.5624 - val_loss: 3.2099 - val_accuracy20: 0.4517 - 17s/epoch - 32ms/step
Epoch 19/50
524/524 - 16s - loss: 2.7248 - accuracy20: 0.5631 - val_loss: 3.2228 - val_accuracy20: 0.4512 - 16s/epoch - 30ms/step
Epoch 20/50
524/524 - 16s - loss: 2.7205 - accuracy20: 0.5639 - val_loss: 3.2076 - val_accuracy20: 0.4545 - 16s/epoch - 30ms/step
Epoch 21/50
524/524 - 16s - loss: 2.7148 - accuracy20: 0.5665 - val_loss: 3.2728 - val_accuracy20: 0.4406 - 16s/epoch - 30ms/step
Epoch 22/50
524/524 - 16s - loss: 2.7098 - accuracy20: 0.5672 - val_loss: 3.2488 - val_accuracy20: 0.4478 - 16s/epoch - 30ms/step
Epoch 23/50
524/524 - 16s - loss: 2.7060 - accuracy20: 0.5683 - val_loss: 3.2797 - val_accuracy20: 0.4433 - 16s/epoch - 31ms/step
Epoch 24/50
524/524 - 15s - loss: 2.7020 - accuracy20: 0.5693 - val_loss: 3.2768 - val_accuracy20: 0.4471 - 15s/epoch - 29ms/step
testing model: results/XRAY/W1/deepVOL_L2/h20
Evaluating performance on  test set...
1314/1314 - 24s - 24s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0586939
{'0': {'precision': 0.5125644829189453, 'recall': 0.36195777081167285, 'f1-score': 0.42429268516185203, 'support': 127921}, '1': {'precision': 0.3487686437738467, 'recall': 0.5525881921909348, 'f1-score': 0.4276340438458813, 'support': 76424}, '2': {'precision': 0.4969041611598382, 'recall': 0.47025469981807155, 'f1-score': 0.483212275816408, 'support': 131920}, 'accuracy': 0.44776887276404026, 'macro avg': {'precision': 0.45274576261754335, 'recall': 0.46160022094022635, 'f1-score': 0.44504633494138046, 'support': 336265}, 'weighted avg': {'precision': 0.4691943942766946, 'recall': 0.44776887276404026, 'f1-score': 0.4481668094246129, 'support': 336265}}
[[46302 39207 42412]
 [13796 42231 20397]
 [30236 39648 62036]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9556846
{'0': {'precision': 0.5491424802110818, 'recall': 0.34948807052732234, 'f1-score': 0.42713603648542725, 'support': 42877}, '1': {'precision': 0.5340437247927612, 'recall': 0.7565356721200877, 'f1-score': 0.6261112322791712, 'support': 47432}, '2': {'precision': 0.509548018311961, 'recall': 0.4609119403326546, 'f1-score': 0.4840112437834851, 'support': 43709}, 'accuracy': 0.5298915071109851, 'macro avg': {'precision': 0.5309114077719347, 'recall': 0.5223118943266881, 'f1-score': 0.5124195041826946, 'support': 134018}, 'weighted avg': {'precision': 0.530885242361312, 'recall': 0.5298915071109851, 'f1-score': 0.5161072935007511, 'support': 134018}}
[[14985 15869 12023]
 [ 4180 35884  7368]
 [ 8123 15440 20146]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0436867
{'0': {'precision': 0.5393258426966292, 'recall': 0.33494863345609616, 'f1-score': 0.41324883415042446, 'support': 10318}, '1': {'precision': 0.3646815772927333, 'recall': 0.6235601290124405, 'f1-score': 0.4602131036046248, 'support': 6511}, '2': {'precision': 0.5053484266278949, 'recall': 0.47055410501885697, 'f1-score': 0.4873309964947421, 'support': 10341}, 'accuracy': 0.4557232241442768, 'macro avg': {'precision': 0.46978528220575244, 'recall': 0.47635428916246453, 'f1-score': 0.4535976447499304, 'support': 27170}, 'weighted avg': {'precision': 0.48454228466896826, 'recall': 0.4557232241442768, 'f1-score': 0.45269925738262495, 'support': 27170}}
[[3456 3664 3198]
 [ 886 4060 1565]
 [2066 3409 4866]]
training model: results/XRAY/W1/deepVOL_L2/h30
Epoch 1/50
524/524 - 18s - loss: 3.1832 - accuracy30: 0.4279 - val_loss: 3.3136 - val_accuracy30: 0.3661 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 16s - loss: 3.0240 - accuracy30: 0.4813 - val_loss: 3.2325 - val_accuracy30: 0.4099 - 16s/epoch - 31ms/step
Epoch 3/50
524/524 - 16s - loss: 2.9755 - accuracy30: 0.4950 - val_loss: 3.1920 - val_accuracy30: 0.4218 - 16s/epoch - 31ms/step
Epoch 4/50
524/524 - 16s - loss: 2.9474 - accuracy30: 0.5049 - val_loss: 3.2054 - val_accuracy30: 0.4168 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 2.9273 - accuracy30: 0.5108 - val_loss: 3.1805 - val_accuracy30: 0.4265 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 16s - loss: 2.9117 - accuracy30: 0.5140 - val_loss: 3.1606 - val_accuracy30: 0.4323 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 17s - loss: 2.8984 - accuracy30: 0.5195 - val_loss: 3.1577 - val_accuracy30: 0.4322 - 17s/epoch - 32ms/step
Epoch 8/50
524/524 - 15s - loss: 2.8874 - accuracy30: 0.5221 - val_loss: 3.1577 - val_accuracy30: 0.4317 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 16s - loss: 2.8803 - accuracy30: 0.5235 - val_loss: 3.1527 - val_accuracy30: 0.4315 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 2.8719 - accuracy30: 0.5250 - val_loss: 3.1671 - val_accuracy30: 0.4290 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 17s - loss: 2.8677 - accuracy30: 0.5260 - val_loss: 3.1550 - val_accuracy30: 0.4312 - 17s/epoch - 32ms/step
Epoch 12/50
524/524 - 16s - loss: 2.8606 - accuracy30: 0.5286 - val_loss: 3.1532 - val_accuracy30: 0.4341 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 16s - loss: 2.8539 - accuracy30: 0.5302 - val_loss: 3.1704 - val_accuracy30: 0.4328 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 15s - loss: 2.8491 - accuracy30: 0.5298 - val_loss: 3.1797 - val_accuracy30: 0.4291 - 15s/epoch - 29ms/step
Epoch 15/50
524/524 - 15s - loss: 2.8417 - accuracy30: 0.5318 - val_loss: 3.1707 - val_accuracy30: 0.4313 - 15s/epoch - 28ms/step
Epoch 16/50
524/524 - 14s - loss: 2.8366 - accuracy30: 0.5343 - val_loss: 3.1759 - val_accuracy30: 0.4331 - 14s/epoch - 27ms/step
Epoch 17/50
524/524 - 14s - loss: 2.8322 - accuracy30: 0.5355 - val_loss: 3.1767 - val_accuracy30: 0.4314 - 14s/epoch - 28ms/step
Epoch 18/50
524/524 - 15s - loss: 2.8244 - accuracy30: 0.5368 - val_loss: 3.2131 - val_accuracy30: 0.4283 - 15s/epoch - 28ms/step
Epoch 19/50
524/524 - 15s - loss: 2.8190 - accuracy30: 0.5389 - val_loss: 3.1995 - val_accuracy30: 0.4275 - 15s/epoch - 28ms/step
testing model: results/XRAY/W1/deepVOL_L2/h30
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664856
{'0': {'precision': 0.48633505799045507, 'recall': 0.4046650063779384, 'f1-score': 0.4417570485430455, 'support': 131704}, '1': {'precision': 0.3063544739429695, 'recall': 0.499556204546756, 'f1-score': 0.37979712227083745, 'support': 69852}, '2': {'precision': 0.496284604607445, 'recall': 0.41547335367347393, 'f1-score': 0.45229773358170056, 'support': 134709}, 'accuracy': 0.42870652610292476, 'macro avg': {'precision': 0.4296580455136232, 'recall': 0.4398981881993895, 'f1-score': 0.42461730146519444, 'support': 336265}, 'weighted avg': {'precision': 0.4529336921579811, 'recall': 0.42870652610292476, 'f1-score': 0.43310881090578296, 'support': 336265}}
[[53296 39315 39093]
 [17244 34895 17713]
 [39047 39694 55968]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9856507
{'0': {'precision': 0.5209306642740015, 'recall': 0.37552413239361226, 'f1-score': 0.436434801767824, 'support': 44836}, '1': {'precision': 0.4903906238093061, 'recall': 0.7336738416636264, 'f1-score': 0.587855922681307, 'support': 43856}, '2': {'precision': 0.5055149096552488, 'recall': 0.4024401006045096, 'f1-score': 0.4481267657535929, 'support': 45326}, 'accuracy': 0.5018281126415854, 'macro avg': {'precision': 0.5056120659128521, 'recall': 0.5038793582205827, 'f1-score': 0.4908058300675746, 'support': 134018}, 'weighted avg': {'precision': 0.5057230167306173, 'recall': 0.5018281126415854, 'f1-score': 0.48994011178887087, 'support': 134018}}
[[16837 16739 11260]
 [ 5097 32176  6583]
 [10387 16698 18241]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.053285
{'0': {'precision': 0.5088897668905571, 'recall': 0.3639103409304954, 'f1-score': 0.42435890395914555, 'support': 10618}, '1': {'precision': 0.3166241857830643, 'recall': 0.5736275012827091, 'f1-score': 0.408029197080292, 'support': 5847}, '2': {'precision': 0.501113089937667, 'recall': 0.4205511443250817, 'f1-score': 0.45731118898877543, 'support': 10705}, 'accuracy': 0.4313581155686419, 'macro avg': {'precision': 0.44220901420376285, 'recall': 0.45269632884609545, 'f1-score': 0.4298997633427377, 'support': 27170}, 'weighted avg': {'precision': 0.4644500841700492, 'recall': 0.4313581155686419, 'f1-score': 0.433827965980549, 'support': 27170}}
[[3864 3716 3038]
 [1049 3354 1444]
 [2680 3523 4502]]
training model: results/XRAY/W1/deepVOL_L2/h50
Epoch 1/50
524/524 - 17s - loss: 3.2658 - accuracy50: 0.3966 - val_loss: 3.3210 - val_accuracy50: 0.3497 - 17s/epoch - 33ms/step
Epoch 2/50
524/524 - 15s - loss: 3.1581 - accuracy50: 0.4369 - val_loss: 3.2934 - val_accuracy50: 0.3723 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 16s - loss: 3.1258 - accuracy50: 0.4531 - val_loss: 3.2665 - val_accuracy50: 0.3893 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 15s - loss: 3.1070 - accuracy50: 0.4592 - val_loss: 3.2546 - val_accuracy50: 0.3985 - 15s/epoch - 29ms/step
Epoch 5/50
524/524 - 15s - loss: 3.0935 - accuracy50: 0.4631 - val_loss: 3.2566 - val_accuracy50: 0.3980 - 15s/epoch - 28ms/step
Epoch 6/50
524/524 - 15s - loss: 3.0809 - accuracy50: 0.4677 - val_loss: 3.2457 - val_accuracy50: 0.4052 - 15s/epoch - 29ms/step
Epoch 7/50
524/524 - 15s - loss: 3.0732 - accuracy50: 0.4703 - val_loss: 3.2511 - val_accuracy50: 0.4044 - 15s/epoch - 29ms/step
Epoch 8/50
524/524 - 15s - loss: 3.0642 - accuracy50: 0.4739 - val_loss: 3.2567 - val_accuracy50: 0.4059 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 15s - loss: 3.0579 - accuracy50: 0.4755 - val_loss: 3.2354 - val_accuracy50: 0.4091 - 15s/epoch - 29ms/step
Epoch 10/50
524/524 - 15s - loss: 3.0508 - accuracy50: 0.4782 - val_loss: 3.2516 - val_accuracy50: 0.4067 - 15s/epoch - 29ms/step
Epoch 11/50
524/524 - 15s - loss: 3.0464 - accuracy50: 0.4800 - val_loss: 3.2504 - val_accuracy50: 0.4080 - 15s/epoch - 29ms/step
Epoch 12/50
524/524 - 15s - loss: 3.0414 - accuracy50: 0.4813 - val_loss: 3.2459 - val_accuracy50: 0.4080 - 15s/epoch - 29ms/step
Epoch 13/50
524/524 - 15s - loss: 3.0378 - accuracy50: 0.4816 - val_loss: 3.2642 - val_accuracy50: 0.4047 - 15s/epoch - 29ms/step
Epoch 14/50
524/524 - 15s - loss: 3.0328 - accuracy50: 0.4833 - val_loss: 3.2463 - val_accuracy50: 0.4057 - 15s/epoch - 29ms/step
Epoch 15/50
524/524 - 15s - loss: 3.0288 - accuracy50: 0.4852 - val_loss: 3.2559 - val_accuracy50: 0.4035 - 15s/epoch - 29ms/step
Epoch 16/50
524/524 - 15s - loss: 3.0229 - accuracy50: 0.4856 - val_loss: 3.2623 - val_accuracy50: 0.4058 - 15s/epoch - 29ms/step
Epoch 17/50
524/524 - 15s - loss: 3.0202 - accuracy50: 0.4875 - val_loss: 3.2660 - val_accuracy50: 0.3982 - 15s/epoch - 29ms/step
Epoch 18/50
524/524 - 16s - loss: 3.0152 - accuracy50: 0.4890 - val_loss: 3.2715 - val_accuracy50: 0.4020 - 16s/epoch - 30ms/step
Epoch 19/50
524/524 - 15s - loss: 3.0112 - accuracy50: 0.4915 - val_loss: 3.2776 - val_accuracy50: 0.3997 - 15s/epoch - 28ms/step
testing model: results/XRAY/W1/deepVOL_L2/h50
Evaluating performance on  test set...
1314/1314 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0927101
{'0': {'precision': 0.43354711483797614, 'recall': 0.3902000287811196, 'f1-score': 0.4107330702101339, 'support': 125082}, '1': {'precision': 0.30689071091908876, 'recall': 0.29405953403036683, 'f1-score': 0.30033814016901006, 'support': 85027}, '2': {'precision': 0.4309259793133029, 'recall': 0.48578743777545264, 'f1-score': 0.45671509429040924, 'support': 126156}, 'accuracy': 0.4017515947243989, 'macro avg': {'precision': 0.39045460169012264, 'recall': 0.3900156668623131, 'f1-score': 0.3892621015565177, 'support': 336265}, 'weighted avg': {'precision': 0.4005377739037073, 'recall': 0.4017515947243989, 'f1-score': 0.4000699280849188, 'support': 336265}}
[[48807 28157 48118]
 [27210 25003 32814]
 [36559 28312 61285]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0354444
{'0': {'precision': 0.4649952309578962, 'recall': 0.3783286401631893, 'f1-score': 0.41720866546041374, 'support': 45101}, '1': {'precision': 0.4728279615222473, 'recall': 0.5587509340821086, 'f1-score': 0.5122110704017769, 'support': 44161}, '2': {'precision': 0.4506945521412588, 'recall': 0.4545312360353919, 'f1-score': 0.4526047634409798, 'support': 44756}, 'accuracy': 0.4632288200092525, 'macro avg': {'precision': 0.4628392482071341, 'recall': 0.4638702700935633, 'f1-score': 0.46067483310105684, 'support': 134018}, 'weighted avg': {'precision': 0.46280045140093284, 'recall': 0.4632288200092525, 'f1-score': 0.46033413342616275, 'support': 134018}}
[[17063 13857 14181]
 [ 8873 24675 10613]
 [10759 13654 20343]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812298
{'0': {'precision': 0.44926635165381745, 'recall': 0.3558203663580855, 'f1-score': 0.39712024620795777, 'support': 10154}, '1': {'precision': 0.3232620320855615, 'recall': 0.353302162478083, 'f1-score': 0.3376151912873499, 'support': 6844}, '2': {'precision': 0.4368131868131868, 'recall': 0.5001966181675187, 'f1-score': 0.46636113657195233, 'support': 10172}, 'accuracy': 0.4092381302907619, 'macro avg': {'precision': 0.40311385685085527, 'recall': 0.4031063823345624, 'f1-score': 0.4003655246890867, 'support': 27170}, 'weighted avg': {'precision': 0.4128641744037608, 'recall': 0.4092381302907619, 'f1-score': 0.40805383991078853, 'support': 27170}}
[[3613 2581 3960]
 [1826 2418 2600]
 [2603 2481 5088]]
training model: results/XRAY/W1/deepVOL_L2/h100
Epoch 1/50
524/524 - 18s - loss: 3.3089 - accuracy100: 0.3679 - val_loss: 3.3048 - val_accuracy100: 0.3553 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 15s - loss: 3.2549 - accuracy100: 0.3889 - val_loss: 3.2970 - val_accuracy100: 0.3653 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 15s - loss: 3.2371 - accuracy100: 0.3996 - val_loss: 3.2873 - val_accuracy100: 0.3662 - 15s/epoch - 29ms/step
Epoch 4/50
524/524 - 16s - loss: 3.2203 - accuracy100: 0.4083 - val_loss: 3.2932 - val_accuracy100: 0.3667 - 16s/epoch - 31ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2106 - accuracy100: 0.4109 - val_loss: 3.2836 - val_accuracy100: 0.3740 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 16s - loss: 3.2027 - accuracy100: 0.4163 - val_loss: 3.2939 - val_accuracy100: 0.3693 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 15s - loss: 3.1971 - accuracy100: 0.4184 - val_loss: 3.3076 - val_accuracy100: 0.3598 - 15s/epoch - 28ms/step
Epoch 8/50
524/524 - 15s - loss: 3.1869 - accuracy100: 0.4233 - val_loss: 3.3121 - val_accuracy100: 0.3572 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 15s - loss: 3.1820 - accuracy100: 0.4261 - val_loss: 3.3227 - val_accuracy100: 0.3516 - 15s/epoch - 29ms/step
Epoch 10/50
524/524 - 16s - loss: 3.1740 - accuracy100: 0.4285 - val_loss: 3.3249 - val_accuracy100: 0.3576 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 15s - loss: 3.1692 - accuracy100: 0.4306 - val_loss: 3.3216 - val_accuracy100: 0.3596 - 15s/epoch - 29ms/step
Epoch 12/50
524/524 - 15s - loss: 3.1635 - accuracy100: 0.4331 - val_loss: 3.3285 - val_accuracy100: 0.3572 - 15s/epoch - 29ms/step
Epoch 13/50
524/524 - 15s - loss: 3.1566 - accuracy100: 0.4349 - val_loss: 3.3364 - val_accuracy100: 0.3503 - 15s/epoch - 28ms/step
Epoch 14/50
524/524 - 15s - loss: 3.1499 - accuracy100: 0.4392 - val_loss: 3.3458 - val_accuracy100: 0.3556 - 15s/epoch - 29ms/step
Epoch 15/50
524/524 - 15s - loss: 3.1451 - accuracy100: 0.4413 - val_loss: 3.3493 - val_accuracy100: 0.3495 - 15s/epoch - 28ms/step
testing model: results/XRAY/W1/deepVOL_L2/h100
Evaluating performance on  test set...
1314/1314 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026125
{'0': {'precision': 0.3830524383342305, 'recall': 0.2257353419665517, 'f1-score': 0.2840677029219533, 'support': 122936}, '1': {'precision': 0.3072627656218969, 'recall': 0.28268346158806584, 'f1-score': 0.2944610820342019, 'support': 93044}, '2': {'precision': 0.3711654892630894, 'recall': 0.5499272561000956, 'f1-score': 0.4431997105547032, 'support': 120285}, 'accuracy': 0.35745914680386004, 'macro avg': {'precision': 0.35382689773973897, 'recall': 0.3527820198849044, 'f1-score': 0.34057616517028616, 'support': 336265}, 'weighted avg': {'precision': 0.35782948626705563, 'recall': 0.35745914680386004, 'f1-score': 0.3438664780077499, 'support': 336265}}
[[27751 30376 64809]
 [19482 26302 47260]
 [25214 28923 66148]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0800822
{'0': {'precision': 0.4090924086965128, 'recall': 0.27588048145593697, 'f1-score': 0.3295330728959047, 'support': 44947}, '1': {'precision': 0.4150389926307505, 'recall': 0.38787108852634394, 'f1-score': 0.40099540317284765, 'support': 44868}, '2': {'precision': 0.37977531727531727, 'recall': 0.530755831052191, 'f1-score': 0.44274809160305345, 'support': 44203}, 'accuracy': 0.39743914996493007, 'macro avg': {'precision': 0.4013022395341936, 'recall': 0.39816913367815737, 'f1-score': 0.39109218922393524, 'support': 134018}, 'weighted avg': {'precision': 0.40141364864838697, 'recall': 0.39743914996493007, 'f1-score': 0.39079958416139116, 'support': 134018}}
[[12400 12772 19775]
 [ 8925 17403 18540]
 [ 8986 11756 23461]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0954312
{'0': {'precision': 0.40961709706144256, 'recall': 0.22860550641089356, 'f1-score': 0.2934422046440418, 'support': 10061}, '1': {'precision': 0.32052896725440805, 'recall': 0.27840831396143856, 'f1-score': 0.29798755945847055, 'support': 7313}, '2': {'precision': 0.3795303558508189, 'recall': 0.5890159248672928, 'f1-score': 0.46161846473858953, 'support': 9796}, 'accuracy': 0.37195436142804567, 'macro avg': {'precision': 0.36989214005555654, 'recall': 0.36534324841320825, 'f1-score': 0.3510160762803673, 'support': 27170}, 'weighted avg': {'precision': 0.37479077353630036, 'recall': 0.37195436142804567, 'f1-score': 0.35530068177485186, 'support': 27170}}
[[2300 2160 5601]
 [1445 2036 3832]
 [1870 2156 5770]]
training model: results/XRAY/W1/deepVOL_L2/h200
Epoch 1/50
524/524 - 18s - loss: 3.3079 - accuracy200: 0.3651 - val_loss: 3.3841 - val_accuracy200: 0.3548 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 15s - loss: 3.2734 - accuracy200: 0.3753 - val_loss: 3.3549 - val_accuracy200: 0.3654 - 15s/epoch - 30ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2594 - accuracy200: 0.3844 - val_loss: 3.3554 - val_accuracy200: 0.3583 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 15s - loss: 3.2471 - accuracy200: 0.3901 - val_loss: 3.3505 - val_accuracy200: 0.3682 - 15s/epoch - 29ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2417 - accuracy200: 0.3939 - val_loss: 3.3372 - val_accuracy200: 0.3692 - 16s/epoch - 31ms/step
Epoch 6/50
524/524 - 15s - loss: 3.2376 - accuracy200: 0.3960 - val_loss: 3.3352 - val_accuracy200: 0.3698 - 15s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.2311 - accuracy200: 0.3987 - val_loss: 3.3474 - val_accuracy200: 0.3715 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 15s - loss: 3.2287 - accuracy200: 0.4023 - val_loss: 3.3301 - val_accuracy200: 0.3773 - 15s/epoch - 29ms/step
Epoch 9/50
524/524 - 16s - loss: 3.2240 - accuracy200: 0.4015 - val_loss: 3.3349 - val_accuracy200: 0.3789 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 3.2214 - accuracy200: 0.4056 - val_loss: 3.3351 - val_accuracy200: 0.3793 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 16s - loss: 3.2172 - accuracy200: 0.4085 - val_loss: 3.3358 - val_accuracy200: 0.3792 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 15s - loss: 3.2132 - accuracy200: 0.4110 - val_loss: 3.3375 - val_accuracy200: 0.3785 - 15s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 3.2099 - accuracy200: 0.4107 - val_loss: 3.3382 - val_accuracy200: 0.3783 - 16s/epoch - 30ms/step
Epoch 14/50
524/524 - 16s - loss: 3.2036 - accuracy200: 0.4156 - val_loss: 3.3437 - val_accuracy200: 0.3806 - 16s/epoch - 31ms/step
Epoch 15/50
524/524 - 16s - loss: 3.2013 - accuracy200: 0.4165 - val_loss: 3.3378 - val_accuracy200: 0.3832 - 16s/epoch - 30ms/step
Epoch 16/50
524/524 - 16s - loss: 3.1972 - accuracy200: 0.4182 - val_loss: 3.3388 - val_accuracy200: 0.3824 - 16s/epoch - 30ms/step
Epoch 17/50
524/524 - 17s - loss: 3.1946 - accuracy200: 0.4185 - val_loss: 3.3307 - val_accuracy200: 0.3834 - 17s/epoch - 33ms/step
Epoch 18/50
524/524 - 17s - loss: 3.1883 - accuracy200: 0.4213 - val_loss: 3.3343 - val_accuracy200: 0.3889 - 17s/epoch - 32ms/step
testing model: results/XRAY/W1/deepVOL_L2/h200
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1279471
{'0': {'precision': 0.38829462593556263, 'recall': 0.10749188564314614, 'f1-score': 0.16837296115220146, 'support': 112455}, '1': {'precision': 0.3481515730497515, 'recall': 0.8978965550499338, 'f1-score': 0.5017528473050739, 'support': 114051}, '2': {'precision': 0.31495633187772926, 'recall': 0.03154183256042785, 'f1-score': 0.05734114003196661, 'support': 109759}, 'accuracy': 0.3507828647049202, 'macro avg': {'precision': 0.35046751028768114, 'recall': 0.3456434244178359, 'f1-score': 0.24248898282974732, 'support': 336265}, 'weighted avg': {'precision': 0.3507412286382721, 'recall': 0.3507828647049202, 'f1-score': 0.24520393595268736, 'support': 336265}}
[[ 12088  96066   4301]
 [  8416 102406   3229]
 [ 10627  95670   3462]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265349
{'0': {'precision': 0.4115625, 'recall': 0.08705519444750469, 'f1-score': 0.14371192143311814, 'support': 45385}, '1': {'precision': 0.3466587358629293, 'recall': 0.9400721374644353, 'f1-score': 0.5065305038507038, 'support': 44637}, '2': {'precision': 0.40551765054879857, 'recall': 0.031071006455132284, 'f1-score': 0.05771950936305867, 'support': 43996}, 'accuracy': 0.3527884314047367, 'macro avg': {'precision': 0.3879129621372426, 'recall': 0.35273277945569076, 'f1-score': 0.23598731154896022, 'support': 134018}, 'weighted avg': {'precision': 0.38796075608320163, 'recall': 0.3527884314047367, 'f1-score': 0.2363249353710924, 'support': 134018}}
[[ 3951 40262  1172]
 [ 1843 41962   832]
 [ 3806 38823  1367]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109116
{'0': {'precision': 0.4243194192377496, 'recall': 0.1294000442771751, 'f1-score': 0.19832046823309862, 'support': 9034}, '1': {'precision': 0.37143836496850763, 'recall': 0.9152238175675675, 'f1-score': 0.5284203468349029, 'support': 9472}, '2': {'precision': 0.3252788104089219, 'recall': 0.04039704524469068, 'f1-score': 0.07186858316221767, 'support': 8664}, 'accuracy': 0.3749723960250276, 'macro avg': {'precision': 0.37367886487172636, 'recall': 0.3616736356964778, 'f1-score': 0.2662031327434064, 'support': 27170}, 'weighted avg': {'precision': 0.37430185645043923, 'recall': 0.3749723960250276, 'f1-score': 0.27307670370833514, 'support': 27170}}
[[1169 7360  505]
 [ 582 8669  221]
 [1004 7310  350]]
training model: results/XRAY/W1/deepVOL_L2/h300
Epoch 1/50
524/524 - 18s - loss: 3.3061 - accuracy300: 0.3711 - val_loss: 3.3933 - val_accuracy300: 0.3047 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 16s - loss: 3.2758 - accuracy300: 0.3762 - val_loss: 3.3441 - val_accuracy300: 0.3133 - 16s/epoch - 30ms/step
Epoch 3/50
524/524 - 17s - loss: 3.2562 - accuracy300: 0.3843 - val_loss: 3.3304 - val_accuracy300: 0.3257 - 17s/epoch - 32ms/step
Epoch 4/50
524/524 - 17s - loss: 3.2430 - accuracy300: 0.3898 - val_loss: 3.3451 - val_accuracy300: 0.3173 - 17s/epoch - 32ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2361 - accuracy300: 0.3938 - val_loss: 3.3619 - val_accuracy300: 0.3184 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 15s - loss: 3.2307 - accuracy300: 0.3959 - val_loss: 3.3269 - val_accuracy300: 0.3388 - 15s/epoch - 29ms/step
Epoch 7/50
524/524 - 17s - loss: 3.2241 - accuracy300: 0.3981 - val_loss: 3.3456 - val_accuracy300: 0.3292 - 17s/epoch - 32ms/step
Epoch 8/50
524/524 - 14s - loss: 3.2170 - accuracy300: 0.4031 - val_loss: 3.3581 - val_accuracy300: 0.3232 - 14s/epoch - 28ms/step
Epoch 9/50
524/524 - 15s - loss: 3.2095 - accuracy300: 0.4092 - val_loss: 3.3762 - val_accuracy300: 0.3163 - 15s/epoch - 28ms/step
Epoch 10/50
524/524 - 15s - loss: 3.2058 - accuracy300: 0.4110 - val_loss: 3.4389 - val_accuracy300: 0.3066 - 15s/epoch - 29ms/step
Epoch 11/50
524/524 - 15s - loss: 3.2005 - accuracy300: 0.4135 - val_loss: 3.4553 - val_accuracy300: 0.3029 - 15s/epoch - 29ms/step
Epoch 12/50
524/524 - 15s - loss: 3.1964 - accuracy300: 0.4148 - val_loss: 3.4903 - val_accuracy300: 0.3015 - 15s/epoch - 29ms/step
Epoch 13/50
524/524 - 15s - loss: 3.1883 - accuracy300: 0.4174 - val_loss: 3.4721 - val_accuracy300: 0.3022 - 15s/epoch - 29ms/step
Epoch 14/50
524/524 - 15s - loss: 3.1860 - accuracy300: 0.4199 - val_loss: 3.5060 - val_accuracy300: 0.2954 - 15s/epoch - 29ms/step
Epoch 15/50
524/524 - 16s - loss: 3.1821 - accuracy300: 0.4214 - val_loss: 3.4731 - val_accuracy300: 0.2979 - 16s/epoch - 30ms/step
Epoch 16/50
524/524 - 15s - loss: 3.1781 - accuracy300: 0.4222 - val_loss: 3.4465 - val_accuracy300: 0.3031 - 15s/epoch - 29ms/step
testing model: results/XRAY/W1/deepVOL_L2/h300
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1243232
{'0': {'precision': 0.3634253165162865, 'recall': 0.25291893602491716, 'f1-score': 0.2982656007542574, 'support': 120078}, '1': {'precision': 0.30319346790655477, 'recall': 0.6793064547274704, 'f1-score': 0.41925963562003865, 'support': 98393}, '2': {'precision': 0.3513287233712673, 'recall': 0.09618486510348574, 'f1-score': 0.1510233732996541, 'support': 117794}, 'accuracy': 0.32277816602976817, 'macro avg': {'precision': 0.3393158359313695, 'recall': 0.34280341861862446, 'f1-score': 0.28951620322465005, 'support': 336265}, 'weighted avg': {'precision': 0.3415636943635744, 'recall': 0.32277816602976817, 'f1-score': 0.28209001046612536, 'support': 336265}}
[[30370 77455 12253]
 [22888 66839  8666]
 [30308 76156 11330]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105918
{'0': {'precision': 0.3985933313486157, 'recall': 0.22610880074307066, 'f1-score': 0.2885389868405102, 'support': 47371}, '1': {'precision': 0.33579699683824205, 'recall': 0.7957502168256722, 'f1-score': 0.47229232650084724, 'support': 41508}, '2': {'precision': 0.403848343390641, 'recall': 0.07857949888123353, 'f1-score': 0.13156040206223807, 'support': 45139}, 'accuracy': 0.3528481248787476, 'macro avg': {'precision': 0.37941289052583294, 'recall': 0.36681283881665877, 'f1-score': 0.29746390513453186, 'support': 134018}, 'weighted avg': {'precision': 0.380914032565679, 'recall': 0.3528481248787476, 'f1-score': 0.29257857319693126, 'support': 134018}}
[[10711 33566  3094]
 [ 6336 33030  2142]
 [ 9825 31767  3547]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1153518
{'0': {'precision': 0.37839937839937837, 'recall': 0.2496923707957342, 'f1-score': 0.30085871378266504, 'support': 9752}, '1': {'precision': 0.32616447515043456, 'recall': 0.717841814837523, 'f1-score': 0.44853082021223606, 'support': 8155}, '2': {'precision': 0.35880875493362036, 'recall': 0.10795638562020944, 'f1-score': 0.16597510373443985, 'support': 9263}, 'accuracy': 0.3418844313581156, 'macro avg': {'precision': 0.3544575361611444, 'recall': 0.35849685708448886, 'f1-score': 0.3051215459097803, 'support': 27170}, 'weighted avg': {'precision': 0.3560422351841243, 'recall': 0.3418844313581156, 'f1-score': 0.299196555080289, 'support': 27170}}
[[2435 6143 1174]
 [1688 5854  613]
 [2312 5951 1000]]
training model: results/XRAY/W1/deepVOL_L2/h500
Epoch 1/50
524/524 - 18s - loss: 3.2968 - accuracy500: 0.3795 - val_loss: 3.2880 - val_accuracy500: 0.3796 - 18s/epoch - 35ms/step
Epoch 2/50
524/524 - 15s - loss: 3.2355 - accuracy500: 0.3996 - val_loss: 3.2985 - val_accuracy500: 0.3679 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 16s - loss: 3.2221 - accuracy500: 0.4040 - val_loss: 3.2796 - val_accuracy500: 0.3803 - 16s/epoch - 30ms/step
Epoch 4/50
524/524 - 15s - loss: 3.2113 - accuracy500: 0.4077 - val_loss: 3.2889 - val_accuracy500: 0.3577 - 15s/epoch - 30ms/step
Epoch 5/50
524/524 - 16s - loss: 3.2018 - accuracy500: 0.4101 - val_loss: 3.2845 - val_accuracy500: 0.3566 - 16s/epoch - 30ms/step
Epoch 6/50
524/524 - 16s - loss: 3.1922 - accuracy500: 0.4138 - val_loss: 3.2844 - val_accuracy500: 0.3570 - 16s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.1814 - accuracy500: 0.4175 - val_loss: 3.2842 - val_accuracy500: 0.3577 - 16s/epoch - 31ms/step
Epoch 8/50
524/524 - 16s - loss: 3.1789 - accuracy500: 0.4192 - val_loss: 3.3052 - val_accuracy500: 0.3542 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 3.1756 - accuracy500: 0.4230 - val_loss: 3.3088 - val_accuracy500: 0.3503 - 16s/epoch - 30ms/step
Epoch 10/50
524/524 - 16s - loss: 3.1696 - accuracy500: 0.4237 - val_loss: 3.3326 - val_accuracy500: 0.3457 - 16s/epoch - 31ms/step
Epoch 11/50
524/524 - 16s - loss: 3.1612 - accuracy500: 0.4260 - val_loss: 3.3315 - val_accuracy500: 0.3495 - 16s/epoch - 30ms/step
Epoch 12/50
524/524 - 16s - loss: 3.1494 - accuracy500: 0.4307 - val_loss: 3.3410 - val_accuracy500: 0.3487 - 16s/epoch - 30ms/step
Epoch 13/50
524/524 - 16s - loss: 3.1459 - accuracy500: 0.4304 - val_loss: 3.3601 - val_accuracy500: 0.3418 - 16s/epoch - 31ms/step
testing model: results/XRAY/W1/deepVOL_L2/h500
Evaluating performance on  test set...
1314/1314 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098722
{'0': {'precision': 0.3805961365367306, 'recall': 0.863180622620029, 'f1-score': 0.5282671631929845, 'support': 127365}, '1': {'precision': 0.28070672178492556, 'recall': 0.11960862378901396, 'f1-score': 0.16774248128251765, 'support': 82887}, '2': {'precision': 0.35087283858691154, 'recall': 0.03365525779086285, 'f1-score': 0.061419261404779144, 'support': 126013}, 'accuracy': 0.3690363255170773, 'macro avg': {'precision': 0.3373918989695226, 'recall': 0.33881483473330193, 'f1-score': 0.2524763019600938, 'support': 336265}, 'weighted avg': {'precision': 0.3448354838815824, 'recall': 0.3690363255170773, 'f1-score': 0.2644522732771444, 'support': 336265}}
[[109939  12459   4967]
 [ 70094   9914   2879]
 [108827  12945   4241]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0884132
{'0': {'precision': 0.35559925297180855, 'recall': 0.7829217883171978, 'f1-score': 0.48906676813938005, 'support': 45965}, '1': {'precision': 0.45747999457479993, 'recall': 0.30582315207289706, 'f1-score': 0.3665856077381842, 'support': 44117}, '2': {'precision': 0.4421052631578947, 'recall': 0.0334577567370721, 'f1-score': 0.062207739997037714, 'support': 43936}, 'accuracy': 0.38016535092301035, 'macro avg': {'precision': 0.4183948369015011, 'recall': 0.3740675657090557, 'f1-score': 0.30595337195820066, 'support': 134018}, 'weighted avg': {'precision': 0.417496914038494, 'recall': 0.38016535092301035, 'f1-score': 0.3088075521095818, 'support': 134018}}
[[35987  8755  1223]
 [29993 13492   632]
 [35221  7245  1470]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917673
{'0': {'precision': 0.3908707985902175, 'recall': 0.8640380047505938, 'f1-score': 0.538249829836347, 'support': 10525}, '1': {'precision': 0.3164959378311551, 'recall': 0.1231107447100852, 'f1-score': 0.1772677811850826, 'support': 7278}, '2': {'precision': 0.34109972041006525, 'recall': 0.039073342585673104, 'f1-score': 0.07011494252873562, 'support': 9367}, 'accuracy': 0.3811556864188443, 'macro avg': {'precision': 0.3494888189438126, 'recall': 0.34207403068211734, 'f1-score': 0.26187751785005503, 'support': 27170}, 'weighted avg': {'precision': 0.3537892407721114, 'recall': 0.3811556864188443, 'f1-score': 0.2801619814927953, 'support': 27170}}
[[9094  911  520]
 [6195  896  187]
 [7977 1024  366]]
training model: results/XRAY/W1/deepVOL_L2/h1000
Epoch 1/50
524/524 - 18s - loss: 3.3075 - accuracy1000: 0.3781 - val_loss: 3.4090 - val_accuracy1000: 0.3304 - 18s/epoch - 34ms/step
Epoch 2/50
524/524 - 15s - loss: 3.2711 - accuracy1000: 0.3823 - val_loss: 3.3734 - val_accuracy1000: 0.3225 - 15s/epoch - 29ms/step
Epoch 3/50
524/524 - 15s - loss: 3.2474 - accuracy1000: 0.3933 - val_loss: 3.3608 - val_accuracy1000: 0.3179 - 15s/epoch - 29ms/step
Epoch 4/50
524/524 - 15s - loss: 3.2345 - accuracy1000: 0.3929 - val_loss: 3.3901 - val_accuracy1000: 0.2992 - 15s/epoch - 29ms/step
Epoch 5/50
524/524 - 15s - loss: 3.2216 - accuracy1000: 0.4007 - val_loss: 3.3818 - val_accuracy1000: 0.3008 - 15s/epoch - 29ms/step
Epoch 6/50
524/524 - 15s - loss: 3.2104 - accuracy1000: 0.4042 - val_loss: 3.3936 - val_accuracy1000: 0.3127 - 15s/epoch - 30ms/step
Epoch 7/50
524/524 - 16s - loss: 3.2014 - accuracy1000: 0.4100 - val_loss: 3.4440 - val_accuracy1000: 0.3120 - 16s/epoch - 30ms/step
Epoch 8/50
524/524 - 16s - loss: 3.1948 - accuracy1000: 0.4128 - val_loss: 3.4541 - val_accuracy1000: 0.3136 - 16s/epoch - 30ms/step
Epoch 9/50
524/524 - 16s - loss: 3.1836 - accuracy1000: 0.4182 - val_loss: 3.4898 - val_accuracy1000: 0.3120 - 16s/epoch - 31ms/step
Epoch 10/50
524/524 - 16s - loss: 3.1769 - accuracy1000: 0.4205 - val_loss: 3.4919 - val_accuracy1000: 0.3292 - 16s/epoch - 30ms/step
Epoch 11/50
524/524 - 16s - loss: 3.1654 - accuracy1000: 0.4263 - val_loss: 3.4787 - val_accuracy1000: 0.3354 - 16s/epoch - 31ms/step
Epoch 12/50
524/524 - 16s - loss: 3.1670 - accuracy1000: 0.4280 - val_loss: 3.4563 - val_accuracy1000: 0.3293 - 16s/epoch - 31ms/step
Epoch 13/50
524/524 - 15s - loss: 3.1657 - accuracy1000: 0.4273 - val_loss: 3.5193 - val_accuracy1000: 0.3184 - 15s/epoch - 29ms/step
testing model: results/XRAY/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
1314/1314 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314425
{'0': {'precision': 0.3759242827565809, 'recall': 0.10673407176627674, 'f1-score': 0.16626223911152388, 'support': 119081}, '1': {'precision': 0.29763861829897165, 'recall': 0.9084512019060887, 'f1-score': 0.44837483245053245, 'support': 99051}, '2': {'precision': 0.2803030303030303, 'recall': 0.0003132063013721822, 'f1-score': 0.0006257134401555828, 'support': 118133}, 'accuracy': 0.30550310023344684, 'macro avg': {'precision': 0.31795531045286096, 'recall': 0.33849949332457924, 'f1-score': 0.20508759500073734, 'support': 336265}, 'weighted avg': {'precision': 0.3192716463945273, 'recall': 0.30550310023344684, 'f1-score': 0.1911723391685812, 'support': 336265}}
[[ 12710 106317     54]
 [  9027  89983     41]
 [ 12073 106023     37]]
Evaluating performance on  train set...
524/524 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125336
{'0': {'precision': 0.39596592578086753, 'recall': 0.0869640015483205, 'f1-score': 0.1426077757207088, 'support': 46502}, '1': {'precision': 0.3404545858549947, 'recall': 0.949777968126592, 'f1-score': 0.5012371820798934, 'support': 44363}, '2': {'precision': 0.4318181818181818, 'recall': 0.00044029383820360117, 'f1-score': 0.0008796907192629117, 'support': 43153}, 'accuracy': 0.34471488904475517, 'macro avg': {'precision': 0.3894128978180147, 'recall': 0.34572742117103866, 'f1-score': 0.21490821617328837, 'support': 134018}, 'weighted avg': {'precision': 0.3891346257439078, 'recall': 0.34471488904475517, 'f1-score': 0.21568664797850337, 'support': 134018}}
[[ 4044 42442    16]
 [ 2219 42135     9]
 [ 3950 39184    19]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1206156
{'0': {'precision': 0.4738181818181818, 'recall': 0.12375344287206762, 'f1-score': 0.1962497175992168, 'support': 10529}, '1': {'precision': 0.2981852443570521, 'recall': 0.9253750317823545, 'f1-score': 0.4510332434860736, 'support': 7866}, '2': {'precision': 0.4444444444444444, 'recall': 0.0004558404558404558, 'f1-score': 0.0009107468123861566, 'support': 8775}, 'accuracy': 0.3160103054839897, 'macro avg': {'precision': 0.4054826235398928, 'recall': 0.3498614383700875, 'f1-score': 0.2160645692992255, 'support': 27170}, 'weighted avg': {'precision': 0.41348387075731347, 'recall': 0.3160103054839897, 'f1-score': 0.2069242757873499, 'support': 27170}}
[[1303 9223    3]
 [ 585 7279    2]
 [ 862 7909    4]]
training model: results/XRAY/W1/deepVOL_L3/h10
Epoch 1/50
524/524 - 23s - loss: 3.2861 - accuracy10: 0.4046 - val_loss: 3.5473 - val_accuracy10: 0.3626 - 23s/epoch - 45ms/step
Epoch 2/50
524/524 - 21s - loss: 3.2367 - accuracy10: 0.4204 - val_loss: 3.4235 - val_accuracy10: 0.4057 - 21s/epoch - 40ms/step
Epoch 3/50
524/524 - 20s - loss: 3.1299 - accuracy10: 0.4666 - val_loss: 3.3758 - val_accuracy10: 0.4144 - 20s/epoch - 39ms/step
Epoch 4/50
524/524 - 21s - loss: 3.0754 - accuracy10: 0.4819 - val_loss: 3.3684 - val_accuracy10: 0.4246 - 21s/epoch - 40ms/step
Epoch 5/50
524/524 - 22s - loss: 3.0396 - accuracy10: 0.4964 - val_loss: 3.3313 - val_accuracy10: 0.4264 - 22s/epoch - 42ms/step
Epoch 6/50
524/524 - 21s - loss: 2.9864 - accuracy10: 0.5169 - val_loss: 3.2981 - val_accuracy10: 0.4411 - 21s/epoch - 41ms/step
Epoch 7/50
524/524 - 21s - loss: 2.8998 - accuracy10: 0.5278 - val_loss: 3.2058 - val_accuracy10: 0.4704 - 21s/epoch - 39ms/step
Epoch 8/50
524/524 - 21s - loss: 2.8200 - accuracy10: 0.5422 - val_loss: 3.1470 - val_accuracy10: 0.4824 - 21s/epoch - 40ms/step
Epoch 9/50
524/524 - 21s - loss: 2.7760 - accuracy10: 0.5545 - val_loss: 3.1351 - val_accuracy10: 0.4955 - 21s/epoch - 41ms/step
Epoch 10/50
524/524 - 22s - loss: 2.7557 - accuracy10: 0.5582 - val_loss: 3.1192 - val_accuracy10: 0.4920 - 22s/epoch - 41ms/step
Epoch 11/50
524/524 - 20s - loss: 2.7425 - accuracy10: 0.5633 - val_loss: 3.1227 - val_accuracy10: 0.4961 - 20s/epoch - 39ms/step
Epoch 12/50
524/524 - 20s - loss: 2.7308 - accuracy10: 0.5661 - val_loss: 3.1184 - val_accuracy10: 0.5013 - 20s/epoch - 39ms/step
Epoch 13/50
524/524 - 21s - loss: 2.7181 - accuracy10: 0.5692 - val_loss: 3.1260 - val_accuracy10: 0.5001 - 21s/epoch - 39ms/step
Epoch 14/50
524/524 - 21s - loss: 2.7109 - accuracy10: 0.5715 - val_loss: 3.1130 - val_accuracy10: 0.5017 - 21s/epoch - 40ms/step
Epoch 15/50
524/524 - 22s - loss: 2.7024 - accuracy10: 0.5741 - val_loss: 3.1129 - val_accuracy10: 0.5027 - 22s/epoch - 41ms/step
Epoch 16/50
524/524 - 21s - loss: 2.6965 - accuracy10: 0.5761 - val_loss: 3.1063 - val_accuracy10: 0.5015 - 21s/epoch - 40ms/step
Epoch 17/50
524/524 - 21s - loss: 2.6855 - accuracy10: 0.5783 - val_loss: 3.1028 - val_accuracy10: 0.5040 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 2.6799 - accuracy10: 0.5806 - val_loss: 3.1072 - val_accuracy10: 0.5067 - 21s/epoch - 39ms/step
Epoch 19/50
524/524 - 21s - loss: 2.6748 - accuracy10: 0.5820 - val_loss: 3.0937 - val_accuracy10: 0.5045 - 21s/epoch - 40ms/step
Epoch 20/50
524/524 - 22s - loss: 2.6680 - accuracy10: 0.5830 - val_loss: 3.1206 - val_accuracy10: 0.5026 - 22s/epoch - 42ms/step
Epoch 21/50
524/524 - 21s - loss: 2.6651 - accuracy10: 0.5843 - val_loss: 3.1317 - val_accuracy10: 0.5023 - 21s/epoch - 41ms/step
Epoch 22/50
524/524 - 21s - loss: 2.6582 - accuracy10: 0.5858 - val_loss: 3.1507 - val_accuracy10: 0.5014 - 21s/epoch - 40ms/step
Epoch 23/50
524/524 - 21s - loss: 2.6548 - accuracy10: 0.5858 - val_loss: 3.1324 - val_accuracy10: 0.5003 - 21s/epoch - 40ms/step
Epoch 24/50
524/524 - 21s - loss: 2.6513 - accuracy10: 0.5872 - val_loss: 3.1275 - val_accuracy10: 0.4960 - 21s/epoch - 40ms/step
Epoch 25/50
524/524 - 21s - loss: 2.6460 - accuracy10: 0.5882 - val_loss: 3.1193 - val_accuracy10: 0.5026 - 21s/epoch - 40ms/step
Epoch 26/50
524/524 - 21s - loss: 2.6427 - accuracy10: 0.5895 - val_loss: 3.1368 - val_accuracy10: 0.4962 - 21s/epoch - 39ms/step
Epoch 27/50
524/524 - 22s - loss: 2.6367 - accuracy10: 0.5906 - val_loss: 3.1483 - val_accuracy10: 0.4985 - 22s/epoch - 42ms/step
Epoch 28/50
524/524 - 22s - loss: 2.6336 - accuracy10: 0.5914 - val_loss: 3.1438 - val_accuracy10: 0.4994 - 22s/epoch - 42ms/step
Epoch 29/50
524/524 - 21s - loss: 2.6266 - accuracy10: 0.5939 - val_loss: 3.1260 - val_accuracy10: 0.5008 - 21s/epoch - 40ms/step
testing model: results/XRAY/W1/deepVOL_L3/h10
Evaluating performance on  test set...
1314/1314 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0195831
{'0': {'precision': 0.45911392090414205, 'recall': 0.5123297550692075, 'f1-score': 0.48426425219146835, 'support': 108153}, '1': {'precision': 0.6010083735542634, 'recall': 0.4073619315840088, 'f1-score': 0.48559131640762937, 'support': 116464}, '2': {'precision': 0.45836047337104885, 'recall': 0.5609504872456291, 'f1-score': 0.5044928207503475, 'support': 111648}, 'accuracy': 0.4921178237402049, 'macro avg': {'precision': 0.5061609226098182, 'recall': 0.49354739129961517, 'f1-score': 0.4914494631164817, 'support': 336265}, 'weighted avg': {'precision': 0.5080083185466827, 'recall': 0.4921178237402049, 'f1-score': 0.49144024264344144, 'support': 336265}}
[[55410 15200 37543]
 [32556 47443 36465]
 [32723 16296 62629]]
Evaluating performance on  train set...
524/524 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89101726
{'0': {'precision': 0.47397802532416455, 'recall': 0.5243669642355847, 'f1-score': 0.49790086764137487, 'support': 35622}, '1': {'precision': 0.7312817258883249, 'recall': 0.6290938864628821, 'f1-score': 0.676349765258216, 'support': 62288}, '2': {'precision': 0.46747105423522245, 'recall': 0.531128835715077, 'f1-score': 0.4972709475840431, 'support': 36108}, 'accuracy': 0.5748630780939874, 'macro avg': {'precision': 0.5575769351492373, 'recall': 0.5615298954711813, 'f1-score': 0.5571738601612113, 'support': 134018}, 'weighted avg': {'precision': 0.5918127877341459, 'recall': 0.5748630780939874, 'f1-score': 0.5806694493343391, 'support': 134018}}
[[18679  6798 10145]
 [11401 39185 11702]
 [ 9329  7601 19178]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99492836
{'0': {'precision': 0.48354265915980943, 'recall': 0.5143383623171714, 'f1-score': 0.49846531614487416, 'support': 8683}, '1': {'precision': 0.5995543321536243, 'recall': 0.4634714763400547, 'f1-score': 0.5228026060121157, 'support': 9869}, '2': {'precision': 0.4520135856380398, 'recall': 0.5404966349501045, 'f1-score': 0.49231094435343237, 'support': 8618}, 'accuracy': 0.504158998895841, 'macro avg': {'precision': 0.5117035256504913, 'recall': 0.5061021578691102, 'f1-score': 0.5045262888368074, 'support': 27170}, 'weighted avg': {'precision': 0.5156811076384752, 'recall': 0.504158998895841, 'f1-score': 0.5053532932372982, 'support': 27170}}
[[4466 1504 2713]
 [2361 4574 2934]
 [2409 1551 4658]]
training model: results/XRAY/W1/deepVOL_L3/h20
Epoch 1/50
524/524 - 24s - loss: 3.2520 - accuracy20: 0.4003 - val_loss: 3.4213 - val_accuracy20: 0.3311 - 24s/epoch - 45ms/step
Epoch 2/50
524/524 - 23s - loss: 3.1419 - accuracy20: 0.4371 - val_loss: 3.2955 - val_accuracy20: 0.3992 - 23s/epoch - 43ms/step
Epoch 3/50
524/524 - 22s - loss: 3.0401 - accuracy20: 0.4715 - val_loss: 3.2610 - val_accuracy20: 0.4015 - 22s/epoch - 41ms/step
Epoch 4/50
524/524 - 21s - loss: 2.9778 - accuracy20: 0.4907 - val_loss: 3.1590 - val_accuracy20: 0.4299 - 21s/epoch - 40ms/step
Epoch 5/50
524/524 - 21s - loss: 2.8933 - accuracy20: 0.5164 - val_loss: 3.0955 - val_accuracy20: 0.4581 - 21s/epoch - 41ms/step
Epoch 6/50
524/524 - 21s - loss: 2.8516 - accuracy20: 0.5313 - val_loss: 3.0785 - val_accuracy20: 0.4691 - 21s/epoch - 41ms/step
Epoch 7/50
524/524 - 21s - loss: 2.8319 - accuracy20: 0.5360 - val_loss: 3.0901 - val_accuracy20: 0.4662 - 21s/epoch - 40ms/step
Epoch 8/50
524/524 - 21s - loss: 2.8107 - accuracy20: 0.5412 - val_loss: 3.0971 - val_accuracy20: 0.4634 - 21s/epoch - 40ms/step
Epoch 9/50
524/524 - 21s - loss: 2.7989 - accuracy20: 0.5441 - val_loss: 3.1243 - val_accuracy20: 0.4577 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 2.7798 - accuracy20: 0.5482 - val_loss: 3.1156 - val_accuracy20: 0.4586 - 21s/epoch - 40ms/step
Epoch 11/50
524/524 - 21s - loss: 2.7682 - accuracy20: 0.5512 - val_loss: 3.1161 - val_accuracy20: 0.4524 - 21s/epoch - 40ms/step
Epoch 12/50
524/524 - 21s - loss: 2.7563 - accuracy20: 0.5543 - val_loss: 3.0927 - val_accuracy20: 0.4594 - 21s/epoch - 40ms/step
Epoch 13/50
524/524 - 21s - loss: 2.7471 - accuracy20: 0.5571 - val_loss: 3.0654 - val_accuracy20: 0.4702 - 21s/epoch - 41ms/step
Epoch 14/50
524/524 - 22s - loss: 2.7414 - accuracy20: 0.5575 - val_loss: 3.0772 - val_accuracy20: 0.4673 - 22s/epoch - 42ms/step
Epoch 15/50
524/524 - 22s - loss: 2.7336 - accuracy20: 0.5589 - val_loss: 3.0498 - val_accuracy20: 0.4752 - 22s/epoch - 43ms/step
Epoch 16/50
524/524 - 21s - loss: 2.7281 - accuracy20: 0.5602 - val_loss: 3.0565 - val_accuracy20: 0.4739 - 21s/epoch - 40ms/step
Epoch 17/50
524/524 - 21s - loss: 2.7209 - accuracy20: 0.5627 - val_loss: 3.0472 - val_accuracy20: 0.4752 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 2.7171 - accuracy20: 0.5638 - val_loss: 3.0575 - val_accuracy20: 0.4756 - 21s/epoch - 40ms/step
Epoch 19/50
524/524 - 21s - loss: 2.7126 - accuracy20: 0.5641 - val_loss: 3.0536 - val_accuracy20: 0.4743 - 21s/epoch - 39ms/step
Epoch 20/50
524/524 - 21s - loss: 2.7099 - accuracy20: 0.5648 - val_loss: 3.0752 - val_accuracy20: 0.4699 - 21s/epoch - 40ms/step
Epoch 21/50
524/524 - 21s - loss: 2.7025 - accuracy20: 0.5661 - val_loss: 3.0587 - val_accuracy20: 0.4756 - 21s/epoch - 40ms/step
Epoch 22/50
524/524 - 21s - loss: 2.6969 - accuracy20: 0.5672 - val_loss: 3.0692 - val_accuracy20: 0.4718 - 21s/epoch - 41ms/step
Epoch 23/50
524/524 - 22s - loss: 2.6915 - accuracy20: 0.5687 - val_loss: 3.0772 - val_accuracy20: 0.4706 - 22s/epoch - 42ms/step
Epoch 24/50
524/524 - 21s - loss: 2.6881 - accuracy20: 0.5697 - val_loss: 3.0935 - val_accuracy20: 0.4652 - 21s/epoch - 39ms/step
Epoch 25/50
524/524 - 20s - loss: 2.6848 - accuracy20: 0.5695 - val_loss: 3.0970 - val_accuracy20: 0.4647 - 20s/epoch - 39ms/step
Epoch 26/50
524/524 - 20s - loss: 2.6803 - accuracy20: 0.5726 - val_loss: 3.0968 - val_accuracy20: 0.4665 - 20s/epoch - 39ms/step
Epoch 27/50
524/524 - 20s - loss: 2.6757 - accuracy20: 0.5732 - val_loss: 3.0884 - val_accuracy20: 0.4671 - 20s/epoch - 39ms/step
testing model: results/XRAY/W1/deepVOL_L3/h20
Evaluating performance on  test set...
1314/1314 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0202854
{'0': {'precision': 0.4973278843131091, 'recall': 0.4823133027415358, 'f1-score': 0.48970553218509405, 'support': 127921}, '1': {'precision': 0.39702211323922504, 'recall': 0.47032345859939284, 'f1-score': 0.4305753542807173, 'support': 76424}, '2': {'precision': 0.5051285423104741, 'recall': 0.46588841722255914, 'f1-score': 0.48471560617054166, 'support': 131920}, 'accuracy': 0.47314469243007745, 'macro avg': {'precision': 0.4664928466209361, 'recall': 0.47284172618782927, 'f1-score': 0.4683321642121177, 'support': 336265}, 'weighted avg': {'precision': 0.47759135078884063, 'recall': 0.47314469243007745, 'f1-score': 0.4743092353477668, 'support': 336265}}
[[61698 25366 40857]
 [21125 35944 19355]
 [41236 29224 61460]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9299718
{'0': {'precision': 0.5253404427716354, 'recall': 0.4687594747766868, 'f1-score': 0.4954397554722934, 'support': 42877}, '1': {'precision': 0.5806097560975609, 'recall': 0.7026269185360094, 'f1-score': 0.6358173076923077, 'support': 47432}, '2': {'precision': 0.5194348132120232, 'recall': 0.4558557734105104, 'f1-score': 0.4855729395135741, 'support': 43709}, 'accuracy': 0.5473220015221836, 'macro avg': {'precision': 0.5417950040270731, 'recall': 0.5424140555744023, 'f1-score': 0.5389433342260584, 'support': 134018}, 'weighted avg': {'precision': 0.5429754239477029, 'recall': 0.5473220015221836, 'f1-score': 0.5419045542169401, 'support': 134018}}
[[20099 11273 11505]
 [ 7176 33327  6929]
 [10984 12800 19925]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0067154
{'0': {'precision': 0.5155807365439093, 'recall': 0.45861601085481685, 'f1-score': 0.48543290931473126, 'support': 10318}, '1': {'precision': 0.4111572700296736, 'recall': 0.5320227307633236, 'f1-score': 0.46384574183181576, 'support': 6511}, '2': {'precision': 0.49932058116441935, 'recall': 0.461947587273958, 'f1-score': 0.4799075748442837, 'support': 10341}, 'accuracy': 0.47747515642252486, 'macro avg': {'precision': 0.4753528625793341, 'recall': 0.4841954429640329, 'f1-score': 0.4763954086636102, 'support': 27170}, 'weighted avg': {'precision': 0.48436809549667, 'recall': 0.47747515642252486, 'f1-score': 0.47815681320725384, 'support': 27170}}
[[4732 2369 3217]
 [1474 3464 1573]
 [2972 2592 4777]]
training model: results/XRAY/W1/deepVOL_L3/h30
Epoch 1/50
524/524 - 25s - loss: 3.2570 - accuracy30: 0.3883 - val_loss: 3.4423 - val_accuracy30: 0.2524 - 25s/epoch - 47ms/step
Epoch 2/50
524/524 - 21s - loss: 3.2072 - accuracy30: 0.4076 - val_loss: 3.2719 - val_accuracy30: 0.3763 - 21s/epoch - 40ms/step
Epoch 3/50
524/524 - 21s - loss: 3.1240 - accuracy30: 0.4360 - val_loss: 3.2453 - val_accuracy30: 0.3865 - 21s/epoch - 40ms/step
Epoch 4/50
524/524 - 21s - loss: 3.0899 - accuracy30: 0.4494 - val_loss: 3.2478 - val_accuracy30: 0.3883 - 21s/epoch - 39ms/step
Epoch 5/50
524/524 - 21s - loss: 3.0628 - accuracy30: 0.4577 - val_loss: 3.2162 - val_accuracy30: 0.4039 - 21s/epoch - 40ms/step
Epoch 6/50
524/524 - 22s - loss: 3.0044 - accuracy30: 0.4788 - val_loss: 3.1754 - val_accuracy30: 0.4255 - 22s/epoch - 43ms/step
Epoch 7/50
524/524 - 21s - loss: 2.9667 - accuracy30: 0.4936 - val_loss: 3.1489 - val_accuracy30: 0.4310 - 21s/epoch - 41ms/step
Epoch 8/50
524/524 - 21s - loss: 2.9405 - accuracy30: 0.5020 - val_loss: 3.0958 - val_accuracy30: 0.4382 - 21s/epoch - 39ms/step
Epoch 9/50
524/524 - 21s - loss: 2.9164 - accuracy30: 0.5087 - val_loss: 3.1005 - val_accuracy30: 0.4415 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 2.8997 - accuracy30: 0.5121 - val_loss: 3.0789 - val_accuracy30: 0.4423 - 21s/epoch - 41ms/step
Epoch 11/50
524/524 - 21s - loss: 2.8835 - accuracy30: 0.5163 - val_loss: 3.0814 - val_accuracy30: 0.4421 - 21s/epoch - 41ms/step
Epoch 12/50
524/524 - 21s - loss: 2.8711 - accuracy30: 0.5206 - val_loss: 3.0657 - val_accuracy30: 0.4517 - 21s/epoch - 40ms/step
Epoch 13/50
524/524 - 21s - loss: 2.8613 - accuracy30: 0.5235 - val_loss: 3.0697 - val_accuracy30: 0.4525 - 21s/epoch - 40ms/step
Epoch 14/50
524/524 - 21s - loss: 2.8551 - accuracy30: 0.5259 - val_loss: 3.0689 - val_accuracy30: 0.4500 - 21s/epoch - 40ms/step
Epoch 15/50
524/524 - 21s - loss: 2.8464 - accuracy30: 0.5299 - val_loss: 3.0615 - val_accuracy30: 0.4535 - 21s/epoch - 39ms/step
Epoch 16/50
524/524 - 21s - loss: 2.8428 - accuracy30: 0.5308 - val_loss: 3.0648 - val_accuracy30: 0.4513 - 21s/epoch - 39ms/step
Epoch 17/50
524/524 - 22s - loss: 2.8383 - accuracy30: 0.5332 - val_loss: 3.0556 - val_accuracy30: 0.4555 - 22s/epoch - 41ms/step
Epoch 18/50
524/524 - 22s - loss: 2.8325 - accuracy30: 0.5336 - val_loss: 3.0598 - val_accuracy30: 0.4617 - 22s/epoch - 42ms/step
Epoch 19/50
524/524 - 21s - loss: 2.8263 - accuracy30: 0.5349 - val_loss: 3.0715 - val_accuracy30: 0.4529 - 21s/epoch - 40ms/step
Epoch 20/50
524/524 - 21s - loss: 2.8219 - accuracy30: 0.5367 - val_loss: 3.0605 - val_accuracy30: 0.4607 - 21s/epoch - 40ms/step
Epoch 21/50
524/524 - 21s - loss: 2.8167 - accuracy30: 0.5377 - val_loss: 3.0648 - val_accuracy30: 0.4552 - 21s/epoch - 39ms/step
Epoch 22/50
524/524 - 22s - loss: 2.8123 - accuracy30: 0.5388 - val_loss: 3.0463 - val_accuracy30: 0.4638 - 22s/epoch - 41ms/step
Epoch 23/50
524/524 - 21s - loss: 2.8100 - accuracy30: 0.5393 - val_loss: 3.0806 - val_accuracy30: 0.4556 - 21s/epoch - 40ms/step
Epoch 24/50
524/524 - 21s - loss: 2.8027 - accuracy30: 0.5420 - val_loss: 3.0544 - val_accuracy30: 0.4624 - 21s/epoch - 39ms/step
Epoch 25/50
524/524 - 21s - loss: 2.8007 - accuracy30: 0.5417 - val_loss: 3.0542 - val_accuracy30: 0.4636 - 21s/epoch - 40ms/step
Epoch 26/50
524/524 - 21s - loss: 2.7955 - accuracy30: 0.5426 - val_loss: 3.0492 - val_accuracy30: 0.4664 - 21s/epoch - 40ms/step
Epoch 27/50
524/524 - 21s - loss: 2.7922 - accuracy30: 0.5444 - val_loss: 3.0609 - val_accuracy30: 0.4659 - 21s/epoch - 39ms/step
Epoch 28/50
524/524 - 22s - loss: 2.7881 - accuracy30: 0.5447 - val_loss: 3.0501 - val_accuracy30: 0.4680 - 22s/epoch - 42ms/step
Epoch 29/50
524/524 - 21s - loss: 2.7838 - accuracy30: 0.5468 - val_loss: 3.0507 - val_accuracy30: 0.4649 - 21s/epoch - 41ms/step
Epoch 30/50
524/524 - 20s - loss: 2.7796 - accuracy30: 0.5481 - val_loss: 3.0627 - val_accuracy30: 0.4673 - 20s/epoch - 39ms/step
Epoch 31/50
524/524 - 20s - loss: 2.7770 - accuracy30: 0.5492 - val_loss: 3.0499 - val_accuracy30: 0.4710 - 20s/epoch - 39ms/step
Epoch 32/50
524/524 - 21s - loss: 2.7707 - accuracy30: 0.5504 - val_loss: 3.0451 - val_accuracy30: 0.4681 - 21s/epoch - 40ms/step
Epoch 33/50
524/524 - 22s - loss: 2.7693 - accuracy30: 0.5505 - val_loss: 3.0416 - val_accuracy30: 0.4733 - 22s/epoch - 41ms/step
Epoch 34/50
524/524 - 21s - loss: 2.7670 - accuracy30: 0.5516 - val_loss: 3.0479 - val_accuracy30: 0.4710 - 21s/epoch - 41ms/step
Epoch 35/50
524/524 - 21s - loss: 2.7652 - accuracy30: 0.5526 - val_loss: 3.0426 - val_accuracy30: 0.4710 - 21s/epoch - 40ms/step
Epoch 36/50
524/524 - 21s - loss: 2.7627 - accuracy30: 0.5529 - val_loss: 3.0486 - val_accuracy30: 0.4715 - 21s/epoch - 40ms/step
Epoch 37/50
524/524 - 21s - loss: 2.7604 - accuracy30: 0.5526 - val_loss: 3.0400 - val_accuracy30: 0.4741 - 21s/epoch - 40ms/step
Epoch 38/50
524/524 - 21s - loss: 2.7522 - accuracy30: 0.5542 - val_loss: 3.0602 - val_accuracy30: 0.4694 - 21s/epoch - 41ms/step
Epoch 39/50
524/524 - 22s - loss: 2.7491 - accuracy30: 0.5559 - val_loss: 3.0576 - val_accuracy30: 0.4710 - 22s/epoch - 41ms/step
Epoch 40/50
524/524 - 21s - loss: 2.7420 - accuracy30: 0.5574 - val_loss: 3.0654 - val_accuracy30: 0.4675 - 21s/epoch - 40ms/step
Epoch 41/50
524/524 - 21s - loss: 2.7386 - accuracy30: 0.5584 - val_loss: 3.0628 - val_accuracy30: 0.4722 - 21s/epoch - 41ms/step
Epoch 42/50
524/524 - 22s - loss: 2.7345 - accuracy30: 0.5601 - val_loss: 3.0614 - val_accuracy30: 0.4690 - 22s/epoch - 43ms/step
Epoch 43/50
524/524 - 21s - loss: 2.7296 - accuracy30: 0.5617 - val_loss: 3.0633 - val_accuracy30: 0.4699 - 21s/epoch - 41ms/step
Epoch 44/50
524/524 - 22s - loss: 2.7265 - accuracy30: 0.5626 - val_loss: 3.0711 - val_accuracy30: 0.4699 - 22s/epoch - 41ms/step
Epoch 45/50
524/524 - 21s - loss: 2.7211 - accuracy30: 0.5640 - val_loss: 3.0823 - val_accuracy30: 0.4658 - 21s/epoch - 39ms/step
Epoch 46/50
524/524 - 20s - loss: 2.7133 - accuracy30: 0.5657 - val_loss: 3.0875 - val_accuracy30: 0.4647 - 20s/epoch - 39ms/step
Epoch 47/50
524/524 - 21s - loss: 2.7079 - accuracy30: 0.5668 - val_loss: 3.1021 - val_accuracy30: 0.4649 - 21s/epoch - 39ms/step
testing model: results/XRAY/W1/deepVOL_L3/h30
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0305727
{'0': {'precision': 0.48599126623455247, 'recall': 0.4571463281297455, 'f1-score': 0.4711277001146363, 'support': 131704}, '1': {'precision': 0.3836720392431675, 'recall': 0.3448720151176774, 'f1-score': 0.3632388419782871, 'support': 69852}, '2': {'precision': 0.48340129687813355, 'recall': 0.5368015500077946, 'f1-score': 0.5087038645932628, 'support': 134709}, 'accuracy': 0.46573387060800264, 'macro avg': {'precision': 0.45102153411861784, 'recall': 0.44627329775173913, 'f1-score': 0.447690135562062, 'support': 336265}, 'weighted avg': {'precision': 0.4636990418703276, 'recall': 0.46573387060800264, 'f1-score': 0.4637692031619681, 'support': 336265}}
[[60208 19519 51977]
 [20461 24090 25301]
 [43218 19179 72312]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9529775
{'0': {'precision': 0.5196080881801595, 'recall': 0.46366758854491924, 'f1-score': 0.49004655548352877, 'support': 44836}, '1': {'precision': 0.5666760756482117, 'recall': 0.6408701203940168, 'f1-score': 0.6014937830376442, 'support': 43856}, '2': {'precision': 0.5033437661840535, 'recall': 0.4931827207342364, 'f1-score': 0.49821144009717283, 'support': 45326}, 'accuracy': 0.5316375412258055, 'macro avg': {'precision': 0.5298759766708082, 'recall': 0.5325734765577241, 'f1-score': 0.5299172595394487, 'support': 134018}, 'weighted avg': {'precision': 0.5295098700273994, 'recall': 0.5316375412258055, 'f1-score': 0.529277936130989, 'support': 134018}}
[[20789 10480 13567]
 [ 7260 28106  8490]
 [11960 11012 22354]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0155272
{'0': {'precision': 0.5029964448958862, 'recall': 0.46637784893576945, 'f1-score': 0.48399550408053565, 'support': 10618}, '1': {'precision': 0.3900219113433339, 'recall': 0.3957585086369078, 'f1-score': 0.3928692699490662, 'support': 5847}, '2': {'precision': 0.49280196629213485, 'recall': 0.5244278374591312, 'f1-score': 0.5081232746526677, 'support': 10705}, 'accuracy': 0.47405226352594776, 'macro avg': {'precision': 0.46194010751045167, 'recall': 0.4621880650106028, 'f1-score': 0.4616626828940899, 'support': 27170}, 'weighted avg': {'precision': 0.47466762667229656, 'recall': 0.47405226352594776, 'f1-score': 0.473891444198606, 'support': 27170}}
[[4952 1885 3781]
 [1536 2314 1997]
 [3357 1734 5614]]
training model: results/XRAY/W1/deepVOL_L3/h50
Epoch 1/50
524/524 - 23s - loss: 3.3027 - accuracy50: 0.3754 - val_loss: 3.3331 - val_accuracy50: 0.3105 - 23s/epoch - 44ms/step
Epoch 2/50
524/524 - 22s - loss: 3.2613 - accuracy50: 0.3870 - val_loss: 3.2821 - val_accuracy50: 0.3698 - 22s/epoch - 42ms/step
Epoch 3/50
524/524 - 22s - loss: 3.1877 - accuracy50: 0.4204 - val_loss: 3.3102 - val_accuracy50: 0.3607 - 22s/epoch - 42ms/step
Epoch 4/50
524/524 - 22s - loss: 3.1363 - accuracy50: 0.4411 - val_loss: 3.2544 - val_accuracy50: 0.3975 - 22s/epoch - 42ms/step
Epoch 5/50
524/524 - 22s - loss: 3.1115 - accuracy50: 0.4527 - val_loss: 3.2518 - val_accuracy50: 0.3984 - 22s/epoch - 42ms/step
Epoch 6/50
524/524 - 22s - loss: 3.0934 - accuracy50: 0.4610 - val_loss: 3.2358 - val_accuracy50: 0.4096 - 22s/epoch - 42ms/step
Epoch 7/50
524/524 - 22s - loss: 3.0840 - accuracy50: 0.4653 - val_loss: 3.2419 - val_accuracy50: 0.4125 - 22s/epoch - 42ms/step
Epoch 8/50
524/524 - 22s - loss: 3.0690 - accuracy50: 0.4703 - val_loss: 3.2603 - val_accuracy50: 0.4062 - 22s/epoch - 42ms/step
Epoch 9/50
524/524 - 22s - loss: 3.0610 - accuracy50: 0.4731 - val_loss: 3.2262 - val_accuracy50: 0.4152 - 22s/epoch - 42ms/step
Epoch 10/50
524/524 - 22s - loss: 3.0515 - accuracy50: 0.4757 - val_loss: 3.2483 - val_accuracy50: 0.4100 - 22s/epoch - 41ms/step
Epoch 11/50
524/524 - 22s - loss: 3.0421 - accuracy50: 0.4795 - val_loss: 3.2432 - val_accuracy50: 0.4133 - 22s/epoch - 42ms/step
Epoch 12/50
524/524 - 22s - loss: 3.0365 - accuracy50: 0.4804 - val_loss: 3.2397 - val_accuracy50: 0.4089 - 22s/epoch - 42ms/step
Epoch 13/50
524/524 - 23s - loss: 3.0262 - accuracy50: 0.4850 - val_loss: 3.2410 - val_accuracy50: 0.4128 - 23s/epoch - 43ms/step
Epoch 14/50
524/524 - 23s - loss: 3.0217 - accuracy50: 0.4856 - val_loss: 3.2192 - val_accuracy50: 0.4151 - 23s/epoch - 44ms/step
Epoch 15/50
524/524 - 23s - loss: 3.0148 - accuracy50: 0.4887 - val_loss: 3.2186 - val_accuracy50: 0.4188 - 23s/epoch - 43ms/step
Epoch 16/50
524/524 - 22s - loss: 3.0085 - accuracy50: 0.4894 - val_loss: 3.2146 - val_accuracy50: 0.4220 - 22s/epoch - 42ms/step
Epoch 17/50
524/524 - 22s - loss: 3.0025 - accuracy50: 0.4918 - val_loss: 3.2038 - val_accuracy50: 0.4254 - 22s/epoch - 42ms/step
Epoch 18/50
524/524 - 22s - loss: 2.9971 - accuracy50: 0.4946 - val_loss: 3.2052 - val_accuracy50: 0.4265 - 22s/epoch - 42ms/step
Epoch 19/50
524/524 - 22s - loss: 2.9908 - accuracy50: 0.4966 - val_loss: 3.2124 - val_accuracy50: 0.4214 - 22s/epoch - 42ms/step
Epoch 20/50
524/524 - 22s - loss: 2.9862 - accuracy50: 0.4971 - val_loss: 3.2046 - val_accuracy50: 0.4245 - 22s/epoch - 42ms/step
Epoch 21/50
524/524 - 22s - loss: 2.9819 - accuracy50: 0.4991 - val_loss: 3.2037 - val_accuracy50: 0.4261 - 22s/epoch - 42ms/step
Epoch 22/50
524/524 - 22s - loss: 2.9747 - accuracy50: 0.5020 - val_loss: 3.2060 - val_accuracy50: 0.4254 - 22s/epoch - 41ms/step
Epoch 23/50
524/524 - 22s - loss: 2.9685 - accuracy50: 0.5042 - val_loss: 3.2012 - val_accuracy50: 0.4260 - 22s/epoch - 42ms/step
Epoch 24/50
524/524 - 22s - loss: 2.9643 - accuracy50: 0.5047 - val_loss: 3.2026 - val_accuracy50: 0.4280 - 22s/epoch - 42ms/step
Epoch 25/50
524/524 - 22s - loss: 2.9581 - accuracy50: 0.5069 - val_loss: 3.2093 - val_accuracy50: 0.4241 - 22s/epoch - 42ms/step
Epoch 26/50
524/524 - 22s - loss: 2.9525 - accuracy50: 0.5082 - val_loss: 3.2109 - val_accuracy50: 0.4264 - 22s/epoch - 42ms/step
Epoch 27/50
524/524 - 22s - loss: 2.9478 - accuracy50: 0.5084 - val_loss: 3.2078 - val_accuracy50: 0.4253 - 22s/epoch - 42ms/step
Epoch 28/50
524/524 - 22s - loss: 2.9435 - accuracy50: 0.5090 - val_loss: 3.2113 - val_accuracy50: 0.4245 - 22s/epoch - 42ms/step
Epoch 29/50
524/524 - 22s - loss: 2.9382 - accuracy50: 0.5129 - val_loss: 3.2245 - val_accuracy50: 0.4267 - 22s/epoch - 42ms/step
Epoch 30/50
524/524 - 22s - loss: 2.9311 - accuracy50: 0.5136 - val_loss: 3.2192 - val_accuracy50: 0.4275 - 22s/epoch - 42ms/step
Epoch 31/50
524/524 - 22s - loss: 2.9244 - accuracy50: 0.5153 - val_loss: 3.2351 - val_accuracy50: 0.4216 - 22s/epoch - 42ms/step
Epoch 32/50
524/524 - 22s - loss: 2.9186 - accuracy50: 0.5181 - val_loss: 3.2293 - val_accuracy50: 0.4257 - 22s/epoch - 42ms/step
Epoch 33/50
524/524 - 23s - loss: 2.9164 - accuracy50: 0.5173 - val_loss: 3.2317 - val_accuracy50: 0.4305 - 23s/epoch - 44ms/step
testing model: results/XRAY/W1/deepVOL_L3/h50
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831922
{'0': {'precision': 0.42021046753574826, 'recall': 0.5053564861450888, 'f1-score': 0.45886704245596327, 'support': 125082}, '1': {'precision': 0.35272128835076993, 'recall': 0.17644983358227387, 'f1-score': 0.23522679167777236, 'support': 85027}, '2': {'precision': 0.4320914426076216, 'recall': 0.4908208884238562, 'f1-score': 0.45958754393061657, 'support': 126156}, 'accuracy': 0.41673679984536005, 'macro avg': {'precision': 0.40167439949804656, 'recall': 0.39087573605040626, 'f1-score': 0.38456045935478406, 'support': 336265}, 'weighted avg': {'precision': 0.4076027142834208, 'recall': 0.41673679984536005, 'f1-score': 0.4025883217479476, 'support': 336265}}
[[63211 14200 47671]
 [36312 15003 33712]
 [50904 13332 61920]]
Evaluating performance on  train set...
524/524 - 13s - 13s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0177252
{'0': {'precision': 0.4609641856374384, 'recall': 0.4997006718254584, 'f1-score': 0.4795514511873351, 'support': 45101}, '1': {'precision': 0.5199198067136175, 'recall': 0.458051221666176, 'f1-score': 0.48702854322414435, 'support': 44161}, '2': {'precision': 0.4624304969602562, 'recall': 0.4775672535525963, 'f1-score': 0.46987700187959597, 'support': 44756}, 'accuracy': 0.4785849661985703, 'macro avg': {'precision': 0.4811048297704374, 'recall': 0.47843971568141025, 'f1-score': 0.47881899876369177, 'support': 134018}, 'weighted avg': {'precision': 0.48088065515578055, 'recall': 0.4785849661985703, 'f1-score': 0.4787844363700745, 'support': 134018}}
[[22537  9476 13088]
 [12174 20228 11759]
 [14180  9202 21374]]
Evaluating performance on  val set...
107/107 - 3s - 3s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.066761
{'0': {'precision': 0.4347522069749148, 'recall': 0.4898562142997833, 'f1-score': 0.4606621903218338, 'support': 10154}, '1': {'precision': 0.34641126240480036, 'recall': 0.21931618936294564, 'f1-score': 0.26858727744475264, 'support': 6844}, '2': {'precision': 0.4412951912951913, 'recall': 0.49439638222571763, 'f1-score': 0.46633902077151335, 'support': 10172}, 'accuracy': 0.4234081707765918, 'macro avg': {'precision': 0.4074862202249688, 'recall': 0.40118959529614884, 'f1-score': 0.39852949617936656, 'support': 27170}, 'weighted avg': {'precision': 0.41494910840546284, 'recall': 0.4234081707765918, 'f1-score': 0.414404701017579, 'support': 27170}}
[[4974 1470 3710]
 [2686 1501 2657]
 [3781 1362 5029]]
training model: results/XRAY/W1/deepVOL_L3/h100
Epoch 1/50
524/524 - 24s - loss: 3.3040 - accuracy100: 0.3705 - val_loss: 3.3056 - val_accuracy100: 0.3488 - 24s/epoch - 46ms/step
Epoch 2/50
524/524 - 22s - loss: 3.2870 - accuracy100: 0.3631 - val_loss: 3.2823 - val_accuracy100: 0.3686 - 22s/epoch - 41ms/step
Epoch 3/50
524/524 - 22s - loss: 3.2754 - accuracy100: 0.3691 - val_loss: 3.2700 - val_accuracy100: 0.3728 - 22s/epoch - 41ms/step
Epoch 4/50
524/524 - 22s - loss: 3.2601 - accuracy100: 0.3812 - val_loss: 3.2663 - val_accuracy100: 0.3773 - 22s/epoch - 41ms/step
Epoch 5/50
524/524 - 21s - loss: 3.2372 - accuracy100: 0.3982 - val_loss: 3.2525 - val_accuracy100: 0.3826 - 21s/epoch - 41ms/step
Epoch 6/50
524/524 - 21s - loss: 3.2181 - accuracy100: 0.4084 - val_loss: 3.2602 - val_accuracy100: 0.3859 - 21s/epoch - 40ms/step
Epoch 7/50
524/524 - 21s - loss: 3.2088 - accuracy100: 0.4138 - val_loss: 3.2632 - val_accuracy100: 0.3859 - 21s/epoch - 40ms/step
Epoch 8/50
524/524 - 21s - loss: 3.2006 - accuracy100: 0.4148 - val_loss: 3.2491 - val_accuracy100: 0.3926 - 21s/epoch - 40ms/step
Epoch 9/50
524/524 - 21s - loss: 3.1906 - accuracy100: 0.4202 - val_loss: 3.2596 - val_accuracy100: 0.3889 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 3.1830 - accuracy100: 0.4226 - val_loss: 3.2630 - val_accuracy100: 0.3891 - 21s/epoch - 40ms/step
Epoch 11/50
524/524 - 21s - loss: 3.1770 - accuracy100: 0.4246 - val_loss: 3.2534 - val_accuracy100: 0.3940 - 21s/epoch - 40ms/step
Epoch 12/50
524/524 - 21s - loss: 3.1740 - accuracy100: 0.4263 - val_loss: 3.2418 - val_accuracy100: 0.3978 - 21s/epoch - 40ms/step
Epoch 13/50
524/524 - 21s - loss: 3.1671 - accuracy100: 0.4297 - val_loss: 3.2508 - val_accuracy100: 0.3940 - 21s/epoch - 40ms/step
Epoch 14/50
524/524 - 21s - loss: 3.1627 - accuracy100: 0.4312 - val_loss: 3.2708 - val_accuracy100: 0.3881 - 21s/epoch - 40ms/step
Epoch 15/50
524/524 - 21s - loss: 3.1545 - accuracy100: 0.4360 - val_loss: 3.2771 - val_accuracy100: 0.3869 - 21s/epoch - 41ms/step
Epoch 16/50
524/524 - 21s - loss: 3.1505 - accuracy100: 0.4379 - val_loss: 3.2801 - val_accuracy100: 0.3842 - 21s/epoch - 39ms/step
Epoch 17/50
524/524 - 21s - loss: 3.1402 - accuracy100: 0.4412 - val_loss: 3.2825 - val_accuracy100: 0.3845 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 3.1360 - accuracy100: 0.4433 - val_loss: 3.2948 - val_accuracy100: 0.3809 - 21s/epoch - 41ms/step
Epoch 19/50
524/524 - 21s - loss: 3.1272 - accuracy100: 0.4457 - val_loss: 3.2823 - val_accuracy100: 0.3895 - 21s/epoch - 40ms/step
Epoch 20/50
524/524 - 21s - loss: 3.1262 - accuracy100: 0.4464 - val_loss: 3.2973 - val_accuracy100: 0.3893 - 21s/epoch - 40ms/step
Epoch 21/50
524/524 - 21s - loss: 3.1240 - accuracy100: 0.4478 - val_loss: 3.2889 - val_accuracy100: 0.3873 - 21s/epoch - 39ms/step
Epoch 22/50
524/524 - 21s - loss: 3.1174 - accuracy100: 0.4492 - val_loss: 3.3173 - val_accuracy100: 0.3828 - 21s/epoch - 39ms/step
testing model: results/XRAY/W1/deepVOL_L3/h100
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097285
{'0': {'precision': 0.3781449928730069, 'recall': 0.5567531073078675, 'f1-score': 0.45038790806019646, 'support': 122936}, '1': {'precision': 0.33686957118824457, 'recall': 0.10545548342719574, 'f1-score': 0.16062731744849434, 'support': 93044}, '2': {'precision': 0.37395351049660686, 'recall': 0.3921436588103255, 'f1-score': 0.38283263195912687, 'support': 120285}, 'accuracy': 0.37299748710094716, 'macro avg': {'precision': 0.36298935818595285, 'recall': 0.3514507498484629, 'f1-score': 0.3312826191559392, 'support': 336265}, 'weighted avg': {'precision': 0.3652248174373169, 'recall': 0.37299748710094716, 'f1-score': 0.34604647859625476, 'support': 336265}}
[[68445 10159 44332]
 [48597  9812 34635]
 [63960  9156 47169]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0740014
{'0': {'precision': 0.3964853502569141, 'recall': 0.5476450041159588, 'f1-score': 0.459964495935719, 'support': 44947}, '1': {'precision': 0.46857171454308877, 'recall': 0.2086787911206205, 'f1-score': 0.2887586738627602, 'support': 44868}, '2': {'precision': 0.3689103612880873, 'recall': 0.4335904802841436, 'f1-score': 0.39864387037730353, 'support': 44203}, 'accuracy': 0.39654374785476576, 'macro avg': {'precision': 0.4113224753626967, 'recall': 0.396638091840241, 'f1-score': 0.38245568005859426, 'support': 134018}, 'weighted avg': {'precision': 0.4115241790366529, 'recall': 0.39654374785476576, 'f1-score': 0.38242104329258036, 'support': 134018}}
[[24615  5479 14853]
 [17571  9363 17934]
 [19897  5140 19166]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0796304
{'0': {'precision': 0.40372317749040787, 'recall': 0.5647549945333465, 'f1-score': 0.4708514605344935, 'support': 10061}, '1': {'precision': 0.36955602536997884, 'recall': 0.11951319567892793, 'f1-score': 0.18061582971688364, 'support': 7313}, '2': {'precision': 0.400335476656416, 'recall': 0.4385463454471213, 'f1-score': 0.4185706630291811, 'support': 9796}, 'accuracy': 0.39941111520058886, 'macro avg': {'precision': 0.3912048931722676, 'recall': 0.37427151188646524, 'f1-score': 0.3566793177601861, 'support': 27170}, 'weighted avg': {'precision': 0.3933054262638167, 'recall': 0.39941111520058886, 'f1-score': 0.37388289739385233, 'support': 27170}}
[[5682  809 3570]
 [3574  874 2865]
 [4818  682 4296]]
training model: results/XRAY/W1/deepVOL_L3/h200
Epoch 1/50
524/524 - 24s - loss: 3.3133 - accuracy200: 0.3632 - val_loss: 3.4376 - val_accuracy200: 0.3478 - 24s/epoch - 45ms/step
Epoch 2/50
524/524 - 22s - loss: 3.2897 - accuracy200: 0.3622 - val_loss: 3.4171 - val_accuracy200: 0.3481 - 22s/epoch - 42ms/step
Epoch 3/50
524/524 - 22s - loss: 3.2755 - accuracy200: 0.3732 - val_loss: 3.4003 - val_accuracy200: 0.3503 - 22s/epoch - 41ms/step
Epoch 4/50
524/524 - 21s - loss: 3.2655 - accuracy200: 0.3761 - val_loss: 3.3934 - val_accuracy200: 0.3512 - 21s/epoch - 40ms/step
Epoch 5/50
524/524 - 21s - loss: 3.2584 - accuracy200: 0.3813 - val_loss: 3.3561 - val_accuracy200: 0.3546 - 21s/epoch - 39ms/step
Epoch 6/50
524/524 - 22s - loss: 3.2524 - accuracy200: 0.3854 - val_loss: 3.3648 - val_accuracy200: 0.3509 - 22s/epoch - 42ms/step
Epoch 7/50
524/524 - 22s - loss: 3.2475 - accuracy200: 0.3891 - val_loss: 3.3472 - val_accuracy200: 0.3582 - 22s/epoch - 42ms/step
Epoch 8/50
524/524 - 21s - loss: 3.2460 - accuracy200: 0.3899 - val_loss: 3.3247 - val_accuracy200: 0.3664 - 21s/epoch - 40ms/step
Epoch 9/50
524/524 - 21s - loss: 3.2442 - accuracy200: 0.3928 - val_loss: 3.3399 - val_accuracy200: 0.3650 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 3.2349 - accuracy200: 0.3962 - val_loss: 3.3437 - val_accuracy200: 0.3678 - 21s/epoch - 40ms/step
Epoch 11/50
524/524 - 20s - loss: 3.2304 - accuracy200: 0.3999 - val_loss: 3.3572 - val_accuracy200: 0.3681 - 20s/epoch - 39ms/step
Epoch 12/50
524/524 - 21s - loss: 3.2300 - accuracy200: 0.3978 - val_loss: 3.3065 - val_accuracy200: 0.3817 - 21s/epoch - 41ms/step
Epoch 13/50
524/524 - 23s - loss: 3.2234 - accuracy200: 0.4049 - val_loss: 3.3204 - val_accuracy200: 0.3833 - 23s/epoch - 43ms/step
Epoch 14/50
524/524 - 22s - loss: 3.2148 - accuracy200: 0.4084 - val_loss: 3.3203 - val_accuracy200: 0.3783 - 22s/epoch - 42ms/step
Epoch 15/50
524/524 - 21s - loss: 3.2086 - accuracy200: 0.4116 - val_loss: 3.3576 - val_accuracy200: 0.3778 - 21s/epoch - 40ms/step
Epoch 16/50
524/524 - 21s - loss: 3.2071 - accuracy200: 0.4116 - val_loss: 3.3572 - val_accuracy200: 0.3690 - 21s/epoch - 40ms/step
Epoch 17/50
524/524 - 21s - loss: 3.2005 - accuracy200: 0.4180 - val_loss: 3.3529 - val_accuracy200: 0.3727 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 3.1940 - accuracy200: 0.4216 - val_loss: 3.3169 - val_accuracy200: 0.3821 - 21s/epoch - 40ms/step
Epoch 19/50
524/524 - 21s - loss: 3.1852 - accuracy200: 0.4241 - val_loss: 3.3332 - val_accuracy200: 0.3843 - 21s/epoch - 39ms/step
Epoch 20/50
524/524 - 21s - loss: 3.1792 - accuracy200: 0.4276 - val_loss: 3.3388 - val_accuracy200: 0.3799 - 21s/epoch - 40ms/step
Epoch 21/50
524/524 - 21s - loss: 3.1709 - accuracy200: 0.4337 - val_loss: 3.3653 - val_accuracy200: 0.3756 - 21s/epoch - 39ms/step
Epoch 22/50
524/524 - 21s - loss: 3.1666 - accuracy200: 0.4360 - val_loss: 3.3861 - val_accuracy200: 0.3678 - 21s/epoch - 40ms/step
testing model: results/XRAY/W1/deepVOL_L3/h200
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1186014
{'0': {'precision': 0.3623104525986804, 'recall': 0.083500066693344, 'f1-score': 0.13572109964443674, 'support': 112455}, '1': {'precision': 0.3567125878950918, 'recall': 0.8068671033134299, 'f1-score': 0.4947141217485733, 'support': 114051}, '2': {'precision': 0.3335306473171663, 'recall': 0.15913956942027532, 'f1-score': 0.2154703970295259, 'support': 109759}, 'accuracy': 0.35353367136038544, 'macro avg': {'precision': 0.3508512292703128, 'recall': 0.3498355798090164, 'f1-score': 0.2819685394741786, 'support': 336265}, 'weighted avg': {'precision': 0.3510179163097336, 'recall': 0.35353367136038544, 'f1-score': 0.2835114325535676, 'support': 336265}}
[[ 9390 83425 19640]
 [ 6764 92024 15263]
 [ 9763 82529 17467]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.113985
{'0': {'precision': 0.41818181818181815, 'recall': 0.07297565274870552, 'f1-score': 0.12426601632117062, 'support': 45385}, '1': {'precision': 0.35638464920545193, 'recall': 0.8897999417523579, 'f1-score': 0.5089310883883038, 'support': 44637}, '2': {'precision': 0.39512661251791686, 'recall': 0.13158014364942267, 'f1-score': 0.1974184527767831, 'support': 43996}, 'accuracy': 0.3642719634675939, 'macro avg': {'precision': 0.389897693301729, 'recall': 0.364785246050162, 'f1-score': 0.2768718524954192, 'support': 134018}, 'weighted avg': {'precision': 0.3900305470093856, 'recall': 0.3642719634675939, 'f1-score': 0.2764001282774881, 'support': 134018}}
[[ 3312 36541  5532]
 [ 1589 39718  3330]
 [ 3019 35188  5789]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045014
{'0': {'precision': 0.3908656399362719, 'recall': 0.08147000221385875, 'f1-score': 0.13483557753961709, 'support': 9034}, '1': {'precision': 0.3832289156626506, 'recall': 0.839527027027027, 'f1-score': 0.526239163523261, 'support': 9472}, '2': {'precision': 0.36125192858717214, 'recall': 0.1891735918744229, 'f1-score': 0.24831452162714945, 'support': 8664}, 'accuracy': 0.38008833271991166, 'macro avg': {'precision': 0.3784488280620315, 'recall': 0.3700568737051029, 'f1-score': 0.30312975423000915, 'support': 27170}, 'weighted avg': {'precision': 0.378760073228567, 'recall': 0.38008833271991166, 'f1-score': 0.3074729105543928, 'support': 27170}}
[[ 736 6491 1807]
 [ 429 7952 1091]
 [ 718 6307 1639]]
training model: results/XRAY/W1/deepVOL_L3/h300
Epoch 1/50
524/524 - 24s - loss: 3.3137 - accuracy300: 0.3688 - val_loss: 3.3820 - val_accuracy300: 0.3004 - 24s/epoch - 46ms/step
Epoch 2/50
524/524 - 21s - loss: 3.2937 - accuracy300: 0.3649 - val_loss: 3.3260 - val_accuracy300: 0.3022 - 21s/epoch - 40ms/step
Epoch 3/50
524/524 - 21s - loss: 3.2861 - accuracy300: 0.3658 - val_loss: 3.2977 - val_accuracy300: 0.3263 - 21s/epoch - 40ms/step
Epoch 4/50
524/524 - 21s - loss: 3.2803 - accuracy300: 0.3690 - val_loss: 3.2833 - val_accuracy300: 0.3517 - 21s/epoch - 39ms/step
Epoch 5/50
524/524 - 21s - loss: 3.2775 - accuracy300: 0.3685 - val_loss: 3.2825 - val_accuracy300: 0.3543 - 21s/epoch - 40ms/step
Epoch 6/50
524/524 - 21s - loss: 3.2720 - accuracy300: 0.3721 - val_loss: 3.2809 - val_accuracy300: 0.3636 - 21s/epoch - 40ms/step
Epoch 7/50
524/524 - 21s - loss: 3.2659 - accuracy300: 0.3742 - val_loss: 3.2839 - val_accuracy300: 0.3551 - 21s/epoch - 41ms/step
Epoch 8/50
524/524 - 21s - loss: 3.2597 - accuracy300: 0.3775 - val_loss: 3.2748 - val_accuracy300: 0.3745 - 21s/epoch - 41ms/step
Epoch 9/50
524/524 - 21s - loss: 3.2589 - accuracy300: 0.3771 - val_loss: 3.2769 - val_accuracy300: 0.3679 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 3.2501 - accuracy300: 0.3830 - val_loss: 3.2707 - val_accuracy300: 0.3763 - 21s/epoch - 40ms/step
Epoch 11/50
524/524 - 21s - loss: 3.2361 - accuracy300: 0.3911 - val_loss: 3.2918 - val_accuracy300: 0.3635 - 21s/epoch - 40ms/step
Epoch 12/50
524/524 - 21s - loss: 3.2336 - accuracy300: 0.3927 - val_loss: 3.2824 - val_accuracy300: 0.3739 - 21s/epoch - 39ms/step
Epoch 13/50
524/524 - 21s - loss: 3.2279 - accuracy300: 0.3995 - val_loss: 3.2997 - val_accuracy300: 0.3685 - 21s/epoch - 39ms/step
Epoch 14/50
524/524 - 21s - loss: 3.2230 - accuracy300: 0.4003 - val_loss: 3.3106 - val_accuracy300: 0.3546 - 21s/epoch - 39ms/step
Epoch 15/50
524/524 - 21s - loss: 3.2130 - accuracy300: 0.4071 - val_loss: 3.3342 - val_accuracy300: 0.3452 - 21s/epoch - 40ms/step
Epoch 16/50
524/524 - 21s - loss: 3.2133 - accuracy300: 0.4072 - val_loss: 3.3060 - val_accuracy300: 0.3604 - 21s/epoch - 40ms/step
Epoch 17/50
524/524 - 21s - loss: 3.2102 - accuracy300: 0.4102 - val_loss: 3.3206 - val_accuracy300: 0.3540 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 3.2014 - accuracy300: 0.4163 - val_loss: 3.3458 - val_accuracy300: 0.3411 - 21s/epoch - 40ms/step
Epoch 19/50
524/524 - 21s - loss: 3.1966 - accuracy300: 0.4186 - val_loss: 3.3966 - val_accuracy300: 0.3189 - 21s/epoch - 41ms/step
Epoch 20/50
524/524 - 21s - loss: 3.1843 - accuracy300: 0.4246 - val_loss: 3.4325 - val_accuracy300: 0.3222 - 21s/epoch - 39ms/step
testing model: results/XRAY/W1/deepVOL_L3/h300
Evaluating performance on  test set...
1314/1314 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.107642
{'0': {'precision': 0.35573835028904127, 'recall': 0.2859641233198421, 'f1-score': 0.31705785673394765, 'support': 120078}, '1': {'precision': 0.31736375999203953, 'recall': 0.4862236134684378, 'f1-score': 0.38405221202706935, 'support': 98393}, '2': {'precision': 0.36863159314111066, 'recall': 0.2785031495661918, 'f1-score': 0.31729113875079795, 'support': 117794}, 'accuracy': 0.34194757111206936, 'macro avg': {'precision': 0.34724456780739715, 'recall': 0.3502302954514906, 'f1-score': 0.339467069170605, 'support': 336265}, 'weighted avg': {'precision': 0.3490262499676393, 'recall': 0.34194757111206936, 'f1-score': 0.3367424948088261, 'support': 336265}}
[[34338 53375 32365]
 [26729 47841 23823]
 [35459 49529 32806]]
Evaluating performance on  train set...
524/524 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975599
{'0': {'precision': 0.3800192864030858, 'recall': 0.20797534356462816, 'f1-score': 0.26882776686313037, 'support': 47371}, '1': {'precision': 0.36203292082181904, 'recall': 0.7259323503902863, 'f1-score': 0.4831246292228511, 'support': 41508}, '2': {'precision': 0.39456220086071675, 'recall': 0.21732869580628725, 'f1-score': 0.2802777063512471, 'support': 45139}, 'accuracy': 0.3715471056126789, 'macro avg': {'precision': 0.3788714693618738, 'recall': 0.3837454632537339, 'f1-score': 0.34407670081240954, 'support': 134018}, 'weighted avg': {'precision': 0.37934679877572075, 'recall': 0.3715471056126789, 'f1-score': 0.33905619126419134, 'support': 134018}}
[[ 9852 27868  9651]
 [ 5974 30132  5402]
 [10099 25230  9810]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943999
{'0': {'precision': 0.38033968090581577, 'recall': 0.30311730926989333, 'f1-score': 0.3373658981967588, 'support': 9752}, '1': {'precision': 0.37237021038316936, 'recall': 0.5708154506437768, 'f1-score': 0.45071649883811, 'support': 8155}, '2': {'precision': 0.3826301290416123, 'recall': 0.2848969016517327, 'f1-score': 0.3266089108910892, 'support': 9263}, 'accuracy': 0.37725432462274566, 'macro avg': {'precision': 0.3784466734435325, 'recall': 0.38627655385513426, 'f1-score': 0.37156376930865265, 'support': 27170}, 'weighted avg': {'precision': 0.37872854321607347, 'recall': 0.37725432462274566, 'f1-score': 0.3677204132802259, 'support': 27170}}
[[2956 4098 2698]
 [1940 4655 1560]
 [2876 3748 2639]]
training model: results/XRAY/W1/deepVOL_L3/h500
Epoch 1/50
524/524 - 23s - loss: 3.3101 - accuracy500: 0.3778 - val_loss: 3.2983 - val_accuracy500: 0.3698 - 23s/epoch - 43ms/step
Epoch 2/50
524/524 - 21s - loss: 3.2947 - accuracy500: 0.3687 - val_loss: 3.2946 - val_accuracy500: 0.3718 - 21s/epoch - 39ms/step
Epoch 3/50
524/524 - 20s - loss: 3.2918 - accuracy500: 0.3617 - val_loss: 3.2811 - val_accuracy500: 0.3861 - 20s/epoch - 38ms/step
Epoch 4/50
524/524 - 21s - loss: 3.2671 - accuracy500: 0.3816 - val_loss: 3.2672 - val_accuracy500: 0.3805 - 21s/epoch - 41ms/step
Epoch 5/50
524/524 - 20s - loss: 3.2379 - accuracy500: 0.3934 - val_loss: 3.2739 - val_accuracy500: 0.3610 - 20s/epoch - 38ms/step
Epoch 6/50
524/524 - 20s - loss: 3.2181 - accuracy500: 0.4043 - val_loss: 3.2899 - val_accuracy500: 0.3428 - 20s/epoch - 39ms/step
Epoch 7/50
524/524 - 20s - loss: 3.2073 - accuracy500: 0.4078 - val_loss: 3.2756 - val_accuracy500: 0.3440 - 20s/epoch - 39ms/step
Epoch 8/50
524/524 - 20s - loss: 3.2007 - accuracy500: 0.4110 - val_loss: 3.2821 - val_accuracy500: 0.3459 - 20s/epoch - 39ms/step
Epoch 9/50
524/524 - 21s - loss: 3.1929 - accuracy500: 0.4159 - val_loss: 3.2711 - val_accuracy500: 0.3658 - 21s/epoch - 40ms/step
Epoch 10/50
524/524 - 21s - loss: 3.1878 - accuracy500: 0.4192 - val_loss: 3.2684 - val_accuracy500: 0.3709 - 21s/epoch - 40ms/step
Epoch 11/50
524/524 - 21s - loss: 3.1845 - accuracy500: 0.4227 - val_loss: 3.2676 - val_accuracy500: 0.3699 - 21s/epoch - 40ms/step
Epoch 12/50
524/524 - 21s - loss: 3.1786 - accuracy500: 0.4254 - val_loss: 3.2558 - val_accuracy500: 0.3822 - 21s/epoch - 40ms/step
Epoch 13/50
524/524 - 21s - loss: 3.1692 - accuracy500: 0.4292 - val_loss: 3.2614 - val_accuracy500: 0.3794 - 21s/epoch - 39ms/step
Epoch 14/50
524/524 - 21s - loss: 3.1621 - accuracy500: 0.4332 - val_loss: 3.2625 - val_accuracy500: 0.3898 - 21s/epoch - 41ms/step
Epoch 15/50
524/524 - 21s - loss: 3.1588 - accuracy500: 0.4326 - val_loss: 3.2601 - val_accuracy500: 0.3820 - 21s/epoch - 40ms/step
Epoch 16/50
524/524 - 20s - loss: 3.1477 - accuracy500: 0.4415 - val_loss: 3.2647 - val_accuracy500: 0.3881 - 20s/epoch - 39ms/step
Epoch 17/50
524/524 - 21s - loss: 3.1406 - accuracy500: 0.4440 - val_loss: 3.2656 - val_accuracy500: 0.3808 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 3.1288 - accuracy500: 0.4478 - val_loss: 3.2769 - val_accuracy500: 0.3807 - 21s/epoch - 41ms/step
Epoch 19/50
524/524 - 22s - loss: 3.1245 - accuracy500: 0.4511 - val_loss: 3.2789 - val_accuracy500: 0.3787 - 22s/epoch - 42ms/step
Epoch 20/50
524/524 - 20s - loss: 3.1175 - accuracy500: 0.4527 - val_loss: 3.2738 - val_accuracy500: 0.3861 - 20s/epoch - 39ms/step
Epoch 21/50
524/524 - 22s - loss: 3.1113 - accuracy500: 0.4570 - val_loss: 3.2901 - val_accuracy500: 0.3750 - 22s/epoch - 41ms/step
Epoch 22/50
524/524 - 21s - loss: 3.1030 - accuracy500: 0.4611 - val_loss: 3.2954 - val_accuracy500: 0.3777 - 21s/epoch - 40ms/step
testing model: results/XRAY/W1/deepVOL_L3/h500
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039767
{'0': {'precision': 0.3630731709972617, 'recall': 0.5236446433478585, 'f1-score': 0.4288203486166567, 'support': 127365}, '1': {'precision': 0.2626844781096268, 'recall': 0.3079373122443809, 'f1-score': 0.2835165201357378, 'support': 82887}, '2': {'precision': 0.33907880012994984, 'recall': 0.1490877925293422, 'f1-score': 0.2071117137675767, 'support': 126013}, 'accuracy': 0.3301116678809867, 'macro avg': {'precision': 0.3216121497456128, 'recall': 0.32688991604052725, 'f1-score': 0.3064828608399904, 'support': 336265}, 'weighted avg': {'precision': 0.32933632582015443, 'recall': 0.3301116678809867, 'f1-score': 0.30992016978586834, 'support': 336265}}
[[66694 37744 22927]
 [43671 25524 13692]
 [73328 33898 18787]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0727384
{'0': {'precision': 0.3864406779661017, 'recall': 0.4687479604046557, 'f1-score': 0.4236335037357452, 'support': 45965}, '1': {'precision': 0.4329585259352857, 'recall': 0.613572999070653, 'f1-score': 0.5076801890508074, 'support': 44117}, '2': {'precision': 0.38413162241138354, 'recall': 0.13763201019664967, 'f1-score': 0.20265424444518915, 'support': 43936}, 'accuracy': 0.40787058454834424, 'macro avg': {'precision': 0.401176942104257, 'recall': 0.4066509898906528, 'f1-score': 0.3779893124105806, 'support': 134018}, 'weighted avg': {'precision': 0.4009967617310019, 'recall': 0.40787058454834424, 'f1-score': 0.37885551033079007, 'support': 134018}}
[[21546 19101  5318]
 [12671 27069  4377]
 [21538 16351  6047]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860615
{'0': {'precision': 0.4151430565247732, 'recall': 0.5652256532066509, 'f1-score': 0.4786964393482197, 'support': 10525}, '1': {'precision': 0.3362748558653959, 'recall': 0.3926902995328387, 'f1-score': 0.36229954997781577, 'support': 7278}, '2': {'precision': 0.35706058511863625, 'recall': 0.16547453827265934, 'f1-score': 0.22614531660344325, 'support': 9367}, 'accuracy': 0.38119249171880754, 'macro avg': {'precision': 0.36949283250293513, 'recall': 0.37446349700404963, 'f1-score': 0.35571376864315957, 'support': 27170}, 'weighted avg': {'precision': 0.37399247595575463, 'recall': 0.38119249171880754, 'f1-score': 0.3604489999817081, 'support': 27170}}
[[5949 2941 1635]
 [3264 2858 1156]
 [5117 2700 1550]]
training model: results/XRAY/W1/deepVOL_L3/h1000
Epoch 1/50
524/524 - 24s - loss: 3.3044 - accuracy1000: 0.3824 - val_loss: 3.3913 - val_accuracy1000: 0.3017 - 24s/epoch - 45ms/step
Epoch 2/50
524/524 - 22s - loss: 3.2980 - accuracy1000: 0.3646 - val_loss: 3.3365 - val_accuracy1000: 0.3230 - 22s/epoch - 42ms/step
Epoch 3/50
524/524 - 21s - loss: 3.2864 - accuracy1000: 0.3637 - val_loss: 3.3936 - val_accuracy1000: 0.3015 - 21s/epoch - 41ms/step
Epoch 4/50
524/524 - 22s - loss: 3.2820 - accuracy1000: 0.3651 - val_loss: 3.3236 - val_accuracy1000: 0.3569 - 22s/epoch - 41ms/step
Epoch 5/50
524/524 - 21s - loss: 3.2857 - accuracy1000: 0.3602 - val_loss: 3.3371 - val_accuracy1000: 0.3349 - 21s/epoch - 40ms/step
Epoch 6/50
524/524 - 22s - loss: 3.2781 - accuracy1000: 0.3726 - val_loss: 3.3058 - val_accuracy1000: 0.3146 - 22s/epoch - 43ms/step
Epoch 7/50
524/524 - 21s - loss: 3.2666 - accuracy1000: 0.3795 - val_loss: 3.3949 - val_accuracy1000: 0.3110 - 21s/epoch - 40ms/step
Epoch 8/50
524/524 - 21s - loss: 3.2807 - accuracy1000: 0.3653 - val_loss: 3.3266 - val_accuracy1000: 0.3665 - 21s/epoch - 40ms/step
Epoch 9/50
524/524 - 21s - loss: 3.2788 - accuracy1000: 0.3711 - val_loss: 3.3101 - val_accuracy1000: 0.3456 - 21s/epoch - 39ms/step
Epoch 10/50
524/524 - 21s - loss: 3.2656 - accuracy1000: 0.3826 - val_loss: 3.3228 - val_accuracy1000: 0.3509 - 21s/epoch - 39ms/step
Epoch 11/50
524/524 - 21s - loss: 3.2557 - accuracy1000: 0.3870 - val_loss: 3.3032 - val_accuracy1000: 0.3666 - 21s/epoch - 40ms/step
Epoch 12/50
524/524 - 21s - loss: 3.2487 - accuracy1000: 0.3880 - val_loss: 3.3097 - val_accuracy1000: 0.3648 - 21s/epoch - 39ms/step
Epoch 13/50
524/524 - 21s - loss: 3.2276 - accuracy1000: 0.4035 - val_loss: 3.3265 - val_accuracy1000: 0.3635 - 21s/epoch - 41ms/step
Epoch 14/50
524/524 - 21s - loss: 3.2171 - accuracy1000: 0.4095 - val_loss: 3.3352 - val_accuracy1000: 0.3605 - 21s/epoch - 40ms/step
Epoch 15/50
524/524 - 21s - loss: 3.2022 - accuracy1000: 0.4185 - val_loss: 3.3557 - val_accuracy1000: 0.3575 - 21s/epoch - 41ms/step
Epoch 16/50
524/524 - 21s - loss: 3.1860 - accuracy1000: 0.4261 - val_loss: 3.3674 - val_accuracy1000: 0.3585 - 21s/epoch - 40ms/step
Epoch 17/50
524/524 - 21s - loss: 3.1734 - accuracy1000: 0.4296 - val_loss: 3.3829 - val_accuracy1000: 0.3615 - 21s/epoch - 40ms/step
Epoch 18/50
524/524 - 21s - loss: 3.1647 - accuracy1000: 0.4350 - val_loss: 3.3447 - val_accuracy1000: 0.3702 - 21s/epoch - 40ms/step
Epoch 19/50
524/524 - 21s - loss: 3.1496 - accuracy1000: 0.4406 - val_loss: 3.3441 - val_accuracy1000: 0.3739 - 21s/epoch - 40ms/step
Epoch 20/50
524/524 - 21s - loss: 3.1318 - accuracy1000: 0.4489 - val_loss: 3.3666 - val_accuracy1000: 0.3713 - 21s/epoch - 40ms/step
Epoch 21/50
524/524 - 21s - loss: 3.1222 - accuracy1000: 0.4521 - val_loss: 3.4108 - val_accuracy1000: 0.3706 - 21s/epoch - 40ms/step
testing model: results/XRAY/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
1314/1314 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108353
{'0': {'precision': 0.34295696947407134, 'recall': 0.46984825454942436, 'f1-score': 0.3964977801084965, 'support': 119081}, '1': {'precision': 0.29864611244230926, 'recall': 0.2554340693178262, 'f1-score': 0.2753550633944604, 'support': 99051}, '2': {'precision': 0.3425333122186277, 'recall': 0.25633819508520056, 'f1-score': 0.2932327550728918, 'support': 118133}, 'accuracy': 0.3316818580583766, 'macro avg': {'precision': 0.32804546471166945, 'recall': 0.32720683965081704, 'f1-score': 0.3216951995252829, 'support': 336265}, 'weighted avg': {'precision': 0.32975582572610357, 'recall': 0.3316818580583766, 'f1-score': 0.32453574291826537, 'support': 336265}}
[[55950 30599 32532]
 [48158 25301 25592]
 [59032 28819 30282]]
Evaluating performance on  train set...
524/524 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0923973
{'0': {'precision': 0.37088600545748174, 'recall': 0.4296589394004559, 'f1-score': 0.3981150309346139, 'support': 46502}, '1': {'precision': 0.4013159138605812, 'recall': 0.4784617812140748, 'f1-score': 0.43650646760030437, 'support': 44363}, '2': {'precision': 0.37356912239506895, 'recall': 0.2359511505573193, 'f1-score': 0.28922438892755187, 'support': 43153}, 'accuracy': 0.38344103030936144, 'macro avg': {'precision': 0.381923680571044, 'recall': 0.38135729039061667, 'f1-score': 0.37461529582082337, 'support': 134018}, 'weighted avg': {'precision': 0.38182294356799223, 'recall': 0.38344103030936144, 'f1-score': 0.3757613279265797, 'support': 134018}}
[[19980 17020  9502]
 [15565 21226  7572]
 [18326 14645 10182]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007386
{'0': {'precision': 0.4074345805820494, 'recall': 0.47468895431664926, 'f1-score': 0.43849798210212315, 'support': 10529}, '1': {'precision': 0.34188599391614866, 'recall': 0.32862954487668444, 'f1-score': 0.3351267258702275, 'support': 7866}, '2': {'precision': 0.3326069190956143, 'recall': 0.27829059829059827, 'f1-score': 0.3030340634113048, 'support': 8775}, 'accuracy': 0.3689731321310269, 'macro avg': {'precision': 0.3606424978646041, 'recall': 0.3605363658279774, 'f1-score': 0.3588862571278851, 'support': 27170}, 'weighted avg': {'precision': 0.3642907486991843, 'recall': 0.3689731321310269, 'f1-score': 0.3648206104410255, 'support': 27170}}
[[4998 2597 2934]
 [3315 2585 1966]
 [3954 2379 2442]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  13.18 (ave)

============================================
