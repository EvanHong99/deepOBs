This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-17.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-25.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-23.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-18.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-08.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-02-04.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-31.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-01-30.csv
training model: results/XRAY/W0/deepLOB_L1/h10
Epoch 1/50
451/451 - 40s - loss: 3.2088 - accuracy10: 0.4008 - val_loss: 3.1492 - val_accuracy10: 0.3980 - 40s/epoch - 89ms/step
Epoch 2/50
451/451 - 12s - loss: 3.1097 - accuracy10: 0.4411 - val_loss: 3.1534 - val_accuracy10: 0.3786 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 12s - loss: 3.0701 - accuracy10: 0.4537 - val_loss: 3.0861 - val_accuracy10: 0.4293 - 12s/epoch - 26ms/step
Epoch 4/50
451/451 - 12s - loss: 3.0461 - accuracy10: 0.4632 - val_loss: 3.0986 - val_accuracy10: 0.4476 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 12s - loss: 3.0266 - accuracy10: 0.4697 - val_loss: 3.0830 - val_accuracy10: 0.4464 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 12s - loss: 3.0121 - accuracy10: 0.4743 - val_loss: 3.0864 - val_accuracy10: 0.4546 - 12s/epoch - 26ms/step
Epoch 7/50
451/451 - 12s - loss: 3.0012 - accuracy10: 0.4775 - val_loss: 3.0872 - val_accuracy10: 0.4574 - 12s/epoch - 26ms/step
Epoch 8/50
451/451 - 11s - loss: 2.9876 - accuracy10: 0.4826 - val_loss: 3.0765 - val_accuracy10: 0.4602 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 12s - loss: 2.9825 - accuracy10: 0.4832 - val_loss: 3.0873 - val_accuracy10: 0.4540 - 12s/epoch - 26ms/step
Epoch 10/50
451/451 - 11s - loss: 2.9758 - accuracy10: 0.4861 - val_loss: 3.0811 - val_accuracy10: 0.4597 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 11s - loss: 2.9685 - accuracy10: 0.4869 - val_loss: 3.0920 - val_accuracy10: 0.4709 - 11s/epoch - 25ms/step
Epoch 12/50
451/451 - 11s - loss: 2.9628 - accuracy10: 0.4893 - val_loss: 3.0834 - val_accuracy10: 0.4645 - 11s/epoch - 25ms/step
Epoch 13/50
451/451 - 12s - loss: 2.9553 - accuracy10: 0.4916 - val_loss: 3.0964 - val_accuracy10: 0.4506 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 12s - loss: 2.9462 - accuracy10: 0.4948 - val_loss: 3.1124 - val_accuracy10: 0.4456 - 12s/epoch - 26ms/step
Epoch 15/50
451/451 - 12s - loss: 2.9420 - accuracy10: 0.4969 - val_loss: 3.0834 - val_accuracy10: 0.4568 - 12s/epoch - 26ms/step
Epoch 16/50
451/451 - 12s - loss: 2.9345 - accuracy10: 0.4971 - val_loss: 3.1658 - val_accuracy10: 0.4353 - 12s/epoch - 26ms/step
Epoch 17/50
451/451 - 12s - loss: 2.9280 - accuracy10: 0.5016 - val_loss: 3.1101 - val_accuracy10: 0.4497 - 12s/epoch - 26ms/step
Epoch 18/50
451/451 - 12s - loss: 2.9245 - accuracy10: 0.5017 - val_loss: 3.1399 - val_accuracy10: 0.4452 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h10
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0307896
{'0': {'precision': 0.4318588522068852, 'recall': 0.4178928451083904, 'f1-score': 0.42476108021710896, 'support': 106836}, '1': {'precision': 0.666514729014729, 'recall': 0.3752692176083412, 'f1-score': 0.4801810619035967, 'support': 198724}, '2': {'precision': 0.3812206479145686, 'recall': 0.6933113309336211, 'f1-score': 0.49194365544772306, 'support': 110291}, 'accuracy': 0.4705699878081332, 'macro avg': {'precision': 0.4931980763787276, 'recall': 0.49549113121678423, 'f1-score': 0.46562859918947624, 'support': 415851}, 'weighted avg': {'precision': 0.5305644373158739, 'recall': 0.4705699878081332, 'f1-score': 0.46906279848982024, 'support': 415851}}
[[44646 18930 43260]
 [43293 74575 80856]
 [15442 18383 76466]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0630577
{'0': {'precision': 0.4282435839420777, 'recall': 0.4277320419693301, 'f1-score': 0.4279876601036939, 'support': 30975}, '1': {'precision': 0.6449453607000283, 'recall': 0.3019102990033223, 'f1-score': 0.411288974606236, 'support': 52976}, '2': {'precision': 0.37030462378376566, 'recall': 0.7019905393822026, 'f1-score': 0.48484848484848486, 'support': 31499}, 'accuracy': 0.4448245993936769, 'macro avg': {'precision': 0.4811645228086239, 'recall': 0.477210960118285, 'f1-score': 0.4413750398528049, 'support': 115450}, 'weighted avg': {'precision': 0.5118726356484659, 'recall': 0.4448245993936769, 'f1-score': 0.4358389338648272, 'support': 115450}}
[[13249  4676 13050]
 [12431 15994 24551]
 [ 5258  4129 22112]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0408008
{'0': {'precision': 0.4413679368110407, 'recall': 0.4261292214866337, 'f1-score': 0.43361473522640054, 'support': 11933}, '1': {'precision': 0.6077607928775407, 'recall': 0.34971726837755546, 'f1-score': 0.4439672362487346, 'support': 20691}, '2': {'precision': 0.3837573746312684, 'recall': 0.6661332906632531, 'f1-score': 0.48697177949992687, 'support': 12499}, 'accuracy': 0.45757152671586554, 'macro avg': {'precision': 0.4776287014399499, 'recall': 0.4806599268424807, 'f1-score': 0.45485125032502066, 'support': 45123}, 'weighted avg': {'precision': 0.5017087866700256, 'recall': 0.45757152671586554, 'f1-score': 0.4531416570850518, 'support': 45123}}
[[5085 2451 4397]
 [4482 7236 8973]
 [1954 2219 8326]]
training model: results/XRAY/W0/deepLOB_L1/h20
Epoch 1/50
451/451 - 15s - loss: 3.2505 - accuracy20: 0.3994 - val_loss: 3.2317 - val_accuracy20: 0.4105 - 15s/epoch - 33ms/step
Epoch 2/50
451/451 - 12s - loss: 3.1680 - accuracy20: 0.4427 - val_loss: 3.2213 - val_accuracy20: 0.4201 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 12s - loss: 3.1313 - accuracy20: 0.4574 - val_loss: 3.1829 - val_accuracy20: 0.4368 - 12s/epoch - 27ms/step
Epoch 4/50
451/451 - 12s - loss: 3.1108 - accuracy20: 0.4627 - val_loss: 3.1733 - val_accuracy20: 0.4451 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 12s - loss: 3.0987 - accuracy20: 0.4665 - val_loss: 3.1659 - val_accuracy20: 0.4532 - 12s/epoch - 27ms/step
Epoch 6/50
451/451 - 12s - loss: 3.0833 - accuracy20: 0.4715 - val_loss: 3.1704 - val_accuracy20: 0.4508 - 12s/epoch - 26ms/step
Epoch 7/50
451/451 - 12s - loss: 3.0736 - accuracy20: 0.4740 - val_loss: 3.1685 - val_accuracy20: 0.4474 - 12s/epoch - 26ms/step
Epoch 8/50
451/451 - 11s - loss: 3.0669 - accuracy20: 0.4751 - val_loss: 3.1766 - val_accuracy20: 0.4525 - 11s/epoch - 24ms/step
Epoch 9/50
451/451 - 12s - loss: 3.0595 - accuracy20: 0.4765 - val_loss: 3.2139 - val_accuracy20: 0.4340 - 12s/epoch - 27ms/step
Epoch 10/50
451/451 - 12s - loss: 3.0514 - accuracy20: 0.4800 - val_loss: 3.1885 - val_accuracy20: 0.4467 - 12s/epoch - 26ms/step
Epoch 11/50
451/451 - 12s - loss: 3.0449 - accuracy20: 0.4814 - val_loss: 3.1857 - val_accuracy20: 0.4514 - 12s/epoch - 26ms/step
Epoch 12/50
451/451 - 12s - loss: 3.0389 - accuracy20: 0.4839 - val_loss: 3.2047 - val_accuracy20: 0.4442 - 12s/epoch - 27ms/step
Epoch 13/50
451/451 - 12s - loss: 3.0320 - accuracy20: 0.4861 - val_loss: 3.1775 - val_accuracy20: 0.4571 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 12s - loss: 3.0243 - accuracy20: 0.4887 - val_loss: 3.1947 - val_accuracy20: 0.4487 - 12s/epoch - 26ms/step
Epoch 15/50
451/451 - 11s - loss: 3.0224 - accuracy20: 0.4896 - val_loss: 3.2297 - val_accuracy20: 0.4377 - 11s/epoch - 25ms/step
testing model: results/XRAY/W0/deepLOB_L1/h20
Evaluating performance on  test set...
1625/1625 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0391254
{'0': {'precision': 0.4709257260969345, 'recall': 0.4648150370525937, 'f1-score': 0.46785042918940956, 'support': 133324}, '1': {'precision': 0.5057983050338694, 'recall': 0.34782399284411875, 'f1-score': 0.4121935110364566, 'support': 145335}, '2': {'precision': 0.44582071899041853, 'recall': 0.5989489183042743, 'f1-score': 0.5111630887137409, 'support': 137192}, 'accuracy': 0.4681797085975506, 'macro avg': {'precision': 0.4741815833737408, 'recall': 0.4705293160669956, 'f1-score': 0.4637356763132024, 'support': 415851}, 'weighted avg': {'precision': 0.4748309713045745, 'recall': 0.4681797085975506, 'f1-score': 0.4626881287156886, 'support': 415851}}
[[61971 23930 47423]
 [40064 50551 54720]
 [29559 25462 82171]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0546596
{'0': {'precision': 0.45653845134268217, 'recall': 0.45355666166284797, 'f1-score': 0.4550426718101831, 'support': 37971}, '1': {'precision': 0.47943538573862254, 'recall': 0.3048434517975963, 'f1-score': 0.3727060604149587, 'support': 38774}, '2': {'precision': 0.4344770410566578, 'recall': 0.5957628213409121, 'f1-score': 0.5024951513434592, 'support': 38705}, 'accuracy': 0.45128627111303593, 'macro avg': {'precision': 0.4568169593793208, 'recall': 0.45138764493378547, 'f1-score': 0.44341462785620034, 'support': 115450}, 'weighted avg': {'precision': 0.4568322482170661, 'recall': 0.45128627111303593, 'f1-score': 0.443298440108988, 'support': 115450}}
[[17222  6604 14145]
 [11085 11820 15869]
 [ 9416  6230 23059]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0549473
{'0': {'precision': 0.474800088034627, 'recall': 0.43553162853297445, 'f1-score': 0.4543189077252465, 'support': 14860}, '1': {'precision': 0.4444444444444444, 'recall': 0.354257385944932, 'f1-score': 0.39425908667287973, 'support': 14927}, '2': {'precision': 0.4429927528835358, 'recall': 0.5659885237350026, 'f1-score': 0.49699398797595196, 'support': 15336}, 'accuracy': 0.45298406577576844, 'macro avg': {'precision': 0.4540790951208691, 'recall': 0.4519258460709697, 'f1-score': 0.44852399412469274, 'support': 45123}, 'weighted avg': {'precision': 0.45394784009570915, 'recall': 0.45298406577576844, 'f1-score': 0.44895472719372465, 'support': 45123}}
[[6472 3378 5010]
 [3735 5288 5904]
 [3424 3232 8680]]
training model: results/XRAY/W0/deepLOB_L1/h30
Epoch 1/50
451/451 - 14s - loss: 3.2671 - accuracy30: 0.3933 - val_loss: 3.2641 - val_accuracy30: 0.4107 - 14s/epoch - 31ms/step
Epoch 2/50
451/451 - 12s - loss: 3.2024 - accuracy30: 0.4281 - val_loss: 3.2330 - val_accuracy30: 0.4212 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 12s - loss: 3.1737 - accuracy30: 0.4386 - val_loss: 3.2087 - val_accuracy30: 0.4289 - 12s/epoch - 26ms/step
Epoch 4/50
451/451 - 11s - loss: 3.1527 - accuracy30: 0.4472 - val_loss: 3.2144 - val_accuracy30: 0.4323 - 11s/epoch - 25ms/step
Epoch 5/50
451/451 - 12s - loss: 3.1411 - accuracy30: 0.4504 - val_loss: 3.2162 - val_accuracy30: 0.4312 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 12s - loss: 3.1354 - accuracy30: 0.4529 - val_loss: 3.1944 - val_accuracy30: 0.4340 - 12s/epoch - 26ms/step
Epoch 7/50
451/451 - 12s - loss: 3.1275 - accuracy30: 0.4551 - val_loss: 3.1999 - val_accuracy30: 0.4387 - 12s/epoch - 27ms/step
Epoch 8/50
451/451 - 12s - loss: 3.1224 - accuracy30: 0.4578 - val_loss: 3.2009 - val_accuracy30: 0.4369 - 12s/epoch - 27ms/step
Epoch 9/50
451/451 - 12s - loss: 3.1158 - accuracy30: 0.4610 - val_loss: 3.2001 - val_accuracy30: 0.4394 - 12s/epoch - 27ms/step
Epoch 10/50
451/451 - 12s - loss: 3.1099 - accuracy30: 0.4619 - val_loss: 3.2142 - val_accuracy30: 0.4388 - 12s/epoch - 27ms/step
Epoch 11/50
451/451 - 11s - loss: 3.1061 - accuracy30: 0.4630 - val_loss: 3.2091 - val_accuracy30: 0.4417 - 11s/epoch - 25ms/step
Epoch 12/50
451/451 - 11s - loss: 3.0987 - accuracy30: 0.4642 - val_loss: 3.1972 - val_accuracy30: 0.4450 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 12s - loss: 3.0941 - accuracy30: 0.4651 - val_loss: 3.2004 - val_accuracy30: 0.4431 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 11s - loss: 3.0889 - accuracy30: 0.4682 - val_loss: 3.2076 - val_accuracy30: 0.4425 - 11s/epoch - 25ms/step
Epoch 15/50
451/451 - 12s - loss: 3.0874 - accuracy30: 0.4688 - val_loss: 3.2131 - val_accuracy30: 0.4424 - 12s/epoch - 26ms/step
Epoch 16/50
451/451 - 12s - loss: 3.0821 - accuracy30: 0.4696 - val_loss: 3.2019 - val_accuracy30: 0.4422 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h30
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0456336
{'0': {'precision': 0.4658927843149102, 'recall': 0.4496792535355008, 'f1-score': 0.4576424591781472, 'support': 137180}, '1': {'precision': 0.470770945339346, 'recall': 0.3280198446937015, 'f1-score': 0.3866399420307051, 'support': 139080}, '2': {'precision': 0.44067160578541636, 'recall': 0.5888775064294977, 'f1-score': 0.5041072704359317, 'support': 139591}, 'accuracy': 0.4557161098566554, 'macro avg': {'precision': 0.4591117784798908, 'recall': 0.45552553488623326, 'f1-score': 0.4494632238815947, 'support': 415851}, 'weighted avg': {'precision': 0.4590581370570413, 'recall': 0.4557161098566554, 'f1-score': 0.44949300031768796, 'support': 415851}}
[[61687 25882 49611]
 [38734 45621 54725]
 [31985 25404 82202]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0612282
{'0': {'precision': 0.43979659193702175, 'recall': 0.4669435431537962, 'f1-score': 0.4529636903862618, 'support': 38525}, '1': {'precision': 0.44800576645843343, 'recall': 0.24749794260532534, 'f1-score': 0.3188495015304639, 'support': 37669}, '2': {'precision': 0.4240653553417571, 'recall': 0.5804972488282046, 'f1-score': 0.49010140548213305, 'support': 39256}, 'accuracy': 0.4339540926808142, 'macro avg': {'precision': 0.4372892379124041, 'recall': 0.4316462448624421, 'f1-score': 0.4206381991329529, 'support': 115450}, 'weighted avg': {'precision': 0.4371260503282158, 'recall': 0.4339540926808142, 'f1-score': 0.4218327312160104, 'support': 115450}}
[[17989  5977 14559]
 [11956  9323 16390]
 [10958  5510 22788]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0650167
{'0': {'precision': 0.4620936237833543, 'recall': 0.45605436842449193, 'f1-score': 0.4590541340524897, 'support': 15303}, '1': {'precision': 0.4139206844721933, 'recall': 0.24591290012364336, 'f1-score': 0.30852759943120606, 'support': 14558}, '2': {'precision': 0.4217397407702026, 'recall': 0.5905516970252915, 'f1-score': 0.49206999153768455, 'support': 15262}, 'accuracy': 0.4337477561332358, 'macro avg': {'precision': 0.4325846830085834, 'recall': 0.43083965519114226, 'f1-score': 0.41988390834046013, 'support': 45123}, 'weighted avg': {'precision': 0.4329026876080423, 'recall': 0.4337477561332358, 'f1-score': 0.4216568582933956, 'support': 45123}}
[[6979 2670 5654]
 [4274 3580 6704]
 [3850 2399 9013]]
training model: results/XRAY/W0/deepLOB_L1/h50
Epoch 1/50
451/451 - 14s - loss: 3.3018 - accuracy50: 0.3721 - val_loss: 3.3176 - val_accuracy50: 0.3705 - 14s/epoch - 31ms/step
Epoch 2/50
451/451 - 12s - loss: 3.2506 - accuracy50: 0.3963 - val_loss: 3.2858 - val_accuracy50: 0.3858 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 12s - loss: 3.2257 - accuracy50: 0.4119 - val_loss: 3.2526 - val_accuracy50: 0.4020 - 12s/epoch - 26ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2119 - accuracy50: 0.4164 - val_loss: 3.2395 - val_accuracy50: 0.4068 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 12s - loss: 3.2069 - accuracy50: 0.4201 - val_loss: 3.2529 - val_accuracy50: 0.4011 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 12s - loss: 3.2005 - accuracy50: 0.4214 - val_loss: 3.2484 - val_accuracy50: 0.4076 - 12s/epoch - 27ms/step
Epoch 7/50
451/451 - 12s - loss: 3.1956 - accuracy50: 0.4246 - val_loss: 3.2560 - val_accuracy50: 0.4058 - 12s/epoch - 26ms/step
Epoch 8/50
451/451 - 12s - loss: 3.1905 - accuracy50: 0.4274 - val_loss: 3.2478 - val_accuracy50: 0.4102 - 12s/epoch - 27ms/step
Epoch 9/50
451/451 - 12s - loss: 3.1850 - accuracy50: 0.4288 - val_loss: 3.2314 - val_accuracy50: 0.4130 - 12s/epoch - 27ms/step
Epoch 10/50
451/451 - 12s - loss: 3.1810 - accuracy50: 0.4311 - val_loss: 3.2395 - val_accuracy50: 0.4099 - 12s/epoch - 27ms/step
Epoch 11/50
451/451 - 12s - loss: 3.1765 - accuracy50: 0.4324 - val_loss: 3.2472 - val_accuracy50: 0.4085 - 12s/epoch - 27ms/step
Epoch 12/50
451/451 - 12s - loss: 3.1741 - accuracy50: 0.4338 - val_loss: 3.2377 - val_accuracy50: 0.4066 - 12s/epoch - 26ms/step
Epoch 13/50
451/451 - 12s - loss: 3.1720 - accuracy50: 0.4350 - val_loss: 3.2593 - val_accuracy50: 0.4054 - 12s/epoch - 27ms/step
Epoch 14/50
451/451 - 12s - loss: 3.1676 - accuracy50: 0.4364 - val_loss: 3.2510 - val_accuracy50: 0.4060 - 12s/epoch - 26ms/step
Epoch 15/50
451/451 - 11s - loss: 3.1644 - accuracy50: 0.4382 - val_loss: 3.2880 - val_accuracy50: 0.4003 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.1620 - accuracy50: 0.4385 - val_loss: 3.2619 - val_accuracy50: 0.4072 - 11s/epoch - 25ms/step
Epoch 17/50
451/451 - 12s - loss: 3.1590 - accuracy50: 0.4404 - val_loss: 3.2597 - val_accuracy50: 0.4070 - 12s/epoch - 26ms/step
Epoch 18/50
451/451 - 11s - loss: 3.1560 - accuracy50: 0.4406 - val_loss: 3.2723 - val_accuracy50: 0.4050 - 11s/epoch - 25ms/step
Epoch 19/50
451/451 - 12s - loss: 3.1541 - accuracy50: 0.4417 - val_loss: 3.2835 - val_accuracy50: 0.4035 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h50
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0685896
{'0': {'precision': 0.42469980369886484, 'recall': 0.47549008798429954, 'f1-score': 0.4486621076139879, 'support': 136047}, '1': {'precision': 0.41579280181272066, 'recall': 0.2243643058724844, 'f1-score': 0.29145677598681324, 'support': 140673}, '2': {'precision': 0.41730357199961626, 'recall': 0.5627574012980572, 'f1-score': 0.47923686409166444, 'support': 139131}, 'accuracy': 0.4197368769102395, 'macro avg': {'precision': 0.41926539250373396, 'recall': 0.42087059838494706, 'f1-score': 0.40645191589748847, 'support': 415851}, 'weighted avg': {'precision': 0.4192122136993754, 'recall': 0.4197368769102395, 'f1-score': 0.40571247139213457, 'support': 415851}}
[[64689 21208 50150]
 [49932 31562 59179]
 [37696 23138 78297]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.076156
{'0': {'precision': 0.4136208378836815, 'recall': 0.46487516974825027, 'f1-score': 0.4377528310934599, 'support': 38292}, '1': {'precision': 0.4074633630457773, 'recall': 0.21333649738965355, 'f1-score': 0.28004776491355593, 'support': 37926}, '2': {'precision': 0.40965826927467847, 'recall': 0.548786704730832, 'f1-score': 0.4691245042925001, 'support': 39232}, 'accuracy': 0.41075790385448246, 'macro avg': {'precision': 0.41024749006804573, 'recall': 0.4089994572895786, 'f1-score': 0.3956417000998386, 'support': 115450}, 'weighted avg': {'precision': 0.41025151885058697, 'recall': 0.41075790385448246, 'f1-score': 0.3966064572780048, 'support': 115450}}
[[17801  5856 14635]
 [13444  8091 16391]
 [11792  5910 21530]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764306
{'0': {'precision': 0.44148221483629163, 'recall': 0.4094307450157398, 'f1-score': 0.42485283609513763, 'support': 15248}, '1': {'precision': 0.39613128922728674, 'recall': 0.2588931477372066, 'f1-score': 0.313135420902806, 'support': 14871}, '2': {'precision': 0.40318863753938766, 'recall': 0.5713809650759797, 'f1-score': 0.4727713899688421, 'support': 15004}, 'accuracy': 0.41366930390266604, 'macro avg': {'precision': 0.41360071386765535, 'recall': 0.4132349526096421, 'f1-score': 0.4035865489889286, 'support': 45123}, 'weighted avg': {'precision': 0.41380297257637405, 'recall': 0.41366930390266604, 'f1-score': 0.4039681498153224, 'support': 45123}}
[[6243 3074 5931]
 [4262 3850 6759]
 [3636 2795 8573]]
training model: results/XRAY/W0/deepLOB_L1/h100
Epoch 1/50
451/451 - 14s - loss: 3.3273 - accuracy100: 0.3550 - val_loss: 3.3415 - val_accuracy100: 0.3565 - 14s/epoch - 32ms/step
Epoch 2/50
451/451 - 12s - loss: 3.2855 - accuracy100: 0.3707 - val_loss: 3.2908 - val_accuracy100: 0.3786 - 12s/epoch - 27ms/step
Epoch 3/50
451/451 - 13s - loss: 3.2695 - accuracy100: 0.3802 - val_loss: 3.2854 - val_accuracy100: 0.3727 - 13s/epoch - 28ms/step
Epoch 4/50
451/451 - 13s - loss: 3.2580 - accuracy100: 0.3877 - val_loss: 3.2890 - val_accuracy100: 0.3736 - 13s/epoch - 29ms/step
Epoch 5/50
451/451 - 12s - loss: 3.2552 - accuracy100: 0.3900 - val_loss: 3.2728 - val_accuracy100: 0.3822 - 12s/epoch - 28ms/step
Epoch 6/50
451/451 - 13s - loss: 3.2485 - accuracy100: 0.3933 - val_loss: 3.2779 - val_accuracy100: 0.3758 - 13s/epoch - 29ms/step
Epoch 7/50
451/451 - 13s - loss: 3.2457 - accuracy100: 0.3928 - val_loss: 3.2816 - val_accuracy100: 0.3724 - 13s/epoch - 29ms/step
Epoch 8/50
451/451 - 12s - loss: 3.2423 - accuracy100: 0.3943 - val_loss: 3.2729 - val_accuracy100: 0.3785 - 12s/epoch - 27ms/step
Epoch 9/50
451/451 - 12s - loss: 3.2382 - accuracy100: 0.3972 - val_loss: 3.2834 - val_accuracy100: 0.3746 - 12s/epoch - 26ms/step
Epoch 10/50
451/451 - 13s - loss: 3.2358 - accuracy100: 0.3984 - val_loss: 3.2957 - val_accuracy100: 0.3711 - 13s/epoch - 28ms/step
Epoch 11/50
451/451 - 13s - loss: 3.2339 - accuracy100: 0.4010 - val_loss: 3.2902 - val_accuracy100: 0.3758 - 13s/epoch - 28ms/step
Epoch 12/50
451/451 - 13s - loss: 3.2305 - accuracy100: 0.4031 - val_loss: 3.2873 - val_accuracy100: 0.3744 - 13s/epoch - 28ms/step
Epoch 13/50
451/451 - 13s - loss: 3.2284 - accuracy100: 0.4039 - val_loss: 3.2890 - val_accuracy100: 0.3739 - 13s/epoch - 29ms/step
Epoch 14/50
451/451 - 13s - loss: 3.2251 - accuracy100: 0.4053 - val_loss: 3.3002 - val_accuracy100: 0.3737 - 13s/epoch - 28ms/step
Epoch 15/50
451/451 - 12s - loss: 3.2218 - accuracy100: 0.4071 - val_loss: 3.2997 - val_accuracy100: 0.3733 - 12s/epoch - 27ms/step
testing model: results/XRAY/W0/deepLOB_L1/h100
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897561
{'0': {'precision': 0.3808328119340073, 'recall': 0.3383905254456742, 'f1-score': 0.35835938196001876, 'support': 136703}, '1': {'precision': 0.3916875, 'recall': 0.18197788795888292, 'f1-score': 0.24850188101292175, 'support': 137753}, '2': {'precision': 0.37761032715087484, 'recall': 0.615262208706107, 'f1-score': 0.4679943407087025, 'support': 141395}, 'accuracy': 0.380718093740306, 'macro avg': {'precision': 0.38337687969496076, 'recall': 0.3785435407035547, 'f1-score': 0.35828520122721436, 'support': 415851}, 'weighted avg': {'precision': 0.38333280017316906, 'recall': 0.380718093740306, 'f1-score': 0.35924584048555963, 'support': 415851}}
[[46259 19584 70860]
 [40157 25068 72528]
 [35052 19348 86995]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090743
{'0': {'precision': 0.37465292029842817, 'recall': 0.40767694813724975, 'f1-score': 0.390467922344267, 'support': 38062}, '1': {'precision': 0.39717075420927195, 'recall': 0.13559055118110236, 'f1-score': 0.20216408711135458, 'support': 38100}, '2': {'precision': 0.3717268049683741, 'recall': 0.5774027692934229, 'f1-score': 0.4522798412983232, 'support': 39288}, 'accuracy': 0.37564313555651796, 'macro avg': {'precision': 0.38118349315869143, 'recall': 0.37355675620392503, 'f1-score': 0.348303950251315, 'support': 115450}, 'weighted avg': {'precision': 0.38108833175720674, 'recall': 0.37564313555651796, 'f1-score': 0.3493600015949642, 'support': 115450}}
[[15517  4035 18510]
 [13103  5166 19831]
 [12797  3806 22685]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0902286
{'0': {'precision': 0.4039905925195357, 'recall': 0.34970775595980824, 'f1-score': 0.3748943959448043, 'support': 15227}, '1': {'precision': 0.3814935064935065, 'recall': 0.15716960941680042, 'f1-score': 0.22262220538082605, 'support': 14952}, '2': {'precision': 0.3697540920021721, 'recall': 0.6379148822269807, 'f1-score': 0.46815302263910036, 'support': 14944}, 'accuracy': 0.3813576224985041, 'macro avg': {'precision': 0.38507939700507143, 'recall': 0.38159741586786317, 'f1-score': 0.3552232079882436, 'support': 45123}, 'weighted avg': {'precision': 0.38519736746817224, 'recall': 0.3813576224985041, 'f1-score': 0.3553230714319607, 'support': 45123}}
[[5325 2027 7875]
 [4228 2350 8374]
 [3628 1783 9533]]
training model: results/XRAY/W0/deepLOB_L1/h200
Epoch 1/50
451/451 - 14s - loss: 3.3239 - accuracy200: 0.3587 - val_loss: 3.3592 - val_accuracy200: 0.3336 - 14s/epoch - 32ms/step
Epoch 2/50
451/451 - 12s - loss: 3.2972 - accuracy200: 0.3703 - val_loss: 3.3565 - val_accuracy200: 0.3370 - 12s/epoch - 27ms/step
Epoch 3/50
451/451 - 12s - loss: 3.2833 - accuracy200: 0.3738 - val_loss: 3.3170 - val_accuracy200: 0.3465 - 12s/epoch - 28ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2728 - accuracy200: 0.3829 - val_loss: 3.3263 - val_accuracy200: 0.3502 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 12s - loss: 3.2644 - accuracy200: 0.3871 - val_loss: 3.3182 - val_accuracy200: 0.3569 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 12s - loss: 3.2588 - accuracy200: 0.3914 - val_loss: 3.3536 - val_accuracy200: 0.3363 - 12s/epoch - 26ms/step
Epoch 7/50
451/451 - 12s - loss: 3.2500 - accuracy200: 0.3971 - val_loss: 3.3487 - val_accuracy200: 0.3447 - 12s/epoch - 26ms/step
Epoch 8/50
451/451 - 12s - loss: 3.2439 - accuracy200: 0.3990 - val_loss: 3.3674 - val_accuracy200: 0.3368 - 12s/epoch - 26ms/step
Epoch 9/50
451/451 - 12s - loss: 3.2404 - accuracy200: 0.4029 - val_loss: 3.3821 - val_accuracy200: 0.3373 - 12s/epoch - 27ms/step
Epoch 10/50
451/451 - 12s - loss: 3.2352 - accuracy200: 0.4062 - val_loss: 3.3858 - val_accuracy200: 0.3468 - 12s/epoch - 26ms/step
Epoch 11/50
451/451 - 12s - loss: 3.2335 - accuracy200: 0.4078 - val_loss: 3.3936 - val_accuracy200: 0.3354 - 12s/epoch - 26ms/step
Epoch 12/50
451/451 - 12s - loss: 3.2290 - accuracy200: 0.4078 - val_loss: 3.3859 - val_accuracy200: 0.3355 - 12s/epoch - 26ms/step
Epoch 13/50
451/451 - 12s - loss: 3.2248 - accuracy200: 0.4124 - val_loss: 3.3885 - val_accuracy200: 0.3338 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h200
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136914
{'0': {'precision': 0.23687163375224415, 'recall': 0.22025875969874603, 'f1-score': 0.2282633270748754, 'support': 105426}, '1': {'precision': 0.47848576929321984, 'recall': 0.21128210380764603, 'f1-score': 0.2931289899711177, 'support': 195265}, '2': {'precision': 0.28280159069418, 'recall': 0.5687391455366446, 'f1-score': 0.3777631021147374, 'support': 115160}, 'accuracy': 0.3125470420895946, 'macro avg': {'precision': 0.33271966457988134, 'recall': 0.3334266696810122, 'f1-score': 0.29971847305357685, 'support': 415851}, 'weighted avg': {'precision': 0.3630420121277727, 'recall': 0.3125470420895946, 'f1-score': 0.3001217277016029, 'support': 415851}}
[[ 23221  21122  61083]
 [ 48991  41256 105018]
 [ 25820  23844  65496]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1092687
{'0': {'precision': 0.334616523541605, 'recall': 0.2986336848225376, 'f1-score': 0.3156027873591309, 'support': 37839}, '1': {'precision': 0.3310303618777309, 'recall': 0.2329505137841318, 'f1-score': 0.27346208428456836, 'support': 38051}, '2': {'precision': 0.35677467533650253, 'recall': 0.49514661274014155, 'f1-score': 0.4147232249663889, 'support': 39560}, 'accuracy': 0.34432221741013425, 'macro avg': {'precision': 0.3408071869186127, 'recall': 0.3422436037822703, 'f1-score': 0.3345960322033627, 'support': 115450}, 'weighted avg': {'precision': 0.34102725933661643, 'recall': 0.34432221741013425, 'f1-score': 0.335678219312816, 'support': 115450}}
[[11300  8794 17745]
 [11617  8864 17570]
 [10853  9119 19588]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036093
{'0': {'precision': 0.36783042394014964, 'recall': 0.19986449864498645, 'f1-score': 0.2589991220368745, 'support': 14760}, '1': {'precision': 0.36639027994417533, 'recall': 0.27977683049147445, 'f1-score': 0.3172786407421889, 'support': 15952}, '2': {'precision': 0.33925848647781076, 'recall': 0.5867046006522795, 'f1-score': 0.4299188976177764, 'support': 14411}, 'accuracy': 0.351661015446668, 'macro avg': {'precision': 0.35782639678737854, 'recall': 0.3554486432629134, 'f1-score': 0.3353988867989466, 'support': 45123}, 'weighted avg': {'precision': 0.35819623809715273, 'recall': 0.351661015446668, 'f1-score': 0.3341891530251411, 'support': 45123}}
[[2950 4026 7784]
 [2806 4463 8683]
 [2264 3692 8455]]
training model: results/XRAY/W0/deepLOB_L1/h300
Epoch 1/50
451/451 - 15s - loss: 3.3223 - accuracy300: 0.3628 - val_loss: 3.3700 - val_accuracy300: 0.3442 - 15s/epoch - 33ms/step
Epoch 2/50
451/451 - 13s - loss: 3.2832 - accuracy300: 0.3758 - val_loss: 3.3749 - val_accuracy300: 0.3407 - 13s/epoch - 29ms/step
Epoch 3/50
451/451 - 12s - loss: 3.2658 - accuracy300: 0.3815 - val_loss: 3.4364 - val_accuracy300: 0.3314 - 12s/epoch - 28ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2533 - accuracy300: 0.3877 - val_loss: 3.4196 - val_accuracy300: 0.3303 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 13s - loss: 3.2455 - accuracy300: 0.3949 - val_loss: 3.4646 - val_accuracy300: 0.3369 - 13s/epoch - 28ms/step
Epoch 6/50
451/451 - 12s - loss: 3.2408 - accuracy300: 0.4004 - val_loss: 3.4320 - val_accuracy300: 0.3367 - 12s/epoch - 27ms/step
Epoch 7/50
451/451 - 12s - loss: 3.2333 - accuracy300: 0.4059 - val_loss: 3.4488 - val_accuracy300: 0.3372 - 12s/epoch - 27ms/step
Epoch 8/50
451/451 - 12s - loss: 3.2318 - accuracy300: 0.4065 - val_loss: 3.4565 - val_accuracy300: 0.3350 - 12s/epoch - 27ms/step
Epoch 9/50
451/451 - 12s - loss: 3.2284 - accuracy300: 0.4090 - val_loss: 3.4570 - val_accuracy300: 0.3414 - 12s/epoch - 26ms/step
Epoch 10/50
451/451 - 12s - loss: 3.2225 - accuracy300: 0.4114 - val_loss: 3.4652 - val_accuracy300: 0.3369 - 12s/epoch - 26ms/step
Epoch 11/50
451/451 - 12s - loss: 3.2167 - accuracy300: 0.4149 - val_loss: 3.4474 - val_accuracy300: 0.3349 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h300
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1277764
{'0': {'precision': 0.2721176560237751, 'recall': 0.09199577504701548, 'f1-score': 0.13750481324605315, 'support': 116451}, '1': {'precision': 0.41961222826601974, 'recall': 0.2529432934039381, 'f1-score': 0.3156262808061728, 'support': 175059}, '2': {'precision': 0.29400714507152453, 'recall': 0.6406816737841903, 'f1-score': 0.40305390630336185, 'support': 124341}, 'accuracy': 0.3238082871028325, 'macro avg': {'precision': 0.3285790097871064, 'recall': 0.3285402474117146, 'f1-score': 0.28539500011852925, 'support': 415851}, 'weighted avg': {'precision': 0.3407528481474957, 'recall': 0.3238082871028325, 'f1-score': 0.29188800763405703, 'support': 415851}}
[[ 10713  28623  77115]
 [ 16601  44280 114178]
 [ 12055  32623  79663]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1131793
{'0': {'precision': 0.3293243721259285, 'recall': 0.09939943947684506, 'f1-score': 0.1527074405921309, 'support': 37465}, '1': {'precision': 0.3702263892064944, 'recall': 0.3814098369238018, 'f1-score': 0.37573491490459004, 'support': 38203}, '2': {'precision': 0.35769082349309256, 'recall': 0.5824996229450505, 'f1-score': 0.44321822372258934, 'support': 39782}, 'accuracy': 0.3591857947163274, 'macro avg': {'precision': 0.35241386160850513, 'recall': 0.3544362997818991, 'f1-score': 0.3238868597397701, 'support': 115450}, 'weighted avg': {'precision': 0.3526336309117005, 'recall': 0.3591857947163274, 'f1-score': 0.3266131883240908, 'support': 115450}}
[[ 3724 11942 21799]
 [ 3819 14571 19813]
 [ 3765 12844 23173]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1212152
{'0': {'precision': 0.3445561871447311, 'recall': 0.10196027689719868, 'f1-score': 0.15735609804802556, 'support': 15457}, '1': {'precision': 0.34933786559025565, 'recall': 0.33367153679653677, 'f1-score': 0.3413250302715793, 'support': 14784}, '2': {'precision': 0.3363478129256849, 'recall': 0.5972987501679882, 'f1-score': 0.43035584604212057, 'support': 14882}, 'accuracy': 0.34124504133147177, 'macro avg': {'precision': 0.34341395522022383, 'recall': 0.3443101879539079, 'f1-score': 0.3096789914539085, 'support': 45123}, 'weighted avg': {'precision': 0.3434156448273052, 'recall': 0.34124504133147177, 'f1-score': 0.30766921871024083, 'support': 45123}}
[[1576 4669 9212]
 [1524 4933 8327]
 [1474 4519 8889]]
training model: results/XRAY/W0/deepLOB_L1/h500
Epoch 1/50
451/451 - 15s - loss: 3.3305 - accuracy500: 0.3583 - val_loss: 3.4187 - val_accuracy500: 0.3351 - 15s/epoch - 32ms/step
Epoch 2/50
451/451 - 13s - loss: 3.2962 - accuracy500: 0.3732 - val_loss: 3.4504 - val_accuracy500: 0.3310 - 13s/epoch - 29ms/step
Epoch 3/50
451/451 - 13s - loss: 3.2614 - accuracy500: 0.3929 - val_loss: 3.5161 - val_accuracy500: 0.3307 - 13s/epoch - 28ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2429 - accuracy500: 0.4022 - val_loss: 3.4950 - val_accuracy500: 0.3343 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 12s - loss: 3.2280 - accuracy500: 0.4117 - val_loss: 3.4617 - val_accuracy500: 0.3336 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 12s - loss: 3.2210 - accuracy500: 0.4170 - val_loss: 3.4787 - val_accuracy500: 0.3343 - 12s/epoch - 27ms/step
Epoch 7/50
451/451 - 12s - loss: 3.2106 - accuracy500: 0.4228 - val_loss: 3.4989 - val_accuracy500: 0.3333 - 12s/epoch - 27ms/step
Epoch 8/50
451/451 - 12s - loss: 3.1971 - accuracy500: 0.4289 - val_loss: 3.5031 - val_accuracy500: 0.3346 - 12s/epoch - 26ms/step
Epoch 9/50
451/451 - 11s - loss: 3.1866 - accuracy500: 0.4350 - val_loss: 3.5242 - val_accuracy500: 0.3370 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 11s - loss: 3.1789 - accuracy500: 0.4379 - val_loss: 3.5186 - val_accuracy500: 0.3379 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 12s - loss: 3.1714 - accuracy500: 0.4415 - val_loss: 3.5161 - val_accuracy500: 0.3400 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h500
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1244115
{'0': {'precision': 0.30119896305897603, 'recall': 0.058628737227198184, 'f1-score': 0.0981520591341077, 'support': 126832}, '1': {'precision': 0.3672612933129557, 'recall': 0.18977124140698834, 'f1-score': 0.25023899757588175, 'support': 154486}, '2': {'precision': 0.3198367042786434, 'recall': 0.740167839860852, 'f1-score': 0.44666382577881447, 'support': 134533}, 'accuracy': 0.327833767383029, 'macro avg': {'precision': 0.32943232021685837, 'recall': 0.32952260616501283, 'f1-score': 0.26501829416293465, 'support': 415851}, 'weighted avg': {'precision': 0.3317702407308388, 'recall': 0.327833767383029, 'f1-score': 0.267399304599739, 'support': 415851}}
[[  7436  24695  94701]
 [  8110  29317 117059]
 [  9142  25814  99577]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1190348
{'0': {'precision': 0.3444123314065511, 'recall': 0.09635079775765416, 'f1-score': 0.15057703647544435, 'support': 37104}, '1': {'precision': 0.3313854779484345, 'recall': 0.22238414456426697, 'f1-score': 0.26615716369632775, 'support': 37741}, '2': {'precision': 0.35838882409741296, 'recall': 0.7038295776382218, 'f1-score': 0.4749393425732044, 'support': 40605}, 'accuracy': 0.35120831528800345, 'macro avg': {'precision': 0.3447288778174662, 'recall': 0.34085483998671434, 'f1-score': 0.29722451424832547, 'support': 115450}, 'weighted avg': {'precision': 0.34506949043080115, 'recall': 0.35120831528800345, 'f1-score': 0.30244226835541754, 'support': 115450}}
[[ 3575  8124 25405]
 [ 3589  8393 25759]
 [ 3216  8810 28579]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1308616
{'0': {'precision': 0.36981566820276496, 'recall': 0.0423874290241648, 'f1-score': 0.07605733917782254, 'support': 15146}, '1': {'precision': 0.33258279388310347, 'recall': 0.23548558522651786, 'f1-score': 0.27573600902267337, 'support': 15054}, '2': {'precision': 0.33335370325103886, 'recall': 0.7310862427125913, 'f1-score': 0.45791274055109016, 'support': 14923}, 'accuracy': 0.33457438556833546, 'macro avg': {'precision': 0.3452507217789691, 'recall': 0.3363197523210913, 'f1-score': 0.26990202958386206, 'support': 45123}, 'weighted avg': {'precision': 0.3453353456846967, 'recall': 0.33457438556833546, 'f1-score': 0.26896097702410177, 'support': 45123}}
[[  642  3672 10832]
 [  523  3545 10986]
 [  571  3442 10910]]
training model: results/XRAY/W0/deepLOB_L1/h1000
Epoch 1/50
451/451 - 14s - loss: 3.3049 - accuracy1000: 0.3845 - val_loss: 3.5506 - val_accuracy1000: 0.3362 - 14s/epoch - 32ms/step
Epoch 2/50
451/451 - 12s - loss: 3.2701 - accuracy1000: 0.3966 - val_loss: 3.5431 - val_accuracy1000: 0.3347 - 12s/epoch - 27ms/step
Epoch 3/50
451/451 - 12s - loss: 3.2383 - accuracy1000: 0.4096 - val_loss: 3.6313 - val_accuracy1000: 0.3403 - 12s/epoch - 26ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2179 - accuracy1000: 0.4214 - val_loss: 3.5012 - val_accuracy1000: 0.3431 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2022 - accuracy1000: 0.4250 - val_loss: 3.5791 - val_accuracy1000: 0.3402 - 11s/epoch - 25ms/step
Epoch 6/50
451/451 - 12s - loss: 3.1825 - accuracy1000: 0.4332 - val_loss: 3.6476 - val_accuracy1000: 0.3413 - 12s/epoch - 27ms/step
Epoch 7/50
451/451 - 12s - loss: 3.1679 - accuracy1000: 0.4402 - val_loss: 3.6568 - val_accuracy1000: 0.3417 - 12s/epoch - 26ms/step
Epoch 8/50
451/451 - 12s - loss: 3.1526 - accuracy1000: 0.4434 - val_loss: 3.6571 - val_accuracy1000: 0.3399 - 12s/epoch - 26ms/step
Epoch 9/50
451/451 - 12s - loss: 3.1403 - accuracy1000: 0.4504 - val_loss: 3.6942 - val_accuracy1000: 0.3410 - 12s/epoch - 26ms/step
Epoch 10/50
451/451 - 12s - loss: 3.1288 - accuracy1000: 0.4529 - val_loss: 3.6863 - val_accuracy1000: 0.3410 - 12s/epoch - 27ms/step
Epoch 11/50
451/451 - 12s - loss: 3.1229 - accuracy1000: 0.4545 - val_loss: 3.6571 - val_accuracy1000: 0.3422 - 12s/epoch - 27ms/step
Epoch 12/50
451/451 - 12s - loss: 3.1198 - accuracy1000: 0.4580 - val_loss: 3.5712 - val_accuracy1000: 0.3447 - 12s/epoch - 27ms/step
Epoch 13/50
451/451 - 12s - loss: 3.1029 - accuracy1000: 0.4633 - val_loss: 3.5538 - val_accuracy1000: 0.3461 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 12s - loss: 3.0992 - accuracy1000: 0.4629 - val_loss: 3.5637 - val_accuracy1000: 0.3412 - 12s/epoch - 26ms/step
testing model: results/XRAY/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1604075
{'0': {'precision': 0.2645138382025132, 'recall': 0.116677108349866, 'f1-score': 0.16192782141929873, 'support': 114924}, '1': {'precision': 0.4166607836216025, 'recall': 0.09942387385869748, 'f1-score': 0.160539665701035, 'support': 178086}, '2': {'precision': 0.28444538109420664, 'recall': 0.7471446829641569, 'f1-score': 0.4120277259014509, 'support': 122841}, 'accuracy': 0.29552652272087837, 'macro avg': {'precision': 0.3218733343061075, 'recall': 0.3210818883909068, 'f1-score': 0.2448317376739282, 'support': 415851}, 'weighted avg': {'precision': 0.3355576774195944, 'recall': 0.29552652272087837, 'f1-score': 0.23521202962668394, 'support': 415851}}
[[ 13409  11957  89558]
 [ 19055  17706 141325]
 [ 18229  12832  91780]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1444856
{'0': {'precision': 0.36156184241290623, 'recall': 0.20658330661536817, 'f1-score': 0.2629350653767024, 'support': 37428}, '1': {'precision': 0.3314782213640752, 'recall': 0.15972089205089615, 'f1-score': 0.2155704103113343, 'support': 36545}, '2': {'precision': 0.37319504028460815, 'recall': 0.6879234274417146, 'f1-score': 0.4838849177075119, 'support': 41477}, 'accuracy': 0.3646773495019489, 'macro avg': {'precision': 0.35541170135386313, 'recall': 0.3514092087026596, 'f1-score': 0.3207967977985162, 'support': 115450}, 'weighted avg': {'precision': 0.35621844022057236, 'recall': 0.3646773495019489, 'f1-score': 0.32732134260287055, 'support': 115450}}
[[ 7732  5156 24540]
 [ 7325  5837 23383]
 [ 6328  6616 28533]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1540378
{'0': {'precision': 0.422648238965671, 'recall': 0.06120077469335055, 'f1-score': 0.10691930299441718, 'support': 15490}, '1': {'precision': 0.33550065019505854, 'recall': 0.17547439298102427, 'f1-score': 0.2304291519671326, 'support': 14703}, '2': {'precision': 0.33989769820971866, 'recall': 0.8011386470194239, 'f1-score': 0.4772944932162809, 'support': 14930}, 'accuracy': 0.3432617512133502, 'macro avg': {'precision': 0.36601552912348273, 'recall': 0.34593793823126623, 'f1-score': 0.2715476493926102, 'support': 45123}, 'weighted avg': {'precision': 0.36687188164943135, 'recall': 0.3432617512133502, 'f1-score': 0.2697113801935897, 'support': 45123}}
[[  948  2919 11623]
 [  517  2580 11606]
 [  778  2191 11961]]
training model: results/XRAY/W0/deepOF_L1/h10
Epoch 1/50
451/451 - 13s - loss: 3.2648 - accuracy10: 0.3722 - val_loss: 3.2352 - val_accuracy10: 0.3377 - 13s/epoch - 30ms/step
Epoch 2/50
451/451 - 11s - loss: 3.2185 - accuracy10: 0.3873 - val_loss: 3.2214 - val_accuracy10: 0.3412 - 11s/epoch - 25ms/step
Epoch 3/50
451/451 - 11s - loss: 3.2026 - accuracy10: 0.3944 - val_loss: 3.2085 - val_accuracy10: 0.3457 - 11s/epoch - 25ms/step
Epoch 4/50
451/451 - 10s - loss: 3.1909 - accuracy10: 0.4001 - val_loss: 3.2083 - val_accuracy10: 0.3443 - 10s/epoch - 23ms/step
Epoch 5/50
451/451 - 11s - loss: 3.1832 - accuracy10: 0.4046 - val_loss: 3.1996 - val_accuracy10: 0.3526 - 11s/epoch - 24ms/step
Epoch 6/50
451/451 - 11s - loss: 3.1757 - accuracy10: 0.4060 - val_loss: 3.1982 - val_accuracy10: 0.3558 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.1704 - accuracy10: 0.4098 - val_loss: 3.1973 - val_accuracy10: 0.3592 - 11s/epoch - 24ms/step
Epoch 8/50
451/451 - 11s - loss: 3.1659 - accuracy10: 0.4152 - val_loss: 3.1925 - val_accuracy10: 0.3662 - 11s/epoch - 24ms/step
Epoch 9/50
451/451 - 11s - loss: 3.1606 - accuracy10: 0.4167 - val_loss: 3.1940 - val_accuracy10: 0.3650 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 11s - loss: 3.1571 - accuracy10: 0.4198 - val_loss: 3.1931 - val_accuracy10: 0.3653 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 11s - loss: 3.1514 - accuracy10: 0.4217 - val_loss: 3.1906 - val_accuracy10: 0.3703 - 11s/epoch - 24ms/step
Epoch 12/50
451/451 - 11s - loss: 3.1475 - accuracy10: 0.4257 - val_loss: 3.1930 - val_accuracy10: 0.3693 - 11s/epoch - 25ms/step
Epoch 13/50
451/451 - 11s - loss: 3.1412 - accuracy10: 0.4265 - val_loss: 3.1906 - val_accuracy10: 0.3713 - 11s/epoch - 25ms/step
Epoch 14/50
451/451 - 11s - loss: 3.1400 - accuracy10: 0.4294 - val_loss: 3.1923 - val_accuracy10: 0.3714 - 11s/epoch - 24ms/step
Epoch 15/50
451/451 - 11s - loss: 3.1357 - accuracy10: 0.4308 - val_loss: 3.1902 - val_accuracy10: 0.3750 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.1305 - accuracy10: 0.4344 - val_loss: 3.1900 - val_accuracy10: 0.3749 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.1264 - accuracy10: 0.4350 - val_loss: 3.1951 - val_accuracy10: 0.3752 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.1224 - accuracy10: 0.4367 - val_loss: 3.1888 - val_accuracy10: 0.3779 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.1190 - accuracy10: 0.4394 - val_loss: 3.1927 - val_accuracy10: 0.3781 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.1162 - accuracy10: 0.4395 - val_loss: 3.1920 - val_accuracy10: 0.3811 - 11s/epoch - 25ms/step
Epoch 21/50
451/451 - 11s - loss: 3.1124 - accuracy10: 0.4411 - val_loss: 3.1929 - val_accuracy10: 0.3770 - 11s/epoch - 25ms/step
Epoch 22/50
451/451 - 11s - loss: 3.1086 - accuracy10: 0.4411 - val_loss: 3.1935 - val_accuracy10: 0.3792 - 11s/epoch - 25ms/step
Epoch 23/50
451/451 - 11s - loss: 3.1062 - accuracy10: 0.4443 - val_loss: 3.1946 - val_accuracy10: 0.3846 - 11s/epoch - 24ms/step
Epoch 24/50
451/451 - 11s - loss: 3.1004 - accuracy10: 0.4449 - val_loss: 3.1907 - val_accuracy10: 0.3843 - 11s/epoch - 24ms/step
Epoch 25/50
451/451 - 11s - loss: 3.0959 - accuracy10: 0.4473 - val_loss: 3.1927 - val_accuracy10: 0.3826 - 11s/epoch - 25ms/step
Epoch 26/50
451/451 - 11s - loss: 3.0899 - accuracy10: 0.4493 - val_loss: 3.1948 - val_accuracy10: 0.3777 - 11s/epoch - 24ms/step
Epoch 27/50
451/451 - 11s - loss: 3.0848 - accuracy10: 0.4513 - val_loss: 3.1983 - val_accuracy10: 0.3793 - 11s/epoch - 24ms/step
Epoch 28/50
451/451 - 11s - loss: 3.0839 - accuracy10: 0.4533 - val_loss: 3.1986 - val_accuracy10: 0.3803 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h10
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0716012
{'0': {'precision': 0.3335650430818474, 'recall': 0.5794277049226363, 'f1-score': 0.4233918128654971, 'support': 106833}, '1': {'precision': 0.5772540914173415, 'recall': 0.17145890783196796, 'f1-score': 0.2643879728419011, 'support': 198724}, '2': {'precision': 0.3506887872788961, 'recall': 0.5445057984023792, 'f1-score': 0.42661580211130534, 'support': 110289}, 'accuracy': 0.3752062061436205, 'macro avg': {'precision': 0.420502640592695, 'recall': 0.43179747038566113, 'f1-score': 0.37146519593956784, 'support': 415846}, 'weighted avg': {'precision': 0.4545603708358021, 'recall': 0.3752062061436205, 'f1-score': 0.348262297239717, 'support': 415846}}
[[61902 11593 33338]
 [86799 34073 77852]
 [36876 13360 60053]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621097
{'0': {'precision': 0.3501208239039546, 'recall': 0.589835546508998, 'f1-score': 0.4394112620798382, 'support': 30951}, '1': {'precision': 0.5825576803745699, 'recall': 0.19484538027584386, 'f1-score': 0.29202013346906464, 'support': 53001}, '2': {'precision': 0.3606924241426973, 'recall': 0.5219710439420879, 'f1-score': 0.4265974699967564, 'support': 31496}, 'accuracy': 0.3899851015175663, 'macro avg': {'precision': 0.43112364280707394, 'recall': 0.43555065690897665, 'f1-score': 0.38600962184855314, 'support': 115448}, 'weighted avg': {'precision': 0.4597143114560865, 'recall': 0.3899851015175663, 'f1-score': 0.3682496966742153, 'support': 115448}}
[[18256  3589  9106]
 [22641 10327 20033]
 [11245  3811 16440]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0723746
{'0': {'precision': 0.34410948036493455, 'recall': 0.5811908550372665, 'f1-score': 0.4322775545797128, 'support': 11941}, '1': {'precision': 0.5370549937664496, 'recall': 0.1873399371828944, 'f1-score': 0.2777817582575052, 'support': 20695}, '2': {'precision': 0.35464591790708166, 'recall': 0.5037238728277409, 'f1-score': 0.41623928795950105, 'support': 12487}, 'accuracy': 0.3791192961460896, 'macro avg': {'precision': 0.41193679734615535, 'recall': 0.42408488834930064, 'f1-score': 0.3754328669322396, 'support': 45123}, 'weighted avg': {'precision': 0.43551687560534724, 'recall': 0.3791192961460896, 'f1-score': 0.3569820214774219, 'support': 45123}}
[[6940 1563 3438]
 [8810 3877 8008]
 [4418 1779 6290]]
training model: results/XRAY/W0/deepOF_L1/h20
Epoch 1/50
451/451 - 13s - loss: 3.2944 - accuracy20: 0.3725 - val_loss: 3.2757 - val_accuracy20: 0.3839 - 13s/epoch - 28ms/step
Epoch 2/50
451/451 - 11s - loss: 3.2531 - accuracy20: 0.3941 - val_loss: 3.2571 - val_accuracy20: 0.3926 - 11s/epoch - 24ms/step
Epoch 3/50
451/451 - 11s - loss: 3.2359 - accuracy20: 0.4008 - val_loss: 3.2477 - val_accuracy20: 0.3938 - 11s/epoch - 25ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2263 - accuracy20: 0.4068 - val_loss: 3.2419 - val_accuracy20: 0.3984 - 11s/epoch - 25ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2208 - accuracy20: 0.4067 - val_loss: 3.2380 - val_accuracy20: 0.4002 - 11s/epoch - 24ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2147 - accuracy20: 0.4100 - val_loss: 3.2371 - val_accuracy20: 0.4007 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2085 - accuracy20: 0.4139 - val_loss: 3.2368 - val_accuracy20: 0.4005 - 11s/epoch - 24ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2057 - accuracy20: 0.4151 - val_loss: 3.2346 - val_accuracy20: 0.4031 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 10s - loss: 3.2000 - accuracy20: 0.4171 - val_loss: 3.2365 - val_accuracy20: 0.4019 - 10s/epoch - 23ms/step
Epoch 10/50
451/451 - 11s - loss: 3.1966 - accuracy20: 0.4171 - val_loss: 3.2347 - val_accuracy20: 0.4009 - 11s/epoch - 24ms/step
Epoch 11/50
451/451 - 11s - loss: 3.1932 - accuracy20: 0.4201 - val_loss: 3.2334 - val_accuracy20: 0.4030 - 11s/epoch - 24ms/step
Epoch 12/50
451/451 - 11s - loss: 3.1885 - accuracy20: 0.4221 - val_loss: 3.2334 - val_accuracy20: 0.4034 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 11s - loss: 3.1865 - accuracy20: 0.4229 - val_loss: 3.2318 - val_accuracy20: 0.4066 - 11s/epoch - 24ms/step
Epoch 14/50
451/451 - 11s - loss: 3.1830 - accuracy20: 0.4231 - val_loss: 3.2332 - val_accuracy20: 0.4058 - 11s/epoch - 24ms/step
Epoch 15/50
451/451 - 11s - loss: 3.1783 - accuracy20: 0.4269 - val_loss: 3.2338 - val_accuracy20: 0.4058 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.1747 - accuracy20: 0.4286 - val_loss: 3.2349 - val_accuracy20: 0.4046 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.1725 - accuracy20: 0.4285 - val_loss: 3.2366 - val_accuracy20: 0.4046 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.1700 - accuracy20: 0.4301 - val_loss: 3.2373 - val_accuracy20: 0.4026 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.1657 - accuracy20: 0.4327 - val_loss: 3.2360 - val_accuracy20: 0.4046 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.1617 - accuracy20: 0.4337 - val_loss: 3.2365 - val_accuracy20: 0.4061 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.1590 - accuracy20: 0.4363 - val_loss: 3.2353 - val_accuracy20: 0.4042 - 11s/epoch - 24ms/step
Epoch 22/50
451/451 - 11s - loss: 3.1576 - accuracy20: 0.4380 - val_loss: 3.2367 - val_accuracy20: 0.4067 - 11s/epoch - 24ms/step
Epoch 23/50
451/451 - 11s - loss: 3.1528 - accuracy20: 0.4379 - val_loss: 3.2402 - val_accuracy20: 0.4035 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h20
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0734339
{'0': {'precision': 0.39698727243434834, 'recall': 0.5544737888254664, 'f1-score': 0.46269689012959625, 'support': 133321}, '1': {'precision': 0.4477392025048347, 'recall': 0.1338149791860185, 'f1-score': 0.2060485985665171, 'support': 145335}, '2': {'precision': 0.40793233082706765, 'recall': 0.5536628034113273, 'f1-score': 0.4697547852438232, 'support': 137190}, 'accuracy': 0.40718919984802066, 'macro avg': {'precision': 0.41755293525541687, 'recall': 0.4139838571409374, 'f1-score': 0.3795000913133122, 'support': 415846}, 'weighted avg': {'precision': 0.418335522309762, 'recall': 0.40718919984802066, 'f1-score': 0.3753287133920556, 'support': 415846}}
[[73923 11415 47983]
 [63627 19448 62260]
 [48660 12573 75957]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0701853
{'0': {'precision': 0.40370928262097533, 'recall': 0.565173840841395, 'f1-score': 0.47098751194438043, 'support': 37937}, '1': {'precision': 0.4527180289401643, 'recall': 0.1492406466750896, 'f1-score': 0.22448029785913745, 'support': 38783}, '2': {'precision': 0.40879462393800575, 'recall': 0.5230582524271845, 'f1-score': 0.45892094561683716, 'support': 38728}, 'accuracy': 0.4113193818862172, 'macro avg': {'precision': 0.4217406451663818, 'recall': 0.4124909133145564, 'f1-score': 0.38479625180678506, 'support': 115448}, 'weighted avg': {'precision': 0.4218789460800483, 'recall': 0.4113193818862172, 'f1-score': 0.3841293310785268, 'support': 115448}}
[[21441  3403 13093]
 [16792  5788 16203]
 [14877  3594 20257]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777857
{'0': {'precision': 0.4011937961739811, 'recall': 0.5515200430454668, 'f1-score': 0.4644971252159628, 'support': 14868}, '1': {'precision': 0.3963098212569671, 'recall': 0.13788030758943498, 'f1-score': 0.2045837880742137, 'support': 14955}, '2': {'precision': 0.407884605513064, 'recall': 0.5193464052287582, 'f1-score': 0.45691613237112216, 'support': 15300}, 'accuracy': 0.4035192695521131, 'macro avg': {'precision': 0.40179607431467074, 'recall': 0.4029155852878867, 'f1-score': 0.37533234855376624, 'support': 45123}, 'weighted avg': {'precision': 0.4018437870434717, 'recall': 0.4035192695521131, 'f1-score': 0.3757842039234752, 'support': 45123}}
[[8200 1510 5158]
 [6516 2062 6377]
 [5723 1631 7946]]
training model: results/XRAY/W0/deepOF_L1/h30
Epoch 1/50
451/451 - 14s - loss: 3.3012 - accuracy30: 0.3706 - val_loss: 3.2897 - val_accuracy30: 0.3848 - 14s/epoch - 31ms/step
Epoch 2/50
451/451 - 11s - loss: 3.2639 - accuracy30: 0.3901 - val_loss: 3.2712 - val_accuracy30: 0.3946 - 11s/epoch - 25ms/step
Epoch 3/50
451/451 - 11s - loss: 3.2501 - accuracy30: 0.3959 - val_loss: 3.2637 - val_accuracy30: 0.3975 - 11s/epoch - 25ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2436 - accuracy30: 0.3973 - val_loss: 3.2589 - val_accuracy30: 0.3994 - 11s/epoch - 24ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2372 - accuracy30: 0.4001 - val_loss: 3.2521 - val_accuracy30: 0.4000 - 11s/epoch - 25ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2327 - accuracy30: 0.4017 - val_loss: 3.2504 - val_accuracy30: 0.4007 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2278 - accuracy30: 0.4029 - val_loss: 3.2511 - val_accuracy30: 0.3994 - 11s/epoch - 25ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2254 - accuracy30: 0.4045 - val_loss: 3.2485 - val_accuracy30: 0.4024 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 11s - loss: 3.2215 - accuracy30: 0.4075 - val_loss: 3.2482 - val_accuracy30: 0.4031 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 10s - loss: 3.2176 - accuracy30: 0.4102 - val_loss: 3.2481 - val_accuracy30: 0.4012 - 10s/epoch - 23ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2144 - accuracy30: 0.4097 - val_loss: 3.2453 - val_accuracy30: 0.4025 - 11s/epoch - 24ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2100 - accuracy30: 0.4151 - val_loss: 3.2467 - val_accuracy30: 0.4021 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2070 - accuracy30: 0.4157 - val_loss: 3.2482 - val_accuracy30: 0.4023 - 11s/epoch - 25ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2041 - accuracy30: 0.4173 - val_loss: 3.2482 - val_accuracy30: 0.4023 - 11s/epoch - 24ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2006 - accuracy30: 0.4170 - val_loss: 3.2450 - val_accuracy30: 0.4047 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.1995 - accuracy30: 0.4197 - val_loss: 3.2462 - val_accuracy30: 0.4045 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 10s - loss: 3.1962 - accuracy30: 0.4200 - val_loss: 3.2486 - val_accuracy30: 0.4036 - 10s/epoch - 23ms/step
Epoch 18/50
451/451 - 11s - loss: 3.1934 - accuracy30: 0.4225 - val_loss: 3.2490 - val_accuracy30: 0.4025 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.1901 - accuracy30: 0.4218 - val_loss: 3.2512 - val_accuracy30: 0.4023 - 11s/epoch - 25ms/step
Epoch 20/50
451/451 - 11s - loss: 3.1877 - accuracy30: 0.4243 - val_loss: 3.2492 - val_accuracy30: 0.4037 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.1852 - accuracy30: 0.4243 - val_loss: 3.2497 - val_accuracy30: 0.4035 - 11s/epoch - 24ms/step
Epoch 22/50
451/451 - 11s - loss: 3.1822 - accuracy30: 0.4274 - val_loss: 3.2525 - val_accuracy30: 0.4023 - 11s/epoch - 24ms/step
Epoch 23/50
451/451 - 11s - loss: 3.1785 - accuracy30: 0.4282 - val_loss: 3.2514 - val_accuracy30: 0.4019 - 11s/epoch - 24ms/step
Epoch 24/50
451/451 - 11s - loss: 3.1758 - accuracy30: 0.4305 - val_loss: 3.2512 - val_accuracy30: 0.4030 - 11s/epoch - 24ms/step
Epoch 25/50
451/451 - 11s - loss: 3.1719 - accuracy30: 0.4318 - val_loss: 3.2543 - val_accuracy30: 0.4037 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h30
Evaluating performance on  test set...
1625/1625 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0766115
{'0': {'precision': 0.3946454461118182, 'recall': 0.6171179052034583, 'f1-score': 0.48142240116922147, 'support': 137178}, '1': {'precision': 0.44679583895815134, 'recall': 0.08091084922957456, 'f1-score': 0.13701031869235686, 'support': 139079}, '2': {'precision': 0.4138438044632162, 'recall': 0.5222402911404194, 'f1-score': 0.46176601000823464, 'support': 139589}, 'accuracy': 0.40593633219990094, 'macro avg': {'precision': 0.4184283631777286, 'recall': 0.40675634852448406, 'f1-score': 0.3600662432899377, 'support': 415846}, 'weighted avg': {'precision': 0.4185314619219702, 'recall': 0.40593633219990094, 'f1-score': 0.3596362014593028, 'support': 415846}}
[[84655  6726 45797]
 [70371 11253 57455]
 [59483  7207 72899]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0744159
{'0': {'precision': 0.3937279958273569, 'recall': 0.627119084088372, 'f1-score': 0.48374402979844, 'support': 38519}, '1': {'precision': 0.4618320610687023, 'recall': 0.08983401389404465, 'f1-score': 0.15041065482796892, 'support': 37714}, '2': {'precision': 0.41567579127459364, 'recall': 0.4956521739130435, 'f1-score': 0.4521546961325967, 'support': 39215}, 'accuracy': 0.4069451181484305, 'macro avg': {'precision': 0.4237452827235509, 'recall': 0.4042017572984868, 'f1-score': 0.36210312691966856, 'support': 115448}, 'weighted avg': {'precision': 0.423431061406453, 'recall': 0.4069451181484305, 'f1-score': 0.3641221167004012, 'support': 115448}}
[[24156  1963 12400]
 [19403  3388 14923]
 [17793  1985 19437]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0815281
{'0': {'precision': 0.397112067129531, 'recall': 0.6095057531380753, 'f1-score': 0.4809016583705156, 'support': 15296}, '1': {'precision': 0.3912332351979064, 'recall': 0.08203580492489197, 'f1-score': 0.13563166250850534, 'support': 14579}, '2': {'precision': 0.4124482220668137, 'recall': 0.5028200419727177, 'f1-score': 0.4531725625794249, 'support': 15248}, 'accuracy': 0.4030317133169337, 'macro avg': {'precision': 0.40026450813141706, 'recall': 0.3981205333452283, 'f1-score': 0.35656862781948195, 'support': 45123}, 'weighted avg': {'precision': 0.4003950536276037, 'recall': 0.4030317133169337, 'f1-score': 0.3599765310009968, 'support': 45123}}
[[9323  915 5058]
 [7519 1196 5864]
 [6635  946 7667]]
training model: results/XRAY/W0/deepOF_L1/h50
Epoch 1/50
451/451 - 13s - loss: 3.3099 - accuracy50: 0.3620 - val_loss: 3.3148 - val_accuracy50: 0.3776 - 13s/epoch - 28ms/step
Epoch 2/50
451/451 - 11s - loss: 3.2763 - accuracy50: 0.3794 - val_loss: 3.3014 - val_accuracy50: 0.3820 - 11s/epoch - 24ms/step
Epoch 3/50
451/451 - 11s - loss: 3.2677 - accuracy50: 0.3836 - val_loss: 3.2909 - val_accuracy50: 0.3845 - 11s/epoch - 24ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2591 - accuracy50: 0.3881 - val_loss: 3.2826 - val_accuracy50: 0.3848 - 11s/epoch - 24ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2549 - accuracy50: 0.3898 - val_loss: 3.2765 - val_accuracy50: 0.3884 - 11s/epoch - 24ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2516 - accuracy50: 0.3920 - val_loss: 3.2750 - val_accuracy50: 0.3883 - 11s/epoch - 24ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2472 - accuracy50: 0.3937 - val_loss: 3.2698 - val_accuracy50: 0.3896 - 11s/epoch - 24ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2442 - accuracy50: 0.3961 - val_loss: 3.2714 - val_accuracy50: 0.3890 - 11s/epoch - 24ms/step
Epoch 9/50
451/451 - 11s - loss: 3.2421 - accuracy50: 0.3965 - val_loss: 3.2704 - val_accuracy50: 0.3884 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2382 - accuracy50: 0.3995 - val_loss: 3.2694 - val_accuracy50: 0.3898 - 11s/epoch - 24ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2369 - accuracy50: 0.4022 - val_loss: 3.2665 - val_accuracy50: 0.3888 - 11s/epoch - 24ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2346 - accuracy50: 0.4024 - val_loss: 3.2672 - val_accuracy50: 0.3909 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2327 - accuracy50: 0.4024 - val_loss: 3.2674 - val_accuracy50: 0.3918 - 11s/epoch - 24ms/step
Epoch 14/50
451/451 - 10s - loss: 3.2292 - accuracy50: 0.4055 - val_loss: 3.2671 - val_accuracy50: 0.3924 - 10s/epoch - 22ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2275 - accuracy50: 0.4055 - val_loss: 3.2688 - val_accuracy50: 0.3919 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2261 - accuracy50: 0.4067 - val_loss: 3.2675 - val_accuracy50: 0.3929 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2235 - accuracy50: 0.4080 - val_loss: 3.2679 - val_accuracy50: 0.3926 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2220 - accuracy50: 0.4082 - val_loss: 3.2699 - val_accuracy50: 0.3933 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2205 - accuracy50: 0.4081 - val_loss: 3.2689 - val_accuracy50: 0.3932 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2176 - accuracy50: 0.4107 - val_loss: 3.2707 - val_accuracy50: 0.3906 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2152 - accuracy50: 0.4118 - val_loss: 3.2716 - val_accuracy50: 0.3919 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h50
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856915
{'0': {'precision': 0.3863279241529435, 'recall': 0.590951523392995, 'f1-score': 0.4672175924311633, 'support': 136045}, '1': {'precision': 0.4283735510680178, 'recall': 0.04177122505704801, 'f1-score': 0.07611990569215224, 'support': 140671}, '2': {'precision': 0.3952872295465556, 'recall': 0.5512542226694458, 'f1-score': 0.4604209439421772, 'support': 139130}, 'accuracy': 0.3918950765427586, 'macro avg': {'precision': 0.40332956825583893, 'recall': 0.39465899037316293, 'f1-score': 0.3345861473551643, 'support': 415846}, 'weighted avg': {'precision': 0.40354850230731715, 'recall': 0.3918950765427586, 'f1-score': 0.3326444081380931, 'support': 415846}}
[[80396  3531 52118]
 [69583  5876 65212]
 [58124  4310 76696]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831956
{'0': {'precision': 0.38498143773202836, 'recall': 0.5961327410504311, 'f1-score': 0.46783553778324616, 'support': 38270}, '1': {'precision': 0.45327754532775455, 'recall': 0.04280145393246589, 'f1-score': 0.07821713075497583, 'support': 37966}, '2': {'precision': 0.4030758701975172, 'recall': 0.5407273283688667, 'f1-score': 0.4618635299243043, 'support': 39212}, 'accuracy': 0.39534682281200195, 'macro avg': {'precision': 0.41377828441910003, 'recall': 0.39322050778392126, 'f1-score': 0.3359720661541754, 'support': 115448}, 'weighted avg': {'precision': 0.4135869476309967, 'recall': 0.39534682281200195, 'f1-score': 0.337678005271638, 'support': 115448}}
[[22814   956 14500]
 [19441  1625 16900]
 [17005  1004 21203]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884932
{'0': {'precision': 0.38927528765241287, 'recall': 0.5949475065616798, 'f1-score': 0.47062182082425, 'support': 15240}, '1': {'precision': 0.39633747547416615, 'recall': 0.040583980712563625, 'f1-score': 0.07362857663568434, 'support': 14932}, '2': {'precision': 0.38843463698157815, 'recall': 0.5274563574342853, 'f1-score': 0.447394547981732, 'support': 14951}, 'accuracy': 0.38913636061432083, 'macro avg': {'precision': 0.3913491333693857, 'recall': 0.3876626149028429, 'f1-score': 0.33054831514722216, 'support': 45123}, 'weighted avg': {'precision': 0.3913337505288787, 'recall': 0.38913636061432083, 'f1-score': 0.33155362769675073, 'support': 45123}}
[[9067  421 5752]
 [7662  606 6664]
 [6563  502 7886]]
training model: results/XRAY/W0/deepOF_L1/h100
Epoch 1/50
451/451 - 13s - loss: 3.3206 - accuracy100: 0.3519 - val_loss: 3.3259 - val_accuracy100: 0.3578 - 13s/epoch - 28ms/step
Epoch 2/50
451/451 - 11s - loss: 3.2954 - accuracy100: 0.3618 - val_loss: 3.3121 - val_accuracy100: 0.3643 - 11s/epoch - 24ms/step
Epoch 3/50
451/451 - 11s - loss: 3.2881 - accuracy100: 0.3654 - val_loss: 3.3071 - val_accuracy100: 0.3696 - 11s/epoch - 24ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2818 - accuracy100: 0.3699 - val_loss: 3.3004 - val_accuracy100: 0.3720 - 11s/epoch - 24ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2777 - accuracy100: 0.3724 - val_loss: 3.2955 - val_accuracy100: 0.3720 - 11s/epoch - 24ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2738 - accuracy100: 0.3746 - val_loss: 3.2917 - val_accuracy100: 0.3715 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2730 - accuracy100: 0.3754 - val_loss: 3.2882 - val_accuracy100: 0.3718 - 11s/epoch - 25ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2706 - accuracy100: 0.3770 - val_loss: 3.2876 - val_accuracy100: 0.3760 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 11s - loss: 3.2687 - accuracy100: 0.3786 - val_loss: 3.2852 - val_accuracy100: 0.3757 - 11s/epoch - 24ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2665 - accuracy100: 0.3814 - val_loss: 3.2856 - val_accuracy100: 0.3750 - 11s/epoch - 24ms/step
Epoch 11/50
451/451 - 10s - loss: 3.2661 - accuracy100: 0.3797 - val_loss: 3.2821 - val_accuracy100: 0.3770 - 10s/epoch - 23ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2652 - accuracy100: 0.3808 - val_loss: 3.2829 - val_accuracy100: 0.3759 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2636 - accuracy100: 0.3837 - val_loss: 3.2834 - val_accuracy100: 0.3774 - 11s/epoch - 24ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2606 - accuracy100: 0.3846 - val_loss: 3.2818 - val_accuracy100: 0.3748 - 11s/epoch - 24ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2601 - accuracy100: 0.3855 - val_loss: 3.2809 - val_accuracy100: 0.3768 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2583 - accuracy100: 0.3869 - val_loss: 3.2810 - val_accuracy100: 0.3757 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2576 - accuracy100: 0.3866 - val_loss: 3.2796 - val_accuracy100: 0.3778 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2561 - accuracy100: 0.3884 - val_loss: 3.2816 - val_accuracy100: 0.3760 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2555 - accuracy100: 0.3893 - val_loss: 3.2816 - val_accuracy100: 0.3771 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2539 - accuracy100: 0.3888 - val_loss: 3.2816 - val_accuracy100: 0.3770 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2523 - accuracy100: 0.3906 - val_loss: 3.2820 - val_accuracy100: 0.3762 - 11s/epoch - 24ms/step
Epoch 22/50
451/451 - 11s - loss: 3.2497 - accuracy100: 0.3924 - val_loss: 3.2817 - val_accuracy100: 0.3775 - 11s/epoch - 24ms/step
Epoch 23/50
451/451 - 11s - loss: 3.2499 - accuracy100: 0.3920 - val_loss: 3.2830 - val_accuracy100: 0.3754 - 11s/epoch - 24ms/step
Epoch 24/50
451/451 - 11s - loss: 3.2469 - accuracy100: 0.3947 - val_loss: 3.2827 - val_accuracy100: 0.3781 - 11s/epoch - 24ms/step
Epoch 25/50
451/451 - 11s - loss: 3.2460 - accuracy100: 0.3950 - val_loss: 3.2853 - val_accuracy100: 0.3754 - 11s/epoch - 24ms/step
Epoch 26/50
451/451 - 11s - loss: 3.2447 - accuracy100: 0.3956 - val_loss: 3.2838 - val_accuracy100: 0.3761 - 11s/epoch - 24ms/step
Epoch 27/50
451/451 - 11s - loss: 3.2432 - accuracy100: 0.3952 - val_loss: 3.2869 - val_accuracy100: 0.3759 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h100
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933028
{'0': {'precision': 0.36943006998261707, 'recall': 0.5394614602459347, 'f1-score': 0.4385414065008742, 'support': 136703}, '1': {'precision': 0.4060442525634107, 'recall': 0.054620293137617876, 'f1-score': 0.09628809644166599, 'support': 137751}, '2': {'precision': 0.3773438883128051, 'recall': 0.5276041077288672, 'f1-score': 0.4399991742532153, 'support': 141392}, 'accuracy': 0.3748238530609889, 'macro avg': {'precision': 0.38427273695294434, 'recall': 0.37389528703747327, 'f1-score': 0.32494289239858515, 'support': 415846}, 'weighted avg': {'precision': 0.38424947636389484, 'recall': 0.3748238530609889, 'f1-score': 0.3256639975179166, 'support': 415846}}
[[73746  5587 57370]
 [64501  7524 65726]
 [61374  5419 74599]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0905614
{'0': {'precision': 0.36927541329581426, 'recall': 0.5517975402081362, 'f1-score': 0.44245195549561694, 'support': 38052}, '1': {'precision': 0.41300270889768703, 'recall': 0.05199916045755063, 'f1-score': 0.09236863567517185, 'support': 38116}, '2': {'precision': 0.3816207774823849, 'recall': 0.522581466395112, 'f1-score': 0.44111358239585685, 'support': 39280}, 'accuracy': 0.37684498648742293, 'macro avg': {'precision': 0.38796629989196213, 'recall': 0.37545938902026627, 'f1-score': 0.3253113911888819, 'support': 115448}, 'weighted avg': {'precision': 0.38791268292724546, 'recall': 0.37684498648742293, 'f1-score': 0.32641402401447683, 'support': 115448}}
[[20997  1437 15618]
 [18490  1982 17644]
 [17373  1380 20527]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934151
{'0': {'precision': 0.3799576824382119, 'recall': 0.5542785840940435, 'f1-score': 0.45085470085470086, 'support': 15227}, '1': {'precision': 0.37797902764537655, 'recall': 0.052940783763936176, 'f1-score': 0.09287345552497511, 'support': 14979}, '2': {'precision': 0.3734864501249279, 'recall': 0.5210833277468659, 'f1-score': 0.43510873520109716, 'support': 14917}, 'accuracy': 0.3768809697936751, 'macro avg': {'precision': 0.37714105340283877, 'recall': 0.37610089853494855, 'f1-score': 0.32627896386025773, 'support': 45123}, 'weighted avg': {'precision': 0.37716155535093626, 'recall': 0.3768809697936751, 'f1-score': 0.32681410861906124, 'support': 45123}}
[[8440  662 6125]
 [7272  793 6914]
 [6501  643 7773]]
training model: results/XRAY/W0/deepOF_L1/h200
Epoch 1/50
451/451 - 14s - loss: 3.3292 - accuracy200: 0.3482 - val_loss: 3.3377 - val_accuracy200: 0.3374 - 14s/epoch - 31ms/step
Epoch 2/50
451/451 - 12s - loss: 3.3063 - accuracy200: 0.3557 - val_loss: 3.3290 - val_accuracy200: 0.3367 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 12s - loss: 3.2977 - accuracy200: 0.3566 - val_loss: 3.3219 - val_accuracy200: 0.3392 - 12s/epoch - 26ms/step
Epoch 4/50
451/451 - 12s - loss: 3.2919 - accuracy200: 0.3579 - val_loss: 3.3164 - val_accuracy200: 0.3422 - 12s/epoch - 26ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2864 - accuracy200: 0.3639 - val_loss: 3.3130 - val_accuracy200: 0.3418 - 11s/epoch - 25ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2836 - accuracy200: 0.3649 - val_loss: 3.3091 - val_accuracy200: 0.3457 - 11s/epoch - 24ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2819 - accuracy200: 0.3655 - val_loss: 3.3098 - val_accuracy200: 0.3414 - 11s/epoch - 24ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2799 - accuracy200: 0.3678 - val_loss: 3.3063 - val_accuracy200: 0.3447 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 10s - loss: 3.2771 - accuracy200: 0.3689 - val_loss: 3.3037 - val_accuracy200: 0.3490 - 10s/epoch - 23ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2763 - accuracy200: 0.3683 - val_loss: 3.3054 - val_accuracy200: 0.3456 - 11s/epoch - 24ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2750 - accuracy200: 0.3710 - val_loss: 3.3044 - val_accuracy200: 0.3463 - 11s/epoch - 24ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2736 - accuracy200: 0.3728 - val_loss: 3.3037 - val_accuracy200: 0.3450 - 11s/epoch - 25ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2730 - accuracy200: 0.3727 - val_loss: 3.3025 - val_accuracy200: 0.3469 - 11s/epoch - 25ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2702 - accuracy200: 0.3756 - val_loss: 3.3042 - val_accuracy200: 0.3456 - 11s/epoch - 24ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2697 - accuracy200: 0.3741 - val_loss: 3.3030 - val_accuracy200: 0.3466 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2696 - accuracy200: 0.3749 - val_loss: 3.3025 - val_accuracy200: 0.3440 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2677 - accuracy200: 0.3770 - val_loss: 3.3032 - val_accuracy200: 0.3459 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2659 - accuracy200: 0.3801 - val_loss: 3.3037 - val_accuracy200: 0.3471 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2645 - accuracy200: 0.3803 - val_loss: 3.3042 - val_accuracy200: 0.3428 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2634 - accuracy200: 0.3816 - val_loss: 3.3047 - val_accuracy200: 0.3435 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2619 - accuracy200: 0.3827 - val_loss: 3.3060 - val_accuracy200: 0.3452 - 11s/epoch - 25ms/step
Epoch 22/50
451/451 - 11s - loss: 3.2601 - accuracy200: 0.3834 - val_loss: 3.3040 - val_accuracy200: 0.3468 - 11s/epoch - 24ms/step
Epoch 23/50
451/451 - 11s - loss: 3.2584 - accuracy200: 0.3849 - val_loss: 3.3053 - val_accuracy200: 0.3449 - 11s/epoch - 24ms/step
testing model: results/XRAY/W0/deepOF_L1/h200
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097355
{'0': {'precision': 0.2709917623207193, 'recall': 0.34105762390324873, 'f1-score': 0.3020142120382348, 'support': 105425}, '1': {'precision': 0.5323145763856643, 'recall': 0.06457923631596198, 'f1-score': 0.11518453732079487, 'support': 195264}, '2': {'precision': 0.2881714545580675, 'recall': 0.6493135458547895, 'f1-score': 0.39918212854782437, 'support': 115157}, 'accuracy': 0.29659777898548983, 'macro avg': {'precision': 0.36382593108815037, 'recall': 0.3516501353580001, 'f1-score': 0.27212695930228464, 'support': 415846}, 'weighted avg': {'precision': 0.39845553444923254, 'recall': 0.29659777898548983, 'f1-score': 0.24119471673821655, 'support': 415846}}
[[ 35956   5111  64358]
 [ 62311  12610 120343]
 [ 34416   5968  74773]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939322
{'0': {'precision': 0.3637549615566103, 'recall': 0.3467298126785903, 'f1-score': 0.35503840266583586, 'support': 37796}, '1': {'precision': 0.38231098430813126, 'recall': 0.06331207181667847, 'f1-score': 0.10863396838265098, 'support': 38097}, '2': {'precision': 0.36326458036984355, 'recall': 0.6714448236632536, 'f1-score': 0.47146014360904265, 'support': 39555}, 'accuracy': 0.3644584574873536, 'macro avg': {'precision': 0.36977684207819506, 'recall': 0.36049556938617416, 'f1-score': 0.3117108382191765, 'support': 115448}, 'weighted avg': {'precision': 0.3697102987726914, 'recall': 0.3644584574873536, 'f1-score': 0.31361535705328347, 'support': 115448}}
[[13105  1873 22818]
 [11950  2412 23735]
 [10972  2024 26559]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994023
{'0': {'precision': 0.3612010192135528, 'recall': 0.3556414429075129, 'f1-score': 0.3583996720079265, 'support': 14748}, '1': {'precision': 0.36887392442947997, 'recall': 0.061678969097960716, 'f1-score': 0.10568626400128624, 'support': 15986}, '2': {'precision': 0.3356009882201296, 'recall': 0.6514003752866773, 'f1-score': 0.44297934685004015, 'support': 14389}, 'accuracy': 0.3458103406245152, 'macro avg': {'precision': 0.3552253106210541, 'recall': 0.356240262430717, 'f1-score': 0.30235509428641766, 'support': 45123}, 'weighted avg': {'precision': 0.3557559073375128, 'recall': 0.3458103406245152, 'f1-score': 0.29584045389098, 'support': 45123}}
[[5245  837 8666]
 [5110  986 9890]
 [4166  850 9373]]
training model: results/XRAY/W0/deepOF_L1/h300
Epoch 1/50
451/451 - 14s - loss: 3.3382 - accuracy300: 0.3435 - val_loss: 3.3261 - val_accuracy300: 0.3331 - 14s/epoch - 30ms/step
Epoch 2/50
451/451 - 12s - loss: 3.3139 - accuracy300: 0.3494 - val_loss: 3.3219 - val_accuracy300: 0.3328 - 12s/epoch - 26ms/step
Epoch 3/50
451/451 - 11s - loss: 3.3035 - accuracy300: 0.3507 - val_loss: 3.3218 - val_accuracy300: 0.3300 - 11s/epoch - 25ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2986 - accuracy300: 0.3524 - val_loss: 3.3176 - val_accuracy300: 0.3318 - 11s/epoch - 24ms/step
Epoch 5/50
451/451 - 12s - loss: 3.2948 - accuracy300: 0.3531 - val_loss: 3.3149 - val_accuracy300: 0.3323 - 12s/epoch - 26ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2918 - accuracy300: 0.3536 - val_loss: 3.3138 - val_accuracy300: 0.3314 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2882 - accuracy300: 0.3580 - val_loss: 3.3133 - val_accuracy300: 0.3323 - 11s/epoch - 24ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2879 - accuracy300: 0.3567 - val_loss: 3.3110 - val_accuracy300: 0.3324 - 11s/epoch - 24ms/step
Epoch 9/50
451/451 - 10s - loss: 3.2855 - accuracy300: 0.3584 - val_loss: 3.3099 - val_accuracy300: 0.3324 - 10s/epoch - 23ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2844 - accuracy300: 0.3582 - val_loss: 3.3107 - val_accuracy300: 0.3319 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2831 - accuracy300: 0.3599 - val_loss: 3.3103 - val_accuracy300: 0.3322 - 11s/epoch - 25ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2821 - accuracy300: 0.3593 - val_loss: 3.3097 - val_accuracy300: 0.3324 - 11s/epoch - 25ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2807 - accuracy300: 0.3630 - val_loss: 3.3102 - val_accuracy300: 0.3327 - 11s/epoch - 25ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2794 - accuracy300: 0.3643 - val_loss: 3.3104 - val_accuracy300: 0.3339 - 11s/epoch - 25ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2774 - accuracy300: 0.3661 - val_loss: 3.3117 - val_accuracy300: 0.3320 - 11s/epoch - 25ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2761 - accuracy300: 0.3663 - val_loss: 3.3111 - val_accuracy300: 0.3334 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2746 - accuracy300: 0.3688 - val_loss: 3.3126 - val_accuracy300: 0.3319 - 11s/epoch - 25ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2738 - accuracy300: 0.3720 - val_loss: 3.3143 - val_accuracy300: 0.3330 - 11s/epoch - 25ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2726 - accuracy300: 0.3718 - val_loss: 3.3144 - val_accuracy300: 0.3334 - 11s/epoch - 25ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2709 - accuracy300: 0.3728 - val_loss: 3.3158 - val_accuracy300: 0.3347 - 11s/epoch - 25ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2689 - accuracy300: 0.3749 - val_loss: 3.3173 - val_accuracy300: 0.3327 - 11s/epoch - 25ms/step
Epoch 22/50
451/451 - 11s - loss: 3.2671 - accuracy300: 0.3758 - val_loss: 3.3197 - val_accuracy300: 0.3322 - 11s/epoch - 25ms/step
testing model: results/XRAY/W0/deepOF_L1/h300
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0866994
{'0': {'precision': 0.2881404720782959, 'recall': 0.03438385573207385, 'f1-score': 0.06143648443373789, 'support': 116450}, '1': {'precision': 0.41862645950170085, 'recall': 0.9103730742206914, 'f1-score': 0.5735235373924434, 'support': 175059}, '2': {'precision': 0.3203481533756763, 'recall': 0.05476246008830839, 'f1-score': 0.09353535908566404, 'support': 124337}, 'accuracy': 0.4092428447069348, 'macro avg': {'precision': 0.3423716949852243, 'recall': 0.3331731300136912, 'f1-score': 0.24283179363728177, 'support': 415846}, 'weighted avg': {'precision': 0.35270127810222357, 'recall': 0.4092428447069348, 'f1-score': 0.2866076419812304, 'support': 415846}}
[[  4004 107255   5191]
 [  6435 159369   9255]
 [  3457 114071   6809]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992527
{'0': {'precision': 0.384, 'recall': 0.035890725558789756, 'f1-score': 0.06564583485969669, 'support': 37447}, '1': {'precision': 0.33196137108117546, 'recall': 0.9205738370114401, 'f1-score': 0.4879622562963991, 'support': 38199}, '2': {'precision': 0.4038557420641516, 'recall': 0.0610522084317371, 'f1-score': 0.10606953447259872, 'support': 39802}, 'accuracy': 0.33728605086272606, 'macro avg': {'precision': 0.3732723710484423, 'recall': 0.3391722570006557, 'f1-score': 0.2198925418762315, 'support': 115448}, 'weighted avg': {'precision': 0.37362714520448326, 'recall': 0.33728605086272606, 'f1-score': 0.21931683023816426, 'support': 115448}}
[[ 1344 34406  1697]
 [ 1144 35165  1890]
 [ 1012 36360  2430]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024373
{'0': {'precision': 0.3803019410496046, 'recall': 0.03425278425278425, 'f1-score': 0.06284526284526284, 'support': 15444}, '1': {'precision': 0.3291861192664966, 'recall': 0.9233209584880189, 'f1-score': 0.48533768560733737, 'support': 14815}, '2': {'precision': 0.3613406795224977, 'recall': 0.05294671689989236, 'f1-score': 0.09236005163713179, 'support': 14864}, 'accuracy': 0.3323138975688673, 'macro avg': {'precision': 0.356942913279533, 'recall': 0.33684015321356514, 'f1-score': 0.213514333363244, 'support': 45123}, 'weighted avg': {'precision': 0.35727330618366787, 'recall': 0.3323138975688673, 'f1-score': 0.21128249139439464, 'support': 45123}}
[[  529 14195   720]
 [  465 13679   671]
 [  397 13680   787]]
training model: results/XRAY/W0/deepOF_L1/h500
Epoch 1/50
451/451 - 13s - loss: 3.3365 - accuracy500: 0.3462 - val_loss: 3.3311 - val_accuracy500: 0.3387 - 13s/epoch - 30ms/step
Epoch 2/50
451/451 - 11s - loss: 3.3125 - accuracy500: 0.3535 - val_loss: 3.3260 - val_accuracy500: 0.3388 - 11s/epoch - 25ms/step
Epoch 3/50
451/451 - 11s - loss: 3.3033 - accuracy500: 0.3558 - val_loss: 3.3191 - val_accuracy500: 0.3415 - 11s/epoch - 25ms/step
Epoch 4/50
451/451 - 11s - loss: 3.2977 - accuracy500: 0.3577 - val_loss: 3.3145 - val_accuracy500: 0.3427 - 11s/epoch - 25ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2948 - accuracy500: 0.3593 - val_loss: 3.3139 - val_accuracy500: 0.3432 - 11s/epoch - 25ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2929 - accuracy500: 0.3592 - val_loss: 3.3135 - val_accuracy500: 0.3439 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2901 - accuracy500: 0.3597 - val_loss: 3.3116 - val_accuracy500: 0.3463 - 11s/epoch - 25ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2891 - accuracy500: 0.3604 - val_loss: 3.3102 - val_accuracy500: 0.3435 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 11s - loss: 3.2873 - accuracy500: 0.3612 - val_loss: 3.3104 - val_accuracy500: 0.3475 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2851 - accuracy500: 0.3640 - val_loss: 3.3114 - val_accuracy500: 0.3437 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2853 - accuracy500: 0.3632 - val_loss: 3.3112 - val_accuracy500: 0.3440 - 11s/epoch - 25ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2828 - accuracy500: 0.3649 - val_loss: 3.3104 - val_accuracy500: 0.3417 - 11s/epoch - 24ms/step
Epoch 13/50
451/451 - 11s - loss: 3.2826 - accuracy500: 0.3662 - val_loss: 3.3102 - val_accuracy500: 0.3422 - 11s/epoch - 25ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2816 - accuracy500: 0.3667 - val_loss: 3.3119 - val_accuracy500: 0.3426 - 11s/epoch - 25ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2795 - accuracy500: 0.3703 - val_loss: 3.3118 - val_accuracy500: 0.3421 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2782 - accuracy500: 0.3700 - val_loss: 3.3117 - val_accuracy500: 0.3420 - 11s/epoch - 25ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2769 - accuracy500: 0.3702 - val_loss: 3.3125 - val_accuracy500: 0.3452 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2761 - accuracy500: 0.3697 - val_loss: 3.3126 - val_accuracy500: 0.3404 - 11s/epoch - 25ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2748 - accuracy500: 0.3719 - val_loss: 3.3125 - val_accuracy500: 0.3432 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2730 - accuracy500: 0.3737 - val_loss: 3.3143 - val_accuracy500: 0.3395 - 11s/epoch - 24ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2720 - accuracy500: 0.3753 - val_loss: 3.3140 - val_accuracy500: 0.3433 - 11s/epoch - 25ms/step
Epoch 22/50
451/451 - 11s - loss: 3.2694 - accuracy500: 0.3781 - val_loss: 3.3149 - val_accuracy500: 0.3439 - 11s/epoch - 24ms/step
Epoch 23/50
451/451 - 11s - loss: 3.2691 - accuracy500: 0.3785 - val_loss: 3.3151 - val_accuracy500: 0.3410 - 11s/epoch - 25ms/step
testing model: results/XRAY/W0/deepOF_L1/h500
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973195
{'0': {'precision': 0.30770630515876624, 'recall': 0.05333038980698877, 'f1-score': 0.09090542556479901, 'support': 126832}, '1': {'precision': 0.3747704187651099, 'recall': 0.542871753709122, 'f1-score': 0.4434239850262121, 'support': 154484}, '2': {'precision': 0.32819674637097485, 'recall': 0.414940905374266, 'f1-score': 0.3665061372149289, 'support': 134530}, 'accuracy': 0.3521760459400836, 'macro avg': {'precision': 0.33689115676495035, 'recall': 0.33704768296345894, 'f1-score': 0.30027851593531335, 'support': 415846}, 'weighted avg': {'precision': 0.3392490194872456, 'recall': 0.3521760459400836, 'f1-score': 0.3110230673796269, 'support': 415846}}
[[ 6764 67989 52079]
 [ 8433 83865 62186]
 [ 6785 71923 55822]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960343
{'0': {'precision': 0.37751371115173676, 'recall': 0.05563038793103448, 'f1-score': 0.09697111998121624, 'support': 37120}, '1': {'precision': 0.34131342694596994, 'recall': 0.550186858914893, 'f1-score': 0.4212812160694897, 'support': 37729}, '2': {'precision': 0.3741659886086249, 'recall': 0.4530653464371044, 'f1-score': 0.4098530509475373, 'support': 40599}, 'accuracy': 0.3570178781789204, 'macro avg': {'precision': 0.3643310422354438, 'recall': 0.3529608644276773, 'f1-score': 0.3093684623327478, 'support': 115448}, 'weighted avg': {'precision': 0.3645059959004792, 'recall': 0.3570178781789204, 'f1-score': 0.31298689444778244, 'support': 115448}}
[[ 2065 19511 15544]
 [ 1749 20758 15222]
 [ 1656 20549 18394]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100495
{'0': {'precision': 0.3694649446494465, 'recall': 0.05286081963967531, 'f1-score': 0.09248888632296057, 'support': 15153}, '1': {'precision': 0.34037198694506704, 'recall': 0.5762599028027429, 'f1-score': 0.4279640067240186, 'support': 15021}, '2': {'precision': 0.345297877196987, 'recall': 0.4047762392133253, 'f1-score': 0.3726788408831953, 'support': 14949}, 'accuracy': 0.34368282250736876, 'macro avg': {'precision': 0.35171160293050024, 'recall': 0.34463232055191445, 'f1-score': 0.29771057797672484, 'support': 45123}, 'weighted avg': {'precision': 0.3517737714334746, 'recall': 0.34368282250736876, 'f1-score': 0.2969906130314073, 'support': 45123}}
[[ 801 8542 5810]
 [ 702 8656 5663]
 [ 665 8233 6051]]
training model: results/XRAY/W0/deepOF_L1/h1000
Epoch 1/50
451/451 - 13s - loss: 3.3394 - accuracy1000: 0.3445 - val_loss: 3.3571 - val_accuracy1000: 0.3356 - 13s/epoch - 29ms/step
Epoch 2/50
451/451 - 11s - loss: 3.3158 - accuracy1000: 0.3481 - val_loss: 3.3548 - val_accuracy1000: 0.3349 - 11s/epoch - 24ms/step
Epoch 3/50
451/451 - 11s - loss: 3.3063 - accuracy1000: 0.3503 - val_loss: 3.3491 - val_accuracy1000: 0.3368 - 11s/epoch - 24ms/step
Epoch 4/50
451/451 - 11s - loss: 3.3003 - accuracy1000: 0.3531 - val_loss: 3.3432 - val_accuracy1000: 0.3389 - 11s/epoch - 25ms/step
Epoch 5/50
451/451 - 11s - loss: 3.2982 - accuracy1000: 0.3518 - val_loss: 3.3368 - val_accuracy1000: 0.3366 - 11s/epoch - 25ms/step
Epoch 6/50
451/451 - 11s - loss: 3.2955 - accuracy1000: 0.3506 - val_loss: 3.3348 - val_accuracy1000: 0.3365 - 11s/epoch - 25ms/step
Epoch 7/50
451/451 - 11s - loss: 3.2939 - accuracy1000: 0.3526 - val_loss: 3.3335 - val_accuracy1000: 0.3371 - 11s/epoch - 25ms/step
Epoch 8/50
451/451 - 11s - loss: 3.2918 - accuracy1000: 0.3557 - val_loss: 3.3286 - val_accuracy1000: 0.3384 - 11s/epoch - 25ms/step
Epoch 9/50
451/451 - 11s - loss: 3.2897 - accuracy1000: 0.3546 - val_loss: 3.3298 - val_accuracy1000: 0.3377 - 11s/epoch - 25ms/step
Epoch 10/50
451/451 - 11s - loss: 3.2896 - accuracy1000: 0.3567 - val_loss: 3.3258 - val_accuracy1000: 0.3386 - 11s/epoch - 25ms/step
Epoch 11/50
451/451 - 11s - loss: 3.2879 - accuracy1000: 0.3572 - val_loss: 3.3281 - val_accuracy1000: 0.3366 - 11s/epoch - 25ms/step
Epoch 12/50
451/451 - 11s - loss: 3.2854 - accuracy1000: 0.3595 - val_loss: 3.3290 - val_accuracy1000: 0.3370 - 11s/epoch - 25ms/step
Epoch 13/50
451/451 - 12s - loss: 3.2851 - accuracy1000: 0.3599 - val_loss: 3.3263 - val_accuracy1000: 0.3367 - 12s/epoch - 26ms/step
Epoch 14/50
451/451 - 11s - loss: 3.2837 - accuracy1000: 0.3616 - val_loss: 3.3268 - val_accuracy1000: 0.3389 - 11s/epoch - 25ms/step
Epoch 15/50
451/451 - 11s - loss: 3.2820 - accuracy1000: 0.3639 - val_loss: 3.3255 - val_accuracy1000: 0.3367 - 11s/epoch - 24ms/step
Epoch 16/50
451/451 - 11s - loss: 3.2808 - accuracy1000: 0.3650 - val_loss: 3.3279 - val_accuracy1000: 0.3376 - 11s/epoch - 24ms/step
Epoch 17/50
451/451 - 11s - loss: 3.2794 - accuracy1000: 0.3668 - val_loss: 3.3281 - val_accuracy1000: 0.3402 - 11s/epoch - 24ms/step
Epoch 18/50
451/451 - 11s - loss: 3.2794 - accuracy1000: 0.3669 - val_loss: 3.3278 - val_accuracy1000: 0.3385 - 11s/epoch - 24ms/step
Epoch 19/50
451/451 - 11s - loss: 3.2773 - accuracy1000: 0.3690 - val_loss: 3.3315 - val_accuracy1000: 0.3388 - 11s/epoch - 24ms/step
Epoch 20/50
451/451 - 11s - loss: 3.2760 - accuracy1000: 0.3701 - val_loss: 3.3330 - val_accuracy1000: 0.3379 - 11s/epoch - 25ms/step
Epoch 21/50
451/451 - 11s - loss: 3.2748 - accuracy1000: 0.3706 - val_loss: 3.3328 - val_accuracy1000: 0.3360 - 11s/epoch - 25ms/step
Epoch 22/50
451/451 - 11s - loss: 3.2741 - accuracy1000: 0.3728 - val_loss: 3.3347 - val_accuracy1000: 0.3387 - 11s/epoch - 25ms/step
Epoch 23/50
451/451 - 11s - loss: 3.2724 - accuracy1000: 0.3729 - val_loss: 3.3342 - val_accuracy1000: 0.3381 - 11s/epoch - 25ms/step
Epoch 24/50
451/451 - 11s - loss: 3.2706 - accuracy1000: 0.3741 - val_loss: 3.3365 - val_accuracy1000: 0.3369 - 11s/epoch - 25ms/step
Epoch 25/50
451/451 - 11s - loss: 3.2686 - accuracy1000: 0.3768 - val_loss: 3.3379 - val_accuracy1000: 0.3367 - 11s/epoch - 25ms/step
testing model: results/XRAY/W0/deepOF_L1/h1000
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0915436
{'0': {'precision': 0.26184592242398197, 'recall': 0.021205318297309525, 'f1-score': 0.03923336365319445, 'support': 114924}, '1': {'precision': 0.4320127138773007, 'recall': 0.5617349116147436, 'f1-score': 0.4884069504591815, 'support': 178084}, '2': {'precision': 0.30187848966459213, 'recall': 0.4300216545368697, 'f1-score': 0.35473223669409937, 'support': 122838}, 'accuracy': 0.3734459391216941, 'macro avg': {'precision': 0.3319123753219582, 'recall': 0.3376539614829743, 'f1-score': 0.2941241836021584, 'support': 415846}, 'weighted avg': {'precision': 0.34654435257330374, 'recall': 0.3734459391216941, 'f1-score': 0.32478589896519955, 'support': 415846}}
[[  2437  64099  48388]
 [  4278 100036  73770]
 [  2592  67423  52823]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987492
{'0': {'precision': 0.3896222121074192, 'recall': 0.02283641020168605, 'f1-score': 0.043144073990070815, 'support': 37484}, '1': {'precision': 0.33128055660022565, 'recall': 0.5793165812621599, 'f1-score': 0.4215175108913457, 'support': 36493}, '2': {'precision': 0.3823809042176596, 'recall': 0.4558124954787683, 'f1-score': 0.4158801399247574, 'support': 41471}, 'accuracy': 0.35427205321876515, 'macro avg': {'precision': 0.3677612243084348, 'recall': 0.35265516231420474, 'f1-score': 0.29351390826872464, 'support': 115448}, 'weighted avg': {'precision': 0.368579263646465, 'recall': 0.35427205321876515, 'f1-score': 0.29664105291751536, 'support': 115448}}
[[  856 20799 15829]
 [  649 21141 14703]
 [  692 21876 18903]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042575
{'0': {'precision': 0.3919075144508671, 'recall': 0.021852639721523882, 'f1-score': 0.04139699597020393, 'support': 15513}, '1': {'precision': 0.33444444444444443, 'recall': 0.5947805941673481, 'f1-score': 0.42814400627820287, 'support': 14676}, '2': {'precision': 0.3458530675184492, 'recall': 0.4205169412079818, 'f1-score': 0.3795479269914179, 'support': 14934}, 'accuracy': 0.3401369589787913, 'macro avg': {'precision': 0.3574016754712536, 'recall': 0.34571672503228457, 'f1-score': 0.28302964307994155, 'support': 45123}, 'weighted avg': {'precision': 0.35797570304863346, 'recall': 0.3401369589787913, 'f1-score': 0.27909939002979667, 'support': 45123}}
[[ 339 8978 6196]
 [ 265 8729 5682]
 [ 261 8393 6280]]
training model: results/XRAY/W0/deepLOB_L2/h10
Epoch 1/50
451/451 - 26s - loss: 3.2844 - accuracy10: 0.3759 - val_loss: 3.2384 - val_accuracy10: 0.4072 - 26s/epoch - 57ms/step
Epoch 2/50
451/451 - 23s - loss: 3.1472 - accuracy10: 0.4267 - val_loss: 3.1759 - val_accuracy10: 0.4211 - 23s/epoch - 51ms/step
Epoch 3/50
451/451 - 23s - loss: 3.0765 - accuracy10: 0.4533 - val_loss: 3.1099 - val_accuracy10: 0.4319 - 23s/epoch - 50ms/step
Epoch 4/50
451/451 - 22s - loss: 3.0366 - accuracy10: 0.4655 - val_loss: 3.1065 - val_accuracy10: 0.4359 - 22s/epoch - 50ms/step
Epoch 5/50
451/451 - 22s - loss: 3.0095 - accuracy10: 0.4757 - val_loss: 3.0931 - val_accuracy10: 0.4366 - 22s/epoch - 49ms/step
Epoch 6/50
451/451 - 22s - loss: 2.9861 - accuracy10: 0.4823 - val_loss: 3.0748 - val_accuracy10: 0.4529 - 22s/epoch - 49ms/step
Epoch 7/50
451/451 - 22s - loss: 2.9693 - accuracy10: 0.4894 - val_loss: 3.0818 - val_accuracy10: 0.4423 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 23s - loss: 2.9503 - accuracy10: 0.4959 - val_loss: 3.0873 - val_accuracy10: 0.4466 - 23s/epoch - 50ms/step
Epoch 9/50
451/451 - 22s - loss: 2.9340 - accuracy10: 0.5006 - val_loss: 3.1093 - val_accuracy10: 0.4450 - 22s/epoch - 50ms/step
Epoch 10/50
451/451 - 22s - loss: 2.9210 - accuracy10: 0.5049 - val_loss: 3.0859 - val_accuracy10: 0.4566 - 22s/epoch - 50ms/step
Epoch 11/50
451/451 - 23s - loss: 2.9074 - accuracy10: 0.5085 - val_loss: 3.0696 - val_accuracy10: 0.4575 - 23s/epoch - 50ms/step
Epoch 12/50
451/451 - 23s - loss: 2.8933 - accuracy10: 0.5139 - val_loss: 3.1030 - val_accuracy10: 0.4451 - 23s/epoch - 50ms/step
Epoch 13/50
451/451 - 23s - loss: 2.8826 - accuracy10: 0.5169 - val_loss: 3.0668 - val_accuracy10: 0.4614 - 23s/epoch - 50ms/step
Epoch 14/50
451/451 - 22s - loss: 2.8718 - accuracy10: 0.5196 - val_loss: 3.0798 - val_accuracy10: 0.4498 - 22s/epoch - 50ms/step
Epoch 15/50
451/451 - 22s - loss: 2.8594 - accuracy10: 0.5245 - val_loss: 3.1090 - val_accuracy10: 0.4480 - 22s/epoch - 50ms/step
Epoch 16/50
451/451 - 23s - loss: 2.8487 - accuracy10: 0.5273 - val_loss: 3.1141 - val_accuracy10: 0.4473 - 23s/epoch - 50ms/step
Epoch 17/50
451/451 - 22s - loss: 2.8408 - accuracy10: 0.5290 - val_loss: 3.1192 - val_accuracy10: 0.4445 - 22s/epoch - 50ms/step
Epoch 18/50
451/451 - 23s - loss: 2.8250 - accuracy10: 0.5331 - val_loss: 3.0973 - val_accuracy10: 0.4527 - 23s/epoch - 50ms/step
Epoch 19/50
451/451 - 23s - loss: 2.8163 - accuracy10: 0.5348 - val_loss: 3.1069 - val_accuracy10: 0.4496 - 23s/epoch - 50ms/step
Epoch 20/50
451/451 - 23s - loss: 2.8053 - accuracy10: 0.5376 - val_loss: 3.1222 - val_accuracy10: 0.4439 - 23s/epoch - 50ms/step
Epoch 21/50
451/451 - 22s - loss: 2.7959 - accuracy10: 0.5397 - val_loss: 3.1058 - val_accuracy10: 0.4510 - 22s/epoch - 49ms/step
Epoch 22/50
451/451 - 22s - loss: 2.7843 - accuracy10: 0.5433 - val_loss: 3.1275 - val_accuracy10: 0.4470 - 22s/epoch - 49ms/step
Epoch 23/50
451/451 - 22s - loss: 2.7747 - accuracy10: 0.5445 - val_loss: 3.1304 - val_accuracy10: 0.4487 - 22s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h10
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0321645
{'0': {'precision': 0.4166003442595643, 'recall': 0.42136545733647834, 'f1-score': 0.41896935233184734, 'support': 106836}, '1': {'precision': 0.6473090377572304, 'recall': 0.39667075944526076, 'f1-score': 0.4919033266563079, 'support': 198724}, '2': {'precision': 0.3863989463215332, 'recall': 0.6516941545547688, 'f1-score': 0.4851471114321006, 'support': 110291}, 'accuracy': 0.4706517478616139, 'macro avg': {'precision': 0.48343610944610926, 'recall': 0.48991012377883597, 'f1-score': 0.4653399301400853, 'support': 415851}, 'weighted avg': {'precision': 0.5188398772332661, 'recall': 0.4706517478616139, 'f1-score': 0.47137404137330724, 'support': 415851}}
[[45017 21360 40459]
 [46216 78828 73680]
 [16825 21590 71876]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0742004
{'0': {'precision': 0.4235111735111735, 'recall': 0.4674414850686037, 'f1-score': 0.4443932906710864, 'support': 30975}, '1': {'precision': 0.7023399862353751, 'recall': 0.2696881606765328, 'f1-score': 0.3897269429062441, 'support': 52976}, '2': {'precision': 0.36992777413000655, 'recall': 0.7154512841677514, 'f1-score': 0.4876919248206538, 'support': 31499}, 'accuracy': 0.44436552620181896, 'macro avg': {'precision': 0.49859297795885177, 'recall': 0.48419364330429593, 'f1-score': 0.4406040527993282, 'support': 115450}, 'weighted avg': {'precision': 0.5368365237560407, 'recall': 0.44436552620181896, 'f1-score': 0.4311222576514843, 'support': 115450}}
[[14479  3041 13455]
 [13760 14287 24929]
 [ 5949  3014 22536]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0436382
{'0': {'precision': 0.4456549065616358, 'recall': 0.4456549065616358, 'f1-score': 0.4456549065616358, 'support': 11933}, '1': {'precision': 0.6467296578295569, 'recall': 0.3407278526895752, 'f1-score': 0.44631552291719423, 'support': 20691}, '2': {'precision': 0.37978374983175556, 'recall': 0.6772541803344267, 'f1-score': 0.48666206737955614, 'support': 12499}, 'accuracy': 0.4616935930678368, 'macro avg': {'precision': 0.4907227714076494, 'recall': 0.4878789798618792, 'f1-score': 0.45954416561946204, 'support': 45123}, 'weighted avg': {'precision': 0.5196108512133165, 'recall': 0.4616935930678368, 'f1-score': 0.45731674899401054, 'support': 45123}}
[[5318 2049 4566]
 [4383 7050 9258]
 [2232 1802 8465]]
training model: results/XRAY/W0/deepLOB_L2/h20
Epoch 1/50
451/451 - 25s - loss: 3.2908 - accuracy20: 0.3795 - val_loss: 3.2632 - val_accuracy20: 0.3957 - 25s/epoch - 55ms/step
Epoch 2/50
451/451 - 23s - loss: 3.1768 - accuracy20: 0.4326 - val_loss: 3.1897 - val_accuracy20: 0.4265 - 23s/epoch - 50ms/step
Epoch 3/50
451/451 - 22s - loss: 3.1203 - accuracy20: 0.4562 - val_loss: 3.1530 - val_accuracy20: 0.4462 - 22s/epoch - 50ms/step
Epoch 4/50
451/451 - 22s - loss: 3.0833 - accuracy20: 0.4682 - val_loss: 3.1466 - val_accuracy20: 0.4515 - 22s/epoch - 50ms/step
Epoch 5/50
451/451 - 22s - loss: 3.0615 - accuracy20: 0.4752 - val_loss: 3.1549 - val_accuracy20: 0.4510 - 22s/epoch - 50ms/step
Epoch 6/50
451/451 - 23s - loss: 3.0469 - accuracy20: 0.4811 - val_loss: 3.1397 - val_accuracy20: 0.4518 - 23s/epoch - 50ms/step
Epoch 7/50
451/451 - 23s - loss: 3.0306 - accuracy20: 0.4860 - val_loss: 3.1337 - val_accuracy20: 0.4592 - 23s/epoch - 51ms/step
Epoch 8/50
451/451 - 23s - loss: 3.0159 - accuracy20: 0.4895 - val_loss: 3.1216 - val_accuracy20: 0.4624 - 23s/epoch - 50ms/step
Epoch 9/50
451/451 - 23s - loss: 3.0030 - accuracy20: 0.4930 - val_loss: 3.1098 - val_accuracy20: 0.4620 - 23s/epoch - 50ms/step
Epoch 10/50
451/451 - 22s - loss: 2.9915 - accuracy20: 0.4980 - val_loss: 3.1132 - val_accuracy20: 0.4621 - 22s/epoch - 50ms/step
Epoch 11/50
451/451 - 22s - loss: 2.9772 - accuracy20: 0.5011 - val_loss: 3.1289 - val_accuracy20: 0.4591 - 22s/epoch - 50ms/step
Epoch 12/50
451/451 - 23s - loss: 2.9657 - accuracy20: 0.5054 - val_loss: 3.1196 - val_accuracy20: 0.4623 - 23s/epoch - 50ms/step
Epoch 13/50
451/451 - 23s - loss: 2.9550 - accuracy20: 0.5085 - val_loss: 3.1214 - val_accuracy20: 0.4613 - 23s/epoch - 50ms/step
Epoch 14/50
451/451 - 22s - loss: 2.9431 - accuracy20: 0.5124 - val_loss: 3.1322 - val_accuracy20: 0.4596 - 22s/epoch - 50ms/step
Epoch 15/50
451/451 - 22s - loss: 2.9326 - accuracy20: 0.5143 - val_loss: 3.1565 - val_accuracy20: 0.4577 - 22s/epoch - 50ms/step
Epoch 16/50
451/451 - 22s - loss: 2.9207 - accuracy20: 0.5166 - val_loss: 3.1588 - val_accuracy20: 0.4586 - 22s/epoch - 50ms/step
Epoch 17/50
451/451 - 22s - loss: 2.9105 - accuracy20: 0.5189 - val_loss: 3.1690 - val_accuracy20: 0.4580 - 22s/epoch - 50ms/step
Epoch 18/50
451/451 - 23s - loss: 2.9045 - accuracy20: 0.5196 - val_loss: 3.1707 - val_accuracy20: 0.4574 - 23s/epoch - 50ms/step
Epoch 19/50
451/451 - 22s - loss: 2.8887 - accuracy20: 0.5256 - val_loss: 3.1730 - val_accuracy20: 0.4537 - 22s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h20
Evaluating performance on  test set...
1625/1625 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0311346
{'0': {'precision': 0.4621000917961446, 'recall': 0.40778104467312715, 'f1-score': 0.43324461303072803, 'support': 133324}, '1': {'precision': 0.47981914026725125, 'recall': 0.45781814428733614, 'f1-score': 0.46856052336922455, 'support': 145335}, '2': {'precision': 0.4543465723885462, 'recall': 0.5283179777246486, 'f1-score': 0.4885481261795632, 'support': 137192}, 'accuracy': 0.4650343512459992, 'macro avg': {'precision': 0.46542193481731403, 'recall': 0.464639055561704, 'f1-score': 0.46345108752650527, 'support': 415851}, 'weighted avg': {'precision': 0.46573475198688846, 'recall': 0.4650343512459992, 'f1-score': 0.4638321008688248, 'support': 415851}}
[[54367 35015 43942]
 [35693 66537 43105]
 [27592 37119 72481]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0317742
{'0': {'precision': 0.46184165277888, 'recall': 0.45979826709857524, 'f1-score': 0.4608176947237839, 'support': 37971}, '1': {'precision': 0.5308103258431548, 'recall': 0.33568886367153244, 'f1-score': 0.4112805118887748, 'support': 38774}, '2': {'precision': 0.44426457854910967, 'recall': 0.6097920165353313, 'f1-score': 0.5140312095044157, 'support': 38705}, 'accuracy': 0.46840190558683414, 'macro avg': {'precision': 0.4789721857237148, 'recall': 0.4684263824351464, 'f1-score': 0.4620431387056581, 'support': 115450}, 'weighted avg': {'precision': 0.47911207868906563, 'recall': 0.46840190558683414, 'f1-score': 0.4620205908895675, 'support': 115450}}
[[17459  5674 14838]
 [11072 13016 14686]
 [ 9272  5831 23602]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0358223
{'0': {'precision': 0.47909047543329625, 'recall': 0.40551816958277254, 'f1-score': 0.43924484291858, 'support': 14860}, '1': {'precision': 0.46759144579308065, 'recall': 0.3793796476184096, 'f1-score': 0.41889192987647017, 'support': 14927}, '2': {'precision': 0.4430850543212293, 'recall': 0.5903755868544601, 'f1-score': 0.5062342745317304, 'support': 15336}, 'accuracy': 0.459699044833012, 'macro avg': {'precision': 0.4632556585158687, 'recall': 0.4584244680185474, 'f1-score': 0.45479034910892685, 'support': 45123}, 'weighted avg': {'precision': 0.463049317850375, 'recall': 0.459699044833012, 'f1-score': 0.4552797251347381, 'support': 45123}}
[[6026 3267 5567]
 [3451 5663 5813]
 [3101 3181 9054]]
training model: results/XRAY/W0/deepLOB_L2/h30
Epoch 1/50
451/451 - 25s - loss: 3.3073 - accuracy30: 0.3689 - val_loss: 3.3177 - val_accuracy30: 0.3725 - 25s/epoch - 55ms/step
Epoch 2/50
451/451 - 23s - loss: 3.2247 - accuracy30: 0.4080 - val_loss: 3.2348 - val_accuracy30: 0.4122 - 23s/epoch - 50ms/step
Epoch 3/50
451/451 - 23s - loss: 3.1652 - accuracy30: 0.4382 - val_loss: 3.2033 - val_accuracy30: 0.4345 - 23s/epoch - 51ms/step
Epoch 4/50
451/451 - 23s - loss: 3.1349 - accuracy30: 0.4521 - val_loss: 3.1772 - val_accuracy30: 0.4383 - 23s/epoch - 51ms/step
Epoch 5/50
451/451 - 23s - loss: 3.1124 - accuracy30: 0.4587 - val_loss: 3.1772 - val_accuracy30: 0.4436 - 23s/epoch - 50ms/step
Epoch 6/50
451/451 - 23s - loss: 3.0986 - accuracy30: 0.4642 - val_loss: 3.1683 - val_accuracy30: 0.4450 - 23s/epoch - 51ms/step
Epoch 7/50
451/451 - 22s - loss: 3.0846 - accuracy30: 0.4695 - val_loss: 3.1737 - val_accuracy30: 0.4467 - 22s/epoch - 50ms/step
Epoch 8/50
451/451 - 23s - loss: 3.0747 - accuracy30: 0.4721 - val_loss: 3.1685 - val_accuracy30: 0.4493 - 23s/epoch - 51ms/step
Epoch 9/50
451/451 - 23s - loss: 3.0624 - accuracy30: 0.4770 - val_loss: 3.1741 - val_accuracy30: 0.4459 - 23s/epoch - 51ms/step
Epoch 10/50
451/451 - 22s - loss: 3.0539 - accuracy30: 0.4792 - val_loss: 3.1883 - val_accuracy30: 0.4464 - 22s/epoch - 49ms/step
Epoch 11/50
451/451 - 23s - loss: 3.0468 - accuracy30: 0.4826 - val_loss: 3.2036 - val_accuracy30: 0.4417 - 23s/epoch - 50ms/step
Epoch 12/50
451/451 - 22s - loss: 3.0371 - accuracy30: 0.4850 - val_loss: 3.2026 - val_accuracy30: 0.4400 - 22s/epoch - 50ms/step
Epoch 13/50
451/451 - 23s - loss: 3.0272 - accuracy30: 0.4885 - val_loss: 3.2147 - val_accuracy30: 0.4402 - 23s/epoch - 50ms/step
Epoch 14/50
451/451 - 22s - loss: 3.0191 - accuracy30: 0.4910 - val_loss: 3.2100 - val_accuracy30: 0.4404 - 22s/epoch - 50ms/step
Epoch 15/50
451/451 - 22s - loss: 3.0112 - accuracy30: 0.4925 - val_loss: 3.2268 - val_accuracy30: 0.4346 - 22s/epoch - 50ms/step
Epoch 16/50
451/451 - 22s - loss: 3.0016 - accuracy30: 0.4964 - val_loss: 3.2283 - val_accuracy30: 0.4369 - 22s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h30
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475851
{'0': {'precision': 0.47584618146279195, 'recall': 0.3478276716722554, 'f1-score': 0.4018883657466288, 'support': 137180}, '1': {'precision': 0.4418853426739461, 'recall': 0.487093758987633, 'f1-score': 0.46338952559774815, 'support': 139080}, '2': {'precision': 0.45207311361451424, 'recall': 0.5255138225243747, 'f1-score': 0.4860348705852732, 'support': 139591}, 'accuracy': 0.4540496475901224, 'macro avg': {'precision': 0.4566015459170841, 'recall': 0.4534784177280877, 'f1-score': 0.45043758730988337, 'support': 415851}, 'weighted avg': {'precision': 0.4565080536892345, 'recall': 0.4540496475901224, 'f1-score': 0.4507031481302828, 'support': 415851}}
[[47715 42717 46748]
 [29172 67745 42163]
 [23387 42847 73357]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0454324
{'0': {'precision': 0.45680051061854476, 'recall': 0.40869565217391307, 'f1-score': 0.4314112312139521, 'support': 38525}, '1': {'precision': 0.4991091991483075, 'recall': 0.3049191642995567, 'f1-score': 0.37856365973435285, 'support': 37669}, '2': {'precision': 0.4298159361037796, 'recall': 0.6347055227226411, 'f1-score': 0.5125430701979944, 'support': 39256}, 'accuracy': 0.4516847119965353, 'macro avg': {'precision': 0.46190854862354397, 'recall': 0.4494401130653703, 'f1-score': 0.4408393203820998, 'support': 115450}, 'weighted avg': {'precision': 0.46142952344726723, 'recall': 0.4516847119965353, 'f1-score': 0.4417550709808862, 'support': 115450}}
[[15745  5914 16866]
 [ 9996 11486 16187]
 [ 8727  5613 24916]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0565451
{'0': {'precision': 0.4723826567965509, 'recall': 0.3794680781546102, 'f1-score': 0.4208580953761415, 'support': 15303}, '1': {'precision': 0.4390182819934886, 'recall': 0.3612446764665476, 'f1-score': 0.39635226287824543, 'support': 14558}, '2': {'precision': 0.4293319265263057, 'recall': 0.586554842091469, 'f1-score': 0.4957771439647772, 'support': 15262}, 'accuracy': 0.44363185071914546, 'macro avg': {'precision': 0.4469109551054484, 'recall': 0.4424225322375423, 'f1-score': 0.4376625007397214, 'support': 45123}, 'weighted avg': {'precision': 0.44705723929843544, 'recall': 0.44363185071914546, 'f1-score': 0.43829174584387165, 'support': 45123}}
[[5807 3516 5980]
 [3380 5259 5919]
 [3106 3204 8952]]
training model: results/XRAY/W0/deepLOB_L2/h50
Epoch 1/50
451/451 - 25s - loss: 3.3195 - accuracy50: 0.3610 - val_loss: 3.3502 - val_accuracy50: 0.3573 - 25s/epoch - 56ms/step
Epoch 2/50
451/451 - 23s - loss: 3.2703 - accuracy50: 0.3836 - val_loss: 3.2626 - val_accuracy50: 0.3904 - 23s/epoch - 50ms/step
Epoch 3/50
451/451 - 23s - loss: 3.2236 - accuracy50: 0.4076 - val_loss: 3.2470 - val_accuracy50: 0.4011 - 23s/epoch - 50ms/step
Epoch 4/50
451/451 - 23s - loss: 3.2023 - accuracy50: 0.4210 - val_loss: 3.2422 - val_accuracy50: 0.4048 - 23s/epoch - 50ms/step
Epoch 5/50
451/451 - 23s - loss: 3.1850 - accuracy50: 0.4278 - val_loss: 3.2543 - val_accuracy50: 0.4029 - 23s/epoch - 51ms/step
Epoch 6/50
451/451 - 22s - loss: 3.1722 - accuracy50: 0.4339 - val_loss: 3.2563 - val_accuracy50: 0.4033 - 22s/epoch - 50ms/step
Epoch 7/50
451/451 - 23s - loss: 3.1636 - accuracy50: 0.4361 - val_loss: 3.2552 - val_accuracy50: 0.4064 - 23s/epoch - 50ms/step
Epoch 8/50
451/451 - 22s - loss: 3.1563 - accuracy50: 0.4393 - val_loss: 3.2675 - val_accuracy50: 0.4036 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.1464 - accuracy50: 0.4428 - val_loss: 3.2662 - val_accuracy50: 0.4043 - 22s/epoch - 49ms/step
Epoch 10/50
451/451 - 22s - loss: 3.1389 - accuracy50: 0.4471 - val_loss: 3.2749 - val_accuracy50: 0.4060 - 22s/epoch - 49ms/step
Epoch 11/50
451/451 - 22s - loss: 3.1289 - accuracy50: 0.4498 - val_loss: 3.2870 - val_accuracy50: 0.4051 - 22s/epoch - 49ms/step
Epoch 12/50
451/451 - 22s - loss: 3.1220 - accuracy50: 0.4544 - val_loss: 3.2899 - val_accuracy50: 0.4029 - 22s/epoch - 50ms/step
Epoch 13/50
451/451 - 22s - loss: 3.1125 - accuracy50: 0.4572 - val_loss: 3.3159 - val_accuracy50: 0.4010 - 22s/epoch - 50ms/step
Epoch 14/50
451/451 - 22s - loss: 3.1038 - accuracy50: 0.4593 - val_loss: 3.3232 - val_accuracy50: 0.3952 - 22s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h50
Evaluating performance on  test set...
1625/1625 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0704596
{'0': {'precision': 0.42674730117464293, 'recall': 0.3957529383227855, 'f1-score': 0.41066613783450856, 'support': 136047}, '1': {'precision': 0.405101286749301, 'recall': 0.37799719917823604, 'f1-score': 0.39108018857516896, 'support': 140673}, '2': {'precision': 0.4207127707923042, 'recall': 0.4790521163507773, 'f1-score': 0.44799112769067906, 'support': 139131}, 'accuracy': 0.41761592493465205, 'macro avg': {'precision': 0.417520452905416, 'recall': 0.417600751283933, 'f1-score': 0.4165791513667855, 'support': 415851}, 'weighted avg': {'precision': 0.41740597451225353, 'recall': 0.41761592493465205, 'f1-score': 0.41652845131582705, 'support': 415851}}
[[53841 37684 44522]
 [40248 53174 47251]
 [32077 40403 66651]]
Evaluating performance on  train set...
451/451 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0719832
{'0': {'precision': 0.4154647326662486, 'recall': 0.39794212890420977, 'f1-score': 0.40651469273966573, 'support': 38292}, '1': {'precision': 0.42396627347442833, 'recall': 0.2625112060328007, 'f1-score': 0.3242521454509925, 'support': 37926}, '2': {'precision': 0.406384517996021, 'recall': 0.5727212479608483, 'f1-score': 0.4754237108821227, 'support': 39232}, 'accuracy': 0.41284538761368555, 'macro avg': {'precision': 0.41527184137889933, 'recall': 0.4110581942992863, 'f1-score': 0.40206351635759363, 'support': 115450}, 'weighted avg': {'precision': 0.4151719172028329, 'recall': 0.41284538761368555, 'f1-score': 0.40290749682190613, 'support': 115450}}
[[15238  6751 16303]
 [11452  9956 16518]
 [ 9987  6776 22469]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0801977
{'0': {'precision': 0.43550078657577346, 'recall': 0.32679695697796435, 'f1-score': 0.37339827650805546, 'support': 15248}, '1': {'precision': 0.4027499283872816, 'recall': 0.28363929796247733, 'f1-score': 0.33285984848484856, 'support': 14871}, '2': {'precision': 0.38990865218890036, 'recall': 0.6031058384430819, 'f1-score': 0.47362085208834925, 'support': 15004}, 'accuracy': 0.4044500587283647, 'macro avg': {'precision': 0.4093864557173184, 'recall': 0.4045140311278412, 'f1-score': 0.39329299236041776, 'support': 45123}, 'weighted avg': {'precision': 0.4095472286017534, 'recall': 0.4044500587283647, 'f1-score': 0.3933635394753585, 'support': 45123}}
[[4983 3229 7036]
 [3530 4218 7123]
 [2929 3026 9049]]
training model: results/XRAY/W0/deepLOB_L2/h100
Epoch 1/50
451/451 - 25s - loss: 3.3390 - accuracy100: 0.3501 - val_loss: 3.3626 - val_accuracy100: 0.3452 - 25s/epoch - 56ms/step
Epoch 2/50
451/451 - 22s - loss: 3.2985 - accuracy100: 0.3585 - val_loss: 3.3241 - val_accuracy100: 0.3506 - 22s/epoch - 50ms/step
Epoch 3/50
451/451 - 22s - loss: 3.2773 - accuracy100: 0.3720 - val_loss: 3.3025 - val_accuracy100: 0.3638 - 22s/epoch - 50ms/step
Epoch 4/50
451/451 - 22s - loss: 3.2632 - accuracy100: 0.3858 - val_loss: 3.3053 - val_accuracy100: 0.3640 - 22s/epoch - 49ms/step
Epoch 5/50
451/451 - 23s - loss: 3.2500 - accuracy100: 0.3891 - val_loss: 3.3212 - val_accuracy100: 0.3638 - 23s/epoch - 50ms/step
Epoch 6/50
451/451 - 22s - loss: 3.2375 - accuracy100: 0.3990 - val_loss: 3.3088 - val_accuracy100: 0.3713 - 22s/epoch - 50ms/step
Epoch 7/50
451/451 - 22s - loss: 3.2258 - accuracy100: 0.4046 - val_loss: 3.2978 - val_accuracy100: 0.3713 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 22s - loss: 3.2139 - accuracy100: 0.4115 - val_loss: 3.2995 - val_accuracy100: 0.3736 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.2019 - accuracy100: 0.4175 - val_loss: 3.3073 - val_accuracy100: 0.3719 - 22s/epoch - 49ms/step
Epoch 10/50
451/451 - 22s - loss: 3.1945 - accuracy100: 0.4202 - val_loss: 3.3283 - val_accuracy100: 0.3715 - 22s/epoch - 49ms/step
Epoch 11/50
451/451 - 22s - loss: 3.1860 - accuracy100: 0.4250 - val_loss: 3.3239 - val_accuracy100: 0.3740 - 22s/epoch - 49ms/step
Epoch 12/50
451/451 - 22s - loss: 3.1725 - accuracy100: 0.4298 - val_loss: 3.3329 - val_accuracy100: 0.3711 - 22s/epoch - 50ms/step
Epoch 13/50
451/451 - 22s - loss: 3.1639 - accuracy100: 0.4325 - val_loss: 3.3315 - val_accuracy100: 0.3724 - 22s/epoch - 49ms/step
Epoch 14/50
451/451 - 22s - loss: 3.1529 - accuracy100: 0.4393 - val_loss: 3.3341 - val_accuracy100: 0.3730 - 22s/epoch - 49ms/step
Epoch 15/50
451/451 - 22s - loss: 3.1418 - accuracy100: 0.4429 - val_loss: 3.3327 - val_accuracy100: 0.3742 - 22s/epoch - 50ms/step
Epoch 16/50
451/451 - 22s - loss: 3.1306 - accuracy100: 0.4477 - val_loss: 3.3578 - val_accuracy100: 0.3706 - 22s/epoch - 50ms/step
Epoch 17/50
451/451 - 22s - loss: 3.1155 - accuracy100: 0.4530 - val_loss: 3.3650 - val_accuracy100: 0.3734 - 22s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h100
Evaluating performance on  test set...
1625/1625 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1024358
{'0': {'precision': 0.34991143749875614, 'recall': 0.385843763487268, 'f1-score': 0.3670001809048023, 'support': 136703}, '1': {'precision': 0.3782309671836214, 'recall': 0.24113449434858042, 'f1-score': 0.29450958661199156, 'support': 137753}, '2': {'precision': 0.3666237985650467, 'recall': 0.4596909367375084, 'f1-score': 0.4079163306483245, 'support': 141395}, 'accuracy': 0.3630170421617358, 'macro avg': {'precision': 0.3649220677491414, 'recall': 0.3622230648577856, 'f1-score': 0.35647536605503943, 'support': 415851}, 'weighted avg': {'precision': 0.36497487239646564, 'recall': 0.3630170421617358, 'f1-score': 0.35689930861489017, 'support': 415851}}
[[52746 28061 55896]
 [48142 33217 56394]
 [49853 26544 64998]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985818
{'0': {'precision': 0.36494524665279443, 'recall': 0.4561767642267879, 'f1-score': 0.4054928245308797, 'support': 38062}, '1': {'precision': 0.4154686420993157, 'recall': 0.1737007874015748, 'f1-score': 0.2449795480205075, 'support': 38100}, '2': {'precision': 0.37163098721700294, 'recall': 0.49134595805334963, 'f1-score': 0.42318484742195717, 'support': 39288}, 'accuracy': 0.37492420961455175, 'macro avg': {'precision': 0.38401495865637103, 'recall': 0.3737411698939041, 'f1-score': 0.3578857399911148, 'support': 115450}, 'weighted avg': {'precision': 0.3838938022335574, 'recall': 0.37492420961455175, 'f1-score': 0.35854200911554385, 'support': 115450}}
[[17363  4741 15958]
 [14800  6618 16682]
 [15414  4570 19304]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0983526
{'0': {'precision': 0.38875410303981733, 'recall': 0.35778551257634467, 'f1-score': 0.37262747512054994, 'support': 15227}, '1': {'precision': 0.38353587962962965, 'recall': 0.17730069555912253, 'f1-score': 0.2424990852542993, 'support': 14952}, '2': {'precision': 0.3605405628796958, 'recall': 0.583779443254818, 'f1-score': 0.4457729746301832, 'support': 14944}, 'accuracy': 0.3728253883828646, 'macro avg': {'precision': 0.37761018184971423, 'recall': 0.3729552171300951, 'f1-score': 0.35363317833501084, 'support': 45123}, 'weighted avg': {'precision': 0.37768112427993916, 'recall': 0.3728253883828646, 'f1-score': 0.3537326024257331, 'support': 45123}}
[[5448 2218 7561]
 [4389 2651 7912]
 [4177 2043 8724]]
training model: results/XRAY/W0/deepLOB_L2/h200
Epoch 1/50
451/451 - 24s - loss: 3.3242 - accuracy200: 0.3613 - val_loss: 3.3574 - val_accuracy200: 0.3385 - 24s/epoch - 54ms/step
Epoch 2/50
451/451 - 22s - loss: 3.2901 - accuracy200: 0.3706 - val_loss: 3.3323 - val_accuracy200: 0.3400 - 22s/epoch - 50ms/step
Epoch 3/50
451/451 - 22s - loss: 3.2714 - accuracy200: 0.3818 - val_loss: 3.3162 - val_accuracy200: 0.3495 - 22s/epoch - 49ms/step
Epoch 4/50
451/451 - 22s - loss: 3.2576 - accuracy200: 0.3928 - val_loss: 3.3264 - val_accuracy200: 0.3496 - 22s/epoch - 50ms/step
Epoch 5/50
451/451 - 23s - loss: 3.2459 - accuracy200: 0.3980 - val_loss: 3.3418 - val_accuracy200: 0.3476 - 23s/epoch - 50ms/step
Epoch 6/50
451/451 - 22s - loss: 3.2333 - accuracy200: 0.4049 - val_loss: 3.3482 - val_accuracy200: 0.3474 - 22s/epoch - 50ms/step
Epoch 7/50
451/451 - 22s - loss: 3.2264 - accuracy200: 0.4094 - val_loss: 3.3362 - val_accuracy200: 0.3564 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 22s - loss: 3.2157 - accuracy200: 0.4143 - val_loss: 3.3216 - val_accuracy200: 0.3575 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.2057 - accuracy200: 0.4195 - val_loss: 3.3339 - val_accuracy200: 0.3527 - 22s/epoch - 49ms/step
Epoch 10/50
451/451 - 22s - loss: 3.1936 - accuracy200: 0.4242 - val_loss: 3.3496 - val_accuracy200: 0.3474 - 22s/epoch - 49ms/step
Epoch 11/50
451/451 - 22s - loss: 3.1807 - accuracy200: 0.4305 - val_loss: 3.3731 - val_accuracy200: 0.3482 - 22s/epoch - 49ms/step
Epoch 12/50
451/451 - 22s - loss: 3.1672 - accuracy200: 0.4371 - val_loss: 3.3652 - val_accuracy200: 0.3459 - 22s/epoch - 49ms/step
Epoch 13/50
451/451 - 22s - loss: 3.1506 - accuracy200: 0.4449 - val_loss: 3.4312 - val_accuracy200: 0.3401 - 22s/epoch - 49ms/step
testing model: results/XRAY/W0/deepLOB_L2/h200
Evaluating performance on  test set...
1625/1625 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1037124
{'0': {'precision': 0.2352032550955054, 'recall': 0.23686756587559046, 'f1-score': 0.23603247667747332, 'support': 105426}, '1': {'precision': 0.5166700661981494, 'recall': 0.2853916472486109, 'f1-score': 0.36768572493674184, 'support': 195265}, '2': {'precision': 0.29788773219833414, 'recall': 0.5220562695380341, 'f1-score': 0.37932872948220875, 'support': 115160}, 'accuracy': 0.3386284991499359, 'macro avg': {'precision': 0.34992035116399633, 'recall': 0.3481051608874118, 'f1-score': 0.3276823103654746, 'support': 415851}, 'weighted avg': {'precision': 0.384726428667577, 'recall': 0.3386284991499359, 'f1-score': 0.33753341810682996, 'support': 415851}}
[[24972 25210 55244]
 [53081 55727 86457]
 [28119 26921 60120]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045864
{'0': {'precision': 0.32431892359954706, 'recall': 0.2573535241417585, 'f1-score': 0.2869815074044058, 'support': 37839}, '1': {'precision': 0.3702210545388657, 'recall': 0.21479067567212426, 'f1-score': 0.27185790077668937, 'support': 38051}, '2': {'precision': 0.36299488539496116, 'recall': 0.5812689585439839, 'f1-score': 0.44690403078477864, 'support': 39560}, 'accuracy': 0.3543178865309658, 'macro avg': {'precision': 0.3525116211777913, 'recall': 0.35113771945262223, 'f1-score': 0.33524781298862466, 'support': 115450}, 'weighted avg': {'precision': 0.3527004137078069, 'recall': 0.3543178865309658, 'f1-score': 0.3367958570721088, 'support': 115450}}
[[ 9738  6946 21155]
 [10680  8173 19198]
 [ 9608  6957 22995]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036421
{'0': {'precision': 0.34183266932270917, 'recall': 0.174390243902439, 'f1-score': 0.23095558546433378, 'support': 14760}, '1': {'precision': 0.3833015353865722, 'recall': 0.26448094282848544, 'f1-score': 0.3129938054082125, 'support': 15952}, '2': {'precision': 0.3355525464530204, 'recall': 0.6190410103393241, 'f1-score': 0.4352025757982292, 'support': 14411}, 'accuracy': 0.3482481218004122, 'macro avg': {'precision': 0.3535622503874339, 'recall': 0.3526373990234162, 'f1-score': 0.3263839888902585, 'support': 45123}, 'weighted avg': {'precision': 0.3544871581815097, 'recall': 0.3482481218004122, 'f1-score': 0.3251886165625879, 'support': 45123}}
[[2574 3561 8625]
 [2693 4219 9040]
 [2263 3227 8921]]
training model: results/XRAY/W0/deepLOB_L2/h300
Epoch 1/50
451/451 - 24s - loss: 3.3155 - accuracy300: 0.3700 - val_loss: 3.3952 - val_accuracy300: 0.3341 - 24s/epoch - 54ms/step
Epoch 2/50
451/451 - 22s - loss: 3.2770 - accuracy300: 0.3859 - val_loss: 3.3610 - val_accuracy300: 0.3372 - 22s/epoch - 49ms/step
Epoch 3/50
451/451 - 22s - loss: 3.2537 - accuracy300: 0.3911 - val_loss: 3.3525 - val_accuracy300: 0.3483 - 22s/epoch - 49ms/step
Epoch 4/50
451/451 - 22s - loss: 3.2275 - accuracy300: 0.4071 - val_loss: 3.3617 - val_accuracy300: 0.3457 - 22s/epoch - 49ms/step
Epoch 5/50
451/451 - 22s - loss: 3.2133 - accuracy300: 0.4147 - val_loss: 3.4346 - val_accuracy300: 0.3478 - 22s/epoch - 49ms/step
Epoch 6/50
451/451 - 22s - loss: 3.2007 - accuracy300: 0.4212 - val_loss: 3.4841 - val_accuracy300: 0.3412 - 22s/epoch - 49ms/step
Epoch 7/50
451/451 - 22s - loss: 3.1850 - accuracy300: 0.4279 - val_loss: 3.4849 - val_accuracy300: 0.3377 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 22s - loss: 3.1732 - accuracy300: 0.4337 - val_loss: 3.5084 - val_accuracy300: 0.3398 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.1566 - accuracy300: 0.4429 - val_loss: 3.4658 - val_accuracy300: 0.3323 - 22s/epoch - 49ms/step
Epoch 10/50
451/451 - 22s - loss: 3.1458 - accuracy300: 0.4457 - val_loss: 3.4742 - val_accuracy300: 0.3310 - 22s/epoch - 49ms/step
Epoch 11/50
451/451 - 22s - loss: 3.1253 - accuracy300: 0.4550 - val_loss: 3.4756 - val_accuracy300: 0.3365 - 22s/epoch - 50ms/step
Epoch 12/50
451/451 - 23s - loss: 3.1134 - accuracy300: 0.4610 - val_loss: 3.4812 - val_accuracy300: 0.3301 - 23s/epoch - 50ms/step
Epoch 13/50
451/451 - 23s - loss: 3.0933 - accuracy300: 0.4672 - val_loss: 3.4891 - val_accuracy300: 0.3295 - 23s/epoch - 50ms/step
testing model: results/XRAY/W0/deepLOB_L2/h300
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040685
{'0': {'precision': 0.2839241167256483, 'recall': 0.042026259972005396, 'f1-score': 0.07321524744180481, 'support': 116451}, '1': {'precision': 0.42828232620890433, 'recall': 0.4823573766558703, 'f1-score': 0.45371432562912895, 'support': 175059}, '2': {'precision': 0.3043156682485158, 'recall': 0.4930393032065047, 'f1-score': 0.3763432609049304, 'support': 124341}, 'accuracy': 0.36224513106857986, 'macro avg': {'precision': 0.3388407037276895, 'recall': 0.3391409799447935, 'f1-score': 0.3010909446586214, 'support': 415851}, 'weighted avg': {'precision': 0.3507911188534157, 'recall': 0.36224513106857986, 'f1-score': 0.32402870815348583, 'support': 415851}}
[[ 4894 54768 56789]
 [ 7260 84441 83358]
 [ 5083 57953 61305]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1084188
{'0': {'precision': 0.32618619449439756, 'recall': 0.0629387428266382, 'f1-score': 0.10551751913008457, 'support': 37465}, '1': {'precision': 0.357685386873757, 'recall': 0.49430672983797086, 'f1-score': 0.4150420888371173, 'support': 38203}, '2': {'precision': 0.36307869952729765, 'recall': 0.5058569202151727, 'f1-score': 0.4227375850768843, 'support': 39782}, 'accuracy': 0.3583022953659593, 'macro avg': {'precision': 0.3489834269651508, 'recall': 0.3543674642932606, 'f1-score': 0.31443239768136205, 'support': 115450}, 'weighted avg': {'precision': 0.34932193534920486, 'recall': 0.3583022953659593, 'f1-score': 0.3172491414775368, 'support': 115450}}
[[ 2358 16472 18635]
 [ 2652 18884 16667]
 [ 2219 17439 20124]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1143593
{'0': {'precision': 0.37037037037037035, 'recall': 0.03299475965581937, 'f1-score': 0.06059165973624807, 'support': 15457}, '1': {'precision': 0.35207578469463485, 'recall': 0.5455221861471862, 'f1-score': 0.4279536228807938, 'support': 14784}, '2': {'precision': 0.346129852680071, 'recall': 0.48467947856470905, 'f1-score': 0.4038520758097478, 'support': 14882}, 'accuracy': 0.3498880836823793, 'macro avg': {'precision': 0.3561920025816921, 'recall': 0.3543988081225715, 'f1-score': 0.2974657861422632, 'support': 45123}, 'weighted avg': {'precision': 0.35638161654422607, 'recall': 0.3498880836823793, 'f1-score': 0.29416391280308285, 'support': 45123}}
[[ 510 7613 7334]
 [ 427 8065 6292]
 [ 440 7229 7213]]
training model: results/XRAY/W0/deepLOB_L2/h500
Epoch 1/50
451/451 - 25s - loss: 3.3316 - accuracy500: 0.3639 - val_loss: 3.4458 - val_accuracy500: 0.3457 - 25s/epoch - 55ms/step
Epoch 2/50
451/451 - 22s - loss: 3.2930 - accuracy500: 0.3766 - val_loss: 3.4167 - val_accuracy500: 0.3466 - 22s/epoch - 49ms/step
Epoch 3/50
451/451 - 22s - loss: 3.2562 - accuracy500: 0.3992 - val_loss: 3.4007 - val_accuracy500: 0.3479 - 22s/epoch - 49ms/step
Epoch 4/50
451/451 - 22s - loss: 3.2392 - accuracy500: 0.4080 - val_loss: 3.4852 - val_accuracy500: 0.3404 - 22s/epoch - 49ms/step
Epoch 5/50
451/451 - 22s - loss: 3.2181 - accuracy500: 0.4168 - val_loss: 3.5512 - val_accuracy500: 0.3480 - 22s/epoch - 49ms/step
Epoch 6/50
451/451 - 22s - loss: 3.1970 - accuracy500: 0.4259 - val_loss: 3.4348 - val_accuracy500: 0.3521 - 22s/epoch - 49ms/step
Epoch 7/50
451/451 - 22s - loss: 3.1841 - accuracy500: 0.4331 - val_loss: 3.4952 - val_accuracy500: 0.3510 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 22s - loss: 3.1680 - accuracy500: 0.4394 - val_loss: 3.5316 - val_accuracy500: 0.3542 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.1498 - accuracy500: 0.4460 - val_loss: 3.5479 - val_accuracy500: 0.3465 - 22s/epoch - 50ms/step
Epoch 10/50
451/451 - 23s - loss: 3.1387 - accuracy500: 0.4518 - val_loss: 3.4632 - val_accuracy500: 0.3488 - 23s/epoch - 50ms/step
Epoch 11/50
451/451 - 23s - loss: 3.1207 - accuracy500: 0.4585 - val_loss: 3.5206 - val_accuracy500: 0.3443 - 23s/epoch - 51ms/step
Epoch 12/50
451/451 - 22s - loss: 3.1032 - accuracy500: 0.4638 - val_loss: 3.5368 - val_accuracy500: 0.3466 - 22s/epoch - 50ms/step
Epoch 13/50
451/451 - 22s - loss: 3.0866 - accuracy500: 0.4702 - val_loss: 3.5082 - val_accuracy500: 0.3475 - 22s/epoch - 49ms/step
testing model: results/XRAY/W0/deepLOB_L2/h500
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1276745
{'0': {'precision': 0.29093281148075667, 'recall': 0.06681279172448594, 'f1-score': 0.10866958623740856, 'support': 126832}, '1': {'precision': 0.38114910223742243, 'recall': 0.29144388488277256, 'f1-score': 0.3303144017343267, 'support': 154486}, '2': {'precision': 0.31351429837265493, 'recall': 0.6259356440427256, 'f1-score': 0.4177759035546846, 'support': 134533}, 'accuracy': 0.3311450495489971, 'macro avg': {'precision': 0.3285320706969446, 'recall': 0.32806410688332804, 'f1-score': 0.2855866305088066, 'support': 415851}, 'weighted avg': {'precision': 0.33175298281583104, 'recall': 0.3311450495489971, 'f1-score': 0.2910089846144763, 'support': 415851}}
[[  8474  34461  83897]
 [  8971  45024 100491]
 [ 11682  38642  84209]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114078
{'0': {'precision': 0.33421477890406937, 'recall': 0.12262828805519621, 'f1-score': 0.179423478843803, 'support': 37104}, '1': {'precision': 0.374459633134712, 'recall': 0.33968363318407035, 'f1-score': 0.356224905178043, 'support': 37741}, '2': {'precision': 0.3744526627218935, 'recall': 0.6233961334810983, 'f1-score': 0.46787117046347204, 'support': 40605}, 'accuracy': 0.3697098310957124, 'macro avg': {'precision': 0.36104235825355824, 'recall': 0.36190268490678834, 'f1-score': 0.3345065181617726, 'support': 115450}, 'weighted avg': {'precision': 0.36152305361988946, 'recall': 0.3697098310957124, 'f1-score': 0.33867060876582306, 'support': 115450}}
[[ 4550 10500 22054]
 [ 4688 12820 20233]
 [ 4376 10916 25313]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1242539
{'0': {'precision': 0.4087112171837709, 'recall': 0.045226462432325365, 'f1-score': 0.08144097015812626, 'support': 15146}, '1': {'precision': 0.359653413458179, 'recall': 0.341902484389531, 'f1-score': 0.35055337987399965, 'support': 15054}, '2': {'precision': 0.3445222405271829, 'recall': 0.6726529518193393, 'f1-score': 0.45566172632152335, 'support': 14923}, 'accuracy': 0.3517053387407752, 'macro avg': {'precision': 0.37096229038971096, 'recall': 0.3532606328803986, 'f1-score': 0.29588535878454975, 'support': 45123}, 'weighted avg': {'precision': 0.3711160157137595, 'recall': 0.3517053387407752, 'f1-score': 0.29498427534814314, 'support': 45123}}
[[  685  4841  9620]
 [  429  5147  9478]
 [  562  4323 10038]]
training model: results/XRAY/W0/deepLOB_L2/h1000
Epoch 1/50
451/451 - 25s - loss: 3.3110 - accuracy1000: 0.3747 - val_loss: 3.5622 - val_accuracy1000: 0.3324 - 25s/epoch - 55ms/step
Epoch 2/50
451/451 - 22s - loss: 3.2440 - accuracy1000: 0.4146 - val_loss: 3.6606 - val_accuracy1000: 0.3366 - 22s/epoch - 49ms/step
Epoch 3/50
451/451 - 22s - loss: 3.2239 - accuracy1000: 0.4214 - val_loss: 3.5052 - val_accuracy1000: 0.3279 - 22s/epoch - 49ms/step
Epoch 4/50
451/451 - 22s - loss: 3.2112 - accuracy1000: 0.4227 - val_loss: 3.5693 - val_accuracy1000: 0.3356 - 22s/epoch - 49ms/step
Epoch 5/50
451/451 - 22s - loss: 3.1861 - accuracy1000: 0.4298 - val_loss: 3.4825 - val_accuracy1000: 0.3448 - 22s/epoch - 49ms/step
Epoch 6/50
451/451 - 22s - loss: 3.1602 - accuracy1000: 0.4379 - val_loss: 3.5071 - val_accuracy1000: 0.3467 - 22s/epoch - 49ms/step
Epoch 7/50
451/451 - 22s - loss: 3.1324 - accuracy1000: 0.4513 - val_loss: 3.5020 - val_accuracy1000: 0.3415 - 22s/epoch - 49ms/step
Epoch 8/50
451/451 - 22s - loss: 3.1163 - accuracy1000: 0.4590 - val_loss: 3.4895 - val_accuracy1000: 0.3528 - 22s/epoch - 49ms/step
Epoch 9/50
451/451 - 22s - loss: 3.0963 - accuracy1000: 0.4655 - val_loss: 3.5966 - val_accuracy1000: 0.3461 - 22s/epoch - 49ms/step
Epoch 10/50
451/451 - 23s - loss: 3.0784 - accuracy1000: 0.4711 - val_loss: 3.4626 - val_accuracy1000: 0.3514 - 23s/epoch - 50ms/step
Epoch 11/50
451/451 - 23s - loss: 3.0609 - accuracy1000: 0.4791 - val_loss: 3.5466 - val_accuracy1000: 0.3385 - 23s/epoch - 51ms/step
Epoch 12/50
451/451 - 22s - loss: 3.0502 - accuracy1000: 0.4778 - val_loss: 3.5654 - val_accuracy1000: 0.3371 - 22s/epoch - 49ms/step
Epoch 13/50
451/451 - 22s - loss: 3.0305 - accuracy1000: 0.4833 - val_loss: 3.6032 - val_accuracy1000: 0.3340 - 22s/epoch - 49ms/step
Epoch 14/50
451/451 - 22s - loss: 3.0154 - accuracy1000: 0.4913 - val_loss: 3.5478 - val_accuracy1000: 0.3397 - 22s/epoch - 49ms/step
Epoch 15/50
451/451 - 22s - loss: 2.9968 - accuracy1000: 0.4943 - val_loss: 3.6719 - val_accuracy1000: 0.3396 - 22s/epoch - 49ms/step
Epoch 16/50
451/451 - 22s - loss: 2.9895 - accuracy1000: 0.4968 - val_loss: 3.6685 - val_accuracy1000: 0.3394 - 22s/epoch - 49ms/step
Epoch 17/50
451/451 - 22s - loss: 2.9676 - accuracy1000: 0.5049 - val_loss: 3.6574 - val_accuracy1000: 0.3365 - 22s/epoch - 49ms/step
Epoch 18/50
451/451 - 22s - loss: 2.9380 - accuracy1000: 0.5136 - val_loss: 3.6730 - val_accuracy1000: 0.3390 - 22s/epoch - 49ms/step
Epoch 19/50
451/451 - 23s - loss: 2.9240 - accuracy1000: 0.5183 - val_loss: 3.6782 - val_accuracy1000: 0.3393 - 23s/epoch - 50ms/step
Epoch 20/50
451/451 - 22s - loss: 2.8986 - accuracy1000: 0.5237 - val_loss: 3.6856 - val_accuracy1000: 0.3405 - 22s/epoch - 49ms/step
testing model: results/XRAY/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1894984
{'0': {'precision': 0.2739375320020481, 'recall': 0.20483101876022414, 'f1-score': 0.23439678177400725, 'support': 114924}, '1': {'precision': 0.4173949642247035, 'recall': 0.0946677447974574, 'f1-score': 0.15433203495104747, 'support': 178086}, '2': {'precision': 0.2738491613937167, 'recall': 0.6454441106796591, 'f1-score': 0.3845439400148896, 'support': 122841}, 'accuracy': 0.28780981649677406, 'macro avg': {'precision': 0.3217272192068228, 'recall': 0.3149809580791136, 'f1-score': 0.25775758557998146, 'support': 415851}, 'weighted avg': {'precision': 0.335346317218161, 'recall': 0.28780981649677406, 'f1-score': 0.24446244606904227, 'support': 415851}}
[[ 23540  11297  80087]
 [ 31073  16859 130154]
 [ 31319  12235  79287]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1536057
{'0': {'precision': 0.35220025932100235, 'recall': 0.35561611627658435, 'f1-score': 0.35389994549249526, 'support': 37428}, '1': {'precision': 0.35695325173278275, 'recall': 0.1324668217266384, 'f1-score': 0.19322649530005787, 'support': 36545}, '2': {'precision': 0.37652308220353525, 'recall': 0.5818646478771368, 'f1-score': 0.4571959005058064, 'support': 41477}, 'accuracy': 0.36626245127760937, 'macro avg': {'precision': 0.36189219775244014, 'recall': 0.3566491952934532, 'f1-score': 0.3347741137661198, 'support': 115450}, 'weighted avg': {'precision': 0.3624430989259164, 'recall': 0.36626245127760937, 'f1-score': 0.3401502277688442, 'support': 115450}}
[[13310  4017 20101]
 [11842  4841 19862]
 [12639  4704 24134]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1446385
{'0': {'precision': 0.4151562910428159, 'recall': 0.20406714009038088, 'f1-score': 0.273632271468144, 'support': 15490}, '1': {'precision': 0.33778966131907306, 'recall': 0.1804393661157587, 'f1-score': 0.23522631555614662, 'support': 14703}, '2': {'precision': 0.34102175012645425, 'recall': 0.6773610180843939, 'f1-score': 0.4536503308287541, 'support': 14930}, 'accuracy': 0.35296855262283094, 'macro avg': {'precision': 0.3646559008294477, 'recall': 0.35395584143017783, 'f1-score': 0.3208363059510149, 'support': 45123}, 'weighted avg': {'precision': 0.3654177928775904, 'recall': 0.35296855262283094, 'f1-score': 0.3206811568809005, 'support': 45123}}
[[ 3161  2845  9484]
 [ 1992  2653 10058]
 [ 2461  2356 10113]]
training model: results/XRAY/W0/deepOF_L2/h10
Epoch 1/50
451/451 - 17s - loss: 3.1957 - accuracy10: 0.4094 - val_loss: 3.1155 - val_accuracy10: 0.3976 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.0728 - accuracy10: 0.4526 - val_loss: 3.0545 - val_accuracy10: 0.4385 - 14s/epoch - 32ms/step
Epoch 3/50
451/451 - 15s - loss: 3.0166 - accuracy10: 0.4821 - val_loss: 3.0139 - val_accuracy10: 0.4806 - 15s/epoch - 32ms/step
Epoch 4/50
451/451 - 14s - loss: 2.9753 - accuracy10: 0.5008 - val_loss: 2.9921 - val_accuracy10: 0.5099 - 14s/epoch - 32ms/step
Epoch 5/50
451/451 - 15s - loss: 2.9408 - accuracy10: 0.5152 - val_loss: 2.9728 - val_accuracy10: 0.5134 - 15s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 2.9166 - accuracy10: 0.5212 - val_loss: 2.9654 - val_accuracy10: 0.5131 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 2.9000 - accuracy10: 0.5235 - val_loss: 2.9515 - val_accuracy10: 0.5149 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 2.8817 - accuracy10: 0.5287 - val_loss: 2.9426 - val_accuracy10: 0.5184 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 15s - loss: 2.8702 - accuracy10: 0.5310 - val_loss: 2.9408 - val_accuracy10: 0.5175 - 15s/epoch - 32ms/step
Epoch 10/50
451/451 - 15s - loss: 2.8582 - accuracy10: 0.5342 - val_loss: 2.9345 - val_accuracy10: 0.5236 - 15s/epoch - 32ms/step
Epoch 11/50
451/451 - 15s - loss: 2.8466 - accuracy10: 0.5370 - val_loss: 2.9256 - val_accuracy10: 0.5241 - 15s/epoch - 32ms/step
Epoch 12/50
451/451 - 15s - loss: 2.8378 - accuracy10: 0.5385 - val_loss: 2.9255 - val_accuracy10: 0.5241 - 15s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 2.8294 - accuracy10: 0.5416 - val_loss: 2.9199 - val_accuracy10: 0.5258 - 15s/epoch - 32ms/step
Epoch 14/50
451/451 - 15s - loss: 2.8184 - accuracy10: 0.5447 - val_loss: 2.9169 - val_accuracy10: 0.5245 - 15s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 2.8114 - accuracy10: 0.5445 - val_loss: 2.9241 - val_accuracy10: 0.5278 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 14s - loss: 2.8029 - accuracy10: 0.5463 - val_loss: 2.9181 - val_accuracy10: 0.5274 - 14s/epoch - 32ms/step
Epoch 17/50
451/451 - 14s - loss: 2.7945 - accuracy10: 0.5483 - val_loss: 2.9288 - val_accuracy10: 0.5256 - 14s/epoch - 32ms/step
Epoch 18/50
451/451 - 14s - loss: 2.7860 - accuracy10: 0.5502 - val_loss: 2.9330 - val_accuracy10: 0.5256 - 14s/epoch - 32ms/step
Epoch 19/50
451/451 - 14s - loss: 2.7777 - accuracy10: 0.5522 - val_loss: 2.9275 - val_accuracy10: 0.5230 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 2.7692 - accuracy10: 0.5543 - val_loss: 2.9254 - val_accuracy10: 0.5217 - 14s/epoch - 32ms/step
Epoch 21/50
451/451 - 15s - loss: 2.7633 - accuracy10: 0.5546 - val_loss: 2.9347 - val_accuracy10: 0.5244 - 15s/epoch - 32ms/step
Epoch 22/50
451/451 - 14s - loss: 2.7546 - accuracy10: 0.5562 - val_loss: 2.9405 - val_accuracy10: 0.5276 - 14s/epoch - 32ms/step
Epoch 23/50
451/451 - 14s - loss: 2.7455 - accuracy10: 0.5592 - val_loss: 2.9428 - val_accuracy10: 0.5222 - 14s/epoch - 32ms/step
Epoch 24/50
451/451 - 14s - loss: 2.7403 - accuracy10: 0.5607 - val_loss: 2.9475 - val_accuracy10: 0.5279 - 14s/epoch - 31ms/step
testing model: results/XRAY/W0/deepOF_L2/h10
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9444046
{'0': {'precision': 0.465725552508938, 'recall': 0.44993588123519884, 'f1-score': 0.45769457827883675, 'support': 106833}, '1': {'precision': 0.6403129948382585, 'recall': 0.6267285280086955, 'f1-score': 0.6334479391300809, 'support': 198724}, '2': {'precision': 0.451285480880747, 'recall': 0.4833573611148891, 'f1-score': 0.4667711543849818, 'support': 110289}, 'accuracy': 0.5432852546375341, 'macro avg': {'precision': 0.5191080094093145, 'recall': 0.5200072567862611, 'f1-score': 0.5193045572646331, 'support': 415846}, 'weighted avg': {'precision': 0.5453274576123907, 'recall': 0.5432852546375341, 'f1-score': 0.544090641686861, 'support': 415846}}
[[ 48068  34752  24013]
 [ 33373 124546  40805]
 [ 21770  35210  53309]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9520258
{'0': {'precision': 0.4647895551596226, 'recall': 0.5141352460340538, 'f1-score': 0.48821869055654415, 'support': 30951}, '1': {'precision': 0.6611045271391325, 'recall': 0.52625422161846, 'f1-score': 0.5860217877740543, 'support': 53001}, '2': {'precision': 0.4527049537428564, 'recall': 0.5608648717297434, 'f1-score': 0.5010139399010168, 'support': 31496}, 'accuracy': 0.5324475088351466, 'macro avg': {'precision': 0.5261996786805372, 'recall': 0.5337514464607525, 'f1-score': 0.5250848060772051, 'support': 115448}, 'weighted avg': {'precision': 0.5516188915159348, 'recall': 0.5324475088351466, 'f1-score': 0.5366098374709884, 'support': 115448}}
[[15913  7239  7799]
 [11552 27892 13557]
 [ 6772  7059 17665]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96744514
{'0': {'precision': 0.452618173645966, 'recall': 0.5059877732183234, 'f1-score': 0.4778173190984579, 'support': 11941}, '1': {'precision': 0.6359142380870265, 'recall': 0.5345735684948055, 'f1-score': 0.580856872834191, 'support': 20695}, '2': {'precision': 0.44717256729498506, 'recall': 0.5148554496676544, 'f1-score': 0.47863311494937466, 'support': 12487}, 'accuracy': 0.5215522017596348, 'macro avg': {'precision': 0.5119016596759925, 'recall': 0.5184722637935945, 'f1-score': 0.5124357689606746, 'support': 45123}, 'weighted avg': {'precision': 0.5351772403548073, 'recall': 0.5215522017596348, 'f1-score': 0.5253006514866279, 'support': 45123}}
[[ 6042  3029  2870]
 [ 4554 11063  5078]
 [ 2753  3305  6429]]
training model: results/XRAY/W0/deepOF_L2/h20
Epoch 1/50
451/451 - 17s - loss: 3.2307 - accuracy20: 0.4015 - val_loss: 3.1748 - val_accuracy20: 0.4156 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 15s - loss: 3.1329 - accuracy20: 0.4411 - val_loss: 3.1293 - val_accuracy20: 0.4372 - 15s/epoch - 32ms/step
Epoch 3/50
451/451 - 15s - loss: 3.0861 - accuracy20: 0.4599 - val_loss: 3.0973 - val_accuracy20: 0.4515 - 15s/epoch - 32ms/step
Epoch 4/50
451/451 - 15s - loss: 3.0517 - accuracy20: 0.4720 - val_loss: 3.0762 - val_accuracy20: 0.4624 - 15s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 3.0244 - accuracy20: 0.4838 - val_loss: 3.0628 - val_accuracy20: 0.4704 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 3.0002 - accuracy20: 0.4915 - val_loss: 3.0479 - val_accuracy20: 0.4754 - 14s/epoch - 32ms/step
Epoch 7/50
451/451 - 15s - loss: 2.9831 - accuracy20: 0.4987 - val_loss: 3.0371 - val_accuracy20: 0.4799 - 15s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 2.9651 - accuracy20: 0.5039 - val_loss: 3.0327 - val_accuracy20: 0.4800 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 2.9545 - accuracy20: 0.5074 - val_loss: 3.0263 - val_accuracy20: 0.4849 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 2.9437 - accuracy20: 0.5100 - val_loss: 3.0198 - val_accuracy20: 0.4863 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 2.9330 - accuracy20: 0.5136 - val_loss: 3.0165 - val_accuracy20: 0.4882 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 2.9234 - accuracy20: 0.5166 - val_loss: 3.0154 - val_accuracy20: 0.4895 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 14s - loss: 2.9140 - accuracy20: 0.5182 - val_loss: 3.0180 - val_accuracy20: 0.4856 - 14s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 2.9063 - accuracy20: 0.5210 - val_loss: 3.0105 - val_accuracy20: 0.4893 - 14s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 2.8984 - accuracy20: 0.5230 - val_loss: 3.0101 - val_accuracy20: 0.4898 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 14s - loss: 2.8892 - accuracy20: 0.5250 - val_loss: 3.0124 - val_accuracy20: 0.4883 - 14s/epoch - 31ms/step
Epoch 17/50
451/451 - 14s - loss: 2.8824 - accuracy20: 0.5266 - val_loss: 3.0112 - val_accuracy20: 0.4891 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 2.8745 - accuracy20: 0.5301 - val_loss: 3.0134 - val_accuracy20: 0.4893 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 2.8627 - accuracy20: 0.5326 - val_loss: 3.0157 - val_accuracy20: 0.4862 - 14s/epoch - 32ms/step
Epoch 20/50
451/451 - 14s - loss: 2.8561 - accuracy20: 0.5343 - val_loss: 3.0193 - val_accuracy20: 0.4871 - 14s/epoch - 32ms/step
Epoch 21/50
451/451 - 14s - loss: 2.8485 - accuracy20: 0.5384 - val_loss: 3.0292 - val_accuracy20: 0.4861 - 14s/epoch - 32ms/step
Epoch 22/50
451/451 - 15s - loss: 2.8384 - accuracy20: 0.5399 - val_loss: 3.0331 - val_accuracy20: 0.4863 - 15s/epoch - 32ms/step
Epoch 23/50
451/451 - 14s - loss: 2.8286 - accuracy20: 0.5421 - val_loss: 3.0315 - val_accuracy20: 0.4859 - 14s/epoch - 32ms/step
Epoch 24/50
451/451 - 14s - loss: 2.8219 - accuracy20: 0.5445 - val_loss: 3.0304 - val_accuracy20: 0.4871 - 14s/epoch - 32ms/step
Epoch 25/50
451/451 - 14s - loss: 2.8146 - accuracy20: 0.5457 - val_loss: 3.0375 - val_accuracy20: 0.4839 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h20
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99435264
{'0': {'precision': 0.5161717594874322, 'recall': 0.37706737873253277, 'f1-score': 0.4357881870549124, 'support': 133321}, '1': {'precision': 0.48434119658765623, 'recall': 0.7055148450132452, 'f1-score': 0.5743718438145067, 'support': 145335}, '2': {'precision': 0.5066321942446043, 'recall': 0.39422698447408705, 'f1-score': 0.4434168777824237, 'support': 137190}, 'accuracy': 0.49751831206744807, 'macro avg': {'precision': 0.5023817167732308, 'recall': 0.4922697360732884, 'f1-score': 0.4845256362172809, 'support': 415846}, 'weighted avg': {'precision': 0.5019000631991368, 'recall': 0.49751831206744807, 'f1-score': 0.48673886551776385, 'support': 415846}}
[[ 50271  52777  30273]
 [ 20404 102536  22395]
 [ 26717  56389  54084]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9764858
{'0': {'precision': 0.5105742001566548, 'recall': 0.4467406489706619, 'f1-score': 0.47652922073357606, 'support': 37937}, '1': {'precision': 0.5138324287503571, 'recall': 0.6029445891241008, 'f1-score': 0.5548331988800835, 'support': 38783}, '2': {'precision': 0.5094026398149408, 'recall': 0.48331956207395166, 'f1-score': 0.4960184436818465, 'support': 38728}, 'accuracy': 0.511485690527337, 'macro avg': {'precision': 0.5112697562406509, 'recall': 0.5110016000562382, 'f1-score': 0.5091269544318353, 'support': 115448}, 'weighted avg': {'precision': 0.5112757427614262, 'recall': 0.511485690527337, 'f1-score': 0.5093720747526723, 'support': 115448}}
[[16948 10834 10155]
 [ 7527 23384  7872]
 [ 8719 11291 18718]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0042845
{'0': {'precision': 0.5025950886978078, 'recall': 0.4363734194242669, 'f1-score': 0.4671490801742449, 'support': 14868}, '1': {'precision': 0.4725547060374374, 'recall': 0.5992644600468071, 'f1-score': 0.5284198113207548, 'support': 14955}, '2': {'precision': 0.4947543210808363, 'recall': 0.4284313725490196, 'f1-score': 0.45921048022697813, 'support': 15300}, 'accuracy': 0.4876670434146666, 'macro avg': {'precision': 0.4899680386053605, 'recall': 0.4880230840066979, 'f1-score': 0.48492645724065925, 'support': 45123}, 'weighted avg': {'precision': 0.4899802876600775, 'recall': 0.4876670434146666, 'f1-score': 0.4847641147486942, 'support': 45123}}
[[6488 4713 3667]
 [2966 8962 3027]
 [3455 5290 6555]]
training model: results/XRAY/W0/deepOF_L2/h30
Epoch 1/50
451/451 - 17s - loss: 3.2598 - accuracy30: 0.3869 - val_loss: 3.2241 - val_accuracy30: 0.4050 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.1834 - accuracy30: 0.4233 - val_loss: 3.1914 - val_accuracy30: 0.4187 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.1525 - accuracy30: 0.4361 - val_loss: 3.1690 - val_accuracy30: 0.4271 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.1292 - accuracy30: 0.4473 - val_loss: 3.1553 - val_accuracy30: 0.4363 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.1111 - accuracy30: 0.4542 - val_loss: 3.1422 - val_accuracy30: 0.4420 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.0935 - accuracy30: 0.4604 - val_loss: 3.1356 - val_accuracy30: 0.4442 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.0774 - accuracy30: 0.4663 - val_loss: 3.1277 - val_accuracy30: 0.4486 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.0662 - accuracy30: 0.4704 - val_loss: 3.1212 - val_accuracy30: 0.4503 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 3.0561 - accuracy30: 0.4737 - val_loss: 3.1177 - val_accuracy30: 0.4524 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.0466 - accuracy30: 0.4766 - val_loss: 3.1103 - val_accuracy30: 0.4549 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.0324 - accuracy30: 0.4840 - val_loss: 3.1086 - val_accuracy30: 0.4576 - 14s/epoch - 31ms/step
Epoch 12/50
451/451 - 14s - loss: 3.0258 - accuracy30: 0.4861 - val_loss: 3.1014 - val_accuracy30: 0.4599 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 3.0158 - accuracy30: 0.4893 - val_loss: 3.1059 - val_accuracy30: 0.4562 - 14s/epoch - 31ms/step
Epoch 14/50
451/451 - 14s - loss: 3.0097 - accuracy30: 0.4910 - val_loss: 3.1009 - val_accuracy30: 0.4614 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 14s - loss: 3.0011 - accuracy30: 0.4927 - val_loss: 3.0988 - val_accuracy30: 0.4597 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 14s - loss: 2.9925 - accuracy30: 0.4961 - val_loss: 3.0987 - val_accuracy30: 0.4607 - 14s/epoch - 32ms/step
Epoch 17/50
451/451 - 14s - loss: 2.9857 - accuracy30: 0.4992 - val_loss: 3.1042 - val_accuracy30: 0.4584 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 2.9766 - accuracy30: 0.5013 - val_loss: 3.1060 - val_accuracy30: 0.4604 - 14s/epoch - 32ms/step
Epoch 19/50
451/451 - 14s - loss: 2.9688 - accuracy30: 0.5041 - val_loss: 3.1005 - val_accuracy30: 0.4627 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 2.9614 - accuracy30: 0.5063 - val_loss: 3.1070 - val_accuracy30: 0.4606 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 2.9540 - accuracy30: 0.5092 - val_loss: 3.1070 - val_accuracy30: 0.4624 - 14s/epoch - 32ms/step
Epoch 22/50
451/451 - 14s - loss: 2.9459 - accuracy30: 0.5117 - val_loss: 3.1123 - val_accuracy30: 0.4588 - 14s/epoch - 32ms/step
Epoch 23/50
451/451 - 14s - loss: 2.9400 - accuracy30: 0.5137 - val_loss: 3.1175 - val_accuracy30: 0.4631 - 14s/epoch - 32ms/step
Epoch 24/50
451/451 - 14s - loss: 2.9300 - accuracy30: 0.5176 - val_loss: 3.1261 - val_accuracy30: 0.4568 - 14s/epoch - 32ms/step
Epoch 25/50
451/451 - 14s - loss: 2.9202 - accuracy30: 0.5198 - val_loss: 3.1276 - val_accuracy30: 0.4577 - 14s/epoch - 31ms/step
Epoch 26/50
451/451 - 14s - loss: 2.9098 - accuracy30: 0.5241 - val_loss: 3.1361 - val_accuracy30: 0.4575 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h30
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0236387
{'0': {'precision': 0.47480134392832385, 'recall': 0.45430754202568924, 'f1-score': 0.46432842215061376, 'support': 137178}, '1': {'precision': 0.46706913233670844, 'recall': 0.49287095823237154, 'f1-score': 0.47962328707218344, 'support': 139079}, '2': {'precision': 0.47354291974721935, 'recall': 0.46756549584852675, 'f1-score': 0.4705352250771405, 'support': 139589}, 'accuracy': 0.47165537242152145, 'macro avg': {'precision': 0.4718044653374172, 'recall': 0.47158133203552915, 'f1-score': 0.47149564476664585, 'support': 415846}, 'weighted avg': {'precision': 0.47179289746264547, 'recall': 0.47165537242152145, 'f1-score': 0.4715272311619736, 'support': 415846}}
[[62321 38841 36016]
 [33987 68548 36544]
 [34949 39373 65267]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0078832
{'0': {'precision': 0.47590405995020585, 'recall': 0.501207196448506, 'f1-score': 0.4882280049566295, 'support': 38519}, '1': {'precision': 0.5023827276558498, 'recall': 0.4109084159728483, 'f1-score': 0.452064584822275, 'support': 37714}, '2': {'precision': 0.4779034382522596, 'recall': 0.5366313910493433, 'f1-score': 0.5055676344460593, 'support': 39215}, 'accuracy': 0.48374159794886007, 'macro avg': {'precision': 0.48539674195277177, 'recall': 0.4829156678235658, 'f1-score': 0.48195340807498793, 'support': 115448}, 'weighted avg': {'precision': 0.48523312666392715, 'recall': 0.48374159794886007, 'f1-score': 0.4823041807542262, 'support': 115448}}
[[19306  7856 11357]
 [10584 15497 11633]
 [10677  7494 21044]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.033095
{'0': {'precision': 0.47336942835557794, 'recall': 0.49156642259414224, 'f1-score': 0.4822963438101347, 'support': 15296}, '1': {'precision': 0.44923029077903903, 'recall': 0.3963234789766102, 'f1-score': 0.4211216792390948, 'support': 14579}, '2': {'precision': 0.4567991695670758, 'recall': 0.4906217208814271, 'f1-score': 0.4731067193675889, 'support': 15248}, 'accuracy': 0.4604747024798883, 'macro avg': {'precision': 0.4597996295672309, 'recall': 0.4595038741507265, 'f1-score': 0.4588415808056061, 'support': 45123}, 'weighted avg': {'precision': 0.4599707670800545, 'recall': 0.4604747024798883, 'f1-score': 0.4594257716345008, 'support': 45123}}
[[7519 3413 4364]
 [4269 5778 4532]
 [4096 3671 7481]]
training model: results/XRAY/W0/deepOF_L2/h50
Epoch 1/50
451/451 - 16s - loss: 3.2958 - accuracy50: 0.3682 - val_loss: 3.2815 - val_accuracy50: 0.3875 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2459 - accuracy50: 0.3954 - val_loss: 3.2606 - val_accuracy50: 0.3978 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2264 - accuracy50: 0.4047 - val_loss: 3.2465 - val_accuracy50: 0.4053 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2121 - accuracy50: 0.4118 - val_loss: 3.2405 - val_accuracy50: 0.4073 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2019 - accuracy50: 0.4195 - val_loss: 3.2355 - val_accuracy50: 0.4075 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 3.1926 - accuracy50: 0.4229 - val_loss: 3.2279 - val_accuracy50: 0.4105 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.1843 - accuracy50: 0.4266 - val_loss: 3.2260 - val_accuracy50: 0.4116 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.1773 - accuracy50: 0.4298 - val_loss: 3.2253 - val_accuracy50: 0.4124 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.1713 - accuracy50: 0.4312 - val_loss: 3.2214 - val_accuracy50: 0.4124 - 14s/epoch - 32ms/step
Epoch 10/50
451/451 - 14s - loss: 3.1639 - accuracy50: 0.4346 - val_loss: 3.2207 - val_accuracy50: 0.4147 - 14s/epoch - 32ms/step
Epoch 11/50
451/451 - 15s - loss: 3.1573 - accuracy50: 0.4386 - val_loss: 3.2195 - val_accuracy50: 0.4163 - 15s/epoch - 32ms/step
Epoch 12/50
451/451 - 15s - loss: 3.1512 - accuracy50: 0.4413 - val_loss: 3.2175 - val_accuracy50: 0.4161 - 15s/epoch - 32ms/step
Epoch 13/50
451/451 - 14s - loss: 3.1450 - accuracy50: 0.4430 - val_loss: 3.2155 - val_accuracy50: 0.4156 - 14s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 3.1392 - accuracy50: 0.4464 - val_loss: 3.2162 - val_accuracy50: 0.4182 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 15s - loss: 3.1323 - accuracy50: 0.4496 - val_loss: 3.2206 - val_accuracy50: 0.4179 - 15s/epoch - 32ms/step
Epoch 16/50
451/451 - 15s - loss: 3.1262 - accuracy50: 0.4517 - val_loss: 3.2193 - val_accuracy50: 0.4182 - 15s/epoch - 33ms/step
Epoch 17/50
451/451 - 15s - loss: 3.1190 - accuracy50: 0.4551 - val_loss: 3.2257 - val_accuracy50: 0.4159 - 15s/epoch - 32ms/step
Epoch 18/50
451/451 - 15s - loss: 3.1112 - accuracy50: 0.4577 - val_loss: 3.2296 - val_accuracy50: 0.4181 - 15s/epoch - 32ms/step
Epoch 19/50
451/451 - 14s - loss: 3.1026 - accuracy50: 0.4618 - val_loss: 3.2342 - val_accuracy50: 0.4185 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 3.0954 - accuracy50: 0.4629 - val_loss: 3.2351 - val_accuracy50: 0.4169 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 3.0900 - accuracy50: 0.4659 - val_loss: 3.2366 - val_accuracy50: 0.4163 - 14s/epoch - 32ms/step
Epoch 22/50
451/451 - 14s - loss: 3.0783 - accuracy50: 0.4722 - val_loss: 3.2433 - val_accuracy50: 0.4125 - 14s/epoch - 31ms/step
Epoch 23/50
451/451 - 14s - loss: 3.0700 - accuracy50: 0.4741 - val_loss: 3.2541 - val_accuracy50: 0.4115 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h50
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0672487
{'0': {'precision': 0.4211894015691248, 'recall': 0.4979969862913007, 'f1-score': 0.4563841575754718, 'support': 136045}, '1': {'precision': 0.4319072958969332, 'recall': 0.17540217955371043, 'f1-score': 0.24948558890590955, 'support': 140671}, '2': {'precision': 0.4114644402215663, 'recall': 0.5851649536404802, 'f1-score': 0.4831777420369502, 'support': 139130}, 'accuracy': 0.4180345608710917, 'macro avg': {'precision': 0.42152037922920815, 'recall': 0.4195213731618304, 'f1-score': 0.3963491628394438, 'support': 415846}, 'weighted avg': {'precision': 0.42156132540800106, 'recall': 0.4180345608710917, 'f1-score': 0.39535955436372877, 'support': 415846}}
[[67750 16141 52154]
 [51701 24674 64296]
 [41403 16313 81414]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0563072
{'0': {'precision': 0.42973977695167287, 'recall': 0.5135092761954534, 'f1-score': 0.46790476190476193, 'support': 38270}, '1': {'precision': 0.46384185503378095, 'recall': 0.14647316019596482, 'f1-score': 0.22264037633870487, 'support': 37966}, '2': {'precision': 0.4217291136170729, 'recall': 0.6208813628481077, 'f1-score': 0.5022848949360952, 'support': 39212}, 'accuracy': 0.4292755179821218, 'macro avg': {'precision': 0.4384369152008422, 'recall': 0.42695459974650857, 'f1-score': 0.397610011059854, 'support': 115448}, 'weighted avg': {'precision': 0.43823369079850416, 'recall': 0.4292755179821218, 'f1-score': 0.3989248411960768, 'support': 115448}}
[[19652  3260 15358]
 [14380  5561 18025]
 [11698  3168 24346]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708132
{'0': {'precision': 0.430188262573842, 'recall': 0.5112860892388451, 'f1-score': 0.46724432584774983, 'support': 15240}, '1': {'precision': 0.4324168429148241, 'recall': 0.1506161264398607, 'f1-score': 0.22341429493865794, 'support': 14932}, '2': {'precision': 0.40799669861066534, 'recall': 0.5951441375158852, 'f1-score': 0.4841131664853101, 'support': 14951}, 'accuracy': 0.4197194335483013, 'macro avg': {'precision': 0.4235339346997771, 'recall': 0.41901545106486365, 'f1-score': 0.39159059575723926, 'support': 45123}, 'weighted avg': {'precision': 0.4235728134423146, 'recall': 0.4197194335483013, 'f1-score': 0.39214595062530466, 'support': 45123}}
[[7792 1476 5972]
 [5744 2249 6939]
 [4577 1476 8898]]
training model: results/XRAY/W0/deepOF_L2/h100
Epoch 1/50
451/451 - 16s - loss: 3.3127 - accuracy100: 0.3580 - val_loss: 3.2999 - val_accuracy100: 0.3701 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2785 - accuracy100: 0.3750 - val_loss: 3.2846 - val_accuracy100: 0.3789 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2654 - accuracy100: 0.3825 - val_loss: 3.2759 - val_accuracy100: 0.3810 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2550 - accuracy100: 0.3878 - val_loss: 3.2687 - val_accuracy100: 0.3865 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2471 - accuracy100: 0.3927 - val_loss: 3.2680 - val_accuracy100: 0.3889 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2420 - accuracy100: 0.3955 - val_loss: 3.2638 - val_accuracy100: 0.3881 - 14s/epoch - 32ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2373 - accuracy100: 0.4004 - val_loss: 3.2606 - val_accuracy100: 0.3900 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2314 - accuracy100: 0.4041 - val_loss: 3.2617 - val_accuracy100: 0.3893 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2277 - accuracy100: 0.4047 - val_loss: 3.2603 - val_accuracy100: 0.3926 - 14s/epoch - 32ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2225 - accuracy100: 0.4080 - val_loss: 3.2617 - val_accuracy100: 0.3911 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2186 - accuracy100: 0.4118 - val_loss: 3.2575 - val_accuracy100: 0.3935 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2148 - accuracy100: 0.4137 - val_loss: 3.2587 - val_accuracy100: 0.3925 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.2118 - accuracy100: 0.4147 - val_loss: 3.2619 - val_accuracy100: 0.3922 - 15s/epoch - 33ms/step
Epoch 14/50
451/451 - 15s - loss: 3.2055 - accuracy100: 0.4176 - val_loss: 3.2580 - val_accuracy100: 0.3956 - 15s/epoch - 32ms/step
Epoch 15/50
451/451 - 15s - loss: 3.2025 - accuracy100: 0.4196 - val_loss: 3.2641 - val_accuracy100: 0.3949 - 15s/epoch - 32ms/step
Epoch 16/50
451/451 - 15s - loss: 3.1983 - accuracy100: 0.4209 - val_loss: 3.2608 - val_accuracy100: 0.3954 - 15s/epoch - 32ms/step
Epoch 17/50
451/451 - 14s - loss: 3.1929 - accuracy100: 0.4224 - val_loss: 3.2640 - val_accuracy100: 0.3958 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 3.1876 - accuracy100: 0.4257 - val_loss: 3.2639 - val_accuracy100: 0.3943 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 3.1810 - accuracy100: 0.4287 - val_loss: 3.2671 - val_accuracy100: 0.3928 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 3.1781 - accuracy100: 0.4303 - val_loss: 3.2729 - val_accuracy100: 0.3931 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 3.1701 - accuracy100: 0.4328 - val_loss: 3.2690 - val_accuracy100: 0.3939 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h100
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0870395
{'0': {'precision': 0.3802204514534803, 'recall': 0.5008814729742581, 'f1-score': 0.4322891018599189, 'support': 136703}, '1': {'precision': 0.42563163676309046, 'recall': 0.1687682848037401, 'f1-score': 0.2416996324809873, 'support': 137751}, '2': {'precision': 0.39146300395824246, 'recall': 0.5015135226886953, 'f1-score': 0.43970694471573446, 'support': 141392}, 'accuracy': 0.3910822756501205, 'macro avg': {'precision': 0.39910503072493775, 'recall': 0.3903877601555645, 'f1-score': 0.3712318930188802, 'support': 415846}, 'weighted avg': {'precision': 0.39908571208202415, 'recall': 0.3910822756501205, 'f1-score': 0.3716775621087905, 'support': 415846}}
[[68472 14960 53271]
 [57543 23248 56960]
 [54070 16412 70910]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.077986
{'0': {'precision': 0.39381538895720364, 'recall': 0.5134027120782088, 'f1-score': 0.4457271928723805, 'support': 38052}, '1': {'precision': 0.46236943130077673, 'recall': 0.13587469828943227, 'f1-score': 0.21002899608654219, 'support': 38116}, '2': {'precision': 0.40056734992679355, 'recall': 0.557204684317719, 'f1-score': 0.46607751277683135, 'support': 39280}, 'accuracy': 0.4036622548679925, 'macro avg': {'precision': 0.4189173900615913, 'recall': 0.40216069822845335, 'f1-score': 0.3739445672452513, 'support': 115448}, 'weighted avg': {'precision': 0.41874629208980985, 'recall': 0.4036622548679925, 'f1-score': 0.3748337005395364, 'support': 115448}}
[[19536  2928 15588]
 [15772  5179 17165]
 [14299  3094 21887]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0856119
{'0': {'precision': 0.3973105134474328, 'recall': 0.490904314704144, 'f1-score': 0.4391762874181135, 'support': 15227}, '1': {'precision': 0.42802155504234024, 'recall': 0.1484745310100808, 'f1-score': 0.2204708798017348, 'support': 14979}, '2': {'precision': 0.38066594041585755, 'recall': 0.5387812562847758, 'f1-score': 0.4461282264779351, 'support': 14917}, 'accuracy': 0.39305897214280966, 'macro avg': {'precision': 0.40199933630187684, 'recall': 0.3927200339996668, 'f1-score': 0.36859179789926116, 'support': 45123}, 'weighted avg': {'precision': 0.40200287867443696, 'recall': 0.39305897214280966, 'f1-score': 0.36887319973045135, 'support': 45123}}
[[7475 1427 6325]
 [6004 2224 6751]
 [5335 1545 8037]]
training model: results/XRAY/W0/deepOF_L2/h200
Epoch 1/50
451/451 - 17s - loss: 3.3249 - accuracy200: 0.3501 - val_loss: 3.3299 - val_accuracy200: 0.3406 - 17s/epoch - 38ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2987 - accuracy200: 0.3619 - val_loss: 3.3105 - val_accuracy200: 0.3480 - 14s/epoch - 32ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2850 - accuracy200: 0.3714 - val_loss: 3.3066 - val_accuracy200: 0.3545 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2766 - accuracy200: 0.3738 - val_loss: 3.3017 - val_accuracy200: 0.3545 - 14s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2705 - accuracy200: 0.3811 - val_loss: 3.2966 - val_accuracy200: 0.3574 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2650 - accuracy200: 0.3846 - val_loss: 3.2948 - val_accuracy200: 0.3595 - 14s/epoch - 32ms/step
Epoch 7/50
451/451 - 15s - loss: 3.2611 - accuracy200: 0.3874 - val_loss: 3.2944 - val_accuracy200: 0.3622 - 15s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2561 - accuracy200: 0.3903 - val_loss: 3.2930 - val_accuracy200: 0.3590 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2534 - accuracy200: 0.3919 - val_loss: 3.2931 - val_accuracy200: 0.3627 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2490 - accuracy200: 0.3965 - val_loss: 3.2914 - val_accuracy200: 0.3615 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2453 - accuracy200: 0.3973 - val_loss: 3.2942 - val_accuracy200: 0.3617 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 15s - loss: 3.2412 - accuracy200: 0.4020 - val_loss: 3.2916 - val_accuracy200: 0.3637 - 15s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.2384 - accuracy200: 0.4025 - val_loss: 3.2936 - val_accuracy200: 0.3611 - 15s/epoch - 32ms/step
Epoch 14/50
451/451 - 15s - loss: 3.2358 - accuracy200: 0.4041 - val_loss: 3.2921 - val_accuracy200: 0.3658 - 15s/epoch - 33ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2335 - accuracy200: 0.4047 - val_loss: 3.2943 - val_accuracy200: 0.3637 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 14s - loss: 3.2286 - accuracy200: 0.4073 - val_loss: 3.2964 - val_accuracy200: 0.3637 - 14s/epoch - 32ms/step
Epoch 17/50
451/451 - 14s - loss: 3.2258 - accuracy200: 0.4085 - val_loss: 3.2959 - val_accuracy200: 0.3634 - 14s/epoch - 32ms/step
Epoch 18/50
451/451 - 14s - loss: 3.2211 - accuracy200: 0.4111 - val_loss: 3.2988 - val_accuracy200: 0.3605 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 15s - loss: 3.2171 - accuracy200: 0.4126 - val_loss: 3.3045 - val_accuracy200: 0.3629 - 15s/epoch - 32ms/step
Epoch 20/50
451/451 - 15s - loss: 3.2130 - accuracy200: 0.4152 - val_loss: 3.3037 - val_accuracy200: 0.3632 - 15s/epoch - 34ms/step
testing model: results/XRAY/W0/deepOF_L2/h200
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064018
{'0': {'precision': 0.2789061299738823, 'recall': 0.43049561299502015, 'f1-score': 0.3385045683386164, 'support': 105425}, '1': {'precision': 0.4995301431256325, 'recall': 0.14156219272369716, 'f1-score': 0.22060654429369514, 'support': 195264}, '2': {'precision': 0.2981419217837551, 'recall': 0.5120661357972159, 'f1-score': 0.3768621661521943, 'support': 115157}, 'accuracy': 0.3174131769934062, 'macro avg': {'precision': 0.3588593982944233, 'recall': 0.3613746471719777, 'f1-score': 0.3119910929281686, 'support': 415846}, 'weighted avg': {'precision': 0.38782881621232845, 'recall': 0.3174131769934062, 'f1-score': 0.29376662718807195, 'support': 415846}}
[[45385 13100 46940]
 [75745 27642 91877]
 [41595 14594 58968]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0866202
{'0': {'precision': 0.37768481658907405, 'recall': 0.44430627579638055, 'f1-score': 0.40829574879344516, 'support': 37796}, '1': {'precision': 0.4105127378265076, 'recall': 0.13365881827965456, 'f1-score': 0.20165937308172113, 'support': 38097}, '2': {'precision': 0.38186442703265566, 'recall': 0.5655416508658829, 'f1-score': 0.4558979375560447, 'support': 39555}, 'accuracy': 0.3833327558727739, 'macro avg': {'precision': 0.3900206604827458, 'recall': 0.3811689149806394, 'f1-score': 0.355284353143737, 'support': 115448}, 'weighted avg': {'precision': 0.3899498173381418, 'recall': 0.3833327558727739, 'f1-score': 0.3564167952473905, 'support': 115448}}
[[16793  3448 17555]
 [14349  5092 18656]
 [13321  3864 22370]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957371
{'0': {'precision': 0.36928315622614927, 'recall': 0.4264985082723081, 'f1-score': 0.3958339888612693, 'support': 14748}, '1': {'precision': 0.4044690802009354, 'recall': 0.1460653071437508, 'f1-score': 0.21462383381589228, 'support': 15986}, '2': {'precision': 0.3475377514898956, 'recall': 0.5390228646883035, 'f1-score': 0.42260120961150754, 'support': 14389}, 'accuracy': 0.36302994038516945, 'macro avg': {'precision': 0.3737633293056601, 'recall': 0.37052889336812084, 'f1-score': 0.34435301076288966, 'support': 45123}, 'weighted avg': {'precision': 0.37481442746057464, 'recall': 0.36302994038516945, 'f1-score': 0.34017120050100474, 'support': 45123}}
[[6290 1641 6817]
 [5907 2335 7744]
 [4836 1797 7756]]
training model: results/XRAY/W0/deepOF_L2/h300
Epoch 1/50
451/451 - 17s - loss: 3.3298 - accuracy300: 0.3497 - val_loss: 3.3346 - val_accuracy300: 0.3376 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.3031 - accuracy300: 0.3587 - val_loss: 3.3265 - val_accuracy300: 0.3387 - 14s/epoch - 32ms/step
Epoch 3/50
451/451 - 15s - loss: 3.2899 - accuracy300: 0.3684 - val_loss: 3.3222 - val_accuracy300: 0.3408 - 15s/epoch - 32ms/step
Epoch 4/50
451/451 - 15s - loss: 3.2814 - accuracy300: 0.3698 - val_loss: 3.3182 - val_accuracy300: 0.3429 - 15s/epoch - 33ms/step
Epoch 5/50
451/451 - 15s - loss: 3.2743 - accuracy300: 0.3753 - val_loss: 3.3197 - val_accuracy300: 0.3407 - 15s/epoch - 32ms/step
Epoch 6/50
451/451 - 15s - loss: 3.2705 - accuracy300: 0.3775 - val_loss: 3.3231 - val_accuracy300: 0.3416 - 15s/epoch - 32ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2648 - accuracy300: 0.3810 - val_loss: 3.3243 - val_accuracy300: 0.3426 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2601 - accuracy300: 0.3841 - val_loss: 3.3287 - val_accuracy300: 0.3414 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2572 - accuracy300: 0.3856 - val_loss: 3.3292 - val_accuracy300: 0.3407 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 15s - loss: 3.2522 - accuracy300: 0.3870 - val_loss: 3.3320 - val_accuracy300: 0.3404 - 15s/epoch - 33ms/step
Epoch 11/50
451/451 - 15s - loss: 3.2492 - accuracy300: 0.3912 - val_loss: 3.3360 - val_accuracy300: 0.3422 - 15s/epoch - 33ms/step
Epoch 12/50
451/451 - 15s - loss: 3.2448 - accuracy300: 0.3943 - val_loss: 3.3420 - val_accuracy300: 0.3414 - 15s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.2415 - accuracy300: 0.3944 - val_loss: 3.3371 - val_accuracy300: 0.3427 - 15s/epoch - 33ms/step
Epoch 14/50
451/451 - 15s - loss: 3.2401 - accuracy300: 0.3966 - val_loss: 3.3394 - val_accuracy300: 0.3432 - 15s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h300
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0810316
{'0': {'precision': 0.30834132310642376, 'recall': 0.09665951051953628, 'f1-score': 0.14718054329704813, 'support': 116450}, '1': {'precision': 0.4348860660958177, 'recall': 0.8425102394050006, 'f1-score': 0.5736605970793636, 'support': 175059}, '2': {'precision': 0.35025001865810884, 'recall': 0.11323258563420381, 'f1-score': 0.17113788031653032, 'support': 124337}, 'accuracy': 0.4155961581931773, 'macro avg': {'precision': 0.3644924692867834, 'recall': 0.3508007785195802, 'f1-score': 0.29732634023098065, 'support': 415846}, 'weighted avg': {'precision': 0.3741435615355302, 'recall': 0.4155961581931773, 'f1-score': 0.33387935763713966, 'support': 415846}}
[[ 11256  93253  11941]
 [ 13393 147489  14177]
 [ 11856  98402  14079]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0993153
{'0': {'precision': 0.3712352886664813, 'recall': 0.10697786204502363, 'f1-score': 0.16609312160537335, 'support': 37447}, '1': {'precision': 0.3449849199597866, 'recall': 0.817482133040132, 'f1-score': 0.4852077441809876, 'support': 38199}, '2': {'precision': 0.4033946251768034, 'recall': 0.1433093814381187, 'f1-score': 0.2114864113306885, 'support': 39802}, 'accuracy': 0.3545925438292565, 'macro avg': {'precision': 0.37320494460102377, 'recall': 0.3559231255077581, 'f1-score': 0.28759575903901646, 'support': 115448}, 'weighted avg': {'precision': 0.3736369593542092, 'recall': 0.3545925438292565, 'f1-score': 0.2873304161917922, 'support': 115448}}
[[ 4006 28874  4567]
 [ 3103 31227  3869]
 [ 3682 30416  5704]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059576
{'0': {'precision': 0.34094234708808896, 'recall': 0.07543382543382543, 'f1-score': 0.12353533746885106, 'support': 15444}, '1': {'precision': 0.33629836030436183, 'recall': 0.8472494093823827, 'f1-score': 0.4814821918333685, 'support': 14815}, '2': {'precision': 0.3776814240073026, 'recall': 0.11134284176533907, 'f1-score': 0.1719837888392393, 'support': 14864}, 'accuracy': 0.34066883850807794, 'macro avg': {'precision': 0.35164071046658446, 'recall': 0.34467535886051576, 'f1-score': 0.2590004393804863, 'support': 45123}, 'weighted avg': {'precision': 0.3515198568974162, 'recall': 0.34066883850807794, 'f1-score': 0.2570176065684184, 'support': 45123}}
[[ 1165 12760  1519]
 [ 1055 12552  1208]
 [ 1197 12012  1655]]
training model: results/XRAY/W0/deepOF_L2/h500
Epoch 1/50
451/451 - 16s - loss: 3.3261 - accuracy500: 0.3508 - val_loss: 3.3401 - val_accuracy500: 0.3400 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2985 - accuracy500: 0.3624 - val_loss: 3.3263 - val_accuracy500: 0.3357 - 14s/epoch - 32ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2869 - accuracy500: 0.3679 - val_loss: 3.3213 - val_accuracy500: 0.3398 - 14s/epoch - 32ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2787 - accuracy500: 0.3722 - val_loss: 3.3151 - val_accuracy500: 0.3413 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2725 - accuracy500: 0.3769 - val_loss: 3.3131 - val_accuracy500: 0.3436 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2689 - accuracy500: 0.3784 - val_loss: 3.3088 - val_accuracy500: 0.3482 - 14s/epoch - 32ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2626 - accuracy500: 0.3832 - val_loss: 3.3074 - val_accuracy500: 0.3457 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2590 - accuracy500: 0.3840 - val_loss: 3.3061 - val_accuracy500: 0.3510 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2549 - accuracy500: 0.3866 - val_loss: 3.3042 - val_accuracy500: 0.3537 - 14s/epoch - 32ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2524 - accuracy500: 0.3892 - val_loss: 3.3066 - val_accuracy500: 0.3521 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2484 - accuracy500: 0.3914 - val_loss: 3.3057 - val_accuracy500: 0.3509 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2456 - accuracy500: 0.3938 - val_loss: 3.3069 - val_accuracy500: 0.3533 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 3.2428 - accuracy500: 0.3938 - val_loss: 3.3066 - val_accuracy500: 0.3542 - 14s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2387 - accuracy500: 0.3975 - val_loss: 3.3066 - val_accuracy500: 0.3553 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2345 - accuracy500: 0.3997 - val_loss: 3.3103 - val_accuracy500: 0.3547 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 15s - loss: 3.2328 - accuracy500: 0.4006 - val_loss: 3.3098 - val_accuracy500: 0.3551 - 15s/epoch - 32ms/step
Epoch 17/50
451/451 - 15s - loss: 3.2298 - accuracy500: 0.4021 - val_loss: 3.3097 - val_accuracy500: 0.3584 - 15s/epoch - 32ms/step
Epoch 18/50
451/451 - 15s - loss: 3.2257 - accuracy500: 0.4058 - val_loss: 3.3139 - val_accuracy500: 0.3579 - 15s/epoch - 33ms/step
Epoch 19/50
451/451 - 15s - loss: 3.2235 - accuracy500: 0.4046 - val_loss: 3.3124 - val_accuracy500: 0.3596 - 15s/epoch - 33ms/step
testing model: results/XRAY/W0/deepOF_L2/h500
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979171
{'0': {'precision': 0.32971747753582126, 'recall': 0.1926800807367226, 'f1-score': 0.24322468275690473, 'support': 126832}, '1': {'precision': 0.4040382917421813, 'recall': 0.3376854560990135, 'f1-score': 0.36789399078977986, 'support': 154484}, '2': {'precision': 0.33313892782225063, 'recall': 0.5264996655021185, 'f1-score': 0.40807273062475513, 'support': 134530}, 'accuracy': 0.35454230652693547, 'macro avg': {'precision': 0.35563156570008436, 'recall': 0.35228840077928486, 'f1-score': 0.3397304680571465, 'support': 415846}, 'weighted avg': {'precision': 0.3584340321471165, 'recall': 0.35454230652693547, 'f1-score': 0.3428683519561097, 'support': 415846}}
[[24438 38146 64248]
 [24781 52167 77536]
 [24899 38801 70830]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0883781
{'0': {'precision': 0.3819189971070395, 'recall': 0.21338900862068966, 'f1-score': 0.2737988247493951, 'support': 37120}, '1': {'precision': 0.3827735284336548, 'recall': 0.3050703702722044, 'f1-score': 0.33953303146064095, 'support': 37729}, '2': {'precision': 0.37592437884835544, 'recall': 0.5985122786275524, 'f1-score': 0.461795756245427, 'support': 40599}, 'accuracy': 0.37878525396715407, 'macro avg': {'precision': 0.3802056347963499, 'recall': 0.3723238858401488, 'f1-score': 0.35837587081848765, 'support': 115448}, 'weighted avg': {'precision': 0.38009016599465606, 'recall': 0.37878525396715407, 'f1-score': 0.3613930083369496, 'support': 115448}}
[[ 7921  9100 20099]
 [ 5979 11510 20240]
 [ 6840  9460 24299]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982757
{'0': {'precision': 0.3573030557891786, 'recall': 0.168217514683561, 'f1-score': 0.2287432135325526, 'support': 15153}, '1': {'precision': 0.3605127427184466, 'recall': 0.31642367352373346, 'f1-score': 0.3370324410565503, 'support': 15021}, '2': {'precision': 0.34557548881273936, 'recall': 0.5734162820255535, 'f1-score': 0.4312522010363737, 'support': 14949}, 'accuracy': 0.35179398532898964, 'macro avg': {'precision': 0.3544637624401215, 'recall': 0.35268582341094934, 'f1-score': 0.3323426185418255, 'support': 45123}, 'weighted avg': {'precision': 0.35448625080355584, 'recall': 0.35179398532898964, 'f1-score': 0.3318817313800492, 'support': 45123}}
[[2549 4447 8157]
 [2192 4753 8076]
 [2393 3984 8572]]
training model: results/XRAY/W0/deepOF_L2/h1000
Epoch 1/50
451/451 - 17s - loss: 3.3320 - accuracy1000: 0.3478 - val_loss: 3.3674 - val_accuracy1000: 0.3306 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.3107 - accuracy1000: 0.3562 - val_loss: 3.3585 - val_accuracy1000: 0.3329 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2970 - accuracy1000: 0.3614 - val_loss: 3.3484 - val_accuracy1000: 0.3396 - 14s/epoch - 32ms/step
Epoch 4/50
451/451 - 15s - loss: 3.2900 - accuracy1000: 0.3644 - val_loss: 3.3446 - val_accuracy1000: 0.3386 - 15s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2847 - accuracy1000: 0.3673 - val_loss: 3.3418 - val_accuracy1000: 0.3415 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2804 - accuracy1000: 0.3693 - val_loss: 3.3381 - val_accuracy1000: 0.3412 - 14s/epoch - 32ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2751 - accuracy1000: 0.3738 - val_loss: 3.3385 - val_accuracy1000: 0.3428 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2722 - accuracy1000: 0.3722 - val_loss: 3.3349 - val_accuracy1000: 0.3420 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2680 - accuracy1000: 0.3762 - val_loss: 3.3349 - val_accuracy1000: 0.3418 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2659 - accuracy1000: 0.3789 - val_loss: 3.3370 - val_accuracy1000: 0.3424 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2620 - accuracy1000: 0.3811 - val_loss: 3.3395 - val_accuracy1000: 0.3410 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2585 - accuracy1000: 0.3832 - val_loss: 3.3420 - val_accuracy1000: 0.3393 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 14s - loss: 3.2549 - accuracy1000: 0.3864 - val_loss: 3.3436 - val_accuracy1000: 0.3398 - 14s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2528 - accuracy1000: 0.3865 - val_loss: 3.3442 - val_accuracy1000: 0.3398 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2481 - accuracy1000: 0.3892 - val_loss: 3.3491 - val_accuracy1000: 0.3399 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 15s - loss: 3.2448 - accuracy1000: 0.3942 - val_loss: 3.3472 - val_accuracy1000: 0.3384 - 15s/epoch - 33ms/step
Epoch 17/50
451/451 - 15s - loss: 3.2430 - accuracy1000: 0.3940 - val_loss: 3.3551 - val_accuracy1000: 0.3399 - 15s/epoch - 33ms/step
Epoch 18/50
451/451 - 14s - loss: 3.2386 - accuracy1000: 0.3955 - val_loss: 3.3559 - val_accuracy1000: 0.3408 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepOF_L2/h1000
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0885674
{'0': {'precision': 0.2937648381856804, 'recall': 0.04091399533604817, 'f1-score': 0.07182463912014053, 'support': 114924}, '1': {'precision': 0.4407271653833854, 'recall': 0.7042294647469733, 'f1-score': 0.5421568775789436, 'support': 178084}, '2': {'precision': 0.31564931516355405, 'recall': 0.29623569253813964, 'f1-score': 0.30563453034381677, 'support': 122838}, 'accuracy': 0.40039581960629655, 'macro avg': {'precision': 0.3500471062442066, 'recall': 0.3471263842070537, 'f1-score': 0.30653868234763365, 'support': 415846}, 'weighted avg': {'precision': 0.3631652519438604, 'recall': 0.40039581960629655, 'f1-score': 0.34230790882053785, 'support': 415846}}
[[  4702  77764  32458]
 [  6236 125412  46436]
 [  5068  81381  36389]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096838
{'0': {'precision': 0.412818096135721, 'recall': 0.04673994237541351, 'f1-score': 0.08397239263803681, 'support': 37484}, '1': {'precision': 0.34007645971757866, 'recall': 0.6605924423862111, 'f1-score': 0.4490035388340473, 'support': 36493}, '2': {'precision': 0.3918942381625617, 'recall': 0.38098912493067444, 'f1-score': 0.3863647478847752, 'support': 41471}, 'accuracy': 0.3608464416880327, 'macro avg': {'precision': 0.3815962646719538, 'recall': 0.3627738365640997, 'f1-score': 0.30644689311895307, 'support': 115448}, 'weighted avg': {'precision': 0.382308309462828, 'recall': 0.3608464416880327, 'f1-score': 0.3079831592391776, 'support': 115448}}
[[ 1752 22561 13171]
 [ 1040 24107 11346]
 [ 1452 24219 15800]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1082095
{'0': {'precision': 0.3427230046948357, 'recall': 0.02823438406497776, 'f1-score': 0.052170805788815444, 'support': 15513}, '1': {'precision': 0.3370867028355001, 'recall': 0.6731398201144726, 'f1-score': 0.44921901643816925, 'support': 14676}, '2': {'precision': 0.35107992846333747, 'recall': 0.3417704566760412, 'f1-score': 0.3463626492942454, 'support': 14934}, 'accuracy': 0.34175475921370474, 'macro avg': {'precision': 0.34362987866455774, 'recall': 0.3477148869518305, 'f1-score': 0.28258415717374336, 'support': 45123}, 'weighted avg': {'precision': 0.3436556539750519, 'recall': 0.34175475921370474, 'f1-score': 0.27867481772064634, 'support': 45123}}
[[  438 10008  5067]
 [  430  9879  4367]
 [  410  9420  5104]]
training model: results/XRAY/W0/deepVOL_L2/h10
Epoch 1/50
451/451 - 17s - loss: 3.2164 - accuracy10: 0.4069 - val_loss: 3.1109 - val_accuracy10: 0.4850 - 17s/epoch - 39ms/step
Epoch 2/50
451/451 - 14s - loss: 3.0696 - accuracy10: 0.4649 - val_loss: 3.0472 - val_accuracy10: 0.5013 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.0208 - accuracy10: 0.4801 - val_loss: 3.0052 - val_accuracy10: 0.5051 - 14s/epoch - 32ms/step
Epoch 4/50
451/451 - 14s - loss: 2.9895 - accuracy10: 0.4909 - val_loss: 2.9919 - val_accuracy10: 0.5119 - 14s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 2.9744 - accuracy10: 0.4950 - val_loss: 2.9780 - val_accuracy10: 0.5132 - 14s/epoch - 32ms/step
Epoch 6/50
451/451 - 14s - loss: 2.9556 - accuracy10: 0.5019 - val_loss: 2.9648 - val_accuracy10: 0.5073 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 2.9443 - accuracy10: 0.5063 - val_loss: 2.9554 - val_accuracy10: 0.5047 - 14s/epoch - 30ms/step
Epoch 8/50
451/451 - 15s - loss: 2.9314 - accuracy10: 0.5106 - val_loss: 2.9508 - val_accuracy10: 0.5055 - 15s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 2.9185 - accuracy10: 0.5157 - val_loss: 2.9472 - val_accuracy10: 0.5072 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 2.9064 - accuracy10: 0.5196 - val_loss: 2.9412 - val_accuracy10: 0.5119 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 2.8967 - accuracy10: 0.5229 - val_loss: 2.9419 - val_accuracy10: 0.5154 - 14s/epoch - 31ms/step
Epoch 12/50
451/451 - 14s - loss: 2.8870 - accuracy10: 0.5258 - val_loss: 2.9396 - val_accuracy10: 0.5183 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 2.8808 - accuracy10: 0.5263 - val_loss: 2.9314 - val_accuracy10: 0.5181 - 14s/epoch - 31ms/step
Epoch 14/50
451/451 - 14s - loss: 2.8749 - accuracy10: 0.5290 - val_loss: 2.9294 - val_accuracy10: 0.5203 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 14s - loss: 2.8655 - accuracy10: 0.5321 - val_loss: 2.9285 - val_accuracy10: 0.5184 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 14s - loss: 2.8608 - accuracy10: 0.5327 - val_loss: 2.9222 - val_accuracy10: 0.5229 - 14s/epoch - 31ms/step
Epoch 17/50
451/451 - 14s - loss: 2.8520 - accuracy10: 0.5355 - val_loss: 2.9188 - val_accuracy10: 0.5250 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 2.8446 - accuracy10: 0.5371 - val_loss: 2.9243 - val_accuracy10: 0.5225 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 2.8390 - accuracy10: 0.5397 - val_loss: 2.9199 - val_accuracy10: 0.5231 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 2.8354 - accuracy10: 0.5414 - val_loss: 2.9183 - val_accuracy10: 0.5221 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 2.8285 - accuracy10: 0.5427 - val_loss: 2.9212 - val_accuracy10: 0.5237 - 14s/epoch - 31ms/step
Epoch 22/50
451/451 - 14s - loss: 2.8213 - accuracy10: 0.5439 - val_loss: 2.9192 - val_accuracy10: 0.5271 - 14s/epoch - 32ms/step
Epoch 23/50
451/451 - 15s - loss: 2.8181 - accuracy10: 0.5444 - val_loss: 2.9216 - val_accuracy10: 0.5241 - 15s/epoch - 33ms/step
Epoch 24/50
451/451 - 14s - loss: 2.8139 - accuracy10: 0.5456 - val_loss: 2.9274 - val_accuracy10: 0.5240 - 14s/epoch - 31ms/step
Epoch 25/50
451/451 - 14s - loss: 2.8067 - accuracy10: 0.5475 - val_loss: 2.9290 - val_accuracy10: 0.5253 - 14s/epoch - 32ms/step
Epoch 26/50
451/451 - 14s - loss: 2.8019 - accuracy10: 0.5492 - val_loss: 2.9274 - val_accuracy10: 0.5260 - 14s/epoch - 31ms/step
Epoch 27/50
451/451 - 14s - loss: 2.7949 - accuracy10: 0.5510 - val_loss: 2.9376 - val_accuracy10: 0.5243 - 14s/epoch - 31ms/step
Epoch 28/50
451/451 - 14s - loss: 2.7902 - accuracy10: 0.5504 - val_loss: 2.9435 - val_accuracy10: 0.5223 - 14s/epoch - 31ms/step
Epoch 29/50
451/451 - 14s - loss: 2.7877 - accuracy10: 0.5513 - val_loss: 2.9420 - val_accuracy10: 0.5232 - 14s/epoch - 31ms/step
Epoch 30/50
451/451 - 14s - loss: 2.7808 - accuracy10: 0.5547 - val_loss: 2.9476 - val_accuracy10: 0.5211 - 14s/epoch - 31ms/step
testing model: results/XRAY/W0/deepVOL_L2/h10
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95536655
{'0': {'precision': 0.4673329924224815, 'recall': 0.4704781159908645, 'f1-score': 0.46890028032893166, 'support': 106836}, '1': {'precision': 0.689750514815789, 'recall': 0.5410468790885852, 'f1-score': 0.6064155891766895, 'support': 198724}, '2': {'precision': 0.42918347931634027, 'recall': 0.5931036983978747, 'f1-score': 0.4980015682930729, 'support': 110291}, 'accuracy': 0.5367234899038358, 'macro avg': {'precision': 0.5287556621848702, 'recall': 0.5348762311591081, 'f1-score': 0.524439145932898, 'support': 415851}, 'weighted avg': {'precision': 0.5635024179381066, 'recall': 0.5367234899038358, 'f1-score': 0.5423333185717516, 'support': 415851}}
[[ 50264  24314  32258]
 [ 36462 107519  54743]
 [ 20829  24048  65414]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9734649
{'0': {'precision': 0.4528950478032012, 'recall': 0.5444390637610976, 'f1-score': 0.4944657020128718, 'support': 30975}, '1': {'precision': 0.6769634976915032, 'recall': 0.5009627000906071, 'f1-score': 0.5758144479762203, 'support': 52976}, '2': {'precision': 0.443515931403963, 'recall': 0.5492872789612369, 'f1-score': 0.49076726705431856, 'support': 31499}, 'accuracy': 0.5258120398440883, 'macro avg': {'precision': 0.5244581589662225, 'recall': 0.5315630142709805, 'f1-score': 0.5203491390144702, 'support': 115450}, 'weighted avg': {'precision': 0.5531533190359693, 'recall': 0.5258120398440883, 'f1-score': 0.5307847506347417, 'support': 115450}}
[[16864  6093  8018]
 [12746 26539 13691]
 [ 7626  6571 17302]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9770709
{'0': {'precision': 0.46275851345047425, 'recall': 0.49878488225928097, 'f1-score': 0.4800967937084089, 'support': 11933}, '1': {'precision': 0.6502516175413372, 'recall': 0.5245759025663332, 'f1-score': 0.580691758285852, 'support': 20691}, '2': {'precision': 0.44273877577236814, 'recall': 0.5514841187294983, 'f1-score': 0.4911643152344306, 'support': 12499}, 'accuracy': 0.5252088735234802, 'macro avg': {'precision': 0.5185829689213932, 'recall': 0.5249483011850374, 'f1-score': 0.5173176224095638, 'support': 45123}, 'weighted avg': {'precision': 0.5431874103656925, 'recall': 0.5252088735234802, 'f1-score': 0.5292899626826708, 'support': 45123}}
[[ 5952  2833  3148]
 [ 4309 10854  5528]
 [ 2601  3005  6893]]
training model: results/XRAY/W0/deepVOL_L2/h20
Epoch 1/50
451/451 - 16s - loss: 3.2686 - accuracy20: 0.3946 - val_loss: 3.2129 - val_accuracy20: 0.4182 - 16s/epoch - 37ms/step
Epoch 2/50
451/451 - 15s - loss: 3.1437 - accuracy20: 0.4463 - val_loss: 3.1282 - val_accuracy20: 0.4529 - 15s/epoch - 32ms/step
Epoch 3/50
451/451 - 15s - loss: 3.0898 - accuracy20: 0.4666 - val_loss: 3.0839 - val_accuracy20: 0.4688 - 15s/epoch - 32ms/step
Epoch 4/50
451/451 - 14s - loss: 3.0568 - accuracy20: 0.4785 - val_loss: 3.0827 - val_accuracy20: 0.4700 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.0405 - accuracy20: 0.4843 - val_loss: 3.0677 - val_accuracy20: 0.4758 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.0253 - accuracy20: 0.4896 - val_loss: 3.0586 - val_accuracy20: 0.4794 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.0106 - accuracy20: 0.4915 - val_loss: 3.0477 - val_accuracy20: 0.4838 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.0008 - accuracy20: 0.4946 - val_loss: 3.0455 - val_accuracy20: 0.4803 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 2.9910 - accuracy20: 0.4976 - val_loss: 3.0485 - val_accuracy20: 0.4832 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 2.9814 - accuracy20: 0.5008 - val_loss: 3.0404 - val_accuracy20: 0.4870 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 2.9724 - accuracy20: 0.5035 - val_loss: 3.0395 - val_accuracy20: 0.4845 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 2.9672 - accuracy20: 0.5032 - val_loss: 3.0401 - val_accuracy20: 0.4880 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 2.9567 - accuracy20: 0.5063 - val_loss: 3.0382 - val_accuracy20: 0.4860 - 14s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 2.9487 - accuracy20: 0.5092 - val_loss: 3.0378 - val_accuracy20: 0.4881 - 14s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 2.9440 - accuracy20: 0.5096 - val_loss: 3.0358 - val_accuracy20: 0.4879 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 14s - loss: 2.9382 - accuracy20: 0.5121 - val_loss: 3.0409 - val_accuracy20: 0.4844 - 14s/epoch - 32ms/step
Epoch 17/50
451/451 - 14s - loss: 2.9307 - accuracy20: 0.5139 - val_loss: 3.0394 - val_accuracy20: 0.4873 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 2.9248 - accuracy20: 0.5161 - val_loss: 3.0398 - val_accuracy20: 0.4856 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 2.9197 - accuracy20: 0.5161 - val_loss: 3.0471 - val_accuracy20: 0.4870 - 14s/epoch - 31ms/step
Epoch 20/50
451/451 - 14s - loss: 2.9119 - accuracy20: 0.5183 - val_loss: 3.0381 - val_accuracy20: 0.4867 - 14s/epoch - 32ms/step
Epoch 21/50
451/451 - 14s - loss: 2.9050 - accuracy20: 0.5208 - val_loss: 3.0405 - val_accuracy20: 0.4843 - 14s/epoch - 32ms/step
Epoch 22/50
451/451 - 14s - loss: 2.9023 - accuracy20: 0.5216 - val_loss: 3.0402 - val_accuracy20: 0.4855 - 14s/epoch - 32ms/step
Epoch 23/50
451/451 - 14s - loss: 2.8943 - accuracy20: 0.5250 - val_loss: 3.0425 - val_accuracy20: 0.4865 - 14s/epoch - 32ms/step
Epoch 24/50
451/451 - 15s - loss: 2.8901 - accuracy20: 0.5251 - val_loss: 3.0462 - val_accuracy20: 0.4849 - 15s/epoch - 32ms/step
Epoch 25/50
451/451 - 15s - loss: 2.8820 - accuracy20: 0.5286 - val_loss: 3.0509 - val_accuracy20: 0.4846 - 15s/epoch - 32ms/step
testing model: results/XRAY/W0/deepVOL_L2/h20
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98993397
{'0': {'precision': 0.5081207125620238, 'recall': 0.4216795175662296, 'f1-score': 0.4608820045334, 'support': 133324}, '1': {'precision': 0.5535782013430804, 'recall': 0.5121821997454158, 'f1-score': 0.5320762539224166, 'support': 145335}, '2': {'precision': 0.4674507001833186, 'recall': 0.5817613271910899, 'f1-score': 0.518378998028792, 'support': 137192}, 'accuracy': 0.5061211828275031, 'macro avg': {'precision': 0.5097165380294743, 'recall': 0.5052076815009118, 'f1-score': 0.5037790854948695, 'support': 415851}, 'weighted avg': {'precision': 0.5105902600531577, 'recall': 0.5061211828275031, 'f1-score': 0.5047321906976092, 'support': 415851}}
[[56220 29025 48079]
 [28048 74438 42849]
 [26375 31004 79813]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99960345
{'0': {'precision': 0.4849875930521092, 'recall': 0.5147349292881409, 'f1-score': 0.4994186863589324, 'support': 37971}, '1': {'precision': 0.5414090341445585, 'recall': 0.4584257492133904, 'f1-score': 0.49647370993645695, 'support': 38774}, '2': {'precision': 0.4739951322101184, 'recall': 0.5182534556258881, 'f1-score': 0.49513724328593994, 'support': 38705}, 'accuracy': 0.4970030316154179, 'macro avg': {'precision': 0.5001305864689287, 'recall': 0.4971380447091398, 'f1-score': 0.49700987986044315, 'support': 115450}, 'weighted avg': {'precision': 0.500251532073585, 'recall': 0.4970030316154179, 'f1-score': 0.4969942448695843, 'support': 115450}}
[[19545  7030 11396]
 [10135 17775 10864]
 [10620  8026 20059]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0118821
{'0': {'precision': 0.4926658395971685, 'recall': 0.45430686406460297, 'f1-score': 0.47270944928753983, 'support': 14860}, '1': {'precision': 0.4940913222851549, 'recall': 0.47337040262611374, 'f1-score': 0.48350896400711646, 'support': 14927}, '2': {'precision': 0.4717565278345698, 'recall': 0.52660406885759, 'f1-score': 0.4976737020489909, 'support': 15336}, 'accuracy': 0.48518493894466236, 'macro avg': {'precision': 0.4861712299056311, 'recall': 0.48476044518276895, 'f1-score': 0.4846307051145491, 'support': 45123}, 'weighted avg': {'precision': 0.486030930014303, 'recall': 0.48518493894466236, 'f1-score': 0.4847666293635262, 'support': 45123}}
[[6751 3465 4644]
 [3462 7066 4399]
 [3490 3770 8076]]
training model: results/XRAY/W0/deepVOL_L2/h30
Epoch 1/50
451/451 - 16s - loss: 3.2947 - accuracy30: 0.3770 - val_loss: 3.2667 - val_accuracy30: 0.3945 - 16s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.1942 - accuracy30: 0.4276 - val_loss: 3.2187 - val_accuracy30: 0.4187 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 15s - loss: 3.1549 - accuracy30: 0.4440 - val_loss: 3.1825 - val_accuracy30: 0.4310 - 15s/epoch - 32ms/step
Epoch 4/50
451/451 - 14s - loss: 3.1252 - accuracy30: 0.4554 - val_loss: 3.1645 - val_accuracy30: 0.4391 - 14s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 3.1071 - accuracy30: 0.4631 - val_loss: 3.1400 - val_accuracy30: 0.4511 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.0929 - accuracy30: 0.4699 - val_loss: 3.1364 - val_accuracy30: 0.4535 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.0829 - accuracy30: 0.4717 - val_loss: 3.1321 - val_accuracy30: 0.4539 - 14s/epoch - 32ms/step
Epoch 8/50
451/451 - 14s - loss: 3.0719 - accuracy30: 0.4758 - val_loss: 3.1234 - val_accuracy30: 0.4578 - 14s/epoch - 32ms/step
Epoch 9/50
451/451 - 14s - loss: 3.0642 - accuracy30: 0.4775 - val_loss: 3.1230 - val_accuracy30: 0.4568 - 14s/epoch - 32ms/step
Epoch 10/50
451/451 - 14s - loss: 3.0548 - accuracy30: 0.4801 - val_loss: 3.1186 - val_accuracy30: 0.4609 - 14s/epoch - 32ms/step
Epoch 11/50
451/451 - 14s - loss: 3.0478 - accuracy30: 0.4833 - val_loss: 3.1168 - val_accuracy30: 0.4611 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 3.0405 - accuracy30: 0.4864 - val_loss: 3.1151 - val_accuracy30: 0.4632 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.0337 - accuracy30: 0.4890 - val_loss: 3.1143 - val_accuracy30: 0.4622 - 15s/epoch - 33ms/step
Epoch 14/50
451/451 - 15s - loss: 3.0290 - accuracy30: 0.4902 - val_loss: 3.1198 - val_accuracy30: 0.4575 - 15s/epoch - 32ms/step
Epoch 15/50
451/451 - 15s - loss: 3.0215 - accuracy30: 0.4910 - val_loss: 3.1188 - val_accuracy30: 0.4593 - 15s/epoch - 33ms/step
Epoch 16/50
451/451 - 15s - loss: 3.0137 - accuracy30: 0.4934 - val_loss: 3.1112 - val_accuracy30: 0.4646 - 15s/epoch - 33ms/step
Epoch 17/50
451/451 - 15s - loss: 3.0089 - accuracy30: 0.4940 - val_loss: 3.1214 - val_accuracy30: 0.4605 - 15s/epoch - 33ms/step
Epoch 18/50
451/451 - 15s - loss: 3.0033 - accuracy30: 0.4965 - val_loss: 3.1297 - val_accuracy30: 0.4598 - 15s/epoch - 33ms/step
Epoch 19/50
451/451 - 14s - loss: 2.9999 - accuracy30: 0.4968 - val_loss: 3.1306 - val_accuracy30: 0.4589 - 14s/epoch - 32ms/step
Epoch 20/50
451/451 - 14s - loss: 2.9960 - accuracy30: 0.4990 - val_loss: 3.1317 - val_accuracy30: 0.4581 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 2.9911 - accuracy30: 0.4998 - val_loss: 3.1324 - val_accuracy30: 0.4589 - 14s/epoch - 32ms/step
Epoch 22/50
451/451 - 14s - loss: 2.9853 - accuracy30: 0.5008 - val_loss: 3.1368 - val_accuracy30: 0.4582 - 14s/epoch - 32ms/step
Epoch 23/50
451/451 - 14s - loss: 2.9800 - accuracy30: 0.5049 - val_loss: 3.1501 - val_accuracy30: 0.4563 - 14s/epoch - 32ms/step
Epoch 24/50
451/451 - 14s - loss: 2.9752 - accuracy30: 0.5048 - val_loss: 3.1499 - val_accuracy30: 0.4546 - 14s/epoch - 32ms/step
Epoch 25/50
451/451 - 14s - loss: 2.9675 - accuracy30: 0.5063 - val_loss: 3.1528 - val_accuracy30: 0.4555 - 14s/epoch - 31ms/step
Epoch 26/50
451/451 - 14s - loss: 2.9621 - accuracy30: 0.5104 - val_loss: 3.1544 - val_accuracy30: 0.4523 - 14s/epoch - 30ms/step
testing model: results/XRAY/W0/deepVOL_L2/h30
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0177279
{'0': {'precision': 0.46675664611212037, 'recall': 0.5319215629100452, 'f1-score': 0.49721306113549024, 'support': 137180}, '1': {'precision': 0.5221133290763208, 'recall': 0.4056514236410699, 'f1-score': 0.456572670219352, 'support': 139080}, '2': {'precision': 0.46499452007764325, 'recall': 0.5045382581971617, 'f1-score': 0.4839599660542926, 'support': 139591}, 'accuracy': 0.4804990248911269, 'macro avg': {'precision': 0.4846214984220281, 'recall': 0.48070374824942563, 'f1-score': 0.479248565803045, 'support': 415851}, 'weighted avg': {'precision': 0.48467900419562215, 'recall': 0.4804990248911269, 'f1-score': 0.47917227642150384, 'support': 415851}}
[[72969 24114 40097]
 [41726 56418 40936]
 [41637 27525 70429]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0236893
{'0': {'precision': 0.45009345051099536, 'recall': 0.5875924724205062, 'f1-score': 0.509733277789662, 'support': 38525}, '1': {'precision': 0.5162551755865665, 'recall': 0.3574822798587698, 'f1-score': 0.4224428654337835, 'support': 37669}, '2': {'precision': 0.47688882063882065, 'recall': 0.4746535561442837, 'f1-score': 0.47576856296598913, 'support': 39256}, 'accuracy': 0.4741100043308792, 'macro avg': {'precision': 0.4810791489121275, 'recall': 0.4732427694745199, 'f1-score': 0.46931490206314486, 'support': 115450}, 'weighted avg': {'precision': 0.4807918053971764, 'recall': 0.4741100043308792, 'f1-score': 0.46970329608198175, 'support': 115450}}
[[22637  5884 10004]
 [13768 13466 10435]
 [13889  6734 18633]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0372387
{'0': {'precision': 0.4590983100331256, 'recall': 0.5343396719597464, 'f1-score': 0.4938696623784502, 'support': 15303}, '1': {'precision': 0.46397020613199375, 'recall': 0.36797637038054676, 'f1-score': 0.4104351823475329, 'support': 14558}, '2': {'precision': 0.46086515286058605, 'recall': 0.47608439260909446, 'f1-score': 0.4683511666881526, 'support': 15262}, 'accuracy': 0.4609622587150677, 'macro avg': {'precision': 0.46131122300856847, 'recall': 0.4594668116497959, 'f1-score': 0.4575520038047119, 'support': 45123}, 'weighted avg': {'precision': 0.4612677273732853, 'recall': 0.4609622587150677, 'f1-score': 0.45832011023175306, 'support': 45123}}
[[8177 3006 4120]
 [4821 5357 4380]
 [4813 3183 7266]]
training model: results/XRAY/W0/deepVOL_L2/h50
Epoch 1/50
451/451 - 16s - loss: 3.3238 - accuracy50: 0.3629 - val_loss: 3.3098 - val_accuracy50: 0.3636 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2587 - accuracy50: 0.3914 - val_loss: 3.2800 - val_accuracy50: 0.3870 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2367 - accuracy50: 0.4032 - val_loss: 3.2684 - val_accuracy50: 0.3909 - 14s/epoch - 30ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2172 - accuracy50: 0.4133 - val_loss: 3.2593 - val_accuracy50: 0.3945 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2094 - accuracy50: 0.4172 - val_loss: 3.2564 - val_accuracy50: 0.3986 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2020 - accuracy50: 0.4221 - val_loss: 3.2420 - val_accuracy50: 0.4039 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.1936 - accuracy50: 0.4253 - val_loss: 3.2403 - val_accuracy50: 0.4047 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.1872 - accuracy50: 0.4284 - val_loss: 3.2444 - val_accuracy50: 0.4034 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 3.1814 - accuracy50: 0.4317 - val_loss: 3.2455 - val_accuracy50: 0.4032 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.1744 - accuracy50: 0.4337 - val_loss: 3.2428 - val_accuracy50: 0.4048 - 14s/epoch - 32ms/step
Epoch 11/50
451/451 - 14s - loss: 3.1701 - accuracy50: 0.4358 - val_loss: 3.2340 - val_accuracy50: 0.4092 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 14s - loss: 3.1624 - accuracy50: 0.4396 - val_loss: 3.2322 - val_accuracy50: 0.4106 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.1601 - accuracy50: 0.4395 - val_loss: 3.2400 - val_accuracy50: 0.4108 - 15s/epoch - 32ms/step
Epoch 14/50
451/451 - 15s - loss: 3.1516 - accuracy50: 0.4445 - val_loss: 3.2471 - val_accuracy50: 0.4103 - 15s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 3.1472 - accuracy50: 0.4453 - val_loss: 3.2492 - val_accuracy50: 0.4082 - 14s/epoch - 32ms/step
Epoch 16/50
451/451 - 14s - loss: 3.1439 - accuracy50: 0.4467 - val_loss: 3.2544 - val_accuracy50: 0.4068 - 14s/epoch - 31ms/step
Epoch 17/50
451/451 - 14s - loss: 3.1359 - accuracy50: 0.4503 - val_loss: 3.2592 - val_accuracy50: 0.4046 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 3.1327 - accuracy50: 0.4518 - val_loss: 3.2590 - val_accuracy50: 0.4066 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 3.1240 - accuracy50: 0.4537 - val_loss: 3.2642 - val_accuracy50: 0.4050 - 14s/epoch - 32ms/step
Epoch 20/50
451/451 - 14s - loss: 3.1225 - accuracy50: 0.4560 - val_loss: 3.2646 - val_accuracy50: 0.4029 - 14s/epoch - 32ms/step
Epoch 21/50
451/451 - 14s - loss: 3.1144 - accuracy50: 0.4587 - val_loss: 3.2746 - val_accuracy50: 0.4063 - 14s/epoch - 31ms/step
Epoch 22/50
451/451 - 14s - loss: 3.1084 - accuracy50: 0.4594 - val_loss: 3.2769 - val_accuracy50: 0.4056 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepVOL_L2/h50
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0666572
{'0': {'precision': 0.433358234295416, 'recall': 0.46904378633854477, 'f1-score': 0.4504954164710534, 'support': 136047}, '1': {'precision': 0.4677956978116395, 'recall': 0.16062073034626403, 'f1-score': 0.23913342576227414, 'support': 140673}, '2': {'precision': 0.4037902859736723, 'recall': 0.639361465094048, 'f1-score': 0.4949767827482882, 'support': 139131}, 'accuracy': 0.4216943087788655, 'macro avg': {'precision': 0.4349814060269092, 'recall': 0.42300866059295233, 'f1-score': 0.3948685416605386, 'support': 415851}, 'weighted avg': {'precision': 0.4351151209862384, 'recall': 0.4216943087788655, 'f1-score': 0.39387853122259137, 'support': 415851}}
[[63812 13417 58818]
 [45551 22595 72527]
 [37887 12289 88955]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0663428
{'0': {'precision': 0.4118264724755479, 'recall': 0.5530920296667712, 'f1-score': 0.4721185033270545, 'support': 38292}, '1': {'precision': 0.473901316833254, 'recall': 0.1575172704740811, 'f1-score': 0.23644423335708067, 'support': 37926}, '2': {'precision': 0.41667152887177394, 'recall': 0.5460848287112561, 'f1-score': 0.4726803384483006, 'support': 39232}, 'accuracy': 0.42076223473365093, 'macro avg': {'precision': 0.4341331060601919, 'recall': 0.41889804295070276, 'f1-score': 0.39374769171081186, 'support': 115450}, 'weighted avg': {'precision': 0.43386485965308885, 'recall': 0.42076223473365093, 'f1-score': 0.3948890494733992, 'support': 115450}}
[[21179  3517 13596]
 [15555  5974 16397]
 [14693  3115 21424]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764942
{'0': {'precision': 0.42393133625042073, 'recall': 0.495605981112277, 'f1-score': 0.45697526758178625, 'support': 15248}, '1': {'precision': 0.4236997523337779, 'recall': 0.14955282092663574, 'f1-score': 0.22107355864811132, 'support': 14871}, '2': {'precision': 0.39822206095791, 'recall': 0.5851772860570514, 'f1-score': 0.4739285328727194, 'support': 15004}, 'accuracy': 0.4113423309620371, 'macro avg': {'precision': 0.41528438318070293, 'recall': 0.4101120293653214, 'f1-score': 0.38399245303420565, 'support': 45123}, 'weighted avg': {'precision': 0.41530633678422335, 'recall': 0.4113423309620371, 'f1-score': 0.38486730664994406, 'support': 45123}}
[[7557 1601 6090]
 [5469 2224 7178]
 [4800 1424 8780]]
training model: results/XRAY/W0/deepVOL_L2/h100
Epoch 1/50
451/451 - 17s - loss: 3.3407 - accuracy100: 0.3500 - val_loss: 3.3350 - val_accuracy100: 0.3429 - 17s/epoch - 38ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2961 - accuracy100: 0.3597 - val_loss: 3.3138 - val_accuracy100: 0.3465 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2832 - accuracy100: 0.3700 - val_loss: 3.2920 - val_accuracy100: 0.3583 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2726 - accuracy100: 0.3753 - val_loss: 3.2879 - val_accuracy100: 0.3676 - 14s/epoch - 32ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2651 - accuracy100: 0.3814 - val_loss: 3.2874 - val_accuracy100: 0.3680 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2599 - accuracy100: 0.3861 - val_loss: 3.2882 - val_accuracy100: 0.3715 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2528 - accuracy100: 0.3901 - val_loss: 3.2807 - val_accuracy100: 0.3754 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2480 - accuracy100: 0.3939 - val_loss: 3.2851 - val_accuracy100: 0.3716 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2424 - accuracy100: 0.3982 - val_loss: 3.2867 - val_accuracy100: 0.3739 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2374 - accuracy100: 0.4015 - val_loss: 3.2847 - val_accuracy100: 0.3737 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2361 - accuracy100: 0.4017 - val_loss: 3.2866 - val_accuracy100: 0.3726 - 14s/epoch - 32ms/step
Epoch 12/50
451/451 - 15s - loss: 3.2301 - accuracy100: 0.4058 - val_loss: 3.2839 - val_accuracy100: 0.3767 - 15s/epoch - 32ms/step
Epoch 13/50
451/451 - 15s - loss: 3.2206 - accuracy100: 0.4116 - val_loss: 3.2875 - val_accuracy100: 0.3765 - 15s/epoch - 32ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2177 - accuracy100: 0.4114 - val_loss: 3.2890 - val_accuracy100: 0.3769 - 14s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2142 - accuracy100: 0.4149 - val_loss: 3.2928 - val_accuracy100: 0.3736 - 14s/epoch - 30ms/step
Epoch 16/50
451/451 - 14s - loss: 3.2086 - accuracy100: 0.4174 - val_loss: 3.2926 - val_accuracy100: 0.3763 - 14s/epoch - 30ms/step
Epoch 17/50
451/451 - 13s - loss: 3.2024 - accuracy100: 0.4204 - val_loss: 3.2954 - val_accuracy100: 0.3740 - 13s/epoch - 30ms/step
testing model: results/XRAY/W0/deepVOL_L2/h100
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945679
{'0': {'precision': 0.3722331576129173, 'recall': 0.3610527932817861, 'f1-score': 0.36655774229483845, 'support': 136703}, '1': {'precision': 0.38872898391812866, 'recall': 0.12353269983230855, 'f1-score': 0.18748519520297033, 'support': 137753}, '2': {'precision': 0.3639332214232623, 'recall': 0.6163867180593373, 'f1-score': 0.4576538636238326, 'support': 141395}, 'accuracy': 0.3691899261995282, 'macro avg': {'precision': 0.37496512098476936, 'recall': 0.36699073705781066, 'f1-score': 0.33723226704054715, 'support': 415851}, 'weighted avg': {'precision': 0.3748754022714261, 'recall': 0.3691899261995282, 'f1-score': 0.33821286755789426, 'support': 415851}}
[[49357 12731 74615]
 [43027 17017 77709]
 [40213 14028 87154]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0877476
{'0': {'precision': 0.3873076653669243, 'recall': 0.435815248804582, 'f1-score': 0.41013215314435475, 'support': 38062}, '1': {'precision': 0.3973934331797235, 'recall': 0.14485564304461943, 'f1-score': 0.2123182272832192, 'support': 38100}, '2': {'precision': 0.3759726218650503, 'recall': 0.5620545713703929, 'f1-score': 0.45055651340018976, 'support': 39288}, 'accuracy': 0.3827544391511477, 'macro avg': {'precision': 0.3868912401372327, 'recall': 0.38090848773986474, 'f1-score': 0.35766896460925457, 'support': 115450}, 'weighted avg': {'precision': 0.38677874864597167, 'recall': 0.3827544391511477, 'f1-score': 0.3586075250839128, 'support': 115450}}
[[16588  4061 17413]
 [13343  5519 19238]
 [12898  4308 22082]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929513
{'0': {'precision': 0.38553910667767965, 'recall': 0.39850265974912985, 'f1-score': 0.39191371181295614, 'support': 15227}, '1': {'precision': 0.39292428644676125, 'recall': 0.15375869448903157, 'f1-score': 0.22102581358457915, 'support': 14952}, '2': {'precision': 0.3634045808014278, 'recall': 0.5722698072805139, 'f1-score': 0.4445253008290667, 'support': 14944}, 'accuracy': 0.37495290650001106, 'macro avg': {'precision': 0.3806226579752896, 'recall': 0.3748437205062251, 'f1-score': 0.35248827540886735, 'support': 45123}, 'weighted avg': {'precision': 0.3806556736881311, 'recall': 0.37495290650001106, 'f1-score': 0.35271223433907506, 'support': 45123}}
[[6068 1820 7339]
 [5011 2299 7642]
 [4660 1732 8552]]
training model: results/XRAY/W0/deepVOL_L2/h200
Epoch 1/50
451/451 - 16s - loss: 3.3300 - accuracy200: 0.3597 - val_loss: 3.3569 - val_accuracy200: 0.3260 - 16s/epoch - 35ms/step
Epoch 2/50
451/451 - 14s - loss: 3.3024 - accuracy200: 0.3622 - val_loss: 3.3334 - val_accuracy200: 0.3320 - 14s/epoch - 30ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2900 - accuracy200: 0.3693 - val_loss: 3.3236 - val_accuracy200: 0.3336 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2860 - accuracy200: 0.3649 - val_loss: 3.3139 - val_accuracy200: 0.3361 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2806 - accuracy200: 0.3698 - val_loss: 3.3180 - val_accuracy200: 0.3380 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2762 - accuracy200: 0.3738 - val_loss: 3.3156 - val_accuracy200: 0.3355 - 14s/epoch - 31ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2716 - accuracy200: 0.3776 - val_loss: 3.3196 - val_accuracy200: 0.3331 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2688 - accuracy200: 0.3807 - val_loss: 3.3145 - val_accuracy200: 0.3398 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2660 - accuracy200: 0.3819 - val_loss: 3.3200 - val_accuracy200: 0.3372 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2609 - accuracy200: 0.3860 - val_loss: 3.3158 - val_accuracy200: 0.3402 - 14s/epoch - 30ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2562 - accuracy200: 0.3892 - val_loss: 3.3159 - val_accuracy200: 0.3441 - 14s/epoch - 31ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2547 - accuracy200: 0.3901 - val_loss: 3.3136 - val_accuracy200: 0.3438 - 14s/epoch - 32ms/step
Epoch 13/50
451/451 - 14s - loss: 3.2485 - accuracy200: 0.3966 - val_loss: 3.3181 - val_accuracy200: 0.3412 - 14s/epoch - 31ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2417 - accuracy200: 0.3993 - val_loss: 3.3222 - val_accuracy200: 0.3380 - 14s/epoch - 32ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2391 - accuracy200: 0.4004 - val_loss: 3.3238 - val_accuracy200: 0.3434 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 13s - loss: 3.2369 - accuracy200: 0.4013 - val_loss: 3.3325 - val_accuracy200: 0.3400 - 13s/epoch - 29ms/step
Epoch 17/50
451/451 - 14s - loss: 3.2315 - accuracy200: 0.4067 - val_loss: 3.3362 - val_accuracy200: 0.3394 - 14s/epoch - 31ms/step
Epoch 18/50
451/451 - 14s - loss: 3.2292 - accuracy200: 0.4074 - val_loss: 3.3383 - val_accuracy200: 0.3376 - 14s/epoch - 31ms/step
Epoch 19/50
451/451 - 14s - loss: 3.2239 - accuracy200: 0.4103 - val_loss: 3.3384 - val_accuracy200: 0.3368 - 14s/epoch - 30ms/step
Epoch 20/50
451/451 - 14s - loss: 3.2232 - accuracy200: 0.4098 - val_loss: 3.3445 - val_accuracy200: 0.3352 - 14s/epoch - 31ms/step
Epoch 21/50
451/451 - 14s - loss: 3.2200 - accuracy200: 0.4118 - val_loss: 3.3452 - val_accuracy200: 0.3390 - 14s/epoch - 31ms/step
Epoch 22/50
451/451 - 14s - loss: 3.2162 - accuracy200: 0.4149 - val_loss: 3.3470 - val_accuracy200: 0.3408 - 14s/epoch - 30ms/step
testing model: results/XRAY/W0/deepVOL_L2/h200
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1015804
{'0': {'precision': 0.27084186438636637, 'recall': 0.21330601559387627, 'f1-score': 0.23865517680519588, 'support': 105426}, '1': {'precision': 0.5622205866317741, 'recall': 0.2112462550892377, 'f1-score': 0.30710299925921236, 'support': 195265}, '2': {'precision': 0.2884106177226704, 'recall': 0.6497829107328934, 'f1-score': 0.3995002842933908, 'support': 115160}, 'accuracy': 0.3332106932531123, 'macro avg': {'precision': 0.37382435624693694, 'recall': 0.3581117271386691, 'f1-score': 0.31508615345259966, 'support': 415851}, 'weighted avg': {'precision': 0.4125255054824761, 'recall': 0.3332106932531123, 'f1-score': 0.3153374178718858, 'support': 415851}}
[[ 22488  15359  67579]
 [ 36971  41249 117045]
 [ 23571  16760  74829]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911025
{'0': {'precision': 0.38280138239479566, 'recall': 0.2985808293031, 'f1-score': 0.3354861698810744, 'support': 37839}, '1': {'precision': 0.387773265839684, 'recall': 0.1832014927334367, 'f1-score': 0.24883986578139497, 'support': 38051}, '2': {'precision': 0.366279668623729, 'recall': 0.629221435793731, 'f1-score': 0.4630251397427432, 'support': 39560}, 'accuracy': 0.3738501515807709, 'macro avg': {'precision': 0.37895143895273625, 'recall': 0.37033458594342256, 'f1-score': 0.3491170584684042, 'support': 115450}, 'weighted avg': {'precision': 0.3787787417726913, 'recall': 0.3738501515807709, 'f1-score': 0.3506309349779191, 'support': 115450}}
[[11298  5646 20895]
 [ 8908  6971 22172]
 [ 9308  5360 24892]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035078
{'0': {'precision': 0.34435107376283847, 'recall': 0.24986449864498644, 'f1-score': 0.28959560266980766, 'support': 14760}, '1': {'precision': 0.3703476983349657, 'recall': 0.18963139418254765, 'f1-score': 0.2508291873963515, 'support': 15952}, '2': {'precision': 0.3263097732901505, 'recall': 0.5942682672958157, 'f1-score': 0.4212908303817394, 'support': 14411}, 'accuracy': 0.3385634820379851, 'macro avg': {'precision': 0.34700284846265156, 'recall': 0.3445880533744499, 'f1-score': 0.3205718734826329, 'support': 45123}, 'weighted avg': {'precision': 0.34777959079545306, 'recall': 0.3385634820379851, 'f1-score': 0.31795050083957643, 'support': 45123}}
[[3688 2660 8412]
 [3658 3025 9269]
 [3364 2483 8564]]
training model: results/XRAY/W0/deepVOL_L2/h300
Epoch 1/50
451/451 - 16s - loss: 3.3356 - accuracy300: 0.3590 - val_loss: 3.3566 - val_accuracy300: 0.3387 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.2991 - accuracy300: 0.3647 - val_loss: 3.3314 - val_accuracy300: 0.3383 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2897 - accuracy300: 0.3690 - val_loss: 3.3186 - val_accuracy300: 0.3451 - 14s/epoch - 30ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2850 - accuracy300: 0.3689 - val_loss: 3.3305 - val_accuracy300: 0.3399 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2872 - accuracy300: 0.3633 - val_loss: 3.3139 - val_accuracy300: 0.3445 - 14s/epoch - 30ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2843 - accuracy300: 0.3648 - val_loss: 3.3162 - val_accuracy300: 0.3434 - 14s/epoch - 30ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2803 - accuracy300: 0.3684 - val_loss: 3.3151 - val_accuracy300: 0.3481 - 14s/epoch - 30ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2738 - accuracy300: 0.3748 - val_loss: 3.3185 - val_accuracy300: 0.3494 - 14s/epoch - 31ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2673 - accuracy300: 0.3809 - val_loss: 3.3259 - val_accuracy300: 0.3487 - 14s/epoch - 31ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2645 - accuracy300: 0.3822 - val_loss: 3.3310 - val_accuracy300: 0.3467 - 14s/epoch - 32ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2604 - accuracy300: 0.3838 - val_loss: 3.3463 - val_accuracy300: 0.3491 - 14s/epoch - 31ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2577 - accuracy300: 0.3841 - val_loss: 3.3500 - val_accuracy300: 0.3494 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 13s - loss: 3.2523 - accuracy300: 0.3900 - val_loss: 3.3569 - val_accuracy300: 0.3481 - 13s/epoch - 30ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2456 - accuracy300: 0.3954 - val_loss: 3.3586 - val_accuracy300: 0.3502 - 14s/epoch - 31ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2395 - accuracy300: 0.3979 - val_loss: 3.3711 - val_accuracy300: 0.3481 - 14s/epoch - 31ms/step
testing model: results/XRAY/W0/deepVOL_L2/h300
Evaluating performance on  test set...
1625/1625 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0860524
{'0': {'precision': 0.303001334368963, 'recall': 0.13064722501309564, 'f1-score': 0.18257311204713733, 'support': 116451}, '1': {'precision': 0.45137578630923036, 'recall': 0.6955883445009968, 'f1-score': 0.5474830947413856, 'support': 175059}, '2': {'precision': 0.3202353260245966, 'recall': 0.24690166558094273, 'f1-score': 0.2788272905616508, 'support': 124341}, 'accuracy': 0.40322856022950526, 'macro avg': {'precision': 0.35820414890093, 'recall': 0.35771241169834506, 'f1-score': 0.33629449911672454, 'support': 415851}, 'weighted avg': {'precision': 0.370614914566352, 'recall': 0.40322856022950526, 'f1-score': 0.36496805030902807, 'support': 415851}}
[[ 15214  71829  29408]
 [ 17531 121769  35759]
 [ 17466  76175  30700]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973655
{'0': {'precision': 0.374649357427099, 'recall': 0.15328973708794874, 'f1-score': 0.21756260181081183, 'support': 37465}, '1': {'precision': 0.3481628675214216, 'recall': 0.720048163756773, 'f1-score': 0.46937173668225096, 'support': 38203}, '2': {'precision': 0.3784577491474043, 'recall': 0.2008446030868232, 'f1-score': 0.26242322724734785, 'support': 39782}, 'accuracy': 0.3572195755738415, 'macro avg': {'precision': 0.3670899913653083, 'recall': 0.3580608346438483, 'f1-score': 0.31645252191347023, 'support': 115450}, 'weighted avg': {'precision': 0.3671971449156273, 'recall': 0.3572195755738415, 'f1-score': 0.31634570948175045, 'support': 115450}}
[[ 5743 24996  6726]
 [ 4299 27508  6396]
 [ 5287 26505  7990]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030743
{'0': {'precision': 0.3665223665223665, 'recall': 0.13146147376593129, 'f1-score': 0.193514594543117, 'support': 15457}, '1': {'precision': 0.34405368617644266, 'recall': 0.7351866883116883, 'f1-score': 0.46874393530997305, 'support': 14784}, '2': {'precision': 0.3372558838257386, 'recall': 0.1810240559064642, 'f1-score': 0.23559247923043286, 'support': 14882}, 'accuracy': 0.3456108858010327, 'macro avg': {'precision': 0.3492773121748493, 'recall': 0.3492240726613613, 'f1-score': 0.29928366969450765, 'support': 45123}, 'weighted avg': {'precision': 0.34950840987663473, 'recall': 0.3456108858010327, 'f1-score': 0.2975678191472842, 'support': 45123}}
[[ 2032 10567  2858]
 [ 1479 10869  2436]
 [ 2033 10155  2694]]
training model: results/XRAY/W0/deepVOL_L2/h500
Epoch 1/50
451/451 - 16s - loss: 3.3376 - accuracy500: 0.3587 - val_loss: 3.3555 - val_accuracy500: 0.3361 - 16s/epoch - 36ms/step
Epoch 2/50
451/451 - 14s - loss: 3.3008 - accuracy500: 0.3625 - val_loss: 3.3460 - val_accuracy500: 0.3440 - 14s/epoch - 31ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2865 - accuracy500: 0.3724 - val_loss: 3.3360 - val_accuracy500: 0.3351 - 14s/epoch - 30ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2740 - accuracy500: 0.3772 - val_loss: 3.3377 - val_accuracy500: 0.3385 - 14s/epoch - 30ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2637 - accuracy500: 0.3847 - val_loss: 3.3354 - val_accuracy500: 0.3434 - 14s/epoch - 30ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2567 - accuracy500: 0.3870 - val_loss: 3.3238 - val_accuracy500: 0.3462 - 14s/epoch - 30ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2501 - accuracy500: 0.3940 - val_loss: 3.3379 - val_accuracy500: 0.3470 - 14s/epoch - 30ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2415 - accuracy500: 0.3969 - val_loss: 3.3418 - val_accuracy500: 0.3440 - 14s/epoch - 30ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2367 - accuracy500: 0.3988 - val_loss: 3.3312 - val_accuracy500: 0.3482 - 14s/epoch - 30ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2309 - accuracy500: 0.4026 - val_loss: 3.3619 - val_accuracy500: 0.3434 - 14s/epoch - 30ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2244 - accuracy500: 0.4068 - val_loss: 3.3635 - val_accuracy500: 0.3401 - 14s/epoch - 30ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2195 - accuracy500: 0.4099 - val_loss: 3.3634 - val_accuracy500: 0.3389 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 3.2099 - accuracy500: 0.4147 - val_loss: 3.3674 - val_accuracy500: 0.3399 - 14s/epoch - 30ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2024 - accuracy500: 0.4175 - val_loss: 3.3808 - val_accuracy500: 0.3391 - 14s/epoch - 30ms/step
Epoch 15/50
451/451 - 14s - loss: 3.1970 - accuracy500: 0.4217 - val_loss: 3.3746 - val_accuracy500: 0.3441 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 14s - loss: 3.1901 - accuracy500: 0.4254 - val_loss: 3.3707 - val_accuracy500: 0.3510 - 14s/epoch - 32ms/step
testing model: results/XRAY/W0/deepVOL_L2/h500
Evaluating performance on  test set...
1625/1625 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026136
{'0': {'precision': 0.32599997323591207, 'recall': 0.19207297842815693, 'f1-score': 0.24172574779593076, 'support': 126832}, '1': {'precision': 0.43190817231754547, 'recall': 0.2584247116243543, 'f1-score': 0.3233678924347967, 'support': 154486}, '2': {'precision': 0.32868229522698944, 'recall': 0.6075832695323824, 'f1-score': 0.4265923496241092, 'support': 134533}, 'accuracy': 0.351145001454848, 'macro avg': {'precision': 0.3621968135934823, 'recall': 0.35269365319496454, 'f1-score': 0.33056199661827884, 'support': 415851}, 'weighted avg': {'precision': 0.3662119599036147, 'recall': 0.351145001454848, 'f1-score': 0.33186194297264104, 'support': 415851}}
[[24361 25980 76491]
 [24104 39923 90459]
 [26262 26531 81740]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0912873
{'0': {'precision': 0.37057310800881704, 'recall': 0.27185748167313495, 'f1-score': 0.3136309930974442, 'support': 37104}, '1': {'precision': 0.40252927400468386, 'recall': 0.22770991759624812, 'f1-score': 0.2908733986563098, 'support': 37741}, '2': {'precision': 0.3713367224880383, 'recall': 0.6116241842137667, 'f1-score': 0.46211099223147417, 'support': 40605}, 'accuracy': 0.3769250757903854, 'macro avg': {'precision': 0.3814797015005131, 'recall': 0.3703971944943833, 'f1-score': 0.3555384613284094, 'support': 115450}, 'weighted avg': {'precision': 0.3812882593884514, 'recall': 0.3769250757903854, 'f1-score': 0.3584134616382362, 'support': 115450}}
[[10087  6300 20717]
 [ 7819  8594 21328]
 [ 9314  6456 24835]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103372
{'0': {'precision': 0.353607246845681, 'recall': 0.21649280338043048, 'f1-score': 0.2685613661493099, 'support': 15146}, '1': {'precision': 0.375180856983862, 'recall': 0.2239271954297861, 'f1-score': 0.28046091767544407, 'support': 15054}, '2': {'precision': 0.32964824120603015, 'recall': 0.5934463579709174, 'f1-score': 0.423853737915191, 'support': 14923}, 'accuracy': 0.3436384992132615, 'macro avg': {'precision': 0.3528121150118577, 'recall': 0.34462211892704464, 'f1-score': 0.32429200724664836, 'support': 45123}, 'weighted avg': {'precision': 0.35288098498054943, 'recall': 0.3436384992132615, 'f1-score': 0.32388933442572476, 'support': 45123}}
[[3279 2857 9010]
 [2684 3371 8999]
 [3310 2757 8856]]
training model: results/XRAY/W0/deepVOL_L2/h1000
Epoch 1/50
451/451 - 17s - loss: 3.3398 - accuracy1000: 0.3586 - val_loss: 3.4298 - val_accuracy1000: 0.3248 - 17s/epoch - 37ms/step
Epoch 2/50
451/451 - 14s - loss: 3.3019 - accuracy1000: 0.3639 - val_loss: 3.4068 - val_accuracy1000: 0.3314 - 14s/epoch - 32ms/step
Epoch 3/50
451/451 - 14s - loss: 3.2929 - accuracy1000: 0.3632 - val_loss: 3.4072 - val_accuracy1000: 0.3244 - 14s/epoch - 31ms/step
Epoch 4/50
451/451 - 14s - loss: 3.2852 - accuracy1000: 0.3653 - val_loss: 3.4032 - val_accuracy1000: 0.3245 - 14s/epoch - 31ms/step
Epoch 5/50
451/451 - 14s - loss: 3.2797 - accuracy1000: 0.3683 - val_loss: 3.4130 - val_accuracy1000: 0.3265 - 14s/epoch - 31ms/step
Epoch 6/50
451/451 - 14s - loss: 3.2775 - accuracy1000: 0.3711 - val_loss: 3.4013 - val_accuracy1000: 0.3200 - 14s/epoch - 30ms/step
Epoch 7/50
451/451 - 14s - loss: 3.2760 - accuracy1000: 0.3738 - val_loss: 3.4100 - val_accuracy1000: 0.3213 - 14s/epoch - 31ms/step
Epoch 8/50
451/451 - 14s - loss: 3.2690 - accuracy1000: 0.3791 - val_loss: 3.4106 - val_accuracy1000: 0.3246 - 14s/epoch - 30ms/step
Epoch 9/50
451/451 - 14s - loss: 3.2623 - accuracy1000: 0.3827 - val_loss: 3.4149 - val_accuracy1000: 0.3283 - 14s/epoch - 30ms/step
Epoch 10/50
451/451 - 14s - loss: 3.2581 - accuracy1000: 0.3845 - val_loss: 3.4289 - val_accuracy1000: 0.3218 - 14s/epoch - 31ms/step
Epoch 11/50
451/451 - 14s - loss: 3.2515 - accuracy1000: 0.3859 - val_loss: 3.4290 - val_accuracy1000: 0.3241 - 14s/epoch - 31ms/step
Epoch 12/50
451/451 - 14s - loss: 3.2422 - accuracy1000: 0.3941 - val_loss: 3.4570 - val_accuracy1000: 0.3242 - 14s/epoch - 31ms/step
Epoch 13/50
451/451 - 14s - loss: 3.2345 - accuracy1000: 0.4015 - val_loss: 3.4685 - val_accuracy1000: 0.3249 - 14s/epoch - 31ms/step
Epoch 14/50
451/451 - 14s - loss: 3.2227 - accuracy1000: 0.4087 - val_loss: 3.4672 - val_accuracy1000: 0.3315 - 14s/epoch - 30ms/step
Epoch 15/50
451/451 - 14s - loss: 3.2187 - accuracy1000: 0.4122 - val_loss: 3.4672 - val_accuracy1000: 0.3351 - 14s/epoch - 31ms/step
Epoch 16/50
451/451 - 14s - loss: 3.2100 - accuracy1000: 0.4160 - val_loss: 3.4938 - val_accuracy1000: 0.3290 - 14s/epoch - 31ms/step
testing model: results/XRAY/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
1625/1625 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010412
{'0': {'precision': 0.19950617283950617, 'recall': 0.01054610003132505, 'f1-score': 0.020033223415069544, 'support': 114924}, '1': {'precision': 0.4427573548600358, 'recall': 0.5716170838808217, 'f1-score': 0.49900245587031433, 'support': 178086}, '2': {'precision': 0.3066106972089403, 'recall': 0.4489299175356762, 'f1-score': 0.36436615670248856, 'support': 122841}, 'accuracy': 0.3803189123027238, 'macro avg': {'precision': 0.3162914083028274, 'recall': 0.3436977004826076, 'f1-score': 0.2944672786626241, 'support': 415851}, 'weighted avg': {'precision': 0.3353155297470853, 'recall': 0.3803189123027238, 'f1-score': 0.3268640753042908, 'support': 415851}}
[[  1212  62208  51504]
 [  3080 101797  73209]
 [  1783  65911  55147]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085411
{'0': {'precision': 0.41838538597525043, 'recall': 0.03793951052687827, 'f1-score': 0.06957032972416834, 'support': 37428}, '1': {'precision': 0.32763658024621317, 'recall': 0.6321247776713641, 'f1-score': 0.4315806189457559, 'support': 36545}, '2': {'precision': 0.3820159815153557, 'recall': 0.3826699134460062, 'f1-score': 0.38234266787112314, 'support': 41477}, 'accuracy': 0.34987440450411433, 'macro avg': {'precision': 0.3760126492456064, 'recall': 0.35091140054808284, 'f1-score': 0.2944978721803491, 'support': 115450}, 'weighted avg': {'precision': 0.37659319113635287, 'recall': 0.34987440450411433, 'f1-score': 0.2965302629326929, 'support': 115450}}
[[ 1420 22906 13102]
 [  870 23101 12574]
 [ 1104 24501 15872]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12779
{'0': {'precision': 0.34698055271238487, 'recall': 0.021885087153001935, 'f1-score': 0.041173255602113316, 'support': 15490}, '1': {'precision': 0.32467720351549784, 'recall': 0.6105556689111066, 'f1-score': 0.4239233094068757, 'support': 14703}, '2': {'precision': 0.3146632721100806, 'recall': 0.3476892163429337, 'f1-score': 0.33035288128042767, 'support': 14930}, 'accuracy': 0.3214990138067061, 'macro avg': {'precision': 0.32877367611265446, 'recall': 0.3267099908023474, 'f1-score': 0.2651498154298056, 'support': 45123}, 'weighted avg': {'precision': 0.3290202410612484, 'recall': 0.3214990138067061, 'f1-score': 0.2615714084835409, 'support': 45123}}
[[ 339 9256 5895]
 [ 315 8977 5411]
 [ 323 9416 5191]]
training model: results/XRAY/W0/deepVOL_L3/h10
Epoch 1/50
451/451 - 23s - loss: 3.3240 - accuracy10: 0.3650 - val_loss: 3.2635 - val_accuracy10: 0.3898 - 23s/epoch - 51ms/step
Epoch 2/50
451/451 - 20s - loss: 3.2408 - accuracy10: 0.4133 - val_loss: 3.2124 - val_accuracy10: 0.4442 - 20s/epoch - 44ms/step
Epoch 3/50
451/451 - 20s - loss: 3.1624 - accuracy10: 0.4478 - val_loss: 3.1078 - val_accuracy10: 0.4808 - 20s/epoch - 45ms/step
Epoch 4/50
451/451 - 19s - loss: 3.0611 - accuracy10: 0.4704 - val_loss: 3.0293 - val_accuracy10: 0.4872 - 19s/epoch - 43ms/step
Epoch 5/50
451/451 - 19s - loss: 3.0099 - accuracy10: 0.4839 - val_loss: 3.0428 - val_accuracy10: 0.5153 - 19s/epoch - 42ms/step
Epoch 6/50
451/451 - 19s - loss: 2.9762 - accuracy10: 0.4952 - val_loss: 2.9853 - val_accuracy10: 0.5166 - 19s/epoch - 43ms/step
Epoch 7/50
451/451 - 19s - loss: 2.9531 - accuracy10: 0.5005 - val_loss: 2.9877 - val_accuracy10: 0.5145 - 19s/epoch - 42ms/step
Epoch 8/50
451/451 - 19s - loss: 2.9352 - accuracy10: 0.5058 - val_loss: 2.9588 - val_accuracy10: 0.5251 - 19s/epoch - 43ms/step
Epoch 9/50
451/451 - 20s - loss: 2.9186 - accuracy10: 0.5122 - val_loss: 2.9478 - val_accuracy10: 0.5215 - 20s/epoch - 44ms/step
Epoch 10/50
451/451 - 19s - loss: 2.9048 - accuracy10: 0.5152 - val_loss: 2.9424 - val_accuracy10: 0.5283 - 19s/epoch - 43ms/step
Epoch 11/50
451/451 - 19s - loss: 2.8902 - accuracy10: 0.5212 - val_loss: 2.9517 - val_accuracy10: 0.5328 - 19s/epoch - 42ms/step
Epoch 12/50
451/451 - 19s - loss: 2.8782 - accuracy10: 0.5235 - val_loss: 2.9477 - val_accuracy10: 0.5325 - 19s/epoch - 43ms/step
Epoch 13/50
451/451 - 19s - loss: 2.8663 - accuracy10: 0.5286 - val_loss: 2.9315 - val_accuracy10: 0.5309 - 19s/epoch - 43ms/step
Epoch 14/50
451/451 - 19s - loss: 2.8562 - accuracy10: 0.5315 - val_loss: 2.9251 - val_accuracy10: 0.5336 - 19s/epoch - 42ms/step
Epoch 15/50
451/451 - 19s - loss: 2.8480 - accuracy10: 0.5341 - val_loss: 2.9319 - val_accuracy10: 0.5353 - 19s/epoch - 43ms/step
Epoch 16/50
451/451 - 21s - loss: 2.8401 - accuracy10: 0.5355 - val_loss: 2.9368 - val_accuracy10: 0.5340 - 21s/epoch - 46ms/step
Epoch 17/50
451/451 - 20s - loss: 2.8336 - accuracy10: 0.5374 - val_loss: 2.9200 - val_accuracy10: 0.5368 - 20s/epoch - 43ms/step
Epoch 18/50
451/451 - 19s - loss: 2.8259 - accuracy10: 0.5399 - val_loss: 2.9204 - val_accuracy10: 0.5333 - 19s/epoch - 42ms/step
Epoch 19/50
451/451 - 19s - loss: 2.8196 - accuracy10: 0.5431 - val_loss: 2.9129 - val_accuracy10: 0.5356 - 19s/epoch - 43ms/step
Epoch 20/50
451/451 - 19s - loss: 2.8129 - accuracy10: 0.5436 - val_loss: 2.9126 - val_accuracy10: 0.5340 - 19s/epoch - 42ms/step
Epoch 21/50
451/451 - 19s - loss: 2.8059 - accuracy10: 0.5454 - val_loss: 2.9098 - val_accuracy10: 0.5361 - 19s/epoch - 43ms/step
Epoch 22/50
451/451 - 19s - loss: 2.7999 - accuracy10: 0.5470 - val_loss: 2.9163 - val_accuracy10: 0.5357 - 19s/epoch - 43ms/step
Epoch 23/50
451/451 - 19s - loss: 2.7950 - accuracy10: 0.5495 - val_loss: 2.9145 - val_accuracy10: 0.5370 - 19s/epoch - 42ms/step
Epoch 24/50
451/451 - 19s - loss: 2.7863 - accuracy10: 0.5493 - val_loss: 2.9011 - val_accuracy10: 0.5340 - 19s/epoch - 42ms/step
Epoch 25/50
451/451 - 19s - loss: 2.7830 - accuracy10: 0.5516 - val_loss: 2.9045 - val_accuracy10: 0.5348 - 19s/epoch - 43ms/step
Epoch 26/50
451/451 - 20s - loss: 2.7776 - accuracy10: 0.5518 - val_loss: 2.9046 - val_accuracy10: 0.5314 - 20s/epoch - 44ms/step
Epoch 27/50
451/451 - 20s - loss: 2.7715 - accuracy10: 0.5549 - val_loss: 2.9104 - val_accuracy10: 0.5342 - 20s/epoch - 44ms/step
Epoch 28/50
451/451 - 19s - loss: 2.7646 - accuracy10: 0.5563 - val_loss: 2.9020 - val_accuracy10: 0.5336 - 19s/epoch - 43ms/step
Epoch 29/50
451/451 - 19s - loss: 2.7617 - accuracy10: 0.5566 - val_loss: 2.9113 - val_accuracy10: 0.5337 - 19s/epoch - 43ms/step
Epoch 30/50
451/451 - 20s - loss: 2.7553 - accuracy10: 0.5578 - val_loss: 2.9193 - val_accuracy10: 0.5339 - 20s/epoch - 43ms/step
Epoch 31/50
451/451 - 19s - loss: 2.7506 - accuracy10: 0.5589 - val_loss: 2.9150 - val_accuracy10: 0.5301 - 19s/epoch - 42ms/step
Epoch 32/50
451/451 - 20s - loss: 2.7478 - accuracy10: 0.5600 - val_loss: 2.9168 - val_accuracy10: 0.5337 - 20s/epoch - 43ms/step
Epoch 33/50
451/451 - 20s - loss: 2.7413 - accuracy10: 0.5611 - val_loss: 2.9123 - val_accuracy10: 0.5294 - 20s/epoch - 44ms/step
Epoch 34/50
451/451 - 19s - loss: 2.7362 - accuracy10: 0.5636 - val_loss: 2.9123 - val_accuracy10: 0.5285 - 19s/epoch - 43ms/step
testing model: results/XRAY/W0/deepVOL_L3/h10
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9240713
{'0': {'precision': 0.4616552378487946, 'recall': 0.5009734546407578, 'f1-score': 0.4805113771541179, 'support': 106836}, '1': {'precision': 0.6784212779503617, 'recall': 0.622003381574445, 'f1-score': 0.6489885068334199, 'support': 198724}, '2': {'precision': 0.461645627686505, 'recall': 0.492732861248878, 'f1-score': 0.4766829379542036, 'support': 110291}, 'accuracy': 0.5566248488040187, 'macro avg': {'precision': 0.5339073811618872, 'recall': 0.5385698991546936, 'f1-score': 0.5353942739805805, 'support': 415851}, 'weighted avg': {'precision': 0.5652393452303681, 'recall': 0.5566248488040187, 'f1-score': 0.560006693338501, 'support': 415851}}
[[ 53522  27614  25700]
 [ 37443 123607  37674]
 [ 24970  30977  54344]]
Evaluating performance on  train set...
451/451 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94734
{'0': {'precision': 0.44927610244363303, 'recall': 0.5680387409200969, 'f1-score': 0.5017251703783969, 'support': 30975}, '1': {'precision': 0.6895309495411728, 'recall': 0.5347327091513138, 'f1-score': 0.6023453364377678, 'support': 52976}, '2': {'precision': 0.46202136120895354, 'recall': 0.5163655989079018, 'f1-score': 0.4876842121044031, 'support': 31499}, 'accuracy': 0.5386574274577739, 'macro avg': {'precision': 0.5336094710645863, 'recall': 0.5397123496597708, 'f1-score': 0.530584906306856, 'support': 115450}, 'weighted avg': {'precision': 0.5629980919255568, 'recall': 0.5386574274577739, 'f1-score': 0.5440653849517074, 'support': 115450}}
[[17595  5854  7526]
 [13235 28328 11413]
 [ 8333  6901 16265]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9553371
{'0': {'precision': 0.455364868762619, 'recall': 0.5292047263890053, 'f1-score': 0.4895159102360374, 'support': 11933}, '1': {'precision': 0.6526438959157519, 'recall': 0.5660915373834035, 'f1-score': 0.6062943216522595, 'support': 20691}, '2': {'precision': 0.45844604749023143, 'recall': 0.4881190495239619, 'f1-score': 0.47281745262913166, 'support': 12499}, 'accuracy': 0.5347383817565321, 'macro avg': {'precision': 0.5221516040562008, 'recall': 0.5278051044321236, 'f1-score': 0.5228758948391429, 'support': 45123}, 'weighted avg': {'precision': 0.546679985305001, 'recall': 0.5347383817565321, 'f1-score': 0.5384388118379773, 'support': 45123}}
[[ 6315  2840  2778]
 [ 4549 11713  4429]
 [ 3004  3394  6101]]
training model: results/XRAY/W0/deepVOL_L3/h20
Epoch 1/50
451/451 - 22s - loss: 3.3215 - accuracy20: 0.3629 - val_loss: 3.2966 - val_accuracy20: 0.3587 - 22s/epoch - 49ms/step
Epoch 2/50
451/451 - 20s - loss: 3.2281 - accuracy20: 0.4014 - val_loss: 3.2457 - val_accuracy20: 0.3874 - 20s/epoch - 44ms/step
Epoch 3/50
451/451 - 20s - loss: 3.1794 - accuracy20: 0.4237 - val_loss: 3.1976 - val_accuracy20: 0.4168 - 20s/epoch - 44ms/step
Epoch 4/50
451/451 - 19s - loss: 3.1285 - accuracy20: 0.4457 - val_loss: 3.1337 - val_accuracy20: 0.4448 - 19s/epoch - 43ms/step
Epoch 5/50
451/451 - 22s - loss: 3.0818 - accuracy20: 0.4636 - val_loss: 3.0873 - val_accuracy20: 0.4677 - 22s/epoch - 48ms/step
Epoch 6/50
451/451 - 20s - loss: 3.0531 - accuracy20: 0.4767 - val_loss: 3.0753 - val_accuracy20: 0.4748 - 20s/epoch - 45ms/step
Epoch 7/50
451/451 - 20s - loss: 3.0323 - accuracy20: 0.4844 - val_loss: 3.0592 - val_accuracy20: 0.4759 - 20s/epoch - 44ms/step
Epoch 8/50
451/451 - 19s - loss: 3.0134 - accuracy20: 0.4909 - val_loss: 3.0570 - val_accuracy20: 0.4788 - 19s/epoch - 43ms/step
Epoch 9/50
451/451 - 19s - loss: 3.0002 - accuracy20: 0.4943 - val_loss: 3.0563 - val_accuracy20: 0.4809 - 19s/epoch - 43ms/step
Epoch 10/50
451/451 - 19s - loss: 2.9834 - accuracy20: 0.4979 - val_loss: 3.0439 - val_accuracy20: 0.4865 - 19s/epoch - 43ms/step
Epoch 11/50
451/451 - 19s - loss: 2.9699 - accuracy20: 0.5027 - val_loss: 3.0373 - val_accuracy20: 0.4869 - 19s/epoch - 43ms/step
Epoch 12/50
451/451 - 20s - loss: 2.9623 - accuracy20: 0.5061 - val_loss: 3.0326 - val_accuracy20: 0.4893 - 20s/epoch - 43ms/step
Epoch 13/50
451/451 - 20s - loss: 2.9551 - accuracy20: 0.5066 - val_loss: 3.0336 - val_accuracy20: 0.4865 - 20s/epoch - 44ms/step
Epoch 14/50
451/451 - 19s - loss: 2.9462 - accuracy20: 0.5092 - val_loss: 3.0300 - val_accuracy20: 0.4899 - 19s/epoch - 43ms/step
Epoch 15/50
451/451 - 19s - loss: 2.9408 - accuracy20: 0.5112 - val_loss: 3.0268 - val_accuracy20: 0.4910 - 19s/epoch - 43ms/step
Epoch 16/50
451/451 - 19s - loss: 2.9345 - accuracy20: 0.5125 - val_loss: 3.0247 - val_accuracy20: 0.4878 - 19s/epoch - 42ms/step
Epoch 17/50
451/451 - 19s - loss: 2.9266 - accuracy20: 0.5145 - val_loss: 3.0250 - val_accuracy20: 0.4899 - 19s/epoch - 42ms/step
Epoch 18/50
451/451 - 20s - loss: 2.9234 - accuracy20: 0.5163 - val_loss: 3.0182 - val_accuracy20: 0.4905 - 20s/epoch - 44ms/step
Epoch 19/50
451/451 - 19s - loss: 2.9137 - accuracy20: 0.5170 - val_loss: 3.0300 - val_accuracy20: 0.4901 - 19s/epoch - 42ms/step
Epoch 20/50
451/451 - 19s - loss: 2.9063 - accuracy20: 0.5193 - val_loss: 3.0223 - val_accuracy20: 0.4920 - 19s/epoch - 43ms/step
Epoch 21/50
451/451 - 19s - loss: 2.9026 - accuracy20: 0.5211 - val_loss: 3.0301 - val_accuracy20: 0.4895 - 19s/epoch - 43ms/step
Epoch 22/50
451/451 - 20s - loss: 2.8945 - accuracy20: 0.5219 - val_loss: 3.0289 - val_accuracy20: 0.4905 - 20s/epoch - 45ms/step
Epoch 23/50
451/451 - 20s - loss: 2.8904 - accuracy20: 0.5231 - val_loss: 3.0255 - val_accuracy20: 0.4933 - 20s/epoch - 44ms/step
Epoch 24/50
451/451 - 20s - loss: 2.8854 - accuracy20: 0.5252 - val_loss: 3.0374 - val_accuracy20: 0.4917 - 20s/epoch - 44ms/step
Epoch 25/50
451/451 - 20s - loss: 2.8788 - accuracy20: 0.5269 - val_loss: 3.0336 - val_accuracy20: 0.4931 - 20s/epoch - 44ms/step
Epoch 26/50
451/451 - 20s - loss: 2.8743 - accuracy20: 0.5275 - val_loss: 3.0437 - val_accuracy20: 0.4923 - 20s/epoch - 43ms/step
Epoch 27/50
451/451 - 19s - loss: 2.8679 - accuracy20: 0.5302 - val_loss: 3.0553 - val_accuracy20: 0.4899 - 19s/epoch - 43ms/step
Epoch 28/50
451/451 - 20s - loss: 2.8640 - accuracy20: 0.5308 - val_loss: 3.0548 - val_accuracy20: 0.4913 - 20s/epoch - 44ms/step
testing model: results/XRAY/W0/deepVOL_L3/h20
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9832985
{'0': {'precision': 0.5332549722438814, 'recall': 0.34368155770903963, 'f1-score': 0.41797756908748424, 'support': 133324}, '1': {'precision': 0.5459706582226302, 'recall': 0.6014862214882857, 'f1-score': 0.5723854796888505, 'support': 145335}, '2': {'precision': 0.4694925534859344, 'recall': 0.5811198903726165, 'f1-score': 0.5193760321560376, 'support': 137192}, 'accuracy': 0.5121137138061469, 'macro avg': {'precision': 0.5162393946508154, 'recall': 0.5087625565233139, 'f1-score': 0.5032463603107907, 'support': 415851}, 'weighted avg': {'precision': 0.5166633095269014, 'recall': 0.5121137138061469, 'f1-score': 0.5053933300993624, 'support': 415851}}
[[45821 36550 50953]
 [18785 87417 39133]
 [21321 36146 79725]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9896415
{'0': {'precision': 0.5041920731707317, 'recall': 0.4181085565299834, 'f1-score': 0.4571329849263594, 'support': 37971}, '1': {'precision': 0.5580026417044737, 'recall': 0.5011863619951514, 'f1-score': 0.5280706521739131, 'support': 38774}, '2': {'precision': 0.46326522305437967, 'recall': 0.588115230590363, 'f1-score': 0.5182773420156874, 'support': 38705}, 'accuracy': 0.503005630142919, 'macro avg': {'precision': 0.5084866459765284, 'recall': 0.502470049705166, 'f1-score': 0.5011603263719867, 'support': 115450}, 'weighted avg': {'precision': 0.5085435435091805, 'recall': 0.503005630142919, 'f1-score': 0.5014563236097642, 'support': 115450}}
[[15876  7653 14442]
 [ 7410 19433 11931]
 [ 8202  7740 22763]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0052912
{'0': {'precision': 0.5249556125468534, 'recall': 0.35814266487213997, 'f1-score': 0.425794063525082, 'support': 14860}, '1': {'precision': 0.5067430025445293, 'recall': 0.5336638306424599, 'f1-score': 0.5198551244820048, 'support': 14927}, '2': {'precision': 0.46151051128990395, 'recall': 0.5797470005216484, 'f1-score': 0.5139157827808445, 'support': 15336}, 'accuracy': 0.4915231700019945, 'macro avg': {'precision': 0.49773637546042887, 'recall': 0.4905178320120827, 'f1-score': 0.48652165692931043, 'support': 45123}, 'weighted avg': {'precision': 0.49736760416130127, 'recall': 0.4915231700019945, 'f1-score': 0.4868601305731586, 'support': 45123}}
[[5322 3789 5749]
 [2336 7966 4625]
 [2480 3965 8891]]
training model: results/XRAY/W0/deepVOL_L3/h30
Epoch 1/50
451/451 - 22s - loss: 3.3316 - accuracy30: 0.3565 - val_loss: 3.3373 - val_accuracy30: 0.3481 - 22s/epoch - 48ms/step
Epoch 2/50
451/451 - 19s - loss: 3.2797 - accuracy30: 0.3748 - val_loss: 3.2863 - val_accuracy30: 0.3709 - 19s/epoch - 43ms/step
Epoch 3/50
451/451 - 19s - loss: 3.2312 - accuracy30: 0.4006 - val_loss: 3.2681 - val_accuracy30: 0.3837 - 19s/epoch - 42ms/step
Epoch 4/50
451/451 - 20s - loss: 3.1922 - accuracy30: 0.4219 - val_loss: 3.2121 - val_accuracy30: 0.4146 - 20s/epoch - 44ms/step
Epoch 5/50
451/451 - 20s - loss: 3.1541 - accuracy30: 0.4373 - val_loss: 3.1748 - val_accuracy30: 0.4339 - 20s/epoch - 43ms/step
Epoch 6/50
451/451 - 19s - loss: 3.1324 - accuracy30: 0.4507 - val_loss: 3.1639 - val_accuracy30: 0.4401 - 19s/epoch - 42ms/step
Epoch 7/50
451/451 - 19s - loss: 3.1144 - accuracy30: 0.4566 - val_loss: 3.1392 - val_accuracy30: 0.4520 - 19s/epoch - 42ms/step
Epoch 8/50
451/451 - 19s - loss: 3.0989 - accuracy30: 0.4627 - val_loss: 3.1446 - val_accuracy30: 0.4492 - 19s/epoch - 42ms/step
Epoch 9/50
451/451 - 19s - loss: 3.0858 - accuracy30: 0.4676 - val_loss: 3.1346 - val_accuracy30: 0.4518 - 19s/epoch - 43ms/step
Epoch 10/50
451/451 - 19s - loss: 3.0699 - accuracy30: 0.4743 - val_loss: 3.1128 - val_accuracy30: 0.4617 - 19s/epoch - 43ms/step
Epoch 11/50
451/451 - 19s - loss: 3.0595 - accuracy30: 0.4766 - val_loss: 3.1206 - val_accuracy30: 0.4574 - 19s/epoch - 42ms/step
Epoch 12/50
451/451 - 19s - loss: 3.0515 - accuracy30: 0.4800 - val_loss: 3.1057 - val_accuracy30: 0.4642 - 19s/epoch - 42ms/step
Epoch 13/50
451/451 - 19s - loss: 3.0451 - accuracy30: 0.4819 - val_loss: 3.1025 - val_accuracy30: 0.4616 - 19s/epoch - 43ms/step
Epoch 14/50
451/451 - 19s - loss: 3.0365 - accuracy30: 0.4851 - val_loss: 3.1176 - val_accuracy30: 0.4597 - 19s/epoch - 43ms/step
Epoch 15/50
451/451 - 19s - loss: 3.0277 - accuracy30: 0.4874 - val_loss: 3.1196 - val_accuracy30: 0.4554 - 19s/epoch - 43ms/step
Epoch 16/50
451/451 - 19s - loss: 3.0209 - accuracy30: 0.4889 - val_loss: 3.1117 - val_accuracy30: 0.4601 - 19s/epoch - 42ms/step
Epoch 17/50
451/451 - 19s - loss: 3.0154 - accuracy30: 0.4918 - val_loss: 3.1194 - val_accuracy30: 0.4604 - 19s/epoch - 43ms/step
Epoch 18/50
451/451 - 20s - loss: 3.0076 - accuracy30: 0.4938 - val_loss: 3.1207 - val_accuracy30: 0.4615 - 20s/epoch - 43ms/step
Epoch 19/50
451/451 - 20s - loss: 2.9987 - accuracy30: 0.4965 - val_loss: 3.1296 - val_accuracy30: 0.4631 - 20s/epoch - 45ms/step
Epoch 20/50
451/451 - 20s - loss: 2.9940 - accuracy30: 0.4985 - val_loss: 3.1414 - val_accuracy30: 0.4620 - 20s/epoch - 44ms/step
Epoch 21/50
451/451 - 20s - loss: 2.9885 - accuracy30: 0.4990 - val_loss: 3.1267 - val_accuracy30: 0.4641 - 20s/epoch - 43ms/step
Epoch 22/50
451/451 - 20s - loss: 2.9816 - accuracy30: 0.5027 - val_loss: 3.1652 - val_accuracy30: 0.4615 - 20s/epoch - 44ms/step
Epoch 23/50
451/451 - 19s - loss: 2.9761 - accuracy30: 0.5042 - val_loss: 3.1469 - val_accuracy30: 0.4607 - 19s/epoch - 42ms/step
testing model: results/XRAY/W0/deepVOL_L3/h30
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0150127
{'0': {'precision': 0.5072577351450995, 'recall': 0.33499052339991253, 'f1-score': 0.40350700039073994, 'support': 137180}, '1': {'precision': 0.5074451163540302, 'recall': 0.5206931262582686, 'f1-score': 0.5139837681118276, 'support': 139080}, '2': {'precision': 0.4511605230433806, 'recall': 0.5899950569879147, 'f1-score': 0.5113212349986651, 'support': 139591}, 'accuracy': 0.48269692750528437, 'macro avg': {'precision': 0.4886211248475034, 'recall': 0.4818929022153653, 'f1-score': 0.4762706678337442, 'support': 415851}, 'weighted avg': {'precision': 0.48848994342173474, 'recall': 0.48269692750528437, 'f1-score': 0.4766461912975882, 'support': 415851}}
[[45954 36838 54388]
 [20861 72418 45801]
 [23778 33455 82358]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0209408
{'0': {'precision': 0.47000141302811926, 'recall': 0.4316937053861129, 'f1-score': 0.45003382492220273, 'support': 38525}, '1': {'precision': 0.5156393890317869, 'recall': 0.4310706416416682, 'f1-score': 0.46957779063042215, 'support': 37669}, '2': {'precision': 0.45089965825338657, 'recall': 0.557927450580803, 'f1-score': 0.49873619492200844, 'support': 39256}, 'accuracy': 0.4744131658726721, 'macro avg': {'precision': 0.4788468201044309, 'recall': 0.47356393253619466, 'f1-score': 0.4727826034915444, 'support': 115450}, 'weighted avg': {'precision': 0.4783970685729027, 'recall': 0.4744131658726721, 'f1-score': 0.4729706969964798, 'support': 115450}}
[[16631  7896 13998]
 [ 8757 16238 12674]
 [ 9997  7357 21902]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0345936
{'0': {'precision': 0.48162126681982276, 'recall': 0.3835849179899366, 'f1-score': 0.4270488523516787, 'support': 15303}, '1': {'precision': 0.47177735070111754, 'recall': 0.4552823189998626, 'f1-score': 0.46338308805537104, 'support': 14558}, '2': {'precision': 0.4417028486709732, 'recall': 0.5465862927532433, 'f1-score': 0.4885791261567295, 'support': 15262}, 'accuracy': 0.46184872459721205, 'macro avg': {'precision': 0.46503382206397115, 'recall': 0.46181784324768077, 'f1-score': 0.45967035552125973, 'support': 45123}, 'weighted avg': {'precision': 0.46494368269102254, 'recall': 0.46184872459721205, 'f1-score': 0.4595827894167462, 'support': 45123}}
[[5870 3825 5608]
 [2994 6628 4936]
 [3324 3596 8342]]
training model: results/XRAY/W0/deepVOL_L3/h50
Epoch 1/50
451/451 - 22s - loss: 3.3457 - accuracy50: 0.3473 - val_loss: 3.3316 - val_accuracy50: 0.3400 - 22s/epoch - 49ms/step
Epoch 2/50
451/451 - 20s - loss: 3.3023 - accuracy50: 0.3541 - val_loss: 3.3174 - val_accuracy50: 0.3407 - 20s/epoch - 43ms/step
Epoch 3/50
451/451 - 19s - loss: 3.2863 - accuracy50: 0.3619 - val_loss: 3.3062 - val_accuracy50: 0.3498 - 19s/epoch - 43ms/step
Epoch 4/50
451/451 - 20s - loss: 3.2694 - accuracy50: 0.3768 - val_loss: 3.2784 - val_accuracy50: 0.3759 - 20s/epoch - 44ms/step
Epoch 5/50
451/451 - 19s - loss: 3.2449 - accuracy50: 0.3915 - val_loss: 3.2509 - val_accuracy50: 0.3927 - 19s/epoch - 43ms/step
Epoch 6/50
451/451 - 19s - loss: 3.2296 - accuracy50: 0.4011 - val_loss: 3.2427 - val_accuracy50: 0.3972 - 19s/epoch - 43ms/step
Epoch 7/50
451/451 - 19s - loss: 3.2156 - accuracy50: 0.4105 - val_loss: 3.2334 - val_accuracy50: 0.3985 - 19s/epoch - 43ms/step
Epoch 8/50
451/451 - 19s - loss: 3.2104 - accuracy50: 0.4117 - val_loss: 3.2369 - val_accuracy50: 0.4035 - 19s/epoch - 43ms/step
Epoch 9/50
451/451 - 19s - loss: 3.2012 - accuracy50: 0.4166 - val_loss: 3.2295 - val_accuracy50: 0.4047 - 19s/epoch - 43ms/step
Epoch 10/50
451/451 - 19s - loss: 3.1953 - accuracy50: 0.4208 - val_loss: 3.2272 - val_accuracy50: 0.4064 - 19s/epoch - 43ms/step
Epoch 11/50
451/451 - 19s - loss: 3.1879 - accuracy50: 0.4249 - val_loss: 3.2258 - val_accuracy50: 0.4095 - 19s/epoch - 43ms/step
Epoch 12/50
451/451 - 19s - loss: 3.1806 - accuracy50: 0.4268 - val_loss: 3.2254 - val_accuracy50: 0.4109 - 19s/epoch - 43ms/step
Epoch 13/50
451/451 - 20s - loss: 3.1735 - accuracy50: 0.4313 - val_loss: 3.2299 - val_accuracy50: 0.4111 - 20s/epoch - 44ms/step
Epoch 14/50
451/451 - 20s - loss: 3.1658 - accuracy50: 0.4354 - val_loss: 3.2265 - val_accuracy50: 0.4107 - 20s/epoch - 44ms/step
Epoch 15/50
451/451 - 21s - loss: 3.1592 - accuracy50: 0.4380 - val_loss: 3.2197 - val_accuracy50: 0.4193 - 21s/epoch - 46ms/step
Epoch 16/50
451/451 - 19s - loss: 3.1566 - accuracy50: 0.4393 - val_loss: 3.2259 - val_accuracy50: 0.4137 - 19s/epoch - 43ms/step
Epoch 17/50
451/451 - 19s - loss: 3.1505 - accuracy50: 0.4433 - val_loss: 3.2307 - val_accuracy50: 0.4121 - 19s/epoch - 43ms/step
Epoch 18/50
451/451 - 19s - loss: 3.1472 - accuracy50: 0.4437 - val_loss: 3.2294 - val_accuracy50: 0.4132 - 19s/epoch - 42ms/step
Epoch 19/50
451/451 - 20s - loss: 3.1427 - accuracy50: 0.4462 - val_loss: 3.2289 - val_accuracy50: 0.4127 - 20s/epoch - 44ms/step
Epoch 20/50
451/451 - 20s - loss: 3.1354 - accuracy50: 0.4483 - val_loss: 3.2308 - val_accuracy50: 0.4140 - 20s/epoch - 44ms/step
Epoch 21/50
451/451 - 20s - loss: 3.1305 - accuracy50: 0.4502 - val_loss: 3.2356 - val_accuracy50: 0.4153 - 20s/epoch - 44ms/step
Epoch 22/50
451/451 - 19s - loss: 3.1239 - accuracy50: 0.4542 - val_loss: 3.2435 - val_accuracy50: 0.4122 - 19s/epoch - 43ms/step
Epoch 23/50
451/451 - 19s - loss: 3.1189 - accuracy50: 0.4549 - val_loss: 3.2446 - val_accuracy50: 0.4129 - 19s/epoch - 43ms/step
Epoch 24/50
451/451 - 19s - loss: 3.1150 - accuracy50: 0.4573 - val_loss: 3.2557 - val_accuracy50: 0.4142 - 19s/epoch - 43ms/step
Epoch 25/50
451/451 - 19s - loss: 3.1102 - accuracy50: 0.4586 - val_loss: 3.2576 - val_accuracy50: 0.4120 - 19s/epoch - 43ms/step
testing model: results/XRAY/W0/deepVOL_L3/h50
Evaluating performance on  test set...
1625/1625 - 32s - 32s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0601702
{'0': {'precision': 0.4270720726884604, 'recall': 0.4588120281961381, 'f1-score': 0.44237345192324723, 'support': 136047}, '1': {'precision': 0.46526020580296895, 'recall': 0.31369914624696993, 'f1-score': 0.3747351616204075, 'support': 140673}, '2': {'precision': 0.4192627756012468, 'recall': 0.526884734530766, 'f1-score': 0.4669528881188371, 'support': 139131}, 'accuracy': 0.4324986593755937, 'macro avg': {'precision': 0.4371983513642254, 'recall': 0.433131969657958, 'f1-score': 0.42802050055416396, 'support': 415851}, 'weighted avg': {'precision': 0.43737750404867387, 'recall': 0.4324986593755937, 'f1-score': 0.4277164722010805, 'support': 415851}}
[[62420 25574 48053]
 [43058 44129 53486]
 [40680 25145 73306]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603935
{'0': {'precision': 0.41352064982968173, 'recall': 0.5357777081374699, 'f1-score': 0.4667766338661054, 'support': 38292}, '1': {'precision': 0.47542419266557195, 'recall': 0.2290249433106576, 'f1-score': 0.3091323225852374, 'support': 37926}, '2': {'precision': 0.4214686652511195, 'recall': 0.5110114192495921, 'f1-score': 0.46194080576965174, 'support': 39232}, 'accuracy': 0.42659159809441316, 'macro avg': {'precision': 0.4368045025821244, 'recall': 0.4252713568992399, 'f1-score': 0.4126165874069982, 'support': 115450}, 'weighted avg': {'precision': 0.43655720510562646, 'recall': 0.42659159809441316, 'f1-score': 0.4133462539828809, 'support': 115450}}
[[20516  4798 12978]
 [14699  8686 14541]
 [14398  4786 20048]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721782
{'0': {'precision': 0.41832229580573954, 'recall': 0.47225865687303253, 'f1-score': 0.44365719918674146, 'support': 15248}, '1': {'precision': 0.43394706559263524, 'recall': 0.25358079483558604, 'f1-score': 0.32010525869020834, 'support': 14871}, '2': {'precision': 0.40855403506946253, 'recall': 0.523327112769928, 'f1-score': 0.45887268795839053, 'support': 15004}, 'accuracy': 0.4171708441371363, 'macro avg': {'precision': 0.4202744654892791, 'recall': 0.41638885482618226, 'f1-score': 0.40754504861178004, 'support': 45123}, 'weighted avg': {'precision': 0.42022360926924657, 'recall': 0.4171708441371363, 'f1-score': 0.407998051665652, 'support': 45123}}
[[7201 2542 5505]
 [5238 3771 5862]
 [4775 2377 7852]]
training model: results/XRAY/W0/deepVOL_L3/h100
Epoch 1/50
451/451 - 23s - loss: 3.3311 - accuracy100: 0.3502 - val_loss: 3.3384 - val_accuracy100: 0.3345 - 23s/epoch - 51ms/step
Epoch 2/50
451/451 - 21s - loss: 3.3003 - accuracy100: 0.3516 - val_loss: 3.3308 - val_accuracy100: 0.3330 - 21s/epoch - 47ms/step
Epoch 3/50
451/451 - 20s - loss: 3.2942 - accuracy100: 0.3531 - val_loss: 3.3148 - val_accuracy100: 0.3393 - 20s/epoch - 43ms/step
Epoch 4/50
451/451 - 21s - loss: 3.2868 - accuracy100: 0.3589 - val_loss: 3.3050 - val_accuracy100: 0.3427 - 21s/epoch - 46ms/step
Epoch 5/50
451/451 - 21s - loss: 3.2782 - accuracy100: 0.3688 - val_loss: 3.2993 - val_accuracy100: 0.3498 - 21s/epoch - 46ms/step
Epoch 6/50
451/451 - 19s - loss: 3.2709 - accuracy100: 0.3751 - val_loss: 3.3062 - val_accuracy100: 0.3483 - 19s/epoch - 43ms/step
Epoch 7/50
451/451 - 21s - loss: 3.2657 - accuracy100: 0.3784 - val_loss: 3.3015 - val_accuracy100: 0.3537 - 21s/epoch - 46ms/step
Epoch 8/50
451/451 - 21s - loss: 3.2578 - accuracy100: 0.3831 - val_loss: 3.3004 - val_accuracy100: 0.3564 - 21s/epoch - 46ms/step
Epoch 9/50
451/451 - 19s - loss: 3.2519 - accuracy100: 0.3868 - val_loss: 3.2917 - val_accuracy100: 0.3612 - 19s/epoch - 43ms/step
Epoch 10/50
451/451 - 21s - loss: 3.2457 - accuracy100: 0.3899 - val_loss: 3.2921 - val_accuracy100: 0.3653 - 21s/epoch - 46ms/step
Epoch 11/50
451/451 - 21s - loss: 3.2384 - accuracy100: 0.3963 - val_loss: 3.2898 - val_accuracy100: 0.3654 - 21s/epoch - 46ms/step
Epoch 12/50
451/451 - 21s - loss: 3.2312 - accuracy100: 0.4002 - val_loss: 3.2937 - val_accuracy100: 0.3687 - 21s/epoch - 46ms/step
Epoch 13/50
451/451 - 21s - loss: 3.2284 - accuracy100: 0.4009 - val_loss: 3.2926 - val_accuracy100: 0.3653 - 21s/epoch - 46ms/step
Epoch 14/50
451/451 - 21s - loss: 3.2231 - accuracy100: 0.4049 - val_loss: 3.2917 - val_accuracy100: 0.3713 - 21s/epoch - 46ms/step
Epoch 15/50
451/451 - 19s - loss: 3.2186 - accuracy100: 0.4094 - val_loss: 3.2911 - val_accuracy100: 0.3694 - 19s/epoch - 43ms/step
Epoch 16/50
451/451 - 21s - loss: 3.2099 - accuracy100: 0.4125 - val_loss: 3.2969 - val_accuracy100: 0.3653 - 21s/epoch - 46ms/step
Epoch 17/50
451/451 - 20s - loss: 3.2031 - accuracy100: 0.4162 - val_loss: 3.2999 - val_accuracy100: 0.3669 - 20s/epoch - 45ms/step
Epoch 18/50
451/451 - 20s - loss: 3.1955 - accuracy100: 0.4190 - val_loss: 3.3128 - val_accuracy100: 0.3635 - 20s/epoch - 43ms/step
Epoch 19/50
451/451 - 20s - loss: 3.1910 - accuracy100: 0.4233 - val_loss: 3.3132 - val_accuracy100: 0.3663 - 20s/epoch - 45ms/step
Epoch 20/50
451/451 - 20s - loss: 3.1835 - accuracy100: 0.4260 - val_loss: 3.3124 - val_accuracy100: 0.3655 - 20s/epoch - 45ms/step
Epoch 21/50
451/451 - 19s - loss: 3.1790 - accuracy100: 0.4282 - val_loss: 3.3171 - val_accuracy100: 0.3616 - 19s/epoch - 42ms/step
testing model: results/XRAY/W0/deepVOL_L3/h100
Evaluating performance on  test set...
1625/1625 - 34s - 34s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933241
{'0': {'precision': 0.37844109944857246, 'recall': 0.26005281522717133, 'f1-score': 0.30827129608352377, 'support': 136703}, '1': {'precision': 0.39195874851926693, 'recall': 0.1225018692877832, 'f1-score': 0.18666415937524197, 'support': 137753}, '2': {'precision': 0.36378110880011477, 'recall': 0.717451112132678, 'f1-score': 0.482773554151646, 'support': 141395}, 'accuracy': 0.37000993144179045, 'macro avg': {'precision': 0.3780603189226514, 'recall': 0.3666685988825442, 'f1-score': 0.3259030032034706, 'support': 415851}, 'weighted avg': {'precision': 0.3779343009430902, 'recall': 0.37000993144179045, 'f1-score': 0.32732138584299586, 'support': 415851}}
[[ 35550  12988  88165]
 [ 31627  16875  89251]
 [ 26761  13190 101444]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0874228
{'0': {'precision': 0.39961464354527937, 'recall': 0.29969523409174503, 'f1-score': 0.3425165523143213, 'support': 38062}, '1': {'precision': 0.4442271880819367, 'recall': 0.1252230971128609, 'f1-score': 0.19537264537264537, 'support': 38100}, '2': {'precision': 0.3680824525700781, 'recall': 0.7135766646304215, 'f1-score': 0.4856521701471594, 'support': 39288}, 'accuracy': 0.3829623213512343, 'macro avg': {'precision': 0.40397476139909805, 'recall': 0.37949833194500915, 'f1-score': 0.3411804559447087, 'support': 115450}, 'weighted avg': {'precision': 0.40360685859779505, 'recall': 0.3829623213512343, 'f1-score': 0.3426666545138769, 'support': 115450}}
[[11407  2937 23718]
 [ 8917  4771 24412]
 [ 8221  3032 28035]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0954349
{'0': {'precision': 0.3910095662672982, 'recall': 0.2764825638668155, 'f1-score': 0.3239209048241902, 'support': 15227}, '1': {'precision': 0.3862129916040654, 'recall': 0.11690743713215623, 'f1-score': 0.17948454666803573, 'support': 14952}, '2': {'precision': 0.3531679517264499, 'recall': 0.7049652034261242, 'f1-score': 0.47058560771876534, 'support': 14944}, 'accuracy': 0.36551204485517363, 'macro avg': {'precision': 0.3767968365326045, 'recall': 0.366118401475032, 'f1-score': 0.3246636864036638, 'support': 45123}, 'weighted avg': {'precision': 0.37688764458516066, 'recall': 0.36551204485517363, 'f1-score': 0.3246332885953426, 'support': 45123}}
[[ 4210  1404  9613]
 [ 3522  1748  9682]
 [ 3035  1374 10535]]
training model: results/XRAY/W0/deepVOL_L3/h200
Epoch 1/50
451/451 - 22s - loss: 3.3258 - accuracy200: 0.3578 - val_loss: 3.3484 - val_accuracy200: 0.3295 - 22s/epoch - 48ms/step
Epoch 2/50
451/451 - 21s - loss: 3.3021 - accuracy200: 0.3622 - val_loss: 3.3388 - val_accuracy200: 0.3257 - 21s/epoch - 46ms/step
Epoch 3/50
451/451 - 21s - loss: 3.2938 - accuracy200: 0.3646 - val_loss: 3.3275 - val_accuracy200: 0.3238 - 21s/epoch - 47ms/step
Epoch 4/50
451/451 - 21s - loss: 3.2941 - accuracy200: 0.3558 - val_loss: 3.3116 - val_accuracy200: 0.3288 - 21s/epoch - 46ms/step
Epoch 5/50
451/451 - 19s - loss: 3.2893 - accuracy200: 0.3558 - val_loss: 3.3068 - val_accuracy200: 0.3387 - 19s/epoch - 42ms/step
Epoch 6/50
451/451 - 21s - loss: 3.2857 - accuracy200: 0.3587 - val_loss: 3.3026 - val_accuracy200: 0.3443 - 21s/epoch - 46ms/step
Epoch 7/50
451/451 - 20s - loss: 3.2805 - accuracy200: 0.3655 - val_loss: 3.3168 - val_accuracy200: 0.3295 - 20s/epoch - 45ms/step
Epoch 8/50
451/451 - 19s - loss: 3.2785 - accuracy200: 0.3660 - val_loss: 3.3110 - val_accuracy200: 0.3338 - 19s/epoch - 43ms/step
Epoch 9/50
451/451 - 20s - loss: 3.2765 - accuracy200: 0.3690 - val_loss: 3.2999 - val_accuracy200: 0.3521 - 20s/epoch - 45ms/step
Epoch 10/50
451/451 - 19s - loss: 3.2705 - accuracy200: 0.3768 - val_loss: 3.3132 - val_accuracy200: 0.3381 - 19s/epoch - 43ms/step
Epoch 11/50
451/451 - 20s - loss: 3.2679 - accuracy200: 0.3779 - val_loss: 3.3109 - val_accuracy200: 0.3427 - 20s/epoch - 45ms/step
Epoch 12/50
451/451 - 21s - loss: 3.2633 - accuracy200: 0.3831 - val_loss: 3.3089 - val_accuracy200: 0.3454 - 21s/epoch - 46ms/step
Epoch 13/50
451/451 - 20s - loss: 3.2585 - accuracy200: 0.3870 - val_loss: 3.3095 - val_accuracy200: 0.3535 - 20s/epoch - 44ms/step
Epoch 14/50
451/451 - 19s - loss: 3.2494 - accuracy200: 0.3927 - val_loss: 3.3180 - val_accuracy200: 0.3503 - 19s/epoch - 42ms/step
Epoch 15/50
451/451 - 19s - loss: 3.2449 - accuracy200: 0.3948 - val_loss: 3.3278 - val_accuracy200: 0.3464 - 19s/epoch - 43ms/step
Epoch 16/50
451/451 - 21s - loss: 3.2360 - accuracy200: 0.4031 - val_loss: 3.3279 - val_accuracy200: 0.3523 - 21s/epoch - 46ms/step
Epoch 17/50
451/451 - 21s - loss: 3.2341 - accuracy200: 0.4059 - val_loss: 3.3186 - val_accuracy200: 0.3545 - 21s/epoch - 46ms/step
Epoch 18/50
451/451 - 20s - loss: 3.2265 - accuracy200: 0.4077 - val_loss: 3.3379 - val_accuracy200: 0.3506 - 20s/epoch - 45ms/step
Epoch 19/50
451/451 - 21s - loss: 3.2172 - accuracy200: 0.4130 - val_loss: 3.3426 - val_accuracy200: 0.3502 - 21s/epoch - 46ms/step
testing model: results/XRAY/W0/deepVOL_L3/h200
Evaluating performance on  test set...
1625/1625 - 34s - 34s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949149
{'0': {'precision': 0.24984653930472908, 'recall': 0.18917534574014, 'f1-score': 0.21531867574264105, 'support': 105426}, '1': {'precision': 0.5257193719940461, 'recall': 0.3599467390469362, 'f1-score': 0.4273189890502739, 'support': 195265}, '2': {'precision': 0.2976083980368996, 'recall': 0.5228898923237235, 'f1-score': 0.3793217488259584, 'support': 115160}, 'accuracy': 0.3617762131147935, 'macro avg': {'precision': 0.3577247697785582, 'recall': 0.3573373257035999, 'f1-score': 0.3406531378729578, 'support': 415851}, 'weighted avg': {'precision': 0.3926105685524073, 'recall': 0.3617762131147935, 'f1-score': 0.3602812586732814, 'support': 415851}}
[[19944 31192 54290]
 [37153 70285 87827]
 [22728 32216 60216]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903205
{'0': {'precision': 0.37337936017340345, 'recall': 0.24583102090435793, 'f1-score': 0.2964686384497705, 'support': 37839}, '1': {'precision': 0.39344086021505376, 'recall': 0.2884812488502273, 'f1-score': 0.33288350441994813, 'support': 38051}, '2': {'precision': 0.3659179079457828, 'recall': 0.5793731041456016, 'f1-score': 0.4485454563245496, 'support': 39560}, 'accuracy': 0.3741792983975747, 'macro avg': {'precision': 0.3775793761114133, 'recall': 0.37122845796672893, 'f1-score': 0.35929919973142277, 'support': 115450}, 'weighted avg': {'precision': 0.3774346662622745, 'recall': 0.3741792983975747, 'f1-score': 0.3605810765628713, 'support': 115450}}
[[ 9302  8374 20163]
 [ 7520 10977 19554]
 [ 8091  8549 22920]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984681
{'0': {'precision': 0.3450464747222852, 'recall': 0.2062330623306233, 'f1-score': 0.25816300568230005, 'support': 14760}, '1': {'precision': 0.38843700159489636, 'recall': 0.30535356068204617, 'f1-score': 0.3419205390986944, 'support': 15952}, '2': {'precision': 0.3335718193678717, 'recall': 0.5499965304281451, 'f1-score': 0.41527821439798807, 'support': 14411}, 'accuracy': 0.3510626509762205, 'macro avg': {'precision': 0.3556850985616844, 'recall': 0.35386105114693817, 'f1-score': 0.3384539197263275, 'support': 45123}, 'weighted avg': {'precision': 0.3567213284855421, 'recall': 0.3510626509762205, 'f1-score': 0.33795130534899115, 'support': 45123}}
[[3044 3981 7735]
 [2981 4871 8100]
 [2797 3688 7926]]
training model: results/XRAY/W0/deepVOL_L3/h300
Epoch 1/50
451/451 - 22s - loss: 3.3256 - accuracy300: 0.3640 - val_loss: 3.3416 - val_accuracy300: 0.3283 - 22s/epoch - 50ms/step
Epoch 2/50
451/451 - 19s - loss: 3.3120 - accuracy300: 0.3475 - val_loss: 3.3249 - val_accuracy300: 0.3274 - 19s/epoch - 43ms/step
Epoch 3/50
451/451 - 20s - loss: 3.3062 - accuracy300: 0.3466 - val_loss: 3.3212 - val_accuracy300: 0.3278 - 20s/epoch - 44ms/step
Epoch 4/50
451/451 - 22s - loss: 3.3021 - accuracy300: 0.3462 - val_loss: 3.3200 - val_accuracy300: 0.3292 - 22s/epoch - 49ms/step
Epoch 5/50
451/451 - 19s - loss: 3.2998 - accuracy300: 0.3443 - val_loss: 3.3128 - val_accuracy300: 0.3343 - 19s/epoch - 43ms/step
Epoch 6/50
451/451 - 20s - loss: 3.2947 - accuracy300: 0.3527 - val_loss: 3.3122 - val_accuracy300: 0.3427 - 20s/epoch - 44ms/step
Epoch 7/50
451/451 - 20s - loss: 3.2918 - accuracy300: 0.3575 - val_loss: 3.3150 - val_accuracy300: 0.3414 - 20s/epoch - 45ms/step
Epoch 8/50
451/451 - 21s - loss: 3.2894 - accuracy300: 0.3584 - val_loss: 3.3173 - val_accuracy300: 0.3483 - 21s/epoch - 46ms/step
Epoch 9/50
451/451 - 19s - loss: 3.2852 - accuracy300: 0.3640 - val_loss: 3.3226 - val_accuracy300: 0.3504 - 19s/epoch - 42ms/step
Epoch 10/50
451/451 - 19s - loss: 3.2827 - accuracy300: 0.3680 - val_loss: 3.3172 - val_accuracy300: 0.3516 - 19s/epoch - 42ms/step
Epoch 11/50
451/451 - 19s - loss: 3.2801 - accuracy300: 0.3698 - val_loss: 3.3269 - val_accuracy300: 0.3517 - 19s/epoch - 43ms/step
Epoch 12/50
451/451 - 20s - loss: 3.2746 - accuracy300: 0.3748 - val_loss: 3.3355 - val_accuracy300: 0.3466 - 20s/epoch - 43ms/step
Epoch 13/50
451/451 - 19s - loss: 3.2691 - accuracy300: 0.3787 - val_loss: 3.3446 - val_accuracy300: 0.3479 - 19s/epoch - 42ms/step
Epoch 14/50
451/451 - 19s - loss: 3.2634 - accuracy300: 0.3820 - val_loss: 3.3547 - val_accuracy300: 0.3463 - 19s/epoch - 42ms/step
Epoch 15/50
451/451 - 19s - loss: 3.2612 - accuracy300: 0.3847 - val_loss: 3.3443 - val_accuracy300: 0.3489 - 19s/epoch - 42ms/step
Epoch 16/50
451/451 - 20s - loss: 3.2546 - accuracy300: 0.3919 - val_loss: 3.3551 - val_accuracy300: 0.3485 - 20s/epoch - 43ms/step
testing model: results/XRAY/W0/deepVOL_L3/h300
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0827127
{'0': {'precision': 0.3031015037593985, 'recall': 0.00553881031506814, 'f1-score': 0.010878823400433465, 'support': 116451}, '1': {'precision': 0.4414479598324892, 'recall': 0.8050885701392102, 'f1-score': 0.5702275035300877, 'support': 175059}, '2': {'precision': 0.341393182299386, 'recall': 0.25935130005388407, 'f1-score': 0.2947701335917112, 'support': 124341}, 'accuracy': 0.418012701664779, 'macro avg': {'precision': 0.36198088196375783, 'recall': 0.35665956016938744, 'f1-score': 0.2919588201740774, 'support': 415851}, 'weighted avg': {'precision': 0.37278996875056064, 'recall': 0.418012701664779, 'f1-score': 0.3312299828188569, 'support': 415851}}
[[   645  86954  28852]
 [   761 140938  33360]
 [   722  91371  32248]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965056
{'0': {'precision': 0.3720430107526882, 'recall': 0.009235286267182704, 'f1-score': 0.018023180101575723, 'support': 37465}, '1': {'precision': 0.35166305133767173, 'recall': 0.7638405360835536, 'f1-score': 0.4816022049297344, 'support': 38203}, '2': {'precision': 0.38484464172479393, 'recall': 0.30511286511487606, 'f1-score': 0.34037183477748806, 'support': 39782}, 'accuracy': 0.3608921611087051, 'macro avg': {'precision': 0.36951690127171793, 'recall': 0.35939622915520414, 'f1-score': 0.2799990732695994, 'support': 115450}, 'weighted avg': {'precision': 0.3697103896509163, 'recall': 0.3608921611087051, 'f1-score': 0.2824994353274509, 'support': 115450}}
[[  346 26490 10629]
 [  249 29181  8773]
 [  335 27309 12138]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102258
{'0': {'precision': 0.3333333333333333, 'recall': 0.00672834314550042, 'f1-score': 0.013190436933223412, 'support': 15457}, '1': {'precision': 0.341116207040324, 'recall': 0.7747564935064936, 'f1-score': 0.47367768082378725, 'support': 14784}, '2': {'precision': 0.34817056885961006, 'recall': 0.2628006988308023, 'f1-score': 0.29952134788435764, 'support': 14882}, 'accuracy': 0.342818518272278, 'macro avg': {'precision': 0.34087336974442245, 'recall': 0.3480951784942654, 'f1-score': 0.26212982188045614, 'support': 45123}, 'weighted avg': {'precision': 0.3407767600555415, 'recall': 0.342818518272278, 'f1-score': 0.25849815207744864, 'support': 45123}}
[[  104 11259  4094]
 [  102 11454  3228]
 [  106 10865  3911]]
training model: results/XRAY/W0/deepVOL_L3/h500
Epoch 1/50
451/451 - 22s - loss: 3.3405 - accuracy500: 0.3573 - val_loss: 3.3842 - val_accuracy500: 0.3302 - 22s/epoch - 49ms/step
Epoch 2/50
451/451 - 20s - loss: 3.3124 - accuracy500: 0.3515 - val_loss: 3.3254 - val_accuracy500: 0.3318 - 20s/epoch - 44ms/step
Epoch 3/50
451/451 - 20s - loss: 3.2984 - accuracy500: 0.3508 - val_loss: 3.3222 - val_accuracy500: 0.3363 - 20s/epoch - 44ms/step
Epoch 4/50
451/451 - 19s - loss: 3.2898 - accuracy500: 0.3552 - val_loss: 3.3164 - val_accuracy500: 0.3406 - 19s/epoch - 42ms/step
Epoch 5/50
451/451 - 20s - loss: 3.2831 - accuracy500: 0.3601 - val_loss: 3.3076 - val_accuracy500: 0.3616 - 20s/epoch - 44ms/step
Epoch 6/50
451/451 - 19s - loss: 3.2747 - accuracy500: 0.3650 - val_loss: 3.2949 - val_accuracy500: 0.3685 - 19s/epoch - 43ms/step
Epoch 7/50
451/451 - 20s - loss: 3.2676 - accuracy500: 0.3753 - val_loss: 3.2913 - val_accuracy500: 0.3676 - 20s/epoch - 44ms/step
Epoch 8/50
451/451 - 20s - loss: 3.2631 - accuracy500: 0.3785 - val_loss: 3.2927 - val_accuracy500: 0.3665 - 20s/epoch - 45ms/step
Epoch 9/50
451/451 - 19s - loss: 3.2593 - accuracy500: 0.3843 - val_loss: 3.2969 - val_accuracy500: 0.3654 - 19s/epoch - 43ms/step
Epoch 10/50
451/451 - 20s - loss: 3.2549 - accuracy500: 0.3926 - val_loss: 3.3158 - val_accuracy500: 0.3626 - 20s/epoch - 44ms/step
Epoch 11/50
451/451 - 19s - loss: 3.2564 - accuracy500: 0.3891 - val_loss: 3.3152 - val_accuracy500: 0.3560 - 19s/epoch - 43ms/step
Epoch 12/50
451/451 - 20s - loss: 3.2539 - accuracy500: 0.3889 - val_loss: 3.3046 - val_accuracy500: 0.3639 - 20s/epoch - 43ms/step
Epoch 13/50
451/451 - 21s - loss: 3.2518 - accuracy500: 0.3902 - val_loss: 3.3151 - val_accuracy500: 0.3604 - 21s/epoch - 46ms/step
Epoch 14/50
451/451 - 21s - loss: 3.2458 - accuracy500: 0.3951 - val_loss: 3.3145 - val_accuracy500: 0.3615 - 21s/epoch - 47ms/step
Epoch 15/50
451/451 - 20s - loss: 3.2391 - accuracy500: 0.4000 - val_loss: 3.3245 - val_accuracy500: 0.3580 - 20s/epoch - 44ms/step
Epoch 16/50
451/451 - 19s - loss: 3.2338 - accuracy500: 0.4041 - val_loss: 3.3231 - val_accuracy500: 0.3623 - 19s/epoch - 43ms/step
Epoch 17/50
451/451 - 19s - loss: 3.2256 - accuracy500: 0.4091 - val_loss: 3.3450 - val_accuracy500: 0.3589 - 19s/epoch - 43ms/step
testing model: results/XRAY/W0/deepVOL_L3/h500
Evaluating performance on  test set...
1625/1625 - 34s - 34s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945721
{'0': {'precision': 0.3474820453274846, 'recall': 0.12741264034313107, 'f1-score': 0.18645651847834865, 'support': 126832}, '1': {'precision': 0.4235387618998255, 'recall': 0.47604313659490183, 'f1-score': 0.44825873224370133, 'support': 154486}, '2': {'precision': 0.3307120812639238, 'recall': 0.48109385801253224, 'f1-score': 0.3919743460079155, 'support': 134533}, 'accuracy': 0.3713469487869453, 'macro avg': {'precision': 0.3672442961637447, 'recall': 0.36151654498352165, 'f1-score': 0.34222986557665513, 'support': 415851}, 'weighted avg': {'precision': 0.37031133837002056, 'recall': 0.3713469487869453, 'f1-score': 0.3502019626080718, 'support': 415851}}
[[16160 48164 62508]
 [12467 73542 68477]
 [17879 51931 64723]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895305
{'0': {'precision': 0.3687165919766751, 'recall': 0.18405023717119448, 'f1-score': 0.2455370786516854, 'support': 37104}, '1': {'precision': 0.39770011154193446, 'recall': 0.39678333907421637, 'f1-score': 0.39724119636580674, 'support': 37741}, '2': {'precision': 0.36890763390974274, 'recall': 0.5385297377170299, 'f1-score': 0.4378654385262315, 'support': 40605}, 'accuracy': 0.3782676483326115, 'macro avg': {'precision': 0.37844144580945077, 'recall': 0.37312110465414694, 'f1-score': 0.3602145711812412, 'support': 115450}, 'weighted avg': {'precision': 0.3782585951781014, 'recall': 0.3782676483326115, 'f1-score': 0.3627736153286416, 'support': 115450}}
[[ 6829 11046 19229]
 [ 4587 14975 18179]
 [ 7105 11633 21867]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933113
{'0': {'precision': 0.41668228678537955, 'recall': 0.1467714247986267, 'f1-score': 0.21707924417753038, 'support': 15146}, '1': {'precision': 0.38167496814548824, 'recall': 0.4377574066693238, 'f1-score': 0.4077970297029703, 'support': 15054}, '2': {'precision': 0.34734925850279724, 'recall': 0.5242243516719158, 'f1-score': 0.41783949793029773, 'support': 14923}, 'accuracy': 0.36868116038383975, 'macro avg': {'precision': 0.381902171144555, 'recall': 0.36958439437995544, 'f1-score': 0.3475719239369328, 'support': 45123}, 'weighted avg': {'precision': 0.382073396510666, 'recall': 0.36868116038383975, 'f1-score': 0.3471018670096231, 'support': 45123}}
[[2223 5447 7476]
 [1241 6590 7223]
 [1871 5229 7823]]
training model: results/XRAY/W0/deepVOL_L3/h1000
Epoch 1/50
451/451 - 22s - loss: 3.3375 - accuracy1000: 0.3610 - val_loss: 3.4222 - val_accuracy1000: 0.3350 - 22s/epoch - 49ms/step
Epoch 2/50
451/451 - 20s - loss: 3.3134 - accuracy1000: 0.3569 - val_loss: 3.3675 - val_accuracy1000: 0.3316 - 20s/epoch - 43ms/step
Epoch 3/50
451/451 - 20s - loss: 3.2992 - accuracy1000: 0.3505 - val_loss: 3.3495 - val_accuracy1000: 0.3444 - 20s/epoch - 43ms/step
Epoch 4/50
451/451 - 19s - loss: 3.2875 - accuracy1000: 0.3589 - val_loss: 3.3615 - val_accuracy1000: 0.3368 - 19s/epoch - 43ms/step
Epoch 5/50
451/451 - 20s - loss: 3.2807 - accuracy1000: 0.3633 - val_loss: 3.3422 - val_accuracy1000: 0.3419 - 20s/epoch - 45ms/step
Epoch 6/50
451/451 - 19s - loss: 3.2746 - accuracy1000: 0.3689 - val_loss: 3.3330 - val_accuracy1000: 0.3461 - 19s/epoch - 43ms/step
Epoch 7/50
451/451 - 19s - loss: 3.2727 - accuracy1000: 0.3661 - val_loss: 3.3424 - val_accuracy1000: 0.3457 - 19s/epoch - 43ms/step
Epoch 8/50
451/451 - 19s - loss: 3.2659 - accuracy1000: 0.3707 - val_loss: 3.3422 - val_accuracy1000: 0.3371 - 19s/epoch - 43ms/step
Epoch 9/50
451/451 - 20s - loss: 3.2610 - accuracy1000: 0.3729 - val_loss: 3.3375 - val_accuracy1000: 0.3451 - 20s/epoch - 45ms/step
Epoch 10/50
451/451 - 20s - loss: 3.2656 - accuracy1000: 0.3722 - val_loss: 3.3400 - val_accuracy1000: 0.3465 - 20s/epoch - 43ms/step
Epoch 11/50
451/451 - 19s - loss: 3.2554 - accuracy1000: 0.3855 - val_loss: 3.3442 - val_accuracy1000: 0.3465 - 19s/epoch - 43ms/step
Epoch 12/50
451/451 - 20s - loss: 3.2563 - accuracy1000: 0.3808 - val_loss: 3.3302 - val_accuracy1000: 0.3522 - 20s/epoch - 44ms/step
Epoch 13/50
451/451 - 20s - loss: 3.2506 - accuracy1000: 0.3883 - val_loss: 3.3440 - val_accuracy1000: 0.3456 - 20s/epoch - 45ms/step
Epoch 14/50
451/451 - 20s - loss: 3.2397 - accuracy1000: 0.3938 - val_loss: 3.3494 - val_accuracy1000: 0.3449 - 20s/epoch - 45ms/step
Epoch 15/50
451/451 - 20s - loss: 3.2372 - accuracy1000: 0.3959 - val_loss: 3.3657 - val_accuracy1000: 0.3472 - 20s/epoch - 45ms/step
Epoch 16/50
451/451 - 20s - loss: 3.2361 - accuracy1000: 0.3944 - val_loss: 3.3760 - val_accuracy1000: 0.3465 - 20s/epoch - 45ms/step
Epoch 17/50
451/451 - 20s - loss: 3.2334 - accuracy1000: 0.3992 - val_loss: 3.3817 - val_accuracy1000: 0.3419 - 20s/epoch - 44ms/step
Epoch 18/50
451/451 - 21s - loss: 3.2232 - accuracy1000: 0.4069 - val_loss: 3.3647 - val_accuracy1000: 0.3504 - 21s/epoch - 46ms/step
Epoch 19/50
451/451 - 19s - loss: 3.2175 - accuracy1000: 0.4089 - val_loss: 3.3769 - val_accuracy1000: 0.3521 - 19s/epoch - 42ms/step
Epoch 20/50
451/451 - 19s - loss: 3.2203 - accuracy1000: 0.4069 - val_loss: 3.3762 - val_accuracy1000: 0.3473 - 19s/epoch - 43ms/step
Epoch 21/50
451/451 - 20s - loss: 3.2134 - accuracy1000: 0.4076 - val_loss: 3.3990 - val_accuracy1000: 0.3533 - 20s/epoch - 44ms/step
Epoch 22/50
451/451 - 20s - loss: 3.2095 - accuracy1000: 0.4115 - val_loss: 3.3960 - val_accuracy1000: 0.3500 - 20s/epoch - 43ms/step
testing model: results/XRAY/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
1625/1625 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0849553
{'0': {'precision': 0.34237086879081735, 'recall': 0.030106853224739827, 'f1-score': 0.05534671678797089, 'support': 114924}, '1': {'precision': 0.4560840042823412, 'recall': 0.6985164471098233, 'f1-score': 0.5518483521650985, 'support': 178086}, '2': {'precision': 0.33753392933675197, 'recall': 0.365439877565308, 'f1-score': 0.35093301229684415, 'support': 122841}, 'accuracy': 0.41540599878321804, 'macro avg': {'precision': 0.3786629341366368, 'recall': 0.3646877259666237, 'f1-score': 0.31937602708330454, 'support': 415851}, 'weighted avg': {'precision': 0.38963910421087566, 'recall': 0.41540599878321804, 'f1-score': 0.35528613346456095, 'support': 415851}}
[[  3460  73312  38152]
 [  3736 124396  49954]
 [  2910  75040  44891]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950412
{'0': {'precision': 0.3915986462273542, 'recall': 0.05255423746927434, 'f1-score': 0.09267155072907586, 'support': 37428}, '1': {'precision': 0.34917159671433673, 'recall': 0.6153235736762895, 'f1-score': 0.44552533037465575, 'support': 36545}, '2': {'precision': 0.38725937513579284, 'recall': 0.42973214070448684, 'f1-score': 0.4073917465686891, 'support': 41477}, 'accuracy': 0.36620181896925075, 'macro avg': {'precision': 0.3760098726924946, 'recall': 0.36586998395001685, 'f1-score': 0.31519620922414027, 'support': 115450}, 'weighted avg': {'precision': 0.3766096772233013, 'recall': 0.36620181896925075, 'f1-score': 0.31743284081125306, 'support': 115450}}
[[ 1967 20089 15372]
 [ 1228 22487 12830]
 [ 1828 21825 17824]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1064675
{'0': {'precision': 0.3576555023923445, 'recall': 0.03860555196901227, 'f1-score': 0.06968884745367673, 'support': 15490}, '1': {'precision': 0.3463565328002908, 'recall': 0.648167040739985, 'f1-score': 0.4514661992515041, 'support': 14703}, '2': {'precision': 0.3526606425702811, 'recall': 0.37642330877428, 'f1-score': 0.36415473336357157, 'support': 14930}, 'accuracy': 0.3490016178002349, 'macro avg': {'precision': 0.3522242259209722, 'recall': 0.3543986338277591, 'f1-score': 0.2951032600229175, 'support': 45123}, 'weighted avg': {'precision': 0.35232114946688803, 'recall': 0.3490016178002349, 'f1-score': 0.29151913533609114, 'support': 45123}}
[[ 598 9219 5673]
 [ 530 9530 4643]
 [ 544 8766 5620]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  13.31 (ave)

============================================
