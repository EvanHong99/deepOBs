This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-11-13.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-05.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-23.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-24.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-01.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-28.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-30.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-25.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-31.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-22.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-07.csv
data/AAL_orderbooks/AAL_orderbooks_2019-11-06.csv
training model: results/AAL/W8/deepLOB_L1/h10
Epoch 1/50
1814/1814 - 53s - loss: 2.7616 - accuracy10: 0.4657 - val_loss: 2.4901 - val_accuracy10: 0.5475 - 53s/epoch - 29ms/step
Epoch 2/50
1814/1814 - 28s - loss: 2.6050 - accuracy10: 0.5185 - val_loss: 2.4165 - val_accuracy10: 0.4969 - 28s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 27s - loss: 2.4931 - accuracy10: 0.5630 - val_loss: 2.3560 - val_accuracy10: 0.6799 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 2.4008 - accuracy10: 0.6022 - val_loss: 2.3876 - val_accuracy10: 0.7679 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 2.3439 - accuracy10: 0.6207 - val_loss: 2.3746 - val_accuracy10: 0.7823 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 26s - loss: 2.2935 - accuracy10: 0.6395 - val_loss: 2.5761 - val_accuracy10: 0.8029 - 26s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 27s - loss: 2.2575 - accuracy10: 0.6487 - val_loss: 2.4433 - val_accuracy10: 0.7934 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 2.2265 - accuracy10: 0.6557 - val_loss: 2.5344 - val_accuracy10: 0.7982 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 2.1996 - accuracy10: 0.6612 - val_loss: 2.4714 - val_accuracy10: 0.7768 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 27s - loss: 2.1814 - accuracy10: 0.6655 - val_loss: 2.5304 - val_accuracy10: 0.7874 - 27s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 2.1673 - accuracy10: 0.6672 - val_loss: 2.4769 - val_accuracy10: 0.7917 - 27s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 27s - loss: 2.1540 - accuracy10: 0.6704 - val_loss: 2.4187 - val_accuracy10: 0.7574 - 27s/epoch - 15ms/step
Epoch 13/50
1814/1814 - 27s - loss: 2.1414 - accuracy10: 0.6718 - val_loss: 2.4110 - val_accuracy10: 0.7534 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h10
Evaluating performance on  test set...
5918/5918 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6504033
{'0': {'precision': 0.3011607642275671, 'recall': 0.498683404776485, 'f1-score': 0.37553283779538454, 'support': 130640}, '1': {'precision': 0.8947729940247546, 'recall': 0.7482799005704452, 'f1-score': 0.8149958521778671, 'support': 1255160}, '2': {'precision': 0.25655667594299275, 'recall': 0.4944585474583617, 'f1-score': 0.33782708359221525, 'support': 129208}, 'accuracy': 0.7051098080010139, 'macro avg': {'precision': 0.4841634780651048, 'recall': 0.5804739509350973, 'f1-score': 0.5094519245218223, 'support': 1515008}, 'weighted avg': {'precision': 0.7891549671051523, 'recall': 0.7051098080010139, 'f1-score': 0.7364051975738368, 'support': 1515008}}
[[ 65148  54248  11244]
 [142060 939211 173889]
 [  9115  56205  63888]]
Evaluating performance on  train set...
1814/1814 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.675567
{'0': {'precision': 0.2918354930160908, 'recall': 0.46572738916663226, 'f1-score': 0.3588237634793681, 'support': 48406}, '1': {'precision': 0.8434977733481585, 'recall': 0.7970575826449093, 'f1-score': 0.8196203727417384, 'support': 367385}, '2': {'precision': 0.2880467495987159, 'recall': 0.23686272892262003, 'f1-score': 0.25995925758261657, 'support': 48488}, 'accuracy': 0.7040077194962512, 'macro avg': {'precision': 0.47446000532098836, 'recall': 0.49988256691138716, 'f1-score': 0.47946779793457434, 'support': 464279}, 'weighted avg': {'precision': 0.7279713903299366, 'recall': 0.7040077194962512, 'f1-score': 0.7131280075479868, 'support': 464279}}
[[ 22544  23753   2109]
 [ 48280 292827  26278]
 [  6425  30578  11485]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6818854
{'0': {'precision': 0.24813814011731364, 'recall': 0.5612282924647835, 'f1-score': 0.34412631675159383, 'support': 13417}, '1': {'precision': 0.9040561476863346, 'recall': 0.7122028689277915, 'f1-score': 0.7967428183668853, 'support': 136009}, '2': {'precision': 0.24851367419738407, 'recall': 0.47157039711191334, 'f1-score': 0.32549447126615794, 'support': 13296}, 'accuracy': 0.6800924275758656, 'macro avg': {'precision': 0.4669026540003441, 'recall': 0.5816671861681627, 'f1-score': 0.488787868794879, 'support': 162722}, 'weighted avg': {'precision': 0.7964090892980241, 'recall': 0.6800924275758656, 'f1-score': 0.7209173391740065, 'support': 162722}}
[[ 7530  4610  1277]
 [21460 96866 17683]
 [ 1356  5670  6270]]
training model: results/AAL/W8/deepLOB_L1/h20
Epoch 1/50
1814/1814 - 29s - loss: 2.7880 - accuracy20: 0.4885 - val_loss: 2.8672 - val_accuracy20: 0.4205 - 29s/epoch - 16ms/step
Epoch 2/50
1814/1814 - 27s - loss: 2.6636 - accuracy20: 0.5162 - val_loss: 2.8073 - val_accuracy20: 0.5002 - 27s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 27s - loss: 2.5748 - accuracy20: 0.5543 - val_loss: 2.7604 - val_accuracy20: 0.5892 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 2.4842 - accuracy20: 0.5933 - val_loss: 2.6752 - val_accuracy20: 0.5487 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 2.4431 - accuracy20: 0.6082 - val_loss: 2.5395 - val_accuracy20: 0.6498 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 2.4016 - accuracy20: 0.6219 - val_loss: 2.5854 - val_accuracy20: 0.6118 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 2.3677 - accuracy20: 0.6286 - val_loss: 2.5250 - val_accuracy20: 0.6387 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 2.3388 - accuracy20: 0.6332 - val_loss: 2.5528 - val_accuracy20: 0.6594 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 2.3147 - accuracy20: 0.6366 - val_loss: 2.5916 - val_accuracy20: 0.6426 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 27s - loss: 2.2922 - accuracy20: 0.6416 - val_loss: 2.5359 - val_accuracy20: 0.6661 - 27s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 2.2750 - accuracy20: 0.6442 - val_loss: 2.5017 - val_accuracy20: 0.6246 - 27s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 27s - loss: 2.2604 - accuracy20: 0.6470 - val_loss: 2.5292 - val_accuracy20: 0.6369 - 27s/epoch - 15ms/step
Epoch 13/50
1814/1814 - 27s - loss: 2.2456 - accuracy20: 0.6500 - val_loss: 2.4933 - val_accuracy20: 0.6731 - 27s/epoch - 15ms/step
Epoch 14/50
1814/1814 - 27s - loss: 2.2341 - accuracy20: 0.6516 - val_loss: 2.6302 - val_accuracy20: 0.6500 - 27s/epoch - 15ms/step
Epoch 15/50
1814/1814 - 27s - loss: 2.2253 - accuracy20: 0.6526 - val_loss: 2.5801 - val_accuracy20: 0.6519 - 27s/epoch - 15ms/step
Epoch 16/50
1814/1814 - 27s - loss: 2.2153 - accuracy20: 0.6536 - val_loss: 2.6133 - val_accuracy20: 0.6420 - 27s/epoch - 15ms/step
Epoch 17/50
1814/1814 - 27s - loss: 2.2061 - accuracy20: 0.6552 - val_loss: 2.5110 - val_accuracy20: 0.6746 - 27s/epoch - 15ms/step
Epoch 18/50
1814/1814 - 27s - loss: 2.1985 - accuracy20: 0.6569 - val_loss: 2.5773 - val_accuracy20: 0.6673 - 27s/epoch - 15ms/step
Epoch 19/50
1814/1814 - 27s - loss: 2.1925 - accuracy20: 0.6571 - val_loss: 2.6142 - val_accuracy20: 0.6027 - 27s/epoch - 15ms/step
Epoch 20/50
1814/1814 - 27s - loss: 2.1852 - accuracy20: 0.6583 - val_loss: 2.5951 - val_accuracy20: 0.6134 - 27s/epoch - 15ms/step
Epoch 21/50
1814/1814 - 27s - loss: 2.1788 - accuracy20: 0.6594 - val_loss: 2.6161 - val_accuracy20: 0.6048 - 27s/epoch - 15ms/step
Epoch 22/50
1814/1814 - 26s - loss: 2.1729 - accuracy20: 0.6603 - val_loss: 2.5011 - val_accuracy20: 0.6704 - 26s/epoch - 15ms/step
Epoch 23/50
1814/1814 - 27s - loss: 2.1674 - accuracy20: 0.6610 - val_loss: 2.5830 - val_accuracy20: 0.6223 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h20
Evaluating performance on  test set...
5918/5918 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70919377
{'0': {'precision': 0.3946198114476241, 'recall': 0.4761843474757423, 'f1-score': 0.4315821772085133, 'support': 178706}, '1': {'precision': 0.8561541853122577, 'recall': 0.7284300248879353, 'f1-score': 0.7871445524957331, 'support': 1159598}, '2': {'precision': 0.3093266402353242, 'recall': 0.5474975099601593, 'f1-score': 0.3953099717241717, 'support': 176704}, 'accuracy': 0.6775726596823252, 'macro avg': {'precision': 0.5200335456650688, 'recall': 0.5840372941079456, 'f1-score': 0.5380122338094727, 'support': 1515008}, 'weighted avg': {'precision': 0.7379333070455241, 'recall': 0.6775726596823252, 'f1-score': 0.699501538334266, 'support': 1515008}}
[[ 85097  77147  16462]
 [115359 844686 199553]
 [ 15187  64772  96745]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7278422
{'0': {'precision': 0.36072265477360343, 'recall': 0.4468513460788139, 'f1-score': 0.3991941386834345, 'support': 64075}, '1': {'precision': 0.7944038409482698, 'recall': 0.8293126937194734, 'f1-score': 0.8114830084830245, 'support': 336182}, '2': {'precision': 0.40524300441826216, 'recall': 0.21489487988503952, 'f1-score': 0.2808557547054261, 'support': 64022}, 'accuracy': 0.6918038507018409, 'macro avg': {'precision': 0.5201231667133784, 'recall': 0.4970196398944422, 'f1-score': 0.49717763395729503, 'support': 464279}, 'weighted avg': {'precision': 0.6808880948549381, 'recall': 0.6918038507018409, 'f1-score': 0.6814120223437459, 'support': 464279}}
[[ 28632  33072   2371]
 [ 39561 278800  17821]
 [ 11181  39083  13758]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7167905
{'0': {'precision': 0.3155204742031089, 'recall': 0.5747259406158761, 'f1-score': 0.40738788340264354, 'support': 18153}, '1': {'precision': 0.8677951676202185, 'recall': 0.724773323223707, 'f1-score': 0.7898621517750702, 'support': 126612}, '2': {'precision': 0.3124085149094559, 'recall': 0.4159937628779863, 'f1-score': 0.35683576956147894, 'support': 17957}, 'accuracy': 0.6739592679539337, 'macro avg': {'precision': 0.49857471891092775, 'recall': 0.5718310089058565, 'f1-score': 0.518028601579731, 'support': 162722}, 'weighted avg': {'precision': 0.7448952485414956, 'recall': 0.6739592679539337, 'f1-score': 0.6994078177626188, 'support': 162722}}
[[10433  6490  1230]
 [19636 91765 15211]
 [ 2997  7490  7470]]
training model: results/AAL/W8/deepLOB_L1/h30
Epoch 1/50
1814/1814 - 31s - loss: 2.8205 - accuracy30: 0.4949 - val_loss: 2.9158 - val_accuracy30: 0.3655 - 31s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 29s - loss: 2.7272 - accuracy30: 0.5239 - val_loss: 3.0117 - val_accuracy30: 0.3674 - 29s/epoch - 16ms/step
Epoch 3/50
1814/1814 - 28s - loss: 2.6399 - accuracy30: 0.5541 - val_loss: 2.8133 - val_accuracy30: 0.5126 - 28s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 2.5692 - accuracy30: 0.5819 - val_loss: 2.7067 - val_accuracy30: 0.6443 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 28s - loss: 2.5255 - accuracy30: 0.5958 - val_loss: 2.7217 - val_accuracy30: 0.6562 - 28s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 2.4887 - accuracy30: 0.6055 - val_loss: 2.8007 - val_accuracy30: 0.6713 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 2.4621 - accuracy30: 0.6114 - val_loss: 2.8358 - val_accuracy30: 0.6856 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 2.4363 - accuracy30: 0.6178 - val_loss: 2.8576 - val_accuracy30: 0.6791 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 2.4140 - accuracy30: 0.6210 - val_loss: 2.8045 - val_accuracy30: 0.6757 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 28s - loss: 2.4008 - accuracy30: 0.6214 - val_loss: 2.8324 - val_accuracy30: 0.6894 - 28s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 28s - loss: 2.3864 - accuracy30: 0.6252 - val_loss: 2.8437 - val_accuracy30: 0.6929 - 28s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 28s - loss: 2.3732 - accuracy30: 0.6271 - val_loss: 2.8692 - val_accuracy30: 0.6941 - 28s/epoch - 15ms/step
Epoch 13/50
1814/1814 - 27s - loss: 2.3621 - accuracy30: 0.6285 - val_loss: 2.9048 - val_accuracy30: 0.6834 - 27s/epoch - 15ms/step
Epoch 14/50
1814/1814 - 27s - loss: 2.3494 - accuracy30: 0.6296 - val_loss: 2.8527 - val_accuracy30: 0.6945 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h30
Evaluating performance on  test set...
5918/5918 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77816594
{'0': {'precision': 0.4388602289214896, 'recall': 0.2512158208982771, 'f1-score': 0.31952603686771175, 'support': 216726}, '1': {'precision': 0.7637282176965774, 'recall': 0.7824108523486406, 'f1-score': 0.7729566600412102, 'support': 1084521}, '2': {'precision': 0.3267166136114356, 'recall': 0.4278002067729848, 'f1-score': 0.37048726041105384, 'support': 213761}, 'accuracy': 0.6563879530669146, 'macro avg': {'precision': 0.5097683534098342, 'recall': 0.48714229333996756, 'f1-score': 0.48765665243999196, 'support': 1515008}, 'weighted avg': {'precision': 0.6555945462993876, 'recall': 0.6563879530669146, 'f1-score': 0.6513055093065333, 'support': 1515008}}
[[ 54445 145603  16678]
 [ 64208 848541 171772]
 [  5407 116907  91447]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8732286
{'0': {'precision': 0.3043764782349649, 'recall': 0.4442526615368399, 'f1-score': 0.3612471205871324, 'support': 75896}, '1': {'precision': 0.7331365832772647, 'recall': 0.7669182313477959, 'f1-score': 0.7496470212975543, 'support': 312577}, '2': {'precision': 0.3616211121583412, 'recall': 0.12653351977416036, 'f1-score': 0.18747007260751875, 'support': 75806}, 'accuracy': 0.6096118928489119, 'macro avg': {'precision': 0.4663780578901903, 'recall': 0.4459014708862654, 'f1-score': 0.4327880714974018, 'support': 464279}, 'weighted avg': {'precision': 0.6023870151599656, 'recall': 0.6096118928489119, 'f1-score': 0.5943645626106118, 'support': 464279}}
[[ 33717  40510   1669]
 [ 57592 239721  15264]
 [ 19465  46749   9592]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7934658
{'0': {'precision': 0.32842662294104497, 'recall': 0.4006637570467358, 'f1-score': 0.3609666188818349, 'support': 21996}, '1': {'precision': 0.7927936839076325, 'recall': 0.740515206746235, 'f1-score': 0.7657632226936557, 'support': 119059}, '2': {'precision': 0.32034035656401944, 'recall': 0.36488669405086077, 'f1-score': 0.3411655554836343, 'support': 21667}, 'accuracy': 0.6445594326520078, 'macro avg': {'precision': 0.48052022113756565, 'recall': 0.5020218859479438, 'f1-score': 0.48929846568637503, 'support': 162722}, 'weighted avg': {'precision': 0.6671139103270771, 'recall': 0.6445594326520078, 'f1-score': 0.6545080528156776, 'support': 162722}}
[[ 8813 11353  1830]
 [15950 88165 14944]
 [ 2071 11690  7906]]
training model: results/AAL/W8/deepLOB_L1/h50
Epoch 1/50
1814/1814 - 30s - loss: 2.9199 - accuracy50: 0.4855 - val_loss: 3.2729 - val_accuracy50: 0.4452 - 30s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 28s - loss: 2.8826 - accuracy50: 0.4889 - val_loss: 2.9983 - val_accuracy50: 0.5766 - 28s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 28s - loss: 2.8109 - accuracy50: 0.5171 - val_loss: 2.9842 - val_accuracy50: 0.5248 - 28s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 2.7470 - accuracy50: 0.5403 - val_loss: 2.9598 - val_accuracy50: 0.5823 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 2.7091 - accuracy50: 0.5553 - val_loss: 3.0348 - val_accuracy50: 0.5540 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 2.6811 - accuracy50: 0.5620 - val_loss: 2.9936 - val_accuracy50: 0.5897 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 2.6543 - accuracy50: 0.5710 - val_loss: 3.0433 - val_accuracy50: 0.5190 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 28s - loss: 2.6276 - accuracy50: 0.5789 - val_loss: 2.9845 - val_accuracy50: 0.5251 - 28s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 28s - loss: 2.6096 - accuracy50: 0.5827 - val_loss: 2.9705 - val_accuracy50: 0.5048 - 28s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 27s - loss: 2.5898 - accuracy50: 0.5868 - val_loss: 3.0490 - val_accuracy50: 0.4786 - 27s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 28s - loss: 2.5735 - accuracy50: 0.5895 - val_loss: 3.1231 - val_accuracy50: 0.4387 - 28s/epoch - 16ms/step
Epoch 12/50
1814/1814 - 28s - loss: 2.5591 - accuracy50: 0.5919 - val_loss: 3.1441 - val_accuracy50: 0.4316 - 28s/epoch - 15ms/step
Epoch 13/50
1814/1814 - 27s - loss: 2.5503 - accuracy50: 0.5931 - val_loss: 3.0846 - val_accuracy50: 0.4607 - 27s/epoch - 15ms/step
Epoch 14/50
1814/1814 - 28s - loss: 2.5378 - accuracy50: 0.5959 - val_loss: 3.3178 - val_accuracy50: 0.4129 - 28s/epoch - 16ms/step
testing model: results/AAL/W8/deepLOB_L1/h50
Evaluating performance on  test set...
5918/5918 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92765766
{'0': {'precision': 0.36484133892537784, 'recall': 0.19719564876463125, 'f1-score': 0.256015622107874, 'support': 280564}, '1': {'precision': 0.6576610400655883, 'recall': 0.8062311941695794, 'f1-score': 0.7244069382851968, 'support': 958147}, '2': {'precision': 0.36296983021216855, 'recall': 0.24797952927465736, 'f1-score': 0.29465318602680934, 'support': 276297}, 'accuracy': 0.5916338395572829, 'macro avg': {'precision': 0.4618240697343783, 'recall': 0.417135457402956, 'f1-score': 0.4250252488066267, 'support': 1515008}, 'weighted avg': {'precision': 0.5496900169161578, 'recall': 0.5916338395572829, 'f1-score': 0.5592900453580901, 'support': 1515008}}
[[ 55326 211453  13785]
 [ 79195 772488 106464]
 [ 17123 190658  68516]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0284524
{'0': {'precision': 0.28777736181877017, 'recall': 0.48114828881203453, 'f1-score': 0.3601481757939833, 'support': 94262}, '1': {'precision': 0.6498648282844618, 'recall': 0.6718884595953171, 'f1-score': 0.6606931602517594, 'support': 275129}, '2': {'precision': 0.38146231721034873, 'recall': 0.08934744119382851, 'f1-score': 0.1447832435340227, 'support': 94888}, 'accuracy': 0.5141046655136243, 'macro avg': {'precision': 0.43970150243786027, 'recall': 0.41412806320039336, 'f1-score': 0.3885415265265884, 'support': 464279}, 'weighted avg': {'precision': 0.521495321512048, 'recall': 0.5141046655136243, 'f1-score': 0.4942337005250185, 'support': 464279}}
[[ 45354  47376   1532]
 [ 78058 184856  12215]
 [ 34189  52221   8478]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94349796
{'0': {'precision': 0.2792205576220865, 'recall': 0.2879971840901091, 'f1-score': 0.2835409699721034, 'support': 28410}, '1': {'precision': 0.6847094185011671, 'recall': 0.7662307157487269, 'f1-score': 0.723179923738583, 'support': 106434}, '2': {'precision': 0.3508698386082582, 'recall': 0.18014204749264653, 'f1-score': 0.23806024981631152, 'support': 27878}, 'accuracy': 0.5823244552058111, 'macro avg': {'precision': 0.43826660491050395, 'recall': 0.4114566491104941, 'f1-score': 0.41492704784233264, 'support': 162722}, 'weighted avg': {'precision': 0.5567198513508789, 'recall': 0.5823244552058111, 'f1-score': 0.5633102752207995, 'support': 162722}}
[[ 8182 19269   959]
 [16549 81553  8332]
 [ 4572 18284  5022]]
training model: results/AAL/W8/deepLOB_L1/h100
Epoch 1/50
1814/1814 - 30s - loss: 3.0536 - accuracy100: 0.4709 - val_loss: 3.3816 - val_accuracy100: 0.4931 - 30s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 27s - loss: 3.0177 - accuracy100: 0.4773 - val_loss: 3.2860 - val_accuracy100: 0.5078 - 27s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 29s - loss: 2.9803 - accuracy100: 0.4908 - val_loss: 3.1545 - val_accuracy100: 0.4895 - 29s/epoch - 16ms/step
Epoch 4/50
1814/1814 - 27s - loss: 2.9541 - accuracy100: 0.5016 - val_loss: 3.2665 - val_accuracy100: 0.5067 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 28s - loss: 2.9261 - accuracy100: 0.5128 - val_loss: 3.2148 - val_accuracy100: 0.4586 - 28s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 28s - loss: 2.9060 - accuracy100: 0.5193 - val_loss: 3.2055 - val_accuracy100: 0.4061 - 28s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 2.8897 - accuracy100: 0.5247 - val_loss: 3.2625 - val_accuracy100: 0.3796 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 28s - loss: 2.8775 - accuracy100: 0.5278 - val_loss: 3.3011 - val_accuracy100: 0.3551 - 28s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 28s - loss: 2.8677 - accuracy100: 0.5298 - val_loss: 3.3933 - val_accuracy100: 0.3399 - 28s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 27s - loss: 2.8584 - accuracy100: 0.5316 - val_loss: 3.3826 - val_accuracy100: 0.3394 - 27s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 2.8510 - accuracy100: 0.5339 - val_loss: 3.4505 - val_accuracy100: 0.3253 - 27s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 27s - loss: 2.8422 - accuracy100: 0.5359 - val_loss: 3.5076 - val_accuracy100: 0.3155 - 27s/epoch - 15ms/step
Epoch 13/50
1814/1814 - 27s - loss: 2.8346 - accuracy100: 0.5374 - val_loss: 3.5126 - val_accuracy100: 0.3269 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h100
Evaluating performance on  test set...
5918/5918 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0203956
{'0': {'precision': 0.4268976231376226, 'recall': 0.16199167408969442, 'f1-score': 0.23486200534658688, 'support': 385063}, '1': {'precision': 0.5143607852701734, 'recall': 0.7933546059933407, 'f1-score': 0.6240968040334315, 'support': 749632}, '2': {'precision': 0.3783082218836409, 'recall': 0.2115310283897737, 'f1-score': 0.2713414788393919, 'support': 380313}, 'accuracy': 0.48682845239101047, 'macro avg': {'precision': 0.43985554343047895, 'recall': 0.3889591028242696, 'f1-score': 0.3767667627398034, 'support': 1515008}, 'weighted avg': {'precision': 0.4579773297772197, 'recall': 0.48682845239101047, 'f1-score': 0.4366143912162891, 'support': 1515008}}
[[ 62377 287021  35665]
 [ 58369 594724  96539]
 [ 25371 274494  80448]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.055239
{'0': {'precision': 0.37391955645855574, 'recall': 0.35358526816242797, 'f1-score': 0.3634682332463012, 'support': 122836}, '1': {'precision': 0.5028751646570068, 'recall': 0.7310978529075977, 'f1-score': 0.595881673145327, 'support': 217224}, '2': {'precision': 0.38168033421011915, 'recall': 0.0992923787826339, 'f1-score': 0.15758876665772292, 'support': 124219}, 'accuracy': 0.4621768376342673, 'macro avg': {'precision': 0.41949168510856055, 'recall': 0.3946584999508865, 'f1-score': 0.3723128910164504, 'support': 464279}, 'weighted avg': {'precision': 0.43633092782538857, 'recall': 0.4621768376342673, 'f1-score': 0.4171248397446769, 'support': 464279}}
[[ 43433  73950   5453]
 [ 43884 158812  14528]
 [ 28839  83046  12334]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0203547
{'0': {'precision': 0.35658816040738384, 'recall': 0.2858819626955168, 'f1-score': 0.31734432312245964, 'support': 39191}, '1': {'precision': 0.5553891942227984, 'recall': 0.716680607424337, 'f1-score': 0.6258094713939625, 'support': 84883}, '2': {'precision': 0.3563487688349871, 'recall': 0.20070896294762988, 'f1-score': 0.256786281779661, 'support': 38648}, 'accuracy': 0.4903762244810167, 'macro avg': {'precision': 0.42277537448838975, 'recall': 0.40109051102249454, 'f1-score': 0.39998002543202765, 'support': 162722}, 'weighted avg': {'precision': 0.46023472416559624, 'recall': 0.4903762244810167, 'f1-score': 0.4638702999351432, 'support': 162722}}
[[11204 24209  3778]
 [13816 60834 10233]
 [ 6400 24491  7757]]
training model: results/AAL/W8/deepLOB_L1/h200
Epoch 1/50
1814/1814 - 31s - loss: 3.1553 - accuracy200: 0.4401 - val_loss: 3.3568 - val_accuracy200: 0.3926 - 31s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 29s - loss: 3.1488 - accuracy200: 0.4419 - val_loss: 3.3488 - val_accuracy200: 0.4009 - 29s/epoch - 16ms/step
Epoch 3/50
1814/1814 - 28s - loss: 3.1384 - accuracy200: 0.4438 - val_loss: 3.3571 - val_accuracy200: 0.3971 - 28s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 3.1118 - accuracy200: 0.4540 - val_loss: 3.3640 - val_accuracy200: 0.4008 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 28s - loss: 3.0940 - accuracy200: 0.4597 - val_loss: 3.4017 - val_accuracy200: 0.3945 - 28s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 28s - loss: 3.0728 - accuracy200: 0.4688 - val_loss: 3.3967 - val_accuracy200: 0.3968 - 28s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 28s - loss: 3.0611 - accuracy200: 0.4725 - val_loss: 3.3882 - val_accuracy200: 0.3948 - 28s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 3.0528 - accuracy200: 0.4752 - val_loss: 3.3881 - val_accuracy200: 0.3962 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 3.0448 - accuracy200: 0.4763 - val_loss: 3.3741 - val_accuracy200: 0.3913 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 28s - loss: 3.0341 - accuracy200: 0.4795 - val_loss: 3.4468 - val_accuracy200: 0.3891 - 28s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 28s - loss: 3.0255 - accuracy200: 0.4820 - val_loss: 3.5012 - val_accuracy200: 0.3851 - 28s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 28s - loss: 3.0199 - accuracy200: 0.4830 - val_loss: 3.5527 - val_accuracy200: 0.3922 - 28s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h200
Evaluating performance on  test set...
5918/5918 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.11848
{'0': {'precision': 0.46292996382094065, 'recall': 0.017820543201253862, 'f1-score': 0.034319936428252595, 'support': 481074}, '1': {'precision': 0.3676385367252202, 'recall': 0.9746129686062558, 'f1-score': 0.5338869566971974, 'support': 556544}, '2': {'precision': 0.41193208764108885, 'recall': 0.01819476738096734, 'f1-score': 0.0348502234811706, 'support': 477390}, 'accuracy': 0.3694198314464346, 'macro avg': {'precision': 0.41416686272908326, 'recall': 0.3368760930628256, 'f1-score': 0.20101903886887354, 'support': 1515008}, 'weighted avg': {'precision': 0.411854492198969, 'recall': 0.3694198314464346, 'f1-score': 0.21800489483424923, 'support': 1515008}}
[[  8573 468624   3877]
 [  5606 542415   8523]
 [  4340 464364   8686]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1513325
{'0': {'precision': 0.357014646515197, 'recall': 0.3603642437631338, 'f1-score': 0.3586816251420374, 'support': 148472}, '1': {'precision': 0.38524899478197505, 'recall': 0.7143917137703671, 'f1-score': 0.5005611150444348, 'support': 165769}, '2': {'precision': 0.43644913080649755, 'recall': 0.020414828243511644, 'f1-score': 0.039005195599022005, 'support': 150038}, 'accuracy': 0.3769091429937602, 'macro avg': {'precision': 0.39290425736788986, 'recall': 0.36505692859233757, 'f1-score': 0.2994159785951647, 'support': 464279}, 'weighted avg': {'precision': 0.39276593147948285, 'recall': 0.3769091429937602, 'f1-score': 0.3060314062560994, 'support': 464279}}
[[ 53504  93626   1342]
 [ 44732 118424   2613]
 [ 51629  95346   3063]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1074611
{'0': {'precision': 0.34766974876249185, 'recall': 0.1513088366799447, 'f1-score': 0.21085275708742812, 'support': 49204}, '1': {'precision': 0.4087703914136839, 'recall': 0.8659839715048976, 'f1-score': 0.5553832444700448, 'support': 65134}, '2': {'precision': 0.43932550436615475, 'recall': 0.030154596560846562, 'f1-score': 0.05643554781935983, 'support': 48384}, 'accuracy': 0.40135322820515973, 'macro avg': {'precision': 0.3985885481807769, 'recall': 0.3491491349152296, 'f1-score': 0.2742238497922776, 'support': 162722}, 'weighted avg': {'precision': 0.39938003586300913, 'recall': 0.40135322820515973, 'f1-score': 0.3028460125289366, 'support': 162722}}
[[ 7445 41223   536]
 [ 7403 56405  1326]
 [ 6566 40359  1459]]
training model: results/AAL/W8/deepLOB_L1/h300
Epoch 1/50
1814/1814 - 31s - loss: 3.2009 - accuracy300: 0.4205 - val_loss: 3.4147 - val_accuracy300: 0.3661 - 31s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 28s - loss: 3.1762 - accuracy300: 0.4288 - val_loss: 3.3855 - val_accuracy300: 0.3532 - 28s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 27s - loss: 3.1588 - accuracy300: 0.4384 - val_loss: 3.4166 - val_accuracy300: 0.3436 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 26s - loss: 3.1468 - accuracy300: 0.4437 - val_loss: 3.4554 - val_accuracy300: 0.3620 - 26s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 3.1401 - accuracy300: 0.4456 - val_loss: 3.4208 - val_accuracy300: 0.3625 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 3.1277 - accuracy300: 0.4507 - val_loss: 3.4463 - val_accuracy300: 0.3624 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 3.1221 - accuracy300: 0.4527 - val_loss: 3.4424 - val_accuracy300: 0.3569 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 28s - loss: 3.1138 - accuracy300: 0.4546 - val_loss: 3.4581 - val_accuracy300: 0.3616 - 28s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 3.1070 - accuracy300: 0.4584 - val_loss: 3.4632 - val_accuracy300: 0.3561 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 28s - loss: 3.1018 - accuracy300: 0.4590 - val_loss: 3.5629 - val_accuracy300: 0.3584 - 28s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 3.0956 - accuracy300: 0.4622 - val_loss: 3.5388 - val_accuracy300: 0.3592 - 27s/epoch - 15ms/step
Epoch 12/50
1814/1814 - 27s - loss: 3.0905 - accuracy300: 0.4630 - val_loss: 3.5135 - val_accuracy300: 0.3561 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h300
Evaluating performance on  test set...
5918/5918 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1364511
{'0': {'precision': 0.4600573168547376, 'recall': 0.010032595682683275, 'f1-score': 0.019636962750168675, 'support': 512031}, '1': {'precision': 0.3283973865446599, 'recall': 0.6560933887098489, 'f1-score': 0.4377072078219197, 'support': 498647}, '2': {'precision': 0.339122520502824, 'recall': 0.3413300814942597, 'f1-score': 0.3402227200543904, 'support': 504330}, 'accuracy': 0.3329612780922609, 'macro avg': {'precision': 0.3758590746340738, 'recall': 0.33581868862893066, 'f1-score': 0.26585563020882624, 'support': 1515008}, 'weighted avg': {'precision': 0.3764651014251888, 'recall': 0.3329612780922609, 'f1-score': 0.2639594273678681, 'support': 1515008}}
[[  5137 340062 166832]
 [  2850 327159 168638]
 [  3179 329008 172143]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1581582
{'0': {'precision': 0.3592386600644145, 'recall': 0.32761420465940777, 'f1-score': 0.3426983971224677, 'support': 154569}, '1': {'precision': 0.35026941173456755, 'recall': 0.5347979139504563, 'f1-score': 0.42329740411853023, 'support': 153400}, '2': {'precision': 0.32894515336183966, 'recall': 0.18751199539376878, 'f1-score': 0.2388626519377539, 'support': 156310}, 'accuracy': 0.3489001225556185, 'macro avg': {'precision': 0.34615107505360726, 'recall': 0.3499747046678776, 'f1-score': 0.33495281772625063, 'support': 464279}, 'weighted avg': {'precision': 0.34607618507313126, 'recall': 0.3489001225556185, 'f1-score': 0.33437004788283675, 'support': 464279}}
[[50639 76094 27836]
 [39405 82038 31957]
 [50918 76082 29310]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1287571
{'0': {'precision': 0.3445616479251667, 'recall': 0.13158894842853341, 'f1-score': 0.19044607007315328, 'support': 52626}, '1': {'precision': 0.3644170017231476, 'recall': 0.6454002916143908, 'f1-score': 0.465816619963045, 'support': 58982}, '2': {'precision': 0.318441463158998, 'recall': 0.23776264819814533, 'f1-score': 0.27225072246242077, 'support': 51114}, 'accuracy': 0.3511817701355686, 'macro avg': {'precision': 0.3424733709357708, 'recall': 0.33825062941368983, 'f1-score': 0.309504470832873, 'support': 162722}, 'weighted avg': {'precision': 0.34355380235772387, 'recall': 0.3511817701355686, 'f1-score': 0.3159562578524985, 'support': 162722}}
[[ 6925 34039 11662]
 [ 6566 38067 14349]
 [ 6607 32354 12153]]
training model: results/AAL/W8/deepLOB_L1/h500
Epoch 1/50
1814/1814 - 30s - loss: 3.2576 - accuracy500: 0.3970 - val_loss: 3.3240 - val_accuracy500: 0.3547 - 30s/epoch - 16ms/step
Epoch 2/50
1814/1814 - 27s - loss: 3.2346 - accuracy500: 0.4041 - val_loss: 3.3842 - val_accuracy500: 0.3512 - 27s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 27s - loss: 3.2270 - accuracy500: 0.4097 - val_loss: 3.3652 - val_accuracy500: 0.3488 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 3.2125 - accuracy500: 0.4195 - val_loss: 3.3952 - val_accuracy500: 0.3453 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 3.1999 - accuracy500: 0.4246 - val_loss: 3.4315 - val_accuracy500: 0.3374 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 3.1903 - accuracy500: 0.4304 - val_loss: 3.4266 - val_accuracy500: 0.3345 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 3.1794 - accuracy500: 0.4351 - val_loss: 3.5291 - val_accuracy500: 0.3268 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 3.1711 - accuracy500: 0.4399 - val_loss: 3.4974 - val_accuracy500: 0.3259 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 3.1678 - accuracy500: 0.4402 - val_loss: 3.5815 - val_accuracy500: 0.3223 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 27s - loss: 3.1619 - accuracy500: 0.4440 - val_loss: 3.5397 - val_accuracy500: 0.3222 - 27s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 3.1571 - accuracy500: 0.4459 - val_loss: 3.5040 - val_accuracy500: 0.3293 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h500
Evaluating performance on  test set...
5918/5918 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1103592
{'0': {'precision': 0.37539340060348464, 'recall': 0.04442635477343327, 'f1-score': 0.07945009819675057, 'support': 520862}, '1': {'precision': 0.3270203631863063, 'recall': 0.8256144795051122, 'f1-score': 0.4684792389395382, 'support': 490293}, '2': {'precision': 0.3603533385294882, 'recall': 0.1541560732991567, 'f1-score': 0.21593640229247554, 'support': 503853}, 'accuracy': 0.3337309109918892, 'macro avg': {'precision': 0.35425570077309304, 'recall': 0.3413989691925674, 'f1-score': 0.25462191314292143, 'support': 1515008}, 'weighted avg': {'precision': 0.35473678226843297, 'recall': 0.3337309109918892, 'f1-score': 0.2507411397488393, 'support': 1515008}}
[[ 23140 422371  75351]
 [ 22979 404793  62521]
 [ 15523 410658  77672]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199186
{'0': {'precision': 0.3554378706858815, 'recall': 0.268155592537671, 'f1-score': 0.30568842826350134, 'support': 154429}, '1': {'precision': 0.34148484358298525, 'recall': 0.7025868257220794, 'f1-score': 0.4595905804912095, 'support': 153238}, '2': {'precision': 0.34588988397501, 'recall': 0.071763338696907, 'f1-score': 0.11886518071970598, 'support': 156612}, 'accuracy': 0.34529453195169285, 'macro avg': {'precision': 0.34760419941462556, 'recall': 0.34750191898555244, 'f1-score': 0.29471472982480557, 'support': 464279}, 'weighted avg': {'precision': 0.3476118366374826, 'recall': 0.34529453195169285, 'f1-score': 0.2934649496197132, 'support': 464279}}
[[ 41411 102450  10568]
 [ 34889 107663  10686]
 [ 40207 105166  11239]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084783
{'0': {'precision': 0.35993418346359524, 'recall': 0.14626128301326102, 'f1-score': 0.20800042260403326, 'support': 53842}, '1': {'precision': 0.3550924105387338, 'recall': 0.7614630547064404, 'f1-score': 0.48432838322550376, 'support': 56922}, '2': {'precision': 0.3395814473614143, 'recall': 0.12273374648754763, 'f1-score': 0.1803016808742242, 'support': 51958}, 'accuracy': 0.35395336832143165, 'macro avg': {'precision': 0.35153601378791444, 'recall': 0.343486028069083, 'f1-score': 0.29087682890125377, 'support': 162722}, 'weighted avg': {'precision': 0.35174173953575466, 'recall': 0.35395336832143165, 'f1-score': 0.29581871977158236, 'support': 162722}}
[[ 7875 39946  6021]
 [ 7197 43344  6381]
 [ 6807 38774  6377]]
training model: results/AAL/W8/deepLOB_L1/h1000
Epoch 1/50
1814/1814 - 31s - loss: 3.1435 - accuracy1000: 0.4529 - val_loss: 3.7706 - val_accuracy1000: 0.2756 - 31s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 28s - loss: 3.1106 - accuracy1000: 0.4656 - val_loss: 3.9223 - val_accuracy1000: 0.2716 - 28s/epoch - 16ms/step
Epoch 3/50
1814/1814 - 27s - loss: 3.0912 - accuracy1000: 0.4744 - val_loss: 3.9097 - val_accuracy1000: 0.2708 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 27s - loss: 3.0774 - accuracy1000: 0.4808 - val_loss: 3.8806 - val_accuracy1000: 0.2802 - 27s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 3.0737 - accuracy1000: 0.4831 - val_loss: 3.9090 - val_accuracy1000: 0.2717 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 3.0640 - accuracy1000: 0.4842 - val_loss: 4.0022 - val_accuracy1000: 0.2722 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 27s - loss: 3.0598 - accuracy1000: 0.4868 - val_loss: 4.1836 - val_accuracy1000: 0.2780 - 27s/epoch - 15ms/step
Epoch 8/50
1814/1814 - 27s - loss: 3.0505 - accuracy1000: 0.4885 - val_loss: 4.0990 - val_accuracy1000: 0.2900 - 27s/epoch - 15ms/step
Epoch 9/50
1814/1814 - 27s - loss: 3.0435 - accuracy1000: 0.4924 - val_loss: 4.0230 - val_accuracy1000: 0.3011 - 27s/epoch - 15ms/step
Epoch 10/50
1814/1814 - 28s - loss: 3.0343 - accuracy1000: 0.4957 - val_loss: 4.4047 - val_accuracy1000: 0.2865 - 28s/epoch - 15ms/step
Epoch 11/50
1814/1814 - 27s - loss: 3.0276 - accuracy1000: 0.4960 - val_loss: 4.1456 - val_accuracy1000: 0.3242 - 27s/epoch - 15ms/step
testing model: results/AAL/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
5918/5918 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2624508
{'0': {'precision': 0.4261744966442953, 'recall': 0.00021548140582105203, 'f1-score': 0.0004307450192987335, 'support': 589378}, '1': {'precision': 0.24469908622180325, 'recall': 0.9637412510050889, 'f1-score': 0.3902991255925362, 'support': 370614}, '2': {'precision': 0.3746548968323162, 'recall': 0.03716469435115384, 'f1-score': 0.06762152663947862, 'support': 555016}, 'accuracy': 0.24945742860763773, 'macro avg': {'precision': 0.34850949323280495, 'recall': 0.33370714225402126, 'f1-score': 0.15278379908377118, 'support': 1515008}, 'weighted avg': {'precision': 0.36290649412050213, 'recall': 0.24945742860763773, 'f1-score': 0.12041865191449372, 'support': 1515008}}
[[   127 568191  21060]
 [    69 357176  13369]
 [   102 534287  20627]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2108822
{'0': {'precision': 0.3979591836734694, 'recall': 0.00025301017230641476, 'f1-score': 0.0005056988368926751, 'support': 154144}, '1': {'precision': 0.3335805821384814, 'recall': 0.9826116360278578, 'f1-score': 0.4980733923786106, 'support': 153781}, '2': {'precision': 0.38388710253662023, 'recall': 0.02748890338590634, 'f1-score': 0.05130408833184125, 'support': 156354}, 'accuracy': 0.33480730336715636, 'macro avg': {'precision': 0.37180895611619036, 'recall': 0.3367845165286902, 'f1-score': 0.18329439318244814, 'support': 464279}, 'weighted avg': {'precision': 0.37189633806399125, 'recall': 0.33480730336715636, 'f1-score': 0.18241999793642574, 'support': 464279}}
[[    39 149858   4247]
 [    23 151107   2651]
 [    36 152020   4298]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2580535
{'0': {'precision': 0.34285714285714286, 'recall': 0.00019876105608374465, 'f1-score': 0.00039729179426906586, 'support': 60374}, '1': {'precision': 0.2724125295358916, 'recall': 0.9729888299672798, 'f1-score': 0.4256528971307571, 'support': 44315}, '2': {'precision': 0.39432463110102156, 'recall': 0.02993124601519825, 'f1-score': 0.055639194080527886, 'support': 58033}, 'accuracy': 0.2757279286144467, 'macro avg': {'precision': 0.33653143449801864, 'recall': 0.3343729456795206, 'f1-score': 0.16056312766851802, 'support': 162722}, 'weighted avg': {'precision': 0.3420278739563536, 'recall': 0.2757279286144467, 'f1-score': 0.13591096213918202, 'support': 162722}}
[[   12 58880  1482]
 [   11 43118  1186]
 [   12 56284  1737]]
training model: results/AAL/W8/deepOF_L1/h10
Epoch 1/50
1814/1814 - 28s - loss: 2.9822 - accuracy10: 0.4586 - val_loss: 2.7153 - val_accuracy10: 0.7953 - 28s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 25s - loss: 2.9195 - accuracy10: 0.4774 - val_loss: 2.6259 - val_accuracy10: 0.7859 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 2.8729 - accuracy10: 0.5041 - val_loss: 2.5814 - val_accuracy10: 0.7884 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 25s - loss: 2.8418 - accuracy10: 0.5204 - val_loss: 2.5296 - val_accuracy10: 0.7873 - 25s/epoch - 14ms/step
Epoch 5/50
1814/1814 - 25s - loss: 2.8168 - accuracy10: 0.5273 - val_loss: 2.5102 - val_accuracy10: 0.7816 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 25s - loss: 2.7933 - accuracy10: 0.5365 - val_loss: 2.5143 - val_accuracy10: 0.7851 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 24s - loss: 2.7830 - accuracy10: 0.5341 - val_loss: 2.5062 - val_accuracy10: 0.7807 - 24s/epoch - 13ms/step
Epoch 8/50
1814/1814 - 24s - loss: 2.7602 - accuracy10: 0.5416 - val_loss: 2.4883 - val_accuracy10: 0.7747 - 24s/epoch - 13ms/step
Epoch 9/50
1814/1814 - 24s - loss: 2.7426 - accuracy10: 0.5439 - val_loss: 2.4743 - val_accuracy10: 0.7758 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 24s - loss: 2.7252 - accuracy10: 0.5466 - val_loss: 2.4470 - val_accuracy10: 0.7615 - 24s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 24s - loss: 2.7085 - accuracy10: 0.5495 - val_loss: 2.4681 - val_accuracy10: 0.7675 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 24s - loss: 2.6962 - accuracy10: 0.5511 - val_loss: 2.4544 - val_accuracy10: 0.7637 - 24s/epoch - 13ms/step
Epoch 13/50
1814/1814 - 25s - loss: 2.6785 - accuracy10: 0.5547 - val_loss: 2.4364 - val_accuracy10: 0.7584 - 25s/epoch - 14ms/step
Epoch 14/50
1814/1814 - 25s - loss: 2.6568 - accuracy10: 0.5580 - val_loss: 2.4409 - val_accuracy10: 0.7584 - 25s/epoch - 14ms/step
Epoch 15/50
1814/1814 - 25s - loss: 2.6446 - accuracy10: 0.5601 - val_loss: 2.4202 - val_accuracy10: 0.7481 - 25s/epoch - 14ms/step
Epoch 16/50
1814/1814 - 25s - loss: 2.6308 - accuracy10: 0.5622 - val_loss: 2.4282 - val_accuracy10: 0.7511 - 25s/epoch - 14ms/step
Epoch 17/50
1814/1814 - 25s - loss: 2.6139 - accuracy10: 0.5642 - val_loss: 2.4029 - val_accuracy10: 0.7393 - 25s/epoch - 14ms/step
Epoch 18/50
1814/1814 - 24s - loss: 2.5972 - accuracy10: 0.5667 - val_loss: 2.3999 - val_accuracy10: 0.7310 - 24s/epoch - 13ms/step
Epoch 19/50
1814/1814 - 25s - loss: 2.5875 - accuracy10: 0.5691 - val_loss: 2.3914 - val_accuracy10: 0.7310 - 25s/epoch - 14ms/step
Epoch 20/50
1814/1814 - 25s - loss: 2.5974 - accuracy10: 0.5659 - val_loss: 2.4143 - val_accuracy10: 0.7334 - 25s/epoch - 14ms/step
Epoch 21/50
1814/1814 - 24s - loss: 2.5629 - accuracy10: 0.5742 - val_loss: 2.4265 - val_accuracy10: 0.7414 - 24s/epoch - 13ms/step
Epoch 22/50
1814/1814 - 24s - loss: 2.5461 - accuracy10: 0.5778 - val_loss: 2.3960 - val_accuracy10: 0.7380 - 24s/epoch - 13ms/step
Epoch 23/50
1814/1814 - 24s - loss: 2.5385 - accuracy10: 0.5787 - val_loss: 2.4190 - val_accuracy10: 0.7393 - 24s/epoch - 13ms/step
Epoch 24/50
1814/1814 - 24s - loss: 2.5222 - accuracy10: 0.5821 - val_loss: 2.4699 - val_accuracy10: 0.7475 - 24s/epoch - 13ms/step
Epoch 25/50
1814/1814 - 25s - loss: 2.5146 - accuracy10: 0.5823 - val_loss: 2.4359 - val_accuracy10: 0.7411 - 25s/epoch - 14ms/step
Epoch 26/50
1814/1814 - 24s - loss: 2.5043 - accuracy10: 0.5838 - val_loss: 2.4314 - val_accuracy10: 0.7414 - 24s/epoch - 13ms/step
Epoch 27/50
1814/1814 - 25s - loss: 2.4910 - accuracy10: 0.5865 - val_loss: 2.4247 - val_accuracy10: 0.7388 - 25s/epoch - 14ms/step
Epoch 28/50
1814/1814 - 26s - loss: 2.4885 - accuracy10: 0.5890 - val_loss: 2.4414 - val_accuracy10: 0.7307 - 26s/epoch - 14ms/step
Epoch 29/50
1814/1814 - 25s - loss: 2.4738 - accuracy10: 0.5902 - val_loss: 2.4610 - val_accuracy10: 0.7434 - 25s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h10
Evaluating performance on  test set...
5918/5918 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7478132
{'0': {'precision': 0.27021769140915364, 'recall': 0.4869602492364455, 'f1-score': 0.34756763844573624, 'support': 130639}, '1': {'precision': 0.9117871923057375, 'recall': 0.6717616427573262, 'f1-score': 0.7735835467606527, 'support': 1255158}, '2': {'precision': 0.22101133760008115, 'recall': 0.6069609770444097, 'f1-score': 0.3240331953979295, 'support': 129206}, 'accuracy': 0.650299702376827, 'macro avg': {'precision': 0.46767207377165737, 'recall': 0.5885609563460604, 'f1-score': 0.4817281268681062, 'support': 1515003}, 'weighted avg': {'precision': 0.7975521821369602, 'recall': 0.650299702376827, 'f1-score': 0.6985085172428732, 'support': 1515003}}
[[ 63616  45120  21903]
 [157480 843167 254511]
 [ 14329  36454  78423]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80063844
{'0': {'precision': 0.24847006985896397, 'recall': 0.5467597580177344, 'f1-score': 0.34167087427661474, 'support': 48268}, '1': {'precision': 0.8907055519781136, 'recall': 0.6361555752703681, 'f1-score': 0.742211970300472, 'support': 367462}, '2': {'precision': 0.27221385542168675, 'recall': 0.5361402352359569, 'f1-score': 0.36109126474893005, 'support': 48547}, 'accuracy': 0.6164035694208414, 'macro avg': {'precision': 0.47046315908625475, 'recall': 0.5730185228413531, 'f1-score': 0.4816580364420056, 'support': 464277}, 'weighted avg': {'precision': 0.7592638939945132, 'recall': 0.6164035694208414, 'f1-score': 0.6607184125423012, 'support': 464277}}
[[ 26391  14621   7256]
 [ 71367 233763  62332]
 [  8456  14063  26028]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6300332
{'0': {'precision': 0.2891910902696366, 'recall': 0.45888831014212367, 'f1-score': 0.3547923138879301, 'support': 13439}, '1': {'precision': 0.9084158204077443, 'recall': 0.7805319102015613, 'f1-score': 0.8396323020658297, 'support': 136038}, '2': {'precision': 0.2720225223387327, 'recall': 0.503397765025672, 'f1-score': 0.3531904749291447, 'support': 13244}, 'accuracy': 0.7314114342955119, 'macro avg': {'precision': 0.48987647767203785, 'recall': 0.5809393284564524, 'f1-score': 0.5158716969609681, 'support': 162721}, 'weighted avg': {'precision': 0.8054779452229063, 'recall': 0.7314114342955119, 'f1-score': 0.7599978347277415, 'support': 162721}}
[[  6167   5578   1694]
 [ 13708 106182  16148]
 [  1450   5127   6667]]
training model: results/AAL/W8/deepOF_L1/h20
Epoch 1/50
1814/1814 - 28s - loss: 3.0097 - accuracy20: 0.4564 - val_loss: 2.7848 - val_accuracy20: 0.7488 - 28s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 25s - loss: 2.9588 - accuracy20: 0.4651 - val_loss: 2.6995 - val_accuracy20: 0.7563 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 2.9168 - accuracy20: 0.4863 - val_loss: 2.6876 - val_accuracy20: 0.7553 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 24s - loss: 2.8835 - accuracy20: 0.5012 - val_loss: 2.6650 - val_accuracy20: 0.7553 - 24s/epoch - 13ms/step
Epoch 5/50
1814/1814 - 25s - loss: 2.8551 - accuracy20: 0.5150 - val_loss: 2.6815 - val_accuracy20: 0.7607 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 25s - loss: 2.8329 - accuracy20: 0.5207 - val_loss: 2.6728 - val_accuracy20: 0.7601 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 25s - loss: 2.8151 - accuracy20: 0.5231 - val_loss: 2.6669 - val_accuracy20: 0.7553 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 25s - loss: 2.7943 - accuracy20: 0.5289 - val_loss: 2.6608 - val_accuracy20: 0.7567 - 25s/epoch - 14ms/step
Epoch 9/50
1814/1814 - 25s - loss: 2.7784 - accuracy20: 0.5333 - val_loss: 2.6639 - val_accuracy20: 0.7543 - 25s/epoch - 14ms/step
Epoch 10/50
1814/1814 - 25s - loss: 2.7647 - accuracy20: 0.5370 - val_loss: 2.6573 - val_accuracy20: 0.7489 - 25s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 25s - loss: 2.7431 - accuracy20: 0.5400 - val_loss: 2.6727 - val_accuracy20: 0.7512 - 25s/epoch - 14ms/step
Epoch 12/50
1814/1814 - 25s - loss: 2.7270 - accuracy20: 0.5426 - val_loss: 2.6366 - val_accuracy20: 0.7437 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 25s - loss: 2.7108 - accuracy20: 0.5464 - val_loss: 2.6317 - val_accuracy20: 0.7374 - 25s/epoch - 14ms/step
Epoch 14/50
1814/1814 - 25s - loss: 2.6964 - accuracy20: 0.5480 - val_loss: 2.6052 - val_accuracy20: 0.7335 - 25s/epoch - 14ms/step
Epoch 15/50
1814/1814 - 25s - loss: 2.6795 - accuracy20: 0.5522 - val_loss: 2.6476 - val_accuracy20: 0.7354 - 25s/epoch - 14ms/step
Epoch 16/50
1814/1814 - 25s - loss: 2.6679 - accuracy20: 0.5520 - val_loss: 2.6145 - val_accuracy20: 0.7325 - 25s/epoch - 14ms/step
Epoch 17/50
1814/1814 - 25s - loss: 2.6520 - accuracy20: 0.5558 - val_loss: 2.6076 - val_accuracy20: 0.7271 - 25s/epoch - 14ms/step
Epoch 18/50
1814/1814 - 24s - loss: 2.6403 - accuracy20: 0.5582 - val_loss: 2.6358 - val_accuracy20: 0.7283 - 24s/epoch - 13ms/step
Epoch 19/50
1814/1814 - 25s - loss: 2.6282 - accuracy20: 0.5597 - val_loss: 2.6322 - val_accuracy20: 0.7282 - 25s/epoch - 14ms/step
Epoch 20/50
1814/1814 - 25s - loss: 2.6180 - accuracy20: 0.5600 - val_loss: 2.6543 - val_accuracy20: 0.7216 - 25s/epoch - 14ms/step
Epoch 21/50
1814/1814 - 25s - loss: 2.6057 - accuracy20: 0.5624 - val_loss: 2.6632 - val_accuracy20: 0.7288 - 25s/epoch - 14ms/step
Epoch 22/50
1814/1814 - 25s - loss: 2.5938 - accuracy20: 0.5662 - val_loss: 2.6209 - val_accuracy20: 0.7196 - 25s/epoch - 14ms/step
Epoch 23/50
1814/1814 - 25s - loss: 2.5822 - accuracy20: 0.5689 - val_loss: 2.6204 - val_accuracy20: 0.7178 - 25s/epoch - 14ms/step
Epoch 24/50
1814/1814 - 24s - loss: 2.5723 - accuracy20: 0.5704 - val_loss: 2.6379 - val_accuracy20: 0.7187 - 24s/epoch - 13ms/step
testing model: results/AAL/W8/deepOF_L1/h20
Evaluating performance on  test set...
5918/5918 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72986853
{'0': {'precision': 0.3519952265202017, 'recall': 0.4027307573934697, 'f1-score': 0.37565767496241853, 'support': 178705}, '1': {'precision': 0.8395841372763865, 'recall': 0.7711385938390665, 'f1-score': 0.803907113896056, 'support': 1159597}, '2': {'precision': 0.3180216476492706, 'recall': 0.44180281945206873, 'f1-score': 0.36982978743563144, 'support': 176701}, 'accuracy': 0.6892705823024773, 'macro avg': {'precision': 0.5032003371486196, 'recall': 0.5385573902282016, 'f1-score': 0.516464858764702, 'support': 1515003}, 'weighted avg': {'precision': 0.721237711707404, 'recall': 0.6892705823024773, 'f1-score': 0.7027639388346738, 'support': 1515003}}
[[ 71970  87985  18750]
 [116727 894210 148660]
 [ 15766  82868  78067]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76571435
{'0': {'precision': 0.35134747332446326, 'recall': 0.4210896584069413, 'f1-score': 0.3830701074473608, 'support': 63965}, '1': {'precision': 0.7991358963075569, 'recall': 0.7723660416864947, 'f1-score': 0.7855229625596467, 'support': 336224}, '2': {'precision': 0.3669997127078878, 'recall': 0.35878791661465487, 'f1-score': 0.3628473592021587, 'support': 64088}, 'accuracy': 0.6668799014381501, 'macro avg': {'precision': 0.5058276941133025, 'recall': 0.517414538902697, 'f1-score': 0.5104801430697221, 'support': 464277}, 'weighted avg': {'precision': 0.6777912460004144, 'recall': 0.6668799014381501, 'f1-score': 0.6717302677993375, 'support': 464277}}
[[ 26935  31515   5515]
 [ 42391 259688  34145]
 [  7336  33758  22994]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6656105
{'0': {'precision': 0.368565434887849, 'recall': 0.37733355360978027, 'f1-score': 0.3728979591836735, 'support': 18159}, '1': {'precision': 0.8442807202796644, 'recall': 0.8333346493063506, 'f1-score': 0.8387719744413008, 'support': 126649}, '2': {'precision': 0.35574962087538564, 'recall': 0.3797800480098253, 'f1-score': 0.36737228642401987, 'support': 17913}, 'accuracy': 0.7325176221876709, 'macro avg': {'precision': 0.5228652586809663, 'recall': 0.5301494169753187, 'f1-score': 0.5263474066829981, 'support': 162721}, 'weighted avg': {'precision': 0.7374133125630278, 'recall': 0.7325176221876709, 'f1-score': 0.7348887088854302, 'support': 162721}}
[[  6852   9781   1526]
 [ 10314 105541  10794]
 [  1425   9685   6803]]
training model: results/AAL/W8/deepOF_L1/h30
Epoch 1/50
1814/1814 - 28s - loss: 3.0534 - accuracy30: 0.4448 - val_loss: 2.8689 - val_accuracy30: 0.7177 - 28s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 25s - loss: 2.9975 - accuracy30: 0.4617 - val_loss: 2.7836 - val_accuracy30: 0.7143 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 2.9575 - accuracy30: 0.4812 - val_loss: 2.7509 - val_accuracy30: 0.7083 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 24s - loss: 2.9212 - accuracy30: 0.4982 - val_loss: 2.7701 - val_accuracy30: 0.7169 - 24s/epoch - 13ms/step
Epoch 5/50
1814/1814 - 24s - loss: 2.8994 - accuracy30: 0.5073 - val_loss: 2.7553 - val_accuracy30: 0.7134 - 24s/epoch - 13ms/step
Epoch 6/50
1814/1814 - 25s - loss: 2.8779 - accuracy30: 0.5116 - val_loss: 2.7514 - val_accuracy30: 0.7148 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 25s - loss: 2.8619 - accuracy30: 0.5134 - val_loss: 2.7289 - val_accuracy30: 0.7178 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 25s - loss: 2.8460 - accuracy30: 0.5170 - val_loss: 2.7209 - val_accuracy30: 0.7158 - 25s/epoch - 14ms/step
Epoch 9/50
1814/1814 - 24s - loss: 2.8274 - accuracy30: 0.5208 - val_loss: 2.7235 - val_accuracy30: 0.7159 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 25s - loss: 2.8146 - accuracy30: 0.5232 - val_loss: 2.7234 - val_accuracy30: 0.7174 - 25s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 24s - loss: 2.8008 - accuracy30: 0.5268 - val_loss: 2.7278 - val_accuracy30: 0.7118 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 25s - loss: 2.7869 - accuracy30: 0.5305 - val_loss: 2.7392 - val_accuracy30: 0.7100 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 24s - loss: 2.7725 - accuracy30: 0.5347 - val_loss: 2.7372 - val_accuracy30: 0.7132 - 24s/epoch - 13ms/step
Epoch 14/50
1814/1814 - 25s - loss: 2.7653 - accuracy30: 0.5357 - val_loss: 2.7288 - val_accuracy30: 0.7113 - 25s/epoch - 14ms/step
Epoch 15/50
1814/1814 - 25s - loss: 2.7466 - accuracy30: 0.5403 - val_loss: 2.7234 - val_accuracy30: 0.7065 - 25s/epoch - 14ms/step
Epoch 16/50
1814/1814 - 25s - loss: 2.7309 - accuracy30: 0.5431 - val_loss: 2.6984 - val_accuracy30: 0.7017 - 25s/epoch - 14ms/step
Epoch 17/50
1814/1814 - 26s - loss: 2.7201 - accuracy30: 0.5451 - val_loss: 2.6978 - val_accuracy30: 0.6990 - 26s/epoch - 14ms/step
Epoch 18/50
1814/1814 - 25s - loss: 2.7046 - accuracy30: 0.5481 - val_loss: 2.6863 - val_accuracy30: 0.6894 - 25s/epoch - 14ms/step
Epoch 19/50
1814/1814 - 25s - loss: 2.6905 - accuracy30: 0.5515 - val_loss: 2.6640 - val_accuracy30: 0.6893 - 25s/epoch - 14ms/step
Epoch 20/50
1814/1814 - 24s - loss: 2.6816 - accuracy30: 0.5530 - val_loss: 2.6645 - val_accuracy30: 0.6875 - 24s/epoch - 13ms/step
Epoch 21/50
1814/1814 - 24s - loss: 2.6659 - accuracy30: 0.5564 - val_loss: 2.6653 - val_accuracy30: 0.6826 - 24s/epoch - 13ms/step
Epoch 22/50
1814/1814 - 25s - loss: 2.6571 - accuracy30: 0.5581 - val_loss: 2.6881 - val_accuracy30: 0.6912 - 25s/epoch - 14ms/step
Epoch 23/50
1814/1814 - 24s - loss: 2.6446 - accuracy30: 0.5608 - val_loss: 2.6766 - val_accuracy30: 0.6876 - 24s/epoch - 13ms/step
Epoch 24/50
1814/1814 - 24s - loss: 2.6324 - accuracy30: 0.5626 - val_loss: 2.7088 - val_accuracy30: 0.6904 - 24s/epoch - 13ms/step
Epoch 25/50
1814/1814 - 24s - loss: 2.6273 - accuracy30: 0.5636 - val_loss: 2.6988 - val_accuracy30: 0.6920 - 24s/epoch - 13ms/step
Epoch 26/50
1814/1814 - 25s - loss: 2.6146 - accuracy30: 0.5660 - val_loss: 2.7156 - val_accuracy30: 0.6958 - 25s/epoch - 14ms/step
Epoch 27/50
1814/1814 - 24s - loss: 2.6055 - accuracy30: 0.5682 - val_loss: 2.7001 - val_accuracy30: 0.6887 - 24s/epoch - 13ms/step
Epoch 28/50
1814/1814 - 24s - loss: 2.5961 - accuracy30: 0.5703 - val_loss: 2.7360 - val_accuracy30: 0.6899 - 24s/epoch - 13ms/step
Epoch 29/50
1814/1814 - 24s - loss: 2.5893 - accuracy30: 0.5706 - val_loss: 2.7100 - val_accuracy30: 0.6920 - 24s/epoch - 13ms/step
testing model: results/AAL/W8/deepOF_L1/h30
Evaluating performance on  test set...
5918/5918 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78886163
{'0': {'precision': 0.35214947240700933, 'recall': 0.4633521744145807, 'f1-score': 0.4001689619994899, 'support': 216725}, '1': {'precision': 0.808294722285954, 'recall': 0.717903773097776, 'f1-score': 0.760422491123223, 'support': 1084520}, '2': {'precision': 0.36591010536344576, 'recall': 0.4563665453456713, 'f1-score': 0.4061628906713521, 'support': 213758}, 'accuracy': 0.6445881625316914, 'macro avg': {'precision': 0.5087847666854697, 'recall': 0.5458741642860093, 'f1-score': 0.522251447931355, 'support': 1515003}, 'weighted avg': {'precision': 0.6806241300665751, 'recall': 0.6445881625316914, 'f1-score': 0.6589033721691799, 'support': 1515003}}
[[100420  92892  23413]
 [160303 778581 145636]
 [ 24440  91766  97552]]
Evaluating performance on  train set...
1814/1814 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83766836
{'0': {'precision': 0.3355887241651416, 'recall': 0.5272070266135627, 'f1-score': 0.41011962164269444, 'support': 75826}, '1': {'precision': 0.7797691051087048, 'recall': 0.6826038690771352, 'f1-score': 0.7279584860084748, 'support': 312581}, '2': {'precision': 0.40763939376992336, 'recall': 0.3842889152497693, 'f1-score': 0.39561990311681616, 'support': 75870}, 'accuracy': 0.608475112917504, 'macro avg': {'precision': 0.5076657410145899, 'recall': 0.5313666036468224, 'f1-score': 0.5112326702559952, 'support': 464277}, 'weighted avg': {'precision': 0.6464135807887408, 'recall': 0.608475112917504, 'f1-score': 0.6217396166408563, 'support': 464277}}
[[ 39976  28291   7559]
 [ 64403 213369  34809]
 [ 14743  31971  29156]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7277827
{'0': {'precision': 0.36026243254784734, 'recall': 0.4218757103241351, 'f1-score': 0.38864226484630204, 'support': 21997}, '1': {'precision': 0.8125873766006536, 'recall': 0.7955763061988815, 'f1-score': 0.8039918702981599, 'support': 119086}, '2': {'precision': 0.4005596740144337, 'recall': 0.37706812089841946, 'f1-score': 0.3884590663460852, 'support': 21638}, 'accuracy': 0.6894070218349199, 'macro avg': {'precision': 0.5244698277209782, 'recall': 0.5315067124738121, 'f1-score': 0.5270310671635157, 'support': 162721}, 'weighted avg': {'precision': 0.6966512207087269, 'recall': 0.6894070218349199, 'f1-score': 0.6925880313158558, 'support': 162721}}
[[ 9280 10805  1912]
 [14046 94742 10298]
 [ 2433 11046  8159]]
training model: results/AAL/W8/deepOF_L1/h50
Epoch 1/50
1814/1814 - 27s - loss: 3.1105 - accuracy50: 0.4421 - val_loss: 3.0184 - val_accuracy50: 0.6465 - 27s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 24s - loss: 3.0627 - accuracy50: 0.4527 - val_loss: 2.9553 - val_accuracy50: 0.6505 - 24s/epoch - 13ms/step
Epoch 3/50
1814/1814 - 24s - loss: 3.0287 - accuracy50: 0.4735 - val_loss: 2.9048 - val_accuracy50: 0.6540 - 24s/epoch - 13ms/step
Epoch 4/50
1814/1814 - 25s - loss: 2.9996 - accuracy50: 0.4860 - val_loss: 2.8814 - val_accuracy50: 0.6506 - 25s/epoch - 14ms/step
Epoch 5/50
1814/1814 - 25s - loss: 2.9843 - accuracy50: 0.4887 - val_loss: 2.8824 - val_accuracy50: 0.6517 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 25s - loss: 2.9651 - accuracy50: 0.4944 - val_loss: 2.8835 - val_accuracy50: 0.6555 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 24s - loss: 2.9413 - accuracy50: 0.5042 - val_loss: 2.9093 - val_accuracy50: 0.6538 - 24s/epoch - 13ms/step
Epoch 8/50
1814/1814 - 25s - loss: 2.9229 - accuracy50: 0.5092 - val_loss: 2.9198 - val_accuracy50: 0.6533 - 25s/epoch - 14ms/step
Epoch 9/50
1814/1814 - 24s - loss: 2.9080 - accuracy50: 0.5113 - val_loss: 2.9312 - val_accuracy50: 0.6520 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 24s - loss: 2.8976 - accuracy50: 0.5138 - val_loss: 2.9467 - val_accuracy50: 0.6540 - 24s/epoch - 13ms/step
Epoch 11/50
1814/1814 - 24s - loss: 2.8846 - accuracy50: 0.5157 - val_loss: 2.9570 - val_accuracy50: 0.6534 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 25s - loss: 2.8743 - accuracy50: 0.5164 - val_loss: 2.9407 - val_accuracy50: 0.6490 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 24s - loss: 2.8620 - accuracy50: 0.5195 - val_loss: 2.9389 - val_accuracy50: 0.6539 - 24s/epoch - 13ms/step
Epoch 14/50
1814/1814 - 24s - loss: 2.8479 - accuracy50: 0.5224 - val_loss: 2.9371 - val_accuracy50: 0.6490 - 24s/epoch - 13ms/step
testing model: results/AAL/W8/deepOF_L1/h50
Evaluating performance on  test set...
5918/5918 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8714249
{'0': {'precision': 0.46946498097029615, 'recall': 0.22949843885887, 'f1-score': 0.3082893243767327, 'support': 280564}, '1': {'precision': 0.6727326375696235, 'recall': 0.8685292935829129, 'f1-score': 0.7581942960747646, 'support': 958145}, '2': {'precision': 0.43161340253764935, 'recall': 0.2200120161856573, 'f1-score': 0.2914562022184771, 'support': 276294}, 'accuracy': 0.6319155803651874, 'macro avg': {'precision': 0.524603673692523, 'recall': 0.4393465828758134, 'f1-score': 0.45264660755665814, 'support': 1515003}, 'weighted avg': {'precision': 0.5911160435892433, 'recall': 0.6319155803651874, 'f1-score': 0.5897562973490752, 'support': 1515003}}
[[ 64389 202317  13858]
 [ 59775 832177  66193]
 [ 12990 202516  60788]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9148128
{'0': {'precision': 0.4547581214689266, 'recall': 0.21861274374588893, 'f1-score': 0.29527835494733823, 'support': 94258}, '1': {'precision': 0.6282213838840798, 'recall': 0.8755708758763127, 'f1-score': 0.7315536354991691, 'support': 275016}, '2': {'precision': 0.4721451201390641, 'recall': 0.17725756028756987, 'f1-score': 0.25774852682329535, 'support': 95003}, 'accuracy': 0.5993017099705563, 'macro avg': {'precision': 0.5183748751640235, 'recall': 0.4238137266365905, 'f1-score': 0.42819350575660087, 'support': 464277}, 'weighted avg': {'precision': 0.5610674790529224, 'recall': 0.5993017099705563, 'f1-score': 0.5460278779583292, 'support': 464277}}
[[ 20606  69496   4156]
 [ 19549 240796  14671]
 [  5157  73006  16840]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84557253
{'0': {'precision': 0.44417977809816334, 'recall': 0.24948947257235407, 'f1-score': 0.3195130199526547, 'support': 28402}, '1': {'precision': 0.6954638143398143, 'recall': 0.8743766727708128, 'f1-score': 0.7747250004160356, 'support': 106485}, '2': {'precision': 0.4436341066025293, 'recall': 0.20543220521664152, 'f1-score': 0.2808241043145151, 'support': 27834}, 'accuracy': 0.6508809557463389, 'macro avg': {'precision': 0.5277592330135024, 'recall': 0.4430994501866028, 'f1-score': 0.45835404156106846, 'support': 162721}, 'weighted avg': {'precision': 0.6085272954977782, 'recall': 0.6508809557463389, 'f1-score': 0.6107869210580508, 'support': 162721}}
[[ 7086 20078  1238]
 [ 7444 93108  5933]
 [ 1423 20693  5718]]
training model: results/AAL/W8/deepOF_L1/h100
Epoch 1/50
1814/1814 - 26s - loss: 3.1821 - accuracy100: 0.4342 - val_loss: 3.2874 - val_accuracy100: 0.5262 - 26s/epoch - 14ms/step
Epoch 2/50
1814/1814 - 25s - loss: 3.1657 - accuracy100: 0.4340 - val_loss: 3.2016 - val_accuracy100: 0.5332 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 3.1408 - accuracy100: 0.4462 - val_loss: 3.1786 - val_accuracy100: 0.5370 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 24s - loss: 3.1206 - accuracy100: 0.4545 - val_loss: 3.1988 - val_accuracy100: 0.5389 - 24s/epoch - 13ms/step
Epoch 5/50
1814/1814 - 25s - loss: 3.1020 - accuracy100: 0.4608 - val_loss: 3.2138 - val_accuracy100: 0.5400 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 25s - loss: 3.0861 - accuracy100: 0.4647 - val_loss: 3.2354 - val_accuracy100: 0.5412 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 25s - loss: 3.0741 - accuracy100: 0.4676 - val_loss: 3.2457 - val_accuracy100: 0.5431 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 24s - loss: 3.0623 - accuracy100: 0.4705 - val_loss: 3.2446 - val_accuracy100: 0.5446 - 24s/epoch - 13ms/step
Epoch 9/50
1814/1814 - 24s - loss: 3.0536 - accuracy100: 0.4733 - val_loss: 3.2539 - val_accuracy100: 0.5452 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 26s - loss: 3.0449 - accuracy100: 0.4757 - val_loss: 3.2575 - val_accuracy100: 0.5459 - 26s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 25s - loss: 3.0379 - accuracy100: 0.4776 - val_loss: 3.2576 - val_accuracy100: 0.5453 - 25s/epoch - 14ms/step
Epoch 12/50
1814/1814 - 25s - loss: 3.0271 - accuracy100: 0.4811 - val_loss: 3.2668 - val_accuracy100: 0.5467 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 25s - loss: 3.0195 - accuracy100: 0.4825 - val_loss: 3.2777 - val_accuracy100: 0.5462 - 25s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h100
Evaluating performance on  test set...
5918/5918 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0073429
{'0': {'precision': 0.49690185482396443, 'recall': 0.12703895206758375, 'f1-score': 0.20234576812427485, 'support': 385063}, '1': {'precision': 0.5126723782504802, 'recall': 0.9338860504515561, 'f1-score': 0.6619540185867824, 'support': 749630}, '2': {'precision': 0.5314729168299757, 'recall': 0.0713102469038416, 'f1-score': 0.12574825311009, 'support': 380310}, 'accuracy': 0.5122808337673259, 'macro avg': {'precision': 0.5136823833014734, 'recall': 0.3774117498076605, 'f1-score': 0.3300160132737157, 'support': 1515003}, 'weighted avg': {'precision': 0.5133835238818641, 'recall': 0.5122808337673259, 'f1-score': 0.41053369373179177, 'support': 1515003}}
[[ 48918 327758   8387]
 [ 34040 700069  15521]
 [ 15488 337702  27120]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.038014
{'0': {'precision': 0.48643250872100763, 'recall': 0.14872500488503876, 'f1-score': 0.22780074449578186, 'support': 122824}, '1': {'precision': 0.4856841456248013, 'recall': 0.9284395559873113, 'f1-score': 0.637749543409682, 'support': 217201}, '2': {'precision': 0.5585069444444445, 'recall': 0.05178186266619451, 'f1-score': 0.09477653713578646, 'support': 124252}, 'accuracy': 0.4875516125071886, 'macro avg': {'precision': 0.5102078662634177, 'recall': 0.37631547451284825, 'f1-score': 0.3201089416804168, 'support': 464277}, 'weighted avg': {'precision': 0.5053713051176617, 'recall': 0.4875516125071886, 'f1-score': 0.3839850165144343, 'support': 464277}}
[[ 18267 102741   1816]
 [ 12273 201658   3270]
 [  7013 110805   6434]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98367846
{'0': {'precision': 0.47775097729352073, 'recall': 0.1464521557328982, 'f1-score': 0.22418234329872766, 'support': 39221}, '1': {'precision': 0.5422533276555996, 'recall': 0.92994028198212, 'f1-score': 0.6850501308043054, 'support': 84899}, '2': {'precision': 0.5307843137254902, 'recall': 0.07012771689852594, 'f1-score': 0.12388732523283219, 'support': 38601}, 'accuracy': 0.5371279675026579, 'macro avg': {'precision': 0.5169295395582035, 'recall': 0.3821733848711814, 'f1-score': 0.3443732664452884, 'support': 162721}, 'weighted avg': {'precision': 0.5239854821392419, 'recall': 0.5371279675026579, 'f1-score': 0.44084599641709843, 'support': 162721}}
[[ 5744 32625   852]
 [ 4407 78951  1541]
 [ 1872 34022  2707]]
training model: results/AAL/W8/deepOF_L1/h200
Epoch 1/50
1814/1814 - 30s - loss: 3.2339 - accuracy200: 0.4106 - val_loss: 3.4164 - val_accuracy200: 0.4068 - 30s/epoch - 17ms/step
Epoch 2/50
1814/1814 - 27s - loss: 3.2184 - accuracy200: 0.4160 - val_loss: 3.3514 - val_accuracy200: 0.4099 - 27s/epoch - 15ms/step
Epoch 3/50
1814/1814 - 27s - loss: 3.2081 - accuracy200: 0.4208 - val_loss: 3.3358 - val_accuracy200: 0.4122 - 27s/epoch - 15ms/step
Epoch 4/50
1814/1814 - 26s - loss: 3.1953 - accuracy200: 0.4263 - val_loss: 3.3323 - val_accuracy200: 0.4129 - 26s/epoch - 15ms/step
Epoch 5/50
1814/1814 - 27s - loss: 3.1848 - accuracy200: 0.4303 - val_loss: 3.3383 - val_accuracy200: 0.4137 - 27s/epoch - 15ms/step
Epoch 6/50
1814/1814 - 27s - loss: 3.1789 - accuracy200: 0.4329 - val_loss: 3.3379 - val_accuracy200: 0.4143 - 27s/epoch - 15ms/step
Epoch 7/50
1814/1814 - 25s - loss: 3.1711 - accuracy200: 0.4366 - val_loss: 3.3463 - val_accuracy200: 0.4155 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 24s - loss: 3.1655 - accuracy200: 0.4386 - val_loss: 3.3637 - val_accuracy200: 0.4165 - 24s/epoch - 13ms/step
Epoch 9/50
1814/1814 - 25s - loss: 3.1601 - accuracy200: 0.4407 - val_loss: 3.3782 - val_accuracy200: 0.4181 - 25s/epoch - 14ms/step
Epoch 10/50
1814/1814 - 25s - loss: 3.1534 - accuracy200: 0.4429 - val_loss: 3.3837 - val_accuracy200: 0.4197 - 25s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 24s - loss: 3.1473 - accuracy200: 0.4440 - val_loss: 3.3924 - val_accuracy200: 0.4212 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 25s - loss: 3.1410 - accuracy200: 0.4468 - val_loss: 3.3893 - val_accuracy200: 0.4224 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 25s - loss: 3.1347 - accuracy200: 0.4491 - val_loss: 3.3904 - val_accuracy200: 0.4230 - 25s/epoch - 14ms/step
Epoch 14/50
1814/1814 - 25s - loss: 3.1295 - accuracy200: 0.4512 - val_loss: 3.3743 - val_accuracy200: 0.4253 - 25s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h200
Evaluating performance on  test set...
5918/5918 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1235349
{'0': {'precision': 0.527906734129675, 'recall': 0.042074782984667575, 'f1-score': 0.07793782993912371, 'support': 481072}, '1': {'precision': 0.37308841278483607, 'recall': 0.9714451533843746, 'f1-score': 0.5391236626636737, 'support': 556543}, '2': {'precision': 0.5154332195511656, 'recall': 0.02973262838613455, 'f1-score': 0.05622209987206046, 'support': 477388}, 'accuracy': 0.37959396780072385, 'macro avg': {'precision': 0.47214278882189226, 'recall': 0.34775085491839225, 'f1-score': 0.22442786415828597, 'support': 1515003}, 'weighted avg': {'precision': 0.4671030530849337, 'recall': 0.37959396780072385, 'f1-score': 0.2405136914765359, 'support': 1515003}}
[[ 20241 453891   6940]
 [  9488 540651   6404]
 [  8613 454581  14194]]
Evaluating performance on  train set...
1814/1814 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1345441
{'0': {'precision': 0.5577051926298158, 'recall': 0.0448577606822637, 'f1-score': 0.08303665509049986, 'support': 148447}, '1': {'precision': 0.3629298986259378, 'recall': 0.9772762927653412, 'f1-score': 0.5292958473720502, 'support': 165730}, '2': {'precision': 0.5717581150107102, 'recall': 0.023117921385742837, 'f1-score': 0.04443903719688286, 'support': 150100}, 'accuracy': 0.3706688033221547, 'macro avg': {'precision': 0.49746440208882126, 'recall': 0.34841732494444927, 'f1-score': 0.2189238465531443, 'support': 464277}, 'weighted avg': {'precision': 0.4927207849897852, 'recall': 0.3706688033221547, 'f1-score': 0.2298564059956479, 'support': 464277}}
[[  6659 140429   1359]
 [  2526 161964   1240]
 [  2755 143875   3470]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977364
{'0': {'precision': 0.5063928709802402, 'recall': 0.05309123405638151, 'f1-score': 0.09610647450273907, 'support': 49236}, '1': {'precision': 0.4081725135787763, 'recall': 0.9683909811390305, 'f1-score': 0.5742860135624405, 'support': 65108}, '2': {'precision': 0.49773462783171524, 'recall': 0.03179196725716766, 'f1-score': 0.059766452289816765, 'support': 48377}, 'accuracy': 0.41298910404926226, 'macro avg': {'precision': 0.47076667079691054, 'recall': 0.35109139415085994, 'f1-score': 0.24338631345166542, 'support': 162721}, 'weighted avg': {'precision': 0.4645187990504297, 'recall': 0.41298910404926226, 'f1-score': 0.27663198856978943, 'support': 162721}}
[[ 2614 45832   790]
 [ 1296 63050   762]
 [ 1252 45587  1538]]
training model: results/AAL/W8/deepOF_L1/h300
Epoch 1/50
1814/1814 - 28s - loss: 3.2552 - accuracy300: 0.3948 - val_loss: 3.4233 - val_accuracy300: 0.3683 - 28s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 25s - loss: 3.2426 - accuracy300: 0.4011 - val_loss: 3.3899 - val_accuracy300: 0.3691 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 3.2378 - accuracy300: 0.4042 - val_loss: 3.3635 - val_accuracy300: 0.3716 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 25s - loss: 3.2323 - accuracy300: 0.4059 - val_loss: 3.3584 - val_accuracy300: 0.3718 - 25s/epoch - 14ms/step
Epoch 5/50
1814/1814 - 25s - loss: 3.2259 - accuracy300: 0.4097 - val_loss: 3.3574 - val_accuracy300: 0.3729 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 24s - loss: 3.2195 - accuracy300: 0.4128 - val_loss: 3.3587 - val_accuracy300: 0.3736 - 24s/epoch - 13ms/step
Epoch 7/50
1814/1814 - 25s - loss: 3.2133 - accuracy300: 0.4156 - val_loss: 3.3650 - val_accuracy300: 0.3741 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 24s - loss: 3.2079 - accuracy300: 0.4182 - val_loss: 3.3762 - val_accuracy300: 0.3738 - 24s/epoch - 13ms/step
Epoch 9/50
1814/1814 - 24s - loss: 3.2031 - accuracy300: 0.4201 - val_loss: 3.3829 - val_accuracy300: 0.3746 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 25s - loss: 3.1975 - accuracy300: 0.4224 - val_loss: 3.3870 - val_accuracy300: 0.3758 - 25s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 24s - loss: 3.1936 - accuracy300: 0.4234 - val_loss: 3.3955 - val_accuracy300: 0.3750 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 25s - loss: 3.1893 - accuracy300: 0.4253 - val_loss: 3.4028 - val_accuracy300: 0.3765 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 24s - loss: 3.1863 - accuracy300: 0.4264 - val_loss: 3.4060 - val_accuracy300: 0.3763 - 24s/epoch - 13ms/step
Epoch 14/50
1814/1814 - 24s - loss: 3.1824 - accuracy300: 0.4279 - val_loss: 3.4111 - val_accuracy300: 0.3770 - 24s/epoch - 13ms/step
Epoch 15/50
1814/1814 - 25s - loss: 3.1791 - accuracy300: 0.4291 - val_loss: 3.4129 - val_accuracy300: 0.3772 - 25s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h300
Evaluating performance on  test set...
5918/5918 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1429968
{'0': {'precision': 0.523990761523698, 'recall': 0.031459155633762934, 'f1-score': 0.059354791163844726, 'support': 512029}, '1': {'precision': 0.33279095634741535, 'recall': 0.9774168901046231, 'f1-score': 0.4965250398841069, 'support': 498647}, '2': {'precision': 0.5015465747173065, 'recall': 0.019612275368957047, 'f1-score': 0.03774845052361616, 'support': 504327}, 'accuracy': 0.3388673157742922, 'macro avg': {'precision': 0.45277609752947323, 'recall': 0.3428294403691144, 'f1-score': 0.19787609385718927, 'support': 1515003}, 'weighted avg': {'precision': 0.4535879843336562, 'recall': 0.3388673157742922, 'f1-score': 0.1960521918010369, 'support': 1515003}}
[[ 16108 490176   5745]
 [  7176 487386   4085]
 [  7457 486979   9891]]
Evaluating performance on  train set...
1814/1814 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1458367
{'0': {'precision': 0.5273863756753894, 'recall': 0.03219401778496362, 'f1-score': 0.060683635654378766, 'support': 154625}, '1': {'precision': 0.334033660103139, 'recall': 0.9808530063910265, 'f1-score': 0.49835157370867755, 'support': 153340}, '2': {'precision': 0.5354330708661418, 'recall': 0.01566098572086596, 'f1-score': 0.030431863951667037, 'support': 156312}, 'accuracy': 0.3399479190224801, 'macro avg': {'precision': 0.46561770221489, 'recall': 0.34290266996561874, 'f1-score': 0.19648902443824112, 'support': 464277}, 'weighted avg': {'precision': 0.4662355747802514, 'recall': 0.3399479190224801, 'f1-score': 0.19505015969681871, 'support': 464277}}
[[  4978 148449   1198]
 [  2010 150404    926]
 [  2451 151413   2448]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1203325
{'0': {'precision': 0.487353206865402, 'recall': 0.04097520221774959, 'f1-score': 0.07559463341156689, 'support': 52666}, '1': {'precision': 0.3678325173660062, 'recall': 0.9737069769808824, 'f1-score': 0.5339553401580444, 'support': 58951}, '2': {'precision': 0.5051316376617582, 'recall': 0.02215090795241077, 'f1-score': 0.04244071609335457, 'support': 51104}, 'accuracy': 0.37297582979455635, 'macro avg': {'precision': 0.45343912063105546, 'recall': 0.3456110290503476, 'f1-score': 0.21733022988765527, 'support': 162721}, 'weighted avg': {'precision': 0.4496364079318784, 'recall': 0.37297582979455635, 'f1-score': 0.23123849150475506, 'support': 162721}}
[[ 2158 49888   620]
 [ 1061 57401   489]
 [ 1209 48763  1132]]
training model: results/AAL/W8/deepOF_L1/h500
Epoch 1/50
1814/1814 - 27s - loss: 3.2841 - accuracy500: 0.3765 - val_loss: 3.3559 - val_accuracy500: 0.3498 - 27s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 25s - loss: 3.2715 - accuracy500: 0.3799 - val_loss: 3.3279 - val_accuracy500: 0.3500 - 25s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 3.2686 - accuracy500: 0.3799 - val_loss: 3.3149 - val_accuracy500: 0.3501 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 24s - loss: 3.2660 - accuracy500: 0.3804 - val_loss: 3.3121 - val_accuracy500: 0.3502 - 24s/epoch - 13ms/step
Epoch 5/50
1814/1814 - 25s - loss: 3.2633 - accuracy500: 0.3830 - val_loss: 3.3115 - val_accuracy500: 0.3500 - 25s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 24s - loss: 3.2607 - accuracy500: 0.3848 - val_loss: 3.3130 - val_accuracy500: 0.3498 - 24s/epoch - 13ms/step
Epoch 7/50
1814/1814 - 25s - loss: 3.2576 - accuracy500: 0.3875 - val_loss: 3.3179 - val_accuracy500: 0.3500 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 25s - loss: 3.2549 - accuracy500: 0.3892 - val_loss: 3.3203 - val_accuracy500: 0.3498 - 25s/epoch - 14ms/step
Epoch 9/50
1814/1814 - 24s - loss: 3.2530 - accuracy500: 0.3911 - val_loss: 3.3220 - val_accuracy500: 0.3497 - 24s/epoch - 13ms/step
Epoch 10/50
1814/1814 - 24s - loss: 3.2507 - accuracy500: 0.3933 - val_loss: 3.3221 - val_accuracy500: 0.3499 - 24s/epoch - 13ms/step
Epoch 11/50
1814/1814 - 24s - loss: 3.2490 - accuracy500: 0.3941 - val_loss: 3.3260 - val_accuracy500: 0.3501 - 24s/epoch - 13ms/step
Epoch 12/50
1814/1814 - 25s - loss: 3.2466 - accuracy500: 0.3960 - val_loss: 3.3294 - val_accuracy500: 0.3498 - 25s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 25s - loss: 3.2447 - accuracy500: 0.3970 - val_loss: 3.3292 - val_accuracy500: 0.3502 - 25s/epoch - 14ms/step
Epoch 14/50
1814/1814 - 24s - loss: 3.2430 - accuracy500: 0.3980 - val_loss: 3.3307 - val_accuracy500: 0.3500 - 24s/epoch - 13ms/step
Epoch 15/50
1814/1814 - 25s - loss: 3.2412 - accuracy500: 0.3996 - val_loss: 3.3348 - val_accuracy500: 0.3499 - 25s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h500
Evaluating performance on  test set...
5918/5918 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146157
{'0': {'precision': 0.4261417697431018, 'recall': 0.006879007794800906, 'f1-score': 0.013539454491864236, 'support': 520860}, '1': {'precision': 0.32337261961951225, 'recall': 0.989895817186493, 'f1-score': 0.48749394195831064, 'support': 490292}, '2': {'precision': 0.3452547103977669, 'recall': 0.003927748481197814, 'f1-score': 0.007767135088886403, 'support': 503851}, 'accuracy': 0.3240257610050937, 'macro avg': {'precision': 0.3649230332534603, 'recall': 0.3335675244874972, 'f1-score': 0.1696001771796871, 'support': 1515003}, 'weighted avg': {'precision': 0.36598220709497414, 'recall': 0.3240257610050937, 'f1-score': 0.1650029860263821, 'support': 1515003}}
[[  3583 515558   1719]
 [  2920 485338   2034]
 [  1905 499967   1979]]
Evaluating performance on  train set...
1814/1814 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105151
{'0': {'precision': 0.4178107606679035, 'recall': 0.007293171234074525, 'f1-score': 0.014336096151152871, 'support': 154391}, '1': {'precision': 0.32975472124647864, 'recall': 0.9901315145383938, 'f1-score': 0.49474042947316244, 'support': 153215}, '2': {'precision': 0.38722294654498046, 'recall': 0.0037913844936203894, 'f1-score': 0.007509244334881957, 'support': 156671}, 'accuracy': 0.33045574086159774, 'macro avg': {'precision': 0.3782628094864542, 'recall': 0.3337386900886962, 'f1-score': 0.17219525665306576, 'support': 464277}, 'weighted avg': {'precision': 0.37842968103999586, 'recall': 0.33045574086159774, 'f1-score': 0.17056950902541695, 'support': 464277}}
[[  1126 152878    387]
 [   959 151703    553]
 [   610 155467    594]]
Evaluating performance on  val set...
636/636 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045687
{'0': {'precision': 0.38052373158756136, 'recall': 0.008638145306607716, 'f1-score': 0.016892812380796686, 'support': 53831}, '1': {'precision': 0.3495549072179057, 'recall': 0.9873141933443441, 'f1-score': 0.5163116136116177, 'support': 56914}, '2': {'precision': 0.3552278820375335, 'recall': 0.005098507003232261, 'f1-score': 0.010052729410872121, 'support': 51976}, 'accuracy': 0.34981348443040544, 'macro avg': {'precision': 0.3617688402810002, 'recall': 0.33368361521806134, 'f1-score': 0.18108571846776214, 'support': 162721}, 'weighted avg': {'precision': 0.3616119946489558, 'recall': 0.34981348443040544, 'f1-score': 0.1893868451166215, 'support': 162721}}
[[  465 53155   211]
 [  452 56192   270]
 [  305 51406   265]]
training model: results/AAL/W8/deepOF_L1/h1000
Epoch 1/50
1814/1814 - 28s - loss: 3.2129 - accuracy1000: 0.4156 - val_loss: 3.8034 - val_accuracy1000: 0.2723 - 28s/epoch - 15ms/step
Epoch 2/50
1814/1814 - 26s - loss: 3.2416 - accuracy1000: 0.3986 - val_loss: 3.5197 - val_accuracy1000: 0.2723 - 26s/epoch - 14ms/step
Epoch 3/50
1814/1814 - 25s - loss: 3.2571 - accuracy1000: 0.3881 - val_loss: 3.4985 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 4/50
1814/1814 - 25s - loss: 3.2611 - accuracy1000: 0.3889 - val_loss: 3.4585 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 5/50
1814/1814 - 26s - loss: 3.2594 - accuracy1000: 0.3900 - val_loss: 3.4691 - val_accuracy1000: 0.2723 - 26s/epoch - 14ms/step
Epoch 6/50
1814/1814 - 25s - loss: 3.2496 - accuracy1000: 0.3969 - val_loss: 3.4814 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 7/50
1814/1814 - 25s - loss: 3.2449 - accuracy1000: 0.3998 - val_loss: 3.4792 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 8/50
1814/1814 - 25s - loss: 3.2432 - accuracy1000: 0.3998 - val_loss: 3.5248 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 9/50
1814/1814 - 25s - loss: 3.2386 - accuracy1000: 0.4012 - val_loss: 3.5824 - val_accuracy1000: 0.2723 - 25s/epoch - 14ms/step
Epoch 10/50
1814/1814 - 26s - loss: 3.2377 - accuracy1000: 0.4012 - val_loss: 3.6629 - val_accuracy1000: 0.2723 - 26s/epoch - 14ms/step
Epoch 11/50
1814/1814 - 26s - loss: 3.2310 - accuracy1000: 0.4032 - val_loss: 3.7132 - val_accuracy1000: 0.2724 - 26s/epoch - 14ms/step
Epoch 12/50
1814/1814 - 26s - loss: 3.2269 - accuracy1000: 0.4057 - val_loss: 3.7418 - val_accuracy1000: 0.2724 - 26s/epoch - 14ms/step
Epoch 13/50
1814/1814 - 25s - loss: 3.2245 - accuracy1000: 0.4064 - val_loss: 3.7033 - val_accuracy1000: 0.2724 - 25s/epoch - 14ms/step
Epoch 14/50
1814/1814 - 26s - loss: 3.2261 - accuracy1000: 0.4053 - val_loss: 3.6621 - val_accuracy1000: 0.2724 - 26s/epoch - 14ms/step
testing model: results/AAL/W8/deepOF_L1/h1000
Evaluating performance on  test set...
5918/5918 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1664072
{'0': {'precision': 0.5217391304347826, 'recall': 8.144206754262135e-05, 'f1-score': 0.0001628587132804495, 'support': 589376}, '1': {'precision': 0.24462412971137476, 'recall': 0.9998947689368695, 'f1-score': 0.3930810338353441, 'support': 370613}, '2': {'precision': 0.425, 'recall': 3.062985798556433e-05, 'f1-score': 6.1255301286001e-05, 'support': 555014}, 'accuracy': 0.2446457201734914, 'macro avg': {'precision': 0.3971210867153858, 'recall': 0.3333356136207992, 'f1-score': 0.13110171594997017, 'support': 1515003}, 'weighted avg': {'precision': 0.41850897610358007, 'recall': 0.2446457201734914, 'f1-score': 0.09624464358130293, 'support': 1515003}}
[[    48 589315     13]
 [    29 370574     10]
 [    15 554982     17]]
Evaluating performance on  train set...
1814/1814 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1246111
{'0': {'precision': 0.4727272727272727, 'recall': 0.0001686384391863844, 'f1-score': 0.00033715660275820036, 'support': 154176}, '1': {'precision': 0.331156814886783, 'recall': 0.9998113833405962, 'f1-score': 0.4975240635134348, 'support': 153751}, '2': {'precision': 0.32, 'recall': 5.116725295810681e-05, 'f1-score': 0.00010231814548361312, 'support': 156350}, 'accuracy': 0.33117298509295096, 'macro avg': {'precision': 0.37462802920468524, 'recall': 0.33334372967758025, 'f1-score': 0.16598784608722553, 'support': 464277}, 'weighted avg': {'precision': 0.3744120243855667, 'recall': 0.33117298509295096, 'f1-score': 0.1649075900544014, 'support': 464277}}
[[    26 154142      8]
 [    20 153722      9]
 [     9 156333      8]]
Evaluating performance on  val set...
636/636 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1541154
{'0': {'precision': 0.5263157894736842, 'recall': 0.00016560129831417878, 'f1-score': 0.00033109841900504924, 'support': 60386}, '1': {'precision': 0.27230762611330683, 'recall': 0.9998871510145124, 'f1-score': 0.4280427830220582, 'support': 44307}, '2': {'precision': 0.5454545454545454, 'recall': 0.00010339835941269732, 'f1-score': 0.00020675752511242442, 'support': 58028}, 'accuracy': 0.27235575002611834, 'macro avg': {'precision': 0.4480259870138455, 'recall': 0.33338538355741315, 'f1-score': 0.14286021298872523, 'support': 162721}, 'weighted avg': {'precision': 0.4639774559952099, 'recall': 0.27235575002611834, 'f1-score': 0.11674758035014286, 'support': 162721}}
[[   10 60374     2]
 [    2 44302     3]
 [    7 58015     6]]
training model: results/AAL/W8/deepLOB_L2/h10
Epoch 1/50
1814/1814 - 77s - loss: 2.8356 - accuracy10: 0.4858 - val_loss: 2.4924 - val_accuracy10: 0.6245 - 77s/epoch - 43ms/step
Epoch 2/50
1814/1814 - 74s - loss: 2.5613 - accuracy10: 0.5413 - val_loss: 2.5147 - val_accuracy10: 0.3810 - 74s/epoch - 41ms/step
Epoch 3/50
1814/1814 - 73s - loss: 2.3578 - accuracy10: 0.6247 - val_loss: 2.2141 - val_accuracy10: 0.6025 - 73s/epoch - 40ms/step
Epoch 4/50
1814/1814 - 73s - loss: 2.2274 - accuracy10: 0.6708 - val_loss: 2.0645 - val_accuracy10: 0.7003 - 73s/epoch - 40ms/step
Epoch 5/50
1814/1814 - 73s - loss: 2.1652 - accuracy10: 0.6853 - val_loss: 2.0328 - val_accuracy10: 0.7430 - 73s/epoch - 40ms/step
Epoch 6/50
1814/1814 - 73s - loss: 2.1255 - accuracy10: 0.6903 - val_loss: 1.9782 - val_accuracy10: 0.7354 - 73s/epoch - 40ms/step
Epoch 7/50
1814/1814 - 73s - loss: 2.1015 - accuracy10: 0.6939 - val_loss: 1.9783 - val_accuracy10: 0.7511 - 73s/epoch - 40ms/step
Epoch 8/50
1814/1814 - 73s - loss: 2.0799 - accuracy10: 0.6962 - val_loss: 1.9750 - val_accuracy10: 0.7559 - 73s/epoch - 40ms/step
Epoch 9/50
1814/1814 - 73s - loss: 2.0604 - accuracy10: 0.6978 - val_loss: 1.9807 - val_accuracy10: 0.7614 - 73s/epoch - 40ms/step
Epoch 10/50
1814/1814 - 73s - loss: 2.0452 - accuracy10: 0.6983 - val_loss: 1.9662 - val_accuracy10: 0.7576 - 73s/epoch - 40ms/step
Epoch 11/50
1814/1814 - 73s - loss: 2.0300 - accuracy10: 0.6987 - val_loss: 1.9606 - val_accuracy10: 0.7642 - 73s/epoch - 40ms/step
Epoch 12/50
1814/1814 - 73s - loss: 2.0175 - accuracy10: 0.6988 - val_loss: 1.9517 - val_accuracy10: 0.7541 - 73s/epoch - 40ms/step
Epoch 13/50
1814/1814 - 73s - loss: 2.0044 - accuracy10: 0.6990 - val_loss: 1.9768 - val_accuracy10: 0.7423 - 73s/epoch - 40ms/step
Epoch 14/50
1814/1814 - 73s - loss: 1.9911 - accuracy10: 0.7003 - val_loss: 2.0000 - val_accuracy10: 0.7414 - 73s/epoch - 40ms/step
Epoch 15/50
1814/1814 - 72s - loss: 1.9793 - accuracy10: 0.6997 - val_loss: 1.9850 - val_accuracy10: 0.7230 - 72s/epoch - 40ms/step
Epoch 16/50
1814/1814 - 73s - loss: 1.9676 - accuracy10: 0.7007 - val_loss: 1.9927 - val_accuracy10: 0.7348 - 73s/epoch - 40ms/step
Epoch 17/50
1814/1814 - 73s - loss: 1.9593 - accuracy10: 0.7011 - val_loss: 2.0032 - val_accuracy10: 0.7400 - 73s/epoch - 40ms/step
Epoch 18/50
1814/1814 - 73s - loss: 1.9492 - accuracy10: 0.7019 - val_loss: 2.0120 - val_accuracy10: 0.7579 - 73s/epoch - 40ms/step
Epoch 19/50
1814/1814 - 73s - loss: 1.9407 - accuracy10: 0.7026 - val_loss: 1.9562 - val_accuracy10: 0.7472 - 73s/epoch - 40ms/step
Epoch 20/50
1814/1814 - 73s - loss: 1.9332 - accuracy10: 0.7032 - val_loss: 2.0137 - val_accuracy10: 0.7481 - 73s/epoch - 40ms/step
Epoch 21/50
1814/1814 - 73s - loss: 1.9225 - accuracy10: 0.7043 - val_loss: 2.0406 - val_accuracy10: 0.7482 - 73s/epoch - 40ms/step
Epoch 22/50
1814/1814 - 73s - loss: 1.9124 - accuracy10: 0.7038 - val_loss: 2.0586 - val_accuracy10: 0.7415 - 73s/epoch - 40ms/step
testing model: results/AAL/W8/deepLOB_L2/h10
Evaluating performance on  test set...
5918/5918 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56236345
{'0': {'precision': 0.41131057576039437, 'recall': 0.5077311696264544, 'f1-score': 0.45446292458162757, 'support': 130640}, '1': {'precision': 0.9253583332733412, 'recall': 0.8192660696644253, 'f1-score': 0.8690864159133475, 'support': 1255160}, '2': {'precision': 0.3282732682576798, 'recall': 0.6160764039378367, 'f1-score': 0.42831891739194766, 'support': 129208}, 'accuracy': 0.7750731349273403, 'macro avg': {'precision': 0.5549807257638051, 'recall': 0.647691214409572, 'f1-score': 0.5839560859623075, 'support': 1515008}, 'weighted avg': {'precision': 0.8301090896244397, 'recall': 0.7750731349273403, 'f1-score': 0.7957421828422818, 'support': 1515008}}
[[  66330   49425   14885]
 [  78850 1028310  148000]
 [  16085   33521   79602]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6618475
{'0': {'precision': 0.345619901707453, 'recall': 0.5636904515969094, 'f1-score': 0.4285063680763855, 'support': 48406}, '1': {'precision': 0.9154397763115493, 'recall': 0.7655048518584047, 'f1-score': 0.833785454448427, 'support': 367385}, '2': {'precision': 0.35379810030978776, 'recall': 0.569996700214486, 'f1-score': 0.4365985814258408, 'support': 48488}, 'accuracy': 0.724045240038856, 'macro avg': {'precision': 0.5382859261095967, 'recall': 0.6330640012232668, 'f1-score': 0.5662968013168844, 'support': 464279}, 'weighted avg': {'precision': 0.7973737374942448, 'recall': 0.724045240038856, 'f1-score': 0.7500497340000668, 'support': 464279}}
[[ 27286  13068   8052]
 [ 43722 281235  42428]
 [  7940  12910  27638]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5962538
{'0': {'precision': 0.32564411069161514, 'recall': 0.5850040992770366, 'f1-score': 0.4183901918976546, 'support': 13417}, '1': {'precision': 0.9387198154815878, 'recall': 0.7840069407171584, 'f1-score': 0.8544162306391776, 'support': 136009}, '2': {'precision': 0.3233437225285703, 'recall': 0.608604091456077, 'f1-score': 0.4223161630395073, 'support': 13296}, 'accuracy': 0.7532663069529627, 'macro avg': {'precision': 0.5292358829005911, 'recall': 0.6592050438167574, 'f1-score': 0.5650408618587799, 'support': 162722}, 'weighted avg': {'precision': 0.8378872466644003, 'recall': 0.7532663069529627, 'f1-score': 0.7831574957379336, 'support': 162722}}
[[  7849   3654   1914]
 [ 14357 106632  15020]
 [  1897   3307   8092]]
training model: results/AAL/W8/deepLOB_L2/h20
Epoch 1/50
1814/1814 - 77s - loss: 2.8867 - accuracy20: 0.4707 - val_loss: 2.6063 - val_accuracy20: 0.5319 - 77s/epoch - 42ms/step
Epoch 2/50
1814/1814 - 74s - loss: 2.6984 - accuracy20: 0.5060 - val_loss: 2.5807 - val_accuracy20: 0.3607 - 74s/epoch - 41ms/step
Epoch 3/50
1814/1814 - 75s - loss: 2.5309 - accuracy20: 0.5697 - val_loss: 2.3815 - val_accuracy20: 0.6315 - 75s/epoch - 41ms/step
Epoch 4/50
1814/1814 - 75s - loss: 2.3980 - accuracy20: 0.6234 - val_loss: 2.3600 - val_accuracy20: 0.7004 - 75s/epoch - 41ms/step
Epoch 5/50
1814/1814 - 76s - loss: 2.3213 - accuracy20: 0.6473 - val_loss: 2.3275 - val_accuracy20: 0.7220 - 76s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 75s - loss: 2.2820 - accuracy20: 0.6573 - val_loss: 2.3594 - val_accuracy20: 0.7110 - 75s/epoch - 42ms/step
Epoch 7/50
1814/1814 - 76s - loss: 2.2500 - accuracy20: 0.6639 - val_loss: 2.3565 - val_accuracy20: 0.7168 - 76s/epoch - 42ms/step
Epoch 8/50
1814/1814 - 76s - loss: 2.2270 - accuracy20: 0.6658 - val_loss: 2.2727 - val_accuracy20: 0.7355 - 76s/epoch - 42ms/step
Epoch 9/50
1814/1814 - 75s - loss: 2.2051 - accuracy20: 0.6679 - val_loss: 2.1933 - val_accuracy20: 0.7411 - 75s/epoch - 41ms/step
Epoch 10/50
1814/1814 - 75s - loss: 2.1829 - accuracy20: 0.6701 - val_loss: 2.2323 - val_accuracy20: 0.7168 - 75s/epoch - 41ms/step
Epoch 11/50
1814/1814 - 74s - loss: 2.1659 - accuracy20: 0.6708 - val_loss: 2.2188 - val_accuracy20: 0.7209 - 74s/epoch - 41ms/step
Epoch 12/50
1814/1814 - 75s - loss: 2.1492 - accuracy20: 0.6726 - val_loss: 2.1895 - val_accuracy20: 0.7340 - 75s/epoch - 41ms/step
Epoch 13/50
1814/1814 - 75s - loss: 2.1339 - accuracy20: 0.6724 - val_loss: 2.2472 - val_accuracy20: 0.7039 - 75s/epoch - 41ms/step
Epoch 14/50
1814/1814 - 74s - loss: 2.1190 - accuracy20: 0.6744 - val_loss: 2.1653 - val_accuracy20: 0.7332 - 74s/epoch - 41ms/step
Epoch 15/50
1814/1814 - 74s - loss: 2.1084 - accuracy20: 0.6746 - val_loss: 2.1622 - val_accuracy20: 0.7175 - 74s/epoch - 41ms/step
Epoch 16/50
1814/1814 - 75s - loss: 2.0957 - accuracy20: 0.6761 - val_loss: 2.1290 - val_accuracy20: 0.7220 - 75s/epoch - 41ms/step
Epoch 17/50
1814/1814 - 74s - loss: 2.0868 - accuracy20: 0.6763 - val_loss: 2.1715 - val_accuracy20: 0.7021 - 74s/epoch - 41ms/step
Epoch 18/50
1814/1814 - 75s - loss: 2.0800 - accuracy20: 0.6762 - val_loss: 2.1483 - val_accuracy20: 0.7187 - 75s/epoch - 41ms/step
Epoch 19/50
1814/1814 - 74s - loss: 2.0685 - accuracy20: 0.6769 - val_loss: 2.1584 - val_accuracy20: 0.7049 - 74s/epoch - 41ms/step
Epoch 20/50
1814/1814 - 76s - loss: 2.0598 - accuracy20: 0.6776 - val_loss: 2.1913 - val_accuracy20: 0.6981 - 76s/epoch - 42ms/step
Epoch 21/50
1814/1814 - 75s - loss: 2.0512 - accuracy20: 0.6774 - val_loss: 2.1543 - val_accuracy20: 0.6978 - 75s/epoch - 42ms/step
Epoch 22/50
1814/1814 - 74s - loss: 2.0424 - accuracy20: 0.6787 - val_loss: 2.2025 - val_accuracy20: 0.7110 - 74s/epoch - 41ms/step
Epoch 23/50
1814/1814 - 73s - loss: 2.0347 - accuracy20: 0.6791 - val_loss: 2.2058 - val_accuracy20: 0.6993 - 73s/epoch - 40ms/step
Epoch 24/50
1814/1814 - 73s - loss: 2.0252 - accuracy20: 0.6796 - val_loss: 2.2275 - val_accuracy20: 0.6969 - 73s/epoch - 40ms/step
Epoch 25/50
1814/1814 - 74s - loss: 2.0198 - accuracy20: 0.6804 - val_loss: 2.3094 - val_accuracy20: 0.6864 - 74s/epoch - 41ms/step
Epoch 26/50
1814/1814 - 73s - loss: 2.0137 - accuracy20: 0.6804 - val_loss: 2.2672 - val_accuracy20: 0.6879 - 73s/epoch - 40ms/step
testing model: results/AAL/W8/deepLOB_L2/h20
Evaluating performance on  test set...
5918/5918 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67768943
{'0': {'precision': 0.43285896123036877, 'recall': 0.506183340234799, 'f1-score': 0.46665841252153817, 'support': 178706}, '1': {'precision': 0.8800595911898832, 'recall': 0.7508964313494849, 'f1-score': 0.8103634889804867, 'support': 1159598}, '2': {'precision': 0.3367264435194017, 'recall': 0.6033536309308222, 'f1-score': 0.43222939800456495, 'support': 176704}, 'accuracy': 0.7048220207418047, 'macro avg': {'precision': 0.5498816653132179, 'recall': 0.6201444675050354, 'f1-score': 0.5697504331688633, 'support': 1515008}, 'weighted avg': {'precision': 0.7639370517026266, 'recall': 0.7048220207418047, 'f1-score': 0.7257170938423212, 'support': 1515008}}
[[ 90458  66308  21940]
 [100793 870738 188067]
 [ 17727  52362 106615]]
Evaluating performance on  train set...
1814/1814 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.685218
{'0': {'precision': 0.4204047519551072, 'recall': 0.5495278969957081, 'f1-score': 0.4763715078130285, 'support': 64075}, '1': {'precision': 0.8645267451866546, 'recall': 0.7829657744911982, 'f1-score': 0.8217273760317677, 'support': 336182}, '2': {'precision': 0.4266875279392043, 'recall': 0.5069038767923526, 'f1-score': 0.46334951456310675, 'support': 64022}, 'accuracy': 0.7126813833923137, 'macro avg': {'precision': 0.5705396750269887, 'recall': 0.6131325160930864, 'f1-score': 0.5871494661359676, 'support': 464279}, 'weighted avg': {'precision': 0.7428575353302371, 'recall': 0.7126813833923137, 'f1-score': 0.7246462142668325, 'support': 464279}}
[[ 35211  19444   9420]
 [ 38778 263219  34185]
 [  9766  21803  32453]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6657903
{'0': {'precision': 0.3851405917333529, 'recall': 0.577976092105988, 'f1-score': 0.46225355215332087, 'support': 18153}, '1': {'precision': 0.8979461559811268, 'recall': 0.7665861055824092, 'f1-score': 0.8270828540020962, 'support': 126612}, '2': {'precision': 0.3639649507119387, 'recall': 0.555159547808654, 'f1-score': 0.43967627406443643, 'support': 17957}, 'accuracy': 0.7222133454603556, 'macro avg': {'precision': 0.5490172328088061, 'recall': 0.6332405818323504, 'f1-score': 0.5763375600732845, 'support': 162722}, 'weighted avg': {'precision': 0.7818115219991905, 'recall': 0.7222133454603556, 'f1-score': 0.7436312846236387, 'support': 162722}}
[[10492  5362  2299]
 [14431 97059 15122]
 [ 2319  5669  9969]]
training model: results/AAL/W8/deepLOB_L2/h30
Epoch 1/50
1814/1814 - 76s - loss: 2.8987 - accuracy30: 0.4814 - val_loss: 2.8639 - val_accuracy30: 0.5111 - 76s/epoch - 42ms/step
Epoch 2/50
1814/1814 - 73s - loss: 2.8094 - accuracy30: 0.4888 - val_loss: 2.7111 - val_accuracy30: 0.3687 - 73s/epoch - 40ms/step
Epoch 3/50
1814/1814 - 73s - loss: 2.7090 - accuracy30: 0.5290 - val_loss: 2.5713 - val_accuracy30: 0.5316 - 73s/epoch - 40ms/step
Epoch 4/50
1814/1814 - 73s - loss: 2.6150 - accuracy30: 0.5632 - val_loss: 2.5112 - val_accuracy30: 0.6066 - 73s/epoch - 40ms/step
Epoch 5/50
1814/1814 - 72s - loss: 2.5248 - accuracy30: 0.5941 - val_loss: 2.5336 - val_accuracy30: 0.6672 - 72s/epoch - 40ms/step
Epoch 6/50
1814/1814 - 73s - loss: 2.4536 - accuracy30: 0.6178 - val_loss: 2.4433 - val_accuracy30: 0.6941 - 73s/epoch - 40ms/step
Epoch 7/50
1814/1814 - 73s - loss: 2.4140 - accuracy30: 0.6304 - val_loss: 2.4359 - val_accuracy30: 0.7054 - 73s/epoch - 40ms/step
Epoch 8/50
1814/1814 - 73s - loss: 2.3852 - accuracy30: 0.6369 - val_loss: 2.4982 - val_accuracy30: 0.6974 - 73s/epoch - 40ms/step
Epoch 9/50
1814/1814 - 73s - loss: 2.3584 - accuracy30: 0.6399 - val_loss: 2.5507 - val_accuracy30: 0.7129 - 73s/epoch - 40ms/step
Epoch 10/50
1814/1814 - 74s - loss: 2.3401 - accuracy30: 0.6415 - val_loss: 2.5601 - val_accuracy30: 0.7136 - 74s/epoch - 41ms/step
Epoch 11/50
1814/1814 - 75s - loss: 2.3203 - accuracy30: 0.6424 - val_loss: 2.5007 - val_accuracy30: 0.7064 - 75s/epoch - 41ms/step
Epoch 12/50
1814/1814 - 73s - loss: 2.3026 - accuracy30: 0.6451 - val_loss: 2.5208 - val_accuracy30: 0.6888 - 73s/epoch - 40ms/step
Epoch 13/50
1814/1814 - 73s - loss: 2.2877 - accuracy30: 0.6461 - val_loss: 2.5126 - val_accuracy30: 0.6824 - 73s/epoch - 40ms/step
Epoch 14/50
1814/1814 - 73s - loss: 2.2735 - accuracy30: 0.6467 - val_loss: 2.4892 - val_accuracy30: 0.6791 - 73s/epoch - 40ms/step
Epoch 15/50
1814/1814 - 73s - loss: 2.2601 - accuracy30: 0.6488 - val_loss: 2.4271 - val_accuracy30: 0.6765 - 73s/epoch - 40ms/step
Epoch 16/50
1814/1814 - 73s - loss: 2.2491 - accuracy30: 0.6495 - val_loss: 2.3945 - val_accuracy30: 0.6737 - 73s/epoch - 40ms/step
Epoch 17/50
1814/1814 - 74s - loss: 2.2369 - accuracy30: 0.6502 - val_loss: 2.4609 - val_accuracy30: 0.6632 - 74s/epoch - 41ms/step
Epoch 18/50
1814/1814 - 74s - loss: 2.2256 - accuracy30: 0.6512 - val_loss: 2.4666 - val_accuracy30: 0.6525 - 74s/epoch - 41ms/step
Epoch 19/50
1814/1814 - 74s - loss: 2.2162 - accuracy30: 0.6525 - val_loss: 2.4917 - val_accuracy30: 0.6699 - 74s/epoch - 41ms/step
Epoch 20/50
1814/1814 - 73s - loss: 2.2051 - accuracy30: 0.6527 - val_loss: 2.5267 - val_accuracy30: 0.6517 - 73s/epoch - 40ms/step
Epoch 21/50
1814/1814 - 72s - loss: 2.1948 - accuracy30: 0.6544 - val_loss: 2.4800 - val_accuracy30: 0.6693 - 72s/epoch - 40ms/step
Epoch 22/50
1814/1814 - 72s - loss: 2.1881 - accuracy30: 0.6550 - val_loss: 2.5223 - val_accuracy30: 0.6362 - 72s/epoch - 40ms/step
Epoch 23/50
1814/1814 - 73s - loss: 2.1782 - accuracy30: 0.6555 - val_loss: 2.5222 - val_accuracy30: 0.6423 - 73s/epoch - 40ms/step
Epoch 24/50
1814/1814 - 73s - loss: 2.1692 - accuracy30: 0.6557 - val_loss: 2.5383 - val_accuracy30: 0.6295 - 73s/epoch - 40ms/step
Epoch 25/50
1814/1814 - 73s - loss: 2.1600 - accuracy30: 0.6569 - val_loss: 2.5884 - val_accuracy30: 0.6172 - 73s/epoch - 40ms/step
Epoch 26/50
1814/1814 - 73s - loss: 2.1519 - accuracy30: 0.6578 - val_loss: 2.6049 - val_accuracy30: 0.6138 - 73s/epoch - 40ms/step
testing model: results/AAL/W8/deepLOB_L2/h30
Evaluating performance on  test set...
5918/5918 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69219536
{'0': {'precision': 0.5152031398257569, 'recall': 0.4409438646032317, 'f1-score': 0.4751898243223757, 'support': 216726}, '1': {'precision': 0.8345662078566768, 'recall': 0.7865601495959967, 'f1-score': 0.8098523823041044, 'support': 1084521}, '2': {'precision': 0.39571804556530454, 'recall': 0.5690327047496971, 'f1-score': 0.46680763857974, 'support': 213761}, 'accuracy': 0.7064266327306522, 'macro avg': {'precision': 0.5818291310825794, 'recall': 0.5988455729829751, 'f1-score': 0.5839499484020734, 'support': 1515008}, 'weighted avg': {'precision': 0.726960899962834, 'recall': 0.7064266327306522, 'f1-score': 0.7135758840912818, 'support': 1515008}}
[[ 95564  92157  29005]
 [ 74739 853041 156741]
 [ 15185  76939 121637]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7884021
{'0': {'precision': 0.40298821106604743, 'recall': 0.5053494255296722, 'f1-score': 0.44840123925878295, 'support': 75896}, '1': {'precision': 0.8171726317347021, 'recall': 0.742063555539915, 'f1-score': 0.7778090754228536, 'support': 312577}, '2': {'precision': 0.4264937014708297, 'recall': 0.47967179378940983, 'f1-score': 0.4515223761982814, 'support': 75806}, 'accuracy': 0.6605252445189207, 'macro avg': {'precision': 0.5488848480905264, 'recall': 0.575694924952999, 'f1-score': 0.5592442302933059, 'support': 464279}, 'weighted avg': {'precision': 0.685676811810365, 'recall': 0.6605252445189207, 'f1-score': 0.6706854996097623, 'support': 464279}}
[[ 38354  24739  12803]
 [ 44532 231952  36093]
 [ 12288  27156  36362]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76062423
{'0': {'precision': 0.40475649473604486, 'recall': 0.48590652845971993, 'f1-score': 0.4416346431965621, 'support': 21996}, '1': {'precision': 0.8608651379169204, 'recall': 0.7242795588741716, 'f1-score': 0.786687831846297, 'support': 119059}, '2': {'precision': 0.3517304340609179, 'recall': 0.5867909724465777, 'f1-score': 0.43982426401909575, 'support': 21667}, 'accuracy': 0.6737503226361524, 'macro avg': {'precision': 0.5391173555712944, 'recall': 0.5989923532601563, 'f1-score': 0.5560489130206516, 'support': 162722}, 'weighted avg': {'precision': 0.731417445878631, 'recall': 0.6737503226361524, 'f1-score': 0.6938590633844324, 'support': 162722}}
[[10688  7011  4297]
 [13691 86232 19136]
 [ 2027  6926 12714]]
training model: results/AAL/W8/deepLOB_L2/h50
Epoch 1/50
1814/1814 - 77s - loss: 2.9767 - accuracy50: 0.4792 - val_loss: 3.0610 - val_accuracy50: 0.5881 - 77s/epoch - 42ms/step
Epoch 2/50
1814/1814 - 74s - loss: 2.8757 - accuracy50: 0.4952 - val_loss: 2.9118 - val_accuracy50: 0.5171 - 74s/epoch - 41ms/step
Epoch 3/50
1814/1814 - 73s - loss: 2.8060 - accuracy50: 0.5213 - val_loss: 2.8249 - val_accuracy50: 0.5210 - 73s/epoch - 40ms/step
Epoch 4/50
1814/1814 - 73s - loss: 2.7535 - accuracy50: 0.5426 - val_loss: 2.7697 - val_accuracy50: 0.5747 - 73s/epoch - 40ms/step
Epoch 5/50
1814/1814 - 73s - loss: 2.7006 - accuracy50: 0.5595 - val_loss: 2.7225 - val_accuracy50: 0.5680 - 73s/epoch - 40ms/step
Epoch 6/50
1814/1814 - 73s - loss: 2.6545 - accuracy50: 0.5732 - val_loss: 2.7787 - val_accuracy50: 0.5509 - 73s/epoch - 40ms/step
Epoch 7/50
1814/1814 - 73s - loss: 2.6151 - accuracy50: 0.5847 - val_loss: 2.6640 - val_accuracy50: 0.6049 - 73s/epoch - 40ms/step
Epoch 8/50
1814/1814 - 73s - loss: 2.5817 - accuracy50: 0.5912 - val_loss: 2.6772 - val_accuracy50: 0.6203 - 73s/epoch - 40ms/step
Epoch 9/50
1814/1814 - 73s - loss: 2.5538 - accuracy50: 0.5973 - val_loss: 2.6861 - val_accuracy50: 0.6472 - 73s/epoch - 40ms/step
Epoch 10/50
1814/1814 - 73s - loss: 2.5320 - accuracy50: 0.6017 - val_loss: 2.6435 - val_accuracy50: 0.6548 - 73s/epoch - 40ms/step
Epoch 11/50
1814/1814 - 73s - loss: 2.5096 - accuracy50: 0.6054 - val_loss: 2.7185 - val_accuracy50: 0.6605 - 73s/epoch - 40ms/step
Epoch 12/50
1814/1814 - 73s - loss: 2.4916 - accuracy50: 0.6086 - val_loss: 2.7168 - val_accuracy50: 0.6495 - 73s/epoch - 40ms/step
Epoch 13/50
1814/1814 - 73s - loss: 2.4789 - accuracy50: 0.6104 - val_loss: 2.6956 - val_accuracy50: 0.6408 - 73s/epoch - 40ms/step
Epoch 14/50
1814/1814 - 73s - loss: 2.4629 - accuracy50: 0.6128 - val_loss: 2.6861 - val_accuracy50: 0.6424 - 73s/epoch - 40ms/step
Epoch 15/50
1814/1814 - 73s - loss: 2.4503 - accuracy50: 0.6143 - val_loss: 2.6536 - val_accuracy50: 0.6264 - 73s/epoch - 40ms/step
Epoch 16/50
1814/1814 - 73s - loss: 2.4375 - accuracy50: 0.6164 - val_loss: 2.6430 - val_accuracy50: 0.6291 - 73s/epoch - 40ms/step
Epoch 17/50
1814/1814 - 73s - loss: 2.4231 - accuracy50: 0.6185 - val_loss: 2.6659 - val_accuracy50: 0.6185 - 73s/epoch - 40ms/step
Epoch 18/50
1814/1814 - 73s - loss: 2.4127 - accuracy50: 0.6191 - val_loss: 2.6933 - val_accuracy50: 0.6131 - 73s/epoch - 40ms/step
Epoch 19/50
1814/1814 - 73s - loss: 2.4021 - accuracy50: 0.6202 - val_loss: 2.7095 - val_accuracy50: 0.6185 - 73s/epoch - 40ms/step
Epoch 20/50
1814/1814 - 73s - loss: 2.3918 - accuracy50: 0.6217 - val_loss: 2.7133 - val_accuracy50: 0.6172 - 73s/epoch - 40ms/step
Epoch 21/50
1814/1814 - 73s - loss: 2.3832 - accuracy50: 0.6227 - val_loss: 2.7312 - val_accuracy50: 0.6065 - 73s/epoch - 40ms/step
Epoch 22/50
1814/1814 - 73s - loss: 2.3757 - accuracy50: 0.6234 - val_loss: 2.7035 - val_accuracy50: 0.6128 - 73s/epoch - 40ms/step
Epoch 23/50
1814/1814 - 74s - loss: 2.3665 - accuracy50: 0.6239 - val_loss: 2.7407 - val_accuracy50: 0.6029 - 74s/epoch - 41ms/step
Epoch 24/50
1814/1814 - 73s - loss: 2.3571 - accuracy50: 0.6249 - val_loss: 2.7482 - val_accuracy50: 0.6045 - 73s/epoch - 40ms/step
Epoch 25/50
1814/1814 - 73s - loss: 2.3483 - accuracy50: 0.6262 - val_loss: 2.7817 - val_accuracy50: 0.6018 - 73s/epoch - 40ms/step
Epoch 26/50
1814/1814 - 73s - loss: 2.3382 - accuracy50: 0.6272 - val_loss: 2.8020 - val_accuracy50: 0.6089 - 73s/epoch - 40ms/step
testing model: results/AAL/W8/deepLOB_L2/h50
Evaluating performance on  test set...
5918/5918 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8354378
{'0': {'precision': 0.525555955989909, 'recall': 0.3534452032334868, 'f1-score': 0.42265070921985815, 'support': 280564}, '1': {'precision': 0.723008470474845, 'recall': 0.7328113535814442, 'f1-score': 0.7278769077663487, 'support': 958147}, '2': {'precision': 0.38782778600507906, 'recall': 0.498561330741919, 'f1-score': 0.4362777778657541, 'support': 276297}, 'accuracy': 0.6198356708347414, 'macro avg': {'precision': 0.5454640708232777, 'recall': 0.5282726291856167, 'f1-score': 0.5289351316173203, 'support': 1515008}, 'weighted avg': {'precision': 0.6253142768792371, 'recall': 0.6198356708347414, 'f1-score': 0.6181722408846279, 'support': 1515008}}
[[ 99164 145143  36257]
 [ 74828 702141 181178]
 [ 14692 123854 137751]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84108275
{'0': {'precision': 0.4464452806147843, 'recall': 0.47579088073667014, 'f1-score': 0.46065119145439604, 'support': 94262}, '1': {'precision': 0.7094308270325461, 'recall': 0.7727829490893363, 'f1-score': 0.7397530039472746, 'support': 275129}, '2': {'precision': 0.46456029817694117, 'recall': 0.31393853806593036, 'f1-score': 0.3746784813629246, 'support': 94888}, 'accuracy': 0.6187077166962107, 'macro avg': {'precision': 0.5401454686080905, 'recall': 0.5208374559639789, 'f1-score': 0.5250275589215317, 'support': 464279}, 'weighted avg': {'precision': 0.60599126091286, 'recall': 0.6187077166962107, 'f1-score': 0.6084744271686835, 'support': 464279}}
[[ 44849  40918   8495]
 [ 36675 212615  25839]
 [ 18934  46165  29789]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8117353
{'0': {'precision': 0.42734847247181834, 'recall': 0.46036606828581483, 'f1-score': 0.4432432432432432, 'support': 28410}, '1': {'precision': 0.7646907751118662, 'recall': 0.7273521619031512, 'f1-score': 0.7455542661228578, 'support': 106434}, '2': {'precision': 0.38960492227979276, 'recall': 0.43155893536121676, 'f1-score': 0.40951019435651315, 'support': 27878}, 'accuracy': 0.630062314868303, 'macro avg': {'precision': 0.5272147232878258, 'recall': 0.5397590551833943, 'f1-score': 0.5327692345742047, 'support': 162722}, 'weighted avg': {'precision': 0.6415326390069984, 'recall': 0.630062314868303, 'f1-score': 0.6352010699188287, 'support': 162722}}
[[13079 11235  4096]
 [14266 77415 14753]
 [ 3260 12587 12031]]
training model: results/AAL/W8/deepLOB_L2/h100
Epoch 1/50
1814/1814 - 77s - loss: 3.0845 - accuracy100: 0.4614 - val_loss: 3.1208 - val_accuracy100: 0.5115 - 77s/epoch - 42ms/step
Epoch 2/50
1814/1814 - 73s - loss: 3.0058 - accuracy100: 0.4793 - val_loss: 3.1514 - val_accuracy100: 0.5054 - 73s/epoch - 40ms/step
Epoch 3/50
1814/1814 - 72s - loss: 2.9596 - accuracy100: 0.4991 - val_loss: 3.1309 - val_accuracy100: 0.5051 - 72s/epoch - 40ms/step
Epoch 4/50
1814/1814 - 73s - loss: 2.9319 - accuracy100: 0.5091 - val_loss: 3.0751 - val_accuracy100: 0.4876 - 73s/epoch - 40ms/step
Epoch 5/50
1814/1814 - 73s - loss: 2.9059 - accuracy100: 0.5181 - val_loss: 3.1449 - val_accuracy100: 0.4644 - 73s/epoch - 40ms/step
Epoch 6/50
1814/1814 - 73s - loss: 2.8817 - accuracy100: 0.5249 - val_loss: 3.2031 - val_accuracy100: 0.4127 - 73s/epoch - 40ms/step
Epoch 7/50
1814/1814 - 72s - loss: 2.8587 - accuracy100: 0.5322 - val_loss: 3.2584 - val_accuracy100: 0.3903 - 72s/epoch - 40ms/step
Epoch 8/50
1814/1814 - 73s - loss: 2.8394 - accuracy100: 0.5359 - val_loss: 3.1730 - val_accuracy100: 0.4210 - 73s/epoch - 40ms/step
Epoch 9/50
1814/1814 - 72s - loss: 2.8244 - accuracy100: 0.5396 - val_loss: 3.0965 - val_accuracy100: 0.4855 - 72s/epoch - 40ms/step
Epoch 10/50
1814/1814 - 72s - loss: 2.8112 - accuracy100: 0.5427 - val_loss: 3.1236 - val_accuracy100: 0.4895 - 72s/epoch - 40ms/step
Epoch 11/50
1814/1814 - 72s - loss: 2.7943 - accuracy100: 0.5462 - val_loss: 3.1396 - val_accuracy100: 0.4861 - 72s/epoch - 40ms/step
Epoch 12/50
1814/1814 - 72s - loss: 2.7805 - accuracy100: 0.5485 - val_loss: 3.1280 - val_accuracy100: 0.4818 - 72s/epoch - 40ms/step
Epoch 13/50
1814/1814 - 73s - loss: 2.7641 - accuracy100: 0.5525 - val_loss: 3.1746 - val_accuracy100: 0.5011 - 73s/epoch - 40ms/step
Epoch 14/50
1814/1814 - 73s - loss: 2.7549 - accuracy100: 0.5541 - val_loss: 3.1952 - val_accuracy100: 0.5010 - 73s/epoch - 40ms/step
testing model: results/AAL/W8/deepLOB_L2/h100
Evaluating performance on  test set...
5918/5918 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0034738
{'0': {'precision': 0.4565790187042559, 'recall': 0.21870706871343132, 'f1-score': 0.29574741928630255, 'support': 385063}, '1': {'precision': 0.5519002838311005, 'recall': 0.6061934389140271, 'f1-score': 0.5777741894674474, 'support': 749632}, '2': {'precision': 0.3737738598251906, 'recall': 0.49846047860577997, 'f1-score': 0.42720514166856344, 'support': 380313}, 'accuracy': 0.480663468443731, 'macro avg': {'precision': 0.46075105412018225, 'recall': 0.4411203287444128, 'f1-score': 0.43357558347410446, 'support': 1515008}, 'weighted avg': {'precision': 0.48295775217021303, 'recall': 0.480663468443731, 'f1-score': 0.4682952689061044, 'support': 1515008}}
[[ 84216 204269  96578]
 [ 74178 454422 221032]
 [ 26056 164686 189571]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.018673
{'0': {'precision': 0.44386216534274786, 'recall': 0.1965140512553323, 'f1-score': 0.2724184629274348, 'support': 122836}, '1': {'precision': 0.499571794701631, 'recall': 0.7277418701432623, 'f1-score': 0.5924472652114358, 'support': 217224}, '2': {'precision': 0.394391063365362, 'recall': 0.29672594369621397, 'f1-score': 0.3386577360033444, 'support': 124219}, 'accuracy': 0.471873593248887, 'macro avg': {'precision': 0.4459416744699136, 'recall': 0.40699395503160285, 'f1-score': 0.401174488047405, 'support': 464279}, 'weighted avg': {'precision': 0.45669112747828516, 'recall': 0.471873593248887, 'f1-score': 0.4398740506442091, 'support': 464279}}
[[ 24139  79064  19633]
 [ 22175 158083  36966]
 [  8070  79290  36859]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99493307
{'0': {'precision': 0.4214611186220019, 'recall': 0.21476869689469522, 'f1-score': 0.2845407525100571, 'support': 39191}, '1': {'precision': 0.5701584358671835, 'recall': 0.6376306209723973, 'f1-score': 0.6020098881603461, 'support': 84883}, '2': {'precision': 0.3454822993120465, 'recall': 0.4274994825087973, 'f1-score': 0.38213967688589234, 'support': 38648}, 'accuracy': 0.48587775469819694, 'macro avg': {'precision': 0.445700617933744, 'recall': 0.4266329334586299, 'f1-score': 0.4228967725187651, 'support': 162722}, 'weighted avg': {'precision': 0.48098254148450104, 'recall': 0.48587775469819694, 'f1-score': 0.4733273693822732, 'support': 162722}}
[[ 8417 21183  9591]
 [ 9049 54124 21710]
 [ 2505 19621 16522]]
training model: results/AAL/W8/deepLOB_L2/h200
Epoch 1/50
1814/1814 - 77s - loss: 3.1821 - accuracy200: 0.4271 - val_loss: 3.3697 - val_accuracy200: 0.3983 - 77s/epoch - 43ms/step
Epoch 2/50
1814/1814 - 77s - loss: 3.1687 - accuracy200: 0.4314 - val_loss: 3.3719 - val_accuracy200: 0.3929 - 77s/epoch - 42ms/step
Epoch 3/50
1814/1814 - 76s - loss: 3.1274 - accuracy200: 0.4490 - val_loss: 3.4594 - val_accuracy200: 0.3757 - 76s/epoch - 42ms/step
Epoch 4/50
1814/1814 - 77s - loss: 3.0936 - accuracy200: 0.4602 - val_loss: 3.3025 - val_accuracy200: 0.4032 - 77s/epoch - 42ms/step
Epoch 5/50
1814/1814 - 76s - loss: 3.0726 - accuracy200: 0.4685 - val_loss: 3.3451 - val_accuracy200: 0.3849 - 76s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 77s - loss: 3.0528 - accuracy200: 0.4747 - val_loss: 3.3737 - val_accuracy200: 0.3531 - 77s/epoch - 42ms/step
Epoch 7/50
1814/1814 - 77s - loss: 3.0346 - accuracy200: 0.4790 - val_loss: 3.4231 - val_accuracy200: 0.3422 - 77s/epoch - 43ms/step
Epoch 8/50
1814/1814 - 76s - loss: 3.0164 - accuracy200: 0.4844 - val_loss: 3.4907 - val_accuracy200: 0.3442 - 76s/epoch - 42ms/step
Epoch 9/50
1814/1814 - 77s - loss: 3.0020 - accuracy200: 0.4887 - val_loss: 3.5780 - val_accuracy200: 0.3354 - 77s/epoch - 42ms/step
Epoch 10/50
1814/1814 - 76s - loss: 2.9846 - accuracy200: 0.4935 - val_loss: 3.5027 - val_accuracy200: 0.3392 - 76s/epoch - 42ms/step
Epoch 11/50
1814/1814 - 77s - loss: 2.9730 - accuracy200: 0.4967 - val_loss: 3.4966 - val_accuracy200: 0.3499 - 77s/epoch - 42ms/step
Epoch 12/50
1814/1814 - 76s - loss: 2.9583 - accuracy200: 0.5001 - val_loss: 3.5219 - val_accuracy200: 0.3473 - 76s/epoch - 42ms/step
Epoch 13/50
1814/1814 - 76s - loss: 2.9498 - accuracy200: 0.5023 - val_loss: 3.5374 - val_accuracy200: 0.3582 - 76s/epoch - 42ms/step
Epoch 14/50
1814/1814 - 76s - loss: 2.9351 - accuracy200: 0.5060 - val_loss: 3.5664 - val_accuracy200: 0.3818 - 76s/epoch - 42ms/step
testing model: results/AAL/W8/deepLOB_L2/h200
Evaluating performance on  test set...
5918/5918 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103672
{'0': {'precision': 0.39097409929175075, 'recall': 0.07125930729991643, 'f1-score': 0.12054751167022706, 'support': 481074}, '1': {'precision': 0.3715734529988317, 'recall': 0.9063685890064398, 'f1-score': 0.5270700786685795, 'support': 556544}, '2': {'precision': 0.34963090374829786, 'recall': 0.05109449297220302, 'f1-score': 0.08915937896939624, 'support': 477390}, 'accuracy': 0.37168582608144646, 'macro avg': {'precision': 0.3707261520129601, 'recall': 0.3429074630928531, 'f1-score': 0.24559232310273424, 'support': 1515008}, 'weighted avg': {'precision': 0.37081965693175306, 'recall': 0.37168582608144646, 'f1-score': 0.25999450789564726, 'support': 1515008}}
[[ 34281 425404  21389]
 [ 28126 504434  23984]
 [ 25274 427724  24392]]
Evaluating performance on  train set...
1814/1814 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1291494
{'0': {'precision': 0.37710446675009096, 'recall': 0.2861886416293981, 'f1-score': 0.3254157588196776, 'support': 148472}, '1': {'precision': 0.3779202904744081, 'recall': 0.7735523529731132, 'f1-score': 0.5077691278144278, 'support': 165769}, '2': {'precision': 0.3604717364782432, 'recall': 0.02953918340687026, 'f1-score': 0.05460380822137211, 'support': 150038}, 'accuracy': 0.377260224994023, 'macro avg': {'precision': 0.3718321645675808, 'recall': 0.3630933926697939, 'f1-score': 0.2959295649518258, 'support': 464279}, 'weighted avg': {'precision': 0.37202066304246867, 'recall': 0.377260224994023, 'f1-score': 0.3030077933097626, 'support': 464279}}
[[ 42491 102539   3442]
 [ 33117 128231   4421]
 [ 37069 108537   4432]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950311
{'0': {'precision': 0.3650552785605896, 'recall': 0.1368994390699943, 'f1-score': 0.19912498521934494, 'support': 49204}, '1': {'precision': 0.4115067060728627, 'recall': 0.8700371541744711, 'f1-score': 0.5587418965219748, 'support': 65134}, '2': {'precision': 0.3438024089037963, 'recall': 0.04660631613756614, 'f1-score': 0.08208506998161731, 'support': 48384}, 'accuracy': 0.40351028133872496, 'macro avg': {'precision': 0.3734547978457496, 'recall': 0.3511809697940105, 'f1-score': 0.27998398390764573, 'support': 162722}, 'weighted avg': {'precision': 0.3773293929035187, 'recall': 0.40351028133872496, 'f1-score': 0.308270820705163, 'support': 162722}}
[[ 6736 40531  1937]
 [ 6098 56669  2367]
 [ 5618 40511  2255]]
training model: results/AAL/W8/deepLOB_L2/h300
Epoch 1/50
1814/1814 - 79s - loss: 3.2196 - accuracy300: 0.4142 - val_loss: 3.4040 - val_accuracy300: 0.3645 - 79s/epoch - 44ms/step
Epoch 2/50
1814/1814 - 77s - loss: 3.1876 - accuracy300: 0.4278 - val_loss: 3.3920 - val_accuracy300: 0.3656 - 77s/epoch - 43ms/step
Epoch 3/50
1814/1814 - 77s - loss: 3.1745 - accuracy300: 0.4303 - val_loss: 3.3670 - val_accuracy300: 0.3631 - 77s/epoch - 43ms/step
Epoch 4/50
1814/1814 - 77s - loss: 3.1556 - accuracy300: 0.4407 - val_loss: 3.3841 - val_accuracy300: 0.3629 - 77s/epoch - 42ms/step
Epoch 5/50
1814/1814 - 76s - loss: 3.1285 - accuracy300: 0.4506 - val_loss: 3.3946 - val_accuracy300: 0.3631 - 76s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 76s - loss: 3.1173 - accuracy300: 0.4541 - val_loss: 3.4284 - val_accuracy300: 0.3655 - 76s/epoch - 42ms/step
Epoch 7/50
1814/1814 - 77s - loss: 3.0958 - accuracy300: 0.4626 - val_loss: 3.4756 - val_accuracy300: 0.3581 - 77s/epoch - 42ms/step
Epoch 8/50
1814/1814 - 77s - loss: 3.0814 - accuracy300: 0.4658 - val_loss: 3.4195 - val_accuracy300: 0.3647 - 77s/epoch - 42ms/step
Epoch 9/50
1814/1814 - 77s - loss: 3.0661 - accuracy300: 0.4699 - val_loss: 3.4238 - val_accuracy300: 0.3586 - 77s/epoch - 42ms/step
Epoch 10/50
1814/1814 - 76s - loss: 3.0526 - accuracy300: 0.4750 - val_loss: 3.4509 - val_accuracy300: 0.3586 - 76s/epoch - 42ms/step
Epoch 11/50
1814/1814 - 77s - loss: 3.0357 - accuracy300: 0.4789 - val_loss: 3.5342 - val_accuracy300: 0.3609 - 77s/epoch - 42ms/step
Epoch 12/50
1814/1814 - 77s - loss: 3.0195 - accuracy300: 0.4854 - val_loss: 3.5114 - val_accuracy300: 0.3631 - 77s/epoch - 42ms/step
Epoch 13/50
1814/1814 - 76s - loss: 3.0085 - accuracy300: 0.4886 - val_loss: 3.6674 - val_accuracy300: 0.3613 - 76s/epoch - 42ms/step
testing model: results/AAL/W8/deepLOB_L2/h300
Evaluating performance on  test set...
5918/5918 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1439856
{'0': {'precision': 0.5145722713864307, 'recall': 0.008517062443484867, 'f1-score': 0.016756771295623876, 'support': 512031}, '1': {'precision': 0.32972124386025686, 'recall': 0.994446973510319, 'f1-score': 0.4952396361090554, 'support': 498647}, '2': {'precision': 0.2724827056110684, 'recall': 0.0014058255507306723, 'f1-score': 0.002797219350918861, 'support': 504330}, 'accuracy': 0.330656999831024, 'macro avg': {'precision': 0.3722587402859186, 'recall': 0.3347899538348449, 'f1-score': 0.17159787558519937, 'support': 1515008}, 'weighted avg': {'precision': 0.3731417040030687, 'recall': 0.330656999831024, 'f1-score': 0.16959677231103115, 'support': 1515008}}
[[  4361 506502   1168]
 [  2044 495878    725]
 [  2070 501551    709]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1569729
{'0': {'precision': 0.3672969476784191, 'recall': 0.0863368463275301, 'f1-score': 0.1398099548459419, 'support': 154569}, '1': {'precision': 0.33181860181909933, 'recall': 0.9129921773142112, 'f1-score': 0.486737089405832, 'support': 153400}, '2': {'precision': 0.3901857215880048, 'recall': 0.014650374256285585, 'f1-score': 0.02824040103835885, 'support': 156310}, 'accuracy': 0.33533284942889946, 'macro avg': {'precision': 0.3631004236951744, 'recall': 0.33799313263267566, 'f1-score': 0.2182624817633776, 'support': 464279}, 'weighted avg': {'precision': 0.36328075481806504, 'recall': 0.33533284942889946, 'f1-score': 0.21687393035597755, 'support': 464279}}
[[ 13345 139398   1826]
 [ 11594 140053   1753]
 [ 11394 142626   2290]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1231861
{'0': {'precision': 0.35894559730790804, 'recall': 0.036483867289932734, 'f1-score': 0.06623544631306598, 'support': 52626}, '1': {'precision': 0.3635234381503038, 'recall': 0.9625648502933098, 'f1-score': 0.5277399504552447, 'support': 58982}, '2': {'precision': 0.34615384615384615, 'recall': 0.008099542199788708, 'f1-score': 0.01582871343911298, 'support': 51114}, 'accuracy': 0.36324528951217416, 'macro avg': {'precision': 0.35620762720401933, 'recall': 0.33571608659434377, 'f1-score': 0.20326803673580787, 'support': 162722}, 'weighted avg': {'precision': 0.3565868052581389, 'recall': 0.36324528951217416, 'f1-score': 0.217683737995781, 'support': 162722}}
[[ 1920 50310   396]
 [ 1822 56774   386]
 [ 1607 49093   414]]
training model: results/AAL/W8/deepLOB_L2/h500
Epoch 1/50
1814/1814 - 79s - loss: 3.2643 - accuracy500: 0.3890 - val_loss: 3.3688 - val_accuracy500: 0.3430 - 79s/epoch - 43ms/step
Epoch 2/50
1814/1814 - 77s - loss: 3.2521 - accuracy500: 0.3938 - val_loss: 3.4017 - val_accuracy500: 0.3506 - 77s/epoch - 42ms/step
Epoch 3/50
1814/1814 - 75s - loss: 3.2319 - accuracy500: 0.4096 - val_loss: 3.4045 - val_accuracy500: 0.3367 - 75s/epoch - 42ms/step
Epoch 4/50
1814/1814 - 76s - loss: 3.2109 - accuracy500: 0.4207 - val_loss: 3.3646 - val_accuracy500: 0.3441 - 76s/epoch - 42ms/step
Epoch 5/50
1814/1814 - 75s - loss: 3.1978 - accuracy500: 0.4255 - val_loss: 3.3579 - val_accuracy500: 0.3471 - 75s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 75s - loss: 3.1851 - accuracy500: 0.4333 - val_loss: 3.5022 - val_accuracy500: 0.3418 - 75s/epoch - 41ms/step
Epoch 7/50
1814/1814 - 75s - loss: 3.1771 - accuracy500: 0.4358 - val_loss: 3.5098 - val_accuracy500: 0.3280 - 75s/epoch - 42ms/step
Epoch 8/50
1814/1814 - 75s - loss: 3.1611 - accuracy500: 0.4410 - val_loss: 3.5208 - val_accuracy500: 0.3295 - 75s/epoch - 41ms/step
Epoch 9/50
1814/1814 - 75s - loss: 3.1476 - accuracy500: 0.4454 - val_loss: 3.5206 - val_accuracy500: 0.3268 - 75s/epoch - 41ms/step
Epoch 10/50
1814/1814 - 75s - loss: 3.1369 - accuracy500: 0.4500 - val_loss: 3.5136 - val_accuracy500: 0.3288 - 75s/epoch - 41ms/step
Epoch 11/50
1814/1814 - 75s - loss: 3.1332 - accuracy500: 0.4519 - val_loss: 3.5350 - val_accuracy500: 0.3338 - 75s/epoch - 41ms/step
Epoch 12/50
1814/1814 - 75s - loss: 3.1186 - accuracy500: 0.4557 - val_loss: 3.5391 - val_accuracy500: 0.3284 - 75s/epoch - 41ms/step
Epoch 13/50
1814/1814 - 75s - loss: 3.1074 - accuracy500: 0.4613 - val_loss: 3.5505 - val_accuracy500: 0.3309 - 75s/epoch - 41ms/step
Epoch 14/50
1814/1814 - 76s - loss: 3.0981 - accuracy500: 0.4636 - val_loss: 3.6519 - val_accuracy500: 0.3305 - 76s/epoch - 42ms/step
Epoch 15/50
1814/1814 - 76s - loss: 3.0835 - accuracy500: 0.4694 - val_loss: 3.6245 - val_accuracy500: 0.3291 - 76s/epoch - 42ms/step
testing model: results/AAL/W8/deepLOB_L2/h500
Evaluating performance on  test set...
5918/5918 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1241924
{'0': {'precision': 0.5196121639488761, 'recall': 0.009054221655640073, 'f1-score': 0.017798308481369516, 'support': 520862}, '1': {'precision': 0.321780182326518, 'recall': 0.8969473355728106, 'f1-score': 0.4736413561505297, 'support': 490293}, '2': {'precision': 0.3360045381759692, 'recall': 0.0928703411510897, 'f1-score': 0.1455196263193576, 'support': 503853}, 'accuracy': 0.32427287512673203, 'macro avg': {'precision': 0.3924656281504544, 'recall': 0.3329572994598468, 'f1-score': 0.21231976365041896, 'support': 1515008}, 'weighted avg': {'precision': 0.3945257691350353, 'recall': 0.32427287512673203, 'f1-score': 0.20779692533849461, 'support': 1515008}}
[[  4716 472001  44145]
 [  2201 439767  48325]
 [  2159 454901  46793]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.139276
{'0': {'precision': 0.34914872564741206, 'recall': 0.3313237798600004, 'f1-score': 0.3400027909387522, 'support': 154429}, '1': {'precision': 0.34641587731827334, 'recall': 0.618847805374646, 'f1-score': 0.44418682536002274, 'support': 153238}, '2': {'precision': 0.34363987723087414, 'recall': 0.09651240007151432, 'f1-score': 0.15070016002233333, 'support': 156612}, 'accuracy': 0.3470154799161711, 'macro avg': {'precision': 0.34640149339885323, 'recall': 0.34889466176872025, 'f1-score': 0.31162992544036944, 'support': 464279}, 'weighted avg': {'precision': 0.34638847161810776, 'recall': 0.3470154799161711, 'f1-score': 0.31053320354316566, 'support': 464279}}
[[51166 89304 13959]
 [43496 94831 14911]
 [51883 89614 15115]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.120074
{'0': {'precision': 0.351682119205298, 'recall': 0.12328665354184466, 'f1-score': 0.18257078812382252, 'support': 53842}, '1': {'precision': 0.34881673173278477, 'recall': 0.786409472611644, 'f1-score': 0.4832742249788128, 'support': 56922}, '2': {'precision': 0.32708172209332304, 'recall': 0.09767504522883867, 'f1-score': 0.1504283131280197, 'support': 51958}, 'accuracy': 0.34707660918621946, 'macro avg': {'precision': 0.34252685767713525, 'recall': 0.33579039046077575, 'f1-score': 0.27209110874355164, 'support': 162722}, 'weighted avg': {'precision': 0.342824736559716, 'recall': 0.34707660918621946, 'f1-score': 0.2774969955009923, 'support': 162722}}
[[ 6638 42666  4538]
 [ 6255 44764  5903]
 [ 5982 40901  5075]]
training model: results/AAL/W8/deepLOB_L2/h1000
Epoch 1/50
1814/1814 - 78s - loss: 3.1289 - accuracy1000: 0.4556 - val_loss: 3.8725 - val_accuracy1000: 0.2765 - 78s/epoch - 43ms/step
Epoch 2/50
1814/1814 - 75s - loss: 3.0940 - accuracy1000: 0.4740 - val_loss: 3.5465 - val_accuracy1000: 0.2803 - 75s/epoch - 41ms/step
Epoch 3/50
1814/1814 - 75s - loss: 3.0672 - accuracy1000: 0.4835 - val_loss: 3.7655 - val_accuracy1000: 0.2777 - 75s/epoch - 41ms/step
Epoch 4/50
1814/1814 - 75s - loss: 3.0682 - accuracy1000: 0.4845 - val_loss: 3.7458 - val_accuracy1000: 0.2734 - 75s/epoch - 41ms/step
Epoch 5/50
1814/1814 - 75s - loss: 3.0563 - accuracy1000: 0.4878 - val_loss: 3.6785 - val_accuracy1000: 0.3078 - 75s/epoch - 42ms/step
Epoch 6/50
1814/1814 - 75s - loss: 3.0484 - accuracy1000: 0.4904 - val_loss: 3.9358 - val_accuracy1000: 0.2753 - 75s/epoch - 41ms/step
Epoch 7/50
1814/1814 - 75s - loss: 3.0474 - accuracy1000: 0.4907 - val_loss: 3.8293 - val_accuracy1000: 0.2966 - 75s/epoch - 41ms/step
Epoch 8/50
1814/1814 - 75s - loss: 3.0367 - accuracy1000: 0.4949 - val_loss: 3.9052 - val_accuracy1000: 0.2956 - 75s/epoch - 41ms/step
Epoch 9/50
1814/1814 - 75s - loss: 3.0236 - accuracy1000: 0.4990 - val_loss: 3.7708 - val_accuracy1000: 0.2930 - 75s/epoch - 41ms/step
Epoch 10/50
1814/1814 - 75s - loss: 3.0127 - accuracy1000: 0.5015 - val_loss: 3.8285 - val_accuracy1000: 0.2862 - 75s/epoch - 41ms/step
Epoch 11/50
1814/1814 - 75s - loss: 2.9962 - accuracy1000: 0.5060 - val_loss: 3.7463 - val_accuracy1000: 0.3067 - 75s/epoch - 41ms/step
Epoch 12/50
1814/1814 - 75s - loss: 2.9916 - accuracy1000: 0.5076 - val_loss: 3.6462 - val_accuracy1000: 0.3147 - 75s/epoch - 41ms/step
testing model: results/AAL/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
5918/5918 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1926799
{'0': {'precision': 0.4239049740163326, 'recall': 0.0009688179742033126, 'f1-score': 0.0019332176562698378, 'support': 589378}, '1': {'precision': 0.24446313776964432, 'recall': 0.9025428073413309, 'f1-score': 0.38472066791726717, 'support': 370614}, '2': {'precision': 0.36599324514882, 'recall': 0.09586570477247502, 'f1-score': 0.15193469951869878, 'support': 555016}, 'accuracy': 0.25628445526360255, 'macro avg': {'precision': 0.34478711897826564, 'recall': 0.3331257766960031, 'f1-score': 0.17952952836407862, 'support': 1515008}, 'weighted avg': {'precision': 0.3587927153300012, 'recall': 0.25628445526360255, 'f1-score': 0.1505262353488412, 'support': 1515008}}
[[   571 532422  56385]
 [   334 334495  35785]
 [   442 501367  53207]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1646241
{'0': {'precision': 0.30941747572815537, 'recall': 0.020675472285654972, 'f1-score': 0.03876091557004208, 'support': 154144}, '1': {'precision': 0.3346850240777226, 'recall': 0.9301084009077845, 'f1-score': 0.4922437868559934, 'support': 153781}, '2': {'precision': 0.37083380302859503, 'recall': 0.06311958760249178, 'f1-score': 0.10787737679472253, 'support': 156354}, 'accuracy': 0.3361965542270919, 'macro avg': {'precision': 0.3383121009448244, 'recall': 0.3379678202653104, 'f1-score': 0.212960693073586, 'support': 464279}, 'weighted avg': {'precision': 0.33846974234257843, 'recall': 0.3361965542270919, 'f1-score': 0.21224212968385847, 'support': 464279}}
[[  3187 141451   9506]
 [  3510 143033   7238]
 [  3603 142882   9869]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1836485
{'0': {'precision': 0.387192851824274, 'recall': 0.008612979096962268, 'f1-score': 0.016851110715037993, 'support': 60374}, '1': {'precision': 0.27216910386201726, 'recall': 0.917274060701794, 'f1-score': 0.41978241001306366, 'support': 44315}, '2': {'precision': 0.3562816995094371, 'recall': 0.07383729946754433, 'f1-score': 0.12232372252355124, 'support': 58033}, 'accuracy': 0.2793353080714347, 'macro avg': {'precision': 0.3385478850652428, 'recall': 0.3332414464221002, 'f1-score': 0.18631908108388429, 'support': 162722}, 'weighted avg': {'precision': 0.34484366552350126, 'recall': 0.2793353080714347, 'f1-score': 0.16419930339627015, 'support': 162722}}
[[  520 55424  4430]
 [  354 40649  3312]
 [  469 53279  4285]]
training model: results/AAL/W8/deepOF_L2/h10
Epoch 1/50
1814/1814 - 44s - loss: 2.6613 - accuracy10: 0.5455 - val_loss: 2.2674 - val_accuracy10: 0.8260 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 41s - loss: 2.2707 - accuracy10: 0.6470 - val_loss: 2.1772 - val_accuracy10: 0.8223 - 41s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 41s - loss: 2.1563 - accuracy10: 0.6665 - val_loss: 2.1607 - val_accuracy10: 0.8120 - 41s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.1114 - accuracy10: 0.6704 - val_loss: 2.0881 - val_accuracy10: 0.7959 - 41s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 41s - loss: 2.0839 - accuracy10: 0.6748 - val_loss: 2.0792 - val_accuracy10: 0.8012 - 41s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 40s - loss: 2.0628 - accuracy10: 0.6778 - val_loss: 2.0880 - val_accuracy10: 0.7926 - 40s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 41s - loss: 2.0503 - accuracy10: 0.6795 - val_loss: 2.0597 - val_accuracy10: 0.7947 - 41s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 41s - loss: 2.0384 - accuracy10: 0.6808 - val_loss: 2.0643 - val_accuracy10: 0.7929 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 2.0262 - accuracy10: 0.6831 - val_loss: 2.0776 - val_accuracy10: 0.7917 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 2.0178 - accuracy10: 0.6840 - val_loss: 2.0654 - val_accuracy10: 0.7937 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 2.0066 - accuracy10: 0.6852 - val_loss: 2.0495 - val_accuracy10: 0.7844 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 1.9972 - accuracy10: 0.6858 - val_loss: 2.0670 - val_accuracy10: 0.7839 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 41s - loss: 1.9902 - accuracy10: 0.6883 - val_loss: 2.0726 - val_accuracy10: 0.7812 - 41s/epoch - 22ms/step
Epoch 14/50
1814/1814 - 41s - loss: 1.9815 - accuracy10: 0.6879 - val_loss: 2.0629 - val_accuracy10: 0.7862 - 41s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 1.9734 - accuracy10: 0.6892 - val_loss: 2.0644 - val_accuracy10: 0.7872 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 1.9693 - accuracy10: 0.6895 - val_loss: 2.0665 - val_accuracy10: 0.7860 - 41s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 41s - loss: 1.9627 - accuracy10: 0.6903 - val_loss: 2.0787 - val_accuracy10: 0.7820 - 41s/epoch - 23ms/step
Epoch 18/50
1814/1814 - 40s - loss: 1.9545 - accuracy10: 0.6911 - val_loss: 2.0814 - val_accuracy10: 0.7809 - 40s/epoch - 22ms/step
Epoch 19/50
1814/1814 - 40s - loss: 1.9487 - accuracy10: 0.6912 - val_loss: 2.0856 - val_accuracy10: 0.7817 - 40s/epoch - 22ms/step
Epoch 20/50
1814/1814 - 40s - loss: 1.9427 - accuracy10: 0.6913 - val_loss: 2.0777 - val_accuracy10: 0.7789 - 40s/epoch - 22ms/step
Epoch 21/50
1814/1814 - 40s - loss: 1.9381 - accuracy10: 0.6915 - val_loss: 2.1015 - val_accuracy10: 0.7771 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h10
Evaluating performance on  test set...
5918/5918 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56160563
{'0': {'precision': 0.3699414671080092, 'recall': 0.5834551703549476, 'f1-score': 0.45279006287925816, 'support': 130639}, '1': {'precision': 0.9271085350076381, 'recall': 0.8084432398152265, 'f1-score': 0.8637191221545907, 'support': 1255158}, '2': {'precision': 0.3446500762376376, 'recall': 0.5720632168784732, 'f1-score': 0.4301489523288532, 'support': 129206}, 'accuracy': 0.7688829659083183, 'macro avg': {'precision': 0.547233359451095, 'recall': 0.6546538756828825, 'f1-score': 0.5822193791209007, 'support': 1515003}, 'weighted avg': {'precision': 0.829389338275238, 'recall': 0.7688829659083183, 'f1-score': 0.7913078934394169, 'support': 1515003}}
[[  76222   42218   12199]
 [ 112086 1014724  128348]
 [  17730   37562   73914]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6255562
{'0': {'precision': 0.3635079790989973, 'recall': 0.6399270738377393, 'f1-score': 0.46364455118583003, 'support': 48268}, '1': {'precision': 0.9236431315654273, 'recall': 0.7779035655387496, 'f1-score': 0.8445319620706618, 'support': 367462}, '2': {'precision': 0.38595611824014664, 'recall': 0.555111541392877, 'f1-score': 0.45533111995336695, 'support': 48547}, 'accuracy': 0.7402628172405697, 'macro avg': {'precision': 0.5577024096348571, 'recall': 0.6576473935897886, 'f1-score': 0.5878358777366196, 'support': 464277}, 'weighted avg': {'precision': 0.8091862556591214, 'recall': 0.7402628172405697, 'f1-score': 0.7642367787407588, 'support': 464277}}
[[ 30888  11142   6238]
 [ 44975 285850  36637]
 [  9109  12489  26949]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5273663
{'0': {'precision': 0.3578365855831774, 'recall': 0.5976635166307017, 'f1-score': 0.4476522223770377, 'support': 13439}, '1': {'precision': 0.9303328459193536, 'recall': 0.8278128170070127, 'f1-score': 0.8760837855184083, 'support': 136038}, '2': {'precision': 0.3584356147285209, 'recall': 0.520386590154032, 'f1-score': 0.4244887903424489, 'support': 13244}, 'accuracy': 0.7837832855009494, 'macro avg': {'precision': 0.548868348743684, 'recall': 0.6486209745972489, 'f1-score': 0.5827415994126316, 'support': 162721}, 'weighted avg': {'precision': 0.8365036279785268, 'recall': 0.7837832855009494, 'f1-score': 0.8039442590088165, 'support': 162721}}
[[  8032   4139   1268]
 [ 12356 112614  11068]
 [  2058   4294   6892]]
training model: results/AAL/W8/deepOF_L2/h20
Epoch 1/50
1814/1814 - 43s - loss: 2.7259 - accuracy20: 0.5315 - val_loss: 2.4772 - val_accuracy20: 0.7916 - 43s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 40s - loss: 2.3646 - accuracy20: 0.6210 - val_loss: 2.3926 - val_accuracy20: 0.7836 - 40s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 41s - loss: 2.2551 - accuracy20: 0.6434 - val_loss: 2.3042 - val_accuracy20: 0.7770 - 41s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.2142 - accuracy20: 0.6506 - val_loss: 2.2922 - val_accuracy20: 0.7729 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 41s - loss: 2.1912 - accuracy20: 0.6538 - val_loss: 2.2783 - val_accuracy20: 0.7711 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 41s - loss: 2.1715 - accuracy20: 0.6557 - val_loss: 2.2895 - val_accuracy20: 0.7718 - 41s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 2.1569 - accuracy20: 0.6583 - val_loss: 2.2851 - val_accuracy20: 0.7657 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 41s - loss: 2.1454 - accuracy20: 0.6598 - val_loss: 2.2971 - val_accuracy20: 0.7609 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 40s - loss: 2.1349 - accuracy20: 0.6613 - val_loss: 2.2921 - val_accuracy20: 0.7590 - 40s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 40s - loss: 2.1258 - accuracy20: 0.6620 - val_loss: 2.2903 - val_accuracy20: 0.7619 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 41s - loss: 2.1159 - accuracy20: 0.6640 - val_loss: 2.2702 - val_accuracy20: 0.7604 - 41s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.1079 - accuracy20: 0.6647 - val_loss: 2.2995 - val_accuracy20: 0.7585 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 40s - loss: 2.1000 - accuracy20: 0.6652 - val_loss: 2.2540 - val_accuracy20: 0.7557 - 40s/epoch - 22ms/step
Epoch 14/50
1814/1814 - 41s - loss: 2.0916 - accuracy20: 0.6663 - val_loss: 2.2893 - val_accuracy20: 0.7551 - 41s/epoch - 23ms/step
Epoch 15/50
1814/1814 - 41s - loss: 2.0836 - accuracy20: 0.6669 - val_loss: 2.2771 - val_accuracy20: 0.7531 - 41s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 2.0771 - accuracy20: 0.6688 - val_loss: 2.2716 - val_accuracy20: 0.7545 - 41s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 40s - loss: 2.0696 - accuracy20: 0.6684 - val_loss: 2.2675 - val_accuracy20: 0.7535 - 40s/epoch - 22ms/step
Epoch 18/50
1814/1814 - 40s - loss: 2.0626 - accuracy20: 0.6702 - val_loss: 2.2711 - val_accuracy20: 0.7506 - 40s/epoch - 22ms/step
Epoch 19/50
1814/1814 - 41s - loss: 2.0561 - accuracy20: 0.6699 - val_loss: 2.2918 - val_accuracy20: 0.7467 - 41s/epoch - 22ms/step
Epoch 20/50
1814/1814 - 40s - loss: 2.0500 - accuracy20: 0.6700 - val_loss: 2.2928 - val_accuracy20: 0.7491 - 40s/epoch - 22ms/step
Epoch 21/50
1814/1814 - 40s - loss: 2.0412 - accuracy20: 0.6711 - val_loss: 2.3069 - val_accuracy20: 0.7500 - 40s/epoch - 22ms/step
Epoch 22/50
1814/1814 - 40s - loss: 2.0354 - accuracy20: 0.6710 - val_loss: 2.3004 - val_accuracy20: 0.7419 - 40s/epoch - 22ms/step
Epoch 23/50
1814/1814 - 40s - loss: 2.0270 - accuracy20: 0.6715 - val_loss: 2.3257 - val_accuracy20: 0.7410 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h20
Evaluating performance on  test set...
5918/5918 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6161869
{'0': {'precision': 0.4184790890183885, 'recall': 0.5686074816037604, 'f1-score': 0.4821265894856709, 'support': 178705}, '1': {'precision': 0.8799155567047863, 'recall': 0.8040715869392556, 'f1-score': 0.8402856289284228, 'support': 1159597}, '2': {'precision': 0.42610401708838724, 'recall': 0.5125324701048665, 'f1-score': 0.4653391326240934, 'support': 176701}, 'accuracy': 0.7422935796166741, 'macro avg': {'precision': 0.574832887603854, 'recall': 0.6284038462159608, 'f1-score': 0.5959171170127291, 'support': 1515003}, 'weighted avg': {'precision': 0.772556061826126, 'recall': 0.7422935796166741, 'f1-score': 0.754306768169013, 'support': 1515003}}
[[101613  63739  13353]
 [118574 932399 108624]
 [ 22628  63508  90565]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6669107
{'0': {'precision': 0.4107231868405749, 'recall': 0.6183225201281951, 'f1-score': 0.4935823438016735, 'support': 63965}, '1': {'precision': 0.8752415088808645, 'recall': 0.7814552203293043, 'f1-score': 0.8256937242701361, 'support': 336224}, '2': {'precision': 0.4666371616139264, 'recall': 0.4935557358631881, 'f1-score': 0.47971912370235, 'support': 64088}, 'accuracy': 0.7192387303269384, 'macro avg': {'precision': 0.5842006191117887, 'recall': 0.6311111587735625, 'f1-score': 0.5996650639247199, 'support': 464277}, 'weighted avg': {'precision': 0.7548402185370597, 'recall': 0.7192387303269384, 'f1-score': 0.7321798852196265, 'support': 464277}}
[[ 39551  17196   7218]
 [ 44544 262744  28936]
 [ 12201  20256  31631]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59046996
{'0': {'precision': 0.3954009031229841, 'recall': 0.5738201442810728, 'f1-score': 0.4681883537023724, 'support': 18159}, '1': {'precision': 0.8881451770857284, 'recall': 0.8234885391909924, 'f1-score': 0.8545956620424617, 'support': 126649}, '2': {'precision': 0.4356090606684619, 'recall': 0.4605593702897337, 'f1-score': 0.447736893520026, 'support': 17913}, 'accuracy': 0.7556738220635321, 'macro avg': {'precision': 0.5730517136257248, 'recall': 0.6192893512539329, 'f1-score': 0.59017363642162, 'support': 162721}, 'weighted avg': {'precision': 0.7833398801402083, 'recall': 0.7556738220635321, 'f1-score': 0.7666854879857015, 'support': 162721}}
[[ 10420   6287   1452]
 [ 13118 104294   9237]
 [  2815   6848   8250]]
training model: results/AAL/W8/deepOF_L2/h30
Epoch 1/50
1814/1814 - 44s - loss: 2.7976 - accuracy30: 0.5144 - val_loss: 2.5618 - val_accuracy30: 0.7523 - 44s/epoch - 25ms/step
Epoch 2/50
1814/1814 - 42s - loss: 2.4701 - accuracy30: 0.5966 - val_loss: 2.5371 - val_accuracy30: 0.7502 - 42s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 41s - loss: 2.3706 - accuracy30: 0.6178 - val_loss: 2.4773 - val_accuracy30: 0.7469 - 41s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.3306 - accuracy30: 0.6273 - val_loss: 2.4636 - val_accuracy30: 0.7424 - 41s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 40s - loss: 2.3051 - accuracy30: 0.6323 - val_loss: 2.4395 - val_accuracy30: 0.7376 - 40s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 41s - loss: 2.2864 - accuracy30: 0.6355 - val_loss: 2.4296 - val_accuracy30: 0.7356 - 41s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 41s - loss: 2.2708 - accuracy30: 0.6370 - val_loss: 2.4255 - val_accuracy30: 0.7292 - 41s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 41s - loss: 2.2594 - accuracy30: 0.6393 - val_loss: 2.4129 - val_accuracy30: 0.7296 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 2.2498 - accuracy30: 0.6415 - val_loss: 2.4103 - val_accuracy30: 0.7281 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 2.2390 - accuracy30: 0.6432 - val_loss: 2.3797 - val_accuracy30: 0.7246 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 2.2279 - accuracy30: 0.6442 - val_loss: 2.3890 - val_accuracy30: 0.7222 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.2191 - accuracy30: 0.6451 - val_loss: 2.3863 - val_accuracy30: 0.7146 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 40s - loss: 2.2126 - accuracy30: 0.6462 - val_loss: 2.3794 - val_accuracy30: 0.7155 - 40s/epoch - 22ms/step
Epoch 14/50
1814/1814 - 41s - loss: 2.2037 - accuracy30: 0.6468 - val_loss: 2.3777 - val_accuracy30: 0.7150 - 41s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 2.1953 - accuracy30: 0.6488 - val_loss: 2.3996 - val_accuracy30: 0.7085 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 2.1885 - accuracy30: 0.6490 - val_loss: 2.3766 - val_accuracy30: 0.7148 - 41s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 41s - loss: 2.1806 - accuracy30: 0.6489 - val_loss: 2.3925 - val_accuracy30: 0.7160 - 41s/epoch - 22ms/step
Epoch 18/50
1814/1814 - 41s - loss: 2.1747 - accuracy30: 0.6500 - val_loss: 2.3744 - val_accuracy30: 0.7117 - 41s/epoch - 22ms/step
Epoch 19/50
1814/1814 - 41s - loss: 2.1679 - accuracy30: 0.6509 - val_loss: 2.3780 - val_accuracy30: 0.7074 - 41s/epoch - 22ms/step
Epoch 20/50
1814/1814 - 40s - loss: 2.1619 - accuracy30: 0.6514 - val_loss: 2.3866 - val_accuracy30: 0.7081 - 40s/epoch - 22ms/step
Epoch 21/50
1814/1814 - 40s - loss: 2.1542 - accuracy30: 0.6512 - val_loss: 2.4434 - val_accuracy30: 0.7102 - 40s/epoch - 22ms/step
Epoch 22/50
1814/1814 - 41s - loss: 2.1476 - accuracy30: 0.6516 - val_loss: 2.4262 - val_accuracy30: 0.7063 - 41s/epoch - 22ms/step
Epoch 23/50
1814/1814 - 40s - loss: 2.1388 - accuracy30: 0.6529 - val_loss: 2.4230 - val_accuracy30: 0.7101 - 40s/epoch - 22ms/step
Epoch 24/50
1814/1814 - 40s - loss: 2.1331 - accuracy30: 0.6532 - val_loss: 2.4263 - val_accuracy30: 0.7155 - 40s/epoch - 22ms/step
Epoch 25/50
1814/1814 - 40s - loss: 2.1248 - accuracy30: 0.6536 - val_loss: 2.4333 - val_accuracy30: 0.7205 - 40s/epoch - 22ms/step
Epoch 26/50
1814/1814 - 41s - loss: 2.1210 - accuracy30: 0.6539 - val_loss: 2.4361 - val_accuracy30: 0.7107 - 41s/epoch - 22ms/step
Epoch 27/50
1814/1814 - 40s - loss: 2.1101 - accuracy30: 0.6558 - val_loss: 2.4511 - val_accuracy30: 0.7089 - 40s/epoch - 22ms/step
Epoch 28/50
1814/1814 - 40s - loss: 2.1036 - accuracy30: 0.6561 - val_loss: 2.4748 - val_accuracy30: 0.7078 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h30
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70126414
{'0': {'precision': 0.42808881473488986, 'recall': 0.5729980389895029, 'f1-score': 0.4900554840848283, 'support': 216725}, '1': {'precision': 0.8374557161958546, 'recall': 0.7646258252498801, 'f1-score': 0.7993853640291432, 'support': 1084520}, '2': {'precision': 0.4507864957905859, 'recall': 0.4949756266432134, 'f1-score': 0.4718487301268758, 'support': 213758}, 'accuracy': 0.6991669323427082, 'macro avg': {'precision': 0.5721103422404434, 'recall': 0.6108664969608655, 'f1-score': 0.5870965260802824, 'support': 1515003}, 'weighted avg': {'precision': 0.7243379989804319, 'recall': 0.6991669323427082, 'f1-score': 0.7089214547031468, 'support': 1515003}}
[[124183  76813  15729]
 [142090 829252 113178]
 [ 23814  84139 105805]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72906303
{'0': {'precision': 0.42695638739696645, 'recall': 0.6195895866853058, 'f1-score': 0.5055444063638271, 'support': 75826}, '1': {'precision': 0.8355544748820893, 'recall': 0.7475566333206433, 'f1-score': 0.7891098571192181, 'support': 312581}, '2': {'precision': 0.4922967591413132, 'recall': 0.48391986292342165, 'f1-score': 0.48807237003901655, 'support': 75870}, 'accuracy': 0.683574676324694, 'macro avg': {'precision': 0.5849358738067897, 'recall': 0.6170220276431235, 'f1-score': 0.5942422111740205, 'support': 464277}, 'weighted avg': {'precision': 0.7127284002005961, 'recall': 0.683574676324694, 'f1-score': 0.6936036226648877, 'support': 464277}}
[[ 46981  20614   8231]
 [ 49276 233672  29633]
 [ 13780  25375  36715]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67412716
{'0': {'precision': 0.40079201647394264, 'recall': 0.5751238805291631, 'f1-score': 0.47238714013666405, 'support': 21997}, '1': {'precision': 0.8515391348748997, 'recall': 0.7842231664511361, 'f1-score': 0.8164960351113404, 'support': 119086}, '2': {'precision': 0.45899273878234964, 'recall': 0.45572603752657365, 'f1-score': 0.45735355502991515, 'support': 21638}, 'accuracy': 0.7122743837611617, 'macro avg': {'precision': 0.5704412967103973, 'recall': 0.605024361502291, 'f1-score': 0.5820789100926399, 'support': 162721}, 'weighted avg': {'precision': 0.7384068207782777, 'recall': 0.7122743837611617, 'f1-score': 0.722221243616943, 'support': 162721}}
[[12651  7453  1893]
 [15966 93390  9730]
 [ 2948  8829  9861]]
training model: results/AAL/W8/deepOF_L2/h50
Epoch 1/50
1814/1814 - 43s - loss: 2.9099 - accuracy50: 0.5022 - val_loss: 2.8643 - val_accuracy50: 0.6874 - 43s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 40s - loss: 2.6474 - accuracy50: 0.5660 - val_loss: 2.8105 - val_accuracy50: 0.6944 - 40s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 40s - loss: 2.5602 - accuracy50: 0.5843 - val_loss: 2.7508 - val_accuracy50: 0.6926 - 40s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 40s - loss: 2.5264 - accuracy50: 0.5913 - val_loss: 2.7167 - val_accuracy50: 0.6887 - 40s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 41s - loss: 2.5005 - accuracy50: 0.5983 - val_loss: 2.6820 - val_accuracy50: 0.6885 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 41s - loss: 2.4789 - accuracy50: 0.6014 - val_loss: 2.6758 - val_accuracy50: 0.6888 - 41s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 2.4662 - accuracy50: 0.6041 - val_loss: 2.6516 - val_accuracy50: 0.6864 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 40s - loss: 2.4518 - accuracy50: 0.6072 - val_loss: 2.6432 - val_accuracy50: 0.6820 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 40s - loss: 2.4415 - accuracy50: 0.6082 - val_loss: 2.6513 - val_accuracy50: 0.6803 - 40s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 40s - loss: 2.4318 - accuracy50: 0.6099 - val_loss: 2.6582 - val_accuracy50: 0.6795 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 2.4215 - accuracy50: 0.6117 - val_loss: 2.6498 - val_accuracy50: 0.6753 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 40s - loss: 2.4118 - accuracy50: 0.6134 - val_loss: 2.6596 - val_accuracy50: 0.6761 - 40s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 41s - loss: 2.4022 - accuracy50: 0.6147 - val_loss: 2.6648 - val_accuracy50: 0.6764 - 41s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 40s - loss: 2.3933 - accuracy50: 0.6157 - val_loss: 2.6564 - val_accuracy50: 0.6780 - 40s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 2.3863 - accuracy50: 0.6162 - val_loss: 2.6687 - val_accuracy50: 0.6766 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 40s - loss: 2.3777 - accuracy50: 0.6186 - val_loss: 2.6966 - val_accuracy50: 0.6739 - 40s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 40s - loss: 2.3673 - accuracy50: 0.6196 - val_loss: 2.7103 - val_accuracy50: 0.6707 - 40s/epoch - 22ms/step
Epoch 18/50
1814/1814 - 40s - loss: 2.3593 - accuracy50: 0.6212 - val_loss: 2.7147 - val_accuracy50: 0.6741 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h50
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77147585
{'0': {'precision': 0.49247492555309935, 'recall': 0.48040019389515404, 'f1-score': 0.4863626276276547, 'support': 280564}, '1': {'precision': 0.7354248407811036, 'recall': 0.8161489127428521, 'f1-score': 0.7736869521598488, 'support': 958145}, '2': {'precision': 0.5457185874316018, 'recall': 0.3515783911340818, 'f1-score': 0.4276462922852061, 'support': 276294}, 'accuracy': 0.6692468595771758, 'macro avg': {'precision': 0.591206117921935, 'recall': 0.549375832590696, 'f1-score': 0.5625652906909032, 'support': 1515003}, 'weighted avg': {'precision': 0.6558357577370587, 'recall': 0.6692468595771758, 'f1-score': 0.6573691495763192, 'support': 1515003}}
[[134783 128750  17031]
 [112324 781989  63832]
 [ 26578 152577  97139]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7980771
{'0': {'precision': 0.4791464121222834, 'recall': 0.5176324556005856, 'f1-score': 0.4976464528500104, 'support': 94258}, '1': {'precision': 0.7258901637400709, 'recall': 0.8014733688221776, 'f1-score': 0.7618116087290122, 'support': 275016}, '2': {'precision': 0.5555309885026192, 'recall': 0.34381019546751157, 'f1-score': 0.4247491856253942, 'support': 95003}, 'accuracy': 0.6501980498710899, 'macro avg': {'precision': 0.5868558547883245, 'recall': 0.5543053399634249, 'f1-score': 0.5614024157348056, 'support': 464277}, 'weighted avg': {'precision': 0.6409361271087646, 'recall': 0.6501980498710899, 'f1-score': 0.6392088938735359, 'support': 464277}}
[[ 48791  36059   9408]
 [ 37873 220418  16725]
 [ 15165  47175  32663]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7476573
{'0': {'precision': 0.4607699966810488, 'recall': 0.4888036053799028, 'f1-score': 0.47437299255108323, 'support': 28402}, '1': {'precision': 0.7592023215241912, 'recall': 0.825515330797765, 'f1-score': 0.7909713817816989, 'support': 106485}, '2': {'precision': 0.5431121689973222, 'recall': 0.32790831357332756, 'f1-score': 0.4089249311140482, 'support': 27834}, 'accuracy': 0.6816268336600685, 'macro avg': {'precision': 0.5876948290675207, 'recall': 0.5474090832503318, 'f1-score': 0.5580897684822768, 'support': 162721}, 'weighted avg': {'precision': 0.6701497210876907, 'recall': 0.6816268336600685, 'f1-score': 0.6703605917864841, 'support': 162721}}
[[13883 12475  2044]
 [12946 87905  5634]
 [ 3301 15406  9127]]
training model: results/AAL/W8/deepOF_L2/h100
Epoch 1/50
1814/1814 - 44s - loss: 3.0650 - accuracy100: 0.4726 - val_loss: 3.1612 - val_accuracy100: 0.5570 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 40s - loss: 2.8965 - accuracy100: 0.5195 - val_loss: 3.0625 - val_accuracy100: 0.5656 - 40s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 40s - loss: 2.8294 - accuracy100: 0.5318 - val_loss: 3.0109 - val_accuracy100: 0.5707 - 40s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.8020 - accuracy100: 0.5378 - val_loss: 3.0022 - val_accuracy100: 0.5730 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 40s - loss: 2.7824 - accuracy100: 0.5420 - val_loss: 3.0030 - val_accuracy100: 0.5697 - 40s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 40s - loss: 2.7669 - accuracy100: 0.5454 - val_loss: 2.9844 - val_accuracy100: 0.5711 - 40s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 2.7551 - accuracy100: 0.5471 - val_loss: 3.0058 - val_accuracy100: 0.5708 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 40s - loss: 2.7431 - accuracy100: 0.5504 - val_loss: 3.0105 - val_accuracy100: 0.5704 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 40s - loss: 2.7330 - accuracy100: 0.5517 - val_loss: 3.0340 - val_accuracy100: 0.5696 - 40s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 2.7236 - accuracy100: 0.5537 - val_loss: 3.0287 - val_accuracy100: 0.5716 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 41s - loss: 2.7129 - accuracy100: 0.5555 - val_loss: 3.0383 - val_accuracy100: 0.5701 - 41s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.7034 - accuracy100: 0.5578 - val_loss: 3.0535 - val_accuracy100: 0.5678 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 41s - loss: 2.7021 - accuracy100: 0.5578 - val_loss: 3.0705 - val_accuracy100: 0.5666 - 41s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 40s - loss: 2.6880 - accuracy100: 0.5599 - val_loss: 3.0852 - val_accuracy100: 0.5672 - 40s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 41s - loss: 2.6774 - accuracy100: 0.5621 - val_loss: 3.1006 - val_accuracy100: 0.5655 - 41s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 2.6672 - accuracy100: 0.5627 - val_loss: 3.1085 - val_accuracy100: 0.5603 - 41s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h100
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94831604
{'0': {'precision': 0.522378650977096, 'recall': 0.3550847523651974, 'f1-score': 0.42278388640833137, 'support': 385063}, '1': {'precision': 0.5704772077421933, 'recall': 0.8072302335819004, 'f1-score': 0.6685112322777255, 'support': 749630}, '2': {'precision': 0.5200571354369562, 'recall': 0.2632694380899792, 'f1-score': 0.34957361194759395, 'support': 380310}, 'accuracy': 0.555759955590847, 'macro avg': {'precision': 0.5376376647187485, 'recall': 0.47519480801235897, 'f1-score': 0.48028957687788365, 'support': 1515003}, 'weighted avg': {'precision': 0.5455952555202879, 'recall': 0.555759955590847, 'f1-score': 0.5259929168880801, 'support': 1515003}}
[[136730 217004  31329]
 [ 83434 605124  61072]
 [ 41581 238605 100124]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95564324
{'0': {'precision': 0.5006537893203781, 'recall': 0.3834348335830131, 'f1-score': 0.43427343688765324, 'support': 122824}, '1': {'precision': 0.5656979483097516, 'recall': 0.8016491636778836, 'f1-score': 0.6633155300230859, 'support': 217201}, '2': {'precision': 0.519298245614035, 'recall': 0.260856968097093, 'f1-score': 0.34727080844498487, 'support': 124252}, 'accuracy': 0.5462816379015114, 'macro avg': {'precision': 0.5285499944147216, 'recall': 0.4819803217859966, 'f1-score': 0.48161992511857465, 'support': 464277}, 'weighted avg': {'precision': 0.5360728761156541, 'recall': 0.5462816379015114, 'f1-score': 0.5181413025838878, 'support': 464277}}
[[ 47095  61327  14402]
 [ 27481 174119  15601]
 [ 19491  72349  32412]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.92453206
{'0': {'precision': 0.48386770165372933, 'recall': 0.36554396879222867, 'f1-score': 0.41646453936761996, 'support': 39221}, '1': {'precision': 0.6016128470407914, 'recall': 0.813696274396636, 'f1-score': 0.69176425821246, 'support': 84899}, '2': {'precision': 0.5209987406231178, 'recall': 0.24649620476153467, 'f1-score': 0.3346581316826111, 'support': 38601}, 'accuracy': 0.571124808721677, 'macro avg': {'precision': 0.5354930964392128, 'recall': 0.4752454826501331, 'f1-score': 0.4809623097542304, 'support': 162721}, 'weighted avg': {'precision': 0.5541090370282266, 'recall': 0.571124808721677, 'f1-score': 0.5406947351454178, 'support': 162721}}
[[14337 21623  3261]
 [10330 69082  5487]
 [ 4963 24123  9515]]
training model: results/AAL/W8/deepOF_L2/h200
Epoch 1/50
1814/1814 - 44s - loss: 3.1515 - accuracy200: 0.4394 - val_loss: 3.2923 - val_accuracy200: 0.4341 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 42s - loss: 3.0567 - accuracy200: 0.4698 - val_loss: 3.2445 - val_accuracy200: 0.4419 - 42s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 42s - loss: 3.0201 - accuracy200: 0.4787 - val_loss: 3.2149 - val_accuracy200: 0.4473 - 42s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.9935 - accuracy200: 0.4831 - val_loss: 3.1977 - val_accuracy200: 0.4522 - 41s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 41s - loss: 2.9782 - accuracy200: 0.4875 - val_loss: 3.1913 - val_accuracy200: 0.4546 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 41s - loss: 2.9673 - accuracy200: 0.4897 - val_loss: 3.1994 - val_accuracy200: 0.4563 - 41s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 2.9584 - accuracy200: 0.4925 - val_loss: 3.2026 - val_accuracy200: 0.4572 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 41s - loss: 2.9499 - accuracy200: 0.4943 - val_loss: 3.2010 - val_accuracy200: 0.4598 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 2.9417 - accuracy200: 0.4961 - val_loss: 3.2079 - val_accuracy200: 0.4594 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 40s - loss: 2.9335 - accuracy200: 0.4982 - val_loss: 3.2405 - val_accuracy200: 0.4591 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 2.9300 - accuracy200: 0.4991 - val_loss: 3.2271 - val_accuracy200: 0.4585 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.9231 - accuracy200: 0.5010 - val_loss: 3.1962 - val_accuracy200: 0.4622 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 40s - loss: 2.9154 - accuracy200: 0.5033 - val_loss: 3.2304 - val_accuracy200: 0.4617 - 40s/epoch - 22ms/step
Epoch 14/50
1814/1814 - 40s - loss: 2.9058 - accuracy200: 0.5051 - val_loss: 3.2271 - val_accuracy200: 0.4605 - 40s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 2.8990 - accuracy200: 0.5067 - val_loss: 3.2705 - val_accuracy200: 0.4607 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h200
Evaluating performance on  test set...
5918/5918 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.078387
{'0': {'precision': 0.5336009912656859, 'recall': 0.18261507632953072, 'f1-score': 0.2721066732743801, 'support': 481072}, '1': {'precision': 0.40422675744230685, 'recall': 0.9062731900320371, 'f1-score': 0.5590841474958821, 'support': 556543}, '2': {'precision': 0.5382553606237817, 'recall': 0.11568158395267582, 'f1-score': 0.19043497451671415, 'support': 477388}, 'accuracy': 0.42736285010656744, 'macro avg': {'precision': 0.49202770311059146, 'recall': 0.40152328343808125, 'f1-score': 0.34054193176232544, 'support': 1515003}, 'weighted avg': {'precision': 0.48754142297727837, 'recall': 0.42736285010656744, 'f1-score': 0.3517937864412404, 'support': 1515003}}
[[ 87851 364455  28766]
 [ 33554 504380  18609]
 [ 43233 378930  55225]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0626352
{'0': {'precision': 0.524191022534329, 'recall': 0.21421113259277721, 'f1-score': 0.30413657883410644, 'support': 148447}, '1': {'precision': 0.4115750535755723, 'recall': 0.9096844264767996, 'f1-score': 0.5667371507513603, 'support': 165730}, '2': {'precision': 0.5378863008925461, 'recall': 0.13369753497668221, 'f1-score': 0.2141626069185578, 'support': 150100}, 'accuracy': 0.436439883948591, 'macro avg': {'precision': 0.4912174590008158, 'recall': 0.4191976980154197, 'f1-score': 0.36167877883467486, 'support': 464277}, 'weighted avg': {'precision': 0.48841887949479357, 'recall': 0.436439883948591, 'f1-score': 0.36878699140962196, 'support': 464277}}
[[ 31799 104369  12279]
 [ 10006 150762   4962]
 [ 18858 111174  20068]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0510659
{'0': {'precision': 0.5105879702635728, 'recall': 0.18413356080916402, 'f1-score': 0.27065918318605203, 'support': 49236}, '1': {'precision': 0.44188095573045855, 'recall': 0.9166308287768016, 'f1-score': 0.5963020877567231, 'support': 65108}, '2': {'precision': 0.5373511003432263, 'recall': 0.11003162659941708, 'f1-score': 0.18266046703155292, 'support': 48377}, 'accuracy': 0.45519017213512697, 'macro avg': {'precision': 0.49660667544575254, 'recall': 0.4035986720617942, 'f1-score': 0.34987391265810935, 'support': 162721}, 'weighted avg': {'precision': 0.49105357483607043, 'recall': 0.45519017213512697, 'f1-score': 0.3747935256457287, 'support': 162721}}
[[ 9066 37257  2913]
 [ 3758 59680  1670]
 [ 4932 38122  5323]]
training model: results/AAL/W8/deepOF_L2/h300
Epoch 1/50
1814/1814 - 44s - loss: 3.2037 - accuracy300: 0.4137 - val_loss: 3.3311 - val_accuracy300: 0.3905 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 42s - loss: 3.1424 - accuracy300: 0.4376 - val_loss: 3.2971 - val_accuracy300: 0.3961 - 42s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 42s - loss: 3.1205 - accuracy300: 0.4439 - val_loss: 3.2824 - val_accuracy300: 0.3995 - 42s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 42s - loss: 3.1059 - accuracy300: 0.4481 - val_loss: 3.2759 - val_accuracy300: 0.4019 - 42s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 42s - loss: 3.0945 - accuracy300: 0.4516 - val_loss: 3.2718 - val_accuracy300: 0.4036 - 42s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 42s - loss: 3.0843 - accuracy300: 0.4547 - val_loss: 3.2628 - val_accuracy300: 0.4062 - 42s/epoch - 23ms/step
Epoch 7/50
1814/1814 - 41s - loss: 3.0762 - accuracy300: 0.4568 - val_loss: 3.2683 - val_accuracy300: 0.4066 - 41s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 41s - loss: 3.0675 - accuracy300: 0.4594 - val_loss: 3.2626 - val_accuracy300: 0.4083 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 3.0604 - accuracy300: 0.4620 - val_loss: 3.2707 - val_accuracy300: 0.4095 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 3.0545 - accuracy300: 0.4634 - val_loss: 3.2807 - val_accuracy300: 0.4092 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 41s - loss: 3.0481 - accuracy300: 0.4651 - val_loss: 3.2809 - val_accuracy300: 0.4109 - 41s/epoch - 23ms/step
Epoch 12/50
1814/1814 - 41s - loss: 3.0426 - accuracy300: 0.4674 - val_loss: 3.2852 - val_accuracy300: 0.4127 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 41s - loss: 3.0358 - accuracy300: 0.4692 - val_loss: 3.3040 - val_accuracy300: 0.4132 - 41s/epoch - 22ms/step
Epoch 14/50
1814/1814 - 41s - loss: 3.0291 - accuracy300: 0.4712 - val_loss: 3.3124 - val_accuracy300: 0.4147 - 41s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 3.0214 - accuracy300: 0.4743 - val_loss: 3.3370 - val_accuracy300: 0.4139 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 3.0191 - accuracy300: 0.4755 - val_loss: 3.3402 - val_accuracy300: 0.4126 - 41s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 40s - loss: 3.0109 - accuracy300: 0.4776 - val_loss: 3.3781 - val_accuracy300: 0.4138 - 40s/epoch - 22ms/step
Epoch 18/50
1814/1814 - 40s - loss: 3.0025 - accuracy300: 0.4816 - val_loss: 3.4135 - val_accuracy300: 0.4100 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h300
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126654
{'0': {'precision': 0.5157263526160674, 'recall': 0.14797989957600058, 'f1-score': 0.22997262302943483, 'support': 512029}, '1': {'precision': 0.3569231456437492, 'recall': 0.9294129915551482, 'f1-score': 0.5157734420342073, 'support': 498647}, '2': {'precision': 0.539179640374562, 'recall': 0.07443979798821003, 'f1-score': 0.13081861818435245, 'support': 504327}, 'accuracy': 0.3806995761724564, 'macro avg': {'precision': 0.4706097128781262, 'recall': 0.383944229706453, 'f1-score': 0.2921882277493315, 'support': 1515003}, 'weighted avg': {'precision': 0.47126530765988767, 'recall': 0.3806995761724564, 'f1-score': 0.2910336765011223, 'support': 1515003}}
[[ 75770 412633  23626]
 [ 26738 463449   8460]
 [ 44411 422374  37542]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0888554
{'0': {'precision': 0.505649370046917, 'recall': 0.1861018593371059, 'f1-score': 0.27206973819811475, 'support': 154625}, '1': {'precision': 0.3718294331500269, 'recall': 0.9237902699882614, 'f1-score': 0.5302364754213418, 'support': 153340}, '2': {'precision': 0.5302049009582245, 'recall': 0.08955806336045857, 'f1-score': 0.15323317735270775, 'support': 156312}, 'accuracy': 0.3972391481809351, 'macro avg': {'precision': 0.46922790138505616, 'recall': 0.39981673089527536, 'f1-score': 0.31851313032405476, 'support': 464277}, 'weighted avg': {'precision': 0.46971904186791863, 'recall': 0.3972391481809351, 'f1-score': 0.31732657191363883, 'support': 464277}}
[[ 28776 116107   9742]
 [  9024 141654   2662]
 [ 19109 123204  13999]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0892295
{'0': {'precision': 0.5041062963210255, 'recall': 0.1433562450157597, 'f1-score': 0.2232307851514569, 'support': 52666}, '1': {'precision': 0.39231047110405937, 'recall': 0.9395260470560296, 'f1-score': 0.553500224853845, 'support': 58951}, '2': {'precision': 0.5412033511043413, 'recall': 0.06952489041953663, 'f1-score': 0.12322044772754859, 'support': 51104}, 'accuracy': 0.40860737089865473, 'macro avg': {'precision': 0.47920670617647537, 'recall': 0.38413572749710867, 'f1-score': 0.29998381924428347, 'support': 162721}, 'weighted avg': {'precision': 0.47525527030275616, 'recall': 0.40860737089865473, 'f1-score': 0.3114725330277855, 'support': 162721}}
[[ 7550 42814  2302]
 [ 2855 55386   710]
 [ 4572 42979  3553]]
training model: results/AAL/W8/deepOF_L2/h500
Epoch 1/50
1814/1814 - 44s - loss: 3.2664 - accuracy500: 0.3865 - val_loss: 3.3281 - val_accuracy500: 0.3511 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 41s - loss: 3.2390 - accuracy500: 0.4004 - val_loss: 3.3103 - val_accuracy500: 0.3528 - 41s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 41s - loss: 3.2264 - accuracy500: 0.4071 - val_loss: 3.3080 - val_accuracy500: 0.3530 - 41s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 41s - loss: 3.2190 - accuracy500: 0.4103 - val_loss: 3.3062 - val_accuracy500: 0.3538 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 41s - loss: 3.2135 - accuracy500: 0.4131 - val_loss: 3.3079 - val_accuracy500: 0.3540 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 42s - loss: 3.2087 - accuracy500: 0.4153 - val_loss: 3.3063 - val_accuracy500: 0.3555 - 42s/epoch - 23ms/step
Epoch 7/50
1814/1814 - 42s - loss: 3.2042 - accuracy500: 0.4173 - val_loss: 3.3010 - val_accuracy500: 0.3560 - 42s/epoch - 23ms/step
Epoch 8/50
1814/1814 - 41s - loss: 3.1983 - accuracy500: 0.4200 - val_loss: 3.3016 - val_accuracy500: 0.3580 - 41s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 3.1934 - accuracy500: 0.4224 - val_loss: 3.3038 - val_accuracy500: 0.3598 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 3.1893 - accuracy500: 0.4243 - val_loss: 3.3103 - val_accuracy500: 0.3625 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 3.1858 - accuracy500: 0.4254 - val_loss: 3.3111 - val_accuracy500: 0.3669 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 41s - loss: 3.1809 - accuracy500: 0.4278 - val_loss: 3.3134 - val_accuracy500: 0.3695 - 41s/epoch - 22ms/step
Epoch 13/50
1814/1814 - 41s - loss: 3.1767 - accuracy500: 0.4302 - val_loss: 3.3234 - val_accuracy500: 0.3697 - 41s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 41s - loss: 3.1724 - accuracy500: 0.4309 - val_loss: 3.3341 - val_accuracy500: 0.3705 - 41s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 3.1683 - accuracy500: 0.4336 - val_loss: 3.3287 - val_accuracy500: 0.3690 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 41s - loss: 3.1643 - accuracy500: 0.4347 - val_loss: 3.3394 - val_accuracy500: 0.3683 - 41s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 40s - loss: 3.1576 - accuracy500: 0.4380 - val_loss: 3.3568 - val_accuracy500: 0.3679 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h500
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112244
{'0': {'precision': 0.4258245005713385, 'recall': 0.04149675536612525, 'f1-score': 0.07562393066698389, 'support': 520860}, '1': {'precision': 0.32534337737031516, 'recall': 0.9497666696580813, 'f1-score': 0.48466451462825816, 'support': 490292}, '2': {'precision': 0.44321354862207113, 'recall': 0.028982774669495545, 'f1-score': 0.05440770195175475, 'support': 503851}, 'accuracy': 0.3312732714060632, 'macro avg': {'precision': 0.3981271421879083, 'recall': 0.3400820665645674, 'f1-score': 0.2048987157489989, 'support': 1515003}, 'weighted avg': {'precision': 0.3990895029462075, 'recall': 0.3312732714060632, 'f1-score': 0.20094348972867826, 'support': 1515003}}
[[ 21614 490843   8403]
 [ 14687 465663   9942]
 [ 14457 474791  14603]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1070771
{'0': {'precision': 0.42121604139715396, 'recall': 0.05272328050210181, 'f1-score': 0.09371618043242995, 'support': 154391}, '1': {'precision': 0.33436585864667184, 'recall': 0.9497046633815227, 'f1-score': 0.4945971576868561, 'support': 153215}, '2': {'precision': 0.4553361301545073, 'recall': 0.02840346969126386, 'f1-score': 0.053471437840955524, 'support': 156671}, 'accuracy': 0.3405273145126724, 'macro avg': {'precision': 0.40363934339944435, 'recall': 0.34361047119162946, 'f1-score': 0.21392825865341383, 'support': 464277}, 'weighted avg': {'precision': 0.4040686868557663, 'recall': 0.3405273145126724, 'f1-score': 0.21242935137022786, 'support': 464277}}
[[  8140 143632   2619]
 [  5002 145509   2704]
 [  6183 146038   4450]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014445
{'0': {'precision': 0.414568345323741, 'recall': 0.04281919340157159, 'f1-score': 0.07762118839554814, 'support': 53831}, '1': {'precision': 0.35246311334410885, 'recall': 0.9540359138349088, 'f1-score': 0.5147534922523427, 'support': 56914}, '2': {'precision': 0.42342342342342343, 'recall': 0.025319378174542096, 'f1-score': 0.04778156996587031, 'support': 51976}, 'accuracy': 0.3559405362553082, 'macro avg': {'precision': 0.3968182940304244, 'recall': 0.3407248284703408, 'f1-score': 0.2133854168712537, 'support': 162721}, 'weighted avg': {'precision': 0.3956746215045677, 'recall': 0.3559405362553082, 'f1-score': 0.22098316339695953, 'support': 162721}}
[[ 2305 50710   816]
 [ 1640 54298   976]
 [ 1615 49045  1316]]
training model: results/AAL/W8/deepOF_L2/h1000
Epoch 1/50
1814/1814 - 44s - loss: 3.1958 - accuracy1000: 0.4215 - val_loss: 4.5014 - val_accuracy1000: 0.2728 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 40s - loss: 3.2013 - accuracy1000: 0.4135 - val_loss: 3.9355 - val_accuracy1000: 0.2734 - 40s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 40s - loss: 3.1881 - accuracy1000: 0.4129 - val_loss: 4.0754 - val_accuracy1000: 0.2732 - 40s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 40s - loss: 3.1828 - accuracy1000: 0.4119 - val_loss: 4.2724 - val_accuracy1000: 0.2728 - 40s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 41s - loss: 3.1819 - accuracy1000: 0.4097 - val_loss: 4.3451 - val_accuracy1000: 0.2729 - 41s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 40s - loss: 3.1786 - accuracy1000: 0.4127 - val_loss: 4.5083 - val_accuracy1000: 0.2728 - 40s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 3.1760 - accuracy1000: 0.4152 - val_loss: 4.4226 - val_accuracy1000: 0.2728 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 40s - loss: 3.1726 - accuracy1000: 0.4157 - val_loss: 4.5948 - val_accuracy1000: 0.2728 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 40s - loss: 3.1720 - accuracy1000: 0.4188 - val_loss: 4.5209 - val_accuracy1000: 0.2724 - 40s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 40s - loss: 3.1678 - accuracy1000: 0.4216 - val_loss: 4.5586 - val_accuracy1000: 0.2727 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 3.1628 - accuracy1000: 0.4255 - val_loss: 4.6323 - val_accuracy1000: 0.2730 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 40s - loss: 3.1585 - accuracy1000: 0.4273 - val_loss: 4.7330 - val_accuracy1000: 0.2729 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepOF_L2/h1000
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.3508439
{'0': {'precision': 0.4120496261046907, 'recall': 0.008227345531545227, 'f1-score': 0.01613257389244507, 'support': 589376}, '1': {'precision': 0.24454469968815412, 'recall': 0.9885540982102624, 'f1-score': 0.3920945596319328, 'support': 370613}, '2': {'precision': 0.40106740462542007, 'recall': 0.003655763638394707, 'f1-score': 0.007245484070826482, 'support': 555014}, 'accuracy': 0.24636848903929562, 'macro avg': {'precision': 0.35255391013942167, 'recall': 0.33347906912673414, 'f1-score': 0.13849087253173478, 'support': 1515003}, 'weighted avg': {'precision': 0.36704985384938305, 'recall': 0.24636848903929562, 'f1-score': 0.10484787026520007, 'support': 1515003}}
[[  4849 582668   1859]
 [  3071 366371   1171]
 [  3848 549137   2029]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2524211
{'0': {'precision': 0.38183161004431315, 'recall': 0.010059931506849315, 'f1-score': 0.019603382246995035, 'support': 154176}, '1': {'precision': 0.33178846908092563, 'recall': 0.990374046347666, 'f1-score': 0.49705642811792566, 'support': 153751}, '2': {'precision': 0.3843137254901961, 'recall': 0.0031339942436840423, 'f1-score': 0.006217287866772403, 'support': 156350}, 'accuracy': 0.33237054603178706, 'macro avg': {'precision': 0.36597793487181157, 'recall': 0.33452265736606646, 'f1-score': 0.17429236607723106, 'support': 464277}, 'weighted avg': {'precision': 0.3660950902160684, 'recall': 0.33237054603178706, 'f1-score': 0.1732098874138537, 'support': 464277}}
[[  1551 152185    440]
 [  1135 152271    345]
 [  1376 154484    490]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.3142086
{'0': {'precision': 0.37290167865707435, 'recall': 0.01030040075514192, 'f1-score': 0.020047055790118284, 'support': 60386}, '1': {'precision': 0.2722352999788265, 'recall': 0.9866386801182657, 'f1-score': 0.4267271884227737, 'support': 44307}, '2': {'precision': 0.3705263157894737, 'recall': 0.0030330185427724548, 'f1-score': 0.006016785463993301, 'support': 58028}, 'accuracy': 0.2735541202426239, 'macro avg': {'precision': 0.33855443147512493, 'recall': 0.3333240331387267, 'f1-score': 0.15093034322562843, 'support': 162721}, 'weighted avg': {'precision': 0.3446443375850661, 'recall': 0.2735541202426239, 'f1-score': 0.12577789637044096, 'support': 162721}}
[[  622 59592   172]
 [  465 43715   127]
 [  581 57271   176]]
training model: results/AAL/W8/deepVOL_L2/h10
Epoch 1/50
1814/1814 - 42s - loss: 2.7091 - accuracy10: 0.5669 - val_loss: 2.1960 - val_accuracy10: 0.7613 - 42s/epoch - 23ms/step
Epoch 2/50
1814/1814 - 43s - loss: 2.3668 - accuracy10: 0.6381 - val_loss: 2.0821 - val_accuracy10: 0.7470 - 43s/epoch - 24ms/step
Epoch 3/50
1814/1814 - 42s - loss: 2.2803 - accuracy10: 0.6580 - val_loss: 2.1583 - val_accuracy10: 0.7361 - 42s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.2315 - accuracy10: 0.6691 - val_loss: 2.0620 - val_accuracy10: 0.7441 - 41s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 43s - loss: 2.1925 - accuracy10: 0.6784 - val_loss: 2.0697 - val_accuracy10: 0.7693 - 43s/epoch - 24ms/step
Epoch 6/50
1814/1814 - 42s - loss: 2.1651 - accuracy10: 0.6814 - val_loss: 2.0738 - val_accuracy10: 0.7697 - 42s/epoch - 23ms/step
Epoch 7/50
1814/1814 - 41s - loss: 2.1772 - accuracy10: 0.6782 - val_loss: 2.0309 - val_accuracy10: 0.7657 - 41s/epoch - 23ms/step
Epoch 8/50
1814/1814 - 40s - loss: 2.1436 - accuracy10: 0.6855 - val_loss: 2.0116 - val_accuracy10: 0.7742 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 43s - loss: 2.1154 - accuracy10: 0.6888 - val_loss: 1.9773 - val_accuracy10: 0.7738 - 43s/epoch - 24ms/step
Epoch 10/50
1814/1814 - 43s - loss: 2.0981 - accuracy10: 0.6925 - val_loss: 1.9730 - val_accuracy10: 0.7715 - 43s/epoch - 24ms/step
Epoch 11/50
1814/1814 - 43s - loss: 2.0824 - accuracy10: 0.6948 - val_loss: 1.9756 - val_accuracy10: 0.7799 - 43s/epoch - 24ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.0682 - accuracy10: 0.6963 - val_loss: 1.9671 - val_accuracy10: 0.7671 - 41s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 42s - loss: 2.0571 - accuracy10: 0.6977 - val_loss: 1.9463 - val_accuracy10: 0.7738 - 42s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 41s - loss: 2.0467 - accuracy10: 0.6980 - val_loss: 1.9634 - val_accuracy10: 0.7730 - 41s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 42s - loss: 2.0389 - accuracy10: 0.6990 - val_loss: 1.9394 - val_accuracy10: 0.7767 - 42s/epoch - 23ms/step
Epoch 16/50
1814/1814 - 42s - loss: 2.0274 - accuracy10: 0.6999 - val_loss: 1.9831 - val_accuracy10: 0.7822 - 42s/epoch - 23ms/step
Epoch 17/50
1814/1814 - 44s - loss: 2.0201 - accuracy10: 0.7008 - val_loss: 1.9683 - val_accuracy10: 0.7850 - 44s/epoch - 24ms/step
Epoch 18/50
1814/1814 - 44s - loss: 2.0125 - accuracy10: 0.7013 - val_loss: 1.9731 - val_accuracy10: 0.7829 - 44s/epoch - 24ms/step
Epoch 19/50
1814/1814 - 38s - loss: 2.0050 - accuracy10: 0.7017 - val_loss: 1.9529 - val_accuracy10: 0.7777 - 38s/epoch - 21ms/step
Epoch 20/50
1814/1814 - 42s - loss: 1.9997 - accuracy10: 0.7024 - val_loss: 2.0013 - val_accuracy10: 0.7848 - 42s/epoch - 23ms/step
Epoch 21/50
1814/1814 - 44s - loss: 1.9918 - accuracy10: 0.7025 - val_loss: 2.0295 - val_accuracy10: 0.7853 - 44s/epoch - 24ms/step
Epoch 22/50
1814/1814 - 42s - loss: 1.9875 - accuracy10: 0.7028 - val_loss: 1.9901 - val_accuracy10: 0.7803 - 42s/epoch - 23ms/step
Epoch 23/50
1814/1814 - 39s - loss: 1.9797 - accuracy10: 0.7042 - val_loss: 1.9978 - val_accuracy10: 0.7847 - 39s/epoch - 22ms/step
Epoch 24/50
1814/1814 - 45s - loss: 1.9753 - accuracy10: 0.7033 - val_loss: 1.9936 - val_accuracy10: 0.7841 - 45s/epoch - 25ms/step
Epoch 25/50
1814/1814 - 45s - loss: 1.9689 - accuracy10: 0.7031 - val_loss: 1.9742 - val_accuracy10: 0.7812 - 45s/epoch - 25ms/step
testing model: results/AAL/W8/deepVOL_L2/h10
Evaluating performance on  test set...
5918/5918 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.568494
{'0': {'precision': 0.33808309869872916, 'recall': 0.680151561543172, 'f1-score': 0.451659635032786, 'support': 130640}, '1': {'precision': 0.9316552781909844, 'recall': 0.8028649733898467, 'f1-score': 0.8624787049348064, 'support': 1255160}, '2': {'precision': 0.3885856021203361, 'recall': 0.5128861989969661, 'f1-score': 0.44216622685131124, 'support': 129208}, 'accuracy': 0.7675523825616762, 'macro avg': {'precision': 0.5527746596700166, 'recall': 0.6653009113099949, 'f1-score': 0.5854348556063012, 'support': 1515008}, 'weighted avg': {'precision': 0.834155320280132, 'recall': 0.7675523825616762, 'f1-score': 0.7912070430292507, 'support': 1515008}}
[[  88855   31302   10483]
 [ 153649 1007724   93787]
 [  20316   42623   66269]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62964404
{'0': {'precision': 0.3515828999331017, 'recall': 0.6731396934264348, 'f1-score': 0.4619092172039352, 'support': 48406}, '1': {'precision': 0.9224179669091778, 'recall': 0.7778706261823428, 'f1-score': 0.844000064973516, 'support': 367385}, '2': {'precision': 0.4032077945198828, 'recall': 0.5137972281801683, 'f1-score': 0.4518340512355475, 'support': 48488}, 'accuracy': 0.7393722309214933, 'macro avg': {'precision': 0.5590695537873874, 'recall': 0.6549358492629819, 'f1-score': 0.5859144444709995, 'support': 464279}, 'weighted avg': {'precision': 0.8086775110822804, 'recall': 0.7393722309214933, 'f1-score': 0.763206328338301, 'support': 464279}}
[[ 32584  10797   5025]
 [ 49758 285778  31849]
 [ 10336  13239  24913]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5531091
{'0': {'precision': 0.3320235021144418, 'recall': 0.6612506521577104, 'f1-score': 0.44207484179580453, 'support': 13417}, '1': {'precision': 0.9340650070439763, 'recall': 0.8141005374644324, 'f1-score': 0.8699666077391475, 'support': 136009}, '2': {'precision': 0.3806414662084765, 'recall': 0.49984957882069797, 'f1-score': 0.432175835609312, 'support': 13296}, 'accuracy': 0.7758201103722914, 'macro avg': {'precision': 0.5489099917889649, 'recall': 0.6584002561476135, 'f1-score': 0.5814057617147547, 'support': 162722}, 'weighted avg': {'precision': 0.83920438419895, 'recall': 0.7758201103722914, 'f1-score': 0.7989135852228305, 'support': 162722}}
[[  8872   3485   1060]
 [ 15530 110725   9754]
 [  2319   4331   6646]]
training model: results/AAL/W8/deepVOL_L2/h20
Epoch 1/50
1814/1814 - 44s - loss: 2.7792 - accuracy20: 0.5312 - val_loss: 2.3783 - val_accuracy20: 0.7166 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 41s - loss: 2.4413 - accuracy20: 0.6215 - val_loss: 2.3397 - val_accuracy20: 0.7508 - 41s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 41s - loss: 2.3600 - accuracy20: 0.6393 - val_loss: 2.3234 - val_accuracy20: 0.7568 - 41s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 42s - loss: 2.3140 - accuracy20: 0.6484 - val_loss: 2.2863 - val_accuracy20: 0.7605 - 42s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 39s - loss: 2.2841 - accuracy20: 0.6523 - val_loss: 2.3154 - val_accuracy20: 0.7691 - 39s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 40s - loss: 2.2571 - accuracy20: 0.6570 - val_loss: 2.2949 - val_accuracy20: 0.7669 - 40s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 42s - loss: 2.2370 - accuracy20: 0.6591 - val_loss: 2.2593 - val_accuracy20: 0.7774 - 42s/epoch - 23ms/step
Epoch 8/50
1814/1814 - 40s - loss: 2.2262 - accuracy20: 0.6611 - val_loss: 2.2478 - val_accuracy20: 0.7674 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 2.2092 - accuracy20: 0.6634 - val_loss: 2.2445 - val_accuracy20: 0.7742 - 41s/epoch - 23ms/step
Epoch 10/50
1814/1814 - 43s - loss: 2.1988 - accuracy20: 0.6650 - val_loss: 2.2326 - val_accuracy20: 0.7781 - 43s/epoch - 24ms/step
Epoch 11/50
1814/1814 - 45s - loss: 2.1870 - accuracy20: 0.6667 - val_loss: 2.2218 - val_accuracy20: 0.7777 - 45s/epoch - 25ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.1775 - accuracy20: 0.6674 - val_loss: 2.2261 - val_accuracy20: 0.7767 - 41s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 44s - loss: 2.1677 - accuracy20: 0.6690 - val_loss: 2.2191 - val_accuracy20: 0.7716 - 44s/epoch - 24ms/step
Epoch 14/50
1814/1814 - 40s - loss: 2.1586 - accuracy20: 0.6699 - val_loss: 2.2296 - val_accuracy20: 0.7732 - 40s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 40s - loss: 2.1516 - accuracy20: 0.6706 - val_loss: 2.2095 - val_accuracy20: 0.7749 - 40s/epoch - 22ms/step
Epoch 16/50
1814/1814 - 44s - loss: 2.1444 - accuracy20: 0.6715 - val_loss: 2.2434 - val_accuracy20: 0.7766 - 44s/epoch - 24ms/step
Epoch 17/50
1814/1814 - 38s - loss: 2.1356 - accuracy20: 0.6727 - val_loss: 2.2021 - val_accuracy20: 0.7737 - 38s/epoch - 21ms/step
Epoch 18/50
1814/1814 - 43s - loss: 2.1300 - accuracy20: 0.6725 - val_loss: 2.2366 - val_accuracy20: 0.7722 - 43s/epoch - 24ms/step
Epoch 19/50
1814/1814 - 39s - loss: 2.1226 - accuracy20: 0.6729 - val_loss: 2.2283 - val_accuracy20: 0.7740 - 39s/epoch - 21ms/step
Epoch 20/50
1814/1814 - 39s - loss: 2.1175 - accuracy20: 0.6727 - val_loss: 2.2310 - val_accuracy20: 0.7702 - 39s/epoch - 22ms/step
Epoch 21/50
1814/1814 - 42s - loss: 2.1112 - accuracy20: 0.6744 - val_loss: 2.2432 - val_accuracy20: 0.7753 - 42s/epoch - 23ms/step
Epoch 22/50
1814/1814 - 44s - loss: 2.1029 - accuracy20: 0.6740 - val_loss: 2.2137 - val_accuracy20: 0.7643 - 44s/epoch - 24ms/step
Epoch 23/50
1814/1814 - 43s - loss: 2.0971 - accuracy20: 0.6749 - val_loss: 2.2581 - val_accuracy20: 0.7713 - 43s/epoch - 24ms/step
Epoch 24/50
1814/1814 - 42s - loss: 2.0937 - accuracy20: 0.6752 - val_loss: 2.2178 - val_accuracy20: 0.7681 - 42s/epoch - 23ms/step
Epoch 25/50
1814/1814 - 41s - loss: 2.0886 - accuracy20: 0.6751 - val_loss: 2.1960 - val_accuracy20: 0.7607 - 41s/epoch - 22ms/step
Epoch 26/50
1814/1814 - 42s - loss: 2.0809 - accuracy20: 0.6766 - val_loss: 2.2195 - val_accuracy20: 0.7650 - 42s/epoch - 23ms/step
Epoch 27/50
1814/1814 - 41s - loss: 2.0757 - accuracy20: 0.6771 - val_loss: 2.2226 - val_accuracy20: 0.7578 - 41s/epoch - 23ms/step
Epoch 28/50
1814/1814 - 43s - loss: 2.0718 - accuracy20: 0.6766 - val_loss: 2.1864 - val_accuracy20: 0.7525 - 43s/epoch - 24ms/step
Epoch 29/50
1814/1814 - 41s - loss: 2.0649 - accuracy20: 0.6781 - val_loss: 2.2296 - val_accuracy20: 0.7414 - 41s/epoch - 23ms/step
Epoch 30/50
1814/1814 - 44s - loss: 2.0601 - accuracy20: 0.6774 - val_loss: 2.2228 - val_accuracy20: 0.7511 - 44s/epoch - 24ms/step
Epoch 31/50
1814/1814 - 40s - loss: 2.0558 - accuracy20: 0.6784 - val_loss: 2.2258 - val_accuracy20: 0.7451 - 40s/epoch - 22ms/step
Epoch 32/50
1814/1814 - 43s - loss: 2.0503 - accuracy20: 0.6783 - val_loss: 2.2128 - val_accuracy20: 0.7476 - 43s/epoch - 24ms/step
Epoch 33/50
1814/1814 - 44s - loss: 2.0444 - accuracy20: 0.6795 - val_loss: 2.2249 - val_accuracy20: 0.7464 - 44s/epoch - 25ms/step
Epoch 34/50
1814/1814 - 44s - loss: 2.0437 - accuracy20: 0.6787 - val_loss: 2.2187 - val_accuracy20: 0.7435 - 44s/epoch - 24ms/step
Epoch 35/50
1814/1814 - 44s - loss: 2.0376 - accuracy20: 0.6795 - val_loss: 2.2068 - val_accuracy20: 0.7483 - 44s/epoch - 24ms/step
Epoch 36/50
1814/1814 - 42s - loss: 2.0291 - accuracy20: 0.6803 - val_loss: 2.2056 - val_accuracy20: 0.7444 - 42s/epoch - 23ms/step
Epoch 37/50
1814/1814 - 44s - loss: 2.0264 - accuracy20: 0.6805 - val_loss: 2.2171 - val_accuracy20: 0.7432 - 44s/epoch - 24ms/step
Epoch 38/50
1814/1814 - 44s - loss: 2.0214 - accuracy20: 0.6805 - val_loss: 2.2135 - val_accuracy20: 0.7481 - 44s/epoch - 24ms/step
testing model: results/AAL/W8/deepVOL_L2/h20
Evaluating performance on  test set...
5918/5918 - 58s - 58s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.620977
{'0': {'precision': 0.3904371019694298, 'recall': 0.6233478450639598, 'f1-score': 0.4801375811662072, 'support': 178706}, '1': {'precision': 0.8799162725260647, 'recall': 0.7960827804118323, 'f1-score': 0.8359028503438195, 'support': 1159598}, '2': {'precision': 0.4608730804800115, 'recall': 0.47097971749366174, 'f1-score': 0.4658715919873042, 'support': 176704}, 'accuracy': 0.737788843359243, 'macro avg': {'precision': 0.5770754849918354, 'recall': 0.630136780989818, 'f1-score': 0.5939706744991103, 'support': 1515008}, 'weighted avg': {'precision': 0.7733033220592688, 'recall': 0.737788843359243, 'f1-score': 0.7507789489054878, 'support': 1515008}}
[[111396  55597  11713]
 [150820 923136  85642]
 [ 23095  70385  83224]]
Evaluating performance on  train set...
1814/1814 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6599751
{'0': {'precision': 0.41702849675406795, 'recall': 0.6175731564572766, 'f1-score': 0.4978642828834383, 'support': 64075}, '1': {'precision': 0.8680722498040241, 'recall': 0.7905509515679007, 'f1-score': 0.8274999922159846, 'support': 336182}, '2': {'precision': 0.4805554237636602, 'recall': 0.47461810002811533, 'f1-score': 0.47756830880215, 'support': 64022}, 'accuracy': 0.7231126111669922, 'macro avg': {'precision': 0.5885520567739174, 'recall': 0.6275807360177642, 'f1-score': 0.600977527967191, 'support': 464279}, 'weighted avg': {'precision': 0.7523870029730623, 'recall': 0.7231126111669922, 'f1-score': 0.7337530548981145, 'support': 464279}}
[[ 39571  18601   5903]
 [ 43471 265769  26942]
 [ 11846  21790  30386]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59870917
{'0': {'precision': 0.3855434550501815, 'recall': 0.5967608659725665, 'f1-score': 0.46844392553674513, 'support': 18153}, '1': {'precision': 0.8867280820858326, 'recall': 0.8149701450099517, 'f1-score': 0.8493361538904757, 'support': 126612}, '2': {'precision': 0.44900865374082594, 'recall': 0.45653505596703237, 'f1-score': 0.4527405771089328, 'support': 17957}, 'accuracy': 0.7510723811162596, 'macro avg': {'precision': 0.5737600636256134, 'recall': 0.6227553556498502, 'f1-score': 0.5901735521787178, 'support': 162722}, 'weighted avg': {'precision': 0.7825127190164907, 'recall': 0.7510723811162596, 'f1-score': 0.7630785894949333, 'support': 162722}}
[[ 10833   5967   1353]
 [ 14720 103185   8707]
 [  2545   7214   8198]]
training model: results/AAL/W8/deepVOL_L2/h30
Epoch 1/50
1814/1814 - 44s - loss: 2.8871 - accuracy30: 0.5079 - val_loss: 2.5051 - val_accuracy30: 0.7218 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 46s - loss: 2.6109 - accuracy30: 0.5913 - val_loss: 2.4451 - val_accuracy30: 0.7235 - 46s/epoch - 26ms/step
Epoch 3/50
1814/1814 - 43s - loss: 2.5189 - accuracy30: 0.6074 - val_loss: 2.4220 - val_accuracy30: 0.7260 - 43s/epoch - 24ms/step
Epoch 4/50
1814/1814 - 42s - loss: 2.4694 - accuracy30: 0.6166 - val_loss: 2.4274 - val_accuracy30: 0.7344 - 42s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 42s - loss: 2.4377 - accuracy30: 0.6243 - val_loss: 2.4954 - val_accuracy30: 0.7405 - 42s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 44s - loss: 2.4145 - accuracy30: 0.6296 - val_loss: 2.4632 - val_accuracy30: 0.7398 - 44s/epoch - 24ms/step
Epoch 7/50
1814/1814 - 44s - loss: 2.3923 - accuracy30: 0.6320 - val_loss: 2.4749 - val_accuracy30: 0.7402 - 44s/epoch - 24ms/step
Epoch 8/50
1814/1814 - 40s - loss: 2.3738 - accuracy30: 0.6337 - val_loss: 2.4742 - val_accuracy30: 0.7292 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 43s - loss: 2.3536 - accuracy30: 0.6364 - val_loss: 2.3971 - val_accuracy30: 0.7287 - 43s/epoch - 23ms/step
Epoch 10/50
1814/1814 - 41s - loss: 2.3367 - accuracy30: 0.6380 - val_loss: 2.3560 - val_accuracy30: 0.7319 - 41s/epoch - 23ms/step
Epoch 11/50
1814/1814 - 43s - loss: 2.3248 - accuracy30: 0.6407 - val_loss: 2.3604 - val_accuracy30: 0.7319 - 43s/epoch - 24ms/step
Epoch 12/50
1814/1814 - 41s - loss: 2.3141 - accuracy30: 0.6422 - val_loss: 2.3655 - val_accuracy30: 0.7231 - 41s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 45s - loss: 2.3045 - accuracy30: 0.6423 - val_loss: 2.3610 - val_accuracy30: 0.7305 - 45s/epoch - 25ms/step
Epoch 14/50
1814/1814 - 39s - loss: 2.2932 - accuracy30: 0.6448 - val_loss: 2.3376 - val_accuracy30: 0.7320 - 39s/epoch - 21ms/step
Epoch 15/50
1814/1814 - 42s - loss: 2.2860 - accuracy30: 0.6452 - val_loss: 2.3704 - val_accuracy30: 0.7293 - 42s/epoch - 23ms/step
Epoch 16/50
1814/1814 - 44s - loss: 2.2760 - accuracy30: 0.6466 - val_loss: 2.3900 - val_accuracy30: 0.7264 - 44s/epoch - 24ms/step
Epoch 17/50
1814/1814 - 43s - loss: 2.2675 - accuracy30: 0.6472 - val_loss: 2.3757 - val_accuracy30: 0.7279 - 43s/epoch - 24ms/step
Epoch 18/50
1814/1814 - 41s - loss: 2.2587 - accuracy30: 0.6484 - val_loss: 2.3672 - val_accuracy30: 0.7295 - 41s/epoch - 23ms/step
Epoch 19/50
1814/1814 - 41s - loss: 2.2541 - accuracy30: 0.6489 - val_loss: 2.3782 - val_accuracy30: 0.7280 - 41s/epoch - 22ms/step
Epoch 20/50
1814/1814 - 42s - loss: 2.2460 - accuracy30: 0.6500 - val_loss: 2.3880 - val_accuracy30: 0.7246 - 42s/epoch - 23ms/step
Epoch 21/50
1814/1814 - 43s - loss: 2.2389 - accuracy30: 0.6513 - val_loss: 2.3866 - val_accuracy30: 0.7210 - 43s/epoch - 24ms/step
Epoch 22/50
1814/1814 - 42s - loss: 2.2340 - accuracy30: 0.6512 - val_loss: 2.4072 - val_accuracy30: 0.7235 - 42s/epoch - 23ms/step
Epoch 23/50
1814/1814 - 40s - loss: 2.2265 - accuracy30: 0.6529 - val_loss: 2.4006 - val_accuracy30: 0.7184 - 40s/epoch - 22ms/step
Epoch 24/50
1814/1814 - 42s - loss: 2.2209 - accuracy30: 0.6524 - val_loss: 2.3902 - val_accuracy30: 0.7273 - 42s/epoch - 23ms/step
testing model: results/AAL/W8/deepVOL_L2/h30
Evaluating performance on  test set...
5918/5918 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66847825
{'0': {'precision': 0.435724195534918, 'recall': 0.5680582855771804, 'f1-score': 0.4931680800522359, 'support': 216726}, '1': {'precision': 0.8271783118966695, 'recall': 0.8143632073514483, 'f1-score': 0.8207207374642234, 'support': 1084521}, '2': {'precision': 0.508920062400981, 'recall': 0.3922137340300616, 'f1-score': 0.443009548166192, 'support': 213761}, 'accuracy': 0.7195651772135857, 'macro avg': {'precision': 0.5906075232775229, 'recall': 0.5915450756528967, 'f1-score': 0.5856327885608837, 'support': 1515008}, 'weighted avg': {'precision': 0.7262748932394314, 'recall': 0.7195651772135857, 'f1-score': 0.7205700460052957, 'support': 1515008}}
[[123113  81198  12415]
 [132841 883194  68486]
 [ 26594 103327  83840]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71492726
{'0': {'precision': 0.4478102655771195, 'recall': 0.5545351533677664, 'f1-score': 0.4954909347774899, 'support': 75896}, '1': {'precision': 0.8148372724943985, 'recall': 0.8039459077283357, 'f1-score': 0.8093549509159775, 'support': 312577}, '2': {'precision': 0.5152998578260307, 'recall': 0.4207450597578028, 'f1-score': 0.46324672118052024, 'support': 75806}, 'accuracy': 0.700606747236037, 'macro avg': {'precision': 0.5926491319658496, 'recall': 0.5930753736179684, 'f1-score': 0.5893642022913292, 'support': 464279}, 'weighted avg': {'precision': 0.7059316037621403, 'recall': 0.700606747236037, 'f1-score': 0.7015359372794083, 'support': 464279}}
[[ 42087  25954   7855]
 [ 39136 251295  22146]
 [ 12761  31150  31895]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.649285
{'0': {'precision': 0.4197522295867023, 'recall': 0.5499181669394435, 'f1-score': 0.4760986361757818, 'support': 21996}, '1': {'precision': 0.8419427143932654, 'recall': 0.8265901779789853, 'f1-score': 0.8341958151618796, 'support': 119059}, '2': {'precision': 0.5046130340247987, 'recall': 0.3963169797387732, 'f1-score': 0.44395615758453105, 'support': 21667}, 'accuracy': 0.7318985754845688, 'macro avg': {'precision': 0.5887693260015888, 'recall': 0.5909417748857341, 'f1-score': 0.5847502029740641, 'support': 162722}, 'weighted avg': {'precision': 0.7399563567504835, 'recall': 0.7318985754845688, 'f1-score': 0.7338281438592492, 'support': 162722}}
[[12096  8359  1541]
 [13757 98413  6889]
 [ 2964 10116  8587]]
training model: results/AAL/W8/deepVOL_L2/h50
Epoch 1/50
1814/1814 - 43s - loss: 3.0038 - accuracy50: 0.4793 - val_loss: 2.7736 - val_accuracy50: 0.6464 - 43s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 44s - loss: 2.7872 - accuracy50: 0.5465 - val_loss: 2.7270 - val_accuracy50: 0.6553 - 44s/epoch - 24ms/step
Epoch 3/50
1814/1814 - 43s - loss: 2.6887 - accuracy50: 0.5709 - val_loss: 2.7436 - val_accuracy50: 0.6733 - 43s/epoch - 24ms/step
Epoch 4/50
1814/1814 - 41s - loss: 2.6445 - accuracy50: 0.5791 - val_loss: 2.7351 - val_accuracy50: 0.6751 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 44s - loss: 2.6151 - accuracy50: 0.5878 - val_loss: 2.7561 - val_accuracy50: 0.6654 - 44s/epoch - 24ms/step
Epoch 6/50
1814/1814 - 43s - loss: 2.5960 - accuracy50: 0.5924 - val_loss: 2.7612 - val_accuracy50: 0.6746 - 43s/epoch - 24ms/step
Epoch 7/50
1814/1814 - 45s - loss: 2.5794 - accuracy50: 0.5958 - val_loss: 2.7102 - val_accuracy50: 0.6732 - 45s/epoch - 25ms/step
Epoch 8/50
1814/1814 - 44s - loss: 2.5617 - accuracy50: 0.5975 - val_loss: 2.7118 - val_accuracy50: 0.6749 - 44s/epoch - 24ms/step
Epoch 9/50
1814/1814 - 46s - loss: 2.5473 - accuracy50: 0.5995 - val_loss: 2.7025 - val_accuracy50: 0.6815 - 46s/epoch - 25ms/step
Epoch 10/50
1814/1814 - 42s - loss: 2.5391 - accuracy50: 0.5996 - val_loss: 2.7157 - val_accuracy50: 0.6795 - 42s/epoch - 23ms/step
Epoch 11/50
1814/1814 - 45s - loss: 2.5274 - accuracy50: 0.6003 - val_loss: 2.7320 - val_accuracy50: 0.6770 - 45s/epoch - 25ms/step
Epoch 12/50
1814/1814 - 45s - loss: 2.5148 - accuracy50: 0.6030 - val_loss: 2.7095 - val_accuracy50: 0.6792 - 45s/epoch - 25ms/step
Epoch 13/50
1814/1814 - 43s - loss: 2.5054 - accuracy50: 0.6032 - val_loss: 2.6943 - val_accuracy50: 0.6733 - 43s/epoch - 24ms/step
Epoch 14/50
1814/1814 - 43s - loss: 2.4951 - accuracy50: 0.6050 - val_loss: 2.6801 - val_accuracy50: 0.6760 - 43s/epoch - 24ms/step
Epoch 15/50
1814/1814 - 45s - loss: 2.4927 - accuracy50: 0.6047 - val_loss: 2.7126 - val_accuracy50: 0.6727 - 45s/epoch - 25ms/step
Epoch 16/50
1814/1814 - 40s - loss: 2.4768 - accuracy50: 0.6078 - val_loss: 2.7431 - val_accuracy50: 0.6785 - 40s/epoch - 22ms/step
Epoch 17/50
1814/1814 - 44s - loss: 2.4680 - accuracy50: 0.6079 - val_loss: 2.7487 - val_accuracy50: 0.6708 - 44s/epoch - 24ms/step
Epoch 18/50
1814/1814 - 41s - loss: 2.4616 - accuracy50: 0.6096 - val_loss: 2.7624 - val_accuracy50: 0.6756 - 41s/epoch - 22ms/step
Epoch 19/50
1814/1814 - 45s - loss: 2.4551 - accuracy50: 0.6091 - val_loss: 2.7381 - val_accuracy50: 0.6784 - 45s/epoch - 25ms/step
Epoch 20/50
1814/1814 - 39s - loss: 2.4472 - accuracy50: 0.6111 - val_loss: 2.7458 - val_accuracy50: 0.6798 - 39s/epoch - 22ms/step
Epoch 21/50
1814/1814 - 40s - loss: 2.4400 - accuracy50: 0.6121 - val_loss: 2.7680 - val_accuracy50: 0.6742 - 40s/epoch - 22ms/step
Epoch 22/50
1814/1814 - 44s - loss: 2.4337 - accuracy50: 0.6130 - val_loss: 2.7489 - val_accuracy50: 0.6722 - 44s/epoch - 24ms/step
Epoch 23/50
1814/1814 - 43s - loss: 2.4291 - accuracy50: 0.6129 - val_loss: 2.7534 - val_accuracy50: 0.6757 - 43s/epoch - 23ms/step
Epoch 24/50
1814/1814 - 43s - loss: 2.4219 - accuracy50: 0.6133 - val_loss: 2.7720 - val_accuracy50: 0.6694 - 43s/epoch - 24ms/step
testing model: results/AAL/W8/deepVOL_L2/h50
Evaluating performance on  test set...
5918/5918 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7768337
{'0': {'precision': 0.47289819249741555, 'recall': 0.4712008668253946, 'f1-score': 0.47204800391344015, 'support': 280564}, '1': {'precision': 0.7265803230300272, 'recall': 0.8246824339062795, 'f1-score': 0.7725293816867107, 'support': 958147}, '2': {'precision': 0.5595460199004975, 'recall': 0.2995942771727525, 'f1-score': 0.3902430975430954, 'support': 276297}, 'accuracy': 0.6634592028556945, 'macro avg': {'precision': 0.5863415118093135, 'recall': 0.5318258593014755, 'f1-score': 0.5449401610477488, 'support': 1515008}, 'weighted avg': {'precision': 0.649138388649132, 'recall': 0.6634592028556945, 'f1-score': 0.6471644920467824, 'support': 1515008}}
[[132202 132375  15987]
 [118808 790167  49172]
 [ 28547 164973  82777]]
Evaluating performance on  train set...
1814/1814 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81291926
{'0': {'precision': 0.4708070978820836, 'recall': 0.4537353334323481, 'f1-score': 0.4621135997752639, 'support': 94262}, '1': {'precision': 0.712740068090021, 'recall': 0.8164715460747504, 'f1-score': 0.7610875825851262, 'support': 275129}, '2': {'precision': 0.5524680763421667, 'recall': 0.3392315150493213, 'f1-score': 0.42035363560384453, 'support': 94888}, 'accuracy': 0.6452887164829768, 'macro avg': {'precision': 0.5786717474380905, 'recall': 0.5364794648521399, 'f1-score': 0.5478516059880781, 'support': 464279}, 'weighted avg': {'precision': 0.6308647853597855, 'recall': 0.6452887164829768, 'f1-score': 0.6307490397503586, 'support': 464279}}
[[ 42770  40506  10986]
 [ 35405 224635  15089]
 [ 12669  50030  32189]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7594106
{'0': {'precision': 0.44821661741461066, 'recall': 0.45913410770855334, 'f1-score': 0.45360968145778274, 'support': 28410}, '1': {'precision': 0.74869229791022, 'recall': 0.8297348591615461, 'f1-score': 0.7871330591071755, 'support': 106434}, '2': {'precision': 0.5417172039578678, 'recall': 0.3043977329794103, 'f1-score': 0.3897756240957215, 'support': 27878}, 'accuracy': 0.6750285763449319, 'macro avg': {'precision': 0.5795420397608995, 'recall': 0.5310888999498365, 'f1-score': 0.5435061215535599, 'support': 162722}, 'weighted avg': {'precision': 0.660772005927059, 'recall': 0.6750285763449319, 'f1-score': 0.6608260463352789, 'support': 162722}}
[[13044 13278  2088]
 [13031 88312  5091]
 [ 3027 16365  8486]]
training model: results/AAL/W8/deepVOL_L2/h100
Epoch 1/50
1814/1814 - 44s - loss: 3.1352 - accuracy100: 0.4460 - val_loss: 3.2980 - val_accuracy100: 0.5161 - 44s/epoch - 25ms/step
Epoch 2/50
1814/1814 - 41s - loss: 3.0086 - accuracy100: 0.4897 - val_loss: 3.0853 - val_accuracy100: 0.5523 - 41s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 39s - loss: 2.9236 - accuracy100: 0.5132 - val_loss: 3.0192 - val_accuracy100: 0.5576 - 39s/epoch - 21ms/step
Epoch 4/50
1814/1814 - 38s - loss: 2.8776 - accuracy100: 0.5252 - val_loss: 3.0363 - val_accuracy100: 0.5599 - 38s/epoch - 21ms/step
Epoch 5/50
1814/1814 - 41s - loss: 2.8527 - accuracy100: 0.5301 - val_loss: 3.0453 - val_accuracy100: 0.5691 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 44s - loss: 2.8396 - accuracy100: 0.5336 - val_loss: 3.0257 - val_accuracy100: 0.5673 - 44s/epoch - 24ms/step
Epoch 7/50
1814/1814 - 41s - loss: 2.8284 - accuracy100: 0.5363 - val_loss: 3.0403 - val_accuracy100: 0.5665 - 41s/epoch - 23ms/step
Epoch 8/50
1814/1814 - 41s - loss: 2.8159 - accuracy100: 0.5385 - val_loss: 3.0481 - val_accuracy100: 0.5666 - 41s/epoch - 23ms/step
Epoch 9/50
1814/1814 - 41s - loss: 2.8041 - accuracy100: 0.5408 - val_loss: 3.0275 - val_accuracy100: 0.5708 - 41s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 41s - loss: 2.7945 - accuracy100: 0.5426 - val_loss: 3.0244 - val_accuracy100: 0.5713 - 41s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 42s - loss: 2.7883 - accuracy100: 0.5435 - val_loss: 3.0289 - val_accuracy100: 0.5721 - 42s/epoch - 23ms/step
Epoch 12/50
1814/1814 - 43s - loss: 2.7802 - accuracy100: 0.5442 - val_loss: 3.0274 - val_accuracy100: 0.5730 - 43s/epoch - 24ms/step
Epoch 13/50
1814/1814 - 43s - loss: 2.7723 - accuracy100: 0.5451 - val_loss: 3.0270 - val_accuracy100: 0.5648 - 43s/epoch - 24ms/step
testing model: results/AAL/W8/deepVOL_L2/h100
Evaluating performance on  test set...
5918/5918 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96176374
{'0': {'precision': 0.47608340214972455, 'recall': 0.3728013338077146, 'f1-score': 0.4181593090490685, 'support': 385063}, '1': {'precision': 0.5587964929352726, 'recall': 0.8441648702296594, 'f1-score': 0.672458103734733, 'support': 749632}, '2': {'precision': 0.5389020537124802, 'recall': 0.11481069540089348, 'f1-score': 0.18929329318914373, 'support': 380313}, 'accuracy': 0.541270409133153, 'macro avg': {'precision': 0.5245939829324925, 'recall': 0.44392563314608907, 'f1-score': 0.42663690199098175, 'support': 1515008}, 'weighted avg': {'precision': 0.5327795578819308, 'recall': 0.541270409133153, 'f1-score': 0.48653504895807786, 'support': 1515008}}
[[143552 221147  20364]
 [ 99823 632813  16996]
 [ 58152 278497  43664]]
Evaluating performance on  train set...
1814/1814 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.969916
{'0': {'precision': 0.46235747409288325, 'recall': 0.38392653619460093, 'f1-score': 0.41950763893521914, 'support': 122836}, '1': {'precision': 0.5553478040388139, 'recall': 0.821760026516407, 'f1-score': 0.66278415683508, 'support': 217224}, '2': {'precision': 0.49656050331709467, 'recall': 0.16329224997786168, 'f1-score': 0.2457653815397291, 'support': 124219}, 'accuracy': 0.5297461224823866, 'macro avg': {'precision': 0.5047552604829306, 'recall': 0.4563262708962899, 'f1-score': 0.4426857257700094, 'support': 464279}, 'weighted avg': {'precision': 0.5150163225856584, 'recall': 0.5297461224823866, 'f1-score': 0.4868451856536126, 'support': 464279}}
[[ 47160  62826  12850]
 [ 31003 178506   7715]
 [ 23836  80099  20284]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93965036
{'0': {'precision': 0.4525345622119816, 'recall': 0.35079482534255313, 'f1-score': 0.39522214715901743, 'support': 39191}, '1': {'precision': 0.5879138909854625, 'recall': 0.8442444305691363, 'f1-score': 0.6931398863498973, 'support': 84883}, '2': {'precision': 0.509090909090909, 'recall': 0.13765265990478162, 'f1-score': 0.21670943826632452, 'support': 38648}, 'accuracy': 0.5575767259497794, 'macro avg': {'precision': 0.5165131207627843, 'recall': 0.4442306386054904, 'f1-score': 0.4350238239250798, 'support': 162722}, 'weighted avg': {'precision': 0.53658707667503, 'recall': 0.5575767259497794, 'f1-score': 0.5082307893982639, 'support': 162722}}
[[13748 22595  2848]
 [10939 71662  2282]
 [ 5693 27635  5320]]
training model: results/AAL/W8/deepVOL_L2/h200
Epoch 1/50
1814/1814 - 44s - loss: 3.2032 - accuracy200: 0.4205 - val_loss: 3.3808 - val_accuracy200: 0.4021 - 44s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 43s - loss: 3.1609 - accuracy200: 0.4351 - val_loss: 3.3172 - val_accuracy200: 0.4065 - 43s/epoch - 24ms/step
Epoch 3/50
1814/1814 - 44s - loss: 3.0955 - accuracy200: 0.4584 - val_loss: 3.2366 - val_accuracy200: 0.4434 - 44s/epoch - 24ms/step
Epoch 4/50
1814/1814 - 41s - loss: 3.0520 - accuracy200: 0.4695 - val_loss: 3.1974 - val_accuracy200: 0.4503 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 44s - loss: 3.0244 - accuracy200: 0.4757 - val_loss: 3.1884 - val_accuracy200: 0.4522 - 44s/epoch - 25ms/step
Epoch 6/50
1814/1814 - 43s - loss: 3.0099 - accuracy200: 0.4784 - val_loss: 3.1840 - val_accuracy200: 0.4535 - 43s/epoch - 24ms/step
Epoch 7/50
1814/1814 - 43s - loss: 2.9991 - accuracy200: 0.4808 - val_loss: 3.1972 - val_accuracy200: 0.4530 - 43s/epoch - 24ms/step
Epoch 8/50
1814/1814 - 44s - loss: 2.9871 - accuracy200: 0.4841 - val_loss: 3.1973 - val_accuracy200: 0.4515 - 44s/epoch - 24ms/step
Epoch 9/50
1814/1814 - 44s - loss: 2.9790 - accuracy200: 0.4858 - val_loss: 3.1972 - val_accuracy200: 0.4516 - 44s/epoch - 24ms/step
Epoch 10/50
1814/1814 - 46s - loss: 2.9715 - accuracy200: 0.4872 - val_loss: 3.2052 - val_accuracy200: 0.4534 - 46s/epoch - 25ms/step
Epoch 11/50
1814/1814 - 42s - loss: 2.9629 - accuracy200: 0.4899 - val_loss: 3.2062 - val_accuracy200: 0.4522 - 42s/epoch - 23ms/step
Epoch 12/50
1814/1814 - 42s - loss: 2.9562 - accuracy200: 0.4915 - val_loss: 3.2257 - val_accuracy200: 0.4499 - 42s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 42s - loss: 2.9494 - accuracy200: 0.4936 - val_loss: 3.2176 - val_accuracy200: 0.4483 - 42s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 43s - loss: 2.9415 - accuracy200: 0.4959 - val_loss: 3.2144 - val_accuracy200: 0.4514 - 43s/epoch - 24ms/step
Epoch 15/50
1814/1814 - 42s - loss: 2.9337 - accuracy200: 0.4979 - val_loss: 3.2144 - val_accuracy200: 0.4485 - 42s/epoch - 23ms/step
Epoch 16/50
1814/1814 - 43s - loss: 2.9270 - accuracy200: 0.4995 - val_loss: 3.2256 - val_accuracy200: 0.4482 - 43s/epoch - 23ms/step
testing model: results/AAL/W8/deepVOL_L2/h200
Evaluating performance on  test set...
5918/5918 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0777184
{'0': {'precision': 0.4710438614073291, 'recall': 0.288221770455273, 'f1-score': 0.35762212853979647, 'support': 481074}, '1': {'precision': 0.4142428136273192, 'recall': 0.8300583601655934, 'f1-score': 0.5526728059602392, 'support': 556544}, '2': {'precision': 0.4842197101889083, 'recall': 0.10695657638408848, 'f1-score': 0.17521163685277896, 'support': 477390}, 'accuracy': 0.4301495437647854, 'macro avg': {'precision': 0.45650212840785215, 'recall': 0.40841223566831836, 'f1-score': 0.3618355237842715, 'support': 1515008}, 'weighted avg': {'precision': 0.4543295840663252, 'recall': 0.4301495437647854, 'f1-score': 0.37179587520504015, 'support': 1515008}}
[[138656 307593  34825]
 [ 75017 461964  19563]
 [ 80686 345644  51060]]
Evaluating performance on  train set...
1814/1814 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0559539
{'0': {'precision': 0.47058936733221074, 'recall': 0.3293954415647395, 'f1-score': 0.387532339924801, 'support': 148472}, '1': {'precision': 0.42761142743417596, 'recall': 0.8295278369297033, 'f1-score': 0.5643218575714175, 'support': 165769}, '2': {'precision': 0.47342496840910847, 'recall': 0.12235566989695944, 'f1-score': 0.19445488970685593, 'support': 150038}, 'accuracy': 0.4410580706859453, 'macro avg': {'precision': 0.45720858772516504, 'recall': 0.4270929827971341, 'f1-score': 0.38210302906769145, 'support': 464279}, 'weighted avg': {'precision': 0.4561606246912949, 'recall': 0.4410580706859453, 'f1-score': 0.3882587718223496, 'support': 464279}}
[[ 48906  85676  13890]
 [ 21730 137510   6529]
 [ 33289  98391  18358]]
Evaluating performance on  val set...
636/636 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0520121
{'0': {'precision': 0.4470447233962026, 'recall': 0.2880660108934233, 'f1-score': 0.3503646026449141, 'support': 49204}, '1': {'precision': 0.45359909346142135, 'recall': 0.8235176712623208, 'f1-score': 0.5849846771291156, 'support': 65134}, '2': {'precision': 0.4662331557505484, 'recall': 0.12299520502645503, 'f1-score': 0.1946425067050435, 'support': 48384}, 'accuracy': 0.45331301237693733, 'macro avg': {'precision': 0.4556256575360575, 'recall': 0.41152629572739974, 'f1-score': 0.37666392882635774, 'support': 162722}, 'weighted avg': {'precision': 0.45537380889699924, 'recall': 0.45331301237693733, 'f1-score': 0.3979751657003048, 'support': 162722}}
[[14174 30859  4171]
 [ 8853 53639  2642]
 [ 8679 33754  5951]]
training model: results/AAL/W8/deepVOL_L2/h300
Epoch 1/50
1814/1814 - 43s - loss: 3.2428 - accuracy300: 0.3975 - val_loss: 3.3706 - val_accuracy300: 0.3654 - 43s/epoch - 23ms/step
Epoch 2/50
1814/1814 - 39s - loss: 3.2008 - accuracy300: 0.4178 - val_loss: 3.3679 - val_accuracy300: 0.3834 - 39s/epoch - 21ms/step
Epoch 3/50
1814/1814 - 39s - loss: 3.1766 - accuracy300: 0.4278 - val_loss: 3.2913 - val_accuracy300: 0.3974 - 39s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 41s - loss: 3.1511 - accuracy300: 0.4325 - val_loss: 3.2703 - val_accuracy300: 0.3997 - 41s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 40s - loss: 3.1282 - accuracy300: 0.4385 - val_loss: 3.2613 - val_accuracy300: 0.4019 - 40s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 40s - loss: 3.1125 - accuracy300: 0.4429 - val_loss: 3.2569 - val_accuracy300: 0.4042 - 40s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 42s - loss: 3.0938 - accuracy300: 0.4491 - val_loss: 3.2664 - val_accuracy300: 0.4039 - 42s/epoch - 23ms/step
Epoch 8/50
1814/1814 - 40s - loss: 3.0808 - accuracy300: 0.4525 - val_loss: 3.2751 - val_accuracy300: 0.4059 - 40s/epoch - 22ms/step
Epoch 9/50
1814/1814 - 41s - loss: 3.0699 - accuracy300: 0.4558 - val_loss: 3.2763 - val_accuracy300: 0.4035 - 41s/epoch - 23ms/step
Epoch 10/50
1814/1814 - 40s - loss: 3.0593 - accuracy300: 0.4586 - val_loss: 3.2850 - val_accuracy300: 0.4019 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 41s - loss: 3.0487 - accuracy300: 0.4623 - val_loss: 3.3073 - val_accuracy300: 0.3990 - 41s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 42s - loss: 3.0409 - accuracy300: 0.4645 - val_loss: 3.3399 - val_accuracy300: 0.3949 - 42s/epoch - 23ms/step
Epoch 13/50
1814/1814 - 45s - loss: 3.0300 - accuracy300: 0.4674 - val_loss: 3.3588 - val_accuracy300: 0.3933 - 45s/epoch - 25ms/step
Epoch 14/50
1814/1814 - 40s - loss: 3.0224 - accuracy300: 0.4709 - val_loss: 3.3844 - val_accuracy300: 0.3888 - 40s/epoch - 22ms/step
Epoch 15/50
1814/1814 - 42s - loss: 3.0165 - accuracy300: 0.4727 - val_loss: 3.4078 - val_accuracy300: 0.3932 - 42s/epoch - 23ms/step
Epoch 16/50
1814/1814 - 43s - loss: 3.0073 - accuracy300: 0.4755 - val_loss: 3.3971 - val_accuracy300: 0.3922 - 43s/epoch - 24ms/step
testing model: results/AAL/W8/deepVOL_L2/h300
Evaluating performance on  test set...
5918/5918 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118957
{'0': {'precision': 0.4481469069786643, 'recall': 0.1802097919852509, 'f1-score': 0.25705291602245345, 'support': 512031}, '1': {'precision': 0.35590255373453206, 'recall': 0.895980523296039, 'f1-score': 0.5094433532783917, 'support': 498647}, '2': {'precision': 0.4850941957560767, 'recall': 0.05172010390022406, 'f1-score': 0.0934741202757207, 'support': 504330}, 'accuracy': 0.37302443287428183, 'macro avg': {'precision': 0.4297145521564243, 'recall': 0.3759701397271713, 'f1-score': 0.28665679652552195, 'support': 1515008}, 'weighted avg': {'precision': 0.43008512521710635, 'recall': 0.37302443287428183, 'f1-score': 0.28567061329363097, 'support': 1515008}}
[[ 92273 397302  22456]
 [ 46638 446778   5231]
 [ 66988 411258  26084]]
Evaluating performance on  train set...
1814/1814 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0916611
{'0': {'precision': 0.46158932943129694, 'recall': 0.21224825158990482, 'f1-score': 0.2907867737975474, 'support': 154569}, '1': {'precision': 0.373153454983805, 'recall': 0.8959647979139505, 'f1-score': 0.5268734558376763, 'support': 153400}, '2': {'precision': 0.46897355518045175, 'recall': 0.07465293327362293, 'f1-score': 0.12880259614110998, 'support': 156310}, 'accuracy': 0.39182689718897473, 'macro avg': {'precision': 0.43457211319851785, 'recall': 0.3942886609258261, 'f1-score': 0.3154876085921113, 'support': 464279}, 'weighted avg': {'precision': 0.4348557601477522, 'recall': 0.39182689718897473, 'f1-score': 0.3142553136528457, 'support': 464279}}
[[ 32807 111107  10655]
 [ 13401 137441   2558]
 [ 24866 119775  11669]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0876395
{'0': {'precision': 0.44556451612903225, 'recall': 0.17637669592976857, 'f1-score': 0.252715837621498, 'support': 52626}, '1': {'precision': 0.39400897764477566, 'recall': 0.9018344579702282, 'f1-score': 0.5484163642362256, 'support': 58982}, '2': {'precision': 0.4653019744483159, 'recall': 0.06270297765778456, 'f1-score': 0.11051343057135961, 'support': 51114}, 'accuracy': 0.4036270448986615, 'macro avg': {'precision': 0.4349584894073746, 'recall': 0.38030471051926046, 'f1-score': 0.3038818774763611, 'support': 162722}, 'weighted avg': {'precision': 0.433077032406201, 'recall': 0.4036270448986615, 'f1-score': 0.31523027713692364, 'support': 162722}}
[[ 9282 40460  2884]
 [ 4991 53192   799]
 [ 6559 41350  3205]]
training model: results/AAL/W8/deepVOL_L2/h500
Epoch 1/50
1814/1814 - 45s - loss: 3.2710 - accuracy500: 0.3848 - val_loss: 3.3421 - val_accuracy500: 0.3519 - 45s/epoch - 25ms/step
Epoch 2/50
1814/1814 - 43s - loss: 3.2570 - accuracy500: 0.3878 - val_loss: 3.3414 - val_accuracy500: 0.3575 - 43s/epoch - 23ms/step
Epoch 3/50
1814/1814 - 40s - loss: 3.2393 - accuracy500: 0.3988 - val_loss: 3.3413 - val_accuracy500: 0.3601 - 40s/epoch - 22ms/step
Epoch 4/50
1814/1814 - 42s - loss: 3.2273 - accuracy500: 0.4053 - val_loss: 3.3343 - val_accuracy500: 0.3655 - 42s/epoch - 23ms/step
Epoch 5/50
1814/1814 - 40s - loss: 3.2164 - accuracy500: 0.4113 - val_loss: 3.3411 - val_accuracy500: 0.3675 - 40s/epoch - 22ms/step
Epoch 6/50
1814/1814 - 43s - loss: 3.2119 - accuracy500: 0.4141 - val_loss: 3.3937 - val_accuracy500: 0.3643 - 43s/epoch - 23ms/step
Epoch 7/50
1814/1814 - 40s - loss: 3.2027 - accuracy500: 0.4193 - val_loss: 3.3901 - val_accuracy500: 0.3663 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 43s - loss: 3.1940 - accuracy500: 0.4238 - val_loss: 3.3827 - val_accuracy500: 0.3611 - 43s/epoch - 24ms/step
Epoch 9/50
1814/1814 - 40s - loss: 3.1832 - accuracy500: 0.4280 - val_loss: 3.4020 - val_accuracy500: 0.3634 - 40s/epoch - 22ms/step
Epoch 10/50
1814/1814 - 42s - loss: 3.1779 - accuracy500: 0.4313 - val_loss: 3.4121 - val_accuracy500: 0.3664 - 42s/epoch - 23ms/step
Epoch 11/50
1814/1814 - 40s - loss: 3.1693 - accuracy500: 0.4355 - val_loss: 3.4112 - val_accuracy500: 0.3657 - 40s/epoch - 22ms/step
Epoch 12/50
1814/1814 - 39s - loss: 3.1570 - accuracy500: 0.4407 - val_loss: 3.4343 - val_accuracy500: 0.3674 - 39s/epoch - 21ms/step
Epoch 13/50
1814/1814 - 42s - loss: 3.1553 - accuracy500: 0.4417 - val_loss: 3.4455 - val_accuracy500: 0.3667 - 42s/epoch - 23ms/step
Epoch 14/50
1814/1814 - 41s - loss: 3.1420 - accuracy500: 0.4479 - val_loss: 3.4687 - val_accuracy500: 0.3669 - 41s/epoch - 23ms/step
testing model: results/AAL/W8/deepVOL_L2/h500
Evaluating performance on  test set...
5918/5918 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186937
{'0': {'precision': 0.3831682856061562, 'recall': 0.23325756150381483, 'f1-score': 0.28998427098772944, 'support': 520862}, '1': {'precision': 0.3414639135657536, 'recall': 0.6128253921634614, 'f1-score': 0.4385625103085486, 'support': 490293}, '2': {'precision': 0.37139110500347483, 'recall': 0.23439773108426465, 'f1-score': 0.2874045448572249, 'support': 503853}, 'accuracy': 0.3564740252196688, 'macro avg': {'precision': 0.3653411013917949, 'recall': 0.36016022825051364, 'f1-score': 0.3386504420511676, 'support': 1515008}, 'weighted avg': {'precision': 0.3657549587728933, 'recall': 0.3564740252196688, 'f1-score': 0.3372098090319439, 'support': 1515008}}
[[121495 290760 108607]
 [ 98539 300464  91290]
 [ 97046 288705 118102]]
Evaluating performance on  train set...
1814/1814 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071321
{'0': {'precision': 0.39423918023909693, 'recall': 0.24514825583277752, 'f1-score': 0.30231137480685305, 'support': 154429}, '1': {'precision': 0.3506794944700407, 'recall': 0.5915699761155849, 'f1-score': 0.44033234646220054, 'support': 153238}, '2': {'precision': 0.3919817767653759, 'recall': 0.27469159451383035, 'f1-score': 0.3230190492637839, 'support': 156612}, 'accuracy': 0.36945241977345517, 'macro avg': {'precision': 0.3789668171581712, 'recall': 0.37046994215406426, 'f1-score': 0.3552209235109458, 'support': 464279}, 'weighted avg': {'precision': 0.3791005769408538, 'recall': 0.36945241977345517, 'f1-score': 0.3548511794643348, 'support': 464279}}
[[37858 82679 33892]
 [29749 90651 32838]
 [28421 85171 43020]]
Evaluating performance on  val set...
636/636 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111602
{'0': {'precision': 0.3616577718478986, 'recall': 0.24165149882990974, 'f1-score': 0.2897192099579149, 'support': 53842}, '1': {'precision': 0.36650082918739635, 'recall': 0.5784933769017252, 'f1-score': 0.44871873488270686, 'support': 56922}, '2': {'precision': 0.36301796796661157, 'recall': 0.2578043804611417, 'f1-score': 0.3014956615685877, 'support': 51958}, 'accuracy': 0.3646403067808901, 'macro avg': {'precision': 0.3637255230006355, 'recall': 0.3593164187309255, 'f1-score': 0.3466445354697365, 'support': 162722}, 'weighted avg': {'precision': 0.3637862460543057, 'recall': 0.3646403067808901, 'f1-score': 0.34909932961325557, 'support': 162722}}
[[13011 28676 12155]
 [12644 32929 11349]
 [10321 28242 13395]]
training model: results/AAL/W8/deepVOL_L2/h1000
Epoch 1/50
1814/1814 - 43s - loss: 3.1913 - accuracy1000: 0.4224 - val_loss: 3.8086 - val_accuracy1000: 0.2724 - 43s/epoch - 24ms/step
Epoch 2/50
1814/1814 - 40s - loss: 3.2117 - accuracy1000: 0.4071 - val_loss: 3.8844 - val_accuracy1000: 0.2723 - 40s/epoch - 22ms/step
Epoch 3/50
1814/1814 - 42s - loss: 3.2001 - accuracy1000: 0.4073 - val_loss: 4.0323 - val_accuracy1000: 0.2723 - 42s/epoch - 23ms/step
Epoch 4/50
1814/1814 - 41s - loss: 3.1994 - accuracy1000: 0.4066 - val_loss: 4.0782 - val_accuracy1000: 0.2723 - 41s/epoch - 22ms/step
Epoch 5/50
1814/1814 - 41s - loss: 3.2081 - accuracy1000: 0.4056 - val_loss: 4.0598 - val_accuracy1000: 0.2725 - 41s/epoch - 23ms/step
Epoch 6/50
1814/1814 - 41s - loss: 3.1989 - accuracy1000: 0.4093 - val_loss: 4.0764 - val_accuracy1000: 0.2730 - 41s/epoch - 22ms/step
Epoch 7/50
1814/1814 - 40s - loss: 3.1880 - accuracy1000: 0.4151 - val_loss: 4.2169 - val_accuracy1000: 0.2731 - 40s/epoch - 22ms/step
Epoch 8/50
1814/1814 - 43s - loss: 3.1796 - accuracy1000: 0.4207 - val_loss: 4.3477 - val_accuracy1000: 0.2726 - 43s/epoch - 24ms/step
Epoch 9/50
1814/1814 - 43s - loss: 3.1678 - accuracy1000: 0.4292 - val_loss: 4.1614 - val_accuracy1000: 0.2754 - 43s/epoch - 24ms/step
Epoch 10/50
1814/1814 - 40s - loss: 3.1671 - accuracy1000: 0.4278 - val_loss: 4.1931 - val_accuracy1000: 0.2751 - 40s/epoch - 22ms/step
Epoch 11/50
1814/1814 - 40s - loss: 3.1532 - accuracy1000: 0.4319 - val_loss: 4.2678 - val_accuracy1000: 0.2866 - 40s/epoch - 22ms/step
testing model: results/AAL/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
5918/5918 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2999821
{'0': {'precision': 0.45454545454545453, 'recall': 2.545055974264394e-05, 'f1-score': 5.089826962849353e-05, 'support': 589378}, '1': {'precision': 0.24462569366123713, 'recall': 0.9996060591343015, 'f1-score': 0.3930607381692291, 'support': 370614}, '2': {'precision': 0.34552102376599636, 'recall': 0.0003405307234386036, 'f1-score': 0.000680390882762171, 'support': 555016}, 'accuracy': 0.24466669482933423, 'macro avg': {'precision': 0.348230723990896, 'recall': 0.33332401347249424, 'f1-score': 0.1312640091072066, 'support': 1515008}, 'weighted avg': {'precision': 0.3632525334956415, 'recall': 0.24466669482933423, 'f1-score': 0.09642288262662302, 'support': 1515008}}
[[    15 589148    215]
 [     3 370468    143]
 [    15 554812    189]]
Evaluating performance on  train set...
1814/1814 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2140479
{'0': {'precision': 0.3157894736842105, 'recall': 3.892464189329458e-05, 'f1-score': 7.783968916017462e-05, 'support': 154144}, '1': {'precision': 0.3312267970377776, 'recall': 0.9996423485346044, 'f1-score': 0.4975821017265153, 'support': 153781}, '2': {'precision': 0.3624161073825503, 'recall': 0.00034537012164703176, 'f1-score': 0.0006900826182245708, 'support': 156354}, 'accuracy': 0.33123617480006634, 'macro avg': {'precision': 0.33647745936817947, 'recall': 0.3333422144327149, 'f1-score': 0.16611667467796667, 'support': 464279}, 'weighted avg': {'precision': 0.3366050343878071, 'recall': 0.33123617480006634, 'f1-score': 0.1650700739950354, 'support': 464279}}
[[     6 154090     48]
 [     8 153726     47]
 [     5 156295     54]]
Evaluating performance on  val set...
636/636 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2718896
{'0': {'precision': 0.25, 'recall': 1.6563421340312053e-05, 'f1-score': 3.3124648050614456e-05, 'support': 60374}, '1': {'precision': 0.27236677077441407, 'recall': 0.9996840798826583, 'f1-score': 0.42809723289220014, 'support': 44315}, '2': {'precision': 0.22727272727272727, 'recall': 0.00025847362707425087, 'f1-score': 0.00051636000619632, 'support': 58033}, 'accuracy': 0.2723479308268089, 'macro avg': {'precision': 0.24987983268238045, 'recall': 0.3333197056436909, 'f1-score': 0.142882239182149, 'support': 162722}, 'weighted avg': {'precision': 0.24798583860010534, 'recall': 0.2723479308268089, 'f1-score': 0.11678257803713604, 'support': 162722}}
[[    1 60335    38]
 [    1 44301    13]
 [    2 58016    15]]
training model: results/AAL/W8/deepVOL_L3/h10
Epoch 1/50
1814/1814 - 66s - loss: 2.9424 - accuracy10: 0.4761 - val_loss: 2.2840 - val_accuracy10: 0.6591 - 66s/epoch - 37ms/step
Epoch 2/50
1814/1814 - 63s - loss: 2.4752 - accuracy10: 0.5928 - val_loss: 2.1370 - val_accuracy10: 0.6704 - 63s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 63s - loss: 2.2973 - accuracy10: 0.6460 - val_loss: 2.0882 - val_accuracy10: 0.7479 - 63s/epoch - 34ms/step
Epoch 4/50
1814/1814 - 63s - loss: 2.2202 - accuracy10: 0.6650 - val_loss: 2.0387 - val_accuracy10: 0.7543 - 63s/epoch - 35ms/step
Epoch 5/50
1814/1814 - 62s - loss: 2.1773 - accuracy10: 0.6742 - val_loss: 2.0485 - val_accuracy10: 0.7827 - 62s/epoch - 34ms/step
Epoch 6/50
1814/1814 - 62s - loss: 2.1492 - accuracy10: 0.6800 - val_loss: 2.0009 - val_accuracy10: 0.7797 - 62s/epoch - 34ms/step
Epoch 7/50
1814/1814 - 66s - loss: 2.1240 - accuracy10: 0.6847 - val_loss: 2.0022 - val_accuracy10: 0.7651 - 66s/epoch - 36ms/step
Epoch 8/50
1814/1814 - 62s - loss: 2.1057 - accuracy10: 0.6866 - val_loss: 1.9949 - val_accuracy10: 0.7583 - 62s/epoch - 34ms/step
Epoch 9/50
1814/1814 - 63s - loss: 2.0880 - accuracy10: 0.6890 - val_loss: 1.9639 - val_accuracy10: 0.7544 - 63s/epoch - 35ms/step
Epoch 10/50
1814/1814 - 65s - loss: 2.0758 - accuracy10: 0.6900 - val_loss: 1.9877 - val_accuracy10: 0.7695 - 65s/epoch - 36ms/step
Epoch 11/50
1814/1814 - 68s - loss: 2.0591 - accuracy10: 0.6925 - val_loss: 1.9863 - val_accuracy10: 0.7499 - 68s/epoch - 37ms/step
Epoch 12/50
1814/1814 - 65s - loss: 2.0464 - accuracy10: 0.6945 - val_loss: 1.9780 - val_accuracy10: 0.7766 - 65s/epoch - 36ms/step
Epoch 13/50
1814/1814 - 64s - loss: 2.0350 - accuracy10: 0.6955 - val_loss: 1.9371 - val_accuracy10: 0.7643 - 64s/epoch - 35ms/step
Epoch 14/50
1814/1814 - 67s - loss: 2.0229 - accuracy10: 0.6962 - val_loss: 1.8955 - val_accuracy10: 0.7704 - 67s/epoch - 37ms/step
Epoch 15/50
1814/1814 - 64s - loss: 2.0156 - accuracy10: 0.6962 - val_loss: 1.9155 - val_accuracy10: 0.7729 - 64s/epoch - 35ms/step
Epoch 16/50
1814/1814 - 65s - loss: 2.0055 - accuracy10: 0.6977 - val_loss: 1.8953 - val_accuracy10: 0.7529 - 65s/epoch - 36ms/step
Epoch 17/50
1814/1814 - 65s - loss: 1.9980 - accuracy10: 0.6986 - val_loss: 1.8702 - val_accuracy10: 0.7725 - 65s/epoch - 36ms/step
Epoch 18/50
1814/1814 - 64s - loss: 1.9911 - accuracy10: 0.6999 - val_loss: 1.9027 - val_accuracy10: 0.7692 - 64s/epoch - 35ms/step
Epoch 19/50
1814/1814 - 64s - loss: 1.9840 - accuracy10: 0.7003 - val_loss: 1.8985 - val_accuracy10: 0.7628 - 64s/epoch - 35ms/step
Epoch 20/50
1814/1814 - 64s - loss: 1.9766 - accuracy10: 0.7010 - val_loss: 1.8797 - val_accuracy10: 0.7811 - 64s/epoch - 35ms/step
Epoch 21/50
1814/1814 - 64s - loss: 1.9714 - accuracy10: 0.7015 - val_loss: 1.9205 - val_accuracy10: 0.7986 - 64s/epoch - 35ms/step
Epoch 22/50
1814/1814 - 65s - loss: 1.9633 - accuracy10: 0.7016 - val_loss: 1.9041 - val_accuracy10: 0.7815 - 65s/epoch - 36ms/step
Epoch 23/50
1814/1814 - 64s - loss: 1.9572 - accuracy10: 0.7026 - val_loss: 1.9030 - val_accuracy10: 0.7899 - 64s/epoch - 35ms/step
Epoch 24/50
1814/1814 - 64s - loss: 1.9524 - accuracy10: 0.7038 - val_loss: 1.8953 - val_accuracy10: 0.7780 - 64s/epoch - 35ms/step
Epoch 25/50
1814/1814 - 64s - loss: 1.9469 - accuracy10: 0.7040 - val_loss: 1.9074 - val_accuracy10: 0.7908 - 64s/epoch - 35ms/step
Epoch 26/50
1814/1814 - 65s - loss: 1.9429 - accuracy10: 0.7031 - val_loss: 1.9141 - val_accuracy10: 0.7930 - 65s/epoch - 36ms/step
Epoch 27/50
1814/1814 - 64s - loss: 1.9379 - accuracy10: 0.7047 - val_loss: 1.9352 - val_accuracy10: 0.7849 - 64s/epoch - 35ms/step
testing model: results/AAL/W8/deepVOL_L3/h10
Evaluating performance on  test set...
5918/5918 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55142844
{'0': {'precision': 0.36452351346482537, 'recall': 0.6350505205143907, 'f1-score': 0.46317899244346555, 'support': 130640}, '1': {'precision': 0.9333689268553124, 'recall': 0.8078300774403263, 'f1-score': 0.866073884262225, 'support': 1255160}, '2': {'precision': 0.37111028223299763, 'recall': 0.5775261593709368, 'f1-score': 0.4518609798263913, 'support': 129208}, 'accuracy': 0.7732896459952687, 'macro avg': {'precision': 0.5563342408510451, 'recall': 0.6734689191085512, 'f1-score': 0.5937046188440273, 'support': 1515008}, 'weighted avg': {'precision': 0.8363646339672924, 'recall': 0.7732896459952687, 'f1-score': 0.7960057330554011, 'support': 1515008}}
[[  82963   34462   13215]
 [ 127965 1013956  113239]
 [  16665   37922   74621]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.631495
{'0': {'precision': 0.37965510915428363, 'recall': 0.598541503119448, 'f1-score': 0.46460872354073124, 'support': 48406}, '1': {'precision': 0.9301847846808174, 'recall': 0.7703226860105884, 'f1-score': 0.8427395400152762, 'support': 367385}, '2': {'precision': 0.37274692722082203, 'recall': 0.6435819171753836, 'f1-score': 0.47207787787333505, 'support': 48488}, 'accuracy': 0.7391762280869908, 'macro avg': {'precision': 0.5608622736853076, 'recall': 0.6708153687684734, 'f1-score': 0.5931420471431141, 'support': 464279}, 'weighted avg': {'precision': 0.8145689883470232, 'recall': 0.7391762280869908, 'f1-score': 0.7646045328833464, 'support': 464279}}
[[ 28973  10721   8712]
 [ 40579 283005  43801]
 [  6762  10520  31206]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5501458
{'0': {'precision': 0.3540396341463415, 'recall': 0.6231646418722516, 'f1-score': 0.451543218210785, 'support': 13417}, '1': {'precision': 0.939216711973999, 'recall': 0.80526288701483, 'f1-score': 0.8670968252711584, 'support': 136009}, '2': {'precision': 0.35221160257835077, 'recall': 0.5958935018050542, 'f1-score': 0.4427370009220195, 'support': 13296}, 'accuracy': 0.7731406939442731, 'macro avg': {'precision': 0.5484893162328971, 'recall': 0.6747736768973785, 'f1-score': 0.5871256814679876, 'support': 162722}, 'weighted avg': {'precision': 0.8430026733821785, 'recall': 0.7731406939442731, 'f1-score': 0.798158568794006, 'support': 162722}}
[[  8361   3506   1550]
 [ 13464 109523  13022]
 [  1791   3582   7923]]
training model: results/AAL/W8/deepVOL_L3/h20
Epoch 1/50
1814/1814 - 67s - loss: 3.0138 - accuracy20: 0.4339 - val_loss: 2.8961 - val_accuracy20: 0.7236 - 67s/epoch - 37ms/step
Epoch 2/50
1814/1814 - 63s - loss: 2.7564 - accuracy20: 0.4759 - val_loss: 2.3462 - val_accuracy20: 0.6637 - 63s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 66s - loss: 2.4559 - accuracy20: 0.6149 - val_loss: 2.4119 - val_accuracy20: 0.7332 - 66s/epoch - 36ms/step
Epoch 4/50
1814/1814 - 65s - loss: 2.3693 - accuracy20: 0.6396 - val_loss: 2.3061 - val_accuracy20: 0.7525 - 65s/epoch - 36ms/step
Epoch 5/50
1814/1814 - 65s - loss: 2.3228 - accuracy20: 0.6472 - val_loss: 2.3104 - val_accuracy20: 0.7632 - 65s/epoch - 36ms/step
Epoch 6/50
1814/1814 - 65s - loss: 2.2859 - accuracy20: 0.6493 - val_loss: 2.2395 - val_accuracy20: 0.7670 - 65s/epoch - 36ms/step
Epoch 7/50
1814/1814 - 65s - loss: 2.2544 - accuracy20: 0.6526 - val_loss: 2.2307 - val_accuracy20: 0.7641 - 65s/epoch - 36ms/step
Epoch 8/50
1814/1814 - 64s - loss: 2.2292 - accuracy20: 0.6555 - val_loss: 2.2014 - val_accuracy20: 0.7671 - 64s/epoch - 35ms/step
Epoch 9/50
1814/1814 - 65s - loss: 2.2082 - accuracy20: 0.6569 - val_loss: 2.1351 - val_accuracy20: 0.7615 - 65s/epoch - 36ms/step
Epoch 10/50
1814/1814 - 63s - loss: 2.1926 - accuracy20: 0.6592 - val_loss: 2.1131 - val_accuracy20: 0.7642 - 63s/epoch - 35ms/step
Epoch 11/50
1814/1814 - 64s - loss: 2.1803 - accuracy20: 0.6617 - val_loss: 2.1298 - val_accuracy20: 0.7709 - 64s/epoch - 35ms/step
Epoch 12/50
1814/1814 - 63s - loss: 2.1665 - accuracy20: 0.6642 - val_loss: 2.0864 - val_accuracy20: 0.7622 - 63s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 65s - loss: 2.1537 - accuracy20: 0.6655 - val_loss: 2.0700 - val_accuracy20: 0.7672 - 65s/epoch - 36ms/step
Epoch 14/50
1814/1814 - 64s - loss: 2.1460 - accuracy20: 0.6670 - val_loss: 2.0863 - val_accuracy20: 0.7676 - 64s/epoch - 35ms/step
Epoch 15/50
1814/1814 - 63s - loss: 2.1370 - accuracy20: 0.6691 - val_loss: 2.0760 - val_accuracy20: 0.7704 - 63s/epoch - 35ms/step
Epoch 16/50
1814/1814 - 63s - loss: 2.1305 - accuracy20: 0.6690 - val_loss: 2.0610 - val_accuracy20: 0.7612 - 63s/epoch - 35ms/step
Epoch 17/50
1814/1814 - 63s - loss: 2.1227 - accuracy20: 0.6698 - val_loss: 2.0671 - val_accuracy20: 0.7605 - 63s/epoch - 35ms/step
Epoch 18/50
1814/1814 - 63s - loss: 2.1137 - accuracy20: 0.6711 - val_loss: 2.0654 - val_accuracy20: 0.7629 - 63s/epoch - 35ms/step
Epoch 19/50
1814/1814 - 65s - loss: 2.1072 - accuracy20: 0.6722 - val_loss: 2.0858 - val_accuracy20: 0.7646 - 65s/epoch - 36ms/step
Epoch 20/50
1814/1814 - 64s - loss: 2.1004 - accuracy20: 0.6730 - val_loss: 2.0834 - val_accuracy20: 0.7643 - 64s/epoch - 35ms/step
Epoch 21/50
1814/1814 - 63s - loss: 2.0956 - accuracy20: 0.6732 - val_loss: 2.0499 - val_accuracy20: 0.7531 - 63s/epoch - 35ms/step
Epoch 22/50
1814/1814 - 64s - loss: 2.0874 - accuracy20: 0.6747 - val_loss: 2.0531 - val_accuracy20: 0.7546 - 64s/epoch - 35ms/step
Epoch 23/50
1814/1814 - 63s - loss: 2.0829 - accuracy20: 0.6752 - val_loss: 2.0565 - val_accuracy20: 0.7505 - 63s/epoch - 35ms/step
Epoch 24/50
1814/1814 - 63s - loss: 2.0784 - accuracy20: 0.6754 - val_loss: 2.0338 - val_accuracy20: 0.7407 - 63s/epoch - 35ms/step
Epoch 25/50
1814/1814 - 63s - loss: 2.0716 - accuracy20: 0.6756 - val_loss: 2.0408 - val_accuracy20: 0.7378 - 63s/epoch - 34ms/step
Epoch 26/50
1814/1814 - 64s - loss: 2.0688 - accuracy20: 0.6762 - val_loss: 2.0669 - val_accuracy20: 0.7507 - 64s/epoch - 35ms/step
Epoch 27/50
1814/1814 - 66s - loss: 2.0623 - accuracy20: 0.6772 - val_loss: 2.0851 - val_accuracy20: 0.7543 - 66s/epoch - 37ms/step
Epoch 28/50
1814/1814 - 64s - loss: 2.0569 - accuracy20: 0.6772 - val_loss: 2.1006 - val_accuracy20: 0.7572 - 64s/epoch - 35ms/step
Epoch 29/50
1814/1814 - 62s - loss: 2.0532 - accuracy20: 0.6775 - val_loss: 2.0612 - val_accuracy20: 0.7420 - 62s/epoch - 34ms/step
Epoch 30/50
1814/1814 - 62s - loss: 2.0475 - accuracy20: 0.6784 - val_loss: 2.1014 - val_accuracy20: 0.7567 - 62s/epoch - 34ms/step
Epoch 31/50
1814/1814 - 63s - loss: 2.0422 - accuracy20: 0.6787 - val_loss: 2.1191 - val_accuracy20: 0.7539 - 63s/epoch - 35ms/step
Epoch 32/50
1814/1814 - 63s - loss: 2.0382 - accuracy20: 0.6794 - val_loss: 2.1190 - val_accuracy20: 0.7548 - 63s/epoch - 35ms/step
Epoch 33/50
1814/1814 - 63s - loss: 2.0327 - accuracy20: 0.6803 - val_loss: 2.1321 - val_accuracy20: 0.7544 - 63s/epoch - 35ms/step
Epoch 34/50
1814/1814 - 63s - loss: 2.0303 - accuracy20: 0.6799 - val_loss: 2.1289 - val_accuracy20: 0.7486 - 63s/epoch - 35ms/step
testing model: results/AAL/W8/deepVOL_L3/h20
Evaluating performance on  test set...
5918/5918 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6073022
{'0': {'precision': 0.4374451470380471, 'recall': 0.5717659172047944, 'f1-score': 0.49566683240961945, 'support': 178706}, '1': {'precision': 0.8867895455075132, 'recall': 0.7940794999646429, 'f1-score': 0.8378777642046165, 'support': 1159598}, '2': {'precision': 0.4138450271947075, 'recall': 0.5692570626584571, 'f1-score': 0.4792670201969669, 'support': 176704}, 'accuracy': 0.7416337075447786, 'macro avg': {'precision': 0.5793599065800893, 'recall': 0.6450341599426315, 'f1-score': 0.6042705389370676, 'support': 1515008}, 'weighted avg': {'precision': 0.7786239594268916, 'recall': 0.7416337075447786, 'f1-score': 0.7556847330876293, 'support': 1515008}}
[[102178  59363  17165]
 [113478 920813 125307]
 [ 17923  58191 100590]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64730865
{'0': {'precision': 0.4321169763167445, 'recall': 0.5760593055013656, 'f1-score': 0.4938124607007639, 'support': 64075}, '1': {'precision': 0.8828947142243232, 'recall': 0.7639076452635775, 'f1-score': 0.8191025696228573, 'support': 336182}, '2': {'precision': 0.4348695800420526, 'recall': 0.5976383118303084, 'f1-score': 0.50342418441256, 'support': 64022}, 'accuracy': 0.7150549561793663, 'macro avg': {'precision': 0.58329375686104, 'recall': 0.6458684208650839, 'f1-score': 0.6054464049120604, 'support': 464279}, 'weighted avg': {'precision': 0.7589023546796412, 'recall': 0.7150549561793663, 'f1-score': 0.7306787440629746, 'support': 464279}}
[[ 36911  17902   9262]
 [ 38909 256812  40461]
 [  9599  16161  38262]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60587096
{'0': {'precision': 0.40352253559800727, 'recall': 0.5666831928606841, 'f1-score': 0.47138340283187463, 'support': 18153}, '1': {'precision': 0.8989061683455571, 'recall': 0.7879663854926863, 'f1-score': 0.8397882137055026, 'support': 126612}, '2': {'precision': 0.39587699577030067, 'recall': 0.5785487553600267, 'f1-score': 0.47009049773755657, 'support': 17957}, 'accuracy': 0.7401703518884969, 'macro avg': {'precision': 0.5661018999046217, 'recall': 0.6443994445711323, 'f1-score': 0.5937540380916446, 'support': 162722}, 'weighted avg': {'precision': 0.7881307726572042, 'recall': 0.7401703518884969, 'f1-score': 0.7578920077995688, 'support': 162722}}
[[10287  5803  2063]
 [13055 99766 13791]
 [ 2151  5417 10389]]
training model: results/AAL/W8/deepVOL_L3/h30
Epoch 1/50
1814/1814 - 67s - loss: 3.0236 - accuracy30: 0.4348 - val_loss: 3.0740 - val_accuracy30: 0.6820 - 67s/epoch - 37ms/step
Epoch 2/50
1814/1814 - 64s - loss: 2.8347 - accuracy30: 0.4779 - val_loss: 2.5379 - val_accuracy30: 0.6594 - 64s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 63s - loss: 2.6062 - accuracy30: 0.5816 - val_loss: 2.4783 - val_accuracy30: 0.6768 - 63s/epoch - 35ms/step
Epoch 4/50
1814/1814 - 64s - loss: 2.5009 - accuracy30: 0.6098 - val_loss: 2.4232 - val_accuracy30: 0.6859 - 64s/epoch - 35ms/step
Epoch 5/50
1814/1814 - 64s - loss: 2.4472 - accuracy30: 0.6202 - val_loss: 2.4110 - val_accuracy30: 0.6961 - 64s/epoch - 35ms/step
Epoch 6/50
1814/1814 - 63s - loss: 2.4086 - accuracy30: 0.6272 - val_loss: 2.3980 - val_accuracy30: 0.7057 - 63s/epoch - 35ms/step
Epoch 7/50
1814/1814 - 63s - loss: 2.3804 - accuracy30: 0.6323 - val_loss: 2.3958 - val_accuracy30: 0.7056 - 63s/epoch - 35ms/step
Epoch 8/50
1814/1814 - 62s - loss: 2.3597 - accuracy30: 0.6355 - val_loss: 2.3949 - val_accuracy30: 0.7099 - 62s/epoch - 34ms/step
Epoch 9/50
1814/1814 - 63s - loss: 2.3402 - accuracy30: 0.6381 - val_loss: 2.3961 - val_accuracy30: 0.7185 - 63s/epoch - 35ms/step
Epoch 10/50
1814/1814 - 62s - loss: 2.3272 - accuracy30: 0.6378 - val_loss: 2.3430 - val_accuracy30: 0.7181 - 62s/epoch - 34ms/step
Epoch 11/50
1814/1814 - 63s - loss: 2.3092 - accuracy30: 0.6412 - val_loss: 2.3322 - val_accuracy30: 0.7169 - 63s/epoch - 35ms/step
Epoch 12/50
1814/1814 - 63s - loss: 2.3002 - accuracy30: 0.6406 - val_loss: 2.3488 - val_accuracy30: 0.7187 - 63s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 63s - loss: 2.2867 - accuracy30: 0.6431 - val_loss: 2.3299 - val_accuracy30: 0.7256 - 63s/epoch - 35ms/step
Epoch 14/50
1814/1814 - 63s - loss: 2.2774 - accuracy30: 0.6428 - val_loss: 2.3350 - val_accuracy30: 0.7231 - 63s/epoch - 35ms/step
Epoch 15/50
1814/1814 - 63s - loss: 2.2664 - accuracy30: 0.6451 - val_loss: 2.3711 - val_accuracy30: 0.7306 - 63s/epoch - 35ms/step
Epoch 16/50
1814/1814 - 63s - loss: 2.2599 - accuracy30: 0.6457 - val_loss: 2.3259 - val_accuracy30: 0.7202 - 63s/epoch - 35ms/step
Epoch 17/50
1814/1814 - 62s - loss: 2.2531 - accuracy30: 0.6456 - val_loss: 2.3611 - val_accuracy30: 0.7184 - 62s/epoch - 34ms/step
Epoch 18/50
1814/1814 - 62s - loss: 2.2427 - accuracy30: 0.6475 - val_loss: 2.3510 - val_accuracy30: 0.7106 - 62s/epoch - 34ms/step
Epoch 19/50
1814/1814 - 62s - loss: 2.2375 - accuracy30: 0.6478 - val_loss: 2.3549 - val_accuracy30: 0.7160 - 62s/epoch - 34ms/step
Epoch 20/50
1814/1814 - 63s - loss: 2.2323 - accuracy30: 0.6486 - val_loss: 2.3545 - val_accuracy30: 0.7131 - 63s/epoch - 34ms/step
Epoch 21/50
1814/1814 - 64s - loss: 2.2240 - accuracy30: 0.6497 - val_loss: 2.3647 - val_accuracy30: 0.7171 - 64s/epoch - 35ms/step
Epoch 22/50
1814/1814 - 63s - loss: 2.2186 - accuracy30: 0.6498 - val_loss: 2.3728 - val_accuracy30: 0.7286 - 63s/epoch - 35ms/step
Epoch 23/50
1814/1814 - 63s - loss: 2.2140 - accuracy30: 0.6511 - val_loss: 2.3502 - val_accuracy30: 0.7139 - 63s/epoch - 35ms/step
Epoch 24/50
1814/1814 - 62s - loss: 2.2083 - accuracy30: 0.6512 - val_loss: 2.3371 - val_accuracy30: 0.7119 - 62s/epoch - 34ms/step
Epoch 25/50
1814/1814 - 63s - loss: 2.2027 - accuracy30: 0.6519 - val_loss: 2.3476 - val_accuracy30: 0.7132 - 63s/epoch - 35ms/step
Epoch 26/50
1814/1814 - 62s - loss: 2.1993 - accuracy30: 0.6522 - val_loss: 2.3457 - val_accuracy30: 0.7135 - 62s/epoch - 34ms/step
testing model: results/AAL/W8/deepVOL_L3/h30
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6786398
{'0': {'precision': 0.4368175466886535, 'recall': 0.5524625564076299, 'f1-score': 0.4878807079451295, 'support': 216726}, '1': {'precision': 0.8321030317138285, 'recall': 0.7877496148069055, 'f1-score': 0.8093190996355686, 'support': 1084521}, '2': {'precision': 0.4650780608052588, 'recall': 0.4660157839830465, 'f1-score': 0.4655464501942971, 'support': 213761}, 'accuracy': 0.7086959276782697, 'macro avg': {'precision': 0.5779995464025802, 'recall': 0.6020759850658607, 'f1-score': 0.5875820859249984, 'support': 1515008}, 'weighted avg': {'precision': 0.7237707543701095, 'recall': 0.7086959276782697, 'f1-score': 0.7148316499358193, 'support': 1515008}}
[[119733  79598  17395]
 [133009 854331  97181]
 [ 21361  92784  99616]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72783124
{'0': {'precision': 0.4477213300564477, 'recall': 0.5256667018024666, 'f1-score': 0.4835732250537862, 'support': 75896}, '1': {'precision': 0.8192725272785296, 'recall': 0.7720337708788555, 'f1-score': 0.7949519955330893, 'support': 312577}, '2': {'precision': 0.46607373226158577, 'recall': 0.49564678257657707, 'f1-score': 0.48040556954904035, 'support': 75806}, 'accuracy': 0.6866323912991973, 'macro avg': {'precision': 0.5776891965321876, 'recall': 0.5977824184192997, 'f1-score': 0.5863102633786387, 'support': 464279}, 'weighted avg': {'precision': 0.7008656264292094, 'recall': 0.6866323912991973, 'f1-score': 0.6926925577113398, 'support': 464279}}
[[ 39896  24773  11227]
 [ 39441 241320  31816]
 [  9772  28461  37573]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6637868
{'0': {'precision': 0.4195321763501132, 'recall': 0.5308237861429351, 'f1-score': 0.4686615690288398, 'support': 21996}, '1': {'precision': 0.845129096017656, 'recall': 0.8008634374553792, 'f1-score': 0.8224010488093082, 'support': 119059}, '2': {'precision': 0.45382454232372665, 'recall': 0.4622236580975677, 'f1-score': 0.45798559506116376, 'support': 21667}, 'accuracy': 0.7192696746598494, 'macro avg': {'precision': 0.5728286048971652, 'recall': 0.5979702938986273, 'f1-score': 0.5830160709664373, 'support': 162722}, 'weighted avg': {'precision': 0.7354953303935017, 'recall': 0.7192696746598494, 'f1-score': 0.7260610134507689, 'support': 162722}}
[[11676  8114  2206]
 [13862 95350  9847]
 [ 2293  9359 10015]]
training model: results/AAL/W8/deepVOL_L3/h50
Epoch 1/50
1814/1814 - 64s - loss: 3.0573 - accuracy50: 0.4545 - val_loss: 3.0673 - val_accuracy50: 0.6100 - 64s/epoch - 35ms/step
Epoch 2/50
1814/1814 - 63s - loss: 2.9892 - accuracy50: 0.4292 - val_loss: 3.0492 - val_accuracy50: 0.6106 - 63s/epoch - 34ms/step
Epoch 3/50
1814/1814 - 66s - loss: 2.8280 - accuracy50: 0.5189 - val_loss: 2.7364 - val_accuracy50: 0.6283 - 66s/epoch - 36ms/step
Epoch 4/50
1814/1814 - 67s - loss: 2.6983 - accuracy50: 0.5652 - val_loss: 2.6540 - val_accuracy50: 0.6604 - 67s/epoch - 37ms/step
Epoch 5/50
1814/1814 - 64s - loss: 2.6338 - accuracy50: 0.5834 - val_loss: 2.6125 - val_accuracy50: 0.6617 - 64s/epoch - 35ms/step
Epoch 6/50
1814/1814 - 63s - loss: 2.5933 - accuracy50: 0.5927 - val_loss: 2.6187 - val_accuracy50: 0.6692 - 63s/epoch - 35ms/step
Epoch 7/50
1814/1814 - 64s - loss: 2.5659 - accuracy50: 0.5967 - val_loss: 2.6121 - val_accuracy50: 0.6779 - 64s/epoch - 35ms/step
Epoch 8/50
1814/1814 - 63s - loss: 2.5445 - accuracy50: 0.5998 - val_loss: 2.5601 - val_accuracy50: 0.6716 - 63s/epoch - 35ms/step
Epoch 9/50
1814/1814 - 67s - loss: 2.5276 - accuracy50: 0.6025 - val_loss: 2.5653 - val_accuracy50: 0.6775 - 67s/epoch - 37ms/step
Epoch 10/50
1814/1814 - 67s - loss: 2.5110 - accuracy50: 0.6046 - val_loss: 2.5444 - val_accuracy50: 0.6661 - 67s/epoch - 37ms/step
Epoch 11/50
1814/1814 - 64s - loss: 2.4970 - accuracy50: 0.6066 - val_loss: 2.5415 - val_accuracy50: 0.6776 - 64s/epoch - 35ms/step
Epoch 12/50
1814/1814 - 64s - loss: 2.4889 - accuracy50: 0.6070 - val_loss: 2.5321 - val_accuracy50: 0.6752 - 64s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 61s - loss: 2.4794 - accuracy50: 0.6077 - val_loss: 2.5371 - val_accuracy50: 0.6661 - 61s/epoch - 34ms/step
Epoch 14/50
1814/1814 - 65s - loss: 2.4664 - accuracy50: 0.6101 - val_loss: 2.5469 - val_accuracy50: 0.6842 - 65s/epoch - 36ms/step
Epoch 15/50
1814/1814 - 65s - loss: 2.4568 - accuracy50: 0.6110 - val_loss: 2.5333 - val_accuracy50: 0.6704 - 65s/epoch - 36ms/step
Epoch 16/50
1814/1814 - 68s - loss: 2.4504 - accuracy50: 0.6114 - val_loss: 2.5426 - val_accuracy50: 0.6824 - 68s/epoch - 37ms/step
Epoch 17/50
1814/1814 - 68s - loss: 2.4433 - accuracy50: 0.6128 - val_loss: 2.5373 - val_accuracy50: 0.6801 - 68s/epoch - 38ms/step
Epoch 18/50
1814/1814 - 65s - loss: 2.4377 - accuracy50: 0.6144 - val_loss: 2.5561 - val_accuracy50: 0.6808 - 65s/epoch - 36ms/step
Epoch 19/50
1814/1814 - 64s - loss: 2.4316 - accuracy50: 0.6142 - val_loss: 2.5342 - val_accuracy50: 0.6711 - 64s/epoch - 35ms/step
Epoch 20/50
1814/1814 - 70s - loss: 2.4257 - accuracy50: 0.6154 - val_loss: 2.5428 - val_accuracy50: 0.6775 - 70s/epoch - 38ms/step
Epoch 21/50
1814/1814 - 66s - loss: 2.4200 - accuracy50: 0.6157 - val_loss: 2.5487 - val_accuracy50: 0.6764 - 66s/epoch - 36ms/step
Epoch 22/50
1814/1814 - 65s - loss: 2.4140 - accuracy50: 0.6167 - val_loss: 2.5579 - val_accuracy50: 0.6771 - 65s/epoch - 36ms/step
testing model: results/AAL/W8/deepVOL_L3/h50
Evaluating performance on  test set...
5918/5918 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7699076
{'0': {'precision': 0.48125594265141075, 'recall': 0.4816761950927418, 'f1-score': 0.48146597716669665, 'support': 280564}, '1': {'precision': 0.736040710418078, 'recall': 0.8085272927849275, 'f1-score': 0.7705831038060253, 'support': 958147}, '2': {'precision': 0.5263412808489092, 'recall': 0.3461202980850317, 'f1-score': 0.4176170170025918, 'support': 276297}, 'accuracy': 0.6636671225498479, 'macro avg': {'precision': 0.581212644639466, 'recall': 0.545441261987567, 'f1-score': 0.5565553659917714, 'support': 1515008}, 'weighted avg': {'precision': 0.6506135992243681, 'recall': 0.6636671225498479, 'f1-score': 0.6526699783281632, 'support': 1515008}}
[[135141 130182  15241]
 [112640 774688  70819]
 [ 33028 147637  95632]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7981198
{'0': {'precision': 0.4643445100683626, 'recall': 0.5296301797118669, 'f1-score': 0.4948433171273237, 'support': 94262}, '1': {'precision': 0.7317242128711526, 'recall': 0.7832107847591493, 'f1-score': 0.7565925876510006, 'support': 275129}, '2': {'precision': 0.5282612884578328, 'recall': 0.34670348199983136, 'f1-score': 0.4186454913338932, 'support': 94888}, 'accuracy': 0.6425145225177102, 'macro avg': {'precision': 0.5747766704657827, 'recall': 0.5531814821569492, 'f1-score': 0.5566937987040725, 'support': 464279}, 'weighted avg': {'precision': 0.6358552730368554, 'recall': 0.6425145225177102, 'f1-score': 0.6343813013049876, 'support': 464279}}
[[ 49924  37076   7262]
 [ 37529 215484  22116]
 [ 20062  41928  32898]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7505956
{'0': {'precision': 0.45493478047664193, 'recall': 0.4898275255191834, 'f1-score': 0.47173680909845933, 'support': 28410}, '1': {'precision': 0.7638669762989488, 'recall': 0.8097130616156492, 'f1-score': 0.7861221585726276, 'support': 106434}, '2': {'precision': 0.5100719797006887, 'recall': 0.3533252026687711, 'f1-score': 0.41747017313356927, 'support': 27878}, 'accuracy': 0.6756738486498445, 'macro avg': {'precision': 0.5762912454920931, 'recall': 0.5509552632678679, 'f1-score': 0.5584430469348854, 'support': 162722}, 'weighted avg': {'precision': 0.6664489222037556, 'recall': 0.6756738486498445, 'f1-score': 0.6680743971843016, 'support': 162722}}
[[13916 12604  1890]
 [12682 86181  7571]
 [ 3991 14037  9850]]
training model: results/AAL/W8/deepVOL_L3/h100
Epoch 1/50
1814/1814 - 67s - loss: 3.2056 - accuracy100: 0.4319 - val_loss: 3.2562 - val_accuracy100: 0.5132 - 67s/epoch - 37ms/step
Epoch 2/50
1814/1814 - 65s - loss: 3.1295 - accuracy100: 0.4384 - val_loss: 3.2194 - val_accuracy100: 0.5047 - 65s/epoch - 36ms/step
Epoch 3/50
1814/1814 - 63s - loss: 3.1065 - accuracy100: 0.4473 - val_loss: 3.2673 - val_accuracy100: 0.5230 - 63s/epoch - 35ms/step
Epoch 4/50
1814/1814 - 65s - loss: 3.0395 - accuracy100: 0.4752 - val_loss: 3.1472 - val_accuracy100: 0.5263 - 65s/epoch - 36ms/step
Epoch 5/50
1814/1814 - 65s - loss: 2.9589 - accuracy100: 0.5053 - val_loss: 3.0418 - val_accuracy100: 0.5477 - 65s/epoch - 36ms/step
Epoch 6/50
1814/1814 - 65s - loss: 2.9081 - accuracy100: 0.5209 - val_loss: 3.0549 - val_accuracy100: 0.5555 - 65s/epoch - 36ms/step
Epoch 7/50
1814/1814 - 67s - loss: 2.8718 - accuracy100: 0.5296 - val_loss: 3.0226 - val_accuracy100: 0.5594 - 67s/epoch - 37ms/step
Epoch 8/50
1814/1814 - 68s - loss: 2.8503 - accuracy100: 0.5328 - val_loss: 3.0301 - val_accuracy100: 0.5643 - 68s/epoch - 38ms/step
Epoch 9/50
1814/1814 - 67s - loss: 2.8282 - accuracy100: 0.5370 - val_loss: 2.9985 - val_accuracy100: 0.5649 - 67s/epoch - 37ms/step
Epoch 10/50
1814/1814 - 69s - loss: 2.8137 - accuracy100: 0.5405 - val_loss: 3.0009 - val_accuracy100: 0.5677 - 69s/epoch - 38ms/step
Epoch 11/50
1814/1814 - 67s - loss: 2.8003 - accuracy100: 0.5448 - val_loss: 2.9785 - val_accuracy100: 0.5681 - 67s/epoch - 37ms/step
Epoch 12/50
1814/1814 - 69s - loss: 2.7901 - accuracy100: 0.5457 - val_loss: 2.9993 - val_accuracy100: 0.5688 - 69s/epoch - 38ms/step
Epoch 13/50
1814/1814 - 67s - loss: 2.7840 - accuracy100: 0.5475 - val_loss: 2.9928 - val_accuracy100: 0.5724 - 67s/epoch - 37ms/step
Epoch 14/50
1814/1814 - 68s - loss: 2.7764 - accuracy100: 0.5491 - val_loss: 2.9929 - val_accuracy100: 0.5709 - 68s/epoch - 38ms/step
Epoch 15/50
1814/1814 - 67s - loss: 2.7714 - accuracy100: 0.5494 - val_loss: 2.9908 - val_accuracy100: 0.5681 - 67s/epoch - 37ms/step
Epoch 16/50
1814/1814 - 69s - loss: 2.7660 - accuracy100: 0.5507 - val_loss: 2.9932 - val_accuracy100: 0.5707 - 69s/epoch - 38ms/step
Epoch 17/50
1814/1814 - 64s - loss: 2.7578 - accuracy100: 0.5532 - val_loss: 3.0021 - val_accuracy100: 0.5665 - 64s/epoch - 35ms/step
Epoch 18/50
1814/1814 - 69s - loss: 2.7606 - accuracy100: 0.5514 - val_loss: 3.0001 - val_accuracy100: 0.5676 - 69s/epoch - 38ms/step
Epoch 19/50
1814/1814 - 67s - loss: 2.7459 - accuracy100: 0.5547 - val_loss: 2.9838 - val_accuracy100: 0.5635 - 67s/epoch - 37ms/step
Epoch 20/50
1814/1814 - 68s - loss: 2.7397 - accuracy100: 0.5548 - val_loss: 2.9832 - val_accuracy100: 0.5674 - 68s/epoch - 38ms/step
Epoch 21/50
1814/1814 - 67s - loss: 2.7344 - accuracy100: 0.5563 - val_loss: 3.0237 - val_accuracy100: 0.5675 - 67s/epoch - 37ms/step
testing model: results/AAL/W8/deepVOL_L3/h100
Evaluating performance on  test set...
5918/5918 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9553648
{'0': {'precision': 0.4954146178848237, 'recall': 0.38594204065308796, 'f1-score': 0.43387958040283897, 'support': 385063}, '1': {'precision': 0.5703048491549518, 'recall': 0.8188044267053701, 'f1-score': 0.6723274304973651, 'support': 749632}, '2': {'precision': 0.5499809026901984, 'recall': 0.20066892270314188, 'f1-score': 0.29404942628825065, 'support': 380313}, 'accuracy': 0.5536148984031768, 'macro avg': {'precision': 0.5385667899099914, 'recall': 0.4684717966872, 'f1-score': 0.4667521457294849, 'support': 1515008}, 'weighted avg': {'precision': 0.5461683969544228, 'recall': 0.5536148984031768, 'f1-score': 0.5167629139299743, 'support': 1515008}}
[[148612 214393  22058]
 [ 95442 613802  40388]
 [ 55921 248075  76317]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96042484
{'0': {'precision': 0.47798527986589484, 'recall': 0.4456918167312514, 'f1-score': 0.4612740286384719, 'support': 122836}, '1': {'precision': 0.5729858766589931, 'recall': 0.8055233307553493, 'f1-score': 0.669641507448264, 'support': 217224}, '2': {'precision': 0.5428416852640833, 'recall': 0.19385923248456355, 'f1-score': 0.2856922529362914, 'support': 124219}, 'accuracy': 0.5466691364459733, 'macro avg': {'precision': 0.5312709472629904, 'recall': 0.4816914599903881, 'f1-score': 0.4722025963410091, 'support': 464279}, 'weighted avg': {'precision': 0.5397860665909924, 'recall': 0.5466691364459733, 'f1-score': 0.511786381385482, 'support': 464279}}
[[ 54747  59820   8269]
 [ 30234 174979  12011]
 [ 29556  70582  24081]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93172526
{'0': {'precision': 0.4630902704812224, 'recall': 0.3936107779847414, 'f1-score': 0.42553308874237955, 'support': 39191}, '1': {'precision': 0.6034535120829537, 'recall': 0.8193042187481593, 'f1-score': 0.6950051966741285, 'support': 84883}, '2': {'precision': 0.5333192150218834, 'recall': 0.1954823018008694, 'f1-score': 0.28609838300450635, 'support': 38648}, 'accuracy': 0.5686139550890476, 'macro avg': {'precision': 0.5332876658620198, 'recall': 0.46946576617792335, 'f1-score': 0.46887888947367146, 'support': 162722}, 'weighted avg': {'precision': 0.5529899846285855, 'recall': 0.5686139550890476, 'f1-score': 0.5329846222179595, 'support': 162722}}
[[15426 21321  2444]
 [11171 69545  4167]
 [ 6714 24379  7555]]
training model: results/AAL/W8/deepVOL_L3/h200
Epoch 1/50
1814/1814 - 65s - loss: 3.2259 - accuracy200: 0.4054 - val_loss: 3.3833 - val_accuracy200: 0.4003 - 65s/epoch - 36ms/step
Epoch 2/50
1814/1814 - 63s - loss: 3.2025 - accuracy200: 0.4193 - val_loss: 3.2793 - val_accuracy200: 0.4066 - 63s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 63s - loss: 3.2049 - accuracy200: 0.4149 - val_loss: 3.3044 - val_accuracy200: 0.4141 - 63s/epoch - 34ms/step
Epoch 4/50
1814/1814 - 63s - loss: 3.1936 - accuracy200: 0.4211 - val_loss: 3.3729 - val_accuracy200: 0.4174 - 63s/epoch - 34ms/step
Epoch 5/50
1814/1814 - 64s - loss: 3.1761 - accuracy200: 0.4272 - val_loss: 3.4392 - val_accuracy200: 0.4272 - 64s/epoch - 35ms/step
Epoch 6/50
1814/1814 - 63s - loss: 3.1543 - accuracy200: 0.4392 - val_loss: 3.4803 - val_accuracy200: 0.4296 - 63s/epoch - 35ms/step
Epoch 7/50
1814/1814 - 63s - loss: 3.1388 - accuracy200: 0.4463 - val_loss: 3.4565 - val_accuracy200: 0.4289 - 63s/epoch - 35ms/step
Epoch 8/50
1814/1814 - 63s - loss: 3.1120 - accuracy200: 0.4573 - val_loss: 3.4268 - val_accuracy200: 0.4224 - 63s/epoch - 35ms/step
Epoch 9/50
1814/1814 - 62s - loss: 3.0948 - accuracy200: 0.4623 - val_loss: 3.3036 - val_accuracy200: 0.4397 - 62s/epoch - 34ms/step
Epoch 10/50
1814/1814 - 64s - loss: 3.0698 - accuracy200: 0.4695 - val_loss: 3.2838 - val_accuracy200: 0.4446 - 64s/epoch - 35ms/step
Epoch 11/50
1814/1814 - 63s - loss: 3.0563 - accuracy200: 0.4717 - val_loss: 3.2411 - val_accuracy200: 0.4481 - 63s/epoch - 35ms/step
Epoch 12/50
1814/1814 - 64s - loss: 3.0331 - accuracy200: 0.4775 - val_loss: 3.2592 - val_accuracy200: 0.4486 - 64s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 61s - loss: 3.0182 - accuracy200: 0.4800 - val_loss: 3.2239 - val_accuracy200: 0.4521 - 61s/epoch - 34ms/step
Epoch 14/50
1814/1814 - 64s - loss: 2.9986 - accuracy200: 0.4840 - val_loss: 3.2219 - val_accuracy200: 0.4538 - 64s/epoch - 36ms/step
Epoch 15/50
1814/1814 - 65s - loss: 2.9855 - accuracy200: 0.4870 - val_loss: 3.2208 - val_accuracy200: 0.4526 - 65s/epoch - 36ms/step
Epoch 16/50
1814/1814 - 65s - loss: 2.9744 - accuracy200: 0.4895 - val_loss: 3.2082 - val_accuracy200: 0.4550 - 65s/epoch - 36ms/step
Epoch 17/50
1814/1814 - 65s - loss: 2.9678 - accuracy200: 0.4905 - val_loss: 3.1871 - val_accuracy200: 0.4595 - 65s/epoch - 36ms/step
Epoch 18/50
1814/1814 - 66s - loss: 2.9566 - accuracy200: 0.4931 - val_loss: 3.2075 - val_accuracy200: 0.4593 - 66s/epoch - 36ms/step
Epoch 19/50
1814/1814 - 66s - loss: 2.9505 - accuracy200: 0.4941 - val_loss: 3.2158 - val_accuracy200: 0.4567 - 66s/epoch - 36ms/step
Epoch 20/50
1814/1814 - 66s - loss: 2.9417 - accuracy200: 0.4959 - val_loss: 3.2432 - val_accuracy200: 0.4545 - 66s/epoch - 36ms/step
Epoch 21/50
1814/1814 - 65s - loss: 2.9360 - accuracy200: 0.4972 - val_loss: 3.2943 - val_accuracy200: 0.4538 - 65s/epoch - 36ms/step
Epoch 22/50
1814/1814 - 65s - loss: 2.9340 - accuracy200: 0.4977 - val_loss: 3.2782 - val_accuracy200: 0.4529 - 65s/epoch - 36ms/step
Epoch 23/50
1814/1814 - 66s - loss: 2.9240 - accuracy200: 0.4988 - val_loss: 3.2757 - val_accuracy200: 0.4466 - 66s/epoch - 36ms/step
Epoch 24/50
1814/1814 - 66s - loss: 2.9161 - accuracy200: 0.5000 - val_loss: 3.3047 - val_accuracy200: 0.4469 - 66s/epoch - 36ms/step
Epoch 25/50
1814/1814 - 66s - loss: 2.9072 - accuracy200: 0.5023 - val_loss: 3.2866 - val_accuracy200: 0.4465 - 66s/epoch - 36ms/step
Epoch 26/50
1814/1814 - 65s - loss: 2.9021 - accuracy200: 0.5037 - val_loss: 3.2939 - val_accuracy200: 0.4450 - 65s/epoch - 36ms/step
Epoch 27/50
1814/1814 - 65s - loss: 2.8944 - accuracy200: 0.5050 - val_loss: 3.2825 - val_accuracy200: 0.4453 - 65s/epoch - 36ms/step
testing model: results/AAL/W8/deepVOL_L3/h200
Evaluating performance on  test set...
5918/5918 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0779697
{'0': {'precision': 0.4921128885688322, 'recall': 0.238645198036061, 'f1-score': 0.3214206723164316, 'support': 481074}, '1': {'precision': 0.42121180050519, 'recall': 0.8080852547148114, 'f1-score': 0.5537718383929676, 'support': 556544}, '2': {'precision': 0.4651890896686433, 'recall': 0.20852971365131234, 'f1-score': 0.287971026440976, 'support': 477390}, 'accuracy': 0.43834157971443055, 'macro avg': {'precision': 0.45950459291422185, 'recall': 0.4184200554673949, 'f1-score': 0.3877211790501251, 'support': 1515008}, 'weighted avg': {'precision': 0.45758321776032634, 'recall': 0.43834157971443055, 'f1-score': 0.3962355385933199, 'support': 1515008}}
[[114806 304833  61435]
 [ 53795 449735  53014]
 [ 64691 313149  99550]]
Evaluating performance on  train set...
1814/1814 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0431411
{'0': {'precision': 0.5002058659691443, 'recall': 0.27820733875747616, 'f1-score': 0.35755031378489505, 'support': 148472}, '1': {'precision': 0.4411401069306012, 'recall': 0.8028521617431486, 'f1-score': 0.5694091473067214, 'support': 165769}, '2': {'precision': 0.471278590176228, 'recall': 0.25131633319559044, 'f1-score': 0.32781854221727635, 'support': 150038}, 'accuracy': 0.45683952967935226, 'macro avg': {'precision': 0.47087485435865784, 'recall': 0.44412527789873835, 'f1-score': 0.41825933443629765, 'support': 464279}, 'weighted avg': {'precision': 0.46976842982519246, 'recall': 0.45683952967935226, 'f1-score': 0.42358545953048615, 'support': 464279}}
[[ 41306  82349  24817]
 [ 15195 133088  17486]
 [ 26077  86254  37707]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.052919
{'0': {'precision': 0.45755333043099694, 'recall': 0.23496057231119422, 'f1-score': 0.31048327536893555, 'support': 49204}, '1': {'precision': 0.4630963538180033, 'recall': 0.796557865323794, 'f1-score': 0.5856893700365188, 'support': 65134}, '2': {'precision': 0.4463021243115657, 'recall': 0.23447833994708994, 'f1-score': 0.3074359113327191, 'support': 48384}, 'accuracy': 0.4596120991629896, 'macro avg': {'precision': 0.45565060285352194, 'recall': 0.4219989258606927, 'f1-score': 0.4012028522460578, 'support': 162722}, 'weighted avg': {'precision': 0.4564266292375917, 'recall': 0.4596120991629896, 'f1-score': 0.4197360507069357, 'support': 162722}}
[[11561 30303  7340]
 [ 6516 51883  6735]
 [ 7190 29849 11345]]
training model: results/AAL/W8/deepVOL_L3/h300
Epoch 1/50
1814/1814 - 65s - loss: 3.2470 - accuracy300: 0.3912 - val_loss: 3.4529 - val_accuracy300: 0.3625 - 65s/epoch - 36ms/step
Epoch 2/50
1814/1814 - 64s - loss: 3.2317 - accuracy300: 0.4009 - val_loss: 3.4250 - val_accuracy300: 0.3625 - 64s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 64s - loss: 3.2417 - accuracy300: 0.3995 - val_loss: 3.3007 - val_accuracy300: 0.3736 - 64s/epoch - 35ms/step
Epoch 4/50
1814/1814 - 64s - loss: 3.2270 - accuracy300: 0.4076 - val_loss: 3.3875 - val_accuracy300: 0.3631 - 64s/epoch - 35ms/step
Epoch 5/50
1814/1814 - 63s - loss: 3.2401 - accuracy300: 0.4013 - val_loss: 3.2956 - val_accuracy300: 0.3697 - 63s/epoch - 35ms/step
Epoch 6/50
1814/1814 - 68s - loss: 3.2069 - accuracy300: 0.4171 - val_loss: 3.3145 - val_accuracy300: 0.3821 - 68s/epoch - 38ms/step
Epoch 7/50
1814/1814 - 63s - loss: 3.1817 - accuracy300: 0.4300 - val_loss: 3.2998 - val_accuracy300: 0.3989 - 63s/epoch - 35ms/step
Epoch 8/50
1814/1814 - 63s - loss: 3.1604 - accuracy300: 0.4363 - val_loss: 3.2774 - val_accuracy300: 0.4089 - 63s/epoch - 35ms/step
Epoch 9/50
1814/1814 - 63s - loss: 3.1380 - accuracy300: 0.4431 - val_loss: 3.2825 - val_accuracy300: 0.4106 - 63s/epoch - 35ms/step
Epoch 10/50
1814/1814 - 63s - loss: 3.1286 - accuracy300: 0.4435 - val_loss: 3.2944 - val_accuracy300: 0.4056 - 63s/epoch - 35ms/step
Epoch 11/50
1814/1814 - 63s - loss: 3.1182 - accuracy300: 0.4450 - val_loss: 3.2729 - val_accuracy300: 0.4077 - 63s/epoch - 35ms/step
Epoch 12/50
1814/1814 - 63s - loss: 3.1063 - accuracy300: 0.4484 - val_loss: 3.2951 - val_accuracy300: 0.4071 - 63s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 63s - loss: 3.0935 - accuracy300: 0.4514 - val_loss: 3.2987 - val_accuracy300: 0.4102 - 63s/epoch - 35ms/step
Epoch 14/50
1814/1814 - 67s - loss: 3.0810 - accuracy300: 0.4550 - val_loss: 3.3057 - val_accuracy300: 0.4077 - 67s/epoch - 37ms/step
Epoch 15/50
1814/1814 - 67s - loss: 3.0727 - accuracy300: 0.4570 - val_loss: 3.3009 - val_accuracy300: 0.4111 - 67s/epoch - 37ms/step
Epoch 16/50
1814/1814 - 63s - loss: 3.0632 - accuracy300: 0.4597 - val_loss: 3.3220 - val_accuracy300: 0.4092 - 63s/epoch - 35ms/step
Epoch 17/50
1814/1814 - 63s - loss: 3.0573 - accuracy300: 0.4625 - val_loss: 3.2896 - val_accuracy300: 0.4119 - 63s/epoch - 35ms/step
Epoch 18/50
1814/1814 - 62s - loss: 3.0509 - accuracy300: 0.4638 - val_loss: 3.2836 - val_accuracy300: 0.4097 - 62s/epoch - 34ms/step
Epoch 19/50
1814/1814 - 63s - loss: 3.0461 - accuracy300: 0.4654 - val_loss: 3.3194 - val_accuracy300: 0.4110 - 63s/epoch - 35ms/step
Epoch 20/50
1814/1814 - 64s - loss: 3.0376 - accuracy300: 0.4685 - val_loss: 3.3135 - val_accuracy300: 0.4119 - 64s/epoch - 35ms/step
Epoch 21/50
1814/1814 - 62s - loss: 3.0297 - accuracy300: 0.4704 - val_loss: 3.3242 - val_accuracy300: 0.4129 - 62s/epoch - 34ms/step
testing model: results/AAL/W8/deepVOL_L3/h300
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1109
{'0': {'precision': 0.43713079372864144, 'recall': 0.27155191775497967, 'f1-score': 0.334998168921784, 'support': 512031}, '1': {'precision': 0.3670652193581204, 'recall': 0.7322695213247047, 'f1-score': 0.48900605525731994, 'support': 498647}, '2': {'precision': 0.3990235505364536, 'recall': 0.15994884301945156, 'f1-score': 0.2283595969375406, 'support': 504330}, 'accuracy': 0.38604020572828657, 'macro avg': {'precision': 0.40107318787440516, 'recall': 0.3879234273663787, 'f1-score': 0.3507879403722149, 'support': 1515008}, 'weighted avg': {'precision': 0.4013840422776568, 'recall': 0.38604020572828657, 'f1-score': 0.35018920387918523, 'support': 1515008}}
[[139043 305489  67499]
 [ 79508 365144  53995]
 [ 99530 324133  80667]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.085461
{'0': {'precision': 0.44178177125651197, 'recall': 0.2990056220846353, 'f1-score': 0.35663466880671646, 'support': 154569}, '1': {'precision': 0.38829552354142516, 'recall': 0.73374185136897, 'f1-score': 0.5078416863686405, 'support': 153400}, '2': {'precision': 0.41595025217790005, 'recall': 0.18572068325762908, 'f1-score': 0.25678675995789507, 'support': 156310}, 'accuracy': 0.4045046189898746, 'macro avg': {'precision': 0.4153425156586124, 'recall': 0.4061560522370781, 'f1-score': 0.373754371711084, 'support': 464279}, 'weighted avg': {'precision': 0.41541289575994167, 'recall': 0.4045046189898746, 'f1-score': 0.3729781387070132, 'support': 464279}}
[[ 46217  84866  23486]
 [ 23568 112556  17276]
 [ 34830  92450  29030]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0920149
{'0': {'precision': 0.42045219447317866, 'recall': 0.2703226542013453, 'f1-score': 0.3290732237656284, 'support': 52626}, '1': {'precision': 0.4062194224156408, 'recall': 0.7390559831813096, 'f1-score': 0.524273712948987, 'support': 58982}, '2': {'precision': 0.3913244971730466, 'recall': 0.16519935829713972, 'f1-score': 0.2323226764981016, 'support': 51114}, 'accuracy': 0.4072036971030346, 'macro avg': {'precision': 0.40599870468728866, 'recall': 0.3915259985599316, 'f1-score': 0.3618898710709057, 'support': 162722}, 'weighted avg': {'precision': 0.40614367760823944, 'recall': 0.4072036971030346, 'f1-score': 0.369436590612032, 'support': 162722}}
[[14226 31500  6900]
 [ 9157 43591  6234]
 [10452 32218  8444]]
training model: results/AAL/W8/deepVOL_L3/h500
Epoch 1/50
1814/1814 - 66s - loss: 3.2725 - accuracy500: 0.3786 - val_loss: 3.3419 - val_accuracy500: 0.3498 - 66s/epoch - 36ms/step
Epoch 2/50
1814/1814 - 64s - loss: 3.2688 - accuracy500: 0.3801 - val_loss: 3.3138 - val_accuracy500: 0.3503 - 64s/epoch - 35ms/step
Epoch 3/50
1814/1814 - 68s - loss: 3.2709 - accuracy500: 0.3786 - val_loss: 3.3079 - val_accuracy500: 0.3499 - 68s/epoch - 38ms/step
Epoch 4/50
1814/1814 - 68s - loss: 3.2649 - accuracy500: 0.3833 - val_loss: 3.3139 - val_accuracy500: 0.3511 - 68s/epoch - 37ms/step
Epoch 5/50
1814/1814 - 68s - loss: 3.2519 - accuracy500: 0.3885 - val_loss: 3.3079 - val_accuracy500: 0.3528 - 68s/epoch - 37ms/step
Epoch 6/50
1814/1814 - 69s - loss: 3.2492 - accuracy500: 0.3942 - val_loss: 3.3344 - val_accuracy500: 0.3530 - 69s/epoch - 38ms/step
Epoch 7/50
1814/1814 - 66s - loss: 3.2399 - accuracy500: 0.3995 - val_loss: 3.3681 - val_accuracy500: 0.3580 - 66s/epoch - 36ms/step
Epoch 8/50
1814/1814 - 66s - loss: 3.2354 - accuracy500: 0.4017 - val_loss: 3.3778 - val_accuracy500: 0.3613 - 66s/epoch - 36ms/step
Epoch 9/50
1814/1814 - 69s - loss: 3.2325 - accuracy500: 0.4047 - val_loss: 3.3768 - val_accuracy500: 0.3596 - 69s/epoch - 38ms/step
Epoch 10/50
1814/1814 - 69s - loss: 3.2180 - accuracy500: 0.4128 - val_loss: 3.3529 - val_accuracy500: 0.3612 - 69s/epoch - 38ms/step
Epoch 11/50
1814/1814 - 69s - loss: 3.2107 - accuracy500: 0.4177 - val_loss: 3.3732 - val_accuracy500: 0.3580 - 69s/epoch - 38ms/step
Epoch 12/50
1814/1814 - 69s - loss: 3.2005 - accuracy500: 0.4230 - val_loss: 3.3931 - val_accuracy500: 0.3612 - 69s/epoch - 38ms/step
Epoch 13/50
1814/1814 - 70s - loss: 3.1880 - accuracy500: 0.4277 - val_loss: 3.3858 - val_accuracy500: 0.3608 - 70s/epoch - 38ms/step
testing model: results/AAL/W8/deepVOL_L3/h500
Evaluating performance on  test set...
5918/5918 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151465
{'0': {'precision': 0.4042378449408673, 'recall': 0.014174579831126095, 'f1-score': 0.027388773681848028, 'support': 520862}, '1': {'precision': 0.32366786875768355, 'recall': 0.9842951051718054, 'f1-score': 0.4871463569988685, 'support': 490293}, '2': {'precision': 0.3915547024952015, 'recall': 0.004453679942364142, 'f1-score': 0.008807183899023519, 'support': 503853}, 'accuracy': 0.32489597414667115, 'macro avg': {'precision': 0.37315347206458416, 'recall': 0.3343077883150986, 'f1-score': 0.17444743819324668, 'support': 1515008}, 'weighted avg': {'precision': 0.3739453747338072, 'recall': 0.32489597414667115, 'f1-score': 0.16999761471793923, 'support': 1515008}}
[[  7383 511562   1917]
 [  6130 482593   1570]
 [  4751 496858   2244]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078213
{'0': {'precision': 0.4303874092009685, 'recall': 0.013812172584164891, 'f1-score': 0.026765379427173195, 'support': 154429}, '1': {'precision': 0.3297025069540421, 'recall': 0.9838878085070283, 'f1-score': 0.49389870374070877, 'support': 153238}, '2': {'precision': 0.37346437346437344, 'recall': 0.004852757132275943, 'f1-score': 0.009581019496114014, 'support': 156612}, 'accuracy': 0.33096909401459035, 'macro avg': {'precision': 0.377851429873128, 'recall': 0.3341842460744897, 'f1-score': 0.1767483675546653, 'support': 464279}, 'weighted avg': {'precision': 0.3779543171953121, 'recall': 0.33096909401459035, 'f1-score': 0.17514878546887336, 'support': 464279}}
[[  2133 151792    504]
 [  1698 150769    771]
 [  1125 154727    760]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034507
{'0': {'precision': 0.366120218579235, 'recall': 0.012443817094461573, 'f1-score': 0.02406955022273315, 'support': 53842}, '1': {'precision': 0.3495862000199422, 'recall': 0.9854889146551421, 'f1-score': 0.5160957927373427, 'support': 56922}, '2': {'precision': 0.3691588785046729, 'recall': 0.003040917664267293, 'f1-score': 0.006032145993204291, 'support': 51958}, 'accuracy': 0.3498236255699905, 'macro avg': {'precision': 0.3616217657012834, 'recall': 0.333657883137957, 'f1-score': 0.1820658296510934, 'support': 162722}, 'weighted avg': {'precision': 0.3613066917541827, 'recall': 0.3498236255699905, 'f1-score': 0.1904264677105882, 'support': 162722}}
[[  670 53058   114]
 [  670 56096   156]
 [  490 51310   158]]
training model: results/AAL/W8/deepVOL_L3/h1000
Epoch 1/50
1814/1814 - 68s - loss: 3.1734 - accuracy1000: 0.4326 - val_loss: 4.4891 - val_accuracy1000: 0.2723 - 68s/epoch - 37ms/step
Epoch 2/50
1814/1814 - 70s - loss: 3.1957 - accuracy1000: 0.4197 - val_loss: 4.6664 - val_accuracy1000: 0.2723 - 70s/epoch - 38ms/step
Epoch 3/50
1814/1814 - 69s - loss: 3.2048 - accuracy1000: 0.4211 - val_loss: 3.7770 - val_accuracy1000: 0.2723 - 69s/epoch - 38ms/step
Epoch 4/50
1814/1814 - 66s - loss: 3.2229 - accuracy1000: 0.4117 - val_loss: 3.7379 - val_accuracy1000: 0.2723 - 66s/epoch - 36ms/step
Epoch 5/50
1814/1814 - 66s - loss: 3.2025 - accuracy1000: 0.4222 - val_loss: 3.5732 - val_accuracy1000: 0.2723 - 66s/epoch - 36ms/step
Epoch 6/50
1814/1814 - 65s - loss: 3.2232 - accuracy1000: 0.4103 - val_loss: 3.6106 - val_accuracy1000: 0.2723 - 65s/epoch - 36ms/step
Epoch 7/50
1814/1814 - 65s - loss: 3.2185 - accuracy1000: 0.4154 - val_loss: 3.6101 - val_accuracy1000: 0.2724 - 65s/epoch - 36ms/step
Epoch 8/50
1814/1814 - 65s - loss: 3.2375 - accuracy1000: 0.4089 - val_loss: 3.5019 - val_accuracy1000: 0.2724 - 65s/epoch - 36ms/step
Epoch 9/50
1814/1814 - 66s - loss: 3.2112 - accuracy1000: 0.4208 - val_loss: 3.5390 - val_accuracy1000: 0.2723 - 66s/epoch - 36ms/step
Epoch 10/50
1814/1814 - 66s - loss: 3.2018 - accuracy1000: 0.4263 - val_loss: 3.5698 - val_accuracy1000: 0.2723 - 66s/epoch - 37ms/step
Epoch 11/50
1814/1814 - 65s - loss: 3.2020 - accuracy1000: 0.4250 - val_loss: 3.7304 - val_accuracy1000: 0.2791 - 65s/epoch - 36ms/step
Epoch 12/50
1814/1814 - 64s - loss: 3.1879 - accuracy1000: 0.4293 - val_loss: 3.7569 - val_accuracy1000: 0.2723 - 64s/epoch - 35ms/step
Epoch 13/50
1814/1814 - 65s - loss: 3.1932 - accuracy1000: 0.4288 - val_loss: 3.5726 - val_accuracy1000: 0.2771 - 65s/epoch - 36ms/step
Epoch 14/50
1814/1814 - 69s - loss: 3.1682 - accuracy1000: 0.4426 - val_loss: 4.1304 - val_accuracy1000: 0.2725 - 69s/epoch - 38ms/step
Epoch 15/50
1814/1814 - 68s - loss: 3.1857 - accuracy1000: 0.4390 - val_loss: 3.5451 - val_accuracy1000: 0.2723 - 68s/epoch - 38ms/step
Epoch 16/50
1814/1814 - 68s - loss: 3.2032 - accuracy1000: 0.4261 - val_loss: 3.5449 - val_accuracy1000: 0.2811 - 68s/epoch - 38ms/step
Epoch 17/50
1814/1814 - 69s - loss: 3.1887 - accuracy1000: 0.4332 - val_loss: 3.6271 - val_accuracy1000: 0.2832 - 69s/epoch - 38ms/step
Epoch 18/50
1814/1814 - 69s - loss: 3.1560 - accuracy1000: 0.4474 - val_loss: 4.2671 - val_accuracy1000: 0.2733 - 69s/epoch - 38ms/step
testing model: results/AAL/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1815681
{'0': {'precision': 0.3478030704076231, 'recall': 0.0011147345167278045, 'f1-score': 0.0022223462496638573, 'support': 589378}, '1': {'precision': 0.24453751355666836, 'recall': 0.9983648755848403, 'f1-score': 0.3928509051566937, 'support': 370614}, '2': {'precision': 0.38461538461538464, 'recall': 1.801749859463511e-05, 'f1-score': 3.603330919101617e-05, 'support': 555016}, 'accuracy': 0.2446686750168976, 'macro avg': {'precision': 0.32565198952655866, 'recall': 0.3331658758667209, 'f1-score': 0.13170309490518284, 'support': 1515008}, 'weighted avg': {'precision': 0.3360273981310247, 'recall': 0.2446686750168976, 'f1-score': 0.09698024460254417, 'support': 1515008}}
[[   657 588708     13]
 [   603 370008      3]
 [   629 554377     10]]
Evaluating performance on  train set...
1814/1814 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1294247
{'0': {'precision': 0.3760330578512397, 'recall': 0.0011807141374299357, 'f1-score': 0.0023540367850583338, 'support': 154144}, '1': {'precision': 0.331274216187895, 'recall': 0.9990961172056366, 'f1-score': 0.49756789491751563, 'support': 153781}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 156354}, 'accuracy': 0.3313180221375509, 'macro avg': {'precision': 0.23576909134637822, 'recall': 0.33342561044768887, 'f1-score': 0.166640643900858, 'support': 464279}, 'weighted avg': {'precision': 0.23457214284732278, 'recall': 0.3313180221375509, 'f1-score': 0.1655886850245359, 'support': 464279}}
[[   182 153962      0]
 [   135 153642      4]
 [   167 156187      0]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1682208
{'0': {'precision': 0.42, 'recall': 0.0010434955444396596, 'f1-score': 0.0020818187826316835, 'support': 60374}, '1': {'precision': 0.2723363945599154, 'recall': 0.999074805370642, 'f1-score': 0.42800382819523797, 'support': 44315}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58033}, 'accuracy': 0.2724708398372685, 'macro avg': {'precision': 0.23077879818663846, 'recall': 0.3333727669716939, 'f1-score': 0.14336188232595656, 'support': 162722}, 'weighted avg': {'precision': 0.2299975868347405, 'recall': 0.2724708398372685, 'f1-score': 0.11733310415097269, 'support': 162722}}
[[   63 60311     0]
 [   40 44274     1]
 [   47 57986     0]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        27 (peak)  18.61 (ave)

============================================
