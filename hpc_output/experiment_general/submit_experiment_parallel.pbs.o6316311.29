This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-17.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-09.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-27.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-28.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-05.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-01.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-03.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-02.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-04.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-26.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-04-10.csv
training model: results/AAPL/W2/deepLOB_L1/h10
Epoch 1/50
6147/6147 - 106s - loss: 3.1008 - accuracy10: 0.4547 - val_loss: 3.5929 - val_accuracy10: 0.3620 - 106s/epoch - 17ms/step
Epoch 2/50
6147/6147 - 93s - loss: 3.0570 - accuracy10: 0.4687 - val_loss: 3.4720 - val_accuracy10: 0.3932 - 93s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 96s - loss: 3.0314 - accuracy10: 0.4783 - val_loss: 3.2802 - val_accuracy10: 0.4297 - 96s/epoch - 16ms/step
Epoch 4/50
6147/6147 - 95s - loss: 3.0168 - accuracy10: 0.4827 - val_loss: 3.2628 - val_accuracy10: 0.4357 - 95s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 95s - loss: 3.0043 - accuracy10: 0.4867 - val_loss: 3.2118 - val_accuracy10: 0.4375 - 95s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 94s - loss: 2.9958 - accuracy10: 0.4894 - val_loss: 3.2689 - val_accuracy10: 0.4290 - 94s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 95s - loss: 2.9882 - accuracy10: 0.4914 - val_loss: 3.2903 - val_accuracy10: 0.4248 - 95s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 95s - loss: 2.9820 - accuracy10: 0.4931 - val_loss: 3.2288 - val_accuracy10: 0.4322 - 95s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 95s - loss: 2.9758 - accuracy10: 0.4947 - val_loss: 3.2433 - val_accuracy10: 0.4296 - 95s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 93s - loss: 2.9709 - accuracy10: 0.4962 - val_loss: 3.3006 - val_accuracy10: 0.4250 - 93s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 91s - loss: 2.9671 - accuracy10: 0.4970 - val_loss: 3.2799 - val_accuracy10: 0.4258 - 91s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 92s - loss: 2.9647 - accuracy10: 0.4979 - val_loss: 3.2777 - val_accuracy10: 0.4248 - 92s/epoch - 15ms/step
Epoch 13/50
6147/6147 - 92s - loss: 2.9602 - accuracy10: 0.4992 - val_loss: 3.2479 - val_accuracy10: 0.4336 - 92s/epoch - 15ms/step
Epoch 14/50
6147/6147 - 93s - loss: 2.9566 - accuracy10: 0.5003 - val_loss: 3.2245 - val_accuracy10: 0.4372 - 93s/epoch - 15ms/step
Epoch 15/50
6147/6147 - 93s - loss: 2.9541 - accuracy10: 0.5010 - val_loss: 3.2553 - val_accuracy10: 0.4313 - 93s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h10
Evaluating performance on  test set...
14883/14883 - 77s - 77s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.049892
{'0': {'precision': 0.4520715761009625, 'recall': 0.43058134653831653, 'f1-score': 0.4410648466153715, 'support': 1124424}, '1': {'precision': 0.501756230882973, 'recall': 0.2471783503473811, 'f1-score': 0.33119922763461335, 'support': 1521096}, '2': {'precision': 0.4019888469763947, 'recall': 0.6868854556806675, 'f1-score': 0.5071665143720272, 'support': 1164379}, 'accuracy': 0.43568950253011957, 'macro avg': {'precision': 0.4519388846534434, 'recall': 0.45488171752212175, 'f1-score': 0.42647686287400405, 'support': 3809899}, 'weighted avg': {'precision': 0.45660184097017875, 'recall': 0.43568950253011957, 'f1-score': 0.4174031275597408, 'support': 3809899}}
[[484156 200915 439353]
 [394667 375982 750447]
 [192149 172435 799795]]
Evaluating performance on  train set...
6147/6147 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0757345
{'0': {'precision': 0.46325822345810913, 'recall': 0.3960658171470989, 'f1-score': 0.4270350604757358, 'support': 484980}, '1': {'precision': 0.46732963147266127, 'recall': 0.2970669210621009, 'f1-score': 0.3632360043548374, 'support': 597495}, '2': {'precision': 0.3970918015657753, 'recall': 0.6300279016720637, 'f1-score': 0.48714655891229397, 'support': 491010}, 'accuracy': 0.4314817109791323, 'macro avg': {'precision': 0.4425598854988486, 'recall': 0.4410535466270879, 'f1-score': 0.4258058745809557, 'support': 1573485}, 'weighted avg': {'precision': 0.4441568472888415, 'recall': 0.4314817109791323, 'f1-score': 0.4215667718110063, 'support': 1573485}}
[[192084  99351 193545]
 [143855 177496 276144]
 [ 78698 102962 309350]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0652105
{'0': {'precision': 0.45669172932330826, 'recall': 0.377506022741398, 'f1-score': 0.41334054887829597, 'support': 168943}, '1': {'precision': 0.5094688596768228, 'recall': 0.265035811844662, 'f1-score': 0.3486808996742772, 'support': 213058}, '2': {'precision': 0.4017031733531144, 'recall': 0.704446341896701, 'f1-score': 0.5116457171397654, 'support': 174503}, 'accuracy': 0.43696541264752814, 'macro avg': {'precision': 0.4559545874510818, 'recall': 0.448996058827587, 'f1-score': 0.4245557218974462, 'support': 556504}, 'weighted avg': {'precision': 0.4596547302296672, 'recall': 0.43696541264752814, 'f1-score': 0.4194111094439368, 'support': 556504}}
[[ 63777  28793  76373]
 [ 49874  56468 106716]
 [ 25999  25576 122928]]
training model: results/AAPL/W2/deepLOB_L1/h20
Epoch 1/50
6147/6147 - 92s - loss: 3.1520 - accuracy20: 0.4418 - val_loss: 3.3064 - val_accuracy20: 0.3718 - 92s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 92s - loss: 3.1241 - accuracy20: 0.4528 - val_loss: 3.2629 - val_accuracy20: 0.4017 - 92s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 90s - loss: 3.1022 - accuracy20: 0.4617 - val_loss: 3.3123 - val_accuracy20: 0.3896 - 90s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.0906 - accuracy20: 0.4659 - val_loss: 3.3579 - val_accuracy20: 0.3901 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 91s - loss: 3.0805 - accuracy20: 0.4696 - val_loss: 3.3071 - val_accuracy20: 0.3958 - 91s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 89s - loss: 3.0729 - accuracy20: 0.4720 - val_loss: 3.2988 - val_accuracy20: 0.3930 - 89s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 90s - loss: 3.0663 - accuracy20: 0.4739 - val_loss: 3.3025 - val_accuracy20: 0.3948 - 90s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 90s - loss: 3.0617 - accuracy20: 0.4754 - val_loss: 3.3197 - val_accuracy20: 0.3975 - 90s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 90s - loss: 3.0571 - accuracy20: 0.4766 - val_loss: 3.3228 - val_accuracy20: 0.4058 - 90s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 91s - loss: 3.0532 - accuracy20: 0.4780 - val_loss: 3.3750 - val_accuracy20: 0.3813 - 91s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 91s - loss: 3.0490 - accuracy20: 0.4789 - val_loss: 3.3916 - val_accuracy20: 0.3821 - 91s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 90s - loss: 3.0464 - accuracy20: 0.4796 - val_loss: 3.4226 - val_accuracy20: 0.3838 - 90s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h20
Evaluating performance on  test set...
14883/14883 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0847085
{'0': {'precision': 0.48844300205993235, 'recall': 0.20835827180921526, 'f1-score': 0.29210951128549195, 'support': 1206302}, '1': {'precision': 0.37218685951464814, 'recall': 0.7862947658402204, 'f1-score': 0.5052278312333742, 'support': 1350360}, '2': {'precision': 0.48070291207723354, 'recall': 0.16973006701844903, 'f1-score': 0.25087823067111154, 'support': 1253237}, 'accuracy': 0.40049250649426665, 'macro avg': {'precision': 0.44711092455060464, 'recall': 0.3881277015559616, 'f1-score': 0.34940519106332585, 'support': 3809899}, 'weighted avg': {'precision': 0.4446917604136059, 'recall': 0.40049250649426665, 'f1-score': 0.3540833032682973, 'support': 3809899}}
[[ 251343  854289  100670]
 [ 159459 1061781  129120]
 [ 103778  936747  212712]]
Evaluating performance on  train set...
6147/6147 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0952157
{'0': {'precision': 0.47525947281713343, 'recall': 0.22136769025059805, 'f1-score': 0.302047055713263, 'support': 521273}, '1': {'precision': 0.3508111503127266, 'recall': 0.663545814830731, 'f1-score': 0.45896913726627375, 'support': 523575}, '2': {'precision': 0.4423923869515782, 'recall': 0.2848343948683123, 'f1-score': 0.34654545454545455, 'support': 528637}, 'accuracy': 0.38982449785031315, 'macro avg': {'precision': 0.4228210033604794, 'recall': 0.38991596664988043, 'f1-score': 0.36918721584166375, 'support': 1573485}, 'weighted avg': {'precision': 0.42280724853412194, 'recall': 0.38982449785031315, 'f1-score': 0.369212601563761, 'support': 1573485}}
[[115393 315998  89882]
 [ 76252 347416  99907]
 [ 51155 326908 150574]]
Evaluating performance on  val set...
2174/2174 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878135
{'0': {'precision': 0.48117031810867683, 'recall': 0.1704278918871523, 'f1-score': 0.2517037084999272, 'support': 182476}, '1': {'precision': 0.3676172085011137, 'recall': 0.7187022389060196, 'f1-score': 0.48642655057083084, 'support': 186475}, '2': {'precision': 0.4576224589185283, 'recall': 0.3106268628067799, 'f1-score': 0.3700617097703431, 'support': 187553}, 'accuracy': 0.40139513822003076, 'macro avg': {'precision': 0.4354699951761063, 'recall': 0.3999189978666506, 'f1-score': 0.3693973229470337, 'support': 556504}, 'weighted avg': {'precision': 0.43518450713739854, 'recall': 0.40139513822003076, 'f1-score': 0.37024434825712943, 'support': 556504}}
[[ 31099 115422  35955]
 [ 19361 134020  33094]
 [ 14172 115122  58259]]
training model: results/AAPL/W2/deepLOB_L1/h30
Epoch 1/50
6147/6147 - 93s - loss: 3.1787 - accuracy30: 0.4310 - val_loss: 3.4730 - val_accuracy30: 0.3734 - 93s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 92s - loss: 3.1547 - accuracy30: 0.4423 - val_loss: 3.4678 - val_accuracy30: 0.3732 - 92s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 90s - loss: 3.1400 - accuracy30: 0.4478 - val_loss: 3.5426 - val_accuracy30: 0.3773 - 90s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.1315 - accuracy30: 0.4514 - val_loss: 3.5160 - val_accuracy30: 0.3870 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 90s - loss: 3.1257 - accuracy30: 0.4534 - val_loss: 3.4596 - val_accuracy30: 0.3835 - 90s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 91s - loss: 3.1206 - accuracy30: 0.4552 - val_loss: 3.4444 - val_accuracy30: 0.3863 - 91s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 93s - loss: 3.1155 - accuracy30: 0.4573 - val_loss: 3.5164 - val_accuracy30: 0.3859 - 93s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 90s - loss: 3.1112 - accuracy30: 0.4584 - val_loss: 3.5535 - val_accuracy30: 0.3873 - 90s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 94s - loss: 3.1073 - accuracy30: 0.4596 - val_loss: 3.5597 - val_accuracy30: 0.3816 - 94s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 91s - loss: 3.1052 - accuracy30: 0.4604 - val_loss: 3.5647 - val_accuracy30: 0.3811 - 91s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 92s - loss: 3.1015 - accuracy30: 0.4617 - val_loss: 3.4690 - val_accuracy30: 0.3774 - 92s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 93s - loss: 3.0994 - accuracy30: 0.4624 - val_loss: 3.5231 - val_accuracy30: 0.3686 - 93s/epoch - 15ms/step
Epoch 13/50
6147/6147 - 90s - loss: 3.0975 - accuracy30: 0.4631 - val_loss: 3.4997 - val_accuracy30: 0.3634 - 90s/epoch - 15ms/step
Epoch 14/50
6147/6147 - 90s - loss: 3.0950 - accuracy30: 0.4636 - val_loss: 3.4850 - val_accuracy30: 0.3710 - 90s/epoch - 15ms/step
Epoch 15/50
6147/6147 - 91s - loss: 3.0928 - accuracy30: 0.4641 - val_loss: 3.5339 - val_accuracy30: 0.3645 - 91s/epoch - 15ms/step
Epoch 16/50
6147/6147 - 98s - loss: 3.0908 - accuracy30: 0.4647 - val_loss: 3.5119 - val_accuracy30: 0.3721 - 98s/epoch - 16ms/step
testing model: results/AAPL/W2/deepLOB_L1/h30
Evaluating performance on  test set...
14883/14883 - 80s - 80s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.108616
{'0': {'precision': 0.5139684666821644, 'recall': 0.06391774667240327, 'f1-score': 0.11369610657535326, 'support': 1176074}, '1': {'precision': 0.3799030811965187, 'recall': 0.8507847756304154, 'f1-score': 0.5252603345423859, 'support': 1404669}, '2': {'precision': 0.456551750769914, 'recall': 0.19237183888782222, 'f1-score': 0.27068733898049935, 'support': 1229156}, 'accuracy': 0.39546927621965833, 'macro avg': {'precision': 0.45014109954953235, 'recall': 0.36902478706354697, 'f1-score': 0.3032145933660795, 'support': 3809899}, 'weighted avg': {'precision': 0.44601611628427346, 'recall': 0.39546927621965833, 'f1-score': 0.31608420867265385, 'support': 3809899}}
[[  75172  981254  119648]
 [  47786 1195071  161812]
 [  23300  969401  236455]]
Evaluating performance on  train set...
6147/6147 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1509246
{'0': {'precision': 0.4913278964078939, 'recall': 0.07556335978430712, 'f1-score': 0.13098239284096133, 'support': 522224}, '1': {'precision': 0.3423618262959149, 'recall': 0.7495996130074218, 'f1-score': 0.4700427748871109, 'support': 518873}, '2': {'precision': 0.43907868944273315, 'recall': 0.2945126486697672, 'f1-score': 0.3525511305380174, 'support': 532388}, 'accuracy': 0.37191520732641237, 'macro avg': {'precision': 0.42425613738218065, 'recall': 0.373225207153832, 'f1-score': 0.3178587660886965, 'support': 1573485}, 'weighted avg': {'precision': 0.42452629201066044, 'recall': 0.37191520732641237, 'f1-score': 0.31775876169003964, 'support': 1573485}}
[[ 39461 385345  97418]
 [ 27039 388947 102887]
 [ 13815 361778 156795]]
Evaluating performance on  val set...
2174/2174 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1483716
{'0': {'precision': 0.49970351043643263, 'recall': 0.04641491975016248, 'f1-score': 0.08494017800445514, 'support': 181558}, '1': {'precision': 0.36114363023221563, 'recall': 0.7677135898374695, 'f1-score': 0.49121335786893366, 'support': 188457}, '2': {'precision': 0.4436380115234389, 'recall': 0.3307165570087244, 'f1-score': 0.37894381125003834, 'support': 186489}, 'accuracy': 0.38595050529735636, 'macro avg': {'precision': 0.434828384064029, 'recall': 0.38161502219878546, 'f1-score': 0.3183657823744757, 'support': 556504}, 'weighted avg': {'precision': 0.4339929707629866, 'recall': 0.38595050529735636, 'f1-score': 0.3210453420608781, 'support': 556504}}
[[  8427 133608  39523]
 [  5953 144681  37823]
 [  2484 122330  61675]]
training model: results/AAPL/W2/deepLOB_L1/h50
Epoch 1/50
6147/6147 - 97s - loss: 3.1860 - accuracy50: 0.4308 - val_loss: 3.5892 - val_accuracy50: 0.3594 - 97s/epoch - 16ms/step
Epoch 2/50
6147/6147 - 99s - loss: 3.1765 - accuracy50: 0.4347 - val_loss: 3.4949 - val_accuracy50: 0.3504 - 99s/epoch - 16ms/step
Epoch 3/50
6147/6147 - 96s - loss: 3.1637 - accuracy50: 0.4398 - val_loss: 3.6347 - val_accuracy50: 0.3566 - 96s/epoch - 16ms/step
Epoch 4/50
6147/6147 - 96s - loss: 3.1567 - accuracy50: 0.4430 - val_loss: 3.5626 - val_accuracy50: 0.3546 - 96s/epoch - 16ms/step
Epoch 5/50
6147/6147 - 95s - loss: 3.1498 - accuracy50: 0.4458 - val_loss: 3.5646 - val_accuracy50: 0.3510 - 95s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 96s - loss: 3.1454 - accuracy50: 0.4481 - val_loss: 3.6088 - val_accuracy50: 0.3518 - 96s/epoch - 16ms/step
Epoch 7/50
6147/6147 - 98s - loss: 3.1411 - accuracy50: 0.4499 - val_loss: 3.5705 - val_accuracy50: 0.3488 - 98s/epoch - 16ms/step
Epoch 8/50
6147/6147 - 99s - loss: 3.1377 - accuracy50: 0.4514 - val_loss: 3.6466 - val_accuracy50: 0.3522 - 99s/epoch - 16ms/step
Epoch 9/50
6147/6147 - 101s - loss: 3.1337 - accuracy50: 0.4526 - val_loss: 3.5941 - val_accuracy50: 0.3512 - 101s/epoch - 16ms/step
Epoch 10/50
6147/6147 - 96s - loss: 3.1311 - accuracy50: 0.4536 - val_loss: 3.6235 - val_accuracy50: 0.3373 - 96s/epoch - 16ms/step
Epoch 11/50
6147/6147 - 101s - loss: 3.1291 - accuracy50: 0.4545 - val_loss: 3.7773 - val_accuracy50: 0.3392 - 101s/epoch - 16ms/step
Epoch 12/50
6147/6147 - 98s - loss: 3.1271 - accuracy50: 0.4550 - val_loss: 3.6840 - val_accuracy50: 0.3459 - 98s/epoch - 16ms/step
testing model: results/AAPL/W2/deepLOB_L1/h50
Evaluating performance on  test set...
14883/14883 - 83s - 83s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0706426
{'0': {'precision': 0.21692135669027207, 'recall': 0.028815625792955768, 'f1-score': 0.05087329206798402, 'support': 969474}, '1': {'precision': 0.4827132119081641, 'recall': 0.9427249538578304, 'f1-score': 0.6384925019573167, 'support': 1855136}, '2': {'precision': 0.2512739292108525, 'recall': 0.014813927690251286, 'f1-score': 0.027978381735460908, 'support': 985289}, 'accuracy': 0.47020012866482813, 'macro avg': {'precision': 0.3169694992697629, 'recall': 0.3287848357803458, 'f1-score': 0.23911472525358715, 'support': 3809899}, 'weighted avg': {'precision': 0.35522613877182574, 'recall': 0.47020012866482813, 'f1-score': 0.3310790002115951, 'support': 3809899}}
[[  27936  931811    9727]
 [  72488 1748883   33765]
 [  28360  942333   14596]]
Evaluating performance on  train set...
6147/6147 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1855474
{'0': {'precision': 0.31785766619450007, 'recall': 0.025047535468772853, 'f1-score': 0.04643587282671909, 'support': 519612}, '1': {'precision': 0.32802715004455213, 'recall': 0.9561360949707548, 'f1-score': 0.4884715389658196, 'support': 519402}, '2': {'precision': 0.350769561941664, 'recall': 0.0121952360371283, 'f1-score': 0.023570977826718235, 'support': 534471}, 'accuracy': 0.32803109022329413, 'macro avg': {'precision': 0.33221812606023876, 'recall': 0.331126288825552, 'f1-score': 0.18615946320641896, 'support': 1573485}, 'weighted avg': {'precision': 0.3323938734558131, 'recall': 0.32803109022329413, 'f1-score': 0.1845837330023392, 'support': 1573485}}
[[ 13015 501647   4950]
 [ 15669 496619   7114]
 [ 12262 515691   6518]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1684009
{'0': {'precision': 0.27328689454074195, 'recall': 0.019156740061092626, 'f1-score': 0.03580372681353198, 'support': 176126}, '1': {'precision': 0.3536876485002868, 'recall': 0.9509559975768378, 'f1-score': 0.5156065284516983, 'support': 199739}, '2': {'precision': 0.2677618646447627, 'recall': 0.010556967210845942, 'f1-score': 0.020313057557213694, 'support': 180639}, 'accuracy': 0.35080430688728204, 'macro avg': {'precision': 0.2982454692285971, 'recall': 0.3268899016162588, 'f1-score': 0.1905744376074813, 'support': 556504}, 'weighted avg': {'precision': 0.3003507257436546, 'recall': 0.35080430688728204, 'f1-score': 0.20298511776959632, 'support': 556504}}
[[  3374 171330   1422]
 [  6003 189943   3793]
 [  2969 175763   1907]]
training model: results/AAPL/W2/deepLOB_L1/h100
Epoch 1/50
6147/6147 - 93s - loss: 3.2301 - accuracy100: 0.4067 - val_loss: 3.5205 - val_accuracy100: 0.3118 - 93s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 92s - loss: 3.2165 - accuracy100: 0.4135 - val_loss: 3.5758 - val_accuracy100: 0.3060 - 92s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 91s - loss: 3.2077 - accuracy100: 0.4180 - val_loss: 3.4924 - val_accuracy100: 0.3059 - 91s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.2031 - accuracy100: 0.4205 - val_loss: 3.4647 - val_accuracy100: 0.3107 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 90s - loss: 3.1998 - accuracy100: 0.4225 - val_loss: 3.4541 - val_accuracy100: 0.3178 - 90s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 89s - loss: 3.1973 - accuracy100: 0.4238 - val_loss: 3.4363 - val_accuracy100: 0.3202 - 89s/epoch - 14ms/step
Epoch 7/50
6147/6147 - 91s - loss: 3.1948 - accuracy100: 0.4249 - val_loss: 3.4290 - val_accuracy100: 0.3233 - 91s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 90s - loss: 3.1928 - accuracy100: 0.4262 - val_loss: 3.4227 - val_accuracy100: 0.3248 - 90s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 89s - loss: 3.1915 - accuracy100: 0.4267 - val_loss: 3.4614 - val_accuracy100: 0.3234 - 89s/epoch - 14ms/step
Epoch 10/50
6147/6147 - 89s - loss: 3.1899 - accuracy100: 0.4275 - val_loss: 3.4814 - val_accuracy100: 0.3250 - 89s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 89s - loss: 3.1885 - accuracy100: 0.4280 - val_loss: 3.5120 - val_accuracy100: 0.3292 - 89s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 89s - loss: 3.1874 - accuracy100: 0.4290 - val_loss: 3.5667 - val_accuracy100: 0.3230 - 89s/epoch - 14ms/step
Epoch 13/50
6147/6147 - 89s - loss: 3.1859 - accuracy100: 0.4296 - val_loss: 3.5439 - val_accuracy100: 0.3280 - 89s/epoch - 15ms/step
Epoch 14/50
6147/6147 - 91s - loss: 3.1841 - accuracy100: 0.4303 - val_loss: 3.4811 - val_accuracy100: 0.3261 - 91s/epoch - 15ms/step
Epoch 15/50
6147/6147 - 89s - loss: 3.1834 - accuracy100: 0.4308 - val_loss: 3.5485 - val_accuracy100: 0.3205 - 89s/epoch - 15ms/step
Epoch 16/50
6147/6147 - 88s - loss: 3.1815 - accuracy100: 0.4317 - val_loss: 3.6059 - val_accuracy100: 0.3238 - 88s/epoch - 14ms/step
Epoch 17/50
6147/6147 - 89s - loss: 3.1810 - accuracy100: 0.4320 - val_loss: 3.5811 - val_accuracy100: 0.3249 - 89s/epoch - 14ms/step
Epoch 18/50
6147/6147 - 89s - loss: 3.1796 - accuracy100: 0.4328 - val_loss: 3.5185 - val_accuracy100: 0.3244 - 89s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h100
Evaluating performance on  test set...
14883/14883 - 90s - 90s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1202478
{'0': {'precision': 0.3330758529799385, 'recall': 0.07712456418598461, 'f1-score': 0.12524770296156035, 'support': 1179689}, '1': {'precision': 0.37063472042080076, 'recall': 0.9291637535445451, 'f1-score': 0.529898064843098, 'support': 1408855}, '2': {'precision': 0.371618809821057, 'recall': 0.001462310302901286, 'f1-score': 0.002913157407550885, 'support': 1221355}, 'accuracy': 0.36794308720519886, 'macro avg': {'precision': 0.3584431277405988, 'recall': 0.3359168760111437, 'f1-score': 0.21935297507073645, 'support': 3809899}, 'weighted avg': {'precision': 0.35932054640647826, 'recall': 0.36794308720519886, 'f1-score': 0.23566526959613426, 'support': 3809899}}
[[  90983 1087425    1281]
 [  98059 1309057    1739]
 [  84118 1135451    1786]]
Evaluating performance on  train set...
6147/6147 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1427304
{'0': {'precision': 0.334687713794657, 'recall': 0.07730612764038534, 'f1-score': 0.12560096059764952, 'support': 518911}, '1': {'precision': 0.3271946369605018, 'recall': 0.9114644725387324, 'f1-score': 0.4815308504294985, 'support': 519204}, '2': {'precision': 0.3914595633667445, 'recall': 0.005325289052431029, 'f1-score': 0.010507635634558365, 'support': 535370}, 'accuracy': 0.3280628668211009, 'macro avg': {'precision': 0.3511139713739677, 'recall': 0.33136529641051626, 'f1-score': 0.2058798155539021, 'support': 1573485}, 'weighted avg': {'precision': 0.3515315411211379, 'recall': 0.3280628668211009, 'f1-score': 0.20388750869614755, 'support': 1573485}}
[[ 40115 476998   1798]
 [ 43334 473236   2634]
 [ 36409 496110   2851]]
Evaluating performance on  val set...
2174/2174 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1439562
{'0': {'precision': 0.33702310115505774, 'recall': 0.041592423407954555, 'f1-score': 0.07404666006594314, 'support': 185202}, '1': {'precision': 0.323793849566407, 'recall': 0.9518978263268233, 'f1-score': 0.48321811203235243, 'support': 181260}, '2': {'precision': 0.4129032258064516, 'recall': 0.0016838383094263374, 'f1-score': 0.0033539988575441394, 'support': 190042}, 'accuracy': 0.32446127970329053, 'macro avg': {'precision': 0.3579067255093054, 'recall': 0.3317246960147347, 'f1-score': 0.1868729236519466, 'support': 556504}, 'weighted avg': {'precision': 0.3586266772408385, 'recall': 0.32446127970329053, 'f1-score': 0.18317766840023145, 'support': 556504}}
[[  7703 177322    177]
 [  8441 172541    278]
 [  6712 183010    320]]
training model: results/AAPL/W2/deepLOB_L1/h200
Epoch 1/50
6147/6147 - 92s - loss: 3.2340 - accuracy200: 0.4044 - val_loss: 3.4995 - val_accuracy200: 0.3517 - 92s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 91s - loss: 3.2187 - accuracy200: 0.4134 - val_loss: 3.4731 - val_accuracy200: 0.3518 - 91s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 90s - loss: 3.2095 - accuracy200: 0.4177 - val_loss: 3.5001 - val_accuracy200: 0.3449 - 90s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.2023 - accuracy200: 0.4226 - val_loss: 3.4250 - val_accuracy200: 0.3511 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 89s - loss: 3.1966 - accuracy200: 0.4256 - val_loss: 3.4355 - val_accuracy200: 0.3512 - 89s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 89s - loss: 3.1936 - accuracy200: 0.4274 - val_loss: 3.4480 - val_accuracy200: 0.3493 - 89s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 91s - loss: 3.1916 - accuracy200: 0.4278 - val_loss: 3.4172 - val_accuracy200: 0.3564 - 91s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 89s - loss: 3.1878 - accuracy200: 0.4297 - val_loss: 3.4939 - val_accuracy200: 0.3524 - 89s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 90s - loss: 3.1866 - accuracy200: 0.4302 - val_loss: 3.5768 - val_accuracy200: 0.3442 - 90s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 89s - loss: 3.1838 - accuracy200: 0.4315 - val_loss: 3.5604 - val_accuracy200: 0.3280 - 89s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 90s - loss: 3.1824 - accuracy200: 0.4320 - val_loss: 3.6489 - val_accuracy200: 0.3494 - 90s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 89s - loss: 3.1810 - accuracy200: 0.4328 - val_loss: 3.5645 - val_accuracy200: 0.3465 - 89s/epoch - 14ms/step
Epoch 13/50
6147/6147 - 89s - loss: 3.1792 - accuracy200: 0.4337 - val_loss: 3.5806 - val_accuracy200: 0.3351 - 89s/epoch - 14ms/step
Epoch 14/50
6147/6147 - 90s - loss: 3.1786 - accuracy200: 0.4337 - val_loss: 3.6329 - val_accuracy200: 0.3319 - 90s/epoch - 15ms/step
Epoch 15/50
6147/6147 - 92s - loss: 3.1770 - accuracy200: 0.4345 - val_loss: 3.7323 - val_accuracy200: 0.3248 - 92s/epoch - 15ms/step
Epoch 16/50
6147/6147 - 89s - loss: 3.1759 - accuracy200: 0.4349 - val_loss: 3.6843 - val_accuracy200: 0.3366 - 89s/epoch - 15ms/step
Epoch 17/50
6147/6147 - 89s - loss: 3.1745 - accuracy200: 0.4355 - val_loss: 3.7574 - val_accuracy200: 0.3345 - 89s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h200
Evaluating performance on  test set...
14883/14883 - 79s - 79s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241559
{'0': {'precision': 0.27531359229098057, 'recall': 0.10969455681411622, 'f1-score': 0.15688188710529088, 'support': 1092871}, '1': {'precision': 0.43045504557940156, 'recall': 0.7333180830092639, 'f1-score': 0.5424776721365973, 'support': 1599966}, '2': {'precision': 0.31540835231774195, 'recall': 0.18318589299430113, 'f1-score': 0.2317650523263716, 'support': 1117062}, 'accuracy': 0.39313273134012217, 'macro avg': {'precision': 0.340392330062708, 'recall': 0.34206617760589375, 'f1-score': 0.31037487052275325, 'support': 3809899}, 'weighted avg': {'precision': 0.35222098098476906, 'recall': 0.39313273134012217, 'f1-score': 0.34076846365275054, 'support': 3809899}}
[[ 119882  766079  206910]
 [ 189444 1173284  237238]
 [ 126112  786320  204630]]
Evaluating performance on  train set...
6147/6147 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.159202
{'0': {'precision': 0.31873360841299536, 'recall': 0.07193523322555581, 'f1-score': 0.11737908947048849, 'support': 518661}, '1': {'precision': 0.3322196923722743, 'recall': 0.7008902442781012, 'f1-score': 0.4507739846076028, 'support': 519408}, '2': {'precision': 0.3446064172279638, 'recall': 0.23210550301074304, 'f1-score': 0.27738301569462936, 'support': 535416}, 'accuracy': 0.33405529763550335, 'macro avg': {'precision': 0.3318532393377445, 'recall': 0.3349769935048, 'f1-score': 0.28184536325757353, 'support': 1573485}, 'weighted avg': {'precision': 0.3319892134563204, 'recall': 0.33405529763550335, 'f1-score': 0.28187804424705315, 'support': 1573485}}
[[ 37310 358827 122524]
 [ 41534 364048 113826]
 [ 38213 372930 124273]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1394584
{'0': {'precision': 0.2939493049877351, 'recall': 0.05264818037930122, 'f1-score': 0.08930183676881555, 'support': 177537}, '1': {'precision': 0.36484301837183747, 'recall': 0.7324651238625132, 'f1-score': 0.4870733686491285, 'support': 196266}, '2': {'precision': 0.34979606516731837, 'recall': 0.2501956749005205, 'f1-score': 0.29172889144170017, 'support': 182701}, 'accuracy': 0.3572588876270431, 'macro avg': {'precision': 0.33619612950896366, 'recall': 0.34510299304744496, 'f1-score': 0.2893680322865481, 'support': 556504}, 'weighted avg': {'precision': 0.3372864319133534, 'recall': 0.3572588876270431, 'f1-score': 0.2960436621497871, 'support': 556504}}
[[  9347 123276  44914]
 [ 12454 143758  40054]
 [  9997 126993  45711]]
training model: results/AAPL/W2/deepLOB_L1/h300
Epoch 1/50
6147/6147 - 93s - loss: 3.2160 - accuracy300: 0.4164 - val_loss: 3.4179 - val_accuracy300: 0.3183 - 93s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 90s - loss: 3.1918 - accuracy300: 0.4279 - val_loss: 3.4322 - val_accuracy300: 0.3135 - 90s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 91s - loss: 3.1814 - accuracy300: 0.4327 - val_loss: 3.4610 - val_accuracy300: 0.3273 - 91s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.1760 - accuracy300: 0.4355 - val_loss: 3.4889 - val_accuracy300: 0.3270 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 90s - loss: 3.1702 - accuracy300: 0.4383 - val_loss: 3.4345 - val_accuracy300: 0.3208 - 90s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 89s - loss: 3.1656 - accuracy300: 0.4404 - val_loss: 3.4530 - val_accuracy300: 0.3304 - 89s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 89s - loss: 3.1622 - accuracy300: 0.4417 - val_loss: 3.4163 - val_accuracy300: 0.3323 - 89s/epoch - 14ms/step
Epoch 8/50
6147/6147 - 90s - loss: 3.1578 - accuracy300: 0.4435 - val_loss: 3.4795 - val_accuracy300: 0.3319 - 90s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 91s - loss: 3.1543 - accuracy300: 0.4444 - val_loss: 3.4540 - val_accuracy300: 0.3333 - 91s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 92s - loss: 3.1507 - accuracy300: 0.4462 - val_loss: 3.4876 - val_accuracy300: 0.3349 - 92s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 90s - loss: 3.1476 - accuracy300: 0.4471 - val_loss: 3.5230 - val_accuracy300: 0.3331 - 90s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 89s - loss: 3.1452 - accuracy300: 0.4477 - val_loss: 3.5111 - val_accuracy300: 0.3344 - 89s/epoch - 15ms/step
Epoch 13/50
6147/6147 - 90s - loss: 3.1426 - accuracy300: 0.4486 - val_loss: 3.6068 - val_accuracy300: 0.3336 - 90s/epoch - 15ms/step
Epoch 14/50
6147/6147 - 90s - loss: 3.1402 - accuracy300: 0.4494 - val_loss: 3.6025 - val_accuracy300: 0.3320 - 90s/epoch - 15ms/step
Epoch 15/50
6147/6147 - 89s - loss: 3.1383 - accuracy300: 0.4500 - val_loss: 3.6412 - val_accuracy300: 0.3343 - 89s/epoch - 14ms/step
Epoch 16/50
6147/6147 - 90s - loss: 3.1368 - accuracy300: 0.4506 - val_loss: 3.5881 - val_accuracy300: 0.3299 - 90s/epoch - 15ms/step
Epoch 17/50
6147/6147 - 89s - loss: 3.1351 - accuracy300: 0.4509 - val_loss: 3.5834 - val_accuracy300: 0.3294 - 89s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h300
Evaluating performance on  test set...
14883/14883 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266729
{'0': {'precision': 0.31964248333876943, 'recall': 0.0544912545105082, 'f1-score': 0.09310959237255749, 'support': 1204964}, '1': {'precision': 0.3610165363536678, 'recall': 0.9485254404452298, 'f1-score': 0.5229818901871834, 'support': 1362712}, '2': {'precision': 0.38672911140583555, 'recall': 0.007511533758431457, 'f1-score': 0.014736830468014004, 'support': 1242223}, 'accuracy': 0.3589486230474876, 'macro avg': {'precision': 0.3557960436994243, 'recall': 0.33684274290472316, 'f1-score': 0.21027610434258495, 'support': 3809899}, 'weighted avg': {'precision': 0.35631470769678875, 'recall': 0.3589486230474876, 'f1-score': 0.22131133506658085, 'support': 3809899}}
[[  65660 1130274    9030]
 [  64378 1292567    5767]
 [  75379 1157513    9331]]
Evaluating performance on  train set...
6147/6147 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1441921
{'0': {'precision': 0.29173274308812513, 'recall': 0.08316788635716539, 'f1-score': 0.12943587563305492, 'support': 519804}, '1': {'precision': 0.3232017027475189, 'recall': 0.8795839427295821, 'f1-score': 0.47270771657207866, 'support': 519640}, '2': {'precision': 0.30918743813551697, 'recall': 0.006433962935430052, 'f1-score': 0.01260561235907652, 'support': 534041}, 'accuracy': 0.32013905439200246, 'macro avg': {'precision': 0.308040627990387, 'recall': 0.3230619306740592, 'f1-score': 0.20491640152140336, 'support': 1573485}, 'weighted avg': {'precision': 0.3080494242101006, 'recall': 0.32013905439200246, 'f1-score': 0.20314844918568212, 'support': 1573485}}
[[ 43231 473160   3413]
 [ 58309 457067   4264]
 [ 46647 483958   3436]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1413469
{'0': {'precision': 0.3357836169435081, 'recall': 0.04508940987844183, 'f1-score': 0.07950305780991576, 'support': 183369}, '1': {'precision': 0.33188945256417757, 'recall': 0.9581749256527848, 'f1-score': 0.49301128983214487, 'support': 183598}, '2': {'precision': 0.3386214442013129, 'recall': 0.003265853105198457, 'f1-score': 0.006469312570219215, 'support': 189537}, 'accuracy': 0.3320838664232422, 'macro avg': {'precision': 0.33543150456966614, 'recall': 0.3355100628788084, 'f1-score': 0.1929945534040933, 'support': 556504}, 'weighted avg': {'precision': 0.33546540265079183, 'recall': 0.3320838664232422, 'f1-score': 0.19105066108198723, 'support': 556504}}
[[  8268 174460    641]
 [  7111 175919    568]
 [  9244 179674    619]]
training model: results/AAPL/W2/deepLOB_L1/h500
Epoch 1/50
6147/6147 - 92s - loss: 3.2227 - accuracy500: 0.4142 - val_loss: 3.4488 - val_accuracy500: 0.3241 - 92s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 90s - loss: 3.1775 - accuracy500: 0.4352 - val_loss: 3.4232 - val_accuracy500: 0.3249 - 90s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 89s - loss: 3.1593 - accuracy500: 0.4430 - val_loss: 3.4887 - val_accuracy500: 0.3270 - 89s/epoch - 14ms/step
Epoch 4/50
6147/6147 - 89s - loss: 3.1471 - accuracy500: 0.4470 - val_loss: 3.5266 - val_accuracy500: 0.3395 - 89s/epoch - 14ms/step
Epoch 5/50
6147/6147 - 91s - loss: 3.1400 - accuracy500: 0.4499 - val_loss: 3.5902 - val_accuracy500: 0.3440 - 91s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 90s - loss: 3.1340 - accuracy500: 0.4519 - val_loss: 3.6067 - val_accuracy500: 0.3508 - 90s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 89s - loss: 3.1289 - accuracy500: 0.4537 - val_loss: 3.6464 - val_accuracy500: 0.3509 - 89s/epoch - 14ms/step
Epoch 8/50
6147/6147 - 89s - loss: 3.1237 - accuracy500: 0.4550 - val_loss: 3.6846 - val_accuracy500: 0.3500 - 89s/epoch - 14ms/step
Epoch 9/50
6147/6147 - 89s - loss: 3.1208 - accuracy500: 0.4564 - val_loss: 3.7475 - val_accuracy500: 0.3576 - 89s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 90s - loss: 3.1184 - accuracy500: 0.4574 - val_loss: 3.8893 - val_accuracy500: 0.3347 - 90s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 91s - loss: 3.1152 - accuracy500: 0.4583 - val_loss: 3.8493 - val_accuracy500: 0.3483 - 91s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 90s - loss: 3.1123 - accuracy500: 0.4591 - val_loss: 3.7986 - val_accuracy500: 0.3474 - 90s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h500
Evaluating performance on  test set...
14883/14883 - 92s - 92s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1149325
{'0': {'precision': 0.27684879886952424, 'recall': 0.00404749218176356, 'f1-score': 0.007978342076082705, 'support': 1161707}, '1': {'precision': 0.38269721268595935, 'recall': 0.9865215735918508, 'f1-score': 0.5514663693659931, 'support': 1455066}, '2': {'precision': 0.354763491005996, 'recall': 0.012496584602129197, 'f1-score': 0.024142738476335742, 'support': 1193126}, 'accuracy': 0.3819172109286887, 'macro avg': {'precision': 0.33810316752049324, 'recall': 0.33435521679191454, 'f1-score': 0.19452914997280388, 'support': 3809899}, 'weighted avg': {'precision': 0.3416742635519856, 'recall': 0.3819172109286887, 'f1-score': 0.22060789250145332, 'support': 3809899}}
[[   4702 1142646   14359]
 [   6853 1435454   12759]
 [   5429 1172787   14910]]
Evaluating performance on  train set...
6147/6147 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1410265
{'0': {'precision': 0.29842813524821893, 'recall': 0.005082614146962469, 'f1-score': 0.009995000605987153, 'support': 519221}, '1': {'precision': 0.32975477535265235, 'recall': 0.9842998168889607, 'f1-score': 0.49400925488824216, 'support': 519357}, '2': {'precision': 0.3161917998610146, 'recall': 0.008506151536622254, 'f1-score': 0.01656662971033885, 'support': 534907}, 'accuracy': 0.32945468180503784, 'macro avg': {'precision': 0.3147915701539619, 'recall': 0.3326295275241818, 'f1-score': 0.17352362840152272, 'support': 1573485}, 'weighted avg': {'precision': 0.3148068222848001, 'recall': 0.32945468180503784, 'f1-score': 0.17198663158473215, 'support': 1573485}}
[[  2639 511587   4995]
 [  3309 511203   4845]
 [  2895 527462   4550]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1427246
{'0': {'precision': 0.31864406779661014, 'recall': 0.0035693943421302447, 'f1-score': 0.007059707097258729, 'support': 184345}, '1': {'precision': 0.3251899467622319, 'recall': 0.9888648929295384, 'f1-score': 0.48942998750680017, 'support': 181049}, '2': {'precision': 0.316452442159383, 'recall': 0.0064413165192820886, 'f1-score': 0.012625641025641026, 'support': 191110}, 'accuracy': 0.325104581458534, 'macro avg': {'precision': 0.32009548557274164, 'recall': 0.33295853459698355, 'f1-score': 0.16970511187656664, 'support': 556504}, 'weighted avg': {'precision': 0.3200210269295478, 'recall': 0.325104581458534, 'f1-score': 0.165901984117586, 'support': 556504}}
[[   658 182364   1323]
 [   680 179033   1336]
 [   727 189152   1231]]
training model: results/AAPL/W2/deepLOB_L1/h1000
Epoch 1/50
6147/6147 - 93s - loss: 3.1670 - accuracy1000: 0.4406 - val_loss: 3.4831 - val_accuracy1000: 0.3283 - 93s/epoch - 15ms/step
Epoch 2/50
6147/6147 - 90s - loss: 3.1037 - accuracy1000: 0.4666 - val_loss: 3.3856 - val_accuracy1000: 0.3176 - 90s/epoch - 15ms/step
Epoch 3/50
6147/6147 - 90s - loss: 3.0811 - accuracy1000: 0.4750 - val_loss: 3.4786 - val_accuracy1000: 0.2987 - 90s/epoch - 15ms/step
Epoch 4/50
6147/6147 - 90s - loss: 3.0665 - accuracy1000: 0.4782 - val_loss: 3.6141 - val_accuracy1000: 0.3093 - 90s/epoch - 15ms/step
Epoch 5/50
6147/6147 - 89s - loss: 3.0559 - accuracy1000: 0.4813 - val_loss: 3.6034 - val_accuracy1000: 0.3249 - 89s/epoch - 15ms/step
Epoch 6/50
6147/6147 - 92s - loss: 3.0441 - accuracy1000: 0.4846 - val_loss: 3.7262 - val_accuracy1000: 0.3328 - 92s/epoch - 15ms/step
Epoch 7/50
6147/6147 - 90s - loss: 3.0396 - accuracy1000: 0.4859 - val_loss: 3.8219 - val_accuracy1000: 0.3270 - 90s/epoch - 15ms/step
Epoch 8/50
6147/6147 - 90s - loss: 3.0337 - accuracy1000: 0.4880 - val_loss: 3.9172 - val_accuracy1000: 0.3316 - 90s/epoch - 15ms/step
Epoch 9/50
6147/6147 - 92s - loss: 3.0278 - accuracy1000: 0.4893 - val_loss: 3.9294 - val_accuracy1000: 0.3288 - 92s/epoch - 15ms/step
Epoch 10/50
6147/6147 - 92s - loss: 3.0250 - accuracy1000: 0.4901 - val_loss: 4.1074 - val_accuracy1000: 0.3303 - 92s/epoch - 15ms/step
Epoch 11/50
6147/6147 - 92s - loss: 3.0221 - accuracy1000: 0.4911 - val_loss: 4.1800 - val_accuracy1000: 0.3272 - 92s/epoch - 15ms/step
Epoch 12/50
6147/6147 - 89s - loss: 3.0169 - accuracy1000: 0.4926 - val_loss: 4.3245 - val_accuracy1000: 0.3290 - 89s/epoch - 15ms/step
testing model: results/AAPL/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
14883/14883 - 75s - 75s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314137
{'0': {'precision': 0.2931348537567604, 'recall': 0.33263342846440314, 'f1-score': 0.3116375635448433, 'support': 1190638}, '1': {'precision': 0.3496182209928718, 'recall': 0.5533770998541115, 'f1-score': 0.42850879228857874, 'support': 1384620}, '2': {'precision': 0.314029021949814, 'recall': 0.06797360528283121, 'f1-score': 0.11175674335019879, 'support': 1234641}, 'accuracy': 0.32709161056500446, 'macro avg': {'precision': 0.3189273655664821, 'recall': 0.31799471120044864, 'f1-score': 0.2839676997278736, 'support': 3809899}, 'weighted avg': {'precision': 0.3204334243106004, 'recall': 0.32709161056500446, 'f1-score': 0.28933807083315066, 'support': 3809899}}
[[396046 713893  80699]
 [515779 766217 102624]
 [439246 711472  83923]]
Evaluating performance on  train set...
6147/6147 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1337544
{'0': {'precision': 0.3016559987882936, 'recall': 0.20878493678037074, 'f1-score': 0.24677185643925006, 'support': 515109}, '1': {'precision': 0.3172887448192251, 'recall': 0.6841761283051848, 'f1-score': 0.433527706883957, 'support': 521756}, '2': {'precision': 0.33116770051148114, 'recall': 0.05670865789571764, 'f1-score': 0.0968353725477717, 'support': 536620}, 'accuracy': 0.31455717722126364, 'macro avg': {'precision': 0.31670414803966657, 'recall': 0.31655657432709106, 'f1-score': 0.2590449786236596, 'support': 1573485}, 'weighted avg': {'precision': 0.31690434778228566, 'recall': 0.31455717722126364, 'f1-score': 0.25756450429975297, 'support': 1573485}}
[[107547 377733  29829]
 [133153 356973  31630]
 [115822 390367  30431]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1290535
{'0': {'precision': 0.2999213630406291, 'recall': 0.15710472549924206, 'f1-score': 0.20619857200010092, 'support': 182076}, '1': {'precision': 0.32287484226224616, 'recall': 0.7610212204460404, 'f1-score': 0.4533914550732482, 'support': 184916}, '2': {'precision': 0.2969263024644962, 'recall': 0.0396069905863481, 'f1-score': 0.06989119655851503, 'support': 189512}, 'accuracy': 0.31776231617382805, 'macro avg': {'precision': 0.30657416925579045, 'recall': 0.31924431217721017, 'f1-score': 0.24316040787728807, 'support': 556504}, 'weighted avg': {'precision': 0.3065284415950338, 'recall': 0.31776231617382805, 'f1-score': 0.24191805619368847, 'support': 556504}}
[[ 28605 146361   7110]
 [ 33528 140725  10663]
 [ 33242 148764   7506]]
training model: results/AAPL/W2/deepOF_L1/h10
Epoch 1/50
6147/6147 - 82s - loss: 3.1588 - accuracy10: 0.4456 - val_loss: 3.2654 - val_accuracy10: 0.4087 - 82s/epoch - 13ms/step
Epoch 2/50
6147/6147 - 80s - loss: 3.1503 - accuracy10: 0.4462 - val_loss: 3.2597 - val_accuracy10: 0.4133 - 80s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 80s - loss: 3.1430 - accuracy10: 0.4480 - val_loss: 3.2520 - val_accuracy10: 0.4183 - 80s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 79s - loss: 3.1362 - accuracy10: 0.4498 - val_loss: 3.2442 - val_accuracy10: 0.4213 - 79s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 81s - loss: 3.1290 - accuracy10: 0.4530 - val_loss: 3.2364 - val_accuracy10: 0.4259 - 81s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 79s - loss: 3.1240 - accuracy10: 0.4545 - val_loss: 3.2291 - val_accuracy10: 0.4279 - 79s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 80s - loss: 3.1199 - accuracy10: 0.4559 - val_loss: 3.2230 - val_accuracy10: 0.4301 - 80s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 80s - loss: 3.1159 - accuracy10: 0.4571 - val_loss: 3.2153 - val_accuracy10: 0.4327 - 80s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 79s - loss: 3.1124 - accuracy10: 0.4581 - val_loss: 3.2076 - val_accuracy10: 0.4351 - 79s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 80s - loss: 3.1092 - accuracy10: 0.4595 - val_loss: 3.2064 - val_accuracy10: 0.4374 - 80s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 81s - loss: 3.1061 - accuracy10: 0.4604 - val_loss: 3.2032 - val_accuracy10: 0.4378 - 81s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 80s - loss: 3.1037 - accuracy10: 0.4614 - val_loss: 3.2006 - val_accuracy10: 0.4386 - 80s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 79s - loss: 3.1014 - accuracy10: 0.4621 - val_loss: 3.1936 - val_accuracy10: 0.4402 - 79s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 79s - loss: 3.0989 - accuracy10: 0.4630 - val_loss: 3.1916 - val_accuracy10: 0.4415 - 79s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 79s - loss: 3.0966 - accuracy10: 0.4634 - val_loss: 3.1892 - val_accuracy10: 0.4431 - 79s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 78s - loss: 3.0950 - accuracy10: 0.4639 - val_loss: 3.1847 - val_accuracy10: 0.4442 - 78s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 81s - loss: 3.0932 - accuracy10: 0.4646 - val_loss: 3.1838 - val_accuracy10: 0.4447 - 81s/epoch - 13ms/step
Epoch 18/50
6147/6147 - 79s - loss: 3.0916 - accuracy10: 0.4654 - val_loss: 3.1809 - val_accuracy10: 0.4455 - 79s/epoch - 13ms/step
Epoch 19/50
6147/6147 - 79s - loss: 3.0894 - accuracy10: 0.4659 - val_loss: 3.1827 - val_accuracy10: 0.4450 - 79s/epoch - 13ms/step
Epoch 20/50
6147/6147 - 81s - loss: 3.0883 - accuracy10: 0.4662 - val_loss: 3.1754 - val_accuracy10: 0.4473 - 81s/epoch - 13ms/step
Epoch 21/50
6147/6147 - 78s - loss: 3.0860 - accuracy10: 0.4673 - val_loss: 3.1770 - val_accuracy10: 0.4467 - 78s/epoch - 13ms/step
Epoch 22/50
6147/6147 - 78s - loss: 3.0842 - accuracy10: 0.4675 - val_loss: 3.1767 - val_accuracy10: 0.4473 - 78s/epoch - 13ms/step
Epoch 23/50
6147/6147 - 77s - loss: 3.0834 - accuracy10: 0.4680 - val_loss: 3.1739 - val_accuracy10: 0.4478 - 77s/epoch - 13ms/step
Epoch 24/50
6147/6147 - 78s - loss: 3.0821 - accuracy10: 0.4683 - val_loss: 3.1715 - val_accuracy10: 0.4490 - 78s/epoch - 13ms/step
Epoch 25/50
6147/6147 - 79s - loss: 3.0799 - accuracy10: 0.4692 - val_loss: 3.1666 - val_accuracy10: 0.4498 - 79s/epoch - 13ms/step
Epoch 26/50
6147/6147 - 79s - loss: 3.0782 - accuracy10: 0.4699 - val_loss: 3.1673 - val_accuracy10: 0.4507 - 79s/epoch - 13ms/step
Epoch 27/50
6147/6147 - 81s - loss: 3.0765 - accuracy10: 0.4702 - val_loss: 3.1651 - val_accuracy10: 0.4499 - 81s/epoch - 13ms/step
Epoch 28/50
6147/6147 - 79s - loss: 3.0758 - accuracy10: 0.4706 - val_loss: 3.1628 - val_accuracy10: 0.4518 - 79s/epoch - 13ms/step
Epoch 29/50
6147/6147 - 78s - loss: 3.0743 - accuracy10: 0.4713 - val_loss: 3.1634 - val_accuracy10: 0.4510 - 78s/epoch - 13ms/step
Epoch 30/50
6147/6147 - 80s - loss: 3.0728 - accuracy10: 0.4715 - val_loss: 3.1639 - val_accuracy10: 0.4525 - 80s/epoch - 13ms/step
Epoch 31/50
6147/6147 - 78s - loss: 3.0715 - accuracy10: 0.4723 - val_loss: 3.1609 - val_accuracy10: 0.4532 - 78s/epoch - 13ms/step
Epoch 32/50
6147/6147 - 80s - loss: 3.0700 - accuracy10: 0.4725 - val_loss: 3.1609 - val_accuracy10: 0.4522 - 80s/epoch - 13ms/step
Epoch 33/50
6147/6147 - 81s - loss: 3.0688 - accuracy10: 0.4732 - val_loss: 3.1600 - val_accuracy10: 0.4530 - 81s/epoch - 13ms/step
Epoch 34/50
6147/6147 - 82s - loss: 3.0679 - accuracy10: 0.4728 - val_loss: 3.1589 - val_accuracy10: 0.4538 - 82s/epoch - 13ms/step
Epoch 35/50
6147/6147 - 80s - loss: 3.0666 - accuracy10: 0.4735 - val_loss: 3.1564 - val_accuracy10: 0.4550 - 80s/epoch - 13ms/step
Epoch 36/50
6147/6147 - 82s - loss: 3.0650 - accuracy10: 0.4741 - val_loss: 3.1567 - val_accuracy10: 0.4550 - 82s/epoch - 13ms/step
Epoch 37/50
6147/6147 - 83s - loss: 3.0643 - accuracy10: 0.4746 - val_loss: 3.1553 - val_accuracy10: 0.4545 - 83s/epoch - 13ms/step
Epoch 38/50
6147/6147 - 84s - loss: 3.0629 - accuracy10: 0.4750 - val_loss: 3.1568 - val_accuracy10: 0.4545 - 84s/epoch - 14ms/step
Epoch 39/50
6147/6147 - 87s - loss: 3.0618 - accuracy10: 0.4753 - val_loss: 3.1515 - val_accuracy10: 0.4564 - 87s/epoch - 14ms/step
Epoch 40/50
6147/6147 - 78s - loss: 3.0600 - accuracy10: 0.4759 - val_loss: 3.1540 - val_accuracy10: 0.4554 - 78s/epoch - 13ms/step
Epoch 41/50
6147/6147 - 79s - loss: 3.0593 - accuracy10: 0.4761 - val_loss: 3.1553 - val_accuracy10: 0.4564 - 79s/epoch - 13ms/step
Epoch 42/50
6147/6147 - 78s - loss: 3.0579 - accuracy10: 0.4764 - val_loss: 3.1553 - val_accuracy10: 0.4562 - 78s/epoch - 13ms/step
Epoch 43/50
6147/6147 - 78s - loss: 3.0570 - accuracy10: 0.4766 - val_loss: 3.1519 - val_accuracy10: 0.4568 - 78s/epoch - 13ms/step
Epoch 44/50
6147/6147 - 81s - loss: 3.0556 - accuracy10: 0.4769 - val_loss: 3.1501 - val_accuracy10: 0.4572 - 81s/epoch - 13ms/step
Epoch 45/50
6147/6147 - 78s - loss: 3.0550 - accuracy10: 0.4773 - val_loss: 3.1512 - val_accuracy10: 0.4571 - 78s/epoch - 13ms/step
Epoch 46/50
6147/6147 - 78s - loss: 3.0541 - accuracy10: 0.4776 - val_loss: 3.1525 - val_accuracy10: 0.4577 - 78s/epoch - 13ms/step
Epoch 47/50
6147/6147 - 78s - loss: 3.0529 - accuracy10: 0.4780 - val_loss: 3.1475 - val_accuracy10: 0.4580 - 78s/epoch - 13ms/step
Epoch 48/50
6147/6147 - 78s - loss: 3.0517 - accuracy10: 0.4782 - val_loss: 3.1505 - val_accuracy10: 0.4578 - 78s/epoch - 13ms/step
Epoch 49/50
6147/6147 - 79s - loss: 3.0510 - accuracy10: 0.4790 - val_loss: 3.1507 - val_accuracy10: 0.4581 - 79s/epoch - 13ms/step
Epoch 50/50
6147/6147 - 79s - loss: 3.0502 - accuracy10: 0.4786 - val_loss: 3.1532 - val_accuracy10: 0.4581 - 79s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h10
Evaluating performance on  test set...
14883/14883 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0456967
{'0': {'precision': 0.45451744467660066, 'recall': 0.28206936541618716, 'f1-score': 0.3481068230759269, 'support': 1124422}, '1': {'precision': 0.4604184973538043, 'recall': 0.6654997449207677, 'f1-score': 0.5442817800460464, 'support': 1521096}, '2': {'precision': 0.42155649946357804, 'recall': 0.3307136182813799, 'f1-score': 0.3706500416779765, 'support': 1164376}, 'accuracy': 0.45002013179369293, 'macro avg': {'precision': 0.4454974804979943, 'recall': 0.42609424287277825, 'f1-score': 0.42101288159998324, 'support': 3809894}, 'weighted avg': {'precision': 0.44679994232082, 'recall': 0.45002013179369293, 'f1-score': 0.4333190953990942, 'support': 3809894}}
[[ 317165  574939  232318]
 [ 212740 1012289  296067]
 [ 167901  611400  385075]]
Evaluating performance on  train set...
6147/6147 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0412265
{'0': {'precision': 0.47383580904274014, 'recall': 0.3003490631820864, 'f1-score': 0.3676541520092729, 'support': 484726}, '1': {'precision': 0.4427183293828471, 'recall': 0.6505275384440293, 'f1-score': 0.5268722681933494, 'support': 597492}, '2': {'precision': 0.44315442464201094, 'recall': 0.3502549540472047, 'f1-score': 0.39126593863872805, 'support': 491265}, 'accuracy': 0.4489022124802111, 'macro avg': {'precision': 0.45323618768919943, 'recall': 0.43371051855777343, 'f1-score': 0.4285974529471168, 'support': 1573483}, 'weighted avg': {'precision': 0.4524405124525812, 'recall': 0.4489022124802111, 'f1-score': 0.4354853233874038, 'support': 1573483}}
[[145587 241916  97223]
 [ 89818 388685 118989]
 [ 71847 247350 172068]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.035626
{'0': {'precision': 0.47694934547524187, 'recall': 0.3029125062961097, 'f1-score': 0.3705115753156575, 'support': 168755}, '1': {'precision': 0.4549308871971882, 'recall': 0.6775427806858993, 'f1-score': 0.5443572721786362, 'support': 213005}, '2': {'precision': 0.44881180398361736, 'recall': 0.3392639476259421, 'f1-score': 0.38642392955148386, 'support': 174743}, 'accuracy': 0.45771900600715537, 'macro avg': {'precision': 0.46023067888534913, 'recall': 0.4399064115359837, 'f1-score': 0.4337642590152592, 'support': 556503}, 'weighted avg': {'precision': 0.4596864014868218, 'recall': 0.45771900600715537, 'f1-score': 0.44204861137212037, 'support': 556503}}
[[ 51118  83013  34624]
 [ 30502 144320  38183]
 [ 25557  89902  59284]]
training model: results/AAPL/W2/deepOF_L1/h20
Epoch 1/50
6147/6147 - 82s - loss: 3.1848 - accuracy20: 0.4367 - val_loss: 3.2683 - val_accuracy20: 0.3645 - 82s/epoch - 13ms/step
Epoch 2/50
6147/6147 - 79s - loss: 3.1800 - accuracy20: 0.4380 - val_loss: 3.2632 - val_accuracy20: 0.3690 - 79s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 79s - loss: 3.1745 - accuracy20: 0.4394 - val_loss: 3.2573 - val_accuracy20: 0.3755 - 79s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 78s - loss: 3.1693 - accuracy20: 0.4411 - val_loss: 3.2489 - val_accuracy20: 0.3816 - 78s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 78s - loss: 3.1640 - accuracy20: 0.4426 - val_loss: 3.2428 - val_accuracy20: 0.3849 - 78s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 78s - loss: 3.1586 - accuracy20: 0.4447 - val_loss: 3.2364 - val_accuracy20: 0.3886 - 78s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 79s - loss: 3.1545 - accuracy20: 0.4460 - val_loss: 3.2327 - val_accuracy20: 0.3923 - 79s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 79s - loss: 3.1509 - accuracy20: 0.4471 - val_loss: 3.2283 - val_accuracy20: 0.3949 - 79s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 78s - loss: 3.1477 - accuracy20: 0.4483 - val_loss: 3.2243 - val_accuracy20: 0.3965 - 78s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 79s - loss: 3.1457 - accuracy20: 0.4492 - val_loss: 3.2200 - val_accuracy20: 0.3991 - 79s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 81s - loss: 3.1434 - accuracy20: 0.4496 - val_loss: 3.2141 - val_accuracy20: 0.4027 - 81s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 79s - loss: 3.1418 - accuracy20: 0.4504 - val_loss: 3.2146 - val_accuracy20: 0.4026 - 79s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 82s - loss: 3.1399 - accuracy20: 0.4510 - val_loss: 3.2107 - val_accuracy20: 0.4040 - 82s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 79s - loss: 3.1382 - accuracy20: 0.4516 - val_loss: 3.2101 - val_accuracy20: 0.4057 - 79s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 84s - loss: 3.1369 - accuracy20: 0.4517 - val_loss: 3.2078 - val_accuracy20: 0.4070 - 84s/epoch - 14ms/step
Epoch 16/50
6147/6147 - 79s - loss: 3.1355 - accuracy20: 0.4521 - val_loss: 3.2019 - val_accuracy20: 0.4091 - 79s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 78s - loss: 3.1340 - accuracy20: 0.4527 - val_loss: 3.2026 - val_accuracy20: 0.4087 - 78s/epoch - 13ms/step
Epoch 18/50
6147/6147 - 79s - loss: 3.1324 - accuracy20: 0.4532 - val_loss: 3.2022 - val_accuracy20: 0.4096 - 79s/epoch - 13ms/step
Epoch 19/50
6147/6147 - 78s - loss: 3.1313 - accuracy20: 0.4537 - val_loss: 3.2009 - val_accuracy20: 0.4106 - 78s/epoch - 13ms/step
Epoch 20/50
6147/6147 - 81s - loss: 3.1298 - accuracy20: 0.4542 - val_loss: 3.1991 - val_accuracy20: 0.4120 - 81s/epoch - 13ms/step
Epoch 21/50
6147/6147 - 82s - loss: 3.1283 - accuracy20: 0.4545 - val_loss: 3.1987 - val_accuracy20: 0.4119 - 82s/epoch - 13ms/step
Epoch 22/50
6147/6147 - 81s - loss: 3.1270 - accuracy20: 0.4550 - val_loss: 3.2001 - val_accuracy20: 0.4126 - 81s/epoch - 13ms/step
Epoch 23/50
6147/6147 - 82s - loss: 3.1255 - accuracy20: 0.4557 - val_loss: 3.1949 - val_accuracy20: 0.4149 - 82s/epoch - 13ms/step
Epoch 24/50
6147/6147 - 78s - loss: 3.1239 - accuracy20: 0.4562 - val_loss: 3.1962 - val_accuracy20: 0.4156 - 78s/epoch - 13ms/step
Epoch 25/50
6147/6147 - 80s - loss: 3.1230 - accuracy20: 0.4566 - val_loss: 3.1949 - val_accuracy20: 0.4148 - 80s/epoch - 13ms/step
Epoch 26/50
6147/6147 - 79s - loss: 3.1218 - accuracy20: 0.4571 - val_loss: 3.1949 - val_accuracy20: 0.4157 - 79s/epoch - 13ms/step
Epoch 27/50
6147/6147 - 81s - loss: 3.1212 - accuracy20: 0.4570 - val_loss: 3.1934 - val_accuracy20: 0.4164 - 81s/epoch - 13ms/step
Epoch 28/50
6147/6147 - 82s - loss: 3.1200 - accuracy20: 0.4575 - val_loss: 3.1942 - val_accuracy20: 0.4164 - 82s/epoch - 13ms/step
Epoch 29/50
6147/6147 - 80s - loss: 3.1184 - accuracy20: 0.4586 - val_loss: 3.1937 - val_accuracy20: 0.4172 - 80s/epoch - 13ms/step
Epoch 30/50
6147/6147 - 79s - loss: 3.1180 - accuracy20: 0.4585 - val_loss: 3.1912 - val_accuracy20: 0.4184 - 79s/epoch - 13ms/step
Epoch 31/50
6147/6147 - 84s - loss: 3.1166 - accuracy20: 0.4587 - val_loss: 3.1918 - val_accuracy20: 0.4180 - 84s/epoch - 14ms/step
Epoch 32/50
6147/6147 - 83s - loss: 3.1159 - accuracy20: 0.4590 - val_loss: 3.1929 - val_accuracy20: 0.4179 - 83s/epoch - 13ms/step
Epoch 33/50
6147/6147 - 82s - loss: 3.1143 - accuracy20: 0.4594 - val_loss: 3.1919 - val_accuracy20: 0.4184 - 82s/epoch - 13ms/step
Epoch 34/50
6147/6147 - 78s - loss: 3.1136 - accuracy20: 0.4597 - val_loss: 3.1921 - val_accuracy20: 0.4181 - 78s/epoch - 13ms/step
Epoch 35/50
6147/6147 - 78s - loss: 3.1124 - accuracy20: 0.4601 - val_loss: 3.1907 - val_accuracy20: 0.4192 - 78s/epoch - 13ms/step
Epoch 36/50
6147/6147 - 80s - loss: 3.1116 - accuracy20: 0.4607 - val_loss: 3.1909 - val_accuracy20: 0.4188 - 80s/epoch - 13ms/step
Epoch 37/50
6147/6147 - 78s - loss: 3.1108 - accuracy20: 0.4605 - val_loss: 3.1911 - val_accuracy20: 0.4201 - 78s/epoch - 13ms/step
Epoch 38/50
6147/6147 - 78s - loss: 3.1099 - accuracy20: 0.4608 - val_loss: 3.1899 - val_accuracy20: 0.4206 - 78s/epoch - 13ms/step
Epoch 39/50
6147/6147 - 80s - loss: 3.1089 - accuracy20: 0.4613 - val_loss: 3.1922 - val_accuracy20: 0.4203 - 80s/epoch - 13ms/step
Epoch 40/50
6147/6147 - 78s - loss: 3.1085 - accuracy20: 0.4615 - val_loss: 3.1892 - val_accuracy20: 0.4204 - 78s/epoch - 13ms/step
Epoch 41/50
6147/6147 - 82s - loss: 3.1070 - accuracy20: 0.4623 - val_loss: 3.1869 - val_accuracy20: 0.4224 - 82s/epoch - 13ms/step
Epoch 42/50
6147/6147 - 81s - loss: 3.1067 - accuracy20: 0.4623 - val_loss: 3.1904 - val_accuracy20: 0.4196 - 81s/epoch - 13ms/step
Epoch 43/50
6147/6147 - 79s - loss: 3.1054 - accuracy20: 0.4624 - val_loss: 3.1881 - val_accuracy20: 0.4217 - 79s/epoch - 13ms/step
Epoch 44/50
6147/6147 - 80s - loss: 3.1046 - accuracy20: 0.4625 - val_loss: 3.1847 - val_accuracy20: 0.4249 - 80s/epoch - 13ms/step
Epoch 45/50
6147/6147 - 81s - loss: 3.1038 - accuracy20: 0.4629 - val_loss: 3.1876 - val_accuracy20: 0.4220 - 81s/epoch - 13ms/step
Epoch 46/50
6147/6147 - 79s - loss: 3.1032 - accuracy20: 0.4629 - val_loss: 3.1881 - val_accuracy20: 0.4217 - 79s/epoch - 13ms/step
Epoch 47/50
6147/6147 - 82s - loss: 3.1023 - accuracy20: 0.4635 - val_loss: 3.1868 - val_accuracy20: 0.4235 - 82s/epoch - 13ms/step
Epoch 48/50
6147/6147 - 80s - loss: 3.1013 - accuracy20: 0.4636 - val_loss: 3.1893 - val_accuracy20: 0.4231 - 80s/epoch - 13ms/step
Epoch 49/50
6147/6147 - 78s - loss: 3.1010 - accuracy20: 0.4640 - val_loss: 3.1886 - val_accuracy20: 0.4226 - 78s/epoch - 13ms/step
Epoch 50/50
6147/6147 - 79s - loss: 3.0998 - accuracy20: 0.4641 - val_loss: 3.1821 - val_accuracy20: 0.4262 - 79s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h20
Evaluating performance on  test set...
14883/14883 - 96s - 96s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689197
{'0': {'precision': 0.4580725923806999, 'recall': 0.2893912879123867, 'f1-score': 0.3546986575844649, 'support': 1206301}, '1': {'precision': 0.4014160147101049, 'recall': 0.5870105653385507, 'f1-score': 0.4767889623513108, 'support': 1350359}, '2': {'precision': 0.42112521968938765, 'recall': 0.3605966643100969, 'f1-score': 0.3885175855635891, 'support': 1253234}, 'accuracy': 0.41830035166332713, 'macro avg': {'precision': 0.4268712755933975, 'recall': 0.4123328391870114, 'f1-score': 0.40666840183312164, 'support': 3809894}, 'weighted avg': {'precision': 0.42583798867936046, 'recall': 0.41830035166332713, 'f1-score': 0.4090961742192172, 'support': 3809894}}
[[349093 571301 285907]
 [222397 792675 335287]
 [190601 610721 451912]]
Evaluating performance on  train set...
6147/6147 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631852
{'0': {'precision': 0.4774310233142058, 'recall': 0.3196144724420327, 'f1-score': 0.3828987566117498, 'support': 521156}, '1': {'precision': 0.3816934718371418, 'recall': 0.5436989618584186, 'f1-score': 0.4485153256704981, 'support': 523628}, '2': {'precision': 0.4396694525621395, 'recall': 0.39810742974736096, 'f1-score': 0.4178574973695182, 'support': 528699}, 'accuracy': 0.42055999333961663, 'macro avg': {'precision': 0.4329313159044957, 'recall': 0.4204736213492708, 'f1-score': 0.41642385988392205, 'support': 1573483}, 'weighted avg': {'precision': 0.43288312079484026, 'recall': 0.42055999333961663, 'f1-score': 0.4164811493690822, 'support': 1573483}}
[[166569 227983 126604]
 [ 97294 284696 141638]
 [ 85023 233197 210479]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0609858
{'0': {'precision': 0.47742114997463053, 'recall': 0.3199969282752265, 'f1-score': 0.38316989707785176, 'support': 182308}, '1': {'precision': 0.39303369049503273, 'recall': 0.5723390113954311, 'f1-score': 0.4660345448395508, 'support': 186566}, '2': {'precision': 0.44136998093832625, 'recall': 0.3825634630041198, 'f1-score': 0.40986812615807156, 'support': 187629}, 'accuracy': 0.4256886306093588, 'macro avg': {'precision': 0.43727494046932985, 'recall': 0.4249664675582592, 'f1-score': 0.419690856025158, 'support': 556503}, 'weighted avg': {'precision': 0.43697558982422097, 'recall': 0.4256886306093588, 'f1-score': 0.41995152790176776, 'support': 556503}}
[[ 58338  79522  44448]
 [ 33385 106779  46402]
 [ 30471  85378  71780]]
training model: results/AAPL/W2/deepOF_L1/h30
Epoch 1/50
6147/6147 - 82s - loss: 3.2040 - accuracy30: 0.4277 - val_loss: 3.2850 - val_accuracy30: 0.3459 - 82s/epoch - 13ms/step
Epoch 2/50
6147/6147 - 78s - loss: 3.2000 - accuracy30: 0.4284 - val_loss: 3.2768 - val_accuracy30: 0.3510 - 78s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 81s - loss: 3.1979 - accuracy30: 0.4283 - val_loss: 3.2766 - val_accuracy30: 0.3527 - 81s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 81s - loss: 3.1943 - accuracy30: 0.4294 - val_loss: 3.2713 - val_accuracy30: 0.3549 - 81s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 80s - loss: 3.1913 - accuracy30: 0.4308 - val_loss: 3.2693 - val_accuracy30: 0.3565 - 80s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 78s - loss: 3.1890 - accuracy30: 0.4319 - val_loss: 3.2667 - val_accuracy30: 0.3591 - 78s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 81s - loss: 3.1863 - accuracy30: 0.4329 - val_loss: 3.2606 - val_accuracy30: 0.3624 - 81s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 79s - loss: 3.1823 - accuracy30: 0.4349 - val_loss: 3.2573 - val_accuracy30: 0.3651 - 79s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 80s - loss: 3.1797 - accuracy30: 0.4357 - val_loss: 3.2540 - val_accuracy30: 0.3667 - 80s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 79s - loss: 3.1773 - accuracy30: 0.4369 - val_loss: 3.2507 - val_accuracy30: 0.3691 - 79s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 79s - loss: 3.1752 - accuracy30: 0.4375 - val_loss: 3.2493 - val_accuracy30: 0.3699 - 79s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 79s - loss: 3.1736 - accuracy30: 0.4376 - val_loss: 3.2454 - val_accuracy30: 0.3714 - 79s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 78s - loss: 3.1716 - accuracy30: 0.4387 - val_loss: 3.2433 - val_accuracy30: 0.3717 - 78s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 80s - loss: 3.1696 - accuracy30: 0.4392 - val_loss: 3.2434 - val_accuracy30: 0.3735 - 80s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 80s - loss: 3.1684 - accuracy30: 0.4396 - val_loss: 3.2404 - val_accuracy30: 0.3733 - 80s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 79s - loss: 3.1670 - accuracy30: 0.4403 - val_loss: 3.2401 - val_accuracy30: 0.3752 - 79s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 79s - loss: 3.1656 - accuracy30: 0.4408 - val_loss: 3.2390 - val_accuracy30: 0.3737 - 79s/epoch - 13ms/step
Epoch 18/50
6147/6147 - 80s - loss: 3.1641 - accuracy30: 0.4413 - val_loss: 3.2374 - val_accuracy30: 0.3750 - 80s/epoch - 13ms/step
Epoch 19/50
6147/6147 - 81s - loss: 3.1626 - accuracy30: 0.4419 - val_loss: 3.2381 - val_accuracy30: 0.3755 - 81s/epoch - 13ms/step
Epoch 20/50
6147/6147 - 81s - loss: 3.1612 - accuracy30: 0.4424 - val_loss: 3.2362 - val_accuracy30: 0.3762 - 81s/epoch - 13ms/step
Epoch 21/50
6147/6147 - 80s - loss: 3.1601 - accuracy30: 0.4428 - val_loss: 3.2357 - val_accuracy30: 0.3758 - 80s/epoch - 13ms/step
Epoch 22/50
6147/6147 - 78s - loss: 3.1590 - accuracy30: 0.4431 - val_loss: 3.2345 - val_accuracy30: 0.3765 - 78s/epoch - 13ms/step
Epoch 23/50
6147/6147 - 80s - loss: 3.1573 - accuracy30: 0.4438 - val_loss: 3.2330 - val_accuracy30: 0.3783 - 80s/epoch - 13ms/step
Epoch 24/50
6147/6147 - 78s - loss: 3.1564 - accuracy30: 0.4444 - val_loss: 3.2321 - val_accuracy30: 0.3790 - 78s/epoch - 13ms/step
Epoch 25/50
6147/6147 - 81s - loss: 3.1559 - accuracy30: 0.4441 - val_loss: 3.2312 - val_accuracy30: 0.3793 - 81s/epoch - 13ms/step
Epoch 26/50
6147/6147 - 78s - loss: 3.1544 - accuracy30: 0.4450 - val_loss: 3.2340 - val_accuracy30: 0.3787 - 78s/epoch - 13ms/step
Epoch 27/50
6147/6147 - 78s - loss: 3.1536 - accuracy30: 0.4451 - val_loss: 3.2326 - val_accuracy30: 0.3792 - 78s/epoch - 13ms/step
Epoch 28/50
6147/6147 - 79s - loss: 3.1526 - accuracy30: 0.4458 - val_loss: 3.2323 - val_accuracy30: 0.3804 - 79s/epoch - 13ms/step
Epoch 29/50
6147/6147 - 81s - loss: 3.1517 - accuracy30: 0.4460 - val_loss: 3.2324 - val_accuracy30: 0.3800 - 81s/epoch - 13ms/step
Epoch 30/50
6147/6147 - 81s - loss: 3.1507 - accuracy30: 0.4464 - val_loss: 3.2314 - val_accuracy30: 0.3797 - 81s/epoch - 13ms/step
Epoch 31/50
6147/6147 - 82s - loss: 3.1500 - accuracy30: 0.4466 - val_loss: 3.2314 - val_accuracy30: 0.3797 - 82s/epoch - 13ms/step
Epoch 32/50
6147/6147 - 80s - loss: 3.1490 - accuracy30: 0.4468 - val_loss: 3.2303 - val_accuracy30: 0.3806 - 80s/epoch - 13ms/step
Epoch 33/50
6147/6147 - 81s - loss: 3.1481 - accuracy30: 0.4476 - val_loss: 3.2312 - val_accuracy30: 0.3809 - 81s/epoch - 13ms/step
Epoch 34/50
6147/6147 - 79s - loss: 3.1477 - accuracy30: 0.4474 - val_loss: 3.2334 - val_accuracy30: 0.3810 - 79s/epoch - 13ms/step
Epoch 35/50
6147/6147 - 82s - loss: 3.1467 - accuracy30: 0.4479 - val_loss: 3.2310 - val_accuracy30: 0.3803 - 82s/epoch - 13ms/step
Epoch 36/50
6147/6147 - 79s - loss: 3.1458 - accuracy30: 0.4480 - val_loss: 3.2318 - val_accuracy30: 0.3810 - 79s/epoch - 13ms/step
Epoch 37/50
6147/6147 - 78s - loss: 3.1451 - accuracy30: 0.4485 - val_loss: 3.2315 - val_accuracy30: 0.3810 - 78s/epoch - 13ms/step
Epoch 38/50
6147/6147 - 78s - loss: 3.1446 - accuracy30: 0.4483 - val_loss: 3.2317 - val_accuracy30: 0.3808 - 78s/epoch - 13ms/step
Epoch 39/50
6147/6147 - 79s - loss: 3.1437 - accuracy30: 0.4488 - val_loss: 3.2315 - val_accuracy30: 0.3806 - 79s/epoch - 13ms/step
Epoch 40/50
6147/6147 - 81s - loss: 3.1430 - accuracy30: 0.4492 - val_loss: 3.2336 - val_accuracy30: 0.3799 - 81s/epoch - 13ms/step
Epoch 41/50
6147/6147 - 81s - loss: 3.1424 - accuracy30: 0.4496 - val_loss: 3.2292 - val_accuracy30: 0.3837 - 81s/epoch - 13ms/step
Epoch 42/50
6147/6147 - 79s - loss: 3.1418 - accuracy30: 0.4494 - val_loss: 3.2319 - val_accuracy30: 0.3811 - 79s/epoch - 13ms/step
Epoch 43/50
6147/6147 - 80s - loss: 3.1411 - accuracy30: 0.4498 - val_loss: 3.2305 - val_accuracy30: 0.3828 - 80s/epoch - 13ms/step
Epoch 44/50
6147/6147 - 79s - loss: 3.1402 - accuracy30: 0.4501 - val_loss: 3.2289 - val_accuracy30: 0.3830 - 79s/epoch - 13ms/step
Epoch 45/50
6147/6147 - 79s - loss: 3.1394 - accuracy30: 0.4505 - val_loss: 3.2315 - val_accuracy30: 0.3834 - 79s/epoch - 13ms/step
Epoch 46/50
6147/6147 - 79s - loss: 3.1384 - accuracy30: 0.4510 - val_loss: 3.2288 - val_accuracy30: 0.3858 - 79s/epoch - 13ms/step
Epoch 47/50
6147/6147 - 81s - loss: 3.1377 - accuracy30: 0.4512 - val_loss: 3.2307 - val_accuracy30: 0.3854 - 81s/epoch - 13ms/step
Epoch 48/50
6147/6147 - 78s - loss: 3.1371 - accuracy30: 0.4515 - val_loss: 3.2300 - val_accuracy30: 0.3848 - 78s/epoch - 13ms/step
Epoch 49/50
6147/6147 - 80s - loss: 3.1364 - accuracy30: 0.4515 - val_loss: 3.2320 - val_accuracy30: 0.3855 - 80s/epoch - 13ms/step
Epoch 50/50
6147/6147 - 82s - loss: 3.1361 - accuracy30: 0.4517 - val_loss: 3.2300 - val_accuracy30: 0.3868 - 82s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h30
Evaluating performance on  test set...
14883/14883 - 95s - 95s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763174
{'0': {'precision': 0.46175394660684493, 'recall': 0.20757299929511178, 'f1-score': 0.2864000985478852, 'support': 1176073}, '1': {'precision': 0.37967316042803295, 'recall': 0.7437309029606997, 'f1-score': 0.502712553100982, 'support': 1404668}, '2': {'precision': 0.43084841253058637, 'recall': 0.18565467439773567, 'f1-score': 0.2594926884849395, 'support': 1229153}, 'accuracy': 0.3981774821031766, 'macro avg': {'precision': 0.42409183985515475, 'recall': 0.378986192217849, 'f1-score': 0.3495351133779356, 'support': 3809894}, 'weighted avg': {'precision': 0.42152083679154434, 'recall': 0.3981774821031766, 'f1-score': 0.3574713302176087, 'support': 3809894}}
[[ 244121  817220  114732]
 [ 173255 1044695  186718]
 [ 111306  889649  228198]]
Evaluating performance on  train set...
6147/6147 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0789429
{'0': {'precision': 0.5041259747142101, 'recall': 0.21675021157476726, 'f1-score': 0.30315722382827615, 'support': 522274}, '1': {'precision': 0.34226048438698636, 'recall': 0.7468387141565052, 'f1-score': 0.4694033021197784, 'support': 518539}, '2': {'precision': 0.471766664520461, 'recall': 0.19257701766572174, 'f1-score': 0.2735072816181136, 'support': 532670}, 'accuracy': 0.3832567622274915, 'macro avg': {'precision': 0.4393843745405525, 'recall': 0.38538864779899806, 'f1-score': 0.34868926918872273, 'support': 1573483}, 'weighted avg': {'precision': 0.439828868708176, 'recall': 0.3832567622274915, 'f1-score': 0.34790600120566756, 'support': 1573483}}
[[113203 360873  48198]
 [ 64614 387265  66660]
 [ 46736 383354 102580]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0769374
{'0': {'precision': 0.48882550501308836, 'recall': 0.2182234104125899, 'f1-score': 0.3017419770353235, 'support': 181415}, '1': {'precision': 0.35059667362265234, 'recall': 0.7449341546304163, 'f1-score': 0.47679431732248007, 'support': 188320}, '2': {'precision': 0.46586627752719556, 'recall': 0.18802471515463035, 'f1-score': 0.267917359659429, 'support': 186768}, 'accuracy': 0.3863267583463162, 'macro avg': {'precision': 0.4350961520543121, 'recall': 0.3837274267325455, 'f1-score': 0.3488178846724108, 'support': 556503}, 'weighted avg': {'precision': 0.43434367378031485, 'recall': 0.3863267583463162, 'f1-score': 0.3496276139228448, 'support': 556503}}
[[ 39589 124950  16876]
 [ 24647 140286  23387]
 [ 16752 134899  35117]]
training model: results/AAPL/W2/deepOF_L1/h50
Epoch 1/50
6147/6147 - 86s - loss: 3.2028 - accuracy50: 0.4291 - val_loss: 3.4809 - val_accuracy50: 0.3585 - 86s/epoch - 14ms/step
Epoch 2/50
6147/6147 - 80s - loss: 3.2036 - accuracy50: 0.4282 - val_loss: 3.4586 - val_accuracy50: 0.3586 - 80s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 80s - loss: 3.2035 - accuracy50: 0.4280 - val_loss: 3.4442 - val_accuracy50: 0.3586 - 80s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 80s - loss: 3.2022 - accuracy50: 0.4287 - val_loss: 3.4276 - val_accuracy50: 0.3589 - 80s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 78s - loss: 3.2002 - accuracy50: 0.4293 - val_loss: 3.4302 - val_accuracy50: 0.3591 - 78s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 80s - loss: 3.1976 - accuracy50: 0.4304 - val_loss: 3.4314 - val_accuracy50: 0.3598 - 80s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 82s - loss: 3.1948 - accuracy50: 0.4318 - val_loss: 3.4131 - val_accuracy50: 0.3596 - 82s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 80s - loss: 3.1918 - accuracy50: 0.4331 - val_loss: 3.4545 - val_accuracy50: 0.3594 - 80s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 81s - loss: 3.1887 - accuracy50: 0.4344 - val_loss: 3.4437 - val_accuracy50: 0.3597 - 81s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 81s - loss: 3.1866 - accuracy50: 0.4354 - val_loss: 3.4344 - val_accuracy50: 0.3598 - 81s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 81s - loss: 3.1847 - accuracy50: 0.4364 - val_loss: 3.4283 - val_accuracy50: 0.3603 - 81s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 82s - loss: 3.1823 - accuracy50: 0.4376 - val_loss: 3.4239 - val_accuracy50: 0.3610 - 82s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 78s - loss: 3.1804 - accuracy50: 0.4382 - val_loss: 3.4313 - val_accuracy50: 0.3607 - 78s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 82s - loss: 3.1788 - accuracy50: 0.4390 - val_loss: 3.4340 - val_accuracy50: 0.3612 - 82s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 80s - loss: 3.1775 - accuracy50: 0.4397 - val_loss: 3.4376 - val_accuracy50: 0.3611 - 80s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 79s - loss: 3.1764 - accuracy50: 0.4398 - val_loss: 3.4242 - val_accuracy50: 0.3615 - 79s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 78s - loss: 3.1751 - accuracy50: 0.4404 - val_loss: 3.4200 - val_accuracy50: 0.3619 - 78s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h50
Evaluating performance on  test set...
14883/14883 - 101s - 101s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0372939
{'0': {'precision': 0.4429685491473134, 'recall': 0.010663536440454185, 'f1-score': 0.020825737049385076, 'support': 969472}, '1': {'precision': 0.487169803746749, 'recall': 0.9943685978309911, 'f1-score': 0.6539504533144359, 'support': 1855133}, '2': {'precision': 0.65, 'recall': 1.3194098381287115e-05, 'f1-score': 2.6387661129655775e-05, 'support': 985289}, 'accuracy': 0.4868998980024116, 'macro avg': {'precision': 0.5267127842980207, 'recall': 0.3350151094566088, 'f1-score': 0.22493419267498352, 'support': 3809894}, 'weighted avg': {'precision': 0.5180323218475532, 'recall': 0.4868998980024116, 'f1-score': 0.32373106305045696, 'support': 3809894}}
[[  10338  959133       1]
 [  10441 1844686       6]
 [   2559  982717      13]]
Evaluating performance on  train set...
6147/6147 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1615345
{'0': {'precision': 0.5624107397886319, 'recall': 0.011369476218797457, 'f1-score': 0.022288379253356274, 'support': 519549}, '1': {'precision': 0.33027761249416177, 'recall': 0.9942948056150516, 'f1-score': 0.4958480337113728, 'support': 519176}, '2': {'precision': 0.6, 'recall': 1.1220028498872386e-05, 'f1-score': 2.243963737546001e-05, 'support': 534758}, 'accuracy': 0.3318288154368366, 'macro avg': {'precision': 0.4975627840942645, 'recall': 0.33522516728744933, 'f1-score': 0.17271961753403486, 'support': 1573483}, 'weighted avg': {'precision': 0.4985925791322263, 'recall': 0.3318288154368366, 'f1-score': 0.17097375928334868, 'support': 1573483}}
[[  5907 513640      2]
 [  2960 516214      2]
 [  1636 533116      6]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.139555
{'0': {'precision': 0.5062636165577342, 'recall': 0.010546679980029955, 'f1-score': 0.020662902365285434, 'support': 176264}, '1': {'precision': 0.35858350155925534, 'recall': 0.9935595429029671, 'f1-score': 0.5269768777214799, 'support': 199520}, '2': {'precision': 0.6666666666666666, 'recall': 1.106690497402044e-05, 'f1-score': 2.2133442524983122e-05, 'support': 180719}, 'accuracy': 0.3595596070461435, 'macro avg': {'precision': 0.5105045949278854, 'recall': 0.33470576326265705, 'f1-score': 0.18255397117643013, 'support': 556503}, 'weighted avg': {'precision': 0.5054060151937517, 'recall': 0.3595596070461435, 'f1-score': 0.19548601247271627, 'support': 556503}}
[[  1859 174405      0]
 [  1284 198235      1]
 [   529 180188      2]]
training model: results/AAPL/W2/deepOF_L1/h100
Epoch 1/50
6147/6147 - 84s - loss: 3.2415 - accuracy100: 0.4047 - val_loss: 3.3497 - val_accuracy100: 0.3258 - 84s/epoch - 14ms/step
Epoch 2/50
6147/6147 - 79s - loss: 3.2430 - accuracy100: 0.4017 - val_loss: 3.3411 - val_accuracy100: 0.3257 - 79s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 80s - loss: 3.2423 - accuracy100: 0.4022 - val_loss: 3.3380 - val_accuracy100: 0.3257 - 80s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 78s - loss: 3.2403 - accuracy100: 0.4033 - val_loss: 3.3365 - val_accuracy100: 0.3258 - 78s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 80s - loss: 3.2378 - accuracy100: 0.4055 - val_loss: 3.3358 - val_accuracy100: 0.3259 - 80s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 80s - loss: 3.2365 - accuracy100: 0.4064 - val_loss: 3.3337 - val_accuracy100: 0.3258 - 80s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 78s - loss: 3.2342 - accuracy100: 0.4079 - val_loss: 3.3348 - val_accuracy100: 0.3260 - 78s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 78s - loss: 3.2335 - accuracy100: 0.4083 - val_loss: 3.3306 - val_accuracy100: 0.3261 - 78s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 80s - loss: 3.2323 - accuracy100: 0.4092 - val_loss: 3.3300 - val_accuracy100: 0.3265 - 80s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 81s - loss: 3.2305 - accuracy100: 0.4102 - val_loss: 3.3270 - val_accuracy100: 0.3269 - 81s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 80s - loss: 3.2294 - accuracy100: 0.4111 - val_loss: 3.3254 - val_accuracy100: 0.3281 - 80s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 79s - loss: 3.2276 - accuracy100: 0.4122 - val_loss: 3.3296 - val_accuracy100: 0.3281 - 79s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 80s - loss: 3.2258 - accuracy100: 0.4131 - val_loss: 3.3285 - val_accuracy100: 0.3289 - 80s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 79s - loss: 3.2243 - accuracy100: 0.4140 - val_loss: 3.3279 - val_accuracy100: 0.3298 - 79s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 81s - loss: 3.2224 - accuracy100: 0.4154 - val_loss: 3.3270 - val_accuracy100: 0.3311 - 81s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 80s - loss: 3.2219 - accuracy100: 0.4156 - val_loss: 3.3259 - val_accuracy100: 0.3309 - 80s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 78s - loss: 3.2201 - accuracy100: 0.4166 - val_loss: 3.3237 - val_accuracy100: 0.3324 - 78s/epoch - 13ms/step
Epoch 18/50
6147/6147 - 80s - loss: 3.2190 - accuracy100: 0.4174 - val_loss: 3.3222 - val_accuracy100: 0.3337 - 80s/epoch - 13ms/step
Epoch 19/50
6147/6147 - 81s - loss: 3.2178 - accuracy100: 0.4179 - val_loss: 3.3155 - val_accuracy100: 0.3389 - 81s/epoch - 13ms/step
Epoch 20/50
6147/6147 - 79s - loss: 3.2170 - accuracy100: 0.4183 - val_loss: 3.3146 - val_accuracy100: 0.3389 - 79s/epoch - 13ms/step
Epoch 21/50
6147/6147 - 78s - loss: 3.2160 - accuracy100: 0.4188 - val_loss: 3.3132 - val_accuracy100: 0.3423 - 78s/epoch - 13ms/step
Epoch 22/50
6147/6147 - 81s - loss: 3.2148 - accuracy100: 0.4193 - val_loss: 3.3146 - val_accuracy100: 0.3420 - 81s/epoch - 13ms/step
Epoch 23/50
6147/6147 - 78s - loss: 3.2144 - accuracy100: 0.4198 - val_loss: 3.3148 - val_accuracy100: 0.3423 - 78s/epoch - 13ms/step
Epoch 24/50
6147/6147 - 82s - loss: 3.2133 - accuracy100: 0.4203 - val_loss: 3.3135 - val_accuracy100: 0.3440 - 82s/epoch - 13ms/step
Epoch 25/50
6147/6147 - 79s - loss: 3.2126 - accuracy100: 0.4208 - val_loss: 3.3154 - val_accuracy100: 0.3423 - 79s/epoch - 13ms/step
Epoch 26/50
6147/6147 - 78s - loss: 3.2120 - accuracy100: 0.4209 - val_loss: 3.3169 - val_accuracy100: 0.3426 - 78s/epoch - 13ms/step
Epoch 27/50
6147/6147 - 80s - loss: 3.2109 - accuracy100: 0.4215 - val_loss: 3.3150 - val_accuracy100: 0.3450 - 80s/epoch - 13ms/step
Epoch 28/50
6147/6147 - 82s - loss: 3.2098 - accuracy100: 0.4221 - val_loss: 3.3168 - val_accuracy100: 0.3450 - 82s/epoch - 13ms/step
Epoch 29/50
6147/6147 - 80s - loss: 3.2092 - accuracy100: 0.4225 - val_loss: 3.3180 - val_accuracy100: 0.3441 - 80s/epoch - 13ms/step
Epoch 30/50
6147/6147 - 81s - loss: 3.2084 - accuracy100: 0.4228 - val_loss: 3.3199 - val_accuracy100: 0.3448 - 81s/epoch - 13ms/step
Epoch 31/50
6147/6147 - 80s - loss: 3.2076 - accuracy100: 0.4234 - val_loss: 3.3192 - val_accuracy100: 0.3436 - 80s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h100
Evaluating performance on  test set...
14883/14883 - 106s - 106s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898015
{'0': {'precision': 0.4060767410412441, 'recall': 0.12218580013172986, 'f1-score': 0.1878490623576627, 'support': 1179687}, '1': {'precision': 0.3721402618496887, 'recall': 0.8482475827871447, 'f1-score': 0.5173225527589725, 'support': 1408854}, '2': {'precision': 0.414656071191088, 'recall': 0.08271236898750811, 'f1-score': 0.1379146049192514, 'support': 1221353}, 'accuracy': 0.3780207533332948, 'macro avg': {'precision': 0.39762435802734025, 'recall': 0.35104858396879424, 'f1-score': 0.2810287400119622, 'support': 3809894}, 'weighted avg': {'precision': 0.3962777403765439, 'recall': 0.3780207533332948, 'f1-score': 0.2936767954783403, 'support': 3809894}}
[[ 144141  979614   55932]
 [ 127124 1195057   86673]
 [  83695 1036637  101021]]
Evaluating performance on  train set...
6147/6147 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036464
{'0': {'precision': 0.4373569336311201, 'recall': 0.12113737317287032, 'f1-score': 0.1897253720711938, 'support': 518915}, '1': {'precision': 0.33349043413943336, 'recall': 0.8544348043794355, 'f1-score': 0.47973698111106117, 'support': 519245}, '2': {'precision': 0.4296881287726358, 'recall': 0.07978547531116728, 'f1-score': 0.13458154186944543, 'support': 535323}, 'accuracy': 0.34905493100338547, 'macro avg': {'precision': 0.4001784988477297, 'recall': 0.35178588428782437, 'f1-score': 0.2680146316839001, 'support': 1573483}, 'weighted avg': {'precision': 0.400472233795266, 'recall': 0.34905493100338547, 'f1-score': 0.26666761887069235, 'support': 1573483}}
[[ 62860 431199  24856]
 [ 43751 443661  31833]
 [ 37116 455496  42711]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1052947
{'0': {'precision': 0.41670772431160014, 'recall': 0.12329255255968642, 'f1-score': 0.19028493577591774, 'support': 185218}, '1': {'precision': 0.32570712418159425, 'recall': 0.8317001037321503, 'f1-score': 0.468099114010925, 'support': 181236}, '2': {'precision': 0.4344418174342105, 'recall': 0.08895074428173787, 'f1-score': 0.14766706993767498, 'support': 190049}, 'accuracy': 0.34227129054111116, 'macro avg': {'precision': 0.39228555530913495, 'recall': 0.34798113352452487, 'f1-score': 0.26868370657483925, 'support': 556503}, 'weighted avg': {'precision': 0.3931279087467195, 'recall': 0.34227129054111116, 'f1-score': 0.2662062652600491, 'support': 556503}}
[[ 22836 153080   9302]
 [ 17797 150734  12705]
 [ 14168 158976  16905]]
training model: results/AAPL/W2/deepOF_L1/h200
Epoch 1/50
6147/6147 - 85s - loss: 3.2461 - accuracy200: 0.3992 - val_loss: 3.4825 - val_accuracy200: 0.3530 - 85s/epoch - 14ms/step
Epoch 2/50
6147/6147 - 81s - loss: 3.2515 - accuracy200: 0.3950 - val_loss: 3.4723 - val_accuracy200: 0.3530 - 81s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 82s - loss: 3.2530 - accuracy200: 0.3940 - val_loss: 3.4640 - val_accuracy200: 0.3530 - 82s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 79s - loss: 3.2512 - accuracy200: 0.3949 - val_loss: 3.4638 - val_accuracy200: 0.3530 - 79s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 80s - loss: 3.2497 - accuracy200: 0.3961 - val_loss: 3.4543 - val_accuracy200: 0.3530 - 80s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 78s - loss: 3.2469 - accuracy200: 0.3985 - val_loss: 3.4556 - val_accuracy200: 0.3530 - 78s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 80s - loss: 3.2448 - accuracy200: 0.4001 - val_loss: 3.4495 - val_accuracy200: 0.3530 - 80s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 78s - loss: 3.2435 - accuracy200: 0.4012 - val_loss: 3.4488 - val_accuracy200: 0.3530 - 78s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 78s - loss: 3.2423 - accuracy200: 0.4019 - val_loss: 3.4494 - val_accuracy200: 0.3530 - 78s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 81s - loss: 3.2407 - accuracy200: 0.4032 - val_loss: 3.4461 - val_accuracy200: 0.3530 - 81s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 81s - loss: 3.2383 - accuracy200: 0.4049 - val_loss: 3.4413 - val_accuracy200: 0.3530 - 81s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 79s - loss: 3.2364 - accuracy200: 0.4059 - val_loss: 3.4453 - val_accuracy200: 0.3530 - 79s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 78s - loss: 3.2350 - accuracy200: 0.4066 - val_loss: 3.4491 - val_accuracy200: 0.3530 - 78s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 80s - loss: 3.2334 - accuracy200: 0.4075 - val_loss: 3.4473 - val_accuracy200: 0.3530 - 80s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 82s - loss: 3.2320 - accuracy200: 0.4084 - val_loss: 3.4440 - val_accuracy200: 0.3531 - 82s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 82s - loss: 3.2312 - accuracy200: 0.4089 - val_loss: 3.4442 - val_accuracy200: 0.3530 - 82s/epoch - 13ms/step
Epoch 17/50
6147/6147 - 80s - loss: 3.2304 - accuracy200: 0.4093 - val_loss: 3.4482 - val_accuracy200: 0.3530 - 80s/epoch - 13ms/step
Epoch 18/50
6147/6147 - 81s - loss: 3.2297 - accuracy200: 0.4097 - val_loss: 3.4456 - val_accuracy200: 0.3531 - 81s/epoch - 13ms/step
Epoch 19/50
6147/6147 - 80s - loss: 3.2284 - accuracy200: 0.4107 - val_loss: 3.4511 - val_accuracy200: 0.3531 - 80s/epoch - 13ms/step
Epoch 20/50
6147/6147 - 79s - loss: 3.2274 - accuracy200: 0.4116 - val_loss: 3.4511 - val_accuracy200: 0.3531 - 79s/epoch - 13ms/step
Epoch 21/50
6147/6147 - 80s - loss: 3.2266 - accuracy200: 0.4119 - val_loss: 3.4527 - val_accuracy200: 0.3531 - 80s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h200
Evaluating performance on  test set...
14883/14883 - 101s - 101s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986024
{'0': {'precision': 0.4947589098532495, 'recall': 0.00021594556707671923, 'f1-score': 0.00043170271048936977, 'support': 1092868}, '1': {'precision': 0.41996335361659903, 'recall': 0.9998968727440912, 'f1-score': 0.5914949037267913, 'support': 1599965}, '2': {'precision': 0.3783783783783784, 'recall': 1.253288763997669e-05, 'f1-score': 2.5064945063011483e-05, 'support': 1117061}, 'accuracy': 0.41997231419036857, 'macro avg': {'precision': 0.4310335472827423, 'recall': 0.3333751170662693, 'f1-score': 0.19731722379411457, 'support': 3809894}, 'weighted avg': {'precision': 0.4292257414753305, 'recall': 0.41997231419036857, 'f1-score': 0.24852947005655265, 'support': 3809894}}
[[    236 1092622      10]
 [    152 1599800      13]
 [     89 1116958      14]]
Evaluating performance on  train set...
6147/6147 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1680404
{'0': {'precision': 0.48936170212765956, 'recall': 0.00017737025462271226, 'f1-score': 0.0003546119793322888, 'support': 518689}, '1': {'precision': 0.3301705162650537, 'recall': 0.9999056785370548, 'f1-score': 0.49642174694819957, 'support': 519500}, '2': {'precision': 0.35714285714285715, 'recall': 9.340661393551955e-06, 'f1-score': 1.868083421133254e-05, 'support': 535294}, 'accuracy': 0.3301897764386396, 'macro avg': {'precision': 0.3922250251785235, 'recall': 0.3333641298176903, 'f1-score': 0.16559834658724773, 'support': 1573483}, 'weighted avg': {'precision': 0.39182281835013, 'recall': 0.3301897764386396, 'f1-score': 0.16402149283532513, 'support': 1573483}}
[[    92 518590      7]
 [    47 519451      2]
 [    49 535240      5]]
Evaluating performance on  val set...
2174/2174 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1488776
{'0': {'precision': 0.5581395348837209, 'recall': 0.00027047282029898516, 'f1-score': 0.000540683626860712, 'support': 177467}, '1': {'precision': 0.35297838995844777, 'recall': 0.999882905769691, 'f1-score': 0.5217638487256768, 'support': 196423}, '2': {'precision': 0.5555555555555556, 'recall': 2.738030698800195e-05, 'f1-score': 5.475791525665035e-05, 'support': 182613}, 'accuracy': 0.35301337099710156, 'macro avg': {'precision': 0.4888911601325748, 'recall': 0.3333935862989926, 'f1-score': 0.17411976342259805, 'support': 556503}, 'weighted avg': {'precision': 0.4848780506029332, 'recall': 0.35301337099710156, 'f1-score': 0.18435187854626203, 'support': 556503}}
[[    48 177418      1]
 [    20 196400      3]
 [    18 182590      5]]
training model: results/AAPL/W2/deepOF_L1/h300
Epoch 1/50
6147/6147 - 82s - loss: 3.2411 - accuracy300: 0.4012 - val_loss: 3.3822 - val_accuracy300: 0.3299 - 82s/epoch - 13ms/step
Epoch 2/50
6147/6147 - 79s - loss: 3.2456 - accuracy300: 0.3965 - val_loss: 3.3693 - val_accuracy300: 0.3299 - 79s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 78s - loss: 3.2470 - accuracy300: 0.3956 - val_loss: 3.3710 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 78s - loss: 3.2427 - accuracy300: 0.3993 - val_loss: 3.3791 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 80s - loss: 3.2399 - accuracy300: 0.4014 - val_loss: 3.3745 - val_accuracy300: 0.3299 - 80s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 79s - loss: 3.2390 - accuracy300: 0.4014 - val_loss: 3.3594 - val_accuracy300: 0.3299 - 79s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 82s - loss: 3.2354 - accuracy300: 0.4036 - val_loss: 3.3629 - val_accuracy300: 0.3299 - 82s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 78s - loss: 3.2344 - accuracy300: 0.4043 - val_loss: 3.3727 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 78s - loss: 3.2311 - accuracy300: 0.4067 - val_loss: 3.3715 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 81s - loss: 3.2291 - accuracy300: 0.4081 - val_loss: 3.3727 - val_accuracy300: 0.3299 - 81s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 78s - loss: 3.2274 - accuracy300: 0.4088 - val_loss: 3.3748 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 80s - loss: 3.2271 - accuracy300: 0.4093 - val_loss: 3.3775 - val_accuracy300: 0.3299 - 80s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 78s - loss: 3.2255 - accuracy300: 0.4105 - val_loss: 3.3797 - val_accuracy300: 0.3299 - 78s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 80s - loss: 3.2241 - accuracy300: 0.4112 - val_loss: 3.3780 - val_accuracy300: 0.3299 - 80s/epoch - 13ms/step
Epoch 15/50
6147/6147 - 81s - loss: 3.2233 - accuracy300: 0.4118 - val_loss: 3.3809 - val_accuracy300: 0.3299 - 81s/epoch - 13ms/step
Epoch 16/50
6147/6147 - 81s - loss: 3.2221 - accuracy300: 0.4124 - val_loss: 3.3786 - val_accuracy300: 0.3299 - 81s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h300
Evaluating performance on  test set...
14883/14883 - 98s - 98s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094487
{'0': {'precision': 0.524822695035461, 'recall': 0.0001228254500971815, 'f1-score': 0.0002455934234063808, 'support': 1204962}, '1': {'precision': 0.3576865994081234, 'recall': 0.9999449626112673, 'f1-score': 0.5268983475011446, 'support': 1362710}, '2': {'precision': 0.4411764705882353, 'recall': 1.2075136328289146e-05, 'f1-score': 2.4149611674244277e-05, 'support': 1242222}, 'accuracy': 0.35769971553014335, 'macro avg': {'precision': 0.4412285883439399, 'recall': 0.33335995439923094, 'f1-score': 0.17572269684540842, 'support': 3809894}, 'weighted avg': {'precision': 0.43776903708654935, 'recall': 0.35769971553014335, 'f1-score': 0.1885447671365273, 'support': 3809894}}
[[    148 1204806       8]
 [     64 1362635      11]
 [     70 1242137      15]]
Evaluating performance on  train set...
6147/6147 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1221609
{'0': {'precision': 0.5412844036697247, 'recall': 0.00011350650449985957, 'f1-score': 0.00022696541470235796, 'support': 519794}, '1': {'precision': 0.33019821299411833, 'recall': 0.9999441823581606, 'f1-score': 0.4964577976947854, 'support': 519549}, '2': {'precision': 0.6875, 'recall': 2.059385179915378e-05, 'f1-score': 4.118646987022517e-05, 'support': 534140}, 'accuracy': 0.33021646881472505, 'macro avg': {'precision': 0.519660872221281, 'recall': 0.33335942757148657, 'f1-score': 0.16557531652645266, 'support': 1573483}, 'weighted avg': {'precision': 0.5212206211849648, 'recall': 0.33021646881472505, 'f1-score': 0.16401456319281132, 'support': 1573483}}
[[    59 519730      5]
 [    29 519520      0]
 [    21 534108     11]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1206765
{'0': {'precision': 0.4634146341463415, 'recall': 0.00010358570081178478, 'f1-score': 0.0002071251035625518, 'support': 183423}, '1': {'precision': 0.3298482008557683, 'recall': 0.999929178470255, 'f1-score': 0.4960602362912304, 'support': 183560}, '2': {'precision': 0.3333333333333333, 'recall': 5.2764879696074294e-06, 'f1-score': 1.0552808893907336e-05, 'support': 189520}, 'accuracy': 0.32985806006436624, 'macro avg': {'precision': 0.37553205611181434, 'recall': 0.33334601355301213, 'f1-score': 0.16542597140122897, 'support': 556503}, 'weighted avg': {'precision': 0.375058483999983, 'recall': 0.32985806006436624, 'f1-score': 0.1636950896038846, 'support': 556503}}
[[    19 183403      1]
 [    12 183547      1]
 [    10 189509      1]]
training model: results/AAPL/W2/deepOF_L1/h500
Epoch 1/50
6147/6147 - 83s - loss: 3.2579 - accuracy500: 0.3903 - val_loss: 3.4213 - val_accuracy500: 0.3253 - 83s/epoch - 14ms/step
Epoch 2/50
6147/6147 - 81s - loss: 3.2613 - accuracy500: 0.3854 - val_loss: 3.4093 - val_accuracy500: 0.3253 - 81s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 81s - loss: 3.2622 - accuracy500: 0.3845 - val_loss: 3.4138 - val_accuracy500: 0.3253 - 81s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 79s - loss: 3.2602 - accuracy500: 0.3865 - val_loss: 3.4255 - val_accuracy500: 0.3253 - 79s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 80s - loss: 3.2570 - accuracy500: 0.3893 - val_loss: 3.4249 - val_accuracy500: 0.3253 - 80s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 79s - loss: 3.2552 - accuracy500: 0.3905 - val_loss: 3.4179 - val_accuracy500: 0.3253 - 79s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 79s - loss: 3.2539 - accuracy500: 0.3918 - val_loss: 3.4172 - val_accuracy500: 0.3253 - 79s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 80s - loss: 3.2527 - accuracy500: 0.3926 - val_loss: 3.4143 - val_accuracy500: 0.3253 - 80s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 78s - loss: 3.2511 - accuracy500: 0.3938 - val_loss: 3.4195 - val_accuracy500: 0.3253 - 78s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 80s - loss: 3.2510 - accuracy500: 0.3943 - val_loss: 3.4233 - val_accuracy500: 0.3253 - 80s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 80s - loss: 3.2502 - accuracy500: 0.3946 - val_loss: 3.4199 - val_accuracy500: 0.3254 - 80s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 78s - loss: 3.2489 - accuracy500: 0.3957 - val_loss: 3.4168 - val_accuracy500: 0.3254 - 78s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h500
Evaluating performance on  test set...
14883/14883 - 91s - 91s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077213
{'0': {'precision': 0.3148148148148148, 'recall': 2.9267352096575375e-05, 'f1-score': 5.852926291000609e-05, 'support': 1161704}, '1': {'precision': 0.3819181833191111, 'recall': 0.9999663245516011, 'f1-score': 0.5527311723633085, 'support': 1455066}, '2': {'precision': 0.4, 'recall': 8.381358517639407e-06, 'f1-score': 1.676236580678524e-05, 'support': 1193124}, 'accuracy': 0.381916399773852, 'macro avg': {'precision': 0.365577666044642, 'recall': 0.33333465775407173, 'f1-score': 0.18426882133067513, 'support': 3809894}, 'weighted avg': {'precision': 0.3671197657885063, 'recall': 0.381916399773852, 'f1-score': 0.21112092076728917, 'support': 3809894}}
[[     34 1161664       6]
 [     40 1455017       9]
 [     34 1193080      10]]
Evaluating performance on  train set...
6147/6147 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1358407
{'0': {'precision': 0.4090909090909091, 'recall': 5.2004584107784315e-05, 'f1-score': 0.0001039959480097294, 'support': 519185}, '1': {'precision': 0.3300839071415769, 'recall': 0.9999576416405778, 'f1-score': 0.49633024717314356, 'support': 519378}, '2': {'precision': 0.2727272727272727, 'recall': 5.6083152620952665e-06, 'f1-score': 1.1216399872133041e-05, 'support': 534920}, 'accuracy': 0.33008682013088164, 'macro avg': {'precision': 0.3373006963199196, 'recall': 0.33333841817998255, 'f1-score': 0.1654818198403418, 'support': 1573483}, 'weighted avg': {'precision': 0.33665406991179075, 'recall': 0.33008682013088164, 'f1-score': 0.16386767707638406, 'support': 1573483}}
[[    27 519150      8]
 [    22 519356      0]
 [    17 534900      3]]
Evaluating performance on  val set...
2174/2174 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1375709
{'0': {'precision': 0.3793103448275862, 'recall': 5.966328213138939e-05, 'f1-score': 0.00011930779784920578, 'support': 184368}, '1': {'precision': 0.32529098551406993, 'recall': 0.9999281879046336, 'f1-score': 0.49088880120515416, 'support': 181028}, '2': {'precision': 0.3333333333333333, 'recall': 5.232670702800002e-06, 'f1-score': 1.046517712312281e-05, 'support': 191107}, 'accuracy': 0.32529384387864935, 'macro avg': {'precision': 0.34597822122499644, 'recall': 0.33333102795248926, 'f1-score': 0.16367285806004214, 'support': 556503}, 'weighted avg': {'precision': 0.3459492572621294, 'recall': 0.32529384387864935, 'f1-score': 0.15972710733499187, 'support': 556503}}
[[    11 184357      0]
 [    11 181015      2]
 [     7 191099      1]]
training model: results/AAPL/W2/deepOF_L1/h1000
Epoch 1/50
6147/6147 - 84s - loss: 3.2501 - accuracy1000: 0.3945 - val_loss: 3.4305 - val_accuracy1000: 0.3321 - 84s/epoch - 14ms/step
Epoch 2/50
6147/6147 - 81s - loss: 3.2556 - accuracy1000: 0.3845 - val_loss: 3.4333 - val_accuracy1000: 0.3321 - 81s/epoch - 13ms/step
Epoch 3/50
6147/6147 - 81s - loss: 3.2585 - accuracy1000: 0.3823 - val_loss: 3.4222 - val_accuracy1000: 0.3321 - 81s/epoch - 13ms/step
Epoch 4/50
6147/6147 - 80s - loss: 3.2530 - accuracy1000: 0.3873 - val_loss: 3.4184 - val_accuracy1000: 0.3321 - 80s/epoch - 13ms/step
Epoch 5/50
6147/6147 - 83s - loss: 3.2496 - accuracy1000: 0.3908 - val_loss: 3.4276 - val_accuracy1000: 0.3321 - 83s/epoch - 13ms/step
Epoch 6/50
6147/6147 - 81s - loss: 3.2466 - accuracy1000: 0.3931 - val_loss: 3.4329 - val_accuracy1000: 0.3321 - 81s/epoch - 13ms/step
Epoch 7/50
6147/6147 - 79s - loss: 3.2431 - accuracy1000: 0.3951 - val_loss: 3.4393 - val_accuracy1000: 0.3321 - 79s/epoch - 13ms/step
Epoch 8/50
6147/6147 - 80s - loss: 3.2406 - accuracy1000: 0.3970 - val_loss: 3.4393 - val_accuracy1000: 0.3321 - 80s/epoch - 13ms/step
Epoch 9/50
6147/6147 - 81s - loss: 3.2386 - accuracy1000: 0.3993 - val_loss: 3.4370 - val_accuracy1000: 0.3321 - 81s/epoch - 13ms/step
Epoch 10/50
6147/6147 - 80s - loss: 3.2366 - accuracy1000: 0.4009 - val_loss: 3.4348 - val_accuracy1000: 0.3321 - 80s/epoch - 13ms/step
Epoch 11/50
6147/6147 - 80s - loss: 3.2351 - accuracy1000: 0.4018 - val_loss: 3.4309 - val_accuracy1000: 0.3321 - 80s/epoch - 13ms/step
Epoch 12/50
6147/6147 - 82s - loss: 3.2331 - accuracy1000: 0.4035 - val_loss: 3.4292 - val_accuracy1000: 0.3321 - 82s/epoch - 13ms/step
Epoch 13/50
6147/6147 - 79s - loss: 3.2317 - accuracy1000: 0.4046 - val_loss: 3.4330 - val_accuracy1000: 0.3321 - 79s/epoch - 13ms/step
Epoch 14/50
6147/6147 - 82s - loss: 3.2305 - accuracy1000: 0.4052 - val_loss: 3.4326 - val_accuracy1000: 0.3321 - 82s/epoch - 13ms/step
testing model: results/AAPL/W2/deepOF_L1/h1000
Evaluating performance on  test set...
14883/14883 - 87s - 87s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.121837
{'0': {'precision': 0.6363636363636364, 'recall': 5.879210774745598e-06, 'f1-score': 1.1758312917262631e-05, 'support': 1190636}, '1': {'precision': 0.3634290069900188, 'recall': 0.9999971111165679, 'f1-score': 0.5331098653012168, 'support': 1384618}, '2': {'precision': 0.5909090909090909, 'recall': 1.0529385083911099e-05, 'f1-score': 2.10583949291385e-05, 'support': 1234640}, 'accuracy': 0.36343110858202354, 'macro avg': {'precision': 0.5302339114209154, 'recall': 0.3333378399041422, 'f1-score': 0.17771422733635442, 'support': 3809894}, 'weighted avg': {'precision': 0.5224417790484356, 'recall': 0.36343110858202354, 'f1-score': 0.19375696932277225, 'support': 3809894}}
[[      7 1190623       6]
 [      1 1384614       3]
 [      3 1234624      13]]
Evaluating performance on  train set...
6147/6147 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402824
{'0': {'precision': 0.16666666666666666, 'recall': 1.9412424728323116e-06, 'f1-score': 3.882439725123268e-06, 'support': 515134}, '1': {'precision': 0.3314567966514688, 'recall': 0.9999904130260133, 'f1-score': 0.4978847326047121, 'support': 521541}, '2': {'precision': 0.45454545454545453, 'recall': 9.314317223290263e-06, 'f1-score': 1.862825272577908e-05, 'support': 536808}, 'accuracy': 0.3314570287699327, 'macro avg': {'precision': 0.31755630595453005, 'recall': 0.33333388952856985, 'f1-score': 0.16596908109905434, 'support': 1573483}, 'weighted avg': {'precision': 0.31949986889766635, 'recall': 0.3314570287699327, 'f1-score': 0.1650347039651453, 'support': 1573483}}
[[     1 515129      4]
 [     3 521536      2]
 [     2 536801      5]]
Evaluating performance on  val set...
2174/2174 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1395028
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 182101}, '1': {'precision': 0.3321245795118024, 'recall': 0.9999891791287034, 'f1-score': 0.49863757277519677, 'support': 184828}, '2': {'precision': 0.4, 'recall': 1.0549969932585692e-05, 'f1-score': 2.1099383370520993e-05, 'support': 189574}, 'accuracy': 0.332123995737669, 'macro avg': {'precision': 0.24404152650393415, 'recall': 0.33333324303287865, 'f1-score': 0.1662195573861891, 'support': 556503}, 'weighted avg': {'precision': 0.24656744309016737, 'recall': 0.332123995737669, 'f1-score': 0.16561669064748466, 'support': 556503}}
[[     0 182099      2]
 [     1 184826      1]
 [     1 189571      2]]
training model: results/AAPL/W2/deepLOB_L2/h10
Epoch 1/50
6147/6147 - 253s - loss: 3.1079 - accuracy10: 0.4497 - val_loss: 3.2635 - val_accuracy10: 0.4231 - 253s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 247s - loss: 3.0137 - accuracy10: 0.4830 - val_loss: 3.1898 - val_accuracy10: 0.4599 - 247s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 250s - loss: 2.9717 - accuracy10: 0.4963 - val_loss: 3.1765 - val_accuracy10: 0.4712 - 250s/epoch - 41ms/step
Epoch 4/50
6147/6147 - 248s - loss: 2.9470 - accuracy10: 0.5042 - val_loss: 3.1876 - val_accuracy10: 0.4615 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 248s - loss: 2.9279 - accuracy10: 0.5092 - val_loss: 3.1960 - val_accuracy10: 0.4607 - 248s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 247s - loss: 2.9132 - accuracy10: 0.5126 - val_loss: 3.1374 - val_accuracy10: 0.4657 - 247s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 248s - loss: 2.9016 - accuracy10: 0.5156 - val_loss: 3.1069 - val_accuracy10: 0.4706 - 248s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 2.8916 - accuracy10: 0.5177 - val_loss: 3.0772 - val_accuracy10: 0.4685 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 247s - loss: 2.8834 - accuracy10: 0.5200 - val_loss: 3.0727 - val_accuracy10: 0.4627 - 247s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 248s - loss: 2.8764 - accuracy10: 0.5216 - val_loss: 3.0628 - val_accuracy10: 0.4613 - 248s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 248s - loss: 2.8708 - accuracy10: 0.5229 - val_loss: 3.0598 - val_accuracy10: 0.4670 - 248s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 248s - loss: 2.8651 - accuracy10: 0.5240 - val_loss: 3.0413 - val_accuracy10: 0.4710 - 248s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 259s - loss: 2.8611 - accuracy10: 0.5252 - val_loss: 3.0325 - val_accuracy10: 0.4747 - 259s/epoch - 42ms/step
Epoch 14/50
6147/6147 - 250s - loss: 2.8572 - accuracy10: 0.5263 - val_loss: 3.0382 - val_accuracy10: 0.4763 - 250s/epoch - 41ms/step
Epoch 15/50
6147/6147 - 246s - loss: 2.8531 - accuracy10: 0.5271 - val_loss: 3.0310 - val_accuracy10: 0.4805 - 246s/epoch - 40ms/step
Epoch 16/50
6147/6147 - 248s - loss: 2.8495 - accuracy10: 0.5280 - val_loss: 3.0106 - val_accuracy10: 0.4844 - 248s/epoch - 40ms/step
Epoch 17/50
6147/6147 - 248s - loss: 2.8465 - accuracy10: 0.5287 - val_loss: 3.0213 - val_accuracy10: 0.4789 - 248s/epoch - 40ms/step
Epoch 18/50
6147/6147 - 250s - loss: 2.8439 - accuracy10: 0.5296 - val_loss: 3.0487 - val_accuracy10: 0.4712 - 250s/epoch - 41ms/step
Epoch 19/50
6147/6147 - 254s - loss: 2.8406 - accuracy10: 0.5306 - val_loss: 3.0364 - val_accuracy10: 0.4761 - 254s/epoch - 41ms/step
Epoch 20/50
6147/6147 - 249s - loss: 2.8383 - accuracy10: 0.5306 - val_loss: 3.0212 - val_accuracy10: 0.4806 - 249s/epoch - 40ms/step
Epoch 21/50
6147/6147 - 249s - loss: 2.8359 - accuracy10: 0.5318 - val_loss: 3.0774 - val_accuracy10: 0.4625 - 249s/epoch - 41ms/step
Epoch 22/50
6147/6147 - 250s - loss: 2.8337 - accuracy10: 0.5319 - val_loss: 2.9988 - val_accuracy10: 0.4867 - 250s/epoch - 41ms/step
Epoch 23/50
6147/6147 - 255s - loss: 2.8314 - accuracy10: 0.5324 - val_loss: 2.9992 - val_accuracy10: 0.4868 - 255s/epoch - 41ms/step
Epoch 24/50
6147/6147 - 247s - loss: 2.8286 - accuracy10: 0.5333 - val_loss: 2.9861 - val_accuracy10: 0.4912 - 247s/epoch - 40ms/step
Epoch 25/50
6147/6147 - 249s - loss: 2.8269 - accuracy10: 0.5338 - val_loss: 3.0376 - val_accuracy10: 0.4779 - 249s/epoch - 40ms/step
Epoch 26/50
6147/6147 - 248s - loss: 2.8249 - accuracy10: 0.5341 - val_loss: 3.0418 - val_accuracy10: 0.4779 - 248s/epoch - 40ms/step
Epoch 27/50
6147/6147 - 248s - loss: 2.8228 - accuracy10: 0.5347 - val_loss: 3.0763 - val_accuracy10: 0.4718 - 248s/epoch - 40ms/step
Epoch 28/50
6147/6147 - 247s - loss: 2.8208 - accuracy10: 0.5353 - val_loss: 2.9951 - val_accuracy10: 0.4959 - 247s/epoch - 40ms/step
Epoch 29/50
6147/6147 - 253s - loss: 2.8192 - accuracy10: 0.5358 - val_loss: 3.0223 - val_accuracy10: 0.4803 - 253s/epoch - 41ms/step
Epoch 30/50
6147/6147 - 248s - loss: 2.8176 - accuracy10: 0.5358 - val_loss: 3.0031 - val_accuracy10: 0.4892 - 248s/epoch - 40ms/step
Epoch 31/50
6147/6147 - 247s - loss: 2.8154 - accuracy10: 0.5367 - val_loss: 3.0559 - val_accuracy10: 0.4756 - 247s/epoch - 40ms/step
Epoch 32/50
6147/6147 - 248s - loss: 2.8136 - accuracy10: 0.5370 - val_loss: 3.0233 - val_accuracy10: 0.4839 - 248s/epoch - 40ms/step
Epoch 33/50
6147/6147 - 247s - loss: 2.8120 - accuracy10: 0.5374 - val_loss: 3.0407 - val_accuracy10: 0.4781 - 247s/epoch - 40ms/step
Epoch 34/50
6147/6147 - 248s - loss: 2.8106 - accuracy10: 0.5377 - val_loss: 3.0024 - val_accuracy10: 0.4903 - 248s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h10
Evaluating performance on  test set...
14883/14883 - 209s - 209s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.003533
{'0': {'precision': 0.45896554283427776, 'recall': 0.5059648317716449, 'f1-score': 0.48132057976507536, 'support': 1124424}, '1': {'precision': 0.5480266952164627, 'recall': 0.4566575679641522, 'f1-score': 0.4981874345771284, 'support': 1521096}, '2': {'precision': 0.4624327813588489, 'recall': 0.5174217329580832, 'f1-score': 0.4883842807503353, 'support': 1164379}, 'accuracy': 0.48978043774913715, 'macro avg': {'precision': 0.4898083398031965, 'recall': 0.4933480442312934, 'f1-score': 0.489297431697513, 'support': 3809899}, 'weighted avg': {'precision': 0.49558271887226035, 'recall': 0.48978043774913715, 'f1-score': 0.49021344817883394, 'support': 3809899}}
[[568919 275832 279673]
 [405786 694620 420690]
 [264863 297041 602475]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0274609
{'0': {'precision': 0.48274022411606043, 'recall': 0.4347210194234814, 'f1-score': 0.45747397794119243, 'support': 484980}, '1': {'precision': 0.519159774376525, 'recall': 0.4387149683260948, 'f1-score': 0.47555938959023303, 'support': 597495}, '2': {'precision': 0.4424715313333386, 'recall': 0.5693753691370848, 'f1-score': 0.4979654360129849, 'support': 491010}, 'accuracy': 0.4782568629507113, 'macro avg': {'precision': 0.4814571766086413, 'recall': 0.4809371189622203, 'f1-score': 0.4769996011814701, 'support': 1573485}, 'weighted avg': {'precision': 0.4840037686300736, 'recall': 0.4782568629507113, 'f1-score': 0.4769769626287327, 'support': 1573485}}
[[210831 128546 145603]
 [128702 262130 206663]
 [ 97205 114236 279569]]
Evaluating performance on  val set...
2174/2174 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0003717
{'0': {'precision': 0.4754343865524418, 'recall': 0.47730299568493517, 'f1-score': 0.47636685866194056, 'support': 168943}, '1': {'precision': 0.6089786652458941, 'recall': 0.37016680903791455, 'f1-score': 0.4604498416358939, 'support': 213058}, '2': {'precision': 0.44207234158281206, 'recall': 0.6520518271892174, 'f1-score': 0.5269129159305661, 'support': 174503}, 'accuracy': 0.49108182510817533, 'macro avg': {'precision': 0.5088284644603827, 'recall': 0.49984054397068906, 'f1-score': 0.4879098720761335, 'support': 556504}, 'weighted avg': {'precision': 0.5161005812186693, 'recall': 0.49108182510817533, 'f1-score': 0.48612274688199203, 'support': 556504}}
[[ 80637  26660  61646]
 [ 52232  78867  81959]
 [ 36738  23980 113785]]
training model: results/AAPL/W2/deepLOB_L2/h20
Epoch 1/50
6147/6147 - 255s - loss: 3.1604 - accuracy20: 0.4343 - val_loss: 3.3977 - val_accuracy20: 0.3669 - 255s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.1097 - accuracy20: 0.4577 - val_loss: 3.2693 - val_accuracy20: 0.4150 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 249s - loss: 3.0767 - accuracy20: 0.4690 - val_loss: 3.2516 - val_accuracy20: 0.4364 - 249s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 248s - loss: 3.0543 - accuracy20: 0.4769 - val_loss: 3.2740 - val_accuracy20: 0.4404 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 247s - loss: 3.0389 - accuracy20: 0.4816 - val_loss: 3.2374 - val_accuracy20: 0.4442 - 247s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 246s - loss: 3.0258 - accuracy20: 0.4860 - val_loss: 3.2592 - val_accuracy20: 0.4445 - 246s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 247s - loss: 3.0136 - accuracy20: 0.4893 - val_loss: 3.2639 - val_accuracy20: 0.4464 - 247s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.0026 - accuracy20: 0.4926 - val_loss: 3.3171 - val_accuracy20: 0.4345 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 248s - loss: 2.9938 - accuracy20: 0.4949 - val_loss: 3.2052 - val_accuracy20: 0.4548 - 248s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 249s - loss: 2.9864 - accuracy20: 0.4969 - val_loss: 3.2400 - val_accuracy20: 0.4508 - 249s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 249s - loss: 2.9805 - accuracy20: 0.4986 - val_loss: 3.2359 - val_accuracy20: 0.4478 - 249s/epoch - 41ms/step
Epoch 12/50
6147/6147 - 249s - loss: 2.9753 - accuracy20: 0.4996 - val_loss: 3.2182 - val_accuracy20: 0.4491 - 249s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 253s - loss: 2.9710 - accuracy20: 0.5007 - val_loss: 3.1937 - val_accuracy20: 0.4514 - 253s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 248s - loss: 2.9660 - accuracy20: 0.5021 - val_loss: 3.1569 - val_accuracy20: 0.4641 - 248s/epoch - 40ms/step
Epoch 15/50
6147/6147 - 252s - loss: 2.9631 - accuracy20: 0.5027 - val_loss: 3.1934 - val_accuracy20: 0.4522 - 252s/epoch - 41ms/step
Epoch 16/50
6147/6147 - 249s - loss: 2.9602 - accuracy20: 0.5035 - val_loss: 3.1649 - val_accuracy20: 0.4584 - 249s/epoch - 41ms/step
Epoch 17/50
6147/6147 - 248s - loss: 2.9570 - accuracy20: 0.5044 - val_loss: 3.1459 - val_accuracy20: 0.4622 - 248s/epoch - 40ms/step
Epoch 18/50
6147/6147 - 248s - loss: 2.9539 - accuracy20: 0.5050 - val_loss: 3.1571 - val_accuracy20: 0.4597 - 248s/epoch - 40ms/step
Epoch 19/50
6147/6147 - 248s - loss: 2.9513 - accuracy20: 0.5062 - val_loss: 3.1556 - val_accuracy20: 0.4607 - 248s/epoch - 40ms/step
Epoch 20/50
6147/6147 - 249s - loss: 2.9492 - accuracy20: 0.5064 - val_loss: 3.1596 - val_accuracy20: 0.4608 - 249s/epoch - 41ms/step
Epoch 21/50
6147/6147 - 247s - loss: 2.9470 - accuracy20: 0.5069 - val_loss: 3.1320 - val_accuracy20: 0.4667 - 247s/epoch - 40ms/step
Epoch 22/50
6147/6147 - 246s - loss: 2.9449 - accuracy20: 0.5077 - val_loss: 3.1364 - val_accuracy20: 0.4654 - 246s/epoch - 40ms/step
Epoch 23/50
6147/6147 - 248s - loss: 2.9425 - accuracy20: 0.5081 - val_loss: 3.1867 - val_accuracy20: 0.4556 - 248s/epoch - 40ms/step
Epoch 24/50
6147/6147 - 248s - loss: 2.9407 - accuracy20: 0.5087 - val_loss: 3.1631 - val_accuracy20: 0.4584 - 248s/epoch - 40ms/step
Epoch 25/50
6147/6147 - 248s - loss: 2.9390 - accuracy20: 0.5091 - val_loss: 3.1761 - val_accuracy20: 0.4560 - 248s/epoch - 40ms/step
Epoch 26/50
6147/6147 - 247s - loss: 2.9366 - accuracy20: 0.5096 - val_loss: 3.1655 - val_accuracy20: 0.4598 - 247s/epoch - 40ms/step
Epoch 27/50
6147/6147 - 246s - loss: 2.9353 - accuracy20: 0.5099 - val_loss: 3.1445 - val_accuracy20: 0.4656 - 246s/epoch - 40ms/step
Epoch 28/50
6147/6147 - 247s - loss: 2.9333 - accuracy20: 0.5106 - val_loss: 3.1381 - val_accuracy20: 0.4651 - 247s/epoch - 40ms/step
Epoch 29/50
6147/6147 - 247s - loss: 2.9316 - accuracy20: 0.5108 - val_loss: 3.1604 - val_accuracy20: 0.4602 - 247s/epoch - 40ms/step
Epoch 30/50
6147/6147 - 248s - loss: 2.9299 - accuracy20: 0.5115 - val_loss: 3.1690 - val_accuracy20: 0.4582 - 248s/epoch - 40ms/step
Epoch 31/50
6147/6147 - 247s - loss: 2.9282 - accuracy20: 0.5120 - val_loss: 3.1702 - val_accuracy20: 0.4581 - 247s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h20
Evaluating performance on  test set...
14883/14883 - 201s - 201s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0421226
{'0': {'precision': 0.44942275103507073, 'recall': 0.5283005416554064, 'f1-score': 0.4856799149189448, 'support': 1206302}, '1': {'precision': 0.45952084588607056, 'recall': 0.360326875796084, 'f1-score': 0.4039230856714978, 'support': 1350360}, '2': {'precision': 0.46734542923030065, 'recall': 0.49709512247084947, 'f1-score': 0.4817614376949492, 'support': 1253237}, 'accuracy': 0.45850008097327516, 'macro avg': {'precision': 0.45876300871714726, 'recall': 0.4619075133074466, 'f1-score': 0.45712147942846393, 'support': 3809899}, 'weighted avg': {'precision': 0.4588973924406176, 'recall': 0.45850008097327516, 'f1-score': 0.45541351347802705, 'support': 3809899}}
[[637290 272223 296789]
 [450542 486571 413247]
 [330187 300072 622978]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0664598
{'0': {'precision': 0.4677300719402862, 'recall': 0.47820048228087775, 'f1-score': 0.4729073291501259, 'support': 521273}, '1': {'precision': 0.44060347789521187, 'recall': 0.3282013083130402, 'f1-score': 0.37618558179296635, 'support': 523575}, '2': {'precision': 0.44821893297383547, 'recall': 0.5515750883876838, 'f1-score': 0.4945546628402593, 'support': 528637}, 'accuracy': 0.4529398119460942, 'macro avg': {'precision': 0.45218416093644453, 'recall': 0.4526589596605339, 'f1-score': 0.4478825245944505, 'support': 1573485}, 'weighted avg': {'precision': 0.4521486609659474, 'recall': 0.4529398119460942, 'f1-score': 0.4479960606394163, 'support': 1573485}}
[[249273 110667 161333]
 [154116 171838 197621]
 [129553 107501 291583]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.043709
{'0': {'precision': 0.4665820418308707, 'recall': 0.4814276946009338, 'f1-score': 0.4738886281617659, 'support': 182476}, '1': {'precision': 0.4891906783781156, 'recall': 0.3237538544040756, 'f1-score': 0.3896388038220384, 'support': 186475}, '2': {'precision': 0.453927535639884, 'recall': 0.5925045187227077, 'f1-score': 0.5140402855933556, 'support': 187553}, 'accuracy': 0.46602899529922515, 'macro avg': {'precision': 0.46990008528295674, 'recall': 0.465895355909239, 'f1-score': 0.45918923919238663, 'support': 556504}, 'weighted avg': {'precision': 0.46989298820413905, 'recall': 0.46602899529922515, 'f1-score': 0.4591898619579583, 'support': 556504}}
[[ 87849  31577  63050]
 [ 55469  60372  70634]
 [ 44964  31463 111126]]
training model: results/AAPL/W2/deepLOB_L2/h30
Epoch 1/50
6147/6147 - 254s - loss: 3.1841 - accuracy30: 0.4269 - val_loss: 3.4157 - val_accuracy30: 0.3560 - 254s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.1396 - accuracy30: 0.4465 - val_loss: 3.3317 - val_accuracy30: 0.3516 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 248s - loss: 3.1139 - accuracy30: 0.4569 - val_loss: 3.3066 - val_accuracy30: 0.3761 - 248s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 247s - loss: 3.0981 - accuracy30: 0.4627 - val_loss: 3.3167 - val_accuracy30: 0.4178 - 247s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 247s - loss: 3.0883 - accuracy30: 0.4663 - val_loss: 3.3706 - val_accuracy30: 0.4079 - 247s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 247s - loss: 3.0806 - accuracy30: 0.4685 - val_loss: 3.3674 - val_accuracy30: 0.4128 - 247s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 248s - loss: 3.0735 - accuracy30: 0.4708 - val_loss: 3.3806 - val_accuracy30: 0.4099 - 248s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.0678 - accuracy30: 0.4729 - val_loss: 3.3506 - val_accuracy30: 0.4170 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 248s - loss: 3.0631 - accuracy30: 0.4741 - val_loss: 3.4771 - val_accuracy30: 0.4007 - 248s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.0582 - accuracy30: 0.4757 - val_loss: 3.3353 - val_accuracy30: 0.4130 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 247s - loss: 3.0544 - accuracy30: 0.4766 - val_loss: 3.3947 - val_accuracy30: 0.4078 - 247s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 248s - loss: 3.0498 - accuracy30: 0.4784 - val_loss: 3.3217 - val_accuracy30: 0.4189 - 248s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 248s - loss: 3.0461 - accuracy30: 0.4794 - val_loss: 3.3381 - val_accuracy30: 0.4177 - 248s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h30
Evaluating performance on  test set...
14883/14883 - 200s - 200s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092803
{'0': {'precision': 0.3807864439787617, 'recall': 0.3803927303894143, 'f1-score': 0.3805894853615503, 'support': 1176074}, '1': {'precision': 0.3653027171499361, 'recall': 0.4532334663895907, 'f1-score': 0.4045451382722082, 'support': 1404669}, '2': {'precision': 0.4496541923365301, 'recall': 0.3264093410437731, 'f1-score': 0.3782456520765621, 'support': 1229156}, 'accuracy': 0.38983211890918895, 'macro avg': {'precision': 0.39858111782174266, 'recall': 0.38667851260759273, 'f1-score': 0.38779342523677357, 'support': 3809899}, 'weighted avg': {'precision': 0.39729598793767545, 'recall': 0.38983211890918895, 'f1-score': 0.3886655068710754, 'support': 3809899}}
[[447370 539155 189549]
 [466524 636643 301502]
 [260964 566984 401208]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.114907
{'0': {'precision': 0.41075732818156374, 'recall': 0.26138208891203774, 'f1-score': 0.31947124583253855, 'support': 522224}, '1': {'precision': 0.3405855848216052, 'recall': 0.580525485041619, 'f1-score': 0.4293046046143058, 'support': 518873}, '2': {'precision': 0.4487368152552017, 'recall': 0.3007017438409581, 'f1-score': 0.36009874654865065, 'support': 532388}, 'accuracy': 0.37992672316545756, 'macro avg': {'precision': 0.4000265760861235, 'recall': 0.3808697725982049, 'f1-score': 0.369624865665165, 'support': 1573485}, 'weighted avg': {'precision': 0.40046781170809764, 'recall': 0.37992672316545756, 'f1-score': 0.369436233247367, 'support': 1573485}}
[[136500 296575  89149]
 [110136 301219 107518]
 [ 85677 286621 160090]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1024958
{'0': {'precision': 0.39733576726667746, 'recall': 0.18942156225558773, 'f1-score': 0.25654204213164644, 'support': 181558}, '1': {'precision': 0.34041717853569575, 'recall': 0.5705067999596725, 'f1-score': 0.4264029046605842, 'support': 188457}, '2': {'precision': 0.4385909132200838, 'recall': 0.36245033219117484, 'f1-score': 0.3969019650443478, 'support': 186489}, 'accuracy': 0.3764573120768224, 'macro avg': {'precision': 0.39211461967415234, 'recall': 0.37412623146881163, 'f1-score': 0.35994897061219283, 'support': 556504}, 'weighted avg': {'precision': 0.39188553588870023, 'recall': 0.3764573120768224, 'f1-score': 0.36110023081255943, 'support': 556504}}
[[ 34391 107947  39220]
 [ 33640 107516  47301]
 [ 18523 100373  67593]]
training model: results/AAPL/W2/deepLOB_L2/h50
Epoch 1/50
6147/6147 - 258s - loss: 3.1879 - accuracy50: 0.4292 - val_loss: 3.5377 - val_accuracy50: 0.3523 - 258s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.1584 - accuracy50: 0.4412 - val_loss: 3.4724 - val_accuracy50: 0.3562 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 246s - loss: 3.1431 - accuracy50: 0.4476 - val_loss: 3.4616 - val_accuracy50: 0.3575 - 246s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 247s - loss: 3.1325 - accuracy50: 0.4524 - val_loss: 3.5888 - val_accuracy50: 0.3580 - 247s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 247s - loss: 3.1256 - accuracy50: 0.4554 - val_loss: 3.5144 - val_accuracy50: 0.3566 - 247s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 247s - loss: 3.1190 - accuracy50: 0.4583 - val_loss: 3.5014 - val_accuracy50: 0.3580 - 247s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 248s - loss: 3.1139 - accuracy50: 0.4603 - val_loss: 3.4913 - val_accuracy50: 0.3563 - 248s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.1096 - accuracy50: 0.4619 - val_loss: 3.4731 - val_accuracy50: 0.3580 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 246s - loss: 3.1061 - accuracy50: 0.4632 - val_loss: 3.4784 - val_accuracy50: 0.3547 - 246s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1025 - accuracy50: 0.4645 - val_loss: 3.4998 - val_accuracy50: 0.3436 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 248s - loss: 3.0992 - accuracy50: 0.4657 - val_loss: 3.4078 - val_accuracy50: 0.3590 - 248s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 246s - loss: 3.0967 - accuracy50: 0.4666 - val_loss: 3.4666 - val_accuracy50: 0.3523 - 246s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 246s - loss: 3.0944 - accuracy50: 0.4676 - val_loss: 3.4478 - val_accuracy50: 0.3583 - 246s/epoch - 40ms/step
Epoch 14/50
6147/6147 - 246s - loss: 3.0920 - accuracy50: 0.4684 - val_loss: 3.4020 - val_accuracy50: 0.3672 - 246s/epoch - 40ms/step
Epoch 15/50
6147/6147 - 248s - loss: 3.0898 - accuracy50: 0.4690 - val_loss: 3.3971 - val_accuracy50: 0.3610 - 248s/epoch - 40ms/step
Epoch 16/50
6147/6147 - 246s - loss: 3.0881 - accuracy50: 0.4697 - val_loss: 3.3671 - val_accuracy50: 0.3733 - 246s/epoch - 40ms/step
Epoch 17/50
6147/6147 - 251s - loss: 3.0856 - accuracy50: 0.4703 - val_loss: 3.3780 - val_accuracy50: 0.3818 - 251s/epoch - 41ms/step
Epoch 18/50
6147/6147 - 247s - loss: 3.0842 - accuracy50: 0.4707 - val_loss: 3.3824 - val_accuracy50: 0.3726 - 247s/epoch - 40ms/step
Epoch 19/50
6147/6147 - 247s - loss: 3.0828 - accuracy50: 0.4714 - val_loss: 3.3177 - val_accuracy50: 0.3901 - 247s/epoch - 40ms/step
Epoch 20/50
6147/6147 - 246s - loss: 3.0808 - accuracy50: 0.4720 - val_loss: 3.2886 - val_accuracy50: 0.4013 - 246s/epoch - 40ms/step
Epoch 21/50
6147/6147 - 246s - loss: 3.0794 - accuracy50: 0.4722 - val_loss: 3.2994 - val_accuracy50: 0.3947 - 246s/epoch - 40ms/step
Epoch 22/50
6147/6147 - 247s - loss: 3.0778 - accuracy50: 0.4729 - val_loss: 3.2827 - val_accuracy50: 0.4043 - 247s/epoch - 40ms/step
Epoch 23/50
6147/6147 - 245s - loss: 3.0760 - accuracy50: 0.4736 - val_loss: 3.2569 - val_accuracy50: 0.4098 - 245s/epoch - 40ms/step
Epoch 24/50
6147/6147 - 248s - loss: 3.0746 - accuracy50: 0.4739 - val_loss: 3.2538 - val_accuracy50: 0.4108 - 248s/epoch - 40ms/step
Epoch 25/50
6147/6147 - 250s - loss: 3.0733 - accuracy50: 0.4744 - val_loss: 3.2919 - val_accuracy50: 0.4058 - 250s/epoch - 41ms/step
Epoch 26/50
6147/6147 - 246s - loss: 3.0721 - accuracy50: 0.4747 - val_loss: 3.2664 - val_accuracy50: 0.4085 - 246s/epoch - 40ms/step
Epoch 27/50
6147/6147 - 245s - loss: 3.0700 - accuracy50: 0.4749 - val_loss: 3.2961 - val_accuracy50: 0.4039 - 245s/epoch - 40ms/step
Epoch 28/50
6147/6147 - 248s - loss: 3.0687 - accuracy50: 0.4756 - val_loss: 3.3179 - val_accuracy50: 0.4038 - 248s/epoch - 40ms/step
Epoch 29/50
6147/6147 - 245s - loss: 3.0675 - accuracy50: 0.4760 - val_loss: 3.2706 - val_accuracy50: 0.4100 - 245s/epoch - 40ms/step
Epoch 30/50
6147/6147 - 246s - loss: 3.0665 - accuracy50: 0.4761 - val_loss: 3.2737 - val_accuracy50: 0.4109 - 246s/epoch - 40ms/step
Epoch 31/50
6147/6147 - 246s - loss: 3.0646 - accuracy50: 0.4769 - val_loss: 3.3093 - val_accuracy50: 0.4094 - 246s/epoch - 40ms/step
Epoch 32/50
6147/6147 - 247s - loss: 3.0632 - accuracy50: 0.4773 - val_loss: 3.3162 - val_accuracy50: 0.4086 - 247s/epoch - 40ms/step
Epoch 33/50
6147/6147 - 247s - loss: 3.0619 - accuracy50: 0.4776 - val_loss: 3.3359 - val_accuracy50: 0.4090 - 247s/epoch - 40ms/step
Epoch 34/50
6147/6147 - 246s - loss: 3.0608 - accuracy50: 0.4777 - val_loss: 3.2949 - val_accuracy50: 0.4163 - 246s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h50
Evaluating performance on  test set...
14883/14883 - 201s - 201s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759715
{'0': {'precision': 0.29788056821479836, 'recall': 0.3917165390717028, 'f1-score': 0.33841425378640705, 'support': 969474}, '1': {'precision': 0.519922362859892, 'recall': 0.5082716307591465, 'f1-score': 0.514030988079977, 'support': 1855136}, '2': {'precision': 0.35125522548595633, 'recall': 0.25720169412223215, 'f1-score': 0.2969591967906311, 'support': 985289}, 'accuracy': 0.4136828824071189, 'macro avg': {'precision': 0.3896860521868823, 'recall': 0.3857299546510271, 'f1-score': 0.38313481288567175, 'support': 3809899}, 'weighted avg': {'precision': 0.4198016977352299, 'recall': 0.4136828824071189, 'f1-score': 0.4132056627812715, 'support': 3809899}}
[[379759 433924 155791]
 [599968 942913 312255]
 [295143 436728 253418]]
Evaluating performance on  train set...
6147/6147 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1276499
{'0': {'precision': 0.38863362714630045, 'recall': 0.3410256114177502, 'f1-score': 0.36327648115821404, 'support': 519612}, '1': {'precision': 0.36412541973956375, 'recall': 0.5849861956634745, 'f1-score': 0.4488583651931384, 'support': 519402}, '2': {'precision': 0.44641090857708066, 'recall': 0.23643939521508184, 'f1-score': 0.30914279353826246, 'support': 534471}, 'accuracy': 0.38603100760413983, 'macro avg': {'precision': 0.3997233184876483, 'recall': 0.38748373409876885, 'f1-score': 0.37375921329653833, 'support': 1573485}, 'weighted avg': {'precision': 0.4001689576007482, 'recall': 0.38603100760413983, 'f1-score': 0.37313899371828585, 'support': 1573485}}
[[177201 260287  82124]
 [140973 303843  74586]
 [137785 270316 126370]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0852933
{'0': {'precision': 0.38102417695723434, 'recall': 0.4448065589407583, 'f1-score': 0.41045227710322607, 'support': 176126}, '1': {'precision': 0.4322520316152733, 'recall': 0.48599922899383696, 'f1-score': 0.4575526614724002, 'support': 199739}, '2': {'precision': 0.41770899303356557, 'recall': 0.29210192704786897, 'f1-score': 0.3437918419072254, 'support': 180639}, 'accuracy': 0.4100240070152236, 'macro avg': {'precision': 0.41032840053535774, 'recall': 0.4076359049941547, 'f1-score': 0.4039322601609506, 'support': 556504}, 'weighted avg': {'precision': 0.4113184946130903, 'recall': 0.4100240070152236, 'f1-score': 0.4057197133123892, 'support': 556504}}
[[78342 62532 35252]
 [64363 97073 38303]
 [62904 64970 52765]]
training model: results/AAPL/W2/deepLOB_L2/h100
Epoch 1/50
6147/6147 - 253s - loss: 3.2312 - accuracy100: 0.4042 - val_loss: 3.4202 - val_accuracy100: 0.3276 - 253s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 247s - loss: 3.2145 - accuracy100: 0.4147 - val_loss: 3.5092 - val_accuracy100: 0.3187 - 247s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 249s - loss: 3.2028 - accuracy100: 0.4218 - val_loss: 3.5812 - val_accuracy100: 0.3149 - 249s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 248s - loss: 3.1957 - accuracy100: 0.4254 - val_loss: 3.5168 - val_accuracy100: 0.3206 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 248s - loss: 3.1903 - accuracy100: 0.4275 - val_loss: 3.5807 - val_accuracy100: 0.3298 - 248s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 248s - loss: 3.1860 - accuracy100: 0.4293 - val_loss: 3.4943 - val_accuracy100: 0.3286 - 248s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 248s - loss: 3.1820 - accuracy100: 0.4308 - val_loss: 3.5615 - val_accuracy100: 0.3240 - 248s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.1796 - accuracy100: 0.4318 - val_loss: 3.6077 - val_accuracy100: 0.3245 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 247s - loss: 3.1767 - accuracy100: 0.4331 - val_loss: 3.6176 - val_accuracy100: 0.3158 - 247s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1739 - accuracy100: 0.4346 - val_loss: 3.6361 - val_accuracy100: 0.3205 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 247s - loss: 3.1713 - accuracy100: 0.4355 - val_loss: 3.6446 - val_accuracy100: 0.3192 - 247s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h100
Evaluating performance on  test set...
14883/14883 - 207s - 207s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186846
{'0': {'precision': 0.36365118425777626, 'recall': 0.13992331877299866, 'f1-score': 0.20208839117483943, 'support': 1179689}, '1': {'precision': 0.3755762746031235, 'recall': 0.893967796544002, 'f1-score': 0.5289349180887938, 'support': 1408855}, '2': {'precision': 0.32588235294117646, 'recall': 0.0006803918598605647, 'f1-score': 0.0013579485335871657, 'support': 1221355}, 'accuracy': 0.37412225363454515, 'macro avg': {'precision': 0.3550366039340254, 'recall': 0.34485716905895375, 'f1-score': 0.2441270859324068, 'support': 3809899}, 'weighted avg': {'precision': 0.35595323010881025, 'recall': 0.37412225363454515, 'f1-score': 0.2586033365587597, 'support': 3809899}}
[[ 165066 1013815     808]
 [ 148473 1259471     911]
 [ 140374 1080150     831]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1419579
{'0': {'precision': 0.3693564727128573, 'recall': 0.09695882338204433, 'f1-score': 0.15359723046911372, 'support': 518911}, '1': {'precision': 0.33078710163531844, 'recall': 0.9131998212648593, 'f1-score': 0.4856557838821161, 'support': 519204}, '2': {'precision': 0.2933196826209368, 'recall': 0.0021405756766348506, 'f1-score': 0.004250134902842139, 'support': 535370}, 'accuracy': 0.3340330540170386, 'macro avg': {'precision': 0.33115441898970416, 'recall': 0.3374330734411795, 'f1-score': 0.2145010497513573, 'support': 1573485}, 'weighted avg': {'precision': 0.33075859090753096, 'recall': 0.3340330540170386, 'f1-score': 0.21235227078594526, 'support': 1573485}}
[[ 50313 467336   1262]
 [ 43568 474137   1499]
 [ 42337 491887   1146]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1424336
{'0': {'precision': 0.37806838106370544, 'recall': 0.055884925648751096, 'f1-score': 0.09737602197781521, 'support': 185202}, '1': {'precision': 0.32518062952523497, 'recall': 0.9445271984993932, 'f1-score': 0.4837994099628119, 'support': 181260}, '2': {'precision': 0.22230652503793627, 'recall': 0.0030835289041369804, 'f1-score': 0.006082687177570869, 'support': 190042}, 'accuracy': 0.3272950419044607, 'macro avg': {'precision': 0.30851851187562557, 'recall': 0.33449855101742704, 'f1-score': 0.19575270637273268, 'support': 556504}, 'weighted avg': {'precision': 0.3076506868751419, 'recall': 0.3272950419044607, 'f1-score': 0.19206273649209088, 'support': 556504}}
[[ 10350 174207    645]
 [  8650 171205   1405]
 [  8376 181080    586]]
training model: results/AAPL/W2/deepLOB_L2/h200
Epoch 1/50
6147/6147 - 253s - loss: 3.2322 - accuracy200: 0.4046 - val_loss: 3.5627 - val_accuracy200: 0.3517 - 253s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.2121 - accuracy200: 0.4165 - val_loss: 3.5159 - val_accuracy200: 0.3510 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 248s - loss: 3.2019 - accuracy200: 0.4230 - val_loss: 3.6419 - val_accuracy200: 0.3525 - 248s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 248s - loss: 3.1943 - accuracy200: 0.4270 - val_loss: 3.7052 - val_accuracy200: 0.3555 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 247s - loss: 3.1883 - accuracy200: 0.4304 - val_loss: 3.7506 - val_accuracy200: 0.3535 - 247s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 246s - loss: 3.1840 - accuracy200: 0.4322 - val_loss: 3.8002 - val_accuracy200: 0.3539 - 246s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 247s - loss: 3.1802 - accuracy200: 0.4340 - val_loss: 3.8269 - val_accuracy200: 0.3532 - 247s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 249s - loss: 3.1780 - accuracy200: 0.4351 - val_loss: 3.8163 - val_accuracy200: 0.3545 - 249s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 248s - loss: 3.1743 - accuracy200: 0.4366 - val_loss: 3.7906 - val_accuracy200: 0.3534 - 248s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1719 - accuracy200: 0.4378 - val_loss: 3.8983 - val_accuracy200: 0.3546 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 246s - loss: 3.1687 - accuracy200: 0.4390 - val_loss: 3.9342 - val_accuracy200: 0.3474 - 246s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 247s - loss: 3.1665 - accuracy200: 0.4394 - val_loss: 4.0092 - val_accuracy200: 0.3478 - 247s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h200
Evaluating performance on  test set...
14883/14883 - 199s - 199s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1218324
{'0': {'precision': 0.2718384273035648, 'recall': 0.02867127044271465, 'f1-score': 0.0518715577193996, 'support': 1092871}, '1': {'precision': 0.41940105954761614, 'recall': 0.9677761902440427, 'f1-score': 0.5851975436509894, 'support': 1599966}, '2': {'precision': 0.3269876819708847, 'recall': 0.0007841999817378086, 'f1-score': 0.0015646475390291147, 'support': 1117062}, 'accuracy': 0.41487162783055404, 'macro avg': {'precision': 0.3394090562740219, 'recall': 0.33241055355616506, 'f1-score': 0.21287791630313935, 'support': 3809899}, 'weighted avg': {'precision': 0.3499770685584042, 'recall': 0.41487162783055404, 'f1-score': 0.2610916726639472, 'support': 3809899}}
[[  31334 1060732     805]
 [  50559 1548409     998]
 [  33374 1082812     876]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1890837
{'0': {'precision': 0.31866124076073415, 'recall': 0.022193687206094152, 'f1-score': 0.04149723135490569, 'support': 518661}, '1': {'precision': 0.32993254846004527, 'recall': 0.975816699011182, 'f1-score': 0.4931324922578179, 'support': 519408}, '2': {'precision': 0.3702090592334495, 'recall': 0.0007937753074245073, 'f1-score': 0.0015841539872224002, 'support': 535416}, 'accuracy': 0.32970317479988687, 'macro avg': {'precision': 0.33960094948474295, 'recall': 0.33293472050823353, 'f1-score': 0.17873795919998203, 'support': 1573485}, 'weighted avg': {'precision': 0.33992228498096577, 'recall': 0.32970317479988687, 'f1-score': 0.17700082202349443, 'support': 1573485}}
[[ 11511 506751    399]
 [ 12237 506847    324]
 [ 12375 522616    425]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1744568
{'0': {'precision': 0.2944389275074479, 'recall': 0.016700744070250146, 'f1-score': 0.031608628675902285, 'support': 177537}, '1': {'precision': 0.35210986386084203, 'recall': 0.9793902153200249, 'f1-score': 0.5179916408193183, 'support': 196266}, '2': {'precision': 0.2624521072796935, 'recall': 0.0007498590593373873, 'f1-score': 0.001495445440801646, 'support': 182701}, 'accuracy': 0.35098220318272644, 'macro avg': {'precision': 0.3030002995493278, 'recall': 0.33228027281653744, 'f1-score': 0.18369857164534073, 'support': 556504}, 'weighted avg': {'precision': 0.3042768081909727, 'recall': 0.35098220318272644, 'f1-score': 0.1932583914289167, 'support': 556504}}
[[  2965 174441    131]
 [  3791 192221    254]
 [  3314 179250    137]]
training model: results/AAPL/W2/deepLOB_L2/h300
Epoch 1/50
6147/6147 - 252s - loss: 3.2123 - accuracy300: 0.4175 - val_loss: 3.3930 - val_accuracy300: 0.3311 - 252s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 246s - loss: 3.1857 - accuracy300: 0.4302 - val_loss: 3.4194 - val_accuracy300: 0.3335 - 246s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 246s - loss: 3.1758 - accuracy300: 0.4351 - val_loss: 3.4410 - val_accuracy300: 0.3309 - 246s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 246s - loss: 3.1702 - accuracy300: 0.4378 - val_loss: 3.4951 - val_accuracy300: 0.3301 - 246s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 248s - loss: 3.1642 - accuracy300: 0.4405 - val_loss: 3.5121 - val_accuracy300: 0.3311 - 248s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 246s - loss: 3.1590 - accuracy300: 0.4428 - val_loss: 3.5627 - val_accuracy300: 0.3305 - 246s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 245s - loss: 3.1534 - accuracy300: 0.4451 - val_loss: 3.5764 - val_accuracy300: 0.3311 - 245s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 246s - loss: 3.1483 - accuracy300: 0.4469 - val_loss: 3.6135 - val_accuracy300: 0.3296 - 246s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 247s - loss: 3.1437 - accuracy300: 0.4488 - val_loss: 3.6653 - val_accuracy300: 0.3291 - 247s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1391 - accuracy300: 0.4502 - val_loss: 3.6878 - val_accuracy300: 0.3267 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 249s - loss: 3.1361 - accuracy300: 0.4515 - val_loss: 3.6576 - val_accuracy300: 0.3270 - 249s/epoch - 41ms/step
testing model: results/AAPL/W2/deepLOB_L2/h300
Evaluating performance on  test set...
14883/14883 - 203s - 203s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1238724
{'0': {'precision': 0.3225075174939813, 'recall': 0.028571807954428513, 'f1-score': 0.05249311016493674, 'support': 1204964}, '1': {'precision': 0.3601317913359922, 'recall': 0.9739945050751736, 'f1-score': 0.525836851889819, 'support': 1362712}, '2': {'precision': 0.3539290780141844, 'recall': 0.005021642651923205, 'f1-score': 0.009902781922898634, 'support': 1242223}, 'accuracy': 0.3590488881726261, 'macro avg': {'precision': 0.3455227956147193, 'recall': 0.33586265189384173, 'f1-score': 0.1960775813258848, 'support': 3809899}, 'weighted avg': {'precision': 0.3462098871971893, 'recall': 0.3590488881726261, 'f1-score': 0.2079104878050234, 'support': 3809899}}
[[  34428 1162924    7612]
 [  31663 1327274    3775]
 [  40660 1195325    6238]]
Evaluating performance on  train set...
6147/6147 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1336554
{'0': {'precision': 0.2951303620878834, 'recall': 0.04346638348300513, 'f1-score': 0.07577302300623784, 'support': 519804}, '1': {'precision': 0.3271695899068841, 'recall': 0.9399911477176507, 'f1-score': 0.4853946451835371, 'support': 519640}, '2': {'precision': 0.31688180207542394, 'recall': 0.002344389288462871, 'f1-score': 0.00465434430251751, 'support': 534041}, 'accuracy': 0.3255849277241283, 'macro avg': {'precision': 0.3130605846900638, 'recall': 0.3286006401630396, 'f1-score': 0.18860733749743083, 'support': 1573485}, 'weighted avg': {'precision': 0.31309368878388094, 'recall': 0.3255849277241283, 'f1-score': 0.18691198489948646, 'support': 1573485}}
[[ 22594 495846   1364]
 [ 29848 488457   1335]
 [ 24114 508675   1252]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1331812
{'0': {'precision': 0.3477448191791955, 'recall': 0.023335460192289863, 'f1-score': 0.043736009894007374, 'support': 183369}, '1': {'precision': 0.33098174079215287, 'recall': 0.9792154598633972, 'f1-score': 0.49473840633152444, 'support': 183598}, '2': {'precision': 0.3339862879529873, 'recall': 0.0017991210159493925, 'f1-score': 0.0035789628354621697, 'support': 189537}, 'accuracy': 0.33135790578324686, 'macro avg': {'precision': 0.3375709493081119, 'recall': 0.3347833470238788, 'f1-score': 0.180684459686998, 'support': 556504}, 'weighted avg': {'precision': 0.337528507349045, 'recall': 0.33135790578324686, 'f1-score': 0.17885074716957014, 'support': 556504}}
[[  4279 178752    338]
 [  3474 179782    342]
 [  4552 184644    341]]
training model: results/AAPL/W2/deepLOB_L2/h500
Epoch 1/50
6147/6147 - 252s - loss: 3.2232 - accuracy500: 0.4136 - val_loss: 3.4467 - val_accuracy500: 0.3248 - 252s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.1790 - accuracy500: 0.4346 - val_loss: 3.4814 - val_accuracy500: 0.3224 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 249s - loss: 3.1672 - accuracy500: 0.4400 - val_loss: 3.4625 - val_accuracy500: 0.3151 - 249s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 247s - loss: 3.1586 - accuracy500: 0.4433 - val_loss: 3.5121 - val_accuracy500: 0.3128 - 247s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 249s - loss: 3.1503 - accuracy500: 0.4466 - val_loss: 3.4810 - val_accuracy500: 0.3178 - 249s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 246s - loss: 3.1440 - accuracy500: 0.4483 - val_loss: 3.4289 - val_accuracy500: 0.3271 - 246s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 247s - loss: 3.1374 - accuracy500: 0.4514 - val_loss: 3.4488 - val_accuracy500: 0.3286 - 247s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 248s - loss: 3.1306 - accuracy500: 0.4532 - val_loss: 3.4461 - val_accuracy500: 0.3286 - 248s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 249s - loss: 3.1257 - accuracy500: 0.4549 - val_loss: 3.5116 - val_accuracy500: 0.3422 - 249s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1219 - accuracy500: 0.4565 - val_loss: 3.4913 - val_accuracy500: 0.3353 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 248s - loss: 3.1173 - accuracy500: 0.4583 - val_loss: 3.5194 - val_accuracy500: 0.3419 - 248s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 248s - loss: 3.1138 - accuracy500: 0.4595 - val_loss: 3.5484 - val_accuracy500: 0.3476 - 248s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 248s - loss: 3.1102 - accuracy500: 0.4608 - val_loss: 3.6419 - val_accuracy500: 0.3535 - 248s/epoch - 40ms/step
Epoch 14/50
6147/6147 - 250s - loss: 3.1057 - accuracy500: 0.4624 - val_loss: 3.7391 - val_accuracy500: 0.3608 - 250s/epoch - 41ms/step
Epoch 15/50
6147/6147 - 248s - loss: 3.1034 - accuracy500: 0.4633 - val_loss: 3.7438 - val_accuracy500: 0.3589 - 248s/epoch - 40ms/step
Epoch 16/50
6147/6147 - 249s - loss: 3.1000 - accuracy500: 0.4643 - val_loss: 3.7599 - val_accuracy500: 0.3548 - 249s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h500
Evaluating performance on  test set...
14883/14883 - 204s - 204s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.126014
{'0': {'precision': 0.2992534367036359, 'recall': 0.12918489774099665, 'f1-score': 0.18046482544244397, 'support': 1161707}, '1': {'precision': 0.3860815227488935, 'recall': 0.855432674531602, 'f1-score': 0.5320386191567688, 'support': 1455066}, '2': {'precision': 0.3456455318443429, 'recall': 0.024462630099419506, 'f1-score': 0.045691501352569885, 'support': 1193126}, 'accuracy': 0.373756102195885, 'macro avg': {'precision': 0.3436601637656241, 'recall': 0.3363600674573393, 'f1-score': 0.25273164865059417, 'support': 3809899}, 'weighted avg': {'precision': 0.346942945206717, 'recall': 0.373756102195885, 'f1-score': 0.27253065622868594, 'support': 3809899}}
[[ 150075  980958   30674]
 [ 185774 1244711   24581]
 [ 165649  998290   29187]]
Evaluating performance on  train set...
6147/6147 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1473488
{'0': {'precision': 0.3032261710862316, 'recall': 0.11366258298489468, 'f1-score': 0.16534612410485144, 'support': 519221}, '1': {'precision': 0.3242472216794807, 'recall': 0.8403699189574801, 'f1-score': 0.4679436733276008, 'support': 519357}, '2': {'precision': 0.30809789399896376, 'recall': 0.018898612282135026, 'f1-score': 0.035612751401223844, 'support': 534907}, 'accuracy': 0.32131033978716034, 'macro avg': {'precision': 0.3118570955882254, 'recall': 0.32431037140816993, 'f1-score': 0.22296751627789205, 'support': 1573485}, 'weighted avg': {'precision': 0.31182069118717876, 'recall': 0.32131033978716034, 'f1-score': 0.22112095905968107, 'support': 1573485}}
[[ 59016 449501  10704]
 [ 70907 436452  11998]
 [ 64704 460094  10109]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1456645
{'0': {'precision': 0.32357214984114474, 'recall': 0.07126854539043641, 'f1-score': 0.11680921813041235, 'support': 184345}, '1': {'precision': 0.3274356595108573, 'recall': 0.9219051196085037, 'f1-score': 0.48323822593580174, 'support': 181049}, '2': {'precision': 0.32070871261378414, 'recall': 0.01032389723196065, 'f1-score': 0.02000385274406627, 'support': 191110}, 'accuracy': 0.32707941003119473, 'macro avg': {'precision': 0.32390550732192874, 'recall': 0.33449918741030027, 'f1-score': 0.2066837656034268, 'support': 556504}, 'weighted avg': {'precision': 0.32384573830352936, 'recall': 0.32707941003119473, 'f1-score': 0.20277649249892246, 'support': 556504}}
[[ 13138 169161   2046]
 [ 12006 166910   2133]
 [ 15459 173678   1973]]
training model: results/AAPL/W2/deepLOB_L2/h1000
Epoch 1/50
6147/6147 - 251s - loss: 3.1560 - accuracy1000: 0.4457 - val_loss: 3.4159 - val_accuracy1000: 0.3333 - 251s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 251s - loss: 3.0989 - accuracy1000: 0.4684 - val_loss: 3.4693 - val_accuracy1000: 0.3458 - 251s/epoch - 41ms/step
Epoch 3/50
6147/6147 - 250s - loss: 3.0739 - accuracy1000: 0.4764 - val_loss: 3.6900 - val_accuracy1000: 0.3374 - 250s/epoch - 41ms/step
Epoch 4/50
6147/6147 - 248s - loss: 3.0557 - accuracy1000: 0.4815 - val_loss: 3.5476 - val_accuracy1000: 0.3257 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 249s - loss: 3.0439 - accuracy1000: 0.4853 - val_loss: 3.6746 - val_accuracy1000: 0.3350 - 249s/epoch - 41ms/step
Epoch 6/50
6147/6147 - 250s - loss: 3.0349 - accuracy1000: 0.4880 - val_loss: 3.6989 - val_accuracy1000: 0.3351 - 250s/epoch - 41ms/step
Epoch 7/50
6147/6147 - 249s - loss: 3.0248 - accuracy1000: 0.4903 - val_loss: 3.5657 - val_accuracy1000: 0.3346 - 249s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 250s - loss: 3.0218 - accuracy1000: 0.4915 - val_loss: 3.5824 - val_accuracy1000: 0.3522 - 250s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 249s - loss: 3.0181 - accuracy1000: 0.4928 - val_loss: 3.5934 - val_accuracy1000: 0.3402 - 249s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 249s - loss: 3.0146 - accuracy1000: 0.4935 - val_loss: 3.5709 - val_accuracy1000: 0.3367 - 249s/epoch - 41ms/step
Epoch 11/50
6147/6147 - 249s - loss: 3.0098 - accuracy1000: 0.4949 - val_loss: 3.6269 - val_accuracy1000: 0.3398 - 249s/epoch - 40ms/step
testing model: results/AAPL/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
14883/14883 - 203s - 203s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1316694
{'0': {'precision': 0.2940165370673002, 'recall': 0.1925102340089935, 'f1-score': 0.23267452365725655, 'support': 1190638}, '1': {'precision': 0.3689594996983399, 'recall': 0.7393595354682151, 'f1-score': 0.4922657026504196, 'support': 1384620}, '2': {'precision': 0.33191484368583063, 'recall': 0.0687333402989209, 'f1-score': 0.1138835357965312, 'support': 1234641}, 'accuracy': 0.35113870472681824, 'macro avg': {'precision': 0.33163029348382356, 'recall': 0.3335343699253765, 'f1-score': 0.27960792070140245, 'support': 3809899}, 'weighted avg': {'precision': 0.33353420619711155, 'recall': 0.35113870472681824, 'f1-score': 0.2885213884203801, 'support': 3809899}}
[[ 229210  871148   90280]
 [ 280358 1023732   80530]
 [ 270014  879766   84861]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1443406
{'0': {'precision': 0.29616758883746175, 'recall': 0.15254635426676683, 'f1-score': 0.20137232917961365, 'support': 515109}, '1': {'precision': 0.31869846926448026, 'recall': 0.7154321176948611, 'f1-score': 0.4409638853104772, 'support': 521756}, '2': {'precision': 0.3276942630494806, 'recall': 0.08360105847713466, 'f1-score': 0.13321613844833574, 'support': 536620}, 'accuracy': 0.3156820687836236, 'macro avg': {'precision': 0.3141867737171409, 'recall': 0.31719317681292086, 'f1-score': 0.2585174509794755, 'support': 1573485}, 'weighted avg': {'precision': 0.3143904927505801, 'recall': 0.3156820687836236, 'f1-score': 0.25757518900375975, 'support': 1573485}}
[[ 78578 391048  45483]
 [101918 373281  46557]
 [ 84820 406938  44862]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1389668
{'0': {'precision': 0.31620578641025093, 'recall': 0.08145499681451701, 'f1-score': 0.12954026351761516, 'support': 182076}, '1': {'precision': 0.3352937708204357, 'recall': 0.8610882779207857, 'f1-score': 0.48265106621603193, 'support': 184916}, '2': {'precision': 0.34315844066038553, 'recall': 0.06284562455147959, 'f1-score': 0.1062354216190421, 'support': 189512}, 'accuracy': 0.33417549559392207, 'macro avg': {'precision': 0.3315526659636907, 'recall': 0.3351296330955941, 'f1-score': 0.23947558378422973, 'support': 556504}, 'weighted avg': {'precision': 0.3317268341249937, 'recall': 0.33417549559392207, 'f1-score': 0.23893622472166415, 'support': 556504}}
[[ 14831 155380  11865]
 [ 14755 159229  10932]
 [ 17317 160285  11910]]
training model: results/AAPL/W2/deepOF_L2/h10
Epoch 1/50
6147/6147 - 192s - loss: 3.0220 - accuracy10: 0.4828 - val_loss: 3.1984 - val_accuracy10: 0.4687 - 192s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 173s - loss: 2.9436 - accuracy10: 0.5048 - val_loss: 3.1573 - val_accuracy10: 0.4785 - 173s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 183s - loss: 2.9154 - accuracy10: 0.5123 - val_loss: 3.1575 - val_accuracy10: 0.4831 - 183s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 204s - loss: 2.8987 - accuracy10: 0.5164 - val_loss: 3.1703 - val_accuracy10: 0.4859 - 204s/epoch - 33ms/step
Epoch 5/50
6147/6147 - 205s - loss: 2.8863 - accuracy10: 0.5196 - val_loss: 3.1639 - val_accuracy10: 0.4906 - 205s/epoch - 33ms/step
Epoch 6/50
6147/6147 - 203s - loss: 2.8771 - accuracy10: 0.5220 - val_loss: 3.1493 - val_accuracy10: 0.4923 - 203s/epoch - 33ms/step
Epoch 7/50
6147/6147 - 204s - loss: 2.8701 - accuracy10: 0.5237 - val_loss: 3.1429 - val_accuracy10: 0.4949 - 204s/epoch - 33ms/step
Epoch 8/50
6147/6147 - 201s - loss: 2.8642 - accuracy10: 0.5252 - val_loss: 3.1402 - val_accuracy10: 0.4963 - 201s/epoch - 33ms/step
Epoch 9/50
6147/6147 - 206s - loss: 2.8596 - accuracy10: 0.5263 - val_loss: 3.1321 - val_accuracy10: 0.4965 - 206s/epoch - 33ms/step
Epoch 10/50
6147/6147 - 205s - loss: 2.8551 - accuracy10: 0.5275 - val_loss: 3.1201 - val_accuracy10: 0.4999 - 205s/epoch - 33ms/step
Epoch 11/50
6147/6147 - 202s - loss: 2.8512 - accuracy10: 0.5286 - val_loss: 3.1218 - val_accuracy10: 0.4999 - 202s/epoch - 33ms/step
Epoch 12/50
6147/6147 - 207s - loss: 2.8473 - accuracy10: 0.5295 - val_loss: 3.1277 - val_accuracy10: 0.4990 - 207s/epoch - 34ms/step
Epoch 13/50
6147/6147 - 205s - loss: 2.8439 - accuracy10: 0.5300 - val_loss: 3.1106 - val_accuracy10: 0.5013 - 205s/epoch - 33ms/step
Epoch 14/50
6147/6147 - 201s - loss: 2.8410 - accuracy10: 0.5307 - val_loss: 3.1134 - val_accuracy10: 0.5017 - 201s/epoch - 33ms/step
Epoch 15/50
6147/6147 - 200s - loss: 2.8381 - accuracy10: 0.5314 - val_loss: 3.1129 - val_accuracy10: 0.5016 - 200s/epoch - 32ms/step
Epoch 16/50
6147/6147 - 204s - loss: 2.8349 - accuracy10: 0.5324 - val_loss: 3.0997 - val_accuracy10: 0.5044 - 204s/epoch - 33ms/step
Epoch 17/50
6147/6147 - 203s - loss: 2.8321 - accuracy10: 0.5332 - val_loss: 3.1181 - val_accuracy10: 0.5021 - 203s/epoch - 33ms/step
Epoch 18/50
6147/6147 - 198s - loss: 2.8295 - accuracy10: 0.5337 - val_loss: 3.1111 - val_accuracy10: 0.5030 - 198s/epoch - 32ms/step
Epoch 19/50
6147/6147 - 198s - loss: 2.8272 - accuracy10: 0.5344 - val_loss: 3.0962 - val_accuracy10: 0.5056 - 198s/epoch - 32ms/step
Epoch 20/50
6147/6147 - 195s - loss: 2.8252 - accuracy10: 0.5350 - val_loss: 3.1202 - val_accuracy10: 0.5030 - 195s/epoch - 32ms/step
Epoch 21/50
6147/6147 - 195s - loss: 2.8228 - accuracy10: 0.5353 - val_loss: 3.0999 - val_accuracy10: 0.5039 - 195s/epoch - 32ms/step
Epoch 22/50
6147/6147 - 196s - loss: 2.8206 - accuracy10: 0.5359 - val_loss: 3.1007 - val_accuracy10: 0.5051 - 196s/epoch - 32ms/step
Epoch 23/50
6147/6147 - 197s - loss: 2.8190 - accuracy10: 0.5363 - val_loss: 3.1042 - val_accuracy10: 0.5047 - 197s/epoch - 32ms/step
Epoch 24/50
6147/6147 - 198s - loss: 2.8168 - accuracy10: 0.5368 - val_loss: 3.1013 - val_accuracy10: 0.5043 - 198s/epoch - 32ms/step
Epoch 25/50
6147/6147 - 179s - loss: 2.8149 - accuracy10: 0.5375 - val_loss: 3.0786 - val_accuracy10: 0.5056 - 179s/epoch - 29ms/step
Epoch 26/50
6147/6147 - 182s - loss: 2.8131 - accuracy10: 0.5377 - val_loss: 3.0747 - val_accuracy10: 0.5063 - 182s/epoch - 30ms/step
Epoch 27/50
6147/6147 - 176s - loss: 2.8113 - accuracy10: 0.5384 - val_loss: 3.0906 - val_accuracy10: 0.5062 - 176s/epoch - 29ms/step
Epoch 28/50
6147/6147 - 172s - loss: 2.8097 - accuracy10: 0.5388 - val_loss: 3.0948 - val_accuracy10: 0.5057 - 172s/epoch - 28ms/step
Epoch 29/50
6147/6147 - 174s - loss: 2.8080 - accuracy10: 0.5390 - val_loss: 3.0998 - val_accuracy10: 0.5056 - 174s/epoch - 28ms/step
Epoch 30/50
6147/6147 - 173s - loss: 2.8063 - accuracy10: 0.5393 - val_loss: 3.0769 - val_accuracy10: 0.5058 - 173s/epoch - 28ms/step
Epoch 31/50
6147/6147 - 185s - loss: 2.8046 - accuracy10: 0.5397 - val_loss: 3.0904 - val_accuracy10: 0.5061 - 185s/epoch - 30ms/step
Epoch 32/50
6147/6147 - 197s - loss: 2.8034 - accuracy10: 0.5402 - val_loss: 3.0727 - val_accuracy10: 0.5060 - 197s/epoch - 32ms/step
Epoch 33/50
6147/6147 - 196s - loss: 2.8021 - accuracy10: 0.5404 - val_loss: 3.0743 - val_accuracy10: 0.5070 - 196s/epoch - 32ms/step
Epoch 34/50
6147/6147 - 199s - loss: 2.8003 - accuracy10: 0.5409 - val_loss: 3.0729 - val_accuracy10: 0.5061 - 199s/epoch - 32ms/step
Epoch 35/50
6147/6147 - 199s - loss: 2.7990 - accuracy10: 0.5411 - val_loss: 3.0712 - val_accuracy10: 0.5076 - 199s/epoch - 32ms/step
Epoch 36/50
6147/6147 - 198s - loss: 2.7977 - accuracy10: 0.5413 - val_loss: 3.0797 - val_accuracy10: 0.5067 - 198s/epoch - 32ms/step
Epoch 37/50
6147/6147 - 195s - loss: 2.7965 - accuracy10: 0.5416 - val_loss: 3.0860 - val_accuracy10: 0.5058 - 195s/epoch - 32ms/step
Epoch 38/50
6147/6147 - 197s - loss: 2.7946 - accuracy10: 0.5422 - val_loss: 3.0917 - val_accuracy10: 0.5058 - 197s/epoch - 32ms/step
Epoch 39/50
6147/6147 - 198s - loss: 2.7934 - accuracy10: 0.5423 - val_loss: 3.0714 - val_accuracy10: 0.5075 - 198s/epoch - 32ms/step
Epoch 40/50
6147/6147 - 198s - loss: 2.7924 - accuracy10: 0.5425 - val_loss: 3.0958 - val_accuracy10: 0.5038 - 198s/epoch - 32ms/step
Epoch 41/50
6147/6147 - 201s - loss: 2.7908 - accuracy10: 0.5431 - val_loss: 3.0786 - val_accuracy10: 0.5067 - 201s/epoch - 33ms/step
Epoch 42/50
6147/6147 - 190s - loss: 2.7898 - accuracy10: 0.5431 - val_loss: 3.0759 - val_accuracy10: 0.5071 - 190s/epoch - 31ms/step
Epoch 43/50
6147/6147 - 195s - loss: 2.7886 - accuracy10: 0.5433 - val_loss: 3.0784 - val_accuracy10: 0.5071 - 195s/epoch - 32ms/step
Epoch 44/50
6147/6147 - 185s - loss: 2.7874 - accuracy10: 0.5437 - val_loss: 3.0828 - val_accuracy10: 0.5067 - 185s/epoch - 30ms/step
Epoch 45/50
6147/6147 - 193s - loss: 2.7860 - accuracy10: 0.5441 - val_loss: 3.1007 - val_accuracy10: 0.5062 - 193s/epoch - 31ms/step
testing model: results/AAPL/W2/deepOF_L2/h10
Evaluating performance on  test set...
14883/14883 - 217s - 217s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0177925
{'0': {'precision': 0.4528858727354127, 'recall': 0.5226987732363828, 'f1-score': 0.48529441514341454, 'support': 1124422}, '1': {'precision': 0.533690583995205, 'recall': 0.5408803915071764, 'f1-score': 0.5372614347415535, 'support': 1521096}, '2': {'precision': 0.49552677700238934, 'recall': 0.41304097645434124, 'f1-score': 0.4505395729787735, 'support': 1164376}, 'accuracy': 0.49644425802922604, 'macro avg': {'precision': 0.4940344112443357, 'recall': 0.4922067137326334, 'f1-score': 0.4910318076212472, 'support': 3809894}, 'weighted avg': {'precision': 0.49817893564613686, 'recall': 0.49644425802922604, 'f1-score': 0.4954204505507919, 'support': 3809894}}
[[587734 346077 190611]
 [399358 822731 299007]
 [310661 372780 480935]]
Evaluating performance on  train set...
6147/6147 - 98s - 98s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.029481
{'0': {'precision': 0.466045428072219, 'recall': 0.49524886224382436, 'f1-score': 0.4802035554186429, 'support': 484726}, '1': {'precision': 0.5182045766067621, 'recall': 0.546690164889237, 'f1-score': 0.5320663806331181, 'support': 597492}, '2': {'precision': 0.4909974839211582, 'recall': 0.4278139089900563, 'f1-score': 0.45723323528899873, 'support': 491265}, 'accuracy': 0.4937282449190744, 'macro avg': {'precision': 0.49174916286671305, 'recall': 0.48991764537437255, 'f1-score': 0.48983439044691984, 'support': 1573483}, 'weighted avg': {'precision': 0.49364200566017535, 'recall': 0.4937282449190744, 'f1-score': 0.49272552664080266, 'support': 1573483}}
[[240060 153805  90861]
 [143833 326643 127016]
 [131207 149888 210170]]
Evaluating performance on  val set...
2174/2174 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0115039
{'0': {'precision': 0.4659767000812788, 'recall': 0.509590826938461, 'f1-score': 0.48680884787931106, 'support': 168755}, '1': {'precision': 0.5561164233959408, 'recall': 0.572559329593202, 'f1-score': 0.5642181037593567, 'support': 213005}, '2': {'precision': 0.48630199803471996, 'recall': 0.42481816152864493, 'f1-score': 0.45348556627661557, 'support': 174743}, 'accuracy': 0.5070736366201081, 'macro avg': {'precision': 0.5027983738373131, 'recall': 0.5023227726867693, 'f1-score': 0.5015041726384277, 'support': 556503}, 'weighted avg': {'precision': 0.506860424526462, 'recall': 0.5070736366201081, 'f1-score': 0.505974150405316, 'support': 556503}}
[[ 85996  47419  35340]
 [ 47971 121958  43076]
 [ 50583  49926  74234]]
training model: results/AAPL/W2/deepOF_L2/h20
Epoch 1/50
6147/6147 - 183s - loss: 3.0974 - accuracy20: 0.4630 - val_loss: 3.2647 - val_accuracy20: 0.4275 - 183s/epoch - 30ms/step
Epoch 2/50
6147/6147 - 174s - loss: 3.0340 - accuracy20: 0.4836 - val_loss: 3.2162 - val_accuracy20: 0.4435 - 174s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 176s - loss: 3.0109 - accuracy20: 0.4905 - val_loss: 3.1981 - val_accuracy20: 0.4465 - 176s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 173s - loss: 2.9988 - accuracy20: 0.4933 - val_loss: 3.2143 - val_accuracy20: 0.4451 - 173s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 174s - loss: 2.9900 - accuracy20: 0.4954 - val_loss: 3.2049 - val_accuracy20: 0.4468 - 174s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 175s - loss: 2.9836 - accuracy20: 0.4973 - val_loss: 3.2151 - val_accuracy20: 0.4467 - 175s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 172s - loss: 2.9782 - accuracy20: 0.4987 - val_loss: 3.2025 - val_accuracy20: 0.4488 - 172s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 176s - loss: 2.9736 - accuracy20: 0.4998 - val_loss: 3.2042 - val_accuracy20: 0.4492 - 176s/epoch - 29ms/step
Epoch 9/50
6147/6147 - 177s - loss: 2.9700 - accuracy20: 0.5002 - val_loss: 3.2138 - val_accuracy20: 0.4490 - 177s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 173s - loss: 2.9662 - accuracy20: 0.5018 - val_loss: 3.2003 - val_accuracy20: 0.4526 - 173s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 174s - loss: 2.9632 - accuracy20: 0.5024 - val_loss: 3.1935 - val_accuracy20: 0.4538 - 174s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 173s - loss: 2.9608 - accuracy20: 0.5029 - val_loss: 3.2056 - val_accuracy20: 0.4531 - 173s/epoch - 28ms/step
Epoch 13/50
6147/6147 - 175s - loss: 2.9580 - accuracy20: 0.5038 - val_loss: 3.1865 - val_accuracy20: 0.4546 - 175s/epoch - 28ms/step
Epoch 14/50
6147/6147 - 176s - loss: 2.9552 - accuracy20: 0.5046 - val_loss: 3.2042 - val_accuracy20: 0.4529 - 176s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 175s - loss: 2.9528 - accuracy20: 0.5053 - val_loss: 3.1917 - val_accuracy20: 0.4555 - 175s/epoch - 28ms/step
Epoch 16/50
6147/6147 - 172s - loss: 2.9506 - accuracy20: 0.5058 - val_loss: 3.1831 - val_accuracy20: 0.4580 - 172s/epoch - 28ms/step
Epoch 17/50
6147/6147 - 176s - loss: 2.9487 - accuracy20: 0.5064 - val_loss: 3.1748 - val_accuracy20: 0.4588 - 176s/epoch - 29ms/step
Epoch 18/50
6147/6147 - 171s - loss: 2.9468 - accuracy20: 0.5070 - val_loss: 3.1941 - val_accuracy20: 0.4564 - 171s/epoch - 28ms/step
Epoch 19/50
6147/6147 - 175s - loss: 2.9444 - accuracy20: 0.5074 - val_loss: 3.1804 - val_accuracy20: 0.4589 - 175s/epoch - 28ms/step
Epoch 20/50
6147/6147 - 172s - loss: 2.9427 - accuracy20: 0.5080 - val_loss: 3.1740 - val_accuracy20: 0.4600 - 172s/epoch - 28ms/step
Epoch 21/50
6147/6147 - 174s - loss: 2.9408 - accuracy20: 0.5086 - val_loss: 3.1749 - val_accuracy20: 0.4603 - 174s/epoch - 28ms/step
Epoch 22/50
6147/6147 - 181s - loss: 2.9391 - accuracy20: 0.5089 - val_loss: 3.1883 - val_accuracy20: 0.4587 - 181s/epoch - 29ms/step
Epoch 23/50
6147/6147 - 177s - loss: 2.9378 - accuracy20: 0.5095 - val_loss: 3.1790 - val_accuracy20: 0.4593 - 177s/epoch - 29ms/step
Epoch 24/50
6147/6147 - 176s - loss: 2.9359 - accuracy20: 0.5100 - val_loss: 3.1861 - val_accuracy20: 0.4596 - 176s/epoch - 29ms/step
Epoch 25/50
6147/6147 - 182s - loss: 2.9339 - accuracy20: 0.5105 - val_loss: 3.1780 - val_accuracy20: 0.4596 - 182s/epoch - 30ms/step
Epoch 26/50
6147/6147 - 172s - loss: 2.9326 - accuracy20: 0.5108 - val_loss: 3.1897 - val_accuracy20: 0.4573 - 172s/epoch - 28ms/step
Epoch 27/50
6147/6147 - 174s - loss: 2.9309 - accuracy20: 0.5114 - val_loss: 3.1841 - val_accuracy20: 0.4596 - 174s/epoch - 28ms/step
Epoch 28/50
6147/6147 - 173s - loss: 2.9295 - accuracy20: 0.5118 - val_loss: 3.1851 - val_accuracy20: 0.4597 - 173s/epoch - 28ms/step
Epoch 29/50
6147/6147 - 172s - loss: 2.9281 - accuracy20: 0.5118 - val_loss: 3.1777 - val_accuracy20: 0.4605 - 172s/epoch - 28ms/step
Epoch 30/50
6147/6147 - 173s - loss: 2.9269 - accuracy20: 0.5125 - val_loss: 3.1786 - val_accuracy20: 0.4617 - 173s/epoch - 28ms/step
testing model: results/AAPL/W2/deepOF_L2/h20
Evaluating performance on  test set...
14883/14883 - 199s - 199s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0557872
{'0': {'precision': 0.44638190828078733, 'recall': 0.4549876025966985, 'f1-score': 0.45064367463127986, 'support': 1206301}, '1': {'precision': 0.4373002739009684, 'recall': 0.5078086642144792, 'f1-score': 0.4699243843637225, 'support': 1350359}, '2': {'precision': 0.48516278555142395, 'recall': 0.39187174940992664, 'f1-score': 0.433555537310758, 'support': 1253234}, 'accuracy': 0.4529477723002267, 'macro avg': {'precision': 0.4562816559110599, 'recall': 0.45155600540703483, 'f1-score': 0.4513745321019201, 'support': 3809894}, 'weighted avg': {'precision': 0.45591971884084254, 'recall': 0.4529477723002267, 'f1-score': 0.4518564236544403, 'support': 3809894}}
[[548852 439416 218033]
 [361523 685724 303112]
 [319182 442945 491107]]
Evaluating performance on  train set...
6147/6147 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0703874
{'0': {'precision': 0.4428632410028896, 'recall': 0.4658240526828819, 'f1-score': 0.4540535586702727, 'support': 521156}, '1': {'precision': 0.42273841902547793, 'recall': 0.5007543523264608, 'f1-score': 0.45845102374264685, 'support': 523628}, '2': {'precision': 0.4840560531695322, 'recall': 0.3708423885802697, 'f1-score': 0.4199528135686158, 'support': 528699}, 'accuracy': 0.4455338888313379, 'macro avg': {'precision': 0.44988590439929993, 'recall': 0.4458069311965374, 'f1-score': 0.44415246532717845, 'support': 1573483}, 'weighted avg': {'precision': 0.45000706036242744, 'recall': 0.4455338888313379, 'f1-score': 0.444058920028747, 'support': 1573483}}
[[242767 182426  95963]
 [148402 262209 113017]
 [157007 175628 196064]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.058265
{'0': {'precision': 0.4493959273727237, 'recall': 0.46254689865502335, 'f1-score': 0.4558765890617946, 'support': 182308}, '1': {'precision': 0.4564053819604659, 'recall': 0.5301823483378536, 'f1-score': 0.49053534677279376, 'support': 186566}, '2': {'precision': 0.4774017983909134, 'recall': 0.3870936795484706, 'f1-score': 0.42753079334245725, 'support': 187629}, 'accuracy': 0.4597818879682589, 'macro avg': {'precision': 0.461067702574701, 'recall': 0.4599409755137825, 'f1-score': 0.4579809097256819, 'support': 556503}, 'weighted avg': {'precision': 0.46118820787774994, 'recall': 0.4597818879682589, 'f1-score': 0.4579388465628085, 'support': 556503}}
[[84326 58697 39285]
 [47431 98914 40221]
 [55886 59113 72630]]
training model: results/AAPL/W2/deepOF_L2/h30
Epoch 1/50
6147/6147 - 180s - loss: 3.1467 - accuracy30: 0.4456 - val_loss: 3.3319 - val_accuracy30: 0.3872 - 180s/epoch - 29ms/step
Epoch 2/50
6147/6147 - 175s - loss: 3.1021 - accuracy30: 0.4622 - val_loss: 3.3044 - val_accuracy30: 0.3943 - 175s/epoch - 29ms/step
Epoch 3/50
6147/6147 - 181s - loss: 3.0790 - accuracy30: 0.4692 - val_loss: 3.3040 - val_accuracy30: 0.3995 - 181s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 175s - loss: 3.0671 - accuracy30: 0.4725 - val_loss: 3.3069 - val_accuracy30: 0.4014 - 175s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 171s - loss: 3.0600 - accuracy30: 0.4746 - val_loss: 3.3149 - val_accuracy30: 0.4018 - 171s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 174s - loss: 3.0546 - accuracy30: 0.4762 - val_loss: 3.3200 - val_accuracy30: 0.4034 - 174s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 175s - loss: 3.0501 - accuracy30: 0.4775 - val_loss: 3.3157 - val_accuracy30: 0.4039 - 175s/epoch - 29ms/step
Epoch 8/50
6147/6147 - 177s - loss: 3.0465 - accuracy30: 0.4785 - val_loss: 3.3094 - val_accuracy30: 0.4043 - 177s/epoch - 29ms/step
Epoch 9/50
6147/6147 - 178s - loss: 3.0434 - accuracy30: 0.4796 - val_loss: 3.3082 - val_accuracy30: 0.4049 - 178s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 173s - loss: 3.0406 - accuracy30: 0.4803 - val_loss: 3.3091 - val_accuracy30: 0.4046 - 173s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 173s - loss: 3.0376 - accuracy30: 0.4813 - val_loss: 3.3129 - val_accuracy30: 0.4063 - 173s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 176s - loss: 3.0351 - accuracy30: 0.4820 - val_loss: 3.3137 - val_accuracy30: 0.4072 - 176s/epoch - 29ms/step
Epoch 13/50
6147/6147 - 173s - loss: 3.0331 - accuracy30: 0.4825 - val_loss: 3.3041 - val_accuracy30: 0.4073 - 173s/epoch - 28ms/step
testing model: results/AAPL/W2/deepOF_L2/h30
Evaluating performance on  test set...
14883/14883 - 192s - 192s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0792161
{'0': {'precision': 0.4492775549274586, 'recall': 0.2701805075025105, 'f1-score': 0.3374374244686522, 'support': 1176073}, '1': {'precision': 0.38856104544135417, 'recall': 0.6386327587728915, 'f1-score': 0.4831567546140178, 'support': 1404668}, '2': {'precision': 0.4544047317662381, 'recall': 0.29351594146538307, 'f1-score': 0.3566555583345608, 'support': 1229153}, 'accuracy': 0.4135535004385949, 'macro avg': {'precision': 0.4307477773783503, 'recall': 0.40077640258026176, 'f1-score': 0.39241657913907696, 'support': 3809894}, 'weighted avg': {'precision': 0.4285461505487775, 'recall': 0.4135535004385949, 'f1-score': 0.39736279429057203, 'support': 3809894}}
[[317752 695975 162346]
 [236770 897067 270831]
 [152729 715648 360776]]
Evaluating performance on  train set...
6147/6147 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1113367
{'0': {'precision': 0.45830793152814975, 'recall': 0.25621417110558825, 'f1-score': 0.32868118804098995, 'support': 522274}, '1': {'precision': 0.3527322473217173, 'recall': 0.6479146216581588, 'f1-score': 0.45678528091147946, 'support': 518539}, '2': {'precision': 0.4434995881872031, 'recall': 0.27395197777235436, 'f1-score': 0.33869210157095886, 'support': 532670}, 'accuracy': 0.3913032425517149, 'macro avg': {'precision': 0.41817992234569007, 'recall': 0.39269359017870054, 'f1-score': 0.3747195235078094, 'support': 1573483}, 'weighted avg': {'precision': 0.4185025634624373, 'recall': 0.3913032425517149, 'f1-score': 0.3742866896720716, 'support': 1573483}}
[[133814 304737  83723]
 [ 83186 335969  99384]
 [ 74974 311770 145926]]
Evaluating performance on  val set...
2174/2174 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1024654
{'0': {'precision': 0.4583312661857655, 'recall': 0.2546206212275721, 'f1-score': 0.3273729792556999, 'support': 181415}, '1': {'precision': 0.36661420770200154, 'recall': 0.6580872982158029, 'f1-score': 0.4708964552912255, 'support': 188320}, '2': {'precision': 0.443149951562739, 'recall': 0.27921806733487536, 'f1-score': 0.3425829211091622, 'support': 186768}, 'accuracy': 0.399408448831363, 'macro avg': {'precision': 0.42269847515016873, 'recall': 0.3973086622594168, 'f1-score': 0.3802841185520292, 'support': 556503}, 'weighted avg': {'precision': 0.4221993132166425, 'recall': 0.399408448831363, 'f1-score': 0.38104577423990954, 'support': 556503}}
[[ 46192 105260  29963]
 [ 28823 123931  35566]
 [ 25768 108851  52149]]
training model: results/AAPL/W2/deepOF_L2/h50
Epoch 1/50
6147/6147 - 189s - loss: 3.1692 - accuracy50: 0.4414 - val_loss: 3.5408 - val_accuracy50: 0.3587 - 189s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 169s - loss: 3.1376 - accuracy50: 0.4531 - val_loss: 3.5566 - val_accuracy50: 0.3617 - 169s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 178s - loss: 3.1214 - accuracy50: 0.4585 - val_loss: 3.5627 - val_accuracy50: 0.3633 - 178s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 178s - loss: 3.1126 - accuracy50: 0.4615 - val_loss: 3.5766 - val_accuracy50: 0.3639 - 178s/epoch - 29ms/step
Epoch 5/50
6147/6147 - 174s - loss: 3.1073 - accuracy50: 0.4630 - val_loss: 3.5748 - val_accuracy50: 0.3640 - 174s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 174s - loss: 3.1032 - accuracy50: 0.4641 - val_loss: 3.5803 - val_accuracy50: 0.3640 - 174s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 171s - loss: 3.0998 - accuracy50: 0.4655 - val_loss: 3.5745 - val_accuracy50: 0.3656 - 171s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 171s - loss: 3.0973 - accuracy50: 0.4662 - val_loss: 3.5730 - val_accuracy50: 0.3656 - 171s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 176s - loss: 3.0947 - accuracy50: 0.4671 - val_loss: 3.5891 - val_accuracy50: 0.3651 - 176s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 173s - loss: 3.0924 - accuracy50: 0.4677 - val_loss: 3.5894 - val_accuracy50: 0.3655 - 173s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 174s - loss: 3.0904 - accuracy50: 0.4680 - val_loss: 3.5870 - val_accuracy50: 0.3661 - 174s/epoch - 28ms/step
testing model: results/AAPL/W2/deepOF_L2/h50
Evaluating performance on  test set...
14883/14883 - 198s - 198s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.047632
{'0': {'precision': 0.5662365982191532, 'recall': 0.0032141206759968314, 'f1-score': 0.0063919587681735435, 'support': 969472}, '1': {'precision': 0.4871074784695272, 'recall': 0.9988340458608628, 'f1-score': 0.6548569045582736, 'support': 1855133}, '2': {'precision': 0.3516483516483517, 'recall': 0.00012991112252344237, 'f1-score': 0.0002597262931275003, 'support': 985289}, 'accuracy': 0.48720883048189795, 'macro avg': {'precision': 0.46833080944567734, 'recall': 0.3340593592197944, 'f1-score': 0.2205028632065249, 'support': 3809894}, 'weighted avg': {'precision': 0.4722112840807594, 'recall': 0.48720883048189795, 'f1-score': 0.32055993800206306, 'support': 3809894}}
[[   3116  966272      84]
 [   2011 1852970     152]
 [    376  984785     128]]
Evaluating performance on  train set...
6147/6147 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2129899
{'0': {'precision': 0.6197478991596639, 'recall': 0.0028390007487262992, 'f1-score': 0.005652109769719636, 'support': 519549}, '1': {'precision': 0.3300486934755581, 'recall': 0.9986131870502488, 'f1-score': 0.49612468379534586, 'support': 519176}, '2': {'precision': 0.33203125, 'recall': 0.00015895040373402547, 'f1-score': 0.0003177486944266879, 'support': 534758}, 'accuracy': 0.3304872057721628, 'macro avg': {'precision': 0.427275947545074, 'recall': 0.33387037940090303, 'f1-score': 0.1673648474198307, 'support': 1573483}, 'weighted avg': {'precision': 0.42637837773390025, 'recall': 0.3304872057721628, 'f1-score': 0.16567226685589534, 'support': 1573483}}
[[  1475 517993     81]
 [   630 518456     90]
 [   275 534398     85]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1830814
{'0': {'precision': 0.5394112060778727, 'recall': 0.003222439068669723, 'f1-score': 0.006406605119644479, 'support': 176264}, '1': {'precision': 0.35840846627932527, 'recall': 0.9974037690457097, 'f1-score': 0.527326639797127, 'support': 199520}, '2': {'precision': 0.2028301886792453, 'recall': 0.00023793845694143948, 'f1-score': 0.00047531932062498965, 'support': 180719}, 'accuracy': 0.35869168719665484, 'macro avg': {'precision': 0.36688328701214773, 'recall': 0.33362138219044035, 'f1-score': 0.1780695214124655, 'support': 556503}, 'weighted avg': {'precision': 0.36521582612867437, 'recall': 0.35869168719665484, 'f1-score': 0.19124310964978775, 'support': 556503}}
[[   568 175657     39]
 [   388 199002    130]
 [    97 180579     43]]
training model: results/AAPL/W2/deepOF_L2/h100
Epoch 1/50
6147/6147 - 179s - loss: 3.2252 - accuracy100: 0.4114 - val_loss: 3.3580 - val_accuracy100: 0.3265 - 179s/epoch - 29ms/step
Epoch 2/50
6147/6147 - 173s - loss: 3.2013 - accuracy100: 0.4231 - val_loss: 3.3697 - val_accuracy100: 0.3313 - 173s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 173s - loss: 3.1879 - accuracy100: 0.4291 - val_loss: 3.3770 - val_accuracy100: 0.3357 - 173s/epoch - 28ms/step
Epoch 4/50
6147/6147 - 171s - loss: 3.1812 - accuracy100: 0.4322 - val_loss: 3.3652 - val_accuracy100: 0.3389 - 171s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 174s - loss: 3.1761 - accuracy100: 0.4341 - val_loss: 3.3609 - val_accuracy100: 0.3437 - 174s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 175s - loss: 3.1719 - accuracy100: 0.4358 - val_loss: 3.3601 - val_accuracy100: 0.3493 - 175s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 175s - loss: 3.1686 - accuracy100: 0.4376 - val_loss: 3.3604 - val_accuracy100: 0.3488 - 175s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 175s - loss: 3.1660 - accuracy100: 0.4383 - val_loss: 3.3591 - val_accuracy100: 0.3545 - 175s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 178s - loss: 3.1639 - accuracy100: 0.4395 - val_loss: 3.3620 - val_accuracy100: 0.3587 - 178s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 179s - loss: 3.1616 - accuracy100: 0.4404 - val_loss: 3.3675 - val_accuracy100: 0.3595 - 179s/epoch - 29ms/step
Epoch 11/50
6147/6147 - 181s - loss: 3.1599 - accuracy100: 0.4408 - val_loss: 3.3640 - val_accuracy100: 0.3614 - 181s/epoch - 29ms/step
testing model: results/AAPL/W2/deepOF_L2/h100
Evaluating performance on  test set...
14883/14883 - 198s - 198s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980124
{'0': {'precision': 0.47531854648419064, 'recall': 0.00853785792333051, 'f1-score': 0.01677440737061331, 'support': 1179687}, '1': {'precision': 0.36987590493702094, 'recall': 0.9920516959173911, 'f1-score': 0.5388480540985471, 'support': 1408854}, '2': {'precision': 0.45744893872647174, 'recall': 0.0037409332109553913, 'f1-score': 0.0074211773992744505, 'support': 1221353}, 'accuracy': 0.3706919405106809, 'macro avg': {'precision': 0.4342144633825611, 'recall': 0.3347768290172257, 'f1-score': 0.18768121295614495, 'support': 3809894}, 'weighted avg': {'precision': 0.430598565729343, 'recall': 0.3706919405106809, 'f1-score': 0.20683270033153345, 'support': 3809894}}
[[  10072 1167876    1739]
 [   7518 1397656    3680]
 [   3600 1213184    4569]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1203939
{'0': {'precision': 0.4819899244332494, 'recall': 0.007375003613308538, 'f1-score': 0.014527716354594716, 'support': 518915}, '1': {'precision': 0.3299525841114821, 'recall': 0.9921174012267812, 'f1-score': 0.4952108495118565, 'support': 519245}, '2': {'precision': 0.45719661335841955, 'recall': 0.00363145241284234, 'f1-score': 0.007205671130056063, 'support': 535323}, 'accuracy': 0.33106363398905486, 'macro avg': {'precision': 0.42304637396771705, 'recall': 0.33437461908431065, 'f1-score': 0.17231474566550245, 'support': 1573483}, 'weighted avg': {'precision': 0.4233829624006839, 'recall': 0.33106363398905486, 'f1-score': 0.17066073734084414, 'support': 1573483}}
[[  3827 514256    832]
 [  2617 515152   1476]
 [  1496 531883   1944]]
Evaluating performance on  val set...
2174/2174 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1208471
{'0': {'precision': 0.4606413994169096, 'recall': 0.009383537237201568, 'f1-score': 0.018392410220592514, 'support': 185218}, '1': {'precision': 0.3251446057733344, 'recall': 0.9878611313425588, 'f1-score': 0.4892556201844314, 'support': 181236}, '2': {'precision': 0.42386634844868737, 'recall': 0.004672479202731927, 'f1-score': 0.00924306769922558, 'support': 190049}, 'accuracy': 0.32643489792507857, 'macro avg': {'precision': 0.40321745121297714, 'recall': 0.33397238259416406, 'f1-score': 0.1722970327014165, 'support': 556503}, 'weighted avg': {'precision': 0.40395534641405667, 'recall': 0.32643489792507857, 'f1-score': 0.16861359739148477, 'support': 556503}}
[[  1738 183094    386]
 [  1379 179036    821]
 [   656 188505    888]]
training model: results/AAPL/W2/deepOF_L2/h200
Epoch 1/50
6147/6147 - 175s - loss: 3.2401 - accuracy200: 0.4028 - val_loss: 3.4585 - val_accuracy200: 0.3528 - 175s/epoch - 28ms/step
Epoch 2/50
6147/6147 - 172s - loss: 3.2248 - accuracy200: 0.4106 - val_loss: 3.4525 - val_accuracy200: 0.3529 - 172s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 176s - loss: 3.2148 - accuracy200: 0.4162 - val_loss: 3.4739 - val_accuracy200: 0.3528 - 176s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 173s - loss: 3.2112 - accuracy200: 0.4181 - val_loss: 3.4893 - val_accuracy200: 0.3527 - 173s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 178s - loss: 3.2086 - accuracy200: 0.4195 - val_loss: 3.4908 - val_accuracy200: 0.3527 - 178s/epoch - 29ms/step
Epoch 6/50
6147/6147 - 178s - loss: 3.2065 - accuracy200: 0.4206 - val_loss: 3.4890 - val_accuracy200: 0.3525 - 178s/epoch - 29ms/step
Epoch 7/50
6147/6147 - 172s - loss: 3.2045 - accuracy200: 0.4218 - val_loss: 3.4891 - val_accuracy200: 0.3525 - 172s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 174s - loss: 3.2033 - accuracy200: 0.4225 - val_loss: 3.4845 - val_accuracy200: 0.3525 - 174s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 173s - loss: 3.2017 - accuracy200: 0.4231 - val_loss: 3.4989 - val_accuracy200: 0.3524 - 173s/epoch - 28ms/step
Epoch 10/50
6147/6147 - 174s - loss: 3.2003 - accuracy200: 0.4241 - val_loss: 3.5029 - val_accuracy200: 0.3523 - 174s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 173s - loss: 3.1992 - accuracy200: 0.4243 - val_loss: 3.4998 - val_accuracy200: 0.3523 - 173s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 173s - loss: 3.1980 - accuracy200: 0.4252 - val_loss: 3.5065 - val_accuracy200: 0.3523 - 173s/epoch - 28ms/step
testing model: results/AAPL/W2/deepOF_L2/h200
Evaluating performance on  test set...
14883/14883 - 209s - 209s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011753
{'0': {'precision': 0.38, 'recall': 3.477089639370903e-05, 'f1-score': 6.953543013153176e-05, 'support': 1092868}, '1': {'precision': 0.41994805909314975, 'recall': 0.9999481238652096, 'f1-score': 0.5914887001613219, 'support': 1599965}, '2': {'precision': 0.2875, 'recall': 2.05897439799617e-05, 'f1-score': 4.117653904028229e-05, 'support': 1117061}, 'accuracy': 0.41994422941950615, 'macro avg': {'precision': 0.36248268636438324, 'recall': 0.3333344948351944, 'f1-score': 0.1971998040434979, 'support': 3809894}, 'weighted avg': {'precision': 0.3696551856474147, 'recall': 0.41994422941950615, 'f1-score': 0.2484277011134544, 'support': 3809894}}
[[     38 1092813      17]
 [     43 1599882      40]
 [     19 1117019      23]]
Evaluating performance on  train set...
6147/6147 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1735938
{'0': {'precision': 0.6274509803921569, 'recall': 6.169400160789991e-05, 'f1-score': 0.00012337587230597214, 'support': 518689}, '1': {'precision': 0.3301605339861978, 'recall': 0.999934552454283, 'f1-score': 0.4964140220577063, 'support': 519500}, '2': {'precision': 0.3103448275862069, 'recall': 3.3626381016787036e-05, 'f1-score': 6.72454758738176e-05, 'support': 535294}, 'accuracy': 0.3301694393901936, 'macro avg': {'precision': 0.4226521139881872, 'recall': 0.3333432909456359, 'f1-score': 0.16553488113529538, 'support': 1573483}, 'weighted avg': {'precision': 0.4214192610357965, 'recall': 0.3301694393901936, 'f1-score': 0.16395923836900134, 'support': 1573483}}
[[    32 518639     18]
 [    12 519466     22]
 [     7 535269     18]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.152671
{'0': {'precision': 0.25396825396825395, 'recall': 9.015760676632838e-05, 'f1-score': 0.0001802512251450459, 'support': 177467}, '1': {'precision': 0.3529130541057384, 'recall': 0.9996690815230396, 'f1-score': 0.521663356867225, 'support': 196423}, '2': {'precision': 0.20833333333333334, 'recall': 5.47606139760039e-05, 'f1-score': 0.00010949244775841588, 'support': 182613}, 'accuracy': 0.3528893824471746, 'macro avg': {'precision': 0.2717382138024419, 'recall': 0.3332713332479273, 'f1-score': 0.17398436684670948, 'support': 556503}, 'weighted avg': {'precision': 0.27391694196364724, 'recall': 0.3528893824471746, 'f1-score': 0.1842194290677072, 'support': 556503}}
[[    16 177441     10]
 [    37 196358     28]
 [    10 182593     10]]
training model: results/AAPL/W2/deepOF_L2/h300
Epoch 1/50
6147/6147 - 180s - loss: 3.2357 - accuracy300: 0.4028 - val_loss: 3.3822 - val_accuracy300: 0.3296 - 180s/epoch - 29ms/step
Epoch 2/50
6147/6147 - 173s - loss: 3.2173 - accuracy300: 0.4117 - val_loss: 3.3830 - val_accuracy300: 0.3297 - 173s/epoch - 28ms/step
Epoch 3/50
6147/6147 - 176s - loss: 3.2083 - accuracy300: 0.4168 - val_loss: 3.3809 - val_accuracy300: 0.3297 - 176s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 172s - loss: 3.2054 - accuracy300: 0.4184 - val_loss: 3.3819 - val_accuracy300: 0.3297 - 172s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 170s - loss: 3.2030 - accuracy300: 0.4198 - val_loss: 3.3848 - val_accuracy300: 0.3297 - 170s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 171s - loss: 3.2011 - accuracy300: 0.4209 - val_loss: 3.3825 - val_accuracy300: 0.3297 - 171s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 174s - loss: 3.1996 - accuracy300: 0.4218 - val_loss: 3.3792 - val_accuracy300: 0.3296 - 174s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 174s - loss: 3.1982 - accuracy300: 0.4226 - val_loss: 3.3745 - val_accuracy300: 0.3297 - 174s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 175s - loss: 3.1969 - accuracy300: 0.4235 - val_loss: 3.3772 - val_accuracy300: 0.3296 - 175s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 174s - loss: 3.1954 - accuracy300: 0.4239 - val_loss: 3.3733 - val_accuracy300: 0.3296 - 174s/epoch - 28ms/step
Epoch 11/50
6147/6147 - 172s - loss: 3.1939 - accuracy300: 0.4248 - val_loss: 3.3761 - val_accuracy300: 0.3295 - 172s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 174s - loss: 3.1929 - accuracy300: 0.4256 - val_loss: 3.3665 - val_accuracy300: 0.3298 - 174s/epoch - 28ms/step
Epoch 13/50
6147/6147 - 172s - loss: 3.1916 - accuracy300: 0.4262 - val_loss: 3.3753 - val_accuracy300: 0.3295 - 172s/epoch - 28ms/step
Epoch 14/50
6147/6147 - 175s - loss: 3.1904 - accuracy300: 0.4269 - val_loss: 3.3773 - val_accuracy300: 0.3295 - 175s/epoch - 28ms/step
Epoch 15/50
6147/6147 - 172s - loss: 3.1888 - accuracy300: 0.4279 - val_loss: 3.3736 - val_accuracy300: 0.3297 - 172s/epoch - 28ms/step
Epoch 16/50
6147/6147 - 173s - loss: 3.1880 - accuracy300: 0.4281 - val_loss: 3.3723 - val_accuracy300: 0.3297 - 173s/epoch - 28ms/step
Epoch 17/50
6147/6147 - 174s - loss: 3.1867 - accuracy300: 0.4288 - val_loss: 3.3683 - val_accuracy300: 0.3297 - 174s/epoch - 28ms/step
Epoch 18/50
6147/6147 - 176s - loss: 3.1854 - accuracy300: 0.4296 - val_loss: 3.3686 - val_accuracy300: 0.3300 - 176s/epoch - 29ms/step
Epoch 19/50
6147/6147 - 176s - loss: 3.1840 - accuracy300: 0.4304 - val_loss: 3.3672 - val_accuracy300: 0.3300 - 176s/epoch - 29ms/step
Epoch 20/50
6147/6147 - 178s - loss: 3.1828 - accuracy300: 0.4312 - val_loss: 3.3592 - val_accuracy300: 0.3306 - 178s/epoch - 29ms/step
Epoch 21/50
6147/6147 - 184s - loss: 3.1809 - accuracy300: 0.4326 - val_loss: 3.3610 - val_accuracy300: 0.3306 - 184s/epoch - 30ms/step
Epoch 22/50
6147/6147 - 186s - loss: 3.1797 - accuracy300: 0.4328 - val_loss: 3.3721 - val_accuracy300: 0.3307 - 186s/epoch - 30ms/step
Epoch 23/50
6147/6147 - 183s - loss: 3.1784 - accuracy300: 0.4336 - val_loss: 3.3675 - val_accuracy300: 0.3309 - 183s/epoch - 30ms/step
Epoch 24/50
6147/6147 - 175s - loss: 3.1770 - accuracy300: 0.4344 - val_loss: 3.3719 - val_accuracy300: 0.3317 - 175s/epoch - 28ms/step
Epoch 25/50
6147/6147 - 170s - loss: 3.1752 - accuracy300: 0.4353 - val_loss: 3.3691 - val_accuracy300: 0.3315 - 170s/epoch - 28ms/step
Epoch 26/50
6147/6147 - 174s - loss: 3.1732 - accuracy300: 0.4364 - val_loss: 3.3753 - val_accuracy300: 0.3317 - 174s/epoch - 28ms/step
Epoch 27/50
6147/6147 - 173s - loss: 3.1719 - accuracy300: 0.4370 - val_loss: 3.3682 - val_accuracy300: 0.3333 - 173s/epoch - 28ms/step
Epoch 28/50
6147/6147 - 172s - loss: 3.1702 - accuracy300: 0.4381 - val_loss: 3.3740 - val_accuracy300: 0.3323 - 172s/epoch - 28ms/step
Epoch 29/50
6147/6147 - 175s - loss: 3.1679 - accuracy300: 0.4401 - val_loss: 3.3869 - val_accuracy300: 0.3328 - 175s/epoch - 29ms/step
Epoch 30/50
6147/6147 - 174s - loss: 3.1669 - accuracy300: 0.4397 - val_loss: 3.3810 - val_accuracy300: 0.3334 - 174s/epoch - 28ms/step
testing model: results/AAPL/W2/deepOF_L2/h300
Evaluating performance on  test set...
14883/14883 - 189s - 189s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129024
{'0': {'precision': 0.3921783625730994, 'recall': 0.0026714535396136973, 'f1-score': 0.005306758327357254, 'support': 1204962}, '1': {'precision': 0.3579112644513683, 'recall': 0.9958046833148653, 'f1-score': 0.5265649916290481, 'support': 1362710}, '2': {'precision': 0.3919906460099386, 'recall': 0.003238551563247149, 'f1-score': 0.006424029030287788, 'support': 1242222}, 'accuracy': 0.35807689137808035, 'macro avg': {'precision': 0.3806934243448021, 'recall': 0.33390489613924207, 'f1-score': 0.17943192632889773, 'support': 3809894}, 'weighted avg': {'precision': 0.3798606175319022, 'recall': 0.35807689137808035, 'f1-score': 0.19211292809210215, 'support': 3809894}}
[[   3219 1198403    3340]
 [   2817 1356993    2900]
 [   2172 1236027    4023]]
Evaluating performance on  train set...
6147/6147 - 77s - 77s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246998
{'0': {'precision': 0.4495967741935484, 'recall': 0.0034321288818262618, 'f1-score': 0.006812254420901096, 'support': 519794}, '1': {'precision': 0.330524090904444, 'recall': 0.9956596971604218, 'f1-score': 0.4962954896837363, 'support': 519549}, '2': {'precision': 0.41886112986720686, 'recall': 0.003484105290747744, 'f1-score': 0.0069107268517572965, 'support': 534140}, 'accuracy': 0.3310738025132779, 'macro avg': {'precision': 0.39966066498839975, 'recall': 0.33419197711099863, 'f1-score': 0.17000615698546492, 'support': 1573483}, 'weighted avg': {'precision': 0.3998464873517821, 'recall': 0.3310738025132779, 'f1-score': 0.16846835331856208, 'support': 1573483}}
[[  1784 516498   1512]
 [  1185 517294   1070]
 [   999 531280   1861]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204892
{'0': {'precision': 0.4014084507042254, 'recall': 0.004350599434094961, 'f1-score': 0.008607903522444732, 'support': 183423}, '1': {'precision': 0.3300493414197935, 'recall': 0.9922859010677707, 'f1-score': 0.495340814680955, 'support': 183560}, '2': {'precision': 0.37188208616780044, 'recall': 0.0051920641620937106, 'f1-score': 0.010241145676134175, 'support': 189520}, 'accuracy': 0.33050315991108764, 'macro avg': {'precision': 0.36777995943060643, 'recall': 0.3339428548879864, 'f1-score': 0.17139662129317798, 'support': 556503}, 'weighted avg': {'precision': 0.36781561345592023, 'recall': 0.33050315991108764, 'f1-score': 0.1697107641094018, 'support': 556503}}
[[   798 181667    958]
 [   712 182144    704]
 [   478 188058    984]]
training model: results/AAPL/W2/deepOF_L2/h500
Epoch 1/50
6147/6147 - 181s - loss: 3.2538 - accuracy500: 0.3918 - val_loss: 3.4337 - val_accuracy500: 0.3251 - 181s/epoch - 29ms/step
Epoch 2/50
6147/6147 - 183s - loss: 3.2384 - accuracy500: 0.3997 - val_loss: 3.4354 - val_accuracy500: 0.3250 - 183s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 180s - loss: 3.2303 - accuracy500: 0.4050 - val_loss: 3.4371 - val_accuracy500: 0.3250 - 180s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 181s - loss: 3.2277 - accuracy500: 0.4063 - val_loss: 3.4372 - val_accuracy500: 0.3249 - 181s/epoch - 29ms/step
Epoch 5/50
6147/6147 - 170s - loss: 3.2259 - accuracy500: 0.4079 - val_loss: 3.4378 - val_accuracy500: 0.3249 - 170s/epoch - 28ms/step
Epoch 6/50
6147/6147 - 174s - loss: 3.2244 - accuracy500: 0.4090 - val_loss: 3.4360 - val_accuracy500: 0.3248 - 174s/epoch - 28ms/step
Epoch 7/50
6147/6147 - 178s - loss: 3.2230 - accuracy500: 0.4101 - val_loss: 3.4346 - val_accuracy500: 0.3248 - 178s/epoch - 29ms/step
Epoch 8/50
6147/6147 - 177s - loss: 3.2221 - accuracy500: 0.4105 - val_loss: 3.4328 - val_accuracy500: 0.3246 - 177s/epoch - 29ms/step
Epoch 9/50
6147/6147 - 173s - loss: 3.2211 - accuracy500: 0.4114 - val_loss: 3.4322 - val_accuracy500: 0.3247 - 173s/epoch - 28ms/step
Epoch 10/50
6147/6147 - 179s - loss: 3.2201 - accuracy500: 0.4120 - val_loss: 3.4344 - val_accuracy500: 0.3247 - 179s/epoch - 29ms/step
Epoch 11/50
6147/6147 - 182s - loss: 3.2188 - accuracy500: 0.4128 - val_loss: 3.4322 - val_accuracy500: 0.3246 - 182s/epoch - 30ms/step
Epoch 12/50
6147/6147 - 176s - loss: 3.2179 - accuracy500: 0.4139 - val_loss: 3.4339 - val_accuracy500: 0.3246 - 176s/epoch - 29ms/step
Epoch 13/50
6147/6147 - 173s - loss: 3.2169 - accuracy500: 0.4142 - val_loss: 3.4293 - val_accuracy500: 0.3245 - 173s/epoch - 28ms/step
Epoch 14/50
6147/6147 - 169s - loss: 3.2158 - accuracy500: 0.4151 - val_loss: 3.4299 - val_accuracy500: 0.3245 - 169s/epoch - 28ms/step
Epoch 15/50
6147/6147 - 178s - loss: 3.2148 - accuracy500: 0.4158 - val_loss: 3.4318 - val_accuracy500: 0.3245 - 178s/epoch - 29ms/step
Epoch 16/50
6147/6147 - 176s - loss: 3.2141 - accuracy500: 0.4163 - val_loss: 3.4307 - val_accuracy500: 0.3245 - 176s/epoch - 29ms/step
Epoch 17/50
6147/6147 - 180s - loss: 3.2129 - accuracy500: 0.4171 - val_loss: 3.4316 - val_accuracy500: 0.3246 - 180s/epoch - 29ms/step
Epoch 18/50
6147/6147 - 181s - loss: 3.2118 - accuracy500: 0.4177 - val_loss: 3.4313 - val_accuracy500: 0.3244 - 181s/epoch - 29ms/step
Epoch 19/50
6147/6147 - 178s - loss: 3.2108 - accuracy500: 0.4185 - val_loss: 3.4297 - val_accuracy500: 0.3246 - 178s/epoch - 29ms/step
Epoch 20/50
6147/6147 - 181s - loss: 3.2097 - accuracy500: 0.4188 - val_loss: 3.4330 - val_accuracy500: 0.3244 - 181s/epoch - 29ms/step
Epoch 21/50
6147/6147 - 178s - loss: 3.2085 - accuracy500: 0.4196 - val_loss: 3.4281 - val_accuracy500: 0.3244 - 178s/epoch - 29ms/step
Epoch 22/50
6147/6147 - 171s - loss: 3.2078 - accuracy500: 0.4196 - val_loss: 3.4321 - val_accuracy500: 0.3243 - 171s/epoch - 28ms/step
Epoch 23/50
6147/6147 - 174s - loss: 3.2063 - accuracy500: 0.4211 - val_loss: 3.4313 - val_accuracy500: 0.3243 - 174s/epoch - 28ms/step
Epoch 24/50
6147/6147 - 172s - loss: 3.2054 - accuracy500: 0.4215 - val_loss: 3.4337 - val_accuracy500: 0.3243 - 172s/epoch - 28ms/step
Epoch 25/50
6147/6147 - 175s - loss: 3.2041 - accuracy500: 0.4221 - val_loss: 3.4334 - val_accuracy500: 0.3243 - 175s/epoch - 29ms/step
Epoch 26/50
6147/6147 - 178s - loss: 3.2024 - accuracy500: 0.4231 - val_loss: 3.4297 - val_accuracy500: 0.3243 - 178s/epoch - 29ms/step
Epoch 27/50
6147/6147 - 172s - loss: 3.2016 - accuracy500: 0.4238 - val_loss: 3.4308 - val_accuracy500: 0.3242 - 172s/epoch - 28ms/step
Epoch 28/50
6147/6147 - 173s - loss: 3.2000 - accuracy500: 0.4250 - val_loss: 3.4369 - val_accuracy500: 0.3242 - 173s/epoch - 28ms/step
Epoch 29/50
6147/6147 - 174s - loss: 3.1986 - accuracy500: 0.4255 - val_loss: 3.4380 - val_accuracy500: 0.3241 - 174s/epoch - 28ms/step
Epoch 30/50
6147/6147 - 176s - loss: 3.1973 - accuracy500: 0.4265 - val_loss: 3.4447 - val_accuracy500: 0.3243 - 176s/epoch - 29ms/step
Epoch 31/50
6147/6147 - 176s - loss: 3.1957 - accuracy500: 0.4274 - val_loss: 3.4565 - val_accuracy500: 0.3242 - 176s/epoch - 29ms/step
testing model: results/AAPL/W2/deepOF_L2/h500
Evaluating performance on  test set...
14883/14883 - 223s - 223s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114235
{'0': {'precision': 0.25931072818232354, 'recall': 0.0008031305737089654, 'f1-score': 0.0016013016368289078, 'support': 1161704}, '1': {'precision': 0.3818708259495866, 'recall': 0.9987650044740238, 'f1-score': 0.5524979270906161, 'support': 1455066}, '2': {'precision': 0.2984375, 'recall': 0.0001600839476869127, 'f1-score': 0.0003199962471644312, 'support': 1193124}, 'accuracy': 0.38174106681183256, 'macro avg': {'precision': 0.3132063513773034, 'recall': 0.3332427396651399, 'f1-score': 0.1848064083248698, 'support': 3809894}, 'weighted avg': {'precision': 0.3183717208808117, 'recall': 0.38174106681183256, 'f1-score': 0.2115972209460806, 'support': 3809894}}
[[    933 1160571     200]
 [   1548 1453269     249]
 [   1117 1191816     191]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1432593
{'0': {'precision': 0.34757362090418914, 'recall': 0.0016140682030490094, 'f1-score': 0.003213214825267065, 'support': 519185}, '1': {'precision': 0.32999093471723195, 'recall': 0.9980380378067611, 'f1-score': 0.49598843367591516, 'support': 519378}, '2': {'precision': 0.3401639344262295, 'recall': 0.00015516338891796903, 'f1-score': 0.00031018528899552286, 'support': 534920}, 'accuracy': 0.33001945365790414, 'macro avg': {'precision': 0.33924283001588357, 'recall': 0.33326908979957603, 'f1-score': 0.1665039445967259, 'support': 1573483}, 'weighted avg': {'precision': 0.3392509063421636, 'recall': 0.33001945365790414, 'f1-score': 0.16488240289826786, 'support': 1573483}}
[[   838 518255     92]
 [   950 518359     69]
 [   623 534214     83]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1443026
{'0': {'precision': 0.24560301507537688, 'recall': 0.0021207584830339322, 'f1-score': 0.004205205420520542, 'support': 184368}, '1': {'precision': 0.3246425977031799, 'recall': 0.9948792451996377, 'f1-score': 0.4895412445042437, 'support': 181028}, '2': {'precision': 0.3194444444444444, 'recall': 0.0002407028523288001, 'f1-score': 0.00048104323637523466, 'support': 191107}, 'accuracy': 0.32441514241612357, 'macro avg': {'precision': 0.29656335240766707, 'recall': 0.3324135688450001, 'f1-score': 0.16474249772037983, 'support': 556503}, 'weighted avg': {'precision': 0.2966719070784394, 'recall': 0.32441514241612357, 'f1-score': 0.1608040000734205, 'support': 556503}}
[[   391 183933     44]
 [   873 180101     54]
 [   328 190733     46]]
training model: results/AAPL/W2/deepOF_L2/h1000
Epoch 1/50
6147/6147 - 174s - loss: 3.2463 - accuracy1000: 0.3965 - val_loss: 3.4251 - val_accuracy1000: 0.3318 - 174s/epoch - 28ms/step
Epoch 2/50
6147/6147 - 175s - loss: 3.2284 - accuracy1000: 0.4016 - val_loss: 3.4343 - val_accuracy1000: 0.3318 - 175s/epoch - 29ms/step
Epoch 3/50
6147/6147 - 175s - loss: 3.2197 - accuracy1000: 0.4074 - val_loss: 3.4420 - val_accuracy1000: 0.3317 - 175s/epoch - 28ms/step
Epoch 4/50
6147/6147 - 175s - loss: 3.2169 - accuracy1000: 0.4091 - val_loss: 3.4408 - val_accuracy1000: 0.3317 - 175s/epoch - 28ms/step
Epoch 5/50
6147/6147 - 176s - loss: 3.2150 - accuracy1000: 0.4104 - val_loss: 3.4403 - val_accuracy1000: 0.3317 - 176s/epoch - 29ms/step
Epoch 6/50
6147/6147 - 175s - loss: 3.2135 - accuracy1000: 0.4118 - val_loss: 3.4354 - val_accuracy1000: 0.3315 - 175s/epoch - 29ms/step
Epoch 7/50
6147/6147 - 170s - loss: 3.2121 - accuracy1000: 0.4131 - val_loss: 3.4358 - val_accuracy1000: 0.3315 - 170s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 173s - loss: 3.2106 - accuracy1000: 0.4142 - val_loss: 3.4316 - val_accuracy1000: 0.3314 - 173s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 182s - loss: 3.2097 - accuracy1000: 0.4151 - val_loss: 3.4332 - val_accuracy1000: 0.3314 - 182s/epoch - 30ms/step
Epoch 10/50
6147/6147 - 178s - loss: 3.2086 - accuracy1000: 0.4162 - val_loss: 3.4324 - val_accuracy1000: 0.3314 - 178s/epoch - 29ms/step
Epoch 11/50
6147/6147 - 177s - loss: 3.2076 - accuracy1000: 0.4170 - val_loss: 3.4304 - val_accuracy1000: 0.3313 - 177s/epoch - 29ms/step
testing model: results/AAPL/W2/deepOF_L2/h1000
Evaluating performance on  test set...
14883/14883 - 203s - 203s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243927
{'0': {'precision': 0.27912087912087913, 'recall': 0.00010666568119895585, 'f1-score': 0.00021324986923753098, 'support': 1190636}, '1': {'precision': 0.36343185416431456, 'recall': 0.9996923339144804, 'f1-score': 0.533069608309803, 'support': 1384618}, '2': {'precision': 0.33029908972691807, 'recall': 0.00020572798548564763, 'f1-score': 0.00041119985365170564, 'support': 1234640}, 'accuracy': 0.36341509763788704, 'macro avg': {'precision': 0.32428394100403723, 'recall': 0.33333490919372166, 'f1-score': 0.17789801934423075, 'support': 3809894}, 'weighted avg': {'precision': 0.32634664434829264, 'recall': 0.36341509763788704, 'f1-score': 0.1939317371237428, 'support': 3809894}}
[[    127 1190244     265]
 [    176 1384192     250]
 [    152 1234234     254]]
Evaluating performance on  train set...
6147/6147 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1419796
{'0': {'precision': 0.3939393939393939, 'recall': 0.0001514169128809203, 'f1-score': 0.00030271747145529487, 'support': 515134}, '1': {'precision': 0.33145314132147913, 'recall': 0.9996126862509371, 'f1-score': 0.49783377816398733, 'support': 521541}, '2': {'precision': 0.27525252525252525, 'recall': 0.00020305211546772775, 'f1-score': 0.00040580487114764594, 'support': 536808}, 'accuracy': 0.3314468602457097, 'macro avg': {'precision': 0.3335483535044661, 'recall': 0.33332238509309525, 'f1-score': 0.1661807668355301, 'support': 1573483}, 'weighted avg': {'precision': 0.33273682404657623, 'recall': 0.3314468602457097, 'f1-score': 0.16524773757367306, 'support': 1573483}}
[[    78 514896    160]
 [    75 521339    127]
 [    45 536654    109]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1415203
{'0': {'precision': 0.2523809523809524, 'recall': 0.00029104727596224075, 'f1-score': 0.000581424050112171, 'support': 182101}, '1': {'precision': 0.33197195231389814, 'recall': 0.9987339580583029, 'f1-score': 0.49830944510656916, 'support': 184828}, '2': {'precision': 0.23333333333333334, 'recall': 0.0002953991581123994, 'f1-score': 0.0005900513133910039, 'support': 189574}, 'accuracy': 0.3318993787993955, 'macro avg': {'precision': 0.27256207934272797, 'recall': 0.33310680149745914, 'f1-score': 0.1664936401566908, 'support': 556503}, 'weighted avg': {'precision': 0.27232641898629534, 'recall': 0.3318993787993955, 'f1-score': 0.1658917820906468, 'support': 556503}}
[[    53 181981     67]
 [   117 184594    117]
 [    40 189478     56]]
training model: results/AAPL/W2/deepVOL_L2/h10
Epoch 1/50
6147/6147 - 188s - loss: 3.1084 - accuracy10: 0.4509 - val_loss: 3.1720 - val_accuracy10: 0.4616 - 188s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 180s - loss: 3.0289 - accuracy10: 0.4787 - val_loss: 3.0849 - val_accuracy10: 0.4856 - 180s/epoch - 29ms/step
Epoch 3/50
6147/6147 - 184s - loss: 2.9847 - accuracy10: 0.4937 - val_loss: 3.0638 - val_accuracy10: 0.4903 - 184s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 181s - loss: 2.9580 - accuracy10: 0.5015 - val_loss: 3.0483 - val_accuracy10: 0.4938 - 181s/epoch - 29ms/step
Epoch 5/50
6147/6147 - 185s - loss: 2.9368 - accuracy10: 0.5070 - val_loss: 3.0004 - val_accuracy10: 0.5070 - 185s/epoch - 30ms/step
Epoch 6/50
6147/6147 - 186s - loss: 2.9215 - accuracy10: 0.5108 - val_loss: 2.9920 - val_accuracy10: 0.5060 - 186s/epoch - 30ms/step
Epoch 7/50
6147/6147 - 172s - loss: 2.9091 - accuracy10: 0.5138 - val_loss: 2.9865 - val_accuracy10: 0.5065 - 172s/epoch - 28ms/step
Epoch 8/50
6147/6147 - 186s - loss: 2.8987 - accuracy10: 0.5164 - val_loss: 2.9510 - val_accuracy10: 0.5163 - 186s/epoch - 30ms/step
Epoch 9/50
6147/6147 - 183s - loss: 2.8907 - accuracy10: 0.5180 - val_loss: 2.9562 - val_accuracy10: 0.5139 - 183s/epoch - 30ms/step
Epoch 10/50
6147/6147 - 184s - loss: 2.8831 - accuracy10: 0.5198 - val_loss: 2.9310 - val_accuracy10: 0.5208 - 184s/epoch - 30ms/step
Epoch 11/50
6147/6147 - 171s - loss: 2.8780 - accuracy10: 0.5210 - val_loss: 2.9393 - val_accuracy10: 0.5137 - 171s/epoch - 28ms/step
Epoch 12/50
6147/6147 - 189s - loss: 2.8721 - accuracy10: 0.5229 - val_loss: 2.9360 - val_accuracy10: 0.5165 - 189s/epoch - 31ms/step
Epoch 13/50
6147/6147 - 182s - loss: 2.8670 - accuracy10: 0.5238 - val_loss: 2.9230 - val_accuracy10: 0.5187 - 182s/epoch - 30ms/step
Epoch 14/50
6147/6147 - 176s - loss: 2.8624 - accuracy10: 0.5251 - val_loss: 2.9327 - val_accuracy10: 0.5137 - 176s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 177s - loss: 2.8579 - accuracy10: 0.5262 - val_loss: 2.9139 - val_accuracy10: 0.5217 - 177s/epoch - 29ms/step
Epoch 16/50
6147/6147 - 180s - loss: 2.8538 - accuracy10: 0.5272 - val_loss: 2.9192 - val_accuracy10: 0.5170 - 180s/epoch - 29ms/step
Epoch 17/50
6147/6147 - 179s - loss: 2.8507 - accuracy10: 0.5277 - val_loss: 2.9174 - val_accuracy10: 0.5170 - 179s/epoch - 29ms/step
Epoch 18/50
6147/6147 - 191s - loss: 2.8469 - accuracy10: 0.5289 - val_loss: 2.9177 - val_accuracy10: 0.5159 - 191s/epoch - 31ms/step
Epoch 19/50
6147/6147 - 189s - loss: 2.8432 - accuracy10: 0.5296 - val_loss: 2.9140 - val_accuracy10: 0.5176 - 189s/epoch - 31ms/step
Epoch 20/50
6147/6147 - 184s - loss: 2.8403 - accuracy10: 0.5306 - val_loss: 2.9218 - val_accuracy10: 0.5142 - 184s/epoch - 30ms/step
Epoch 21/50
6147/6147 - 190s - loss: 2.8374 - accuracy10: 0.5316 - val_loss: 2.9140 - val_accuracy10: 0.5176 - 190s/epoch - 31ms/step
Epoch 22/50
6147/6147 - 188s - loss: 2.8348 - accuracy10: 0.5319 - val_loss: 2.9085 - val_accuracy10: 0.5184 - 188s/epoch - 31ms/step
Epoch 23/50
6147/6147 - 172s - loss: 2.8326 - accuracy10: 0.5326 - val_loss: 2.9147 - val_accuracy10: 0.5170 - 172s/epoch - 28ms/step
Epoch 24/50
6147/6147 - 186s - loss: 2.8301 - accuracy10: 0.5332 - val_loss: 2.9152 - val_accuracy10: 0.5162 - 186s/epoch - 30ms/step
Epoch 25/50
6147/6147 - 184s - loss: 2.8277 - accuracy10: 0.5340 - val_loss: 2.9094 - val_accuracy10: 0.5191 - 184s/epoch - 30ms/step
Epoch 26/50
6147/6147 - 187s - loss: 2.8259 - accuracy10: 0.5342 - val_loss: 2.9135 - val_accuracy10: 0.5181 - 187s/epoch - 30ms/step
Epoch 27/50
6147/6147 - 188s - loss: 2.8230 - accuracy10: 0.5353 - val_loss: 2.9114 - val_accuracy10: 0.5192 - 188s/epoch - 31ms/step
Epoch 28/50
6147/6147 - 186s - loss: 2.8215 - accuracy10: 0.5354 - val_loss: 2.9063 - val_accuracy10: 0.5188 - 186s/epoch - 30ms/step
Epoch 29/50
6147/6147 - 182s - loss: 2.8193 - accuracy10: 0.5359 - val_loss: 2.8967 - val_accuracy10: 0.5230 - 182s/epoch - 30ms/step
Epoch 30/50
6147/6147 - 188s - loss: 2.8176 - accuracy10: 0.5362 - val_loss: 2.9104 - val_accuracy10: 0.5169 - 188s/epoch - 31ms/step
Epoch 31/50
6147/6147 - 185s - loss: 2.8158 - accuracy10: 0.5368 - val_loss: 2.9131 - val_accuracy10: 0.5169 - 185s/epoch - 30ms/step
Epoch 32/50
6147/6147 - 182s - loss: 2.8135 - accuracy10: 0.5373 - val_loss: 2.9126 - val_accuracy10: 0.5170 - 182s/epoch - 30ms/step
Epoch 33/50
6147/6147 - 179s - loss: 2.8120 - accuracy10: 0.5378 - val_loss: 2.9105 - val_accuracy10: 0.5186 - 179s/epoch - 29ms/step
Epoch 34/50
6147/6147 - 188s - loss: 2.8105 - accuracy10: 0.5380 - val_loss: 2.9077 - val_accuracy10: 0.5179 - 188s/epoch - 31ms/step
Epoch 35/50
6147/6147 - 182s - loss: 2.8086 - accuracy10: 0.5387 - val_loss: 2.9085 - val_accuracy10: 0.5179 - 182s/epoch - 30ms/step
Epoch 36/50
6147/6147 - 180s - loss: 2.8068 - accuracy10: 0.5390 - val_loss: 2.9066 - val_accuracy10: 0.5190 - 180s/epoch - 29ms/step
Epoch 37/50
6147/6147 - 182s - loss: 2.8057 - accuracy10: 0.5397 - val_loss: 2.9088 - val_accuracy10: 0.5187 - 182s/epoch - 30ms/step
Epoch 38/50
6147/6147 - 180s - loss: 2.8039 - accuracy10: 0.5398 - val_loss: 2.9088 - val_accuracy10: 0.5184 - 180s/epoch - 29ms/step
Epoch 39/50
6147/6147 - 182s - loss: 2.8023 - accuracy10: 0.5403 - val_loss: 2.9171 - val_accuracy10: 0.5171 - 182s/epoch - 30ms/step
testing model: results/AAPL/W2/deepVOL_L2/h10
Evaluating performance on  test set...
14883/14883 - 252s - 252s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9689804
{'0': {'precision': 0.48735611182167, 'recall': 0.521872532069753, 'f1-score': 0.5040240774684301, 'support': 1124424}, '1': {'precision': 0.5579245394112333, 'recall': 0.5108204873328179, 'f1-score': 0.533334477326625, 'support': 1521096}, '2': {'precision': 0.49091673432715255, 'recall': 0.5114855214668076, 'f1-score': 0.50099009734415, 'support': 1164379}, 'accuracy': 0.5142855493019631, 'macro avg': {'precision': 0.5120657951866853, 'recall': 0.5147261802897929, 'f1-score': 0.5127828840464016, 'support': 3809899}, 'weighted avg': {'precision': 0.5166186374175153, 'recall': 0.5142855493019631, 'f1-score': 0.5147989639521852, 'support': 3809899}}
[[586806 293367 244251]
 [370738 777007 373351]
 [246516 322300 595563]]
Evaluating performance on  train set...
6147/6147 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9716992
{'0': {'precision': 0.4998123208856071, 'recall': 0.518918305909522, 'f1-score': 0.5091861499101162, 'support': 484980}, '1': {'precision': 0.5363699312339683, 'recall': 0.526352521778425, 'f1-score': 0.5313140135711938, 'support': 597495}, '2': {'precision': 0.5002832744039866, 'recall': 0.4927638948290259, 'f1-score': 0.4964951161454486, 'support': 491010}, 'accuracy': 0.5135797290727271, 'macro avg': {'precision': 0.5121551755078539, 'recall': 0.5126782408389909, 'f1-score': 0.5123317598755862, 'support': 1573485}, 'weighted avg': {'precision': 0.5138412009080754, 'recall': 0.5135797290727271, 'f1-score': 0.513628431475804, 'support': 1573485}}
[[251665 130326 102989]
 [144313 314493 138689]
 [107541 141517 241952]]
Evaluating performance on  val set...
2174/2174 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96136564
{'0': {'precision': 0.49097509327417566, 'recall': 0.5187666846214404, 'f1-score': 0.5044884285175667, 'support': 168943}, '1': {'precision': 0.5695478945250783, 'recall': 0.544804701067315, 'f1-score': 0.5569015976586863, 'support': 213058}, '2': {'precision': 0.5018829364623757, 'recall': 0.5009999828083185, 'f1-score': 0.5014410709523113, 'support': 174503}, 'accuracy': 0.5231642539855957, 'macro avg': {'precision': 0.5208019747538765, 'recall': 0.5215237894990247, 'f1-score': 0.5209436990428548, 'support': 556504}, 'weighted avg': {'precision': 0.5244771260516315, 'recall': 0.5231642539855957, 'f1-score': 0.52359929196807, 'support': 556504}}
[[ 87642  41190  40111]
 [ 50324 116075  46659]
 [ 40540  46537  87426]]
training model: results/AAPL/W2/deepVOL_L2/h20
Epoch 1/50
6147/6147 - 193s - loss: 3.1485 - accuracy20: 0.4420 - val_loss: 3.2632 - val_accuracy20: 0.4250 - 193s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 184s - loss: 3.1078 - accuracy20: 0.4594 - val_loss: 3.2273 - val_accuracy20: 0.4275 - 184s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 184s - loss: 3.0759 - accuracy20: 0.4715 - val_loss: 3.1715 - val_accuracy20: 0.4450 - 184s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 181s - loss: 3.0550 - accuracy20: 0.4787 - val_loss: 3.1617 - val_accuracy20: 0.4488 - 181s/epoch - 29ms/step
Epoch 5/50
6147/6147 - 182s - loss: 3.0400 - accuracy20: 0.4836 - val_loss: 3.1579 - val_accuracy20: 0.4497 - 182s/epoch - 30ms/step
Epoch 6/50
6147/6147 - 185s - loss: 3.0278 - accuracy20: 0.4870 - val_loss: 3.1250 - val_accuracy20: 0.4587 - 185s/epoch - 30ms/step
Epoch 7/50
6147/6147 - 187s - loss: 3.0164 - accuracy20: 0.4903 - val_loss: 3.1015 - val_accuracy20: 0.4676 - 187s/epoch - 30ms/step
Epoch 8/50
6147/6147 - 181s - loss: 3.0061 - accuracy20: 0.4926 - val_loss: 3.1058 - val_accuracy20: 0.4623 - 181s/epoch - 29ms/step
Epoch 9/50
6147/6147 - 185s - loss: 2.9983 - accuracy20: 0.4945 - val_loss: 3.0981 - val_accuracy20: 0.4637 - 185s/epoch - 30ms/step
Epoch 10/50
6147/6147 - 191s - loss: 2.9913 - accuracy20: 0.4962 - val_loss: 3.0851 - val_accuracy20: 0.4652 - 191s/epoch - 31ms/step
Epoch 11/50
6147/6147 - 185s - loss: 2.9852 - accuracy20: 0.4977 - val_loss: 3.0723 - val_accuracy20: 0.4747 - 185s/epoch - 30ms/step
Epoch 12/50
6147/6147 - 191s - loss: 2.9801 - accuracy20: 0.4991 - val_loss: 3.0507 - val_accuracy20: 0.4831 - 191s/epoch - 31ms/step
Epoch 13/50
6147/6147 - 190s - loss: 2.9751 - accuracy20: 0.5004 - val_loss: 3.0502 - val_accuracy20: 0.4828 - 190s/epoch - 31ms/step
Epoch 14/50
6147/6147 - 194s - loss: 2.9701 - accuracy20: 0.5016 - val_loss: 3.0438 - val_accuracy20: 0.4853 - 194s/epoch - 32ms/step
Epoch 15/50
6147/6147 - 183s - loss: 2.9661 - accuracy20: 0.5027 - val_loss: 3.0449 - val_accuracy20: 0.4836 - 183s/epoch - 30ms/step
Epoch 16/50
6147/6147 - 176s - loss: 2.9623 - accuracy20: 0.5038 - val_loss: 3.0336 - val_accuracy20: 0.4854 - 176s/epoch - 29ms/step
Epoch 17/50
6147/6147 - 184s - loss: 2.9589 - accuracy20: 0.5044 - val_loss: 3.0388 - val_accuracy20: 0.4846 - 184s/epoch - 30ms/step
Epoch 18/50
6147/6147 - 184s - loss: 2.9559 - accuracy20: 0.5055 - val_loss: 3.0379 - val_accuracy20: 0.4835 - 184s/epoch - 30ms/step
Epoch 19/50
6147/6147 - 193s - loss: 2.9530 - accuracy20: 0.5059 - val_loss: 3.0371 - val_accuracy20: 0.4839 - 193s/epoch - 31ms/step
Epoch 20/50
6147/6147 - 191s - loss: 2.9505 - accuracy20: 0.5066 - val_loss: 3.0280 - val_accuracy20: 0.4878 - 191s/epoch - 31ms/step
Epoch 21/50
6147/6147 - 191s - loss: 2.9477 - accuracy20: 0.5076 - val_loss: 3.0179 - val_accuracy20: 0.4923 - 191s/epoch - 31ms/step
Epoch 22/50
6147/6147 - 187s - loss: 2.9455 - accuracy20: 0.5080 - val_loss: 3.0240 - val_accuracy20: 0.4880 - 187s/epoch - 30ms/step
Epoch 23/50
6147/6147 - 182s - loss: 2.9432 - accuracy20: 0.5086 - val_loss: 3.0213 - val_accuracy20: 0.4903 - 182s/epoch - 30ms/step
Epoch 24/50
6147/6147 - 180s - loss: 2.9413 - accuracy20: 0.5088 - val_loss: 3.0184 - val_accuracy20: 0.4892 - 180s/epoch - 29ms/step
Epoch 25/50
6147/6147 - 186s - loss: 2.9392 - accuracy20: 0.5095 - val_loss: 3.0250 - val_accuracy20: 0.4892 - 186s/epoch - 30ms/step
Epoch 26/50
6147/6147 - 186s - loss: 2.9377 - accuracy20: 0.5100 - val_loss: 3.0098 - val_accuracy20: 0.4933 - 186s/epoch - 30ms/step
Epoch 27/50
6147/6147 - 190s - loss: 2.9358 - accuracy20: 0.5102 - val_loss: 3.0274 - val_accuracy20: 0.4878 - 190s/epoch - 31ms/step
Epoch 28/50
6147/6147 - 195s - loss: 2.9339 - accuracy20: 0.5109 - val_loss: 3.0191 - val_accuracy20: 0.4904 - 195s/epoch - 32ms/step
Epoch 29/50
6147/6147 - 185s - loss: 2.9322 - accuracy20: 0.5112 - val_loss: 3.0245 - val_accuracy20: 0.4879 - 185s/epoch - 30ms/step
Epoch 30/50
6147/6147 - 186s - loss: 2.9308 - accuracy20: 0.5116 - val_loss: 3.0175 - val_accuracy20: 0.4900 - 186s/epoch - 30ms/step
Epoch 31/50
6147/6147 - 184s - loss: 2.9293 - accuracy20: 0.5121 - val_loss: 3.0204 - val_accuracy20: 0.4886 - 184s/epoch - 30ms/step
Epoch 32/50
6147/6147 - 184s - loss: 2.9274 - accuracy20: 0.5126 - val_loss: 3.0189 - val_accuracy20: 0.4890 - 184s/epoch - 30ms/step
Epoch 33/50
6147/6147 - 183s - loss: 2.9259 - accuracy20: 0.5132 - val_loss: 3.0183 - val_accuracy20: 0.4884 - 183s/epoch - 30ms/step
Epoch 34/50
6147/6147 - 186s - loss: 2.9244 - accuracy20: 0.5137 - val_loss: 3.0125 - val_accuracy20: 0.4892 - 186s/epoch - 30ms/step
Epoch 35/50
6147/6147 - 180s - loss: 2.9232 - accuracy20: 0.5139 - val_loss: 3.0264 - val_accuracy20: 0.4866 - 180s/epoch - 29ms/step
Epoch 36/50
6147/6147 - 200s - loss: 2.9221 - accuracy20: 0.5143 - val_loss: 3.0042 - val_accuracy20: 0.4942 - 200s/epoch - 33ms/step
Epoch 37/50
6147/6147 - 184s - loss: 2.9208 - accuracy20: 0.5144 - val_loss: 3.0182 - val_accuracy20: 0.4912 - 184s/epoch - 30ms/step
Epoch 38/50
6147/6147 - 193s - loss: 2.9192 - accuracy20: 0.5151 - val_loss: 3.0229 - val_accuracy20: 0.4882 - 193s/epoch - 31ms/step
Epoch 39/50
6147/6147 - 189s - loss: 2.9179 - accuracy20: 0.5150 - val_loss: 3.0174 - val_accuracy20: 0.4897 - 189s/epoch - 31ms/step
Epoch 40/50
6147/6147 - 189s - loss: 2.9165 - accuracy20: 0.5157 - val_loss: 3.0187 - val_accuracy20: 0.4909 - 189s/epoch - 31ms/step
Epoch 41/50
6147/6147 - 181s - loss: 2.9157 - accuracy20: 0.5158 - val_loss: 3.0187 - val_accuracy20: 0.4897 - 181s/epoch - 29ms/step
Epoch 42/50
6147/6147 - 183s - loss: 2.9140 - accuracy20: 0.5163 - val_loss: 3.0161 - val_accuracy20: 0.4918 - 183s/epoch - 30ms/step
Epoch 43/50
6147/6147 - 186s - loss: 2.9127 - accuracy20: 0.5166 - val_loss: 3.0202 - val_accuracy20: 0.4900 - 186s/epoch - 30ms/step
Epoch 44/50
6147/6147 - 187s - loss: 2.9120 - accuracy20: 0.5169 - val_loss: 3.0230 - val_accuracy20: 0.4894 - 187s/epoch - 30ms/step
Epoch 45/50
6147/6147 - 185s - loss: 2.9108 - accuracy20: 0.5170 - val_loss: 3.0256 - val_accuracy20: 0.4877 - 185s/epoch - 30ms/step
Epoch 46/50
6147/6147 - 183s - loss: 2.9096 - accuracy20: 0.5174 - val_loss: 3.0348 - val_accuracy20: 0.4853 - 183s/epoch - 30ms/step
testing model: results/AAPL/W2/deepVOL_L2/h20
Evaluating performance on  test set...
14883/14883 - 232s - 232s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0103287
{'0': {'precision': 0.4838778458609859, 'recall': 0.4947707953729663, 'f1-score': 0.4892636980686625, 'support': 1206302}, '1': {'precision': 0.4643590497914822, 'recall': 0.46522631002103143, 'f1-score': 0.4647922753493767, 'support': 1350360}, '2': {'precision': 0.4929856263572088, 'recall': 0.4813111965254776, 'f1-score': 0.487078467503985, 'support': 1253237}, 'accuracy': 0.47987177612844856, 'macro avg': {'precision': 0.48040750733655896, 'recall': 0.48043610063982517, 'f1-score': 0.48037814697400805, 'support': 3809899}, 'weighted avg': {'precision': 0.4799556437357668, 'recall': 0.47987177612844856, 'f1-score': 0.47987136452375767, 'support': 3809899}}
[[596843 351573 257886]
 [359661 628223 362476]
 [276954 373086 603197]]
Evaluating performance on  train set...
6147/6147 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0097688
{'0': {'precision': 0.5057249767635653, 'recall': 0.4843258714723379, 'f1-score': 0.49479416240645424, 'support': 521273}, '1': {'precision': 0.4424686932935536, 'recall': 0.48946760254022825, 'f1-score': 0.4647830360802493, 'support': 523575}, '2': {'precision': 0.5041043871697504, 'recall': 0.47210467674415524, 'f1-score': 0.48758006363086676, 'support': 528637}, 'accuracy': 0.48193087318913114, 'macro avg': {'precision': 0.48409935240895646, 'recall': 0.4819660502522405, 'f1-score': 0.4823857540391901, 'support': 1573485}, 'weighted avg': {'precision': 0.4841320716904843, 'recall': 0.48193087318913114, 'f1-score': 0.4823843110251745, 'support': 1573485}}
[[252466 157265 111542]
 [133336 256273 133966]
 [113414 165651 249572]]
Evaluating performance on  val set...
2174/2174 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0017418
{'0': {'precision': 0.506292899644811, 'recall': 0.48587759486179005, 'f1-score': 0.4958752104341796, 'support': 182476}, '1': {'precision': 0.47443612749714964, 'recall': 0.5132484247218125, 'f1-score': 0.49307968727862855, 'support': 186475}, '2': {'precision': 0.5056162889076903, 'recall': 0.4843270968739503, 'f1-score': 0.49474277591235505, 'support': 187553}, 'accuracy': 0.49452654428359905, 'macro avg': {'precision': 0.495448438683217, 'recall': 0.4944843721525176, 'f1-score': 0.49456589120838773, 'support': 556504}, 'weighted avg': {'precision': 0.4953902071936977, 'recall': 0.49452654428359905, 'f1-score': 0.4945568251713547, 'support': 556504}}
[[88661 51037 42778]
 [44726 95708 46041]
 [41731 54985 90837]]
training model: results/AAPL/W2/deepVOL_L2/h30
Epoch 1/50
6147/6147 - 194s - loss: 3.1823 - accuracy30: 0.4287 - val_loss: 3.3065 - val_accuracy30: 0.3887 - 194s/epoch - 32ms/step
Epoch 2/50
6147/6147 - 187s - loss: 3.1528 - accuracy30: 0.4414 - val_loss: 3.2407 - val_accuracy30: 0.4049 - 187s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 189s - loss: 3.1212 - accuracy30: 0.4554 - val_loss: 3.2568 - val_accuracy30: 0.4021 - 189s/epoch - 31ms/step
Epoch 4/50
6147/6147 - 186s - loss: 3.1036 - accuracy30: 0.4628 - val_loss: 3.2475 - val_accuracy30: 0.4035 - 186s/epoch - 30ms/step
Epoch 5/50
6147/6147 - 191s - loss: 3.0931 - accuracy30: 0.4668 - val_loss: 3.2572 - val_accuracy30: 0.4041 - 191s/epoch - 31ms/step
Epoch 6/50
6147/6147 - 184s - loss: 3.0853 - accuracy30: 0.4692 - val_loss: 3.2372 - val_accuracy30: 0.4061 - 184s/epoch - 30ms/step
Epoch 7/50
6147/6147 - 177s - loss: 3.0796 - accuracy30: 0.4714 - val_loss: 3.2384 - val_accuracy30: 0.4065 - 177s/epoch - 29ms/step
Epoch 8/50
6147/6147 - 187s - loss: 3.0738 - accuracy30: 0.4726 - val_loss: 3.2243 - val_accuracy30: 0.4109 - 187s/epoch - 30ms/step
Epoch 9/50
6147/6147 - 188s - loss: 3.0685 - accuracy30: 0.4742 - val_loss: 3.2247 - val_accuracy30: 0.4109 - 188s/epoch - 31ms/step
Epoch 10/50
6147/6147 - 193s - loss: 3.0636 - accuracy30: 0.4752 - val_loss: 3.2127 - val_accuracy30: 0.4150 - 193s/epoch - 31ms/step
Epoch 11/50
6147/6147 - 199s - loss: 3.0594 - accuracy30: 0.4761 - val_loss: 3.2268 - val_accuracy30: 0.4081 - 199s/epoch - 32ms/step
Epoch 12/50
6147/6147 - 174s - loss: 3.0555 - accuracy30: 0.4769 - val_loss: 3.2217 - val_accuracy30: 0.4111 - 174s/epoch - 28ms/step
Epoch 13/50
6147/6147 - 183s - loss: 3.0514 - accuracy30: 0.4781 - val_loss: 3.2174 - val_accuracy30: 0.4123 - 183s/epoch - 30ms/step
Epoch 14/50
6147/6147 - 187s - loss: 3.0480 - accuracy30: 0.4791 - val_loss: 3.2158 - val_accuracy30: 0.4132 - 187s/epoch - 30ms/step
Epoch 15/50
6147/6147 - 176s - loss: 3.0449 - accuracy30: 0.4794 - val_loss: 3.2086 - val_accuracy30: 0.4148 - 176s/epoch - 29ms/step
Epoch 16/50
6147/6147 - 186s - loss: 3.0420 - accuracy30: 0.4802 - val_loss: 3.1997 - val_accuracy30: 0.4163 - 186s/epoch - 30ms/step
Epoch 17/50
6147/6147 - 185s - loss: 3.0389 - accuracy30: 0.4813 - val_loss: 3.2006 - val_accuracy30: 0.4140 - 185s/epoch - 30ms/step
Epoch 18/50
6147/6147 - 190s - loss: 3.0362 - accuracy30: 0.4821 - val_loss: 3.2217 - val_accuracy30: 0.4112 - 190s/epoch - 31ms/step
Epoch 19/50
6147/6147 - 180s - loss: 3.0339 - accuracy30: 0.4826 - val_loss: 3.2259 - val_accuracy30: 0.4103 - 180s/epoch - 29ms/step
Epoch 20/50
6147/6147 - 186s - loss: 3.0311 - accuracy30: 0.4834 - val_loss: 3.2080 - val_accuracy30: 0.4129 - 186s/epoch - 30ms/step
Epoch 21/50
6147/6147 - 183s - loss: 3.0292 - accuracy30: 0.4836 - val_loss: 3.2134 - val_accuracy30: 0.4126 - 183s/epoch - 30ms/step
Epoch 22/50
6147/6147 - 182s - loss: 3.0268 - accuracy30: 0.4847 - val_loss: 3.2160 - val_accuracy30: 0.4094 - 182s/epoch - 30ms/step
Epoch 23/50
6147/6147 - 182s - loss: 3.0246 - accuracy30: 0.4852 - val_loss: 3.2153 - val_accuracy30: 0.4121 - 182s/epoch - 30ms/step
Epoch 24/50
6147/6147 - 195s - loss: 3.0229 - accuracy30: 0.4853 - val_loss: 3.2108 - val_accuracy30: 0.4134 - 195s/epoch - 32ms/step
Epoch 25/50
6147/6147 - 202s - loss: 3.0213 - accuracy30: 0.4861 - val_loss: 3.2154 - val_accuracy30: 0.4099 - 202s/epoch - 33ms/step
Epoch 26/50
6147/6147 - 194s - loss: 3.0193 - accuracy30: 0.4863 - val_loss: 3.2372 - val_accuracy30: 0.4110 - 194s/epoch - 32ms/step
testing model: results/AAPL/W2/deepVOL_L2/h30
Evaluating performance on  test set...
14883/14883 - 242s - 242s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0533922
{'0': {'precision': 0.5031858310205606, 'recall': 0.2657766433064586, 'f1-score': 0.3478324250999576, 'support': 1176074}, '1': {'precision': 0.387753825920018, 'recall': 0.6666090018360197, 'f1-score': 0.49030596309005875, 'support': 1404669}, '2': {'precision': 0.4876328878218092, 'recall': 0.3070098506617549, 'f1-score': 0.3767934766600283, 'support': 1229156}, 'accuracy': 0.4268619719315394, 'macro avg': {'precision': 0.4595241815874626, 'recall': 0.4131318319347444, 'f1-score': 0.4049772882833482, 'support': 3809899}, 'weighted avg': {'precision': 0.45560956912412226, 'recall': 0.4268619719315394, 'f1-score': 0.40970435724996673, 'support': 3809899}}
[[312573 727318 136183]
 [207983 936365 260321]
 [100632 751161 377363]]
Evaluating performance on  train set...
6147/6147 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0732048
{'0': {'precision': 0.5322007207047963, 'recall': 0.2536784981157511, 'f1-score': 0.3435842971573513, 'support': 522224}, '1': {'precision': 0.34916448942979245, 'recall': 0.6871758599888604, 'f1-score': 0.4630475083520286, 'support': 518873}, '2': {'precision': 0.5081017831833613, 'recall': 0.2895501025567819, 'f1-score': 0.36888503885002955, 'support': 532388}, 'accuracy': 0.4087658922709781, 'macro avg': {'precision': 0.4631556644393167, 'recall': 0.4101348202204645, 'f1-score': 0.3918389481198032, 'support': 1573485}, 'weighted avg': {'precision': 0.4636887593073144, 'recall': 0.4087658922709781, 'f1-score': 0.3915390257060807, 'support': 1573485}}
[[132477 329536  60211]
 [ 73290 356557  89026]
 [ 43156 335079 154153]]
Evaluating performance on  val set...
2174/2174 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0674913
{'0': {'precision': 0.5300399213931701, 'recall': 0.23620551008493154, 'f1-score': 0.32678393855227517, 'support': 181558}, '1': {'precision': 0.36318324802437607, 'recall': 0.7033063245196517, 'f1-score': 0.47900904400936023, 'support': 188457}, '2': {'precision': 0.5085994197764061, 'recall': 0.30176042554788757, 'f1-score': 0.37878277960260626, 'support': 186489}, 'accuracy': 0.41635459942785674, 'macro avg': {'precision': 0.4672741963979841, 'recall': 0.4137574200508236, 'f1-score': 0.39485858738808055, 'support': 556504}, 'weighted avg': {'precision': 0.46634994648001316, 'recall': 0.41635459942785674, 'f1-score': 0.3957593611328157, 'support': 556504}}
[[ 42885 115774  22899]
 [ 24441 132543  31473]
 [ 13583 116631  56275]]
training model: results/AAPL/W2/deepVOL_L2/h50
Epoch 1/50
6147/6147 - 179s - loss: 3.1847 - accuracy50: 0.4319 - val_loss: 3.5666 - val_accuracy50: 0.3605 - 179s/epoch - 29ms/step
Epoch 2/50
6147/6147 - 183s - loss: 3.1708 - accuracy50: 0.4375 - val_loss: 3.5506 - val_accuracy50: 0.3613 - 183s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 182s - loss: 3.1597 - accuracy50: 0.4418 - val_loss: 3.5308 - val_accuracy50: 0.3621 - 182s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 195s - loss: 3.1449 - accuracy50: 0.4491 - val_loss: 3.5249 - val_accuracy50: 0.3638 - 195s/epoch - 32ms/step
Epoch 5/50
6147/6147 - 185s - loss: 3.1327 - accuracy50: 0.4543 - val_loss: 3.5194 - val_accuracy50: 0.3648 - 185s/epoch - 30ms/step
Epoch 6/50
6147/6147 - 182s - loss: 3.1252 - accuracy50: 0.4574 - val_loss: 3.5187 - val_accuracy50: 0.3661 - 182s/epoch - 30ms/step
Epoch 7/50
6147/6147 - 176s - loss: 3.1194 - accuracy50: 0.4596 - val_loss: 3.5260 - val_accuracy50: 0.3673 - 176s/epoch - 29ms/step
Epoch 8/50
6147/6147 - 184s - loss: 3.1156 - accuracy50: 0.4610 - val_loss: 3.5255 - val_accuracy50: 0.3672 - 184s/epoch - 30ms/step
Epoch 9/50
6147/6147 - 191s - loss: 3.1123 - accuracy50: 0.4620 - val_loss: 3.5454 - val_accuracy50: 0.3686 - 191s/epoch - 31ms/step
Epoch 10/50
6147/6147 - 184s - loss: 3.1093 - accuracy50: 0.4631 - val_loss: 3.5321 - val_accuracy50: 0.3693 - 184s/epoch - 30ms/step
Epoch 11/50
6147/6147 - 182s - loss: 3.1069 - accuracy50: 0.4636 - val_loss: 3.5318 - val_accuracy50: 0.3694 - 182s/epoch - 30ms/step
Epoch 12/50
6147/6147 - 186s - loss: 3.1043 - accuracy50: 0.4648 - val_loss: 3.5359 - val_accuracy50: 0.3702 - 186s/epoch - 30ms/step
Epoch 13/50
6147/6147 - 181s - loss: 3.1021 - accuracy50: 0.4652 - val_loss: 3.5478 - val_accuracy50: 0.3696 - 181s/epoch - 29ms/step
Epoch 14/50
6147/6147 - 180s - loss: 3.0999 - accuracy50: 0.4661 - val_loss: 3.5575 - val_accuracy50: 0.3702 - 180s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 184s - loss: 3.0981 - accuracy50: 0.4665 - val_loss: 3.5547 - val_accuracy50: 0.3698 - 184s/epoch - 30ms/step
Epoch 16/50
6147/6147 - 182s - loss: 3.0960 - accuracy50: 0.4671 - val_loss: 3.5571 - val_accuracy50: 0.3704 - 182s/epoch - 30ms/step
testing model: results/AAPL/W2/deepVOL_L2/h50
Evaluating performance on  test set...
14883/14883 - 235s - 235s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0375541
{'0': {'precision': 0.5051736881005173, 'recall': 0.053581632926721086, 'f1-score': 0.09688688447843984, 'support': 969474}, '1': {'precision': 0.490209500148877, 'recall': 0.9708803020371553, 'f1-score': 0.6514791176475908, 'support': 1855136}, '2': {'precision': 0.530595495029942, 'recall': 0.01771561440348974, 'f1-score': 0.034286466323441886, 'support': 985289}, 'accuracy': 0.49096209637053373, 'macro avg': {'precision': 0.5086595610931121, 'recall': 0.3473925164557887, 'f1-score': 0.2608841561498242, 'support': 3809899}, 'weighted avg': {'precision': 0.504461654250757, 'recall': 0.49096209637053373, 'f1-score': 0.3507425677049418, 'support': 3809899}}
[[  51946  914573    2955]
 [  41534 1801115   12487]
 [   9348  958486   17455]]
Evaluating performance on  train set...
6147/6147 - 96s - 96s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2081407
{'0': {'precision': 0.5741627975896474, 'recall': 0.04474300054656166, 'f1-score': 0.08301672546527072, 'support': 519612}, '1': {'precision': 0.3317178460315322, 'recall': 0.9719889411284516, 'f1-score': 0.4946297451131292, 'support': 519402}, '2': {'precision': 0.6162054621088805, 'recall': 0.012749054672751187, 'f1-score': 0.024981256725123687, 'support': 534471}, 'accuracy': 0.3399562118482223, 'macro avg': {'precision': 0.5073620352433533, 'recall': 0.3431603321159214, 'f1-score': 0.2008759091011745, 'support': 1573485}, 'weighted avg': {'precision': 0.5084133256970466, 'recall': 0.3399562118482223, 'f1-score': 0.19917566604501688, 'support': 1573485}}
[[ 23249 494988   1375]
 [ 11680 504853   2869]
 [  5563 522094   6814]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1762904
{'0': {'precision': 0.5396587420575426, 'recall': 0.04291813815109637, 'f1-score': 0.07951276211914818, 'support': 176126}, '1': {'precision': 0.35971506466426434, 'recall': 0.9690546162742378, 'f1-score': 0.5246711284232326, 'support': 199739}, '2': {'precision': 0.6040816326530613, 'recall': 0.014747645857206915, 'f1-score': 0.02879237391177472, 'support': 180639}, 'accuracy': 0.36618065638342223, 'macro avg': {'precision': 0.501151813124956, 'recall': 0.34224013342751375, 'f1-score': 0.21099208815138515, 'support': 556504}, 'weighted avg': {'precision': 0.4959852309155344, 'recall': 0.36618065638342223, 'f1-score': 0.22282423287554848, 'support': 556504}}
[[  7559 168102    465]
 [  4900 193558   1281]
 [  1548 176427   2664]]
training model: results/AAPL/W2/deepVOL_L2/h100
Epoch 1/50
6147/6147 - 183s - loss: 3.2330 - accuracy100: 0.4059 - val_loss: 3.4113 - val_accuracy100: 0.3348 - 183s/epoch - 30ms/step
Epoch 2/50
6147/6147 - 186s - loss: 3.2276 - accuracy100: 0.4083 - val_loss: 3.3801 - val_accuracy100: 0.3322 - 186s/epoch - 30ms/step
Epoch 3/50
6147/6147 - 179s - loss: 3.2168 - accuracy100: 0.4136 - val_loss: 3.3947 - val_accuracy100: 0.3314 - 179s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 188s - loss: 3.2056 - accuracy100: 0.4190 - val_loss: 3.4288 - val_accuracy100: 0.3336 - 188s/epoch - 31ms/step
Epoch 5/50
6147/6147 - 197s - loss: 3.1971 - accuracy100: 0.4237 - val_loss: 3.4501 - val_accuracy100: 0.3328 - 197s/epoch - 32ms/step
Epoch 6/50
6147/6147 - 193s - loss: 3.1916 - accuracy100: 0.4264 - val_loss: 3.5181 - val_accuracy100: 0.3314 - 193s/epoch - 31ms/step
Epoch 7/50
6147/6147 - 196s - loss: 3.1872 - accuracy100: 0.4285 - val_loss: 3.4380 - val_accuracy100: 0.3396 - 196s/epoch - 32ms/step
Epoch 8/50
6147/6147 - 186s - loss: 3.1831 - accuracy100: 0.4304 - val_loss: 3.4469 - val_accuracy100: 0.3400 - 186s/epoch - 30ms/step
Epoch 9/50
6147/6147 - 206s - loss: 3.1802 - accuracy100: 0.4322 - val_loss: 3.4367 - val_accuracy100: 0.3432 - 206s/epoch - 33ms/step
Epoch 10/50
6147/6147 - 186s - loss: 3.1774 - accuracy100: 0.4336 - val_loss: 3.4241 - val_accuracy100: 0.3460 - 186s/epoch - 30ms/step
Epoch 11/50
6147/6147 - 191s - loss: 3.1748 - accuracy100: 0.4349 - val_loss: 3.4030 - val_accuracy100: 0.3483 - 191s/epoch - 31ms/step
Epoch 12/50
6147/6147 - 194s - loss: 3.1728 - accuracy100: 0.4356 - val_loss: 3.3950 - val_accuracy100: 0.3500 - 194s/epoch - 32ms/step
testing model: results/AAPL/W2/deepVOL_L2/h100
Evaluating performance on  test set...
14883/14883 - 258s - 258s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1043636
{'0': {'precision': 0.43199882445664517, 'recall': 0.08223947158954606, 'f1-score': 0.13817467630776506, 'support': 1179689}, '1': {'precision': 0.37076591136166803, 'recall': 0.9413786372621739, 'f1-score': 0.5320010036195688, 'support': 1408855}, '2': {'precision': 0.4788424124513619, 'recall': 0.00322428777873755, 'f1-score': 0.0064054444651380675, 'support': 1221355}, 'accuracy': 0.3746086182337117, 'macro avg': {'precision': 0.42720238275655836, 'recall': 0.3422807988768192, 'f1-score': 0.22552704146415728, 'support': 3809899}, 'weighted avg': {'precision': 0.42437246864953937, 'recall': 0.3746086182337117, 'f1-score': 0.24156512844513658, 'support': 3809899}}
[[  97017 1081337    1335]
 [  79638 1326266    2951]
 [  47922 1169495    3938]]
Evaluating performance on  train set...
6147/6147 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1293285
{'0': {'precision': 0.4321829900052137, 'recall': 0.07508031242351772, 'f1-score': 0.1279352705325273, 'support': 518911}, '1': {'precision': 0.3302971538265656, 'recall': 0.9418224821072256, 'f1-score': 0.4890755184696775, 'support': 519204}, '2': {'precision': 0.4739419377404687, 'recall': 0.002530959896893737, 'f1-score': 0.005035031557199631, 'support': 535370}, 'accuracy': 0.33639532629799457, 'macro avg': {'precision': 0.412140693857416, 'recall': 0.33981125147587904, 'f1-score': 0.2073486068531348, 'support': 1573485}, 'weighted avg': {'precision': 0.4127719083372758, 'recall': 0.33639532629799457, 'f1-score': 0.2052848228636515, 'support': 1573485}}
[[ 38960 479361    590]
 [ 29292 488998    914]
 [ 21895 512120   1355]]
Evaluating performance on  val set...
2174/2174 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1295536
{'0': {'precision': 0.44204251219365326, 'recall': 0.07927560177535879, 'f1-score': 0.13444070031499522, 'support': 185202}, '1': {'precision': 0.32535335350672234, 'recall': 0.9372172569789253, 'f1-score': 0.48302530565823154, 'support': 181260}, '2': {'precision': 0.47739130434782606, 'recall': 0.00288883509960956, 'f1-score': 0.005742918113728607, 'support': 190042}, 'accuracy': 0.33263193076779324, 'macro avg': {'precision': 0.41492905668273394, 'recall': 0.33979389795129783, 'f1-score': 0.20773630802898513, 'support': 556504}, 'weighted avg': {'precision': 0.4161068104825608, 'recall': 0.33263193076779324, 'f1-score': 0.20402952921725273, 'support': 556504}}
[[ 14682 170283    237]
 [ 11016 169880    364]
 [  7516 181977    549]]
training model: results/AAPL/W2/deepVOL_L2/h200
Epoch 1/50
6147/6147 - 181s - loss: 3.2447 - accuracy200: 0.3955 - val_loss: 3.5569 - val_accuracy200: 0.3527 - 181s/epoch - 30ms/step
Epoch 2/50
6147/6147 - 176s - loss: 3.2446 - accuracy200: 0.3968 - val_loss: 3.4714 - val_accuracy200: 0.3527 - 176s/epoch - 29ms/step
Epoch 3/50
6147/6147 - 182s - loss: 3.2388 - accuracy200: 0.4002 - val_loss: 3.5192 - val_accuracy200: 0.3526 - 182s/epoch - 30ms/step
Epoch 4/50
6147/6147 - 182s - loss: 3.2353 - accuracy200: 0.4021 - val_loss: 3.5194 - val_accuracy200: 0.3527 - 182s/epoch - 30ms/step
Epoch 5/50
6147/6147 - 182s - loss: 3.2319 - accuracy200: 0.4031 - val_loss: 3.5010 - val_accuracy200: 0.3527 - 182s/epoch - 30ms/step
Epoch 6/50
6147/6147 - 197s - loss: 3.2261 - accuracy200: 0.4066 - val_loss: 3.4612 - val_accuracy200: 0.3529 - 197s/epoch - 32ms/step
Epoch 7/50
6147/6147 - 182s - loss: 3.2209 - accuracy200: 0.4094 - val_loss: 3.4538 - val_accuracy200: 0.3531 - 182s/epoch - 30ms/step
Epoch 8/50
6147/6147 - 182s - loss: 3.2170 - accuracy200: 0.4112 - val_loss: 3.4378 - val_accuracy200: 0.3529 - 182s/epoch - 30ms/step
Epoch 9/50
6147/6147 - 181s - loss: 3.2130 - accuracy200: 0.4135 - val_loss: 3.4231 - val_accuracy200: 0.3531 - 181s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 187s - loss: 3.2108 - accuracy200: 0.4147 - val_loss: 3.4331 - val_accuracy200: 0.3532 - 187s/epoch - 30ms/step
Epoch 11/50
6147/6147 - 187s - loss: 3.2084 - accuracy200: 0.4163 - val_loss: 3.4293 - val_accuracy200: 0.3529 - 187s/epoch - 30ms/step
Epoch 12/50
6147/6147 - 183s - loss: 3.2060 - accuracy200: 0.4178 - val_loss: 3.4600 - val_accuracy200: 0.3528 - 183s/epoch - 30ms/step
Epoch 13/50
6147/6147 - 180s - loss: 3.2040 - accuracy200: 0.4185 - val_loss: 3.4635 - val_accuracy200: 0.3522 - 180s/epoch - 29ms/step
Epoch 14/50
6147/6147 - 181s - loss: 3.2022 - accuracy200: 0.4195 - val_loss: 3.4616 - val_accuracy200: 0.3515 - 181s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 175s - loss: 3.2004 - accuracy200: 0.4204 - val_loss: 3.4564 - val_accuracy200: 0.3515 - 175s/epoch - 28ms/step
Epoch 16/50
6147/6147 - 188s - loss: 3.1991 - accuracy200: 0.4212 - val_loss: 3.4464 - val_accuracy200: 0.3495 - 188s/epoch - 31ms/step
Epoch 17/50
6147/6147 - 183s - loss: 3.1970 - accuracy200: 0.4221 - val_loss: 3.4652 - val_accuracy200: 0.3506 - 183s/epoch - 30ms/step
Epoch 18/50
6147/6147 - 185s - loss: 3.1963 - accuracy200: 0.4226 - val_loss: 3.4641 - val_accuracy200: 0.3513 - 185s/epoch - 30ms/step
Epoch 19/50
6147/6147 - 189s - loss: 3.1947 - accuracy200: 0.4232 - val_loss: 3.4813 - val_accuracy200: 0.3504 - 189s/epoch - 31ms/step
testing model: results/AAPL/W2/deepVOL_L2/h200
Evaluating performance on  test set...
14883/14883 - 222s - 222s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941347
{'0': {'precision': 0.37064066691666425, 'recall': 0.011757105824932678, 'f1-score': 0.022791249607552033, 'support': 1092871}, '1': {'precision': 0.420153373672134, 'recall': 0.9907629287122351, 'f1-score': 0.5900738212525473, 'support': 1599966}, '2': {'precision': 0.41273885350318473, 'recall': 0.0008701397057638699, 'f1-score': 0.0017366182575394157, 'support': 1117062}, 'accuracy': 0.41969826496712903, 'macro avg': {'precision': 0.40117763136399437, 'recall': 0.33446339141431053, 'f1-score': 0.2048672297058796, 'support': 3809899}, 'weighted avg': {'precision': 0.4037766980506743, 'recall': 0.41969826496712903, 'f1-score': 0.25484818823491423, 'support': 3809899}}
[[  12849 1079367     655]
 [  14051 1585187     728]
 [   7767 1108323     972]]
Evaluating performance on  train set...
6147/6147 - 94s - 94s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1593634
{'0': {'precision': 0.4177027408872563, 'recall': 0.01140051015981537, 'f1-score': 0.022195237764560817, 'support': 518661}, '1': {'precision': 0.3302880858059126, 'recall': 0.9910359486184271, 'f1-score': 0.4954535873202875, 'support': 519408}, '2': {'precision': 0.46347305389221555, 'recall': 0.0007228024564077278, 'f1-score': 0.0014433539517875026, 'support': 535416}, 'accuracy': 0.3311451968083585, 'macro avg': {'precision': 0.4038212935284615, 'recall': 0.3343864204115501, 'f1-score': 0.17303072634554528, 'support': 1573485}, 'weighted avg': {'precision': 0.4044215763012403, 'recall': 0.3311451968083585, 'f1-score': 0.17135667381418382, 'support': 1573485}}
[[  5913 512509    239]
 [  4447 514752    209]
 [  3796 531233    387]]
Evaluating performance on  val set...
2174/2174 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1437721
{'0': {'precision': 0.3995701445877296, 'recall': 0.011518725674084839, 'f1-score': 0.022391941091128086, 'support': 177537}, '1': {'precision': 0.3525141996479576, 'recall': 0.9897791772390532, 'f1-score': 0.5198732564736611, 'support': 196266}, '2': {'precision': 0.40189873417721517, 'recall': 0.0006951248214295488, 'f1-score': 0.0013878492161930312, 'support': 182701}, 'accuracy': 0.3529750010781594, 'macro avg': {'precision': 0.38466102613763414, 'recall': 0.33399767591152246, 'f1-score': 0.18121768226032742, 'support': 556504}, 'weighted avg': {'precision': 0.38373908777059856, 'recall': 0.3529750010781594, 'f1-score': 0.19094634367444413, 'support': 556504}}
[[  2045 175399     93]
 [  1910 194260     96]
 [  1163 181411    127]]
training model: results/AAPL/W2/deepVOL_L2/h300
Epoch 1/50
6147/6147 - 190s - loss: 3.2418 - accuracy300: 0.3974 - val_loss: 3.3913 - val_accuracy300: 0.3299 - 190s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 190s - loss: 3.2366 - accuracy300: 0.3991 - val_loss: 3.4011 - val_accuracy300: 0.3299 - 190s/epoch - 31ms/step
Epoch 3/50
6147/6147 - 191s - loss: 3.2325 - accuracy300: 0.4025 - val_loss: 3.4223 - val_accuracy300: 0.3299 - 191s/epoch - 31ms/step
Epoch 4/50
6147/6147 - 195s - loss: 3.2238 - accuracy300: 0.4057 - val_loss: 3.4221 - val_accuracy300: 0.3299 - 195s/epoch - 32ms/step
Epoch 5/50
6147/6147 - 192s - loss: 3.2187 - accuracy300: 0.4073 - val_loss: 3.4507 - val_accuracy300: 0.3300 - 192s/epoch - 31ms/step
Epoch 6/50
6147/6147 - 194s - loss: 3.2141 - accuracy300: 0.4097 - val_loss: 3.4154 - val_accuracy300: 0.3302 - 194s/epoch - 32ms/step
Epoch 7/50
6147/6147 - 198s - loss: 3.2103 - accuracy300: 0.4127 - val_loss: 3.4426 - val_accuracy300: 0.3307 - 198s/epoch - 32ms/step
Epoch 8/50
6147/6147 - 191s - loss: 3.2082 - accuracy300: 0.4137 - val_loss: 3.4164 - val_accuracy300: 0.3304 - 191s/epoch - 31ms/step
Epoch 9/50
6147/6147 - 174s - loss: 3.2044 - accuracy300: 0.4166 - val_loss: 3.4306 - val_accuracy300: 0.3301 - 174s/epoch - 28ms/step
Epoch 10/50
6147/6147 - 189s - loss: 3.2026 - accuracy300: 0.4179 - val_loss: 3.4009 - val_accuracy300: 0.3304 - 189s/epoch - 31ms/step
Epoch 11/50
6147/6147 - 183s - loss: 3.1997 - accuracy300: 0.4192 - val_loss: 3.4215 - val_accuracy300: 0.3304 - 183s/epoch - 30ms/step
testing model: results/AAPL/W2/deepVOL_L2/h300
Evaluating performance on  test set...
14883/14883 - 255s - 255s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.118028
{'0': {'precision': 0.375, 'recall': 7.469102811370299e-06, 'f1-score': 1.493790809535033e-05, 'support': 1204964}, '1': {'precision': 0.35767714665030215, 'recall': 0.9999926616922725, 'f1-score': 0.5268947128491828, 'support': 1362712}, '2': {'precision': 0.4444444444444444, 'recall': 3.2200337620539953e-06, 'f1-score': 6.440020865667605e-06, 'support': 1242223}, 'accuracy': 0.35767746074108525, 'macro avg': {'precision': 0.39237386369824884, 'recall': 0.333334450276282, 'f1-score': 0.17563869692604794, 'support': 3809899}, 'weighted avg': {'precision': 0.3914464795463705, 'recall': 0.35767746074108525, 'f1-score': 0.18846477229965033, 'support': 3809899}}
[[      9 1204953       2]
 [      7 1362702       3]
 [      8 1242211       4]]
Evaluating performance on  train set...
6147/6147 - 103s - 103s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322869
{'0': {'precision': 0.3, 'recall': 5.771406145393264e-06, 'f1-score': 1.1542590234199156e-05, 'support': 519804}, '1': {'precision': 0.33024822780675117, 'recall': 0.9999942267723809, 'f1-score': 0.49652049530030373, 'support': 519640}, '2': {'precision': 1.0, 'recall': 1.8725154061205038e-06, 'f1-score': 3.745023799626247e-06, 'support': 534041}, 'accuracy': 0.3302484612182512, 'macro avg': {'precision': 0.5434160759355837, 'recall': 0.33333395689797746, 'f1-score': 0.16551192763811254, 'support': 1573485}, 'weighted avg': {'precision': 0.5475694964346658, 'recall': 0.3302484612182512, 'f1-score': 0.16397989816151975, 'support': 1573485}}
[[     3 519801      0]
 [     3 519637      0]
 [     4 534036      1]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1321424
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 183369}, '1': {'precision': 0.3299131353571801, 'recall': 0.9999891066351485, 'f1-score': 0.49614104116222757, 'support': 183598}, '2': {'precision': 0.6666666666666666, 'recall': 1.055202941905802e-05, 'f1-score': 2.110372480742851e-05, 'support': 189537}, 'accuracy': 0.3299131722323649, 'macro avg': {'precision': 0.33219326734128224, 'recall': 0.33333321955485584, 'f1-score': 0.16538738162901165, 'support': 556504}, 'weighted avg': {'precision': 0.3358994577313147, 'recall': 0.3299131722323649, 'f1-score': 0.1636906523798418, 'support': 556504}}
[[     0 183368      1]
 [     2 183596      0]
 [     1 189534      2]]
training model: results/AAPL/W2/deepVOL_L2/h500
Epoch 1/50
6147/6147 - 190s - loss: 3.2569 - accuracy500: 0.3890 - val_loss: 3.4235 - val_accuracy500: 0.3253 - 190s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 188s - loss: 3.2568 - accuracy500: 0.3880 - val_loss: 3.4345 - val_accuracy500: 0.3253 - 188s/epoch - 31ms/step
Epoch 3/50
6147/6147 - 191s - loss: 3.2511 - accuracy500: 0.3917 - val_loss: 3.4099 - val_accuracy500: 0.3254 - 191s/epoch - 31ms/step
Epoch 4/50
6147/6147 - 184s - loss: 3.2440 - accuracy500: 0.3953 - val_loss: 3.4173 - val_accuracy500: 0.3255 - 184s/epoch - 30ms/step
Epoch 5/50
6147/6147 - 194s - loss: 3.2369 - accuracy500: 0.3986 - val_loss: 3.4133 - val_accuracy500: 0.3258 - 194s/epoch - 32ms/step
Epoch 6/50
6147/6147 - 198s - loss: 3.2300 - accuracy500: 0.4032 - val_loss: 3.4158 - val_accuracy500: 0.3256 - 198s/epoch - 32ms/step
Epoch 7/50
6147/6147 - 196s - loss: 3.2263 - accuracy500: 0.4054 - val_loss: 3.4189 - val_accuracy500: 0.3254 - 196s/epoch - 32ms/step
Epoch 8/50
6147/6147 - 191s - loss: 3.2225 - accuracy500: 0.4073 - val_loss: 3.4029 - val_accuracy500: 0.3254 - 191s/epoch - 31ms/step
Epoch 9/50
6147/6147 - 193s - loss: 3.2188 - accuracy500: 0.4097 - val_loss: 3.3910 - val_accuracy500: 0.3243 - 193s/epoch - 31ms/step
Epoch 10/50
6147/6147 - 188s - loss: 3.2156 - accuracy500: 0.4111 - val_loss: 3.3994 - val_accuracy500: 0.3243 - 188s/epoch - 31ms/step
Epoch 11/50
6147/6147 - 182s - loss: 3.2126 - accuracy500: 0.4127 - val_loss: 3.4245 - val_accuracy500: 0.3189 - 182s/epoch - 30ms/step
Epoch 12/50
6147/6147 - 194s - loss: 3.2106 - accuracy500: 0.4141 - val_loss: 3.4177 - val_accuracy500: 0.3196 - 194s/epoch - 32ms/step
Epoch 13/50
6147/6147 - 191s - loss: 3.2079 - accuracy500: 0.4150 - val_loss: 3.4287 - val_accuracy500: 0.3197 - 191s/epoch - 31ms/step
Epoch 14/50
6147/6147 - 189s - loss: 3.2059 - accuracy500: 0.4160 - val_loss: 3.4495 - val_accuracy500: 0.3203 - 189s/epoch - 31ms/step
Epoch 15/50
6147/6147 - 184s - loss: 3.2038 - accuracy500: 0.4172 - val_loss: 3.4382 - val_accuracy500: 0.3193 - 184s/epoch - 30ms/step
Epoch 16/50
6147/6147 - 178s - loss: 3.2016 - accuracy500: 0.4181 - val_loss: 3.4579 - val_accuracy500: 0.3200 - 178s/epoch - 29ms/step
Epoch 17/50
6147/6147 - 177s - loss: 3.2002 - accuracy500: 0.4189 - val_loss: 3.4755 - val_accuracy500: 0.3210 - 177s/epoch - 29ms/step
Epoch 18/50
6147/6147 - 182s - loss: 3.1983 - accuracy500: 0.4202 - val_loss: 3.4928 - val_accuracy500: 0.3205 - 182s/epoch - 30ms/step
Epoch 19/50
6147/6147 - 190s - loss: 3.1966 - accuracy500: 0.4207 - val_loss: 3.4898 - val_accuracy500: 0.3218 - 190s/epoch - 31ms/step
testing model: results/AAPL/W2/deepVOL_L2/h500
Evaluating performance on  test set...
14883/14883 - 232s - 232s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105443
{'0': {'precision': 0.28641273450824334, 'recall': 0.002168360868962656, 'f1-score': 0.004304136174051817, 'support': 1161707}, '1': {'precision': 0.38195155187736674, 'recall': 0.9974434149378791, 'f1-score': 0.5523799483261569, 'support': 1455066}, '2': {'precision': 0.3939393939393939, 'recall': 0.00042493416453920205, 'f1-score': 0.0008489525817284305, 'support': 1193126}, 'accuracy': 0.38173505386888207, 'macro avg': {'precision': 0.3541012267750013, 'recall': 0.33334556999046033, 'f1-score': 0.18584434569397904, 'support': 3809899}, 'weighted avg': {'precision': 0.356574210677158, 'recall': 0.38173505386888207, 'f1-score': 0.21254168008430788, 'support': 3809899}}
[[   2519 1158901     287]
 [   3227 1451346     493]
 [   3049 1189570     507]]
Evaluating performance on  train set...
6147/6147 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1276582
{'0': {'precision': 0.28327721661054994, 'recall': 0.0024305642491347615, 'f1-score': 0.004819774058769164, 'support': 519221}, '1': {'precision': 0.32979942949173247, 'recall': 0.9959738676863892, 'f1-score': 0.4955170149388131, 'support': 519357}, '2': {'precision': 0.40728476821192056, 'recall': 0.00045989302813386255, 'f1-score': 0.0009187486344818314, 'support': 534907}, 'accuracy': 0.32969745501228165, 'macro avg': {'precision': 0.3401204714380677, 'recall': 0.33295477498788595, 'f1-score': 0.16708517921068802, 'support': 1573485}, 'weighted avg': {'precision': 0.34078913716890713, 'recall': 0.32969745501228165, 'f1-score': 0.1654570607981456, 'support': 1573485}}
[[  1262 517777    182]
 [  1915 517266    176]
 [  1278 533383    246]]
Evaluating performance on  val set...
2174/2174 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1328126
{'0': {'precision': 0.24916666666666668, 'recall': 0.003243917654398004, 'f1-score': 0.006404455273233555, 'support': 184345}, '1': {'precision': 0.32465284046186843, 'recall': 0.9932835862114676, 'f1-score': 0.48935947306907873, 'support': 181049}, '2': {'precision': 0.4111111111111111, 'recall': 0.00038721155355554395, 'f1-score': 0.0007736943907156674, 'support': 191110}, 'accuracy': 0.3243552606989348, 'macro avg': {'precision': 0.3283102060798821, 'recall': 0.3323049051398071, 'f1-score': 0.16551254091100934, 'support': 556504}, 'weighted avg': {'precision': 0.32933841575962064, 'recall': 0.3243552606989348, 'f1-score': 0.16159189023266238, 'support': 556504}}
[[   598 183680     67]
 [  1177 179833     39]
 [   625 190411     74]]
training model: results/AAPL/W2/deepVOL_L2/h1000
Epoch 1/50
6147/6147 - 193s - loss: 3.2486 - accuracy1000: 0.3946 - val_loss: 3.4227 - val_accuracy1000: 0.3323 - 193s/epoch - 31ms/step
Epoch 2/50
6147/6147 - 194s - loss: 3.2521 - accuracy1000: 0.3890 - val_loss: 3.4265 - val_accuracy1000: 0.3323 - 194s/epoch - 31ms/step
Epoch 3/50
6147/6147 - 176s - loss: 3.2470 - accuracy1000: 0.3925 - val_loss: 3.4008 - val_accuracy1000: 0.3323 - 176s/epoch - 29ms/step
Epoch 4/50
6147/6147 - 184s - loss: 3.2468 - accuracy1000: 0.3895 - val_loss: 3.3844 - val_accuracy1000: 0.3323 - 184s/epoch - 30ms/step
Epoch 5/50
6147/6147 - 190s - loss: 3.2398 - accuracy1000: 0.3941 - val_loss: 3.4157 - val_accuracy1000: 0.3323 - 190s/epoch - 31ms/step
Epoch 6/50
6147/6147 - 181s - loss: 3.2339 - accuracy1000: 0.3959 - val_loss: 3.3397 - val_accuracy1000: 0.3323 - 181s/epoch - 29ms/step
Epoch 7/50
6147/6147 - 183s - loss: 3.2263 - accuracy1000: 0.4022 - val_loss: 3.3598 - val_accuracy1000: 0.3313 - 183s/epoch - 30ms/step
Epoch 8/50
6147/6147 - 175s - loss: 3.2165 - accuracy1000: 0.4088 - val_loss: 3.3791 - val_accuracy1000: 0.3274 - 175s/epoch - 28ms/step
Epoch 9/50
6147/6147 - 177s - loss: 3.2111 - accuracy1000: 0.4115 - val_loss: 3.3770 - val_accuracy1000: 0.3221 - 177s/epoch - 29ms/step
Epoch 10/50
6147/6147 - 178s - loss: 3.2048 - accuracy1000: 0.4149 - val_loss: 3.3890 - val_accuracy1000: 0.3187 - 178s/epoch - 29ms/step
Epoch 11/50
6147/6147 - 175s - loss: 3.2003 - accuracy1000: 0.4176 - val_loss: 3.4183 - val_accuracy1000: 0.3194 - 175s/epoch - 29ms/step
Epoch 12/50
6147/6147 - 177s - loss: 3.1966 - accuracy1000: 0.4193 - val_loss: 3.4273 - val_accuracy1000: 0.3197 - 177s/epoch - 29ms/step
Epoch 13/50
6147/6147 - 177s - loss: 3.1926 - accuracy1000: 0.4215 - val_loss: 3.3904 - val_accuracy1000: 0.3159 - 177s/epoch - 29ms/step
Epoch 14/50
6147/6147 - 178s - loss: 3.1889 - accuracy1000: 0.4235 - val_loss: 3.3795 - val_accuracy1000: 0.3152 - 178s/epoch - 29ms/step
Epoch 15/50
6147/6147 - 177s - loss: 3.1858 - accuracy1000: 0.4249 - val_loss: 3.3901 - val_accuracy1000: 0.3124 - 177s/epoch - 29ms/step
Epoch 16/50
6147/6147 - 185s - loss: 3.1827 - accuracy1000: 0.4262 - val_loss: 3.4031 - val_accuracy1000: 0.3158 - 185s/epoch - 30ms/step
testing model: results/AAPL/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
14883/14883 - 255s - 255s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034389
{'0': {'precision': 0.20833333333333334, 'recall': 8.39885842716258e-06, 'f1-score': 1.6797039689725084e-05, 'support': 1190638}, '1': {'precision': 0.3634262121027192, 'recall': 0.9999732778668515, 'f1-score': 0.5331034715103212, 'support': 1384620}, '2': {'precision': 0.32608695652173914, 'recall': 1.2149280641093242e-05, 'f1-score': 2.429765600512519e-05, 'support': 1234641}, 'accuracy': 0.36342380729777873, 'macro avg': {'precision': 0.2992821673192639, 'recall': 0.3333312753353066, 'f1-score': 0.17771485540200535, 'support': 3809899}, 'weighted avg': {'precision': 0.3028576640015804, 'recall': 0.36342380729777873, 'f1-score': 0.1937572956129994, 'support': 3809899}}
[[     10 1190611      17]
 [     23 1384583      14]
 [     15 1234611      15]]
Evaluating performance on  train set...
6147/6147 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1147674
{'0': {'precision': 0.15151515151515152, 'recall': 9.70668343981565e-06, 'f1-score': 1.9412123259217848e-05, 'support': 515109}, '1': {'precision': 0.33158576121711864, 'recall': 0.9999386686497137, 'f1-score': 0.4980237946483758, 'support': 521756}, '2': {'precision': 0.3225806451612903, 'recall': 1.863516082143789e-05, 'f1-score': 3.726816869809243e-05, 'support': 536620}, 'accuracy': 0.33158180726222364, 'macro avg': {'precision': 0.2685605192978535, 'recall': 0.333322336831325, 'f1-score': 0.16602682498011104, 'support': 1573485}, 'weighted avg': {'precision': 0.2695652671731022, 'recall': 0.33158180726222364, 'f1-score': 0.16516007537704183, 'support': 1573485}}
[[     5 515096      8]
 [    19 521724     13]
 [     9 536601     10]]
Evaluating performance on  val set...
2174/2174 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1139287
{'0': {'precision': 0.36363636363636365, 'recall': 2.1968848173290273e-05, 'f1-score': 4.393504204034335e-05, 'support': 182076}, '1': {'precision': 0.33228089784667025, 'recall': 0.9999675528348007, 'f1-score': 0.4988110379914837, 'support': 184916}, '2': {'precision': 0.6666666666666666, 'recall': 2.1106842838448225e-05, 'f1-score': 4.221234922276513e-05, 'support': 189512}, 'accuracy': 0.3322851228382905, 'macro avg': {'precision': 0.45419464271656684, 'recall': 0.3333368761752708, 'f1-score': 0.16629906179424894, 'support': 556504}, 'weighted avg': {'precision': 0.4564115305280874, 'recall': 0.3322851228382905, 'f1-score': 0.16577444396567437, 'support': 556504}}
[[     4 182072      0]
 [     4 184910      2]
 [     3 189505      4]]
training model: results/AAPL/W2/deepVOL_L3/h10
Epoch 1/50
6147/6147 - 254s - loss: 3.1418 - accuracy10: 0.4362 - val_loss: 3.2951 - val_accuracy10: 0.4087 - 254s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 255s - loss: 3.0480 - accuracy10: 0.4689 - val_loss: 3.1033 - val_accuracy10: 0.4627 - 255s/epoch - 42ms/step
Epoch 3/50
6147/6147 - 246s - loss: 2.9927 - accuracy10: 0.4882 - val_loss: 3.0365 - val_accuracy10: 0.4936 - 246s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 254s - loss: 2.9657 - accuracy10: 0.4964 - val_loss: 3.0299 - val_accuracy10: 0.4982 - 254s/epoch - 41ms/step
Epoch 5/50
6147/6147 - 251s - loss: 2.9448 - accuracy10: 0.5027 - val_loss: 2.9933 - val_accuracy10: 0.5062 - 251s/epoch - 41ms/step
Epoch 6/50
6147/6147 - 247s - loss: 2.9302 - accuracy10: 0.5068 - val_loss: 2.9667 - val_accuracy10: 0.5094 - 247s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 249s - loss: 2.9183 - accuracy10: 0.5096 - val_loss: 2.9557 - val_accuracy10: 0.5176 - 249s/epoch - 41ms/step
Epoch 8/50
6147/6147 - 255s - loss: 2.9064 - accuracy10: 0.5132 - val_loss: 2.9262 - val_accuracy10: 0.5200 - 255s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 247s - loss: 2.8969 - accuracy10: 0.5155 - val_loss: 2.9293 - val_accuracy10: 0.5199 - 247s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 254s - loss: 2.8890 - accuracy10: 0.5179 - val_loss: 2.9008 - val_accuracy10: 0.5274 - 254s/epoch - 41ms/step
Epoch 11/50
6147/6147 - 247s - loss: 2.8813 - accuracy10: 0.5202 - val_loss: 2.8995 - val_accuracy10: 0.5202 - 247s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 255s - loss: 2.8740 - accuracy10: 0.5223 - val_loss: 2.9035 - val_accuracy10: 0.5236 - 255s/epoch - 42ms/step
Epoch 13/50
6147/6147 - 255s - loss: 2.8679 - accuracy10: 0.5237 - val_loss: 2.8940 - val_accuracy10: 0.5201 - 255s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 257s - loss: 2.8624 - accuracy10: 0.5255 - val_loss: 2.8856 - val_accuracy10: 0.5265 - 257s/epoch - 42ms/step
Epoch 15/50
6147/6147 - 252s - loss: 2.8576 - accuracy10: 0.5265 - val_loss: 2.8764 - val_accuracy10: 0.5262 - 252s/epoch - 41ms/step
Epoch 16/50
6147/6147 - 257s - loss: 2.8523 - accuracy10: 0.5280 - val_loss: 2.8752 - val_accuracy10: 0.5257 - 257s/epoch - 42ms/step
Epoch 17/50
6147/6147 - 248s - loss: 2.8476 - accuracy10: 0.5289 - val_loss: 2.8886 - val_accuracy10: 0.5213 - 248s/epoch - 40ms/step
Epoch 18/50
6147/6147 - 255s - loss: 2.8441 - accuracy10: 0.5300 - val_loss: 2.8682 - val_accuracy10: 0.5277 - 255s/epoch - 41ms/step
Epoch 19/50
6147/6147 - 248s - loss: 2.8399 - accuracy10: 0.5308 - val_loss: 2.8766 - val_accuracy10: 0.5261 - 248s/epoch - 40ms/step
Epoch 20/50
6147/6147 - 247s - loss: 2.8363 - accuracy10: 0.5321 - val_loss: 2.8653 - val_accuracy10: 0.5292 - 247s/epoch - 40ms/step
Epoch 21/50
6147/6147 - 248s - loss: 2.8335 - accuracy10: 0.5324 - val_loss: 2.8787 - val_accuracy10: 0.5290 - 248s/epoch - 40ms/step
Epoch 22/50
6147/6147 - 254s - loss: 2.8302 - accuracy10: 0.5335 - val_loss: 2.8660 - val_accuracy10: 0.5250 - 254s/epoch - 41ms/step
Epoch 23/50
6147/6147 - 248s - loss: 2.8267 - accuracy10: 0.5341 - val_loss: 2.8755 - val_accuracy10: 0.5255 - 248s/epoch - 40ms/step
Epoch 24/50
6147/6147 - 256s - loss: 2.8244 - accuracy10: 0.5346 - val_loss: 2.8757 - val_accuracy10: 0.5224 - 256s/epoch - 42ms/step
Epoch 25/50
6147/6147 - 248s - loss: 2.8216 - accuracy10: 0.5357 - val_loss: 2.8532 - val_accuracy10: 0.5305 - 248s/epoch - 40ms/step
Epoch 26/50
6147/6147 - 258s - loss: 2.8196 - accuracy10: 0.5362 - val_loss: 2.8617 - val_accuracy10: 0.5308 - 258s/epoch - 42ms/step
Epoch 27/50
6147/6147 - 252s - loss: 2.8171 - accuracy10: 0.5367 - val_loss: 2.8656 - val_accuracy10: 0.5278 - 252s/epoch - 41ms/step
Epoch 28/50
6147/6147 - 258s - loss: 2.8147 - accuracy10: 0.5369 - val_loss: 2.8643 - val_accuracy10: 0.5303 - 258s/epoch - 42ms/step
Epoch 29/50
6147/6147 - 250s - loss: 2.8125 - accuracy10: 0.5377 - val_loss: 2.8725 - val_accuracy10: 0.5269 - 250s/epoch - 41ms/step
Epoch 30/50
6147/6147 - 252s - loss: 2.8103 - accuracy10: 0.5384 - val_loss: 2.8625 - val_accuracy10: 0.5280 - 252s/epoch - 41ms/step
Epoch 31/50
6147/6147 - 248s - loss: 2.8082 - accuracy10: 0.5389 - val_loss: 2.8577 - val_accuracy10: 0.5301 - 248s/epoch - 40ms/step
Epoch 32/50
6147/6147 - 254s - loss: 2.8063 - accuracy10: 0.5392 - val_loss: 2.8663 - val_accuracy10: 0.5296 - 254s/epoch - 41ms/step
Epoch 33/50
6147/6147 - 250s - loss: 2.8043 - accuracy10: 0.5397 - val_loss: 2.8631 - val_accuracy10: 0.5306 - 250s/epoch - 41ms/step
Epoch 34/50
6147/6147 - 269s - loss: 2.8023 - accuracy10: 0.5399 - val_loss: 2.8643 - val_accuracy10: 0.5273 - 269s/epoch - 44ms/step
Epoch 35/50
6147/6147 - 253s - loss: 2.8013 - accuracy10: 0.5404 - val_loss: 2.8670 - val_accuracy10: 0.5248 - 253s/epoch - 41ms/step
testing model: results/AAPL/W2/deepVOL_L3/h10
Evaluating performance on  test set...
14883/14883 - 279s - 279s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9640448
{'0': {'precision': 0.4930284371743806, 'recall': 0.5053876473643394, 'f1-score': 0.4991315460675835, 'support': 1124424}, '1': {'precision': 0.5690296485943465, 'recall': 0.4833521355654081, 'f1-score': 0.5227032622342673, 'support': 1521096}, '2': {'precision': 0.4825661798098475, 'recall': 0.5658028872042522, 'f1-score': 0.5208801869387204, 'support': 1164379}, 'accuracy': 0.5150540736119251, 'macro avg': {'precision': 0.5148747551928582, 'recall': 0.5181808900446666, 'f1-score': 0.5142383317468572, 'support': 3809899}, 'weighted avg': {'precision': 0.520174328946894, 'recall': 0.5150540736119251, 'f1-score': 0.515189321846724, 'support': 3809899}}
[[568270 272119 284035]
 [363495 735225 422376]
 [220846 284724 658809]]
Evaluating performance on  train set...
6147/6147 - 137s - 137s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9633049
{'0': {'precision': 0.5030206563675913, 'recall': 0.5226071178192915, 'f1-score': 0.5126268653093916, 'support': 484980}, '1': {'precision': 0.5613575936379156, 'recall': 0.4738583586473527, 'f1-score': 0.5139101408711467, 'support': 597495}, '2': {'precision': 0.49115978898131474, 'recall': 0.5654304392985886, 'f1-score': 0.5256847693956458, 'support': 491010}, 'accuracy': 0.5174590161329787, 'macro avg': {'precision': 0.5185126796622739, 'recall': 0.5206319719217443, 'f1-score': 0.5174072585253947, 'support': 1573485}, 'weighted avg': {'precision': 0.5214715623749551, 'recall': 0.5174590161329787, 'f1-score': 0.5171889121145169, 'support': 1573485}}
[[253454 108933 122593]
 [149334 283128 165033]
 [101076 112302 277632]]
Evaluating performance on  val set...
2174/2174 - 51s - 51s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95010436
{'0': {'precision': 0.5065763510528641, 'recall': 0.5090711068230113, 'f1-score': 0.5078206649779462, 'support': 168943}, '1': {'precision': 0.5967251257571372, 'recall': 0.5127946380797717, 'f1-score': 0.5515853883261095, 'support': 213058}, '2': {'precision': 0.49136703365776524, 'recall': 0.5734056148031839, 'f1-score': 0.5292258707730715, 'support': 174503}, 'accuracy': 0.5306700401075284, 'macro avg': {'precision': 0.5315561701559223, 'recall': 0.5317571199019889, 'f1-score': 0.5295439746923757, 'support': 556504}, 'weighted avg': {'precision': 0.5363206945392471, 'recall': 0.5306700401075284, 'f1-score': 0.5312880561449094, 'support': 556504}}
[[ 86004  35579  47360]
 [ 47586 109255  56217]
 [ 36185  38257 100061]]
training model: results/AAPL/W2/deepVOL_L3/h20
Epoch 1/50
6147/6147 - 244s - loss: 3.2062 - accuracy20: 0.4105 - val_loss: 3.2962 - val_accuracy20: 0.3659 - 244s/epoch - 40ms/step
Epoch 2/50
6147/6147 - 243s - loss: 3.1328 - accuracy20: 0.4457 - val_loss: 3.2312 - val_accuracy20: 0.3845 - 243s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 244s - loss: 3.0942 - accuracy20: 0.4614 - val_loss: 3.1645 - val_accuracy20: 0.4200 - 244s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 243s - loss: 3.0621 - accuracy20: 0.4745 - val_loss: 3.1241 - val_accuracy20: 0.4446 - 243s/epoch - 39ms/step
Epoch 5/50
6147/6147 - 246s - loss: 3.0416 - accuracy20: 0.4819 - val_loss: 3.1100 - val_accuracy20: 0.4528 - 246s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 242s - loss: 3.0267 - accuracy20: 0.4866 - val_loss: 3.0906 - val_accuracy20: 0.4603 - 242s/epoch - 39ms/step
Epoch 7/50
6147/6147 - 242s - loss: 3.0140 - accuracy20: 0.4902 - val_loss: 3.0812 - val_accuracy20: 0.4639 - 242s/epoch - 39ms/step
Epoch 8/50
6147/6147 - 243s - loss: 3.0045 - accuracy20: 0.4923 - val_loss: 3.0654 - val_accuracy20: 0.4770 - 243s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 244s - loss: 2.9962 - accuracy20: 0.4945 - val_loss: 3.0690 - val_accuracy20: 0.4725 - 244s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 246s - loss: 2.9895 - accuracy20: 0.4965 - val_loss: 3.0706 - val_accuracy20: 0.4672 - 246s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 247s - loss: 2.9838 - accuracy20: 0.4977 - val_loss: 3.0562 - val_accuracy20: 0.4743 - 247s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 252s - loss: 2.9786 - accuracy20: 0.4993 - val_loss: 3.0539 - val_accuracy20: 0.4735 - 252s/epoch - 41ms/step
Epoch 13/50
6147/6147 - 254s - loss: 2.9738 - accuracy20: 0.5000 - val_loss: 3.0751 - val_accuracy20: 0.4640 - 254s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 246s - loss: 2.9696 - accuracy20: 0.5014 - val_loss: 3.0600 - val_accuracy20: 0.4695 - 246s/epoch - 40ms/step
Epoch 15/50
6147/6147 - 245s - loss: 2.9656 - accuracy20: 0.5022 - val_loss: 3.0538 - val_accuracy20: 0.4744 - 245s/epoch - 40ms/step
Epoch 16/50
6147/6147 - 253s - loss: 2.9615 - accuracy20: 0.5035 - val_loss: 3.0716 - val_accuracy20: 0.4628 - 253s/epoch - 41ms/step
Epoch 17/50
6147/6147 - 247s - loss: 2.9585 - accuracy20: 0.5042 - val_loss: 3.0672 - val_accuracy20: 0.4667 - 247s/epoch - 40ms/step
Epoch 18/50
6147/6147 - 246s - loss: 2.9556 - accuracy20: 0.5049 - val_loss: 3.0603 - val_accuracy20: 0.4736 - 246s/epoch - 40ms/step
Epoch 19/50
6147/6147 - 249s - loss: 2.9522 - accuracy20: 0.5057 - val_loss: 3.0474 - val_accuracy20: 0.4757 - 249s/epoch - 41ms/step
Epoch 20/50
6147/6147 - 248s - loss: 2.9491 - accuracy20: 0.5065 - val_loss: 3.0531 - val_accuracy20: 0.4753 - 248s/epoch - 40ms/step
Epoch 21/50
6147/6147 - 249s - loss: 2.9476 - accuracy20: 0.5069 - val_loss: 3.0374 - val_accuracy20: 0.4821 - 249s/epoch - 41ms/step
Epoch 22/50
6147/6147 - 247s - loss: 2.9444 - accuracy20: 0.5076 - val_loss: 3.0500 - val_accuracy20: 0.4736 - 247s/epoch - 40ms/step
Epoch 23/50
6147/6147 - 249s - loss: 2.9427 - accuracy20: 0.5085 - val_loss: 3.0179 - val_accuracy20: 0.4877 - 249s/epoch - 41ms/step
Epoch 24/50
6147/6147 - 247s - loss: 2.9404 - accuracy20: 0.5090 - val_loss: 3.0555 - val_accuracy20: 0.4730 - 247s/epoch - 40ms/step
Epoch 25/50
6147/6147 - 246s - loss: 2.9388 - accuracy20: 0.5093 - val_loss: 3.0196 - val_accuracy20: 0.4868 - 246s/epoch - 40ms/step
Epoch 26/50
6147/6147 - 250s - loss: 2.9364 - accuracy20: 0.5099 - val_loss: 3.0474 - val_accuracy20: 0.4768 - 250s/epoch - 41ms/step
Epoch 27/50
6147/6147 - 254s - loss: 2.9344 - accuracy20: 0.5104 - val_loss: 3.0427 - val_accuracy20: 0.4794 - 254s/epoch - 41ms/step
Epoch 28/50
6147/6147 - 249s - loss: 2.9328 - accuracy20: 0.5110 - val_loss: 3.0413 - val_accuracy20: 0.4802 - 249s/epoch - 41ms/step
Epoch 29/50
6147/6147 - 250s - loss: 2.9309 - accuracy20: 0.5114 - val_loss: 3.0420 - val_accuracy20: 0.4782 - 250s/epoch - 41ms/step
Epoch 30/50
6147/6147 - 249s - loss: 2.9291 - accuracy20: 0.5122 - val_loss: 3.0405 - val_accuracy20: 0.4781 - 249s/epoch - 41ms/step
Epoch 31/50
6147/6147 - 247s - loss: 2.9282 - accuracy20: 0.5123 - val_loss: 3.0442 - val_accuracy20: 0.4746 - 247s/epoch - 40ms/step
Epoch 32/50
6147/6147 - 245s - loss: 2.9258 - accuracy20: 0.5127 - val_loss: 3.0514 - val_accuracy20: 0.4751 - 245s/epoch - 40ms/step
Epoch 33/50
6147/6147 - 256s - loss: 2.9251 - accuracy20: 0.5134 - val_loss: 3.0400 - val_accuracy20: 0.4781 - 256s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/h20
Evaluating performance on  test set...
14883/14883 - 299s - 299s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0114353
{'0': {'precision': 0.4834278172959603, 'recall': 0.48282188042463664, 'f1-score': 0.4831246588682638, 'support': 1206302}, '1': {'precision': 0.466081992734821, 'recall': 0.4323224917799698, 'f1-score': 0.44856794894944507, 'support': 1350360}, '2': {'precision': 0.4837726117677676, 'recall': 0.5221127368566361, 'f1-score': 0.5022119920362146, 'support': 1253237}, 'accuracy': 0.47784757548690926, 'macro avg': {'precision': 0.477760807266183, 'recall': 0.47908570302041414, 'f1-score': 0.47796819995130785, 'support': 3809899}, 'weighted avg': {'precision': 0.47739327452595104, 'recall': 0.47784757548690926, 'f1-score': 0.47715519704038517, 'support': 3809899}}
[[582429 318271 305602]
 [373943 583791 392626]
 [248418 350488 654331]]
Evaluating performance on  train set...
6147/6147 - 122s - 122s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0117091
{'0': {'precision': 0.4999631595192815, 'recall': 0.4816363018993886, 'f1-score': 0.4906286457997456, 'support': 521273}, '1': {'precision': 0.45575939886350686, 'recall': 0.42769612758439574, 'f1-score': 0.44128204345011535, 'support': 523575}, '2': {'precision': 0.4872496482661591, 'recall': 0.5345766565715226, 'f1-score': 0.5098171512175937, 'support': 528637}, 'accuracy': 0.48147392571266967, 'macro avg': {'precision': 0.48099073554964916, 'recall': 0.48130302868510233, 'f1-score': 0.4805759468224849, 'support': 1573485}, 'weighted avg': {'precision': 0.4809831143115649, 'recall': 0.48147392571266967, 'f1-score': 0.4806553105683118, 'support': 1573485}}
[[251064 129717 140492]
 [142749 223931 156895]
 [108352 137688 282597]]
Evaluating performance on  val set...
2174/2174 - 51s - 51s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0059615
{'0': {'precision': 0.5025223981819696, 'recall': 0.46291567110195314, 'f1-score': 0.48190660923638645, 'support': 182476}, '1': {'precision': 0.48635206693777244, 'recall': 0.4457433972382357, 'f1-score': 0.4651631316805641, 'support': 186475}, '2': {'precision': 0.4776487896829958, 'recall': 0.5539287561382649, 'f1-score': 0.5129685131512031, 'support': 187553}, 'accuracy': 0.4878347684832454, 'macro avg': {'precision': 0.48884108493424594, 'recall': 0.4875292748261512, 'f1-score': 0.48667941802271786, 'support': 556504}, 'weighted avg': {'precision': 0.4887210914284338, 'recall': 0.4878347684832454, 'f1-score': 0.48676463952496235, 'support': 556504}}
[[ 84471  41582  56423]
 [ 46164  83120  57191]
 [ 37459  46203 103891]]
training model: results/AAPL/W2/deepVOL_L3/h30
Epoch 1/50
6147/6147 - 262s - loss: 3.1942 - accuracy30: 0.4205 - val_loss: 3.3275 - val_accuracy30: 0.3665 - 262s/epoch - 43ms/step
Epoch 2/50
6147/6147 - 260s - loss: 3.1571 - accuracy30: 0.4376 - val_loss: 3.2833 - val_accuracy30: 0.3690 - 260s/epoch - 42ms/step
Epoch 3/50
6147/6147 - 255s - loss: 3.1420 - accuracy30: 0.4447 - val_loss: 3.3306 - val_accuracy30: 0.3784 - 255s/epoch - 42ms/step
Epoch 4/50
6147/6147 - 259s - loss: 3.1279 - accuracy30: 0.4511 - val_loss: 3.2224 - val_accuracy30: 0.3999 - 259s/epoch - 42ms/step
Epoch 5/50
6147/6147 - 258s - loss: 3.1122 - accuracy30: 0.4584 - val_loss: 3.1870 - val_accuracy30: 0.4143 - 258s/epoch - 42ms/step
Epoch 6/50
6147/6147 - 263s - loss: 3.1002 - accuracy30: 0.4633 - val_loss: 3.1754 - val_accuracy30: 0.4236 - 263s/epoch - 43ms/step
Epoch 7/50
6147/6147 - 251s - loss: 3.0884 - accuracy30: 0.4666 - val_loss: 3.1859 - val_accuracy30: 0.4171 - 251s/epoch - 41ms/step
Epoch 8/50
6147/6147 - 262s - loss: 3.0798 - accuracy30: 0.4696 - val_loss: 3.1757 - val_accuracy30: 0.4186 - 262s/epoch - 43ms/step
Epoch 9/50
6147/6147 - 256s - loss: 3.0726 - accuracy30: 0.4721 - val_loss: 3.1848 - val_accuracy30: 0.4229 - 256s/epoch - 42ms/step
Epoch 10/50
6147/6147 - 259s - loss: 3.0670 - accuracy30: 0.4735 - val_loss: 3.1632 - val_accuracy30: 0.4232 - 259s/epoch - 42ms/step
Epoch 11/50
6147/6147 - 245s - loss: 3.0633 - accuracy30: 0.4746 - val_loss: 3.1738 - val_accuracy30: 0.4180 - 245s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 265s - loss: 3.0595 - accuracy30: 0.4755 - val_loss: 3.1601 - val_accuracy30: 0.4269 - 265s/epoch - 43ms/step
Epoch 13/50
6147/6147 - 269s - loss: 3.0563 - accuracy30: 0.4766 - val_loss: 3.1574 - val_accuracy30: 0.4275 - 269s/epoch - 44ms/step
Epoch 14/50
6147/6147 - 263s - loss: 3.0517 - accuracy30: 0.4779 - val_loss: 3.1778 - val_accuracy30: 0.4183 - 263s/epoch - 43ms/step
Epoch 15/50
6147/6147 - 258s - loss: 3.0487 - accuracy30: 0.4788 - val_loss: 3.1685 - val_accuracy30: 0.4193 - 258s/epoch - 42ms/step
Epoch 16/50
6147/6147 - 256s - loss: 3.0453 - accuracy30: 0.4794 - val_loss: 3.1638 - val_accuracy30: 0.4231 - 256s/epoch - 42ms/step
Epoch 17/50
6147/6147 - 251s - loss: 3.0426 - accuracy30: 0.4805 - val_loss: 3.1583 - val_accuracy30: 0.4235 - 251s/epoch - 41ms/step
Epoch 18/50
6147/6147 - 256s - loss: 3.0403 - accuracy30: 0.4808 - val_loss: 3.1737 - val_accuracy30: 0.4198 - 256s/epoch - 42ms/step
Epoch 19/50
6147/6147 - 253s - loss: 3.0378 - accuracy30: 0.4813 - val_loss: 3.1777 - val_accuracy30: 0.4180 - 253s/epoch - 41ms/step
Epoch 20/50
6147/6147 - 258s - loss: 3.0356 - accuracy30: 0.4820 - val_loss: 3.1524 - val_accuracy30: 0.4284 - 258s/epoch - 42ms/step
Epoch 21/50
6147/6147 - 248s - loss: 3.0335 - accuracy30: 0.4826 - val_loss: 3.1634 - val_accuracy30: 0.4247 - 248s/epoch - 40ms/step
Epoch 22/50
6147/6147 - 266s - loss: 3.0313 - accuracy30: 0.4833 - val_loss: 3.1611 - val_accuracy30: 0.4253 - 266s/epoch - 43ms/step
Epoch 23/50
6147/6147 - 259s - loss: 3.0295 - accuracy30: 0.4835 - val_loss: 3.1494 - val_accuracy30: 0.4262 - 259s/epoch - 42ms/step
Epoch 24/50
6147/6147 - 259s - loss: 3.0271 - accuracy30: 0.4843 - val_loss: 3.1509 - val_accuracy30: 0.4269 - 259s/epoch - 42ms/step
Epoch 25/50
6147/6147 - 248s - loss: 3.0255 - accuracy30: 0.4848 - val_loss: 3.1508 - val_accuracy30: 0.4314 - 248s/epoch - 40ms/step
Epoch 26/50
6147/6147 - 256s - loss: 3.0240 - accuracy30: 0.4852 - val_loss: 3.1479 - val_accuracy30: 0.4310 - 256s/epoch - 42ms/step
Epoch 27/50
6147/6147 - 246s - loss: 3.0220 - accuracy30: 0.4855 - val_loss: 3.1431 - val_accuracy30: 0.4324 - 246s/epoch - 40ms/step
Epoch 28/50
6147/6147 - 254s - loss: 3.0208 - accuracy30: 0.4861 - val_loss: 3.1485 - val_accuracy30: 0.4309 - 254s/epoch - 41ms/step
Epoch 29/50
6147/6147 - 249s - loss: 3.0193 - accuracy30: 0.4868 - val_loss: 3.1435 - val_accuracy30: 0.4291 - 249s/epoch - 40ms/step
Epoch 30/50
6147/6147 - 256s - loss: 3.0177 - accuracy30: 0.4869 - val_loss: 3.1481 - val_accuracy30: 0.4315 - 256s/epoch - 42ms/step
Epoch 31/50
6147/6147 - 259s - loss: 3.0166 - accuracy30: 0.4873 - val_loss: 3.1492 - val_accuracy30: 0.4339 - 259s/epoch - 42ms/step
Epoch 32/50
6147/6147 - 265s - loss: 3.0143 - accuracy30: 0.4878 - val_loss: 3.1524 - val_accuracy30: 0.4315 - 265s/epoch - 43ms/step
Epoch 33/50
6147/6147 - 258s - loss: 3.0132 - accuracy30: 0.4882 - val_loss: 3.1472 - val_accuracy30: 0.4314 - 258s/epoch - 42ms/step
Epoch 34/50
6147/6147 - 276s - loss: 3.0119 - accuracy30: 0.4889 - val_loss: 3.1415 - val_accuracy30: 0.4360 - 276s/epoch - 45ms/step
Epoch 35/50
6147/6147 - 269s - loss: 3.0107 - accuracy30: 0.4891 - val_loss: 3.1471 - val_accuracy30: 0.4332 - 269s/epoch - 44ms/step
Epoch 36/50
6147/6147 - 277s - loss: 3.0091 - accuracy30: 0.4894 - val_loss: 3.1566 - val_accuracy30: 0.4307 - 277s/epoch - 45ms/step
Epoch 37/50
6147/6147 - 268s - loss: 3.0076 - accuracy30: 0.4901 - val_loss: 3.1475 - val_accuracy30: 0.4340 - 268s/epoch - 44ms/step
Epoch 38/50
6147/6147 - 265s - loss: 3.0073 - accuracy30: 0.4899 - val_loss: 3.1458 - val_accuracy30: 0.4313 - 265s/epoch - 43ms/step
Epoch 39/50
6147/6147 - 259s - loss: 3.0054 - accuracy30: 0.4905 - val_loss: 3.1397 - val_accuracy30: 0.4354 - 259s/epoch - 42ms/step
Epoch 40/50
6147/6147 - 265s - loss: 3.0047 - accuracy30: 0.4908 - val_loss: 3.1445 - val_accuracy30: 0.4372 - 265s/epoch - 43ms/step
Epoch 41/50
6147/6147 - 258s - loss: 3.0030 - accuracy30: 0.4913 - val_loss: 3.1418 - val_accuracy30: 0.4348 - 258s/epoch - 42ms/step
Epoch 42/50
6147/6147 - 265s - loss: 3.0017 - accuracy30: 0.4916 - val_loss: 3.1456 - val_accuracy30: 0.4346 - 265s/epoch - 43ms/step
Epoch 43/50
6147/6147 - 258s - loss: 3.0011 - accuracy30: 0.4919 - val_loss: 3.1513 - val_accuracy30: 0.4328 - 258s/epoch - 42ms/step
Epoch 44/50
6147/6147 - 264s - loss: 3.0000 - accuracy30: 0.4924 - val_loss: 3.1416 - val_accuracy30: 0.4369 - 264s/epoch - 43ms/step
Epoch 45/50
6147/6147 - 250s - loss: 2.9985 - accuracy30: 0.4926 - val_loss: 3.1430 - val_accuracy30: 0.4360 - 250s/epoch - 41ms/step
Epoch 46/50
6147/6147 - 261s - loss: 2.9973 - accuracy30: 0.4928 - val_loss: 3.1520 - val_accuracy30: 0.4296 - 261s/epoch - 42ms/step
Epoch 47/50
6147/6147 - 258s - loss: 2.9965 - accuracy30: 0.4930 - val_loss: 3.1478 - val_accuracy30: 0.4337 - 258s/epoch - 42ms/step
Epoch 48/50
6147/6147 - 264s - loss: 2.9951 - accuracy30: 0.4937 - val_loss: 3.1408 - val_accuracy30: 0.4365 - 264s/epoch - 43ms/step
Epoch 49/50
6147/6147 - 256s - loss: 2.9942 - accuracy30: 0.4941 - val_loss: 3.1441 - val_accuracy30: 0.4403 - 256s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/h30
Evaluating performance on  test set...
14883/14883 - 281s - 281s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0425407
{'0': {'precision': 0.47783260157947977, 'recall': 0.3811681917974549, 'f1-score': 0.4240615145648701, 'support': 1176074}, '1': {'precision': 0.3986984296017904, 'recall': 0.6114344375792446, 'f1-score': 0.48266511859495637, 'support': 1404669}, '2': {'precision': 0.5062732118593876, 'recall': 0.2955597173995815, 'f1-score': 0.37322978881006164, 'support': 1229156}, 'accuracy': 0.4384457435748297, 'macro avg': {'precision': 0.46093474768021925, 'recall': 0.429387448925427, 'f1-score': 0.42665214065662943, 'support': 3809899}, 'weighted avg': {'precision': 0.4578322363602132, 'recall': 0.4384457435748297, 'f1-score': 0.4292686198365479, 'support': 3809899}}
[[448282 598461 129331]
 [320851 858863 224955]
 [169024 696843 363289]]
Evaluating performance on  train set...
6147/6147 - 114s - 114s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0499085
{'0': {'precision': 0.5115809052745335, 'recall': 0.3770987162596893, 'f1-score': 0.43416434442132, 'support': 522224}, '1': {'precision': 0.3644843363039216, 'recall': 0.6265656528668865, 'f1-score': 0.46087153752374477, 'support': 518873}, '2': {'precision': 0.5278379089198648, 'recall': 0.2940393096764014, 'f1-score': 0.3776843811899701, 'support': 532388}, 'accuracy': 0.431259910326441, 'macro avg': {'precision': 0.46796771683277333, 'recall': 0.43256789293432574, 'f1-score': 0.4242400877116783, 'support': 1573485}, 'weighted avg': {'precision': 0.4685748363417139, 'recall': 0.431259910326441, 'f1-score': 0.42386134613523696, 'support': 1573485}}
[[196930 266060  59234]
 [112968 325108  80797]
 [ 75046 300799 156543]]
Evaluating performance on  val set...
2174/2174 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0476035
{'0': {'precision': 0.5023653580135579, 'recall': 0.3620495929675365, 'f1-score': 0.42081912901522067, 'support': 181558}, '1': {'precision': 0.37891657617556646, 'recall': 0.6350944777853834, 'f1-score': 0.47464536827369597, 'support': 188457}, '2': {'precision': 0.5200932706671039, 'recall': 0.30618427896551537, 'f1-score': 0.38545010243792127, 'support': 186489}, 'accuracy': 0.43579381280278306, 'macro avg': {'precision': 0.4671250682854094, 'recall': 0.43444278323947844, 'f1-score': 0.42697153324227927, 'support': 556504}, 'weighted avg': {'precision': 0.466500878376403, 'recall': 0.43579381280278306, 'f1-score': 0.4271946396576608, 'support': 556504}}
[[ 65733  92236  23589]
 [ 39670 119688  29099]
 [ 25444 103945  57100]]
training model: results/AAPL/W2/deepVOL_L3/h50
Epoch 1/50
6147/6147 - 253s - loss: 3.2126 - accuracy50: 0.4135 - val_loss: 3.5367 - val_accuracy50: 0.3589 - 253s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 252s - loss: 3.1761 - accuracy50: 0.4348 - val_loss: 3.5481 - val_accuracy50: 0.3598 - 252s/epoch - 41ms/step
Epoch 3/50
6147/6147 - 264s - loss: 3.1603 - accuracy50: 0.4415 - val_loss: 3.5191 - val_accuracy50: 0.3607 - 264s/epoch - 43ms/step
Epoch 4/50
6147/6147 - 257s - loss: 3.1513 - accuracy50: 0.4467 - val_loss: 3.4912 - val_accuracy50: 0.3612 - 257s/epoch - 42ms/step
Epoch 5/50
6147/6147 - 257s - loss: 3.1395 - accuracy50: 0.4511 - val_loss: 3.4984 - val_accuracy50: 0.3621 - 257s/epoch - 42ms/step
Epoch 6/50
6147/6147 - 249s - loss: 3.1312 - accuracy50: 0.4545 - val_loss: 3.4765 - val_accuracy50: 0.3635 - 249s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 246s - loss: 3.1250 - accuracy50: 0.4571 - val_loss: 3.4692 - val_accuracy50: 0.3641 - 246s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 252s - loss: 3.1207 - accuracy50: 0.4587 - val_loss: 3.4594 - val_accuracy50: 0.3647 - 252s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 252s - loss: 3.1171 - accuracy50: 0.4598 - val_loss: 3.4564 - val_accuracy50: 0.3656 - 252s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 253s - loss: 3.1140 - accuracy50: 0.4613 - val_loss: 3.4554 - val_accuracy50: 0.3657 - 253s/epoch - 41ms/step
Epoch 11/50
6147/6147 - 252s - loss: 3.1114 - accuracy50: 0.4623 - val_loss: 3.4543 - val_accuracy50: 0.3664 - 252s/epoch - 41ms/step
Epoch 12/50
6147/6147 - 254s - loss: 3.1091 - accuracy50: 0.4629 - val_loss: 3.4536 - val_accuracy50: 0.3667 - 254s/epoch - 41ms/step
Epoch 13/50
6147/6147 - 260s - loss: 3.1074 - accuracy50: 0.4637 - val_loss: 3.4466 - val_accuracy50: 0.3667 - 260s/epoch - 42ms/step
Epoch 14/50
6147/6147 - 254s - loss: 3.1053 - accuracy50: 0.4643 - val_loss: 3.4491 - val_accuracy50: 0.3666 - 254s/epoch - 41ms/step
Epoch 15/50
6147/6147 - 260s - loss: 3.1037 - accuracy50: 0.4649 - val_loss: 3.4500 - val_accuracy50: 0.3677 - 260s/epoch - 42ms/step
Epoch 16/50
6147/6147 - 255s - loss: 3.1016 - accuracy50: 0.4655 - val_loss: 3.4516 - val_accuracy50: 0.3677 - 255s/epoch - 41ms/step
Epoch 17/50
6147/6147 - 262s - loss: 3.1002 - accuracy50: 0.4662 - val_loss: 3.4483 - val_accuracy50: 0.3675 - 262s/epoch - 43ms/step
Epoch 18/50
6147/6147 - 254s - loss: 3.0985 - accuracy50: 0.4666 - val_loss: 3.4467 - val_accuracy50: 0.3680 - 254s/epoch - 41ms/step
Epoch 19/50
6147/6147 - 261s - loss: 3.0977 - accuracy50: 0.4670 - val_loss: 3.4442 - val_accuracy50: 0.3688 - 261s/epoch - 42ms/step
Epoch 20/50
6147/6147 - 252s - loss: 3.0957 - accuracy50: 0.4676 - val_loss: 3.4481 - val_accuracy50: 0.3685 - 252s/epoch - 41ms/step
Epoch 21/50
6147/6147 - 258s - loss: 3.0942 - accuracy50: 0.4681 - val_loss: 3.4556 - val_accuracy50: 0.3684 - 258s/epoch - 42ms/step
Epoch 22/50
6147/6147 - 254s - loss: 3.0930 - accuracy50: 0.4683 - val_loss: 3.4594 - val_accuracy50: 0.3680 - 254s/epoch - 41ms/step
Epoch 23/50
6147/6147 - 265s - loss: 3.0914 - accuracy50: 0.4690 - val_loss: 3.4587 - val_accuracy50: 0.3683 - 265s/epoch - 43ms/step
Epoch 24/50
6147/6147 - 266s - loss: 3.0901 - accuracy50: 0.4696 - val_loss: 3.4713 - val_accuracy50: 0.3683 - 266s/epoch - 43ms/step
Epoch 25/50
6147/6147 - 267s - loss: 3.0885 - accuracy50: 0.4699 - val_loss: 3.4745 - val_accuracy50: 0.3678 - 267s/epoch - 43ms/step
Epoch 26/50
6147/6147 - 259s - loss: 3.0876 - accuracy50: 0.4703 - val_loss: 3.4810 - val_accuracy50: 0.3676 - 259s/epoch - 42ms/step
Epoch 27/50
6147/6147 - 263s - loss: 3.0860 - accuracy50: 0.4704 - val_loss: 3.4773 - val_accuracy50: 0.3677 - 263s/epoch - 43ms/step
Epoch 28/50
6147/6147 - 252s - loss: 3.0846 - accuracy50: 0.4709 - val_loss: 3.4993 - val_accuracy50: 0.3680 - 252s/epoch - 41ms/step
Epoch 29/50
6147/6147 - 257s - loss: 3.0831 - accuracy50: 0.4711 - val_loss: 3.4959 - val_accuracy50: 0.3679 - 257s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/h50
Evaluating performance on  test set...
14883/14883 - 282s - 282s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0284227
{'0': {'precision': 0.4701437948284919, 'recall': 0.09878036956122599, 'f1-score': 0.16325893926440144, 'support': 969474}, '1': {'precision': 0.489965181844915, 'recall': 0.9448487873665327, 'f1-score': 0.6453003913426033, 'support': 1855136}, '2': {'precision': 0.5304916208886725, 'recall': 0.015485811777052215, 'f1-score': 0.0300931609948612, 'support': 985289}, 'accuracy': 0.48921139379285383, 'macro avg': {'precision': 0.4968668658540265, 'recall': 0.35303832290160364, 'f1-score': 0.2795508305339553, 'support': 3809899}, 'weighted avg': {'precision': 0.4954020543821201, 'recall': 0.48921139379285383, 'f1-score': 0.3635387038295855, 'support': 3809899}}
[[  95765  872056    1653]
 [  90462 1752823   11851]
 [  17466  952565   15258]]
Evaluating performance on  train set...
6147/6147 - 115s - 115s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1788864
{'0': {'precision': 0.5633982283536921, 'recall': 0.08849680145955059, 'f1-score': 0.152966164419333, 'support': 519612}, '1': {'precision': 0.3323399702935435, 'recall': 0.9485831783474072, 'f1-score': 0.49222641599913686, 'support': 519402}, '2': {'precision': 0.6498931623931624, 'recall': 0.011381347163831153, 'f1-score': 0.02237092037783797, 'support': 534471}, 'accuracy': 0.34621429502028933, 'macro avg': {'precision': 0.5152104536801327, 'recall': 0.349487108990263, 'f1-score': 0.22252116693210258, 'support': 1573485}, 'weighted avg': {'precision': 0.5165067184492776, 'recall': 0.34621429502028933, 'f1-score': 0.22059507890720637, 'support': 1573485}}
[[ 45984 472820    808]
 [ 24237 492696   2469]
 [ 11398 516990   6083]]
Evaluating performance on  val set...
2174/2174 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.151449
{'0': {'precision': 0.5175050444263514, 'recall': 0.08300307734235718, 'f1-score': 0.1430605504587156, 'support': 176126}, '1': {'precision': 0.3587630006638637, 'recall': 0.9415537276145369, 'f1-score': 0.519557478972792, 'support': 199739}, '2': {'precision': 0.5934337200691188, 'recall': 0.013308311051323357, 'f1-score': 0.026032811738588988, 'support': 180639}, 'accuracy': 0.368529246869744, 'macro avg': {'precision': 0.4899005883864446, 'recall': 0.34595503866940586, 'f1-score': 0.2295502803900322, 'support': 556504}, 'weighted avg': {'precision': 0.48517590206683253, 'recall': 0.368529246869744, 'f1-score': 0.24020512859258017, 'support': 556504}}
[[ 14619 161213    294]
 [ 10321 188065   1353]
 [  3309 174926   2404]]
training model: results/AAPL/W2/deepVOL_L3/h100
Epoch 1/50
6147/6147 - 254s - loss: 3.2546 - accuracy100: 0.3880 - val_loss: 3.3848 - val_accuracy100: 0.3257 - 254s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 258s - loss: 3.2612 - accuracy100: 0.3803 - val_loss: 3.3846 - val_accuracy100: 0.3257 - 258s/epoch - 42ms/step
Epoch 3/50
6147/6147 - 253s - loss: 3.2429 - accuracy100: 0.3973 - val_loss: 3.3575 - val_accuracy100: 0.3262 - 253s/epoch - 41ms/step
Epoch 4/50
6147/6147 - 259s - loss: 3.2269 - accuracy100: 0.4093 - val_loss: 3.3575 - val_accuracy100: 0.3350 - 259s/epoch - 42ms/step
Epoch 5/50
6147/6147 - 257s - loss: 3.2220 - accuracy100: 0.4120 - val_loss: 3.3162 - val_accuracy100: 0.3382 - 257s/epoch - 42ms/step
Epoch 6/50
6147/6147 - 255s - loss: 3.2144 - accuracy100: 0.4160 - val_loss: 3.3491 - val_accuracy100: 0.3332 - 255s/epoch - 42ms/step
Epoch 7/50
6147/6147 - 256s - loss: 3.2065 - accuracy100: 0.4200 - val_loss: 3.3608 - val_accuracy100: 0.3342 - 256s/epoch - 42ms/step
Epoch 8/50
6147/6147 - 250s - loss: 3.2012 - accuracy100: 0.4227 - val_loss: 3.3695 - val_accuracy100: 0.3339 - 250s/epoch - 41ms/step
Epoch 9/50
6147/6147 - 250s - loss: 3.1936 - accuracy100: 0.4272 - val_loss: 3.3969 - val_accuracy100: 0.3333 - 250s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 253s - loss: 3.1884 - accuracy100: 0.4295 - val_loss: 3.3738 - val_accuracy100: 0.3348 - 253s/epoch - 41ms/step
Epoch 11/50
6147/6147 - 251s - loss: 3.1839 - accuracy100: 0.4317 - val_loss: 3.3673 - val_accuracy100: 0.3371 - 251s/epoch - 41ms/step
Epoch 12/50
6147/6147 - 251s - loss: 3.1811 - accuracy100: 0.4328 - val_loss: 3.3706 - val_accuracy100: 0.3377 - 251s/epoch - 41ms/step
Epoch 13/50
6147/6147 - 254s - loss: 3.1784 - accuracy100: 0.4343 - val_loss: 3.3689 - val_accuracy100: 0.3375 - 254s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 254s - loss: 3.1761 - accuracy100: 0.4353 - val_loss: 3.3659 - val_accuracy100: 0.3389 - 254s/epoch - 41ms/step
Epoch 15/50
6147/6147 - 258s - loss: 3.1740 - accuracy100: 0.4362 - val_loss: 3.3727 - val_accuracy100: 0.3393 - 258s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/h100
Evaluating performance on  test set...
14883/14883 - 282s - 282s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0896192
{'0': {'precision': 0.4265246025496898, 'recall': 0.15887746685779047, 'f1-score': 0.23151660011796568, 'support': 1179689}, '1': {'precision': 0.37021502111303317, 'recall': 0.8766487679711539, 'f1-score': 0.520583795895675, 'support': 1408855}, '2': {'precision': 0.42609504973532664, 'recall': 0.011994874545074937, 'f1-score': 0.02333291127043322, 'support': 1221355}, 'accuracy': 0.3772139366424149, 'macro avg': {'precision': 0.4076115577993498, 'recall': 0.34917370312467305, 'f1-score': 0.25847776909469133, 'support': 3809899}, 'weighted avg': {'precision': 0.40556429052238213, 'recall': 0.3772139366424149, 'f1-score': 0.2716718837134171, 'support': 3809899}}
[[ 187426  985743    6520]
 [ 160572 1235071   13212]
 [  91428 1115277   14650]]
Evaluating performance on  train set...
6147/6147 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1084344
{'0': {'precision': 0.43291060140265913, 'recall': 0.149526604754958, 'f1-score': 0.22227856224091952, 'support': 518911}, '1': {'precision': 0.3299165251328009, 'recall': 0.8792093281253611, 'f1-score': 0.47979403569585466, 'support': 519204}, '2': {'precision': 0.45039607695209355, 'recall': 0.008920933186394456, 'f1-score': 0.017495338605867678, 'support': 535370}, 'accuracy': 0.3424602077553965, 'macro avg': {'precision': 0.4044077344958512, 'recall': 0.3458856220222379, 'f1-score': 0.23985597884754728, 'support': 1573485}, 'weighted avg': {'precision': 0.4048749116244186, 'recall': 0.3424602077553965, 'f1-score': 0.23757471660031823, 'support': 1573485}}
[[ 77591 439049   2271]
 [ 59158 456489   3557]
 [ 42482 488112   4776]]
Evaluating performance on  val set...
2174/2174 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1074097
{'0': {'precision': 0.4375142757076944, 'recall': 0.15513871340482285, 'f1-score': 0.22905613597318164, 'support': 185202}, '1': {'precision': 0.3235617683407052, 'recall': 0.8680955533487807, 'f1-score': 0.471414939878874, 'support': 181260}, '2': {'precision': 0.4339080459770115, 'recall': 0.010329295629387189, 'f1-score': 0.020178242858464483, 'support': 190042}, 'accuracy': 0.3379059270014232, 'macro avg': {'precision': 0.3983280300084704, 'recall': 0.34452118746099697, 'f1-score': 0.24021643957017336, 'support': 556504}, 'weighted avg': {'precision': 0.3991670821640381, 'recall': 0.3379059270014232, 'f1-score': 0.23666503767494607, 'support': 556504}}
[[ 28732 155544    926]
 [ 22274 157351   1635]
 [ 14665 173414   1963]]
training model: results/AAPL/W2/deepVOL_L3/h200
Epoch 1/50
6147/6147 - 258s - loss: 3.2454 - accuracy200: 0.3915 - val_loss: 3.4949 - val_accuracy200: 0.3527 - 258s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 249s - loss: 3.2452 - accuracy200: 0.3923 - val_loss: 3.5144 - val_accuracy200: 0.3527 - 249s/epoch - 41ms/step
Epoch 3/50
6147/6147 - 247s - loss: 3.2502 - accuracy200: 0.3898 - val_loss: 3.4945 - val_accuracy200: 0.3527 - 247s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 248s - loss: 3.2437 - accuracy200: 0.3970 - val_loss: 3.4924 - val_accuracy200: 0.3527 - 248s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 249s - loss: 3.2382 - accuracy200: 0.4010 - val_loss: 3.4621 - val_accuracy200: 0.3527 - 249s/epoch - 41ms/step
Epoch 6/50
6147/6147 - 249s - loss: 3.2273 - accuracy200: 0.4073 - val_loss: 3.4242 - val_accuracy200: 0.3527 - 249s/epoch - 41ms/step
Epoch 7/50
6147/6147 - 247s - loss: 3.2166 - accuracy200: 0.4144 - val_loss: 3.4249 - val_accuracy200: 0.3526 - 247s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.2072 - accuracy200: 0.4193 - val_loss: 3.4048 - val_accuracy200: 0.3522 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 253s - loss: 3.2017 - accuracy200: 0.4223 - val_loss: 3.4418 - val_accuracy200: 0.3526 - 253s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 256s - loss: 3.1986 - accuracy200: 0.4238 - val_loss: 3.4207 - val_accuracy200: 0.3522 - 256s/epoch - 42ms/step
Epoch 11/50
6147/6147 - 247s - loss: 3.1959 - accuracy200: 0.4252 - val_loss: 3.4421 - val_accuracy200: 0.3525 - 247s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 248s - loss: 3.1937 - accuracy200: 0.4263 - val_loss: 3.4564 - val_accuracy200: 0.3525 - 248s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 250s - loss: 3.1919 - accuracy200: 0.4274 - val_loss: 3.4451 - val_accuracy200: 0.3527 - 250s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 248s - loss: 3.1903 - accuracy200: 0.4279 - val_loss: 3.4775 - val_accuracy200: 0.3530 - 248s/epoch - 40ms/step
Epoch 15/50
6147/6147 - 248s - loss: 3.1888 - accuracy200: 0.4285 - val_loss: 3.4931 - val_accuracy200: 0.3528 - 248s/epoch - 40ms/step
Epoch 16/50
6147/6147 - 247s - loss: 3.1873 - accuracy200: 0.4291 - val_loss: 3.4895 - val_accuracy200: 0.3522 - 247s/epoch - 40ms/step
Epoch 17/50
6147/6147 - 247s - loss: 3.1854 - accuracy200: 0.4298 - val_loss: 3.5076 - val_accuracy200: 0.3521 - 247s/epoch - 40ms/step
Epoch 18/50
6147/6147 - 247s - loss: 3.1842 - accuracy200: 0.4303 - val_loss: 3.5259 - val_accuracy200: 0.3524 - 247s/epoch - 40ms/step
testing model: results/AAPL/W2/deepVOL_L3/h200
Evaluating performance on  test set...
14883/14883 - 328s - 328s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931945
{'0': {'precision': 0.34942205560762263, 'recall': 0.0061407064511731025, 'f1-score': 0.012069308150424835, 'support': 1092871}, '1': {'precision': 0.4197280022412788, 'recall': 0.9944336317146739, 'f1-score': 0.590302595656672, 'support': 1599966}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1117062}, 'accuracy': 0.41937358444410205, 'macro avg': {'precision': 0.25638335261630046, 'recall': 0.33352477938861563, 'f1-score': 0.2007906346023656, 'support': 3809899}, 'weighted avg': {'precision': 0.276496506644383, 'recall': 0.41937358444410205, 'f1-score': 0.2513594926348666, 'support': 3809899}}
[[   6711 1086160       0]
 [   8906 1591060       0]
 [   3589 1113473       0]]
Evaluating performance on  train set...
6147/6147 - 137s - 137s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1531973
{'0': {'precision': 0.41641239762325355, 'recall': 0.004999411947302766, 'f1-score': 0.009880203014738381, 'support': 518661}, '1': {'precision': 0.3300401082655185, 'recall': 0.9958606721498321, 'f1-score': 0.4957745992890093, 'support': 519408}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 535416}, 'accuracy': 0.3303819229290397, 'macro avg': {'precision': 0.24881750196292404, 'recall': 0.3336200280323783, 'f1-score': 0.1685516007679159, 'support': 1573485}, 'weighted avg': {'precision': 0.24620656893306941, 'recall': 0.3303819229290397, 'f1-score': 0.1669121529873707, 'support': 1573485}}
[[  2593 516068      0]
 [  2150 517258      0]
 [  1484 533932      0]]
Evaluating performance on  val set...
2174/2174 - 51s - 51s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1377507
{'0': {'precision': 0.36850152905198774, 'recall': 0.005429854058590603, 'f1-score': 0.01070201439887207, 'support': 177537}, '1': {'precision': 0.3521704748974522, 'recall': 0.9938705634190333, 'f1-score': 0.5200612140973719, 'support': 196266}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 182701}, 'accuracy': 0.35224724350588676, 'macro avg': {'precision': 0.24022400131647995, 'recall': 0.333100139159208, 'f1-score': 0.17692107616541466, 'support': 556504}, 'weighted avg': {'precision': 0.24176240672039395, 'recall': 0.35224724350588676, 'f1-score': 0.18682765582343946, 'support': 556504}}
[[   964 176573      0]
 [  1203 195063      0]
 [   449 182252      0]]
training model: results/AAPL/W2/deepVOL_L3/h300
Epoch 1/50
6147/6147 - 257s - loss: 3.2377 - accuracy300: 0.3984 - val_loss: 3.3777 - val_accuracy300: 0.3301 - 257s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 251s - loss: 3.2487 - accuracy300: 0.3900 - val_loss: 3.3744 - val_accuracy300: 0.3299 - 251s/epoch - 41ms/step
Epoch 3/50
6147/6147 - 250s - loss: 3.2460 - accuracy300: 0.3930 - val_loss: 3.3848 - val_accuracy300: 0.3299 - 250s/epoch - 41ms/step
Epoch 4/50
6147/6147 - 247s - loss: 3.2364 - accuracy300: 0.4003 - val_loss: 3.3737 - val_accuracy300: 0.3299 - 247s/epoch - 40ms/step
Epoch 5/50
6147/6147 - 246s - loss: 3.2301 - accuracy300: 0.4034 - val_loss: 3.3615 - val_accuracy300: 0.3316 - 246s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 249s - loss: 3.2193 - accuracy300: 0.4103 - val_loss: 3.3688 - val_accuracy300: 0.3347 - 249s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 249s - loss: 3.2068 - accuracy300: 0.4173 - val_loss: 3.4014 - val_accuracy300: 0.3350 - 249s/epoch - 41ms/step
Epoch 8/50
6147/6147 - 246s - loss: 3.1973 - accuracy300: 0.4231 - val_loss: 3.4168 - val_accuracy300: 0.3397 - 246s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 249s - loss: 3.1905 - accuracy300: 0.4268 - val_loss: 3.4108 - val_accuracy300: 0.3332 - 249s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 250s - loss: 3.1855 - accuracy300: 0.4294 - val_loss: 3.4015 - val_accuracy300: 0.3333 - 250s/epoch - 41ms/step
Epoch 11/50
6147/6147 - 250s - loss: 3.1822 - accuracy300: 0.4306 - val_loss: 3.4159 - val_accuracy300: 0.3337 - 250s/epoch - 41ms/step
Epoch 12/50
6147/6147 - 249s - loss: 3.1792 - accuracy300: 0.4320 - val_loss: 3.4227 - val_accuracy300: 0.3316 - 249s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 251s - loss: 3.1772 - accuracy300: 0.4329 - val_loss: 3.4190 - val_accuracy300: 0.3346 - 251s/epoch - 41ms/step
Epoch 14/50
6147/6147 - 250s - loss: 3.1751 - accuracy300: 0.4335 - val_loss: 3.4247 - val_accuracy300: 0.3352 - 250s/epoch - 41ms/step
Epoch 15/50
6147/6147 - 268s - loss: 3.1734 - accuracy300: 0.4344 - val_loss: 3.4351 - val_accuracy300: 0.3309 - 268s/epoch - 44ms/step
testing model: results/AAPL/W2/deepVOL_L3/h300
Evaluating performance on  test set...
14883/14883 - 299s - 299s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118819
{'0': {'precision': 0.3583931804285012, 'recall': 0.049615590175308144, 'f1-score': 0.08716424960890173, 'support': 1204964}, '1': {'precision': 0.35791076604310024, 'recall': 0.9550139721379132, 'f1-score': 0.520684502941583, 'support': 1362712}, '2': {'precision': 0.3776947398677781, 'recall': 0.0021155621816694747, 'f1-score': 0.0042075567912096, 'support': 1242223}, 'accuracy': 0.35796801962466723, 'macro avg': {'precision': 0.3646662287797932, 'recall': 0.33558170816496363, 'f1-score': 0.2040187697805648, 'support': 3809899}, 'weighted avg': {'precision': 0.3645139330257166, 'recall': 0.35796801962466723, 'f1-score': 0.21517618368836494, 'support': 3809899}}
[[  59785 1143354    1825]
 [  58798 1301409    2505]
 [  48231 1191364    2628]]
Evaluating performance on  train set...
6147/6147 - 115s - 115s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228788
{'0': {'precision': 0.36937429145097184, 'recall': 0.05202537879662334, 'f1-score': 0.0912048052585339, 'support': 519804}, '1': {'precision': 0.3302328469502351, 'recall': 0.9518070202447848, 'f1-score': 0.4903403553749897, 'support': 519640}, '2': {'precision': 0.39647058823529413, 'recall': 0.0018931130755878295, 'f1-score': 0.0037682331608245388, 'support': 534041}, 'accuracy': 0.3321614124062193, 'macro avg': {'precision': 0.365359242212167, 'recall': 0.33524183737233204, 'f1-score': 0.19510446459811603, 'support': 1573485}, 'weighted avg': {'precision': 0.3656444009281092, 'recall': 0.3321614124062193, 'f1-score': 0.19334246965500565, 'support': 1573485}}
[[ 27043 492015    746]
 [ 24250 494597    793]
 [ 21920 511110   1011]]
Evaluating performance on  val set...
2174/2174 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228967
{'0': {'precision': 0.376611866885275, 'recall': 0.04634916479884822, 'f1-score': 0.08254020666614871, 'support': 183369}, '1': {'precision': 0.32955847467956834, 'recall': 0.9572108628634299, 'f1-score': 0.49030846898221836, 'support': 183598}, '2': {'precision': 0.4226190476190476, 'recall': 0.001498388177506239, 'f1-score': 0.0029861888764464353, 'support': 189537}, 'accuracy': 0.33157892845334447, 'macro avg': {'precision': 0.37626312972796366, 'recall': 0.3350194719465948, 'f1-score': 0.19194495484160448, 'support': 556504}, 'weighted avg': {'precision': 0.3767576956889381, 'recall': 0.33157892845334447, 'f1-score': 0.18997341029972362, 'support': 556504}}
[[  8499 174674    196]
 [  7664 175742    192]
 [  6404 182849    284]]
training model: results/AAPL/W2/deepVOL_L3/h500
Epoch 1/50
6147/6147 - 255s - loss: 3.2401 - accuracy500: 0.4007 - val_loss: 3.4291 - val_accuracy500: 0.3243 - 255s/epoch - 42ms/step
Epoch 2/50
6147/6147 - 249s - loss: 3.2194 - accuracy500: 0.4123 - val_loss: 3.3981 - val_accuracy500: 0.3167 - 249s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 247s - loss: 3.2035 - accuracy500: 0.4218 - val_loss: 3.4367 - val_accuracy500: 0.3059 - 247s/epoch - 40ms/step
Epoch 4/50
6147/6147 - 253s - loss: 3.1967 - accuracy500: 0.4261 - val_loss: 3.4375 - val_accuracy500: 0.3008 - 253s/epoch - 41ms/step
Epoch 5/50
6147/6147 - 248s - loss: 3.1931 - accuracy500: 0.4274 - val_loss: 3.4493 - val_accuracy500: 0.2987 - 248s/epoch - 40ms/step
Epoch 6/50
6147/6147 - 248s - loss: 3.1901 - accuracy500: 0.4288 - val_loss: 3.4400 - val_accuracy500: 0.3013 - 248s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 247s - loss: 3.1875 - accuracy500: 0.4302 - val_loss: 3.4507 - val_accuracy500: 0.3041 - 247s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 246s - loss: 3.1843 - accuracy500: 0.4314 - val_loss: 3.4516 - val_accuracy500: 0.3079 - 246s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 249s - loss: 3.1821 - accuracy500: 0.4324 - val_loss: 3.4600 - val_accuracy500: 0.3085 - 249s/epoch - 41ms/step
Epoch 10/50
6147/6147 - 247s - loss: 3.1797 - accuracy500: 0.4333 - val_loss: 3.4677 - val_accuracy500: 0.3045 - 247s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 248s - loss: 3.1769 - accuracy500: 0.4345 - val_loss: 3.4794 - val_accuracy500: 0.3067 - 248s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 257s - loss: 3.1749 - accuracy500: 0.4351 - val_loss: 3.4938 - val_accuracy500: 0.3079 - 257s/epoch - 42ms/step
testing model: results/AAPL/W2/deepVOL_L3/h500
Evaluating performance on  test set...
14883/14883 - 287s - 287s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1194011
{'0': {'precision': 0.293867475846455, 'recall': 0.38614211672994997, 'f1-score': 0.33374414243630757, 'support': 1161707}, '1': {'precision': 0.3741080672937277, 'recall': 0.5870386635382863, 'f1-score': 0.45698724824854015, 'support': 1455066}, '2': {'precision': 0.4093567251461988, 'recall': 5.866941127760186e-05, 'f1-score': 0.00011732200784884233, 'support': 1193126}, 'accuracy': 0.34196024619025334, 'macro avg': {'precision': 0.3591107560954605, 'recall': 0.32441314989317127, 'f1-score': 0.2636162375642322, 'support': 3809899}, 'weighted avg': {'precision': 0.36067989856286387, 'recall': 0.34196024619025334, 'f1-score': 0.2763326518039461, 'support': 3809899}}
[[448584 713084     39]
 [600824 854180     62]
 [477076 715980     70]]
Evaluating performance on  train set...
6147/6147 - 124s - 124s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1324382
{'0': {'precision': 0.3288022388937231, 'recall': 0.3769762779240439, 'f1-score': 0.35124516045095855, 'support': 519221}, '1': {'precision': 0.32402259198442607, 'recall': 0.6101949140956991, 'f1-score': 0.4232781689364854, 'support': 519357}, '2': {'precision': 0.3310344827586207, 'recall': 8.973522500172928e-05, 'f1-score': 0.00017942181320694064, 'support': 534907}, 'accuracy': 0.3258315141231089, 'macro avg': {'precision': 0.32795310454558996, 'recall': 0.32908697574824824, 'f1-score': 0.25823425040021697, 'support': 1573485}, 'weighted avg': {'precision': 0.3279834829406438, 'recall': 0.3258315141231089, 'f1-score': 0.25567597874952125, 'support': 1573485}}
[[195734 323444     43]
 [202394 316909     54]
 [197166 337693     48]]
Evaluating performance on  val set...
2174/2174 - 42s - 42s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1363487
{'0': {'precision': 0.32052153094567926, 'recall': 0.3761913802923866, 'f1-score': 0.346132345748026, 'support': 184345}, '1': {'precision': 0.31468484176666206, 'recall': 0.5911327872564885, 'f1-score': 0.4107240169779026, 'support': 181049}, '2': {'precision': 0.38095238095238093, 'recall': 8.372141698498247e-05, 'f1-score': 0.00016740604335816522, 'support': 191110}, 'accuracy': 0.31695908744591234, 'macro avg': {'precision': 0.3387195845549074, 'recall': 0.32246929632195337, 'f1-score': 0.25234125625642895, 'support': 556504}, 'weighted avg': {'precision': 0.3393753271548869, 'recall': 0.31695908744591234, 'f1-score': 0.24833771688199602, 'support': 556504}}
[[ 69349 114983     13]
 [ 74012 107024     13]
 [ 73002 118092     16]]
training model: results/AAPL/W2/deepVOL_L3/h1000
Epoch 1/50
6147/6147 - 252s - loss: 3.2370 - accuracy1000: 0.4012 - val_loss: 3.4600 - val_accuracy1000: 0.3327 - 252s/epoch - 41ms/step
Epoch 2/50
6147/6147 - 248s - loss: 3.2379 - accuracy1000: 0.3992 - val_loss: 3.4556 - val_accuracy1000: 0.3326 - 248s/epoch - 40ms/step
Epoch 3/50
6147/6147 - 250s - loss: 3.2252 - accuracy1000: 0.4081 - val_loss: 3.4165 - val_accuracy1000: 0.3306 - 250s/epoch - 41ms/step
Epoch 4/50
6147/6147 - 254s - loss: 3.2088 - accuracy1000: 0.4183 - val_loss: 3.4183 - val_accuracy1000: 0.3316 - 254s/epoch - 41ms/step
Epoch 5/50
6147/6147 - 253s - loss: 3.1850 - accuracy1000: 0.4309 - val_loss: 3.4606 - val_accuracy1000: 0.3194 - 253s/epoch - 41ms/step
Epoch 6/50
6147/6147 - 244s - loss: 3.1711 - accuracy1000: 0.4367 - val_loss: 3.5140 - val_accuracy1000: 0.3138 - 244s/epoch - 40ms/step
Epoch 7/50
6147/6147 - 245s - loss: 3.1613 - accuracy1000: 0.4411 - val_loss: 3.5428 - val_accuracy1000: 0.3133 - 245s/epoch - 40ms/step
Epoch 8/50
6147/6147 - 247s - loss: 3.1561 - accuracy1000: 0.4430 - val_loss: 3.5827 - val_accuracy1000: 0.3081 - 247s/epoch - 40ms/step
Epoch 9/50
6147/6147 - 247s - loss: 3.1521 - accuracy1000: 0.4446 - val_loss: 3.6054 - val_accuracy1000: 0.3125 - 247s/epoch - 40ms/step
Epoch 10/50
6147/6147 - 246s - loss: 3.1489 - accuracy1000: 0.4456 - val_loss: 3.5979 - val_accuracy1000: 0.3118 - 246s/epoch - 40ms/step
Epoch 11/50
6147/6147 - 245s - loss: 3.1463 - accuracy1000: 0.4466 - val_loss: 3.5792 - val_accuracy1000: 0.3133 - 245s/epoch - 40ms/step
Epoch 12/50
6147/6147 - 245s - loss: 3.1441 - accuracy1000: 0.4474 - val_loss: 3.5711 - val_accuracy1000: 0.3116 - 245s/epoch - 40ms/step
Epoch 13/50
6147/6147 - 254s - loss: 3.1425 - accuracy1000: 0.4481 - val_loss: 3.5757 - val_accuracy1000: 0.3115 - 254s/epoch - 41ms/step
testing model: results/AAPL/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
14883/14883 - 323s - 323s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127729
{'0': {'precision': 0.28929581257573717, 'recall': 0.00902289360830076, 'f1-score': 0.017499977601722793, 'support': 1190638}, '1': {'precision': 0.3629738726688792, 'recall': 0.9883838164983895, 'f1-score': 0.5309586121180695, 'support': 1384620}, '2': {'precision': 0.33002891367203635, 'recall': 0.0006471516821489, 'f1-score': 0.0012917703397242824, 'support': 1234641}, 'accuracy': 0.3622347994001941, 'macro avg': {'precision': 0.3274328663055509, 'recall': 0.33268462059627973, 'f1-score': 0.18325012001983887, 'support': 3809899}, 'weighted avg': {'precision': 0.32927242934085404, 'recall': 0.3622347994001941, 'f1-score': 0.1988522332131873, 'support': 3809899}}
[[  10743 1179151     744]
 [  15206 1368536     878]
 [  11186 1222656     799]]
Evaluating performance on  train set...
6147/6147 - 133s - 133s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1413687
{'0': {'precision': 0.31125064807880637, 'recall': 0.010489042125064792, 'f1-score': 0.020294177302673588, 'support': 515109}, '1': {'precision': 0.33094420435252353, 'recall': 0.9862943598156992, 'f1-score': 0.49559496820942295, 'support': 521756}, '2': {'precision': 0.379073756432247, 'recall': 0.0008236741083075547, 'f1-score': 0.0016437765207722031, 'support': 536620}, 'accuracy': 0.3307626065707649, 'macro avg': {'precision': 0.34042286962119234, 'recall': 0.3325356920163572, 'f1-score': 0.17251097401095625, 'support': 1573485}, 'weighted avg': {'precision': 0.3409112216157469, 'recall': 0.3307626065707649, 'f1-score': 0.17153989073035675, 'support': 1573485}}
[[  5403 509334    372]
 [  6799 514605    352]
 [  5157 531021    442]]
Evaluating performance on  val set...
2174/2174 - 47s - 47s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1415907
{'0': {'precision': 0.2890703337630712, 'recall': 0.011083283903424944, 'f1-score': 0.021348059050974044, 'support': 182076}, '1': {'precision': 0.33108357836666696, 'recall': 0.9833978671396743, 'f1-score': 0.49538452737206146, 'support': 184916}, '2': {'precision': 0.35251798561151076, 'recall': 0.0005171176495419815, 'f1-score': 0.0010327203751514832, 'support': 189512}, 'accuracy': 0.33056725558127165, 'macro avg': {'precision': 0.32422396591374963, 'recall': 0.33166608956421373, 'f1-score': 0.17258843559939566, 'support': 556504}, 'weighted avg': {'precision': 0.3246370368527525, 'recall': 0.33056725558127165, 'f1-score': 0.17194343143451438, 'support': 556504}}
[[  2018 179962     96]
 [  2986 181846     84]
 [  1977 187437     98]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :       137 (peak)  25.59 (ave)

============================================
