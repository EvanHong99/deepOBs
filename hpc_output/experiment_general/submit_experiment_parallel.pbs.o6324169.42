This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-26.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-18.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-05.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-14.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-10.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-12.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-28.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-13.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-04.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-06-19.csv
training model: results/XRAY/W4/deepLOB_L1/h10
Epoch 1/50
339/339 - 33s - loss: 3.2514 - accuracy10: 0.4021 - val_loss: 3.2892 - val_accuracy10: 0.3732 - 33s/epoch - 98ms/step
Epoch 2/50
339/339 - 6s - loss: 3.1662 - accuracy10: 0.4391 - val_loss: 3.3427 - val_accuracy10: 0.3898 - 6s/epoch - 19ms/step
Epoch 3/50
339/339 - 15s - loss: 3.1329 - accuracy10: 0.4564 - val_loss: 3.2652 - val_accuracy10: 0.4155 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 6s - loss: 3.1145 - accuracy10: 0.4626 - val_loss: 3.2968 - val_accuracy10: 0.4037 - 6s/epoch - 19ms/step
Epoch 5/50
339/339 - 6s - loss: 3.1030 - accuracy10: 0.4640 - val_loss: 3.2522 - val_accuracy10: 0.4233 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.0852 - accuracy10: 0.4706 - val_loss: 3.2362 - val_accuracy10: 0.4292 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.0696 - accuracy10: 0.4764 - val_loss: 3.1953 - val_accuracy10: 0.4363 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.0570 - accuracy10: 0.4803 - val_loss: 3.2046 - val_accuracy10: 0.4331 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.0497 - accuracy10: 0.4836 - val_loss: 3.2087 - val_accuracy10: 0.4268 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.0421 - accuracy10: 0.4864 - val_loss: 3.1985 - val_accuracy10: 0.4344 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.0355 - accuracy10: 0.4904 - val_loss: 3.1937 - val_accuracy10: 0.4390 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.0308 - accuracy10: 0.4902 - val_loss: 3.1644 - val_accuracy10: 0.4437 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.0225 - accuracy10: 0.4939 - val_loss: 3.1738 - val_accuracy10: 0.4430 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.0163 - accuracy10: 0.4945 - val_loss: 3.1756 - val_accuracy10: 0.4411 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.0112 - accuracy10: 0.4957 - val_loss: 3.1797 - val_accuracy10: 0.4435 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.0075 - accuracy10: 0.4958 - val_loss: 3.1708 - val_accuracy10: 0.4480 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.0037 - accuracy10: 0.4980 - val_loss: 3.1777 - val_accuracy10: 0.4399 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 2.9921 - accuracy10: 0.4996 - val_loss: 3.1743 - val_accuracy10: 0.4462 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 2.9932 - accuracy10: 0.5000 - val_loss: 3.1716 - val_accuracy10: 0.4491 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 2.9867 - accuracy10: 0.5027 - val_loss: 3.1672 - val_accuracy10: 0.4482 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 2.9817 - accuracy10: 0.5047 - val_loss: 3.1823 - val_accuracy10: 0.4445 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 2.9781 - accuracy10: 0.5038 - val_loss: 3.1907 - val_accuracy10: 0.4415 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h10
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0764397
{'0': {'precision': 0.4120677621978301, 'recall': 0.4659167539492374, 'f1-score': 0.43734091123351876, 'support': 69697}, '1': {'precision': 0.5823136587996184, 'recall': 0.24401647749986963, 'f1-score': 0.3439161216040763, 'support': 115066}, '2': {'precision': 0.35842345132040715, 'recall': 0.661847931267044, 'f1-score': 0.4650171000041205, 'support': 68206}, 'accuracy': 0.4178100874020137, 'macro avg': {'precision': 0.4509349574392852, 'recall': 0.4572603875720504, 'f1-score': 0.4154247109472385, 'support': 252969}, 'weighted avg': {'precision': 0.4750424763749659, 'recall': 0.4178100874020137, 'f1-score': 0.4023076276603783, 'support': 252969}}
[[32473 10402 26822]
 [33006 28078 53982]
 [13326  9738 45142]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.046774
{'0': {'precision': 0.4584508495563046, 'recall': 0.47493319080705504, 'f1-score': 0.4665464918882024, 'support': 28065}, '1': {'precision': 0.5124620060790274, 'recall': 0.3078787476343836, 'f1-score': 0.3846600572447837, 'support': 30119}, '2': {'precision': 0.4299900947349707, 'recall': 0.5970096621764581, 'f1-score': 0.4999187964152308, 'support': 28358}, 'accuracy': 0.45679554435996395, 'macro avg': {'precision': 0.46696765012343416, 'recall': 0.459940533539299, 'f1-score': 0.4503751151827389, 'support': 86542}, 'weighted avg': {'precision': 0.4679222269000741, 'recall': 0.45679554435996395, 'f1-score': 0.44898316179128234, 'support': 86542}}
[[13329  4415 10321]
 [ 8724  9273 12122]
 [ 7021  4407 16930]]
Evaluating performance on  val set...
124/124 - 1s - 978ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.055406
{'0': {'precision': 0.46643750596772654, 'recall': 0.45539293371865386, 'f1-score': 0.4608490566037736, 'support': 10727}, '1': {'precision': 0.4462311557788945, 'recall': 0.224469160768453, 'f1-score': 0.2986881937436932, 'support': 9890}, '2': {'precision': 0.42930862969410594, 'recall': 0.6326156665139716, 'f1-score': 0.5115004259417015, 'support': 10915}, 'accuracy': 0.4443105416719523, 'macro avg': {'precision': 0.4473257638135757, 'recall': 0.4374925870003595, 'f1-score': 0.4236792254297228, 'support': 31532}, 'weighted avg': {'precision': 0.44724739789040446, 'recall': 0.4443105416719523, 'f1-score': 0.42752065252655963, 'support': 31532}}
[[4885 1360 4482]
 [2973 2220 4697]
 [2615 1395 6905]]
training model: results/XRAY/W4/deepLOB_L1/h20
Epoch 1/50
339/339 - 8s - loss: 3.2762 - accuracy20: 0.3877 - val_loss: 3.3445 - val_accuracy20: 0.3588 - 8s/epoch - 23ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2152 - accuracy20: 0.4169 - val_loss: 3.3370 - val_accuracy20: 0.3693 - 6s/epoch - 17ms/step
Epoch 3/50
339/339 - 6s - loss: 3.1850 - accuracy20: 0.4310 - val_loss: 3.3389 - val_accuracy20: 0.3722 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 6s - loss: 3.1703 - accuracy20: 0.4374 - val_loss: 3.3347 - val_accuracy20: 0.3804 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.1602 - accuracy20: 0.4401 - val_loss: 3.3496 - val_accuracy20: 0.3721 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.1508 - accuracy20: 0.4463 - val_loss: 3.3372 - val_accuracy20: 0.3825 - 6s/epoch - 17ms/step
Epoch 7/50
339/339 - 6s - loss: 3.1475 - accuracy20: 0.4483 - val_loss: 3.3052 - val_accuracy20: 0.3884 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.1327 - accuracy20: 0.4535 - val_loss: 3.3301 - val_accuracy20: 0.3826 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.1238 - accuracy20: 0.4580 - val_loss: 3.3276 - val_accuracy20: 0.3883 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.1201 - accuracy20: 0.4600 - val_loss: 3.3278 - val_accuracy20: 0.3894 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.1131 - accuracy20: 0.4623 - val_loss: 3.3204 - val_accuracy20: 0.3885 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.1092 - accuracy20: 0.4637 - val_loss: 3.2910 - val_accuracy20: 0.3996 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.1108 - accuracy20: 0.4609 - val_loss: 3.2938 - val_accuracy20: 0.3977 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.1022 - accuracy20: 0.4649 - val_loss: 3.2569 - val_accuracy20: 0.4128 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.0970 - accuracy20: 0.4669 - val_loss: 3.2434 - val_accuracy20: 0.4175 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.0967 - accuracy20: 0.4670 - val_loss: 3.2455 - val_accuracy20: 0.4174 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.0930 - accuracy20: 0.4689 - val_loss: 3.2359 - val_accuracy20: 0.4222 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.0899 - accuracy20: 0.4687 - val_loss: 3.2340 - val_accuracy20: 0.4216 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.0847 - accuracy20: 0.4697 - val_loss: 3.2292 - val_accuracy20: 0.4240 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.0828 - accuracy20: 0.4715 - val_loss: 3.2310 - val_accuracy20: 0.4238 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.0788 - accuracy20: 0.4731 - val_loss: 3.2300 - val_accuracy20: 0.4191 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.0764 - accuracy20: 0.4744 - val_loss: 3.2249 - val_accuracy20: 0.4219 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.0731 - accuracy20: 0.4749 - val_loss: 3.2265 - val_accuracy20: 0.4227 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.0716 - accuracy20: 0.4740 - val_loss: 3.2283 - val_accuracy20: 0.4200 - 6s/epoch - 18ms/step
Epoch 25/50
339/339 - 6s - loss: 3.0658 - accuracy20: 0.4773 - val_loss: 3.2262 - val_accuracy20: 0.4219 - 6s/epoch - 18ms/step
Epoch 26/50
339/339 - 6s - loss: 3.0621 - accuracy20: 0.4787 - val_loss: 3.2316 - val_accuracy20: 0.4207 - 6s/epoch - 18ms/step
Epoch 27/50
339/339 - 6s - loss: 3.0578 - accuracy20: 0.4784 - val_loss: 3.2298 - val_accuracy20: 0.4218 - 6s/epoch - 18ms/step
Epoch 28/50
339/339 - 6s - loss: 3.0536 - accuracy20: 0.4807 - val_loss: 3.2439 - val_accuracy20: 0.4230 - 6s/epoch - 18ms/step
Epoch 29/50
339/339 - 6s - loss: 3.0480 - accuracy20: 0.4828 - val_loss: 3.2430 - val_accuracy20: 0.4163 - 6s/epoch - 18ms/step
Epoch 30/50
339/339 - 6s - loss: 3.0502 - accuracy20: 0.4830 - val_loss: 3.2583 - val_accuracy20: 0.4131 - 6s/epoch - 18ms/step
Epoch 31/50
339/339 - 6s - loss: 3.0439 - accuracy20: 0.4834 - val_loss: 3.2485 - val_accuracy20: 0.4182 - 6s/epoch - 18ms/step
Epoch 32/50
339/339 - 6s - loss: 3.0440 - accuracy20: 0.4829 - val_loss: 3.2514 - val_accuracy20: 0.4192 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h20
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0949904
{'0': {'precision': 0.39391251183811454, 'recall': 0.447688597626606, 'f1-score': 0.4190824798806229, 'support': 73397}, '1': {'precision': 0.5392007967135566, 'recall': 0.20034412899286766, 'f1-score': 0.29214104570226085, 'support': 108099}, '2': {'precision': 0.34689729261826924, 'recall': 0.6279853930855008, 'f1-score': 0.4469182515184706, 'support': 71473}, 'accuracy': 0.39293352149868166, 'macro avg': {'precision': 0.4266702003899801, 'recall': 0.4253393732349915, 'f1-score': 0.38604725903378484, 'support': 252969}, 'weighted avg': {'precision': 0.44271374654849566, 'recall': 0.39293352149868166, 'f1-score': 0.3727023463979635, 'support': 252969}}
[[32859  9234 31304]
 [33243 21657 53199]
 [17315  9274 44884]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0696776
{'0': {'precision': 0.4576256684491979, 'recall': 0.37254901960784315, 'f1-score': 0.41072799877131005, 'support': 28713}, '1': {'precision': 0.46924784539044134, 'recall': 0.2496613054503769, 'f1-score': 0.32591887173208167, 'support': 28787}, '2': {'precision': 0.40389960502392847, 'recall': 0.6654844707664761, 'f1-score': 0.5026985551350578, 'support': 29042}, 'accuracy': 0.42997619652885305, 'macro avg': {'precision': 0.44359103962118923, 'recall': 0.429231598608232, 'f1-score': 0.41311514187948317, 'support': 86542}, 'weighted avg': {'precision': 0.44346208629961625, 'recall': 0.42997619652885305, 'f1-score': 0.41338114473324405, 'support': 86542}}
[[10697  4009 14007]
 [ 7083  7187 14517]
 [ 5595  4120 19327]]
Evaluating performance on  val set...
124/124 - 1s - 944ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0750805
{'0': {'precision': 0.432263887749241, 'recall': 0.48096411941933714, 'f1-score': 0.45531547104580816, 'support': 10953}, '1': {'precision': 0.40708755211435377, 'recall': 0.1466108966108966, 'f1-score': 0.2155811386216685, 'support': 9324}, '2': {'precision': 0.4177769437668105, 'recall': 0.5934251443802754, 'f1-score': 0.49034578958960423, 'support': 11255}, 'accuracy': 0.42223772675377397, 'macro avg': {'precision': 0.4190427945434685, 'recall': 0.4070000534701697, 'f1-score': 0.38708079975236026, 'support': 31532}, 'weighted avg': {'precision': 0.41964830015625787, 'recall': 0.42223772675377397, 'f1-score': 0.39692980948573414, 'support': 31532}}
[[5268  929 4756]
 [3405 1367 4552]
 [3514 1062 6679]]
training model: results/XRAY/W4/deepLOB_L1/h30
Epoch 1/50
339/339 - 8s - loss: 3.2965 - accuracy30: 0.3758 - val_loss: 3.3449 - val_accuracy30: 0.3407 - 8s/epoch - 24ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2501 - accuracy30: 0.4004 - val_loss: 3.3326 - val_accuracy30: 0.3557 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2210 - accuracy30: 0.4142 - val_loss: 3.3530 - val_accuracy30: 0.3564 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2094 - accuracy30: 0.4178 - val_loss: 3.3579 - val_accuracy30: 0.3611 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.1998 - accuracy30: 0.4223 - val_loss: 3.3716 - val_accuracy30: 0.3642 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.1930 - accuracy30: 0.4273 - val_loss: 3.2854 - val_accuracy30: 0.3776 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.1861 - accuracy30: 0.4291 - val_loss: 3.3437 - val_accuracy30: 0.3678 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.1783 - accuracy30: 0.4334 - val_loss: 3.3381 - val_accuracy30: 0.3671 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.1749 - accuracy30: 0.4359 - val_loss: 3.3122 - val_accuracy30: 0.3853 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.1705 - accuracy30: 0.4368 - val_loss: 3.3104 - val_accuracy30: 0.3737 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.1680 - accuracy30: 0.4401 - val_loss: 3.2858 - val_accuracy30: 0.3889 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.1630 - accuracy30: 0.4412 - val_loss: 3.2827 - val_accuracy30: 0.3878 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.1605 - accuracy30: 0.4420 - val_loss: 3.3132 - val_accuracy30: 0.3829 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.1563 - accuracy30: 0.4449 - val_loss: 3.2792 - val_accuracy30: 0.3884 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1576 - accuracy30: 0.4440 - val_loss: 3.2857 - val_accuracy30: 0.3861 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1507 - accuracy30: 0.4457 - val_loss: 3.2759 - val_accuracy30: 0.3870 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.1547 - accuracy30: 0.4451 - val_loss: 3.2868 - val_accuracy30: 0.3888 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.1478 - accuracy30: 0.4470 - val_loss: 3.2809 - val_accuracy30: 0.3907 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.1457 - accuracy30: 0.4474 - val_loss: 3.2766 - val_accuracy30: 0.3861 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.1436 - accuracy30: 0.4499 - val_loss: 3.2828 - val_accuracy30: 0.3848 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.1409 - accuracy30: 0.4504 - val_loss: 3.2772 - val_accuracy30: 0.3889 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.1349 - accuracy30: 0.4520 - val_loss: 3.2988 - val_accuracy30: 0.3835 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.1329 - accuracy30: 0.4537 - val_loss: 3.3253 - val_accuracy30: 0.3790 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.1305 - accuracy30: 0.4544 - val_loss: 3.3147 - val_accuracy30: 0.3736 - 6s/epoch - 18ms/step
Epoch 25/50
339/339 - 6s - loss: 3.1293 - accuracy30: 0.4542 - val_loss: 3.3263 - val_accuracy30: 0.3713 - 6s/epoch - 18ms/step
Epoch 26/50
339/339 - 6s - loss: 3.1225 - accuracy30: 0.4563 - val_loss: 3.3099 - val_accuracy30: 0.3820 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h30
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1046447
{'0': {'precision': 0.40530270758430315, 'recall': 0.30674593451375365, 'f1-score': 0.34920355281509213, 'support': 77543}, '1': {'precision': 0.4501758962804854, 'recall': 0.11355161618377235, 'f1-score': 0.18135783498013483, 'support': 100298}, '2': {'precision': 0.33657823568051226, 'recall': 0.757054626770312, 'f1-score': 0.46598473645186006, 'support': 75128}, 'accuracy': 0.3638825310611182, 'macro avg': {'precision': 0.39735227984843363, 'recall': 0.39245072582261264, 'f1-score': 0.3321820414156957, 'support': 252969}, 'weighted avg': {'precision': 0.4026840426675018, 'recall': 0.3638825310611182, 'f1-score': 0.3173377785773498, 'support': 252969}}
[[23786  7873 45884]
 [22686 11389 66223]
 [12215  6037 56876]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0827941
{'0': {'precision': 0.4256605368843796, 'recall': 0.3458948814840261, 'f1-score': 0.38165450582772664, 'support': 29110}, '1': {'precision': 0.4407175558254695, 'recall': 0.16847030251080397, 'f1-score': 0.2437600124024598, 'support': 27999}, '2': {'precision': 0.38782002146251726, 'recall': 0.6875955560085618, 'f1-score': 0.49592609382849173, 'support': 29433}, 'accuracy': 0.4047052298306025, 'macro avg': {'precision': 0.41806603805745546, 'recall': 0.4006535800011306, 'f1-score': 0.3737802040195594, 'support': 86542}, 'weighted avg': {'precision': 0.4176623577681112, 'recall': 0.4047052298306025, 'f1-score': 0.3759052479900579, 'support': 86542}}
[[10069  3114 15927]
 [ 7263  4717 16019]
 [ 6323  2872 20238]]
Evaluating performance on  val set...
124/124 - 1s - 852ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0906732
{'0': {'precision': 0.41307966706302024, 'recall': 0.32196478220574604, 'f1-score': 0.36187500000000006, 'support': 10790}, '1': {'precision': 0.33420303605313095, 'recall': 0.1484251553776467, 'f1-score': 0.20555839229703118, 'support': 9493}, '2': {'precision': 0.3930498254522374, 'recall': 0.6605920526269001, 'f1-score': 0.4928535897861051, 'support': 11249}, 'accuracy': 0.39052391221616134, 'macro avg': {'precision': 0.3801108428561295, 'recall': 0.3769939967367643, 'f1-score': 0.35342899402771216, 'support': 31532}, 'weighted avg': {'precision': 0.3821875084160402, 'recall': 0.39052391221616134, 'f1-score': 0.36154088226498843, 'support': 31532}}
[[3474 1452 5864]
 [2473 1409 5611]
 [2463 1355 7431]]
training model: results/XRAY/W4/deepLOB_L1/h50
Epoch 1/50
339/339 - 8s - loss: 3.3104 - accuracy50: 0.3713 - val_loss: 3.3844 - val_accuracy50: 0.3440 - 8s/epoch - 24ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2638 - accuracy50: 0.3890 - val_loss: 3.4039 - val_accuracy50: 0.3464 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2616 - accuracy50: 0.3890 - val_loss: 3.3534 - val_accuracy50: 0.3359 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2620 - accuracy50: 0.3887 - val_loss: 3.3474 - val_accuracy50: 0.3437 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2435 - accuracy50: 0.3970 - val_loss: 3.3323 - val_accuracy50: 0.3431 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2373 - accuracy50: 0.4016 - val_loss: 3.3441 - val_accuracy50: 0.3495 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2326 - accuracy50: 0.4029 - val_loss: 3.3272 - val_accuracy50: 0.3387 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2256 - accuracy50: 0.4076 - val_loss: 3.3403 - val_accuracy50: 0.3398 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2204 - accuracy50: 0.4112 - val_loss: 3.4334 - val_accuracy50: 0.3444 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2203 - accuracy50: 0.4123 - val_loss: 3.3555 - val_accuracy50: 0.3561 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2180 - accuracy50: 0.4112 - val_loss: 3.3389 - val_accuracy50: 0.3450 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2051 - accuracy50: 0.4198 - val_loss: 3.3121 - val_accuracy50: 0.3509 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2017 - accuracy50: 0.4219 - val_loss: 3.3272 - val_accuracy50: 0.3517 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.1966 - accuracy50: 0.4255 - val_loss: 3.3397 - val_accuracy50: 0.3532 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1942 - accuracy50: 0.4275 - val_loss: 3.3502 - val_accuracy50: 0.3555 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1936 - accuracy50: 0.4278 - val_loss: 3.3797 - val_accuracy50: 0.3515 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.1904 - accuracy50: 0.4296 - val_loss: 3.4325 - val_accuracy50: 0.3393 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.1915 - accuracy50: 0.4265 - val_loss: 3.4280 - val_accuracy50: 0.3515 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.1868 - accuracy50: 0.4279 - val_loss: 3.4934 - val_accuracy50: 0.3514 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.1848 - accuracy50: 0.4292 - val_loss: 3.3985 - val_accuracy50: 0.3405 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.1791 - accuracy50: 0.4319 - val_loss: 3.4780 - val_accuracy50: 0.3230 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.1756 - accuracy50: 0.4337 - val_loss: 3.4186 - val_accuracy50: 0.3279 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h50
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862842
{'0': {'precision': 0.3543667534332645, 'recall': 0.16674175019709428, 'f1-score': 0.22677708103968217, 'support': 71032}, '1': {'precision': 0.4653988780070362, 'recall': 0.42257485236730324, 'f1-score': 0.44295423487995367, 'support': 115828}, '2': {'precision': 0.29463348954326085, 'recall': 0.5097490508100259, 'f1-score': 0.37342715461118653, 'support': 66109}, 'accuracy': 0.3735200755823836, 'macro avg': {'precision': 0.3714663736611872, 'recall': 0.36635521779147445, 'f1-score': 0.34771949017694076, 'support': 252969}, 'weighted avg': {'precision': 0.3895952699021859, 'recall': 0.3735200755823836, 'f1-score': 0.36408345885178384, 'support': 252969}}
[[11844 30502 28686]
 [14891 48946 51991]
 [ 6688 25722 33699]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011811
{'0': {'precision': 0.4164687252573238, 'recall': 0.1279271767076645, 'f1-score': 0.1957313345559897, 'support': 28782}, '1': {'precision': 0.3433490586834796, 'recall': 0.54490431375293, 'f1-score': 0.4212590438839678, 'support': 28583}, '2': {'precision': 0.37651133306533907, 'recall': 0.41731500839702507, 'f1-score': 0.39586449053904676, 'support': 29177}, 'accuracy': 0.36321092648656145, 'macro avg': {'precision': 0.3787763723353808, 'recall': 0.36338216628587316, 'f1-score': 0.33761828965966806, 'support': 86542}, 'weighted avg': {'precision': 0.3788474978571513, 'recall': 0.36321092648656145, 'f1-score': 0.3376918116404025, 'support': 86542}}
[[ 3682 15276  9824]
 [ 2669 15575 10339]
 [ 2490 14511 12176]]
Evaluating performance on  val set...
124/124 - 1s - 948ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1042311
{'0': {'precision': 0.391304347826087, 'recall': 0.1934926576446876, 'f1-score': 0.2589429066855051, 'support': 10419}, '1': {'precision': 0.33311262663047075, 'recall': 0.4873583260680035, 'f1-score': 0.39573664752615434, 'support': 10323}, '2': {'precision': 0.35913806863527536, 'recall': 0.3753475440222428, 'f1-score': 0.3670639416323017, 'support': 10790}, 'accuracy': 0.35192819992388685, 'macro avg': {'precision': 0.36118501436394435, 'recall': 0.3520661759116446, 'f1-score': 0.34058116528132043, 'support': 31532}, 'weighted avg': {'precision': 0.36124639747814824, 'recall': 0.35192819992388685, 'f1-score': 0.34072483468797743, 'support': 31532}}
[[2016 4840 3563]
 [1628 5031 3664]
 [1508 5232 4050]]
training model: results/XRAY/W4/deepLOB_L1/h100
Epoch 1/50
339/339 - 8s - loss: 3.3438 - accuracy100: 0.3473 - val_loss: 3.4084 - val_accuracy100: 0.3421 - 8s/epoch - 23ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3074 - accuracy100: 0.3549 - val_loss: 3.4101 - val_accuracy100: 0.3437 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2955 - accuracy100: 0.3589 - val_loss: 3.3931 - val_accuracy100: 0.3418 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2875 - accuracy100: 0.3621 - val_loss: 3.3709 - val_accuracy100: 0.3394 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2780 - accuracy100: 0.3707 - val_loss: 3.3784 - val_accuracy100: 0.3440 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2705 - accuracy100: 0.3763 - val_loss: 3.3622 - val_accuracy100: 0.3447 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2651 - accuracy100: 0.3820 - val_loss: 3.3935 - val_accuracy100: 0.3439 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2596 - accuracy100: 0.3850 - val_loss: 3.4034 - val_accuracy100: 0.3480 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2617 - accuracy100: 0.3826 - val_loss: 3.3964 - val_accuracy100: 0.3507 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2561 - accuracy100: 0.3881 - val_loss: 3.3814 - val_accuracy100: 0.3503 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2514 - accuracy100: 0.3922 - val_loss: 3.3990 - val_accuracy100: 0.3490 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2494 - accuracy100: 0.3917 - val_loss: 3.4002 - val_accuracy100: 0.3472 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2428 - accuracy100: 0.3956 - val_loss: 3.3890 - val_accuracy100: 0.3461 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2403 - accuracy100: 0.3989 - val_loss: 3.3543 - val_accuracy100: 0.3487 - 6s/epoch - 17ms/step
Epoch 15/50
339/339 - 6s - loss: 3.2347 - accuracy100: 0.4013 - val_loss: 3.4052 - val_accuracy100: 0.3472 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.2320 - accuracy100: 0.4043 - val_loss: 3.4362 - val_accuracy100: 0.3474 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.2292 - accuracy100: 0.4049 - val_loss: 3.3871 - val_accuracy100: 0.3478 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.2264 - accuracy100: 0.4074 - val_loss: 3.4198 - val_accuracy100: 0.3479 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.2251 - accuracy100: 0.4084 - val_loss: 3.4039 - val_accuracy100: 0.3490 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.2214 - accuracy100: 0.4103 - val_loss: 3.4099 - val_accuracy100: 0.3463 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.2178 - accuracy100: 0.4113 - val_loss: 3.4373 - val_accuracy100: 0.3414 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.2163 - accuracy100: 0.4121 - val_loss: 3.3799 - val_accuracy100: 0.3418 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.2132 - accuracy100: 0.4158 - val_loss: 3.4219 - val_accuracy100: 0.3445 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.2098 - accuracy100: 0.4163 - val_loss: 3.4001 - val_accuracy100: 0.3395 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h100
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211553
{'0': {'precision': 0.36763856812933027, 'recall': 0.061650550062328294, 'f1-score': 0.10559373153819844, 'support': 82627}, '1': {'precision': 0.3880007523039308, 'recall': 0.06599840042655292, 'f1-score': 0.11280826786723291, 'support': 93775}, '2': {'precision': 0.3089011570070173, 'recall': 0.9003225932843131, 'f1-score': 0.45998218390612855, 'support': 76567}, 'accuracy': 0.31710604856721575, 'macro avg': {'precision': 0.3548468258134261, 'recall': 0.3426571812577314, 'f1-score': 0.2261280611038533, 'support': 252969}, 'weighted avg': {'precision': 0.35740852596436545, 'recall': 0.31710604856721575, 'f1-score': 0.21553211836310784, 'support': 252969}}
[[ 5094  5904 71629]
 [ 4988  6189 82598]
 [ 3774  3858 68935]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020383
{'0': {'precision': 0.3646097261953412, 'recall': 0.15429045757963547, 'f1-score': 0.2168270632837562, 'support': 28913}, '1': {'precision': 0.4223863064272529, 'recall': 0.08878933258078171, 'f1-score': 0.14673390270207246, 'support': 28348}, '2': {'precision': 0.346901152923275, 'recall': 0.8097401045046275, 'f1-score': 0.48571633428591904, 'support': 29281}, 'accuracy': 0.3546023895911812, 'macro avg': {'precision': 0.3779657285152897, 'recall': 0.3509399648883482, 'f1-score': 0.28309243342391593, 'support': 86542}, 'weighted avg': {'precision': 0.37754362837503275, 'recall': 0.3546023895911812, 'f1-score': 0.2848442783705899, 'support': 86542}}
[[ 4461  1864 22588]
 [ 3781  2517 22050]
 [ 3993  1578 23710]]
Evaluating performance on  val set...
124/124 - 1s - 974ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.117882
{'0': {'precision': 0.33124720607957087, 'recall': 0.0708819590587335, 'f1-score': 0.11677566779607595, 'support': 10454}, '1': {'precision': 0.347027549540841, 'recall': 0.07019945248337896, 'f1-score': 0.11677644954053834, 'support': 10228}, '2': {'precision': 0.3470212297068978, 'recall': 0.8707834101382489, 'f1-score': 0.496270616661414, 'support': 10850}, 'accuracy': 0.34590257516174044, 'macro avg': {'precision': 0.3417653284424365, 'recall': 0.3372882738934538, 'f1-score': 0.24327424466600944, 'support': 31532}, 'weighted avg': {'precision': 0.3417936195413991, 'recall': 0.34590257516174044, 'f1-score': 0.24735819319475918, 'support': 31532}}
[[ 741  727 8986]
 [ 718  718 8792]
 [ 778  624 9448]]
training model: results/XRAY/W4/deepLOB_L1/h200
Epoch 1/50
339/339 - 8s - loss: 3.3333 - accuracy200: 0.3574 - val_loss: 3.4289 - val_accuracy200: 0.3476 - 8s/epoch - 24ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3023 - accuracy200: 0.3694 - val_loss: 3.3819 - val_accuracy200: 0.3464 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2839 - accuracy200: 0.3761 - val_loss: 3.3875 - val_accuracy200: 0.3498 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2724 - accuracy200: 0.3783 - val_loss: 3.3839 - val_accuracy200: 0.3527 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2584 - accuracy200: 0.3870 - val_loss: 3.4243 - val_accuracy200: 0.3487 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2520 - accuracy200: 0.3902 - val_loss: 3.3674 - val_accuracy200: 0.3495 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2449 - accuracy200: 0.3972 - val_loss: 3.3336 - val_accuracy200: 0.3474 - 6s/epoch - 19ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2389 - accuracy200: 0.3992 - val_loss: 3.3674 - val_accuracy200: 0.3503 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2298 - accuracy200: 0.4090 - val_loss: 3.3611 - val_accuracy200: 0.3488 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2242 - accuracy200: 0.4118 - val_loss: 3.3427 - val_accuracy200: 0.3496 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2124 - accuracy200: 0.4168 - val_loss: 3.3727 - val_accuracy200: 0.3494 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2152 - accuracy200: 0.4129 - val_loss: 3.3701 - val_accuracy200: 0.3500 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2040 - accuracy200: 0.4192 - val_loss: 3.3796 - val_accuracy200: 0.3466 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2011 - accuracy200: 0.4248 - val_loss: 3.3596 - val_accuracy200: 0.3478 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1926 - accuracy200: 0.4274 - val_loss: 3.3636 - val_accuracy200: 0.3456 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1890 - accuracy200: 0.4287 - val_loss: 3.3459 - val_accuracy200: 0.3445 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.1843 - accuracy200: 0.4314 - val_loss: 3.3210 - val_accuracy200: 0.3502 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.1791 - accuracy200: 0.4338 - val_loss: 3.3540 - val_accuracy200: 0.3487 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.1742 - accuracy200: 0.4358 - val_loss: 3.3554 - val_accuracy200: 0.3470 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.1738 - accuracy200: 0.4357 - val_loss: 3.3586 - val_accuracy200: 0.3474 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.1695 - accuracy200: 0.4394 - val_loss: 3.3388 - val_accuracy200: 0.3405 - 6s/epoch - 17ms/step
Epoch 22/50
339/339 - 6s - loss: 3.1628 - accuracy200: 0.4392 - val_loss: 3.3461 - val_accuracy200: 0.3448 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.1640 - accuracy200: 0.4381 - val_loss: 3.3384 - val_accuracy200: 0.3404 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.1712 - accuracy200: 0.4373 - val_loss: 3.3560 - val_accuracy200: 0.3456 - 6s/epoch - 18ms/step
Epoch 25/50
339/339 - 6s - loss: 3.1590 - accuracy200: 0.4422 - val_loss: 3.3661 - val_accuracy200: 0.3484 - 6s/epoch - 18ms/step
Epoch 26/50
339/339 - 6s - loss: 3.1562 - accuracy200: 0.4426 - val_loss: 3.3565 - val_accuracy200: 0.3443 - 6s/epoch - 18ms/step
Epoch 27/50
339/339 - 6s - loss: 3.1482 - accuracy200: 0.4449 - val_loss: 3.3565 - val_accuracy200: 0.3500 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h200
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.135501
{'0': {'precision': 0.28058007566204285, 'recall': 0.062237762237762236, 'f1-score': 0.10187728937728938, 'support': 78650}, '1': {'precision': 0.4040346675226549, 'recall': 0.16197301604585093, 'f1-score': 0.2312431989372677, 'support': 101023}, '2': {'precision': 0.28268828451882844, 'recall': 0.7521692861820564, 'f1-score': 0.4109347048300536, 'support': 73296}, 'accuracy': 0.3019698065770905, 'macro avg': {'precision': 0.32243434256784204, 'recall': 0.3254600214885565, 'f1-score': 0.24801839771487022, 'support': 252969}, 'weighted avg': {'precision': 0.3304924226685993, 'recall': 0.3019698065770905, 'f1-score': 0.24308670477800448, 'support': 252969}}
[[ 4895 11563 62192]
 [ 6959 16363 77701]
 [ 5592 12573 55131]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260452
{'0': {'precision': 0.3259338640538885, 'recall': 0.07453698841158142, 'f1-score': 0.12132782447642115, 'support': 28563}, '1': {'precision': 0.3542782795040563, 'recall': 0.16217068385650224, 'f1-score': 0.22249459264599858, 'support': 28544}, '2': {'precision': 0.3402844168260038, 'recall': 0.7739086121963649, 'f1-score': 0.47271708567219, 'support': 29435}, 'accuracy': 0.3413140440479767, 'macro avg': {'precision': 0.3401655201279829, 'recall': 0.3368720948214829, 'f1-score': 0.2721798342648699, 'support': 86542}, 'weighted avg': {'precision': 0.34016361972693515, 'recall': 0.3413140440479767, 'f1-score': 0.27421136234161814, 'support': 86542}}
[[ 2129  4123 22311]
 [ 2062  4629 21853]
 [ 2341  4314 22780]]
Evaluating performance on  val set...
124/124 - 1s - 793ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064984
{'0': {'precision': 0.3312009305030532, 'recall': 0.10977255204317656, 'f1-score': 0.16489323199420922, 'support': 10376}, '1': {'precision': 0.35189739985945184, 'recall': 0.19743716116313456, 'f1-score': 0.2529519479699438, 'support': 10145}, '2': {'precision': 0.3502522208829963, 'recall': 0.7125601671056216, 'f1-score': 0.46965162217167483, 'support': 11011}, 'accuracy': 0.34847139413928707, 'macro avg': {'precision': 0.3444501837485005, 'recall': 0.3399232934373109, 'f1-score': 0.2958322673786093, 'support': 31532}, 'weighted avg': {'precision': 0.34451246925715123, 'recall': 0.34847139413928707, 'f1-score': 0.2996468254173318, 'support': 31532}}
[[1139 1728 7509]
 [1096 2003 7046]
 [1204 1961 7846]]
training model: results/XRAY/W4/deepLOB_L1/h300
Epoch 1/50
339/339 - 8s - loss: 3.3439 - accuracy300: 0.3523 - val_loss: 3.3575 - val_accuracy300: 0.3292 - 8s/epoch - 24ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3070 - accuracy300: 0.3648 - val_loss: 3.3808 - val_accuracy300: 0.3457 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2885 - accuracy300: 0.3688 - val_loss: 3.4400 - val_accuracy300: 0.3553 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2727 - accuracy300: 0.3824 - val_loss: 3.3978 - val_accuracy300: 0.3527 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2622 - accuracy300: 0.3930 - val_loss: 3.4318 - val_accuracy300: 0.3554 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2506 - accuracy300: 0.3973 - val_loss: 3.4135 - val_accuracy300: 0.3566 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2408 - accuracy300: 0.4033 - val_loss: 3.4363 - val_accuracy300: 0.3561 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2396 - accuracy300: 0.4046 - val_loss: 3.4393 - val_accuracy300: 0.3531 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2382 - accuracy300: 0.4071 - val_loss: 3.3492 - val_accuracy300: 0.3445 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2303 - accuracy300: 0.4112 - val_loss: 3.3668 - val_accuracy300: 0.3493 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2231 - accuracy300: 0.4158 - val_loss: 3.3588 - val_accuracy300: 0.3501 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2148 - accuracy300: 0.4217 - val_loss: 3.3938 - val_accuracy300: 0.3545 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2089 - accuracy300: 0.4231 - val_loss: 3.4799 - val_accuracy300: 0.3566 - 6s/epoch - 19ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2092 - accuracy300: 0.4238 - val_loss: 3.4456 - val_accuracy300: 0.3514 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1998 - accuracy300: 0.4287 - val_loss: 3.4108 - val_accuracy300: 0.3507 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1932 - accuracy300: 0.4327 - val_loss: 3.4060 - val_accuracy300: 0.3527 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.1854 - accuracy300: 0.4366 - val_loss: 3.4603 - val_accuracy300: 0.3555 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.1783 - accuracy300: 0.4388 - val_loss: 3.4596 - val_accuracy300: 0.3550 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.1738 - accuracy300: 0.4392 - val_loss: 3.3996 - val_accuracy300: 0.3547 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h300
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.13601
{'0': {'precision': 0.3071877562175458, 'recall': 0.012802697223044855, 'f1-score': 0.024580932282155864, 'support': 87794}, '1': {'precision': 0.3729686427100023, 'recall': 0.11328034481160495, 'f1-score': 0.17377934981603596, 'support': 86308}, '2': {'precision': 0.3114309534908739, 'recall': 0.8809641548429634, 'f1-score': 0.46018220775393015, 'support': 78867}, 'accuracy': 0.3177464432400808, 'macro avg': {'precision': 0.33052911747280733, 'recall': 0.33568239895920443, 'f1-score': 0.21951416328404064, 'support': 252969}, 'weighted avg': {'precision': 0.3309537709891048, 'recall': 0.3177464432400808, 'f1-score': 0.21128990774217882, 'support': 252969}}
[[ 1124  8220 78450]
 [ 1364  9777 75167]
 [ 1171  8217 69479]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1203333
{'0': {'precision': 0.30393912264995526, 'recall': 0.07221099649048177, 'f1-score': 0.11669674314685916, 'support': 28209}, '1': {'precision': 0.3663074656950151, 'recall': 0.16519246232912632, 'f1-score': 0.2276998698857886, 'support': 28603}, '2': {'precision': 0.347141512675341, 'recall': 0.7816347124117053, 'f1-score': 0.4807646553775176, 'support': 29730}, 'accuracy': 0.3466524924314206, 'macro avg': {'precision': 0.3391293670067705, 'recall': 0.3396793904104378, 'f1-score': 0.27505375613672184, 'support': 86542}, 'weighted avg': {'precision': 0.3393939165254442, 'recall': 0.3466524924314206, 'f1-score': 0.27845359490359084, 'support': 86542}}
[[ 2037  4037 22135]
 [ 2310  4725 21568]
 [ 2355  4137 23238]]
Evaluating performance on  val set...
124/124 - 1s - 925ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138341
{'0': {'precision': 0.34928716904276985, 'recall': 0.032158259891243206, 'f1-score': 0.05889423076923077, 'support': 10666}, '1': {'precision': 0.3090096798212956, 'recall': 0.21533831465338316, 'f1-score': 0.2538071065989848, 'support': 9636}, '2': {'precision': 0.3565764631843927, 'recall': 0.7568121104185218, 'f1-score': 0.4847568800798517, 'support': 11230}, 'accuracy': 0.3462197133071166, 'macro avg': {'precision': 0.3382911040161527, 'recall': 0.3347695616543827, 'f1-score': 0.2658194058160224, 'support': 31532}, 'weighted avg': {'precision': 0.3395746511901851, 'recall': 0.3462197133071166, 'f1-score': 0.27012783546458097, 'support': 31532}}
[[ 343 2266 8057]
 [ 282 2075 7279]
 [ 357 2374 8499]]
training model: results/XRAY/W4/deepLOB_L1/h500
Epoch 1/50
339/339 - 8s - loss: 3.3462 - accuracy500: 0.3606 - val_loss: 3.4153 - val_accuracy500: 0.3450 - 8s/epoch - 25ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3014 - accuracy500: 0.3701 - val_loss: 3.5127 - val_accuracy500: 0.3530 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2799 - accuracy500: 0.3780 - val_loss: 3.4487 - val_accuracy500: 0.3527 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2629 - accuracy500: 0.3929 - val_loss: 3.4029 - val_accuracy500: 0.3506 - 6s/epoch - 19ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2462 - accuracy500: 0.4008 - val_loss: 3.4090 - val_accuracy500: 0.3385 - 6s/epoch - 19ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2265 - accuracy500: 0.4139 - val_loss: 3.4958 - val_accuracy500: 0.3463 - 6s/epoch - 19ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2190 - accuracy500: 0.4180 - val_loss: 3.4621 - val_accuracy500: 0.3450 - 6s/epoch - 19ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2044 - accuracy500: 0.4259 - val_loss: 3.4788 - val_accuracy500: 0.3491 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.1901 - accuracy500: 0.4302 - val_loss: 3.4731 - val_accuracy500: 0.3517 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.1865 - accuracy500: 0.4327 - val_loss: 3.4723 - val_accuracy500: 0.3514 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.1754 - accuracy500: 0.4380 - val_loss: 3.4174 - val_accuracy500: 0.3537 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.1720 - accuracy500: 0.4390 - val_loss: 3.4311 - val_accuracy500: 0.3550 - 6s/epoch - 17ms/step
Epoch 13/50
339/339 - 6s - loss: 3.1634 - accuracy500: 0.4418 - val_loss: 3.4027 - val_accuracy500: 0.3525 - 6s/epoch - 17ms/step
Epoch 14/50
339/339 - 6s - loss: 3.1589 - accuracy500: 0.4429 - val_loss: 3.4232 - val_accuracy500: 0.3377 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1501 - accuracy500: 0.4501 - val_loss: 3.4508 - val_accuracy500: 0.3537 - 6s/epoch - 17ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1413 - accuracy500: 0.4533 - val_loss: 3.4226 - val_accuracy500: 0.3470 - 6s/epoch - 17ms/step
Epoch 17/50
339/339 - 6s - loss: 3.1369 - accuracy500: 0.4546 - val_loss: 3.4563 - val_accuracy500: 0.3523 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.1352 - accuracy500: 0.4525 - val_loss: 3.3963 - val_accuracy500: 0.3447 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.1243 - accuracy500: 0.4570 - val_loss: 3.4019 - val_accuracy500: 0.3493 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.1250 - accuracy500: 0.4564 - val_loss: 3.4012 - val_accuracy500: 0.3481 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.1227 - accuracy500: 0.4590 - val_loss: 3.4508 - val_accuracy500: 0.3507 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.1220 - accuracy500: 0.4582 - val_loss: 3.4137 - val_accuracy500: 0.3538 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.1102 - accuracy500: 0.4645 - val_loss: 3.3777 - val_accuracy500: 0.3528 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.1055 - accuracy500: 0.4654 - val_loss: 3.3895 - val_accuracy500: 0.3526 - 6s/epoch - 18ms/step
Epoch 25/50
339/339 - 6s - loss: 3.0997 - accuracy500: 0.4670 - val_loss: 3.3820 - val_accuracy500: 0.3496 - 6s/epoch - 18ms/step
Epoch 26/50
339/339 - 6s - loss: 3.0981 - accuracy500: 0.4669 - val_loss: 3.4139 - val_accuracy500: 0.3536 - 6s/epoch - 17ms/step
Epoch 27/50
339/339 - 6s - loss: 3.0982 - accuracy500: 0.4658 - val_loss: 3.4586 - val_accuracy500: 0.3541 - 6s/epoch - 17ms/step
Epoch 28/50
339/339 - 6s - loss: 3.0879 - accuracy500: 0.4683 - val_loss: 3.3664 - val_accuracy500: 0.3403 - 6s/epoch - 18ms/step
Epoch 29/50
339/339 - 6s - loss: 3.0863 - accuracy500: 0.4701 - val_loss: 3.3571 - val_accuracy500: 0.3456 - 6s/epoch - 19ms/step
Epoch 30/50
339/339 - 6s - loss: 3.0856 - accuracy500: 0.4713 - val_loss: 3.3113 - val_accuracy500: 0.3480 - 6s/epoch - 19ms/step
Epoch 31/50
339/339 - 6s - loss: 3.0804 - accuracy500: 0.4735 - val_loss: 3.3414 - val_accuracy500: 0.3450 - 6s/epoch - 18ms/step
Epoch 32/50
339/339 - 6s - loss: 3.0794 - accuracy500: 0.4738 - val_loss: 3.3740 - val_accuracy500: 0.3334 - 6s/epoch - 18ms/step
Epoch 33/50
339/339 - 6s - loss: 3.0724 - accuracy500: 0.4757 - val_loss: 3.3437 - val_accuracy500: 0.3350 - 6s/epoch - 18ms/step
Epoch 34/50
339/339 - 6s - loss: 3.0725 - accuracy500: 0.4763 - val_loss: 3.3331 - val_accuracy500: 0.3354 - 6s/epoch - 18ms/step
Epoch 35/50
339/339 - 6s - loss: 3.0766 - accuracy500: 0.4716 - val_loss: 3.3893 - val_accuracy500: 0.3393 - 6s/epoch - 18ms/step
Epoch 36/50
339/339 - 6s - loss: 3.0711 - accuracy500: 0.4757 - val_loss: 3.3823 - val_accuracy500: 0.3497 - 6s/epoch - 17ms/step
Epoch 37/50
339/339 - 6s - loss: 3.0665 - accuracy500: 0.4765 - val_loss: 3.4678 - val_accuracy500: 0.3448 - 6s/epoch - 18ms/step
Epoch 38/50
339/339 - 6s - loss: 3.0629 - accuracy500: 0.4794 - val_loss: 3.5421 - val_accuracy500: 0.3485 - 6s/epoch - 18ms/step
Epoch 39/50
339/339 - 6s - loss: 3.0605 - accuracy500: 0.4795 - val_loss: 3.5283 - val_accuracy500: 0.3461 - 6s/epoch - 18ms/step
Epoch 40/50
339/339 - 6s - loss: 3.0610 - accuracy500: 0.4803 - val_loss: 3.4566 - val_accuracy500: 0.3455 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h500
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366484
{'0': {'precision': 0.3203776360961256, 'recall': 0.2693629303827916, 'f1-score': 0.2926638043681165, 'support': 87306}, '1': {'precision': 0.37281706269682224, 'recall': 0.05715257510258717, 'f1-score': 0.09911144091177199, 'support': 91142}, '2': {'precision': 0.28356271098415997, 'recall': 0.6301042659116223, 'f1-score': 0.3911142207451461, 'support': 74521}, 'accuracy': 0.29917499772699424, 'macro avg': {'precision': 0.3255858032590359, 'recall': 0.31887325713233367, 'f1-score': 0.2609631553416782, 'support': 252969}, 'weighted avg': {'precision': 0.3284258522213105, 'recall': 0.29917499772699424, 'f1-score': 0.2519310425225721, 'support': 252969}}
[[23517  4609 59180]
 [26476  5209 59457]
 [23411  4154 46956]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.143599
{'0': {'precision': 0.3077233965161864, 'recall': 0.2746356947049488, 'f1-score': 0.290239579164046, 'support': 27724}, '1': {'precision': 0.3877551020408163, 'recall': 0.06305813118007322, 'f1-score': 0.10847557386698059, 'support': 29227}, '2': {'precision': 0.3507870841075623, 'recall': 0.6762529147375891, 'f1-score': 0.46195043688031673, 'support': 29591}, 'accuracy': 0.3405051882323034, 'macro avg': {'precision': 0.3487551942215217, 'recall': 0.3379822468742037, 'f1-score': 0.2868885299704478, 'support': 86542}, 'weighted avg': {'precision': 0.3494763515771367, 'recall': 0.3405051882323034, 'f1-score': 0.28756665050356717, 'support': 86542}}
[[ 7614  1516 18594]
 [ 8943  1843 18441]
 [ 8186  1394 20011]]
Evaluating performance on  val set...
124/124 - 1s - 914ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050792
{'0': {'precision': 0.3374732905982906, 'recall': 0.47832670830967255, 'f1-score': 0.39574034922872137, 'support': 10566}, '1': {'precision': 0.3069556451612903, 'recall': 0.06235920540651239, 'f1-score': 0.1036595744680851, 'support': 9766}, '2': {'precision': 0.35643700247049137, 'recall': 0.46375, 'f1-score': 0.4030731025919603, 'support': 11200}, 'accuracy': 0.3443168844348598, 'macro avg': {'precision': 0.33362197941002414, 'recall': 0.3348119712387283, 'f1-score': 0.3008243420962556, 'support': 31532}, 'weighted avg': {'precision': 0.3347572639469809, 'recall': 0.3443168844348598, 'f1-score': 0.3078824902713416, 'support': 31532}}
[[5054  683 4829]
 [4608  609 4549]
 [5314  692 5194]]
training model: results/XRAY/W4/deepLOB_L1/h1000
Epoch 1/50
339/339 - 8s - loss: 3.3395 - accuracy1000: 0.3639 - val_loss: 3.5741 - val_accuracy1000: 0.3670 - 8s/epoch - 24ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3137 - accuracy1000: 0.3649 - val_loss: 3.4756 - val_accuracy1000: 0.3624 - 6s/epoch - 18ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2793 - accuracy1000: 0.3824 - val_loss: 3.3873 - val_accuracy1000: 0.3646 - 6s/epoch - 18ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2535 - accuracy1000: 0.3971 - val_loss: 3.4881 - val_accuracy1000: 0.3659 - 6s/epoch - 18ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2237 - accuracy1000: 0.4127 - val_loss: 3.5227 - val_accuracy1000: 0.3663 - 6s/epoch - 18ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2021 - accuracy1000: 0.4275 - val_loss: 3.3929 - val_accuracy1000: 0.3525 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.1956 - accuracy1000: 0.4298 - val_loss: 3.3252 - val_accuracy1000: 0.3505 - 6s/epoch - 18ms/step
Epoch 8/50
339/339 - 6s - loss: 3.1755 - accuracy1000: 0.4394 - val_loss: 3.3268 - val_accuracy1000: 0.3626 - 6s/epoch - 18ms/step
Epoch 9/50
339/339 - 6s - loss: 3.1700 - accuracy1000: 0.4436 - val_loss: 3.3655 - val_accuracy1000: 0.3648 - 6s/epoch - 18ms/step
Epoch 10/50
339/339 - 6s - loss: 3.1477 - accuracy1000: 0.4480 - val_loss: 3.3730 - val_accuracy1000: 0.3693 - 6s/epoch - 18ms/step
Epoch 11/50
339/339 - 6s - loss: 3.1436 - accuracy1000: 0.4494 - val_loss: 3.3445 - val_accuracy1000: 0.3645 - 6s/epoch - 18ms/step
Epoch 12/50
339/339 - 6s - loss: 3.1274 - accuracy1000: 0.4579 - val_loss: 3.3391 - val_accuracy1000: 0.3620 - 6s/epoch - 18ms/step
Epoch 13/50
339/339 - 6s - loss: 3.1212 - accuracy1000: 0.4596 - val_loss: 3.3289 - val_accuracy1000: 0.3588 - 6s/epoch - 18ms/step
Epoch 14/50
339/339 - 6s - loss: 3.1162 - accuracy1000: 0.4589 - val_loss: 3.3285 - val_accuracy1000: 0.3364 - 6s/epoch - 18ms/step
Epoch 15/50
339/339 - 6s - loss: 3.1149 - accuracy1000: 0.4599 - val_loss: 3.3170 - val_accuracy1000: 0.3463 - 6s/epoch - 18ms/step
Epoch 16/50
339/339 - 6s - loss: 3.1124 - accuracy1000: 0.4584 - val_loss: 3.3245 - val_accuracy1000: 0.3414 - 6s/epoch - 18ms/step
Epoch 17/50
339/339 - 6s - loss: 3.0980 - accuracy1000: 0.4654 - val_loss: 3.3527 - val_accuracy1000: 0.3571 - 6s/epoch - 18ms/step
Epoch 18/50
339/339 - 6s - loss: 3.0874 - accuracy1000: 0.4691 - val_loss: 3.3416 - val_accuracy1000: 0.3557 - 6s/epoch - 18ms/step
Epoch 19/50
339/339 - 6s - loss: 3.0827 - accuracy1000: 0.4716 - val_loss: 3.3376 - val_accuracy1000: 0.3495 - 6s/epoch - 18ms/step
Epoch 20/50
339/339 - 6s - loss: 3.0782 - accuracy1000: 0.4732 - val_loss: 3.3547 - val_accuracy1000: 0.3480 - 6s/epoch - 18ms/step
Epoch 21/50
339/339 - 6s - loss: 3.0751 - accuracy1000: 0.4780 - val_loss: 3.4778 - val_accuracy1000: 0.3600 - 6s/epoch - 18ms/step
Epoch 22/50
339/339 - 6s - loss: 3.0787 - accuracy1000: 0.4736 - val_loss: 3.4455 - val_accuracy1000: 0.3665 - 6s/epoch - 18ms/step
Epoch 23/50
339/339 - 6s - loss: 3.0847 - accuracy1000: 0.4733 - val_loss: 3.3644 - val_accuracy1000: 0.3541 - 6s/epoch - 18ms/step
Epoch 24/50
339/339 - 6s - loss: 3.0737 - accuracy1000: 0.4747 - val_loss: 3.3829 - val_accuracy1000: 0.3600 - 6s/epoch - 18ms/step
Epoch 25/50
339/339 - 6s - loss: 3.0670 - accuracy1000: 0.4777 - val_loss: 3.4121 - val_accuracy1000: 0.3660 - 6s/epoch - 18ms/step
testing model: results/XRAY/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.165255
{'0': {'precision': 0.3080529746050839, 'recall': 0.28574030853304494, 'f1-score': 0.2964774257566093, 'support': 87835}, '1': {'precision': 0.379491274096042, 'recall': 0.03596290210999654, 'f1-score': 0.06569970082642997, 'support': 92512}, '2': {'precision': 0.2712300819153316, 'recall': 0.6077634876483711, 'f1-score': 0.37507382590258803, 'support': 72622}, 'accuracy': 0.2868414706940376, 'macro avg': {'precision': 0.31959144353881913, 'recall': 0.3098222327638042, 'f1-score': 0.24575031749520906, 'support': 252969}, 'weighted avg': {'precision': 0.32360724350598613, 'recall': 0.28684147069403765, 'f1-score': 0.23464423229282724, 'support': 252969}}
[[25098  2639 60098]
 [30691  3327 58494]
 [25684  2801 44137]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1728266
{'0': {'precision': 0.3071861141576463, 'recall': 0.22957129111578348, 'f1-score': 0.26276717245880243, 'support': 28061}, '1': {'precision': 0.3972911963882618, 'recall': 0.03069624668620064, 'f1-score': 0.056989282129326815, 'support': 28668}, '2': {'precision': 0.34312456594481977, 'recall': 0.7291785462717606, 'f1-score': 0.46665736457405366, 'support': 29813}, 'accuracy': 0.33580226941831715, 'macro avg': {'precision': 0.3492006254969093, 'recall': 0.3298153613579149, 'f1-score': 0.26213793972072763, 'support': 86542}, 'weighted avg': {'precision': 0.3494149228345695, 'recall': 0.33580226941831715, 'f1-score': 0.2648394349159513, 'support': 86542}}
[[ 6442   664 20955]
 [ 7126   880 20662]
 [ 7403   671 21739]]
Evaluating performance on  val set...
124/124 - 1s - 950ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044459
{'0': {'precision': 0.3372872269132824, 'recall': 0.47054973821989526, 'f1-score': 0.3929268483097822, 'support': 10696}, '1': {'precision': 0.31240188383045525, 'recall': 0.043554388268767785, 'f1-score': 0.07645024971187092, 'support': 9138}, '2': {'precision': 0.37134846113719355, 'recall': 0.48683535647119164, 'f1-score': 0.42132129910483096, 'support': 11698}, 'accuracy': 0.3528479005454776, 'macro avg': {'precision': 0.34034585729364375, 'recall': 0.3336464943199515, 'f1-score': 0.296899465708828, 'support': 31532}, 'weighted avg': {'precision': 0.34271174971108903, 'recall': 0.3528479005454776, 'f1-score': 0.3117456713280737, 'support': 31532}}
[[5033  414 5249]
 [4348  398 4392]
 [5541  462 5695]]
training model: results/XRAY/W4/deepOF_L1/h10
Epoch 1/50
339/339 - 7s - loss: 3.2973 - accuracy10: 0.3770 - val_loss: 3.2723 - val_accuracy10: 0.3834 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2466 - accuracy10: 0.4027 - val_loss: 3.2618 - val_accuracy10: 0.3926 - 6s/epoch - 16ms/step
Epoch 3/50
339/339 - 5s - loss: 3.2324 - accuracy10: 0.4060 - val_loss: 3.2544 - val_accuracy10: 0.3946 - 5s/epoch - 16ms/step
Epoch 4/50
339/339 - 5s - loss: 3.2219 - accuracy10: 0.4110 - val_loss: 3.2607 - val_accuracy10: 0.3905 - 5s/epoch - 16ms/step
Epoch 5/50
339/339 - 5s - loss: 3.2117 - accuracy10: 0.4128 - val_loss: 3.2599 - val_accuracy10: 0.3905 - 5s/epoch - 16ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2048 - accuracy10: 0.4176 - val_loss: 3.2641 - val_accuracy10: 0.3881 - 6s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.1992 - accuracy10: 0.4191 - val_loss: 3.2582 - val_accuracy10: 0.3874 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 5s - loss: 3.1933 - accuracy10: 0.4215 - val_loss: 3.2604 - val_accuracy10: 0.3904 - 5s/epoch - 16ms/step
Epoch 9/50
339/339 - 6s - loss: 3.1863 - accuracy10: 0.4215 - val_loss: 3.2588 - val_accuracy10: 0.3887 - 6s/epoch - 16ms/step
Epoch 10/50
339/339 - 5s - loss: 3.1786 - accuracy10: 0.4276 - val_loss: 3.2638 - val_accuracy10: 0.3884 - 5s/epoch - 16ms/step
Epoch 11/50
339/339 - 5s - loss: 3.1746 - accuracy10: 0.4283 - val_loss: 3.2596 - val_accuracy10: 0.3890 - 5s/epoch - 16ms/step
Epoch 12/50
339/339 - 6s - loss: 3.1708 - accuracy10: 0.4305 - val_loss: 3.2661 - val_accuracy10: 0.3852 - 6s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.1647 - accuracy10: 0.4322 - val_loss: 3.2637 - val_accuracy10: 0.3865 - 5s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h10
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0728918
{'0': {'precision': 0.36060904517262493, 'recall': 0.38874540863177226, 'f1-score': 0.3741490022785334, 'support': 69696}, '1': {'precision': 0.5044277685070486, 'recall': 0.42821014209359926, 'f1-score': 0.4632046027150002, 'support': 115065}, '2': {'precision': 0.3517816149316299, 'recall': 0.4134068383086036, 'f1-score': 0.3801127018792633, 'support': 68204}, 'accuracy': 0.4133457197636037, 'macro avg': {'precision': 0.4056061428704345, 'recall': 0.4101207963446584, 'f1-score': 0.4058221022909323, 'support': 252965}, 'weighted avg': {'precision': 0.42364715458823043, 'recall': 0.4133457197636037, 'f1-score': 0.4162652271783822, 'support': 252965}}
[[27094 24709 17893]
 [31730 49272 34063]
 [16310 23698 28196]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0771319
{'0': {'precision': 0.4156964696130515, 'recall': 0.3938950374866119, 'f1-score': 0.4045022089420909, 'support': 28010}, '1': {'precision': 0.3924317904391145, 'recall': 0.39403074069166555, 'f1-score': 0.39322964015934153, 'support': 30188}, '2': {'precision': 0.4039005658852061, 'recall': 0.4230823512807847, 'f1-score': 0.41326899879372736, 'support': 28342}, 'accuracy': 0.40350127108851397, 'macro avg': {'precision': 0.4040096086457907, 'recall': 0.4036693764863541, 'f1-score': 0.4036669492983866, 'support': 86540}, 'weighted avg': {'precision': 0.40371780496829296, 'recall': 0.40350127108851397, 'f1-score': 0.4034411048464293, 'support': 86540}}
[[11033  9041  7936]
 [ 8532 11895  9761]
 [ 6976  9375 11991]]
Evaluating performance on  val set...
124/124 - 1s - 969ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0828724
{'0': {'precision': 0.41224569259223204, 'recall': 0.39821344616831217, 'f1-score': 0.40510809259613545, 'support': 10635}, '1': {'precision': 0.3373928293063133, 'recall': 0.35114581220847696, 'f1-score': 0.3441319685978336, 'support': 9862}, '2': {'precision': 0.43019554342883126, 'recall': 0.42863615768010876, 'f1-score': 0.4294144348615524, 'support': 11035}, 'accuracy': 0.3941392870734492, 'macro avg': {'precision': 0.39327802177579213, 'recall': 0.39266513868563263, 'f1-score': 0.39288483201850716, 'support': 31532}, 'weighted avg': {'precision': 0.39511635307225684, 'recall': 0.3941392870734492, 'f1-score': 0.3945433948930917, 'support': 31532}}
[[4235 3367 3033]
 [3167 3463 3232]
 [2871 3434 4730]]
training model: results/XRAY/W4/deepOF_L1/h20
Epoch 1/50
339/339 - 7s - loss: 3.3053 - accuracy20: 0.3693 - val_loss: 3.2710 - val_accuracy20: 0.3787 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2607 - accuracy20: 0.3929 - val_loss: 3.2649 - val_accuracy20: 0.3802 - 6s/epoch - 17ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2475 - accuracy20: 0.3981 - val_loss: 3.2632 - val_accuracy20: 0.3822 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2365 - accuracy20: 0.4026 - val_loss: 3.2631 - val_accuracy20: 0.3862 - 6s/epoch - 17ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2272 - accuracy20: 0.4071 - val_loss: 3.2631 - val_accuracy20: 0.3825 - 6s/epoch - 17ms/step
Epoch 6/50
339/339 - 5s - loss: 3.2177 - accuracy20: 0.4115 - val_loss: 3.2639 - val_accuracy20: 0.3849 - 5s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2117 - accuracy20: 0.4140 - val_loss: 3.2655 - val_accuracy20: 0.3820 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 5s - loss: 3.2033 - accuracy20: 0.4181 - val_loss: 3.2688 - val_accuracy20: 0.3790 - 5s/epoch - 16ms/step
Epoch 9/50
339/339 - 5s - loss: 3.1982 - accuracy20: 0.4219 - val_loss: 3.2703 - val_accuracy20: 0.3776 - 5s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.1939 - accuracy20: 0.4234 - val_loss: 3.2727 - val_accuracy20: 0.3784 - 6s/epoch - 17ms/step
Epoch 11/50
339/339 - 5s - loss: 3.1889 - accuracy20: 0.4246 - val_loss: 3.2702 - val_accuracy20: 0.3804 - 5s/epoch - 16ms/step
Epoch 12/50
339/339 - 5s - loss: 3.1852 - accuracy20: 0.4256 - val_loss: 3.2757 - val_accuracy20: 0.3756 - 5s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.1827 - accuracy20: 0.4278 - val_loss: 3.2769 - val_accuracy20: 0.3736 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 5s - loss: 3.1781 - accuracy20: 0.4311 - val_loss: 3.2738 - val_accuracy20: 0.3767 - 5s/epoch - 16ms/step
Epoch 15/50
339/339 - 5s - loss: 3.1766 - accuracy20: 0.4304 - val_loss: 3.2724 - val_accuracy20: 0.3814 - 5s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h20
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0794505
{'0': {'precision': 0.37544201749152345, 'recall': 0.35151779388522536, 'f1-score': 0.3630862329803328, 'support': 73396}, '1': {'precision': 0.4410420832728207, 'recall': 0.3652148975929249, 'f1-score': 0.3995627773757533, 'support': 108098}, '2': {'precision': 0.3329040566645203, 'recall': 0.4412558939989646, 'f1-score': 0.37949748501841113, 'support': 71471}, 'accuracy': 0.3827248828889372, 'macro avg': {'precision': 0.38312938580962147, 'recall': 0.38599619515903827, 'f1-score': 0.38071549845816577, 'support': 252965}, 'weighted avg': {'precision': 0.39145611158580496, 'recall': 0.3827248828889372, 'f1-score': 0.38331025642416755, 'support': 252965}}
[[25800 25427 22169]
 [27592 39479 41027]
 [15327 24607 31537]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801735
{'0': {'precision': 0.4193383221740843, 'recall': 0.3716489807316392, 'f1-score': 0.3940560346422887, 'support': 28648}, '1': {'precision': 0.3619823533200232, 'recall': 0.38960903923471507, 'f1-score': 0.3752879511234267, 'support': 28852}, '2': {'precision': 0.4048710792131845, 'recall': 0.4195936639118457, 'f1-score': 0.4121009199134199, 'support': 29040}, 'accuracy': 0.3937254448809799, 'macro avg': {'precision': 0.39539725156909733, 'recall': 0.39361722795939996, 'f1-score': 0.3938149685597117, 'support': 86540}, 'weighted avg': {'precision': 0.3953613964869812, 'recall': 0.3937254448809799, 'f1-score': 0.39385412480391857, 'support': 86540}}
[[10647  9815  8186]
 [ 7886 11241  9725]
 [ 6857  9998 12185]]
Evaluating performance on  val set...
124/124 - 1s - 944ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0878565
{'0': {'precision': 0.42483796780263433, 'recall': 0.37257059039237256, 'f1-score': 0.39699130604669336, 'support': 10908}, '1': {'precision': 0.30073240443015364, 'recall': 0.3633714655730628, 'f1-score': 0.3290978398983482, 'support': 9266}, '2': {'precision': 0.434447539461467, 'recall': 0.4119563303398486, 'f1-score': 0.4229031091829356, 'support': 11358}, 'accuracy': 0.3840542940504884, 'macro avg': {'precision': 0.38667263723141837, 'recall': 0.3826327954350946, 'f1-score': 0.3829974183759924, 'support': 31532}, 'weighted avg': {'precision': 0.39182970206280227, 'recall': 0.3840542940504884, 'f1-score': 0.386373692279437, 'support': 31532}}
[[4064 3839 3005]
 [2813 3367 3086]
 [2689 3990 4679]]
training model: results/XRAY/W4/deepOF_L1/h30
Epoch 1/50
339/339 - 8s - loss: 3.3086 - accuracy30: 0.3641 - val_loss: 3.2695 - val_accuracy30: 0.3845 - 8s/epoch - 23ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2690 - accuracy30: 0.3889 - val_loss: 3.2561 - val_accuracy30: 0.3926 - 6s/epoch - 17ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2559 - accuracy30: 0.3938 - val_loss: 3.2518 - val_accuracy30: 0.3990 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2464 - accuracy30: 0.3995 - val_loss: 3.2488 - val_accuracy30: 0.4008 - 6s/epoch - 17ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2379 - accuracy30: 0.4030 - val_loss: 3.2480 - val_accuracy30: 0.4008 - 6s/epoch - 16ms/step
Epoch 6/50
339/339 - 5s - loss: 3.2324 - accuracy30: 0.4040 - val_loss: 3.2503 - val_accuracy30: 0.4000 - 5s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2298 - accuracy30: 0.4074 - val_loss: 3.2493 - val_accuracy30: 0.3995 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 5s - loss: 3.2226 - accuracy30: 0.4095 - val_loss: 3.2503 - val_accuracy30: 0.3956 - 5s/epoch - 16ms/step
Epoch 9/50
339/339 - 5s - loss: 3.2181 - accuracy30: 0.4123 - val_loss: 3.2493 - val_accuracy30: 0.3929 - 5s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2144 - accuracy30: 0.4148 - val_loss: 3.2486 - val_accuracy30: 0.3973 - 6s/epoch - 16ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2116 - accuracy30: 0.4164 - val_loss: 3.2505 - val_accuracy30: 0.3917 - 6s/epoch - 17ms/step
Epoch 12/50
339/339 - 5s - loss: 3.2064 - accuracy30: 0.4157 - val_loss: 3.2501 - val_accuracy30: 0.3951 - 5s/epoch - 16ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2036 - accuracy30: 0.4199 - val_loss: 3.2494 - val_accuracy30: 0.3953 - 6s/epoch - 16ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2003 - accuracy30: 0.4205 - val_loss: 3.2495 - val_accuracy30: 0.3928 - 6s/epoch - 16ms/step
Epoch 15/50
339/339 - 5s - loss: 3.1973 - accuracy30: 0.4212 - val_loss: 3.2496 - val_accuracy30: 0.3952 - 5s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h30
Evaluating performance on  test set...
989/989 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086276
{'0': {'precision': 0.36892631404719295, 'recall': 0.45991849578293054, 'f1-score': 0.40942775631568973, 'support': 77542}, '1': {'precision': 0.40633794760324904, 'recall': 0.17706411956489226, 'f1-score': 0.24664935209233207, 'support': 100297}, '2': {'precision': 0.34272112831170676, 'recall': 0.5136437451747731, 'f1-score': 0.41112513917078186, 'support': 75126}, 'accuracy': 0.36372620718281184, 'macro avg': {'precision': 0.3726617966540496, 'recall': 0.38354212017419864, 'f1-score': 0.35573408252626787, 'support': 252965}, 'weighted avg': {'precision': 0.37597702788984955, 'recall': 0.36372620718281184, 'f1-score': 0.34539254186302454, 'support': 252965}}
[[35663 13210 28669]
 [37202 17759 45336]
 [23802 12736 38588]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0812517
{'0': {'precision': 0.40370348735323325, 'recall': 0.47588225167843, 'f1-score': 0.43683137651501985, 'support': 29045}, '1': {'precision': 0.3666025680789033, 'recall': 0.21011839158104312, 'f1-score': 0.26713071777255465, 'support': 28127}, '2': {'precision': 0.39990602802575936, 'recall': 0.49267910651048763, 'f1-score': 0.4414712657706449, 'support': 29368}, 'accuracy': 0.39520452969724984, 'macro avg': {'precision': 0.3900706944859653, 'recall': 0.39289324992332025, 'f1-score': 0.3818111200194065, 'support': 86540}, 'weighted avg': {'precision': 0.39035634912861655, 'recall': 0.39520452969724984, 'f1-score': 0.38325030232054186, 'support': 86540}}
[[13822  4966 10257]
 [10762  5910 11455]
 [ 9654  5245 14469]]
Evaluating performance on  val set...
124/124 - 1s - 779ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845165
{'0': {'precision': 0.4029201615408512, 'recall': 0.48090470893585463, 'f1-score': 0.43847194050033805, 'support': 10788}, '1': {'precision': 0.33233900684330586, 'recall': 0.19962057335581787, 'f1-score': 0.2494238493448344, 'support': 9488}, '2': {'precision': 0.42918885544493324, 'recall': 0.49404761904761907, 'f1-score': 0.45934002395407425, 'support': 11256}, 'accuracy': 0.4009577571990359, 'macro avg': {'precision': 0.38814934127636347, 'recall': 0.39152430044643055, 'f1-score': 0.3824119379330822, 'support': 31532}, 'weighted avg': {'precision': 0.39105939859571726, 'recall': 0.4009577571990359, 'f1-score': 0.38903653705215324, 'support': 31532}}
[[5188 1899 3701]
 [3899 1894 3695]
 [3789 1906 5561]]
training model: results/XRAY/W4/deepOF_L1/h50
Epoch 1/50
339/339 - 7s - loss: 3.3153 - accuracy50: 0.3637 - val_loss: 3.3010 - val_accuracy50: 0.3444 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 6s - loss: 3.2775 - accuracy50: 0.3835 - val_loss: 3.2903 - val_accuracy50: 0.3498 - 6s/epoch - 16ms/step
Epoch 3/50
339/339 - 5s - loss: 3.2622 - accuracy50: 0.3882 - val_loss: 3.2886 - val_accuracy50: 0.3482 - 5s/epoch - 16ms/step
Epoch 4/50
339/339 - 5s - loss: 3.2550 - accuracy50: 0.3911 - val_loss: 3.2864 - val_accuracy50: 0.3476 - 5s/epoch - 16ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2491 - accuracy50: 0.3954 - val_loss: 3.2828 - val_accuracy50: 0.3501 - 6s/epoch - 16ms/step
Epoch 6/50
339/339 - 5s - loss: 3.2411 - accuracy50: 0.4011 - val_loss: 3.2890 - val_accuracy50: 0.3450 - 5s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2361 - accuracy50: 0.4016 - val_loss: 3.2903 - val_accuracy50: 0.3439 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2327 - accuracy50: 0.4034 - val_loss: 3.2896 - val_accuracy50: 0.3443 - 6s/epoch - 16ms/step
Epoch 9/50
339/339 - 5s - loss: 3.2283 - accuracy50: 0.4048 - val_loss: 3.2895 - val_accuracy50: 0.3498 - 5s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2254 - accuracy50: 0.4083 - val_loss: 3.2910 - val_accuracy50: 0.3466 - 6s/epoch - 17ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2200 - accuracy50: 0.4101 - val_loss: 3.2879 - val_accuracy50: 0.3490 - 6s/epoch - 17ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2162 - accuracy50: 0.4124 - val_loss: 3.2935 - val_accuracy50: 0.3468 - 6s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.2126 - accuracy50: 0.4131 - val_loss: 3.2943 - val_accuracy50: 0.3461 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2093 - accuracy50: 0.4165 - val_loss: 3.2978 - val_accuracy50: 0.3452 - 6s/epoch - 17ms/step
Epoch 15/50
339/339 - 6s - loss: 3.2052 - accuracy50: 0.4176 - val_loss: 3.2916 - val_accuracy50: 0.3501 - 6s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h50
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0698497
{'0': {'precision': 0.35103102359279215, 'recall': 0.13301234672185383, 'f1-score': 0.19292263083740022, 'support': 71031}, '1': {'precision': 0.4591803691577016, 'recall': 0.7712709471884793, 'f1-score': 0.5756464697884515, 'support': 115827}, '2': {'precision': 0.33537572621353057, 'recall': 0.15980153387689655, 'f1-score': 0.21646210273958566, 'support': 66107}, 'accuracy': 0.43225742691676716, 'macro avg': {'precision': 0.3818623729880081, 'recall': 0.35469494259574325, 'f1-score': 0.3283437344551458, 'support': 252965}, 'weighted avg': {'precision': 0.3964590057440618, 'recall': 0.43225742691676716, 'f1-score': 0.3743148311940551, 'support': 252965}}
[[ 9448 54963  6620]
 [12178 89334 14315]
 [ 5289 50254 10564]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914447
{'0': {'precision': 0.41762162162162164, 'recall': 0.134528991816124, 'f1-score': 0.20350322665613066, 'support': 28715}, '1': {'precision': 0.33532480271077625, 'recall': 0.7873743718592965, 'f1-score': 0.47034176542322004, 'support': 28656}, '2': {'precision': 0.43017094871538536, 'recall': 0.14751962700126847, 'f1-score': 0.2196977432860206, 'support': 29169}, 'accuracy': 0.3550843540559279, 'macro avg': {'precision': 0.39437245768259444, 'recall': 0.356474330225563, 'f1-score': 0.2978475784551238, 'support': 86540}, 'weighted avg': {'precision': 0.3946005178463594, 'recall': 0.3550843540559279, 'f1-score': 0.29731999372900997, 'support': 86540}}
[[ 3863 22210  2642]
 [ 3035 22563  3058]
 [ 2352 22514  4303]]
Evaluating performance on  val set...
124/124 - 1s - 932ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.095688
{'0': {'precision': 0.4063139432914353, 'recall': 0.13370527125817622, 'f1-score': 0.20120141854237536, 'support': 10396}, '1': {'precision': 0.33259794909506885, 'recall': 0.7866460527587207, 'f1-score': 0.4675242634813071, 'support': 10349}, '2': {'precision': 0.44468904788112273, 'recall': 0.14980995642903494, 'f1-score': 0.224117606268636, 'support': 10787}, 'accuracy': 0.3535138906507675, 'macro avg': {'precision': 0.3945336467558756, 'recall': 0.35672042681531063, 'f1-score': 0.2976144294307728, 'support': 31532}, 'weighted avg': {'precision': 0.39524789702956675, 'recall': 0.3535138906507675, 'f1-score': 0.2964498023834314, 'support': 31532}}
[[1390 8075  931]
 [1121 8141 1087]
 [ 910 8261 1616]]
training model: results/XRAY/W4/deepOF_L1/h100
Epoch 1/50
339/339 - 7s - loss: 3.3320 - accuracy100: 0.3472 - val_loss: 3.3030 - val_accuracy100: 0.3560 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 5s - loss: 3.2998 - accuracy100: 0.3594 - val_loss: 3.2928 - val_accuracy100: 0.3667 - 5s/epoch - 16ms/step
Epoch 3/50
339/339 - 6s - loss: 3.2916 - accuracy100: 0.3622 - val_loss: 3.2900 - val_accuracy100: 0.3697 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 5s - loss: 3.2841 - accuracy100: 0.3666 - val_loss: 3.2864 - val_accuracy100: 0.3719 - 5s/epoch - 16ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2785 - accuracy100: 0.3699 - val_loss: 3.2830 - val_accuracy100: 0.3743 - 6s/epoch - 17ms/step
Epoch 6/50
339/339 - 5s - loss: 3.2735 - accuracy100: 0.3726 - val_loss: 3.2839 - val_accuracy100: 0.3747 - 5s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2678 - accuracy100: 0.3776 - val_loss: 3.2833 - val_accuracy100: 0.3728 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2657 - accuracy100: 0.3795 - val_loss: 3.2810 - val_accuracy100: 0.3777 - 6s/epoch - 17ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2625 - accuracy100: 0.3828 - val_loss: 3.2815 - val_accuracy100: 0.3782 - 6s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2602 - accuracy100: 0.3855 - val_loss: 3.2809 - val_accuracy100: 0.3783 - 6s/epoch - 16ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2570 - accuracy100: 0.3879 - val_loss: 3.2798 - val_accuracy100: 0.3770 - 6s/epoch - 17ms/step
Epoch 12/50
339/339 - 5s - loss: 3.2545 - accuracy100: 0.3886 - val_loss: 3.2823 - val_accuracy100: 0.3735 - 5s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.2529 - accuracy100: 0.3903 - val_loss: 3.2788 - val_accuracy100: 0.3762 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2515 - accuracy100: 0.3908 - val_loss: 3.2785 - val_accuracy100: 0.3786 - 6s/epoch - 16ms/step
Epoch 15/50
339/339 - 6s - loss: 3.2484 - accuracy100: 0.3940 - val_loss: 3.2782 - val_accuracy100: 0.3790 - 6s/epoch - 16ms/step
Epoch 16/50
339/339 - 6s - loss: 3.2448 - accuracy100: 0.3966 - val_loss: 3.2800 - val_accuracy100: 0.3788 - 6s/epoch - 16ms/step
Epoch 17/50
339/339 - 6s - loss: 3.2435 - accuracy100: 0.3950 - val_loss: 3.2779 - val_accuracy100: 0.3779 - 6s/epoch - 16ms/step
Epoch 18/50
339/339 - 5s - loss: 3.2406 - accuracy100: 0.3993 - val_loss: 3.2829 - val_accuracy100: 0.3781 - 5s/epoch - 16ms/step
Epoch 19/50
339/339 - 5s - loss: 3.2400 - accuracy100: 0.4008 - val_loss: 3.2812 - val_accuracy100: 0.3777 - 5s/epoch - 16ms/step
Epoch 20/50
339/339 - 5s - loss: 3.2377 - accuracy100: 0.4024 - val_loss: 3.2813 - val_accuracy100: 0.3756 - 5s/epoch - 16ms/step
Epoch 21/50
339/339 - 6s - loss: 3.2344 - accuracy100: 0.4034 - val_loss: 3.2821 - val_accuracy100: 0.3730 - 6s/epoch - 16ms/step
Epoch 22/50
339/339 - 5s - loss: 3.2333 - accuracy100: 0.4048 - val_loss: 3.2853 - val_accuracy100: 0.3707 - 5s/epoch - 16ms/step
Epoch 23/50
339/339 - 6s - loss: 3.2295 - accuracy100: 0.4053 - val_loss: 3.2856 - val_accuracy100: 0.3739 - 6s/epoch - 17ms/step
Epoch 24/50
339/339 - 6s - loss: 3.2257 - accuracy100: 0.4083 - val_loss: 3.2868 - val_accuracy100: 0.3718 - 6s/epoch - 16ms/step
Epoch 25/50
339/339 - 5s - loss: 3.2250 - accuracy100: 0.4091 - val_loss: 3.2853 - val_accuracy100: 0.3717 - 5s/epoch - 16ms/step
Epoch 26/50
339/339 - 5s - loss: 3.2202 - accuracy100: 0.4131 - val_loss: 3.2875 - val_accuracy100: 0.3731 - 5s/epoch - 16ms/step
Epoch 27/50
339/339 - 5s - loss: 3.2193 - accuracy100: 0.4118 - val_loss: 3.2872 - val_accuracy100: 0.3717 - 5s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h100
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1006273
{'0': {'precision': 0.3652140531095285, 'recall': 0.33390620272314675, 'f1-score': 0.3488591172621343, 'support': 82625}, '1': {'precision': 0.3861863470487797, 'recall': 0.1230085098214857, 'f1-score': 0.1865855729802739, 'support': 93774}, '2': {'precision': 0.3240101928785394, 'recall': 0.6244155369223937, 'f1-score': 0.42663751561663393, 'support': 76566}, 'accuracy': 0.34365623702883796, 'macro avg': {'precision': 0.3584701976789491, 'recall': 0.3604434164890087, 'f1-score': 0.3206940686196807, 'support': 252965}, 'weighted avg': {'precision': 0.3605171232157227, 'recall': 0.34365623702883796, 'f1-score': 0.31224591585847544, 'support': 252965}}
[[27589 10184 44852]
 [27346 11535 54893]
 [20607  8150 47809]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0875659
{'0': {'precision': 0.39009627636981453, 'recall': 0.3812967063382231, 'f1-score': 0.38564630135068934, 'support': 28904}, '1': {'precision': 0.4035580524344569, 'recall': 0.13669521091024422, 'f1-score': 0.20421701018715943, 'support': 28377}, '2': {'precision': 0.37611964828662997, 'recall': 0.625722000068355, 'f1-score': 0.46982742028613583, 'support': 29259}, 'accuracy': 0.38373006702103074, 'macro avg': {'precision': 0.3899246590303005, 'recall': 0.38123797243894075, 'f1-score': 0.3532302439413282, 'support': 86540}, 'weighted avg': {'precision': 0.38978500595498283, 'recall': 0.38373006702103074, 'f1-score': 0.3546159843133048, 'support': 86540}}
[[11021  3026 14857]
 [ 8987  3879 15511]
 [ 8244  2707 18308]]
Evaluating performance on  val set...
124/124 - 1s - 881ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926529
{'0': {'precision': 0.37433056325023084, 'recall': 0.3881282910483485, 'f1-score': 0.3811045828437133, 'support': 10445}, '1': {'precision': 0.39034090909090907, 'recall': 0.1341534856473345, 'f1-score': 0.1996802790292109, 'support': 10242}, '2': {'precision': 0.37469444767780236, 'recall': 0.5936376210235131, 'f1-score': 0.45941413636850176, 'support': 10845}, 'accuracy': 0.37631612330331093, 'macro avg': {'precision': 0.379788640006314, 'recall': 0.37197313257306536, 'f1-score': 0.34673299941380864, 'support': 31532}, 'weighted avg': {'precision': 0.37965608299896986, 'recall': 0.37631612330331093, 'f1-score': 0.3491091302339263, 'support': 31532}}
[[4054 1068 5323]
 [3447 1374 5421]
 [3329 1078 6438]]
training model: results/XRAY/W4/deepOF_L1/h200
Epoch 1/50
339/339 - 8s - loss: 3.3402 - accuracy200: 0.3441 - val_loss: 3.3060 - val_accuracy200: 0.3445 - 8s/epoch - 23ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3110 - accuracy200: 0.3507 - val_loss: 3.3006 - val_accuracy200: 0.3432 - 6s/epoch - 17ms/step
Epoch 3/50
339/339 - 6s - loss: 3.3007 - accuracy200: 0.3550 - val_loss: 3.3022 - val_accuracy200: 0.3421 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 6s - loss: 3.2933 - accuracy200: 0.3588 - val_loss: 3.3005 - val_accuracy200: 0.3404 - 6s/epoch - 17ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2908 - accuracy200: 0.3594 - val_loss: 3.2986 - val_accuracy200: 0.3391 - 6s/epoch - 16ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2856 - accuracy200: 0.3610 - val_loss: 3.2967 - val_accuracy200: 0.3404 - 6s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2831 - accuracy200: 0.3622 - val_loss: 3.2968 - val_accuracy200: 0.3384 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2788 - accuracy200: 0.3675 - val_loss: 3.2984 - val_accuracy200: 0.3364 - 6s/epoch - 17ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2797 - accuracy200: 0.3646 - val_loss: 3.2962 - val_accuracy200: 0.3392 - 6s/epoch - 17ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2743 - accuracy200: 0.3689 - val_loss: 3.2986 - val_accuracy200: 0.3376 - 6s/epoch - 16ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2709 - accuracy200: 0.3711 - val_loss: 3.2961 - val_accuracy200: 0.3438 - 6s/epoch - 17ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2706 - accuracy200: 0.3719 - val_loss: 3.2965 - val_accuracy200: 0.3417 - 6s/epoch - 16ms/step
Epoch 13/50
339/339 - 6s - loss: 3.2685 - accuracy200: 0.3730 - val_loss: 3.2985 - val_accuracy200: 0.3403 - 6s/epoch - 17ms/step
Epoch 14/50
339/339 - 5s - loss: 3.2671 - accuracy200: 0.3756 - val_loss: 3.3000 - val_accuracy200: 0.3387 - 5s/epoch - 16ms/step
Epoch 15/50
339/339 - 6s - loss: 3.2653 - accuracy200: 0.3770 - val_loss: 3.2984 - val_accuracy200: 0.3419 - 6s/epoch - 17ms/step
Epoch 16/50
339/339 - 6s - loss: 3.2605 - accuracy200: 0.3792 - val_loss: 3.3029 - val_accuracy200: 0.3377 - 6s/epoch - 16ms/step
Epoch 17/50
339/339 - 6s - loss: 3.2606 - accuracy200: 0.3818 - val_loss: 3.3012 - val_accuracy200: 0.3418 - 6s/epoch - 16ms/step
Epoch 18/50
339/339 - 6s - loss: 3.2573 - accuracy200: 0.3832 - val_loss: 3.3056 - val_accuracy200: 0.3390 - 6s/epoch - 16ms/step
Epoch 19/50
339/339 - 6s - loss: 3.2551 - accuracy200: 0.3826 - val_loss: 3.3057 - val_accuracy200: 0.3408 - 6s/epoch - 16ms/step
Epoch 20/50
339/339 - 6s - loss: 3.2531 - accuracy200: 0.3853 - val_loss: 3.3037 - val_accuracy200: 0.3420 - 6s/epoch - 17ms/step
Epoch 21/50
339/339 - 6s - loss: 3.2497 - accuracy200: 0.3888 - val_loss: 3.3083 - val_accuracy200: 0.3418 - 6s/epoch - 17ms/step
testing model: results/XRAY/W4/deepOF_L1/h200
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945911
{'0': {'precision': 0.33045729076790337, 'recall': 0.1509637880174957, 'f1-score': 0.2072492734143851, 'support': 78648}, '1': {'precision': 0.4021629068365766, 'recall': 0.5779277986201162, 'f1-score': 0.4742849251415528, 'support': 101023}, '2': {'precision': 0.3070928598266097, 'recall': 0.30108876579256144, 'f1-score': 0.3040611759842926, 'support': 73294}, 'accuracy': 0.3649714387365841, 'macro avg': {'precision': 0.34657101914369653, 'recall': 0.34332678414339113, 'f1-score': 0.32853179151341017, 'support': 252965}, 'weighted avg': {'precision': 0.35232373019902785, 'recall': 0.3649714387365841, 'f1-score': 0.3419417179477888, 'support': 252965}}
[[11873 45362 21413]
 [14259 58384 28380]
 [ 9797 41429 22068]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953578
{'0': {'precision': 0.3693626844752247, 'recall': 0.1568572528973075, 'f1-score': 0.22020152371590068, 'support': 28561}, '1': {'precision': 0.34170565379430656, 'recall': 0.6033674040884907, 'f1-score': 0.4363134713714372, 'support': 28568}, '2': {'precision': 0.3619977469019902, 'recall': 0.29499166978341435, 'f1-score': 0.3250777473865637, 'support': 29411}, 'accuracy': 0.3512017564132193, 'macro avg': {'precision': 0.3576886950571738, 'recall': 0.3517387755897375, 'f1-score': 0.32719758082463385, 'support': 86540}, 'weighted avg': {'precision': 0.3577297259420739, 'recall': 0.3512017564132193, 'f1-score': 0.3271855858259219, 'support': 86540}}
[[ 4480 16331  7750]
 [ 3790 17237  7541]
 [ 3859 16876  8676]]
Evaluating performance on  val set...
124/124 - 1s - 981ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994122
{'0': {'precision': 0.34108877343573524, 'recall': 0.14599245866769797, 'f1-score': 0.20446851726472579, 'support': 10343}, '1': {'precision': 0.3253083109919571, 'recall': 0.5953292120498479, 'f1-score': 0.4207205020630353, 'support': 10191}, '2': {'precision': 0.37043169722057956, 'recall': 0.28477905073649756, 'f1-score': 0.3220068883976765, 'support': 10998}, 'accuracy': 0.3396232398832932, 'macro avg': {'precision': 0.34560959388275725, 'recall': 0.34203357381801447, 'f1-score': 0.3157319692418125, 'support': 31532}, 'weighted avg': {'precision': 0.3462230745590758, 'recall': 0.3396232398832932, 'f1-score': 0.315356218101963, 'support': 31532}}
[[1510 6191 2642]
 [1443 6067 2681]
 [1474 6392 3132]]
training model: results/XRAY/W4/deepOF_L1/h300
Epoch 1/50
339/339 - 8s - loss: 3.3466 - accuracy300: 0.3370 - val_loss: 3.3100 - val_accuracy300: 0.3501 - 8s/epoch - 22ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3213 - accuracy300: 0.3434 - val_loss: 3.3040 - val_accuracy300: 0.3492 - 6s/epoch - 16ms/step
Epoch 3/50
339/339 - 6s - loss: 3.3122 - accuracy300: 0.3458 - val_loss: 3.2985 - val_accuracy300: 0.3522 - 6s/epoch - 17ms/step
Epoch 4/50
339/339 - 6s - loss: 3.3034 - accuracy300: 0.3489 - val_loss: 3.2978 - val_accuracy300: 0.3531 - 6s/epoch - 17ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2980 - accuracy300: 0.3515 - val_loss: 3.2958 - val_accuracy300: 0.3580 - 6s/epoch - 17ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2932 - accuracy300: 0.3573 - val_loss: 3.2943 - val_accuracy300: 0.3511 - 6s/epoch - 18ms/step
Epoch 7/50
339/339 - 6s - loss: 3.2904 - accuracy300: 0.3566 - val_loss: 3.2962 - val_accuracy300: 0.3485 - 6s/epoch - 16ms/step
Epoch 8/50
339/339 - 5s - loss: 3.2881 - accuracy300: 0.3593 - val_loss: 3.2975 - val_accuracy300: 0.3472 - 5s/epoch - 16ms/step
Epoch 9/50
339/339 - 5s - loss: 3.2862 - accuracy300: 0.3613 - val_loss: 3.2964 - val_accuracy300: 0.3507 - 5s/epoch - 16ms/step
Epoch 10/50
339/339 - 5s - loss: 3.2828 - accuracy300: 0.3653 - val_loss: 3.2983 - val_accuracy300: 0.3468 - 5s/epoch - 16ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2803 - accuracy300: 0.3659 - val_loss: 3.2968 - val_accuracy300: 0.3502 - 6s/epoch - 16ms/step
Epoch 12/50
339/339 - 5s - loss: 3.2780 - accuracy300: 0.3681 - val_loss: 3.2980 - val_accuracy300: 0.3499 - 5s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.2775 - accuracy300: 0.3695 - val_loss: 3.2976 - val_accuracy300: 0.3503 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 5s - loss: 3.2748 - accuracy300: 0.3707 - val_loss: 3.2986 - val_accuracy300: 0.3474 - 5s/epoch - 16ms/step
Epoch 15/50
339/339 - 5s - loss: 3.2734 - accuracy300: 0.3721 - val_loss: 3.2985 - val_accuracy300: 0.3504 - 5s/epoch - 16ms/step
Epoch 16/50
339/339 - 6s - loss: 3.2726 - accuracy300: 0.3733 - val_loss: 3.2978 - val_accuracy300: 0.3491 - 6s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h300
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017708
{'0': {'precision': 0.36262982756882123, 'recall': 0.20481365044650993, 'f1-score': 0.2617759887026213, 'support': 87792}, '1': {'precision': 0.3435784448728541, 'recall': 0.21681651758817258, 'f1-score': 0.2658606408899433, 'support': 86308}, '2': {'precision': 0.31955813719235804, 'recall': 0.6033982121346605, 'f1-score': 0.41783299675125124, 'support': 78865}, 'accuracy': 0.3331725732808887, 'macro avg': {'precision': 0.3419221365446778, 'recall': 0.3416761267231143, 'f1-score': 0.31515654211460525, 'support': 252965}, 'weighted avg': {'precision': 0.3427016335527981, 'recall': 0.3331725732808887, 'f1-score': 0.3118223354333492, 'support': 252965}}
[[17981 19084 50727]
 [16994 18713 50601]
 [14610 16668 47587]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953983
{'0': {'precision': 0.3527373920945025, 'recall': 0.22038108079338609, 'f1-score': 0.27127601493743314, 'support': 28183}, '1': {'precision': 0.37250409165302784, 'recall': 0.2381085228065281, 'f1-score': 0.29051610432710717, 'support': 28676}, '2': {'precision': 0.356823840954903, 'recall': 0.6083352986759206, 'f1-score': 0.44980880136517065, 'support': 29681}, 'accuracy': 0.35931361220244973, 'macro avg': {'precision': 0.36068844156747776, 'recall': 0.35560830075861166, 'f1-score': 0.3372003068765703, 'support': 86540}, 'weighted avg': {'precision': 0.3606888569103775, 'recall': 0.35931361220244973, 'f1-score': 0.3388836003002708, 'support': 86540}}
[[ 6211  5591 16381]
 [ 5683  6828 16165]
 [ 5714  5911 18056]]
Evaluating performance on  val set...
124/124 - 1s - 770ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986022
{'0': {'precision': 0.3478072706289671, 'recall': 0.22653387202856337, 'f1-score': 0.2743669985775249, 'support': 10643}, '1': {'precision': 0.325658413499448, 'recall': 0.21330441070137382, 'f1-score': 0.2577705654724753, 'support': 9681}, '2': {'precision': 0.3565365025466893, 'recall': 0.5808351177730193, 'f1-score': 0.4418502053144195, 'support': 11208}, 'accuracy': 0.34840796651021183, 'macro avg': {'precision': 0.34333406222503476, 'recall': 0.34022446683431884, 'f1-score': 0.3246625897881399, 'support': 31532}, 'weighted avg': {'precision': 0.34410988846047014, 'recall': 0.34840796651021183, 'f1-score': 0.3288031812559826, 'support': 31532}}
[[2411 2092 6140]
 [2007 2065 5609]
 [2514 2184 6510]]
training model: results/XRAY/W4/deepOF_L1/h500
Epoch 1/50
339/339 - 7s - loss: 3.3467 - accuracy500: 0.3363 - val_loss: 3.3316 - val_accuracy500: 0.3484 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 6s - loss: 3.3241 - accuracy500: 0.3414 - val_loss: 3.3235 - val_accuracy500: 0.3455 - 6s/epoch - 17ms/step
Epoch 3/50
339/339 - 5s - loss: 3.3137 - accuracy500: 0.3424 - val_loss: 3.3156 - val_accuracy500: 0.3469 - 5s/epoch - 16ms/step
Epoch 4/50
339/339 - 6s - loss: 3.3042 - accuracy500: 0.3479 - val_loss: 3.3117 - val_accuracy500: 0.3468 - 6s/epoch - 17ms/step
Epoch 5/50
339/339 - 6s - loss: 3.2991 - accuracy500: 0.3505 - val_loss: 3.3107 - val_accuracy500: 0.3500 - 6s/epoch - 16ms/step
Epoch 6/50
339/339 - 5s - loss: 3.2965 - accuracy500: 0.3544 - val_loss: 3.3097 - val_accuracy500: 0.3475 - 5s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2926 - accuracy500: 0.3564 - val_loss: 3.3098 - val_accuracy500: 0.3432 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2900 - accuracy500: 0.3592 - val_loss: 3.3108 - val_accuracy500: 0.3448 - 6s/epoch - 16ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2872 - accuracy500: 0.3614 - val_loss: 3.3090 - val_accuracy500: 0.3458 - 6s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2849 - accuracy500: 0.3632 - val_loss: 3.3114 - val_accuracy500: 0.3425 - 6s/epoch - 16ms/step
Epoch 11/50
339/339 - 5s - loss: 3.2838 - accuracy500: 0.3619 - val_loss: 3.3096 - val_accuracy500: 0.3445 - 5s/epoch - 16ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2816 - accuracy500: 0.3652 - val_loss: 3.3116 - val_accuracy500: 0.3410 - 6s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.2805 - accuracy500: 0.3661 - val_loss: 3.3112 - val_accuracy500: 0.3405 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 5s - loss: 3.2784 - accuracy500: 0.3675 - val_loss: 3.3119 - val_accuracy500: 0.3407 - 5s/epoch - 16ms/step
Epoch 15/50
339/339 - 5s - loss: 3.2775 - accuracy500: 0.3694 - val_loss: 3.3133 - val_accuracy500: 0.3404 - 5s/epoch - 16ms/step
Epoch 16/50
339/339 - 5s - loss: 3.2736 - accuracy500: 0.3735 - val_loss: 3.3140 - val_accuracy500: 0.3418 - 5s/epoch - 16ms/step
Epoch 17/50
339/339 - 6s - loss: 3.2734 - accuracy500: 0.3732 - val_loss: 3.3121 - val_accuracy500: 0.3418 - 6s/epoch - 16ms/step
Epoch 18/50
339/339 - 5s - loss: 3.2722 - accuracy500: 0.3725 - val_loss: 3.3165 - val_accuracy500: 0.3376 - 5s/epoch - 16ms/step
Epoch 19/50
339/339 - 6s - loss: 3.2689 - accuracy500: 0.3755 - val_loss: 3.3174 - val_accuracy500: 0.3401 - 6s/epoch - 17ms/step
testing model: results/XRAY/W4/deepOF_L1/h500
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105677
{'0': {'precision': 0.3568483737975263, 'recall': 0.06245991019884541, 'f1-score': 0.10631183896281132, 'support': 87304}, '1': {'precision': 0.3630130567876554, 'recall': 0.255022437761271, 'f1-score': 0.29958303527122043, 'support': 91141}, '2': {'precision': 0.29663242272078133, 'recall': 0.6912506709608159, 'f1-score': 0.4151247501772936, 'support': 74520}, 'accuracy': 0.31707153163481117, 'macro avg': {'precision': 0.338831284435321, 'recall': 0.33624433964031075, 'f1-score': 0.27367320813710844, 'support': 252965}, 'weighted avg': {'precision': 0.34133066462101697, 'recall': 0.31707153163481117, 'f1-score': 0.26691772612683773, 'support': 252965}}
[[ 5453 22135 59716]
 [ 5470 23243 62428]
 [ 4358 18650 51512]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962858
{'0': {'precision': 0.3568627450980392, 'recall': 0.05902915420375509, 'f1-score': 0.10130183369924857, 'support': 27749}, '1': {'precision': 0.37347386493704693, 'recall': 0.26849756565864363, 'f1-score': 0.3124027606015878, 'support': 29166}, '2': {'precision': 0.3520219081040307, 'recall': 0.7246244725738397, 'f1-score': 0.47384859889412523, 'support': 29625}, 'accuracy': 0.3574763115322394, 'macro avg': {'precision': 0.360786172713039, 'recall': 0.35071706414541276, 'f1-score': 0.29585106439832054, 'support': 86540}, 'weighted avg': {'precision': 0.3608039298135118, 'recall': 0.3574763115322394, 'f1-score': 0.2999806822424869, 'support': 86540}}
[[ 1638  6406 19705]
 [ 1525  7831 19810]
 [ 1427  6731 21467]]
Evaluating performance on  val set...
124/124 - 1s - 989ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100829
{'0': {'precision': 0.3508492569002123, 'recall': 0.06267779252797269, 'f1-score': 0.10635559131134352, 'support': 10546}, '1': {'precision': 0.31943699731903485, 'recall': 0.24311365027545398, 'f1-score': 0.27609778704669213, 'support': 9802}, '2': {'precision': 0.3565440778799351, 'recall': 0.7073497854077253, 'f1-score': 0.47411003236245947, 'support': 11184}, 'accuracy': 0.34742483825954584, 'macro avg': {'precision': 0.3422767773663941, 'recall': 0.3377137427370507, 'f1-score': 0.28552113690683173, 'support': 31532}, 'weighted avg': {'precision': 0.34310435995179533, 'recall': 0.34742483825954584, 'f1-score': 0.289559278718218, 'support': 31532}}
[[ 661 2454 7431]
 [ 573 2383 6846]
 [ 650 2623 7911]]
training model: results/XRAY/W4/deepOF_L1/h1000
Epoch 1/50
339/339 - 7s - loss: 3.3488 - accuracy1000: 0.3368 - val_loss: 3.3211 - val_accuracy1000: 0.3563 - 7s/epoch - 22ms/step
Epoch 2/50
339/339 - 5s - loss: 3.3290 - accuracy1000: 0.3416 - val_loss: 3.3133 - val_accuracy1000: 0.3595 - 5s/epoch - 16ms/step
Epoch 3/50
339/339 - 5s - loss: 3.3160 - accuracy1000: 0.3477 - val_loss: 3.3110 - val_accuracy1000: 0.3574 - 5s/epoch - 16ms/step
Epoch 4/50
339/339 - 6s - loss: 3.3080 - accuracy1000: 0.3515 - val_loss: 3.3090 - val_accuracy1000: 0.3511 - 6s/epoch - 16ms/step
Epoch 5/50
339/339 - 5s - loss: 3.3030 - accuracy1000: 0.3517 - val_loss: 3.3055 - val_accuracy1000: 0.3494 - 5s/epoch - 16ms/step
Epoch 6/50
339/339 - 6s - loss: 3.2981 - accuracy1000: 0.3562 - val_loss: 3.3072 - val_accuracy1000: 0.3420 - 6s/epoch - 16ms/step
Epoch 7/50
339/339 - 5s - loss: 3.2941 - accuracy1000: 0.3579 - val_loss: 3.3088 - val_accuracy1000: 0.3330 - 5s/epoch - 16ms/step
Epoch 8/50
339/339 - 6s - loss: 3.2918 - accuracy1000: 0.3605 - val_loss: 3.3094 - val_accuracy1000: 0.3339 - 6s/epoch - 16ms/step
Epoch 9/50
339/339 - 6s - loss: 3.2891 - accuracy1000: 0.3619 - val_loss: 3.3085 - val_accuracy1000: 0.3303 - 6s/epoch - 16ms/step
Epoch 10/50
339/339 - 6s - loss: 3.2874 - accuracy1000: 0.3628 - val_loss: 3.3107 - val_accuracy1000: 0.3297 - 6s/epoch - 16ms/step
Epoch 11/50
339/339 - 6s - loss: 3.2853 - accuracy1000: 0.3633 - val_loss: 3.3108 - val_accuracy1000: 0.3234 - 6s/epoch - 17ms/step
Epoch 12/50
339/339 - 6s - loss: 3.2833 - accuracy1000: 0.3652 - val_loss: 3.3147 - val_accuracy1000: 0.3130 - 6s/epoch - 16ms/step
Epoch 13/50
339/339 - 5s - loss: 3.2819 - accuracy1000: 0.3671 - val_loss: 3.3128 - val_accuracy1000: 0.3231 - 5s/epoch - 16ms/step
Epoch 14/50
339/339 - 6s - loss: 3.2792 - accuracy1000: 0.3722 - val_loss: 3.3191 - val_accuracy1000: 0.3129 - 6s/epoch - 17ms/step
Epoch 15/50
339/339 - 5s - loss: 3.2785 - accuracy1000: 0.3695 - val_loss: 3.3189 - val_accuracy1000: 0.3125 - 5s/epoch - 16ms/step
testing model: results/XRAY/W4/deepOF_L1/h1000
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1072537
{'0': {'precision': 0.3518418364280993, 'recall': 0.06666059453736067, 'f1-score': 0.11208530352049313, 'support': 87833}, '1': {'precision': 0.36595154404535846, 'recall': 0.293724057419578, 'f1-score': 0.32588372860012593, 'support': 92512}, '2': {'precision': 0.2876763887432051, 'recall': 0.6420269898099698, 'f1-score': 0.39732243673596346, 'support': 72620}, 'accuracy': 0.314873599114502, 'macro avg': {'precision': 0.3351565897388877, 'recall': 0.33413721392230283, 'f1-score': 0.2784304896188608, 'support': 252965}, 'weighted avg': {'precision': 0.3385815927588599, 'recall': 0.314873599114502, 'f1-score': 0.2721582010164884, 'support': 252965}}
[[ 5855 25814 56164]
 [ 6056 27173 59283]
 [ 4730 21266 46624]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986065
{'0': {'precision': 0.34941224158897444, 'recall': 0.06141350812197207, 'f1-score': 0.10446585469308611, 'support': 28072}, '1': {'precision': 0.3530669032544259, 'recall': 0.3056059759843619, 'f1-score': 0.3276265319487323, 'support': 28648}, '2': {'precision': 0.3512295586966854, 'recall': 0.6691146881287726, 'f1-score': 0.4606540534924794, 'support': 29820}, 'accuracy': 0.35165241506817657, 'macro avg': {'precision': 0.3512362345133619, 'recall': 0.3453780574117022, 'f1-score': 0.2975821467114326, 'support': 86540}, 'weighted avg': {'precision': 0.35124828438471967, 'recall': 0.35165241506817657, 'f1-score': 0.30107596759137195, 'support': 86540}}
[[ 1724  7781 18567]
 [ 1604  8755 18289]
 [ 1606  8261 19953]]
Evaluating performance on  val set...
124/124 - 1s - 980ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018118
{'0': {'precision': 0.33368532206969376, 'recall': 0.05907094120945883, 'f1-score': 0.1003732232192488, 'support': 10699}, '1': {'precision': 0.296577528337185, 'recall': 0.29579629019866094, 'f1-score': 0.29618639410924275, 'support': 9111}, '2': {'precision': 0.3714174492725415, 'recall': 0.6511687425354035, 'f1-score': 0.47302698850432245, 'support': 11722}, 'accuracy': 0.3475834073322339, 'macro avg': {'precision': 0.3338934332264734, 'recall': 0.33534532464784106, 'f1-score': 0.2898622019442713, 'support': 31532}, 'weighted avg': {'precision': 0.3369901199377292, 'recall': 0.3475834073322339, 'f1-score': 0.29548616361790314, 'support': 31532}}
[[ 632 3024 7043]
 [ 541 2695 5875]
 [ 721 3368 7633]]
training model: results/XRAY/W4/deepLOB_L2/h10
Epoch 1/50
339/339 - 17s - loss: 3.3209 - accuracy10: 0.3681 - val_loss: 3.3805 - val_accuracy10: 0.3373 - 17s/epoch - 50ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2290 - accuracy10: 0.4099 - val_loss: 3.2926 - val_accuracy10: 0.3841 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 15s - loss: 3.1522 - accuracy10: 0.4436 - val_loss: 3.2838 - val_accuracy10: 0.3890 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.1146 - accuracy10: 0.4586 - val_loss: 3.3482 - val_accuracy10: 0.3975 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 15s - loss: 3.0933 - accuracy10: 0.4696 - val_loss: 3.2933 - val_accuracy10: 0.4039 - 15s/epoch - 43ms/step
Epoch 6/50
339/339 - 15s - loss: 3.0696 - accuracy10: 0.4771 - val_loss: 3.2520 - val_accuracy10: 0.4174 - 15s/epoch - 43ms/step
Epoch 7/50
339/339 - 14s - loss: 3.0479 - accuracy10: 0.4846 - val_loss: 3.2618 - val_accuracy10: 0.4180 - 14s/epoch - 43ms/step
Epoch 8/50
339/339 - 15s - loss: 3.0355 - accuracy10: 0.4892 - val_loss: 3.2647 - val_accuracy10: 0.4200 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.0251 - accuracy10: 0.4902 - val_loss: 3.2500 - val_accuracy10: 0.4244 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.0164 - accuracy10: 0.4925 - val_loss: 3.2877 - val_accuracy10: 0.4145 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.0087 - accuracy10: 0.4967 - val_loss: 3.2657 - val_accuracy10: 0.4243 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 15s - loss: 2.9985 - accuracy10: 0.4979 - val_loss: 3.2452 - val_accuracy10: 0.4262 - 15s/epoch - 43ms/step
Epoch 13/50
339/339 - 14s - loss: 2.9890 - accuracy10: 0.5016 - val_loss: 3.2518 - val_accuracy10: 0.4283 - 14s/epoch - 43ms/step
Epoch 14/50
339/339 - 14s - loss: 2.9804 - accuracy10: 0.5037 - val_loss: 3.2878 - val_accuracy10: 0.4271 - 14s/epoch - 42ms/step
Epoch 15/50
339/339 - 14s - loss: 2.9710 - accuracy10: 0.5060 - val_loss: 3.3151 - val_accuracy10: 0.4252 - 14s/epoch - 42ms/step
Epoch 16/50
339/339 - 14s - loss: 2.9654 - accuracy10: 0.5065 - val_loss: 3.2677 - val_accuracy10: 0.4264 - 14s/epoch - 42ms/step
Epoch 17/50
339/339 - 14s - loss: 2.9528 - accuracy10: 0.5103 - val_loss: 3.2638 - val_accuracy10: 0.4277 - 14s/epoch - 42ms/step
Epoch 18/50
339/339 - 14s - loss: 2.9447 - accuracy10: 0.5133 - val_loss: 3.3004 - val_accuracy10: 0.4261 - 14s/epoch - 43ms/step
Epoch 19/50
339/339 - 15s - loss: 2.9354 - accuracy10: 0.5135 - val_loss: 3.3136 - val_accuracy10: 0.4295 - 15s/epoch - 43ms/step
Epoch 20/50
339/339 - 15s - loss: 2.9230 - accuracy10: 0.5180 - val_loss: 3.3403 - val_accuracy10: 0.4254 - 15s/epoch - 43ms/step
Epoch 21/50
339/339 - 14s - loss: 2.9160 - accuracy10: 0.5198 - val_loss: 3.3619 - val_accuracy10: 0.4240 - 14s/epoch - 43ms/step
Epoch 22/50
339/339 - 14s - loss: 2.9059 - accuracy10: 0.5242 - val_loss: 3.3166 - val_accuracy10: 0.4240 - 14s/epoch - 42ms/step
testing model: results/XRAY/W4/deepLOB_L2/h10
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1175293
{'0': {'precision': 0.39652482817205964, 'recall': 0.36835157897757437, 'f1-score': 0.3819193406822273, 'support': 69697}, '1': {'precision': 0.6307131702238418, 'recall': 0.1052960909391132, 'f1-score': 0.18046411868092585, 'support': 115066}, '2': {'precision': 0.3283692475179571, 'recall': 0.8136967422220919, 'f1-score': 0.4679116432004047, 'support': 68206}, 'accuracy': 0.36877245828540256, 'macro avg': {'precision': 0.4518690819712862, 'recall': 0.4291148040462598, 'f1-score': 0.3434317008545193, 'support': 252969}, 'weighted avg': {'precision': 0.48467197755572583, 'recall': 0.36877245828540256, 'f1-score': 0.31347041773417067, 'support': 252969}}
[[25673  4084 39940]
 [29375 12116 73575]
 [ 9697  3010 55499]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0491993
{'0': {'precision': 0.46347153440019645, 'recall': 0.40349189381792266, 'f1-score': 0.43140691073945675, 'support': 28065}, '1': {'precision': 0.5774950571649617, 'recall': 0.2230485739898403, 'f1-score': 0.32180494347576166, 'support': 30119}, '2': {'precision': 0.41174023298201123, 'recall': 0.7328796106918682, 'f1-score': 0.5272598117563488, 'support': 28358}, 'accuracy': 0.44862610062166347, 'macro avg': {'precision': 0.4842356081823898, 'recall': 0.45314002616654375, 'f1-score': 0.42682388865718907, 'support': 86542}, 'weighted avg': {'precision': 0.48620359786689554, 'recall': 0.44862610062166347, 'f1-score': 0.42467139405416865, 'support': 86542}}
[[11324  2690 14051]
 [ 7759  6718 15642]
 [ 5350  2225 20783]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0842263
{'0': {'precision': 0.4534321624234612, 'recall': 0.39349305490817565, 'f1-score': 0.4213415851467359, 'support': 10727}, '1': {'precision': 0.5175521821631879, 'recall': 0.11031344792719919, 'f1-score': 0.18186364394065677, 'support': 9890}, '2': {'precision': 0.40452398707432263, 'recall': 0.745487860742098, 'f1-score': 0.5244601998066387, 'support': 10915}, 'accuracy': 0.42651909171635166, 'macro avg': {'precision': 0.4585027772203239, 'recall': 0.4164314545258243, 'f1-score': 0.3758884762980104, 'support': 31532}, 'weighted avg': {'precision': 0.45661351030149144, 'recall': 0.42651909171635166, 'f1-score': 0.38192457514054273, 'support': 31532}}
[[4221  531 5975]
 [2796 1091 6003]
 [2292  486 8137]]
training model: results/XRAY/W4/deepLOB_L2/h20
Epoch 1/50
339/339 - 17s - loss: 3.3199 - accuracy20: 0.3684 - val_loss: 3.3149 - val_accuracy20: 0.3571 - 17s/epoch - 50ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2656 - accuracy20: 0.3891 - val_loss: 3.2900 - val_accuracy20: 0.3717 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2214 - accuracy20: 0.4084 - val_loss: 3.3130 - val_accuracy20: 0.3706 - 14s/epoch - 42ms/step
Epoch 4/50
339/339 - 14s - loss: 3.1791 - accuracy20: 0.4303 - val_loss: 3.3544 - val_accuracy20: 0.3662 - 14s/epoch - 42ms/step
Epoch 5/50
339/339 - 15s - loss: 3.1476 - accuracy20: 0.4459 - val_loss: 3.3794 - val_accuracy20: 0.3613 - 15s/epoch - 43ms/step
Epoch 6/50
339/339 - 14s - loss: 3.1335 - accuracy20: 0.4515 - val_loss: 3.3811 - val_accuracy20: 0.3631 - 14s/epoch - 43ms/step
Epoch 7/50
339/339 - 15s - loss: 3.1153 - accuracy20: 0.4596 - val_loss: 3.3487 - val_accuracy20: 0.3661 - 15s/epoch - 43ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1028 - accuracy20: 0.4642 - val_loss: 3.3503 - val_accuracy20: 0.3643 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 14s - loss: 3.0902 - accuracy20: 0.4705 - val_loss: 3.3410 - val_accuracy20: 0.3716 - 14s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.0851 - accuracy20: 0.4722 - val_loss: 3.3372 - val_accuracy20: 0.3711 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.0716 - accuracy20: 0.4775 - val_loss: 3.3299 - val_accuracy20: 0.3728 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 14s - loss: 3.0661 - accuracy20: 0.4777 - val_loss: 3.3336 - val_accuracy20: 0.3761 - 14s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h20
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1431606
{'0': {'precision': 0.3062782547520096, 'recall': 0.3202991947899778, 'f1-score': 0.3131318512993327, 'support': 73397}, '1': {'precision': 0.570045904540678, 'recall': 0.09534778305072203, 'f1-score': 0.163369789190046, 'support': 108099}, '2': {'precision': 0.2979238732443354, 'recall': 0.6591440124242721, 'f1-score': 0.4103674152018258, 'support': 71473}, 'accuracy': 0.3199087635243844, 'macro avg': {'precision': 0.39141601084567434, 'recall': 0.35826366342165733, 'f1-score': 0.2956230185637348, 'support': 252969}, 'weighted avg': {'precision': 0.4166313275198479, 'recall': 0.3199087635243844, 'f1-score': 0.2766079622332855, 'support': 252969}}
[[23509  3613 46275]
 [33047 10307 64745]
 [20201  4161 47111]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1025006
{'0': {'precision': 0.35330113908651894, 'recall': 0.3337860899244245, 'f1-score': 0.34326647564469914, 'support': 28713}, '1': {'precision': 0.48287256305760545, 'recall': 0.15229096467155312, 'f1-score': 0.23155337241852847, 'support': 28787}, '2': {'precision': 0.35449777495232043, 'recall': 0.6144204944563046, 'f1-score': 0.44959560583537, 'support': 29042}, 'accuracy': 0.36759030297427836, 'macro avg': {'precision': 0.39689049236548163, 'recall': 0.3668325163507607, 'f1-score': 0.34147181796619924, 'support': 86542}, 'weighted avg': {'precision': 0.39680285248198327, 'recall': 0.36759030297427836, 'f1-score': 0.34178887513195033, 'support': 86542}}
[[ 9584  2262 16867]
 [ 8778  4384 15625]
 [ 8765  2433 17844]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0960363
{'0': {'precision': 0.3571352672404633, 'recall': 0.3068565689765361, 'f1-score': 0.330092319780004, 'support': 10953}, '1': {'precision': 0.4567617295308188, 'recall': 0.1064993564993565, 'f1-score': 0.17272569142459557, 'support': 9324}, '2': {'precision': 0.3737404120920439, 'recall': 0.6623722789871168, 'f1-score': 0.47785398371899235, 'support': 11255}, 'accuracy': 0.374508435874667, 'macro avg': {'precision': 0.3958791362877753, 'recall': 0.35857606815433646, 'f1-score': 0.3268906649745306, 'support': 31532}, 'weighted avg': {'precision': 0.39252179647108026, 'recall': 0.374508435874667, 'f1-score': 0.3363009676566844, 'support': 31532}}
[[3361  566 7026]
 [2865  993 5466]
 [3185  615 7455]]
training model: results/XRAY/W4/deepLOB_L2/h30
Epoch 1/50
339/339 - 17s - loss: 3.3330 - accuracy30: 0.3574 - val_loss: 3.3717 - val_accuracy30: 0.3419 - 17s/epoch - 49ms/step
Epoch 2/50
339/339 - 14s - loss: 3.2803 - accuracy30: 0.3785 - val_loss: 3.3577 - val_accuracy30: 0.3432 - 14s/epoch - 43ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2416 - accuracy30: 0.3981 - val_loss: 3.3667 - val_accuracy30: 0.3561 - 14s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.2114 - accuracy30: 0.4162 - val_loss: 3.3252 - val_accuracy30: 0.3776 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 15s - loss: 3.1850 - accuracy30: 0.4296 - val_loss: 3.2889 - val_accuracy30: 0.3898 - 15s/epoch - 43ms/step
Epoch 6/50
339/339 - 14s - loss: 3.1629 - accuracy30: 0.4378 - val_loss: 3.3098 - val_accuracy30: 0.3838 - 14s/epoch - 43ms/step
Epoch 7/50
339/339 - 15s - loss: 3.1524 - accuracy30: 0.4421 - val_loss: 3.3145 - val_accuracy30: 0.3820 - 15s/epoch - 43ms/step
Epoch 8/50
339/339 - 14s - loss: 3.1379 - accuracy30: 0.4501 - val_loss: 3.3549 - val_accuracy30: 0.3804 - 14s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1281 - accuracy30: 0.4529 - val_loss: 3.3456 - val_accuracy30: 0.3832 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.1205 - accuracy30: 0.4555 - val_loss: 3.3718 - val_accuracy30: 0.3797 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.1129 - accuracy30: 0.4610 - val_loss: 3.3652 - val_accuracy30: 0.3816 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 14s - loss: 3.1053 - accuracy30: 0.4615 - val_loss: 3.3808 - val_accuracy30: 0.3766 - 14s/epoch - 43ms/step
Epoch 13/50
339/339 - 15s - loss: 3.0951 - accuracy30: 0.4651 - val_loss: 3.3762 - val_accuracy30: 0.3802 - 15s/epoch - 43ms/step
Epoch 14/50
339/339 - 14s - loss: 3.0896 - accuracy30: 0.4681 - val_loss: 3.3591 - val_accuracy30: 0.3831 - 14s/epoch - 42ms/step
Epoch 15/50
339/339 - 14s - loss: 3.0762 - accuracy30: 0.4730 - val_loss: 3.3541 - val_accuracy30: 0.3850 - 14s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h30
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1250622
{'0': {'precision': 0.3872956723843184, 'recall': 0.26002347084843247, 'f1-score': 0.311147804080121, 'support': 77543}, '1': {'precision': 0.5039021852237253, 'recall': 0.038624897804542466, 'f1-score': 0.0717500416720686, 'support': 100298}, '2': {'precision': 0.32462995549115, 'recall': 0.8349084229581514, 'f1-score': 0.4674899757031914, 'support': 75128}, 'accuracy': 0.34297483090813496, 'macro avg': {'precision': 0.40527593769973125, 'recall': 0.37785226387037546, 'f1-score': 0.28346260715179367, 'support': 252969}, 'weighted avg': {'precision': 0.4149174364977745, 'recall': 0.34297483090813496, 'f1-score': 0.26266185479659293, 'support': 252969}}
[[20163  2169 55211]
 [21140  3874 75284]
 [10758  1645 62725]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927306
{'0': {'precision': 0.3923261592890536, 'recall': 0.31999312950875985, 'f1-score': 0.35248708682572416, 'support': 29110}, '1': {'precision': 0.4863852961198094, 'recall': 0.10207507410978964, 'f1-score': 0.1687380073800738, 'support': 27999}, '2': {'precision': 0.3777559158863728, 'recall': 0.7305745251928107, 'f1-score': 0.4980082449395526, 'support': 29433}, 'accuracy': 0.3891289778373507, 'macro avg': {'precision': 0.418822457098412, 'recall': 0.3842142429371201, 'f1-score': 0.3397444463817835, 'support': 86542}, 'weighted avg': {'precision': 0.41780183350565636, 'recall': 0.3891289778373507, 'f1-score': 0.3425304619657203, 'support': 86542}}
[[ 9315  1588 18207]
 [ 7928  2858 17213]
 [ 6500  1430 21503]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.094175
{'0': {'precision': 0.38561193443910097, 'recall': 0.36413345690454124, 'f1-score': 0.3745650412317079, 'support': 10790}, '1': {'precision': 0.4439252336448598, 'recall': 0.050036869272095226, 'f1-score': 0.08993657104989113, 'support': 9493}, '2': {'precision': 0.38681990825235535, 'recall': 0.697128633656325, 'f1-score': 0.4975572615950764, 'support': 11249}, 'accuracy': 0.3883673728276037, 'macro avg': {'precision': 0.405452358778772, 'recall': 0.37043298661098717, 'f1-score': 0.32068629129222515, 'support': 31532}, 'weighted avg': {'precision': 0.40359863514903277, 'recall': 0.3883673728276037, 'f1-score': 0.33275232460832677, 'support': 31532}}
[[3929  273 6588]
 [3175  475 5843]
 [3085  322 7842]]
training model: results/XRAY/W4/deepLOB_L2/h50
Epoch 1/50
339/339 - 16s - loss: 3.3343 - accuracy50: 0.3548 - val_loss: 3.4314 - val_accuracy50: 0.3254 - 16s/epoch - 48ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2889 - accuracy50: 0.3736 - val_loss: 3.3252 - val_accuracy50: 0.3459 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 15s - loss: 3.2635 - accuracy50: 0.3832 - val_loss: 3.3804 - val_accuracy50: 0.3293 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.2510 - accuracy50: 0.3907 - val_loss: 3.4326 - val_accuracy50: 0.3519 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2205 - accuracy50: 0.4082 - val_loss: 3.3989 - val_accuracy50: 0.3486 - 14s/epoch - 43ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2125 - accuracy50: 0.4147 - val_loss: 3.3572 - val_accuracy50: 0.3443 - 14s/epoch - 43ms/step
Epoch 7/50
339/339 - 14s - loss: 3.1945 - accuracy50: 0.4181 - val_loss: 3.4013 - val_accuracy50: 0.3473 - 14s/epoch - 42ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1803 - accuracy50: 0.4258 - val_loss: 3.4094 - val_accuracy50: 0.3510 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1691 - accuracy50: 0.4324 - val_loss: 3.4046 - val_accuracy50: 0.3498 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.1586 - accuracy50: 0.4353 - val_loss: 3.4114 - val_accuracy50: 0.3532 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 14s - loss: 3.1513 - accuracy50: 0.4394 - val_loss: 3.4013 - val_accuracy50: 0.3565 - 14s/epoch - 43ms/step
Epoch 12/50
339/339 - 15s - loss: 3.1395 - accuracy50: 0.4455 - val_loss: 3.4619 - val_accuracy50: 0.3553 - 15s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h50
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967569
{'0': {'precision': 0.2746847023459452, 'recall': 0.11835510755715734, 'f1-score': 0.16543025246462936, 'support': 71032}, '1': {'precision': 0.46077562909134584, 'recall': 0.5299150464481818, 'f1-score': 0.49293274867890585, 'support': 115828}, '2': {'precision': 0.25987325444450676, 'recall': 0.35046665355700435, 'f1-score': 0.29844651690024737, 'support': 66109}, 'accuracy': 0.36745609145784663, 'macro avg': {'precision': 0.3317778619605993, 'recall': 0.3329122691874478, 'f1-score': 0.31893650601459417, 'support': 252969}, 'weighted avg': {'precision': 0.356020240905018, 'recall': 0.36745609145784663, 'f1-score': 0.3501466855338256, 'support': 252969}}
[[ 8407 37116 25509]
 [13972 61379 40477]
 [ 8227 34713 23169]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1039759
{'0': {'precision': 0.36117956998385314, 'recall': 0.14766173302758667, 'f1-score': 0.20962292534957705, 'support': 28782}, '1': {'precision': 0.3536783325758068, 'recall': 0.57170346009866, 'f1-score': 0.43700692643008054, 'support': 28583}, '2': {'precision': 0.3555228895422092, 'recall': 0.3481509408095418, 'f1-score': 0.3517982995376544, 'support': 29177}, 'accuracy': 0.355307249659125, 'macro avg': {'precision': 0.3567935973672897, 'recall': 0.3558387113119295, 'f1-score': 0.33280938377243735, 'support': 86542}, 'weighted avg': {'precision': 0.3567949609607195, 'recall': 0.355307249659125, 'f1-score': 0.3326564558384676, 'support': 86542}}
[[ 4250 14715  9817]
 [ 3645 16341  8597]
 [ 3872 15147 10158]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1094381
{'0': {'precision': 0.3393739703459638, 'recall': 0.11862942700835014, 'f1-score': 0.17580541924471943, 'support': 10419}, '1': {'precision': 0.34105446792013955, 'recall': 0.6817785527462947, 'f1-score': 0.45466584838011564, 'support': 10323}, '2': {'precision': 0.3544251447477254, 'recall': 0.23827618164967562, 'f1-score': 0.28497007315451117, 'support': 10790}, 'accuracy': 0.34393631866040847, 'macro avg': {'precision': 0.3449511943379429, 'recall': 0.34622805380144017, 'f1-score': 0.3051471135931154, 'support': 31532}, 'weighted avg': {'precision': 0.34507452686801204, 'recall': 0.34393631866040847, 'f1-score': 0.30445450035759997, 'support': 31532}}
[[1236 6676 2507]
 [1109 7038 2176]
 [1297 6922 2571]]
training model: results/XRAY/W4/deepLOB_L2/h100
Epoch 1/50
339/339 - 17s - loss: 3.3542 - accuracy100: 0.3444 - val_loss: 3.3998 - val_accuracy100: 0.3409 - 17s/epoch - 49ms/step
Epoch 2/50
339/339 - 15s - loss: 3.3096 - accuracy100: 0.3586 - val_loss: 3.3421 - val_accuracy100: 0.3339 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 15s - loss: 3.2925 - accuracy100: 0.3638 - val_loss: 3.3223 - val_accuracy100: 0.3368 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2806 - accuracy100: 0.3717 - val_loss: 3.3282 - val_accuracy100: 0.3449 - 14s/epoch - 43ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2650 - accuracy100: 0.3824 - val_loss: 3.3280 - val_accuracy100: 0.3507 - 14s/epoch - 43ms/step
Epoch 6/50
339/339 - 15s - loss: 3.2476 - accuracy100: 0.3919 - val_loss: 3.3560 - val_accuracy100: 0.3496 - 15s/epoch - 43ms/step
Epoch 7/50
339/339 - 15s - loss: 3.2344 - accuracy100: 0.4027 - val_loss: 3.3501 - val_accuracy100: 0.3491 - 15s/epoch - 43ms/step
Epoch 8/50
339/339 - 14s - loss: 3.2257 - accuracy100: 0.4059 - val_loss: 3.3419 - val_accuracy100: 0.3539 - 14s/epoch - 42ms/step
Epoch 9/50
339/339 - 14s - loss: 3.2119 - accuracy100: 0.4112 - val_loss: 3.3775 - val_accuracy100: 0.3469 - 14s/epoch - 43ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2012 - accuracy100: 0.4175 - val_loss: 3.3694 - val_accuracy100: 0.3508 - 14s/epoch - 42ms/step
Epoch 11/50
339/339 - 14s - loss: 3.1944 - accuracy100: 0.4199 - val_loss: 3.3908 - val_accuracy100: 0.3517 - 14s/epoch - 43ms/step
Epoch 12/50
339/339 - 14s - loss: 3.1818 - accuracy100: 0.4267 - val_loss: 3.4197 - val_accuracy100: 0.3509 - 14s/epoch - 43ms/step
Epoch 13/50
339/339 - 15s - loss: 3.1740 - accuracy100: 0.4306 - val_loss: 3.4262 - val_accuracy100: 0.3484 - 15s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h100
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093998
{'0': {'precision': 0.31593749235773155, 'recall': 0.31270650029651326, 'f1-score': 0.3143136932892968, 'support': 82627}, '1': {'precision': 0.37125396803199595, 'recall': 0.2831031724873367, 'f1-score': 0.3212410154642917, 'support': 93775}, '2': {'precision': 0.29089668733321294, 'recall': 0.3787010069612235, 'f1-score': 0.3290419586371245, 'support': 76567}, 'accuracy': 0.32170740288335725, 'macro avg': {'precision': 0.3260293825743135, 'recall': 0.32483689324835785, 'f1-score': 0.321532222463571, 'support': 252969}, 'weighted avg': {'precision': 0.32886399002361877, 'recall': 0.32170740288335725, 'f1-score': 0.32133948984874583, 'support': 252969}}
[[25838 22732 34057]
 [30602 26548 36625]
 [25342 22229 28996]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014233
{'0': {'precision': 0.34496560350218886, 'recall': 0.2861688513817314, 'f1-score': 0.3128284623237173, 'support': 28913}, '1': {'precision': 0.36598426689413327, 'recall': 0.2724354451813179, 'f1-score': 0.312355915065723, 'support': 28348}, '2': {'precision': 0.34914968037631167, 'recall': 0.494313718793757, 'f1-score': 0.40923999095227326, 'support': 29281}, 'accuracy': 0.3520949365625939, 'macro avg': {'precision': 0.3533665169242113, 'recall': 0.3509726717856021, 'f1-score': 0.3448081227805712, 'support': 86542}, 'weighted avg': {'precision': 0.3532662092749469, 'recall': 0.3520949365625939, 'f1-score': 0.3452939727129286, 'support': 86542}}
[[ 8274  6419 14220]
 [ 7864  7723 12761]
 [ 7847  6960 14474]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085155
{'0': {'precision': 0.33294559770937726, 'recall': 0.3559403099292137, 'f1-score': 0.3440591770688859, 'support': 10454}, '1': {'precision': 0.32787350209175353, 'recall': 0.45209229565897535, 'f1-score': 0.38009124162590935, 'support': 10228}, '2': {'precision': 0.34175595714057255, 'recall': 0.1969585253456221, 'f1-score': 0.24989767876980645, 'support': 10850}, 'accuracy': 0.3324242039832551, 'macro avg': {'precision': 0.33419168564723445, 'recall': 0.3349970436446037, 'f1-score': 0.32468269915486725, 'support': 31532}, 'weighted avg': {'precision': 0.3343319672974596, 'recall': 0.3324242039832551, 'f1-score': 0.32334636785108256, 'support': 31532}}
[[3721 4634 2099]
 [3587 4624 2017]
 [3868 4845 2137]]
training model: results/XRAY/W4/deepLOB_L2/h200
Epoch 1/50
339/339 - 17s - loss: 3.3388 - accuracy200: 0.3557 - val_loss: 3.4592 - val_accuracy200: 0.3491 - 17s/epoch - 50ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2849 - accuracy200: 0.3733 - val_loss: 3.4114 - val_accuracy200: 0.3499 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2741 - accuracy200: 0.3779 - val_loss: 3.3554 - val_accuracy200: 0.3578 - 14s/epoch - 43ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2394 - accuracy200: 0.3983 - val_loss: 3.4549 - val_accuracy200: 0.3552 - 14s/epoch - 43ms/step
Epoch 5/50
339/339 - 15s - loss: 3.2346 - accuracy200: 0.3997 - val_loss: 3.4837 - val_accuracy200: 0.3576 - 15s/epoch - 44ms/step
Epoch 6/50
339/339 - 15s - loss: 3.2143 - accuracy200: 0.4083 - val_loss: 3.4622 - val_accuracy200: 0.3538 - 15s/epoch - 43ms/step
Epoch 7/50
339/339 - 15s - loss: 3.1991 - accuracy200: 0.4153 - val_loss: 3.5479 - val_accuracy200: 0.3536 - 15s/epoch - 43ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1862 - accuracy200: 0.4224 - val_loss: 3.5608 - val_accuracy200: 0.3541 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1719 - accuracy200: 0.4287 - val_loss: 3.5438 - val_accuracy200: 0.3556 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 14s - loss: 3.1611 - accuracy200: 0.4343 - val_loss: 3.6020 - val_accuracy200: 0.3561 - 14s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.1453 - accuracy200: 0.4393 - val_loss: 3.6396 - val_accuracy200: 0.3563 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 15s - loss: 3.1305 - accuracy200: 0.4488 - val_loss: 3.7273 - val_accuracy200: 0.3553 - 15s/epoch - 43ms/step
Epoch 13/50
339/339 - 15s - loss: 3.1206 - accuracy200: 0.4512 - val_loss: 3.8129 - val_accuracy200: 0.3553 - 15s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h200
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1349578
{'0': {'precision': 0.3443451224251846, 'recall': 0.03379529561347743, 'f1-score': 0.061549861640171816, 'support': 78650}, '1': {'precision': 0.44131628555036473, 'recall': 0.10659948724547876, 'f1-score': 0.17172015148495118, 'support': 101023}, '2': {'precision': 0.2895068101137434, 'recall': 0.8723122680637415, 'f1-score': 0.4347326479547433, 'support': 73296}, 'accuracy': 0.3058240337748894, 'macro avg': {'precision': 0.35838940602976427, 'recall': 0.3375690169742325, 'f1-score': 0.22266755369328875, 'support': 252969}, 'weighted avg': {'precision': 0.36718147341370755, 'recall': 0.3058240337748894, 'f1-score': 0.2136733973172784, 'support': 252969}}
[[ 2658  6955 69037]
 [ 2380 10769 87874]
 [ 2681  6678 63937]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012484
{'0': {'precision': 0.3735113403625882, 'recall': 0.17239085530231418, 'f1-score': 0.23590284099075362, 'support': 28563}, '1': {'precision': 0.42423698384201075, 'recall': 0.2483534192825112, 'f1-score': 0.3132982719759579, 'support': 28544}, '2': {'precision': 0.3469964165298593, 'recall': 0.6678104297604892, 'f1-score': 0.45669346219971185, 'support': 29435}, 'accuracy': 0.3659494811767697, 'macro avg': {'precision': 0.3815815802448194, 'recall': 0.36285156811510483, 'f1-score': 0.33529819172214115, 'support': 86542}, 'weighted avg': {'precision': 0.38122373416513794, 'recall': 0.3659494811767697, 'f1-score': 0.3365262044134542, 'support': 86542}}
[[ 4924  4814 18825]
 [ 3288  7089 18167]
 [ 4971  4807 19657]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117078
{'0': {'precision': 0.3676680972818312, 'recall': 0.02476869699306091, 'f1-score': 0.04641083521444696, 'support': 10376}, '1': {'precision': 0.38736510791366907, 'recall': 0.16983735830458355, 'f1-score': 0.23614061536353048, 'support': 10145}, '2': {'precision': 0.3520181921546333, 'recall': 0.843520116247389, 'f1-score': 0.49673761899668417, 'support': 11011}, 'accuracy': 0.3573512622098186, 'macro avg': {'precision': 0.36901713245004447, 'recall': 0.3460420571816778, 'f1-score': 0.25976302319155387, 'support': 31532}, 'weighted avg': {'precision': 0.36854038789151083, 'recall': 0.3573512622098186, 'f1-score': 0.2647083373024422, 'support': 31532}}
[[ 257 1247 8872]
 [ 197 1723 8225]
 [ 245 1478 9288]]
training model: results/XRAY/W4/deepLOB_L2/h300
Epoch 1/50
339/339 - 16s - loss: 3.3416 - accuracy300: 0.3540 - val_loss: 3.4076 - val_accuracy300: 0.3490 - 16s/epoch - 48ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2928 - accuracy300: 0.3755 - val_loss: 3.3956 - val_accuracy300: 0.3365 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 15s - loss: 3.2664 - accuracy300: 0.3883 - val_loss: 3.3465 - val_accuracy300: 0.3285 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.2449 - accuracy300: 0.4038 - val_loss: 3.3371 - val_accuracy300: 0.3535 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 15s - loss: 3.2224 - accuracy300: 0.4144 - val_loss: 3.3683 - val_accuracy300: 0.3609 - 15s/epoch - 43ms/step
Epoch 6/50
339/339 - 15s - loss: 3.2058 - accuracy300: 0.4254 - val_loss: 3.3859 - val_accuracy300: 0.3582 - 15s/epoch - 43ms/step
Epoch 7/50
339/339 - 14s - loss: 3.1899 - accuracy300: 0.4302 - val_loss: 3.3921 - val_accuracy300: 0.3601 - 14s/epoch - 43ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1690 - accuracy300: 0.4383 - val_loss: 3.4341 - val_accuracy300: 0.3587 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1525 - accuracy300: 0.4422 - val_loss: 3.5141 - val_accuracy300: 0.3578 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.1359 - accuracy300: 0.4480 - val_loss: 3.5632 - val_accuracy300: 0.3613 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.1244 - accuracy300: 0.4528 - val_loss: 3.5293 - val_accuracy300: 0.3608 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 14s - loss: 3.1031 - accuracy300: 0.4597 - val_loss: 3.6028 - val_accuracy300: 0.3590 - 14s/epoch - 43ms/step
Epoch 13/50
339/339 - 15s - loss: 3.0931 - accuracy300: 0.4641 - val_loss: 3.6326 - val_accuracy300: 0.3574 - 15s/epoch - 43ms/step
Epoch 14/50
339/339 - 15s - loss: 3.0717 - accuracy300: 0.4700 - val_loss: 3.7477 - val_accuracy300: 0.3580 - 15s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h300
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1245946
{'0': {'precision': 0.33078512396694215, 'recall': 0.018235870332824568, 'f1-score': 0.034566142021288083, 'support': 87794}, '1': {'precision': 0.37104788134804695, 'recall': 0.2310214580340177, 'f1-score': 0.28475132992966545, 'support': 86308}, '2': {'precision': 0.31139655952919876, 'recall': 0.7675326816032054, 'f1-score': 0.4430448768384573, 'support': 78867}, 'accuracy': 0.32443896287687424, 'macro avg': {'precision': 0.33774318828139593, 'recall': 0.33893000332334927, 'f1-score': 0.2541207829298036, 'support': 252969}, 'weighted avg': {'precision': 0.33847729238495733, 'recall': 0.32443896287687424, 'f1-score': 0.24727392667799272, 'support': 252969}}
[[ 1601 17298 68895]
 [ 1405 19939 64964]
 [ 1834 16500 60533]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009885
{'0': {'precision': 0.3314189189189189, 'recall': 0.06955227055195151, 'f1-score': 0.11497553400334028, 'support': 28209}, '1': {'precision': 0.42733188720173537, 'recall': 0.2823829668216621, 'f1-score': 0.3400555742674301, 'support': 28603}, '2': {'precision': 0.35981270556212636, 'recall': 0.7469895728220652, 'f1-score': 0.4856808564149107, 'support': 29730}, 'accuracy': 0.372616764114534, 'macro avg': {'precision': 0.37285450389426017, 'recall': 0.36630827006522626, 'f1-score': 0.313570654895227, 'support': 86542}, 'weighted avg': {'precision': 0.37287330995097223, 'recall': 0.372616764114534, 'f1-score': 0.3167161180777752, 'support': 86542}}
[[ 1962  5432 20815]
 [ 1828  8077 18698]
 [ 2130  5392 22208]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109015
{'0': {'precision': 0.33565459610027853, 'recall': 0.022595162197637353, 'f1-score': 0.042340126493323964, 'support': 10666}, '1': {'precision': 0.34339853300733497, 'recall': 0.29151100041511, 'f1-score': 0.3153345307588684, 'support': 9636}, '2': {'precision': 0.3614473800477158, 'recall': 0.7284951024042743, 'f1-score': 0.4831679659815733, 'support': 11230}, 'accuracy': 0.35617785107192695, 'macro avg': {'precision': 0.3468335030517764, 'recall': 0.34753375500567385, 'f1-score': 0.2802808744112552, 'support': 31532}, 'weighted avg': {'precision': 0.3472070995813808, 'recall': 0.35617785107192695, 'f1-score': 0.2827647972073867, 'support': 31532}}
[[ 241 2594 7831]
 [ 205 2809 6622]
 [ 272 2777 8181]]
training model: results/XRAY/W4/deepLOB_L2/h500
Epoch 1/50
339/339 - 17s - loss: 3.3596 - accuracy500: 0.3453 - val_loss: 3.4342 - val_accuracy500: 0.3495 - 17s/epoch - 49ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2982 - accuracy500: 0.3716 - val_loss: 3.3740 - val_accuracy500: 0.3508 - 15s/epoch - 43ms/step
Epoch 3/50
339/339 - 15s - loss: 3.2748 - accuracy500: 0.3868 - val_loss: 3.3281 - val_accuracy500: 0.3506 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2485 - accuracy500: 0.4048 - val_loss: 3.4471 - val_accuracy500: 0.3565 - 14s/epoch - 43ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2252 - accuracy500: 0.4189 - val_loss: 3.4517 - val_accuracy500: 0.3579 - 14s/epoch - 42ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2094 - accuracy500: 0.4208 - val_loss: 3.5014 - val_accuracy500: 0.3562 - 14s/epoch - 42ms/step
Epoch 7/50
339/339 - 15s - loss: 3.1934 - accuracy500: 0.4283 - val_loss: 3.6308 - val_accuracy500: 0.3629 - 15s/epoch - 43ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1813 - accuracy500: 0.4360 - val_loss: 3.4842 - val_accuracy500: 0.3559 - 15s/epoch - 44ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1565 - accuracy500: 0.4472 - val_loss: 3.5183 - val_accuracy500: 0.3548 - 15s/epoch - 43ms/step
Epoch 10/50
339/339 - 15s - loss: 3.1543 - accuracy500: 0.4453 - val_loss: 3.4269 - val_accuracy500: 0.3526 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.1318 - accuracy500: 0.4549 - val_loss: 3.6421 - val_accuracy500: 0.3593 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 14s - loss: 3.1074 - accuracy500: 0.4639 - val_loss: 3.5000 - val_accuracy500: 0.3595 - 14s/epoch - 43ms/step
Epoch 13/50
339/339 - 14s - loss: 3.0975 - accuracy500: 0.4652 - val_loss: 3.4889 - val_accuracy500: 0.3567 - 14s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h500
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1405512
{'0': {'precision': 0.299608551641072, 'recall': 0.056983483380294596, 'f1-score': 0.09575502112384637, 'support': 87306}, '1': {'precision': 0.36455306032584767, 'recall': 0.09083627745715477, 'f1-score': 0.1454344236377051, 'support': 91142}, '2': {'precision': 0.29000159135799003, 'recall': 0.831443485728855, 'f1-score': 0.4300164830398196, 'support': 74521}, 'accuracy': 0.2973249686720507, 'macro avg': {'precision': 0.31805440110830324, 'recall': 0.3264210821887681, 'f1-score': 0.2237353092671237, 'support': 252969}, 'weighted avg': {'precision': 0.32017728584681365, 'recall': 0.2973249686720507, 'f1-score': 0.21212255432893612, 'support': 252969}}
[[ 4975  7435 74896]
 [ 6065  8279 76798]
 [ 5565  6996 61960]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1127728
{'0': {'precision': 0.3159747511531925, 'recall': 0.09388977059587361, 'f1-score': 0.14476391746843892, 'support': 27724}, '1': {'precision': 0.3973553719008264, 'recall': 0.12337906730078352, 'f1-score': 0.18829303952796198, 'support': 29227}, '2': {'precision': 0.3462421817446446, 'recall': 0.8100435943361157, 'f1-score': 0.4851244687310261, 'support': 29591}, 'accuracy': 0.34872085230292804, 'macro avg': {'precision': 0.3531907682662212, 'recall': 0.3424374774109243, 'f1-score': 0.2727271419091423, 'support': 86542}, 'weighted avg': {'precision': 0.35380788351924314, 'recall': 0.34872085230292804, 'f1-score': 0.27584287014858144, 'support': 86542}}
[[ 2603  2664 22457]
 [ 2819  3606 22802]
 [ 2816  2805 23970]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041433
{'0': {'precision': 0.361998361998362, 'recall': 0.1254968767745599, 'f1-score': 0.18637992831541217, 'support': 10566}, '1': {'precision': 0.3318880567599527, 'recall': 0.1724349784968257, 'f1-score': 0.2269541778975741, 'support': 9766}, '2': {'precision': 0.36047378811142794, 'recall': 0.7336607142857143, 'f1-score': 0.48342403294602154, 'support': 11200}, 'accuracy': 0.35605099581377647, 'macro avg': {'precision': 0.35145340228991423, 'recall': 0.34386418985236666, 'f1-score': 0.29891937971966925, 'support': 31532}, 'weighted avg': {'precision': 0.35213116459597815, 'recall': 0.35605099581377647, 'f1-score': 0.30445496615894313, 'support': 31532}}
[[1326 1624 7616]
 [1120 1684 6962]
 [1217 1766 8217]]
training model: results/XRAY/W4/deepLOB_L2/h1000
Epoch 1/50
339/339 - 17s - loss: 3.3401 - accuracy1000: 0.3619 - val_loss: 3.5935 - val_accuracy1000: 0.3535 - 17s/epoch - 50ms/step
Epoch 2/50
339/339 - 15s - loss: 3.2923 - accuracy1000: 0.3807 - val_loss: 3.7553 - val_accuracy1000: 0.3669 - 15s/epoch - 44ms/step
Epoch 3/50
339/339 - 15s - loss: 3.2752 - accuracy1000: 0.3883 - val_loss: 3.3799 - val_accuracy1000: 0.3230 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.2438 - accuracy1000: 0.4000 - val_loss: 3.4466 - val_accuracy1000: 0.3587 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 15s - loss: 3.2299 - accuracy1000: 0.4136 - val_loss: 3.4437 - val_accuracy1000: 0.3537 - 15s/epoch - 43ms/step
Epoch 6/50
339/339 - 15s - loss: 3.1985 - accuracy1000: 0.4251 - val_loss: 3.4910 - val_accuracy1000: 0.3400 - 15s/epoch - 43ms/step
Epoch 7/50
339/339 - 15s - loss: 3.1825 - accuracy1000: 0.4351 - val_loss: 3.5980 - val_accuracy1000: 0.3664 - 15s/epoch - 44ms/step
Epoch 8/50
339/339 - 15s - loss: 3.1537 - accuracy1000: 0.4462 - val_loss: 3.6035 - val_accuracy1000: 0.3653 - 15s/epoch - 43ms/step
Epoch 9/50
339/339 - 15s - loss: 3.1524 - accuracy1000: 0.4464 - val_loss: 3.5918 - val_accuracy1000: 0.3611 - 15s/epoch - 44ms/step
Epoch 10/50
339/339 - 15s - loss: 3.1446 - accuracy1000: 0.4493 - val_loss: 3.6474 - val_accuracy1000: 0.3680 - 15s/epoch - 43ms/step
Epoch 11/50
339/339 - 15s - loss: 3.1169 - accuracy1000: 0.4602 - val_loss: 3.6620 - val_accuracy1000: 0.3642 - 15s/epoch - 43ms/step
Epoch 12/50
339/339 - 15s - loss: 3.0913 - accuracy1000: 0.4684 - val_loss: 3.6569 - val_accuracy1000: 0.3557 - 15s/epoch - 43ms/step
Epoch 13/50
339/339 - 15s - loss: 3.0751 - accuracy1000: 0.4743 - val_loss: 3.7117 - val_accuracy1000: 0.3548 - 15s/epoch - 43ms/step
testing model: results/XRAY/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1453078
{'0': {'precision': 0.30338733431516934, 'recall': 0.007035919622018557, 'f1-score': 0.013752893003382588, 'support': 87835}, '1': {'precision': 0.36924824843779586, 'recall': 0.31617519889311657, 'f1-score': 0.3406569729861932, 'support': 92512}, '2': {'precision': 0.2700722700722701, 'recall': 0.6385943653438352, 'f1-score': 0.3796037472527922, 'support': 72622}, 'accuracy': 0.3013966138143409, 'macro avg': {'precision': 0.3142359509417451, 'recall': 0.3206018279529901, 'f1-score': 0.24467120441412268, 'support': 252969}, 'weighted avg': {'precision': 0.3179089487891349, 'recall': 0.3013966138143409, 'f1-score': 0.23833128397093356, 'support': 252969}}
[[  618 24432 62785]
 [  706 29250 62556]
 [  713 25533 46376]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1279026
{'0': {'precision': 0.3277673545966229, 'recall': 0.062257225330529915, 'f1-score': 0.10463897457398699, 'support': 28061}, '1': {'precision': 0.36921091621660374, 'recall': 0.2694642109669318, 'f1-score': 0.31154846645560685, 'support': 28668}, '2': {'precision': 0.34933404103567817, 'recall': 0.7064367893200952, 'f1-score': 0.4674923975050499, 'support': 29813}, 'accuracy': 0.3528113517136188, 'macro avg': {'precision': 0.34877077061630163, 'recall': 0.346052741872519, 'f1-score': 0.29455994617821457, 'support': 86542}, 'weighted avg': {'precision': 0.3489255396088616, 'recall': 0.3528113517136188, 'f1-score': 0.29818003453453856, 'support': 86542}}
[[ 1747  6257 20057]
 [ 1772  7725 19171]
 [ 1811  6941 21061]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1255809
{'0': {'precision': 0.22448979591836735, 'recall': 0.010284218399401645, 'f1-score': 0.019667441444662974, 'support': 10696}, '1': {'precision': 0.2857431476867129, 'recall': 0.46432479754869777, 'f1-score': 0.3537749614374453, 'support': 9138}, '2': {'precision': 0.35725313407027726, 'recall': 0.494528979312703, 'f1-score': 0.41482915635868195, 'support': 11698}, 'accuracy': 0.32151465178231636, 'macro avg': {'precision': 0.2891620258917858, 'recall': 0.32304599842026743, 'f1-score': 0.26275718641359674, 'support': 31532}, 'weighted avg': {'precision': 0.2914947007185762, 'recall': 0.32151465178231636, 'f1-score': 0.2630924147656778, 'support': 31532}}
[[ 110 4893 5693]
 [ 180 4243 4715]
 [ 200 5713 5785]]
training model: results/XRAY/W4/deepOF_L2/h10
Epoch 1/50
339/339 - 11s - loss: 3.2784 - accuracy10: 0.3793 - val_loss: 3.2194 - val_accuracy10: 0.4126 - 11s/epoch - 31ms/step
Epoch 2/50
339/339 - 9s - loss: 3.1790 - accuracy10: 0.4274 - val_loss: 3.1774 - val_accuracy10: 0.4288 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.1390 - accuracy10: 0.4446 - val_loss: 3.1530 - val_accuracy10: 0.4439 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.1028 - accuracy10: 0.4590 - val_loss: 3.1418 - val_accuracy10: 0.4497 - 8s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.0744 - accuracy10: 0.4696 - val_loss: 3.1265 - val_accuracy10: 0.4529 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.0467 - accuracy10: 0.4801 - val_loss: 3.1175 - val_accuracy10: 0.4612 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 8s - loss: 3.0240 - accuracy10: 0.4881 - val_loss: 3.1041 - val_accuracy10: 0.4647 - 8s/epoch - 24ms/step
Epoch 8/50
339/339 - 8s - loss: 3.0052 - accuracy10: 0.4929 - val_loss: 3.0975 - val_accuracy10: 0.4652 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 2.9889 - accuracy10: 0.5001 - val_loss: 3.0940 - val_accuracy10: 0.4679 - 8s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 2.9716 - accuracy10: 0.5047 - val_loss: 3.0795 - val_accuracy10: 0.4742 - 8s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 2.9588 - accuracy10: 0.5094 - val_loss: 3.0775 - val_accuracy10: 0.4751 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 2.9476 - accuracy10: 0.5116 - val_loss: 3.0755 - val_accuracy10: 0.4727 - 8s/epoch - 25ms/step
Epoch 13/50
339/339 - 8s - loss: 2.9356 - accuracy10: 0.5168 - val_loss: 3.0740 - val_accuracy10: 0.4733 - 8s/epoch - 25ms/step
Epoch 14/50
339/339 - 8s - loss: 2.9257 - accuracy10: 0.5192 - val_loss: 3.0757 - val_accuracy10: 0.4726 - 8s/epoch - 25ms/step
Epoch 15/50
339/339 - 8s - loss: 2.9176 - accuracy10: 0.5198 - val_loss: 3.0773 - val_accuracy10: 0.4734 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 2.9049 - accuracy10: 0.5231 - val_loss: 3.0756 - val_accuracy10: 0.4768 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 2.8956 - accuracy10: 0.5269 - val_loss: 3.0680 - val_accuracy10: 0.4767 - 8s/epoch - 25ms/step
Epoch 18/50
339/339 - 8s - loss: 2.8885 - accuracy10: 0.5285 - val_loss: 3.0784 - val_accuracy10: 0.4767 - 8s/epoch - 24ms/step
Epoch 19/50
339/339 - 8s - loss: 2.8782 - accuracy10: 0.5322 - val_loss: 3.0747 - val_accuracy10: 0.4750 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 2.8674 - accuracy10: 0.5340 - val_loss: 3.0761 - val_accuracy10: 0.4742 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 2.8620 - accuracy10: 0.5365 - val_loss: 3.0813 - val_accuracy10: 0.4765 - 8s/epoch - 24ms/step
Epoch 22/50
339/339 - 8s - loss: 2.8511 - accuracy10: 0.5404 - val_loss: 3.0820 - val_accuracy10: 0.4768 - 8s/epoch - 25ms/step
Epoch 23/50
339/339 - 8s - loss: 2.8446 - accuracy10: 0.5414 - val_loss: 3.0885 - val_accuracy10: 0.4760 - 8s/epoch - 24ms/step
Epoch 24/50
339/339 - 8s - loss: 2.8386 - accuracy10: 0.5424 - val_loss: 3.0842 - val_accuracy10: 0.4746 - 8s/epoch - 25ms/step
Epoch 25/50
339/339 - 8s - loss: 2.8319 - accuracy10: 0.5426 - val_loss: 3.0893 - val_accuracy10: 0.4713 - 8s/epoch - 24ms/step
Epoch 26/50
339/339 - 8s - loss: 2.8198 - accuracy10: 0.5467 - val_loss: 3.1005 - val_accuracy10: 0.4720 - 8s/epoch - 24ms/step
Epoch 27/50
339/339 - 8s - loss: 2.8137 - accuracy10: 0.5482 - val_loss: 3.1033 - val_accuracy10: 0.4730 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h10
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0237019
{'0': {'precision': 0.42484926234765874, 'recall': 0.47516356749311295, 'f1-score': 0.44860002980101055, 'support': 69696}, '1': {'precision': 0.6299889213987444, 'recall': 0.38547777343240774, 'f1-score': 0.4782957982649578, 'support': 115065}, '2': {'precision': 0.38625739659111546, 'recall': 0.5924285965632514, 'f1-score': 0.4676268567758212, 'support': 68204}, 'accuracy': 0.4659854130017987, 'macro avg': {'precision': 0.48036519344583956, 'recall': 0.4843566458295907, 'f1-score': 0.46484089494726316, 'support': 252965}, 'weighted avg': {'precision': 0.5077551001380799, 'recall': 0.4659854130017987, 'f1-score': 0.4672375856102889, 'support': 252965}}
[[33117 13906 22673]
 [29180 44355 41530]
 [15653 12145 40406]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98362696
{'0': {'precision': 0.5001586126678651, 'recall': 0.5066047840057123, 'f1-score': 0.503361061350455, 'support': 28010}, '1': {'precision': 0.5984283903675539, 'recall': 0.391016297866702, 'f1-score': 0.4729829904033017, 'support': 30188}, '2': {'precision': 0.4676412444074498, 'recall': 0.6343236186578223, 'f1-score': 0.5383763064115233, 'support': 28342}, 'accuracy': 0.5081118557892305, 'macro avg': {'precision': 0.5220760824809563, 'recall': 0.5106482335100789, 'f1-score': 0.5049067860550934, 'support': 86540}, 'weighted avg': {'precision': 0.5237888506845223, 'recall': 0.5081118557892305, 'f1-score': 0.5042317439223077, 'support': 86540}}
[[14190  3954  9866]
 [ 7784 11804 10600]
 [ 6397  3967 17978]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0236355
{'0': {'precision': 0.4692631759951853, 'recall': 0.5132110954395863, 'f1-score': 0.49025419922752184, 'support': 10635}, '1': {'precision': 0.5081163341224214, 'recall': 0.3047049280064896, 'f1-score': 0.3809584178498986, 'support': 9862}, '2': {'precision': 0.470508329162794, 'recall': 0.5963751699139103, 'f1-score': 0.5260171049476461, 'support': 11035}, 'accuracy': 0.4771026259038437, 'macro avg': {'precision': 0.48262927976013353, 'recall': 0.47143039778666207, 'f1-score': 0.46574324067502215, 'support': 31532}, 'weighted avg': {'precision': 0.4818507096326128, 'recall': 0.4771026259038437, 'f1-score': 0.46858632749960893, 'support': 31532}}
[[5458 1423 3754]
 [3205 3005 3652]
 [2968 1486 6581]]
training model: results/XRAY/W4/deepOF_L2/h20
Epoch 1/50
339/339 - 10s - loss: 3.2986 - accuracy20: 0.3678 - val_loss: 3.2497 - val_accuracy20: 0.3952 - 10s/epoch - 29ms/step
Epoch 2/50
339/339 - 8s - loss: 3.2269 - accuracy20: 0.4092 - val_loss: 3.2181 - val_accuracy20: 0.4154 - 8s/epoch - 24ms/step
Epoch 3/50
339/339 - 8s - loss: 3.1977 - accuracy20: 0.4217 - val_loss: 3.1990 - val_accuracy20: 0.4248 - 8s/epoch - 24ms/step
Epoch 4/50
339/339 - 8s - loss: 3.1755 - accuracy20: 0.4311 - val_loss: 3.1936 - val_accuracy20: 0.4254 - 8s/epoch - 24ms/step
Epoch 5/50
339/339 - 8s - loss: 3.1519 - accuracy20: 0.4417 - val_loss: 3.1842 - val_accuracy20: 0.4322 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.1360 - accuracy20: 0.4498 - val_loss: 3.1832 - val_accuracy20: 0.4330 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 8s - loss: 3.1207 - accuracy20: 0.4546 - val_loss: 3.1748 - val_accuracy20: 0.4359 - 8s/epoch - 24ms/step
Epoch 8/50
339/339 - 8s - loss: 3.1058 - accuracy20: 0.4602 - val_loss: 3.1741 - val_accuracy20: 0.4401 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 3.0898 - accuracy20: 0.4641 - val_loss: 3.1667 - val_accuracy20: 0.4408 - 8s/epoch - 24ms/step
Epoch 10/50
339/339 - 8s - loss: 3.0749 - accuracy20: 0.4710 - val_loss: 3.1611 - val_accuracy20: 0.4461 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.0661 - accuracy20: 0.4735 - val_loss: 3.1636 - val_accuracy20: 0.4451 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 3.0572 - accuracy20: 0.4785 - val_loss: 3.1622 - val_accuracy20: 0.4468 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.0439 - accuracy20: 0.4818 - val_loss: 3.1607 - val_accuracy20: 0.4479 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.0372 - accuracy20: 0.4845 - val_loss: 3.1615 - val_accuracy20: 0.4490 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.0295 - accuracy20: 0.4878 - val_loss: 3.1563 - val_accuracy20: 0.4481 - 8s/epoch - 25ms/step
Epoch 16/50
339/339 - 8s - loss: 3.0155 - accuracy20: 0.4936 - val_loss: 3.1615 - val_accuracy20: 0.4481 - 8s/epoch - 25ms/step
Epoch 17/50
339/339 - 8s - loss: 3.0093 - accuracy20: 0.4944 - val_loss: 3.1587 - val_accuracy20: 0.4496 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.0003 - accuracy20: 0.4966 - val_loss: 3.1631 - val_accuracy20: 0.4502 - 8s/epoch - 25ms/step
Epoch 19/50
339/339 - 8s - loss: 2.9904 - accuracy20: 0.4987 - val_loss: 3.1653 - val_accuracy20: 0.4486 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 2.9815 - accuracy20: 0.5037 - val_loss: 3.1723 - val_accuracy20: 0.4460 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 2.9745 - accuracy20: 0.5059 - val_loss: 3.1761 - val_accuracy20: 0.4458 - 8s/epoch - 24ms/step
Epoch 22/50
339/339 - 8s - loss: 2.9652 - accuracy20: 0.5081 - val_loss: 3.1708 - val_accuracy20: 0.4470 - 8s/epoch - 24ms/step
Epoch 23/50
339/339 - 8s - loss: 2.9587 - accuracy20: 0.5101 - val_loss: 3.1790 - val_accuracy20: 0.4449 - 8s/epoch - 24ms/step
Epoch 24/50
339/339 - 8s - loss: 2.9479 - accuracy20: 0.5129 - val_loss: 3.1903 - val_accuracy20: 0.4429 - 8s/epoch - 25ms/step
Epoch 25/50
339/339 - 8s - loss: 2.9416 - accuracy20: 0.5150 - val_loss: 3.1875 - val_accuracy20: 0.4421 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h20
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0558193
{'0': {'precision': 0.4107550259011729, 'recall': 0.4170118262575617, 'f1-score': 0.4138597795957001, 'support': 73396}, '1': {'precision': 0.5451314159003456, 'recall': 0.3092934189346704, 'f1-score': 0.39466446320014165, 'support': 108098}, '2': {'precision': 0.3695301360155056, 'recall': 0.6055463054945363, 'f1-score': 0.45897449493610476, 'support': 71471}, 'accuracy': 0.4242484138121875, 'macro avg': {'precision': 0.44180552593900807, 'recall': 0.44395051689558945, 'f1-score': 0.4224995792439821, 'support': 252965}, 'weighted avg': {'precision': 0.45652987578598714, 'recall': 0.4242484138121875, 'f1-score': 0.418403564342076, 'support': 252965}}
[[30607 15504 27285]
 [28109 33434 46555]
 [15798 12394 43279]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0232639
{'0': {'precision': 0.4790859798605732, 'recall': 0.4749720748394303, 'f1-score': 0.4770201577563541, 'support': 28648}, '1': {'precision': 0.5281686029540545, 'recall': 0.3135657840011091, 'f1-score': 0.39351036297601183, 'support': 28852}, '2': {'precision': 0.4485113023970348, 'recall': 0.6333677685950413, 'f1-score': 0.5251466830361604, 'support': 29040}, 'accuracy': 0.47431245666743704, 'macro avg': {'precision': 0.4852552950705542, 'recall': 0.4739685424785269, 'f1-score': 0.4652257345895088, 'support': 86540}, 'weighted avg': {'precision': 0.4851900150807254, 'recall': 0.47431245666743704, 'f1-score': 0.46532810431428273, 'support': 86540}}
[[13607  4172 10869]
 [ 8058  9047 11747]
 [ 6737  3910 18393]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0537019
{'0': {'precision': 0.45798207471825364, 'recall': 0.47313898056472314, 'f1-score': 0.4654371646300221, 'support': 10908}, '1': {'precision': 0.4192979015493234, 'recall': 0.23073602417440103, 'f1-score': 0.2976679429168117, 'support': 9266}, '2': {'precision': 0.4517937219730942, 'recall': 0.6031871808416975, 'f1-score': 0.5166277053012592, 'support': 11358}, 'accuracy': 0.44875047570721804, 'macro avg': {'precision': 0.4430245660802237, 'recall': 0.4356873951936073, 'f1-score': 0.42657760428269764, 'support': 31532}, 'weighted avg': {'precision': 0.4443852569121256, 'recall': 0.44875047570721804, 'f1-score': 0.43457558124011036, 'support': 31532}}
[[5161 1432 4315]
 [3130 2138 3998]
 [2978 1529 6851]]
training model: results/XRAY/W4/deepOF_L2/h30
Epoch 1/50
339/339 - 10s - loss: 3.3111 - accuracy30: 0.3604 - val_loss: 3.2750 - val_accuracy30: 0.3836 - 10s/epoch - 30ms/step
Epoch 2/50
339/339 - 8s - loss: 3.2582 - accuracy30: 0.3923 - val_loss: 3.2396 - val_accuracy30: 0.4065 - 8s/epoch - 24ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2361 - accuracy30: 0.4032 - val_loss: 3.2314 - val_accuracy30: 0.4124 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2184 - accuracy30: 0.4137 - val_loss: 3.2282 - val_accuracy30: 0.4139 - 8s/epoch - 24ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2022 - accuracy30: 0.4196 - val_loss: 3.2190 - val_accuracy30: 0.4170 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.1893 - accuracy30: 0.4298 - val_loss: 3.2205 - val_accuracy30: 0.4140 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 8s - loss: 3.1784 - accuracy30: 0.4335 - val_loss: 3.2125 - val_accuracy30: 0.4205 - 8s/epoch - 24ms/step
Epoch 8/50
339/339 - 8s - loss: 3.1694 - accuracy30: 0.4376 - val_loss: 3.2141 - val_accuracy30: 0.4214 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 9s - loss: 3.1580 - accuracy30: 0.4424 - val_loss: 3.2114 - val_accuracy30: 0.4247 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.1494 - accuracy30: 0.4458 - val_loss: 3.2097 - val_accuracy30: 0.4249 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.1414 - accuracy30: 0.4486 - val_loss: 3.2060 - val_accuracy30: 0.4284 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 3.1300 - accuracy30: 0.4533 - val_loss: 3.2101 - val_accuracy30: 0.4254 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.1213 - accuracy30: 0.4549 - val_loss: 3.2113 - val_accuracy30: 0.4266 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.1114 - accuracy30: 0.4597 - val_loss: 3.2040 - val_accuracy30: 0.4278 - 8s/epoch - 25ms/step
Epoch 15/50
339/339 - 8s - loss: 3.1019 - accuracy30: 0.4623 - val_loss: 3.2055 - val_accuracy30: 0.4314 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.0935 - accuracy30: 0.4670 - val_loss: 3.2098 - val_accuracy30: 0.4264 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 3.0832 - accuracy30: 0.4698 - val_loss: 3.2041 - val_accuracy30: 0.4303 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.0771 - accuracy30: 0.4701 - val_loss: 3.2028 - val_accuracy30: 0.4310 - 8s/epoch - 25ms/step
Epoch 19/50
339/339 - 8s - loss: 3.0667 - accuracy30: 0.4764 - val_loss: 3.2131 - val_accuracy30: 0.4289 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 3.0584 - accuracy30: 0.4788 - val_loss: 3.2219 - val_accuracy30: 0.4226 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 3.0502 - accuracy30: 0.4813 - val_loss: 3.2183 - val_accuracy30: 0.4282 - 8s/epoch - 24ms/step
Epoch 22/50
339/339 - 8s - loss: 3.0422 - accuracy30: 0.4840 - val_loss: 3.2222 - val_accuracy30: 0.4269 - 8s/epoch - 25ms/step
Epoch 23/50
339/339 - 8s - loss: 3.0319 - accuracy30: 0.4869 - val_loss: 3.2252 - val_accuracy30: 0.4264 - 8s/epoch - 24ms/step
Epoch 24/50
339/339 - 8s - loss: 3.0229 - accuracy30: 0.4919 - val_loss: 3.2316 - val_accuracy30: 0.4267 - 8s/epoch - 24ms/step
Epoch 25/50
339/339 - 8s - loss: 3.0110 - accuracy30: 0.4937 - val_loss: 3.2419 - val_accuracy30: 0.4244 - 8s/epoch - 25ms/step
Epoch 26/50
339/339 - 8s - loss: 3.0045 - accuracy30: 0.4969 - val_loss: 3.2473 - val_accuracy30: 0.4220 - 8s/epoch - 24ms/step
Epoch 27/50
339/339 - 8s - loss: 2.9956 - accuracy30: 0.4998 - val_loss: 3.2628 - val_accuracy30: 0.4209 - 8s/epoch - 24ms/step
Epoch 28/50
339/339 - 8s - loss: 2.9865 - accuracy30: 0.5041 - val_loss: 3.2639 - val_accuracy30: 0.4206 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h30
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0820446
{'0': {'precision': 0.38327582488678025, 'recall': 0.5500760877975807, 'f1-score': 0.4517714346237356, 'support': 77542}, '1': {'precision': 0.4723217193096711, 'recall': 0.1446204771827672, 'f1-score': 0.22143854908516336, 'support': 100297}, '2': {'precision': 0.37782403777699675, 'recall': 0.5580757660463754, 'f1-score': 0.4505919083469018, 'support': 75126}, 'accuracy': 0.3916945031921412, 'macro avg': {'precision': 0.41114052732448275, 'recall': 0.41759077700890773, 'f1-score': 0.37460063068526694, 'support': 252965}, 'weighted avg': {'precision': 0.41696216534701425, 'recall': 0.3916945031921412, 'f1-score': 0.36009744608012045, 'support': 252965}}
[[42654  8098 26790]
 [43541 14505 42251]
 [25093  8107 41926]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0417315
{'0': {'precision': 0.43835194455140547, 'recall': 0.5879153038388707, 'f1-score': 0.502235294117647, 'support': 29045}, '1': {'precision': 0.5011924067537918, 'recall': 0.18679560564582073, 'f1-score': 0.27215747215747216, 'support': 28127}, '2': {'precision': 0.45280577866422295, 'recall': 0.5720512122037592, 'f1-score': 0.5054911990371597, 'support': 29368}, 'accuracy': 0.45216085047376936, 'macro avg': {'precision': 0.46411670998980675, 'recall': 0.4489207072294836, 'f1-score': 0.4266279884374263, 'support': 86540}, 'weighted avg': {'precision': 0.4636812013181231, 'recall': 0.45216085047376936, 'f1-score': 0.428560929862995, 'support': 86540}}
[[17076  2547  9422]
 [11993  5254 10880]
 [ 9886  2682 16800]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0668269
{'0': {'precision': 0.4205870250994377, 'recall': 0.5685020393029292, 'f1-score': 0.48348443042964134, 'support': 10788}, '1': {'precision': 0.39980670103092786, 'recall': 0.13079679595278246, 'f1-score': 0.19710927573062262, 'support': 9488}, '2': {'precision': 0.45153835042611584, 'recall': 0.5554371002132196, 'f1-score': 0.49812763923193376, 'support': 11256}, 'accuracy': 0.4321324368895091, 'macro avg': {'precision': 0.4239773588521605, 'recall': 0.41824531182297714, 'f1-score': 0.39290711513073256, 'support': 31532}, 'weighted avg': {'precision': 0.4253829277733901, 'recall': 0.4321324368895091, 'f1-score': 0.40254115028548026, 'support': 31532}}
[[6133  863 3792]
 [4445 1241 3802]
 [4004 1000 6252]]
training model: results/XRAY/W4/deepOF_L2/h50
Epoch 1/50
339/339 - 10s - loss: 3.3194 - accuracy50: 0.3572 - val_loss: 3.3032 - val_accuracy50: 0.3515 - 10s/epoch - 31ms/step
Epoch 2/50
339/339 - 8s - loss: 3.2786 - accuracy50: 0.3812 - val_loss: 3.2820 - val_accuracy50: 0.3614 - 8s/epoch - 24ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2586 - accuracy50: 0.3897 - val_loss: 3.2694 - val_accuracy50: 0.3701 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2453 - accuracy50: 0.3965 - val_loss: 3.2636 - val_accuracy50: 0.3816 - 8s/epoch - 24ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2331 - accuracy50: 0.4040 - val_loss: 3.2584 - val_accuracy50: 0.3834 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2240 - accuracy50: 0.4086 - val_loss: 3.2537 - val_accuracy50: 0.3880 - 8s/epoch - 25ms/step
Epoch 7/50
339/339 - 8s - loss: 3.2161 - accuracy50: 0.4152 - val_loss: 3.2544 - val_accuracy50: 0.3935 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2080 - accuracy50: 0.4175 - val_loss: 3.2527 - val_accuracy50: 0.3887 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 3.1996 - accuracy50: 0.4229 - val_loss: 3.2490 - val_accuracy50: 0.3931 - 8s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.1910 - accuracy50: 0.4274 - val_loss: 3.2483 - val_accuracy50: 0.3969 - 8s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 3.1838 - accuracy50: 0.4312 - val_loss: 3.2434 - val_accuracy50: 0.3997 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 3.1772 - accuracy50: 0.4336 - val_loss: 3.2429 - val_accuracy50: 0.4008 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.1704 - accuracy50: 0.4375 - val_loss: 3.2435 - val_accuracy50: 0.4006 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.1607 - accuracy50: 0.4410 - val_loss: 3.2410 - val_accuracy50: 0.4032 - 8s/epoch - 25ms/step
Epoch 15/50
339/339 - 8s - loss: 3.1553 - accuracy50: 0.4421 - val_loss: 3.2417 - val_accuracy50: 0.4027 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.1478 - accuracy50: 0.4456 - val_loss: 3.2435 - val_accuracy50: 0.4032 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 3.1414 - accuracy50: 0.4480 - val_loss: 3.2392 - val_accuracy50: 0.4046 - 8s/epoch - 25ms/step
Epoch 18/50
339/339 - 8s - loss: 3.1331 - accuracy50: 0.4503 - val_loss: 3.2410 - val_accuracy50: 0.4076 - 8s/epoch - 25ms/step
Epoch 19/50
339/339 - 8s - loss: 3.1270 - accuracy50: 0.4535 - val_loss: 3.2422 - val_accuracy50: 0.4046 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 3.1161 - accuracy50: 0.4578 - val_loss: 3.2502 - val_accuracy50: 0.4018 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 3.1088 - accuracy50: 0.4597 - val_loss: 3.2566 - val_accuracy50: 0.4019 - 8s/epoch - 24ms/step
Epoch 22/50
339/339 - 8s - loss: 3.1001 - accuracy50: 0.4639 - val_loss: 3.2537 - val_accuracy50: 0.4023 - 8s/epoch - 24ms/step
Epoch 23/50
339/339 - 8s - loss: 3.0896 - accuracy50: 0.4692 - val_loss: 3.2623 - val_accuracy50: 0.3994 - 8s/epoch - 24ms/step
Epoch 24/50
339/339 - 8s - loss: 3.0818 - accuracy50: 0.4715 - val_loss: 3.2760 - val_accuracy50: 0.3980 - 8s/epoch - 24ms/step
Epoch 25/50
339/339 - 8s - loss: 3.0730 - accuracy50: 0.4770 - val_loss: 3.2815 - val_accuracy50: 0.3958 - 8s/epoch - 24ms/step
Epoch 26/50
339/339 - 8s - loss: 3.0618 - accuracy50: 0.4793 - val_loss: 3.2851 - val_accuracy50: 0.3982 - 8s/epoch - 24ms/step
Epoch 27/50
339/339 - 8s - loss: 3.0520 - accuracy50: 0.4825 - val_loss: 3.3006 - val_accuracy50: 0.3946 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h50
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772384
{'0': {'precision': 0.3473877389829721, 'recall': 0.42105559544424265, 'f1-score': 0.38069053301511535, 'support': 71031}, '1': {'precision': 0.4926513007884399, 'recall': 0.3096514629576869, 'f1-score': 0.3802808687953602, 'support': 115827}, '2': {'precision': 0.32618609743911386, 'recall': 0.4641565946117658, 'f1-score': 0.3831285585855559, 'support': 66107}, 'accuracy': 0.38130966734528493, 'macro avg': {'precision': 0.38874171240350863, 'recall': 0.39828788433789847, 'f1-score': 0.3813666534653439, 'support': 252965}, 'weighted avg': {'precision': 0.4083600697627325, 'recall': 0.38130966734528493, 'f1-score': 0.38114008286906165, 'support': 252965}}
[[29908 19801 21322]
 [37898 35866 42063]
 [18288 17135 30684]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0585331
{'0': {'precision': 0.4326475290192535, 'recall': 0.4335364791920599, 'f1-score': 0.4330915479483032, 'support': 28715}, '1': {'precision': 0.4104317732366513, 'recall': 0.34764098269123395, 'f1-score': 0.37643591293833134, 'support': 28656}, '2': {'precision': 0.44019824446169464, 'recall': 0.5054681339778532, 'f1-score': 0.4705807254679795, 'support': 29169}, 'accuracy': 0.4293390339727294, 'macro avg': {'precision': 0.4277591822391999, 'recall': 0.428881865287049, 'f1-score': 0.4267027287848713, 'support': 86540}, 'weighted avg': {'precision': 0.42783625239612333, 'recall': 0.4293390339727294, 'f1-score': 0.4269671886026328, 'support': 86540}}
[[12449  7265  9001]
 [ 8945  9962  9749]
 [ 7380  7045 14744]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802224
{'0': {'precision': 0.39505395683453237, 'recall': 0.4225663716814159, 'f1-score': 0.40834727644543595, 'support': 10396}, '1': {'precision': 0.37812391026386144, 'recall': 0.3143298869455986, 'f1-score': 0.34328830730265936, 'support': 10349}, '2': {'precision': 0.426962486239309, 'recall': 0.4674144803930657, 'f1-score': 0.4462736767569482, 'support': 10787}, 'accuracy': 0.4023848788532285, 'macro avg': {'precision': 0.40004678444590097, 'recall': 0.40143691300669343, 'f1-score': 0.3993030868350145, 'support': 31532}, 'weighted avg': {'precision': 0.400413219004057, 'recall': 0.4023848788532285, 'f1-score': 0.3999690197063039, 'support': 31532}}
[[4393 2670 3333]
 [3662 3253 3434]
 [3065 2680 5042]]
training model: results/XRAY/W4/deepOF_L2/h100
Epoch 1/50
339/339 - 10s - loss: 3.3352 - accuracy100: 0.3405 - val_loss: 3.3164 - val_accuracy100: 0.3501 - 10s/epoch - 30ms/step
Epoch 2/50
339/339 - 8s - loss: 3.3022 - accuracy100: 0.3590 - val_loss: 3.2978 - val_accuracy100: 0.3643 - 8s/epoch - 24ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2868 - accuracy100: 0.3676 - val_loss: 3.2924 - val_accuracy100: 0.3677 - 8s/epoch - 24ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2774 - accuracy100: 0.3743 - val_loss: 3.2863 - val_accuracy100: 0.3722 - 8s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2682 - accuracy100: 0.3797 - val_loss: 3.2866 - val_accuracy100: 0.3726 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2605 - accuracy100: 0.3863 - val_loss: 3.2836 - val_accuracy100: 0.3742 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 8s - loss: 3.2555 - accuracy100: 0.3901 - val_loss: 3.2837 - val_accuracy100: 0.3766 - 8s/epoch - 24ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2501 - accuracy100: 0.3940 - val_loss: 3.2832 - val_accuracy100: 0.3784 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 3.2429 - accuracy100: 0.3979 - val_loss: 3.2829 - val_accuracy100: 0.3774 - 8s/epoch - 24ms/step
Epoch 10/50
339/339 - 8s - loss: 3.2383 - accuracy100: 0.3990 - val_loss: 3.2854 - val_accuracy100: 0.3763 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2341 - accuracy100: 0.4021 - val_loss: 3.2814 - val_accuracy100: 0.3800 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2296 - accuracy100: 0.4056 - val_loss: 3.2856 - val_accuracy100: 0.3790 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2234 - accuracy100: 0.4105 - val_loss: 3.2861 - val_accuracy100: 0.3793 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2181 - accuracy100: 0.4117 - val_loss: 3.2837 - val_accuracy100: 0.3801 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2128 - accuracy100: 0.4154 - val_loss: 3.2868 - val_accuracy100: 0.3817 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.2053 - accuracy100: 0.4187 - val_loss: 3.2907 - val_accuracy100: 0.3824 - 8s/epoch - 25ms/step
Epoch 17/50
339/339 - 8s - loss: 3.2000 - accuracy100: 0.4201 - val_loss: 3.2881 - val_accuracy100: 0.3815 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.1953 - accuracy100: 0.4251 - val_loss: 3.2918 - val_accuracy100: 0.3811 - 8s/epoch - 24ms/step
Epoch 19/50
339/339 - 8s - loss: 3.1890 - accuracy100: 0.4266 - val_loss: 3.2968 - val_accuracy100: 0.3796 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 3.1829 - accuracy100: 0.4292 - val_loss: 3.3018 - val_accuracy100: 0.3811 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 3.1763 - accuracy100: 0.4323 - val_loss: 3.2986 - val_accuracy100: 0.3798 - 8s/epoch - 25ms/step
testing model: results/XRAY/W4/deepOF_L2/h100
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10134
{'0': {'precision': 0.3694343314138185, 'recall': 0.4433524962178517, 'f1-score': 0.40303220340847823, 'support': 82625}, '1': {'precision': 0.4068965517241379, 'recall': 0.09815087337641563, 'f1-score': 0.1581524820867055, 'support': 93774}, '2': {'precision': 0.33257615025764553, 'recall': 0.5698351748818014, 'f1-score': 0.4200159804384031, 'support': 76566}, 'accuracy': 0.35366947996758447, 'macro avg': {'precision': 0.36963567779853396, 'recall': 0.37044618149202285, 'f1-score': 0.32706688864452893, 'support': 252965}, 'weighted avg': {'precision': 0.372165534342984, 'recall': 0.35366947996758447, 'f1-score': 0.3173959647384856, 'support': 252965}}
[[36632  7142 38851]
 [35863  9204 48707]
 [26662  6274 43630]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0795069
{'0': {'precision': 0.40177301745786814, 'recall': 0.4594173816772765, 'f1-score': 0.428665967234283, 'support': 28904}, '1': {'precision': 0.4569934640522876, 'recall': 0.1231983648729605, 'f1-score': 0.19407666472367946, 'support': 28377}, '2': {'precision': 0.3899299722943345, 'recall': 0.610888957243925, 'f1-score': 0.47601800314256043, 'support': 29259}, 'accuracy': 0.4003813265541946, 'macro avg': {'precision': 0.41623215126816343, 'recall': 0.39783490126472065, 'f1-score': 0.36625354503350765, 'support': 86540}, 'weighted avg': {'precision': 0.41587603287929187, 'recall': 0.4003813265541946, 'f1-score': 0.3677523155275219, 'support': 86540}}
[[13279  2109 13516]
 [10432  3496 14449]
 [ 9340  2045 17874]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936929
{'0': {'precision': 0.369903220688561, 'recall': 0.44643370033508856, 'f1-score': 0.4045811461541799, 'support': 10445}, '1': {'precision': 0.39776026545002074, 'recall': 0.0936340558484671, 'f1-score': 0.15158460444163438, 'support': 10242}, '2': {'precision': 0.38268240993036634, 'recall': 0.582757030889811, 'f1-score': 0.4619883040935672, 'support': 10845}, 'accuracy': 0.3787263732081695, 'macro avg': {'precision': 0.3834486320229827, 'recall': 0.3742749290244555, 'f1-score': 0.3393846848964605, 'support': 31532}, 'weighted avg': {'precision': 0.38334677516573495, 'recall': 0.3787263732081695, 'f1-score': 0.342149015227907, 'support': 31532}}
[[4663  693 5089]
 [4177  959 5106]
 [3766  759 6320]]
training model: results/XRAY/W4/deepOF_L2/h200
Epoch 1/50
339/339 - 10s - loss: 3.3360 - accuracy200: 0.3433 - val_loss: 3.3142 - val_accuracy200: 0.3406 - 10s/epoch - 31ms/step
Epoch 2/50
339/339 - 8s - loss: 3.3095 - accuracy200: 0.3528 - val_loss: 3.3056 - val_accuracy200: 0.3459 - 8s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2931 - accuracy200: 0.3606 - val_loss: 3.2994 - val_accuracy200: 0.3531 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2830 - accuracy200: 0.3698 - val_loss: 3.2961 - val_accuracy200: 0.3550 - 8s/epoch - 24ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2751 - accuracy200: 0.3737 - val_loss: 3.2953 - val_accuracy200: 0.3504 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2646 - accuracy200: 0.3794 - val_loss: 3.2949 - val_accuracy200: 0.3541 - 8s/epoch - 25ms/step
Epoch 7/50
339/339 - 8s - loss: 3.2564 - accuracy200: 0.3882 - val_loss: 3.2937 - val_accuracy200: 0.3559 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2523 - accuracy200: 0.3894 - val_loss: 3.2943 - val_accuracy200: 0.3570 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 3.2462 - accuracy200: 0.3917 - val_loss: 3.2928 - val_accuracy200: 0.3567 - 8s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.2378 - accuracy200: 0.3982 - val_loss: 3.2955 - val_accuracy200: 0.3564 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2358 - accuracy200: 0.3987 - val_loss: 3.2939 - val_accuracy200: 0.3579 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2284 - accuracy200: 0.4018 - val_loss: 3.2963 - val_accuracy200: 0.3588 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2235 - accuracy200: 0.4055 - val_loss: 3.2970 - val_accuracy200: 0.3572 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2194 - accuracy200: 0.4073 - val_loss: 3.2962 - val_accuracy200: 0.3624 - 8s/epoch - 25ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2128 - accuracy200: 0.4120 - val_loss: 3.2943 - val_accuracy200: 0.3613 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.2038 - accuracy200: 0.4147 - val_loss: 3.2976 - val_accuracy200: 0.3630 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 3.2017 - accuracy200: 0.4161 - val_loss: 3.3023 - val_accuracy200: 0.3602 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.1950 - accuracy200: 0.4169 - val_loss: 3.3007 - val_accuracy200: 0.3617 - 8s/epoch - 24ms/step
Epoch 19/50
339/339 - 8s - loss: 3.1883 - accuracy200: 0.4206 - val_loss: 3.2989 - val_accuracy200: 0.3649 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h200
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896621
{'0': {'precision': 0.3368940754039497, 'recall': 0.19087580103753432, 'f1-score': 0.24368547496915788, 'support': 78648}, '1': {'precision': 0.42212755524226914, 'recall': 0.6817061461251398, 'f1-score': 0.5213954756064323, 'support': 101023}, '2': {'precision': 0.3356164383561644, 'recall': 0.2072475236717876, 'f1-score': 0.2562545337989439, 'support': 73294}, 'accuracy': 0.39163520645148536, 'macro avg': {'precision': 0.3648793563341277, 'recall': 0.3599431569448206, 'f1-score': 0.34044516145817805, 'support': 252965}, 'weighted avg': {'precision': 0.3705623643131908, 'recall': 0.39163520645148536, 'f1-score': 0.3582322857621518, 'support': 252965}}
[[15012 49669 13967]
 [16052 68868 16103]
 [13496 44608 15190]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849336
{'0': {'precision': 0.39171064204045736, 'recall': 0.24950106788977977, 'f1-score': 0.30483605330139246, 'support': 28561}, '1': {'precision': 0.3708872343080571, 'recall': 0.6242299075889106, 'f1-score': 0.46530984996738417, 'support': 28568}, '2': {'precision': 0.40575347873285306, 'recall': 0.27958926932100236, 'f1-score': 0.33105863880669123, 'support': 29411}, 'accuracy': 0.3834296279177259, 'macro avg': {'precision': 0.3894504516937891, 'recall': 0.3844400815998976, 'f1-score': 0.3670681806918226, 'support': 86540}, 'weighted avg': {'precision': 0.3896090792701874, 'recall': 0.3834296279177259, 'f1-score': 0.36672243977528196, 'support': 86540}}
[[ 7126 14947  6488]
 [ 5180 17833  5555]
 [ 5886 15302  8223]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977583
{'0': {'precision': 0.3556553695385872, 'recall': 0.2526346321183409, 'f1-score': 0.29542114188807234, 'support': 10343}, '1': {'precision': 0.34528694617900685, 'recall': 0.5697183789618291, 'f1-score': 0.4299785232911205, 'support': 10191}, '2': {'precision': 0.37924016282225237, 'recall': 0.2541371158392435, 'f1-score': 0.3043336236933798, 'support': 10998}, 'accuracy': 0.35563871622478754, 'macro avg': {'precision': 0.3600608261799488, 'recall': 0.35883004230647114, 'f1-score': 0.34324442962419094, 'support': 31532}, 'weighted avg': {'precision': 0.36053044736670675, 'recall': 0.35563871622478754, 'f1-score': 0.3420180513379403, 'support': 31532}}
[[2613 5268 2462]
 [2272 5806 2113]
 [2462 5741 2795]]
training model: results/XRAY/W4/deepOF_L2/h300
Epoch 1/50
339/339 - 10s - loss: 3.3379 - accuracy300: 0.3394 - val_loss: 3.3157 - val_accuracy300: 0.3495 - 10s/epoch - 31ms/step
Epoch 2/50
339/339 - 8s - loss: 3.3149 - accuracy300: 0.3472 - val_loss: 3.3034 - val_accuracy300: 0.3531 - 8s/epoch - 24ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2993 - accuracy300: 0.3556 - val_loss: 3.2961 - val_accuracy300: 0.3611 - 8s/epoch - 24ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2890 - accuracy300: 0.3642 - val_loss: 3.2948 - val_accuracy300: 0.3582 - 8s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2807 - accuracy300: 0.3705 - val_loss: 3.2942 - val_accuracy300: 0.3579 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2723 - accuracy300: 0.3748 - val_loss: 3.2938 - val_accuracy300: 0.3553 - 8s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2664 - accuracy300: 0.3798 - val_loss: 3.2910 - val_accuracy300: 0.3589 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2617 - accuracy300: 0.3800 - val_loss: 3.2925 - val_accuracy300: 0.3563 - 8s/epoch - 24ms/step
Epoch 9/50
339/339 - 8s - loss: 3.2545 - accuracy300: 0.3861 - val_loss: 3.2939 - val_accuracy300: 0.3564 - 8s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.2480 - accuracy300: 0.3915 - val_loss: 3.2920 - val_accuracy300: 0.3592 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2430 - accuracy300: 0.3948 - val_loss: 3.2943 - val_accuracy300: 0.3600 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2379 - accuracy300: 0.3974 - val_loss: 3.2919 - val_accuracy300: 0.3605 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2325 - accuracy300: 0.3997 - val_loss: 3.2923 - val_accuracy300: 0.3578 - 8s/epoch - 25ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2280 - accuracy300: 0.4035 - val_loss: 3.2927 - val_accuracy300: 0.3599 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2225 - accuracy300: 0.4053 - val_loss: 3.2965 - val_accuracy300: 0.3600 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.2160 - accuracy300: 0.4089 - val_loss: 3.2961 - val_accuracy300: 0.3634 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 3.2117 - accuracy300: 0.4095 - val_loss: 3.2972 - val_accuracy300: 0.3626 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h300
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991635
{'0': {'precision': 0.3685724033728128, 'recall': 0.25840623291416076, 'f1-score': 0.3038106908258171, 'support': 87792}, '1': {'precision': 0.3716610725579287, 'recall': 0.3990012513324373, 'f1-score': 0.38484619897745365, 'support': 86308}, '2': {'precision': 0.3316524398270502, 'recall': 0.41530463450199706, 'f1-score': 0.36879440609834363, 'support': 78865}, 'accuracy': 0.35529025754551025, 'macro avg': {'precision': 0.3572953052525972, 'recall': 0.3575707062495317, 'f1-score': 0.35248376530053815, 'support': 252965}, 'weighted avg': {'precision': 0.358115952618726, 'recall': 0.35529025754551025, 'f1-score': 0.3517183197172418, 'support': 252965}}
[[22686 31571 33535]
 [19402 34437 32469]
 [19463 26649 32753]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0860485
{'0': {'precision': 0.37434977578475337, 'recall': 0.2962069332576376, 'f1-score': 0.3307251946199711, 'support': 28183}, '1': {'precision': 0.4057818181818182, 'recall': 0.38914074487376205, 'f1-score': 0.39728709769296494, 'support': 28676}, '2': {'precision': 0.37795318454001087, 'recall': 0.46784138000741216, 'f1-score': 0.4181207750560817, 'support': 29681}, 'accuracy': 0.38586780679454585, 'macro avg': {'precision': 0.38602825950219416, 'recall': 0.38439635271293726, 'f1-score': 0.3820443557896726, 'support': 86540}, 'weighted avg': {'precision': 0.3860010124734872, 'recall': 0.38586780679454585, 'f1-score': 0.38275567018555195, 'support': 86540}}
[[ 8348  7867 11968]
 [ 6631 11159 10886]
 [ 7321  8474 13886]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964501
{'0': {'precision': 0.35764654032613485, 'recall': 0.304989194775909, 'f1-score': 0.3292256199604442, 'support': 10643}, '1': {'precision': 0.34285714285714286, 'recall': 0.3235202974899287, 'f1-score': 0.3329081632653061, 'support': 9681}, '2': {'precision': 0.372044140830268, 'recall': 0.4421841541755889, 'f1-score': 0.40409311427290145, 'support': 11208}, 'accuracy': 0.359444373969301, 'macro avg': {'precision': 0.3575159413378486, 'recall': 0.3568978821471422, 'f1-score': 0.3554089658328839, 'support': 31532}, 'weighted avg': {'precision': 0.3582234827830996, 'recall': 0.359444373969301, 'f1-score': 0.35696777326465545, 'support': 31532}}
[[3246 2888 4509]
 [2693 3132 3856]
 [3137 3115 4956]]
training model: results/XRAY/W4/deepOF_L2/h500
Epoch 1/50
339/339 - 10s - loss: 3.3418 - accuracy500: 0.3394 - val_loss: 3.3375 - val_accuracy500: 0.3447 - 10s/epoch - 30ms/step
Epoch 2/50
339/339 - 8s - loss: 3.3167 - accuracy500: 0.3455 - val_loss: 3.3279 - val_accuracy500: 0.3506 - 8s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.3027 - accuracy500: 0.3530 - val_loss: 3.3174 - val_accuracy500: 0.3483 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.2925 - accuracy500: 0.3607 - val_loss: 3.3111 - val_accuracy500: 0.3535 - 8s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2854 - accuracy500: 0.3668 - val_loss: 3.3076 - val_accuracy500: 0.3493 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2783 - accuracy500: 0.3720 - val_loss: 3.3072 - val_accuracy500: 0.3495 - 8s/epoch - 25ms/step
Epoch 7/50
339/339 - 8s - loss: 3.2724 - accuracy500: 0.3757 - val_loss: 3.3054 - val_accuracy500: 0.3516 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2687 - accuracy500: 0.3771 - val_loss: 3.3024 - val_accuracy500: 0.3541 - 8s/epoch - 25ms/step
Epoch 9/50
339/339 - 8s - loss: 3.2625 - accuracy500: 0.3832 - val_loss: 3.3046 - val_accuracy500: 0.3532 - 8s/epoch - 24ms/step
Epoch 10/50
339/339 - 8s - loss: 3.2577 - accuracy500: 0.3885 - val_loss: 3.3025 - val_accuracy500: 0.3502 - 8s/epoch - 24ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2534 - accuracy500: 0.3895 - val_loss: 3.3053 - val_accuracy500: 0.3539 - 8s/epoch - 24ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2484 - accuracy500: 0.3917 - val_loss: 3.3031 - val_accuracy500: 0.3532 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2434 - accuracy500: 0.3955 - val_loss: 3.3067 - val_accuracy500: 0.3511 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2395 - accuracy500: 0.3982 - val_loss: 3.3092 - val_accuracy500: 0.3541 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2333 - accuracy500: 0.4023 - val_loss: 3.3135 - val_accuracy500: 0.3531 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.2305 - accuracy500: 0.4025 - val_loss: 3.3144 - val_accuracy500: 0.3515 - 8s/epoch - 25ms/step
Epoch 17/50
339/339 - 8s - loss: 3.2249 - accuracy500: 0.4035 - val_loss: 3.3139 - val_accuracy500: 0.3564 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.2216 - accuracy500: 0.4061 - val_loss: 3.3204 - val_accuracy500: 0.3499 - 8s/epoch - 24ms/step
testing model: results/XRAY/W4/deepOF_L2/h500
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055776
{'0': {'precision': 0.3551829268292683, 'recall': 0.14945477870429763, 'f1-score': 0.21038374717832956, 'support': 87304}, '1': {'precision': 0.3828279499011206, 'recall': 0.3823197024390779, 'f1-score': 0.3825736573690307, 'support': 91141}, '2': {'precision': 0.3044190114129176, 'recall': 0.5114868491680086, 'f1-score': 0.38167717256883077, 'support': 74520}, 'accuracy': 0.34000355780443936, 'macro avg': {'precision': 0.3474766293811022, 'recall': 0.34775377677046143, 'f1-score': 0.32487819237206367, 'support': 252965}, 'weighted avg': {'precision': 0.35018882911205534, 'recall': 0.34000355780443936, 'f1-score': 0.32288289395670144, 'support': 252965}}
[[13048 31324 42932]
 [12135 34845 44161]
 [11553 24851 38116]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.088445
{'0': {'precision': 0.37767173007124616, 'recall': 0.2024937835597679, 'f1-score': 0.26363572383700473, 'support': 27749}, '1': {'precision': 0.39885674288380774, 'recall': 0.35167660975108, 'f1-score': 0.3737837542363616, 'support': 29166}, '2': {'precision': 0.36701780350846647, 'recall': 0.5692151898734177, 'f1-score': 0.4462823040584351, 'support': 29625}, 'accuracy': 0.3783106078114167, 'macro avg': {'precision': 0.38118209215450677, 'recall': 0.3744618610614219, 'f1-score': 0.36123392737726717, 'support': 86540}, 'weighted avg': {'precision': 0.38116444453009557, 'recall': 0.3783106078114167, 'f1-score': 0.36328308221102273, 'support': 86540}}
[[ 5619  7471 14659]
 [ 4485 10257 14424]
 [ 4774  7988 16863]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992956
{'0': {'precision': 0.3576730798363884, 'recall': 0.2238763512232126, 'f1-score': 0.27538344899982503, 'support': 10546}, '1': {'precision': 0.3399014778325123, 'recall': 0.3026933278922669, 'f1-score': 0.32022017160433863, 'support': 9802}, '2': {'precision': 0.3619923466238736, 'recall': 0.5244098712446352, 'f1-score': 0.42832103994741844, 'support': 11184}, 'accuracy': 0.35497272611949765, 'macro avg': {'precision': 0.3531889680975914, 'recall': 0.3503265167867049, 'f1-score': 0.3413082201838607, 'support': 31532}, 'weighted avg': {'precision': 0.3536806098664924, 'recall': 0.35497272611949765, 'f1-score': 0.3435663607126034, 'support': 31532}}
[[2361 2784 5401]
 [1899 2967 4936]
 [2341 2978 5865]]
training model: results/XRAY/W4/deepOF_L2/h1000
Epoch 1/50
339/339 - 10s - loss: 3.3453 - accuracy1000: 0.3408 - val_loss: 3.3466 - val_accuracy1000: 0.3524 - 10s/epoch - 30ms/step
Epoch 2/50
339/339 - 8s - loss: 3.3255 - accuracy1000: 0.3439 - val_loss: 3.3320 - val_accuracy1000: 0.3520 - 8s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.3119 - accuracy1000: 0.3499 - val_loss: 3.3143 - val_accuracy1000: 0.3489 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.3001 - accuracy1000: 0.3567 - val_loss: 3.3097 - val_accuracy1000: 0.3491 - 8s/epoch - 24ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2942 - accuracy1000: 0.3593 - val_loss: 3.3063 - val_accuracy1000: 0.3457 - 8s/epoch - 24ms/step
Epoch 6/50
339/339 - 8s - loss: 3.2865 - accuracy1000: 0.3644 - val_loss: 3.3040 - val_accuracy1000: 0.3423 - 8s/epoch - 24ms/step
Epoch 7/50
339/339 - 8s - loss: 3.2805 - accuracy1000: 0.3692 - val_loss: 3.3038 - val_accuracy1000: 0.3362 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2771 - accuracy1000: 0.3722 - val_loss: 3.3023 - val_accuracy1000: 0.3381 - 8s/epoch - 25ms/step
Epoch 9/50
339/339 - 8s - loss: 3.2725 - accuracy1000: 0.3743 - val_loss: 3.3026 - val_accuracy1000: 0.3346 - 8s/epoch - 24ms/step
Epoch 10/50
339/339 - 8s - loss: 3.2666 - accuracy1000: 0.3783 - val_loss: 3.3009 - val_accuracy1000: 0.3356 - 8s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2635 - accuracy1000: 0.3795 - val_loss: 3.3001 - val_accuracy1000: 0.3428 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2595 - accuracy1000: 0.3824 - val_loss: 3.3019 - val_accuracy1000: 0.3390 - 8s/epoch - 24ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2542 - accuracy1000: 0.3850 - val_loss: 3.3018 - val_accuracy1000: 0.3388 - 8s/epoch - 24ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2498 - accuracy1000: 0.3886 - val_loss: 3.3042 - val_accuracy1000: 0.3375 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2464 - accuracy1000: 0.3892 - val_loss: 3.3062 - val_accuracy1000: 0.3404 - 8s/epoch - 24ms/step
Epoch 16/50
339/339 - 8s - loss: 3.2403 - accuracy1000: 0.3955 - val_loss: 3.3094 - val_accuracy1000: 0.3359 - 8s/epoch - 24ms/step
Epoch 17/50
339/339 - 8s - loss: 3.2349 - accuracy1000: 0.3971 - val_loss: 3.3126 - val_accuracy1000: 0.3348 - 8s/epoch - 24ms/step
Epoch 18/50
339/339 - 8s - loss: 3.2334 - accuracy1000: 0.3985 - val_loss: 3.3149 - val_accuracy1000: 0.3394 - 8s/epoch - 25ms/step
Epoch 19/50
339/339 - 8s - loss: 3.2287 - accuracy1000: 0.4016 - val_loss: 3.3205 - val_accuracy1000: 0.3388 - 8s/epoch - 24ms/step
Epoch 20/50
339/339 - 8s - loss: 3.2213 - accuracy1000: 0.4046 - val_loss: 3.3195 - val_accuracy1000: 0.3391 - 8s/epoch - 24ms/step
Epoch 21/50
339/339 - 8s - loss: 3.2183 - accuracy1000: 0.4072 - val_loss: 3.3262 - val_accuracy1000: 0.3387 - 8s/epoch - 25ms/step
testing model: results/XRAY/W4/deepOF_L2/h1000
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015506
{'0': {'precision': 0.35189806909234206, 'recall': 0.1525053226008448, 'f1-score': 0.21279130724872516, 'support': 87833}, '1': {'precision': 0.38244387775326033, 'recall': 0.6257458491871325, 'f1-score': 0.4747373686843422, 'support': 92512}, '2': {'precision': 0.3063713916957849, 'recall': 0.26803910768383366, 'f1-score': 0.2859262305918298, 'support': 72620}, 'accuracy': 0.35874132785167906, 'macro avg': {'precision': 0.34690444618046246, 'recall': 0.34876342649060366, 'f1-score': 0.3244849688416324, 'support': 252965}, 'weighted avg': {'precision': 0.3499994133032048, 'recall': 0.35874132785167906, 'f1-score': 0.3295830063719559, 'support': 252965}}
[[13395 52297 22141]
 [12695 57889 21928]
 [11975 41180 19465]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0880493
{'0': {'precision': 0.394195072561593, 'recall': 0.2080364776289541, 'f1-score': 0.272343600624898, 'support': 28072}, '1': {'precision': 0.37015331040047567, 'recall': 0.6084892488131807, 'f1-score': 0.46029943756436326, 'support': 28648}, '2': {'precision': 0.3841906540538346, 'recall': 0.3173373574782026, 'f1-score': 0.34757855686764244, 'support': 29820}, 'accuracy': 0.37826438641090826, 'macro avg': {'precision': 0.38284634567196774, 'recall': 0.3779543613067791, 'f1-score': 0.3600738650189679, 'support': 86540}, 'weighted avg': {'precision': 0.38278901568277346, 'recall': 0.37826438641090826, 'f1-score': 0.3604885649396708, 'support': 86540}}
[[ 5840 14172  8060]
 [ 4108 17432  7108]
 [ 4867 15490  9463]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100817
{'0': {'precision': 0.35938294626207834, 'recall': 0.19814935975324796, 'f1-score': 0.2554524641523075, 'support': 10699}, '1': {'precision': 0.31224611708482675, 'recall': 0.573702118318516, 'f1-score': 0.4043944141425863, 'support': 9111}, '2': {'precision': 0.376925671876757, 'recall': 0.2859580276403344, 'f1-score': 0.32520009701673536, 'support': 11722}, 'accuracy': 0.33930610173791703, 'macro avg': {'precision': 0.34951824507455403, 'recall': 0.35260316857069945, 'f1-score': 0.32834899177054305, 'support': 31532}, 'weighted avg': {'precision': 0.35228451225920265, 'recall': 0.33930610173791703, 'f1-score': 0.32441706705723755, 'support': 31532}}
[[2120 5432 3147]
 [1490 5227 2394]
 [2289 6081 3352]]
training model: results/XRAY/W4/deepVOL_L2/h10
Epoch 1/50
339/339 - 11s - loss: 3.2772 - accuracy10: 0.3915 - val_loss: 3.2874 - val_accuracy10: 0.4016 - 11s/epoch - 34ms/step
Epoch 2/50
339/339 - 9s - loss: 3.1674 - accuracy10: 0.4359 - val_loss: 3.2018 - val_accuracy10: 0.4270 - 9s/epoch - 26ms/step
Epoch 3/50
339/339 - 9s - loss: 3.1109 - accuracy10: 0.4555 - val_loss: 3.1637 - val_accuracy10: 0.4388 - 9s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.0900 - accuracy10: 0.4652 - val_loss: 3.1504 - val_accuracy10: 0.4471 - 9s/epoch - 25ms/step
Epoch 5/50
339/339 - 9s - loss: 3.0687 - accuracy10: 0.4724 - val_loss: 3.1436 - val_accuracy10: 0.4511 - 9s/epoch - 25ms/step
Epoch 6/50
339/339 - 8s - loss: 3.0561 - accuracy10: 0.4772 - val_loss: 3.1337 - val_accuracy10: 0.4584 - 8s/epoch - 25ms/step
Epoch 7/50
339/339 - 8s - loss: 3.0404 - accuracy10: 0.4835 - val_loss: 3.1411 - val_accuracy10: 0.4573 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.0307 - accuracy10: 0.4866 - val_loss: 3.1279 - val_accuracy10: 0.4611 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.0223 - accuracy10: 0.4880 - val_loss: 3.1561 - val_accuracy10: 0.4537 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.0098 - accuracy10: 0.4921 - val_loss: 3.1636 - val_accuracy10: 0.4528 - 8s/epoch - 25ms/step
Epoch 11/50
339/339 - 9s - loss: 3.0044 - accuracy10: 0.4940 - val_loss: 3.1482 - val_accuracy10: 0.4548 - 9s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 2.9960 - accuracy10: 0.4954 - val_loss: 3.1574 - val_accuracy10: 0.4541 - 8s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 2.9883 - accuracy10: 0.4984 - val_loss: 3.1659 - val_accuracy10: 0.4548 - 9s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 2.9818 - accuracy10: 0.5004 - val_loss: 3.1510 - val_accuracy10: 0.4564 - 9s/epoch - 25ms/step
Epoch 15/50
339/339 - 9s - loss: 2.9743 - accuracy10: 0.5019 - val_loss: 3.1536 - val_accuracy10: 0.4564 - 9s/epoch - 26ms/step
Epoch 16/50
339/339 - 9s - loss: 2.9652 - accuracy10: 0.5068 - val_loss: 3.1720 - val_accuracy10: 0.4564 - 9s/epoch - 25ms/step
Epoch 17/50
339/339 - 9s - loss: 2.9578 - accuracy10: 0.5075 - val_loss: 3.1706 - val_accuracy10: 0.4587 - 9s/epoch - 25ms/step
Epoch 18/50
339/339 - 9s - loss: 2.9545 - accuracy10: 0.5099 - val_loss: 3.1650 - val_accuracy10: 0.4542 - 9s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h10
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0305252
{'0': {'precision': 0.42717074914463715, 'recall': 0.360058539104983, 'f1-score': 0.3907539472454921, 'support': 69697}, '1': {'precision': 0.5926165574522653, 'recall': 0.4377748422644395, 'f1-score': 0.5035613069621676, 'support': 115066}, '2': {'precision': 0.3556825152672105, 'recall': 0.5695686596487113, 'f1-score': 0.43790403940775646, 'support': 68206}, 'accuracy': 0.45189726804470115, 'macro avg': {'precision': 0.458489940621371, 'recall': 0.45580068033937793, 'f1-score': 0.44407309787180543, 'support': 252969}, 'weighted avg': {'precision': 0.48315097161806975, 'recall': 0.45189726804470115, 'f1-score': 0.4547784357764124, 'support': 252969}}
[[25095 16492 28110]
 [22430 50373 42263]
 [11222 18136 38848]]
Evaluating performance on  train set...
339/339 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0171938
{'0': {'precision': 0.48248582604491713, 'recall': 0.3911633707464814, 'f1-score': 0.4320516352473533, 'support': 28065}, '1': {'precision': 0.5680607352157698, 'recall': 0.42481490089312396, 'f1-score': 0.48610451532017557, 'support': 30119}, '2': {'precision': 0.42663273960983883, 'recall': 0.6208124691445095, 'f1-score': 0.5057236832655876, 'support': 28358}, 'accuracy': 0.47812622772757735, 'macro avg': {'precision': 0.4923931002901753, 'recall': 0.47893024692803826, 'f1-score': 0.4746266112777055, 'support': 86542}, 'weighted avg': {'precision': 0.49396636571572394, 'recall': 0.47812622772757735, 'f1-score': 0.47500431293696554, 'support': 86542}}
[[10978  4663 12424]
 [ 6088 12795 11236]
 [ 5687  5066 17605]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0413123
{'0': {'precision': 0.4747837096433847, 'recall': 0.41950219073366274, 'f1-score': 0.44543429844098, 'support': 10727}, '1': {'precision': 0.49731533884777246, 'recall': 0.34651162790697676, 'f1-score': 0.40843811453429474, 'support': 9890}, '2': {'precision': 0.4316428147464222, 'recall': 0.5996335318369217, 'f1-score': 0.5019556714471969, 'support': 10915}, 'accuracy': 0.4589623239883293, 'macro avg': {'precision': 0.4679139544125264, 'recall': 0.4552157834925204, 'f1-score': 0.4519426948074905, 'support': 31532}, 'weighted avg': {'precision': 0.46691725477312745, 'recall': 0.4589623239883293, 'f1-score': 0.45339568774472666, 'support': 31532}}
[[4500 1642 4585]
 [2430 3427 4033]
 [2548 1822 6545]]
training model: results/XRAY/W4/deepVOL_L2/h20
Epoch 1/50
339/339 - 11s - loss: 3.3259 - accuracy20: 0.3678 - val_loss: 3.2872 - val_accuracy20: 0.3811 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.2486 - accuracy20: 0.3983 - val_loss: 3.2650 - val_accuracy20: 0.3886 - 9s/epoch - 26ms/step
Epoch 3/50
339/339 - 9s - loss: 3.2107 - accuracy20: 0.4164 - val_loss: 3.2372 - val_accuracy20: 0.4087 - 9s/epoch - 25ms/step
Epoch 4/50
339/339 - 8s - loss: 3.1753 - accuracy20: 0.4331 - val_loss: 3.2176 - val_accuracy20: 0.4209 - 8s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.1540 - accuracy20: 0.4435 - val_loss: 3.1971 - val_accuracy20: 0.4300 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.1416 - accuracy20: 0.4488 - val_loss: 3.1974 - val_accuracy20: 0.4318 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.1303 - accuracy20: 0.4499 - val_loss: 3.1903 - val_accuracy20: 0.4349 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.1203 - accuracy20: 0.4565 - val_loss: 3.1859 - val_accuracy20: 0.4398 - 9s/epoch - 26ms/step
Epoch 9/50
339/339 - 9s - loss: 3.1106 - accuracy20: 0.4602 - val_loss: 3.1905 - val_accuracy20: 0.4393 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.1008 - accuracy20: 0.4635 - val_loss: 3.1818 - val_accuracy20: 0.4425 - 9s/epoch - 26ms/step
Epoch 11/50
339/339 - 9s - loss: 3.0975 - accuracy20: 0.4657 - val_loss: 3.1940 - val_accuracy20: 0.4376 - 9s/epoch - 25ms/step
Epoch 12/50
339/339 - 9s - loss: 3.0894 - accuracy20: 0.4681 - val_loss: 3.2159 - val_accuracy20: 0.4314 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 3.0817 - accuracy20: 0.4708 - val_loss: 3.1926 - val_accuracy20: 0.4418 - 9s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 3.0775 - accuracy20: 0.4719 - val_loss: 3.2038 - val_accuracy20: 0.4351 - 9s/epoch - 25ms/step
Epoch 15/50
339/339 - 8s - loss: 3.0698 - accuracy20: 0.4762 - val_loss: 3.2199 - val_accuracy20: 0.4354 - 8s/epoch - 25ms/step
Epoch 16/50
339/339 - 9s - loss: 3.0642 - accuracy20: 0.4759 - val_loss: 3.2172 - val_accuracy20: 0.4386 - 9s/epoch - 25ms/step
Epoch 17/50
339/339 - 9s - loss: 3.0589 - accuracy20: 0.4781 - val_loss: 3.2257 - val_accuracy20: 0.4334 - 9s/epoch - 25ms/step
Epoch 18/50
339/339 - 8s - loss: 3.0558 - accuracy20: 0.4793 - val_loss: 3.2296 - val_accuracy20: 0.4346 - 8s/epoch - 25ms/step
Epoch 19/50
339/339 - 9s - loss: 3.0500 - accuracy20: 0.4828 - val_loss: 3.2407 - val_accuracy20: 0.4285 - 9s/epoch - 25ms/step
Epoch 20/50
339/339 - 9s - loss: 3.0452 - accuracy20: 0.4821 - val_loss: 3.2239 - val_accuracy20: 0.4371 - 9s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h20
Evaluating performance on  test set...
989/989 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594226
{'0': {'precision': 0.42342127821697306, 'recall': 0.36340722372849027, 'f1-score': 0.3911255141468279, 'support': 73397}, '1': {'precision': 0.5677016936805682, 'recall': 0.3460439041989288, 'f1-score': 0.42998775798748207, 'support': 108099}, '2': {'precision': 0.3574462255103439, 'recall': 0.620556014159193, 'f1-score': 0.45360919634273555, 'support': 71473}, 'accuracy': 0.42864145409121274, 'macro avg': {'precision': 0.44952306580262835, 'recall': 0.4433357140288707, 'f1-score': 0.4249074894923485, 'support': 252969}, 'weighted avg': {'precision': 0.46643498222457186, 'recall': 0.42864145409121274, 'f1-score': 0.42538609909802344, 'support': 252969}}
[[26673 14326 32398]
 [23360 37407 47332]
 [12961 14159 44353]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0413897
{'0': {'precision': 0.46001982160555005, 'recall': 0.40413749869397136, 'f1-score': 0.430271793540732, 'support': 28713}, '1': {'precision': 0.5398672007902102, 'recall': 0.341751485045333, 'f1-score': 0.41854924484152306, 'support': 28787}, '2': {'precision': 0.41815565972061075, 'recall': 0.6204806831485435, 'f1-score': 0.49961184429411115, 'support': 29042}, 'accuracy': 0.45598668854429064, 'macro avg': {'precision': 0.4726808940387904, 'recall': 0.4554565556292826, 'f1-score': 0.4494776275587887, 'support': 86542}, 'weighted avg': {'precision': 0.47253105909863324, 'recall': 0.45598668854429064, 'f1-score': 0.4496417727944529, 'support': 86542}}
[[11604  4056 13053]
 [ 6928  9838 12021]
 [ 6693  4329 18020]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0617611
{'0': {'precision': 0.4530309112806102, 'recall': 0.4121245320916644, 'f1-score': 0.4316106516230817, 'support': 10953}, '1': {'precision': 0.46125954198473285, 'recall': 0.25922350922350923, 'f1-score': 0.331914309255699, 'support': 9324}, '2': {'precision': 0.429140127388535, 'recall': 0.6225677476677033, 'f1-score': 0.5080665627379183, 'support': 11255}, 'accuracy': 0.4420271470252442, 'macro avg': {'precision': 0.44781019355129265, 'recall': 0.43130526299429234, 'f1-score': 0.42386384120556625, 'support': 31532}, 'weighted avg': {'precision': 0.446936562047448, 'recall': 0.4420271470252442, 'f1-score': 0.42942057751944124, 'support': 31532}}
[[4514 1343 5096]
 [2682 2417 4225]
 [2768 1480 7007]]
training model: results/XRAY/W4/deepVOL_L2/h30
Epoch 1/50
339/339 - 11s - loss: 3.3240 - accuracy30: 0.3674 - val_loss: 3.3184 - val_accuracy30: 0.3671 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.2551 - accuracy30: 0.3946 - val_loss: 3.2926 - val_accuracy30: 0.3688 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 9s - loss: 3.2298 - accuracy30: 0.4058 - val_loss: 3.2787 - val_accuracy30: 0.3851 - 9s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2085 - accuracy30: 0.4152 - val_loss: 3.2687 - val_accuracy30: 0.3890 - 9s/epoch - 25ms/step
Epoch 5/50
339/339 - 9s - loss: 3.1924 - accuracy30: 0.4231 - val_loss: 3.2495 - val_accuracy30: 0.4055 - 9s/epoch - 26ms/step
Epoch 6/50
339/339 - 9s - loss: 3.1816 - accuracy30: 0.4274 - val_loss: 3.2616 - val_accuracy30: 0.4004 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 8s - loss: 3.1710 - accuracy30: 0.4353 - val_loss: 3.2599 - val_accuracy30: 0.4016 - 8s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.1638 - accuracy30: 0.4372 - val_loss: 3.2613 - val_accuracy30: 0.4063 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 8s - loss: 3.1556 - accuracy30: 0.4392 - val_loss: 3.2564 - val_accuracy30: 0.4079 - 8s/epoch - 25ms/step
Epoch 10/50
339/339 - 8s - loss: 3.1475 - accuracy30: 0.4441 - val_loss: 3.2721 - val_accuracy30: 0.4055 - 8s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 3.1435 - accuracy30: 0.4461 - val_loss: 3.2715 - val_accuracy30: 0.4077 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 9s - loss: 3.1363 - accuracy30: 0.4491 - val_loss: 3.2799 - val_accuracy30: 0.4098 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 8s - loss: 3.1330 - accuracy30: 0.4517 - val_loss: 3.2816 - val_accuracy30: 0.4063 - 8s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 3.1264 - accuracy30: 0.4525 - val_loss: 3.2727 - val_accuracy30: 0.4085 - 9s/epoch - 25ms/step
Epoch 15/50
339/339 - 9s - loss: 3.1207 - accuracy30: 0.4556 - val_loss: 3.2818 - val_accuracy30: 0.4078 - 9s/epoch - 26ms/step
testing model: results/XRAY/W4/deepVOL_L2/h30
Evaluating performance on  test set...
989/989 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763451
{'0': {'precision': 0.4104008275997964, 'recall': 0.3223114916884825, 'f1-score': 0.36106094971179264, 'support': 77543}, '1': {'precision': 0.477440926151081, 'recall': 0.36019661409001175, 'f1-score': 0.4106134139549686, 'support': 100298}, '2': {'precision': 0.357468084740812, 'recall': 0.5538547545522309, 'f1-score': 0.43450112253955, 'support': 75128}, 'accuracy': 0.4060971897742411, 'macro avg': {'precision': 0.4151032794972298, 'recall': 0.412120953443575, 'f1-score': 0.40205849540210375, 'support': 252969}, 'weighted avg': {'precision': 0.42126088040858706, 'recall': 0.4060971897742411, 'f1-score': 0.4025183075811989, 'support': 252969}}
[[24993 20136 32414]
 [21793 36127 42378]
 [14113 19405 41610]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651124
{'0': {'precision': 0.4347236621740171, 'recall': 0.3745104774991412, 'f1-score': 0.40237691001697795, 'support': 29110}, '1': {'precision': 0.4466359447004608, 'recall': 0.3461552198292796, 'f1-score': 0.39002796836958487, 'support': 27999}, '2': {'precision': 0.4053918116889649, 'recall': 0.5476845717392043, 'f1-score': 0.4659161524343541, 'support': 29433}, 'accuracy': 0.4242333202375725, 'macro avg': {'precision': 0.4289171395211476, 'recall': 0.4227834230225416, 'f1-score': 0.4194403436069723, 'support': 86542}, 'weighted avg': {'precision': 0.42860186747469603, 'recall': 0.4242333202375725, 'f1-score': 0.4199913920590532, 'support': 86542}}
[[10902  5837 12371]
 [ 7034  9692 11273]
 [ 7142  6171 16120]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839893
{'0': {'precision': 0.4074506370975586, 'recall': 0.38822984244670994, 'f1-score': 0.3976080869441413, 'support': 10790}, '1': {'precision': 0.37345586019885507, 'recall': 0.2611397872116296, 'f1-score': 0.30735850226272393, 'support': 9493}, '2': {'precision': 0.41161979059741327, 'recall': 0.5347141968174949, 'f1-score': 0.4651612404299745, 'support': 11249}, 'accuracy': 0.4022263097805404, 'macro avg': {'precision': 0.39750876263127566, 'recall': 0.3946946088252781, 'f1-score': 0.3900426098789466, 'support': 31532}, 'weighted avg': {'precision': 0.3987035354427468, 'recall': 0.4022263097805404, 'f1-score': 0.39453711511176287, 'support': 31532}}
[[4189 1999 4602]
 [3018 2479 3996]
 [3074 2160 6015]]
training model: results/XRAY/W4/deepVOL_L2/h50
Epoch 1/50
339/339 - 11s - loss: 3.3408 - accuracy50: 0.3593 - val_loss: 3.3329 - val_accuracy50: 0.3436 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.2935 - accuracy50: 0.3716 - val_loss: 3.3218 - val_accuracy50: 0.3411 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2812 - accuracy50: 0.3748 - val_loss: 3.3220 - val_accuracy50: 0.3370 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2707 - accuracy50: 0.3806 - val_loss: 3.3102 - val_accuracy50: 0.3466 - 9s/epoch - 25ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2584 - accuracy50: 0.3889 - val_loss: 3.3098 - val_accuracy50: 0.3536 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2475 - accuracy50: 0.3943 - val_loss: 3.3055 - val_accuracy50: 0.3589 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2386 - accuracy50: 0.3985 - val_loss: 3.3071 - val_accuracy50: 0.3597 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.2306 - accuracy50: 0.4032 - val_loss: 3.3005 - val_accuracy50: 0.3632 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2228 - accuracy50: 0.4073 - val_loss: 3.3154 - val_accuracy50: 0.3608 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2119 - accuracy50: 0.4123 - val_loss: 3.3184 - val_accuracy50: 0.3622 - 9s/epoch - 25ms/step
Epoch 11/50
339/339 - 9s - loss: 3.2071 - accuracy50: 0.4145 - val_loss: 3.3190 - val_accuracy50: 0.3646 - 9s/epoch - 25ms/step
Epoch 12/50
339/339 - 9s - loss: 3.1979 - accuracy50: 0.4198 - val_loss: 3.3172 - val_accuracy50: 0.3624 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 8s - loss: 3.1920 - accuracy50: 0.4221 - val_loss: 3.3208 - val_accuracy50: 0.3677 - 8s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 3.1848 - accuracy50: 0.4263 - val_loss: 3.3169 - val_accuracy50: 0.3686 - 9s/epoch - 25ms/step
Epoch 15/50
339/339 - 9s - loss: 3.1801 - accuracy50: 0.4279 - val_loss: 3.3167 - val_accuracy50: 0.3717 - 9s/epoch - 26ms/step
Epoch 16/50
339/339 - 9s - loss: 3.1730 - accuracy50: 0.4305 - val_loss: 3.3222 - val_accuracy50: 0.3685 - 9s/epoch - 25ms/step
Epoch 17/50
339/339 - 8s - loss: 3.1702 - accuracy50: 0.4315 - val_loss: 3.3295 - val_accuracy50: 0.3719 - 8s/epoch - 25ms/step
Epoch 18/50
339/339 - 8s - loss: 3.1634 - accuracy50: 0.4338 - val_loss: 3.3327 - val_accuracy50: 0.3635 - 8s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h50
Evaluating performance on  test set...
989/989 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780424
{'0': {'precision': 0.33739375660961185, 'recall': 0.12126928708187859, 'f1-score': 0.1784120211675279, 'support': 71032}, '1': {'precision': 0.46998509182524234, 'recall': 0.6232776185378319, 'f1-score': 0.5358843505854843, 'support': 115828}, '2': {'precision': 0.2899595021061614, 'recall': 0.32382882814745345, 'f1-score': 0.30595969701300557, 'support': 66109}, 'accuracy': 0.40406136720309604, 'macro avg': {'precision': 0.3657794501803385, 'recall': 0.35612524458905465, 'f1-score': 0.34008535625533926, 'support': 252969}, 'weighted avg': {'precision': 0.385707811076315, 'recall': 0.40406136720309604, 'f1-score': 0.3754217507165704, 'support': 252969}}
[[ 8614 42757 19661]
 [10873 72193 32762]
 [ 6044 38657 21408]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876325
{'0': {'precision': 0.42726265982079936, 'recall': 0.1474532694044889, 'f1-score': 0.21924318739506654, 'support': 28782}, '1': {'precision': 0.37546241717142975, 'recall': 0.646258265402512, 'f1-score': 0.47497460819480336, 'support': 28583}, '2': {'precision': 0.4006055962934588, 'recall': 0.37635809027658773, 'f1-score': 0.3881034848377748, 'support': 29177}, 'accuracy': 0.38937163458205265, 'macro avg': {'precision': 0.40111022442856265, 'recall': 0.39002320836119625, 'f1-score': 0.3607737601425482, 'support': 86542}, 'weighted avg': {'precision': 0.4011668973218492, 'recall': 0.38937163458205265, 'f1-score': 0.36063589959497844, 'support': 86542}}
[[ 4244 15503  9035]
 [ 2716 18472  7395]
 [ 2973 15223 10981]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008672
{'0': {'precision': 0.3685528292438658, 'recall': 0.141280353200883, 'f1-score': 0.204260043016721, 'support': 10419}, '1': {'precision': 0.3498114788437369, 'recall': 0.5662113726629856, 'f1-score': 0.4324504291210417, 'support': 10323}, '2': {'precision': 0.3758426447502078, 'recall': 0.37720111214087115, 'f1-score': 0.3765206531291919, 'support': 10790}, 'accuracy': 0.3611252061397945, 'macro avg': {'precision': 0.3647356509459369, 'recall': 0.36156427933491325, 'f1-score': 0.3377437084223182, 'support': 31532}, 'weighted avg': {'precision': 0.3649117709263756, 'recall': 0.3611252061397945, 'f1-score': 0.3379116140832079, 'support': 31532}}
[[1472 5409 3538]
 [1257 5845 3221]
 [1265 5455 4070]]
training model: results/XRAY/W4/deepVOL_L2/h100
Epoch 1/50
339/339 - 11s - loss: 3.3539 - accuracy100: 0.3463 - val_loss: 3.3381 - val_accuracy100: 0.3459 - 11s/epoch - 33ms/step
Epoch 2/50
339/339 - 9s - loss: 3.3068 - accuracy100: 0.3572 - val_loss: 3.3064 - val_accuracy100: 0.3501 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 8s - loss: 3.2905 - accuracy100: 0.3629 - val_loss: 3.3093 - val_accuracy100: 0.3507 - 8s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2809 - accuracy100: 0.3688 - val_loss: 3.2983 - val_accuracy100: 0.3537 - 9s/epoch - 25ms/step
Epoch 5/50
339/339 - 9s - loss: 3.2738 - accuracy100: 0.3738 - val_loss: 3.2969 - val_accuracy100: 0.3548 - 9s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2643 - accuracy100: 0.3802 - val_loss: 3.2960 - val_accuracy100: 0.3573 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2562 - accuracy100: 0.3854 - val_loss: 3.2999 - val_accuracy100: 0.3568 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 8s - loss: 3.2520 - accuracy100: 0.3877 - val_loss: 3.2979 - val_accuracy100: 0.3567 - 8s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2445 - accuracy100: 0.3921 - val_loss: 3.3044 - val_accuracy100: 0.3588 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2378 - accuracy100: 0.3944 - val_loss: 3.3033 - val_accuracy100: 0.3590 - 9s/epoch - 25ms/step
Epoch 11/50
339/339 - 9s - loss: 3.2310 - accuracy100: 0.4012 - val_loss: 3.3065 - val_accuracy100: 0.3577 - 9s/epoch - 25ms/step
Epoch 12/50
339/339 - 9s - loss: 3.2231 - accuracy100: 0.4042 - val_loss: 3.3088 - val_accuracy100: 0.3580 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 3.2176 - accuracy100: 0.4096 - val_loss: 3.3076 - val_accuracy100: 0.3618 - 9s/epoch - 26ms/step
Epoch 14/50
339/339 - 8s - loss: 3.2097 - accuracy100: 0.4133 - val_loss: 3.3121 - val_accuracy100: 0.3603 - 8s/epoch - 24ms/step
Epoch 15/50
339/339 - 8s - loss: 3.2037 - accuracy100: 0.4165 - val_loss: 3.3250 - val_accuracy100: 0.3595 - 8s/epoch - 25ms/step
Epoch 16/50
339/339 - 8s - loss: 3.1995 - accuracy100: 0.4173 - val_loss: 3.3307 - val_accuracy100: 0.3599 - 8s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h100
Evaluating performance on  test set...
989/989 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050853
{'0': {'precision': 0.3595199235699216, 'recall': 0.21860892928461642, 'f1-score': 0.27189186341434046, 'support': 82627}, '1': {'precision': 0.37712616342938543, 'recall': 0.33313782991202345, 'f1-score': 0.35376984576359477, 'support': 93775}, '2': {'precision': 0.3209024939527901, 'recall': 0.502474956573981, 'f1-score': 0.3916684058089048, 'support': 76567}, 'accuracy': 0.3469832271938459, 'macro avg': {'precision': 0.35251619365069903, 'recall': 0.35140723859020695, 'f1-score': 0.3391100383289467, 'support': 252969}, 'weighted avg': {'precision': 0.35435804369264934, 'recall': 0.3469832271938459, 'f1-score': 0.33849701391233006, 'support': 252969}}
[[18063 27547 37017]
 [18135 31240 44400]
 [14044 24050 38473]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0887841
{'0': {'precision': 0.37317247725181474, 'recall': 0.2524815826790717, 'f1-score': 0.3011861784424962, 'support': 28913}, '1': {'precision': 0.38935114809184734, 'recall': 0.3433399181600113, 'f1-score': 0.3649008360514378, 'support': 28348}, '2': {'precision': 0.3707779524558144, 'recall': 0.5316075270653324, 'f1-score': 0.43686064297040544, 'support': 29281}, 'accuracy': 0.37668415335906263, 'macro avg': {'precision': 0.37776719259982544, 'recall': 0.37580967596813847, 'f1-score': 0.36764921915477977, 'support': 86542}, 'weighted avg': {'precision': 0.3776618451936414, 'recall': 0.37668415335906263, 'f1-score': 0.3679614680098737, 'support': 86542}}
[[ 7300  7744 13869]
 [ 6068  9733 12547]
 [ 6194  7521 15566]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097989
{'0': {'precision': 0.3521702536972466, 'recall': 0.2801798354696767, 'f1-score': 0.31207714026956473, 'support': 10454}, '1': {'precision': 0.3519150549867273, 'recall': 0.27219397731716855, 'f1-score': 0.30696289762390433, 'support': 10228}, '2': {'precision': 0.3647412441191845, 'recall': 0.5144700460829493, 'f1-score': 0.42685631260992585, 'support': 10850}, 'accuracy': 0.3582075352023341, 'macro avg': {'precision': 0.3562755176010528, 'recall': 0.3556146196232648, 'f1-score': 0.348632116834465, 'support': 31532}, 'weighted avg': {'precision': 0.3564130887114174, 'recall': 0.3582075352023341, 'f1-score': 0.3499131654539204, 'support': 31532}}
[[2929 2560 4965]
 [2687 2784 4757]
 [2701 2567 5582]]
training model: results/XRAY/W4/deepVOL_L2/h200
Epoch 1/50
339/339 - 11s - loss: 3.3446 - accuracy200: 0.3580 - val_loss: 3.3287 - val_accuracy200: 0.3446 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.3006 - accuracy200: 0.3706 - val_loss: 3.3092 - val_accuracy200: 0.3572 - 9s/epoch - 25ms/step
Epoch 3/50
339/339 - 9s - loss: 3.2769 - accuracy200: 0.3786 - val_loss: 3.3004 - val_accuracy200: 0.3601 - 9s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2628 - accuracy200: 0.3850 - val_loss: 3.2926 - val_accuracy200: 0.3630 - 9s/epoch - 26ms/step
Epoch 5/50
339/339 - 9s - loss: 3.2530 - accuracy200: 0.3872 - val_loss: 3.3012 - val_accuracy200: 0.3575 - 9s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2419 - accuracy200: 0.3929 - val_loss: 3.3023 - val_accuracy200: 0.3577 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2367 - accuracy200: 0.3958 - val_loss: 3.3122 - val_accuracy200: 0.3528 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.2314 - accuracy200: 0.3981 - val_loss: 3.3185 - val_accuracy200: 0.3508 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2257 - accuracy200: 0.4029 - val_loss: 3.3217 - val_accuracy200: 0.3513 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2181 - accuracy200: 0.4046 - val_loss: 3.3217 - val_accuracy200: 0.3537 - 9s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2149 - accuracy200: 0.4088 - val_loss: 3.3135 - val_accuracy200: 0.3590 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 9s - loss: 3.2100 - accuracy200: 0.4067 - val_loss: 3.3141 - val_accuracy200: 0.3568 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 3.2085 - accuracy200: 0.4075 - val_loss: 3.3064 - val_accuracy200: 0.3612 - 9s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 3.2010 - accuracy200: 0.4117 - val_loss: 3.3162 - val_accuracy200: 0.3629 - 9s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h200
Evaluating performance on  test set...
989/989 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954136
{'0': {'precision': 0.3431934687677995, 'recall': 0.11491417673235856, 'f1-score': 0.17217697766347573, 'support': 78650}, '1': {'precision': 0.43409853156014017, 'recall': 0.6265107945715332, 'f1-score': 0.5128512624380126, 'support': 101023}, '2': {'precision': 0.31724666905842913, 'recall': 0.34986902423051736, 'f1-score': 0.33276022033491426, 'support': 73296}, 'accuracy': 0.3872964671560547, 'macro avg': {'precision': 0.3648462231287896, 'recall': 0.3637646651781364, 'f1-score': 0.33926282014546755, 'support': 252969}, 'weighted avg': {'precision': 0.37197844055079515, 'recall': 0.3872964671560547, 'f1-score': 0.3547528965532361, 'support': 252969}}
[[ 9038 43313 26299]
 [ 8841 63292 28890]
 [ 8456 39196 25644]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0919626
{'0': {'precision': 0.3733566240691367, 'recall': 0.1421769421979484, 'f1-score': 0.20593306288032456, 'support': 28563}, '1': {'precision': 0.38148408651310006, 'recall': 0.6080437219730942, 'f1-score': 0.468827660723933, 'support': 28544}, '2': {'precision': 0.370744804269283, 'recall': 0.3799898080516392, 'f1-score': 0.37531038185356685, 'support': 29435}, 'accuracy': 0.3767188186083058, 'macro avg': {'precision': 0.37519517161717325, 'recall': 0.37673682407422726, 'f1-score': 0.35002370181927484, 'support': 86542}, 'weighted avg': {'precision': 0.37514894886162814, 'recall': 0.3767188186083058, 'f1-score': 0.3502524082250745, 'support': 86542}}
[[ 4061 13852 10650]
 [ 2854 17356  8334]
 [ 3962 14288 11185]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973088
{'0': {'precision': 0.37635054021608644, 'recall': 0.18128373168851195, 'f1-score': 0.24469884220111876, 'support': 10376}, '1': {'precision': 0.36115785930663075, 'recall': 0.5288319369147363, 'f1-score': 0.4292, 'support': 10145}, '2': {'precision': 0.3629591574621115, 'recall': 0.3849786577059304, 'f1-score': 0.3736447774349934, 'support': 11011}, 'accuracy': 0.3642331599644805, 'macro avg': {'precision': 0.36682251899494284, 'recall': 0.3650314421030596, 'f1-score': 0.3491812065453707, 'support': 31532}, 'weighted avg': {'precision': 0.3667862162489912, 'recall': 0.3642331599644805, 'f1-score': 0.34908765162423955, 'support': 31532}}
[[1881 4506 3989]
 [1329 5365 3451]
 [1788 4984 4239]]
training model: results/XRAY/W4/deepVOL_L2/h300
Epoch 1/50
339/339 - 11s - loss: 3.3452 - accuracy300: 0.3584 - val_loss: 3.3568 - val_accuracy300: 0.3503 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.3009 - accuracy300: 0.3660 - val_loss: 3.3086 - val_accuracy300: 0.3598 - 9s/epoch - 26ms/step
Epoch 3/50
339/339 - 9s - loss: 3.2782 - accuracy300: 0.3736 - val_loss: 3.3047 - val_accuracy300: 0.3552 - 9s/epoch - 26ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2606 - accuracy300: 0.3799 - val_loss: 3.3007 - val_accuracy300: 0.3572 - 9s/epoch - 25ms/step
Epoch 5/50
339/339 - 9s - loss: 3.2482 - accuracy300: 0.3891 - val_loss: 3.3049 - val_accuracy300: 0.3586 - 9s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2403 - accuracy300: 0.3907 - val_loss: 3.3045 - val_accuracy300: 0.3576 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2300 - accuracy300: 0.3965 - val_loss: 3.3102 - val_accuracy300: 0.3588 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.2238 - accuracy300: 0.4002 - val_loss: 3.3215 - val_accuracy300: 0.3580 - 9s/epoch - 26ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2191 - accuracy300: 0.4039 - val_loss: 3.3237 - val_accuracy300: 0.3591 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2104 - accuracy300: 0.4092 - val_loss: 3.3373 - val_accuracy300: 0.3538 - 9s/epoch - 26ms/step
Epoch 11/50
339/339 - 9s - loss: 3.2036 - accuracy300: 0.4110 - val_loss: 3.3554 - val_accuracy300: 0.3561 - 9s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 3.1980 - accuracy300: 0.4126 - val_loss: 3.3516 - val_accuracy300: 0.3591 - 8s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 3.1899 - accuracy300: 0.4175 - val_loss: 3.3707 - val_accuracy300: 0.3598 - 9s/epoch - 25ms/step
Epoch 14/50
339/339 - 9s - loss: 3.1859 - accuracy300: 0.4176 - val_loss: 3.3799 - val_accuracy300: 0.3596 - 9s/epoch - 26ms/step
testing model: results/XRAY/W4/deepVOL_L2/h300
Evaluating performance on  test set...
989/989 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1084577
{'0': {'precision': 0.34866955667856203, 'recall': 0.16581998769847597, 'f1-score': 0.2247524064625194, 'support': 87794}, '1': {'precision': 0.37246449364037526, 'recall': 0.4655072530935719, 'f1-score': 0.41382045154911007, 'support': 86308}, '2': {'precision': 0.3223187676587839, 'recall': 0.4223693052861146, 'f1-score': 0.36562302774195315, 'support': 78867}, 'accuracy': 0.348050551648621, 'macro avg': {'precision': 0.3478176059925737, 'recall': 0.35123218202605416, 'f1-score': 0.33473196191786087, 'support': 252969}, 'weighted avg': {'precision': 0.3485726505030122, 'recall': 0.348050551648621, 'f1-score': 0.33317726533367975, 'support': 252969}}
[[14558 37182 36054]
 [12148 40177 33983]
 [15047 30509 33311]]
Evaluating performance on  train set...
339/339 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855881
{'0': {'precision': 0.37210006663032286, 'recall': 0.2177673792052182, 'f1-score': 0.2747439509817076, 'support': 28209}, '1': {'precision': 0.4102039424323034, 'recall': 0.4205153305597315, 'f1-score': 0.4152956409149762, 'support': 28603}, '2': {'precision': 0.37083343568077426, 'recall': 0.5078035654221326, 'f1-score': 0.42864240996010855, 'support': 29730}, 'accuracy': 0.3844145039402833, 'macro avg': {'precision': 0.38437914824780023, 'recall': 0.3820287583956941, 'f1-score': 0.3728940006189308, 'support': 86542}, 'weighted avg': {'precision': 0.38425865114921504, 'recall': 0.3844145039402833, 'f1-score': 0.3740668366625232, 'support': 86542}}
[[ 6143  8466 13600]
 [ 4561 12028 12014]
 [ 5805  8828 15097]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994985
{'0': {'precision': 0.3506768189509306, 'recall': 0.23317082317644852, 'f1-score': 0.28009911026016443, 'support': 10666}, '1': {'precision': 0.34857270294380016, 'recall': 0.3244084682440847, 'f1-score': 0.33605676198666956, 'support': 9636}, '2': {'precision': 0.3673733195449845, 'recall': 0.5061442564559216, 'f1-score': 0.42573589993258926, 'support': 11230}, 'accuracy': 0.35827096283140936, 'macro avg': {'precision': 0.35554094714657175, 'recall': 0.3545745159588183, 'f1-score': 0.34729725739314105, 'support': 31532}, 'weighted avg': {'precision': 0.35598020724937396, 'recall': 0.35827096283140936, 'f1-score': 0.3490674306983838, 'support': 31532}}
[[2487 2907 5272]
 [1994 3126 4516]
 [2611 2935 5684]]
training model: results/XRAY/W4/deepVOL_L2/h500
Epoch 1/50
339/339 - 12s - loss: 3.3545 - accuracy500: 0.3479 - val_loss: 3.3897 - val_accuracy500: 0.3476 - 12s/epoch - 34ms/step
Epoch 2/50
339/339 - 9s - loss: 3.3110 - accuracy500: 0.3549 - val_loss: 3.3279 - val_accuracy500: 0.3505 - 9s/epoch - 26ms/step
Epoch 3/50
339/339 - 9s - loss: 3.2892 - accuracy500: 0.3651 - val_loss: 3.3176 - val_accuracy500: 0.3471 - 9s/epoch - 26ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2725 - accuracy500: 0.3757 - val_loss: 3.3348 - val_accuracy500: 0.3435 - 9s/epoch - 26ms/step
Epoch 5/50
339/339 - 9s - loss: 3.2614 - accuracy500: 0.3828 - val_loss: 3.3339 - val_accuracy500: 0.3452 - 9s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2560 - accuracy500: 0.3860 - val_loss: 3.3272 - val_accuracy500: 0.3391 - 9s/epoch - 25ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2459 - accuracy500: 0.3922 - val_loss: 3.3271 - val_accuracy500: 0.3348 - 9s/epoch - 26ms/step
Epoch 8/50
339/339 - 9s - loss: 3.2391 - accuracy500: 0.3959 - val_loss: 3.3508 - val_accuracy500: 0.3412 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2307 - accuracy500: 0.3973 - val_loss: 3.3601 - val_accuracy500: 0.3430 - 9s/epoch - 26ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2264 - accuracy500: 0.4006 - val_loss: 3.3784 - val_accuracy500: 0.3404 - 9s/epoch - 25ms/step
Epoch 11/50
339/339 - 8s - loss: 3.2200 - accuracy500: 0.4056 - val_loss: 3.3903 - val_accuracy500: 0.3449 - 8s/epoch - 25ms/step
Epoch 12/50
339/339 - 8s - loss: 3.2089 - accuracy500: 0.4079 - val_loss: 3.4025 - val_accuracy500: 0.3481 - 8s/epoch - 25ms/step
Epoch 13/50
339/339 - 8s - loss: 3.2032 - accuracy500: 0.4143 - val_loss: 3.4214 - val_accuracy500: 0.3490 - 8s/epoch - 25ms/step
testing model: results/XRAY/W4/deepVOL_L2/h500
Evaluating performance on  test set...
989/989 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066964
{'0': {'precision': 0.32891832229580575, 'recall': 0.06485235837170412, 'f1-score': 0.10834290088021432, 'support': 87306}, '1': {'precision': 0.3885108881482377, 'recall': 0.49368019134976193, 'f1-score': 0.4348267264539322, 'support': 91142}, '2': {'precision': 0.3101358167765818, 'recall': 0.49916131023469895, 'f1-score': 0.38257345908198004, 'support': 74521}, 'accuracy': 0.347295518423206, 'macro avg': {'precision': 0.34252167574020836, 'recall': 0.3525646199853883, 'f1-score': 0.3085810288053755, 'support': 252969}, 'weighted avg': {'precision': 0.3448558266663976, 'recall': 0.347295518423206, 'f1-score': 0.3067558457793663, 'support': 252969}}
[[ 5662 39878 41766]
 [ 5170 44995 40977]
 [ 6382 30941 37198]]
Evaluating performance on  train set...
339/339 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0920004
{'0': {'precision': 0.3644707795980016, 'recall': 0.11315106045303708, 'f1-score': 0.17268998926536566, 'support': 27724}, '1': {'precision': 0.39843152257077274, 'recall': 0.42761829814897184, 'f1-score': 0.4125092829441373, 'support': 29227}, '2': {'precision': 0.35939613889664357, 'recall': 0.5655773714980906, 'f1-score': 0.4395073400036765, 'support': 29591}, 'accuracy': 0.37404959441658386, 'macro avg': {'precision': 0.37409948035513935, 'recall': 0.36878224336669985, 'f1-score': 0.34156887073772646, 'support': 86542}, 'weighted avg': {'precision': 0.3742048617993755, 'recall': 0.37404959441658386, 'f1-score': 0.34491377334762413, 'support': 86542}}
[[ 3137  9111 15476]
 [ 2374 12498 14355]
 [ 3096  9759 16736]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027999
{'0': {'precision': 0.3468985887758451, 'recall': 0.1000378572780617, 'f1-score': 0.15529273488577097, 'support': 10566}, '1': {'precision': 0.3237229102167183, 'recall': 0.34261724349784967, 'f1-score': 0.33290219878619043, 'support': 9766}, '2': {'precision': 0.35616287398754753, 'recall': 0.5771428571428572, 'f1-score': 0.4404920099492317, 'support': 11200}, 'accuracy': 0.34463402258023595, 'macro avg': {'precision': 0.34226145766003696, 'recall': 0.33993265263958955, 'f1-score': 0.3095623145403977, 'support': 31532}, 'weighted avg': {'precision': 0.3430113097438343, 'recall': 0.34463402258023595, 'f1-score': 0.311602702701395, 'support': 31532}}
[[1057 3355 6154]
 [ 889 3346 5531]
 [1101 3635 6464]]
training model: results/XRAY/W4/deepVOL_L2/h1000
Epoch 1/50
339/339 - 11s - loss: 3.3686 - accuracy1000: 0.3509 - val_loss: 3.3932 - val_accuracy1000: 0.3612 - 11s/epoch - 32ms/step
Epoch 2/50
339/339 - 9s - loss: 3.3249 - accuracy1000: 0.3550 - val_loss: 3.3127 - val_accuracy1000: 0.3596 - 9s/epoch - 26ms/step
Epoch 3/50
339/339 - 9s - loss: 3.3003 - accuracy1000: 0.3628 - val_loss: 3.3131 - val_accuracy1000: 0.3468 - 9s/epoch - 25ms/step
Epoch 4/50
339/339 - 9s - loss: 3.2788 - accuracy1000: 0.3751 - val_loss: 3.3094 - val_accuracy1000: 0.3595 - 9s/epoch - 26ms/step
Epoch 5/50
339/339 - 8s - loss: 3.2648 - accuracy1000: 0.3805 - val_loss: 3.3062 - val_accuracy1000: 0.3587 - 8s/epoch - 25ms/step
Epoch 6/50
339/339 - 9s - loss: 3.2546 - accuracy1000: 0.3881 - val_loss: 3.3251 - val_accuracy1000: 0.3555 - 9s/epoch - 26ms/step
Epoch 7/50
339/339 - 9s - loss: 3.2452 - accuracy1000: 0.3890 - val_loss: 3.3229 - val_accuracy1000: 0.3609 - 9s/epoch - 25ms/step
Epoch 8/50
339/339 - 9s - loss: 3.2365 - accuracy1000: 0.3947 - val_loss: 3.3349 - val_accuracy1000: 0.3647 - 9s/epoch - 25ms/step
Epoch 9/50
339/339 - 9s - loss: 3.2313 - accuracy1000: 0.4003 - val_loss: 3.3131 - val_accuracy1000: 0.3640 - 9s/epoch - 25ms/step
Epoch 10/50
339/339 - 9s - loss: 3.2220 - accuracy1000: 0.4060 - val_loss: 3.3278 - val_accuracy1000: 0.3649 - 9s/epoch - 26ms/step
Epoch 11/50
339/339 - 9s - loss: 3.2135 - accuracy1000: 0.4061 - val_loss: 3.3393 - val_accuracy1000: 0.3641 - 9s/epoch - 26ms/step
Epoch 12/50
339/339 - 9s - loss: 3.2058 - accuracy1000: 0.4120 - val_loss: 3.3428 - val_accuracy1000: 0.3624 - 9s/epoch - 25ms/step
Epoch 13/50
339/339 - 9s - loss: 3.2009 - accuracy1000: 0.4125 - val_loss: 3.3704 - val_accuracy1000: 0.3648 - 9s/epoch - 25ms/step
Epoch 14/50
339/339 - 8s - loss: 3.1854 - accuracy1000: 0.4243 - val_loss: 3.4384 - val_accuracy1000: 0.3664 - 8s/epoch - 25ms/step
Epoch 15/50
339/339 - 9s - loss: 3.1798 - accuracy1000: 0.4226 - val_loss: 3.4486 - val_accuracy1000: 0.3652 - 9s/epoch - 26ms/step
testing model: results/XRAY/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
989/989 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060818
{'0': {'precision': 0.3603870766349305, 'recall': 0.13143963112654408, 'f1-score': 0.1926253441227997, 'support': 87835}, '1': {'precision': 0.39158237648052446, 'recall': 0.4209832237979938, 'f1-score': 0.40575089857790286, 'support': 92512}, '2': {'precision': 0.31043992228917644, 'recall': 0.5192779047671504, 'f1-score': 0.3885769044503292, 'support': 72622}, 'accuracy': 0.3486672280002688, 'macro avg': {'precision': 0.3541364584682105, 'recall': 0.3572335865638961, 'f1-score': 0.3289843823836773, 'support': 252969}, 'weighted avg': {'precision': 0.3574565884581904, 'recall': 0.3486672280002688, 'f1-score': 0.32681991147238143, 'support': 252969}}
[[11545 34861 41429]
 [11230 38946 42336]
 [ 9260 25651 37711]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0915587
{'0': {'precision': 0.37238587812008095, 'recall': 0.11802858059228111, 'f1-score': 0.1792450277364362, 'support': 28061}, '1': {'precision': 0.3935741576936436, 'recall': 0.39524905818334033, 'f1-score': 0.3944098297887153, 'support': 28668}, '2': {'precision': 0.36477137827991324, 'recall': 0.5977929091335994, 'f1-score': 0.45307673729836917, 'support': 29813}, 'accuracy': 0.3751357722262023, 'macro avg': {'precision': 0.376910471364546, 'recall': 0.3703568493030736, 'f1-score': 0.3422438649411735, 'support': 86542}, 'weighted avg': {'precision': 0.3767815994470664, 'recall': 0.3751357722262023, 'f1-score': 0.3448535103507119, 'support': 86542}}
[[ 3312  8520 16229]
 [ 2530 11331 14807]
 [ 3052  8939 17822]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023055
{'0': {'precision': 0.34323144104803494, 'recall': 0.11022812266267763, 'f1-score': 0.16686717146698749, 'support': 10696}, '1': {'precision': 0.3131202858277094, 'recall': 0.3452615451958853, 'f1-score': 0.3284063703549495, 'support': 9138}, '2': {'precision': 0.3785028577770379, 'recall': 0.5830911266883227, 'f1-score': 0.45903294188902716, 'support': 11698}, 'accuracy': 0.3537676011670684, 'macro avg': {'precision': 0.3449515282175941, 'recall': 0.3461935981822952, 'f1-score': 0.31810216123698803, 'support': 31532}, 'weighted avg': {'precision': 0.3475904825453247, 'recall': 0.3537676011670684, 'f1-score': 0.32207142054206095, 'support': 31532}}
[[1179 3341 6176]
 [ 959 3155 5024]
 [1297 3580 6821]]
training model: results/XRAY/W4/deepVOL_L3/h10
Epoch 1/50
339/339 - 15s - loss: 3.3237 - accuracy10: 0.3658 - val_loss: 3.3013 - val_accuracy10: 0.3616 - 15s/epoch - 46ms/step
Epoch 2/50
339/339 - 13s - loss: 3.2615 - accuracy10: 0.3874 - val_loss: 3.2641 - val_accuracy10: 0.3931 - 13s/epoch - 39ms/step
Epoch 3/50
339/339 - 13s - loss: 3.2126 - accuracy10: 0.4083 - val_loss: 3.2450 - val_accuracy10: 0.3920 - 13s/epoch - 39ms/step
Epoch 4/50
339/339 - 13s - loss: 3.1881 - accuracy10: 0.4144 - val_loss: 3.2289 - val_accuracy10: 0.3968 - 13s/epoch - 38ms/step
Epoch 5/50
339/339 - 13s - loss: 3.1766 - accuracy10: 0.4207 - val_loss: 3.2205 - val_accuracy10: 0.4035 - 13s/epoch - 39ms/step
Epoch 6/50
339/339 - 13s - loss: 3.1640 - accuracy10: 0.4251 - val_loss: 3.2123 - val_accuracy10: 0.4085 - 13s/epoch - 39ms/step
Epoch 7/50
339/339 - 13s - loss: 3.1509 - accuracy10: 0.4328 - val_loss: 3.2012 - val_accuracy10: 0.4094 - 13s/epoch - 39ms/step
Epoch 8/50
339/339 - 13s - loss: 3.1190 - accuracy10: 0.4487 - val_loss: 3.1705 - val_accuracy10: 0.4281 - 13s/epoch - 39ms/step
Epoch 9/50
339/339 - 13s - loss: 3.0866 - accuracy10: 0.4620 - val_loss: 3.1428 - val_accuracy10: 0.4444 - 13s/epoch - 39ms/step
Epoch 10/50
339/339 - 13s - loss: 3.0570 - accuracy10: 0.4773 - val_loss: 3.1462 - val_accuracy10: 0.4496 - 13s/epoch - 39ms/step
Epoch 11/50
339/339 - 13s - loss: 3.0398 - accuracy10: 0.4834 - val_loss: 3.1082 - val_accuracy10: 0.4664 - 13s/epoch - 40ms/step
Epoch 12/50
339/339 - 13s - loss: 3.0308 - accuracy10: 0.4856 - val_loss: 3.1197 - val_accuracy10: 0.4621 - 13s/epoch - 39ms/step
Epoch 13/50
339/339 - 13s - loss: 3.0164 - accuracy10: 0.4903 - val_loss: 3.1126 - val_accuracy10: 0.4660 - 13s/epoch - 38ms/step
Epoch 14/50
339/339 - 13s - loss: 3.0081 - accuracy10: 0.4917 - val_loss: 3.1157 - val_accuracy10: 0.4635 - 13s/epoch - 39ms/step
Epoch 15/50
339/339 - 13s - loss: 2.9967 - accuracy10: 0.4963 - val_loss: 3.1138 - val_accuracy10: 0.4633 - 13s/epoch - 39ms/step
Epoch 16/50
339/339 - 13s - loss: 2.9868 - accuracy10: 0.4993 - val_loss: 3.1200 - val_accuracy10: 0.4657 - 13s/epoch - 38ms/step
Epoch 17/50
339/339 - 13s - loss: 2.9833 - accuracy10: 0.5006 - val_loss: 3.1205 - val_accuracy10: 0.4601 - 13s/epoch - 38ms/step
Epoch 18/50
339/339 - 13s - loss: 2.9743 - accuracy10: 0.5035 - val_loss: 3.1235 - val_accuracy10: 0.4610 - 13s/epoch - 38ms/step
Epoch 19/50
339/339 - 13s - loss: 2.9657 - accuracy10: 0.5060 - val_loss: 3.1109 - val_accuracy10: 0.4698 - 13s/epoch - 38ms/step
Epoch 20/50
339/339 - 13s - loss: 2.9636 - accuracy10: 0.5066 - val_loss: 3.1203 - val_accuracy10: 0.4647 - 13s/epoch - 38ms/step
Epoch 21/50
339/339 - 13s - loss: 2.9580 - accuracy10: 0.5086 - val_loss: 3.1452 - val_accuracy10: 0.4599 - 13s/epoch - 39ms/step
testing model: results/XRAY/W4/deepVOL_L3/h10
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0460546
{'0': {'precision': 0.4291295131650404, 'recall': 0.35146419501556736, 'f1-score': 0.3864331913551033, 'support': 69697}, '1': {'precision': 0.6535434343434343, 'recall': 0.3514330905741053, 'f1-score': 0.4570789133100864, 'support': 115066}, '2': {'precision': 0.34973248464678275, 'recall': 0.6871536228484297, 'f1-score': 0.46354164091050704, 'support': 68206}, 'accuracy': 0.44195929145468416, 'macro avg': {'precision': 0.47746847738508585, 'recall': 0.46335030281270084, 'f1-score': 0.43568458185856557, 'support': 252969}, 'weighted avg': {'precision': 0.5097997080394985, 'recall': 0.44195929145468416, 'f1-score': 0.43935738187982354, 'support': 252969}}
[[24496 10658 34543]
 [22028 40438 52600]
 [10559 10779 46868]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.016257
{'0': {'precision': 0.4776093546990039, 'recall': 0.3929449492250134, 'f1-score': 0.43116019939399863, 'support': 28065}, '1': {'precision': 0.6112601919702756, 'recall': 0.3932733490487732, 'f1-score': 0.4786148655474069, 'support': 30119}, '2': {'precision': 0.42222171801969416, 'recall': 0.6562169405458778, 'f1-score': 0.5138336646785951, 'support': 28358}, 'accuracy': 0.4793279563680063, 'macro avg': {'precision': 0.5036970882296579, 'recall': 0.4808117462732215, 'f1-score': 0.4745362432066669, 'support': 86542}, 'weighted avg': {'precision': 0.5059741598435761, 'recall': 0.4793279563680063, 'f1-score': 0.4747660926991579, 'support': 86542}}
[[11028  3640 13397]
 [ 6206 11845 12068]
 [ 5856  3893 18609]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0325626
{'0': {'precision': 0.4710633946830266, 'recall': 0.4294770206022187, 'f1-score': 0.4493099917101478, 'support': 10727}, '1': {'precision': 0.5475792988313857, 'recall': 0.3316481294236603, 'f1-score': 0.41309823677581864, 'support': 9890}, '2': {'precision': 0.43795203654358583, 'recall': 0.6324324324324324, 'f1-score': 0.5175244592720321, 'support': 10915}, 'accuracy': 0.4690473170112901, 'macro avg': {'precision': 0.4855315766859994, 'recall': 0.46451919415277043, 'f1-score': 0.4599775625859995, 'support': 31532}, 'weighted avg': {'precision': 0.4836008746378431, 'recall': 0.4690473170112901, 'f1-score': 0.4615650550469945, 'support': 31532}}
[[4607 1294 4826]
 [2577 3280 4033]
 [2596 1416 6903]]
training model: results/XRAY/W4/deepVOL_L3/h20
Epoch 1/50
339/339 - 16s - loss: 3.3315 - accuracy20: 0.3594 - val_loss: 3.3415 - val_accuracy20: 0.3533 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 13s - loss: 3.2894 - accuracy20: 0.3692 - val_loss: 3.3072 - val_accuracy20: 0.3625 - 13s/epoch - 39ms/step
Epoch 3/50
339/339 - 13s - loss: 3.2593 - accuracy20: 0.3845 - val_loss: 3.2763 - val_accuracy20: 0.3790 - 13s/epoch - 39ms/step
Epoch 4/50
339/339 - 13s - loss: 3.2284 - accuracy20: 0.3990 - val_loss: 3.2803 - val_accuracy20: 0.3748 - 13s/epoch - 39ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2091 - accuracy20: 0.4090 - val_loss: 3.2560 - val_accuracy20: 0.3896 - 14s/epoch - 40ms/step
Epoch 6/50
339/339 - 13s - loss: 3.1964 - accuracy20: 0.4161 - val_loss: 3.2497 - val_accuracy20: 0.3924 - 13s/epoch - 39ms/step
Epoch 7/50
339/339 - 13s - loss: 3.1745 - accuracy20: 0.4297 - val_loss: 3.2550 - val_accuracy20: 0.4005 - 13s/epoch - 38ms/step
Epoch 8/50
339/339 - 13s - loss: 3.1556 - accuracy20: 0.4383 - val_loss: 3.2252 - val_accuracy20: 0.4111 - 13s/epoch - 39ms/step
Epoch 9/50
339/339 - 13s - loss: 3.1401 - accuracy20: 0.4463 - val_loss: 3.2163 - val_accuracy20: 0.4172 - 13s/epoch - 39ms/step
Epoch 10/50
339/339 - 13s - loss: 3.1324 - accuracy20: 0.4496 - val_loss: 3.2102 - val_accuracy20: 0.4248 - 13s/epoch - 39ms/step
Epoch 11/50
339/339 - 13s - loss: 3.1194 - accuracy20: 0.4547 - val_loss: 3.1884 - val_accuracy20: 0.4304 - 13s/epoch - 39ms/step
Epoch 12/50
339/339 - 13s - loss: 3.1070 - accuracy20: 0.4593 - val_loss: 3.2047 - val_accuracy20: 0.4323 - 13s/epoch - 39ms/step
Epoch 13/50
339/339 - 13s - loss: 3.0948 - accuracy20: 0.4640 - val_loss: 3.1981 - val_accuracy20: 0.4307 - 13s/epoch - 39ms/step
Epoch 14/50
339/339 - 13s - loss: 3.0865 - accuracy20: 0.4683 - val_loss: 3.1875 - val_accuracy20: 0.4379 - 13s/epoch - 39ms/step
Epoch 15/50
339/339 - 13s - loss: 3.0813 - accuracy20: 0.4708 - val_loss: 3.1862 - val_accuracy20: 0.4377 - 13s/epoch - 40ms/step
Epoch 16/50
339/339 - 13s - loss: 3.0712 - accuracy20: 0.4724 - val_loss: 3.1900 - val_accuracy20: 0.4374 - 13s/epoch - 38ms/step
Epoch 17/50
339/339 - 13s - loss: 3.0635 - accuracy20: 0.4755 - val_loss: 3.1802 - val_accuracy20: 0.4426 - 13s/epoch - 39ms/step
Epoch 18/50
339/339 - 13s - loss: 3.0535 - accuracy20: 0.4789 - val_loss: 3.1810 - val_accuracy20: 0.4401 - 13s/epoch - 39ms/step
Epoch 19/50
339/339 - 13s - loss: 3.0530 - accuracy20: 0.4778 - val_loss: 3.1878 - val_accuracy20: 0.4377 - 13s/epoch - 39ms/step
Epoch 20/50
339/339 - 13s - loss: 3.0450 - accuracy20: 0.4810 - val_loss: 3.1919 - val_accuracy20: 0.4367 - 13s/epoch - 39ms/step
Epoch 21/50
339/339 - 13s - loss: 3.0406 - accuracy20: 0.4842 - val_loss: 3.1852 - val_accuracy20: 0.4402 - 13s/epoch - 39ms/step
Epoch 22/50
339/339 - 13s - loss: 3.0353 - accuracy20: 0.4860 - val_loss: 3.1940 - val_accuracy20: 0.4389 - 13s/epoch - 39ms/step
Epoch 23/50
339/339 - 13s - loss: 3.0300 - accuracy20: 0.4866 - val_loss: 3.1848 - val_accuracy20: 0.4423 - 13s/epoch - 39ms/step
Epoch 24/50
339/339 - 13s - loss: 3.0241 - accuracy20: 0.4875 - val_loss: 3.1871 - val_accuracy20: 0.4391 - 13s/epoch - 39ms/step
Epoch 25/50
339/339 - 13s - loss: 3.0171 - accuracy20: 0.4913 - val_loss: 3.1994 - val_accuracy20: 0.4419 - 13s/epoch - 39ms/step
Epoch 26/50
339/339 - 13s - loss: 3.0195 - accuracy20: 0.4909 - val_loss: 3.1902 - val_accuracy20: 0.4431 - 13s/epoch - 38ms/step
Epoch 27/50
339/339 - 13s - loss: 3.0094 - accuracy20: 0.4930 - val_loss: 3.1976 - val_accuracy20: 0.4428 - 13s/epoch - 38ms/step
testing model: results/XRAY/W4/deepVOL_L3/h20
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0720745
{'0': {'precision': 0.4422518159806295, 'recall': 0.29862255950515687, 'f1-score': 0.35651487918540625, 'support': 73397}, '1': {'precision': 0.5790499164965671, 'recall': 0.28867057049556427, 'f1-score': 0.38527307409762396, 'support': 108099}, '2': {'precision': 0.34801597121436073, 'recall': 0.728037160885929, 'f1-score': 0.4709220243266724, 'support': 71473}, 'accuracy': 0.4156952037601445, 'macro avg': {'precision': 0.45643923456385244, 'recall': 0.43844343029555005, 'f1-score': 0.40423665920323426, 'support': 252969}, 'weighted avg': {'precision': 0.47408346070663465, 'recall': 0.4156952037601445, 'f1-score': 0.4011280689299898, 'support': 252969}}
[[21918 12366 39113]
 [18523 31205 58371]
 [ 9119 10319 52035]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0400153
{'0': {'precision': 0.4785428189967576, 'recall': 0.3495280883223627, 'f1-score': 0.40398510616886385, 'support': 28713}, '1': {'precision': 0.5539983511953833, 'recall': 0.303470316462292, 'f1-score': 0.3921357392943711, 'support': 28787}, '2': {'precision': 0.4151322262605169, 'recall': 0.7118655739962813, 'f1-score': 0.5244346359220222, 'support': 29042}, 'accuracy': 0.45580180721499386, 'macro avg': {'precision': 0.4825577988175526, 'recall': 0.45495465959364534, 'f1-score': 0.4401851604617524, 'support': 86542}, 'weighted avg': {'precision': 0.4823625593673977, 'recall': 0.45580180721499386, 'f1-score': 0.44046435923529637, 'support': 86542}}
[[10036  3692 14985]
 [ 5909  8736 14142]
 [ 5027  3341 20674]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0605974
{'0': {'precision': 0.4653130287648054, 'recall': 0.35150187163334246, 'f1-score': 0.4004784937847818, 'support': 10953}, '1': {'precision': 0.4576508190171794, 'recall': 0.24570999570999572, 'f1-score': 0.31974877878576413, 'support': 9324}, '2': {'precision': 0.42411790488713563, 'recall': 0.6877832074633496, 'f1-score': 0.5246890568339715, 'support': 11255}, 'accuracy': 0.4402511734111379, 'macro avg': {'precision': 0.44902725088970685, 'recall': 0.4283316916022293, 'f1-score': 0.4149721098015058, 'support': 31532}, 'weighted avg': {'precision': 0.44834317074977187, 'recall': 0.4402511734111379, 'f1-score': 0.4209423408121758, 'support': 31532}}
[[3850 1383 5720]
 [2242 2291 4791]
 [2182 1332 7741]]
training model: results/XRAY/W4/deepVOL_L3/h30
Epoch 1/50
339/339 - 16s - loss: 3.3256 - accuracy30: 0.3553 - val_loss: 3.3047 - val_accuracy30: 0.3548 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 14s - loss: 3.2895 - accuracy30: 0.3679 - val_loss: 3.3005 - val_accuracy30: 0.3620 - 14s/epoch - 40ms/step
Epoch 3/50
339/339 - 13s - loss: 3.2656 - accuracy30: 0.3803 - val_loss: 3.2817 - val_accuracy30: 0.3743 - 13s/epoch - 40ms/step
Epoch 4/50
339/339 - 13s - loss: 3.2511 - accuracy30: 0.3902 - val_loss: 3.2774 - val_accuracy30: 0.3739 - 13s/epoch - 40ms/step
Epoch 5/50
339/339 - 13s - loss: 3.2425 - accuracy30: 0.3926 - val_loss: 3.2781 - val_accuracy30: 0.3739 - 13s/epoch - 39ms/step
Epoch 6/50
339/339 - 13s - loss: 3.2311 - accuracy30: 0.3978 - val_loss: 3.2752 - val_accuracy30: 0.3769 - 13s/epoch - 39ms/step
Epoch 7/50
339/339 - 13s - loss: 3.2231 - accuracy30: 0.4032 - val_loss: 3.2795 - val_accuracy30: 0.3762 - 13s/epoch - 39ms/step
Epoch 8/50
339/339 - 13s - loss: 3.2097 - accuracy30: 0.4139 - val_loss: 3.2749 - val_accuracy30: 0.3829 - 13s/epoch - 39ms/step
Epoch 9/50
339/339 - 13s - loss: 3.2000 - accuracy30: 0.4205 - val_loss: 3.2659 - val_accuracy30: 0.3900 - 13s/epoch - 39ms/step
Epoch 10/50
339/339 - 13s - loss: 3.1892 - accuracy30: 0.4261 - val_loss: 3.2634 - val_accuracy30: 0.3965 - 13s/epoch - 40ms/step
Epoch 11/50
339/339 - 13s - loss: 3.1766 - accuracy30: 0.4307 - val_loss: 3.2599 - val_accuracy30: 0.3976 - 13s/epoch - 40ms/step
Epoch 12/50
339/339 - 13s - loss: 3.1684 - accuracy30: 0.4387 - val_loss: 3.2599 - val_accuracy30: 0.3968 - 13s/epoch - 40ms/step
Epoch 13/50
339/339 - 13s - loss: 3.1613 - accuracy30: 0.4407 - val_loss: 3.2612 - val_accuracy30: 0.4024 - 13s/epoch - 39ms/step
Epoch 14/50
339/339 - 13s - loss: 3.1515 - accuracy30: 0.4446 - val_loss: 3.2555 - val_accuracy30: 0.4007 - 13s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.1419 - accuracy30: 0.4472 - val_loss: 3.2479 - val_accuracy30: 0.4065 - 14s/epoch - 40ms/step
Epoch 16/50
339/339 - 13s - loss: 3.1356 - accuracy30: 0.4518 - val_loss: 3.2493 - val_accuracy30: 0.4088 - 13s/epoch - 40ms/step
Epoch 17/50
339/339 - 13s - loss: 3.1308 - accuracy30: 0.4536 - val_loss: 3.2480 - val_accuracy30: 0.4096 - 13s/epoch - 39ms/step
Epoch 18/50
339/339 - 14s - loss: 3.1214 - accuracy30: 0.4566 - val_loss: 3.2526 - val_accuracy30: 0.4102 - 14s/epoch - 40ms/step
Epoch 19/50
339/339 - 13s - loss: 3.1173 - accuracy30: 0.4600 - val_loss: 3.2530 - val_accuracy30: 0.4094 - 13s/epoch - 40ms/step
Epoch 20/50
339/339 - 14s - loss: 3.1106 - accuracy30: 0.4610 - val_loss: 3.2670 - val_accuracy30: 0.4070 - 14s/epoch - 41ms/step
Epoch 21/50
339/339 - 13s - loss: 3.1070 - accuracy30: 0.4614 - val_loss: 3.2565 - val_accuracy30: 0.4122 - 13s/epoch - 40ms/step
Epoch 22/50
339/339 - 14s - loss: 3.1028 - accuracy30: 0.4654 - val_loss: 3.2563 - val_accuracy30: 0.4102 - 14s/epoch - 40ms/step
Epoch 23/50
339/339 - 13s - loss: 3.0910 - accuracy30: 0.4679 - val_loss: 3.2669 - val_accuracy30: 0.4101 - 13s/epoch - 39ms/step
Epoch 24/50
339/339 - 13s - loss: 3.0877 - accuracy30: 0.4693 - val_loss: 3.2602 - val_accuracy30: 0.4128 - 13s/epoch - 40ms/step
Epoch 25/50
339/339 - 13s - loss: 3.0836 - accuracy30: 0.4693 - val_loss: 3.2726 - val_accuracy30: 0.4099 - 13s/epoch - 40ms/step
testing model: results/XRAY/W4/deepVOL_L3/h30
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0827402
{'0': {'precision': 0.43550047173857104, 'recall': 0.26191919322182533, 'f1-score': 0.32710844828835794, 'support': 77543}, '1': {'precision': 0.5222857142857142, 'recall': 0.22782109314243554, 'f1-score': 0.31725535932466953, 'support': 100298}, '2': {'precision': 0.3453743626332396, 'recall': 0.7474177403897349, 'f1-score': 0.4724392224171368, 'support': 75128}, 'accuracy': 0.3925856527874957, 'macro avg': {'precision': 0.4343868495525083, 'recall': 0.41238600891799854, 'f1-score': 0.37226767667672145, 'support': 252969}, 'weighted avg': {'precision': 0.4431432735527381, 'recall': 0.3925856527874957, 'f1-score': 0.3663629232709324, 'support': 252969}}
[[20310 10587 46646]
 [17663 22850 59785]
 [ 8663 10313 56152]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620847
{'0': {'precision': 0.4614155521363475, 'recall': 0.26784610099622125, 'f1-score': 0.3389410537297861, 'support': 29110}, '1': {'precision': 0.4951698547757661, 'recall': 0.27643844423015107, 'f1-score': 0.35480174192069674, 'support': 27999}, '2': {'precision': 0.394516135004536, 'recall': 0.7239832840689022, 'f1-score': 0.5107254991251828, 'support': 29433}, 'accuracy': 0.42575859120427073, 'macro avg': {'precision': 0.4503671806388832, 'recall': 0.42275594309842485, 'f1-score': 0.4014894315918886, 'support': 86542}, 'weighted avg': {'precision': 0.4495835650683398, 'recall': 0.42575859120427073, 'f1-score': 0.4024964949026273, 'support': 86542}}
[[ 7797  3796 17517]
 [ 5072  7740 15187]
 [ 4029  4095 21309]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818061
{'0': {'precision': 0.4370096908167974, 'recall': 0.2632993512511585, 'f1-score': 0.3286102596726621, 'support': 10790}, '1': {'precision': 0.4057273768613975, 'recall': 0.186558516801854, 'f1-score': 0.2555924375811806, 'support': 9493}, '2': {'precision': 0.39794832091357785, 'recall': 0.7310872077518001, 'f1-score': 0.5153689487701707, 'support': 11249}, 'accuracy': 0.4070785234047951, 'macro avg': {'precision': 0.4135617961972576, 'recall': 0.3936483586016042, 'f1-score': 0.3665238820080045, 'support': 31532}, 'weighted avg': {'precision': 0.4136567681851874, 'recall': 0.4070785234047951, 'f1-score': 0.37325348904420336, 'support': 31532}}
[[2841 1255 6694]
 [1974 1771 5748]
 [1686 1339 8224]]
training model: results/XRAY/W4/deepVOL_L3/h50
Epoch 1/50
339/339 - 16s - loss: 3.3252 - accuracy50: 0.3570 - val_loss: 3.3282 - val_accuracy50: 0.3283 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3029 - accuracy50: 0.3558 - val_loss: 3.3216 - val_accuracy50: 0.3281 - 14s/epoch - 42ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2976 - accuracy50: 0.3552 - val_loss: 3.3147 - val_accuracy50: 0.3285 - 14s/epoch - 41ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2977 - accuracy50: 0.3497 - val_loss: 3.3024 - val_accuracy50: 0.3289 - 14s/epoch - 40ms/step
Epoch 5/50
339/339 - 13s - loss: 3.2931 - accuracy50: 0.3534 - val_loss: 3.3007 - val_accuracy50: 0.3336 - 13s/epoch - 39ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2901 - accuracy50: 0.3534 - val_loss: 3.2894 - val_accuracy50: 0.3552 - 14s/epoch - 41ms/step
Epoch 7/50
339/339 - 14s - loss: 3.2855 - accuracy50: 0.3607 - val_loss: 3.2880 - val_accuracy50: 0.3563 - 14s/epoch - 40ms/step
Epoch 8/50
339/339 - 13s - loss: 3.2833 - accuracy50: 0.3661 - val_loss: 3.2885 - val_accuracy50: 0.3541 - 13s/epoch - 40ms/step
Epoch 9/50
339/339 - 13s - loss: 3.2804 - accuracy50: 0.3665 - val_loss: 3.2879 - val_accuracy50: 0.3567 - 13s/epoch - 40ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2771 - accuracy50: 0.3709 - val_loss: 3.2866 - val_accuracy50: 0.3607 - 14s/epoch - 40ms/step
Epoch 11/50
339/339 - 13s - loss: 3.2742 - accuracy50: 0.3734 - val_loss: 3.2840 - val_accuracy50: 0.3630 - 13s/epoch - 39ms/step
Epoch 12/50
339/339 - 13s - loss: 3.2721 - accuracy50: 0.3759 - val_loss: 3.2824 - val_accuracy50: 0.3690 - 13s/epoch - 39ms/step
Epoch 13/50
339/339 - 13s - loss: 3.2681 - accuracy50: 0.3795 - val_loss: 3.2871 - val_accuracy50: 0.3628 - 13s/epoch - 39ms/step
Epoch 14/50
339/339 - 14s - loss: 3.2622 - accuracy50: 0.3828 - val_loss: 3.2886 - val_accuracy50: 0.3624 - 14s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.2570 - accuracy50: 0.3892 - val_loss: 3.2904 - val_accuracy50: 0.3642 - 14s/epoch - 40ms/step
Epoch 16/50
339/339 - 14s - loss: 3.2509 - accuracy50: 0.3932 - val_loss: 3.2843 - val_accuracy50: 0.3617 - 14s/epoch - 40ms/step
Epoch 17/50
339/339 - 14s - loss: 3.2607 - accuracy50: 0.3870 - val_loss: 3.2855 - val_accuracy50: 0.3706 - 14s/epoch - 41ms/step
Epoch 18/50
339/339 - 13s - loss: 3.2553 - accuracy50: 0.3886 - val_loss: 3.2847 - val_accuracy50: 0.3642 - 13s/epoch - 40ms/step
Epoch 19/50
339/339 - 13s - loss: 3.2496 - accuracy50: 0.3950 - val_loss: 3.2817 - val_accuracy50: 0.3703 - 13s/epoch - 38ms/step
Epoch 20/50
339/339 - 13s - loss: 3.2449 - accuracy50: 0.3959 - val_loss: 3.2867 - val_accuracy50: 0.3686 - 13s/epoch - 40ms/step
Epoch 21/50
339/339 - 14s - loss: 3.2391 - accuracy50: 0.4020 - val_loss: 3.2911 - val_accuracy50: 0.3643 - 14s/epoch - 40ms/step
Epoch 22/50
339/339 - 13s - loss: 3.2312 - accuracy50: 0.4071 - val_loss: 3.2906 - val_accuracy50: 0.3721 - 13s/epoch - 40ms/step
Epoch 23/50
339/339 - 14s - loss: 3.2199 - accuracy50: 0.4127 - val_loss: 3.2955 - val_accuracy50: 0.3713 - 14s/epoch - 41ms/step
Epoch 24/50
339/339 - 14s - loss: 3.2151 - accuracy50: 0.4133 - val_loss: 3.3002 - val_accuracy50: 0.3737 - 14s/epoch - 41ms/step
Epoch 25/50
339/339 - 14s - loss: 3.2079 - accuracy50: 0.4203 - val_loss: 3.3065 - val_accuracy50: 0.3740 - 14s/epoch - 40ms/step
Epoch 26/50
339/339 - 14s - loss: 3.1994 - accuracy50: 0.4240 - val_loss: 3.3078 - val_accuracy50: 0.3722 - 14s/epoch - 40ms/step
Epoch 27/50
339/339 - 14s - loss: 3.1916 - accuracy50: 0.4285 - val_loss: 3.3142 - val_accuracy50: 0.3741 - 14s/epoch - 40ms/step
Epoch 28/50
339/339 - 14s - loss: 3.1881 - accuracy50: 0.4293 - val_loss: 3.3193 - val_accuracy50: 0.3720 - 14s/epoch - 40ms/step
Epoch 29/50
339/339 - 14s - loss: 3.1835 - accuracy50: 0.4305 - val_loss: 3.3246 - val_accuracy50: 0.3691 - 14s/epoch - 40ms/step
testing model: results/XRAY/W4/deepVOL_L3/h50
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1106638
{'0': {'precision': 0.3170598069655376, 'recall': 0.31771595900439237, 'f1-score': 0.31738754386088275, 'support': 71032}, '1': {'precision': 0.49587364591085753, 'recall': 0.25885796180543563, 'f1-score': 0.34014963725162095, 'support': 115828}, '2': {'precision': 0.27717288275293633, 'recall': 0.5086750669349105, 'f1-score': 0.35882497305718286, 'support': 66109}, 'accuracy': 0.34067020069652804, 'macro avg': {'precision': 0.3633687785431105, 'recall': 0.3617496625815795, 'f1-score': 0.33878738472322883, 'support': 252969}, 'weighted avg': {'precision': 0.3885103193389417, 'recall': 0.34067020069652804, 'f1-score': 0.33863866459109326, 'support': 252969}}
[[22568 15763 32701]
 [30849 29983 54996]
 [17762 14719 33628]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814987
{'0': {'precision': 0.38409632712432823, 'recall': 0.3302758668612327, 'f1-score': 0.35515869309372144, 'support': 28782}, '1': {'precision': 0.4279155548579501, 'recall': 0.38152048420389745, 'f1-score': 0.4033883884809588, 'support': 28583}, '2': {'precision': 0.37830840838359636, 'recall': 0.47078178016931144, 'f1-score': 0.419509513483798, 'support': 29177}, 'accuracy': 0.39457142196852396, 'macro avg': {'precision': 0.39677343012195826, 'recall': 0.3941927104114806, 'f1-score': 0.39268553168615944, 'support': 86542}, 'weighted avg': {'precision': 0.39661754088425727, 'recall': 0.39457142196852396, 'f1-score': 0.3927833524472685, 'support': 86542}}
[[ 9506  7251 12025]
 [ 7130 10905 10548]
 [ 8113  7328 13736]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935937
{'0': {'precision': 0.35994382629361565, 'recall': 0.3198003647183031, 'f1-score': 0.3386867249440943, 'support': 10419}, '1': {'precision': 0.38581716099109, 'recall': 0.3062094352416933, 'f1-score': 0.34143443508317134, 'support': 10323}, '2': {'precision': 0.3622354779150689, 'recall': 0.4727525486561631, 'f1-score': 0.41018012222579614, 'support': 10790}, 'accuracy': 0.3676899657490803, 'macro avg': {'precision': 0.3693321550665915, 'recall': 0.3662541162053865, 'f1-score': 0.3634337607510206, 'support': 31532}, 'weighted avg': {'precision': 0.36919846777140036, 'recall': 0.3676899657490803, 'f1-score': 0.3640507477918444, 'support': 31532}}
[[3332 2452 4635]
 [2816 3161 4346]
 [3109 2580 5101]]
training model: results/XRAY/W4/deepVOL_L3/h100
Epoch 1/50
339/339 - 16s - loss: 3.3467 - accuracy100: 0.3471 - val_loss: 3.3329 - val_accuracy100: 0.3352 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3176 - accuracy100: 0.3514 - val_loss: 3.3336 - val_accuracy100: 0.3418 - 14s/epoch - 40ms/step
Epoch 3/50
339/339 - 14s - loss: 3.3137 - accuracy100: 0.3471 - val_loss: 3.3116 - val_accuracy100: 0.3405 - 14s/epoch - 40ms/step
Epoch 4/50
339/339 - 14s - loss: 3.3038 - accuracy100: 0.3429 - val_loss: 3.3107 - val_accuracy100: 0.3404 - 14s/epoch - 40ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2969 - accuracy100: 0.3533 - val_loss: 3.3024 - val_accuracy100: 0.3428 - 14s/epoch - 40ms/step
Epoch 6/50
339/339 - 13s - loss: 3.2922 - accuracy100: 0.3546 - val_loss: 3.3021 - val_accuracy100: 0.3370 - 13s/epoch - 40ms/step
Epoch 7/50
339/339 - 13s - loss: 3.2846 - accuracy100: 0.3616 - val_loss: 3.3009 - val_accuracy100: 0.3380 - 13s/epoch - 40ms/step
Epoch 8/50
339/339 - 14s - loss: 3.2808 - accuracy100: 0.3625 - val_loss: 3.2971 - val_accuracy100: 0.3471 - 14s/epoch - 40ms/step
Epoch 9/50
339/339 - 14s - loss: 3.2753 - accuracy100: 0.3691 - val_loss: 3.2982 - val_accuracy100: 0.3442 - 14s/epoch - 40ms/step
Epoch 10/50
339/339 - 13s - loss: 3.2683 - accuracy100: 0.3767 - val_loss: 3.3039 - val_accuracy100: 0.3464 - 13s/epoch - 39ms/step
Epoch 11/50
339/339 - 13s - loss: 3.2664 - accuracy100: 0.3780 - val_loss: 3.3043 - val_accuracy100: 0.3458 - 13s/epoch - 40ms/step
Epoch 12/50
339/339 - 13s - loss: 3.2587 - accuracy100: 0.3832 - val_loss: 3.3142 - val_accuracy100: 0.3442 - 13s/epoch - 39ms/step
Epoch 13/50
339/339 - 14s - loss: 3.2534 - accuracy100: 0.3855 - val_loss: 3.3085 - val_accuracy100: 0.3469 - 14s/epoch - 40ms/step
Epoch 14/50
339/339 - 14s - loss: 3.2493 - accuracy100: 0.3878 - val_loss: 3.3190 - val_accuracy100: 0.3429 - 14s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.2439 - accuracy100: 0.3922 - val_loss: 3.3218 - val_accuracy100: 0.3473 - 14s/epoch - 40ms/step
Epoch 16/50
339/339 - 13s - loss: 3.2375 - accuracy100: 0.3975 - val_loss: 3.3398 - val_accuracy100: 0.3465 - 13s/epoch - 40ms/step
Epoch 17/50
339/339 - 13s - loss: 3.2290 - accuracy100: 0.4009 - val_loss: 3.3627 - val_accuracy100: 0.3489 - 13s/epoch - 39ms/step
Epoch 18/50
339/339 - 13s - loss: 3.2237 - accuracy100: 0.4083 - val_loss: 3.3663 - val_accuracy100: 0.3465 - 13s/epoch - 39ms/step
testing model: results/XRAY/W4/deepVOL_L3/h100
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1052488
{'0': {'precision': 0.32333107449217396, 'recall': 0.47351350042964163, 'f1-score': 0.3842697401698153, 'support': 82627}, '1': {'precision': 0.3878736990962724, 'recall': 0.18719274860037324, 'f1-score': 0.25251740606479084, 'support': 93775}, '2': {'precision': 0.3020090881830554, 'recall': 0.3420011231992895, 'f1-score': 0.32076338402552773, 'support': 76567}, 'accuracy': 0.3275697812775478, 'macro avg': {'precision': 0.3377379539238339, 'recall': 0.33423579074310145, 'f1-score': 0.3191835100867113, 'support': 252969}, 'weighted avg': {'precision': 0.3408032710716721, 'recall': 0.3275697812775478, 'f1-score': 0.31620777881645445, 'support': 252969}}
[[39125 15230 28272]
 [43973 17554 32248]
 [37908 12473 26186]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946637
{'0': {'precision': 0.35216517803112823, 'recall': 0.5031992529312074, 'f1-score': 0.4143479622931678, 'support': 28913}, '1': {'precision': 0.3990950226244344, 'recall': 0.21779314237335967, 'f1-score': 0.28180199917841986, 'support': 28348}, '2': {'precision': 0.3543129809469404, 'recall': 0.36009699122297734, 'f1-score': 0.35718157181571814, 'support': 29281}, 'accuracy': 0.36129278269510756, 'macro avg': {'precision': 0.36852439386750097, 'recall': 0.3603631288425148, 'f1-score': 0.3511105110957686, 'support': 86542}, 'weighted avg': {'precision': 0.36826437901688014, 'recall': 0.36129278269510756, 'f1-score': 0.35158881596020714, 'support': 86542}}
[[14549  4537  9827]
 [12786  6174  9388]
 [13978  4759 10544]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0984457
{'0': {'precision': 0.3381852415091607, 'recall': 0.44671895925004784, 'f1-score': 0.3849482751514652, 'support': 10454}, '1': {'precision': 0.35544945670069145, 'recall': 0.2110872115760657, 'f1-score': 0.2648754754017911, 'support': 10228}, '2': {'precision': 0.3480985492316937, 'recall': 0.3737327188940092, 'f1-score': 0.3604604649095515, 'support': 10850}, 'accuracy': 0.34517315742737537, 'macro avg': {'precision': 0.3472444158138486, 'recall': 0.34384629657337423, 'f1-score': 0.3367614051542693, 'support': 31532}, 'weighted avg': {'precision': 0.3471963344232943, 'recall': 0.34517315742737537, 'f1-score': 0.33757426345019576, 'support': 31532}}
[[4670 1949 3835]
 [4310 2159 3759]
 [4829 1966 4055]]
training model: results/XRAY/W4/deepVOL_L3/h200
Epoch 1/50
339/339 - 16s - loss: 3.3303 - accuracy200: 0.3593 - val_loss: 3.3642 - val_accuracy200: 0.3241 - 16s/epoch - 48ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3084 - accuracy200: 0.3537 - val_loss: 3.3154 - val_accuracy200: 0.3361 - 14s/epoch - 40ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2965 - accuracy200: 0.3569 - val_loss: 3.3110 - val_accuracy200: 0.3395 - 14s/epoch - 40ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2836 - accuracy200: 0.3690 - val_loss: 3.2910 - val_accuracy200: 0.3580 - 14s/epoch - 40ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2694 - accuracy200: 0.3804 - val_loss: 3.2888 - val_accuracy200: 0.3654 - 14s/epoch - 40ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2548 - accuracy200: 0.3882 - val_loss: 3.2929 - val_accuracy200: 0.3635 - 14s/epoch - 40ms/step
Epoch 7/50
339/339 - 14s - loss: 3.2485 - accuracy200: 0.3932 - val_loss: 3.2940 - val_accuracy200: 0.3618 - 14s/epoch - 40ms/step
Epoch 8/50
339/339 - 14s - loss: 3.2415 - accuracy200: 0.3959 - val_loss: 3.2966 - val_accuracy200: 0.3647 - 14s/epoch - 40ms/step
Epoch 9/50
339/339 - 13s - loss: 3.2346 - accuracy200: 0.3988 - val_loss: 3.2950 - val_accuracy200: 0.3637 - 13s/epoch - 40ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2284 - accuracy200: 0.4017 - val_loss: 3.2948 - val_accuracy200: 0.3652 - 14s/epoch - 40ms/step
Epoch 11/50
339/339 - 13s - loss: 3.2168 - accuracy200: 0.4077 - val_loss: 3.2976 - val_accuracy200: 0.3683 - 13s/epoch - 40ms/step
Epoch 12/50
339/339 - 14s - loss: 3.2116 - accuracy200: 0.4089 - val_loss: 3.2989 - val_accuracy200: 0.3619 - 14s/epoch - 41ms/step
Epoch 13/50
339/339 - 14s - loss: 3.2029 - accuracy200: 0.4127 - val_loss: 3.3028 - val_accuracy200: 0.3584 - 14s/epoch - 42ms/step
Epoch 14/50
339/339 - 13s - loss: 3.1989 - accuracy200: 0.4124 - val_loss: 3.3081 - val_accuracy200: 0.3627 - 13s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.1960 - accuracy200: 0.4151 - val_loss: 3.3043 - val_accuracy200: 0.3687 - 14s/epoch - 40ms/step
testing model: results/XRAY/W4/deepVOL_L3/h200
Evaluating performance on  test set...
989/989 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903155
{'0': {'precision': 0.34414966267952485, 'recall': 0.10572155117609663, 'f1-score': 0.1617531198023558, 'support': 78650}, '1': {'precision': 0.44842254796359604, 'recall': 0.5686922779960999, 'f1-score': 0.5014467074857838, 'support': 101023}, '2': {'precision': 0.32432217697884597, 'recall': 0.44553590919013314, 'f1-score': 0.3753865253526146, 'support': 73296}, 'accuracy': 0.3890674351402741, 'macro avg': {'precision': 0.37229812920732225, 'recall': 0.37331657945410984, 'f1-score': 0.3461954508802514, 'support': 252969}, 'weighted avg': {'precision': 0.38004609385542293, 'recall': 0.3890674351402741, 'f1-score': 0.35930831194745944, 'support': 252969}}
[[ 8315 38265 32070]
 [ 7608 57451 35964]
 [ 8238 32402 32656]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0863796
{'0': {'precision': 0.38167121153097, 'recall': 0.13720547561530652, 'f1-score': 0.2018490381396307, 'support': 28563}, '1': {'precision': 0.39972185624359535, 'recall': 0.5739559977578476, 'f1-score': 0.47124982022148715, 'support': 28544}, '2': {'precision': 0.37916572205849014, 'recall': 0.45456089689145573, 'f1-score': 0.4134542589187769, 'support': 29435}, 'accuracy': 0.38919830833583696, 'macro avg': {'precision': 0.3868529299443518, 'recall': 0.3885741234215366, 'f1-score': 0.3621843724266316, 'support': 86542}, 'weighted avg': {'precision': 0.38677264805953104, 'recall': 0.38919830833583696, 'f1-score': 0.36267702452056344, 'support': 86542}}
[[ 3919 12364 12280]
 [ 2533 16383  9628]
 [ 3816 12239 13380]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961189
{'0': {'precision': 0.36781268524007116, 'recall': 0.1196029298380879, 'f1-score': 0.1805090909090909, 'support': 10376}, '1': {'precision': 0.35741133055422675, 'recall': 0.5155248891079349, 'f1-score': 0.4221486802808943, 'support': 10145}, '2': {'precision': 0.36990757855822554, 'recall': 0.45436381800018166, 'f1-score': 0.40780893381154226, 'support': 11011}, 'accuracy': 0.3638843080045668, 'macro avg': {'precision': 0.3650438647841745, 'recall': 0.36316387898206814, 'f1-score': 0.3368222350005092, 'support': 31532}, 'weighted avg': {'precision': 0.3651977266912416, 'recall': 0.3638843080045668, 'f1-score': 0.33762669221493385, 'support': 31532}}
[[1241 4577 4558]
 [ 951 5230 3964]
 [1182 4826 5003]]
training model: results/XRAY/W4/deepVOL_L3/h300
Epoch 1/50
339/339 - 16s - loss: 3.3337 - accuracy300: 0.3628 - val_loss: 3.3603 - val_accuracy300: 0.3455 - 16s/epoch - 49ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3249 - accuracy300: 0.3572 - val_loss: 3.3343 - val_accuracy300: 0.3497 - 14s/epoch - 42ms/step
Epoch 3/50
339/339 - 15s - loss: 3.3027 - accuracy300: 0.3510 - val_loss: 3.3195 - val_accuracy300: 0.3528 - 15s/epoch - 43ms/step
Epoch 4/50
339/339 - 15s - loss: 3.2787 - accuracy300: 0.3727 - val_loss: 3.3042 - val_accuracy300: 0.3636 - 15s/epoch - 43ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2642 - accuracy300: 0.3843 - val_loss: 3.3023 - val_accuracy300: 0.3620 - 14s/epoch - 42ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2513 - accuracy300: 0.3909 - val_loss: 3.3002 - val_accuracy300: 0.3671 - 14s/epoch - 40ms/step
Epoch 7/50
339/339 - 14s - loss: 3.2404 - accuracy300: 0.3976 - val_loss: 3.3061 - val_accuracy300: 0.3681 - 14s/epoch - 41ms/step
Epoch 8/50
339/339 - 14s - loss: 3.2335 - accuracy300: 0.4000 - val_loss: 3.3090 - val_accuracy300: 0.3674 - 14s/epoch - 42ms/step
Epoch 9/50
339/339 - 14s - loss: 3.2255 - accuracy300: 0.4036 - val_loss: 3.3292 - val_accuracy300: 0.3608 - 14s/epoch - 41ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2136 - accuracy300: 0.4125 - val_loss: 3.3797 - val_accuracy300: 0.3669 - 14s/epoch - 40ms/step
Epoch 11/50
339/339 - 14s - loss: 3.2109 - accuracy300: 0.4120 - val_loss: 3.3699 - val_accuracy300: 0.3671 - 14s/epoch - 41ms/step
Epoch 12/50
339/339 - 14s - loss: 3.2060 - accuracy300: 0.4134 - val_loss: 3.3691 - val_accuracy300: 0.3628 - 14s/epoch - 42ms/step
Epoch 13/50
339/339 - 14s - loss: 3.1910 - accuracy300: 0.4202 - val_loss: 3.3873 - val_accuracy300: 0.3579 - 14s/epoch - 40ms/step
Epoch 14/50
339/339 - 14s - loss: 3.1859 - accuracy300: 0.4247 - val_loss: 3.3798 - val_accuracy300: 0.3587 - 14s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.1801 - accuracy300: 0.4239 - val_loss: 3.3898 - val_accuracy300: 0.3653 - 14s/epoch - 40ms/step
Epoch 16/50
339/339 - 14s - loss: 3.1780 - accuracy300: 0.4257 - val_loss: 3.3825 - val_accuracy300: 0.3599 - 14s/epoch - 41ms/step
testing model: results/XRAY/W4/deepVOL_L3/h300
Evaluating performance on  test set...
989/989 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046304
{'0': {'precision': 0.3618604964467347, 'recall': 0.12237738342027929, 'f1-score': 0.18289994467378815, 'support': 87794}, '1': {'precision': 0.38972456250221554, 'recall': 0.3821430226630208, 'f1-score': 0.38589655838115794, 'support': 86308}, '2': {'precision': 0.3310445801989196, 'recall': 0.5819797887582893, 'f1-score': 0.42202872432372796, 'support': 78867}, 'accuracy': 0.35429242318228715, 'macro avg': {'precision': 0.3608765463826233, 'recall': 0.3621667316138631, 'f1-score': 0.33027507579289134, 'support': 252969}, 'weighted avg': {'precision': 0.3617598238204446, 'recall': 0.35429242318228715, 'f1-score': 0.326710455845147, 'support': 252969}}
[[10744 28984 48066]
 [ 8642 32982 44684]
 [10305 22663 45899]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0801678
{'0': {'precision': 0.38395519017074714, 'recall': 0.15066113651671453, 'f1-score': 0.21640613065838382, 'support': 28209}, '1': {'precision': 0.44531042086454015, 'recall': 0.40950249973778974, 'f1-score': 0.42665646741704005, 'support': 28603}, '2': {'precision': 0.3774659345129144, 'recall': 0.6242852337706021, 'f1-score': 0.47046894803548794, 'support': 29730}, 'accuracy': 0.39891613320699776, 'macro avg': {'precision': 0.40224384851606726, 'recall': 0.39481629000836876, 'f1-score': 0.37117718203697064, 'support': 86542}, 'weighted avg': {'precision': 0.40200443900746446, 'recall': 0.39891613320699776, 'f1-score': 0.3731748434559752, 'support': 86542}}
[[ 4250  7302 16657]
 [ 2937 11713 13953]
 [ 3882  7288 18560]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986338
{'0': {'precision': 0.36187290969899666, 'recall': 0.1521657603600225, 'f1-score': 0.21424328427166525, 'support': 10666}, '1': {'precision': 0.36933461909353904, 'recall': 0.31797426317974264, 'f1-score': 0.3417354450144992, 'support': 9636}, '2': {'precision': 0.36899365367180414, 'recall': 0.6161175422974177, 'f1-score': 0.46155898735866047, 'support': 11230}, 'accuracy': 0.36807053152353164, 'macro avg': {'precision': 0.3667337274881133, 'recall': 0.3620858552790609, 'f1-score': 0.33917923888160834, 'support': 31532}, 'weighted avg': {'precision': 0.3666891911445262, 'recall': 0.36807053152353164, 'f1-score': 0.34128469637952086, 'support': 31532}}
[[1623 2622 6421]
 [1161 3064 5411]
 [1701 2610 6919]]
training model: results/XRAY/W4/deepVOL_L3/h500
Epoch 1/50
339/339 - 16s - loss: 3.3452 - accuracy500: 0.3580 - val_loss: 3.4046 - val_accuracy500: 0.3458 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3158 - accuracy500: 0.3515 - val_loss: 3.3487 - val_accuracy500: 0.3485 - 14s/epoch - 41ms/step
Epoch 3/50
339/339 - 14s - loss: 3.3014 - accuracy500: 0.3542 - val_loss: 3.3124 - val_accuracy500: 0.3527 - 14s/epoch - 41ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2834 - accuracy500: 0.3727 - val_loss: 3.3306 - val_accuracy500: 0.3576 - 14s/epoch - 40ms/step
Epoch 5/50
339/339 - 14s - loss: 3.2733 - accuracy500: 0.3833 - val_loss: 3.3069 - val_accuracy500: 0.3676 - 14s/epoch - 40ms/step
Epoch 6/50
339/339 - 14s - loss: 3.2585 - accuracy500: 0.3958 - val_loss: 3.3286 - val_accuracy500: 0.3668 - 14s/epoch - 40ms/step
Epoch 7/50
339/339 - 14s - loss: 3.2479 - accuracy500: 0.4043 - val_loss: 3.3372 - val_accuracy500: 0.3651 - 14s/epoch - 41ms/step
Epoch 8/50
339/339 - 14s - loss: 3.2446 - accuracy500: 0.4051 - val_loss: 3.3461 - val_accuracy500: 0.3687 - 14s/epoch - 40ms/step
Epoch 9/50
339/339 - 14s - loss: 3.2367 - accuracy500: 0.4084 - val_loss: 3.3555 - val_accuracy500: 0.3626 - 14s/epoch - 40ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2304 - accuracy500: 0.4089 - val_loss: 3.3833 - val_accuracy500: 0.3636 - 14s/epoch - 40ms/step
Epoch 11/50
339/339 - 14s - loss: 3.2247 - accuracy500: 0.4108 - val_loss: 3.3846 - val_accuracy500: 0.3690 - 14s/epoch - 41ms/step
Epoch 12/50
339/339 - 14s - loss: 3.2183 - accuracy500: 0.4142 - val_loss: 3.4025 - val_accuracy500: 0.3673 - 14s/epoch - 40ms/step
Epoch 13/50
339/339 - 14s - loss: 3.2196 - accuracy500: 0.4158 - val_loss: 3.3897 - val_accuracy500: 0.3674 - 14s/epoch - 41ms/step
Epoch 14/50
339/339 - 14s - loss: 3.2093 - accuracy500: 0.4202 - val_loss: 3.4020 - val_accuracy500: 0.3639 - 14s/epoch - 40ms/step
Epoch 15/50
339/339 - 14s - loss: 3.2099 - accuracy500: 0.4179 - val_loss: 3.4106 - val_accuracy500: 0.3698 - 14s/epoch - 40ms/step
testing model: results/XRAY/W4/deepVOL_L3/h500
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185321
{'0': {'precision': 0.34917032405459025, 'recall': 0.2660870959613314, 'f1-score': 0.30201900700737133, 'support': 87306}, '1': {'precision': 0.38705299586075864, 'recall': 0.2503346426455421, 'f1-score': 0.30403091478446265, 'support': 91142}, '2': {'precision': 0.3074931954913757, 'recall': 0.526053058869312, 'f1-score': 0.38811940002970147, 'support': 74521}, 'accuracy': 0.33699386090785827, 'macro avg': {'precision': 0.3479055051355749, 'recall': 0.34749159915872846, 'f1-score': 0.33138977394051183, 'support': 252969}, 'weighted avg': {'precision': 0.35054156391440905, 'recall': 0.33699386090785827, 'f1-score': 0.3281078032117945, 'support': 252969}}
[[23231 20092 43983]
 [24022 22816 44304]
 [19279 16040 39202]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0901148
{'0': {'precision': 0.36492446279440743, 'recall': 0.28055114702063194, 'f1-score': 0.31722337778865367, 'support': 27724}, '1': {'precision': 0.4338589677600487, 'recall': 0.3172409073801622, 'f1-score': 0.36649669947428754, 'support': 29227}, '2': {'precision': 0.38345076042592974, 'recall': 0.5683146902774492, 'f1-score': 0.4579294194532186, 'support': 29591}, 'accuracy': 0.3913359987058307, 'macro avg': {'precision': 0.39407806366012865, 'recall': 0.3887022482260811, 'f1-score': 0.38054983223871997, 'support': 86542}, 'weighted avg': {'precision': 0.39453968372580694, 'recall': 0.3913359987058307, 'f1-score': 0.38197510356113595, 'support': 86542}}
[[ 7778  6105 13841]
 [ 6756  9272 13199]
 [ 6780  5994 16817]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013116
{'0': {'precision': 0.3582089552238806, 'recall': 0.252129471890971, 'f1-score': 0.29595067488751875, 'support': 10566}, '1': {'precision': 0.36139139670738185, 'recall': 0.27872209707147244, 'f1-score': 0.3147184645623772, 'support': 9766}, '2': {'precision': 0.3698001569763932, 'recall': 0.546875, 'f1-score': 0.4412347368800202, 'support': 11200}, 'accuracy': 0.36505771914245844, 'macro avg': {'precision': 0.3631335029692185, 'recall': 0.35924218965414784, 'f1-score': 0.3506346254433054, 'support': 31532}, 'weighted avg': {'precision': 0.3633117455053729, 'recall': 0.36505771914245844, 'f1-score': 0.3533675126485451, 'support': 31532}}
[[2664 2405 5497]
 [2103 2722 4941]
 [2670 2405 6125]]
training model: results/XRAY/W4/deepVOL_L3/h1000
Epoch 1/50
339/339 - 16s - loss: 3.3383 - accuracy1000: 0.3643 - val_loss: 3.4146 - val_accuracy1000: 0.3695 - 16s/epoch - 47ms/step
Epoch 2/50
339/339 - 14s - loss: 3.3146 - accuracy1000: 0.3482 - val_loss: 3.3077 - val_accuracy1000: 0.3358 - 14s/epoch - 41ms/step
Epoch 3/50
339/339 - 14s - loss: 3.2889 - accuracy1000: 0.3598 - val_loss: 3.3068 - val_accuracy1000: 0.3567 - 14s/epoch - 41ms/step
Epoch 4/50
339/339 - 14s - loss: 3.2817 - accuracy1000: 0.3687 - val_loss: 3.3038 - val_accuracy1000: 0.3637 - 14s/epoch - 40ms/step
Epoch 5/50
339/339 - 13s - loss: 3.2777 - accuracy1000: 0.3797 - val_loss: 3.3131 - val_accuracy1000: 0.3632 - 13s/epoch - 39ms/step
Epoch 6/50
339/339 - 13s - loss: 3.2689 - accuracy1000: 0.3882 - val_loss: 3.3063 - val_accuracy1000: 0.3711 - 13s/epoch - 39ms/step
Epoch 7/50
339/339 - 13s - loss: 3.2600 - accuracy1000: 0.3955 - val_loss: 3.3083 - val_accuracy1000: 0.3654 - 13s/epoch - 40ms/step
Epoch 8/50
339/339 - 13s - loss: 3.2530 - accuracy1000: 0.4035 - val_loss: 3.3396 - val_accuracy1000: 0.3622 - 13s/epoch - 40ms/step
Epoch 9/50
339/339 - 14s - loss: 3.2540 - accuracy1000: 0.3990 - val_loss: 3.3116 - val_accuracy1000: 0.3730 - 14s/epoch - 40ms/step
Epoch 10/50
339/339 - 14s - loss: 3.2453 - accuracy1000: 0.4069 - val_loss: 3.3011 - val_accuracy1000: 0.3683 - 14s/epoch - 40ms/step
Epoch 11/50
339/339 - 13s - loss: 3.2370 - accuracy1000: 0.4101 - val_loss: 3.2972 - val_accuracy1000: 0.3737 - 13s/epoch - 40ms/step
Epoch 12/50
339/339 - 13s - loss: 3.2265 - accuracy1000: 0.4140 - val_loss: 3.3148 - val_accuracy1000: 0.3711 - 13s/epoch - 39ms/step
Epoch 13/50
339/339 - 13s - loss: 3.2230 - accuracy1000: 0.4190 - val_loss: 3.3142 - val_accuracy1000: 0.3651 - 13s/epoch - 39ms/step
Epoch 14/50
339/339 - 13s - loss: 3.2141 - accuracy1000: 0.4228 - val_loss: 3.3133 - val_accuracy1000: 0.3717 - 13s/epoch - 39ms/step
Epoch 15/50
339/339 - 13s - loss: 3.1987 - accuracy1000: 0.4323 - val_loss: 3.3378 - val_accuracy1000: 0.3669 - 13s/epoch - 39ms/step
Epoch 16/50
339/339 - 13s - loss: 3.1903 - accuracy1000: 0.4359 - val_loss: 3.3383 - val_accuracy1000: 0.3704 - 13s/epoch - 39ms/step
Epoch 17/50
339/339 - 13s - loss: 3.1757 - accuracy1000: 0.4426 - val_loss: 3.3633 - val_accuracy1000: 0.3625 - 13s/epoch - 39ms/step
Epoch 18/50
339/339 - 13s - loss: 3.1644 - accuracy1000: 0.4478 - val_loss: 3.3664 - val_accuracy1000: 0.3611 - 13s/epoch - 39ms/step
Epoch 19/50
339/339 - 14s - loss: 3.1480 - accuracy1000: 0.4543 - val_loss: 3.3873 - val_accuracy1000: 0.3604 - 14s/epoch - 40ms/step
Epoch 20/50
339/339 - 13s - loss: 3.1350 - accuracy1000: 0.4587 - val_loss: 3.3892 - val_accuracy1000: 0.3611 - 13s/epoch - 39ms/step
Epoch 21/50
339/339 - 13s - loss: 3.1274 - accuracy1000: 0.4629 - val_loss: 3.4163 - val_accuracy1000: 0.3614 - 13s/epoch - 39ms/step
testing model: results/XRAY/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
989/989 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11124
{'0': {'precision': 0.3591828200334547, 'recall': 0.3324756645983947, 'f1-score': 0.345313617793649, 'support': 87835}, '1': {'precision': 0.4065222639190642, 'recall': 0.200233483223798, 'f1-score': 0.2683101702648484, 'support': 92512}, '2': {'precision': 0.3055559961299941, 'recall': 0.5305554790559335, 'f1-score': 0.3877818035426731, 'support': 72622}, 'accuracy': 0.34097853887235197, 'macro avg': {'precision': 0.35708702669417103, 'recall': 0.35442154229270867, 'f1-score': 0.3338018638670568, 'support': 252969}, 'weighted avg': {'precision': 0.3610999696732461, 'recall': 0.34097853887235197, 'f1-score': 0.3293447901811005, 'support': 252969}}
[[29203 17080 41552]
 [27972 18524 46016]
 [24129  9963 38530]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0806159
{'0': {'precision': 0.39514005266937996, 'recall': 0.35290973236876805, 'f1-score': 0.3728328595900081, 'support': 28061}, '1': {'precision': 0.43876299309187167, 'recall': 0.23705874145388586, 'f1-score': 0.30781076612994546, 'support': 28668}, '2': {'precision': 0.38129199191146096, 'recall': 0.5881997786200651, 'f1-score': 0.4626668777373226, 'support': 29813}, 'accuracy': 0.3955882692796561, 'macro avg': {'precision': 0.4050650125575708, 'recall': 0.3927227508142397, 'f1-score': 0.38110350115242536, 'support': 86542}, 'weighted avg': {'precision': 0.40482009496856597, 'recall': 0.3955882692796561, 'f1-score': 0.38224064087207704, 'support': 86542}}
[[ 9903  4608 13550]
 [ 6967  6796 14905]
 [ 8192  4085 17536]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098921
{'0': {'precision': 0.3601083032490975, 'recall': 0.3357329842931937, 'f1-score': 0.3474937100832204, 'support': 10696}, '1': {'precision': 0.3292493528904228, 'recall': 0.2087984241628365, 'f1-score': 0.2555414183352307, 'support': 9138}, '2': {'precision': 0.3977798921661909, 'recall': 0.5360745426568644, 'f1-score': 0.4566871791137166, 'support': 11698}, 'accuracy': 0.37327159710770014, 'macro avg': {'precision': 0.36237918276857045, 'recall': 0.3602019837042982, 'f1-score': 0.35324076917738917, 'support': 31532}, 'weighted avg': {'precision': 0.36514106865486273, 'recall': 0.37327159710770014, 'f1-score': 0.3613553477441874, 'support': 31532}}
[[3591 1950 5155]
 [2891 1908 4339]
 [3490 1937 6271]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        11 (peak)   8.68 (ave)

============================================
