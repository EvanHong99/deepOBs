This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-18.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-10.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-27.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-02.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-04.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-03.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-05.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-11-26.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-12.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-11.csv
training model: results/XRAY/W9/deepLOB_L1/h10
Epoch 1/50
262/262 - 13s - loss: 3.2823 - accuracy10: 0.3892 - val_loss: 3.6763 - val_accuracy10: 0.3022 - 13s/epoch - 50ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2085 - accuracy10: 0.4234 - val_loss: 3.6140 - val_accuracy10: 0.3029 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.1881 - accuracy10: 0.4299 - val_loss: 3.5492 - val_accuracy10: 0.2961 - 4s/epoch - 16ms/step
Epoch 4/50
262/262 - 4s - loss: 3.1674 - accuracy10: 0.4413 - val_loss: 3.7198 - val_accuracy10: 0.3070 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.1428 - accuracy10: 0.4481 - val_loss: 3.7857 - val_accuracy10: 0.3041 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.1386 - accuracy10: 0.4504 - val_loss: 3.6992 - val_accuracy10: 0.3167 - 4s/epoch - 16ms/step
Epoch 7/50
262/262 - 4s - loss: 3.1247 - accuracy10: 0.4552 - val_loss: 3.7575 - val_accuracy10: 0.3164 - 4s/epoch - 16ms/step
Epoch 8/50
262/262 - 4s - loss: 3.1117 - accuracy10: 0.4574 - val_loss: 3.8322 - val_accuracy10: 0.3132 - 4s/epoch - 17ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1000 - accuracy10: 0.4626 - val_loss: 3.7202 - val_accuracy10: 0.3188 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.0877 - accuracy10: 0.4658 - val_loss: 3.8756 - val_accuracy10: 0.3194 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.0783 - accuracy10: 0.4699 - val_loss: 3.6188 - val_accuracy10: 0.3377 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.0695 - accuracy10: 0.4728 - val_loss: 3.6488 - val_accuracy10: 0.3201 - 4s/epoch - 17ms/step
Epoch 13/50
262/262 - 4s - loss: 3.0622 - accuracy10: 0.4744 - val_loss: 3.6545 - val_accuracy10: 0.3203 - 4s/epoch - 17ms/step
testing model: results/XRAY/W9/deepLOB_L1/h10
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0584389
{'0': {'precision': 0.4268270540172492, 'recall': 0.24649382651322516, 'f1-score': 0.31251142463067283, 'support': 38147}, '1': {'precision': 0.4389942993278312, 'recall': 0.7884020323184475, 'f1-score': 0.5639645301889629, 'support': 52354}, '2': {'precision': 0.44751901484969214, 'recall': 0.1569693581990955, 'f1-score': 0.2324172826966123, 'support': 39358}, 'accuracy': 0.43783642258141525, 'macro avg': {'precision': 0.4377801227315909, 'recall': 0.39728840567692264, 'f1-score': 0.36963107917208265, 'support': 129859}, 'weighted avg': {'precision': 0.4380037776593032, 'recall': 0.43783642258141525, 'f1-score': 0.38961220817403874, 'support': 129859}}
[[ 9403 25793  2951]
 [ 6402 41276  4676]
 [ 6225 26955  6178]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1287179
{'0': {'precision': 0.42501837784856655, 'recall': 0.15567921734057352, 'f1-score': 0.2278863524388241, 'support': 22283}, '1': {'precision': 0.3545581386920833, 'recall': 0.8518873263964474, 'f1-score': 0.5007165156865755, 'support': 22969}, '2': {'precision': 0.4294962003940332, 'recall': 0.07048498845265588, 'f1-score': 0.12109669483791612, 'support': 21650}, 'accuracy': 0.3671340169202714, 'macro avg': {'precision': 0.4030242389782277, 'recall': 0.35935051072989227, 'f1-score': 0.28323318765443856, 'support': 66902}, 'weighted avg': {'precision': 0.4022768099570848, 'recall': 0.3671340169202714, 'f1-score': 0.2869972898185429, 'support': 66902}}
[[ 3469 17787  1027]
 [ 2402 19567  1000]
 [ 2291 17833  1526]]
Evaluating performance on  val set...
73/73 - 1s - 571ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1722298
{'0': {'precision': 0.43595263724434874, 'recall': 0.11882059556989878, 'f1-score': 0.1867435158501441, 'support': 6817}, '1': {'precision': 0.27151232427661853, 'recall': 0.845006866784383, 'f1-score': 0.4109732824427481, 'support': 5097}, '2': {'precision': 0.4480171489817792, 'recall': 0.06201780415430267, 'f1-score': 0.10895347321777663, 'support': 6740}, 'accuracy': 0.2967192023158572, 'macro avg': {'precision': 0.38516070350091547, 'recall': 0.34194842216952814, 'f1-score': 0.23555675717022292, 'support': 18654}, 'weighted avg': {'precision': 0.3953802417213381, 'recall': 0.2967192023158572, 'f1-score': 0.21990499504926203, 'support': 18654}}
[[ 810 5750  257]
 [ 532 4307  258]
 [ 516 5806  418]]
training model: results/XRAY/W9/deepLOB_L1/h20
Epoch 1/50
262/262 - 6s - loss: 3.2987 - accuracy20: 0.3805 - val_loss: 3.5808 - val_accuracy20: 0.3161 - 6s/epoch - 24ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2398 - accuracy20: 0.4095 - val_loss: 3.5367 - val_accuracy20: 0.3469 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2030 - accuracy20: 0.4227 - val_loss: 3.5590 - val_accuracy20: 0.3082 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.1809 - accuracy20: 0.4376 - val_loss: 3.5637 - val_accuracy20: 0.3293 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.1685 - accuracy20: 0.4394 - val_loss: 3.4962 - val_accuracy20: 0.3296 - 4s/epoch - 17ms/step
Epoch 6/50
262/262 - 4s - loss: 3.1621 - accuracy20: 0.4415 - val_loss: 3.5682 - val_accuracy20: 0.3225 - 4s/epoch - 16ms/step
Epoch 7/50
262/262 - 4s - loss: 3.1541 - accuracy20: 0.4435 - val_loss: 3.5573 - val_accuracy20: 0.3203 - 4s/epoch - 16ms/step
Epoch 8/50
262/262 - 4s - loss: 3.1456 - accuracy20: 0.4477 - val_loss: 3.5005 - val_accuracy20: 0.3469 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1413 - accuracy20: 0.4492 - val_loss: 3.4671 - val_accuracy20: 0.3449 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.1272 - accuracy20: 0.4547 - val_loss: 3.5173 - val_accuracy20: 0.3265 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.1225 - accuracy20: 0.4564 - val_loss: 3.5491 - val_accuracy20: 0.3250 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.1172 - accuracy20: 0.4593 - val_loss: 3.6349 - val_accuracy20: 0.3189 - 4s/epoch - 17ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1127 - accuracy20: 0.4605 - val_loss: 3.4953 - val_accuracy20: 0.3259 - 4s/epoch - 16ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1039 - accuracy20: 0.4620 - val_loss: 3.4945 - val_accuracy20: 0.3354 - 4s/epoch - 17ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1024 - accuracy20: 0.4657 - val_loss: 3.6616 - val_accuracy20: 0.3103 - 4s/epoch - 16ms/step
Epoch 16/50
262/262 - 4s - loss: 3.0978 - accuracy20: 0.4674 - val_loss: 3.5148 - val_accuracy20: 0.3274 - 4s/epoch - 16ms/step
Epoch 17/50
262/262 - 4s - loss: 3.0895 - accuracy20: 0.4680 - val_loss: 3.5598 - val_accuracy20: 0.3266 - 4s/epoch - 16ms/step
Epoch 18/50
262/262 - 4s - loss: 3.0821 - accuracy20: 0.4706 - val_loss: 3.5694 - val_accuracy20: 0.3277 - 4s/epoch - 17ms/step
Epoch 19/50
262/262 - 4s - loss: 3.0743 - accuracy20: 0.4730 - val_loss: 3.5967 - val_accuracy20: 0.3419 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepLOB_L1/h20
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0643371
{'0': {'precision': 0.4444061113849187, 'recall': 0.22816295546558704, 'f1-score': 0.30152148470155493, 'support': 39520}, '1': {'precision': 0.4258820058327565, 'recall': 0.7503898908305674, 'f1-score': 0.5433736073608084, 'support': 50014}, '2': {'precision': 0.4263265877086636, 'recall': 0.22673279603223806, 'f1-score': 0.296028880866426, 'support': 40325}, 'accuracy': 0.4288497524237827, 'macro avg': {'precision': 0.43220490164211295, 'recall': 0.4017618807761309, 'f1-score': 0.38030799097626317, 'support': 129859}, 'weighted avg': {'precision': 0.4316575039928178, 'recall': 0.4288497524237827, 'f1-score': 0.3929629928991256, 'support': 129859}}
[[ 9017 24497  6006]
 [ 6187 37530  6297]
 [ 5086 26096  9143]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1331085
{'0': {'precision': 0.4231917010089527, 'recall': 0.26086194814295727, 'f1-score': 0.32276594591665314, 'support': 22832}, '1': {'precision': 0.34075718934130683, 'recall': 0.7141738088655424, 'f1-score': 0.46137588188015355, 'support': 21702}, '2': {'precision': 0.4466230936819172, 'recall': 0.14663805436337626, 'f1-score': 0.22078621432417878, 'support': 22368}, 'accuracy': 0.36971988879256223, 'macro avg': {'precision': 0.4035239946773923, 'recall': 0.3738912704572919, 'f1-score': 0.33497601404032845, 'support': 66902}, 'weighted avg': {'precision': 0.40428523512000497, 'recall': 0.36971988879256223, 'f1-score': 0.33363303799191873, 'support': 66902}}
[[ 5956 14825  2051]
 [ 4190 15499  2013]
 [ 3928 15160  3280]]
Evaluating performance on  val set...
73/73 - 1s - 576ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1601689
{'0': {'precision': 0.45048258497691984, 'recall': 0.3187351543942993, 'f1-score': 0.37332637802121366, 'support': 6736}, '1': {'precision': 0.2814591700133869, 'recall': 0.6620743948041724, 'f1-score': 0.39499794516526743, 'support': 5081}, '2': {'precision': 0.4767561983471074, 'recall': 0.1350007313149042, 'f1-score': 0.21041832896386645, 'support': 6837}, 'accuracy': 0.34491261927736677, 'macro avg': {'precision': 0.402899317779138, 'recall': 0.37193676017112526, 'f1-score': 0.3262475507167825, 'support': 18654}, 'weighted avg': {'precision': 0.4140734889751112, 'recall': 0.34491261927736677, 'f1-score': 0.3195208082374597, 'support': 18654}}
[[2147 4116  473]
 [1177 3364  540]
 [1442 4472  923]]
training model: results/XRAY/W9/deepLOB_L1/h30
Epoch 1/50
262/262 - 6s - loss: 3.3144 - accuracy30: 0.3656 - val_loss: 3.4980 - val_accuracy30: 0.3421 - 6s/epoch - 25ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2689 - accuracy30: 0.3858 - val_loss: 3.4291 - val_accuracy30: 0.3236 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2411 - accuracy30: 0.4017 - val_loss: 3.4901 - val_accuracy30: 0.3209 - 4s/epoch - 16ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2177 - accuracy30: 0.4142 - val_loss: 3.4609 - val_accuracy30: 0.3357 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2087 - accuracy30: 0.4183 - val_loss: 3.5825 - val_accuracy30: 0.3181 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2010 - accuracy30: 0.4231 - val_loss: 3.4265 - val_accuracy30: 0.3268 - 4s/epoch - 17ms/step
Epoch 7/50
262/262 - 4s - loss: 3.1878 - accuracy30: 0.4312 - val_loss: 3.3504 - val_accuracy30: 0.3423 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.1772 - accuracy30: 0.4355 - val_loss: 3.4192 - val_accuracy30: 0.3293 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1729 - accuracy30: 0.4357 - val_loss: 3.3899 - val_accuracy30: 0.3446 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.1680 - accuracy30: 0.4384 - val_loss: 3.3522 - val_accuracy30: 0.3580 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.1580 - accuracy30: 0.4427 - val_loss: 3.3558 - val_accuracy30: 0.3510 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 5s - loss: 3.1525 - accuracy30: 0.4447 - val_loss: 3.3430 - val_accuracy30: 0.3584 - 5s/epoch - 18ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1470 - accuracy30: 0.4484 - val_loss: 3.4322 - val_accuracy30: 0.3478 - 4s/epoch - 17ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1436 - accuracy30: 0.4465 - val_loss: 3.4454 - val_accuracy30: 0.3404 - 4s/epoch - 17ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1379 - accuracy30: 0.4492 - val_loss: 3.3713 - val_accuracy30: 0.3594 - 4s/epoch - 17ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1369 - accuracy30: 0.4493 - val_loss: 3.4514 - val_accuracy30: 0.3487 - 4s/epoch - 16ms/step
Epoch 17/50
262/262 - 4s - loss: 3.1294 - accuracy30: 0.4516 - val_loss: 3.4543 - val_accuracy30: 0.3545 - 4s/epoch - 16ms/step
Epoch 18/50
262/262 - 4s - loss: 3.1273 - accuracy30: 0.4515 - val_loss: 3.4362 - val_accuracy30: 0.3587 - 4s/epoch - 16ms/step
Epoch 19/50
262/262 - 4s - loss: 3.1230 - accuracy30: 0.4540 - val_loss: 3.4409 - val_accuracy30: 0.3599 - 4s/epoch - 17ms/step
Epoch 20/50
262/262 - 4s - loss: 3.1150 - accuracy30: 0.4553 - val_loss: 3.3256 - val_accuracy30: 0.3816 - 4s/epoch - 17ms/step
Epoch 21/50
262/262 - 4s - loss: 3.1118 - accuracy30: 0.4560 - val_loss: 3.3862 - val_accuracy30: 0.3677 - 4s/epoch - 17ms/step
Epoch 22/50
262/262 - 4s - loss: 3.1065 - accuracy30: 0.4593 - val_loss: 3.5119 - val_accuracy30: 0.3554 - 4s/epoch - 16ms/step
Epoch 23/50
262/262 - 4s - loss: 3.1087 - accuracy30: 0.4591 - val_loss: 3.3347 - val_accuracy30: 0.3764 - 4s/epoch - 17ms/step
Epoch 24/50
262/262 - 4s - loss: 3.0990 - accuracy30: 0.4611 - val_loss: 3.3820 - val_accuracy30: 0.3721 - 4s/epoch - 16ms/step
Epoch 25/50
262/262 - 4s - loss: 3.0987 - accuracy30: 0.4622 - val_loss: 3.4447 - val_accuracy30: 0.3654 - 4s/epoch - 16ms/step
Epoch 26/50
262/262 - 4s - loss: 3.0902 - accuracy30: 0.4661 - val_loss: 3.4439 - val_accuracy30: 0.3716 - 4s/epoch - 17ms/step
Epoch 27/50
262/262 - 4s - loss: 3.0906 - accuracy30: 0.4647 - val_loss: 3.4109 - val_accuracy30: 0.3760 - 4s/epoch - 16ms/step
Epoch 28/50
262/262 - 4s - loss: 3.0865 - accuracy30: 0.4668 - val_loss: 3.4965 - val_accuracy30: 0.3762 - 4s/epoch - 16ms/step
Epoch 29/50
262/262 - 4s - loss: 3.0791 - accuracy30: 0.4693 - val_loss: 3.5276 - val_accuracy30: 0.3686 - 4s/epoch - 16ms/step
Epoch 30/50
262/262 - 4s - loss: 3.0783 - accuracy30: 0.4676 - val_loss: 3.4133 - val_accuracy30: 0.3795 - 4s/epoch - 17ms/step
testing model: results/XRAY/W9/deepLOB_L1/h30
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0770948
{'0': {'precision': 0.42647355333019693, 'recall': 0.3188132740472781, 'f1-score': 0.36486739021059433, 'support': 39807}, '1': {'precision': 0.4133767807160463, 'recall': 0.4012652324661895, 'f1-score': 0.407230973424012, 'support': 49319}, '2': {'precision': 0.38426484385471116, 'recall': 0.49269633957724696, 'f1-score': 0.4317771084337349, 'support': 40733}, 'accuracy': 0.40466968019159244, 'macro avg': {'precision': 0.40803839263365144, 'recall': 0.4042582820302382, 'f1-score': 0.40129182402278046, 'support': 129859}, 'weighted avg': {'precision': 0.4082598978144278, 'recall': 0.40466968019159244, 'f1-score': 0.40194424366615567, 'support': 129859}}
[[12691 14778 12338]
 [ 9709 19790 19820]
 [ 7358 13306 20069]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919908
{'0': {'precision': 0.4128932849545206, 'recall': 0.36916718513909874, 'f1-score': 0.38980784120503975, 'support': 22502}, '1': {'precision': 0.3754530169998132, 'recall': 0.4500627015406664, 'f1-score': 0.4093862668812255, 'support': 22328}, '2': {'precision': 0.43091217903886503, 'recall': 0.39081188836534975, 'f1-score': 0.4098835827987645, 'support': 22072}, 'accuracy': 0.4033063286598308, 'macro avg': {'precision': 0.4064194936643996, 'recall': 0.40334725834837165, 'f1-score': 0.4030258969616766, 'support': 66902}, 'weighted avg': {'precision': 0.40634260974805353, 'recall': 0.4033063286598308, 'f1-score': 0.40296527830639056, 'support': 66902}}
[[ 8307  8714  5481]
 [ 6368 10049  5911]
 [ 5444  8002  8626]]
Evaluating performance on  val set...
73/73 - 1s - 568ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1084337
{'0': {'precision': 0.4295585412667946, 'recall': 0.3429885057471264, 'f1-score': 0.38142309331060925, 'support': 6525}, '1': {'precision': 0.30698462655852804, 'recall': 0.45792704947634527, 'f1-score': 0.36756286687441125, 'support': 5538}, '2': {'precision': 0.45572062512058653, 'recall': 0.3583674707935063, 'f1-score': 0.4012230338032954, 'support': 6591}, 'accuracy': 0.3825452985954755, 'macro avg': {'precision': 0.39742126431530306, 'recall': 0.38642767533899264, 'f1-score': 0.3834029979961053, 'support': 18654}, 'weighted avg': {'precision': 0.40241261840981823, 'recall': 0.3825452985954755, 'f1-score': 0.38430416298915704, 'support': 18654}}
[[2238 2933 1354]
 [1535 2536 1467]
 [1437 2792 2362]]
training model: results/XRAY/W9/deepLOB_L1/h50
Epoch 1/50
262/262 - 7s - loss: 3.3099 - accuracy50: 0.3709 - val_loss: 3.5213 - val_accuracy50: 0.3370 - 7s/epoch - 26ms/step
Epoch 2/50
262/262 - 5s - loss: 3.2733 - accuracy50: 0.3903 - val_loss: 3.4224 - val_accuracy50: 0.3610 - 5s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2338 - accuracy50: 0.4006 - val_loss: 3.3518 - val_accuracy50: 0.3585 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2202 - accuracy50: 0.4098 - val_loss: 3.3232 - val_accuracy50: 0.3681 - 4s/epoch - 17ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2079 - accuracy50: 0.4163 - val_loss: 3.3439 - val_accuracy50: 0.3674 - 4s/epoch - 17ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2029 - accuracy50: 0.4231 - val_loss: 3.3067 - val_accuracy50: 0.3729 - 4s/epoch - 16ms/step
Epoch 7/50
262/262 - 4s - loss: 3.1924 - accuracy50: 0.4243 - val_loss: 3.3262 - val_accuracy50: 0.3693 - 4s/epoch - 16ms/step
Epoch 8/50
262/262 - 4s - loss: 3.1837 - accuracy50: 0.4288 - val_loss: 3.3325 - val_accuracy50: 0.3717 - 4s/epoch - 17ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1742 - accuracy50: 0.4305 - val_loss: 3.3343 - val_accuracy50: 0.3680 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.1683 - accuracy50: 0.4348 - val_loss: 3.3598 - val_accuracy50: 0.3672 - 4s/epoch - 17ms/step
Epoch 11/50
262/262 - 4s - loss: 3.1641 - accuracy50: 0.4343 - val_loss: 3.3527 - val_accuracy50: 0.3708 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.1606 - accuracy50: 0.4368 - val_loss: 3.3712 - val_accuracy50: 0.3673 - 4s/epoch - 16ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1536 - accuracy50: 0.4379 - val_loss: 3.3816 - val_accuracy50: 0.3661 - 4s/epoch - 17ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1520 - accuracy50: 0.4376 - val_loss: 3.3519 - val_accuracy50: 0.3708 - 4s/epoch - 16ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1469 - accuracy50: 0.4417 - val_loss: 3.3765 - val_accuracy50: 0.3680 - 4s/epoch - 17ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1420 - accuracy50: 0.4429 - val_loss: 3.3804 - val_accuracy50: 0.3608 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepLOB_L1/h50
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829802
{'0': {'precision': 0.41775317454536626, 'recall': 0.3996655129962138, 'f1-score': 0.40850922386571376, 'support': 43051}, '1': {'precision': 0.35569920628426477, 'recall': 0.31277881709598504, 'f1-score': 0.33286113557180597, 'support': 41694}, '2': {'precision': 0.39556615201215173, 'recall': 0.4560225207252738, 'f1-score': 0.42364836341546286, 'support': 45114}, 'accuracy': 0.3913475384840481, 'macro avg': {'precision': 0.3896728442805942, 'recall': 0.3894889502724908, 'f1-score': 0.3883395742843276, 'support': 129859}, 'weighted avg': {'precision': 0.39012148565786675, 'recall': 0.3913475384840481, 'f1-score': 0.38948024434424194, 'support': 129859}}
[[17206 11900 13945]
 [11162 13041 17491]
 [12819 11722 20573]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893016
{'0': {'precision': 0.3664190525962149, 'recall': 0.4320993088876172, 'f1-score': 0.39655799297054906, 'support': 22717}, '1': {'precision': 0.3747103236899155, 'recall': 0.4574283628399343, 'f1-score': 0.4119580850626669, 'support': 21916}, '2': {'precision': 0.4150011228385358, 'recall': 0.2489559477300283, 'f1-score': 0.3112158976086224, 'support': 22269}, 'accuracy': 0.37943559235897284, 'macro avg': {'precision': 0.3853768330415554, 'recall': 0.3794945398191933, 'f1-score': 0.37324399188061275, 'support': 66902}, 'weighted avg': {'precision': 0.385306165380822, 'recall': 0.37943559235897284, 'f1-score': 0.3731958408177899, 'support': 66902}}
[[ 9816  8638  4263]
 [ 8339 10025  3552]
 [ 8634  8091  5544]]
Evaluating performance on  val set...
73/73 - 1s - 570ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1036316
{'0': {'precision': 0.37014289295562797, 'recall': 0.46140625, 'f1-score': 0.4107664487411323, 'support': 6400}, '1': {'precision': 0.3459233449477352, 'recall': 0.4181266846361186, 'f1-score': 0.37861337807947526, 'support': 5936}, '2': {'precision': 0.4198800342759212, 'recall': 0.23266856600189934, 'f1-score': 0.2994194928200428, 'support': 6318}, 'accuracy': 0.3701618955719953, 'macro avg': {'precision': 0.3786487573930948, 'recall': 0.370733833546006, 'f1-score': 0.3629331065468835, 'support': 18654}, 'weighted avg': {'precision': 0.3792815239134258, 'recall': 0.3701618955719953, 'f1-score': 0.36282227081912954, 'support': 18654}}
[[2953 2418 1029]
 [2452 2482 1002]
 [2573 2275 1470]]
training model: results/XRAY/W9/deepLOB_L1/h100
Epoch 1/50
262/262 - 6s - loss: 3.3409 - accuracy100: 0.3534 - val_loss: 3.4700 - val_accuracy100: 0.3315 - 6s/epoch - 25ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3021 - accuracy100: 0.3652 - val_loss: 3.4122 - val_accuracy100: 0.3343 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2837 - accuracy100: 0.3732 - val_loss: 3.4116 - val_accuracy100: 0.3329 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2724 - accuracy100: 0.3747 - val_loss: 3.4060 - val_accuracy100: 0.3391 - 4s/epoch - 17ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2622 - accuracy100: 0.3852 - val_loss: 3.3962 - val_accuracy100: 0.3370 - 4s/epoch - 17ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2545 - accuracy100: 0.3899 - val_loss: 3.3698 - val_accuracy100: 0.3380 - 4s/epoch - 17ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2478 - accuracy100: 0.3929 - val_loss: 3.3637 - val_accuracy100: 0.3412 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2415 - accuracy100: 0.3971 - val_loss: 3.3727 - val_accuracy100: 0.3437 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2350 - accuracy100: 0.4028 - val_loss: 3.3625 - val_accuracy100: 0.3517 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2322 - accuracy100: 0.4032 - val_loss: 3.3983 - val_accuracy100: 0.3471 - 4s/epoch - 17ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2307 - accuracy100: 0.4034 - val_loss: 3.4075 - val_accuracy100: 0.3498 - 4s/epoch - 17ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2233 - accuracy100: 0.4087 - val_loss: 3.3975 - val_accuracy100: 0.3476 - 4s/epoch - 17ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2209 - accuracy100: 0.4087 - val_loss: 3.4196 - val_accuracy100: 0.3417 - 4s/epoch - 16ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2155 - accuracy100: 0.4090 - val_loss: 3.4148 - val_accuracy100: 0.3470 - 4s/epoch - 17ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2123 - accuracy100: 0.4109 - val_loss: 3.4449 - val_accuracy100: 0.3371 - 4s/epoch - 16ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2104 - accuracy100: 0.4127 - val_loss: 3.4855 - val_accuracy100: 0.3471 - 4s/epoch - 16ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2057 - accuracy100: 0.4132 - val_loss: 3.4464 - val_accuracy100: 0.3443 - 4s/epoch - 17ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2030 - accuracy100: 0.4172 - val_loss: 3.4403 - val_accuracy100: 0.3405 - 4s/epoch - 17ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2044 - accuracy100: 0.4144 - val_loss: 3.4197 - val_accuracy100: 0.3412 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepLOB_L1/h100
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1057192
{'0': {'precision': 0.346088130444871, 'recall': 0.3952827233960537, 'f1-score': 0.36905324245900534, 'support': 41507}, '1': {'precision': 0.38294125615207475, 'recall': 0.3699696817676184, 'f1-score': 0.37634372815921724, 'support': 45847}, '2': {'precision': 0.35434247077939096, 'recall': 0.3181037524997059, 'f1-score': 0.3352466434424705, 'support': 42505}, 'accuracy': 0.3610839448940774, 'macro avg': {'precision': 0.3611239524587789, 'recall': 0.36111871922112604, 'f1-score': 0.36021453802023107, 'support': 129859}, 'weighted avg': {'precision': 0.3618009881614478, 'recall': 0.3610839448940774, 'f1-score': 0.36056170476581356, 'support': 129859}}
[[16407 13338 11762]
 [16010 16962 12875]
 [14990 13994 13521]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1086186
{'0': {'precision': 0.3542995381570266, 'recall': 0.43082545908361564, 'f1-score': 0.38883301822277644, 'support': 22436}, '1': {'precision': 0.35663643331630046, 'recall': 0.5030633390395531, 'f1-score': 0.41737992898523646, 'support': 22198}, '2': {'precision': 0.39913336543091, 'recall': 0.14891323872821988, 'f1-score': 0.21690214547357406, 'support': 22268}, 'accuracy': 0.3609608083465367, 'macro avg': {'precision': 0.3700231123014123, 'recall': 0.36093401228379624, 'f1-score': 0.34103836422719563, 'support': 66902}, 'weighted avg': {'precision': 0.36999763484293136, 'recall': 0.3609608083465367, 'f1-score': 0.34107850641036197, 'support': 66902}}
[[ 9666 10008  2762]
 [ 8801 11167  2230]
 [ 8815 10137  3316]]
Evaluating performance on  val set...
73/73 - 1s - 558ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1225935
{'0': {'precision': 0.3591004055548728, 'recall': 0.4530232558139535, 'f1-score': 0.4006306985672174, 'support': 6450}, '1': {'precision': 0.3340326855123675, 'recall': 0.5084033613445378, 'f1-score': 0.4031720645075303, 'support': 5950}, '2': {'precision': 0.3805612594113621, 'recall': 0.08890310201471059, 'f1-score': 0.14413480233311732, 'support': 6254}, 'accuracy': 0.34861155784282194, 'macro avg': {'precision': 0.35789811682620076, 'recall': 0.3501099063910673, 'f1-score': 0.31597918846928835, 'support': 18654}, 'weighted avg': {'precision': 0.358299678942113, 'recall': 0.34861155784282194, 'f1-score': 0.3154476703854226, 'support': 18654}}
[[2922 3076  452]
 [2472 3025  453]
 [2743 2955  556]]
training model: results/XRAY/W9/deepLOB_L1/h200
Epoch 1/50
262/262 - 6s - loss: 3.3150 - accuracy200: 0.3676 - val_loss: 3.4065 - val_accuracy200: 0.3444 - 6s/epoch - 24ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2801 - accuracy200: 0.3803 - val_loss: 3.5327 - val_accuracy200: 0.3318 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2700 - accuracy200: 0.3780 - val_loss: 3.5012 - val_accuracy200: 0.3379 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2497 - accuracy200: 0.3898 - val_loss: 3.5077 - val_accuracy200: 0.3327 - 4s/epoch - 17ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2345 - accuracy200: 0.3960 - val_loss: 3.5643 - val_accuracy200: 0.3309 - 4s/epoch - 17ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2176 - accuracy200: 0.4095 - val_loss: 3.5085 - val_accuracy200: 0.3492 - 4s/epoch - 17ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2225 - accuracy200: 0.4075 - val_loss: 3.4195 - val_accuracy200: 0.3364 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2093 - accuracy200: 0.4154 - val_loss: 3.4585 - val_accuracy200: 0.3427 - 4s/epoch - 17ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1940 - accuracy200: 0.4206 - val_loss: 3.5411 - val_accuracy200: 0.3351 - 4s/epoch - 16ms/step
Epoch 10/50
262/262 - 4s - loss: 3.1863 - accuracy200: 0.4240 - val_loss: 3.5429 - val_accuracy200: 0.3310 - 4s/epoch - 17ms/step
Epoch 11/50
262/262 - 5s - loss: 3.1751 - accuracy200: 0.4269 - val_loss: 3.4980 - val_accuracy200: 0.3351 - 5s/epoch - 18ms/step
testing model: results/XRAY/W9/deepLOB_L1/h200
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1103582
{'0': {'precision': 0.3478507353186381, 'recall': 0.24172691879866517, 'f1-score': 0.2852376980817348, 'support': 43152}, '1': {'precision': 0.40400523132254373, 'recall': 0.5722721378288255, 'f1-score': 0.47363780976292236, 'support': 43184}, '2': {'precision': 0.35853444266446177, 'recall': 0.31881993428761807, 'f1-score': 0.33751292186074794, 'support': 43523}, 'accuracy': 0.3774863505802447, 'macro avg': {'precision': 0.37013013643521453, 'recall': 0.37760633030503626, 'f1-score': 0.36546280990180174, 'support': 129859}, 'weighted avg': {'precision': 0.3701053557164923, 'recall': 0.3774863505802447, 'f1-score': 0.3654096152178162, 'support': 129859}}
[[10431 17782 14939]
 [ 8584 24713  9887]
 [10972 18675 13876]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1209259
{'0': {'precision': 0.3764277857686776, 'recall': 0.19761037576618992, 'f1-score': 0.25916756473363817, 'support': 22514}, '1': {'precision': 0.3747118425990457, 'recall': 0.6369435458149177, 'f1-score': 0.4718410882149427, 'support': 21947}, '2': {'precision': 0.3637284131180739, 'recall': 0.28813332739182745, 'f1-score': 0.3215475657665722, 'support': 22441}, 'accuracy': 0.37209649935726885, 'macro avg': {'precision': 0.37162268049526576, 'recall': 0.3742290829909784, 'f1-score': 0.35085207290505105, 'support': 66902}, 'weighted avg': {'precision': 0.37160511340617564, 'recall': 0.37209649935726885, 'f1-score': 0.3498586565249787, 'support': 66902}}
[[ 4449 11543  6522]
 [ 3179 13979  4789]
 [ 4191 11784  6466]]
Evaluating performance on  val set...
73/73 - 1s - 578ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1376691
{'0': {'precision': 0.37296620775969963, 'recall': 0.22640936027959277, 'f1-score': 0.28177004538577916, 'support': 6581}, '1': {'precision': 0.335161880176401, 'recall': 0.5202871931875105, 'f1-score': 0.40769331414366083, 'support': 5989}, '2': {'precision': 0.3302872062663185, 'recall': 0.2910913872452334, 'f1-score': 0.30945308404682864, 'support': 6084}, 'accuracy': 0.3418569743754691, 'macro avg': {'precision': 0.3461384314008064, 'recall': 0.3459293135707789, 'f1-score': 0.3329721478587562, 'support': 18654}, 'weighted avg': {'precision': 0.3469091067099459, 'recall': 0.3418569743754691, 'f1-score': 0.3312274306010026, 'support': 18654}}
[[1490 3182 1909]
 [1191 3116 1682]
 [1314 2999 1771]]
training model: results/XRAY/W9/deepLOB_L1/h300
Epoch 1/50
262/262 - 6s - loss: 3.3465 - accuracy300: 0.3532 - val_loss: 3.4205 - val_accuracy300: 0.3375 - 6s/epoch - 24ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3120 - accuracy300: 0.3596 - val_loss: 3.4420 - val_accuracy300: 0.3352 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2882 - accuracy300: 0.3659 - val_loss: 3.3939 - val_accuracy300: 0.3437 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2788 - accuracy300: 0.3716 - val_loss: 3.3920 - val_accuracy300: 0.3444 - 4s/epoch - 17ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2555 - accuracy300: 0.3902 - val_loss: 3.5099 - val_accuracy300: 0.3349 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2560 - accuracy300: 0.3924 - val_loss: 3.4505 - val_accuracy300: 0.3391 - 4s/epoch - 17ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2361 - accuracy300: 0.4073 - val_loss: 3.4408 - val_accuracy300: 0.3375 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2316 - accuracy300: 0.4085 - val_loss: 3.4875 - val_accuracy300: 0.3376 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2249 - accuracy300: 0.4126 - val_loss: 3.4388 - val_accuracy300: 0.3460 - 4s/epoch - 17ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2170 - accuracy300: 0.4161 - val_loss: 3.4492 - val_accuracy300: 0.3457 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2084 - accuracy300: 0.4209 - val_loss: 3.5544 - val_accuracy300: 0.3483 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2020 - accuracy300: 0.4244 - val_loss: 3.4732 - val_accuracy300: 0.3537 - 4s/epoch - 16ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1958 - accuracy300: 0.4309 - val_loss: 3.4785 - val_accuracy300: 0.3528 - 4s/epoch - 16ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1871 - accuracy300: 0.4336 - val_loss: 3.5190 - val_accuracy300: 0.3547 - 4s/epoch - 17ms/step
testing model: results/XRAY/W9/deepLOB_L1/h300
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.115734
{'0': {'precision': 0.3140332165168368, 'recall': 0.2534868275404029, 'f1-score': 0.280530298905646, 'support': 40653}, '1': {'precision': 0.390188473425853, 'recall': 0.5566506721998876, 'f1-score': 0.45878685312193823, 'support': 46266}, '2': {'precision': 0.34181701030927836, 'recall': 0.24708896134140662, 'f1-score': 0.28683427953500945, 'support': 42940}, 'accuracy': 0.35938209904588825, 'macro avg': {'precision': 0.3486795667506561, 'recall': 0.35240882036056576, 'f1-score': 0.34205047718753123, 'support': 129859}, 'weighted avg': {'precision': 0.3503528803183445, 'recall': 0.35938209904588825, 'f1-score': 0.3461238323965542, 'support': 129859}}
[[10305 19165 11183]
 [11265 25754  9247]
 [11245 21085 10610]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1260056
{'0': {'precision': 0.3527603513174404, 'recall': 0.25182498096645617, 'f1-score': 0.2938670986960725, 'support': 22329}, '1': {'precision': 0.35433414043583533, 'recall': 0.6616330590469301, 'f1-score': 0.46150935065754206, 'support': 22118}, '2': {'precision': 0.3775615814531153, 'recall': 0.16245824983299934, 'f1-score': 0.22716941183796743, 'support': 22455}, 'accuracy': 0.35731368270006875, 'macro avg': {'precision': 0.36155202440213036, 'recall': 0.35863876328212857, 'f1-score': 0.3275152870638607, 'support': 66902}, 'weighted avg': {'precision': 0.36160494027467993, 'recall': 0.35731368270006875, 'f1-score': 0.3269037010470491, 'support': 66902}}
[[ 5623 13278  3428]
 [ 4898 14634  2586]
 [ 5419 13388  3648]]
Evaluating performance on  val set...
73/73 - 1s - 571ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311738
{'0': {'precision': 0.3604336043360434, 'recall': 0.2675642216032188, 'f1-score': 0.3071320721200817, 'support': 6462}, '1': {'precision': 0.3399815637308305, 'recall': 0.6589248010394673, 'f1-score': 0.44853510226644555, 'support': 6157}, '2': {'precision': 0.3367983367983368, 'recall': 0.10737365368682684, 'f1-score': 0.16283452695062192, 'support': 6035}, 'accuracy': 0.34491261927736677, 'macro avg': {'precision': 0.3457378349550702, 'recall': 0.34462089210983765, 'f1-score': 0.30616723377904975, 'support': 18654}, 'weighted avg': {'precision': 0.3460365820568349, 'recall': 0.34491261927736677, 'f1-score': 0.3071204269776711, 'support': 18654}}
[[1729 4126  607]
 [1431 4057  669]
 [1637 3750  648]]
training model: results/XRAY/W9/deepLOB_L1/h500
Epoch 1/50
262/262 - 7s - loss: 3.3467 - accuracy500: 0.3536 - val_loss: 3.3574 - val_accuracy500: 0.3464 - 7s/epoch - 25ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3180 - accuracy500: 0.3580 - val_loss: 3.3606 - val_accuracy500: 0.3487 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2957 - accuracy500: 0.3748 - val_loss: 3.3971 - val_accuracy500: 0.3392 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2780 - accuracy500: 0.3838 - val_loss: 3.3528 - val_accuracy500: 0.3468 - 4s/epoch - 17ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2647 - accuracy500: 0.3963 - val_loss: 3.3284 - val_accuracy500: 0.3479 - 4s/epoch - 17ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2552 - accuracy500: 0.4002 - val_loss: 3.3261 - val_accuracy500: 0.3502 - 4s/epoch - 17ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2434 - accuracy500: 0.4059 - val_loss: 3.3215 - val_accuracy500: 0.3449 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2243 - accuracy500: 0.4171 - val_loss: 3.3225 - val_accuracy500: 0.3500 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2153 - accuracy500: 0.4237 - val_loss: 3.3366 - val_accuracy500: 0.3523 - 4s/epoch - 16ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2045 - accuracy500: 0.4255 - val_loss: 3.3353 - val_accuracy500: 0.3554 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.1930 - accuracy500: 0.4323 - val_loss: 3.3364 - val_accuracy500: 0.3586 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.1837 - accuracy500: 0.4386 - val_loss: 3.3361 - val_accuracy500: 0.3575 - 4s/epoch - 17ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1762 - accuracy500: 0.4400 - val_loss: 3.3473 - val_accuracy500: 0.3568 - 4s/epoch - 16ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1618 - accuracy500: 0.4460 - val_loss: 3.3455 - val_accuracy500: 0.3578 - 4s/epoch - 17ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1594 - accuracy500: 0.4473 - val_loss: 3.3736 - val_accuracy500: 0.3564 - 4s/epoch - 16ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1507 - accuracy500: 0.4496 - val_loss: 3.3646 - val_accuracy500: 0.3560 - 4s/epoch - 17ms/step
Epoch 17/50
262/262 - 4s - loss: 3.1411 - accuracy500: 0.4531 - val_loss: 3.3735 - val_accuracy500: 0.3473 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepLOB_L1/h500
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1299696
{'0': {'precision': 0.27408944797387935, 'recall': 0.2632423365826385, 'f1-score': 0.2685564070133671, 'support': 41137}, '1': {'precision': 0.35019940789312715, 'recall': 0.32420494699646646, 'f1-score': 0.33670120796527836, 'support': 44148}, '2': {'precision': 0.35718183471775905, 'recall': 0.39648674114954907, 'f1-score': 0.3758093840706836, 'support': 44574}, 'accuracy': 0.32970375561185594, 'macro avg': {'precision': 0.32715689686158855, 'recall': 0.32797800824288464, 'f1-score': 0.327022333016443, 'support': 129859}, 'weighted avg': {'precision': 0.32848585143637826, 'recall': 0.32970375561185594, 'f1-score': 0.3285380091493592, 'support': 129859}}
[[10829 12890 17418]
 [15447 14313 14388]
 [13233 13668 17673]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1230581
{'0': {'precision': 0.32518115942028986, 'recall': 0.41257072135785006, 'f1-score': 0.3637001246882793, 'support': 22624}, '1': {'precision': 0.3340764962346413, 'recall': 0.3050165106074999, 'f1-score': 0.3188858149488071, 'support': 22107}, '2': {'precision': 0.35178194737426444, 'recall': 0.28582382391412203, 'f1-score': 0.31539131516735097, 'support': 22171}, 'accuracy': 0.3350273534423485, 'macro avg': {'precision': 0.3370132010097319, 'recall': 0.334470351959824, 'f1-score': 0.33265908493481244, 'support': 66902}, 'weighted avg': {'precision': 0.3369358944159916, 'recall': 0.3350273534423485, 'f1-score': 0.3328824426862612, 'support': 66902}}
[[ 9334  6963  6327]
 [10014  6743  5350]
 [ 9356  6478  6337]]
Evaluating performance on  val set...
73/73 - 1s - 572ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062995
{'0': {'precision': 0.3529251700680272, 'recall': 0.40947119179163377, 'f1-score': 0.37910120569967115, 'support': 6335}, '1': {'precision': 0.35186806771745477, 'recall': 0.38028391167192427, 'f1-score': 0.36552456033959974, 'support': 6340}, '2': {'precision': 0.34276729559748426, 'recall': 0.25522662652617495, 'f1-score': 0.2925893969897421, 'support': 5979}, 'accuracy': 0.35011257639112253, 'macro avg': {'precision': 0.34918684446098874, 'recall': 0.348327243329911, 'f1-score': 0.34573838767633763, 'support': 18654}, 'weighted avg': {'precision': 0.34931007623496163, 'recall': 0.35011257639112253, 'f1-score': 0.3467580066078132, 'support': 18654}}
[[2594 2328 1413]
 [2416 2411 1513]
 [2340 2113 1526]]
training model: results/XRAY/W9/deepLOB_L1/h1000
Epoch 1/50
262/262 - 6s - loss: 3.3548 - accuracy1000: 0.3534 - val_loss: 3.3759 - val_accuracy1000: 0.3379 - 6s/epoch - 24ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3134 - accuracy1000: 0.3661 - val_loss: 3.4034 - val_accuracy1000: 0.3421 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2932 - accuracy1000: 0.3694 - val_loss: 3.4752 - val_accuracy1000: 0.3226 - 4s/epoch - 17ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2676 - accuracy1000: 0.3884 - val_loss: 3.4556 - val_accuracy1000: 0.3215 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2500 - accuracy1000: 0.4045 - val_loss: 3.4742 - val_accuracy1000: 0.3362 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2296 - accuracy1000: 0.4149 - val_loss: 3.4316 - val_accuracy1000: 0.3491 - 4s/epoch - 16ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2152 - accuracy1000: 0.4201 - val_loss: 3.3900 - val_accuracy1000: 0.3533 - 4s/epoch - 17ms/step
Epoch 8/50
262/262 - 4s - loss: 3.1907 - accuracy1000: 0.4303 - val_loss: 3.4870 - val_accuracy1000: 0.3619 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.1662 - accuracy1000: 0.4462 - val_loss: 3.5352 - val_accuracy1000: 0.3687 - 4s/epoch - 16ms/step
Epoch 10/50
262/262 - 4s - loss: 3.1393 - accuracy1000: 0.4571 - val_loss: 3.4794 - val_accuracy1000: 0.3674 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.1471 - accuracy1000: 0.4560 - val_loss: 3.4534 - val_accuracy1000: 0.3692 - 4s/epoch - 17ms/step
testing model: results/XRAY/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1327858
{'0': {'precision': 0.3253711861641377, 'recall': 0.23851213969620857, 'f1-score': 0.27525189786059345, 'support': 41805}, '1': {'precision': 0.3089368533713878, 'recall': 0.4412034442349824, 'f1-score': 0.3634093627378979, 'support': 39254}, '2': {'precision': 0.37996477730917183, 'recall': 0.33600409836065576, 'f1-score': 0.3566348391587098, 'support': 48800}, 'accuracy': 0.336418731085254, 'macro avg': {'precision': 0.33809093894823244, 'recall': 0.33857322743061563, 'f1-score': 0.3317653665857337, 'support': 129859}, 'weighted avg': {'precision': 0.3409192340347594, 'recall': 0.336418731085254, 'f1-score': 0.3324833616916856, 'support': 129859}}
[[ 9971 18323 13511]
 [ 8689 17319 13246]
 [11985 20418 16397]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1288594
{'0': {'precision': 0.35571327182398865, 'recall': 0.3213644524236984, 'f1-score': 0.337667587414943, 'support': 23394}, '1': {'precision': 0.3368411012907738, 'recall': 0.49702115682319276, 'f1-score': 0.4015463038411249, 'support': 21317}, '2': {'precision': 0.3575770278767554, 'recall': 0.23063404082736244, 'f1-score': 0.2804076265614727, 'support': 22191}, 'accuracy': 0.3472392454635138, 'macro avg': {'precision': 0.35004380033050597, 'recall': 0.3496732166914178, 'f1-score': 0.3398738392725136, 'support': 66902}, 'weighted avg': {'precision': 0.35031822461030904, 'recall': 0.3472392454635138, 'f1-score': 0.3390284855459041, 'support': 66902}}
[[ 7518 10789  5087]
 [ 6614 10595  4108]
 [ 7003 10070  5118]]
Evaluating performance on  val set...
73/73 - 1s - 566ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250902
{'0': {'precision': 0.35573063772855656, 'recall': 0.368607516943931, 'f1-score': 0.36205461835237157, 'support': 6492}, '1': {'precision': 0.33202828997221523, 'recall': 0.44236917381793706, 'f1-score': 0.3793377101219248, 'support': 5943}, '2': {'precision': 0.3449738089299077, 'recall': 0.22238301977809938, 'f1-score': 0.27043410246382477, 'support': 6219}, 'accuracy': 0.34335799292376973, 'macro avg': {'precision': 0.34424424554355987, 'recall': 0.3444532368466558, 'f1-score': 0.3372754769793737, 'support': 18654}, 'weighted avg': {'precision': 0.34459309237556346, 'recall': 0.34335799292376973, 'f1-score': 0.3370157755345085, 'support': 18654}}
[[2393 2771 1328]
 [2016 2629 1298]
 [2318 2518 1383]]
training model: results/XRAY/W9/deepOF_L1/h10
Epoch 1/50
262/262 - 6s - loss: 3.3205 - accuracy10: 0.3589 - val_loss: 3.3051 - val_accuracy10: 0.3736 - 6s/epoch - 24ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2747 - accuracy10: 0.3822 - val_loss: 3.2967 - val_accuracy10: 0.3783 - 4s/epoch - 15ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2574 - accuracy10: 0.3903 - val_loss: 3.2875 - val_accuracy10: 0.3833 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2490 - accuracy10: 0.3940 - val_loss: 3.2830 - val_accuracy10: 0.3893 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2380 - accuracy10: 0.3997 - val_loss: 3.2871 - val_accuracy10: 0.3816 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2313 - accuracy10: 0.4023 - val_loss: 3.2844 - val_accuracy10: 0.3812 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2250 - accuracy10: 0.4048 - val_loss: 3.2761 - val_accuracy10: 0.3919 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2195 - accuracy10: 0.4065 - val_loss: 3.2737 - val_accuracy10: 0.3928 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2142 - accuracy10: 0.4074 - val_loss: 3.2782 - val_accuracy10: 0.3861 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2112 - accuracy10: 0.4102 - val_loss: 3.2748 - val_accuracy10: 0.3863 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2068 - accuracy10: 0.4139 - val_loss: 3.2745 - val_accuracy10: 0.3893 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2019 - accuracy10: 0.4155 - val_loss: 3.2765 - val_accuracy10: 0.3846 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.1960 - accuracy10: 0.4185 - val_loss: 3.2740 - val_accuracy10: 0.3928 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.1937 - accuracy10: 0.4204 - val_loss: 3.2782 - val_accuracy10: 0.3872 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1913 - accuracy10: 0.4198 - val_loss: 3.2809 - val_accuracy10: 0.3843 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1875 - accuracy10: 0.4204 - val_loss: 3.2774 - val_accuracy10: 0.3887 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.1820 - accuracy10: 0.4235 - val_loss: 3.2769 - val_accuracy10: 0.3896 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.1785 - accuracy10: 0.4254 - val_loss: 3.2755 - val_accuracy10: 0.3918 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h10
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0783225
{'0': {'precision': 0.38685518612614606, 'recall': 0.45906409752261107, 'f1-score': 0.4198777125044959, 'support': 38145}, '1': {'precision': 0.46948560283880053, 'recall': 0.33105397868357717, 'f1-score': 0.3883007919705167, 'support': 52354}, '2': {'precision': 0.38250162565812934, 'recall': 0.4633346884846021, 'f1-score': 0.41905571705983063, 'support': 39356}, 'accuracy': 0.408748219167533, 'macro avg': {'precision': 0.4129474715410253, 'recall': 0.41781758823026344, 'f1-score': 0.40907807384494776, 'support': 129855}, 'weighted avg': {'precision': 0.41885005818186244, 'recall': 0.408748219167533, 'f1-score': 0.40689763048719824, 'support': 129855}}
[[17511  9557 11077]
 [16661 17332 18361]
 [11093 10028 18235]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0687174
{'0': {'precision': 0.4227308867221827, 'recall': 0.45359436037896816, 'f1-score': 0.4376191301334257, 'support': 22271}, '1': {'precision': 0.4042495232906565, 'recall': 0.3869790082141771, 'f1-score': 0.39542577994892864, 'support': 23009}, '2': {'precision': 0.425997425997426, 'recall': 0.413329016742207, 'f1-score': 0.4195676157836671, 'support': 21622}, 'accuracy': 0.41767062270186245, 'macro avg': {'precision': 0.4176592786700884, 'recall': 0.41796746177845073, 'f1-score': 0.41753750862200717, 'support': 66902}, 'weighted avg': {'precision': 0.4174304685136586, 'recall': 0.41767062270186245, 'f1-score': 0.41727389923351876, 'support': 66902}}
[[10102  6683  5486]
 [ 7549  8904  6556]
 [ 6246  6439  8937]]
Evaluating performance on  val set...
73/73 - 1s - 575ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0882082
{'0': {'precision': 0.442599484683653, 'recall': 0.453904873752202, 'f1-score': 0.4481808957819974, 'support': 6812}, '1': {'precision': 0.281707752768846, 'recall': 0.3109840268191678, 'f1-score': 0.2956228325053895, 'support': 5071}, '2': {'precision': 0.4317020926017466, 'recall': 0.3870014771048744, 'f1-score': 0.4081314744138952, 'support': 6770}, 'accuracy': 0.3907682410336139, 'macro avg': {'precision': 0.3853364433514152, 'recall': 0.3839634592254148, 'f1-score': 0.3839784009004273, 'support': 18653}, 'weighted avg': {'precision': 0.394904351625459, 'recall': 0.3907682410336139, 'f1-score': 0.3921707890143069, 'support': 18653}}
[[3092 1969 1751]
 [1796 1577 1698]
 [2098 2052 2620]]
training model: results/XRAY/W9/deepOF_L1/h20
Epoch 1/50
262/262 - 6s - loss: 3.3221 - accuracy20: 0.3549 - val_loss: 3.2823 - val_accuracy20: 0.3784 - 6s/epoch - 22ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2827 - accuracy20: 0.3800 - val_loss: 3.2693 - val_accuracy20: 0.3856 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2653 - accuracy20: 0.3875 - val_loss: 3.2603 - val_accuracy20: 0.3991 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2559 - accuracy20: 0.3906 - val_loss: 3.2567 - val_accuracy20: 0.3922 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2459 - accuracy20: 0.3960 - val_loss: 3.2589 - val_accuracy20: 0.3915 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2386 - accuracy20: 0.3990 - val_loss: 3.2508 - val_accuracy20: 0.3999 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2344 - accuracy20: 0.3994 - val_loss: 3.2522 - val_accuracy20: 0.4026 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2261 - accuracy20: 0.4070 - val_loss: 3.2493 - val_accuracy20: 0.4050 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2243 - accuracy20: 0.4053 - val_loss: 3.2465 - val_accuracy20: 0.4045 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2180 - accuracy20: 0.4079 - val_loss: 3.2526 - val_accuracy20: 0.4050 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2160 - accuracy20: 0.4093 - val_loss: 3.2509 - val_accuracy20: 0.4044 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2090 - accuracy20: 0.4130 - val_loss: 3.2543 - val_accuracy20: 0.4034 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2067 - accuracy20: 0.4127 - val_loss: 3.2519 - val_accuracy20: 0.4032 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2024 - accuracy20: 0.4157 - val_loss: 3.2498 - val_accuracy20: 0.4057 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.1993 - accuracy20: 0.4171 - val_loss: 3.2517 - val_accuracy20: 0.4058 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1952 - accuracy20: 0.4174 - val_loss: 3.2531 - val_accuracy20: 0.4042 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.1916 - accuracy20: 0.4194 - val_loss: 3.2532 - val_accuracy20: 0.4059 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.1886 - accuracy20: 0.4222 - val_loss: 3.2517 - val_accuracy20: 0.4066 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.1867 - accuracy20: 0.4213 - val_loss: 3.2493 - val_accuracy20: 0.4033 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h20
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0787437
{'0': {'precision': 0.3968682505399568, 'recall': 0.48357710410445875, 'f1-score': 0.4359530055891411, 'support': 39518}, '1': {'precision': 0.42612876254180604, 'recall': 0.20380293517815012, 'f1-score': 0.27573240998728593, 'support': 50014}, '2': {'precision': 0.37846771541802954, 'recall': 0.5423455596061801, 'f1-score': 0.4458239047560802, 'support': 40323}, 'accuracy': 0.39407030919102076, 'macro avg': {'precision': 0.4004882428332641, 'recall': 0.4099085329629297, 'f1-score': 0.3858364401108357, 'support': 129855}, 'weighted avg': {'precision': 0.40242422042589887, 'recall': 0.39407030919102076, 'f1-score': 0.3773087593042641, 'support': 129855}}
[[19110  6874 13534]
 [17441 10193 22380]
 [11601  6853 21869]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700783
{'0': {'precision': 0.42787011982991885, 'recall': 0.48503571272073964, 'f1-score': 0.45466307941919454, 'support': 22821}, '1': {'precision': 0.3780452851820006, 'recall': 0.24336915909405415, 'f1-score': 0.296113371685141, 'support': 21679}, '2': {'precision': 0.422218939282021, 'recall': 0.5103115793232748, 'f1-score': 0.4621043696188205, 'support': 22402}, 'accuracy': 0.4151893814833637, 'macro avg': {'precision': 0.40937811476464686, 'recall': 0.4129054837126895, 'f1-score': 0.4042936069077187, 'support': 66902}, 'weighted avg': {'precision': 0.40983253744125747, 'recall': 0.4151893814833637, 'f1-score': 0.405778153244872, 'support': 66902}}
[[11069  4487  7265]
 [ 8024  5276  8379]
 [ 6777  4193 11432]]
Evaluating performance on  val set...
73/73 - 1s - 563ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0855027
{'0': {'precision': 0.4358252947481243, 'recall': 0.4843656938653961, 'f1-score': 0.4588152327221438, 'support': 6716}, '1': {'precision': 0.2768918527109307, 'recall': 0.18777034998033817, 'f1-score': 0.22378441710603394, 'support': 5086}, '2': {'precision': 0.4330749354005168, 'recall': 0.48927163917676253, 'f1-score': 0.45946131176752797, 'support': 6851}, 'accuracy': 0.4052967351096338, 'macro avg': {'precision': 0.38193069428652393, 'recall': 0.3871358943408323, 'f1-score': 0.3806869871985686, 'support': 18653}, 'weighted avg': {'precision': 0.39147970968986956, 'recall': 0.4052967351096338, 'f1-score': 0.3949681067540096, 'support': 18653}}
[[3253 1282 2181]
 [1924  955 2207]
 [2287 1212 3352]]
training model: results/XRAY/W9/deepOF_L1/h30
Epoch 1/50
262/262 - 6s - loss: 3.3244 - accuracy30: 0.3526 - val_loss: 3.2852 - val_accuracy30: 0.3856 - 6s/epoch - 22ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2821 - accuracy30: 0.3775 - val_loss: 3.2732 - val_accuracy30: 0.3894 - 4s/epoch - 15ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2657 - accuracy30: 0.3842 - val_loss: 3.2654 - val_accuracy30: 0.3933 - 4s/epoch - 16ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2566 - accuracy30: 0.3869 - val_loss: 3.2587 - val_accuracy30: 0.3997 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2481 - accuracy30: 0.3915 - val_loss: 3.2545 - val_accuracy30: 0.4041 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2401 - accuracy30: 0.3956 - val_loss: 3.2535 - val_accuracy30: 0.4010 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2335 - accuracy30: 0.4003 - val_loss: 3.2552 - val_accuracy30: 0.4036 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2289 - accuracy30: 0.4003 - val_loss: 3.2533 - val_accuracy30: 0.4052 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2237 - accuracy30: 0.4033 - val_loss: 3.2494 - val_accuracy30: 0.4050 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2202 - accuracy30: 0.4053 - val_loss: 3.2554 - val_accuracy30: 0.4038 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2171 - accuracy30: 0.4066 - val_loss: 3.2544 - val_accuracy30: 0.4063 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2146 - accuracy30: 0.4063 - val_loss: 3.2565 - val_accuracy30: 0.4023 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2082 - accuracy30: 0.4107 - val_loss: 3.2574 - val_accuracy30: 0.4036 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2039 - accuracy30: 0.4118 - val_loss: 3.2555 - val_accuracy30: 0.4049 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2017 - accuracy30: 0.4132 - val_loss: 3.2589 - val_accuracy30: 0.4037 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.1970 - accuracy30: 0.4135 - val_loss: 3.2597 - val_accuracy30: 0.4041 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.1978 - accuracy30: 0.4168 - val_loss: 3.2599 - val_accuracy30: 0.4041 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.1926 - accuracy30: 0.4184 - val_loss: 3.2603 - val_accuracy30: 0.4065 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.1895 - accuracy30: 0.4194 - val_loss: 3.2598 - val_accuracy30: 0.4035 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h30
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759239
{'0': {'precision': 0.4062443347769161, 'recall': 0.5066827454527183, 'f1-score': 0.45093852362798914, 'support': 39804}, '1': {'precision': 0.4464942885819433, 'recall': 0.18941989902471665, 'f1-score': 0.26599470402323394, 'support': 49319}, '2': {'precision': 0.3749051225395112, 'recall': 0.5456888932534617, 'f1-score': 0.44445555344484555, 'support': 40732}, 'accuracy': 0.3984213160833237, 'macro avg': {'precision': 0.40921458196612354, 'recall': 0.4139305125769656, 'f1-score': 0.38712959369868954, 'support': 129855}, 'weighted avg': {'precision': 0.41170102630867195, 'recall': 0.3984213160833237, 'f1-score': 0.3786632274854707, 'support': 129855}}
[[20168  5669 13967]
 [16884  9342 23093]
 [12593  5912 22227]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703647
{'0': {'precision': 0.41607705779334503, 'recall': 0.5286133855464578, 'f1-score': 0.4656422719611148, 'support': 22472}, '1': {'precision': 0.40732507674393986, 'recall': 0.17216231935931278, 'f1-score': 0.2420278004905969, 'support': 22351}, '2': {'precision': 0.41148590209306346, 'recall': 0.5387019339644006, 'f1-score': 0.466577749882316, 'support': 22079}, 'accuracy': 0.4128576126274252, 'macro avg': {'precision': 0.41162934554344943, 'recall': 0.4131592129567237, 'f1-score': 0.3914159407780093, 'support': 66902}, 'weighted avg': {'precision': 0.4116379729357657, 'recall': 0.4128576126274252, 'f1-score': 0.3912446061990248, 'support': 66902}}
[[11879  2889  7704]
 [ 9196  3848  9307]
 [ 7475  2710 11894]]
Evaluating performance on  val set...
73/73 - 1s - 544ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843538
{'0': {'precision': 0.4140246176799702, 'recall': 0.5146831530139103, 'f1-score': 0.4588989182112589, 'support': 6470}, '1': {'precision': 0.3234577922077922, 'recall': 0.14270367054610564, 'f1-score': 0.1980370232326997, 'support': 5585}, '2': {'precision': 0.41885588018659464, 'recall': 0.5171264019399818, 'f1-score': 0.4628323385784048, 'support': 6598}, 'accuracy': 0.40417091084544043, 'macro avg': {'precision': 0.38544609669145236, 'recall': 0.3915044084999993, 'f1-score': 0.3732560933407878, 'support': 18653}, 'weighted avg': {'precision': 0.3886164232745981, 'recall': 0.40417091084544043, 'f1-score': 0.3821841283183289, 'support': 18653}}
[[3330  844 2296]
 [2350  797 2438]
 [2363  823 3412]]
training model: results/XRAY/W9/deepOF_L1/h50
Epoch 1/50
262/262 - 6s - loss: 3.3326 - accuracy50: 0.3506 - val_loss: 3.3117 - val_accuracy50: 0.3689 - 6s/epoch - 23ms/step
Epoch 2/50
262/262 - 4s - loss: 3.2954 - accuracy50: 0.3758 - val_loss: 3.2991 - val_accuracy50: 0.3780 - 4s/epoch - 16ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2815 - accuracy50: 0.3815 - val_loss: 3.2970 - val_accuracy50: 0.3816 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2694 - accuracy50: 0.3876 - val_loss: 3.2893 - val_accuracy50: 0.3857 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2605 - accuracy50: 0.3922 - val_loss: 3.2845 - val_accuracy50: 0.3893 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2544 - accuracy50: 0.3951 - val_loss: 3.2800 - val_accuracy50: 0.3877 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2481 - accuracy50: 0.3985 - val_loss: 3.2801 - val_accuracy50: 0.3893 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2432 - accuracy50: 0.3986 - val_loss: 3.2767 - val_accuracy50: 0.3896 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2403 - accuracy50: 0.4000 - val_loss: 3.2729 - val_accuracy50: 0.3911 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2363 - accuracy50: 0.4011 - val_loss: 3.2745 - val_accuracy50: 0.3897 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2339 - accuracy50: 0.4030 - val_loss: 3.2752 - val_accuracy50: 0.3901 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2285 - accuracy50: 0.4068 - val_loss: 3.2716 - val_accuracy50: 0.3894 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2260 - accuracy50: 0.4066 - val_loss: 3.2720 - val_accuracy50: 0.3897 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2191 - accuracy50: 0.4091 - val_loss: 3.2742 - val_accuracy50: 0.3899 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2187 - accuracy50: 0.4113 - val_loss: 3.2753 - val_accuracy50: 0.3928 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2138 - accuracy50: 0.4131 - val_loss: 3.2760 - val_accuracy50: 0.3910 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2122 - accuracy50: 0.4133 - val_loss: 3.2769 - val_accuracy50: 0.3915 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2086 - accuracy50: 0.4145 - val_loss: 3.2770 - val_accuracy50: 0.3921 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2046 - accuracy50: 0.4165 - val_loss: 3.2767 - val_accuracy50: 0.3929 - 4s/epoch - 15ms/step
Epoch 20/50
262/262 - 4s - loss: 3.2032 - accuracy50: 0.4188 - val_loss: 3.2764 - val_accuracy50: 0.3943 - 4s/epoch - 15ms/step
Epoch 21/50
262/262 - 4s - loss: 3.1998 - accuracy50: 0.4192 - val_loss: 3.2806 - val_accuracy50: 0.3905 - 4s/epoch - 15ms/step
Epoch 22/50
262/262 - 4s - loss: 3.1972 - accuracy50: 0.4198 - val_loss: 3.2837 - val_accuracy50: 0.3934 - 4s/epoch - 14ms/step
testing model: results/XRAY/W9/deepOF_L1/h50
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08381
{'0': {'precision': 0.41783555018137847, 'recall': 0.4816251626091804, 'f1-score': 0.4474683817499029, 'support': 43048}, '1': {'precision': 0.3984728222646438, 'recall': 0.09512160023024896, 'f1-score': 0.1535810405251031, 'support': 41694}, '2': {'precision': 0.39931988275803193, 'recall': 0.6221044931616164, 'f1-score': 0.48641622253997135, 'support': 45113}, 'accuracy': 0.4063301374610142, 'macro avg': {'precision': 0.40520941840135144, 'recall': 0.39961708533368195, 'f1-score': 0.3624885482716591, 'support': 129855}, 'weighted avg': {'precision': 0.40518600351602274, 'recall': 0.4063301374610142, 'f1-score': 0.36663757151183396, 'support': 129855}}
[[20733  2908 19407]
 [14918  3966 22810]
 [13969  3079 28065]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759202
{'0': {'precision': 0.4151679306608884, 'recall': 0.5074824526552775, 'f1-score': 0.4567069900482689, 'support': 22653}, '1': {'precision': 0.47263450834879406, 'recall': 0.09283046369682063, 'f1-score': 0.15518160359399988, 'support': 21954}, '2': {'precision': 0.3977077363896848, 'recall': 0.6225611123570307, 'f1-score': 0.4853571116356325, 'support': 22295}, 'accuracy': 0.4097635347224298, 'macro avg': {'precision': 0.42850339179978914, 'recall': 0.40762467623637627, 'f1-score': 0.3657485684259671, 'support': 66902}, 'weighted avg': {'precision': 0.4282070956377769, 'recall': 0.4097635347224298, 'f1-score': 0.36730855841054877, 'support': 66902}}
[[11496  1201  9956]
 [ 8852  2038 11064]
 [ 7342  1073 13880]]
Evaluating performance on  val set...
73/73 - 1s - 635ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0899026
{'0': {'precision': 0.4010762107370792, 'recall': 0.5012511729746637, 'f1-score': 0.44560305874174483, 'support': 6394}, '1': {'precision': 0.3443708609271523, 'recall': 0.061455343575890595, 'f1-score': 0.10429799426934096, 'support': 5923}, '2': {'precision': 0.3893805309734513, 'recall': 0.5902777777777778, 'f1-score': 0.46923028668214034, 'support': 6336}, 'accuracy': 0.39184045461856004, 'macro avg': {'precision': 0.3782758675458943, 'recall': 0.38432809810944396, 'f1-score': 0.33971044656440874, 'support': 18653}, 'weighted avg': {'precision': 0.3790974612647936, 'recall': 0.39184045461856004, 'f1-score': 0.34525202777408803, 'support': 18653}}
[[3205  374 2815]
 [2509  364 3050]
 [2277  319 3740]]
training model: results/XRAY/W9/deepOF_L1/h100
Epoch 1/50
262/262 - 6s - loss: 3.3382 - accuracy100: 0.3432 - val_loss: 3.3221 - val_accuracy100: 0.3515 - 6s/epoch - 22ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3064 - accuracy100: 0.3603 - val_loss: 3.3046 - val_accuracy100: 0.3598 - 4s/epoch - 15ms/step
Epoch 3/50
262/262 - 4s - loss: 3.2942 - accuracy100: 0.3660 - val_loss: 3.3031 - val_accuracy100: 0.3601 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.2830 - accuracy100: 0.3704 - val_loss: 3.2990 - val_accuracy100: 0.3628 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2773 - accuracy100: 0.3775 - val_loss: 3.3008 - val_accuracy100: 0.3661 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2729 - accuracy100: 0.3771 - val_loss: 3.2951 - val_accuracy100: 0.3658 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2671 - accuracy100: 0.3825 - val_loss: 3.2956 - val_accuracy100: 0.3664 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2624 - accuracy100: 0.3832 - val_loss: 3.2931 - val_accuracy100: 0.3698 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2588 - accuracy100: 0.3854 - val_loss: 3.2937 - val_accuracy100: 0.3659 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2553 - accuracy100: 0.3875 - val_loss: 3.2946 - val_accuracy100: 0.3689 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2526 - accuracy100: 0.3898 - val_loss: 3.2933 - val_accuracy100: 0.3673 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2493 - accuracy100: 0.3899 - val_loss: 3.2926 - val_accuracy100: 0.3725 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2444 - accuracy100: 0.3942 - val_loss: 3.2914 - val_accuracy100: 0.3701 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2422 - accuracy100: 0.3965 - val_loss: 3.2947 - val_accuracy100: 0.3693 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2419 - accuracy100: 0.3940 - val_loss: 3.2970 - val_accuracy100: 0.3703 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2356 - accuracy100: 0.3996 - val_loss: 3.2949 - val_accuracy100: 0.3713 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2336 - accuracy100: 0.3991 - val_loss: 3.2971 - val_accuracy100: 0.3696 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2316 - accuracy100: 0.4015 - val_loss: 3.2959 - val_accuracy100: 0.3697 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2262 - accuracy100: 0.4041 - val_loss: 3.3001 - val_accuracy100: 0.3698 - 4s/epoch - 15ms/step
Epoch 20/50
262/262 - 4s - loss: 3.2233 - accuracy100: 0.4048 - val_loss: 3.3047 - val_accuracy100: 0.3644 - 4s/epoch - 15ms/step
Epoch 21/50
262/262 - 4s - loss: 3.2219 - accuracy100: 0.4057 - val_loss: 3.3003 - val_accuracy100: 0.3744 - 4s/epoch - 15ms/step
Epoch 22/50
262/262 - 4s - loss: 3.2199 - accuracy100: 0.4095 - val_loss: 3.3059 - val_accuracy100: 0.3688 - 4s/epoch - 15ms/step
Epoch 23/50
262/262 - 4s - loss: 3.2161 - accuracy100: 0.4114 - val_loss: 3.3063 - val_accuracy100: 0.3682 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h100
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0923665
{'0': {'precision': 0.3931247550319323, 'recall': 0.41082787201233617, 'f1-score': 0.4017814013219128, 'support': 41504}, '1': {'precision': 0.40441889458373736, 'recall': 0.12735838768076427, 'f1-score': 0.19371319565397693, 'support': 45847}, '2': {'precision': 0.3600716228971184, 'recall': 0.6103190287972897, 'f1-score': 0.4529280301707581, 'support': 42504}, 'accuracy': 0.37604250895229296, 'macro avg': {'precision': 0.38587175750426267, 'recall': 0.3828350961634634, 'f1-score': 0.34947420904888266, 'support': 129855}, 'weighted avg': {'precision': 0.38629338225285936, 'recall': 0.37604250895229296, 'f1-score': 0.34506146976235386, 'support': 129855}}
[[17051  4285 20168]
 [14073  5839 25935]
 [12249  4314 25941]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0802139
{'0': {'precision': 0.40448108555875506, 'recall': 0.45664662658650634, 'f1-score': 0.4289838095636531, 'support': 22455}, '1': {'precision': 0.43817787418655096, 'recall': 0.127427567250935, 'f1-score': 0.1974377770796244, 'support': 22193}, '2': {'precision': 0.38641479328717554, 'recall': 0.6094185314999551, 'f1-score': 0.4729472894980035, 'support': 22254}, 'accuracy': 0.3982541628052973, 'macro avg': {'precision': 0.4096912510108272, 'recall': 0.39783090844579877, 'f1-score': 0.3664562920470937, 'support': 66902}, 'weighted avg': {'precision': 0.40964962404497285, 'recall': 0.3982541628052973, 'f1-score': 0.3667982573162014, 'support': 66902}}
[[10254  1908 10293]
 [ 8123  2828 11242]
 [ 6974  1718 13562]]
Evaluating performance on  val set...
73/73 - 1s - 567ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974665
{'0': {'precision': 0.37996973448892557, 'recall': 0.4304191990026492, 'f1-score': 0.4036241414584246, 'support': 6417}, '1': {'precision': 0.35159542444310654, 'recall': 0.09734955825970995, 'f1-score': 0.15248041775456922, 'support': 5999}, '2': {'precision': 0.3626452740923583, 'recall': 0.565335898669232, 'f1-score': 0.4418546365914786, 'support': 6237}, 'accuracy': 0.36841258778748726, 'macro avg': {'precision': 0.36473681100813016, 'recall': 0.3643682186438637, 'f1-score': 0.33265306526815747, 'support': 18653}, 'weighted avg': {'precision': 0.3650514829766616, 'recall': 0.36841258778748726, 'f1-score': 0.3356368150039899, 'support': 18653}}
[[2762  538 3117]
 [2335  584 3080]
 [2172  539 3526]]
training model: results/XRAY/W9/deepOF_L1/h200
Epoch 1/50
262/262 - 6s - loss: 3.3502 - accuracy200: 0.3400 - val_loss: 3.3631 - val_accuracy200: 0.3401 - 6s/epoch - 23ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3257 - accuracy200: 0.3497 - val_loss: 3.3540 - val_accuracy200: 0.3481 - 4s/epoch - 15ms/step
Epoch 3/50
262/262 - 4s - loss: 3.3135 - accuracy200: 0.3536 - val_loss: 3.3444 - val_accuracy200: 0.3445 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.3054 - accuracy200: 0.3551 - val_loss: 3.3298 - val_accuracy200: 0.3489 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.3004 - accuracy200: 0.3582 - val_loss: 3.3259 - val_accuracy200: 0.3482 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2933 - accuracy200: 0.3625 - val_loss: 3.3200 - val_accuracy200: 0.3524 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2881 - accuracy200: 0.3629 - val_loss: 3.3150 - val_accuracy200: 0.3527 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2838 - accuracy200: 0.3645 - val_loss: 3.3135 - val_accuracy200: 0.3529 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2808 - accuracy200: 0.3661 - val_loss: 3.3130 - val_accuracy200: 0.3497 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2768 - accuracy200: 0.3684 - val_loss: 3.3088 - val_accuracy200: 0.3552 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2750 - accuracy200: 0.3695 - val_loss: 3.3103 - val_accuracy200: 0.3577 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2712 - accuracy200: 0.3717 - val_loss: 3.3144 - val_accuracy200: 0.3512 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2705 - accuracy200: 0.3722 - val_loss: 3.3106 - val_accuracy200: 0.3530 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2642 - accuracy200: 0.3775 - val_loss: 3.3129 - val_accuracy200: 0.3535 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2617 - accuracy200: 0.3782 - val_loss: 3.3119 - val_accuracy200: 0.3557 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2614 - accuracy200: 0.3790 - val_loss: 3.3124 - val_accuracy200: 0.3533 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2587 - accuracy200: 0.3803 - val_loss: 3.3093 - val_accuracy200: 0.3551 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2546 - accuracy200: 0.3832 - val_loss: 3.3179 - val_accuracy200: 0.3524 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2532 - accuracy200: 0.3849 - val_loss: 3.3165 - val_accuracy200: 0.3515 - 4s/epoch - 15ms/step
Epoch 20/50
262/262 - 4s - loss: 3.2487 - accuracy200: 0.3878 - val_loss: 3.3166 - val_accuracy200: 0.3561 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h200
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09607
{'0': {'precision': 0.3730968841565008, 'recall': 0.45151571335867247, 'f1-score': 0.40857757038745873, 'support': 43148}, '1': {'precision': 0.42125550660792954, 'recall': 0.08857447202667655, 'f1-score': 0.14637226389101485, 'support': 43184}, '2': {'precision': 0.35530499722862396, 'recall': 0.5596810881602831, 'f1-score': 0.4346677849055594, 'support': 43523}, 'accuracy': 0.3670709637672789, 'macro avg': {'precision': 0.3832191293310181, 'recall': 0.3665904245152107, 'f1-score': 0.32987253972801095, 'support': 129855}, 'weighted avg': {'precision': 0.38314906279560224, 'recall': 0.3670709637672789, 'f1-score': 0.3301242990519604, 'support': 129855}}
[[19482  2633 21033]
 [16193  3825 23166]
 [16542  2622 24359]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918359
{'0': {'precision': 0.37480798771121354, 'recall': 0.488629789506475, 'f1-score': 0.42421666731058993, 'support': 22471}, '1': {'precision': 0.45265008791760863, 'recall': 0.08189792301049857, 'f1-score': 0.13870073891625614, 'support': 22003}, '2': {'precision': 0.3702789508118718, 'recall': 0.5551542714464063, 'f1-score': 0.44425018731937066, 'support': 22428}, 'accuracy': 0.37716361244805835, 'macro avg': {'precision': 0.3992456754802313, 'recall': 0.3752273279877933, 'f1-score': 0.33572253118207224, 'support': 66902}, 'weighted avg': {'precision': 0.39889071305967655, 'recall': 0.37716361244805835, 'f1-score': 0.3370310049132985, 'support': 66902}}
[[10980  1123 10368]
 [ 9394  1802 10807]
 [ 8921  1056 12451]]
Evaluating performance on  val set...
73/73 - 1s - 652ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103215
{'0': {'precision': 0.3673273273273273, 'recall': 0.46431825083510475, 'f1-score': 0.4101669908121521, 'support': 6586}, '1': {'precision': 0.3572961373390558, 'recall': 0.05556482562990155, 'f1-score': 0.09617328519855596, 'support': 5993}, '2': {'precision': 0.3371647509578544, 'recall': 0.5215673361870267, 'f1-score': 0.40956690368455073, 'support': 6074}, 'accuracy': 0.35163244518308046, 'macro avg': {'precision': 0.3539294052080792, 'recall': 0.34715013755067764, 'f1-score': 0.30530239323175296, 'support': 18653}, 'weighted avg': {'precision': 0.3542825404046935, 'recall': 0.35163244518308046, 'f1-score': 0.30908892256815207, 'support': 18653}}
[[3058  300 3228]
 [2660  333 3000]
 [2607  299 3168]]
training model: results/XRAY/W9/deepOF_L1/h300
Epoch 1/50
262/262 - 6s - loss: 3.3523 - accuracy300: 0.3352 - val_loss: 3.3369 - val_accuracy300: 0.3329 - 6s/epoch - 23ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3234 - accuracy300: 0.3463 - val_loss: 3.3230 - val_accuracy300: 0.3390 - 4s/epoch - 15ms/step
Epoch 3/50
262/262 - 4s - loss: 3.3111 - accuracy300: 0.3491 - val_loss: 3.3220 - val_accuracy300: 0.3360 - 4s/epoch - 15ms/step
Epoch 4/50
262/262 - 4s - loss: 3.3019 - accuracy300: 0.3514 - val_loss: 3.3151 - val_accuracy300: 0.3440 - 4s/epoch - 15ms/step
Epoch 5/50
262/262 - 4s - loss: 3.2950 - accuracy300: 0.3564 - val_loss: 3.3166 - val_accuracy300: 0.3404 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2911 - accuracy300: 0.3573 - val_loss: 3.3123 - val_accuracy300: 0.3406 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2877 - accuracy300: 0.3596 - val_loss: 3.3155 - val_accuracy300: 0.3368 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2828 - accuracy300: 0.3651 - val_loss: 3.3106 - val_accuracy300: 0.3422 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2801 - accuracy300: 0.3650 - val_loss: 3.3130 - val_accuracy300: 0.3389 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2757 - accuracy300: 0.3683 - val_loss: 3.3126 - val_accuracy300: 0.3401 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2745 - accuracy300: 0.3681 - val_loss: 3.3153 - val_accuracy300: 0.3388 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2708 - accuracy300: 0.3703 - val_loss: 3.3161 - val_accuracy300: 0.3413 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2673 - accuracy300: 0.3729 - val_loss: 3.3128 - val_accuracy300: 0.3419 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2644 - accuracy300: 0.3773 - val_loss: 3.3158 - val_accuracy300: 0.3421 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2632 - accuracy300: 0.3782 - val_loss: 3.3173 - val_accuracy300: 0.3396 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2622 - accuracy300: 0.3774 - val_loss: 3.3163 - val_accuracy300: 0.3387 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2587 - accuracy300: 0.3801 - val_loss: 3.3173 - val_accuracy300: 0.3405 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2569 - accuracy300: 0.3809 - val_loss: 3.3189 - val_accuracy300: 0.3435 - 4s/epoch - 15ms/step
testing model: results/XRAY/W9/deepOF_L1/h300
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099084
{'0': {'precision': 0.35103455574958986, 'recall': 0.32637146371463716, 'f1-score': 0.33825404109938295, 'support': 40650}, '1': {'precision': 0.36586254646162814, 'recall': 0.2170106992326813, 'f1-score': 0.2724300269987925, 'support': 46265}, '2': {'precision': 0.34542472028350796, 'recall': 0.5198183511877038, 'f1-score': 0.4150466255729413, 'support': 42940}, 'accuracy': 0.3513765353663702, 'macro avg': {'precision': 0.35410727416490867, 'recall': 0.35440017137834073, 'f1-score': 0.3419102312237056, 'support': 129855}, 'weighted avg': {'precision': 0.35446246114698615, 'recall': 0.3513765353663702, 'f1-score': 0.34019563414493975, 'support': 129855}}
[[13267  8532 18851]
 [12778 10040 23447]
 [11749  8870 22321]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911721
{'0': {'precision': 0.36869470035574203, 'recall': 0.3623812085350547, 'f1-score': 0.3655106931319799, 'support': 22308}, '1': {'precision': 0.37826282628262825, 'recall': 0.22752086623054366, 'f1-score': 0.28413668760740346, 'support': 22165}, '2': {'precision': 0.3630704082922513, 'recall': 0.5122386196442106, 'f1-score': 0.4249440571079836, 'support': 22429}, 'accuracy': 0.3679411676780963, 'macro avg': {'precision': 0.37000931164354056, 'recall': 0.3673802314699363, 'f1-score': 0.3581971459491224, 'support': 66902}, 'weighted avg': {'precision': 0.3699791203204277, 'recall': 0.3679411676780963, 'f1-score': 0.3584761663340599, 'support': 66902}}
[[ 8084  4213 10011]
 [ 6978  5043 10144]
 [ 6864  4076 11489]]
Evaluating performance on  val set...
73/73 - 1s - 560ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046679
{'0': {'precision': 0.3597934817683124, 'recall': 0.3458973165813557, 'f1-score': 0.3527085804665876, 'support': 6447}, '1': {'precision': 0.33604414754574496, 'recall': 0.18755065650834818, 'f1-score': 0.24074074074074073, 'support': 6169}, '2': {'precision': 0.3285619174434088, 'recall': 0.4904754016895809, 'f1-score': 0.39351451923715863, 'support': 6037}, 'accuracy': 0.3403205918618989, 'macro avg': {'precision': 0.3414665155858221, 'recall': 0.34130779159309493, 'f1-score': 0.32898794681482896, 'support': 18653}, 'weighted avg': {'precision': 0.34183097725705625, 'recall': 0.3403205918618989, 'f1-score': 0.32888484428952164, 'support': 18653}}
[[2230 1195 3022]
 [1983 1157 3029]
 [1985 1091 2961]]
training model: results/XRAY/W9/deepOF_L1/h500
Epoch 1/50
262/262 - 6s - loss: 3.3552 - accuracy500: 0.3310 - val_loss: 3.3491 - val_accuracy500: 0.3264 - 6s/epoch - 23ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3282 - accuracy500: 0.3395 - val_loss: 3.3370 - val_accuracy500: 0.3270 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.3160 - accuracy500: 0.3433 - val_loss: 3.3298 - val_accuracy500: 0.3266 - 4s/epoch - 16ms/step
Epoch 4/50
262/262 - 4s - loss: 3.3059 - accuracy500: 0.3476 - val_loss: 3.3232 - val_accuracy500: 0.3319 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.3006 - accuracy500: 0.3486 - val_loss: 3.3242 - val_accuracy500: 0.3308 - 4s/epoch - 15ms/step
Epoch 6/50
262/262 - 4s - loss: 3.2962 - accuracy500: 0.3520 - val_loss: 3.3213 - val_accuracy500: 0.3270 - 4s/epoch - 15ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2921 - accuracy500: 0.3561 - val_loss: 3.3244 - val_accuracy500: 0.3274 - 4s/epoch - 15ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2882 - accuracy500: 0.3576 - val_loss: 3.3183 - val_accuracy500: 0.3298 - 4s/epoch - 15ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2854 - accuracy500: 0.3628 - val_loss: 3.3174 - val_accuracy500: 0.3300 - 4s/epoch - 15ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2836 - accuracy500: 0.3620 - val_loss: 3.3200 - val_accuracy500: 0.3310 - 4s/epoch - 15ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2807 - accuracy500: 0.3641 - val_loss: 3.3212 - val_accuracy500: 0.3294 - 4s/epoch - 15ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2793 - accuracy500: 0.3656 - val_loss: 3.3205 - val_accuracy500: 0.3284 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2773 - accuracy500: 0.3652 - val_loss: 3.3209 - val_accuracy500: 0.3338 - 4s/epoch - 15ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2725 - accuracy500: 0.3713 - val_loss: 3.3218 - val_accuracy500: 0.3295 - 4s/epoch - 15ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2728 - accuracy500: 0.3725 - val_loss: 3.3208 - val_accuracy500: 0.3323 - 4s/epoch - 15ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2706 - accuracy500: 0.3737 - val_loss: 3.3213 - val_accuracy500: 0.3348 - 4s/epoch - 16ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2686 - accuracy500: 0.3748 - val_loss: 3.3241 - val_accuracy500: 0.3328 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2637 - accuracy500: 0.3759 - val_loss: 3.3249 - val_accuracy500: 0.3324 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2639 - accuracy500: 0.3771 - val_loss: 3.3239 - val_accuracy500: 0.3322 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepOF_L1/h500
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026793
{'0': {'precision': 0.35508059089306887, 'recall': 0.26938785432975154, 'f1-score': 0.3063546260073817, 'support': 41134}, '1': {'precision': 0.3299900605403452, 'recall': 0.08272175409984597, 'f1-score': 0.13228289414108488, 'support': 44148}, '2': {'precision': 0.3524737100512668, 'recall': 0.6925717362528885, 'f1-score': 0.4671822267960107, 'support': 44573}, 'accuracy': 0.35118401293750723, 'macro avg': {'precision': 0.3458481204948936, 'recall': 0.34822711489416197, 'f1-score': 0.3019399156481591, 'support': 129855}, 'weighted avg': {'precision': 0.3456555149716666, 'recall': 0.35118401293750723, 'f1-score': 0.30237826646418575, 'support': 129855}}
[[11081  3755 26298]
 [10083  3652 30413]
 [10043  3660 30870]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934204
{'0': {'precision': 0.37970966312056736, 'recall': 0.30312278839348905, 'f1-score': 0.3371212121212121, 'support': 22608}, '1': {'precision': 0.4153381439838899, 'recall': 0.11172806067172264, 'f1-score': 0.1760876525203657, 'support': 22152}, '2': {'precision': 0.3540972141275207, 'recall': 0.6859813928281094, 'f1-score': 0.4670879653120532, 'support': 22142}, 'accuracy': 0.3664613912887507, 'macro avg': {'precision': 0.3830483404106593, 'recall': 0.36694408063110706, 'f1-score': 0.3267656099845437, 'support': 66902}, 'weighted avg': {'precision': 0.38302991158070726, 'recall': 0.3664613912887507, 'f1-score': 0.32681521883063264, 'support': 66902}}
[[ 6853  1863 13892]
 [ 5863  2475 13814]
 [ 5332  1621 15189]]
Evaluating performance on  val set...
73/73 - 1s - 572ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078404
{'0': {'precision': 0.3490180828310325, 'recall': 0.28406393416679854, 'f1-score': 0.3132088640725877, 'support': 6319}, '1': {'precision': 0.35997313633310946, 'recall': 0.08440944881889764, 'f1-score': 0.13675213675213674, 'support': 6350}, '2': {'precision': 0.3185259129856085, 'recall': 0.6398729946524064, 'f1-score': 0.42532629825048596, 'support': 5984}, 'accuracy': 0.3302417841634053, 'macro avg': {'precision': 0.3425057107165834, 'recall': 0.33611545921270086, 'f1-score': 0.29176243302507016, 'support': 18653}, 'weighted avg': {'precision': 0.3429654074106268, 'recall': 0.3302417841634053, 'f1-score': 0.28910606600448496, 'support': 18653}}
[[1795  462 4062]
 [1684  536 4130]
 [1664  491 3829]]
training model: results/XRAY/W9/deepOF_L1/h1000
Epoch 1/50
262/262 - 6s - loss: 3.3604 - accuracy1000: 0.3336 - val_loss: 3.3499 - val_accuracy1000: 0.3323 - 6s/epoch - 23ms/step
Epoch 2/50
262/262 - 4s - loss: 3.3346 - accuracy1000: 0.3384 - val_loss: 3.3368 - val_accuracy1000: 0.3359 - 4s/epoch - 17ms/step
Epoch 3/50
262/262 - 4s - loss: 3.3236 - accuracy1000: 0.3402 - val_loss: 3.3275 - val_accuracy1000: 0.3362 - 4s/epoch - 16ms/step
Epoch 4/50
262/262 - 4s - loss: 3.3129 - accuracy1000: 0.3441 - val_loss: 3.3209 - val_accuracy1000: 0.3331 - 4s/epoch - 16ms/step
Epoch 5/50
262/262 - 4s - loss: 3.3081 - accuracy1000: 0.3454 - val_loss: 3.3164 - val_accuracy1000: 0.3335 - 4s/epoch - 16ms/step
Epoch 6/50
262/262 - 4s - loss: 3.3021 - accuracy1000: 0.3476 - val_loss: 3.3174 - val_accuracy1000: 0.3398 - 4s/epoch - 16ms/step
Epoch 7/50
262/262 - 4s - loss: 3.2981 - accuracy1000: 0.3508 - val_loss: 3.3166 - val_accuracy1000: 0.3387 - 4s/epoch - 16ms/step
Epoch 8/50
262/262 - 4s - loss: 3.2945 - accuracy1000: 0.3524 - val_loss: 3.3150 - val_accuracy1000: 0.3335 - 4s/epoch - 16ms/step
Epoch 9/50
262/262 - 4s - loss: 3.2926 - accuracy1000: 0.3520 - val_loss: 3.3130 - val_accuracy1000: 0.3361 - 4s/epoch - 16ms/step
Epoch 10/50
262/262 - 4s - loss: 3.2898 - accuracy1000: 0.3556 - val_loss: 3.3137 - val_accuracy1000: 0.3366 - 4s/epoch - 16ms/step
Epoch 11/50
262/262 - 4s - loss: 3.2860 - accuracy1000: 0.3603 - val_loss: 3.3147 - val_accuracy1000: 0.3322 - 4s/epoch - 16ms/step
Epoch 12/50
262/262 - 4s - loss: 3.2841 - accuracy1000: 0.3595 - val_loss: 3.3141 - val_accuracy1000: 0.3361 - 4s/epoch - 15ms/step
Epoch 13/50
262/262 - 4s - loss: 3.2829 - accuracy1000: 0.3609 - val_loss: 3.3146 - val_accuracy1000: 0.3392 - 4s/epoch - 16ms/step
Epoch 14/50
262/262 - 4s - loss: 3.2787 - accuracy1000: 0.3654 - val_loss: 3.3140 - val_accuracy1000: 0.3369 - 4s/epoch - 16ms/step
Epoch 15/50
262/262 - 4s - loss: 3.2785 - accuracy1000: 0.3660 - val_loss: 3.3159 - val_accuracy1000: 0.3360 - 4s/epoch - 16ms/step
Epoch 16/50
262/262 - 4s - loss: 3.2762 - accuracy1000: 0.3659 - val_loss: 3.3152 - val_accuracy1000: 0.3331 - 4s/epoch - 15ms/step
Epoch 17/50
262/262 - 4s - loss: 3.2734 - accuracy1000: 0.3719 - val_loss: 3.3169 - val_accuracy1000: 0.3352 - 4s/epoch - 15ms/step
Epoch 18/50
262/262 - 4s - loss: 3.2713 - accuracy1000: 0.3722 - val_loss: 3.3161 - val_accuracy1000: 0.3386 - 4s/epoch - 15ms/step
Epoch 19/50
262/262 - 4s - loss: 3.2701 - accuracy1000: 0.3718 - val_loss: 3.3178 - val_accuracy1000: 0.3359 - 4s/epoch - 16ms/step
testing model: results/XRAY/W9/deepOF_L1/h1000
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947733
{'0': {'precision': 0.35371697553114795, 'recall': 0.19953590737285298, 'f1-score': 0.2551427741155958, 'support': 41802}, '1': {'precision': 0.3217884130982368, 'recall': 0.10414225301880063, 'f1-score': 0.157357865968667, 'support': 39254}, '2': {'precision': 0.3837875387410495, 'recall': 0.7358962273817087, 'f1-score': 0.5044778006448034, 'support': 48799}, 'accuracy': 0.37226136844942437, 'macro avg': {'precision': 0.35309764245681136, 'recall': 0.3465247959244541, 'f1-score': 0.3056594802430221, 'support': 129855}, 'weighted avg': {'precision': 0.3553656577100282, 'recall': 0.37226136844942437, 'f1-score': 0.31928240043109585, 'support': 129855}}
[[ 8341  4140 29321]
 [ 6828  4088 28338]
 [ 8412  4476 35911]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944089
{'0': {'precision': 0.390738264480259, 'recall': 0.2373562481296225, 'f1-score': 0.29531914893617023, 'support': 23391}, '1': {'precision': 0.39629032258064517, 'recall': 0.11533586818757921, 'f1-score': 0.17867141766352762, 'support': 21303}, '2': {'precision': 0.34957950659239023, 'recall': 0.731853386167147, 'f1-score': 0.4731517736277492, 'support': 22208}, 'accuracy': 0.36264984604346656, 'macro avg': {'precision': 0.3788693645510981, 'recall': 0.3615151674947829, 'f1-score': 0.315714113409149, 'support': 66902}, 'weighted avg': {'precision': 0.3788435796956298, 'recall': 0.36264984604346656, 'f1-score': 0.31720728845142354, 'support': 66902}}
[[ 5552  2045 15794]
 [ 4400  2457 14446]
 [ 4257  1698 16253]]
Evaluating performance on  val set...
73/73 - 1s - 556ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050098
{'0': {'precision': 0.3538899430740038, 'recall': 0.2296091104955371, 'f1-score': 0.2785140937091656, 'support': 6498}, '1': {'precision': 0.3397040690505549, 'recall': 0.09293304098498904, 'f1-score': 0.14594093497549993, 'support': 5929}, '2': {'precision': 0.32703862660944205, 'recall': 0.6731448763250883, 'f1-score': 0.440207972270364, 'support': 6226}, 'accuracy': 0.334208974427706, 'macro avg': {'precision': 0.3402108795780003, 'recall': 0.3318956759352048, 'f1-score': 0.2882210003183432, 'support': 18653}, 'weighted avg': {'precision': 0.34041841874047085, 'recall': 0.334208974427706, 'f1-score': 0.29034488928039365, 'support': 18653}}
[[1492  508 4498]
 [1252  551 4126]
 [1472  563 4191]]
training model: results/XRAY/W9/deepLOB_L2/h10
Epoch 1/50
262/262 - 14s - loss: 3.3183 - accuracy10: 0.3650 - val_loss: 3.4540 - val_accuracy10: 0.3263 - 14s/epoch - 52ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2479 - accuracy10: 0.3938 - val_loss: 3.8371 - val_accuracy10: 0.2944 - 11s/epoch - 42ms/step
Epoch 3/50
262/262 - 11s - loss: 3.1762 - accuracy10: 0.4274 - val_loss: 3.6028 - val_accuracy10: 0.3299 - 11s/epoch - 41ms/step
Epoch 4/50
262/262 - 11s - loss: 3.1330 - accuracy10: 0.4490 - val_loss: 3.6432 - val_accuracy10: 0.3414 - 11s/epoch - 41ms/step
Epoch 5/50
262/262 - 11s - loss: 3.0900 - accuracy10: 0.4650 - val_loss: 3.6470 - val_accuracy10: 0.3525 - 11s/epoch - 41ms/step
Epoch 6/50
262/262 - 11s - loss: 3.0684 - accuracy10: 0.4722 - val_loss: 3.8928 - val_accuracy10: 0.3287 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.0449 - accuracy10: 0.4807 - val_loss: 3.7912 - val_accuracy10: 0.3376 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.0301 - accuracy10: 0.4838 - val_loss: 3.7991 - val_accuracy10: 0.3482 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.0148 - accuracy10: 0.4881 - val_loss: 3.7715 - val_accuracy10: 0.3574 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.0094 - accuracy10: 0.4908 - val_loss: 3.7221 - val_accuracy10: 0.3665 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 2.9930 - accuracy10: 0.4957 - val_loss: 3.8650 - val_accuracy10: 0.3509 - 11s/epoch - 41ms/step
testing model: results/XRAY/W9/deepLOB_L2/h10
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1197344
{'0': {'precision': 0.31202802292785004, 'recall': 0.3596088814323538, 'f1-score': 0.33413306377951796, 'support': 38147}, '1': {'precision': 0.40779138624822087, 'recall': 0.44327081025327575, 'f1-score': 0.42479155798394697, 'support': 52354}, '2': {'precision': 0.29307251776719795, 'recall': 0.21583921947253418, 'f1-score': 0.24859534121502982, 'support': 39358}, 'accuracy': 0.34976397477263804, 'macro avg': {'precision': 0.3376306423144229, 'recall': 0.3395729703860546, 'f1-score': 0.33583998765949824, 'support': 129859}, 'weighted avg': {'precision': 0.3448909307829987, 'recall': 0.34976397477263804, 'f1-score': 0.34475798096573956, 'support': 129859}}
[[13718 16677  7752]
 [16408 23207 12739]
 [13838 17025  8495]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1278341
{'0': {'precision': 0.35378775897517, 'recall': 0.20078086433604092, 'f1-score': 0.2561768158263907, 'support': 22283}, '1': {'precision': 0.3709280236403293, 'recall': 0.6885802603509077, 'f1-score': 0.4821363248384343, 'support': 22969}, '2': {'precision': 0.349057415856073, 'recall': 0.18729792147806004, 'f1-score': 0.2437851324135029, 'support': 21650}, 'accuracy': 0.3638904666527159, 'macro avg': {'precision': 0.35792439949052407, 'recall': 0.3588863487216696, 'f1-score': 0.3273660910261093, 'support': 66902}, 'weighted avg': {'precision': 0.3581416319620104, 'recall': 0.3638904666527159, 'f1-score': 0.32974388432372426, 'support': 66902}}
[[ 4474 13614  4195]
 [ 3786 15816  3367]
 [ 4386 13209  4055]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1475365
{'0': {'precision': 0.36637931034482757, 'recall': 0.16209476309226933, 'f1-score': 0.22475338147055832, 'support': 6817}, '1': {'precision': 0.2884519661523146, 'recall': 0.6821659799882284, 'f1-score': 0.40545740773132766, 'support': 5097}, '2': {'precision': 0.3828125, 'recall': 0.20356083086053411, 'f1-score': 0.26578845408756296, 'support': 6740}, 'accuracy': 0.31918087273507023, 'macro avg': {'precision': 0.34588125883238074, 'recall': 0.349273857980344, 'f1-score': 0.29866641442981634, 'support': 18654}, 'weighted avg': {'precision': 0.35102410636319487, 'recall': 0.31918087273507023, 'f1-score': 0.28895541917237844, 'support': 18654}}
[[1105 4279 1433]
 [ 841 3477  779]
 [1070 4298 1372]]
training model: results/XRAY/W9/deepLOB_L2/h20
Epoch 1/50
262/262 - 13s - loss: 3.3250 - accuracy20: 0.3624 - val_loss: 3.5402 - val_accuracy20: 0.3052 - 13s/epoch - 50ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2538 - accuracy20: 0.3921 - val_loss: 3.7383 - val_accuracy20: 0.2837 - 11s/epoch - 42ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2059 - accuracy20: 0.4145 - val_loss: 3.6915 - val_accuracy20: 0.3019 - 11s/epoch - 41ms/step
Epoch 4/50
262/262 - 11s - loss: 3.1587 - accuracy20: 0.4378 - val_loss: 3.6589 - val_accuracy20: 0.3065 - 11s/epoch - 42ms/step
Epoch 5/50
262/262 - 11s - loss: 3.1345 - accuracy20: 0.4472 - val_loss: 3.6119 - val_accuracy20: 0.3199 - 11s/epoch - 42ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1148 - accuracy20: 0.4572 - val_loss: 3.5530 - val_accuracy20: 0.3365 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.0964 - accuracy20: 0.4634 - val_loss: 3.5539 - val_accuracy20: 0.3287 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.0807 - accuracy20: 0.4710 - val_loss: 3.5522 - val_accuracy20: 0.3329 - 11s/epoch - 42ms/step
Epoch 9/50
262/262 - 11s - loss: 3.0714 - accuracy20: 0.4714 - val_loss: 3.4902 - val_accuracy20: 0.3492 - 11s/epoch - 42ms/step
Epoch 10/50
262/262 - 11s - loss: 3.0572 - accuracy20: 0.4774 - val_loss: 3.4629 - val_accuracy20: 0.3591 - 11s/epoch - 42ms/step
Epoch 11/50
262/262 - 11s - loss: 3.0448 - accuracy20: 0.4827 - val_loss: 3.4538 - val_accuracy20: 0.3492 - 11s/epoch - 42ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0380 - accuracy20: 0.4846 - val_loss: 3.4182 - val_accuracy20: 0.3620 - 11s/epoch - 42ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0292 - accuracy20: 0.4865 - val_loss: 3.4995 - val_accuracy20: 0.3502 - 11s/epoch - 41ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0193 - accuracy20: 0.4894 - val_loss: 3.5289 - val_accuracy20: 0.3541 - 11s/epoch - 42ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0118 - accuracy20: 0.4920 - val_loss: 3.5362 - val_accuracy20: 0.3519 - 11s/epoch - 42ms/step
Epoch 16/50
262/262 - 11s - loss: 2.9997 - accuracy20: 0.4959 - val_loss: 3.4140 - val_accuracy20: 0.3684 - 11s/epoch - 41ms/step
Epoch 17/50
262/262 - 11s - loss: 2.9930 - accuracy20: 0.4963 - val_loss: 3.5234 - val_accuracy20: 0.3484 - 11s/epoch - 42ms/step
Epoch 18/50
262/262 - 11s - loss: 2.9877 - accuracy20: 0.5002 - val_loss: 3.5092 - val_accuracy20: 0.3607 - 11s/epoch - 41ms/step
Epoch 19/50
262/262 - 11s - loss: 2.9711 - accuracy20: 0.5033 - val_loss: 3.5254 - val_accuracy20: 0.3596 - 11s/epoch - 41ms/step
Epoch 20/50
262/262 - 11s - loss: 2.9667 - accuracy20: 0.5037 - val_loss: 3.5601 - val_accuracy20: 0.3730 - 11s/epoch - 42ms/step
Epoch 21/50
262/262 - 11s - loss: 2.9525 - accuracy20: 0.5083 - val_loss: 3.6020 - val_accuracy20: 0.3564 - 11s/epoch - 43ms/step
Epoch 22/50
262/262 - 11s - loss: 2.9412 - accuracy20: 0.5119 - val_loss: 3.6141 - val_accuracy20: 0.3642 - 11s/epoch - 42ms/step
Epoch 23/50
262/262 - 11s - loss: 2.9271 - accuracy20: 0.5160 - val_loss: 3.4740 - val_accuracy20: 0.3846 - 11s/epoch - 43ms/step
Epoch 24/50
262/262 - 11s - loss: 2.9152 - accuracy20: 0.5196 - val_loss: 3.4553 - val_accuracy20: 0.3844 - 11s/epoch - 43ms/step
Epoch 25/50
262/262 - 11s - loss: 2.9069 - accuracy20: 0.5223 - val_loss: 3.3865 - val_accuracy20: 0.3974 - 11s/epoch - 43ms/step
Epoch 26/50
262/262 - 11s - loss: 2.8945 - accuracy20: 0.5265 - val_loss: 3.4302 - val_accuracy20: 0.3939 - 11s/epoch - 42ms/step
Epoch 27/50
262/262 - 11s - loss: 2.8854 - accuracy20: 0.5265 - val_loss: 3.4600 - val_accuracy20: 0.3900 - 11s/epoch - 42ms/step
Epoch 28/50
262/262 - 11s - loss: 2.8789 - accuracy20: 0.5300 - val_loss: 3.4166 - val_accuracy20: 0.4006 - 11s/epoch - 42ms/step
Epoch 29/50
262/262 - 11s - loss: 2.8647 - accuracy20: 0.5335 - val_loss: 3.3203 - val_accuracy20: 0.4195 - 11s/epoch - 42ms/step
Epoch 30/50
262/262 - 11s - loss: 2.8510 - accuracy20: 0.5360 - val_loss: 3.3448 - val_accuracy20: 0.4126 - 11s/epoch - 41ms/step
Epoch 31/50
262/262 - 11s - loss: 2.8378 - accuracy20: 0.5403 - val_loss: 3.3833 - val_accuracy20: 0.4006 - 11s/epoch - 41ms/step
Epoch 32/50
262/262 - 11s - loss: 2.8328 - accuracy20: 0.5415 - val_loss: 3.3831 - val_accuracy20: 0.4072 - 11s/epoch - 41ms/step
Epoch 33/50
262/262 - 11s - loss: 2.8207 - accuracy20: 0.5470 - val_loss: 3.4064 - val_accuracy20: 0.4129 - 11s/epoch - 41ms/step
Epoch 34/50
262/262 - 11s - loss: 2.8083 - accuracy20: 0.5494 - val_loss: 3.4991 - val_accuracy20: 0.3903 - 11s/epoch - 41ms/step
Epoch 35/50
262/262 - 11s - loss: 2.8018 - accuracy20: 0.5488 - val_loss: 3.5222 - val_accuracy20: 0.3964 - 11s/epoch - 41ms/step
Epoch 36/50
262/262 - 11s - loss: 2.7866 - accuracy20: 0.5525 - val_loss: 3.5613 - val_accuracy20: 0.3899 - 11s/epoch - 41ms/step
Epoch 37/50
262/262 - 11s - loss: 2.7765 - accuracy20: 0.5561 - val_loss: 3.6221 - val_accuracy20: 0.3917 - 11s/epoch - 41ms/step
Epoch 38/50
262/262 - 11s - loss: 2.7687 - accuracy20: 0.5585 - val_loss: 3.5636 - val_accuracy20: 0.3898 - 11s/epoch - 41ms/step
Epoch 39/50
262/262 - 11s - loss: 2.7541 - accuracy20: 0.5611 - val_loss: 3.5729 - val_accuracy20: 0.3907 - 11s/epoch - 42ms/step
testing model: results/XRAY/W9/deepLOB_L2/h20
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796998
{'0': {'precision': 0.40142125967598663, 'recall': 0.48026315789473684, 'f1-score': 0.43731711250892835, 'support': 39520}, '1': {'precision': 0.4987878530112283, 'recall': 0.4689686887671452, 'f1-score': 0.4834188668356726, 'support': 50014}, '2': {'precision': 0.3985598964925604, 'recall': 0.3513949163050217, 'f1-score': 0.37349429347109836, 'support': 40325}, 'accuracy': 0.43589585627488275, 'macro avg': {'precision': 0.4329230030599251, 'recall': 0.43354225432230126, 'f1-score': 0.43141009093856647, 'support': 129859}, 'weighted avg': {'precision': 0.43803257139636886, 'recall': 0.43589585627488275, 'f1-score': 0.4352539360113216, 'support': 129859}}
[[18980 11497  9043]
 [14219 23455 12340]
 [14083 12072 14170]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716057
{'0': {'precision': 0.4330667267470241, 'recall': 0.5051243868255081, 'f1-score': 0.4663283666579059, 'support': 22832}, '1': {'precision': 0.42599525017107437, 'recall': 0.48765090775043773, 'f1-score': 0.4547427220968955, 'support': 21702}, '2': {'precision': 0.4799066632097485, 'recall': 0.3310085836909871, 'f1-score': 0.3917874907397608, 'support': 22368}, 'accuracy': 0.4412424142776001, 'macro avg': {'precision': 0.4463228800426157, 'recall': 0.4412612927556443, 'f1-score': 0.4376195264981874, 'support': 66902}, 'weighted avg': {'precision': 0.44643330045404267, 'recall': 0.4412424142776001, 'f1-score': 0.43764817816129714, 'support': 66902}}
[[11533  6990  4309]
 [ 7404 10583  3715]
 [ 7694  7270  7404]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1107426
{'0': {'precision': 0.42745486569793045, 'recall': 0.5764548693586699, 'f1-score': 0.4908975979772441, 'support': 6736}, '1': {'precision': 0.34818420067390493, 'recall': 0.36606967132454243, 'f1-score': 0.35690300297419175, 'support': 5081}, '2': {'precision': 0.4796594134342479, 'recall': 0.2966213251426064, 'f1-score': 0.3665612291007682, 'support': 6837}, 'accuracy': 0.416586254958722, 'macro avg': {'precision': 0.4184328266020277, 'recall': 0.4130486219419396, 'f1-score': 0.40478727668406805, 'support': 18654}, 'weighted avg': {'precision': 0.4249968536836777, 'recall': 0.416586254958722, 'f1-score': 0.4088286427280228, 'support': 18654}}
[[3883 1649 1204]
 [2225 1860  996]
 [2976 1833 2028]]
training model: results/XRAY/W9/deepLOB_L2/h30
Epoch 1/50
262/262 - 13s - loss: 3.3368 - accuracy30: 0.3550 - val_loss: 3.4364 - val_accuracy30: 0.3348 - 13s/epoch - 51ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2813 - accuracy30: 0.3792 - val_loss: 3.4830 - val_accuracy30: 0.3187 - 11s/epoch - 43ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2403 - accuracy30: 0.3989 - val_loss: 3.4374 - val_accuracy30: 0.3487 - 11s/epoch - 43ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2023 - accuracy30: 0.4215 - val_loss: 3.3760 - val_accuracy30: 0.3664 - 11s/epoch - 43ms/step
Epoch 5/50
262/262 - 11s - loss: 3.1753 - accuracy30: 0.4342 - val_loss: 3.3139 - val_accuracy30: 0.3867 - 11s/epoch - 43ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1576 - accuracy30: 0.4394 - val_loss: 3.3849 - val_accuracy30: 0.3785 - 11s/epoch - 43ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1364 - accuracy30: 0.4494 - val_loss: 3.3316 - val_accuracy30: 0.3859 - 11s/epoch - 42ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1256 - accuracy30: 0.4542 - val_loss: 3.3030 - val_accuracy30: 0.3951 - 11s/epoch - 43ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1186 - accuracy30: 0.4542 - val_loss: 3.3387 - val_accuracy30: 0.3954 - 11s/epoch - 43ms/step
Epoch 10/50
262/262 - 11s - loss: 3.1099 - accuracy30: 0.4565 - val_loss: 3.3411 - val_accuracy30: 0.3961 - 11s/epoch - 42ms/step
Epoch 11/50
262/262 - 11s - loss: 3.1002 - accuracy30: 0.4629 - val_loss: 3.3251 - val_accuracy30: 0.3985 - 11s/epoch - 43ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0892 - accuracy30: 0.4654 - val_loss: 3.3528 - val_accuracy30: 0.3989 - 11s/epoch - 43ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0791 - accuracy30: 0.4679 - val_loss: 3.3766 - val_accuracy30: 0.3955 - 11s/epoch - 42ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0707 - accuracy30: 0.4718 - val_loss: 3.3649 - val_accuracy30: 0.3956 - 11s/epoch - 43ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0623 - accuracy30: 0.4758 - val_loss: 3.3946 - val_accuracy30: 0.3864 - 11s/epoch - 43ms/step
Epoch 16/50
262/262 - 11s - loss: 3.0543 - accuracy30: 0.4768 - val_loss: 3.3608 - val_accuracy30: 0.3969 - 11s/epoch - 43ms/step
Epoch 17/50
262/262 - 11s - loss: 3.0419 - accuracy30: 0.4812 - val_loss: 3.3826 - val_accuracy30: 0.3907 - 11s/epoch - 42ms/step
Epoch 18/50
262/262 - 11s - loss: 3.0330 - accuracy30: 0.4843 - val_loss: 3.3665 - val_accuracy30: 0.3997 - 11s/epoch - 43ms/step
testing model: results/XRAY/W9/deepLOB_L2/h30
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0649188
{'0': {'precision': 0.40860057882889467, 'recall': 0.3511191498982591, 'f1-score': 0.377685302780555, 'support': 39807}, '1': {'precision': 0.4484394691971236, 'recall': 0.6132524990368824, 'f1-score': 0.5180535096433833, 'support': 49319}, '2': {'precision': 0.41904491792817383, 'recall': 0.2901824073846758, 'f1-score': 0.3429068755439513, 'support': 40733}, 'accuracy': 0.43156038472497094, 'macro avg': {'precision': 0.4253616553180641, 'recall': 0.41818468543993914, 'f1-score': 0.41288189598929653, 'support': 129859}, 'weighted avg': {'precision': 0.42700703120109545, 'recall': 0.43156038472497094, 'f1-score': 0.42008659893745787, 'support': 129859}}
[[13977 18888  6942]
 [ 9629 30245  9445]
 [10601 18312 11820]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0922459
{'0': {'precision': 0.41271370093908016, 'recall': 0.3808550351079904, 'f1-score': 0.3961448679131902, 'support': 22502}, '1': {'precision': 0.3913565777907999, 'recall': 0.5982174847724829, 'f1-score': 0.47316589323036595, 'support': 22328}, '2': {'precision': 0.4573165653368868, 'recall': 0.24877673069952883, 'f1-score': 0.32225123976642506, 'support': 22072}, 'accuracy': 0.4098233236674539, 'macro avg': {'precision': 0.420462281355589, 'recall': 0.40928308352666737, 'f1-score': 0.3971873336366604, 'support': 66902}, 'weighted avg': {'precision': 0.4203011060590106, 'recall': 0.4098233236674539, 'f1-score': 0.39747136477167727, 'support': 66902}}
[[ 8570 10652  3280]
 [ 5735 13357  3236]
 [ 6460 10121  5491]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1015468
{'0': {'precision': 0.4172480332492207, 'recall': 0.4308045977011494, 'f1-score': 0.4239179610918413, 'support': 6525}, '1': {'precision': 0.34501845018450183, 'recall': 0.5065005417118094, 'f1-score': 0.41044776119402987, 'support': 5538}, '2': {'precision': 0.46263533139688406, 'recall': 0.2658170232134729, 'f1-score': 0.3376373096935826, 'support': 6591}, 'accuracy': 0.39498230942425216, 'macro avg': {'precision': 0.40830060494353554, 'recall': 0.4010407208754772, 'f1-score': 0.39066767732648455, 'support': 18654}, 'weighted avg': {'precision': 0.411841163466806, 'recall': 0.39498230942425216, 'f1-score': 0.3894334676641581, 'support': 18654}}
[[2811 2694 1020]
 [1718 2805 1015]
 [2208 2631 1752]]
training model: results/XRAY/W9/deepLOB_L2/h50
Epoch 1/50
262/262 - 13s - loss: 3.3141 - accuracy50: 0.3694 - val_loss: 3.4372 - val_accuracy50: 0.3445 - 13s/epoch - 50ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2646 - accuracy50: 0.3869 - val_loss: 3.4144 - val_accuracy50: 0.3521 - 11s/epoch - 43ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2286 - accuracy50: 0.4042 - val_loss: 3.3389 - val_accuracy50: 0.3624 - 11s/epoch - 43ms/step
Epoch 4/50
262/262 - 11s - loss: 3.1966 - accuracy50: 0.4161 - val_loss: 3.3475 - val_accuracy50: 0.3704 - 11s/epoch - 43ms/step
Epoch 5/50
262/262 - 11s - loss: 3.1836 - accuracy50: 0.4253 - val_loss: 3.3367 - val_accuracy50: 0.3728 - 11s/epoch - 43ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1615 - accuracy50: 0.4327 - val_loss: 3.3288 - val_accuracy50: 0.3745 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1454 - accuracy50: 0.4413 - val_loss: 3.3597 - val_accuracy50: 0.3684 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1288 - accuracy50: 0.4471 - val_loss: 3.3047 - val_accuracy50: 0.3804 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1187 - accuracy50: 0.4546 - val_loss: 3.3112 - val_accuracy50: 0.3748 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.1077 - accuracy50: 0.4566 - val_loss: 3.3276 - val_accuracy50: 0.3712 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 3.0952 - accuracy50: 0.4614 - val_loss: 3.3686 - val_accuracy50: 0.3767 - 11s/epoch - 42ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0822 - accuracy50: 0.4672 - val_loss: 3.3950 - val_accuracy50: 0.3685 - 11s/epoch - 43ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0735 - accuracy50: 0.4721 - val_loss: 3.3666 - val_accuracy50: 0.3675 - 11s/epoch - 42ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0648 - accuracy50: 0.4736 - val_loss: 3.3796 - val_accuracy50: 0.3659 - 11s/epoch - 42ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0540 - accuracy50: 0.4774 - val_loss: 3.3448 - val_accuracy50: 0.3779 - 11s/epoch - 42ms/step
Epoch 16/50
262/262 - 11s - loss: 3.0388 - accuracy50: 0.4865 - val_loss: 3.3880 - val_accuracy50: 0.3713 - 11s/epoch - 42ms/step
Epoch 17/50
262/262 - 11s - loss: 3.0308 - accuracy50: 0.4876 - val_loss: 3.3656 - val_accuracy50: 0.3719 - 11s/epoch - 41ms/step
Epoch 18/50
262/262 - 11s - loss: 3.0196 - accuracy50: 0.4910 - val_loss: 3.3512 - val_accuracy50: 0.3808 - 11s/epoch - 42ms/step
testing model: results/XRAY/W9/deepLOB_L2/h50
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.089613
{'0': {'precision': 0.3965046153846154, 'recall': 0.3741608789575155, 'f1-score': 0.38500884363497295, 'support': 43051}, '1': {'precision': 0.37605704223821224, 'recall': 0.4149038230920516, 'f1-score': 0.3945264838360226, 'support': 41694}, '2': {'precision': 0.38831448199292207, 'recall': 0.37212395265327836, 'f1-score': 0.3800468606743862, 'support': 45114}, 'accuracy': 0.3865346260174497, 'macro avg': {'precision': 0.3869587132052499, 'recall': 0.3870628849009485, 'f1-score': 0.3865273960484606, 'support': 129859}, 'weighted avg': {'precision': 0.38709417180658856, 'recall': 0.3865346260174497, 'f1-score': 0.3863408544409907, 'support': 129859}}
[[16108 14288 12655]
 [10605 17299 13790]
 [13912 14414 16788]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0858065
{'0': {'precision': 0.40358044526050035, 'recall': 0.38702293436633356, 'f1-score': 0.3951283088400521, 'support': 22717}, '1': {'precision': 0.4129764155637377, 'recall': 0.5680781164446067, 'f1-score': 0.4782667153256632, 'support': 21916}, '2': {'precision': 0.41997327989311956, 'recall': 0.2823207148951457, 'f1-score': 0.3376567577002605, 'support': 22269}, 'accuracy': 0.4114824668918717, 'macro avg': {'precision': 0.41217671357245256, 'recall': 0.41247392190202864, 'f1-score': 0.4036839272886586, 'support': 66902}, 'weighted avg': {'precision': 0.4121149303222257, 'recall': 0.4114824668918717, 'f1-score': 0.4032331090583809, 'support': 66902}}
[[ 8792  9008  4917]
 [ 5700 12450  3766]
 [ 7293  8689  6287]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1037847
{'0': {'precision': 0.3763940520446097, 'recall': 0.3796875, 'f1-score': 0.37803360298693217, 'support': 6400}, '1': {'precision': 0.36140712730606167, 'recall': 0.5313342318059299, 'f1-score': 0.43019845870558554, 'support': 5936}, '2': {'precision': 0.4125612215499856, 'recall': 0.2266540044317822, 'f1-score': 0.2925732965573603, 'support': 6318}, 'accuracy': 0.3761123619599014, 'macro avg': {'precision': 0.38345413363355235, 'recall': 0.3792252454125707, 'f1-score': 0.366935119416626, 'support': 18654}, 'weighted avg': {'precision': 0.38387458124408136, 'recall': 0.3761123619599014, 'f1-score': 0.36568838842297224, 'support': 18654}}
[[2430 2885 1085]
 [1828 3154  954]
 [2198 2688 1432]]
training model: results/XRAY/W9/deepLOB_L2/h100
Epoch 1/50
262/262 - 13s - loss: 3.3545 - accuracy100: 0.3480 - val_loss: 3.4323 - val_accuracy100: 0.3375 - 13s/epoch - 51ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2962 - accuracy100: 0.3686 - val_loss: 3.4184 - val_accuracy100: 0.3221 - 11s/epoch - 43ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2714 - accuracy100: 0.3815 - val_loss: 3.4320 - val_accuracy100: 0.3257 - 11s/epoch - 43ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2554 - accuracy100: 0.3877 - val_loss: 3.3518 - val_accuracy100: 0.3391 - 11s/epoch - 42ms/step
Epoch 5/50
262/262 - 11s - loss: 3.2349 - accuracy100: 0.4014 - val_loss: 3.3571 - val_accuracy100: 0.3370 - 11s/epoch - 42ms/step
Epoch 6/50
262/262 - 11s - loss: 3.2192 - accuracy100: 0.4082 - val_loss: 3.3699 - val_accuracy100: 0.3361 - 11s/epoch - 42ms/step
Epoch 7/50
262/262 - 11s - loss: 3.2066 - accuracy100: 0.4131 - val_loss: 3.3682 - val_accuracy100: 0.3415 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1956 - accuracy100: 0.4211 - val_loss: 3.3535 - val_accuracy100: 0.3405 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1842 - accuracy100: 0.4261 - val_loss: 3.3646 - val_accuracy100: 0.3417 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.1727 - accuracy100: 0.4294 - val_loss: 3.3896 - val_accuracy100: 0.3337 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 3.1618 - accuracy100: 0.4353 - val_loss: 3.3911 - val_accuracy100: 0.3490 - 11s/epoch - 41ms/step
Epoch 12/50
262/262 - 11s - loss: 3.1521 - accuracy100: 0.4411 - val_loss: 3.3910 - val_accuracy100: 0.3428 - 11s/epoch - 41ms/step
Epoch 13/50
262/262 - 11s - loss: 3.1422 - accuracy100: 0.4458 - val_loss: 3.3924 - val_accuracy100: 0.3452 - 11s/epoch - 41ms/step
Epoch 14/50
262/262 - 11s - loss: 3.1309 - accuracy100: 0.4509 - val_loss: 3.4450 - val_accuracy100: 0.3460 - 11s/epoch - 42ms/step
testing model: results/XRAY/W9/deepLOB_L2/h100
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026027
{'0': {'precision': 0.36448644369681377, 'recall': 0.17748813453152482, 'f1-score': 0.23872713426983588, 'support': 41507}, '1': {'precision': 0.38646488145324953, 'recall': 0.6812005147556002, 'f1-score': 0.49315090123875926, 'support': 45847}, '2': {'precision': 0.3620599965319924, 'recall': 0.2456181625691095, 'f1-score': 0.29268292682926833, 'support': 42505}, 'accuracy': 0.3776249624592828, 'macro avg': {'precision': 0.37100377389401856, 'recall': 0.36810227061874484, 'f1-score': 0.34152032077928784, 'support': 129859}, 'weighted avg': {'precision': 0.3714517622275169, 'recall': 0.3776249624592828, 'f1-score': 0.3462126178093896, 'support': 129859}}
[[ 7367 23999 10141]
 [ 6362 31231  8254]
 [ 6483 25582 10440]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050084
{'0': {'precision': 0.34816738119678764, 'recall': 0.2569976822963095, 'f1-score': 0.29571505500423106, 'support': 22436}, '1': {'precision': 0.35592175777063234, 'recall': 0.5983872420938823, 'f1-score': 0.4463523639907255, 'support': 22198}, '2': {'precision': 0.39213578066200755, 'recall': 0.22929764684749415, 'f1-score': 0.28938196038425573, 'support': 22268}, 'accuracy': 0.36105049176407283, 'macro avg': {'precision': 0.36540830654314255, 'recall': 0.36156085707922864, 'f1-score': 0.3438164597930708, 'support': 66902}, 'weighted avg': {'precision': 0.36537493807816224, 'recall': 0.3610504917640728, 'f1-score': 0.34358838665178404, 'support': 66902}}
[[ 5766 12355  4315]
 [ 5315 13283  3600]
 [ 5480 11682  5106]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1165835
{'0': {'precision': 0.34973637961335674, 'recall': 0.27767441860465114, 'f1-score': 0.30956702100077776, 'support': 6450}, '1': {'precision': 0.3282828282828283, 'recall': 0.5789915966386555, 'f1-score': 0.41899781075164194, 'support': 5950}, '2': {'precision': 0.36952945047713065, 'recall': 0.1795650783498561, 'f1-score': 0.24168729150973853, 'support': 6254}, 'accuracy': 0.34089203388013295, 'macro avg': {'precision': 0.3491828861244386, 'recall': 0.3454103645310542, 'f1-score': 0.32341737442071944, 'support': 18654}, 'weighted avg': {'precision': 0.3495293052467543, 'recall': 0.34089203388013295, 'f1-score': 0.32171419430305515, 'support': 18654}}
[[1791 3660  999]
 [1588 3445  917]
 [1742 3389 1123]]
training model: results/XRAY/W9/deepLOB_L2/h200
Epoch 1/50
262/262 - 13s - loss: 3.2985 - accuracy200: 0.3767 - val_loss: 3.3907 - val_accuracy200: 0.3504 - 13s/epoch - 49ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2534 - accuracy200: 0.3952 - val_loss: 3.4141 - val_accuracy200: 0.3466 - 11s/epoch - 41ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2266 - accuracy200: 0.4040 - val_loss: 3.3381 - val_accuracy200: 0.3578 - 11s/epoch - 41ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2010 - accuracy200: 0.4166 - val_loss: 3.3198 - val_accuracy200: 0.3580 - 11s/epoch - 41ms/step
Epoch 5/50
262/262 - 11s - loss: 3.1791 - accuracy200: 0.4271 - val_loss: 3.3616 - val_accuracy200: 0.3679 - 11s/epoch - 41ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1597 - accuracy200: 0.4361 - val_loss: 3.3477 - val_accuracy200: 0.3594 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1459 - accuracy200: 0.4449 - val_loss: 3.3421 - val_accuracy200: 0.3572 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1235 - accuracy200: 0.4513 - val_loss: 3.3471 - val_accuracy200: 0.3599 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1074 - accuracy200: 0.4595 - val_loss: 3.2986 - val_accuracy200: 0.3736 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.0945 - accuracy200: 0.4634 - val_loss: 3.2909 - val_accuracy200: 0.3728 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 3.0793 - accuracy200: 0.4692 - val_loss: 3.2934 - val_accuracy200: 0.3582 - 11s/epoch - 41ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0658 - accuracy200: 0.4757 - val_loss: 3.3103 - val_accuracy200: 0.3644 - 11s/epoch - 41ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0478 - accuracy200: 0.4801 - val_loss: 3.3114 - val_accuracy200: 0.3728 - 11s/epoch - 41ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0320 - accuracy200: 0.4857 - val_loss: 3.3144 - val_accuracy200: 0.3760 - 11s/epoch - 41ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0214 - accuracy200: 0.4890 - val_loss: 3.3255 - val_accuracy200: 0.3632 - 11s/epoch - 41ms/step
Epoch 16/50
262/262 - 11s - loss: 3.0016 - accuracy200: 0.4972 - val_loss: 3.3180 - val_accuracy200: 0.3683 - 11s/epoch - 41ms/step
Epoch 17/50
262/262 - 11s - loss: 2.9820 - accuracy200: 0.5039 - val_loss: 3.3874 - val_accuracy200: 0.3628 - 11s/epoch - 41ms/step
Epoch 18/50
262/262 - 11s - loss: 2.9676 - accuracy200: 0.5055 - val_loss: 3.3963 - val_accuracy200: 0.3587 - 11s/epoch - 41ms/step
Epoch 19/50
262/262 - 11s - loss: 2.9527 - accuracy200: 0.5107 - val_loss: 3.3904 - val_accuracy200: 0.3570 - 11s/epoch - 41ms/step
Epoch 20/50
262/262 - 11s - loss: 2.9291 - accuracy200: 0.5149 - val_loss: 3.4288 - val_accuracy200: 0.3579 - 11s/epoch - 41ms/step
testing model: results/XRAY/W9/deepLOB_L2/h200
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069142
{'0': {'precision': 0.29652655764292474, 'recall': 0.2542176492398962, 'f1-score': 0.2737469899060476, 'support': 43152}, '1': {'precision': 0.39659385978310674, 'recall': 0.3607586143015932, 'f1-score': 0.377828438386729, 'support': 43184}, '2': {'precision': 0.3529916763092083, 'recall': 0.4345748225076396, 'f1-score': 0.389557695278307, 'support': 43523}, 'accuracy': 0.35009510315034, 'macro avg': {'precision': 0.3487040312450799, 'recall': 0.34985036201637637, 'f1-score': 0.3470443745236946, 'support': 129859}, 'weighted avg': {'precision': 0.34872808187562543, 'recall': 0.35009510315034, 'f1-score': 0.3471734185795057, 'support': 129859}}
[[10970 11516 20666]
 [13603 15579 14002]
 [12422 12187 18914]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083876
{'0': {'precision': 0.37994550408719346, 'recall': 0.309673980634272, 'f1-score': 0.34122944400939703, 'support': 22514}, '1': {'precision': 0.40093141405588484, 'recall': 0.5609422700141249, 'f1-score': 0.4676276755360568, 'support': 21947}, '2': {'precision': 0.3944861593634428, 'recall': 0.3137115101822557, 'f1-score': 0.3494923920867774, 'support': 22441}, 'accuracy': 0.39345609996711606, 'macro avg': {'precision': 0.3917876925021737, 'recall': 0.3947759202768842, 'f1-score': 0.38611650387741037, 'support': 66902}, 'weighted avg': {'precision': 0.3917072542760844, 'recall': 0.393456099967116, 'f1-score': 0.38546565227103485, 'support': 66902}}
[[ 6972  9106  6436]
 [ 5266 12311  4370]
 [ 6112  9289  7040]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992192
{'0': {'precision': 0.3850267379679144, 'recall': 0.36103935572101503, 'f1-score': 0.3726474278544542, 'support': 6581}, '1': {'precision': 0.36175766804437676, 'recall': 0.5553514777091334, 'f1-score': 0.4381215833497991, 'support': 5989}, '2': {'precision': 0.36546062633019155, 'recall': 0.19756738987508218, 'f1-score': 0.25648138269497495, 'support': 6084}, 'accuracy': 0.37010828776669885, 'macro avg': {'precision': 0.37074834411416097, 'recall': 0.37131940776841027, 'f1-score': 0.3557501312997428, 'support': 18654}, 'weighted avg': {'precision': 0.3711745516820791, 'recall': 0.37010828776669885, 'f1-score': 0.3557808307981311, 'support': 18654}}
[[2376 3012 1193]
 [1769 3326  894]
 [2026 2856 1202]]
training model: results/XRAY/W9/deepLOB_L2/h300
Epoch 1/50
262/262 - 13s - loss: 3.3375 - accuracy300: 0.3549 - val_loss: 3.3782 - val_accuracy300: 0.3407 - 13s/epoch - 50ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2884 - accuracy300: 0.3737 - val_loss: 3.4452 - val_accuracy300: 0.3354 - 11s/epoch - 43ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2561 - accuracy300: 0.3911 - val_loss: 3.3915 - val_accuracy300: 0.3417 - 11s/epoch - 42ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2265 - accuracy300: 0.4061 - val_loss: 3.3194 - val_accuracy300: 0.3500 - 11s/epoch - 42ms/step
Epoch 5/50
262/262 - 11s - loss: 3.2125 - accuracy300: 0.4196 - val_loss: 3.3139 - val_accuracy300: 0.3582 - 11s/epoch - 41ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1916 - accuracy300: 0.4258 - val_loss: 3.3112 - val_accuracy300: 0.3612 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1746 - accuracy300: 0.4367 - val_loss: 3.3183 - val_accuracy300: 0.3612 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1585 - accuracy300: 0.4430 - val_loss: 3.3328 - val_accuracy300: 0.3590 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1455 - accuracy300: 0.4499 - val_loss: 3.3289 - val_accuracy300: 0.3570 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.1318 - accuracy300: 0.4542 - val_loss: 3.3528 - val_accuracy300: 0.3568 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 3.1050 - accuracy300: 0.4661 - val_loss: 3.3769 - val_accuracy300: 0.3572 - 11s/epoch - 41ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0894 - accuracy300: 0.4710 - val_loss: 3.3848 - val_accuracy300: 0.3597 - 11s/epoch - 41ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0815 - accuracy300: 0.4778 - val_loss: 3.4691 - val_accuracy300: 0.3522 - 11s/epoch - 41ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0670 - accuracy300: 0.4804 - val_loss: 3.3867 - val_accuracy300: 0.3549 - 11s/epoch - 41ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0532 - accuracy300: 0.4831 - val_loss: 3.4411 - val_accuracy300: 0.3543 - 11s/epoch - 41ms/step
Epoch 16/50
262/262 - 11s - loss: 3.0272 - accuracy300: 0.4904 - val_loss: 3.4441 - val_accuracy300: 0.3543 - 11s/epoch - 41ms/step
testing model: results/XRAY/W9/deepLOB_L2/h300
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164663
{'0': {'precision': 0.26943556975505856, 'recall': 0.11824465599094777, 'f1-score': 0.16435873764830577, 'support': 40653}, '1': {'precision': 0.37948300184784123, 'recall': 0.4128085419098258, 'f1-score': 0.395444898804286, 'support': 46266}, '2': {'precision': 0.334938157532137, 'recall': 0.48118304611085233, 'f1-score': 0.3949574209827103, 'support': 42940}, 'accuracy': 0.3432030124981711, 'macro avg': {'precision': 0.3279522430450123, 'recall': 0.3374120813372086, 'f1-score': 0.31825368581176733, 'support': 129859}, 'weighted avg': {'precision': 0.33030263027725904, 'recall': 0.3432030124981711, 'f1-score': 0.3229410445690576, 'support': 129859}}
[[ 4807 14833 21013]
 [ 7153 19099 20014]
 [ 5881 16397 20662]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105537
{'0': {'precision': 0.331279568709429, 'recall': 0.13484705987728962, 'f1-score': 0.1916735629257114, 'support': 22329}, '1': {'precision': 0.36923076923076925, 'recall': 0.5165023962383579, 'f1-score': 0.43062309171095786, 'support': 22118}, '2': {'precision': 0.3582406132549399, 'recall': 0.42872411489645956, 'f1-score': 0.3903259811871554, 'support': 22455}, 'accuracy': 0.3596603987922633, 'macro avg': {'precision': 0.3529169837317127, 'recall': 0.3600245236707023, 'f1-score': 0.3375408786079415, 'support': 66902}, 'weighted avg': {'precision': 0.35287555849150504, 'recall': 0.3596603987922633, 'f1-score': 0.33734672261798976, 'support': 66902}}
[[ 3011  9858  9460]
 [ 2908 11424  7786]
 [ 3170  9658  9627]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032329
{'0': {'precision': 0.375846099038119, 'recall': 0.16326214794181368, 'f1-score': 0.22764052217067646, 'support': 6462}, '1': {'precision': 0.364741641337386, 'recall': 0.5067402955985058, 'f1-score': 0.4241723880089729, 'support': 6157}, '2': {'precision': 0.3437542849307555, 'recall': 0.4154101077050539, 'f1-score': 0.3762004801920768, 'support': 6035}, 'accuracy': 0.3582073549908867, 'macro avg': {'precision': 0.36144734176875354, 'recall': 0.3618041837484578, 'f1-score': 0.3426711301239087, 'support': 18654}, 'weighted avg': {'precision': 0.36179848221591726, 'recall': 0.3582073549908867, 'f1-score': 0.34057104884728967, 'support': 18654}}
[[1055 2833 2574]
 [ 825 3120 2212]
 [ 927 2601 2507]]
training model: results/XRAY/W9/deepLOB_L2/h500
Epoch 1/50
262/262 - 13s - loss: 3.3373 - accuracy500: 0.3592 - val_loss: 3.4083 - val_accuracy500: 0.3433 - 13s/epoch - 51ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2934 - accuracy500: 0.3715 - val_loss: 3.4751 - val_accuracy500: 0.3514 - 11s/epoch - 41ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2718 - accuracy500: 0.3845 - val_loss: 3.3988 - val_accuracy500: 0.3484 - 11s/epoch - 41ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2477 - accuracy500: 0.4043 - val_loss: 3.3652 - val_accuracy500: 0.3438 - 11s/epoch - 41ms/step
Epoch 5/50
262/262 - 11s - loss: 3.2369 - accuracy500: 0.4063 - val_loss: 3.3567 - val_accuracy500: 0.3509 - 11s/epoch - 42ms/step
Epoch 6/50
262/262 - 11s - loss: 3.2133 - accuracy500: 0.4190 - val_loss: 3.3550 - val_accuracy500: 0.3554 - 11s/epoch - 42ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1807 - accuracy500: 0.4354 - val_loss: 3.3909 - val_accuracy500: 0.3423 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.1580 - accuracy500: 0.4437 - val_loss: 3.3799 - val_accuracy500: 0.3462 - 11s/epoch - 42ms/step
Epoch 9/50
262/262 - 11s - loss: 3.1359 - accuracy500: 0.4550 - val_loss: 3.3989 - val_accuracy500: 0.3509 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.1139 - accuracy500: 0.4630 - val_loss: 3.4556 - val_accuracy500: 0.3471 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 3.0970 - accuracy500: 0.4672 - val_loss: 3.4279 - val_accuracy500: 0.3473 - 11s/epoch - 42ms/step
Epoch 12/50
262/262 - 11s - loss: 3.0633 - accuracy500: 0.4789 - val_loss: 3.4548 - val_accuracy500: 0.3517 - 11s/epoch - 41ms/step
Epoch 13/50
262/262 - 11s - loss: 3.0366 - accuracy500: 0.4892 - val_loss: 3.4766 - val_accuracy500: 0.3487 - 11s/epoch - 41ms/step
Epoch 14/50
262/262 - 11s - loss: 3.0138 - accuracy500: 0.4952 - val_loss: 3.5830 - val_accuracy500: 0.3473 - 11s/epoch - 41ms/step
Epoch 15/50
262/262 - 11s - loss: 3.0012 - accuracy500: 0.4986 - val_loss: 3.5736 - val_accuracy500: 0.3510 - 11s/epoch - 41ms/step
Epoch 16/50
262/262 - 11s - loss: 2.9827 - accuracy500: 0.5046 - val_loss: 3.5666 - val_accuracy500: 0.3539 - 11s/epoch - 41ms/step
testing model: results/XRAY/W9/deepLOB_L2/h500
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1140152
{'0': {'precision': 0.2997417031934878, 'recall': 0.1861827551838977, 'f1-score': 0.22969305282730285, 'support': 41137}, '1': {'precision': 0.40324705210201395, 'recall': 0.5755413608770499, 'f1-score': 0.4742298826976735, 'support': 44148}, '2': {'precision': 0.37972200697404107, 'recall': 0.35179701171086286, 'f1-score': 0.3652265051822523, 'support': 44574}, 'accuracy': 0.37539947173472765, 'macro avg': {'precision': 0.36090358742318096, 'recall': 0.37117370925727017, 'f1-score': 0.3563831469024095, 'support': 129859}, 'weighted avg': {'precision': 0.3623834623655744, 'recall': 0.37539947173472765, 'f1-score': 0.3593496809423094, 'support': 129859}}
[[ 7659 17832 15646]
 [ 8770 25409  9969]
 [ 9123 19770 15681]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273074
{'0': {'precision': 0.33772517736293195, 'recall': 0.4565947666195191, 'f1-score': 0.38826558418372137, 'support': 22624}, '1': {'precision': 0.33506137819729054, 'recall': 0.3099018410458226, 'f1-score': 0.3219908821732387, 'support': 22107}, '2': {'precision': 0.3600957902697252, 'recall': 0.2577240539443417, 'f1-score': 0.3004285075843213, 'support': 22171}, 'accuracy': 0.3422169740814923, 'macro avg': {'precision': 0.3442941152766492, 'recall': 0.3414068872032278, 'f1-score': 0.33689499131376044, 'support': 66902}, 'weighted avg': {'precision': 0.3442584686038766, 'recall': 0.3422169740814923, 'f1-score': 0.33725708424902523, 'support': 66902}}
[[10330  6898  5396]
 [10498  6851  4758]
 [ 9759  6698  5714]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1147213
{'0': {'precision': 0.3447637709558023, 'recall': 0.49992107340173636, 'f1-score': 0.4080922620965144, 'support': 6335}, '1': {'precision': 0.36386215461036947, 'recall': 0.36971608832807573, 'f1-score': 0.36676576435612585, 'support': 6340}, '2': {'precision': 0.34963648380700596, 'recall': 0.17695266767017895, 'f1-score': 0.23498056635202666, 'support': 5979}, 'accuracy': 0.3521496729923877, 'macro avg': {'precision': 0.35275413645772585, 'recall': 0.3488632764666637, 'f1-score': 0.3366128642682223, 'support': 18654}, 'weighted avg': {'precision': 0.352816612303894, 'recall': 0.3521496729923877, 'f1-score': 0.3385605356823215, 'support': 18654}}
[[3167 2146 1022]
 [3050 2344  946]
 [2969 1952 1058]]
training model: results/XRAY/W9/deepLOB_L2/h1000
Epoch 1/50
262/262 - 13s - loss: 3.3340 - accuracy1000: 0.3630 - val_loss: 3.4883 - val_accuracy1000: 0.3311 - 13s/epoch - 48ms/step
Epoch 2/50
262/262 - 11s - loss: 3.2797 - accuracy1000: 0.3898 - val_loss: 3.4482 - val_accuracy1000: 0.3160 - 11s/epoch - 41ms/step
Epoch 3/50
262/262 - 11s - loss: 3.2377 - accuracy1000: 0.4120 - val_loss: 3.4125 - val_accuracy1000: 0.3436 - 11s/epoch - 41ms/step
Epoch 4/50
262/262 - 11s - loss: 3.2148 - accuracy1000: 0.4273 - val_loss: 3.4303 - val_accuracy1000: 0.3446 - 11s/epoch - 41ms/step
Epoch 5/50
262/262 - 11s - loss: 3.1735 - accuracy1000: 0.4439 - val_loss: 3.3694 - val_accuracy1000: 0.3454 - 11s/epoch - 41ms/step
Epoch 6/50
262/262 - 11s - loss: 3.1285 - accuracy1000: 0.4627 - val_loss: 3.3216 - val_accuracy1000: 0.3777 - 11s/epoch - 41ms/step
Epoch 7/50
262/262 - 11s - loss: 3.1081 - accuracy1000: 0.4650 - val_loss: 3.3721 - val_accuracy1000: 0.3637 - 11s/epoch - 41ms/step
Epoch 8/50
262/262 - 11s - loss: 3.0687 - accuracy1000: 0.4797 - val_loss: 3.4624 - val_accuracy1000: 0.3678 - 11s/epoch - 41ms/step
Epoch 9/50
262/262 - 11s - loss: 3.0366 - accuracy1000: 0.4889 - val_loss: 3.4077 - val_accuracy1000: 0.3724 - 11s/epoch - 41ms/step
Epoch 10/50
262/262 - 11s - loss: 3.0074 - accuracy1000: 0.4986 - val_loss: 3.4900 - val_accuracy1000: 0.3721 - 11s/epoch - 41ms/step
Epoch 11/50
262/262 - 11s - loss: 2.9749 - accuracy1000: 0.5097 - val_loss: 3.4320 - val_accuracy1000: 0.3628 - 11s/epoch - 41ms/step
Epoch 12/50
262/262 - 11s - loss: 2.9375 - accuracy1000: 0.5213 - val_loss: 3.4699 - val_accuracy1000: 0.3750 - 11s/epoch - 41ms/step
Epoch 13/50
262/262 - 11s - loss: 2.9161 - accuracy1000: 0.5255 - val_loss: 3.4758 - val_accuracy1000: 0.3656 - 11s/epoch - 42ms/step
Epoch 14/50
262/262 - 11s - loss: 2.9000 - accuracy1000: 0.5298 - val_loss: 3.4645 - val_accuracy1000: 0.3647 - 11s/epoch - 41ms/step
Epoch 15/50
262/262 - 11s - loss: 2.8618 - accuracy1000: 0.5390 - val_loss: 3.5528 - val_accuracy1000: 0.3622 - 11s/epoch - 41ms/step
Epoch 16/50
262/262 - 11s - loss: 2.8278 - accuracy1000: 0.5494 - val_loss: 3.7038 - val_accuracy1000: 0.3610 - 11s/epoch - 41ms/step
testing model: results/XRAY/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1877488
{'0': {'precision': 0.28655653493666455, 'recall': 0.3522784355938285, 'f1-score': 0.3160368248245671, 'support': 41805}, '1': {'precision': 0.28886477268322935, 'recall': 0.18986600091710398, 'f1-score': 0.2291291983706095, 'support': 39254}, '2': {'precision': 0.3607709104718504, 'recall': 0.38934426229508196, 'f1-score': 0.3745133789976839, 'support': 48800}, 'accuracy': 0.31711317659923455, 'macro avg': {'precision': 0.3120640726972481, 'recall': 0.3104962329353382, 'f1-score': 0.3065598007309535, 'support': 129859}, 'weighted avg': {'precision': 0.31514345683365064, 'recall': 0.31711317659923455, 'f1-score': 0.3117412725318839, 'support': 129859}}
[[14727  7516 19562]
 [17698  7453 14103]
 [18968 10832 19000]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1438497
{'0': {'precision': 0.3481635422851811, 'recall': 0.3509019406685475, 'f1-score': 0.34952737801243294, 'support': 23394}, '1': {'precision': 0.34703551719258524, 'recall': 0.2300980438147957, 'f1-score': 0.27671997969027673, 'support': 21317}, '2': {'precision': 0.3535799931483385, 'recall': 0.4650984633409941, 'f1-score': 0.40174383526984686, 'support': 22191}, 'accuracy': 0.35028848165974114, 'macro avg': {'precision': 0.349593017542035, 'recall': 0.34869948260811245, 'f1-score': 0.3426637309908522, 'support': 66902}, 'weighted avg': {'precision': 0.3496007242858008, 'recall': 0.35028848165974114, 'f1-score': 0.34364863138252455, 'support': 66902}}
[[ 8209  4794 10391]
 [ 7934  4905  8478]
 [ 7435  4435 10321]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088414
{'0': {'precision': 0.37259162682891495, 'recall': 0.3961799137399877, 'f1-score': 0.3840238895110116, 'support': 6492}, '1': {'precision': 0.3851276359600444, 'recall': 0.29194009759380785, 'f1-score': 0.3321209800918837, 'support': 5943}, '2': {'precision': 0.36599503174165054, 'recall': 0.42643511818620355, 'f1-score': 0.39391013739324177, 'support': 6219}, 'accuracy': 0.37305671705800364, 'macro avg': {'precision': 0.3745714315102033, 'recall': 0.37151837650666636, 'f1-score': 0.370018335665379, 'support': 18654}, 'weighted avg': {'precision': 0.3743862701986268, 'recall': 0.37305671705800364, 'f1-score': 0.37078402593760706, 'support': 18654}}
[[2572 1462 2458]
 [2072 1735 2136]
 [2259 1308 2652]]
training model: results/XRAY/W9/deepOF_L2/h10
Epoch 1/50
262/262 - 8s - loss: 3.2981 - accuracy10: 0.3735 - val_loss: 3.2322 - val_accuracy10: 0.3944 - 8s/epoch - 31ms/step
Epoch 2/50
262/262 - 6s - loss: 3.1905 - accuracy10: 0.4240 - val_loss: 3.1809 - val_accuracy10: 0.4242 - 6s/epoch - 24ms/step
Epoch 3/50
262/262 - 6s - loss: 3.1443 - accuracy10: 0.4407 - val_loss: 3.1617 - val_accuracy10: 0.4311 - 6s/epoch - 24ms/step
Epoch 4/50
262/262 - 6s - loss: 3.1089 - accuracy10: 0.4548 - val_loss: 3.1528 - val_accuracy10: 0.4371 - 6s/epoch - 23ms/step
Epoch 5/50
262/262 - 6s - loss: 3.0815 - accuracy10: 0.4664 - val_loss: 3.1548 - val_accuracy10: 0.4415 - 6s/epoch - 23ms/step
Epoch 6/50
262/262 - 6s - loss: 3.0608 - accuracy10: 0.4742 - val_loss: 3.1478 - val_accuracy10: 0.4478 - 6s/epoch - 24ms/step
Epoch 7/50
262/262 - 6s - loss: 3.0371 - accuracy10: 0.4840 - val_loss: 3.1453 - val_accuracy10: 0.4475 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.0135 - accuracy10: 0.4939 - val_loss: 3.1355 - val_accuracy10: 0.4535 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 2.9974 - accuracy10: 0.4968 - val_loss: 3.1316 - val_accuracy10: 0.4578 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 2.9843 - accuracy10: 0.5011 - val_loss: 3.1150 - val_accuracy10: 0.4633 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 2.9695 - accuracy10: 0.5046 - val_loss: 3.1120 - val_accuracy10: 0.4649 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 2.9538 - accuracy10: 0.5122 - val_loss: 3.1039 - val_accuracy10: 0.4676 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 2.9400 - accuracy10: 0.5161 - val_loss: 3.1024 - val_accuracy10: 0.4667 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 2.9293 - accuracy10: 0.5187 - val_loss: 3.1027 - val_accuracy10: 0.4696 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 2.9171 - accuracy10: 0.5211 - val_loss: 3.0989 - val_accuracy10: 0.4699 - 6s/epoch - 24ms/step
Epoch 16/50
262/262 - 6s - loss: 2.9055 - accuracy10: 0.5258 - val_loss: 3.1109 - val_accuracy10: 0.4704 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 2.8952 - accuracy10: 0.5288 - val_loss: 3.1195 - val_accuracy10: 0.4669 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 2.8869 - accuracy10: 0.5304 - val_loss: 3.1102 - val_accuracy10: 0.4706 - 6s/epoch - 23ms/step
Epoch 19/50
262/262 - 6s - loss: 2.8768 - accuracy10: 0.5333 - val_loss: 3.1150 - val_accuracy10: 0.4689 - 6s/epoch - 23ms/step
Epoch 20/50
262/262 - 6s - loss: 2.8642 - accuracy10: 0.5361 - val_loss: 3.1183 - val_accuracy10: 0.4714 - 6s/epoch - 23ms/step
Epoch 21/50
262/262 - 6s - loss: 2.8550 - accuracy10: 0.5393 - val_loss: 3.1275 - val_accuracy10: 0.4726 - 6s/epoch - 23ms/step
Epoch 22/50
262/262 - 6s - loss: 2.8437 - accuracy10: 0.5414 - val_loss: 3.1253 - val_accuracy10: 0.4691 - 6s/epoch - 23ms/step
Epoch 23/50
262/262 - 6s - loss: 2.8360 - accuracy10: 0.5446 - val_loss: 3.1261 - val_accuracy10: 0.4690 - 6s/epoch - 23ms/step
Epoch 24/50
262/262 - 6s - loss: 2.8258 - accuracy10: 0.5467 - val_loss: 3.1367 - val_accuracy10: 0.4695 - 6s/epoch - 23ms/step
Epoch 25/50
262/262 - 6s - loss: 2.8158 - accuracy10: 0.5486 - val_loss: 3.1483 - val_accuracy10: 0.4680 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h10
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95230323
{'0': {'precision': 0.5098110997217747, 'recall': 0.36508061344868264, 'f1-score': 0.42547471013275073, 'support': 38145}, '1': {'precision': 0.5974674396833478, 'recall': 0.6948466210795736, 'f1-score': 0.6424881447532254, 'support': 52354}, '2': {'precision': 0.4813934504945741, 'recall': 0.5094775891858929, 'f1-score': 0.49503752715781163, 'support': 39356}, 'accuracy': 0.5417966193061492, 'macro avg': {'precision': 0.5295573299665656, 'recall': 0.5231349412380497, 'f1-score': 0.5210001273479292, 'support': 129855}, 'weighted avg': {'precision': 0.5365390271744142, 'recall': 0.5417966193061492, 'f1-score': 0.5340514733144428, 'support': 129855}}
[[13926 12333 11886]
 [ 6261 36378  9715]
 [ 7129 12176 20051]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9753943
{'0': {'precision': 0.5344575968866547, 'recall': 0.44398545193300704, 'f1-score': 0.485038752084764, 'support': 22271}, '1': {'precision': 0.5199906567524428, 'recall': 0.5805119735755574, 'f1-score': 0.5485871529489075, 'support': 23009}, '2': {'precision': 0.5018490798626398, 'recall': 0.5271945240958283, 'f1-score': 0.5142096715987008, 'support': 21622}, 'accuracy': 0.5178320528534274, 'macro avg': {'precision': 0.5187657778339124, 'recall': 0.5172306498681309, 'f1-score': 0.5159451922107907, 'support': 66902}, 'weighted avg': {'precision': 0.5189433943121229, 'recall': 0.5178320528534274, 'f1-score': 0.5163221035124256, 'support': 66902}}
[[ 9888  6347  6036]
 [ 4373 13357  5279]
 [ 4240  5983 11399]]
Evaluating performance on  val set...
73/73 - 1s - 812ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.031944
{'0': {'precision': 0.5043357613596947, 'recall': 0.42689371697005285, 'f1-score': 0.46239465733820956, 'support': 6812}, '1': {'precision': 0.4107643758765778, 'recall': 0.46203904555314534, 'f1-score': 0.4348955916473318, 'support': 5071}, '2': {'precision': 0.49157733537519144, 'recall': 0.5215657311669128, 'f1-score': 0.5061277144700065, 'support': 6770}, 'accuracy': 0.4708089851498419, 'macro avg': {'precision': 0.46889249087048795, 'recall': 0.47016616456337035, 'f1-score': 0.46780598781851596, 'support': 18653}, 'weighted avg': {'precision': 0.4742668695085194, 'recall': 0.4708089851498419, 'f1-score': 0.47079143183366995, 'support': 18653}}
[[2908 1754 2150]
 [1226 2343 1502]
 [1632 1607 3531]]
training model: results/XRAY/W9/deepOF_L2/h20
Epoch 1/50
262/262 - 8s - loss: 3.3209 - accuracy20: 0.3556 - val_loss: 3.2646 - val_accuracy20: 0.3716 - 8s/epoch - 32ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2454 - accuracy20: 0.3951 - val_loss: 3.2212 - val_accuracy20: 0.4015 - 6s/epoch - 23ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2084 - accuracy20: 0.4152 - val_loss: 3.2098 - val_accuracy20: 0.4122 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.1789 - accuracy20: 0.4283 - val_loss: 3.2055 - val_accuracy20: 0.4138 - 6s/epoch - 24ms/step
Epoch 5/50
262/262 - 6s - loss: 3.1575 - accuracy20: 0.4429 - val_loss: 3.2009 - val_accuracy20: 0.4170 - 6s/epoch - 24ms/step
Epoch 6/50
262/262 - 6s - loss: 3.1377 - accuracy20: 0.4494 - val_loss: 3.2020 - val_accuracy20: 0.4182 - 6s/epoch - 23ms/step
Epoch 7/50
262/262 - 6s - loss: 3.1220 - accuracy20: 0.4576 - val_loss: 3.1993 - val_accuracy20: 0.4192 - 6s/epoch - 24ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1055 - accuracy20: 0.4632 - val_loss: 3.2022 - val_accuracy20: 0.4239 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.0902 - accuracy20: 0.4688 - val_loss: 3.1960 - val_accuracy20: 0.4300 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.0777 - accuracy20: 0.4738 - val_loss: 3.1847 - val_accuracy20: 0.4337 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.0674 - accuracy20: 0.4784 - val_loss: 3.1889 - val_accuracy20: 0.4280 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.0535 - accuracy20: 0.4840 - val_loss: 3.1855 - val_accuracy20: 0.4352 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.0436 - accuracy20: 0.4850 - val_loss: 3.1840 - val_accuracy20: 0.4338 - 6s/epoch - 24ms/step
Epoch 14/50
262/262 - 6s - loss: 3.0305 - accuracy20: 0.4911 - val_loss: 3.1753 - val_accuracy20: 0.4372 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.0216 - accuracy20: 0.4934 - val_loss: 3.1667 - val_accuracy20: 0.4501 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.0089 - accuracy20: 0.4983 - val_loss: 3.1783 - val_accuracy20: 0.4437 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.0019 - accuracy20: 0.4987 - val_loss: 3.1806 - val_accuracy20: 0.4480 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 2.9939 - accuracy20: 0.5019 - val_loss: 3.1797 - val_accuracy20: 0.4472 - 6s/epoch - 23ms/step
Epoch 19/50
262/262 - 6s - loss: 2.9839 - accuracy20: 0.5062 - val_loss: 3.1828 - val_accuracy20: 0.4478 - 6s/epoch - 23ms/step
Epoch 20/50
262/262 - 6s - loss: 2.9656 - accuracy20: 0.5111 - val_loss: 3.1809 - val_accuracy20: 0.4490 - 6s/epoch - 23ms/step
Epoch 21/50
262/262 - 6s - loss: 2.9574 - accuracy20: 0.5149 - val_loss: 3.1891 - val_accuracy20: 0.4509 - 6s/epoch - 23ms/step
Epoch 22/50
262/262 - 6s - loss: 2.9498 - accuracy20: 0.5168 - val_loss: 3.1963 - val_accuracy20: 0.4500 - 6s/epoch - 23ms/step
Epoch 23/50
262/262 - 6s - loss: 2.9379 - accuracy20: 0.5204 - val_loss: 3.2044 - val_accuracy20: 0.4493 - 6s/epoch - 23ms/step
Epoch 24/50
262/262 - 6s - loss: 2.9332 - accuracy20: 0.5206 - val_loss: 3.2008 - val_accuracy20: 0.4461 - 6s/epoch - 23ms/step
Epoch 25/50
262/262 - 6s - loss: 2.9180 - accuracy20: 0.5250 - val_loss: 3.2089 - val_accuracy20: 0.4475 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h20
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0062363
{'0': {'precision': 0.4965785493049053, 'recall': 0.34890429677615264, 'f1-score': 0.40984483681112893, 'support': 39518}, '1': {'precision': 0.5356727546343799, 'recall': 0.6263046347022834, 'f1-score': 0.5774541432390082, 'support': 50014}, '2': {'precision': 0.4516313943090363, 'recall': 0.48848051980259405, 'f1-score': 0.4693337781166603, 'support': 40323}, 'accuracy': 0.49908744368718955, 'macro avg': {'precision': 0.4946275660827739, 'recall': 0.4878964837603434, 'f1-score': 0.4855442527222658, 'support': 129855}, 'weighted avg': {'precision': 0.49767864906579184, 'recall': 0.49908744368718955, 'f1-score': 0.4928727096843098, 'support': 129855}}
[[13788 14131 11599]
 [ 6373 31324 12317]
 [ 7605 13021 19697]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0120335
{'0': {'precision': 0.5215902402482744, 'recall': 0.4271504316199991, 'f1-score': 0.469669959046013, 'support': 22821}, '1': {'precision': 0.46480216113141587, 'recall': 0.5396927902578532, 'f1-score': 0.49945572132932065, 'support': 21679}, '2': {'precision': 0.49103771537693675, 'recall': 0.5050441924828141, 'f1-score': 0.4979424773892569, 'support': 22402}, 'accuracy': 0.4897013542196048, 'macro avg': {'precision': 0.49247670558554235, 'recall': 0.49062913812022213, 'f1-score': 0.4890227192548635, 'support': 66902}, 'weighted avg': {'precision': 0.4929581152095299, 'recall': 0.4897013542196048, 'f1-score': 0.4887887671005581, 'support': 66902}}
[[ 9748  7004  6069]
 [ 4321 11700  5658]
 [ 4620  6468 11314]]
Evaluating performance on  val set...
73/73 - 1s - 792ms/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0593084
{'0': {'precision': 0.47709593777009507, 'recall': 0.410958904109589, 'f1-score': 0.4415646748260139, 'support': 6716}, '1': {'precision': 0.3701707097933513, 'recall': 0.40503342508847817, 'f1-score': 0.38681813914186464, 'support': 5086}, '2': {'precision': 0.471587019033274, 'recall': 0.5027003357174136, 'f1-score': 0.486646884272997, 'support': 6851}, 'accuracy': 0.4430386532997373, 'macro avg': {'precision': 0.43961788886557346, 'recall': 0.4395642216384936, 'f1-score': 0.4383432327469585, 'support': 18653}, 'weighted avg': {'precision': 0.44591793360156023, 'recall': 0.4430386532997373, 'f1-score': 0.44319536889301103, 'support': 18653}}
[[2760 1829 2127]
 [1294 2060 1732]
 [1731 1676 3444]]
training model: results/XRAY/W9/deepOF_L2/h30
Epoch 1/50
262/262 - 8s - loss: 3.3322 - accuracy30: 0.3462 - val_loss: 3.2870 - val_accuracy30: 0.3697 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2709 - accuracy30: 0.3799 - val_loss: 3.2549 - val_accuracy30: 0.3910 - 6s/epoch - 23ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2397 - accuracy30: 0.3975 - val_loss: 3.2446 - val_accuracy30: 0.3976 - 6s/epoch - 24ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2173 - accuracy30: 0.4121 - val_loss: 3.2381 - val_accuracy30: 0.4096 - 6s/epoch - 23ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2034 - accuracy30: 0.4196 - val_loss: 3.2344 - val_accuracy30: 0.4067 - 6s/epoch - 23ms/step
Epoch 6/50
262/262 - 6s - loss: 3.1862 - accuracy30: 0.4289 - val_loss: 3.2308 - val_accuracy30: 0.4126 - 6s/epoch - 24ms/step
Epoch 7/50
262/262 - 6s - loss: 3.1730 - accuracy30: 0.4364 - val_loss: 3.2323 - val_accuracy30: 0.4097 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1631 - accuracy30: 0.4398 - val_loss: 3.2337 - val_accuracy30: 0.4086 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.1499 - accuracy30: 0.4448 - val_loss: 3.2301 - val_accuracy30: 0.4154 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1383 - accuracy30: 0.4484 - val_loss: 3.2298 - val_accuracy30: 0.4156 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1317 - accuracy30: 0.4522 - val_loss: 3.2311 - val_accuracy30: 0.4145 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1182 - accuracy30: 0.4586 - val_loss: 3.2322 - val_accuracy30: 0.4132 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1107 - accuracy30: 0.4603 - val_loss: 3.2275 - val_accuracy30: 0.4198 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.0981 - accuracy30: 0.4661 - val_loss: 3.2311 - val_accuracy30: 0.4163 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.0931 - accuracy30: 0.4652 - val_loss: 3.2360 - val_accuracy30: 0.4156 - 6s/epoch - 24ms/step
Epoch 16/50
262/262 - 6s - loss: 3.0821 - accuracy30: 0.4708 - val_loss: 3.2355 - val_accuracy30: 0.4181 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.0720 - accuracy30: 0.4750 - val_loss: 3.2390 - val_accuracy30: 0.4163 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 3.0644 - accuracy30: 0.4778 - val_loss: 3.2405 - val_accuracy30: 0.4169 - 6s/epoch - 23ms/step
Epoch 19/50
262/262 - 6s - loss: 3.0547 - accuracy30: 0.4817 - val_loss: 3.2384 - val_accuracy30: 0.4171 - 6s/epoch - 23ms/step
Epoch 20/50
262/262 - 6s - loss: 3.0391 - accuracy30: 0.4860 - val_loss: 3.2475 - val_accuracy30: 0.4199 - 6s/epoch - 23ms/step
Epoch 21/50
262/262 - 6s - loss: 3.0359 - accuracy30: 0.4867 - val_loss: 3.2494 - val_accuracy30: 0.4202 - 6s/epoch - 23ms/step
Epoch 22/50
262/262 - 6s - loss: 3.0210 - accuracy30: 0.4923 - val_loss: 3.2582 - val_accuracy30: 0.4201 - 6s/epoch - 23ms/step
Epoch 23/50
262/262 - 6s - loss: 3.0111 - accuracy30: 0.4951 - val_loss: 3.2672 - val_accuracy30: 0.4169 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h30
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0474659
{'0': {'precision': 0.46577472545271953, 'recall': 0.36121997789166915, 'f1-score': 0.4068880619189789, 'support': 39804}, '1': {'precision': 0.4872104247104247, 'recall': 0.4503132666923498, 'f1-score': 0.4680357839056721, 'support': 49319}, '2': {'precision': 0.4059773042208157, 'recall': 0.5322596484336639, 'f1-score': 0.46061996728068494, 'support': 40732}, 'accuracy': 0.4487081745023295, 'macro avg': {'precision': 0.4529874847946533, 'recall': 0.4479309643392276, 'f1-score': 0.44518127103511196, 'support': 129855}, 'weighted avg': {'precision': 0.45515918265554467, 'recall': 0.4487081745023295, 'f1-score': 0.4469662450451946, 'support': 129855}}
[[14378 12137 13289]
 [ 8677 22209 18433]
 [ 7814 11238 21680]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0401398
{'0': {'precision': 0.4825970548862115, 'recall': 0.4170968316126735, 'f1-score': 0.4474626438153435, 'support': 22472}, '1': {'precision': 0.4391810144253141, 'recall': 0.4222629859961523, 'f1-score': 0.43055587235692616, 'support': 22351}, '2': {'precision': 0.45244324740284725, 'recall': 0.532587526608995, 'f1-score': 0.4892550292288169, 'support': 22079}, 'accuracy': 0.45693701234641715, 'macro avg': {'precision': 0.4580737722381243, 'recall': 0.4573157814059403, 'f1-score': 0.4557578484670288, 'support': 66902}, 'weighted avg': {'precision': 0.4581410171628741, 'recall': 0.45693701234641715, 'f1-score': 0.45560665787586474, 'support': 66902}}
[[ 9373  6255  6844]
 [ 5526  9438  7387]
 [ 4523  5797 11759]]
Evaluating performance on  val set...
73/73 - 1s - 769ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0755538
{'0': {'precision': 0.44356067016415635, 'recall': 0.4051004636785162, 'f1-score': 0.42345908393246623, 'support': 6470}, '1': {'precision': 0.3525916820323704, 'recall': 0.3081468218442256, 'f1-score': 0.3288744506019491, 'support': 5585}, '2': {'precision': 0.44003560981813555, 'recall': 0.5244013337374962, 'f1-score': 0.4785284558467603, 'support': 6598}, 'accuracy': 0.4182705194874819, 'macro avg': {'precision': 0.41206265400488745, 'recall': 0.4125495397534127, 'f1-score': 0.4102873301270586, 'support': 18653}, 'weighted avg': {'precision': 0.415076236192191, 'recall': 0.4182705194874819, 'f1-score': 0.414618282921346, 'support': 18653}}
[[2621 1637 2212]
 [1673 1721 2191]
 [1615 1523 3460]]
training model: results/XRAY/W9/deepOF_L2/h50
Epoch 1/50
262/262 - 8s - loss: 3.3363 - accuracy50: 0.3467 - val_loss: 3.3178 - val_accuracy50: 0.3632 - 8s/epoch - 31ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2904 - accuracy50: 0.3693 - val_loss: 3.2928 - val_accuracy50: 0.3798 - 6s/epoch - 24ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2678 - accuracy50: 0.3843 - val_loss: 3.2805 - val_accuracy50: 0.3880 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2454 - accuracy50: 0.3992 - val_loss: 3.2706 - val_accuracy50: 0.3915 - 6s/epoch - 24ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2288 - accuracy50: 0.4048 - val_loss: 3.2685 - val_accuracy50: 0.3974 - 6s/epoch - 24ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2153 - accuracy50: 0.4155 - val_loss: 3.2689 - val_accuracy50: 0.3975 - 6s/epoch - 23ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2027 - accuracy50: 0.4232 - val_loss: 3.2699 - val_accuracy50: 0.3962 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1921 - accuracy50: 0.4279 - val_loss: 3.2695 - val_accuracy50: 0.3981 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.1801 - accuracy50: 0.4325 - val_loss: 3.2675 - val_accuracy50: 0.4024 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1692 - accuracy50: 0.4383 - val_loss: 3.2659 - val_accuracy50: 0.3980 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1587 - accuracy50: 0.4452 - val_loss: 3.2666 - val_accuracy50: 0.4003 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1486 - accuracy50: 0.4469 - val_loss: 3.2691 - val_accuracy50: 0.3963 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1386 - accuracy50: 0.4488 - val_loss: 3.2665 - val_accuracy50: 0.4049 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1277 - accuracy50: 0.4545 - val_loss: 3.2709 - val_accuracy50: 0.4011 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1210 - accuracy50: 0.4548 - val_loss: 3.2734 - val_accuracy50: 0.4014 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1108 - accuracy50: 0.4611 - val_loss: 3.2746 - val_accuracy50: 0.4033 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1023 - accuracy50: 0.4629 - val_loss: 3.2767 - val_accuracy50: 0.4023 - 6s/epoch - 24ms/step
Epoch 18/50
262/262 - 6s - loss: 3.0928 - accuracy50: 0.4674 - val_loss: 3.2776 - val_accuracy50: 0.4054 - 6s/epoch - 24ms/step
Epoch 19/50
262/262 - 6s - loss: 3.0830 - accuracy50: 0.4686 - val_loss: 3.2886 - val_accuracy50: 0.4023 - 6s/epoch - 25ms/step
Epoch 20/50
262/262 - 6s - loss: 3.0711 - accuracy50: 0.4741 - val_loss: 3.2883 - val_accuracy50: 0.4012 - 6s/epoch - 24ms/step
testing model: results/XRAY/W9/deepOF_L2/h50
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901504
{'0': {'precision': 0.44941485289292354, 'recall': 0.38180635569596727, 'f1-score': 0.41286109017834716, 'support': 43048}, '1': {'precision': 0.33162673220015015, 'recall': 0.11651556578884252, 'f1-score': 0.17244378183625295, 'support': 41694}, '2': {'precision': 0.3811201261540809, 'recall': 0.6643096225034912, 'f1-score': 0.4843592167890939, 'support': 45113}, 'accuracy': 0.39477109083208195, 'macro avg': {'precision': 0.3873872370823848, 'recall': 0.38754384799610037, 'f1-score': 0.35655469626789804, 'support': 129855}, 'weighted avg': {'precision': 0.3878689908811882, 'recall': 0.39477109083208195, 'f1-score': 0.3605068160400802, 'support': 129855}}
[[16436  4809 21803]
 [ 9974  4858 26862]
 [10162  4982 29969]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0652608
{'0': {'precision': 0.4446322521699406, 'recall': 0.4296561161877014, 'f1-score': 0.43701591720360106, 'support': 22653}, '1': {'precision': 0.4968152866242038, 'recall': 0.15632686526373327, 'f1-score': 0.23782135680133049, 'support': 21954}, '2': {'precision': 0.4011652319966408, 'recall': 0.6856245795021305, 'f1-score': 0.5061673206510041, 'support': 22295}, 'accuracy': 0.4252638187199187, 'macro avg': {'precision': 0.44753759026359513, 'recall': 0.42386918698452175, 'f1-score': 0.39366819821864524, 'support': 66902}, 'weighted avg': {'precision': 0.44727087468713256, 'recall': 0.4252638187199187, 'f1-score': 0.3946945091857302, 'support': 66902}}
[[ 9733  1829 11091]
 [ 6795  3432 11727]
 [ 5362  1647 15286]]
Evaluating performance on  val set...
73/73 - 1s - 751ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0886366
{'0': {'precision': 0.41226521110932735, 'recall': 0.40162652486706285, 'f1-score': 0.40687633684544083, 'support': 6394}, '1': {'precision': 0.4330357142857143, 'recall': 0.11463785243964207, 'f1-score': 0.1812842077159258, 'support': 5923}, '2': {'precision': 0.387343404568902, 'recall': 0.6636679292929293, 'f1-score': 0.4891810144253141, 'support': 6336}, 'accuracy': 0.3995067817509248, 'macro avg': {'precision': 0.41088144332131454, 'recall': 0.3933107688665447, 'f1-score': 0.35911385299556026, 'support': 18653}, 'weighted avg': {'precision': 0.4103952236581723, 'recall': 0.3995067817509248, 'f1-score': 0.3631997302037189, 'support': 18653}}
[[2568  469 3357]
 [1950  679 3294]
 [1711  420 4205]]
training model: results/XRAY/W9/deepOF_L2/h100
Epoch 1/50
262/262 - 8s - loss: 3.3405 - accuracy100: 0.3406 - val_loss: 3.3185 - val_accuracy100: 0.3476 - 8s/epoch - 31ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3023 - accuracy100: 0.3575 - val_loss: 3.3071 - val_accuracy100: 0.3557 - 6s/epoch - 24ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2837 - accuracy100: 0.3715 - val_loss: 3.2991 - val_accuracy100: 0.3632 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2671 - accuracy100: 0.3830 - val_loss: 3.2935 - val_accuracy100: 0.3659 - 6s/epoch - 24ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2550 - accuracy100: 0.3910 - val_loss: 3.2944 - val_accuracy100: 0.3704 - 6s/epoch - 23ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2420 - accuracy100: 0.3975 - val_loss: 3.2917 - val_accuracy100: 0.3658 - 6s/epoch - 24ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2341 - accuracy100: 0.4033 - val_loss: 3.2913 - val_accuracy100: 0.3733 - 6s/epoch - 24ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2235 - accuracy100: 0.4079 - val_loss: 3.2910 - val_accuracy100: 0.3720 - 6s/epoch - 24ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2153 - accuracy100: 0.4125 - val_loss: 3.2957 - val_accuracy100: 0.3717 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2086 - accuracy100: 0.4148 - val_loss: 3.2922 - val_accuracy100: 0.3730 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2002 - accuracy100: 0.4190 - val_loss: 3.2939 - val_accuracy100: 0.3755 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1925 - accuracy100: 0.4248 - val_loss: 3.2977 - val_accuracy100: 0.3739 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1853 - accuracy100: 0.4270 - val_loss: 3.2943 - val_accuracy100: 0.3733 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1789 - accuracy100: 0.4300 - val_loss: 3.3047 - val_accuracy100: 0.3743 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1713 - accuracy100: 0.4334 - val_loss: 3.3029 - val_accuracy100: 0.3733 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1645 - accuracy100: 0.4379 - val_loss: 3.3067 - val_accuracy100: 0.3722 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1562 - accuracy100: 0.4411 - val_loss: 3.3067 - val_accuracy100: 0.3752 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 3.1484 - accuracy100: 0.4429 - val_loss: 3.3167 - val_accuracy100: 0.3707 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h100
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871019
{'0': {'precision': 0.40893792720585687, 'recall': 0.28397262914417887, 'f1-score': 0.33518663348738004, 'support': 41504}, '1': {'precision': 0.3856621534054091, 'recall': 0.24664645451174558, 'f1-score': 0.300872711792252, 'support': 45847}, '2': {'precision': 0.35399439432181057, 'recall': 0.597261434217956, 'f1-score': 0.4445222690142448, 'support': 42504}, 'accuracy': 0.37333949405105693, 'macro avg': {'precision': 0.3828648249776922, 'recall': 0.37596017262462683, 'f1-score': 0.3601938714312923, 'support': 129855}, 'weighted avg': {'precision': 0.3827360533994371, 'recall': 0.37333949405105693, 'f1-score': 0.3588592797811486, 'support': 129855}}
[[11786  9193 20525]
 [ 8737 11308 25802]
 [ 8298  8820 25386]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.072621
{'0': {'precision': 0.43081525804038895, 'recall': 0.33346693386773546, 'f1-score': 0.3759413595742544, 'support': 22455}, '1': {'precision': 0.43450523542056724, 'recall': 0.2823412787815978, 'f1-score': 0.3422734473152346, 'support': 22193}, '2': {'precision': 0.3945584045584046, 'recall': 0.6223150894221263, 'f1-score': 0.4829305715381665, 'support': 22254}, 'accuracy': 0.4125885623748169, 'macro avg': {'precision': 0.41995963267312025, 'recall': 0.41270776735715325, 'f1-score': 0.40038179280921854, 'support': 66902}, 'weighted avg': {'precision': 0.4199789848439257, 'recall': 0.4125885623748169, 'f1-score': 0.40036134621561753, 'support': 66902}}
[[ 7488  4270 10697]
 [ 5373  6266 10554]
 [ 4520  3885 13849]]
Evaluating performance on  val set...
73/73 - 1s - 868ms/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095506
{'0': {'precision': 0.39415181253755255, 'recall': 0.3066853669939224, 'f1-score': 0.34496056091148114, 'support': 6417}, '1': {'precision': 0.36281902552204176, 'recall': 0.20853475579263211, 'f1-score': 0.26484598285169897, 'support': 5999}, '2': {'precision': 0.36339600470035255, 'recall': 0.594997594997595, 'f1-score': 0.4512128396863031, 'support': 6237}, 'accuracy': 0.371522007183831, 'macro avg': {'precision': 0.37345561425331564, 'recall': 0.3700725725947165, 'f1-score': 0.3536731278164944, 'support': 18653}, 'weighted avg': {'precision': 0.3737910468276579, 'recall': 0.371522007183831, 'f1-score': 0.3547224281145011, 'support': 18653}}
[[1968 1147 3302]
 [1549 1251 3199]
 [1476 1050 3711]]
training model: results/XRAY/W9/deepOF_L2/h200
Epoch 1/50
262/262 - 8s - loss: 3.3473 - accuracy200: 0.3443 - val_loss: 3.3718 - val_accuracy200: 0.3299 - 8s/epoch - 32ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3175 - accuracy200: 0.3521 - val_loss: 3.3567 - val_accuracy200: 0.3377 - 6s/epoch - 25ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2973 - accuracy200: 0.3629 - val_loss: 3.3434 - val_accuracy200: 0.3403 - 6s/epoch - 24ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2801 - accuracy200: 0.3746 - val_loss: 3.3431 - val_accuracy200: 0.3389 - 6s/epoch - 24ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2672 - accuracy200: 0.3769 - val_loss: 3.3415 - val_accuracy200: 0.3409 - 6s/epoch - 24ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2540 - accuracy200: 0.3853 - val_loss: 3.3324 - val_accuracy200: 0.3441 - 6s/epoch - 24ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2448 - accuracy200: 0.3923 - val_loss: 3.3439 - val_accuracy200: 0.3432 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2319 - accuracy200: 0.4009 - val_loss: 3.3354 - val_accuracy200: 0.3471 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2241 - accuracy200: 0.4041 - val_loss: 3.3401 - val_accuracy200: 0.3437 - 6s/epoch - 24ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2161 - accuracy200: 0.4090 - val_loss: 3.3353 - val_accuracy200: 0.3468 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2088 - accuracy200: 0.4129 - val_loss: 3.3426 - val_accuracy200: 0.3480 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1961 - accuracy200: 0.4205 - val_loss: 3.3398 - val_accuracy200: 0.3522 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1913 - accuracy200: 0.4215 - val_loss: 3.3391 - val_accuracy200: 0.3528 - 6s/epoch - 24ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1847 - accuracy200: 0.4229 - val_loss: 3.3467 - val_accuracy200: 0.3537 - 6s/epoch - 24ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1767 - accuracy200: 0.4269 - val_loss: 3.3489 - val_accuracy200: 0.3509 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1685 - accuracy200: 0.4308 - val_loss: 3.3445 - val_accuracy200: 0.3570 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h200
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986567
{'0': {'precision': 0.36860975063222257, 'recall': 0.26687216093445815, 'f1-score': 0.30959710702138815, 'support': 43148}, '1': {'precision': 0.3774931084806227, 'recall': 0.053908855131530195, 'f1-score': 0.09434459281473527, 'support': 43184}, '2': {'precision': 0.3391058854070893, 'recall': 0.7203088022424925, 'f1-score': 0.4611243491307034, 'support': 43523}, 'accuracy': 0.34802664510415465, 'macro avg': {'precision': 0.3617362481733115, 'recall': 0.3470299394361603, 'f1-score': 0.28835534965560894, 'support': 129855}, 'weighted avg': {'precision': 0.36167526369780983, 'recall': 0.34802664510415465, 'f1-score': 0.28880049221890564, 'support': 129855}}
[[11515  2012 29621]
 [ 9378  2328 31478]
 [10346  1827 31350]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957648
{'0': {'precision': 0.383876583228285, 'recall': 0.28458902585554713, 'f1-score': 0.3268591873243036, 'support': 22471}, '1': {'precision': 0.4583333333333333, 'recall': 0.05999181929736854, 'f1-score': 0.10609653176867741, 'support': 22003}, '2': {'precision': 0.35173025357346455, 'recall': 0.742776886035313, 'f1-score': 0.47739679901419957, 'support': 22428}, 'accuracy': 0.3643239365041404, 'macro avg': {'precision': 0.3979800567116943, 'recall': 0.36245257706274286, 'f1-score': 0.3034508393690602, 'support': 66902}, 'weighted avg': {'precision': 0.39758759322892867, 'recall': 0.3643239365041404, 'f1-score': 0.30471959276495625, 'support': 66902}}
[[ 6395   773 15303]
 [ 5282  1320 15401]
 [ 4982   787 16659]]
Evaluating performance on  val set...
73/73 - 1s - 901ms/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096201
{'0': {'precision': 0.37309322033898307, 'recall': 0.26738536289098086, 'f1-score': 0.3115160091986556, 'support': 6586}, '1': {'precision': 0.42016806722689076, 'recall': 0.04171533455698315, 'f1-score': 0.0758955676988464, 'support': 5993}, '2': {'precision': 0.3325835957414905, 'recall': 0.7303259795851169, 'f1-score': 0.4570368844014012, 'support': 6074}, 'accuracy': 0.3456280491073822, 'macro avg': {'precision': 0.3752816277691214, 'recall': 0.34647555901102695, 'f1-score': 0.28148282043296774, 'support': 18653}, 'weighted avg': {'precision': 0.3750266411074418, 'recall': 0.3456280491073822, 'f1-score': 0.2831999469069663, 'support': 18653}}
[[1761  188 4637]
 [1478  250 4265]
 [1481  157 4436]]
training model: results/XRAY/W9/deepOF_L2/h300
Epoch 1/50
262/262 - 8s - loss: 3.3499 - accuracy300: 0.3375 - val_loss: 3.3284 - val_accuracy300: 0.3403 - 8s/epoch - 32ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3116 - accuracy300: 0.3523 - val_loss: 3.3194 - val_accuracy300: 0.3479 - 6s/epoch - 24ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2955 - accuracy300: 0.3609 - val_loss: 3.3057 - val_accuracy300: 0.3487 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2823 - accuracy300: 0.3701 - val_loss: 3.3012 - val_accuracy300: 0.3513 - 6s/epoch - 23ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2697 - accuracy300: 0.3780 - val_loss: 3.2948 - val_accuracy300: 0.3609 - 6s/epoch - 24ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2584 - accuracy300: 0.3864 - val_loss: 3.2914 - val_accuracy300: 0.3642 - 6s/epoch - 23ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2502 - accuracy300: 0.3894 - val_loss: 3.2903 - val_accuracy300: 0.3603 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2409 - accuracy300: 0.3947 - val_loss: 3.2890 - val_accuracy300: 0.3669 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2324 - accuracy300: 0.4021 - val_loss: 3.2902 - val_accuracy300: 0.3643 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2242 - accuracy300: 0.4066 - val_loss: 3.2971 - val_accuracy300: 0.3609 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2174 - accuracy300: 0.4095 - val_loss: 3.2933 - val_accuracy300: 0.3661 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.2112 - accuracy300: 0.4123 - val_loss: 3.2978 - val_accuracy300: 0.3635 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.2050 - accuracy300: 0.4154 - val_loss: 3.2936 - val_accuracy300: 0.3631 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1967 - accuracy300: 0.4190 - val_loss: 3.3038 - val_accuracy300: 0.3594 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1917 - accuracy300: 0.4220 - val_loss: 3.3036 - val_accuracy300: 0.3620 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1818 - accuracy300: 0.4259 - val_loss: 3.3060 - val_accuracy300: 0.3616 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1758 - accuracy300: 0.4293 - val_loss: 3.3086 - val_accuracy300: 0.3602 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 3.1714 - accuracy300: 0.4284 - val_loss: 3.3175 - val_accuracy300: 0.3555 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h300
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0824051
{'0': {'precision': 0.3735785301189161, 'recall': 0.1414268142681427, 'f1-score': 0.20517853637645211, 'support': 40650}, '1': {'precision': 0.43017475673468236, 'recall': 0.6602831514103534, 'f1-score': 0.5209502208427839, 'support': 46265}, '2': {'precision': 0.37976664442040825, 'recall': 0.3843036795528645, 'f1-score': 0.38202169157223387, 'support': 42940}, 'accuracy': 0.40659966886142235, 'macro avg': {'precision': 0.39450664375800226, 'recall': 0.39533788174378687, 'f1-score': 0.36938348293049, 'support': 129855}, 'weighted avg': {'precision': 0.39578901144412115, 'recall': 0.40659966886142235, 'f1-score': 0.37616018564634324, 'support': 129855}}
[[ 5749 19514 15387]
 [ 4153 30548 11564]
 [ 5487 20951 16502]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0810236
{'0': {'precision': 0.40662836035296535, 'recall': 0.17764927380311996, 'f1-score': 0.24727023148437008, 'support': 22308}, '1': {'precision': 0.3979964422806853, 'recall': 0.575366568914956, 'f1-score': 0.47052095631641083, 'support': 22165}, '2': {'precision': 0.39222713335722537, 'recall': 0.439163582861474, 'f1-score': 0.4143704513903496, 'support': 22429}, 'accuracy': 0.397088278377328, 'macro avg': {'precision': 0.398950645330292, 'recall': 0.39739314185985, 'f1-score': 0.37738721306371015, 'support': 66902}, 'weighted avg': {'precision': 0.3989405246476122, 'recall': 0.397088278377328, 'f1-score': 0.3772550323598805, 'support': 66902}}
[[ 3963  9841  8504]
 [ 2653 12753  6759]
 [ 3130  9449  9850]]
Evaluating performance on  val set...
73/73 - 1s - 764ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948559
{'0': {'precision': 0.3770221195113899, 'recall': 0.17713665270668527, 'f1-score': 0.24102997045166738, 'support': 6447}, '1': {'precision': 0.3822820154841985, 'recall': 0.48824769006321933, 'f1-score': 0.42881548974943057, 'support': 6169}, '2': {'precision': 0.3513234344738541, 'recall': 0.4507205565678317, 'f1-score': 0.39486286460600784, 'support': 6037}, 'accuracy': 0.3685734198252292, 'macro avg': {'precision': 0.3702091898231475, 'recall': 0.3720349664459121, 'f1-score': 0.3549027749357019, 'support': 18653}, 'weighted avg': {'precision': 0.3704443752710346, 'recall': 0.3685734198252292, 'f1-score': 0.35292285902496145, 'support': 18653}}
[[1142 2533 2772]
 [ 905 3012 2252]
 [ 982 2334 2721]]
training model: results/XRAY/W9/deepOF_L2/h500
Epoch 1/50
262/262 - 8s - loss: 3.3515 - accuracy500: 0.3369 - val_loss: 3.3428 - val_accuracy500: 0.3317 - 8s/epoch - 31ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3217 - accuracy500: 0.3467 - val_loss: 3.3369 - val_accuracy500: 0.3329 - 6s/epoch - 23ms/step
Epoch 3/50
262/262 - 6s - loss: 3.3045 - accuracy500: 0.3542 - val_loss: 3.3287 - val_accuracy500: 0.3310 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2931 - accuracy500: 0.3594 - val_loss: 3.3267 - val_accuracy500: 0.3290 - 6s/epoch - 23ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2832 - accuracy500: 0.3676 - val_loss: 3.3215 - val_accuracy500: 0.3335 - 6s/epoch - 24ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2754 - accuracy500: 0.3717 - val_loss: 3.3180 - val_accuracy500: 0.3391 - 6s/epoch - 23ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2679 - accuracy500: 0.3755 - val_loss: 3.3183 - val_accuracy500: 0.3420 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2602 - accuracy500: 0.3794 - val_loss: 3.3191 - val_accuracy500: 0.3419 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2534 - accuracy500: 0.3849 - val_loss: 3.3164 - val_accuracy500: 0.3427 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2466 - accuracy500: 0.3895 - val_loss: 3.3144 - val_accuracy500: 0.3485 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2435 - accuracy500: 0.3916 - val_loss: 3.3092 - val_accuracy500: 0.3520 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.2333 - accuracy500: 0.3966 - val_loss: 3.3167 - val_accuracy500: 0.3477 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.2319 - accuracy500: 0.3971 - val_loss: 3.3139 - val_accuracy500: 0.3545 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.2233 - accuracy500: 0.4032 - val_loss: 3.3108 - val_accuracy500: 0.3546 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.2188 - accuracy500: 0.4050 - val_loss: 3.3143 - val_accuracy500: 0.3553 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.2122 - accuracy500: 0.4062 - val_loss: 3.3170 - val_accuracy500: 0.3573 - 6s/epoch - 24ms/step
Epoch 17/50
262/262 - 6s - loss: 3.2056 - accuracy500: 0.4114 - val_loss: 3.3186 - val_accuracy500: 0.3589 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 3.2006 - accuracy500: 0.4118 - val_loss: 3.3222 - val_accuracy500: 0.3553 - 6s/epoch - 23ms/step
Epoch 19/50
262/262 - 6s - loss: 3.1940 - accuracy500: 0.4168 - val_loss: 3.3267 - val_accuracy500: 0.3564 - 6s/epoch - 23ms/step
Epoch 20/50
262/262 - 6s - loss: 3.1875 - accuracy500: 0.4193 - val_loss: 3.3398 - val_accuracy500: 0.3553 - 6s/epoch - 23ms/step
Epoch 21/50
262/262 - 6s - loss: 3.1815 - accuracy500: 0.4221 - val_loss: 3.3330 - val_accuracy500: 0.3540 - 6s/epoch - 24ms/step
testing model: results/XRAY/W9/deepOF_L2/h500
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0918959
{'0': {'precision': 0.3367791754888529, 'recall': 0.13147274760538727, 'f1-score': 0.18911735907119878, 'support': 41134}, '1': {'precision': 0.4052961352009044, 'recall': 0.47911570173054274, 'f1-score': 0.4391251544058877, 'support': 44148}, '2': {'precision': 0.37775938189845476, 'recall': 0.5221322325174433, 'f1-score': 0.43836467917989097, 'support': 44573}, 'accuracy': 0.3837588079011205, 'macro avg': {'precision': 0.37327823086273737, 'recall': 0.37757356061779107, 'f1-score': 0.3555357308856591, 'support': 129855}, 'weighted avg': {'precision': 0.3741400586097403, 'recall': 0.3837588079011205, 'f1-score': 0.3596694744894775, 'support': 129855}}
[[ 5408 15248 20478]
 [ 5139 21152 17857]
 [ 5511 15789 23273]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0795307
{'0': {'precision': 0.41883226459669254, 'recall': 0.16467622080679406, 'f1-score': 0.23640346699685685, 'support': 22608}, '1': {'precision': 0.40364880273660203, 'recall': 0.4154929577464789, 'f1-score': 0.40948525159051474, 'support': 22152}, '2': {'precision': 0.37857487716906646, 'recall': 0.6020233041279017, 'f1-score': 0.46484054888148835, 'support': 22142}, 'accuracy': 0.39246958237421903, 'macro avg': {'precision': 0.400351981500787, 'recall': 0.3940641608937249, 'f1-score': 0.3702430891562867, 'support': 66902}, 'weighted avg': {'precision': 0.40048119707184693, 'recall': 0.39246958237421903, 'f1-score': 0.3693167066519975, 'support': 66902}}
[[ 3723  7252 11633]
 [ 2700  9204 10248]
 [ 2466  6346 13330]]
Evaluating performance on  val set...
73/73 - 1s - 767ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056788
{'0': {'precision': 0.33605919003115264, 'recall': 0.13657224244342459, 'f1-score': 0.19421627095757849, 'support': 6319}, '1': {'precision': 0.3860571028201086, 'recall': 0.34708661417322834, 'f1-score': 0.36553611410564724, 'support': 6350}, '2': {'precision': 0.3329799537393986, 'recall': 0.5773729946524064, 'f1-score': 0.4223716381418093, 'support': 5984}, 'accuracy': 0.34964885005093016, 'macro avg': {'precision': 0.35169874886355323, 'recall': 0.3536772837563531, 'f1-score': 0.32737467440167833, 'support': 18653}, 'weighted avg': {'precision': 0.3520920317316842, 'recall': 0.34964885005093016, 'f1-score': 0.32573199074638853, 'support': 18653}}
[[ 863 1793 3663]
 [ 888 2204 3258]
 [ 817 1712 3455]]
training model: results/XRAY/W9/deepOF_L2/h1000
Epoch 1/50
262/262 - 8s - loss: 3.3584 - accuracy1000: 0.3381 - val_loss: 3.3578 - val_accuracy1000: 0.3405 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3278 - accuracy1000: 0.3469 - val_loss: 3.3504 - val_accuracy1000: 0.3380 - 6s/epoch - 24ms/step
Epoch 3/50
262/262 - 6s - loss: 3.3089 - accuracy1000: 0.3511 - val_loss: 3.3406 - val_accuracy1000: 0.3402 - 6s/epoch - 23ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2953 - accuracy1000: 0.3600 - val_loss: 3.3331 - val_accuracy1000: 0.3406 - 6s/epoch - 23ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2838 - accuracy1000: 0.3665 - val_loss: 3.3310 - val_accuracy1000: 0.3368 - 6s/epoch - 23ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2739 - accuracy1000: 0.3719 - val_loss: 3.3311 - val_accuracy1000: 0.3403 - 6s/epoch - 23ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2679 - accuracy1000: 0.3765 - val_loss: 3.3271 - val_accuracy1000: 0.3410 - 6s/epoch - 23ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2603 - accuracy1000: 0.3780 - val_loss: 3.3215 - val_accuracy1000: 0.3418 - 6s/epoch - 23ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2537 - accuracy1000: 0.3831 - val_loss: 3.3235 - val_accuracy1000: 0.3428 - 6s/epoch - 23ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2462 - accuracy1000: 0.3876 - val_loss: 3.3270 - val_accuracy1000: 0.3400 - 6s/epoch - 23ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2401 - accuracy1000: 0.3898 - val_loss: 3.3232 - val_accuracy1000: 0.3403 - 6s/epoch - 23ms/step
Epoch 12/50
262/262 - 6s - loss: 3.2343 - accuracy1000: 0.3939 - val_loss: 3.3221 - val_accuracy1000: 0.3453 - 6s/epoch - 23ms/step
Epoch 13/50
262/262 - 6s - loss: 3.2291 - accuracy1000: 0.3957 - val_loss: 3.3220 - val_accuracy1000: 0.3418 - 6s/epoch - 23ms/step
Epoch 14/50
262/262 - 6s - loss: 3.2239 - accuracy1000: 0.3993 - val_loss: 3.3262 - val_accuracy1000: 0.3449 - 6s/epoch - 23ms/step
Epoch 15/50
262/262 - 6s - loss: 3.2169 - accuracy1000: 0.4018 - val_loss: 3.3286 - val_accuracy1000: 0.3471 - 6s/epoch - 23ms/step
Epoch 16/50
262/262 - 6s - loss: 3.2113 - accuracy1000: 0.4040 - val_loss: 3.3288 - val_accuracy1000: 0.3443 - 6s/epoch - 23ms/step
Epoch 17/50
262/262 - 6s - loss: 3.2042 - accuracy1000: 0.4074 - val_loss: 3.3328 - val_accuracy1000: 0.3456 - 6s/epoch - 23ms/step
Epoch 18/50
262/262 - 6s - loss: 3.1999 - accuracy1000: 0.4110 - val_loss: 3.3349 - val_accuracy1000: 0.3483 - 6s/epoch - 23ms/step
testing model: results/XRAY/W9/deepOF_L2/h1000
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969054
{'0': {'precision': 0.3342251492076559, 'recall': 0.07769963159657432, 'f1-score': 0.12608695652173912, 'support': 41802}, '1': {'precision': 0.30828025477707005, 'recall': 0.13562948998828145, 'f1-score': 0.18838015710140826, 'support': 39254}, '2': {'precision': 0.3778957294370401, 'recall': 0.7965941925039447, 'f1-score': 0.5126132422560099, 'support': 48799}, 'accuracy': 0.3653690654961303, 'macro avg': {'precision': 0.3401337111405887, 'recall': 0.3366411046962668, 'f1-score': 0.2756934519597191, 'support': 129855}, 'weighted avg': {'precision': 0.34279347355893625, 'recall': 0.3653690654961303, 'f1-score': 0.2901726945610985, 'support': 129855}}
[[ 3248  5964 32590]
 [ 2526  5324 31404]
 [ 3944  5982 38873]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0934786
{'0': {'precision': 0.4066294083638466, 'recall': 0.09020563464580394, 'f1-score': 0.1476557032890133, 'support': 23391}, '1': {'precision': 0.41212417501833293, 'recall': 0.1582875651316716, 'f1-score': 0.2287264710869934, 'support': 21303}, '2': {'precision': 0.3446040611981842, 'recall': 0.830646613832853, 'f1-score': 0.48712024188330977, 'support': 22208}, 'accuracy': 0.35767241637021313, 'macro avg': {'precision': 0.3877858815267879, 'recall': 0.3597132712034428, 'f1-score': 0.28783413875310554, 'support': 66902}, 'weighted avg': {'precision': 0.38778985355510387, 'recall': 0.35767241637021313, 'f1-score': 0.2861549864121263, 'support': 66902}}
[[ 2110  2588 18693]
 [ 1540  3372 16391]
 [ 1539  2222 18447]]
Evaluating performance on  val set...
73/73 - 1s - 865ms/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067406
{'0': {'precision': 0.37262124002455493, 'recall': 0.09341335795629424, 'f1-score': 0.14937861449489356, 'support': 6498}, '1': {'precision': 0.36470588235294116, 'recall': 0.10979929161747344, 'f1-score': 0.16878402903811252, 'support': 5929}, '2': {'precision': 0.33578318787322003, 'recall': 0.8218760038548024, 'f1-score': 0.47677614721639877, 'support': 6226}, 'accuracy': 0.3417680802015762, 'macro avg': {'precision': 0.3577034367502387, 'recall': 0.34169621780952336, 'f1-score': 0.2649795969164683, 'support': 18653}, 'weighted avg': {'precision': 0.3578094741783528, 'recall': 0.3417680802015762, 'f1-score': 0.26482555287214316, 'support': 18653}}
[[ 607  552 5339]
 [ 495  651 4783]
 [ 527  582 5117]]
training model: results/XRAY/W9/deepVOL_L2/h10
Epoch 1/50
262/262 - 8s - loss: 3.2727 - accuracy10: 0.3901 - val_loss: 3.2793 - val_accuracy10: 0.4003 - 8s/epoch - 32ms/step
Epoch 2/50
262/262 - 6s - loss: 3.1500 - accuracy10: 0.4415 - val_loss: 3.1920 - val_accuracy10: 0.4386 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.1065 - accuracy10: 0.4586 - val_loss: 3.1764 - val_accuracy10: 0.4460 - 6s/epoch - 22ms/step
Epoch 4/50
262/262 - 6s - loss: 3.0721 - accuracy10: 0.4711 - val_loss: 3.1598 - val_accuracy10: 0.4585 - 6s/epoch - 22ms/step
Epoch 5/50
262/262 - 6s - loss: 3.0479 - accuracy10: 0.4787 - val_loss: 3.1689 - val_accuracy10: 0.4585 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.0307 - accuracy10: 0.4835 - val_loss: 3.1511 - val_accuracy10: 0.4659 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.0185 - accuracy10: 0.4900 - val_loss: 3.1282 - val_accuracy10: 0.4727 - 6s/epoch - 22ms/step
Epoch 8/50
262/262 - 6s - loss: 3.0019 - accuracy10: 0.4945 - val_loss: 3.1147 - val_accuracy10: 0.4760 - 6s/epoch - 22ms/step
Epoch 9/50
262/262 - 6s - loss: 2.9948 - accuracy10: 0.4975 - val_loss: 3.1097 - val_accuracy10: 0.4826 - 6s/epoch - 22ms/step
Epoch 10/50
262/262 - 6s - loss: 2.9825 - accuracy10: 0.4999 - val_loss: 3.0958 - val_accuracy10: 0.4800 - 6s/epoch - 22ms/step
Epoch 11/50
262/262 - 6s - loss: 2.9760 - accuracy10: 0.5017 - val_loss: 3.0951 - val_accuracy10: 0.4790 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 2.9683 - accuracy10: 0.5042 - val_loss: 3.0864 - val_accuracy10: 0.4842 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 6s - loss: 2.9618 - accuracy10: 0.5048 - val_loss: 3.0780 - val_accuracy10: 0.4815 - 6s/epoch - 22ms/step
Epoch 14/50
262/262 - 6s - loss: 2.9563 - accuracy10: 0.5067 - val_loss: 3.0793 - val_accuracy10: 0.4835 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 2.9478 - accuracy10: 0.5085 - val_loss: 3.0788 - val_accuracy10: 0.4783 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 6s - loss: 2.9409 - accuracy10: 0.5103 - val_loss: 3.0848 - val_accuracy10: 0.4743 - 6s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 2.9351 - accuracy10: 0.5128 - val_loss: 3.0889 - val_accuracy10: 0.4765 - 6s/epoch - 21ms/step
Epoch 18/50
262/262 - 6s - loss: 2.9289 - accuracy10: 0.5146 - val_loss: 3.0776 - val_accuracy10: 0.4834 - 6s/epoch - 21ms/step
Epoch 19/50
262/262 - 5s - loss: 2.9166 - accuracy10: 0.5180 - val_loss: 3.0847 - val_accuracy10: 0.4755 - 5s/epoch - 21ms/step
Epoch 20/50
262/262 - 6s - loss: 2.9155 - accuracy10: 0.5174 - val_loss: 3.0915 - val_accuracy10: 0.4767 - 6s/epoch - 21ms/step
Epoch 21/50
262/262 - 6s - loss: 2.9080 - accuracy10: 0.5192 - val_loss: 3.1028 - val_accuracy10: 0.4702 - 6s/epoch - 22ms/step
Epoch 22/50
262/262 - 6s - loss: 2.8985 - accuracy10: 0.5225 - val_loss: 3.1013 - val_accuracy10: 0.4724 - 6s/epoch - 21ms/step
Epoch 23/50
262/262 - 6s - loss: 2.8923 - accuracy10: 0.5248 - val_loss: 3.0984 - val_accuracy10: 0.4726 - 6s/epoch - 22ms/step
Epoch 24/50
262/262 - 6s - loss: 2.8874 - accuracy10: 0.5243 - val_loss: 3.1037 - val_accuracy10: 0.4689 - 6s/epoch - 22ms/step
Epoch 25/50
262/262 - 6s - loss: 2.8807 - accuracy10: 0.5280 - val_loss: 3.0969 - val_accuracy10: 0.4742 - 6s/epoch - 22ms/step
Epoch 26/50
262/262 - 6s - loss: 2.8758 - accuracy10: 0.5291 - val_loss: 3.1164 - val_accuracy10: 0.4683 - 6s/epoch - 21ms/step
Epoch 27/50
262/262 - 6s - loss: 2.8706 - accuracy10: 0.5304 - val_loss: 3.1184 - val_accuracy10: 0.4619 - 6s/epoch - 21ms/step
Epoch 28/50
262/262 - 6s - loss: 2.8602 - accuracy10: 0.5327 - val_loss: 3.1092 - val_accuracy10: 0.4717 - 6s/epoch - 22ms/step
testing model: results/XRAY/W9/deepVOL_L2/h10
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9615752
{'0': {'precision': 0.46053559597341254, 'recall': 0.5648674863029858, 'f1-score': 0.5073938023923895, 'support': 38147}, '1': {'precision': 0.6135706648715005, 'recall': 0.5919127478320663, 'f1-score': 0.6025471514680149, 'support': 52354}, '2': {'precision': 0.46969045571797075, 'recall': 0.38861222623100766, 'f1-score': 0.42532187647729486, 'support': 39358}, 'accuracy': 0.5223511654948829, 'macro avg': {'precision': 0.5145989055209612, 'recall': 0.5151308201220199, 'f1-score': 0.511754276779233, 'support': 129859}, 'weighted avg': {'precision': 0.5250079464991121, 'recall': 0.5223511654948829, 'f1-score': 0.5208812894155377, 'support': 129859}}
[[21548  9416  7183]
 [11279 30989 10086]
 [13962 10101 15295]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.984104
{'0': {'precision': 0.47972386587771204, 'recall': 0.5457523672755015, 'f1-score': 0.5106123905695631, 'support': 22283}, '1': {'precision': 0.5459640281518812, 'recall': 0.5471287387348165, 'f1-score': 0.5465457629330028, 'support': 22969}, '2': {'precision': 0.5062587676702277, 'recall': 0.43339491916859124, 'f1-score': 0.46700179175791356, 'support': 21650}, 'accuracy': 0.5098651759289707, 'macro avg': {'precision': 0.5106488872332736, 'recall': 0.5087586750596365, 'f1-score': 0.5080533150868266, 'support': 66902}, 'weighted avg': {'precision': 0.5110525393266875, 'recall': 0.5098651759289707, 'f1-score': 0.5088364222209881, 'support': 66902}}
[[12161  5330  4792]
 [ 6043 12567  4359]
 [ 7146  5121  9383]]
Evaluating performance on  val set...
73/73 - 1s - 678ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0246751
{'0': {'precision': 0.48097238131602393, 'recall': 0.5543494205662315, 'f1-score': 0.5150606514924356, 'support': 6817}, '1': {'precision': 0.4335282651072125, 'recall': 0.436335099077889, 'f1-score': 0.4349271536129853, 'support': 5097}, '2': {'precision': 0.5147344273866243, 'recall': 0.4327893175074184, 'f1-score': 0.47021842508261463, 'support': 6740}, 'accuracy': 0.4781816232443444, 'macro avg': {'precision': 0.4764116912699536, 'recall': 0.47449127905051297, 'f1-score': 0.4734020767293452, 'support': 18654}, 'weighted avg': {'precision': 0.4802075871806929, 'recall': 0.4781816232443444, 'f1-score': 0.47696281485183567, 'support': 18654}}
[[3779 1485 1553]
 [1676 2224 1197]
 [2402 1421 2917]]
training model: results/XRAY/W9/deepVOL_L2/h20
Epoch 1/50
262/262 - 8s - loss: 3.3074 - accuracy20: 0.3747 - val_loss: 3.2978 - val_accuracy20: 0.3737 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2175 - accuracy20: 0.4148 - val_loss: 3.2702 - val_accuracy20: 0.3874 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.1717 - accuracy20: 0.4344 - val_loss: 3.2049 - val_accuracy20: 0.4208 - 6s/epoch - 22ms/step
Epoch 4/50
262/262 - 6s - loss: 3.1390 - accuracy20: 0.4458 - val_loss: 3.1905 - val_accuracy20: 0.4289 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.1212 - accuracy20: 0.4531 - val_loss: 3.1815 - val_accuracy20: 0.4350 - 6s/epoch - 23ms/step
Epoch 6/50
262/262 - 6s - loss: 3.1040 - accuracy20: 0.4626 - val_loss: 3.1743 - val_accuracy20: 0.4410 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.0935 - accuracy20: 0.4659 - val_loss: 3.1673 - val_accuracy20: 0.4445 - 6s/epoch - 21ms/step
Epoch 8/50
262/262 - 5s - loss: 3.0821 - accuracy20: 0.4715 - val_loss: 3.1690 - val_accuracy20: 0.4487 - 5s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.0700 - accuracy20: 0.4732 - val_loss: 3.1484 - val_accuracy20: 0.4566 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.0640 - accuracy20: 0.4755 - val_loss: 3.1710 - val_accuracy20: 0.4476 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 5s - loss: 3.0585 - accuracy20: 0.4787 - val_loss: 3.1703 - val_accuracy20: 0.4456 - 5s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.0481 - accuracy20: 0.4834 - val_loss: 3.1734 - val_accuracy20: 0.4442 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 5s - loss: 3.0400 - accuracy20: 0.4853 - val_loss: 3.1714 - val_accuracy20: 0.4461 - 5s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.0367 - accuracy20: 0.4856 - val_loss: 3.1662 - val_accuracy20: 0.4488 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.0317 - accuracy20: 0.4888 - val_loss: 3.1569 - val_accuracy20: 0.4530 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 6s - loss: 3.0252 - accuracy20: 0.4898 - val_loss: 3.1524 - val_accuracy20: 0.4546 - 6s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.0211 - accuracy20: 0.4920 - val_loss: 3.1599 - val_accuracy20: 0.4511 - 6s/epoch - 21ms/step
Epoch 18/50
262/262 - 5s - loss: 3.0161 - accuracy20: 0.4913 - val_loss: 3.1600 - val_accuracy20: 0.4559 - 5s/epoch - 21ms/step
Epoch 19/50
262/262 - 5s - loss: 3.0079 - accuracy20: 0.4954 - val_loss: 3.1767 - val_accuracy20: 0.4486 - 5s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h20
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0054817
{'0': {'precision': 0.44333560853908255, 'recall': 0.47661943319838057, 'f1-score': 0.4593754191715341, 'support': 39520}, '1': {'precision': 0.5795071563006085, 'recall': 0.5294517535090175, 'f1-score': 0.5533497722238475, 'support': 50014}, '2': {'precision': 0.44587072316329956, 'recall': 0.4608307501549907, 'f1-score': 0.4532273209516725, 'support': 40325}, 'accuracy': 0.4920644699250726, 'macro avg': {'precision': 0.48957116266766354, 'recall': 0.48896731228746293, 'f1-score': 0.4886508374490181, 'support': 129859}, 'weighted avg': {'precision': 0.49656805516940083, 'recall': 0.4920644699250726, 'f1-score': 0.4936596138199026, 'support': 129859}}
[[18836  9754 10930]
 [11369 26480 12165]
 [12282  9460 18583]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0298009
{'0': {'precision': 0.45199355618203785, 'recall': 0.4915469516468115, 'f1-score': 0.4709412110276531, 'support': 22832}, '1': {'precision': 0.5018381427204512, 'recall': 0.4591742696525666, 'f1-score': 0.47955918092350636, 'support': 21702}, '2': {'precision': 0.46869232500562685, 'recall': 0.46548640915593703, 'f1-score': 0.4670838660475966, 'support': 22368}, 'accuracy': 0.4723326656901139, 'macro avg': {'precision': 0.4741746746360387, 'recall': 0.47206921015177167, 'f1-score': 0.47252808599958535, 'support': 66902}, 'weighted avg': {'precision': 0.4737454511642908, 'recall': 0.4723326656901139, 'f1-score': 0.47244708663923274, 'support': 66902}}
[[11223  5014  6595]
 [ 6529  9965  5208]
 [ 7078  4878 10412]]
Evaluating performance on  val set...
73/73 - 1s - 674ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0515233
{'0': {'precision': 0.4532221945757651, 'recall': 0.5408254156769596, 'f1-score': 0.4931636658995533, 'support': 6736}, '1': {'precision': 0.41701295526766075, 'recall': 0.3357606770320803, 'f1-score': 0.37200174443959877, 'support': 5081}, '2': {'precision': 0.47908045977011493, 'recall': 0.45721807810443177, 'f1-score': 0.46789402784014367, 'support': 6837}, 'accuracy': 0.4543261498874236, 'macro avg': {'precision': 0.4497718698711803, 'recall': 0.4446013902711572, 'f1-score': 0.4443531460597652, 'support': 18654}, 'weighted avg': {'precision': 0.4528369589270727, 'recall': 0.4543261498874236, 'f1-score': 0.4508996882888418, 'support': 18654}}
[[3643 1175 1918]
 [1894 1706 1481]
 [2501 1210 3126]]
training model: results/XRAY/W9/deepVOL_L2/h30
Epoch 1/50
262/262 - 8s - loss: 3.3330 - accuracy30: 0.3626 - val_loss: 3.3339 - val_accuracy30: 0.3593 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2609 - accuracy30: 0.3916 - val_loss: 3.2749 - val_accuracy30: 0.3888 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2180 - accuracy30: 0.4132 - val_loss: 3.2429 - val_accuracy30: 0.4074 - 6s/epoch - 21ms/step
Epoch 4/50
262/262 - 6s - loss: 3.1917 - accuracy30: 0.4258 - val_loss: 3.2376 - val_accuracy30: 0.4129 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.1785 - accuracy30: 0.4309 - val_loss: 3.2254 - val_accuracy30: 0.4171 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.1673 - accuracy30: 0.4356 - val_loss: 3.2205 - val_accuracy30: 0.4210 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 5s - loss: 3.1568 - accuracy30: 0.4405 - val_loss: 3.2289 - val_accuracy30: 0.4142 - 5s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1502 - accuracy30: 0.4444 - val_loss: 3.2202 - val_accuracy30: 0.4206 - 6s/epoch - 22ms/step
Epoch 9/50
262/262 - 6s - loss: 3.1383 - accuracy30: 0.4485 - val_loss: 3.2198 - val_accuracy30: 0.4259 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1305 - accuracy30: 0.4506 - val_loss: 3.2209 - val_accuracy30: 0.4251 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1215 - accuracy30: 0.4544 - val_loss: 3.2096 - val_accuracy30: 0.4312 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1159 - accuracy30: 0.4558 - val_loss: 3.2081 - val_accuracy30: 0.4295 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 5s - loss: 3.1097 - accuracy30: 0.4577 - val_loss: 3.2189 - val_accuracy30: 0.4252 - 5s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1049 - accuracy30: 0.4619 - val_loss: 3.2201 - val_accuracy30: 0.4284 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.0997 - accuracy30: 0.4620 - val_loss: 3.2176 - val_accuracy30: 0.4280 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 5s - loss: 3.0904 - accuracy30: 0.4651 - val_loss: 3.2178 - val_accuracy30: 0.4290 - 5s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.0863 - accuracy30: 0.4665 - val_loss: 3.2327 - val_accuracy30: 0.4259 - 6s/epoch - 21ms/step
Epoch 18/50
262/262 - 6s - loss: 3.0801 - accuracy30: 0.4697 - val_loss: 3.2348 - val_accuracy30: 0.4292 - 6s/epoch - 22ms/step
Epoch 19/50
262/262 - 6s - loss: 3.0764 - accuracy30: 0.4702 - val_loss: 3.2268 - val_accuracy30: 0.4262 - 6s/epoch - 21ms/step
Epoch 20/50
262/262 - 6s - loss: 3.0740 - accuracy30: 0.4698 - val_loss: 3.2294 - val_accuracy30: 0.4267 - 6s/epoch - 21ms/step
Epoch 21/50
262/262 - 6s - loss: 3.0691 - accuracy30: 0.4723 - val_loss: 3.2499 - val_accuracy30: 0.4232 - 6s/epoch - 21ms/step
Epoch 22/50
262/262 - 6s - loss: 3.0631 - accuracy30: 0.4751 - val_loss: 3.2467 - val_accuracy30: 0.4239 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h30
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0348514
{'0': {'precision': 0.43061537187344706, 'recall': 0.5224458009897757, 'f1-score': 0.47210651169653695, 'support': 39807}, '1': {'precision': 0.5223865655579748, 'recall': 0.4232243151726515, 'f1-score': 0.4676060755410189, 'support': 49319}, '2': {'precision': 0.4156852377061001, 'recall': 0.4245943092824, 'f1-score': 0.420092544237846, 'support': 40733}, 'accuracy': 0.45406941374875825, 'macro avg': {'precision': 0.45622905837917394, 'recall': 0.4567548084816091, 'f1-score': 0.4532683771584673, 'support': 129859}, 'weighted avg': {'precision': 0.460785897953955, 'recall': 0.45406941374875825, 'f1-score': 0.45408202400412556, 'support': 129859}}
[[20797  9210  9800]
 [13935 20873 14511]
 [13564  9874 17295]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0426809
{'0': {'precision': 0.44033107599699023, 'recall': 0.5201315438627677, 'f1-score': 0.47691618108471534, 'support': 22502}, '1': {'precision': 0.4739408386607433, 'recall': 0.3917950555356503, 'f1-score': 0.42897072524885993, 'support': 22328}, '2': {'precision': 0.4533937065495792, 'recall': 0.44912105835447624, 'f1-score': 0.45124726875455207, 'support': 22072}, 'accuracy': 0.4538728289139338, 'macro avg': {'precision': 0.4558885404024376, 'recall': 0.45368255258429807, 'f1-score': 0.4523780583627091, 'support': 66902}, 'weighted avg': {'precision': 0.4558576247147121, 'recall': 0.4538728289139338, 'f1-score': 0.45244620453910617, 'support': 66902}}
[[11704  4764  6034]
 [ 7663  8748  5917]
 [ 7213  4946  9913]]
Evaluating performance on  val set...
73/73 - 1s - 665ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0700248
{'0': {'precision': 0.4306533883896041, 'recall': 0.543448275862069, 'f1-score': 0.4805203604580256, 'support': 6525}, '1': {'precision': 0.3836554930266699, 'recall': 0.28313470566991694, 'f1-score': 0.3258181818181818, 'support': 5538}, '2': {'precision': 0.4544449707879362, 'recall': 0.43665604612350173, 'f1-score': 0.4453729495512226, 'support': 6591}, 'accuracy': 0.4284335799292377, 'macro avg': {'precision': 0.4229179507347367, 'recall': 0.42107967588516254, 'f1-score': 0.4172371639424766, 'support': 18654}, 'weighted avg': {'precision': 0.42510690908583426, 'recall': 0.4284335799292377, 'f1-score': 0.4221737725629793, 'support': 18654}}
[[3546 1235 1744]
 [2259 1568 1711]
 [2429 1284 2878]]
training model: results/XRAY/W9/deepVOL_L2/h50
Epoch 1/50
262/262 - 8s - loss: 3.3281 - accuracy50: 0.3662 - val_loss: 3.3292 - val_accuracy50: 0.3541 - 8s/epoch - 31ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2783 - accuracy50: 0.3858 - val_loss: 3.2941 - val_accuracy50: 0.3727 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2404 - accuracy50: 0.4034 - val_loss: 3.2876 - val_accuracy50: 0.3764 - 6s/epoch - 21ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2271 - accuracy50: 0.4097 - val_loss: 3.2892 - val_accuracy50: 0.3845 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2179 - accuracy50: 0.4134 - val_loss: 3.2811 - val_accuracy50: 0.3839 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2076 - accuracy50: 0.4180 - val_loss: 3.2934 - val_accuracy50: 0.3831 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 5s - loss: 3.1925 - accuracy50: 0.4249 - val_loss: 3.2834 - val_accuracy50: 0.3897 - 5s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1828 - accuracy50: 0.4292 - val_loss: 3.2741 - val_accuracy50: 0.3849 - 6s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.1785 - accuracy50: 0.4308 - val_loss: 3.2751 - val_accuracy50: 0.3883 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1732 - accuracy50: 0.4342 - val_loss: 3.2685 - val_accuracy50: 0.3882 - 6s/epoch - 22ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1598 - accuracy50: 0.4376 - val_loss: 3.2814 - val_accuracy50: 0.3857 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1568 - accuracy50: 0.4400 - val_loss: 3.2892 - val_accuracy50: 0.3889 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1475 - accuracy50: 0.4434 - val_loss: 3.2816 - val_accuracy50: 0.3881 - 6s/epoch - 22ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1393 - accuracy50: 0.4470 - val_loss: 3.2884 - val_accuracy50: 0.3864 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1310 - accuracy50: 0.4494 - val_loss: 3.2862 - val_accuracy50: 0.3913 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 5s - loss: 3.1226 - accuracy50: 0.4513 - val_loss: 3.2900 - val_accuracy50: 0.3919 - 5s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1172 - accuracy50: 0.4547 - val_loss: 3.2949 - val_accuracy50: 0.3934 - 6s/epoch - 21ms/step
Epoch 18/50
262/262 - 5s - loss: 3.1106 - accuracy50: 0.4585 - val_loss: 3.3078 - val_accuracy50: 0.3881 - 5s/epoch - 21ms/step
Epoch 19/50
262/262 - 6s - loss: 3.1038 - accuracy50: 0.4624 - val_loss: 3.3041 - val_accuracy50: 0.3916 - 6s/epoch - 21ms/step
Epoch 20/50
262/262 - 6s - loss: 3.0943 - accuracy50: 0.4643 - val_loss: 3.3072 - val_accuracy50: 0.3910 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h50
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0735134
{'0': {'precision': 0.42280856701258557, 'recall': 0.4447980302431999, 'f1-score': 0.4335246374842938, 'support': 43051}, '1': {'precision': 0.43158571888066904, 'recall': 0.1609104427495563, 'f1-score': 0.23442058736176385, 'support': 41694}, '2': {'precision': 0.3821279554937413, 'recall': 0.5846522143902114, 'f1-score': 0.4621773642432844, 'support': 45114}, 'accuracy': 0.40223627164848025, 'macro avg': {'precision': 0.41217408046233195, 'recall': 0.3967868957943225, 'f1-score': 0.37670752969644733, 'support': 129859}, 'weighted avg': {'precision': 0.4114939062029901, 'recall': 0.40223627164848025, 'f1-score': 0.37955221238627473, 'support': 129859}}
[[19149  4455 19447]
 [11784  6709 23201]
 [14357  4381 26376]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0664047
{'0': {'precision': 0.42203375942314, 'recall': 0.4534489589294361, 'f1-score': 0.43717771883289125, 'support': 22717}, '1': {'precision': 0.4841040462427746, 'recall': 0.19871326884467969, 'f1-score': 0.2817675983436853, 'support': 21916}, '2': {'precision': 0.3990088960534957, 'recall': 0.6002065651802955, 'f1-score': 0.4793515878566177, 'support': 22269}, 'accuracy': 0.4188514543660877, 'macro avg': {'precision': 0.4350489005731368, 'recall': 0.41745626431813704, 'f1-score': 0.3994323016777314, 'support': 66902}, 'weighted avg': {'precision': 0.43470291316384285, 'recall': 0.4188514543660877, 'f1-score': 0.40030590167716984, 'support': 66902}}
[[10301  2418  9998]
 [ 7427  4355 10134]
 [ 6680  2223 13366]]
Evaluating performance on  val set...
73/73 - 1s - 684ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0891417
{'0': {'precision': 0.40238161174189974, 'recall': 0.4540625, 'f1-score': 0.42666275143150784, 'support': 6400}, '1': {'precision': 0.38785834738617203, 'recall': 0.11623989218328841, 'f1-score': 0.17887232663642255, 'support': 5936}, '2': {'precision': 0.37863876515073036, 'recall': 0.578505856283634, 'f1-score': 0.45770458956859306, 'support': 6318}, 'accuracy': 0.38871019620456737, 'macro avg': {'precision': 0.3896262414262674, 'recall': 0.38293608282230746, 'f1-score': 0.35441322254550783, 'support': 18654}, 'weighted avg': {'precision': 0.38971851524899703, 'recall': 0.38871019620456737, 'f1-score': 0.35832557826577816, 'support': 18654}}
[[2906  557 2937]
 [2185  690 3061]
 [2131  532 3655]]
training model: results/XRAY/W9/deepVOL_L2/h100
Epoch 1/50
262/262 - 8s - loss: 3.3406 - accuracy100: 0.3570 - val_loss: 3.3365 - val_accuracy100: 0.3494 - 8s/epoch - 29ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2928 - accuracy100: 0.3769 - val_loss: 3.3226 - val_accuracy100: 0.3488 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2696 - accuracy100: 0.3839 - val_loss: 3.3028 - val_accuracy100: 0.3555 - 6s/epoch - 22ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2563 - accuracy100: 0.3886 - val_loss: 3.2887 - val_accuracy100: 0.3619 - 6s/epoch - 22ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2415 - accuracy100: 0.3977 - val_loss: 3.2863 - val_accuracy100: 0.3647 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2364 - accuracy100: 0.3984 - val_loss: 3.2870 - val_accuracy100: 0.3664 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2296 - accuracy100: 0.4070 - val_loss: 3.2872 - val_accuracy100: 0.3650 - 6s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2226 - accuracy100: 0.4074 - val_loss: 3.2822 - val_accuracy100: 0.3720 - 6s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2176 - accuracy100: 0.4106 - val_loss: 3.2917 - val_accuracy100: 0.3672 - 6s/epoch - 22ms/step
Epoch 10/50
262/262 - 5s - loss: 3.2093 - accuracy100: 0.4154 - val_loss: 3.2878 - val_accuracy100: 0.3715 - 5s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2013 - accuracy100: 0.4192 - val_loss: 3.2936 - val_accuracy100: 0.3682 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1941 - accuracy100: 0.4220 - val_loss: 3.2992 - val_accuracy100: 0.3686 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1885 - accuracy100: 0.4260 - val_loss: 3.3104 - val_accuracy100: 0.3671 - 6s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1806 - accuracy100: 0.4299 - val_loss: 3.3212 - val_accuracy100: 0.3646 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1764 - accuracy100: 0.4346 - val_loss: 3.3212 - val_accuracy100: 0.3666 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1690 - accuracy100: 0.4335 - val_loss: 3.3180 - val_accuracy100: 0.3644 - 6s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1632 - accuracy100: 0.4377 - val_loss: 3.3298 - val_accuracy100: 0.3624 - 6s/epoch - 21ms/step
Epoch 18/50
262/262 - 6s - loss: 3.1545 - accuracy100: 0.4409 - val_loss: 3.3321 - val_accuracy100: 0.3701 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h100
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0856935
{'0': {'precision': 0.3927498798654493, 'recall': 0.3150552918784783, 'f1-score': 0.3496383834872933, 'support': 41507}, '1': {'precision': 0.41401387956122676, 'recall': 0.4033851724213144, 'f1-score': 0.4086304230144614, 'support': 45847}, '2': {'precision': 0.3498737787370165, 'recall': 0.42714974708857784, 'f1-score': 0.3846691667196338, 'support': 42505}, 'accuracy': 0.3829307171624608, 'macro avg': {'precision': 0.3855458460545642, 'recall': 0.3818634037961235, 'f1-score': 0.3809793244071295, 'support': 129859}, 'weighted avg': {'precision': 0.38622312327243896, 'recall': 0.3829307171624608, 'f1-score': 0.38193180541024596, 'support': 129859}}
[[13077 12782 15648]
 [ 9264 18494 18089]
 [10955 13394 18156]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.078852
{'0': {'precision': 0.4029383833305402, 'recall': 0.3214922446068818, 'f1-score': 0.3576369090413269, 'support': 22436}, '1': {'precision': 0.4084081491712707, 'recall': 0.4262546175331111, 'f1-score': 0.417140589869065, 'support': 22198}, '2': {'precision': 0.3889211473696435, 'recall': 0.45118555775103286, 'f1-score': 0.41774599280680236, 'support': 22268}, 'accuracy': 0.3994200472332666, 'macro avg': {'precision': 0.40008922662381813, 'recall': 0.39964413996367526, 'f1-score': 0.3975078305723981, 'support': 66902}, 'weighted avg': {'precision': 0.4000876770998638, 'recall': 0.3994200472332666, 'f1-score': 0.39738716739389834, 'support': 66902}}
[[ 7213  7069  8154]
 [ 5104  9462  7632]
 [ 5584  6637 10047]]
Evaluating performance on  val set...
73/73 - 1s - 689ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0950795
{'0': {'precision': 0.38396089790007243, 'recall': 0.3288372093023256, 'f1-score': 0.3542675797561383, 'support': 6450}, '1': {'precision': 0.35494663055599807, 'recall': 0.37445378151260506, 'f1-score': 0.36443935552465856, 'support': 5950}, '2': {'precision': 0.3716620458193492, 'recall': 0.4072593540134314, 'f1-score': 0.38864728770885787, 'support': 6254}, 'accuracy': 0.36967942532432724, 'macro avg': {'precision': 0.37018985809180655, 'recall': 0.37018344827612065, 'f1-score': 0.3691180743298849, 'support': 18654}, 'weighted avg': {'precision': 0.37058296761112175, 'recall': 0.36967942532432724, 'f1-score': 0.3690382862726497, 'support': 18654}}
[[2121 2042 2287]
 [1703 2228 2019]
 [1700 2007 2547]]
training model: results/XRAY/W9/deepVOL_L2/h200
Epoch 1/50
262/262 - 8s - loss: 3.3119 - accuracy200: 0.3805 - val_loss: 3.3337 - val_accuracy200: 0.3438 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2746 - accuracy200: 0.3805 - val_loss: 3.3007 - val_accuracy200: 0.3548 - 6s/epoch - 21ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2478 - accuracy200: 0.3896 - val_loss: 3.2897 - val_accuracy200: 0.3582 - 6s/epoch - 21ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2275 - accuracy200: 0.3971 - val_loss: 3.2916 - val_accuracy200: 0.3600 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2136 - accuracy200: 0.4052 - val_loss: 3.2863 - val_accuracy200: 0.3625 - 6s/epoch - 22ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2055 - accuracy200: 0.4120 - val_loss: 3.2917 - val_accuracy200: 0.3628 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.1971 - accuracy200: 0.4153 - val_loss: 3.2776 - val_accuracy200: 0.3721 - 6s/epoch - 22ms/step
Epoch 8/50
262/262 - 6s - loss: 3.1894 - accuracy200: 0.4182 - val_loss: 3.2947 - val_accuracy200: 0.3650 - 6s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.1819 - accuracy200: 0.4216 - val_loss: 3.3158 - val_accuracy200: 0.3628 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1752 - accuracy200: 0.4253 - val_loss: 3.3125 - val_accuracy200: 0.3635 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1864 - accuracy200: 0.4215 - val_loss: 3.3235 - val_accuracy200: 0.3578 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1720 - accuracy200: 0.4286 - val_loss: 3.3396 - val_accuracy200: 0.3555 - 6s/epoch - 22ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1604 - accuracy200: 0.4324 - val_loss: 3.3372 - val_accuracy200: 0.3563 - 6s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1554 - accuracy200: 0.4317 - val_loss: 3.3398 - val_accuracy200: 0.3506 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1543 - accuracy200: 0.4362 - val_loss: 3.3312 - val_accuracy200: 0.3551 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1437 - accuracy200: 0.4404 - val_loss: 3.3340 - val_accuracy200: 0.3543 - 6s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1404 - accuracy200: 0.4441 - val_loss: 3.3267 - val_accuracy200: 0.3543 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h200
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0723705
{'0': {'precision': 0.3789067579869088, 'recall': 0.20256303299962922, 'f1-score': 0.26399480527325164, 'support': 43152}, '1': {'precision': 0.49193896257953196, 'recall': 0.4225407558354946, 'f1-score': 0.45460660720514223, 'support': 43184}, '2': {'precision': 0.3732244827685156, 'recall': 0.5976839831813064, 'f1-score': 0.4595083950857173, 'support': 43523}, 'accuracy': 0.4081426778274898, 'macro avg': {'precision': 0.4146900677783188, 'recall': 0.40759592400547673, 'f1-score': 0.39270326918803705, 'support': 129859}, 'weighted avg': {'precision': 0.4145906386482239, 'recall': 0.4081426778274898, 'f1-score': 0.39290938203754755, 'support': 129859}}
[[ 8741  9121 25290]
 [ 6542 18247 18395]
 [ 7786  9724 26013]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0772728
{'0': {'precision': 0.38614506927465364, 'recall': 0.21044683308163808, 'f1-score': 0.2724241030358785, 'support': 22514}, '1': {'precision': 0.46537801233547405, 'recall': 0.3334852143800975, 'f1-score': 0.38854382332643206, 'support': 21947}, '2': {'precision': 0.3768667266418198, 'recall': 0.6533576935074195, 'f1-score': 0.4780099762005673, 'support': 22441}, 'accuracy': 0.3993752055244985, 'macro avg': {'precision': 0.40946326941731587, 'recall': 0.3990965803230517, 'f1-score': 0.3796593008542926, 'support': 66902}, 'weighted avg': {'precision': 0.4090249549930537, 'recall': 0.3993752055244985, 'f1-score': 0.37947668862234174, 'support': 66902}}
[[ 4738  4519 13257]
 [ 3642  7319 10986]
 [ 3890  3889 14662]]
Evaluating performance on  val set...
73/73 - 1s - 673ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922073
{'0': {'precision': 0.3758926021136818, 'recall': 0.19996960948184167, 'f1-score': 0.2610593136282484, 'support': 6581}, '1': {'precision': 0.4329700272479564, 'recall': 0.26531975288028053, 'f1-score': 0.3290195672429858, 'support': 5989}, '2': {'precision': 0.34747017329966035, 'recall': 0.6558185404339251, 'f1-score': 0.4542608299652758, 'support': 6084}, 'accuracy': 0.3696258175190308, 'macro avg': {'precision': 0.3854442675537662, 'recall': 0.3737026342653491, 'f1-score': 0.34811323694550333, 'support': 18654}, 'weighted avg': {'precision': 0.38494774536578136, 'recall': 0.3696258175190308, 'f1-score': 0.3458910914932177, 'support': 18654}}
[[1316 1077 4188]
 [1095 1589 3305]
 [1090 1004 3990]]
training model: results/XRAY/W9/deepVOL_L2/h300
Epoch 1/50
262/262 - 8s - loss: 3.3158 - accuracy300: 0.3735 - val_loss: 3.3407 - val_accuracy300: 0.3385 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.2907 - accuracy300: 0.3778 - val_loss: 3.3111 - val_accuracy300: 0.3591 - 6s/epoch - 21ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2800 - accuracy300: 0.3783 - val_loss: 3.2907 - val_accuracy300: 0.3676 - 6s/epoch - 21ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2591 - accuracy300: 0.3860 - val_loss: 3.2919 - val_accuracy300: 0.3655 - 6s/epoch - 22ms/step
Epoch 5/50
262/262 - 5s - loss: 3.2429 - accuracy300: 0.3915 - val_loss: 3.2909 - val_accuracy300: 0.3622 - 5s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2271 - accuracy300: 0.3990 - val_loss: 3.2853 - val_accuracy300: 0.3694 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2258 - accuracy300: 0.4010 - val_loss: 3.2910 - val_accuracy300: 0.3708 - 6s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2157 - accuracy300: 0.4079 - val_loss: 3.2822 - val_accuracy300: 0.3713 - 6s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2066 - accuracy300: 0.4118 - val_loss: 3.2880 - val_accuracy300: 0.3664 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.1972 - accuracy300: 0.4161 - val_loss: 3.3038 - val_accuracy300: 0.3592 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.1920 - accuracy300: 0.4190 - val_loss: 3.3116 - val_accuracy300: 0.3625 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 5s - loss: 3.1853 - accuracy300: 0.4208 - val_loss: 3.3141 - val_accuracy300: 0.3594 - 5s/epoch - 21ms/step
Epoch 13/50
262/262 - 5s - loss: 3.1737 - accuracy300: 0.4264 - val_loss: 3.3143 - val_accuracy300: 0.3597 - 5s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1669 - accuracy300: 0.4289 - val_loss: 3.3147 - val_accuracy300: 0.3610 - 6s/epoch - 21ms/step
Epoch 15/50
262/262 - 6s - loss: 3.1652 - accuracy300: 0.4290 - val_loss: 3.3228 - val_accuracy300: 0.3671 - 6s/epoch - 21ms/step
Epoch 16/50
262/262 - 6s - loss: 3.1559 - accuracy300: 0.4351 - val_loss: 3.3108 - val_accuracy300: 0.3647 - 6s/epoch - 21ms/step
Epoch 17/50
262/262 - 6s - loss: 3.1564 - accuracy300: 0.4352 - val_loss: 3.3209 - val_accuracy300: 0.3690 - 6s/epoch - 22ms/step
Epoch 18/50
262/262 - 6s - loss: 3.1450 - accuracy300: 0.4395 - val_loss: 3.3231 - val_accuracy300: 0.3646 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h300
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.082884
{'0': {'precision': 0.32687534055821277, 'recall': 0.13280692691806262, 'f1-score': 0.18887528423998598, 'support': 40653}, '1': {'precision': 0.4514003294892916, 'recall': 0.5270825228029222, 'f1-score': 0.486314550947761, 'support': 46266}, '2': {'precision': 0.36967919216439926, 'recall': 0.5106893339543549, 'f1-score': 0.42889134452713207, 'support': 42940}, 'accuracy': 0.3982319284762704, 'macro avg': {'precision': 0.3826516207373012, 'recall': 0.3901929278917799, 'f1-score': 0.3680270599049597, 'support': 129859}, 'weighted avg': {'precision': 0.3853947387197183, 'recall': 0.3982319284762704, 'f1-score': 0.3742118010946666, 'support': 129859}}
[[ 5399 13982 21272]
 [ 5762 24386 16118]
 [ 5356 15655 21929]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.081849
{'0': {'precision': 0.38963688290493675, 'recall': 0.17107797035245645, 'f1-score': 0.23776180250832477, 'support': 22329}, '1': {'precision': 0.4222744515916213, 'recall': 0.46301654760828287, 'f1-score': 0.44170800086262674, 'support': 22118}, '2': {'precision': 0.3853741703708214, 'recall': 0.563705188154086, 'f1-score': 0.45778557349776683, 'support': 22455}, 'accuracy': 0.3993752055244985, 'macro avg': {'precision': 0.39909516828912645, 'recall': 0.39926656870494176, 'f1-score': 0.37908512562290614, 'support': 66902}, 'weighted avg': {'precision': 0.39899622245021976, 'recall': 0.3993752055244985, 'f1-score': 0.3790358420403025, 'support': 66902}}
[[ 3820  7207 11302]
 [ 2991 10241  8886]
 [ 2993  6804 12658]]
Evaluating performance on  val set...
73/73 - 1s - 675ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956901
{'0': {'precision': 0.3535994032077583, 'recall': 0.1467038068709378, 'f1-score': 0.2073717598162529, 'support': 6462}, '1': {'precision': 0.4032726716623337, 'recall': 0.42829299983758323, 'f1-score': 0.41540642722117205, 'support': 6157}, '2': {'precision': 0.3536145855416578, 'recall': 0.5527754763877382, 'f1-score': 0.4313142413859978, 'support': 6035}, 'accuracy': 0.3710196204567385, 'macro avg': {'precision': 0.3701622201372499, 'recall': 0.3759240943654197, 'f1-score': 0.3513641428078076, 'support': 18654}, 'weighted avg': {'precision': 0.36999963582595835, 'recall': 0.3710196204567385, 'f1-score': 0.3484869267233772, 'support': 18654}}
[[ 948 2006 3508]
 [ 930 2637 2590]
 [ 803 1896 3336]]
training model: results/XRAY/W9/deepVOL_L2/h500
Epoch 1/50
262/262 - 8s - loss: 3.3394 - accuracy500: 0.3658 - val_loss: 3.3715 - val_accuracy500: 0.3490 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3034 - accuracy500: 0.3711 - val_loss: 3.3299 - val_accuracy500: 0.3370 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2820 - accuracy500: 0.3804 - val_loss: 3.3185 - val_accuracy500: 0.3391 - 6s/epoch - 22ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2646 - accuracy500: 0.3879 - val_loss: 3.2998 - val_accuracy500: 0.3542 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2532 - accuracy500: 0.3919 - val_loss: 3.3057 - val_accuracy500: 0.3469 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2434 - accuracy500: 0.3989 - val_loss: 3.3267 - val_accuracy500: 0.3438 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2273 - accuracy500: 0.4077 - val_loss: 3.3253 - val_accuracy500: 0.3457 - 6s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2218 - accuracy500: 0.4092 - val_loss: 3.3751 - val_accuracy500: 0.3437 - 6s/epoch - 22ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2147 - accuracy500: 0.4113 - val_loss: 3.3812 - val_accuracy500: 0.3421 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2153 - accuracy500: 0.4115 - val_loss: 3.3888 - val_accuracy500: 0.3367 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2003 - accuracy500: 0.4194 - val_loss: 3.3946 - val_accuracy500: 0.3393 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.1929 - accuracy500: 0.4228 - val_loss: 3.4291 - val_accuracy500: 0.3335 - 6s/epoch - 21ms/step
Epoch 13/50
262/262 - 6s - loss: 3.1795 - accuracy500: 0.4285 - val_loss: 3.4240 - val_accuracy500: 0.3363 - 6s/epoch - 21ms/step
Epoch 14/50
262/262 - 6s - loss: 3.1687 - accuracy500: 0.4346 - val_loss: 3.4422 - val_accuracy500: 0.3335 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h500
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927289
{'0': {'precision': 0.38069766378640335, 'recall': 0.20242117801492573, 'f1-score': 0.26430725281701317, 'support': 41137}, '1': {'precision': 0.38007885226152666, 'recall': 0.6288846606867808, 'f1-score': 0.4738045667087614, 'support': 44148}, '2': {'precision': 0.3482168412616635, 'recall': 0.27293938170233767, 'f1-score': 0.306016701881477, 'support': 44574}, 'accuracy': 0.3716107470410214, 'macro avg': {'precision': 0.3696644524365312, 'recall': 0.3680817401346814, 'f1-score': 0.34804284046908385, 'support': 129859}, 'weighted avg': {'precision': 0.36933827033336575, 'recall': 0.3716107470410214, 'f1-score': 0.349846525384123, 'support': 129859}}
[[ 8327 20768 12042]
 [ 5654 27764 10730]
 [ 7892 24516 12166]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959604
{'0': {'precision': 0.3631720197385508, 'recall': 0.18542256011315417, 'f1-score': 0.2455010972933431, 'support': 22624}, '1': {'precision': 0.3584319973628547, 'recall': 0.5902202922151355, 'f1-score': 0.4460092291915912, 'support': 22107}, '2': {'precision': 0.3669516571669833, 'recall': 0.31360786613143293, 'f1-score': 0.33818915829665114, 'support': 22171}, 'accuracy': 0.3616633284505695, 'macro avg': {'precision': 0.3628518914227963, 'recall': 0.36308357281990755, 'f1-score': 0.3432331615938618, 'support': 66902}, 'weighted avg': {'precision': 0.36285828721584984, 'recall': 0.3616633284505695, 'f1-score': 0.34247309024391126, 'support': 66902}}
[[ 4195 12106  6323]
 [ 3387 13048  5672]
 [ 3969 11249  6953]]
Evaluating performance on  val set...
73/73 - 1s - 667ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998768
{'0': {'precision': 0.35898261429491307, 'recall': 0.17600631412786108, 'f1-score': 0.23620379197118951, 'support': 6335}, '1': {'precision': 0.3641379310344828, 'recall': 0.5829652996845426, 'f1-score': 0.448271679805943, 'support': 6340}, '2': {'precision': 0.33197480548351244, 'recall': 0.2997156715169761, 'f1-score': 0.315021534675222, 'support': 5979}, 'accuracy': 0.35397233837246705, 'macro avg': {'precision': 0.3516984502709694, 'recall': 0.35289576177645987, 'f1-score': 0.3331656688174515, 'support': 18654}, 'weighted avg': {'precision': 0.3520781980434661, 'recall': 0.35397233837246705, 'f1-score': 0.3335427912474706, 'support': 18654}}
[[1115 3282 1938]
 [ 976 3696 1668]
 [1015 3172 1792]]
training model: results/XRAY/W9/deepVOL_L2/h1000
Epoch 1/50
262/262 - 8s - loss: 3.3411 - accuracy1000: 0.3781 - val_loss: 3.3521 - val_accuracy1000: 0.3385 - 8s/epoch - 30ms/step
Epoch 2/50
262/262 - 6s - loss: 3.3262 - accuracy1000: 0.3684 - val_loss: 3.3114 - val_accuracy1000: 0.3444 - 6s/epoch - 22ms/step
Epoch 3/50
262/262 - 6s - loss: 3.2967 - accuracy1000: 0.3675 - val_loss: 3.3300 - val_accuracy1000: 0.3457 - 6s/epoch - 21ms/step
Epoch 4/50
262/262 - 6s - loss: 3.2751 - accuracy1000: 0.3747 - val_loss: 3.3129 - val_accuracy1000: 0.3450 - 6s/epoch - 21ms/step
Epoch 5/50
262/262 - 6s - loss: 3.2615 - accuracy1000: 0.3837 - val_loss: 3.3115 - val_accuracy1000: 0.3453 - 6s/epoch - 21ms/step
Epoch 6/50
262/262 - 6s - loss: 3.2496 - accuracy1000: 0.3873 - val_loss: 3.3154 - val_accuracy1000: 0.3421 - 6s/epoch - 21ms/step
Epoch 7/50
262/262 - 6s - loss: 3.2388 - accuracy1000: 0.3971 - val_loss: 3.3168 - val_accuracy1000: 0.3365 - 6s/epoch - 21ms/step
Epoch 8/50
262/262 - 6s - loss: 3.2313 - accuracy1000: 0.4004 - val_loss: 3.3122 - val_accuracy1000: 0.3460 - 6s/epoch - 21ms/step
Epoch 9/50
262/262 - 6s - loss: 3.2264 - accuracy1000: 0.4045 - val_loss: 3.3269 - val_accuracy1000: 0.3424 - 6s/epoch - 21ms/step
Epoch 10/50
262/262 - 6s - loss: 3.2162 - accuracy1000: 0.4115 - val_loss: 3.3294 - val_accuracy1000: 0.3367 - 6s/epoch - 21ms/step
Epoch 11/50
262/262 - 6s - loss: 3.2135 - accuracy1000: 0.4130 - val_loss: 3.3224 - val_accuracy1000: 0.3368 - 6s/epoch - 21ms/step
Epoch 12/50
262/262 - 6s - loss: 3.2115 - accuracy1000: 0.4151 - val_loss: 3.3152 - val_accuracy1000: 0.3449 - 6s/epoch - 21ms/step
testing model: results/XRAY/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095817
{'0': {'precision': 0.32223222322232226, 'recall': 0.1284535342662361, 'f1-score': 0.18368394048229864, 'support': 41805}, '1': {'precision': 0.37251056783021746, 'recall': 0.2177612472614256, 'f1-score': 0.2748508866416939, 'support': 39254}, '2': {'precision': 0.3777078462441965, 'recall': 0.6985040983606557, 'f1-score': 0.4902946485720655, 'support': 48800}, 'accuracy': 0.36967018073448893, 'macro avg': {'precision': 0.3574835457655787, 'recall': 0.34823962662943914, 'f1-score': 0.316276491898686, 'support': 129859}, 'weighted avg': {'precision': 0.358277753703119, 'recall': 0.36967018073448893, 'f1-score': 0.32646395464628825, 'support': 129859}}
[[ 5370  6319 30116]
 [ 4662  8548 26044]
 [ 6633  8080 34087]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025574
{'0': {'precision': 0.3531472482766414, 'recall': 0.13358126015217578, 'f1-score': 0.1938405235244859, 'support': 23394}, '1': {'precision': 0.3752244165170557, 'recall': 0.2058920110709762, 'f1-score': 0.2658871993699643, 'support': 21317}, '2': {'precision': 0.3450038829924929, 'recall': 0.7206975801000406, 'f1-score': 0.46662873648737363, 'support': 22191}, 'accuracy': 0.3513646826701743, 'macro avg': {'precision': 0.3577918492620633, 'recall': 0.3533902837743976, 'f1-score': 0.30878548646060794, 'support': 66902}, 'weighted avg': {'precision': 0.35748059520738146, 'recall': 0.3513646826701743, 'f1-score': 0.30727901897839616, 'support': 66902}}
[[ 3125  4005 16264]
 [ 2829  4389 14099]
 [ 2895  3303 15993]]
Evaluating performance on  val set...
73/73 - 1s - 677ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056929
{'0': {'precision': 0.3458512160228898, 'recall': 0.14895255699322243, 'f1-score': 0.20822566752799312, 'support': 6492}, '1': {'precision': 0.36620603015075376, 'recall': 0.1961972067979135, 'f1-score': 0.2555056425988824, 'support': 5943}, '2': {'precision': 0.3315448950607543, 'recall': 0.6756713297957871, 'f1-score': 0.4448208331127931, 'support': 6219}, 'accuracy': 0.3396054465530181, 'macro avg': {'precision': 0.347867380411466, 'recall': 0.3402736978623077, 'f1-score': 0.30285071441322287, 'support': 18654}, 'weighted avg': {'precision': 0.347566539830029, 'recall': 0.3396054465530181, 'f1-score': 0.3021663894438378, 'support': 18654}}
[[ 967  986 4539]
 [ 844 1166 3933]
 [ 985 1032 4202]]
training model: results/XRAY/W9/deepVOL_L3/h10
Epoch 1/50
262/262 - 11s - loss: 3.3345 - accuracy10: 0.3598 - val_loss: 3.3093 - val_accuracy10: 0.3659 - 11s/epoch - 43ms/step
Epoch 2/50
262/262 - 10s - loss: 3.2643 - accuracy10: 0.3883 - val_loss: 3.2598 - val_accuracy10: 0.3905 - 10s/epoch - 37ms/step
Epoch 3/50
262/262 - 9s - loss: 3.2206 - accuracy10: 0.4046 - val_loss: 3.2630 - val_accuracy10: 0.3859 - 9s/epoch - 33ms/step
Epoch 4/50
262/262 - 9s - loss: 3.1817 - accuracy10: 0.4184 - val_loss: 3.2476 - val_accuracy10: 0.3978 - 9s/epoch - 36ms/step
Epoch 5/50
262/262 - 9s - loss: 3.1540 - accuracy10: 0.4324 - val_loss: 3.2139 - val_accuracy10: 0.4115 - 9s/epoch - 36ms/step
Epoch 6/50
262/262 - 9s - loss: 3.1232 - accuracy10: 0.4477 - val_loss: 3.2093 - val_accuracy10: 0.4278 - 9s/epoch - 36ms/step
Epoch 7/50
262/262 - 9s - loss: 3.0919 - accuracy10: 0.4616 - val_loss: 3.2118 - val_accuracy10: 0.4304 - 9s/epoch - 35ms/step
Epoch 8/50
262/262 - 10s - loss: 3.0566 - accuracy10: 0.4739 - val_loss: 3.1779 - val_accuracy10: 0.4408 - 10s/epoch - 36ms/step
Epoch 9/50
262/262 - 9s - loss: 3.0331 - accuracy10: 0.4805 - val_loss: 3.1648 - val_accuracy10: 0.4505 - 9s/epoch - 36ms/step
Epoch 10/50
262/262 - 9s - loss: 3.0167 - accuracy10: 0.4858 - val_loss: 3.1646 - val_accuracy10: 0.4539 - 9s/epoch - 35ms/step
Epoch 11/50
262/262 - 9s - loss: 3.0008 - accuracy10: 0.4908 - val_loss: 3.1789 - val_accuracy10: 0.4525 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 9s - loss: 2.9896 - accuracy10: 0.4963 - val_loss: 3.1586 - val_accuracy10: 0.4572 - 9s/epoch - 33ms/step
Epoch 13/50
262/262 - 9s - loss: 2.9780 - accuracy10: 0.5002 - val_loss: 3.1493 - val_accuracy10: 0.4579 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 2.9666 - accuracy10: 0.5025 - val_loss: 3.1357 - val_accuracy10: 0.4630 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 2.9610 - accuracy10: 0.5048 - val_loss: 3.1227 - val_accuracy10: 0.4699 - 9s/epoch - 34ms/step
Epoch 16/50
262/262 - 9s - loss: 2.9488 - accuracy10: 0.5062 - val_loss: 3.1415 - val_accuracy10: 0.4607 - 9s/epoch - 35ms/step
Epoch 17/50
262/262 - 9s - loss: 2.9398 - accuracy10: 0.5095 - val_loss: 3.1431 - val_accuracy10: 0.4553 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 2.9330 - accuracy10: 0.5113 - val_loss: 3.1265 - val_accuracy10: 0.4633 - 9s/epoch - 34ms/step
Epoch 19/50
262/262 - 9s - loss: 2.9263 - accuracy10: 0.5126 - val_loss: 3.1311 - val_accuracy10: 0.4624 - 9s/epoch - 36ms/step
Epoch 20/50
262/262 - 9s - loss: 2.9167 - accuracy10: 0.5149 - val_loss: 3.0929 - val_accuracy10: 0.4728 - 9s/epoch - 35ms/step
Epoch 21/50
262/262 - 9s - loss: 2.9126 - accuracy10: 0.5155 - val_loss: 3.1001 - val_accuracy10: 0.4716 - 9s/epoch - 33ms/step
Epoch 22/50
262/262 - 9s - loss: 2.9042 - accuracy10: 0.5164 - val_loss: 3.1078 - val_accuracy10: 0.4657 - 9s/epoch - 34ms/step
Epoch 23/50
262/262 - 9s - loss: 2.8999 - accuracy10: 0.5187 - val_loss: 3.0708 - val_accuracy10: 0.4806 - 9s/epoch - 34ms/step
Epoch 24/50
262/262 - 9s - loss: 2.8914 - accuracy10: 0.5201 - val_loss: 3.0882 - val_accuracy10: 0.4715 - 9s/epoch - 34ms/step
Epoch 25/50
262/262 - 9s - loss: 2.8866 - accuracy10: 0.5222 - val_loss: 3.0942 - val_accuracy10: 0.4728 - 9s/epoch - 34ms/step
Epoch 26/50
262/262 - 9s - loss: 2.8787 - accuracy10: 0.5235 - val_loss: 3.1244 - val_accuracy10: 0.4568 - 9s/epoch - 33ms/step
Epoch 27/50
262/262 - 9s - loss: 2.8723 - accuracy10: 0.5252 - val_loss: 3.0983 - val_accuracy10: 0.4694 - 9s/epoch - 33ms/step
Epoch 28/50
262/262 - 9s - loss: 2.8667 - accuracy10: 0.5308 - val_loss: 3.1266 - val_accuracy10: 0.4563 - 9s/epoch - 33ms/step
Epoch 29/50
262/262 - 9s - loss: 2.8610 - accuracy10: 0.5283 - val_loss: 3.1101 - val_accuracy10: 0.4692 - 9s/epoch - 34ms/step
Epoch 30/50
262/262 - 9s - loss: 2.8576 - accuracy10: 0.5312 - val_loss: 3.0876 - val_accuracy10: 0.4751 - 9s/epoch - 33ms/step
Epoch 31/50
262/262 - 8s - loss: 2.8513 - accuracy10: 0.5315 - val_loss: 3.0941 - val_accuracy10: 0.4702 - 8s/epoch - 32ms/step
Epoch 32/50
262/262 - 9s - loss: 2.8480 - accuracy10: 0.5323 - val_loss: 3.1144 - val_accuracy10: 0.4653 - 9s/epoch - 33ms/step
Epoch 33/50
262/262 - 9s - loss: 2.8419 - accuracy10: 0.5333 - val_loss: 3.1416 - val_accuracy10: 0.4545 - 9s/epoch - 34ms/step
testing model: results/XRAY/W9/deepVOL_L3/h10
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95975876
{'0': {'precision': 0.4956926893037911, 'recall': 0.38765826932655256, 'f1-score': 0.4350691379817594, 'support': 38147}, '1': {'precision': 0.6003245795219829, 'recall': 0.6217672002139283, 'f1-score': 0.6108577755259059, 'support': 52354}, '2': {'precision': 0.454914632548797, 'recall': 0.529396818944052, 'f1-score': 0.48933771723813996, 'support': 39358}, 'accuracy': 0.5250001925164987, 'macro avg': {'precision': 0.5169773004581903, 'recall': 0.5129407628281776, 'f1-score': 0.5117548769152683, 'support': 129859}, 'weighted avg': {'precision': 0.5255170004622026, 'recall': 0.5250001925164987, 'f1-score': 0.5223880074660375, 'support': 129859}}
[[14788 11012 12347]
 [ 7183 32552 12619]
 [ 7862 10660 20836]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97571534
{'0': {'precision': 0.5109779351675293, 'recall': 0.42090382803033705, 'f1-score': 0.4615876765588858, 'support': 22283}, '1': {'precision': 0.5313486342204731, 'recall': 0.593669728764857, 'f1-score': 0.5607830235236059, 'support': 22969}, '2': {'precision': 0.4958923265163433, 'recall': 0.5241570438799076, 'f1-score': 0.5096330893250102, 'support': 21650}, 'accuracy': 0.5136318794654868, 'macro avg': {'precision': 0.5127396319681152, 'recall': 0.512910200225034, 'f1-score': 0.5106679298025005, 'support': 66902}, 'weighted avg': {'precision': 0.5130898475057089, 'recall': 0.5136318794654868, 'f1-score': 0.5111915914017792, 'support': 66902}}
[[ 9379  6391  6513]
 [ 4310 13636  5023]
 [ 4666  5636 11348]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.021767
{'0': {'precision': 0.5049440752147836, 'recall': 0.4569458706175737, 'f1-score': 0.47974742029878326, 'support': 6817}, '1': {'precision': 0.41984196663740125, 'recall': 0.4690994702766333, 'f1-score': 0.4431060044477391, 'support': 5097}, '2': {'precision': 0.5035346097201767, 'recall': 0.5072700296735905, 'f1-score': 0.5053954175905396, 'support': 6740}, 'accuracy': 0.47844966227082664, 'macro avg': {'precision': 0.47610688385745387, 'recall': 0.4777717901892658, 'f1-score': 0.4760829474456873, 'support': 18654}, 'weighted avg': {'precision': 0.4811815982740434, 'recall': 0.47844966227082664, 'f1-score': 0.47900260444983217, 'support': 18654}}
[[3115 1734 1968]
 [1303 2391 1403]
 [1751 1570 3419]]
training model: results/XRAY/W9/deepVOL_L3/h20
Epoch 1/50
262/262 - 11s - loss: 3.3350 - accuracy20: 0.3566 - val_loss: 3.2886 - val_accuracy20: 0.3597 - 11s/epoch - 44ms/step
Epoch 2/50
262/262 - 10s - loss: 3.2689 - accuracy20: 0.3837 - val_loss: 3.2541 - val_accuracy20: 0.3803 - 10s/epoch - 37ms/step
Epoch 3/50
262/262 - 9s - loss: 3.2302 - accuracy20: 0.4026 - val_loss: 3.2576 - val_accuracy20: 0.3777 - 9s/epoch - 36ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2041 - accuracy20: 0.4176 - val_loss: 3.2358 - val_accuracy20: 0.3966 - 9s/epoch - 33ms/step
Epoch 5/50
262/262 - 9s - loss: 3.1754 - accuracy20: 0.4341 - val_loss: 3.2365 - val_accuracy20: 0.3983 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.1523 - accuracy20: 0.4433 - val_loss: 3.2153 - val_accuracy20: 0.4088 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.1271 - accuracy20: 0.4564 - val_loss: 3.2062 - val_accuracy20: 0.4141 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.1085 - accuracy20: 0.4658 - val_loss: 3.2030 - val_accuracy20: 0.4218 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.1013 - accuracy20: 0.4652 - val_loss: 3.1911 - val_accuracy20: 0.4260 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.0876 - accuracy20: 0.4702 - val_loss: 3.1914 - val_accuracy20: 0.4322 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.0705 - accuracy20: 0.4766 - val_loss: 3.1846 - val_accuracy20: 0.4327 - 9s/epoch - 34ms/step
Epoch 12/50
262/262 - 9s - loss: 3.0627 - accuracy20: 0.4785 - val_loss: 3.1813 - val_accuracy20: 0.4381 - 9s/epoch - 34ms/step
Epoch 13/50
262/262 - 9s - loss: 3.0521 - accuracy20: 0.4825 - val_loss: 3.1949 - val_accuracy20: 0.4280 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.0475 - accuracy20: 0.4846 - val_loss: 3.1844 - val_accuracy20: 0.4319 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 3.0385 - accuracy20: 0.4855 - val_loss: 3.1649 - val_accuracy20: 0.4430 - 9s/epoch - 33ms/step
Epoch 16/50
262/262 - 9s - loss: 3.0281 - accuracy20: 0.4885 - val_loss: 3.1684 - val_accuracy20: 0.4440 - 9s/epoch - 33ms/step
Epoch 17/50
262/262 - 9s - loss: 3.0208 - accuracy20: 0.4896 - val_loss: 3.1721 - val_accuracy20: 0.4444 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 3.0089 - accuracy20: 0.4911 - val_loss: 3.1649 - val_accuracy20: 0.4451 - 9s/epoch - 34ms/step
Epoch 19/50
262/262 - 9s - loss: 3.0028 - accuracy20: 0.4953 - val_loss: 3.1713 - val_accuracy20: 0.4475 - 9s/epoch - 33ms/step
Epoch 20/50
262/262 - 9s - loss: 2.9959 - accuracy20: 0.4984 - val_loss: 3.1648 - val_accuracy20: 0.4469 - 9s/epoch - 33ms/step
Epoch 21/50
262/262 - 8s - loss: 2.9874 - accuracy20: 0.5000 - val_loss: 3.1581 - val_accuracy20: 0.4482 - 8s/epoch - 32ms/step
Epoch 22/50
262/262 - 9s - loss: 2.9824 - accuracy20: 0.5036 - val_loss: 3.1452 - val_accuracy20: 0.4556 - 9s/epoch - 34ms/step
Epoch 23/50
262/262 - 9s - loss: 2.9742 - accuracy20: 0.5030 - val_loss: 3.1511 - val_accuracy20: 0.4543 - 9s/epoch - 33ms/step
Epoch 24/50
262/262 - 9s - loss: 2.9693 - accuracy20: 0.5065 - val_loss: 3.1630 - val_accuracy20: 0.4504 - 9s/epoch - 33ms/step
Epoch 25/50
262/262 - 9s - loss: 2.9592 - accuracy20: 0.5096 - val_loss: 3.1628 - val_accuracy20: 0.4517 - 9s/epoch - 33ms/step
Epoch 26/50
262/262 - 9s - loss: 2.9523 - accuracy20: 0.5100 - val_loss: 3.1729 - val_accuracy20: 0.4475 - 9s/epoch - 33ms/step
Epoch 27/50
262/262 - 9s - loss: 2.9472 - accuracy20: 0.5109 - val_loss: 3.1826 - val_accuracy20: 0.4506 - 9s/epoch - 33ms/step
Epoch 28/50
262/262 - 9s - loss: 2.9413 - accuracy20: 0.5137 - val_loss: 3.1783 - val_accuracy20: 0.4501 - 9s/epoch - 34ms/step
Epoch 29/50
262/262 - 9s - loss: 2.9314 - accuracy20: 0.5156 - val_loss: 3.1945 - val_accuracy20: 0.4481 - 9s/epoch - 33ms/step
Epoch 30/50
262/262 - 9s - loss: 2.9263 - accuracy20: 0.5174 - val_loss: 3.1933 - val_accuracy20: 0.4437 - 9s/epoch - 36ms/step
Epoch 31/50
262/262 - 9s - loss: 2.9249 - accuracy20: 0.5176 - val_loss: 3.1796 - val_accuracy20: 0.4495 - 9s/epoch - 33ms/step
Epoch 32/50
262/262 - 9s - loss: 2.9169 - accuracy20: 0.5202 - val_loss: 3.1978 - val_accuracy20: 0.4441 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h20
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.001833
{'0': {'precision': 0.4443566442776241, 'recall': 0.512246963562753, 'f1-score': 0.47589271021885793, 'support': 39520}, '1': {'precision': 0.5753256539993541, 'recall': 0.5342704042867997, 'f1-score': 0.554038503405592, 'support': 50014}, '2': {'precision': 0.4628064243448859, 'recall': 0.43446993180409177, 'f1-score': 0.4481907368798046, 'support': 40325}, 'accuracy': 0.49657705665375523, 'macro avg': {'precision': 0.49416290754062137, 'recall': 0.49366243321788145, 'f1-score': 0.49270731683475155, 'support': 129859}, 'weighted avg': {'precision': 0.5005273481443945, 'recall': 0.49657705665375523, 'f1-score': 0.49738757484544516, 'support': 129859}}
[[20244  9740  9536]
 [12493 26721 10800]
 [12821  9984 17520]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0062301
{'0': {'precision': 0.4740525001891217, 'recall': 0.5489225648213034, 'f1-score': 0.5087477166632839, 'support': 22832}, '1': {'precision': 0.5121024204840968, 'recall': 0.471845912819095, 'f1-score': 0.49115065470765984, 'support': 21702}, '2': {'precision': 0.49623803009575923, 'recall': 0.4540861945636624, 'f1-score': 0.4742272854608273, 'support': 22368}, 'accuracy': 0.4922124899106155, 'macro avg': {'precision': 0.49413098358965923, 'recall': 0.4916182240680203, 'f1-score': 0.4913752189439237, 'support': 66902}, 'weighted avg': {'precision': 0.4938128257876572, 'recall': 0.4922124899106155, 'f1-score': 0.4914979417133945, 'support': 66902}}
[[12533  4779  5520]
 [ 6671 10240  4791]
 [ 7234  4977 10157]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.051716
{'0': {'precision': 0.45541209122722337, 'recall': 0.5602731591448931, 'f1-score': 0.5024296079345005, 'support': 6736}, '1': {'precision': 0.39335743334839585, 'recall': 0.3426490848258217, 'f1-score': 0.3662564426212265, 'support': 5081}, '2': {'precision': 0.4920047130112776, 'recall': 0.4275266929940032, 'f1-score': 0.4575050868680544, 'support': 6837}, 'accuracy': 0.45234266109145493, 'macro avg': {'precision': 0.44692474586229897, 'recall': 0.4434829789882393, 'f1-score': 0.4420637124745938, 'support': 18654}, 'weighted avg': {'precision': 0.45192136743904154, 'recall': 0.45234266109145493, 'f1-score': 0.4488730086266825, 'support': 18654}}
[[3774 1310 1652]
 [1974 1741 1366]
 [2539 1375 2923]]
training model: results/XRAY/W9/deepVOL_L3/h30
Epoch 1/50
262/262 - 11s - loss: 3.3405 - accuracy30: 0.3552 - val_loss: 3.3489 - val_accuracy30: 0.3355 - 11s/epoch - 43ms/step
Epoch 2/50
262/262 - 9s - loss: 3.3009 - accuracy30: 0.3606 - val_loss: 3.2967 - val_accuracy30: 0.3554 - 9s/epoch - 34ms/step
Epoch 3/50
262/262 - 9s - loss: 3.2864 - accuracy30: 0.3678 - val_loss: 3.2929 - val_accuracy30: 0.3644 - 9s/epoch - 34ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2668 - accuracy30: 0.3822 - val_loss: 3.2861 - val_accuracy30: 0.3681 - 9s/epoch - 33ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2494 - accuracy30: 0.3924 - val_loss: 3.2622 - val_accuracy30: 0.3840 - 9s/epoch - 34ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2217 - accuracy30: 0.4103 - val_loss: 3.2503 - val_accuracy30: 0.3987 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2037 - accuracy30: 0.4217 - val_loss: 3.2285 - val_accuracy30: 0.4124 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.1867 - accuracy30: 0.4300 - val_loss: 3.2478 - val_accuracy30: 0.4042 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.1728 - accuracy30: 0.4376 - val_loss: 3.2350 - val_accuracy30: 0.4148 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.1642 - accuracy30: 0.4394 - val_loss: 3.2273 - val_accuracy30: 0.4164 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.1516 - accuracy30: 0.4452 - val_loss: 3.2266 - val_accuracy30: 0.4140 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 9s - loss: 3.1407 - accuracy30: 0.4462 - val_loss: 3.2247 - val_accuracy30: 0.4147 - 9s/epoch - 33ms/step
Epoch 13/50
262/262 - 9s - loss: 3.1308 - accuracy30: 0.4511 - val_loss: 3.2369 - val_accuracy30: 0.4093 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.1214 - accuracy30: 0.4537 - val_loss: 3.2336 - val_accuracy30: 0.4158 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1116 - accuracy30: 0.4557 - val_loss: 3.2324 - val_accuracy30: 0.4115 - 9s/epoch - 32ms/step
Epoch 16/50
262/262 - 9s - loss: 3.1052 - accuracy30: 0.4591 - val_loss: 3.2320 - val_accuracy30: 0.4152 - 9s/epoch - 33ms/step
Epoch 17/50
262/262 - 9s - loss: 3.0945 - accuracy30: 0.4620 - val_loss: 3.2280 - val_accuracy30: 0.4143 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 3.0864 - accuracy30: 0.4682 - val_loss: 3.2361 - val_accuracy30: 0.4152 - 9s/epoch - 33ms/step
Epoch 19/50
262/262 - 9s - loss: 3.0802 - accuracy30: 0.4688 - val_loss: 3.2383 - val_accuracy30: 0.4103 - 9s/epoch - 33ms/step
Epoch 20/50
262/262 - 9s - loss: 3.0738 - accuracy30: 0.4687 - val_loss: 3.2351 - val_accuracy30: 0.4149 - 9s/epoch - 33ms/step
Epoch 21/50
262/262 - 9s - loss: 3.0640 - accuracy30: 0.4751 - val_loss: 3.2388 - val_accuracy30: 0.4107 - 9s/epoch - 33ms/step
Epoch 22/50
262/262 - 9s - loss: 3.0584 - accuracy30: 0.4768 - val_loss: 3.2399 - val_accuracy30: 0.4120 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h30
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0553261
{'0': {'precision': 0.42132516703786194, 'recall': 0.380184389680207, 'f1-score': 0.3996989184834999, 'support': 39807}, '1': {'precision': 0.48089630117279886, 'recall': 0.39990672965794116, 'f1-score': 0.436678032148076, 'support': 49319}, '2': {'precision': 0.38240184408419303, 'recall': 0.49686985981882015, 'f1-score': 0.43218484075209007, 'support': 40733}, 'accuracy': 0.4242755604155276, 'macro avg': {'precision': 0.42820777076495126, 'recall': 0.42565365971898944, 'f1-score': 0.422853930461222, 'support': 129859}, 'weighted avg': {'precision': 0.43174050252118734, 'recall': 0.4242755604155276, 'f1-score': 0.42393306458496155, 'support': 129859}}
[[15134 10733 13940]
 [10849 19723 18747]
 [ 9937 10557 20239]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0508311
{'0': {'precision': 0.4440053328254452, 'recall': 0.4144076082126033, 'f1-score': 0.4286962118425891, 'support': 22502}, '1': {'precision': 0.45292946530147893, 'recall': 0.42793801504836976, 'f1-score': 0.4400792188651437, 'support': 22328}, '2': {'precision': 0.43654249314626675, 'recall': 0.4905762957593331, 'f1-score': 0.4619848109906989, 'support': 22072}, 'accuracy': 0.44405249469373115, 'macro avg': {'precision': 0.44449243042439696, 'recall': 0.444307306340102, 'f1-score': 0.44358674723281055, 'support': 66902}, 'weighted avg': {'precision': 0.4445215839468774, 'recall': 0.44405249469373115, 'f1-score': 0.44347761959118676, 'support': 66902}}
[[ 9325  6006  7171]
 [ 5968  9555  6805]
 [ 5709  5535 10828]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0748111
{'0': {'precision': 0.41933085501858736, 'recall': 0.432183908045977, 'f1-score': 0.4256603773584906, 'support': 6525}, '1': {'precision': 0.37066899106559165, 'recall': 0.30715059588299026, 'f1-score': 0.3359336427372371, 'support': 5538}, '2': {'precision': 0.42779291553133514, 'recall': 0.47640722196935215, 'f1-score': 0.45079319503266096, 'support': 6591}, 'accuracy': 0.41068939637611235, 'macro avg': {'precision': 0.4059309205385047, 'recall': 0.40524724196610645, 'f1-score': 0.40412907170946283, 'support': 18654}, 'weighted avg': {'precision': 0.4078740113533054, 'recall': 0.41068939637611235, 'f1-score': 0.40790245653496504, 'support': 18654}}
[[2820 1478 2227]
 [1864 1701 1973]
 [2041 1410 3140]]
training model: results/XRAY/W9/deepVOL_L3/h50
Epoch 1/50
262/262 - 11s - loss: 3.3329 - accuracy50: 0.3616 - val_loss: 3.3855 - val_accuracy50: 0.3408 - 11s/epoch - 42ms/step
Epoch 2/50
262/262 - 9s - loss: 3.3235 - accuracy50: 0.3571 - val_loss: 3.3095 - val_accuracy50: 0.3420 - 9s/epoch - 35ms/step
Epoch 3/50
262/262 - 9s - loss: 3.2889 - accuracy50: 0.3614 - val_loss: 3.3006 - val_accuracy50: 0.3468 - 9s/epoch - 35ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2724 - accuracy50: 0.3738 - val_loss: 3.3059 - val_accuracy50: 0.3519 - 9s/epoch - 34ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2613 - accuracy50: 0.3796 - val_loss: 3.2931 - val_accuracy50: 0.3575 - 9s/epoch - 34ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2507 - accuracy50: 0.3900 - val_loss: 3.3280 - val_accuracy50: 0.3479 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2556 - accuracy50: 0.3903 - val_loss: 3.3031 - val_accuracy50: 0.3676 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.2315 - accuracy50: 0.4038 - val_loss: 3.3004 - val_accuracy50: 0.3706 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2172 - accuracy50: 0.4120 - val_loss: 3.2847 - val_accuracy50: 0.3758 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.2014 - accuracy50: 0.4185 - val_loss: 3.2719 - val_accuracy50: 0.3810 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.1910 - accuracy50: 0.4233 - val_loss: 3.2694 - val_accuracy50: 0.3831 - 9s/epoch - 35ms/step
Epoch 12/50
262/262 - 9s - loss: 3.1821 - accuracy50: 0.4276 - val_loss: 3.2810 - val_accuracy50: 0.3860 - 9s/epoch - 35ms/step
Epoch 13/50
262/262 - 9s - loss: 3.1733 - accuracy50: 0.4299 - val_loss: 3.2811 - val_accuracy50: 0.3815 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.1638 - accuracy50: 0.4327 - val_loss: 3.2887 - val_accuracy50: 0.3812 - 9s/epoch - 34ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1522 - accuracy50: 0.4410 - val_loss: 3.2899 - val_accuracy50: 0.3770 - 9s/epoch - 34ms/step
Epoch 16/50
262/262 - 9s - loss: 3.1465 - accuracy50: 0.4438 - val_loss: 3.2870 - val_accuracy50: 0.3808 - 9s/epoch - 33ms/step
Epoch 17/50
262/262 - 9s - loss: 3.1366 - accuracy50: 0.4495 - val_loss: 3.2815 - val_accuracy50: 0.3836 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 3.1261 - accuracy50: 0.4529 - val_loss: 3.2939 - val_accuracy50: 0.3821 - 9s/epoch - 33ms/step
Epoch 19/50
262/262 - 9s - loss: 3.1218 - accuracy50: 0.4532 - val_loss: 3.2893 - val_accuracy50: 0.3827 - 9s/epoch - 34ms/step
Epoch 20/50
262/262 - 9s - loss: 3.1144 - accuracy50: 0.4555 - val_loss: 3.2989 - val_accuracy50: 0.3775 - 9s/epoch - 34ms/step
Epoch 21/50
262/262 - 9s - loss: 3.1060 - accuracy50: 0.4588 - val_loss: 3.2987 - val_accuracy50: 0.3861 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h50
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0790128
{'0': {'precision': 0.40900302114803627, 'recall': 0.31446424008733825, 'f1-score': 0.3555567228270147, 'support': 43051}, '1': {'precision': 0.39827925582576673, 'recall': 0.3008826210006236, 'f1-score': 0.34279702699748604, 'support': 41694}, '2': {'precision': 0.3909685723479567, 'recall': 0.5655672296847986, 'f1-score': 0.4623329558323896, 'support': 45114}, 'accuracy': 0.39733865192246975, 'macro avg': {'precision': 0.39941694977391995, 'recall': 0.3936380302575868, 'f1-score': 0.3868955685522968, 'support': 129859}, 'weighted avg': {'precision': 0.3992946236206142, 'recall': 0.39733865192246975, 'f1-score': 0.38855482244189016, 'support': 129859}}
[[13538  9786 19727]
 [ 9130 12545 20019]
 [10432  9167 25515]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0663221
{'0': {'precision': 0.4170667722615453, 'recall': 0.37091165206673415, 'f1-score': 0.3926374650512581, 'support': 22717}, '1': {'precision': 0.454158538748005, 'recall': 0.35056579667822596, 'f1-score': 0.39569438364277804, 'support': 21916}, '2': {'precision': 0.4054126653683433, 'recall': 0.5421886928016525, 'f1-score': 0.46392960750033624, 'support': 22269}, 'accuracy': 0.42125795940330635, 'macro avg': {'precision': 0.42554599212596456, 'recall': 0.4212220471822042, 'f1-score': 0.4174204853981241, 'support': 66902}, 'weighted avg': {'precision': 0.4253382416931398, 'recall': 0.42125795940330635, 'f1-score': 0.41736916437340504, 'support': 66902}}
[[ 8426  4763  9528]
 [ 6053  7683  8180]
 [ 5724  4471 12074]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901103
{'0': {'precision': 0.38231592196349906, 'recall': 0.3796875, 'f1-score': 0.380997177798683, 'support': 6400}, '1': {'precision': 0.40148367952522257, 'recall': 0.2279312668463612, 'f1-score': 0.29078014184397166, 'support': 5936}, '2': {'precision': 0.3720878136200717, 'recall': 0.5257993035770814, 'f1-score': 0.43578643578643583, 'support': 6318}, 'accuracy': 0.38088345663128553, 'macro avg': {'precision': 0.3852958050362645, 'recall': 0.37780602347448083, 'f1-score': 0.3691879184763635, 'support': 18654}, 'weighted avg': {'precision': 0.38495120771307645, 'recall': 0.38088345663128553, 'f1-score': 0.37084547878182095, 'support': 18654}}
[[2430 1015 2955]
 [1932 1353 2651]
 [1994 1002 3322]]
training model: results/XRAY/W9/deepVOL_L3/h100
Epoch 1/50
262/262 - 12s - loss: 3.3442 - accuracy100: 0.3524 - val_loss: 3.3375 - val_accuracy100: 0.3462 - 12s/epoch - 44ms/step
Epoch 2/50
262/262 - 10s - loss: 3.3087 - accuracy100: 0.3606 - val_loss: 3.3164 - val_accuracy100: 0.3388 - 10s/epoch - 38ms/step
Epoch 3/50
262/262 - 10s - loss: 3.2936 - accuracy100: 0.3626 - val_loss: 3.2965 - val_accuracy100: 0.3537 - 10s/epoch - 38ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2735 - accuracy100: 0.3733 - val_loss: 3.3085 - val_accuracy100: 0.3529 - 9s/epoch - 34ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2615 - accuracy100: 0.3818 - val_loss: 3.2951 - val_accuracy100: 0.3584 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2489 - accuracy100: 0.3921 - val_loss: 3.2956 - val_accuracy100: 0.3582 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2333 - accuracy100: 0.4016 - val_loss: 3.3008 - val_accuracy100: 0.3521 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.2301 - accuracy100: 0.4039 - val_loss: 3.3013 - val_accuracy100: 0.3584 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2171 - accuracy100: 0.4114 - val_loss: 3.3016 - val_accuracy100: 0.3538 - 9s/epoch - 35ms/step
Epoch 10/50
262/262 - 9s - loss: 3.2045 - accuracy100: 0.4160 - val_loss: 3.2957 - val_accuracy100: 0.3612 - 9s/epoch - 35ms/step
Epoch 11/50
262/262 - 9s - loss: 3.1951 - accuracy100: 0.4226 - val_loss: 3.2993 - val_accuracy100: 0.3599 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 9s - loss: 3.1842 - accuracy100: 0.4279 - val_loss: 3.3032 - val_accuracy100: 0.3623 - 9s/epoch - 34ms/step
Epoch 13/50
262/262 - 9s - loss: 3.1732 - accuracy100: 0.4341 - val_loss: 3.3123 - val_accuracy100: 0.3664 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.1718 - accuracy100: 0.4358 - val_loss: 3.3055 - val_accuracy100: 0.3669 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1560 - accuracy100: 0.4407 - val_loss: 3.3130 - val_accuracy100: 0.3691 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h100
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786449
{'0': {'precision': 0.3961799137399877, 'recall': 0.29433589515021563, 'f1-score': 0.33774742895056953, 'support': 41507}, '1': {'precision': 0.4391854705558613, 'recall': 0.5569830087028595, 'f1-score': 0.4911194237962901, 'support': 45847}, '2': {'precision': 0.3576006653945888, 'recall': 0.3439124808846018, 'f1-score': 0.35062302867490974, 'support': 42505}, 'accuracy': 0.4032912620611586, 'macro avg': {'precision': 0.39765534989681256, 'recall': 0.39841046157922566, 'f1-score': 0.39316329380725645, 'support': 129859}, 'weighted avg': {'precision': 0.39873549180863266, 'recall': 0.4032912620611586, 'f1-score': 0.3961101393824597, 'support': 129859}}
[[12217 15624 13666]
 [ 7717 25536 12594]
 [10903 16984 14618]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0821112
{'0': {'precision': 0.39096063678988113, 'recall': 0.31962025316455694, 'f1-score': 0.351709254990436, 'support': 22436}, '1': {'precision': 0.40476873431337396, 'recall': 0.5085593296693396, 'f1-score': 0.4507666506947772, 'support': 22198}, '2': {'precision': 0.3805515239477504, 'recall': 0.3532423208191126, 'f1-score': 0.36638874656481435, 'support': 22268}, 'accuracy': 0.3935009416758841, 'macro avg': {'precision': 0.3920936316836685, 'recall': 0.3938073012176697, 'f1-score': 0.38962155075000915, 'support': 66902}, 'weighted avg': {'precision': 0.3920775245370027, 'recall': 0.3935009416758841, 'f1-score': 0.38946237131316513, 'support': 66902}}
[[ 7171  8362  6903]
 [ 5008 11289  5901]
 [ 6163  8239  7866]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985186
{'0': {'precision': 0.367707404103479, 'recall': 0.31953488372093025, 'f1-score': 0.3419328079635006, 'support': 6450}, '1': {'precision': 0.35692963752665247, 'recall': 0.4220168067226891, 'f1-score': 0.3867539468617636, 'support': 5950}, '2': {'precision': 0.33721316927169936, 'recall': 0.3242724656220019, 'f1-score': 0.3306162373655037, 'support': 6254}, 'accuracy': 0.3538115149565777, 'macro avg': {'precision': 0.35395007030061026, 'recall': 0.3552747186885404, 'f1-score': 0.35310099739692263, 'support': 18654}, 'weighted avg': {'precision': 0.3540460630629479, 'recall': 0.3538115149565777, 'f1-score': 0.3524352173086701, 'support': 18654}}
[[2061 2258 2131]
 [1584 2511 1855]
 [1960 2266 2028]]
training model: results/XRAY/W9/deepVOL_L3/h200
Epoch 1/50
262/262 - 12s - loss: 3.3154 - accuracy200: 0.3719 - val_loss: 3.3410 - val_accuracy200: 0.3402 - 12s/epoch - 45ms/step
Epoch 2/50
262/262 - 9s - loss: 3.2901 - accuracy200: 0.3764 - val_loss: 3.3377 - val_accuracy200: 0.3391 - 9s/epoch - 35ms/step
Epoch 3/50
262/262 - 9s - loss: 3.2870 - accuracy200: 0.3696 - val_loss: 3.3116 - val_accuracy200: 0.3434 - 9s/epoch - 34ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2684 - accuracy200: 0.3739 - val_loss: 3.3144 - val_accuracy200: 0.3372 - 9s/epoch - 33ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2617 - accuracy200: 0.3769 - val_loss: 3.3280 - val_accuracy200: 0.3324 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2424 - accuracy200: 0.3876 - val_loss: 3.3360 - val_accuracy200: 0.3300 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2383 - accuracy200: 0.3890 - val_loss: 3.3144 - val_accuracy200: 0.3362 - 9s/epoch - 34ms/step
Epoch 8/50
262/262 - 9s - loss: 3.2236 - accuracy200: 0.3977 - val_loss: 3.2983 - val_accuracy200: 0.3374 - 9s/epoch - 34ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2223 - accuracy200: 0.4049 - val_loss: 3.2899 - val_accuracy200: 0.3578 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.2250 - accuracy200: 0.3973 - val_loss: 3.3230 - val_accuracy200: 0.3406 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.2142 - accuracy200: 0.4067 - val_loss: 3.3369 - val_accuracy200: 0.3394 - 9s/epoch - 36ms/step
Epoch 12/50
262/262 - 9s - loss: 3.2068 - accuracy200: 0.4071 - val_loss: 3.3153 - val_accuracy200: 0.3461 - 9s/epoch - 34ms/step
Epoch 13/50
262/262 - 9s - loss: 3.1992 - accuracy200: 0.4119 - val_loss: 3.3154 - val_accuracy200: 0.3458 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.1890 - accuracy200: 0.4155 - val_loss: 3.3330 - val_accuracy200: 0.3479 - 9s/epoch - 36ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1824 - accuracy200: 0.4175 - val_loss: 3.3236 - val_accuracy200: 0.3463 - 9s/epoch - 36ms/step
Epoch 16/50
262/262 - 9s - loss: 3.1716 - accuracy200: 0.4234 - val_loss: 3.3291 - val_accuracy200: 0.3468 - 9s/epoch - 34ms/step
Epoch 17/50
262/262 - 9s - loss: 3.1604 - accuracy200: 0.4293 - val_loss: 3.3200 - val_accuracy200: 0.3509 - 9s/epoch - 34ms/step
Epoch 18/50
262/262 - 9s - loss: 3.1524 - accuracy200: 0.4323 - val_loss: 3.3333 - val_accuracy200: 0.3468 - 9s/epoch - 34ms/step
Epoch 19/50
262/262 - 9s - loss: 3.1431 - accuracy200: 0.4361 - val_loss: 3.3301 - val_accuracy200: 0.3516 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h200
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0853974
{'0': {'precision': 0.346559313272451, 'recall': 0.5126992955135335, 'f1-score': 0.4135674963314671, 'support': 43152}, '1': {'precision': 0.4625364702961078, 'recall': 0.34508151167098927, 'f1-score': 0.3952680300257288, 'support': 43184}, '2': {'precision': 0.3621383350097627, 'recall': 0.28125359005583256, 'f1-score': 0.31661170384739734, 'support': 43523}, 'accuracy': 0.3793884135870444, 'macro avg': {'precision': 0.3904113728594405, 'recall': 0.3796781324134518, 'f1-score': 0.3751490767348644, 'support': 129859}, 'weighted avg': {'precision': 0.39034837149700696, 'recall': 0.3793884135870444, 'f1-score': 0.3749867964244051, 'support': 129859}}
[[22124  9135 11893]
 [18614 14902  9668]
 [23101  8181 12241]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0842538
{'0': {'precision': 0.3595161673799334, 'recall': 0.5373101181487074, 'f1-score': 0.43078950179836895, 'support': 22514}, '1': {'precision': 0.44986759749638905, 'recall': 0.34059324736866087, 'f1-score': 0.38767730726343913, 'support': 21947}, '2': {'precision': 0.37191970188724605, 'recall': 0.27574528764315315, 'f1-score': 0.3166918293712736, 'support': 22441}, 'accuracy': 0.3850408059549789, 'macro avg': {'precision': 0.39376782225452284, 'recall': 0.38454955105350713, 'f1-score': 0.3783862128110272, 'support': 66902}, 'weighted avg': {'precision': 0.39331621154370205, 'recall': 0.3850408059549789, 'f1-score': 0.37837478773310107, 'support': 66902}}
[[12097  4751  5666]
 [ 9688  7475  4784]
 [11863  4390  6188]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961307
{'0': {'precision': 0.3569036832775261, 'recall': 0.5506761890290229, 'f1-score': 0.43310427248282046, 'support': 6581}, '1': {'precision': 0.37779715199070035, 'recall': 0.21706461846718986, 'f1-score': 0.2757158006362672, 'support': 5989}, '2': {'precision': 0.3320814390195691, 'recall': 0.27613412228796846, 'f1-score': 0.3015345957103115, 'support': 6084}, 'accuracy': 0.3540259461777635, 'macro avg': {'precision': 0.3555940914292652, 'recall': 0.34795830992806037, 'f1-score': 0.33678488960979974, 'support': 18654}, 'weighted avg': {'precision': 0.3555159085406219, 'recall': 0.3540259461777635, 'f1-score': 0.33966214364327124, 'support': 18654}}
[[3624 1092 1865]
 [3175 1300 1514]
 [3355 1049 1680]]
training model: results/XRAY/W9/deepVOL_L3/h300
Epoch 1/50
262/262 - 11s - loss: 3.3369 - accuracy300: 0.3594 - val_loss: 3.3272 - val_accuracy300: 0.3450 - 11s/epoch - 42ms/step
Epoch 2/50
262/262 - 9s - loss: 3.3129 - accuracy300: 0.3621 - val_loss: 3.3211 - val_accuracy300: 0.3492 - 9s/epoch - 34ms/step
Epoch 3/50
262/262 - 9s - loss: 3.3001 - accuracy300: 0.3675 - val_loss: 3.2891 - val_accuracy300: 0.3627 - 9s/epoch - 33ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2739 - accuracy300: 0.3752 - val_loss: 3.2932 - val_accuracy300: 0.3599 - 9s/epoch - 33ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2545 - accuracy300: 0.3848 - val_loss: 3.3021 - val_accuracy300: 0.3533 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2486 - accuracy300: 0.3890 - val_loss: 3.2815 - val_accuracy300: 0.3733 - 9s/epoch - 34ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2315 - accuracy300: 0.3985 - val_loss: 3.2840 - val_accuracy300: 0.3723 - 9s/epoch - 34ms/step
Epoch 8/50
262/262 - 9s - loss: 3.2144 - accuracy300: 0.4106 - val_loss: 3.2961 - val_accuracy300: 0.3674 - 9s/epoch - 34ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2026 - accuracy300: 0.4163 - val_loss: 3.2941 - val_accuracy300: 0.3714 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.1922 - accuracy300: 0.4212 - val_loss: 3.2870 - val_accuracy300: 0.3721 - 9s/epoch - 34ms/step
Epoch 11/50
262/262 - 9s - loss: 3.1821 - accuracy300: 0.4253 - val_loss: 3.2896 - val_accuracy300: 0.3690 - 9s/epoch - 34ms/step
Epoch 12/50
262/262 - 9s - loss: 3.1706 - accuracy300: 0.4308 - val_loss: 3.2963 - val_accuracy300: 0.3709 - 9s/epoch - 33ms/step
Epoch 13/50
262/262 - 9s - loss: 3.1604 - accuracy300: 0.4361 - val_loss: 3.3007 - val_accuracy300: 0.3683 - 9s/epoch - 33ms/step
Epoch 14/50
262/262 - 9s - loss: 3.1470 - accuracy300: 0.4380 - val_loss: 3.3188 - val_accuracy300: 0.3653 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1370 - accuracy300: 0.4437 - val_loss: 3.3368 - val_accuracy300: 0.3592 - 9s/epoch - 33ms/step
Epoch 16/50
262/262 - 9s - loss: 3.1224 - accuracy300: 0.4490 - val_loss: 3.3543 - val_accuracy300: 0.3577 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h300
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0796881
{'0': {'precision': 0.33003185130241286, 'recall': 0.18606252921063637, 'f1-score': 0.23796640030201976, 'support': 40653}, '1': {'precision': 0.4490568179668136, 'recall': 0.5129901007219124, 'f1-score': 0.47889910108051936, 'support': 46266}, '2': {'precision': 0.36639118457300274, 'recall': 0.4615044247787611, 'f1-score': 0.408484236346584, 'support': 42940}, 'accuracy': 0.3936192331682825, 'macro avg': {'precision': 0.38182661794740974, 'recall': 0.3868523515704367, 'f1-score': 0.37511657924304104, 'support': 129859}, 'weighted avg': {'precision': 0.38446072321991026, 'recall': 0.3936192331682825, 'f1-score': 0.3801901061211902, 'support': 129859}}
[[ 7564 13790 19299]
 [ 7561 23734 14971]
 [ 7794 15329 19817]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0831596
{'0': {'precision': 0.3730562200956938, 'recall': 0.22347619687402034, 'f1-score': 0.2795126732950567, 'support': 22329}, '1': {'precision': 0.41395278792214146, 'recall': 0.4971064291527263, 'f1-score': 0.4517348343228086, 'support': 22118}, '2': {'precision': 0.3849805303170777, 'recall': 0.4623023825428635, 'f1-score': 0.4201133144475921, 'support': 22455}, 'accuracy': 0.39409883112612476, 'macro avg': {'precision': 0.39066317944497103, 'recall': 0.3942950028565367, 'f1-score': 0.3837869406884858, 'support': 66902}, 'weighted avg': {'precision': 0.3905790246935615, 'recall': 0.39409883112612476, 'f1-score': 0.3836410574194775, 'support': 66902}}
[[ 4990  7921  9418]
 [ 3957 10995  7166]
 [ 4429  7645 10381]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927265
{'0': {'precision': 0.3665, 'recall': 0.22686474775611265, 'f1-score': 0.28025234180844966, 'support': 6462}, '1': {'precision': 0.41917896087235407, 'recall': 0.42455741432515837, 'f1-score': 0.42185104494472686, 'support': 6157}, '2': {'precision': 0.34319315751960083, 'recall': 0.4787075393537697, 'f1-score': 0.3997785926797205, 'support': 6035}, 'accuracy': 0.37359279511096816, 'macro avg': {'precision': 0.3762907061306516, 'recall': 0.3767099004783469, 'f1-score': 0.36729399314429906, 'support': 18654}, 'weighted avg': {'precision': 0.37634708736581296, 'recall': 0.37359279511096816, 'f1-score': 0.36565837478894603, 'support': 18654}}
[[1466 1835 3161]
 [1175 2614 2368]
 [1359 1787 2889]]
training model: results/XRAY/W9/deepVOL_L3/h500
Epoch 1/50
262/262 - 11s - loss: 3.3454 - accuracy500: 0.3582 - val_loss: 3.3490 - val_accuracy500: 0.3397 - 11s/epoch - 42ms/step
Epoch 2/50
262/262 - 9s - loss: 3.3269 - accuracy500: 0.3628 - val_loss: 3.3251 - val_accuracy500: 0.3467 - 9s/epoch - 34ms/step
Epoch 3/50
262/262 - 9s - loss: 3.3105 - accuracy500: 0.3559 - val_loss: 3.3218 - val_accuracy500: 0.3281 - 9s/epoch - 33ms/step
Epoch 4/50
262/262 - 9s - loss: 3.2853 - accuracy500: 0.3605 - val_loss: 3.3109 - val_accuracy500: 0.3441 - 9s/epoch - 34ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2712 - accuracy500: 0.3744 - val_loss: 3.3230 - val_accuracy500: 0.3416 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.2560 - accuracy500: 0.3841 - val_loss: 3.3149 - val_accuracy500: 0.3465 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2495 - accuracy500: 0.3892 - val_loss: 3.3088 - val_accuracy500: 0.3522 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.2402 - accuracy500: 0.3967 - val_loss: 3.3113 - val_accuracy500: 0.3494 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2376 - accuracy500: 0.4001 - val_loss: 3.3172 - val_accuracy500: 0.3464 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.2309 - accuracy500: 0.4046 - val_loss: 3.3084 - val_accuracy500: 0.3479 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.2280 - accuracy500: 0.4080 - val_loss: 3.3150 - val_accuracy500: 0.3539 - 9s/epoch - 33ms/step
Epoch 12/50
262/262 - 9s - loss: 3.2328 - accuracy500: 0.4071 - val_loss: 3.3250 - val_accuracy500: 0.3495 - 9s/epoch - 33ms/step
Epoch 13/50
262/262 - 9s - loss: 3.2112 - accuracy500: 0.4181 - val_loss: 3.3354 - val_accuracy500: 0.3483 - 9s/epoch - 34ms/step
Epoch 14/50
262/262 - 9s - loss: 3.2019 - accuracy500: 0.4207 - val_loss: 3.3252 - val_accuracy500: 0.3590 - 9s/epoch - 33ms/step
Epoch 15/50
262/262 - 9s - loss: 3.1959 - accuracy500: 0.4230 - val_loss: 3.3561 - val_accuracy500: 0.3442 - 9s/epoch - 34ms/step
Epoch 16/50
262/262 - 9s - loss: 3.1875 - accuracy500: 0.4273 - val_loss: 3.3741 - val_accuracy500: 0.3435 - 9s/epoch - 33ms/step
Epoch 17/50
262/262 - 9s - loss: 3.1694 - accuracy500: 0.4352 - val_loss: 3.3719 - val_accuracy500: 0.3590 - 9s/epoch - 33ms/step
Epoch 18/50
262/262 - 9s - loss: 3.1639 - accuracy500: 0.4361 - val_loss: 3.3991 - val_accuracy500: 0.3449 - 9s/epoch - 34ms/step
Epoch 19/50
262/262 - 9s - loss: 3.1495 - accuracy500: 0.4411 - val_loss: 3.4271 - val_accuracy500: 0.3444 - 9s/epoch - 33ms/step
Epoch 20/50
262/262 - 10s - loss: 3.1418 - accuracy500: 0.4427 - val_loss: 3.4320 - val_accuracy500: 0.3458 - 10s/epoch - 37ms/step
testing model: results/XRAY/W9/deepVOL_L3/h500
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973508
{'0': {'precision': 0.33514246947082765, 'recall': 0.0960692320781778, 'f1-score': 0.14933212416633604, 'support': 41137}, '1': {'precision': 0.39327666151468316, 'recall': 0.3458140799130198, 'f1-score': 0.3680214058432166, 'support': 44148}, '2': {'precision': 0.3599126780824511, 'recall': 0.6398797505272131, 'f1-score': 0.4606972969044023, 'support': 44574}, 'accuracy': 0.36763720650859777, 'macro avg': {'precision': 0.3627772696893206, 'recall': 0.3605876875061369, 'f1-score': 0.32601694230465167, 'support': 129859}, 'weighted avg': {'precision': 0.36340863191630035, 'recall': 0.36763720650859777, 'f1-score': 0.33055549426080383, 'support': 129859}}
[[ 3952 11600 25585]
 [ 3741 15267 25140]
 [ 4099 11953 28522]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895855
{'0': {'precision': 0.4314854811615071, 'recall': 0.15894625176803395, 'f1-score': 0.2323147490147943, 'support': 22624}, '1': {'precision': 0.40181970104911335, 'recall': 0.39155018772334554, 'f1-score': 0.3966184792320557, 'support': 22107}, '2': {'precision': 0.3697671906228056, 'recall': 0.6175183798655902, 'f1-score': 0.46255722418365797, 'support': 22171}, 'accuracy': 0.3877761501898299, 'macro avg': {'precision': 0.4010241242778087, 'recall': 0.3893382731189899, 'f1-score': 0.36383015081016934, 'support': 66902}, 'weighted avg': {'precision': 0.4012296200440781, 'recall': 0.3877761501898299, 'f1-score': 0.3629082810599032, 'support': 66902}}
[[ 3596  6816 12212]
 [ 2328  8656 11123]
 [ 2410  6070 13691]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033534
{'0': {'precision': 0.37216404886561955, 'recall': 0.13464877663772692, 'f1-score': 0.19775124608786368, 'support': 6335}, '1': {'precision': 0.37317568815813784, 'recall': 0.3186119873817035, 'f1-score': 0.34374202331319664, 'support': 6340}, '2': {'precision': 0.3334551100557129, 'recall': 0.6106372303060712, 'f1-score': 0.4313563327032136, 'support': 5979}, 'accuracy': 0.34973732175404737, 'macro avg': {'precision': 0.3595982823598234, 'recall': 0.3546326647751672, 'f1-score': 0.32428320070142463, 'support': 18654}, 'weighted avg': {'precision': 0.3601008478347486, 'recall': 0.34973732175404737, 'f1-score': 0.32224499222712544, 'support': 18654}}
[[ 853 1778 3704]
 [ 726 2020 3594]
 [ 713 1615 3651]]
training model: results/XRAY/W9/deepVOL_L3/h1000
Epoch 1/50
262/262 - 12s - loss: 3.3683 - accuracy1000: 0.3561 - val_loss: 3.3278 - val_accuracy1000: 0.3324 - 12s/epoch - 45ms/step
Epoch 2/50
262/262 - 9s - loss: 3.3295 - accuracy1000: 0.3481 - val_loss: 3.3256 - val_accuracy1000: 0.3386 - 9s/epoch - 34ms/step
Epoch 3/50
262/262 - 9s - loss: 3.3156 - accuracy1000: 0.3363 - val_loss: 3.3105 - val_accuracy1000: 0.3391 - 9s/epoch - 34ms/step
Epoch 4/50
262/262 - 9s - loss: 3.3026 - accuracy1000: 0.3519 - val_loss: 3.3229 - val_accuracy1000: 0.3396 - 9s/epoch - 34ms/step
Epoch 5/50
262/262 - 9s - loss: 3.2885 - accuracy1000: 0.3683 - val_loss: 3.3076 - val_accuracy1000: 0.3370 - 9s/epoch - 33ms/step
Epoch 6/50
262/262 - 9s - loss: 3.3047 - accuracy1000: 0.3508 - val_loss: 3.3201 - val_accuracy1000: 0.3414 - 9s/epoch - 33ms/step
Epoch 7/50
262/262 - 9s - loss: 3.2747 - accuracy1000: 0.3808 - val_loss: 3.3583 - val_accuracy1000: 0.3468 - 9s/epoch - 33ms/step
Epoch 8/50
262/262 - 9s - loss: 3.3005 - accuracy1000: 0.3689 - val_loss: 3.3232 - val_accuracy1000: 0.3404 - 9s/epoch - 33ms/step
Epoch 9/50
262/262 - 9s - loss: 3.2772 - accuracy1000: 0.3749 - val_loss: 3.3207 - val_accuracy1000: 0.3447 - 9s/epoch - 33ms/step
Epoch 10/50
262/262 - 9s - loss: 3.2753 - accuracy1000: 0.3758 - val_loss: 3.3208 - val_accuracy1000: 0.3419 - 9s/epoch - 33ms/step
Epoch 11/50
262/262 - 9s - loss: 3.2650 - accuracy1000: 0.3798 - val_loss: 3.3180 - val_accuracy1000: 0.3421 - 9s/epoch - 34ms/step
Epoch 12/50
262/262 - 9s - loss: 3.2568 - accuracy1000: 0.3842 - val_loss: 3.3192 - val_accuracy1000: 0.3389 - 9s/epoch - 33ms/step
Epoch 13/50
262/262 - 9s - loss: 3.2455 - accuracy1000: 0.3897 - val_loss: 3.3252 - val_accuracy1000: 0.3383 - 9s/epoch - 34ms/step
Epoch 14/50
262/262 - 9s - loss: 3.2390 - accuracy1000: 0.3948 - val_loss: 3.3217 - val_accuracy1000: 0.3413 - 9s/epoch - 34ms/step
Epoch 15/50
262/262 - 9s - loss: 3.2321 - accuracy1000: 0.3978 - val_loss: 3.3381 - val_accuracy1000: 0.3417 - 9s/epoch - 33ms/step
testing model: results/XRAY/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009079
{'0': {'precision': 0.31719021202736275, 'recall': 0.22293983973208947, 'f1-score': 0.26184188346350507, 'support': 41805}, '1': {'precision': 0.2955378111789573, 'recall': 0.16028939725887809, 'f1-score': 0.20784883720930233, 'support': 39254}, '2': {'precision': 0.3682721693228601, 'recall': 0.5975819672131147, 'f1-score': 0.4557060928539059, 'support': 48800}, 'accuracy': 0.3447893484471619, 'macro avg': {'precision': 0.3270000641763934, 'recall': 0.3269370680680274, 'f1-score': 0.3084656045089044, 'support': 129859}, 'weighted avg': {'precision': 0.3298412887576392, 'recall': 0.3447893484471619, 'f1-score': 0.3183734321477633, 'support': 129859}}
[[ 9320  6741 25744]
 [ 8682  6292 24280]
 [11381  8257 29162]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033218
{'0': {'precision': 0.3481376283003034, 'recall': 0.23052919552021886, 'f1-score': 0.2773820239166774, 'support': 23394}, '1': {'precision': 0.3149467757543767, 'recall': 0.16794107988929025, 'f1-score': 0.2190674336066577, 'support': 21317}, '2': {'precision': 0.33051143741883926, 'recall': 0.5964129602090937, 'f1-score': 0.42532337109343615, 'support': 22191}, 'accuracy': 0.33194822277360914, 'macro avg': {'precision': 0.3311986138245065, 'recall': 0.3316277452062009, 'f1-score': 0.3072576095389237, 'support': 66902}, 'weighted avg': {'precision': 0.33171551527569887, 'recall': 0.33194822277360914, 'f1-score': 0.3078725072140491, 'support': 66902}}
[[ 5393  3978 14023]
 [ 4951  3580 12786]
 [ 5147  3809 13235]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024995
{'0': {'precision': 0.35269516728624534, 'recall': 0.23382624768946395, 'f1-score': 0.2812152649129307, 'support': 6492}, '1': {'precision': 0.31589210269743256, 'recall': 0.1635537607269056, 'f1-score': 0.21552106430155213, 'support': 5943}, '2': {'precision': 0.3374434489488157, 'recall': 0.6116739025566812, 'f1-score': 0.4349416876286302, 'support': 6219}, 'accuracy': 0.33740752653586364, 'macro avg': {'precision': 0.33534357297749784, 'recall': 0.33635130365768356, 'f1-score': 0.3105593389477044, 'support': 18654}, 'weighted avg': {'precision': 0.33588531153456797, 'recall': 0.33740752653586364, 'f1-score': 0.3115360534105994, 'support': 18654}}
[[1518 1112 3862]
 [1364  972 3607]
 [1422  993 3804]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        14 (peak)   9.12 (ave)

============================================
