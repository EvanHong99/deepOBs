This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-14.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-02.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-10.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-08.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-03.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-09.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-31.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2020-01-15.csv
training model: results/CHTR/W10/deepLOB_L1/h10
Epoch 1/50
295/295 - 18s - loss: 3.3239 - accuracy10: 0.3646 - val_loss: 3.4327 - val_accuracy10: 0.3254 - 18s/epoch - 62ms/step
Epoch 2/50
295/295 - 8s - loss: 3.2941 - accuracy10: 0.3763 - val_loss: 3.3425 - val_accuracy10: 0.3578 - 8s/epoch - 26ms/step
Epoch 3/50
295/295 - 8s - loss: 3.2822 - accuracy10: 0.3787 - val_loss: 3.3790 - val_accuracy10: 0.3326 - 8s/epoch - 25ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2721 - accuracy10: 0.3858 - val_loss: 3.3359 - val_accuracy10: 0.3400 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2626 - accuracy10: 0.3903 - val_loss: 3.3046 - val_accuracy10: 0.3584 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2558 - accuracy10: 0.3946 - val_loss: 3.2819 - val_accuracy10: 0.3798 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2454 - accuracy10: 0.3999 - val_loss: 3.2914 - val_accuracy10: 0.3748 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2443 - accuracy10: 0.4009 - val_loss: 3.2847 - val_accuracy10: 0.3727 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2343 - accuracy10: 0.4047 - val_loss: 3.2902 - val_accuracy10: 0.3781 - 7s/epoch - 25ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2270 - accuracy10: 0.4132 - val_loss: 3.2711 - val_accuracy10: 0.3919 - 8s/epoch - 25ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2235 - accuracy10: 0.4132 - val_loss: 3.3030 - val_accuracy10: 0.3744 - 8s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2164 - accuracy10: 0.4181 - val_loss: 3.3025 - val_accuracy10: 0.3757 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2131 - accuracy10: 0.4178 - val_loss: 3.3073 - val_accuracy10: 0.3728 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2094 - accuracy10: 0.4208 - val_loss: 3.2928 - val_accuracy10: 0.3794 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2042 - accuracy10: 0.4220 - val_loss: 3.2892 - val_accuracy10: 0.3802 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 8s - loss: 3.1984 - accuracy10: 0.4256 - val_loss: 3.3226 - val_accuracy10: 0.3620 - 8s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.1951 - accuracy10: 0.4286 - val_loss: 3.2996 - val_accuracy10: 0.3744 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 8s - loss: 3.1922 - accuracy10: 0.4284 - val_loss: 3.2993 - val_accuracy10: 0.3747 - 8s/epoch - 26ms/step
Epoch 19/50
295/295 - 8s - loss: 3.1905 - accuracy10: 0.4299 - val_loss: 3.3296 - val_accuracy10: 0.3671 - 8s/epoch - 26ms/step
Epoch 20/50
295/295 - 8s - loss: 3.1861 - accuracy10: 0.4310 - val_loss: 3.3257 - val_accuracy10: 0.3673 - 8s/epoch - 25ms/step
testing model: results/CHTR/W10/deepLOB_L1/h10
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1185875
{'0': {'precision': 0.37325024120968636, 'recall': 0.16837673920799143, 'f1-score': 0.23206620347833784, 'support': 140150}, '1': {'precision': 0.2856479584869589, 'recall': 0.33098886840668684, 'f1-score': 0.3066514694510311, 'support': 126397}, '2': {'precision': 0.363671968382985, 'recall': 0.5116610251969743, 'f1-score': 0.42515653709616996, 'support': 139739}, 'accuracy': 0.3370359795808864, 'macro avg': {'precision': 0.34085672269321005, 'recall': 0.3370088776038842, 'f1-score': 0.3212914033418463, 'support': 406286}, 'weighted avg': {'precision': 0.342702489143814, 'recall': 0.3370359795808864, 'f1-score': 0.32168190274578184, 'support': 406286}}
[[23598 53071 63481]
 [22938 41836 61623]
 [16687 51553 71499]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1003299
{'0': {'precision': 0.4161787031012795, 'recall': 0.22111691504071285, 'f1-score': 0.28879580626551954, 'support': 26036}, '1': {'precision': 0.3522169191395172, 'recall': 0.6140118171952249, 'f1-score': 0.4476483516483516, 'support': 24879}, '2': {'precision': 0.397134419774691, 'recall': 0.2955035605289929, 'f1-score': 0.33886283567812225, 'support': 24575}, 'accuracy': 0.3748178566697576, 'macro avg': {'precision': 0.38851001400516255, 'recall': 0.37687743092164355, 'f1-score': 0.3584356645306645, 'support': 75490}, 'weighted avg': {'precision': 0.3888993484061465, 'recall': 0.3748178566697576, 'f1-score': 0.3574471471635748, 'support': 75490}}
[[ 5757 14781  5498]
 [ 4077 15276  5526]
 [ 3999 13314  7262]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0924376
{'0': {'precision': 0.42234659204477315, 'recall': 0.1868588609833746, 'f1-score': 0.259088958371651, 'support': 11308}, '1': {'precision': 0.3856216650410236, 'recall': 0.5834707873947391, 'f1-score': 0.4643498687301368, 'support': 11519}, '2': {'precision': 0.38271378868339134, 'recall': 0.39707419017763845, 'f1-score': 0.38976176045503286, 'support': 10527}, 'accuracy': 0.39017808958445765, 'macro avg': {'precision': 0.396894015256396, 'recall': 0.38913461285191736, 'f1-score': 0.37106686251894017, 'support': 33354}, 'weighted avg': {'precision': 0.397154742337348, 'recall': 0.39017808958445765, 'f1-score': 0.37121922802300195, 'support': 33354}}
[[2113 5749 3446]
 [1502 6721 3296]
 [1388 4959 4180]]
training model: results/CHTR/W10/deepLOB_L1/h20
Epoch 1/50
295/295 - 10s - loss: 3.3224 - accuracy20: 0.3653 - val_loss: 3.4297 - val_accuracy20: 0.3290 - 10s/epoch - 33ms/step
Epoch 2/50
295/295 - 7s - loss: 3.2943 - accuracy20: 0.3734 - val_loss: 3.4041 - val_accuracy20: 0.3315 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2833 - accuracy20: 0.3762 - val_loss: 3.4330 - val_accuracy20: 0.3350 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2714 - accuracy20: 0.3825 - val_loss: 3.3669 - val_accuracy20: 0.3188 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2724 - accuracy20: 0.3850 - val_loss: 3.4083 - val_accuracy20: 0.3182 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2609 - accuracy20: 0.3912 - val_loss: 3.3727 - val_accuracy20: 0.3353 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2543 - accuracy20: 0.3945 - val_loss: 3.3922 - val_accuracy20: 0.3079 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2510 - accuracy20: 0.3960 - val_loss: 3.3542 - val_accuracy20: 0.3239 - 8s/epoch - 26ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2426 - accuracy20: 0.4008 - val_loss: 3.3761 - val_accuracy20: 0.3351 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2407 - accuracy20: 0.4029 - val_loss: 3.3412 - val_accuracy20: 0.3210 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2363 - accuracy20: 0.4064 - val_loss: 3.3875 - val_accuracy20: 0.3139 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2306 - accuracy20: 0.4090 - val_loss: 3.3788 - val_accuracy20: 0.3221 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2279 - accuracy20: 0.4109 - val_loss: 3.3908 - val_accuracy20: 0.3238 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2213 - accuracy20: 0.4138 - val_loss: 3.4167 - val_accuracy20: 0.3205 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2180 - accuracy20: 0.4145 - val_loss: 3.4114 - val_accuracy20: 0.3253 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2124 - accuracy20: 0.4200 - val_loss: 3.4013 - val_accuracy20: 0.3278 - 8s/epoch - 26ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2113 - accuracy20: 0.4216 - val_loss: 3.4385 - val_accuracy20: 0.3320 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2079 - accuracy20: 0.4222 - val_loss: 3.4475 - val_accuracy20: 0.3331 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.2032 - accuracy20: 0.4240 - val_loss: 3.4404 - val_accuracy20: 0.3324 - 7s/epoch - 25ms/step
Epoch 20/50
295/295 - 7s - loss: 3.1992 - accuracy20: 0.4279 - val_loss: 3.4520 - val_accuracy20: 0.3232 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepLOB_L1/h20
Evaluating performance on  test set...
1588/1588 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1178702
{'0': {'precision': 0.3571976476604449, 'recall': 0.28801666405994514, 'f1-score': 0.31889830408413067, 'support': 140662}, '1': {'precision': 0.30185060529324403, 'recall': 0.4499024565035633, 'f1-score': 0.36129770723893506, 'support': 125585}, '2': {'precision': 0.3755215971992241, 'recall': 0.2833996243903484, 'f1-score': 0.3230209503345216, 'support': 140039}, 'accuracy': 0.3364649532595265, 'macro avg': {'precision': 0.3448566167176377, 'recall': 0.34043958165128557, 'f1-score': 0.33440565388586246, 'support': 406286}, 'weighted avg': {'precision': 0.34640551909528683, 'recall': 0.3364649532595265, 'f1-score': 0.3334251652200167, 'support': 406286}}
[[40513 66787 33362]
 [36448 56501 32636]
 [36458 63894 39687]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1066948
{'0': {'precision': 0.38859180035650626, 'recall': 0.11655973113351666, 'f1-score': 0.17932898525177743, 'support': 26184}, '1': {'precision': 0.3362193362193362, 'recall': 0.7304662379421222, 'f1-score': 0.4604859756252058, 'support': 24880}, '2': {'precision': 0.38838168163746134, 'recall': 0.21595840497830182, 'f1-score': 0.2775731424963166, 'support': 24426}, 'accuracy': 0.3510531196184925, 'macro avg': {'precision': 0.371064272737768, 'recall': 0.35432812468464686, 'f1-score': 0.3057960344577666, 'support': 75490}, 'weighted avg': {'precision': 0.37126289232147935, 'recall': 0.3510531196184925, 'f1-score': 0.30378120018549065, 'support': 75490}}
[[ 3052 19143  3989]
 [ 2388 18174  4318]
 [ 2414 16737  5275]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1159126
{'0': {'precision': 0.30372553146705955, 'recall': 0.2533801580333626, 'f1-score': 0.2762780011487651, 'support': 11390}, '1': {'precision': 0.3031769163509181, 'recall': 0.458844287604764, 'f1-score': 0.36511056511056506, 'support': 11335}, '2': {'precision': 0.3728535164999253, 'recall': 0.23492332298428828, 'f1-score': 0.28823733117857553, 'support': 10629}, 'accuracy': 0.317323259579061, 'macro avg': {'precision': 0.326585321439301, 'recall': 0.3157159228741383, 'f1-score': 0.30987529914596856, 'support': 33354}, 'weighted avg': {'precision': 0.32556827298450475, 'recall': 0.317323259579061, 'f1-score': 0.31027790614948036, 'support': 33354}}
[[2886 6383 2121]
 [4055 5201 2079]
 [2561 5571 2497]]
training model: results/CHTR/W10/deepLOB_L1/h30
Epoch 1/50
295/295 - 10s - loss: 3.3188 - accuracy30: 0.3660 - val_loss: 3.4814 - val_accuracy30: 0.3123 - 10s/epoch - 33ms/step
Epoch 2/50
295/295 - 7s - loss: 3.2964 - accuracy30: 0.3712 - val_loss: 3.4620 - val_accuracy30: 0.3407 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2925 - accuracy30: 0.3720 - val_loss: 3.4300 - val_accuracy30: 0.3081 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2882 - accuracy30: 0.3747 - val_loss: 3.4454 - val_accuracy30: 0.3373 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2809 - accuracy30: 0.3765 - val_loss: 3.3864 - val_accuracy30: 0.3226 - 8s/epoch - 26ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2714 - accuracy30: 0.3843 - val_loss: 3.4524 - val_accuracy30: 0.3306 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2697 - accuracy30: 0.3849 - val_loss: 3.4596 - val_accuracy30: 0.3281 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2664 - accuracy30: 0.3872 - val_loss: 3.3830 - val_accuracy30: 0.3380 - 8s/epoch - 27ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2607 - accuracy30: 0.3908 - val_loss: 3.4168 - val_accuracy30: 0.3414 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2587 - accuracy30: 0.3941 - val_loss: 3.4379 - val_accuracy30: 0.3391 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2535 - accuracy30: 0.3957 - val_loss: 3.4365 - val_accuracy30: 0.3399 - 8s/epoch - 26ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2479 - accuracy30: 0.4002 - val_loss: 3.4278 - val_accuracy30: 0.3417 - 8s/epoch - 26ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2466 - accuracy30: 0.4012 - val_loss: 3.4522 - val_accuracy30: 0.3403 - 8s/epoch - 27ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2435 - accuracy30: 0.4011 - val_loss: 3.4545 - val_accuracy30: 0.3400 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2374 - accuracy30: 0.4057 - val_loss: 3.4886 - val_accuracy30: 0.3386 - 8s/epoch - 26ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2301 - accuracy30: 0.4102 - val_loss: 3.4950 - val_accuracy30: 0.3380 - 8s/epoch - 26ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2257 - accuracy30: 0.4118 - val_loss: 3.4583 - val_accuracy30: 0.3429 - 8s/epoch - 26ms/step
Epoch 18/50
295/295 - 8s - loss: 3.2254 - accuracy30: 0.4149 - val_loss: 3.4602 - val_accuracy30: 0.3366 - 8s/epoch - 26ms/step
testing model: results/CHTR/W10/deepLOB_L1/h30
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1412144
{'0': {'precision': 0.35843453763277117, 'recall': 0.06649903588758378, 'f1-score': 0.11218483389733568, 'support': 141581}, '1': {'precision': 0.2999314052258944, 'recall': 0.8027433155945198, 'f1-score': 0.4366980146290491, 'support': 123646}, '2': {'precision': 0.3591973925443064, 'recall': 0.1250044307701033, 'f1-score': 0.18546508264571468, 'support': 141059}, 'accuracy': 0.3108746055734138, 'macro avg': {'precision': 0.33918777846765735, 'recall': 0.33141559408406895, 'f1-score': 0.24478264372403316, 'support': 406286}, 'weighted avg': {'precision': 0.34089499465414413, 'recall': 0.3108746055734138, 'f1-score': 0.2363869854677837, 'support': 406286}}
[[  9415 116404  15762]
 [  8695  99256  15695]
 [  8157 115269  17633]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1356931
{'0': {'precision': 0.3831485587583149, 'recall': 0.0329017517136329, 'f1-score': 0.06059968437664387, 'support': 26260}, '1': {'precision': 0.33017171121040945, 'recall': 0.9445270732001447, 'f1-score': 0.48930166696167343, 'support': 24877}, '2': {'precision': 0.3653939101014983, 'recall': 0.031043403276803678, 'f1-score': 0.05722503973961093, 'support': 24353}, 'accuracy': 0.33271956550536497, 'macro avg': {'precision': 0.3595713933567409, 'recall': 0.33615740939686045, 'f1-score': 0.20237546369264273, 'support': 75490}, 'weighted avg': {'precision': 0.3599629183398661, 'recall': 0.33271956550536497, 'f1-score': 0.20078562291051746, 'support': 75490}}
[[  864 24779   617]
 [  684 23497   696]
 [  707 22890   756]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1290655
{'0': {'precision': 0.3622448979591837, 'recall': 0.025015414427904517, 'f1-score': 0.04679904424487106, 'support': 11353}, '1': {'precision': 0.338307966001186, 'recall': 0.9035635723713155, 'f1-score': 0.49229367913900146, 'support': 11365}, '2': {'precision': 0.3361913357400722, 'recall': 0.07004512974802557, 'f1-score': 0.11593526299408652, 'support': 10636}, 'accuracy': 0.3387299874078072, 'macro avg': {'precision': 0.34558139990014736, 'recall': 0.33287470551574855, 'f1-score': 0.21834266212598633, 'support': 33354}, 'weighted avg': {'precision': 0.34578063821627086, 'recall': 0.3387299874078072, 'f1-score': 0.22064264166012704, 'support': 33354}}
[[  284 10436   633]
 [  258 10269   838]
 [  242  9649   745]]
training model: results/CHTR/W10/deepLOB_L1/h50
Epoch 1/50
295/295 - 10s - loss: 3.3328 - accuracy50: 0.3573 - val_loss: 3.5629 - val_accuracy50: 0.3202 - 10s/epoch - 35ms/step
Epoch 2/50
295/295 - 11s - loss: 3.3110 - accuracy50: 0.3619 - val_loss: 3.3792 - val_accuracy50: 0.3272 - 11s/epoch - 38ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2958 - accuracy50: 0.3685 - val_loss: 3.3721 - val_accuracy50: 0.3433 - 9s/epoch - 31ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2897 - accuracy50: 0.3735 - val_loss: 3.3521 - val_accuracy50: 0.3347 - 8s/epoch - 28ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2910 - accuracy50: 0.3646 - val_loss: 3.3123 - val_accuracy50: 0.3300 - 8s/epoch - 27ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2884 - accuracy50: 0.3667 - val_loss: 3.3519 - val_accuracy50: 0.3357 - 8s/epoch - 27ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2816 - accuracy50: 0.3734 - val_loss: 3.3153 - val_accuracy50: 0.3347 - 8s/epoch - 27ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2770 - accuracy50: 0.3751 - val_loss: 3.3837 - val_accuracy50: 0.3126 - 8s/epoch - 28ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2685 - accuracy50: 0.3878 - val_loss: 3.3964 - val_accuracy50: 0.3127 - 8s/epoch - 27ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2701 - accuracy50: 0.3843 - val_loss: 3.3400 - val_accuracy50: 0.3367 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2636 - accuracy50: 0.3893 - val_loss: 3.3630 - val_accuracy50: 0.3280 - 8s/epoch - 26ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2564 - accuracy50: 0.3957 - val_loss: 3.4146 - val_accuracy50: 0.3146 - 8s/epoch - 28ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2574 - accuracy50: 0.3935 - val_loss: 3.3880 - val_accuracy50: 0.3182 - 8s/epoch - 26ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2516 - accuracy50: 0.3970 - val_loss: 3.4166 - val_accuracy50: 0.3125 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2483 - accuracy50: 0.4012 - val_loss: 3.3933 - val_accuracy50: 0.3195 - 8s/epoch - 27ms/step
testing model: results/CHTR/W10/deepLOB_L1/h50
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1092342
{'0': {'precision': 0.3540430349072706, 'recall': 0.2772702401318751, 'f1-score': 0.310988541464362, 'support': 144379}, '1': {'precision': 0.283804356145976, 'recall': 0.5566537386880187, 'f1-score': 0.3759396378609632, 'support': 119895}, '2': {'precision': 0.35174754104008404, 'recall': 0.14379066557755682, 'f1-score': 0.20413365656161747, 'support': 142012}, 'accuracy': 0.31306025804482557, 'macro avg': {'precision': 0.32986497736444353, 'recall': 0.32590488146581686, 'f1-score': 0.2970206119623142, 'support': 406286}, 'weighted avg': {'precision': 0.33251324046406483, 'recall': 0.31306025804482557, 'f1-score': 0.2928058715905833, 'support': 406286}}
[[40032 84444 19903]
 [35425 66740 17730]
 [37614 83978 20420]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014298
{'0': {'precision': 0.36636573588074745, 'recall': 0.1990872789503708, 'f1-score': 0.2579834417504435, 'support': 26295}, '1': {'precision': 0.3337402521682093, 'recall': 0.7396026810950497, 'f1-score': 0.4599372253609542, 'support': 24766}, '2': {'precision': 0.3579230647459237, 'recall': 0.09255393180236604, 'f1-score': 0.14707604241202107, 'support': 24429}, 'accuracy': 0.3419393297125447, 'macro avg': {'precision': 0.3526763509316268, 'recall': 0.3437479639492622, 'f1-score': 0.2883322365078063, 'support': 75490}, 'weighted avg': {'precision': 0.3529301981568459, 'recall': 0.3419393297125447, 'f1-score': 0.2883481330533921, 'support': 75490}}
[[ 5235 19100  1960]
 [ 4353 18317  2096]
 [ 4701 17467  2261]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103022
{'0': {'precision': 0.3366568914956012, 'recall': 0.2552245442418853, 'f1-score': 0.2903388973191705, 'support': 11245}, '1': {'precision': 0.3343887597090981, 'recall': 0.5857526648756392, 'f1-score': 0.4257369614512472, 'support': 11539}, '2': {'precision': 0.3089254766031196, 'recall': 0.13491012298959318, 'f1-score': 0.18780455682865796, 'support': 10570}, 'accuracy': 0.33144450440726747, 'macro avg': {'precision': 0.3266570426026063, 'recall': 0.3252957773690392, 'f1-score': 0.3012934718663585, 'support': 33354}, 'weighted avg': {'precision': 0.32708403582317835, 'recall': 0.33144450440726747, 'f1-score': 0.3046871099184184, 'support': 33354}}
[[2870 6937 1438]
 [3028 6759 1752]
 [2627 6517 1426]]
training model: results/CHTR/W10/deepLOB_L1/h100
Epoch 1/50
295/295 - 10s - loss: 3.3410 - accuracy100: 0.3564 - val_loss: 3.3856 - val_accuracy100: 0.3283 - 10s/epoch - 34ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3131 - accuracy100: 0.3574 - val_loss: 3.4017 - val_accuracy100: 0.3274 - 8s/epoch - 26ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3037 - accuracy100: 0.3620 - val_loss: 3.3421 - val_accuracy100: 0.3389 - 8s/epoch - 26ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2972 - accuracy100: 0.3624 - val_loss: 3.3377 - val_accuracy100: 0.3498 - 8s/epoch - 27ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2953 - accuracy100: 0.3659 - val_loss: 3.3454 - val_accuracy100: 0.3239 - 8s/epoch - 26ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2934 - accuracy100: 0.3630 - val_loss: 3.3282 - val_accuracy100: 0.3276 - 8s/epoch - 27ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2880 - accuracy100: 0.3693 - val_loss: 3.3187 - val_accuracy100: 0.3376 - 8s/epoch - 26ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2805 - accuracy100: 0.3744 - val_loss: 3.3581 - val_accuracy100: 0.3147 - 8s/epoch - 26ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2740 - accuracy100: 0.3797 - val_loss: 3.3374 - val_accuracy100: 0.3340 - 8s/epoch - 27ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2720 - accuracy100: 0.3817 - val_loss: 3.3475 - val_accuracy100: 0.3391 - 8s/epoch - 27ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2713 - accuracy100: 0.3830 - val_loss: 3.3466 - val_accuracy100: 0.3392 - 8s/epoch - 27ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2665 - accuracy100: 0.3858 - val_loss: 3.3199 - val_accuracy100: 0.3524 - 8s/epoch - 26ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2615 - accuracy100: 0.3875 - val_loss: 3.3455 - val_accuracy100: 0.3268 - 8s/epoch - 27ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2602 - accuracy100: 0.3887 - val_loss: 3.3423 - val_accuracy100: 0.3404 - 8s/epoch - 27ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2532 - accuracy100: 0.3954 - val_loss: 3.3605 - val_accuracy100: 0.3257 - 8s/epoch - 27ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2543 - accuracy100: 0.3937 - val_loss: 3.3689 - val_accuracy100: 0.3141 - 8s/epoch - 27ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2520 - accuracy100: 0.3964 - val_loss: 3.3870 - val_accuracy100: 0.3166 - 8s/epoch - 27ms/step
testing model: results/CHTR/W10/deepLOB_L1/h100
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.112748
{'0': {'precision': 0.3495795702273435, 'recall': 0.24453839293616267, 'f1-score': 0.28777324237605195, 'support': 146889}, '1': {'precision': 0.25831745958888913, 'recall': 0.2940940801449263, 'f1-score': 0.27504724358138927, 'support': 114817}, '2': {'precision': 0.3481468622515407, 'recall': 0.4161363950753908, 'f1-score': 0.37911750342633, 'support': 144580}, 'accuracy': 0.3196073701776581, 'macro avg': {'precision': 0.31868129735592443, 'recall': 0.3182562893854933, 'f1-score': 0.3139793297945904, 'support': 406286}, 'weighted avg': {'precision': 0.3232789281271555, 'recall': 0.3196073701776581, 'f1-score': 0.3166824153700572, 'support': 406286}}
[[35920 48590 62379]
 [30779 33767 50271]
 [36053 48362 60165]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1043766
{'0': {'precision': 0.35038563509279347, 'recall': 0.22595686807849233, 'f1-score': 0.2747395525737639, 'support': 25735}, '1': {'precision': 0.3450359870336795, 'recall': 0.5051683224067892, 'f1-score': 0.4100220354198971, 'support': 24863}, '2': {'precision': 0.3398541703716877, 'recall': 0.30708661417322836, 'f1-score': 0.32264055377342565, 'support': 24892}, 'accuracy': 0.34466816796926747, 'macro avg': {'precision': 0.3450919308327202, 'recall': 0.3460706015528367, 'f1-score': 0.3358007139223622, 'support': 75490}, 'weighted avg': {'precision': 0.34515106734168055, 'recall': 0.34466816796926747, 'f1-score': 0.3350903287410098, 'support': 75490}}
[[ 5815 12286  7634]
 [ 5089 12560  7214]
 [ 5692 11556  7644]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1057163
{'0': {'precision': 0.3392732354996506, 'recall': 0.26634360427905274, 'f1-score': 0.2984172514470112, 'support': 10937}, '1': {'precision': 0.3585344827586207, 'recall': 0.3554093317381644, 'f1-score': 0.3569650673761909, 'support': 11702}, '2': {'precision': 0.32085358444714457, 'recall': 0.3943070461969202, 'f1-score': 0.3538081480551019, 'support': 10715}, 'accuracy': 0.3387000059962823, 'macro avg': {'precision': 0.33955376756847194, 'recall': 0.3386866607380458, 'f1-score': 0.336396822292768, 'support': 33354}, 'weighted avg': {'precision': 0.3401135711234698, 'recall': 0.3387000059962823, 'f1-score': 0.3367526834539355, 'support': 33354}}
[[2913 3777 4247]
 [2847 4159 4696]
 [2826 3664 4225]]
training model: results/CHTR/W10/deepLOB_L1/h200
Epoch 1/50
295/295 - 10s - loss: 3.3361 - accuracy200: 0.3570 - val_loss: 3.5214 - val_accuracy200: 0.3367 - 10s/epoch - 33ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3129 - accuracy200: 0.3600 - val_loss: 3.4211 - val_accuracy200: 0.3212 - 8s/epoch - 27ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3038 - accuracy200: 0.3581 - val_loss: 3.3073 - val_accuracy200: 0.3724 - 8s/epoch - 27ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2977 - accuracy200: 0.3634 - val_loss: 3.3333 - val_accuracy200: 0.3320 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 8s - loss: 3.3006 - accuracy200: 0.3613 - val_loss: 3.3270 - val_accuracy200: 0.3460 - 8s/epoch - 27ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2938 - accuracy200: 0.3626 - val_loss: 3.3490 - val_accuracy200: 0.3395 - 8s/epoch - 26ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2944 - accuracy200: 0.3575 - val_loss: 3.3006 - val_accuracy200: 0.3570 - 8s/epoch - 27ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2913 - accuracy200: 0.3597 - val_loss: 3.2997 - val_accuracy200: 0.3470 - 8s/epoch - 27ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2862 - accuracy200: 0.3629 - val_loss: 3.3046 - val_accuracy200: 0.3490 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2823 - accuracy200: 0.3643 - val_loss: 3.3265 - val_accuracy200: 0.3214 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2766 - accuracy200: 0.3692 - val_loss: 3.3693 - val_accuracy200: 0.2988 - 8s/epoch - 27ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2752 - accuracy200: 0.3687 - val_loss: 3.3389 - val_accuracy200: 0.3191 - 8s/epoch - 28ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2676 - accuracy200: 0.3790 - val_loss: 3.3926 - val_accuracy200: 0.2981 - 8s/epoch - 26ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2667 - accuracy200: 0.3792 - val_loss: 3.3757 - val_accuracy200: 0.3044 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2675 - accuracy200: 0.3805 - val_loss: 3.3679 - val_accuracy200: 0.3066 - 8s/epoch - 27ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2645 - accuracy200: 0.3793 - val_loss: 3.3859 - val_accuracy200: 0.3117 - 8s/epoch - 27ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2554 - accuracy200: 0.3890 - val_loss: 3.3707 - val_accuracy200: 0.3136 - 8s/epoch - 27ms/step
Epoch 18/50
295/295 - 8s - loss: 3.2545 - accuracy200: 0.3914 - val_loss: 3.3350 - val_accuracy200: 0.3375 - 8s/epoch - 26ms/step
testing model: results/CHTR/W10/deepLOB_L1/h200
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109576
{'0': {'precision': 0.3566357969082195, 'recall': 0.13570547099958866, 'f1-score': 0.19660114619441602, 'support': 145860}, '1': {'precision': 0.2695710307526817, 'recall': 0.46569930009204746, 'f1-score': 0.3414772365488698, 'support': 115158}, '2': {'precision': 0.34722277103831617, 'recall': 0.3629360905361126, 'f1-score': 0.35490559052202886, 'support': 145268}, 'accuracy': 0.310485716958005, 'macro avg': {'precision': 0.32447653289973916, 'recall': 0.3214469538759162, 'f1-score': 0.29766132442177157, 'support': 406286}, 'weighted avg': {'precision': 0.3285924585135701, 'recall': 0.310485716958005, 'f1-score': 0.29426685663391394, 'support': 406286}}
[[19794 72052 54014]
 [16424 53629 45105]
 [19284 73261 52723]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000785
{'0': {'precision': 0.35603996366939145, 'recall': 0.11069425955060712, 'f1-score': 0.16888232397833577, 'support': 24789}, '1': {'precision': 0.34259185778906437, 'recall': 0.6917160711424452, 'f1-score': 0.4582316102324594, 'support': 24964}, '2': {'precision': 0.35646469877438286, 'recall': 0.2407040447604616, 'f1-score': 0.2873643195101586, 'support': 25737}, 'accuracy': 0.3471585640482183, 'macro avg': {'precision': 0.3516988400776129, 'recall': 0.3477047918178379, 'f1-score': 0.3048260845736513, 'support': 75490}, 'weighted avg': {'precision': 0.351737577819619, 'recall': 0.3471585640482183, 'f1-score': 0.30496242334315854, 'support': 75490}}
[[ 2744 16262  5783]
 [ 2295 17268  5401]
 [ 2668 16874  6195]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988431
{'0': {'precision': 0.2985003570578434, 'recall': 0.11996556012627954, 'f1-score': 0.17114780947181654, 'support': 10453}, '1': {'precision': 0.3575244431004939, 'recall': 0.5918571666944769, 'f1-score': 0.4457710192283524, 'support': 11986}, '2': {'precision': 0.3399205241112662, 'recall': 0.2899679340357306, 'f1-score': 0.312963512310887, 'support': 10915}, 'accuracy': 0.3451759908856509, 'macro avg': {'precision': 0.3319817747565345, 'recall': 0.3339302202854957, 'f1-score': 0.3099607803370186, 'support': 33354}, 'weighted avg': {'precision': 0.33326571709547964, 'recall': 0.3451759908856509, 'f1-score': 0.31624441523515207, 'support': 33354}}
[[1254 6239 2960]
 [1706 7094 3186]
 [1241 6509 3165]]
training model: results/CHTR/W10/deepLOB_L1/h300
Epoch 1/50
295/295 - 10s - loss: 3.3266 - accuracy300: 0.3595 - val_loss: 3.5456 - val_accuracy300: 0.3391 - 10s/epoch - 34ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3078 - accuracy300: 0.3644 - val_loss: 3.5086 - val_accuracy300: 0.3156 - 8s/epoch - 27ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3000 - accuracy300: 0.3654 - val_loss: 3.3440 - val_accuracy300: 0.3467 - 8s/epoch - 26ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2942 - accuracy300: 0.3655 - val_loss: 3.3669 - val_accuracy300: 0.3302 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2901 - accuracy300: 0.3647 - val_loss: 3.3971 - val_accuracy300: 0.3427 - 8s/epoch - 26ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2855 - accuracy300: 0.3700 - val_loss: 3.4520 - val_accuracy300: 0.3455 - 8s/epoch - 26ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2770 - accuracy300: 0.3750 - val_loss: 3.3807 - val_accuracy300: 0.3525 - 8s/epoch - 27ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2850 - accuracy300: 0.3720 - val_loss: 3.3541 - val_accuracy300: 0.3066 - 8s/epoch - 26ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2850 - accuracy300: 0.3680 - val_loss: 3.3469 - val_accuracy300: 0.3288 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2722 - accuracy300: 0.3786 - val_loss: 3.3159 - val_accuracy300: 0.3609 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2663 - accuracy300: 0.3866 - val_loss: 3.3248 - val_accuracy300: 0.3613 - 8s/epoch - 26ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2573 - accuracy300: 0.3915 - val_loss: 3.3030 - val_accuracy300: 0.3756 - 8s/epoch - 26ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2637 - accuracy300: 0.3881 - val_loss: 3.3013 - val_accuracy300: 0.3783 - 8s/epoch - 26ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2743 - accuracy300: 0.3745 - val_loss: 3.3255 - val_accuracy300: 0.3586 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2634 - accuracy300: 0.3815 - val_loss: 3.3473 - val_accuracy300: 0.3524 - 8s/epoch - 26ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2683 - accuracy300: 0.3783 - val_loss: 3.3587 - val_accuracy300: 0.3508 - 8s/epoch - 26ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2593 - accuracy300: 0.3839 - val_loss: 3.3630 - val_accuracy300: 0.3712 - 8s/epoch - 26ms/step
Epoch 18/50
295/295 - 8s - loss: 3.2460 - accuracy300: 0.3977 - val_loss: 3.3692 - val_accuracy300: 0.3577 - 8s/epoch - 27ms/step
Epoch 19/50
295/295 - 8s - loss: 3.2376 - accuracy300: 0.4019 - val_loss: 3.4141 - val_accuracy300: 0.3449 - 8s/epoch - 27ms/step
Epoch 20/50
295/295 - 8s - loss: 3.2327 - accuracy300: 0.4041 - val_loss: 3.4273 - val_accuracy300: 0.3349 - 8s/epoch - 26ms/step
Epoch 21/50
295/295 - 8s - loss: 3.2253 - accuracy300: 0.4103 - val_loss: 3.4037 - val_accuracy300: 0.3415 - 8s/epoch - 26ms/step
Epoch 22/50
295/295 - 8s - loss: 3.2216 - accuracy300: 0.4109 - val_loss: 3.3839 - val_accuracy300: 0.3500 - 8s/epoch - 26ms/step
Epoch 23/50
295/295 - 8s - loss: 3.2143 - accuracy300: 0.4168 - val_loss: 3.3954 - val_accuracy300: 0.3374 - 8s/epoch - 26ms/step
testing model: results/CHTR/W10/deepLOB_L1/h300
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1261066
{'0': {'precision': 0.35115978401399345, 'recall': 0.15794190485312026, 'f1-score': 0.21788513535832088, 'support': 146174}, '1': {'precision': 0.3036109809600886, 'recall': 0.4890564160620251, 'f1-score': 0.3746411137464111, 'support': 116598}, '2': {'precision': 0.3682697659191357, 'recall': 0.3919060161377984, 'f1-score': 0.3797204284378491, 'support': 143514}, 'accuracy': 0.3356108750978375, 'macro avg': {'precision': 0.34101351029773924, 'recall': 0.3463014456843146, 'f1-score': 0.32408222584752705, 'support': 406286}, 'weighted avg': {'precision': 0.3435578154614354, 'recall': 0.3356108750978375, 'f1-score': 0.3200374709522374, 'support': 406286}}
[[23087 66340 56747]
 [19841 57023 39734]
 [22817 64453 56244]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067532
{'0': {'precision': 0.36443869145681335, 'recall': 0.1281128485149334, 'f1-score': 0.18958129285014694, 'support': 24174}, '1': {'precision': 0.3496822160930567, 'recall': 0.46811413894128506, 'f1-score': 0.400322619394917, 'support': 24917}, '2': {'precision': 0.356611963372577, 'recall': 0.45437327171483766, 'f1-score': 0.39960023319730154, 'support': 26399}, 'accuracy': 0.35443105047026097, 'macro avg': {'precision': 0.35691095697414904, 'recall': 0.35020008639035205, 'f1-score': 0.32983471514745516, 'support': 75490}, 'weighted avg': {'precision': 0.3568309965126555, 'recall': 0.35443105047026097, 'f1-score': 0.3325847587362321, 'support': 75490}}
[[ 3097 10213 10864]
 [ 2476 11664 10777]
 [ 2925 11479 11995]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989594
{'0': {'precision': 0.31086884704327716, 'recall': 0.09275505174963036, 'f1-score': 0.14287883389006986, 'support': 10145}, '1': {'precision': 0.39569237708615246, 'recall': 0.5824549755166404, 'f1-score': 0.47124391472217564, 'support': 12049}, '2': {'precision': 0.3646255261694861, 'recall': 0.4113799283154122, 'f1-score': 0.3865942486632141, 'support': 11160}, 'accuracy': 0.3762667146369251, 'macro avg': {'precision': 0.3570622500996386, 'recall': 0.362196651860561, 'f1-score': 0.3335723324251532, 'support': 33354}, 'weighted avg': {'precision': 0.3594975947957235, 'recall': 0.3762667146369251, 'f1-score': 0.3430447776393753, 'support': 33354}}
[[ 941 5256 3948]
 [ 979 7018 4052]
 [1107 5462 4591]]
training model: results/CHTR/W10/deepLOB_L1/h500
Epoch 1/50
295/295 - 10s - loss: 3.3276 - accuracy500: 0.3683 - val_loss: 3.3832 - val_accuracy500: 0.3521 - 10s/epoch - 34ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3093 - accuracy500: 0.3660 - val_loss: 3.3855 - val_accuracy500: 0.3147 - 8s/epoch - 26ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3014 - accuracy500: 0.3612 - val_loss: 3.3406 - val_accuracy500: 0.3643 - 8s/epoch - 26ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2979 - accuracy500: 0.3628 - val_loss: 3.3767 - val_accuracy500: 0.3494 - 8s/epoch - 27ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2866 - accuracy500: 0.3740 - val_loss: 3.3336 - val_accuracy500: 0.3428 - 8s/epoch - 27ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2815 - accuracy500: 0.3729 - val_loss: 3.3735 - val_accuracy500: 0.3446 - 8s/epoch - 27ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2790 - accuracy500: 0.3773 - val_loss: 3.4846 - val_accuracy500: 0.3622 - 8s/epoch - 26ms/step
Epoch 8/50
295/295 - 8s - loss: 3.2821 - accuracy500: 0.3764 - val_loss: 3.3254 - val_accuracy500: 0.3756 - 8s/epoch - 26ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2649 - accuracy500: 0.3850 - val_loss: 3.3929 - val_accuracy500: 0.3674 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2514 - accuracy500: 0.4002 - val_loss: 3.3375 - val_accuracy500: 0.3774 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.2482 - accuracy500: 0.3985 - val_loss: 3.4259 - val_accuracy500: 0.3605 - 8s/epoch - 26ms/step
Epoch 12/50
295/295 - 8s - loss: 3.2337 - accuracy500: 0.4074 - val_loss: 3.4266 - val_accuracy500: 0.3556 - 8s/epoch - 26ms/step
Epoch 13/50
295/295 - 8s - loss: 3.2260 - accuracy500: 0.4124 - val_loss: 3.4060 - val_accuracy500: 0.3502 - 8s/epoch - 26ms/step
Epoch 14/50
295/295 - 8s - loss: 3.2246 - accuracy500: 0.4143 - val_loss: 3.4088 - val_accuracy500: 0.3453 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2127 - accuracy500: 0.4190 - val_loss: 3.4625 - val_accuracy500: 0.3242 - 8s/epoch - 26ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2159 - accuracy500: 0.4207 - val_loss: 3.4185 - val_accuracy500: 0.3447 - 8s/epoch - 26ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2232 - accuracy500: 0.4166 - val_loss: 3.4618 - val_accuracy500: 0.3223 - 8s/epoch - 26ms/step
Epoch 18/50
295/295 - 8s - loss: 3.2081 - accuracy500: 0.4214 - val_loss: 3.4140 - val_accuracy500: 0.3384 - 8s/epoch - 26ms/step
testing model: results/CHTR/W10/deepLOB_L1/h500
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1566784
{'0': {'precision': 0.3431184854286322, 'recall': 0.056518753153557214, 'f1-score': 0.09705116094367663, 'support': 142696}, '1': {'precision': 0.3063251363408194, 'recall': 0.8797996253156308, 'f1-score': 0.4544289924460272, 'support': 122770}, '2': {'precision': 0.4281784435900835, 'recall': 0.09174122993892912, 'f1-score': 0.15110648451389538, 'support': 140820}, 'accuracy': 0.3175029412778191, 'macro avg': {'precision': 0.3592073551198451, 'recall': 0.3426865361360391, 'f1-score': 0.2341955459678664, 'support': 406286}, 'weighted avg': {'precision': 0.3614824552449311, 'recall': 0.3175029412778191, 'f1-score': 0.2237780160130164, 'support': 406286}}
[[  8065 124926   9705]
 [  7209 108013   7548]
 [  8231 119670  12919]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1310778
{'0': {'precision': 0.3306808134394341, 'recall': 0.10990764063811923, 'f1-score': 0.1649809370765983, 'support': 23820}, '1': {'precision': 0.3373715718792978, 'recall': 0.6712676056338028, 'f1-score': 0.4490537593883759, 'support': 24850}, '2': {'precision': 0.3731590269733576, 'recall': 0.25223713646532436, 'f1-score': 0.30100780885003003, 'support': 26820}, 'accuracy': 0.3452642734136972, 'macro avg': {'precision': 0.3470704707640298, 'recall': 0.3444707942457488, 'f1-score': 0.30501416843833473, 'support': 75490}, 'weighted avg': {'precision': 0.34797490582531887, 'recall': 0.3452642734136972, 'f1-score': 0.30682025798547513, 'support': 75490}}
[[ 2618 15632  5570]
 [ 2375 16681  5794]
 [ 2924 17131  6765]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097771
{'0': {'precision': 0.30420815933183426, 'recall': 0.0934939283246125, 'f1-score': 0.14302975381362332, 'support': 10129}, '1': {'precision': 0.3883601911770926, 'recall': 0.7624346093166154, 'f1-score': 0.5145995628537802, 'support': 12043}, '2': {'precision': 0.3723855713852683, 'recall': 0.21972813450187803, 'f1-score': 0.27637795275590554, 'support': 11182}, 'accuracy': 0.3773460454518199, 'macro avg': {'precision': 0.3549846406313984, 'recall': 0.358552224047702, 'f1-score': 0.31133575647443634, 'support': 33354}, 'weighted avg': {'precision': 0.3574492320995366, 'recall': 0.3773460454518199, 'f1-score': 0.32189629968048217, 'support': 33354}}
[[ 947 6907 2275]
 [ 995 9182 1866]
 [1171 7554 2457]]
training model: results/CHTR/W10/deepLOB_L1/h1000
Epoch 1/50
295/295 - 10s - loss: 3.3390 - accuracy1000: 0.3621 - val_loss: 3.5124 - val_accuracy1000: 0.3358 - 10s/epoch - 35ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3039 - accuracy1000: 0.3781 - val_loss: 3.4942 - val_accuracy1000: 0.3062 - 8s/epoch - 27ms/step
Epoch 3/50
295/295 - 8s - loss: 3.2955 - accuracy1000: 0.3779 - val_loss: 3.4325 - val_accuracy1000: 0.3313 - 8s/epoch - 28ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2683 - accuracy1000: 0.3928 - val_loss: 3.4222 - val_accuracy1000: 0.3332 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2383 - accuracy1000: 0.4125 - val_loss: 3.4204 - val_accuracy1000: 0.3219 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2137 - accuracy1000: 0.4223 - val_loss: 3.4156 - val_accuracy1000: 0.3430 - 8s/epoch - 26ms/step
Epoch 7/50
295/295 - 8s - loss: 3.1895 - accuracy1000: 0.4343 - val_loss: 3.4703 - val_accuracy1000: 0.3302 - 8s/epoch - 26ms/step
Epoch 8/50
295/295 - 8s - loss: 3.1717 - accuracy1000: 0.4451 - val_loss: 3.4625 - val_accuracy1000: 0.3374 - 8s/epoch - 27ms/step
Epoch 9/50
295/295 - 8s - loss: 3.1542 - accuracy1000: 0.4516 - val_loss: 3.4628 - val_accuracy1000: 0.3256 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.1390 - accuracy1000: 0.4617 - val_loss: 3.5057 - val_accuracy1000: 0.3205 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 8s - loss: 3.1305 - accuracy1000: 0.4652 - val_loss: 3.4716 - val_accuracy1000: 0.3360 - 8s/epoch - 26ms/step
Epoch 12/50
295/295 - 8s - loss: 3.1203 - accuracy1000: 0.4694 - val_loss: 3.4602 - val_accuracy1000: 0.3314 - 8s/epoch - 26ms/step
Epoch 13/50
295/295 - 8s - loss: 3.1078 - accuracy1000: 0.4739 - val_loss: 3.5239 - val_accuracy1000: 0.3147 - 8s/epoch - 26ms/step
Epoch 14/50
295/295 - 8s - loss: 3.0951 - accuracy1000: 0.4757 - val_loss: 3.4732 - val_accuracy1000: 0.3430 - 8s/epoch - 26ms/step
Epoch 15/50
295/295 - 8s - loss: 3.0913 - accuracy1000: 0.4773 - val_loss: 3.4712 - val_accuracy1000: 0.3287 - 8s/epoch - 26ms/step
Epoch 16/50
295/295 - 8s - loss: 3.0903 - accuracy1000: 0.4767 - val_loss: 3.4866 - val_accuracy1000: 0.3418 - 8s/epoch - 26ms/step
testing model: results/CHTR/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1382046
{'0': {'precision': 0.35290618237920596, 'recall': 0.37553652547148153, 'f1-score': 0.3638698283880883, 'support': 143749}, '1': {'precision': 0.3326194504529587, 'recall': 0.37485820024940664, 'f1-score': 0.3524779289945305, 'support': 124295}, '2': {'precision': 0.4084952313670081, 'recall': 0.3346161079845488, 'f1-score': 0.3678831884588162, 'support': 138242}, 'accuracy': 0.3614055123730574, 'macro avg': {'precision': 0.3646736213997242, 'recall': 0.36167027790181233, 'f1-score': 0.36141031528047834, 'support': 406286}, 'weighted avg': {'precision': 0.3656144764513592, 'recall': 0.3614055123730574, 'f1-score': 0.3617502839976227, 'support': 406286}}
[[53983 49222 40544]
 [51264 46593 26438]
 [47720 44264 46258]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1562709
{'0': {'precision': 0.32371332371332373, 'recall': 0.1427601713970557, 'f1-score': 0.19813931578637461, 'support': 23571}, '1': {'precision': 0.3384894259818731, 'recall': 0.3388033223127167, 'f1-score': 0.33864630140850743, 'support': 24802}, '2': {'precision': 0.3625776011919543, 'recall': 0.5384445181989158, 'f1-score': 0.433347678335584, 'support': 27117}, 'accuracy': 0.3493045436481653, 'macro avg': {'precision': 0.341593450295717, 'recall': 0.3400026706362294, 'f1-score': 0.323377765176822, 'support': 75490}, 'weighted avg': {'precision': 0.3425285244134507, 'recall': 0.3493045436481653, 'f1-score': 0.32879237479613815, 'support': 75490}}
[[ 3365  7807 12399]
 [ 3129  8403 13270]
 [ 3901  8615 14601]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1328549
{'0': {'precision': 0.2853150406504065, 'recall': 0.21729876160990713, 'f1-score': 0.24670474516695956, 'support': 10336}, '1': {'precision': 0.35751643753735807, 'recall': 0.4152924839437598, 'f1-score': 0.3842447602987233, 'support': 11522}, '2': {'precision': 0.36642420234749545, 'recall': 0.3856123869171886, 'f1-score': 0.3757735017377299, 'support': 11496}, 'accuracy': 0.34370690172093304, 'macro avg': {'precision': 0.33641856017842003, 'recall': 0.33940121082361846, 'f1-score': 0.33557433573447093, 'support': 33354}, 'weighted avg': {'precision': 0.33821230687938025, 'recall': 0.34370690172093304, 'f1-score': 0.3387030206327435, 'support': 33354}}
[[2246 4014 4076]
 [3148 4785 3589]
 [2478 4585 4433]]
training model: results/CHTR/W10/deepOF_L1/h10
Epoch 1/50
295/295 - 10s - loss: 3.3099 - accuracy10: 0.3701 - val_loss: 3.2896 - val_accuracy10: 0.3809 - 10s/epoch - 34ms/step
Epoch 2/50
295/295 - 8s - loss: 3.2717 - accuracy10: 0.3880 - val_loss: 3.2631 - val_accuracy10: 0.3958 - 8s/epoch - 26ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2537 - accuracy10: 0.3985 - val_loss: 3.2575 - val_accuracy10: 0.3986 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2403 - accuracy10: 0.4063 - val_loss: 3.2446 - val_accuracy10: 0.4035 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2303 - accuracy10: 0.4098 - val_loss: 3.2358 - val_accuracy10: 0.4077 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2233 - accuracy10: 0.4128 - val_loss: 3.2356 - val_accuracy10: 0.4155 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2150 - accuracy10: 0.4183 - val_loss: 3.2310 - val_accuracy10: 0.4145 - 8s/epoch - 26ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2086 - accuracy10: 0.4197 - val_loss: 3.2299 - val_accuracy10: 0.4219 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2059 - accuracy10: 0.4189 - val_loss: 3.2316 - val_accuracy10: 0.4234 - 7s/epoch - 25ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2006 - accuracy10: 0.4210 - val_loss: 3.2199 - val_accuracy10: 0.4287 - 7s/epoch - 24ms/step
Epoch 11/50
295/295 - 7s - loss: 3.1954 - accuracy10: 0.4258 - val_loss: 3.2358 - val_accuracy10: 0.4229 - 7s/epoch - 23ms/step
Epoch 12/50
295/295 - 7s - loss: 3.1899 - accuracy10: 0.4278 - val_loss: 3.2343 - val_accuracy10: 0.4257 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.1882 - accuracy10: 0.4267 - val_loss: 3.2352 - val_accuracy10: 0.4261 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.1834 - accuracy10: 0.4312 - val_loss: 3.2463 - val_accuracy10: 0.4196 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.1771 - accuracy10: 0.4333 - val_loss: 3.2487 - val_accuracy10: 0.4140 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 7s - loss: 3.1742 - accuracy10: 0.4340 - val_loss: 3.2416 - val_accuracy10: 0.4228 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.1698 - accuracy10: 0.4357 - val_loss: 3.2745 - val_accuracy10: 0.4103 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 3.1668 - accuracy10: 0.4355 - val_loss: 3.2938 - val_accuracy10: 0.3911 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.1664 - accuracy10: 0.4362 - val_loss: 3.3341 - val_accuracy10: 0.3659 - 7s/epoch - 25ms/step
Epoch 20/50
295/295 - 7s - loss: 3.1617 - accuracy10: 0.4380 - val_loss: 3.2860 - val_accuracy10: 0.3968 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h10
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0880045
{'0': {'precision': 0.414714620155251, 'recall': 0.21613985016054227, 'f1-score': 0.28417443349453314, 'support': 140150}, '1': {'precision': 0.3717549798203359, 'recall': 0.45183315663718215, 'f1-score': 0.40790103351975254, 'support': 126394}, '2': {'precision': 0.4117850104109833, 'recall': 0.5293086297830926, 'f1-score': 0.46320865494512375, 'support': 139737}, 'accuracy': 0.39717584627388436, 'macro avg': {'precision': 0.39941820346219004, 'recall': 0.3990938788602723, 'f1-score': 0.38509470731980316, 'support': 406281}, 'weighted avg': {'precision': 0.4003422629509368, 'recall': 0.39717584627388436, 'f1-score': 0.384243117204647, 'support': 406281}}
[[30292 54734 55124]
 [18755 57109 50530]
 [23996 41777 73964]]
Evaluating performance on  train set...
295/295 - 11s - 11s/epoch - 39ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0794826
{'0': {'precision': 0.4359286911473412, 'recall': 0.22063700161949565, 'f1-score': 0.2929851510496672, 'support': 25934}, '1': {'precision': 0.382095531587057, 'recall': 0.4979718060966304, 'f1-score': 0.43240509860677606, 'support': 24899}, '2': {'precision': 0.40792992778817866, 'recall': 0.49490975461366865, 'f1-score': 0.4472300108123958, 'support': 24655}, 'accuracy': 0.40169298431538786, 'macro avg': {'precision': 0.4086513835075256, 'recall': 0.4045061874432649, 'f1-score': 0.39087342015627974, 'support': 75488}, 'weighted avg': {'precision': 0.40902770886523454, 'recall': 0.40169298431538786, 'f1-score': 0.38934913329418985, 'support': 75488}}
[[ 5722 11521  8691]
 [ 3481 12399  9019]
 [ 3923  8530 12202]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0764662
{'0': {'precision': 0.439906441165887, 'recall': 0.2154374834787206, 'f1-score': 0.28922931330218254, 'support': 11349}, '1': {'precision': 0.42616194280641684, 'recall': 0.5863212073628195, 'f1-score': 0.49357420870970115, 'support': 11463}, '2': {'precision': 0.4126403326403326, 'recall': 0.4706886738759249, 'f1-score': 0.43975716754553107, 'support': 10542}, 'accuracy': 0.42357738202314565, 'macro avg': {'precision': 0.42623623887087875, 'recall': 0.42414912157248835, 'f1-score': 0.4075202298524716, 'support': 33354}, 'weighted avg': {'precision': 0.42656493787479743, 'recall': 0.42357738202314565, 'f1-score': 0.40703437942587883, 'support': 33354}}
[[2445 5191 3713]
 [1392 6721 3350]
 [1721 3859 4962]]
training model: results/CHTR/W10/deepOF_L1/h20
Epoch 1/50
295/295 - 10s - loss: 3.3046 - accuracy20: 0.3736 - val_loss: 3.3037 - val_accuracy20: 0.3719 - 10s/epoch - 33ms/step
Epoch 2/50
295/295 - 8s - loss: 3.2701 - accuracy20: 0.3885 - val_loss: 3.2805 - val_accuracy20: 0.3886 - 8s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2549 - accuracy20: 0.3966 - val_loss: 3.2911 - val_accuracy20: 0.3805 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2443 - accuracy20: 0.4040 - val_loss: 3.2713 - val_accuracy20: 0.3968 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 8s - loss: 3.2365 - accuracy20: 0.4053 - val_loss: 3.2618 - val_accuracy20: 0.4053 - 8s/epoch - 26ms/step
Epoch 6/50
295/295 - 14s - loss: 3.2280 - accuracy20: 0.4100 - val_loss: 3.2554 - val_accuracy20: 0.4110 - 14s/epoch - 48ms/step
Epoch 7/50
295/295 - 8s - loss: 3.2231 - accuracy20: 0.4112 - val_loss: 3.2366 - val_accuracy20: 0.4221 - 8s/epoch - 27ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2165 - accuracy20: 0.4177 - val_loss: 3.2360 - val_accuracy20: 0.4205 - 7s/epoch - 24ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2125 - accuracy20: 0.4178 - val_loss: 3.2354 - val_accuracy20: 0.4226 - 7s/epoch - 24ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2059 - accuracy20: 0.4213 - val_loss: 3.2380 - val_accuracy20: 0.4223 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2021 - accuracy20: 0.4225 - val_loss: 3.2443 - val_accuracy20: 0.4205 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.1968 - accuracy20: 0.4250 - val_loss: 3.2424 - val_accuracy20: 0.4204 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.1961 - accuracy20: 0.4267 - val_loss: 3.2412 - val_accuracy20: 0.4249 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.1900 - accuracy20: 0.4274 - val_loss: 3.2357 - val_accuracy20: 0.4247 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.1871 - accuracy20: 0.4299 - val_loss: 3.2444 - val_accuracy20: 0.4257 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 7s - loss: 3.1833 - accuracy20: 0.4313 - val_loss: 3.2573 - val_accuracy20: 0.4194 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.1777 - accuracy20: 0.4352 - val_loss: 3.2561 - val_accuracy20: 0.4142 - 7s/epoch - 24ms/step
Epoch 18/50
295/295 - 7s - loss: 3.1739 - accuracy20: 0.4359 - val_loss: 3.2722 - val_accuracy20: 0.4023 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.1713 - accuracy20: 0.4350 - val_loss: 3.2921 - val_accuracy20: 0.3849 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h20
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0935705
{'0': {'precision': 0.4221887550200803, 'recall': 0.20926198448752675, 'f1-score': 0.27982564965467416, 'support': 140661}, '1': {'precision': 0.35397548116133754, 'recall': 0.4389129101868883, 'f1-score': 0.3918947742623533, 'support': 125583}, '2': {'precision': 0.41014354913627216, 'recall': 0.5296600184237024, 'f1-score': 0.4623022241890296, 'support': 140037}, 'accuracy': 0.3906828032814727, 'macro avg': {'precision': 0.39543592843923, 'recall': 0.39261163769937246, 'f1-score': 0.3780075493686857, 'support': 406281}, 'weighted avg': {'precision': 0.3969520295336477, 'recall': 0.3906828032814727, 'f1-score': 0.3773626965352167, 'support': 406281}}
[[29435 56592 54634]
 [18425 55120 52038]
 [21860 44005 74172]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0815231
{'0': {'precision': 0.44156608772446276, 'recall': 0.23013194231359313, 'f1-score': 0.30257186081694404, 'support': 26072}, '1': {'precision': 0.37418207229527983, 'recall': 0.4726557798017895, 'f1-score': 0.41769346689123305, 'support': 24923}, '2': {'precision': 0.4009796830823854, 'recall': 0.49797901441228104, 'f1-score': 0.4442461437599024, 'support': 24493}, 'accuracy': 0.39710947435353966, 'macro avg': {'precision': 0.4055759477007093, 'recall': 0.4002555788425546, 'f1-score': 0.38817049048935987, 'support': 75488}, 'weighted avg': {'precision': 0.4061499338266256, 'recall': 0.39710947435353966, 'f1-score': 0.3865481749372199, 'support': 75488}}
[[ 6000 11212  8860]
 [ 3782 11780  9361]
 [ 3806  8490 12197]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0804399
{'0': {'precision': 0.4510395707578806, 'recall': 0.23617208077260754, 'f1-score': 0.31001498213668316, 'support': 11390}, '1': {'precision': 0.4215960564881428, 'recall': 0.5581620954228768, 'f1-score': 0.48036127661189326, 'support': 11339}, '2': {'precision': 0.4110518662142511, 'recall': 0.4788705882352941, 'f1-score': 0.4423770812502717, 'support': 10625}, 'accuracy': 0.4229477723811237, 'macro avg': {'precision': 0.42789583115342483, 'recall': 0.4244015881435928, 'f1-score': 0.41091777999961604, 'support': 33354}, 'weighted avg': {'precision': 0.42829179330748124, 'recall': 0.4229477723811237, 'f1-score': 0.41009005367641704, 'support': 33354}}
[[2690 4864 3836]
 [1556 6329 3454]
 [1718 3819 5088]]
training model: results/CHTR/W10/deepOF_L1/h30
Epoch 1/50
295/295 - 10s - loss: 3.3087 - accuracy30: 0.3711 - val_loss: 3.2973 - val_accuracy30: 0.3751 - 10s/epoch - 32ms/step
Epoch 2/50
295/295 - 7s - loss: 3.2760 - accuracy30: 0.3852 - val_loss: 3.2826 - val_accuracy30: 0.3830 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2619 - accuracy30: 0.3922 - val_loss: 3.2834 - val_accuracy30: 0.3856 - 7s/epoch - 24ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2498 - accuracy30: 0.3989 - val_loss: 3.2807 - val_accuracy30: 0.3805 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2415 - accuracy30: 0.4042 - val_loss: 3.2701 - val_accuracy30: 0.3930 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 8s - loss: 3.2381 - accuracy30: 0.4067 - val_loss: 3.2745 - val_accuracy30: 0.3876 - 8s/epoch - 26ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2325 - accuracy30: 0.4089 - val_loss: 3.2778 - val_accuracy30: 0.3851 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2241 - accuracy30: 0.4132 - val_loss: 3.2789 - val_accuracy30: 0.3880 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2201 - accuracy30: 0.4154 - val_loss: 3.2803 - val_accuracy30: 0.3822 - 7s/epoch - 25ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2165 - accuracy30: 0.4159 - val_loss: 3.2756 - val_accuracy30: 0.3805 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2128 - accuracy30: 0.4184 - val_loss: 3.2840 - val_accuracy30: 0.3760 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2071 - accuracy30: 0.4216 - val_loss: 3.2817 - val_accuracy30: 0.3929 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2058 - accuracy30: 0.4218 - val_loss: 3.2757 - val_accuracy30: 0.4025 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2027 - accuracy30: 0.4229 - val_loss: 3.2806 - val_accuracy30: 0.3869 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.1984 - accuracy30: 0.4252 - val_loss: 3.2772 - val_accuracy30: 0.3980 - 7s/epoch - 24ms/step
testing model: results/CHTR/W10/deepOF_L1/h30
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1013956
{'0': {'precision': 0.41870215876838396, 'recall': 0.13754255604684343, 'f1-score': 0.20706485331178287, 'support': 141578}, '1': {'precision': 0.32207016646334263, 'recall': 0.5295240406001052, 'f1-score': 0.40052854866287585, 'support': 123645}, '2': {'precision': 0.4133878646515641, 'recall': 0.45859859065065434, 'f1-score': 0.43482118550932136, 'support': 141058}, 'accuracy': 0.36830420324849056, 'macro avg': {'precision': 0.38472006329443026, 'recall': 0.375221729099201, 'f1-score': 0.3474715291613267, 'support': 406281}, 'weighted avg': {'precision': 0.38744870023085154, 'recall': 0.36830420324849056, 'f1-score': 0.34501782506976875, 'support': 406281}}
[[19473 75753 46352]
 [12728 65473 45444]
 [14307 62062 64689]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0903258
{'0': {'precision': 0.44158986175115206, 'recall': 0.1466391216190367, 'f1-score': 0.22016715011918778, 'support': 26139}, '1': {'precision': 0.35023834095041523, 'recall': 0.5711194807276224, 'f1-score': 0.4342025100523943, 'support': 24958}, '2': {'precision': 0.39980850248946764, 'recall': 0.42798573244229426, 'f1-score': 0.4134175560879982, 'support': 24391}, 'accuracy': 0.37788787621873676, 'macro avg': {'precision': 0.39721223506367825, 'recall': 0.3819147782629844, 'f1-score': 0.35592907208652674, 'support': 75488}, 'weighted avg': {'precision': 0.3978870163996188, 'recall': 0.37788787621873676, 'f1-score': 0.3533732910316271, 'support': 75488}}
[[ 3833 14794  7512]
 [ 2545 14254  8159]
 [ 2302 11650 10439]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927069
{'0': {'precision': 0.44206773618538325, 'recall': 0.15274967003959525, 'f1-score': 0.22704682186764322, 'support': 11365}, '1': {'precision': 0.37809739280327515, 'recall': 0.6164588090637625, 'f1-score': 0.46871452420701165, 'support': 11386}, '2': {'precision': 0.40053392248918346, 'recall': 0.41035555974724136, 'f1-score': 0.40538526041181405, 'support': 10603}, 'accuracy': 0.39293637944474424, 'macro avg': {'precision': 0.4068996838259473, 'recall': 0.39318801295019973, 'f1-score': 0.367048868828823, 'support': 33354}, 'weighted avg': {'precision': 0.4070269807626607, 'recall': 0.39293637944474424, 'f1-score': 0.3662370516068017, 'support': 33354}}
[[1736 6401 3228]
 [1083 7019 3284]
 [1108 5144 4351]]
training model: results/CHTR/W10/deepOF_L1/h50
Epoch 1/50
295/295 - 9s - loss: 3.3156 - accuracy50: 0.3684 - val_loss: 3.3035 - val_accuracy50: 0.3714 - 9s/epoch - 31ms/step
Epoch 2/50
295/295 - 7s - loss: 3.2863 - accuracy50: 0.3814 - val_loss: 3.3000 - val_accuracy50: 0.3757 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2728 - accuracy50: 0.3857 - val_loss: 3.2873 - val_accuracy50: 0.3803 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2629 - accuracy50: 0.3915 - val_loss: 3.2816 - val_accuracy50: 0.3854 - 7s/epoch - 24ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2575 - accuracy50: 0.3946 - val_loss: 3.2786 - val_accuracy50: 0.3877 - 7s/epoch - 24ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2503 - accuracy50: 0.3976 - val_loss: 3.2739 - val_accuracy50: 0.3943 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2479 - accuracy50: 0.4005 - val_loss: 3.2785 - val_accuracy50: 0.3868 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2424 - accuracy50: 0.4029 - val_loss: 3.2820 - val_accuracy50: 0.3799 - 7s/epoch - 24ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2387 - accuracy50: 0.4014 - val_loss: 3.2758 - val_accuracy50: 0.3886 - 7s/epoch - 24ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2373 - accuracy50: 0.4042 - val_loss: 3.2839 - val_accuracy50: 0.3804 - 7s/epoch - 24ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2329 - accuracy50: 0.4077 - val_loss: 3.2766 - val_accuracy50: 0.3947 - 7s/epoch - 24ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2282 - accuracy50: 0.4093 - val_loss: 3.2758 - val_accuracy50: 0.3938 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2272 - accuracy50: 0.4109 - val_loss: 3.2718 - val_accuracy50: 0.3984 - 7s/epoch - 24ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2231 - accuracy50: 0.4109 - val_loss: 3.2826 - val_accuracy50: 0.3840 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2229 - accuracy50: 0.4132 - val_loss: 3.2806 - val_accuracy50: 0.3854 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 7s - loss: 3.2184 - accuracy50: 0.4153 - val_loss: 3.2797 - val_accuracy50: 0.3899 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 8s - loss: 3.2176 - accuracy50: 0.4149 - val_loss: 3.2822 - val_accuracy50: 0.3831 - 8s/epoch - 26ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2116 - accuracy50: 0.4176 - val_loss: 3.2869 - val_accuracy50: 0.3837 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.2079 - accuracy50: 0.4212 - val_loss: 3.2913 - val_accuracy50: 0.3780 - 7s/epoch - 25ms/step
Epoch 20/50
295/295 - 7s - loss: 3.2063 - accuracy50: 0.4203 - val_loss: 3.2858 - val_accuracy50: 0.3848 - 7s/epoch - 25ms/step
Epoch 21/50
295/295 - 7s - loss: 3.2048 - accuracy50: 0.4232 - val_loss: 3.2855 - val_accuracy50: 0.3879 - 7s/epoch - 24ms/step
Epoch 22/50
295/295 - 7s - loss: 3.1998 - accuracy50: 0.4253 - val_loss: 3.2912 - val_accuracy50: 0.3907 - 7s/epoch - 25ms/step
Epoch 23/50
295/295 - 8s - loss: 3.1958 - accuracy50: 0.4257 - val_loss: 3.2869 - val_accuracy50: 0.3893 - 8s/epoch - 27ms/step
testing model: results/CHTR/W10/deepOF_L1/h50
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.098261
{'0': {'precision': 0.4215383427291683, 'recall': 0.2268404684891847, 'f1-score': 0.2949570636682532, 'support': 144379}, '1': {'precision': 0.3185841329605642, 'recall': 0.3782758102990975, 'f1-score': 0.3458734347116514, 'support': 119894}, '2': {'precision': 0.4086151995661256, 'recall': 0.5358571348093065, 'f1-score': 0.4636649737841864, 'support': 142008}, 'accuracy': 0.3795402689271711, 'macro avg': {'precision': 0.3829125584186193, 'recall': 0.38032447119919627, 'f1-score': 0.3681651573880303, 'support': 406281}, 'weighted avg': {'precision': 0.3866393891962825, 'recall': 0.3795402689271711, 'f1-score': 0.36895127036170094, 'support': 406281}}
[[32751 54873 56755]
 [21163 45353 53378]
 [23780 42132 76096]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087932
{'0': {'precision': 0.4293872313121591, 'recall': 0.2553223960320488, 'f1-score': 0.3202296925469554, 'support': 26210}, '1': {'precision': 0.3628921758071883, 'recall': 0.41510268054495036, 'f1-score': 0.38724552918681815, 'support': 24883}, '2': {'precision': 0.38839058524173026, 'recall': 0.5005533920885428, 'f1-score': 0.43739589862989164, 'support': 24395}, 'accuracy': 0.38724035608308605, 'macro avg': {'precision': 0.3935566641203592, 'recall': 0.39032615622184735, 'f1-score': 0.38162370678788843, 'support': 75488}, 'weighted avg': {'precision': 0.39421992462741057, 'recall': 0.38724035608308605, 'f1-score': 0.3801839191856653, 'support': 75488}}
[[ 6692 10198  9320]
 [ 4645 10329  9909]
 [ 4248  7936 12211]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091261
{'0': {'precision': 0.4296350364963504, 'recall': 0.2618560370139692, 'f1-score': 0.32539112167615675, 'support': 11239}, '1': {'precision': 0.39555052790346906, 'recall': 0.45434857934857936, 'f1-score': 0.4229156587647154, 'support': 11544}, '2': {'precision': 0.3810782241014799, 'recall': 0.4774382745246429, 'f1-score': 0.4238505143816922, 'support': 10571}, 'accuracy': 0.3968039815314505, 'macro avg': {'precision': 0.4020879295004331, 'recall': 0.39788096362906383, 'f1-score': 0.3907190982741881, 'support': 33354}, 'weighted avg': {'precision': 0.40244892295607343, 'recall': 0.3968039815314505, 'f1-score': 0.3903499720821212, 'support': 33354}}
[[2943 4353 3943]
 [2045 5245 4254]
 [1862 3662 5047]]
training model: results/CHTR/W10/deepOF_L1/h100
Epoch 1/50
295/295 - 9s - loss: 3.3263 - accuracy100: 0.3608 - val_loss: 3.3130 - val_accuracy100: 0.3681 - 9s/epoch - 31ms/step
Epoch 2/50
295/295 - 7s - loss: 3.3039 - accuracy100: 0.3676 - val_loss: 3.2980 - val_accuracy100: 0.3683 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 7s - loss: 3.2921 - accuracy100: 0.3733 - val_loss: 3.2954 - val_accuracy100: 0.3743 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2849 - accuracy100: 0.3757 - val_loss: 3.2856 - val_accuracy100: 0.3821 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2786 - accuracy100: 0.3797 - val_loss: 3.2897 - val_accuracy100: 0.3802 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2733 - accuracy100: 0.3818 - val_loss: 3.2869 - val_accuracy100: 0.3867 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2722 - accuracy100: 0.3829 - val_loss: 3.2808 - val_accuracy100: 0.3885 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2668 - accuracy100: 0.3857 - val_loss: 3.2857 - val_accuracy100: 0.3874 - 7s/epoch - 24ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2627 - accuracy100: 0.3886 - val_loss: 3.2827 - val_accuracy100: 0.3904 - 7s/epoch - 25ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2606 - accuracy100: 0.3885 - val_loss: 3.2815 - val_accuracy100: 0.3906 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2580 - accuracy100: 0.3920 - val_loss: 3.2853 - val_accuracy100: 0.3891 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2552 - accuracy100: 0.3933 - val_loss: 3.2835 - val_accuracy100: 0.3891 - 7s/epoch - 24ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2526 - accuracy100: 0.3953 - val_loss: 3.2876 - val_accuracy100: 0.3866 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2486 - accuracy100: 0.3959 - val_loss: 3.2873 - val_accuracy100: 0.3871 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2482 - accuracy100: 0.3982 - val_loss: 3.2862 - val_accuracy100: 0.3912 - 7s/epoch - 24ms/step
Epoch 16/50
295/295 - 8s - loss: 3.2449 - accuracy100: 0.3982 - val_loss: 3.2880 - val_accuracy100: 0.3890 - 8s/epoch - 26ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2430 - accuracy100: 0.3996 - val_loss: 3.2888 - val_accuracy100: 0.3886 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h100
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1053731
{'0': {'precision': 0.42084235860409147, 'recall': 0.17856462066336257, 'f1-score': 0.2507396767887273, 'support': 146888}, '1': {'precision': 0.2873878531966028, 'recall': 0.5228278288740246, 'f1-score': 0.3708996768553016, 'support': 114816}, '2': {'precision': 0.4076681620989354, 'recall': 0.3808835430255158, 'f1-score': 0.3938209579660653, 'support': 144577}, 'accuracy': 0.34785037941720137, 'macro avg': {'precision': 0.3719661246332098, 'recall': 0.3607586641876343, 'f1-score': 0.33848677053669807, 'support': 406281}, 'weighted avg': {'precision': 0.37843969074368905, 'recall': 0.34785037941720137, 'f1-score': 0.335613330630329, 'support': 406281}}
[[26229 78562 42097]
 [16873 60029 37914]
 [19223 70287 55067]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953039
{'0': {'precision': 0.4217703349282297, 'recall': 0.20558168461149764, 'f1-score': 0.27642616353516086, 'support': 25727}, '1': {'precision': 0.34179393939393937, 'recall': 0.567341354472657, 'f1-score': 0.4265896128651608, 'support': 24851}, '2': {'precision': 0.38095677020923585, 'recall': 0.3318346045764753, 'f1-score': 0.35470305526948165, 'support': 24910}, 'accuracy': 0.36633637134378977, 'macro avg': {'precision': 0.3815070148438016, 'recall': 0.3682525478868766, 'f1-score': 0.3525729438899344, 'support': 75488}, 'weighted avg': {'precision': 0.3819738202163181, 'recall': 0.36633637134378977, 'f1-score': 0.3516909639325983, 'support': 75488}}
[[ 5289 14101  6337]
 [ 3657 14099  7095]
 [ 3594 13050  8266]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0952835
{'0': {'precision': 0.41147086031452357, 'recall': 0.2033650329188003, 'f1-score': 0.27219876384554187, 'support': 10936}, '1': {'precision': 0.38101744797141057, 'recall': 0.6202412524595774, 'f1-score': 0.4720513070937918, 'support': 11689}, '2': {'precision': 0.38941822665620446, 'recall': 0.3237953210923665, 'f1-score': 0.35358778625954196, 'support': 10729}, 'accuracy': 0.3881993164238172, 'macro avg': {'precision': 0.3939688449807129, 'recall': 0.3824672021569147, 'f1-score': 0.3659459523996252, 'support': 33354}, 'weighted avg': {'precision': 0.39370469603441466, 'recall': 0.3881993164238172, 'f1-score': 0.3684180838523956, 'support': 33354}}
[[2224 6099 2613]
 [1605 7250 2834]
 [1576 5679 3474]]
training model: results/CHTR/W10/deepOF_L1/h200
Epoch 1/50
295/295 - 10s - loss: 3.3335 - accuracy200: 0.3515 - val_loss: 3.3344 - val_accuracy200: 0.3696 - 10s/epoch - 33ms/step
Epoch 2/50
295/295 - 8s - loss: 3.3152 - accuracy200: 0.3555 - val_loss: 3.3148 - val_accuracy200: 0.3682 - 8s/epoch - 26ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3029 - accuracy200: 0.3619 - val_loss: 3.3025 - val_accuracy200: 0.3717 - 8s/epoch - 26ms/step
Epoch 4/50
295/295 - 8s - loss: 3.2960 - accuracy200: 0.3621 - val_loss: 3.2968 - val_accuracy200: 0.3714 - 8s/epoch - 26ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2911 - accuracy200: 0.3658 - val_loss: 3.2959 - val_accuracy200: 0.3731 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2856 - accuracy200: 0.3672 - val_loss: 3.2935 - val_accuracy200: 0.3728 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2835 - accuracy200: 0.3670 - val_loss: 3.2918 - val_accuracy200: 0.3755 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2800 - accuracy200: 0.3722 - val_loss: 3.2897 - val_accuracy200: 0.3769 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2781 - accuracy200: 0.3718 - val_loss: 3.2909 - val_accuracy200: 0.3757 - 7s/epoch - 24ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2751 - accuracy200: 0.3743 - val_loss: 3.2918 - val_accuracy200: 0.3782 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2717 - accuracy200: 0.3757 - val_loss: 3.2872 - val_accuracy200: 0.3808 - 7s/epoch - 24ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2716 - accuracy200: 0.3770 - val_loss: 3.2889 - val_accuracy200: 0.3841 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2692 - accuracy200: 0.3778 - val_loss: 3.2879 - val_accuracy200: 0.3809 - 7s/epoch - 24ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2661 - accuracy200: 0.3816 - val_loss: 3.2881 - val_accuracy200: 0.3811 - 7s/epoch - 24ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2662 - accuracy200: 0.3805 - val_loss: 3.2917 - val_accuracy200: 0.3820 - 7s/epoch - 25ms/step
Epoch 16/50
295/295 - 7s - loss: 3.2627 - accuracy200: 0.3833 - val_loss: 3.2939 - val_accuracy200: 0.3797 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2612 - accuracy200: 0.3842 - val_loss: 3.2913 - val_accuracy200: 0.3830 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2594 - accuracy200: 0.3851 - val_loss: 3.2943 - val_accuracy200: 0.3808 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.2591 - accuracy200: 0.3860 - val_loss: 3.2992 - val_accuracy200: 0.3788 - 7s/epoch - 25ms/step
Epoch 20/50
295/295 - 7s - loss: 3.2545 - accuracy200: 0.3871 - val_loss: 3.2984 - val_accuracy200: 0.3836 - 7s/epoch - 25ms/step
Epoch 21/50
295/295 - 7s - loss: 3.2534 - accuracy200: 0.3887 - val_loss: 3.2993 - val_accuracy200: 0.3788 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h200
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135448
{'0': {'precision': 0.39123470768550994, 'recall': 0.09712804832063843, 'f1-score': 0.1556214642719833, 'support': 145859}, '1': {'precision': 0.28448355457070007, 'recall': 0.6956529290192605, 'f1-score': 0.40382502091965844, 'support': 115158}, '2': {'precision': 0.39308481779546073, 'recall': 0.23940549620002202, 'f1-score': 0.2975750419276449, 'support': 145264}, 'accuracy': 0.3176471456947285, 'macro avg': {'precision': 0.3562676933505569, 'recall': 0.3440621578466403, 'f1-score': 0.28567384237309557, 'support': 406281}, 'weighted avg': {'precision': 0.3616382094604308, 'recall': 0.3176471456947285, 'f1-score': 0.2767282098027982, 'support': 406281}}
[[ 14167 102920  28772]
 [ 10125  80110  24923]
 [ 11919  98568  34777]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966532
{'0': {'precision': 0.4181717909830415, 'recall': 0.12233291654902594, 'f1-score': 0.18929039505710543, 'support': 24793}, '1': {'precision': 0.3384279475982533, 'recall': 0.7451923076923077, 'f1-score': 0.4654654654654655, 'support': 24960}, '2': {'precision': 0.3963088512241055, 'recall': 0.20442976491159898, 'f1-score': 0.2697257113560625, 'support': 25735}, 'accuracy': 0.35626854599406527, 'macro avg': {'precision': 0.3843028632684668, 'recall': 0.35731832971764416, 'f1-score': 0.30816052395954446, 'support': 75488}, 'weighted avg': {'precision': 0.38435119584764865, 'recall': 0.35626854599406527, 'f1-score': 0.30802890478509304, 'support': 75488}}
[[ 3033 18001  3759]
 [ 2105 18600  4255]
 [ 2115 18359  5261]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965211
{'0': {'precision': 0.3748789150791088, 'recall': 0.1109730453068247, 'f1-score': 0.1712515672247216, 'support': 10462}, '1': {'precision': 0.3746527637988647, 'recall': 0.7762115272332972, 'f1-score': 0.5053763440860216, 'support': 11989}, '2': {'precision': 0.3997785160575858, 'recall': 0.19866091901311567, 'f1-score': 0.26542491268917345, 'support': 10903}, 'accuracy': 0.37875517179348805, 'macro avg': {'precision': 0.3831033983118531, 'recall': 0.3619484971844125, 'f1-score': 0.3140176079999722, 'support': 33354}, 'weighted avg': {'precision': 0.3829369897259124, 'recall': 0.37875517179348805, 'f1-score': 0.32213583703910803, 'support': 33354}}
[[1161 7759 1542]
 [ 973 9306 1710]
 [ 963 7774 2166]]
training model: results/CHTR/W10/deepOF_L1/h300
Epoch 1/50
295/295 - 9s - loss: 3.3333 - accuracy300: 0.3553 - val_loss: 3.3269 - val_accuracy300: 0.3717 - 9s/epoch - 31ms/step
Epoch 2/50
295/295 - 7s - loss: 3.3154 - accuracy300: 0.3586 - val_loss: 3.3122 - val_accuracy300: 0.3682 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3044 - accuracy300: 0.3600 - val_loss: 3.3082 - val_accuracy300: 0.3672 - 8s/epoch - 26ms/step
Epoch 4/50
295/295 - 7s - loss: 3.2973 - accuracy300: 0.3624 - val_loss: 3.3028 - val_accuracy300: 0.3677 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.2924 - accuracy300: 0.3642 - val_loss: 3.2990 - val_accuracy300: 0.3700 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2885 - accuracy300: 0.3657 - val_loss: 3.2986 - val_accuracy300: 0.3715 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2866 - accuracy300: 0.3658 - val_loss: 3.2999 - val_accuracy300: 0.3701 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2831 - accuracy300: 0.3678 - val_loss: 3.2948 - val_accuracy300: 0.3713 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2796 - accuracy300: 0.3704 - val_loss: 3.2950 - val_accuracy300: 0.3708 - 7s/epoch - 24ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2783 - accuracy300: 0.3707 - val_loss: 3.2990 - val_accuracy300: 0.3722 - 7s/epoch - 24ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2756 - accuracy300: 0.3729 - val_loss: 3.2960 - val_accuracy300: 0.3717 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2733 - accuracy300: 0.3755 - val_loss: 3.2990 - val_accuracy300: 0.3719 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2727 - accuracy300: 0.3737 - val_loss: 3.2963 - val_accuracy300: 0.3725 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2714 - accuracy300: 0.3758 - val_loss: 3.3004 - val_accuracy300: 0.3732 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 8s - loss: 3.2687 - accuracy300: 0.3781 - val_loss: 3.3020 - val_accuracy300: 0.3688 - 8s/epoch - 26ms/step
Epoch 16/50
295/295 - 7s - loss: 3.2671 - accuracy300: 0.3778 - val_loss: 3.3034 - val_accuracy300: 0.3725 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2648 - accuracy300: 0.3801 - val_loss: 3.3040 - val_accuracy300: 0.3711 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2631 - accuracy300: 0.3824 - val_loss: 3.3011 - val_accuracy300: 0.3738 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h300
Evaluating performance on  test set...
1588/1588 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1181947
{'0': {'precision': 0.38051400076716535, 'recall': 0.06786479035115925, 'f1-score': 0.11518610335398247, 'support': 146173}, '1': {'precision': 0.2875153593715564, 'recall': 0.8167721573268838, 'f1-score': 0.4253141265974289, 'support': 116598}, '2': {'precision': 0.37288689260922825, 'recall': 0.12726639258588252, 'f1-score': 0.18976570211439558, 'support': 143510}, 'accuracy': 0.30377497347894683, 'macro avg': {'precision': 0.34697208424931664, 'recall': 0.3373011134213085, 'f1-score': 0.24342197735526896, 'support': 406281}, 'weighted avg': {'precision': 0.35113034295104606, 'recall': 0.30377497347894683, 'f1-score': 0.23053293343524703, 'support': 406281}}
[[  9920 119424  16829]
 [  7477  95234  13887]
 [  8673 116573  18264]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007617
{'0': {'precision': 0.3971274016041783, 'recall': 0.08815369963976646, 'f1-score': 0.1442802927622662, 'support': 24151}, '1': {'precision': 0.33485453508271534, 'recall': 0.8479595521849043, 'f1-score': 0.48011450771904707, 'support': 24921}, '2': {'precision': 0.3960678159281949, 'recall': 0.10523924894003635, 'f1-score': 0.16629280693883652, 'support': 26416}, 'accuracy': 0.3449687367528614, 'macro avg': {'precision': 0.37601658420502954, 'recall': 0.34711750025490234, 'f1-score': 0.26356253580671657, 'support': 75488}, 'weighted avg': {'precision': 0.3761983516651396, 'recall': 0.3449687367528614, 'f1-score': 0.26285287443652194, 'support': 75488}}
[[ 2129 19998  2024]
 [ 1574 21132  2215]
 [ 1658 21978  2780]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987173
{'0': {'precision': 0.3532959931064196, 'recall': 0.08080409932991722, 'f1-score': 0.13152618493864784, 'support': 10148}, '1': {'precision': 0.3684511880904667, 'recall': 0.8548654931916306, 'f1-score': 0.5149544863459038, 'support': 12044}, '2': {'precision': 0.39753965684687603, 'recall': 0.11001612614226841, 'f1-score': 0.1723387832432812, 'support': 11162}, 'accuracy': 0.37009054386280504, 'macro avg': {'precision': 0.37309561268125413, 'recall': 0.3485619062212721, 'f1-score': 0.2729398181759443, 'support': 33354}, 'weighted avg': {'precision': 0.3735747285821897, 'recall': 0.37009054386280504, 'f1-score': 0.28363869571472594, 'support': 33354}}
[[  820  8489   839]
 [  726 10296  1022]
 [  775  9159  1228]]
training model: results/CHTR/W10/deepOF_L1/h500
Epoch 1/50
295/295 - 9s - loss: 3.3374 - accuracy500: 0.3545 - val_loss: 3.3333 - val_accuracy500: 0.3692 - 9s/epoch - 32ms/step
Epoch 2/50
295/295 - 7s - loss: 3.3219 - accuracy500: 0.3553 - val_loss: 3.3172 - val_accuracy500: 0.3648 - 7s/epoch - 24ms/step
Epoch 3/50
295/295 - 7s - loss: 3.3131 - accuracy500: 0.3527 - val_loss: 3.3135 - val_accuracy500: 0.3643 - 7s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.3043 - accuracy500: 0.3563 - val_loss: 3.3082 - val_accuracy500: 0.3653 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.3007 - accuracy500: 0.3573 - val_loss: 3.3036 - val_accuracy500: 0.3620 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2980 - accuracy500: 0.3574 - val_loss: 3.2994 - val_accuracy500: 0.3650 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2930 - accuracy500: 0.3595 - val_loss: 3.3006 - val_accuracy500: 0.3653 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2909 - accuracy500: 0.3621 - val_loss: 3.3009 - val_accuracy500: 0.3657 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 8s - loss: 3.2902 - accuracy500: 0.3616 - val_loss: 3.3008 - val_accuracy500: 0.3661 - 8s/epoch - 26ms/step
Epoch 10/50
295/295 - 8s - loss: 3.2870 - accuracy500: 0.3640 - val_loss: 3.3019 - val_accuracy500: 0.3632 - 8s/epoch - 26ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2846 - accuracy500: 0.3656 - val_loss: 3.2995 - val_accuracy500: 0.3657 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2837 - accuracy500: 0.3652 - val_loss: 3.2999 - val_accuracy500: 0.3668 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2819 - accuracy500: 0.3681 - val_loss: 3.2994 - val_accuracy500: 0.3670 - 7s/epoch - 25ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2805 - accuracy500: 0.3692 - val_loss: 3.3009 - val_accuracy500: 0.3660 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2781 - accuracy500: 0.3704 - val_loss: 3.3014 - val_accuracy500: 0.3682 - 7s/epoch - 24ms/step
Epoch 16/50
295/295 - 7s - loss: 3.2780 - accuracy500: 0.3715 - val_loss: 3.3028 - val_accuracy500: 0.3668 - 7s/epoch - 25ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2753 - accuracy500: 0.3705 - val_loss: 3.3076 - val_accuracy500: 0.3663 - 7s/epoch - 24ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2748 - accuracy500: 0.3726 - val_loss: 3.3071 - val_accuracy500: 0.3647 - 7s/epoch - 24ms/step
Epoch 19/50
295/295 - 7s - loss: 3.2722 - accuracy500: 0.3740 - val_loss: 3.3063 - val_accuracy500: 0.3650 - 7s/epoch - 25ms/step
Epoch 20/50
295/295 - 7s - loss: 3.2724 - accuracy500: 0.3744 - val_loss: 3.3087 - val_accuracy500: 0.3662 - 7s/epoch - 25ms/step
Epoch 21/50
295/295 - 7s - loss: 3.2695 - accuracy500: 0.3778 - val_loss: 3.3089 - val_accuracy500: 0.3660 - 7s/epoch - 25ms/step
Epoch 22/50
295/295 - 7s - loss: 3.2683 - accuracy500: 0.3782 - val_loss: 3.3120 - val_accuracy500: 0.3680 - 7s/epoch - 25ms/step
Epoch 23/50
295/295 - 7s - loss: 3.2674 - accuracy500: 0.3776 - val_loss: 3.3100 - val_accuracy500: 0.3646 - 7s/epoch - 25ms/step
testing model: results/CHTR/W10/deepOF_L1/h500
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1161993
{'0': {'precision': 0.34892621212490554, 'recall': 0.10031185395423806, 'f1-score': 0.15582577646175116, 'support': 142695}, '1': {'precision': 0.30326484660849984, 'recall': 0.8249979636719068, 'f1-score': 0.44350106841349346, 'support': 122770}, '2': {'precision': 0.360532037344929, 'recall': 0.08007612771275992, 'f1-score': 0.13104618459893547, 'support': 140816}, 'accuracy': 0.3122838626467888, 'macro avg': {'precision': 0.3375743653594448, 'recall': 0.3351286484463016, 'f1-score': 0.24345767649139338, 'support': 406281}, 'weighted avg': {'precision': 0.3391508104687456, 'recall': 0.3122838626467888, 'f1-score': 0.23416695555986589, 'support': 406281}}
[[ 14314 117396  10985]
 [ 12470 101285   9015]
 [ 14239 115301  11276]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029606
{'0': {'precision': 0.3670336486276942, 'recall': 0.09940366201915, 'f1-score': 0.15643898086646177, 'support': 23812}, '1': {'precision': 0.3338416071933851, 'recall': 0.8547108302813217, 'f1-score': 0.48014379217960457, 'support': 24847}, '2': {'precision': 0.4173271889400922, 'recall': 0.08438629840843863, 'f1-score': 0.14038568859676318, 'support': 26829}, 'accuracy': 0.3426769817719373, 'macro avg': {'precision': 0.37273414825372386, 'recall': 0.34616693023630346, 'f1-score': 0.2589894872142765, 'support': 75488}, 'weighted avg': {'precision': 0.37398313383756926, 'recall': 0.3426769817719373, 'f1-score': 0.2572814944897385, 'support': 75488}}
[[ 2367 19927  1518]
 [ 1967 21237  1643]
 [ 2115 22450  2264]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007961
{'0': {'precision': 0.31389664804469275, 'recall': 0.08876382306477093, 'f1-score': 0.13839285714285715, 'support': 10128}, '1': {'precision': 0.37027539693691164, 'recall': 0.8754256291005731, 'f1-score': 0.5204275593078082, 'support': 12041}, '2': {'precision': 0.4075173095944609, 'recall': 0.07367009387572641, 'f1-score': 0.12478231241008554, 'support': 11185}, 'accuracy': 0.3676920309408167, 'macro avg': {'precision': 0.3638964515253551, 'recall': 0.34595318201369013, 'f1-score': 0.2612009096202503, 'support': 33354}, 'weighted avg': {'precision': 0.36564467271475826, 'recall': 0.3676920309408167, 'f1-score': 0.2717455556477478, 'support': 33354}}
[[  899  8644   585]
 [  887 10541   613]
 [ 1078  9283   824]]
training model: results/CHTR/W10/deepOF_L1/h1000
Epoch 1/50
295/295 - 9s - loss: 3.3455 - accuracy1000: 0.3472 - val_loss: 3.3570 - val_accuracy1000: 0.3485 - 9s/epoch - 32ms/step
Epoch 2/50
295/295 - 7s - loss: 3.3298 - accuracy1000: 0.3461 - val_loss: 3.3355 - val_accuracy1000: 0.3526 - 7s/epoch - 25ms/step
Epoch 3/50
295/295 - 8s - loss: 3.3176 - accuracy1000: 0.3485 - val_loss: 3.3231 - val_accuracy1000: 0.3532 - 8s/epoch - 25ms/step
Epoch 4/50
295/295 - 7s - loss: 3.3096 - accuracy1000: 0.3496 - val_loss: 3.3182 - val_accuracy1000: 0.3542 - 7s/epoch - 25ms/step
Epoch 5/50
295/295 - 7s - loss: 3.3053 - accuracy1000: 0.3512 - val_loss: 3.3128 - val_accuracy1000: 0.3527 - 7s/epoch - 25ms/step
Epoch 6/50
295/295 - 7s - loss: 3.2997 - accuracy1000: 0.3552 - val_loss: 3.3144 - val_accuracy1000: 0.3547 - 7s/epoch - 25ms/step
Epoch 7/50
295/295 - 7s - loss: 3.2960 - accuracy1000: 0.3563 - val_loss: 3.3169 - val_accuracy1000: 0.3516 - 7s/epoch - 25ms/step
Epoch 8/50
295/295 - 7s - loss: 3.2942 - accuracy1000: 0.3555 - val_loss: 3.3137 - val_accuracy1000: 0.3491 - 7s/epoch - 25ms/step
Epoch 9/50
295/295 - 7s - loss: 3.2918 - accuracy1000: 0.3578 - val_loss: 3.3153 - val_accuracy1000: 0.3511 - 7s/epoch - 25ms/step
Epoch 10/50
295/295 - 7s - loss: 3.2902 - accuracy1000: 0.3599 - val_loss: 3.3147 - val_accuracy1000: 0.3533 - 7s/epoch - 25ms/step
Epoch 11/50
295/295 - 7s - loss: 3.2879 - accuracy1000: 0.3601 - val_loss: 3.3090 - val_accuracy1000: 0.3596 - 7s/epoch - 25ms/step
Epoch 12/50
295/295 - 7s - loss: 3.2863 - accuracy1000: 0.3622 - val_loss: 3.3146 - val_accuracy1000: 0.3570 - 7s/epoch - 25ms/step
Epoch 13/50
295/295 - 7s - loss: 3.2840 - accuracy1000: 0.3628 - val_loss: 3.3182 - val_accuracy1000: 0.3526 - 7s/epoch - 24ms/step
Epoch 14/50
295/295 - 7s - loss: 3.2827 - accuracy1000: 0.3637 - val_loss: 3.3174 - val_accuracy1000: 0.3536 - 7s/epoch - 25ms/step
Epoch 15/50
295/295 - 7s - loss: 3.2823 - accuracy1000: 0.3666 - val_loss: 3.3198 - val_accuracy1000: 0.3517 - 7s/epoch - 24ms/step
Epoch 16/50
295/295 - 7s - loss: 3.2815 - accuracy1000: 0.3655 - val_loss: 3.3176 - val_accuracy1000: 0.3534 - 7s/epoch - 24ms/step
Epoch 17/50
295/295 - 7s - loss: 3.2808 - accuracy1000: 0.3668 - val_loss: 3.3190 - val_accuracy1000: 0.3537 - 7s/epoch - 25ms/step
Epoch 18/50
295/295 - 7s - loss: 3.2773 - accuracy1000: 0.3706 - val_loss: 3.3197 - val_accuracy1000: 0.3553 - 7s/epoch - 25ms/step
Epoch 19/50
295/295 - 7s - loss: 3.2759 - accuracy1000: 0.3718 - val_loss: 3.3203 - val_accuracy1000: 0.3543 - 7s/epoch - 24ms/step
Epoch 20/50
295/295 - 7s - loss: 3.2738 - accuracy1000: 0.3740 - val_loss: 3.3253 - val_accuracy1000: 0.3520 - 7s/epoch - 25ms/step
Epoch 21/50
295/295 - 7s - loss: 3.2729 - accuracy1000: 0.3753 - val_loss: 3.3236 - val_accuracy1000: 0.3546 - 7s/epoch - 24ms/step
testing model: results/CHTR/W10/deepOF_L1/h1000
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109208
{'0': {'precision': 0.3505579992002617, 'recall': 0.13417230152767343, 'f1-score': 0.1940673958322852, 'support': 143748}, '1': {'precision': 0.3059594685557814, 'recall': 0.7533207289110584, 'f1-score': 0.4351740180187717, 'support': 124295}, '2': {'precision': 0.3432311127816224, 'recall': 0.11229907840101853, 'f1-score': 0.16922934369668657, 'support': 138238}, 'accuracy': 0.31614818315402393, 'macro avg': {'precision': 0.33324952684588843, 'recall': 0.3332640362799168, 'f1-score': 0.26615691918258116, 'support': 406281}, 'weighted avg': {'precision': 0.33442082199730233, 'recall': 0.31614818315402393, 'f1-score': 0.2593788058011207, 'support': 406281}}
[[ 19287 108533  15928]
 [ 16884  93634  13777]
 [ 18847 103867  15524]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099724
{'0': {'precision': 0.3501307344901355, 'recall': 0.12497878839300866, 'f1-score': 0.1842055899456012, 'support': 23572}, '1': {'precision': 0.33829385513216614, 'recall': 0.794397420395002, 'f1-score': 0.4745154688816661, 'support': 24810}, '2': {'precision': 0.41229861583843885, 'recall': 0.13406625839297573, 'f1-score': 0.20233853006681515, 'support': 27106}, 'accuracy': 0.34825402713013986, 'macro avg': {'precision': 0.3669077351535801, 'recall': 0.35114748906032883, 'f1-score': 0.2870198629646942, 'support': 75488}, 'weighted avg': {'precision': 0.36856346041950033, 'recall': 0.34825402713013986, 'f1-score': 0.28613039350814623, 'support': 75488}}
[[ 2946 18034  2592]
 [ 2513 19709  2588]
 [ 2955 20517  3634]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028278
{'0': {'precision': 0.3171195652173913, 'recall': 0.11297192642787997, 'f1-score': 0.16659528907922913, 'support': 10330}, '1': {'precision': 0.3580894846139324, 'recall': 0.823335358972133, 'f1-score': 0.49910535733080735, 'support': 11519}, '2': {'precision': 0.3932267168391345, 'recall': 0.10899608865710561, 'f1-score': 0.17068191098407515, 'support': 11505}, 'accuracy': 0.3569287042033939, 'macro avg': {'precision': 0.3561452555568194, 'recall': 0.3484344580190395, 'f1-score': 0.2787941857980372, 'support': 33354}, 'weighted avg': {'precision': 0.3575208748335367, 'recall': 0.3569287042033939, 'f1-score': 0.28283921967841313, 'support': 33354}}
[[1167 8148 1015]
 [1115 9484  920]
 [1398 8853 1254]]
training model: results/CHTR/W10/deepLOB_L2/h10
Epoch 1/50
295/295 - 18s - loss: 3.3342 - accuracy10: 0.3573 - val_loss: 3.4444 - val_accuracy10: 0.3322 - 18s/epoch - 61ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3046 - accuracy10: 0.3654 - val_loss: 3.4588 - val_accuracy10: 0.3464 - 15s/epoch - 50ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2862 - accuracy10: 0.3750 - val_loss: 3.4145 - val_accuracy10: 0.3353 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2750 - accuracy10: 0.3824 - val_loss: 3.2953 - val_accuracy10: 0.3667 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2660 - accuracy10: 0.3865 - val_loss: 3.3202 - val_accuracy10: 0.3426 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2539 - accuracy10: 0.3948 - val_loss: 3.3294 - val_accuracy10: 0.3397 - 15s/epoch - 50ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2414 - accuracy10: 0.4014 - val_loss: 3.3391 - val_accuracy10: 0.3422 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2317 - accuracy10: 0.4067 - val_loss: 3.3673 - val_accuracy10: 0.3311 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2217 - accuracy10: 0.4131 - val_loss: 3.4026 - val_accuracy10: 0.3306 - 15s/epoch - 51ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2114 - accuracy10: 0.4212 - val_loss: 3.4371 - val_accuracy10: 0.3169 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2046 - accuracy10: 0.4229 - val_loss: 3.4615 - val_accuracy10: 0.3142 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.1968 - accuracy10: 0.4285 - val_loss: 3.4824 - val_accuracy10: 0.3051 - 15s/epoch - 52ms/step
Epoch 13/50
295/295 - 15s - loss: 3.1889 - accuracy10: 0.4304 - val_loss: 3.4681 - val_accuracy10: 0.3203 - 15s/epoch - 51ms/step
Epoch 14/50
295/295 - 15s - loss: 3.1738 - accuracy10: 0.4380 - val_loss: 3.4785 - val_accuracy10: 0.3162 - 15s/epoch - 51ms/step
testing model: results/CHTR/W10/deepLOB_L2/h10
Evaluating performance on  test set...
1588/1588 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1117401
{'0': {'precision': 0.3611476035089206, 'recall': 0.24322511594719942, 'f1-score': 0.290682106950686, 'support': 140150}, '1': {'precision': 0.31366138159664747, 'recall': 0.5441980426750634, 'f1-score': 0.39795310303331843, 'support': 126397}, '2': {'precision': 0.3780412738523342, 'recall': 0.2505170353301512, 'f1-score': 0.301342859602307, 'support': 139739}, 'accuracy': 0.33936684995298877, 'macro avg': {'precision': 0.35095008631930075, 'recall': 0.34598006465080466, 'f1-score': 0.32999268986210384, 'support': 406286}, 'weighted avg': {'precision': 0.35218492354720077, 'recall': 0.33936684995298877, 'f1-score': 0.32772117550495894, 'support': 406286}}
[[34088 76163 29899]
 [29917 68785 27695]
 [30383 74349 35007]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1024005
{'0': {'precision': 0.3931439764936337, 'recall': 0.23125672146259027, 'f1-score': 0.29121423907523397, 'support': 26036}, '1': {'precision': 0.3358928828526179, 'recall': 0.5626431930543833, 'f1-score': 0.42065722056105664, 'support': 24879}, '2': {'precision': 0.37722285281876655, 'recall': 0.28398779247202444, 'f1-score': 0.3240319435416473, 'support': 24575}, 'accuracy': 0.3576367730825275, 'macro avg': {'precision': 0.36875323738833937, 'recall': 0.359295902329666, 'f1-score': 0.345301134392646, 'support': 75490}, 'weighted avg': {'precision': 0.3690929555239067, 'recall': 0.3576367730825275, 'f1-score': 0.3445578213198742, 'support': 75490}}
[[ 6021 14517  5498]
 [ 4857 13998  6024]
 [ 4437 13159  6979]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0991102
{'0': {'precision': 0.3684670512148226, 'recall': 0.1864166961443226, 'f1-score': 0.24757766163603262, 'support': 11308}, '1': {'precision': 0.365551492659499, 'recall': 0.5814740862922129, 'f1-score': 0.44889752697540375, 'support': 11519}, '2': {'precision': 0.36809881847475834, 'recall': 0.3255438396504227, 'f1-score': 0.3455159550335232, 'support': 10527}, 'accuracy': 0.3667626071835462, 'macro avg': {'precision': 0.36737245411635994, 'recall': 0.3644782073623194, 'f1-score': 0.34733038121498655, 'support': 33354}, 'weighted avg': {'precision': 0.3673439264006046, 'recall': 0.3667626071835462, 'f1-score': 0.34801538854853487, 'support': 33354}}
[[2108 6157 3043]
 [1981 6698 2840]
 [1632 5468 3427]]
training model: results/CHTR/W10/deepLOB_L2/h20
Epoch 1/50
295/295 - 17s - loss: 3.3337 - accuracy20: 0.3586 - val_loss: 3.5449 - val_accuracy20: 0.3383 - 17s/epoch - 58ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3150 - accuracy20: 0.3602 - val_loss: 3.4402 - val_accuracy20: 0.3301 - 15s/epoch - 51ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2960 - accuracy20: 0.3690 - val_loss: 3.3642 - val_accuracy20: 0.3481 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2898 - accuracy20: 0.3705 - val_loss: 3.3636 - val_accuracy20: 0.3341 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2831 - accuracy20: 0.3734 - val_loss: 3.3274 - val_accuracy20: 0.3590 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2637 - accuracy20: 0.3872 - val_loss: 3.3349 - val_accuracy20: 0.3345 - 15s/epoch - 51ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2525 - accuracy20: 0.3974 - val_loss: 3.3252 - val_accuracy20: 0.3390 - 15s/epoch - 52ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2441 - accuracy20: 0.4039 - val_loss: 3.3293 - val_accuracy20: 0.3430 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2318 - accuracy20: 0.4085 - val_loss: 3.3617 - val_accuracy20: 0.3211 - 15s/epoch - 51ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2225 - accuracy20: 0.4147 - val_loss: 3.3796 - val_accuracy20: 0.3212 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2178 - accuracy20: 0.4177 - val_loss: 3.3545 - val_accuracy20: 0.3361 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2036 - accuracy20: 0.4253 - val_loss: 3.3666 - val_accuracy20: 0.3326 - 15s/epoch - 51ms/step
Epoch 13/50
295/295 - 15s - loss: 3.1995 - accuracy20: 0.4277 - val_loss: 3.3859 - val_accuracy20: 0.3280 - 15s/epoch - 51ms/step
Epoch 14/50
295/295 - 15s - loss: 3.1927 - accuracy20: 0.4298 - val_loss: 3.3715 - val_accuracy20: 0.3341 - 15s/epoch - 51ms/step
Epoch 15/50
295/295 - 15s - loss: 3.1818 - accuracy20: 0.4350 - val_loss: 3.3873 - val_accuracy20: 0.3314 - 15s/epoch - 51ms/step
Epoch 16/50
295/295 - 15s - loss: 3.1719 - accuracy20: 0.4384 - val_loss: 3.3653 - val_accuracy20: 0.3464 - 15s/epoch - 51ms/step
Epoch 17/50
295/295 - 15s - loss: 3.1633 - accuracy20: 0.4438 - val_loss: 3.3773 - val_accuracy20: 0.3365 - 15s/epoch - 52ms/step
testing model: results/CHTR/W10/deepLOB_L2/h20
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1226962
{'0': {'precision': 0.3528013892697194, 'recall': 0.27441668680951503, 'f1-score': 0.30871109120573276, 'support': 140662}, '1': {'precision': 0.297075772914882, 'recall': 0.48601345702114107, 'f1-score': 0.36875190686350034, 'support': 125585}, '2': {'precision': 0.3505797418507985, 'recall': 0.22886481622976457, 'f1-score': 0.2769388963056092, 'support': 140039}, 'accuracy': 0.3241214317008216, 'macro avg': {'precision': 0.33348563467846665, 'recall': 0.32976498668680687, 'f1-score': 0.3181339647916141, 'support': 406286}, 'weighted avg': {'precision': 0.33481056799401576, 'recall': 0.3241214317008216, 'f1-score': 0.31631873565511653, 'support': 406286}}
[[38600 72567 29495]
 [34674 61036 29875]
 [36136 71853 32050]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1098073
{'0': {'precision': 0.389738459339717, 'recall': 0.10414757103574702, 'f1-score': 0.1643711762755794, 'support': 26184}, '1': {'precision': 0.33638608952748383, 'recall': 0.7499598070739549, 'f1-score': 0.46444884192709307, 'support': 24880}, '2': {'precision': 0.3695485257985258, 'recall': 0.19704413330058135, 'f1-score': 0.2570360480640854, 'support': 24426}, 'accuracy': 0.34705258974698633, 'macro avg': {'precision': 0.36522435822190885, 'recall': 0.35038383713676113, 'f1-score': 0.2952853554222526, 'support': 75490}, 'weighted avg': {'precision': 0.36562180445025483, 'recall': 0.34705258974698633, 'f1-score': 0.29325400154668435, 'support': 75490}}
[[ 2727 19277  4180]
 [ 2190 18659  4031]
 [ 2080 17533  4813]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.109185
{'0': {'precision': 0.3215789473684211, 'recall': 0.16093064091308165, 'f1-score': 0.21451141018139266, 'support': 11390}, '1': {'precision': 0.33683676059913686, 'recall': 0.5852668725187472, 'f1-score': 0.42758620689655175, 'support': 11335}, '2': {'precision': 0.36424173891192363, 'recall': 0.27274437858688494, 'f1-score': 0.31192166989455566, 'support': 10629}, 'accuracy': 0.3407687233914973, 'macro avg': {'precision': 0.34088581562649384, 'recall': 0.3396472973395713, 'f1-score': 0.31800642899083337, 'support': 33354}, 'weighted avg': {'precision': 0.34035960708797647, 'recall': 0.3407687233914973, 'f1-score': 0.31796456336414547, 'support': 33354}}
[[1833 6903 2654]
 [2295 6634 2406]
 [1572 6158 2899]]
training model: results/CHTR/W10/deepLOB_L2/h30
Epoch 1/50
295/295 - 17s - loss: 3.3411 - accuracy30: 0.3549 - val_loss: 3.4001 - val_accuracy30: 0.3327 - 17s/epoch - 58ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3125 - accuracy30: 0.3571 - val_loss: 3.4210 - val_accuracy30: 0.3412 - 15s/epoch - 51ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2952 - accuracy30: 0.3694 - val_loss: 3.3695 - val_accuracy30: 0.3462 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2885 - accuracy30: 0.3714 - val_loss: 3.3258 - val_accuracy30: 0.3577 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2833 - accuracy30: 0.3769 - val_loss: 3.3460 - val_accuracy30: 0.3428 - 15s/epoch - 52ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2709 - accuracy30: 0.3857 - val_loss: 3.3580 - val_accuracy30: 0.3386 - 15s/epoch - 52ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2662 - accuracy30: 0.3912 - val_loss: 3.3491 - val_accuracy30: 0.3455 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2548 - accuracy30: 0.3952 - val_loss: 3.3134 - val_accuracy30: 0.3605 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2468 - accuracy30: 0.4011 - val_loss: 3.3036 - val_accuracy30: 0.3599 - 15s/epoch - 50ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2356 - accuracy30: 0.4077 - val_loss: 3.3123 - val_accuracy30: 0.3600 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2256 - accuracy30: 0.4153 - val_loss: 3.3231 - val_accuracy30: 0.3559 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2191 - accuracy30: 0.4187 - val_loss: 3.3486 - val_accuracy30: 0.3540 - 15s/epoch - 51ms/step
Epoch 13/50
295/295 - 15s - loss: 3.2134 - accuracy30: 0.4215 - val_loss: 3.3385 - val_accuracy30: 0.3529 - 15s/epoch - 51ms/step
Epoch 14/50
295/295 - 15s - loss: 3.2046 - accuracy30: 0.4261 - val_loss: 3.3460 - val_accuracy30: 0.3508 - 15s/epoch - 51ms/step
Epoch 15/50
295/295 - 15s - loss: 3.1980 - accuracy30: 0.4290 - val_loss: 3.3953 - val_accuracy30: 0.3540 - 15s/epoch - 51ms/step
Epoch 16/50
295/295 - 15s - loss: 3.1861 - accuracy30: 0.4350 - val_loss: 3.3947 - val_accuracy30: 0.3547 - 15s/epoch - 51ms/step
Epoch 17/50
295/295 - 15s - loss: 3.1772 - accuracy30: 0.4384 - val_loss: 3.3813 - val_accuracy30: 0.3590 - 15s/epoch - 51ms/step
Epoch 18/50
295/295 - 15s - loss: 3.1680 - accuracy30: 0.4422 - val_loss: 3.4025 - val_accuracy30: 0.3574 - 15s/epoch - 51ms/step
Epoch 19/50
295/295 - 15s - loss: 3.1582 - accuracy30: 0.4441 - val_loss: 3.4115 - val_accuracy30: 0.3594 - 15s/epoch - 51ms/step
testing model: results/CHTR/W10/deepLOB_L2/h30
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1206927
{'0': {'precision': 0.34822732498524067, 'recall': 0.3166244058171647, 'f1-score': 0.331674762220093, 'support': 141581}, '1': {'precision': 0.28206583988309175, 'recall': 0.4620691328469987, 'f1-score': 0.3502964457170185, 'support': 123646}, '2': {'precision': 0.3684701741286899, 'recall': 0.1959180201192409, 'f1-score': 0.2558166443735797, 'support': 141059}, 'accuracy': 0.31897973348823244, 'macro avg': {'precision': 0.33292111299900745, 'recall': 0.32487051959446805, 'f1-score': 0.31259595077023045, 'support': 406286}, 'weighted avg': {'precision': 0.33512038325056487, 'recall': 0.31897973348823244, 'f1-score': 0.3110046589734872, 'support': 406286}}
[[44828 73394 23359]
 [42506 57133 24007]
 [41398 72025 27636]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1045974
{'0': {'precision': 0.37703327171903883, 'recall': 0.3107006854531607, 'f1-score': 0.34066805845511483, 'support': 26260}, '1': {'precision': 0.34642103411888847, 'recall': 0.6334365076174779, 'f1-score': 0.44789312868613657, 'support': 24877}, '2': {'precision': 0.38184644821812963, 'recall': 0.13111320987147373, 'f1-score': 0.19520097814458195, 'support': 24353}, 'accuracy': 0.3591204132997748, 'macro avg': {'precision': 0.3684335846853523, 'recall': 0.3584168009807041, 'f1-score': 0.3279207217619445, 'support': 75490}, 'weighted avg': {'precision': 0.3684980306606658, 'recall': 0.3591204132997748, 'f1-score': 0.32907550666460905, 'support': 75490}}
[[ 8159 15565  2536]
 [ 6486 15758  2633]
 [ 6995 14165  3193]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1009868
{'0': {'precision': 0.37403986387943605, 'recall': 0.3388531665639038, 'f1-score': 0.3555781495517146, 'support': 11353}, '1': {'precision': 0.3528752102672731, 'recall': 0.49837219533655963, 'f1-score': 0.4131893784651299, 'support': 11365}, '2': {'precision': 0.33699059561128525, 'recall': 0.2223580293343362, 'f1-score': 0.26792794834031947, 'support': 10636}, 'accuracy': 0.3560592432691731, 'macro avg': {'precision': 0.35463522325266483, 'recall': 0.3531944637449332, 'f1-score': 0.3455651587857213, 'support': 33354}, 'weighted avg': {'precision': 0.35501389081466767, 'recall': 0.3560592432691731, 'f1-score': 0.34725843007328816, 'support': 33354}}
[[3847 5370 2136]
 [3184 5664 2517]
 [3254 5017 2365]]
training model: results/CHTR/W10/deepLOB_L2/h50
Epoch 1/50
295/295 - 18s - loss: 3.3329 - accuracy50: 0.3560 - val_loss: 3.4789 - val_accuracy50: 0.3311 - 18s/epoch - 61ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3146 - accuracy50: 0.3592 - val_loss: 3.4098 - val_accuracy50: 0.3095 - 15s/epoch - 52ms/step
Epoch 3/50
295/295 - 15s - loss: 3.3004 - accuracy50: 0.3651 - val_loss: 3.3905 - val_accuracy50: 0.3368 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2927 - accuracy50: 0.3700 - val_loss: 3.3767 - val_accuracy50: 0.3305 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2876 - accuracy50: 0.3746 - val_loss: 3.3819 - val_accuracy50: 0.3154 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2791 - accuracy50: 0.3799 - val_loss: 3.4066 - val_accuracy50: 0.3175 - 15s/epoch - 51ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2706 - accuracy50: 0.3861 - val_loss: 3.3752 - val_accuracy50: 0.3431 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2706 - accuracy50: 0.3875 - val_loss: 3.3700 - val_accuracy50: 0.3278 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2635 - accuracy50: 0.3918 - val_loss: 3.3922 - val_accuracy50: 0.3147 - 15s/epoch - 51ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2596 - accuracy50: 0.3959 - val_loss: 3.3923 - val_accuracy50: 0.3189 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2539 - accuracy50: 0.3992 - val_loss: 3.4002 - val_accuracy50: 0.3185 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2491 - accuracy50: 0.4022 - val_loss: 3.4307 - val_accuracy50: 0.3167 - 15s/epoch - 52ms/step
Epoch 13/50
295/295 - 15s - loss: 3.2371 - accuracy50: 0.4061 - val_loss: 3.4272 - val_accuracy50: 0.3112 - 15s/epoch - 51ms/step
Epoch 14/50
295/295 - 15s - loss: 3.2301 - accuracy50: 0.4135 - val_loss: 3.4077 - val_accuracy50: 0.3258 - 15s/epoch - 51ms/step
Epoch 15/50
295/295 - 15s - loss: 3.2206 - accuracy50: 0.4184 - val_loss: 3.4439 - val_accuracy50: 0.3141 - 15s/epoch - 51ms/step
Epoch 16/50
295/295 - 15s - loss: 3.2127 - accuracy50: 0.4219 - val_loss: 3.3927 - val_accuracy50: 0.3348 - 15s/epoch - 51ms/step
Epoch 17/50
295/295 - 15s - loss: 3.2073 - accuracy50: 0.4248 - val_loss: 3.3942 - val_accuracy50: 0.3335 - 15s/epoch - 51ms/step
Epoch 18/50
295/295 - 15s - loss: 3.1966 - accuracy50: 0.4292 - val_loss: 3.3968 - val_accuracy50: 0.3335 - 15s/epoch - 51ms/step
testing model: results/CHTR/W10/deepLOB_L2/h50
Evaluating performance on  test set...
1588/1588 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1296144
{'0': {'precision': 0.3616568968964755, 'recall': 0.2380193795496575, 'f1-score': 0.28709273182957395, 'support': 144379}, '1': {'precision': 0.2855869596301416, 'recall': 0.4997622920055048, 'f1-score': 0.3634703750322258, 'support': 119895}, '2': {'precision': 0.36283081168991177, 'recall': 0.2592104892544292, 'f1-score': 0.3023900569687062, 'support': 142012}, 'accuracy': 0.3226667913735644, 'macro avg': {'precision': 0.3366915560721763, 'recall': 0.3323307202698638, 'f1-score': 0.3176510546101687, 'support': 406286}, 'weighted avg': {'precision': 0.33961898483230973, 'recall': 0.3226667913735644, 'f1-score': 0.3149787561312737, 'support': 406286}}
[[34365 75706 34308]
 [29640 59919 30336]
 [31016 74185 36811]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1264517
{'0': {'precision': 0.3849015656487366, 'recall': 0.09442859859288838, 'f1-score': 0.1516521101813962, 'support': 26295}, '1': {'precision': 0.3316800893070728, 'recall': 0.8397803440200274, 'f1-score': 0.4755404648397755, 'support': 24766}, '2': {'precision': 0.3822229239027471, 'recall': 0.09910352449957019, 'f1-score': 0.1573968728667555, 'support': 24429}, 'accuracy': 0.3404689362829514, 'macro avg': {'precision': 0.3662681929528522, 'recall': 0.3444374890374953, 'f1-score': 0.2615298159626424, 'support': 75490}, 'weighted avg': {'precision': 0.3665743749971215, 'recall': 0.3404689362829514, 'f1-score': 0.2597691826295359, 'support': 75490}}
[[ 2483 21908  1904]
 [ 1959 20798  2009]
 [ 2009 19999  2421]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1235944
{'0': {'precision': 0.3413312693498452, 'recall': 0.15686971987550022, 'f1-score': 0.2149515627855968, 'support': 11245}, '1': {'precision': 0.32545968882602544, 'recall': 0.5982320825028166, 'f1-score': 0.42157012427860396, 'support': 11539}, '2': {'precision': 0.3251146788990826, 'recall': 0.21456953642384105, 'f1-score': 0.25852046050381855, 'support': 10570}, 'accuracy': 0.32784673502428496, 'macro avg': {'precision': 0.3306352123583178, 'recall': 0.3232237796007193, 'f1-score': 0.29834738252267307, 'support': 33354}, 'weighted avg': {'precision': 0.33070131406025727, 'recall': 0.32784673502428496, 'f1-score': 0.3002395291449364, 'support': 33354}}
[[1764 7440 2041]
 [1969 6903 2667]
 [1435 6867 2268]]
training model: results/CHTR/W10/deepLOB_L2/h100
Epoch 1/50
295/295 - 17s - loss: 3.3444 - accuracy100: 0.3546 - val_loss: 3.3937 - val_accuracy100: 0.3512 - 17s/epoch - 58ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3119 - accuracy100: 0.3575 - val_loss: 3.3600 - val_accuracy100: 0.3455 - 15s/epoch - 51ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2979 - accuracy100: 0.3647 - val_loss: 3.3520 - val_accuracy100: 0.3338 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2981 - accuracy100: 0.3639 - val_loss: 3.3704 - val_accuracy100: 0.3104 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2919 - accuracy100: 0.3662 - val_loss: 3.4017 - val_accuracy100: 0.3036 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2904 - accuracy100: 0.3645 - val_loss: 3.3674 - val_accuracy100: 0.3031 - 15s/epoch - 50ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2791 - accuracy100: 0.3743 - val_loss: 3.3361 - val_accuracy100: 0.3314 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2758 - accuracy100: 0.3796 - val_loss: 3.3410 - val_accuracy100: 0.3215 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2752 - accuracy100: 0.3777 - val_loss: 3.3603 - val_accuracy100: 0.3388 - 15s/epoch - 52ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2685 - accuracy100: 0.3807 - val_loss: 3.3450 - val_accuracy100: 0.3162 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2630 - accuracy100: 0.3896 - val_loss: 3.3543 - val_accuracy100: 0.3233 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2543 - accuracy100: 0.3943 - val_loss: 3.3682 - val_accuracy100: 0.3220 - 15s/epoch - 51ms/step
Epoch 13/50
295/295 - 15s - loss: 3.2485 - accuracy100: 0.3964 - val_loss: 3.3851 - val_accuracy100: 0.3169 - 15s/epoch - 51ms/step
Epoch 14/50
295/295 - 15s - loss: 3.2406 - accuracy100: 0.4022 - val_loss: 3.3955 - val_accuracy100: 0.3125 - 15s/epoch - 51ms/step
Epoch 15/50
295/295 - 15s - loss: 3.2325 - accuracy100: 0.4057 - val_loss: 3.4335 - val_accuracy100: 0.3092 - 15s/epoch - 50ms/step
Epoch 16/50
295/295 - 15s - loss: 3.2199 - accuracy100: 0.4132 - val_loss: 3.4293 - val_accuracy100: 0.3167 - 15s/epoch - 50ms/step
Epoch 17/50
295/295 - 15s - loss: 3.2135 - accuracy100: 0.4149 - val_loss: 3.4390 - val_accuracy100: 0.3133 - 15s/epoch - 50ms/step
testing model: results/CHTR/W10/deepLOB_L2/h100
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1277463
{'0': {'precision': 0.3645293315143247, 'recall': 0.10004833581820285, 'f1-score': 0.1570051921967479, 'support': 146889}, '1': {'precision': 0.2635757527000664, 'recall': 0.45656131060731425, 'f1-score': 0.33420996426533545, 'support': 114817}, '2': {'precision': 0.34738190284103493, 'recall': 0.40145939964033756, 'f1-score': 0.37246805083630935, 'support': 144580}, 'accuracy': 0.3080588550922257, 'macro avg': {'precision': 0.32516232901847536, 'recall': 0.31935634868861823, 'f1-score': 0.28789440243279757, 'support': 406286}, 'weighted avg': {'precision': 0.3298976624528731, 'recall': 0.3080588550922257, 'f1-score': 0.2837576286988839, 'support': 406286}}
[[14696 73552 58641]
 [11993 52421 50403]
 [13626 72911 58043]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1133739
{'0': {'precision': 0.3667785652119856, 'recall': 0.11462988148435982, 'f1-score': 0.17466990348747705, 'support': 25735}, '1': {'precision': 0.34046942579489314, 'recall': 0.7567067530064755, 'f1-score': 0.46963380844212577, 'support': 24863}, '2': {'precision': 0.35904168034131934, 'recall': 0.1757994536397236, 'f1-score': 0.2360302049622438, 'support': 24892}, 'accuracy': 0.3462710292754007, 'macro avg': {'precision': 0.3554298904493994, 'recall': 0.3490453627101863, 'f1-score': 0.29344463896394885, 'support': 75490}, 'weighted avg': {'precision': 0.35556236874188635, 'recall': 0.3462710292754007, 'f1-score': 0.2920505922303214, 'support': 75490}}
[[ 2950 18579  4206]
 [ 2443 18814  3606]
 [ 2650 17866  4376]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111747
{'0': {'precision': 0.333810888252149, 'recall': 0.1065191551613788, 'f1-score': 0.1615027379219519, 'support': 10937}, '1': {'precision': 0.34307286549102756, 'recall': 0.5669116390360622, 'f1-score': 0.4274622249428139, 'support': 11702}, '2': {'precision': 0.3179443336183148, 'recall': 0.3123658422771815, 'f1-score': 0.3151304020337068, 'support': 10715}, 'accuracy': 0.3341728128560293, 'macro avg': {'precision': 0.3316093624538305, 'recall': 0.32859887882487415, 'f1-score': 0.3013651216328242, 'support': 33354}, 'weighted avg': {'precision': 0.33196323953678725, 'recall': 0.3341728128560293, 'f1-score': 0.3041656370667496, 'support': 33354}}
[[1165 6392 3380]
 [1268 6634 3800]
 [1057 6311 3347]]
training model: results/CHTR/W10/deepLOB_L2/h200
Epoch 1/50
295/295 - 17s - loss: 3.3297 - accuracy200: 0.3599 - val_loss: 3.4731 - val_accuracy200: 0.3526 - 17s/epoch - 59ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3135 - accuracy200: 0.3596 - val_loss: 3.4608 - val_accuracy200: 0.3538 - 15s/epoch - 52ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2978 - accuracy200: 0.3634 - val_loss: 3.3996 - val_accuracy200: 0.3562 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2939 - accuracy200: 0.3671 - val_loss: 3.3298 - val_accuracy200: 0.3493 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2934 - accuracy200: 0.3676 - val_loss: 3.3958 - val_accuracy200: 0.3506 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2779 - accuracy200: 0.3755 - val_loss: 3.4157 - val_accuracy200: 0.3544 - 15s/epoch - 50ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2772 - accuracy200: 0.3738 - val_loss: 3.3711 - val_accuracy200: 0.3169 - 15s/epoch - 50ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2764 - accuracy200: 0.3759 - val_loss: 3.3706 - val_accuracy200: 0.3182 - 15s/epoch - 50ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2708 - accuracy200: 0.3808 - val_loss: 3.3942 - val_accuracy200: 0.3231 - 15s/epoch - 51ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2563 - accuracy200: 0.3913 - val_loss: 3.3922 - val_accuracy200: 0.3180 - 15s/epoch - 50ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2534 - accuracy200: 0.3923 - val_loss: 3.4098 - val_accuracy200: 0.3222 - 15s/epoch - 50ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2384 - accuracy200: 0.4007 - val_loss: 3.4051 - val_accuracy200: 0.3337 - 15s/epoch - 50ms/step
Epoch 13/50
295/295 - 15s - loss: 3.2225 - accuracy200: 0.4120 - val_loss: 3.3743 - val_accuracy200: 0.3293 - 15s/epoch - 50ms/step
Epoch 14/50
295/295 - 15s - loss: 3.2125 - accuracy200: 0.4163 - val_loss: 3.3952 - val_accuracy200: 0.3285 - 15s/epoch - 50ms/step
testing model: results/CHTR/W10/deepLOB_L2/h200
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1420139
{'0': {'precision': 0.36234926693849223, 'recall': 0.14317839023721377, 'f1-score': 0.20525320032433228, 'support': 145860}, '1': {'precision': 0.2804295866253997, 'recall': 0.7600514076312544, 'f1-score': 0.40969686756913626, 'support': 115158}, '2': {'precision': 0.3364260886224923, 'recall': 0.08461602004570862, 'f1-score': 0.1352218035807596, 'support': 145268}, 'accuracy': 0.2970862889688545, 'macro avg': {'precision': 0.3264016473954614, 'recall': 0.32928193930472566, 'f1-score': 0.2500572904914094, 'support': 406286}, 'weighted avg': {'precision': 0.32986103250978, 'recall': 0.2970862889688545, 'f1-score': 0.2381610605273218, 'support': 406286}}
[[ 20884 111606  13370]
 [ 16757  87526  10875]
 [ 19994 112982  12292]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1169306
{'0': {'precision': 0.3507853403141361, 'recall': 0.10270684577836944, 'f1-score': 0.15889162792149034, 'support': 24789}, '1': {'precision': 0.33753917993987076, 'recall': 0.84549751642365, 'f1-score': 0.4824677699551979, 'support': 24964}, '2': {'precision': 0.3566666666666667, 'recall': 0.07899133543147997, 'f1-score': 0.12933804116168848, 'support': 25737}, 'accuracy': 0.34025698768048745, 'macro avg': {'precision': 0.34833039564022455, 'recall': 0.3423985658778332, 'f1-score': 0.2568991463461256, 'support': 75490}, 'weighted avg': {'precision': 0.3484100660890986, 'recall': 0.34025698768048745, 'f1-score': 0.25582015020646126, 'support': 75490}}
[[ 2546 20335  1908]
 [ 2098 21107  1759]
 [ 2614 21090  2033]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102943
{'0': {'precision': 0.3294816771211621, 'recall': 0.09547498325839472, 'f1-score': 0.14804925085298917, 'support': 10453}, '1': {'precision': 0.35555802085644556, 'recall': 0.8021858835307859, 'f1-score': 0.4927231731064876, 'support': 11986}, '2': {'precision': 0.31769722814498935, 'recall': 0.09555657352267521, 'f1-score': 0.1469221017044654, 'support': 10915}, 'accuracy': 0.3494633327337051, 'macro avg': {'precision': 0.33424564204086565, 'recall': 0.33107248010395196, 'f1-score': 0.26256484188798074, 'support': 33354}, 'weighted avg': {'precision': 0.33499597212134746, 'recall': 0.3494633327337051, 'f1-score': 0.27154144966495464, 'support': 33354}}
[[ 998 8500  955]
 [1086 9615 1285]
 [ 945 8927 1043]]
training model: results/CHTR/W10/deepLOB_L2/h300
Epoch 1/50
295/295 - 17s - loss: 3.3300 - accuracy300: 0.3604 - val_loss: 3.4765 - val_accuracy300: 0.3615 - 17s/epoch - 59ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3044 - accuracy300: 0.3677 - val_loss: 3.6543 - val_accuracy300: 0.3608 - 15s/epoch - 51ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2926 - accuracy300: 0.3691 - val_loss: 3.5088 - val_accuracy300: 0.3561 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2843 - accuracy300: 0.3725 - val_loss: 3.4916 - val_accuracy300: 0.3594 - 15s/epoch - 50ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2725 - accuracy300: 0.3817 - val_loss: 3.5331 - val_accuracy300: 0.3613 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2726 - accuracy300: 0.3768 - val_loss: 3.3639 - val_accuracy300: 0.3238 - 15s/epoch - 51ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2596 - accuracy300: 0.3873 - val_loss: 3.4353 - val_accuracy300: 0.3535 - 15s/epoch - 50ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2538 - accuracy300: 0.3936 - val_loss: 3.4228 - val_accuracy300: 0.3552 - 15s/epoch - 50ms/step
Epoch 9/50
295/295 - 15s - loss: 3.2427 - accuracy300: 0.4015 - val_loss: 3.4787 - val_accuracy300: 0.3500 - 15s/epoch - 50ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2279 - accuracy300: 0.4087 - val_loss: 3.4526 - val_accuracy300: 0.3483 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.2260 - accuracy300: 0.4099 - val_loss: 3.4297 - val_accuracy300: 0.3469 - 15s/epoch - 50ms/step
Epoch 12/50
295/295 - 15s - loss: 3.2184 - accuracy300: 0.4121 - val_loss: 3.5136 - val_accuracy300: 0.3186 - 15s/epoch - 50ms/step
Epoch 13/50
295/295 - 15s - loss: 3.1927 - accuracy300: 0.4250 - val_loss: 3.4635 - val_accuracy300: 0.3218 - 15s/epoch - 50ms/step
Epoch 14/50
295/295 - 15s - loss: 3.1825 - accuracy300: 0.4313 - val_loss: 3.4640 - val_accuracy300: 0.3112 - 15s/epoch - 50ms/step
Epoch 15/50
295/295 - 15s - loss: 3.1612 - accuracy300: 0.4421 - val_loss: 3.4337 - val_accuracy300: 0.3196 - 15s/epoch - 50ms/step
Epoch 16/50
295/295 - 15s - loss: 3.1538 - accuracy300: 0.4441 - val_loss: 3.4850 - val_accuracy300: 0.3138 - 15s/epoch - 50ms/step
testing model: results/CHTR/W10/deepLOB_L2/h300
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1441187
{'0': {'precision': 0.34877792772529614, 'recall': 0.09547525551739708, 'f1-score': 0.14991299117021503, 'support': 146174}, '1': {'precision': 0.2777174717521093, 'recall': 0.675817767028594, 'f1-score': 0.3936643219695456, 'support': 116598}, '2': {'precision': 0.3435311507984588, 'recall': 0.1975626071324052, 'f1-score': 0.250858224801812, 'support': 143514}, 'accuracy': 0.29808558503123417, 'macro avg': {'precision': 0.3233421834252881, 'recall': 0.32295187655946545, 'f1-score': 0.2648118459805242, 'support': 406286}, 'weighted avg': {'precision': 0.3265313009908289, 'recall': 0.29808558503123417, 'f1-score': 0.25552325568325596, 'support': 406286}}
[[ 13956 103676  28542]
 [ 12160  78799  25639]
 [ 13898 101263  28353]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1352224
{'0': {'precision': 0.31671554252199413, 'recall': 0.02680565897244974, 'f1-score': 0.04942791762013729, 'support': 24174}, '1': {'precision': 0.3338100864374106, 'recall': 0.8617409800537785, 'f1-score': 0.48121379186696706, 'support': 24917}, '2': {'precision': 0.35285087719298247, 'recall': 0.12189855676351377, 'f1-score': 0.18119879501112082, 'support': 26399}, 'accuracy': 0.3356471055768976, 'macro avg': {'precision': 0.3344588353841291, 'recall': 0.33681506526324734, 'f1-score': 0.23728016816607503, 'support': 75490}, 'weighted avg': {'precision': 0.3349945390873651, 'recall': 0.3356471055768976, 'f1-score': 0.23802810335139749, 'support': 75490}}
[[  648 20410  3116]
 [  659 21472  2786]
 [  739 22442  3218]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209633
{'0': {'precision': 0.30414746543778803, 'recall': 0.04553967471660917, 'f1-score': 0.07921810699588477, 'support': 10145}, '1': {'precision': 0.33714678416946275, 'recall': 0.6921736243671675, 'f1-score': 0.4534333713912902, 'support': 12049}, '2': {'precision': 0.2779656241194703, 'recall': 0.1767921146953405, 'f1-score': 0.21612443860225655, 'support': 11160}, 'accuracy': 0.32304970918030823, 'macro avg': {'precision': 0.306419957908907, 'recall': 0.30483513792637235, 'f1-score': 0.24959197232981048, 'support': 33354}, 'weighted avg': {'precision': 0.30730808911967095, 'recall': 0.32304970918030823, 'f1-score': 0.26020972363638817, 'support': 33354}}
[[ 462 7633 2050]
 [ 634 8340 3075]
 [ 423 8764 1973]]
training model: results/CHTR/W10/deepLOB_L2/h500
Epoch 1/50
295/295 - 17s - loss: 3.3258 - accuracy500: 0.3652 - val_loss: 3.4599 - val_accuracy500: 0.3530 - 17s/epoch - 59ms/step
Epoch 2/50
295/295 - 15s - loss: 3.2990 - accuracy500: 0.3709 - val_loss: 3.4732 - val_accuracy500: 0.3620 - 15s/epoch - 51ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2876 - accuracy500: 0.3778 - val_loss: 3.3855 - val_accuracy500: 0.3318 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2707 - accuracy500: 0.3870 - val_loss: 3.3162 - val_accuracy500: 0.3606 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2571 - accuracy500: 0.3932 - val_loss: 3.3452 - val_accuracy500: 0.3563 - 15s/epoch - 50ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2412 - accuracy500: 0.3996 - val_loss: 3.4200 - val_accuracy500: 0.3416 - 15s/epoch - 51ms/step
Epoch 7/50
295/295 - 15s - loss: 3.2384 - accuracy500: 0.4025 - val_loss: 3.3521 - val_accuracy500: 0.3623 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.2328 - accuracy500: 0.4077 - val_loss: 3.5450 - val_accuracy500: 0.3612 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 16s - loss: 3.2176 - accuracy500: 0.4143 - val_loss: 3.5175 - val_accuracy500: 0.3608 - 16s/epoch - 54ms/step
Epoch 10/50
295/295 - 15s - loss: 3.2095 - accuracy500: 0.4162 - val_loss: 3.5377 - val_accuracy500: 0.3601 - 15s/epoch - 52ms/step
Epoch 11/50
295/295 - 15s - loss: 3.1975 - accuracy500: 0.4210 - val_loss: 3.4785 - val_accuracy500: 0.3588 - 15s/epoch - 50ms/step
Epoch 12/50
295/295 - 15s - loss: 3.1841 - accuracy500: 0.4305 - val_loss: 3.5325 - val_accuracy500: 0.3596 - 15s/epoch - 51ms/step
Epoch 13/50
295/295 - 15s - loss: 3.1695 - accuracy500: 0.4383 - val_loss: 3.5884 - val_accuracy500: 0.3606 - 15s/epoch - 50ms/step
Epoch 14/50
295/295 - 15s - loss: 3.1583 - accuracy500: 0.4418 - val_loss: 3.4771 - val_accuracy500: 0.3617 - 15s/epoch - 51ms/step
testing model: results/CHTR/W10/deepLOB_L2/h500
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1308819
{'0': {'precision': 0.32324667173202076, 'recall': 0.06857234961036049, 'f1-score': 0.11314296946816446, 'support': 142696}, '1': {'precision': 0.29918199802908946, 'recall': 0.6577909912845158, 'f1-score': 0.41129525128852856, 'support': 122770}, '2': {'precision': 0.34972523070252337, 'recall': 0.2634710978554183, 'f1-score': 0.3005317748644238, 'support': 140820}, 'accuracy': 0.31417277484333694, 'macro avg': {'precision': 0.32405130015454453, 'recall': 0.32994481291676486, 'f1-score': 0.27498999854037226, 'support': 406286}, 'weighted avg': {'precision': 0.32515244914920305, 'recall': 0.31417277484333694, 'f1-score': 0.2681870694740405, 'support': 406286}}
[[ 9785 95324 37587]
 [10613 80757 31400]
 [ 9873 93845 37102]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1256652
{'0': {'precision': 0.3257173942608459, 'recall': 0.10054575986565911, 'f1-score': 0.15365861482693355, 'support': 23820}, '1': {'precision': 0.3345072902725928, 'recall': 0.7644265593561368, 'f1-score': 0.4653715181655601, 'support': 24850}, '2': {'precision': 0.368402502423121, 'recall': 0.1558911260253542, 'f1-score': 0.21907830962299252, 'support': 26820}, 'accuracy': 0.3387468538879322, 'macro avg': {'precision': 0.34287572898551993, 'recall': 0.34028781508238337, 'f1-score': 0.2793694808718287, 'support': 75490}, 'weighted avg': {'precision': 0.34377599164863404, 'recall': 0.3387468538879322, 'f1-score': 0.27951133521897453, 'support': 75490}}
[[ 2395 17941  3484]
 [ 2170 18996  3684]
 [ 2788 19851  4181]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071346
{'0': {'precision': 0.30844845908607865, 'recall': 0.11462138414453549, 'f1-score': 0.16713452817965882, 'support': 10129}, '1': {'precision': 0.3717412690605017, 'recall': 0.7530515652246118, 'f1-score': 0.4977633853837921, 'support': 12043}, '2': {'precision': 0.35772044666923375, 'recall': 0.16615989983902701, 'f1-score': 0.22691744015632634, 'support': 11182}, 'accuracy': 0.3624153025124423, 'macro avg': {'precision': 0.345970058271938, 'recall': 0.3446109497360581, 'f1-score': 0.2972717845732591, 'support': 33354}, 'weighted avg': {'precision': 0.3478198890697933, 'recall': 0.3624153025124423, 'f1-score': 0.3065557624853635, 'support': 33354}}
[[1161 7358 1610]
 [1248 9069 1726]
 [1355 7969 1858]]
training model: results/CHTR/W10/deepLOB_L2/h1000
Epoch 1/50
295/295 - 17s - loss: 3.3240 - accuracy1000: 0.3694 - val_loss: 3.4456 - val_accuracy1000: 0.3311 - 17s/epoch - 59ms/step
Epoch 2/50
295/295 - 15s - loss: 3.3159 - accuracy1000: 0.3727 - val_loss: 3.4610 - val_accuracy1000: 0.3482 - 15s/epoch - 52ms/step
Epoch 3/50
295/295 - 15s - loss: 3.2894 - accuracy1000: 0.3831 - val_loss: 3.3843 - val_accuracy1000: 0.3643 - 15s/epoch - 51ms/step
Epoch 4/50
295/295 - 15s - loss: 3.2606 - accuracy1000: 0.4010 - val_loss: 3.4203 - val_accuracy1000: 0.3528 - 15s/epoch - 51ms/step
Epoch 5/50
295/295 - 15s - loss: 3.2503 - accuracy1000: 0.4061 - val_loss: 3.4294 - val_accuracy1000: 0.3599 - 15s/epoch - 51ms/step
Epoch 6/50
295/295 - 15s - loss: 3.2136 - accuracy1000: 0.4247 - val_loss: 3.4332 - val_accuracy1000: 0.3639 - 15s/epoch - 51ms/step
Epoch 7/50
295/295 - 15s - loss: 3.1896 - accuracy1000: 0.4328 - val_loss: 3.4595 - val_accuracy1000: 0.3483 - 15s/epoch - 51ms/step
Epoch 8/50
295/295 - 15s - loss: 3.1846 - accuracy1000: 0.4370 - val_loss: 3.4258 - val_accuracy1000: 0.3540 - 15s/epoch - 51ms/step
Epoch 9/50
295/295 - 15s - loss: 3.1598 - accuracy1000: 0.4456 - val_loss: 3.4393 - val_accuracy1000: 0.3412 - 15s/epoch - 51ms/step
Epoch 10/50
295/295 - 15s - loss: 3.1363 - accuracy1000: 0.4582 - val_loss: 3.4582 - val_accuracy1000: 0.3446 - 15s/epoch - 51ms/step
Epoch 11/50
295/295 - 15s - loss: 3.1244 - accuracy1000: 0.4627 - val_loss: 3.4646 - val_accuracy1000: 0.3540 - 15s/epoch - 51ms/step
Epoch 12/50
295/295 - 15s - loss: 3.1073 - accuracy1000: 0.4677 - val_loss: 3.4915 - val_accuracy1000: 0.3547 - 15s/epoch - 51ms/step
Epoch 13/50
295/295 - 15s - loss: 3.0946 - accuracy1000: 0.4714 - val_loss: 3.5007 - val_accuracy1000: 0.3587 - 15s/epoch - 51ms/step
testing model: results/CHTR/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
1588/1588 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1633903
{'0': {'precision': 0.3568425267794574, 'recall': 0.04959338847574592, 'f1-score': 0.08708398736921827, 'support': 143749}, '1': {'precision': 0.3079825643556213, 'recall': 0.7532000482722555, 'f1-score': 0.43719616130011435, 'support': 124295}, '2': {'precision': 0.3655277956590917, 'recall': 0.2176979499717886, 'f1-score': 0.2728777059956931, 'support': 138242}, 'accuracy': 0.32204653864519084, 'macro avg': {'precision': 0.3434509622647235, 'recall': 0.3401637955732633, 'f1-score': 0.2657192848883419, 'support': 406286}, 'weighted avg': {'precision': 0.34485003851007995, 'recall': 0.32204653864519084, 'f1-score': 0.2574115101219143, 'support': 406286}}
[[  7129 108884  27736]
 [  6174  93619  24502]
 [  6675 101472  30095]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317724
{'0': {'precision': 0.3107569721115538, 'recall': 0.07280132366043018, 'f1-score': 0.11796652115629189, 'support': 23571}, '1': {'precision': 0.3371247630356436, 'recall': 0.6524877026046286, 'f1-score': 0.4445573793008722, 'support': 24802}, '2': {'precision': 0.38565900295925337, 'recall': 0.3123870634657226, 'f1-score': 0.3451774581312905, 'support': 27117}, 'accuracy': 0.3493177904358193, 'macro avg': {'precision': 0.34451357936881694, 'recall': 0.3458920299102605, 'f1-score': 0.30256711952948484, 'support': 75490}, 'weighted avg': {'precision': 0.34632581991916206, 'recall': 0.3493177904358193, 'f1-score': 0.3068840657536282, 'support': 75490}}
[[ 1716 15158  6697]
 [ 1822 16183  6797]
 [ 1984 16662  8471]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182393
{'0': {'precision': 0.31921487603305787, 'recall': 0.029895510835913314, 'f1-score': 0.05467091295116773, 'support': 10336}, '1': {'precision': 0.3613138686131387, 'recall': 0.6272348550598854, 'f1-score': 0.45850780357822607, 'support': 11522}, '2': {'precision': 0.36773255813953487, 'recall': 0.39613778705636743, 'f1-score': 0.38140703517587937, 'support': 11496}, 'accuracy': 0.362475265335492, 'macro avg': {'precision': 0.34942043426191044, 'recall': 0.35108938431738873, 'f1-score': 0.2981952505684244, 'support': 33354}, 'weighted avg': {'precision': 0.35048020750765607, 'recall': 0.362475265335492, 'f1-score': 0.3067896128042663, 'support': 33354}}
[[ 309 6182 3845]
 [ 310 7227 3985]
 [ 349 6593 4554]]
training model: results/CHTR/W10/deepOF_L2/h10
Epoch 1/50
295/295 - 12s - loss: 3.3337 - accuracy10: 0.3509 - val_loss: 3.2611 - val_accuracy10: 0.3877 - 12s/epoch - 40ms/step
Epoch 2/50
295/295 - 10s - loss: 3.2859 - accuracy10: 0.3763 - val_loss: 3.2442 - val_accuracy10: 0.3994 - 10s/epoch - 33ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2625 - accuracy10: 0.3905 - val_loss: 3.2247 - val_accuracy10: 0.4111 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 10s - loss: 3.2435 - accuracy10: 0.3994 - val_loss: 3.2157 - val_accuracy10: 0.4110 - 10s/epoch - 32ms/step
Epoch 5/50
295/295 - 10s - loss: 3.2274 - accuracy10: 0.4070 - val_loss: 3.2001 - val_accuracy10: 0.4178 - 10s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2135 - accuracy10: 0.4133 - val_loss: 3.1925 - val_accuracy10: 0.4208 - 10s/epoch - 34ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2007 - accuracy10: 0.4178 - val_loss: 3.1913 - val_accuracy10: 0.4220 - 10s/epoch - 33ms/step
Epoch 8/50
295/295 - 10s - loss: 3.1908 - accuracy10: 0.4238 - val_loss: 3.1860 - val_accuracy10: 0.4235 - 10s/epoch - 33ms/step
Epoch 9/50
295/295 - 10s - loss: 3.1795 - accuracy10: 0.4295 - val_loss: 3.1850 - val_accuracy10: 0.4271 - 10s/epoch - 33ms/step
Epoch 10/50
295/295 - 10s - loss: 3.1700 - accuracy10: 0.4331 - val_loss: 3.1811 - val_accuracy10: 0.4286 - 10s/epoch - 33ms/step
Epoch 11/50
295/295 - 10s - loss: 3.1566 - accuracy10: 0.4403 - val_loss: 3.1817 - val_accuracy10: 0.4263 - 10s/epoch - 33ms/step
Epoch 12/50
295/295 - 10s - loss: 3.1454 - accuracy10: 0.4447 - val_loss: 3.1778 - val_accuracy10: 0.4288 - 10s/epoch - 33ms/step
Epoch 13/50
295/295 - 10s - loss: 3.1355 - accuracy10: 0.4487 - val_loss: 3.1852 - val_accuracy10: 0.4321 - 10s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 3.1281 - accuracy10: 0.4538 - val_loss: 3.1808 - val_accuracy10: 0.4293 - 9s/epoch - 32ms/step
Epoch 15/50
295/295 - 9s - loss: 3.1154 - accuracy10: 0.4567 - val_loss: 3.1820 - val_accuracy10: 0.4292 - 9s/epoch - 31ms/step
Epoch 16/50
295/295 - 10s - loss: 3.1047 - accuracy10: 0.4606 - val_loss: 3.1863 - val_accuracy10: 0.4297 - 10s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 3.0928 - accuracy10: 0.4676 - val_loss: 3.1896 - val_accuracy10: 0.4287 - 9s/epoch - 32ms/step
Epoch 18/50
295/295 - 9s - loss: 3.0796 - accuracy10: 0.4735 - val_loss: 3.1940 - val_accuracy10: 0.4293 - 9s/epoch - 32ms/step
Epoch 19/50
295/295 - 9s - loss: 3.0679 - accuracy10: 0.4753 - val_loss: 3.2016 - val_accuracy10: 0.4289 - 9s/epoch - 32ms/step
Epoch 20/50
295/295 - 10s - loss: 3.0593 - accuracy10: 0.4796 - val_loss: 3.2037 - val_accuracy10: 0.4293 - 10s/epoch - 32ms/step
Epoch 21/50
295/295 - 9s - loss: 3.0420 - accuracy10: 0.4852 - val_loss: 3.2138 - val_accuracy10: 0.4290 - 9s/epoch - 32ms/step
Epoch 22/50
295/295 - 10s - loss: 3.0353 - accuracy10: 0.4877 - val_loss: 3.2237 - val_accuracy10: 0.4291 - 10s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h10
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887319
{'0': {'precision': 0.40983962102619714, 'recall': 0.25618266143417767, 'f1-score': 0.3152861627626178, 'support': 140150}, '1': {'precision': 0.3715413097694322, 'recall': 0.42314508600091777, 'f1-score': 0.39566772581498316, 'support': 126394}, '2': {'precision': 0.4112129207277639, 'recall': 0.5141802099658644, 'f1-score': 0.4569680472168516, 'support': 139737}, 'accuracy': 0.3968607933917658, 'macro avg': {'precision': 0.3975312838411311, 'recall': 0.3978359858003199, 'f1-score': 0.3893073119314842, 'support': 406281}, 'weighted avg': {'precision': 0.3983973533036364, 'recall': 0.3968607933917658, 'f1-score': 0.38902317918332646, 'support': 406281}}
[[35904 50315 53931]
 [23965 53483 48946]
 [27736 40151 71850]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0540352
{'0': {'precision': 0.4644082332761578, 'recall': 0.25055911159096167, 'f1-score': 0.32550217903120776, 'support': 25934}, '1': {'precision': 0.4093104222821204, 'recall': 0.5854853608578657, 'f1-score': 0.4817979013467735, 'support': 24899}, '2': {'precision': 0.4564142194744977, 'recall': 0.4790914621780572, 'f1-score': 0.46747798555456616, 'support': 24655}, 'accuracy': 0.43567189487070795, 'macro avg': {'precision': 0.4433776250109253, 'recall': 0.43837864487562817, 'f1-score': 0.4249260219775158, 'support': 75488}, 'weighted avg': {'precision': 0.44362383302419095, 'recall': 0.43567189487070795, 'f1-score': 0.4234253019086011, 'support': 75488}}
[[ 6498 12075  7361]
 [ 3614 14578  6707]
 [ 3880  8963 11812]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0605521
{'0': {'precision': 0.442830913036221, 'recall': 0.23376508943519253, 'f1-score': 0.30599769319492504, 'support': 11349}, '1': {'precision': 0.4347062880070215, 'recall': 0.6049027305242956, 'f1-score': 0.5058729116509814, 'support': 11463}, '2': {'precision': 0.4087802313354364, 'recall': 0.4425156516789983, 'f1-score': 0.4249795025963378, 'support': 10542}, 'accuracy': 0.42729507705222763, 'macro avg': {'precision': 0.42877247745955965, 'recall': 0.42706115721282883, 'f1-score': 0.41228336914741476, 'support': 33354}, 'weighted avg': {'precision': 0.4292764708943674, 'recall': 0.42729507705222763, 'f1-score': 0.4122960641210948, 'support': 33354}}
[[2653 5030 3666]
 [1448 6934 3081]
 [1890 3987 4665]]
training model: results/CHTR/W10/deepOF_L2/h20
Epoch 1/50
295/295 - 12s - loss: 3.3361 - accuracy20: 0.3507 - val_loss: 3.2964 - val_accuracy20: 0.3738 - 12s/epoch - 41ms/step
Epoch 2/50
295/295 - 9s - loss: 3.2912 - accuracy20: 0.3745 - val_loss: 3.2693 - val_accuracy20: 0.3918 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2702 - accuracy20: 0.3857 - val_loss: 3.2563 - val_accuracy20: 0.3980 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2546 - accuracy20: 0.3921 - val_loss: 3.2505 - val_accuracy20: 0.4056 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2407 - accuracy20: 0.3984 - val_loss: 3.2416 - val_accuracy20: 0.4124 - 9s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2310 - accuracy20: 0.4046 - val_loss: 3.2361 - val_accuracy20: 0.4092 - 10s/epoch - 33ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2234 - accuracy20: 0.4085 - val_loss: 3.2332 - val_accuracy20: 0.4151 - 10s/epoch - 32ms/step
Epoch 8/50
295/295 - 10s - loss: 3.2128 - accuracy20: 0.4130 - val_loss: 3.2314 - val_accuracy20: 0.4176 - 10s/epoch - 32ms/step
Epoch 9/50
295/295 - 10s - loss: 3.2016 - accuracy20: 0.4186 - val_loss: 3.2258 - val_accuracy20: 0.4172 - 10s/epoch - 32ms/step
Epoch 10/50
295/295 - 10s - loss: 3.1946 - accuracy20: 0.4241 - val_loss: 3.2307 - val_accuracy20: 0.4172 - 10s/epoch - 32ms/step
Epoch 11/50
295/295 - 9s - loss: 3.1842 - accuracy20: 0.4287 - val_loss: 3.2358 - val_accuracy20: 0.4156 - 9s/epoch - 32ms/step
Epoch 12/50
295/295 - 9s - loss: 3.1764 - accuracy20: 0.4350 - val_loss: 3.2399 - val_accuracy20: 0.4153 - 9s/epoch - 32ms/step
Epoch 13/50
295/295 - 9s - loss: 3.1668 - accuracy20: 0.4369 - val_loss: 3.2412 - val_accuracy20: 0.4172 - 9s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 3.1566 - accuracy20: 0.4401 - val_loss: 3.2347 - val_accuracy20: 0.4215 - 9s/epoch - 32ms/step
Epoch 15/50
295/295 - 9s - loss: 3.1478 - accuracy20: 0.4467 - val_loss: 3.2422 - val_accuracy20: 0.4184 - 9s/epoch - 32ms/step
Epoch 16/50
295/295 - 9s - loss: 3.1386 - accuracy20: 0.4495 - val_loss: 3.2404 - val_accuracy20: 0.4218 - 9s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 3.1266 - accuracy20: 0.4563 - val_loss: 3.2433 - val_accuracy20: 0.4193 - 9s/epoch - 32ms/step
Epoch 18/50
295/295 - 9s - loss: 3.1154 - accuracy20: 0.4595 - val_loss: 3.2558 - val_accuracy20: 0.4195 - 9s/epoch - 32ms/step
Epoch 19/50
295/295 - 9s - loss: 3.1031 - accuracy20: 0.4636 - val_loss: 3.2489 - val_accuracy20: 0.4235 - 9s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h20
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0973763
{'0': {'precision': 0.41039450256772464, 'recall': 0.19827812968768885, 'f1-score': 0.26737609049947275, 'support': 140661}, '1': {'precision': 0.34899099883855983, 'recall': 0.3828304786475876, 'f1-score': 0.36512836870545257, 'support': 125583}, '2': {'precision': 0.4007090076883956, 'recall': 0.5738983268707556, 'f1-score': 0.4719156544793144, 'support': 140037}, 'accuracy': 0.38479279119624105, 'macro avg': {'precision': 0.38669816969822673, 'recall': 0.385002311735344, 'f1-score': 0.3681400378947466, 'support': 406281}, 'weighted avg': {'precision': 0.3880760484553338, 'recall': 0.38479279119624105, 'f1-score': 0.36809242051487256, 'support': 406281}}
[[27890 50474 62297]
 [19608 48077 57898]
 [20461 39209 80367]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0722405
{'0': {'precision': 0.4551218708827404, 'recall': 0.2119898741945382, 'f1-score': 0.28925057567510987, 'support': 26072}, '1': {'precision': 0.3898973954222573, 'recall': 0.5153472695903383, 'f1-score': 0.4439298366888448, 'support': 24923}, '2': {'precision': 0.41658443523452404, 'recall': 0.5170865145143511, 'f1-score': 0.46142635941342564, 'support': 24493}, 'accuracy': 0.4111381941500636, 'macro avg': {'precision': 0.4205345671798406, 'recall': 0.41480788609974245, 'f1-score': 0.3982022572591268, 'support': 75488}, 'weighted avg': {'precision': 0.4210835202411367, 'recall': 0.4111381941500636, 'f1-score': 0.3961837662927959, 'support': 75488}}
[[ 5527 11466  9079]
 [ 3421 12844  8658]
 [ 3196  8632 12665]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0772033
{'0': {'precision': 0.4474662492662884, 'recall': 0.20079016681299386, 'f1-score': 0.27719532149566695, 'support': 11390}, '1': {'precision': 0.42336109618484685, 'recall': 0.5558691242613987, 'f1-score': 0.4806497121287223, 'support': 11339}, '2': {'precision': 0.40614002246349684, 'recall': 0.5104941176470589, 'f1-score': 0.4523769808173478, 'support': 10625}, 'accuracy': 0.4201595011093122, 'macro avg': {'precision': 0.42565578930487735, 'recall': 0.4223844695738171, 'f1-score': 0.40340733814724566, 'support': 33354}, 'weighted avg': {'precision': 0.4261069073411782, 'recall': 0.4201595011093122, 'f1-score': 0.40216607359979456, 'support': 33354}}
[[2287 4819 4284]
 [1389 6303 3647]
 [1435 3766 5424]]
training model: results/CHTR/W10/deepOF_L2/h30
Epoch 1/50
295/295 - 11s - loss: 3.3366 - accuracy30: 0.3512 - val_loss: 3.2989 - val_accuracy30: 0.3711 - 11s/epoch - 39ms/step
Epoch 2/50
295/295 - 10s - loss: 3.2952 - accuracy30: 0.3720 - val_loss: 3.2757 - val_accuracy30: 0.3857 - 10s/epoch - 33ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2731 - accuracy30: 0.3852 - val_loss: 3.2656 - val_accuracy30: 0.3920 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 10s - loss: 3.2562 - accuracy30: 0.3940 - val_loss: 3.2545 - val_accuracy30: 0.4007 - 10s/epoch - 32ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2451 - accuracy30: 0.3965 - val_loss: 3.2558 - val_accuracy30: 0.4029 - 9s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2349 - accuracy30: 0.4033 - val_loss: 3.2477 - val_accuracy30: 0.4051 - 10s/epoch - 32ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2248 - accuracy30: 0.4079 - val_loss: 3.2514 - val_accuracy30: 0.4092 - 9s/epoch - 32ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2171 - accuracy30: 0.4113 - val_loss: 3.2485 - val_accuracy30: 0.4080 - 9s/epoch - 32ms/step
Epoch 9/50
295/295 - 10s - loss: 3.2089 - accuracy30: 0.4159 - val_loss: 3.2501 - val_accuracy30: 0.4117 - 10s/epoch - 32ms/step
Epoch 10/50
295/295 - 10s - loss: 3.2018 - accuracy30: 0.4186 - val_loss: 3.2488 - val_accuracy30: 0.4104 - 10s/epoch - 33ms/step
Epoch 11/50
295/295 - 10s - loss: 3.1928 - accuracy30: 0.4239 - val_loss: 3.2457 - val_accuracy30: 0.4134 - 10s/epoch - 33ms/step
Epoch 12/50
295/295 - 10s - loss: 3.1849 - accuracy30: 0.4285 - val_loss: 3.2550 - val_accuracy30: 0.4130 - 10s/epoch - 32ms/step
Epoch 13/50
295/295 - 10s - loss: 3.1753 - accuracy30: 0.4324 - val_loss: 3.2543 - val_accuracy30: 0.4139 - 10s/epoch - 33ms/step
Epoch 14/50
295/295 - 10s - loss: 3.1670 - accuracy30: 0.4375 - val_loss: 3.2528 - val_accuracy30: 0.4181 - 10s/epoch - 33ms/step
Epoch 15/50
295/295 - 10s - loss: 3.1575 - accuracy30: 0.4411 - val_loss: 3.2615 - val_accuracy30: 0.4129 - 10s/epoch - 33ms/step
Epoch 16/50
295/295 - 10s - loss: 3.1479 - accuracy30: 0.4466 - val_loss: 3.2613 - val_accuracy30: 0.4141 - 10s/epoch - 33ms/step
Epoch 17/50
295/295 - 10s - loss: 3.1373 - accuracy30: 0.4501 - val_loss: 3.2693 - val_accuracy30: 0.4161 - 10s/epoch - 33ms/step
Epoch 18/50
295/295 - 10s - loss: 3.1274 - accuracy30: 0.4521 - val_loss: 3.2687 - val_accuracy30: 0.4152 - 10s/epoch - 32ms/step
Epoch 19/50
295/295 - 10s - loss: 3.1161 - accuracy30: 0.4591 - val_loss: 3.2728 - val_accuracy30: 0.4106 - 10s/epoch - 32ms/step
Epoch 20/50
295/295 - 9s - loss: 3.1098 - accuracy30: 0.4597 - val_loss: 3.2827 - val_accuracy30: 0.4128 - 9s/epoch - 32ms/step
Epoch 21/50
295/295 - 10s - loss: 3.0980 - accuracy30: 0.4646 - val_loss: 3.2860 - val_accuracy30: 0.4128 - 10s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h30
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1010083
{'0': {'precision': 0.40450621441253903, 'recall': 0.23332721185494923, 'f1-score': 0.2959465694333081, 'support': 141578}, '1': {'precision': 0.33723316327984726, 'recall': 0.3827894375025274, 'f1-score': 0.35857011360149704, 'support': 123645}, '2': {'precision': 0.40378144875941563, 'recall': 0.5274709693884785, 'f1-score': 0.45741194985952555, 'support': 141058}, 'accuracy': 0.3809383160915721, 'macro avg': {'precision': 0.381840275483934, 'recall': 0.38119587291531837, 'f1-score': 0.3706428776314436, 'support': 406281}, 'weighted avg': {'precision': 0.38378112414053533, 'recall': 0.3809383160915721, 'f1-score': 0.3710647062667734, 'support': 406281}}
[[33034 51787 56757]
 [23208 47330 53107]
 [25423 41231 74404]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0695484
{'0': {'precision': 0.4566767205922676, 'recall': 0.2548682045984927, 'f1-score': 0.32715397647752104, 'support': 26139}, '1': {'precision': 0.39276307913324554, 'recall': 0.525803349627374, 'f1-score': 0.4496487921877677, 'support': 24958}, '2': {'precision': 0.42851426076833526, 'recall': 0.48292402935509, 'f1-score': 0.4540951059195435, 'support': 24391}, 'accuracy': 0.4181326833403985, 'macro avg': {'precision': 0.4259846868312828, 'recall': 0.4211985278603189, 'f1-score': 0.41029929152827743, 'support': 75488}, 'weighted avg': {'precision': 0.4264458597786309, 'recall': 0.4181326833403985, 'f1-score': 0.40866953787425575, 'support': 75488}}
[[ 6662 11504  7973]
 [ 4099 13123  7736]
 [ 3827  8785 11779]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0834439
{'0': {'precision': 0.42105263157894735, 'recall': 0.23440387153541575, 'f1-score': 0.30115306353153964, 'support': 11365}, '1': {'precision': 0.41747771047437554, 'recall': 0.5387317758650975, 'f1-score': 0.4704168104605238, 'support': 11386}, '2': {'precision': 0.403356575320253, 'recall': 0.4692068282561539, 'f1-score': 0.43379692200374936, 'support': 10603}, 'accuracy': 0.41293398093182226, 'macro avg': {'precision': 0.4139623057911919, 'recall': 0.4141141585522224, 'f1-score': 0.40178893199860427, 'support': 33354}, 'weighted avg': {'precision': 0.41420681589844155, 'recall': 0.41293398093182226, 'f1-score': 0.4011008914956295, 'support': 33354}}
[[2664 4768 3933]
 [1826 6134 3426]
 [1837 3791 4975]]
training model: results/CHTR/W10/deepOF_L2/h50
Epoch 1/50
295/295 - 11s - loss: 3.3357 - accuracy50: 0.3529 - val_loss: 3.3149 - val_accuracy50: 0.3643 - 11s/epoch - 39ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3008 - accuracy50: 0.3702 - val_loss: 3.2867 - val_accuracy50: 0.3805 - 9s/epoch - 32ms/step
Epoch 3/50
295/295 - 10s - loss: 3.2813 - accuracy50: 0.3820 - val_loss: 3.2830 - val_accuracy50: 0.3863 - 10s/epoch - 32ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2678 - accuracy50: 0.3877 - val_loss: 3.2796 - val_accuracy50: 0.3901 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2591 - accuracy50: 0.3913 - val_loss: 3.2755 - val_accuracy50: 0.3935 - 9s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2504 - accuracy50: 0.3950 - val_loss: 3.2716 - val_accuracy50: 0.3984 - 10s/epoch - 33ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2432 - accuracy50: 0.3985 - val_loss: 3.2685 - val_accuracy50: 0.4006 - 9s/epoch - 32ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2331 - accuracy50: 0.4022 - val_loss: 3.2660 - val_accuracy50: 0.4014 - 9s/epoch - 32ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2287 - accuracy50: 0.4071 - val_loss: 3.2651 - val_accuracy50: 0.4040 - 9s/epoch - 32ms/step
Epoch 10/50
295/295 - 10s - loss: 3.2202 - accuracy50: 0.4109 - val_loss: 3.2624 - val_accuracy50: 0.4044 - 10s/epoch - 32ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2143 - accuracy50: 0.4148 - val_loss: 3.2607 - val_accuracy50: 0.4048 - 9s/epoch - 32ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2072 - accuracy50: 0.4185 - val_loss: 3.2657 - val_accuracy50: 0.4024 - 9s/epoch - 32ms/step
Epoch 13/50
295/295 - 9s - loss: 3.1987 - accuracy50: 0.4234 - val_loss: 3.2697 - val_accuracy50: 0.4046 - 9s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 3.1894 - accuracy50: 0.4280 - val_loss: 3.2750 - val_accuracy50: 0.4027 - 9s/epoch - 32ms/step
Epoch 15/50
295/295 - 9s - loss: 3.1839 - accuracy50: 0.4298 - val_loss: 3.2709 - val_accuracy50: 0.4042 - 9s/epoch - 32ms/step
Epoch 16/50
295/295 - 9s - loss: 3.1773 - accuracy50: 0.4338 - val_loss: 3.2758 - val_accuracy50: 0.4041 - 9s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 3.1654 - accuracy50: 0.4391 - val_loss: 3.2856 - val_accuracy50: 0.4021 - 9s/epoch - 32ms/step
Epoch 18/50
295/295 - 9s - loss: 3.1542 - accuracy50: 0.4434 - val_loss: 3.2873 - val_accuracy50: 0.4043 - 9s/epoch - 32ms/step
Epoch 19/50
295/295 - 9s - loss: 3.1447 - accuracy50: 0.4459 - val_loss: 3.2978 - val_accuracy50: 0.4011 - 9s/epoch - 32ms/step
Epoch 20/50
295/295 - 9s - loss: 3.1377 - accuracy50: 0.4513 - val_loss: 3.2990 - val_accuracy50: 0.4036 - 9s/epoch - 32ms/step
Epoch 21/50
295/295 - 9s - loss: 3.1231 - accuracy50: 0.4574 - val_loss: 3.3139 - val_accuracy50: 0.4016 - 9s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h50
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10454
{'0': {'precision': 0.41972646195372393, 'recall': 0.20894312884837823, 'f1-score': 0.27899857573571574, 'support': 144379}, '1': {'precision': 0.3111458883785212, 'recall': 0.3830633726458372, 'f1-score': 0.34337943925233644, 'support': 119894}, '2': {'precision': 0.39993683151143994, 'recall': 0.5260900794321447, 'f1-score': 0.45442048599495155, 'support': 142008}, 'accuracy': 0.3711790607978222, 'macro avg': {'precision': 0.3769363939478951, 'recall': 0.3726988603087867, 'f1-score': 0.3589328336610012, 'support': 406281}, 'weighted avg': {'precision': 0.3807671083829854, 'recall': 0.3711790607978222, 'f1-score': 0.35931292438247814, 'support': 406281}}
[[30167 56480 57732]
 [19606 45927 54361]
 [22100 45199 74709]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771651
{'0': {'precision': 0.4545523233849641, 'recall': 0.22953071346814194, 'f1-score': 0.3050323234884016, 'support': 26210}, '1': {'precision': 0.3747041730325634, 'recall': 0.5026725073343247, 'f1-score': 0.4293560346011259, 'support': 24883}, '2': {'precision': 0.41299528955389303, 'recall': 0.4887886862061898, 'f1-score': 0.4477068353764995, 'support': 24395}, 'accuracy': 0.4033488766426452, 'macro avg': {'precision': 0.4140839286571402, 'recall': 0.4069973023362188, 'f1-score': 0.39403173115534235, 'support': 75488}, 'weighted avg': {'precision': 0.41480235828418294, 'recall': 0.4033488766426452, 'f1-score': 0.392120226481302, 'support': 75488}}
[[ 6016 11790  8404]
 [ 3831 12508  8544]
 [ 3388  9083 11924]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0893776
{'0': {'precision': 0.4154339689894849, 'recall': 0.20740279384286858, 'f1-score': 0.2766765578635015, 'support': 11239}, '1': {'precision': 0.4050641193404868, 'recall': 0.5362959112959113, 'f1-score': 0.4615327270016401, 'support': 11544}, '2': {'precision': 0.38871498515129627, 'recall': 0.45814019487276514, 'f1-score': 0.4205818497611811, 'support': 10571}, 'accuracy': 0.4007015650296816, 'macro avg': {'precision': 0.40307102449375604, 'recall': 0.40061296667051494, 'f1-score': 0.38626371154210754, 'support': 33354}, 'weighted avg': {'precision': 0.4033767667798091, 'recall': 0.4007015650296816, 'f1-score': 0.386264686938906, 'support': 33354}}
[[2331 4953 3955]
 [1692 6191 3661]
 [1588 4140 4843]]
training model: results/CHTR/W10/deepOF_L2/h100
Epoch 1/50
295/295 - 12s - loss: 3.3425 - accuracy100: 0.3453 - val_loss: 3.3124 - val_accuracy100: 0.3625 - 12s/epoch - 40ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3112 - accuracy100: 0.3579 - val_loss: 3.2945 - val_accuracy100: 0.3700 - 9s/epoch - 32ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2969 - accuracy100: 0.3676 - val_loss: 3.2865 - val_accuracy100: 0.3773 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2865 - accuracy100: 0.3736 - val_loss: 3.2815 - val_accuracy100: 0.3786 - 9s/epoch - 31ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2781 - accuracy100: 0.3790 - val_loss: 3.2735 - val_accuracy100: 0.3851 - 9s/epoch - 32ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2706 - accuracy100: 0.3832 - val_loss: 3.2726 - val_accuracy100: 0.3868 - 9s/epoch - 32ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2645 - accuracy100: 0.3865 - val_loss: 3.2710 - val_accuracy100: 0.3893 - 10s/epoch - 32ms/step
Epoch 8/50
295/295 - 10s - loss: 3.2576 - accuracy100: 0.3905 - val_loss: 3.2733 - val_accuracy100: 0.3899 - 10s/epoch - 32ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2511 - accuracy100: 0.3958 - val_loss: 3.2726 - val_accuracy100: 0.3871 - 9s/epoch - 32ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2460 - accuracy100: 0.3990 - val_loss: 3.2730 - val_accuracy100: 0.3895 - 9s/epoch - 32ms/step
Epoch 11/50
295/295 - 10s - loss: 3.2403 - accuracy100: 0.4013 - val_loss: 3.2792 - val_accuracy100: 0.3896 - 10s/epoch - 32ms/step
Epoch 12/50
295/295 - 10s - loss: 3.2352 - accuracy100: 0.4058 - val_loss: 3.2861 - val_accuracy100: 0.3830 - 10s/epoch - 33ms/step
Epoch 13/50
295/295 - 10s - loss: 3.2267 - accuracy100: 0.4085 - val_loss: 3.2873 - val_accuracy100: 0.3869 - 10s/epoch - 33ms/step
Epoch 14/50
295/295 - 10s - loss: 3.2204 - accuracy100: 0.4141 - val_loss: 3.2846 - val_accuracy100: 0.3892 - 10s/epoch - 32ms/step
Epoch 15/50
295/295 - 10s - loss: 3.2136 - accuracy100: 0.4181 - val_loss: 3.2930 - val_accuracy100: 0.3831 - 10s/epoch - 33ms/step
Epoch 16/50
295/295 - 10s - loss: 3.2075 - accuracy100: 0.4214 - val_loss: 3.2928 - val_accuracy100: 0.3864 - 10s/epoch - 32ms/step
Epoch 17/50
295/295 - 10s - loss: 3.1987 - accuracy100: 0.4236 - val_loss: 3.2974 - val_accuracy100: 0.3871 - 10s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h100
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078588
{'0': {'precision': 0.4206706549118388, 'recall': 0.18191411143183922, 'f1-score': 0.25399224364092615, 'support': 146888}, '1': {'precision': 0.28528717303977186, 'recall': 0.48617788461538464, 'f1-score': 0.3595764005642839, 'support': 114816}, '2': {'precision': 0.39084265270743396, 'recall': 0.3976496953180658, 'f1-score': 0.39421679146438465, 'support': 144577}, 'accuracy': 0.34467031438831747, 'macro avg': {'precision': 0.3656001602196815, 'recall': 0.3552472304550965, 'f1-score': 0.3359284785565316, 'support': 406281}, 'weighted avg': {'precision': 0.3717965187121901, 'recall': 0.34467031438831747, 'f1-score': 0.3337301467473584, 'support': 406281}}
[[26721 72385 47782]
 [17173 55821 41822]
 [19626 67460 57491]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0914989
{'0': {'precision': 0.42615748563703953, 'recall': 0.19605861546235473, 'f1-score': 0.26856214892314245, 'support': 25727}, '1': {'precision': 0.349005467571644, 'recall': 0.5959116333346747, 'f1-score': 0.44020034778473016, 'support': 24851}, '2': {'precision': 0.3959943449575872, 'recall': 0.3373344038538739, 'f1-score': 0.36431823108606115, 'support': 24910}, 'accuracy': 0.37431114879186095, 'macro avg': {'precision': 0.3903857660554236, 'recall': 0.3764348842169678, 'f1-score': 0.3576935759313113, 'support': 75488}, 'weighted avg': {'precision': 0.39080526229997536, 'recall': 0.37431114879186095, 'f1-score': 0.35666442857802294, 'support': 75488}}
[[ 5044 14460  6223]
 [ 3448 14809  6594]
 [ 3344 13163  8403]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912353
{'0': {'precision': 0.402924102343582, 'recall': 0.17136064374542795, 'f1-score': 0.24045679091550654, 'support': 10936}, '1': {'precision': 0.38600333750521487, 'recall': 0.6332449311318333, 'f1-score': 0.47963712943463466, 'support': 11689}, '2': {'precision': 0.38375144326650573, 'recall': 0.34075869139714793, 'f1-score': 0.3609794628751975, 'support': 10729}, 'accuracy': 0.38771961383941955, 'macro avg': {'precision': 0.3908929610384342, 'recall': 0.3817880887581364, 'f1-score': 0.36035779440844623, 'support': 33354}, 'weighted avg': {'precision': 0.3908268942296039, 'recall': 0.38771961383941955, 'f1-score': 0.3630467868501954, 'support': 33354}}
[[1874 6103 2959]
 [1375 7402 2912]
 [1402 5671 3656]]
training model: results/CHTR/W10/deepOF_L2/h200
Epoch 1/50
295/295 - 12s - loss: 3.3417 - accuracy200: 0.3442 - val_loss: 3.3062 - val_accuracy200: 0.3720 - 12s/epoch - 41ms/step
Epoch 2/50
295/295 - 10s - loss: 3.3183 - accuracy200: 0.3516 - val_loss: 3.3018 - val_accuracy200: 0.3709 - 10s/epoch - 32ms/step
Epoch 3/50
295/295 - 10s - loss: 3.3037 - accuracy200: 0.3574 - val_loss: 3.2996 - val_accuracy200: 0.3729 - 10s/epoch - 34ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2952 - accuracy200: 0.3630 - val_loss: 3.2927 - val_accuracy200: 0.3742 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 10s - loss: 3.2879 - accuracy200: 0.3659 - val_loss: 3.2837 - val_accuracy200: 0.3774 - 10s/epoch - 32ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2812 - accuracy200: 0.3723 - val_loss: 3.2850 - val_accuracy200: 0.3786 - 9s/epoch - 32ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2757 - accuracy200: 0.3744 - val_loss: 3.2843 - val_accuracy200: 0.3814 - 9s/epoch - 32ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2691 - accuracy200: 0.3796 - val_loss: 3.2781 - val_accuracy200: 0.3838 - 9s/epoch - 32ms/step
Epoch 9/50
295/295 - 10s - loss: 3.2648 - accuracy200: 0.3812 - val_loss: 3.2820 - val_accuracy200: 0.3791 - 10s/epoch - 32ms/step
Epoch 10/50
295/295 - 10s - loss: 3.2584 - accuracy200: 0.3870 - val_loss: 3.2798 - val_accuracy200: 0.3809 - 10s/epoch - 32ms/step
Epoch 11/50
295/295 - 10s - loss: 3.2530 - accuracy200: 0.3897 - val_loss: 3.2779 - val_accuracy200: 0.3806 - 10s/epoch - 32ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2473 - accuracy200: 0.3947 - val_loss: 3.2851 - val_accuracy200: 0.3809 - 9s/epoch - 32ms/step
Epoch 13/50
295/295 - 10s - loss: 3.2431 - accuracy200: 0.3978 - val_loss: 3.2835 - val_accuracy200: 0.3801 - 10s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2353 - accuracy200: 0.4015 - val_loss: 3.2798 - val_accuracy200: 0.3842 - 9s/epoch - 32ms/step
Epoch 15/50
295/295 - 10s - loss: 3.2278 - accuracy200: 0.4062 - val_loss: 3.2881 - val_accuracy200: 0.3824 - 10s/epoch - 32ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2210 - accuracy200: 0.4100 - val_loss: 3.2856 - val_accuracy200: 0.3859 - 9s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2145 - accuracy200: 0.4139 - val_loss: 3.2998 - val_accuracy200: 0.3827 - 9s/epoch - 32ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2080 - accuracy200: 0.4174 - val_loss: 3.3062 - val_accuracy200: 0.3768 - 9s/epoch - 32ms/step
Epoch 19/50
295/295 - 9s - loss: 3.1987 - accuracy200: 0.4202 - val_loss: 3.3081 - val_accuracy200: 0.3851 - 9s/epoch - 32ms/step
Epoch 20/50
295/295 - 9s - loss: 3.1904 - accuracy200: 0.4277 - val_loss: 3.3004 - val_accuracy200: 0.3827 - 9s/epoch - 32ms/step
Epoch 21/50
295/295 - 9s - loss: 3.1853 - accuracy200: 0.4288 - val_loss: 3.3114 - val_accuracy200: 0.3846 - 9s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h200
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1178576
{'0': {'precision': 0.4022839580571291, 'recall': 0.18306720874268986, 'f1-score': 0.25162673451598466, 'support': 145859}, '1': {'precision': 0.28827527999238733, 'recall': 0.6050556626547874, 'f1-score': 0.390499382112363, 'support': 115158}, '2': {'precision': 0.379890429930144, 'recall': 0.25681517788302677, 'f1-score': 0.30645757518503614, 'support': 145264}, 'accuracy': 0.3290456605157514, 'macro avg': {'precision': 0.35681655599322015, 'recall': 0.34831268309350133, 'f1-score': 0.3161945639377946, 'support': 406281}, 'weighted avg': {'precision': 0.36196214921443676, 'recall': 0.3290456605157514, 'f1-score': 0.3105939113981249, 'support': 406281}}
[[26702 86100 33057]
 [17642 69677 27839]
 [22032 85926 37306]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0899287
{'0': {'precision': 0.4334844725810591, 'recall': 0.20437220183116203, 'f1-score': 0.2777808234197686, 'support': 24793}, '1': {'precision': 0.3513961570726641, 'recall': 0.7048477564102564, 'f1-score': 0.4689840855170208, 'support': 24960}, '2': {'precision': 0.42568994393067794, 'recall': 0.2271614532737517, 'f1-score': 0.2962399918921658, 'support': 25735}, 'accuracy': 0.3776229334463756, 'macro avg': {'precision': 0.40352352452813367, 'recall': 0.37879380383839, 'f1-score': 0.3476683002763184, 'support': 75488}, 'weighted avg': {'precision': 0.40368481502082304, 'recall': 0.3776229334463756, 'f1-score': 0.34729491999915285, 'support': 75488}}
[[ 5067 15929  3797]
 [ 3277 17593  4090]
 [ 3345 16544  5846]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920793
{'0': {'precision': 0.3855726639949378, 'recall': 0.17472758554769643, 'f1-score': 0.24047885285798853, 'support': 10462}, '1': {'precision': 0.3840719910011249, 'recall': 0.711985987154892, 'f1-score': 0.49897702694803303, 'support': 11989}, '2': {'precision': 0.37883531621790856, 'recall': 0.2219572594698707, 'f1-score': 0.27991440633855763, 'support': 10903}, 'accuracy': 0.38328236493374107, 'macro avg': {'precision': 0.38282665707132374, 'recall': 0.3695569440574864, 'f1-score': 0.33979009538152644, 'support': 33354}, 'weighted avg': {'precision': 0.3828308977499365, 'recall': 0.38328236493374107, 'f1-score': 0.3462862657249367, 'support': 33354}}
[[1828 6693 1941]
 [1426 8536 2027]
 [1487 6996 2420]]
training model: results/CHTR/W10/deepOF_L2/h300
Epoch 1/50
295/295 - 12s - loss: 3.3392 - accuracy300: 0.3484 - val_loss: 3.3177 - val_accuracy300: 0.3684 - 12s/epoch - 39ms/step
Epoch 2/50
295/295 - 10s - loss: 3.3174 - accuracy300: 0.3517 - val_loss: 3.2987 - val_accuracy300: 0.3722 - 10s/epoch - 32ms/step
Epoch 3/50
295/295 - 10s - loss: 3.3033 - accuracy300: 0.3570 - val_loss: 3.2909 - val_accuracy300: 0.3730 - 10s/epoch - 32ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2940 - accuracy300: 0.3619 - val_loss: 3.2827 - val_accuracy300: 0.3750 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 10s - loss: 3.2851 - accuracy300: 0.3678 - val_loss: 3.2786 - val_accuracy300: 0.3785 - 10s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2816 - accuracy300: 0.3697 - val_loss: 3.2765 - val_accuracy300: 0.3794 - 10s/epoch - 33ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2741 - accuracy300: 0.3735 - val_loss: 3.2788 - val_accuracy300: 0.3798 - 10s/epoch - 33ms/step
Epoch 8/50
295/295 - 10s - loss: 3.2664 - accuracy300: 0.3796 - val_loss: 3.2792 - val_accuracy300: 0.3803 - 10s/epoch - 33ms/step
Epoch 9/50
295/295 - 10s - loss: 3.2625 - accuracy300: 0.3813 - val_loss: 3.2771 - val_accuracy300: 0.3829 - 10s/epoch - 33ms/step
Epoch 10/50
295/295 - 10s - loss: 3.2583 - accuracy300: 0.3861 - val_loss: 3.2794 - val_accuracy300: 0.3830 - 10s/epoch - 33ms/step
Epoch 11/50
295/295 - 10s - loss: 3.2506 - accuracy300: 0.3889 - val_loss: 3.2886 - val_accuracy300: 0.3797 - 10s/epoch - 33ms/step
Epoch 12/50
295/295 - 10s - loss: 3.2471 - accuracy300: 0.3919 - val_loss: 3.2943 - val_accuracy300: 0.3793 - 10s/epoch - 33ms/step
Epoch 13/50
295/295 - 10s - loss: 3.2386 - accuracy300: 0.3986 - val_loss: 3.2878 - val_accuracy300: 0.3826 - 10s/epoch - 33ms/step
Epoch 14/50
295/295 - 10s - loss: 3.2330 - accuracy300: 0.4011 - val_loss: 3.2930 - val_accuracy300: 0.3810 - 10s/epoch - 32ms/step
Epoch 15/50
295/295 - 10s - loss: 3.2261 - accuracy300: 0.4063 - val_loss: 3.2956 - val_accuracy300: 0.3827 - 10s/epoch - 32ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2172 - accuracy300: 0.4101 - val_loss: 3.2997 - val_accuracy300: 0.3789 - 9s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h300
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.119425
{'0': {'precision': 0.3967573776285563, 'recall': 0.12288179075479055, 'f1-score': 0.18764658256940636, 'support': 146173}, '1': {'precision': 0.29098080806613297, 'recall': 0.6870958335477453, 'f1-score': 0.4088262460387526, 'support': 116598}, '2': {'precision': 0.370426562408823, 'recall': 0.22116925649780503, 'f1-score': 0.27696939287506267, 'support': 143510}, 'accuracy': 0.3195226948835904, 'macro avg': {'precision': 0.3527215827011707, 'recall': 0.3437156269334469, 'f1-score': 0.29114740716107385, 'support': 406281}, 'weighted avg': {'precision': 0.35709991948991987, 'recall': 0.3195226948835904, 'f1-score': 0.2826739722533039, 'support': 406281}}
[[17962 98682 29529]
 [12068 80114 24416]
 [15242 96528 31740]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969343
{'0': {'precision': 0.4129308110909562, 'recall': 0.13196140946544657, 'f1-score': 0.2000062756911105, 'support': 24151}, '1': {'precision': 0.3425769420381717, 'recall': 0.7807471610288512, 'f1-score': 0.47620446173990727, 'support': 24921}, '2': {'precision': 0.4096045197740113, 'recall': 0.17016202301635372, 'f1-score': 0.24043861995185878, 'support': 26416}, 'accuracy': 0.35951409495548964, 'macro avg': {'precision': 0.3883707576343797, 'recall': 0.3609568645035505, 'f1-score': 0.3055497857942922, 'support': 75488}, 'weighted avg': {'precision': 0.38854076125399056, 'recall': 0.35951409495548964, 'f1-score': 0.30533686863984394, 'support': 75488}}
[[ 3187 17808  3156]
 [ 2141 19457  3323]
 [ 2390 19531  4495]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926083
{'0': {'precision': 0.3701639344262295, 'recall': 0.1112534489554592, 'f1-score': 0.17108652826185788, 'support': 10148}, '1': {'precision': 0.3779767801244205, 'recall': 0.7920126203918963, 'f1-score': 0.5117352002360452, 'support': 12044}, '2': {'precision': 0.3895796329188869, 'recall': 0.1768500268769038, 'f1-score': 0.24326822355043443, 'support': 11162}, 'accuracy': 0.3790250044972117, 'macro avg': {'precision': 0.379240115823179, 'recall': 0.36003869874141975, 'f1-score': 0.3086966506827792, 'support': 33354}, 'weighted avg': {'precision': 0.3794826350367726, 'recall': 0.3790250044972117, 'f1-score': 0.3182492280300477, 'support': 33354}}
[[1129 7488 1531]
 [ 943 9539 1562]
 [ 978 8210 1974]]
training model: results/CHTR/W10/deepOF_L2/h500
Epoch 1/50
295/295 - 12s - loss: 3.3428 - accuracy500: 0.3466 - val_loss: 3.3238 - val_accuracy500: 0.3657 - 12s/epoch - 40ms/step
Epoch 2/50
295/295 - 10s - loss: 3.3218 - accuracy500: 0.3510 - val_loss: 3.3046 - val_accuracy500: 0.3670 - 10s/epoch - 33ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3087 - accuracy500: 0.3549 - val_loss: 3.3019 - val_accuracy500: 0.3650 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 10s - loss: 3.2991 - accuracy500: 0.3610 - val_loss: 3.2978 - val_accuracy500: 0.3661 - 10s/epoch - 32ms/step
Epoch 5/50
295/295 - 10s - loss: 3.2912 - accuracy500: 0.3609 - val_loss: 3.2987 - val_accuracy500: 0.3676 - 10s/epoch - 32ms/step
Epoch 6/50
295/295 - 10s - loss: 3.2855 - accuracy500: 0.3650 - val_loss: 3.3000 - val_accuracy500: 0.3661 - 10s/epoch - 32ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2796 - accuracy500: 0.3701 - val_loss: 3.2937 - val_accuracy500: 0.3666 - 10s/epoch - 33ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2746 - accuracy500: 0.3726 - val_loss: 3.2950 - val_accuracy500: 0.3659 - 9s/epoch - 32ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2688 - accuracy500: 0.3788 - val_loss: 3.2933 - val_accuracy500: 0.3686 - 9s/epoch - 32ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2644 - accuracy500: 0.3812 - val_loss: 3.2973 - val_accuracy500: 0.3692 - 9s/epoch - 32ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2592 - accuracy500: 0.3857 - val_loss: 3.2952 - val_accuracy500: 0.3713 - 9s/epoch - 31ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2542 - accuracy500: 0.3895 - val_loss: 3.2983 - val_accuracy500: 0.3690 - 9s/epoch - 31ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2470 - accuracy500: 0.3943 - val_loss: 3.3022 - val_accuracy500: 0.3723 - 9s/epoch - 31ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2418 - accuracy500: 0.3977 - val_loss: 3.3079 - val_accuracy500: 0.3681 - 9s/epoch - 32ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2348 - accuracy500: 0.4007 - val_loss: 3.3112 - val_accuracy500: 0.3682 - 9s/epoch - 32ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2283 - accuracy500: 0.4075 - val_loss: 3.3148 - val_accuracy500: 0.3693 - 9s/epoch - 32ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2217 - accuracy500: 0.4086 - val_loss: 3.3230 - val_accuracy500: 0.3663 - 9s/epoch - 32ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2140 - accuracy500: 0.4118 - val_loss: 3.3241 - val_accuracy500: 0.3658 - 9s/epoch - 32ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2054 - accuracy500: 0.4168 - val_loss: 3.3331 - val_accuracy500: 0.3688 - 9s/epoch - 32ms/step
testing model: results/CHTR/W10/deepOF_L2/h500
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1195245
{'0': {'precision': 0.38053845544135906, 'recall': 0.10093556186271418, 'f1-score': 0.15955113434952145, 'support': 142695}, '1': {'precision': 0.305627055509832, 'recall': 0.7592082756373707, 'f1-score': 0.43581309337616275, 'support': 122770}, '2': {'precision': 0.35641910524905845, 'recall': 0.16062095216452676, 'f1-score': 0.22144657936605072, 'support': 140816}, 'accuracy': 0.320539232698551, 'macro avg': {'precision': 0.34752820540008317, 'recall': 0.3402549298882039, 'f1-score': 0.2722702690305783, 'support': 406281}, 'weighted avg': {'precision': 0.349542019510876, 'recall': 0.320539232698551, 'f1-score': 0.26448478789263163, 'support': 406281}}
[[ 14403 106267  22025]
 [ 10746  93208  18816]
 [ 12700 105498  22618]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096316
{'0': {'precision': 0.4031779031779032, 'recall': 0.11401814211322023, 'f1-score': 0.17776468277352192, 'support': 23812}, '1': {'precision': 0.3413472822988968, 'recall': 0.8194148186903851, 'f1-score': 0.48193341460239314, 'support': 24847}, '2': {'precision': 0.4336846728151076, 'recall': 0.14722874501472288, 'f1-score': 0.21982914544898016, 'support': 26829}, 'accuracy': 0.3580039211530309, 'macro avg': {'precision': 0.39273661943063587, 'recall': 0.36022056860610946, 'f1-score': 0.2931757476082984, 'support': 75488}, 'weighted avg': {'precision': 0.3936685862747648, 'recall': 0.3580039211530309, 'f1-score': 0.29283234848028106, 'support': 75488}}
[[ 2715 18567  2530]
 [ 1859 20360  2628]
 [ 2160 20719  3950]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967785
{'0': {'precision': 0.3437978560490046, 'recall': 0.0886650868878357, 'f1-score': 0.14097331240188382, 'support': 10128}, '1': {'precision': 0.37179582990807863, 'recall': 0.8263433269661988, 'f1-score': 0.5128469448238538, 'support': 12041}, '2': {'precision': 0.35603015075376887, 'recall': 0.1266875279392043, 'f1-score': 0.18687767886580944, 'support': 11185}, 'accuracy': 0.36772201235234153, 'macro avg': {'precision': 0.35720794557028407, 'recall': 0.34723198059774624, 'f1-score': 0.280232645363849, 'support': 33354}, 'weighted avg': {'precision': 0.35800730077856924, 'recall': 0.36772201235234153, 'f1-score': 0.2906156565552672, 'support': 33354}}
[[ 898 7949 1281]
 [ 809 9950 1282]
 [ 905 8863 1417]]
training model: results/CHTR/W10/deepOF_L2/h1000
Epoch 1/50
295/295 - 13s - loss: 3.3541 - accuracy1000: 0.3387 - val_loss: 3.3258 - val_accuracy1000: 0.3561 - 13s/epoch - 44ms/step
Epoch 2/50
295/295 - 10s - loss: 3.3304 - accuracy1000: 0.3412 - val_loss: 3.3118 - val_accuracy1000: 0.3571 - 10s/epoch - 33ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3141 - accuracy1000: 0.3483 - val_loss: 3.3023 - val_accuracy1000: 0.3605 - 9s/epoch - 32ms/step
Epoch 4/50
295/295 - 9s - loss: 3.3048 - accuracy1000: 0.3530 - val_loss: 3.2949 - val_accuracy1000: 0.3622 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2971 - accuracy1000: 0.3553 - val_loss: 3.2920 - val_accuracy1000: 0.3666 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2917 - accuracy1000: 0.3589 - val_loss: 3.2979 - val_accuracy1000: 0.3632 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 10s - loss: 3.2848 - accuracy1000: 0.3638 - val_loss: 3.3065 - val_accuracy1000: 0.3596 - 10s/epoch - 32ms/step
Epoch 8/50
295/295 - 10s - loss: 3.2794 - accuracy1000: 0.3669 - val_loss: 3.2985 - val_accuracy1000: 0.3682 - 10s/epoch - 33ms/step
Epoch 9/50
295/295 - 10s - loss: 3.2749 - accuracy1000: 0.3718 - val_loss: 3.3022 - val_accuracy1000: 0.3665 - 10s/epoch - 33ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2709 - accuracy1000: 0.3765 - val_loss: 3.3095 - val_accuracy1000: 0.3648 - 9s/epoch - 31ms/step
Epoch 11/50
295/295 - 10s - loss: 3.2654 - accuracy1000: 0.3790 - val_loss: 3.3145 - val_accuracy1000: 0.3662 - 10s/epoch - 33ms/step
Epoch 12/50
295/295 - 10s - loss: 3.2593 - accuracy1000: 0.3859 - val_loss: 3.3124 - val_accuracy1000: 0.3664 - 10s/epoch - 32ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2532 - accuracy1000: 0.3869 - val_loss: 3.3123 - val_accuracy1000: 0.3686 - 9s/epoch - 32ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2500 - accuracy1000: 0.3929 - val_loss: 3.3162 - val_accuracy1000: 0.3690 - 9s/epoch - 31ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2420 - accuracy1000: 0.3973 - val_loss: 3.3193 - val_accuracy1000: 0.3666 - 9s/epoch - 31ms/step
testing model: results/CHTR/W10/deepOF_L2/h1000
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1147362
{'0': {'precision': 0.365824113704272, 'recall': 0.12605392770682028, 'f1-score': 0.18750000000000003, 'support': 143748}, '1': {'precision': 0.3068999076863626, 'recall': 0.6900760288024458, 'f1-score': 0.42485332250227226, 'support': 124295}, '2': {'precision': 0.33683202402060386, 'recall': 0.1882695062139209, 'f1-score': 0.2415349991879539, 'support': 138238}, 'accuracy': 0.31977621399967016, 'macro avg': {'precision': 0.33651868180374617, 'recall': 0.33479982090772903, 'f1-score': 0.2846294405634087, 'support': 406281}, 'weighted avg': {'precision': 0.3379325985197397, 'recall': 0.31977621399967016, 'f1-score': 0.2784998780109439, 'support': 406281}}
[[18120 98230 27398]
 [14679 85773 23843]
 [16733 95479 26026]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980693
{'0': {'precision': 0.3866358192705498, 'recall': 0.12052435092482607, 'f1-score': 0.183764553686934, 'support': 23572}, '1': {'precision': 0.34218476705358564, 'recall': 0.7806529625151148, 'f1-score': 0.47580793750230316, 'support': 24810}, '2': {'precision': 0.4088742525348817, 'recall': 0.17405740426473842, 'f1-score': 0.2441713028852374, 'support': 27106}, 'accuracy': 0.3567057015684612, 'macro avg': {'precision': 0.3792316129530057, 'recall': 0.3584115725682264, 'f1-score': 0.30124793135815814, 'support': 75488}, 'weighted avg': {'precision': 0.38001177792040275, 'recall': 0.3567057015684612, 'f1-score': 0.30143864355854966, 'support': 75488}}
[[ 2841 17298  3433]
 [ 2054 19368  3388]
 [ 2453 19935  4718]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966184
{'0': {'precision': 0.3386885245901639, 'recall': 0.1, 'f1-score': 0.15440956651718982, 'support': 10330}, '1': {'precision': 0.36093676447512946, 'recall': 0.7987672541019186, 'f1-score': 0.4972035340844614, 'support': 11519}, '2': {'precision': 0.3848711554447215, 'recall': 0.16097348978704912, 'f1-score': 0.22700251271679842, 'support': 11505}, 'accuracy': 0.3623553396893926, 'macro avg': {'precision': 0.3614988148366716, 'recall': 0.3532469146296559, 'f1-score': 0.2928718711061499, 'support': 33354}, 'weighted avg': {'precision': 0.36230214344297323, 'recall': 0.3623553396893926, 'f1-score': 0.29783540924771384, 'support': 33354}}
[[1033 7751 1546]
 [ 904 9201 1414]
 [1113 8540 1852]]
training model: results/CHTR/W10/deepVOL_L2/h10
Epoch 1/50
295/295 - 13s - loss: 3.3242 - accuracy10: 0.3588 - val_loss: 3.3982 - val_accuracy10: 0.3469 - 13s/epoch - 43ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3079 - accuracy10: 0.3619 - val_loss: 3.3896 - val_accuracy10: 0.3444 - 9s/epoch - 30ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2915 - accuracy10: 0.3688 - val_loss: 3.3464 - val_accuracy10: 0.3504 - 9s/epoch - 31ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2898 - accuracy10: 0.3670 - val_loss: 3.4426 - val_accuracy10: 0.3454 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2804 - accuracy10: 0.3731 - val_loss: 3.3324 - val_accuracy10: 0.3498 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2832 - accuracy10: 0.3707 - val_loss: 3.3376 - val_accuracy10: 0.3550 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2763 - accuracy10: 0.3742 - val_loss: 3.3103 - val_accuracy10: 0.3629 - 9s/epoch - 31ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2769 - accuracy10: 0.3756 - val_loss: 3.2809 - val_accuracy10: 0.3688 - 9s/epoch - 31ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2715 - accuracy10: 0.3788 - val_loss: 3.2740 - val_accuracy10: 0.3742 - 9s/epoch - 31ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2634 - accuracy10: 0.3844 - val_loss: 3.2835 - val_accuracy10: 0.3740 - 9s/epoch - 31ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2606 - accuracy10: 0.3847 - val_loss: 3.2801 - val_accuracy10: 0.3756 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 10s - loss: 3.2627 - accuracy10: 0.3834 - val_loss: 3.2540 - val_accuracy10: 0.3842 - 10s/epoch - 32ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2562 - accuracy10: 0.3870 - val_loss: 3.2608 - val_accuracy10: 0.3843 - 9s/epoch - 30ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2527 - accuracy10: 0.3873 - val_loss: 3.2569 - val_accuracy10: 0.3873 - 9s/epoch - 31ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2493 - accuracy10: 0.3917 - val_loss: 3.2448 - val_accuracy10: 0.3930 - 9s/epoch - 29ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2479 - accuracy10: 0.3930 - val_loss: 3.2503 - val_accuracy10: 0.3874 - 9s/epoch - 31ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2447 - accuracy10: 0.3926 - val_loss: 3.2425 - val_accuracy10: 0.3920 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2399 - accuracy10: 0.3962 - val_loss: 3.2458 - val_accuracy10: 0.3897 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2360 - accuracy10: 0.3966 - val_loss: 3.2403 - val_accuracy10: 0.3922 - 9s/epoch - 31ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2338 - accuracy10: 0.3969 - val_loss: 3.2408 - val_accuracy10: 0.3934 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2272 - accuracy10: 0.4003 - val_loss: 3.2412 - val_accuracy10: 0.3941 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2244 - accuracy10: 0.4029 - val_loss: 3.2400 - val_accuracy10: 0.3915 - 9s/epoch - 30ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2237 - accuracy10: 0.4011 - val_loss: 3.2414 - val_accuracy10: 0.3904 - 9s/epoch - 29ms/step
Epoch 24/50
295/295 - 9s - loss: 3.2153 - accuracy10: 0.4042 - val_loss: 3.2531 - val_accuracy10: 0.3904 - 9s/epoch - 29ms/step
Epoch 25/50
295/295 - 9s - loss: 3.2244 - accuracy10: 0.4044 - val_loss: 3.2534 - val_accuracy10: 0.3895 - 9s/epoch - 29ms/step
Epoch 26/50
295/295 - 9s - loss: 3.2209 - accuracy10: 0.4053 - val_loss: 3.2359 - val_accuracy10: 0.3956 - 9s/epoch - 29ms/step
Epoch 27/50
295/295 - 9s - loss: 3.2155 - accuracy10: 0.4084 - val_loss: 3.2331 - val_accuracy10: 0.3990 - 9s/epoch - 30ms/step
Epoch 28/50
295/295 - 9s - loss: 3.2113 - accuracy10: 0.4100 - val_loss: 3.2296 - val_accuracy10: 0.3984 - 9s/epoch - 30ms/step
Epoch 29/50
295/295 - 9s - loss: 3.2078 - accuracy10: 0.4129 - val_loss: 3.2386 - val_accuracy10: 0.3941 - 9s/epoch - 30ms/step
Epoch 30/50
295/295 - 9s - loss: 3.2053 - accuracy10: 0.4137 - val_loss: 3.2299 - val_accuracy10: 0.4021 - 9s/epoch - 30ms/step
Epoch 31/50
295/295 - 9s - loss: 3.1994 - accuracy10: 0.4158 - val_loss: 3.2348 - val_accuracy10: 0.3985 - 9s/epoch - 30ms/step
Epoch 32/50
295/295 - 9s - loss: 3.1979 - accuracy10: 0.4148 - val_loss: 3.2391 - val_accuracy10: 0.3963 - 9s/epoch - 30ms/step
Epoch 33/50
295/295 - 9s - loss: 3.1930 - accuracy10: 0.4185 - val_loss: 3.2410 - val_accuracy10: 0.3952 - 9s/epoch - 30ms/step
Epoch 34/50
295/295 - 9s - loss: 3.1919 - accuracy10: 0.4162 - val_loss: 3.2334 - val_accuracy10: 0.3987 - 9s/epoch - 29ms/step
Epoch 35/50
295/295 - 9s - loss: 3.1859 - accuracy10: 0.4194 - val_loss: 3.2275 - val_accuracy10: 0.4032 - 9s/epoch - 30ms/step
Epoch 36/50
295/295 - 9s - loss: 3.1884 - accuracy10: 0.4207 - val_loss: 3.2433 - val_accuracy10: 0.3960 - 9s/epoch - 30ms/step
Epoch 37/50
295/295 - 9s - loss: 3.1830 - accuracy10: 0.4225 - val_loss: 3.2338 - val_accuracy10: 0.3997 - 9s/epoch - 30ms/step
Epoch 38/50
295/295 - 9s - loss: 3.1819 - accuracy10: 0.4227 - val_loss: 3.2441 - val_accuracy10: 0.3949 - 9s/epoch - 29ms/step
Epoch 39/50
295/295 - 9s - loss: 3.1777 - accuracy10: 0.4264 - val_loss: 3.2400 - val_accuracy10: 0.3981 - 9s/epoch - 29ms/step
Epoch 40/50
295/295 - 9s - loss: 3.1712 - accuracy10: 0.4271 - val_loss: 3.2512 - val_accuracy10: 0.3952 - 9s/epoch - 30ms/step
Epoch 41/50
295/295 - 9s - loss: 3.1711 - accuracy10: 0.4276 - val_loss: 3.2555 - val_accuracy10: 0.3961 - 9s/epoch - 29ms/step
Epoch 42/50
295/295 - 9s - loss: 3.1645 - accuracy10: 0.4321 - val_loss: 3.2539 - val_accuracy10: 0.3973 - 9s/epoch - 29ms/step
Epoch 43/50
295/295 - 9s - loss: 3.1639 - accuracy10: 0.4305 - val_loss: 3.2526 - val_accuracy10: 0.3973 - 9s/epoch - 30ms/step
Epoch 44/50
295/295 - 9s - loss: 3.1597 - accuracy10: 0.4308 - val_loss: 3.2640 - val_accuracy10: 0.3933 - 9s/epoch - 30ms/step
Epoch 45/50
295/295 - 9s - loss: 3.1581 - accuracy10: 0.4305 - val_loss: 3.2468 - val_accuracy10: 0.3997 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h10
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0925983
{'0': {'precision': 0.40321274298056153, 'recall': 0.19181591152336783, 'f1-score': 0.25996267321658234, 'support': 140150}, '1': {'precision': 0.3536231549904123, 'recall': 0.7280473428957965, 'f1-score': 0.4760310998225676, 'support': 126397}, '2': {'precision': 0.413327454808843, 'recall': 0.23480917997123207, 'f1-score': 0.29948339752834013, 'support': 139739}, 'accuracy': 0.3734266009658221, 'macro avg': {'precision': 0.39005445092660557, 'recall': 0.3848908114634655, 'f1-score': 0.34515905685583004, 'support': 406286}, 'weighted avg': {'precision': 0.3912641268898799, 'recall': 0.3734266009658221, 'f1-score': 0.3407751733084325, 'support': 406286}}
[[26883 84824 28443]
 [16244 92023 18130]
 [23545 83382 32812]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0717771
{'0': {'precision': 0.4463252807077237, 'recall': 0.20152865263481334, 'f1-score': 0.27767781541066894, 'support': 26036}, '1': {'precision': 0.38470266437037787, 'recall': 0.7631737610032557, 'f1-score': 0.5115445752620094, 'support': 24879}, '2': {'precision': 0.45364768064538563, 'recall': 0.2654323499491353, 'f1-score': 0.33490784001642965, 'support': 24575}, 'accuracy': 0.4074314478738906, 'macro avg': {'precision': 0.42822520857449575, 'recall': 0.4100449211957348, 'f1-score': 0.3747100768963693, 'support': 75490}, 'weighted avg': {'precision': 0.42840024304195623, 'recall': 0.4074314478738906, 'f1-score': 0.37338319324916497, 'support': 75490}}
[[ 5247 16017  4772]
 [ 2808 18987  3084]
 [ 3701 14351  6523]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0767863
{'0': {'precision': 0.4263461538461538, 'recall': 0.19605588963565618, 'f1-score': 0.2685970438575236, 'support': 11308}, '1': {'precision': 0.3971082562048165, 'recall': 0.7486761003559337, 'f1-score': 0.5189553496208931, 'support': 11519}, '2': {'precision': 0.40205064471026875, 'recall': 0.24584402013869097, 'f1-score': 0.30511671775524635, 'support': 10527}, 'accuracy': 0.4026203753672723, 'macro avg': {'precision': 0.40850168492041306, 'recall': 0.3968586700434269, 'f1-score': 0.36422303707788767, 'support': 33354}, 'weighted avg': {'precision': 0.4085806634220959, 'recall': 0.4026203753672723, 'f1-score': 0.36658588871000247, 'support': 33354}}
[[2217 6852 2239]
 [1285 8624 1610]
 [1698 6241 2588]]
training model: results/CHTR/W10/deepVOL_L2/h20
Epoch 1/50
295/295 - 11s - loss: 3.3185 - accuracy20: 0.3631 - val_loss: 3.4265 - val_accuracy20: 0.3396 - 11s/epoch - 39ms/step
Epoch 2/50
295/295 - 10s - loss: 3.2944 - accuracy20: 0.3678 - val_loss: 3.4213 - val_accuracy20: 0.3430 - 10s/epoch - 35ms/step
Epoch 3/50
295/295 - 10s - loss: 3.2875 - accuracy20: 0.3655 - val_loss: 3.5199 - val_accuracy20: 0.3413 - 10s/epoch - 34ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2865 - accuracy20: 0.3690 - val_loss: 3.4050 - val_accuracy20: 0.3465 - 9s/epoch - 31ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2836 - accuracy20: 0.3658 - val_loss: 3.3696 - val_accuracy20: 0.3519 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2834 - accuracy20: 0.3688 - val_loss: 3.3619 - val_accuracy20: 0.3520 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2795 - accuracy20: 0.3728 - val_loss: 3.3552 - val_accuracy20: 0.3558 - 9s/epoch - 31ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2772 - accuracy20: 0.3775 - val_loss: 3.3184 - val_accuracy20: 0.3613 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2727 - accuracy20: 0.3782 - val_loss: 3.3426 - val_accuracy20: 0.3620 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2741 - accuracy20: 0.3775 - val_loss: 3.2978 - val_accuracy20: 0.3683 - 9s/epoch - 31ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2672 - accuracy20: 0.3823 - val_loss: 3.2936 - val_accuracy20: 0.3701 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2580 - accuracy20: 0.3853 - val_loss: 3.2946 - val_accuracy20: 0.3681 - 9s/epoch - 30ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2661 - accuracy20: 0.3803 - val_loss: 3.2693 - val_accuracy20: 0.3739 - 9s/epoch - 30ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2627 - accuracy20: 0.3837 - val_loss: 3.2795 - val_accuracy20: 0.3731 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2620 - accuracy20: 0.3859 - val_loss: 3.2640 - val_accuracy20: 0.3815 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2593 - accuracy20: 0.3861 - val_loss: 3.2542 - val_accuracy20: 0.3884 - 9s/epoch - 31ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2517 - accuracy20: 0.3935 - val_loss: 3.2568 - val_accuracy20: 0.3835 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2483 - accuracy20: 0.3935 - val_loss: 3.2585 - val_accuracy20: 0.3821 - 9s/epoch - 31ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2485 - accuracy20: 0.3947 - val_loss: 3.2718 - val_accuracy20: 0.3823 - 9s/epoch - 30ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2483 - accuracy20: 0.3949 - val_loss: 3.2510 - val_accuracy20: 0.3902 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2425 - accuracy20: 0.3978 - val_loss: 3.2502 - val_accuracy20: 0.3871 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2411 - accuracy20: 0.3974 - val_loss: 3.2529 - val_accuracy20: 0.3862 - 9s/epoch - 29ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2366 - accuracy20: 0.3984 - val_loss: 3.2491 - val_accuracy20: 0.3937 - 9s/epoch - 30ms/step
Epoch 24/50
295/295 - 9s - loss: 3.2322 - accuracy20: 0.4010 - val_loss: 3.2553 - val_accuracy20: 0.3857 - 9s/epoch - 30ms/step
Epoch 25/50
295/295 - 9s - loss: 3.2299 - accuracy20: 0.4024 - val_loss: 3.2639 - val_accuracy20: 0.3831 - 9s/epoch - 30ms/step
Epoch 26/50
295/295 - 9s - loss: 3.2288 - accuracy20: 0.4051 - val_loss: 3.2621 - val_accuracy20: 0.3859 - 9s/epoch - 30ms/step
Epoch 27/50
295/295 - 9s - loss: 3.2266 - accuracy20: 0.4062 - val_loss: 3.2708 - val_accuracy20: 0.3821 - 9s/epoch - 29ms/step
Epoch 28/50
295/295 - 9s - loss: 3.2289 - accuracy20: 0.4026 - val_loss: 3.2536 - val_accuracy20: 0.3904 - 9s/epoch - 30ms/step
Epoch 29/50
295/295 - 9s - loss: 3.2196 - accuracy20: 0.4081 - val_loss: 3.2746 - val_accuracy20: 0.3795 - 9s/epoch - 30ms/step
Epoch 30/50
295/295 - 9s - loss: 3.2174 - accuracy20: 0.4106 - val_loss: 3.2811 - val_accuracy20: 0.3793 - 9s/epoch - 29ms/step
Epoch 31/50
295/295 - 9s - loss: 3.2194 - accuracy20: 0.4102 - val_loss: 3.2558 - val_accuracy20: 0.3903 - 9s/epoch - 30ms/step
Epoch 32/50
295/295 - 9s - loss: 3.2160 - accuracy20: 0.4103 - val_loss: 3.2665 - val_accuracy20: 0.3882 - 9s/epoch - 29ms/step
Epoch 33/50
295/295 - 9s - loss: 3.2130 - accuracy20: 0.4128 - val_loss: 3.2706 - val_accuracy20: 0.3865 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h20
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0973283
{'0': {'precision': 0.39932717218978386, 'recall': 0.1468342551648633, 'f1-score': 0.21471640053226881, 'support': 140662}, '1': {'precision': 0.34607289411123393, 'recall': 0.7279531791217104, 'f1-score': 0.46912243520830077, 'support': 125585}, '2': {'precision': 0.3979867256637168, 'recall': 0.2569141453452253, 'f1-score': 0.31225617191534416, 'support': 140039}, 'accuracy': 0.3644034005601965, 'macro avg': {'precision': 0.38112893065491155, 'recall': 0.3772338598772664, 'f1-score': 0.3320316692186379, 'support': 406286}, 'weighted avg': {'precision': 0.3824039867894536, 'recall': 0.3644034005601965, 'f1-score': 0.32697464696336404, 'support': 406286}}
[[20654 87139 32869]
 [12612 91420 21553]
 [18456 85605 35978]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0868027
{'0': {'precision': 0.4340175953079179, 'recall': 0.1469599755575924, 'f1-score': 0.21957203994293867, 'support': 26184}, '1': {'precision': 0.3746884409084565, 'recall': 0.7552652733118971, 'f1-score': 0.5008863003291972, 'support': 24880}, '2': {'precision': 0.40411582589692224, 'recall': 0.2725374600835176, 'f1-score': 0.32553363162913523, 'support': 24426}, 'accuracy': 0.3880778911114055, 'macro avg': {'precision': 0.40427395403776556, 'recall': 0.39158756965100233, 'f1-score': 0.348663990633757, 'support': 75490}, 'weighted avg': {'precision': 0.4047886910677327, 'recall': 0.3880778911114055, 'f1-score': 0.3465731876040481, 'support': 75490}}
[[ 3848 16444  5892]
 [ 2165 18791  3924]
 [ 2853 14916  6657]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0836927
{'0': {'precision': 0.4200209095661265, 'recall': 0.14108867427568042, 'f1-score': 0.2112250262881178, 'support': 11390}, '1': {'precision': 0.3882782212086659, 'recall': 0.7510366122629025, 'f1-score': 0.5119061936259771, 'support': 11335}, '2': {'precision': 0.38458503222412205, 'recall': 0.27509643428356384, 'f1-score': 0.32075471698113206, 'support': 10629}, 'accuracy': 0.3910775319302033, 'macro avg': {'precision': 0.3976280543329715, 'recall': 0.3890739069407156, 'f1-score': 0.34796197896507564, 'support': 33354}, 'weighted avg': {'precision': 0.39794105968905086, 'recall': 0.3910775319302033, 'f1-score': 0.34831239554369986, 'support': 33354}}
[[1607 6971 2812]
 [ 955 8513 1867]
 [1264 6441 2924]]
training model: results/CHTR/W10/deepVOL_L2/h30
Epoch 1/50
295/295 - 11s - loss: 3.3134 - accuracy30: 0.3658 - val_loss: 3.4719 - val_accuracy30: 0.3399 - 11s/epoch - 38ms/step
Epoch 2/50
295/295 - 9s - loss: 3.2961 - accuracy30: 0.3675 - val_loss: 3.4544 - val_accuracy30: 0.3431 - 9s/epoch - 30ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2925 - accuracy30: 0.3701 - val_loss: 3.4452 - val_accuracy30: 0.3451 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2901 - accuracy30: 0.3695 - val_loss: 3.3900 - val_accuracy30: 0.3392 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2862 - accuracy30: 0.3703 - val_loss: 3.3804 - val_accuracy30: 0.3406 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2836 - accuracy30: 0.3711 - val_loss: 3.3982 - val_accuracy30: 0.3453 - 9s/epoch - 30ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2812 - accuracy30: 0.3691 - val_loss: 3.3550 - val_accuracy30: 0.3451 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2804 - accuracy30: 0.3717 - val_loss: 3.4022 - val_accuracy30: 0.3452 - 9s/epoch - 31ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2831 - accuracy30: 0.3730 - val_loss: 3.3313 - val_accuracy30: 0.3501 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2804 - accuracy30: 0.3740 - val_loss: 3.3462 - val_accuracy30: 0.3546 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2795 - accuracy30: 0.3726 - val_loss: 3.3142 - val_accuracy30: 0.3570 - 9s/epoch - 31ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2827 - accuracy30: 0.3720 - val_loss: 3.2973 - val_accuracy30: 0.3630 - 9s/epoch - 31ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2780 - accuracy30: 0.3746 - val_loss: 3.2904 - val_accuracy30: 0.3580 - 9s/epoch - 31ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2757 - accuracy30: 0.3757 - val_loss: 3.2964 - val_accuracy30: 0.3563 - 9s/epoch - 31ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2791 - accuracy30: 0.3692 - val_loss: 3.2959 - val_accuracy30: 0.3635 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2775 - accuracy30: 0.3692 - val_loss: 3.2808 - val_accuracy30: 0.3724 - 9s/epoch - 30ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2759 - accuracy30: 0.3748 - val_loss: 3.2768 - val_accuracy30: 0.3728 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2699 - accuracy30: 0.3822 - val_loss: 3.2759 - val_accuracy30: 0.3761 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2691 - accuracy30: 0.3802 - val_loss: 3.2739 - val_accuracy30: 0.3751 - 9s/epoch - 30ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2645 - accuracy30: 0.3852 - val_loss: 3.2797 - val_accuracy30: 0.3714 - 9s/epoch - 29ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2632 - accuracy30: 0.3852 - val_loss: 3.2805 - val_accuracy30: 0.3694 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2655 - accuracy30: 0.3867 - val_loss: 3.2709 - val_accuracy30: 0.3779 - 9s/epoch - 30ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2609 - accuracy30: 0.3870 - val_loss: 3.2700 - val_accuracy30: 0.3783 - 9s/epoch - 30ms/step
Epoch 24/50
295/295 - 9s - loss: 3.2545 - accuracy30: 0.3909 - val_loss: 3.2707 - val_accuracy30: 0.3827 - 9s/epoch - 30ms/step
Epoch 25/50
295/295 - 9s - loss: 3.2535 - accuracy30: 0.3893 - val_loss: 3.3033 - val_accuracy30: 0.3657 - 9s/epoch - 30ms/step
Epoch 26/50
295/295 - 9s - loss: 3.2608 - accuracy30: 0.3892 - val_loss: 3.2797 - val_accuracy30: 0.3775 - 9s/epoch - 30ms/step
Epoch 27/50
295/295 - 9s - loss: 3.2593 - accuracy30: 0.3908 - val_loss: 3.2648 - val_accuracy30: 0.3830 - 9s/epoch - 30ms/step
Epoch 28/50
295/295 - 9s - loss: 3.2499 - accuracy30: 0.3944 - val_loss: 3.2864 - val_accuracy30: 0.3764 - 9s/epoch - 29ms/step
Epoch 29/50
295/295 - 9s - loss: 3.2492 - accuracy30: 0.3934 - val_loss: 3.3028 - val_accuracy30: 0.3694 - 9s/epoch - 30ms/step
Epoch 30/50
295/295 - 9s - loss: 3.2521 - accuracy30: 0.3909 - val_loss: 3.2845 - val_accuracy30: 0.3697 - 9s/epoch - 30ms/step
Epoch 31/50
295/295 - 9s - loss: 3.2486 - accuracy30: 0.3939 - val_loss: 3.3031 - val_accuracy30: 0.3678 - 9s/epoch - 31ms/step
Epoch 32/50
295/295 - 9s - loss: 3.2514 - accuracy30: 0.3943 - val_loss: 3.2935 - val_accuracy30: 0.3647 - 9s/epoch - 30ms/step
Epoch 33/50
295/295 - 9s - loss: 3.2473 - accuracy30: 0.3965 - val_loss: 3.2791 - val_accuracy30: 0.3743 - 9s/epoch - 30ms/step
Epoch 34/50
295/295 - 9s - loss: 3.2507 - accuracy30: 0.3946 - val_loss: 3.2633 - val_accuracy30: 0.3848 - 9s/epoch - 30ms/step
Epoch 35/50
295/295 - 9s - loss: 3.2440 - accuracy30: 0.3991 - val_loss: 3.2599 - val_accuracy30: 0.3826 - 9s/epoch - 30ms/step
Epoch 36/50
295/295 - 9s - loss: 3.2416 - accuracy30: 0.4011 - val_loss: 3.2698 - val_accuracy30: 0.3831 - 9s/epoch - 30ms/step
Epoch 37/50
295/295 - 9s - loss: 3.2385 - accuracy30: 0.4023 - val_loss: 3.2724 - val_accuracy30: 0.3817 - 9s/epoch - 30ms/step
Epoch 38/50
295/295 - 9s - loss: 3.2396 - accuracy30: 0.4023 - val_loss: 3.2599 - val_accuracy30: 0.3844 - 9s/epoch - 30ms/step
Epoch 39/50
295/295 - 9s - loss: 3.2383 - accuracy30: 0.4009 - val_loss: 3.2596 - val_accuracy30: 0.3826 - 9s/epoch - 30ms/step
Epoch 40/50
295/295 - 9s - loss: 3.2353 - accuracy30: 0.4034 - val_loss: 3.2636 - val_accuracy30: 0.3845 - 9s/epoch - 29ms/step
Epoch 41/50
295/295 - 9s - loss: 3.2334 - accuracy30: 0.4052 - val_loss: 3.2649 - val_accuracy30: 0.3822 - 9s/epoch - 30ms/step
Epoch 42/50
295/295 - 9s - loss: 3.2310 - accuracy30: 0.4037 - val_loss: 3.2672 - val_accuracy30: 0.3769 - 9s/epoch - 30ms/step
Epoch 43/50
295/295 - 9s - loss: 3.2295 - accuracy30: 0.4063 - val_loss: 3.2633 - val_accuracy30: 0.3860 - 9s/epoch - 30ms/step
Epoch 44/50
295/295 - 9s - loss: 3.2240 - accuracy30: 0.4078 - val_loss: 3.2752 - val_accuracy30: 0.3786 - 9s/epoch - 30ms/step
Epoch 45/50
295/295 - 9s - loss: 3.2222 - accuracy30: 0.4103 - val_loss: 3.2639 - val_accuracy30: 0.3812 - 9s/epoch - 30ms/step
Epoch 46/50
295/295 - 9s - loss: 3.2169 - accuracy30: 0.4103 - val_loss: 3.2731 - val_accuracy30: 0.3775 - 9s/epoch - 30ms/step
Epoch 47/50
295/295 - 9s - loss: 3.2154 - accuracy30: 0.4123 - val_loss: 3.2666 - val_accuracy30: 0.3812 - 9s/epoch - 31ms/step
Epoch 48/50
295/295 - 9s - loss: 3.2115 - accuracy30: 0.4145 - val_loss: 3.2798 - val_accuracy30: 0.3780 - 9s/epoch - 30ms/step
Epoch 49/50
295/295 - 9s - loss: 3.2121 - accuracy30: 0.4141 - val_loss: 3.2761 - val_accuracy30: 0.3789 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h30
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031425
{'0': {'precision': 0.3907604635404903, 'recall': 0.15885606119465182, 'f1-score': 0.2258835581355643, 'support': 141581}, '1': {'precision': 0.3309222759390108, 'recall': 0.7196755252899406, 'f1-score': 0.4533736173594942, 'support': 123646}, '2': {'precision': 0.39515714840471505, 'recall': 0.22362982865325856, 'f1-score': 0.28561986164934267, 'support': 141059}, 'accuracy': 0.3520204978758805, 'macro avg': {'precision': 0.372279962628072, 'recall': 0.36738713837928366, 'f1-score': 0.3216256790481337, 'support': 406286}, 'weighted avg': {'precision': 0.37407625445154835, 'recall': 0.3520204978758805, 'f1-score': 0.31585608758563666, 'support': 406286}}
[[22491 90778 28312]
 [14689 88985 19972]
 [20377 89137 31545]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864959
{'0': {'precision': 0.4447365858408803, 'recall': 0.1739146991622239, 'f1-score': 0.2500479071422705, 'support': 26260}, '1': {'precision': 0.367241581602722, 'recall': 0.7549141777545524, 'f1-score': 0.4941130040123659, 'support': 24877}, '2': {'precision': 0.4202229638571327, 'recall': 0.2430090748573071, 'f1-score': 0.3079404724737225, 'support': 24353}, 'accuracy': 0.38766724069413167, 'macro avg': {'precision': 0.41073371043357837, 'recall': 0.39061265059136113, 'f1-score': 0.3507004612094529, 'support': 75490}, 'weighted avg': {'precision': 0.4112907856474392, 'recall': 0.38766724069413167, 'f1-score': 0.34915328611106394, 'support': 75490}}
[[ 4567 16937  4756]
 [ 2688 18780  3409]
 [ 3014 15421  5918]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0868552
{'0': {'precision': 0.4124382577458464, 'recall': 0.16180745177486128, 'f1-score': 0.232428670842032, 'support': 11353}, '1': {'precision': 0.37756418813687537, 'recall': 0.7465904091509019, 'f1-score': 0.5015071812754891, 'support': 11365}, '2': {'precision': 0.3794927648980862, 'recall': 0.22931553215494546, 'f1-score': 0.28588173240344605, 'support': 10636}, 'accuracy': 0.38259279246866945, 'macro avg': {'precision': 0.38983173692693596, 'recall': 0.3792377976935695, 'f1-score': 0.33993919484032237, 'support': 33354}, 'weighted avg': {'precision': 0.3900495768369679, 'recall': 0.38259279246866945, 'f1-score': 0.3411593788183899, 'support': 33354}}
[[1837 7253 2263]
 [1155 8485 1725]
 [1462 6735 2439]]
training model: results/CHTR/W10/deepVOL_L2/h50
Epoch 1/50
295/295 - 12s - loss: 3.3157 - accuracy50: 0.3672 - val_loss: 3.5409 - val_accuracy50: 0.3450 - 12s/epoch - 40ms/step
Epoch 2/50
295/295 - 9s - loss: 3.2985 - accuracy50: 0.3664 - val_loss: 3.4505 - val_accuracy50: 0.3468 - 9s/epoch - 30ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2928 - accuracy50: 0.3680 - val_loss: 3.4759 - val_accuracy50: 0.3464 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2922 - accuracy50: 0.3677 - val_loss: 3.4924 - val_accuracy50: 0.3473 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2906 - accuracy50: 0.3660 - val_loss: 3.3404 - val_accuracy50: 0.3460 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2899 - accuracy50: 0.3672 - val_loss: 3.3315 - val_accuracy50: 0.3510 - 9s/epoch - 30ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2894 - accuracy50: 0.3658 - val_loss: 3.3301 - val_accuracy50: 0.3523 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2827 - accuracy50: 0.3706 - val_loss: 3.3938 - val_accuracy50: 0.3513 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2855 - accuracy50: 0.3688 - val_loss: 3.3003 - val_accuracy50: 0.3554 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2874 - accuracy50: 0.3643 - val_loss: 3.2984 - val_accuracy50: 0.3545 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2840 - accuracy50: 0.3680 - val_loss: 3.2938 - val_accuracy50: 0.3574 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2851 - accuracy50: 0.3649 - val_loss: 3.2940 - val_accuracy50: 0.3612 - 9s/epoch - 31ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2810 - accuracy50: 0.3692 - val_loss: 3.2906 - val_accuracy50: 0.3579 - 9s/epoch - 31ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2797 - accuracy50: 0.3704 - val_loss: 3.2890 - val_accuracy50: 0.3640 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2782 - accuracy50: 0.3712 - val_loss: 3.2895 - val_accuracy50: 0.3659 - 9s/epoch - 29ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2784 - accuracy50: 0.3742 - val_loss: 3.2914 - val_accuracy50: 0.3601 - 9s/epoch - 30ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2768 - accuracy50: 0.3720 - val_loss: 3.2838 - val_accuracy50: 0.3647 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2712 - accuracy50: 0.3763 - val_loss: 3.2861 - val_accuracy50: 0.3621 - 9s/epoch - 29ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2715 - accuracy50: 0.3783 - val_loss: 3.2828 - val_accuracy50: 0.3666 - 9s/epoch - 30ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2670 - accuracy50: 0.3805 - val_loss: 3.2845 - val_accuracy50: 0.3659 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2676 - accuracy50: 0.3809 - val_loss: 3.2815 - val_accuracy50: 0.3669 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2671 - accuracy50: 0.3800 - val_loss: 3.2806 - val_accuracy50: 0.3673 - 9s/epoch - 29ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2621 - accuracy50: 0.3861 - val_loss: 3.2807 - val_accuracy50: 0.3710 - 9s/epoch - 29ms/step
Epoch 24/50
295/295 - 9s - loss: 3.2586 - accuracy50: 0.3855 - val_loss: 3.2834 - val_accuracy50: 0.3702 - 9s/epoch - 29ms/step
Epoch 25/50
295/295 - 9s - loss: 3.2575 - accuracy50: 0.3871 - val_loss: 3.2795 - val_accuracy50: 0.3696 - 9s/epoch - 30ms/step
Epoch 26/50
295/295 - 9s - loss: 3.2575 - accuracy50: 0.3863 - val_loss: 3.2806 - val_accuracy50: 0.3715 - 9s/epoch - 30ms/step
Epoch 27/50
295/295 - 9s - loss: 3.2543 - accuracy50: 0.3891 - val_loss: 3.2839 - val_accuracy50: 0.3679 - 9s/epoch - 30ms/step
Epoch 28/50
295/295 - 10s - loss: 3.2526 - accuracy50: 0.3875 - val_loss: 3.2960 - val_accuracy50: 0.3695 - 10s/epoch - 32ms/step
Epoch 29/50
295/295 - 9s - loss: 3.2509 - accuracy50: 0.3909 - val_loss: 3.2982 - val_accuracy50: 0.3669 - 9s/epoch - 32ms/step
Epoch 30/50
295/295 - 9s - loss: 3.2491 - accuracy50: 0.3933 - val_loss: 3.3061 - val_accuracy50: 0.3618 - 9s/epoch - 30ms/step
Epoch 31/50
295/295 - 9s - loss: 3.2513 - accuracy50: 0.3899 - val_loss: 3.2899 - val_accuracy50: 0.3688 - 9s/epoch - 30ms/step
Epoch 32/50
295/295 - 9s - loss: 3.2429 - accuracy50: 0.3937 - val_loss: 3.3026 - val_accuracy50: 0.3692 - 9s/epoch - 31ms/step
Epoch 33/50
295/295 - 9s - loss: 3.2405 - accuracy50: 0.3952 - val_loss: 3.3043 - val_accuracy50: 0.3680 - 9s/epoch - 30ms/step
Epoch 34/50
295/295 - 9s - loss: 3.2422 - accuracy50: 0.3966 - val_loss: 3.2877 - val_accuracy50: 0.3727 - 9s/epoch - 30ms/step
Epoch 35/50
295/295 - 9s - loss: 3.2366 - accuracy50: 0.3978 - val_loss: 3.2872 - val_accuracy50: 0.3706 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h50
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1073725
{'0': {'precision': 0.3822464364486289, 'recall': 0.16084749167122642, 'f1-score': 0.22641895745686946, 'support': 144379}, '1': {'precision': 0.3084426967185563, 'recall': 0.7117811418324367, 'f1-score': 0.4303833856147181, 'support': 119895}, '2': {'precision': 0.378839590443686, 'recall': 0.1836816607047292, 'f1-score': 0.24740713340636514, 'support': 142012}, 'accuracy': 0.3314094012592115, 'macro avg': {'precision': 0.3565095745369571, 'recall': 0.3521034314027974, 'f1-score': 0.30140315882598423, 'support': 406286}, 'weighted avg': {'precision': 0.35927613378057977, 'recall': 0.3314094012592115, 'f1-score': 0.29394500550411956, 'support': 406286}}
[[23223 96814 24342]
 [16128 85339 18428]
 [21403 94524 26085]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0929521
{'0': {'precision': 0.435354414466686, 'recall': 0.17121125689294542, 'f1-score': 0.24576918877606724, 'support': 26295}, '1': {'precision': 0.35475973582327486, 'recall': 0.7547847855931519, 'f1-score': 0.48266157143225996, 'support': 24766}, '2': {'precision': 0.3895801557357309, 'recall': 0.19865733349707315, 'f1-score': 0.2631350647942309, 'support': 24429}, 'accuracy': 0.37154590011922106, 'macro avg': {'precision': 0.3932314353418973, 'recall': 0.37488445866105685, 'f1-score': 0.33052194166751936, 'support': 75490}, 'weighted avg': {'precision': 0.39410090833579153, 'recall': 0.37154590011922106, 'f1-score': 0.32910615703823426, 'support': 75490}}
[[ 4502 17558  4235]
 [ 2704 18693  3369]
 [ 3135 16441  4853]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945381
{'0': {'precision': 0.3666077738515901, 'recall': 0.14762116496220543, 'f1-score': 0.21048627401255313, 'support': 11245}, '1': {'precision': 0.37223261276151537, 'recall': 0.7416587225929456, 'f1-score': 0.4956849116710107, 'support': 11539}, '2': {'precision': 0.34927163667523564, 'recall': 0.19280983916745506, 'f1-score': 0.24846083511124653, 'support': 10570}, 'accuracy': 0.36745217964861787, 'macro avg': {'precision': 0.3627040077627804, 'recall': 0.36069657557420204, 'f1-score': 0.3182106735982701, 'support': 33354}, 'weighted avg': {'precision': 0.3630598349605294, 'recall': 0.36745217964861787, 'f1-score': 0.3211865855420288, 'support': 33354}}
[[1660 7455 2130]
 [1314 8558 1667]
 [1554 6978 2038]]
training model: results/CHTR/W10/deepVOL_L2/h100
Epoch 1/50
295/295 - 11s - loss: 3.3216 - accuracy100: 0.3636 - val_loss: 3.5035 - val_accuracy100: 0.3499 - 11s/epoch - 38ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3078 - accuracy100: 0.3639 - val_loss: 3.4167 - val_accuracy100: 0.3508 - 9s/epoch - 30ms/step
Epoch 3/50
295/295 - 9s - loss: 3.2982 - accuracy100: 0.3630 - val_loss: 3.5212 - val_accuracy100: 0.3504 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.2978 - accuracy100: 0.3652 - val_loss: 3.4051 - val_accuracy100: 0.3499 - 9s/epoch - 32ms/step
Epoch 5/50
295/295 - 9s - loss: 3.3029 - accuracy100: 0.3595 - val_loss: 3.3146 - val_accuracy100: 0.3498 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 3.3002 - accuracy100: 0.3463 - val_loss: 3.3267 - val_accuracy100: 0.3462 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 3.3014 - accuracy100: 0.3559 - val_loss: 3.3056 - val_accuracy100: 0.3479 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2995 - accuracy100: 0.3479 - val_loss: 3.3002 - val_accuracy100: 0.3429 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2983 - accuracy100: 0.3414 - val_loss: 3.2968 - val_accuracy100: 0.3466 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2961 - accuracy100: 0.3471 - val_loss: 3.2955 - val_accuracy100: 0.3460 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2941 - accuracy100: 0.3481 - val_loss: 3.2947 - val_accuracy100: 0.3457 - 9s/epoch - 31ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2943 - accuracy100: 0.3470 - val_loss: 3.2936 - val_accuracy100: 0.3473 - 9s/epoch - 30ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2931 - accuracy100: 0.3501 - val_loss: 3.2940 - val_accuracy100: 0.3464 - 9s/epoch - 30ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2907 - accuracy100: 0.3544 - val_loss: 3.2951 - val_accuracy100: 0.3433 - 9s/epoch - 29ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2916 - accuracy100: 0.3549 - val_loss: 3.2939 - val_accuracy100: 0.3478 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2909 - accuracy100: 0.3534 - val_loss: 3.2928 - val_accuracy100: 0.3479 - 9s/epoch - 30ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2894 - accuracy100: 0.3552 - val_loss: 3.2936 - val_accuracy100: 0.3460 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2889 - accuracy100: 0.3566 - val_loss: 3.2933 - val_accuracy100: 0.3491 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2876 - accuracy100: 0.3618 - val_loss: 3.2959 - val_accuracy100: 0.3472 - 9s/epoch - 30ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2853 - accuracy100: 0.3630 - val_loss: 3.2917 - val_accuracy100: 0.3475 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2844 - accuracy100: 0.3631 - val_loss: 3.3011 - val_accuracy100: 0.3474 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2846 - accuracy100: 0.3626 - val_loss: 3.2942 - val_accuracy100: 0.3483 - 9s/epoch - 30ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2852 - accuracy100: 0.3607 - val_loss: 3.2937 - val_accuracy100: 0.3509 - 9s/epoch - 30ms/step
Epoch 24/50
295/295 - 9s - loss: 3.2805 - accuracy100: 0.3662 - val_loss: 3.2982 - val_accuracy100: 0.3487 - 9s/epoch - 29ms/step
Epoch 25/50
295/295 - 9s - loss: 3.2780 - accuracy100: 0.3659 - val_loss: 3.2994 - val_accuracy100: 0.3474 - 9s/epoch - 30ms/step
Epoch 26/50
295/295 - 9s - loss: 3.2774 - accuracy100: 0.3685 - val_loss: 3.2977 - val_accuracy100: 0.3500 - 9s/epoch - 30ms/step
Epoch 27/50
295/295 - 9s - loss: 3.2759 - accuracy100: 0.3697 - val_loss: 3.3051 - val_accuracy100: 0.3522 - 9s/epoch - 30ms/step
Epoch 28/50
295/295 - 9s - loss: 3.2745 - accuracy100: 0.3721 - val_loss: 3.3001 - val_accuracy100: 0.3493 - 9s/epoch - 31ms/step
Epoch 29/50
295/295 - 9s - loss: 3.2745 - accuracy100: 0.3691 - val_loss: 3.3020 - val_accuracy100: 0.3491 - 9s/epoch - 31ms/step
Epoch 30/50
295/295 - 9s - loss: 3.2726 - accuracy100: 0.3731 - val_loss: 3.3010 - val_accuracy100: 0.3536 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h100
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1107849
{'0': {'precision': 0.36505048263619216, 'recall': 0.11199613313454378, 'f1-score': 0.17140564927013766, 'support': 146889}, '1': {'precision': 0.2814380116382286, 'recall': 0.7952829284861997, 'f1-score': 0.4157490353203647, 'support': 114817}, '2': {'precision': 0.33853642618225327, 'recall': 0.08610457877991423, 'f1-score': 0.1372902571228488, 'support': 144580}, 'accuracy': 0.2958802419970169, 'macro avg': {'precision': 0.3283416401522247, 'recall': 0.3311278801335526, 'f1-score': 0.24148164723778373, 'support': 406286}, 'weighted avg': {'precision': 0.33198624866139687, 'recall': 0.2958802419970169, 'f1-score': 0.22831721196113341, 'support': 406286}}
[[ 16451 117026  13412]
 [ 12593  91312  10912]
 [ 16021 116110  12449]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987662
{'0': {'precision': 0.40850277264325324, 'recall': 0.12022537400427434, 'f1-score': 0.18577561619982588, 'support': 25735}, '1': {'precision': 0.3387091561358715, 'recall': 0.843019748220247, 'f1-score': 0.4832555190500893, 'support': 24863}, '2': {'precision': 0.37371561153463706, 'recall': 0.09059135465209706, 'f1-score': 0.14583198603117117, 'support': 24892}, 'accuracy': 0.3485097363889257, 'macro avg': {'precision': 0.3736425134379206, 'recall': 0.35127882562553947, 'f1-score': 0.2716210404270288, 'support': 75490}, 'weighted avg': {'precision': 0.37404521930455004, 'recall': 0.3485097363889257, 'f1-score': 0.2705811001368764, 'support': 75490}}
[[ 3094 20609  2032]
 [ 2156 20960  1747]
 [ 2324 20313  2255]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0979367
{'0': {'precision': 0.31456953642384106, 'recall': 0.10423333638109171, 'f1-score': 0.15658265229036467, 'support': 10937}, '1': {'precision': 0.35272226563953707, 'recall': 0.8099470176038284, 'f1-score': 0.4914318305550515, 'support': 11702}, '2': {'precision': 0.34487583071003847, 'recall': 0.0920205319645357, 'f1-score': 0.14527773684986003, 'support': 10715}, 'accuracy': 0.34790429933441264, 'macro avg': {'precision': 0.3373892109244722, 'recall': 0.33540029531648524, 'f1-score': 0.2644307398984254, 'support': 33354}, 'weighted avg': {'precision': 0.3376910564981554, 'recall': 0.34790429933441264, 'f1-score': 0.27043025423041256, 'support': 33354}}
[[1140 8838  959]
 [1310 9478  914]
 [1174 8555  986]]
training model: results/CHTR/W10/deepVOL_L2/h200
Epoch 1/50
295/295 - 11s - loss: 3.3288 - accuracy200: 0.3588 - val_loss: 3.4933 - val_accuracy200: 0.3529 - 11s/epoch - 39ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3164 - accuracy200: 0.3624 - val_loss: 3.4565 - val_accuracy200: 0.3552 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3111 - accuracy200: 0.3589 - val_loss: 3.3983 - val_accuracy200: 0.3555 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.3059 - accuracy200: 0.3563 - val_loss: 3.3385 - val_accuracy200: 0.3557 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.3021 - accuracy200: 0.3566 - val_loss: 3.3349 - val_accuracy200: 0.3556 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2979 - accuracy200: 0.3580 - val_loss: 3.3573 - val_accuracy200: 0.3542 - 9s/epoch - 30ms/step
Epoch 7/50
295/295 - 9s - loss: 3.3016 - accuracy200: 0.3529 - val_loss: 3.3020 - val_accuracy200: 0.3544 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2980 - accuracy200: 0.3464 - val_loss: 3.2984 - val_accuracy200: 0.3545 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2976 - accuracy200: 0.3433 - val_loss: 3.2989 - val_accuracy200: 0.3531 - 9s/epoch - 29ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2950 - accuracy200: 0.3447 - val_loss: 3.2997 - val_accuracy200: 0.3526 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2945 - accuracy200: 0.3458 - val_loss: 3.2978 - val_accuracy200: 0.3530 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 13s - loss: 3.2928 - accuracy200: 0.3476 - val_loss: 3.2972 - val_accuracy200: 0.3494 - 13s/epoch - 43ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2916 - accuracy200: 0.3493 - val_loss: 3.2960 - val_accuracy200: 0.3519 - 9s/epoch - 31ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2904 - accuracy200: 0.3507 - val_loss: 3.2984 - val_accuracy200: 0.3518 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2888 - accuracy200: 0.3510 - val_loss: 3.2993 - val_accuracy200: 0.3514 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2878 - accuracy200: 0.3512 - val_loss: 3.2969 - val_accuracy200: 0.3512 - 9s/epoch - 29ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2859 - accuracy200: 0.3544 - val_loss: 3.2977 - val_accuracy200: 0.3520 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2840 - accuracy200: 0.3559 - val_loss: 3.2980 - val_accuracy200: 0.3526 - 9s/epoch - 31ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2839 - accuracy200: 0.3567 - val_loss: 3.3003 - val_accuracy200: 0.3518 - 9s/epoch - 31ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2822 - accuracy200: 0.3562 - val_loss: 3.3008 - val_accuracy200: 0.3501 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2804 - accuracy200: 0.3578 - val_loss: 3.3008 - val_accuracy200: 0.3529 - 9s/epoch - 31ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2792 - accuracy200: 0.3601 - val_loss: 3.3056 - val_accuracy200: 0.3507 - 9s/epoch - 30ms/step
Epoch 23/50
295/295 - 9s - loss: 3.2775 - accuracy200: 0.3613 - val_loss: 3.3039 - val_accuracy200: 0.3511 - 9s/epoch - 31ms/step
testing model: results/CHTR/W10/deepVOL_L2/h200
Evaluating performance on  test set...
1588/1588 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129402
{'0': {'precision': 0.34881112606550024, 'recall': 0.042643630878925, 'f1-score': 0.0759963834518486, 'support': 145860}, '1': {'precision': 0.28073360107095047, 'recall': 0.9105229337084702, 'f1-score': 0.4291508580643313, 'support': 115158}, '2': {'precision': 0.31550086933262006, 'recall': 0.03247790291048269, 'f1-score': 0.058893285566276786, 'support': 145268}, 'accuracy': 0.2850012060469718, 'macro avg': {'precision': 0.3150151988230236, 'recall': 0.3285481558326259, 'f1-score': 0.18801350902748556, 'support': 406286}, 'weighted avg': {'precision': 0.31760506432969243, 'recall': 0.2850012060469718, 'f1-score': 0.1699795139652875, 'support': 406286}}
[[  6220 134460   5180]
 [  5248 104854   5056]
 [  6364 134186   4718]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004765
{'0': {'precision': 0.4165267047363117, 'recall': 0.05002218726047844, 'f1-score': 0.08931787077720954, 'support': 24789}, '1': {'precision': 0.3338782821318397, 'recall': 0.9407947444319821, 'f1-score': 0.49284942344213956, 'support': 24964}, '2': {'precision': 0.43317972350230416, 'recall': 0.03652329331312896, 'f1-score': 0.06736661052782457, 'support': 25737}, 'accuracy': 0.3399920519274076, 'macro avg': {'precision': 0.39452823679015186, 'recall': 0.3424467416685298, 'f1-score': 0.2165113015823912, 'support': 75490}, 'weighted avg': {'precision': 0.3948730224218635, 'recall': 0.3399920519274076, 'f1-score': 0.21527895298265257, 'support': 75490}}
[[ 1240 22958   591]
 [  839 23486   639]
 [  898 23899   940]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987049
{'0': {'precision': 0.26970108695652173, 'recall': 0.0379795274083995, 'f1-score': 0.06658280922431865, 'support': 10453}, '1': {'precision': 0.35474552064398857, 'recall': 0.9118137827465377, 'f1-score': 0.5107725382062905, 'support': 11986}, '2': {'precision': 0.3472998137802607, 'recall': 0.034173156207054516, 'f1-score': 0.062223705062974394, 'support': 10915}, 'accuracy': 0.35075253342927387, 'macro avg': {'precision': 0.3239154737935903, 'recall': 0.3279888221206639, 'f1-score': 0.2131930174978612, 'support': 33354}, 'weighted avg': {'precision': 0.32565637524155766, 'recall': 0.35075253342927387, 'f1-score': 0.2247790816251354, 'support': 33354}}
[[  397  9762   294]
 [  650 10929   407]
 [  425 10117   373]]
training model: results/CHTR/W10/deepVOL_L2/h300
Epoch 1/50
295/295 - 11s - loss: 3.3290 - accuracy300: 0.3646 - val_loss: 3.7682 - val_accuracy300: 0.3590 - 11s/epoch - 38ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3176 - accuracy300: 0.3591 - val_loss: 3.4049 - val_accuracy300: 0.3603 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3121 - accuracy300: 0.3558 - val_loss: 3.3503 - val_accuracy300: 0.3604 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.3035 - accuracy300: 0.3497 - val_loss: 3.3013 - val_accuracy300: 0.3582 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2964 - accuracy300: 0.3487 - val_loss: 3.2973 - val_accuracy300: 0.3572 - 9s/epoch - 31ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2968 - accuracy300: 0.3467 - val_loss: 3.2949 - val_accuracy300: 0.3573 - 9s/epoch - 31ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2946 - accuracy300: 0.3508 - val_loss: 3.2949 - val_accuracy300: 0.3563 - 9s/epoch - 31ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2961 - accuracy300: 0.3443 - val_loss: 3.2944 - val_accuracy300: 0.3565 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2958 - accuracy300: 0.3460 - val_loss: 3.2937 - val_accuracy300: 0.3574 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2956 - accuracy300: 0.3462 - val_loss: 3.2938 - val_accuracy300: 0.3559 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2955 - accuracy300: 0.3456 - val_loss: 3.2942 - val_accuracy300: 0.3564 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2940 - accuracy300: 0.3491 - val_loss: 3.2927 - val_accuracy300: 0.3568 - 9s/epoch - 30ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2928 - accuracy300: 0.3530 - val_loss: 3.3012 - val_accuracy300: 0.3556 - 9s/epoch - 30ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2933 - accuracy300: 0.3535 - val_loss: 3.2936 - val_accuracy300: 0.3554 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2929 - accuracy300: 0.3492 - val_loss: 3.2928 - val_accuracy300: 0.3554 - 9s/epoch - 30ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2889 - accuracy300: 0.3549 - val_loss: 3.2954 - val_accuracy300: 0.3557 - 9s/epoch - 29ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2881 - accuracy300: 0.3582 - val_loss: 3.2937 - val_accuracy300: 0.3555 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2862 - accuracy300: 0.3586 - val_loss: 3.2959 - val_accuracy300: 0.3538 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2835 - accuracy300: 0.3606 - val_loss: 3.3009 - val_accuracy300: 0.3549 - 9s/epoch - 30ms/step
Epoch 20/50
295/295 - 9s - loss: 3.2822 - accuracy300: 0.3633 - val_loss: 3.3020 - val_accuracy300: 0.3557 - 9s/epoch - 30ms/step
Epoch 21/50
295/295 - 9s - loss: 3.2816 - accuracy300: 0.3655 - val_loss: 3.3022 - val_accuracy300: 0.3538 - 9s/epoch - 30ms/step
Epoch 22/50
295/295 - 9s - loss: 3.2792 - accuracy300: 0.3650 - val_loss: 3.3044 - val_accuracy300: 0.3555 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h300
Evaluating performance on  test set...
1588/1588 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1090308
{'0': {'precision': 0.3675607711651299, 'recall': 0.01799909696662881, 'f1-score': 0.034317689719041033, 'support': 146174}, '1': {'precision': 0.28722980223823397, 'recall': 0.9641331755261668, 'f1-score': 0.44260184496178967, 'support': 116598}, '2': {'precision': 0.35480123902942695, 'recall': 0.01915492565185278, 'f1-score': 0.036347529452208746, 'support': 143514}, 'accuracy': 0.28993369202975244, 'macro avg': {'precision': 0.33653060414426356, 'recall': 0.3337623993815495, 'f1-score': 0.1710890213776798, 'support': 406286}, 'weighted avg': {'precision': 0.3399998859516067, 'recall': 0.28993369202975244, 'f1-score': 0.15220613862562368, 'support': 406286}}
[[  2631 140680   2863]
 [  2046 112416   2136]
 [  2481 138284   2749]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006175
{'0': {'precision': 0.394392523364486, 'recall': 0.017456771738231156, 'f1-score': 0.03343368721280304, 'support': 24174}, '1': {'precision': 0.33229049974043007, 'recall': 0.9761608540353975, 'f1-score': 0.4958059420068287, 'support': 24917}, '2': {'precision': 0.4206219312602291, 'recall': 0.019470434486154778, 'f1-score': 0.03721805872343507, 'support': 26399}, 'accuracy': 0.33460060935223207, 'macro avg': {'precision': 0.3824349847883817, 'recall': 0.33769602008659444, 'f1-score': 0.1888192293143556, 'support': 75490}, 'weighted avg': {'precision': 0.3830669705283371, 'recall': 0.33460060935223207, 'f1-score': 0.1873723956008268, 'support': 75490}}
[[  422 23379   373]
 [  259 24323   335]
 [  389 25496   514]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975672
{'0': {'precision': 0.261101243339254, 'recall': 0.01448989650073928, 'f1-score': 0.027456107583115428, 'support': 10145}, '1': {'precision': 0.3594482930011494, 'recall': 0.9603286579799154, 'f1-score': 0.5231012658227848, 'support': 12049}, '2': {'precision': 0.29, 'recall': 0.015591397849462365, 'f1-score': 0.02959183673469388, 'support': 11160}, 'accuracy': 0.35653894585357077, 'macro avg': {'precision': 0.3035165121134678, 'recall': 0.3301366507767057, 'f1-score': 0.19338307004686472, 'support': 33354}, 'weighted avg': {'precision': 0.30629803310090487, 'recall': 0.35653894585357077, 'f1-score': 0.2072205510969786, 'support': 33354}}
[[  147  9808   190]
 [  242 11571   236]
 [  174 10812   174]]
training model: results/CHTR/W10/deepVOL_L2/h500
Epoch 1/50
295/295 - 12s - loss: 3.3250 - accuracy500: 0.3667 - val_loss: 3.6768 - val_accuracy500: 0.3585 - 12s/epoch - 39ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3102 - accuracy500: 0.3643 - val_loss: 3.5409 - val_accuracy500: 0.3600 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3155 - accuracy500: 0.3535 - val_loss: 3.3237 - val_accuracy500: 0.3609 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.3019 - accuracy500: 0.3539 - val_loss: 3.5177 - val_accuracy500: 0.3601 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.3106 - accuracy500: 0.3545 - val_loss: 3.2968 - val_accuracy500: 0.3597 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2970 - accuracy500: 0.3475 - val_loss: 3.2963 - val_accuracy500: 0.3590 - 9s/epoch - 30ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2956 - accuracy500: 0.3510 - val_loss: 3.2956 - val_accuracy500: 0.3597 - 9s/epoch - 30ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2949 - accuracy500: 0.3503 - val_loss: 3.2970 - val_accuracy500: 0.3591 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2934 - accuracy500: 0.3502 - val_loss: 3.2950 - val_accuracy500: 0.3596 - 9s/epoch - 30ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2912 - accuracy500: 0.3544 - val_loss: 3.2964 - val_accuracy500: 0.3592 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2893 - accuracy500: 0.3561 - val_loss: 3.2994 - val_accuracy500: 0.3586 - 9s/epoch - 31ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2884 - accuracy500: 0.3571 - val_loss: 3.2983 - val_accuracy500: 0.3593 - 9s/epoch - 30ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2868 - accuracy500: 0.3601 - val_loss: 3.2992 - val_accuracy500: 0.3581 - 9s/epoch - 30ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2843 - accuracy500: 0.3605 - val_loss: 3.2993 - val_accuracy500: 0.3588 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2845 - accuracy500: 0.3582 - val_loss: 3.2999 - val_accuracy500: 0.3570 - 9s/epoch - 29ms/step
Epoch 16/50
295/295 - 9s - loss: 3.2862 - accuracy500: 0.3603 - val_loss: 3.2992 - val_accuracy500: 0.3591 - 9s/epoch - 30ms/step
Epoch 17/50
295/295 - 9s - loss: 3.2817 - accuracy500: 0.3616 - val_loss: 3.3086 - val_accuracy500: 0.3587 - 9s/epoch - 30ms/step
Epoch 18/50
295/295 - 9s - loss: 3.2827 - accuracy500: 0.3627 - val_loss: 3.3005 - val_accuracy500: 0.3592 - 9s/epoch - 30ms/step
Epoch 19/50
295/295 - 9s - loss: 3.2799 - accuracy500: 0.3634 - val_loss: 3.3023 - val_accuracy500: 0.3588 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h500
Evaluating performance on  test set...
1588/1588 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1096699
{'0': {'precision': 0.3960597826086957, 'recall': 0.00408560856646297, 'f1-score': 0.008087786471338995, 'support': 142696}, '1': {'precision': 0.3032984855348682, 'recall': 0.9870652439521056, 'f1-score': 0.4640170624352644, 'support': 122770}, '2': {'precision': 0.3789633567495728, 'recall': 0.014174122993892913, 'f1-score': 0.02732618234339811, 'support': 140820}, 'accuracy': 0.30461546792161187, 'macro avg': {'precision': 0.35944054163104555, 'recall': 0.3351083251708205, 'f1-score': 0.16647701041666718, 'support': 406286}, 'weighted avg': {'precision': 0.3621038423812808, 'recall': 0.30461546792161187, 'f1-score': 0.15252689615465195, 'support': 406286}}
[[   583 140087   2026]
 [   343 121182   1245]
 [   546 138278   1996]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033384
{'0': {'precision': 0.356, 'recall': 0.0037363560033585224, 'f1-score': 0.007395097631906938, 'support': 23820}, '1': {'precision': 0.33015215871821063, 'recall': 0.98841046277666, 'f1-score': 0.4949720895552465, 'support': 24850}, '2': {'precision': 0.43009478672985785, 'recall': 0.013534675615212528, 'f1-score': 0.026243493348756506, 'support': 26820}, 'accuracy': 0.3313551463770036, 'macro avg': {'precision': 0.3720823151493562, 'recall': 0.33522716479841036, 'f1-score': 0.17620356017863667, 'support': 75490}, 'weighted avg': {'precision': 0.3738156487513885, 'recall': 0.3313551463770036, 'f1-score': 0.1745934314830249, 'support': 75490}}
[[   89 23476   255]
 [   62 24562   226]
 [   99 26358   363]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977542
{'0': {'precision': 0.3333333333333333, 'recall': 0.0035541514463421856, 'f1-score': 0.007033310540197323, 'support': 10129}, '1': {'precision': 0.3608617594254937, 'recall': 0.9847214149298348, 'f1-score': 0.528169955017147, 'support': 12043}, '2': {'precision': 0.3237597911227154, 'recall': 0.01108925058129136, 'f1-score': 0.021444012105490705, 'support': 11182}, 'accuracy': 0.36034658511722734, 'macro avg': {'precision': 0.3393182946271808, 'recall': 0.33312160565248944, 'f1-score': 0.18554909255427834, 'support': 33354}, 'weighted avg': {'precision': 0.34006336530637277, 'recall': 0.36034658511722734, 'f1-score': 0.20002932524125314, 'support': 33354}}
[[   36  9978   115]
 [   40 11859   144]
 [   32 11026   124]]
training model: results/CHTR/W10/deepVOL_L2/h1000
Epoch 1/50
295/295 - 11s - loss: 3.3475 - accuracy1000: 0.3616 - val_loss: 3.4605 - val_accuracy1000: 0.3418 - 11s/epoch - 37ms/step
Epoch 2/50
295/295 - 9s - loss: 3.3237 - accuracy1000: 0.3609 - val_loss: 3.3847 - val_accuracy1000: 0.3428 - 9s/epoch - 31ms/step
Epoch 3/50
295/295 - 9s - loss: 3.3157 - accuracy1000: 0.3465 - val_loss: 3.3136 - val_accuracy1000: 0.3454 - 9s/epoch - 30ms/step
Epoch 4/50
295/295 - 9s - loss: 3.3051 - accuracy1000: 0.3430 - val_loss: 3.3000 - val_accuracy1000: 0.3465 - 9s/epoch - 30ms/step
Epoch 5/50
295/295 - 9s - loss: 3.2974 - accuracy1000: 0.3479 - val_loss: 3.2988 - val_accuracy1000: 0.3485 - 9s/epoch - 30ms/step
Epoch 6/50
295/295 - 9s - loss: 3.2942 - accuracy1000: 0.3515 - val_loss: 3.3005 - val_accuracy1000: 0.3489 - 9s/epoch - 30ms/step
Epoch 7/50
295/295 - 9s - loss: 3.2927 - accuracy1000: 0.3523 - val_loss: 3.3006 - val_accuracy1000: 0.3489 - 9s/epoch - 31ms/step
Epoch 8/50
295/295 - 9s - loss: 3.2904 - accuracy1000: 0.3563 - val_loss: 3.2998 - val_accuracy1000: 0.3492 - 9s/epoch - 30ms/step
Epoch 9/50
295/295 - 9s - loss: 3.2870 - accuracy1000: 0.3598 - val_loss: 3.3026 - val_accuracy1000: 0.3469 - 9s/epoch - 31ms/step
Epoch 10/50
295/295 - 9s - loss: 3.2839 - accuracy1000: 0.3615 - val_loss: 3.3023 - val_accuracy1000: 0.3498 - 9s/epoch - 30ms/step
Epoch 11/50
295/295 - 9s - loss: 3.2815 - accuracy1000: 0.3651 - val_loss: 3.3027 - val_accuracy1000: 0.3497 - 9s/epoch - 30ms/step
Epoch 12/50
295/295 - 9s - loss: 3.2789 - accuracy1000: 0.3665 - val_loss: 3.3036 - val_accuracy1000: 0.3499 - 9s/epoch - 30ms/step
Epoch 13/50
295/295 - 9s - loss: 3.2776 - accuracy1000: 0.3670 - val_loss: 3.3037 - val_accuracy1000: 0.3496 - 9s/epoch - 29ms/step
Epoch 14/50
295/295 - 9s - loss: 3.2759 - accuracy1000: 0.3697 - val_loss: 3.3142 - val_accuracy1000: 0.3490 - 9s/epoch - 30ms/step
Epoch 15/50
295/295 - 9s - loss: 3.2739 - accuracy1000: 0.3737 - val_loss: 3.3058 - val_accuracy1000: 0.3491 - 9s/epoch - 30ms/step
testing model: results/CHTR/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
1588/1588 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035957
{'0': {'precision': 0.36606208580397626, 'recall': 0.014601840708457102, 'f1-score': 0.02808346099556471, 'support': 143749}, '1': {'precision': 0.3108047921071177, 'recall': 0.8870670582082948, 'f1-score': 0.4603241866630484, 'support': 124295}, '2': {'precision': 0.37022400768525393, 'recall': 0.12266170917666122, 'f1-score': 0.18427115255047705, 'support': 138242}, 'accuracy': 0.31828317982898746, 'macro avg': {'precision': 0.34903029519878265, 'recall': 0.3414435360311377, 'f1-score': 0.2242262667363634, 'support': 406286}, 'weighted avg': {'precision': 0.35057335885955915, 'recall': 0.31828317982898746, 'f1-score': 0.21346287316525325, 'support': 406286}}
[[  2099 125343  16307]
 [  1499 110258  12538]
 [  2136 119149  16957]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994244
{'0': {'precision': 0.2955508474576271, 'recall': 0.011836578846888126, 'f1-score': 0.02276157454619621, 'support': 23571}, '1': {'precision': 0.33517484485388865, 'recall': 0.9124264172244174, 'f1-score': 0.49025661023191325, 'support': 24802}, '2': {'precision': 0.4199743918053777, 'recall': 0.10886159973448391, 'f1-score': 0.17290458618871904, 'support': 27117}, 'accuracy': 0.34257517551993644, 'macro avg': {'precision': 0.3502333613722978, 'recall': 0.3443748652685965, 'f1-score': 0.2286409236556095, 'support': 75490}, 'weighted avg': {'precision': 0.3532637582471361, 'recall': 0.34257517551993644, 'f1-score': 0.23028892812663665, 'support': 75490}}
[[  279 21094  2198]
 [  293 22630  1879]
 [  372 23793  2952]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991144
{'0': {'precision': 0.30445544554455445, 'recall': 0.01190015479876161, 'f1-score': 0.022905027932960894, 'support': 10336}, '1': {'precision': 0.34616680140123957, 'recall': 0.8919458427356362, 'f1-score': 0.4987624363018685, 'support': 11522}, '2': {'precision': 0.36756591048436543, 'recall': 0.10429714683368128, 'f1-score': 0.16248814202466458, 'support': 11496}, 'accuracy': 0.3477543922767884, 'macro avg': {'precision': 0.33939605247671983, 'recall': 0.3360477147893597, 'f1-score': 0.22805186875316463, 'support': 33354}, 'weighted avg': {'precision': 0.3406165100983949, 'recall': 0.3477543922767884, 'f1-score': 0.23539757871621864, 'support': 33354}}
[[  123  9262   951]
 [  133 10277  1112]
 [  148 10149  1199]]
training model: results/CHTR/W10/deepVOL_L3/h10
Epoch 1/50
295/295 - 15s - loss: 3.3177 - accuracy10: 0.3618 - val_loss: 3.4449 - val_accuracy10: 0.3417 - 15s/epoch - 52ms/step
Epoch 2/50
295/295 - 13s - loss: 3.3042 - accuracy10: 0.3610 - val_loss: 3.4082 - val_accuracy10: 0.3453 - 13s/epoch - 45ms/step
Epoch 3/50
295/295 - 13s - loss: 3.2974 - accuracy10: 0.3581 - val_loss: 3.3866 - val_accuracy10: 0.3449 - 13s/epoch - 45ms/step
Epoch 4/50
295/295 - 13s - loss: 3.2954 - accuracy10: 0.3572 - val_loss: 3.3151 - val_accuracy10: 0.3455 - 13s/epoch - 45ms/step
Epoch 5/50
295/295 - 13s - loss: 3.2975 - accuracy10: 0.3518 - val_loss: 3.3006 - val_accuracy10: 0.3456 - 13s/epoch - 45ms/step
Epoch 6/50
295/295 - 13s - loss: 3.2864 - accuracy10: 0.3606 - val_loss: 3.3368 - val_accuracy10: 0.3453 - 13s/epoch - 44ms/step
Epoch 7/50
295/295 - 13s - loss: 3.2907 - accuracy10: 0.3590 - val_loss: 3.2943 - val_accuracy10: 0.3465 - 13s/epoch - 44ms/step
Epoch 8/50
295/295 - 13s - loss: 3.2883 - accuracy10: 0.3579 - val_loss: 3.2989 - val_accuracy10: 0.3526 - 13s/epoch - 43ms/step
Epoch 9/50
295/295 - 13s - loss: 3.2886 - accuracy10: 0.3604 - val_loss: 3.2823 - val_accuracy10: 0.3697 - 13s/epoch - 42ms/step
Epoch 10/50
295/295 - 13s - loss: 3.2839 - accuracy10: 0.3654 - val_loss: 3.2728 - val_accuracy10: 0.3782 - 13s/epoch - 43ms/step
Epoch 11/50
295/295 - 13s - loss: 3.2771 - accuracy10: 0.3694 - val_loss: 3.2828 - val_accuracy10: 0.3688 - 13s/epoch - 43ms/step
Epoch 12/50
295/295 - 12s - loss: 3.2834 - accuracy10: 0.3649 - val_loss: 3.2728 - val_accuracy10: 0.3774 - 12s/epoch - 42ms/step
Epoch 13/50
295/295 - 12s - loss: 3.2783 - accuracy10: 0.3702 - val_loss: 3.2733 - val_accuracy10: 0.3732 - 12s/epoch - 42ms/step
Epoch 14/50
295/295 - 13s - loss: 3.2762 - accuracy10: 0.3728 - val_loss: 3.2751 - val_accuracy10: 0.3642 - 13s/epoch - 44ms/step
Epoch 15/50
295/295 - 13s - loss: 3.2748 - accuracy10: 0.3746 - val_loss: 3.2675 - val_accuracy10: 0.3758 - 13s/epoch - 45ms/step
Epoch 16/50
295/295 - 13s - loss: 3.2684 - accuracy10: 0.3770 - val_loss: 3.2746 - val_accuracy10: 0.3741 - 13s/epoch - 45ms/step
Epoch 17/50
295/295 - 13s - loss: 3.2673 - accuracy10: 0.3798 - val_loss: 3.2639 - val_accuracy10: 0.3834 - 13s/epoch - 45ms/step
Epoch 18/50
295/295 - 13s - loss: 3.2605 - accuracy10: 0.3822 - val_loss: 3.2658 - val_accuracy10: 0.3776 - 13s/epoch - 44ms/step
Epoch 19/50
295/295 - 13s - loss: 3.2629 - accuracy10: 0.3798 - val_loss: 3.2919 - val_accuracy10: 0.3551 - 13s/epoch - 44ms/step
Epoch 20/50
295/295 - 13s - loss: 3.2577 - accuracy10: 0.3832 - val_loss: 3.2894 - val_accuracy10: 0.3576 - 13s/epoch - 45ms/step
Epoch 21/50
295/295 - 13s - loss: 3.2549 - accuracy10: 0.3830 - val_loss: 3.2673 - val_accuracy10: 0.3673 - 13s/epoch - 44ms/step
Epoch 22/50
295/295 - 13s - loss: 3.2526 - accuracy10: 0.3869 - val_loss: 3.2507 - val_accuracy10: 0.3892 - 13s/epoch - 45ms/step
Epoch 23/50
295/295 - 13s - loss: 3.2471 - accuracy10: 0.3878 - val_loss: 3.2671 - val_accuracy10: 0.3770 - 13s/epoch - 44ms/step
Epoch 24/50
295/295 - 13s - loss: 3.2454 - accuracy10: 0.3890 - val_loss: 3.2673 - val_accuracy10: 0.3797 - 13s/epoch - 45ms/step
Epoch 25/50
295/295 - 13s - loss: 3.2424 - accuracy10: 0.3905 - val_loss: 3.2509 - val_accuracy10: 0.3822 - 13s/epoch - 45ms/step
Epoch 26/50
295/295 - 13s - loss: 3.2400 - accuracy10: 0.3923 - val_loss: 3.2600 - val_accuracy10: 0.3822 - 13s/epoch - 45ms/step
Epoch 27/50
295/295 - 13s - loss: 3.2373 - accuracy10: 0.3930 - val_loss: 3.2559 - val_accuracy10: 0.3784 - 13s/epoch - 44ms/step
Epoch 28/50
295/295 - 13s - loss: 3.2374 - accuracy10: 0.3937 - val_loss: 3.2527 - val_accuracy10: 0.3823 - 13s/epoch - 45ms/step
Epoch 29/50
295/295 - 13s - loss: 3.2338 - accuracy10: 0.3963 - val_loss: 3.2522 - val_accuracy10: 0.3875 - 13s/epoch - 45ms/step
Epoch 30/50
295/295 - 13s - loss: 3.2315 - accuracy10: 0.3946 - val_loss: 3.2769 - val_accuracy10: 0.3599 - 13s/epoch - 45ms/step
Epoch 31/50
295/295 - 13s - loss: 3.2255 - accuracy10: 0.3987 - val_loss: 3.2880 - val_accuracy10: 0.3847 - 13s/epoch - 44ms/step
Epoch 32/50
295/295 - 13s - loss: 3.2253 - accuracy10: 0.3985 - val_loss: 3.2788 - val_accuracy10: 0.3617 - 13s/epoch - 45ms/step
testing model: results/CHTR/W10/deepVOL_L3/h10
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0907589
{'0': {'precision': 0.3779298722291964, 'recall': 0.1568105601141634, 'f1-score': 0.221652941740082, 'support': 140150}, '1': {'precision': 0.3556047285848135, 'recall': 0.7056417478262933, 'f1-score': 0.4728958781799095, 'support': 126397}, '2': {'precision': 0.38176120016440607, 'recall': 0.2658742369703519, 'f1-score': 0.3134493944545451, 'support': 139739}, 'accuracy': 0.36506549573453184, 'macro avg': {'precision': 0.3717652669928053, 'recall': 0.37610884830360286, 'f1-score': 0.3359994047915122, 'support': 406286}, 'weighted avg': {'precision': 0.37230219801231274, 'recall': 0.36506549573453184, 'f1-score': 0.3313881970603521, 'support': 406286}}
[[21977 81235 36938]
 [13977 89191 23229]
 [22197 80389 37153]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0864353
{'0': {'precision': 0.39223338862328033, 'recall': 0.1544015977876786, 'f1-score': 0.22157916494419178, 'support': 26036}, '1': {'precision': 0.37981315490468376, 'recall': 0.7255516700832026, 'f1-score': 0.4986119743111663, 'support': 24879}, '2': {'precision': 0.38385548969799604, 'recall': 0.2767039674465921, 'f1-score': 0.32158902813904, 'support': 24575}, 'accuracy': 0.38244800635845805, 'macro avg': {'precision': 0.38530067774198673, 'recall': 0.3855524117724911, 'f1-score': 0.3472600557981327, 'support': 75490}, 'weighted avg': {'precision': 0.385412751972415, 'recall': 0.38244800635845805, 'f1-score': 0.3454371812676036, 'support': 75490}}
[[ 4020 15447  6569]
 [ 2482 18051  4346]
 [ 3747 14028  6800]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841024
{'0': {'precision': 0.38005748397081585, 'recall': 0.15201627166607712, 'f1-score': 0.21716884593519045, 'support': 11308}, '1': {'precision': 0.39722852590410895, 'recall': 0.7142113030645021, 'f1-score': 0.5105181507911883, 'support': 11519}, '2': {'precision': 0.3610837438423645, 'recall': 0.27852189607675504, 'f1-score': 0.31447417815198153, 'support': 10527}, 'accuracy': 0.3861006176170774, 'macro avg': {'precision': 0.3794565845724298, 'recall': 0.3815831569357781, 'f1-score': 0.34738705829278677, 'support': 33354}, 'weighted avg': {'precision': 0.37999922018528476, 'recall': 0.3861006176170774, 'f1-score': 0.34918970924640946, 'support': 33354}}
[[1719 6499 3090]
 [1194 8227 2098]
 [1610 5985 2932]]
training model: results/CHTR/W10/deepVOL_L3/h20
Epoch 1/50
295/295 - 15s - loss: 3.3146 - accuracy20: 0.3662 - val_loss: 3.4890 - val_accuracy20: 0.3387 - 15s/epoch - 51ms/step
Epoch 2/50
295/295 - 12s - loss: 3.2951 - accuracy20: 0.3649 - val_loss: 3.5068 - val_accuracy20: 0.3381 - 12s/epoch - 42ms/step
Epoch 3/50
295/295 - 13s - loss: 3.2991 - accuracy20: 0.3628 - val_loss: 3.4276 - val_accuracy20: 0.3393 - 13s/epoch - 43ms/step
Epoch 4/50
295/295 - 12s - loss: 3.2878 - accuracy20: 0.3666 - val_loss: 3.4361 - val_accuracy20: 0.3397 - 12s/epoch - 42ms/step
Epoch 5/50
295/295 - 12s - loss: 3.2912 - accuracy20: 0.3639 - val_loss: 3.3568 - val_accuracy20: 0.3392 - 12s/epoch - 42ms/step
Epoch 6/50
295/295 - 12s - loss: 3.2929 - accuracy20: 0.3549 - val_loss: 3.3018 - val_accuracy20: 0.3517 - 12s/epoch - 42ms/step
Epoch 7/50
295/295 - 13s - loss: 3.2918 - accuracy20: 0.3555 - val_loss: 3.2949 - val_accuracy20: 0.3580 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 12s - loss: 3.2866 - accuracy20: 0.3607 - val_loss: 3.2859 - val_accuracy20: 0.3625 - 12s/epoch - 42ms/step
Epoch 9/50
295/295 - 13s - loss: 3.2863 - accuracy20: 0.3611 - val_loss: 3.2908 - val_accuracy20: 0.3609 - 13s/epoch - 42ms/step
Epoch 10/50
295/295 - 13s - loss: 3.2858 - accuracy20: 0.3624 - val_loss: 3.2830 - val_accuracy20: 0.3683 - 13s/epoch - 43ms/step
Epoch 11/50
295/295 - 12s - loss: 3.2827 - accuracy20: 0.3639 - val_loss: 3.2823 - val_accuracy20: 0.3686 - 12s/epoch - 42ms/step
Epoch 12/50
295/295 - 13s - loss: 3.2827 - accuracy20: 0.3656 - val_loss: 3.2762 - val_accuracy20: 0.3743 - 13s/epoch - 43ms/step
Epoch 13/50
295/295 - 12s - loss: 3.2782 - accuracy20: 0.3694 - val_loss: 3.2873 - val_accuracy20: 0.3683 - 12s/epoch - 42ms/step
Epoch 14/50
295/295 - 12s - loss: 3.2815 - accuracy20: 0.3665 - val_loss: 3.2791 - val_accuracy20: 0.3680 - 12s/epoch - 42ms/step
Epoch 15/50
295/295 - 12s - loss: 3.2773 - accuracy20: 0.3711 - val_loss: 3.2762 - val_accuracy20: 0.3750 - 12s/epoch - 42ms/step
Epoch 16/50
295/295 - 13s - loss: 3.2758 - accuracy20: 0.3712 - val_loss: 3.2753 - val_accuracy20: 0.3746 - 13s/epoch - 42ms/step
Epoch 17/50
295/295 - 12s - loss: 3.2747 - accuracy20: 0.3752 - val_loss: 3.2732 - val_accuracy20: 0.3768 - 12s/epoch - 42ms/step
Epoch 18/50
295/295 - 12s - loss: 3.2727 - accuracy20: 0.3750 - val_loss: 3.2729 - val_accuracy20: 0.3754 - 12s/epoch - 42ms/step
Epoch 19/50
295/295 - 12s - loss: 3.2695 - accuracy20: 0.3766 - val_loss: 3.2761 - val_accuracy20: 0.3772 - 12s/epoch - 42ms/step
Epoch 20/50
295/295 - 12s - loss: 3.2701 - accuracy20: 0.3774 - val_loss: 3.2758 - val_accuracy20: 0.3758 - 12s/epoch - 41ms/step
Epoch 21/50
295/295 - 12s - loss: 3.2679 - accuracy20: 0.3787 - val_loss: 3.2746 - val_accuracy20: 0.3769 - 12s/epoch - 42ms/step
Epoch 22/50
295/295 - 12s - loss: 3.2642 - accuracy20: 0.3819 - val_loss: 3.2732 - val_accuracy20: 0.3778 - 12s/epoch - 42ms/step
Epoch 23/50
295/295 - 12s - loss: 3.2634 - accuracy20: 0.3820 - val_loss: 3.2675 - val_accuracy20: 0.3790 - 12s/epoch - 42ms/step
Epoch 24/50
295/295 - 13s - loss: 3.2582 - accuracy20: 0.3820 - val_loss: 3.2762 - val_accuracy20: 0.3753 - 13s/epoch - 43ms/step
Epoch 25/50
295/295 - 12s - loss: 3.2593 - accuracy20: 0.3855 - val_loss: 3.2643 - val_accuracy20: 0.3819 - 12s/epoch - 42ms/step
Epoch 26/50
295/295 - 12s - loss: 3.2561 - accuracy20: 0.3889 - val_loss: 3.2686 - val_accuracy20: 0.3806 - 12s/epoch - 42ms/step
Epoch 27/50
295/295 - 12s - loss: 3.2550 - accuracy20: 0.3883 - val_loss: 3.2650 - val_accuracy20: 0.3831 - 12s/epoch - 42ms/step
Epoch 28/50
295/295 - 12s - loss: 3.2538 - accuracy20: 0.3876 - val_loss: 3.2670 - val_accuracy20: 0.3818 - 12s/epoch - 42ms/step
Epoch 29/50
295/295 - 12s - loss: 3.2555 - accuracy20: 0.3896 - val_loss: 3.2629 - val_accuracy20: 0.3836 - 12s/epoch - 42ms/step
Epoch 30/50
295/295 - 12s - loss: 3.2530 - accuracy20: 0.3899 - val_loss: 3.2594 - val_accuracy20: 0.3885 - 12s/epoch - 42ms/step
Epoch 31/50
295/295 - 12s - loss: 3.2483 - accuracy20: 0.3933 - val_loss: 3.2596 - val_accuracy20: 0.3845 - 12s/epoch - 42ms/step
Epoch 32/50
295/295 - 13s - loss: 3.2466 - accuracy20: 0.3928 - val_loss: 3.2550 - val_accuracy20: 0.3853 - 13s/epoch - 42ms/step
Epoch 33/50
295/295 - 13s - loss: 3.2456 - accuracy20: 0.3960 - val_loss: 3.2566 - val_accuracy20: 0.3845 - 13s/epoch - 42ms/step
Epoch 34/50
295/295 - 12s - loss: 3.2421 - accuracy20: 0.3972 - val_loss: 3.2573 - val_accuracy20: 0.3874 - 12s/epoch - 42ms/step
Epoch 35/50
295/295 - 13s - loss: 3.2431 - accuracy20: 0.3972 - val_loss: 3.2528 - val_accuracy20: 0.3865 - 13s/epoch - 43ms/step
Epoch 36/50
295/295 - 12s - loss: 3.2366 - accuracy20: 0.3996 - val_loss: 3.2679 - val_accuracy20: 0.3823 - 12s/epoch - 41ms/step
Epoch 37/50
295/295 - 12s - loss: 3.2421 - accuracy20: 0.3961 - val_loss: 3.2585 - val_accuracy20: 0.3848 - 12s/epoch - 42ms/step
Epoch 38/50
295/295 - 13s - loss: 3.2352 - accuracy20: 0.4008 - val_loss: 3.2563 - val_accuracy20: 0.3861 - 13s/epoch - 43ms/step
Epoch 39/50
295/295 - 12s - loss: 3.2351 - accuracy20: 0.3983 - val_loss: 3.2634 - val_accuracy20: 0.3829 - 12s/epoch - 42ms/step
Epoch 40/50
295/295 - 12s - loss: 3.2341 - accuracy20: 0.4013 - val_loss: 3.2559 - val_accuracy20: 0.3869 - 12s/epoch - 42ms/step
Epoch 41/50
295/295 - 12s - loss: 3.2282 - accuracy20: 0.4044 - val_loss: 3.2655 - val_accuracy20: 0.3837 - 12s/epoch - 42ms/step
Epoch 42/50
295/295 - 12s - loss: 3.2316 - accuracy20: 0.4030 - val_loss: 3.2541 - val_accuracy20: 0.3863 - 12s/epoch - 42ms/step
Epoch 43/50
295/295 - 12s - loss: 3.2258 - accuracy20: 0.4073 - val_loss: 3.2537 - val_accuracy20: 0.3882 - 12s/epoch - 42ms/step
Epoch 44/50
295/295 - 12s - loss: 3.2246 - accuracy20: 0.4076 - val_loss: 3.2583 - val_accuracy20: 0.3895 - 12s/epoch - 42ms/step
Epoch 45/50
295/295 - 13s - loss: 3.2229 - accuracy20: 0.4075 - val_loss: 3.2538 - val_accuracy20: 0.3866 - 13s/epoch - 42ms/step
testing model: results/CHTR/W10/deepVOL_L3/h20
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0937676
{'0': {'precision': 0.37211829655282336, 'recall': 0.1825724076154185, 'f1-score': 0.2449600572314296, 'support': 140662}, '1': {'precision': 0.3464695295665297, 'recall': 0.6836803758410638, 'f1-score': 0.4598833955098968, 'support': 125585}, '2': {'precision': 0.39056998177936264, 'recall': 0.24950192446389935, 'f1-score': 0.30449067094266613, 'support': 140039}, 'accuracy': 0.36053666628926423, 'macro avg': {'precision': 0.3697192692995719, 'recall': 0.3719182359734605, 'f1-score': 0.3364447078946642, 'support': 406286}, 'weighted avg': {'precision': 0.3705500789560212, 'recall': 0.36053666628926423, 'f1-score': 0.3319129796831241, 'support': 406286}}
[[25681 81977 33004]
 [18210 85860 21515]
 [25122 79977 34940]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0851868
{'0': {'precision': 0.40066846009619306, 'recall': 0.1877100519401161, 'f1-score': 0.25565004811318304, 'support': 26184}, '1': {'precision': 0.3803682281404267, 'recall': 0.7215836012861736, 'f1-score': 0.4981478655364252, 'support': 24880}, '2': {'precision': 0.39852720918622064, 'recall': 0.261442724965201, 'f1-score': 0.3157478368355995, 'support': 24426}, 'accuracy': 0.3875215260299377, 'macro avg': {'precision': 0.39318796580761345, 'recall': 0.3902454593971636, 'f1-score': 0.3565152501617359, 'support': 75490}, 'weighted avg': {'precision': 0.3932850720211307, 'recall': 0.3875215260299377, 'f1-score': 0.3550181006343648, 'support': 75490}}
[[ 4915 15414  5855]
 [ 3144 17953  3783]
 [ 4208 13832  6386]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845717
{'0': {'precision': 0.37735849056603776, 'recall': 0.1791044776119403, 'f1-score': 0.242914979757085, 'support': 11390}, '1': {'precision': 0.39051841746248295, 'recall': 0.7071018967798853, 'f1-score': 0.5031545246241251, 'support': 11335}, '2': {'precision': 0.3772898706896552, 'recall': 0.26352432025590367, 'f1-score': 0.3103085359773998, 'support': 10629}, 'accuracy': 0.38544102656353063, 'macro avg': {'precision': 0.38172225957272526, 'recall': 0.38324356488257644, 'f1-score': 0.3521260134528699, 'support': 33354}, 'weighted avg': {'precision': 0.38180888364348387, 'recall': 0.38544102656353063, 'f1-score': 0.3528310722837273, 'support': 33354}}
[[2040 6528 2822]
 [1519 8015 1801]
 [1847 5981 2801]]
training model: results/CHTR/W10/deepVOL_L3/h30
Epoch 1/50
295/295 - 16s - loss: 3.3122 - accuracy30: 0.3674 - val_loss: 3.5217 - val_accuracy30: 0.3406 - 16s/epoch - 54ms/step
Epoch 2/50
295/295 - 13s - loss: 3.2981 - accuracy30: 0.3646 - val_loss: 3.4477 - val_accuracy30: 0.3406 - 13s/epoch - 43ms/step
Epoch 3/50
295/295 - 13s - loss: 3.2933 - accuracy30: 0.3656 - val_loss: 3.5370 - val_accuracy30: 0.3405 - 13s/epoch - 43ms/step
Epoch 4/50
295/295 - 13s - loss: 3.2883 - accuracy30: 0.3666 - val_loss: 3.3944 - val_accuracy30: 0.3407 - 13s/epoch - 43ms/step
Epoch 5/50
295/295 - 12s - loss: 3.2979 - accuracy30: 0.3558 - val_loss: 3.3073 - val_accuracy30: 0.3457 - 12s/epoch - 42ms/step
Epoch 6/50
295/295 - 12s - loss: 3.2905 - accuracy30: 0.3611 - val_loss: 3.3185 - val_accuracy30: 0.3434 - 12s/epoch - 42ms/step
Epoch 7/50
295/295 - 13s - loss: 3.2959 - accuracy30: 0.3565 - val_loss: 3.2924 - val_accuracy30: 0.3613 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 13s - loss: 3.2923 - accuracy30: 0.3581 - val_loss: 3.2910 - val_accuracy30: 0.3592 - 13s/epoch - 43ms/step
Epoch 9/50
295/295 - 13s - loss: 3.2912 - accuracy30: 0.3582 - val_loss: 3.2912 - val_accuracy30: 0.3587 - 13s/epoch - 44ms/step
Epoch 10/50
295/295 - 13s - loss: 3.2890 - accuracy30: 0.3591 - val_loss: 3.2882 - val_accuracy30: 0.3608 - 13s/epoch - 43ms/step
Epoch 11/50
295/295 - 12s - loss: 3.2843 - accuracy30: 0.3637 - val_loss: 3.3023 - val_accuracy30: 0.3517 - 12s/epoch - 42ms/step
Epoch 12/50
295/295 - 12s - loss: 3.2891 - accuracy30: 0.3583 - val_loss: 3.2873 - val_accuracy30: 0.3633 - 12s/epoch - 42ms/step
Epoch 13/50
295/295 - 12s - loss: 3.2884 - accuracy30: 0.3600 - val_loss: 3.2829 - val_accuracy30: 0.3666 - 12s/epoch - 42ms/step
Epoch 14/50
295/295 - 12s - loss: 3.2840 - accuracy30: 0.3651 - val_loss: 3.2838 - val_accuracy30: 0.3666 - 12s/epoch - 42ms/step
Epoch 15/50
295/295 - 12s - loss: 3.2830 - accuracy30: 0.3673 - val_loss: 3.2832 - val_accuracy30: 0.3666 - 12s/epoch - 42ms/step
Epoch 16/50
295/295 - 12s - loss: 3.2820 - accuracy30: 0.3690 - val_loss: 3.2817 - val_accuracy30: 0.3698 - 12s/epoch - 42ms/step
Epoch 17/50
295/295 - 13s - loss: 3.2815 - accuracy30: 0.3697 - val_loss: 3.2758 - val_accuracy30: 0.3738 - 13s/epoch - 42ms/step
Epoch 18/50
295/295 - 12s - loss: 3.2788 - accuracy30: 0.3710 - val_loss: 3.2755 - val_accuracy30: 0.3755 - 12s/epoch - 42ms/step
Epoch 19/50
295/295 - 12s - loss: 3.2779 - accuracy30: 0.3720 - val_loss: 3.2764 - val_accuracy30: 0.3734 - 12s/epoch - 42ms/step
Epoch 20/50
295/295 - 12s - loss: 3.2787 - accuracy30: 0.3723 - val_loss: 3.2747 - val_accuracy30: 0.3702 - 12s/epoch - 42ms/step
Epoch 21/50
295/295 - 13s - loss: 3.2767 - accuracy30: 0.3732 - val_loss: 3.2735 - val_accuracy30: 0.3747 - 13s/epoch - 43ms/step
Epoch 22/50
295/295 - 12s - loss: 3.2721 - accuracy30: 0.3760 - val_loss: 3.2730 - val_accuracy30: 0.3742 - 12s/epoch - 42ms/step
Epoch 23/50
295/295 - 12s - loss: 3.2731 - accuracy30: 0.3743 - val_loss: 3.2760 - val_accuracy30: 0.3716 - 12s/epoch - 42ms/step
Epoch 24/50
295/295 - 12s - loss: 3.2718 - accuracy30: 0.3766 - val_loss: 3.2713 - val_accuracy30: 0.3762 - 12s/epoch - 42ms/step
Epoch 25/50
295/295 - 12s - loss: 3.2692 - accuracy30: 0.3775 - val_loss: 3.2740 - val_accuracy30: 0.3759 - 12s/epoch - 42ms/step
Epoch 26/50
295/295 - 13s - loss: 3.2679 - accuracy30: 0.3812 - val_loss: 3.2716 - val_accuracy30: 0.3742 - 13s/epoch - 43ms/step
Epoch 27/50
295/295 - 12s - loss: 3.2663 - accuracy30: 0.3821 - val_loss: 3.2715 - val_accuracy30: 0.3747 - 12s/epoch - 42ms/step
Epoch 28/50
295/295 - 13s - loss: 3.2666 - accuracy30: 0.3829 - val_loss: 3.2734 - val_accuracy30: 0.3752 - 13s/epoch - 42ms/step
Epoch 29/50
295/295 - 13s - loss: 3.2641 - accuracy30: 0.3857 - val_loss: 3.2752 - val_accuracy30: 0.3725 - 13s/epoch - 43ms/step
Epoch 30/50
295/295 - 13s - loss: 3.2625 - accuracy30: 0.3853 - val_loss: 3.2746 - val_accuracy30: 0.3715 - 13s/epoch - 45ms/step
Epoch 31/50
295/295 - 13s - loss: 3.2611 - accuracy30: 0.3853 - val_loss: 3.2780 - val_accuracy30: 0.3705 - 13s/epoch - 42ms/step
Epoch 32/50
295/295 - 13s - loss: 3.2593 - accuracy30: 0.3870 - val_loss: 3.2723 - val_accuracy30: 0.3736 - 13s/epoch - 43ms/step
Epoch 33/50
295/295 - 12s - loss: 3.2572 - accuracy30: 0.3887 - val_loss: 3.2760 - val_accuracy30: 0.3754 - 12s/epoch - 42ms/step
Epoch 34/50
295/295 - 13s - loss: 3.2558 - accuracy30: 0.3915 - val_loss: 3.2758 - val_accuracy30: 0.3734 - 13s/epoch - 43ms/step
testing model: results/CHTR/W10/deepVOL_L3/h30
Evaluating performance on  test set...
1588/1588 - 31s - 31s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0999421
{'0': {'precision': 0.3568979449212693, 'recall': 0.23085018469992444, 'f1-score': 0.28035803893480415, 'support': 141581}, '1': {'precision': 0.32869930045066265, 'recall': 0.5981430859065396, 'f1-score': 0.42425598311190654, 'support': 123646}, '2': {'precision': 0.3731188549260919, 'recall': 0.23728368980355738, 'f1-score': 0.29008731826750156, 'support': 141059}, 'accuracy': 0.34486297829607715, 'macro avg': {'precision': 0.352905366766008, 'recall': 0.35542565347000715, 'f1-score': 0.33156711343807077, 'support': 406286}, 'weighted avg': {'precision': 0.3539479435679311, 'recall': 0.34486297829607715, 'f1-score': 0.32752876994476504, 'support': 406286}}
[[32684 76704 32193]
 [25646 73958 24042]
 [33248 74340 33471]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901946
{'0': {'precision': 0.38564994755999754, 'recall': 0.23804265041888803, 'f1-score': 0.29437942970166475, 'support': 26260}, '1': {'precision': 0.3769132800740998, 'recall': 0.6542991518269888, 'f1-score': 0.47829919779025004, 'support': 24877}, '2': {'precision': 0.3664885685884692, 'recall': 0.24222888350511232, 'f1-score': 0.29167593760043514, 'support': 24353}, 'accuracy': 0.37656643264008477, 'macro avg': {'precision': 0.3763505987408555, 'recall': 0.3781902285836631, 'f1-score': 0.35478485503078333, 'support': 75490}, 'weighted avg': {'precision': 0.3765894211440443, 'recall': 0.37656643264008477, 'f1-score': 0.3541162680590431, 'support': 75490}}
[[ 6251 14091  5918]
 [ 4321 16277  4279]
 [ 5637 12817  5899]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0899472
{'0': {'precision': 0.3641311933007676, 'recall': 0.2298070994450806, 'f1-score': 0.28177988983691543, 'support': 11353}, '1': {'precision': 0.38807975493094, 'recall': 0.6353717553893533, 'f1-score': 0.4818497264113173, 'support': 11365}, '2': {'precision': 0.3562384595093643, 'recall': 0.2539488529522377, 'f1-score': 0.29651992534855637, 'support': 10636}, 'accuracy': 0.37569706781795287, 'macro avg': {'precision': 0.3694831359136906, 'recall': 0.3730425692622239, 'f1-score': 0.3533831805322631, 'support': 33354}, 'weighted avg': {'precision': 0.36977454301359197, 'recall': 0.37569706781795287, 'f1-score': 0.3546517705819502, 'support': 33354}}
[[2609 5934 2810]
 [2073 7221 2071]
 [2483 5452 2701]]
training model: results/CHTR/W10/deepVOL_L3/h50
Epoch 1/50
295/295 - 15s - loss: 3.3104 - accuracy50: 0.3691 - val_loss: 3.5726 - val_accuracy50: 0.3471 - 15s/epoch - 51ms/step
Epoch 2/50
295/295 - 13s - loss: 3.2921 - accuracy50: 0.3679 - val_loss: 3.5266 - val_accuracy50: 0.3461 - 13s/epoch - 43ms/step
Epoch 3/50
295/295 - 12s - loss: 3.2885 - accuracy50: 0.3695 - val_loss: 3.4765 - val_accuracy50: 0.3457 - 12s/epoch - 42ms/step
Epoch 4/50
295/295 - 12s - loss: 3.2913 - accuracy50: 0.3644 - val_loss: 3.4735 - val_accuracy50: 0.3459 - 12s/epoch - 42ms/step
Epoch 5/50
295/295 - 12s - loss: 3.2895 - accuracy50: 0.3656 - val_loss: 3.3270 - val_accuracy50: 0.3458 - 12s/epoch - 42ms/step
Epoch 6/50
295/295 - 13s - loss: 3.2952 - accuracy50: 0.3582 - val_loss: 3.3006 - val_accuracy50: 0.3491 - 13s/epoch - 43ms/step
Epoch 7/50
295/295 - 13s - loss: 3.2962 - accuracy50: 0.3527 - val_loss: 3.2900 - val_accuracy50: 0.3601 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 12s - loss: 3.2916 - accuracy50: 0.3556 - val_loss: 3.2889 - val_accuracy50: 0.3652 - 12s/epoch - 42ms/step
Epoch 9/50
295/295 - 12s - loss: 3.2916 - accuracy50: 0.3608 - val_loss: 3.2875 - val_accuracy50: 0.3661 - 12s/epoch - 42ms/step
Epoch 10/50
295/295 - 12s - loss: 3.2896 - accuracy50: 0.3633 - val_loss: 3.2856 - val_accuracy50: 0.3667 - 12s/epoch - 42ms/step
Epoch 11/50
295/295 - 12s - loss: 3.2874 - accuracy50: 0.3683 - val_loss: 3.2871 - val_accuracy50: 0.3675 - 12s/epoch - 42ms/step
Epoch 12/50
295/295 - 13s - loss: 3.2862 - accuracy50: 0.3650 - val_loss: 3.2854 - val_accuracy50: 0.3658 - 13s/epoch - 43ms/step
Epoch 13/50
295/295 - 13s - loss: 3.2843 - accuracy50: 0.3676 - val_loss: 3.2825 - val_accuracy50: 0.3699 - 13s/epoch - 42ms/step
Epoch 14/50
295/295 - 13s - loss: 3.2827 - accuracy50: 0.3697 - val_loss: 3.2821 - val_accuracy50: 0.3680 - 13s/epoch - 43ms/step
Epoch 15/50
295/295 - 12s - loss: 3.2824 - accuracy50: 0.3695 - val_loss: 3.2859 - val_accuracy50: 0.3676 - 12s/epoch - 42ms/step
Epoch 16/50
295/295 - 13s - loss: 3.2826 - accuracy50: 0.3678 - val_loss: 3.2817 - val_accuracy50: 0.3728 - 13s/epoch - 42ms/step
Epoch 17/50
295/295 - 13s - loss: 3.2800 - accuracy50: 0.3708 - val_loss: 3.2806 - val_accuracy50: 0.3731 - 13s/epoch - 43ms/step
Epoch 18/50
295/295 - 13s - loss: 3.2768 - accuracy50: 0.3722 - val_loss: 3.2795 - val_accuracy50: 0.3734 - 13s/epoch - 42ms/step
Epoch 19/50
295/295 - 13s - loss: 3.2757 - accuracy50: 0.3729 - val_loss: 3.2807 - val_accuracy50: 0.3630 - 13s/epoch - 44ms/step
Epoch 20/50
295/295 - 13s - loss: 3.2724 - accuracy50: 0.3752 - val_loss: 3.2837 - val_accuracy50: 0.3705 - 13s/epoch - 44ms/step
Epoch 21/50
295/295 - 13s - loss: 3.2724 - accuracy50: 0.3763 - val_loss: 3.2919 - val_accuracy50: 0.3668 - 13s/epoch - 43ms/step
Epoch 22/50
295/295 - 12s - loss: 3.2709 - accuracy50: 0.3745 - val_loss: 3.2799 - val_accuracy50: 0.3715 - 12s/epoch - 42ms/step
Epoch 23/50
295/295 - 12s - loss: 3.2701 - accuracy50: 0.3725 - val_loss: 3.2884 - val_accuracy50: 0.3667 - 12s/epoch - 42ms/step
Epoch 24/50
295/295 - 12s - loss: 3.2642 - accuracy50: 0.3773 - val_loss: 3.2888 - val_accuracy50: 0.3700 - 12s/epoch - 42ms/step
Epoch 25/50
295/295 - 12s - loss: 3.2643 - accuracy50: 0.3769 - val_loss: 3.2884 - val_accuracy50: 0.3692 - 12s/epoch - 42ms/step
Epoch 26/50
295/295 - 12s - loss: 3.2685 - accuracy50: 0.3789 - val_loss: 3.2761 - val_accuracy50: 0.3733 - 12s/epoch - 42ms/step
Epoch 27/50
295/295 - 12s - loss: 3.2686 - accuracy50: 0.3759 - val_loss: 3.2868 - val_accuracy50: 0.3753 - 12s/epoch - 42ms/step
Epoch 28/50
295/295 - 12s - loss: 3.2764 - accuracy50: 0.3736 - val_loss: 3.2758 - val_accuracy50: 0.3786 - 12s/epoch - 42ms/step
Epoch 29/50
295/295 - 12s - loss: 3.2673 - accuracy50: 0.3795 - val_loss: 3.2930 - val_accuracy50: 0.3650 - 12s/epoch - 42ms/step
Epoch 30/50
295/295 - 12s - loss: 3.2657 - accuracy50: 0.3805 - val_loss: 3.2872 - val_accuracy50: 0.3686 - 12s/epoch - 42ms/step
Epoch 31/50
295/295 - 12s - loss: 3.2616 - accuracy50: 0.3813 - val_loss: 3.3033 - val_accuracy50: 0.3643 - 12s/epoch - 42ms/step
Epoch 32/50
295/295 - 13s - loss: 3.2605 - accuracy50: 0.3828 - val_loss: 3.2829 - val_accuracy50: 0.3727 - 13s/epoch - 43ms/step
Epoch 33/50
295/295 - 12s - loss: 3.2583 - accuracy50: 0.3834 - val_loss: 3.2888 - val_accuracy50: 0.3681 - 12s/epoch - 42ms/step
Epoch 34/50
295/295 - 12s - loss: 3.2545 - accuracy50: 0.3836 - val_loss: 3.3000 - val_accuracy50: 0.3682 - 12s/epoch - 42ms/step
Epoch 35/50
295/295 - 13s - loss: 3.2547 - accuracy50: 0.3828 - val_loss: 3.2825 - val_accuracy50: 0.3733 - 13s/epoch - 43ms/step
Epoch 36/50
295/295 - 12s - loss: 3.2535 - accuracy50: 0.3841 - val_loss: 3.2924 - val_accuracy50: 0.3761 - 12s/epoch - 42ms/step
Epoch 37/50
295/295 - 12s - loss: 3.2567 - accuracy50: 0.3872 - val_loss: 3.2889 - val_accuracy50: 0.3758 - 12s/epoch - 42ms/step
Epoch 38/50
295/295 - 12s - loss: 3.2562 - accuracy50: 0.3859 - val_loss: 3.2988 - val_accuracy50: 0.3666 - 12s/epoch - 42ms/step
testing model: results/CHTR/W10/deepVOL_L3/h50
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1053582
{'0': {'precision': 0.36745704009591046, 'recall': 0.15284771331010744, 'f1-score': 0.2158925819942769, 'support': 144379}, '1': {'precision': 0.30989250474132896, 'recall': 0.6855164935985654, 'f1-score': 0.4268324349027306, 'support': 119895}, '2': {'precision': 0.3711069140465874, 'recall': 0.2116933780243923, 'f1-score': 0.2695979302397532, 'support': 142012}, 'accuracy': 0.3306070108248869, 'macro avg': {'precision': 0.3494854862946089, 'recall': 0.35001919497768835, 'f1-score': 0.3041076490455869, 'support': 406286}, 'weighted avg': {'precision': 0.3517455115991028, 'recall': 0.3306070108248869, 'f1-score': 0.29691294100122184, 'support': 406286}}
[[22068 92840 29471]
 [16230 82190 21475]
 [21758 90191 30063]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0959915
{'0': {'precision': 0.40354623096917935, 'recall': 0.16531660011409013, 'f1-score': 0.2345482504653735, 'support': 26295}, '1': {'precision': 0.3563070719848203, 'recall': 0.7278930792215134, 'f1-score': 0.47842356687898085, 'support': 24766}, '2': {'precision': 0.3611583120928915, 'recall': 0.20880920217773957, 'f1-score': 0.2646227271548258, 'support': 24429}, 'accuracy': 0.3639554907934826, 'macro avg': {'precision': 0.37367053834896374, 'recall': 0.3673396271711143, 'f1-score': 0.3258648481663934, 'support': 75490}, 'weighted avg': {'precision': 0.37433150740797294, 'recall': 0.3639554907934826, 'f1-score': 0.32428868598459504, 'support': 75490}}
[[ 4347 16858  5090]
 [ 2806 18027  3933]
 [ 3619 15709  5101]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926335
{'0': {'precision': 0.3907326236693801, 'recall': 0.16647398843930636, 'f1-score': 0.23347468196557747, 'support': 11245}, '1': {'precision': 0.38263345839171903, 'recall': 0.733599098708727, 'f1-score': 0.5029410017230111, 'support': 11539}, '2': {'precision': 0.35434782608695653, 'recall': 0.21589403973509932, 'f1-score': 0.26831275720164605, 'support': 10570}, 'accuracy': 0.3783354320321401, 'macro avg': {'precision': 0.37590463604935187, 'recall': 0.3719890422943775, 'f1-score': 0.3349094802967449, 'support': 33354}, 'weighted avg': {'precision': 0.3764002024130046, 'recall': 0.3783354320321401, 'f1-score': 0.33773834806038683, 'support': 33354}}
[[1872 7021 2352]
 [1268 8465 1806]
 [1651 6637 2282]]
training model: results/CHTR/W10/deepVOL_L3/h100
Epoch 1/50
295/295 - 15s - loss: 3.3141 - accuracy100: 0.3678 - val_loss: 3.5208 - val_accuracy100: 0.3506 - 15s/epoch - 52ms/step
Epoch 2/50
295/295 - 13s - loss: 3.3084 - accuracy100: 0.3600 - val_loss: 3.4665 - val_accuracy100: 0.3511 - 13s/epoch - 44ms/step
Epoch 3/50
295/295 - 13s - loss: 3.3005 - accuracy100: 0.3603 - val_loss: 3.3178 - val_accuracy100: 0.3508 - 13s/epoch - 43ms/step
Epoch 4/50
295/295 - 13s - loss: 3.3038 - accuracy100: 0.3443 - val_loss: 3.2983 - val_accuracy100: 0.3492 - 13s/epoch - 43ms/step
Epoch 5/50
295/295 - 13s - loss: 3.3007 - accuracy100: 0.3372 - val_loss: 3.2968 - val_accuracy100: 0.3505 - 13s/epoch - 43ms/step
Epoch 6/50
295/295 - 12s - loss: 3.2984 - accuracy100: 0.3396 - val_loss: 3.2958 - val_accuracy100: 0.3501 - 12s/epoch - 42ms/step
Epoch 7/50
295/295 - 12s - loss: 3.2980 - accuracy100: 0.3398 - val_loss: 3.2955 - val_accuracy100: 0.3509 - 12s/epoch - 42ms/step
Epoch 8/50
295/295 - 13s - loss: 3.2956 - accuracy100: 0.3440 - val_loss: 3.2986 - val_accuracy100: 0.3483 - 13s/epoch - 43ms/step
Epoch 9/50
295/295 - 12s - loss: 3.2961 - accuracy100: 0.3438 - val_loss: 3.2971 - val_accuracy100: 0.3520 - 12s/epoch - 42ms/step
Epoch 10/50
295/295 - 12s - loss: 3.2968 - accuracy100: 0.3452 - val_loss: 3.2965 - val_accuracy100: 0.3498 - 12s/epoch - 42ms/step
Epoch 11/50
295/295 - 13s - loss: 3.2962 - accuracy100: 0.3465 - val_loss: 3.2971 - val_accuracy100: 0.3508 - 13s/epoch - 43ms/step
Epoch 12/50
295/295 - 13s - loss: 3.2944 - accuracy100: 0.3521 - val_loss: 3.2970 - val_accuracy100: 0.3505 - 13s/epoch - 42ms/step
Epoch 13/50
295/295 - 13s - loss: 3.2937 - accuracy100: 0.3497 - val_loss: 3.3004 - val_accuracy100: 0.3508 - 13s/epoch - 43ms/step
Epoch 14/50
295/295 - 12s - loss: 3.2944 - accuracy100: 0.3533 - val_loss: 3.2958 - val_accuracy100: 0.3499 - 12s/epoch - 42ms/step
Epoch 15/50
295/295 - 13s - loss: 3.2963 - accuracy100: 0.3480 - val_loss: 3.2956 - val_accuracy100: 0.3483 - 13s/epoch - 43ms/step
Epoch 16/50
295/295 - 12s - loss: 3.2953 - accuracy100: 0.3471 - val_loss: 3.2960 - val_accuracy100: 0.3485 - 12s/epoch - 42ms/step
Epoch 17/50
295/295 - 12s - loss: 3.2941 - accuracy100: 0.3511 - val_loss: 3.2952 - val_accuracy100: 0.3496 - 12s/epoch - 42ms/step
Epoch 18/50
295/295 - 12s - loss: 3.2946 - accuracy100: 0.3485 - val_loss: 3.2968 - val_accuracy100: 0.3502 - 12s/epoch - 42ms/step
Epoch 19/50
295/295 - 12s - loss: 3.2947 - accuracy100: 0.3521 - val_loss: 3.2956 - val_accuracy100: 0.3481 - 12s/epoch - 42ms/step
Epoch 20/50
295/295 - 12s - loss: 3.2942 - accuracy100: 0.3524 - val_loss: 3.2963 - val_accuracy100: 0.3489 - 12s/epoch - 42ms/step
Epoch 21/50
295/295 - 13s - loss: 3.2924 - accuracy100: 0.3514 - val_loss: 3.2951 - val_accuracy100: 0.3530 - 13s/epoch - 44ms/step
Epoch 22/50
295/295 - 13s - loss: 3.2917 - accuracy100: 0.3548 - val_loss: 3.2963 - val_accuracy100: 0.3496 - 13s/epoch - 43ms/step
Epoch 23/50
295/295 - 12s - loss: 3.2910 - accuracy100: 0.3573 - val_loss: 3.2961 - val_accuracy100: 0.3488 - 12s/epoch - 42ms/step
Epoch 24/50
295/295 - 13s - loss: 3.2911 - accuracy100: 0.3568 - val_loss: 3.2988 - val_accuracy100: 0.3485 - 13s/epoch - 43ms/step
Epoch 25/50
295/295 - 13s - loss: 3.2895 - accuracy100: 0.3600 - val_loss: 3.2962 - val_accuracy100: 0.3508 - 13s/epoch - 43ms/step
Epoch 26/50
295/295 - 13s - loss: 3.2905 - accuracy100: 0.3567 - val_loss: 3.2962 - val_accuracy100: 0.3537 - 13s/epoch - 43ms/step
Epoch 27/50
295/295 - 12s - loss: 3.2895 - accuracy100: 0.3574 - val_loss: 3.2953 - val_accuracy100: 0.3538 - 12s/epoch - 42ms/step
Epoch 28/50
295/295 - 12s - loss: 3.2887 - accuracy100: 0.3576 - val_loss: 3.2983 - val_accuracy100: 0.3511 - 12s/epoch - 42ms/step
Epoch 29/50
295/295 - 13s - loss: 3.2882 - accuracy100: 0.3623 - val_loss: 3.2979 - val_accuracy100: 0.3520 - 13s/epoch - 43ms/step
Epoch 30/50
295/295 - 12s - loss: 3.2867 - accuracy100: 0.3635 - val_loss: 3.3029 - val_accuracy100: 0.3507 - 12s/epoch - 42ms/step
Epoch 31/50
295/295 - 12s - loss: 3.2859 - accuracy100: 0.3620 - val_loss: 3.2996 - val_accuracy100: 0.3520 - 12s/epoch - 42ms/step
testing model: results/CHTR/W10/deepVOL_L3/h100
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106486
{'0': {'precision': 0.3653259789646785, 'recall': 0.14519126687498723, 'f1-score': 0.20779764891580235, 'support': 146889}, '1': {'precision': 0.2830102622576967, 'recall': 0.8430633094402397, 'f1-score': 0.42376550573824495, 'support': 114817}, '2': {'precision': 0.35062946580469545, 'recall': 0.014255083690690276, 'f1-score': 0.027396349811907642, 'support': 144580}, 'accuracy': 0.295816247667899, 'macro avg': {'precision': 0.33298856900902357, 'recall': 0.33416988666863906, 'f1-score': 0.21965316815531832, 'support': 406286}, 'weighted avg': {'precision': 0.33683357332477004, 'recall': 0.295816247667899, 'f1-score': 0.2046332809394047, 'support': 406286}}
[[ 21327 123371   2191]
 [ 16393  96798   1626]
 [ 20658 121861   2061]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1006829
{'0': {'precision': 0.38356968215158926, 'recall': 0.1523994559937828, 'f1-score': 0.2181312569521691, 'support': 25735}, '1': {'precision': 0.3368570183086312, 'recall': 0.8702489643244983, 'f1-score': 0.48570626858970767, 'support': 24863}, '2': {'precision': 0.38334946757018395, 'recall': 0.015908725695002412, 'f1-score': 0.030549662487946, 'support': 24892}, 'accuracy': 0.34382037355941186, 'macro avg': {'precision': 0.3679253893434682, 'recall': 0.34618571533776116, 'f1-score': 0.24479572934327423, 'support': 75490}, 'weighted avg': {'precision': 0.3681120249454983, 'recall': 0.34382037355941186, 'f1-score': 0.24440541862842657, 'support': 75490}}
[[ 3922 21432   381]
 [ 2970 21637   256]
 [ 3333 21163   396]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989398
{'0': {'precision': 0.3331242158092848, 'recall': 0.14565237267989395, 'f1-score': 0.20268464915070936, 'support': 10937}, '1': {'precision': 0.35395678331138086, 'recall': 0.8496838147325243, 'f1-score': 0.49973613449601695, 'support': 11702}, '2': {'precision': 0.3471933471933472, 'recall': 0.015585627624825012, 'f1-score': 0.02983208288674527, 'support': 10715}, 'accuracy': 0.3508724590753733, 'macro avg': {'precision': 0.34475811543800433, 'recall': 0.33697393834574774, 'f1-score': 0.24408428884449052, 'support': 33354}, 'weighted avg': {'precision': 0.3449528854647911, 'recall': 0.3508724590753733, 'f1-score': 0.2513738988356771, 'support': 33354}}
[[1593 9180  164]
 [1609 9943  150]
 [1580 8968  167]]
training model: results/CHTR/W10/deepVOL_L3/h200
Epoch 1/50
295/295 - 15s - loss: 3.3280 - accuracy200: 0.3625 - val_loss: 3.5035 - val_accuracy200: 0.3586 - 15s/epoch - 52ms/step
Epoch 2/50
295/295 - 13s - loss: 3.3125 - accuracy200: 0.3532 - val_loss: 3.3270 - val_accuracy200: 0.3589 - 13s/epoch - 44ms/step
Epoch 3/50
295/295 - 13s - loss: 3.3087 - accuracy200: 0.3383 - val_loss: 3.2971 - val_accuracy200: 0.3595 - 13s/epoch - 44ms/step
Epoch 4/50
295/295 - 13s - loss: 3.3056 - accuracy200: 0.3363 - val_loss: 3.2953 - val_accuracy200: 0.3593 - 13s/epoch - 43ms/step
Epoch 5/50
295/295 - 13s - loss: 3.3044 - accuracy200: 0.3345 - val_loss: 3.2959 - val_accuracy200: 0.3600 - 13s/epoch - 43ms/step
Epoch 6/50
295/295 - 12s - loss: 3.3045 - accuracy200: 0.3362 - val_loss: 3.2948 - val_accuracy200: 0.3593 - 12s/epoch - 42ms/step
Epoch 7/50
295/295 - 13s - loss: 3.3039 - accuracy200: 0.3337 - val_loss: 3.2945 - val_accuracy200: 0.3591 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 13s - loss: 3.3034 - accuracy200: 0.3353 - val_loss: 3.2940 - val_accuracy200: 0.3588 - 13s/epoch - 44ms/step
Epoch 9/50
295/295 - 13s - loss: 3.3032 - accuracy200: 0.3365 - val_loss: 3.2947 - val_accuracy200: 0.3592 - 13s/epoch - 43ms/step
Epoch 10/50
295/295 - 13s - loss: 3.3028 - accuracy200: 0.3371 - val_loss: 3.2946 - val_accuracy200: 0.3596 - 13s/epoch - 43ms/step
Epoch 11/50
295/295 - 13s - loss: 3.3030 - accuracy200: 0.3357 - val_loss: 3.2941 - val_accuracy200: 0.3596 - 13s/epoch - 44ms/step
Epoch 12/50
295/295 - 12s - loss: 3.3022 - accuracy200: 0.3366 - val_loss: 3.2946 - val_accuracy200: 0.3598 - 12s/epoch - 42ms/step
Epoch 13/50
295/295 - 13s - loss: 3.3024 - accuracy200: 0.3388 - val_loss: 3.2956 - val_accuracy200: 0.3587 - 13s/epoch - 43ms/step
Epoch 14/50
295/295 - 13s - loss: 3.3019 - accuracy200: 0.3373 - val_loss: 3.2971 - val_accuracy200: 0.3562 - 13s/epoch - 43ms/step
Epoch 15/50
295/295 - 13s - loss: 3.3028 - accuracy200: 0.3368 - val_loss: 3.2945 - val_accuracy200: 0.3587 - 13s/epoch - 43ms/step
Epoch 16/50
295/295 - 13s - loss: 3.3020 - accuracy200: 0.3374 - val_loss: 3.2941 - val_accuracy200: 0.3579 - 13s/epoch - 44ms/step
Epoch 17/50
295/295 - 13s - loss: 3.3009 - accuracy200: 0.3374 - val_loss: 3.2960 - val_accuracy200: 0.3582 - 13s/epoch - 43ms/step
Epoch 18/50
295/295 - 12s - loss: 3.3013 - accuracy200: 0.3381 - val_loss: 3.2955 - val_accuracy200: 0.3568 - 12s/epoch - 42ms/step
testing model: results/CHTR/W10/deepVOL_L3/h200
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145804
{'0': {'precision': 0.3591549295774648, 'recall': 0.0006993006993006993, 'f1-score': 0.0013958835121523976, 'support': 145860}, '1': {'precision': 0.2833883469940289, 'recall': 0.9952847392278434, 'f1-score': 0.4411637346204699, 'support': 115158}, '2': {'precision': 0.37315350032113037, 'recall': 0.0039995043643472755, 'f1-score': 0.007914183551847438, 'support': 145268}, 'accuracy': 0.2837853137937315, 'macro avg': {'precision': 0.3385655922975414, 'recall': 0.3333278480971638, 'f1-score': 0.15015793389482326, 'support': 406286}, 'weighted avg': {'precision': 0.3426847983340735, 'recall': 0.2837853137937315, 'f1-score': 0.12837462904632796, 'support': 406286}}
[[   102 145235    523]
 [    90 114615    453]
 [    92 144595    581]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039879
{'0': {'precision': 0.4153846153846154, 'recall': 0.0010891927871233208, 'f1-score': 0.0021726885008449344, 'support': 24789}, '1': {'precision': 0.3309225072591172, 'recall': 0.9952331357154303, 'f1-score': 0.49669138961636117, 'support': 24964}, '2': {'precision': 0.5187319884726225, 'recall': 0.006993822123790652, 'f1-score': 0.013801564177273424, 'support': 25737}, 'accuracy': 0.33185852430785534, 'macro avg': {'precision': 0.42167970370545166, 'recall': 0.33443871687544807, 'f1-score': 0.17088854743149318, 'support': 75490}, 'weighted avg': {'precision': 0.4226880896715554, 'recall': 0.33185852430785534, 'f1-score': 0.1696711283992684, 'support': 75490}}
[[   27 24688    74]
 [   26 24845    93]
 [   12 25545   180]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985328
{'0': {'precision': 0.43478260869565216, 'recall': 0.0009566631589017507, 'f1-score': 0.0019091256204658267, 'support': 10453}, '1': {'precision': 0.3595238095238095, 'recall': 0.9952444518605039, 'f1-score': 0.5282291989549661, 'support': 11986}, '2': {'precision': 0.3443708609271523, 'recall': 0.004764086120018323, 'f1-score': 0.009398156515452737, 'support': 10915}, 'accuracy': 0.3595071055945314, 'macro avg': {'precision': 0.3795590930488713, 'recall': 0.33365506704647463, 'f1-score': 0.17984549369696157, 'support': 33354}, 'weighted avg': {'precision': 0.3781508345825958, 'recall': 0.3595071055945314, 'f1-score': 0.19349679640076511, 'support': 33354}}
[[   10 10394    49]
 [    7 11929    50]
 [    6 10857    52]]
training model: results/CHTR/W10/deepVOL_L3/h300
Epoch 1/50
295/295 - 15s - loss: 3.3185 - accuracy300: 0.3690 - val_loss: 3.6406 - val_accuracy300: 0.3610 - 15s/epoch - 52ms/step
Epoch 2/50
295/295 - 13s - loss: 3.3095 - accuracy300: 0.3598 - val_loss: 3.4342 - val_accuracy300: 0.3608 - 13s/epoch - 43ms/step
Epoch 3/50
295/295 - 13s - loss: 3.3077 - accuracy300: 0.3493 - val_loss: 3.3259 - val_accuracy300: 0.3612 - 13s/epoch - 44ms/step
Epoch 4/50
295/295 - 13s - loss: 3.3061 - accuracy300: 0.3414 - val_loss: 3.2944 - val_accuracy300: 0.3614 - 13s/epoch - 42ms/step
Epoch 5/50
295/295 - 13s - loss: 3.3026 - accuracy300: 0.3376 - val_loss: 3.2911 - val_accuracy300: 0.3613 - 13s/epoch - 43ms/step
Epoch 6/50
295/295 - 12s - loss: 3.3010 - accuracy300: 0.3371 - val_loss: 3.2913 - val_accuracy300: 0.3607 - 12s/epoch - 42ms/step
Epoch 7/50
295/295 - 13s - loss: 3.3004 - accuracy300: 0.3390 - val_loss: 3.2910 - val_accuracy300: 0.3614 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 12s - loss: 3.3003 - accuracy300: 0.3366 - val_loss: 3.2917 - val_accuracy300: 0.3606 - 12s/epoch - 42ms/step
Epoch 9/50
295/295 - 13s - loss: 3.3005 - accuracy300: 0.3367 - val_loss: 3.2925 - val_accuracy300: 0.3609 - 13s/epoch - 43ms/step
Epoch 10/50
295/295 - 12s - loss: 3.3004 - accuracy300: 0.3361 - val_loss: 3.2919 - val_accuracy300: 0.3609 - 12s/epoch - 42ms/step
Epoch 11/50
295/295 - 12s - loss: 3.3003 - accuracy300: 0.3340 - val_loss: 3.2928 - val_accuracy300: 0.3610 - 12s/epoch - 42ms/step
Epoch 12/50
295/295 - 12s - loss: 3.2997 - accuracy300: 0.3374 - val_loss: 3.2926 - val_accuracy300: 0.3611 - 12s/epoch - 42ms/step
Epoch 13/50
295/295 - 13s - loss: 3.2991 - accuracy300: 0.3374 - val_loss: 3.2939 - val_accuracy300: 0.3610 - 13s/epoch - 42ms/step
Epoch 14/50
295/295 - 12s - loss: 3.2978 - accuracy300: 0.3437 - val_loss: 3.2923 - val_accuracy300: 0.3606 - 12s/epoch - 42ms/step
Epoch 15/50
295/295 - 12s - loss: 3.2990 - accuracy300: 0.3372 - val_loss: 3.2924 - val_accuracy300: 0.3602 - 12s/epoch - 42ms/step
Epoch 16/50
295/295 - 12s - loss: 3.2983 - accuracy300: 0.3370 - val_loss: 3.2952 - val_accuracy300: 0.3609 - 12s/epoch - 42ms/step
Epoch 17/50
295/295 - 12s - loss: 3.2980 - accuracy300: 0.3444 - val_loss: 3.2935 - val_accuracy300: 0.3602 - 12s/epoch - 42ms/step
testing model: results/CHTR/W10/deepVOL_L3/h300
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1100569
{'0': {'precision': 0.3383838383838384, 'recall': 0.0009167156949936377, 'f1-score': 0.0018284778604079962, 'support': 146174}, '1': {'precision': 0.2869149109269221, 'recall': 0.9981217516595482, 'f1-score': 0.4457087051434261, 'support': 116598}, '2': {'precision': 0.31716417910447764, 'recall': 0.0005922767116796967, 'f1-score': 0.001182345495263663, 'support': 143514}, 'accuracy': 0.2869850302496271, 'macro avg': {'precision': 0.31415430947174605, 'recall': 0.33321024802207383, 'f1-score': 0.14957317616636592, 'support': 406286}, 'weighted avg': {'precision': 0.3161175230654673, 'recall': 0.2869850302496271, 'f1-score': 0.12898722244056587, 'support': 406286}}
[[   134 145951     89]
 [   125 116379     94]
 [   137 143292     85]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024395
{'0': {'precision': 0.3384615384615385, 'recall': 0.000910068668817738, 'f1-score': 0.0018152564049672016, 'support': 24174}, '1': {'precision': 0.32998460558445697, 'recall': 0.9979130713970382, 'f1-score': 0.4959658518585007, 'support': 24917}, '2': {'precision': 0.3424657534246575, 'recall': 0.0009470055683927422, 'f1-score': 0.0018887881535207011, 'support': 26399}, 'accuracy': 0.3300039740362962, 'macro avg': {'precision': 0.3369706324902177, 'recall': 0.33325671521141625, 'f1-score': 0.1665566321389962, 'support': 75490}, 'weighted avg': {'precision': 0.3370638372337353, 'recall': 0.3300039740362962, 'f1-score': 0.1649453604127266, 'support': 75490}}
[[   22 24131    21]
 [   25 24865    27]
 [   18 26356    25]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973023
{'0': {'precision': 0.36363636363636365, 'recall': 0.0011828486939379004, 'f1-score': 0.002358027117311849, 'support': 10145}, '1': {'precision': 0.3612137599519303, 'recall': 0.9978421445763134, 'f1-score': 0.5304186703136718, 'support': 12049}, '2': {'precision': 0.3055555555555556, 'recall': 0.000985663082437276, 'f1-score': 0.0019649874955341195, 'support': 11160}, 'accuracy': 0.3611560832283984, 'macro avg': {'precision': 0.34346855971461654, 'recall': 0.3333368854508962, 'f1-score': 0.17824722830883924, 'support': 33354}, 'weighted avg': {'precision': 0.3433278018454074, 'recall': 0.3611560832283984, 'f1-score': 0.1929863286012089, 'support': 33354}}
[[   12 10121    12]
 [   13 12023    13]
 [    8 11141    11]]
training model: results/CHTR/W10/deepVOL_L3/h500
Epoch 1/50
295/295 - 15s - loss: 3.3194 - accuracy500: 0.3742 - val_loss: 3.5780 - val_accuracy500: 0.3607 - 15s/epoch - 51ms/step
Epoch 2/50
295/295 - 12s - loss: 3.3162 - accuracy500: 0.3603 - val_loss: 3.3544 - val_accuracy500: 0.3610 - 12s/epoch - 42ms/step
Epoch 3/50
295/295 - 15s - loss: 3.3109 - accuracy500: 0.3425 - val_loss: 3.3003 - val_accuracy500: 0.3606 - 15s/epoch - 49ms/step
Epoch 4/50
295/295 - 13s - loss: 3.3044 - accuracy500: 0.3419 - val_loss: 3.2986 - val_accuracy500: 0.3608 - 13s/epoch - 42ms/step
Epoch 5/50
295/295 - 13s - loss: 3.3038 - accuracy500: 0.3407 - val_loss: 3.2974 - val_accuracy500: 0.3608 - 13s/epoch - 43ms/step
Epoch 6/50
295/295 - 13s - loss: 3.3037 - accuracy500: 0.3401 - val_loss: 3.2975 - val_accuracy500: 0.3610 - 13s/epoch - 43ms/step
Epoch 7/50
295/295 - 13s - loss: 3.3032 - accuracy500: 0.3403 - val_loss: 3.2952 - val_accuracy500: 0.3609 - 13s/epoch - 43ms/step
Epoch 8/50
295/295 - 12s - loss: 3.3025 - accuracy500: 0.3416 - val_loss: 3.2952 - val_accuracy500: 0.3611 - 12s/epoch - 42ms/step
Epoch 9/50
295/295 - 12s - loss: 3.3023 - accuracy500: 0.3398 - val_loss: 3.2956 - val_accuracy500: 0.3611 - 12s/epoch - 42ms/step
Epoch 10/50
295/295 - 13s - loss: 3.3020 - accuracy500: 0.3403 - val_loss: 3.2957 - val_accuracy500: 0.3610 - 13s/epoch - 42ms/step
Epoch 11/50
295/295 - 13s - loss: 3.3021 - accuracy500: 0.3406 - val_loss: 3.2958 - val_accuracy500: 0.3610 - 13s/epoch - 42ms/step
Epoch 12/50
295/295 - 12s - loss: 3.3018 - accuracy500: 0.3416 - val_loss: 3.2954 - val_accuracy500: 0.3610 - 12s/epoch - 42ms/step
Epoch 13/50
295/295 - 13s - loss: 3.3013 - accuracy500: 0.3416 - val_loss: 3.2956 - val_accuracy500: 0.3609 - 13s/epoch - 43ms/step
Epoch 14/50
295/295 - 12s - loss: 3.3012 - accuracy500: 0.3424 - val_loss: 3.2956 - val_accuracy500: 0.3610 - 12s/epoch - 42ms/step
Epoch 15/50
295/295 - 13s - loss: 3.3005 - accuracy500: 0.3421 - val_loss: 3.2957 - val_accuracy500: 0.3610 - 13s/epoch - 42ms/step
Epoch 16/50
295/295 - 13s - loss: 3.2998 - accuracy500: 0.3441 - val_loss: 3.2971 - val_accuracy500: 0.3611 - 13s/epoch - 44ms/step
Epoch 17/50
295/295 - 12s - loss: 3.3006 - accuracy500: 0.3436 - val_loss: 3.2968 - val_accuracy500: 0.3612 - 12s/epoch - 42ms/step
Epoch 18/50
295/295 - 13s - loss: 3.2995 - accuracy500: 0.3446 - val_loss: 3.2979 - val_accuracy500: 0.3609 - 13s/epoch - 43ms/step
testing model: results/CHTR/W10/deepVOL_L3/h500
Evaluating performance on  test set...
1588/1588 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1110177
{'0': {'precision': 0.5943396226415094, 'recall': 0.00044149800975500363, 'f1-score': 0.0008823405834652176, 'support': 142696}, '1': {'precision': 0.3021822811869679, 'recall': 0.9994216828215362, 'f1-score': 0.4640544010831806, 'support': 122770}, '2': {'precision': 0.34306569343065696, 'recall': 0.0003337594091748331, 'f1-score': 0.000666870038380499, 'support': 140820}, 'accuracy': 0.30227229094775604, 'macro avg': {'precision': 0.4131958657530448, 'recall': 0.33339898008015534, 'f1-score': 0.15520120390167544, 'support': 406286}, 'weighted avg': {'precision': 0.41896426754227806, 'recall': 0.30227229094775604, 'f1-score': 0.1407672770700565, 'support': 406286}}
[[    63 142593     40]
 [    21 122699     50]
 [    22 140751     47]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050493
{'0': {'precision': 0.36363636363636365, 'recall': 0.00016792611251049538, 'f1-score': 0.00033569720112458566, 'support': 23820}, '1': {'precision': 0.3291186216037111, 'recall': 0.9992756539235412, 'f1-score': 0.4951545363908275, 'support': 24850}, '2': {'precision': 0.20689655172413793, 'recall': 0.00022371364653243848, 'f1-score': 0.0004469440202614623, 'support': 26820}, 'accuracy': 0.3290766989005166, 'macro avg': {'precision': 0.2998838456547375, 'recall': 0.33322243122752804, 'f1-score': 0.1653123925374045, 'support': 75490}, 'weighted avg': {'precision': 0.29658738171826443, 'recall': 0.3290766989005166, 'f1-score': 0.16326100907757668, 'support': 75490}}
[[    4 23807     9]
 [    4 24832    14]
 [    3 26811     6]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985231
{'0': {'precision': 0.16666666666666666, 'recall': 9.872642906506072e-05, 'f1-score': 0.00019733596447952642, 'support': 10129}, '1': {'precision': 0.3611302756696763, 'recall': 0.9996678568463008, 'f1-score': 0.5305861613045395, 'support': 12043}, '2': {'precision': 0.45454545454545453, 'recall': 0.00044714720085852264, 'f1-score': 0.000893415527561869, 'support': 11182}, 'accuracy': 0.36112610181687355, 'macro avg': {'precision': 0.32744746562726584, 'recall': 0.33340457682540814, 'f1-score': 0.1772256375988603, 'support': 33354}, 'weighted avg': {'precision': 0.33339287189793876, 'recall': 0.36112610181687355, 'f1-score': 0.19193614346117344, 'support': 33354}}
[[    1 10124     4]
 [    2 12039     2]
 [    3 11174     5]]
training model: results/CHTR/W10/deepVOL_L3/h1000
Epoch 1/50
295/295 - 16s - loss: 3.3259 - accuracy1000: 0.3714 - val_loss: 3.4310 - val_accuracy1000: 0.3444 - 16s/epoch - 53ms/step
Epoch 2/50
295/295 - 13s - loss: 3.3189 - accuracy1000: 0.3584 - val_loss: 3.5212 - val_accuracy1000: 0.3457 - 13s/epoch - 44ms/step
Epoch 3/50
295/295 - 13s - loss: 3.3167 - accuracy1000: 0.3510 - val_loss: 3.3446 - val_accuracy1000: 0.3456 - 13s/epoch - 43ms/step
Epoch 4/50
295/295 - 14s - loss: 3.3098 - accuracy1000: 0.3403 - val_loss: 3.3111 - val_accuracy1000: 0.3452 - 14s/epoch - 46ms/step
Epoch 5/50
295/295 - 13s - loss: 3.3068 - accuracy1000: 0.3359 - val_loss: 3.3032 - val_accuracy1000: 0.3454 - 13s/epoch - 45ms/step
Epoch 6/50
295/295 - 13s - loss: 3.3039 - accuracy1000: 0.3353 - val_loss: 3.3016 - val_accuracy1000: 0.3453 - 13s/epoch - 46ms/step
Epoch 7/50
295/295 - 13s - loss: 3.3037 - accuracy1000: 0.3321 - val_loss: 3.3009 - val_accuracy1000: 0.3457 - 13s/epoch - 46ms/step
Epoch 8/50
295/295 - 13s - loss: 3.3029 - accuracy1000: 0.3304 - val_loss: 3.3000 - val_accuracy1000: 0.3456 - 13s/epoch - 45ms/step
Epoch 9/50
295/295 - 13s - loss: 3.3029 - accuracy1000: 0.3313 - val_loss: 3.2988 - val_accuracy1000: 0.3457 - 13s/epoch - 44ms/step
Epoch 10/50
295/295 - 13s - loss: 3.3021 - accuracy1000: 0.3300 - val_loss: 3.2984 - val_accuracy1000: 0.3453 - 13s/epoch - 44ms/step
Epoch 11/50
295/295 - 13s - loss: 3.3022 - accuracy1000: 0.3308 - val_loss: 3.2986 - val_accuracy1000: 0.3452 - 13s/epoch - 43ms/step
Epoch 12/50
295/295 - 13s - loss: 3.3013 - accuracy1000: 0.3359 - val_loss: 3.2983 - val_accuracy1000: 0.3450 - 13s/epoch - 44ms/step
Epoch 13/50
295/295 - 13s - loss: 3.3006 - accuracy1000: 0.3331 - val_loss: 3.2975 - val_accuracy1000: 0.3476 - 13s/epoch - 43ms/step
Epoch 14/50
295/295 - 13s - loss: 3.2993 - accuracy1000: 0.3383 - val_loss: 3.2979 - val_accuracy1000: 0.3489 - 13s/epoch - 44ms/step
Epoch 15/50
295/295 - 12s - loss: 3.2975 - accuracy1000: 0.3409 - val_loss: 3.2976 - val_accuracy1000: 0.3515 - 12s/epoch - 42ms/step
Epoch 16/50
295/295 - 13s - loss: 3.2965 - accuracy1000: 0.3407 - val_loss: 3.2968 - val_accuracy1000: 0.3532 - 13s/epoch - 44ms/step
Epoch 17/50
295/295 - 13s - loss: 3.2951 - accuracy1000: 0.3459 - val_loss: 3.2953 - val_accuracy1000: 0.3569 - 13s/epoch - 43ms/step
Epoch 18/50
295/295 - 13s - loss: 3.2945 - accuracy1000: 0.3456 - val_loss: 3.2953 - val_accuracy1000: 0.3561 - 13s/epoch - 42ms/step
Epoch 19/50
295/295 - 13s - loss: 3.2937 - accuracy1000: 0.3465 - val_loss: 3.2946 - val_accuracy1000: 0.3563 - 13s/epoch - 43ms/step
Epoch 20/50
295/295 - 13s - loss: 3.2936 - accuracy1000: 0.3422 - val_loss: 3.2949 - val_accuracy1000: 0.3553 - 13s/epoch - 43ms/step
Epoch 21/50
295/295 - 13s - loss: 3.2910 - accuracy1000: 0.3419 - val_loss: 3.2969 - val_accuracy1000: 0.3567 - 13s/epoch - 44ms/step
Epoch 22/50
295/295 - 13s - loss: 3.2881 - accuracy1000: 0.3501 - val_loss: 3.2956 - val_accuracy1000: 0.3545 - 13s/epoch - 43ms/step
Epoch 23/50
295/295 - 13s - loss: 3.2881 - accuracy1000: 0.3493 - val_loss: 3.2986 - val_accuracy1000: 0.3544 - 13s/epoch - 44ms/step
Epoch 24/50
295/295 - 13s - loss: 3.2846 - accuracy1000: 0.3547 - val_loss: 3.2991 - val_accuracy1000: 0.3525 - 13s/epoch - 43ms/step
Epoch 25/50
295/295 - 13s - loss: 3.2836 - accuracy1000: 0.3584 - val_loss: 3.3028 - val_accuracy1000: 0.3516 - 13s/epoch - 43ms/step
Epoch 26/50
295/295 - 13s - loss: 3.2833 - accuracy1000: 0.3578 - val_loss: 3.3018 - val_accuracy1000: 0.3536 - 13s/epoch - 43ms/step
Epoch 27/50
295/295 - 13s - loss: 3.2817 - accuracy1000: 0.3603 - val_loss: 3.3021 - val_accuracy1000: 0.3525 - 13s/epoch - 44ms/step
Epoch 28/50
295/295 - 12s - loss: 3.2797 - accuracy1000: 0.3615 - val_loss: 3.3048 - val_accuracy1000: 0.3514 - 12s/epoch - 42ms/step
Epoch 29/50
295/295 - 13s - loss: 3.2786 - accuracy1000: 0.3666 - val_loss: 3.3045 - val_accuracy1000: 0.3513 - 13s/epoch - 44ms/step
testing model: results/CHTR/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
1588/1588 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984854
{'0': {'precision': 0.3696027633851468, 'recall': 0.004466118025168871, 'f1-score': 0.008825591465845512, 'support': 143749}, '1': {'precision': 0.31673197863183905, 'recall': 0.8342974375477694, 'f1-score': 0.4591519112327263, 'support': 124295}, '2': {'precision': 0.38004562777072043, 'recall': 0.21208460525744707, 'f1-score': 0.27224357902947244, 'support': 138242}, 'accuracy': 0.32898007807308155, 'macro avg': {'precision': 0.35546012326256876, 'recall': 0.3502827202767951, 'f1-score': 0.24674036057601476, 'support': 406286}, 'weighted avg': {'precision': 0.35698128065494705, 'recall': 0.32898007807308155, 'f1-score': 0.23622387580789853, 'support': 406286}}
[[   642 115406  27701]
 [   470 103699  20126]
 [   625 108298  29319]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959595
{'0': {'precision': 0.32919254658385094, 'recall': 0.004497051461541725, 'f1-score': 0.008872891641903486, 'support': 23571}, '1': {'precision': 0.33967044875063745, 'recall': 0.8594064994758487, 'f1-score': 0.4868995134431323, 'support': 24802}, '2': {'precision': 0.39650451030927836, 'recall': 0.18154663126452042, 'f1-score': 0.24905774922216886, 'support': 27117}, 'accuracy': 0.3489733739568155, 'macro avg': {'precision': 0.3551225018812556, 'recall': 0.3484833940673036, 'f1-score': 0.24827671810240157, 'support': 75490}, 'weighted avg': {'precision': 0.3568143700026224, 'recall': 0.3489733739568155, 'f1-score': 0.2522045787119543, 'support': 75490}}
[[  106 19375  4090]
 [   84 21315  3403]
 [  132 22062  4923]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964422
{'0': {'precision': 0.3153846153846154, 'recall': 0.00396671826625387, 'f1-score': 0.007834893942289317, 'support': 10336}, '1': {'precision': 0.34904536759663624, 'recall': 0.8393508071515362, 'f1-score': 0.4930536082999822, 'support': 11522}, '2': {'precision': 0.3726663041508066, 'recall': 0.17884481558803061, 'f1-score': 0.2416975254217363, 'support': 11496}, 'accuracy': 0.35282125082448884, 'macro avg': {'precision': 0.3456987623773527, 'recall': 0.3407207803352736, 'f1-score': 0.24752867588800262, 'support': 33354}, 'weighted avg': {'precision': 0.34675564977458473, 'recall': 0.35282125082448884, 'f1-score': 0.25605624185609455, 'support': 33354}}
[[  41 8643 1652]
 [  42 9671 1809]
 [  47 9393 2056]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  12.12 (ave)

============================================
