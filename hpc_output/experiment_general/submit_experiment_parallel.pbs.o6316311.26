This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-04-17.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-09.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-27.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-28.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-05.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-01.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-03.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-02.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-04.csv
data/AAL_orderbooks/AAL_orderbooks_2019-03-26.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-10.csv
training model: results/AAL/W2/deepLOB_L1/h10
Epoch 1/50
2076/2076 - 41s - loss: 2.8310 - accuracy10: 0.4354 - val_loss: 2.9668 - val_accuracy10: 0.4276 - 41s/epoch - 20ms/step
Epoch 2/50
2076/2076 - 32s - loss: 2.7415 - accuracy10: 0.4571 - val_loss: 2.9629 - val_accuracy10: 0.2988 - 32s/epoch - 16ms/step
Epoch 3/50
2076/2076 - 32s - loss: 2.6259 - accuracy10: 0.5138 - val_loss: 2.8733 - val_accuracy10: 0.3637 - 32s/epoch - 16ms/step
Epoch 4/50
2076/2076 - 32s - loss: 2.5441 - accuracy10: 0.5500 - val_loss: 2.8880 - val_accuracy10: 0.3845 - 32s/epoch - 16ms/step
Epoch 5/50
2076/2076 - 32s - loss: 2.4912 - accuracy10: 0.5684 - val_loss: 2.7288 - val_accuracy10: 0.4971 - 32s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 32s - loss: 2.4390 - accuracy10: 0.5866 - val_loss: 2.7678 - val_accuracy10: 0.5377 - 32s/epoch - 16ms/step
Epoch 7/50
2076/2076 - 32s - loss: 2.4137 - accuracy10: 0.5952 - val_loss: 2.7775 - val_accuracy10: 0.5502 - 32s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 32s - loss: 2.3854 - accuracy10: 0.6020 - val_loss: 2.8315 - val_accuracy10: 0.5435 - 32s/epoch - 16ms/step
Epoch 9/50
2076/2076 - 31s - loss: 2.3714 - accuracy10: 0.6042 - val_loss: 2.8071 - val_accuracy10: 0.5210 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 2.3449 - accuracy10: 0.6112 - val_loss: 2.8043 - val_accuracy10: 0.4778 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 2.3266 - accuracy10: 0.6161 - val_loss: 2.9206 - val_accuracy10: 0.4310 - 31s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 30s - loss: 2.3070 - accuracy10: 0.6201 - val_loss: 2.8343 - val_accuracy10: 0.4439 - 30s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 31s - loss: 2.2936 - accuracy10: 0.6219 - val_loss: 2.8631 - val_accuracy10: 0.4234 - 31s/epoch - 15ms/step
Epoch 14/50
2076/2076 - 31s - loss: 2.2781 - accuracy10: 0.6252 - val_loss: 2.8725 - val_accuracy10: 0.4339 - 31s/epoch - 15ms/step
Epoch 15/50
2076/2076 - 31s - loss: 2.2667 - accuracy10: 0.6282 - val_loss: 2.9629 - val_accuracy10: 0.3916 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h10
Evaluating performance on  test set...
4856/4856 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9796577
{'0': {'precision': 0.3324787174136275, 'recall': 0.6112590740049044, 'f1-score': 0.4306930055796883, 'support': 246308}, '1': {'precision': 0.7705216210789985, 'recall': 0.423086917492165, 'f1-score': 0.5462387491189069, 'support': 761964}, '2': {'precision': 0.351297614627558, 'recall': 0.5564903487574212, 'f1-score': 0.43070351220075376, 'support': 234633}, 'accuracy': 0.48556084334683663, 'macro avg': {'precision': 0.48476598437339463, 'recall': 0.5302787800848302, 'f1-score': 0.4692117556331163, 'support': 1242905}, 'weighted avg': {'precision': 0.6045738955314054, 'recall': 0.48556084334683663, 'f1-score': 0.5015304083821049, 'support': 1242905}}
[[150558  49084  46666]
 [245142 322377 194445]
 [ 57135  46927 130571]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84330523
{'0': {'precision': 0.2726709164278613, 'recall': 0.3202725724020443, 'f1-score': 0.29456100781511596, 'support': 72788}, '1': {'precision': 0.8029834956938233, 'recall': 0.6443967593834391, 'f1-score': 0.7150021021060068, 'support': 384001}, '2': {'precision': 0.31237069247130733, 'recall': 0.5766473244797041, 'f1-score': 0.4052285119647414, 'support': 74621}, 'accuracy': 0.5904875708022055, 'macro avg': {'precision': 0.46267503486433065, 'recall': 0.5137722187550625, 'f1-score': 0.4715972072952881, 'support': 531410}, 'weighted avg': {'precision': 0.6614535846856033, 'recall': 0.5904875708022055, 'f1-score': 0.6139150291469417, 'support': 531410}}
[[ 23312  37036  12440]
 [ 54269 247449  82283]
 [  7914  23677  43030]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9308917
{'0': {'precision': 0.24636164926112056, 'recall': 0.6523373732376948, 'f1-score': 0.35765235550975016, 'support': 20215}, '1': {'precision': 0.8552739445279409, 'recall': 0.4552090245520902, 'f1-score': 0.5941754714854386, 'support': 110011}, '2': {'precision': 0.299887525829824, 'recall': 0.5708524198366859, 'f1-score': 0.39320929434965274, 'support': 20084}, 'accuracy': 0.4971725101456989, 'macro avg': {'precision': 0.4671743732062951, 'recall': 0.559466272542157, 'f1-score': 0.4483457071149472, 'support': 150310}, 'weighted avg': {'precision': 0.6991729340698759, 'recall': 0.4971725101456989, 'f1-score': 0.5355132434830192, 'support': 150310}}
[[13187  4576  2452]
 [35619 50078 24314]
 [ 4721  3898 11465]]
training model: results/AAL/W2/deepLOB_L1/h20
Epoch 1/50
2076/2076 - 33s - loss: 2.9388 - accuracy20: 0.4112 - val_loss: 3.1456 - val_accuracy20: 0.4430 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 2.8525 - accuracy20: 0.4432 - val_loss: 3.0166 - val_accuracy20: 0.3666 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 30s - loss: 2.7488 - accuracy20: 0.5002 - val_loss: 3.0254 - val_accuracy20: 0.4871 - 30s/epoch - 14ms/step
Epoch 4/50
2076/2076 - 32s - loss: 2.6733 - accuracy20: 0.5330 - val_loss: 2.9484 - val_accuracy20: 0.4790 - 32s/epoch - 16ms/step
Epoch 5/50
2076/2076 - 32s - loss: 2.6009 - accuracy20: 0.5593 - val_loss: 3.0381 - val_accuracy20: 0.5235 - 32s/epoch - 16ms/step
Epoch 6/50
2076/2076 - 31s - loss: 2.5616 - accuracy20: 0.5740 - val_loss: 3.0354 - val_accuracy20: 0.4778 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 2.5248 - accuracy20: 0.5821 - val_loss: 3.0532 - val_accuracy20: 0.4630 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 31s - loss: 2.5000 - accuracy20: 0.5891 - val_loss: 3.0557 - val_accuracy20: 0.4628 - 31s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 2.4698 - accuracy20: 0.5966 - val_loss: 3.0619 - val_accuracy20: 0.4482 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 2.4512 - accuracy20: 0.6013 - val_loss: 3.0370 - val_accuracy20: 0.4294 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 2.4339 - accuracy20: 0.6047 - val_loss: 3.0461 - val_accuracy20: 0.4347 - 31s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 31s - loss: 2.4183 - accuracy20: 0.6083 - val_loss: 3.0439 - val_accuracy20: 0.4273 - 31s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 30s - loss: 2.4051 - accuracy20: 0.6105 - val_loss: 3.0833 - val_accuracy20: 0.4384 - 30s/epoch - 15ms/step
Epoch 14/50
2076/2076 - 31s - loss: 2.3936 - accuracy20: 0.6124 - val_loss: 3.0780 - val_accuracy20: 0.4260 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h20
Evaluating performance on  test set...
4856/4856 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0265076
{'0': {'precision': 0.3757144341681388, 'recall': 0.4936606393976632, 'f1-score': 0.4266867855818188, 'support': 307602}, '1': {'precision': 0.6131267083665596, 'recall': 0.4173692583330457, 'f1-score': 0.4966545193858653, 'support': 637402}, '2': {'precision': 0.37717398016524845, 'recall': 0.5125763256920923, 'f1-score': 0.4345723775019708, 'support': 297901}, 'accuracy': 0.4590696795008468, 'macro avg': {'precision': 0.45533837423331563, 'recall': 0.47453540780760045, 'f1-score': 0.45263789415655165, 'support': 1242905}, 'weighted avg': {'precision': 0.49781697507891376, 'recall': 0.4590696795008468, 'f1-score': 0.46445853738969795, 'support': 1242905}}
[[151851  89022  66729]
 [185951 266032 185419]
 [ 66364  78840 152697]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9192605
{'0': {'precision': 0.3294050258292406, 'recall': 0.3224279173112664, 'f1-score': 0.3258791306811623, 'support': 96313}, '1': {'precision': 0.7161010271764824, 'recall': 0.5936808724802323, 'f1-score': 0.6491698850160471, 'support': 336787}, '2': {'precision': 0.3474940636378028, 'recall': 0.5582138134472586, 'f1-score': 0.4283411711905087, 'support': 98310}, 'accuracy': 0.537957509267797, 'macro avg': {'precision': 0.4643333722145086, 'recall': 0.49144086774625245, 'f1-score': 0.4677967289625727, 'support': 531410}, 'weighted avg': {'precision': 0.577824362147137, 'recall': 0.5379575092677968, 'f1-score': 0.5497235567978268, 'support': 531410}}
[[ 31054  47416  17843]
 [ 51639 199944  85204]
 [ 11580  31852  54878]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9716101
{'0': {'precision': 0.305308804707051, 'recall': 0.5931561757719715, 'f1-score': 0.40312267470456925, 'support': 26944}, '1': {'precision': 0.7386041103853914, 'recall': 0.44722130197117776, 'f1-score': 0.557113194650434, 'support': 96592}, '2': {'precision': 0.326721888694683, 'recall': 0.48173601254948833, 'f1-score': 0.38936770765724293, 'support': 26774}, 'accuracy': 0.47952897345485995, 'macro avg': {'precision': 0.4568782679290418, 'recall': 0.5073711634308792, 'f1-score': 0.44986785900408205, 'support': 150310}, 'weighted avg': {'precision': 0.5875666323749847, 'recall': 0.47952897345485995, 'f1-score': 0.49962973887119716, 'support': 150310}}
[[15982  8013  2949]
 [29764 43198 23630]
 [ 6601  7275 12898]]
training model: results/AAL/W2/deepLOB_L1/h30
Epoch 1/50
2076/2076 - 33s - loss: 2.9510 - accuracy30: 0.4537 - val_loss: 3.3641 - val_accuracy30: 0.4272 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 32s - loss: 2.9313 - accuracy30: 0.4441 - val_loss: 3.3068 - val_accuracy30: 0.3725 - 32s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 2.8579 - accuracy30: 0.4765 - val_loss: 3.3097 - val_accuracy30: 0.5132 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 2.7683 - accuracy30: 0.5175 - val_loss: 3.0853 - val_accuracy30: 0.5110 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 2.6841 - accuracy30: 0.5514 - val_loss: 3.1175 - val_accuracy30: 0.4329 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 2.6416 - accuracy30: 0.5648 - val_loss: 3.0769 - val_accuracy30: 0.4498 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 2.6120 - accuracy30: 0.5710 - val_loss: 3.1522 - val_accuracy30: 0.4465 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 31s - loss: 2.5904 - accuracy30: 0.5761 - val_loss: 3.2720 - val_accuracy30: 0.4049 - 31s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 2.5737 - accuracy30: 0.5796 - val_loss: 3.2122 - val_accuracy30: 0.4167 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 2.5552 - accuracy30: 0.5829 - val_loss: 3.1910 - val_accuracy30: 0.4189 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 2.5389 - accuracy30: 0.5864 - val_loss: 3.3079 - val_accuracy30: 0.3952 - 31s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 30s - loss: 2.5275 - accuracy30: 0.5888 - val_loss: 3.3231 - val_accuracy30: 0.3910 - 30s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 30s - loss: 2.5172 - accuracy30: 0.5910 - val_loss: 3.4180 - val_accuracy30: 0.3847 - 30s/epoch - 15ms/step
Epoch 14/50
2076/2076 - 31s - loss: 2.5091 - accuracy30: 0.5927 - val_loss: 3.2543 - val_accuracy30: 0.4152 - 31s/epoch - 15ms/step
Epoch 15/50
2076/2076 - 31s - loss: 2.4987 - accuracy30: 0.5941 - val_loss: 3.4037 - val_accuracy30: 0.3875 - 31s/epoch - 15ms/step
Epoch 16/50
2076/2076 - 30s - loss: 2.4949 - accuracy30: 0.5950 - val_loss: 3.4397 - val_accuracy30: 0.3821 - 30s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h30
Evaluating performance on  test set...
4856/4856 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0677117
{'0': {'precision': 0.3990855239382179, 'recall': 0.4368317558232195, 'f1-score': 0.4171064155901029, 'support': 348862}, '1': {'precision': 0.5618423847399973, 'recall': 0.31924394663746114, 'f1-score': 0.40714462114555156, 'support': 555146}, '2': {'precision': 0.3726338323484993, 'recall': 0.5999226903749517, 'f1-score': 0.4597192780142566, 'support': 338897}, 'accuracy': 0.4287801561664005, 'macro avg': {'precision': 0.4445205803422381, 'recall': 0.4519994642785441, 'f1-score': 0.427990104916637, 'support': 1242905}, 'weighted avg': {'precision': 0.46456874375146484, 'recall': 0.4287801561664005, 'f1-score': 0.42427600690902395, 'support': 1242905}}
[[152394  86100 110368]
 [145991 177227 231928]
 [ 83473  52112 203312]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98718196
{'0': {'precision': 0.35629265196000637, 'recall': 0.2381878624982317, 'f1-score': 0.285508382966998, 'support': 113104}, '1': {'precision': 0.6177604469313291, 'recall': 0.6908808413218888, 'f1-score': 0.6522778413647583, 'support': 303142}, '2': {'precision': 0.3434467994005566, 'recall': 0.34825118960786355, 'f1-score': 0.34583230935720166, 'support': 115164}, 'accuracy': 0.5202781279990968, 'macro avg': {'precision': 0.43916663276396406, 'recall': 0.425773297809328, 'f1-score': 0.427872844562986, 'support': 531410}, 'weighted avg': {'precision': 0.5026626685931903, 'recall': 0.5202781279990968, 'f1-score': 0.5078044854423283, 'support': 531410}}
[[ 26940  68095  18069]
 [ 35107 209435  58600]
 [ 13565  61493  40106]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0166433
{'0': {'precision': 0.32569166862606785, 'recall': 0.52113117632305, 'f1-score': 0.4008585347031303, 'support': 31896}, '1': {'precision': 0.6949912936597358, 'recall': 0.39106879380302473, 'f1-score': 0.5005052852095274, 'support': 86752}, '2': {'precision': 0.33692701004776154, 'recall': 0.5369528140989198, 'f1-score': 0.41404756396049724, 'support': 31662}, 'accuracy': 0.4493979109839665, 'macro avg': {'precision': 0.4525366574445217, 'recall': 0.48305092807499816, 'f1-score': 0.43847046129105166, 'support': 150310}, 'weighted avg': {'precision': 0.5412010455871112, 'recall': 0.4493979109839665, 'f1-score': 0.46114824226934487, 'support': 150310}}
[[16622  9178  6096]
 [25464 33926 27362]
 [ 8950  5711 17001]]
training model: results/AAL/W2/deepLOB_L1/h50
Epoch 1/50
2076/2076 - 33s - loss: 3.0269 - accuracy50: 0.4634 - val_loss: 3.3981 - val_accuracy50: 0.3908 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 3.0017 - accuracy50: 0.4678 - val_loss: 3.4877 - val_accuracy50: 0.4390 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 2.9405 - accuracy50: 0.4907 - val_loss: 3.5804 - val_accuracy50: 0.4453 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 2.8734 - accuracy50: 0.5176 - val_loss: 3.5878 - val_accuracy50: 0.4348 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 2.8270 - accuracy50: 0.5298 - val_loss: 3.5991 - val_accuracy50: 0.4343 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 2.7996 - accuracy50: 0.5382 - val_loss: 3.8911 - val_accuracy50: 0.4106 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 2.7881 - accuracy50: 0.5402 - val_loss: 3.9380 - val_accuracy50: 0.4025 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 31s - loss: 2.7681 - accuracy50: 0.5448 - val_loss: 3.9325 - val_accuracy50: 0.3984 - 31s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 2.7500 - accuracy50: 0.5486 - val_loss: 3.8669 - val_accuracy50: 0.4017 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 30s - loss: 2.7384 - accuracy50: 0.5518 - val_loss: 3.8103 - val_accuracy50: 0.4033 - 30s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 2.7281 - accuracy50: 0.5546 - val_loss: 3.5627 - val_accuracy50: 0.4169 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h50
Evaluating performance on  test set...
4856/4856 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1411617
{'0': {'precision': 0.40823407623186136, 'recall': 0.3346605584706814, 'f1-score': 0.3678040937614806, 'support': 405357}, '1': {'precision': 0.3533525748260011, 'recall': 0.3991201660810094, 'f1-score': 0.3748445111239828, 'support': 445084}, '2': {'precision': 0.3477529605021208, 'recall': 0.3614038485058502, 'f1-score': 0.35444701836983067, 'support': 392464}, 'accuracy': 0.3661880835622996, 'macro avg': {'precision': 0.3697798705199944, 'recall': 0.36506152435251366, 'f1-score': 0.3656985410850981, 'support': 1242905}, 'weighted avg': {'precision': 0.36948329578163963, 'recall': 0.3661880835622996, 'f1-score': 0.3661075891089637, 'support': 1242905}}
[[135657 177041  92659]
 [ 94069 177642 173373]
 [102576 148050 141838]]
Evaluating performance on  train set...
2076/2076 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0982329
{'0': {'precision': 0.34542715054260414, 'recall': 0.27011847364882935, 'f1-score': 0.30316600750430994, 'support': 138343}, '1': {'precision': 0.4825119519147274, 'recall': 0.59235863151262, 'f1-score': 0.5318223866790008, 'support': 252337}, '2': {'precision': 0.3292873198466217, 'recall': 0.2654444681304626, 'f1-score': 0.2939392151077014, 'support': 140730}, 'accuracy': 0.4218945823375548, 'macro avg': {'precision': 0.3857421407679844, 'recall': 0.37597385776397063, 'f1-score': 0.37630920309700405, 'support': 531410}, 'weighted avg': {'precision': 0.4062468738259294, 'recall': 0.4218945823375548, 'f1-score': 0.4092987077881383, 'support': 531410}}
[[ 37369  81122  19852]
 [ 46626 149474  56237]
 [ 24187  79187  37356]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1061814
{'0': {'precision': 0.3266765825276696, 'recall': 0.37915714648387916, 'f1-score': 0.35096583164919865, 'support': 39390}, '1': {'precision': 0.4862565556827306, 'recall': 0.39598781319124665, 'f1-score': 0.4365041635357083, 'support': 71881}, '2': {'precision': 0.33195092823797634, 'recall': 0.3916083916083916, 'f1-score': 0.3593202811009002, 'support': 39039}, 'accuracy': 0.39043975783381013, 'macro avg': {'precision': 0.3816280221494588, 'recall': 0.38891778376117253, 'f1-score': 0.38226342542860237, 'support': 150310}, 'weighted avg': {'precision': 0.4043605239323905, 'recall': 0.39043975783381013, 'f1-score': 0.3940416761470975, 'support': 150310}}
[[14935 17157  7298]
 [19948 28464 23469]
 [10835 12916 15288]]
training model: results/AAL/W2/deepLOB_L1/h100
Epoch 1/50
2076/2076 - 33s - loss: 3.1530 - accuracy100: 0.4429 - val_loss: 3.7125 - val_accuracy100: 0.3432 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 3.1495 - accuracy100: 0.4450 - val_loss: 3.5150 - val_accuracy100: 0.3497 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 3.1339 - accuracy100: 0.4518 - val_loss: 3.6238 - val_accuracy100: 0.3537 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 3.0945 - accuracy100: 0.4652 - val_loss: 3.7519 - val_accuracy100: 0.3466 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 3.0639 - accuracy100: 0.4734 - val_loss: 3.6840 - val_accuracy100: 0.3436 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 3.0456 - accuracy100: 0.4782 - val_loss: 3.8040 - val_accuracy100: 0.3544 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 30s - loss: 3.0270 - accuracy100: 0.4824 - val_loss: 3.8083 - val_accuracy100: 0.3606 - 30s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 30s - loss: 3.0153 - accuracy100: 0.4856 - val_loss: 3.6748 - val_accuracy100: 0.3639 - 30s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 3.0021 - accuracy100: 0.4886 - val_loss: 3.6903 - val_accuracy100: 0.3573 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 2.9936 - accuracy100: 0.4901 - val_loss: 3.8345 - val_accuracy100: 0.3626 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 2.9838 - accuracy100: 0.4933 - val_loss: 3.7550 - val_accuracy100: 0.3641 - 31s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 31s - loss: 2.9754 - accuracy100: 0.4945 - val_loss: 3.7264 - val_accuracy100: 0.3697 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h100
Evaluating performance on  test set...
4856/4856 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1866724
{'0': {'precision': 0.5822673136303484, 'recall': 0.0027564201619605664, 'f1-score': 0.00548686581495545, 'support': 478882}, '1': {'precision': 0.26494571792679583, 'recall': 0.21560924700693132, 'f1-score': 0.23774490290735123, 'support': 304704}, '2': {'precision': 0.3849370488196528, 'recall': 0.8319207348269939, 'f1-score': 0.5263344933481084, 'support': 459319}, 'accuracy': 0.3613582695378971, 'macro avg': {'precision': 0.41071669345893236, 'recall': 0.3500954673319619, 'f1-score': 0.25652208735680504, 'support': 1242905}, 'weighted avg': {'precision': 0.4315504853934042, 'recall': 0.3613582695378971, 'f1-score': 0.2549067043103366, 'support': 1242905}}
[[  1320 105475 372087]
 [   537  65697 238470]
 [   410  76792 382117]]
Evaluating performance on  train set...
2076/2076 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1724643
{'0': {'precision': 0.40989910684750247, 'recall': 0.056534583447394836, 'f1-score': 0.09936450022052043, 'support': 175344}, '1': {'precision': 0.34299134208091564, 'recall': 0.6481026374289257, 'f1-score': 0.44858226972151827, 'support': 179038}, '2': {'precision': 0.3692333193230052, 'recall': 0.3523284452177057, 'f1-score': 0.3605828571098219, 'support': 177028}, 'accuracy': 0.35437797557441525, 'macro avg': {'precision': 0.3740412560838077, 'recall': 0.3523218886980087, 'f1-score': 0.30284320901728684, 'support': 531410}, 'weighted avg': {'precision': 0.37381018224659757, 'recall': 0.35437797557441525, 'f1-score': 0.30403926038558865, 'support': 531410}}
[[  9913 113309  52122]
 [  8574 116035  54429]
 [  5697 108959  62372]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.170087
{'0': {'precision': 0.4405917706888581, 'recall': 0.01884292945270484, 'f1-score': 0.036140237774701836, 'support': 50576}, '1': {'precision': 0.3404451360592969, 'recall': 0.3328129065833984, 'f1-score': 0.33658576084536124, 'support': 49959}, '2': {'precision': 0.35084786724130984, 'recall': 0.6999899547965847, 'f1-score': 0.46741747885406115, 'support': 49775}, 'accuracy': 0.3487592309227596, 'macro avg': {'precision': 0.37729492466315495, 'recall': 0.3505485969442293, 'f1-score': 0.28004782582470805, 'support': 150310}, 'weighted avg': {'precision': 0.37758712353590773, 'recall': 0.3487592309227596, 'f1-score': 0.27881725568310567, 'support': 150310}}
[[  953 17863 31760]
 [  626 16627 32706]
 [  584 14349 34842]]
training model: results/AAL/W2/deepLOB_L1/h200
Epoch 1/50
2076/2076 - 34s - loss: 3.2453 - accuracy200: 0.4039 - val_loss: 3.4340 - val_accuracy200: 0.3554 - 34s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 3.2260 - accuracy200: 0.4121 - val_loss: 3.5259 - val_accuracy200: 0.3481 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 30s - loss: 3.2140 - accuracy200: 0.4181 - val_loss: 3.4897 - val_accuracy200: 0.3614 - 30s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 3.2050 - accuracy200: 0.4209 - val_loss: 3.5086 - val_accuracy200: 0.3555 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 3.1981 - accuracy200: 0.4239 - val_loss: 3.4747 - val_accuracy200: 0.3479 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 3.1897 - accuracy200: 0.4273 - val_loss: 3.5634 - val_accuracy200: 0.3536 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 3.1838 - accuracy200: 0.4294 - val_loss: 3.5575 - val_accuracy200: 0.3461 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 30s - loss: 3.1800 - accuracy200: 0.4321 - val_loss: 3.5568 - val_accuracy200: 0.3563 - 30s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 30s - loss: 3.1741 - accuracy200: 0.4344 - val_loss: 3.5289 - val_accuracy200: 0.3490 - 30s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 3.1714 - accuracy200: 0.4353 - val_loss: 3.5382 - val_accuracy200: 0.3503 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 3.1682 - accuracy200: 0.4363 - val_loss: 3.5682 - val_accuracy200: 0.3523 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h200
Evaluating performance on  test set...
4856/4856 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1571822
{'0': {'precision': 0.45121951219512196, 'recall': 0.012370758432407007, 'f1-score': 0.024081297382701868, 'support': 433684}, '1': {'precision': 0.34954699862308297, 'recall': 0.20814035376303736, 'f1-score': 0.26091621278097016, 'support': 389074}, '2': {'precision': 0.35262143539022833, 'recall': 0.8387254936962539, 'f1-score': 0.49650119585624364, 'support': 420147}, 'accuracy': 0.3529915802092678, 'macro avg': {'precision': 0.38446264873614444, 'recall': 0.3530788686305661, 'f1-score': 0.2604995686733052, 'support': 1242905}, 'weighted avg': {'precision': 0.38606262754112736, 'recall': 0.3529915802092678, 'f1-score': 0.25791422182795637, 'support': 1242905}}
[[  5365  85522 342797]
 [  3939  80982 304153]
 [  2586  65173 352388]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1477389
{'0': {'precision': 0.34106563394963824, 'recall': 0.3424802467190419, 'f1-score': 0.34177147654870116, 'support': 177692}, '1': {'precision': 0.3380286958612766, 'recall': 0.35722070690813806, 'f1-score': 0.34735980846530623, 'support': 177081}, '2': {'precision': 0.3740035936953559, 'recall': 0.3511551939854051, 'f1-score': 0.36221943862907063, 'support': 176637}, 'accuracy': 0.35027568167704787, 'macro avg': {'precision': 0.35103264116875693, 'recall': 0.35028538253752833, 'f1-score': 0.35045024121435936, 'support': 531410}, 'weighted avg': {'precision': 0.35100198885823825, 'recall': 0.35027568167704787, 'f1-score': 0.3504304293010291, 'support': 531410}}
[[60856 64117 52719]
 [62724 63257 51100]
 [54849 59761 62027]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1449082
{'0': {'precision': 0.360533053239677, 'recall': 0.1109024454271925, 'f1-score': 0.1696265867745622, 'support': 49521}, '1': {'precision': 0.3689099329866232, 'recall': 0.2751712824471678, 'f1-score': 0.31521931376016976, 'support': 51815}, '2': {'precision': 0.3511739328825652, 'recall': 0.6914485237064565, 'f1-score': 0.46578451465591947, 'support': 48974}, 'accuracy': 0.356682855432107, 'macro avg': {'precision': 0.36020563970295516, 'recall': 0.3591740838602722, 'f1-score': 0.3168768050635505, 'support': 150310}, 'weighted avg': {'precision': 0.36037135051676317, 'recall': 0.356682855432107, 'f1-score': 0.31630961191474477, 'support': 150310}}
[[ 5492 13868 30161]
 [ 5153 14258 32404]
 [ 4588 10523 33863]]
training model: results/AAL/W2/deepLOB_L1/h300
Epoch 1/50
2076/2076 - 33s - loss: 3.2665 - accuracy300: 0.3917 - val_loss: 3.4726 - val_accuracy300: 0.3394 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 3.2385 - accuracy300: 0.4052 - val_loss: 3.5123 - val_accuracy300: 0.3379 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 3.2241 - accuracy300: 0.4121 - val_loss: 3.5245 - val_accuracy300: 0.3402 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 3.2138 - accuracy300: 0.4173 - val_loss: 3.5061 - val_accuracy300: 0.3382 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 3.2070 - accuracy300: 0.4202 - val_loss: 3.4993 - val_accuracy300: 0.3383 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 3.2026 - accuracy300: 0.4221 - val_loss: 3.4657 - val_accuracy300: 0.3389 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 3.1990 - accuracy300: 0.4239 - val_loss: 3.4602 - val_accuracy300: 0.3375 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 31s - loss: 3.1946 - accuracy300: 0.4255 - val_loss: 3.4827 - val_accuracy300: 0.3398 - 31s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 3.1924 - accuracy300: 0.4263 - val_loss: 3.4931 - val_accuracy300: 0.3402 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 30s - loss: 3.1888 - accuracy300: 0.4281 - val_loss: 3.4537 - val_accuracy300: 0.3375 - 30s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 30s - loss: 3.1860 - accuracy300: 0.4288 - val_loss: 3.4596 - val_accuracy300: 0.3381 - 30s/epoch - 14ms/step
Epoch 12/50
2076/2076 - 30s - loss: 3.1831 - accuracy300: 0.4300 - val_loss: 3.4415 - val_accuracy300: 0.3405 - 30s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 30s - loss: 3.1809 - accuracy300: 0.4314 - val_loss: 3.4458 - val_accuracy300: 0.3389 - 30s/epoch - 15ms/step
Epoch 14/50
2076/2076 - 30s - loss: 3.1779 - accuracy300: 0.4322 - val_loss: 3.4592 - val_accuracy300: 0.3401 - 30s/epoch - 15ms/step
Epoch 15/50
2076/2076 - 30s - loss: 3.1755 - accuracy300: 0.4327 - val_loss: 3.4387 - val_accuracy300: 0.3403 - 30s/epoch - 15ms/step
Epoch 16/50
2076/2076 - 30s - loss: 3.1739 - accuracy300: 0.4342 - val_loss: 3.4807 - val_accuracy300: 0.3415 - 30s/epoch - 15ms/step
Epoch 17/50
2076/2076 - 30s - loss: 3.1716 - accuracy300: 0.4353 - val_loss: 3.4501 - val_accuracy300: 0.3435 - 30s/epoch - 15ms/step
Epoch 18/50
2076/2076 - 30s - loss: 3.1704 - accuracy300: 0.4361 - val_loss: 3.4600 - val_accuracy300: 0.3442 - 30s/epoch - 15ms/step
Epoch 19/50
2076/2076 - 30s - loss: 3.1693 - accuracy300: 0.4362 - val_loss: 3.4343 - val_accuracy300: 0.3406 - 30s/epoch - 15ms/step
Epoch 20/50
2076/2076 - 30s - loss: 3.1702 - accuracy300: 0.4361 - val_loss: 3.4359 - val_accuracy300: 0.3412 - 30s/epoch - 15ms/step
Epoch 21/50
2076/2076 - 31s - loss: 3.1666 - accuracy300: 0.4367 - val_loss: 3.4459 - val_accuracy300: 0.3454 - 31s/epoch - 15ms/step
Epoch 22/50
2076/2076 - 30s - loss: 3.1627 - accuracy300: 0.4389 - val_loss: 3.4747 - val_accuracy300: 0.3437 - 30s/epoch - 15ms/step
Epoch 23/50
2076/2076 - 30s - loss: 3.1610 - accuracy300: 0.4397 - val_loss: 3.5003 - val_accuracy300: 0.3445 - 30s/epoch - 15ms/step
Epoch 24/50
2076/2076 - 30s - loss: 3.1602 - accuracy300: 0.4399 - val_loss: 3.5742 - val_accuracy300: 0.3409 - 30s/epoch - 15ms/step
Epoch 25/50
2076/2076 - 30s - loss: 3.1584 - accuracy300: 0.4404 - val_loss: 3.5420 - val_accuracy300: 0.3402 - 30s/epoch - 15ms/step
Epoch 26/50
2076/2076 - 30s - loss: 3.1561 - accuracy300: 0.4411 - val_loss: 3.5508 - val_accuracy300: 0.3403 - 30s/epoch - 15ms/step
Epoch 27/50
2076/2076 - 31s - loss: 3.1532 - accuracy300: 0.4426 - val_loss: 3.5337 - val_accuracy300: 0.3445 - 31s/epoch - 15ms/step
Epoch 28/50
2076/2076 - 31s - loss: 3.1513 - accuracy300: 0.4437 - val_loss: 3.5808 - val_accuracy300: 0.3492 - 31s/epoch - 15ms/step
Epoch 29/50
2076/2076 - 31s - loss: 3.1499 - accuracy300: 0.4440 - val_loss: 3.5862 - val_accuracy300: 0.3439 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h300
Evaluating performance on  test set...
4856/4856 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1339624
{'0': {'precision': 0.42419473715663036, 'recall': 0.04787986302694268, 'f1-score': 0.08604735736221107, 'support': 444759}, '1': {'precision': 0.29118767136070955, 'recall': 0.18071953556998854, 'f1-score': 0.22302393334603968, 'support': 362595}, '2': {'precision': 0.3548731123413323, 'recall': 0.7884243177033229, 'f1-score': 0.4894449757628536, 'support': 435551}, 'accuracy': 0.3461423037158914, 'macro avg': {'precision': 0.35675184028622403, 'recall': 0.3390079054334181, 'f1-score': 0.2661720888237014, 'support': 1242905}, 'weighted avg': {'precision': 0.36109997123952503, 'recall': 0.3461423037158914, 'f1-score': 0.26737035281308996, 'support': 1242905}}
[[ 21295  81140 342324]
 [ 15123  65528 281944]
 [ 13783  78369 343399]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1724352
{'0': {'precision': 0.332563454075483, 'recall': 0.5362569584487223, 'f1-score': 0.4105324041721944, 'support': 178021}, '1': {'precision': 0.3410806589565282, 'recall': 0.10467511569384925, 'f1-score': 0.1601893210030171, 'support': 175247}, '2': {'precision': 0.3497559951723776, 'recall': 0.3741565717236811, 'f1-score': 0.3615450541343922, 'support': 178142}, 'accuracy': 0.33959089968197814, 'macro avg': {'precision': 0.34113336940146294, 'recall': 0.3383628819554176, 'f1-score': 0.3107555931032012, 'support': 531410}, 'weighted avg': {'precision': 0.3411356078924445, 'recall': 0.33959089968197814, 'f1-score': 0.31155312488391795, 'support': 531410}}
[[95465 17777 64779]
 [97765 18344 59138]
 [93828 17661 66653]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.145285
{'0': {'precision': 0.34508052422246854, 'recall': 0.2077812457059851, 'f1-score': 0.2593822365438572, 'support': 50943}, '1': {'precision': 0.34445282349288026, 'recall': 0.158079029335722, 'f1-score': 0.2167057378879214, 'support': 49121}, '2': {'precision': 0.33682139804105343, 'recall': 0.6508577797237591, 'f1-score': 0.44391505304094636, 'support': 50246}, 'accuracy': 0.33965138713325793, 'macro avg': {'precision': 0.3421182485854674, 'recall': 0.3389060182551554, 'f1-score': 0.30666767582424165, 'support': 150310}, 'weighted avg': {'precision': 0.34211451170401, 'recall': 0.33965138713325793, 'f1-score': 0.3071217323008562, 'support': 150310}}
[[10585  7355 33003]
 [ 9969  7765 31387]
 [10120  7423 32703]]
training model: results/AAL/W2/deepLOB_L1/h500
Epoch 1/50
2076/2076 - 34s - loss: 3.2415 - accuracy500: 0.4042 - val_loss: 3.3409 - val_accuracy500: 0.3228 - 34s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 31s - loss: 3.2132 - accuracy500: 0.4185 - val_loss: 3.4081 - val_accuracy500: 0.3211 - 31s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 3.2028 - accuracy500: 0.4221 - val_loss: 3.3385 - val_accuracy500: 0.3292 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 30s - loss: 3.1927 - accuracy500: 0.4276 - val_loss: 3.4249 - val_accuracy500: 0.3092 - 30s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 30s - loss: 3.1829 - accuracy500: 0.4351 - val_loss: 3.3483 - val_accuracy500: 0.3456 - 30s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 30s - loss: 3.1802 - accuracy500: 0.4339 - val_loss: 3.3663 - val_accuracy500: 0.3286 - 30s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 3.1705 - accuracy500: 0.4390 - val_loss: 3.3558 - val_accuracy500: 0.3530 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 31s - loss: 3.1703 - accuracy500: 0.4402 - val_loss: 3.4693 - val_accuracy500: 0.3140 - 31s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 3.1673 - accuracy500: 0.4424 - val_loss: 3.4340 - val_accuracy500: 0.3296 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 3.1638 - accuracy500: 0.4424 - val_loss: 3.5117 - val_accuracy500: 0.3128 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 31s - loss: 3.1597 - accuracy500: 0.4451 - val_loss: 3.3836 - val_accuracy500: 0.3550 - 31s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 30s - loss: 3.1563 - accuracy500: 0.4461 - val_loss: 3.4956 - val_accuracy500: 0.3109 - 30s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 31s - loss: 3.1565 - accuracy500: 0.4468 - val_loss: 3.4700 - val_accuracy500: 0.3136 - 31s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h500
Evaluating performance on  test set...
4856/4856 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199449
{'0': {'precision': 0.3648837359190484, 'recall': 0.11462380347119895, 'f1-score': 0.17444714921065335, 'support': 444515}, '1': {'precision': 0.2512095973021013, 'recall': 0.2596393466279631, 'f1-score': 0.2553549204131095, 'support': 360346}, '2': {'precision': 0.34325586868592883, 'recall': 0.5726844791847394, 'f1-score': 0.42923604979843816, 'support': 438044}, 'accuracy': 0.3181039580659825, 'macro avg': {'precision': 0.3197830673023595, 'recall': 0.31564920976130045, 'f1-score': 0.2863460398074003, 'support': 1242905}, 'weighted avg': {'precision': 0.3243046259884205, 'recall': 0.3181039580659825, 'f1-score': 0.2877008097002289, 'support': 1242905}}
[[ 50952 138851 254712]
 [ 41531  93560 225255]
 [ 47156 140027 250861]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1345861
{'0': {'precision': 0.3272947297483352, 'recall': 0.254447636752859, 'f1-score': 0.2863101444957545, 'support': 177510}, '1': {'precision': 0.33489671139367266, 'recall': 0.4154452827608215, 'f1-score': 0.37084758695237485, 'support': 175484}, '2': {'precision': 0.33593029740834746, 'recall': 0.3308503721639315, 'f1-score': 0.33337098386486474, 'support': 178416}, 'accuracy': 0.3332643345063134, 'macro avg': {'precision': 0.33270724618345177, 'recall': 0.33358109722587065, 'f1-score': 0.3301762384376647, 'support': 531410}, 'weighted avg': {'precision': 0.332704393824433, 'recall': 0.3332643345063134, 'f1-score': 0.3300266256853007, 'support': 531410}}
[[45167 71586 60757]
 [46648 72904 55932]
 [46186 73201 59029]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123837
{'0': {'precision': 0.24694699735616266, 'recall': 0.16332903118364628, 'f1-score': 0.19661696529256983, 'support': 48038}, '1': {'precision': 0.3579519363232818, 'recall': 0.2560541635490994, 'f1-score': 0.2985477950954838, 'support': 54797}, '2': {'precision': 0.3446559112679607, 'recall': 0.5759873617693523, 'f1-score': 0.4312581319244569, 'support': 47475}, 'accuracy': 0.3274698955491983, 'macro avg': {'precision': 0.31651828164913504, 'recall': 0.33179018550069933, 'f1-score': 0.30880763077083684, 'support': 150310}, 'weighted avg': {'precision': 0.31827603952597067, 'recall': 0.3274698955491983, 'f1-score': 0.3078876263700704, 'support': 150310}}
[[ 7846 12858 27334]
 [16105 14031 24661]
 [ 7821 12309 27345]]
training model: results/AAL/W2/deepLOB_L1/h1000
Epoch 1/50
2076/2076 - 33s - loss: 3.1776 - accuracy1000: 0.4419 - val_loss: 3.4747 - val_accuracy1000: 0.3173 - 33s/epoch - 16ms/step
Epoch 2/50
2076/2076 - 32s - loss: 3.1290 - accuracy1000: 0.4604 - val_loss: 3.4348 - val_accuracy1000: 0.3144 - 32s/epoch - 15ms/step
Epoch 3/50
2076/2076 - 31s - loss: 3.1067 - accuracy1000: 0.4696 - val_loss: 3.4417 - val_accuracy1000: 0.3057 - 31s/epoch - 15ms/step
Epoch 4/50
2076/2076 - 31s - loss: 3.1049 - accuracy1000: 0.4704 - val_loss: 3.3864 - val_accuracy1000: 0.3304 - 31s/epoch - 15ms/step
Epoch 5/50
2076/2076 - 31s - loss: 3.0930 - accuracy1000: 0.4738 - val_loss: 3.4424 - val_accuracy1000: 0.3110 - 31s/epoch - 15ms/step
Epoch 6/50
2076/2076 - 31s - loss: 3.0887 - accuracy1000: 0.4731 - val_loss: 3.4422 - val_accuracy1000: 0.3062 - 31s/epoch - 15ms/step
Epoch 7/50
2076/2076 - 31s - loss: 3.0786 - accuracy1000: 0.4766 - val_loss: 3.4947 - val_accuracy1000: 0.3049 - 31s/epoch - 15ms/step
Epoch 8/50
2076/2076 - 30s - loss: 3.0728 - accuracy1000: 0.4783 - val_loss: 3.4463 - val_accuracy1000: 0.3005 - 30s/epoch - 15ms/step
Epoch 9/50
2076/2076 - 31s - loss: 3.0677 - accuracy1000: 0.4803 - val_loss: 3.4772 - val_accuracy1000: 0.2988 - 31s/epoch - 15ms/step
Epoch 10/50
2076/2076 - 31s - loss: 3.0682 - accuracy1000: 0.4799 - val_loss: 3.4491 - val_accuracy1000: 0.3062 - 31s/epoch - 15ms/step
Epoch 11/50
2076/2076 - 30s - loss: 3.0605 - accuracy1000: 0.4823 - val_loss: 3.4586 - val_accuracy1000: 0.2968 - 30s/epoch - 15ms/step
Epoch 12/50
2076/2076 - 31s - loss: 3.0567 - accuracy1000: 0.4834 - val_loss: 3.4974 - val_accuracy1000: 0.2849 - 31s/epoch - 15ms/step
Epoch 13/50
2076/2076 - 30s - loss: 3.0533 - accuracy1000: 0.4856 - val_loss: 3.4951 - val_accuracy1000: 0.2940 - 30s/epoch - 15ms/step
Epoch 14/50
2076/2076 - 30s - loss: 3.0477 - accuracy1000: 0.4869 - val_loss: 3.4626 - val_accuracy1000: 0.3059 - 30s/epoch - 15ms/step
testing model: results/AAL/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
4856/4856 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1305974
{'0': {'precision': 0.3459461676212869, 'recall': 0.06145861919067059, 'f1-score': 0.10437468809674054, 'support': 411773}, '1': {'precision': 0.3319547788259693, 'recall': 0.7705452752207402, 'f1-score': 0.4640111997680856, 'support': 425840}, '2': {'precision': 0.2811774246043348, 'recall': 0.12576364695084039, 'f1-score': 0.17379370542936978, 'support': 405292}, 'accuracy': 0.32537241382084714, 'macro avg': {'precision': 0.31969279035053033, 'recall': 0.31925584712075045, 'f1-score': 0.24739319776473198, 'support': 1242905}, 'weighted avg': {'precision': 0.32003240397931537, 'recall': 0.32537241382084714, 'f1-score': 0.250228622631481, 'support': 1242905}}
[[ 25307 329923  56543]
 [ 23948 328129  73763]
 [ 23898 330423  50971]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378853
{'0': {'precision': 0.3007227368470507, 'recall': 0.2180565964888374, 'f1-score': 0.2528033492082821, 'support': 176124}, '1': {'precision': 0.3180319391732076, 'recall': 0.5678963087936891, 'f1-score': 0.40772865014619614, 'support': 175444}, '2': {'precision': 0.33000066358468444, 'recall': 0.16591230079736657, 'f1-score': 0.22080959076444903, 'support': 179842}, 'accuracy': 0.31590862046254303, 'macro avg': {'precision': 0.3162517798683142, 'recall': 0.31728840202663106, 'f1-score': 0.29378053003964244, 'support': 531410}, 'weighted avg': {'precision': 0.3163456957549745, 'recall': 0.31590862046254303, 'f1-score': 0.2931241805657943, 'support': 531410}}
[[ 38405 104163  33556]
 [ 48786  99634  27024]
 [ 40518 109486  29838]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1288246
{'0': {'precision': 0.28416917256765933, 'recall': 0.12421820340492293, 'f1-score': 0.17287010400531092, 'support': 47167}, '1': {'precision': 0.3497977657935285, 'recall': 0.6515453191985506, 'f1-score': 0.4552068124996084, 'support': 55749}, '2': {'precision': 0.2855485068853474, 'recall': 0.15575811284128793, 'f1-score': 0.20156732108237996, 'support': 47394}, 'accuracy': 0.32974519326724766, 'macro avg': {'precision': 0.30650514841551174, 'recall': 0.3105072118149205, 'f1-score': 0.27654807919576646, 'support': 150310}, 'weighted avg': {'precision': 0.30894530598793407, 'recall': 0.32974519326724766, 'f1-score': 0.28663542279979703, 'support': 150310}}
[[ 5859 33492  7816]
 [ 8772 36323 10654]
 [ 5987 34025  7382]]
training model: results/AAL/W2/deepOF_L1/h10
Epoch 1/50
2076/2076 - 30s - loss: 3.1401 - accuracy10: 0.3785 - val_loss: 3.0797 - val_accuracy10: 0.5197 - 30s/epoch - 15ms/step
Epoch 2/50
2076/2076 - 28s - loss: 3.0982 - accuracy10: 0.3334 - val_loss: 3.0518 - val_accuracy10: 0.5226 - 28s/epoch - 14ms/step
Epoch 3/50
2076/2076 - 27s - loss: 3.0724 - accuracy10: 0.3489 - val_loss: 3.0344 - val_accuracy10: 0.4959 - 27s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.0517 - accuracy10: 0.3676 - val_loss: 3.0235 - val_accuracy10: 0.4793 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 28s - loss: 3.0330 - accuracy10: 0.3844 - val_loss: 3.0154 - val_accuracy10: 0.4923 - 28s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 28s - loss: 3.0151 - accuracy10: 0.4058 - val_loss: 3.0096 - val_accuracy10: 0.5263 - 28s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 28s - loss: 2.9974 - accuracy10: 0.4264 - val_loss: 3.0019 - val_accuracy10: 0.5590 - 28s/epoch - 14ms/step
Epoch 8/50
2076/2076 - 28s - loss: 2.9819 - accuracy10: 0.4406 - val_loss: 2.9993 - val_accuracy10: 0.5755 - 28s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 2.9664 - accuracy10: 0.4487 - val_loss: 2.9887 - val_accuracy10: 0.5637 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 2.9498 - accuracy10: 0.4532 - val_loss: 2.9803 - val_accuracy10: 0.5742 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 28s - loss: 2.9360 - accuracy10: 0.4580 - val_loss: 2.9857 - val_accuracy10: 0.5929 - 28s/epoch - 14ms/step
Epoch 12/50
2076/2076 - 28s - loss: 2.9179 - accuracy10: 0.4641 - val_loss: 2.9747 - val_accuracy10: 0.5889 - 28s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 27s - loss: 2.9057 - accuracy10: 0.4688 - val_loss: 2.9771 - val_accuracy10: 0.5887 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 28s - loss: 2.8923 - accuracy10: 0.4745 - val_loss: 2.9927 - val_accuracy10: 0.5886 - 28s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 28s - loss: 2.8754 - accuracy10: 0.4796 - val_loss: 2.9814 - val_accuracy10: 0.5898 - 28s/epoch - 13ms/step
Epoch 16/50
2076/2076 - 28s - loss: 2.8636 - accuracy10: 0.4817 - val_loss: 2.9894 - val_accuracy10: 0.5911 - 28s/epoch - 13ms/step
Epoch 17/50
2076/2076 - 27s - loss: 2.8498 - accuracy10: 0.4879 - val_loss: 3.0013 - val_accuracy10: 0.6023 - 27s/epoch - 13ms/step
Epoch 18/50
2076/2076 - 27s - loss: 2.8386 - accuracy10: 0.4905 - val_loss: 3.0026 - val_accuracy10: 0.6037 - 27s/epoch - 13ms/step
Epoch 19/50
2076/2076 - 27s - loss: 2.8258 - accuracy10: 0.4954 - val_loss: 2.9890 - val_accuracy10: 0.5957 - 27s/epoch - 13ms/step
Epoch 20/50
2076/2076 - 28s - loss: 2.8184 - accuracy10: 0.4971 - val_loss: 2.9868 - val_accuracy10: 0.5991 - 28s/epoch - 13ms/step
Epoch 21/50
2076/2076 - 28s - loss: 2.8018 - accuracy10: 0.5039 - val_loss: 2.9975 - val_accuracy10: 0.6046 - 28s/epoch - 13ms/step
Epoch 22/50
2076/2076 - 27s - loss: 2.7868 - accuracy10: 0.5082 - val_loss: 3.0241 - val_accuracy10: 0.6044 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h10
Evaluating performance on  test set...
4856/4856 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98655605
{'0': {'precision': 0.3267795937710085, 'recall': 0.36114979395464974, 'f1-score': 0.34310609508674755, 'support': 246305}, '1': {'precision': 0.670705271139952, 'recall': 0.6245132637674008, 'f1-score': 0.6467855834622879, 'support': 761963}, '2': {'precision': 0.30895510388471803, 'recall': 0.3439428551945174, 'f1-score': 0.3255115108856777, 'support': 234632}, 'accuracy': 0.5193571486040711, 'macro avg': {'precision': 0.4354799895985595, 'recall': 0.44320197097218933, 'f1-score': 0.43846772981157106, 'support': 1242900}, 'weighted avg': {'precision': 0.5342592342843823, 'recall': 0.5193571486040711, 'f1-score': 0.5259561083789082, 'support': 1242900}}
[[ 88953 117980  39372]
 [144976 475856 141131]
 [ 38282 115650  80700]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9215833
{'0': {'precision': 0.28878516305700774, 'recall': 0.31912903536402526, 'f1-score': 0.3031997961330624, 'support': 72701}, '1': {'precision': 0.7681615406934571, 'recall': 0.6616276920593848, 'f1-score': 0.710925688423685, 'support': 384139}, '2': {'precision': 0.2551536528958621, 'recall': 0.4113048142684726, 'f1-score': 0.31493613176161334, 'support': 74570}, 'accuracy': 0.5796447187670537, 'macro avg': {'precision': 0.4373667855487757, 'recall': 0.4640205138972942, 'f1-score': 0.44302053877278685, 'support': 531410}, 'weighted avg': {'precision': 0.6305914155102386, 'recall': 0.5796447187670537, 'f1-score': 0.5995784775399771, 'support': 531410}}
[[ 23201  39147  10353]
 [ 50800 254157  79182]
 [  6339  37560  30671]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91611594
{'0': {'precision': 0.2763404045039003, 'recall': 0.3861596132978199, 'f1-score': 0.32214792716798685, 'support': 20274}, '1': {'precision': 0.7861861341534729, 'recall': 0.6607025846377866, 'f1-score': 0.718002986816469, 'support': 109880}, '2': {'precision': 0.2761075682423997, 'recall': 0.4059833300257988, 'f1-score': 0.32868073825638144, 'support': 20156}, 'accuracy': 0.589515002328521, 'macro avg': {'precision': 0.44621136896659097, 'recall': 0.48428184265380175, 'f1-score': 0.45627721741361243, 'support': 150310}, 'weighted avg': {'precision': 0.6490179091689806, 'recall': 0.589515002328521, 'f1-score': 0.6124029287944448, 'support': 150310}}
[[ 7829  9921  2524]
 [18352 72598 18930]
 [ 2150  9823  8183]]
training model: results/AAL/W2/deepOF_L1/h20
Epoch 1/50
2076/2076 - 30s - loss: 3.1656 - accuracy20: 0.3945 - val_loss: 3.1873 - val_accuracy20: 0.5460 - 30s/epoch - 15ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.1297 - accuracy20: 0.3592 - val_loss: 3.0964 - val_accuracy20: 0.4693 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 28s - loss: 3.0973 - accuracy20: 0.3762 - val_loss: 3.0881 - val_accuracy20: 0.5010 - 28s/epoch - 14ms/step
Epoch 4/50
2076/2076 - 28s - loss: 3.0756 - accuracy20: 0.4043 - val_loss: 3.0658 - val_accuracy20: 0.5022 - 28s/epoch - 14ms/step
Epoch 5/50
2076/2076 - 28s - loss: 3.0548 - accuracy20: 0.4279 - val_loss: 3.0626 - val_accuracy20: 0.5261 - 28s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 28s - loss: 3.0407 - accuracy20: 0.4407 - val_loss: 3.0549 - val_accuracy20: 0.5437 - 28s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.0250 - accuracy20: 0.4497 - val_loss: 3.0472 - val_accuracy20: 0.5483 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 28s - loss: 3.0119 - accuracy20: 0.4530 - val_loss: 3.0495 - val_accuracy20: 0.5456 - 28s/epoch - 14ms/step
Epoch 9/50
2076/2076 - 28s - loss: 2.9979 - accuracy20: 0.4557 - val_loss: 3.0410 - val_accuracy20: 0.5552 - 28s/epoch - 14ms/step
Epoch 10/50
2076/2076 - 27s - loss: 2.9838 - accuracy20: 0.4590 - val_loss: 3.0546 - val_accuracy20: 0.5746 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 2.9666 - accuracy20: 0.4668 - val_loss: 3.0463 - val_accuracy20: 0.5652 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 28s - loss: 2.9578 - accuracy20: 0.4699 - val_loss: 3.0343 - val_accuracy20: 0.5645 - 28s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 28s - loss: 2.9417 - accuracy20: 0.4767 - val_loss: 3.0411 - val_accuracy20: 0.5649 - 28s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 2.9277 - accuracy20: 0.4832 - val_loss: 3.0409 - val_accuracy20: 0.5594 - 27s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 27s - loss: 2.9114 - accuracy20: 0.4897 - val_loss: 3.0279 - val_accuracy20: 0.5616 - 27s/epoch - 13ms/step
Epoch 16/50
2076/2076 - 27s - loss: 2.8977 - accuracy20: 0.4943 - val_loss: 3.0346 - val_accuracy20: 0.5604 - 27s/epoch - 13ms/step
Epoch 17/50
2076/2076 - 27s - loss: 2.8844 - accuracy20: 0.4975 - val_loss: 3.0533 - val_accuracy20: 0.5606 - 27s/epoch - 13ms/step
Epoch 18/50
2076/2076 - 28s - loss: 2.8738 - accuracy20: 0.5006 - val_loss: 3.0626 - val_accuracy20: 0.5618 - 28s/epoch - 14ms/step
Epoch 19/50
2076/2076 - 27s - loss: 2.8614 - accuracy20: 0.5033 - val_loss: 3.0598 - val_accuracy20: 0.5672 - 27s/epoch - 13ms/step
Epoch 20/50
2076/2076 - 27s - loss: 2.8549 - accuracy20: 0.5047 - val_loss: 3.0366 - val_accuracy20: 0.5520 - 27s/epoch - 13ms/step
Epoch 21/50
2076/2076 - 27s - loss: 2.8427 - accuracy20: 0.5084 - val_loss: 3.0760 - val_accuracy20: 0.5610 - 27s/epoch - 13ms/step
Epoch 22/50
2076/2076 - 27s - loss: 2.8345 - accuracy20: 0.5095 - val_loss: 3.0906 - val_accuracy20: 0.5569 - 27s/epoch - 13ms/step
Epoch 23/50
2076/2076 - 27s - loss: 2.8246 - accuracy20: 0.5124 - val_loss: 3.0913 - val_accuracy20: 0.5566 - 27s/epoch - 13ms/step
Epoch 24/50
2076/2076 - 27s - loss: 2.8166 - accuracy20: 0.5141 - val_loss: 3.0899 - val_accuracy20: 0.5664 - 27s/epoch - 13ms/step
Epoch 25/50
2076/2076 - 27s - loss: 2.8088 - accuracy20: 0.5163 - val_loss: 3.0920 - val_accuracy20: 0.5678 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h20
Evaluating performance on  test set...
4856/4856 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0130135
{'0': {'precision': 0.3849879544367125, 'recall': 0.29820643110023115, 'f1-score': 0.33608556024335867, 'support': 307599}, '1': {'precision': 0.5630154005878811, 'recall': 0.6704199233764563, 'f1-score': 0.6120414007744205, 'support': 637402}, '2': {'precision': 0.3799121482162994, 'recall': 0.31326724829556324, 'f1-score': 0.3433859513559259, 'support': 297899}, 'accuracy': 0.4927001367768927, 'macro avg': {'precision': 0.4426385010802976, 'recall': 0.4272978675907502, 'f1-score': 0.43050430412456836, 'support': 1242900}, 'weighted avg': {'precision': 0.4750699985548173, 'recall': 0.4927001367768927, 'f1-score': 0.47935499775098, 'support': 1242900}}
[[ 91728 168658  47213]
 [104969 427327 105106]
 [ 41565 163012  93322]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93173075
{'0': {'precision': 0.35499876518264073, 'recall': 0.3286873915167389, 'f1-score': 0.3413367872851399, 'support': 96213}, '1': {'precision': 0.694914888368077, 'recall': 0.668719193549823, 'f1-score': 0.6815654285813663, 'support': 336983}, '2': {'precision': 0.3336439414475468, 'recall': 0.4010222575192946, 'f1-score': 0.3642433714660921, 'support': 98214}, 'accuracy': 0.5576805103404151, 'macro avg': {'precision': 0.46118586499942144, 'recall': 0.4661429475286188, 'f1-score': 0.4623818624441995, 'support': 531410}, 'weighted avg': {'precision': 0.5666030110212199, 'recall': 0.5576805103404151, 'f1-score': 0.5613195039985519, 'support': 531410}}
[[ 31624  49367  15222]
 [ 48196 225347  63440]
 [  9262  49566  39386]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92816097
{'0': {'precision': 0.34274606097810517, 'recall': 0.3722635848427603, 'f1-score': 0.3568955414691312, 'support': 26997}, '1': {'precision': 0.7053490879485995, 'recall': 0.6643524035522211, 'f1-score': 0.6842372076393967, 'support': 96503}, '2': {'precision': 0.3415963314946501, 'recall': 0.38343901529280117, 'f1-score': 0.36131027695768303, 'support': 26810}, 'accuracy': 0.5617856430044574, 'macro avg': {'precision': 0.4632304934737849, 'recall': 0.47335166789592753, 'f1-score': 0.46748100868873693, 'support': 150310}, 'weighted avg': {'precision': 0.5753417343483544, 'recall': 0.5617856430044574, 'f1-score': 0.5678449917311045, 'support': 150310}}
[[10050 13172  3775]
 [16352 64112 16039]
 [ 2920 13610 10280]]
training model: results/AAL/W2/deepOF_L1/h30
Epoch 1/50
2076/2076 - 30s - loss: 3.1852 - accuracy30: 0.3982 - val_loss: 3.1892 - val_accuracy30: 0.4534 - 30s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.1573 - accuracy30: 0.3608 - val_loss: 3.1502 - val_accuracy30: 0.4353 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 28s - loss: 3.1298 - accuracy30: 0.3842 - val_loss: 3.1439 - val_accuracy30: 0.4818 - 28s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 28s - loss: 3.1095 - accuracy30: 0.4064 - val_loss: 3.1355 - val_accuracy30: 0.4957 - 28s/epoch - 14ms/step
Epoch 5/50
2076/2076 - 27s - loss: 3.0913 - accuracy30: 0.4237 - val_loss: 3.1384 - val_accuracy30: 0.5126 - 27s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.0782 - accuracy30: 0.4310 - val_loss: 3.1403 - val_accuracy30: 0.5150 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.0662 - accuracy30: 0.4353 - val_loss: 3.1273 - val_accuracy30: 0.5101 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.0533 - accuracy30: 0.4416 - val_loss: 3.1280 - val_accuracy30: 0.5110 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 28s - loss: 3.0427 - accuracy30: 0.4470 - val_loss: 3.1278 - val_accuracy30: 0.5262 - 28s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 3.0358 - accuracy30: 0.4494 - val_loss: 3.1238 - val_accuracy30: 0.5258 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.0227 - accuracy30: 0.4562 - val_loss: 3.1318 - val_accuracy30: 0.5351 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 27s - loss: 3.0123 - accuracy30: 0.4609 - val_loss: 3.1218 - val_accuracy30: 0.5290 - 27s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 28s - loss: 3.0020 - accuracy30: 0.4636 - val_loss: 3.1215 - val_accuracy30: 0.5295 - 28s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 2.9891 - accuracy30: 0.4689 - val_loss: 3.1261 - val_accuracy30: 0.5318 - 27s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 27s - loss: 2.9780 - accuracy30: 0.4730 - val_loss: 3.1226 - val_accuracy30: 0.5293 - 27s/epoch - 13ms/step
Epoch 16/50
2076/2076 - 27s - loss: 2.9660 - accuracy30: 0.4777 - val_loss: 3.1486 - val_accuracy30: 0.5325 - 27s/epoch - 13ms/step
Epoch 17/50
2076/2076 - 27s - loss: 2.9511 - accuracy30: 0.4843 - val_loss: 3.1313 - val_accuracy30: 0.5353 - 27s/epoch - 13ms/step
Epoch 18/50
2076/2076 - 27s - loss: 2.9375 - accuracy30: 0.4885 - val_loss: 3.1183 - val_accuracy30: 0.5430 - 27s/epoch - 13ms/step
Epoch 19/50
2076/2076 - 27s - loss: 2.9276 - accuracy30: 0.4915 - val_loss: 3.1308 - val_accuracy30: 0.5356 - 27s/epoch - 13ms/step
Epoch 20/50
2076/2076 - 27s - loss: 2.9180 - accuracy30: 0.4943 - val_loss: 3.1274 - val_accuracy30: 0.5359 - 27s/epoch - 13ms/step
Epoch 21/50
2076/2076 - 27s - loss: 2.9094 - accuracy30: 0.4969 - val_loss: 3.1243 - val_accuracy30: 0.5369 - 27s/epoch - 13ms/step
Epoch 22/50
2076/2076 - 28s - loss: 2.8997 - accuracy30: 0.5002 - val_loss: 3.1281 - val_accuracy30: 0.5325 - 28s/epoch - 13ms/step
Epoch 23/50
2076/2076 - 27s - loss: 2.8918 - accuracy30: 0.5018 - val_loss: 3.1146 - val_accuracy30: 0.5301 - 27s/epoch - 13ms/step
Epoch 24/50
2076/2076 - 27s - loss: 2.8816 - accuracy30: 0.5038 - val_loss: 3.1242 - val_accuracy30: 0.5310 - 27s/epoch - 13ms/step
Epoch 25/50
2076/2076 - 27s - loss: 2.8735 - accuracy30: 0.5054 - val_loss: 3.1300 - val_accuracy30: 0.5261 - 27s/epoch - 13ms/step
Epoch 26/50
2076/2076 - 27s - loss: 2.8672 - accuracy30: 0.5077 - val_loss: 3.1129 - val_accuracy30: 0.5371 - 27s/epoch - 13ms/step
Epoch 27/50
2076/2076 - 28s - loss: 2.8585 - accuracy30: 0.5104 - val_loss: 3.1149 - val_accuracy30: 0.5374 - 28s/epoch - 13ms/step
Epoch 28/50
2076/2076 - 27s - loss: 2.8482 - accuracy30: 0.5138 - val_loss: 3.1564 - val_accuracy30: 0.5382 - 27s/epoch - 13ms/step
Epoch 29/50
2076/2076 - 27s - loss: 2.8414 - accuracy30: 0.5152 - val_loss: 3.1645 - val_accuracy30: 0.5444 - 27s/epoch - 13ms/step
Epoch 30/50
2076/2076 - 27s - loss: 2.8321 - accuracy30: 0.5178 - val_loss: 3.1695 - val_accuracy30: 0.5463 - 27s/epoch - 13ms/step
Epoch 31/50
2076/2076 - 27s - loss: 2.8244 - accuracy30: 0.5203 - val_loss: 3.1631 - val_accuracy30: 0.5491 - 27s/epoch - 13ms/step
Epoch 32/50
2076/2076 - 27s - loss: 2.8174 - accuracy30: 0.5225 - val_loss: 3.1844 - val_accuracy30: 0.5481 - 27s/epoch - 13ms/step
Epoch 33/50
2076/2076 - 27s - loss: 2.8101 - accuracy30: 0.5237 - val_loss: 3.1931 - val_accuracy30: 0.5456 - 27s/epoch - 13ms/step
Epoch 34/50
2076/2076 - 27s - loss: 2.8028 - accuracy30: 0.5252 - val_loss: 3.1731 - val_accuracy30: 0.5548 - 27s/epoch - 13ms/step
Epoch 35/50
2076/2076 - 28s - loss: 2.7970 - accuracy30: 0.5264 - val_loss: 3.1923 - val_accuracy30: 0.5481 - 28s/epoch - 13ms/step
Epoch 36/50
2076/2076 - 28s - loss: 2.7896 - accuracy30: 0.5285 - val_loss: 3.1919 - val_accuracy30: 0.5498 - 28s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h30
Evaluating performance on  test set...
4856/4856 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0682195
{'0': {'precision': 0.41695021260110804, 'recall': 0.256069070885372, 'f1-score': 0.3172808154712223, 'support': 348859}, '1': {'precision': 0.492431011682031, 'recall': 0.645262687653338, 'f1-score': 0.55858155541764, 'support': 555146}, '2': {'precision': 0.3904889328601261, 'recall': 0.3470632496791041, 'f1-score': 0.36749768005724087, 'support': 338895}, 'accuracy': 0.45471477995011667, 'macro avg': {'precision': 0.43329005238108836, 'recall': 0.41613166940593804, 'f1-score': 0.41445335031536773, 'support': 1242900}, 'weighted avg': {'precision': 0.4434489400037615, 'recall': 0.45471477995011667, 'f1-score': 0.4387510744640397, 'support': 1242900}}
[[ 89332 191613  67914]
 [ 81256 358215 115675]
 [ 43663 177614 117618]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9431554
{'0': {'precision': 0.39706624075319435, 'recall': 0.3347062418621954, 'f1-score': 0.36322915214810614, 'support': 112899}, '1': {'precision': 0.6415868121368545, 'recall': 0.6818316684798734, 'f1-score': 0.6610973218238513, 'support': 303330}, '2': {'precision': 0.38126179918338676, 'recall': 0.3769718964065254, 'f1-score': 0.3791047121790227, 'support': 115181}, 'accuracy': 0.5420071131518037, 'macro avg': {'precision': 0.47330495069114525, 'recall': 0.4645032689161981, 'f1-score': 0.4678103953836601, 'support': 531410}, 'weighted avg': {'precision': 0.5332135724431393, 'recall': 0.5420071131518037, 'f1-score': 0.5366939247110327, 'support': 531410}}
[[ 37788  57605  17506]
 [ 43551 206820  52959]
 [ 13829  57932  43420]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95120233
{'0': {'precision': 0.38722466960352425, 'recall': 0.35766377664402643, 'f1-score': 0.37185766120503105, 'support': 31949}, '1': {'precision': 0.6479440345510168, 'recall': 0.6648662996687786, 'f1-score': 0.6562961022094885, 'support': 86649}, '2': {'precision': 0.37202082288008026, 'recall': 0.37408551967709386, 'f1-score': 0.3730503144654088, 'support': 31712}, 'accuracy': 0.5382210099128468, 'macro avg': {'precision': 0.4690631756782071, 'recall': 0.465538531996633, 'f1-score': 0.4670680259599762, 'support': 150310}, 'weighted avg': {'precision': 0.534313538381659, 'recall': 0.5382210099128468, 'f1-score': 0.5360791228162901, 'support': 150310}}
[[11427 15645  4877]
 [13891 57610 15148]
 [ 4192 15657 11863]]
training model: results/AAL/W2/deepOF_L1/h50
Epoch 1/50
2076/2076 - 30s - loss: 3.2190 - accuracy50: 0.4043 - val_loss: 3.2951 - val_accuracy50: 0.4553 - 30s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.2041 - accuracy50: 0.3856 - val_loss: 3.2595 - val_accuracy50: 0.4524 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 28s - loss: 3.1857 - accuracy50: 0.3904 - val_loss: 3.2335 - val_accuracy50: 0.4563 - 28s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.1711 - accuracy50: 0.4009 - val_loss: 3.2275 - val_accuracy50: 0.4633 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 27s - loss: 3.1571 - accuracy50: 0.4107 - val_loss: 3.2161 - val_accuracy50: 0.4673 - 27s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.1450 - accuracy50: 0.4202 - val_loss: 3.2180 - val_accuracy50: 0.4751 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.1358 - accuracy50: 0.4286 - val_loss: 3.2226 - val_accuracy50: 0.4766 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 28s - loss: 3.1348 - accuracy50: 0.4334 - val_loss: 3.2121 - val_accuracy50: 0.4713 - 28s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.1220 - accuracy50: 0.4382 - val_loss: 3.2253 - val_accuracy50: 0.4769 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 3.1122 - accuracy50: 0.4422 - val_loss: 3.2448 - val_accuracy50: 0.4810 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.1042 - accuracy50: 0.4464 - val_loss: 3.2733 - val_accuracy50: 0.4759 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 27s - loss: 3.0971 - accuracy50: 0.4488 - val_loss: 3.2687 - val_accuracy50: 0.4788 - 27s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 27s - loss: 3.0886 - accuracy50: 0.4534 - val_loss: 3.2883 - val_accuracy50: 0.4808 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 3.0796 - accuracy50: 0.4575 - val_loss: 3.2989 - val_accuracy50: 0.4808 - 27s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 27s - loss: 3.0696 - accuracy50: 0.4615 - val_loss: 3.3363 - val_accuracy50: 0.4804 - 27s/epoch - 13ms/step
Epoch 16/50
2076/2076 - 27s - loss: 3.0598 - accuracy50: 0.4652 - val_loss: 3.3357 - val_accuracy50: 0.4797 - 27s/epoch - 13ms/step
Epoch 17/50
2076/2076 - 28s - loss: 3.0490 - accuracy50: 0.4695 - val_loss: 3.3386 - val_accuracy50: 0.4802 - 28s/epoch - 14ms/step
Epoch 18/50
2076/2076 - 27s - loss: 3.0366 - accuracy50: 0.4753 - val_loss: 3.3623 - val_accuracy50: 0.4833 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h50
Evaluating performance on  test set...
4856/4856 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1016141
{'0': {'precision': 0.4450450121432354, 'recall': 0.18037478167339327, 'f1-score': 0.2567072474962477, 'support': 405356}, '1': {'precision': 0.37633545367727955, 'recall': 0.6056061453706387, 'f1-score': 0.4642049256061427, 'support': 445083}, '2': {'precision': 0.4071141773025181, 'recall': 0.37590486698041337, 'f1-score': 0.39088755703225603, 'support': 392461}, 'accuracy': 0.39439134282725885, 'macro avg': {'precision': 0.40949821437434436, 'recall': 0.3872952646748151, 'f1-score': 0.3705999100448822, 'support': 1242900}, 'weighted avg': {'precision': 0.40846296227347456, 'recall': 0.39439134282725885, 'f1-score': 0.3733813383539175, 'support': 1242900}}
[[ 73116 237829  94411]
 [ 55102 269545 120436]
 [ 36071 208862 147528]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.033943
{'0': {'precision': 0.44288456352416755, 'recall': 0.20191654010269763, 'f1-score': 0.27737458335196147, 'support': 138270}, '1': {'precision': 0.5024262784621127, 'recall': 0.7090130659157429, 'f1-score': 0.5881050466823041, 'support': 252489}, '2': {'precision': 0.40434037692747, 'recall': 0.3221591030280624, 'f1-score': 0.3586015867677027, 'support': 140651}, 'accuracy': 0.4746786850078094, 'macro avg': {'precision': 0.4498837396379168, 'recall': 0.4110295696821676, 'f1-score': 0.40802707226732277, 'support': 531410}, 'weighted avg': {'precision': 0.4609729504080326, 'recall': 0.4746786850078094, 'f1-score': 0.44651081190099573, 'support': 531410}}
[[ 27919  91191  19160]
 [ 25879 179018  47592]
 [  9241  86098  45312]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0359148
{'0': {'precision': 0.43041357966801086, 'recall': 0.23270376473570795, 'f1-score': 0.30208487600993894, 'support': 39445}, '1': {'precision': 0.5101932638587043, 'recall': 0.6701246257745597, 'f1-score': 0.5793237110423615, 'support': 71815}, '2': {'precision': 0.39383097209798884, 'recall': 0.3495262483994878, 'f1-score': 0.370358310608219, 'support': 39050}, 'accuracy': 0.47204444148759234, 'macro avg': {'precision': 0.4448126052082347, 'recall': 0.4174515463032518, 'f1-score': 0.41725563255350645, 'support': 150310}, 'weighted avg': {'precision': 0.45902662733313826, 'recall': 0.47204444148759234, 'f1-score': 0.45228103434216077, 'support': 150310}}
[[ 9179 24101  6165]
 [ 8847 48125 14843]
 [ 3300 22101 13649]]
training model: results/AAL/W2/deepOF_L1/h100
Epoch 1/50
2076/2076 - 30s - loss: 3.2641 - accuracy100: 0.3973 - val_loss: 3.3306 - val_accuracy100: 0.3655 - 30s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.2539 - accuracy100: 0.3987 - val_loss: 3.3164 - val_accuracy100: 0.3663 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 28s - loss: 3.2441 - accuracy100: 0.4034 - val_loss: 3.3209 - val_accuracy100: 0.3655 - 28s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.2385 - accuracy100: 0.4077 - val_loss: 3.2993 - val_accuracy100: 0.3744 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 27s - loss: 3.2300 - accuracy100: 0.4123 - val_loss: 3.3262 - val_accuracy100: 0.3701 - 27s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.2244 - accuracy100: 0.4146 - val_loss: 3.3255 - val_accuracy100: 0.3735 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.2173 - accuracy100: 0.4191 - val_loss: 3.3502 - val_accuracy100: 0.3695 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.2127 - accuracy100: 0.4211 - val_loss: 3.3680 - val_accuracy100: 0.3696 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.2079 - accuracy100: 0.4234 - val_loss: 3.3922 - val_accuracy100: 0.3707 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 3.2030 - accuracy100: 0.4255 - val_loss: 3.4040 - val_accuracy100: 0.3693 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.1981 - accuracy100: 0.4269 - val_loss: 3.4269 - val_accuracy100: 0.3690 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 28s - loss: 3.1948 - accuracy100: 0.4295 - val_loss: 3.4262 - val_accuracy100: 0.3702 - 28s/epoch - 14ms/step
Epoch 13/50
2076/2076 - 27s - loss: 3.1890 - accuracy100: 0.4318 - val_loss: 3.4485 - val_accuracy100: 0.3700 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 3.1859 - accuracy100: 0.4330 - val_loss: 3.4724 - val_accuracy100: 0.3693 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h100
Evaluating performance on  test set...
4856/4856 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1324346
{'0': {'precision': 0.4692965642819493, 'recall': 0.16361092549281658, 'f1-score': 0.2426327589837605, 'support': 478880}, '1': {'precision': 0.24858242779389733, 'recall': 0.6452819785759294, 'f1-score': 0.3589040120693385, 'support': 304704}, '2': {'precision': 0.4474372155532084, 'recall': 0.27761279816074336, 'f1-score': 0.342636494204614, 'support': 459316}, 'accuracy': 0.32382492557727893, 'macro avg': {'precision': 0.3884387358763517, 'recall': 0.36216856740982983, 'f1-score': 0.31472442175257104, 'support': 1242900}, 'weighted avg': {'precision': 0.40710907625785586, 'recall': 0.32382492557727893, 'f1-score': 0.3080938834080018, 'support': 1242900}}
[[ 78350 310224  90306]
 [ 40919 196620  67165]
 [ 47683 284121 127512]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975972
{'0': {'precision': 0.443797099613704, 'recall': 0.19994522048753766, 'f1-score': 0.275685180741376, 'support': 175248}, '1': {'precision': 0.3450774384009748, 'recall': 0.7373599664757647, 'f1-score': 0.4701358014135887, 'support': 178975}, '2': {'precision': 0.44453171860272483, 'recall': 0.17567315886605678, 'f1-score': 0.2518274011059468, 'support': 177187}, 'accuracy': 0.3728495888297172, 'macro avg': {'precision': 0.4111354188724679, 'recall': 0.37099278194311974, 'f1-score': 0.3325494610869705, 'support': 531410}, 'weighted avg': {'precision': 0.41079398256520927, 'recall': 0.3728495888297172, 'f1-score': 0.3332198741693252, 'support': 531410}}
[[ 35040 123170  17038]
 [ 25149 131969  21857]
 [ 18766 127294  31127]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985501
{'0': {'precision': 0.44756432022985504, 'recall': 0.20306944773643043, 'f1-score': 0.2793787959075531, 'support': 50628}, '1': {'precision': 0.34358114770262277, 'recall': 0.6979949121647336, 'f1-score': 0.4604904092029364, 'support': 49923}, '2': {'precision': 0.42995485936957445, 'recall': 0.22395948471633273, 'f1-score': 0.29451095430640345, 'support': 49759}, 'accuracy': 0.37436630962677137, 'macro avg': {'precision': 0.40703344243401746, 'recall': 0.3750079482058322, 'f1-score': 0.3447933864722976, 'support': 150310}, 'weighted avg': {'precision': 0.407198535617895, 'recall': 0.37436630962677137, 'f1-score': 0.34454143405746873, 'support': 150310}}
[[10281 33655  6692]
 [ 6994 34846  8083]
 [ 5696 32919 11144]]
training model: results/AAL/W2/deepOF_L1/h200
Epoch 1/50
2076/2076 - 29s - loss: 3.2846 - accuracy200: 0.3763 - val_loss: 3.3335 - val_accuracy200: 0.3468 - 29s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 29s - loss: 3.2725 - accuracy200: 0.3805 - val_loss: 3.3063 - val_accuracy200: 0.3507 - 29s/epoch - 14ms/step
Epoch 3/50
2076/2076 - 27s - loss: 3.2712 - accuracy200: 0.3825 - val_loss: 3.2950 - val_accuracy200: 0.3586 - 27s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.2692 - accuracy200: 0.3835 - val_loss: 3.2920 - val_accuracy200: 0.3620 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 27s - loss: 3.2675 - accuracy200: 0.3847 - val_loss: 3.2919 - val_accuracy200: 0.3631 - 27s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.2649 - accuracy200: 0.3871 - val_loss: 3.3090 - val_accuracy200: 0.3553 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.2629 - accuracy200: 0.3881 - val_loss: 3.3052 - val_accuracy200: 0.3593 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.2608 - accuracy200: 0.3900 - val_loss: 3.3041 - val_accuracy200: 0.3616 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.2588 - accuracy200: 0.3918 - val_loss: 3.3065 - val_accuracy200: 0.3616 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 3.2566 - accuracy200: 0.3936 - val_loss: 3.3092 - val_accuracy200: 0.3596 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.2542 - accuracy200: 0.3954 - val_loss: 3.3186 - val_accuracy200: 0.3567 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 27s - loss: 3.2523 - accuracy200: 0.3967 - val_loss: 3.3322 - val_accuracy200: 0.3536 - 27s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 27s - loss: 3.2502 - accuracy200: 0.3983 - val_loss: 3.3343 - val_accuracy200: 0.3547 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 3.2488 - accuracy200: 0.3982 - val_loss: 3.3412 - val_accuracy200: 0.3515 - 27s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 28s - loss: 3.2465 - accuracy200: 0.4002 - val_loss: 3.3443 - val_accuracy200: 0.3530 - 28s/epoch - 14ms/step
testing model: results/AAL/W2/deepOF_L1/h200
Evaluating performance on  test set...
4856/4856 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013088
{'0': {'precision': 0.40443078824119993, 'recall': 0.3380994874136178, 'f1-score': 0.3683024024254085, 'support': 433683}, '1': {'precision': 0.3071671121375918, 'recall': 0.4368588928041781, 'f1-score': 0.3607096623586087, 'support': 389073}, '2': {'precision': 0.3880348257945743, 'recall': 0.30200835903880574, 'f1-score': 0.3396592084781628, 'support': 420144}, 'accuracy': 0.3568147075388205, 'macro avg': {'precision': 0.3665442420577887, 'recall': 0.35898891308553393, 'f1-score': 0.35622375775406007, 'support': 1242900}, 'weighted avg': {'precision': 0.36844129954634575, 'recall': 0.3568147075388205, 'f1-score': 0.35624318910673314, 'support': 1242900}}
[[146628 192741  94314]
 [113305 169970 105798]
 [102621 190636 126887]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965503
{'0': {'precision': 0.3870029654999582, 'recall': 0.4171614449965952, 'f1-score': 0.40151669036495363, 'support': 177689}, '1': {'precision': 0.3380731884308373, 'recall': 0.4421671092028699, 'f1-score': 0.3831764262389786, 'support': 177010}, '2': {'precision': 0.40276111552020083, 'recall': 0.2469795315515163, 'f1-score': 0.3061952552504096, 'support': 176711}, 'accuracy': 0.3688997196138575, 'macro avg': {'precision': 0.37594575648366546, 'recall': 0.3687693619169938, 'f1-score': 0.3636294572847805, 'support': 531410}, 'weighted avg': {'precision': 0.3759447968716335, 'recall': 0.3688997196138575, 'f1-score': 0.3637101826337008, 'support': 531410}}
[[74125 74639 28925]
 [62949 78268 35793]
 [54462 78605 43644]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097089
{'0': {'precision': 0.37901889917927867, 'recall': 0.40669373245268536, 'f1-score': 0.3923689261738427, 'support': 49509}, '1': {'precision': 0.34209844559585495, 'recall': 0.4075145623577518, 'f1-score': 0.37195218562399873, 'support': 51846}, '2': {'precision': 0.37760401964658724, 'recall': 0.27325094474517414, 'f1-score': 0.31706189782059946, 'support': 48955}, 'accuracy': 0.3635154015035593, 'macro avg': {'precision': 0.36624045480724027, 'recall': 0.36248641318520375, 'f1-score': 0.360461003206147, 'support': 150310}, 'weighted avg': {'precision': 0.3658232151661785, 'recall': 0.3635154015035593, 'f1-score': 0.3607996233757572, 'support': 150310}}
[[20135 19827  9547]
 [18216 21128 12502]
 [14773 20805 13377]]
training model: results/AAL/W2/deepOF_L1/h300
Epoch 1/50
2076/2076 - 30s - loss: 3.2977 - accuracy300: 0.3629 - val_loss: 3.2985 - val_accuracy300: 0.3640 - 30s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.2827 - accuracy300: 0.3681 - val_loss: 3.2988 - val_accuracy300: 0.3664 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 27s - loss: 3.2800 - accuracy300: 0.3705 - val_loss: 3.2971 - val_accuracy300: 0.3657 - 27s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.2782 - accuracy300: 0.3712 - val_loss: 3.2960 - val_accuracy300: 0.3669 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 26s - loss: 3.2766 - accuracy300: 0.3722 - val_loss: 3.2970 - val_accuracy300: 0.3678 - 26s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.2751 - accuracy300: 0.3741 - val_loss: 3.2989 - val_accuracy300: 0.3687 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.2741 - accuracy300: 0.3748 - val_loss: 3.3001 - val_accuracy300: 0.3678 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.2732 - accuracy300: 0.3754 - val_loss: 3.3004 - val_accuracy300: 0.3687 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.2718 - accuracy300: 0.3762 - val_loss: 3.3022 - val_accuracy300: 0.3698 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 27s - loss: 3.2706 - accuracy300: 0.3781 - val_loss: 3.3041 - val_accuracy300: 0.3684 - 27s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.2696 - accuracy300: 0.3785 - val_loss: 3.3063 - val_accuracy300: 0.3689 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 27s - loss: 3.2685 - accuracy300: 0.3795 - val_loss: 3.3075 - val_accuracy300: 0.3681 - 27s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 28s - loss: 3.2673 - accuracy300: 0.3802 - val_loss: 3.3088 - val_accuracy300: 0.3698 - 28s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 3.2659 - accuracy300: 0.3817 - val_loss: 3.3116 - val_accuracy300: 0.3687 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h300
Evaluating performance on  test set...
4856/4856 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948646
{'0': {'precision': 0.3902411001520133, 'recall': 0.5956722532253496, 'f1-score': 0.47155420835387657, 'support': 444758}, '1': {'precision': 0.31251355454348295, 'recall': 0.027818993143846837, 'f1-score': 0.05109010284371352, 'support': 362594}, '2': {'precision': 0.38515613980648256, 'recall': 0.47021453433375887, 'f1-score': 0.4234562170533339, 'support': 435548}, 'accuracy': 0.38604714779950117, 'macro avg': {'precision': 0.3626369315006596, 'recall': 0.36456859356765176, 'f1-score': 0.315366842750308, 'support': 1242900}, 'weighted avg': {'precision': 0.36578355249656663, 'recall': 0.38604714779950117, 'f1-score': 0.33203635028941375, 'support': 1242900}}
[[264930  11099 168729]
 [194302  10087 158205]
 [219656  11091 204801]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975612
{'0': {'precision': 0.36220014185859, 'recall': 0.6710847027373104, 'f1-score': 0.470474285579293, 'support': 178058}, '1': {'precision': 0.38623122999917947, 'recall': 0.026858313409756182, 'f1-score': 0.05022407170294495, 'support': 175253}, '2': {'precision': 0.3754918998293867, 'recall': 0.39914317317896225, 'f1-score': 0.3869564744050341, 'support': 178099}, 'accuracy': 0.3674864981840763, 'macro avg': {'precision': 0.3746410905623854, 'recall': 0.3656953964420096, 'f1-score': 0.302551610562424, 'support': 531410}, 'weighted avg': {'precision': 0.37457997869407234, 'recall': 0.3674864981840763, 'f1-score': 0.30389001094239126, 'support': 531410}}
[[119492   3830  54736]
 [107052   4707  63494]
 [103362   3650  71087]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983523
{'0': {'precision': 0.366133821526646, 'recall': 0.6436603410718842, 'f1-score': 0.4667601164089684, 'support': 50957}, '1': {'precision': 0.3740579135263784, 'recall': 0.019202964954079867, 'f1-score': 0.03653056480979314, 'support': 49107}, '2': {'precision': 0.36947446183448723, 'recall': 0.4280141702822115, 'f1-score': 0.3965957603754622, 'support': 50246}, 'accuracy': 0.36756037522453594, 'macro avg': {'precision': 0.36988873229583724, 'recall': 0.36362582543605854, 'f1-score': 0.29996214719807457, 'support': 150310}, 'weighted avg': {'precision': 0.36983937803478684, 'recall': 0.36756037522453594, 'f1-score': 0.30274733732813375, 'support': 150310}}
[[32799   792 17366]
 [28829   943 19335]
 [27954   786 21506]]
training model: results/AAL/W2/deepOF_L1/h500
Epoch 1/50
2076/2076 - 30s - loss: 3.2697 - accuracy500: 0.3834 - val_loss: 3.3434 - val_accuracy500: 0.3285 - 30s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.2618 - accuracy500: 0.3841 - val_loss: 3.3409 - val_accuracy500: 0.3342 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 27s - loss: 3.2751 - accuracy500: 0.3762 - val_loss: 3.3504 - val_accuracy500: 0.3336 - 27s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.2756 - accuracy500: 0.3746 - val_loss: 3.3450 - val_accuracy500: 0.3415 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 26s - loss: 3.2723 - accuracy500: 0.3774 - val_loss: 3.3335 - val_accuracy500: 0.3423 - 26s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.2698 - accuracy500: 0.3788 - val_loss: 3.3291 - val_accuracy500: 0.3427 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.2682 - accuracy500: 0.3791 - val_loss: 3.3260 - val_accuracy500: 0.3435 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.2667 - accuracy500: 0.3797 - val_loss: 3.3272 - val_accuracy500: 0.3423 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.2647 - accuracy500: 0.3812 - val_loss: 3.3245 - val_accuracy500: 0.3417 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 28s - loss: 3.2629 - accuracy500: 0.3820 - val_loss: 3.3259 - val_accuracy500: 0.3413 - 28s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.2607 - accuracy500: 0.3844 - val_loss: 3.3288 - val_accuracy500: 0.3430 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 28s - loss: 3.2580 - accuracy500: 0.3856 - val_loss: 3.3195 - val_accuracy500: 0.3408 - 28s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 27s - loss: 3.2570 - accuracy500: 0.3862 - val_loss: 3.3181 - val_accuracy500: 0.3427 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 28s - loss: 3.2555 - accuracy500: 0.3877 - val_loss: 3.3172 - val_accuracy500: 0.3427 - 28s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 27s - loss: 3.2548 - accuracy500: 0.3880 - val_loss: 3.3177 - val_accuracy500: 0.3415 - 27s/epoch - 13ms/step
Epoch 16/50
2076/2076 - 27s - loss: 3.2538 - accuracy500: 0.3887 - val_loss: 3.3183 - val_accuracy500: 0.3429 - 27s/epoch - 13ms/step
Epoch 17/50
2076/2076 - 27s - loss: 3.2539 - accuracy500: 0.3883 - val_loss: 3.3195 - val_accuracy500: 0.3412 - 27s/epoch - 13ms/step
Epoch 18/50
2076/2076 - 27s - loss: 3.2528 - accuracy500: 0.3897 - val_loss: 3.3202 - val_accuracy500: 0.3412 - 27s/epoch - 13ms/step
Epoch 19/50
2076/2076 - 27s - loss: 3.2527 - accuracy500: 0.3897 - val_loss: 3.3178 - val_accuracy500: 0.3406 - 27s/epoch - 13ms/step
Epoch 20/50
2076/2076 - 27s - loss: 3.2513 - accuracy500: 0.3909 - val_loss: 3.3163 - val_accuracy500: 0.3406 - 27s/epoch - 13ms/step
Epoch 21/50
2076/2076 - 27s - loss: 3.2508 - accuracy500: 0.3911 - val_loss: 3.3179 - val_accuracy500: 0.3394 - 27s/epoch - 13ms/step
Epoch 22/50
2076/2076 - 28s - loss: 3.2497 - accuracy500: 0.3925 - val_loss: 3.3229 - val_accuracy500: 0.3402 - 28s/epoch - 13ms/step
Epoch 23/50
2076/2076 - 27s - loss: 3.2491 - accuracy500: 0.3926 - val_loss: 3.3251 - val_accuracy500: 0.3393 - 27s/epoch - 13ms/step
Epoch 24/50
2076/2076 - 27s - loss: 3.2477 - accuracy500: 0.3934 - val_loss: 3.3289 - val_accuracy500: 0.3397 - 27s/epoch - 13ms/step
Epoch 25/50
2076/2076 - 27s - loss: 3.2471 - accuracy500: 0.3941 - val_loss: 3.3291 - val_accuracy500: 0.3393 - 27s/epoch - 13ms/step
Epoch 26/50
2076/2076 - 26s - loss: 3.2476 - accuracy500: 0.3944 - val_loss: 3.3215 - val_accuracy500: 0.3403 - 26s/epoch - 13ms/step
Epoch 27/50
2076/2076 - 26s - loss: 3.2485 - accuracy500: 0.3939 - val_loss: 3.3338 - val_accuracy500: 0.3415 - 26s/epoch - 13ms/step
Epoch 28/50
2076/2076 - 27s - loss: 3.2482 - accuracy500: 0.3941 - val_loss: 3.3177 - val_accuracy500: 0.3407 - 27s/epoch - 13ms/step
Epoch 29/50
2076/2076 - 26s - loss: 3.2494 - accuracy500: 0.3934 - val_loss: 3.3246 - val_accuracy500: 0.3399 - 26s/epoch - 13ms/step
Epoch 30/50
2076/2076 - 27s - loss: 3.2484 - accuracy500: 0.3934 - val_loss: 3.3392 - val_accuracy500: 0.3398 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h500
Evaluating performance on  test set...
4856/4856 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978017
{'0': {'precision': 0.3779538833403035, 'recall': 0.5997628871081676, 'f1-score': 0.4636981160954136, 'support': 444514}, '1': {'precision': 0.3051472445319998, 'recall': 0.1844093854500548, 'f1-score': 0.22988970995239677, 'support': 360345}, '2': {'precision': 0.38160051040194154, 'recall': 0.27854926821918496, 'f1-score': 0.32203159454676694, 'support': 438041}, 'accuracy': 0.3661356504948105, 'macro avg': {'precision': 0.35490054609141497, 'recall': 0.3542405135924691, 'f1-score': 0.33853980686485907, 'support': 1242900}, 'weighted avg': {'precision': 0.3581307792316292, 'recall': 0.3661356504948105, 'f1-score': 0.34598354945505944, 'support': 1242900}}
[[266603  71926 105985]
 [202147  66451  91747]
 [236635  79390 122016]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006664
{'0': {'precision': 0.34791170472765764, 'recall': 0.7553739212726167, 'f1-score': 0.4764014366968761, 'support': 177524}, '1': {'precision': 0.3644124063359575, 'recall': 0.08757992637085836, 'f1-score': 0.14122014647638825, 'support': 175474}, '2': {'precision': 0.36307849408500636, 'recall': 0.211247001322781, 'f1-score': 0.2670932902457692, 'support': 178412}, 'accuracy': 0.35218381287518113, 'macro avg': {'precision': 0.3584675350495405, 'recall': 0.351400282988752, 'f1-score': 0.2949049578063445, 'support': 531410}, 'weighted avg': {'precision': 0.35845230678038176, 'recall': 0.35218381287518113, 'f1-score': 0.29545134779229254, 'support': 531410}}
[[134097  12906  30521]
 [124512  15368  35594]
 [126825  13898  37689]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046355
{'0': {'precision': 0.3332900415601023, 'recall': 0.6946879620181996, 'f1-score': 0.4504621284237673, 'support': 48023}, '1': {'precision': 0.3829367604020868, 'recall': 0.10973564266180492, 'f1-score': 0.17058723500736878, 'support': 54850}, '2': {'precision': 0.34018436920222633, 'recall': 0.24738073655585302, 'f1-score': 0.28645356571833086, 'support': 47437}, 'accuracy': 0.3400638680061207, 'macro avg': {'precision': 0.3521370570548052, 'recall': 0.3506014470786192, 'f1-score': 0.30250097638315565, 'support': 150310}, 'weighted avg': {'precision': 0.35358256201012084, 'recall': 0.3400638680061207, 'f1-score': 0.2965720872226014, 'support': 150310}}
[[33361  4694  9968]
 [36038  6019 12793]
 [30697  5005 11735]]
training model: results/AAL/W2/deepOF_L1/h1000
Epoch 1/50
2076/2076 - 29s - loss: 3.2549 - accuracy1000: 0.3966 - val_loss: 3.2962 - val_accuracy1000: 0.3694 - 29s/epoch - 14ms/step
Epoch 2/50
2076/2076 - 27s - loss: 3.2604 - accuracy1000: 0.3835 - val_loss: 3.2903 - val_accuracy1000: 0.3710 - 27s/epoch - 13ms/step
Epoch 3/50
2076/2076 - 27s - loss: 3.2773 - accuracy1000: 0.3686 - val_loss: 3.2908 - val_accuracy1000: 0.3712 - 27s/epoch - 13ms/step
Epoch 4/50
2076/2076 - 27s - loss: 3.2777 - accuracy1000: 0.3703 - val_loss: 3.2887 - val_accuracy1000: 0.3710 - 27s/epoch - 13ms/step
Epoch 5/50
2076/2076 - 27s - loss: 3.2745 - accuracy1000: 0.3717 - val_loss: 3.2874 - val_accuracy1000: 0.3711 - 27s/epoch - 13ms/step
Epoch 6/50
2076/2076 - 27s - loss: 3.2758 - accuracy1000: 0.3725 - val_loss: 3.2877 - val_accuracy1000: 0.3709 - 27s/epoch - 13ms/step
Epoch 7/50
2076/2076 - 27s - loss: 3.2761 - accuracy1000: 0.3714 - val_loss: 3.2880 - val_accuracy1000: 0.3710 - 27s/epoch - 13ms/step
Epoch 8/50
2076/2076 - 27s - loss: 3.2713 - accuracy1000: 0.3752 - val_loss: 3.2886 - val_accuracy1000: 0.3711 - 27s/epoch - 13ms/step
Epoch 9/50
2076/2076 - 27s - loss: 3.2694 - accuracy1000: 0.3766 - val_loss: 3.2894 - val_accuracy1000: 0.3709 - 27s/epoch - 13ms/step
Epoch 10/50
2076/2076 - 28s - loss: 3.2656 - accuracy1000: 0.3794 - val_loss: 3.2887 - val_accuracy1000: 0.3708 - 28s/epoch - 13ms/step
Epoch 11/50
2076/2076 - 27s - loss: 3.2634 - accuracy1000: 0.3807 - val_loss: 3.2910 - val_accuracy1000: 0.3711 - 27s/epoch - 13ms/step
Epoch 12/50
2076/2076 - 27s - loss: 3.2599 - accuracy1000: 0.3816 - val_loss: 3.2887 - val_accuracy1000: 0.3707 - 27s/epoch - 13ms/step
Epoch 13/50
2076/2076 - 27s - loss: 3.2671 - accuracy1000: 0.3784 - val_loss: 3.2882 - val_accuracy1000: 0.3706 - 27s/epoch - 13ms/step
Epoch 14/50
2076/2076 - 27s - loss: 3.2643 - accuracy1000: 0.3809 - val_loss: 3.2894 - val_accuracy1000: 0.3703 - 27s/epoch - 13ms/step
Epoch 15/50
2076/2076 - 27s - loss: 3.2600 - accuracy1000: 0.3840 - val_loss: 3.2892 - val_accuracy1000: 0.3705 - 27s/epoch - 13ms/step
testing model: results/AAL/W2/deepOF_L1/h1000
Evaluating performance on  test set...
4856/4856 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011739
{'0': {'precision': 0.3765281173594132, 'recall': 0.0011219801249235013, 'f1-score': 0.0022372935527688927, 'support': 411772}, '1': {'precision': 0.34273695129852816, 'recall': 0.9962309787713696, 'f1-score': 0.5100124667443283, 'support': 425840}, '2': {'precision': 0.38487265243118085, 'recall': 0.0036912023055210123, 'f1-score': 0.007312274699089632, 'support': 405288}, 'accuracy': 0.34290208383618953, 'macro avg': {'precision': 0.36804590702970746, 'recall': 0.3336813870672714, 'f1-score': 0.17318734499872898, 'support': 1242900}, 'weighted avg': {'precision': 0.3676716605043157, 'recall': 0.34290208383618953, 'f1-score': 0.1778651064988818, 'support': 1242900}}
[[   462 410107   1203]
 [   417 424235   1188]
 [   348 403444   1496]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031802
{'0': {'precision': 0.39090064995357476, 'recall': 0.0023907685667881925, 'f1-score': 0.004752470776820133, 'support': 176094}, '1': {'precision': 0.33031693947612994, 'recall': 0.9927433789746104, 'f1-score': 0.4956991756990618, 'support': 175426}, '2': {'precision': 0.38736706413148564, 'recall': 0.006681861137361721, 'f1-score': 0.013137114534435742, 'support': 179890}, 'accuracy': 0.33077284958882974, 'macro avg': {'precision': 0.3695282178537301, 'recall': 0.3339386695595868, 'f1-score': 0.1711962536701059, 'support': 531410}, 'weighted avg': {'precision': 0.3697049352554098, 'recall': 0.33077284958882974, 'f1-score': 0.1696592851447218, 'support': 531410}}
[[   421 174716    957]
 [   329 174153    944]
 [   327 178361   1202]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955048
{'0': {'precision': 0.3931034482758621, 'recall': 0.0012083183176817248, 'f1-score': 0.002409231159389662, 'support': 47173}, '1': {'precision': 0.37105755107490984, 'recall': 0.9968789797492421, 'f1-score': 0.5408137945127498, 'support': 55751}, '2': {'precision': 0.4051948051948052, 'recall': 0.0032921115941417296, 'f1-score': 0.006531159071403152, 'support': 47386}, 'accuracy': 0.3711662564034329, 'macro avg': {'precision': 0.38978526818185905, 'recall': 0.33379313655368853, 'f1-score': 0.18325139491451417, 'support': 150310}, 'weighted avg': {'precision': 0.3887383376651958, 'recall': 0.3711662564034329, 'f1-score': 0.20340659984777934, 'support': 150310}}
[[   57 47013   103]
 [   48 55577   126]
 [   40 47190   156]]
training model: results/AAL/W2/deepLOB_L2/h10
Epoch 1/50
2076/2076 - 85s - loss: 2.8992 - accuracy10: 0.4216 - val_loss: 3.0537 - val_accuracy10: 0.4685 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 82s - loss: 2.7275 - accuracy10: 0.4514 - val_loss: 3.0691 - val_accuracy10: 0.5020 - 82s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 81s - loss: 2.6388 - accuracy10: 0.4998 - val_loss: 2.9784 - val_accuracy10: 0.5371 - 81s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 81s - loss: 2.5251 - accuracy10: 0.5564 - val_loss: 2.8042 - val_accuracy10: 0.4902 - 81s/epoch - 39ms/step
Epoch 5/50
2076/2076 - 81s - loss: 2.4100 - accuracy10: 0.5993 - val_loss: 2.5902 - val_accuracy10: 0.5218 - 81s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 82s - loss: 2.3295 - accuracy10: 0.6211 - val_loss: 2.5860 - val_accuracy10: 0.5481 - 82s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 2.2816 - accuracy10: 0.6325 - val_loss: 2.6259 - val_accuracy10: 0.5224 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 2.2471 - accuracy10: 0.6405 - val_loss: 2.6273 - val_accuracy10: 0.5149 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 81s - loss: 2.2188 - accuracy10: 0.6466 - val_loss: 2.5396 - val_accuracy10: 0.5331 - 81s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 82s - loss: 2.1999 - accuracy10: 0.6487 - val_loss: 2.5365 - val_accuracy10: 0.5419 - 82s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 81s - loss: 2.1847 - accuracy10: 0.6508 - val_loss: 2.5502 - val_accuracy10: 0.5144 - 81s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 2.1678 - accuracy10: 0.6525 - val_loss: 2.5432 - val_accuracy10: 0.5224 - 81s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 82s - loss: 2.1565 - accuracy10: 0.6544 - val_loss: 2.5710 - val_accuracy10: 0.5090 - 82s/epoch - 39ms/step
Epoch 14/50
2076/2076 - 81s - loss: 2.1419 - accuracy10: 0.6564 - val_loss: 2.6280 - val_accuracy10: 0.4948 - 81s/epoch - 39ms/step
Epoch 15/50
2076/2076 - 81s - loss: 2.1314 - accuracy10: 0.6573 - val_loss: 2.5002 - val_accuracy10: 0.5249 - 81s/epoch - 39ms/step
Epoch 16/50
2076/2076 - 82s - loss: 2.1205 - accuracy10: 0.6592 - val_loss: 2.5517 - val_accuracy10: 0.5106 - 82s/epoch - 40ms/step
Epoch 17/50
2076/2076 - 82s - loss: 2.1104 - accuracy10: 0.6604 - val_loss: 2.5841 - val_accuracy10: 0.4918 - 82s/epoch - 40ms/step
Epoch 18/50
2076/2076 - 81s - loss: 2.1035 - accuracy10: 0.6605 - val_loss: 2.6162 - val_accuracy10: 0.4771 - 81s/epoch - 39ms/step
Epoch 19/50
2076/2076 - 81s - loss: 2.0968 - accuracy10: 0.6614 - val_loss: 2.6624 - val_accuracy10: 0.4811 - 81s/epoch - 39ms/step
Epoch 20/50
2076/2076 - 81s - loss: 2.0899 - accuracy10: 0.6619 - val_loss: 2.6329 - val_accuracy10: 0.4806 - 81s/epoch - 39ms/step
Epoch 21/50
2076/2076 - 81s - loss: 2.0867 - accuracy10: 0.6628 - val_loss: 2.5655 - val_accuracy10: 0.4987 - 81s/epoch - 39ms/step
Epoch 22/50
2076/2076 - 81s - loss: 2.0784 - accuracy10: 0.6635 - val_loss: 2.6233 - val_accuracy10: 0.4912 - 81s/epoch - 39ms/step
Epoch 23/50
2076/2076 - 82s - loss: 2.0730 - accuracy10: 0.6642 - val_loss: 2.6535 - val_accuracy10: 0.4823 - 82s/epoch - 39ms/step
Epoch 24/50
2076/2076 - 83s - loss: 2.0668 - accuracy10: 0.6652 - val_loss: 2.7339 - val_accuracy10: 0.4721 - 83s/epoch - 40ms/step
Epoch 25/50
2076/2076 - 81s - loss: 2.0596 - accuracy10: 0.6655 - val_loss: 2.7239 - val_accuracy10: 0.4526 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h10
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0058554
{'0': {'precision': 0.32136162593873746, 'recall': 0.7607751270766683, 'f1-score': 0.4518540399442974, 'support': 246308}, '1': {'precision': 0.861927636255245, 'recall': 0.39467743882913103, 'f1-score': 0.5414324654234347, 'support': 761964}, '2': {'precision': 0.38919087564006893, 'recall': 0.5157032471988169, 'f1-score': 0.4436032753048831, 'support': 234633}, 'accuracy': 0.49007446265000143, 'macro avg': {'precision': 0.5241600459446838, 'recall': 0.5570519377015387, 'f1-score': 0.4789632602242051, 'support': 1242905}, 'weighted avg': {'precision': 0.6655607560653198, 'recall': 0.49007446265000143, 'f1-score': 0.5052126101746414, 'support': 1242905}}
[[187385  23794  35129]
 [306460 300730 154774]
 [ 89252  24380 121001]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7725028
{'0': {'precision': 0.32133216428369243, 'recall': 0.6394460625377809, 'f1-score': 0.42772531991637375, 'support': 72788}, '1': {'precision': 0.8810235874253695, 'recall': 0.6313733557985526, 'f1-score': 0.7355936831566012, 'support': 384001}, '2': {'precision': 0.38589796541383087, 'recall': 0.5759638707602418, 'f1-score': 0.4621522083926987, 'support': 74621}, 'accuracy': 0.6246984437628197, 'macro avg': {'precision': 0.5294179057076309, 'recall': 0.6155944296988585, 'f1-score': 0.5418237371552246, 'support': 531410}, 'weighted avg': {'precision': 0.7348359199976593, 'recall': 0.6246984437628197, 'f1-score': 0.6550276442941657, 'support': 531410}}
[[ 46544  17466   8778]
 [ 81936 242448  59617]
 [ 16367  15275  42979]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9115785
{'0': {'precision': 0.25187164914427396, 'recall': 0.7738807815978234, 'f1-score': 0.38005004494327427, 'support': 20215}, '1': {'precision': 0.9179507207271178, 'recall': 0.47004390470043905, 'f1-score': 0.6217273946003139, 'support': 110011}, '2': {'precision': 0.364075689584837, 'recall': 0.5776737701653057, 'f1-score': 0.4466516525187196, 'support': 20084}, 'accuracy': 0.5252877386734083, 'macro avg': {'precision': 0.5112993531520762, 'recall': 0.6071994854878561, 'f1-score': 0.48280969735410256, 'support': 150310}, 'weighted avg': {'precision': 0.7543633708667709, 'recall': 0.5252877386734083, 'f1-score': 0.565831387499763, 'support': 150310}}
[[15644  2357  2214]
 [40250 51710 18051]
 [ 6217  2265 11602]]
training model: results/AAL/W2/deepLOB_L2/h20
Epoch 1/50
2076/2076 - 84s - loss: 2.9574 - accuracy20: 0.4296 - val_loss: 3.4157 - val_accuracy20: 0.4441 - 84s/epoch - 40ms/step
Epoch 2/50
2076/2076 - 81s - loss: 2.8275 - accuracy20: 0.4631 - val_loss: 3.2030 - val_accuracy20: 0.4382 - 81s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 82s - loss: 2.7473 - accuracy20: 0.4925 - val_loss: 3.1187 - val_accuracy20: 0.4678 - 82s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 82s - loss: 2.6405 - accuracy20: 0.5397 - val_loss: 2.8501 - val_accuracy20: 0.5256 - 82s/epoch - 39ms/step
Epoch 5/50
2076/2076 - 82s - loss: 2.5220 - accuracy20: 0.5855 - val_loss: 2.8531 - val_accuracy20: 0.5123 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 82s - loss: 2.4604 - accuracy20: 0.6015 - val_loss: 2.8291 - val_accuracy20: 0.5186 - 82s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 2.4147 - accuracy20: 0.6119 - val_loss: 2.7246 - val_accuracy20: 0.5114 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 2.3881 - accuracy20: 0.6180 - val_loss: 2.7047 - val_accuracy20: 0.5044 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 81s - loss: 2.3644 - accuracy20: 0.6227 - val_loss: 2.6216 - val_accuracy20: 0.5233 - 81s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 82s - loss: 2.3414 - accuracy20: 0.6272 - val_loss: 2.6425 - val_accuracy20: 0.5004 - 82s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 82s - loss: 2.3228 - accuracy20: 0.6317 - val_loss: 2.6662 - val_accuracy20: 0.4765 - 82s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 82s - loss: 2.3065 - accuracy20: 0.6335 - val_loss: 2.6687 - val_accuracy20: 0.4971 - 82s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 81s - loss: 2.2924 - accuracy20: 0.6366 - val_loss: 2.7097 - val_accuracy20: 0.4695 - 81s/epoch - 39ms/step
Epoch 14/50
2076/2076 - 82s - loss: 2.2813 - accuracy20: 0.6379 - val_loss: 2.6777 - val_accuracy20: 0.4866 - 82s/epoch - 39ms/step
Epoch 15/50
2076/2076 - 82s - loss: 2.2694 - accuracy20: 0.6397 - val_loss: 2.7157 - val_accuracy20: 0.4878 - 82s/epoch - 39ms/step
Epoch 16/50
2076/2076 - 81s - loss: 2.2587 - accuracy20: 0.6412 - val_loss: 2.6969 - val_accuracy20: 0.4817 - 81s/epoch - 39ms/step
Epoch 17/50
2076/2076 - 82s - loss: 2.2502 - accuracy20: 0.6428 - val_loss: 2.6958 - val_accuracy20: 0.4854 - 82s/epoch - 39ms/step
Epoch 18/50
2076/2076 - 82s - loss: 2.2420 - accuracy20: 0.6434 - val_loss: 2.7089 - val_accuracy20: 0.4810 - 82s/epoch - 39ms/step
Epoch 19/50
2076/2076 - 82s - loss: 2.2333 - accuracy20: 0.6447 - val_loss: 2.7548 - val_accuracy20: 0.4736 - 82s/epoch - 40ms/step
testing model: results/AAL/W2/deepLOB_L2/h20
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9698113
{'0': {'precision': 0.39654904728299223, 'recall': 0.5480230947783175, 'f1-score': 0.46014068475314657, 'support': 307602}, '1': {'precision': 0.7267721239512714, 'recall': 0.4389694415769012, 'f1-score': 0.5473438759301716, 'support': 637402}, '2': {'precision': 0.4229058604715641, 'recall': 0.614432311405467, 'f1-score': 0.5009880719732428, 'support': 297901}, 'accuracy': 0.5080138868215994, 'macro avg': {'precision': 0.5154090105686092, 'recall': 0.5338082825868952, 'f1-score': 0.5028242108855204, 'support': 1242905}, 'weighted avg': {'precision': 0.5722153858367861, 'recall': 0.5080138868215994, 'f1-score': 0.5146516618293285, 'support': 1242905}}
[[168573  55103  83926]
 [191753 279800 165849]
 [ 64774  50087 183040]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87509996
{'0': {'precision': 0.3397974574445163, 'recall': 0.6222005336766584, 'f1-score': 0.43954802674285126, 'support': 96313}, '1': {'precision': 0.8119294420498633, 'recall': 0.5263207902917868, 'f1-score': 0.6386478930074365, 'support': 336787}, '2': {'precision': 0.4143928035982009, 'recall': 0.5763604923202116, 'f1-score': 0.4821374630389926, 'support': 98310}, 'accuracy': 0.5529553452136768, 'macro avg': {'precision': 0.5220399010308602, 'recall': 0.5749606054295522, 'f1-score': 0.5201111275964267, 'support': 531410}, 'weighted avg': {'precision': 0.6528163753791613, 'recall': 0.5529553452136768, 'f1-score': 0.5736087597774658, 'support': 531410}}
[[ 59926  19905  16482]
 [ 95938 177258  63591]
 [ 20494  21154  56662]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91642565
{'0': {'precision': 0.32423220372254047, 'recall': 0.6743245249406176, 'f1-score': 0.43790747279497716, 'support': 26944}, '1': {'precision': 0.8371751606322332, 'recall': 0.45458216001325163, 'f1-score': 0.5892204158587234, 'support': 96592}, '2': {'precision': 0.3935061208875287, 'recall': 0.6147008291626205, 'f1-score': 0.47983906236333423, 'support': 26774}, 'accuracy': 0.5224935134056283, 'macro avg': {'precision': 0.5183044950807675, 'recall': 0.5812025047054966, 'f1-score': 0.5023223170056782, 'support': 150310}, 'weighted avg': {'precision': 0.666198313442429, 'recall': 0.5224935134056283, 'f1-score': 0.5426130557602927, 'support': 150310}}
[[18169  4561  4214]
 [31531 43909 21152]
 [ 6337  3979 16458]]
training model: results/AAL/W2/deepLOB_L2/h30
Epoch 1/50
2076/2076 - 85s - loss: 3.0134 - accuracy30: 0.4421 - val_loss: 3.2838 - val_accuracy30: 0.4132 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 82s - loss: 2.9154 - accuracy30: 0.4540 - val_loss: 3.6226 - val_accuracy30: 0.4182 - 82s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 82s - loss: 2.8238 - accuracy30: 0.4955 - val_loss: 3.3330 - val_accuracy30: 0.4324 - 82s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 83s - loss: 2.7486 - accuracy30: 0.5262 - val_loss: 3.1024 - val_accuracy30: 0.5397 - 83s/epoch - 40ms/step
Epoch 5/50
2076/2076 - 82s - loss: 2.6652 - accuracy30: 0.5577 - val_loss: 3.0312 - val_accuracy30: 0.4828 - 82s/epoch - 40ms/step
Epoch 6/50
2076/2076 - 82s - loss: 2.5838 - accuracy30: 0.5812 - val_loss: 2.8511 - val_accuracy30: 0.5322 - 82s/epoch - 40ms/step
Epoch 7/50
2076/2076 - 82s - loss: 2.5302 - accuracy30: 0.5929 - val_loss: 2.8682 - val_accuracy30: 0.5006 - 82s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 82s - loss: 2.4957 - accuracy30: 0.5992 - val_loss: 2.8196 - val_accuracy30: 0.5402 - 82s/epoch - 40ms/step
Epoch 9/50
2076/2076 - 82s - loss: 2.4697 - accuracy30: 0.6040 - val_loss: 2.8074 - val_accuracy30: 0.5400 - 82s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 82s - loss: 2.4478 - accuracy30: 0.6078 - val_loss: 2.7877 - val_accuracy30: 0.5498 - 82s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 82s - loss: 2.4316 - accuracy30: 0.6104 - val_loss: 2.7753 - val_accuracy30: 0.5290 - 82s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 2.4187 - accuracy30: 0.6129 - val_loss: 2.7517 - val_accuracy30: 0.5343 - 81s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 81s - loss: 2.4060 - accuracy30: 0.6152 - val_loss: 2.7565 - val_accuracy30: 0.5343 - 81s/epoch - 39ms/step
Epoch 14/50
2076/2076 - 81s - loss: 2.3959 - accuracy30: 0.6166 - val_loss: 2.7974 - val_accuracy30: 0.5148 - 81s/epoch - 39ms/step
Epoch 15/50
2076/2076 - 82s - loss: 2.3878 - accuracy30: 0.6180 - val_loss: 2.7941 - val_accuracy30: 0.5247 - 82s/epoch - 39ms/step
Epoch 16/50
2076/2076 - 82s - loss: 2.3792 - accuracy30: 0.6195 - val_loss: 2.7591 - val_accuracy30: 0.5266 - 82s/epoch - 39ms/step
Epoch 17/50
2076/2076 - 82s - loss: 2.3736 - accuracy30: 0.6200 - val_loss: 2.8341 - val_accuracy30: 0.4959 - 82s/epoch - 40ms/step
Epoch 18/50
2076/2076 - 82s - loss: 2.3686 - accuracy30: 0.6210 - val_loss: 2.8089 - val_accuracy30: 0.4989 - 82s/epoch - 39ms/step
Epoch 19/50
2076/2076 - 82s - loss: 2.3597 - accuracy30: 0.6226 - val_loss: 2.8628 - val_accuracy30: 0.5025 - 82s/epoch - 39ms/step
Epoch 20/50
2076/2076 - 81s - loss: 2.3538 - accuracy30: 0.6227 - val_loss: 2.8539 - val_accuracy30: 0.4895 - 81s/epoch - 39ms/step
Epoch 21/50
2076/2076 - 81s - loss: 2.3488 - accuracy30: 0.6240 - val_loss: 2.8447 - val_accuracy30: 0.4967 - 81s/epoch - 39ms/step
Epoch 22/50
2076/2076 - 82s - loss: 2.3421 - accuracy30: 0.6250 - val_loss: 2.7872 - val_accuracy30: 0.5080 - 82s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h30
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98834985
{'0': {'precision': 0.47479424396420444, 'recall': 0.3976988035383619, 'f1-score': 0.4328403608302903, 'support': 348862}, '1': {'precision': 0.6672779506574333, 'recall': 0.46274313423856067, 'f1-score': 0.5465000510568774, 'support': 555146}, '2': {'precision': 0.4156773459099041, 'recall': 0.6938745400519922, 'f1-score': 0.519899845789046, 'support': 338897}, 'accuracy': 0.5075078143542748, 'macro avg': {'precision': 0.5192498468438472, 'recall': 0.5181054926096382, 'f1-score': 0.49974675255873785, 'support': 1242905}, 'weighted avg': {'precision': 0.5446483522315386, 'recall': 0.5075078143542748, 'f1-score': 0.5073447844705495, 'support': 1242905}}
[[138742  77737 132383]
 [100083 256890 198173]
 [ 53390  50355 235152]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93698597
{'0': {'precision': 0.4010211115571951, 'recall': 0.468064789927854, 'f1-score': 0.4319569838077326, 'support': 113104}, '1': {'precision': 0.6986502143648186, 'recall': 0.6305625746349895, 'f1-score': 0.6628625327486688, 'support': 303142}, '2': {'precision': 0.4100939601583491, 'recall': 0.447961168420687, 'f1-score': 0.4281919970783775, 'support': 115164}, 'accuracy': 0.5564046593026101, 'macro avg': {'precision': 0.5032550953601209, 'recall': 0.5155295109945102, 'f1-score': 0.5076705045449263, 'support': 531410}, 'weighted avg': {'precision': 0.5727693794099112, 'recall': 0.5564046593026101, 'f1-score': 0.5628607661704165, 'support': 531410}}
[[ 52940  40521  19643]
 [ 57426 191150  54566]
 [ 21647  41928  51589]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9180901
{'0': {'precision': 0.39987272495863563, 'recall': 0.492506897416604, 'f1-score': 0.44138182942077236, 'support': 31896}, '1': {'precision': 0.7421503804365883, 'recall': 0.5149506639616378, 'f1-score': 0.6080192723857744, 'support': 86752}, '2': {'precision': 0.38661446754933015, 'recall': 0.6206809424546775, 'f1-score': 0.4764525474888779, 'support': 31662}, 'accuracy': 0.5324595835273768, 'macro avg': {'precision': 0.5095458576481847, 'recall': 0.5427128346109731, 'f1-score': 0.5086178830984749, 'support': 150310}, 'weighted avg': {'precision': 0.5946268213057179, 'recall': 0.5324595835273768, 'f1-score': 0.5449447362637782, 'support': 150310}}
[[15709  9630  6557]
 [17457 44673 24622]
 [ 6119  5891 19652]]
training model: results/AAL/W2/deepLOB_L2/h50
Epoch 1/50
2076/2076 - 85s - loss: 3.0654 - accuracy50: 0.4480 - val_loss: 3.6701 - val_accuracy50: 0.4464 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 81s - loss: 2.9970 - accuracy50: 0.4618 - val_loss: 3.6264 - val_accuracy50: 0.4371 - 81s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 82s - loss: 2.9272 - accuracy50: 0.4903 - val_loss: 3.5984 - val_accuracy50: 0.4475 - 82s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 82s - loss: 2.8803 - accuracy50: 0.5078 - val_loss: 3.3674 - val_accuracy50: 0.4206 - 82s/epoch - 40ms/step
Epoch 5/50
2076/2076 - 82s - loss: 2.8468 - accuracy50: 0.5190 - val_loss: 3.3999 - val_accuracy50: 0.4591 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 82s - loss: 2.8041 - accuracy50: 0.5340 - val_loss: 3.3668 - val_accuracy50: 0.4519 - 82s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 2.7655 - accuracy50: 0.5458 - val_loss: 3.3701 - val_accuracy50: 0.4630 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 2.7312 - accuracy50: 0.5544 - val_loss: 3.2467 - val_accuracy50: 0.4798 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 83s - loss: 2.7034 - accuracy50: 0.5607 - val_loss: 3.2986 - val_accuracy50: 0.4791 - 83s/epoch - 40ms/step
Epoch 10/50
2076/2076 - 83s - loss: 2.6834 - accuracy50: 0.5655 - val_loss: 3.2663 - val_accuracy50: 0.4913 - 83s/epoch - 40ms/step
Epoch 11/50
2076/2076 - 81s - loss: 2.6660 - accuracy50: 0.5692 - val_loss: 3.1766 - val_accuracy50: 0.4987 - 81s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 82s - loss: 2.6547 - accuracy50: 0.5712 - val_loss: 3.2138 - val_accuracy50: 0.5037 - 82s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 82s - loss: 2.6406 - accuracy50: 0.5743 - val_loss: 3.1964 - val_accuracy50: 0.4944 - 82s/epoch - 40ms/step
Epoch 14/50
2076/2076 - 81s - loss: 2.6307 - accuracy50: 0.5761 - val_loss: 3.1443 - val_accuracy50: 0.5039 - 81s/epoch - 39ms/step
Epoch 15/50
2076/2076 - 81s - loss: 2.6215 - accuracy50: 0.5779 - val_loss: 3.0998 - val_accuracy50: 0.5166 - 81s/epoch - 39ms/step
Epoch 16/50
2076/2076 - 81s - loss: 2.6107 - accuracy50: 0.5791 - val_loss: 3.1735 - val_accuracy50: 0.5063 - 81s/epoch - 39ms/step
Epoch 17/50
2076/2076 - 82s - loss: 2.6022 - accuracy50: 0.5802 - val_loss: 3.1169 - val_accuracy50: 0.5118 - 82s/epoch - 40ms/step
Epoch 18/50
2076/2076 - 83s - loss: 2.5961 - accuracy50: 0.5818 - val_loss: 3.1236 - val_accuracy50: 0.5119 - 83s/epoch - 40ms/step
Epoch 19/50
2076/2076 - 82s - loss: 2.5875 - accuracy50: 0.5835 - val_loss: 3.2054 - val_accuracy50: 0.5096 - 82s/epoch - 40ms/step
Epoch 20/50
2076/2076 - 81s - loss: 2.5808 - accuracy50: 0.5840 - val_loss: 3.1968 - val_accuracy50: 0.5038 - 81s/epoch - 39ms/step
Epoch 21/50
2076/2076 - 82s - loss: 2.5750 - accuracy50: 0.5852 - val_loss: 3.2360 - val_accuracy50: 0.5114 - 82s/epoch - 40ms/step
Epoch 22/50
2076/2076 - 82s - loss: 2.5684 - accuracy50: 0.5863 - val_loss: 3.1553 - val_accuracy50: 0.5017 - 82s/epoch - 39ms/step
Epoch 23/50
2076/2076 - 82s - loss: 2.5639 - accuracy50: 0.5865 - val_loss: 3.2172 - val_accuracy50: 0.4913 - 82s/epoch - 39ms/step
Epoch 24/50
2076/2076 - 81s - loss: 2.5577 - accuracy50: 0.5878 - val_loss: 3.3701 - val_accuracy50: 0.4959 - 81s/epoch - 39ms/step
Epoch 25/50
2076/2076 - 82s - loss: 2.5523 - accuracy50: 0.5886 - val_loss: 3.3295 - val_accuracy50: 0.4926 - 82s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h50
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1000851
{'0': {'precision': 0.4984931834489357, 'recall': 0.3342066376058635, 'f1-score': 0.4001435487253406, 'support': 405357}, '1': {'precision': 0.4506370818403231, 'recall': 0.6140031993960691, 'f1-score': 0.519786100325148, 'support': 445084}, '2': {'precision': 0.4775036125285506, 'recall': 0.4437273227608137, 'f1-score': 0.4599962755904575, 'support': 392464}, 'accuracy': 0.46898435520011583, 'macro avg': {'precision': 0.47554462593926977, 'recall': 0.4639790532542487, 'f1-score': 0.4599753082136487, 'support': 1242905}, 'weighted avg': {'precision': 0.4747281844425226, 'recall': 0.46898435520011583, 'f1-score': 0.4618868243840916, 'support': 1242905}}
[[135473 180738  89146]
 [ 70391 273283 101410]
 [ 65901 152416 174147]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99034435
{'0': {'precision': 0.4274966021616724, 'recall': 0.3819636700086018, 'f1-score': 0.4034495000973465, 'support': 138343}, '1': {'precision': 0.5587863699435961, 'recall': 0.7133634782057328, 'f1-score': 0.6266837024220249, 'support': 252337}, '2': {'precision': 0.4815493631874482, 'recall': 0.2931144745256875, 'f1-score': 0.36441377969972305, 'support': 140730}, 'accuracy': 0.5157975950772473, 'macro avg': {'precision': 0.48927744509757226, 'recall': 0.46281387424667403, 'f1-score': 0.46484899407303143, 'support': 531410}, 'weighted avg': {'precision': 0.504153253696165, 'recall': 0.5157975950772473, 'f1-score': 0.4991133979924648, 'support': 531410}}
[[ 52842  71455  14046]
 [ 41964 180008  30365]
 [ 28802  70678  41250]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98690706
{'0': {'precision': 0.42133872092743585, 'recall': 0.4447321655242447, 'f1-score': 0.43271950300739803, 'support': 39390}, '1': {'precision': 0.5877687136289959, 'recall': 0.6154477539266288, 'f1-score': 0.601289866595989, 'support': 71881}, '2': {'precision': 0.4766486389577793, 'recall': 0.4086170240016394, 'f1-score': 0.4400187570683806, 'support': 39039}, 'accuracy': 0.5169915507950236, 'macro avg': {'precision': 0.495252024504737, 'recall': 0.4895989811508376, 'f1-score': 0.4913427088905893, 'support': 150310}, 'weighted avg': {'precision': 0.5152938682587339, 'recall': 0.5169915507950236, 'f1-score': 0.5152287298346098, 'support': 150310}}
[[17518 17030  4842]
 [14969 44239 12673]
 [ 9090 13997 15952]]
training model: results/AAL/W2/deepLOB_L2/h100
Epoch 1/50
2076/2076 - 84s - loss: 3.1865 - accuracy100: 0.4246 - val_loss: 3.5424 - val_accuracy100: 0.3520 - 84s/epoch - 40ms/step
Epoch 2/50
2076/2076 - 81s - loss: 3.1663 - accuracy100: 0.4353 - val_loss: 3.5073 - val_accuracy100: 0.3618 - 81s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 81s - loss: 3.1095 - accuracy100: 0.4583 - val_loss: 3.5719 - val_accuracy100: 0.3595 - 81s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 82s - loss: 3.0785 - accuracy100: 0.4655 - val_loss: 3.6668 - val_accuracy100: 0.3636 - 82s/epoch - 40ms/step
Epoch 5/50
2076/2076 - 82s - loss: 3.0596 - accuracy100: 0.4712 - val_loss: 3.6161 - val_accuracy100: 0.3766 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 81s - loss: 3.0442 - accuracy100: 0.4765 - val_loss: 3.9478 - val_accuracy100: 0.3692 - 81s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 3.0319 - accuracy100: 0.4795 - val_loss: 3.7470 - val_accuracy100: 0.3689 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 3.0212 - accuracy100: 0.4826 - val_loss: 3.7413 - val_accuracy100: 0.3791 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 83s - loss: 3.0100 - accuracy100: 0.4858 - val_loss: 3.5889 - val_accuracy100: 0.3875 - 83s/epoch - 40ms/step
Epoch 10/50
2076/2076 - 82s - loss: 2.9983 - accuracy100: 0.4887 - val_loss: 3.6357 - val_accuracy100: 0.3898 - 82s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 82s - loss: 2.9902 - accuracy100: 0.4906 - val_loss: 3.6452 - val_accuracy100: 0.3890 - 82s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 2.9784 - accuracy100: 0.4938 - val_loss: 3.5861 - val_accuracy100: 0.3959 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h100
Evaluating performance on  test set...
4856/4856 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2138647
{'0': {'precision': 0.538650091919811, 'recall': 0.01284867670950255, 'f1-score': 0.02509866307706428, 'support': 478882}, '1': {'precision': 0.24986653786511426, 'recall': 0.5483780980886368, 'f1-score': 0.34330662716386234, 'support': 304704}, '2': {'precision': 0.435734682889296, 'recall': 0.5338577328610399, 'f1-score': 0.4798311664931629, 'support': 459319}, 'accuracy': 0.3366765762467767, 'macro avg': {'precision': 0.40808377089140707, 'recall': 0.36502816921972636, 'f1-score': 0.2827454855780298, 'support': 1242905}, 'weighted avg': {'precision': 0.4298207712435168, 'recall': 0.3366765762467767, 'f1-score': 0.2711565019510592, 'support': 1242905}}
[[  6153 290779 181950]
 [  2019 167093 135592]
 [  3251 210857 245211]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1535051
{'0': {'precision': 0.4854122621564482, 'recall': 0.00654713021261064, 'f1-score': 0.012919998424390436, 'support': 175344}, '1': {'precision': 0.3437274843769146, 'recall': 0.7833979378679387, 'f1-score': 0.47780911890551336, 'support': 179038}, '2': {'precision': 0.42987726765568823, 'recall': 0.29381227828366135, 'f1-score': 0.3490535965344957, 'support': 177028}, 'accuracy': 0.36397320336463374, 'macro avg': {'precision': 0.41967233806301696, 'recall': 0.3612524487880702, 'f1-score': 0.27992757128813317, 'support': 531410}, 'weighted avg': {'precision': 0.419176759906636, 'recall': 0.36397320336463374, 'f1-score': 0.28152216428302124, 'support': 531410}}
[[  1148 143371  30825]
 [   623 140258  38157]
 [   594 124421  52013]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.166623
{'0': {'precision': 0.484375, 'recall': 0.009194084150585258, 'f1-score': 0.018045638000620926, 'support': 50576}, '1': {'precision': 0.32939007689876754, 'recall': 0.6258932324506095, 'f1-score': 0.43162696961121966, 'support': 49959}, '2': {'precision': 0.41644615950018377, 'recall': 0.4553088900050226, 'f1-score': 0.43501127693267433, 'support': 49775}, 'accuracy': 0.3618987425986295, 'macro avg': {'precision': 0.41007041213298373, 'recall': 0.36346540220207246, 'f1-score': 0.29489462818150497, 'support': 150310}, 'weighted avg': {'precision': 0.4103676165318819, 'recall': 0.3618987425986295, 'f1-score': 0.29358668266682314, 'support': 150310}}
[[  465 36790 13321]
 [  254 31269 18436]
 [  241 26871 22663]]
training model: results/AAL/W2/deepLOB_L2/h200
Epoch 1/50
2076/2076 - 85s - loss: 3.2613 - accuracy200: 0.3910 - val_loss: 3.3935 - val_accuracy200: 0.3453 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 82s - loss: 3.2290 - accuracy200: 0.4060 - val_loss: 3.3728 - val_accuracy200: 0.3512 - 82s/epoch - 40ms/step
Epoch 3/50
2076/2076 - 82s - loss: 3.2146 - accuracy200: 0.4149 - val_loss: 3.3816 - val_accuracy200: 0.3492 - 82s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 82s - loss: 3.2011 - accuracy200: 0.4216 - val_loss: 3.3475 - val_accuracy200: 0.3518 - 82s/epoch - 39ms/step
Epoch 5/50
2076/2076 - 82s - loss: 3.1881 - accuracy200: 0.4274 - val_loss: 3.3447 - val_accuracy200: 0.3507 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 81s - loss: 3.1769 - accuracy200: 0.4323 - val_loss: 3.3343 - val_accuracy200: 0.3533 - 81s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 3.1693 - accuracy200: 0.4346 - val_loss: 3.3824 - val_accuracy200: 0.3500 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 82s - loss: 3.1623 - accuracy200: 0.4383 - val_loss: 3.3618 - val_accuracy200: 0.3594 - 82s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 82s - loss: 3.1545 - accuracy200: 0.4411 - val_loss: 3.3854 - val_accuracy200: 0.3486 - 82s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 81s - loss: 3.1448 - accuracy200: 0.4448 - val_loss: 3.3985 - val_accuracy200: 0.3488 - 81s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 82s - loss: 3.1400 - accuracy200: 0.4457 - val_loss: 3.3871 - val_accuracy200: 0.3491 - 82s/epoch - 40ms/step
Epoch 12/50
2076/2076 - 82s - loss: 3.1339 - accuracy200: 0.4485 - val_loss: 3.4121 - val_accuracy200: 0.3492 - 82s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 82s - loss: 3.1289 - accuracy200: 0.4499 - val_loss: 3.4136 - val_accuracy200: 0.3509 - 82s/epoch - 40ms/step
Epoch 14/50
2076/2076 - 82s - loss: 3.1219 - accuracy200: 0.4524 - val_loss: 3.3971 - val_accuracy200: 0.3538 - 82s/epoch - 39ms/step
Epoch 15/50
2076/2076 - 82s - loss: 3.1146 - accuracy200: 0.4552 - val_loss: 3.4213 - val_accuracy200: 0.3538 - 82s/epoch - 39ms/step
Epoch 16/50
2076/2076 - 81s - loss: 3.1092 - accuracy200: 0.4585 - val_loss: 3.4247 - val_accuracy200: 0.3510 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h200
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147895
{'0': {'precision': 0.42282915977940155, 'recall': 0.06311277335571522, 'f1-score': 0.10983172724846864, 'support': 433684}, '1': {'precision': 0.3116172336522638, 'recall': 0.7723826315816529, 'f1-score': 0.444073374349714, 'support': 389074}, '2': {'precision': 0.3579182705574758, 'recall': 0.18213625231169092, 'f1-score': 0.24141967032100323, 'support': 420147}, 'accuracy': 0.3253740229542885, 'macro avg': {'precision': 0.36412155466304713, 'recall': 0.33921055241635295, 'f1-score': 0.26510825730639526, 'support': 1242905}, 'weighted avg': {'precision': 0.3660735876963265, 'recall': 0.3253740229542885, 'f1-score': 0.2589428935261537, 'support': 1242905}}
[[ 27371 341336  64977]
 [ 16258 300514  72302]
 [ 21104 322519  76524]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1361233
{'0': {'precision': 0.3405288221015768, 'recall': 0.31027845935663956, 'f1-score': 0.3247006027697372, 'support': 177692}, '1': {'precision': 0.32815150551314676, 'recall': 0.5593146639108656, 'f1-score': 0.41362691974399934, 'support': 177081}, '2': {'precision': 0.39346030526455766, 'recall': 0.15075550422618136, 'f1-score': 0.2179881792432751, 'support': 176637}, 'accuracy': 0.3402401159180294, 'macro avg': {'precision': 0.3540468776264271, 'recall': 0.3401162091645622, 'f1-score': 0.31877190058567056, 'support': 531410}, 'weighted avg': {'precision': 0.3539984045194155, 'recall': 0.34024011591802933, 'f1-score': 0.31886292335398597, 'support': 531410}}
[[ 55134 102394  20164]
 [ 57151  99044  20886]
 [ 49622 100386  26629]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1115971
{'0': {'precision': 0.35602465499372715, 'recall': 0.13180266957452394, 'f1-score': 0.19238364724260915, 'support': 49521}, '1': {'precision': 0.34571106914584543, 'recall': 0.7348837209302326, 'f1-score': 0.47021777116430696, 'support': 51815}, '2': {'precision': 0.3801126734759309, 'recall': 0.16945726303753011, 'f1-score': 0.23441185193554312, 'support': 48974}, 'accuracy': 0.3519659370634023, 'macro avg': {'precision': 0.36061613253850117, 'recall': 0.34538121784742887, 'f1-score': 0.2990044234474864, 'support': 150310}, 'weighted avg': {'precision': 0.36031770380245215, 'recall': 0.3519659370634023, 'f1-score': 0.3018525077817251, 'support': 150310}}
[[ 6527 36764  6230]
 [ 6433 38078  7304]
 [ 5373 35302  8299]]
training model: results/AAL/W2/deepLOB_L2/h300
Epoch 1/50
2076/2076 - 85s - loss: 3.2856 - accuracy300: 0.3762 - val_loss: 3.3467 - val_accuracy300: 0.3323 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 83s - loss: 3.2511 - accuracy300: 0.3954 - val_loss: 3.3303 - val_accuracy300: 0.3431 - 83s/epoch - 40ms/step
Epoch 3/50
2076/2076 - 82s - loss: 3.2363 - accuracy300: 0.4045 - val_loss: 3.3610 - val_accuracy300: 0.3344 - 82s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 83s - loss: 3.2232 - accuracy300: 0.4111 - val_loss: 3.3659 - val_accuracy300: 0.3391 - 83s/epoch - 40ms/step
Epoch 5/50
2076/2076 - 82s - loss: 3.2130 - accuracy300: 0.4166 - val_loss: 3.3457 - val_accuracy300: 0.3407 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 81s - loss: 3.2039 - accuracy300: 0.4205 - val_loss: 3.3568 - val_accuracy300: 0.3452 - 81s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 82s - loss: 3.1960 - accuracy300: 0.4247 - val_loss: 3.3380 - val_accuracy300: 0.3406 - 82s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 3.1876 - accuracy300: 0.4276 - val_loss: 3.3898 - val_accuracy300: 0.3433 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 81s - loss: 3.1807 - accuracy300: 0.4303 - val_loss: 3.3724 - val_accuracy300: 0.3423 - 81s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 81s - loss: 3.1722 - accuracy300: 0.4341 - val_loss: 3.3860 - val_accuracy300: 0.3408 - 81s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 81s - loss: 3.1637 - accuracy300: 0.4383 - val_loss: 3.3929 - val_accuracy300: 0.3408 - 81s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 3.1584 - accuracy300: 0.4400 - val_loss: 3.4089 - val_accuracy300: 0.3440 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h300
Evaluating performance on  test set...
4856/4856 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123224
{'0': {'precision': 0.3806633974078388, 'recall': 0.2307316996395801, 'f1-score': 0.28731376191482777, 'support': 444759}, '1': {'precision': 0.28434517719550756, 'recall': 0.1356665149822805, 'f1-score': 0.18369069223817952, 'support': 362595}, '2': {'precision': 0.3627052611323942, 'recall': 0.666468450307771, 'f1-score': 0.4697586240657414, 'support': 435551}, 'accuracy': 0.355693315257401, 'macro avg': {'precision': 0.34257127857858016, 'recall': 0.3442888883098772, 'f1-score': 0.3135876927395829, 'support': 1242905}, 'weighted avg': {'precision': 0.34627123608352484, 'recall': 0.355693315257401, 'f1-score': 0.3210177338236127, 'support': 1242905}}
[[102620  63355 278784]
 [ 82146  49192 231257]
 [ 84816  60454 290281]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1087227
{'0': {'precision': 0.3347895977709509, 'recall': 0.526460361418035, 'f1-score': 0.40929686152314276, 'support': 178021}, '1': {'precision': 0.33054208902600263, 'recall': 0.14978858411270948, 'f1-score': 0.20615561018133838, 'support': 175247}, '2': {'precision': 0.35329400482403883, 'recall': 0.341222171077006, 'f1-score': 0.347153173785041, 'support': 178142}, 'accuracy': 0.3401460266084567, 'macro avg': {'precision': 0.33954189720699746, 'recall': 0.33915703886925014, 'f1-score': 0.3208685484965074, 'support': 531410}, 'weighted avg': {'precision': 0.33959200818141594, 'recall': 0.3401460266084567, 'f1-score': 0.32147334353338325, 'support': 531410}}
[[93721 26662 57638]
 [95366 26250 53631]
 [90853 26503 60786]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1104503
{'0': {'precision': 0.34037184362240874, 'recall': 0.3812888915061932, 'f1-score': 0.3596704008888066, 'support': 50943}, '1': {'precision': 0.33464620399293765, 'recall': 0.15048553571792106, 'f1-score': 0.2076112905490802, 'support': 49121}, '2': {'precision': 0.3461084408466144, 'recall': 0.4901285674481551, 'f1-score': 0.40571663920922574, 'support': 50246}, 'accuracy': 0.3422460248819107, 'macro avg': {'precision': 0.34037549615398693, 'recall': 0.3406343315574231, 'f1-score': 0.32433277688237083, 'support': 150310}, 'weighted avg': {'precision': 0.3404183602872227, 'recall': 0.3422460248819107, 'f1-score': 0.3253702460863988, 'support': 150310}}
[[19424  7527 23992]
 [19194  7392 22535]
 [18449  7170 24627]]
training model: results/AAL/W2/deepLOB_L2/h500
Epoch 1/50
2076/2076 - 86s - loss: 3.2320 - accuracy500: 0.4113 - val_loss: 3.3487 - val_accuracy500: 0.3181 - 86s/epoch - 42ms/step
Epoch 2/50
2076/2076 - 82s - loss: 3.1941 - accuracy500: 0.4282 - val_loss: 3.3554 - val_accuracy500: 0.3183 - 82s/epoch - 40ms/step
Epoch 3/50
2076/2076 - 81s - loss: 3.1817 - accuracy500: 0.4353 - val_loss: 3.3931 - val_accuracy500: 0.3156 - 81s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 82s - loss: 3.1785 - accuracy500: 0.4376 - val_loss: 3.3412 - val_accuracy500: 0.3307 - 82s/epoch - 39ms/step
Epoch 5/50
2076/2076 - 81s - loss: 3.1737 - accuracy500: 0.4388 - val_loss: 3.3580 - val_accuracy500: 0.3201 - 81s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 81s - loss: 3.1668 - accuracy500: 0.4437 - val_loss: 3.3854 - val_accuracy500: 0.3637 - 81s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 3.1562 - accuracy500: 0.4478 - val_loss: 3.3508 - val_accuracy500: 0.3552 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 82s - loss: 3.1501 - accuracy500: 0.4481 - val_loss: 3.3733 - val_accuracy500: 0.3609 - 82s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 81s - loss: 3.1431 - accuracy500: 0.4512 - val_loss: 3.3895 - val_accuracy500: 0.3468 - 81s/epoch - 39ms/step
Epoch 10/50
2076/2076 - 81s - loss: 3.1369 - accuracy500: 0.4549 - val_loss: 3.4018 - val_accuracy500: 0.3373 - 81s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 80s - loss: 3.1334 - accuracy500: 0.4569 - val_loss: 3.3719 - val_accuracy500: 0.3641 - 80s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 3.1241 - accuracy500: 0.4589 - val_loss: 3.3806 - val_accuracy500: 0.3625 - 81s/epoch - 39ms/step
Epoch 13/50
2076/2076 - 82s - loss: 3.1156 - accuracy500: 0.4628 - val_loss: 3.3961 - val_accuracy500: 0.3436 - 82s/epoch - 40ms/step
Epoch 14/50
2076/2076 - 81s - loss: 3.1084 - accuracy500: 0.4645 - val_loss: 3.4060 - val_accuracy500: 0.3355 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h500
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132926
{'0': {'precision': 0.3633058385896814, 'recall': 0.2526708884964512, 'f1-score': 0.2980528484140832, 'support': 444515}, '1': {'precision': 0.26584546595286496, 'recall': 0.269274530590044, 'f1-score': 0.2675490114980561, 'support': 360346}, '2': {'precision': 0.34019737640239045, 'recall': 0.4417159006857759, 'f1-score': 0.3843663867382463, 'support': 438044}, 'accuracy': 0.324110853202779, 'macro avg': {'precision': 0.3231162269816456, 'recall': 0.32122043992409033, 'f1-score': 0.3166560822167952, 'support': 1242905}, 'weighted avg': {'precision': 0.3269056481901288, 'recall': 0.324110853202779, 'f1-score': 0.3196290686113847, 'support': 1242905}}
[[112316 133688 198511]
 [ 86555  97032 176759]
 [110279 134274 193491]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1239811
{'0': {'precision': 0.3281576123009217, 'recall': 0.342775054926483, 'f1-score': 0.3353071003259609, 'support': 177510}, '1': {'precision': 0.33072232645403377, 'recall': 0.3616227120421235, 'f1-score': 0.34548295423612546, 'support': 175484}, '2': {'precision': 0.32956337233069244, 'recall': 0.2846717783158461, 'f1-score': 0.30547711628158747, 'support': 178416}, 'accuracy': 0.32949135319245026, 'macro avg': {'precision': 0.329481103695216, 'recall': 0.3296898484281509, 'f1-score': 0.32875572361455796, 'support': 531410}, 'weighted avg': {'precision': 0.3294765117945637, 'recall': 0.32949135319245026, 'f1-score': 0.32865226340966347, 'support': 531410}}
[[60846 63500 53164]
 [61866 63459 50159]
 [62705 64921 50790]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129426
{'0': {'precision': 0.2811641836227215, 'recall': 0.27068154377784254, 'f1-score': 0.27582330169167946, 'support': 48038}, '1': {'precision': 0.3663156858886046, 'recall': 0.27173020420825955, 'f1-score': 0.31201215359631196, 'support': 54797}, '2': {'precision': 0.34450839706694, 'recall': 0.46017904160084255, 'f1-score': 0.394030119938678, 'support': 47475}, 'accuracy': 0.33091610671279353, 'macro avg': {'precision': 0.33066275552608865, 'recall': 0.3341969298623149, 'f1-score': 0.32728852507555645, 'support': 150310}, 'weighted avg': {'precision': 0.332214103141901, 'recall': 0.33091610671279353, 'f1-score': 0.3263516046262441, 'support': 150310}}
[[13003 13031 22004]
 [20343 14890 19564]
 [12901 12727 21847]]
training model: results/AAL/W2/deepLOB_L2/h1000
Epoch 1/50
2076/2076 - 85s - loss: 3.1875 - accuracy1000: 0.4361 - val_loss: 3.4786 - val_accuracy1000: 0.3237 - 85s/epoch - 41ms/step
Epoch 2/50
2076/2076 - 81s - loss: 3.1420 - accuracy1000: 0.4554 - val_loss: 3.3487 - val_accuracy1000: 0.3566 - 81s/epoch - 39ms/step
Epoch 3/50
2076/2076 - 81s - loss: 3.1187 - accuracy1000: 0.4623 - val_loss: 3.3714 - val_accuracy1000: 0.3360 - 81s/epoch - 39ms/step
Epoch 4/50
2076/2076 - 81s - loss: 3.0999 - accuracy1000: 0.4691 - val_loss: 3.4570 - val_accuracy1000: 0.3215 - 81s/epoch - 39ms/step
Epoch 5/50
2076/2076 - 82s - loss: 3.0856 - accuracy1000: 0.4761 - val_loss: 3.4859 - val_accuracy1000: 0.3238 - 82s/epoch - 39ms/step
Epoch 6/50
2076/2076 - 81s - loss: 3.0759 - accuracy1000: 0.4791 - val_loss: 3.5504 - val_accuracy1000: 0.3056 - 81s/epoch - 39ms/step
Epoch 7/50
2076/2076 - 81s - loss: 3.0662 - accuracy1000: 0.4828 - val_loss: 3.5420 - val_accuracy1000: 0.3007 - 81s/epoch - 39ms/step
Epoch 8/50
2076/2076 - 81s - loss: 3.0563 - accuracy1000: 0.4855 - val_loss: 3.5450 - val_accuracy1000: 0.3131 - 81s/epoch - 39ms/step
Epoch 9/50
2076/2076 - 82s - loss: 3.0522 - accuracy1000: 0.4880 - val_loss: 3.5889 - val_accuracy1000: 0.3146 - 82s/epoch - 40ms/step
Epoch 10/50
2076/2076 - 82s - loss: 3.0443 - accuracy1000: 0.4910 - val_loss: 3.5680 - val_accuracy1000: 0.3097 - 82s/epoch - 39ms/step
Epoch 11/50
2076/2076 - 82s - loss: 3.0357 - accuracy1000: 0.4930 - val_loss: 3.5427 - val_accuracy1000: 0.3105 - 82s/epoch - 39ms/step
Epoch 12/50
2076/2076 - 81s - loss: 3.0341 - accuracy1000: 0.4933 - val_loss: 3.5894 - val_accuracy1000: 0.2939 - 81s/epoch - 39ms/step
testing model: results/AAL/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1194898
{'0': {'precision': 0.3798016595830804, 'recall': 0.022786826722490303, 'f1-score': 0.04299414861688332, 'support': 411773}, '1': {'precision': 0.34222719602804497, 'recall': 0.6448713131692655, 'f1-score': 0.4471539552507356, 'support': 425840}, '2': {'precision': 0.33002063621101846, 'recall': 0.33855590537192937, 'f1-score': 0.334233788757542, 'support': 405292}, 'accuracy': 0.3388907438621616, 'macro avg': {'precision': 0.35068316394071464, 'recall': 0.33540468175456173, 'f1-score': 0.274793964208387, 'support': 1242905}, 'weighted avg': {'precision': 0.35069520326921405, 'recall': 0.3388907438621616, 'f1-score': 0.27643476418190843, 'support': 1242905}}
[[  9383 267586 134804]
 [  7472 274612 143756]
 [  7850 260228 137214]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1687616
{'0': {'precision': 0.3041797479030973, 'recall': 0.2211453294269946, 'f1-score': 0.2561002071210179, 'support': 176124}, '1': {'precision': 0.32574968269904714, 'recall': 0.588085086979321, 'f1-score': 0.41926294958328086, 'support': 175444}, '2': {'precision': 0.3456077571280157, 'recall': 0.1664794653084374, 'f1-score': 0.2247140412501126, 'support': 179842}, 'accuracy': 0.3237895410323479, 'macro avg': {'precision': 0.3251790625767201, 'recall': 0.32523662723825103, 'f1-score': 0.3000257326514705, 'support': 531410}, 'weighted avg': {'precision': 0.3253212613773797, 'recall': 0.3237895410323479, 'f1-score': 0.2993462381441336, 'support': 531410}}
[[ 38949 104675  32500]
 [ 48078 103176  24190]
 [ 41019 108883  29940]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1160433
{'0': {'precision': 0.2730009843089572, 'recall': 0.09996395785188797, 'f1-score': 0.14634222042893943, 'support': 47167}, '1': {'precision': 0.3807110868148273, 'recall': 0.6495901271771691, 'f1-score': 0.4800657515360805, 'support': 55749}, '2': {'precision': 0.34040140306458844, 'recall': 0.2723340507237203, 'f1-score': 0.30258700519276527, 'support': 47394}, 'accuracy': 0.35816645599095204, 'macro avg': {'precision': 0.331371158062791, 'recall': 0.3406293785842591, 'f1-score': 0.30966499238592843, 'support': 150310}, 'weighted avg': {'precision': 0.3342018754745758, 'recall': 0.35816645599095204, 'f1-score': 0.3193833917734193, 'support': 150310}}
[[ 4715 29291 13161]
 [ 7686 36214 11849]
 [ 4870 29617 12907]]
training model: results/AAL/W2/deepOF_L2/h10
Epoch 1/50
2076/2076 - 48s - loss: 2.7169 - accuracy10: 0.5258 - val_loss: 2.6866 - val_accuracy10: 0.7303 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 45s - loss: 2.3661 - accuracy10: 0.6183 - val_loss: 2.5910 - val_accuracy10: 0.7170 - 45s/epoch - 22ms/step
Epoch 3/50
2076/2076 - 45s - loss: 2.2890 - accuracy10: 0.6332 - val_loss: 2.5243 - val_accuracy10: 0.7211 - 45s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 2.2512 - accuracy10: 0.6380 - val_loss: 2.5438 - val_accuracy10: 0.7200 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.2267 - accuracy10: 0.6424 - val_loss: 2.5686 - val_accuracy10: 0.7187 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 2.2081 - accuracy10: 0.6449 - val_loss: 2.5198 - val_accuracy10: 0.7278 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 45s - loss: 2.1969 - accuracy10: 0.6465 - val_loss: 2.5330 - val_accuracy10: 0.7301 - 45s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.1843 - accuracy10: 0.6484 - val_loss: 2.5525 - val_accuracy10: 0.7314 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.1733 - accuracy10: 0.6498 - val_loss: 2.5536 - val_accuracy10: 0.7319 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 2.1641 - accuracy10: 0.6502 - val_loss: 2.5363 - val_accuracy10: 0.7309 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.1567 - accuracy10: 0.6514 - val_loss: 2.5519 - val_accuracy10: 0.7302 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 45s - loss: 2.1502 - accuracy10: 0.6530 - val_loss: 2.5560 - val_accuracy10: 0.7350 - 45s/epoch - 22ms/step
Epoch 13/50
2076/2076 - 45s - loss: 2.1411 - accuracy10: 0.6540 - val_loss: 2.5564 - val_accuracy10: 0.7360 - 45s/epoch - 22ms/step
Epoch 14/50
2076/2076 - 44s - loss: 2.1345 - accuracy10: 0.6550 - val_loss: 2.5743 - val_accuracy10: 0.7360 - 44s/epoch - 21ms/step
Epoch 15/50
2076/2076 - 44s - loss: 2.1301 - accuracy10: 0.6554 - val_loss: 2.5792 - val_accuracy10: 0.7385 - 44s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 44s - loss: 2.1245 - accuracy10: 0.6555 - val_loss: 2.5680 - val_accuracy10: 0.7340 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h10
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8954035
{'0': {'precision': 0.44707185782870956, 'recall': 0.4865796471854002, 'f1-score': 0.4659898595579887, 'support': 246305}, '1': {'precision': 0.8107336479581887, 'recall': 0.6820016195012094, 'f1-score': 0.7408167716606151, 'support': 761963}, '2': {'precision': 0.40243938967333026, 'recall': 0.572624364963006, 'f1-score': 0.47268006599986634, 'support': 234632}, 'accuracy': 0.6226269209107732, 'macro avg': {'precision': 0.5534149651534095, 'recall': 0.5804018772165386, 'f1-score': 0.5598288990728234, 'support': 1242900}, 'weighted avg': {'precision': 0.6615900196471949, 'recall': 0.6226269209107732, 'f1-score': 0.6357361584913898, 'support': 1242900}}
[[119847  65945  60513]
 [103318 519660 138985]
 [ 44906  55370 134356]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6850551
{'0': {'precision': 0.46729676961306355, 'recall': 0.43456073506554244, 'f1-score': 0.4503346185918224, 'support': 72701}, '1': {'precision': 0.8651672753076377, 'recall': 0.7807876836249379, 'f1-score': 0.820814626997604, 'support': 384139}, '2': {'precision': 0.3988286319240489, 'recall': 0.6264449510527021, 'f1-score': 0.487370760258323, 'support': 74570}, 'accuracy': 0.7117630454827722, 'macro avg': {'precision': 0.57709755894825, 'recall': 0.6139311232477275, 'f1-score': 0.5861733352825832, 'support': 531410}, 'weighted avg': {'precision': 0.7452966363064607, 'recall': 0.7117630454827722, 'f1-score': 0.7233396524320953, 'support': 531410}}
[[ 31593  26344  14764]
 [ 28558 299931  55650]
 [  7457  20399  46714]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65734553
{'0': {'precision': 0.46628865979381445, 'recall': 0.44618723488211504, 'f1-score': 0.45601653475828, 'support': 20274}, '1': {'precision': 0.863782802249297, 'recall': 0.805232981434292, 'f1-score': 0.833480914879988, 'support': 109880}, '2': {'precision': 0.4137228737973172, 'recall': 0.5845405834490971, 'f1-score': 0.4845170045647078, 'support': 20156}, 'accuracy': 0.7272104317743331, 'macro avg': {'precision': 0.5812647786134763, 'recall': 0.6119869332551681, 'f1-score': 0.591338151400992, 'support': 150310}, 'weighted avg': {'precision': 0.7498169705546622, 'recall': 0.7272104317743331, 'f1-score': 0.7357733144615042, 'support': 150310}}
[[ 9046  7504  3724]
 [ 8429 88479 12972]
 [ 1925  6449 11782]]
training model: results/AAL/W2/deepOF_L2/h20
Epoch 1/50
2076/2076 - 48s - loss: 2.7867 - accuracy20: 0.5201 - val_loss: 2.8443 - val_accuracy20: 0.6752 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 2.4695 - accuracy20: 0.6033 - val_loss: 2.8163 - val_accuracy20: 0.6767 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 2.3973 - accuracy20: 0.6181 - val_loss: 2.7359 - val_accuracy20: 0.6803 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 45s - loss: 2.3647 - accuracy20: 0.6245 - val_loss: 2.7036 - val_accuracy20: 0.6783 - 45s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.3456 - accuracy20: 0.6272 - val_loss: 2.7667 - val_accuracy20: 0.6710 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 45s - loss: 2.3289 - accuracy20: 0.6299 - val_loss: 2.7001 - val_accuracy20: 0.6824 - 45s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 45s - loss: 2.3175 - accuracy20: 0.6317 - val_loss: 2.7025 - val_accuracy20: 0.6870 - 45s/epoch - 22ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.3061 - accuracy20: 0.6331 - val_loss: 2.7381 - val_accuracy20: 0.6784 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.2978 - accuracy20: 0.6336 - val_loss: 2.7127 - val_accuracy20: 0.6798 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 2.2914 - accuracy20: 0.6350 - val_loss: 2.6671 - val_accuracy20: 0.6852 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.2828 - accuracy20: 0.6357 - val_loss: 2.6808 - val_accuracy20: 0.6930 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 2.2767 - accuracy20: 0.6369 - val_loss: 2.6824 - val_accuracy20: 0.6912 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 44s - loss: 2.2701 - accuracy20: 0.6377 - val_loss: 2.6713 - val_accuracy20: 0.6938 - 44s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 44s - loss: 2.2653 - accuracy20: 0.6385 - val_loss: 2.6531 - val_accuracy20: 0.6908 - 44s/epoch - 21ms/step
Epoch 15/50
2076/2076 - 44s - loss: 2.2594 - accuracy20: 0.6397 - val_loss: 2.6746 - val_accuracy20: 0.6937 - 44s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 44s - loss: 2.2555 - accuracy20: 0.6403 - val_loss: 2.6831 - val_accuracy20: 0.6925 - 44s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 44s - loss: 2.2481 - accuracy20: 0.6413 - val_loss: 2.6631 - val_accuracy20: 0.6917 - 44s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 45s - loss: 2.2426 - accuracy20: 0.6416 - val_loss: 2.6666 - val_accuracy20: 0.6878 - 45s/epoch - 21ms/step
Epoch 19/50
2076/2076 - 44s - loss: 2.2389 - accuracy20: 0.6420 - val_loss: 2.6591 - val_accuracy20: 0.6927 - 44s/epoch - 21ms/step
Epoch 20/50
2076/2076 - 44s - loss: 2.2341 - accuracy20: 0.6423 - val_loss: 2.6449 - val_accuracy20: 0.6879 - 44s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 44s - loss: 2.2291 - accuracy20: 0.6429 - val_loss: 2.6544 - val_accuracy20: 0.6894 - 44s/epoch - 21ms/step
Epoch 22/50
2076/2076 - 45s - loss: 2.2239 - accuracy20: 0.6437 - val_loss: 2.6786 - val_accuracy20: 0.6929 - 45s/epoch - 21ms/step
Epoch 23/50
2076/2076 - 44s - loss: 2.2197 - accuracy20: 0.6440 - val_loss: 2.6545 - val_accuracy20: 0.6839 - 44s/epoch - 21ms/step
Epoch 24/50
2076/2076 - 45s - loss: 2.2152 - accuracy20: 0.6442 - val_loss: 2.6726 - val_accuracy20: 0.6842 - 45s/epoch - 22ms/step
Epoch 25/50
2076/2076 - 45s - loss: 2.2114 - accuracy20: 0.6446 - val_loss: 2.6745 - val_accuracy20: 0.6830 - 45s/epoch - 22ms/step
Epoch 26/50
2076/2076 - 44s - loss: 2.2079 - accuracy20: 0.6447 - val_loss: 2.6765 - val_accuracy20: 0.6855 - 44s/epoch - 21ms/step
Epoch 27/50
2076/2076 - 44s - loss: 2.2031 - accuracy20: 0.6459 - val_loss: 2.6980 - val_accuracy20: 0.6881 - 44s/epoch - 21ms/step
Epoch 28/50
2076/2076 - 44s - loss: 2.1976 - accuracy20: 0.6463 - val_loss: 2.6868 - val_accuracy20: 0.6863 - 44s/epoch - 21ms/step
Epoch 29/50
2076/2076 - 44s - loss: 2.1933 - accuracy20: 0.6466 - val_loss: 2.6812 - val_accuracy20: 0.6837 - 44s/epoch - 21ms/step
Epoch 30/50
2076/2076 - 44s - loss: 2.1886 - accuracy20: 0.6468 - val_loss: 2.6655 - val_accuracy20: 0.6757 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h20
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9391383
{'0': {'precision': 0.4916821239169338, 'recall': 0.44035903887853994, 'f1-score': 0.46460752199488936, 'support': 307599}, '1': {'precision': 0.7264185079746411, 'recall': 0.6897546603242538, 'f1-score': 0.7076119819769795, 'support': 637402}, '2': {'precision': 0.4576617022569013, 'recall': 0.5564134152850463, 'f1-score': 0.5022292853712521, 'support': 297899}, 'accuracy': 0.596073698608094, 'macro avg': {'precision': 0.5585874447161587, 'recall': 0.56217570482928, 'f1-score': 0.558149596447707, 'support': 1242900}, 'weighted avg': {'precision': 0.6039090054673794, 'recall': 0.596073698608094, 'f1-score': 0.5982457989999255, 'support': 1242900}}
[[135454  89894  82251]
 [ 83579 439651 114172]
 [ 56458  75686 165755]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75625354
{'0': {'precision': 0.523208260914017, 'recall': 0.4255142236496108, 'f1-score': 0.46933125454972746, 'support': 96213}, '1': {'precision': 0.8007078434328209, 'recall': 0.7566286726630127, 'f1-score': 0.778044445122556, 'support': 336983}, '2': {'precision': 0.44916499665998666, 'recall': 0.6161647015700409, 'f1-score': 0.5195755202967237, 'support': 98214}, 'accuracy': 0.6707194068609924, 'macro avg': {'precision': 0.5910270336689415, 'recall': 0.5994358659608882, 'f1-score': 0.588983739989669, 'support': 531410}, 'weighted avg': {'precision': 0.6854945495809385, 'recall': 0.6707194068609924, 'f1-score': 0.6743815686478418, 'support': 531410}}
[[ 40940  35549  19724]
 [ 27522 254971  54490]
 [  9786  27912  60516]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72208714
{'0': {'precision': 0.5281170122124397, 'recall': 0.41326814090454494, 'f1-score': 0.4636868025684185, 'support': 26997}, '1': {'precision': 0.7898106052883733, 'recall': 0.8028973192543237, 'f1-score': 0.7963001978366436, 'support': 96503}, '2': {'precision': 0.475516376037578, 'recall': 0.5512868332711675, 'f1-score': 0.510605955917916, 'support': 26810}, 'accuracy': 0.6880380546869802, 'macro avg': {'precision': 0.597814664512797, 'recall': 0.5891507644766788, 'f1-score': 0.5901976521076594, 'support': 150310}, 'weighted avg': {'precision': 0.6867491308789209, 'recall': 0.6880380546869802, 'f1-score': 0.6856021307892258, 'support': 150310}}
[[11157 10987  4853]
 [ 7572 77482 11449]
 [ 2397  9633 14780]]
training model: results/AAL/W2/deepOF_L2/h30
Epoch 1/50
2076/2076 - 48s - loss: 2.8714 - accuracy30: 0.5029 - val_loss: 2.9752 - val_accuracy30: 0.6319 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 2.5783 - accuracy30: 0.5806 - val_loss: 2.9506 - val_accuracy30: 0.6378 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 2.5141 - accuracy30: 0.5941 - val_loss: 2.9372 - val_accuracy30: 0.6307 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 2.4809 - accuracy30: 0.6016 - val_loss: 2.8746 - val_accuracy30: 0.6379 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.4620 - accuracy30: 0.6048 - val_loss: 2.8852 - val_accuracy30: 0.6358 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 45s - loss: 2.4459 - accuracy30: 0.6083 - val_loss: 2.8552 - val_accuracy30: 0.6355 - 45s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 44s - loss: 2.4341 - accuracy30: 0.6096 - val_loss: 2.8199 - val_accuracy30: 0.6436 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.4227 - accuracy30: 0.6124 - val_loss: 2.8210 - val_accuracy30: 0.6444 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.4143 - accuracy30: 0.6131 - val_loss: 2.8450 - val_accuracy30: 0.6448 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 2.4052 - accuracy30: 0.6149 - val_loss: 2.8415 - val_accuracy30: 0.6508 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.3980 - accuracy30: 0.6161 - val_loss: 2.8373 - val_accuracy30: 0.6502 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 45s - loss: 2.3922 - accuracy30: 0.6170 - val_loss: 2.8087 - val_accuracy30: 0.6493 - 45s/epoch - 22ms/step
Epoch 13/50
2076/2076 - 44s - loss: 2.3864 - accuracy30: 0.6185 - val_loss: 2.8162 - val_accuracy30: 0.6499 - 44s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 44s - loss: 2.3806 - accuracy30: 0.6187 - val_loss: 2.8315 - val_accuracy30: 0.6532 - 44s/epoch - 21ms/step
Epoch 15/50
2076/2076 - 44s - loss: 2.3760 - accuracy30: 0.6191 - val_loss: 2.8140 - val_accuracy30: 0.6500 - 44s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 44s - loss: 2.3708 - accuracy30: 0.6201 - val_loss: 2.8002 - val_accuracy30: 0.6498 - 44s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 44s - loss: 2.3647 - accuracy30: 0.6209 - val_loss: 2.8058 - val_accuracy30: 0.6487 - 44s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 45s - loss: 2.3594 - accuracy30: 0.6226 - val_loss: 2.8138 - val_accuracy30: 0.6509 - 45s/epoch - 22ms/step
Epoch 19/50
2076/2076 - 44s - loss: 2.3566 - accuracy30: 0.6227 - val_loss: 2.8296 - val_accuracy30: 0.6510 - 44s/epoch - 21ms/step
Epoch 20/50
2076/2076 - 45s - loss: 2.3515 - accuracy30: 0.6234 - val_loss: 2.8104 - val_accuracy30: 0.6513 - 45s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 44s - loss: 2.3480 - accuracy30: 0.6228 - val_loss: 2.8220 - val_accuracy30: 0.6543 - 44s/epoch - 21ms/step
Epoch 22/50
2076/2076 - 44s - loss: 2.3431 - accuracy30: 0.6238 - val_loss: 2.8311 - val_accuracy30: 0.6525 - 44s/epoch - 21ms/step
Epoch 23/50
2076/2076 - 44s - loss: 2.3386 - accuracy30: 0.6245 - val_loss: 2.8128 - val_accuracy30: 0.6509 - 44s/epoch - 21ms/step
Epoch 24/50
2076/2076 - 44s - loss: 2.3357 - accuracy30: 0.6254 - val_loss: 2.8261 - val_accuracy30: 0.6494 - 44s/epoch - 21ms/step
Epoch 25/50
2076/2076 - 44s - loss: 2.3312 - accuracy30: 0.6256 - val_loss: 2.8151 - val_accuracy30: 0.6480 - 44s/epoch - 21ms/step
Epoch 26/50
2076/2076 - 44s - loss: 2.3269 - accuracy30: 0.6259 - val_loss: 2.8136 - val_accuracy30: 0.6494 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h30
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97689307
{'0': {'precision': 0.5288939206530191, 'recall': 0.3762895611120825, 'f1-score': 0.4397280005359595, 'support': 348859}, '1': {'precision': 0.6404545804989034, 'recall': 0.7032960698627028, 'f1-score': 0.6704059109020462, 'support': 555146}, '2': {'precision': 0.47819944842916573, 'recall': 0.543371840835657, 'f1-score': 0.508706768308938, 'support': 338895}, 'accuracy': 0.5679057044009976, 'macro avg': {'precision': 0.5491826498603628, 'recall': 0.540985823936814, 'f1-score': 0.5396135599156479, 'support': 1242900}, 'weighted avg': {'precision': 0.5649003177135231, 'recall': 0.5679057044009976, 'f1-score': 0.5615692417721934, 'support': 1242900}}
[[131272 121787  95800]
 [ 59578 390432 105136]
 [ 57351  97398 184146]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8153628
{'0': {'precision': 0.5687346453929429, 'recall': 0.3731919680422324, 'f1-score': 0.4506661104604211, 'support': 112899}, '1': {'precision': 0.7313240761335833, 'recall': 0.7587610852866515, 'f1-score': 0.7447899812309884, 'support': 303330}, '2': {'precision': 0.4715463686210717, 'recall': 0.5838723400560857, 'f1-score': 0.5217320470599188, 'support': 115181}, 'accuracy': 0.6389398016597354, 'macro avg': {'precision': 0.5905350300491993, 'recall': 0.5719417977949899, 'f1-score': 0.5723960462504428, 'support': 531410}, 'weighted avg': {'precision': 0.6404758793172152, 'recall': 0.6389398016597354, 'f1-score': 0.6339559231555209, 'support': 531410}}
[[ 42133  47042  23724]
 [ 21532 230155  51643]
 [ 10417  37513  67251]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80449194
{'0': {'precision': 0.5759047229605397, 'recall': 0.3526557951735579, 'f1-score': 0.4374429755595675, 'support': 31949}, '1': {'precision': 0.7170136573052731, 'recall': 0.8064490069129476, 'f1-score': 0.7591061670993884, 'support': 86649}, '2': {'precision': 0.49553906695905553, 'recall': 0.5201816347124117, 'f1-score': 0.5075614221319672, 'support': 31712}, 'accuracy': 0.6495974985030936, 'macro avg': {'precision': 0.5961524824082894, 'recall': 0.5597621455996391, 'f1-score': 0.5680368549303076, 'support': 150310}, 'weighted avg': {'precision': 0.6402942670289167, 'recall': 0.6495974985030936, 'f1-score': 0.637665116877097, 'support': 150310}}
[[11267 15066  5616]
 [ 5594 69878 11177]
 [ 2703 12513 16496]]
training model: results/AAL/W2/deepOF_L2/h50
Epoch 1/50
2076/2076 - 47s - loss: 2.9908 - accuracy50: 0.4823 - val_loss: 3.1965 - val_accuracy50: 0.5496 - 47s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 2.7592 - accuracy50: 0.5449 - val_loss: 3.2181 - val_accuracy50: 0.5625 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 2.7019 - accuracy50: 0.5574 - val_loss: 3.1902 - val_accuracy50: 0.5586 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 2.6748 - accuracy50: 0.5627 - val_loss: 3.1922 - val_accuracy50: 0.5657 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.6585 - accuracy50: 0.5659 - val_loss: 3.1759 - val_accuracy50: 0.5645 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 2.6465 - accuracy50: 0.5688 - val_loss: 3.1716 - val_accuracy50: 0.5676 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 44s - loss: 2.6348 - accuracy50: 0.5710 - val_loss: 3.1635 - val_accuracy50: 0.5673 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.6249 - accuracy50: 0.5730 - val_loss: 3.1482 - val_accuracy50: 0.5686 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.6161 - accuracy50: 0.5747 - val_loss: 3.1488 - val_accuracy50: 0.5709 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 2.6103 - accuracy50: 0.5763 - val_loss: 3.1350 - val_accuracy50: 0.5711 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.6027 - accuracy50: 0.5776 - val_loss: 3.1364 - val_accuracy50: 0.5713 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 2.5973 - accuracy50: 0.5794 - val_loss: 3.1418 - val_accuracy50: 0.5691 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 45s - loss: 2.5913 - accuracy50: 0.5800 - val_loss: 3.1291 - val_accuracy50: 0.5727 - 45s/epoch - 22ms/step
Epoch 14/50
2076/2076 - 44s - loss: 2.5856 - accuracy50: 0.5813 - val_loss: 3.1359 - val_accuracy50: 0.5703 - 44s/epoch - 21ms/step
Epoch 15/50
2076/2076 - 45s - loss: 2.5808 - accuracy50: 0.5823 - val_loss: 3.1245 - val_accuracy50: 0.5729 - 45s/epoch - 22ms/step
Epoch 16/50
2076/2076 - 45s - loss: 2.5755 - accuracy50: 0.5838 - val_loss: 3.1157 - val_accuracy50: 0.5737 - 45s/epoch - 22ms/step
Epoch 17/50
2076/2076 - 44s - loss: 2.5703 - accuracy50: 0.5840 - val_loss: 3.1262 - val_accuracy50: 0.5739 - 44s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 44s - loss: 2.5657 - accuracy50: 0.5848 - val_loss: 3.1358 - val_accuracy50: 0.5720 - 44s/epoch - 21ms/step
Epoch 19/50
2076/2076 - 44s - loss: 2.5615 - accuracy50: 0.5855 - val_loss: 3.1160 - val_accuracy50: 0.5755 - 44s/epoch - 21ms/step
Epoch 20/50
2076/2076 - 44s - loss: 2.5547 - accuracy50: 0.5871 - val_loss: 3.1779 - val_accuracy50: 0.5691 - 44s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 45s - loss: 2.5495 - accuracy50: 0.5879 - val_loss: 3.1651 - val_accuracy50: 0.5700 - 45s/epoch - 22ms/step
Epoch 22/50
2076/2076 - 44s - loss: 2.5461 - accuracy50: 0.5885 - val_loss: 3.1350 - val_accuracy50: 0.5735 - 44s/epoch - 21ms/step
Epoch 23/50
2076/2076 - 44s - loss: 2.5432 - accuracy50: 0.5886 - val_loss: 3.1482 - val_accuracy50: 0.5736 - 44s/epoch - 21ms/step
Epoch 24/50
2076/2076 - 44s - loss: 2.5368 - accuracy50: 0.5900 - val_loss: 3.1736 - val_accuracy50: 0.5748 - 44s/epoch - 21ms/step
Epoch 25/50
2076/2076 - 43s - loss: 2.5326 - accuracy50: 0.5912 - val_loss: 3.1936 - val_accuracy50: 0.5741 - 43s/epoch - 21ms/step
Epoch 26/50
2076/2076 - 44s - loss: 2.5266 - accuracy50: 0.5918 - val_loss: 3.1993 - val_accuracy50: 0.5704 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h50
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0622939
{'0': {'precision': 0.5439505759678727, 'recall': 0.30474200455895556, 'f1-score': 0.3906351786380627, 'support': 405356}, '1': {'precision': 0.5006588747565028, 'recall': 0.7460698341657623, 'f1-score': 0.5992105275029662, 'support': 445083}, '2': {'precision': 0.5068075064104018, 'recall': 0.4552707147971391, 'f1-score': 0.4796587442098326, 'support': 392461}, 'accuracy': 0.5103129777134122, 'macro avg': {'precision': 0.5171389857115924, 'recall': 0.5020275178406189, 'f1-score': 0.48983481678362045, 'support': 1242900}, 'weighted avg': {'precision': 0.5167194178120639, 'recall': 0.5103129777134122, 'f1-score': 0.4934363851443788, 'support': 1242900}}
[[123529 182972  98855]
 [ 37999 332063  75021]
 [ 65568 148217 178676]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9187628
{'0': {'precision': 0.6198405363492536, 'recall': 0.28617921458016926, 'f1-score': 0.3915708850174906, 'support': 138270}, '1': {'precision': 0.6017836477525303, 'recall': 0.7785012416382496, 'f1-score': 0.6788298858791656, 'support': 252489}, '2': {'precision': 0.49576051711048197, 'recall': 0.49676859745042695, 'f1-score': 0.4962640453428413, 'support': 140651}, 'accuracy': 0.5758341017293616, 'macro avg': {'precision': 0.5724615670707552, 'recall': 0.5204830178896153, 'f1-score': 0.5222216054131658, 'support': 531410}, 'weighted avg': {'precision': 0.5784202685130244, 'recall': 0.5758341017293616, 'f1-score': 0.5557660178932068, 'support': 531410}}
[[ 39570  70912  27788]
 [ 12648 196563  43278]
 [ 11621  59159  69871]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9313255
{'0': {'precision': 0.6272947912128944, 'recall': 0.25554569653948533, 'f1-score': 0.3631516374247937, 'support': 39445}, '1': {'precision': 0.5816686366256069, 'recall': 0.8291582538466894, 'f1-score': 0.6837059235529835, 'support': 71815}, '2': {'precision': 0.5213366802635707, 'recall': 0.42548015364916775, 'f1-score': 0.46855611957134796, 'support': 39050}, 'accuracy': 0.5737542412347815, 'macro avg': {'precision': 0.5767667027006906, 'recall': 0.5033947013451142, 'f1-score': 0.5051378935163751, 'support': 150310}, 'weighted avg': {'precision': 0.5779680230387401, 'recall': 0.5737542412347815, 'f1-score': 0.5436895330147006, 'support': 150310}}
[[10080 23450  5915]
 [ 2929 59546  9340]
 [ 3060 19375 16615]]
training model: results/AAL/W2/deepOF_L2/h100
Epoch 1/50
2076/2076 - 48s - loss: 3.1411 - accuracy100: 0.4414 - val_loss: 3.3919 - val_accuracy100: 0.4079 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 45s - loss: 3.0064 - accuracy100: 0.4822 - val_loss: 3.3844 - val_accuracy100: 0.4168 - 45s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 45s - loss: 2.9628 - accuracy100: 0.4921 - val_loss: 3.3937 - val_accuracy100: 0.4193 - 45s/epoch - 22ms/step
Epoch 4/50
2076/2076 - 44s - loss: 2.9422 - accuracy100: 0.4961 - val_loss: 3.3766 - val_accuracy100: 0.4243 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.9303 - accuracy100: 0.4988 - val_loss: 3.4213 - val_accuracy100: 0.4218 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 2.9209 - accuracy100: 0.5005 - val_loss: 3.3976 - val_accuracy100: 0.4240 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 44s - loss: 2.9141 - accuracy100: 0.5024 - val_loss: 3.4165 - val_accuracy100: 0.4234 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.9066 - accuracy100: 0.5040 - val_loss: 3.4438 - val_accuracy100: 0.4243 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.9025 - accuracy100: 0.5050 - val_loss: 3.4331 - val_accuracy100: 0.4244 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 2.8968 - accuracy100: 0.5067 - val_loss: 3.4541 - val_accuracy100: 0.4269 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.8929 - accuracy100: 0.5070 - val_loss: 3.4406 - val_accuracy100: 0.4267 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 2.8883 - accuracy100: 0.5088 - val_loss: 3.4631 - val_accuracy100: 0.4261 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 44s - loss: 2.8830 - accuracy100: 0.5101 - val_loss: 3.4668 - val_accuracy100: 0.4261 - 44s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 44s - loss: 2.8782 - accuracy100: 0.5114 - val_loss: 3.4572 - val_accuracy100: 0.4282 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h100
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.168694
{'0': {'precision': 0.5358524567889758, 'recall': 0.15647343802205146, 'f1-score': 0.24221736270378863, 'support': 478880}, '1': {'precision': 0.30628580131486544, 'recall': 0.8316037859693342, 'f1-score': 0.4476856714543031, 'support': 304704}, '2': {'precision': 0.5200323476722006, 'recall': 0.31220554041226517, 'f1-score': 0.390169643707402, 'support': 459316}, 'accuracy': 0.3795365677045619, 'macro avg': {'precision': 0.45405686859201394, 'recall': 0.43342758813455023, 'f1-score': 0.36002422595516453, 'support': 1242900}, 'weighted avg': {'precision': 0.4737265356137694, 'recall': 0.3795365677045619, 'f1-score': 0.34726512636214607, 'support': 1242900}}
[[ 74932 311367  92581]
 [ 11539 253393  39772]
 [ 53366 262549 143401]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964799
{'0': {'precision': 0.6146209799167391, 'recall': 0.15332557290240117, 'f1-score': 0.24542623055634213, 'support': 175248}, '1': {'precision': 0.395899864471204, 'recall': 0.8519849140941472, 'f1-score': 0.5405959233017745, 'support': 178975}, '2': {'precision': 0.517750209686543, 'recall': 0.29961001653620184, 'f1-score': 0.379571072604488, 'support': 177187}, 'accuracy': 0.4374042641275098, 'macro avg': {'precision': 0.5094236846914953, 'recall': 0.43497350117758343, 'f1-score': 0.3885310754875349, 'support': 531410}, 'weighted avg': {'precision': 0.5086578764718614, 'recall': 0.4374042641275098, 'f1-score': 0.3895648765868997, 'support': 531410}}
[[ 26870 120762  27616]
 [  4660 152484  21831]
 [ 12188 111912  53087]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1223047
{'0': {'precision': 0.6201794136687321, 'recall': 0.1324563482657818, 'f1-score': 0.21829071792451293, 'support': 50628}, '1': {'precision': 0.38156946811688425, 'recall': 0.8699597379965146, 'f1-score': 0.5304711594247152, 'support': 49923}, '2': {'precision': 0.5289581304771178, 'recall': 0.2729355493478567, 'f1-score': 0.3600763581408914, 'support': 49759}, 'accuracy': 0.42391058479143107, 'macro avg': {'precision': 0.5102356707542447, 'recall': 0.425117211870051, 'f1-score': 0.3696127451633732, 'support': 150310}, 'weighted avg': {'precision': 0.5107309129560953, 'recall': 0.42391058479143107, 'f1-score': 0.36891340339149037, 'support': 150310}}
[[ 6706 37452  6470]
 [  868 43431  5624]
 [ 3239 32939 13581]]
training model: results/AAL/W2/deepOF_L2/h200
Epoch 1/50
2076/2076 - 47s - loss: 3.2610 - accuracy200: 0.3893 - val_loss: 3.3277 - val_accuracy200: 0.3534 - 47s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 3.2310 - accuracy200: 0.4060 - val_loss: 3.3124 - val_accuracy200: 0.3605 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 3.2127 - accuracy200: 0.4147 - val_loss: 3.3111 - val_accuracy200: 0.3653 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 3.2007 - accuracy200: 0.4209 - val_loss: 3.3201 - val_accuracy200: 0.3688 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 45s - loss: 3.1920 - accuracy200: 0.4242 - val_loss: 3.3282 - val_accuracy200: 0.3709 - 45s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 45s - loss: 3.1845 - accuracy200: 0.4275 - val_loss: 3.3412 - val_accuracy200: 0.3716 - 45s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 44s - loss: 3.1794 - accuracy200: 0.4293 - val_loss: 3.3451 - val_accuracy200: 0.3724 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 3.1751 - accuracy200: 0.4307 - val_loss: 3.3571 - val_accuracy200: 0.3734 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 3.1710 - accuracy200: 0.4325 - val_loss: 3.3689 - val_accuracy200: 0.3738 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 3.1671 - accuracy200: 0.4346 - val_loss: 3.3791 - val_accuracy200: 0.3738 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 3.1636 - accuracy200: 0.4357 - val_loss: 3.3983 - val_accuracy200: 0.3748 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 3.1595 - accuracy200: 0.4372 - val_loss: 3.4115 - val_accuracy200: 0.3741 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 44s - loss: 3.1558 - accuracy200: 0.4383 - val_loss: 3.4238 - val_accuracy200: 0.3744 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h200
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1225381
{'0': {'precision': 0.46409428675843584, 'recall': 0.03513856895474344, 'f1-score': 0.0653306724913669, 'support': 433683}, '1': {'precision': 0.30741883054020874, 'recall': 0.7549714320962904, 'f1-score': 0.43692500375583637, 'support': 389073}, '2': {'precision': 0.42294834677466875, 'recall': 0.25626213869530445, 'f1-score': 0.3191518688853087, 'support': 420144}, 'accuracy': 0.33522004988333737, 'macro avg': {'precision': 0.3981538213577711, 'recall': 0.34879071324877947, 'f1-score': 0.2738025150441707, 'support': 1242900}, 'weighted avg': {'precision': 0.40114038090459875, 'recall': 0.33522004988333737, 'f1-score': 0.26745375076459665, 'support': 1242900}}
[[ 15239 356924  61520]
 [  9958 293739  85376]
 [  7639 304838 107667]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104065
{'0': {'precision': 0.4855116762440396, 'recall': 0.04469607010000619, 'f1-score': 0.0818564574561833, 'support': 177689}, '1': {'precision': 0.33241222131743914, 'recall': 0.7794870346308118, 'f1-score': 0.4660692329518585, 'support': 177010}, '2': {'precision': 0.4391741852881749, 'recall': 0.24846217835901557, 'f1-score': 0.3173717404268392, 'support': 176711}, 'accuracy': 0.3572100637925519, 'macro avg': {'precision': 0.4190326942832179, 'recall': 0.3575484276966112, 'f1-score': 0.2884324769449604, 'support': 531410}, 'weighted avg': {'precision': 0.4191063039686603, 'recall': 0.3572100637925519, 'f1-score': 0.28815224518979204, 'support': 531410}}
[[  7942 147530  22217]
 [  5182 137977  33851]
 [  3234 129571  43906]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035227
{'0': {'precision': 0.45976394849785407, 'recall': 0.051929952129915774, 'f1-score': 0.09331954048020906, 'support': 49509}, '1': {'precision': 0.3429105926370407, 'recall': 0.7495274466689812, 'f1-score': 0.4705454985772234, 'support': 51846}, '2': {'precision': 0.4217366375740587, 'recall': 0.27045245633745274, 'f1-score': 0.3295622845337216, 'support': 48955}, 'accuracy': 0.3637216419399907, 'macro avg': {'precision': 0.4081370595696512, 'recall': 0.3573032850454499, 'f1-score': 0.297809107863718, 'support': 150310}, 'weighted avg': {'precision': 0.40707280290385417, 'recall': 0.3637216419399907, 'f1-score': 0.30037775722319027, 'support': 150310}}
[[ 2571 39827  7111]
 [ 1943 38860 11043]
 [ 1078 34637 13240]]
training model: results/AAL/W2/deepOF_L2/h300
Epoch 1/50
2076/2076 - 47s - loss: 3.2785 - accuracy300: 0.3774 - val_loss: 3.2789 - val_accuracy300: 0.3828 - 47s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 3.2537 - accuracy300: 0.3910 - val_loss: 3.2730 - val_accuracy300: 0.3898 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 45s - loss: 3.2418 - accuracy300: 0.3987 - val_loss: 3.2694 - val_accuracy300: 0.3931 - 45s/epoch - 22ms/step
Epoch 4/50
2076/2076 - 45s - loss: 3.2328 - accuracy300: 0.4040 - val_loss: 3.2705 - val_accuracy300: 0.3979 - 45s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 47s - loss: 3.2241 - accuracy300: 0.4088 - val_loss: 3.2667 - val_accuracy300: 0.3984 - 47s/epoch - 23ms/step
Epoch 6/50
2076/2076 - 46s - loss: 3.2184 - accuracy300: 0.4120 - val_loss: 3.2690 - val_accuracy300: 0.3988 - 46s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 46s - loss: 3.2126 - accuracy300: 0.4150 - val_loss: 3.2715 - val_accuracy300: 0.3990 - 46s/epoch - 22ms/step
Epoch 8/50
2076/2076 - 45s - loss: 3.2090 - accuracy300: 0.4174 - val_loss: 3.2738 - val_accuracy300: 0.3973 - 45s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 3.2052 - accuracy300: 0.4184 - val_loss: 3.2821 - val_accuracy300: 0.3988 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 3.2021 - accuracy300: 0.4208 - val_loss: 3.2799 - val_accuracy300: 0.3995 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 3.1979 - accuracy300: 0.4226 - val_loss: 3.2833 - val_accuracy300: 0.3982 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 3.1950 - accuracy300: 0.4243 - val_loss: 3.2858 - val_accuracy300: 0.3996 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 45s - loss: 3.1918 - accuracy300: 0.4258 - val_loss: 3.2908 - val_accuracy300: 0.3974 - 45s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 44s - loss: 3.1873 - accuracy300: 0.4279 - val_loss: 3.3029 - val_accuracy300: 0.3948 - 44s/epoch - 21ms/step
Epoch 15/50
2076/2076 - 45s - loss: 3.1838 - accuracy300: 0.4310 - val_loss: 3.3082 - val_accuracy300: 0.3940 - 45s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h300
Evaluating performance on  test set...
4856/4856 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004565
{'0': {'precision': 0.41742684641890543, 'recall': 0.4417953134063918, 'f1-score': 0.42926552191200246, 'support': 444758}, '1': {'precision': 0.32782097299485635, 'recall': 0.25011996889082555, 'f1-score': 0.28374723306400523, 'support': 362594}, '2': {'precision': 0.3986886688313654, 'recall': 0.45359179700056024, 'f1-score': 0.4243718282630293, 'support': 435548}, 'accuracy': 0.390011263979403, 'macro avg': {'precision': 0.3813121627483757, 'recall': 0.3818356930992592, 'f1-score': 0.3791281944130123, 'support': 1242900}, 'weighted avg': {'precision': 0.38471952656998953, 'recall': 0.390011263979403, 'f1-score': 0.38509825430561934, 'support': 1242900}}
[[196492  94730 153536]
 [127472  90692 144430]
 [146758  91229 197561]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0841492
{'0': {'precision': 0.39756316937888303, 'recall': 0.5361960709431758, 'f1-score': 0.4565883798893368, 'support': 178058}, '1': {'precision': 0.41136385920188256, 'recall': 0.19151740626408678, 'f1-score': 0.26135607078198914, 'support': 175253}, '2': {'precision': 0.40232746697190824, 'recall': 0.4736466796556971, 'f1-score': 0.4350837741026229, 'support': 178099}, 'accuracy': 0.40156188253890596, 'macro avg': {'precision': 0.4037514985175579, 'recall': 0.4004533856209866, 'f1-score': 0.38434274159131626, 'support': 531410}, 'weighted avg': {'precision': 0.40371120748612666, 'recall': 0.40156188253890596, 'f1-score': 0.3849958305319707, 'support': 531410}}
[[95474 24120 58464]
 [74839 33564 66850]
 [69835 23908 84356]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0894222
{'0': {'precision': 0.4019551934826884, 'recall': 0.48413368133916834, 'f1-score': 0.43923370010326535, 'support': 50957}, '1': {'precision': 0.4112950800330358, 'recall': 0.21296352862117418, 'f1-score': 0.28062360801781744, 'support': 49107}, '2': {'precision': 0.39047049190653144, 'recall': 0.49353182342873064, 'f1-score': 0.43599345957065244, 'support': 50246}, 'accuracy': 0.3986827223737609, 'macro avg': {'precision': 0.40124025514075184, 'recall': 0.3968763444630244, 'f1-score': 0.3852835892305784, 'support': 150310}, 'weighted avg': {'precision': 0.4011674447862099, 'recall': 0.3986827223737609, 'f1-score': 0.3863318644446813, 'support': 150310}}
[[24670  7631 18656]
 [18595 10458 20054]
 [18110  7338 24798]]
training model: results/AAL/W2/deepOF_L2/h500
Epoch 1/50
2076/2076 - 48s - loss: 3.2615 - accuracy500: 0.3884 - val_loss: 3.3599 - val_accuracy500: 0.3475 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 45s - loss: 3.2511 - accuracy500: 0.3922 - val_loss: 3.3608 - val_accuracy500: 0.3502 - 45s/epoch - 22ms/step
Epoch 3/50
2076/2076 - 45s - loss: 3.2553 - accuracy500: 0.3924 - val_loss: 3.3405 - val_accuracy500: 0.3495 - 45s/epoch - 22ms/step
Epoch 4/50
2076/2076 - 45s - loss: 3.2550 - accuracy500: 0.3935 - val_loss: 3.3324 - val_accuracy500: 0.3526 - 45s/epoch - 22ms/step
Epoch 5/50
2076/2076 - 44s - loss: 3.2529 - accuracy500: 0.3943 - val_loss: 3.3537 - val_accuracy500: 0.3549 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 3.2428 - accuracy500: 0.4004 - val_loss: 3.3417 - val_accuracy500: 0.3555 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 45s - loss: 3.2349 - accuracy500: 0.4036 - val_loss: 3.3400 - val_accuracy500: 0.3559 - 45s/epoch - 22ms/step
Epoch 8/50
2076/2076 - 47s - loss: 3.2299 - accuracy500: 0.4074 - val_loss: 3.3379 - val_accuracy500: 0.3583 - 47s/epoch - 22ms/step
Epoch 9/50
2076/2076 - 45s - loss: 3.2265 - accuracy500: 0.4093 - val_loss: 3.3405 - val_accuracy500: 0.3591 - 45s/epoch - 22ms/step
Epoch 10/50
2076/2076 - 46s - loss: 3.2252 - accuracy500: 0.4108 - val_loss: 3.3407 - val_accuracy500: 0.3589 - 46s/epoch - 22ms/step
Epoch 11/50
2076/2076 - 44s - loss: 3.2219 - accuracy500: 0.4131 - val_loss: 3.3340 - val_accuracy500: 0.3592 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 45s - loss: 3.2208 - accuracy500: 0.4140 - val_loss: 3.3400 - val_accuracy500: 0.3591 - 45s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 45s - loss: 3.2189 - accuracy500: 0.4147 - val_loss: 3.3435 - val_accuracy500: 0.3590 - 45s/epoch - 22ms/step
Epoch 14/50
2076/2076 - 45s - loss: 3.2184 - accuracy500: 0.4143 - val_loss: 3.3349 - val_accuracy500: 0.3610 - 45s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h500
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981222
{'0': {'precision': 0.3934637445954484, 'recall': 0.4286929095596539, 'f1-score': 0.4103235475244071, 'support': 444514}, '1': {'precision': 0.2881876276434548, 'recall': 0.18209216167839154, 'f1-score': 0.22317228712820777, 'support': 360345}, '2': {'precision': 0.37947564611857953, 'recall': 0.4599204184083225, 'f1-score': 0.4158432599680889, 'support': 438041}, 'accuracy': 0.36820339528522006, 'macro avg': {'precision': 0.35370900611916095, 'recall': 0.35690182988212266, 'f1-score': 0.34977969820690125, 'support': 1242900}, 'weighted avg': {'precision': 0.3580119117786713, 'recall': 0.36820339528522006, 'f1-score': 0.35800947513811243, 'support': 1242900}}
[[190560  78808 175146]
 [140438  65616 154291]
 [153316  83261 201464]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007289
{'0': {'precision': 0.37205235742199216, 'recall': 0.4542428066064307, 'f1-score': 0.409059896262666, 'support': 177524}, '1': {'precision': 0.3605289757412399, 'recall': 0.12196108825239067, 'f1-score': 0.18226491904920072, 'support': 175474}, '2': {'precision': 0.36761336263116456, 'recall': 0.5260576642826715, 'f1-score': 0.43278974271478665, 'support': 178412}, 'accuracy': 0.3686325059746712, 'macro avg': {'precision': 0.3667315652647989, 'recall': 0.367420519713831, 'f1-score': 0.34137151934221777, 'support': 531410}, 'weighted avg': {'precision': 0.3667569662632457, 'recall': 0.3686325059746712, 'f1-score': 0.34213806101993466, 'support': 531410}}
[[80639 17982 78903]
 [71522 21401 82551]
 [64580 19977 93855]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097966
{'0': {'precision': 0.3513687123233521, 'recall': 0.4442246423588697, 'f1-score': 0.39237793943184013, 'support': 48023}, '1': {'precision': 0.3906635283568707, 'recall': 0.12709206927985414, 'f1-score': 0.19179024403664674, 'support': 54850}, '2': {'precision': 0.3441297803545546, 'recall': 0.5205219554356304, 'f1-score': 0.4143335374908758, 'support': 47437}, 'accuracy': 0.3525780054553922, 'macro avg': {'precision': 0.36205400701159246, 'recall': 0.3639462223581181, 'f1-score': 0.33283390698645426, 'support': 150310}, 'weighted avg': {'precision': 0.3634233157671326, 'recall': 0.3525780054553922, 'f1-score': 0.3261100438340763, 'support': 150310}}
[[21333  5247 21443]
 [22262  6971 25617]
 [17119  5626 24692]]
training model: results/AAL/W2/deepOF_L2/h1000
Epoch 1/50
2076/2076 - 47s - loss: 3.2480 - accuracy1000: 0.4019 - val_loss: 3.2982 - val_accuracy1000: 0.3667 - 47s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 3.2480 - accuracy1000: 0.3931 - val_loss: 3.2854 - val_accuracy1000: 0.3717 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 3.2465 - accuracy1000: 0.3905 - val_loss: 3.2839 - val_accuracy1000: 0.3722 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 3.2576 - accuracy1000: 0.3832 - val_loss: 3.2847 - val_accuracy1000: 0.3736 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 3.2530 - accuracy1000: 0.3893 - val_loss: 3.2850 - val_accuracy1000: 0.3736 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 3.2516 - accuracy1000: 0.3903 - val_loss: 3.2852 - val_accuracy1000: 0.3729 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 44s - loss: 3.2472 - accuracy1000: 0.3913 - val_loss: 3.2870 - val_accuracy1000: 0.3723 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 44s - loss: 3.2455 - accuracy1000: 0.3932 - val_loss: 3.2851 - val_accuracy1000: 0.3728 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 3.2487 - accuracy1000: 0.3922 - val_loss: 3.2868 - val_accuracy1000: 0.3724 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 44s - loss: 3.2448 - accuracy1000: 0.3962 - val_loss: 3.2902 - val_accuracy1000: 0.3723 - 44s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 44s - loss: 3.2359 - accuracy1000: 0.4011 - val_loss: 3.2960 - val_accuracy1000: 0.3711 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 44s - loss: 3.2297 - accuracy1000: 0.4047 - val_loss: 3.2985 - val_accuracy1000: 0.3706 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 44s - loss: 3.2298 - accuracy1000: 0.4037 - val_loss: 3.2967 - val_accuracy1000: 0.3709 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepOF_L2/h1000
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990009
{'0': {'precision': 0.3750500811842355, 'recall': 0.04319380628114588, 'f1-score': 0.07746600028310413, 'support': 411772}, '1': {'precision': 0.3478652776241163, 'recall': 0.952482152921285, 'f1-score': 0.5096106790767566, 'support': 425840}, '2': {'precision': 0.3845866955991049, 'recall': 0.027987505181500564, 'f1-score': 0.05217787304902228, 'support': 405288}, 'accuracy': 0.3497739158419825, 'macro avg': {'precision': 0.36916735146915225, 'recall': 0.3412211547946438, 'f1-score': 0.21308485080296102, 'support': 1242900}, 'weighted avg': {'precision': 0.36884579977377, 'recall': 0.3497739158419825, 'f1-score': 0.2172805593844336, 'support': 1242900}}
[[ 17786 383362  10624]
 [ 12708 405605   7527]
 [ 16929 377016  11343]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031345
{'0': {'precision': 0.3827993254637437, 'recall': 0.016758095108294433, 'f1-score': 0.03211046609685369, 'support': 176094}, '1': {'precision': 0.3313935979015884, 'recall': 0.9722618083978429, 'f1-score': 0.4943044568838474, 'support': 175426}, '2': {'precision': 0.3862175936184356, 'recall': 0.019378509088887653, 'f1-score': 0.03690529124055135, 'support': 179890}, 'accuracy': 0.33307051052859377, 'macro avg': {'precision': 0.3668035056612559, 'recall': 0.33613280419834163, 'f1-score': 0.18777340474041745, 'support': 531410}, 'weighted avg': {'precision': 0.36698669697543684, 'recall': 0.33307051052859377, 'f1-score': 0.18631039482024792, 'support': 531410}}
[[  2951 170246   2897]
 [  2223 170560   2643]
 [  2535 173869   3486]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944026
{'0': {'precision': 0.35589785164167004, 'recall': 0.018612341805693936, 'f1-score': 0.035374697824335215, 'support': 47173}, '1': {'precision': 0.3726357650523245, 'recall': 0.971462395293358, 'f1-score': 0.5386535649994529, 'support': 55751}, '2': {'precision': 0.354, 'recall': 0.018676402312919428, 'f1-score': 0.035480896443892074, 'support': 47386}, 'accuracy': 0.37205109440489653, 'macro avg': {'precision': 0.36084453889799817, 'recall': 0.3362503798039904, 'f1-score': 0.2031697197558934, 'support': 150310}, 'weighted avg': {'precision': 0.361507749936296, 'recall': 0.37205109440489653, 'f1-score': 0.22207772790660726, 'support': 150310}}
[[  878 45478   817]
 [  793 54160   798]
 [  796 45705   885]]
training model: results/AAL/W2/deepVOL_L2/h10
Epoch 1/50
2076/2076 - 47s - loss: 2.7567 - accuracy10: 0.4932 - val_loss: 2.5014 - val_accuracy10: 0.6133 - 47s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 43s - loss: 2.4767 - accuracy10: 0.5794 - val_loss: 2.4116 - val_accuracy10: 0.6329 - 43s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 43s - loss: 2.3888 - accuracy10: 0.6057 - val_loss: 2.4169 - val_accuracy10: 0.6665 - 43s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 44s - loss: 2.3445 - accuracy10: 0.6198 - val_loss: 2.3627 - val_accuracy10: 0.6553 - 44s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.3167 - accuracy10: 0.6279 - val_loss: 2.3317 - val_accuracy10: 0.6817 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 46s - loss: 2.2932 - accuracy10: 0.6349 - val_loss: 2.3310 - val_accuracy10: 0.6726 - 46s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 45s - loss: 2.2737 - accuracy10: 0.6384 - val_loss: 2.3217 - val_accuracy10: 0.6826 - 45s/epoch - 22ms/step
Epoch 8/50
2076/2076 - 44s - loss: 2.2512 - accuracy10: 0.6430 - val_loss: 2.2874 - val_accuracy10: 0.6592 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.2351 - accuracy10: 0.6459 - val_loss: 2.2910 - val_accuracy10: 0.6725 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 46s - loss: 2.2238 - accuracy10: 0.6478 - val_loss: 2.3071 - val_accuracy10: 0.6532 - 46s/epoch - 22ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.2110 - accuracy10: 0.6507 - val_loss: 2.2848 - val_accuracy10: 0.6661 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 42s - loss: 2.2002 - accuracy10: 0.6530 - val_loss: 2.2773 - val_accuracy10: 0.6662 - 42s/epoch - 20ms/step
Epoch 13/50
2076/2076 - 42s - loss: 2.1879 - accuracy10: 0.6546 - val_loss: 2.2860 - val_accuracy10: 0.6624 - 42s/epoch - 20ms/step
Epoch 14/50
2076/2076 - 45s - loss: 2.1809 - accuracy10: 0.6551 - val_loss: 2.2845 - val_accuracy10: 0.6790 - 45s/epoch - 22ms/step
Epoch 15/50
2076/2076 - 44s - loss: 2.1738 - accuracy10: 0.6573 - val_loss: 2.2662 - val_accuracy10: 0.6804 - 44s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 43s - loss: 2.1663 - accuracy10: 0.6584 - val_loss: 2.2804 - val_accuracy10: 0.6561 - 43s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 44s - loss: 2.1593 - accuracy10: 0.6584 - val_loss: 2.2651 - val_accuracy10: 0.6552 - 44s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 45s - loss: 2.1520 - accuracy10: 0.6600 - val_loss: 2.2689 - val_accuracy10: 0.6778 - 45s/epoch - 22ms/step
Epoch 19/50
2076/2076 - 43s - loss: 2.1457 - accuracy10: 0.6611 - val_loss: 2.2629 - val_accuracy10: 0.6713 - 43s/epoch - 21ms/step
Epoch 20/50
2076/2076 - 44s - loss: 2.1421 - accuracy10: 0.6611 - val_loss: 2.2670 - val_accuracy10: 0.6608 - 44s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 43s - loss: 2.1353 - accuracy10: 0.6619 - val_loss: 2.2591 - val_accuracy10: 0.6674 - 43s/epoch - 21ms/step
Epoch 22/50
2076/2076 - 45s - loss: 2.1398 - accuracy10: 0.6600 - val_loss: 2.2730 - val_accuracy10: 0.6657 - 45s/epoch - 22ms/step
Epoch 23/50
2076/2076 - 42s - loss: 2.1259 - accuracy10: 0.6627 - val_loss: 2.2543 - val_accuracy10: 0.6623 - 42s/epoch - 20ms/step
Epoch 24/50
2076/2076 - 45s - loss: 2.1211 - accuracy10: 0.6634 - val_loss: 2.2615 - val_accuracy10: 0.6597 - 45s/epoch - 22ms/step
Epoch 25/50
2076/2076 - 47s - loss: 2.1156 - accuracy10: 0.6633 - val_loss: 2.2780 - val_accuracy10: 0.6647 - 47s/epoch - 23ms/step
Epoch 26/50
2076/2076 - 43s - loss: 2.1115 - accuracy10: 0.6632 - val_loss: 2.2586 - val_accuracy10: 0.6661 - 43s/epoch - 21ms/step
Epoch 27/50
2076/2076 - 44s - loss: 2.1081 - accuracy10: 0.6638 - val_loss: 2.2712 - val_accuracy10: 0.6512 - 44s/epoch - 21ms/step
Epoch 28/50
2076/2076 - 43s - loss: 2.1055 - accuracy10: 0.6639 - val_loss: 2.2654 - val_accuracy10: 0.6644 - 43s/epoch - 21ms/step
Epoch 29/50
2076/2076 - 44s - loss: 2.1016 - accuracy10: 0.6644 - val_loss: 2.2522 - val_accuracy10: 0.6590 - 44s/epoch - 21ms/step
Epoch 30/50
2076/2076 - 42s - loss: 2.0957 - accuracy10: 0.6652 - val_loss: 2.2645 - val_accuracy10: 0.6526 - 42s/epoch - 20ms/step
Epoch 31/50
2076/2076 - 43s - loss: 2.0917 - accuracy10: 0.6651 - val_loss: 2.2658 - val_accuracy10: 0.6512 - 43s/epoch - 21ms/step
Epoch 32/50
2076/2076 - 43s - loss: 2.0885 - accuracy10: 0.6656 - val_loss: 2.2640 - val_accuracy10: 0.6584 - 43s/epoch - 20ms/step
Epoch 33/50
2076/2076 - 42s - loss: 2.0841 - accuracy10: 0.6654 - val_loss: 2.2708 - val_accuracy10: 0.6516 - 42s/epoch - 20ms/step
Epoch 34/50
2076/2076 - 43s - loss: 2.0794 - accuracy10: 0.6657 - val_loss: 2.2637 - val_accuracy10: 0.6463 - 43s/epoch - 21ms/step
Epoch 35/50
2076/2076 - 44s - loss: 2.0759 - accuracy10: 0.6658 - val_loss: 2.2674 - val_accuracy10: 0.6519 - 44s/epoch - 21ms/step
Epoch 36/50
2076/2076 - 47s - loss: 2.0739 - accuracy10: 0.6661 - val_loss: 2.2685 - val_accuracy10: 0.6462 - 47s/epoch - 23ms/step
Epoch 37/50
2076/2076 - 46s - loss: 2.0678 - accuracy10: 0.6665 - val_loss: 2.2683 - val_accuracy10: 0.6510 - 46s/epoch - 22ms/step
Epoch 38/50
2076/2076 - 45s - loss: 2.0661 - accuracy10: 0.6671 - val_loss: 2.2752 - val_accuracy10: 0.6391 - 45s/epoch - 22ms/step
Epoch 39/50
2076/2076 - 43s - loss: 2.0632 - accuracy10: 0.6671 - val_loss: 2.2698 - val_accuracy10: 0.6431 - 43s/epoch - 21ms/step
testing model: results/AAL/W2/deepVOL_L2/h10
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93738276
{'0': {'precision': 0.4349621472814866, 'recall': 0.5003491563408415, 'f1-score': 0.46537007002830205, 'support': 246308}, '1': {'precision': 0.8596544413822345, 'recall': 0.5321760608112719, 'f1-score': 0.6573896944386801, 'support': 761964}, '2': {'precision': 0.35857707995982535, 'recall': 0.7455856593062357, 'f1-score': 0.48425819685177784, 'support': 234633}, 'accuracy': 0.5661559008934713, 'macro avg': {'precision': 0.5510645562078488, 'recall': 0.5927036254861163, 'f1-score': 0.5356726537729201, 'support': 1242905}, 'weighted avg': {'precision': 0.6809003176817174, 'recall': 0.5661559008934713, 'f1-score': 0.586653530111898, 'support': 1242905}}
[[123240  41103  81965]
 [125499 405499 230966]
 [ 34596  25098 174939]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79305655
{'0': {'precision': 0.3923150489068167, 'recall': 0.5692147057207232, 'f1-score': 0.46449211589880995, 'support': 72788}, '1': {'precision': 0.9101548547889101, 'recall': 0.5972354238660836, 'f1-score': 0.7212156376232547, 'support': 384001}, '2': {'precision': 0.3332125207826352, 'recall': 0.7761890084560646, 'f1-score': 0.4662620147799907, 'support': 74621}, 'accuracy': 0.618526185054854, 'macro avg': {'precision': 0.5452274748261207, 'recall': 0.6475463793476238, 'f1-score': 0.5506565894340184, 'support': 531410}, 'weighted avg': {'precision': 0.7582108987165215, 'recall': 0.618526185054854, 'f1-score': 0.6502510603863451, 'support': 531410}}
[[ 41432  13978  17378]
 [ 56137 229339  98525]
 [  8040   8661  57920]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72598016
{'0': {'precision': 0.42330173775671404, 'recall': 0.5302003462775167, 'f1-score': 0.4707587570001097, 'support': 20215}, '1': {'precision': 0.8978656107099511, 'recall': 0.6657334266573343, 'f1-score': 0.7645683265476564, 'support': 110011}, '2': {'precision': 0.3478040579443127, 'recall': 0.7519418442541327, 'f1-score': 0.4756160932210063, 'support': 20084}, 'accuracy': 0.6590246823231988, 'macro avg': {'precision': 0.5563238021369926, 'recall': 0.6492918723963279, 'f1-score': 0.5703143922562575, 'support': 150310}, 'weighted avg': {'precision': 0.7605444416759894, 'recall': 0.6590246823231988, 'f1-score': 0.6864452668541158, 'support': 150310}}
[[10718  5149  4348]
 [12802 73238 23971]
 [ 1800  3182 15102]]
training model: results/AAL/W2/deepVOL_L2/h20
Epoch 1/50
2076/2076 - 45s - loss: 2.8066 - accuracy20: 0.5134 - val_loss: 2.6551 - val_accuracy20: 0.5531 - 45s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 43s - loss: 2.5948 - accuracy20: 0.5731 - val_loss: 2.5596 - val_accuracy20: 0.6167 - 43s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 2.5170 - accuracy20: 0.5949 - val_loss: 2.5795 - val_accuracy20: 0.6298 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 48s - loss: 2.4678 - accuracy20: 0.6059 - val_loss: 2.5530 - val_accuracy20: 0.6414 - 48s/epoch - 23ms/step
Epoch 5/50
2076/2076 - 43s - loss: 2.4364 - accuracy20: 0.6136 - val_loss: 2.5439 - val_accuracy20: 0.6420 - 43s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 47s - loss: 2.4131 - accuracy20: 0.6196 - val_loss: 2.5383 - val_accuracy20: 0.6516 - 47s/epoch - 23ms/step
Epoch 7/50
2076/2076 - 48s - loss: 2.3927 - accuracy20: 0.6237 - val_loss: 2.5445 - val_accuracy20: 0.6481 - 48s/epoch - 23ms/step
Epoch 8/50
2076/2076 - 46s - loss: 2.3743 - accuracy20: 0.6251 - val_loss: 2.4983 - val_accuracy20: 0.6635 - 46s/epoch - 22ms/step
Epoch 9/50
2076/2076 - 46s - loss: 2.3597 - accuracy20: 0.6276 - val_loss: 2.4935 - val_accuracy20: 0.6532 - 46s/epoch - 22ms/step
Epoch 10/50
2076/2076 - 45s - loss: 2.3412 - accuracy20: 0.6311 - val_loss: 2.4976 - val_accuracy20: 0.6607 - 45s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 47s - loss: 2.3299 - accuracy20: 0.6335 - val_loss: 2.4656 - val_accuracy20: 0.6426 - 47s/epoch - 23ms/step
Epoch 12/50
2076/2076 - 46s - loss: 2.3177 - accuracy20: 0.6353 - val_loss: 2.4704 - val_accuracy20: 0.6488 - 46s/epoch - 22ms/step
Epoch 13/50
2076/2076 - 42s - loss: 2.3075 - accuracy20: 0.6375 - val_loss: 2.4590 - val_accuracy20: 0.6460 - 42s/epoch - 20ms/step
Epoch 14/50
2076/2076 - 45s - loss: 2.3009 - accuracy20: 0.6377 - val_loss: 2.4380 - val_accuracy20: 0.6408 - 45s/epoch - 22ms/step
Epoch 15/50
2076/2076 - 43s - loss: 2.2935 - accuracy20: 0.6390 - val_loss: 2.4678 - val_accuracy20: 0.6485 - 43s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 43s - loss: 2.2878 - accuracy20: 0.6400 - val_loss: 2.4777 - val_accuracy20: 0.6414 - 43s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 42s - loss: 2.2801 - accuracy20: 0.6405 - val_loss: 2.4310 - val_accuracy20: 0.6337 - 42s/epoch - 20ms/step
Epoch 18/50
2076/2076 - 45s - loss: 2.2742 - accuracy20: 0.6421 - val_loss: 2.4783 - val_accuracy20: 0.6371 - 45s/epoch - 22ms/step
Epoch 19/50
2076/2076 - 46s - loss: 2.2691 - accuracy20: 0.6418 - val_loss: 2.5014 - val_accuracy20: 0.6488 - 46s/epoch - 22ms/step
Epoch 20/50
2076/2076 - 43s - loss: 2.2648 - accuracy20: 0.6421 - val_loss: 2.4878 - val_accuracy20: 0.6394 - 43s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 45s - loss: 2.2595 - accuracy20: 0.6429 - val_loss: 2.4539 - val_accuracy20: 0.6414 - 45s/epoch - 22ms/step
Epoch 22/50
2076/2076 - 44s - loss: 2.2551 - accuracy20: 0.6433 - val_loss: 2.4850 - val_accuracy20: 0.6500 - 44s/epoch - 21ms/step
Epoch 23/50
2076/2076 - 43s - loss: 2.2504 - accuracy20: 0.6447 - val_loss: 2.4941 - val_accuracy20: 0.6357 - 43s/epoch - 21ms/step
Epoch 24/50
2076/2076 - 43s - loss: 2.2458 - accuracy20: 0.6450 - val_loss: 2.4865 - val_accuracy20: 0.6424 - 43s/epoch - 21ms/step
Epoch 25/50
2076/2076 - 43s - loss: 2.2406 - accuracy20: 0.6454 - val_loss: 2.4782 - val_accuracy20: 0.6437 - 43s/epoch - 21ms/step
Epoch 26/50
2076/2076 - 43s - loss: 2.2365 - accuracy20: 0.6460 - val_loss: 2.4726 - val_accuracy20: 0.6536 - 43s/epoch - 21ms/step
Epoch 27/50
2076/2076 - 45s - loss: 2.2327 - accuracy20: 0.6460 - val_loss: 2.5031 - val_accuracy20: 0.6529 - 45s/epoch - 22ms/step
testing model: results/AAL/W2/deepVOL_L2/h20
Evaluating performance on  test set...
4856/4856 - 48s - 48s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95645255
{'0': {'precision': 0.4974289310776341, 'recall': 0.4380758252547123, 'f1-score': 0.4658695490586878, 'support': 307602}, '1': {'precision': 0.7616942701233772, 'recall': 0.5487933831396826, 'f1-score': 0.6379499637074566, 'support': 637402}, '2': {'precision': 0.4138141523195856, 'recall': 0.7122802541784016, 'f1-score': 0.5234936749458777, 'support': 297901}, 'accuracy': 0.5605770352520909, 'macro avg': {'precision': 0.5576457845068656, 'recall': 0.5663831541909321, 'f1-score': 0.5424377292373407, 'support': 1242905}, 'weighted avg': {'precision': 0.612911875817283, 'recall': 0.5605770352520909, 'f1-score': 0.5679293888564795, 'support': 1242905}}
[[134753  66368 106481]
 [ 93506 349802 194094]
 [ 42640  43072 212189]]
Evaluating performance on  train set...
2076/2076 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8079415
{'0': {'precision': 0.47925587175827483, 'recall': 0.5124957170890742, 'f1-score': 0.49531875608361015, 'support': 96313}, '1': {'precision': 0.8380328058936314, 'recall': 0.6008812691701283, 'f1-score': 0.6999142266215665, 'support': 336787}, '2': {'precision': 0.3872983267000471, 'recall': 0.7364459363238735, 'f1-score': 0.5076320088625257, 'support': 98310}, 'accuracy': 0.6099414764494459, 'macro avg': {'precision': 0.5681956681173178, 'recall': 0.6166076408610253, 'f1-score': 0.5676216638559007, 'support': 531410}, 'weighted avg': {'precision': 0.6896227467925609, 'recall': 0.6099414764494459, 'f1-score': 0.627261343947523, 'support': 531410}}
[[ 49360  23815  23138]
 [ 43020 202369  91398]
 [ 10613  15297  72400]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7743088
{'0': {'precision': 0.4989241527703066, 'recall': 0.48192547505938244, 'f1-score': 0.4902775155748537, 'support': 26944}, '1': {'precision': 0.8242062923863946, 'recall': 0.6555201258903429, 'f1-score': 0.7302482484214169, 'support': 96592}, '2': {'precision': 0.4006236699605992, 'recall': 0.7101665795174423, 'f1-score': 0.5122651040614266, 'support': 26774}, 'accuracy': 0.6341361186880448, 'macro avg': {'precision': 0.5745847050391001, 'recall': 0.6158707268223892, 'f1-score': 0.5775969560192323, 'support': 150310}, 'weighted avg': {'precision': 0.6904467081761351, 'recall': 0.6341361186880448, 'f1-score': 0.6484037129087286, 'support': 150310}}
[[12985  8164  5795]
 [10622 63318 22652]
 [ 2419  5341 19014]]
training model: results/AAL/W2/deepVOL_L2/h30
Epoch 1/50
2076/2076 - 48s - loss: 2.9238 - accuracy30: 0.4847 - val_loss: 2.9018 - val_accuracy30: 0.5825 - 48s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 44s - loss: 2.6868 - accuracy30: 0.5577 - val_loss: 2.7729 - val_accuracy30: 0.6086 - 44s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 43s - loss: 2.5916 - accuracy30: 0.5827 - val_loss: 2.7444 - val_accuracy30: 0.6302 - 43s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 43s - loss: 2.5564 - accuracy30: 0.5926 - val_loss: 2.6920 - val_accuracy30: 0.6241 - 43s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 44s - loss: 2.5365 - accuracy30: 0.5971 - val_loss: 2.6830 - val_accuracy30: 0.6280 - 44s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 43s - loss: 2.5197 - accuracy30: 0.6000 - val_loss: 2.6625 - val_accuracy30: 0.6286 - 43s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 43s - loss: 2.5040 - accuracy30: 0.6020 - val_loss: 2.6387 - val_accuracy30: 0.6274 - 43s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 48s - loss: 2.4889 - accuracy30: 0.6036 - val_loss: 2.6391 - val_accuracy30: 0.6297 - 48s/epoch - 23ms/step
Epoch 9/50
2076/2076 - 44s - loss: 2.4773 - accuracy30: 0.6062 - val_loss: 2.6500 - val_accuracy30: 0.6318 - 44s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 49s - loss: 2.4650 - accuracy30: 0.6080 - val_loss: 2.6333 - val_accuracy30: 0.6253 - 49s/epoch - 23ms/step
Epoch 11/50
2076/2076 - 44s - loss: 2.4532 - accuracy30: 0.6103 - val_loss: 2.6371 - val_accuracy30: 0.6196 - 44s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 43s - loss: 2.4451 - accuracy30: 0.6116 - val_loss: 2.6012 - val_accuracy30: 0.6201 - 43s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 43s - loss: 2.4373 - accuracy30: 0.6132 - val_loss: 2.6110 - val_accuracy30: 0.6185 - 43s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 42s - loss: 2.4284 - accuracy30: 0.6141 - val_loss: 2.6135 - val_accuracy30: 0.6214 - 42s/epoch - 20ms/step
Epoch 15/50
2076/2076 - 46s - loss: 2.4242 - accuracy30: 0.6154 - val_loss: 2.6079 - val_accuracy30: 0.6153 - 46s/epoch - 22ms/step
Epoch 16/50
2076/2076 - 44s - loss: 2.4161 - accuracy30: 0.6165 - val_loss: 2.6199 - val_accuracy30: 0.6157 - 44s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 42s - loss: 2.4107 - accuracy30: 0.6170 - val_loss: 2.6201 - val_accuracy30: 0.6087 - 42s/epoch - 20ms/step
Epoch 18/50
2076/2076 - 46s - loss: 2.4051 - accuracy30: 0.6184 - val_loss: 2.6257 - val_accuracy30: 0.6118 - 46s/epoch - 22ms/step
Epoch 19/50
2076/2076 - 43s - loss: 2.4015 - accuracy30: 0.6180 - val_loss: 2.6107 - val_accuracy30: 0.6126 - 43s/epoch - 21ms/step
Epoch 20/50
2076/2076 - 44s - loss: 2.3949 - accuracy30: 0.6194 - val_loss: 2.6150 - val_accuracy30: 0.6142 - 44s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 46s - loss: 2.3898 - accuracy30: 0.6199 - val_loss: 2.6196 - val_accuracy30: 0.6149 - 46s/epoch - 22ms/step
Epoch 22/50
2076/2076 - 43s - loss: 2.3850 - accuracy30: 0.6213 - val_loss: 2.6110 - val_accuracy30: 0.6206 - 43s/epoch - 21ms/step
testing model: results/AAL/W2/deepVOL_L2/h30
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96068347
{'0': {'precision': 0.518, 'recall': 0.4061004064644473, 'f1-score': 0.45527522567251855, 'support': 348862}, '1': {'precision': 0.6739185706643669, 'recall': 0.5968267807027341, 'f1-score': 0.6330342275935792, 'support': 555146}, '2': {'precision': 0.4481626912031882, 'recall': 0.6318025830857164, 'f1-score': 0.5243693527669375, 'support': 338897}, 'accuracy': 0.5528298622984058, 'macro avg': {'precision': 0.5466937539558517, 'recall': 0.5449099234176326, 'f1-score': 0.5375596020110117, 'support': 1242905}, 'weighted avg': {'precision': 0.5685991337960081, 'recall': 0.5528298622984058, 'f1-score': 0.5535112061138125, 'support': 1242905}}
[[141673  95446 111743]
 [ 71915 331326 151905]
 [ 59912  64869 214116]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8391507
{'0': {'precision': 0.511938944434572, 'recall': 0.4839439807610695, 'f1-score': 0.49754798361989433, 'support': 113104}, '1': {'precision': 0.7677646817669366, 'recall': 0.6177863839388801, 'f1-score': 0.684658369084591, 'support': 303142}, '2': {'precision': 0.42268201100982467, 'recall': 0.6627244625056441, 'f1-score': 0.5161600108206811, 'support': 115164}, 'accuracy': 0.5990384072561675, 'macro avg': {'precision': 0.5674618790704443, 'recall': 0.5881516090685313, 'f1-score': 0.5661221211750554, 'support': 531410}, 'weighted avg': {'precision': 0.6385311052623323, 'recall': 0.5990384072561675, 'f1-score': 0.6083182965065365, 'support': 531410}}
[[ 54736  33454  24914]
 [ 36535 187277  79330]
 [ 15648  23194  76322]]
Evaluating performance on  val set...
588/588 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8114757
{'0': {'precision': 0.5401069518716578, 'recall': 0.42114998745924254, 'f1-score': 0.47326791974210375, 'support': 31896}, '1': {'precision': 0.7409744517017848, 'recall': 0.6943816857248248, 'f1-score': 0.7169218501746515, 'support': 86752}, '2': {'precision': 0.4429115128449096, 'recall': 0.6174909986734888, 'f1-score': 0.5158302991926548, 'support': 31662}, 'accuracy': 0.6202049098529705, 'macro avg': {'precision': 0.5746643054727841, 'recall': 0.5776742239525188, 'f1-score': 0.5686733563698033, 'support': 150310}, 'weighted avg': {'precision': 0.6355647082072194, 'recall': 0.6202049098529705, 'f1-score': 0.6228592698255827, 'support': 150310}}
[[13433 12517  5946]
 [ 7868 60239 18645]
 [ 3570  8541 19551]]
training model: results/AAL/W2/deepVOL_L2/h50
Epoch 1/50
2076/2076 - 47s - loss: 3.0472 - accuracy50: 0.4655 - val_loss: 3.0369 - val_accuracy50: 0.5034 - 47s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 43s - loss: 2.8638 - accuracy50: 0.5249 - val_loss: 3.1468 - val_accuracy50: 0.5460 - 43s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 47s - loss: 2.7698 - accuracy50: 0.5483 - val_loss: 3.0748 - val_accuracy50: 0.5444 - 47s/epoch - 23ms/step
Epoch 4/50
2076/2076 - 47s - loss: 2.7359 - accuracy50: 0.5565 - val_loss: 2.9977 - val_accuracy50: 0.5516 - 47s/epoch - 22ms/step
Epoch 5/50
2076/2076 - 43s - loss: 2.7152 - accuracy50: 0.5624 - val_loss: 2.9635 - val_accuracy50: 0.5540 - 43s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 45s - loss: 2.7004 - accuracy50: 0.5655 - val_loss: 2.9615 - val_accuracy50: 0.5587 - 45s/epoch - 22ms/step
Epoch 7/50
2076/2076 - 46s - loss: 2.6919 - accuracy50: 0.5675 - val_loss: 2.9390 - val_accuracy50: 0.5560 - 46s/epoch - 22ms/step
Epoch 8/50
2076/2076 - 43s - loss: 2.6823 - accuracy50: 0.5685 - val_loss: 2.9498 - val_accuracy50: 0.5562 - 43s/epoch - 20ms/step
Epoch 9/50
2076/2076 - 42s - loss: 2.6723 - accuracy50: 0.5704 - val_loss: 2.9477 - val_accuracy50: 0.5606 - 42s/epoch - 20ms/step
Epoch 10/50
2076/2076 - 42s - loss: 2.6624 - accuracy50: 0.5722 - val_loss: 2.9437 - val_accuracy50: 0.5580 - 42s/epoch - 20ms/step
Epoch 11/50
2076/2076 - 45s - loss: 2.6546 - accuracy50: 0.5729 - val_loss: 2.9365 - val_accuracy50: 0.5593 - 45s/epoch - 22ms/step
Epoch 12/50
2076/2076 - 44s - loss: 2.6457 - accuracy50: 0.5746 - val_loss: 2.9356 - val_accuracy50: 0.5588 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 46s - loss: 2.6403 - accuracy50: 0.5755 - val_loss: 2.9118 - val_accuracy50: 0.5592 - 46s/epoch - 22ms/step
Epoch 14/50
2076/2076 - 48s - loss: 2.6321 - accuracy50: 0.5772 - val_loss: 2.9253 - val_accuracy50: 0.5580 - 48s/epoch - 23ms/step
Epoch 15/50
2076/2076 - 47s - loss: 2.6271 - accuracy50: 0.5782 - val_loss: 2.9093 - val_accuracy50: 0.5637 - 47s/epoch - 23ms/step
Epoch 16/50
2076/2076 - 47s - loss: 2.6212 - accuracy50: 0.5787 - val_loss: 2.8948 - val_accuracy50: 0.5581 - 47s/epoch - 23ms/step
Epoch 17/50
2076/2076 - 43s - loss: 2.6167 - accuracy50: 0.5791 - val_loss: 2.9028 - val_accuracy50: 0.5661 - 43s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 43s - loss: 2.6128 - accuracy50: 0.5796 - val_loss: 2.8974 - val_accuracy50: 0.5648 - 43s/epoch - 21ms/step
Epoch 19/50
2076/2076 - 46s - loss: 2.6069 - accuracy50: 0.5813 - val_loss: 2.8997 - val_accuracy50: 0.5630 - 46s/epoch - 22ms/step
Epoch 20/50
2076/2076 - 43s - loss: 2.6038 - accuracy50: 0.5812 - val_loss: 2.8884 - val_accuracy50: 0.5632 - 43s/epoch - 21ms/step
Epoch 21/50
2076/2076 - 43s - loss: 2.5982 - accuracy50: 0.5828 - val_loss: 2.8855 - val_accuracy50: 0.5609 - 43s/epoch - 21ms/step
Epoch 22/50
2076/2076 - 44s - loss: 2.5946 - accuracy50: 0.5826 - val_loss: 2.8747 - val_accuracy50: 0.5612 - 44s/epoch - 21ms/step
Epoch 23/50
2076/2076 - 44s - loss: 2.5908 - accuracy50: 0.5841 - val_loss: 2.8694 - val_accuracy50: 0.5578 - 44s/epoch - 21ms/step
Epoch 24/50
2076/2076 - 42s - loss: 2.5858 - accuracy50: 0.5843 - val_loss: 2.8763 - val_accuracy50: 0.5594 - 42s/epoch - 20ms/step
Epoch 25/50
2076/2076 - 42s - loss: 2.5832 - accuracy50: 0.5856 - val_loss: 2.8710 - val_accuracy50: 0.5640 - 42s/epoch - 20ms/step
Epoch 26/50
2076/2076 - 42s - loss: 2.5780 - accuracy50: 0.5864 - val_loss: 2.8832 - val_accuracy50: 0.5635 - 42s/epoch - 20ms/step
Epoch 27/50
2076/2076 - 42s - loss: 2.5739 - accuracy50: 0.5870 - val_loss: 2.8780 - val_accuracy50: 0.5592 - 42s/epoch - 20ms/step
Epoch 28/50
2076/2076 - 43s - loss: 2.5716 - accuracy50: 0.5870 - val_loss: 2.8802 - val_accuracy50: 0.5547 - 43s/epoch - 21ms/step
Epoch 29/50
2076/2076 - 43s - loss: 2.5682 - accuracy50: 0.5873 - val_loss: 2.8838 - val_accuracy50: 0.5563 - 43s/epoch - 21ms/step
Epoch 30/50
2076/2076 - 44s - loss: 2.5662 - accuracy50: 0.5874 - val_loss: 2.8810 - val_accuracy50: 0.5599 - 44s/epoch - 21ms/step
Epoch 31/50
2076/2076 - 46s - loss: 2.5606 - accuracy50: 0.5888 - val_loss: 2.8725 - val_accuracy50: 0.5577 - 46s/epoch - 22ms/step
Epoch 32/50
2076/2076 - 45s - loss: 2.5585 - accuracy50: 0.5885 - val_loss: 2.8776 - val_accuracy50: 0.5600 - 45s/epoch - 22ms/step
Epoch 33/50
2076/2076 - 44s - loss: 2.5547 - accuracy50: 0.5901 - val_loss: 2.8823 - val_accuracy50: 0.5529 - 44s/epoch - 21ms/step
testing model: results/AAL/W2/deepVOL_L2/h50
Evaluating performance on  test set...
4856/4856 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0052578
{'0': {'precision': 0.5196153682842146, 'recall': 0.3924614598983119, 'f1-score': 0.4471750618394424, 'support': 405357}, '1': {'precision': 0.5491408906601125, 'recall': 0.603389472549002, 'f1-score': 0.5749884652893528, 'support': 445084}, '2': {'precision': 0.47812208921818494, 'recall': 0.5454003424517918, 'f1-score': 0.5095500462415774, 'support': 392464}, 'accuracy': 0.5162872464106267, 'macro avg': {'precision': 0.5156261160541707, 'recall': 0.5137504249663686, 'f1-score': 0.5105711911234575, 'support': 1242905}, 'weighted avg': {'precision': 0.5170863892598997, 'recall': 0.5162872464106267, 'f1-score': 0.512640754502598, 'support': 1242905}}
[[159087 118250 128020]
 [ 70906 268559 105619]
 [ 76170 102244 214050]]
Evaluating performance on  train set...
2076/2076 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9040294
{'0': {'precision': 0.5213070115724983, 'recall': 0.44284134361695204, 'f1-score': 0.4788812763080242, 'support': 138343}, '1': {'precision': 0.6502406184189382, 'recall': 0.6093636684275393, 'f1-score': 0.629138869624456, 'support': 252337}, '2': {'precision': 0.4617621860486089, 'recall': 0.5821360051161799, 'f1-score': 0.5150088324228499, 'support': 140730}, 'accuracy': 0.558802054910521, 'macro avg': {'precision': 0.5444366053466818, 'recall': 0.5447803390535572, 'f1-score': 0.5410096594517767, 'support': 531410}, 'weighted avg': {'precision': 0.5667615123437167, 'recall': 0.558802054910521, 'f1-score': 0.5597976709877025, 'support': 531410}}
[[ 61264  44501  32578]
 [ 35658 153765  62914]
 [ 20598  38208  81924]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.911048
{'0': {'precision': 0.5271270662204645, 'recall': 0.3958872810357959, 'f1-score': 0.45217693880213994, 'support': 39390}, '1': {'precision': 0.6167272820407745, 'recall': 0.669982331909684, 'f1-score': 0.6422527322313278, 'support': 71881}, '2': {'precision': 0.47224372053753605, 'recall': 0.5157919004072851, 'f1-score': 0.4930581062219937, 'support': 39039}, 'accuracy': 0.5581065797352139, 'macro avg': {'precision': 0.5386993562662584, 'recall': 0.5272205044509216, 'f1-score': 0.5291625924184872, 'support': 150310}, 'weighted avg': {'precision': 0.5557210531891549, 'recall': 0.5581065797352139, 'f1-score': 0.5536924600740921, 'support': 150310}}
[[15594 16027  7769]
 [ 8988 48159 14734]
 [ 5001 13902 20136]]
training model: results/AAL/W2/deepVOL_L2/h100
Epoch 1/50
2076/2076 - 47s - loss: 3.1911 - accuracy100: 0.4259 - val_loss: 3.2423 - val_accuracy100: 0.4331 - 47s/epoch - 23ms/step
Epoch 2/50
2076/2076 - 43s - loss: 3.0397 - accuracy100: 0.4766 - val_loss: 3.4025 - val_accuracy100: 0.4300 - 43s/epoch - 21ms/step
Epoch 3/50
2076/2076 - 44s - loss: 2.9814 - accuracy100: 0.4862 - val_loss: 3.3945 - val_accuracy100: 0.4247 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 43s - loss: 2.9591 - accuracy100: 0.4915 - val_loss: 3.3521 - val_accuracy100: 0.4320 - 43s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 45s - loss: 2.9473 - accuracy100: 0.4957 - val_loss: 3.3117 - val_accuracy100: 0.4341 - 45s/epoch - 22ms/step
Epoch 6/50
2076/2076 - 44s - loss: 2.9383 - accuracy100: 0.4978 - val_loss: 3.3342 - val_accuracy100: 0.4352 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 44s - loss: 2.9332 - accuracy100: 0.4988 - val_loss: 3.3080 - val_accuracy100: 0.4415 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 43s - loss: 2.9269 - accuracy100: 0.5003 - val_loss: 3.2923 - val_accuracy100: 0.4430 - 43s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 43s - loss: 2.9219 - accuracy100: 0.5014 - val_loss: 3.2673 - val_accuracy100: 0.4459 - 43s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 42s - loss: 2.9180 - accuracy100: 0.5025 - val_loss: 3.2853 - val_accuracy100: 0.4456 - 42s/epoch - 20ms/step
Epoch 11/50
2076/2076 - 45s - loss: 2.9128 - accuracy100: 0.5037 - val_loss: 3.2799 - val_accuracy100: 0.4477 - 45s/epoch - 22ms/step
testing model: results/AAL/W2/deepVOL_L2/h100
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992221
{'0': {'precision': 0.47561708617101073, 'recall': 0.19993651880839122, 'f1-score': 0.281526806441132, 'support': 478882}, '1': {'precision': 0.36036390157040293, 'recall': 0.499455208989708, 'f1-score': 0.41865928672821506, 'support': 304704}, '2': {'precision': 0.4480044696778861, 'recall': 0.6040290081620834, 'f1-score': 0.5144469281097864, 'support': 459319}, 'accuracy': 0.4226984363245783, 'macro avg': {'precision': 0.4279951524730999, 'recall': 0.4344735786533942, 'f1-score': 0.40487767375971123, 'support': 1242905}, 'weighted avg': {'precision': 0.4371579072671129, 'recall': 0.4226984363245783, 'f1-score': 0.40122175709151964, 'support': 1242905}}
[[ 95746 154824 228312]
 [ 38988 152186 113530]
 [ 66575 115302 277442]]
Evaluating performance on  train set...
2076/2076 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0694604
{'0': {'precision': 0.46151285053002394, 'recall': 0.24506684004014964, 'f1-score': 0.3201379757350449, 'support': 175344}, '1': {'precision': 0.43256990003124024, 'recall': 0.49496754878852534, 'f1-score': 0.4616699053404254, 'support': 179038}, '2': {'precision': 0.43516237785783746, 'recall': 0.5738244797433174, 'f1-score': 0.4949654659958827, 'support': 177028}, 'accuracy': 0.4387798498334619, 'macro avg': {'precision': 0.4430817094730339, 'recall': 0.4379529561906641, 'f1-score': 0.425591115690451, 'support': 531410}, 'weighted avg': {'precision': 0.44298354274956614, 'recall': 0.4387798498334619, 'f1-score': 0.426061753154709, 'support': 531410}}
[[ 42971  67645  64728]
 [ 23294  88618  67126]
 [ 26844  48601 101583]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0798471
{'0': {'precision': 0.4692216515211379, 'recall': 0.2348149319835495, 'f1-score': 0.3129958095037293, 'support': 50576}, '1': {'precision': 0.412908160969537, 'recall': 0.5510318461138133, 'f1-score': 0.4720740804252765, 'support': 49959}, '2': {'precision': 0.4387868813111831, 'recall': 0.5141938724259166, 'f1-score': 0.4735069932657441, 'support': 49775}, 'accuracy': 0.4324329718581598, 'macro avg': {'precision': 0.4403055646006193, 'recall': 0.4333468835077598, 'f1-score': 0.4195256277315833, 'support': 150310}, 'weighted avg': {'precision': 0.4404261198754196, 'recall': 0.4324329718581598, 'f1-score': 0.41902225823451145, 'support': 150310}}
[[11876 22599 16101]
 [ 5796 27529 16634]
 [ 7638 16543 25594]]
training model: results/AAL/W2/deepVOL_L2/h200
Epoch 1/50
2076/2076 - 46s - loss: 3.2641 - accuracy200: 0.3894 - val_loss: 3.2938 - val_accuracy200: 0.3707 - 46s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 45s - loss: 3.2346 - accuracy200: 0.4035 - val_loss: 3.3394 - val_accuracy200: 0.3729 - 45s/epoch - 22ms/step
Epoch 3/50
2076/2076 - 46s - loss: 3.2162 - accuracy200: 0.4137 - val_loss: 3.3591 - val_accuracy200: 0.3756 - 46s/epoch - 22ms/step
Epoch 4/50
2076/2076 - 49s - loss: 3.2076 - accuracy200: 0.4188 - val_loss: 3.3728 - val_accuracy200: 0.3738 - 49s/epoch - 23ms/step
Epoch 5/50
2076/2076 - 43s - loss: 3.2031 - accuracy200: 0.4211 - val_loss: 3.3641 - val_accuracy200: 0.3757 - 43s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 44s - loss: 3.1963 - accuracy200: 0.4228 - val_loss: 3.3904 - val_accuracy200: 0.3751 - 44s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 48s - loss: 3.1921 - accuracy200: 0.4247 - val_loss: 3.3819 - val_accuracy200: 0.3738 - 48s/epoch - 23ms/step
Epoch 8/50
2076/2076 - 44s - loss: 3.1870 - accuracy200: 0.4270 - val_loss: 3.4101 - val_accuracy200: 0.3719 - 44s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 43s - loss: 3.1813 - accuracy200: 0.4288 - val_loss: 3.4398 - val_accuracy200: 0.3683 - 43s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 45s - loss: 3.1766 - accuracy200: 0.4300 - val_loss: 3.4246 - val_accuracy200: 0.3674 - 45s/epoch - 22ms/step
Epoch 11/50
2076/2076 - 47s - loss: 3.1713 - accuracy200: 0.4322 - val_loss: 3.4383 - val_accuracy200: 0.3679 - 47s/epoch - 23ms/step
testing model: results/AAL/W2/deepVOL_L2/h200
Evaluating performance on  test set...
4856/4856 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113808
{'0': {'precision': 0.44148968538915595, 'recall': 0.06691508102673836, 'f1-score': 0.11621573998430168, 'support': 433684}, '1': {'precision': 0.32071159584986464, 'recall': 0.4576969933740111, 'f1-score': 0.37715085674227206, 'support': 389074}, '2': {'precision': 0.3782982856150529, 'recall': 0.559968296810402, 'f1-score': 0.45154554291927246, 'support': 420147}, 'accuracy': 0.35591376653887463, 'macro avg': {'precision': 0.3801665222846912, 'recall': 0.36152679040371716, 'f1-score': 0.3149707132152821, 'support': 1242905}, 'weighted avg': {'precision': 0.3823208096904499, 'recall': 0.35591376653887463, 'f1-score': 0.31125146703601503, 'support': 1242905}}
[[ 29020 207269 197395]
 [ 21746 178078 189250]
 [ 14966 169912 235269]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972086
{'0': {'precision': 0.44283602022321855, 'recall': 0.10450104675505932, 'f1-score': 0.16909809492587333, 'support': 177692}, '1': {'precision': 0.3342417366982284, 'recall': 0.4467334157814785, 'f1-score': 0.3823859242072699, 'support': 177081}, '2': {'precision': 0.39229981131254477, 'recall': 0.5614508851486382, 'f1-score': 0.4618755763373355, 'support': 176637}, 'accuracy': 0.3704296117875087, 'macro avg': {'precision': 0.3897925227446639, 'recall': 0.3708951158950587, 'f1-score': 0.33778653182349294, 'support': 531410}, 'weighted avg': {'precision': 0.3898514157666907, 'recall': 0.3704296117875087, 'f1-score': 0.3374889006710709, 'support': 531410}}
[[18569 88995 70128]
 [14475 79108 83498]
 [ 8888 68576 99173]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982997
{'0': {'precision': 0.42781363274688355, 'recall': 0.09771612043375538, 'f1-score': 0.15909389794844822, 'support': 49521}, '1': {'precision': 0.347762893703737, 'recall': 0.4479204863456528, 'f1-score': 0.39153796192420265, 'support': 51815}, '2': {'precision': 0.3817135107457688, 'recall': 0.563217217298975, 'f1-score': 0.4550336124056584, 'support': 48974}, 'accuracy': 0.3701084425520591, 'macro avg': {'precision': 0.3857633457321297, 'recall': 0.3696179413594611, 'f1-score': 0.3352218240927698, 'support': 150310}, 'weighted avg': {'precision': 0.3851981286659626, 'recall': 0.3701084425520591, 'f1-score': 0.3356452967291756, 'support': 150310}}
[[ 4839 24595 20087]
 [ 4015 23209 24591]
 [ 2457 18934 27583]]
training model: results/AAL/W2/deepVOL_L2/h300
Epoch 1/50
2076/2076 - 46s - loss: 3.2880 - accuracy300: 0.3746 - val_loss: 3.2910 - val_accuracy300: 0.3645 - 46s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 47s - loss: 3.2635 - accuracy300: 0.3862 - val_loss: 3.2971 - val_accuracy300: 0.3653 - 47s/epoch - 22ms/step
Epoch 3/50
2076/2076 - 44s - loss: 3.2531 - accuracy300: 0.3938 - val_loss: 3.2978 - val_accuracy300: 0.3786 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 42s - loss: 3.2419 - accuracy300: 0.4013 - val_loss: 3.2978 - val_accuracy300: 0.3833 - 42s/epoch - 20ms/step
Epoch 5/50
2076/2076 - 43s - loss: 3.2318 - accuracy300: 0.4078 - val_loss: 3.2960 - val_accuracy300: 0.3859 - 43s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 48s - loss: 3.2222 - accuracy300: 0.4121 - val_loss: 3.3014 - val_accuracy300: 0.3875 - 48s/epoch - 23ms/step
Epoch 7/50
2076/2076 - 43s - loss: 3.2161 - accuracy300: 0.4146 - val_loss: 3.2951 - val_accuracy300: 0.3905 - 43s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 43s - loss: 3.2104 - accuracy300: 0.4169 - val_loss: 3.2856 - val_accuracy300: 0.3926 - 43s/epoch - 21ms/step
Epoch 9/50
2076/2076 - 45s - loss: 3.2051 - accuracy300: 0.4200 - val_loss: 3.2876 - val_accuracy300: 0.3935 - 45s/epoch - 22ms/step
Epoch 10/50
2076/2076 - 46s - loss: 3.1995 - accuracy300: 0.4218 - val_loss: 3.2968 - val_accuracy300: 0.3908 - 46s/epoch - 22ms/step
Epoch 11/50
2076/2076 - 47s - loss: 3.1946 - accuracy300: 0.4252 - val_loss: 3.2976 - val_accuracy300: 0.3937 - 47s/epoch - 23ms/step
Epoch 12/50
2076/2076 - 42s - loss: 3.1891 - accuracy300: 0.4274 - val_loss: 3.3126 - val_accuracy300: 0.3899 - 42s/epoch - 20ms/step
Epoch 13/50
2076/2076 - 45s - loss: 3.1842 - accuracy300: 0.4298 - val_loss: 3.3083 - val_accuracy300: 0.3922 - 45s/epoch - 22ms/step
Epoch 14/50
2076/2076 - 48s - loss: 3.1805 - accuracy300: 0.4316 - val_loss: 3.3177 - val_accuracy300: 0.3930 - 48s/epoch - 23ms/step
Epoch 15/50
2076/2076 - 43s - loss: 3.1757 - accuracy300: 0.4337 - val_loss: 3.3269 - val_accuracy300: 0.3891 - 43s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 43s - loss: 3.1697 - accuracy300: 0.4359 - val_loss: 3.3214 - val_accuracy300: 0.3907 - 43s/epoch - 21ms/step
Epoch 17/50
2076/2076 - 44s - loss: 3.1639 - accuracy300: 0.4383 - val_loss: 3.3372 - val_accuracy300: 0.3879 - 44s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 46s - loss: 3.1581 - accuracy300: 0.4404 - val_loss: 3.3458 - val_accuracy300: 0.3890 - 46s/epoch - 22ms/step
testing model: results/AAL/W2/deepVOL_L2/h300
Evaluating performance on  test set...
4856/4856 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1216578
{'0': {'precision': 0.3948033026912157, 'recall': 0.36800604372255535, 'f1-score': 0.3809339834522244, 'support': 444759}, '1': {'precision': 0.31304926826099466, 'recall': 0.3721314414153532, 'f1-score': 0.34004306830825215, 'support': 362595}, '2': {'precision': 0.3974669398398212, 'recall': 0.3625660370427344, 'f1-score': 0.3792151593851045, 'support': 435551}, 'accuracy': 0.36730321303719915, 'macro avg': {'precision': 0.36843983693067717, 'recall': 0.367567840726881, 'f1-score': 0.36673073704852704, 'support': 1242905}, 'weighted avg': {'precision': 0.37188646327829694, 'recall': 0.36730321303719915, 'f1-score': 0.3684024730649568, 'support': 1242905}}
[[163674 149277 131808]
 [120080 134933 107582]
 [130817 146818 157916]]
Evaluating performance on  train set...
2076/2076 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937389
{'0': {'precision': 0.39406607791441584, 'recall': 0.48025232978131793, 'f1-score': 0.43291128344182067, 'support': 178021}, '1': {'precision': 0.37286594309181575, 'recall': 0.2901276484048229, 'f1-score': 0.3263341324167942, 'support': 175247}, '2': {'precision': 0.4038597594528732, 'recall': 0.40375094026114, 'f1-score': 0.4038053425257414, 'support': 178142}, 'accuracy': 0.3919083193767524, 'macro avg': {'precision': 0.3902639268197016, 'recall': 0.3913769728157603, 'f1-score': 0.38768358612811876, 'support': 531410}, 'weighted avg': {'precision': 0.39035784131624807, 'recall': 0.3919083193767524, 'f1-score': 0.38800750573279186, 'support': 531410}}
[[85495 42784 49742]
 [67976 50844 56427]
 [63485 42732 71925]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954138
{'0': {'precision': 0.3886086398239017, 'recall': 0.49902832577586714, 'f1-score': 0.4369505246603243, 'support': 50943}, '1': {'precision': 0.3911803489834095, 'recall': 0.2596852669937501, 'f1-score': 0.31214976140951917, 'support': 49121}, '2': {'precision': 0.4005891016200295, 'recall': 0.416829200334355, 'f1-score': 0.40854782549327506, 'support': 50246}, 'accuracy': 0.3933337768611536, 'macro avg': {'precision': 0.3934593634757802, 'recall': 0.3918475977013241, 'f1-score': 0.38588270385437284, 'support': 150310}, 'weighted avg': {'precision': 0.39345392762266707, 'recall': 0.3933337768611536, 'f1-score': 0.3866713661612866, 'support': 150310}}
[[25422  9948 15573]
 [20599 12756 15766]
 [19397  9905 20944]]
training model: results/AAL/W2/deepVOL_L2/h500
Epoch 1/50
2076/2076 - 46s - loss: 3.2612 - accuracy500: 0.3911 - val_loss: 3.3964 - val_accuracy500: 0.3281 - 46s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 42s - loss: 3.2573 - accuracy500: 0.3919 - val_loss: 3.3727 - val_accuracy500: 0.3265 - 42s/epoch - 20ms/step
Epoch 3/50
2076/2076 - 44s - loss: 3.2604 - accuracy500: 0.3929 - val_loss: 3.3702 - val_accuracy500: 0.3277 - 44s/epoch - 21ms/step
Epoch 4/50
2076/2076 - 43s - loss: 3.2531 - accuracy500: 0.3982 - val_loss: 3.4043 - val_accuracy500: 0.3307 - 43s/epoch - 21ms/step
Epoch 5/50
2076/2076 - 45s - loss: 3.2473 - accuracy500: 0.4016 - val_loss: 3.3442 - val_accuracy500: 0.3374 - 45s/epoch - 22ms/step
Epoch 6/50
2076/2076 - 43s - loss: 3.2392 - accuracy500: 0.4059 - val_loss: 3.4090 - val_accuracy500: 0.3320 - 43s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 43s - loss: 3.2337 - accuracy500: 0.4091 - val_loss: 3.3890 - val_accuracy500: 0.3330 - 43s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 47s - loss: 3.2352 - accuracy500: 0.4060 - val_loss: 3.3420 - val_accuracy500: 0.3400 - 47s/epoch - 23ms/step
Epoch 9/50
2076/2076 - 46s - loss: 3.2264 - accuracy500: 0.4116 - val_loss: 3.3568 - val_accuracy500: 0.3424 - 46s/epoch - 22ms/step
Epoch 10/50
2076/2076 - 49s - loss: 3.2218 - accuracy500: 0.4138 - val_loss: 3.3784 - val_accuracy500: 0.3386 - 49s/epoch - 24ms/step
Epoch 11/50
2076/2076 - 43s - loss: 3.2155 - accuracy500: 0.4179 - val_loss: 3.3622 - val_accuracy500: 0.3389 - 43s/epoch - 20ms/step
Epoch 12/50
2076/2076 - 44s - loss: 3.2068 - accuracy500: 0.4212 - val_loss: 3.4024 - val_accuracy500: 0.3376 - 44s/epoch - 21ms/step
Epoch 13/50
2076/2076 - 44s - loss: 3.2031 - accuracy500: 0.4215 - val_loss: 3.4068 - val_accuracy500: 0.3359 - 44s/epoch - 21ms/step
Epoch 14/50
2076/2076 - 46s - loss: 3.1924 - accuracy500: 0.4273 - val_loss: 3.3910 - val_accuracy500: 0.3385 - 46s/epoch - 22ms/step
Epoch 15/50
2076/2076 - 43s - loss: 3.1850 - accuracy500: 0.4307 - val_loss: 3.4204 - val_accuracy500: 0.3387 - 43s/epoch - 21ms/step
Epoch 16/50
2076/2076 - 46s - loss: 3.1776 - accuracy500: 0.4340 - val_loss: 3.4517 - val_accuracy500: 0.3338 - 46s/epoch - 22ms/step
Epoch 17/50
2076/2076 - 43s - loss: 3.1694 - accuracy500: 0.4370 - val_loss: 3.4785 - val_accuracy500: 0.3323 - 43s/epoch - 21ms/step
Epoch 18/50
2076/2076 - 42s - loss: 3.1618 - accuracy500: 0.4404 - val_loss: 3.4952 - val_accuracy500: 0.3334 - 42s/epoch - 20ms/step
testing model: results/AAL/W2/deepVOL_L2/h500
Evaluating performance on  test set...
4856/4856 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1086776
{'0': {'precision': 0.35791722323973724, 'recall': 0.467761492863008, 'f1-score': 0.4055327850867569, 'support': 444515}, '1': {'precision': 0.2763507249484432, 'recall': 0.12160257086244887, 'f1-score': 0.16888895740871715, 'support': 360346}, '2': {'precision': 0.37146557649293016, 'recall': 0.4268931888120828, 'f1-score': 0.397255297679112, 'support': 438044}, 'accuracy': 0.3529988213097542, 'macro avg': {'precision': 0.33524450822703683, 'recall': 0.3387524175125132, 'f1-score': 0.323892346724862, 'support': 1242905}, 'weighted avg': {'precision': 0.33904419067422903, 'recall': 0.3529988213097542, 'f1-score': 0.33400715728538405, 'support': 1242905}}
[[207927  56416 180172]
 [180291  43819 136236]
 [192718  58328 186998]]
Evaluating performance on  train set...
2076/2076 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1082721
{'0': {'precision': 0.3554071343026131, 'recall': 0.48983155878542056, 'f1-score': 0.4119301021652979, 'support': 177510}, '1': {'precision': 0.32898890133387637, 'recall': 0.09205967495612136, 'f1-score': 0.14386278936190108, 'support': 175484}, '2': {'precision': 0.35770609620628135, 'recall': 0.47647632499327414, 'f1-score': 0.40863600530677385, 'support': 178416}, 'accuracy': 0.35399409119135883, 'macro avg': {'precision': 0.3473673772809236, 'recall': 0.35278918624493866, 'f1-score': 0.3214762989446576, 'support': 531410}, 'weighted avg': {'precision': 0.34745507166306755, 'recall': 0.35399409119135883, 'f1-score': 0.322302048675334, 'support': 531410}}
[[86950 16307 74253]
 [80937 16155 78392]
 [76762 16643 85011]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112528
{'0': {'precision': 0.34317714727099685, 'recall': 0.5179233107123528, 'f1-score': 0.41281930029783387, 'support': 48038}, '1': {'precision': 0.37529767651412754, 'recall': 0.10641093490519554, 'f1-score': 0.16580885489237068, 'support': 54797}, '2': {'precision': 0.33326910106946717, 'recall': 0.4371563981042654, 'f1-score': 0.37820845748025034, 'support': 47475}, 'accuracy': 0.34239238906260394, 'macro avg': {'precision': 0.3505813082848639, 'recall': 0.3538302145739379, 'f1-score': 0.3189455375568183, 'support': 150310}, 'weighted avg': {'precision': 0.35175757536971425, 'recall': 0.34239238906260394, 'f1-score': 0.3118374551800909, 'support': 150310}}
[[24880  4908 18250]
 [25696  5831 23270]
 [21923  4798 20754]]
training model: results/AAL/W2/deepVOL_L2/h1000
Epoch 1/50
2076/2076 - 46s - loss: 3.2403 - accuracy1000: 0.4053 - val_loss: 3.2884 - val_accuracy1000: 0.3713 - 46s/epoch - 22ms/step
Epoch 2/50
2076/2076 - 45s - loss: 3.2568 - accuracy1000: 0.3850 - val_loss: 3.2862 - val_accuracy1000: 0.3709 - 45s/epoch - 22ms/step
Epoch 3/50
2076/2076 - 46s - loss: 3.2475 - accuracy1000: 0.3927 - val_loss: 3.2860 - val_accuracy1000: 0.3752 - 46s/epoch - 22ms/step
Epoch 4/50
2076/2076 - 46s - loss: 3.2334 - accuracy1000: 0.4033 - val_loss: 3.3090 - val_accuracy1000: 0.3720 - 46s/epoch - 22ms/step
Epoch 5/50
2076/2076 - 43s - loss: 3.2274 - accuracy1000: 0.4066 - val_loss: 3.3256 - val_accuracy1000: 0.3620 - 43s/epoch - 21ms/step
Epoch 6/50
2076/2076 - 43s - loss: 3.2187 - accuracy1000: 0.4171 - val_loss: 3.2996 - val_accuracy1000: 0.3654 - 43s/epoch - 21ms/step
Epoch 7/50
2076/2076 - 44s - loss: 3.2189 - accuracy1000: 0.4157 - val_loss: 3.3062 - val_accuracy1000: 0.3604 - 44s/epoch - 21ms/step
Epoch 8/50
2076/2076 - 45s - loss: 3.2117 - accuracy1000: 0.4200 - val_loss: 3.3220 - val_accuracy1000: 0.3627 - 45s/epoch - 22ms/step
Epoch 9/50
2076/2076 - 45s - loss: 3.2043 - accuracy1000: 0.4230 - val_loss: 3.3527 - val_accuracy1000: 0.3571 - 45s/epoch - 21ms/step
Epoch 10/50
2076/2076 - 43s - loss: 3.1927 - accuracy1000: 0.4298 - val_loss: 3.3366 - val_accuracy1000: 0.3506 - 43s/epoch - 21ms/step
Epoch 11/50
2076/2076 - 43s - loss: 3.1881 - accuracy1000: 0.4293 - val_loss: 3.3756 - val_accuracy1000: 0.3457 - 43s/epoch - 21ms/step
Epoch 12/50
2076/2076 - 47s - loss: 3.1731 - accuracy1000: 0.4373 - val_loss: 3.3895 - val_accuracy1000: 0.3397 - 47s/epoch - 23ms/step
Epoch 13/50
2076/2076 - 42s - loss: 3.1625 - accuracy1000: 0.4418 - val_loss: 3.3881 - val_accuracy1000: 0.3472 - 42s/epoch - 20ms/step
testing model: results/AAL/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
4856/4856 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027925
{'0': {'precision': 0.33812065454034695, 'recall': 0.0233842432602429, 'f1-score': 0.04374322829476821, 'support': 411773}, '1': {'precision': 0.35609170471250684, 'recall': 0.9152428142025174, 'f1-score': 0.5127059307937039, 'support': 425840}, '2': {'precision': 0.38498423870440485, 'recall': 0.11390552984021397, 'f1-score': 0.17579768700281415, 'support': 405292}, 'accuracy': 0.3584674613103978, 'macro avg': {'precision': 0.35973219931908623, 'recall': 0.3508441957676581, 'f1-score': 0.24408228203042873, 'support': 1242905}, 'weighted avg': {'precision': 0.35955932262707274, 'recall': 0.3584674613103978, 'f1-score': 0.2474785845052977, 'support': 1242905}}
[[  9629 356972  45172]
 [  7516 389747  28577]
 [ 11333 347794  46165]]
Evaluating performance on  train set...
2076/2076 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027884
{'0': {'precision': 0.4026615969581749, 'recall': 0.018038427471554132, 'f1-score': 0.034529981414457595, 'support': 176124}, '1': {'precision': 0.3376350133841619, 'recall': 0.9238275461115798, 'f1-score': 0.49453156345873084, 'support': 175444}, '2': {'precision': 0.39330649798734907, 'recall': 0.09507790171372649, 'f1-score': 0.15313657267471797, 'support': 179842}, 'accuracy': 0.34315500272858995, 'macro avg': {'precision': 0.37786770277656195, 'recall': 0.34564795843228685, 'f1-score': 0.22739937251596878, 'support': 531410}, 'weighted avg': {'precision': 0.3780272023519944, 'recall': 0.34315500272858995, 'f1-score': 0.22653796798904824, 'support': 531410}}
[[  3177 157753  15194]
 [  2182 162080  11182]
 [  2531 160212  17099]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949987
{'0': {'precision': 0.28250591016548465, 'recall': 0.005067101999279157, 'f1-score': 0.009955637014975111, 'support': 47167}, '1': {'precision': 0.3774653203736907, 'recall': 0.9327521569893631, 'f1-score': 0.5374399255852411, 'support': 55749}, '2': {'precision': 0.3452106297530548, 'recall': 0.08524285774570621, 'f1-score': 0.13672436841125607, 'support': 47394}, 'accuracy': 0.37441953296520525, 'macro avg': {'precision': 0.33506062009741006, 'recall': 0.3410207055781162, 'f1-score': 0.22803997700382408, 'support': 150310}, 'weighted avg': {'precision': 0.33749705938929264, 'recall': 0.37441953296520525, 'f1-score': 0.24556736517211103, 'support': 150310}}
[[  239 42752  4176]
 [  262 52000  3487]
 [  345 43009  4040]]
training model: results/AAL/W2/deepVOL_L3/h10
Epoch 1/50
2076/2076 - 76s - loss: 3.0374 - accuracy10: 0.3948 - val_loss: 3.1292 - val_accuracy10: 0.5702 - 76s/epoch - 37ms/step
Epoch 2/50
2076/2076 - 74s - loss: 2.6432 - accuracy10: 0.4944 - val_loss: 2.5747 - val_accuracy10: 0.5590 - 74s/epoch - 36ms/step
Epoch 3/50
2076/2076 - 75s - loss: 2.4031 - accuracy10: 0.5977 - val_loss: 2.3983 - val_accuracy10: 0.6646 - 75s/epoch - 36ms/step
Epoch 4/50
2076/2076 - 68s - loss: 2.3247 - accuracy10: 0.6203 - val_loss: 2.3820 - val_accuracy10: 0.6366 - 68s/epoch - 33ms/step
Epoch 5/50
2076/2076 - 68s - loss: 2.2779 - accuracy10: 0.6311 - val_loss: 2.3669 - val_accuracy10: 0.6206 - 68s/epoch - 33ms/step
Epoch 6/50
2076/2076 - 67s - loss: 2.2472 - accuracy10: 0.6370 - val_loss: 2.3078 - val_accuracy10: 0.6858 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 68s - loss: 2.2182 - accuracy10: 0.6423 - val_loss: 2.2748 - val_accuracy10: 0.6665 - 68s/epoch - 33ms/step
Epoch 8/50
2076/2076 - 67s - loss: 2.1957 - accuracy10: 0.6465 - val_loss: 2.2699 - val_accuracy10: 0.6648 - 67s/epoch - 32ms/step
Epoch 9/50
2076/2076 - 68s - loss: 2.1779 - accuracy10: 0.6499 - val_loss: 2.2257 - val_accuracy10: 0.6721 - 68s/epoch - 33ms/step
Epoch 10/50
2076/2076 - 67s - loss: 2.1621 - accuracy10: 0.6534 - val_loss: 2.2371 - val_accuracy10: 0.6701 - 67s/epoch - 32ms/step
Epoch 11/50
2076/2076 - 67s - loss: 2.1509 - accuracy10: 0.6554 - val_loss: 2.2218 - val_accuracy10: 0.6703 - 67s/epoch - 32ms/step
Epoch 12/50
2076/2076 - 67s - loss: 2.1425 - accuracy10: 0.6568 - val_loss: 2.2234 - val_accuracy10: 0.6872 - 67s/epoch - 32ms/step
Epoch 13/50
2076/2076 - 68s - loss: 2.1321 - accuracy10: 0.6588 - val_loss: 2.2142 - val_accuracy10: 0.6826 - 68s/epoch - 33ms/step
Epoch 14/50
2076/2076 - 67s - loss: 2.1257 - accuracy10: 0.6594 - val_loss: 2.2248 - val_accuracy10: 0.6790 - 67s/epoch - 32ms/step
Epoch 15/50
2076/2076 - 67s - loss: 2.1176 - accuracy10: 0.6607 - val_loss: 2.2373 - val_accuracy10: 0.6901 - 67s/epoch - 32ms/step
Epoch 16/50
2076/2076 - 67s - loss: 2.1112 - accuracy10: 0.6622 - val_loss: 2.2191 - val_accuracy10: 0.6922 - 67s/epoch - 32ms/step
Epoch 17/50
2076/2076 - 67s - loss: 2.1056 - accuracy10: 0.6629 - val_loss: 2.2435 - val_accuracy10: 0.6986 - 67s/epoch - 32ms/step
Epoch 18/50
2076/2076 - 67s - loss: 2.1008 - accuracy10: 0.6635 - val_loss: 2.2233 - val_accuracy10: 0.6804 - 67s/epoch - 32ms/step
Epoch 19/50
2076/2076 - 68s - loss: 2.0965 - accuracy10: 0.6643 - val_loss: 2.2457 - val_accuracy10: 0.6895 - 68s/epoch - 33ms/step
Epoch 20/50
2076/2076 - 66s - loss: 2.0929 - accuracy10: 0.6641 - val_loss: 2.2093 - val_accuracy10: 0.6828 - 66s/epoch - 32ms/step
Epoch 21/50
2076/2076 - 67s - loss: 2.0862 - accuracy10: 0.6648 - val_loss: 2.2170 - val_accuracy10: 0.6911 - 67s/epoch - 32ms/step
Epoch 22/50
2076/2076 - 68s - loss: 2.0822 - accuracy10: 0.6655 - val_loss: 2.2003 - val_accuracy10: 0.6819 - 68s/epoch - 33ms/step
Epoch 23/50
2076/2076 - 68s - loss: 2.0783 - accuracy10: 0.6657 - val_loss: 2.2010 - val_accuracy10: 0.6818 - 68s/epoch - 33ms/step
Epoch 24/50
2076/2076 - 67s - loss: 2.0741 - accuracy10: 0.6663 - val_loss: 2.2116 - val_accuracy10: 0.6886 - 67s/epoch - 32ms/step
Epoch 25/50
2076/2076 - 67s - loss: 2.0707 - accuracy10: 0.6671 - val_loss: 2.2104 - val_accuracy10: 0.6798 - 67s/epoch - 32ms/step
Epoch 26/50
2076/2076 - 67s - loss: 2.0661 - accuracy10: 0.6673 - val_loss: 2.2153 - val_accuracy10: 0.6795 - 67s/epoch - 32ms/step
Epoch 27/50
2076/2076 - 67s - loss: 2.0631 - accuracy10: 0.6676 - val_loss: 2.2231 - val_accuracy10: 0.6813 - 67s/epoch - 32ms/step
Epoch 28/50
2076/2076 - 67s - loss: 2.0596 - accuracy10: 0.6674 - val_loss: 2.2018 - val_accuracy10: 0.6687 - 67s/epoch - 32ms/step
Epoch 29/50
2076/2076 - 68s - loss: 2.0573 - accuracy10: 0.6677 - val_loss: 2.1974 - val_accuracy10: 0.6769 - 68s/epoch - 33ms/step
Epoch 30/50
2076/2076 - 68s - loss: 2.0540 - accuracy10: 0.6681 - val_loss: 2.2091 - val_accuracy10: 0.6791 - 68s/epoch - 33ms/step
Epoch 31/50
2076/2076 - 68s - loss: 2.0506 - accuracy10: 0.6680 - val_loss: 2.2000 - val_accuracy10: 0.6809 - 68s/epoch - 33ms/step
Epoch 32/50
2076/2076 - 67s - loss: 2.0480 - accuracy10: 0.6677 - val_loss: 2.2122 - val_accuracy10: 0.6796 - 67s/epoch - 32ms/step
Epoch 33/50
2076/2076 - 68s - loss: 2.0444 - accuracy10: 0.6692 - val_loss: 2.2184 - val_accuracy10: 0.6818 - 68s/epoch - 33ms/step
Epoch 34/50
2076/2076 - 67s - loss: 2.0432 - accuracy10: 0.6685 - val_loss: 2.2195 - val_accuracy10: 0.6708 - 67s/epoch - 32ms/step
Epoch 35/50
2076/2076 - 67s - loss: 2.0390 - accuracy10: 0.6686 - val_loss: 2.1999 - val_accuracy10: 0.6805 - 67s/epoch - 32ms/step
Epoch 36/50
2076/2076 - 67s - loss: 2.0352 - accuracy10: 0.6696 - val_loss: 2.2062 - val_accuracy10: 0.6796 - 67s/epoch - 32ms/step
Epoch 37/50
2076/2076 - 67s - loss: 2.0328 - accuracy10: 0.6697 - val_loss: 2.2047 - val_accuracy10: 0.6764 - 67s/epoch - 32ms/step
Epoch 38/50
2076/2076 - 67s - loss: 2.0310 - accuracy10: 0.6694 - val_loss: 2.2170 - val_accuracy10: 0.6811 - 67s/epoch - 32ms/step
Epoch 39/50
2076/2076 - 67s - loss: 2.0287 - accuracy10: 0.6699 - val_loss: 2.2040 - val_accuracy10: 0.6759 - 67s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h10
Evaluating performance on  test set...
4856/4856 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.902254
{'0': {'precision': 0.41716768139860055, 'recall': 0.5777847248160839, 'f1-score': 0.484511846985866, 'support': 246308}, '1': {'precision': 0.87487511452631, 'recall': 0.4987689707125271, 'f1-score': 0.6353327838898261, 'support': 761964}, '2': {'precision': 0.3499976463842042, 'recall': 0.6971610983962188, 'f1-score': 0.466032002894591, 'support': 234633}, 'accuracy': 0.5518796690012511, 'macro avg': {'precision': 0.5473468141030383, 'recall': 0.59123826464161, 'f1-score': 0.5286255445900944, 'support': 1242905}, 'weighted avg': {'precision': 0.6850854062047516, 'recall': 0.5518796690012511, 'f1-score': 0.573484168368772, 'support': 1242905}}
[[142313  33657  70338]
 [148469 380044 233451]
 [ 50359  20697 163577]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70586175
{'0': {'precision': 0.43028551588922476, 'recall': 0.5789003681925592, 'f1-score': 0.49365027296797015, 'support': 72788}, '1': {'precision': 0.9063600093874677, 'recall': 0.6637795214074963, 'f1-score': 0.7663308915603244, 'support': 384001}, '2': {'precision': 0.3635653110550652, 'recall': 0.7418153066831052, 'f1-score': 0.4879736597363329, 'support': 74621}, 'accuracy': 0.6631113452889482, 'macro avg': {'precision': 0.5667369454439192, 'recall': 0.6614983987610535, 'f1-score': 0.5826516080882091, 'support': 531410}, 'weighted avg': {'precision': 0.7649317460559303, 'recall': 0.6631113452889482, 'f1-score': 0.6898942948420873, 'support': 531410}}
[[ 42137  15760  14891]
 [ 47099 254892  82010]
 [  8692  10574  55355]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68759483
{'0': {'precision': 0.4391040418011372, 'recall': 0.5653722483304476, 'f1-score': 0.4943018402785286, 'support': 20215}, '1': {'precision': 0.9002678411999285, 'recall': 0.6874494368744943, 'f1-score': 0.7795954972785749, 'support': 110011}, '2': {'precision': 0.3635325371800283, 'recall': 0.7290380402310297, 'f1-score': 0.4851476947035338, 'support': 20084}, 'accuracy': 0.6765883840063868, 'macro avg': {'precision': 0.5676348067270314, 'recall': 0.6606199084786573, 'f1-score': 0.5863483440868791, 'support': 150310}, 'weighted avg': {'precision': 0.7665294468763156, 'recall': 0.6765883840063868, 'f1-score': 0.70188342926465, 'support': 150310}}
[[11429  5059  3727]
 [12476 75627 21908]
 [ 2123  3319 14642]]
training model: results/AAL/W2/deepVOL_L3/h20
Epoch 1/50
2076/2076 - 71s - loss: 3.0679 - accuracy20: 0.4232 - val_loss: 3.2077 - val_accuracy20: 0.4595 - 71s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 69s - loss: 2.8160 - accuracy20: 0.4530 - val_loss: 2.6898 - val_accuracy20: 0.5545 - 69s/epoch - 33ms/step
Epoch 3/50
2076/2076 - 66s - loss: 2.5565 - accuracy20: 0.5796 - val_loss: 2.6515 - val_accuracy20: 0.6019 - 66s/epoch - 32ms/step
Epoch 4/50
2076/2076 - 68s - loss: 2.4696 - accuracy20: 0.6014 - val_loss: 2.5898 - val_accuracy20: 0.6275 - 68s/epoch - 33ms/step
Epoch 5/50
2076/2076 - 66s - loss: 2.4262 - accuracy20: 0.6123 - val_loss: 2.5925 - val_accuracy20: 0.6461 - 66s/epoch - 32ms/step
Epoch 6/50
2076/2076 - 71s - loss: 2.3947 - accuracy20: 0.6196 - val_loss: 2.5974 - val_accuracy20: 0.6600 - 71s/epoch - 34ms/step
Epoch 7/50
2076/2076 - 67s - loss: 2.3697 - accuracy20: 0.6233 - val_loss: 2.5641 - val_accuracy20: 0.6596 - 67s/epoch - 32ms/step
Epoch 8/50
2076/2076 - 69s - loss: 2.3460 - accuracy20: 0.6274 - val_loss: 2.4849 - val_accuracy20: 0.6490 - 69s/epoch - 33ms/step
Epoch 9/50
2076/2076 - 66s - loss: 2.3257 - accuracy20: 0.6308 - val_loss: 2.4840 - val_accuracy20: 0.6561 - 66s/epoch - 32ms/step
Epoch 10/50
2076/2076 - 69s - loss: 2.3100 - accuracy20: 0.6337 - val_loss: 2.4656 - val_accuracy20: 0.6549 - 69s/epoch - 33ms/step
Epoch 11/50
2076/2076 - 67s - loss: 2.2984 - accuracy20: 0.6358 - val_loss: 2.4529 - val_accuracy20: 0.6597 - 67s/epoch - 32ms/step
Epoch 12/50
2076/2076 - 69s - loss: 2.2889 - accuracy20: 0.6380 - val_loss: 2.4330 - val_accuracy20: 0.6702 - 69s/epoch - 33ms/step
Epoch 13/50
2076/2076 - 67s - loss: 2.2799 - accuracy20: 0.6397 - val_loss: 2.4323 - val_accuracy20: 0.6593 - 67s/epoch - 32ms/step
Epoch 14/50
2076/2076 - 68s - loss: 2.2723 - accuracy20: 0.6407 - val_loss: 2.4402 - val_accuracy20: 0.6430 - 68s/epoch - 33ms/step
Epoch 15/50
2076/2076 - 67s - loss: 2.2645 - accuracy20: 0.6422 - val_loss: 2.4017 - val_accuracy20: 0.6452 - 67s/epoch - 32ms/step
Epoch 16/50
2076/2076 - 69s - loss: 2.2579 - accuracy20: 0.6434 - val_loss: 2.3907 - val_accuracy20: 0.6481 - 69s/epoch - 33ms/step
Epoch 17/50
2076/2076 - 66s - loss: 2.2533 - accuracy20: 0.6442 - val_loss: 2.4205 - val_accuracy20: 0.6440 - 66s/epoch - 32ms/step
Epoch 18/50
2076/2076 - 75s - loss: 2.2480 - accuracy20: 0.6451 - val_loss: 2.3921 - val_accuracy20: 0.6397 - 75s/epoch - 36ms/step
Epoch 19/50
2076/2076 - 67s - loss: 2.2417 - accuracy20: 0.6454 - val_loss: 2.3860 - val_accuracy20: 0.6427 - 67s/epoch - 32ms/step
Epoch 20/50
2076/2076 - 70s - loss: 2.2378 - accuracy20: 0.6463 - val_loss: 2.3881 - val_accuracy20: 0.6486 - 70s/epoch - 34ms/step
Epoch 21/50
2076/2076 - 67s - loss: 2.2325 - accuracy20: 0.6473 - val_loss: 2.4059 - val_accuracy20: 0.6342 - 67s/epoch - 32ms/step
Epoch 22/50
2076/2076 - 68s - loss: 2.2277 - accuracy20: 0.6482 - val_loss: 2.3859 - val_accuracy20: 0.6256 - 68s/epoch - 33ms/step
Epoch 23/50
2076/2076 - 67s - loss: 2.2232 - accuracy20: 0.6485 - val_loss: 2.3780 - val_accuracy20: 0.6285 - 67s/epoch - 32ms/step
Epoch 24/50
2076/2076 - 68s - loss: 2.2203 - accuracy20: 0.6483 - val_loss: 2.3900 - val_accuracy20: 0.6398 - 68s/epoch - 33ms/step
Epoch 25/50
2076/2076 - 73s - loss: 2.2157 - accuracy20: 0.6494 - val_loss: 2.3796 - val_accuracy20: 0.6215 - 73s/epoch - 35ms/step
Epoch 26/50
2076/2076 - 76s - loss: 2.2124 - accuracy20: 0.6495 - val_loss: 2.4226 - val_accuracy20: 0.6255 - 76s/epoch - 37ms/step
Epoch 27/50
2076/2076 - 66s - loss: 2.2088 - accuracy20: 0.6498 - val_loss: 2.4380 - val_accuracy20: 0.6246 - 66s/epoch - 32ms/step
Epoch 28/50
2076/2076 - 68s - loss: 2.2049 - accuracy20: 0.6499 - val_loss: 2.4143 - val_accuracy20: 0.6226 - 68s/epoch - 33ms/step
Epoch 29/50
2076/2076 - 68s - loss: 2.2021 - accuracy20: 0.6502 - val_loss: 2.4177 - val_accuracy20: 0.6233 - 68s/epoch - 33ms/step
Epoch 30/50
2076/2076 - 69s - loss: 2.1989 - accuracy20: 0.6506 - val_loss: 2.3865 - val_accuracy20: 0.6293 - 69s/epoch - 33ms/step
Epoch 31/50
2076/2076 - 66s - loss: 2.1959 - accuracy20: 0.6506 - val_loss: 2.4691 - val_accuracy20: 0.6144 - 66s/epoch - 32ms/step
Epoch 32/50
2076/2076 - 68s - loss: 2.1924 - accuracy20: 0.6514 - val_loss: 2.4160 - val_accuracy20: 0.6039 - 68s/epoch - 33ms/step
Epoch 33/50
2076/2076 - 73s - loss: 2.1901 - accuracy20: 0.6516 - val_loss: 2.4062 - val_accuracy20: 0.6140 - 73s/epoch - 35ms/step
testing model: results/AAL/W2/deepVOL_L3/h20
Evaluating performance on  test set...
4856/4856 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9758587
{'0': {'precision': 0.4852169577190259, 'recall': 0.4175883121696218, 'f1-score': 0.44886962264843244, 'support': 307602}, '1': {'precision': 0.8146267126374617, 'recall': 0.45371523779341766, 'f1-score': 0.5828216160659405, 'support': 637402}, '2': {'precision': 0.38875712488446135, 'recall': 0.8132265417034518, 'f1-score': 0.5260431086053271, 'support': 297901}, 'accuracy': 0.5309424292282998, 'macro avg': {'precision': 0.5628669317469829, 'recall': 0.5615100305554971, 'f1-score': 0.5192447824399, 'support': 1242905}, 'weighted avg': {'precision': 0.6310293536328497, 'recall': 0.5309424292282998, 'f1-score': 0.5360615859508179, 'support': 1242905}}
[[128451  43195 135956]
 [103252 289199 244951]
 [ 33026  22614 242261]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7918931
{'0': {'precision': 0.489906445012267, 'recall': 0.499662558533116, 'f1-score': 0.4947364092441812, 'support': 96313}, '1': {'precision': 0.8526331594159379, 'recall': 0.6070157102263448, 'f1-score': 0.7091592143694628, 'support': 336787}, '2': {'precision': 0.3943849852644641, 'recall': 0.7758925846811108, 'f1-score': 0.5229535170711641, 'support': 98310}, 'accuracy': 0.6188009258388062, 'macro avg': {'precision': 0.5789748632308896, 'recall': 0.6275236178135238, 'f1-score': 0.5756163802282693, 'support': 531410}, 'weighted avg': {'precision': 0.7021172187200683, 'recall': 0.6188009258388062, 'f1-score': 0.6358493674877199, 'support': 531410}}
[[ 48124  22087  26102]
 [ 41322 204435  91030]
 [  8785  13247  76278]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77607703
{'0': {'precision': 0.5035528942115769, 'recall': 0.4681561757719715, 'f1-score': 0.4852098319036812, 'support': 26944}, '1': {'precision': 0.8372124658223715, 'recall': 0.6371749213185357, 'f1-score': 0.7236236442197466, 'support': 96592}, '2': {'precision': 0.39461224805302725, 'recall': 0.7626802121461119, 'f1-score': 0.5201156378548414, 'support': 26774}, 'accuracy': 0.6292329186348213, 'macro avg': {'precision': 0.5784592026956585, 'recall': 0.6226704364122063, 'f1-score': 0.5763163713260897, 'support': 150310}, 'weighted avg': {'precision': 0.6985636618303703, 'recall': 0.6292329186348213, 'f1-score': 0.644636583335853, 'support': 150310}}
[[12614  7650  6680]
 [10399 61546 24647]
 [ 2037  4317 20420]]
training model: results/AAL/W2/deepVOL_L3/h30
Epoch 1/50
2076/2076 - 71s - loss: 3.1148 - accuracy30: 0.4165 - val_loss: 3.1997 - val_accuracy30: 0.4720 - 71s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 67s - loss: 2.9834 - accuracy30: 0.4092 - val_loss: 3.3256 - val_accuracy30: 0.4256 - 67s/epoch - 32ms/step
Epoch 3/50
2076/2076 - 68s - loss: 2.9430 - accuracy30: 0.4095 - val_loss: 3.3179 - val_accuracy30: 0.4823 - 68s/epoch - 33ms/step
Epoch 4/50
2076/2076 - 70s - loss: 2.7850 - accuracy30: 0.5105 - val_loss: 2.8884 - val_accuracy30: 0.5540 - 70s/epoch - 34ms/step
Epoch 5/50
2076/2076 - 66s - loss: 2.6000 - accuracy30: 0.5790 - val_loss: 2.8407 - val_accuracy30: 0.5957 - 66s/epoch - 32ms/step
Epoch 6/50
2076/2076 - 67s - loss: 2.5347 - accuracy30: 0.5920 - val_loss: 2.7666 - val_accuracy30: 0.6110 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 68s - loss: 2.4972 - accuracy30: 0.5999 - val_loss: 2.7178 - val_accuracy30: 0.6205 - 68s/epoch - 33ms/step
Epoch 8/50
2076/2076 - 68s - loss: 2.4720 - accuracy30: 0.6042 - val_loss: 2.7237 - val_accuracy30: 0.6188 - 68s/epoch - 33ms/step
Epoch 9/50
2076/2076 - 67s - loss: 2.4515 - accuracy30: 0.6076 - val_loss: 2.6912 - val_accuracy30: 0.6315 - 67s/epoch - 32ms/step
Epoch 10/50
2076/2076 - 68s - loss: 2.4376 - accuracy30: 0.6104 - val_loss: 2.6403 - val_accuracy30: 0.6193 - 68s/epoch - 33ms/step
Epoch 11/50
2076/2076 - 67s - loss: 2.4240 - accuracy30: 0.6119 - val_loss: 2.6876 - val_accuracy30: 0.6249 - 67s/epoch - 32ms/step
Epoch 12/50
2076/2076 - 68s - loss: 2.4146 - accuracy30: 0.6139 - val_loss: 2.6519 - val_accuracy30: 0.6200 - 68s/epoch - 33ms/step
Epoch 13/50
2076/2076 - 68s - loss: 2.4052 - accuracy30: 0.6152 - val_loss: 2.6509 - val_accuracy30: 0.6206 - 68s/epoch - 33ms/step
Epoch 14/50
2076/2076 - 68s - loss: 2.3980 - accuracy30: 0.6168 - val_loss: 2.6444 - val_accuracy30: 0.6169 - 68s/epoch - 33ms/step
Epoch 15/50
2076/2076 - 68s - loss: 2.3915 - accuracy30: 0.6177 - val_loss: 2.6132 - val_accuracy30: 0.6120 - 68s/epoch - 33ms/step
Epoch 16/50
2076/2076 - 67s - loss: 2.3836 - accuracy30: 0.6186 - val_loss: 2.6428 - val_accuracy30: 0.6188 - 67s/epoch - 32ms/step
Epoch 17/50
2076/2076 - 69s - loss: 2.3779 - accuracy30: 0.6199 - val_loss: 2.6506 - val_accuracy30: 0.6049 - 69s/epoch - 33ms/step
Epoch 18/50
2076/2076 - 70s - loss: 2.3708 - accuracy30: 0.6216 - val_loss: 2.6164 - val_accuracy30: 0.6066 - 70s/epoch - 33ms/step
Epoch 19/50
2076/2076 - 68s - loss: 2.3679 - accuracy30: 0.6221 - val_loss: 2.6396 - val_accuracy30: 0.6095 - 68s/epoch - 33ms/step
Epoch 20/50
2076/2076 - 68s - loss: 2.3620 - accuracy30: 0.6228 - val_loss: 2.6447 - val_accuracy30: 0.5935 - 68s/epoch - 33ms/step
Epoch 21/50
2076/2076 - 68s - loss: 2.3577 - accuracy30: 0.6232 - val_loss: 2.6185 - val_accuracy30: 0.6042 - 68s/epoch - 33ms/step
Epoch 22/50
2076/2076 - 69s - loss: 2.3532 - accuracy30: 0.6242 - val_loss: 2.6339 - val_accuracy30: 0.6103 - 69s/epoch - 33ms/step
Epoch 23/50
2076/2076 - 67s - loss: 2.3503 - accuracy30: 0.6241 - val_loss: 2.6346 - val_accuracy30: 0.5996 - 67s/epoch - 32ms/step
Epoch 24/50
2076/2076 - 69s - loss: 2.3469 - accuracy30: 0.6255 - val_loss: 2.6474 - val_accuracy30: 0.6021 - 69s/epoch - 33ms/step
Epoch 25/50
2076/2076 - 67s - loss: 2.3427 - accuracy30: 0.6258 - val_loss: 2.6478 - val_accuracy30: 0.5958 - 67s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h30
Evaluating performance on  test set...
4856/4856 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.989398
{'0': {'precision': 0.5274092075064128, 'recall': 0.279947371740115, 'f1-score': 0.3657536837335241, 'support': 348862}, '1': {'precision': 0.7059708664818922, 'recall': 0.5239774761954513, 'f1-score': 0.6015095432080895, 'support': 555146}, '2': {'precision': 0.4173171275646744, 'recall': 0.7951088383786225, 'f1-score': 0.547353068729922, 'support': 338897}, 'accuracy': 0.5294105341920742, 'macro avg': {'precision': 0.5502324005176599, 'recall': 0.5330112287713963, 'f1-score': 0.5048720985571785, 'support': 1242905}, 'weighted avg': {'precision': 0.5771458447534962, 'recall': 0.5294105341920742, 'f1-score': 0.5205703504465805, 'support': 1242905}}
[[ 97663  75897 175302]
 [ 63328 290884 200934]
 [ 24184  45253 269460]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8285055
{'0': {'precision': 0.5556087896720059, 'recall': 0.3793676616211628, 'f1-score': 0.4508776815127331, 'support': 113104}, '1': {'precision': 0.7660966224882428, 'recall': 0.6502200288973484, 'f1-score': 0.7034180774830844, 'support': 303142}, '2': {'precision': 0.4278059656767889, 'recall': 0.7314091209058387, 'f1-score': 0.5398500914896958, 'support': 115164}, 'accuracy': 0.6101672907924202, 'macro avg': {'precision': 0.5831704592790126, 'recall': 0.58699893714145, 'f1-score': 0.5647152834951711, 'support': 531410}, 'weighted avg': {'precision': 0.6479845789740412, 'recall': 0.6101672907924202, 'f1-score': 0.6142205228928937, 'support': 531410}}
[[ 42908  36647  33549]
 [ 26921 197109  79112]
 [  7398  23534  84232]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82317597
{'0': {'precision': 0.5625431246919664, 'recall': 0.35785051417105596, 'f1-score': 0.4374353274824666, 'support': 31896}, '1': {'precision': 0.7494241039830126, 'recall': 0.671269826632239, 'f1-score': 0.7081972795320358, 'support': 86752}, '2': {'precision': 0.42710503679632994, 'recall': 0.7057039984839871, 'f1-score': 0.5321457065625111, 'support': 31662}, 'accuracy': 0.6120151686514537, 'macro avg': {'precision': 0.579690755157103, 'recall': 0.5782747797624274, 'f1-score': 0.5592594378590046, 'support': 150310}, 'weighted avg': {'precision': 0.641872896340594, 'recall': 0.6120151686514537, 'f1-score': 0.6136568755274177, 'support': 150310}}
[[11414 12021  8461]
 [ 7008 58234 21510]
 [ 1868  7450 22344]]
training model: results/AAL/W2/deepVOL_L3/h50
Epoch 1/50
2076/2076 - 71s - loss: 3.1711 - accuracy50: 0.4090 - val_loss: 3.2055 - val_accuracy50: 0.4451 - 71s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 68s - loss: 3.0782 - accuracy50: 0.4145 - val_loss: 3.2518 - val_accuracy50: 0.4072 - 68s/epoch - 33ms/step
Epoch 3/50
2076/2076 - 67s - loss: 3.0458 - accuracy50: 0.4242 - val_loss: 3.1938 - val_accuracy50: 0.4499 - 67s/epoch - 32ms/step
Epoch 4/50
2076/2076 - 66s - loss: 2.9217 - accuracy50: 0.5027 - val_loss: 3.0675 - val_accuracy50: 0.5008 - 66s/epoch - 32ms/step
Epoch 5/50
2076/2076 - 66s - loss: 2.8095 - accuracy50: 0.5400 - val_loss: 2.9634 - val_accuracy50: 0.5383 - 66s/epoch - 32ms/step
Epoch 6/50
2076/2076 - 67s - loss: 2.7410 - accuracy50: 0.5549 - val_loss: 2.9172 - val_accuracy50: 0.5413 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 67s - loss: 2.7038 - accuracy50: 0.5623 - val_loss: 2.8837 - val_accuracy50: 0.5407 - 67s/epoch - 32ms/step
Epoch 8/50
2076/2076 - 73s - loss: 2.6814 - accuracy50: 0.5673 - val_loss: 2.9762 - val_accuracy50: 0.5595 - 73s/epoch - 35ms/step
Epoch 9/50
2076/2076 - 71s - loss: 2.6665 - accuracy50: 0.5701 - val_loss: 2.9066 - val_accuracy50: 0.5402 - 71s/epoch - 34ms/step
Epoch 10/50
2076/2076 - 67s - loss: 2.6553 - accuracy50: 0.5713 - val_loss: 2.9040 - val_accuracy50: 0.5439 - 67s/epoch - 32ms/step
Epoch 11/50
2076/2076 - 73s - loss: 2.6421 - accuracy50: 0.5730 - val_loss: 2.8663 - val_accuracy50: 0.5495 - 73s/epoch - 35ms/step
Epoch 12/50
2076/2076 - 73s - loss: 2.6328 - accuracy50: 0.5753 - val_loss: 2.8787 - val_accuracy50: 0.5485 - 73s/epoch - 35ms/step
Epoch 13/50
2076/2076 - 67s - loss: 2.6245 - accuracy50: 0.5765 - val_loss: 2.8907 - val_accuracy50: 0.5616 - 67s/epoch - 32ms/step
Epoch 14/50
2076/2076 - 68s - loss: 2.6173 - accuracy50: 0.5772 - val_loss: 2.8729 - val_accuracy50: 0.5617 - 68s/epoch - 33ms/step
Epoch 15/50
2076/2076 - 67s - loss: 2.6127 - accuracy50: 0.5780 - val_loss: 2.8523 - val_accuracy50: 0.5603 - 67s/epoch - 32ms/step
Epoch 16/50
2076/2076 - 66s - loss: 2.6058 - accuracy50: 0.5794 - val_loss: 2.8965 - val_accuracy50: 0.5663 - 66s/epoch - 32ms/step
Epoch 17/50
2076/2076 - 68s - loss: 2.6018 - accuracy50: 0.5800 - val_loss: 2.8560 - val_accuracy50: 0.5650 - 68s/epoch - 33ms/step
Epoch 18/50
2076/2076 - 68s - loss: 2.5965 - accuracy50: 0.5807 - val_loss: 2.8586 - val_accuracy50: 0.5603 - 68s/epoch - 33ms/step
Epoch 19/50
2076/2076 - 66s - loss: 2.5922 - accuracy50: 0.5815 - val_loss: 2.8328 - val_accuracy50: 0.5675 - 66s/epoch - 32ms/step
Epoch 20/50
2076/2076 - 66s - loss: 2.5886 - accuracy50: 0.5818 - val_loss: 2.8359 - val_accuracy50: 0.5625 - 66s/epoch - 32ms/step
Epoch 21/50
2076/2076 - 67s - loss: 2.5825 - accuracy50: 0.5833 - val_loss: 2.8518 - val_accuracy50: 0.5585 - 67s/epoch - 32ms/step
Epoch 22/50
2076/2076 - 67s - loss: 2.5801 - accuracy50: 0.5837 - val_loss: 2.8477 - val_accuracy50: 0.5561 - 67s/epoch - 32ms/step
Epoch 23/50
2076/2076 - 66s - loss: 2.5743 - accuracy50: 0.5840 - val_loss: 2.8758 - val_accuracy50: 0.5557 - 66s/epoch - 32ms/step
Epoch 24/50
2076/2076 - 67s - loss: 2.5715 - accuracy50: 0.5857 - val_loss: 2.8811 - val_accuracy50: 0.5579 - 67s/epoch - 32ms/step
Epoch 25/50
2076/2076 - 68s - loss: 2.5672 - accuracy50: 0.5861 - val_loss: 2.8592 - val_accuracy50: 0.5567 - 68s/epoch - 33ms/step
Epoch 26/50
2076/2076 - 67s - loss: 2.5641 - accuracy50: 0.5864 - val_loss: 2.8453 - val_accuracy50: 0.5581 - 67s/epoch - 32ms/step
Epoch 27/50
2076/2076 - 67s - loss: 2.5607 - accuracy50: 0.5865 - val_loss: 2.8588 - val_accuracy50: 0.5533 - 67s/epoch - 32ms/step
Epoch 28/50
2076/2076 - 67s - loss: 2.5561 - accuracy50: 0.5877 - val_loss: 2.8864 - val_accuracy50: 0.5496 - 67s/epoch - 32ms/step
Epoch 29/50
2076/2076 - 67s - loss: 2.5526 - accuracy50: 0.5877 - val_loss: 2.8553 - val_accuracy50: 0.5516 - 67s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h50
Evaluating performance on  test set...
4856/4856 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98534393
{'0': {'precision': 0.5295193041217335, 'recall': 0.2893893530887588, 'f1-score': 0.3742474756336837, 'support': 405357}, '1': {'precision': 0.5901005033767267, 'recall': 0.5396756567299655, 'f1-score': 0.5637627840659051, 'support': 445084}, '2': {'precision': 0.45297328269748227, 'recall': 0.709035733213747, 'f1-score': 0.5527913109551692, 'support': 392464}, 'accuracy': 0.5115258205574843, 'macro avg': {'precision': 0.5241976967319809, 'recall': 0.5127002476774905, 'f1-score': 0.4969338568849193, 'support': 1242905}, 'weighted avg': {'precision': 0.5270429802972756, 'recall': 0.5115258205574843, 'f1-score': 0.4984904864220049, 'support': 1242905}}
[[117306  95763 192288]
 [ 61121 240201 143762]
 [ 43106  71087 278271]]
Evaluating performance on  train set...
2076/2076 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8837269
{'0': {'precision': 0.5654675120650098, 'recall': 0.36165183637769893, 'f1-score': 0.44115650157392144, 'support': 138343}, '1': {'precision': 0.6493277945619336, 'recall': 0.6813982887963319, 'f1-score': 0.6649765922763214, 'support': 252337}, '2': {'precision': 0.4792933290668104, 'recall': 0.6066723513110212, 'f1-score': 0.5355123392324556, 'support': 140730}, 'accuracy': 0.5783688677292486, 'macro avg': {'precision': 0.564696211897918, 'recall': 0.549907492161684, 'f1-score': 0.5472151443608996, 'support': 531410}, 'weighted avg': {'precision': 0.5824671156311634, 'recall': 0.5783688677292486, 'f1-score': 0.5724238606022743, 'support': 531410}}
[[ 50032  50566  37745]
 [ 25386 171942  55009]
 [ 13061  42292  85377]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9003917
{'0': {'precision': 0.564376222467897, 'recall': 0.33696369636963697, 'f1-score': 0.4219813060342087, 'support': 39390}, '1': {'precision': 0.627898408019617, 'recall': 0.6875252152863761, 'f1-score': 0.656360400563126, 'support': 71881}, '2': {'precision': 0.4703961734428616, 'recall': 0.5793949640103486, 'f1-score': 0.519236949635003, 'support': 39039}, 'accuracy': 0.5675736810591444, 'macro avg': {'precision': 0.5542236013101253, 'recall': 0.534627958555454, 'f1-score': 0.5325262187441125, 'support': 150310}, 'weighted avg': {'precision': 0.5703448944508311, 'recall': 0.5675736810591444, 'f1-score': 0.5593252403324224, 'support': 150310}}
[[13273 16122  9995]
 [ 6990 49420 15471]
 [ 3255 13165 22619]]
training model: results/AAL/W2/deepVOL_L3/h100
Epoch 1/50
2076/2076 - 71s - loss: 3.2686 - accuracy100: 0.3845 - val_loss: 3.3125 - val_accuracy100: 0.3585 - 71s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 68s - loss: 3.2130 - accuracy100: 0.4119 - val_loss: 3.3635 - val_accuracy100: 0.3852 - 68s/epoch - 33ms/step
Epoch 3/50
2076/2076 - 69s - loss: 3.1746 - accuracy100: 0.4296 - val_loss: 3.3760 - val_accuracy100: 0.3824 - 69s/epoch - 33ms/step
Epoch 4/50
2076/2076 - 69s - loss: 3.1476 - accuracy100: 0.4396 - val_loss: 3.5044 - val_accuracy100: 0.3797 - 69s/epoch - 33ms/step
Epoch 5/50
2076/2076 - 67s - loss: 3.0935 - accuracy100: 0.4632 - val_loss: 3.4194 - val_accuracy100: 0.4294 - 67s/epoch - 32ms/step
Epoch 6/50
2076/2076 - 67s - loss: 3.0291 - accuracy100: 0.4832 - val_loss: 3.3143 - val_accuracy100: 0.4521 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 67s - loss: 2.9834 - accuracy100: 0.4915 - val_loss: 3.3586 - val_accuracy100: 0.4532 - 67s/epoch - 32ms/step
Epoch 8/50
2076/2076 - 68s - loss: 2.9566 - accuracy100: 0.4958 - val_loss: 3.3403 - val_accuracy100: 0.4501 - 68s/epoch - 33ms/step
Epoch 9/50
2076/2076 - 69s - loss: 2.9411 - accuracy100: 0.4991 - val_loss: 3.3457 - val_accuracy100: 0.4513 - 69s/epoch - 33ms/step
Epoch 10/50
2076/2076 - 73s - loss: 2.9291 - accuracy100: 0.5015 - val_loss: 3.3301 - val_accuracy100: 0.4519 - 73s/epoch - 35ms/step
Epoch 11/50
2076/2076 - 67s - loss: 2.9202 - accuracy100: 0.5027 - val_loss: 3.3281 - val_accuracy100: 0.4494 - 67s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h100
Evaluating performance on  test set...
4856/4856 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1261599
{'0': {'precision': 0.4724340688129475, 'recall': 0.0169457194047803, 'f1-score': 0.032717882348672234, 'support': 478882}, '1': {'precision': 0.23738765783182111, 'recall': 0.5073710880067213, 'f1-score': 0.323443356406343, 'support': 304704}, '2': {'precision': 0.4124783935413008, 'recall': 0.515896359610641, 'f1-score': 0.4584271619268717, 'support': 459319}, 'accuracy': 0.32156439953174215, 'macro avg': {'precision': 0.37410004006202313, 'recall': 0.34673772234071415, 'f1-score': 0.2715294668939623, 'support': 1242905}, 'weighted avg': {'precision': 0.3926545503286783, 'recall': 0.32156439953174215, 'f1-score': 0.26131264657751313, 'support': 1242905}}
[[  8115 278051 192716]
 [  5302 154598 144804]
 [  3760 218598 236961]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930709
{'0': {'precision': 0.43641648499948094, 'recall': 0.023975727712382516, 'f1-score': 0.04545429972374944, 'support': 175344}, '1': {'precision': 0.34398822182234584, 'recall': 0.5285246707402897, 'f1-score': 0.4167417197543397, 'support': 179038}, '2': {'precision': 0.40211680962495744, 'recall': 0.560357683530289, 'f1-score': 0.4682290191635986, 'support': 177028}, 'accuracy': 0.3726482377072317, 'macro avg': {'precision': 0.3941738388155947, 'recall': 0.37095269399432046, 'f1-score': 0.3101416795472292, 'support': 531410}, 'weighted avg': {'precision': 0.39385015332542694, 'recall': 0.3726482377072317, 'f1-score': 0.31138365773438986, 'support': 531410}}
[[  4204 104347  66793]
 [  3712  94626  80700]
 [  1717  76112  99199]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025304
{'0': {'precision': 0.431640625, 'recall': 0.021848307497627333, 'f1-score': 0.04159138813610358, 'support': 50576}, '1': {'precision': 0.3278764255810596, 'recall': 0.45461278248163495, 'f1-score': 0.3809811371394543, 'support': 49959}, '2': {'precision': 0.3849388379204893, 'recall': 0.6069311903566047, 'f1-score': 0.4710927449222252, 'support': 49775}, 'accuracy': 0.35943716319606145, 'macro avg': {'precision': 0.3814852961671829, 'recall': 0.3611307601119556, 'f1-score': 0.297888423399261, 'support': 150310}, 'weighted avg': {'precision': 0.38168694866007924, 'recall': 0.35943716319606145, 'f1-score': 0.2966243367389085, 'support': 150310}}
[[ 1105 27479 21992]
 [  969 22712 26278]
 [  486 19079 30210]]
training model: results/AAL/W2/deepVOL_L3/h200
Epoch 1/50
2076/2076 - 70s - loss: 3.2855 - accuracy200: 0.3745 - val_loss: 3.3070 - val_accuracy200: 0.3459 - 70s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 67s - loss: 3.2548 - accuracy200: 0.3913 - val_loss: 3.3420 - val_accuracy200: 0.3618 - 67s/epoch - 32ms/step
Epoch 3/50
2076/2076 - 73s - loss: 3.2471 - accuracy200: 0.3966 - val_loss: 3.4243 - val_accuracy200: 0.3631 - 73s/epoch - 35ms/step
Epoch 4/50
2076/2076 - 67s - loss: 3.2324 - accuracy200: 0.4056 - val_loss: 3.4019 - val_accuracy200: 0.3612 - 67s/epoch - 32ms/step
Epoch 5/50
2076/2076 - 68s - loss: 3.2145 - accuracy200: 0.4156 - val_loss: 3.3265 - val_accuracy200: 0.3703 - 68s/epoch - 33ms/step
Epoch 6/50
2076/2076 - 67s - loss: 3.2018 - accuracy200: 0.4216 - val_loss: 3.3286 - val_accuracy200: 0.3731 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 67s - loss: 3.1937 - accuracy200: 0.4247 - val_loss: 3.3335 - val_accuracy200: 0.3716 - 67s/epoch - 32ms/step
Epoch 8/50
2076/2076 - 67s - loss: 3.1883 - accuracy200: 0.4279 - val_loss: 3.3447 - val_accuracy200: 0.3724 - 67s/epoch - 32ms/step
Epoch 9/50
2076/2076 - 73s - loss: 3.1861 - accuracy200: 0.4286 - val_loss: 3.3353 - val_accuracy200: 0.3743 - 73s/epoch - 35ms/step
Epoch 10/50
2076/2076 - 67s - loss: 3.1803 - accuracy200: 0.4309 - val_loss: 3.3441 - val_accuracy200: 0.3759 - 67s/epoch - 32ms/step
Epoch 11/50
2076/2076 - 66s - loss: 3.1765 - accuracy200: 0.4325 - val_loss: 3.3523 - val_accuracy200: 0.3759 - 66s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h200
Evaluating performance on  test set...
4856/4856 - 71s - 71s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1067863
{'0': {'precision': 0.3580141059327894, 'recall': 0.029846616430396326, 'f1-score': 0.05509972565070162, 'support': 433684}, '1': {'precision': 0.33238558285665704, 'recall': 0.43206947778571686, 'f1-score': 0.37572820850370964, 'support': 389074}, '2': {'precision': 0.3541215222449361, 'recall': 0.5908313042815967, 'f1-score': 0.44282862591402666, 'support': 420147}, 'accuracy': 0.3453900338320306, 'macro avg': {'precision': 0.3481737370114608, 'recall': 0.3509157994992366, 'f1-score': 0.29121885335614595, 'support': 1242905}, 'weighted avg': {'precision': 0.34867562121672213, 'recall': 0.3453900338320306, 'f1-score': 0.2865344214613118, 'support': 1242905}}
[[ 12944 176465 244275]
 [ 12487 168107 208480]
 [ 10724 161187 248236]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012655
{'0': {'precision': 0.3791563275434243, 'recall': 0.038696170902460435, 'f1-score': 0.0702252498378671, 'support': 177692}, '1': {'precision': 0.3404830495747034, 'recall': 0.4224846256797737, 'f1-score': 0.37707719059499506, 'support': 177081}, '2': {'precision': 0.35445551974818257, 'recall': 0.5890555206440327, 'f1-score': 0.44258937477535343, 'support': 176637}, 'accuracy': 0.34952108541427523, 'macro avg': {'precision': 0.35803163228877005, 'recall': 0.35007877240875557, 'f1-score': 0.2966306050694052, 'support': 531410}, 'weighted avg': {'precision': 0.35805890874718943, 'recall': 0.34952108541427523, 'f1-score': 0.2962483402159099, 'support': 531410}}
[[  6876  77317  93499]
 [  6269  74814  95998]
 [  4990  67598 104049]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022041
{'0': {'precision': 0.34238683127572017, 'recall': 0.03360190626198986, 'f1-score': 0.061197844835512404, 'support': 49521}, '1': {'precision': 0.3505029330420843, 'recall': 0.38400077197722665, 'f1-score': 0.3664879998526459, 'support': 51815}, '2': {'precision': 0.34288420554108456, 'recall': 0.6209008861845061, 'f1-score': 0.4417937337004294, 'support': 48974}, 'accuracy': 0.34574545938393986, 'macro avg': {'precision': 0.34525798995296303, 'recall': 0.3461678548079075, 'f1-score': 0.28982652612952925, 'support': 150310}, 'weighted avg': {'precision': 0.3453466757324836, 'recall': 0.34574545938393986, 'f1-score': 0.29044348679867665, 'support': 150310}}
[[ 1664 19772 28085]
 [ 1728 19897 30190]
 [ 1468 17098 30408]]
training model: results/AAL/W2/deepVOL_L3/h300
Epoch 1/50
2076/2076 - 72s - loss: 3.2931 - accuracy300: 0.3674 - val_loss: 3.3014 - val_accuracy300: 0.3476 - 72s/epoch - 35ms/step
Epoch 2/50
2076/2076 - 73s - loss: 3.2789 - accuracy300: 0.3732 - val_loss: 3.3067 - val_accuracy300: 0.3558 - 73s/epoch - 35ms/step
Epoch 3/50
2076/2076 - 66s - loss: 3.2674 - accuracy300: 0.3840 - val_loss: 3.3046 - val_accuracy300: 0.3653 - 66s/epoch - 32ms/step
Epoch 4/50
2076/2076 - 66s - loss: 3.2604 - accuracy300: 0.3882 - val_loss: 3.2935 - val_accuracy300: 0.3724 - 66s/epoch - 32ms/step
Epoch 5/50
2076/2076 - 66s - loss: 3.2552 - accuracy300: 0.3918 - val_loss: 3.3195 - val_accuracy300: 0.3663 - 66s/epoch - 32ms/step
Epoch 6/50
2076/2076 - 67s - loss: 3.2488 - accuracy300: 0.3964 - val_loss: 3.3248 - val_accuracy300: 0.3667 - 67s/epoch - 32ms/step
Epoch 7/50
2076/2076 - 67s - loss: 3.2414 - accuracy300: 0.4011 - val_loss: 3.3475 - val_accuracy300: 0.3665 - 67s/epoch - 32ms/step
Epoch 8/50
2076/2076 - 66s - loss: 3.2341 - accuracy300: 0.4052 - val_loss: 3.3407 - val_accuracy300: 0.3685 - 66s/epoch - 32ms/step
Epoch 9/50
2076/2076 - 67s - loss: 3.2287 - accuracy300: 0.4084 - val_loss: 3.3893 - val_accuracy300: 0.3643 - 67s/epoch - 32ms/step
Epoch 10/50
2076/2076 - 66s - loss: 3.2237 - accuracy300: 0.4108 - val_loss: 3.3940 - val_accuracy300: 0.3649 - 66s/epoch - 32ms/step
Epoch 11/50
2076/2076 - 66s - loss: 3.2181 - accuracy300: 0.4149 - val_loss: 3.4048 - val_accuracy300: 0.3667 - 66s/epoch - 32ms/step
Epoch 12/50
2076/2076 - 68s - loss: 3.2114 - accuracy300: 0.4174 - val_loss: 3.4231 - val_accuracy300: 0.3637 - 68s/epoch - 33ms/step
Epoch 13/50
2076/2076 - 67s - loss: 3.2054 - accuracy300: 0.4206 - val_loss: 3.4028 - val_accuracy300: 0.3659 - 67s/epoch - 32ms/step
Epoch 14/50
2076/2076 - 67s - loss: 3.1988 - accuracy300: 0.4235 - val_loss: 3.4211 - val_accuracy300: 0.3636 - 67s/epoch - 32ms/step
testing model: results/AAL/W2/deepVOL_L3/h300
Evaluating performance on  test set...
4856/4856 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969204
{'0': {'precision': 0.386085061764057, 'recall': 0.3816561328719599, 'f1-score': 0.38385782256313766, 'support': 444759}, '1': {'precision': 0.30131004366812225, 'recall': 0.001141769743101808, 'f1-score': 0.0022749190178284412, 'support': 362595}, '2': {'precision': 0.3752958694258699, 'recall': 0.6909409001471699, 'f1-score': 0.48639715538315453, 'support': 435551}, 'accuracy': 0.37903057755822045, 'macro avg': {'precision': 0.35423032495268303, 'recall': 0.3579129342540772, 'f1-score': 0.29084329898804023, 'support': 1242905}, 'weighted avg': {'precision': 0.3575726322552971, 'recall': 0.37903057755822045, 'f1-score': 0.3084707704860117, 'support': 1242905}}
[[169745    483 274531]
 [135778    414 226403]
 [134134    477 300940]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926225
{'0': {'precision': 0.38657888168336185, 'recall': 0.46109728627521473, 'f1-score': 0.42056266299140793, 'support': 178021}, '1': {'precision': 0.3416506717850288, 'recall': 0.0010157092560785634, 'f1-score': 0.002025397114378044, 'support': 175247}, '2': {'precision': 0.3732232100253648, 'recall': 0.6673945504148376, 'f1-score': 0.4787293585185245, 'support': 178142}, 'accuracy': 0.3785288195555221, 'macro avg': {'precision': 0.36715092116458514, 'recall': 0.376502515315377, 'f1-score': 0.3004391395414368, 'support': 531410}, 'weighted avg': {'precision': 0.3672854170128587, 'recall': 0.3785288195555221, 'f1-score': 0.3020374776193595, 'support': 531410}}
[[ 82085    173  95763]
 [ 71171    178 103898]
 [ 59081    170 118891]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974467
{'0': {'precision': 0.3824436037550792, 'recall': 0.4286359264275759, 'f1-score': 0.40422440044798635, 'support': 50943}, '1': {'precision': 0.3352601156069364, 'recall': 0.0011807577207304412, 'f1-score': 0.002353227573335497, 'support': 49121}, '2': {'precision': 0.36636536580647244, 'recall': 0.6784022608764877, 'f1-score': 0.4757863588462317, 'support': 50246}, 'accuracy': 0.37243696360854234, 'macro avg': {'precision': 0.3613563617228293, 'recall': 0.3694063150082647, 'f1-score': 0.2941213289558512, 'support': 150310}, 'weighted avg': {'precision': 0.3616494632102677, 'recall': 0.37243696360854234, 'f1-score': 0.29681563375849473, 'support': 150310}}
[[21836    62 29045]
 [19154    58 29909]
 [16106    53 34087]]
training model: results/AAL/W2/deepVOL_L3/h500
Epoch 1/50
2076/2076 - 71s - loss: 3.2623 - accuracy500: 0.3845 - val_loss: 3.3982 - val_accuracy500: 0.3258 - 71s/epoch - 34ms/step
Epoch 2/50
2076/2076 - 74s - loss: 3.2648 - accuracy500: 0.3888 - val_loss: 3.3990 - val_accuracy500: 0.3275 - 74s/epoch - 36ms/step
Epoch 3/50
2076/2076 - 74s - loss: 3.2640 - accuracy500: 0.3879 - val_loss: 3.3968 - val_accuracy500: 0.3238 - 74s/epoch - 35ms/step
Epoch 4/50
2076/2076 - 74s - loss: 3.2720 - accuracy500: 0.3821 - val_loss: 3.4141 - val_accuracy500: 0.3184 - 74s/epoch - 36ms/step
Epoch 5/50
2076/2076 - 73s - loss: 3.2661 - accuracy500: 0.3876 - val_loss: 3.3442 - val_accuracy500: 0.3231 - 73s/epoch - 35ms/step
Epoch 6/50
2076/2076 - 73s - loss: 3.2576 - accuracy500: 0.3944 - val_loss: 3.3979 - val_accuracy500: 0.3277 - 73s/epoch - 35ms/step
Epoch 7/50
2076/2076 - 73s - loss: 3.2583 - accuracy500: 0.3923 - val_loss: 3.3695 - val_accuracy500: 0.3247 - 73s/epoch - 35ms/step
Epoch 8/50
2076/2076 - 73s - loss: 3.2543 - accuracy500: 0.3985 - val_loss: 3.3801 - val_accuracy500: 0.3297 - 73s/epoch - 35ms/step
Epoch 9/50
2076/2076 - 73s - loss: 3.2460 - accuracy500: 0.4015 - val_loss: 3.3962 - val_accuracy500: 0.3312 - 73s/epoch - 35ms/step
Epoch 10/50
2076/2076 - 73s - loss: 3.2452 - accuracy500: 0.4033 - val_loss: 3.4078 - val_accuracy500: 0.3260 - 73s/epoch - 35ms/step
Epoch 11/50
2076/2076 - 75s - loss: 3.2309 - accuracy500: 0.4126 - val_loss: 3.3933 - val_accuracy500: 0.3299 - 75s/epoch - 36ms/step
Epoch 12/50
2076/2076 - 73s - loss: 3.2375 - accuracy500: 0.4059 - val_loss: 3.3970 - val_accuracy500: 0.3326 - 73s/epoch - 35ms/step
Epoch 13/50
2076/2076 - 74s - loss: 3.2332 - accuracy500: 0.4100 - val_loss: 3.3699 - val_accuracy500: 0.3326 - 74s/epoch - 36ms/step
Epoch 14/50
2076/2076 - 75s - loss: 3.2248 - accuracy500: 0.4131 - val_loss: 3.4164 - val_accuracy500: 0.3297 - 75s/epoch - 36ms/step
Epoch 15/50
2076/2076 - 75s - loss: 3.2207 - accuracy500: 0.4151 - val_loss: 3.4122 - val_accuracy500: 0.3292 - 75s/epoch - 36ms/step
testing model: results/AAL/W2/deepVOL_L3/h500
Evaluating performance on  test set...
4856/4856 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058191
{'0': {'precision': 0.36001559398922595, 'recall': 0.22852322193851726, 'f1-score': 0.27958028004266006, 'support': 444515}, '1': {'precision': 0.2977981161888736, 'recall': 0.04027240485533348, 'f1-score': 0.07094996785446259, 'support': 360346}, '2': {'precision': 0.35074022986489245, 'recall': 0.730246276629745, 'f1-score': 0.4738759371819581, 'support': 438044}, 'accuracy': 0.3507701714933965, 'macro avg': {'precision': 0.3361846466809973, 'recall': 0.33301396780786524, 'f1-score': 0.2748020616930269, 'support': 1242905}, 'weighted avg': {'precision': 0.3387083847834336, 'recall': 0.3507701714933965, 'f1-score': 0.2875703905983006, 'support': 1242905}}
[[101582  16864 326069]
 [ 79769  14512 266065]
 [100809  17355 319880]]
Evaluating performance on  train set...
2076/2076 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052136
{'0': {'precision': 0.35352835352835354, 'recall': 0.28451354853247707, 'f1-score': 0.3152884036121074, 'support': 177510}, '1': {'precision': 0.33762014349532965, 'recall': 0.04263636570855463, 'f1-score': 0.07571150294720333, 'support': 175484}, '2': {'precision': 0.3462384549881002, 'recall': 0.7110292798852121, 'f1-score': 0.465701678389451, 'support': 178416}, 'accuracy': 0.34783876855911633, 'macro avg': {'precision': 0.3457956506705944, 'recall': 0.3460597313754146, 'f1-score': 0.28556719498292055, 'support': 531410}, 'weighted avg': {'precision': 0.3458275747184083, 'recall': 0.3478387685591164, 'f1-score': 0.2866743805346239, 'support': 531410}}
[[ 50504   7380 119626]
 [ 48095   7482 119907]
 [ 44258   7299 126859]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132438
{'0': {'precision': 0.3429003021148036, 'recall': 0.17956617677671843, 'f1-score': 0.23570237997650076, 'support': 48038}, '1': {'precision': 0.3878787878787879, 'recall': 0.030366625910177563, 'f1-score': 0.05632372603110667, 'support': 54797}, '2': {'precision': 0.3161652766746095, 'recall': 0.8049078462348604, 'f1-score': 0.454000558397044, 'support': 47475}, 'accuracy': 0.3226864480074513, 'macro avg': {'precision': 0.348981455556067, 'recall': 0.3382802163072522, 'f1-score': 0.24867555480155046, 'support': 150310}, 'weighted avg': {'precision': 0.3508534705775528, 'recall': 0.3226864480074513, 'f1-score': 0.23925699324421104, 'support': 150310}}
[[ 8626  1357 38055]
 [ 8537  1664 44596]
 [ 7993  1269 38213]]
training model: results/AAL/W2/deepVOL_L3/h1000
Epoch 1/50
2076/2076 - 73s - loss: 3.2165 - accuracy1000: 0.4195 - val_loss: 3.3020 - val_accuracy1000: 0.3626 - 73s/epoch - 35ms/step
Epoch 2/50
2076/2076 - 68s - loss: 3.2468 - accuracy1000: 0.4011 - val_loss: 3.3048 - val_accuracy1000: 0.3558 - 68s/epoch - 33ms/step
Epoch 3/50
2076/2076 - 69s - loss: 3.2395 - accuracy1000: 0.4048 - val_loss: 3.3194 - val_accuracy1000: 0.3391 - 69s/epoch - 33ms/step
Epoch 4/50
2076/2076 - 68s - loss: 3.2483 - accuracy1000: 0.3970 - val_loss: 3.3450 - val_accuracy1000: 0.3359 - 68s/epoch - 33ms/step
Epoch 5/50
2076/2076 - 68s - loss: 3.2224 - accuracy1000: 0.4143 - val_loss: 3.3168 - val_accuracy1000: 0.3531 - 68s/epoch - 33ms/step
Epoch 6/50
2076/2076 - 67s - loss: 3.2255 - accuracy1000: 0.4127 - val_loss: 3.3493 - val_accuracy1000: 0.3330 - 67s/epoch - 33ms/step
Epoch 7/50
2076/2076 - 68s - loss: 3.2259 - accuracy1000: 0.4149 - val_loss: 3.3397 - val_accuracy1000: 0.3372 - 68s/epoch - 33ms/step
Epoch 8/50
2076/2076 - 68s - loss: 3.2259 - accuracy1000: 0.4102 - val_loss: 3.3298 - val_accuracy1000: 0.3374 - 68s/epoch - 33ms/step
Epoch 9/50
2076/2076 - 68s - loss: 3.2417 - accuracy1000: 0.4054 - val_loss: 3.3268 - val_accuracy1000: 0.3441 - 68s/epoch - 33ms/step
Epoch 10/50
2076/2076 - 68s - loss: 3.2268 - accuracy1000: 0.4116 - val_loss: 3.3524 - val_accuracy1000: 0.3438 - 68s/epoch - 33ms/step
Epoch 11/50
2076/2076 - 69s - loss: 3.2139 - accuracy1000: 0.4202 - val_loss: 3.3702 - val_accuracy1000: 0.3339 - 69s/epoch - 33ms/step
testing model: results/AAL/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
4856/4856 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1105121
{'0': {'precision': 0.3000093083868566, 'recall': 0.007827128053563493, 'f1-score': 0.015256226983120166, 'support': 411773}, '1': {'precision': 0.3401483541956421, 'recall': 0.8097853653954536, 'f1-score': 0.4790661489410474, 'support': 425840}, '2': {'precision': 0.3053871375451065, 'recall': 0.16454309485506746, 'f1-score': 0.2138587444521409, 'support': 405292}, 'accuracy': 0.33369404741311687, 'macro avg': {'precision': 0.3151816000425351, 'recall': 0.3273851961013615, 'f1-score': 0.23606037345876948, 'support': 1242905}, 'weighted avg': {'precision': 0.31551524198791114, 'recall': 0.33369404741311687, 'f1-score': 0.23892644206522065, 'support': 1242905}}
[[  3223 334528  74022]
 [  3339 344839  77662]
 [  4181 334423  66688]]
Evaluating performance on  train set...
2076/2076 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070834
{'0': {'precision': 0.36908459711310065, 'recall': 0.011469192160069043, 'f1-score': 0.022247063552811995, 'support': 176124}, '1': {'precision': 0.33230567446767834, 'recall': 0.7827055926677459, 'f1-score': 0.466537904229965, 'support': 175444}, '2': {'precision': 0.35203194321206743, 'recall': 0.22060475306102023, 'f1-score': 0.2712362669291931, 'support': 179842}, 'accuracy': 0.33686795506294576, 'macro avg': {'precision': 0.35114073826428216, 'recall': 0.33825984596294506, 'f1-score': 0.25334041157065673, 'support': 531410}, 'weighted avg': {'precision': 0.3511710751856377, 'recall': 0.33686795506294576, 'f1-score': 0.2531928089572597, 'support': 531410}}
[[  2020 137757  36347]
 [  1444 137321  36679]
 [  2009 138159  39674]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001719
{'0': {'precision': 0.32817753866846, 'recall': 0.010346216634511417, 'f1-score': 0.020060015620503968, 'support': 47167}, '1': {'precision': 0.37286573703793857, 'recall': 0.7693411541014189, 'f1-score': 0.5022924632708151, 'support': 55749}, '2': {'precision': 0.3248409528036692, 'recall': 0.23163269612187196, 'f1-score': 0.27043072337385604, 'support': 47394}, 'accuracy': 0.3616259729891557, 'macro avg': {'precision': 0.3419614095033559, 'recall': 0.3371066889526007, 'f1-score': 0.264261067421725, 'support': 150310}, 'weighted avg': {'precision': 0.343700046954164, 'recall': 0.3616259729891557, 'f1-score': 0.27786086750873207, 'support': 150310}}
[[  488 36281 10398]
 [  440 42890 12419]
 [  559 35857 10978]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        27 (peak)  18.30 (ave)

============================================
