This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-17.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-09.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-27.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-28.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-05.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-01.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-03.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-02.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-04.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-03-26.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-10.csv
training model: results/XRAY/W2/deepLOB_L1/h10
Epoch 1/50
286/286 - 19s - loss: 3.2793 - accuracy10: 0.3871 - val_loss: 3.2703 - val_accuracy10: 0.4076 - 19s/epoch - 68ms/step
Epoch 2/50
286/286 - 8s - loss: 3.1850 - accuracy10: 0.4278 - val_loss: 3.2020 - val_accuracy10: 0.4273 - 8s/epoch - 30ms/step
Epoch 3/50
286/286 - 8s - loss: 3.1383 - accuracy10: 0.4509 - val_loss: 3.2004 - val_accuracy10: 0.4212 - 8s/epoch - 30ms/step
Epoch 4/50
286/286 - 8s - loss: 3.1215 - accuracy10: 0.4631 - val_loss: 3.1506 - val_accuracy10: 0.4351 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.1021 - accuracy10: 0.4659 - val_loss: 3.1363 - val_accuracy10: 0.4480 - 8s/epoch - 30ms/step
Epoch 6/50
286/286 - 8s - loss: 3.0874 - accuracy10: 0.4705 - val_loss: 3.1566 - val_accuracy10: 0.4441 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 8s - loss: 3.0759 - accuracy10: 0.4753 - val_loss: 3.1272 - val_accuracy10: 0.4534 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 3.0615 - accuracy10: 0.4798 - val_loss: 3.1394 - val_accuracy10: 0.4523 - 8s/epoch - 29ms/step
Epoch 9/50
286/286 - 8s - loss: 3.0546 - accuracy10: 0.4815 - val_loss: 3.1275 - val_accuracy10: 0.4552 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.0438 - accuracy10: 0.4841 - val_loss: 3.1190 - val_accuracy10: 0.4575 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.0371 - accuracy10: 0.4877 - val_loss: 3.1264 - val_accuracy10: 0.4569 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 3.0286 - accuracy10: 0.4886 - val_loss: 3.1154 - val_accuracy10: 0.4639 - 8s/epoch - 29ms/step
Epoch 13/50
286/286 - 8s - loss: 3.0206 - accuracy10: 0.4926 - val_loss: 3.1102 - val_accuracy10: 0.4669 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 3.0164 - accuracy10: 0.4945 - val_loss: 3.1115 - val_accuracy10: 0.4612 - 8s/epoch - 29ms/step
Epoch 15/50
286/286 - 8s - loss: 3.0067 - accuracy10: 0.4961 - val_loss: 3.1398 - val_accuracy10: 0.4566 - 8s/epoch - 30ms/step
Epoch 16/50
286/286 - 9s - loss: 3.0024 - accuracy10: 0.4978 - val_loss: 3.1425 - val_accuracy10: 0.4557 - 9s/epoch - 30ms/step
Epoch 17/50
286/286 - 8s - loss: 2.9988 - accuracy10: 0.4970 - val_loss: 3.1348 - val_accuracy10: 0.4561 - 8s/epoch - 30ms/step
Epoch 18/50
286/286 - 8s - loss: 2.9954 - accuracy10: 0.4996 - val_loss: 3.1393 - val_accuracy10: 0.4570 - 8s/epoch - 30ms/step
Epoch 19/50
286/286 - 9s - loss: 2.9871 - accuracy10: 0.5004 - val_loss: 3.1315 - val_accuracy10: 0.4591 - 9s/epoch - 30ms/step
Epoch 20/50
286/286 - 8s - loss: 2.9794 - accuracy10: 0.5039 - val_loss: 3.1450 - val_accuracy10: 0.4578 - 8s/epoch - 29ms/step
Epoch 21/50
286/286 - 8s - loss: 2.9746 - accuracy10: 0.5041 - val_loss: 3.1525 - val_accuracy10: 0.4546 - 8s/epoch - 28ms/step
Epoch 22/50
286/286 - 8s - loss: 2.9710 - accuracy10: 0.5072 - val_loss: 3.1659 - val_accuracy10: 0.4536 - 8s/epoch - 28ms/step
Epoch 23/50
286/286 - 8s - loss: 2.9659 - accuracy10: 0.5059 - val_loss: 3.1548 - val_accuracy10: 0.4574 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h10
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0661076
{'0': {'precision': 0.49985168641273053, 'recall': 0.310183530940393, 'f1-score': 0.3828123956008712, 'support': 92355}, '1': {'precision': 0.4018325740910744, 'recall': 0.5472107559853756, 'f1-score': 0.4633868648130393, 'support': 84790}, '2': {'precision': 0.4772664537245159, 'recall': 0.49874314913256684, 'f1-score': 0.4877685084431548, 'support': 97068}, 'accuracy': 0.45022300182704683, 'macro avg': {'precision': 0.45965023807610694, 'recall': 0.4520458120194452, 'f1-score': 0.4446559229523552, 'support': 274213}, 'weighted avg': {'precision': 0.46154809066660313, 'recall': 0.45022300182704683, 'f1-score': 0.44488016483819587, 'support': 274213}}
[[28647 36157 27551]
 [12919 46398 25473]
 [15745 32911 48412]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0368706
{'0': {'precision': 0.45193429237947125, 'recall': 0.40243216341368415, 'f1-score': 0.42574914726552665, 'support': 23107}, '1': {'precision': 0.4594777798866625, 'recall': 0.6222597583813755, 'f1-score': 0.5286208940325045, 'support': 27233}, '2': {'precision': 0.49220103986135183, 'recall': 0.337856891082129, 'f1-score': 0.40067929457870677, 'support': 22696}, 'accuracy': 0.46433265786735306, 'macro avg': {'precision': 0.4678710373758285, 'recall': 0.45418293762572953, 'f1-score': 0.45168311195891264, 'support': 73036}, 'weighted avg': {'precision': 0.46725996596690894, 'recall': 0.46433265786735306, 'f1-score': 0.4563165510544121, 'support': 73036}}
[[ 9299 10374  3434]
 [ 5810 16946  4477]
 [ 5467  9561  7668]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0363072
{'0': {'precision': 0.4586382239861094, 'recall': 0.40173818576860404, 'f1-score': 0.428306694463748, 'support': 9205}, '1': {'precision': 0.5107787919984463, 'recall': 0.45687483714062366, 'f1-score': 0.48232543212140666, 'support': 11513}, '2': {'precision': 0.4310796645702306, 'recall': 0.5428445715542844, 'f1-score': 0.4805491990846682, 'support': 9091}, 'accuracy': 0.46606729511221445, 'macro avg': {'precision': 0.4668322268515954, 'recall': 0.46715253148783736, 'f1-score': 0.46372710855660765, 'support': 29809}, 'weighted avg': {'precision': 0.4703715761910234, 'recall': 0.46606729511221445, 'f1-score': 0.46510277404244604, 'support': 29809}}
[[3698 2809 2698]
 [2438 5260 3815]
 [1927 2229 4935]]
training model: results/XRAY/W2/deepLOB_L1/h20
Epoch 1/50
286/286 - 11s - loss: 3.3011 - accuracy20: 0.3820 - val_loss: 3.3398 - val_accuracy20: 0.3608 - 11s/epoch - 38ms/step
Epoch 2/50
286/286 - 9s - loss: 3.2288 - accuracy20: 0.4146 - val_loss: 3.2716 - val_accuracy20: 0.3852 - 9s/epoch - 31ms/step
Epoch 3/50
286/286 - 9s - loss: 3.1911 - accuracy20: 0.4313 - val_loss: 3.2610 - val_accuracy20: 0.3902 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.1758 - accuracy20: 0.4410 - val_loss: 3.2251 - val_accuracy20: 0.4062 - 9s/epoch - 30ms/step
Epoch 5/50
286/286 - 8s - loss: 3.1644 - accuracy20: 0.4456 - val_loss: 3.2267 - val_accuracy20: 0.4079 - 8s/epoch - 28ms/step
Epoch 6/50
286/286 - 8s - loss: 3.1494 - accuracy20: 0.4529 - val_loss: 3.2353 - val_accuracy20: 0.4014 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.1407 - accuracy20: 0.4549 - val_loss: 3.2361 - val_accuracy20: 0.4047 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 3.1277 - accuracy20: 0.4616 - val_loss: 3.2306 - val_accuracy20: 0.4087 - 8s/epoch - 29ms/step
Epoch 9/50
286/286 - 8s - loss: 3.1193 - accuracy20: 0.4642 - val_loss: 3.2366 - val_accuracy20: 0.4091 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1102 - accuracy20: 0.4678 - val_loss: 3.2364 - val_accuracy20: 0.4180 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1034 - accuracy20: 0.4701 - val_loss: 3.2381 - val_accuracy20: 0.4160 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 3.0988 - accuracy20: 0.4706 - val_loss: 3.2293 - val_accuracy20: 0.4129 - 8s/epoch - 29ms/step
Epoch 13/50
286/286 - 8s - loss: 3.0924 - accuracy20: 0.4724 - val_loss: 3.2640 - val_accuracy20: 0.4130 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 3.0905 - accuracy20: 0.4726 - val_loss: 3.2540 - val_accuracy20: 0.4129 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h20
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0975959
{'0': {'precision': 0.44379932356257046, 'recall': 0.16545477471418965, 'f1-score': 0.2410446390300655, 'support': 95168}, '1': {'precision': 0.3174221085306967, 'recall': 0.5674373795761078, 'f1-score': 0.4071090877254421, 'support': 77850}, '2': {'precision': 0.457560387686436, 'recall': 0.45019022678986115, 'f1-score': 0.4538453875273959, 'support': 101195}, 'accuracy': 0.38465718255516695, 'macro avg': {'precision': 0.4062606065932344, 'recall': 0.3943607936933862, 'f1-score': 0.3673330380943011, 'support': 274213}, 'weighted avg': {'precision': 0.4129987586505612, 'recall': 0.38465718255516695, 'f1-score': 0.3667224481606407, 'support': 274213}}
[[15746 49719 29703]
 [ 9370 44175 24305]
 [10364 45274 45557]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0723201
{'0': {'precision': 0.445490469549047, 'recall': 0.31447676088115845, 'f1-score': 0.3686906336419382, 'support': 24377}, '1': {'precision': 0.3859534907945106, 'recall': 0.6016725530792026, 'f1-score': 0.47025414855474823, 'support': 24633}, '2': {'precision': 0.4518276238021461, 'recall': 0.3277282943477899, 'f1-score': 0.37990012785564375, 'support': 24026}, 'accuracy': 0.41569910728955584, 'macro avg': {'precision': 0.42775719471523455, 'recall': 0.41462586943605034, 'f1-score': 0.40628163668411005, 'support': 73036}, 'weighted avg': {'precision': 0.4274949888330229, 'recall': 0.4156991072895558, 'f1-score': 0.40663265361600226, 'support': 73036}}
[[ 7666 12202  4509]
 [ 4768 14821  5044]
 [ 4774 11378  7874]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0750339
{'0': {'precision': 0.42467301792346196, 'recall': 0.2689986703487777, 'f1-score': 0.3293675641828428, 'support': 9777}, '1': {'precision': 0.4071948998178506, 'recall': 0.4317720907774022, 'f1-score': 0.4191235059760956, 'support': 10355}, '2': {'precision': 0.401551123773346, 'recall': 0.5243360545623643, 'f1-score': 0.4548021332855286, 'support': 9677}, 'accuracy': 0.40843369452178874, 'macro avg': {'precision': 0.4111396805048862, 'recall': 0.4083689385628481, 'f1-score': 0.401097734481489, 'support': 29809}, 'weighted avg': {'precision': 0.4110953573956255, 'recall': 0.40843369452178874, 'f1-score': 0.401267094609084, 'support': 29809}}
[[2630 3584 3563]
 [1885 4471 3999]
 [1678 2925 5074]]
training model: results/XRAY/W2/deepLOB_L1/h30
Epoch 1/50
286/286 - 11s - loss: 3.3133 - accuracy30: 0.3718 - val_loss: 3.3451 - val_accuracy30: 0.3492 - 11s/epoch - 37ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2472 - accuracy30: 0.4020 - val_loss: 3.3475 - val_accuracy30: 0.3557 - 8s/epoch - 29ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2177 - accuracy30: 0.4225 - val_loss: 3.3148 - val_accuracy30: 0.3700 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2084 - accuracy30: 0.4243 - val_loss: 3.2978 - val_accuracy30: 0.3770 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.1987 - accuracy30: 0.4305 - val_loss: 3.2661 - val_accuracy30: 0.3874 - 8s/epoch - 29ms/step
Epoch 6/50
286/286 - 8s - loss: 3.1825 - accuracy30: 0.4381 - val_loss: 3.3097 - val_accuracy30: 0.3847 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 8s - loss: 3.1765 - accuracy30: 0.4400 - val_loss: 3.3155 - val_accuracy30: 0.3743 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 3.1733 - accuracy30: 0.4414 - val_loss: 3.3098 - val_accuracy30: 0.3786 - 8s/epoch - 28ms/step
Epoch 9/50
286/286 - 8s - loss: 3.1647 - accuracy30: 0.4457 - val_loss: 3.2690 - val_accuracy30: 0.3928 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1575 - accuracy30: 0.4488 - val_loss: 3.2908 - val_accuracy30: 0.3743 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1503 - accuracy30: 0.4498 - val_loss: 3.2868 - val_accuracy30: 0.3805 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1421 - accuracy30: 0.4531 - val_loss: 3.3012 - val_accuracy30: 0.3793 - 8s/epoch - 29ms/step
Epoch 13/50
286/286 - 8s - loss: 3.1412 - accuracy30: 0.4511 - val_loss: 3.2994 - val_accuracy30: 0.3766 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1370 - accuracy30: 0.4552 - val_loss: 3.2746 - val_accuracy30: 0.3894 - 8s/epoch - 29ms/step
Epoch 15/50
286/286 - 8s - loss: 3.1307 - accuracy30: 0.4562 - val_loss: 3.2885 - val_accuracy30: 0.3859 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h30
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0944539
{'0': {'precision': 0.44151862464183383, 'recall': 0.16271039682372074, 'f1-score': 0.23778954028487215, 'support': 94702}, '1': {'precision': 0.3353998659982725, 'recall': 0.5379346953572076, 'f1-score': 0.4131823764276515, 'support': 77238}, '2': {'precision': 0.454805343313062, 'recall': 0.5133319644480948, 'f1-score': 0.4822996045143243, 'support': 102273}, 'accuracy': 0.39917144701381774, 'macro avg': {'precision': 0.4105746113177228, 'recall': 0.40465901887634104, 'f1-score': 0.3777571737422827, 'support': 274213}, 'weighted avg': {'precision': 0.4165835263735209, 'recall': 0.39917144701381774, 'f1-score': 0.3783874319856112, 'support': 274213}}
[[15409 43522 35771]
 [ 8526 41549 27163]
 [10965 38808 52500]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0886416
{'0': {'precision': 0.4491607346867036, 'recall': 0.2062550443906376, 'f1-score': 0.282695871014132, 'support': 24780}, '1': {'precision': 0.3675860257420541, 'recall': 0.5901404293003838, 'f1-score': 0.45300487189032584, 'support': 23713}, '2': {'precision': 0.4227752575571289, 'recall': 0.4063072973964063, 'f1-score': 0.41437772698940367, 'support': 24543}, 'accuracy': 0.3981187359658251, 'macro avg': {'precision': 0.4131740059952955, 'recall': 0.4009009236958092, 'f1-score': 0.3833594899646205, 'support': 73036}, 'weighted avg': {'precision': 0.4138088556353368, 'recall': 0.3981187359658251, 'f1-score': 0.3822413708906076, 'support': 73036}}
[[ 5111 12634  7035]
 [ 3139 13994  6580]
 [ 3129 11442  9972]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0926651
{'0': {'precision': 0.4666666666666667, 'recall': 0.08872439667410262, 'f1-score': 0.1491011331686121, 'support': 9862}, '1': {'precision': 0.3680551000327976, 'recall': 0.5651122973109074, 'f1-score': 0.44577738936998484, 'support': 9929}, '2': {'precision': 0.3992434391993065, 'recall': 0.5056897584348173, 'f1-score': 0.44620601576606334, 'support': 10018}, 'accuracy': 0.38753396625180314, 'macro avg': {'precision': 0.4113217352995903, 'recall': 0.3865088174732758, 'f1-score': 0.3470281794348868, 'support': 29809}, 'weighted avg': {'precision': 0.4111612777614468, 'recall': 0.38753396625180314, 'f1-score': 0.34776916167291266, 'support': 29809}}
[[ 875 5193 3794]
 [ 489 5611 3829]
 [ 511 4441 5066]]
training model: results/XRAY/W2/deepLOB_L1/h50
Epoch 1/50
286/286 - 11s - loss: 3.3176 - accuracy50: 0.3685 - val_loss: 3.5069 - val_accuracy50: 0.3666 - 11s/epoch - 38ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2665 - accuracy50: 0.3861 - val_loss: 3.3333 - val_accuracy50: 0.3685 - 8s/epoch - 29ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2477 - accuracy50: 0.3987 - val_loss: 3.3358 - val_accuracy50: 0.3449 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2346 - accuracy50: 0.4030 - val_loss: 3.2845 - val_accuracy50: 0.3643 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2261 - accuracy50: 0.4069 - val_loss: 3.2905 - val_accuracy50: 0.3728 - 8s/epoch - 29ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2194 - accuracy50: 0.4090 - val_loss: 3.3166 - val_accuracy50: 0.3541 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2089 - accuracy50: 0.4172 - val_loss: 3.2787 - val_accuracy50: 0.3814 - 9s/epoch - 30ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2036 - accuracy50: 0.4213 - val_loss: 3.2721 - val_accuracy50: 0.3867 - 9s/epoch - 30ms/step
Epoch 9/50
286/286 - 8s - loss: 3.1982 - accuracy50: 0.4245 - val_loss: 3.2715 - val_accuracy50: 0.3831 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1937 - accuracy50: 0.4262 - val_loss: 3.2888 - val_accuracy50: 0.3803 - 8s/epoch - 30ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1874 - accuracy50: 0.4289 - val_loss: 3.2798 - val_accuracy50: 0.3873 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1818 - accuracy50: 0.4314 - val_loss: 3.2925 - val_accuracy50: 0.3795 - 8s/epoch - 29ms/step
Epoch 13/50
286/286 - 8s - loss: 3.1798 - accuracy50: 0.4315 - val_loss: 3.2985 - val_accuracy50: 0.3802 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1748 - accuracy50: 0.4343 - val_loss: 3.3052 - val_accuracy50: 0.3839 - 8s/epoch - 29ms/step
Epoch 15/50
286/286 - 8s - loss: 3.1750 - accuracy50: 0.4345 - val_loss: 3.3103 - val_accuracy50: 0.3847 - 8s/epoch - 29ms/step
Epoch 16/50
286/286 - 8s - loss: 3.1699 - accuracy50: 0.4365 - val_loss: 3.3253 - val_accuracy50: 0.3823 - 8s/epoch - 29ms/step
Epoch 17/50
286/286 - 8s - loss: 3.1669 - accuracy50: 0.4373 - val_loss: 3.3185 - val_accuracy50: 0.3824 - 8s/epoch - 29ms/step
Epoch 18/50
286/286 - 8s - loss: 3.1633 - accuracy50: 0.4381 - val_loss: 3.3278 - val_accuracy50: 0.3786 - 8s/epoch - 29ms/step
Epoch 19/50
286/286 - 8s - loss: 3.1608 - accuracy50: 0.4385 - val_loss: 3.3373 - val_accuracy50: 0.3843 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h50
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0951159
{'0': {'precision': 0.4207461720940263, 'recall': 0.021135533913269562, 'f1-score': 0.04024921090091391, 'support': 92309}, '1': {'precision': 0.37060411144870387, 'recall': 0.5703572894255761, 'f1-score': 0.44927827275265353, 'support': 80411}, '2': {'precision': 0.42755650647355714, 'recall': 0.6143083759471096, 'f1-score': 0.5041950209649964, 'support': 101493}, 'accuracy': 0.4017387942949459, 'macro avg': {'precision': 0.40630226333876246, 'recall': 0.4019337330953185, 'f1-score': 0.3312408348728546, 'support': 274213}, 'weighted avg': {'precision': 0.40856304448384995, 'recall': 0.4017387942949459, 'f1-score': 0.33191185269176315, 'support': 274213}}
[[ 1951 40125 50233]
 [ 1305 45863 33243]
 [ 1381 37764 62348]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987861
{'0': {'precision': 0.4437388370708474, 'recall': 0.09128020901371653, 'f1-score': 0.15141357711190118, 'support': 24496}, '1': {'precision': 0.3723277364895862, 'recall': 0.6675989142058073, 'f1-score': 0.47804447062288324, 'support': 24314}, '2': {'precision': 0.401786812015901, 'recall': 0.4046891769173615, 'f1-score': 0.4032327719168364, 'support': 24226}, 'accuracy': 0.3870967741935484, 'macro avg': {'precision': 0.40595112852544485, 'recall': 0.3878561000456284, 'f1-score': 0.34423027321720695, 'support': 73036}, 'weighted avg': {'precision': 0.4060503100634275, 'recall': 0.3870967741935484, 'f1-score': 0.34367869784921395, 'support': 73036}}
[[ 2236 14479  7781]
 [ 1266 16232  6816]
 [ 1537 12885  9804]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913235
{'0': {'precision': 0.3991660348749052, 'recall': 0.1104468219005664, 'f1-score': 0.1730200460072297, 'support': 9534}, '1': {'precision': 0.4011401425178147, 'recall': 0.4123852314905255, 'f1-score': 0.406684968453499, 'support': 10238}, '2': {'precision': 0.3682566382314069, 'recall': 0.6107402610341736, 'f1-score': 0.4594685754975078, 'support': 10037}, 'accuracy': 0.38260256969371664, 'macro avg': {'precision': 0.3895209385413756, 'recall': 0.37785743814175515, 'f1-score': 0.34639119665274554, 'support': 29809}, 'weighted avg': {'precision': 0.38943653371543374, 'recall': 0.38260256969371664, 'f1-score': 0.34972323519501947, 'support': 29809}}
[[1053 3294 5187]
 [ 687 4222 5329]
 [ 898 3009 6130]]
training model: results/XRAY/W2/deepLOB_L1/h100
Epoch 1/50
286/286 - 11s - loss: 3.3416 - accuracy100: 0.3500 - val_loss: 3.3426 - val_accuracy100: 0.3487 - 11s/epoch - 38ms/step
Epoch 2/50
286/286 - 8s - loss: 3.3045 - accuracy100: 0.3625 - val_loss: 3.3314 - val_accuracy100: 0.3474 - 8s/epoch - 30ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2903 - accuracy100: 0.3676 - val_loss: 3.3174 - val_accuracy100: 0.3515 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2814 - accuracy100: 0.3693 - val_loss: 3.3009 - val_accuracy100: 0.3718 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2758 - accuracy100: 0.3729 - val_loss: 3.2871 - val_accuracy100: 0.3690 - 8s/epoch - 30ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2681 - accuracy100: 0.3756 - val_loss: 3.3146 - val_accuracy100: 0.3590 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2632 - accuracy100: 0.3799 - val_loss: 3.3217 - val_accuracy100: 0.3498 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2630 - accuracy100: 0.3807 - val_loss: 3.3114 - val_accuracy100: 0.3542 - 9s/epoch - 30ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2575 - accuracy100: 0.3834 - val_loss: 3.3124 - val_accuracy100: 0.3521 - 9s/epoch - 30ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2586 - accuracy100: 0.3855 - val_loss: 3.3364 - val_accuracy100: 0.3497 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2552 - accuracy100: 0.3867 - val_loss: 3.3361 - val_accuracy100: 0.3500 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2499 - accuracy100: 0.3923 - val_loss: 3.3457 - val_accuracy100: 0.3346 - 8s/epoch - 28ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2467 - accuracy100: 0.3921 - val_loss: 3.3630 - val_accuracy100: 0.3394 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2436 - accuracy100: 0.3952 - val_loss: 3.3630 - val_accuracy100: 0.3399 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.2400 - accuracy100: 0.3973 - val_loss: 3.3910 - val_accuracy100: 0.3331 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepLOB_L1/h100
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032152
{'0': {'precision': 0.3288219703377883, 'recall': 0.06389926906512662, 'f1-score': 0.10700456939423411, 'support': 91253}, '1': {'precision': 0.3119975142735076, 'recall': 0.4996641122611465, 'f1-score': 0.38413534877270833, 'support': 80384}, '2': {'precision': 0.40245019374535207, 'recall': 0.5011991109031352, 'f1-score': 0.4464291141493828, 'support': 102576}, 'accuracy': 0.35522385882507396, 'macro avg': {'precision': 0.347756559452216, 'recall': 0.35492083074313613, 'f1-score': 0.3125230107721084, 'support': 274213}, 'weighted avg': {'precision': 0.3514323920463985, 'recall': 0.35522385882507396, 'f1-score': 0.31521385441122235, 'support': 274213}}
[[ 5831 43501 41921]
 [ 5806 40165 34413]
 [ 6096 45069 51411]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1002584
{'0': {'precision': 0.3541067917107851, 'recall': 0.09473897207608256, 'f1-score': 0.14948437150793398, 'support': 24710}, '1': {'precision': 0.3394423762788639, 'recall': 0.5397383889394818, 'f1-score': 0.4167745441178822, 'support': 24158}, '2': {'precision': 0.36566471512209053, 'recall': 0.4238248924197286, 'f1-score': 0.39260252970486775, 'support': 24168}, 'accuracy': 0.35082698942987023, 'macro avg': {'precision': 0.3530712943705798, 'recall': 0.3527674178117643, 'f1-score': 0.31962048177689467, 'support': 73036}, 'weighted avg': {'precision': 0.35308084484896457, 'recall': 0.35082698942987023, 'f1-score': 0.3183445998503216, 'support': 73036}}
[[ 2341 13432  8937]
 [ 2287 13039  8832]
 [ 1983 11942 10243]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0961703
{'0': {'precision': 0.3325, 'recall': 0.05598232137219825, 'f1-score': 0.09582995586778348, 'support': 9503}, '1': {'precision': 0.3773761520737327, 'recall': 0.5029267824584973, 'f1-score': 0.43119832160928057, 'support': 10421}, '2': {'precision': 0.36149710215767056, 'recall': 0.5237228123419322, 'f1-score': 0.4277451871436834, 'support': 9885}, 'accuracy': 0.36733872320440136, 'macro avg': {'precision': 0.3571244180771344, 'recall': 0.36087730539087587, 'f1-score': 0.3182578215402492, 'support': 29809}, 'weighted avg': {'precision': 0.3578041274644886, 'recall': 0.36733872320440136, 'f1-score': 0.32313901690822133, 'support': 29809}}
[[ 532 4447 4524]
 [ 560 5241 4620]
 [ 508 4200 5177]]
training model: results/XRAY/W2/deepLOB_L1/h200
Epoch 1/50
286/286 - 10s - loss: 3.3253 - accuracy200: 0.3680 - val_loss: 3.3460 - val_accuracy200: 0.3532 - 10s/epoch - 36ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2934 - accuracy200: 0.3774 - val_loss: 3.3668 - val_accuracy200: 0.3563 - 8s/epoch - 29ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2764 - accuracy200: 0.3891 - val_loss: 3.3753 - val_accuracy200: 0.3479 - 8s/epoch - 29ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2619 - accuracy200: 0.3921 - val_loss: 3.3978 - val_accuracy200: 0.3298 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2574 - accuracy200: 0.3947 - val_loss: 3.4337 - val_accuracy200: 0.3300 - 8s/epoch - 29ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2503 - accuracy200: 0.3970 - val_loss: 3.3744 - val_accuracy200: 0.3337 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2451 - accuracy200: 0.4031 - val_loss: 3.3816 - val_accuracy200: 0.3243 - 8s/epoch - 28ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2349 - accuracy200: 0.4089 - val_loss: 3.4542 - val_accuracy200: 0.2955 - 8s/epoch - 28ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2345 - accuracy200: 0.4086 - val_loss: 3.4881 - val_accuracy200: 0.3070 - 8s/epoch - 28ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2282 - accuracy200: 0.4115 - val_loss: 3.4840 - val_accuracy200: 0.3064 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2244 - accuracy200: 0.4122 - val_loss: 3.4483 - val_accuracy200: 0.3165 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h200
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205064
{'0': {'precision': 0.355674709562109, 'recall': 0.0747500414295973, 'f1-score': 0.12353703737515749, 'support': 90515}, '1': {'precision': 0.3294484227558005, 'recall': 0.6379970869389604, 'f1-score': 0.43451983994664883, 'support': 81701}, '2': {'precision': 0.3932619030431779, 'recall': 0.3738835455944783, 'f1-score': 0.38332797233726035, 'support': 101997}, 'accuracy': 0.35383442798116793, 'macro avg': {'precision': 0.35946167845369575, 'recall': 0.3622102246543453, 'f1-score': 0.31379494988635553, 'support': 274213}, 'weighted avg': {'precision': 0.3618416933124285, 'recall': 0.35383442798116793, 'f1-score': 0.3128260278541757, 'support': 274213}}
[[ 6766 49205 34544]
 [ 5284 52125 24292]
 [ 6973 56889 38135]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1277878
{'0': {'precision': 0.40261002360127723, 'recall': 0.11568072120946188, 'f1-score': 0.1797223599405057, 'support': 25069}, '1': {'precision': 0.3444211964644092, 'recall': 0.681710615280595, 'f1-score': 0.457632407591274, 'support': 23664}, '2': {'precision': 0.3554619636746512, 'recall': 0.2778257828251656, 'f1-score': 0.31188507552311884, 'support': 24303}, 'accuracy': 0.3530313817843255, 'macro avg': {'precision': 0.36749772791344587, 'recall': 0.35840570643840747, 'f1-score': 0.3164132810182995, 'support': 73036}, 'weighted avg': {'precision': 0.3680678840295094, 'recall': 0.3530313817843255, 'f1-score': 0.31374412789619915, 'support': 73036}}
[[ 2900 15444  6725]
 [ 2014 16132  5518]
 [ 2289 15262  6752]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1160125
{'0': {'precision': 0.328544061302682, 'recall': 0.10505359877488514, 'f1-score': 0.15920167092132745, 'support': 9795}, '1': {'precision': 0.3562113028586484, 'recall': 0.5479785185935758, 'f1-score': 0.43175921120913335, 'support': 9869}, '2': {'precision': 0.35293605915615484, 'recall': 0.39990142927550515, 'f1-score': 0.3749537892791127, 'support': 10145}, 'accuracy': 0.3520413297997249, 'macro avg': {'precision': 0.3458971411058284, 'recall': 0.35097784888132205, 'f1-score': 0.32197155713652453, 'support': 29809}, 'weighted avg': {'precision': 0.34600539261669166, 'recall': 0.3520413297997249, 'f1-score': 0.32286618854486693, 'support': 29809}}
[[1029 4693 4073]
 [1096 5408 3365]
 [1007 5081 4057]]
training model: results/XRAY/W2/deepLOB_L1/h300
Epoch 1/50
286/286 - 12s - loss: 3.3412 - accuracy300: 0.3530 - val_loss: 3.4921 - val_accuracy300: 0.3241 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2998 - accuracy300: 0.3713 - val_loss: 3.4219 - val_accuracy300: 0.3526 - 8s/epoch - 29ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2851 - accuracy300: 0.3765 - val_loss: 3.4353 - val_accuracy300: 0.3488 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2758 - accuracy300: 0.3766 - val_loss: 3.4709 - val_accuracy300: 0.3555 - 8s/epoch - 28ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2639 - accuracy300: 0.3879 - val_loss: 3.4792 - val_accuracy300: 0.3535 - 8s/epoch - 28ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2546 - accuracy300: 0.3966 - val_loss: 3.4990 - val_accuracy300: 0.3459 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2450 - accuracy300: 0.3998 - val_loss: 3.4683 - val_accuracy300: 0.3501 - 8s/epoch - 28ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2367 - accuracy300: 0.4060 - val_loss: 3.5169 - val_accuracy300: 0.3224 - 8s/epoch - 29ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2333 - accuracy300: 0.4060 - val_loss: 3.5394 - val_accuracy300: 0.3428 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2245 - accuracy300: 0.4113 - val_loss: 3.5504 - val_accuracy300: 0.3397 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2225 - accuracy300: 0.4122 - val_loss: 3.5916 - val_accuracy300: 0.3334 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2164 - accuracy300: 0.4145 - val_loss: 3.5783 - val_accuracy300: 0.3246 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h300
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1518418
{'0': {'precision': 0.33582430989781914, 'recall': 0.02447237688794052, 'f1-score': 0.04562028673241071, 'support': 89979}, '1': {'precision': 0.31365513595665245, 'recall': 0.603276480008134, 'f1-score': 0.41272601590317237, 'support': 78682}, '2': {'precision': 0.39313623507363243, 'recall': 0.43324617250265274, 'f1-score': 0.41221780027312926, 'support': 105552}, 'accuracy': 0.34790108419367427, 'macro avg': {'precision': 0.34753856030936797, 'recall': 0.35366500979957577, 'f1-score': 0.29018803430290413, 'support': 274213}, 'weighted avg': {'precision': 0.3515240520038409, 'recall': 0.34790108419367427, 'f1-score': 0.29206999455758237, 'support': 274213}}
[[ 2202 46412 41365]
 [ 1989 47467 29226]
 [ 2366 57456 45730]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1433382
{'0': {'precision': 0.39205882352941174, 'recall': 0.05387600032333684, 'f1-score': 0.09473384976192169, 'support': 24742}, '1': {'precision': 0.35190865712338104, 'recall': 0.6787181594083813, 'f1-score': 0.46349812019527514, 'support': 24340}, '2': {'precision': 0.3491098184382161, 'recall': 0.3307172079819654, 'f1-score': 0.33966470865669074, 'support': 23954}, 'accuracy': 0.3529081548825237, 'macro avg': {'precision': 0.364359099697003, 'recall': 0.3544371225712279, 'f1-score': 0.29929889287129585, 'support': 73036}, 'weighted avg': {'precision': 0.3645921561560988, 'recall': 0.3529081548825237, 'f1-score': 0.2979596033124053, 'support': 73036}}
[[ 1333 15358  8051]
 [ 1101 16520  6719]
 [  966 15066  7922]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1413859
{'0': {'precision': 0.3496027241770715, 'recall': 0.031801755291688175, 'f1-score': 0.05830020821502934, 'support': 9685}, '1': {'precision': 0.35143249270886945, 'recall': 0.42372530768435207, 'f1-score': 0.3842078116940966, 'support': 9669}, '2': {'precision': 0.35124493341053853, 'recall': 0.5802008608321377, 'f1-score': 0.4375834084761046, 'support': 10455}, 'accuracy': 0.35126975074641886, 'macro avg': {'precision': 0.35076005009882644, 'recall': 0.3452426412693927, 'f1-score': 0.2933638094617435, 'support': 29809}, 'weighted avg': {'precision': 0.35077221424617316, 'recall': 0.35126975074641886, 'f1-score': 0.2970404033496747, 'support': 29809}}
[[ 308 3468 5909]
 [ 277 4097 5295]
 [ 296 4093 6066]]
training model: results/XRAY/W2/deepLOB_L1/h500
Epoch 1/50
286/286 - 11s - loss: 3.3263 - accuracy500: 0.3615 - val_loss: 3.6616 - val_accuracy500: 0.3126 - 11s/epoch - 39ms/step
Epoch 2/50
286/286 - 9s - loss: 3.2810 - accuracy500: 0.3856 - val_loss: 3.5213 - val_accuracy500: 0.3220 - 9s/epoch - 31ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2679 - accuracy500: 0.3858 - val_loss: 3.5588 - val_accuracy500: 0.3319 - 8s/epoch - 30ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2508 - accuracy500: 0.3990 - val_loss: 3.5063 - val_accuracy500: 0.3290 - 8s/epoch - 29ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2307 - accuracy500: 0.4066 - val_loss: 3.5433 - val_accuracy500: 0.3184 - 8s/epoch - 29ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2261 - accuracy500: 0.4119 - val_loss: 3.5670 - val_accuracy500: 0.3270 - 9s/epoch - 30ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2152 - accuracy500: 0.4132 - val_loss: 3.6301 - val_accuracy500: 0.3244 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2087 - accuracy500: 0.4163 - val_loss: 3.6072 - val_accuracy500: 0.3289 - 8s/epoch - 29ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2096 - accuracy500: 0.4136 - val_loss: 3.6596 - val_accuracy500: 0.3304 - 8s/epoch - 29ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1904 - accuracy500: 0.4266 - val_loss: 3.7415 - val_accuracy500: 0.3300 - 8s/epoch - 28ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1848 - accuracy500: 0.4256 - val_loss: 3.7005 - val_accuracy500: 0.3198 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1749 - accuracy500: 0.4302 - val_loss: 3.7669 - val_accuracy500: 0.3290 - 8s/epoch - 29ms/step
Epoch 13/50
286/286 - 8s - loss: 3.1708 - accuracy500: 0.4325 - val_loss: 3.8290 - val_accuracy500: 0.3309 - 8s/epoch - 29ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1631 - accuracy500: 0.4382 - val_loss: 3.8708 - val_accuracy500: 0.3289 - 8s/epoch - 29ms/step
testing model: results/XRAY/W2/deepLOB_L1/h500
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1987628
{'0': {'precision': 0.25390929888305747, 'recall': 0.10748302419906121, 'f1-score': 0.15103220280643898, 'support': 87772}, '1': {'precision': 0.29971988795518206, 'recall': 0.2990687451563314, 'f1-score': 0.29939396251852135, 'support': 78711}, '2': {'precision': 0.3867951904515575, 'recall': 0.5691450849345586, 'f1-score': 0.46057810762897744, 'support': 107730}, 'accuracy': 0.34384948926564385, 'macro avg': {'precision': 0.3134747924299323, 'recall': 0.32523228476331706, 'f1-score': 0.3036680909846459, 'support': 274213}, 'weighted avg': {'precision': 0.31926577131554795, 'recall': 0.34384948926564385, 'f1-score': 0.3152296799327232, 'support': 274213}}
[[ 9434 23666 54672]
 [12639 23540 42532]
 [15082 31334 61314]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1732535
{'0': {'precision': 0.3526149684400361, 'recall': 0.32096688143801044, 'f1-score': 0.33604743592497904, 'support': 24367}, '1': {'precision': 0.3724303554274736, 'recall': 0.30912135225641846, 'f1-score': 0.33783548274660163, 'support': 25084}, '2': {'precision': 0.32917166067385806, 'recall': 0.4192071231715073, 'f1-score': 0.36877342832099363, 'support': 23585}, 'accuracy': 0.3486225970754149, 'macro avg': {'precision': 0.35140566151378927, 'recall': 0.3497651189553121, 'f1-score': 0.3475521156641914, 'support': 73036}, 'weighted avg': {'precision': 0.3518501230696376, 'recall': 0.3486225970754149, 'f1-score': 0.34722950910989586, 'support': 73036}}
[[ 7821  6600  9946]
 [ 7127  7754 10203]
 [ 7232  6466  9887]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1701518
{'0': {'precision': 0.30342098544804696, 'recall': 0.24693538333679618, 'f1-score': 0.2722794959908362, 'support': 9626}, '1': {'precision': 0.34523809523809523, 'recall': 0.14622350277834945, 'f1-score': 0.20543588260806708, 'support': 9718}, '2': {'precision': 0.33036564197323476, 'recall': 0.5637840420449116, 'f1-score': 0.4166078237537071, 'support': 10465}, 'accuracy': 0.3253379851722634, 'macro avg': {'precision': 0.3263415742197923, 'recall': 0.3189809760533524, 'f1-score': 0.29810773411753677, 'support': 29809}, 'weighted avg': {'precision': 0.3265131557146033, 'recall': 0.3253379851722634, 'f1-score': 0.30115700664817774, 'support': 29809}}
[[2377 1312 5937]
 [2275 1421 6022]
 [3182 1383 5900]]
training model: results/XRAY/W2/deepLOB_L1/h1000
Epoch 1/50
286/286 - 10s - loss: 3.3102 - accuracy1000: 0.3762 - val_loss: 3.5574 - val_accuracy1000: 0.3420 - 10s/epoch - 36ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2765 - accuracy1000: 0.3931 - val_loss: 3.6148 - val_accuracy1000: 0.3121 - 8s/epoch - 28ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2624 - accuracy1000: 0.3992 - val_loss: 3.5507 - val_accuracy1000: 0.3276 - 8s/epoch - 29ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2488 - accuracy1000: 0.4011 - val_loss: 3.6116 - val_accuracy1000: 0.2892 - 8s/epoch - 28ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2199 - accuracy1000: 0.4131 - val_loss: 3.5745 - val_accuracy1000: 0.2804 - 8s/epoch - 29ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2028 - accuracy1000: 0.4277 - val_loss: 3.6397 - val_accuracy1000: 0.2866 - 8s/epoch - 29ms/step
Epoch 7/50
286/286 - 8s - loss: 3.1954 - accuracy1000: 0.4290 - val_loss: 3.6121 - val_accuracy1000: 0.2903 - 8s/epoch - 29ms/step
Epoch 8/50
286/286 - 8s - loss: 3.1711 - accuracy1000: 0.4327 - val_loss: 3.6236 - val_accuracy1000: 0.2810 - 8s/epoch - 30ms/step
Epoch 9/50
286/286 - 8s - loss: 3.1430 - accuracy1000: 0.4432 - val_loss: 3.7203 - val_accuracy1000: 0.2887 - 8s/epoch - 30ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1487 - accuracy1000: 0.4405 - val_loss: 3.7100 - val_accuracy1000: 0.2948 - 8s/epoch - 29ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1287 - accuracy1000: 0.4477 - val_loss: 3.7498 - val_accuracy1000: 0.2841 - 8s/epoch - 29ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1136 - accuracy1000: 0.4558 - val_loss: 3.8085 - val_accuracy1000: 0.3123 - 8s/epoch - 28ms/step
Epoch 13/50
286/286 - 8s - loss: 3.0957 - accuracy1000: 0.4619 - val_loss: 3.7353 - val_accuracy1000: 0.3009 - 8s/epoch - 28ms/step
testing model: results/XRAY/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1997807
{'0': {'precision': 0.2411362600638007, 'recall': 0.0953450657697159, 'f1-score': 0.13665633608815425, 'support': 83245}, '1': {'precision': 0.2933933093520269, 'recall': 0.5357405491642881, 'f1-score': 0.3791491351098644, 'support': 80231}, '2': {'precision': 0.377868031014294, 'recall': 0.32346912052882054, 'f1-score': 0.3485588618803884, 'support': 110737}, 'accuracy': 0.31632344199582074, 'macro avg': {'precision': 0.3041325334767072, 'recall': 0.3181849118209415, 'f1-score': 0.288121444359469, 'support': 274213}, 'weighted avg': {'precision': 0.311643134067544, 'recall': 0.31632344199582074, 'f1-score': 0.29318024180001134, 'support': 274213}}
[[ 7937 42283 33025]
 [11298 42983 25950]
 [13680 61237 35820]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1450795
{'0': {'precision': 0.3850173257796601, 'recall': 0.28797103834128684, 'f1-score': 0.32949704629433507, 'support': 24308}, '1': {'precision': 0.37285044953779917, 'recall': 0.5796062992125984, 'f1-score': 0.4537874701394775, 'support': 25400}, '2': {'precision': 0.3398178269355888, 'recall': 0.2238940329218107, 'f1-score': 0.2699364308232983, 'support': 23328}, 'accuracy': 0.3689276521167643, 'macro avg': {'precision': 0.36589520075101606, 'recall': 0.3638237901585653, 'f1-score': 0.35107364908570365, 'support': 73036}, 'weighted avg': {'precision': 0.36634909962300083, 'recall': 0.3689276521167643, 'f1-score': 0.35369808041392364, 'support': 73036}}
[[ 7000 12292  5016]
 [ 5547 14722  5131]
 [ 5634 12471  5223]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1752666
{'0': {'precision': 0.3290218270008084, 'recall': 0.28716863219433525, 'f1-score': 0.3066738428417653, 'support': 9921}, '1': {'precision': 0.315270125812022, 'recall': 0.43214607754733997, 'f1-score': 0.36456996148908855, 'support': 8872}, '2': {'precision': 0.33807987540327067, 'recall': 0.2758714596949891, 'f1-score': 0.3038240439890028, 'support': 11016}, 'accuracy': 0.3261431111409306, 'macro avg': {'precision': 0.3274572760720337, 'recall': 0.3317287231455548, 'f1-score': 0.3250226161066189, 'support': 29809}, 'weighted avg': {'precision': 0.3282763598014595, 'recall': 0.3261431111409306, 'f1-score': 0.32285221113580476, 'support': 29809}}
[[2849 4006 3066]
 [2154 3834 2884]
 [3656 4321 3039]]
training model: results/XRAY/W2/deepOF_L1/h10
Epoch 1/50
286/286 - 10s - loss: 3.2952 - accuracy10: 0.3678 - val_loss: 3.2871 - val_accuracy10: 0.3839 - 10s/epoch - 36ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2514 - accuracy10: 0.3850 - val_loss: 3.2831 - val_accuracy10: 0.3875 - 8s/epoch - 27ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2308 - accuracy10: 0.3961 - val_loss: 3.2780 - val_accuracy10: 0.3884 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2210 - accuracy10: 0.3959 - val_loss: 3.2690 - val_accuracy10: 0.3931 - 8s/epoch - 27ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2127 - accuracy10: 0.4002 - val_loss: 3.2743 - val_accuracy10: 0.3928 - 8s/epoch - 26ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2058 - accuracy10: 0.4022 - val_loss: 3.2639 - val_accuracy10: 0.3945 - 8s/epoch - 27ms/step
Epoch 7/50
286/286 - 8s - loss: 3.1996 - accuracy10: 0.4079 - val_loss: 3.2637 - val_accuracy10: 0.3941 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.1947 - accuracy10: 0.4098 - val_loss: 3.2619 - val_accuracy10: 0.3953 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 8s - loss: 3.1874 - accuracy10: 0.4129 - val_loss: 3.2649 - val_accuracy10: 0.3962 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.1837 - accuracy10: 0.4142 - val_loss: 3.2672 - val_accuracy10: 0.3946 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1798 - accuracy10: 0.4174 - val_loss: 3.2661 - val_accuracy10: 0.3979 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1748 - accuracy10: 0.4202 - val_loss: 3.2664 - val_accuracy10: 0.3962 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.1711 - accuracy10: 0.4194 - val_loss: 3.2645 - val_accuracy10: 0.3974 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1672 - accuracy10: 0.4224 - val_loss: 3.2731 - val_accuracy10: 0.3979 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.1615 - accuracy10: 0.4248 - val_loss: 3.2767 - val_accuracy10: 0.3982 - 8s/epoch - 28ms/step
Epoch 16/50
286/286 - 8s - loss: 3.1586 - accuracy10: 0.4280 - val_loss: 3.2791 - val_accuracy10: 0.3994 - 8s/epoch - 28ms/step
Epoch 17/50
286/286 - 8s - loss: 3.1550 - accuracy10: 0.4308 - val_loss: 3.2783 - val_accuracy10: 0.3988 - 8s/epoch - 28ms/step
Epoch 18/50
286/286 - 8s - loss: 3.1500 - accuracy10: 0.4328 - val_loss: 3.2839 - val_accuracy10: 0.3979 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h10
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0975283
{'0': {'precision': 0.516163562406337, 'recall': 0.10442541119400561, 'f1-score': 0.17370786314471753, 'support': 92353}, '1': {'precision': 0.31649342612122205, 'recall': 0.8866362381912748, 'f1-score': 0.4664743112434847, 'support': 84789}, '2': {'precision': 0.491580058911799, 'recall': 0.09112356540910309, 'f1-score': 0.15374720795418004, 'support': 97066}, 'accuracy': 0.3415874080989614, 'macro avg': {'precision': 0.4414123491464526, 'recall': 0.3607284049314612, 'f1-score': 0.26464312744746077, 'support': 274208}, 'weighted avg': {'precision': 0.44572049168746875, 'recall': 0.3415874080989614, 'f1-score': 0.25716959077892826, 'support': 274208}}
[[ 9644 78272  4437]
 [ 4901 75177  4711]
 [ 4139 84082  8845]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730877
{'0': {'precision': 0.4812511107161898, 'recall': 0.11742769177399072, 'f1-score': 0.18878973786949246, 'support': 23061}, '1': {'precision': 0.38321074101435776, 'recall': 0.8731018332174613, 'f1-score': 0.5326413304313856, 'support': 27329}, '2': {'precision': 0.45505836575875486, 'recall': 0.1032990328136731, 'f1-score': 0.16837634524709355, 'support': 22643}, 'accuracy': 0.39582106718880505, 'macro avg': {'precision': 0.43984007249643414, 'recall': 0.364609519268375, 'f1-score': 0.2966024711826572, 'support': 73033}, 'weighted avg': {'precision': 0.4364435909969866, 'recall': 0.39582106718880505, 'f1-score': 0.3111303198526371, 'support': 73033}}
[[ 2708 19180  1173]
 [ 1840 23861  1628]
 [ 1079 19225  2339]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779892
{'0': {'precision': 0.4497742663656885, 'recall': 0.0864612714254719, 'f1-score': 0.14504094631483166, 'support': 9218}, '1': {'precision': 0.38885915277565375, 'recall': 0.8900848866719174, 'f1-score': 0.5412553548146769, 'support': 11427}, '2': {'precision': 0.4370015948963317, 'recall': 0.08969882147533828, 'f1-score': 0.14884563150746946, 'support': 9164}, 'accuracy': 0.3955181321077527, 'macro avg': {'precision': 0.42521167134589133, 'recall': 0.3554149931909092, 'f1-score': 0.278380644212326, 'support': 29809}, 'weighted avg': {'precision': 0.42249640517146814, 'recall': 0.3955181321077527, 'f1-score': 0.29809566740688653, 'support': 29809}}
[[  797  7997   424]
 [  621 10171   635]
 [  354  7988   822]]
training model: results/XRAY/W2/deepOF_L1/h20
Epoch 1/50
286/286 - 10s - loss: 3.3048 - accuracy20: 0.3645 - val_loss: 3.2982 - val_accuracy20: 0.3521 - 10s/epoch - 35ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2595 - accuracy20: 0.3879 - val_loss: 3.2904 - val_accuracy20: 0.3553 - 8s/epoch - 27ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2453 - accuracy20: 0.3923 - val_loss: 3.2858 - val_accuracy20: 0.3560 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2340 - accuracy20: 0.3983 - val_loss: 3.2778 - val_accuracy20: 0.3588 - 8s/epoch - 27ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2250 - accuracy20: 0.4011 - val_loss: 3.2786 - val_accuracy20: 0.3552 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2188 - accuracy20: 0.4039 - val_loss: 3.2743 - val_accuracy20: 0.3591 - 8s/epoch - 26ms/step
Epoch 7/50
286/286 - 7s - loss: 3.2131 - accuracy20: 0.4083 - val_loss: 3.2770 - val_accuracy20: 0.3590 - 7s/epoch - 25ms/step
Epoch 8/50
286/286 - 7s - loss: 3.2077 - accuracy20: 0.4097 - val_loss: 3.2759 - val_accuracy20: 0.3595 - 7s/epoch - 25ms/step
Epoch 9/50
286/286 - 7s - loss: 3.2045 - accuracy20: 0.4108 - val_loss: 3.2749 - val_accuracy20: 0.3595 - 7s/epoch - 26ms/step
Epoch 10/50
286/286 - 7s - loss: 3.1997 - accuracy20: 0.4157 - val_loss: 3.2753 - val_accuracy20: 0.3616 - 7s/epoch - 26ms/step
Epoch 11/50
286/286 - 8s - loss: 3.1957 - accuracy20: 0.4158 - val_loss: 3.2722 - val_accuracy20: 0.3649 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 7s - loss: 3.1916 - accuracy20: 0.4178 - val_loss: 3.2754 - val_accuracy20: 0.3616 - 7s/epoch - 26ms/step
Epoch 13/50
286/286 - 7s - loss: 3.1875 - accuracy20: 0.4207 - val_loss: 3.2752 - val_accuracy20: 0.3632 - 7s/epoch - 26ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1857 - accuracy20: 0.4224 - val_loss: 3.2797 - val_accuracy20: 0.3615 - 8s/epoch - 26ms/step
Epoch 15/50
286/286 - 8s - loss: 3.1789 - accuracy20: 0.4244 - val_loss: 3.2816 - val_accuracy20: 0.3630 - 8s/epoch - 27ms/step
Epoch 16/50
286/286 - 7s - loss: 3.1774 - accuracy20: 0.4247 - val_loss: 3.2823 - val_accuracy20: 0.3615 - 7s/epoch - 26ms/step
Epoch 17/50
286/286 - 7s - loss: 3.1747 - accuracy20: 0.4277 - val_loss: 3.2861 - val_accuracy20: 0.3625 - 7s/epoch - 26ms/step
Epoch 18/50
286/286 - 8s - loss: 3.1725 - accuracy20: 0.4284 - val_loss: 3.2877 - val_accuracy20: 0.3633 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.1683 - accuracy20: 0.4304 - val_loss: 3.2846 - val_accuracy20: 0.3630 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 7s - loss: 3.1629 - accuracy20: 0.4319 - val_loss: 3.2951 - val_accuracy20: 0.3643 - 7s/epoch - 25ms/step
Epoch 21/50
286/286 - 7s - loss: 3.1589 - accuracy20: 0.4343 - val_loss: 3.2914 - val_accuracy20: 0.3641 - 7s/epoch - 26ms/step
testing model: results/XRAY/W2/deepOF_L1/h20
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.105577
{'0': {'precision': 0.5281610957783911, 'recall': 0.10858920202593363, 'f1-score': 0.18014154725795767, 'support': 95166}, '1': {'precision': 0.2864652985934978, 'recall': 0.8777505170265514, 'f1-score': 0.4319561039749165, 'support': 77849}, '2': {'precision': 0.5020798410628919, 'recall': 0.07991659502139475, 'f1-score': 0.1378857630008525, 'support': 101193}, 'accuracy': 0.3163766192087758, 'macro avg': {'precision': 0.4389020784782603, 'recall': 0.3554187713579599, 'f1-score': 0.24999447141124223, 'support': 274208}, 'weighted avg': {'precision': 0.44991751235459504, 'recall': 0.3163766192087758, 'f1-score': 0.2360389749388761, 'support': 274208}}
[[10334 81162  3670]
 [ 5167 68332  4350]
 [ 4065 89041  8087]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0826731
{'0': {'precision': 0.5214056368176954, 'recall': 0.12013480744728947, 'f1-score': 0.19527674783712465, 'support': 24331}, '1': {'precision': 0.34500524759087875, 'recall': 0.8778474610560388, 'f1-score': 0.49533681122361617, 'support': 24715}, '2': {'precision': 0.4970270865448139, 'recall': 0.09409263350981782, 'f1-score': 0.15823051037577118, 'support': 23987}, 'accuracy': 0.36799802828858186, 'macro avg': {'precision': 0.4544793236511293, 'recall': 0.3640249673377154, 'f1-score': 0.282948023145504, 'support': 73033}, 'weighted avg': {'precision': 0.4537033117709852, 'recall': 0.36799802828858186, 'f1-score': 0.28465218590774544, 'support': 73033}}
[[ 2923 20456   952]
 [ 1687 21696  1332]
 [  996 20734  2257]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896487
{'0': {'precision': 0.4673972602739726, 'recall': 0.08754105090311987, 'f1-score': 0.14746304780015557, 'support': 9744}, '1': {'precision': 0.3493888740814073, 'recall': 0.8907873022036695, 'f1-score': 0.5019144513729352, 'support': 10301}, '2': {'precision': 0.4787914003486345, 'recall': 0.08439164276935682, 'f1-score': 0.1434915106660862, 'support': 9764}, 'accuracy': 0.3640846724143715, 'macro avg': {'precision': 0.43185917823467146, 'recall': 0.3542399986253821, 'f1-score': 0.2642896699463923, 'support': 29809}, 'weighted avg': {'precision': 0.4303496571178581, 'recall': 0.3640846724143715, 'f1-score': 0.2686487910195239, 'support': 29809}}
[[ 853 8519  372]
 [ 600 9176  525]
 [ 372 8568  824]]
training model: results/XRAY/W2/deepOF_L1/h30
Epoch 1/50
286/286 - 10s - loss: 3.3052 - accuracy30: 0.3659 - val_loss: 3.2852 - val_accuracy30: 0.3536 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2647 - accuracy30: 0.3877 - val_loss: 3.2785 - val_accuracy30: 0.3571 - 8s/epoch - 27ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2495 - accuracy30: 0.3926 - val_loss: 3.2754 - val_accuracy30: 0.3542 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2379 - accuracy30: 0.3972 - val_loss: 3.2743 - val_accuracy30: 0.3551 - 8s/epoch - 27ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2298 - accuracy30: 0.4029 - val_loss: 3.2710 - val_accuracy30: 0.3522 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2244 - accuracy30: 0.4050 - val_loss: 3.2728 - val_accuracy30: 0.3529 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2191 - accuracy30: 0.4091 - val_loss: 3.2719 - val_accuracy30: 0.3537 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2150 - accuracy30: 0.4084 - val_loss: 3.2727 - val_accuracy30: 0.3542 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2108 - accuracy30: 0.4106 - val_loss: 3.2720 - val_accuracy30: 0.3543 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2046 - accuracy30: 0.4161 - val_loss: 3.2731 - val_accuracy30: 0.3558 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2046 - accuracy30: 0.4164 - val_loss: 3.2698 - val_accuracy30: 0.3572 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.1983 - accuracy30: 0.4192 - val_loss: 3.2712 - val_accuracy30: 0.3524 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.1951 - accuracy30: 0.4207 - val_loss: 3.2713 - val_accuracy30: 0.3589 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.1932 - accuracy30: 0.4191 - val_loss: 3.2753 - val_accuracy30: 0.3573 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.1880 - accuracy30: 0.4228 - val_loss: 3.2775 - val_accuracy30: 0.3543 - 8s/epoch - 26ms/step
Epoch 16/50
286/286 - 8s - loss: 3.1857 - accuracy30: 0.4237 - val_loss: 3.2776 - val_accuracy30: 0.3545 - 8s/epoch - 27ms/step
Epoch 17/50
286/286 - 8s - loss: 3.1820 - accuracy30: 0.4268 - val_loss: 3.2763 - val_accuracy30: 0.3570 - 8s/epoch - 27ms/step
Epoch 18/50
286/286 - 8s - loss: 3.1787 - accuracy30: 0.4281 - val_loss: 3.2791 - val_accuracy30: 0.3558 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.1739 - accuracy30: 0.4308 - val_loss: 3.2818 - val_accuracy30: 0.3555 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 8s - loss: 3.1723 - accuracy30: 0.4293 - val_loss: 3.2813 - val_accuracy30: 0.3607 - 8s/epoch - 27ms/step
Epoch 21/50
286/286 - 8s - loss: 3.1710 - accuracy30: 0.4318 - val_loss: 3.2870 - val_accuracy30: 0.3573 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h30
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0990045
{'0': {'precision': 0.4980195865070729, 'recall': 0.12082492951351123, 'f1-score': 0.1944694664921733, 'support': 94699}, '1': {'precision': 0.2830104363531416, 'recall': 0.7871615935367764, 'f1-score': 0.4163348318684667, 'support': 77237}, '2': {'precision': 0.46633889087263436, 'recall': 0.16600829161451816, 'f1-score': 0.24485322218937258, 'support': 102272}, 'accuracy': 0.32536614540786557, 'macro avg': {'precision': 0.4157896379109496, 'recall': 0.35799827155493524, 'f1-score': 0.28521917351667087, 'support': 274208}, 'weighted avg': {'precision': 0.4256412830499729, 'recall': 0.32536614540786557, 'f1-score': 0.27575470502727345, 'support': 274208}}
[[11442 73749  9508]
 [ 6518 60798  9921]
 [ 5015 80279 16978]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0845239
{'0': {'precision': 0.49835722819593786, 'recall': 0.13467592218903868, 'f1-score': 0.2120480396517761, 'support': 24778}, '1': {'precision': 0.3290051656885828, 'recall': 0.7915874022405411, 'f1-score': 0.4648189750400278, 'support': 23655}, '2': {'precision': 0.45717924227952883, 'recall': 0.17512195121951218, 'f1-score': 0.2532404549863328, 'support': 24600}, 'accuracy': 0.3610696534443334, 'macro avg': {'precision': 0.42818054538801653, 'recall': 0.367128425216364, 'f1-score': 0.31003582322604556, 'support': 73033}, 'weighted avg': {'precision': 0.42963484937875734, 'recall': 0.3610696534443334, 'f1-score': 0.30779420773797256, 'support': 73033}}
[[ 3337 19127  2314]
 [ 2129 18725  2801]
 [ 1230 19062  4308]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916356
{'0': {'precision': 0.4503985828166519, 'recall': 0.10311264321200446, 'f1-score': 0.16780793663889118, 'support': 9863}, '1': {'precision': 0.33717273036382184, 'recall': 0.7979279822973245, 'f1-score': 0.4740364505527338, 'support': 9942}, '2': {'precision': 0.4267959234402187, 'recall': 0.1716313474610156, 'f1-score': 0.24481357382191485, 'support': 10004}, 'accuracy': 0.35784494615720086, 'macro avg': {'precision': 0.4047890788735642, 'recall': 0.35755732432344817, 'f1-score': 0.29555265367117994, 'support': 29809}, 'weighted avg': {'precision': 0.40471397650688395, 'recall': 0.35784494615720086, 'f1-score': 0.2957856708705123, 'support': 29809}}
[[1017 7803 1043]
 [ 746 7933 1263]
 [ 495 7792 1717]]
training model: results/XRAY/W2/deepOF_L1/h50
Epoch 1/50
286/286 - 10s - loss: 3.3106 - accuracy50: 0.3629 - val_loss: 3.2984 - val_accuracy50: 0.3498 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2756 - accuracy50: 0.3772 - val_loss: 3.2920 - val_accuracy50: 0.3508 - 8s/epoch - 28ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2631 - accuracy50: 0.3824 - val_loss: 3.2863 - val_accuracy50: 0.3488 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 7s - loss: 3.2559 - accuracy50: 0.3876 - val_loss: 3.2802 - val_accuracy50: 0.3523 - 7s/epoch - 26ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2454 - accuracy50: 0.3937 - val_loss: 3.2752 - val_accuracy50: 0.3507 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2401 - accuracy50: 0.3947 - val_loss: 3.2743 - val_accuracy50: 0.3533 - 8s/epoch - 27ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2349 - accuracy50: 0.3969 - val_loss: 3.2709 - val_accuracy50: 0.3545 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2313 - accuracy50: 0.4009 - val_loss: 3.2712 - val_accuracy50: 0.3532 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2291 - accuracy50: 0.3997 - val_loss: 3.2684 - val_accuracy50: 0.3561 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2232 - accuracy50: 0.4053 - val_loss: 3.2725 - val_accuracy50: 0.3573 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2224 - accuracy50: 0.4051 - val_loss: 3.2689 - val_accuracy50: 0.3564 - 8s/epoch - 28ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2181 - accuracy50: 0.4071 - val_loss: 3.2703 - val_accuracy50: 0.3546 - 8s/epoch - 28ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2158 - accuracy50: 0.4057 - val_loss: 3.2682 - val_accuracy50: 0.3556 - 8s/epoch - 28ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2135 - accuracy50: 0.4073 - val_loss: 3.2655 - val_accuracy50: 0.3575 - 8s/epoch - 28ms/step
Epoch 15/50
286/286 - 8s - loss: 3.2085 - accuracy50: 0.4127 - val_loss: 3.2666 - val_accuracy50: 0.3576 - 8s/epoch - 28ms/step
Epoch 16/50
286/286 - 8s - loss: 3.2067 - accuracy50: 0.4128 - val_loss: 3.2702 - val_accuracy50: 0.3590 - 8s/epoch - 28ms/step
Epoch 17/50
286/286 - 8s - loss: 3.2026 - accuracy50: 0.4162 - val_loss: 3.2711 - val_accuracy50: 0.3585 - 8s/epoch - 28ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2001 - accuracy50: 0.4172 - val_loss: 3.2723 - val_accuracy50: 0.3597 - 8s/epoch - 28ms/step
Epoch 19/50
286/286 - 8s - loss: 3.1978 - accuracy50: 0.4186 - val_loss: 3.2734 - val_accuracy50: 0.3588 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 7s - loss: 3.1954 - accuracy50: 0.4171 - val_loss: 3.2697 - val_accuracy50: 0.3630 - 7s/epoch - 26ms/step
Epoch 21/50
286/286 - 8s - loss: 3.1910 - accuracy50: 0.4217 - val_loss: 3.2776 - val_accuracy50: 0.3612 - 8s/epoch - 26ms/step
Epoch 22/50
286/286 - 8s - loss: 3.1888 - accuracy50: 0.4215 - val_loss: 3.2792 - val_accuracy50: 0.3604 - 8s/epoch - 26ms/step
Epoch 23/50
286/286 - 8s - loss: 3.1852 - accuracy50: 0.4228 - val_loss: 3.2808 - val_accuracy50: 0.3620 - 8s/epoch - 27ms/step
Epoch 24/50
286/286 - 8s - loss: 3.1806 - accuracy50: 0.4264 - val_loss: 3.2834 - val_accuracy50: 0.3587 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h50
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0947214
{'0': {'precision': 0.46348463909854365, 'recall': 0.09446635177882741, 'f1-score': 0.15694461942729612, 'support': 92308}, '1': {'precision': 0.2928835756833721, 'recall': 0.7943041910210172, 'f1-score': 0.4279640716556722, 'support': 80410}, '2': {'precision': 0.4663058331770317, 'recall': 0.1714750221696719, 'f1-score': 0.250743817132648, 'support': 101490}, 'accuracy': 0.32819246703232585, 'macro avg': {'precision': 0.40755801598631586, 'recall': 0.3534151883231722, 'f1-score': 0.2785508360718721, 'support': 274208}, 'weighted avg': {'precision': 0.4145009897440821, 'recall': 0.32819246703232585, 'f1-score': 0.2711366004373319, 'support': 274208}}
[[ 8720 74230  9358]
 [ 5980 63870 10560]
 [ 4114 79973 17403]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08416
{'0': {'precision': 0.491729908542518, 'recall': 0.10322712418300653, 'f1-score': 0.17063371484520068, 'support': 24480}, '1': {'precision': 0.3361758347345664, 'recall': 0.8056663514124759, 'f1-score': 0.4744010363070665, 'support': 24319}, '2': {'precision': 0.4342488555971702, 'recall': 0.17223735247998678, 'f1-score': 0.24664657566625303, 'support': 24234}, 'accuracy': 0.36002902797365577, 'macro avg': {'precision': 0.42071819962475154, 'recall': 0.3603769426918231, 'f1-score': 0.2972271089395067, 'support': 73033}, 'weighted avg': {'precision': 0.4208589959685702, 'recall': 0.36002902797365577, 'f1-score': 0.2970069044960229, 'support': 73033}}
[[ 2527 19566  2387]
 [ 1675 19593  3051]
 [  937 19123  4174]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0887212
{'0': {'precision': 0.409211222869243, 'recall': 0.08104424407632628, 'f1-score': 0.13529360287039469, 'support': 9538}, '1': {'precision': 0.343958611481976, 'recall': 0.8061014960398944, 'f1-score': 0.4821757566895746, 'support': 10227}, '2': {'precision': 0.4185222672064777, 'recall': 0.16467542811628832, 'f1-score': 0.23635324378393827, 'support': 10044}, 'accuracy': 0.3579791338186454, 'macro avg': {'precision': 0.39056403385256555, 'recall': 0.35060705607750303, 'f1-score': 0.2846075344479692, 'support': 29809}, 'weighted avg': {'precision': 0.38996138800948943, 'recall': 0.3579791338186454, 'f1-score': 0.28835498770196855, 'support': 29809}}
[[ 773 7794  971]
 [ 656 8244 1327]
 [ 460 7930 1654]]
training model: results/XRAY/W2/deepOF_L1/h100
Epoch 1/50
286/286 - 10s - loss: 3.3242 - accuracy100: 0.3517 - val_loss: 3.2941 - val_accuracy100: 0.3523 - 10s/epoch - 36ms/step
Epoch 2/50
286/286 - 8s - loss: 3.2952 - accuracy100: 0.3619 - val_loss: 3.2861 - val_accuracy100: 0.3546 - 8s/epoch - 28ms/step
Epoch 3/50
286/286 - 8s - loss: 3.2817 - accuracy100: 0.3702 - val_loss: 3.2819 - val_accuracy100: 0.3573 - 8s/epoch - 28ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2786 - accuracy100: 0.3734 - val_loss: 3.2774 - val_accuracy100: 0.3669 - 8s/epoch - 28ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2737 - accuracy100: 0.3740 - val_loss: 3.2771 - val_accuracy100: 0.3643 - 8s/epoch - 28ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2686 - accuracy100: 0.3766 - val_loss: 3.2744 - val_accuracy100: 0.3685 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2638 - accuracy100: 0.3790 - val_loss: 3.2741 - val_accuracy100: 0.3645 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2604 - accuracy100: 0.3831 - val_loss: 3.2743 - val_accuracy100: 0.3676 - 8s/epoch - 26ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2590 - accuracy100: 0.3830 - val_loss: 3.2703 - val_accuracy100: 0.3673 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2550 - accuracy100: 0.3863 - val_loss: 3.2727 - val_accuracy100: 0.3650 - 8s/epoch - 28ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2547 - accuracy100: 0.3868 - val_loss: 3.2721 - val_accuracy100: 0.3659 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2519 - accuracy100: 0.3887 - val_loss: 3.2704 - val_accuracy100: 0.3666 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2488 - accuracy100: 0.3916 - val_loss: 3.2704 - val_accuracy100: 0.3686 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2468 - accuracy100: 0.3915 - val_loss: 3.2701 - val_accuracy100: 0.3710 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.2458 - accuracy100: 0.3916 - val_loss: 3.2704 - val_accuracy100: 0.3695 - 8s/epoch - 27ms/step
Epoch 16/50
286/286 - 8s - loss: 3.2417 - accuracy100: 0.3951 - val_loss: 3.2720 - val_accuracy100: 0.3682 - 8s/epoch - 27ms/step
Epoch 17/50
286/286 - 8s - loss: 3.2399 - accuracy100: 0.3961 - val_loss: 3.2702 - val_accuracy100: 0.3685 - 8s/epoch - 27ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2354 - accuracy100: 0.3998 - val_loss: 3.2728 - val_accuracy100: 0.3660 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.2360 - accuracy100: 0.3985 - val_loss: 3.2730 - val_accuracy100: 0.3655 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 8s - loss: 3.2328 - accuracy100: 0.4004 - val_loss: 3.2723 - val_accuracy100: 0.3668 - 8s/epoch - 27ms/step
Epoch 21/50
286/286 - 8s - loss: 3.2299 - accuracy100: 0.4019 - val_loss: 3.2753 - val_accuracy100: 0.3611 - 8s/epoch - 27ms/step
Epoch 22/50
286/286 - 8s - loss: 3.2265 - accuracy100: 0.4035 - val_loss: 3.2735 - val_accuracy100: 0.3666 - 8s/epoch - 27ms/step
Epoch 23/50
286/286 - 8s - loss: 3.2244 - accuracy100: 0.4044 - val_loss: 3.2741 - val_accuracy100: 0.3651 - 8s/epoch - 27ms/step
Epoch 24/50
286/286 - 8s - loss: 3.2224 - accuracy100: 0.4070 - val_loss: 3.2751 - val_accuracy100: 0.3651 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h100
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0900595
{'0': {'precision': 0.3891227639950409, 'recall': 0.31300478898861384, 'f1-score': 0.34693778393217206, 'support': 91251}, '1': {'precision': 0.2981034018676108, 'recall': 0.35821805334394907, 'f1-score': 0.3254076777904598, 'support': 80384}, '2': {'precision': 0.4290827439954708, 'recall': 0.43594318192896764, 'f1-score': 0.4324857582234774, 'support': 102573}, 'accuracy': 0.3722466157077839, 'macro avg': {'precision': 0.3721029699527075, 'recall': 0.36905534142051016, 'f1-score': 0.36827707331536974, 'support': 274208}, 'weighted avg': {'precision': 0.3773882946262871, 'recall': 0.3722466157077839, 'f1-score': 0.37262717415742685, 'support': 274208}}
[[28562 32667 30022]
 [22114 28795 29475]
 [22725 35132 44716]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0875407
{'0': {'precision': 0.407420476886626, 'recall': 0.32682275870435523, 'f1-score': 0.36269802091280356, 'support': 24729}, '1': {'precision': 0.3430004116304307, 'recall': 0.3801742015761095, 'f1-score': 0.3606318729958885, 'support': 24110}, '2': {'precision': 0.38669587881992973, 'recall': 0.4231214350665454, 'f1-score': 0.4040894467799554, 'support': 24194}, 'accuracy': 0.37633672449440664, 'macro avg': {'precision': 0.3790389224456621, 'recall': 0.37670613178233675, 'f1-score': 0.37580644689621584, 'support': 73033}, 'weighted avg': {'precision': 0.37928828049660346, 'recall': 0.37633672449440664, 'f1-score': 0.37572787496717697, 'support': 73033}}
[[ 8082  9010  7637]
 [ 6345  9166  8599]
 [ 5410  8547 10237]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899963
{'0': {'precision': 0.37107447960534234, 'recall': 0.3239495798319328, 'f1-score': 0.3459144187089899, 'support': 9520}, '1': {'precision': 0.357863098700795, 'recall': 0.3554164660568127, 'f1-score': 0.3566355862602058, 'support': 10385}, '2': {'precision': 0.3741058655221745, 'recall': 0.42245557350565427, 'f1-score': 0.39681335356600905, 'support': 9904}, 'accuracy': 0.36764064544265157, 'macro avg': {'precision': 0.3676811479427706, 'recall': 0.3672738731314666, 'f1-score': 0.3664544528450682, 'support': 29809}, 'weighted avg': {'precision': 0.36747901029830693, 'recall': 0.36764064544265157, 'f1-score': 0.36656061200105927, 'support': 29809}}
[[3084 3256 3180]
 [2874 3691 3820]
 [2353 3367 4184]]
training model: results/XRAY/W2/deepOF_L1/h200
Epoch 1/50
286/286 - 10s - loss: 3.3313 - accuracy200: 0.3523 - val_loss: 3.3535 - val_accuracy200: 0.3311 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 8s - loss: 3.3154 - accuracy200: 0.3540 - val_loss: 3.3473 - val_accuracy200: 0.3320 - 8s/epoch - 28ms/step
Epoch 3/50
286/286 - 8s - loss: 3.3038 - accuracy200: 0.3568 - val_loss: 3.3470 - val_accuracy200: 0.3312 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 3.2952 - accuracy200: 0.3613 - val_loss: 3.3416 - val_accuracy200: 0.3318 - 8s/epoch - 28ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2910 - accuracy200: 0.3625 - val_loss: 3.3373 - val_accuracy200: 0.3316 - 8s/epoch - 28ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2871 - accuracy200: 0.3652 - val_loss: 3.3351 - val_accuracy200: 0.3316 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2834 - accuracy200: 0.3666 - val_loss: 3.3352 - val_accuracy200: 0.3315 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2816 - accuracy200: 0.3661 - val_loss: 3.3317 - val_accuracy200: 0.3312 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2785 - accuracy200: 0.3676 - val_loss: 3.3294 - val_accuracy200: 0.3319 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2768 - accuracy200: 0.3710 - val_loss: 3.3285 - val_accuracy200: 0.3317 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2741 - accuracy200: 0.3715 - val_loss: 3.3294 - val_accuracy200: 0.3317 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2732 - accuracy200: 0.3721 - val_loss: 3.3265 - val_accuracy200: 0.3324 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2697 - accuracy200: 0.3737 - val_loss: 3.3270 - val_accuracy200: 0.3312 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2696 - accuracy200: 0.3760 - val_loss: 3.3255 - val_accuracy200: 0.3312 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.2662 - accuracy200: 0.3769 - val_loss: 3.3283 - val_accuracy200: 0.3316 - 8s/epoch - 27ms/step
Epoch 16/50
286/286 - 8s - loss: 3.2638 - accuracy200: 0.3806 - val_loss: 3.3253 - val_accuracy200: 0.3324 - 8s/epoch - 28ms/step
Epoch 17/50
286/286 - 8s - loss: 3.2638 - accuracy200: 0.3796 - val_loss: 3.3237 - val_accuracy200: 0.3318 - 8s/epoch - 28ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2608 - accuracy200: 0.3810 - val_loss: 3.3223 - val_accuracy200: 0.3317 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.2580 - accuracy200: 0.3835 - val_loss: 3.3260 - val_accuracy200: 0.3313 - 8s/epoch - 28ms/step
Epoch 20/50
286/286 - 8s - loss: 3.2570 - accuracy200: 0.3847 - val_loss: 3.3295 - val_accuracy200: 0.3320 - 8s/epoch - 28ms/step
Epoch 21/50
286/286 - 8s - loss: 3.2557 - accuracy200: 0.3827 - val_loss: 3.3278 - val_accuracy200: 0.3321 - 8s/epoch - 28ms/step
Epoch 22/50
286/286 - 8s - loss: 3.2539 - accuracy200: 0.3854 - val_loss: 3.3309 - val_accuracy200: 0.3319 - 8s/epoch - 28ms/step
Epoch 23/50
286/286 - 8s - loss: 3.2496 - accuracy200: 0.3884 - val_loss: 3.3349 - val_accuracy200: 0.3316 - 8s/epoch - 27ms/step
Epoch 24/50
286/286 - 8s - loss: 3.2475 - accuracy200: 0.3911 - val_loss: 3.3373 - val_accuracy200: 0.3320 - 8s/epoch - 28ms/step
Epoch 25/50
286/286 - 8s - loss: 3.2461 - accuracy200: 0.3916 - val_loss: 3.3375 - val_accuracy200: 0.3310 - 8s/epoch - 28ms/step
Epoch 26/50
286/286 - 8s - loss: 3.2454 - accuracy200: 0.3930 - val_loss: 3.3400 - val_accuracy200: 0.3306 - 8s/epoch - 28ms/step
Epoch 27/50
286/286 - 8s - loss: 3.2408 - accuracy200: 0.3953 - val_loss: 3.3414 - val_accuracy200: 0.3317 - 8s/epoch - 26ms/step
Epoch 28/50
286/286 - 8s - loss: 3.2380 - accuracy200: 0.3978 - val_loss: 3.3430 - val_accuracy200: 0.3317 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h200
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227055
{'0': {'precision': 0.36243718592964824, 'recall': 0.00637470446560753, 'f1-score': 0.01252904262480186, 'support': 90514}, '1': {'precision': 0.29715342041505827, 'recall': 0.9817872486260878, 'f1-score': 0.45622357019556986, 'support': 81701}, '2': {'precision': 0.4238237490664675, 'recall': 0.011128214681399703, 'f1-score': 0.021687000219736127, 'support': 101993}, 'accuracy': 0.29876954720504145, 'macro avg': {'precision': 0.3611381184703914, 'recall': 0.3330967225910317, 'f1-score': 0.16347987101336928, 'support': 274208}, 'weighted avg': {'precision': 0.3658187459414134, 'recall': 0.29876954720504145, 'f1-score': 0.14813534939207143, 'support': 274208}}
[[   577  89297    640]
 [   585  80213    903]
 [   430 100428   1135]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109432
{'0': {'precision': 0.4688995215311005, 'recall': 0.00782435129740519, 'f1-score': 0.015391864300298415, 'support': 25050}, '1': {'precision': 0.3245238261354915, 'recall': 0.9827593492499472, 'f1-score': 0.4879261512640302, 'support': 23665}, '2': {'precision': 0.4368421052631579, 'recall': 0.017065548153631056, 'f1-score': 0.03284787082475859, 'support': 24318}, 'accuracy': 0.3268111675543932, 'macro avg': {'precision': 0.4100884843099166, 'recall': 0.33588308290032787, 'f1-score': 0.17872196212969574, 'support': 73033}, 'weighted avg': {'precision': 0.4114429870830987, 'recall': 0.3268111675543932, 'f1-score': 0.17432028114827858, 'support': 73033}}
[[  196 24598   256]
 [  129 23257   279]
 [   93 23810   415]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096215
{'0': {'precision': 0.3712121212121212, 'recall': 0.005003573981415297, 'f1-score': 0.009874055415617127, 'support': 9793}, '1': {'precision': 0.3302479677573605, 'recall': 0.9793375873594652, 'f1-score': 0.4939337437102501, 'support': 9873}, '2': {'precision': 0.42606516290726815, 'recall': 0.01676032731933353, 'f1-score': 0.032251944602542215, 'support': 10143}, 'accuracy': 0.3317118990908786, 'macro avg': {'precision': 0.37584175062558334, 'recall': 0.33370049622007136, 'f1-score': 0.17868658124280315, 'support': 29809}, 'weighted avg': {'precision': 0.37630908235992966, 'recall': 0.3317118990908786, 'f1-score': 0.17781327620651563, 'support': 29809}}
[[  49 9668   76]
 [  51 9669  153]
 [  32 9941  170]]
training model: results/XRAY/W2/deepOF_L1/h300
Epoch 1/50
286/286 - 10s - loss: 3.3340 - accuracy300: 0.3455 - val_loss: 3.3618 - val_accuracy300: 0.3268 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 8s - loss: 3.3190 - accuracy300: 0.3490 - val_loss: 3.3602 - val_accuracy300: 0.3257 - 8s/epoch - 27ms/step
Epoch 3/50
286/286 - 8s - loss: 3.3066 - accuracy300: 0.3535 - val_loss: 3.3568 - val_accuracy300: 0.3258 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 3.3022 - accuracy300: 0.3536 - val_loss: 3.3556 - val_accuracy300: 0.3259 - 8s/epoch - 26ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2955 - accuracy300: 0.3562 - val_loss: 3.3502 - val_accuracy300: 0.3248 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2908 - accuracy300: 0.3585 - val_loss: 3.3447 - val_accuracy300: 0.3249 - 8s/epoch - 28ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2886 - accuracy300: 0.3615 - val_loss: 3.3425 - val_accuracy300: 0.3251 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2850 - accuracy300: 0.3642 - val_loss: 3.3414 - val_accuracy300: 0.3259 - 8s/epoch - 29ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2837 - accuracy300: 0.3641 - val_loss: 3.3394 - val_accuracy300: 0.3250 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2796 - accuracy300: 0.3688 - val_loss: 3.3389 - val_accuracy300: 0.3251 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2787 - accuracy300: 0.3676 - val_loss: 3.3418 - val_accuracy300: 0.3253 - 8s/epoch - 26ms/step
Epoch 12/50
286/286 - 7s - loss: 3.2757 - accuracy300: 0.3717 - val_loss: 3.3397 - val_accuracy300: 0.3253 - 7s/epoch - 26ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2716 - accuracy300: 0.3737 - val_loss: 3.3419 - val_accuracy300: 0.3259 - 8s/epoch - 26ms/step
Epoch 14/50
286/286 - 7s - loss: 3.2716 - accuracy300: 0.3741 - val_loss: 3.3404 - val_accuracy300: 0.3256 - 7s/epoch - 26ms/step
Epoch 15/50
286/286 - 7s - loss: 3.2688 - accuracy300: 0.3753 - val_loss: 3.3409 - val_accuracy300: 0.3266 - 7s/epoch - 26ms/step
Epoch 16/50
286/286 - 7s - loss: 3.2679 - accuracy300: 0.3743 - val_loss: 3.3410 - val_accuracy300: 0.3252 - 7s/epoch - 26ms/step
Epoch 17/50
286/286 - 8s - loss: 3.2668 - accuracy300: 0.3772 - val_loss: 3.3473 - val_accuracy300: 0.3259 - 8s/epoch - 27ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2617 - accuracy300: 0.3807 - val_loss: 3.3531 - val_accuracy300: 0.3256 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.2616 - accuracy300: 0.3807 - val_loss: 3.3470 - val_accuracy300: 0.3260 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 8s - loss: 3.2591 - accuracy300: 0.3841 - val_loss: 3.3545 - val_accuracy300: 0.3255 - 8s/epoch - 26ms/step
testing model: results/XRAY/W2/deepOF_L1/h300
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265553
{'0': {'precision': 0.3677298311444653, 'recall': 0.004356620507235102, 'f1-score': 0.008611220948113, 'support': 89978}, '1': {'precision': 0.2864265968872371, 'recall': 0.9863499447134633, 'f1-score': 0.44393787718445216, 'support': 78681}, '2': {'precision': 0.41404468764249885, 'recall': 0.008602639532349904, 'f1-score': 0.01685507972749717, 'support': 105549}, 'accuracy': 0.28776330376940135, 'macro avg': {'precision': 0.3560670385580671, 'recall': 0.33310306825101604, 'f1-score': 0.15646805928668744, 'support': 274208}, 'weighted avg': {'precision': 0.36222841256411015, 'recall': 0.28776330376940135, 'f1-score': 0.13669671695711574, 'support': 274208}}
[[   392  89008    578]
 [   367  77607    707]
 [   307 104334    908]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1095331
{'0': {'precision': 0.38492063492063494, 'recall': 0.003919033574401034, 'f1-score': 0.007759068911730592, 'support': 24751}, '1': {'precision': 0.33340271129056875, 'recall': 0.9865330924618164, 'f1-score': 0.49837697692507127, 'support': 24356}, '2': {'precision': 0.4143258426966292, 'recall': 0.012329683189835326, 'f1-score': 0.023946748924425682, 'support': 23926}, 'accuracy': 0.3343693946572098, 'macro avg': {'precision': 0.3775497296359443, 'recall': 0.33426060307535094, 'f1-score': 0.17669426492040918, 'support': 73033}, 'weighted avg': {'precision': 0.37737306674343485, 'recall': 0.3343693946572098, 'f1-score': 0.17667991564617486, 'support': 73033}}
[[   97 24470   184]
 [   95 24028   233]
 [   60 23571   295]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1125993
{'0': {'precision': 0.28735632183908044, 'recall': 0.002582911457795227, 'f1-score': 0.005119803399549458, 'support': 9679}, '1': {'precision': 0.3239843617202108, 'recall': 0.984504132231405, 'f1-score': 0.48753037472822613, 'support': 9680}, '2': {'precision': 0.43322475570032576, 'recall': 0.012727272727272728, 'f1-score': 0.02472808403830064, 'support': 10450}, 'accuracy': 0.3250025160186521, 'macro avg': {'precision': 0.3481884797532056, 'recall': 0.333271438805491, 'f1-score': 0.17245942072202544, 'support': 29809}, 'weighted avg': {'precision': 0.35038710314336285, 'recall': 0.3250025160186521, 'f1-score': 0.16864896785110906, 'support': 29809}}
[[   25  9599    55]
 [   31  9530   119]
 [   31 10286   133]]
training model: results/XRAY/W2/deepOF_L1/h500
Epoch 1/50
286/286 - 10s - loss: 3.3390 - accuracy500: 0.3431 - val_loss: 3.3751 - val_accuracy500: 0.3271 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 7s - loss: 3.3203 - accuracy500: 0.3478 - val_loss: 3.3787 - val_accuracy500: 0.3281 - 7s/epoch - 26ms/step
Epoch 3/50
286/286 - 7s - loss: 3.3099 - accuracy500: 0.3496 - val_loss: 3.3769 - val_accuracy500: 0.3272 - 7s/epoch - 26ms/step
Epoch 4/50
286/286 - 8s - loss: 3.3036 - accuracy500: 0.3522 - val_loss: 3.3649 - val_accuracy500: 0.3263 - 8s/epoch - 26ms/step
Epoch 5/50
286/286 - 8s - loss: 3.2991 - accuracy500: 0.3526 - val_loss: 3.3639 - val_accuracy500: 0.3270 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.2961 - accuracy500: 0.3547 - val_loss: 3.3576 - val_accuracy500: 0.3275 - 8s/epoch - 26ms/step
Epoch 7/50
286/286 - 8s - loss: 3.2928 - accuracy500: 0.3567 - val_loss: 3.3549 - val_accuracy500: 0.3277 - 8s/epoch - 26ms/step
Epoch 8/50
286/286 - 7s - loss: 3.2907 - accuracy500: 0.3586 - val_loss: 3.3526 - val_accuracy500: 0.3273 - 7s/epoch - 26ms/step
Epoch 9/50
286/286 - 8s - loss: 3.2883 - accuracy500: 0.3587 - val_loss: 3.3488 - val_accuracy500: 0.3274 - 8s/epoch - 27ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2867 - accuracy500: 0.3626 - val_loss: 3.3480 - val_accuracy500: 0.3267 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2843 - accuracy500: 0.3613 - val_loss: 3.3481 - val_accuracy500: 0.3274 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2816 - accuracy500: 0.3637 - val_loss: 3.3469 - val_accuracy500: 0.3268 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2811 - accuracy500: 0.3644 - val_loss: 3.3423 - val_accuracy500: 0.3282 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2798 - accuracy500: 0.3655 - val_loss: 3.3393 - val_accuracy500: 0.3280 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 7s - loss: 3.2769 - accuracy500: 0.3677 - val_loss: 3.3423 - val_accuracy500: 0.3266 - 7s/epoch - 25ms/step
Epoch 16/50
286/286 - 7s - loss: 3.2752 - accuracy500: 0.3711 - val_loss: 3.3424 - val_accuracy500: 0.3272 - 7s/epoch - 26ms/step
Epoch 17/50
286/286 - 7s - loss: 3.2757 - accuracy500: 0.3682 - val_loss: 3.3429 - val_accuracy500: 0.3278 - 7s/epoch - 26ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2706 - accuracy500: 0.3727 - val_loss: 3.3419 - val_accuracy500: 0.3276 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.2704 - accuracy500: 0.3749 - val_loss: 3.3429 - val_accuracy500: 0.3280 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 8s - loss: 3.2696 - accuracy500: 0.3752 - val_loss: 3.3450 - val_accuracy500: 0.3270 - 8s/epoch - 26ms/step
Epoch 21/50
286/286 - 7s - loss: 3.2662 - accuracy500: 0.3767 - val_loss: 3.3483 - val_accuracy500: 0.3278 - 7s/epoch - 26ms/step
Epoch 22/50
286/286 - 8s - loss: 3.2654 - accuracy500: 0.3779 - val_loss: 3.3487 - val_accuracy500: 0.3275 - 8s/epoch - 26ms/step
Epoch 23/50
286/286 - 7s - loss: 3.2627 - accuracy500: 0.3783 - val_loss: 3.3523 - val_accuracy500: 0.3281 - 7s/epoch - 26ms/step
Epoch 24/50
286/286 - 7s - loss: 3.2614 - accuracy500: 0.3821 - val_loss: 3.3531 - val_accuracy500: 0.3276 - 7s/epoch - 26ms/step
testing model: results/XRAY/W2/deepOF_L1/h500
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204542
{'0': {'precision': 0.305978898007034, 'recall': 0.002973681212259314, 'f1-score': 0.005890118817914084, 'support': 87770}, '1': {'precision': 0.2867824080048076, 'recall': 0.9882481482893115, 'f1-score': 0.44455747711088506, 'support': 78711}, '2': {'precision': 0.42681775259678945, 'recall': 0.00839158242594707, 'f1-score': 0.016459556648004005, 'support': 107727}, 'accuracy': 0.2879237659003384, 'macro avg': {'precision': 0.33985968620287704, 'recall': 0.33320447064250597, 'f1-score': 0.15563571752560104, 'support': 274208}, 'weighted avg': {'precision': 0.34794205139360673, 'recall': 0.2879237659003384, 'f1-score': 0.13596130663052397, 'support': 274208}}
[[   261  86928    581]
 [   292  77786    633]
 [   300 106523    904]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038934
{'0': {'precision': 0.36324786324786323, 'recall': 0.0034898998193463623, 'f1-score': 0.006913379422529483, 'support': 24356}, '1': {'precision': 0.34388399361687366, 'recall': 0.9863875179111606, 'f1-score': 0.5099754087396722, 'support': 25124}, '2': {'precision': 0.3814713896457766, 'recall': 0.011888082197596909, 'f1-score': 0.023057602832791204, 'support': 23553}, 'accuracy': 0.3443237988306656, 'macro avg': {'precision': 0.36286774883683787, 'recall': 0.3339218333093679, 'f1-score': 0.1799821303316643, 'support': 73033}, 'weighted avg': {'precision': 0.3624635719910488, 'recall': 0.3443237988306656, 'f1-score': 0.1851776615764296, 'support': 73033}}
[[   85 24078   193]
 [   81 24782   261]
 [   68 23205   280]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109155
{'0': {'precision': 0.28421052631578947, 'recall': 0.0028122070617643997, 'f1-score': 0.00556930693069307, 'support': 9601}, '1': {'precision': 0.32696954228347797, 'recall': 0.9858403447568234, 'f1-score': 0.4910684623444328, 'support': 9746}, '2': {'precision': 0.44680851063829785, 'recall': 0.014050850697763333, 'f1-score': 0.027244926327495134, 'support': 10462}, 'accuracy': 0.3281559260625985, 'macro avg': {'precision': 0.35266285974585515, 'recall': 0.33423446750545033, 'f1-score': 0.17462756520087366, 'support': 29809}, 'weighted avg': {'precision': 0.35525717268444235, 'recall': 0.3281559260625985, 'f1-score': 0.17190984498267906, 'support': 29809}}
[[   27  9502    72]
 [   28  9608   110]
 [   40 10275   147]]
training model: results/XRAY/W2/deepOF_L1/h1000
Epoch 1/50
286/286 - 10s - loss: 3.3413 - accuracy1000: 0.3430 - val_loss: 3.4509 - val_accuracy1000: 0.3003 - 10s/epoch - 34ms/step
Epoch 2/50
286/286 - 8s - loss: 3.3344 - accuracy1000: 0.3373 - val_loss: 3.4425 - val_accuracy1000: 0.3003 - 8s/epoch - 27ms/step
Epoch 3/50
286/286 - 8s - loss: 3.3221 - accuracy1000: 0.3416 - val_loss: 3.4379 - val_accuracy1000: 0.2987 - 8s/epoch - 27ms/step
Epoch 4/50
286/286 - 8s - loss: 3.3135 - accuracy1000: 0.3429 - val_loss: 3.4227 - val_accuracy1000: 0.2984 - 8s/epoch - 27ms/step
Epoch 5/50
286/286 - 8s - loss: 3.3102 - accuracy1000: 0.3427 - val_loss: 3.4147 - val_accuracy1000: 0.2990 - 8s/epoch - 27ms/step
Epoch 6/50
286/286 - 8s - loss: 3.3040 - accuracy1000: 0.3454 - val_loss: 3.4124 - val_accuracy1000: 0.2979 - 8s/epoch - 27ms/step
Epoch 7/50
286/286 - 8s - loss: 3.3014 - accuracy1000: 0.3444 - val_loss: 3.4057 - val_accuracy1000: 0.2975 - 8s/epoch - 27ms/step
Epoch 8/50
286/286 - 8s - loss: 3.2987 - accuracy1000: 0.3463 - val_loss: 3.4054 - val_accuracy1000: 0.2979 - 8s/epoch - 27ms/step
Epoch 9/50
286/286 - 7s - loss: 3.2960 - accuracy1000: 0.3485 - val_loss: 3.3976 - val_accuracy1000: 0.2986 - 7s/epoch - 26ms/step
Epoch 10/50
286/286 - 8s - loss: 3.2933 - accuracy1000: 0.3495 - val_loss: 3.3917 - val_accuracy1000: 0.2986 - 8s/epoch - 27ms/step
Epoch 11/50
286/286 - 8s - loss: 3.2909 - accuracy1000: 0.3501 - val_loss: 3.3915 - val_accuracy1000: 0.2981 - 8s/epoch - 27ms/step
Epoch 12/50
286/286 - 8s - loss: 3.2889 - accuracy1000: 0.3524 - val_loss: 3.3847 - val_accuracy1000: 0.2987 - 8s/epoch - 27ms/step
Epoch 13/50
286/286 - 8s - loss: 3.2862 - accuracy1000: 0.3573 - val_loss: 3.3920 - val_accuracy1000: 0.2977 - 8s/epoch - 27ms/step
Epoch 14/50
286/286 - 8s - loss: 3.2848 - accuracy1000: 0.3558 - val_loss: 3.3852 - val_accuracy1000: 0.2981 - 8s/epoch - 27ms/step
Epoch 15/50
286/286 - 8s - loss: 3.2832 - accuracy1000: 0.3572 - val_loss: 3.3859 - val_accuracy1000: 0.2985 - 8s/epoch - 27ms/step
Epoch 16/50
286/286 - 8s - loss: 3.2814 - accuracy1000: 0.3629 - val_loss: 3.3901 - val_accuracy1000: 0.2984 - 8s/epoch - 27ms/step
Epoch 17/50
286/286 - 8s - loss: 3.2808 - accuracy1000: 0.3612 - val_loss: 3.3950 - val_accuracy1000: 0.2982 - 8s/epoch - 26ms/step
Epoch 18/50
286/286 - 8s - loss: 3.2783 - accuracy1000: 0.3620 - val_loss: 3.3960 - val_accuracy1000: 0.2984 - 8s/epoch - 27ms/step
Epoch 19/50
286/286 - 8s - loss: 3.2780 - accuracy1000: 0.3668 - val_loss: 3.3994 - val_accuracy1000: 0.2985 - 8s/epoch - 27ms/step
Epoch 20/50
286/286 - 7s - loss: 3.2743 - accuracy1000: 0.3693 - val_loss: 3.4080 - val_accuracy1000: 0.2984 - 7s/epoch - 26ms/step
Epoch 21/50
286/286 - 8s - loss: 3.2738 - accuracy1000: 0.3658 - val_loss: 3.4039 - val_accuracy1000: 0.2983 - 8s/epoch - 26ms/step
Epoch 22/50
286/286 - 8s - loss: 3.2730 - accuracy1000: 0.3687 - val_loss: 3.4053 - val_accuracy1000: 0.2986 - 8s/epoch - 27ms/step
testing model: results/XRAY/W2/deepOF_L1/h1000
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120868
{'0': {'precision': 0.2875104777870914, 'recall': 0.004120516085629851, 'f1-score': 0.008124592882098656, 'support': 83242}, '1': {'precision': 0.29252094092338976, 'recall': 0.9898044396804228, 'f1-score': 0.45158355344901613, 'support': 80231}, '2': {'precision': 0.47950553025374104, 'recall': 0.006655528965548382, 'f1-score': 0.013128829984323787, 'support': 110735}, 'accuracy': 0.2935472342163613, 'macro avg': {'precision': 0.35317898298807404, 'recall': 0.333526828243867, 'f1-score': 0.15761232543847953, 'support': 274208}, 'weighted avg': {'precision': 0.3665109686654859, 'recall': 0.2935472342163613, 'f1-score': 0.13989791846253125, 'support': 274208}}
[[   343  82545    354]
 [   372  79413    446]
 [   478 109520    737]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034389
{'0': {'precision': 0.3633217993079585, 'recall': 0.004319921007158726, 'f1-score': 0.008538320796909941, 'support': 24306}, '1': {'precision': 0.3481574899178181, 'recall': 0.9883158267437744, 'f1-score': 0.514921702057883, 'support': 25419}, '2': {'precision': 0.42248722316865417, 'recall': 0.010640123562725244, 'f1-score': 0.020757480644486292, 'support': 23308}, 'accuracy': 0.3488149192830638, 'macro avg': {'precision': 0.3779888374648103, 'recall': 0.3344252904378861, 'f1-score': 0.18140583449975978, 'support': 73033}, 'weighted avg': {'precision': 0.3769261441788678, 'recall': 0.3488149192830638, 'f1-score': 0.1886837803289021, 'support': 73033}}
[[  105 24054   147]
 [  105 25122   192]
 [   79 22981   248]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1197942
{'0': {'precision': 0.3302752293577982, 'recall': 0.0036261079774375505, 'f1-score': 0.0071734582046428215, 'support': 9928}, '1': {'precision': 0.29717333695726034, 'recall': 0.9875804448458846, 'f1-score': 0.45686976051813744, 'support': 8857}, '2': {'precision': 0.4398496240601504, 'recall': 0.01061320754716981, 'f1-score': 0.02072630646589902, 'support': 11024}, 'accuracy': 0.29856754671407965, 'macro avg': {'precision': 0.355766063458403, 'recall': 0.3339399201234973, 'f1-score': 0.16158984172955976, 'support': 29809}, 'weighted avg': {'precision': 0.36096276219040463, 'recall': 0.29856754671407965, 'f1-score': 0.14580161576855674, 'support': 29809}}
[[   36  9824    68]
 [   29  8747    81]
 [   44 10863   117]]
training model: results/XRAY/W2/deepLOB_L2/h10
Epoch 1/50
286/286 - 19s - loss: 3.3195 - accuracy10: 0.3704 - val_loss: 3.3716 - val_accuracy10: 0.3700 - 19s/epoch - 65ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2427 - accuracy10: 0.4025 - val_loss: 3.3318 - val_accuracy10: 0.3738 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 3.1730 - accuracy10: 0.4309 - val_loss: 3.3129 - val_accuracy10: 0.3818 - 15s/epoch - 53ms/step
Epoch 4/50
286/286 - 15s - loss: 3.1261 - accuracy10: 0.4505 - val_loss: 3.3112 - val_accuracy10: 0.3708 - 15s/epoch - 52ms/step
Epoch 5/50
286/286 - 15s - loss: 3.0785 - accuracy10: 0.4695 - val_loss: 3.2745 - val_accuracy10: 0.3883 - 15s/epoch - 52ms/step
Epoch 6/50
286/286 - 15s - loss: 3.0573 - accuracy10: 0.4790 - val_loss: 3.2082 - val_accuracy10: 0.4160 - 15s/epoch - 52ms/step
Epoch 7/50
286/286 - 15s - loss: 3.0385 - accuracy10: 0.4821 - val_loss: 3.2115 - val_accuracy10: 0.4244 - 15s/epoch - 52ms/step
Epoch 8/50
286/286 - 15s - loss: 3.0166 - accuracy10: 0.4905 - val_loss: 3.1936 - val_accuracy10: 0.4186 - 15s/epoch - 52ms/step
Epoch 9/50
286/286 - 15s - loss: 3.0066 - accuracy10: 0.4928 - val_loss: 3.1892 - val_accuracy10: 0.4203 - 15s/epoch - 52ms/step
Epoch 10/50
286/286 - 15s - loss: 2.9950 - accuracy10: 0.4981 - val_loss: 3.2072 - val_accuracy10: 0.4275 - 15s/epoch - 53ms/step
Epoch 11/50
286/286 - 15s - loss: 2.9806 - accuracy10: 0.5022 - val_loss: 3.1646 - val_accuracy10: 0.4435 - 15s/epoch - 52ms/step
Epoch 12/50
286/286 - 15s - loss: 2.9699 - accuracy10: 0.5044 - val_loss: 3.1792 - val_accuracy10: 0.4373 - 15s/epoch - 53ms/step
Epoch 13/50
286/286 - 15s - loss: 2.9598 - accuracy10: 0.5075 - val_loss: 3.1619 - val_accuracy10: 0.4336 - 15s/epoch - 53ms/step
Epoch 14/50
286/286 - 15s - loss: 2.9481 - accuracy10: 0.5104 - val_loss: 3.2023 - val_accuracy10: 0.4249 - 15s/epoch - 52ms/step
Epoch 15/50
286/286 - 15s - loss: 2.9391 - accuracy10: 0.5135 - val_loss: 3.2187 - val_accuracy10: 0.4247 - 15s/epoch - 51ms/step
Epoch 16/50
286/286 - 15s - loss: 2.9286 - accuracy10: 0.5155 - val_loss: 3.2067 - val_accuracy10: 0.4318 - 15s/epoch - 51ms/step
Epoch 17/50
286/286 - 15s - loss: 2.9142 - accuracy10: 0.5204 - val_loss: 3.2011 - val_accuracy10: 0.4343 - 15s/epoch - 51ms/step
Epoch 18/50
286/286 - 15s - loss: 2.9058 - accuracy10: 0.5233 - val_loss: 3.2171 - val_accuracy10: 0.4342 - 15s/epoch - 53ms/step
Epoch 19/50
286/286 - 15s - loss: 2.8959 - accuracy10: 0.5252 - val_loss: 3.2281 - val_accuracy10: 0.4364 - 15s/epoch - 52ms/step
Epoch 20/50
286/286 - 15s - loss: 2.8844 - accuracy10: 0.5290 - val_loss: 3.2495 - val_accuracy10: 0.4309 - 15s/epoch - 53ms/step
Epoch 21/50
286/286 - 15s - loss: 2.8768 - accuracy10: 0.5308 - val_loss: 3.2349 - val_accuracy10: 0.4383 - 15s/epoch - 52ms/step
Epoch 22/50
286/286 - 15s - loss: 2.8639 - accuracy10: 0.5334 - val_loss: 3.2338 - val_accuracy10: 0.4261 - 15s/epoch - 53ms/step
Epoch 23/50
286/286 - 15s - loss: 2.8522 - accuracy10: 0.5374 - val_loss: 3.2095 - val_accuracy10: 0.4343 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h10
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0447263
{'0': {'precision': 0.48358226765577456, 'recall': 0.26327757024524934, 'f1-score': 0.34093777167054606, 'support': 92355}, '1': {'precision': 0.49316643433022433, 'recall': 0.40471753744545347, 'f1-score': 0.4445855168973849, 'support': 84790}, '2': {'precision': 0.43546767390783225, 'recall': 0.6924424115053365, 'f1-score': 0.53468142567925, 'support': 97068}, 'accuracy': 0.4589315605022373, 'macro avg': {'precision': 0.4707387919646104, 'recall': 0.4534791730653464, 'f1-score': 0.44006823808239365, 'support': 274213}, 'weighted avg': {'precision': 0.4695138394864366, 'recall': 0.4589315605022373, 'f1-score': 0.44156976696289374, 'support': 274213}}
[[24315 19205 48835]
 [12174 34316 38300]
 [13792 16062 67214]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.023092
{'0': {'precision': 0.4559026670917012, 'recall': 0.37135932834206087, 'f1-score': 0.4093109780819957, 'support': 23107}, '1': {'precision': 0.5414529352448595, 'recall': 0.45349392281423273, 'f1-score': 0.49358538827385, 'support': 27233}, '2': {'precision': 0.4268747014806559, 'recall': 0.5906767712372224, 'f1-score': 0.49559157871388704, 'support': 22696}, 'accuracy': 0.4701380141300181, 'macro avg': {'precision': 0.47474343460573887, 'recall': 0.47184334079783863, 'f1-score': 0.46616264835657756, 'support': 73036}, 'weighted avg': {'precision': 0.4787814083303599, 'recall': 0.4701380141300181, 'f1-score': 0.46754622542161145, 'support': 73036}}
[[ 8581  5641  8885]
 [ 5769 12350  9114]
 [ 4472  4818 13406]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0587357
{'0': {'precision': 0.45709793351302785, 'recall': 0.22107550244432372, 'f1-score': 0.2980156696199751, 'support': 9205}, '1': {'precision': 0.5325772480037033, 'recall': 0.3997220533310171, 'f1-score': 0.45668353676689494, 'support': 11513}, '2': {'precision': 0.37239770279971285, 'recall': 0.6847431525684743, 'f1-score': 0.482427248420971, 'support': 9091}, 'accuracy': 0.4314804253748868, 'macro avg': {'precision': 0.454024294772148, 'recall': 0.4351802361146051, 'f1-score': 0.41237548493594706, 'support': 29809}, 'weighted avg': {'precision': 0.46041852629763647, 'recall': 0.4314804253748868, 'f1-score': 0.4155381902460391, 'support': 29809}}
[[2035 2344 4826]
 [1246 4602 5665]
 [1171 1695 6225]]
training model: results/XRAY/W2/deepLOB_L2/h20
Epoch 1/50
286/286 - 18s - loss: 3.3383 - accuracy20: 0.3529 - val_loss: 3.4148 - val_accuracy20: 0.3427 - 18s/epoch - 63ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2481 - accuracy20: 0.3981 - val_loss: 3.2626 - val_accuracy20: 0.3883 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 3.1841 - accuracy20: 0.4324 - val_loss: 3.2274 - val_accuracy20: 0.4080 - 15s/epoch - 54ms/step
Epoch 4/50
286/286 - 15s - loss: 3.1446 - accuracy20: 0.4475 - val_loss: 3.2105 - val_accuracy20: 0.4213 - 15s/epoch - 54ms/step
Epoch 5/50
286/286 - 16s - loss: 3.1226 - accuracy20: 0.4576 - val_loss: 3.1821 - val_accuracy20: 0.4246 - 16s/epoch - 54ms/step
Epoch 6/50
286/286 - 15s - loss: 3.1075 - accuracy20: 0.4661 - val_loss: 3.1891 - val_accuracy20: 0.4231 - 15s/epoch - 54ms/step
Epoch 7/50
286/286 - 15s - loss: 3.0964 - accuracy20: 0.4685 - val_loss: 3.1739 - val_accuracy20: 0.4277 - 15s/epoch - 54ms/step
Epoch 8/50
286/286 - 15s - loss: 3.0854 - accuracy20: 0.4730 - val_loss: 3.1745 - val_accuracy20: 0.4333 - 15s/epoch - 54ms/step
Epoch 9/50
286/286 - 16s - loss: 3.0777 - accuracy20: 0.4762 - val_loss: 3.1866 - val_accuracy20: 0.4326 - 16s/epoch - 54ms/step
Epoch 10/50
286/286 - 15s - loss: 3.0663 - accuracy20: 0.4785 - val_loss: 3.1790 - val_accuracy20: 0.4350 - 15s/epoch - 54ms/step
Epoch 11/50
286/286 - 15s - loss: 3.0534 - accuracy20: 0.4831 - val_loss: 3.2021 - val_accuracy20: 0.4307 - 15s/epoch - 54ms/step
Epoch 12/50
286/286 - 15s - loss: 3.0444 - accuracy20: 0.4841 - val_loss: 3.2005 - val_accuracy20: 0.4275 - 15s/epoch - 54ms/step
Epoch 13/50
286/286 - 15s - loss: 3.0325 - accuracy20: 0.4898 - val_loss: 3.2177 - val_accuracy20: 0.4256 - 15s/epoch - 54ms/step
Epoch 14/50
286/286 - 15s - loss: 3.0269 - accuracy20: 0.4898 - val_loss: 3.2223 - val_accuracy20: 0.4266 - 15s/epoch - 54ms/step
Epoch 15/50
286/286 - 15s - loss: 3.0176 - accuracy20: 0.4931 - val_loss: 3.2767 - val_accuracy20: 0.4138 - 15s/epoch - 54ms/step
Epoch 16/50
286/286 - 15s - loss: 3.0084 - accuracy20: 0.4943 - val_loss: 3.2438 - val_accuracy20: 0.4164 - 15s/epoch - 54ms/step
Epoch 17/50
286/286 - 15s - loss: 2.9934 - accuracy20: 0.4990 - val_loss: 3.2789 - val_accuracy20: 0.4160 - 15s/epoch - 54ms/step
testing model: results/XRAY/W2/deepLOB_L2/h20
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0530657
{'0': {'precision': 0.47610551803236906, 'recall': 0.3140551445864156, 'f1-score': 0.37846325279846016, 'support': 95168}, '1': {'precision': 0.46040461533702476, 'recall': 0.3823635195889531, 'f1-score': 0.4177707292426879, 'support': 77850}, '2': {'precision': 0.4445201419782945, 'recall': 0.6447749394732941, 'f1-score': 0.5262402309882329, 'support': 101195}, 'accuracy': 0.45549627479368227, 'macro avg': {'precision': 0.46034342511589604, 'recall': 0.44706453454955425, 'f1-score': 0.4408247376764603, 'support': 274213}, 'weighted avg': {'precision': 0.4599917765079898, 'recall': 0.45549627479368227, 'f1-score': 0.4441580898379046, 'support': 274213}}
[[29888 17936 47344]
 [13892 29767 34191]
 [18996 16951 65248]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0432463
{'0': {'precision': 0.4503389100027426, 'recall': 0.47151002994626084, 'f1-score': 0.46068136272545085, 'support': 24377}, '1': {'precision': 0.4930966469428008, 'recall': 0.3958104981122884, 'f1-score': 0.43912984731793003, 'support': 24633}, '2': {'precision': 0.4320115356885364, 'recall': 0.4987929742778656, 'f1-score': 0.4630066066530155, 'support': 24026}, 'accuracy': 0.4549537214524344, 'macro avg': {'precision': 0.45848236421135996, 'recall': 0.4553711674454716, 'f1-score': 0.4542726055654655, 'support': 73036}, 'weighted avg': {'precision': 0.458730906261729, 'recall': 0.4549537214524344, 'f1-score': 0.45417755407725285, 'support': 73036}}
[[11494  5052  7831]
 [ 6958  9750  7925]
 [ 7071  4971 11984]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.057635
{'0': {'precision': 0.4482974461692539, 'recall': 0.3662677712999898, 'f1-score': 0.40315226569096535, 'support': 9777}, '1': {'precision': 0.48309817754262196, 'recall': 0.3174311926605505, 'f1-score': 0.38312255958971975, 'support': 10355}, '2': {'precision': 0.3923553306252913, 'recall': 0.6088663842099824, 'f1-score': 0.4772009394994735, 'support': 9677}, 'accuracy': 0.42805864000805127, 'macro avg': {'precision': 0.4412503181123891, 'recall': 0.43085511605684085, 'f1-score': 0.4211585882600528, 'support': 29809}, 'weighted avg': {'precision': 0.442225780606917, 'recall': 0.42805864000805127, 'f1-score': 0.42023306040955827, 'support': 29809}}
[[3581 1871 4325]
 [2268 3287 4800]
 [2139 1646 5892]]
training model: results/XRAY/W2/deepLOB_L2/h30
Epoch 1/50
286/286 - 17s - loss: 3.3394 - accuracy30: 0.3531 - val_loss: 3.3614 - val_accuracy30: 0.3509 - 17s/epoch - 60ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2683 - accuracy30: 0.3842 - val_loss: 3.3438 - val_accuracy30: 0.3636 - 15s/epoch - 53ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2284 - accuracy30: 0.4073 - val_loss: 3.2971 - val_accuracy30: 0.3745 - 15s/epoch - 52ms/step
Epoch 4/50
286/286 - 15s - loss: 3.1973 - accuracy30: 0.4253 - val_loss: 3.2540 - val_accuracy30: 0.3959 - 15s/epoch - 52ms/step
Epoch 5/50
286/286 - 15s - loss: 3.1729 - accuracy30: 0.4404 - val_loss: 3.2790 - val_accuracy30: 0.3989 - 15s/epoch - 53ms/step
Epoch 6/50
286/286 - 15s - loss: 3.1625 - accuracy30: 0.4447 - val_loss: 3.2731 - val_accuracy30: 0.3993 - 15s/epoch - 52ms/step
Epoch 7/50
286/286 - 15s - loss: 3.1445 - accuracy30: 0.4528 - val_loss: 3.2655 - val_accuracy30: 0.4024 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.1331 - accuracy30: 0.4566 - val_loss: 3.2431 - val_accuracy30: 0.4086 - 15s/epoch - 53ms/step
Epoch 9/50
286/286 - 15s - loss: 3.1240 - accuracy30: 0.4603 - val_loss: 3.2400 - val_accuracy30: 0.4140 - 15s/epoch - 53ms/step
Epoch 10/50
286/286 - 15s - loss: 3.1130 - accuracy30: 0.4637 - val_loss: 3.2529 - val_accuracy30: 0.4046 - 15s/epoch - 52ms/step
Epoch 11/50
286/286 - 15s - loss: 3.1024 - accuracy30: 0.4689 - val_loss: 3.2503 - val_accuracy30: 0.4086 - 15s/epoch - 52ms/step
Epoch 12/50
286/286 - 15s - loss: 3.0937 - accuracy30: 0.4724 - val_loss: 3.2522 - val_accuracy30: 0.4088 - 15s/epoch - 52ms/step
Epoch 13/50
286/286 - 15s - loss: 3.0846 - accuracy30: 0.4723 - val_loss: 3.2633 - val_accuracy30: 0.4073 - 15s/epoch - 53ms/step
Epoch 14/50
286/286 - 15s - loss: 3.0757 - accuracy30: 0.4780 - val_loss: 3.2655 - val_accuracy30: 0.4089 - 15s/epoch - 52ms/step
Epoch 15/50
286/286 - 15s - loss: 3.0709 - accuracy30: 0.4775 - val_loss: 3.2705 - val_accuracy30: 0.4091 - 15s/epoch - 52ms/step
Epoch 16/50
286/286 - 15s - loss: 3.0580 - accuracy30: 0.4838 - val_loss: 3.2848 - val_accuracy30: 0.4063 - 15s/epoch - 53ms/step
Epoch 17/50
286/286 - 15s - loss: 3.0481 - accuracy30: 0.4866 - val_loss: 3.2883 - val_accuracy30: 0.4056 - 15s/epoch - 53ms/step
Epoch 18/50
286/286 - 15s - loss: 3.0372 - accuracy30: 0.4897 - val_loss: 3.2808 - val_accuracy30: 0.4076 - 15s/epoch - 52ms/step
Epoch 19/50
286/286 - 15s - loss: 3.0274 - accuracy30: 0.4938 - val_loss: 3.3475 - val_accuracy30: 0.4012 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h30
Evaluating performance on  test set...
1072/1072 - 25s - 25s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081665
{'0': {'precision': 0.45408244049189844, 'recall': 0.18169626829422822, 'f1-score': 0.2595402576246644, 'support': 94702}, '1': {'precision': 0.38593525217628716, 'recall': 0.4758409073254098, 'f1-score': 0.4261983312943196, 'support': 77238}, '2': {'precision': 0.44091630755273303, 'recall': 0.6082543779883254, 'f1-score': 0.5112405027921484, 'support': 102273}, 'accuracy': 0.4236414757870706, 'macro avg': {'precision': 0.42697800007363956, 'recall': 0.4219305178693211, 'f1-score': 0.39899303057037744, 'support': 274213}, 'weighted avg': {'precision': 0.42997675460097257, 'recall': 0.4236414757870706, 'f1-score': 0.40035953121166035, 'support': 274213}}
[[17207 30560 46935]
 [ 8540 36753 31945]
 [12147 27918 62208]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0624244
{'0': {'precision': 0.46015879362540696, 'recall': 0.3251008878127522, 'f1-score': 0.38101544209804433, 'support': 24780}, '1': {'precision': 0.42659402149904285, 'recall': 0.4886770969510395, 'f1-score': 0.4555300037344969, 'support': 23713}, '2': {'precision': 0.42834479111581175, 'recall': 0.49504950495049505, 'f1-score': 0.4592878203674302, 'support': 24543}, 'accuracy': 0.43531956843200614, 'macro avg': {'precision': 0.4383658687467538, 'recall': 0.43627582990476227, 'f1-score': 0.4319444220666571, 'support': 73036}, 'weighted avg': {'precision': 0.43857036456267806, 'recall': 0.43531956843200614, 'f1-score': 0.4315111261435936, 'support': 73036}}
[[ 8056  8182  8542]
 [ 4452 11588  7673]
 [ 4999  7394 12150]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0808364
{'0': {'precision': 0.4557344064386318, 'recall': 0.18373555059825594, 'f1-score': 0.2618875560052031, 'support': 9862}, '1': {'precision': 0.4252557041699449, 'recall': 0.43549199315137477, 'f1-score': 0.43031298203712, 'support': 9929}, '2': {'precision': 0.3935525055857006, 'recall': 0.6153922938710321, 'f1-score': 0.4800841023244948, 'support': 10018}, 'accuracy': 0.4126606058572914, 'macro avg': {'precision': 0.4248475387314257, 'recall': 0.4115399458735543, 'f1-score': 0.3907615467889393, 'support': 29809}, 'weighted avg': {'precision': 0.4246846792565574, 'recall': 0.4126606058572914, 'f1-score': 0.39131789771735603, 'support': 29809}}
[[1812 3079 4971]
 [1076 4324 4529]
 [1088 2765 6165]]
training model: results/XRAY/W2/deepLOB_L2/h50
Epoch 1/50
286/286 - 18s - loss: 3.3356 - accuracy50: 0.3574 - val_loss: 3.3951 - val_accuracy50: 0.3462 - 18s/epoch - 64ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2765 - accuracy50: 0.3808 - val_loss: 3.3356 - val_accuracy50: 0.3388 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2520 - accuracy50: 0.3912 - val_loss: 3.3474 - val_accuracy50: 0.3453 - 15s/epoch - 53ms/step
Epoch 4/50
286/286 - 15s - loss: 3.2334 - accuracy50: 0.4028 - val_loss: 3.3857 - val_accuracy50: 0.3398 - 15s/epoch - 53ms/step
Epoch 5/50
286/286 - 15s - loss: 3.2181 - accuracy50: 0.4107 - val_loss: 3.3993 - val_accuracy50: 0.3500 - 15s/epoch - 53ms/step
Epoch 6/50
286/286 - 15s - loss: 3.2040 - accuracy50: 0.4181 - val_loss: 3.3496 - val_accuracy50: 0.3496 - 15s/epoch - 52ms/step
Epoch 7/50
286/286 - 15s - loss: 3.1879 - accuracy50: 0.4269 - val_loss: 3.4345 - val_accuracy50: 0.3576 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.1787 - accuracy50: 0.4306 - val_loss: 3.4182 - val_accuracy50: 0.3645 - 15s/epoch - 53ms/step
Epoch 9/50
286/286 - 15s - loss: 3.1660 - accuracy50: 0.4378 - val_loss: 3.4957 - val_accuracy50: 0.3615 - 15s/epoch - 52ms/step
Epoch 10/50
286/286 - 15s - loss: 3.1645 - accuracy50: 0.4381 - val_loss: 3.3432 - val_accuracy50: 0.3755 - 15s/epoch - 52ms/step
Epoch 11/50
286/286 - 15s - loss: 3.1545 - accuracy50: 0.4442 - val_loss: 3.3708 - val_accuracy50: 0.3715 - 15s/epoch - 53ms/step
Epoch 12/50
286/286 - 15s - loss: 3.1461 - accuracy50: 0.4468 - val_loss: 3.3752 - val_accuracy50: 0.3692 - 15s/epoch - 53ms/step
testing model: results/XRAY/W2/deepLOB_L2/h50
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007553
{'0': {'precision': 0.3648280201342282, 'recall': 0.11306589823310836, 'f1-score': 0.17263081287163923, 'support': 92309}, '1': {'precision': 0.3490386570241933, 'recall': 0.5978162191739936, 'f1-score': 0.4407454099525523, 'support': 80411}, '2': {'precision': 0.4020819236010048, 'recall': 0.42738908102036594, 'f1-score': 0.4143494416689752, 'support': 101493}, 'accuracy': 0.3715542297411137, 'macro avg': {'precision': 0.3719828669198087, 'recall': 0.37942373280915603, 'f1-score': 0.34257522149772224, 'support': 274213}, 'weighted avg': {'precision': 0.3739864916418246, 'recall': 0.3715542297411137, 'f1-score': 0.3407195309791007, 'support': 274213}}
[[10437 42946 38926]
 [ 6762 48071 25578]
 [11409 46707 43377]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1132051
{'0': {'precision': 0.37949075688873385, 'recall': 0.13324624428478118, 'f1-score': 0.19723842040064055, 'support': 24496}, '1': {'precision': 0.36612181358240903, 'recall': 0.619067204079954, 'f1-score': 0.46012288692568704, 'support': 24314}, '2': {'precision': 0.3630750761051323, 'recall': 0.34954181457937755, 'f1-score': 0.35617994069275905, 'support': 24226}, 'accuracy': 0.366723259762309, 'macro avg': {'precision': 0.3695625488587584, 'recall': 0.3672850876480376, 'f1-score': 0.3378470826730289, 'support': 73036}, 'weighted avg': {'precision': 0.3695951058370126, 'recall': 0.366723259762309, 'f1-score': 0.3374746078929299, 'support': 73036}}
[[ 3264 13169  8063]
 [ 2470 15052  6792]
 [ 2867 12891  8468]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1128156
{'0': {'precision': 0.33387888707037644, 'recall': 0.12838263058527374, 'f1-score': 0.18545454545454546, 'support': 9534}, '1': {'precision': 0.3451855123674912, 'recall': 0.45799960929869116, 'f1-score': 0.39366971706825626, 'support': 10238}, '2': {'precision': 0.33816386654988456, 'recall': 0.4231344027099731, 'f1-score': 0.3759072402195079, 'support': 10037}, 'accuracy': 0.3408366600691066, 'macro avg': {'precision': 0.33907608866258404, 'recall': 0.3365055475313126, 'f1-score': 0.3183438342474365, 'support': 29809}, 'weighted avg': {'precision': 0.33920498217010087, 'recall': 0.3408366600691066, 'f1-score': 0.3210941383404892, 'support': 29809}}
[[1224 4288 4022]
 [1259 4689 4290]
 [1183 4607 4247]]
training model: results/XRAY/W2/deepLOB_L2/h100
Epoch 1/50
286/286 - 18s - loss: 3.3588 - accuracy100: 0.3386 - val_loss: 3.3851 - val_accuracy100: 0.3400 - 18s/epoch - 62ms/step
Epoch 2/50
286/286 - 15s - loss: 3.3132 - accuracy100: 0.3545 - val_loss: 3.3648 - val_accuracy100: 0.3294 - 15s/epoch - 53ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2970 - accuracy100: 0.3601 - val_loss: 3.4339 - val_accuracy100: 0.3341 - 15s/epoch - 53ms/step
Epoch 4/50
286/286 - 15s - loss: 3.2763 - accuracy100: 0.3764 - val_loss: 3.4321 - val_accuracy100: 0.3311 - 15s/epoch - 52ms/step
Epoch 5/50
286/286 - 15s - loss: 3.2690 - accuracy100: 0.3796 - val_loss: 3.4022 - val_accuracy100: 0.3233 - 15s/epoch - 53ms/step
Epoch 6/50
286/286 - 15s - loss: 3.2553 - accuracy100: 0.3893 - val_loss: 3.4556 - val_accuracy100: 0.3260 - 15s/epoch - 53ms/step
Epoch 7/50
286/286 - 15s - loss: 3.2484 - accuracy100: 0.3945 - val_loss: 3.4537 - val_accuracy100: 0.3358 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.2363 - accuracy100: 0.4011 - val_loss: 3.4846 - val_accuracy100: 0.3266 - 15s/epoch - 52ms/step
Epoch 9/50
286/286 - 15s - loss: 3.2270 - accuracy100: 0.4072 - val_loss: 3.4856 - val_accuracy100: 0.3335 - 15s/epoch - 53ms/step
Epoch 10/50
286/286 - 15s - loss: 3.2152 - accuracy100: 0.4138 - val_loss: 3.5272 - val_accuracy100: 0.3339 - 15s/epoch - 53ms/step
Epoch 11/50
286/286 - 15s - loss: 3.2043 - accuracy100: 0.4190 - val_loss: 3.5405 - val_accuracy100: 0.3260 - 15s/epoch - 52ms/step
Epoch 12/50
286/286 - 15s - loss: 3.1922 - accuracy100: 0.4260 - val_loss: 3.5488 - val_accuracy100: 0.3322 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h100
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1178873
{'0': {'precision': 0.323556338028169, 'recall': 0.10069805924188793, 'f1-score': 0.1535941430636925, 'support': 91253}, '1': {'precision': 0.30873563218390804, 'recall': 0.5179264530254777, 'f1-score': 0.38686267039594113, 'support': 80384}, '2': {'precision': 0.38728224723556504, 'recall': 0.41894790204336296, 'f1-score': 0.40249322137876453, 'support': 102576}, 'accuracy': 0.34205526360894634, 'macro avg': {'precision': 0.33985807248254735, 'recall': 0.34585747143690954, 'f1-score': 0.3143166782794661, 'support': 274213}, 'weighted avg': {'precision': 0.343049947901781, 'recall': 0.34205526360894634, 'f1-score': 0.31508221678128545, 'support': 274213}}
[[ 9189 43718 38346]
 [ 9108 41633 29643]
 [10103 49499 42974]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1235076
{'0': {'precision': 0.35310150375939847, 'recall': 0.15204370700121408, 'f1-score': 0.21256011315417256, 'support': 24710}, '1': {'precision': 0.3362859688662928, 'recall': 0.531169798824406, 'f1-score': 0.4118364464984916, 'support': 24158}, '2': {'precision': 0.33117418928954534, 'recall': 0.3321333995365773, 'f1-score': 0.3316531008552659, 'support': 24168}, 'accuracy': 0.33703926830604086, 'macro avg': {'precision': 0.3401872206384122, 'recall': 0.33844896845406575, 'f1-score': 0.31868322016931, 'support': 73036}, 'weighted avg': {'precision': 0.34028359166050126, 'recall': 0.33703926830604086, 'f1-score': 0.317882926392741, 'support': 73036}}
[[ 3757 12662  8291]
 [ 3406 12832  7920]
 [ 3477 12664  8027]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1212286
{'0': {'precision': 0.3261754905590522, 'recall': 0.09270756603177943, 'f1-score': 0.1443788921665028, 'support': 9503}, '1': {'precision': 0.3456813104988831, 'recall': 0.5345936090586316, 'f1-score': 0.4198666013490598, 'support': 10421}, '2': {'precision': 0.31259097525473073, 'recall': 0.3475973697521497, 'f1-score': 0.3291660679216363, 'support': 9885}, 'accuracy': 0.3317118990908786, 'macro avg': {'precision': 0.3281492587708887, 'recall': 0.32496618161418694, 'f1-score': 0.2978038538123996, 'support': 29809}, 'weighted avg': {'precision': 0.32848979884882246, 'recall': 0.3317118990908786, 'f1-score': 0.3019648108397532, 'support': 29809}}
[[ 881 4981 3641]
 [ 935 5571 3915]
 [ 885 5564 3436]]
training model: results/XRAY/W2/deepLOB_L2/h200
Epoch 1/50
286/286 - 17s - loss: 3.3370 - accuracy200: 0.3637 - val_loss: 3.4852 - val_accuracy200: 0.3438 - 17s/epoch - 61ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2842 - accuracy200: 0.3832 - val_loss: 3.3871 - val_accuracy200: 0.3458 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2588 - accuracy200: 0.3935 - val_loss: 3.3833 - val_accuracy200: 0.3472 - 15s/epoch - 53ms/step
Epoch 4/50
286/286 - 15s - loss: 3.2523 - accuracy200: 0.4016 - val_loss: 3.3447 - val_accuracy200: 0.3581 - 15s/epoch - 53ms/step
Epoch 5/50
286/286 - 15s - loss: 3.2422 - accuracy200: 0.4036 - val_loss: 3.3708 - val_accuracy200: 0.3540 - 15s/epoch - 52ms/step
Epoch 6/50
286/286 - 15s - loss: 3.2386 - accuracy200: 0.4083 - val_loss: 3.3329 - val_accuracy200: 0.3603 - 15s/epoch - 52ms/step
Epoch 7/50
286/286 - 16s - loss: 3.2264 - accuracy200: 0.4144 - val_loss: 3.3646 - val_accuracy200: 0.3688 - 16s/epoch - 57ms/step
Epoch 8/50
286/286 - 16s - loss: 3.2055 - accuracy200: 0.4254 - val_loss: 3.3583 - val_accuracy200: 0.3643 - 16s/epoch - 56ms/step
Epoch 9/50
286/286 - 15s - loss: 3.1962 - accuracy200: 0.4278 - val_loss: 3.3479 - val_accuracy200: 0.3752 - 15s/epoch - 52ms/step
Epoch 10/50
286/286 - 15s - loss: 3.1794 - accuracy200: 0.4358 - val_loss: 3.3604 - val_accuracy200: 0.3597 - 15s/epoch - 52ms/step
Epoch 11/50
286/286 - 15s - loss: 3.1621 - accuracy200: 0.4426 - val_loss: 3.3941 - val_accuracy200: 0.3589 - 15s/epoch - 53ms/step
Epoch 12/50
286/286 - 15s - loss: 3.1559 - accuracy200: 0.4472 - val_loss: 3.3878 - val_accuracy200: 0.3551 - 15s/epoch - 52ms/step
Epoch 13/50
286/286 - 15s - loss: 3.1453 - accuracy200: 0.4515 - val_loss: 3.4260 - val_accuracy200: 0.3630 - 15s/epoch - 52ms/step
Epoch 14/50
286/286 - 15s - loss: 3.1248 - accuracy200: 0.4595 - val_loss: 3.4877 - val_accuracy200: 0.3601 - 15s/epoch - 51ms/step
Epoch 15/50
286/286 - 15s - loss: 3.1106 - accuracy200: 0.4633 - val_loss: 3.4928 - val_accuracy200: 0.3597 - 15s/epoch - 52ms/step
Epoch 16/50
286/286 - 15s - loss: 3.1005 - accuracy200: 0.4658 - val_loss: 3.5342 - val_accuracy200: 0.3545 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h200
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1187664
{'0': {'precision': 0.3326715825297788, 'recall': 0.06479589018394741, 'f1-score': 0.10846548615285033, 'support': 90515}, '1': {'precision': 0.3510288122520934, 'recall': 0.6239213718314341, 'f1-score': 0.4492832180929591, 'support': 81701}, '2': {'precision': 0.398017366006088, 'recall': 0.434581409257135, 'f1-score': 0.4154965223749086, 'support': 101997}, 'accuracy': 0.3689321804582569, 'macro avg': {'precision': 0.3605725869293201, 'recall': 0.3744328904241722, 'f1-score': 0.32441507554023935, 'support': 274213}, 'weighted avg': {'precision': 0.36244726020653356, 'recall': 0.3689321804582569, 'f1-score': 0.3242152650429106, 'support': 274213}}
[[ 5865 43863 40787]
 [ 4472 50975 26254]
 [ 7293 50378 44326]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269192
{'0': {'precision': 0.3929437112846755, 'recall': 0.17459810921855679, 'f1-score': 0.2417697746354397, 'support': 25069}, '1': {'precision': 0.36607073354264513, 'recall': 0.5961798512508452, 'f1-score': 0.45361156214330495, 'support': 23664}, '2': {'precision': 0.35088620601078857, 'recall': 0.337242315763486, 'f1-score': 0.3439289985522755, 'support': 24303}, 'accuracy': 0.3653129963305767, 'macro avg': {'precision': 0.3699668836127031, 'recall': 0.3693400920776293, 'f1-score': 0.34643677844367343, 'support': 73036}, 'weighted avg': {'precision': 0.3702419519336886, 'recall': 0.3653129963305767, 'f1-score': 0.34440134918000653, 'support': 73036}}
[[ 4377 12059  8633]
 [ 3027 14108  6529]
 [ 3735 12372  8196]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.111841
{'0': {'precision': 0.3636698599852616, 'recall': 0.1007656967840735, 'f1-score': 0.15780637940682707, 'support': 9795}, '1': {'precision': 0.39160205417379923, 'recall': 0.394062215016719, 'f1-score': 0.39282828282828286, 'support': 9869}, '2': {'precision': 0.34368445583780005, 'recall': 0.5814687037949728, 'f1-score': 0.432018748397964, 'support': 10145}, 'accuracy': 0.3614680130162032, 'macro avg': {'precision': 0.3663187899989537, 'recall': 0.3587655385319218, 'f1-score': 0.32755113687769133, 'support': 29809}, 'weighted avg': {'precision': 0.3661157957553539, 'recall': 0.3614680130162032, 'f1-score': 0.3289397836901452, 'support': 29809}}
[[ 987 2832 5976]
 [ 691 3889 5289]
 [1036 3210 5899]]
training model: results/XRAY/W2/deepLOB_L2/h300
Epoch 1/50
286/286 - 17s - loss: 3.3345 - accuracy300: 0.3613 - val_loss: 3.5179 - val_accuracy300: 0.3195 - 17s/epoch - 60ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2967 - accuracy300: 0.3739 - val_loss: 3.4501 - val_accuracy300: 0.3392 - 15s/epoch - 52ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2700 - accuracy300: 0.3872 - val_loss: 3.4859 - val_accuracy300: 0.3177 - 15s/epoch - 52ms/step
Epoch 4/50
286/286 - 15s - loss: 3.2503 - accuracy300: 0.3995 - val_loss: 3.5729 - val_accuracy300: 0.3191 - 15s/epoch - 53ms/step
Epoch 5/50
286/286 - 15s - loss: 3.2333 - accuracy300: 0.4101 - val_loss: 3.5296 - val_accuracy300: 0.3349 - 15s/epoch - 53ms/step
Epoch 6/50
286/286 - 15s - loss: 3.2286 - accuracy300: 0.4145 - val_loss: 3.6214 - val_accuracy300: 0.3288 - 15s/epoch - 52ms/step
Epoch 7/50
286/286 - 15s - loss: 3.2103 - accuracy300: 0.4201 - val_loss: 3.5441 - val_accuracy300: 0.3526 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.1986 - accuracy300: 0.4261 - val_loss: 3.5577 - val_accuracy300: 0.3537 - 15s/epoch - 52ms/step
Epoch 9/50
286/286 - 15s - loss: 3.1850 - accuracy300: 0.4334 - val_loss: 3.4825 - val_accuracy300: 0.3465 - 15s/epoch - 52ms/step
Epoch 10/50
286/286 - 15s - loss: 3.1653 - accuracy300: 0.4390 - val_loss: 3.5101 - val_accuracy300: 0.3452 - 15s/epoch - 53ms/step
Epoch 11/50
286/286 - 15s - loss: 3.1511 - accuracy300: 0.4458 - val_loss: 3.5404 - val_accuracy300: 0.3449 - 15s/epoch - 53ms/step
Epoch 12/50
286/286 - 15s - loss: 3.1330 - accuracy300: 0.4522 - val_loss: 3.5540 - val_accuracy300: 0.3378 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h300
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1687549
{'0': {'precision': 0.3299947070559016, 'recall': 0.09007657342268752, 'f1-score': 0.14152261218788198, 'support': 89979}, '1': {'precision': 0.2911739479543049, 'recall': 0.8111512162883506, 'f1-score': 0.4285234696549548, 'support': 78682}, '2': {'precision': 0.39156270518713066, 'recall': 0.11299643777474609, 'f1-score': 0.1753815839778843, 'support': 105552}, 'accuracy': 0.3058024236633566, 'macro avg': {'precision': 0.33757712006577906, 'recall': 0.3380747424952614, 'f1-score': 0.24847588860690703, 'support': 274213}, 'weighted avg': {'precision': 0.34255476209018393, 'recall': 0.3058024236633566, 'f1-score': 0.23690716236457876, 'support': 274213}}
[[ 8105 71538 10336]
 [ 6662 63823  8197]
 [ 9794 83831 11927]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.138427
{'0': {'precision': 0.37227918690411943, 'recall': 0.16728639560261901, 'f1-score': 0.2308421639709983, 'support': 24742}, '1': {'precision': 0.34778276033881417, 'recall': 0.7742810188989317, 'f1-score': 0.4799755504335978, 'support': 24340}, '2': {'precision': 0.3313494630611981, 'recall': 0.10691325039659347, 'f1-score': 0.16166398383991418, 'support': 23954}, 'accuracy': 0.3497727148255655, 'macro avg': {'precision': 0.3504704701013772, 'recall': 0.34949355496604806, 'f1-score': 0.2908272327481701, 'support': 73036}, 'weighted avg': {'precision': 0.35069156398483486, 'recall': 0.3497727148255655, 'f1-score': 0.29117970298791707, 'support': 73036}}
[[ 4139 17730  2873]
 [ 3199 18846  2295]
 [ 3780 17613  2561]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1500809
{'0': {'precision': 0.3196117804551539, 'recall': 0.0986060918946825, 'f1-score': 0.1507141166258976, 'support': 9685}, '1': {'precision': 0.3339269020166496, 'recall': 0.7757782604198986, 'f1-score': 0.4668865928046807, 'support': 9669}, '2': {'precision': 0.39100504818724185, 'recall': 0.1629842180774749, 'f1-score': 0.23006818335246068, 'support': 10455}, 'accuracy': 0.3408366600691066, 'macro avg': {'precision': 0.3481812435530151, 'recall': 0.3457895234640187, 'f1-score': 0.28255629759434636, 'support': 29809}, 'weighted avg': {'precision': 0.3492950816231596, 'recall': 0.3408366600691066, 'f1-score': 0.2811015311583835, 'support': 29809}}
[[ 955 7306 1424]
 [ 938 7501 1230]
 [1095 7656 1704]]
training model: results/XRAY/W2/deepLOB_L2/h500
Epoch 1/50
286/286 - 19s - loss: 3.3351 - accuracy500: 0.3625 - val_loss: 3.6502 - val_accuracy500: 0.3230 - 19s/epoch - 65ms/step
Epoch 2/50
286/286 - 15s - loss: 3.2813 - accuracy500: 0.3822 - val_loss: 3.6052 - val_accuracy500: 0.3239 - 15s/epoch - 54ms/step
Epoch 3/50
286/286 - 15s - loss: 3.2746 - accuracy500: 0.3858 - val_loss: 3.6027 - val_accuracy500: 0.3202 - 15s/epoch - 54ms/step
Epoch 4/50
286/286 - 15s - loss: 3.2490 - accuracy500: 0.3944 - val_loss: 3.5491 - val_accuracy500: 0.3421 - 15s/epoch - 53ms/step
Epoch 5/50
286/286 - 15s - loss: 3.2250 - accuracy500: 0.4061 - val_loss: 3.5918 - val_accuracy500: 0.3241 - 15s/epoch - 53ms/step
Epoch 6/50
286/286 - 15s - loss: 3.2106 - accuracy500: 0.4152 - val_loss: 3.6133 - val_accuracy500: 0.3324 - 15s/epoch - 53ms/step
Epoch 7/50
286/286 - 15s - loss: 3.1861 - accuracy500: 0.4279 - val_loss: 3.6309 - val_accuracy500: 0.3432 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.1672 - accuracy500: 0.4339 - val_loss: 3.6431 - val_accuracy500: 0.3404 - 15s/epoch - 52ms/step
Epoch 9/50
286/286 - 15s - loss: 3.1484 - accuracy500: 0.4423 - val_loss: 3.7162 - val_accuracy500: 0.3387 - 15s/epoch - 52ms/step
Epoch 10/50
286/286 - 15s - loss: 3.1311 - accuracy500: 0.4485 - val_loss: 3.6898 - val_accuracy500: 0.3415 - 15s/epoch - 52ms/step
Epoch 11/50
286/286 - 15s - loss: 3.1096 - accuracy500: 0.4565 - val_loss: 3.7136 - val_accuracy500: 0.3519 - 15s/epoch - 52ms/step
Epoch 12/50
286/286 - 15s - loss: 3.0846 - accuracy500: 0.4694 - val_loss: 3.7738 - val_accuracy500: 0.3425 - 15s/epoch - 52ms/step
Epoch 13/50
286/286 - 15s - loss: 3.0707 - accuracy500: 0.4728 - val_loss: 3.7561 - val_accuracy500: 0.3538 - 15s/epoch - 52ms/step
Epoch 14/50
286/286 - 15s - loss: 3.0518 - accuracy500: 0.4791 - val_loss: 3.7757 - val_accuracy500: 0.3504 - 15s/epoch - 52ms/step
testing model: results/XRAY/W2/deepLOB_L2/h500
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.212789
{'0': {'precision': 0.2758706674424404, 'recall': 0.11344164426012851, 'f1-score': 0.16077180801679247, 'support': 87772}, '1': {'precision': 0.28338541300350656, 'recall': 0.7166596790791631, 'f1-score': 0.40616348352024195, 'support': 78711}, '2': {'precision': 0.371473915937132, 'recall': 0.13470713821591015, 'f1-score': 0.19771655903430613, 'support': 107730}, 'accuracy': 0.29494589972029045, 'macro avg': {'precision': 0.310243332127693, 'recall': 0.32160282051840056, 'f1-score': 0.2548839501904469, 'support': 274213}, 'weighted avg': {'precision': 0.3155873515463677, 'recall': 0.29494589972029045, 'f1-score': 0.24572431645975018, 'support': 274213}}
[[ 9957 64207 13608]
 [11356 56409 10946]
 [14780 78438 14512]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1743734
{'0': {'precision': 0.36009439637221785, 'recall': 0.31936635613739894, 'f1-score': 0.3385097220409761, 'support': 24367}, '1': {'precision': 0.37526158445440955, 'recall': 0.6005023122309041, 'f1-score': 0.4618851956335091, 'support': 25084}, '2': {'precision': 0.3347806823216659, 'recall': 0.160186559253763, 'f1-score': 0.21669056495554917, 'support': 23585}, 'accuracy': 0.36451886740785366, 'macro avg': {'precision': 0.3567122210494311, 'recall': 0.36001840920735534, 'f1-score': 0.33902849421001147, 'support': 73036}, 'weighted avg': {'precision': 0.3571291436197593, 'recall': 0.36451886740785366, 'f1-score': 0.34154446599923377, 'support': 73036}}
[[ 7782 12305  4280]
 [ 6794 15063  3227]
 [ 7035 12772  3778]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1764199
{'0': {'precision': 0.2612204724409449, 'recall': 0.1378558071888635, 'f1-score': 0.18047055623555008, 'support': 9626}, '1': {'precision': 0.35290697674418603, 'recall': 0.4996912945050422, 'f1-score': 0.41366385552432067, 'support': 9718}, '2': {'precision': 0.3699516820129456, 'recall': 0.38776875298614427, 'f1-score': 0.37865074181207425, 'support': 10465}, 'accuracy': 0.3435539602133584, 'macro avg': {'precision': 0.3280263770660255, 'recall': 0.34177195156001666, 'f1-score': 0.324261717857315, 'support': 29809}, 'weighted avg': {'precision': 0.3292831903110473, 'recall': 0.3435539602133584, 'f1-score': 0.3260684670861857, 'support': 29809}}
[[1327 4457 3842]
 [1793 4856 3069]
 [1960 4447 4058]]
training model: results/XRAY/W2/deepLOB_L2/h1000
Epoch 1/50
286/286 - 17s - loss: 3.3260 - accuracy1000: 0.3700 - val_loss: 3.7593 - val_accuracy1000: 0.3276 - 17s/epoch - 61ms/step
Epoch 2/50
286/286 - 18s - loss: 3.2448 - accuracy1000: 0.4079 - val_loss: 3.9150 - val_accuracy1000: 0.3207 - 18s/epoch - 63ms/step
Epoch 3/50
286/286 - 22s - loss: 3.2190 - accuracy1000: 0.4214 - val_loss: 4.0336 - val_accuracy1000: 0.2784 - 22s/epoch - 76ms/step
Epoch 4/50
286/286 - 15s - loss: 3.1948 - accuracy1000: 0.4307 - val_loss: 3.9403 - val_accuracy1000: 0.2915 - 15s/epoch - 54ms/step
Epoch 5/50
286/286 - 15s - loss: 3.1658 - accuracy1000: 0.4395 - val_loss: 3.8303 - val_accuracy1000: 0.2860 - 15s/epoch - 54ms/step
Epoch 6/50
286/286 - 15s - loss: 3.1433 - accuracy1000: 0.4417 - val_loss: 3.8911 - val_accuracy1000: 0.2925 - 15s/epoch - 53ms/step
Epoch 7/50
286/286 - 15s - loss: 3.1092 - accuracy1000: 0.4540 - val_loss: 4.0493 - val_accuracy1000: 0.2635 - 15s/epoch - 53ms/step
Epoch 8/50
286/286 - 15s - loss: 3.0731 - accuracy1000: 0.4673 - val_loss: 4.0628 - val_accuracy1000: 0.2879 - 15s/epoch - 54ms/step
Epoch 9/50
286/286 - 15s - loss: 3.0608 - accuracy1000: 0.4708 - val_loss: 3.8725 - val_accuracy1000: 0.3160 - 15s/epoch - 53ms/step
Epoch 10/50
286/286 - 15s - loss: 3.0359 - accuracy1000: 0.4800 - val_loss: 3.8209 - val_accuracy1000: 0.3282 - 15s/epoch - 53ms/step
Epoch 11/50
286/286 - 15s - loss: 3.0078 - accuracy1000: 0.4922 - val_loss: 3.7976 - val_accuracy1000: 0.3248 - 15s/epoch - 53ms/step
testing model: results/XRAY/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2295507
{'0': {'precision': 0.23105841526894158, 'recall': 0.019196348129016758, 'f1-score': 0.03544769911602578, 'support': 83245}, '1': {'precision': 0.2966072568370403, 'recall': 0.527065598085528, 'f1-score': 0.3795960502692998, 'support': 80231}, '2': {'precision': 0.39035340901802323, 'recall': 0.4396723768929987, 'f1-score': 0.41354766101119067, 'support': 110737}, 'accuracy': 0.33759522706800915, 'macro avg': {'precision': 0.3060063603746684, 'recall': 0.32864477436918116, 'f1-score': 0.2761971367988388, 'support': 274213}, 'weighted avg': {'precision': 0.31456612216337104, 'recall': 0.33759522706800915, 'f1-score': 0.2888310975754832, 'support': 274213}}
[[ 1598 41045 40602]
 [ 2506 42287 35438]
 [ 2812 59237 48688]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1981717
{'0': {'precision': 0.3632299525006985, 'recall': 0.05348033569195327, 'f1-score': 0.09323340624663823, 'support': 24308}, '1': {'precision': 0.3553779716855133, 'recall': 0.6285433070866142, 'f1-score': 0.4540412945793755, 'support': 25400}, '2': {'precision': 0.3408877838014103, 'recall': 0.35849622770919065, 'f1-score': 0.34947034119638115, 'support': 23328}, 'accuracy': 0.3508954488197601, 'macro avg': {'precision': 0.35316523599587407, 'recall': 0.34683995682925267, 'f1-score': 0.29891501400746495, 'support': 73036}, 'weighted avg': {'precision': 0.35336305913136423, 'recall': 0.3508954488197601, 'f1-score': 0.3005560359382852, 'support': 73036}}
[[ 1300 15009  7999]
 [ 1264 15965  8171]
 [ 1015 13950  8363]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2483591
{'0': {'precision': 0.23350923482849603, 'recall': 0.017840943453280918, 'f1-score': 0.033149171270718224, 'support': 9921}, '1': {'precision': 0.3005151688609044, 'recall': 0.4733994589720469, 'f1-score': 0.3676470588235294, 'support': 8872}, '2': {'precision': 0.3533665008291874, 'recall': 0.4835693536673929, 'f1-score': 0.40834004062703616, 'support': 11016}, 'accuracy': 0.3255392666644302, 'macro avg': {'precision': 0.2957969681728626, 'recall': 0.32493658536424025, 'f1-score': 0.2697120902404279, 'support': 29809}, 'weighted avg': {'precision': 0.2977456831829911, 'recall': 0.3255392666644302, 'f1-score': 0.27135803017902577, 'support': 29809}}
[[ 177 4414 5330]
 [ 254 4200 4418]
 [ 327 5362 5327]]
training model: results/XRAY/W2/deepOF_L2/h10
Epoch 1/50
286/286 - 13s - loss: 3.2597 - accuracy10: 0.3879 - val_loss: 3.2035 - val_accuracy10: 0.4381 - 13s/epoch - 45ms/step
Epoch 2/50
286/286 - 10s - loss: 3.1445 - accuracy10: 0.4317 - val_loss: 3.1441 - val_accuracy10: 0.4576 - 10s/epoch - 35ms/step
Epoch 3/50
286/286 - 10s - loss: 3.0901 - accuracy10: 0.4556 - val_loss: 3.1044 - val_accuracy10: 0.4755 - 10s/epoch - 34ms/step
Epoch 4/50
286/286 - 10s - loss: 3.0533 - accuracy10: 0.4754 - val_loss: 3.0752 - val_accuracy10: 0.4808 - 10s/epoch - 35ms/step
Epoch 5/50
286/286 - 10s - loss: 3.0274 - accuracy10: 0.4863 - val_loss: 3.0552 - val_accuracy10: 0.4864 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 10s - loss: 2.9963 - accuracy10: 0.4963 - val_loss: 3.0377 - val_accuracy10: 0.4913 - 10s/epoch - 35ms/step
Epoch 7/50
286/286 - 10s - loss: 2.9759 - accuracy10: 0.5049 - val_loss: 3.0208 - val_accuracy10: 0.4942 - 10s/epoch - 34ms/step
Epoch 8/50
286/286 - 10s - loss: 2.9550 - accuracy10: 0.5119 - val_loss: 3.0156 - val_accuracy10: 0.4894 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 10s - loss: 2.9394 - accuracy10: 0.5158 - val_loss: 3.0038 - val_accuracy10: 0.4970 - 10s/epoch - 34ms/step
Epoch 10/50
286/286 - 10s - loss: 2.9243 - accuracy10: 0.5193 - val_loss: 3.0037 - val_accuracy10: 0.4933 - 10s/epoch - 34ms/step
Epoch 11/50
286/286 - 10s - loss: 2.9081 - accuracy10: 0.5250 - val_loss: 3.0034 - val_accuracy10: 0.4973 - 10s/epoch - 34ms/step
Epoch 12/50
286/286 - 10s - loss: 2.8988 - accuracy10: 0.5293 - val_loss: 2.9942 - val_accuracy10: 0.4989 - 10s/epoch - 34ms/step
Epoch 13/50
286/286 - 10s - loss: 2.8880 - accuracy10: 0.5311 - val_loss: 2.9888 - val_accuracy10: 0.4997 - 10s/epoch - 34ms/step
Epoch 14/50
286/286 - 10s - loss: 2.8783 - accuracy10: 0.5339 - val_loss: 2.9881 - val_accuracy10: 0.5007 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 9s - loss: 2.8666 - accuracy10: 0.5366 - val_loss: 2.9950 - val_accuracy10: 0.4976 - 9s/epoch - 33ms/step
Epoch 16/50
286/286 - 9s - loss: 2.8587 - accuracy10: 0.5370 - val_loss: 2.9888 - val_accuracy10: 0.5028 - 9s/epoch - 33ms/step
Epoch 17/50
286/286 - 10s - loss: 2.8520 - accuracy10: 0.5391 - val_loss: 2.9859 - val_accuracy10: 0.5040 - 10s/epoch - 34ms/step
Epoch 18/50
286/286 - 9s - loss: 2.8390 - accuracy10: 0.5417 - val_loss: 2.9855 - val_accuracy10: 0.5016 - 9s/epoch - 32ms/step
Epoch 19/50
286/286 - 9s - loss: 2.8309 - accuracy10: 0.5453 - val_loss: 2.9883 - val_accuracy10: 0.4993 - 9s/epoch - 32ms/step
Epoch 20/50
286/286 - 9s - loss: 2.8217 - accuracy10: 0.5483 - val_loss: 2.9907 - val_accuracy10: 0.5013 - 9s/epoch - 32ms/step
Epoch 21/50
286/286 - 9s - loss: 2.8113 - accuracy10: 0.5504 - val_loss: 3.0010 - val_accuracy10: 0.4968 - 9s/epoch - 32ms/step
Epoch 22/50
286/286 - 9s - loss: 2.8040 - accuracy10: 0.5524 - val_loss: 2.9952 - val_accuracy10: 0.4959 - 9s/epoch - 32ms/step
Epoch 23/50
286/286 - 9s - loss: 2.7948 - accuracy10: 0.5535 - val_loss: 3.0112 - val_accuracy10: 0.5007 - 9s/epoch - 33ms/step
Epoch 24/50
286/286 - 10s - loss: 2.7894 - accuracy10: 0.5545 - val_loss: 3.0164 - val_accuracy10: 0.4938 - 10s/epoch - 33ms/step
Epoch 25/50
286/286 - 10s - loss: 2.7790 - accuracy10: 0.5587 - val_loss: 3.0264 - val_accuracy10: 0.4906 - 10s/epoch - 34ms/step
Epoch 26/50
286/286 - 10s - loss: 2.7725 - accuracy10: 0.5598 - val_loss: 3.0284 - val_accuracy10: 0.4950 - 10s/epoch - 34ms/step
Epoch 27/50
286/286 - 10s - loss: 2.7603 - accuracy10: 0.5616 - val_loss: 3.0285 - val_accuracy10: 0.4927 - 10s/epoch - 34ms/step
Epoch 28/50
286/286 - 10s - loss: 2.7530 - accuracy10: 0.5651 - val_loss: 3.0477 - val_accuracy10: 0.4901 - 10s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h10
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0069988
{'0': {'precision': 0.5067338625827207, 'recall': 0.4485614977315301, 'f1-score': 0.47587648761659695, 'support': 92353}, '1': {'precision': 0.509010100031487, 'recall': 0.49571288728490726, 'f1-score': 0.5022735013115206, 'support': 84789}, '2': {'precision': 0.47873647424988397, 'recall': 0.5419508375744339, 'f1-score': 0.5083861241175363, 'support': 97066}, 'accuracy': 0.4961999649900805, 'macro avg': {'precision': 0.4981601456213638, 'recall': 0.4954084075302904, 'f1-score': 0.4955120376818846, 'support': 274208}, 'weighted avg': {'precision': 0.4975270028307379, 'recall': 0.4961999649900805, 'f1-score': 0.4955467990983154, 'support': 274208}}
[[41426 19537 31390]
 [16870 42031 25888]
 [23455 21006 52605]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9567602
{'0': {'precision': 0.5312600783229671, 'recall': 0.5000216816269892, 'f1-score': 0.5151677612473753, 'support': 23061}, '1': {'precision': 0.5785703398872123, 'recall': 0.5556002780928684, 'f1-score': 0.5668527056539675, 'support': 27329}, '2': {'precision': 0.48485090097273165, 'recall': 0.5371196396237248, 'f1-score': 0.5096486265635803, 'support': 22643}, 'accuracy': 0.5323210055728232, 'macro avg': {'precision': 0.5315604397276371, 'recall': 0.5309138664478609, 'f1-score': 0.5305563644883078, 'support': 73033}, 'weighted avg': {'precision': 0.5345750063082323, 'recall': 0.5323210055728232, 'f1-score': 0.532797162737696, 'support': 73033}}
[[11531  5401  6129]
 [ 5352 15184  6793]
 [ 4822  5659 12162]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99560314
{'0': {'precision': 0.4807404852247902, 'recall': 0.45356910392709915, 'f1-score': 0.4667596985766118, 'support': 9218}, '1': {'precision': 0.5730582755014735, 'recall': 0.527522534348473, 'f1-score': 0.5493484006197028, 'support': 11427}, '2': {'precision': 0.4474653072783914, 'recall': 0.5172413793103449, 'f1-score': 0.4798299336943868, 'support': 9164}, 'accuracy': 0.5014928377335705, 'macro avg': {'precision': 0.5004213560015517, 'recall': 0.4994443391953056, 'f1-score': 0.49864601096356714, 'support': 29809}, 'weighted avg': {'precision': 0.505900056454649, 'recall': 0.5014928377335705, 'f1-score': 0.5024374043992054, 'support': 29809}}
[[4181 2242 2795]
 [2341 6028 3058]
 [2175 2249 4740]]
training model: results/XRAY/W2/deepOF_L2/h20
Epoch 1/50
286/286 - 12s - loss: 3.2877 - accuracy20: 0.3727 - val_loss: 3.2606 - val_accuracy20: 0.3932 - 12s/epoch - 42ms/step
Epoch 2/50
286/286 - 10s - loss: 3.2019 - accuracy20: 0.4136 - val_loss: 3.2239 - val_accuracy20: 0.4135 - 10s/epoch - 34ms/step
Epoch 3/50
286/286 - 10s - loss: 3.1620 - accuracy20: 0.4298 - val_loss: 3.1970 - val_accuracy20: 0.4251 - 10s/epoch - 36ms/step
Epoch 4/50
286/286 - 10s - loss: 3.1330 - accuracy20: 0.4446 - val_loss: 3.1677 - val_accuracy20: 0.4356 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.1117 - accuracy20: 0.4546 - val_loss: 3.1630 - val_accuracy20: 0.4397 - 10s/epoch - 33ms/step
Epoch 6/50
286/286 - 9s - loss: 3.0908 - accuracy20: 0.4617 - val_loss: 3.1478 - val_accuracy20: 0.4443 - 9s/epoch - 33ms/step
Epoch 7/50
286/286 - 9s - loss: 3.0726 - accuracy20: 0.4700 - val_loss: 3.1385 - val_accuracy20: 0.4511 - 9s/epoch - 33ms/step
Epoch 8/50
286/286 - 10s - loss: 3.0573 - accuracy20: 0.4748 - val_loss: 3.1333 - val_accuracy20: 0.4552 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 10s - loss: 3.0427 - accuracy20: 0.4798 - val_loss: 3.1238 - val_accuracy20: 0.4552 - 10s/epoch - 34ms/step
Epoch 10/50
286/286 - 9s - loss: 3.0292 - accuracy20: 0.4848 - val_loss: 3.1194 - val_accuracy20: 0.4589 - 9s/epoch - 33ms/step
Epoch 11/50
286/286 - 10s - loss: 3.0163 - accuracy20: 0.4906 - val_loss: 3.1208 - val_accuracy20: 0.4556 - 10s/epoch - 34ms/step
Epoch 12/50
286/286 - 10s - loss: 3.0058 - accuracy20: 0.4951 - val_loss: 3.1107 - val_accuracy20: 0.4622 - 10s/epoch - 33ms/step
Epoch 13/50
286/286 - 10s - loss: 2.9954 - accuracy20: 0.4979 - val_loss: 3.1030 - val_accuracy20: 0.4662 - 10s/epoch - 34ms/step
Epoch 14/50
286/286 - 10s - loss: 2.9833 - accuracy20: 0.5000 - val_loss: 3.1019 - val_accuracy20: 0.4631 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 10s - loss: 2.9723 - accuracy20: 0.5034 - val_loss: 3.0991 - val_accuracy20: 0.4671 - 10s/epoch - 34ms/step
Epoch 16/50
286/286 - 9s - loss: 2.9630 - accuracy20: 0.5076 - val_loss: 3.1050 - val_accuracy20: 0.4634 - 9s/epoch - 33ms/step
Epoch 17/50
286/286 - 9s - loss: 2.9552 - accuracy20: 0.5109 - val_loss: 3.1054 - val_accuracy20: 0.4654 - 9s/epoch - 33ms/step
Epoch 18/50
286/286 - 9s - loss: 2.9429 - accuracy20: 0.5123 - val_loss: 3.1131 - val_accuracy20: 0.4642 - 9s/epoch - 33ms/step
Epoch 19/50
286/286 - 9s - loss: 2.9386 - accuracy20: 0.5148 - val_loss: 3.1168 - val_accuracy20: 0.4635 - 9s/epoch - 33ms/step
Epoch 20/50
286/286 - 10s - loss: 2.9269 - accuracy20: 0.5181 - val_loss: 3.1150 - val_accuracy20: 0.4658 - 10s/epoch - 33ms/step
Epoch 21/50
286/286 - 10s - loss: 2.9176 - accuracy20: 0.5215 - val_loss: 3.1239 - val_accuracy20: 0.4624 - 10s/epoch - 34ms/step
Epoch 22/50
286/286 - 10s - loss: 2.9138 - accuracy20: 0.5221 - val_loss: 3.1356 - val_accuracy20: 0.4641 - 10s/epoch - 33ms/step
Epoch 23/50
286/286 - 10s - loss: 2.9032 - accuracy20: 0.5258 - val_loss: 3.1309 - val_accuracy20: 0.4609 - 10s/epoch - 34ms/step
Epoch 24/50
286/286 - 9s - loss: 2.8915 - accuracy20: 0.5276 - val_loss: 3.1382 - val_accuracy20: 0.4640 - 9s/epoch - 33ms/step
Epoch 25/50
286/286 - 10s - loss: 2.8845 - accuracy20: 0.5298 - val_loss: 3.1464 - val_accuracy20: 0.4648 - 10s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h20
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.04413
{'0': {'precision': 0.5085549533652635, 'recall': 0.3391862640018494, 'f1-score': 0.4069516761431688, 'support': 95166}, '1': {'precision': 0.41936786942518695, 'recall': 0.4934167426684993, 'f1-score': 0.453388730199948, 'support': 77849}, '2': {'precision': 0.4606306812935933, 'recall': 0.542330003063453, 'f1-score': 0.49815280437880666, 'support': 101193}, 'accuracy': 0.4579406873614191, 'macro avg': {'precision': 0.46285116802801457, 'recall': 0.45831100324460056, 'f1-score': 0.4528310702406411, 'support': 274208}, 'weighted avg': {'precision': 0.46554845406035794, 'recall': 0.4579406873614191, 'f1-score': 0.4537920089956571, 'support': 274208}}
[[32279 25205 37682]
 [12858 38412 26579]
 [18335 27978 54880]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0040147
{'0': {'precision': 0.5476479777816351, 'recall': 0.38900990505938926, 'f1-score': 0.45489498726390154, 'support': 24331}, '1': {'precision': 0.484621778886118, 'recall': 0.5661339267651224, 'f1-score': 0.5222162091552055, 'support': 24715}, '2': {'precision': 0.46651536572661656, 'recall': 0.522741484971026, 'f1-score': 0.49303057111963045, 'support': 23987}, 'accuracy': 0.49287308476989855, 'macro avg': {'precision': 0.4995950407981233, 'recall': 0.4926284389318459, 'f1-score': 0.4900472558462458, 'support': 73033}, 'weighted avg': {'precision': 0.49967212479645806, 'recall': 0.49287308476989855, 'f1-score': 0.4902023448829361, 'support': 73033}}
[[ 9465  7272  7594]
 [ 3978 13992  6745]
 [ 3840  7608 12539]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0332193
{'0': {'precision': 0.49314469078179696, 'recall': 0.34698275862068967, 'f1-score': 0.40734939759036143, 'support': 9744}, '1': {'precision': 0.4742528535331533, 'recall': 0.5283953014270459, 'f1-score': 0.4998622463036092, 'support': 10301}, '2': {'precision': 0.4349076333217149, 'recall': 0.5111634575993446, 'f1-score': 0.4699623352165725, 'support': 9764}, 'accuracy': 0.4634506357140461, 'macro avg': {'precision': 0.46743505921222167, 'recall': 0.46218050588236004, 'f1-score': 0.4590579930368477, 'support': 29809}, 'weighted avg': {'precision': 0.46754063011090835, 'recall': 0.4634506357140461, 'f1-score': 0.45982776243243895, 'support': 29809}}
[[3381 2973 3390]
 [1763 5443 3095]
 [1712 3061 4991]]
training model: results/XRAY/W2/deepOF_L2/h30
Epoch 1/50
286/286 - 12s - loss: 3.3026 - accuracy30: 0.3634 - val_loss: 3.2788 - val_accuracy30: 0.3675 - 12s/epoch - 42ms/step
Epoch 2/50
286/286 - 10s - loss: 3.2340 - accuracy30: 0.4001 - val_loss: 3.2512 - val_accuracy30: 0.3867 - 10s/epoch - 34ms/step
Epoch 3/50
286/286 - 10s - loss: 3.2039 - accuracy30: 0.4140 - val_loss: 3.2319 - val_accuracy30: 0.3967 - 10s/epoch - 34ms/step
Epoch 4/50
286/286 - 10s - loss: 3.1837 - accuracy30: 0.4253 - val_loss: 3.2207 - val_accuracy30: 0.4029 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.1672 - accuracy30: 0.4320 - val_loss: 3.2133 - val_accuracy30: 0.4079 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 10s - loss: 3.1533 - accuracy30: 0.4388 - val_loss: 3.2099 - val_accuracy30: 0.4124 - 10s/epoch - 35ms/step
Epoch 7/50
286/286 - 10s - loss: 3.1396 - accuracy30: 0.4445 - val_loss: 3.2060 - val_accuracy30: 0.4165 - 10s/epoch - 35ms/step
Epoch 8/50
286/286 - 10s - loss: 3.1291 - accuracy30: 0.4496 - val_loss: 3.2018 - val_accuracy30: 0.4177 - 10s/epoch - 33ms/step
Epoch 9/50
286/286 - 10s - loss: 3.1177 - accuracy30: 0.4553 - val_loss: 3.1949 - val_accuracy30: 0.4220 - 10s/epoch - 34ms/step
Epoch 10/50
286/286 - 10s - loss: 3.1076 - accuracy30: 0.4579 - val_loss: 3.1926 - val_accuracy30: 0.4225 - 10s/epoch - 34ms/step
Epoch 11/50
286/286 - 10s - loss: 3.0963 - accuracy30: 0.4639 - val_loss: 3.1884 - val_accuracy30: 0.4292 - 10s/epoch - 34ms/step
Epoch 12/50
286/286 - 9s - loss: 3.0860 - accuracy30: 0.4685 - val_loss: 3.1853 - val_accuracy30: 0.4303 - 9s/epoch - 33ms/step
Epoch 13/50
286/286 - 9s - loss: 3.0774 - accuracy30: 0.4714 - val_loss: 3.1814 - val_accuracy30: 0.4308 - 9s/epoch - 33ms/step
Epoch 14/50
286/286 - 10s - loss: 3.0710 - accuracy30: 0.4731 - val_loss: 3.1892 - val_accuracy30: 0.4294 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 9s - loss: 3.0617 - accuracy30: 0.4791 - val_loss: 3.1953 - val_accuracy30: 0.4301 - 9s/epoch - 33ms/step
Epoch 16/50
286/286 - 9s - loss: 3.0545 - accuracy30: 0.4793 - val_loss: 3.1915 - val_accuracy30: 0.4294 - 9s/epoch - 32ms/step
Epoch 17/50
286/286 - 9s - loss: 3.0443 - accuracy30: 0.4840 - val_loss: 3.1838 - val_accuracy30: 0.4331 - 9s/epoch - 33ms/step
Epoch 18/50
286/286 - 9s - loss: 3.0350 - accuracy30: 0.4884 - val_loss: 3.2011 - val_accuracy30: 0.4303 - 9s/epoch - 32ms/step
Epoch 19/50
286/286 - 10s - loss: 3.0253 - accuracy30: 0.4921 - val_loss: 3.2024 - val_accuracy30: 0.4296 - 10s/epoch - 33ms/step
Epoch 20/50
286/286 - 10s - loss: 3.0195 - accuracy30: 0.4906 - val_loss: 3.1924 - val_accuracy30: 0.4344 - 10s/epoch - 34ms/step
Epoch 21/50
286/286 - 10s - loss: 3.0112 - accuracy30: 0.4954 - val_loss: 3.2054 - val_accuracy30: 0.4318 - 10s/epoch - 33ms/step
Epoch 22/50
286/286 - 10s - loss: 3.0024 - accuracy30: 0.4985 - val_loss: 3.2104 - val_accuracy30: 0.4339 - 10s/epoch - 34ms/step
Epoch 23/50
286/286 - 9s - loss: 2.9938 - accuracy30: 0.5017 - val_loss: 3.2113 - val_accuracy30: 0.4327 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h30
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.066388
{'0': {'precision': 0.47945661583538657, 'recall': 0.3041214796354766, 'f1-score': 0.37217236232530193, 'support': 94699}, '1': {'precision': 0.37538813022483, 'recall': 0.46801403472429015, 'f1-score': 0.4166148030334463, 'support': 77237}, '2': {'precision': 0.45385888243031103, 'recall': 0.5229681633291614, 'f1-score': 0.4859688256699846, 'support': 102272}, 'accuracy': 0.43190935348348697, 'macro avg': {'precision': 0.4362345428301759, 'recall': 0.4317012258963094, 'f1-score': 0.42491866367624426, 'support': 274208}, 'weighted avg': {'precision': 0.4405960829045223, 'recall': 0.43190935348348697, 'f1-score': 0.4271335330138389, 'support': 274208}}
[[28800 29075 36824]
 [13553 36148 27536]
 [17715 31072 53485]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.038641
{'0': {'precision': 0.5251144455747712, 'recall': 0.333319880539188, 'f1-score': 0.40779143830543624, 'support': 24778}, '1': {'precision': 0.4198443066367595, 'recall': 0.5380680617205664, 'f1-score': 0.4716607066758074, 'support': 23655}, '2': {'precision': 0.4587795027603839, 'recall': 0.5033333333333333, 'f1-score': 0.4800248114908216, 'support': 24600}, 'accuracy': 0.45690304382950175, 'macro avg': {'precision': 0.4679127516573048, 'recall': 0.45824042519769587, 'f1-score': 0.4531589854906884, 'support': 73033}, 'weighted avg': {'precision': 0.4686741414682358, 'recall': 0.45690304382950175, 'f1-score': 0.4528090128766795, 'support': 73033}}
[[ 8259  8965  7554]
 [ 3874 12728  7053]
 [ 3595  8623 12382]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0627414
{'0': {'precision': 0.47668978867559286, 'recall': 0.29960458278414276, 'f1-score': 0.3679491968621591, 'support': 9863}, '1': {'precision': 0.4163945133899412, 'recall': 0.5129752564876282, 'f1-score': 0.4596665164488508, 'support': 9942}, '2': {'precision': 0.4260693539869741, 'recall': 0.48390643742503, 'f1-score': 0.453149864270336, 'support': 10004}, 'accuracy': 0.4326210204971653, 'macro avg': {'precision': 0.4397178853508361, 'recall': 0.4321620922322669, 'f1-score': 0.426921859193782, 'support': 29809}, 'weighted avg': {'precision': 0.4395915144793806, 'recall': 0.4326210204971653, 'f1-score': 0.4271327007731353, 'support': 29809}}
[[2955 3600 3308]
 [1629 5100 3213]
 [1615 3548 4841]]
training model: results/XRAY/W2/deepOF_L2/h50
Epoch 1/50
286/286 - 12s - loss: 3.3162 - accuracy50: 0.3568 - val_loss: 3.3206 - val_accuracy50: 0.3489 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 10s - loss: 3.2702 - accuracy50: 0.3809 - val_loss: 3.2960 - val_accuracy50: 0.3617 - 10s/epoch - 34ms/step
Epoch 3/50
286/286 - 10s - loss: 3.2484 - accuracy50: 0.3933 - val_loss: 3.2808 - val_accuracy50: 0.3652 - 10s/epoch - 33ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2304 - accuracy50: 0.4025 - val_loss: 3.2769 - val_accuracy50: 0.3660 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.2190 - accuracy50: 0.4056 - val_loss: 3.2699 - val_accuracy50: 0.3710 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 10s - loss: 3.2091 - accuracy50: 0.4122 - val_loss: 3.2639 - val_accuracy50: 0.3718 - 10s/epoch - 33ms/step
Epoch 7/50
286/286 - 10s - loss: 3.2006 - accuracy50: 0.4172 - val_loss: 3.2728 - val_accuracy50: 0.3695 - 10s/epoch - 33ms/step
Epoch 8/50
286/286 - 9s - loss: 3.1918 - accuracy50: 0.4201 - val_loss: 3.2776 - val_accuracy50: 0.3714 - 9s/epoch - 33ms/step
Epoch 9/50
286/286 - 9s - loss: 3.1870 - accuracy50: 0.4240 - val_loss: 3.2802 - val_accuracy50: 0.3699 - 9s/epoch - 33ms/step
Epoch 10/50
286/286 - 10s - loss: 3.1775 - accuracy50: 0.4288 - val_loss: 3.2812 - val_accuracy50: 0.3699 - 10s/epoch - 34ms/step
Epoch 11/50
286/286 - 10s - loss: 3.1711 - accuracy50: 0.4299 - val_loss: 3.2836 - val_accuracy50: 0.3710 - 10s/epoch - 34ms/step
Epoch 12/50
286/286 - 9s - loss: 3.1662 - accuracy50: 0.4333 - val_loss: 3.2949 - val_accuracy50: 0.3709 - 9s/epoch - 33ms/step
Epoch 13/50
286/286 - 9s - loss: 3.1584 - accuracy50: 0.4360 - val_loss: 3.2972 - val_accuracy50: 0.3716 - 9s/epoch - 33ms/step
Epoch 14/50
286/286 - 10s - loss: 3.1509 - accuracy50: 0.4387 - val_loss: 3.3012 - val_accuracy50: 0.3692 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 9s - loss: 3.1435 - accuracy50: 0.4426 - val_loss: 3.3026 - val_accuracy50: 0.3761 - 9s/epoch - 33ms/step
Epoch 16/50
286/286 - 9s - loss: 3.1366 - accuracy50: 0.4463 - val_loss: 3.3052 - val_accuracy50: 0.3766 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h50
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1004386
{'0': {'precision': 0.43551812346155705, 'recall': 0.19550851497161675, 'f1-score': 0.2698697531141118, 'support': 92308}, '1': {'precision': 0.30252645001892847, 'recall': 0.7553040666583758, 'f1-score': 0.43201525077712094, 'support': 80410}, '2': {'precision': 0.46879490223027426, 'recall': 0.1478766380924229, 'f1-score': 0.22483221476510068, 'support': 101490}, 'accuracy': 0.3420359726922628, 'macro avg': {'precision': 0.4022798252369199, 'recall': 0.3662297399074719, 'f1-score': 0.30890573955211115, 'support': 274208}, 'weighted avg': {'precision': 0.4088354585346233, 'recall': 0.3420359726922628, 'f1-score': 0.300748719811077, 'support': 274208}}
[[18047 65404  8857]
 [11527 60734  8149]
 [11864 74618 15008]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0817144
{'0': {'precision': 0.4684662775616083, 'recall': 0.2360702614379085, 'f1-score': 0.3139395914819643, 'support': 24480}, '1': {'precision': 0.3471164309031556, 'recall': 0.7608043093877216, 'f1-score': 0.4767266590226872, 'support': 24319}, '2': {'precision': 0.4566599053414469, 'recall': 0.13934967401171908, 'f1-score': 0.2135382086060261, 'support': 24234}, 'accuracy': 0.37870551668423863, 'macro avg': {'precision': 0.42408087126873695, 'recall': 0.37874141494578306, 'f1-score': 0.33473481970355917, 'support': 73033}, 'weighted avg': {'precision': 0.4241408007871323, 'recall': 0.37870551668423863, 'f1-score': 0.3348300325552785, 'support': 73033}}
[[ 5779 16846  1855]
 [ 3654 18502  2163]
 [ 2903 17954  3377]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0888232
{'0': {'precision': 0.4305887464696937, 'recall': 0.20780037743761795, 'f1-score': 0.28031963793225373, 'support': 9538}, '1': {'precision': 0.3531628532974428, 'recall': 0.7697271927251393, 'f1-score': 0.4841775071501061, 'support': 10227}, '2': {'precision': 0.43175582990397804, 'recall': 0.1253484667463162, 'f1-score': 0.19429012345679011, 'support': 10044}, 'accuracy': 0.37280687040826593, 'macro avg': {'precision': 0.40516914322370484, 'recall': 0.36762534563635785, 'f1-score': 0.31959575617971664, 'support': 29809}, 'weighted avg': {'precision': 0.4044183810277581, 'recall': 0.37280687040826593, 'f1-score': 0.32127283948545643, 'support': 29809}}
[[1982 6815  741]
 [1439 7872  916]
 [1182 7603 1259]]
training model: results/XRAY/W2/deepOF_L2/h100
Epoch 1/50
286/286 - 13s - loss: 3.3257 - accuracy100: 0.3474 - val_loss: 3.3044 - val_accuracy100: 0.3539 - 13s/epoch - 45ms/step
Epoch 2/50
286/286 - 10s - loss: 3.2884 - accuracy100: 0.3682 - val_loss: 3.2888 - val_accuracy100: 0.3605 - 10s/epoch - 36ms/step
Epoch 3/50
286/286 - 10s - loss: 3.2728 - accuracy100: 0.3797 - val_loss: 3.2806 - val_accuracy100: 0.3659 - 10s/epoch - 34ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2644 - accuracy100: 0.3821 - val_loss: 3.2737 - val_accuracy100: 0.3713 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.2542 - accuracy100: 0.3889 - val_loss: 3.2714 - val_accuracy100: 0.3720 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 10s - loss: 3.2462 - accuracy100: 0.3937 - val_loss: 3.2662 - val_accuracy100: 0.3755 - 10s/epoch - 34ms/step
Epoch 7/50
286/286 - 10s - loss: 3.2396 - accuracy100: 0.3980 - val_loss: 3.2651 - val_accuracy100: 0.3770 - 10s/epoch - 34ms/step
Epoch 8/50
286/286 - 10s - loss: 3.2363 - accuracy100: 0.3998 - val_loss: 3.2674 - val_accuracy100: 0.3753 - 10s/epoch - 33ms/step
Epoch 9/50
286/286 - 10s - loss: 3.2292 - accuracy100: 0.4057 - val_loss: 3.2633 - val_accuracy100: 0.3798 - 10s/epoch - 34ms/step
Epoch 10/50
286/286 - 10s - loss: 3.2232 - accuracy100: 0.4089 - val_loss: 3.2659 - val_accuracy100: 0.3796 - 10s/epoch - 33ms/step
Epoch 11/50
286/286 - 10s - loss: 3.2179 - accuracy100: 0.4117 - val_loss: 3.2666 - val_accuracy100: 0.3766 - 10s/epoch - 33ms/step
Epoch 12/50
286/286 - 10s - loss: 3.2137 - accuracy100: 0.4139 - val_loss: 3.2704 - val_accuracy100: 0.3804 - 10s/epoch - 34ms/step
Epoch 13/50
286/286 - 10s - loss: 3.2078 - accuracy100: 0.4135 - val_loss: 3.2744 - val_accuracy100: 0.3777 - 10s/epoch - 34ms/step
Epoch 14/50
286/286 - 10s - loss: 3.2019 - accuracy100: 0.4174 - val_loss: 3.2726 - val_accuracy100: 0.3800 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 10s - loss: 3.1949 - accuracy100: 0.4216 - val_loss: 3.2770 - val_accuracy100: 0.3771 - 10s/epoch - 34ms/step
Epoch 16/50
286/286 - 10s - loss: 3.1919 - accuracy100: 0.4215 - val_loss: 3.2752 - val_accuracy100: 0.3803 - 10s/epoch - 33ms/step
Epoch 17/50
286/286 - 10s - loss: 3.1843 - accuracy100: 0.4271 - val_loss: 3.2789 - val_accuracy100: 0.3768 - 10s/epoch - 33ms/step
Epoch 18/50
286/286 - 9s - loss: 3.1775 - accuracy100: 0.4295 - val_loss: 3.2780 - val_accuracy100: 0.3816 - 9s/epoch - 33ms/step
Epoch 19/50
286/286 - 9s - loss: 3.1692 - accuracy100: 0.4337 - val_loss: 3.2946 - val_accuracy100: 0.3726 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h100
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904092
{'0': {'precision': 0.3909503902255931, 'recall': 0.33102102990652155, 'f1-score': 0.35849840369346164, 'support': 91251}, '1': {'precision': 0.3251010554116307, 'recall': 0.40121168391719747, 'f1-score': 0.3591685366980906, 'support': 80384}, '2': {'precision': 0.42837265453950196, 'recall': 0.4081970889025377, 'f1-score': 0.4180415845044056, 'support': 102573}, 'accuracy': 0.38046665305169797, 'macro avg': {'precision': 0.38147470005890854, 'recall': 0.3801432675754189, 'f1-score': 0.37856950829865266, 'support': 274208}, 'weighted avg': {'precision': 0.3856452240298038, 'recall': 0.38046665305169797, 'f1-score': 0.380968173564381, 'support': 274208}}
[[30206 31571 29474]
 [21735 32251 26398]
 [25322 35381 41870]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0765707
{'0': {'precision': 0.4240469208211144, 'recall': 0.3800800679364309, 'f1-score': 0.4008615174649209, 'support': 24729}, '1': {'precision': 0.37485329193957523, 'recall': 0.4106594773952717, 'f1-score': 0.3919403044158107, 'support': 24110}, '2': {'precision': 0.4107953383766101, 'recall': 0.4152269157642391, 'f1-score': 0.4129992394499373, 'support': 24194}, 'accuracy': 0.4018183560856051, 'macro avg': {'precision': 0.4032318503790999, 'recall': 0.40198882036531386, 'f1-score': 0.401933687110223, 'support': 73033}, 'weighted avg': {'precision': 0.4034169702782605, 'recall': 0.4018183560856051, 'f1-score': 0.40193732701801943, 'support': 73033}}
[[ 9399  8442  6888]
 [ 6688  9901  7521]
 [ 6078  8070 10046]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883336
{'0': {'precision': 0.3764025448235975, 'recall': 0.34180672268907564, 'f1-score': 0.35827140104596755, 'support': 9520}, '1': {'precision': 0.3741051701281485, 'recall': 0.4076071256620125, 'f1-score': 0.39013824884792625, 'support': 10385}, '2': {'precision': 0.38663823738450603, 'recall': 0.38449111470113084, 'f1-score': 0.3855616868323799, 'support': 9904}, 'accuracy': 0.3789124090039921, 'macro avg': {'precision': 0.37904865077875066, 'recall': 0.37796832101740635, 'f1-score': 0.3779904455754246, 'support': 29809}, 'weighted avg': {'precision': 0.3790029696252011, 'recall': 0.3789124090039921, 'f1-score': 0.3784404843715393, 'support': 29809}}
[[3254 3504 2762]
 [2873 4233 3279]
 [2518 3578 3808]]
training model: results/XRAY/W2/deepOF_L2/h200
Epoch 1/50
286/286 - 12s - loss: 3.3245 - accuracy200: 0.3570 - val_loss: 3.3871 - val_accuracy200: 0.3378 - 12s/epoch - 40ms/step
Epoch 2/50
286/286 - 10s - loss: 3.3070 - accuracy200: 0.3598 - val_loss: 3.3836 - val_accuracy200: 0.3379 - 10s/epoch - 35ms/step
Epoch 3/50
286/286 - 10s - loss: 3.2935 - accuracy200: 0.3663 - val_loss: 3.3752 - val_accuracy200: 0.3404 - 10s/epoch - 34ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2841 - accuracy200: 0.3712 - val_loss: 3.3593 - val_accuracy200: 0.3391 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.2747 - accuracy200: 0.3743 - val_loss: 3.3532 - val_accuracy200: 0.3433 - 10s/epoch - 33ms/step
Epoch 6/50
286/286 - 10s - loss: 3.2693 - accuracy200: 0.3779 - val_loss: 3.3521 - val_accuracy200: 0.3418 - 10s/epoch - 33ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2637 - accuracy200: 0.3813 - val_loss: 3.3574 - val_accuracy200: 0.3418 - 9s/epoch - 33ms/step
Epoch 8/50
286/286 - 10s - loss: 3.2596 - accuracy200: 0.3870 - val_loss: 3.3490 - val_accuracy200: 0.3460 - 10s/epoch - 33ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2552 - accuracy200: 0.3878 - val_loss: 3.3545 - val_accuracy200: 0.3451 - 9s/epoch - 33ms/step
Epoch 10/50
286/286 - 10s - loss: 3.2497 - accuracy200: 0.3906 - val_loss: 3.3625 - val_accuracy200: 0.3471 - 10s/epoch - 33ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2444 - accuracy200: 0.3931 - val_loss: 3.3704 - val_accuracy200: 0.3466 - 9s/epoch - 33ms/step
Epoch 12/50
286/286 - 10s - loss: 3.2408 - accuracy200: 0.3965 - val_loss: 3.3765 - val_accuracy200: 0.3481 - 10s/epoch - 34ms/step
Epoch 13/50
286/286 - 10s - loss: 3.2343 - accuracy200: 0.4019 - val_loss: 3.3754 - val_accuracy200: 0.3473 - 10s/epoch - 34ms/step
Epoch 14/50
286/286 - 10s - loss: 3.2316 - accuracy200: 0.4019 - val_loss: 3.3781 - val_accuracy200: 0.3513 - 10s/epoch - 34ms/step
Epoch 15/50
286/286 - 9s - loss: 3.2267 - accuracy200: 0.4050 - val_loss: 3.3863 - val_accuracy200: 0.3486 - 9s/epoch - 33ms/step
Epoch 16/50
286/286 - 9s - loss: 3.2208 - accuracy200: 0.4055 - val_loss: 3.3703 - val_accuracy200: 0.3490 - 9s/epoch - 33ms/step
Epoch 17/50
286/286 - 9s - loss: 3.2173 - accuracy200: 0.4086 - val_loss: 3.3812 - val_accuracy200: 0.3483 - 9s/epoch - 33ms/step
Epoch 18/50
286/286 - 9s - loss: 3.2108 - accuracy200: 0.4138 - val_loss: 3.4000 - val_accuracy200: 0.3509 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h200
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1279334
{'0': {'precision': 0.36900881128360713, 'recall': 0.12631195174227192, 'f1-score': 0.1882021778315514, 'support': 90514}, '1': {'precision': 0.3115212477599575, 'recall': 0.8468317401255798, 'f1-score': 0.4554847841472046, 'support': 81701}, '2': {'precision': 0.4070323221806824, 'recall': 0.08432931671781396, 'f1-score': 0.1397128098502323, 'support': 101993}, 'accuracy': 0.3253770860077022, 'macro avg': {'precision': 0.36252079374141566, 'recall': 0.3524910028618886, 'f1-score': 0.2611332572763294, 'support': 274208}, 'weighted avg': {'precision': 0.3660232693573311, 'recall': 0.3253770860077022, 'f1-score': 0.24980388204906692, 'support': 274208}}
[[11433 71692  7389]
 [ 7373 69187  5141]
 [12177 81215  8601]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1177194
{'0': {'precision': 0.41834310153651194, 'recall': 0.10542914171656687, 'f1-score': 0.16841501131907025, 'support': 25050}, '1': {'precision': 0.33802121492052367, 'recall': 0.8968096344813015, 'f1-score': 0.49098333159824636, 'support': 23665}, '2': {'precision': 0.42145399084900864, 'recall': 0.06817994900896455, 'f1-score': 0.11737222143565057, 'support': 24318}, 'accuracy': 0.3494584639820355, 'macro avg': {'precision': 0.39260610243534805, 'recall': 0.356806241735611, 'f1-score': 0.25892352145098907, 'support': 73033}, 'weighted avg': {'precision': 0.3933521133467064, 'recall': 0.3494584639820355, 'f1-score': 0.25594148202439115, 'support': 73033}}
[[ 2641 21088  1321]
 [ 1487 21223   955]
 [ 2185 20475  1658]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1197053
{'0': {'precision': 0.37221547185095183, 'recall': 0.0938425405902175, 'f1-score': 0.14989398140596966, 'support': 9793}, '1': {'precision': 0.34020818767963956, 'recall': 0.8871670211688443, 'f1-score': 0.4918161655296331, 'support': 9873}, '2': {'precision': 0.3713927227101631, 'recall': 0.05836537513556147, 'f1-score': 0.10087756666950669, 'support': 10143}, 'accuracy': 0.34452682075883123, 'macro avg': {'precision': 0.36127212741358483, 'recall': 0.3464583122982077, 'f1-score': 0.2475292378683698, 'support': 29809}, 'weighted avg': {'precision': 0.3613344271611472, 'recall': 0.34452682075883123, 'f1-score': 0.2464629447788096, 'support': 29809}}
[[ 919 8330  544]
 [ 656 8759  458]
 [ 894 8657  592]]
training model: results/XRAY/W2/deepOF_L2/h300
Epoch 1/50
286/286 - 12s - loss: 3.3264 - accuracy300: 0.3514 - val_loss: 3.3958 - val_accuracy300: 0.3348 - 12s/epoch - 40ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3066 - accuracy300: 0.3596 - val_loss: 3.4079 - val_accuracy300: 0.3323 - 9s/epoch - 33ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2922 - accuracy300: 0.3644 - val_loss: 3.3961 - val_accuracy300: 0.3357 - 9s/epoch - 33ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2800 - accuracy300: 0.3737 - val_loss: 3.3970 - val_accuracy300: 0.3369 - 10s/epoch - 33ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2726 - accuracy300: 0.3784 - val_loss: 3.3967 - val_accuracy300: 0.3386 - 9s/epoch - 33ms/step
Epoch 6/50
286/286 - 10s - loss: 3.2656 - accuracy300: 0.3825 - val_loss: 3.3938 - val_accuracy300: 0.3381 - 10s/epoch - 34ms/step
Epoch 7/50
286/286 - 10s - loss: 3.2594 - accuracy300: 0.3859 - val_loss: 3.4057 - val_accuracy300: 0.3388 - 10s/epoch - 34ms/step
Epoch 8/50
286/286 - 10s - loss: 3.2527 - accuracy300: 0.3906 - val_loss: 3.3939 - val_accuracy300: 0.3411 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 10s - loss: 3.2468 - accuracy300: 0.3951 - val_loss: 3.4000 - val_accuracy300: 0.3402 - 10s/epoch - 33ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2423 - accuracy300: 0.3999 - val_loss: 3.3996 - val_accuracy300: 0.3411 - 9s/epoch - 33ms/step
Epoch 11/50
286/286 - 10s - loss: 3.2357 - accuracy300: 0.4005 - val_loss: 3.3999 - val_accuracy300: 0.3442 - 10s/epoch - 33ms/step
Epoch 12/50
286/286 - 10s - loss: 3.2329 - accuracy300: 0.4043 - val_loss: 3.4067 - val_accuracy300: 0.3415 - 10s/epoch - 34ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2287 - accuracy300: 0.4044 - val_loss: 3.4088 - val_accuracy300: 0.3411 - 9s/epoch - 33ms/step
Epoch 14/50
286/286 - 10s - loss: 3.2239 - accuracy300: 0.4074 - val_loss: 3.4146 - val_accuracy300: 0.3440 - 10s/epoch - 33ms/step
Epoch 15/50
286/286 - 10s - loss: 3.2166 - accuracy300: 0.4128 - val_loss: 3.4115 - val_accuracy300: 0.3436 - 10s/epoch - 33ms/step
Epoch 16/50
286/286 - 10s - loss: 3.2145 - accuracy300: 0.4154 - val_loss: 3.4187 - val_accuracy300: 0.3424 - 10s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h300
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1360904
{'0': {'precision': 0.3621002763521516, 'recall': 0.10193602880704172, 'f1-score': 0.15908696707947412, 'support': 89978}, '1': {'precision': 0.302759145753826, 'recall': 0.7985536533597692, 'f1-score': 0.43905677319720904, 'support': 78681}, '2': {'precision': 0.4048609431680774, 'recall': 0.15860879780954817, 'f1-score': 0.2279253092260669, 'support': 105549}, 'accuracy': 0.32363753063367956, 'macro avg': {'precision': 0.3565734550913517, 'recall': 0.3530328266587864, 'f1-score': 0.27535634983425, 'support': 274208}, 'weighted avg': {'precision': 0.3615325544955584, 'recall': 0.32363753063367956, 'f1-score': 0.26591872432353786, 'support': 274208}}
[[ 9172 66093 14713]
 [ 5954 62831  9896]
 [10204 78604 16741]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121266
{'0': {'precision': 0.4131215730761959, 'recall': 0.08827926144398206, 'f1-score': 0.14547270306258323, 'support': 24751}, '1': {'precision': 0.34871041793261764, 'recall': 0.8482098866809, 'f1-score': 0.49423444976076547, 'support': 24356}, '2': {'precision': 0.38835294117647057, 'recall': 0.13796706511744547, 'f1-score': 0.20360204773946833, 'support': 23926}, 'accuracy': 0.3579888543535114, 'macro avg': {'precision': 0.3833949773950947, 'recall': 0.3581520710807758, 'f1-score': 0.28110306685427233, 'support': 73033}, 'weighted avg': {'precision': 0.3835265628546547, 'recall': 0.3579888543535114, 'f1-score': 0.28082581471512497, 'support': 73033}}
[[ 2185 19631  2935]
 [ 1433 20659  2264]
 [ 1671 18954  3301]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1313916
{'0': {'precision': 0.3733781835655935, 'recall': 0.08027688810827564, 'f1-score': 0.13214285714285712, 'support': 9679}, '1': {'precision': 0.33412672357189754, 'recall': 0.8411157024793389, 'f1-score': 0.478265977443609, 'support': 9680}, '2': {'precision': 0.36488095238095236, 'recall': 0.11732057416267942, 'f1-score': 0.17755249818971758, 'support': 10450}, 'accuracy': 0.34033345633868967, 'macro avg': {'precision': 0.3574619531728145, 'recall': 0.3462377215834313, 'f1-score': 0.2626537775920612, 'support': 29809}, 'weighted avg': {'precision': 0.3576530603270254, 'recall': 0.34033345633868967, 'f1-score': 0.2604598940595927, 'support': 29809}}
[[ 777 7727 1175]
 [ 579 8142  959]
 [ 725 8499 1226]]
training model: results/XRAY/W2/deepOF_L2/h500
Epoch 1/50
286/286 - 12s - loss: 3.3286 - accuracy500: 0.3491 - val_loss: 3.4067 - val_accuracy500: 0.3347 - 12s/epoch - 42ms/step
Epoch 2/50
286/286 - 10s - loss: 3.3099 - accuracy500: 0.3561 - val_loss: 3.4076 - val_accuracy500: 0.3315 - 10s/epoch - 33ms/step
Epoch 3/50
286/286 - 10s - loss: 3.2984 - accuracy500: 0.3617 - val_loss: 3.4020 - val_accuracy500: 0.3327 - 10s/epoch - 33ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2861 - accuracy500: 0.3687 - val_loss: 3.4112 - val_accuracy500: 0.3327 - 9s/epoch - 33ms/step
Epoch 5/50
286/286 - 10s - loss: 3.2763 - accuracy500: 0.3741 - val_loss: 3.4156 - val_accuracy500: 0.3334 - 10s/epoch - 33ms/step
Epoch 6/50
286/286 - 10s - loss: 3.2706 - accuracy500: 0.3783 - val_loss: 3.4112 - val_accuracy500: 0.3349 - 10s/epoch - 34ms/step
Epoch 7/50
286/286 - 10s - loss: 3.2642 - accuracy500: 0.3833 - val_loss: 3.4153 - val_accuracy500: 0.3354 - 10s/epoch - 33ms/step
Epoch 8/50
286/286 - 10s - loss: 3.2598 - accuracy500: 0.3838 - val_loss: 3.4215 - val_accuracy500: 0.3353 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2551 - accuracy500: 0.3885 - val_loss: 3.4228 - val_accuracy500: 0.3371 - 9s/epoch - 33ms/step
Epoch 10/50
286/286 - 10s - loss: 3.2493 - accuracy500: 0.3927 - val_loss: 3.4229 - val_accuracy500: 0.3347 - 10s/epoch - 33ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2436 - accuracy500: 0.3970 - val_loss: 3.4232 - val_accuracy500: 0.3373 - 9s/epoch - 33ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2406 - accuracy500: 0.3998 - val_loss: 3.4217 - val_accuracy500: 0.3378 - 9s/epoch - 33ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2358 - accuracy500: 0.4001 - val_loss: 3.4156 - val_accuracy500: 0.3411 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h500
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1405317
{'0': {'precision': 0.3401407838706874, 'recall': 0.044593824769283356, 'f1-score': 0.07885008612266688, 'support': 87770}, '1': {'precision': 0.2910755471485224, 'recall': 0.8914764137159991, 'f1-score': 0.4388593372297744, 'support': 78711}, '2': {'precision': 0.4093283409605695, 'recall': 0.08219852033380676, 'f1-score': 0.13690476190476192, 'support': 107727}, 'accuracy': 0.3024638230832069, 'macro avg': {'precision': 0.34684822399325976, 'recall': 0.339422919606363, 'f1-score': 0.2182047284190677, 'support': 274208}, 'weighted avg': {'precision': 0.35323811915989634, 'recall': 0.3024638230832069, 'f1-score': 0.20499791631678702, 'support': 274208}}
[[ 3914 76599  7257]
 [ 3021 70169  5521]
 [ 4572 94300  8855]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186097
{'0': {'precision': 0.38697318007662834, 'recall': 0.03732139924453933, 'f1-score': 0.06807713911252575, 'support': 24356}, '1': {'precision': 0.3501641417944162, 'recall': 0.9255293743034548, 'f1-score': 0.5080957063257948, 'support': 25124}, '2': {'precision': 0.3667601683029453, 'recall': 0.06661571774296268, 'f1-score': 0.11275196723078583, 'support': 23553}, 'accuracy': 0.35232018402639903, 'macro avg': {'precision': 0.3679658300579966, 'recall': 0.3431554970969856, 'f1-score': 0.22964160422303548, 'support': 73033}, 'weighted avg': {'precision': 0.3677918874540077, 'recall': 0.35232018402639903, 'f1-score': 0.23385497528707086, 'support': 73033}}
[[  909 21959  1488]
 [  650 23253  1221]
 [  790 21194  1569]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1291224
{'0': {'precision': 0.3740701381509033, 'recall': 0.03666284762003958, 'f1-score': 0.06678049705938152, 'support': 9601}, '1': {'precision': 0.3297558456885742, 'recall': 0.9174020110814693, 'f1-score': 0.485132935431362, 'support': 9746}, '2': {'precision': 0.36887115165336376, 'recall': 0.06184285987382909, 'f1-score': 0.10592665356908972, 'support': 10462}, 'accuracy': 0.33345633868965746, 'macro avg': {'precision': 0.35756571183094704, 'recall': 0.33863590619177936, 'f1-score': 0.2192800286866111, 'support': 29809}, 'weighted avg': {'precision': 0.35775698135010087, 'recall': 0.33345633868965746, 'f1-score': 0.2172991308202554, 'support': 29809}}
[[ 352 8671  578]
 [ 276 8941  529]
 [ 313 9502  647]]
training model: results/XRAY/W2/deepOF_L2/h1000
Epoch 1/50
286/286 - 12s - loss: 3.3333 - accuracy1000: 0.3500 - val_loss: 3.4972 - val_accuracy1000: 0.3112 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 10s - loss: 3.3198 - accuracy1000: 0.3516 - val_loss: 3.4932 - val_accuracy1000: 0.3100 - 10s/epoch - 34ms/step
Epoch 3/50
286/286 - 10s - loss: 3.3043 - accuracy1000: 0.3606 - val_loss: 3.4957 - val_accuracy1000: 0.3081 - 10s/epoch - 33ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2952 - accuracy1000: 0.3637 - val_loss: 3.4797 - val_accuracy1000: 0.3076 - 10s/epoch - 34ms/step
Epoch 5/50
286/286 - 10s - loss: 3.2855 - accuracy1000: 0.3689 - val_loss: 3.4750 - val_accuracy1000: 0.3108 - 10s/epoch - 34ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2798 - accuracy1000: 0.3731 - val_loss: 3.4832 - val_accuracy1000: 0.3114 - 9s/epoch - 33ms/step
Epoch 7/50
286/286 - 10s - loss: 3.2729 - accuracy1000: 0.3784 - val_loss: 3.4754 - val_accuracy1000: 0.3143 - 10s/epoch - 34ms/step
Epoch 8/50
286/286 - 10s - loss: 3.2675 - accuracy1000: 0.3815 - val_loss: 3.4860 - val_accuracy1000: 0.3128 - 10s/epoch - 34ms/step
Epoch 9/50
286/286 - 10s - loss: 3.2626 - accuracy1000: 0.3852 - val_loss: 3.4922 - val_accuracy1000: 0.3154 - 10s/epoch - 33ms/step
Epoch 10/50
286/286 - 10s - loss: 3.2540 - accuracy1000: 0.3919 - val_loss: 3.4949 - val_accuracy1000: 0.3168 - 10s/epoch - 33ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2521 - accuracy1000: 0.3928 - val_loss: 3.5060 - val_accuracy1000: 0.3183 - 9s/epoch - 33ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2449 - accuracy1000: 0.3961 - val_loss: 3.5084 - val_accuracy1000: 0.3208 - 9s/epoch - 33ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2401 - accuracy1000: 0.3992 - val_loss: 3.5056 - val_accuracy1000: 0.3201 - 9s/epoch - 33ms/step
Epoch 14/50
286/286 - 10s - loss: 3.2348 - accuracy1000: 0.4052 - val_loss: 3.5092 - val_accuracy1000: 0.3211 - 10s/epoch - 33ms/step
Epoch 15/50
286/286 - 9s - loss: 3.2277 - accuracy1000: 0.4064 - val_loss: 3.5185 - val_accuracy1000: 0.3208 - 9s/epoch - 33ms/step
testing model: results/XRAY/W2/deepOF_L2/h1000
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1375953
{'0': {'precision': 0.35950515976625635, 'recall': 0.06947214146704789, 'f1-score': 0.11644249355670104, 'support': 83242}, '1': {'precision': 0.3003926070870398, 'recall': 0.8935698171529708, 'f1-score': 0.4496318502816, 'support': 80231}, '2': {'precision': 0.42269153691999384, 'recall': 0.07428545626947217, 'f1-score': 0.12636332913453563, 'support': 110735}, 'accuracy': 0.31254011553273425, 'macro avg': {'precision': 0.3608631012577634, 'recall': 0.3457758049631636, 'f1-score': 0.23081255765761222, 'support': 274208}, 'weighted avg': {'precision': 0.36772623376888536, 'recall': 0.31254011553273425, 'f1-score': 0.21793734056009587, 'support': 274208}}
[[ 5783 71016  6443]
 [ 3747 71692  4792]
 [ 6556 95953  8226]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182978
{'0': {'precision': 0.4233087742799732, 'recall': 0.05200362050522505, 'f1-score': 0.09262787630074748, 'support': 24306}, '1': {'precision': 0.35629299266762415, 'recall': 0.9271411149140407, 'f1-score': 0.5147656284129133, 'support': 25419}, '2': {'precision': 0.3795489492567914, 'recall': 0.06354041530804874, 'f1-score': 0.10885703785373024, 'support': 23308}, 'accuracy': 0.3602754919009215, 'macro avg': {'precision': 0.3863835720681296, 'recall': 0.3475617169091048, 'f1-score': 0.238750180855797, 'support': 73033}, 'weighted avg': {'precision': 0.38601839658160914, 'recall': 0.3602754919009215, 'f1-score': 0.24473156666559712, 'support': 73033}}
[[ 1264 21689  1353]
 [  784 23567  1068]
 [  938 20889  1481]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1474985
{'0': {'precision': 0.38563622170179546, 'recall': 0.04975825946817083, 'f1-score': 0.08814345615130699, 'support': 9928}, '1': {'precision': 0.3026408125577101, 'recall': 0.9251439539347409, 'f1-score': 0.45608371368139816, 'support': 8857}, '2': {'precision': 0.39022711631108054, 'recall': 0.05143323657474601, 'f1-score': 0.09088723250781437, 'support': 11024}, 'accuracy': 0.3104767016672817, 'macro avg': {'precision': 0.3595013835235286, 'recall': 0.34211181665921925, 'f1-score': 0.21170480078017317, 'support': 29809}, 'weighted avg': {'precision': 0.36267401845390373, 'recall': 0.3104767016672817, 'f1-score': 0.1984824226211032, 'support': 29809}}
[[ 494 8905  529]
 [ 306 8194  357]
 [ 481 9976  567]]
training model: results/XRAY/W2/deepVOL_L2/h10
Epoch 1/50
286/286 - 12s - loss: 3.2743 - accuracy10: 0.3961 - val_loss: 3.1806 - val_accuracy10: 0.4415 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 9s - loss: 3.1383 - accuracy10: 0.4521 - val_loss: 3.1126 - val_accuracy10: 0.4666 - 9s/epoch - 32ms/step
Epoch 3/50
286/286 - 9s - loss: 3.0800 - accuracy10: 0.4715 - val_loss: 3.0768 - val_accuracy10: 0.4692 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.0344 - accuracy10: 0.4865 - val_loss: 3.0735 - val_accuracy10: 0.4732 - 9s/epoch - 32ms/step
Epoch 5/50
286/286 - 9s - loss: 3.0107 - accuracy10: 0.4943 - val_loss: 3.0513 - val_accuracy10: 0.4758 - 9s/epoch - 32ms/step
Epoch 6/50
286/286 - 9s - loss: 2.9985 - accuracy10: 0.4995 - val_loss: 3.0608 - val_accuracy10: 0.4821 - 9s/epoch - 32ms/step
Epoch 7/50
286/286 - 9s - loss: 2.9852 - accuracy10: 0.5034 - val_loss: 3.0472 - val_accuracy10: 0.4819 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 2.9711 - accuracy10: 0.5062 - val_loss: 3.0527 - val_accuracy10: 0.4821 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 2.9599 - accuracy10: 0.5104 - val_loss: 3.0341 - val_accuracy10: 0.4885 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 2.9529 - accuracy10: 0.5119 - val_loss: 3.0371 - val_accuracy10: 0.4817 - 9s/epoch - 31ms/step
Epoch 11/50
286/286 - 9s - loss: 2.9437 - accuracy10: 0.5167 - val_loss: 3.0275 - val_accuracy10: 0.4893 - 9s/epoch - 31ms/step
Epoch 12/50
286/286 - 9s - loss: 2.9342 - accuracy10: 0.5170 - val_loss: 3.0313 - val_accuracy10: 0.4852 - 9s/epoch - 31ms/step
Epoch 13/50
286/286 - 9s - loss: 2.9270 - accuracy10: 0.5202 - val_loss: 3.0313 - val_accuracy10: 0.4852 - 9s/epoch - 31ms/step
Epoch 14/50
286/286 - 9s - loss: 2.9213 - accuracy10: 0.5206 - val_loss: 3.0279 - val_accuracy10: 0.4857 - 9s/epoch - 30ms/step
Epoch 15/50
286/286 - 9s - loss: 2.9138 - accuracy10: 0.5227 - val_loss: 3.0267 - val_accuracy10: 0.4875 - 9s/epoch - 31ms/step
Epoch 16/50
286/286 - 9s - loss: 2.9090 - accuracy10: 0.5228 - val_loss: 3.0214 - val_accuracy10: 0.4895 - 9s/epoch - 32ms/step
Epoch 17/50
286/286 - 9s - loss: 2.9076 - accuracy10: 0.5242 - val_loss: 3.0239 - val_accuracy10: 0.4879 - 9s/epoch - 31ms/step
Epoch 18/50
286/286 - 9s - loss: 2.8986 - accuracy10: 0.5257 - val_loss: 3.0275 - val_accuracy10: 0.4865 - 9s/epoch - 31ms/step
Epoch 19/50
286/286 - 9s - loss: 2.8901 - accuracy10: 0.5280 - val_loss: 3.0325 - val_accuracy10: 0.4845 - 9s/epoch - 31ms/step
Epoch 20/50
286/286 - 9s - loss: 2.8862 - accuracy10: 0.5296 - val_loss: 3.0449 - val_accuracy10: 0.4831 - 9s/epoch - 31ms/step
Epoch 21/50
286/286 - 9s - loss: 2.8761 - accuracy10: 0.5317 - val_loss: 3.0531 - val_accuracy10: 0.4839 - 9s/epoch - 31ms/step
Epoch 22/50
286/286 - 9s - loss: 2.8709 - accuracy10: 0.5331 - val_loss: 3.0426 - val_accuracy10: 0.4836 - 9s/epoch - 31ms/step
Epoch 23/50
286/286 - 9s - loss: 2.8679 - accuracy10: 0.5360 - val_loss: 3.0346 - val_accuracy10: 0.4861 - 9s/epoch - 31ms/step
Epoch 24/50
286/286 - 9s - loss: 2.8622 - accuracy10: 0.5354 - val_loss: 3.0324 - val_accuracy10: 0.4878 - 9s/epoch - 31ms/step
Epoch 25/50
286/286 - 9s - loss: 2.8570 - accuracy10: 0.5366 - val_loss: 3.0459 - val_accuracy10: 0.4884 - 9s/epoch - 31ms/step
Epoch 26/50
286/286 - 9s - loss: 2.8527 - accuracy10: 0.5372 - val_loss: 3.0367 - val_accuracy10: 0.4885 - 9s/epoch - 31ms/step
testing model: results/XRAY/W2/deepVOL_L2/h10
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0183152
{'0': {'precision': 0.5219302179567674, 'recall': 0.3150343782144984, 'f1-score': 0.39291019581363945, 'support': 92355}, '1': {'precision': 0.5374284589528511, 'recall': 0.4186224790659276, 'f1-score': 0.4706436129306001, 'support': 84790}, '2': {'precision': 0.444693023316844, 'recall': 0.6982836774220135, 'f1-score': 0.5433564471521904, 'support': 97068}, 'accuracy': 0.48273057805428626, 'macro avg': {'precision': 0.5013505667421542, 'recall': 0.47731351156747986, 'f1-score': 0.46897008529881007, 'support': 274213}, 'weighted avg': {'precision': 0.49938145420286023, 'recall': 0.48273057805428626, 'f1-score': 0.4702024217922676, 'support': 274213}}
[[29095 16272 46988]
 [11642 35495 37653]
 [15008 14279 67781]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98487645
{'0': {'precision': 0.5322622609600625, 'recall': 0.35413511057255376, 'f1-score': 0.425300797796315, 'support': 23107}, '1': {'precision': 0.5868275721006341, 'recall': 0.5267506334226857, 'f1-score': 0.5551685436742908, 'support': 27233}, '2': {'precision': 0.44007586476804045, 'recall': 0.6440782516743039, 'f1-score': 0.5228837658505179, 'support': 22696}, 'accuracy': 0.5085984993701737, 'macro avg': {'precision': 0.5197218992762457, 'recall': 0.5083213318898477, 'f1-score': 0.5011177024403746, 'support': 73036}, 'weighted avg': {'precision': 0.5239610762062021, 'recall': 0.5085984993701737, 'f1-score': 0.5040486942645376, 'support': 73036}}
[[ 8183  5409  9515]
 [ 3804 14345  9084]
 [ 3387  4691 14618]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0118736
{'0': {'precision': 0.4938559651578784, 'recall': 0.3449212384573601, 'f1-score': 0.40616604835614684, 'support': 9205}, '1': {'precision': 0.5912904938927244, 'recall': 0.48354034569616955, 'f1-score': 0.5320145259938838, 'support': 11513}, '2': {'precision': 0.41997851772287864, 'recall': 0.6451435485645144, 'f1-score': 0.5087612768910479, 'support': 9091}, 'accuracy': 0.49001979268006307, 'macro avg': {'precision': 0.5017083255911605, 'recall': 0.4912017109060147, 'f1-score': 0.48231395041369285, 'support': 29809}, 'weighted avg': {'precision': 0.5089569029515882, 'recall': 0.49001979268006307, 'f1-score': 0.48606093733779837, 'support': 29809}}
[[3175 2124 3906]
 [1752 5567 4194]
 [1502 1724 5865]]
training model: results/XRAY/W2/deepVOL_L2/h20
Epoch 1/50
286/286 - 12s - loss: 3.3035 - accuracy20: 0.3811 - val_loss: 3.2635 - val_accuracy20: 0.3987 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 9s - loss: 3.2080 - accuracy20: 0.4223 - val_loss: 3.2019 - val_accuracy20: 0.4323 - 9s/epoch - 32ms/step
Epoch 3/50
286/286 - 9s - loss: 3.1556 - accuracy20: 0.4443 - val_loss: 3.1517 - val_accuracy20: 0.4484 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.1249 - accuracy20: 0.4576 - val_loss: 3.1563 - val_accuracy20: 0.4466 - 9s/epoch - 31ms/step
Epoch 5/50
286/286 - 9s - loss: 3.0973 - accuracy20: 0.4672 - val_loss: 3.1621 - val_accuracy20: 0.4501 - 9s/epoch - 33ms/step
Epoch 6/50
286/286 - 9s - loss: 3.0871 - accuracy20: 0.4709 - val_loss: 3.1664 - val_accuracy20: 0.4505 - 9s/epoch - 32ms/step
Epoch 7/50
286/286 - 9s - loss: 3.0689 - accuracy20: 0.4804 - val_loss: 3.1634 - val_accuracy20: 0.4492 - 9s/epoch - 32ms/step
Epoch 8/50
286/286 - 9s - loss: 3.0649 - accuracy20: 0.4801 - val_loss: 3.1550 - val_accuracy20: 0.4495 - 9s/epoch - 32ms/step
Epoch 9/50
286/286 - 9s - loss: 3.0544 - accuracy20: 0.4828 - val_loss: 3.1310 - val_accuracy20: 0.4592 - 9s/epoch - 32ms/step
Epoch 10/50
286/286 - 9s - loss: 3.0463 - accuracy20: 0.4868 - val_loss: 3.1381 - val_accuracy20: 0.4595 - 9s/epoch - 31ms/step
Epoch 11/50
286/286 - 9s - loss: 3.0424 - accuracy20: 0.4875 - val_loss: 3.1334 - val_accuracy20: 0.4624 - 9s/epoch - 32ms/step
Epoch 12/50
286/286 - 9s - loss: 3.0326 - accuracy20: 0.4917 - val_loss: 3.1498 - val_accuracy20: 0.4576 - 9s/epoch - 31ms/step
Epoch 13/50
286/286 - 9s - loss: 3.0283 - accuracy20: 0.4919 - val_loss: 3.1339 - val_accuracy20: 0.4613 - 9s/epoch - 31ms/step
Epoch 14/50
286/286 - 9s - loss: 3.0200 - accuracy20: 0.4938 - val_loss: 3.1506 - val_accuracy20: 0.4598 - 9s/epoch - 32ms/step
Epoch 15/50
286/286 - 9s - loss: 3.0159 - accuracy20: 0.4959 - val_loss: 3.1352 - val_accuracy20: 0.4625 - 9s/epoch - 32ms/step
Epoch 16/50
286/286 - 9s - loss: 3.0112 - accuracy20: 0.4964 - val_loss: 3.1426 - val_accuracy20: 0.4615 - 9s/epoch - 31ms/step
Epoch 17/50
286/286 - 9s - loss: 3.0044 - accuracy20: 0.4975 - val_loss: 3.1550 - val_accuracy20: 0.4599 - 9s/epoch - 31ms/step
Epoch 18/50
286/286 - 9s - loss: 2.9978 - accuracy20: 0.5012 - val_loss: 3.1644 - val_accuracy20: 0.4553 - 9s/epoch - 31ms/step
Epoch 19/50
286/286 - 9s - loss: 2.9929 - accuracy20: 0.5009 - val_loss: 3.1581 - val_accuracy20: 0.4587 - 9s/epoch - 31ms/step
testing model: results/XRAY/W2/deepVOL_L2/h20
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0477568
{'0': {'precision': 0.4968760954285832, 'recall': 0.2532048587760592, 'f1-score': 0.3354609682246894, 'support': 95168}, '1': {'precision': 0.48343407631280694, 'recall': 0.328747591522158, 'f1-score': 0.3913601957336188, 'support': 77850}, '2': {'precision': 0.4349273047182479, 'recall': 0.742576214239834, 'f1-score': 0.5485617090859981, 'support': 101195}, 'accuracy': 0.455248292385846, 'macro avg': {'precision': 0.47174582548654603, 'recall': 0.44150955484601706, 'f1-score': 0.4251276243481021, 'support': 274213}, 'weighted avg': {'precision': 0.4701984066826246, 'recall': 0.455248292385846, 'f1-score': 0.429973206276971, 'support': 274213}}
[[24097 13994 57077]
 [11703 25593 40554]
 [12697 13353 75145]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0308694
{'0': {'precision': 0.5134974589136031, 'recall': 0.3191533002420314, 'f1-score': 0.39364501113135, 'support': 24377}, '1': {'precision': 0.526217779084583, 'recall': 0.4359192952543336, 'f1-score': 0.4768311907457981, 'support': 24633}, '2': {'precision': 0.42546492702580113, 'recall': 0.6636976608673937, 'f1-score': 0.5185269490285342, 'support': 24026}, 'accuracy': 0.471876882633222, 'macro avg': {'precision': 0.4883933883413291, 'recall': 0.4729234187879196, 'f1-score': 0.46300105030189415, 'support': 73036}, 'weighted avg': {'precision': 0.48882839209224677, 'recall': 0.471876882633222, 'f1-score': 0.4627826775199864, 'support': 73036}}
[[ 7780  4966 11631]
 [ 3993 10738  9902]
 [ 3378  4702 15946]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0442799
{'0': {'precision': 0.48048780487804876, 'recall': 0.30223995090518563, 'f1-score': 0.37106799773968735, 'support': 9777}, '1': {'precision': 0.5328775637041641, 'recall': 0.4140028971511347, 'f1-score': 0.4659782608695652, 'support': 10355}, '2': {'precision': 0.41129755347764824, 'recall': 0.6636354242017154, 'f1-score': 0.5078486418093393, 'support': 9677}, 'accuracy': 0.4583850514945151, 'macro avg': {'precision': 0.4748876406866203, 'recall': 0.4599594240860119, 'f1-score': 0.4482983001395306, 'support': 29809}, 'weighted avg': {'precision': 0.47622539721065793, 'recall': 0.4583850514945151, 'f1-score': 0.448441343620861, 'support': 29809}}
[[2955 1938 4884]
 [1760 4287 4308]
 [1435 1820 6422]]
training model: results/XRAY/W2/deepVOL_L2/h30
Epoch 1/50
286/286 - 11s - loss: 3.3311 - accuracy30: 0.3650 - val_loss: 3.2755 - val_accuracy30: 0.3864 - 11s/epoch - 40ms/step
Epoch 2/50
286/286 - 9s - loss: 3.2544 - accuracy30: 0.3946 - val_loss: 3.2297 - val_accuracy30: 0.4112 - 9s/epoch - 32ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2099 - accuracy30: 0.4203 - val_loss: 3.2114 - val_accuracy30: 0.4189 - 9s/epoch - 32ms/step
Epoch 4/50
286/286 - 9s - loss: 3.1852 - accuracy30: 0.4321 - val_loss: 3.2214 - val_accuracy30: 0.4192 - 9s/epoch - 32ms/step
Epoch 5/50
286/286 - 9s - loss: 3.1681 - accuracy30: 0.4409 - val_loss: 3.2185 - val_accuracy30: 0.4182 - 9s/epoch - 31ms/step
Epoch 6/50
286/286 - 9s - loss: 3.1563 - accuracy30: 0.4459 - val_loss: 3.2438 - val_accuracy30: 0.4176 - 9s/epoch - 31ms/step
Epoch 7/50
286/286 - 9s - loss: 3.1463 - accuracy30: 0.4489 - val_loss: 3.2284 - val_accuracy30: 0.4231 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 3.1388 - accuracy30: 0.4548 - val_loss: 3.2233 - val_accuracy30: 0.4212 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.1266 - accuracy30: 0.4607 - val_loss: 3.2250 - val_accuracy30: 0.4239 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.1246 - accuracy30: 0.4612 - val_loss: 3.2383 - val_accuracy30: 0.4224 - 9s/epoch - 32ms/step
Epoch 11/50
286/286 - 9s - loss: 3.1169 - accuracy30: 0.4623 - val_loss: 3.2274 - val_accuracy30: 0.4215 - 9s/epoch - 32ms/step
Epoch 12/50
286/286 - 9s - loss: 3.1119 - accuracy30: 0.4660 - val_loss: 3.2424 - val_accuracy30: 0.4182 - 9s/epoch - 32ms/step
Epoch 13/50
286/286 - 9s - loss: 3.1084 - accuracy30: 0.4669 - val_loss: 3.2636 - val_accuracy30: 0.4143 - 9s/epoch - 32ms/step
testing model: results/XRAY/W2/deepVOL_L2/h30
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0728991
{'0': {'precision': 0.4400379206825723, 'recall': 0.2058562649152077, 'f1-score': 0.2804935074277904, 'support': 94702}, '1': {'precision': 0.42254117447817435, 'recall': 0.25842202024910016, 'f1-score': 0.3207043928146791, 'support': 77238}, '2': {'precision': 0.41347332924586144, 'recall': 0.7385135861859924, 'f1-score': 0.5301373949358649, 'support': 102273}, 'accuracy': 0.419327311250743, 'macro avg': {'precision': 0.425350808135536, 'recall': 0.4009306237834334, 'f1-score': 0.3771117650594447, 'support': 274213}, 'weighted avg': {'precision': 0.42520181100381155, 'recall': 0.419327311250743, 'f1-score': 0.3849292477924916, 'support': 274213}}
[[19495 14411 60796]
 [10932 19960 46346]
 [13876 12867 75530]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0653746
{'0': {'precision': 0.4578969714123974, 'recall': 0.261138014527845, 'f1-score': 0.3325966282894737, 'support': 24780}, '1': {'precision': 0.45748502994011975, 'recall': 0.3705140640155189, 'f1-score': 0.40943193997856375, 'support': 23713}, '2': {'precision': 0.3995818534471901, 'recall': 0.6463350038707575, 'f1-score': 0.4938513744902089, 'support': 24543}, 'accuracy': 0.42609124267484527, 'macro avg': {'precision': 0.4383212849332357, 'recall': 0.42599569413804045, 'f1-score': 0.41195998091941544, 'support': 73036}, 'weighted avg': {'precision': 0.4381670257917144, 'recall': 0.42609124267484527, 'f1-score': 0.4117311781291149, 'support': 73036}}
[[ 6471  5493 12816]
 [ 3907  8786 11020]
 [ 3754  4926 15863]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0698987
{'0': {'precision': 0.43073811931243683, 'recall': 0.25917663759886433, 'f1-score': 0.32362623448974426, 'support': 9862}, '1': {'precision': 0.4615287588294652, 'recall': 0.3685164669150972, 'f1-score': 0.40981127849022797, 'support': 9929}, '2': {'precision': 0.39248761522543424, 'recall': 0.6247754042723098, 'f1-score': 0.48211053341036003, 'support': 10018}, 'accuracy': 0.41846422221476737, 'macro avg': {'precision': 0.4282514977891121, 'recall': 0.4174895029287571, 'f1-score': 0.4051826821301107, 'support': 29809}, 'weighted avg': {'precision': 0.4281391294040529, 'recall': 0.41846422221476737, 'f1-score': 0.40559567353390985, 'support': 29809}}
[[2556 2144 5162]
 [1744 3659 4526]
 [1634 2125 6259]]
training model: results/XRAY/W2/deepVOL_L2/h50
Epoch 1/50
286/286 - 11s - loss: 3.3366 - accuracy50: 0.3632 - val_loss: 3.3513 - val_accuracy50: 0.3603 - 11s/epoch - 39ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3054 - accuracy50: 0.3634 - val_loss: 3.3505 - val_accuracy50: 0.3513 - 9s/epoch - 31ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2830 - accuracy50: 0.3723 - val_loss: 3.3410 - val_accuracy50: 0.3700 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2634 - accuracy50: 0.3847 - val_loss: 3.3343 - val_accuracy50: 0.3644 - 9s/epoch - 31ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2492 - accuracy50: 0.3942 - val_loss: 3.3212 - val_accuracy50: 0.3653 - 9s/epoch - 30ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2422 - accuracy50: 0.3967 - val_loss: 3.3256 - val_accuracy50: 0.3728 - 9s/epoch - 30ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2295 - accuracy50: 0.4056 - val_loss: 3.3306 - val_accuracy50: 0.3720 - 9s/epoch - 32ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2215 - accuracy50: 0.4105 - val_loss: 3.3167 - val_accuracy50: 0.3785 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2120 - accuracy50: 0.4161 - val_loss: 3.3289 - val_accuracy50: 0.3763 - 9s/epoch - 32ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2016 - accuracy50: 0.4210 - val_loss: 3.3241 - val_accuracy50: 0.3763 - 9s/epoch - 31ms/step
Epoch 11/50
286/286 - 9s - loss: 3.1960 - accuracy50: 0.4235 - val_loss: 3.3250 - val_accuracy50: 0.3774 - 9s/epoch - 31ms/step
Epoch 12/50
286/286 - 9s - loss: 3.1900 - accuracy50: 0.4258 - val_loss: 3.3340 - val_accuracy50: 0.3751 - 9s/epoch - 31ms/step
Epoch 13/50
286/286 - 9s - loss: 3.1867 - accuracy50: 0.4279 - val_loss: 3.3328 - val_accuracy50: 0.3760 - 9s/epoch - 31ms/step
Epoch 14/50
286/286 - 9s - loss: 3.1762 - accuracy50: 0.4349 - val_loss: 3.3373 - val_accuracy50: 0.3756 - 9s/epoch - 31ms/step
Epoch 15/50
286/286 - 9s - loss: 3.1739 - accuracy50: 0.4340 - val_loss: 3.3417 - val_accuracy50: 0.3739 - 9s/epoch - 32ms/step
Epoch 16/50
286/286 - 9s - loss: 3.1659 - accuracy50: 0.4372 - val_loss: 3.3569 - val_accuracy50: 0.3740 - 9s/epoch - 32ms/step
Epoch 17/50
286/286 - 9s - loss: 3.1587 - accuracy50: 0.4413 - val_loss: 3.3604 - val_accuracy50: 0.3728 - 9s/epoch - 31ms/step
Epoch 18/50
286/286 - 9s - loss: 3.1548 - accuracy50: 0.4398 - val_loss: 3.3633 - val_accuracy50: 0.3663 - 9s/epoch - 31ms/step
testing model: results/XRAY/W2/deepVOL_L2/h50
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1177331
{'0': {'precision': 0.4252057905194437, 'recall': 0.03245620687040267, 'f1-score': 0.06030899300488148, 'support': 92309}, '1': {'precision': 0.3281108547732383, 'recall': 0.5589036325875814, 'f1-score': 0.4134821950198498, 'support': 80411}, '2': {'precision': 0.4177502976304774, 'recall': 0.5358891746228804, 'f1-score': 0.4695020890162633, 'support': 101493}, 'accuracy': 0.37316611539204925, 'macro avg': {'precision': 0.3903556476410532, 'recall': 0.37574967136028814, 'f1-score': 0.3144310923469982, 'support': 274213}, 'weighted avg': {'precision': 0.39397393346646664, 'recall': 0.3731661153920493, 'f1-score': 0.3153269726072665, 'support': 274213}}
[[ 2996 47140 42173]
 [ 1836 44942 33633]
 [ 2214 44890 54389]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1055293
{'0': {'precision': 0.5122615803814714, 'recall': 0.04604833442194644, 'f1-score': 0.08450071166379504, 'support': 24496}, '1': {'precision': 0.3611728833765102, 'recall': 0.6479394587480464, 'f1-score': 0.4638099303725729, 'support': 24314}, '2': {'precision': 0.4008083777328679, 'recall': 0.4502600511846776, 'f1-score': 0.4240975097684726, 'support': 24226}, 'accuracy': 0.3804972890081604, 'macro avg': {'precision': 0.4247476138302832, 'recall': 0.3814159481182235, 'f1-score': 0.3241360506016135, 'support': 73036}, 'weighted avg': {'precision': 0.4249945358233946, 'recall': 0.3804972890081604, 'f1-score': 0.32341845598945834, 'support': 73036}}
[[ 1128 15023  8345]
 [  598 15754  7962]
 [  476 12842 10908]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1075351
{'0': {'precision': 0.4227053140096618, 'recall': 0.03671071953010279, 'f1-score': 0.06755452615325228, 'support': 9534}, '1': {'precision': 0.36683254002596277, 'recall': 0.6624340691541317, 'f1-score': 0.4721854765717468, 'support': 10238}, '2': {'precision': 0.39330982559801775, 'recall': 0.4111786390355684, 'f1-score': 0.4020457866536776, 'support': 10037}, 'accuracy': 0.3777047200509913, 'macro avg': {'precision': 0.3942825598778808, 'recall': 0.3701078092399343, 'f1-score': 0.3139285964595589, 'support': 29809}, 'weighted avg': {'precision': 0.3936178579650853, 'recall': 0.3777047200509913, 'f1-score': 0.3191530518343323, 'support': 29809}}
[[ 350 6002 3182]
 [ 272 6782 3184]
 [ 206 5704 4127]]
training model: results/XRAY/W2/deepVOL_L2/h100
Epoch 1/50
286/286 - 12s - loss: 3.3570 - accuracy100: 0.3419 - val_loss: 3.3316 - val_accuracy100: 0.3501 - 12s/epoch - 43ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3169 - accuracy100: 0.3494 - val_loss: 3.3067 - val_accuracy100: 0.3566 - 9s/epoch - 32ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2994 - accuracy100: 0.3538 - val_loss: 3.2983 - val_accuracy100: 0.3558 - 9s/epoch - 33ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2904 - accuracy100: 0.3587 - val_loss: 3.2957 - val_accuracy100: 0.3625 - 9s/epoch - 32ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2842 - accuracy100: 0.3661 - val_loss: 3.2916 - val_accuracy100: 0.3619 - 9s/epoch - 32ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2781 - accuracy100: 0.3698 - val_loss: 3.2879 - val_accuracy100: 0.3674 - 9s/epoch - 32ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2696 - accuracy100: 0.3769 - val_loss: 3.2935 - val_accuracy100: 0.3675 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2657 - accuracy100: 0.3802 - val_loss: 3.2865 - val_accuracy100: 0.3656 - 9s/epoch - 32ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2604 - accuracy100: 0.3842 - val_loss: 3.2957 - val_accuracy100: 0.3622 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2564 - accuracy100: 0.3887 - val_loss: 3.3033 - val_accuracy100: 0.3616 - 9s/epoch - 31ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2489 - accuracy100: 0.3948 - val_loss: 3.3025 - val_accuracy100: 0.3624 - 9s/epoch - 31ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2414 - accuracy100: 0.3995 - val_loss: 3.3254 - val_accuracy100: 0.3561 - 9s/epoch - 31ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2364 - accuracy100: 0.4024 - val_loss: 3.3369 - val_accuracy100: 0.3552 - 9s/epoch - 31ms/step
Epoch 14/50
286/286 - 9s - loss: 3.2335 - accuracy100: 0.4022 - val_loss: 3.3236 - val_accuracy100: 0.3606 - 9s/epoch - 31ms/step
Epoch 15/50
286/286 - 9s - loss: 3.2266 - accuracy100: 0.4070 - val_loss: 3.3328 - val_accuracy100: 0.3588 - 9s/epoch - 31ms/step
Epoch 16/50
286/286 - 9s - loss: 3.2239 - accuracy100: 0.4082 - val_loss: 3.3217 - val_accuracy100: 0.3624 - 9s/epoch - 31ms/step
Epoch 17/50
286/286 - 9s - loss: 3.2168 - accuracy100: 0.4116 - val_loss: 3.3312 - val_accuracy100: 0.3613 - 9s/epoch - 32ms/step
Epoch 18/50
286/286 - 9s - loss: 3.2087 - accuracy100: 0.4176 - val_loss: 3.3436 - val_accuracy100: 0.3567 - 9s/epoch - 31ms/step
testing model: results/XRAY/W2/deepVOL_L2/h100
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988755
{'0': {'precision': 0.36926947719493286, 'recall': 0.13831874020580145, 'f1-score': 0.20125324872044262, 'support': 91253}, '1': {'precision': 0.32083300848081636, 'recall': 0.46073845541401276, 'f1-score': 0.3782638225726557, 'support': 80384}, '2': {'precision': 0.3986034752598419, 'recall': 0.4841678365309624, 'f1-score': 0.43723890813528143, 'support': 102576}, 'accuracy': 0.3622074810457564, 'macro avg': {'precision': 0.3629019869785304, 'recall': 0.36107501071692555, 'f1-score': 0.33891865980945984, 'support': 274213}, 'weighted avg': {'precision': 0.3660436895203535, 'recall': 0.3622074810457564, 'f1-score': 0.34141904307983767, 'support': 274213}}
[[12622 37388 41243]
 [ 9660 37036 33688]
 [11899 41013 49664]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093162
{'0': {'precision': 0.4273445551356922, 'recall': 0.15103197086199918, 'f1-score': 0.22318571898454084, 'support': 24710}, '1': {'precision': 0.36313610257780154, 'recall': 0.5627121450451197, 'f1-score': 0.44141379702238887, 'support': 24158}, '2': {'precision': 0.3750558284948638, 'recall': 0.4169563058589871, 'f1-score': 0.3948977192569951, 'support': 24168}, 'accuracy': 0.3751985322306808, 'macro avg': {'precision': 0.3885121620694525, 'recall': 0.37690014058870197, 'f1-score': 0.3531657450879749, 'support': 73036}, 'weighted avg': {'precision': 0.3888038116345549, 'recall': 0.3751985322306808, 'f1-score': 0.3521890807763011, 'support': 73036}}
[[ 3732 12277  8701]
 [ 2474 13594  8090]
 [ 2527 11564 10077]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960604
{'0': {'precision': 0.36116399238509656, 'recall': 0.13974534357571294, 'f1-score': 0.20151745068285284, 'support': 9503}, '1': {'precision': 0.37550445198898214, 'recall': 0.5625179925151137, 'f1-score': 0.45036877688998156, 'support': 10421}, '2': {'precision': 0.35357855717137154, 'recall': 0.37632776934749623, 'f1-score': 0.36459864745663045, 'support': 9885}, 'accuracy': 0.36599684658995607, 'macro avg': {'precision': 0.3634156671818167, 'recall': 0.3595303684794409, 'f1-score': 0.33882829167648826, 'support': 29809}, 'weighted avg': {'precision': 0.3636618924301977, 'recall': 0.36599684658995607, 'f1-score': 0.3425935451681854, 'support': 29809}}
[[1328 4717 3458]
 [1216 5862 3343]
 [1133 5032 3720]]
training model: results/XRAY/W2/deepVOL_L2/h200
Epoch 1/50
286/286 - 12s - loss: 3.3417 - accuracy200: 0.3589 - val_loss: 3.4165 - val_accuracy200: 0.3369 - 12s/epoch - 43ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3097 - accuracy200: 0.3598 - val_loss: 3.3988 - val_accuracy200: 0.3330 - 9s/epoch - 33ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2966 - accuracy200: 0.3628 - val_loss: 3.3948 - val_accuracy200: 0.3316 - 9s/epoch - 33ms/step
Epoch 4/50
286/286 - 10s - loss: 3.2851 - accuracy200: 0.3669 - val_loss: 3.3744 - val_accuracy200: 0.3350 - 10s/epoch - 33ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2740 - accuracy200: 0.3722 - val_loss: 3.3672 - val_accuracy200: 0.3426 - 9s/epoch - 32ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2649 - accuracy200: 0.3798 - val_loss: 3.3515 - val_accuracy200: 0.3576 - 9s/epoch - 32ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2646 - accuracy200: 0.3775 - val_loss: 3.3416 - val_accuracy200: 0.3599 - 9s/epoch - 32ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2517 - accuracy200: 0.3855 - val_loss: 3.3380 - val_accuracy200: 0.3635 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2425 - accuracy200: 0.3901 - val_loss: 3.3433 - val_accuracy200: 0.3651 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2383 - accuracy200: 0.3939 - val_loss: 3.3446 - val_accuracy200: 0.3659 - 9s/epoch - 32ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2315 - accuracy200: 0.3964 - val_loss: 3.3547 - val_accuracy200: 0.3704 - 9s/epoch - 31ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2248 - accuracy200: 0.4020 - val_loss: 3.3920 - val_accuracy200: 0.3626 - 9s/epoch - 31ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2202 - accuracy200: 0.4050 - val_loss: 3.4135 - val_accuracy200: 0.3556 - 9s/epoch - 31ms/step
Epoch 14/50
286/286 - 9s - loss: 3.2134 - accuracy200: 0.4078 - val_loss: 3.4385 - val_accuracy200: 0.3560 - 9s/epoch - 32ms/step
Epoch 15/50
286/286 - 9s - loss: 3.2040 - accuracy200: 0.4119 - val_loss: 3.4552 - val_accuracy200: 0.3574 - 9s/epoch - 33ms/step
Epoch 16/50
286/286 - 9s - loss: 3.1999 - accuracy200: 0.4133 - val_loss: 3.4529 - val_accuracy200: 0.3600 - 9s/epoch - 31ms/step
Epoch 17/50
286/286 - 9s - loss: 3.1941 - accuracy200: 0.4169 - val_loss: 3.4633 - val_accuracy200: 0.3611 - 9s/epoch - 30ms/step
Epoch 18/50
286/286 - 9s - loss: 3.1874 - accuracy200: 0.4221 - val_loss: 3.4588 - val_accuracy200: 0.3620 - 9s/epoch - 30ms/step
testing model: results/XRAY/W2/deepVOL_L2/h200
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136788
{'0': {'precision': 0.34307535029165914, 'recall': 0.06302822736563, 'f1-score': 0.1064921974165609, 'support': 90515}, '1': {'precision': 0.3462979413695879, 'recall': 0.5487080941481745, 'f1-score': 0.42461497660497455, 'support': 81701}, '2': {'precision': 0.38902200126435077, 'recall': 0.4886908438483485, 'f1-score': 0.43319746573616197, 'support': 101997}, 'accuracy': 0.36606579556767915, 'macro avg': {'precision': 0.3594650976418659, 'recall': 0.36680905512071765, 'f1-score': 0.3214348799192324, 'support': 274213}, 'weighted avg': {'precision': 0.36112595136790093, 'recall': 0.36606579556767915, 'f1-score': 0.3227981582399607, 'support': 274213}}
[[ 5705 38701 46109]
 [ 4696 44830 32175]
 [ 6228 45924 49845]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1148654
{'0': {'precision': 0.38300653594771245, 'recall': 0.05843870916271092, 'f1-score': 0.10140513601439745, 'support': 25069}, '1': {'precision': 0.36383883377201864, 'recall': 0.6075050709939148, 'f1-score': 0.45510953526655695, 'support': 23664}, '2': {'precision': 0.35405232499410755, 'recall': 0.4326626342426861, 'f1-score': 0.3894300211103292, 'support': 24303}, 'accuracy': 0.36086313598773206, 'macro avg': {'precision': 0.36696589823794623, 'recall': 0.3662021381331039, 'f1-score': 0.31531489746376123, 'support': 73036}, 'weighted avg': {'precision': 0.3671614911329488, 'recall': 0.36086313598773206, 'f1-score': 0.3118483378106285, 'support': 73036}}
[[ 1465 12610 10994]
 [ 1098 14376  8190]
 [ 1262 12526 10515]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165781
{'0': {'precision': 0.3912483912483912, 'recall': 0.06207248596222562, 'f1-score': 0.10714600405322053, 'support': 9795}, '1': {'precision': 0.37160250891649244, 'recall': 0.612321410477252, 'f1-score': 0.4625157858482262, 'support': 9869}, '2': {'precision': 0.3544567664470941, 'recall': 0.41902414982750125, 'f1-score': 0.3840455325684343, 'support': 10145}, 'accuracy': 0.365728471267067, 'macro avg': {'precision': 0.3724358888706593, 'recall': 0.36447268208899297, 'f1-score': 0.3179024408232937, 'support': 29809}, 'weighted avg': {'precision': 0.3722227195941033, 'recall': 0.365728471267067, 'f1-score': 0.3190380532102454, 'support': 29809}}
[[ 608 4805 4382]
 [ 466 6043 3360]
 [ 480 5414 4251]]
training model: results/XRAY/W2/deepVOL_L2/h300
Epoch 1/50
286/286 - 11s - loss: 3.3416 - accuracy300: 0.3561 - val_loss: 3.4115 - val_accuracy300: 0.3347 - 11s/epoch - 38ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3018 - accuracy300: 0.3645 - val_loss: 3.3720 - val_accuracy300: 0.3408 - 9s/epoch - 31ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2884 - accuracy300: 0.3687 - val_loss: 3.4038 - val_accuracy300: 0.3332 - 9s/epoch - 33ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2790 - accuracy300: 0.3745 - val_loss: 3.3880 - val_accuracy300: 0.3517 - 9s/epoch - 32ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2720 - accuracy300: 0.3783 - val_loss: 3.3921 - val_accuracy300: 0.3315 - 9s/epoch - 31ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2666 - accuracy300: 0.3800 - val_loss: 3.3761 - val_accuracy300: 0.3395 - 9s/epoch - 31ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2580 - accuracy300: 0.3849 - val_loss: 3.3842 - val_accuracy300: 0.3392 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2506 - accuracy300: 0.3912 - val_loss: 3.3835 - val_accuracy300: 0.3383 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2430 - accuracy300: 0.3948 - val_loss: 3.3842 - val_accuracy300: 0.3390 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2346 - accuracy300: 0.3980 - val_loss: 3.4205 - val_accuracy300: 0.3463 - 9s/epoch - 32ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2240 - accuracy300: 0.4066 - val_loss: 3.4099 - val_accuracy300: 0.3501 - 9s/epoch - 32ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2180 - accuracy300: 0.4086 - val_loss: 3.4398 - val_accuracy300: 0.3485 - 9s/epoch - 31ms/step
testing model: results/XRAY/W2/deepVOL_L2/h300
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1317586
{'0': {'precision': 0.3648201736254651, 'recall': 0.039231376210004554, 'f1-score': 0.07084441322562841, 'support': 89979}, '1': {'precision': 0.29727518168537453, 'recall': 0.8172517221219593, 'f1-score': 0.4359673209261331, 'support': 78682}, '2': {'precision': 0.40857160629496775, 'recall': 0.18668523571320297, 'f1-score': 0.25627353184073454, 'support': 105552}, 'accuracy': 0.3192335884877814, 'macro avg': {'precision': 0.3568889872019358, 'recall': 0.3477227780150556, 'f1-score': 0.254361755330832, 'support': 274213}, 'weighted avg': {'precision': 0.3622800904248187, 'recall': 0.3192335884877814, 'f1-score': 0.2469885601178355, 'support': 274213}}
[[ 3530 69904 16545]
 [ 2400 64303 11979]
 [ 3746 82101 19705]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1205117
{'0': {'precision': 0.3918799646954987, 'recall': 0.03589038881254547, 'f1-score': 0.06575829383886256, 'support': 24742}, '1': {'precision': 0.3451015154872914, 'recall': 0.8317173377156943, 'f1-score': 0.4878013517909423, 'support': 24340}, '2': {'precision': 0.35122636055826245, 'recall': 0.17754863488352676, 'f1-score': 0.23586501400327206, 'support': 23954}, 'accuracy': 0.34756832247111014, 'macro avg': {'precision': 0.36273594691368416, 'recall': 0.34838545380392216, 'f1-score': 0.26314155321102567, 'support': 73036}, 'weighted avg': {'precision': 0.3629571884313122, 'recall': 0.34756832247111014, 'f1-score': 0.26219928739507986, 'support': 73036}}
[[  888 19480  4374]
 [  614 20244  3482]
 [  764 18937  4253]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228875
{'0': {'precision': 0.3707995365005794, 'recall': 0.03304078471863707, 'f1-score': 0.060675009480470235, 'support': 9685}, '1': {'precision': 0.33442691029900334, 'recall': 0.8328679284310684, 'f1-score': 0.477228954931998, 'support': 9669}, '2': {'precision': 0.3727907932593506, 'recall': 0.17350549976087995, 'f1-score': 0.23679916454539524, 'support': 10455}, 'accuracy': 0.34174242678385724, 'macro avg': {'precision': 0.3593390800196445, 'recall': 0.34647140430352846, 'f1-score': 0.2582343763192878, 'support': 29809}, 'weighted avg': {'precision': 0.35969992452667604, 'recall': 0.34174242678385724, 'f1-score': 0.257563135206748, 'support': 29809}}
[[ 320 7700 1665]
 [ 229 8053 1387]
 [ 314 8327 1814]]
training model: results/XRAY/W2/deepVOL_L2/h500
Epoch 1/50
286/286 - 11s - loss: 3.3468 - accuracy500: 0.3568 - val_loss: 3.4226 - val_accuracy500: 0.3276 - 11s/epoch - 39ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3051 - accuracy500: 0.3666 - val_loss: 3.4143 - val_accuracy500: 0.3293 - 9s/epoch - 32ms/step
Epoch 3/50
286/286 - 9s - loss: 3.2896 - accuracy500: 0.3695 - val_loss: 3.4214 - val_accuracy500: 0.3263 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2837 - accuracy500: 0.3727 - val_loss: 3.4295 - val_accuracy500: 0.3276 - 9s/epoch - 31ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2719 - accuracy500: 0.3796 - val_loss: 3.4300 - val_accuracy500: 0.3313 - 9s/epoch - 31ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2660 - accuracy500: 0.3821 - val_loss: 3.4281 - val_accuracy500: 0.3334 - 9s/epoch - 31ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2551 - accuracy500: 0.3887 - val_loss: 3.4267 - val_accuracy500: 0.3374 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2459 - accuracy500: 0.3939 - val_loss: 3.4376 - val_accuracy500: 0.3408 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2422 - accuracy500: 0.3951 - val_loss: 3.4504 - val_accuracy500: 0.3396 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2356 - accuracy500: 0.3960 - val_loss: 3.4538 - val_accuracy500: 0.3433 - 9s/epoch - 32ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2284 - accuracy500: 0.4037 - val_loss: 3.4580 - val_accuracy500: 0.3437 - 9s/epoch - 32ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2229 - accuracy500: 0.4079 - val_loss: 3.4595 - val_accuracy500: 0.3473 - 9s/epoch - 32ms/step
testing model: results/XRAY/W2/deepVOL_L2/h500
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436868
{'0': {'precision': 0.3046459797702726, 'recall': 0.02024563642163788, 'f1-score': 0.0379680572618984, 'support': 87772}, '1': {'precision': 0.29084489239402067, 'recall': 0.8916161654660721, 'f1-score': 0.43861403464913384, 'support': 78711}, '2': {'precision': 0.40726655097293507, 'recall': 0.10238559361366378, 'f1-score': 0.1636340708982071, 'support': 107730}, 'accuracy': 0.30263700116332926, 'macro avg': {'precision': 0.33425247437907607, 'recall': 0.3380824651671246, 'f1-score': 0.21340538760307978, 'support': 274213}, 'weighted avg': {'precision': 0.3410009911927459, 'recall': 0.30263700116332926, 'f1-score': 0.20234117296088508, 'support': 274213}}
[[ 1777 76853  9142]
 [ 1620 70180  6911]
 [ 2436 94264 11030]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1236503
{'0': {'precision': 0.3611274221961245, 'recall': 0.02523905281733492, 'f1-score': 0.047180667433831994, 'support': 24367}, '1': {'precision': 0.34857769065736466, 'recall': 0.9003348748206028, 'f1-score': 0.5025758570427159, 'support': 25084}, '2': {'precision': 0.34504889975550124, 'recall': 0.09573881704473182, 'f1-score': 0.1498888114441236, 'support': 23585}, 'accuracy': 0.34855413768552496, 'macro avg': {'precision': 0.35158467086966344, 'recall': 0.3404375815608898, 'f1-score': 0.23321511197355715, 'support': 73036}, 'weighted avg': {'precision': 0.35162512993367373, 'recall': 0.34855413768552496, 'f1-score': 0.23675162576440834, 'support': 73036}}
[[  615 21435  2317]
 [  531 22584  1969]
 [  557 20770  2258]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1325392
{'0': {'precision': 0.3389830508474576, 'recall': 0.0249324745480989, 'f1-score': 0.0464486162183085, 'support': 9626}, '1': {'precision': 0.3285459173980774, 'recall': 0.8897921383000618, 'f1-score': 0.47989566279102036, 'support': 9718}, '2': {'precision': 0.35190510424155286, 'recall': 0.09354992833253703, 'f1-score': 0.14780705065297803, 'support': 10465}, 'accuracy': 0.3309738669529337, 'macro avg': {'precision': 0.33981135749569596, 'recall': 0.3360915137268992, 'f1-score': 0.22471710988743565, 'support': 29809}, 'weighted avg': {'precision': 0.34011697771210014, 'recall': 0.3309738669529337, 'f1-score': 0.22333997167982786, 'support': 29809}}
[[ 240 8434  952]
 [ 220 8647  851]
 [ 248 9238  979]]
training model: results/XRAY/W2/deepVOL_L2/h1000
Epoch 1/50
286/286 - 12s - loss: 3.3469 - accuracy1000: 0.3634 - val_loss: 3.4994 - val_accuracy1000: 0.3014 - 12s/epoch - 41ms/step
Epoch 2/50
286/286 - 9s - loss: 3.3133 - accuracy1000: 0.3555 - val_loss: 3.4757 - val_accuracy1000: 0.2978 - 9s/epoch - 31ms/step
Epoch 3/50
286/286 - 9s - loss: 3.3047 - accuracy1000: 0.3510 - val_loss: 3.4244 - val_accuracy1000: 0.2983 - 9s/epoch - 31ms/step
Epoch 4/50
286/286 - 9s - loss: 3.2952 - accuracy1000: 0.3554 - val_loss: 3.4055 - val_accuracy1000: 0.3002 - 9s/epoch - 31ms/step
Epoch 5/50
286/286 - 9s - loss: 3.2842 - accuracy1000: 0.3623 - val_loss: 3.4213 - val_accuracy1000: 0.3047 - 9s/epoch - 31ms/step
Epoch 6/50
286/286 - 9s - loss: 3.2750 - accuracy1000: 0.3717 - val_loss: 3.4271 - val_accuracy1000: 0.3109 - 9s/epoch - 31ms/step
Epoch 7/50
286/286 - 9s - loss: 3.2738 - accuracy1000: 0.3753 - val_loss: 3.4578 - val_accuracy1000: 0.3043 - 9s/epoch - 31ms/step
Epoch 8/50
286/286 - 9s - loss: 3.2663 - accuracy1000: 0.3819 - val_loss: 3.4424 - val_accuracy1000: 0.3148 - 9s/epoch - 31ms/step
Epoch 9/50
286/286 - 9s - loss: 3.2578 - accuracy1000: 0.3916 - val_loss: 3.4471 - val_accuracy1000: 0.3203 - 9s/epoch - 31ms/step
Epoch 10/50
286/286 - 9s - loss: 3.2481 - accuracy1000: 0.3953 - val_loss: 3.4981 - val_accuracy1000: 0.3189 - 9s/epoch - 31ms/step
Epoch 11/50
286/286 - 9s - loss: 3.2383 - accuracy1000: 0.4034 - val_loss: 3.4596 - val_accuracy1000: 0.3212 - 9s/epoch - 31ms/step
Epoch 12/50
286/286 - 9s - loss: 3.2431 - accuracy1000: 0.3974 - val_loss: 3.4962 - val_accuracy1000: 0.3142 - 9s/epoch - 32ms/step
Epoch 13/50
286/286 - 9s - loss: 3.2314 - accuracy1000: 0.4025 - val_loss: 3.4909 - val_accuracy1000: 0.3166 - 9s/epoch - 32ms/step
Epoch 14/50
286/286 - 9s - loss: 3.2224 - accuracy1000: 0.4054 - val_loss: 3.4838 - val_accuracy1000: 0.3254 - 9s/epoch - 32ms/step
testing model: results/XRAY/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
1072/1072 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1248738
{'0': {'precision': 0.28844270323212534, 'recall': 0.021226500090095503, 'f1-score': 0.03954302849917759, 'support': 83245}, '1': {'precision': 0.2942117560397316, 'recall': 0.9558150839451085, 'f1-score': 0.4499295939920207, 'support': 80231}, '2': {'precision': 0.4272653939230976, 'recall': 0.02869862828142355, 'f1-score': 0.053784641421620476, 'support': 110737}, 'accuracy': 0.2976919402070653, 'macro avg': {'precision': 0.3366399510649849, 'recall': 0.33524673743887584, 'f1-score': 0.18108575463760623, 'support': 274213}, 'weighted avg': {'precision': 0.34619220881666457, 'recall': 0.2976919402070653, 'f1-score': 0.16536783631736582, 'support': 274213}}
[[  1767  78912   2566]
 [  1851  76686   1694]
 [  2508 105051   3178]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042272
{'0': {'precision': 0.39911797133406834, 'recall': 0.029784433108441664, 'f1-score': 0.05543220274098461, 'support': 24308}, '1': {'precision': 0.34979759401507676, 'recall': 0.962755905511811, 'f1-score': 0.5131519583669959, 'support': 25400}, '2': {'precision': 0.33282559025133285, 'recall': 0.018732853223593963, 'f1-score': 0.03546933971835558, 'support': 23328}, 'accuracy': 0.35071745440604635, 'macro avg': {'precision': 0.3605803852001593, 'recall': 0.3370910639479489, 'f1-score': 0.201351166942112, 'support': 73036}, 'weighted avg': {'precision': 0.360791580926592, 'recall': 0.35071745440604635, 'f1-score': 0.20823887512595637, 'support': 73036}}
[[  724 23096   488]
 [  558 24454   388]
 [  532 22359   437]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125247
{'0': {'precision': 0.3384615384615385, 'recall': 0.026610220743876624, 'f1-score': 0.04934118306700308, 'support': 9921}, '1': {'precision': 0.2989033320486318, 'recall': 0.9615644724977457, 'f1-score': 0.4560446903482746, 'support': 8872}, '2': {'precision': 0.3709016393442623, 'recall': 0.016430646332607116, 'f1-score': 0.0314673157162726, 'support': 11016}, 'accuracy': 0.3011171122815257, 'macro avg': {'precision': 0.3360888366181442, 'recall': 0.3348684465247431, 'f1-score': 0.17895106304385008, 'support': 29809}, 'weighted avg': {'precision': 0.3386762301328048, 'recall': 0.3011171122815257, 'f1-score': 0.1637822912512358, 'support': 29809}}
[[  264  9463   194]
 [  228  8531   113]
 [  288 10547   181]]
training model: results/XRAY/W2/deepVOL_L3/h10
Epoch 1/50
286/286 - 16s - loss: 3.3416 - accuracy10: 0.3586 - val_loss: 3.4020 - val_accuracy10: 0.3846 - 16s/epoch - 55ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3144 - accuracy10: 0.3598 - val_loss: 3.2775 - val_accuracy10: 0.4027 - 13s/epoch - 45ms/step
Epoch 3/50
286/286 - 13s - loss: 3.2484 - accuracy10: 0.3944 - val_loss: 3.2012 - val_accuracy10: 0.4223 - 13s/epoch - 44ms/step
Epoch 4/50
286/286 - 13s - loss: 3.1917 - accuracy10: 0.4219 - val_loss: 3.1604 - val_accuracy10: 0.4369 - 13s/epoch - 45ms/step
Epoch 5/50
286/286 - 12s - loss: 3.1599 - accuracy10: 0.4383 - val_loss: 3.1498 - val_accuracy10: 0.4408 - 12s/epoch - 44ms/step
Epoch 6/50
286/286 - 12s - loss: 3.1362 - accuracy10: 0.4477 - val_loss: 3.1435 - val_accuracy10: 0.4429 - 12s/epoch - 42ms/step
Epoch 7/50
286/286 - 12s - loss: 3.1159 - accuracy10: 0.4592 - val_loss: 3.1385 - val_accuracy10: 0.4542 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 12s - loss: 3.0860 - accuracy10: 0.4755 - val_loss: 3.1215 - val_accuracy10: 0.4601 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 13s - loss: 3.0490 - accuracy10: 0.4893 - val_loss: 3.0672 - val_accuracy10: 0.4809 - 13s/epoch - 44ms/step
Epoch 10/50
286/286 - 13s - loss: 3.0125 - accuracy10: 0.4977 - val_loss: 3.0388 - val_accuracy10: 0.4849 - 13s/epoch - 46ms/step
Epoch 11/50
286/286 - 12s - loss: 2.9864 - accuracy10: 0.5033 - val_loss: 3.0291 - val_accuracy10: 0.4888 - 12s/epoch - 43ms/step
Epoch 12/50
286/286 - 13s - loss: 2.9670 - accuracy10: 0.5075 - val_loss: 3.0130 - val_accuracy10: 0.4884 - 13s/epoch - 45ms/step
Epoch 13/50
286/286 - 13s - loss: 2.9535 - accuracy10: 0.5111 - val_loss: 3.0070 - val_accuracy10: 0.4903 - 13s/epoch - 44ms/step
Epoch 14/50
286/286 - 13s - loss: 2.9422 - accuracy10: 0.5130 - val_loss: 3.0125 - val_accuracy10: 0.4910 - 13s/epoch - 44ms/step
Epoch 15/50
286/286 - 12s - loss: 2.9305 - accuracy10: 0.5171 - val_loss: 3.0065 - val_accuracy10: 0.4975 - 12s/epoch - 43ms/step
Epoch 16/50
286/286 - 12s - loss: 2.9213 - accuracy10: 0.5186 - val_loss: 3.0148 - val_accuracy10: 0.4879 - 12s/epoch - 43ms/step
Epoch 17/50
286/286 - 13s - loss: 2.9126 - accuracy10: 0.5218 - val_loss: 2.9910 - val_accuracy10: 0.4974 - 13s/epoch - 44ms/step
Epoch 18/50
286/286 - 13s - loss: 2.9015 - accuracy10: 0.5241 - val_loss: 2.9852 - val_accuracy10: 0.4961 - 13s/epoch - 44ms/step
Epoch 19/50
286/286 - 12s - loss: 2.8968 - accuracy10: 0.5247 - val_loss: 2.9882 - val_accuracy10: 0.4992 - 12s/epoch - 44ms/step
Epoch 20/50
286/286 - 12s - loss: 2.8884 - accuracy10: 0.5273 - val_loss: 2.9916 - val_accuracy10: 0.4953 - 12s/epoch - 44ms/step
Epoch 21/50
286/286 - 12s - loss: 2.8791 - accuracy10: 0.5319 - val_loss: 2.9948 - val_accuracy10: 0.4923 - 12s/epoch - 43ms/step
Epoch 22/50
286/286 - 13s - loss: 2.8789 - accuracy10: 0.5315 - val_loss: 2.9875 - val_accuracy10: 0.4980 - 13s/epoch - 44ms/step
Epoch 23/50
286/286 - 13s - loss: 2.8703 - accuracy10: 0.5329 - val_loss: 2.9731 - val_accuracy10: 0.5000 - 13s/epoch - 44ms/step
Epoch 24/50
286/286 - 12s - loss: 2.8657 - accuracy10: 0.5330 - val_loss: 2.9661 - val_accuracy10: 0.5000 - 12s/epoch - 43ms/step
Epoch 25/50
286/286 - 12s - loss: 2.8594 - accuracy10: 0.5345 - val_loss: 2.9633 - val_accuracy10: 0.5012 - 12s/epoch - 43ms/step
Epoch 26/50
286/286 - 12s - loss: 2.8579 - accuracy10: 0.5363 - val_loss: 2.9831 - val_accuracy10: 0.4972 - 12s/epoch - 44ms/step
Epoch 27/50
286/286 - 12s - loss: 2.8470 - accuracy10: 0.5378 - val_loss: 2.9823 - val_accuracy10: 0.4975 - 12s/epoch - 43ms/step
Epoch 28/50
286/286 - 12s - loss: 2.8409 - accuracy10: 0.5403 - val_loss: 2.9804 - val_accuracy10: 0.5003 - 12s/epoch - 43ms/step
Epoch 29/50
286/286 - 12s - loss: 2.8324 - accuracy10: 0.5422 - val_loss: 2.9739 - val_accuracy10: 0.5013 - 12s/epoch - 43ms/step
Epoch 30/50
286/286 - 13s - loss: 2.8305 - accuracy10: 0.5414 - val_loss: 2.9784 - val_accuracy10: 0.5014 - 13s/epoch - 44ms/step
Epoch 31/50
286/286 - 13s - loss: 2.8252 - accuracy10: 0.5460 - val_loss: 2.9795 - val_accuracy10: 0.4952 - 13s/epoch - 44ms/step
Epoch 32/50
286/286 - 12s - loss: 2.8154 - accuracy10: 0.5470 - val_loss: 2.9827 - val_accuracy10: 0.4968 - 12s/epoch - 44ms/step
Epoch 33/50
286/286 - 12s - loss: 2.8123 - accuracy10: 0.5493 - val_loss: 2.9923 - val_accuracy10: 0.4936 - 12s/epoch - 43ms/step
Epoch 34/50
286/286 - 12s - loss: 2.8056 - accuracy10: 0.5505 - val_loss: 2.9865 - val_accuracy10: 0.4917 - 12s/epoch - 43ms/step
Epoch 35/50
286/286 - 12s - loss: 2.8018 - accuracy10: 0.5499 - val_loss: 2.9881 - val_accuracy10: 0.4958 - 12s/epoch - 43ms/step
testing model: results/XRAY/W2/deepVOL_L3/h10
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9998272
{'0': {'precision': 0.4937218698854337, 'recall': 0.4180932272210492, 'f1-score': 0.4527711168307311, 'support': 92355}, '1': {'precision': 0.6156687730878134, 'recall': 0.3872272673664347, 'f1-score': 0.47543060694039196, 'support': 84790}, '2': {'precision': 0.45140738456362667, 'recall': 0.6635039353855029, 'f1-score': 0.5372814335290976, 'support': 97068}, 'accuracy': 0.4954214424553176, 'macro avg': {'precision': 0.5202660091789579, 'recall': 0.4896081433243289, 'f1-score': 0.48849438576674026, 'support': 274213}, 'weighted avg': {'precision': 0.5164505350519742, 'recall': 0.4954214424553176, 'f1-score': 0.4896933108466063, 'support': 274213}}
[[38613 10462 43280]
 [16966 32833 34991]
 [22629 10034 64405]]
Evaluating performance on  train set...
286/286 - 7s - 7s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9736559
{'0': {'precision': 0.4951850668613938, 'recall': 0.4695546803998788, 'f1-score': 0.48202941045803893, 'support': 23107}, '1': {'precision': 0.6408294248333745, 'recall': 0.4766276209011126, 'f1-score': 0.5466644204851752, 'support': 27233}, '2': {'precision': 0.45374149659863944, 'recall': 0.6171572083186465, 'f1-score': 0.5229809954075346, 'support': 22696}, 'accuracy': 0.5180595870529602, 'macro avg': {'precision': 0.5299186627644693, 'recall': 0.5211131698732127, 'f1-score': 0.5172249421169163, 'support': 73036}, 'weighted avg': {'precision': 0.5366129863800897, 'recall': 0.5180595870529602, 'f1-score': 0.5188556660043826, 'support': 73036}}
[[10850  3668  8589]
 [ 5979 12980  8274]
 [ 5082  3607 14007]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.995958
{'0': {'precision': 0.46864907005234435, 'recall': 0.45714285714285713, 'f1-score': 0.46282446106467223, 'support': 9205}, '1': {'precision': 0.6459110116828237, 'recall': 0.451402762095023, 'f1-score': 0.5314177616442558, 'support': 11513}, '2': {'precision': 0.43186795994993743, 'recall': 0.6073039269607304, 'f1-score': 0.5047771428571429, 'support': 9091}, 'accuracy': 0.5007212586802644, 'macro avg': {'precision': 0.5154760138950351, 'recall': 0.5052831820662035, 'f1-score': 0.49967312185535695, 'support': 29809}, 'weighted avg': {'precision': 0.5258948569640397, 'recall': 0.5007212586802644, 'f1-score': 0.5021114716905939, 'support': 29809}}
[[4208 1452 3545]
 [2598 5197 3718]
 [2173 1397 5521]]
training model: results/XRAY/W2/deepVOL_L3/h20
Epoch 1/50
286/286 - 15s - loss: 3.3410 - accuracy20: 0.3531 - val_loss: 3.3579 - val_accuracy20: 0.3616 - 15s/epoch - 52ms/step
Epoch 2/50
286/286 - 13s - loss: 3.2919 - accuracy20: 0.3760 - val_loss: 3.2647 - val_accuracy20: 0.3977 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 12s - loss: 3.2397 - accuracy20: 0.3986 - val_loss: 3.2372 - val_accuracy20: 0.4038 - 12s/epoch - 44ms/step
Epoch 4/50
286/286 - 13s - loss: 3.2051 - accuracy20: 0.4158 - val_loss: 3.2366 - val_accuracy20: 0.4131 - 13s/epoch - 46ms/step
Epoch 5/50
286/286 - 13s - loss: 3.1702 - accuracy20: 0.4342 - val_loss: 3.1699 - val_accuracy20: 0.4322 - 13s/epoch - 45ms/step
Epoch 6/50
286/286 - 12s - loss: 3.1340 - accuracy20: 0.4516 - val_loss: 3.1679 - val_accuracy20: 0.4306 - 12s/epoch - 42ms/step
Epoch 7/50
286/286 - 12s - loss: 3.1076 - accuracy20: 0.4631 - val_loss: 3.1345 - val_accuracy20: 0.4510 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 12s - loss: 3.0880 - accuracy20: 0.4705 - val_loss: 3.1161 - val_accuracy20: 0.4620 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 12s - loss: 3.0700 - accuracy20: 0.4774 - val_loss: 3.1188 - val_accuracy20: 0.4592 - 12s/epoch - 43ms/step
Epoch 10/50
286/286 - 12s - loss: 3.0611 - accuracy20: 0.4820 - val_loss: 3.1087 - val_accuracy20: 0.4639 - 12s/epoch - 43ms/step
Epoch 11/50
286/286 - 12s - loss: 3.0460 - accuracy20: 0.4856 - val_loss: 3.1004 - val_accuracy20: 0.4697 - 12s/epoch - 44ms/step
Epoch 12/50
286/286 - 12s - loss: 3.0355 - accuracy20: 0.4893 - val_loss: 3.1120 - val_accuracy20: 0.4669 - 12s/epoch - 43ms/step
Epoch 13/50
286/286 - 12s - loss: 3.0285 - accuracy20: 0.4921 - val_loss: 3.1020 - val_accuracy20: 0.4718 - 12s/epoch - 44ms/step
Epoch 14/50
286/286 - 13s - loss: 3.0188 - accuracy20: 0.4950 - val_loss: 3.1091 - val_accuracy20: 0.4679 - 13s/epoch - 46ms/step
Epoch 15/50
286/286 - 13s - loss: 3.0102 - accuracy20: 0.4969 - val_loss: 3.1065 - val_accuracy20: 0.4705 - 13s/epoch - 44ms/step
Epoch 16/50
286/286 - 12s - loss: 3.0013 - accuracy20: 0.5005 - val_loss: 3.1057 - val_accuracy20: 0.4732 - 12s/epoch - 43ms/step
Epoch 17/50
286/286 - 12s - loss: 2.9942 - accuracy20: 0.5004 - val_loss: 3.1055 - val_accuracy20: 0.4733 - 12s/epoch - 43ms/step
Epoch 18/50
286/286 - 12s - loss: 2.9887 - accuracy20: 0.5037 - val_loss: 3.1025 - val_accuracy20: 0.4752 - 12s/epoch - 43ms/step
Epoch 19/50
286/286 - 12s - loss: 2.9819 - accuracy20: 0.5058 - val_loss: 3.0957 - val_accuracy20: 0.4768 - 12s/epoch - 43ms/step
Epoch 20/50
286/286 - 13s - loss: 2.9731 - accuracy20: 0.5070 - val_loss: 3.1062 - val_accuracy20: 0.4767 - 13s/epoch - 45ms/step
Epoch 21/50
286/286 - 13s - loss: 2.9689 - accuracy20: 0.5074 - val_loss: 3.1084 - val_accuracy20: 0.4760 - 13s/epoch - 45ms/step
Epoch 22/50
286/286 - 12s - loss: 2.9646 - accuracy20: 0.5107 - val_loss: 3.1012 - val_accuracy20: 0.4709 - 12s/epoch - 43ms/step
Epoch 23/50
286/286 - 13s - loss: 2.9595 - accuracy20: 0.5108 - val_loss: 3.1041 - val_accuracy20: 0.4771 - 13s/epoch - 44ms/step
Epoch 24/50
286/286 - 12s - loss: 2.9525 - accuracy20: 0.5141 - val_loss: 3.1068 - val_accuracy20: 0.4726 - 12s/epoch - 44ms/step
Epoch 25/50
286/286 - 12s - loss: 2.9501 - accuracy20: 0.5147 - val_loss: 3.1114 - val_accuracy20: 0.4725 - 12s/epoch - 43ms/step
Epoch 26/50
286/286 - 12s - loss: 2.9450 - accuracy20: 0.5166 - val_loss: 3.1203 - val_accuracy20: 0.4745 - 12s/epoch - 43ms/step
Epoch 27/50
286/286 - 12s - loss: 2.9365 - accuracy20: 0.5174 - val_loss: 3.1274 - val_accuracy20: 0.4739 - 12s/epoch - 43ms/step
Epoch 28/50
286/286 - 12s - loss: 2.9336 - accuracy20: 0.5183 - val_loss: 3.1325 - val_accuracy20: 0.4734 - 12s/epoch - 43ms/step
Epoch 29/50
286/286 - 13s - loss: 2.9255 - accuracy20: 0.5215 - val_loss: 3.1255 - val_accuracy20: 0.4756 - 13s/epoch - 44ms/step
testing model: results/XRAY/W2/deepVOL_L3/h20
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0280473
{'0': {'precision': 0.4597552130553037, 'recall': 0.5328576832548756, 'f1-score': 0.49361457745245, 'support': 95168}, '1': {'precision': 0.4994534153730831, 'recall': 0.41081567116249196, 'f1-score': 0.4508189788841589, 'support': 77850}, '2': {'precision': 0.4842359254698185, 'recall': 0.47793863333168635, 'f1-score': 0.481066671971513, 'support': 101195}, 'accuracy': 0.4779423295029776, 'macro avg': {'precision': 0.48114818463273507, 'recall': 0.47387066258301797, 'f1-score': 0.47516674276937393, 'support': 274213}, 'weighted avg': {'precision': 0.4800599788513307, 'recall': 0.4779423295029776, 'f1-score': 0.4768341088251972, 'support': 274213}}
[[50711 15594 28863]
 [23217 31982 22651]
 [36372 16458 48365]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.005312
{'0': {'precision': 0.4801754065412023, 'recall': 0.539032694753251, 'f1-score': 0.50790460361022, 'support': 24377}, '1': {'precision': 0.5304596719070404, 'recall': 0.5040798928266959, 'f1-score': 0.5169334526758392, 'support': 24633}, '2': {'precision': 0.4878048780487805, 'recall': 0.45201032215100306, 'f1-score': 0.4692259500097215, 'support': 24026}, 'accuracy': 0.4986171203242237, 'macro avg': {'precision': 0.49947998549900774, 'recall': 0.4983743032436499, 'f1-score': 0.49802133543192695, 'support': 73036}, 'weighted avg': {'precision': 0.4996446818465005, 'recall': 0.4986171203242237, 'f1-score': 0.4982260109658778, 'support': 73036}}
[[13140  5434  5803]
 [ 6616 12417  5600]
 [ 7609  5557 10860]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0329478
{'0': {'precision': 0.44942795556292486, 'recall': 0.5544645596808837, 'f1-score': 0.49645130271532584, 'support': 9777}, '1': {'precision': 0.5329794443189518, 'recall': 0.45572187349106713, 'f1-score': 0.4913321880368577, 'support': 10355}, '2': {'precision': 0.4575508827167435, 'recall': 0.420481554200682, 'f1-score': 0.43823371028540653, 'support': 9677}, 'accuracy': 0.4766681203663323, 'macro avg': {'precision': 0.47998609419954014, 'recall': 0.4768893291242109, 'f1-score': 0.47533906701253, 'support': 29809}, 'weighted avg': {'precision': 0.48108890467682214, 'recall': 0.4766681203663323, 'f1-score': 0.47577365252780307, 'support': 29809}}
[[5421 1979 2377]
 [3189 4719 2447]
 [3452 2156 4069]]
training model: results/XRAY/W2/deepVOL_L3/h30
Epoch 1/50
286/286 - 16s - loss: 3.3530 - accuracy30: 0.3470 - val_loss: 3.3325 - val_accuracy30: 0.3441 - 16s/epoch - 55ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3031 - accuracy30: 0.3559 - val_loss: 3.3107 - val_accuracy30: 0.3456 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 13s - loss: 3.2866 - accuracy30: 0.3625 - val_loss: 3.2761 - val_accuracy30: 0.3670 - 13s/epoch - 44ms/step
Epoch 4/50
286/286 - 13s - loss: 3.2714 - accuracy30: 0.3729 - val_loss: 3.2576 - val_accuracy30: 0.3849 - 13s/epoch - 47ms/step
Epoch 5/50
286/286 - 13s - loss: 3.2579 - accuracy30: 0.3796 - val_loss: 3.2516 - val_accuracy30: 0.3899 - 13s/epoch - 46ms/step
Epoch 6/50
286/286 - 12s - loss: 3.2425 - accuracy30: 0.3899 - val_loss: 3.2446 - val_accuracy30: 0.3893 - 12s/epoch - 44ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2225 - accuracy30: 0.4053 - val_loss: 3.2118 - val_accuracy30: 0.4113 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 13s - loss: 3.2001 - accuracy30: 0.4162 - val_loss: 3.2031 - val_accuracy30: 0.4151 - 13s/epoch - 44ms/step
Epoch 9/50
286/286 - 13s - loss: 3.1774 - accuracy30: 0.4318 - val_loss: 3.2007 - val_accuracy30: 0.4202 - 13s/epoch - 44ms/step
Epoch 10/50
286/286 - 12s - loss: 3.1645 - accuracy30: 0.4379 - val_loss: 3.1891 - val_accuracy30: 0.4295 - 12s/epoch - 43ms/step
Epoch 11/50
286/286 - 13s - loss: 3.1500 - accuracy30: 0.4456 - val_loss: 3.1844 - val_accuracy30: 0.4273 - 13s/epoch - 44ms/step
Epoch 12/50
286/286 - 12s - loss: 3.1433 - accuracy30: 0.4478 - val_loss: 3.1945 - val_accuracy30: 0.4224 - 12s/epoch - 43ms/step
Epoch 13/50
286/286 - 12s - loss: 3.1314 - accuracy30: 0.4524 - val_loss: 3.1871 - val_accuracy30: 0.4311 - 12s/epoch - 43ms/step
Epoch 14/50
286/286 - 12s - loss: 3.1239 - accuracy30: 0.4554 - val_loss: 3.1838 - val_accuracy30: 0.4313 - 12s/epoch - 44ms/step
Epoch 15/50
286/286 - 13s - loss: 3.1156 - accuracy30: 0.4608 - val_loss: 3.1932 - val_accuracy30: 0.4309 - 13s/epoch - 44ms/step
Epoch 16/50
286/286 - 13s - loss: 3.1086 - accuracy30: 0.4628 - val_loss: 3.1920 - val_accuracy30: 0.4308 - 13s/epoch - 44ms/step
Epoch 17/50
286/286 - 12s - loss: 3.0986 - accuracy30: 0.4685 - val_loss: 3.1848 - val_accuracy30: 0.4368 - 12s/epoch - 43ms/step
Epoch 18/50
286/286 - 13s - loss: 3.0901 - accuracy30: 0.4708 - val_loss: 3.1880 - val_accuracy30: 0.4360 - 13s/epoch - 45ms/step
Epoch 19/50
286/286 - 13s - loss: 3.0858 - accuracy30: 0.4717 - val_loss: 3.1938 - val_accuracy30: 0.4366 - 13s/epoch - 44ms/step
Epoch 20/50
286/286 - 12s - loss: 3.0765 - accuracy30: 0.4762 - val_loss: 3.1916 - val_accuracy30: 0.4360 - 12s/epoch - 43ms/step
Epoch 21/50
286/286 - 12s - loss: 3.0693 - accuracy30: 0.4782 - val_loss: 3.1961 - val_accuracy30: 0.4383 - 12s/epoch - 43ms/step
Epoch 22/50
286/286 - 13s - loss: 3.0691 - accuracy30: 0.4784 - val_loss: 3.1971 - val_accuracy30: 0.4385 - 13s/epoch - 45ms/step
Epoch 23/50
286/286 - 13s - loss: 3.0607 - accuracy30: 0.4804 - val_loss: 3.2004 - val_accuracy30: 0.4362 - 13s/epoch - 46ms/step
Epoch 24/50
286/286 - 12s - loss: 3.0527 - accuracy30: 0.4850 - val_loss: 3.2025 - val_accuracy30: 0.4357 - 12s/epoch - 44ms/step
testing model: results/XRAY/W2/deepVOL_L3/h30
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0589101
{'0': {'precision': 0.4426250052216049, 'recall': 0.3356634495575595, 'f1-score': 0.3817942697229746, 'support': 94702}, '1': {'precision': 0.44204071978311893, 'recall': 0.314547243584764, 'f1-score': 0.3675519481993056, 'support': 77238}, '2': {'precision': 0.4349984739037542, 'recall': 0.6270863277697926, 'f1-score': 0.5136719688596281, 'support': 102273}, 'accuracy': 0.43840736945367287, 'macro avg': {'precision': 0.439888066302826, 'recall': 0.425765673637372, 'f1-score': 0.42100606226063614, 'support': 274213}, 'weighted avg': {'precision': 0.4396159674437887, 'recall': 0.43840736945367287, 'f1-score': 0.4269689313690593, 'support': 274213}}
[[31788 15543 47371]
 [17013 24295 35930]
 [23016 15123 64134]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0479943
{'0': {'precision': 0.46936811718165294, 'recall': 0.354317998385795, 'f1-score': 0.40380812215425654, 'support': 24780}, '1': {'precision': 0.46972568578553614, 'recall': 0.39716611141567915, 'f1-score': 0.43040924982290973, 'support': 23713}, '2': {'precision': 0.42336639439906654, 'recall': 0.5913295033207024, 'f1-score': 0.49344644101796925, 'support': 24543}, 'accuracy': 0.44787502053781697, 'macro avg': {'precision': 0.45415339912208524, 'recall': 0.4476045377073922, 'f1-score': 0.44255460433171184, 'support': 73036}, 'weighted avg': {'precision': 0.45402580300851725, 'recall': 0.44787502053781697, 'f1-score': 0.44256689591348314, 'support': 73036}}
[[ 8780  5593 10407]
 [ 4935  9418  9360]
 [ 4991  5039 14513]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0630386
{'0': {'precision': 0.4409236690186017, 'recall': 0.3485094301358751, 'f1-score': 0.389307356855638, 'support': 9862}, '1': {'precision': 0.4609511889862328, 'recall': 0.37093362876422603, 'f1-score': 0.41107204643116246, 'support': 9929}, '2': {'precision': 0.41557330290929834, 'recall': 0.5817528448792174, 'f1-score': 0.4848182347558439, 'support': 10018}, 'accuracy': 0.4343654600959442, 'macro avg': {'precision': 0.4391493869713776, 'recall': 0.4337319679264395, 'f1-score': 0.4283992126808815, 'support': 29809}, 'weighted avg': {'precision': 0.4390750084823747, 'recall': 0.4343654600959442, 'f1-score': 0.42865552611994223, 'support': 29809}}
[[3437 2173 4252]
 [2302 3683 3944]
 [2056 2134 5828]]
training model: results/XRAY/W2/deepVOL_L3/h50
Epoch 1/50
286/286 - 15s - loss: 3.3305 - accuracy50: 0.3621 - val_loss: 3.4381 - val_accuracy50: 0.3435 - 15s/epoch - 53ms/step
Epoch 2/50
286/286 - 14s - loss: 3.3101 - accuracy50: 0.3605 - val_loss: 3.3545 - val_accuracy50: 0.3499 - 14s/epoch - 48ms/step
Epoch 3/50
286/286 - 13s - loss: 3.2988 - accuracy50: 0.3622 - val_loss: 3.3391 - val_accuracy50: 0.3538 - 13s/epoch - 46ms/step
Epoch 4/50
286/286 - 13s - loss: 3.3041 - accuracy50: 0.3565 - val_loss: 3.3147 - val_accuracy50: 0.3609 - 13s/epoch - 44ms/step
Epoch 5/50
286/286 - 13s - loss: 3.2953 - accuracy50: 0.3570 - val_loss: 3.2965 - val_accuracy50: 0.3697 - 13s/epoch - 44ms/step
Epoch 6/50
286/286 - 13s - loss: 3.2944 - accuracy50: 0.3575 - val_loss: 3.2694 - val_accuracy50: 0.3818 - 13s/epoch - 44ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2810 - accuracy50: 0.3680 - val_loss: 3.2809 - val_accuracy50: 0.3834 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2766 - accuracy50: 0.3691 - val_loss: 3.2924 - val_accuracy50: 0.3759 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 12s - loss: 3.2622 - accuracy50: 0.3835 - val_loss: 3.2679 - val_accuracy50: 0.3865 - 12s/epoch - 43ms/step
Epoch 10/50
286/286 - 12s - loss: 3.2489 - accuracy50: 0.3949 - val_loss: 3.2612 - val_accuracy50: 0.3876 - 12s/epoch - 43ms/step
Epoch 11/50
286/286 - 12s - loss: 3.2424 - accuracy50: 0.3974 - val_loss: 3.2501 - val_accuracy50: 0.3952 - 12s/epoch - 43ms/step
Epoch 12/50
286/286 - 12s - loss: 3.2325 - accuracy50: 0.4030 - val_loss: 3.2699 - val_accuracy50: 0.3801 - 12s/epoch - 43ms/step
Epoch 13/50
286/286 - 12s - loss: 3.2245 - accuracy50: 0.4100 - val_loss: 3.3127 - val_accuracy50: 0.3902 - 12s/epoch - 43ms/step
Epoch 14/50
286/286 - 12s - loss: 3.2216 - accuracy50: 0.4110 - val_loss: 3.3220 - val_accuracy50: 0.3840 - 12s/epoch - 44ms/step
Epoch 15/50
286/286 - 13s - loss: 3.2144 - accuracy50: 0.4142 - val_loss: 3.3143 - val_accuracy50: 0.3837 - 13s/epoch - 44ms/step
Epoch 16/50
286/286 - 12s - loss: 3.2082 - accuracy50: 0.4174 - val_loss: 3.3310 - val_accuracy50: 0.3777 - 12s/epoch - 43ms/step
Epoch 17/50
286/286 - 12s - loss: 3.2038 - accuracy50: 0.4198 - val_loss: 3.3555 - val_accuracy50: 0.3777 - 12s/epoch - 43ms/step
Epoch 18/50
286/286 - 12s - loss: 3.1976 - accuracy50: 0.4222 - val_loss: 3.3182 - val_accuracy50: 0.3831 - 12s/epoch - 43ms/step
Epoch 19/50
286/286 - 12s - loss: 3.1961 - accuracy50: 0.4233 - val_loss: 3.3199 - val_accuracy50: 0.3800 - 12s/epoch - 43ms/step
Epoch 20/50
286/286 - 12s - loss: 3.1894 - accuracy50: 0.4261 - val_loss: 3.3413 - val_accuracy50: 0.3764 - 12s/epoch - 44ms/step
Epoch 21/50
286/286 - 12s - loss: 3.1830 - accuracy50: 0.4310 - val_loss: 3.3168 - val_accuracy50: 0.3883 - 12s/epoch - 44ms/step
testing model: results/XRAY/W2/deepVOL_L3/h50
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0828639
{'0': {'precision': 0.394732370433305, 'recall': 0.3271511986913519, 'f1-score': 0.3577783833094412, 'support': 92309}, '1': {'precision': 0.38447987943955686, 'recall': 0.46957505813881184, 'f1-score': 0.42278816923171664, 'support': 80411}, '2': {'precision': 0.4364623115577889, 'recall': 0.42789157872956757, 'f1-score': 0.4321344524436175, 'support': 101493}, 'accuracy': 0.4062024776359983, 'macro avg': {'precision': 0.40522485381021695, 'recall': 0.4082059451865771, 'f1-score': 0.4042336683282584, 'support': 274213}, 'weighted avg': {'precision': 0.40717118209157416, 'recall': 0.4062024776359983, 'f1-score': 0.4043630544243447, 'support': 274213}}
[[30199 30593 31517]
 [18097 37759 24555]
 [28209 29856 43428]]
Evaluating performance on  train set...
286/286 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797323
{'0': {'precision': 0.4113356074521123, 'recall': 0.31997060744611366, 'f1-score': 0.3599458106587679, 'support': 24496}, '1': {'precision': 0.39587223903664115, 'recall': 0.5056757423706506, 'f1-score': 0.4440872643213177, 'support': 24314}, '2': {'precision': 0.40313222527592374, 'recall': 0.3814496821596632, 'f1-score': 0.39199134658211204, 'support': 24226}, 'accuracy': 0.40218522372528615, 'macro avg': {'precision': 0.40344669058822574, 'recall': 0.40236534399214247, 'f1-score': 0.39867480718739917, 'support': 73036}, 'weighted avg': {'precision': 0.4034667280466943, 'recall': 0.40218522372528615, 'f1-score': 0.3985863503601504, 'support': 73036}}
[[ 7838  9537  7121]
 [ 5458 12295  6561]
 [ 5759  9226  9241]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0848712
{'0': {'precision': 0.3839887640449438, 'recall': 0.2867631634151458, 'f1-score': 0.3283295304431368, 'support': 9534}, '1': {'precision': 0.3900947932408298, 'recall': 0.5546981832389138, 'f1-score': 0.4580577512502017, 'support': 10238}, '2': {'precision': 0.4097896937646046, 'recall': 0.33197170469263726, 'f1-score': 0.3667987670629678, 'support': 10037}, 'accuracy': 0.39400852091650174, 'macro avg': {'precision': 0.39462441701679274, 'recall': 0.39114435044889895, 'f1-score': 0.3843953495854355, 'support': 29809}, 'weighted avg': {'precision': 0.39477334113588, 'recall': 0.39400852091650174, 'f1-score': 0.3858381101531564, 'support': 29809}}
[[2734 4403 2397]
 [2157 5679 2402]
 [2229 4476 3332]]
training model: results/XRAY/W2/deepVOL_L3/h100
Epoch 1/50
286/286 - 15s - loss: 3.3449 - accuracy100: 0.3448 - val_loss: 3.3325 - val_accuracy100: 0.3366 - 15s/epoch - 53ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3126 - accuracy100: 0.3494 - val_loss: 3.3137 - val_accuracy100: 0.3405 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 13s - loss: 3.3017 - accuracy100: 0.3509 - val_loss: 3.3009 - val_accuracy100: 0.3535 - 13s/epoch - 46ms/step
Epoch 4/50
286/286 - 13s - loss: 3.2973 - accuracy100: 0.3526 - val_loss: 3.2900 - val_accuracy100: 0.3602 - 13s/epoch - 47ms/step
Epoch 5/50
286/286 - 13s - loss: 3.2915 - accuracy100: 0.3560 - val_loss: 3.2921 - val_accuracy100: 0.3553 - 13s/epoch - 44ms/step
Epoch 6/50
286/286 - 13s - loss: 3.2911 - accuracy100: 0.3611 - val_loss: 3.2925 - val_accuracy100: 0.3579 - 13s/epoch - 45ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2841 - accuracy100: 0.3632 - val_loss: 3.2938 - val_accuracy100: 0.3590 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2765 - accuracy100: 0.3726 - val_loss: 3.3007 - val_accuracy100: 0.3547 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 13s - loss: 3.2767 - accuracy100: 0.3743 - val_loss: 3.2972 - val_accuracy100: 0.3605 - 13s/epoch - 46ms/step
Epoch 10/50
286/286 - 12s - loss: 3.2667 - accuracy100: 0.3807 - val_loss: 3.3112 - val_accuracy100: 0.3566 - 12s/epoch - 43ms/step
Epoch 11/50
286/286 - 13s - loss: 3.2616 - accuracy100: 0.3826 - val_loss: 3.3186 - val_accuracy100: 0.3559 - 13s/epoch - 44ms/step
Epoch 12/50
286/286 - 13s - loss: 3.2564 - accuracy100: 0.3887 - val_loss: 3.3098 - val_accuracy100: 0.3597 - 13s/epoch - 47ms/step
Epoch 13/50
286/286 - 12s - loss: 3.2497 - accuracy100: 0.3918 - val_loss: 3.3134 - val_accuracy100: 0.3552 - 12s/epoch - 43ms/step
Epoch 14/50
286/286 - 13s - loss: 3.2441 - accuracy100: 0.3967 - val_loss: 3.3258 - val_accuracy100: 0.3506 - 13s/epoch - 45ms/step
testing model: results/XRAY/W2/deepVOL_L3/h100
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102953
{'0': {'precision': 0.3495913051288961, 'recall': 0.17060261032514, 'f1-score': 0.22930367860956657, 'support': 91253}, '1': {'precision': 0.3077281647263289, 'recall': 0.6652194466560509, 'f1-score': 0.4207970851973826, 'support': 80384}, '2': {'precision': 0.3889544657867439, 'recall': 0.21201840586491966, 'f1-score': 0.2744400277620039, 'support': 102576}, 'accuracy': 0.331089335662423, 'macro avg': {'precision': 0.34875797854732293, 'recall': 0.3492801542820369, 'f1-score': 0.30818026385631764, 'support': 274213}, 'weighted avg': {'precision': 0.352044102368704, 'recall': 0.331089335662423, 'f1-score': 0.30232323693034424, 'support': 274213}}
[[15568 56438 19247]
 [11992 53473 14919]
 [16972 63856 21748]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0995734
{'0': {'precision': 0.3714999569225467, 'recall': 0.1745042492917847, 'f1-score': 0.23746454828317315, 'support': 24710}, '1': {'precision': 0.342803148298133, 'recall': 0.6832933189833595, 'f1-score': 0.4565557107494019, 'support': 24158}, '2': {'precision': 0.34234709249774026, 'recall': 0.18805858987090368, 'f1-score': 0.24276252537122103, 'support': 24168}, 'accuracy': 0.3472807930335725, 'macro avg': {'precision': 0.35221673257280667, 'recall': 0.348618719382016, 'f1-score': 0.31226092813459866, 'support': 73036}, 'weighted avg': {'precision': 0.3523611222359907, 'recall': 0.3472807930335725, 'f1-score': 0.3116861076939171, 'support': 73036}}
[[ 4312 15731  4667]
 [ 3587 16507  4064]
 [ 3708 15915  4545]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975349
{'0': {'precision': 0.3493866424352567, 'recall': 0.16184362832789645, 'f1-score': 0.221215390147429, 'support': 9503}, '1': {'precision': 0.3624858423203821, 'recall': 0.7063621533442088, 'f1-score': 0.4791070033845353, 'support': 10421}, '2': {'precision': 0.3333333333333333, 'recall': 0.1719777440566515, 'f1-score': 0.22689356022689355, 'support': 9885}, 'accuracy': 0.35556375591264383, 'macro avg': {'precision': 0.3484019393629907, 'recall': 0.3467278419095856, 'f1-score': 0.309071984586286, 'support': 29809}, 'weighted avg': {'precision': 0.3486425651945032, 'recall': 0.35556375591264383, 'f1-score': 0.31325528456788565, 'support': 29809}}
[[1538 6170 1795]
 [1455 7361 1605]
 [1409 6776 1700]]
training model: results/XRAY/W2/deepVOL_L3/h200
Epoch 1/50
286/286 - 15s - loss: 3.3243 - accuracy200: 0.3674 - val_loss: 3.5081 - val_accuracy200: 0.3328 - 15s/epoch - 54ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3118 - accuracy200: 0.3642 - val_loss: 3.3890 - val_accuracy200: 0.3359 - 13s/epoch - 45ms/step
Epoch 3/50
286/286 - 13s - loss: 3.2958 - accuracy200: 0.3681 - val_loss: 3.4066 - val_accuracy200: 0.3314 - 13s/epoch - 46ms/step
Epoch 4/50
286/286 - 13s - loss: 3.2970 - accuracy200: 0.3570 - val_loss: 3.4038 - val_accuracy200: 0.3313 - 13s/epoch - 44ms/step
Epoch 5/50
286/286 - 13s - loss: 3.2968 - accuracy200: 0.3569 - val_loss: 3.3225 - val_accuracy200: 0.3423 - 13s/epoch - 45ms/step
Epoch 6/50
286/286 - 12s - loss: 3.2953 - accuracy200: 0.3521 - val_loss: 3.2997 - val_accuracy200: 0.3503 - 12s/epoch - 44ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2864 - accuracy200: 0.3615 - val_loss: 3.2927 - val_accuracy200: 0.3564 - 12s/epoch - 44ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2810 - accuracy200: 0.3658 - val_loss: 3.2887 - val_accuracy200: 0.3643 - 12s/epoch - 44ms/step
Epoch 9/50
286/286 - 12s - loss: 3.2747 - accuracy200: 0.3710 - val_loss: 3.2890 - val_accuracy200: 0.3633 - 12s/epoch - 43ms/step
Epoch 10/50
286/286 - 12s - loss: 3.2691 - accuracy200: 0.3762 - val_loss: 3.3009 - val_accuracy200: 0.3555 - 12s/epoch - 43ms/step
Epoch 11/50
286/286 - 12s - loss: 3.2686 - accuracy200: 0.3750 - val_loss: 3.3100 - val_accuracy200: 0.3473 - 12s/epoch - 43ms/step
Epoch 12/50
286/286 - 13s - loss: 3.2639 - accuracy200: 0.3788 - val_loss: 3.3443 - val_accuracy200: 0.3449 - 13s/epoch - 44ms/step
Epoch 13/50
286/286 - 12s - loss: 3.2620 - accuracy200: 0.3807 - val_loss: 3.2846 - val_accuracy200: 0.3717 - 12s/epoch - 44ms/step
Epoch 14/50
286/286 - 12s - loss: 3.2588 - accuracy200: 0.3828 - val_loss: 3.2935 - val_accuracy200: 0.3694 - 12s/epoch - 43ms/step
Epoch 15/50
286/286 - 12s - loss: 3.2469 - accuracy200: 0.3911 - val_loss: 3.2912 - val_accuracy200: 0.3748 - 12s/epoch - 44ms/step
Epoch 16/50
286/286 - 12s - loss: 3.2443 - accuracy200: 0.3922 - val_loss: 3.3009 - val_accuracy200: 0.3675 - 12s/epoch - 43ms/step
Epoch 17/50
286/286 - 13s - loss: 3.2403 - accuracy200: 0.3927 - val_loss: 3.2974 - val_accuracy200: 0.3688 - 13s/epoch - 44ms/step
Epoch 18/50
286/286 - 13s - loss: 3.2481 - accuracy200: 0.3913 - val_loss: 3.3052 - val_accuracy200: 0.3747 - 13s/epoch - 47ms/step
Epoch 19/50
286/286 - 13s - loss: 3.2389 - accuracy200: 0.3959 - val_loss: 3.3063 - val_accuracy200: 0.3717 - 13s/epoch - 44ms/step
Epoch 20/50
286/286 - 13s - loss: 3.2236 - accuracy200: 0.4051 - val_loss: 3.3102 - val_accuracy200: 0.3736 - 13s/epoch - 45ms/step
Epoch 21/50
286/286 - 12s - loss: 3.2179 - accuracy200: 0.4047 - val_loss: 3.3105 - val_accuracy200: 0.3746 - 12s/epoch - 44ms/step
Epoch 22/50
286/286 - 13s - loss: 3.2056 - accuracy200: 0.4144 - val_loss: 3.3291 - val_accuracy200: 0.3728 - 13s/epoch - 44ms/step
Epoch 23/50
286/286 - 12s - loss: 3.1970 - accuracy200: 0.4196 - val_loss: 3.3368 - val_accuracy200: 0.3728 - 12s/epoch - 43ms/step
testing model: results/XRAY/W2/deepVOL_L3/h200
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952703
{'0': {'precision': 0.37425074741167286, 'recall': 0.280749047119262, 'f1-score': 0.3208261791738208, 'support': 90515}, '1': {'precision': 0.35125120589353054, 'recall': 0.5882547337241895, 'f1-score': 0.4398592406499824, 'support': 81701}, '2': {'precision': 0.39875366990961947, 'recall': 0.27164524446797456, 'f1-score': 0.32314950344353016, 'support': 101997}, 'accuracy': 0.36898323565987023, 'macro avg': {'precision': 0.37475187440494095, 'recall': 0.38021634177047536, 'f1-score': 0.36127830775577774, 'support': 274213}, 'weighted avg': {'precision': 0.3765122705504348, 'recall': 0.36898323565987023, 'f1-score': 0.35715593837999055, 'support': 274213}}
[[25412 41490 23613]
 [15476 48061 18164]
 [27013 47277 27707]]
Evaluating performance on  train set...
286/286 - 7s - 7s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091568
{'0': {'precision': 0.3961684180427479, 'recall': 0.2210698472216682, 'f1-score': 0.2837830918121768, 'support': 25069}, '1': {'precision': 0.3721325805003662, 'recall': 0.6656524678837052, 'f1-score': 0.4773839649659813, 'support': 23664}, '2': {'precision': 0.37301112573274314, 'recall': 0.2565938361519154, 'f1-score': 0.30403939445649786, 'support': 24303}, 'accuracy': 0.37693740073388465, 'macro avg': {'precision': 0.3804373747586191, 'recall': 0.38110538375242964, 'f1-score': 0.35506881707821863, 'support': 73036}, 'weighted avg': {'precision': 0.3806750211615802, 'recall': 0.37693740073388465, 'f1-score': 0.3532510252350992, 'support': 73036}}
[[ 5542 13518  6009]
 [ 3439 15752  4473]
 [ 5008 13059  6236]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976514
{'0': {'precision': 0.3785517873510541, 'recall': 0.21082184788157224, 'f1-score': 0.27081967213114755, 'support': 9795}, '1': {'precision': 0.3746531513675746, 'recall': 0.6703820042557503, 'f1-score': 0.4806742226097066, 'support': 9869}, '2': {'precision': 0.341747572815534, 'recall': 0.2255298176441597, 'f1-score': 0.2717339667458432, 'support': 10145}, 'accuracy': 0.3679761145962629, 'macro avg': {'precision': 0.3649841705113876, 'recall': 0.3689112232604941, 'f1-score': 0.34107595382889916, 'support': 29809}, 'weighted avg': {'precision': 0.3647353428214217, 'recall': 0.3679761145962629, 'f1-score': 0.34060832916556627, 'support': 29809}}
[[2065 5229 2501]
 [1347 6616 1906]
 [2043 5814 2288]]
training model: results/XRAY/W2/deepVOL_L3/h300
Epoch 1/50
286/286 - 15s - loss: 3.3380 - accuracy300: 0.3520 - val_loss: 3.4513 - val_accuracy300: 0.3268 - 15s/epoch - 52ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3095 - accuracy300: 0.3568 - val_loss: 3.4236 - val_accuracy300: 0.3257 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 13s - loss: 3.2925 - accuracy300: 0.3638 - val_loss: 3.3606 - val_accuracy300: 0.3389 - 13s/epoch - 45ms/step
Epoch 4/50
286/286 - 12s - loss: 3.2956 - accuracy300: 0.3631 - val_loss: 3.3760 - val_accuracy300: 0.3351 - 12s/epoch - 43ms/step
Epoch 5/50
286/286 - 12s - loss: 3.2864 - accuracy300: 0.3637 - val_loss: 3.3677 - val_accuracy300: 0.3373 - 12s/epoch - 43ms/step
Epoch 6/50
286/286 - 12s - loss: 3.2866 - accuracy300: 0.3668 - val_loss: 3.3644 - val_accuracy300: 0.3361 - 12s/epoch - 44ms/step
Epoch 7/50
286/286 - 13s - loss: 3.2897 - accuracy300: 0.3660 - val_loss: 3.3502 - val_accuracy300: 0.3399 - 13s/epoch - 45ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2797 - accuracy300: 0.3715 - val_loss: 3.3625 - val_accuracy300: 0.3346 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 13s - loss: 3.2744 - accuracy300: 0.3763 - val_loss: 3.3461 - val_accuracy300: 0.3425 - 13s/epoch - 44ms/step
Epoch 10/50
286/286 - 13s - loss: 3.2681 - accuracy300: 0.3816 - val_loss: 3.3410 - val_accuracy300: 0.3474 - 13s/epoch - 44ms/step
Epoch 11/50
286/286 - 12s - loss: 3.2612 - accuracy300: 0.3838 - val_loss: 3.3503 - val_accuracy300: 0.3439 - 12s/epoch - 43ms/step
Epoch 12/50
286/286 - 13s - loss: 3.2526 - accuracy300: 0.3920 - val_loss: 3.3355 - val_accuracy300: 0.3577 - 13s/epoch - 44ms/step
Epoch 13/50
286/286 - 12s - loss: 3.2491 - accuracy300: 0.3948 - val_loss: 3.3558 - val_accuracy300: 0.3493 - 12s/epoch - 44ms/step
Epoch 14/50
286/286 - 13s - loss: 3.2388 - accuracy300: 0.4029 - val_loss: 3.3552 - val_accuracy300: 0.3520 - 13s/epoch - 44ms/step
Epoch 15/50
286/286 - 12s - loss: 3.2351 - accuracy300: 0.4056 - val_loss: 3.3596 - val_accuracy300: 0.3506 - 12s/epoch - 44ms/step
Epoch 16/50
286/286 - 12s - loss: 3.2301 - accuracy300: 0.4067 - val_loss: 3.3634 - val_accuracy300: 0.3532 - 12s/epoch - 44ms/step
Epoch 17/50
286/286 - 13s - loss: 3.2201 - accuracy300: 0.4121 - val_loss: 3.3929 - val_accuracy300: 0.3564 - 13s/epoch - 44ms/step
Epoch 18/50
286/286 - 12s - loss: 3.2132 - accuracy300: 0.4145 - val_loss: 3.4073 - val_accuracy300: 0.3594 - 12s/epoch - 44ms/step
Epoch 19/50
286/286 - 12s - loss: 3.2100 - accuracy300: 0.4165 - val_loss: 3.4315 - val_accuracy300: 0.3554 - 12s/epoch - 44ms/step
Epoch 20/50
286/286 - 12s - loss: 3.2071 - accuracy300: 0.4187 - val_loss: 3.4446 - val_accuracy300: 0.3517 - 12s/epoch - 44ms/step
Epoch 21/50
286/286 - 12s - loss: 3.2006 - accuracy300: 0.4177 - val_loss: 3.4498 - val_accuracy300: 0.3585 - 12s/epoch - 43ms/step
Epoch 22/50
286/286 - 12s - loss: 3.2014 - accuracy300: 0.4216 - val_loss: 3.4819 - val_accuracy300: 0.3592 - 12s/epoch - 43ms/step
testing model: results/XRAY/W2/deepVOL_L3/h300
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128778
{'0': {'precision': 0.3652448591956396, 'recall': 0.1966125429266829, 'f1-score': 0.2556225842574865, 'support': 89979}, '1': {'precision': 0.322066214971254, 'recall': 0.7020029994153681, 'f1-score': 0.44155501550858567, 'support': 78682}, '2': {'precision': 0.41982496545370795, 'recall': 0.21587463998787326, 'f1-score': 0.28513330038103696, 'support': 105552}, 'accuracy': 0.34904253262974405, 'macro avg': {'precision': 0.36904534654020055, 'recall': 0.3714967274433081, 'f1-score': 0.32743696671570305, 'support': 274213}, 'weighted avg': {'precision': 0.37386464487643706, 'recall': 0.34904253262974405, 'f1-score': 0.32033304898371023, 'support': 274213}}
[[17691 53269 19019]
 [10977 55235 12470]
 [19768 62998 22786]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984592
{'0': {'precision': 0.4131792629606496, 'recall': 0.16041548783445153, 'f1-score': 0.2311051589612204, 'support': 24742}, '1': {'precision': 0.3700252186933565, 'recall': 0.7716105176663928, 'f1-score': 0.5001864280387771, 'support': 24340}, '2': {'precision': 0.37265267476724, 'recall': 0.19716957501878601, 'f1-score': 0.2578901386917113, 'support': 23954}, 'accuracy': 0.3761569636891396, 'macro avg': {'precision': 0.385285718807082, 'recall': 0.3763985268398768, 'f1-score': 0.3297272418972363, 'support': 73036}, 'weighted avg': {'precision': 0.3855060150958864, 'recall': 0.3761569636891396, 'f1-score': 0.3295640763966209, 'support': 73036}}
[[ 3969 16082  4691]
 [ 2299 18781  3260]
 [ 3338 15893  4723]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117167
{'0': {'precision': 0.37224833044768735, 'recall': 0.15539494062983997, 'f1-score': 0.21925990675990678, 'support': 9685}, '1': {'precision': 0.35042528513435145, 'recall': 0.7499224325162892, 'f1-score': 0.47765225124337146, 'support': 9669}, '2': {'precision': 0.3746551044540796, 'recall': 0.18182687709230033, 'f1-score': 0.24483224933994463, 'support': 10455}, 'accuracy': 0.35750947700358954, 'macro avg': {'precision': 0.36577624001203946, 'recall': 0.36238141674614316, 'f1-score': 0.31391480244774095, 'support': 29809}, 'weighted avg': {'precision': 0.36601383070271726, 'recall': 0.35750947700358954, 'f1-score': 0.3120424362135924, 'support': 29809}}
[[1505 6365 1815]
 [1060 7251 1358]
 [1478 7076 1901]]
training model: results/XRAY/W2/deepVOL_L3/h500
Epoch 1/50
286/286 - 15s - loss: 3.3499 - accuracy500: 0.3546 - val_loss: 3.4425 - val_accuracy500: 0.3287 - 15s/epoch - 52ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3046 - accuracy500: 0.3571 - val_loss: 3.4530 - val_accuracy500: 0.3263 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 12s - loss: 3.3045 - accuracy500: 0.3498 - val_loss: 3.3924 - val_accuracy500: 0.3267 - 12s/epoch - 43ms/step
Epoch 4/50
286/286 - 13s - loss: 3.2926 - accuracy500: 0.3560 - val_loss: 3.3881 - val_accuracy500: 0.3281 - 13s/epoch - 46ms/step
Epoch 5/50
286/286 - 13s - loss: 3.2864 - accuracy500: 0.3633 - val_loss: 3.3794 - val_accuracy500: 0.3304 - 13s/epoch - 44ms/step
Epoch 6/50
286/286 - 13s - loss: 3.2816 - accuracy500: 0.3660 - val_loss: 3.4070 - val_accuracy500: 0.3330 - 13s/epoch - 46ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2783 - accuracy500: 0.3731 - val_loss: 3.3939 - val_accuracy500: 0.3363 - 12s/epoch - 43ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2712 - accuracy500: 0.3771 - val_loss: 3.4163 - val_accuracy500: 0.3383 - 12s/epoch - 43ms/step
Epoch 9/50
286/286 - 13s - loss: 3.2637 - accuracy500: 0.3855 - val_loss: 3.4343 - val_accuracy500: 0.3379 - 13s/epoch - 46ms/step
Epoch 10/50
286/286 - 13s - loss: 3.2540 - accuracy500: 0.3920 - val_loss: 3.4118 - val_accuracy500: 0.3380 - 13s/epoch - 44ms/step
Epoch 11/50
286/286 - 13s - loss: 3.2481 - accuracy500: 0.3976 - val_loss: 3.4493 - val_accuracy500: 0.3442 - 13s/epoch - 44ms/step
Epoch 12/50
286/286 - 12s - loss: 3.2388 - accuracy500: 0.4017 - val_loss: 3.4426 - val_accuracy500: 0.3486 - 12s/epoch - 43ms/step
Epoch 13/50
286/286 - 12s - loss: 3.2308 - accuracy500: 0.4077 - val_loss: 3.4476 - val_accuracy500: 0.3358 - 12s/epoch - 43ms/step
Epoch 14/50
286/286 - 12s - loss: 3.2246 - accuracy500: 0.4115 - val_loss: 3.4921 - val_accuracy500: 0.3411 - 12s/epoch - 44ms/step
Epoch 15/50
286/286 - 12s - loss: 3.2093 - accuracy500: 0.4191 - val_loss: 3.4680 - val_accuracy500: 0.3400 - 12s/epoch - 44ms/step
testing model: results/XRAY/W2/deepVOL_L3/h500
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1292315
{'0': {'precision': 0.348458904109589, 'recall': 0.023185070409697854, 'f1-score': 0.04347733196598726, 'support': 87772}, '1': {'precision': 0.29002779431448905, 'recall': 0.9717447370761393, 'f1-score': 0.44672550038839604, 'support': 78711}, '2': {'precision': 0.44516129032258067, 'recall': 0.01921470342522974, 'f1-score': 0.03683929524826481, 'support': 107730}, 'accuracy': 0.2939029148873321, 'macro avg': {'precision': 0.3612159962488863, 'recall': 0.338048170303689, 'f1-score': 0.17568070920088272, 'support': 274213}, 'weighted avg': {'precision': 0.3696780913240663, 'recall': 0.2939029148873321, 'f1-score': 0.15661912644362316, 'support': 274213}}
[[  2035  84135   1602]
 [  1246  76487    978]
 [  2559 103101   2070]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084181
{'0': {'precision': 0.36024844720496896, 'recall': 0.019042147166249437, 'f1-score': 0.03617228610407328, 'support': 24367}, '1': {'precision': 0.346218582481153, 'recall': 0.9758411736565141, 'f1-score': 0.511102991073759, 'support': 25084}, '2': {'precision': 0.3333333333333333, 'recall': 0.01479754080983676, 'f1-score': 0.028337122442351412, 'support': 23585}, 'accuracy': 0.3462812859411797, 'macro avg': {'precision': 0.3466001210064851, 'recall': 0.3365602872108668, 'f1-score': 0.1918707998733946, 'support': 73036}, 'weighted avg': {'precision': 0.3467384235536911, 'recall': 0.3462812859411797, 'f1-score': 0.19675568974745308, 'support': 73036}}
[[  464 23477   426]
 [  334 24478   272]
 [  490 22746   349]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1211296
{'0': {'precision': 0.38175675675675674, 'recall': 0.023478080199459798, 'f1-score': 0.044235662556273245, 'support': 9626}, '1': {'precision': 0.3282267330524703, 'recall': 0.9700555669890925, 'f1-score': 0.49049142797679446, 'support': 9718}, '2': {'precision': 0.3810483870967742, 'recall': 0.018060200668896322, 'f1-score': 0.03448590457075085, 'support': 10465}, 'accuracy': 0.3301687409842665, 'macro avg': {'precision': 0.3636772923020004, 'recall': 0.3371979492858162, 'f1-score': 0.18973766503460618, 'support': 29809}, 'weighted avg': {'precision': 0.36405680510289473, 'recall': 0.3301687409842665, 'f1-score': 0.18629619162595465, 'support': 29809}}
[[  226  9220   180]
 [  164  9427   127]
 [  202 10074   189]]
training model: results/XRAY/W2/deepVOL_L3/h1000
Epoch 1/50
286/286 - 15s - loss: 3.3366 - accuracy1000: 0.3641 - val_loss: 3.5414 - val_accuracy1000: 0.3006 - 15s/epoch - 52ms/step
Epoch 2/50
286/286 - 13s - loss: 3.3100 - accuracy1000: 0.3631 - val_loss: 3.5329 - val_accuracy1000: 0.2991 - 13s/epoch - 44ms/step
Epoch 3/50
286/286 - 13s - loss: 3.3133 - accuracy1000: 0.3614 - val_loss: 3.5193 - val_accuracy1000: 0.2981 - 13s/epoch - 44ms/step
Epoch 4/50
286/286 - 13s - loss: 3.3148 - accuracy1000: 0.3446 - val_loss: 3.4111 - val_accuracy1000: 0.2981 - 13s/epoch - 47ms/step
Epoch 5/50
286/286 - 13s - loss: 3.3061 - accuracy1000: 0.3339 - val_loss: 3.3777 - val_accuracy1000: 0.2993 - 13s/epoch - 46ms/step
Epoch 6/50
286/286 - 12s - loss: 3.3002 - accuracy1000: 0.3398 - val_loss: 3.3851 - val_accuracy1000: 0.3001 - 12s/epoch - 43ms/step
Epoch 7/50
286/286 - 12s - loss: 3.2952 - accuracy1000: 0.3510 - val_loss: 3.3669 - val_accuracy1000: 0.3068 - 12s/epoch - 44ms/step
Epoch 8/50
286/286 - 12s - loss: 3.2874 - accuracy1000: 0.3578 - val_loss: 3.3522 - val_accuracy1000: 0.3248 - 12s/epoch - 44ms/step
Epoch 9/50
286/286 - 13s - loss: 3.2809 - accuracy1000: 0.3687 - val_loss: 3.3670 - val_accuracy1000: 0.3243 - 13s/epoch - 46ms/step
Epoch 10/50
286/286 - 12s - loss: 3.2760 - accuracy1000: 0.3708 - val_loss: 3.3627 - val_accuracy1000: 0.3314 - 12s/epoch - 44ms/step
Epoch 11/50
286/286 - 12s - loss: 3.2738 - accuracy1000: 0.3719 - val_loss: 3.3778 - val_accuracy1000: 0.3332 - 12s/epoch - 44ms/step
Epoch 12/50
286/286 - 12s - loss: 3.2595 - accuracy1000: 0.3829 - val_loss: 3.3925 - val_accuracy1000: 0.3366 - 12s/epoch - 43ms/step
Epoch 13/50
286/286 - 13s - loss: 3.2531 - accuracy1000: 0.3891 - val_loss: 3.4184 - val_accuracy1000: 0.3403 - 13s/epoch - 44ms/step
Epoch 14/50
286/286 - 12s - loss: 3.2451 - accuracy1000: 0.3926 - val_loss: 3.4193 - val_accuracy1000: 0.3439 - 12s/epoch - 43ms/step
Epoch 15/50
286/286 - 12s - loss: 3.2294 - accuracy1000: 0.4018 - val_loss: 3.4222 - val_accuracy1000: 0.3444 - 12s/epoch - 44ms/step
Epoch 16/50
286/286 - 13s - loss: 3.2230 - accuracy1000: 0.4059 - val_loss: 3.4509 - val_accuracy1000: 0.3406 - 13s/epoch - 44ms/step
Epoch 17/50
286/286 - 12s - loss: 3.2140 - accuracy1000: 0.4081 - val_loss: 3.4741 - val_accuracy1000: 0.3409 - 12s/epoch - 44ms/step
Epoch 18/50
286/286 - 12s - loss: 3.1992 - accuracy1000: 0.4190 - val_loss: 3.5022 - val_accuracy1000: 0.3404 - 12s/epoch - 44ms/step
testing model: results/XRAY/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031979
{'0': {'precision': 0.3625693789351293, 'recall': 0.1985344465133041, 'f1-score': 0.25657465768311233, 'support': 83245}, '1': {'precision': 0.31640739209775476, 'recall': 0.7823285263800775, 'f1-score': 0.4505805710593852, 'support': 80231}, '2': {'precision': 0.41343865679534636, 'recall': 0.11296134083459007, 'f1-score': 0.17744143326264428, 'support': 110737}, 'accuracy': 0.33478719097927523, 'macro avg': {'precision': 0.36413847594274346, 'recall': 0.3646081045759906, 'f1-score': 0.29486555400171394, 'support': 274213}, 'weighted avg': {'precision': 0.3696058391192105, 'recall': 0.33478719097927523, 'f1-score': 0.2813813319233649, 'support': 274213}}
[[16527 56701 10017]
 [ 9734 62767  7730]
 [19322 78906 12509]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0921289
{'0': {'precision': 0.4284112568673618, 'recall': 0.15719104821457955, 'f1-score': 0.22999367983868538, 'support': 24308}, '1': {'precision': 0.37310850952297747, 'recall': 0.8406692913385827, 'f1-score': 0.5168340796320949, 'support': 25400}, '2': {'precision': 0.3368665601858574, 'recall': 0.09945130315500686, 'f1-score': 0.15356610954823763, 'support': 23328}, 'accuracy': 0.37644449312667727, 'macro avg': {'precision': 0.3794621088587322, 'recall': 0.3657705475693897, 'f1-score': 0.30013128967300595, 'support': 73036}, 'weighted avg': {'precision': 0.37993866161661566, 'recall': 0.37644449312667727, 'f1-score': 0.3053379456119621, 'support': 73036}}
[[ 3821 17818  2669]
 [ 2149 21353  1898]
 [ 2949 18059  2320]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095346
{'0': {'precision': 0.4175990323556093, 'recall': 0.13919967745186976, 'f1-score': 0.20879951617780465, 'support': 9921}, '1': {'precision': 0.31165323091208375, 'recall': 0.8322813345356177, 'f1-score': 0.45349301397205594, 'support': 8872}, '2': {'precision': 0.3802064791740833, 'recall': 0.09694989106753812, 'f1-score': 0.15450271247739603, 'support': 11016}, 'accuracy': 0.3298668187460163, 'macro avg': {'precision': 0.36981958081392546, 'recall': 0.35614363435167523, 'f1-score': 0.2722650808757522, 'support': 29809}, 'weighted avg': {'precision': 0.3722480472083502, 'recall': 0.3298668187460163, 'f1-score': 0.2615616726696996, 'support': 29809}}
[[1381 7526 1014]
 [ 761 7384  727]
 [1165 8783 1068]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  11.38 (ave)

============================================
