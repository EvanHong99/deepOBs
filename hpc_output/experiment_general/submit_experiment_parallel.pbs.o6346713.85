This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-11-13.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-05.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-23.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-24.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-01.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-28.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-30.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-25.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-31.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-22.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-07.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-06.csv
training model: results/EXC/W8/deepLOB_L1/h10
Epoch 1/50
1289/1289 - 47s - loss: 2.6857 - accuracy10: 0.4562 - val_loss: 2.4117 - val_accuracy10: 0.5533 - 47s/epoch - 37ms/step
Epoch 2/50
1289/1289 - 21s - loss: 2.4775 - accuracy10: 0.5451 - val_loss: 2.3570 - val_accuracy10: 0.5347 - 21s/epoch - 16ms/step
Epoch 3/50
1289/1289 - 21s - loss: 2.3417 - accuracy10: 0.6094 - val_loss: 2.2862 - val_accuracy10: 0.6302 - 21s/epoch - 16ms/step
Epoch 4/50
1289/1289 - 21s - loss: 2.2786 - accuracy10: 0.6317 - val_loss: 2.2630 - val_accuracy10: 0.5643 - 21s/epoch - 16ms/step
Epoch 5/50
1289/1289 - 21s - loss: 2.2343 - accuracy10: 0.6419 - val_loss: 2.1782 - val_accuracy10: 0.6264 - 21s/epoch - 16ms/step
Epoch 6/50
1289/1289 - 21s - loss: 2.2067 - accuracy10: 0.6511 - val_loss: 2.1370 - val_accuracy10: 0.6125 - 21s/epoch - 16ms/step
Epoch 7/50
1289/1289 - 21s - loss: 2.1842 - accuracy10: 0.6570 - val_loss: 2.1448 - val_accuracy10: 0.6269 - 21s/epoch - 16ms/step
Epoch 8/50
1289/1289 - 21s - loss: 2.1678 - accuracy10: 0.6590 - val_loss: 2.1073 - val_accuracy10: 0.6294 - 21s/epoch - 16ms/step
Epoch 9/50
1289/1289 - 21s - loss: 2.1525 - accuracy10: 0.6616 - val_loss: 2.1124 - val_accuracy10: 0.6492 - 21s/epoch - 16ms/step
Epoch 10/50
1289/1289 - 21s - loss: 2.1386 - accuracy10: 0.6630 - val_loss: 2.1344 - val_accuracy10: 0.6335 - 21s/epoch - 16ms/step
Epoch 11/50
1289/1289 - 21s - loss: 2.1285 - accuracy10: 0.6633 - val_loss: 2.0971 - val_accuracy10: 0.6448 - 21s/epoch - 16ms/step
Epoch 12/50
1289/1289 - 21s - loss: 2.1173 - accuracy10: 0.6628 - val_loss: 2.0952 - val_accuracy10: 0.6293 - 21s/epoch - 16ms/step
Epoch 13/50
1289/1289 - 21s - loss: 2.1091 - accuracy10: 0.6644 - val_loss: 2.1142 - val_accuracy10: 0.6407 - 21s/epoch - 16ms/step
Epoch 14/50
1289/1289 - 21s - loss: 2.0988 - accuracy10: 0.6650 - val_loss: 2.1025 - val_accuracy10: 0.6252 - 21s/epoch - 16ms/step
Epoch 15/50
1289/1289 - 21s - loss: 2.0927 - accuracy10: 0.6651 - val_loss: 2.1245 - val_accuracy10: 0.6367 - 21s/epoch - 16ms/step
Epoch 16/50
1289/1289 - 21s - loss: 2.0857 - accuracy10: 0.6650 - val_loss: 2.1327 - val_accuracy10: 0.6156 - 21s/epoch - 16ms/step
Epoch 17/50
1289/1289 - 20s - loss: 2.0779 - accuracy10: 0.6650 - val_loss: 2.0963 - val_accuracy10: 0.6246 - 20s/epoch - 16ms/step
Epoch 18/50
1289/1289 - 20s - loss: 2.0717 - accuracy10: 0.6645 - val_loss: 2.1424 - val_accuracy10: 0.6212 - 20s/epoch - 15ms/step
Epoch 19/50
1289/1289 - 20s - loss: 2.0654 - accuracy10: 0.6653 - val_loss: 2.1292 - val_accuracy10: 0.6297 - 20s/epoch - 16ms/step
Epoch 20/50
1289/1289 - 20s - loss: 2.0591 - accuracy10: 0.6658 - val_loss: 2.1375 - val_accuracy10: 0.6218 - 20s/epoch - 16ms/step
Epoch 21/50
1289/1289 - 20s - loss: 2.0536 - accuracy10: 0.6653 - val_loss: 2.1185 - val_accuracy10: 0.6174 - 20s/epoch - 16ms/step
Epoch 22/50
1289/1289 - 21s - loss: 2.0475 - accuracy10: 0.6664 - val_loss: 2.1657 - val_accuracy10: 0.6226 - 21s/epoch - 16ms/step
testing model: results/EXC/W8/deepLOB_L1/h10
Evaluating performance on  test set...
5521/5521 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.757613
{'0': {'precision': 0.3256421819153556, 'recall': 0.6096302665520207, 'f1-score': 0.42452085590023575, 'support': 127930}, '1': {'precision': 0.9301221081312915, 'recall': 0.639566200559814, 'f1-score': 0.757952594104819, 'support': 1152883}, '2': {'precision': 0.26182316295522656, 'recall': 0.7530283704536707, 'f1-score': 0.3885499765368372, 'support': 132497}, 'accuracy': 0.6474934727695976, 'macro avg': {'precision': 0.5058624843339579, 'recall': 0.6674082791885017, 'f1-score': 0.523674475513964, 'support': 1413310}, 'weighted avg': {'precision': 0.8127531499410872, 'recall': 0.6474934727695976, 'f1-score': 0.6931397357167673, 'support': 1413310}}
[[ 77990  32652  17288]
 [151526 737345 264012]
 [  9980  22743  99774]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77633786
{'0': {'precision': 0.3151882160392799, 'recall': 0.5744198532482253, 'f1-score': 0.4070340075666307, 'support': 33526}, '1': {'precision': 0.9183924543776912, 'recall': 0.6316553782354981, 'f1-score': 0.7485027506029647, 'support': 262363}, '2': {'precision': 0.27465100191651265, 'recall': 0.7156703407109719, 'f1-score': 0.39696120371736243, 'support': 33841}, 'accuracy': 0.6344584963454948, 'macro avg': {'precision': 0.502743890777828, 'recall': 0.6405818573982318, 'f1-score': 0.517499320628986, 'support': 329730}, 'weighted avg': {'precision': 0.7909916119087854, 'recall': 0.6344584963454948, 'f1-score': 0.6777036162591324, 'support': 329730}}
[[ 19258   8193   6075]
 [ 38753 165723  57887]
 [  3089   6533  24219]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77076375
{'0': {'precision': 0.2804507470245632, 'recall': 0.6646994098229468, 'f1-score': 0.39446736517170755, 'support': 9997}, '1': {'precision': 0.9338630444100096, 'recall': 0.6146051446736029, 'f1-score': 0.7413223410867931, 'support': 92173}, '2': {'precision': 0.25748459586806816, 'recall': 0.7266775777414075, 'f1-score': 0.38023871969169837, 'support': 9776}, 'accuracy': 0.6288657031068551, 'macro avg': {'precision': 0.4905994624342136, 'recall': 0.6686607107459858, 'f1-score': 0.5053428086500663, 'support': 111946}, 'weighted avg': {'precision': 0.8164453747308043, 'recall': 0.6288657031068551, 'f1-score': 0.6788148582202185, 'support': 111946}}
[[ 6645  2238  1114]
 [16151 56650 19372]
 [  898  1774  7104]]
training model: results/EXC/W8/deepLOB_L1/h20
Epoch 1/50
1289/1289 - 23s - loss: 2.7290 - accuracy20: 0.4664 - val_loss: 2.5662 - val_accuracy20: 0.5334 - 23s/epoch - 18ms/step
Epoch 2/50
1289/1289 - 21s - loss: 2.5552 - accuracy20: 0.5256 - val_loss: 2.4216 - val_accuracy20: 0.4858 - 21s/epoch - 16ms/step
Epoch 3/50
1289/1289 - 21s - loss: 2.4216 - accuracy20: 0.5832 - val_loss: 2.3111 - val_accuracy20: 0.5561 - 21s/epoch - 16ms/step
Epoch 4/50
1289/1289 - 21s - loss: 2.3510 - accuracy20: 0.6077 - val_loss: 2.2826 - val_accuracy20: 0.5453 - 21s/epoch - 16ms/step
Epoch 5/50
1289/1289 - 21s - loss: 2.3069 - accuracy20: 0.6177 - val_loss: 2.2498 - val_accuracy20: 0.5682 - 21s/epoch - 16ms/step
Epoch 6/50
1289/1289 - 21s - loss: 2.2777 - accuracy20: 0.6236 - val_loss: 2.2504 - val_accuracy20: 0.5482 - 21s/epoch - 16ms/step
Epoch 7/50
1289/1289 - 22s - loss: 2.2526 - accuracy20: 0.6295 - val_loss: 2.2132 - val_accuracy20: 0.5788 - 22s/epoch - 17ms/step
Epoch 8/50
1289/1289 - 22s - loss: 2.2353 - accuracy20: 0.6311 - val_loss: 2.2069 - val_accuracy20: 0.5718 - 22s/epoch - 17ms/step
Epoch 9/50
1289/1289 - 22s - loss: 2.2195 - accuracy20: 0.6344 - val_loss: 2.2098 - val_accuracy20: 0.5845 - 22s/epoch - 17ms/step
Epoch 10/50
1289/1289 - 21s - loss: 2.2056 - accuracy20: 0.6359 - val_loss: 2.2239 - val_accuracy20: 0.5866 - 21s/epoch - 16ms/step
Epoch 11/50
1289/1289 - 21s - loss: 2.1942 - accuracy20: 0.6381 - val_loss: 2.2013 - val_accuracy20: 0.5966 - 21s/epoch - 16ms/step
Epoch 12/50
1289/1289 - 21s - loss: 2.1837 - accuracy20: 0.6406 - val_loss: 2.1976 - val_accuracy20: 0.6024 - 21s/epoch - 16ms/step
Epoch 13/50
1289/1289 - 21s - loss: 2.1742 - accuracy20: 0.6411 - val_loss: 2.1711 - val_accuracy20: 0.6157 - 21s/epoch - 16ms/step
Epoch 14/50
1289/1289 - 21s - loss: 2.1662 - accuracy20: 0.6419 - val_loss: 2.1842 - val_accuracy20: 0.5971 - 21s/epoch - 16ms/step
Epoch 15/50
1289/1289 - 23s - loss: 2.1578 - accuracy20: 0.6419 - val_loss: 2.1964 - val_accuracy20: 0.5972 - 23s/epoch - 18ms/step
Epoch 16/50
1289/1289 - 20s - loss: 2.1510 - accuracy20: 0.6427 - val_loss: 2.1810 - val_accuracy20: 0.6011 - 20s/epoch - 16ms/step
Epoch 17/50
1289/1289 - 20s - loss: 2.1460 - accuracy20: 0.6441 - val_loss: 2.2008 - val_accuracy20: 0.5998 - 20s/epoch - 16ms/step
Epoch 18/50
1289/1289 - 20s - loss: 2.1389 - accuracy20: 0.6437 - val_loss: 2.1612 - val_accuracy20: 0.5975 - 20s/epoch - 15ms/step
Epoch 19/50
1289/1289 - 20s - loss: 2.1337 - accuracy20: 0.6449 - val_loss: 2.1453 - val_accuracy20: 0.6010 - 20s/epoch - 16ms/step
Epoch 20/50
1289/1289 - 20s - loss: 2.1278 - accuracy20: 0.6441 - val_loss: 2.1542 - val_accuracy20: 0.5967 - 20s/epoch - 16ms/step
Epoch 21/50
1289/1289 - 20s - loss: 2.1232 - accuracy20: 0.6454 - val_loss: 2.1486 - val_accuracy20: 0.6050 - 20s/epoch - 15ms/step
Epoch 22/50
1289/1289 - 20s - loss: 2.1153 - accuracy20: 0.6459 - val_loss: 2.1565 - val_accuracy20: 0.5898 - 20s/epoch - 15ms/step
Epoch 23/50
1289/1289 - 20s - loss: 2.1118 - accuracy20: 0.6465 - val_loss: 2.1398 - val_accuracy20: 0.6110 - 20s/epoch - 16ms/step
Epoch 24/50
1289/1289 - 20s - loss: 2.1083 - accuracy20: 0.6466 - val_loss: 2.1414 - val_accuracy20: 0.5921 - 20s/epoch - 15ms/step
Epoch 25/50
1289/1289 - 20s - loss: 2.1027 - accuracy20: 0.6474 - val_loss: 2.1611 - val_accuracy20: 0.5839 - 20s/epoch - 16ms/step
Epoch 26/50
1289/1289 - 20s - loss: 2.0972 - accuracy20: 0.6472 - val_loss: 2.1615 - val_accuracy20: 0.5863 - 20s/epoch - 16ms/step
Epoch 27/50
1289/1289 - 20s - loss: 2.0932 - accuracy20: 0.6465 - val_loss: 2.1434 - val_accuracy20: 0.5849 - 20s/epoch - 16ms/step
Epoch 28/50
1289/1289 - 20s - loss: 2.0882 - accuracy20: 0.6479 - val_loss: 2.1595 - val_accuracy20: 0.5772 - 20s/epoch - 15ms/step
Epoch 29/50
1289/1289 - 20s - loss: 2.0867 - accuracy20: 0.6468 - val_loss: 2.1577 - val_accuracy20: 0.5789 - 20s/epoch - 15ms/step
Epoch 30/50
1289/1289 - 20s - loss: 2.0822 - accuracy20: 0.6489 - val_loss: 2.1734 - val_accuracy20: 0.5649 - 20s/epoch - 15ms/step
Epoch 31/50
1289/1289 - 20s - loss: 2.0782 - accuracy20: 0.6492 - val_loss: 2.1595 - val_accuracy20: 0.5741 - 20s/epoch - 15ms/step
Epoch 32/50
1289/1289 - 20s - loss: 2.0738 - accuracy20: 0.6486 - val_loss: 2.1517 - val_accuracy20: 0.5732 - 20s/epoch - 15ms/step
Epoch 33/50
1289/1289 - 20s - loss: 2.0694 - accuracy20: 0.6495 - val_loss: 2.1545 - val_accuracy20: 0.5771 - 20s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h20
Evaluating performance on  test set...
5521/5521 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7527409
{'0': {'precision': 0.38670279860313134, 'recall': 0.5845592395609369, 'f1-score': 0.46547828496381016, 'support': 176740}, '1': {'precision': 0.8880022087361887, 'recall': 0.6350090458481171, 'f1-score': 0.7404928014592997, 'support': 1053522}, '2': {'precision': 0.35069722916014245, 'recall': 0.7524966129102749, 'f1-score': 0.478426305579724, 'support': 183048}, 'accuracy': 0.6439167627767439, 'macro avg': {'precision': 0.5418007454998208, 'recall': 0.657354966106443, 'f1-score': 0.5614657973342779, 'support': 1413310}, 'weighted avg': {'precision': 0.7557224826687636, 'recall': 0.6439167627767439, 'f1-score': 0.6721590221871107, 'support': 1413310}}
[[103315  49581  23844]
 [153344 668996 231182]
 [ 10510  34795 137743]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78511786
{'0': {'precision': 0.3885916932139208, 'recall': 0.5707097457627118, 'f1-score': 0.4623636688718041, 'support': 45312}, '1': {'precision': 0.8786382194126169, 'recall': 0.6145423789844787, 'f1-score': 0.7232352499143834, 'support': 238833}, '2': {'precision': 0.34162020470999416, 'recall': 0.7204562904464188, 'f1-score': 0.46347400879192213, 'support': 45585}, 'accuracy': 0.6231613744578898, 'macro avg': {'precision': 0.5362833724455106, 'recall': 0.6352361383978699, 'f1-score': 0.5496909758593699, 'support': 329730}, 'weighted avg': {'precision': 0.7370528180377515, 'recall': 0.6231613744578898, 'f1-score': 0.6514740232842049, 'support': 329730}}
[[ 25860  11422   8030]
 [ 36796 146773  55264]
 [  3892   8851  32842]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7910638
{'0': {'precision': 0.3716373882798397, 'recall': 0.6140695475047286, 'f1-score': 0.463040675827642, 'support': 13746}, '1': {'precision': 0.8978643375106241, 'recall': 0.5859631316826776, 'f1-score': 0.7091328472574322, 'support': 84734}, '2': {'precision': 0.3059468379796075, 'recall': 0.770978761324818, 'f1-score': 0.4380590717299578, 'support': 13466}, 'accuracy': 0.6116699122791346, 'macro avg': {'precision': 0.5251495212566905, 'recall': 0.6570038135040747, 'f1-score': 0.5367441982716773, 'support': 111946}, 'weighted avg': {'precision': 0.7620463833826425, 'recall': 0.6116699122791346, 'f1-score': 0.6463073559515627, 'support': 111946}}
[[ 8441  3517  1788]
 [13319 49651 21764]
 [  953  2131 10382]]
training model: results/EXC/W8/deepLOB_L1/h30
Epoch 1/50
1289/1289 - 21s - loss: 2.7861 - accuracy30: 0.4592 - val_loss: 2.6533 - val_accuracy30: 0.5108 - 21s/epoch - 16ms/step
Epoch 2/50
1289/1289 - 19s - loss: 2.6527 - accuracy30: 0.4943 - val_loss: 2.5606 - val_accuracy30: 0.5496 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 2.5375 - accuracy30: 0.5473 - val_loss: 2.5406 - val_accuracy30: 0.6026 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 2.4598 - accuracy30: 0.5809 - val_loss: 2.4176 - val_accuracy30: 0.5447 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 2.4183 - accuracy30: 0.5930 - val_loss: 2.4704 - val_accuracy30: 0.6240 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 2.3796 - accuracy30: 0.6027 - val_loss: 2.4902 - val_accuracy30: 0.6099 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 2.3524 - accuracy30: 0.6074 - val_loss: 2.4272 - val_accuracy30: 0.6140 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 2.3299 - accuracy30: 0.6105 - val_loss: 2.4302 - val_accuracy30: 0.5985 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 2.3135 - accuracy30: 0.6123 - val_loss: 2.4285 - val_accuracy30: 0.6085 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 2.2993 - accuracy30: 0.6147 - val_loss: 2.3869 - val_accuracy30: 0.6190 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 2.2869 - accuracy30: 0.6165 - val_loss: 2.3759 - val_accuracy30: 0.6161 - 19s/epoch - 15ms/step
Epoch 12/50
1289/1289 - 19s - loss: 2.2777 - accuracy30: 0.6172 - val_loss: 2.3743 - val_accuracy30: 0.6045 - 19s/epoch - 15ms/step
Epoch 13/50
1289/1289 - 19s - loss: 2.2675 - accuracy30: 0.6190 - val_loss: 2.4407 - val_accuracy30: 0.6234 - 19s/epoch - 15ms/step
Epoch 14/50
1289/1289 - 20s - loss: 2.2627 - accuracy30: 0.6200 - val_loss: 2.3650 - val_accuracy30: 0.6176 - 20s/epoch - 15ms/step
Epoch 15/50
1289/1289 - 19s - loss: 2.2539 - accuracy30: 0.6215 - val_loss: 2.3229 - val_accuracy30: 0.6108 - 19s/epoch - 15ms/step
Epoch 16/50
1289/1289 - 19s - loss: 2.2474 - accuracy30: 0.6217 - val_loss: 2.3155 - val_accuracy30: 0.6230 - 19s/epoch - 15ms/step
Epoch 17/50
1289/1289 - 19s - loss: 2.2421 - accuracy30: 0.6229 - val_loss: 2.3506 - val_accuracy30: 0.6216 - 19s/epoch - 15ms/step
Epoch 18/50
1289/1289 - 19s - loss: 2.2343 - accuracy30: 0.6234 - val_loss: 2.3142 - val_accuracy30: 0.6223 - 19s/epoch - 15ms/step
Epoch 19/50
1289/1289 - 19s - loss: 2.2311 - accuracy30: 0.6240 - val_loss: 2.2673 - val_accuracy30: 0.6106 - 19s/epoch - 15ms/step
Epoch 20/50
1289/1289 - 19s - loss: 2.2248 - accuracy30: 0.6249 - val_loss: 2.2798 - val_accuracy30: 0.6202 - 19s/epoch - 15ms/step
Epoch 21/50
1289/1289 - 19s - loss: 2.2185 - accuracy30: 0.6256 - val_loss: 2.2965 - val_accuracy30: 0.6272 - 19s/epoch - 15ms/step
Epoch 22/50
1289/1289 - 19s - loss: 2.2164 - accuracy30: 0.6258 - val_loss: 2.2753 - val_accuracy30: 0.6221 - 19s/epoch - 15ms/step
Epoch 23/50
1289/1289 - 19s - loss: 2.2126 - accuracy30: 0.6264 - val_loss: 2.3082 - val_accuracy30: 0.6040 - 19s/epoch - 15ms/step
Epoch 24/50
1289/1289 - 19s - loss: 2.2086 - accuracy30: 0.6262 - val_loss: 2.3299 - val_accuracy30: 0.6241 - 19s/epoch - 15ms/step
Epoch 25/50
1289/1289 - 19s - loss: 2.2030 - accuracy30: 0.6269 - val_loss: 2.3639 - val_accuracy30: 0.6382 - 19s/epoch - 15ms/step
Epoch 26/50
1289/1289 - 19s - loss: 2.1976 - accuracy30: 0.6277 - val_loss: 2.3423 - val_accuracy30: 0.6312 - 19s/epoch - 15ms/step
Epoch 27/50
1289/1289 - 19s - loss: 2.1940 - accuracy30: 0.6282 - val_loss: 2.3311 - val_accuracy30: 0.6288 - 19s/epoch - 15ms/step
Epoch 28/50
1289/1289 - 19s - loss: 2.1901 - accuracy30: 0.6287 - val_loss: 2.3204 - val_accuracy30: 0.6179 - 19s/epoch - 15ms/step
Epoch 29/50
1289/1289 - 19s - loss: 2.1863 - accuracy30: 0.6298 - val_loss: 2.3286 - val_accuracy30: 0.6267 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h30
Evaluating performance on  test set...
5521/5521 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75475407
{'0': {'precision': 0.4627323908514476, 'recall': 0.5679394485024549, 'f1-score': 0.5099663517131457, 'support': 215486}, '1': {'precision': 0.8380136430606668, 'recall': 0.6618834264622956, 'f1-score': 0.7396072074033128, 'support': 975350}, '2': {'precision': 0.41338684619368204, 'recall': 0.7032597067522497, 'f1-score': 0.5206988934187536, 'support': 222474}, 'accuracy': 0.6540730625269757, 'macro avg': {'precision': 0.5713776267019322, 'recall': 0.6443608605723333, 'f1-score': 0.5900908175117374, 'support': 1413310}, 'weighted avg': {'precision': 0.7139529076807846, 'recall': 0.6540730625269757, 'f1-score': 0.6701349771957488, 'support': 1413310}}
[[122383  69503  23600]
 [131363 645568 198419]
 [ 10733  55284 156457]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8018247
{'0': {'precision': 0.4313125734596485, 'recall': 0.5599617597852665, 'f1-score': 0.4872890168786498, 'support': 54393}, '1': {'precision': 0.8273922443645474, 'recall': 0.6227099253941059, 'f1-score': 0.7106056021496201, 'support': 220626}, '2': {'precision': 0.39661100724217224, 'recall': 0.6746540914989673, 'f1-score': 0.49954999763156643, 'support': 54711}, 'accuracy': 0.6209777696903527, 'macro avg': {'precision': 0.5517719416887894, 'recall': 0.6191085922261133, 'f1-score': 0.5658148722199454, 'support': 329730}, 'weighted avg': {'precision': 0.6905759589075601, 'recall': 0.6209777696903527, 'f1-score': 0.6387470445375403, 'support': 329730}}
[[ 30458  15305   8630]
 [ 35715 137386  47525]
 [  4444  13356  36911]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79738563
{'0': {'precision': 0.39074948362348777, 'recall': 0.6311963775023832, 'f1-score': 0.4826863495534901, 'support': 16784}, '1': {'precision': 0.8467821873049671, 'recall': 0.5861998856344114, 'f1-score': 0.6927980897028677, 'support': 78695}, '2': {'precision': 0.3792331005402556, 'recall': 0.6990951600170037, 'f1-score': 0.49172415266001746, 'support': 16467}, 'accuracy': 0.6095528201096957, 'macro avg': {'precision': 0.5389215904895702, 'recall': 0.6388304743845994, 'f1-score': 0.5557361973054585, 'support': 111946}, 'weighted avg': {'precision': 0.7096340649035909, 'recall': 0.6095528201096957, 'f1-score': 0.6317186409690874, 'support': 111946}}
[[10594  4578  1612]
 [15332 46131 17232]
 [ 1186  3769 11512]]
training model: results/EXC/W8/deepLOB_L1/h50
Epoch 1/50
1289/1289 - 22s - loss: 2.9041 - accuracy50: 0.4566 - val_loss: 2.8177 - val_accuracy50: 0.5098 - 22s/epoch - 17ms/step
Epoch 2/50
1289/1289 - 19s - loss: 2.8199 - accuracy50: 0.4735 - val_loss: 2.7314 - val_accuracy50: 0.4826 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 2.7295 - accuracy50: 0.5184 - val_loss: 2.7217 - val_accuracy50: 0.4896 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 2.6635 - accuracy50: 0.5450 - val_loss: 2.7297 - val_accuracy50: 0.4837 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 2.6176 - accuracy50: 0.5613 - val_loss: 2.7095 - val_accuracy50: 0.5005 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 2.5815 - accuracy50: 0.5711 - val_loss: 2.6795 - val_accuracy50: 0.5256 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 2.5547 - accuracy50: 0.5785 - val_loss: 2.7006 - val_accuracy50: 0.5122 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 2.5306 - accuracy50: 0.5818 - val_loss: 2.6536 - val_accuracy50: 0.5375 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 2.5114 - accuracy50: 0.5846 - val_loss: 2.6228 - val_accuracy50: 0.5497 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 2.4956 - accuracy50: 0.5875 - val_loss: 2.5854 - val_accuracy50: 0.5541 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 2.4838 - accuracy50: 0.5891 - val_loss: 2.5806 - val_accuracy50: 0.5457 - 19s/epoch - 15ms/step
Epoch 12/50
1289/1289 - 19s - loss: 2.4755 - accuracy50: 0.5908 - val_loss: 2.5646 - val_accuracy50: 0.5592 - 19s/epoch - 15ms/step
Epoch 13/50
1289/1289 - 19s - loss: 2.4674 - accuracy50: 0.5919 - val_loss: 2.5760 - val_accuracy50: 0.5533 - 19s/epoch - 15ms/step
Epoch 14/50
1289/1289 - 19s - loss: 2.4590 - accuracy50: 0.5935 - val_loss: 2.5484 - val_accuracy50: 0.5720 - 19s/epoch - 15ms/step
Epoch 15/50
1289/1289 - 19s - loss: 2.4520 - accuracy50: 0.5940 - val_loss: 2.5280 - val_accuracy50: 0.5856 - 19s/epoch - 15ms/step
Epoch 16/50
1289/1289 - 19s - loss: 2.4451 - accuracy50: 0.5956 - val_loss: 2.5345 - val_accuracy50: 0.5926 - 19s/epoch - 15ms/step
Epoch 17/50
1289/1289 - 19s - loss: 2.4383 - accuracy50: 0.5959 - val_loss: 2.5273 - val_accuracy50: 0.5803 - 19s/epoch - 15ms/step
Epoch 18/50
1289/1289 - 19s - loss: 2.4316 - accuracy50: 0.5977 - val_loss: 2.5294 - val_accuracy50: 0.5768 - 19s/epoch - 15ms/step
Epoch 19/50
1289/1289 - 19s - loss: 2.4283 - accuracy50: 0.5970 - val_loss: 2.5146 - val_accuracy50: 0.5827 - 19s/epoch - 15ms/step
Epoch 20/50
1289/1289 - 19s - loss: 2.4216 - accuracy50: 0.5984 - val_loss: 2.4995 - val_accuracy50: 0.5923 - 19s/epoch - 15ms/step
Epoch 21/50
1289/1289 - 20s - loss: 2.4181 - accuracy50: 0.5991 - val_loss: 2.5018 - val_accuracy50: 0.5910 - 20s/epoch - 15ms/step
Epoch 22/50
1289/1289 - 19s - loss: 2.4143 - accuracy50: 0.5993 - val_loss: 2.4907 - val_accuracy50: 0.5894 - 19s/epoch - 15ms/step
Epoch 23/50
1289/1289 - 19s - loss: 2.4104 - accuracy50: 0.5999 - val_loss: 2.5075 - val_accuracy50: 0.5962 - 19s/epoch - 15ms/step
Epoch 24/50
1289/1289 - 19s - loss: 2.4077 - accuracy50: 0.6003 - val_loss: 2.5060 - val_accuracy50: 0.5976 - 19s/epoch - 15ms/step
Epoch 25/50
1289/1289 - 19s - loss: 2.4027 - accuracy50: 0.6023 - val_loss: 2.5133 - val_accuracy50: 0.5930 - 19s/epoch - 15ms/step
Epoch 26/50
1289/1289 - 19s - loss: 2.3974 - accuracy50: 0.6027 - val_loss: 2.5024 - val_accuracy50: 0.5917 - 19s/epoch - 15ms/step
Epoch 27/50
1289/1289 - 19s - loss: 2.3954 - accuracy50: 0.6015 - val_loss: 2.5149 - val_accuracy50: 0.5947 - 19s/epoch - 15ms/step
Epoch 28/50
1289/1289 - 19s - loss: 2.3905 - accuracy50: 0.6029 - val_loss: 2.5121 - val_accuracy50: 0.5886 - 19s/epoch - 15ms/step
Epoch 29/50
1289/1289 - 19s - loss: 2.3860 - accuracy50: 0.6033 - val_loss: 2.5440 - val_accuracy50: 0.5819 - 19s/epoch - 15ms/step
Epoch 30/50
1289/1289 - 19s - loss: 2.3841 - accuracy50: 0.6034 - val_loss: 2.5088 - val_accuracy50: 0.5901 - 19s/epoch - 15ms/step
Epoch 31/50
1289/1289 - 19s - loss: 2.3788 - accuracy50: 0.6045 - val_loss: 2.5303 - val_accuracy50: 0.5879 - 19s/epoch - 15ms/step
Epoch 32/50
1289/1289 - 19s - loss: 2.3765 - accuracy50: 0.6042 - val_loss: 2.5313 - val_accuracy50: 0.5904 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h50
Evaluating performance on  test set...
5521/5521 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83063906
{'0': {'precision': 0.5161148506365403, 'recall': 0.49339563334816666, 'f1-score': 0.5044995919310689, 'support': 283146}, '1': {'precision': 0.7260255564974412, 'recall': 0.6887039476975934, 'f1-score': 0.7068724663003813, 'support': 839426}, '2': {'precision': 0.48596662942142843, 'recall': 0.5789267312838363, 'f1-score': 0.5283891940083912, 'support': 290738}, 'accuracy': 0.626992662614713, 'macro avg': {'precision': 0.5760356788518033, 'recall': 0.587008770776532, 'f1-score': 0.5799204174132805, 'support': 1413310}, 'weighted avg': {'precision': 0.6345879886164267, 'recall': 0.626992662614713, 'f1-score': 0.6296120354636915, 'support': 1413310}}
[[139703 115796  27647]
 [110920 578116 150390]
 [ 20059 102363 168316]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87743706
{'0': {'precision': 0.46957676838493045, 'recall': 0.5463209410148536, 'f1-score': 0.5050501041770017, 'support': 69882}, '1': {'precision': 0.7282695693933088, 'recall': 0.6220982213293222, 'f1-score': 0.671010086112025, 'support': 190142}, '2': {'precision': 0.4509156444392768, 'recall': 0.5563509597452156, 'f1-score': 0.4981150978415141, 'support': 69706}, 'accuracy': 0.5921390228368665, 'macro avg': {'precision': 0.5495873274058387, 'recall': 0.5749233740297972, 'f1-score': 0.5580584293768469, 'support': 329730}, 'weighted avg': {'precision': 0.6148094565345661, 'recall': 0.5921390228368665, 'f1-score': 0.5992864531093637, 'support': 329730}}
[[ 38178  22208   9496]
 [ 34127 118287  37728]
 [  8998  21927  38781]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8480505
{'0': {'precision': 0.4399166162329366, 'recall': 0.5908865104096103, 'f1-score': 0.5043461501397322, 'support': 22143}, '1': {'precision': 0.745936714087309, 'recall': 0.5830961532818872, 'f1-score': 0.6545403642831263, 'support': 68162}, '2': {'precision': 0.4535993361454948, 'recall': 0.6062104338986184, 'f1-score': 0.5189169946403497, 'support': 21641}, 'accuracy': 0.5891054615618244, 'macro avg': {'precision': 0.5464842221552468, 'recall': 0.5933976991967053, 'f1-score': 0.5592678363544027, 'support': 111946}, 'weighted avg': {'precision': 0.6288921013023218, 'recall': 0.5891054615618244, 'f1-score': 0.598613615438, 'support': 111946}}
[[13084  7023  2036]
 [14650 39745 13767]
 [ 2008  6514 13119]]
training model: results/EXC/W8/deepLOB_L1/h100
Epoch 1/50
1289/1289 - 22s - loss: 3.0716 - accuracy100: 0.4565 - val_loss: 3.1083 - val_accuracy100: 0.4426 - 22s/epoch - 17ms/step
Epoch 2/50
1289/1289 - 19s - loss: 3.0279 - accuracy100: 0.4663 - val_loss: 3.1150 - val_accuracy100: 0.4351 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 3.0031 - accuracy100: 0.4740 - val_loss: 3.0873 - val_accuracy100: 0.4597 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 2.9663 - accuracy100: 0.4906 - val_loss: 3.0895 - val_accuracy100: 0.4545 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 2.9454 - accuracy100: 0.4984 - val_loss: 3.0966 - val_accuracy100: 0.4548 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 2.9252 - accuracy100: 0.5070 - val_loss: 3.0972 - val_accuracy100: 0.4621 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 2.9079 - accuracy100: 0.5120 - val_loss: 3.1307 - val_accuracy100: 0.4591 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 2.8930 - accuracy100: 0.5164 - val_loss: 3.1129 - val_accuracy100: 0.4487 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 2.8824 - accuracy100: 0.5190 - val_loss: 3.1189 - val_accuracy100: 0.4519 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 2.8715 - accuracy100: 0.5217 - val_loss: 3.1168 - val_accuracy100: 0.4600 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 2.8584 - accuracy100: 0.5244 - val_loss: 3.1106 - val_accuracy100: 0.4366 - 19s/epoch - 15ms/step
Epoch 12/50
1289/1289 - 19s - loss: 2.8487 - accuracy100: 0.5264 - val_loss: 3.1340 - val_accuracy100: 0.4459 - 19s/epoch - 15ms/step
Epoch 13/50
1289/1289 - 19s - loss: 2.8378 - accuracy100: 0.5289 - val_loss: 3.1041 - val_accuracy100: 0.4556 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h100
Evaluating performance on  test set...
5521/5521 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0298415
{'0': {'precision': 0.49217486655229026, 'recall': 0.3927370594307624, 'f1-score': 0.43686903552744355, 'support': 406860}, '1': {'precision': 0.461897001303781, 'recall': 0.40374031319550585, 'f1-score': 0.430865067498444, 'support': 596688}, '2': {'precision': 0.4364519980038477, 'recall': 0.604028680063061, 'f1-score': 0.5067456413605732, 'support': 409762}, 'accuracy': 0.45864247758807336, 'macro avg': {'precision': 0.46350795528663963, 'recall': 0.4668353508964431, 'f1-score': 0.45815991479548696, 'support': 1413310}, 'weighted avg': {'precision': 0.46323602587222046, 'recall': 0.45864247758807336, 'f1-score': 0.454593584341297, 'support': 1413310}}
[[159789 159748  87323]
 [123521 240907 232260]
 [ 41349 120905 247508]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0461698
{'0': {'precision': 0.45806972674653385, 'recall': 0.35268268921846013, 'f1-score': 0.39852675094713047, 'support': 96489}, '1': {'precision': 0.46317914968402946, 'recall': 0.4492137634907741, 'f1-score': 0.4560895771888934, 'support': 137872}, '2': {'precision': 0.42656808379544053, 'recall': 0.5444536484601915, 'f1-score': 0.47835499829566913, 'support': 95369}, 'accuracy': 0.4485124192521154, 'macro avg': {'precision': 0.44927232007533463, 'recall': 0.4487833670564753, 'f1-score': 0.44432377547723106, 'support': 329730}, 'weighted avg': {'precision': 0.4510948265937894, 'recall': 0.4485124192521154, 'f1-score': 0.44568485636970995, 'support': 329730}}
[[34030 38751 23708]
 [29845 61934 46093]
 [10415 33030 51924]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0264817
{'0': {'precision': 0.46910788009334053, 'recall': 0.4112093652641848, 'f1-score': 0.438254628387443, 'support': 31777}, '1': {'precision': 0.4899712819121272, 'recall': 0.44020071917599496, 'f1-score': 0.4637544678209875, 'support': 49223}, '2': {'precision': 0.42076351961472863, 'recall': 0.5420732889549538, 'f1-score': 0.47377637190386085, 'support': 30946}, 'accuracy': 0.4601325639147446, 'macro avg': {'precision': 0.4599475605400654, 'recall': 0.46449445779837784, 'f1-score': 0.45859515603743045, 'support': 111946}, 'weighted avg': {'precision': 0.4649174190527944, 'recall': 0.4601325639147446, 'f1-score': 0.45928650510743685, 'support': 111946}}
[[13067 11839  6871]
 [11333 21668 16222]
 [ 3455 10716 16775]]
training model: results/EXC/W8/deepLOB_L1/h200
Epoch 1/50
1289/1289 - 22s - loss: 3.2195 - accuracy200: 0.4177 - val_loss: 3.2386 - val_accuracy200: 0.3982 - 22s/epoch - 17ms/step
Epoch 2/50
1289/1289 - 19s - loss: 3.1884 - accuracy200: 0.4290 - val_loss: 3.2070 - val_accuracy200: 0.4106 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 3.1684 - accuracy200: 0.4369 - val_loss: 3.2199 - val_accuracy200: 0.4029 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 3.1503 - accuracy200: 0.4447 - val_loss: 3.2312 - val_accuracy200: 0.3982 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 3.1365 - accuracy200: 0.4504 - val_loss: 3.2429 - val_accuracy200: 0.4042 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 3.1289 - accuracy200: 0.4514 - val_loss: 3.2516 - val_accuracy200: 0.4021 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 3.1218 - accuracy200: 0.4544 - val_loss: 3.2402 - val_accuracy200: 0.4098 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 3.1136 - accuracy200: 0.4565 - val_loss: 3.2296 - val_accuracy200: 0.4047 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 3.1080 - accuracy200: 0.4579 - val_loss: 3.2290 - val_accuracy200: 0.4040 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 3.1028 - accuracy200: 0.4594 - val_loss: 3.2283 - val_accuracy200: 0.4055 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 3.0975 - accuracy200: 0.4613 - val_loss: 3.2319 - val_accuracy200: 0.4074 - 19s/epoch - 15ms/step
Epoch 12/50
1289/1289 - 19s - loss: 3.0924 - accuracy200: 0.4627 - val_loss: 3.2325 - val_accuracy200: 0.4074 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h200
Evaluating performance on  test set...
5521/5521 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0780777
{'0': {'precision': 0.402064879536533, 'recall': 0.5740540878406534, 'f1-score': 0.47290749465770704, 'support': 479960}, '1': {'precision': 0.3008593984211052, 'recall': 0.13130934260280963, 'f1-score': 0.18282511469456783, 'support': 458566}, '2': {'precision': 0.43948664519795416, 'recall': 0.488653787827728, 'f1-score': 0.46276793087353546, 'support': 474784}, 'accuracy': 0.4017108773022196, 'macro avg': {'precision': 0.3808036410518641, 'recall': 0.39800573942373035, 'f1-score': 0.37283351340860343, 'support': 1413310}, 'weighted avg': {'precision': 0.3817988819384229, 'recall': 0.4017108773022196, 'f1-score': 0.3753803991854603, 'support': 1413310}}
[[275523  72075 132362]
 [234819  60214 163533]
 [174928  67851 232005]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0754226
{'0': {'precision': 0.4066629485034393, 'recall': 0.49437247439362847, 'f1-score': 0.44624875556933724, 'support': 110617}, '1': {'precision': 0.37851377215611215, 'recall': 0.20842765105345637, 'f1-score': 0.2688266096145435, 'support': 109117}, '2': {'precision': 0.42443589553895095, 'recall': 0.5215735117640642, 'f1-score': 0.4680175880831763, 'support': 109996}, 'accuracy': 0.4088193370333303, 'macro avg': {'precision': 0.4032042053995008, 'recall': 0.4081245457370497, 'f1-score': 0.3943643177556857, 'support': 329730}, 'weighted avg': {'precision': 0.4032765396435444, 'recall': 0.4088193370333303, 'f1-score': 0.39479669540205803, 'support': 329730}}
[[54686 19602 36329]
 [44904 22743 41470]
 [34885 17740 57371]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0689337
{'0': {'precision': 0.43581016167549613, 'recall': 0.4257367334352291, 'f1-score': 0.43071455699636485, 'support': 37293}, '1': {'precision': 0.35888857585575434, 'recall': 0.2670877450466506, 'f1-score': 0.30625676163000365, 'support': 38156}, '2': {'precision': 0.42473312251957807, 'recall': 0.5483464394333781, 'f1-score': 0.4786882893226177, 'support': 36497}, 'accuracy': 0.41163596734139674, 'macro avg': {'precision': 0.4064772866836095, 'recall': 0.413723639305086, 'f1-score': 0.4052198693163287, 'support': 111946}, 'weighted avg': {'precision': 0.4059806123694771, 'recall': 0.41163596734139674, 'f1-score': 0.40393455296506736, 'support': 111946}}
[[15877  9544 11872]
 [12731 10191 15234]
 [ 7823  8661 20013]]
training model: results/EXC/W8/deepLOB_L1/h300
Epoch 1/50
1289/1289 - 29s - loss: 3.2451 - accuracy300: 0.4061 - val_loss: 3.3142 - val_accuracy300: 0.3683 - 29s/epoch - 22ms/step
Epoch 2/50
1289/1289 - 20s - loss: 3.2147 - accuracy300: 0.4137 - val_loss: 3.3489 - val_accuracy300: 0.3604 - 20s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 3.2021 - accuracy300: 0.4210 - val_loss: 3.4085 - val_accuracy300: 0.3522 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 3.1923 - accuracy300: 0.4256 - val_loss: 3.3943 - val_accuracy300: 0.3564 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 3.1836 - accuracy300: 0.4284 - val_loss: 3.3492 - val_accuracy300: 0.3629 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 3.1751 - accuracy300: 0.4315 - val_loss: 3.4055 - val_accuracy300: 0.3552 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 3.1661 - accuracy300: 0.4351 - val_loss: 3.4468 - val_accuracy300: 0.3543 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 3.1606 - accuracy300: 0.4375 - val_loss: 3.4669 - val_accuracy300: 0.3539 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 3.1547 - accuracy300: 0.4403 - val_loss: 3.4977 - val_accuracy300: 0.3570 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 3.1495 - accuracy300: 0.4418 - val_loss: 3.5117 - val_accuracy300: 0.3563 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 3.1454 - accuracy300: 0.4444 - val_loss: 3.5180 - val_accuracy300: 0.3551 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h300
Evaluating performance on  test set...
5521/5521 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246495
{'0': {'precision': 0.37147430186570174, 'recall': 0.5062963770146435, 'f1-score': 0.4285312729483112, 'support': 481785}, '1': {'precision': 0.32906342494714586, 'recall': 0.34068935929903976, 'f1-score': 0.3347754874663793, 'support': 456859}, '2': {'precision': 0.41205709511504685, 'recall': 0.24625104810540463, 'f1-score': 0.30827354209826024, 'support': 474666}, 'accuracy': 0.3654258442945992, 'macro avg': {'precision': 0.3708649406426315, 'recall': 0.36441226147302924, 'f1-score': 0.35719343417098365, 'support': 1413310}, 'weighted avg': {'precision': 0.3713946882794108, 'recall': 0.3654258442945992, 'f1-score': 0.3578352257462393, 'support': 1413310}}
[[243926 157826  80033]
 [214465 155647  86747]
 [198252 159527 116887]]
Evaluating performance on  train set...
1289/1289 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1309787
{'0': {'precision': 0.35159489293303214, 'recall': 0.5235211459136032, 'f1-score': 0.42066960968573797, 'support': 110305}, '1': {'precision': 0.339354153973152, 'recall': 0.31489485874778866, 'f1-score': 0.3266672973228645, 'support': 109662}, '2': {'precision': 0.40789907263569175, 'recall': 0.23682843945591867, 'f1-score': 0.2996679962188458, 'support': 109763}, 'accuracy': 0.3586995420495557, 'macro avg': {'precision': 0.3662827065139586, 'recall': 0.3584148147057702, 'f1-score': 0.3490016344091494, 'support': 329730}, 'weighted avg': {'precision': 0.3662668116570932, 'recall': 0.3586995420495557, 'f1-score': 0.349126281273692, 'support': 329730}}
[[57747 34071 18487]
 [55883 34532 19247]
 [50613 33155 25995]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048938
{'0': {'precision': 0.37448966707353004, 'recall': 0.46288107376963894, 'f1-score': 0.4140201484376818, 'support': 38444}, '1': {'precision': 0.3264804076612195, 'recall': 0.3636821206867625, 'f1-score': 0.3440786253786426, 'support': 35762}, '2': {'precision': 0.4224309706803302, 'recall': 0.27525172231054584, 'f1-score': 0.3333172899520303, 'support': 37740}, 'accuracy': 0.3679363264431065, 'macro avg': {'precision': 0.37446701513835995, 'recall': 0.3672716389223158, 'f1-score': 0.36380535458945157, 'support': 111946}, 'weighted avg': {'precision': 0.375315044157281, 'recall': 0.3679363264431065, 'f1-score': 0.3644696988737327, 'support': 111946}}
[[17795 14014  6635]
 [15188 13006  7568]
 [14535 12817 10388]]
training model: results/EXC/W8/deepLOB_L1/h500
Epoch 1/50
1289/1289 - 22s - loss: 3.2550 - accuracy500: 0.4041 - val_loss: 3.3057 - val_accuracy500: 0.3657 - 22s/epoch - 17ms/step
Epoch 2/50
1289/1289 - 19s - loss: 3.2327 - accuracy500: 0.4094 - val_loss: 3.3007 - val_accuracy500: 0.3615 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 3.2208 - accuracy500: 0.4171 - val_loss: 3.3951 - val_accuracy500: 0.3385 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 3.2012 - accuracy500: 0.4259 - val_loss: 3.4460 - val_accuracy500: 0.3366 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 3.1876 - accuracy500: 0.4309 - val_loss: 3.4725 - val_accuracy500: 0.3385 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 3.1766 - accuracy500: 0.4364 - val_loss: 3.5256 - val_accuracy500: 0.3364 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 3.1668 - accuracy500: 0.4422 - val_loss: 3.5567 - val_accuracy500: 0.3381 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 3.1589 - accuracy500: 0.4448 - val_loss: 3.5402 - val_accuracy500: 0.3349 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 3.1513 - accuracy500: 0.4472 - val_loss: 3.6180 - val_accuracy500: 0.3343 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 3.1510 - accuracy500: 0.4489 - val_loss: 3.6314 - val_accuracy500: 0.3357 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 3.1484 - accuracy500: 0.4492 - val_loss: 3.6402 - val_accuracy500: 0.3322 - 19s/epoch - 15ms/step
Epoch 12/50
1289/1289 - 19s - loss: 3.1389 - accuracy500: 0.4533 - val_loss: 3.6371 - val_accuracy500: 0.3329 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h500
Evaluating performance on  test set...
5521/5521 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1184272
{'0': {'precision': 0.3514140974282288, 'recall': 0.5552685794075333, 'f1-score': 0.43042447296718145, 'support': 495589}, '1': {'precision': 0.31184480358452626, 'recall': 0.14842547734397263, 'f1-score': 0.20112406013222914, 'support': 421080}, '2': {'precision': 0.3549558646298166, 'recall': 0.30719372746108353, 'f1-score': 0.329352208148264, 'support': 496641}, 'accuracy': 0.34688001924560075, 'macro avg': {'precision': 0.33940492188085725, 'recall': 0.3369625947375298, 'f1-score': 0.3203002470825582, 'support': 1413310}, 'weighted avg': {'precision': 0.3408694529787149, 'recall': 0.34688001924560075, 'f1-score': 0.3265898942063479, 'support': 1413310}}
[[275185  71000 149404]
 [230736  62499 127845]
 [277158  66918 152565]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111387
{'0': {'precision': 0.3378015817899307, 'recall': 0.6169653611709311, 'f1-score': 0.43657119980887255, 'support': 109588}, '1': {'precision': 0.3552130512179184, 'recall': 0.14472874835890231, 'f1-score': 0.205662100456621, 'support': 108921}, '2': {'precision': 0.3700438977440785, 'recall': 0.283462655433776, 'f1-score': 0.3210178241412491, 'support': 111221}, 'accuracy': 0.3484760258393231, 'macro avg': {'precision': 0.35435284358397584, 'recall': 0.3483855883212032, 'f1-score': 0.32108370813558085, 'support': 329730}, 'weighted avg': {'precision': 0.3544288140232795, 'recall': 0.3484760258393231, 'f1-score': 0.3213168644263616, 'support': 329730}}
[[67612 13942 28034]
 [67520 15764 25637]
 [65021 14673 31527]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007416
{'0': {'precision': 0.3549070247933884, 'recall': 0.708441809511535, 'f1-score': 0.47290403062760794, 'support': 38795}, '1': {'precision': 0.3191249436175011, 'recall': 0.07935395227546757, 'f1-score': 0.1271024679436797, 'support': 35663}, '2': {'precision': 0.3969888446836727, 'recall': 0.27150021340162184, 'f1-score': 0.32246617875360395, 'support': 37488}, 'accuracy': 0.36171011023171884, 'macro avg': {'precision': 0.3570069376981874, 'recall': 0.35309865839620813, 'f1-score': 0.3074908924416305, 'support': 111946}, 'weighted avg': {'precision': 0.3575999919656975, 'recall': 0.36171011023171884, 'f1-score': 0.31236291865353477, 'support': 111946}}
[[27484  3300  8011]
 [25384  2830  7449]
 [24572  2738 10178]]
training model: results/EXC/W8/deepLOB_L1/h1000
Epoch 1/50
1289/1289 - 22s - loss: 3.2451 - accuracy1000: 0.4111 - val_loss: 3.2330 - val_accuracy1000: 0.3936 - 22s/epoch - 17ms/step
Epoch 2/50
1289/1289 - 19s - loss: 3.2038 - accuracy1000: 0.4290 - val_loss: 3.2817 - val_accuracy1000: 0.3716 - 19s/epoch - 15ms/step
Epoch 3/50
1289/1289 - 19s - loss: 3.1726 - accuracy1000: 0.4459 - val_loss: 3.3500 - val_accuracy1000: 0.3678 - 19s/epoch - 15ms/step
Epoch 4/50
1289/1289 - 19s - loss: 3.1595 - accuracy1000: 0.4476 - val_loss: 3.3069 - val_accuracy1000: 0.3760 - 19s/epoch - 15ms/step
Epoch 5/50
1289/1289 - 19s - loss: 3.1351 - accuracy1000: 0.4570 - val_loss: 3.4286 - val_accuracy1000: 0.3611 - 19s/epoch - 15ms/step
Epoch 6/50
1289/1289 - 19s - loss: 3.1198 - accuracy1000: 0.4644 - val_loss: 3.4649 - val_accuracy1000: 0.3587 - 19s/epoch - 15ms/step
Epoch 7/50
1289/1289 - 19s - loss: 3.1131 - accuracy1000: 0.4654 - val_loss: 3.5162 - val_accuracy1000: 0.3602 - 19s/epoch - 15ms/step
Epoch 8/50
1289/1289 - 19s - loss: 3.1009 - accuracy1000: 0.4715 - val_loss: 3.5121 - val_accuracy1000: 0.3587 - 19s/epoch - 15ms/step
Epoch 9/50
1289/1289 - 19s - loss: 3.0895 - accuracy1000: 0.4749 - val_loss: 3.5201 - val_accuracy1000: 0.3582 - 19s/epoch - 15ms/step
Epoch 10/50
1289/1289 - 19s - loss: 3.0797 - accuracy1000: 0.4791 - val_loss: 3.5560 - val_accuracy1000: 0.3608 - 19s/epoch - 15ms/step
Epoch 11/50
1289/1289 - 19s - loss: 3.0719 - accuracy1000: 0.4796 - val_loss: 3.5475 - val_accuracy1000: 0.3617 - 19s/epoch - 15ms/step
testing model: results/EXC/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
5521/5521 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1169206
{'0': {'precision': 0.3085307188892846, 'recall': 0.7451135974680055, 'f1-score': 0.4363719906462801, 'support': 449922}, '1': {'precision': 0.5031254069540305, 'recall': 0.0449479378744692, 'f1-score': 0.0825234423393212, 'support': 515730}, '2': {'precision': 0.3700353100047389, 'recall': 0.23199183305112384, 'f1-score': 0.28518704132140626, 'support': 447658}, 'accuracy': 0.327088183059626, 'macro avg': {'precision': 0.39389714528268466, 'recall': 0.3406844561311995, 'f1-score': 0.2680274914356692, 'support': 1413310}, 'weighted avg': {'precision': 0.39902136901218294, 'recall': 0.327088183059626, 'f1-score': 0.25936237218803504, 'support': 1413310}}
[[335243  13230 101449]
 [417194  23181  75355]
 [334142   9663 103853]]
Evaluating performance on  train set...
1289/1289 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1151031
{'0': {'precision': 0.3259080611525363, 'recall': 0.8038020351526365, 'f1-score': 0.4637748457482013, 'support': 108100}, '1': {'precision': 0.4532219570405728, 'recall': 0.017382151029748282, 'f1-score': 0.03348025387870239, 'support': 109250}, '2': {'precision': 0.39651778441487917, 'recall': 0.20791955864032746, 'f1-score': 0.27279519929016743, 'support': 112380}, 'accuracy': 0.34014496709428926, 'macro avg': {'precision': 0.3918826008693294, 'recall': 0.3430345816075708, 'f1-score': 0.2566834329723571, 'support': 329730}, 'weighted avg': {'precision': 0.3921567004209986, 'recall': 0.34014496709428926, 'f1-score': 0.2561141026229273, 'support': 329730}}
[[86891  1342 19867]
 [91656  1899 15695]
 [88065   949 23366]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0789324
{'0': {'precision': 0.39273033907331795, 'recall': 0.8117790060316951, 'f1-score': 0.5293611802798155, 'support': 43603}, '1': {'precision': 0.23579545454545456, 'recall': 0.0031433440636243135, 'f1-score': 0.00620398400418582, 'support': 26405}, '2': {'precision': 0.4021708748718904, 'recall': 0.2058514950641423, 'f1-score': 0.2723172039618951, 'support': 41938}, 'accuracy': 0.3940471298661855, 'macro avg': {'precision': 0.3435655561635543, 'recall': 0.3402579483864872, 'f1-score': 0.2692941227486321, 'support': 111946}, 'weighted avg': {'precision': 0.3592503716279631, 'recall': 0.3940471298661855, 'f1-score': 0.3096670773509127, 'support': 111946}}
[[35396   166  8041]
 [21530    83  4792]
 [33202   103  8633]]
training model: results/EXC/W8/deepOF_L1/h10
Epoch 1/50
1288/1288 - 21s - loss: 2.9851 - accuracy10: 0.4476 - val_loss: 2.6487 - val_accuracy10: 0.5978 - 21s/epoch - 16ms/step
Epoch 2/50
1288/1288 - 19s - loss: 2.8824 - accuracy10: 0.4814 - val_loss: 2.5849 - val_accuracy10: 0.6332 - 19s/epoch - 14ms/step
Epoch 3/50
1288/1288 - 18s - loss: 2.8337 - accuracy10: 0.4857 - val_loss: 2.5334 - val_accuracy10: 0.6219 - 18s/epoch - 14ms/step
Epoch 4/50
1288/1288 - 18s - loss: 2.8068 - accuracy10: 0.4974 - val_loss: 2.4962 - val_accuracy10: 0.6317 - 18s/epoch - 14ms/step
Epoch 5/50
1288/1288 - 18s - loss: 2.7780 - accuracy10: 0.5088 - val_loss: 2.4868 - val_accuracy10: 0.6435 - 18s/epoch - 14ms/step
Epoch 6/50
1288/1288 - 17s - loss: 2.7524 - accuracy10: 0.5137 - val_loss: 2.4620 - val_accuracy10: 0.6435 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 2.7312 - accuracy10: 0.5148 - val_loss: 2.4456 - val_accuracy10: 0.6382 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 2.7186 - accuracy10: 0.5146 - val_loss: 2.4375 - val_accuracy10: 0.6420 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 2.7062 - accuracy10: 0.5136 - val_loss: 2.4295 - val_accuracy10: 0.6357 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 2.6926 - accuracy10: 0.5139 - val_loss: 2.4301 - val_accuracy10: 0.6251 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 2.6809 - accuracy10: 0.5161 - val_loss: 2.4112 - val_accuracy10: 0.6296 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 2.6691 - accuracy10: 0.5188 - val_loss: 2.4054 - val_accuracy10: 0.6286 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 2.6634 - accuracy10: 0.5200 - val_loss: 2.4016 - val_accuracy10: 0.6357 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 2.6498 - accuracy10: 0.5222 - val_loss: 2.3961 - val_accuracy10: 0.6195 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 2.6370 - accuracy10: 0.5240 - val_loss: 2.3897 - val_accuracy10: 0.6099 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 2.6277 - accuracy10: 0.5289 - val_loss: 2.3995 - val_accuracy10: 0.6111 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 2.6146 - accuracy10: 0.5297 - val_loss: 2.3746 - val_accuracy10: 0.6181 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 2.6030 - accuracy10: 0.5339 - val_loss: 2.3769 - val_accuracy10: 0.6117 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 2.5934 - accuracy10: 0.5362 - val_loss: 2.3748 - val_accuracy10: 0.6203 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 2.5797 - accuracy10: 0.5420 - val_loss: 2.3737 - val_accuracy10: 0.6076 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 2.5655 - accuracy10: 0.5445 - val_loss: 2.3619 - val_accuracy10: 0.6003 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 2.5582 - accuracy10: 0.5446 - val_loss: 2.3527 - val_accuracy10: 0.6161 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 2.5521 - accuracy10: 0.5482 - val_loss: 2.3564 - val_accuracy10: 0.6072 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 2.5357 - accuracy10: 0.5501 - val_loss: 2.3496 - val_accuracy10: 0.6093 - 17s/epoch - 13ms/step
Epoch 25/50
1288/1288 - 17s - loss: 2.5284 - accuracy10: 0.5525 - val_loss: 2.3446 - val_accuracy10: 0.6211 - 17s/epoch - 13ms/step
Epoch 26/50
1288/1288 - 17s - loss: 2.5191 - accuracy10: 0.5531 - val_loss: 2.3409 - val_accuracy10: 0.6137 - 17s/epoch - 13ms/step
Epoch 27/50
1288/1288 - 17s - loss: 2.5080 - accuracy10: 0.5565 - val_loss: 2.3464 - val_accuracy10: 0.6129 - 17s/epoch - 13ms/step
Epoch 28/50
1288/1288 - 17s - loss: 2.4959 - accuracy10: 0.5586 - val_loss: 2.3511 - val_accuracy10: 0.6156 - 17s/epoch - 13ms/step
Epoch 29/50
1288/1288 - 17s - loss: 2.4881 - accuracy10: 0.5597 - val_loss: 2.3507 - val_accuracy10: 0.6148 - 17s/epoch - 13ms/step
Epoch 30/50
1288/1288 - 17s - loss: 2.4869 - accuracy10: 0.5586 - val_loss: 2.3530 - val_accuracy10: 0.6028 - 17s/epoch - 13ms/step
Epoch 31/50
1288/1288 - 17s - loss: 2.4771 - accuracy10: 0.5604 - val_loss: 2.3638 - val_accuracy10: 0.6256 - 17s/epoch - 13ms/step
Epoch 32/50
1288/1288 - 17s - loss: 2.4662 - accuracy10: 0.5618 - val_loss: 2.3525 - val_accuracy10: 0.6287 - 17s/epoch - 13ms/step
Epoch 33/50
1288/1288 - 17s - loss: 2.4549 - accuracy10: 0.5655 - val_loss: 2.3554 - val_accuracy10: 0.6025 - 17s/epoch - 13ms/step
Epoch 34/50
1288/1288 - 17s - loss: 2.4505 - accuracy10: 0.5632 - val_loss: 2.3498 - val_accuracy10: 0.6162 - 17s/epoch - 13ms/step
Epoch 35/50
1288/1288 - 17s - loss: 2.4407 - accuracy10: 0.5668 - val_loss: 2.3620 - val_accuracy10: 0.6074 - 17s/epoch - 13ms/step
Epoch 36/50
1288/1288 - 17s - loss: 2.4328 - accuracy10: 0.5688 - val_loss: 2.3574 - val_accuracy10: 0.6090 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h10
Evaluating performance on  test set...
5521/5521 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.774783
{'0': {'precision': 0.2769190337649262, 'recall': 0.5847963730164933, 'f1-score': 0.37585784190589105, 'support': 127930}, '1': {'precision': 0.9175912071036207, 'recall': 0.6468039116020949, 'f1-score': 0.7587617410841023, 'support': 1152878}, '2': {'precision': 0.26003443403220095, 'recall': 0.6486033646044816, 'f1-score': 0.37123529106837383, 'support': 132497}, 'accuracy': 0.6413597914109127, 'macro avg': {'precision': 0.484848224966916, 'recall': 0.6267345497410233, 'f1-score': 0.5019516246861224, 'support': 1413305}, 'weighted avg': {'precision': 0.7979528481528896, 'recall': 0.6413597914109127, 'f1-score': 0.6877714114173973, 'support': 1413305}}
[[ 74813  35499  17618]
 [180261 745686 226931]
 [ 15088  31471  85938]]
Evaluating performance on  train set...
1288/1288 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8167753
{'0': {'precision': 0.25698034490353844, 'recall': 0.5888255551597198, 'f1-score': 0.3578045370495648, 'support': 33684}, '1': {'precision': 0.8904286923472691, 'recall': 0.6136802973977695, 'f1-score': 0.7265943471607146, 'support': 262275}, '2': {'precision': 0.2658940212848944, 'recall': 0.5652521543427403, 'f1-score': 0.36166241935636667, 'support': 33769}, 'accuracy': 0.6061814586568323, 'macro avg': {'precision': 0.4711010195119006, 'recall': 0.5892526689667433, 'f1-score': 0.4820204345222154, 'support': 329728}, 'weighted avg': {'precision': 0.7617560123128166, 'recall': 0.6061814586568323, 'f1-score': 0.6515455122610124, 'support': 329728}}
[[ 19834   9779   4071]
 [ 52693 160953  48629]
 [  4654  10027  19088]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79714704
{'0': {'precision': 0.23379088785046728, 'recall': 0.6360115205084914, 'f1-score': 0.34190224500146815, 'support': 10069}, '1': {'precision': 0.917245200612757, 'recall': 0.6111050791513757, 'f1-score': 0.7335140488974612, 'support': 92102}, '2': {'precision': 0.25715764056571233, 'recall': 0.6101278772378517, 'f1-score': 0.36181636181636184, 'support': 9775}, 'accuracy': 0.6132599646258017, 'macro avg': {'precision': 0.4693979096763122, 'recall': 0.6190814922992396, 'f1-score': 0.4790775519050971, 'support': 111946}, 'weighted avg': {'precision': 0.798133688145466, 'recall': 0.6132599646258017, 'f1-score': 0.6658342376970029, 'support': 111946}}
[[ 6404  2497  1168]
 [19758 56284 16060]
 [ 1230  2581  5964]]
training model: results/EXC/W8/deepOF_L1/h20
Epoch 1/50
1288/1288 - 20s - loss: 2.9782 - accuracy20: 0.4431 - val_loss: 2.6840 - val_accuracy20: 0.5930 - 20s/epoch - 16ms/step
Epoch 2/50
1288/1288 - 18s - loss: 2.8698 - accuracy20: 0.4746 - val_loss: 2.6261 - val_accuracy20: 0.6143 - 18s/epoch - 14ms/step
Epoch 3/50
1288/1288 - 18s - loss: 2.8155 - accuracy20: 0.4903 - val_loss: 2.5733 - val_accuracy20: 0.6038 - 18s/epoch - 14ms/step
Epoch 4/50
1288/1288 - 17s - loss: 2.7818 - accuracy20: 0.4980 - val_loss: 2.5285 - val_accuracy20: 0.6035 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 2.7670 - accuracy20: 0.4973 - val_loss: 2.5275 - val_accuracy20: 0.5975 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 2.7443 - accuracy20: 0.4997 - val_loss: 2.4937 - val_accuracy20: 0.6090 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 2.7251 - accuracy20: 0.5043 - val_loss: 2.4861 - val_accuracy20: 0.5894 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 18s - loss: 2.7117 - accuracy20: 0.5038 - val_loss: 2.4829 - val_accuracy20: 0.5852 - 18s/epoch - 14ms/step
Epoch 9/50
1288/1288 - 17s - loss: 2.6978 - accuracy20: 0.5088 - val_loss: 2.4730 - val_accuracy20: 0.5807 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 2.6880 - accuracy20: 0.5106 - val_loss: 2.4602 - val_accuracy20: 0.5885 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 2.6760 - accuracy20: 0.5139 - val_loss: 2.4579 - val_accuracy20: 0.5950 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 2.6652 - accuracy20: 0.5153 - val_loss: 2.4547 - val_accuracy20: 0.5835 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 2.6561 - accuracy20: 0.5166 - val_loss: 2.4485 - val_accuracy20: 0.5881 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 18s - loss: 2.6440 - accuracy20: 0.5196 - val_loss: 2.4428 - val_accuracy20: 0.5877 - 18s/epoch - 14ms/step
Epoch 15/50
1288/1288 - 17s - loss: 2.6351 - accuracy20: 0.5225 - val_loss: 2.4411 - val_accuracy20: 0.5819 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 2.6234 - accuracy20: 0.5234 - val_loss: 2.4399 - val_accuracy20: 0.5803 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 2.6166 - accuracy20: 0.5277 - val_loss: 2.4401 - val_accuracy20: 0.5796 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 2.6056 - accuracy20: 0.5293 - val_loss: 2.4230 - val_accuracy20: 0.5880 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 2.5955 - accuracy20: 0.5318 - val_loss: 2.4298 - val_accuracy20: 0.5892 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 2.5843 - accuracy20: 0.5345 - val_loss: 2.4362 - val_accuracy20: 0.5737 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 2.5735 - accuracy20: 0.5369 - val_loss: 2.4289 - val_accuracy20: 0.5818 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 18s - loss: 2.5637 - accuracy20: 0.5396 - val_loss: 2.4177 - val_accuracy20: 0.5772 - 18s/epoch - 14ms/step
Epoch 23/50
1288/1288 - 17s - loss: 2.5539 - accuracy20: 0.5415 - val_loss: 2.4081 - val_accuracy20: 0.5911 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 2.5401 - accuracy20: 0.5450 - val_loss: 2.4219 - val_accuracy20: 0.5743 - 17s/epoch - 13ms/step
Epoch 25/50
1288/1288 - 18s - loss: 2.5328 - accuracy20: 0.5456 - val_loss: 2.4208 - val_accuracy20: 0.5835 - 18s/epoch - 14ms/step
Epoch 26/50
1288/1288 - 17s - loss: 2.5243 - accuracy20: 0.5481 - val_loss: 2.4119 - val_accuracy20: 0.5857 - 17s/epoch - 13ms/step
Epoch 27/50
1288/1288 - 17s - loss: 2.5165 - accuracy20: 0.5502 - val_loss: 2.4120 - val_accuracy20: 0.5942 - 17s/epoch - 13ms/step
Epoch 28/50
1288/1288 - 17s - loss: 2.5076 - accuracy20: 0.5509 - val_loss: 2.4021 - val_accuracy20: 0.5906 - 17s/epoch - 13ms/step
Epoch 29/50
1288/1288 - 17s - loss: 2.4972 - accuracy20: 0.5536 - val_loss: 2.4086 - val_accuracy20: 0.5934 - 17s/epoch - 13ms/step
Epoch 30/50
1288/1288 - 17s - loss: 2.4884 - accuracy20: 0.5560 - val_loss: 2.4169 - val_accuracy20: 0.5916 - 17s/epoch - 13ms/step
Epoch 31/50
1288/1288 - 17s - loss: 2.4800 - accuracy20: 0.5577 - val_loss: 2.4085 - val_accuracy20: 0.5855 - 17s/epoch - 13ms/step
Epoch 32/50
1288/1288 - 17s - loss: 2.4757 - accuracy20: 0.5582 - val_loss: 2.4157 - val_accuracy20: 0.5976 - 17s/epoch - 13ms/step
Epoch 33/50
1288/1288 - 17s - loss: 2.4669 - accuracy20: 0.5591 - val_loss: 2.4085 - val_accuracy20: 0.5985 - 17s/epoch - 13ms/step
Epoch 34/50
1288/1288 - 17s - loss: 2.4540 - accuracy20: 0.5623 - val_loss: 2.4364 - val_accuracy20: 0.5880 - 17s/epoch - 13ms/step
Epoch 35/50
1288/1288 - 17s - loss: 2.4540 - accuracy20: 0.5625 - val_loss: 2.4110 - val_accuracy20: 0.5865 - 17s/epoch - 13ms/step
Epoch 36/50
1288/1288 - 17s - loss: 2.4421 - accuracy20: 0.5654 - val_loss: 2.4224 - val_accuracy20: 0.5898 - 17s/epoch - 13ms/step
Epoch 37/50
1288/1288 - 17s - loss: 2.4376 - accuracy20: 0.5658 - val_loss: 2.4098 - val_accuracy20: 0.5801 - 17s/epoch - 13ms/step
Epoch 38/50
1288/1288 - 17s - loss: 2.4266 - accuracy20: 0.5675 - val_loss: 2.4235 - val_accuracy20: 0.5901 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h20
Evaluating performance on  test set...
5521/5521 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8040166
{'0': {'precision': 0.3403235913173412, 'recall': 0.5992248500622384, 'f1-score': 0.4341029030506112, 'support': 176740}, '1': {'precision': 0.8729782004164649, 'recall': 0.6263497608018832, 'f1-score': 0.7293796969834299, 'support': 1053520}, '2': {'precision': 0.34131371597578447, 'recall': 0.6455844191319074, 'f1-score': 0.44654419586259536, 'support': 183045}, 'accuracy': 0.6254488592342063, 'macro avg': {'precision': 0.5182051692365301, 'recall': 0.6237196766653429, 'f1-score': 0.5366755986322121, 'support': 1413305}, 'weighted avg': {'precision': 0.7375085734310488, 'recall': 0.6254488592342063, 'f1-score': 0.6558224359093168, 'support': 1413305}}
[[105907  49670  21163]
 [186758 659872 206890]
 [ 18530  46344 118171]]
Evaluating performance on  train set...
1288/1288 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85361487
{'0': {'precision': 0.31742337803183496, 'recall': 0.6189123108438512, 'f1-score': 0.41962992278857214, 'support': 45399}, '1': {'precision': 0.8432295944753734, 'recall': 0.5804628993616915, 'f1-score': 0.6875972126783938, 'support': 238756}, '2': {'precision': 0.33597470528534623, 'recall': 0.5665854782436969, 'f1-score': 0.4218187164596045, 'support': 45573}, 'accuracy': 0.5838388004658385, 'macro avg': {'precision': 0.49887589259751824, 'recall': 0.5886535628164132, 'f1-score': 0.5096819506421902, 'support': 329728}, 'weighted avg': {'precision': 0.7007236396114331, 'recall': 0.5838388004658385, 'f1-score': 0.613967522746429, 'support': 329728}}
[[ 28098  12331   4970]
 [ 54104 138589  46063]
 [  6317  13435  25821]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8349375
{'0': {'precision': 0.28796128251663644, 'recall': 0.6542245370370371, 'f1-score': 0.3999027215847538, 'support': 13824}, '1': {'precision': 0.8740470310318909, 'recall': 0.5767936226749336, 'f1-score': 0.6949691575419948, 'support': 84675}, '2': {'precision': 0.327156238595353, 'recall': 0.5999851267940804, 'f1-score': 0.42342815156922436, 'support': 13447}, 'accuracy': 0.5891411930752327, 'macro avg': {'precision': 0.4963881840479601, 'recall': 0.6103344288353504, 'f1-score': 0.506100010231991, 'support': 111946}, 'weighted avg': {'precision': 0.7359796603945388, 'recall': 0.5891411930752327, 'f1-score': 0.6259143425598718, 'support': 111946}}
[[ 9044  3370  1410]
 [20652 48840 15183]
 [ 1711  3668  8068]]
training model: results/EXC/W8/deepOF_L1/h30
Epoch 1/50
1288/1288 - 20s - loss: 2.9933 - accuracy30: 0.4363 - val_loss: 2.7335 - val_accuracy30: 0.5682 - 20s/epoch - 15ms/step
Epoch 2/50
1288/1288 - 17s - loss: 2.8827 - accuracy30: 0.4683 - val_loss: 2.6839 - val_accuracy30: 0.5794 - 17s/epoch - 13ms/step
Epoch 3/50
1288/1288 - 17s - loss: 2.8340 - accuracy30: 0.4841 - val_loss: 2.6470 - val_accuracy30: 0.5880 - 17s/epoch - 13ms/step
Epoch 4/50
1288/1288 - 17s - loss: 2.8084 - accuracy30: 0.4874 - val_loss: 2.6162 - val_accuracy30: 0.5702 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 2.7839 - accuracy30: 0.4933 - val_loss: 2.6091 - val_accuracy30: 0.5640 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 2.7678 - accuracy30: 0.4983 - val_loss: 2.5766 - val_accuracy30: 0.5671 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 2.7534 - accuracy30: 0.4995 - val_loss: 2.5700 - val_accuracy30: 0.5641 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 2.7394 - accuracy30: 0.5027 - val_loss: 2.5559 - val_accuracy30: 0.5664 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 18s - loss: 2.7264 - accuracy30: 0.5073 - val_loss: 2.5513 - val_accuracy30: 0.5648 - 18s/epoch - 14ms/step
Epoch 10/50
1288/1288 - 17s - loss: 2.7151 - accuracy30: 0.5079 - val_loss: 2.5439 - val_accuracy30: 0.5701 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 2.7081 - accuracy30: 0.5090 - val_loss: 2.5351 - val_accuracy30: 0.5718 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 2.6971 - accuracy30: 0.5120 - val_loss: 2.5245 - val_accuracy30: 0.5814 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 2.6894 - accuracy30: 0.5145 - val_loss: 2.5285 - val_accuracy30: 0.5830 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 2.6816 - accuracy30: 0.5158 - val_loss: 2.5229 - val_accuracy30: 0.5783 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 2.6703 - accuracy30: 0.5162 - val_loss: 2.5212 - val_accuracy30: 0.5716 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 2.6622 - accuracy30: 0.5189 - val_loss: 2.5166 - val_accuracy30: 0.5812 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 2.6544 - accuracy30: 0.5200 - val_loss: 2.5138 - val_accuracy30: 0.5827 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 2.6469 - accuracy30: 0.5212 - val_loss: 2.5175 - val_accuracy30: 0.5864 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 2.6378 - accuracy30: 0.5223 - val_loss: 2.5143 - val_accuracy30: 0.5768 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 2.6306 - accuracy30: 0.5243 - val_loss: 2.5158 - val_accuracy30: 0.5816 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 2.6200 - accuracy30: 0.5264 - val_loss: 2.5094 - val_accuracy30: 0.5882 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 2.6139 - accuracy30: 0.5281 - val_loss: 2.5082 - val_accuracy30: 0.5830 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 2.6059 - accuracy30: 0.5303 - val_loss: 2.5045 - val_accuracy30: 0.5827 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 2.5955 - accuracy30: 0.5324 - val_loss: 2.5034 - val_accuracy30: 0.5868 - 17s/epoch - 13ms/step
Epoch 25/50
1288/1288 - 17s - loss: 2.5850 - accuracy30: 0.5355 - val_loss: 2.5077 - val_accuracy30: 0.5808 - 17s/epoch - 13ms/step
Epoch 26/50
1288/1288 - 17s - loss: 2.5771 - accuracy30: 0.5361 - val_loss: 2.4930 - val_accuracy30: 0.5824 - 17s/epoch - 13ms/step
Epoch 27/50
1288/1288 - 17s - loss: 2.5677 - accuracy30: 0.5376 - val_loss: 2.4989 - val_accuracy30: 0.5897 - 17s/epoch - 13ms/step
Epoch 28/50
1288/1288 - 17s - loss: 2.5589 - accuracy30: 0.5424 - val_loss: 2.4961 - val_accuracy30: 0.5857 - 17s/epoch - 13ms/step
Epoch 29/50
1288/1288 - 17s - loss: 2.5510 - accuracy30: 0.5419 - val_loss: 2.4924 - val_accuracy30: 0.5920 - 17s/epoch - 13ms/step
Epoch 30/50
1288/1288 - 17s - loss: 2.5458 - accuracy30: 0.5422 - val_loss: 2.4986 - val_accuracy30: 0.5893 - 17s/epoch - 13ms/step
Epoch 31/50
1288/1288 - 17s - loss: 2.5365 - accuracy30: 0.5455 - val_loss: 2.4961 - val_accuracy30: 0.5885 - 17s/epoch - 13ms/step
Epoch 32/50
1288/1288 - 17s - loss: 2.5295 - accuracy30: 0.5468 - val_loss: 2.4955 - val_accuracy30: 0.5883 - 17s/epoch - 13ms/step
Epoch 33/50
1288/1288 - 17s - loss: 2.5201 - accuracy30: 0.5469 - val_loss: 2.4924 - val_accuracy30: 0.5959 - 17s/epoch - 13ms/step
Epoch 34/50
1288/1288 - 17s - loss: 2.5108 - accuracy30: 0.5507 - val_loss: 2.4929 - val_accuracy30: 0.5880 - 17s/epoch - 14ms/step
Epoch 35/50
1288/1288 - 17s - loss: 2.5061 - accuracy30: 0.5501 - val_loss: 2.5043 - val_accuracy30: 0.5935 - 17s/epoch - 13ms/step
Epoch 36/50
1288/1288 - 17s - loss: 2.4978 - accuracy30: 0.5518 - val_loss: 2.4918 - val_accuracy30: 0.5889 - 17s/epoch - 13ms/step
Epoch 37/50
1288/1288 - 17s - loss: 2.4938 - accuracy30: 0.5540 - val_loss: 2.5044 - val_accuracy30: 0.5944 - 17s/epoch - 13ms/step
Epoch 38/50
1288/1288 - 17s - loss: 2.4879 - accuracy30: 0.5536 - val_loss: 2.4967 - val_accuracy30: 0.5902 - 17s/epoch - 13ms/step
Epoch 39/50
1288/1288 - 17s - loss: 2.4781 - accuracy30: 0.5566 - val_loss: 2.5092 - val_accuracy30: 0.5937 - 17s/epoch - 13ms/step
Epoch 40/50
1288/1288 - 17s - loss: 2.4704 - accuracy30: 0.5564 - val_loss: 2.5010 - val_accuracy30: 0.5915 - 17s/epoch - 13ms/step
Epoch 41/50
1288/1288 - 17s - loss: 2.4602 - accuracy30: 0.5590 - val_loss: 2.5100 - val_accuracy30: 0.5936 - 17s/epoch - 13ms/step
Epoch 42/50
1288/1288 - 17s - loss: 2.4539 - accuracy30: 0.5594 - val_loss: 2.5106 - val_accuracy30: 0.5861 - 17s/epoch - 13ms/step
Epoch 43/50
1288/1288 - 17s - loss: 2.4469 - accuracy30: 0.5623 - val_loss: 2.5182 - val_accuracy30: 0.6007 - 17s/epoch - 13ms/step
Epoch 44/50
1288/1288 - 17s - loss: 2.4398 - accuracy30: 0.5647 - val_loss: 2.5204 - val_accuracy30: 0.5965 - 17s/epoch - 13ms/step
Epoch 45/50
1288/1288 - 17s - loss: 2.4328 - accuracy30: 0.5649 - val_loss: 2.5227 - val_accuracy30: 0.5982 - 17s/epoch - 13ms/step
Epoch 46/50
1288/1288 - 17s - loss: 2.4271 - accuracy30: 0.5652 - val_loss: 2.5249 - val_accuracy30: 0.5902 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h30
Evaluating performance on  test set...
5521/5521 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8209384
{'0': {'precision': 0.38802667634910143, 'recall': 0.580246512534457, 'f1-score': 0.4650570279272259, 'support': 215486}, '1': {'precision': 0.8197916007651087, 'recall': 0.6244171311162785, 'f1-score': 0.7088891074576502, 'support': 975348}, '2': {'precision': 0.39255710556019885, 'recall': 0.614358725406907, 'f1-score': 0.47902888325780435, 'support': 222471}, 'accuracy': 0.6160991434969805, 'macro avg': {'precision': 0.5334584608914696, 'recall': 0.6063407896858808, 'f1-score': 0.5509916728808935, 'support': 1413305}, 'weighted avg': {'precision': 0.686708804139158, 'recall': 0.6160991434969805, 'f1-score': 0.635529405604436, 'support': 1413305}}
[[125035  68340  22111]
 [176941 609024 189383]
 [ 20257  65537 136677]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8622499
{'0': {'precision': 0.3652139179833126, 'recall': 0.6037749692756388, 'f1-score': 0.4551280721767085, 'support': 54517}, '1': {'precision': 0.7882925336597307, 'recall': 0.5839998186434531, 'f1-score': 0.6709396812167934, 'support': 220560}, '2': {'precision': 0.39313648293963255, 'recall': 0.5481509944923241, 'f1-score': 0.4578795729493852, 'support': 54651}, 'accuracy': 0.5813276397515528, 'macro avg': {'precision': 0.515547644860892, 'recall': 0.578641927470472, 'f1-score': 0.5279824421142957, 'support': 329728}, 'weighted avg': {'precision': 0.6528455888484458, 'recall': 0.5813276397515528, 'f1-score': 0.599943740723537, 'support': 329728}}
[[ 32916  16629   4972]
 [ 50482 128807  41271]
 [  6730  17964  29957]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8466874
{'0': {'precision': 0.3357082326355105, 'recall': 0.6346644514329793, 'f1-score': 0.4391345403785359, 'support': 16853}, '1': {'precision': 0.8228293210711387, 'recall': 0.5800989079444183, 'f1-score': 0.6804658723175806, 'support': 78659}, '2': {'precision': 0.3833942346731628, 'recall': 0.5746014360472191, 'f1-score': 0.4599162283265147, 'support': 16434}, 'accuracy': 0.5875064763368052, 'macro avg': {'precision': 0.5139772627932707, 'recall': 0.5964549318082056, 'f1-score': 0.5265055470075438, 'support': 111946}, 'weighted avg': {'precision': 0.6849849325867803, 'recall': 0.5875064763368052, 'f1-score': 0.6117571217903809, 'support': 111946}}
[[10696  4745  1412]
 [19254 45630 13775]
 [ 1911  5080  9443]]
training model: results/EXC/W8/deepOF_L1/h50
Epoch 1/50
1288/1288 - 20s - loss: 3.0532 - accuracy50: 0.4316 - val_loss: 2.8810 - val_accuracy50: 0.5185 - 20s/epoch - 16ms/step
Epoch 2/50
1288/1288 - 18s - loss: 2.9528 - accuracy50: 0.4579 - val_loss: 2.8321 - val_accuracy50: 0.5352 - 18s/epoch - 14ms/step
Epoch 3/50
1288/1288 - 19s - loss: 2.9141 - accuracy50: 0.4668 - val_loss: 2.8087 - val_accuracy50: 0.5285 - 19s/epoch - 14ms/step
Epoch 4/50
1288/1288 - 17s - loss: 2.8870 - accuracy50: 0.4767 - val_loss: 2.8112 - val_accuracy50: 0.5274 - 17s/epoch - 14ms/step
Epoch 5/50
1288/1288 - 17s - loss: 2.8668 - accuracy50: 0.4819 - val_loss: 2.8102 - val_accuracy50: 0.5248 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 2.8538 - accuracy50: 0.4823 - val_loss: 2.7981 - val_accuracy50: 0.5235 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 2.8413 - accuracy50: 0.4865 - val_loss: 2.7728 - val_accuracy50: 0.5369 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 2.8311 - accuracy50: 0.4872 - val_loss: 2.7642 - val_accuracy50: 0.5366 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 2.8215 - accuracy50: 0.4889 - val_loss: 2.7377 - val_accuracy50: 0.5448 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 2.8119 - accuracy50: 0.4900 - val_loss: 2.7353 - val_accuracy50: 0.5459 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 2.8032 - accuracy50: 0.4913 - val_loss: 2.7270 - val_accuracy50: 0.5451 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 2.7954 - accuracy50: 0.4930 - val_loss: 2.7352 - val_accuracy50: 0.5445 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 2.7866 - accuracy50: 0.4951 - val_loss: 2.7340 - val_accuracy50: 0.5413 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 2.7786 - accuracy50: 0.4976 - val_loss: 2.7264 - val_accuracy50: 0.5428 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 2.7731 - accuracy50: 0.4979 - val_loss: 2.7318 - val_accuracy50: 0.5442 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 2.7661 - accuracy50: 0.4990 - val_loss: 2.7148 - val_accuracy50: 0.5427 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 2.7579 - accuracy50: 0.5010 - val_loss: 2.7144 - val_accuracy50: 0.5452 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 2.7490 - accuracy50: 0.5024 - val_loss: 2.7136 - val_accuracy50: 0.5457 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 2.7423 - accuracy50: 0.5046 - val_loss: 2.7105 - val_accuracy50: 0.5396 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 2.7346 - accuracy50: 0.5077 - val_loss: 2.7126 - val_accuracy50: 0.5450 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 2.7269 - accuracy50: 0.5083 - val_loss: 2.7122 - val_accuracy50: 0.5307 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 2.7193 - accuracy50: 0.5114 - val_loss: 2.7253 - val_accuracy50: 0.5274 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 2.7103 - accuracy50: 0.5135 - val_loss: 2.7201 - val_accuracy50: 0.5214 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 2.6994 - accuracy50: 0.5161 - val_loss: 2.7264 - val_accuracy50: 0.5317 - 17s/epoch - 13ms/step
Epoch 25/50
1288/1288 - 17s - loss: 2.6954 - accuracy50: 0.5184 - val_loss: 2.7191 - val_accuracy50: 0.5370 - 17s/epoch - 13ms/step
Epoch 26/50
1288/1288 - 17s - loss: 2.6837 - accuracy50: 0.5204 - val_loss: 2.7108 - val_accuracy50: 0.5252 - 17s/epoch - 13ms/step
Epoch 27/50
1288/1288 - 17s - loss: 2.6723 - accuracy50: 0.5238 - val_loss: 2.7248 - val_accuracy50: 0.5295 - 17s/epoch - 13ms/step
Epoch 28/50
1288/1288 - 17s - loss: 2.6669 - accuracy50: 0.5266 - val_loss: 2.7370 - val_accuracy50: 0.5224 - 17s/epoch - 13ms/step
Epoch 29/50
1288/1288 - 17s - loss: 2.6580 - accuracy50: 0.5274 - val_loss: 2.7233 - val_accuracy50: 0.5307 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h50
Evaluating performance on  test set...
5521/5521 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8999479
{'0': {'precision': 0.4168133437998235, 'recall': 0.6038439532961793, 'f1-score': 0.4931924124244242, 'support': 283146}, '1': {'precision': 0.7158819112143249, 'recall': 0.5644339875510022, 'f1-score': 0.6312006000269107, 'support': 839425}, '2': {'precision': 0.46048536918415545, 'recall': 0.54052157642381, 'f1-score': 0.4973037974683544, 'support': 290734}, 'accuracy': 0.5674104315770482, 'macro avg': {'precision': 0.5310602080661013, 'recall': 0.5695998390903305, 'f1-score': 0.540565603306563, 'support': 1413305}, 'weighted avg': {'precision': 0.6034273972631637, 'recall': 0.5674104315770482, 'f1-score': 0.5760074044449571, 'support': 1413305}}
[[170976  87803  24367]
 [205874 473800 159751]
 [ 33348 100238 157148]]
Evaluating performance on  train set...
1288/1288 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9364997
{'0': {'precision': 0.39329496896822747, 'recall': 0.6224443110005433, 'f1-score': 0.48202175658095053, 'support': 69942}, '1': {'precision': 0.6761100517570144, 'recall': 0.5222569411566665, 'f1-score': 0.5893072315975045, 'support': 190098}, '2': {'precision': 0.451042315949858, 'recall': 0.4672683962805648, 'f1-score': 0.4590120028474165, 'support': 69688}, 'accuracy': 0.5318868885869565, 'macro avg': {'precision': 0.5068157788916999, 'recall': 0.5373232161459248, 'f1-score': 0.5101136636752905, 'support': 329728}, 'weighted avg': {'precision': 0.5685511762798259, 'recall': 0.5318868885869565, 'f1-score': 0.5390119136544, 'support': 329728}}
[[43535 20877  5530]
 [56716 99280 34102]
 [10442 26683 32563]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9233038
{'0': {'precision': 0.36825003868172673, 'recall': 0.6437942383120688, 'f1-score': 0.4685116225659869, 'support': 22181}, '1': {'precision': 0.7141761369370824, 'recall': 0.5192169408449877, 'f1-score': 0.601288195506611, 'support': 68143}, '2': {'precision': 0.44779277944724255, 'recall': 0.48931643696235316, 'f1-score': 0.46763464385953274, 'support': 21622}, 'accuracy': 0.5381255248066031, 'macro avg': {'precision': 0.5100729850220173, 'recall': 0.5507758720398033, 'f1-score': 0.5124781539773768, 'support': 111946}, 'weighted avg': {'precision': 0.5941832140899296, 'recall': 0.5381255248066031, 'f1-score': 0.5491650802715056, 'support': 111946}}
[[14280  6220  1681]
 [21396 35381 11366]
 [ 3102  7940 10580]]
training model: results/EXC/W8/deepOF_L1/h100
Epoch 1/50
1288/1288 - 19s - loss: 3.1780 - accuracy100: 0.4227 - val_loss: 3.1216 - val_accuracy100: 0.4571 - 19s/epoch - 15ms/step
Epoch 2/50
1288/1288 - 17s - loss: 3.1128 - accuracy100: 0.4422 - val_loss: 3.0850 - val_accuracy100: 0.4619 - 17s/epoch - 13ms/step
Epoch 3/50
1288/1288 - 18s - loss: 3.0858 - accuracy100: 0.4510 - val_loss: 3.0764 - val_accuracy100: 0.4622 - 18s/epoch - 14ms/step
Epoch 4/50
1288/1288 - 17s - loss: 3.0667 - accuracy100: 0.4570 - val_loss: 3.0717 - val_accuracy100: 0.4595 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 3.0537 - accuracy100: 0.4613 - val_loss: 3.0824 - val_accuracy100: 0.4538 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 3.0448 - accuracy100: 0.4638 - val_loss: 3.0798 - val_accuracy100: 0.4574 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 3.0361 - accuracy100: 0.4673 - val_loss: 3.0570 - val_accuracy100: 0.4634 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 3.0277 - accuracy100: 0.4689 - val_loss: 3.0424 - val_accuracy100: 0.4754 - 17s/epoch - 14ms/step
Epoch 9/50
1288/1288 - 17s - loss: 3.0213 - accuracy100: 0.4708 - val_loss: 3.0563 - val_accuracy100: 0.4667 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 3.0137 - accuracy100: 0.4733 - val_loss: 3.0366 - val_accuracy100: 0.4748 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 3.0082 - accuracy100: 0.4738 - val_loss: 3.0351 - val_accuracy100: 0.4771 - 17s/epoch - 14ms/step
Epoch 12/50
1288/1288 - 17s - loss: 2.9989 - accuracy100: 0.4771 - val_loss: 3.0331 - val_accuracy100: 0.4793 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 2.9928 - accuracy100: 0.4794 - val_loss: 3.0334 - val_accuracy100: 0.4807 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 2.9870 - accuracy100: 0.4812 - val_loss: 3.0323 - val_accuracy100: 0.4854 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 2.9826 - accuracy100: 0.4826 - val_loss: 3.0304 - val_accuracy100: 0.4882 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 2.9774 - accuracy100: 0.4845 - val_loss: 3.0340 - val_accuracy100: 0.4851 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 2.9713 - accuracy100: 0.4852 - val_loss: 3.0289 - val_accuracy100: 0.4868 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 2.9661 - accuracy100: 0.4859 - val_loss: 3.0288 - val_accuracy100: 0.4880 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 2.9624 - accuracy100: 0.4871 - val_loss: 3.0340 - val_accuracy100: 0.4870 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 2.9570 - accuracy100: 0.4886 - val_loss: 3.0383 - val_accuracy100: 0.4853 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 2.9528 - accuracy100: 0.4890 - val_loss: 3.0285 - val_accuracy100: 0.4849 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 2.9469 - accuracy100: 0.4907 - val_loss: 3.0319 - val_accuracy100: 0.4851 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 2.9395 - accuracy100: 0.4919 - val_loss: 3.0275 - val_accuracy100: 0.4846 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 2.9346 - accuracy100: 0.4932 - val_loss: 3.0236 - val_accuracy100: 0.4828 - 17s/epoch - 14ms/step
Epoch 25/50
1288/1288 - 17s - loss: 2.9327 - accuracy100: 0.4944 - val_loss: 3.0293 - val_accuracy100: 0.4810 - 17s/epoch - 13ms/step
Epoch 26/50
1288/1288 - 17s - loss: 2.9274 - accuracy100: 0.4949 - val_loss: 3.0422 - val_accuracy100: 0.4767 - 17s/epoch - 13ms/step
Epoch 27/50
1288/1288 - 17s - loss: 2.9215 - accuracy100: 0.4963 - val_loss: 3.0472 - val_accuracy100: 0.4703 - 17s/epoch - 13ms/step
Epoch 28/50
1288/1288 - 17s - loss: 2.9111 - accuracy100: 0.5001 - val_loss: 3.0496 - val_accuracy100: 0.4755 - 17s/epoch - 13ms/step
Epoch 29/50
1288/1288 - 17s - loss: 2.9031 - accuracy100: 0.5018 - val_loss: 3.0559 - val_accuracy100: 0.4706 - 17s/epoch - 13ms/step
Epoch 30/50
1288/1288 - 17s - loss: 2.8980 - accuracy100: 0.5030 - val_loss: 3.0545 - val_accuracy100: 0.4705 - 17s/epoch - 13ms/step
Epoch 31/50
1288/1288 - 17s - loss: 2.8869 - accuracy100: 0.5058 - val_loss: 3.0677 - val_accuracy100: 0.4667 - 17s/epoch - 13ms/step
Epoch 32/50
1288/1288 - 17s - loss: 2.8828 - accuracy100: 0.5066 - val_loss: 3.0547 - val_accuracy100: 0.4696 - 17s/epoch - 13ms/step
Epoch 33/50
1288/1288 - 17s - loss: 2.8754 - accuracy100: 0.5082 - val_loss: 3.0469 - val_accuracy100: 0.4696 - 17s/epoch - 13ms/step
Epoch 34/50
1288/1288 - 17s - loss: 2.8680 - accuracy100: 0.5095 - val_loss: 3.0521 - val_accuracy100: 0.4735 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h100
Evaluating performance on  test set...
5521/5521 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9896244
{'0': {'precision': 0.49308361713875276, 'recall': 0.49606252765078895, 'f1-score': 0.49456858675435994, 'support': 406860}, '1': {'precision': 0.5004049764308748, 'recall': 0.5001055828171507, 'f1-score': 0.5002552348286156, 'support': 596688}, '2': {'precision': 0.5102684616441313, 'recall': 0.507652096242407, 'f1-score': 0.508956916515886, 'support': 409757}, 'accuracy': 0.5011296217023219, 'macro avg': {'precision': 0.5012523517379196, 'recall': 0.5012734022367823, 'f1-score': 0.5012602460329538, 'support': 1413305}, 'weighted avg': {'precision': 0.5011570178295365, 'recall': 0.5011296217023219, 'f1-score': 0.5011410346719892, 'support': 1413305}}
[[201828 151433  53599]
 [152238 298407 146043]
 [ 55252 146491 208014]]
Evaluating performance on  train set...
1288/1288 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0051488
{'0': {'precision': 0.47182912811622607, 'recall': 0.5187222274012616, 'f1-score': 0.49416570867520887, 'support': 96543}, '1': {'precision': 0.4858118075843915, 'recall': 0.4874580059063831, 'f1-score': 0.4866335145472127, 'support': 137817}, '2': {'precision': 0.5030712962745879, 'recall': 0.44999370858149484, 'f1-score': 0.4750545180822918, 'support': 95368}, 'accuracy': 0.4857761548913043, 'macro avg': {'precision': 0.4869040773250685, 'recall': 0.4853913139630466, 'f1-score': 0.48528458043490447, 'support': 329728}, 'weighted avg': {'precision': 0.48670973888992686, 'recall': 0.4857761548913043, 'f1-score': 0.4854898897499027, 'support': 329728}}
[[50079 34656 11808]
 [40054 67180 30583]
 [16005 36448 42915]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0084776
{'0': {'precision': 0.45014146159184326, 'recall': 0.5302458655599572, 'f1-score': 0.4869211225314702, 'support': 31806}, '1': {'precision': 0.5075056991698568, 'recall': 0.47949770390539276, 'f1-score': 0.4931043129388165, 'support': 49214}, '2': {'precision': 0.4899220927739261, 'recall': 0.44328396818211213, 'f1-score': 0.4654376315610783, 'support': 30926}, 'accuracy': 0.48391188608793523, 'macro avg': {'precision': 0.48252308451187537, 'recall': 0.48434251254915406, 'f1-score': 0.4818210223437884, 'support': 111946}, 'weighted avg': {'precision': 0.4863498065805115, 'recall': 0.48391188608793523, 'f1-score': 0.4837044027822769, 'support': 111946}}
[[16865 11097  3844]
 [15187 23598 10429]
 [ 5414 11803 13709]]
training model: results/EXC/W8/deepOF_L1/h200
Epoch 1/50
1288/1288 - 21s - loss: 3.2572 - accuracy200: 0.3988 - val_loss: 3.2402 - val_accuracy200: 0.4004 - 21s/epoch - 16ms/step
Epoch 2/50
1288/1288 - 18s - loss: 3.2200 - accuracy200: 0.4160 - val_loss: 3.2258 - val_accuracy200: 0.4062 - 18s/epoch - 14ms/step
Epoch 3/50
1288/1288 - 17s - loss: 3.2072 - accuracy200: 0.4191 - val_loss: 3.2194 - val_accuracy200: 0.4089 - 17s/epoch - 13ms/step
Epoch 4/50
1288/1288 - 17s - loss: 3.1974 - accuracy200: 0.4229 - val_loss: 3.2148 - val_accuracy200: 0.4104 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 3.1908 - accuracy200: 0.4255 - val_loss: 3.2105 - val_accuracy200: 0.4146 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 18s - loss: 3.1855 - accuracy200: 0.4278 - val_loss: 3.2124 - val_accuracy200: 0.4142 - 18s/epoch - 14ms/step
Epoch 7/50
1288/1288 - 17s - loss: 3.1811 - accuracy200: 0.4292 - val_loss: 3.2093 - val_accuracy200: 0.4162 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 3.1769 - accuracy200: 0.4309 - val_loss: 3.2109 - val_accuracy200: 0.4140 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 3.1731 - accuracy200: 0.4332 - val_loss: 3.2075 - val_accuracy200: 0.4165 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 3.1691 - accuracy200: 0.4344 - val_loss: 3.2056 - val_accuracy200: 0.4188 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 3.1645 - accuracy200: 0.4358 - val_loss: 3.2058 - val_accuracy200: 0.4173 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 3.1612 - accuracy200: 0.4386 - val_loss: 3.2071 - val_accuracy200: 0.4167 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 3.1585 - accuracy200: 0.4396 - val_loss: 3.2074 - val_accuracy200: 0.4164 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 3.1540 - accuracy200: 0.4420 - val_loss: 3.2094 - val_accuracy200: 0.4157 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 3.1515 - accuracy200: 0.4429 - val_loss: 3.2082 - val_accuracy200: 0.4172 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 3.1480 - accuracy200: 0.4441 - val_loss: 3.2155 - val_accuracy200: 0.4126 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 3.1413 - accuracy200: 0.4472 - val_loss: 3.2115 - val_accuracy200: 0.4154 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 3.1396 - accuracy200: 0.4481 - val_loss: 3.2115 - val_accuracy200: 0.4149 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 3.1541 - accuracy200: 0.4412 - val_loss: 3.2077 - val_accuracy200: 0.4155 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 3.1437 - accuracy200: 0.4456 - val_loss: 3.2095 - val_accuracy200: 0.4181 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h200
Evaluating performance on  test set...
5521/5521 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0540597
{'0': {'precision': 0.46005075097729925, 'recall': 0.5730227518959913, 'f1-score': 0.5103597112957085, 'support': 479960}, '1': {'precision': 0.3619210478018825, 'recall': 0.27092501406558706, 'f1-score': 0.3098809359009374, 'support': 458566}, '2': {'precision': 0.47524951663761905, 'recall': 0.4726809736740673, 'f1-score': 0.4739617652525048, 'support': 474779}, 'accuracy': 0.44129469576630664, 'macro avg': {'precision': 0.43240710513893355, 'recall': 0.43887624654521523, 'f1-score': 0.4314008041497169, 'support': 1413305}, 'weighted avg': {'precision': 0.4333170376564681, 'recall': 0.44129469576630664, 'f1-score': 0.433084296192723, 'support': 1413305}}
[[275028 104157 100775]
 [187310 124237 147019]
 [135483 114877 224419]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0623131
{'0': {'precision': 0.43603451192691595, 'recall': 0.5822001355319629, 'f1-score': 0.4986264267750049, 'support': 110675}, '1': {'precision': 0.3721968172672398, 'recall': 0.2799104932044533, 'f1-score': 0.3195234680471298, 'support': 109042}, '2': {'precision': 0.46939408492416057, 'recall': 0.42645735426457354, 'f1-score': 0.44689677508465936, 'support': 110011}, 'accuracy': 0.43026979813664595, 'macro avg': {'precision': 0.42587513803943877, 'recall': 0.42952266100032993, 'f1-score': 0.4216822233022646, 'support': 329728}, 'weighted avg': {'precision': 0.4260533458867843, 'recall': 0.43026979813664595, 'f1-score': 0.4221373947919414, 'support': 329728}}
[[64435 24184 22056]
 [47543 30522 30977]
 [35797 27299 46915]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0684555
{'0': {'precision': 0.42313147209108043, 'recall': 0.583887399463807, 'f1-score': 0.4906782620450373, 'support': 37300}, '1': {'precision': 0.3688845043662538, 'recall': 0.2644593461860855, 'f1-score': 0.3080631627126402, 'support': 38176}, '2': {'precision': 0.44997885579653235, 'recall': 0.40847271730189194, 'f1-score': 0.42822237553179254, 'support': 36470}, 'accuracy': 0.417808586282672, 'macro avg': {'precision': 0.41399827741795553, 'recall': 0.4189398209839282, 'f1-score': 0.40898793342982337, 'support': 111946}, 'weighted avg': {'precision': 0.4133784826486247, 'recall': 0.417808586282672, 'f1-score': 0.4080555670559209, 'support': 111946}}
[[21779  8029  7492]
 [17363 10096 10717]
 [12329  9244 14897]]
training model: results/EXC/W8/deepOF_L1/h300
Epoch 1/50
1288/1288 - 20s - loss: 3.2804 - accuracy300: 0.3793 - val_loss: 3.2806 - val_accuracy300: 0.3671 - 20s/epoch - 15ms/step
Epoch 2/50
1288/1288 - 17s - loss: 3.2527 - accuracy300: 0.3914 - val_loss: 3.2664 - val_accuracy300: 0.3780 - 17s/epoch - 13ms/step
Epoch 3/50
1288/1288 - 17s - loss: 3.2433 - accuracy300: 0.3953 - val_loss: 3.2575 - val_accuracy300: 0.3896 - 17s/epoch - 13ms/step
Epoch 4/50
1288/1288 - 17s - loss: 3.2383 - accuracy300: 0.3979 - val_loss: 3.2535 - val_accuracy300: 0.3940 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 3.2330 - accuracy300: 0.4008 - val_loss: 3.2534 - val_accuracy300: 0.3936 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 3.2285 - accuracy300: 0.4037 - val_loss: 3.2524 - val_accuracy300: 0.3958 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 3.2255 - accuracy300: 0.4056 - val_loss: 3.2539 - val_accuracy300: 0.3932 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 3.2230 - accuracy300: 0.4072 - val_loss: 3.2507 - val_accuracy300: 0.3965 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 3.2203 - accuracy300: 0.4086 - val_loss: 3.2511 - val_accuracy300: 0.3971 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 3.2172 - accuracy300: 0.4105 - val_loss: 3.2541 - val_accuracy300: 0.3956 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 3.2145 - accuracy300: 0.4118 - val_loss: 3.2559 - val_accuracy300: 0.3926 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 3.2128 - accuracy300: 0.4140 - val_loss: 3.2547 - val_accuracy300: 0.3937 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 3.2101 - accuracy300: 0.4149 - val_loss: 3.2623 - val_accuracy300: 0.3897 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 3.2071 - accuracy300: 0.4170 - val_loss: 3.2599 - val_accuracy300: 0.3912 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 3.2048 - accuracy300: 0.4180 - val_loss: 3.2667 - val_accuracy300: 0.3881 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 3.2023 - accuracy300: 0.4201 - val_loss: 3.2710 - val_accuracy300: 0.3866 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 3.1993 - accuracy300: 0.4209 - val_loss: 3.2742 - val_accuracy300: 0.3866 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 3.1955 - accuracy300: 0.4230 - val_loss: 3.2711 - val_accuracy300: 0.3883 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h300
Evaluating performance on  test set...
5521/5521 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0725093
{'0': {'precision': 0.41914396887159533, 'recall': 0.6204489554469317, 'f1-score': 0.5003062864028922, 'support': 481785}, '1': {'precision': 0.3422305856627735, 'recall': 0.14251224119476688, 'f1-score': 0.20122854868993442, 'support': 456859}, '2': {'precision': 0.4321571180896047, 'recall': 0.4642260476424227, 'f1-score': 0.44761793518833576, 'support': 474661}, 'accuracy': 0.41348541185377535, 'macro avg': {'precision': 0.3978438908746578, 'recall': 0.4090624147613737, 'f1-score': 0.3830509234270541, 'support': 1413305}, 'weighted avg': {'precision': 0.398651763071411, 'recall': 0.41348541185377535, 'f1-score': 0.3859322046231938, 'support': 1413305}}
[[298923  60074 122788]
 [225005  65108 166746]
 [189247  65064 220350]]
Evaluating performance on  train set...
1288/1288 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0774086
{'0': {'precision': 0.39604740487836904, 'recall': 0.6558838720200071, 'f1-score': 0.4938746686589771, 'support': 110361}, '1': {'precision': 0.36147020157756354, 'recall': 0.12038126510694577, 'f1-score': 0.18061267080405347, 'support': 109635}, '2': {'precision': 0.4236849253055681, 'recall': 0.4264571866000802, 'f1-score': 0.4250665358657838, 'support': 109732}, 'accuracy': 0.4014763684006211, 'macro avg': {'precision': 0.3937341772538336, 'recall': 0.40090744124234434, 'f1-score': 0.36651795844293816, 'support': 329728}, 'weighted avg': {'precision': 0.3937480815198238, 'recall': 0.4014763684006211, 'f1-score': 0.3668155982661465, 'support': 329728}}
[[72384 11111 26866]
 [59649 13198 36788]
 [50733 12203 46796]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0832757
{'0': {'precision': 0.39634318302885974, 'recall': 0.658227518734388, 'f1-score': 0.494768135500401, 'support': 38432}, '1': {'precision': 0.32319515983975144, 'recall': 0.11052087119411748, 'f1-score': 0.16471519646651944, 'support': 35767}, '2': {'precision': 0.4249212850734208, 'recall': 0.4040056163403714, 'f1-score': 0.4141995762942039, 'support': 37747}, 'accuracy': 0.39751308666678575, 'macro avg': {'precision': 0.381486542647344, 'recall': 0.3909180020896256, 'f1-score': 0.3578943027537081, 'support': 111946}, 'weighted avg': {'precision': 0.38260845621835476, 'recall': 0.39751308666678575, 'f1-score': 0.362148614706615, 'support': 111946}}
[[25297  3925  9210]
 [20385  3953 11429]
 [18144  4353 15250]]
training model: results/EXC/W8/deepOF_L1/h500
Epoch 1/50
1288/1288 - 20s - loss: 3.2869 - accuracy500: 0.3804 - val_loss: 3.2835 - val_accuracy500: 0.3707 - 20s/epoch - 15ms/step
Epoch 2/50
1288/1288 - 17s - loss: 3.2662 - accuracy500: 0.3905 - val_loss: 3.2777 - val_accuracy500: 0.3792 - 17s/epoch - 13ms/step
Epoch 3/50
1288/1288 - 17s - loss: 3.2612 - accuracy500: 0.3910 - val_loss: 3.2761 - val_accuracy500: 0.3822 - 17s/epoch - 13ms/step
Epoch 4/50
1288/1288 - 17s - loss: 3.2583 - accuracy500: 0.3913 - val_loss: 3.2736 - val_accuracy500: 0.3840 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 3.2562 - accuracy500: 0.3911 - val_loss: 3.2721 - val_accuracy500: 0.3842 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 3.2553 - accuracy500: 0.3913 - val_loss: 3.2712 - val_accuracy500: 0.3847 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 3.2532 - accuracy500: 0.3917 - val_loss: 3.2706 - val_accuracy500: 0.3851 - 17s/epoch - 13ms/step
Epoch 8/50
1288/1288 - 17s - loss: 3.2521 - accuracy500: 0.3928 - val_loss: 3.2693 - val_accuracy500: 0.3856 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 3.2493 - accuracy500: 0.3941 - val_loss: 3.2692 - val_accuracy500: 0.3857 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 3.2481 - accuracy500: 0.3955 - val_loss: 3.2681 - val_accuracy500: 0.3869 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 3.2463 - accuracy500: 0.3956 - val_loss: 3.2683 - val_accuracy500: 0.3873 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 3.2445 - accuracy500: 0.3967 - val_loss: 3.2686 - val_accuracy500: 0.3871 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 3.2432 - accuracy500: 0.3976 - val_loss: 3.2673 - val_accuracy500: 0.3866 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 3.2418 - accuracy500: 0.3987 - val_loss: 3.2675 - val_accuracy500: 0.3877 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 3.2400 - accuracy500: 0.3996 - val_loss: 3.2675 - val_accuracy500: 0.3875 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 3.2386 - accuracy500: 0.3997 - val_loss: 3.2673 - val_accuracy500: 0.3887 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 3.2363 - accuracy500: 0.4022 - val_loss: 3.2679 - val_accuracy500: 0.3867 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 3.2348 - accuracy500: 0.4023 - val_loss: 3.2683 - val_accuracy500: 0.3875 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 3.2329 - accuracy500: 0.4040 - val_loss: 3.2692 - val_accuracy500: 0.3876 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 3.2322 - accuracy500: 0.4047 - val_loss: 3.2695 - val_accuracy500: 0.3886 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 3.2292 - accuracy500: 0.4072 - val_loss: 3.2726 - val_accuracy500: 0.3861 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 3.2278 - accuracy500: 0.4079 - val_loss: 3.2802 - val_accuracy500: 0.3839 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 3.2259 - accuracy500: 0.4086 - val_loss: 3.2810 - val_accuracy500: 0.3820 - 17s/epoch - 13ms/step
Epoch 24/50
1288/1288 - 17s - loss: 3.2239 - accuracy500: 0.4096 - val_loss: 3.2836 - val_accuracy500: 0.3820 - 17s/epoch - 13ms/step
Epoch 25/50
1288/1288 - 17s - loss: 3.2213 - accuracy500: 0.4122 - val_loss: 3.2900 - val_accuracy500: 0.3803 - 17s/epoch - 13ms/step
Epoch 26/50
1288/1288 - 17s - loss: 3.2301 - accuracy500: 0.4065 - val_loss: 3.2726 - val_accuracy500: 0.3840 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h500
Evaluating performance on  test set...
5521/5521 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0844982
{'0': {'precision': 0.4139684636341121, 'recall': 0.5059040977586221, 'f1-score': 0.45534207864240067, 'support': 495588}, '1': {'precision': 0.3305810829916584, 'recall': 0.02776438625531076, 'f1-score': 0.05122643741620002, 'support': 421079}, '2': {'precision': 0.3981082235947636, 'recall': 0.6190726444613581, 'f1-score': 0.48459014223029195, 'support': 496638}, 'accuracy': 0.40321515879445696, 'macro avg': {'precision': 0.38088592340684474, 'recall': 0.38424704282509703, 'f1-score': 0.33038621942963087, 'support': 1413305}, 'weighted avg': {'precision': 0.3835507740722654, 'recall': 0.40321515879445696, 'f1-score': 0.34521800047970813, 'support': 1413305}}
[[250720  11476 233392]
 [177945  11691 231443]
 [176985  12198 307455]]
Evaluating performance on  train set...
1288/1288 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0855433
{'0': {'precision': 0.38910054551216783, 'recall': 0.526241872087403, 'f1-score': 0.4473975980213527, 'support': 109653}, '1': {'precision': 0.4486772486772487, 'recall': 0.019476880391742536, 'f1-score': 0.03733314549360758, 'support': 108847}, '2': {'precision': 0.38764699890210635, 'recall': 0.6158341424821088, 'f1-score': 0.4757962004653909, 'support': 111228}, 'accuracy': 0.38917532026397517, 'macro avg': {'precision': 0.4084749310305076, 'recall': 0.3871842983204181, 'f1-score': 0.3201756479934504, 'support': 329728}, 'weighted avg': {'precision': 0.4082771708732704, 'recall': 0.38917532026397517, 'f1-score': 0.32161038640559064, 'support': 329728}}
[[57704  1342 50607]
 [49130  2120 57597]
 [41467  1263 68498]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.088989
{'0': {'precision': 0.39745640385440645, 'recall': 0.5250599118715695, 'f1-score': 0.4524330265451357, 'support': 38807}, '1': {'precision': 0.3559440559440559, 'recall': 0.014278901450332426, 'f1-score': 0.027456374571836986, 'support': 35647}, '2': {'precision': 0.3809451476793249, 'recall': 0.6020217646431238, 'f1-score': 0.4666225631059933, 'support': 37492}, 'accuracy': 0.38818716166723244, 'macro avg': {'precision': 0.3781152024925958, 'recall': 0.3804535259883419, 'f1-score': 0.315503988074322, 'support': 111946}, 'weighted avg': {'precision': 0.3787078046862681, 'recall': 0.38818716166723244, 'f1-score': 0.3218598161744882, 'support': 111946}}
[[20376   491 17940]
 [16399   509 18739]
 [14491   430 22571]]
training model: results/EXC/W8/deepOF_L1/h1000
Epoch 1/50
1288/1288 - 19s - loss: 3.2599 - accuracy1000: 0.4011 - val_loss: 3.2400 - val_accuracy1000: 0.3967 - 19s/epoch - 15ms/step
Epoch 2/50
1288/1288 - 17s - loss: 3.2422 - accuracy1000: 0.4028 - val_loss: 3.2293 - val_accuracy1000: 0.4050 - 17s/epoch - 13ms/step
Epoch 3/50
1288/1288 - 17s - loss: 3.2423 - accuracy1000: 0.4013 - val_loss: 3.2275 - val_accuracy1000: 0.4058 - 17s/epoch - 13ms/step
Epoch 4/50
1288/1288 - 17s - loss: 3.2438 - accuracy1000: 0.4011 - val_loss: 3.2236 - val_accuracy1000: 0.4093 - 17s/epoch - 13ms/step
Epoch 5/50
1288/1288 - 17s - loss: 3.2449 - accuracy1000: 0.4013 - val_loss: 3.2210 - val_accuracy1000: 0.4113 - 17s/epoch - 13ms/step
Epoch 6/50
1288/1288 - 17s - loss: 3.2449 - accuracy1000: 0.4002 - val_loss: 3.2201 - val_accuracy1000: 0.4113 - 17s/epoch - 13ms/step
Epoch 7/50
1288/1288 - 17s - loss: 3.2452 - accuracy1000: 0.4010 - val_loss: 3.2194 - val_accuracy1000: 0.4129 - 17s/epoch - 14ms/step
Epoch 8/50
1288/1288 - 17s - loss: 3.2440 - accuracy1000: 0.4013 - val_loss: 3.2185 - val_accuracy1000: 0.4130 - 17s/epoch - 13ms/step
Epoch 9/50
1288/1288 - 17s - loss: 3.2426 - accuracy1000: 0.4029 - val_loss: 3.2189 - val_accuracy1000: 0.4140 - 17s/epoch - 13ms/step
Epoch 10/50
1288/1288 - 17s - loss: 3.2440 - accuracy1000: 0.4018 - val_loss: 3.2186 - val_accuracy1000: 0.4128 - 17s/epoch - 13ms/step
Epoch 11/50
1288/1288 - 17s - loss: 3.2423 - accuracy1000: 0.4029 - val_loss: 3.2190 - val_accuracy1000: 0.4140 - 17s/epoch - 13ms/step
Epoch 12/50
1288/1288 - 17s - loss: 3.2420 - accuracy1000: 0.4033 - val_loss: 3.2181 - val_accuracy1000: 0.4137 - 17s/epoch - 13ms/step
Epoch 13/50
1288/1288 - 17s - loss: 3.2404 - accuracy1000: 0.4046 - val_loss: 3.2178 - val_accuracy1000: 0.4146 - 17s/epoch - 13ms/step
Epoch 14/50
1288/1288 - 17s - loss: 3.2390 - accuracy1000: 0.4052 - val_loss: 3.2184 - val_accuracy1000: 0.4145 - 17s/epoch - 13ms/step
Epoch 15/50
1288/1288 - 17s - loss: 3.2374 - accuracy1000: 0.4077 - val_loss: 3.2190 - val_accuracy1000: 0.4139 - 17s/epoch - 13ms/step
Epoch 16/50
1288/1288 - 17s - loss: 3.2368 - accuracy1000: 0.4076 - val_loss: 3.2189 - val_accuracy1000: 0.4138 - 17s/epoch - 13ms/step
Epoch 17/50
1288/1288 - 17s - loss: 3.2351 - accuracy1000: 0.4089 - val_loss: 3.2193 - val_accuracy1000: 0.4146 - 17s/epoch - 13ms/step
Epoch 18/50
1288/1288 - 17s - loss: 3.2341 - accuracy1000: 0.4093 - val_loss: 3.2198 - val_accuracy1000: 0.4154 - 17s/epoch - 13ms/step
Epoch 19/50
1288/1288 - 17s - loss: 3.2321 - accuracy1000: 0.4104 - val_loss: 3.2200 - val_accuracy1000: 0.4141 - 17s/epoch - 13ms/step
Epoch 20/50
1288/1288 - 17s - loss: 3.2323 - accuracy1000: 0.4101 - val_loss: 3.2204 - val_accuracy1000: 0.4130 - 17s/epoch - 13ms/step
Epoch 21/50
1288/1288 - 17s - loss: 3.2312 - accuracy1000: 0.4101 - val_loss: 3.2202 - val_accuracy1000: 0.4142 - 17s/epoch - 13ms/step
Epoch 22/50
1288/1288 - 17s - loss: 3.2304 - accuracy1000: 0.4106 - val_loss: 3.2197 - val_accuracy1000: 0.4142 - 17s/epoch - 13ms/step
Epoch 23/50
1288/1288 - 17s - loss: 3.2282 - accuracy1000: 0.4114 - val_loss: 3.2204 - val_accuracy1000: 0.4144 - 17s/epoch - 13ms/step
testing model: results/EXC/W8/deepOF_L1/h1000
Evaluating performance on  test set...
5521/5521 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1411918
{'0': {'precision': 0.3421223534125214, 'recall': 0.7060401580718436, 'f1-score': 0.46090585732018113, 'support': 449922}, '1': {'precision': 0.5318471337579618, 'recall': 0.000647625695615923, 'f1-score': 0.001293676092943268, 'support': 515730}, '2': {'precision': 0.35815106264328644, 'recall': 0.3873670007796217, 'f1-score': 0.37218656332801403, 'support': 447653}, 'accuracy': 0.34769777224307563, 'macro avg': {'precision': 0.4107068499379232, 'recall': 0.3646849281823605, 'f1-score': 0.27812869891371284, 'support': 1413305}, 'weighted avg': {'precision': 0.41643190495364923, 'recall': 0.34769777224307563, 'f1-score': 0.26508736921053816, 'support': 1413305}}
[[317663    143 132116]
 [336748    334 178648]
 [274096    151 173406]]
Evaluating performance on  train set...
1288/1288 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243594
{'0': {'precision': 0.3517985225463717, 'recall': 0.7275013870908082, 'f1-score': 0.4742591208314244, 'support': 108140}, '1': {'precision': 0.4927536231884058, 'recall': 0.0003112783469288729, 'f1-score': 0.0006221636656419265, 'support': 109227}, '2': {'precision': 0.39247955786515265, 'recall': 0.37036872224348305, 'f1-score': 0.38110370343236016, 'support': 112361}, 'accuracy': 0.36490986510093165, 'macro avg': {'precision': 0.41234390119997677, 'recall': 0.36606046256040675, 'f1-score': 0.28532832930980884, 'support': 329728}, 'weighted avg': {'precision': 0.4123546918352431, 'recall': 0.36490986510093165, 'f1-score': 0.2856158155169738, 'support': 329728}}
[[78672    19 29449]
 [74226    34 34967]
 [70730    16 41615]]
Evaluating performance on  val set...
438/438 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0726701
{'0': {'precision': 0.4122351474864977, 'recall': 0.7280398046454039, 'f1-score': 0.5264056632708041, 'support': 43613}, '1': {'precision': 0.5454545454545454, 'recall': 0.00022723829722769278, 'f1-score': 0.0004542873367404884, 'support': 26404}, '2': {'precision': 0.42098478989430266, 'recall': 0.3505211190345584, 'f1-score': 0.38253513794898486, 'support': 41929}, 'accuracy': 0.41497686384506816, 'macro avg': {'precision': 0.4595581609451152, 'recall': 0.35959605399239664, 'f1-score': 0.3031316961855098, 'support': 111946}, 'weighted avg': {'precision': 0.44693391957719486, 'recall': 0.41497686384506816, 'f1-score': 0.3484665909825439, 'support': 111946}}
[[31752     4 11857]
 [18041     6  8357]
 [27231     1 14697]]
training model: results/EXC/W8/deepLOB_L2/h10
Epoch 1/50
1289/1289 - 54s - loss: 2.7450 - accuracy10: 0.4500 - val_loss: 2.4799 - val_accuracy10: 0.3213 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 2.4251 - accuracy10: 0.5666 - val_loss: 2.3553 - val_accuracy10: 0.3780 - 52s/epoch - 40ms/step
Epoch 3/50
1289/1289 - 51s - loss: 2.3137 - accuracy10: 0.6160 - val_loss: 2.4220 - val_accuracy10: 0.3718 - 51s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 2.2341 - accuracy10: 0.6473 - val_loss: 2.2850 - val_accuracy10: 0.4398 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 2.1741 - accuracy10: 0.6665 - val_loss: 2.4624 - val_accuracy10: 0.3978 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 2.1424 - accuracy10: 0.6713 - val_loss: 2.4859 - val_accuracy10: 0.3988 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 2.1121 - accuracy10: 0.6770 - val_loss: 2.4020 - val_accuracy10: 0.4285 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 53s - loss: 2.0890 - accuracy10: 0.6806 - val_loss: 2.4713 - val_accuracy10: 0.4159 - 53s/epoch - 41ms/step
Epoch 9/50
1289/1289 - 52s - loss: 2.0656 - accuracy10: 0.6814 - val_loss: 2.4069 - val_accuracy10: 0.4400 - 52s/epoch - 41ms/step
Epoch 10/50
1289/1289 - 52s - loss: 2.0467 - accuracy10: 0.6821 - val_loss: 2.3320 - val_accuracy10: 0.4620 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 2.0292 - accuracy10: 0.6831 - val_loss: 2.3217 - val_accuracy10: 0.4687 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 51s - loss: 2.0145 - accuracy10: 0.6840 - val_loss: 2.2258 - val_accuracy10: 0.4990 - 51s/epoch - 40ms/step
Epoch 13/50
1289/1289 - 51s - loss: 2.0005 - accuracy10: 0.6842 - val_loss: 2.3590 - val_accuracy10: 0.4671 - 51s/epoch - 40ms/step
Epoch 14/50
1289/1289 - 51s - loss: 1.9883 - accuracy10: 0.6846 - val_loss: 2.3681 - val_accuracy10: 0.4518 - 51s/epoch - 40ms/step
Epoch 15/50
1289/1289 - 51s - loss: 1.9778 - accuracy10: 0.6845 - val_loss: 2.3116 - val_accuracy10: 0.4734 - 51s/epoch - 40ms/step
Epoch 16/50
1289/1289 - 51s - loss: 1.9671 - accuracy10: 0.6834 - val_loss: 2.3634 - val_accuracy10: 0.4524 - 51s/epoch - 40ms/step
Epoch 17/50
1289/1289 - 53s - loss: 1.9550 - accuracy10: 0.6847 - val_loss: 2.2958 - val_accuracy10: 0.4825 - 53s/epoch - 41ms/step
Epoch 18/50
1289/1289 - 53s - loss: 1.9448 - accuracy10: 0.6844 - val_loss: 2.3460 - val_accuracy10: 0.4373 - 53s/epoch - 41ms/step
Epoch 19/50
1289/1289 - 52s - loss: 1.9322 - accuracy10: 0.6848 - val_loss: 2.2929 - val_accuracy10: 0.4680 - 52s/epoch - 41ms/step
Epoch 20/50
1289/1289 - 52s - loss: 1.9233 - accuracy10: 0.6846 - val_loss: 2.2216 - val_accuracy10: 0.4870 - 52s/epoch - 40ms/step
Epoch 21/50
1289/1289 - 52s - loss: 1.9157 - accuracy10: 0.6838 - val_loss: 2.2333 - val_accuracy10: 0.4750 - 52s/epoch - 40ms/step
Epoch 22/50
1289/1289 - 52s - loss: 1.9037 - accuracy10: 0.6855 - val_loss: 2.2103 - val_accuracy10: 0.4957 - 52s/epoch - 40ms/step
Epoch 23/50
1289/1289 - 52s - loss: 1.8945 - accuracy10: 0.6850 - val_loss: 2.2825 - val_accuracy10: 0.4726 - 52s/epoch - 40ms/step
Epoch 24/50
1289/1289 - 52s - loss: 1.8858 - accuracy10: 0.6860 - val_loss: 2.2837 - val_accuracy10: 0.4775 - 52s/epoch - 40ms/step
Epoch 25/50
1289/1289 - 52s - loss: 1.8758 - accuracy10: 0.6852 - val_loss: 2.2830 - val_accuracy10: 0.4722 - 52s/epoch - 40ms/step
Epoch 26/50
1289/1289 - 52s - loss: 1.8672 - accuracy10: 0.6858 - val_loss: 2.3193 - val_accuracy10: 0.4585 - 52s/epoch - 41ms/step
Epoch 27/50
1289/1289 - 52s - loss: 1.8599 - accuracy10: 0.6866 - val_loss: 2.2710 - val_accuracy10: 0.4880 - 52s/epoch - 41ms/step
Epoch 28/50
1289/1289 - 52s - loss: 1.8525 - accuracy10: 0.6851 - val_loss: 2.3356 - val_accuracy10: 0.4864 - 52s/epoch - 41ms/step
Epoch 29/50
1289/1289 - 52s - loss: 1.8421 - accuracy10: 0.6869 - val_loss: 2.3275 - val_accuracy10: 0.4734 - 52s/epoch - 40ms/step
Epoch 30/50
1289/1289 - 52s - loss: 1.8343 - accuracy10: 0.6873 - val_loss: 2.3155 - val_accuracy10: 0.4819 - 52s/epoch - 40ms/step
Epoch 31/50
1289/1289 - 52s - loss: 1.8233 - accuracy10: 0.6866 - val_loss: 2.3960 - val_accuracy10: 0.4554 - 52s/epoch - 40ms/step
Epoch 32/50
1289/1289 - 52s - loss: 1.8188 - accuracy10: 0.6878 - val_loss: 2.3196 - val_accuracy10: 0.4903 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h10
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0753005
{'0': {'precision': 0.25618063135107677, 'recall': 0.6623309622449777, 'f1-score': 0.36945938462678857, 'support': 127930}, '1': {'precision': 0.9540723897565885, 'recall': 0.4440155679284021, 'f1-score': 0.6060033514401071, 'support': 1152883}, '2': {'precision': 0.20250943648481096, 'recall': 0.8345396499543386, 'f1-score': 0.32592893903754666, 'support': 132497}, 'accuracy': 0.5003884498093129, 'macro avg': {'precision': 0.47092081919749207, 'recall': 0.6469620600425728, 'f1-score': 0.4337972250348141, 'support': 1413310}, 'weighted avg': {'precision': 0.8204420260908195, 'recall': 0.5003884498093129, 'f1-score': 0.558335048594638, 'support': 1413310}}
[[ 84732  15538  27660]
 [233200 511898 407785]
 [ 12819   9104 110574]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0585505
{'0': {'precision': 0.26404424063812115, 'recall': 0.6921493766032333, 'f1-score': 0.3822616115773954, 'support': 33526}, '1': {'precision': 0.9552560340132183, 'recall': 0.44787946471110635, 'f1-score': 0.6098335642778183, 'support': 262363}, '2': {'precision': 0.22549564105153322, 'recall': 0.7918501226323099, 'f1-score': 0.3510286421661416, 'support': 33841}, 'accuracy': 0.5080186819519, 'macro avg': {'precision': 0.48159863856762425, 'recall': 0.6439596546488832, 'f1-score': 0.4477079393404518, 'support': 329730}, 'weighted avg': {'precision': 0.8100785007499123, 'recall': 0.5080186819519, 'f1-score': 0.5601329163070069, 'support': 329730}}
[[ 23205   2997   7324]
 [ 60141 117507  84715]
 [  4537   2507  26797]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0386395
{'0': {'precision': 0.22857052618280588, 'recall': 0.7239171751525457, 'f1-score': 0.3474399289469262, 'support': 9997}, '1': {'precision': 0.95543688861585, 'recall': 0.43869679841168235, 'f1-score': 0.6013011636120301, 'support': 92173}, '2': {'precision': 0.20607449554817975, 'recall': 0.8002250409165302, 'f1-score': 0.3277472872763836, 'support': 9776}, 'accuracy': 0.49573901702606615, 'macro avg': {'precision': 0.4633606367822785, 'recall': 0.654279671493586, 'f1-score': 0.42549612661178, 'support': 111946}, 'weighted avg': {'precision': 0.825086096449335, 'recall': 0.49573901702606615, 'f1-score': 0.5547419881345291, 'support': 111946}}
[[ 7237  1044  1716]
 [23314 40436 28423]
 [ 1111   842  7823]]
training model: results/EXC/W8/deepLOB_L2/h20
Epoch 1/50
1289/1289 - 54s - loss: 2.7752 - accuracy20: 0.4474 - val_loss: 2.5876 - val_accuracy20: 0.4049 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 2.5171 - accuracy20: 0.5378 - val_loss: 2.5571 - val_accuracy20: 0.4138 - 52s/epoch - 40ms/step
Epoch 3/50
1289/1289 - 52s - loss: 2.4001 - accuracy20: 0.5861 - val_loss: 2.8306 - val_accuracy20: 0.3883 - 52s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 2.3057 - accuracy20: 0.6235 - val_loss: 2.8245 - val_accuracy20: 0.4091 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 51s - loss: 2.2520 - accuracy20: 0.6418 - val_loss: 2.8446 - val_accuracy20: 0.3996 - 51s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 2.2220 - accuracy20: 0.6501 - val_loss: 2.8863 - val_accuracy20: 0.4216 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 2.1987 - accuracy20: 0.6539 - val_loss: 2.9018 - val_accuracy20: 0.3971 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 2.1783 - accuracy20: 0.6568 - val_loss: 2.7578 - val_accuracy20: 0.4421 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 2.1617 - accuracy20: 0.6588 - val_loss: 2.7138 - val_accuracy20: 0.4523 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 52s - loss: 2.1420 - accuracy20: 0.6596 - val_loss: 2.6844 - val_accuracy20: 0.4430 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 2.1290 - accuracy20: 0.6603 - val_loss: 2.6072 - val_accuracy20: 0.4663 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 52s - loss: 2.1149 - accuracy20: 0.6608 - val_loss: 2.5607 - val_accuracy20: 0.4736 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h20
Evaluating performance on  test set...
5521/5521 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2001941
{'0': {'precision': 0.25412818359921635, 'recall': 0.5034740296480706, 'f1-score': 0.33776812793465094, 'support': 176740}, '1': {'precision': 0.8523665750220291, 'recall': 0.305752513948451, 'f1-score': 0.45006290907490476, 'support': 1053522}, '2': {'precision': 0.22117718136671885, 'recall': 0.8279850093964425, 'f1-score': 0.34910024818753993, 'support': 183048}, 'accuracy': 0.3981164783380858, 'macro avg': {'precision': 0.44255731332932147, 'recall': 0.5457371843309881, 'f1-score': 0.37897709506569854, 'support': 1413310}, 'weighted avg': {'precision': 0.6958045968078473, 'recall': 0.3981164783380858, 'f1-score': 0.4229435985422977, 'support': 1413310}}
[[ 88984  37111  50645]
 [248364 322117 483041]
 [ 12806  18681 151561]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1419382
{'0': {'precision': 0.30277270086850566, 'recall': 0.4716189971751412, 'f1-score': 0.36878845141639266, 'support': 45312}, '1': {'precision': 0.874780046216795, 'recall': 0.34553432733332495, 'f1-score': 0.49539125554144875, 'support': 238833}, '2': {'precision': 0.23158041635570442, 'recall': 0.8372710321377647, 'f1-score': 0.3628110800585563, 'support': 45585}, 'accuracy': 0.4308434173414612, 'macro avg': {'precision': 0.46971105448033507, 'recall': 0.5514747855487436, 'f1-score': 0.40899692900546586, 'support': 329730}, 'weighted avg': {'precision': 0.7072519111983269, 'recall': 0.4308434173414612, 'f1-score': 0.459664165013131, 'support': 329730}}
[[ 21370   7916  16026]
 [ 45690  82525 110618]
 [  3521   3897  38167]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1386821
{'0': {'precision': 0.2674578109547963, 'recall': 0.6099228866579368, 'f1-score': 0.3718537245248708, 'support': 13746}, '1': {'precision': 0.8908440103034155, 'recall': 0.3142776217338967, 'f1-score': 0.46463747633629077, 'support': 84734}, '2': {'precision': 0.22374078018380467, 'recall': 0.8424922025842864, 'f1-score': 0.35358100105965223, 'support': 13466}, 'accuracy': 0.41411930752327014, 'macro avg': {'precision': 0.46068086714733886, 'recall': 0.5888975703253733, 'f1-score': 0.3966907339736046, 'support': 111946}, 'weighted avg': {'precision': 0.7340516390437296, 'recall': 0.41411930752327014, 'f1-score': 0.4398854356338539, 'support': 111946}}
[[ 8384  2222  3140]
 [21883 26630 36221]
 [ 1080  1041 11345]]
training model: results/EXC/W8/deepLOB_L2/h30
Epoch 1/50
1289/1289 - 55s - loss: 2.8212 - accuracy30: 0.4467 - val_loss: 2.5927 - val_accuracy30: 0.4930 - 55s/epoch - 43ms/step
Epoch 2/50
1289/1289 - 52s - loss: 2.6375 - accuracy30: 0.5015 - val_loss: 2.5672 - val_accuracy30: 0.4032 - 52s/epoch - 41ms/step
Epoch 3/50
1289/1289 - 52s - loss: 2.5515 - accuracy30: 0.5440 - val_loss: 2.8335 - val_accuracy30: 0.3448 - 52s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 2.4854 - accuracy30: 0.5730 - val_loss: 2.6680 - val_accuracy30: 0.4021 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 2.4278 - accuracy30: 0.5934 - val_loss: 2.7107 - val_accuracy30: 0.4128 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 51s - loss: 2.3688 - accuracy30: 0.6109 - val_loss: 2.5916 - val_accuracy30: 0.4841 - 51s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 2.3264 - accuracy30: 0.6244 - val_loss: 2.5868 - val_accuracy30: 0.4747 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 2.2959 - accuracy30: 0.6306 - val_loss: 2.5657 - val_accuracy30: 0.4786 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 2.2716 - accuracy30: 0.6327 - val_loss: 2.5626 - val_accuracy30: 0.4628 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 52s - loss: 2.2505 - accuracy30: 0.6351 - val_loss: 2.5804 - val_accuracy30: 0.4640 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 51s - loss: 2.2345 - accuracy30: 0.6364 - val_loss: 2.5696 - val_accuracy30: 0.4565 - 51s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 51s - loss: 2.2189 - accuracy30: 0.6387 - val_loss: 2.5470 - val_accuracy30: 0.4720 - 51s/epoch - 40ms/step
Epoch 13/50
1289/1289 - 51s - loss: 2.2065 - accuracy30: 0.6391 - val_loss: 2.5625 - val_accuracy30: 0.4701 - 51s/epoch - 40ms/step
Epoch 14/50
1289/1289 - 52s - loss: 2.1921 - accuracy30: 0.6410 - val_loss: 2.5644 - val_accuracy30: 0.4804 - 52s/epoch - 40ms/step
Epoch 15/50
1289/1289 - 52s - loss: 2.1831 - accuracy30: 0.6413 - val_loss: 2.5015 - val_accuracy30: 0.4880 - 52s/epoch - 40ms/step
Epoch 16/50
1289/1289 - 51s - loss: 2.1714 - accuracy30: 0.6413 - val_loss: 2.6061 - val_accuracy30: 0.4552 - 51s/epoch - 40ms/step
Epoch 17/50
1289/1289 - 51s - loss: 2.1613 - accuracy30: 0.6427 - val_loss: 2.6483 - val_accuracy30: 0.4586 - 51s/epoch - 40ms/step
Epoch 18/50
1289/1289 - 52s - loss: 2.1528 - accuracy30: 0.6429 - val_loss: 2.5474 - val_accuracy30: 0.4772 - 52s/epoch - 40ms/step
Epoch 19/50
1289/1289 - 52s - loss: 2.1410 - accuracy30: 0.6442 - val_loss: 2.5633 - val_accuracy30: 0.4803 - 52s/epoch - 40ms/step
Epoch 20/50
1289/1289 - 52s - loss: 2.1332 - accuracy30: 0.6439 - val_loss: 2.5620 - val_accuracy30: 0.4755 - 52s/epoch - 40ms/step
Epoch 21/50
1289/1289 - 52s - loss: 2.1240 - accuracy30: 0.6448 - val_loss: 2.5742 - val_accuracy30: 0.4838 - 52s/epoch - 40ms/step
Epoch 22/50
1289/1289 - 52s - loss: 2.1161 - accuracy30: 0.6462 - val_loss: 2.6504 - val_accuracy30: 0.4641 - 52s/epoch - 40ms/step
Epoch 23/50
1289/1289 - 52s - loss: 2.1068 - accuracy30: 0.6454 - val_loss: 2.6153 - val_accuracy30: 0.4703 - 52s/epoch - 40ms/step
Epoch 24/50
1289/1289 - 52s - loss: 2.0978 - accuracy30: 0.6461 - val_loss: 2.6545 - val_accuracy30: 0.4678 - 52s/epoch - 40ms/step
Epoch 25/50
1289/1289 - 51s - loss: 2.0889 - accuracy30: 0.6472 - val_loss: 2.6504 - val_accuracy30: 0.4675 - 51s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h30
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1809915
{'0': {'precision': 0.34927325993357433, 'recall': 0.6290617487911048, 'f1-score': 0.44915994161590084, 'support': 215486}, '1': {'precision': 0.8615204811721444, 'recall': 0.34085507766442813, 'f1-score': 0.4884557547120605, 'support': 975350}, '2': {'precision': 0.2891496536923837, 'recall': 0.8309195681293094, 'f1-score': 0.4290093874377748, 'support': 222474}, 'accuracy': 0.4619404093935513, 'macro avg': {'precision': 0.49998113159936747, 'recall': 0.6002787981949474, 'f1-score': 0.4555416945885787, 'support': 1413310}, 'weighted avg': {'precision': 0.6933197805554738, 'recall': 0.4619404093935513, 'f1-score': 0.4731067027037831, 'support': 1413310}}
[[135554  32935  46997]
 [235436 332453 407461]
 [ 17113  20503 184858]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1168811
{'0': {'precision': 0.381086088447508, 'recall': 0.6088283418822275, 'f1-score': 0.46875973161962464, 'support': 54393}, '1': {'precision': 0.8762175589984964, 'recall': 0.3645127954094259, 'f1-score': 0.5148459706537605, 'support': 220626}, '2': {'precision': 0.2932425901528643, 'recall': 0.8095995320867833, 'f1-score': 0.43054043545878695, 'support': 54711}, 'accuracy': 0.4786673945349225, 'macro avg': {'precision': 0.5168487458662896, 'recall': 0.5943135564594789, 'f1-score': 0.471382045910724, 'support': 329730}, 'weighted avg': {'precision': 0.6978084679294603, 'recall': 0.4786673945349225, 'f1-score': 0.49325494485739396, 'support': 329730}}
[[33116  6844 14433]
 [47883 80421 92322]
 [ 5900  4517 44294]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941161
{'0': {'precision': 0.35497408832225863, 'recall': 0.6652168732125834, 'f1-score': 0.46292265273545213, 'support': 16784}, '1': {'precision': 0.882454852444575, 'recall': 0.3818794078403965, 'f1-score': 0.5330731707317073, 'support': 78695}, '2': {'precision': 0.28816917179895774, 'recall': 0.8126556142588207, 'f1-score': 0.42546697400842537, 'support': 16467}, 'accuracy': 0.487726225144266, 'macro avg': {'precision': 0.5085327041885971, 'recall': 0.6199172984372668, 'f1-score': 0.47382093249186163, 'support': 111946}, 'weighted avg': {'precision': 0.715951900590821, 'recall': 0.487726225144266, 'f1-score': 0.5067269186504233, 'support': 111946}}
[[11165  2473  3146]
 [18733 30052 29910]
 [ 1555  1530 13382]]
training model: results/EXC/W8/deepLOB_L2/h50
Epoch 1/50
1289/1289 - 54s - loss: 2.9510 - accuracy50: 0.4434 - val_loss: 2.8426 - val_accuracy50: 0.4751 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 2.7767 - accuracy50: 0.5043 - val_loss: 2.7484 - val_accuracy50: 0.4747 - 52s/epoch - 41ms/step
Epoch 3/50
1289/1289 - 52s - loss: 2.7089 - accuracy50: 0.5303 - val_loss: 2.8120 - val_accuracy50: 0.4471 - 52s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 2.6527 - accuracy50: 0.5506 - val_loss: 2.8608 - val_accuracy50: 0.4387 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 2.5983 - accuracy50: 0.5666 - val_loss: 2.7667 - val_accuracy50: 0.4808 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 2.5485 - accuracy50: 0.5806 - val_loss: 2.8076 - val_accuracy50: 0.4849 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 2.5193 - accuracy50: 0.5899 - val_loss: 2.6941 - val_accuracy50: 0.4972 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 2.4929 - accuracy50: 0.5969 - val_loss: 2.6575 - val_accuracy50: 0.5117 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 2.4698 - accuracy50: 0.6010 - val_loss: 2.6443 - val_accuracy50: 0.5241 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 51s - loss: 2.4495 - accuracy50: 0.6044 - val_loss: 2.6832 - val_accuracy50: 0.5146 - 51s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 2.4321 - accuracy50: 0.6063 - val_loss: 2.6912 - val_accuracy50: 0.5341 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 52s - loss: 2.4175 - accuracy50: 0.6084 - val_loss: 2.6317 - val_accuracy50: 0.5292 - 52s/epoch - 40ms/step
Epoch 13/50
1289/1289 - 52s - loss: 2.4036 - accuracy50: 0.6104 - val_loss: 2.6453 - val_accuracy50: 0.5285 - 52s/epoch - 40ms/step
Epoch 14/50
1289/1289 - 52s - loss: 2.3904 - accuracy50: 0.6120 - val_loss: 2.6091 - val_accuracy50: 0.5517 - 52s/epoch - 40ms/step
Epoch 15/50
1289/1289 - 52s - loss: 2.3798 - accuracy50: 0.6134 - val_loss: 2.6439 - val_accuracy50: 0.5244 - 52s/epoch - 41ms/step
Epoch 16/50
1289/1289 - 52s - loss: 2.3696 - accuracy50: 0.6135 - val_loss: 2.6683 - val_accuracy50: 0.5270 - 52s/epoch - 40ms/step
Epoch 17/50
1289/1289 - 52s - loss: 2.3572 - accuracy50: 0.6161 - val_loss: 2.6766 - val_accuracy50: 0.5287 - 52s/epoch - 40ms/step
Epoch 18/50
1289/1289 - 52s - loss: 2.3492 - accuracy50: 0.6160 - val_loss: 2.6394 - val_accuracy50: 0.5226 - 52s/epoch - 40ms/step
Epoch 19/50
1289/1289 - 51s - loss: 2.3374 - accuracy50: 0.6171 - val_loss: 2.6859 - val_accuracy50: 0.5267 - 51s/epoch - 40ms/step
Epoch 20/50
1289/1289 - 51s - loss: 2.3289 - accuracy50: 0.6193 - val_loss: 2.6450 - val_accuracy50: 0.5278 - 51s/epoch - 40ms/step
Epoch 21/50
1289/1289 - 52s - loss: 2.3179 - accuracy50: 0.6205 - val_loss: 2.7530 - val_accuracy50: 0.5210 - 52s/epoch - 40ms/step
Epoch 22/50
1289/1289 - 51s - loss: 2.3087 - accuracy50: 0.6212 - val_loss: 2.6672 - val_accuracy50: 0.5345 - 51s/epoch - 40ms/step
Epoch 23/50
1289/1289 - 52s - loss: 2.2997 - accuracy50: 0.6221 - val_loss: 2.6930 - val_accuracy50: 0.5106 - 52s/epoch - 40ms/step
Epoch 24/50
1289/1289 - 52s - loss: 2.2918 - accuracy50: 0.6231 - val_loss: 2.6944 - val_accuracy50: 0.5225 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h50
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9595066
{'0': {'precision': 0.4685359083392393, 'recall': 0.4482916940377049, 'f1-score': 0.45819029776665987, 'support': 283146}, '1': {'precision': 0.7559744306522157, 'recall': 0.5112719882395828, 'f1-score': 0.6099974629336021, 'support': 839426}, '2': {'precision': 0.3695890110616736, 'recall': 0.7305477784121787, 'f1-score': 0.49085247132911575, 'support': 290738}, 'accuracy': 0.5437625149471808, 'macro avg': {'precision': 0.5313664500177094, 'recall': 0.5633704868964888, 'f1-score': 0.5196800773431259, 'support': 1413310}, 'weighted avg': {'precision': 0.6189033054498574, 'recall': 0.5437625149471808, 'f1-score': 0.5550742202214836, 'support': 1413310}}
[[126932  79304  76910]
 [124872 429175 285379]
 [ 19108  59232 212398]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95964617
{'0': {'precision': 0.4465359798775153, 'recall': 0.46743081194012764, 'f1-score': 0.4567445502467945, 'support': 69882}, '1': {'precision': 0.7583152812527478, 'recall': 0.4989218584005638, 'f1-score': 0.6018595178957186, 'support': 190142}, '2': {'precision': 0.3772979304365022, 'recall': 0.7116460562935759, 'f1-score': 0.49314305880715575, 'support': 69706}, 'accuracy': 0.5372183301489097, 'macro avg': {'precision': 0.5273830638555884, 'recall': 0.5593329088780892, 'f1-score': 0.5172490423165562, 'support': 329730}, 'weighted avg': {'precision': 0.6116893855359455, 'recall': 0.5372183301489097, 'f1-score': 0.5481212663976157, 'support': 329730}}
[[32665 16639 20578]
 [33983 94866 61293]
 [ 6504 13596 49606]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9409396
{'0': {'precision': 0.451295799821269, 'recall': 0.50173869846001, 'f1-score': 0.4751823100446954, 'support': 22143}, '1': {'precision': 0.7618563612378625, 'recall': 0.5168422288078401, 'f1-score': 0.6158754578114211, 'support': 68162}, '2': {'precision': 0.37357314965804267, 'recall': 0.7092555796867058, 'f1-score': 0.48938273179441394, 'support': 21641}, 'accuracy': 0.5510513997820378, 'macro avg': {'precision': 0.5289084369057248, 'recall': 0.5759455023181853, 'f1-score': 0.5268134998835101, 'support': 111946}, 'weighted avg': {'precision': 0.625365736354021, 'recall': 0.5510513997820378, 'f1-score': 0.5635931301290326, 'support': 111946}}
[[11110  6249  4784]
 [11979 35229 20954]
 [ 1529  4763 15349]]
training model: results/EXC/W8/deepLOB_L2/h100
Epoch 1/50
1289/1289 - 56s - loss: 3.1071 - accuracy100: 0.4445 - val_loss: 3.1559 - val_accuracy100: 0.4343 - 56s/epoch - 43ms/step
Epoch 2/50
1289/1289 - 53s - loss: 2.9926 - accuracy100: 0.4822 - val_loss: 3.0411 - val_accuracy100: 0.4500 - 53s/epoch - 41ms/step
Epoch 3/50
1289/1289 - 53s - loss: 2.9524 - accuracy100: 0.4962 - val_loss: 3.0476 - val_accuracy100: 0.4428 - 53s/epoch - 41ms/step
Epoch 4/50
1289/1289 - 52s - loss: 2.9286 - accuracy100: 0.5031 - val_loss: 3.0585 - val_accuracy100: 0.4482 - 52s/epoch - 41ms/step
Epoch 5/50
1289/1289 - 51s - loss: 2.9068 - accuracy100: 0.5107 - val_loss: 3.0462 - val_accuracy100: 0.4574 - 51s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 2.8885 - accuracy100: 0.5159 - val_loss: 3.0472 - val_accuracy100: 0.4690 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 2.8714 - accuracy100: 0.5201 - val_loss: 3.0529 - val_accuracy100: 0.4574 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 2.8583 - accuracy100: 0.5233 - val_loss: 3.0737 - val_accuracy100: 0.4472 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 2.8406 - accuracy100: 0.5283 - val_loss: 3.0477 - val_accuracy100: 0.4561 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 52s - loss: 2.8282 - accuracy100: 0.5326 - val_loss: 3.0736 - val_accuracy100: 0.4525 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 2.8152 - accuracy100: 0.5354 - val_loss: 3.0981 - val_accuracy100: 0.4387 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 52s - loss: 2.7987 - accuracy100: 0.5391 - val_loss: 3.0991 - val_accuracy100: 0.4513 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h100
Evaluating performance on  test set...
5521/5521 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.999041
{'0': {'precision': 0.5180157977883096, 'recall': 0.4029690802733127, 'f1-score': 0.45330679053306794, 'support': 406860}, '1': {'precision': 0.5088071446478236, 'recall': 0.5068109296650846, 'f1-score': 0.5078070753588265, 'support': 596688}, '2': {'precision': 0.4459552245637987, 'recall': 0.5468442656956966, 'f1-score': 0.4912735344898463, 'support': 409762}, 'accuracy': 0.4885241029922664, 'macro avg': {'precision': 0.490926055666644, 'recall': 0.4855414252113646, 'f1-score': 0.48412913346058023, 'support': 1413310}, 'weighted avg': {'precision': 0.4932354046468811, 'recall': 0.4885241029922664, 'f1-score': 0.48732409380646835, 'support': 1413310}}
[[163952 149575  93333]
 [109226 302408 185054]
 [ 43322 142364 224076]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0285286
{'0': {'precision': 0.4693866923567625, 'recall': 0.37366953746022863, 'f1-score': 0.4160944478424946, 'support': 96489}, '1': {'precision': 0.47982517165240013, 'recall': 0.4602384820703261, 'f1-score': 0.46982777769550854, 'support': 137872}, '2': {'precision': 0.42185907369502706, 'recall': 0.5337898059117743, 'f1-score': 0.4712694753797873, 'support': 95369}, 'accuracy': 0.45617929821368997, 'macro avg': {'precision': 0.4570236459013966, 'recall': 0.45589927514744294, 'f1-score': 0.4523972336392635, 'support': 329730}, 'weighted avg': {'precision': 0.460004811888795, 'recall': 0.45617929821368997, 'f1-score': 0.45452076287206067, 'support': 329730}}
[[36055 35461 24973]
 [29625 63454 44793]
 [11133 33329 50907]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0262821
{'0': {'precision': 0.4319200717304983, 'recall': 0.5305724265978538, 'f1-score': 0.4761904761904762, 'support': 31777}, '1': {'precision': 0.5082947142185507, 'recall': 0.30749852711130976, 'f1-score': 0.3831850229743927, 'support': 49223}, '2': {'precision': 0.42278533837201215, 'recall': 0.5892845602016415, 'f1-score': 0.49233925943924733, 'support': 30946}, 'accuracy': 0.4487163453808086, 'macro avg': {'precision': 0.454333374773687, 'recall': 0.47578517130360165, 'f1-score': 0.4505715862013721, 'support': 111946}, 'weighted avg': {'precision': 0.4629770596414347, 'recall': 0.4487163453808086, 'f1-score': 0.43975981160899225, 'support': 111946}}
[[16860  7733  7184]
 [16374 15136 17713]
 [ 5801  6909 18236]]
training model: results/EXC/W8/deepLOB_L2/h200
Epoch 1/50
1289/1289 - 54s - loss: 3.2402 - accuracy200: 0.4081 - val_loss: 3.3093 - val_accuracy200: 0.3829 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 3.1753 - accuracy200: 0.4340 - val_loss: 3.2724 - val_accuracy200: 0.4029 - 52s/epoch - 40ms/step
Epoch 3/50
1289/1289 - 51s - loss: 3.1395 - accuracy200: 0.4487 - val_loss: 3.3988 - val_accuracy200: 0.3761 - 51s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 51s - loss: 3.1168 - accuracy200: 0.4573 - val_loss: 3.3047 - val_accuracy200: 0.3981 - 51s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 3.0988 - accuracy200: 0.4638 - val_loss: 3.3589 - val_accuracy200: 0.3820 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 3.0894 - accuracy200: 0.4673 - val_loss: 3.3290 - val_accuracy200: 0.3941 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 3.0740 - accuracy200: 0.4717 - val_loss: 3.3406 - val_accuracy200: 0.3896 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 3.0632 - accuracy200: 0.4750 - val_loss: 3.3587 - val_accuracy200: 0.3804 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 3.0458 - accuracy200: 0.4809 - val_loss: 3.3646 - val_accuracy200: 0.3802 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 51s - loss: 3.0310 - accuracy200: 0.4863 - val_loss: 3.3683 - val_accuracy200: 0.3856 - 51s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 3.0157 - accuracy200: 0.4914 - val_loss: 3.4042 - val_accuracy200: 0.3897 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 52s - loss: 3.0016 - accuracy200: 0.4957 - val_loss: 3.4105 - val_accuracy200: 0.3889 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h200
Evaluating performance on  test set...
5521/5521 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0839605
{'0': {'precision': 0.49088921436621263, 'recall': 0.24231185932161015, 'f1-score': 0.3244629134426129, 'support': 479960}, '1': {'precision': 0.3721073704516913, 'recall': 0.5905780193036553, 'f1-score': 0.4565529635086702, 'support': 458566}, '2': {'precision': 0.4007378593163098, 'recall': 0.3786332311114107, 'f1-score': 0.3893720779874786, 'support': 474784}, 'accuracy': 0.40110662204328845, 'macro avg': {'precision': 0.42124481471140457, 'recall': 0.40384103657889203, 'f1-score': 0.3901293183129206, 'support': 1413310}, 'weighted avg': {'precision': 0.42206373659239127, 'recall': 0.40110662204328845, 'f1-score': 0.3891266027095544, 'support': 1413310}}
[[116300 228399 135261]
 [ 54182 270819 133565]
 [ 66435 228580 179769]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0881281
{'0': {'precision': 0.4393036778082974, 'recall': 0.33399025466248405, 'f1-score': 0.37947574929641115, 'support': 110617}, '1': {'precision': 0.3792302167391947, 'recall': 0.49356195643208667, 'f1-score': 0.428907621918441, 'support': 109117}, '2': {'precision': 0.4079446422884276, 'recall': 0.38428670133459397, 'f1-score': 0.3957624301891739, 'support': 109996}, 'accuracy': 0.403575652806842, 'macro avg': {'precision': 0.40882617894530654, 'recall': 0.40394630414305494, 'f1-score': 0.401381933801342, 'support': 329730}, 'weighted avg': {'precision': 0.40896247645409584, 'recall': 0.403575652806842, 'f1-score': 0.40126729812842027, 'support': 329730}}
[[36945 43257 30415]
 [24329 53856 30932]
 [22825 44901 42270]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0898101
{'0': {'precision': 0.4015783641996246, 'recall': 0.4762019681977851, 'f1-score': 0.43571814122380886, 'support': 37293}, '1': {'precision': 0.38151731383793724, 'recall': 0.22840444491036796, 'f1-score': 0.28574238921949535, 'support': 38156}, '2': {'precision': 0.41873885918003567, 'recall': 0.5149190344411869, 'f1-score': 0.46187497695909163, 'support': 36497}, 'accuracy': 0.4043646043628178, 'macro avg': {'precision': 0.40061151240586584, 'recall': 0.40650848251644667, 'f1-score': 0.3944451691341319, 'support': 111946}, 'weighted avg': {'precision': 0.40033541802646544, 'recall': 0.4043646043628178, 'f1-score': 0.3931277069104259, 'support': 111946}}
[[17759  7820 11714]
 [15068  8715 14373]
 [11396  6308 18793]]
training model: results/EXC/W8/deepLOB_L2/h300
Epoch 1/50
1289/1289 - 55s - loss: 3.2652 - accuracy300: 0.3921 - val_loss: 3.3194 - val_accuracy300: 0.3714 - 55s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 3.2233 - accuracy300: 0.4090 - val_loss: 3.3312 - val_accuracy300: 0.3652 - 52s/epoch - 40ms/step
Epoch 3/50
1289/1289 - 52s - loss: 3.1994 - accuracy300: 0.4206 - val_loss: 3.3080 - val_accuracy300: 0.3767 - 52s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 3.1850 - accuracy300: 0.4284 - val_loss: 3.3157 - val_accuracy300: 0.3698 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 3.1664 - accuracy300: 0.4378 - val_loss: 3.3793 - val_accuracy300: 0.3593 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 3.1572 - accuracy300: 0.4419 - val_loss: 3.4180 - val_accuracy300: 0.3520 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 3.1387 - accuracy300: 0.4486 - val_loss: 3.4919 - val_accuracy300: 0.3506 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 3.1237 - accuracy300: 0.4546 - val_loss: 3.5123 - val_accuracy300: 0.3598 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 3.1123 - accuracy300: 0.4601 - val_loss: 3.4778 - val_accuracy300: 0.3593 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 52s - loss: 3.0964 - accuracy300: 0.4642 - val_loss: 3.5510 - val_accuracy300: 0.3548 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 3.0806 - accuracy300: 0.4684 - val_loss: 3.4975 - val_accuracy300: 0.3515 - 52s/epoch - 40ms/step
Epoch 12/50
1289/1289 - 52s - loss: 3.0631 - accuracy300: 0.4762 - val_loss: 3.5451 - val_accuracy300: 0.3460 - 52s/epoch - 40ms/step
Epoch 13/50
1289/1289 - 51s - loss: 3.0454 - accuracy300: 0.4812 - val_loss: 3.5752 - val_accuracy300: 0.3424 - 51s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h300
Evaluating performance on  test set...
5521/5521 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102674
{'0': {'precision': 0.40806670876997675, 'recall': 0.23737974407671472, 'f1-score': 0.3001543209876543, 'support': 481785}, '1': {'precision': 0.35475133387018287, 'recall': 0.3606364326849203, 'f1-score': 0.35766967655381493, 'support': 456859}, '2': {'precision': 0.3855167968124868, 'recall': 0.5430344705540316, 'f1-score': 0.4509151341540749, 'support': 474666}, 'accuracy': 0.37987844138936255, 'macro avg': {'precision': 0.3827782798175488, 'recall': 0.38035021577188893, 'f1-score': 0.3695797105651814, 'support': 1413310}, 'weighted avg': {'precision': 0.38325878597132756, 'recall': 0.37987844138936255, 'f1-score': 0.36938006761865017, 'support': 1413310}}
[[114366 156010 211409]
 [ 92659 164760 199440]
 [ 73238 143668 257760]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011677
{'0': {'precision': 0.38145427836944545, 'recall': 0.2824985268120212, 'f1-score': 0.3246022031823745, 'support': 110305}, '1': {'precision': 0.36691684312051703, 'recall': 0.30180919552807717, 'f1-score': 0.33119355565006375, 'support': 109662}, '2': {'precision': 0.3804431153658521, 'recall': 0.5470695954010003, 'f1-score': 0.4487892376681615, 'support': 109763}, 'accuracy': 0.3769932975464774, 'macro avg': {'precision': 0.3762714122852715, 'recall': 0.3771257725803662, 'f1-score': 0.3681949988335333, 'support': 329730}, 'weighted avg': {'precision': 0.37628279713015456, 'recall': 0.3769932975464774, 'f1-score': 0.3681346762984852, 'support': 329730}}
[[31161 29824 49320]
 [28096 33097 48469]
 [22433 27282 60048]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028932
{'0': {'precision': 0.4266398480277126, 'recall': 0.19862657371761525, 'f1-score': 0.2710588903482305, 'support': 38444}, '1': {'precision': 0.3318339279251331, 'recall': 0.3589284715619932, 'f1-score': 0.34484981999892533, 'support': 35762}, '2': {'precision': 0.3900769425279052, 'recall': 0.5722575516693164, 'f1-score': 0.4639228406332567, 'support': 37740}, 'accuracy': 0.3757972593929216, 'macro avg': {'precision': 0.3828502394935836, 'recall': 0.3766041989829749, 'f1-score': 0.3599438503268042, 'support': 111946}, 'weighted avg': {'precision': 0.38402704035016116, 'recall': 0.3757972593929216, 'f1-score': 0.3596515753028071, 'support': 111946}}
[[ 7636 13951 16857]
 [ 6014 12836 16912]
 [ 4248 11895 21597]]
training model: results/EXC/W8/deepLOB_L2/h500
Epoch 1/50
1289/1289 - 54s - loss: 3.2669 - accuracy500: 0.3968 - val_loss: 3.3178 - val_accuracy500: 0.3501 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 53s - loss: 3.2347 - accuracy500: 0.4085 - val_loss: 3.3320 - val_accuracy500: 0.3419 - 53s/epoch - 41ms/step
Epoch 3/50
1289/1289 - 52s - loss: 3.1992 - accuracy500: 0.4275 - val_loss: 3.3912 - val_accuracy500: 0.3568 - 52s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 52s - loss: 3.1796 - accuracy500: 0.4360 - val_loss: 3.4325 - val_accuracy500: 0.3510 - 52s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 52s - loss: 3.1600 - accuracy500: 0.4434 - val_loss: 3.5322 - val_accuracy500: 0.3483 - 52s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 52s - loss: 3.1400 - accuracy500: 0.4525 - val_loss: 3.5897 - val_accuracy500: 0.3437 - 52s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 3.1230 - accuracy500: 0.4585 - val_loss: 3.6573 - val_accuracy500: 0.3364 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 3.1076 - accuracy500: 0.4637 - val_loss: 3.6439 - val_accuracy500: 0.3339 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 52s - loss: 3.0892 - accuracy500: 0.4710 - val_loss: 3.6656 - val_accuracy500: 0.3319 - 52s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 52s - loss: 3.0780 - accuracy500: 0.4749 - val_loss: 3.7064 - val_accuracy500: 0.3335 - 52s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 3.0598 - accuracy500: 0.4801 - val_loss: 3.8543 - val_accuracy500: 0.3311 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h500
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1473716
{'0': {'precision': 0.36093118484814174, 'recall': 0.31515832675866495, 'f1-score': 0.3364952904576831, 'support': 495589}, '1': {'precision': 0.309080468115722, 'recall': 0.4448180868243564, 'f1-score': 0.36472966183875905, 'support': 421080}, '2': {'precision': 0.35448130775001535, 'recall': 0.26735005768754494, 'f1-score': 0.3048112505853941, 'support': 496641}, 'accuracy': 0.3369890540645718, 'macro avg': {'precision': 0.341497653571293, 'recall': 0.34244215709018877, 'f1-score': 0.3353454009606121, 'support': 1413310}, 'weighted avg': {'precision': 0.34321633586697137, 'recall': 0.3369890540645718, 'f1-score': 0.3337735491942165, 'support': 1413310}}
[[156189 210652 128748]
 [120734 187304 113042]
 [155816 208048 132777]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1347735
{'0': {'precision': 0.3545119470194166, 'recall': 0.38003248530861045, 'f1-score': 0.36682888159778043, 'support': 109588}, '1': {'precision': 0.34532208235348366, 'recall': 0.41253752719861186, 'f1-score': 0.3759490970243847, 'support': 108921}, '2': {'precision': 0.3604729030451352, 'recall': 0.2661907373607502, 'f1-score': 0.30623939757540647, 'support': 111221}, 'accuracy': 0.35237012100809756, 'macro avg': {'precision': 0.35343564413934514, 'recall': 0.35292024995599086, 'f1-score': 0.3496724587325239, 'support': 329730}, 'weighted avg': {'precision': 0.353486909081887, 'recall': 0.35237012100809756, 'f1-score': 0.34940420074383544, 'support': 329730}}
[[41647 41739 26202]
 [37664 44934 26323]
 [38166 43449 29606]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058068
{'0': {'precision': 0.36525060555245015, 'recall': 0.5052970743652533, 'f1-score': 0.4240090845184665, 'support': 38795}, '1': {'precision': 0.3034013137531382, 'recall': 0.24737122507921375, 'f1-score': 0.2725362990423231, 'support': 35663}, '2': {'precision': 0.3709031131203123, 'recall': 0.2888924455825864, 'f1-score': 0.32480093571460705, 'support': 37488}, 'accuracy': 0.3506601397102174, 'macro avg': {'precision': 0.34651834414196686, 'recall': 0.3471869150090178, 'f1-score': 0.3404487730917989, 'support': 111946}, 'weighted avg': {'precision': 0.3474399639061667, 'recall': 0.3506601397102174, 'f1-score': 0.3425315057680441, 'support': 111946}}
[[19603  9888  9304]
 [17776  8822  9065]
 [16291 10367 10830]]
training model: results/EXC/W8/deepLOB_L2/h1000
Epoch 1/50
1289/1289 - 54s - loss: 3.2403 - accuracy1000: 0.4138 - val_loss: 3.3013 - val_accuracy1000: 0.3676 - 54s/epoch - 42ms/step
Epoch 2/50
1289/1289 - 52s - loss: 3.1833 - accuracy1000: 0.4356 - val_loss: 3.4417 - val_accuracy1000: 0.3564 - 52s/epoch - 40ms/step
Epoch 3/50
1289/1289 - 51s - loss: 3.1441 - accuracy1000: 0.4537 - val_loss: 3.4759 - val_accuracy1000: 0.3228 - 51s/epoch - 40ms/step
Epoch 4/50
1289/1289 - 51s - loss: 3.1260 - accuracy1000: 0.4591 - val_loss: 3.4974 - val_accuracy1000: 0.3387 - 51s/epoch - 40ms/step
Epoch 5/50
1289/1289 - 51s - loss: 3.1092 - accuracy1000: 0.4640 - val_loss: 3.6171 - val_accuracy1000: 0.3474 - 51s/epoch - 40ms/step
Epoch 6/50
1289/1289 - 51s - loss: 3.0971 - accuracy1000: 0.4688 - val_loss: 3.5819 - val_accuracy1000: 0.3664 - 51s/epoch - 40ms/step
Epoch 7/50
1289/1289 - 52s - loss: 3.0794 - accuracy1000: 0.4749 - val_loss: 3.6906 - val_accuracy1000: 0.3637 - 52s/epoch - 40ms/step
Epoch 8/50
1289/1289 - 52s - loss: 3.0667 - accuracy1000: 0.4791 - val_loss: 3.6921 - val_accuracy1000: 0.3615 - 52s/epoch - 40ms/step
Epoch 9/50
1289/1289 - 51s - loss: 3.0538 - accuracy1000: 0.4838 - val_loss: 3.5585 - val_accuracy1000: 0.3649 - 51s/epoch - 40ms/step
Epoch 10/50
1289/1289 - 51s - loss: 3.0502 - accuracy1000: 0.4838 - val_loss: 3.6023 - val_accuracy1000: 0.3598 - 51s/epoch - 40ms/step
Epoch 11/50
1289/1289 - 52s - loss: 3.0316 - accuracy1000: 0.4920 - val_loss: 3.6282 - val_accuracy1000: 0.3676 - 52s/epoch - 40ms/step
testing model: results/EXC/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161087
{'0': {'precision': 0.2848254272770285, 'recall': 0.4883735403025413, 'f1-score': 0.3598070047168073, 'support': 449922}, '1': {'precision': 0.3720468744941893, 'recall': 0.22284722626180364, 'f1-score': 0.2787373884361661, 'support': 515730}, '2': {'precision': 0.3380468245506015, 'recall': 0.2514218443543955, 'f1-score': 0.2883693759824136, 'support': 447658}, 'accuracy': 0.31642739384848334, 'macro avg': {'precision': 0.3316397087739397, 'recall': 0.32088087030624685, 'f1-score': 0.30897125637846234, 'support': 1413310}, 'weighted avg': {'precision': 0.33351092531638254, 'recall': 0.31642739384848334, 'f1-score': 0.30759647821632524, 'support': 1413310}}
[[219730  96775 133417]
 [313824 114929  86977]
 [237901  97206 112551]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088358
{'0': {'precision': 0.3153102511729381, 'recall': 0.5240888066604995, 'f1-score': 0.39373542708416587, 'support': 108100}, '1': {'precision': 0.3494068238251433, 'recall': 0.20865903890160184, 'f1-score': 0.2612841849483071, 'support': 109250}, '2': {'precision': 0.36915022815436677, 'recall': 0.2785904965296316, 'f1-score': 0.3175398471532676, 'support': 112380}, 'accuracy': 0.3359051345039881, 'macro avg': {'precision': 0.34462243438414936, 'recall': 0.3371127806972443, 'f1-score': 0.32418648639524683, 'support': 329730}, 'weighted avg': {'precision': 0.3449574994531261, 'recall': 0.3359051345039881, 'f1-score': 0.3238808264230889, 'support': 329730}}
[[56654 20646 30800]
 [63751 22796 22703]
 [59272 21800 31308]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008841
{'0': {'precision': 0.38103450635787517, 'recall': 0.6384423090154348, 'f1-score': 0.47724194682073007, 'support': 43603}, '1': {'precision': 0.23163681167661834, 'recall': 0.0925582276084075, 'f1-score': 0.13226539668795326, 'support': 26405}, '2': {'precision': 0.3847049689440994, 'recall': 0.25993132719729123, 'f1-score': 0.31024276403790874, 'support': 41938}, 'accuracy': 0.36788272917299414, 'macro avg': {'precision': 0.33245876232619764, 'recall': 0.3303106212737112, 'f1-score': 0.30658336918219736, 'support': 111946}, 'weighted avg': {'precision': 0.347170730357683, 'recall': 0.36788272917299414, 'f1-score': 0.3333090011701313, 'support': 111946}}
[[27838  4522 11243]
 [17769  2444  6192]
 [27452  3585 10901]]
training model: results/EXC/W8/deepOF_L2/h10
Epoch 1/50
1288/1288 - 31s - loss: 2.6646 - accuracy10: 0.5445 - val_loss: 2.2079 - val_accuracy10: 0.7470 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 2.2873 - accuracy10: 0.6169 - val_loss: 2.1538 - val_accuracy10: 0.7724 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 2.1775 - accuracy10: 0.6355 - val_loss: 2.1418 - val_accuracy10: 0.7679 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 2.1356 - accuracy10: 0.6422 - val_loss: 2.0795 - val_accuracy10: 0.7723 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 2.1056 - accuracy10: 0.6456 - val_loss: 2.0656 - val_accuracy10: 0.7523 - 28s/epoch - 21ms/step
Epoch 6/50
1288/1288 - 28s - loss: 2.0863 - accuracy10: 0.6483 - val_loss: 2.0592 - val_accuracy10: 0.7793 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 2.0675 - accuracy10: 0.6494 - val_loss: 2.0713 - val_accuracy10: 0.7768 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 2.0523 - accuracy10: 0.6517 - val_loss: 2.0494 - val_accuracy10: 0.7689 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 2.0410 - accuracy10: 0.6519 - val_loss: 2.0514 - val_accuracy10: 0.7733 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 2.0290 - accuracy10: 0.6523 - val_loss: 2.0621 - val_accuracy10: 0.7855 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 2.0210 - accuracy10: 0.6540 - val_loss: 2.0154 - val_accuracy10: 0.7610 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 2.0098 - accuracy10: 0.6544 - val_loss: 2.0124 - val_accuracy10: 0.7651 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 1.9994 - accuracy10: 0.6550 - val_loss: 2.0394 - val_accuracy10: 0.7637 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 28s - loss: 1.9913 - accuracy10: 0.6571 - val_loss: 2.0085 - val_accuracy10: 0.7626 - 28s/epoch - 22ms/step
Epoch 15/50
1288/1288 - 28s - loss: 1.9829 - accuracy10: 0.6579 - val_loss: 2.0396 - val_accuracy10: 0.7695 - 28s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 1.9770 - accuracy10: 0.6591 - val_loss: 2.0207 - val_accuracy10: 0.7599 - 28s/epoch - 22ms/step
Epoch 17/50
1288/1288 - 28s - loss: 1.9694 - accuracy10: 0.6579 - val_loss: 2.0681 - val_accuracy10: 0.7643 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 1.9624 - accuracy10: 0.6584 - val_loss: 2.0858 - val_accuracy10: 0.7561 - 28s/epoch - 22ms/step
Epoch 19/50
1288/1288 - 28s - loss: 1.9551 - accuracy10: 0.6585 - val_loss: 2.0676 - val_accuracy10: 0.7743 - 28s/epoch - 22ms/step
Epoch 20/50
1288/1288 - 28s - loss: 1.9444 - accuracy10: 0.6597 - val_loss: 2.0559 - val_accuracy10: 0.7609 - 28s/epoch - 22ms/step
Epoch 21/50
1288/1288 - 28s - loss: 1.9373 - accuracy10: 0.6598 - val_loss: 2.0695 - val_accuracy10: 0.7526 - 28s/epoch - 22ms/step
Epoch 22/50
1288/1288 - 28s - loss: 1.9309 - accuracy10: 0.6603 - val_loss: 2.1021 - val_accuracy10: 0.7455 - 28s/epoch - 22ms/step
Epoch 23/50
1288/1288 - 28s - loss: 1.9239 - accuracy10: 0.6606 - val_loss: 2.1044 - val_accuracy10: 0.7533 - 28s/epoch - 22ms/step
Epoch 24/50
1288/1288 - 28s - loss: 1.9175 - accuracy10: 0.6611 - val_loss: 2.1118 - val_accuracy10: 0.7444 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h10
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5281362
{'0': {'precision': 0.39025402407963605, 'recall': 0.5880716016571562, 'f1-score': 0.4691634420202864, 'support': 127930}, '1': {'precision': 0.9232210654516333, 'recall': 0.8179547185391689, 'f1-score': 0.8674058457327034, 'support': 1152878}, '2': {'precision': 0.3939337625940473, 'recall': 0.5919605726922119, 'f1-score': 0.4730593276819291, 'support': 132497}, 'accuracy': 0.7759591878610774, 'macro avg': {'precision': 0.5691362840417723, 'recall': 0.6659956309628458, 'f1-score': 0.6032095384783063, 'support': 1413305}, 'weighted avg': {'precision': 0.8253572261745904, 'recall': 0.7759591878610774, 'f1-score': 0.7943877206223394, 'support': 1413305}}
[[ 75232  38218  14480]
 [103687 943002 106189]
 [ 13858  40206  78433]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58247405
{'0': {'precision': 0.35593082068852994, 'recall': 0.6476368602303765, 'f1-score': 0.4593888853791564, 'support': 33684}, '1': {'precision': 0.9204332168868373, 'recall': 0.7815689638737966, 'f1-score': 0.8453362090473648, 'support': 262275}, '2': {'precision': 0.41089390361235023, 'recall': 0.5564571056294234, 'f1-score': 0.47272361353945236, 'support': 33769}, 'accuracy': 0.7448321040372671, 'macro avg': {'precision': 0.5624193137292391, 'recall': 0.6618876432445321, 'f1-score': 0.5924829026553246, 'support': 329728}, 'weighted avg': {'precision': 0.8105810606140611, 'recall': 0.7448321040372671, 'f1-score': 0.767748001833702, 'support': 329728}}
[[ 21815   8031   3838]
 [ 34186 204986  23103]
 [  5289   9689  18791]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53953534
{'0': {'precision': 0.32653789307374753, 'recall': 0.636309464693614, 'f1-score': 0.43159312899966323, 'support': 10069}, '1': {'precision': 0.9257224052511128, 'recall': 0.7993203187770082, 'f1-score': 0.8578903209266553, 'support': 92102}, '2': {'precision': 0.42175169935151186, 'recall': 0.5522250639386189, 'f1-score': 0.478249313369363, 'support': 9775}, 'accuracy': 0.7630822003465957, 'macro avg': {'precision': 0.5580039992254574, 'recall': 0.662618282469747, 'f1-score': 0.5892442544318939, 'support': 111946}, 'weighted avg': {'precision': 0.8278225025901648, 'recall': 0.7630822003465957, 'f1-score': 0.786397125328908, 'support': 111946}}
[[ 6407  2692   970]
 [12052 73619  6431]
 [ 1162  3215  5398]]
training model: results/EXC/W8/deepOF_L2/h20
Epoch 1/50
1288/1288 - 30s - loss: 2.6894 - accuracy20: 0.5292 - val_loss: 2.3099 - val_accuracy20: 0.7100 - 30s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 2.3404 - accuracy20: 0.5964 - val_loss: 2.2770 - val_accuracy20: 0.7331 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 2.2390 - accuracy20: 0.6147 - val_loss: 2.2652 - val_accuracy20: 0.7424 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 2.2006 - accuracy20: 0.6242 - val_loss: 2.2420 - val_accuracy20: 0.7493 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 2.1752 - accuracy20: 0.6284 - val_loss: 2.2378 - val_accuracy20: 0.7461 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 2.1565 - accuracy20: 0.6303 - val_loss: 2.2274 - val_accuracy20: 0.7499 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 2.1421 - accuracy20: 0.6325 - val_loss: 2.2220 - val_accuracy20: 0.7501 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 2.1306 - accuracy20: 0.6339 - val_loss: 2.1899 - val_accuracy20: 0.7476 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 2.1186 - accuracy20: 0.6348 - val_loss: 2.1987 - val_accuracy20: 0.7508 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 2.1078 - accuracy20: 0.6376 - val_loss: 2.1929 - val_accuracy20: 0.7501 - 28s/epoch - 21ms/step
Epoch 11/50
1288/1288 - 28s - loss: 2.0988 - accuracy20: 0.6381 - val_loss: 2.2091 - val_accuracy20: 0.7450 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 2.0908 - accuracy20: 0.6398 - val_loss: 2.1970 - val_accuracy20: 0.7463 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 2.0825 - accuracy20: 0.6409 - val_loss: 2.2138 - val_accuracy20: 0.7538 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 29s - loss: 2.0734 - accuracy20: 0.6417 - val_loss: 2.1879 - val_accuracy20: 0.7467 - 29s/epoch - 23ms/step
Epoch 15/50
1288/1288 - 28s - loss: 2.0661 - accuracy20: 0.6424 - val_loss: 2.1999 - val_accuracy20: 0.7464 - 28s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 2.0573 - accuracy20: 0.6445 - val_loss: 2.2254 - val_accuracy20: 0.7483 - 28s/epoch - 21ms/step
Epoch 17/50
1288/1288 - 28s - loss: 2.0509 - accuracy20: 0.6446 - val_loss: 2.2067 - val_accuracy20: 0.7395 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 2.0433 - accuracy20: 0.6459 - val_loss: 2.2145 - val_accuracy20: 0.7407 - 28s/epoch - 22ms/step
Epoch 19/50
1288/1288 - 28s - loss: 2.0362 - accuracy20: 0.6463 - val_loss: 2.2143 - val_accuracy20: 0.7455 - 28s/epoch - 22ms/step
Epoch 20/50
1288/1288 - 28s - loss: 2.0294 - accuracy20: 0.6469 - val_loss: 2.2497 - val_accuracy20: 0.7419 - 28s/epoch - 22ms/step
Epoch 21/50
1288/1288 - 28s - loss: 2.0207 - accuracy20: 0.6482 - val_loss: 2.2243 - val_accuracy20: 0.7401 - 28s/epoch - 22ms/step
Epoch 22/50
1288/1288 - 29s - loss: 2.0120 - accuracy20: 0.6487 - val_loss: 2.2373 - val_accuracy20: 0.7359 - 29s/epoch - 22ms/step
Epoch 23/50
1288/1288 - 28s - loss: 2.0042 - accuracy20: 0.6494 - val_loss: 2.2650 - val_accuracy20: 0.7356 - 28s/epoch - 21ms/step
Epoch 24/50
1288/1288 - 28s - loss: 1.9978 - accuracy20: 0.6500 - val_loss: 2.2374 - val_accuracy20: 0.7300 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h20
Evaluating performance on  test set...
5521/5521 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56866205
{'0': {'precision': 0.49198964527799727, 'recall': 0.5355154464184678, 'f1-score': 0.5128306548618862, 'support': 176740}, '1': {'precision': 0.8668356543591803, 'recall': 0.8319481357734072, 'f1-score': 0.8490336567312736, 'support': 1053520}, '2': {'precision': 0.486444878699776, 'recall': 0.5575732743314485, 'f1-score': 0.51958610683331, 'support': 183045}, 'accuracy': 0.7593421094526659, 'macro avg': {'precision': 0.6150900594456512, 'recall': 0.6416789521744412, 'f1-score': 0.62715013947549, 'support': 1413305}, 'weighted avg': {'precision': 0.7706929865163694, 'recall': 0.7593421094526659, 'f1-score': 0.7643214075554281, 'support': 1413305}}
[[ 94647  67334  14759]
 [ 84056 876474  92990]
 [ 13673  67311 102061]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6119269
{'0': {'precision': 0.4416393071436658, 'recall': 0.6014890195819291, 'f1-score': 0.5093164226429171, 'support': 45399}, '1': {'precision': 0.8641682157605033, 'recall': 0.8002521402603495, 'f1-score': 0.8309829445496714, 'support': 238756}, '2': {'precision': 0.4948076923076923, 'recall': 0.5081298137054835, 'f1-score': 0.5013802734565295, 'support': 45573}, 'accuracy': 0.7325098262810559, 'macro avg': {'precision': 0.6002050717372871, 'recall': 0.636623657849254, 'f1-score': 0.6138932135497059, 'support': 329728}, 'weighted avg': {'precision': 0.7549410434924194, 'recall': 0.7325098262810559, 'f1-score': 0.7411382211480418, 'support': 329728}}
[[ 27307  14120   3972]
 [ 28020 191065  19671]
 [  6504  15912  23157]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5802775
{'0': {'precision': 0.40892211963067043, 'recall': 0.5894820601851852, 'f1-score': 0.4828750888836218, 'support': 13824}, '1': {'precision': 0.8716407310175145, 'recall': 0.811668142899321, 'f1-score': 0.8405860913382744, 'support': 84675}, '2': {'precision': 0.5083149821550611, 'recall': 0.49780620212686844, 'f1-score': 0.5030057108506162, 'support': 13447}, 'accuracy': 0.7465295767602237, 'macro avg': {'precision': 0.5962926109344154, 'recall': 0.6329854684037916, 'f1-score': 0.6088222970241709, 'support': 111946}, 'weighted avg': {'precision': 0.7708576442724308, 'recall': 0.7465295767602237, 'f1-score': 0.7558627401300968, 'support': 111946}}
[[ 8149  4731   944]
 [10416 68728  5531]
 [ 1363  5390  6694]]
training model: results/EXC/W8/deepOF_L2/h30
Epoch 1/50
1288/1288 - 31s - loss: 2.7455 - accuracy30: 0.5064 - val_loss: 2.3885 - val_accuracy30: 0.6720 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 2.4221 - accuracy30: 0.5792 - val_loss: 2.4118 - val_accuracy30: 0.7116 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 2.3253 - accuracy30: 0.5993 - val_loss: 2.3741 - val_accuracy30: 0.7184 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 2.2890 - accuracy30: 0.6074 - val_loss: 2.3619 - val_accuracy30: 0.7198 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 29s - loss: 2.2662 - accuracy30: 0.6121 - val_loss: 2.3627 - val_accuracy30: 0.7232 - 29s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 29s - loss: 2.2490 - accuracy30: 0.6147 - val_loss: 2.3326 - val_accuracy30: 0.7207 - 29s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 29s - loss: 2.2371 - accuracy30: 0.6174 - val_loss: 2.3147 - val_accuracy30: 0.7105 - 29s/epoch - 23ms/step
Epoch 8/50
1288/1288 - 28s - loss: 2.2238 - accuracy30: 0.6198 - val_loss: 2.3197 - val_accuracy30: 0.7142 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 2.2138 - accuracy30: 0.6210 - val_loss: 2.3180 - val_accuracy30: 0.7203 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 2.2022 - accuracy30: 0.6231 - val_loss: 2.3135 - val_accuracy30: 0.7127 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 2.1938 - accuracy30: 0.6247 - val_loss: 2.3333 - val_accuracy30: 0.7122 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 2.1848 - accuracy30: 0.6253 - val_loss: 2.3126 - val_accuracy30: 0.7163 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 2.1762 - accuracy30: 0.6270 - val_loss: 2.3144 - val_accuracy30: 0.7068 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 28s - loss: 2.1674 - accuracy30: 0.6277 - val_loss: 2.3554 - val_accuracy30: 0.7049 - 28s/epoch - 22ms/step
Epoch 15/50
1288/1288 - 28s - loss: 2.1587 - accuracy30: 0.6290 - val_loss: 2.3548 - val_accuracy30: 0.7027 - 28s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 2.1502 - accuracy30: 0.6292 - val_loss: 2.3613 - val_accuracy30: 0.7152 - 28s/epoch - 22ms/step
Epoch 17/50
1288/1288 - 28s - loss: 2.1422 - accuracy30: 0.6294 - val_loss: 2.4019 - val_accuracy30: 0.7120 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 2.1337 - accuracy30: 0.6296 - val_loss: 2.4143 - val_accuracy30: 0.7117 - 28s/epoch - 22ms/step
Epoch 19/50
1288/1288 - 28s - loss: 2.1278 - accuracy30: 0.6303 - val_loss: 2.3990 - val_accuracy30: 0.7055 - 28s/epoch - 22ms/step
Epoch 20/50
1288/1288 - 28s - loss: 2.1169 - accuracy30: 0.6315 - val_loss: 2.4115 - val_accuracy30: 0.7054 - 28s/epoch - 22ms/step
Epoch 21/50
1288/1288 - 28s - loss: 2.1093 - accuracy30: 0.6321 - val_loss: 2.4399 - val_accuracy30: 0.7051 - 28s/epoch - 22ms/step
Epoch 22/50
1288/1288 - 28s - loss: 2.0995 - accuracy30: 0.6332 - val_loss: 2.4419 - val_accuracy30: 0.6991 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h30
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64049
{'0': {'precision': 0.5349824499480361, 'recall': 0.506436613051428, 'f1-score': 0.5203183033990187, 'support': 215486}, '1': {'precision': 0.8163883467892161, 'recall': 0.811048979441184, 'f1-score': 0.8137099043005848, 'support': 975348}, '2': {'precision': 0.5108384509128431, 'recall': 0.5518876617626567, 'f1-score': 0.5305702661299558, 'support': 222471}, 'accuracy': 0.7238097933567065, 'macro avg': {'precision': 0.6207364158833651, 'recall': 0.6231244180850896, 'f1-score': 0.6215328246098532, 'support': 1413305}, 'weighted avg': {'precision': 0.7253853276445651, 'recall': 0.7238097933567065, 'f1-score': 0.7244070709027458, 'support': 1413305}}
[[109130  91003  15353]
 [ 82077 791055 102216]
 [ 12781  86911 122779]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67504674
{'0': {'precision': 0.4765768913167757, 'recall': 0.5504888383440028, 'f1-score': 0.5108733583569527, 'support': 54517}, '1': {'precision': 0.8136390691873813, 'recall': 0.7809031556039173, 'f1-score': 0.7969350786357768, 'support': 220560}, '2': {'precision': 0.5155983293989468, 'recall': 0.5195513348337634, 'f1-score': 0.5175672842937996, 'support': 54651}, 'accuracy': 0.6994886694487578, 'macro avg': {'precision': 0.6019380966343679, 'recall': 0.6169811095938944, 'f1-score': 0.6084585737621765, 'support': 329728}, 'weighted avg': {'precision': 0.7085104685797606, 'recall': 0.6994886694487578, 'f1-score': 0.7033338190126206, 'support': 329728}}
[[ 30011  19451   5055]
 [ 26703 172236  21621]
 [  6258  19999  28394]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64537895
{'0': {'precision': 0.45212192492404196, 'recall': 0.5474396249925829, 'f1-score': 0.495236050350251, 'support': 16853}, '1': {'precision': 0.8218761470295213, 'recall': 0.7970607304949211, 'f1-score': 0.8092782507115519, 'support': 78659}, '2': {'precision': 0.5348059779758784, 'recall': 0.4964707314104905, 'f1-score': 0.5149258441148628, 'support': 16434}, 'accuracy': 0.7153538313115252, 'macro avg': {'precision': 0.6029346833098139, 'recall': 0.613657028965998, 'f1-score': 0.6064800483922218, 'support': 111946}, 'weighted avg': {'precision': 0.7240684624014755, 'recall': 0.7153538313115252, 'f1-score': 0.7187887231473781, 'support': 111946}}
[[ 9226  6663   964]
 [ 9830 62696  6133]
 [ 1350  6925  8159]]
training model: results/EXC/W8/deepOF_L2/h50
Epoch 1/50
1288/1288 - 31s - loss: 2.8622 - accuracy50: 0.4857 - val_loss: 2.6435 - val_accuracy50: 0.6273 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 2.5922 - accuracy50: 0.5541 - val_loss: 2.6540 - val_accuracy50: 0.6503 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 2.5120 - accuracy50: 0.5689 - val_loss: 2.6440 - val_accuracy50: 0.6601 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 2.4799 - accuracy50: 0.5773 - val_loss: 2.6477 - val_accuracy50: 0.6590 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 2.4599 - accuracy50: 0.5828 - val_loss: 2.6582 - val_accuracy50: 0.6617 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 2.4439 - accuracy50: 0.5858 - val_loss: 2.6282 - val_accuracy50: 0.6608 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 2.4334 - accuracy50: 0.5891 - val_loss: 2.6551 - val_accuracy50: 0.6579 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 2.4216 - accuracy50: 0.5911 - val_loss: 2.6427 - val_accuracy50: 0.6592 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 2.4097 - accuracy50: 0.5927 - val_loss: 2.6307 - val_accuracy50: 0.6576 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 2.4021 - accuracy50: 0.5950 - val_loss: 2.6149 - val_accuracy50: 0.6550 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 2.3931 - accuracy50: 0.5969 - val_loss: 2.6364 - val_accuracy50: 0.6544 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 2.3851 - accuracy50: 0.5978 - val_loss: 2.6154 - val_accuracy50: 0.6556 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 2.3779 - accuracy50: 0.6000 - val_loss: 2.6446 - val_accuracy50: 0.6530 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 28s - loss: 2.3682 - accuracy50: 0.6019 - val_loss: 2.6555 - val_accuracy50: 0.6545 - 28s/epoch - 22ms/step
Epoch 15/50
1288/1288 - 28s - loss: 2.3609 - accuracy50: 0.6021 - val_loss: 2.6318 - val_accuracy50: 0.6566 - 28s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 2.3531 - accuracy50: 0.6029 - val_loss: 2.6336 - val_accuracy50: 0.6531 - 28s/epoch - 22ms/step
Epoch 17/50
1288/1288 - 28s - loss: 2.3429 - accuracy50: 0.6045 - val_loss: 2.6366 - val_accuracy50: 0.6530 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 2.3344 - accuracy50: 0.6048 - val_loss: 2.6362 - val_accuracy50: 0.6483 - 28s/epoch - 21ms/step
Epoch 19/50
1288/1288 - 28s - loss: 2.3246 - accuracy50: 0.6067 - val_loss: 2.6578 - val_accuracy50: 0.6468 - 28s/epoch - 22ms/step
Epoch 20/50
1288/1288 - 28s - loss: 2.3183 - accuracy50: 0.6076 - val_loss: 2.6611 - val_accuracy50: 0.6479 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h50
Evaluating performance on  test set...
5521/5521 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7779332
{'0': {'precision': 0.5576301290728654, 'recall': 0.4568279262288713, 'f1-score': 0.5022208934825318, 'support': 283146}, '1': {'precision': 0.7135093294134635, 'recall': 0.78294904249933, 'f1-score': 0.7466180907719432, 'support': 839425}, '2': {'precision': 0.5596178676832267, 'recall': 0.500890848679549, 'f1-score': 0.5286283164959943, 'support': 290734}, 'accuracy': 0.659590109707388, 'macro avg': {'precision': 0.6102524420565185, 'recall': 0.5802226058025833, 'f1-score': 0.5924891002501563, 'support': 1413305}, 'weighted avg': {'precision': 0.6506226543544228, 'recall': 0.659590109707388, 'f1-score': 0.6528116386203896, 'support': 1413305}}
[[129349 136997  16800]
 [ 84400 657227  97798]
 [ 18213 126895 145626]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78987783
{'0': {'precision': 0.5125852319353058, 'recall': 0.49119270252494923, 'f1-score': 0.5016610082867886, 'support': 69942}, '1': {'precision': 0.7115812808364966, 'recall': 0.7632379088680575, 'f1-score': 0.7365049391364379, 'support': 190098}, '2': {'precision': 0.5558181849099597, 'recall': 0.4690334060383423, 'f1-score': 0.5087513132806725, 'support': 69688}, 'accuracy': 0.6433514897127329, 'macro avg': {'precision': 0.5933282325605874, 'recall': 0.5744880058104497, 'f1-score': 0.5823057535679663, 'support': 329728}, 'weighted avg': {'precision': 0.6364496563424421, 'recall': 0.6433514897127329, 'f1-score': 0.6385540557109394, 'support': 329728}}
[[ 34355  29572   6015]
 [ 24902 145090  20106]
 [  7766  29236  32686]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7720686
{'0': {'precision': 0.4918575400503111, 'recall': 0.5024570578422974, 'f1-score': 0.4971008028545941, 'support': 22181}, '1': {'precision': 0.7224531226424152, 'recall': 0.7729187150551047, 'f1-score': 0.7468343660933313, 'support': 68143}, '2': {'precision': 0.5823974609375, 'recall': 0.4413097770789011, 'f1-score': 0.502131242435405, 'support': 21622}, 'accuracy': 0.6552802243939042, 'macro avg': {'precision': 0.598902707876742, 'recall': 0.5722285166587677, 'f1-score': 0.5820221371277768, 'support': 111946}, 'weighted avg': {'precision': 0.6497115853399736, 'recall': 0.6552802243939042, 'f1-score': 0.6500885144690651, 'support': 111946}}
[[11145  9915  1121]
 [ 9753 52669  5721]
 [ 1761 10319  9542]]
training model: results/EXC/W8/deepOF_L2/h100
Epoch 1/50
1288/1288 - 32s - loss: 3.0692 - accuracy100: 0.4542 - val_loss: 3.0116 - val_accuracy100: 0.5010 - 32s/epoch - 25ms/step
Epoch 2/50
1288/1288 - 29s - loss: 2.9043 - accuracy100: 0.5035 - val_loss: 2.9398 - val_accuracy100: 0.5265 - 29s/epoch - 23ms/step
Epoch 3/50
1288/1288 - 29s - loss: 2.8396 - accuracy100: 0.5192 - val_loss: 2.9529 - val_accuracy100: 0.5313 - 29s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 2.8109 - accuracy100: 0.5259 - val_loss: 2.9565 - val_accuracy100: 0.5347 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 2.7936 - accuracy100: 0.5302 - val_loss: 2.9545 - val_accuracy100: 0.5363 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 2.7809 - accuracy100: 0.5321 - val_loss: 2.9506 - val_accuracy100: 0.5371 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 2.7721 - accuracy100: 0.5348 - val_loss: 2.9545 - val_accuracy100: 0.5383 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 2.7612 - accuracy100: 0.5380 - val_loss: 2.9715 - val_accuracy100: 0.5379 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 2.7529 - accuracy100: 0.5397 - val_loss: 2.9787 - val_accuracy100: 0.5362 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 29s - loss: 2.7425 - accuracy100: 0.5423 - val_loss: 2.9794 - val_accuracy100: 0.5370 - 29s/epoch - 23ms/step
Epoch 11/50
1288/1288 - 29s - loss: 2.7332 - accuracy100: 0.5451 - val_loss: 2.9799 - val_accuracy100: 0.5373 - 29s/epoch - 23ms/step
Epoch 12/50
1288/1288 - 28s - loss: 2.7264 - accuracy100: 0.5462 - val_loss: 3.0106 - val_accuracy100: 0.5361 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h100
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94505954
{'0': {'precision': 0.601814469053411, 'recall': 0.34841960379491715, 'f1-score': 0.4413311727227585, 'support': 406860}, '1': {'precision': 0.5028557436607046, 'recall': 0.7399763360416164, 'f1-score': 0.5987958579901719, 'support': 596688}, '2': {'precision': 0.5749201699038035, 'recall': 0.420500442945453, 'f1-score': 0.485732730430076, 'support': 409757}, 'accuracy': 0.534630529149759, 'macro avg': {'precision': 0.5598634608726397, 'recall': 0.5029654609273289, 'f1-score': 0.5086199203810021, 'support': 1413305}, 'weighted avg': {'precision': 0.5522373351199932, 'recall': 0.534630529149759, 'f1-score': 0.5206849832621111, 'support': 1413305}}
[[141758 229423  35679]
 [ 63436 441535  91717]
 [ 30357 207097 172303]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9604842
{'0': {'precision': 0.5460881713753493, 'recall': 0.36438685352640793, 'f1-score': 0.43710666426445827, 'support': 96543}, '1': {'precision': 0.5020669971153455, 'recall': 0.7173207949672392, 'f1-score': 0.5906949369773633, 'support': 137817}, '2': {'precision': 0.549163791591135, 'recall': 0.3938952269104941, 'f1-score': 0.45874752704980093, 'support': 95368}, 'accuracy': 0.5204380580357143, 'macro avg': {'precision': 0.5324396533606098, 'recall': 0.49186762513471377, 'f1-score': 0.4955163760972075, 'support': 329728}, 'weighted avg': {'precision': 0.5285781315114254, 'recall': 0.5204380580357143, 'f1-score': 0.5075614657450331, 'support': 329728}}
[[35179 51165 10199]
 [18318 98859 20640]
 [10923 46880 37565]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9561298
{'0': {'precision': 0.5438022707097135, 'recall': 0.3659372445450544, 'f1-score': 0.43748238080024054, 'support': 31806}, '1': {'precision': 0.511466176217024, 'recall': 0.7232901206973625, 'f1-score': 0.5992088208063295, 'support': 49214}, '2': {'precision': 0.5628013558027403, 'recall': 0.38120028455021665, 'f1-score': 0.4545331868216606, 'support': 30926}, 'accuracy': 0.527254211852143, 'macro avg': {'precision': 0.539356600909826, 'recall': 0.49014254993087786, 'f1-score': 0.4970747961427436, 'support': 111946}, 'weighted avg': {'precision': 0.5348352433145741, 'recall': 0.527254211852143, 'f1-score': 0.5132914159196561, 'support': 111946}}
[[11639 17680  2487]
 [ 6947 35596  6671]
 [ 2817 16320 11789]]
training model: results/EXC/W8/deepOF_L2/h200
Epoch 1/50
1288/1288 - 31s - loss: 3.2062 - accuracy200: 0.4120 - val_loss: 3.1862 - val_accuracy200: 0.4137 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 29s - loss: 3.1349 - accuracy200: 0.4394 - val_loss: 3.1644 - val_accuracy200: 0.4230 - 29s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 3.0997 - accuracy200: 0.4511 - val_loss: 3.1504 - val_accuracy200: 0.4269 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 3.0796 - accuracy200: 0.4565 - val_loss: 3.1397 - val_accuracy200: 0.4284 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 3.0653 - accuracy200: 0.4612 - val_loss: 3.1313 - val_accuracy200: 0.4312 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 3.0554 - accuracy200: 0.4645 - val_loss: 3.1361 - val_accuracy200: 0.4313 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 3.0487 - accuracy200: 0.4659 - val_loss: 3.1263 - val_accuracy200: 0.4325 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 3.0416 - accuracy200: 0.4683 - val_loss: 3.1237 - val_accuracy200: 0.4345 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 3.0351 - accuracy200: 0.4702 - val_loss: 3.1295 - val_accuracy200: 0.4336 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 3.0280 - accuracy200: 0.4733 - val_loss: 3.1285 - val_accuracy200: 0.4329 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 3.0210 - accuracy200: 0.4749 - val_loss: 3.1276 - val_accuracy200: 0.4338 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 3.0143 - accuracy200: 0.4769 - val_loss: 3.1309 - val_accuracy200: 0.4328 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 3.0090 - accuracy200: 0.4791 - val_loss: 3.1389 - val_accuracy200: 0.4333 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 28s - loss: 3.0028 - accuracy200: 0.4791 - val_loss: 3.1611 - val_accuracy200: 0.4270 - 28s/epoch - 22ms/step
Epoch 15/50
1288/1288 - 28s - loss: 2.9975 - accuracy200: 0.4822 - val_loss: 3.1608 - val_accuracy200: 0.4293 - 28s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 2.9863 - accuracy200: 0.4850 - val_loss: 3.1684 - val_accuracy200: 0.4277 - 28s/epoch - 22ms/step
Epoch 17/50
1288/1288 - 28s - loss: 2.9808 - accuracy200: 0.4863 - val_loss: 3.1860 - val_accuracy200: 0.4262 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 2.9735 - accuracy200: 0.4884 - val_loss: 3.1919 - val_accuracy200: 0.4227 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h200
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0322613
{'0': {'precision': 0.527630002794123, 'recall': 0.39737478123176934, 'f1-score': 0.453331400123361, 'support': 479960}, '1': {'precision': 0.36438655784245877, 'recall': 0.6510360558785431, 'f1-score': 0.467251337969698, 'support': 458566}, '2': {'precision': 0.5554274950651317, 'recall': 0.2720276170597267, 'f1-score': 0.36519592596153305, 'support': 474779}, 'accuracy': 0.43757009279667164, 'macro avg': {'precision': 0.4824813519005711, 'recall': 0.44014615139001306, 'f1-score': 0.4285928880181973, 'support': 1413305}, 'weighted avg': {'precision': 0.4840016083606726, 'recall': 0.43757009279667164, 'f1-score': 0.4282400984803079, 'support': 1413305}}
[[190724 244301  44935]
 [101582 298543  58441]
 [ 69167 276459 129153]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0293845
{'0': {'precision': 0.5040263263994073, 'recall': 0.41793539643099165, 'f1-score': 0.4569613625361825, 'support': 110675}, '1': {'precision': 0.38326434480845484, 'recall': 0.6461913758001504, 'f1-score': 0.4811515625373435, 'support': 109042}, '2': {'precision': 0.5411014599889115, 'recall': 0.26614611266146115, 'f1-score': 0.35679772850518826, 'support': 110011}, 'accuracy': 0.44277707686335405, 'macro avg': {'precision': 0.4761307103989245, 'recall': 0.44342429496420105, 'f1-score': 0.4316368845262381, 'support': 329728}, 'weighted avg': {'precision': 0.47645980042852915, 'recall': 0.44277707686335405, 'f1-score': 0.43154236944230784, 'support': 329728}}
[[46255 52203 12217]
 [25966 70462 12614]
 [19550 61182 29279]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0417879
{'0': {'precision': 0.48347863195756874, 'recall': 0.42522788203753353, 'f1-score': 0.45248623512966085, 'support': 37300}, '1': {'precision': 0.3790303582366152, 'recall': 0.6321772841575859, 'f1-score': 0.4739172696835511, 'support': 38176}, '2': {'precision': 0.5520139652162669, 'recall': 0.23411022758431588, 'f1-score': 0.3287829485723088, 'support': 36470}, 'accuracy': 0.43353938506065426, 'macro avg': {'precision': 0.4715076518034836, 'recall': 0.43050513125981177, 'f1-score': 0.4183954844618403, 'support': 111946}, 'weighted avg': {'precision': 0.4701871012764689, 'recall': 0.43353938506065426, 'f1-score': 0.41949436685730346, 'support': 111946}}
[[15861 18382  3057]
 [10170 24134  3872]
 [ 6775 21157  8538]]
training model: results/EXC/W8/deepOF_L2/h300
Epoch 1/50
1288/1288 - 31s - loss: 3.2600 - accuracy300: 0.3866 - val_loss: 3.2670 - val_accuracy300: 0.3780 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 3.2229 - accuracy300: 0.4083 - val_loss: 3.2519 - val_accuracy300: 0.3840 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 3.2046 - accuracy300: 0.4170 - val_loss: 3.2474 - val_accuracy300: 0.3883 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 3.1921 - accuracy300: 0.4220 - val_loss: 3.2476 - val_accuracy300: 0.3857 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 3.1816 - accuracy300: 0.4270 - val_loss: 3.2544 - val_accuracy300: 0.3797 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 3.1756 - accuracy300: 0.4295 - val_loss: 3.2535 - val_accuracy300: 0.3789 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 3.1696 - accuracy300: 0.4310 - val_loss: 3.2509 - val_accuracy300: 0.3803 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 3.1619 - accuracy300: 0.4353 - val_loss: 3.2498 - val_accuracy300: 0.3813 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 3.1572 - accuracy300: 0.4371 - val_loss: 3.2506 - val_accuracy300: 0.3835 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 3.1521 - accuracy300: 0.4393 - val_loss: 3.2493 - val_accuracy300: 0.3871 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 3.1461 - accuracy300: 0.4422 - val_loss: 3.2589 - val_accuracy300: 0.3820 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 29s - loss: 3.1418 - accuracy300: 0.4438 - val_loss: 3.2652 - val_accuracy300: 0.3822 - 29s/epoch - 23ms/step
Epoch 13/50
1288/1288 - 28s - loss: 3.1344 - accuracy300: 0.4461 - val_loss: 3.2702 - val_accuracy300: 0.3807 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h300
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0754358
{'0': {'precision': 0.44740781167859195, 'recall': 0.462820552736179, 'f1-score': 0.45498369155460244, 'support': 481785}, '1': {'precision': 0.3360136271454716, 'recall': 0.4758185785986486, 'f1-score': 0.39387825544956845, 'support': 456859}, '2': {'precision': 0.46624922102105015, 'recall': 0.26322996833529616, 'f1-score': 0.3364887428632985, 'support': 474661}, 'accuracy': 0.3999893865796838, 'macro avg': {'precision': 0.4165568866150379, 'recall': 0.4006230332233746, 'f1-score': 0.39511689662248983, 'support': 1413305}, 'weighted avg': {'precision': 0.41772691933637546, 'recall': 0.3999893865796838, 'f1-score': 0.3954342671385898, 'support': 1413305}}
[[222980 202704  56101]
 [152544 217382  86933]
 [122858 226858 124945]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0750198
{'0': {'precision': 0.4248448441804122, 'recall': 0.46396824965341016, 'f1-score': 0.44354548801351323, 'support': 110361}, '1': {'precision': 0.3456344839765796, 'recall': 0.46413098007023307, 'f1-score': 0.39621267864998816, 'support': 109635}, '2': {'precision': 0.45890742473621376, 'recall': 0.25921335617686725, 'f1-score': 0.33129506039111545, 'support': 109732}, 'accuracy': 0.3958808472437888, 'macro avg': {'precision': 0.40979558429773516, 'recall': 0.3957708619668368, 'f1-score': 0.3903510756848723, 'support': 329728}, 'weighted avg': {'precision': 0.40984316779442753, 'recall': 0.3958808472437888, 'f1-score': 0.39045082672168774, 'support': 329728}}
[[51204 45431 13726]
 [38938 50885 19812]
 [30382 50906 28444]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0822849
{'0': {'precision': 0.42729499274310595, 'recall': 0.4902685262281432, 'f1-score': 0.4566207832493214, 'support': 38432}, '1': {'precision': 0.3224182399669865, 'recall': 0.4368831604551682, 'f1-score': 0.37102288916326337, 'support': 35767}, '2': {'precision': 0.47175651276760383, 'recall': 0.24227090894640635, 'f1-score': 0.32013582580690336, 'support': 37747}, 'accuracy': 0.38958962356850624, 'macro avg': {'precision': 0.4071565818258987, 'recall': 0.3898075318765726, 'f1-score': 0.38259316607316274, 'support': 111946}, 'weighted avg': {'precision': 0.40877858465189465, 'recall': 0.38958962356850624, 'f1-score': 0.3832507873016771, 'support': 111946}}
[[18842 15376  4214]
 [14115 15626  6026]
 [11139 17463  9145]]
training model: results/EXC/W8/deepOF_L2/h500
Epoch 1/50
1288/1288 - 31s - loss: 3.2710 - accuracy500: 0.3883 - val_loss: 3.2729 - val_accuracy500: 0.3792 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 3.2465 - accuracy500: 0.4008 - val_loss: 3.2616 - val_accuracy500: 0.3903 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 3.2351 - accuracy500: 0.4066 - val_loss: 3.2566 - val_accuracy500: 0.3947 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 3.2273 - accuracy500: 0.4096 - val_loss: 3.2528 - val_accuracy500: 0.3950 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 3.2209 - accuracy500: 0.4125 - val_loss: 3.2498 - val_accuracy500: 0.3977 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 3.2151 - accuracy500: 0.4149 - val_loss: 3.2458 - val_accuracy500: 0.4012 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 3.2111 - accuracy500: 0.4165 - val_loss: 3.2445 - val_accuracy500: 0.4025 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 28s - loss: 3.2072 - accuracy500: 0.4190 - val_loss: 3.2444 - val_accuracy500: 0.4014 - 28s/epoch - 22ms/step
Epoch 9/50
1288/1288 - 28s - loss: 3.2038 - accuracy500: 0.4210 - val_loss: 3.2427 - val_accuracy500: 0.4038 - 28s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 3.2000 - accuracy500: 0.4236 - val_loss: 3.2414 - val_accuracy500: 0.4055 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 3.1967 - accuracy500: 0.4252 - val_loss: 3.2421 - val_accuracy500: 0.4038 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 3.1934 - accuracy500: 0.4257 - val_loss: 3.2444 - val_accuracy500: 0.4020 - 28s/epoch - 22ms/step
Epoch 13/50
1288/1288 - 28s - loss: 3.1904 - accuracy500: 0.4281 - val_loss: 3.2427 - val_accuracy500: 0.4038 - 28s/epoch - 22ms/step
Epoch 14/50
1288/1288 - 29s - loss: 3.1865 - accuracy500: 0.4309 - val_loss: 3.2459 - val_accuracy500: 0.4010 - 29s/epoch - 22ms/step
Epoch 15/50
1288/1288 - 29s - loss: 3.1837 - accuracy500: 0.4315 - val_loss: 3.2468 - val_accuracy500: 0.4021 - 29s/epoch - 22ms/step
Epoch 16/50
1288/1288 - 28s - loss: 3.1792 - accuracy500: 0.4332 - val_loss: 3.2567 - val_accuracy500: 0.3997 - 28s/epoch - 22ms/step
Epoch 17/50
1288/1288 - 28s - loss: 3.1737 - accuracy500: 0.4364 - val_loss: 3.2560 - val_accuracy500: 0.4012 - 28s/epoch - 22ms/step
Epoch 18/50
1288/1288 - 28s - loss: 3.1707 - accuracy500: 0.4368 - val_loss: 3.2497 - val_accuracy500: 0.4043 - 28s/epoch - 21ms/step
Epoch 19/50
1288/1288 - 28s - loss: 3.1766 - accuracy500: 0.4352 - val_loss: 3.2665 - val_accuracy500: 0.3992 - 28s/epoch - 22ms/step
Epoch 20/50
1288/1288 - 28s - loss: 3.1639 - accuracy500: 0.4403 - val_loss: 3.2533 - val_accuracy500: 0.4053 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h500
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0796866
{'0': {'precision': 0.41331078032081997, 'recall': 0.5803187324955407, 'f1-score': 0.4827795170509388, 'support': 495588}, '1': {'precision': 0.3645783929059055, 'recall': 0.18072855687412576, 'f1-score': 0.24166105656255157, 'support': 421079}, '2': {'precision': 0.4268584660504869, 'recall': 0.43724805592806026, 'f1-score': 0.43199080134160367, 'support': 496638}, 'accuracy': 0.4109898429567574, 'macro avg': {'precision': 0.40158254642573743, 'recall': 0.39943178176590893, 'f1-score': 0.38547712498503134, 'support': 1413305}, 'weighted avg': {'precision': 0.4035521723665041, 'recall': 0.4109898429567574, 'f1-score': 0.39309362022297706, 'support': 1413305}}
[[287599  62070 145919]
 [199325  76101 145653]
 [208918  70566 217154]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0756114
{'0': {'precision': 0.3955083243890872, 'recall': 0.5780142814150092, 'f1-score': 0.4696541375669217, 'support': 109653}, '1': {'precision': 0.42469445606208467, 'recall': 0.1679237829246557, 'f1-score': 0.24068209500609014, 'support': 108847}, '2': {'precision': 0.41676552935035355, 'recall': 0.47375660804833314, 'f1-score': 0.4434374289969958, 'support': 111228}, 'accuracy': 0.4074691867236025, 'macro avg': {'precision': 0.4123227699338418, 'recall': 0.40656489079599933, 'f1-score': 0.3845912205233359, 'support': 329728}, 'weighted avg': {'precision': 0.4123137496718733, 'recall': 0.4074691867236025, 'f1-score': 0.3852240861990228, 'support': 329728}}
[[63381 11743 34529]
 [51355 18278 39214]
 [45516 13017 52695]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0804372
{'0': {'precision': 0.4051518969620608, 'recall': 0.5965933980982813, 'f1-score': 0.48257965002970266, 'support': 38807}, '1': {'precision': 0.390103477787287, 'recall': 0.14065699778382473, 'f1-score': 0.20676288659793815, 'support': 35647}, '2': {'precision': 0.4081861307778493, 'recall': 0.45671076496319213, 'f1-score': 0.43108722196346977, 'support': 37492}, 'accuracy': 0.40456112768656316, 'macro avg': {'precision': 0.40114716850906573, 'recall': 0.39798705361509934, 'f1-score': 0.37347658619703683, 'support': 111946}, 'weighted avg': {'precision': 0.40137622383303767, 'recall': 0.40456112768656316, 'f1-score': 0.37750582622973383, 'support': 111946}}
[[23152  3864 11791]
 [17598  5014 13035]
 [16394  3975 17123]]
training model: results/EXC/W8/deepOF_L2/h1000
Epoch 1/50
1288/1288 - 31s - loss: 3.2493 - accuracy1000: 0.4045 - val_loss: 3.2337 - val_accuracy1000: 0.3996 - 31s/epoch - 24ms/step
Epoch 2/50
1288/1288 - 28s - loss: 3.2324 - accuracy1000: 0.4083 - val_loss: 3.2207 - val_accuracy1000: 0.4097 - 28s/epoch - 22ms/step
Epoch 3/50
1288/1288 - 28s - loss: 3.2270 - accuracy1000: 0.4093 - val_loss: 3.2214 - val_accuracy1000: 0.4109 - 28s/epoch - 22ms/step
Epoch 4/50
1288/1288 - 28s - loss: 3.2227 - accuracy1000: 0.4106 - val_loss: 3.2221 - val_accuracy1000: 0.4109 - 28s/epoch - 22ms/step
Epoch 5/50
1288/1288 - 28s - loss: 3.2184 - accuracy1000: 0.4139 - val_loss: 3.2229 - val_accuracy1000: 0.4107 - 28s/epoch - 22ms/step
Epoch 6/50
1288/1288 - 28s - loss: 3.2128 - accuracy1000: 0.4166 - val_loss: 3.2237 - val_accuracy1000: 0.4106 - 28s/epoch - 22ms/step
Epoch 7/50
1288/1288 - 28s - loss: 3.2084 - accuracy1000: 0.4200 - val_loss: 3.2229 - val_accuracy1000: 0.4113 - 28s/epoch - 22ms/step
Epoch 8/50
1288/1288 - 29s - loss: 3.2041 - accuracy1000: 0.4234 - val_loss: 3.2233 - val_accuracy1000: 0.4121 - 29s/epoch - 23ms/step
Epoch 9/50
1288/1288 - 29s - loss: 3.2013 - accuracy1000: 0.4249 - val_loss: 3.2224 - val_accuracy1000: 0.4125 - 29s/epoch - 22ms/step
Epoch 10/50
1288/1288 - 28s - loss: 3.1992 - accuracy1000: 0.4264 - val_loss: 3.2222 - val_accuracy1000: 0.4152 - 28s/epoch - 22ms/step
Epoch 11/50
1288/1288 - 28s - loss: 3.1961 - accuracy1000: 0.4280 - val_loss: 3.2223 - val_accuracy1000: 0.4144 - 28s/epoch - 22ms/step
Epoch 12/50
1288/1288 - 28s - loss: 3.1958 - accuracy1000: 0.4280 - val_loss: 3.2211 - val_accuracy1000: 0.4150 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepOF_L2/h1000
Evaluating performance on  test set...
5521/5521 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1441164
{'0': {'precision': 0.3355561980889681, 'recall': 0.7712425709345175, 'f1-score': 0.46764639092520793, 'support': 449922}, '1': {'precision': 0.3658734013275053, 'recall': 0.004382137940395168, 'f1-score': 0.008660546802399662, 'support': 515730}, '2': {'precision': 0.3625072715916006, 'recall': 0.3020754915079314, 'f1-score': 0.329543792952186, 'support': 447653}, 'accuracy': 0.34280215523188556, 'macro avg': {'precision': 0.35464562366935803, 'recall': 0.35923340012761473, 'f1-score': 0.26861691022659784, 'support': 1413305}, 'weighted avg': {'precision': 0.35515580336375646, 'recall': 0.34280215523188556, 'f1-score': 0.25641469523328503, 'support': 1413305}}
[[346999   2075 100848]
 [376516   2260 136954]
 [310586   1842 135225]]
Evaluating performance on  train set...
1288/1288 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271263
{'0': {'precision': 0.3445411889708536, 'recall': 0.785629739226928, 'f1-score': 0.4790103827493565, 'support': 108140}, '1': {'precision': 0.3932367149758454, 'recall': 0.003726184917648567, 'f1-score': 0.007382416426330014, 'support': 109227}, '2': {'precision': 0.39566435269760075, 'recall': 0.2891394701008357, 'f1-score': 0.33411665492541304, 'support': 112361}, 'accuracy': 0.357424907802795, 'macro avg': {'precision': 0.37781408554809986, 'recall': 0.35949846474847075, 'f1-score': 0.2735031513670332, 'support': 329728}, 'weighted avg': {'precision': 0.3780934381533564, 'recall': 0.357424907802795, 'f1-score': 0.2734017840571274, 'support': 329728}}
[[84958   331 22851]
 [82049   407 26771]
 [79576   297 32488]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0743226
{'0': {'precision': 0.40676096015024354, 'recall': 0.7945795978263361, 'f1-score': 0.5380721694304701, 'support': 43613}, '1': {'precision': 0.30660377358490565, 'recall': 0.0049234964399333435, 'f1-score': 0.009691367228268973, 'support': 26404}, '2': {'precision': 0.4203669236905078, 'recall': 0.26394619475780484, 'f1-score': 0.32427918424753865, 'support': 41929}, 'accuracy': 0.40958140532042236, 'macro avg': {'precision': 0.37791055247521904, 'recall': 0.3544830963413581, 'f1-score': 0.29068090696875926, 'support': 111946}, 'weighted avg': {'precision': 0.38823358169284944, 'recall': 0.40958140532042236, 'f1-score': 0.3333708600752269, 'support': 111946}}
[[34654   165  8794]
 [19808   130  6466]
 [30733   129 11067]]
training model: results/EXC/W8/deepVOL_L2/h10
Epoch 1/50
1289/1289 - 31s - loss: 2.4497 - accuracy10: 0.5890 - val_loss: 2.1153 - val_accuracy10: 0.7507 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 28s - loss: 2.2182 - accuracy10: 0.6531 - val_loss: 2.0517 - val_accuracy10: 0.6904 - 28s/epoch - 22ms/step
Epoch 3/50
1289/1289 - 30s - loss: 2.1630 - accuracy10: 0.6652 - val_loss: 2.0185 - val_accuracy10: 0.7072 - 30s/epoch - 23ms/step
Epoch 4/50
1289/1289 - 28s - loss: 2.1367 - accuracy10: 0.6726 - val_loss: 1.9319 - val_accuracy10: 0.7257 - 28s/epoch - 21ms/step
Epoch 5/50
1289/1289 - 27s - loss: 2.1154 - accuracy10: 0.6759 - val_loss: 1.9543 - val_accuracy10: 0.7171 - 27s/epoch - 21ms/step
Epoch 6/50
1289/1289 - 27s - loss: 2.1014 - accuracy10: 0.6795 - val_loss: 1.9591 - val_accuracy10: 0.7365 - 27s/epoch - 21ms/step
Epoch 7/50
1289/1289 - 30s - loss: 2.0869 - accuracy10: 0.6810 - val_loss: 1.9162 - val_accuracy10: 0.7207 - 30s/epoch - 23ms/step
Epoch 8/50
1289/1289 - 27s - loss: 2.0801 - accuracy10: 0.6797 - val_loss: 1.9082 - val_accuracy10: 0.7349 - 27s/epoch - 21ms/step
Epoch 9/50
1289/1289 - 27s - loss: 2.0667 - accuracy10: 0.6815 - val_loss: 1.9285 - val_accuracy10: 0.7452 - 27s/epoch - 21ms/step
Epoch 10/50
1289/1289 - 30s - loss: 2.0624 - accuracy10: 0.6835 - val_loss: 1.9279 - val_accuracy10: 0.7420 - 30s/epoch - 23ms/step
Epoch 11/50
1289/1289 - 29s - loss: 2.0512 - accuracy10: 0.6836 - val_loss: 1.9196 - val_accuracy10: 0.7393 - 29s/epoch - 22ms/step
Epoch 12/50
1289/1289 - 27s - loss: 2.0422 - accuracy10: 0.6839 - val_loss: 1.8924 - val_accuracy10: 0.7383 - 27s/epoch - 21ms/step
Epoch 13/50
1289/1289 - 27s - loss: 2.0347 - accuracy10: 0.6834 - val_loss: 1.9129 - val_accuracy10: 0.7471 - 27s/epoch - 21ms/step
Epoch 14/50
1289/1289 - 26s - loss: 2.0263 - accuracy10: 0.6846 - val_loss: 1.9177 - val_accuracy10: 0.7238 - 26s/epoch - 20ms/step
Epoch 15/50
1289/1289 - 28s - loss: 2.0215 - accuracy10: 0.6849 - val_loss: 1.9157 - val_accuracy10: 0.7182 - 28s/epoch - 22ms/step
Epoch 16/50
1289/1289 - 30s - loss: 2.0133 - accuracy10: 0.6859 - val_loss: 1.9153 - val_accuracy10: 0.7330 - 30s/epoch - 23ms/step
Epoch 17/50
1289/1289 - 26s - loss: 2.0078 - accuracy10: 0.6862 - val_loss: 1.9517 - val_accuracy10: 0.7147 - 26s/epoch - 21ms/step
Epoch 18/50
1289/1289 - 28s - loss: 1.9984 - accuracy10: 0.6867 - val_loss: 1.9020 - val_accuracy10: 0.7270 - 28s/epoch - 22ms/step
Epoch 19/50
1289/1289 - 27s - loss: 1.9942 - accuracy10: 0.6856 - val_loss: 1.9230 - val_accuracy10: 0.7292 - 27s/epoch - 21ms/step
Epoch 20/50
1289/1289 - 28s - loss: 1.9863 - accuracy10: 0.6871 - val_loss: 1.9351 - val_accuracy10: 0.7505 - 28s/epoch - 22ms/step
Epoch 21/50
1289/1289 - 27s - loss: 1.9816 - accuracy10: 0.6868 - val_loss: 1.9255 - val_accuracy10: 0.7350 - 27s/epoch - 21ms/step
Epoch 22/50
1289/1289 - 27s - loss: 1.9755 - accuracy10: 0.6865 - val_loss: 1.9379 - val_accuracy10: 0.7438 - 27s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h10
Evaluating performance on  test set...
5521/5521 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66309136
{'0': {'precision': 0.4483718876417298, 'recall': 0.49210505745329475, 'f1-score': 0.46922165328801735, 'support': 127930}, '1': {'precision': 0.9350228400662906, 'recall': 0.7311323005023059, 'f1-score': 0.8206023358023802, 'support': 1152883}, '2': {'precision': 0.27962715661145454, 'recall': 0.7838517098500344, 'f1-score': 0.412206075255054, 'support': 132497}, 'accuracy': 0.7144384459177392, 'macro avg': {'precision': 0.5543406281064917, 'recall': 0.669029689268545, 'f1-score': 0.5673433547818172, 'support': 1413310}, 'weighted avg': {'precision': 0.8295291987459932, 'recall': 0.7144384459177392, 'f1-score': 0.7505091431922652, 'support': 1413310}}
[[ 62955  38697  26278]
 [ 68693 842910 241280]
 [  8760  19879 103858]]
Evaluating performance on  train set...
1289/1289 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64744127
{'0': {'precision': 0.42557922477215326, 'recall': 0.46241722841973393, 'f1-score': 0.4432341252823284, 'support': 33526}, '1': {'precision': 0.9247220441942765, 'recall': 0.7589217991866231, 'f1-score': 0.8336581638527482, 'support': 262363}, '2': {'precision': 0.3229161323416261, 'recall': 0.7440973966490352, 'f1-score': 0.4503805188649717, 'support': 33841}, 'accuracy': 0.7272526006126224, 'macro avg': {'precision': 0.5577391337693519, 'recall': 0.6551454747517974, 'f1-score': 0.5757576026666827, 'support': 329730}, 'weighted avg': {'precision': 0.812205815683217, 'recall': 0.7272526006126224, 'f1-score': 0.7546242418524958, 'support': 329730}}
[[ 15503  10089   7934]
 [ 18385 199113  44865]
 [  2540   6120  25181]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6178124
{'0': {'precision': 0.38502900806565726, 'recall': 0.5443633089926978, 'f1-score': 0.4510380837926319, 'support': 9997}, '1': {'precision': 0.9368623985862318, 'recall': 0.7592028034239962, 'f1-score': 0.8387278491253513, 'support': 92173}, '2': {'precision': 0.3148628774115408, 'recall': 0.7445785597381342, 'f1-score': 0.44257311363774554, 'support': 9776}, 'accuracy': 0.7387401068372251, 'macro avg': {'precision': 0.5455847613544765, 'recall': 0.6827148907182762, 'f1-score': 0.5774463488519096, 'support': 111946}, 'weighted avg': {'precision': 0.8332647200265874, 'recall': 0.7387401068372251, 'f1-score': 0.7695110546158731, 'support': 111946}}
[[ 5442  2987  1568]
 [ 7924 69978 14271]
 [  768  1729  7279]]
training model: results/EXC/W8/deepVOL_L2/h20
Epoch 1/50
1289/1289 - 31s - loss: 2.5309 - accuracy20: 0.5754 - val_loss: 2.3009 - val_accuracy20: 0.6985 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 27s - loss: 2.3037 - accuracy20: 0.6319 - val_loss: 2.1799 - val_accuracy20: 0.7123 - 27s/epoch - 21ms/step
Epoch 3/50
1289/1289 - 28s - loss: 2.2527 - accuracy20: 0.6406 - val_loss: 2.0860 - val_accuracy20: 0.7123 - 28s/epoch - 22ms/step
Epoch 4/50
1289/1289 - 27s - loss: 2.2228 - accuracy20: 0.6479 - val_loss: 2.0686 - val_accuracy20: 0.7311 - 27s/epoch - 21ms/step
Epoch 5/50
1289/1289 - 31s - loss: 2.2015 - accuracy20: 0.6508 - val_loss: 2.0602 - val_accuracy20: 0.7194 - 31s/epoch - 24ms/step
Epoch 6/50
1289/1289 - 28s - loss: 2.1850 - accuracy20: 0.6525 - val_loss: 2.0527 - val_accuracy20: 0.7251 - 28s/epoch - 22ms/step
Epoch 7/50
1289/1289 - 28s - loss: 2.1716 - accuracy20: 0.6537 - val_loss: 2.0541 - val_accuracy20: 0.7244 - 28s/epoch - 22ms/step
Epoch 8/50
1289/1289 - 30s - loss: 2.1593 - accuracy20: 0.6542 - val_loss: 2.0445 - val_accuracy20: 0.7193 - 30s/epoch - 23ms/step
Epoch 9/50
1289/1289 - 30s - loss: 2.1471 - accuracy20: 0.6557 - val_loss: 2.0261 - val_accuracy20: 0.7267 - 30s/epoch - 23ms/step
Epoch 10/50
1289/1289 - 31s - loss: 2.1369 - accuracy20: 0.6562 - val_loss: 2.0266 - val_accuracy20: 0.7228 - 31s/epoch - 24ms/step
Epoch 11/50
1289/1289 - 29s - loss: 2.1292 - accuracy20: 0.6561 - val_loss: 2.0187 - val_accuracy20: 0.7236 - 29s/epoch - 23ms/step
Epoch 12/50
1289/1289 - 30s - loss: 2.1196 - accuracy20: 0.6582 - val_loss: 2.0177 - val_accuracy20: 0.7182 - 30s/epoch - 23ms/step
Epoch 13/50
1289/1289 - 27s - loss: 2.1117 - accuracy20: 0.6572 - val_loss: 2.0144 - val_accuracy20: 0.7167 - 27s/epoch - 21ms/step
Epoch 14/50
1289/1289 - 27s - loss: 2.1053 - accuracy20: 0.6591 - val_loss: 2.0238 - val_accuracy20: 0.7169 - 27s/epoch - 21ms/step
Epoch 15/50
1289/1289 - 27s - loss: 2.0998 - accuracy20: 0.6589 - val_loss: 2.0167 - val_accuracy20: 0.7251 - 27s/epoch - 21ms/step
Epoch 16/50
1289/1289 - 28s - loss: 2.0919 - accuracy20: 0.6589 - val_loss: 2.0188 - val_accuracy20: 0.7144 - 28s/epoch - 22ms/step
Epoch 17/50
1289/1289 - 28s - loss: 2.0867 - accuracy20: 0.6597 - val_loss: 2.0011 - val_accuracy20: 0.7172 - 28s/epoch - 22ms/step
Epoch 18/50
1289/1289 - 27s - loss: 2.0823 - accuracy20: 0.6602 - val_loss: 2.0076 - val_accuracy20: 0.7000 - 27s/epoch - 21ms/step
Epoch 19/50
1289/1289 - 29s - loss: 2.0775 - accuracy20: 0.6600 - val_loss: 2.0054 - val_accuracy20: 0.7088 - 29s/epoch - 23ms/step
Epoch 20/50
1289/1289 - 30s - loss: 2.0703 - accuracy20: 0.6600 - val_loss: 2.0231 - val_accuracy20: 0.7048 - 30s/epoch - 23ms/step
Epoch 21/50
1289/1289 - 27s - loss: 2.0638 - accuracy20: 0.6607 - val_loss: 2.0012 - val_accuracy20: 0.7002 - 27s/epoch - 21ms/step
Epoch 22/50
1289/1289 - 30s - loss: 2.0618 - accuracy20: 0.6609 - val_loss: 2.0176 - val_accuracy20: 0.6906 - 30s/epoch - 24ms/step
Epoch 23/50
1289/1289 - 30s - loss: 2.0540 - accuracy20: 0.6615 - val_loss: 2.0118 - val_accuracy20: 0.7029 - 30s/epoch - 23ms/step
Epoch 24/50
1289/1289 - 26s - loss: 2.0513 - accuracy20: 0.6624 - val_loss: 2.0086 - val_accuracy20: 0.6874 - 26s/epoch - 21ms/step
Epoch 25/50
1289/1289 - 27s - loss: 2.0481 - accuracy20: 0.6627 - val_loss: 2.0156 - val_accuracy20: 0.6948 - 27s/epoch - 21ms/step
Epoch 26/50
1289/1289 - 27s - loss: 2.0415 - accuracy20: 0.6632 - val_loss: 2.0328 - val_accuracy20: 0.6782 - 27s/epoch - 21ms/step
Epoch 27/50
1289/1289 - 28s - loss: 2.0362 - accuracy20: 0.6631 - val_loss: 2.0247 - val_accuracy20: 0.6818 - 28s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h20
Evaluating performance on  test set...
5521/5521 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6739569
{'0': {'precision': 0.5041518522111823, 'recall': 0.49982460110897364, 'f1-score': 0.5019789011913185, 'support': 176740}, '1': {'precision': 0.888749292349955, 'recall': 0.7271884213144102, 'f1-score': 0.7998924579620263, 'support': 1053522}, '2': {'precision': 0.365167956732495, 'recall': 0.7502513002054106, 'f1-score': 0.4912372323282545, 'support': 183048}, 'accuracy': 0.701742717450524, 'macro avg': {'precision': 0.5860230337645441, 'recall': 0.6590881075429316, 'f1-score': 0.5977028638271998, 'support': 1413310}, 'weighted avg': {'precision': 0.7728410571487382, 'recall': 0.701742717450524, 'f1-score': 0.7226610198730964, 'support': 1413310}}
[[ 88339  60109  28292]
 [ 76958 766109 210455]
 [  9926  35790 137332]]
Evaluating performance on  train set...
1289/1289 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.673698
{'0': {'precision': 0.47490118577075097, 'recall': 0.4772907838983051, 'f1-score': 0.47609298639545633, 'support': 45312}, '1': {'precision': 0.8734667276246803, 'recall': 0.7519480138841785, 'f1-score': 0.8081649000200253, 'support': 238833}, '2': {'precision': 0.4013666904204418, 'recall': 0.6919162005045519, 'f1-score': 0.5080334060836441, 'support': 45585}, 'accuracy': 0.7059048312255481, 'macro avg': {'precision': 0.5832448679386243, 'recall': 0.640384999429012, 'f1-score': 0.5974304308330419, 'support': 329730}, 'weighted avg': {'precision': 0.7534276592097939, 'recall': 0.7059048312255481, 'f1-score': 0.7210380486530087, 'support': 329730}}
[[ 21627  15433   8252]
 [ 20452 179590  38791]
 [  3461  10583  31541]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6417284
{'0': {'precision': 0.44324356248523505, 'recall': 0.5459770114942529, 'f1-score': 0.4892757024577874, 'support': 13746}, '1': {'precision': 0.889348515018089, 'recall': 0.7484952911464111, 'f1-score': 0.812865272223931, 'support': 84734}, '2': {'precision': 0.3940084388185654, 'recall': 0.6934501708005347, 'f1-score': 0.5025022870365389, 'support': 13466}, 'accuracy': 0.7170064138066568, 'macro avg': {'precision': 0.5755335054406298, 'recall': 0.6626408244803995, 'f1-score': 0.6015477539060857, 'support': 111946}, 'weighted avg': {'precision': 0.7749861604576812, 'recall': 0.7170064138066568, 'f1-score': 0.7357976665520997, 'support': 111946}}
[[ 7505  4744  1497]
 [ 8446 63423 12865]
 [  981  3147  9338]]
training model: results/EXC/W8/deepVOL_L2/h30
Epoch 1/50
1289/1289 - 31s - loss: 2.6266 - accuracy30: 0.5543 - val_loss: 2.4622 - val_accuracy30: 0.6576 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 28s - loss: 2.4150 - accuracy30: 0.6097 - val_loss: 2.3114 - val_accuracy30: 0.6912 - 28s/epoch - 21ms/step
Epoch 3/50
1289/1289 - 30s - loss: 2.3513 - accuracy30: 0.6199 - val_loss: 2.2823 - val_accuracy30: 0.6945 - 30s/epoch - 23ms/step
Epoch 4/50
1289/1289 - 31s - loss: 2.3194 - accuracy30: 0.6256 - val_loss: 2.2490 - val_accuracy30: 0.6853 - 31s/epoch - 24ms/step
Epoch 5/50
1289/1289 - 29s - loss: 2.2991 - accuracy30: 0.6287 - val_loss: 2.2210 - val_accuracy30: 0.7045 - 29s/epoch - 23ms/step
Epoch 6/50
1289/1289 - 28s - loss: 2.2834 - accuracy30: 0.6297 - val_loss: 2.2094 - val_accuracy30: 0.7030 - 28s/epoch - 22ms/step
Epoch 7/50
1289/1289 - 28s - loss: 2.2693 - accuracy30: 0.6321 - val_loss: 2.2309 - val_accuracy30: 0.7024 - 28s/epoch - 21ms/step
Epoch 8/50
1289/1289 - 28s - loss: 2.2578 - accuracy30: 0.6332 - val_loss: 2.2075 - val_accuracy30: 0.7057 - 28s/epoch - 22ms/step
Epoch 9/50
1289/1289 - 29s - loss: 2.2512 - accuracy30: 0.6331 - val_loss: 2.2094 - val_accuracy30: 0.7037 - 29s/epoch - 23ms/step
Epoch 10/50
1289/1289 - 28s - loss: 2.2387 - accuracy30: 0.6353 - val_loss: 2.2026 - val_accuracy30: 0.7186 - 28s/epoch - 21ms/step
Epoch 11/50
1289/1289 - 28s - loss: 2.2309 - accuracy30: 0.6355 - val_loss: 2.2374 - val_accuracy30: 0.7202 - 28s/epoch - 22ms/step
Epoch 12/50
1289/1289 - 29s - loss: 2.2224 - accuracy30: 0.6368 - val_loss: 2.2140 - val_accuracy30: 0.7198 - 29s/epoch - 22ms/step
Epoch 13/50
1289/1289 - 29s - loss: 2.2136 - accuracy30: 0.6363 - val_loss: 2.2429 - val_accuracy30: 0.7236 - 29s/epoch - 22ms/step
Epoch 14/50
1289/1289 - 28s - loss: 2.2080 - accuracy30: 0.6373 - val_loss: 2.2308 - val_accuracy30: 0.7179 - 28s/epoch - 22ms/step
Epoch 15/50
1289/1289 - 29s - loss: 2.1998 - accuracy30: 0.6373 - val_loss: 2.2112 - val_accuracy30: 0.7154 - 29s/epoch - 23ms/step
Epoch 16/50
1289/1289 - 28s - loss: 2.1943 - accuracy30: 0.6376 - val_loss: 2.2373 - val_accuracy30: 0.7122 - 28s/epoch - 22ms/step
Epoch 17/50
1289/1289 - 30s - loss: 2.1876 - accuracy30: 0.6385 - val_loss: 2.2451 - val_accuracy30: 0.7213 - 30s/epoch - 23ms/step
Epoch 18/50
1289/1289 - 28s - loss: 2.1840 - accuracy30: 0.6381 - val_loss: 2.2492 - val_accuracy30: 0.7180 - 28s/epoch - 22ms/step
Epoch 19/50
1289/1289 - 28s - loss: 2.1795 - accuracy30: 0.6380 - val_loss: 2.2255 - val_accuracy30: 0.7090 - 28s/epoch - 22ms/step
Epoch 20/50
1289/1289 - 28s - loss: 2.1737 - accuracy30: 0.6386 - val_loss: 2.2252 - val_accuracy30: 0.7166 - 28s/epoch - 22ms/step
testing model: results/EXC/W8/deepVOL_L2/h30
Evaluating performance on  test set...
5521/5521 - 56s - 56s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66786563
{'0': {'precision': 0.6219486766014235, 'recall': 0.4152520349349842, 'f1-score': 0.49800477518240865, 'support': 215486}, '1': {'precision': 0.8279234084036803, 'recall': 0.7871430768442098, 'f1-score': 0.8070183921650659, 'support': 975350}, '2': {'precision': 0.43979773770204306, 'recall': 0.6763397071118423, 'f1-score': 0.5330036627441535, 'support': 222474}, 'accuracy': 0.7129992712143832, 'macro avg': {'precision': 0.6298899409023823, 'recall': 0.6262449396303454, 'f1-score': 0.6126756100305427, 'support': 1413310}, 'weighted avg': {'precision': 0.7354224415097808, 'recall': 0.7129992712143832, 'f1-score': 0.7167697834505496, 'support': 1413310}}
[[ 89481  97414  28591]
 [ 44539 767740 163071]
 [  9852  62154 150468]]
Evaluating performance on  train set...
1289/1289 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68439186
{'0': {'precision': 0.5579273716042794, 'recall': 0.4036364973434082, 'f1-score': 0.46840331114524664, 'support': 54393}, '1': {'precision': 0.8080072752074571, 'recall': 0.8054399753428879, 'f1-score': 0.806721582745244, 'support': 220626}, '2': {'precision': 0.4674397479206291, 'recall': 0.601944764306995, 'f1-score': 0.5262333719490273, 'support': 54711}, 'accuracy': 0.7053922906620569, 'macro avg': {'precision': 0.6111247982441218, 'recall': 0.6036737456644303, 'f1-score': 0.6004527552798393, 'support': 329730}, 'weighted avg': {'precision': 0.7102442988872033, 'recall': 0.7053922906620569, 'f1-score': 0.7043713681817816, 'support': 329730}}
[[ 21955  24479   7959]
 [ 13363 177701  29562]
 [  4033  17745  32933]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64955485
{'0': {'precision': 0.5328456983629397, 'recall': 0.4557316491897045, 'f1-score': 0.49128103021933905, 'support': 16784}, '1': {'precision': 0.8283784853201087, 'recall': 0.7980939068555817, 'f1-score': 0.8129542498042237, 'support': 78695}, '2': {'precision': 0.46089193037247966, 'recall': 0.6094006194206595, 'f1-score': 0.5248430962343095, 'support': 16467}, 'accuracy': 0.7190073785575188, 'macro avg': {'precision': 0.6073720380185094, 'recall': 0.6210753918219819, 'f1-score': 0.6096927920859575, 'support': 111946}, 'weighted avg': {'precision': 0.7300129930594497, 'recall': 0.7190073785575188, 'f1-score': 0.7223454769731402, 'support': 111946}}
[[ 7649  7658  1477]
 [ 5628 62806 10261]
 [ 1078  5354 10035]]
training model: results/EXC/W8/deepVOL_L2/h50
Epoch 1/50
1289/1289 - 29s - loss: 2.7887 - accuracy50: 0.5250 - val_loss: 2.6324 - val_accuracy50: 0.5931 - 29s/epoch - 23ms/step
Epoch 2/50
1289/1289 - 27s - loss: 2.6090 - accuracy50: 0.5725 - val_loss: 2.5667 - val_accuracy50: 0.5941 - 27s/epoch - 21ms/step
Epoch 3/50
1289/1289 - 28s - loss: 2.5564 - accuracy50: 0.5837 - val_loss: 2.5251 - val_accuracy50: 0.6358 - 28s/epoch - 21ms/step
Epoch 4/50
1289/1289 - 28s - loss: 2.5284 - accuracy50: 0.5891 - val_loss: 2.4672 - val_accuracy50: 0.6305 - 28s/epoch - 22ms/step
Epoch 5/50
1289/1289 - 26s - loss: 2.5079 - accuracy50: 0.5934 - val_loss: 2.4964 - val_accuracy50: 0.6336 - 26s/epoch - 20ms/step
Epoch 6/50
1289/1289 - 27s - loss: 2.4942 - accuracy50: 0.5952 - val_loss: 2.4752 - val_accuracy50: 0.6378 - 27s/epoch - 21ms/step
Epoch 7/50
1289/1289 - 27s - loss: 2.4827 - accuracy50: 0.5966 - val_loss: 2.4507 - val_accuracy50: 0.6413 - 27s/epoch - 21ms/step
Epoch 8/50
1289/1289 - 27s - loss: 2.4699 - accuracy50: 0.5986 - val_loss: 2.4370 - val_accuracy50: 0.6431 - 27s/epoch - 21ms/step
Epoch 9/50
1289/1289 - 26s - loss: 2.4600 - accuracy50: 0.5992 - val_loss: 2.4397 - val_accuracy50: 0.6330 - 26s/epoch - 21ms/step
Epoch 10/50
1289/1289 - 27s - loss: 2.4507 - accuracy50: 0.5996 - val_loss: 2.4273 - val_accuracy50: 0.6356 - 27s/epoch - 21ms/step
Epoch 11/50
1289/1289 - 27s - loss: 2.4418 - accuracy50: 0.6021 - val_loss: 2.4389 - val_accuracy50: 0.6370 - 27s/epoch - 21ms/step
Epoch 12/50
1289/1289 - 27s - loss: 2.4344 - accuracy50: 0.6030 - val_loss: 2.4186 - val_accuracy50: 0.6224 - 27s/epoch - 21ms/step
Epoch 13/50
1289/1289 - 26s - loss: 2.4268 - accuracy50: 0.6041 - val_loss: 2.4295 - val_accuracy50: 0.6275 - 26s/epoch - 20ms/step
Epoch 14/50
1289/1289 - 27s - loss: 2.4198 - accuracy50: 0.6042 - val_loss: 2.4174 - val_accuracy50: 0.6212 - 27s/epoch - 21ms/step
Epoch 15/50
1289/1289 - 30s - loss: 2.4137 - accuracy50: 0.6054 - val_loss: 2.4359 - val_accuracy50: 0.6291 - 30s/epoch - 23ms/step
Epoch 16/50
1289/1289 - 29s - loss: 2.4070 - accuracy50: 0.6063 - val_loss: 2.4275 - val_accuracy50: 0.6111 - 29s/epoch - 22ms/step
Epoch 17/50
1289/1289 - 28s - loss: 2.4015 - accuracy50: 0.6073 - val_loss: 2.4431 - val_accuracy50: 0.6273 - 28s/epoch - 22ms/step
Epoch 18/50
1289/1289 - 31s - loss: 2.3940 - accuracy50: 0.6079 - val_loss: 2.4487 - val_accuracy50: 0.6334 - 31s/epoch - 24ms/step
Epoch 19/50
1289/1289 - 27s - loss: 2.3881 - accuracy50: 0.6093 - val_loss: 2.4396 - val_accuracy50: 0.6187 - 27s/epoch - 21ms/step
Epoch 20/50
1289/1289 - 26s - loss: 2.3831 - accuracy50: 0.6098 - val_loss: 2.4625 - val_accuracy50: 0.6274 - 26s/epoch - 20ms/step
Epoch 21/50
1289/1289 - 26s - loss: 2.3773 - accuracy50: 0.6102 - val_loss: 2.4939 - val_accuracy50: 0.6297 - 26s/epoch - 20ms/step
Epoch 22/50
1289/1289 - 26s - loss: 2.3690 - accuracy50: 0.6114 - val_loss: 2.4785 - val_accuracy50: 0.6234 - 26s/epoch - 20ms/step
Epoch 23/50
1289/1289 - 26s - loss: 2.3649 - accuracy50: 0.6119 - val_loss: 2.4847 - val_accuracy50: 0.6242 - 26s/epoch - 21ms/step
Epoch 24/50
1289/1289 - 27s - loss: 2.3615 - accuracy50: 0.6118 - val_loss: 2.4794 - val_accuracy50: 0.6171 - 27s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h50
Evaluating performance on  test set...
5521/5521 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7983471
{'0': {'precision': 0.5538231837629178, 'recall': 0.467684516115361, 'f1-score': 0.5071220270635113, 'support': 283146}, '1': {'precision': 0.7483976301129796, 'recall': 0.6547438368599495, 'f1-score': 0.6984452350256417, 'support': 839426}, '2': {'precision': 0.44543247040848344, 'recall': 0.673840364864586, 'f1-score': 0.5363310337275515, 'support': 290738}, 'accuracy': 0.6211963405056216, 'macro avg': {'precision': 0.5825510947614604, 'recall': 0.5987562392799655, 'f1-score': 0.5806327652722348, 'support': 1413310}, 'weighted avg': {'precision': 0.6470918579975906, 'recall': 0.6211963405056216, 'f1-score': 0.626765872607878, 'support': 1413310}}
[[132423 108929  41794]
 [ 87700 549609 202117]
 [ 18984  75843 195911]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8146848
{'0': {'precision': 0.5298912562991778, 'recall': 0.4288371826793738, 'f1-score': 0.4740384539335796, 'support': 69882}, '1': {'precision': 0.7310139288683289, 'recall': 0.6798235003313313, 'f1-score': 0.7044900250429873, 'support': 190142}, '2': {'precision': 0.45761198987005436, 'recall': 0.6325137003988179, 'f1-score': 0.5310320739036699, 'support': 69706}, 'accuracy': 0.6166287568616747, 'macro avg': {'precision': 0.5728390583458537, 'recall': 0.5803914611365076, 'f1-score': 0.5698535176267456, 'support': 329730}, 'weighted avg': {'precision': 0.6305905213400751, 'recall': 0.6166287568616747, 'f1-score': 0.6189792233737886, 'support': 329730}}
[[ 29968  27628  12286]
 [ 20907 129263  39972]
 [  5680  19936  44090]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7980021
{'0': {'precision': 0.50007165034631, 'recall': 0.4727904981258185, 'f1-score': 0.48604856307163746, 'support': 22143}, '1': {'precision': 0.7469831914788535, 'recall': 0.6656788239781697, 'f1-score': 0.7039913114308987, 'support': 68162}, '2': {'precision': 0.4543742566406766, 'recall': 0.6355066771406127, 'f1-score': 0.5298888439384307, 'support': 21641}, 'accuracy': 0.6216926017901488, 'macro avg': {'precision': 0.5671430328219467, 'recall': 0.5913253330815337, 'f1-score': 0.5733095728136557, 'support': 111946}, 'weighted avg': {'precision': 0.6415777976806749, 'recall': 0.6216926017901488, 'f1-score': 0.6272252119193161, 'support': 111946}}
[[10469  9174  2500]
 [ 8773 45374 14015]
 [ 1693  6195 13753]]
training model: results/EXC/W8/deepVOL_L2/h100
Epoch 1/50
1289/1289 - 31s - loss: 3.0348 - accuracy100: 0.4755 - val_loss: 3.0100 - val_accuracy100: 0.4947 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 28s - loss: 2.9096 - accuracy100: 0.5134 - val_loss: 3.0182 - val_accuracy100: 0.5065 - 28s/epoch - 22ms/step
Epoch 3/50
1289/1289 - 29s - loss: 2.8644 - accuracy100: 0.5210 - val_loss: 2.9536 - val_accuracy100: 0.5153 - 29s/epoch - 23ms/step
Epoch 4/50
1289/1289 - 27s - loss: 2.8444 - accuracy100: 0.5257 - val_loss: 2.9449 - val_accuracy100: 0.5216 - 27s/epoch - 21ms/step
Epoch 5/50
1289/1289 - 27s - loss: 2.8310 - accuracy100: 0.5287 - val_loss: 2.9807 - val_accuracy100: 0.5158 - 27s/epoch - 21ms/step
Epoch 6/50
1289/1289 - 27s - loss: 2.8201 - accuracy100: 0.5316 - val_loss: 2.9447 - val_accuracy100: 0.5208 - 27s/epoch - 21ms/step
Epoch 7/50
1289/1289 - 28s - loss: 2.8120 - accuracy100: 0.5338 - val_loss: 2.9285 - val_accuracy100: 0.5226 - 28s/epoch - 21ms/step
Epoch 8/50
1289/1289 - 27s - loss: 2.8046 - accuracy100: 0.5360 - val_loss: 2.9517 - val_accuracy100: 0.5209 - 27s/epoch - 21ms/step
Epoch 9/50
1289/1289 - 27s - loss: 2.7982 - accuracy100: 0.5371 - val_loss: 2.9383 - val_accuracy100: 0.5226 - 27s/epoch - 21ms/step
Epoch 10/50
1289/1289 - 27s - loss: 2.7911 - accuracy100: 0.5386 - val_loss: 2.9580 - val_accuracy100: 0.5175 - 27s/epoch - 21ms/step
Epoch 11/50
1289/1289 - 26s - loss: 2.7835 - accuracy100: 0.5404 - val_loss: 2.9653 - val_accuracy100: 0.5196 - 26s/epoch - 20ms/step
Epoch 12/50
1289/1289 - 30s - loss: 2.7790 - accuracy100: 0.5419 - val_loss: 2.9543 - val_accuracy100: 0.5230 - 30s/epoch - 23ms/step
Epoch 13/50
1289/1289 - 27s - loss: 2.7727 - accuracy100: 0.5437 - val_loss: 2.9717 - val_accuracy100: 0.5205 - 27s/epoch - 21ms/step
Epoch 14/50
1289/1289 - 27s - loss: 2.7655 - accuracy100: 0.5457 - val_loss: 2.9674 - val_accuracy100: 0.5217 - 27s/epoch - 21ms/step
Epoch 15/50
1289/1289 - 28s - loss: 2.7586 - accuracy100: 0.5469 - val_loss: 2.9631 - val_accuracy100: 0.5174 - 28s/epoch - 22ms/step
Epoch 16/50
1289/1289 - 27s - loss: 2.7526 - accuracy100: 0.5478 - val_loss: 2.9568 - val_accuracy100: 0.5168 - 27s/epoch - 21ms/step
Epoch 17/50
1289/1289 - 27s - loss: 2.7448 - accuracy100: 0.5496 - val_loss: 2.9779 - val_accuracy100: 0.5180 - 27s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h100
Evaluating performance on  test set...
5521/5521 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9454283
{'0': {'precision': 0.6653033930586486, 'recall': 0.27388045027773683, 'f1-score': 0.38802539919108414, 'support': 406860}, '1': {'precision': 0.5359775996694667, 'recall': 0.6435255946156115, 'f1-score': 0.5848484433092226, 'support': 596688}, '2': {'precision': 0.47879592673256477, 'recall': 0.6185932321689176, 'f1-score': 0.5397901327242817, 'support': 409762}, 'accuracy': 0.5298844556395979, 'macro avg': {'precision': 0.5600256398202267, 'recall': 0.5119997590207553, 'f1-score': 0.5042213250748628, 'support': 1413310}, 'weighted avg': {'precision': 0.5566288478969269, 'recall': 0.5298844556395979, 'f1-score': 0.5151237493695969, 'support': 1413310}}
[[111431 194678 100751]
 [ 37528 383984 175176]
 [ 18530 137756 253476]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96449053
{'0': {'precision': 0.6165801729873586, 'recall': 0.24011027163718143, 'f1-score': 0.34562596968612, 'support': 96489}, '1': {'precision': 0.5251691876297555, 'recall': 0.7063798305674829, 'f1-score': 0.602442803811739, 'support': 137872}, '2': {'precision': 0.4835816699465842, 'recall': 0.5410877748534639, 'f1-score': 0.5107210546370479, 'support': 95369}, 'accuracy': 0.522127194977709, 'macro avg': {'precision': 0.5417770101878995, 'recall': 0.4958592923527094, 'f1-score': 0.48626327604496894, 'support': 329730}, 'weighted avg': {'precision': 0.5398903067036748, 'recall': 0.522127194977709, 'f1-score': 0.5007613947649796, 'support': 329730}}
[[23168 50233 23088]
 [ 8463 97390 32019]
 [ 5944 37822 51603]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9601347
{'0': {'precision': 0.5762272226185072, 'recall': 0.279636214872392, 'f1-score': 0.37654137887198613, 'support': 31777}, '1': {'precision': 0.5276795668100016, 'recall': 0.6731202892956545, 'f1-score': 0.5915920473516467, 'support': 49223}, '2': {'precision': 0.48697198755002225, 'recall': 0.53086020810444, 'f1-score': 0.5079698829640853, 'support': 30946}, 'accuracy': 0.5220999410430028, 'macro avg': {'precision': 0.5302929256595104, 'recall': 0.4945389040908288, 'f1-score': 0.4920344363959061, 'support': 111946}, 'weighted avg': {'precision': 0.5302072329244457, 'recall': 0.5220999410430028, 'f1-score': 0.5074315003788594, 'support': 111946}}
[[ 8886 17224  5667]
 [ 4450 33133 11640]
 [ 2085 12433 16428]]
training model: results/EXC/W8/deepVOL_L2/h200
Epoch 1/50
1289/1289 - 31s - loss: 3.2102 - accuracy200: 0.4225 - val_loss: 3.1996 - val_accuracy200: 0.4108 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 29s - loss: 3.1329 - accuracy200: 0.4435 - val_loss: 3.1509 - val_accuracy200: 0.4220 - 29s/epoch - 22ms/step
Epoch 3/50
1289/1289 - 29s - loss: 3.1074 - accuracy200: 0.4500 - val_loss: 3.1389 - val_accuracy200: 0.4271 - 29s/epoch - 22ms/step
Epoch 4/50
1289/1289 - 29s - loss: 3.0922 - accuracy200: 0.4541 - val_loss: 3.1308 - val_accuracy200: 0.4263 - 29s/epoch - 22ms/step
Epoch 5/50
1289/1289 - 28s - loss: 3.0831 - accuracy200: 0.4577 - val_loss: 3.1349 - val_accuracy200: 0.4203 - 28s/epoch - 22ms/step
Epoch 6/50
1289/1289 - 28s - loss: 3.0749 - accuracy200: 0.4605 - val_loss: 3.1366 - val_accuracy200: 0.4223 - 28s/epoch - 22ms/step
Epoch 7/50
1289/1289 - 29s - loss: 3.0693 - accuracy200: 0.4612 - val_loss: 3.1405 - val_accuracy200: 0.4169 - 29s/epoch - 23ms/step
Epoch 8/50
1289/1289 - 29s - loss: 3.0625 - accuracy200: 0.4650 - val_loss: 3.1351 - val_accuracy200: 0.4226 - 29s/epoch - 22ms/step
Epoch 9/50
1289/1289 - 31s - loss: 3.0558 - accuracy200: 0.4667 - val_loss: 3.1320 - val_accuracy200: 0.4259 - 31s/epoch - 24ms/step
Epoch 10/50
1289/1289 - 28s - loss: 3.0499 - accuracy200: 0.4690 - val_loss: 3.1361 - val_accuracy200: 0.4269 - 28s/epoch - 22ms/step
Epoch 11/50
1289/1289 - 30s - loss: 3.0437 - accuracy200: 0.4721 - val_loss: 3.1410 - val_accuracy200: 0.4237 - 30s/epoch - 23ms/step
Epoch 12/50
1289/1289 - 30s - loss: 3.0372 - accuracy200: 0.4752 - val_loss: 3.1578 - val_accuracy200: 0.4197 - 30s/epoch - 24ms/step
Epoch 13/50
1289/1289 - 30s - loss: 3.0296 - accuracy200: 0.4769 - val_loss: 3.1659 - val_accuracy200: 0.4171 - 30s/epoch - 23ms/step
Epoch 14/50
1289/1289 - 30s - loss: 3.0235 - accuracy200: 0.4803 - val_loss: 3.1652 - val_accuracy200: 0.4143 - 30s/epoch - 23ms/step
testing model: results/EXC/W8/deepVOL_L2/h200
Evaluating performance on  test set...
5521/5521 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.033392
{'0': {'precision': 0.501589864217784, 'recall': 0.3612030169180765, 'f1-score': 0.41997512073227894, 'support': 479960}, '1': {'precision': 0.37495877940177424, 'recall': 0.45376238098768773, 'f1-score': 0.41061383887827124, 'support': 458566}, '2': {'precision': 0.45938113125119456, 'recall': 0.49610770371368873, 'f1-score': 0.47703857923740733, 'support': 474784}, 'accuracy': 0.4365546129299305, 'macro avg': {'precision': 0.4453099249569176, 'recall': 0.43702436720648435, 'f1-score': 0.43587584628265247, 'support': 1413310}, 'weighted avg': {'precision': 0.4463233330869298, 'recall': 0.4365546129299305, 'f1-score': 0.4361074989849157, 'support': 1413310}}
[[173363 178426 128171]
 [101459 208080 149027]
 [ 70805 168435 235544]]
Evaluating performance on  train set...
1289/1289 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0396028
{'0': {'precision': 0.47852336788507, 'recall': 0.35682580435195316, 'f1-score': 0.4088098517881741, 'support': 110617}, '1': {'precision': 0.39786486965774076, 'recall': 0.5140262287269628, 'f1-score': 0.44854693472802015, 'support': 109117}, '2': {'precision': 0.46721558294909193, 'recall': 0.4513891414233245, 'f1-score': 0.4591660270222781, 'support': 109996}, 'accuracy': 0.44039365541503656, 'macro avg': {'precision': 0.4478679401639676, 'recall': 0.4407470581674135, 'f1-score': 0.43884093784615746, 'support': 329730}, 'weighted avg': {'precision': 0.44805897440285936, 'recall': 0.44039365541503656, 'f1-score': 0.43875850411037004, 'support': 329730}}
[[39471 42137 29009]
 [25418 56089 27610]
 [17596 42749 49651]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0440037
{'0': {'precision': 0.4485607520289601, 'recall': 0.4120076153701767, 'f1-score': 0.42950787594168865, 'support': 37293}, '1': {'precision': 0.3808447275177706, 'recall': 0.4591676276339239, 'f1-score': 0.41635475706698033, 'support': 38156}, '2': {'precision': 0.46527186089810346, 'recall': 0.40397840918431654, 'f1-score': 0.4324641421992785, 'support': 36497}, 'accuracy': 0.42546406303038964, 'macro avg': {'precision': 0.4315591134816114, 'recall': 0.4250512173961391, 'f1-score': 0.4261089250693158, 'support': 111946}, 'weighted avg': {'precision': 0.43092843563666544, 'recall': 0.42546406303038964, 'f1-score': 0.42598854024251126, 'support': 111946}}
[[15365 14173  7755]
 [11446 17520  9190]
 [ 7443 14310 14744]]
training model: results/EXC/W8/deepVOL_L2/h300
Epoch 1/50
1289/1289 - 31s - loss: 3.2587 - accuracy300: 0.3971 - val_loss: 3.2567 - val_accuracy300: 0.3842 - 31s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 28s - loss: 3.2244 - accuracy300: 0.4118 - val_loss: 3.2591 - val_accuracy300: 0.3708 - 28s/epoch - 22ms/step
Epoch 3/50
1289/1289 - 27s - loss: 3.2129 - accuracy300: 0.4199 - val_loss: 3.2525 - val_accuracy300: 0.3816 - 27s/epoch - 21ms/step
Epoch 4/50
1289/1289 - 27s - loss: 3.2029 - accuracy300: 0.4244 - val_loss: 3.2543 - val_accuracy300: 0.3825 - 27s/epoch - 21ms/step
Epoch 5/50
1289/1289 - 27s - loss: 3.1965 - accuracy300: 0.4271 - val_loss: 3.2582 - val_accuracy300: 0.3848 - 27s/epoch - 21ms/step
Epoch 6/50
1289/1289 - 29s - loss: 3.1855 - accuracy300: 0.4316 - val_loss: 3.2656 - val_accuracy300: 0.3798 - 29s/epoch - 23ms/step
Epoch 7/50
1289/1289 - 28s - loss: 3.1793 - accuracy300: 0.4340 - val_loss: 3.2698 - val_accuracy300: 0.3824 - 28s/epoch - 22ms/step
Epoch 8/50
1289/1289 - 26s - loss: 3.1754 - accuracy300: 0.4344 - val_loss: 3.2741 - val_accuracy300: 0.3834 - 26s/epoch - 21ms/step
Epoch 9/50
1289/1289 - 26s - loss: 3.1675 - accuracy300: 0.4392 - val_loss: 3.2672 - val_accuracy300: 0.3875 - 26s/epoch - 20ms/step
Epoch 10/50
1289/1289 - 29s - loss: 3.1610 - accuracy300: 0.4414 - val_loss: 3.2756 - val_accuracy300: 0.3859 - 29s/epoch - 23ms/step
Epoch 11/50
1289/1289 - 27s - loss: 3.1543 - accuracy300: 0.4442 - val_loss: 3.2799 - val_accuracy300: 0.3849 - 27s/epoch - 21ms/step
Epoch 12/50
1289/1289 - 27s - loss: 3.1475 - accuracy300: 0.4465 - val_loss: 3.2802 - val_accuracy300: 0.3872 - 27s/epoch - 21ms/step
Epoch 13/50
1289/1289 - 26s - loss: 3.1404 - accuracy300: 0.4489 - val_loss: 3.2810 - val_accuracy300: 0.3869 - 26s/epoch - 20ms/step
testing model: results/EXC/W8/deepVOL_L2/h300
Evaluating performance on  test set...
5521/5521 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0760734
{'0': {'precision': 0.44242453877127563, 'recall': 0.431945784945567, 'f1-score': 0.43712237136864746, 'support': 481785}, '1': {'precision': 0.32812812812812814, 'recall': 0.40897957575532057, 'f1-score': 0.3641196583028757, 'support': 456859}, '2': {'precision': 0.4253720154428577, 'recall': 0.3347174644908209, 'f1-score': 0.3746386346165636, 'support': 474666}, 'accuracy': 0.3918673185642216, 'macro avg': {'precision': 0.39864156078075386, 'recall': 0.3918809417305695, 'f1-score': 0.39196022142936227, 'support': 1413310}, 'weighted avg': {'precision': 0.39975053454840553, 'recall': 0.3918673185642216, 'f1-score': 0.3925384854004734, 'support': 1413310}}
[[208105 181543  92137]
 [147523 186846 122490]
 [114746 201041 158879]]
Evaluating performance on  train set...
1289/1289 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0788516
{'0': {'precision': 0.4214565360496137, 'recall': 0.44112234259553057, 'f1-score': 0.43106526043489235, 'support': 110305}, '1': {'precision': 0.3440533040330192, 'recall': 0.44544144735642244, 'f1-score': 0.3882371642028294, 'support': 109662}, '2': {'precision': 0.4352697095435685, 'recall': 0.2867086358791214, 'f1-score': 0.3457045088787947, 'support': 109763}, 'accuracy': 0.39115640069147484, 'macro avg': {'precision': 0.4002598498754004, 'recall': 0.3910908086103581, 'f1-score': 0.3883356445055055, 'support': 329730}, 'weighted avg': {'precision': 0.4003119090299709, 'recall': 0.39115640069147484, 'f1-score': 0.38840591229534654, 'support': 329730}}
[[48658 43538 18109]
 [38093 48848 22721]
 [28701 49592 31470]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0839604
{'0': {'precision': 0.4121359223300971, 'recall': 0.5079336177296847, 'f1-score': 0.45504753914988816, 'support': 38444}, '1': {'precision': 0.3178206851026711, 'recall': 0.37696437559420615, 'f1-score': 0.3448752222463833, 'support': 35762}, '2': {'precision': 0.44507652715698226, 'recall': 0.26120826709062, 'f1-score': 0.32920903671792817, 'support': 37740}, 'accuracy': 0.3829167634395155, 'macro avg': {'precision': 0.3916777115299168, 'recall': 0.3820354201381703, 'f1-score': 0.3763772660380665, 'support': 111946}, 'weighted avg': {'precision': 0.39311136506533945, 'recall': 0.3829167634395155, 'f1-score': 0.3774286203954413, 'support': 111946}}
[[19527 13417  5500]
 [15490 13481  6791]
 [12363 15519  9858]]
training model: results/EXC/W8/deepVOL_L2/h500
Epoch 1/50
1289/1289 - 30s - loss: 3.2715 - accuracy500: 0.3960 - val_loss: 3.2709 - val_accuracy500: 0.3772 - 30s/epoch - 23ms/step
Epoch 2/50
1289/1289 - 27s - loss: 3.2467 - accuracy500: 0.4042 - val_loss: 3.2653 - val_accuracy500: 0.3889 - 27s/epoch - 21ms/step
Epoch 3/50
1289/1289 - 28s - loss: 3.2360 - accuracy500: 0.4090 - val_loss: 3.2692 - val_accuracy500: 0.3820 - 28s/epoch - 22ms/step
Epoch 4/50
1289/1289 - 29s - loss: 3.2313 - accuracy500: 0.4129 - val_loss: 3.2697 - val_accuracy500: 0.3818 - 29s/epoch - 22ms/step
Epoch 5/50
1289/1289 - 27s - loss: 3.2198 - accuracy500: 0.4181 - val_loss: 3.2693 - val_accuracy500: 0.3794 - 27s/epoch - 21ms/step
Epoch 6/50
1289/1289 - 26s - loss: 3.2127 - accuracy500: 0.4223 - val_loss: 3.2766 - val_accuracy500: 0.3739 - 26s/epoch - 20ms/step
Epoch 7/50
1289/1289 - 26s - loss: 3.2060 - accuracy500: 0.4255 - val_loss: 3.2945 - val_accuracy500: 0.3644 - 26s/epoch - 21ms/step
Epoch 8/50
1289/1289 - 26s - loss: 3.2037 - accuracy500: 0.4267 - val_loss: 3.2762 - val_accuracy500: 0.3739 - 26s/epoch - 20ms/step
Epoch 9/50
1289/1289 - 26s - loss: 3.1940 - accuracy500: 0.4304 - val_loss: 3.2830 - val_accuracy500: 0.3701 - 26s/epoch - 20ms/step
Epoch 10/50
1289/1289 - 27s - loss: 3.1866 - accuracy500: 0.4348 - val_loss: 3.2856 - val_accuracy500: 0.3685 - 27s/epoch - 21ms/step
Epoch 11/50
1289/1289 - 27s - loss: 3.1810 - accuracy500: 0.4375 - val_loss: 3.2955 - val_accuracy500: 0.3701 - 27s/epoch - 21ms/step
Epoch 12/50
1289/1289 - 27s - loss: 3.1692 - accuracy500: 0.4422 - val_loss: 3.3013 - val_accuracy500: 0.3689 - 27s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h500
Evaluating performance on  test set...
5521/5521 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0882312
{'0': {'precision': 0.4140872702348289, 'recall': 0.4071539118099877, 'f1-score': 0.410591323457594, 'support': 495589}, '1': {'precision': 0.29730440978801276, 'recall': 0.17439203951743137, 'f1-score': 0.21983427035247488, 'support': 421080}, '2': {'precision': 0.4030378941508609, 'recall': 0.5510459265344585, 'f1-score': 0.4655615890254359, 'support': 496641}, 'accuracy': 0.38836914760385194, 'macro avg': {'precision': 0.37147652472456755, 'recall': 0.3775306259539592, 'f1-score': 0.36532906094516826, 'support': 1413310}, 'weighted avg': {'precision': 0.37541033448494865, 'recall': 0.38836914760385194, 'f1-score': 0.37307408218736665, 'support': 1413310}}
[[201781  90984 202824]
 [145120  73433 202527]
 [140390  82579 273672]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0874795
{'0': {'precision': 0.39281652298613745, 'recall': 0.4349198817388765, 'f1-score': 0.41279739479131483, 'support': 109588}, '1': {'precision': 0.34007201084838756, 'recall': 0.20031031665151808, 'f1-score': 0.25211754237973627, 'support': 108921}, '2': {'precision': 0.39756931204459267, 'recall': 0.5155950764693717, 'f1-score': 0.44895482658733266, 'support': 111221}, 'accuracy': 0.3846328814484578, 'macro avg': {'precision': 0.3768192819597059, 'recall': 0.3836084249532554, 'f1-score': 0.37128992125279464, 'support': 329730}, 'weighted avg': {'precision': 0.37699638209909225, 'recall': 0.3846328814484578, 'f1-score': 0.371915629459872, 'support': 329730}}
[[47662 21283 40643]
 [40852 21818 46251]
 [32820 21056 57345]]
Evaluating performance on  val set...
438/438 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0885584
{'0': {'precision': 0.40337579745215285, 'recall': 0.5199123598401856, 'f1-score': 0.45428951102502313, 'support': 38795}, '1': {'precision': 0.33132405976300877, 'recall': 0.18032694949948125, 'f1-score': 0.23354456811867885, 'support': 35663}, '2': {'precision': 0.39407048644581855, 'recall': 0.44710307298335467, 'f1-score': 0.4189150348033641, 'support': 37488}, 'accuracy': 0.3873474711021385, 'macro avg': {'precision': 0.37625678122032674, 'recall': 0.3824474607743405, 'f1-score': 0.3689163713156887, 'support': 111946}, 'weighted avg': {'precision': 0.3773059189373921, 'recall': 0.3873474711021385, 'f1-score': 0.37212002517053516, 'support': 111946}}
[[20170  6354 12271]
 [15731  6431 13501]
 [14102  6625 16761]]
training model: results/EXC/W8/deepVOL_L2/h1000
Epoch 1/50
1289/1289 - 30s - loss: 3.2465 - accuracy1000: 0.4113 - val_loss: 3.2677 - val_accuracy1000: 0.3850 - 30s/epoch - 24ms/step
Epoch 2/50
1289/1289 - 27s - loss: 3.2305 - accuracy1000: 0.4090 - val_loss: 3.2244 - val_accuracy1000: 0.4073 - 27s/epoch - 21ms/step
Epoch 3/50
1289/1289 - 27s - loss: 3.2213 - accuracy1000: 0.4134 - val_loss: 3.2393 - val_accuracy1000: 0.4035 - 27s/epoch - 21ms/step
Epoch 4/50
1289/1289 - 27s - loss: 3.2153 - accuracy1000: 0.4172 - val_loss: 3.2278 - val_accuracy1000: 0.3913 - 27s/epoch - 21ms/step
Epoch 5/50
1289/1289 - 27s - loss: 3.2199 - accuracy1000: 0.4121 - val_loss: 3.2196 - val_accuracy1000: 0.4090 - 27s/epoch - 21ms/step
Epoch 6/50
1289/1289 - 27s - loss: 3.2207 - accuracy1000: 0.4110 - val_loss: 3.2248 - val_accuracy1000: 0.4096 - 27s/epoch - 21ms/step
Epoch 7/50
1289/1289 - 29s - loss: 3.2116 - accuracy1000: 0.4154 - val_loss: 3.2254 - val_accuracy1000: 0.4116 - 29s/epoch - 22ms/step
Epoch 8/50
1289/1289 - 26s - loss: 3.2065 - accuracy1000: 0.4207 - val_loss: 3.2222 - val_accuracy1000: 0.4129 - 26s/epoch - 20ms/step
Epoch 9/50
1289/1289 - 27s - loss: 3.2007 - accuracy1000: 0.4216 - val_loss: 3.2221 - val_accuracy1000: 0.4121 - 27s/epoch - 21ms/step
Epoch 10/50
1289/1289 - 26s - loss: 3.2008 - accuracy1000: 0.4230 - val_loss: 3.2248 - val_accuracy1000: 0.4114 - 26s/epoch - 20ms/step
Epoch 11/50
1289/1289 - 30s - loss: 3.1981 - accuracy1000: 0.4253 - val_loss: 3.2184 - val_accuracy1000: 0.4145 - 30s/epoch - 23ms/step
Epoch 12/50
1289/1289 - 27s - loss: 3.1996 - accuracy1000: 0.4226 - val_loss: 3.2210 - val_accuracy1000: 0.4158 - 27s/epoch - 21ms/step
Epoch 13/50
1289/1289 - 27s - loss: 3.1919 - accuracy1000: 0.4246 - val_loss: 3.2196 - val_accuracy1000: 0.4087 - 27s/epoch - 21ms/step
Epoch 14/50
1289/1289 - 27s - loss: 3.1854 - accuracy1000: 0.4292 - val_loss: 3.2223 - val_accuracy1000: 0.4123 - 27s/epoch - 21ms/step
Epoch 15/50
1289/1289 - 28s - loss: 3.1814 - accuracy1000: 0.4326 - val_loss: 3.2292 - val_accuracy1000: 0.4133 - 28s/epoch - 21ms/step
Epoch 16/50
1289/1289 - 28s - loss: 3.1782 - accuracy1000: 0.4342 - val_loss: 3.2175 - val_accuracy1000: 0.4206 - 28s/epoch - 22ms/step
Epoch 17/50
1289/1289 - 27s - loss: 3.1680 - accuracy1000: 0.4369 - val_loss: 3.2263 - val_accuracy1000: 0.4166 - 27s/epoch - 21ms/step
Epoch 18/50
1289/1289 - 26s - loss: 3.1574 - accuracy1000: 0.4420 - val_loss: 3.2252 - val_accuracy1000: 0.4177 - 26s/epoch - 21ms/step
Epoch 19/50
1289/1289 - 27s - loss: 3.1574 - accuracy1000: 0.4433 - val_loss: 3.2332 - val_accuracy1000: 0.4117 - 27s/epoch - 21ms/step
Epoch 20/50
1289/1289 - 28s - loss: 3.1494 - accuracy1000: 0.4462 - val_loss: 3.2465 - val_accuracy1000: 0.3996 - 28s/epoch - 22ms/step
Epoch 21/50
1289/1289 - 27s - loss: 3.1424 - accuracy1000: 0.4498 - val_loss: 3.2440 - val_accuracy1000: 0.4042 - 27s/epoch - 21ms/step
Epoch 22/50
1289/1289 - 27s - loss: 3.1336 - accuracy1000: 0.4523 - val_loss: 3.2414 - val_accuracy1000: 0.4047 - 27s/epoch - 21ms/step
Epoch 23/50
1289/1289 - 27s - loss: 3.1293 - accuracy1000: 0.4550 - val_loss: 3.2464 - val_accuracy1000: 0.4080 - 27s/epoch - 21ms/step
Epoch 24/50
1289/1289 - 26s - loss: 3.1199 - accuracy1000: 0.4588 - val_loss: 3.2409 - val_accuracy1000: 0.4108 - 26s/epoch - 21ms/step
Epoch 25/50
1289/1289 - 27s - loss: 3.1040 - accuracy1000: 0.4651 - val_loss: 3.2437 - val_accuracy1000: 0.4082 - 27s/epoch - 21ms/step
Epoch 26/50
1289/1289 - 27s - loss: 3.0918 - accuracy1000: 0.4702 - val_loss: 3.2576 - val_accuracy1000: 0.4022 - 27s/epoch - 21ms/step
testing model: results/EXC/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
5521/5521 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378515
{'0': {'precision': 0.3413266208804465, 'recall': 0.4716661999190971, 'f1-score': 0.396048344051987, 'support': 449922}, '1': {'precision': 0.36212278876170656, 'recall': 0.000674771682857309, 'f1-score': 0.0013470333332688202, 'support': 515730}, '2': {'precision': 0.33837410940035595, 'recall': 0.5976102292374983, 'f1-score': 0.4320923347522404, 'support': 447658}, 'accuracy': 0.33968909864077945, 'macro avg': {'precision': 0.34727450634750295, 'recall': 0.3566504002798176, 'f1-score': 0.2764959040458321, 'support': 1413310}, 'weighted avg': {'precision': 0.34798014507347413, 'recall': 0.33968909864077945, 'f1-score': 0.26343488614956606, 'support': 1413310}}
[[212213    306 237403]
 [229691    348 285691]
 [179826    307 267525]]
Evaluating performance on  train set...
1289/1289 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.113634
{'0': {'precision': 0.3671436741355712, 'recall': 0.5285476410730805, 'f1-score': 0.4333031248696549, 'support': 108100}, '1': {'precision': 0.4878640776699029, 'recall': 0.0018398169336384439, 'f1-score': 0.0036658094873338073, 'support': 109250}, '2': {'precision': 0.3801836552577794, 'recall': 0.5876134543513081, 'f1-score': 0.46166914270733195, 'support': 112380}, 'accuracy': 0.3741637097018773, 'macro avg': {'precision': 0.41173046902108457, 'recall': 0.372666970786009, 'f1-score': 0.2995460256881069, 'support': 329730}, 'weighted avg': {'precision': 0.41158651271452823, 'recall': 0.3741637097018773, 'f1-score': 0.30061849313787303, 'support': 329730}}
[[57136    86 50878]
 [52268   201 56781]
 [46219   125 66036]]
Evaluating performance on  val set...
438/438 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0727293
{'0': {'precision': 0.42123490159641863, 'recall': 0.5718643212622985, 'f1-score': 0.4851261697698399, 'support': 43603}, '1': {'precision': 0.25806451612903225, 'recall': 0.0006059458435902291, 'f1-score': 0.0012090527827105452, 'support': 26405}, '2': {'precision': 0.4162728463246598, 'recall': 0.5229863131289045, 'f1-score': 0.4635674807401693, 'support': 41938}, 'accuracy': 0.418809068658103, 'macro avg': {'precision': 0.3651907546833702, 'recall': 0.3651521934115977, 'f1-score': 0.3166342344309066, 'support': 111946}, 'weighted avg': {'precision': 0.3808885497638086, 'recall': 0.418809068658103, 'f1-score': 0.36290688748577904, 'support': 111946}}
[[24935    17 18651]
 [14284    16 12105]
 [19976    29 21933]]
training model: results/EXC/W8/deepVOL_L3/h10
Epoch 1/50
1289/1289 - 46s - loss: 2.6277 - accuracy10: 0.5334 - val_loss: 2.2556 - val_accuracy10: 0.6574 - 46s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 43s - loss: 2.2427 - accuracy10: 0.6496 - val_loss: 2.0635 - val_accuracy10: 0.7510 - 43s/epoch - 34ms/step
Epoch 3/50
1289/1289 - 43s - loss: 2.1561 - accuracy10: 0.6675 - val_loss: 1.9917 - val_accuracy10: 0.7452 - 43s/epoch - 34ms/step
Epoch 4/50
1289/1289 - 42s - loss: 2.1221 - accuracy10: 0.6764 - val_loss: 1.9956 - val_accuracy10: 0.7370 - 42s/epoch - 32ms/step
Epoch 5/50
1289/1289 - 47s - loss: 2.0989 - accuracy10: 0.6802 - val_loss: 1.9909 - val_accuracy10: 0.7362 - 47s/epoch - 36ms/step
Epoch 6/50
1289/1289 - 47s - loss: 2.0794 - accuracy10: 0.6825 - val_loss: 1.9405 - val_accuracy10: 0.7300 - 47s/epoch - 37ms/step
Epoch 7/50
1289/1289 - 47s - loss: 2.0649 - accuracy10: 0.6858 - val_loss: 1.9476 - val_accuracy10: 0.7065 - 47s/epoch - 37ms/step
Epoch 8/50
1289/1289 - 48s - loss: 2.0530 - accuracy10: 0.6872 - val_loss: 1.9188 - val_accuracy10: 0.7186 - 48s/epoch - 37ms/step
Epoch 9/50
1289/1289 - 48s - loss: 2.0428 - accuracy10: 0.6879 - val_loss: 1.9233 - val_accuracy10: 0.6979 - 48s/epoch - 37ms/step
Epoch 10/50
1289/1289 - 48s - loss: 2.0348 - accuracy10: 0.6889 - val_loss: 1.9745 - val_accuracy10: 0.6904 - 48s/epoch - 37ms/step
Epoch 11/50
1289/1289 - 48s - loss: 2.0236 - accuracy10: 0.6896 - val_loss: 1.9475 - val_accuracy10: 0.7001 - 48s/epoch - 37ms/step
Epoch 12/50
1289/1289 - 48s - loss: 2.0154 - accuracy10: 0.6902 - val_loss: 1.9450 - val_accuracy10: 0.6826 - 48s/epoch - 37ms/step
Epoch 13/50
1289/1289 - 48s - loss: 2.0072 - accuracy10: 0.6898 - val_loss: 1.9373 - val_accuracy10: 0.6926 - 48s/epoch - 37ms/step
Epoch 14/50
1289/1289 - 48s - loss: 2.0004 - accuracy10: 0.6907 - val_loss: 1.9803 - val_accuracy10: 0.6850 - 48s/epoch - 37ms/step
Epoch 15/50
1289/1289 - 48s - loss: 1.9965 - accuracy10: 0.6901 - val_loss: 1.9837 - val_accuracy10: 0.7302 - 48s/epoch - 37ms/step
Epoch 16/50
1289/1289 - 48s - loss: 1.9889 - accuracy10: 0.6901 - val_loss: 1.9735 - val_accuracy10: 0.6975 - 48s/epoch - 37ms/step
Epoch 17/50
1289/1289 - 47s - loss: 1.9825 - accuracy10: 0.6905 - val_loss: 1.9509 - val_accuracy10: 0.7133 - 47s/epoch - 37ms/step
Epoch 18/50
1289/1289 - 48s - loss: 1.9768 - accuracy10: 0.6898 - val_loss: 1.9538 - val_accuracy10: 0.7206 - 48s/epoch - 37ms/step
testing model: results/EXC/W8/deepVOL_L3/h10
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6378086
{'0': {'precision': 0.4555237138821531, 'recall': 0.4361213163448761, 'f1-score': 0.44561141483401284, 'support': 127930}, '1': {'precision': 0.9344800228834187, 'recall': 0.7509304933805078, 'f1-score': 0.8327105329728306, 'support': 1152883}, '2': {'precision': 0.2876172494607485, 'recall': 0.7910065888284263, 'f1-score': 0.4218470449253458, 'support': 132497}, 'accuracy': 0.7261917059951462, 'macro avg': {'precision': 0.5592069954087734, 'recall': 0.6593527995179368, 'f1-score': 0.5667229975773964, 'support': 1413310}, 'weighted avg': {'precision': 0.8304828407360373, 'recall': 0.726191705995146, 'f1-score': 0.7591528777101306, 'support': 1413310}}
[[ 55793  39970  32167]
 [ 59727 865735 227421]
 [  6961  20730 104806]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68817157
{'0': {'precision': 0.3984630431745145, 'recall': 0.42531169838334426, 'f1-score': 0.41144984201641877, 'support': 33526}, '1': {'precision': 0.9297312443773689, 'recall': 0.7208524067799195, 'f1-score': 0.8120751767994471, 'support': 262363}, '2': {'precision': 0.2957492874975145, 'recall': 0.7911409237315682, 'f1-score': 0.43054829657384996, 'support': 33841}, 'accuracy': 0.6980165590028204, 'macro avg': {'precision': 0.5413145250164659, 'recall': 0.6457683429649439, 'f1-score': 0.5513577717965719, 'support': 329730}, 'weighted avg': {'precision': 0.8106462927008516, 'recall': 0.6980165590028204, 'f1-score': 0.732183701569258, 'support': 329730}}
[[ 14259   9301   9966]
 [ 19451 189125  53787]
 [  2075   4993  26773]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6402459
{'0': {'precision': 0.3634321327632437, 'recall': 0.5016504951485445, 'f1-score': 0.42149941166582616, 'support': 9997}, '1': {'precision': 0.9381504650132861, 'recall': 0.7354322849424452, 'f1-score': 0.8245139239428567, 'support': 92173}, '2': {'precision': 0.29427214089838166, 'recall': 0.7793576104746317, 'f1-score': 0.42722965205932656, 'support': 9776}, 'accuracy': 0.7183910099512265, 'macro avg': {'precision': 0.5319515795583039, 'recall': 0.6721467968552072, 'f1-score': 0.5577476625560032, 'support': 111946}, 'weighted avg': {'precision': 0.8305984875951471, 'recall': 0.7183910099512265, 'f1-score': 0.7538299591637055, 'support': 111946}}
[[ 5015  2925  2057]
 [ 8171 67787 16215]
 [  613  1544  7619]]
training model: results/EXC/W8/deepVOL_L3/h20
Epoch 1/50
1289/1289 - 50s - loss: 2.7071 - accuracy20: 0.5156 - val_loss: 2.4012 - val_accuracy20: 0.6392 - 50s/epoch - 39ms/step
Epoch 2/50
1289/1289 - 43s - loss: 2.3472 - accuracy20: 0.6279 - val_loss: 2.2112 - val_accuracy20: 0.6811 - 43s/epoch - 33ms/step
Epoch 3/50
1289/1289 - 42s - loss: 2.2540 - accuracy20: 0.6421 - val_loss: 2.1547 - val_accuracy20: 0.6712 - 42s/epoch - 33ms/step
Epoch 4/50
1289/1289 - 44s - loss: 2.2078 - accuracy20: 0.6519 - val_loss: 2.1097 - val_accuracy20: 0.6743 - 44s/epoch - 34ms/step
Epoch 5/50
1289/1289 - 42s - loss: 2.1791 - accuracy20: 0.6554 - val_loss: 2.1197 - val_accuracy20: 0.6709 - 42s/epoch - 33ms/step
Epoch 6/50
1289/1289 - 43s - loss: 2.1630 - accuracy20: 0.6565 - val_loss: 2.1266 - val_accuracy20: 0.6783 - 43s/epoch - 33ms/step
Epoch 7/50
1289/1289 - 42s - loss: 2.1505 - accuracy20: 0.6581 - val_loss: 2.0998 - val_accuracy20: 0.6698 - 42s/epoch - 33ms/step
Epoch 8/50
1289/1289 - 41s - loss: 2.1377 - accuracy20: 0.6598 - val_loss: 2.1514 - val_accuracy20: 0.6935 - 41s/epoch - 32ms/step
Epoch 9/50
1289/1289 - 43s - loss: 2.1277 - accuracy20: 0.6613 - val_loss: 2.1147 - val_accuracy20: 0.6921 - 43s/epoch - 34ms/step
Epoch 10/50
1289/1289 - 43s - loss: 2.1195 - accuracy20: 0.6619 - val_loss: 2.0746 - val_accuracy20: 0.6790 - 43s/epoch - 33ms/step
Epoch 11/50
1289/1289 - 43s - loss: 2.1099 - accuracy20: 0.6627 - val_loss: 2.0759 - val_accuracy20: 0.6731 - 43s/epoch - 34ms/step
Epoch 12/50
1289/1289 - 45s - loss: 2.1030 - accuracy20: 0.6622 - val_loss: 2.1008 - val_accuracy20: 0.6850 - 45s/epoch - 35ms/step
Epoch 13/50
1289/1289 - 44s - loss: 2.0929 - accuracy20: 0.6640 - val_loss: 2.1098 - val_accuracy20: 0.6810 - 44s/epoch - 34ms/step
Epoch 14/50
1289/1289 - 45s - loss: 2.0865 - accuracy20: 0.6641 - val_loss: 2.0926 - val_accuracy20: 0.6618 - 45s/epoch - 35ms/step
Epoch 15/50
1289/1289 - 44s - loss: 2.0765 - accuracy20: 0.6646 - val_loss: 2.0835 - val_accuracy20: 0.6716 - 44s/epoch - 34ms/step
Epoch 16/50
1289/1289 - 44s - loss: 2.0729 - accuracy20: 0.6650 - val_loss: 2.0864 - val_accuracy20: 0.6821 - 44s/epoch - 34ms/step
Epoch 17/50
1289/1289 - 42s - loss: 2.0646 - accuracy20: 0.6643 - val_loss: 2.0963 - val_accuracy20: 0.6618 - 42s/epoch - 33ms/step
Epoch 18/50
1289/1289 - 42s - loss: 2.0570 - accuracy20: 0.6641 - val_loss: 2.0941 - val_accuracy20: 0.6751 - 42s/epoch - 33ms/step
Epoch 19/50
1289/1289 - 42s - loss: 2.0511 - accuracy20: 0.6649 - val_loss: 2.1157 - val_accuracy20: 0.6719 - 42s/epoch - 32ms/step
Epoch 20/50
1289/1289 - 43s - loss: 2.0479 - accuracy20: 0.6649 - val_loss: 2.1032 - val_accuracy20: 0.6621 - 43s/epoch - 34ms/step
testing model: results/EXC/W8/deepVOL_L3/h20
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6870219
{'0': {'precision': 0.550860507607733, 'recall': 0.39063596243068915, 'f1-score': 0.45711467095702035, 'support': 176740}, '1': {'precision': 0.8899463927967298, 'recall': 0.7206066888019425, 'f1-score': 0.7963740290856031, 'support': 1053522}, '2': {'precision': 0.3369976087556332, 'recall': 0.800702547965561, 'f1-score': 0.47435142272739045, 'support': 183048}, 'accuracy': 0.6897163396565509, 'macro avg': {'precision': 0.5926015030533653, 'recall': 0.6373150663993975, 'f1-score': 0.5759467075900045, 'support': 1413310}, 'weighted avg': {'precision': 0.7759259667264, 'recall': 0.6897163396565509, 'f1-score': 0.7122408290061415, 'support': 1413310}}
[[ 69041  64322  43377]
 [ 49371 759175 244976]
 [  6921  29560 146567]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7430779
{'0': {'precision': 0.4834529999174713, 'recall': 0.3878442796610169, 'f1-score': 0.4304029976856103, 'support': 45312}, '1': {'precision': 0.8868259230615302, 'recall': 0.6865676016295905, 'f1-score': 0.7739525268210717, 'support': 238833}, '2': {'precision': 0.3349895831412821, 'recall': 0.7971701217505759, 'f1-score': 0.47174207953888997, 'support': 45585}, 'accuracy': 0.6608073272071089, 'macro avg': {'precision': 0.5684228353734279, 'recall': 0.6238606676803945, 'f1-score': 0.558699201348524, 'support': 329730}, 'weighted avg': {'precision': 0.7551027148342894, 'recall': 0.6608073272071089, 'f1-score': 0.684960989795189, 'support': 329730}}
[[ 17574  13808  13930]
 [ 16649 163975  58209]
 [  2128   7118  36339]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70140076
{'0': {'precision': 0.446947883674057, 'recall': 0.45169503855667104, 'f1-score': 0.44930892249801, 'support': 13746}, '1': {'precision': 0.8933385722057667, 'recall': 0.6976420327141407, 'f1-score': 0.7834546008773674, 'support': 84734}, '2': {'precision': 0.32921397653848566, 'recall': 0.77944452695678, 'f1-score': 0.46290905883390665, 'support': 13466}, 'accuracy': 0.6772819037750344, 'macro avg': {'precision': 0.5565001441394365, 'recall': 0.6429271994091973, 'f1-score': 0.5652241940697614, 'support': 111946}, 'weighted avg': {'precision': 0.7706670322685426, 'recall': 0.6772819037750344, 'f1-score': 0.7038659352335759, 'support': 111946}}
[[ 6209  4776  2761]
 [ 6995 59114 18625]
 [  688  2282 10496]]
training model: results/EXC/W8/deepVOL_L3/h30
Epoch 1/50
1289/1289 - 47s - loss: 2.8522 - accuracy30: 0.4427 - val_loss: 2.5412 - val_accuracy30: 0.5590 - 47s/epoch - 37ms/step
Epoch 2/50
1289/1289 - 42s - loss: 2.4898 - accuracy30: 0.5895 - val_loss: 2.4472 - val_accuracy30: 0.6391 - 42s/epoch - 33ms/step
Epoch 3/50
1289/1289 - 41s - loss: 2.3745 - accuracy30: 0.6160 - val_loss: 2.3270 - val_accuracy30: 0.6784 - 41s/epoch - 32ms/step
Epoch 4/50
1289/1289 - 41s - loss: 2.3217 - accuracy30: 0.6260 - val_loss: 2.3361 - val_accuracy30: 0.6781 - 41s/epoch - 32ms/step
Epoch 5/50
1289/1289 - 42s - loss: 2.2975 - accuracy30: 0.6300 - val_loss: 2.2860 - val_accuracy30: 0.6989 - 42s/epoch - 32ms/step
Epoch 6/50
1289/1289 - 42s - loss: 2.2747 - accuracy30: 0.6328 - val_loss: 2.2824 - val_accuracy30: 0.6861 - 42s/epoch - 33ms/step
Epoch 7/50
1289/1289 - 41s - loss: 2.2600 - accuracy30: 0.6344 - val_loss: 2.2679 - val_accuracy30: 0.6702 - 41s/epoch - 32ms/step
Epoch 8/50
1289/1289 - 43s - loss: 2.2443 - accuracy30: 0.6358 - val_loss: 2.2526 - val_accuracy30: 0.6819 - 43s/epoch - 34ms/step
Epoch 9/50
1289/1289 - 41s - loss: 2.2322 - accuracy30: 0.6380 - val_loss: 2.2314 - val_accuracy30: 0.6866 - 41s/epoch - 32ms/step
Epoch 10/50
1289/1289 - 42s - loss: 2.2248 - accuracy30: 0.6370 - val_loss: 2.2073 - val_accuracy30: 0.6768 - 42s/epoch - 32ms/step
Epoch 11/50
1289/1289 - 42s - loss: 2.2100 - accuracy30: 0.6379 - val_loss: 2.2053 - val_accuracy30: 0.6725 - 42s/epoch - 32ms/step
Epoch 12/50
1289/1289 - 42s - loss: 2.2011 - accuracy30: 0.6398 - val_loss: 2.1825 - val_accuracy30: 0.6386 - 42s/epoch - 32ms/step
Epoch 13/50
1289/1289 - 41s - loss: 2.1960 - accuracy30: 0.6397 - val_loss: 2.1905 - val_accuracy30: 0.6648 - 41s/epoch - 32ms/step
Epoch 14/50
1289/1289 - 41s - loss: 2.1885 - accuracy30: 0.6403 - val_loss: 2.1737 - val_accuracy30: 0.6642 - 41s/epoch - 32ms/step
Epoch 15/50
1289/1289 - 42s - loss: 2.1803 - accuracy30: 0.6413 - val_loss: 2.1895 - val_accuracy30: 0.6418 - 42s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 42s - loss: 2.1734 - accuracy30: 0.6424 - val_loss: 2.1649 - val_accuracy30: 0.6550 - 42s/epoch - 32ms/step
Epoch 17/50
1289/1289 - 42s - loss: 2.1686 - accuracy30: 0.6421 - val_loss: 2.1678 - val_accuracy30: 0.6510 - 42s/epoch - 32ms/step
Epoch 18/50
1289/1289 - 42s - loss: 2.1626 - accuracy30: 0.6427 - val_loss: 2.1906 - val_accuracy30: 0.6359 - 42s/epoch - 32ms/step
Epoch 19/50
1289/1289 - 41s - loss: 2.1585 - accuracy30: 0.6431 - val_loss: 2.1719 - val_accuracy30: 0.6536 - 41s/epoch - 32ms/step
Epoch 20/50
1289/1289 - 42s - loss: 2.1522 - accuracy30: 0.6448 - val_loss: 2.1800 - val_accuracy30: 0.6612 - 42s/epoch - 33ms/step
Epoch 21/50
1289/1289 - 42s - loss: 2.1478 - accuracy30: 0.6438 - val_loss: 2.1716 - val_accuracy30: 0.6553 - 42s/epoch - 33ms/step
Epoch 22/50
1289/1289 - 42s - loss: 2.1403 - accuracy30: 0.6446 - val_loss: 2.1654 - val_accuracy30: 0.6618 - 42s/epoch - 33ms/step
Epoch 23/50
1289/1289 - 43s - loss: 2.1369 - accuracy30: 0.6442 - val_loss: 2.1902 - val_accuracy30: 0.6477 - 43s/epoch - 33ms/step
Epoch 24/50
1289/1289 - 41s - loss: 2.1328 - accuracy30: 0.6442 - val_loss: 2.1972 - val_accuracy30: 0.6474 - 41s/epoch - 32ms/step
Epoch 25/50
1289/1289 - 41s - loss: 2.1282 - accuracy30: 0.6451 - val_loss: 2.1961 - val_accuracy30: 0.6299 - 41s/epoch - 32ms/step
Epoch 26/50
1289/1289 - 42s - loss: 2.1219 - accuracy30: 0.6464 - val_loss: 2.1952 - val_accuracy30: 0.6558 - 42s/epoch - 32ms/step
testing model: results/EXC/W8/deepVOL_L3/h30
Evaluating performance on  test set...
5521/5521 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71565455
{'0': {'precision': 0.6074093409391871, 'recall': 0.4427526614258003, 'f1-score': 0.5121726013130842, 'support': 215486}, '1': {'precision': 0.8474822094033658, 'recall': 0.6859640129184396, 'f1-score': 0.7582167392334141, 'support': 975350}, '2': {'precision': 0.3753492039008004, 'recall': 0.7875257333441211, 'f1-score': 0.5083902792890823, 'support': 222474}, 'accuracy': 0.6648689954786989, 'macro avg': {'precision': 0.6100802514144511, 'recall': 0.6387474692294536, 'f1-score': 0.5929265399451936, 'support': 1413310}, 'weighted avg': {'precision': 0.7365584485865246, 'recall': 0.6648689954786989, 'f1-score': 0.6813765845939115, 'support': 1413310}}
[[ 95407  82204  37875]
 [ 52598 669055 253697]
 [  9067  38203 175204]]
Evaluating performance on  train set...
1289/1289 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7537946
{'0': {'precision': 0.5416806722689076, 'recall': 0.41477763682826835, 'f1-score': 0.4698103974261529, 'support': 54393}, '1': {'precision': 0.8386976370266157, 'recall': 0.6620026651437274, 'f1-score': 0.7399479698356769, 'support': 220626}, '2': {'precision': 0.37280028086189493, 'recall': 0.7763521046955822, 'f1-score': 0.5037178468507999, 'support': 54711}, 'accuracy': 0.640193491644679, 'macro avg': {'precision': 0.5843928633858061, 'recall': 0.617710802222526, 'f1-score': 0.5711587380375432, 'support': 329730}, 'weighted avg': {'precision': 0.7123962570575681, 'recall': 0.640193491644679, 'f1-score': 0.6561885932709214, 'support': 329730}}
[[ 22561  18920  12912]
 [ 16023 146055  58548]
 [  3066   9170  42475]]
Evaluating performance on  val set...
438/438 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7201985
{'0': {'precision': 0.5086913334988825, 'recall': 0.48820305052430885, 'f1-score': 0.49823665328955363, 'support': 16784}, '1': {'precision': 0.8507327488596292, 'recall': 0.6683270855835822, 'f1-score': 0.7485784638157662, 'support': 78695}, '2': {'precision': 0.3677387111947319, 'recall': 0.759640493107427, 'f1-score': 0.4955727670701028, 'support': 16467}, 'accuracy': 0.6547531845711325, 'macro avg': {'precision': 0.5757209311844146, 'recall': 0.6387235430717727, 'f1-score': 0.5807959613918076, 'support': 111946}, 'weighted avg': {'precision': 0.7284033584960374, 'recall': 0.6547531845711325, 'f1-score': 0.6738283007355063, 'support': 111946}}
[[ 8194  6223  2367]
 [ 6961 52594 19140]
 [  953  3005 12509]]
training model: results/EXC/W8/deepVOL_L3/h50
Epoch 1/50
1289/1289 - 46s - loss: 3.0201 - accuracy50: 0.4155 - val_loss: 2.8914 - val_accuracy50: 0.4568 - 46s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 48s - loss: 2.7640 - accuracy50: 0.5085 - val_loss: 2.7096 - val_accuracy50: 0.5649 - 48s/epoch - 37ms/step
Epoch 3/50
1289/1289 - 43s - loss: 2.5991 - accuracy50: 0.5797 - val_loss: 2.6982 - val_accuracy50: 0.5906 - 43s/epoch - 33ms/step
Epoch 4/50
1289/1289 - 43s - loss: 2.5486 - accuracy50: 0.5846 - val_loss: 2.5466 - val_accuracy50: 0.6228 - 43s/epoch - 33ms/step
Epoch 5/50
1289/1289 - 46s - loss: 2.5157 - accuracy50: 0.5929 - val_loss: 2.5860 - val_accuracy50: 0.6127 - 46s/epoch - 36ms/step
Epoch 6/50
1289/1289 - 48s - loss: 2.4958 - accuracy50: 0.5958 - val_loss: 2.5867 - val_accuracy50: 0.6001 - 48s/epoch - 37ms/step
Epoch 7/50
1289/1289 - 47s - loss: 2.4776 - accuracy50: 0.5988 - val_loss: 2.5918 - val_accuracy50: 0.6170 - 47s/epoch - 37ms/step
Epoch 8/50
1289/1289 - 45s - loss: 2.4627 - accuracy50: 0.6015 - val_loss: 2.5462 - val_accuracy50: 0.6251 - 45s/epoch - 35ms/step
Epoch 9/50
1289/1289 - 47s - loss: 2.4537 - accuracy50: 0.6024 - val_loss: 2.5181 - val_accuracy50: 0.6340 - 47s/epoch - 36ms/step
Epoch 10/50
1289/1289 - 42s - loss: 2.4411 - accuracy50: 0.6051 - val_loss: 2.5110 - val_accuracy50: 0.6335 - 42s/epoch - 33ms/step
Epoch 11/50
1289/1289 - 43s - loss: 2.4316 - accuracy50: 0.6059 - val_loss: 2.5201 - val_accuracy50: 0.6271 - 43s/epoch - 34ms/step
Epoch 12/50
1289/1289 - 44s - loss: 2.4219 - accuracy50: 0.6080 - val_loss: 2.5336 - val_accuracy50: 0.6253 - 44s/epoch - 34ms/step
Epoch 13/50
1289/1289 - 42s - loss: 2.4141 - accuracy50: 0.6090 - val_loss: 2.5073 - val_accuracy50: 0.6201 - 42s/epoch - 33ms/step
Epoch 14/50
1289/1289 - 43s - loss: 2.4053 - accuracy50: 0.6098 - val_loss: 2.5420 - val_accuracy50: 0.6218 - 43s/epoch - 33ms/step
Epoch 15/50
1289/1289 - 42s - loss: 2.3977 - accuracy50: 0.6105 - val_loss: 2.5094 - val_accuracy50: 0.6269 - 42s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 42s - loss: 2.3886 - accuracy50: 0.6112 - val_loss: 2.5349 - val_accuracy50: 0.6136 - 42s/epoch - 32ms/step
Epoch 17/50
1289/1289 - 43s - loss: 2.3831 - accuracy50: 0.6116 - val_loss: 2.5359 - val_accuracy50: 0.6275 - 43s/epoch - 33ms/step
Epoch 18/50
1289/1289 - 42s - loss: 2.3743 - accuracy50: 0.6124 - val_loss: 2.5589 - val_accuracy50: 0.6054 - 42s/epoch - 32ms/step
Epoch 19/50
1289/1289 - 41s - loss: 2.3671 - accuracy50: 0.6132 - val_loss: 2.5324 - val_accuracy50: 0.6098 - 41s/epoch - 32ms/step
Epoch 20/50
1289/1289 - 42s - loss: 2.3611 - accuracy50: 0.6132 - val_loss: 2.5686 - val_accuracy50: 0.5947 - 42s/epoch - 32ms/step
Epoch 21/50
1289/1289 - 43s - loss: 2.3527 - accuracy50: 0.6129 - val_loss: 2.6396 - val_accuracy50: 0.5786 - 43s/epoch - 34ms/step
Epoch 22/50
1289/1289 - 43s - loss: 2.3459 - accuracy50: 0.6152 - val_loss: 2.6254 - val_accuracy50: 0.5753 - 43s/epoch - 33ms/step
Epoch 23/50
1289/1289 - 43s - loss: 2.3373 - accuracy50: 0.6165 - val_loss: 2.5716 - val_accuracy50: 0.5834 - 43s/epoch - 33ms/step
testing model: results/EXC/W8/deepVOL_L3/h50
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7878062
{'0': {'precision': 0.6543730106570792, 'recall': 0.35868421238512993, 'f1-score': 0.4633761303804284, 'support': 283146}, '1': {'precision': 0.7417994225522396, 'recall': 0.7119198118714455, 'f1-score': 0.7265525458347517, 'support': 839426}, '2': {'precision': 0.44944905346811226, 'recall': 0.699506084515956, 'f1-score': 0.5472665331955567, 'support': 290738}, 'accuracy': 0.6385980428922176, 'macro avg': {'precision': 0.6152071622258104, 'recall': 0.5900367029241771, 'f1-score': 0.579065069803579, 'support': 1413310}, 'weighted avg': {'precision': 0.6641435647225715, 'recall': 0.6385980428922176, 'f1-score': 0.636945448967876, 'support': 1413310}}
[[101560 134043  47543]
 [ 40244 597604 201578]
 [ 13398  73967 203373]]
Evaluating performance on  train set...
1289/1289 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8262655
{'0': {'precision': 0.5859686286377163, 'recall': 0.3325033628115967, 'f1-score': 0.42426234297399945, 'support': 69882}, '1': {'precision': 0.7337392186707256, 'recall': 0.6845305087776504, 'f1-score': 0.7082811836792443, 'support': 190142}, '2': {'precision': 0.43260032302149337, 'recall': 0.6993372163084957, 'f1-score': 0.5345409886398527, 'support': 69706}, 'accuracy': 0.6130531040548327, 'macro avg': {'precision': 0.5841027234433117, 'recall': 0.5721236959659143, 'f1-score': 0.5556948384310322, 'support': 329730}, 'weighted avg': {'precision': 0.6387594102431875, 'recall': 0.6130531040548327, 'f1-score': 0.611357826200156, 'support': 329730}}
[[ 23236  30333  16313]
 [ 12359 130158  47625]
 [  4059  16899  48748]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8105742
{'0': {'precision': 0.5562231173619171, 'recall': 0.36792665853768686, 'f1-score': 0.4428920902419135, 'support': 22143}, '1': {'precision': 0.7421103674144263, 'recall': 0.6848097180247058, 'f1-score': 0.712309535254576, 'support': 68162}, '2': {'precision': 0.42747093023255817, 'recall': 0.6794972505891594, 'f1-score': 0.5247943469959494, 'support': 21641}, 'accuracy': 0.6211030318189127, 'macro avg': {'precision': 0.5752681383363005, 'recall': 0.5774112090505173, 'f1-score': 0.5599986574974797, 'support': 111946}, 'weighted avg': {'precision': 0.6445167648027607, 'recall': 0.6211030318189127, 'f1-score': 0.6227688042412274, 'support': 111946}}
[[ 8147 10564  3432]
 [ 5221 46678 16263]
 [ 1279  5657 14705]]
training model: results/EXC/W8/deepVOL_L3/h100
Epoch 1/50
1289/1289 - 47s - loss: 3.1630 - accuracy100: 0.4223 - val_loss: 3.1265 - val_accuracy100: 0.4444 - 47s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 42s - loss: 3.1010 - accuracy100: 0.4260 - val_loss: 3.0892 - val_accuracy100: 0.4498 - 42s/epoch - 33ms/step
Epoch 3/50
1289/1289 - 43s - loss: 3.0189 - accuracy100: 0.4641 - val_loss: 3.0792 - val_accuracy100: 0.4885 - 43s/epoch - 33ms/step
Epoch 4/50
1289/1289 - 42s - loss: 2.9071 - accuracy100: 0.5130 - val_loss: 2.9747 - val_accuracy100: 0.5169 - 42s/epoch - 33ms/step
Epoch 5/50
1289/1289 - 42s - loss: 2.8587 - accuracy100: 0.5219 - val_loss: 2.9594 - val_accuracy100: 0.5270 - 42s/epoch - 32ms/step
Epoch 6/50
1289/1289 - 42s - loss: 2.8357 - accuracy100: 0.5283 - val_loss: 2.9390 - val_accuracy100: 0.5209 - 42s/epoch - 33ms/step
Epoch 7/50
1289/1289 - 42s - loss: 2.8201 - accuracy100: 0.5310 - val_loss: 2.9150 - val_accuracy100: 0.5248 - 42s/epoch - 33ms/step
Epoch 8/50
1289/1289 - 42s - loss: 2.8070 - accuracy100: 0.5353 - val_loss: 2.9067 - val_accuracy100: 0.5224 - 42s/epoch - 32ms/step
Epoch 9/50
1289/1289 - 42s - loss: 2.7957 - accuracy100: 0.5368 - val_loss: 2.9187 - val_accuracy100: 0.5214 - 42s/epoch - 33ms/step
Epoch 10/50
1289/1289 - 42s - loss: 2.7839 - accuracy100: 0.5406 - val_loss: 2.8987 - val_accuracy100: 0.5271 - 42s/epoch - 32ms/step
Epoch 11/50
1289/1289 - 42s - loss: 2.7761 - accuracy100: 0.5431 - val_loss: 2.9206 - val_accuracy100: 0.5231 - 42s/epoch - 32ms/step
Epoch 12/50
1289/1289 - 42s - loss: 2.7677 - accuracy100: 0.5449 - val_loss: 2.9223 - val_accuracy100: 0.5209 - 42s/epoch - 33ms/step
Epoch 13/50
1289/1289 - 42s - loss: 2.7617 - accuracy100: 0.5475 - val_loss: 2.9177 - val_accuracy100: 0.5284 - 42s/epoch - 33ms/step
Epoch 14/50
1289/1289 - 42s - loss: 2.7547 - accuracy100: 0.5484 - val_loss: 2.9107 - val_accuracy100: 0.5263 - 42s/epoch - 33ms/step
Epoch 15/50
1289/1289 - 42s - loss: 2.7460 - accuracy100: 0.5505 - val_loss: 2.9066 - val_accuracy100: 0.5281 - 42s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 42s - loss: 2.7394 - accuracy100: 0.5509 - val_loss: 2.8905 - val_accuracy100: 0.5294 - 42s/epoch - 33ms/step
Epoch 17/50
1289/1289 - 42s - loss: 2.7331 - accuracy100: 0.5532 - val_loss: 2.8980 - val_accuracy100: 0.5320 - 42s/epoch - 32ms/step
Epoch 18/50
1289/1289 - 41s - loss: 2.7258 - accuracy100: 0.5539 - val_loss: 2.9084 - val_accuracy100: 0.5290 - 41s/epoch - 32ms/step
Epoch 19/50
1289/1289 - 42s - loss: 2.7178 - accuracy100: 0.5559 - val_loss: 2.9162 - val_accuracy100: 0.5281 - 42s/epoch - 32ms/step
Epoch 20/50
1289/1289 - 42s - loss: 2.7079 - accuracy100: 0.5591 - val_loss: 2.9249 - val_accuracy100: 0.5236 - 42s/epoch - 32ms/step
Epoch 21/50
1289/1289 - 41s - loss: 2.7034 - accuracy100: 0.5576 - val_loss: 2.9144 - val_accuracy100: 0.5237 - 41s/epoch - 32ms/step
Epoch 22/50
1289/1289 - 41s - loss: 2.6984 - accuracy100: 0.5588 - val_loss: 2.9380 - val_accuracy100: 0.5211 - 41s/epoch - 32ms/step
Epoch 23/50
1289/1289 - 41s - loss: 2.6899 - accuracy100: 0.5615 - val_loss: 2.9432 - val_accuracy100: 0.5183 - 41s/epoch - 32ms/step
Epoch 24/50
1289/1289 - 42s - loss: 2.6826 - accuracy100: 0.5628 - val_loss: 2.9465 - val_accuracy100: 0.5127 - 42s/epoch - 32ms/step
Epoch 25/50
1289/1289 - 42s - loss: 2.6766 - accuracy100: 0.5636 - val_loss: 2.9594 - val_accuracy100: 0.5151 - 42s/epoch - 33ms/step
Epoch 26/50
1289/1289 - 42s - loss: 2.6690 - accuracy100: 0.5648 - val_loss: 2.9647 - val_accuracy100: 0.5081 - 42s/epoch - 33ms/step
testing model: results/EXC/W8/deepVOL_L3/h100
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9259818
{'0': {'precision': 0.6170349051091731, 'recall': 0.3504129184486064, 'f1-score': 0.4469843160922694, 'support': 406860}, '1': {'precision': 0.5357938196575068, 'recall': 0.6874865926581396, 'f1-score': 0.6022348821009037, 'support': 596688}, '2': {'precision': 0.5311616430728169, 'recall': 0.5400696013783611, 'f1-score': 0.5355785846010871, 'support': 409762}, 'accuracy': 0.5477099857780671, 'macro avg': {'precision': 0.5613301226131656, 'recall': 0.5259897041617023, 'f1-score': 0.5282659275980867, 'support': 1413310}, 'weighted avg': {'precision': 0.5578382813008613, 'recall': 0.5477099857780671, 'f1-score': 0.5382160447174614, 'support': 1413310}}
[[142569 194861  69430]
 [ 60569 410215 125904]
 [ 27917 160545 221300]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.941849
{'0': {'precision': 0.5694975170440199, 'recall': 0.3506202779591456, 'f1-score': 0.4340256841186961, 'support': 96489}, '1': {'precision': 0.5424243680311707, 'recall': 0.6644061158175699, 'f1-score': 0.5972505207840938, 'support': 137872}, '2': {'precision': 0.5002760034697579, 'recall': 0.5321645398399899, 'f1-score': 0.5157278080653602, 'support': 95369}, 'accuracy': 0.5343341521851211, 'macro avg': {'precision': 0.5373992961816495, 'recall': 0.5157303112055684, 'f1-score': 0.5156680043227168, 'support': 329730}, 'weighted avg': {'precision': 0.5381560688022362, 'recall': 0.5343341521851211, 'f1-score': 0.5259068733929542, 'support': 329730}}
[[33831 41530 21128]
 [16701 91603 29568]
 [ 8873 35744 50752]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95126885
{'0': {'precision': 0.5390617655353953, 'recall': 0.3608899518519684, 'f1-score': 0.432338692955835, 'support': 31777}, '1': {'precision': 0.5407587993295749, 'recall': 0.6489039676573959, 'f1-score': 0.5899159663865546, 'support': 49223}, '2': {'precision': 0.4976111374782471, 'recall': 0.50820784592516, 'f1-score': 0.5028536714041342, 'support': 30946}, 'accuracy': 0.528254694227574, 'macro avg': {'precision': 0.525810567447739, 'recall': 0.5060005884781748, 'f1-score': 0.5083694435821746, 'support': 111946}, 'weighted avg': {'precision': 0.5283494753114872, 'recall': 0.528254694227574, 'f1-score': 0.5211188427882666, 'support': 111946}}
[[11468 14894  5415]
 [ 6819 31941 10463]
 [ 2987 12232 15727]]
training model: results/EXC/W8/deepVOL_L3/h200
Epoch 1/50
1289/1289 - 46s - loss: 3.2573 - accuracy200: 0.3941 - val_loss: 3.2357 - val_accuracy200: 0.3939 - 46s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 42s - loss: 3.2099 - accuracy200: 0.4127 - val_loss: 3.2197 - val_accuracy200: 0.4026 - 42s/epoch - 33ms/step
Epoch 3/50
1289/1289 - 42s - loss: 3.1796 - accuracy200: 0.4316 - val_loss: 3.2124 - val_accuracy200: 0.4081 - 42s/epoch - 32ms/step
Epoch 4/50
1289/1289 - 42s - loss: 3.1324 - accuracy200: 0.4483 - val_loss: 3.1767 - val_accuracy200: 0.4174 - 42s/epoch - 32ms/step
Epoch 5/50
1289/1289 - 42s - loss: 3.1053 - accuracy200: 0.4529 - val_loss: 3.1711 - val_accuracy200: 0.4202 - 42s/epoch - 33ms/step
Epoch 6/50
1289/1289 - 43s - loss: 3.0878 - accuracy200: 0.4574 - val_loss: 3.1711 - val_accuracy200: 0.4239 - 43s/epoch - 34ms/step
Epoch 7/50
1289/1289 - 42s - loss: 3.0767 - accuracy200: 0.4606 - val_loss: 3.1734 - val_accuracy200: 0.4232 - 42s/epoch - 33ms/step
Epoch 8/50
1289/1289 - 42s - loss: 3.0667 - accuracy200: 0.4648 - val_loss: 3.1773 - val_accuracy200: 0.4235 - 42s/epoch - 33ms/step
Epoch 9/50
1289/1289 - 42s - loss: 3.0590 - accuracy200: 0.4667 - val_loss: 3.1672 - val_accuracy200: 0.4219 - 42s/epoch - 32ms/step
Epoch 10/50
1289/1289 - 42s - loss: 3.0522 - accuracy200: 0.4706 - val_loss: 3.1914 - val_accuracy200: 0.4222 - 42s/epoch - 33ms/step
Epoch 11/50
1289/1289 - 42s - loss: 3.0434 - accuracy200: 0.4729 - val_loss: 3.1962 - val_accuracy200: 0.4212 - 42s/epoch - 32ms/step
Epoch 12/50
1289/1289 - 42s - loss: 3.0367 - accuracy200: 0.4756 - val_loss: 3.1980 - val_accuracy200: 0.4225 - 42s/epoch - 32ms/step
Epoch 13/50
1289/1289 - 42s - loss: 3.0293 - accuracy200: 0.4779 - val_loss: 3.1915 - val_accuracy200: 0.4219 - 42s/epoch - 33ms/step
Epoch 14/50
1289/1289 - 41s - loss: 3.0207 - accuracy200: 0.4803 - val_loss: 3.1945 - val_accuracy200: 0.4188 - 41s/epoch - 32ms/step
Epoch 15/50
1289/1289 - 41s - loss: 3.0114 - accuracy200: 0.4829 - val_loss: 3.2112 - val_accuracy200: 0.4162 - 41s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 43s - loss: 3.0052 - accuracy200: 0.4855 - val_loss: 3.2143 - val_accuracy200: 0.4141 - 43s/epoch - 33ms/step
Epoch 17/50
1289/1289 - 42s - loss: 2.9950 - accuracy200: 0.4882 - val_loss: 3.2233 - val_accuracy200: 0.4138 - 42s/epoch - 32ms/step
Epoch 18/50
1289/1289 - 42s - loss: 2.9860 - accuracy200: 0.4907 - val_loss: 3.2582 - val_accuracy200: 0.4115 - 42s/epoch - 32ms/step
Epoch 19/50
1289/1289 - 42s - loss: 2.9799 - accuracy200: 0.4923 - val_loss: 3.2574 - val_accuracy200: 0.4112 - 42s/epoch - 32ms/step
testing model: results/EXC/W8/deepVOL_L3/h200
Evaluating performance on  test set...
5521/5521 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.045279
{'0': {'precision': 0.5108901888062319, 'recall': 0.29733519459955, 'f1-score': 0.3758991905638659, 'support': 479960}, '1': {'precision': 0.38649818311091433, 'recall': 0.39593210137690105, 'f1-score': 0.3911582689252148, 'support': 458566}, '2': {'precision': 0.4420257235210782, 'recall': 0.6183885724876996, 'f1-score': 0.5155412506222559, 'support': 474784}, 'accuracy': 0.43718009495439786, 'macro avg': {'precision': 0.44647136514607483, 'recall': 0.4372186228213835, 'f1-score': 0.4275329033704455, 'support': 1413310}, 'weighted avg': {'precision': 0.44739549141526647, 'recall': 0.43718009495439786, 'f1-score': 0.4277612097745224, 'support': 1413310}}
[[142709 161470 175781]
 [ 82170 181561 194835]
 [ 54455 126728 293601]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0471689
{'0': {'precision': 0.4705243177816901, 'recall': 0.30925626259978123, 'f1-score': 0.3732141980460504, 'support': 110617}, '1': {'precision': 0.41789023078831994, 'recall': 0.3703822502451497, 'f1-score': 0.3927046237410666, 'support': 109117}, '2': {'precision': 0.4337986701099093, 'recall': 0.6322411724062693, 'f1-score': 0.5145499611557102, 'support': 109996}, 'accuracy': 0.43723046128650717, 'macro avg': {'precision': 0.44073773955997314, 'recall': 0.43729322841706675, 'f1-score': 0.42682292764760904, 'support': 329730}, 'weighted avg': {'precision': 0.44085474567190097, 'recall': 0.43723046128650717, 'f1-score': 0.42681291632941326, 'support': 329730}}
[[34209 31031 45377]
 [23309 40415 45393]
 [15186 25266 69544]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0556253
{'0': {'precision': 0.44754053685788253, 'recall': 0.3522913147239428, 'f1-score': 0.39424447478581826, 'support': 37293}, '1': {'precision': 0.3948920069367807, 'recall': 0.3282314708040675, 'f1-score': 0.3584892158406206, 'support': 38156}, '2': {'precision': 0.42533660933660933, 'recall': 0.5928980464147738, 'f1-score': 0.4953303117703613, 'support': 36497}, 'accuracy': 0.4225340789309131, 'macro avg': {'precision': 0.42258971771042414, 'recall': 0.42447361064759476, 'f1-score': 0.4160213341322667, 'support': 111946}, 'weighted avg': {'precision': 0.4223566620395463, 'recall': 0.4225340789309131, 'f1-score': 0.4150138826441777, 'support': 111946}}
[[13138 10609 13546]
 [ 9942 12524 15690]
 [ 6276  8582 21639]]
training model: results/EXC/W8/deepVOL_L3/h300
Epoch 1/50
1289/1289 - 46s - loss: 3.2733 - accuracy300: 0.3852 - val_loss: 3.2727 - val_accuracy300: 0.3766 - 46s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 47s - loss: 3.2412 - accuracy300: 0.4007 - val_loss: 3.2609 - val_accuracy300: 0.3810 - 47s/epoch - 37ms/step
Epoch 3/50
1289/1289 - 47s - loss: 3.2295 - accuracy300: 0.4081 - val_loss: 3.2640 - val_accuracy300: 0.3742 - 47s/epoch - 36ms/step
Epoch 4/50
1289/1289 - 48s - loss: 3.2202 - accuracy300: 0.4137 - val_loss: 3.2640 - val_accuracy300: 0.3841 - 48s/epoch - 37ms/step
Epoch 5/50
1289/1289 - 47s - loss: 3.2046 - accuracy300: 0.4233 - val_loss: 3.2646 - val_accuracy300: 0.3798 - 47s/epoch - 36ms/step
Epoch 6/50
1289/1289 - 47s - loss: 3.1945 - accuracy300: 0.4298 - val_loss: 3.2700 - val_accuracy300: 0.3834 - 47s/epoch - 36ms/step
Epoch 7/50
1289/1289 - 46s - loss: 3.1847 - accuracy300: 0.4333 - val_loss: 3.2654 - val_accuracy300: 0.3884 - 46s/epoch - 36ms/step
Epoch 8/50
1289/1289 - 46s - loss: 3.1747 - accuracy300: 0.4366 - val_loss: 3.2706 - val_accuracy300: 0.3871 - 46s/epoch - 36ms/step
Epoch 9/50
1289/1289 - 46s - loss: 3.1681 - accuracy300: 0.4387 - val_loss: 3.2792 - val_accuracy300: 0.3870 - 46s/epoch - 36ms/step
Epoch 10/50
1289/1289 - 46s - loss: 3.1541 - accuracy300: 0.4441 - val_loss: 3.3176 - val_accuracy300: 0.3808 - 46s/epoch - 36ms/step
Epoch 11/50
1289/1289 - 46s - loss: 3.1465 - accuracy300: 0.4479 - val_loss: 3.3091 - val_accuracy300: 0.3818 - 46s/epoch - 36ms/step
Epoch 12/50
1289/1289 - 46s - loss: 3.1386 - accuracy300: 0.4501 - val_loss: 3.3256 - val_accuracy300: 0.3769 - 46s/epoch - 36ms/step
testing model: results/EXC/W8/deepVOL_L3/h300
Evaluating performance on  test set...
5521/5521 - 92s - 92s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0838528
{'0': {'precision': 0.46355574232533203, 'recall': 0.2655935738970703, 'f1-score': 0.3377015477228852, 'support': 481785}, '1': {'precision': 0.3208453813574574, 'recall': 0.35120026091201006, 'f1-score': 0.3353372882967707, 'support': 456859}, '2': {'precision': 0.40132142688993866, 'recall': 0.5387324982198008, 'f1-score': 0.45998402670849464, 'support': 474666}, 'accuracy': 0.3850011674721045, 'macro avg': {'precision': 0.3952408501909093, 'recall': 0.3851754443429604, 'f1-score': 0.37767428757605015, 'support': 1413310}, 'weighted avg': {'precision': 0.39652230566113333, 'recall': 0.3850011674721045, 'f1-score': 0.3780063654720188, 'support': 1413310}}
[[127959 178804 175022]
 [ 89960 160449 206450]
 [ 58119 160829 255718]]
Evaluating performance on  train set...
1289/1289 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0850366
{'0': {'precision': 0.4475520972481966, 'recall': 0.2429898916640225, 'f1-score': 0.31497182610330626, 'support': 110305}, '1': {'precision': 0.34119063484371215, 'recall': 0.4108898250989404, 'f1-score': 0.37281053755078064, 'support': 109662}, '2': {'precision': 0.4014864492154045, 'recall': 0.503958528830298, 'f1-score': 0.4469239439123216, 'support': 109763}, 'accuracy': 0.3857034543414309, 'macro avg': {'precision': 0.39674306043577107, 'recall': 0.38594608186442025, 'f1-score': 0.37823543585546954, 'support': 329730}, 'weighted avg': {'precision': 0.3968435950942405, 'recall': 0.3857034543414309, 'f1-score': 0.37813310679303386, 'support': 329730}}
[[26803 45595 37907]
 [20048 45059 44555]
 [13037 41410 55316]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0868721
{'0': {'precision': 0.4437834367643912, 'recall': 0.2697169909478722, 'f1-score': 0.3355174812729538, 'support': 38444}, '1': {'precision': 0.324185892482614, 'recall': 0.4106034338124266, 'f1-score': 0.36231294027659544, 'support': 35762}, '2': {'precision': 0.4078223906112831, 'recall': 0.46775304716481186, 'f1-score': 0.4357366771159875, 'support': 37740}, 'accuracy': 0.38148750290318545, 'macro avg': {'precision': 0.3919305732860961, 'recall': 0.3826911573083702, 'f1-score': 0.37785569955517895, 'support': 111946}, 'weighted avg': {'precision': 0.39345365936793925, 'recall': 0.38148750290318545, 'f1-score': 0.3778640738801423, 'support': 111946}}
[[10369 15857 12218]
 [ 7663 14684 13415]
 [ 5333 14754 17653]]
training model: results/EXC/W8/deepVOL_L3/h500
Epoch 1/50
1289/1289 - 47s - loss: 3.2745 - accuracy500: 0.3905 - val_loss: 3.2785 - val_accuracy500: 0.3743 - 47s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 49s - loss: 3.2564 - accuracy500: 0.3943 - val_loss: 3.2693 - val_accuracy500: 0.3830 - 49s/epoch - 38ms/step
Epoch 3/50
1289/1289 - 46s - loss: 3.2484 - accuracy500: 0.4023 - val_loss: 3.2701 - val_accuracy500: 0.3819 - 46s/epoch - 36ms/step
Epoch 4/50
1289/1289 - 48s - loss: 3.2416 - accuracy500: 0.4072 - val_loss: 3.2708 - val_accuracy500: 0.3812 - 48s/epoch - 37ms/step
Epoch 5/50
1289/1289 - 46s - loss: 3.2352 - accuracy500: 0.4108 - val_loss: 3.2913 - val_accuracy500: 0.3714 - 46s/epoch - 36ms/step
Epoch 6/50
1289/1289 - 48s - loss: 3.2245 - accuracy500: 0.4167 - val_loss: 3.3025 - val_accuracy500: 0.3718 - 48s/epoch - 37ms/step
Epoch 7/50
1289/1289 - 46s - loss: 3.2136 - accuracy500: 0.4219 - val_loss: 3.2967 - val_accuracy500: 0.3755 - 46s/epoch - 36ms/step
Epoch 8/50
1289/1289 - 47s - loss: 3.2022 - accuracy500: 0.4269 - val_loss: 3.3143 - val_accuracy500: 0.3700 - 47s/epoch - 37ms/step
Epoch 9/50
1289/1289 - 46s - loss: 3.1910 - accuracy500: 0.4311 - val_loss: 3.3265 - val_accuracy500: 0.3670 - 46s/epoch - 36ms/step
Epoch 10/50
1289/1289 - 47s - loss: 3.1822 - accuracy500: 0.4341 - val_loss: 3.3481 - val_accuracy500: 0.3640 - 47s/epoch - 37ms/step
Epoch 11/50
1289/1289 - 46s - loss: 3.1718 - accuracy500: 0.4391 - val_loss: 3.4013 - val_accuracy500: 0.3576 - 46s/epoch - 36ms/step
Epoch 12/50
1289/1289 - 46s - loss: 3.1674 - accuracy500: 0.4401 - val_loss: 3.3995 - val_accuracy500: 0.3640 - 46s/epoch - 36ms/step
testing model: results/EXC/W8/deepVOL_L3/h500
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0880631
{'0': {'precision': 0.4150042406857494, 'recall': 0.39789624063488094, 'f1-score': 0.4062702163692328, 'support': 495589}, '1': {'precision': 0.3042569244334554, 'recall': 0.07948845825021374, 'f1-score': 0.12604667014379886, 'support': 421080}, '2': {'precision': 0.3903980235273661, 'recall': 0.6509833058486915, 'f1-score': 0.48808748300665095, 'support': 496641}, 'accuracy': 0.3919656692445394, 'macro avg': {'precision': 0.36988639621552366, 'recall': 0.37612266824459534, 'f1-score': 0.34013478983989415, 'support': 1413310}, 'weighted avg': {'precision': 0.37336161718257416, 'recall': 0.3919656692445394, 'f1-score': 0.35153153785954155, 'support': 1413310}}
[[197193  39850 258546]
 [141318  33471 246291]
 [136648  36688 323305]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894171
{'0': {'precision': 0.3924164132333774, 'recall': 0.38737818009271086, 'f1-score': 0.3898810207146104, 'support': 109588}, '1': {'precision': 0.36564988468735043, 'recall': 0.07714765747651968, 'f1-score': 0.12741277615199162, 'support': 108921}, '2': {'precision': 0.37643527658031506, 'recall': 0.6720673254151645, 'f1-score': 0.482573622691574, 'support': 111221}, 'accuracy': 0.3809268189124435, 'macro avg': {'precision': 0.37816719150034767, 'recall': 0.378864387661465, 'f1-score': 0.33328913985272535, 'support': 329730}, 'weighted avg': {'precision': 0.3781839349770706, 'recall': 0.3809268189124435, 'f1-score': 0.334444937308414, 'support': 329730}}
[[42452  7262 59874]
 [36572  8403 63946]
 [29157  7316 74748]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0898888
{'0': {'precision': 0.40141624763574296, 'recall': 0.44858873566181207, 'f1-score': 0.4236935324836577, 'support': 38795}, '1': {'precision': 0.3379061371841155, 'recall': 0.07873706642738973, 'f1-score': 0.12771473404134356, 'support': 35663}, '2': {'precision': 0.3756842838658306, 'recall': 0.6041133162612036, 'f1-score': 0.46327094200675056, 'support': 37488}, 'accuracy': 0.382845300412699, 'macro avg': {'precision': 0.3716688895618963, 'recall': 0.37714637278346846, 'f1-score': 0.3382264028439173, 'support': 111946}, 'weighted avg': {'precision': 0.37256661543054703, 'recall': 0.382845300412699, 'f1-score': 0.3426561219406589, 'support': 111946}}
[[17403  2844 18548]
 [13768  2808 19087]
 [12183  2658 22647]]
training model: results/EXC/W8/deepVOL_L3/h1000
Epoch 1/50
1289/1289 - 46s - loss: 3.2591 - accuracy1000: 0.4012 - val_loss: 3.2280 - val_accuracy1000: 0.3893 - 46s/epoch - 36ms/step
Epoch 2/50
1289/1289 - 46s - loss: 3.2458 - accuracy1000: 0.3978 - val_loss: 3.2286 - val_accuracy1000: 0.3874 - 46s/epoch - 36ms/step
Epoch 3/50
1289/1289 - 44s - loss: 3.2436 - accuracy1000: 0.4001 - val_loss: 3.2274 - val_accuracy1000: 0.3890 - 44s/epoch - 34ms/step
Epoch 4/50
1289/1289 - 45s - loss: 3.2352 - accuracy1000: 0.4069 - val_loss: 3.2340 - val_accuracy1000: 0.3973 - 45s/epoch - 35ms/step
Epoch 5/50
1289/1289 - 47s - loss: 3.2321 - accuracy1000: 0.4108 - val_loss: 3.2283 - val_accuracy1000: 0.4044 - 47s/epoch - 37ms/step
Epoch 6/50
1289/1289 - 46s - loss: 3.2223 - accuracy1000: 0.4146 - val_loss: 3.2265 - val_accuracy1000: 0.4093 - 46s/epoch - 36ms/step
Epoch 7/50
1289/1289 - 43s - loss: 3.2232 - accuracy1000: 0.4128 - val_loss: 3.2238 - val_accuracy1000: 0.4066 - 43s/epoch - 33ms/step
Epoch 8/50
1289/1289 - 43s - loss: 3.2132 - accuracy1000: 0.4204 - val_loss: 3.2331 - val_accuracy1000: 0.4067 - 43s/epoch - 33ms/step
Epoch 9/50
1289/1289 - 43s - loss: 3.2012 - accuracy1000: 0.4287 - val_loss: 3.2374 - val_accuracy1000: 0.4043 - 43s/epoch - 33ms/step
Epoch 10/50
1289/1289 - 42s - loss: 3.1866 - accuracy1000: 0.4334 - val_loss: 3.2380 - val_accuracy1000: 0.4007 - 42s/epoch - 33ms/step
Epoch 11/50
1289/1289 - 43s - loss: 3.1741 - accuracy1000: 0.4411 - val_loss: 3.2579 - val_accuracy1000: 0.4001 - 43s/epoch - 33ms/step
Epoch 12/50
1289/1289 - 43s - loss: 3.1636 - accuracy1000: 0.4457 - val_loss: 3.2559 - val_accuracy1000: 0.4093 - 43s/epoch - 33ms/step
Epoch 13/50
1289/1289 - 41s - loss: 3.1586 - accuracy1000: 0.4451 - val_loss: 3.2671 - val_accuracy1000: 0.4031 - 41s/epoch - 32ms/step
Epoch 14/50
1289/1289 - 42s - loss: 3.1414 - accuracy1000: 0.4535 - val_loss: 3.3477 - val_accuracy1000: 0.3910 - 42s/epoch - 33ms/step
Epoch 15/50
1289/1289 - 42s - loss: 3.1311 - accuracy1000: 0.4578 - val_loss: 3.3511 - val_accuracy1000: 0.3914 - 42s/epoch - 32ms/step
Epoch 16/50
1289/1289 - 41s - loss: 3.1195 - accuracy1000: 0.4619 - val_loss: 3.3732 - val_accuracy1000: 0.3899 - 41s/epoch - 32ms/step
Epoch 17/50
1289/1289 - 42s - loss: 3.1134 - accuracy1000: 0.4642 - val_loss: 3.3418 - val_accuracy1000: 0.3906 - 42s/epoch - 32ms/step
testing model: results/EXC/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1461537
{'0': {'precision': 0.3336536744644143, 'recall': 0.65205079991643, 'f1-score': 0.4414287466154276, 'support': 449922}, '1': {'precision': 0.6666666666666666, 'recall': 3.877998177340857e-06, 'f1-score': 7.755951238334564e-06, 'support': 515730}, '2': {'precision': 0.32184347122665885, 'recall': 0.38394488649817493, 'f1-score': 0.35016206679474454, 'support': 447658}, 'accuracy': 0.3291917555242657, 'macro avg': {'precision': 0.44072127078591333, 'recall': 0.34533318813759406, 'f1-score': 0.26386618978713683, 'support': 1413310}, 'weighted avg': {'precision': 0.4514324056044052, 'recall': 0.3291917555242657, 'f1-score': 0.2514419023488409, 'support': 1413310}}
[[293372      0 156550]
 [310118      2 205610]
 [275781      1 171876]]
Evaluating performance on  train set...
1289/1289 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1260864
{'0': {'precision': 0.3512067469005454, 'recall': 0.752358926919519, 'f1-score': 0.47887232720881556, 'support': 108100}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 109250}, '2': {'precision': 0.37919616932402833, 'recall': 0.33119772201459335, 'f1-score': 0.3535754150141307, 'support': 112380}, 'accuracy': 0.35953659054377823, 'macro avg': {'precision': 0.24346763874152458, 'recall': 0.3611855496447041, 'f1-score': 0.2774825807409821, 'support': 329730}, 'weighted avg': {'precision': 0.24438029554054305, 'recall': 0.35953659054377823, 'f1-score': 0.2775025133004609, 'support': 329730}}
[[81330     0 26770]
 [75085     0 34165]
 [75158     2 37220]]
Evaluating performance on  val set...
438/438 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0749654
{'0': {'precision': 0.40573281224474406, 'recall': 0.7404765727128867, 'f1-score': 0.5242247118038642, 'support': 43603}, '1': {'precision': 1.0, 'recall': 3.787161522438932e-05, 'f1-score': 7.574036203893055e-05, 'support': 26405}, '2': {'precision': 0.4045044488383589, 'recall': 0.3121989603700701, 'f1-score': 0.35240761176755575, 'support': 41938}, 'accuracy': 0.40538295249495293, 'macro avg': {'precision': 0.6034124203610344, 'recall': 0.3509044682327271, 'f1-score': 0.29223602131115295, 'support': 111946}, 'weighted avg': {'precision': 0.5454440121816829, 'recall': 0.40538295249495293, 'f1-score': 0.3362249696760159, 'support': 111946}}
[[32287     0 11316]
 [18445     1  7959]
 [28845     0 13093]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        20 (peak)  24.03 (ave)

============================================
