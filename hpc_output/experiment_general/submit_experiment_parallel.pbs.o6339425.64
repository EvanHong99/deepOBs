This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-04.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-27.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-14.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-23.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-19.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-21.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-09-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-13.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-28.csv
training model: results/PCAR/W6/deepLOB_L1/h10
Epoch 1/50
618/618 - 61s - loss: 3.2774 - accuracy10: 0.3850 - val_loss: 3.3318 - val_accuracy10: 0.3648 - 61s/epoch - 99ms/step
Epoch 2/50
618/618 - 41s - loss: 3.2243 - accuracy10: 0.4146 - val_loss: 3.2817 - val_accuracy10: 0.3923 - 41s/epoch - 67ms/step
Epoch 3/50
618/618 - 39s - loss: 3.1902 - accuracy10: 0.4341 - val_loss: 3.2194 - val_accuracy10: 0.4141 - 39s/epoch - 63ms/step
Epoch 4/50
618/618 - 40s - loss: 3.1681 - accuracy10: 0.4438 - val_loss: 3.1972 - val_accuracy10: 0.4249 - 40s/epoch - 65ms/step
Epoch 5/50
618/618 - 39s - loss: 3.1546 - accuracy10: 0.4497 - val_loss: 3.1940 - val_accuracy10: 0.4299 - 39s/epoch - 64ms/step
Epoch 6/50
618/618 - 39s - loss: 3.1420 - accuracy10: 0.4558 - val_loss: 3.2019 - val_accuracy10: 0.4320 - 39s/epoch - 64ms/step
Epoch 7/50
618/618 - 42s - loss: 3.1360 - accuracy10: 0.4569 - val_loss: 3.1935 - val_accuracy10: 0.4284 - 42s/epoch - 68ms/step
Epoch 8/50
618/618 - 40s - loss: 3.1300 - accuracy10: 0.4598 - val_loss: 3.1846 - val_accuracy10: 0.4333 - 40s/epoch - 65ms/step
Epoch 9/50
618/618 - 40s - loss: 3.1221 - accuracy10: 0.4618 - val_loss: 3.1964 - val_accuracy10: 0.4297 - 40s/epoch - 65ms/step
Epoch 10/50
618/618 - 41s - loss: 3.1156 - accuracy10: 0.4646 - val_loss: 3.1937 - val_accuracy10: 0.4278 - 41s/epoch - 66ms/step
Epoch 11/50
618/618 - 40s - loss: 3.1116 - accuracy10: 0.4663 - val_loss: 3.1932 - val_accuracy10: 0.4323 - 40s/epoch - 65ms/step
Epoch 12/50
618/618 - 41s - loss: 3.1039 - accuracy10: 0.4686 - val_loss: 3.1991 - val_accuracy10: 0.4283 - 41s/epoch - 66ms/step
Epoch 13/50
618/618 - 42s - loss: 3.1017 - accuracy10: 0.4697 - val_loss: 3.1970 - val_accuracy10: 0.4344 - 42s/epoch - 67ms/step
Epoch 14/50
618/618 - 41s - loss: 3.0983 - accuracy10: 0.4711 - val_loss: 3.1930 - val_accuracy10: 0.4384 - 41s/epoch - 67ms/step
Epoch 15/50
618/618 - 42s - loss: 3.0960 - accuracy10: 0.4709 - val_loss: 3.2041 - val_accuracy10: 0.4343 - 42s/epoch - 68ms/step
Epoch 16/50
618/618 - 43s - loss: 3.0895 - accuracy10: 0.4732 - val_loss: 3.2147 - val_accuracy10: 0.4308 - 43s/epoch - 69ms/step
Epoch 17/50
618/618 - 40s - loss: 3.0865 - accuracy10: 0.4753 - val_loss: 3.2114 - val_accuracy10: 0.4322 - 40s/epoch - 65ms/step
Epoch 18/50
618/618 - 41s - loss: 3.0815 - accuracy10: 0.4762 - val_loss: 3.2208 - val_accuracy10: 0.4304 - 41s/epoch - 66ms/step
testing model: results/PCAR/W6/deepLOB_L1/h10
Evaluating performance on  test set...
1722/1722 - 50s - 50s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0765605
{'0': {'precision': 0.4606360274136034, 'recall': 0.43238165155879627, 'f1-score': 0.4460618663893943, 'support': 160733}, '1': {'precision': 0.31426237991034967, 'recall': 0.434652893345865, 'f1-score': 0.364781057552447, 'support': 115973}, '2': {'precision': 0.47750223896729566, 'recall': 0.37690821668200347, 'f1-score': 0.4212835087886601, 'support': 164093}, 'accuracy': 0.41232852161642836, 'macro avg': {'precision': 0.4174668820970829, 'recall': 0.4146475871955549, 'f1-score': 0.41070881091016714, 'support': 440799}, 'weighted avg': {'precision': 0.42840418530548874, 'recall': 0.41232852161642836, 'f1-score': 0.41545305312751174, 'support': 440799}}
[[69498 54143 37092]
 [34981 50408 30584]
 [46395 55850 61848]]
Evaluating performance on  train set...
618/618 - 20s - 20s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0593321
{'0': {'precision': 0.4401786034501309, 'recall': 0.4745307274449535, 'f1-score': 0.45670961440066976, 'support': 51729}, '1': {'precision': 0.43899669911485817, 'recall': 0.3894650451391479, 'f1-score': 0.41275018532246105, 'support': 53612}, '2': {'precision': 0.43462580550673696, 'recall': 0.451246863833346, 'f1-score': 0.4427804095639524, 'support': 52612}, 'accuracy': 0.4379024140092306, 'macro avg': {'precision': 0.43793370269057535, 'recall': 0.43841421213914916, 'f1-score': 0.43741340309569443, 'support': 157953}, 'weighted avg': {'precision': 0.43792788291541174, 'recall': 0.4379024140092306, 'f1-score': 0.4371493892918697, 'support': 157953}}
[[24547 13028 14154]
 [16003 20880 16729]
 [15216 13655 23741]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0623106
{'0': {'precision': 0.4261870503597122, 'recall': 0.4795984455958549, 'f1-score': 0.4513179948194423, 'support': 18528}, '1': {'precision': 0.45263983858311846, 'recall': 0.3871338861991276, 'f1-score': 0.417331989768235, 'support': 20861}, '2': {'precision': 0.4187373360349792, 'recall': 0.4349005925679792, 'f1-score': 0.42666594224552445, 'support': 18057}, 'accuracy': 0.4319708944051805, 'macro avg': {'precision': 0.4325214083259366, 'recall': 0.43387764145432056, 'f1-score': 0.4317719756110672, 'support': 57446}, 'weighted avg': {'precision': 0.43345147475073637, 'recall': 0.4319708944051805, 'f1-score': 0.43122740252928343, 'support': 57446}}
[[8886 4868 4774]
 [6658 8076 6127]
 [5306 4898 7853]]
training model: results/PCAR/W6/deepLOB_L1/h20
Epoch 1/50
618/618 - 49s - loss: 3.2877 - accuracy20: 0.3833 - val_loss: 3.3419 - val_accuracy20: 0.3733 - 49s/epoch - 80ms/step
Epoch 2/50
618/618 - 42s - loss: 3.2471 - accuracy20: 0.4002 - val_loss: 3.2822 - val_accuracy20: 0.3837 - 42s/epoch - 68ms/step
Epoch 3/50
618/618 - 41s - loss: 3.2244 - accuracy20: 0.4145 - val_loss: 3.2900 - val_accuracy20: 0.3777 - 41s/epoch - 67ms/step
Epoch 4/50
618/618 - 44s - loss: 3.2144 - accuracy20: 0.4220 - val_loss: 3.2672 - val_accuracy20: 0.3913 - 44s/epoch - 70ms/step
Epoch 5/50
618/618 - 44s - loss: 3.2059 - accuracy20: 0.4253 - val_loss: 3.2705 - val_accuracy20: 0.3931 - 44s/epoch - 70ms/step
Epoch 6/50
618/618 - 42s - loss: 3.1990 - accuracy20: 0.4282 - val_loss: 3.2901 - val_accuracy20: 0.3958 - 42s/epoch - 68ms/step
Epoch 7/50
618/618 - 46s - loss: 3.1950 - accuracy20: 0.4305 - val_loss: 3.2931 - val_accuracy20: 0.3937 - 46s/epoch - 74ms/step
Epoch 8/50
618/618 - 45s - loss: 3.1876 - accuracy20: 0.4345 - val_loss: 3.3241 - val_accuracy20: 0.3902 - 45s/epoch - 73ms/step
Epoch 9/50
618/618 - 44s - loss: 3.1841 - accuracy20: 0.4349 - val_loss: 3.3179 - val_accuracy20: 0.3836 - 44s/epoch - 71ms/step
Epoch 10/50
618/618 - 47s - loss: 3.1789 - accuracy20: 0.4376 - val_loss: 3.2956 - val_accuracy20: 0.3859 - 47s/epoch - 76ms/step
Epoch 11/50
618/618 - 45s - loss: 3.1734 - accuracy20: 0.4406 - val_loss: 3.3255 - val_accuracy20: 0.3836 - 45s/epoch - 73ms/step
Epoch 12/50
618/618 - 45s - loss: 3.1692 - accuracy20: 0.4400 - val_loss: 3.3368 - val_accuracy20: 0.3875 - 45s/epoch - 73ms/step
Epoch 13/50
618/618 - 45s - loss: 3.1663 - accuracy20: 0.4417 - val_loss: 3.3213 - val_accuracy20: 0.3874 - 45s/epoch - 73ms/step
Epoch 14/50
618/618 - 45s - loss: 3.1620 - accuracy20: 0.4441 - val_loss: 3.3320 - val_accuracy20: 0.3869 - 45s/epoch - 73ms/step
testing model: results/PCAR/W6/deepLOB_L1/h20
Evaluating performance on  test set...
1722/1722 - 51s - 51s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1137906
{'0': {'precision': 0.43143002918061546, 'recall': 0.5965160891089109, 'f1-score': 0.500716816089924, 'support': 161600}, '1': {'precision': 0.2703708311186004, 'recall': 0.4192445286195286, 'f1-score': 0.32873830329948367, 'support': 114048}, '2': {'precision': 0.49092973319841055, 'recall': 0.12044129311962991, 'f1-score': 0.19342824357702706, 'support': 165151}, 'accuracy': 0.37228305871837275, 'macro avg': {'precision': 0.3975768644992088, 'recall': 0.3787339702826898, 'f1-score': 0.34096112098881165, 'support': 440799}, 'weighted avg': {'precision': 0.41205148294449917, 'recall': 0.37228305871837275, 'f1-score': 0.34109118067377836, 'support': 440799}}
[[96397 54839 10364]
 [55972 47814 10262]
 [71067 74193 19891]]
Evaluating performance on  train set...
618/618 - 20s - 20s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0964799
{'0': {'precision': 0.40920412762424385, 'recall': 0.5252940504739065, 'f1-score': 0.460038336528044, 'support': 52542}, '1': {'precision': 0.36492638715732556, 'recall': 0.4953791739560356, 'f1-score': 0.4202621496269409, 'support': 52588}, '2': {'precision': 0.42928130557589705, 'recall': 0.15536792685004638, 'f1-score': 0.2281591859996386, 'support': 52823}, 'accuracy': 0.39162282451108876, 'macro avg': {'precision': 0.4011372734524888, 'recall': 0.3920137170933295, 'f1-score': 0.3694865573848745, 'support': 157953}, 'weighted avg': {'precision': 0.4011767964261398, 'recall': 0.39162282451108876, 'f1-score': 0.3692499217140349, 'support': 157953}}
[[27600 20287  4655]
 [20281 26051  6256]
 [19567 25049  8207]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0894915
{'0': {'precision': 0.40291723482500724, 'recall': 0.5133185933880817, 'f1-score': 0.4514665370280344, 'support': 18996}, '1': {'precision': 0.3721765717561628, 'recall': 0.4902582691436339, 'f1-score': 0.42313374467715303, 'support': 19863}, '2': {'precision': 0.4327683615819209, 'recall': 0.1648463980201216, 'f1-score': 0.2387501461019987, 'support': 18587}, 'accuracy': 0.39259478466733977, 'macro avg': {'precision': 0.40262072272103033, 'recall': 0.38947442018394574, 'f1-score': 0.37111680926906204, 'support': 57446}, 'weighted avg': {'precision': 0.4019466033187979, 'recall': 0.39259478466733977, 'f1-score': 0.37284428634725975, 'support': 57446}}
[[9751 7540 1705]
 [7814 9738 2311]
 [6636 8887 3064]]
training model: results/PCAR/W6/deepLOB_L1/h30
Epoch 1/50
618/618 - 49s - loss: 3.3011 - accuracy30: 0.3736 - val_loss: 3.3518 - val_accuracy30: 0.3457 - 49s/epoch - 80ms/step
Epoch 2/50
618/618 - 44s - loss: 3.2717 - accuracy30: 0.3842 - val_loss: 3.3233 - val_accuracy30: 0.3573 - 44s/epoch - 71ms/step
Epoch 3/50
618/618 - 42s - loss: 3.2563 - accuracy30: 0.3928 - val_loss: 3.2828 - val_accuracy30: 0.3700 - 42s/epoch - 69ms/step
Epoch 4/50
618/618 - 45s - loss: 3.2456 - accuracy30: 0.4008 - val_loss: 3.2920 - val_accuracy30: 0.3747 - 45s/epoch - 73ms/step
Epoch 5/50
618/618 - 47s - loss: 3.2327 - accuracy30: 0.4068 - val_loss: 3.2811 - val_accuracy30: 0.3711 - 47s/epoch - 77ms/step
Epoch 6/50
618/618 - 45s - loss: 3.2297 - accuracy30: 0.4106 - val_loss: 3.2696 - val_accuracy30: 0.3802 - 45s/epoch - 73ms/step
Epoch 7/50
618/618 - 44s - loss: 3.2208 - accuracy30: 0.4146 - val_loss: 3.2782 - val_accuracy30: 0.3792 - 44s/epoch - 70ms/step
Epoch 8/50
618/618 - 45s - loss: 3.2155 - accuracy30: 0.4168 - val_loss: 3.3043 - val_accuracy30: 0.3763 - 45s/epoch - 73ms/step
Epoch 9/50
618/618 - 47s - loss: 3.2085 - accuracy30: 0.4196 - val_loss: 3.3108 - val_accuracy30: 0.3773 - 47s/epoch - 75ms/step
Epoch 10/50
618/618 - 47s - loss: 3.2020 - accuracy30: 0.4221 - val_loss: 3.3001 - val_accuracy30: 0.3784 - 47s/epoch - 76ms/step
Epoch 11/50
618/618 - 46s - loss: 3.1985 - accuracy30: 0.4230 - val_loss: 3.3427 - val_accuracy30: 0.3732 - 46s/epoch - 74ms/step
Epoch 12/50
618/618 - 47s - loss: 3.1947 - accuracy30: 0.4242 - val_loss: 3.2984 - val_accuracy30: 0.3807 - 47s/epoch - 76ms/step
Epoch 13/50
618/618 - 43s - loss: 3.1897 - accuracy30: 0.4264 - val_loss: 3.3203 - val_accuracy30: 0.3744 - 43s/epoch - 70ms/step
Epoch 14/50
618/618 - 43s - loss: 3.1870 - accuracy30: 0.4278 - val_loss: 3.3327 - val_accuracy30: 0.3751 - 43s/epoch - 69ms/step
Epoch 15/50
618/618 - 41s - loss: 3.1824 - accuracy30: 0.4289 - val_loss: 3.3200 - val_accuracy30: 0.3738 - 41s/epoch - 67ms/step
Epoch 16/50
618/618 - 45s - loss: 3.1811 - accuracy30: 0.4302 - val_loss: 3.3437 - val_accuracy30: 0.3711 - 45s/epoch - 72ms/step
testing model: results/PCAR/W6/deepLOB_L1/h30
Evaluating performance on  test set...
1722/1722 - 53s - 53s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0919819
{'0': {'precision': 0.4410666486717502, 'recall': 0.24812248900699124, 'f1-score': 0.31758641772854085, 'support': 158055}, '1': {'precision': 0.2835235930680028, 'recall': 0.3598642856557478, 'f1-score': 0.31716486635824875, 'support': 122021}, '2': {'precision': 0.4177474125547564, 'recall': 0.512061123796843, 'f1-score': 0.46012098442409405, 'support': 160723}, 'accuracy': 0.37529123251187047, 'macro avg': {'precision': 0.3807792180981698, 'recall': 0.3733492994865273, 'f1-score': 0.3649574228369612, 'support': 440799}, 'weighted avg': {'precision': 0.38895332996128024, 'recall': 0.37529123251187047, 'f1-score': 0.36944031268577754, 'support': 440799}}
[[39217 57743 61095]
 [24496 43911 53614]
 [25201 53222 82300]]
Evaluating performance on  train set...
618/618 - 21s - 21s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907906
{'0': {'precision': 0.4279932655572104, 'recall': 0.25131178707224333, 'f1-score': 0.31667584984308744, 'support': 52600}, '1': {'precision': 0.3452207796871914, 'recall': 0.3673028791960413, 'f1-score': 0.3559196519485328, 'support': 52341}, '2': {'precision': 0.3783939028832413, 'recall': 0.5094884177167434, 'f1-score': 0.43426320443765576, 'support': 53012}, 'accuracy': 0.37639677625622814, 'macro avg': {'precision': 0.3838693160425477, 'recall': 0.3760343613283427, 'f1-score': 0.36895290207642534, 'support': 157953}, 'weighted avg': {'precision': 0.3839184072322966, 'recall': 0.37639677625622814, 'f1-score': 0.3691446265536809, 'support': 157953}}
[[13219 18857 20524]
 [ 9271 19225 23845]
 [ 8396 17607 27009]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0906851
{'0': {'precision': 0.41545697834725487, 'recall': 0.2678552755411482, 'f1-score': 0.32571446736815335, 'support': 19126}, '1': {'precision': 0.3525981901296763, 'recall': 0.38837794790114577, 'f1-score': 0.36962421456688105, 'support': 19463}, '2': {'precision': 0.3757655108332981, 'recall': 0.47181418041045764, 'f1-score': 0.4183476748013354, 'support': 18857}, 'accuracy': 0.3756397312258469, 'macro avg': {'precision': 0.38127355977007643, 'recall': 0.37601580128425055, 'f1-score': 0.3712287855787899, 'support': 57446}, 'weighted avg': {'precision': 0.38113113149996497, 'recall': 0.3756397312258469, 'f1-score': 0.37099873089035423, 'support': 57446}}
[[5123 7314 6689]
 [3813 7559 8091]
 [3395 6565 8897]]
training model: results/PCAR/W6/deepLOB_L1/h50
Epoch 1/50
618/618 - 54s - loss: 3.2735 - accuracy50: 0.3887 - val_loss: 3.3966 - val_accuracy50: 0.3504 - 54s/epoch - 87ms/step
Epoch 2/50
618/618 - 45s - loss: 3.2503 - accuracy50: 0.3934 - val_loss: 3.3369 - val_accuracy50: 0.3608 - 45s/epoch - 73ms/step
Epoch 3/50
618/618 - 45s - loss: 3.2349 - accuracy50: 0.4008 - val_loss: 3.3181 - val_accuracy50: 0.3651 - 45s/epoch - 73ms/step
Epoch 4/50
618/618 - 46s - loss: 3.2292 - accuracy50: 0.4028 - val_loss: 3.3504 - val_accuracy50: 0.3681 - 46s/epoch - 75ms/step
Epoch 5/50
618/618 - 45s - loss: 3.2208 - accuracy50: 0.4109 - val_loss: 3.4338 - val_accuracy50: 0.3655 - 45s/epoch - 73ms/step
Epoch 6/50
618/618 - 45s - loss: 3.2188 - accuracy50: 0.4114 - val_loss: 3.3746 - val_accuracy50: 0.3646 - 45s/epoch - 73ms/step
Epoch 7/50
618/618 - 47s - loss: 3.2125 - accuracy50: 0.4147 - val_loss: 3.4086 - val_accuracy50: 0.3647 - 47s/epoch - 76ms/step
Epoch 8/50
618/618 - 46s - loss: 3.2135 - accuracy50: 0.4152 - val_loss: 3.4528 - val_accuracy50: 0.3652 - 46s/epoch - 74ms/step
Epoch 9/50
618/618 - 46s - loss: 3.2131 - accuracy50: 0.4144 - val_loss: 3.4591 - val_accuracy50: 0.3571 - 46s/epoch - 75ms/step
Epoch 10/50
618/618 - 46s - loss: 3.2038 - accuracy50: 0.4196 - val_loss: 3.4761 - val_accuracy50: 0.3669 - 46s/epoch - 74ms/step
Epoch 11/50
618/618 - 46s - loss: 3.1993 - accuracy50: 0.4226 - val_loss: 3.5091 - val_accuracy50: 0.3608 - 46s/epoch - 74ms/step
Epoch 12/50
618/618 - 42s - loss: 3.1975 - accuracy50: 0.4232 - val_loss: 3.5209 - val_accuracy50: 0.3624 - 42s/epoch - 68ms/step
Epoch 13/50
618/618 - 46s - loss: 3.1926 - accuracy50: 0.4267 - val_loss: 3.5148 - val_accuracy50: 0.3670 - 46s/epoch - 74ms/step
testing model: results/PCAR/W6/deepLOB_L1/h50
Evaluating performance on  test set...
1722/1722 - 48s - 48s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1349293
{'0': {'precision': 0.3774440320713273, 'recall': 0.22596714430077994, 'f1-score': 0.28269264276249945, 'support': 154372}, '1': {'precision': 0.2928284776150519, 'recall': 0.6937650972008922, 'f1-score': 0.41182951606733414, 'support': 129577}, '2': {'precision': 0.3551995747559679, 'recall': 0.09372649027733504, 'f1-score': 0.14831666986147965, 'support': 156850}, 'accuracy': 0.31642540023911125, 'macro avg': {'precision': 0.341824028147449, 'recall': 0.33781957725966905, 'f1-score': 0.2809462762304377, 'support': 440799}, 'weighted avg': {'precision': 0.3446552262217339, 'recall': 0.31642540023911125, 'f1-score': 0.272838485386225, 'support': 440799}}
[[ 34883 105861  13628]
 [ 26622  89896  13059]
 [ 30914 111235  14701]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 35ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1091403
{'0': {'precision': 0.36467328561533136, 'recall': 0.15048784206113272, 'f1-score': 0.21305526702728955, 'support': 52476}, '1': {'precision': 0.3674747748357825, 'recall': 0.41225404543037303, 'f1-score': 0.38857858933046907, 'support': 52652}, '2': {'precision': 0.35339893823643664, 'recall': 0.5166682442025556, 'f1-score': 0.4197147360731998, 'support': 52825}, 'accuracy': 0.36020841642767154, 'macro avg': {'precision': 0.36184899956251687, 'recall': 0.3598033772313538, 'f1-score': 0.3404495308103195, 'support': 157953}, 'weighted avg': {'precision': 0.36183659755081277, 'recall': 0.36020841642767154, 'f1-score': 0.34067829677827377, 'support': 157953}}
[[ 7897 18039 26540]
 [ 7549 21706 23397]
 [ 6209 19323 27293]]
Evaluating performance on  val set...
225/225 - 6s - 6s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1063544
{'0': {'precision': 0.3521234341582646, 'recall': 0.12164872282035043, 'f1-score': 0.18082686122224836, 'support': 18948}, '1': {'precision': 0.3830684854450851, 'recall': 0.42210743801652895, 'f1-score': 0.4016415599734598, 'support': 19360}, '2': {'precision': 0.3540095376602293, 'recall': 0.5469223534329606, 'f1-score': 0.4298121342777949, 'support': 19138}, 'accuracy': 0.3645858719493089, 'macro avg': {'precision': 0.363067152421193, 'recall': 0.36355950475661336, 'f1-score': 0.337426851824501, 'support': 57446}, 'weighted avg': {'precision': 0.3631806433936064, 'recall': 0.3645858719493089, 'f1-score': 0.33819295674779415, 'support': 57446}}
[[ 2305  6456 10187]
 [ 2275  8172  8913]
 [ 1966  6705 10467]]
training model: results/PCAR/W6/deepLOB_L1/h100
Epoch 1/50
618/618 - 52s - loss: 3.3115 - accuracy100: 0.3645 - val_loss: 3.4374 - val_accuracy100: 0.3304 - 52s/epoch - 84ms/step
Epoch 2/50
618/618 - 43s - loss: 3.2870 - accuracy100: 0.3662 - val_loss: 3.3784 - val_accuracy100: 0.3340 - 43s/epoch - 69ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2778 - accuracy100: 0.3696 - val_loss: 3.3454 - val_accuracy100: 0.3378 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 42s - loss: 3.2711 - accuracy100: 0.3769 - val_loss: 3.3475 - val_accuracy100: 0.3374 - 42s/epoch - 68ms/step
Epoch 5/50
618/618 - 47s - loss: 3.2629 - accuracy100: 0.3823 - val_loss: 3.3310 - val_accuracy100: 0.3330 - 47s/epoch - 77ms/step
Epoch 6/50
618/618 - 46s - loss: 3.2597 - accuracy100: 0.3871 - val_loss: 3.3537 - val_accuracy100: 0.3356 - 46s/epoch - 74ms/step
Epoch 7/50
618/618 - 41s - loss: 3.2559 - accuracy100: 0.3891 - val_loss: 3.3520 - val_accuracy100: 0.3381 - 41s/epoch - 67ms/step
Epoch 8/50
618/618 - 46s - loss: 3.2507 - accuracy100: 0.3928 - val_loss: 3.3727 - val_accuracy100: 0.3369 - 46s/epoch - 74ms/step
Epoch 9/50
618/618 - 47s - loss: 3.2493 - accuracy100: 0.3925 - val_loss: 3.3752 - val_accuracy100: 0.3333 - 47s/epoch - 76ms/step
Epoch 10/50
618/618 - 45s - loss: 3.2479 - accuracy100: 0.3964 - val_loss: 3.3863 - val_accuracy100: 0.3339 - 45s/epoch - 72ms/step
Epoch 11/50
618/618 - 44s - loss: 3.2422 - accuracy100: 0.4001 - val_loss: 3.4030 - val_accuracy100: 0.3323 - 44s/epoch - 71ms/step
Epoch 12/50
618/618 - 46s - loss: 3.2368 - accuracy100: 0.4009 - val_loss: 3.3914 - val_accuracy100: 0.3317 - 46s/epoch - 75ms/step
Epoch 13/50
618/618 - 45s - loss: 3.2360 - accuracy100: 0.4013 - val_loss: 3.3841 - val_accuracy100: 0.3374 - 45s/epoch - 73ms/step
Epoch 14/50
618/618 - 44s - loss: 3.2339 - accuracy100: 0.4035 - val_loss: 3.3807 - val_accuracy100: 0.3366 - 44s/epoch - 72ms/step
Epoch 15/50
618/618 - 40s - loss: 3.2298 - accuracy100: 0.4041 - val_loss: 3.4182 - val_accuracy100: 0.3343 - 40s/epoch - 65ms/step
testing model: results/PCAR/W6/deepLOB_L1/h100
Evaluating performance on  test set...
1722/1722 - 49s - 49s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177843
{'0': {'precision': 0.3577206925915413, 'recall': 0.031716570508182385, 'f1-score': 0.05826701573706446, 'support': 158939}, '1': {'precision': 0.28058973002051196, 'recall': 0.5291041945007999, 'f1-score': 0.366709440670361, 'support': 121254}, '2': {'precision': 0.3728668080379683, 'recall': 0.45982092823431253, 'f1-score': 0.41180373941215503, 'support': 160606}, 'accuracy': 0.32451752386008137, 'macro avg': {'precision': 0.3370590768833405, 'recall': 0.3402138977477649, 'f1-score': 0.2789267319398601, 'support': 440799}, 'weighted avg': {'precision': 0.3420221979983169, 'recall': 0.32451752386008137, 'f1-score': 0.2719244805575916, 'support': 440799}}
[[ 5041 82524 71374]
 [ 4262 64156 52836]
 [ 4789 81967 73850]]
Evaluating performance on  train set...
618/618 - 19s - 19s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1083622
{'0': {'precision': 0.3574906903466056, 'recall': 0.07036535859269283, 'f1-score': 0.11758609318321006, 'support': 53208}, '1': {'precision': 0.324794741723826, 'recall': 0.5486585295084822, 'f1-score': 0.4080387841123243, 'support': 51697}, '2': {'precision': 0.3451314192615252, 'recall': 0.3913436887347308, 'f1-score': 0.3667876924707816, 'support': 53048}, 'accuracy': 0.33470715972472825, 'macro avg': {'precision': 0.3424722837773189, 'recall': 0.33678919227863524, 'f1-score': 0.297470856588772, 'support': 157953}, 'weighted avg': {'precision': 0.3426386959655354, 'recall': 0.33470715972472825, 'f1-score': 0.2963429335215988, 'support': 157953}}
[[ 3744 30087 19377]
 [ 3319 28364 20014]
 [ 3410 28878 20760]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121464
{'0': {'precision': 0.3443349753694581, 'recall': 0.07310186153524367, 'f1-score': 0.12060041407867496, 'support': 19124}, '1': {'precision': 0.3274370484882718, 'recall': 0.5829672365426348, 'f1-score': 0.41934132876451546, 'support': 18893}, '2': {'precision': 0.3428528026735531, 'recall': 0.34849966544855626, 'f1-score': 0.34565317269896373, 'support': 19429}, 'accuracy': 0.33393099606587057, 'macro avg': {'precision': 0.33820827551042765, 'recall': 0.3348562545088116, 'f1-score': 0.29519830518071805, 'support': 57446}, 'weighted avg': {'precision': 0.33827624776657905, 'recall': 0.33393099606587057, 'f1-score': 0.29496698700617513, 'support': 57446}}
[[ 1398 11309  6417]
 [ 1318 11014  6561]
 [ 1344 11314  6771]]
training model: results/PCAR/W6/deepLOB_L1/h200
Epoch 1/50
618/618 - 50s - loss: 3.3135 - accuracy200: 0.3674 - val_loss: 3.3995 - val_accuracy200: 0.3354 - 50s/epoch - 81ms/step
Epoch 2/50
618/618 - 46s - loss: 3.2916 - accuracy200: 0.3683 - val_loss: 3.3610 - val_accuracy200: 0.3355 - 46s/epoch - 75ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2744 - accuracy200: 0.3779 - val_loss: 3.4462 - val_accuracy200: 0.3330 - 44s/epoch - 70ms/step
Epoch 4/50
618/618 - 47s - loss: 3.2671 - accuracy200: 0.3816 - val_loss: 3.4053 - val_accuracy200: 0.3435 - 47s/epoch - 76ms/step
Epoch 5/50
618/618 - 46s - loss: 3.2578 - accuracy200: 0.3905 - val_loss: 3.3883 - val_accuracy200: 0.3419 - 46s/epoch - 74ms/step
Epoch 6/50
618/618 - 48s - loss: 3.2482 - accuracy200: 0.3981 - val_loss: 3.4086 - val_accuracy200: 0.3399 - 48s/epoch - 78ms/step
Epoch 7/50
618/618 - 47s - loss: 3.2442 - accuracy200: 0.4010 - val_loss: 3.4220 - val_accuracy200: 0.3372 - 47s/epoch - 76ms/step
Epoch 8/50
618/618 - 43s - loss: 3.2392 - accuracy200: 0.4051 - val_loss: 3.4159 - val_accuracy200: 0.3386 - 43s/epoch - 70ms/step
Epoch 9/50
618/618 - 47s - loss: 3.2387 - accuracy200: 0.4055 - val_loss: 3.4434 - val_accuracy200: 0.3360 - 47s/epoch - 75ms/step
Epoch 10/50
618/618 - 48s - loss: 3.2348 - accuracy200: 0.4081 - val_loss: 3.4016 - val_accuracy200: 0.3386 - 48s/epoch - 78ms/step
Epoch 11/50
618/618 - 45s - loss: 3.2252 - accuracy200: 0.4117 - val_loss: 3.4026 - val_accuracy200: 0.3397 - 45s/epoch - 73ms/step
Epoch 12/50
618/618 - 46s - loss: 3.2195 - accuracy200: 0.4169 - val_loss: 3.4116 - val_accuracy200: 0.3391 - 46s/epoch - 75ms/step
testing model: results/PCAR/W6/deepLOB_L1/h200
Evaluating performance on  test set...
1722/1722 - 50s - 50s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1339453
{'0': {'precision': 0.3487557791677998, 'recall': 0.06714093116402046, 'f1-score': 0.1126038613937458, 'support': 152798}, '1': {'precision': 0.2875379877935077, 'recall': 0.8939674083359448, 'f1-score': 0.4351221595567403, 'support': 127640}, '2': {'precision': 0.36466139566861466, 'recall': 0.03307537368811619, 'f1-score': 0.06064972042125485, 'support': 160361}, 'accuracy': 0.2941680902179905, 'macro avg': {'precision': 0.33365172087664074, 'recall': 0.3313945710626938, 'f1-score': 0.20279191379058029, 'support': 440799}, 'weighted avg': {'precision': 0.33681564699116723, 'recall': 0.2941680902179905, 'f1-score': 0.18709318096351568, 'support': 440799}}
[[ 10259 137688   4851]
 [  9144 114106   4390]
 [ 10013 145044   5304]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.122248
{'0': {'precision': 0.34613012642614865, 'recall': 0.04221511846558857, 'f1-score': 0.07525223745516711, 'support': 53180}, '1': {'precision': 0.33317730549998115, 'recall': 0.8462807064644179, 'f1-score': 0.4781204970693708, 'support': 52147}, '2': {'precision': 0.35398695560698507, 'recall': 0.12788355565689963, 'f1-score': 0.1878891091320249, 'support': 52626}, 'accuracy': 0.3362139370572259, 'macro avg': {'precision': 0.3444314625110383, 'recall': 0.33879312686230206, 'f1-score': 0.24708728121885426, 'support': 157953}, 'weighted avg': {'precision': 0.34447154912552025, 'recall': 0.3362139370572259, 'f1-score': 0.24578397248374018, 'support': 157953}}
[[ 2245 44527  6408]
 [ 2142 44131  5874]
 [ 2099 43797  6730]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221123
{'0': {'precision': 0.3281566509115463, 'recall': 0.025572217837411208, 'f1-score': 0.047447037000878656, 'support': 19005}, '1': {'precision': 0.33136030761919166, 'recall': 0.8085072738772928, 'f1-score': 0.4700672662917733, 'support': 18972}, '2': {'precision': 0.3459789125491007, 'recall': 0.17191432533771636, 'f1-score': 0.22969495247572314, 'support': 19469}, 'accuracy': 0.3337395118894266, 'macro avg': {'precision': 0.3351652903599462, 'recall': 0.33533127235080684, 'f1-score': 0.24906975192279168, 'support': 57446}, 'weighted avg': {'precision': 0.3352548193981075, 'recall': 0.3337395118894266, 'f1-score': 0.2487863061664707, 'support': 57446}}
[[  486 15350  3169]
 [  475 15339  3158]
 [  520 15602  3347]]
training model: results/PCAR/W6/deepLOB_L1/h300
Epoch 1/50
618/618 - 52s - loss: 3.3094 - accuracy300: 0.3685 - val_loss: 3.4737 - val_accuracy300: 0.3375 - 52s/epoch - 84ms/step
Epoch 2/50
618/618 - 45s - loss: 3.2856 - accuracy300: 0.3742 - val_loss: 3.3755 - val_accuracy300: 0.3359 - 45s/epoch - 73ms/step
Epoch 3/50
618/618 - 48s - loss: 3.2721 - accuracy300: 0.3807 - val_loss: 3.3927 - val_accuracy300: 0.3391 - 48s/epoch - 77ms/step
Epoch 4/50
618/618 - 47s - loss: 3.2586 - accuracy300: 0.3909 - val_loss: 3.3896 - val_accuracy300: 0.3279 - 47s/epoch - 76ms/step
Epoch 5/50
618/618 - 46s - loss: 3.2430 - accuracy300: 0.4016 - val_loss: 3.4182 - val_accuracy300: 0.3237 - 46s/epoch - 74ms/step
Epoch 6/50
618/618 - 49s - loss: 3.2385 - accuracy300: 0.4065 - val_loss: 3.4204 - val_accuracy300: 0.3257 - 49s/epoch - 79ms/step
Epoch 7/50
618/618 - 45s - loss: 3.2308 - accuracy300: 0.4088 - val_loss: 3.4608 - val_accuracy300: 0.3258 - 45s/epoch - 72ms/step
Epoch 8/50
618/618 - 47s - loss: 3.2327 - accuracy300: 0.4088 - val_loss: 3.4082 - val_accuracy300: 0.3173 - 47s/epoch - 76ms/step
Epoch 9/50
618/618 - 46s - loss: 3.2238 - accuracy300: 0.4159 - val_loss: 3.4679 - val_accuracy300: 0.3256 - 46s/epoch - 75ms/step
Epoch 10/50
618/618 - 49s - loss: 3.2212 - accuracy300: 0.4175 - val_loss: 3.4822 - val_accuracy300: 0.3257 - 49s/epoch - 79ms/step
Epoch 11/50
618/618 - 44s - loss: 3.2149 - accuracy300: 0.4198 - val_loss: 3.4664 - val_accuracy300: 0.3268 - 44s/epoch - 71ms/step
Epoch 12/50
618/618 - 45s - loss: 3.2068 - accuracy300: 0.4234 - val_loss: 3.4831 - val_accuracy300: 0.3224 - 45s/epoch - 73ms/step
testing model: results/PCAR/W6/deepLOB_L1/h300
Evaluating performance on  test set...
1722/1722 - 56s - 56s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1510025
{'0': {'precision': 0.3306545639500763, 'recall': 0.5795956437055935, 'f1-score': 0.4210841002286984, 'support': 145812}, '1': {'precision': 0.3099977954144621, 'recall': 0.4153571217581379, 'f1-score': 0.3550256267831444, 'support': 135416}, '2': {'precision': 0.3284690899442823, 'recall': 0.007758301947095651, 'f1-score': 0.015158564956532387, 'support': 159571}, 'accuracy': 0.3221332171806197, 'macro avg': {'precision': 0.32304048310294026, 'recall': 0.3342370224702757, 'f1-score': 0.26375609732279176, 'support': 440799}, 'weighted avg': {'precision': 0.3235175349627209, 'recall': 0.3221332171806197, 'f1-score': 0.2538438890916088, 'support': 440799}}
[[84512 60033  1267]
 [77906 56246  1264]
 [93172 65161  1238]]
Evaluating performance on  train set...
618/618 - 20s - 20s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1296277
{'0': {'precision': 0.3436624284953334, 'recall': 0.2746843878419903, 'f1-score': 0.305326076892213, 'support': 54022}, '1': {'precision': 0.3208897870886941, 'recall': 0.4418467930000588, 'f1-score': 0.37177743150882575, 'support': 51029}, '2': {'precision': 0.34295663895753764, 'recall': 0.2885524176779706, 'f1-score': 0.3134110787172012, 'support': 52902}, 'accuracy': 0.3333333333333333, 'macro avg': {'precision': 0.33583628484718836, 'recall': 0.3350278661733399, 'f1-score': 0.3301715290394133, 'support': 157953}, 'weighted avg': {'precision': 0.33606901275477846, 'recall': 0.3333333333333333, 'f1-score': 0.3295019959395034, 'support': 157953}}
[[14839 24219 14964]
 [14201 22547 14281]
 [14139 23498 15265]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279323
{'0': {'precision': 0.33278282411230387, 'recall': 0.18906380316930776, 'f1-score': 0.24113286573812456, 'support': 19184}, '1': {'precision': 0.33002452859113907, 'recall': 0.4671766493055556, 'f1-score': 0.3868026233042854, 'support': 18432}, '2': {'precision': 0.3457345392324615, 'recall': 0.356631366616238, 'f1-score': 0.3510984237309172, 'support': 19830}, 'accuracy': 0.33614176792117817, 'macro avg': {'precision': 0.33618063064530146, 'recall': 0.33762393969703375, 'f1-score': 0.32634463759110904, 'support': 57446}, 'weighted avg': {'precision': 0.3363686544187937, 'recall': 0.33614176792117817, 'f1-score': 0.3258315738545566, 'support': 57446}}
[[3627 8551 7006]
 [3444 8611 6377]
 [3828 8930 7072]]
training model: results/PCAR/W6/deepLOB_L1/h500
Epoch 1/50
618/618 - 49s - loss: 3.3177 - accuracy500: 0.3663 - val_loss: 3.3897 - val_accuracy500: 0.3367 - 49s/epoch - 80ms/step
Epoch 2/50
618/618 - 45s - loss: 3.2890 - accuracy500: 0.3744 - val_loss: 3.4422 - val_accuracy500: 0.3404 - 45s/epoch - 72ms/step
Epoch 3/50
618/618 - 49s - loss: 3.2713 - accuracy500: 0.3848 - val_loss: 3.5063 - val_accuracy500: 0.3387 - 49s/epoch - 79ms/step
Epoch 4/50
618/618 - 47s - loss: 3.2526 - accuracy500: 0.3965 - val_loss: 3.6170 - val_accuracy500: 0.3394 - 47s/epoch - 75ms/step
Epoch 5/50
618/618 - 44s - loss: 3.2392 - accuracy500: 0.4051 - val_loss: 3.5430 - val_accuracy500: 0.3375 - 44s/epoch - 71ms/step
Epoch 6/50
618/618 - 46s - loss: 3.2281 - accuracy500: 0.4111 - val_loss: 3.5513 - val_accuracy500: 0.3422 - 46s/epoch - 74ms/step
Epoch 7/50
618/618 - 43s - loss: 3.2200 - accuracy500: 0.4160 - val_loss: 3.6188 - val_accuracy500: 0.3447 - 43s/epoch - 69ms/step
Epoch 8/50
618/618 - 46s - loss: 3.2119 - accuracy500: 0.4210 - val_loss: 3.6357 - val_accuracy500: 0.3404 - 46s/epoch - 74ms/step
Epoch 9/50
618/618 - 46s - loss: 3.2030 - accuracy500: 0.4262 - val_loss: 3.5875 - val_accuracy500: 0.3454 - 46s/epoch - 75ms/step
Epoch 10/50
618/618 - 47s - loss: 3.1986 - accuracy500: 0.4309 - val_loss: 3.6021 - val_accuracy500: 0.3480 - 47s/epoch - 77ms/step
Epoch 11/50
618/618 - 46s - loss: 3.1974 - accuracy500: 0.4315 - val_loss: 3.5742 - val_accuracy500: 0.3449 - 46s/epoch - 75ms/step
testing model: results/PCAR/W6/deepLOB_L1/h500
Evaluating performance on  test set...
1722/1722 - 51s - 51s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1285294
{'0': {'precision': 0.337178186651742, 'recall': 0.25844052255162847, 'f1-score': 0.2926050018403069, 'support': 149191}, '1': {'precision': 0.29698491317096887, 'recall': 0.6042660071872947, 'f1-score': 0.39824178510763464, 'support': 129395}, '2': {'precision': 0.36709882699339885, 'recall': 0.14296018198294835, 'f1-score': 0.20578213182834626, 'support': 162213}, 'accuracy': 0.3174598853445675, 'macro avg': {'precision': 0.33375397560536985, 'recall': 0.3352222372406238, 'f1-score': 0.2988763062587626, 'support': 440799}, 'weighted avg': {'precision': 0.33639031782648726, 'recall': 0.3174598853445675, 'f1-score': 0.2916636960697078, 'support': 440799}}
[[38557 89114 21520]
 [32745 78189 18461]
 [43050 95973 23190]]
Evaluating performance on  train set...
618/618 - 19s - 19s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127111
{'0': {'precision': 0.34066459478842936, 'recall': 0.15778692306272724, 'f1-score': 0.21567761871728575, 'support': 54187}, '1': {'precision': 0.33153436261784397, 'recall': 0.4728084020186668, 'f1-score': 0.3897647597401033, 'support': 51321}, '2': {'precision': 0.34412134417162493, 'recall': 0.3914958527981695, 'f1-score': 0.3662831147979663, 'support': 52445}, 'accuracy': 0.33773970738130965, 'macro avg': {'precision': 0.3387734338592994, 'recall': 0.3406970592931879, 'f1-score': 0.32390849775178515, 'support': 157953}, 'weighted avg': {'precision': 0.338845804237918, 'recall': 0.33773970738130965, 'f1-score': 0.322246227141205, 'support': 157953}}
[[ 8550 25150 20487]
 [ 8410 24265 18646]
 [ 8138 23775 20532]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.131332
{'0': {'precision': 0.33152370611654, 'recall': 0.18937357866446144, 'f1-score': 0.24105263157894738, 'support': 19348}, '1': {'precision': 0.3192545420490729, 'recall': 0.37593736215262463, 'f1-score': 0.3452851210371721, 'support': 18136}, '2': {'precision': 0.3525840722102404, 'recall': 0.4422402564873259, 'f1-score': 0.3923555555555555, 'support': 19962}, 'accuracy': 0.33614176792117817, 'macro avg': {'precision': 0.3344541067919511, 'recall': 0.3358503991014707, 'f1-score': 0.3262311027238917, 'support': 57446}, 'weighted avg': {'precision': 0.3349685668280754, 'recall': 0.33614176792117817, 'f1-score': 0.32653585751696595, 'support': 57446}}
[[3664 7294 8390]
 [3498 6818 7820]
 [3890 7244 8828]]
training model: results/PCAR/W6/deepLOB_L1/h1000
Epoch 1/50
618/618 - 47s - loss: 3.3112 - accuracy1000: 0.3748 - val_loss: 3.4109 - val_accuracy1000: 0.3434 - 47s/epoch - 77ms/step
Epoch 2/50
618/618 - 41s - loss: 3.2616 - accuracy1000: 0.3940 - val_loss: 3.5426 - val_accuracy1000: 0.3481 - 41s/epoch - 66ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2362 - accuracy1000: 0.4114 - val_loss: 3.6191 - val_accuracy1000: 0.3509 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 44s - loss: 3.2177 - accuracy1000: 0.4207 - val_loss: 3.5934 - val_accuracy1000: 0.3509 - 44s/epoch - 71ms/step
Epoch 5/50
618/618 - 45s - loss: 3.1829 - accuracy1000: 0.4379 - val_loss: 3.6912 - val_accuracy1000: 0.3517 - 45s/epoch - 72ms/step
Epoch 6/50
618/618 - 40s - loss: 3.1796 - accuracy1000: 0.4365 - val_loss: 3.7786 - val_accuracy1000: 0.3522 - 40s/epoch - 65ms/step
Epoch 7/50
618/618 - 44s - loss: 3.1581 - accuracy1000: 0.4448 - val_loss: 3.6838 - val_accuracy1000: 0.3482 - 44s/epoch - 71ms/step
Epoch 8/50
618/618 - 42s - loss: 3.1513 - accuracy1000: 0.4474 - val_loss: 3.6256 - val_accuracy1000: 0.3505 - 42s/epoch - 68ms/step
Epoch 9/50
618/618 - 43s - loss: 3.1320 - accuracy1000: 0.4559 - val_loss: 3.6798 - val_accuracy1000: 0.3447 - 43s/epoch - 69ms/step
Epoch 10/50
618/618 - 42s - loss: 3.1304 - accuracy1000: 0.4576 - val_loss: 3.6021 - val_accuracy1000: 0.3389 - 42s/epoch - 69ms/step
Epoch 11/50
618/618 - 43s - loss: 3.1125 - accuracy1000: 0.4637 - val_loss: 3.6040 - val_accuracy1000: 0.3359 - 43s/epoch - 70ms/step
testing model: results/PCAR/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
1722/1722 - 52s - 52s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1685928
{'0': {'precision': 0.32113442113442114, 'recall': 0.11538568915938469, 'f1-score': 0.169771406272464, 'support': 143276}, '1': {'precision': 0.2925195102574887, 'recall': 0.7647970676950098, 'f1-score': 0.42318084924335414, 'support': 130955}, '2': {'precision': 0.3810162991371045, 'recall': 0.10736155804236108, 'f1-score': 0.16751989433403747, 'support': 166568}, 'accuracy': 0.30528426788627017, 'macro avg': {'precision': 0.3315567435096714, 'recall': 0.3291814382989185, 'f1-score': 0.25349071661661854, 'support': 440799}, 'weighted avg': {'precision': 0.33526135654321804, 'recall': 0.30528426788627017, 'f1-score': 0.24420488675607013, 'support': 440799}}
[[ 16532 112327  14417]
 [ 16166 100154  14635]
 [ 18782 129903  17883]]
Evaluating performance on  train set...
618/618 - 21s - 21s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1471364
{'0': {'precision': 0.35337589644918665, 'recall': 0.14770878648851193, 'f1-score': 0.2083349446356523, 'support': 54709}, '1': {'precision': 0.3251724319486127, 'recall': 0.48800916597526767, 'f1-score': 0.3902870594182979, 'support': 50622}, '2': {'precision': 0.33877488877235123, 'recall': 0.38056326251377753, 'f1-score': 0.3584552736385197, 'support': 52622}, 'accuracy': 0.3343462928845923, 'macro avg': {'precision': 0.3391077390567168, 'recall': 0.338760404992519, 'f1-score': 0.31902575923082327, 'support': 157953}, 'weighted avg': {'precision': 0.3394727100208283, 'recall': 0.3343462928845923, 'f1-score': 0.3166609144324651, 'support': 157953}}
[[ 8081 26109 20519]
 [ 7350 24704 18568]
 [ 7437 25159 20026]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1375061
{'0': {'precision': 0.3326133909287257, 'recall': 0.18752854026079457, 'f1-score': 0.23983647513059275, 'support': 19709}, '1': {'precision': 0.32537463654663384, 'recall': 0.33105763213290096, 'f1-score': 0.3281915343616932, 'support': 17577}, '2': {'precision': 0.35588752196836554, 'recall': 0.5022321428571429, 'f1-score': 0.41658095042172394, 'support': 20160}, 'accuracy': 0.3418862932144971, 'macro avg': {'precision': 0.3379585164812417, 'recall': 0.34027277175027953, 'f1-score': 0.3282029866380033, 'support': 57446}, 'weighted avg': {'precision': 0.3385663014183179, 'recall': 0.3418862932144971, 'f1-score': 0.3288972539136979, 'support': 57446}}
[[ 3696  6141  9872]
 [ 3305  5819  8453]
 [ 4111  5924 10125]]
training model: results/PCAR/W6/deepOF_L1/h10
Epoch 1/50
617/617 - 51s - loss: 3.2570 - accuracy10: 0.4021 - val_loss: 3.2603 - val_accuracy10: 0.4069 - 51s/epoch - 82ms/step
Epoch 2/50
617/617 - 40s - loss: 3.2206 - accuracy10: 0.4209 - val_loss: 3.2432 - val_accuracy10: 0.4146 - 40s/epoch - 65ms/step
Epoch 3/50
617/617 - 41s - loss: 3.2064 - accuracy10: 0.4263 - val_loss: 3.2357 - val_accuracy10: 0.4190 - 41s/epoch - 67ms/step
Epoch 4/50
617/617 - 42s - loss: 3.1975 - accuracy10: 0.4291 - val_loss: 3.2287 - val_accuracy10: 0.4227 - 42s/epoch - 68ms/step
Epoch 5/50
617/617 - 42s - loss: 3.1910 - accuracy10: 0.4337 - val_loss: 3.2222 - val_accuracy10: 0.4253 - 42s/epoch - 69ms/step
Epoch 6/50
617/617 - 40s - loss: 3.1855 - accuracy10: 0.4348 - val_loss: 3.2164 - val_accuracy10: 0.4251 - 40s/epoch - 66ms/step
Epoch 7/50
617/617 - 40s - loss: 3.1808 - accuracy10: 0.4369 - val_loss: 3.2130 - val_accuracy10: 0.4275 - 40s/epoch - 65ms/step
Epoch 8/50
617/617 - 41s - loss: 3.1751 - accuracy10: 0.4390 - val_loss: 3.2117 - val_accuracy10: 0.4280 - 41s/epoch - 66ms/step
Epoch 9/50
617/617 - 40s - loss: 3.1712 - accuracy10: 0.4397 - val_loss: 3.2105 - val_accuracy10: 0.4286 - 40s/epoch - 65ms/step
Epoch 10/50
617/617 - 42s - loss: 3.1674 - accuracy10: 0.4411 - val_loss: 3.2071 - val_accuracy10: 0.4319 - 42s/epoch - 68ms/step
Epoch 11/50
617/617 - 43s - loss: 3.1637 - accuracy10: 0.4426 - val_loss: 3.2088 - val_accuracy10: 0.4286 - 43s/epoch - 70ms/step
Epoch 12/50
617/617 - 39s - loss: 3.1615 - accuracy10: 0.4431 - val_loss: 3.2066 - val_accuracy10: 0.4284 - 39s/epoch - 63ms/step
Epoch 13/50
617/617 - 40s - loss: 3.1588 - accuracy10: 0.4446 - val_loss: 3.2057 - val_accuracy10: 0.4286 - 40s/epoch - 65ms/step
Epoch 14/50
617/617 - 42s - loss: 3.1558 - accuracy10: 0.4448 - val_loss: 3.2029 - val_accuracy10: 0.4296 - 42s/epoch - 68ms/step
Epoch 15/50
617/617 - 40s - loss: 3.1520 - accuracy10: 0.4459 - val_loss: 3.2043 - val_accuracy10: 0.4295 - 40s/epoch - 65ms/step
Epoch 16/50
617/617 - 42s - loss: 3.1494 - accuracy10: 0.4472 - val_loss: 3.2028 - val_accuracy10: 0.4297 - 42s/epoch - 69ms/step
Epoch 17/50
617/617 - 40s - loss: 3.1463 - accuracy10: 0.4493 - val_loss: 3.2033 - val_accuracy10: 0.4289 - 40s/epoch - 65ms/step
Epoch 18/50
617/617 - 42s - loss: 3.1438 - accuracy10: 0.4499 - val_loss: 3.2017 - val_accuracy10: 0.4300 - 42s/epoch - 68ms/step
Epoch 19/50
617/617 - 40s - loss: 3.1428 - accuracy10: 0.4498 - val_loss: 3.2003 - val_accuracy10: 0.4312 - 40s/epoch - 65ms/step
Epoch 20/50
617/617 - 39s - loss: 3.1402 - accuracy10: 0.4496 - val_loss: 3.2019 - val_accuracy10: 0.4280 - 39s/epoch - 63ms/step
Epoch 21/50
617/617 - 41s - loss: 3.1370 - accuracy10: 0.4526 - val_loss: 3.2024 - val_accuracy10: 0.4300 - 41s/epoch - 67ms/step
Epoch 22/50
617/617 - 41s - loss: 3.1350 - accuracy10: 0.4518 - val_loss: 3.1985 - val_accuracy10: 0.4317 - 41s/epoch - 66ms/step
Epoch 23/50
617/617 - 40s - loss: 3.1330 - accuracy10: 0.4525 - val_loss: 3.2021 - val_accuracy10: 0.4295 - 40s/epoch - 65ms/step
Epoch 24/50
617/617 - 40s - loss: 3.1297 - accuracy10: 0.4538 - val_loss: 3.2018 - val_accuracy10: 0.4289 - 40s/epoch - 65ms/step
Epoch 25/50
617/617 - 37s - loss: 3.1285 - accuracy10: 0.4543 - val_loss: 3.1991 - val_accuracy10: 0.4301 - 37s/epoch - 61ms/step
Epoch 26/50
617/617 - 43s - loss: 3.1256 - accuracy10: 0.4553 - val_loss: 3.2023 - val_accuracy10: 0.4300 - 43s/epoch - 69ms/step
Epoch 27/50
617/617 - 42s - loss: 3.1239 - accuracy10: 0.4563 - val_loss: 3.2000 - val_accuracy10: 0.4316 - 42s/epoch - 67ms/step
Epoch 28/50
617/617 - 37s - loss: 3.1210 - accuracy10: 0.4564 - val_loss: 3.1996 - val_accuracy10: 0.4311 - 37s/epoch - 60ms/step
Epoch 29/50
617/617 - 39s - loss: 3.1193 - accuracy10: 0.4580 - val_loss: 3.2018 - val_accuracy10: 0.4308 - 39s/epoch - 63ms/step
Epoch 30/50
617/617 - 41s - loss: 3.1181 - accuracy10: 0.4577 - val_loss: 3.2034 - val_accuracy10: 0.4299 - 41s/epoch - 66ms/step
Epoch 31/50
617/617 - 40s - loss: 3.1143 - accuracy10: 0.4589 - val_loss: 3.2005 - val_accuracy10: 0.4314 - 40s/epoch - 65ms/step
Epoch 32/50
617/617 - 39s - loss: 3.1131 - accuracy10: 0.4602 - val_loss: 3.2026 - val_accuracy10: 0.4303 - 39s/epoch - 64ms/step
testing model: results/PCAR/W6/deepOF_L1/h10
Evaluating performance on  test set...
1722/1722 - 47s - 47s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1119958
{'0': {'precision': 0.4479969611621702, 'recall': 0.30084426775170936, 'f1-score': 0.3599623325529373, 'support': 160731}, '1': {'precision': 0.2955843356968886, 'recall': 0.6132256061808022, 'f1-score': 0.3988950276243094, 'support': 115972}, '2': {'precision': 0.4766854541513115, 'recall': 0.2680159179967213, 'f1-score': 0.34311549399066116, 'support': 164091}, 'accuracy': 0.3708104012305068, 'macro avg': {'precision': 0.4067555836701234, 'recall': 0.3940285973097443, 'f1-score': 0.36732428472263595, 'support': 440794}, 'weighted avg': {'precision': 0.41857715622521907, 'recall': 0.3708104012305068, 'f1-score': 0.36393400169157053, 'support': 440794}}
[[48355 83997 28379]
 [24953 71117 19902]
 [34628 85484 43979]]
Evaluating performance on  train set...
617/617 - 19s - 19s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0606956
{'0': {'precision': 0.47072939904008654, 'recall': 0.2686483671225478, 'f1-score': 0.3420732680806121, 'support': 51841}, '1': {'precision': 0.41390615168942413, 'recall': 0.698931946541408, 'f1-score': 0.5199179157249623, 'support': 53649}, '2': {'precision': 0.4570725121118259, 'recall': 0.3290953452022416, 'f1-score': 0.3826674793594502, 'support': 52462}, 'accuracy': 0.4348726195299838, 'macro avg': {'precision': 0.44723602094711223, 'recall': 0.4322252196220658, 'f1-score': 0.41488622105500816, 'support': 157952}, 'weighted avg': {'precision': 0.4468931829798524, 'recall': 0.4348726195299838, 'f1-score': 0.4159617975932624, 'support': 157952}}
[[13927 26420 11494]
 [ 7138 37497  9014]
 [ 8521 26676 17265]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.065265
{'0': {'precision': 0.44052310999641703, 'recall': 0.26502128576817374, 'f1-score': 0.3309444500521517, 'support': 18557}, '1': {'precision': 0.4319597868946212, 'recall': 0.6870123031260472, 'f1-score': 0.5304183914843288, 'support': 20889}, '2': {'precision': 0.42158064022055447, 'recall': 0.30585032501805653, 'f1-score': 0.354509450365457, 'support': 17999}, 'accuracy': 0.4312646879623988, 'macro avg': {'precision': 0.4313545123705309, 'recall': 0.41929463797075917, 'f1-score': 0.40529076396731245, 'support': 57445}, 'weighted avg': {'precision': 0.4314740235699367, 'recall': 0.4312646879623988, 'f1-score': 0.41086363541582005, 'support': 57445}}
[[ 4918  9639  4000]
 [ 2985 14351  3553]
 [ 3261  9233  5505]]
training model: results/PCAR/W6/deepOF_L1/h20
Epoch 1/50
617/617 - 43s - loss: 3.2826 - accuracy20: 0.3856 - val_loss: 3.2911 - val_accuracy20: 0.3776 - 43s/epoch - 69ms/step
Epoch 2/50
617/617 - 40s - loss: 3.2530 - accuracy20: 0.4012 - val_loss: 3.2832 - val_accuracy20: 0.3773 - 40s/epoch - 64ms/step
Epoch 3/50
617/617 - 39s - loss: 3.2388 - accuracy20: 0.4067 - val_loss: 3.2763 - val_accuracy20: 0.3844 - 39s/epoch - 63ms/step
Epoch 4/50
617/617 - 41s - loss: 3.2319 - accuracy20: 0.4110 - val_loss: 3.2705 - val_accuracy20: 0.3877 - 41s/epoch - 67ms/step
Epoch 5/50
617/617 - 40s - loss: 3.2259 - accuracy20: 0.4126 - val_loss: 3.2673 - val_accuracy20: 0.3900 - 40s/epoch - 66ms/step
Epoch 6/50
617/617 - 39s - loss: 3.2214 - accuracy20: 0.4155 - val_loss: 3.2675 - val_accuracy20: 0.3907 - 39s/epoch - 63ms/step
Epoch 7/50
617/617 - 40s - loss: 3.2178 - accuracy20: 0.4175 - val_loss: 3.2633 - val_accuracy20: 0.3945 - 40s/epoch - 65ms/step
Epoch 8/50
617/617 - 40s - loss: 3.2142 - accuracy20: 0.4186 - val_loss: 3.2622 - val_accuracy20: 0.3952 - 40s/epoch - 65ms/step
Epoch 9/50
617/617 - 40s - loss: 3.2104 - accuracy20: 0.4193 - val_loss: 3.2580 - val_accuracy20: 0.3974 - 40s/epoch - 64ms/step
Epoch 10/50
617/617 - 40s - loss: 3.2071 - accuracy20: 0.4219 - val_loss: 3.2596 - val_accuracy20: 0.3978 - 40s/epoch - 65ms/step
Epoch 11/50
617/617 - 38s - loss: 3.2050 - accuracy20: 0.4221 - val_loss: 3.2571 - val_accuracy20: 0.3975 - 38s/epoch - 62ms/step
Epoch 12/50
617/617 - 41s - loss: 3.2027 - accuracy20: 0.4232 - val_loss: 3.2593 - val_accuracy20: 0.3985 - 41s/epoch - 67ms/step
Epoch 13/50
617/617 - 38s - loss: 3.1995 - accuracy20: 0.4251 - val_loss: 3.2577 - val_accuracy20: 0.3985 - 38s/epoch - 61ms/step
Epoch 14/50
617/617 - 40s - loss: 3.1973 - accuracy20: 0.4261 - val_loss: 3.2572 - val_accuracy20: 0.3983 - 40s/epoch - 65ms/step
Epoch 15/50
617/617 - 41s - loss: 3.1955 - accuracy20: 0.4261 - val_loss: 3.2565 - val_accuracy20: 0.3991 - 41s/epoch - 67ms/step
Epoch 16/50
617/617 - 38s - loss: 3.1930 - accuracy20: 0.4259 - val_loss: 3.2568 - val_accuracy20: 0.3995 - 38s/epoch - 62ms/step
Epoch 17/50
617/617 - 42s - loss: 3.1911 - accuracy20: 0.4277 - val_loss: 3.2567 - val_accuracy20: 0.3974 - 42s/epoch - 68ms/step
Epoch 18/50
617/617 - 39s - loss: 3.1879 - accuracy20: 0.4285 - val_loss: 3.2577 - val_accuracy20: 0.3982 - 39s/epoch - 63ms/step
Epoch 19/50
617/617 - 38s - loss: 3.1868 - accuracy20: 0.4294 - val_loss: 3.2565 - val_accuracy20: 0.4018 - 38s/epoch - 62ms/step
Epoch 20/50
617/617 - 38s - loss: 3.1841 - accuracy20: 0.4308 - val_loss: 3.2558 - val_accuracy20: 0.4003 - 38s/epoch - 61ms/step
Epoch 21/50
617/617 - 37s - loss: 3.1821 - accuracy20: 0.4314 - val_loss: 3.2585 - val_accuracy20: 0.3992 - 37s/epoch - 61ms/step
Epoch 22/50
617/617 - 39s - loss: 3.1813 - accuracy20: 0.4314 - val_loss: 3.2548 - val_accuracy20: 0.4009 - 39s/epoch - 64ms/step
Epoch 23/50
617/617 - 38s - loss: 3.1784 - accuracy20: 0.4324 - val_loss: 3.2566 - val_accuracy20: 0.4007 - 38s/epoch - 61ms/step
Epoch 24/50
617/617 - 37s - loss: 3.1754 - accuracy20: 0.4348 - val_loss: 3.2544 - val_accuracy20: 0.4006 - 37s/epoch - 60ms/step
Epoch 25/50
617/617 - 37s - loss: 3.1730 - accuracy20: 0.4338 - val_loss: 3.2570 - val_accuracy20: 0.3994 - 37s/epoch - 60ms/step
Epoch 26/50
617/617 - 40s - loss: 3.1717 - accuracy20: 0.4354 - val_loss: 3.2571 - val_accuracy20: 0.4014 - 40s/epoch - 65ms/step
Epoch 27/50
617/617 - 39s - loss: 3.1700 - accuracy20: 0.4349 - val_loss: 3.2598 - val_accuracy20: 0.3992 - 39s/epoch - 63ms/step
Epoch 28/50
617/617 - 39s - loss: 3.1673 - accuracy20: 0.4371 - val_loss: 3.2604 - val_accuracy20: 0.4013 - 39s/epoch - 64ms/step
Epoch 29/50
617/617 - 38s - loss: 3.1661 - accuracy20: 0.4378 - val_loss: 3.2620 - val_accuracy20: 0.4012 - 38s/epoch - 61ms/step
Epoch 30/50
617/617 - 39s - loss: 3.1644 - accuracy20: 0.4384 - val_loss: 3.2632 - val_accuracy20: 0.3989 - 39s/epoch - 63ms/step
Epoch 31/50
617/617 - 37s - loss: 3.1619 - accuracy20: 0.4392 - val_loss: 3.2619 - val_accuracy20: 0.3996 - 37s/epoch - 61ms/step
Epoch 32/50
617/617 - 37s - loss: 3.1595 - accuracy20: 0.4408 - val_loss: 3.2657 - val_accuracy20: 0.3975 - 37s/epoch - 60ms/step
Epoch 33/50
617/617 - 37s - loss: 3.1585 - accuracy20: 0.4416 - val_loss: 3.2670 - val_accuracy20: 0.4004 - 37s/epoch - 59ms/step
Epoch 34/50
617/617 - 40s - loss: 3.1552 - accuracy20: 0.4419 - val_loss: 3.2652 - val_accuracy20: 0.3986 - 40s/epoch - 65ms/step
testing model: results/PCAR/W6/deepOF_L1/h20
Evaluating performance on  test set...
1722/1722 - 45s - 45s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1157978
{'0': {'precision': 0.4429040879814222, 'recall': 0.3127637718288593, 'f1-score': 0.3666276163982112, 'support': 161598}, '1': {'precision': 0.26650357685607323, 'recall': 0.5673976518452919, 'f1-score': 0.3626652618128219, 'support': 114047}, '2': {'precision': 0.4784303906138217, 'recall': 0.24296241575789135, 'f1-score': 0.3222671544513025, 'support': 165149}, 'accuracy': 0.35249345499258156, 'macro avg': {'precision': 0.39594601848377237, 'recall': 0.3743746131440142, 'f1-score': 0.35052001088744517, 'support': 440794}, 'weighted avg': {'precision': 0.41057421112539755, 'recall': 0.35249345499258156, 'f1-score': 0.3489822297017727, 'support': 440794}}
[[50542 87271 23785]
 [29379 64710 19958]
 [34194 90830 40125]]
Evaluating performance on  train set...
617/617 - 18s - 18s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0757571
{'0': {'precision': 0.44859758244337516, 'recall': 0.29059049356671796, 'f1-score': 0.35270642783820255, 'support': 52617}, '1': {'precision': 0.38109244184026775, 'recall': 0.6250949703692448, 'f1-score': 0.47350814718895007, 'support': 52648}, '2': {'precision': 0.44808189597718, 'recall': 0.3190160760718963, 'f1-score': 0.3726911904920287, 'support': 52687}, 'accuracy': 0.4115680713128039, 'macro avg': {'precision': 0.42592397342027427, 'recall': 0.4115671800026197, 'f1-score': 0.3996352551730604, 'support': 157952}, 'weighted avg': {'precision': 0.4259249944716063, 'recall': 0.4115680713128039, 'f1-score': 0.3996378127546347, 'support': 157952}}
[[15290 26810 10517]
 [ 9552 32910 10186]
 [ 9242 26637 16808]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0851849
{'0': {'precision': 0.4212408645622765, 'recall': 0.28610656386967315, 'f1-score': 0.3407654328752477, 'support': 18937}, '1': {'precision': 0.3870143794147326, 'recall': 0.6161144578313253, 'f1-score': 0.4754028509451503, 'support': 19920}, '2': {'precision': 0.4165954471292052, 'recall': 0.2884656767807187, 'f1-score': 0.34088814011888485, 'support': 18588}, 'accuracy': 0.40130559665767257, 'macro avg': {'precision': 0.4082835637020714, 'recall': 0.3968955661605724, 'f1-score': 0.3856854746464276, 'support': 57445}, 'weighted avg': {'precision': 0.40786910717024927, 'recall': 0.40130559665767257, 'f1-score': 0.3874928808724135, 'support': 57445}}
[[ 5418  9870  3649]
 [ 3787 12273  3860]
 [ 3657  9569  5362]]
training model: results/PCAR/W6/deepOF_L1/h30
Epoch 1/50
617/617 - 44s - loss: 3.2871 - accuracy30: 0.3802 - val_loss: 3.2964 - val_accuracy30: 0.3671 - 44s/epoch - 71ms/step
Epoch 2/50
617/617 - 42s - loss: 3.2571 - accuracy30: 0.3944 - val_loss: 3.2875 - val_accuracy30: 0.3704 - 42s/epoch - 68ms/step
Epoch 3/50
617/617 - 37s - loss: 3.2445 - accuracy30: 0.4007 - val_loss: 3.2797 - val_accuracy30: 0.3762 - 37s/epoch - 60ms/step
Epoch 4/50
617/617 - 37s - loss: 3.2352 - accuracy30: 0.4046 - val_loss: 3.2781 - val_accuracy30: 0.3770 - 37s/epoch - 60ms/step
Epoch 5/50
617/617 - 36s - loss: 3.2302 - accuracy30: 0.4067 - val_loss: 3.2751 - val_accuracy30: 0.3777 - 36s/epoch - 58ms/step
Epoch 6/50
617/617 - 40s - loss: 3.2252 - accuracy30: 0.4086 - val_loss: 3.2732 - val_accuracy30: 0.3817 - 40s/epoch - 64ms/step
Epoch 7/50
617/617 - 37s - loss: 3.2221 - accuracy30: 0.4100 - val_loss: 3.2715 - val_accuracy30: 0.3835 - 37s/epoch - 60ms/step
Epoch 8/50
617/617 - 38s - loss: 3.2183 - accuracy30: 0.4118 - val_loss: 3.2695 - val_accuracy30: 0.3843 - 38s/epoch - 61ms/step
Epoch 9/50
617/617 - 40s - loss: 3.2153 - accuracy30: 0.4132 - val_loss: 3.2693 - val_accuracy30: 0.3842 - 40s/epoch - 64ms/step
Epoch 10/50
617/617 - 37s - loss: 3.2136 - accuracy30: 0.4128 - val_loss: 3.2682 - val_accuracy30: 0.3863 - 37s/epoch - 59ms/step
Epoch 11/50
617/617 - 42s - loss: 3.2102 - accuracy30: 0.4148 - val_loss: 3.2678 - val_accuracy30: 0.3857 - 42s/epoch - 67ms/step
Epoch 12/50
617/617 - 38s - loss: 3.2091 - accuracy30: 0.4152 - val_loss: 3.2686 - val_accuracy30: 0.3857 - 38s/epoch - 61ms/step
Epoch 13/50
617/617 - 39s - loss: 3.2067 - accuracy30: 0.4166 - val_loss: 3.2667 - val_accuracy30: 0.3855 - 39s/epoch - 64ms/step
Epoch 14/50
617/617 - 35s - loss: 3.2050 - accuracy30: 0.4175 - val_loss: 3.2662 - val_accuracy30: 0.3868 - 35s/epoch - 56ms/step
Epoch 15/50
617/617 - 39s - loss: 3.2037 - accuracy30: 0.4169 - val_loss: 3.2652 - val_accuracy30: 0.3875 - 39s/epoch - 63ms/step
Epoch 16/50
617/617 - 40s - loss: 3.2009 - accuracy30: 0.4195 - val_loss: 3.2649 - val_accuracy30: 0.3874 - 40s/epoch - 65ms/step
Epoch 17/50
617/617 - 38s - loss: 3.1978 - accuracy30: 0.4202 - val_loss: 3.2660 - val_accuracy30: 0.3860 - 38s/epoch - 62ms/step
Epoch 18/50
617/617 - 41s - loss: 3.1969 - accuracy30: 0.4206 - val_loss: 3.2668 - val_accuracy30: 0.3857 - 41s/epoch - 66ms/step
Epoch 19/50
617/617 - 38s - loss: 3.1956 - accuracy30: 0.4199 - val_loss: 3.2656 - val_accuracy30: 0.3888 - 38s/epoch - 62ms/step
Epoch 20/50
617/617 - 41s - loss: 3.1947 - accuracy30: 0.4216 - val_loss: 3.2651 - val_accuracy30: 0.3870 - 41s/epoch - 66ms/step
Epoch 21/50
617/617 - 39s - loss: 3.1931 - accuracy30: 0.4219 - val_loss: 3.2681 - val_accuracy30: 0.3847 - 39s/epoch - 63ms/step
Epoch 22/50
617/617 - 36s - loss: 3.1910 - accuracy30: 0.4230 - val_loss: 3.2656 - val_accuracy30: 0.3878 - 36s/epoch - 58ms/step
Epoch 23/50
617/617 - 40s - loss: 3.1887 - accuracy30: 0.4238 - val_loss: 3.2670 - val_accuracy30: 0.3874 - 40s/epoch - 65ms/step
Epoch 24/50
617/617 - 36s - loss: 3.1868 - accuracy30: 0.4241 - val_loss: 3.2668 - val_accuracy30: 0.3874 - 36s/epoch - 59ms/step
Epoch 25/50
617/617 - 39s - loss: 3.1849 - accuracy30: 0.4251 - val_loss: 3.2679 - val_accuracy30: 0.3880 - 39s/epoch - 63ms/step
Epoch 26/50
617/617 - 34s - loss: 3.1832 - accuracy30: 0.4256 - val_loss: 3.2688 - val_accuracy30: 0.3851 - 34s/epoch - 55ms/step
testing model: results/PCAR/W6/deepOF_L1/h30
Evaluating performance on  test set...
1722/1722 - 45s - 45s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1050992
{'0': {'precision': 0.4316717420032668, 'recall': 0.3327428141193144, 'f1-score': 0.3758056909290991, 'support': 158053}, '1': {'precision': 0.27414926197613304, 'recall': 0.5531424918661542, 'f1-score': 0.36660248384792743, 'support': 122021}, '2': {'precision': 0.4681508967223253, 'recall': 0.21195246391239422, 'f1-score': 0.29179604685525834, 'support': 160720}, 'accuracy': 0.34971211041892586, 'macro avg': {'precision': 0.391323966900575, 'recall': 0.3659459232992876, 'f1-score': 0.344734740544095, 'support': 440794}, 'weighted avg': {'precision': 0.4013670627450559, 'recall': 0.34971211041892586, 'f1-score': 0.3426268941968402, 'support': 440794}}
[[52591 86562 18900]
 [34726 67495 19800]
 [34514 92141 34065]]
Evaluating performance on  train set...
617/617 - 18s - 18s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0820507
{'0': {'precision': 0.4356962814013424, 'recall': 0.2916674566309603, 'f1-score': 0.34942194562427603, 'support': 52745}, '1': {'precision': 0.3659212759980948, 'recall': 0.5731830964360186, 'f1-score': 0.4466806804120637, 'support': 52273}, '2': {'precision': 0.4283646533536137, 'recall': 0.3298636037329505, 'f1-score': 0.37271601775956287, 'support': 52934}, 'accuracy': 0.39763345826580226, 'macro avg': {'precision': 0.409994070251017, 'recall': 0.3982380522666431, 'f1-score': 0.38960621459863426, 'support': 157952}, 'weighted avg': {'precision': 0.41014775237656, 'recall': 0.39763345826580226, 'f1-score': 0.3894154516132556, 'support': 157952}}
[[15384 26059 11302]
 [10312 29962 11999]
 [ 9613 25860 17461]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0886945
{'0': {'precision': 0.4119295141192951, 'recall': 0.29203909884480683, 'f1-score': 0.34177524928121367, 'support': 19131}, '1': {'precision': 0.3620454469840636, 'recall': 0.5579940518921136, 'f1-score': 0.4391533323916947, 'support': 19502}, '2': {'precision': 0.4125858951175407, 'recall': 0.30321071656389537, 'f1-score': 0.34954193093727975, 'support': 18812}, 'accuracy': 0.38598659587431455, 'macro avg': {'precision': 0.39552028540696643, 'recall': 0.3844146224336053, 'f1-score': 0.37682350420339605, 'support': 57445}, 'weighted avg': {'precision': 0.3952093254530528, 'recall': 0.38598659587431455, 'f1-score': 0.3773775504760003, 'support': 57445}}
[[ 5587  9824  3720]
 [ 4219 10882  4401]
 [ 3757  9351  5704]]
training model: results/PCAR/W6/deepOF_L1/h50
Epoch 1/50
617/617 - 40s - loss: 3.2753 - accuracy50: 0.3849 - val_loss: 3.2915 - val_accuracy50: 0.3666 - 40s/epoch - 66ms/step
Epoch 2/50
617/617 - 42s - loss: 3.2473 - accuracy50: 0.3989 - val_loss: 3.2858 - val_accuracy50: 0.3682 - 42s/epoch - 68ms/step
Epoch 3/50
617/617 - 39s - loss: 3.2346 - accuracy50: 0.4018 - val_loss: 3.2826 - val_accuracy50: 0.3722 - 39s/epoch - 63ms/step
Epoch 4/50
617/617 - 40s - loss: 3.2290 - accuracy50: 0.4037 - val_loss: 3.2781 - val_accuracy50: 0.3749 - 40s/epoch - 64ms/step
Epoch 5/50
617/617 - 37s - loss: 3.2253 - accuracy50: 0.4050 - val_loss: 3.2779 - val_accuracy50: 0.3742 - 37s/epoch - 59ms/step
Epoch 6/50
617/617 - 38s - loss: 3.2198 - accuracy50: 0.4074 - val_loss: 3.2784 - val_accuracy50: 0.3752 - 38s/epoch - 62ms/step
Epoch 7/50
617/617 - 38s - loss: 3.2167 - accuracy50: 0.4079 - val_loss: 3.2763 - val_accuracy50: 0.3764 - 38s/epoch - 62ms/step
Epoch 8/50
617/617 - 38s - loss: 3.2134 - accuracy50: 0.4075 - val_loss: 3.2760 - val_accuracy50: 0.3754 - 38s/epoch - 61ms/step
Epoch 9/50
617/617 - 38s - loss: 3.2119 - accuracy50: 0.4090 - val_loss: 3.2738 - val_accuracy50: 0.3786 - 38s/epoch - 62ms/step
Epoch 10/50
617/617 - 40s - loss: 3.2104 - accuracy50: 0.4100 - val_loss: 3.2733 - val_accuracy50: 0.3776 - 40s/epoch - 65ms/step
Epoch 11/50
617/617 - 41s - loss: 3.2078 - accuracy50: 0.4098 - val_loss: 3.2718 - val_accuracy50: 0.3795 - 41s/epoch - 67ms/step
Epoch 12/50
617/617 - 37s - loss: 3.2082 - accuracy50: 0.4105 - val_loss: 3.2713 - val_accuracy50: 0.3794 - 37s/epoch - 60ms/step
Epoch 13/50
617/617 - 38s - loss: 3.2047 - accuracy50: 0.4118 - val_loss: 3.2721 - val_accuracy50: 0.3810 - 38s/epoch - 62ms/step
Epoch 14/50
617/617 - 38s - loss: 3.2043 - accuracy50: 0.4130 - val_loss: 3.2713 - val_accuracy50: 0.3806 - 38s/epoch - 61ms/step
Epoch 15/50
617/617 - 38s - loss: 3.2032 - accuracy50: 0.4132 - val_loss: 3.2717 - val_accuracy50: 0.3811 - 38s/epoch - 62ms/step
Epoch 16/50
617/617 - 35s - loss: 3.2026 - accuracy50: 0.4133 - val_loss: 3.2725 - val_accuracy50: 0.3813 - 35s/epoch - 56ms/step
Epoch 17/50
617/617 - 38s - loss: 3.1993 - accuracy50: 0.4149 - val_loss: 3.2733 - val_accuracy50: 0.3804 - 38s/epoch - 61ms/step
Epoch 18/50
617/617 - 38s - loss: 3.1987 - accuracy50: 0.4141 - val_loss: 3.2731 - val_accuracy50: 0.3796 - 38s/epoch - 61ms/step
Epoch 19/50
617/617 - 41s - loss: 3.1966 - accuracy50: 0.4148 - val_loss: 3.2738 - val_accuracy50: 0.3806 - 41s/epoch - 66ms/step
Epoch 20/50
617/617 - 37s - loss: 3.1949 - accuracy50: 0.4154 - val_loss: 3.2758 - val_accuracy50: 0.3789 - 37s/epoch - 61ms/step
Epoch 21/50
617/617 - 39s - loss: 3.1940 - accuracy50: 0.4154 - val_loss: 3.2751 - val_accuracy50: 0.3787 - 39s/epoch - 63ms/step
Epoch 22/50
617/617 - 38s - loss: 3.1919 - accuracy50: 0.4179 - val_loss: 3.2751 - val_accuracy50: 0.3791 - 38s/epoch - 61ms/step
testing model: results/PCAR/W6/deepOF_L1/h50
Evaluating performance on  test set...
1722/1722 - 43s - 43s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868756
{'0': {'precision': 0.4053566355572858, 'recall': 0.4991319556908726, 'f1-score': 0.44738308966125906, 'support': 154370}, '1': {'precision': 0.290164254441005, 'recall': 0.08029974455343156, 'f1-score': 0.1257888246814478, 'support': 129577}, '2': {'precision': 0.41202589677593515, 'recall': 0.5644035270040231, 'f1-score': 0.47632499327414585, 'support': 156847}, 'accuracy': 0.399236377990626, 'macro avg': {'precision': 0.3691822622580753, 'recall': 0.3812784090827757, 'f1-score': 0.3498323025389509, 'support': 440794}, 'weighted avg': {'precision': 0.37386748290651733, 'recall': 0.399236377990626, 'f1-score': 0.3631447168219769, 'support': 440794}}
[[77051 12821 64498]
 [57342 10405 61830]
 [55689 12633 88525]]
Evaluating performance on  train set...
617/617 - 17s - 17s/epoch - 28ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830691
{'0': {'precision': 0.40134774827422476, 'recall': 0.4186653458556379, 'f1-score': 0.4098236846276492, 'support': 52493}, '1': {'precision': 0.44006512829150524, 'recall': 0.14863276064777942, 'f1-score': 0.22221277198951023, 'support': 52734}, '2': {'precision': 0.3795954698242039, 'recall': 0.6147178757705074, 'f1-score': 0.4693573145654126, 'support': 52725}, 'accuracy': 0.39395512560777957, 'macro avg': {'precision': 0.407002782129978, 'recall': 0.39400532742464156, 'f1-score': 0.36713125706085736, 'support': 157952}, 'weighted avg': {'precision': 0.4070129721178856, 'recall': 0.39395512560777957, 'f1-score': 0.3670602930365896, 'support': 157952}}
[[21977  5124 25392]
 [17316  7838 27580]
 [15465  4849 32411]]
Evaluating performance on  val set...
225/225 - 6s - 6s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905093
{'0': {'precision': 0.38666603532364224, 'recall': 0.43133319247834356, 'f1-score': 0.4077800803974932, 'support': 18932}, '1': {'precision': 0.37513348588863465, 'recall': 0.1269554442666116, 'f1-score': 0.18970837833667645, 'support': 19369}, '2': {'precision': 0.37775015955124114, 'recall': 0.5874425407438362, 'f1-score': 0.45981805172237555, 'support': 19144}, 'accuracy': 0.3807293933327531, 'macro avg': {'precision': 0.3798498935878394, 'recall': 0.38191039249626374, 'f1-score': 0.35243550348551506, 'support': 57445}, 'weighted avg': {'precision': 0.3798062655300395, 'recall': 0.3807293933327531, 'f1-score': 0.3515938870965547, 'support': 57445}}
[[ 8166  2141  8625]
 [ 7010  2459  9900]
 [ 5943  1955 11246]]
training model: results/PCAR/W6/deepOF_L1/h100
Epoch 1/50
617/617 - 43s - loss: 3.3108 - accuracy100: 0.3594 - val_loss: 3.3044 - val_accuracy100: 0.3415 - 43s/epoch - 70ms/step
Epoch 2/50
617/617 - 39s - loss: 3.2791 - accuracy100: 0.3708 - val_loss: 3.2957 - val_accuracy100: 0.3461 - 39s/epoch - 63ms/step
Epoch 3/50
617/617 - 39s - loss: 3.2688 - accuracy100: 0.3735 - val_loss: 3.2946 - val_accuracy100: 0.3463 - 39s/epoch - 63ms/step
Epoch 4/50
617/617 - 39s - loss: 3.2621 - accuracy100: 0.3781 - val_loss: 3.2905 - val_accuracy100: 0.3514 - 39s/epoch - 63ms/step
Epoch 5/50
617/617 - 38s - loss: 3.2574 - accuracy100: 0.3792 - val_loss: 3.2887 - val_accuracy100: 0.3542 - 38s/epoch - 61ms/step
Epoch 6/50
617/617 - 38s - loss: 3.2529 - accuracy100: 0.3817 - val_loss: 3.2861 - val_accuracy100: 0.3577 - 38s/epoch - 61ms/step
Epoch 7/50
617/617 - 38s - loss: 3.2499 - accuracy100: 0.3828 - val_loss: 3.2873 - val_accuracy100: 0.3580 - 38s/epoch - 61ms/step
Epoch 8/50
617/617 - 40s - loss: 3.2480 - accuracy100: 0.3828 - val_loss: 3.2851 - val_accuracy100: 0.3609 - 40s/epoch - 65ms/step
Epoch 9/50
617/617 - 41s - loss: 3.2441 - accuracy100: 0.3865 - val_loss: 3.2857 - val_accuracy100: 0.3604 - 41s/epoch - 67ms/step
Epoch 10/50
617/617 - 44s - loss: 3.2428 - accuracy100: 0.3870 - val_loss: 3.2852 - val_accuracy100: 0.3607 - 44s/epoch - 71ms/step
Epoch 11/50
617/617 - 43s - loss: 3.2414 - accuracy100: 0.3878 - val_loss: 3.2852 - val_accuracy100: 0.3592 - 43s/epoch - 70ms/step
Epoch 12/50
617/617 - 42s - loss: 3.2392 - accuracy100: 0.3895 - val_loss: 3.2853 - val_accuracy100: 0.3603 - 42s/epoch - 68ms/step
Epoch 13/50
617/617 - 44s - loss: 3.2377 - accuracy100: 0.3902 - val_loss: 3.2852 - val_accuracy100: 0.3618 - 44s/epoch - 71ms/step
Epoch 14/50
617/617 - 44s - loss: 3.2368 - accuracy100: 0.3903 - val_loss: 3.2852 - val_accuracy100: 0.3605 - 44s/epoch - 71ms/step
Epoch 15/50
617/617 - 43s - loss: 3.2348 - accuracy100: 0.3915 - val_loss: 3.2838 - val_accuracy100: 0.3640 - 43s/epoch - 69ms/step
Epoch 16/50
617/617 - 41s - loss: 3.2332 - accuracy100: 0.3931 - val_loss: 3.2861 - val_accuracy100: 0.3613 - 41s/epoch - 66ms/step
Epoch 17/50
617/617 - 36s - loss: 3.2316 - accuracy100: 0.3944 - val_loss: 3.2861 - val_accuracy100: 0.3603 - 36s/epoch - 59ms/step
Epoch 18/50
617/617 - 41s - loss: 3.2309 - accuracy100: 0.3947 - val_loss: 3.2874 - val_accuracy100: 0.3606 - 41s/epoch - 67ms/step
Epoch 19/50
617/617 - 43s - loss: 3.2298 - accuracy100: 0.3958 - val_loss: 3.2855 - val_accuracy100: 0.3635 - 43s/epoch - 70ms/step
Epoch 20/50
617/617 - 41s - loss: 3.2289 - accuracy100: 0.3955 - val_loss: 3.2852 - val_accuracy100: 0.3656 - 41s/epoch - 67ms/step
Epoch 21/50
617/617 - 40s - loss: 3.2280 - accuracy100: 0.3961 - val_loss: 3.2872 - val_accuracy100: 0.3598 - 40s/epoch - 64ms/step
Epoch 22/50
617/617 - 39s - loss: 3.2249 - accuracy100: 0.3979 - val_loss: 3.2877 - val_accuracy100: 0.3646 - 39s/epoch - 63ms/step
Epoch 23/50
617/617 - 41s - loss: 3.2241 - accuracy100: 0.3989 - val_loss: 3.2872 - val_accuracy100: 0.3645 - 41s/epoch - 67ms/step
Epoch 24/50
617/617 - 39s - loss: 3.2228 - accuracy100: 0.3997 - val_loss: 3.2872 - val_accuracy100: 0.3631 - 39s/epoch - 63ms/step
Epoch 25/50
617/617 - 40s - loss: 3.2207 - accuracy100: 0.4009 - val_loss: 3.2883 - val_accuracy100: 0.3639 - 40s/epoch - 65ms/step
testing model: results/PCAR/W6/deepOF_L1/h100
Evaluating performance on  test set...
1722/1722 - 49s - 49s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965254
{'0': {'precision': 0.40662448043687865, 'recall': 0.31575834602171915, 'f1-score': 0.3554765387326063, 'support': 158938}, '1': {'precision': 0.2741498935220169, 'recall': 0.3291272865225065, 'f1-score': 0.2991335112283753, 'support': 121254}, '2': {'precision': 0.4059067653067758, 'recall': 0.4342162613167956, 'f1-score': 0.41958454295212166, 'support': 160602}, 'accuracy': 0.36259567961451383, 'macro avg': {'precision': 0.36222704642189046, 'recall': 0.3597006312870071, 'f1-score': 0.3580648643043678, 'support': 440794}, 'weighted avg': {'precision': 0.3699217575161959, 'recall': 0.36259567961451383, 'f1-score': 0.3633352124819418, 'support': 440794}}
[[50186 53485 55267]
 [34546 39908 46800]
 [38689 52177 69736]]
Evaluating performance on  train set...
617/617 - 20s - 20s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0868917
{'0': {'precision': 0.4033393683363508, 'recall': 0.26363738823352617, 'f1-score': 0.3188577010893642, 'support': 53236}, '1': {'precision': 0.36275784448799797, 'recall': 0.3612297346911171, 'f1-score': 0.3619921769102668, 'support': 51751}, '2': {'precision': 0.3781798888609645, 'recall': 0.5113943170017936, 'f1-score': 0.4348126208994518, 'support': 52965}, 'accuracy': 0.378690994732577, 'macro avg': {'precision': 0.3814257005617711, 'recall': 0.37875381330881225, 'f1-score': 0.37188749963302764, 'support': 157952}, 'weighted avg': {'precision': 0.38160677697258244, 'recall': 0.378690994732577, 'f1-score': 0.37187257007455476, 'support': 157952}}
[[14035 17035 22166]
 [10687 18694 22370]
 [10075 15804 27086]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0954015
{'0': {'precision': 0.37942313410645256, 'recall': 0.26718316494791394, 'f1-score': 0.3135616648748272, 'support': 19103}, '1': {'precision': 0.3307639147307426, 'recall': 0.32854578096947934, 'f1-score': 0.3296511165858698, 'support': 18938}, '2': {'precision': 0.3721705980462235, 'recall': 0.48299319727891155, 'f1-score': 0.42040102274256497, 'support': 19404}, 'accuracy': 0.36030986160675427, 'macro avg': {'precision': 0.3607858822944729, 'recall': 0.35957404773210166, 'f1-score': 0.35453793473442063, 'support': 57445}, 'weighted avg': {'precision': 0.360931768343551, 'recall': 0.36030986160675427, 'f1-score': 0.35495452650889997, 'support': 57445}}
[[5104 6567 7432]
 [4338 6222 8378]
 [4010 6022 9372]]
training model: results/PCAR/W6/deepOF_L1/h200
Epoch 1/50
617/617 - 47s - loss: 3.3194 - accuracy200: 0.3535 - val_loss: 3.3044 - val_accuracy200: 0.3422 - 47s/epoch - 76ms/step
Epoch 2/50
617/617 - 41s - loss: 3.2929 - accuracy200: 0.3595 - val_loss: 3.3006 - val_accuracy200: 0.3407 - 41s/epoch - 67ms/step
Epoch 3/50
617/617 - 40s - loss: 3.2827 - accuracy200: 0.3601 - val_loss: 3.2990 - val_accuracy200: 0.3423 - 40s/epoch - 65ms/step
Epoch 4/50
617/617 - 37s - loss: 3.2749 - accuracy200: 0.3651 - val_loss: 3.2967 - val_accuracy200: 0.3448 - 37s/epoch - 60ms/step
Epoch 5/50
617/617 - 38s - loss: 3.2703 - accuracy200: 0.3658 - val_loss: 3.2969 - val_accuracy200: 0.3425 - 38s/epoch - 61ms/step
Epoch 6/50
617/617 - 39s - loss: 3.2655 - accuracy200: 0.3673 - val_loss: 3.2959 - val_accuracy200: 0.3423 - 39s/epoch - 64ms/step
Epoch 7/50
617/617 - 38s - loss: 3.2637 - accuracy200: 0.3670 - val_loss: 3.2955 - val_accuracy200: 0.3436 - 38s/epoch - 61ms/step
Epoch 8/50
617/617 - 39s - loss: 3.2607 - accuracy200: 0.3688 - val_loss: 3.2954 - val_accuracy200: 0.3461 - 39s/epoch - 63ms/step
Epoch 9/50
617/617 - 35s - loss: 3.2581 - accuracy200: 0.3705 - val_loss: 3.2943 - val_accuracy200: 0.3489 - 35s/epoch - 57ms/step
Epoch 10/50
617/617 - 37s - loss: 3.2564 - accuracy200: 0.3718 - val_loss: 3.2946 - val_accuracy200: 0.3467 - 37s/epoch - 60ms/step
Epoch 11/50
617/617 - 37s - loss: 3.2537 - accuracy200: 0.3734 - val_loss: 3.2935 - val_accuracy200: 0.3495 - 37s/epoch - 60ms/step
Epoch 12/50
617/617 - 40s - loss: 3.2524 - accuracy200: 0.3749 - val_loss: 3.2948 - val_accuracy200: 0.3474 - 40s/epoch - 64ms/step
Epoch 13/50
617/617 - 36s - loss: 3.2506 - accuracy200: 0.3763 - val_loss: 3.2956 - val_accuracy200: 0.3450 - 36s/epoch - 58ms/step
Epoch 14/50
617/617 - 38s - loss: 3.2505 - accuracy200: 0.3761 - val_loss: 3.2938 - val_accuracy200: 0.3482 - 38s/epoch - 61ms/step
Epoch 15/50
617/617 - 33s - loss: 3.2478 - accuracy200: 0.3784 - val_loss: 3.2963 - val_accuracy200: 0.3457 - 33s/epoch - 54ms/step
Epoch 16/50
617/617 - 37s - loss: 3.2474 - accuracy200: 0.3789 - val_loss: 3.2952 - val_accuracy200: 0.3470 - 37s/epoch - 60ms/step
Epoch 17/50
617/617 - 36s - loss: 3.2457 - accuracy200: 0.3809 - val_loss: 3.2946 - val_accuracy200: 0.3500 - 36s/epoch - 59ms/step
Epoch 18/50
617/617 - 36s - loss: 3.2448 - accuracy200: 0.3806 - val_loss: 3.2968 - val_accuracy200: 0.3501 - 36s/epoch - 58ms/step
Epoch 19/50
617/617 - 39s - loss: 3.2441 - accuracy200: 0.3797 - val_loss: 3.2961 - val_accuracy200: 0.3474 - 39s/epoch - 64ms/step
Epoch 20/50
617/617 - 42s - loss: 3.2431 - accuracy200: 0.3812 - val_loss: 3.2960 - val_accuracy200: 0.3493 - 42s/epoch - 67ms/step
Epoch 21/50
617/617 - 37s - loss: 3.2410 - accuracy200: 0.3834 - val_loss: 3.2980 - val_accuracy200: 0.3462 - 37s/epoch - 60ms/step
testing model: results/PCAR/W6/deepOF_L1/h200
Evaluating performance on  test set...
1722/1722 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990113
{'0': {'precision': 0.3843340541915787, 'recall': 0.15818580450930986, 'f1-score': 0.22412522081017047, 'support': 152795}, '1': {'precision': 0.2922749935442862, 'recall': 0.3458320275775619, 'f1-score': 0.3168059597587102, 'support': 127640}, '2': {'precision': 0.3795360481670685, 'recall': 0.536970173173941, 'f1-score': 0.44473137828094494, 'support': 160359}, 'accuracy': 0.35032237280906725, 'macro avg': {'precision': 0.3520483653009778, 'recall': 0.34699600175360423, 'f1-score': 0.3285541862832752, 'support': 440794}, 'weighted avg': {'precision': 0.35593116769787675, 'recall': 0.35032237280906725, 'f1-score': 0.3312182219064819, 'support': 440794}}
[[24170 53090 75535]
 [18264 44142 65234]
 [20454 53797 86108]]
Evaluating performance on  train set...
617/617 - 16s - 16s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924593
{'0': {'precision': 0.3913155454826414, 'recall': 0.14279269965979363, 'f1-score': 0.20923475219301266, 'support': 53203}, '1': {'precision': 0.3567780698460383, 'recall': 0.3644139306535747, 'f1-score': 0.3605555766384577, 'support': 52144}, '2': {'precision': 0.3541593376955369, 'recall': 0.5741279346069765, 'f1-score': 0.438081561903933, 'support': 52605}, 'accuracy': 0.35960924837925445, 'macro avg': {'precision': 0.3674176510080722, 'recall': 0.36044485497344825, 'f1-score': 0.33595729691180115, 'support': 157952}, 'weighted avg': {'precision': 0.36753918025627097, 'recall': 0.35960924837925445, 'f1-score': 0.3354057376488869, 'support': 157952}}
[[ 7597 17761 27845]
 [ 5911 19002 27231]
 [ 5906 16497 30202]]
Evaluating performance on  val set...
225/225 - 6s - 6s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098116
{'0': {'precision': 0.36184122748499, 'recall': 0.1424968474148802, 'f1-score': 0.20447091642477477, 'support': 19032}, '1': {'precision': 0.3330748953326097, 'recall': 0.3390151515151515, 'f1-score': 0.33601877199843566, 'support': 19008}, '2': {'precision': 0.3514034571774009, 'recall': 0.5541870651893842, 'f1-score': 0.43009118541033436, 'support': 19405}, 'accuracy': 0.34659239272347464, 'macro avg': {'precision': 0.3487731933316669, 'recall': 0.34523302137313866, 'f1-score': 0.32352695794451497, 'support': 57445}, 'weighted avg': {'precision': 0.34879683068159173, 'recall': 0.34659239272347464, 'f1-score': 0.3242136783432869, 'support': 57445}}
[[ 2712  6536  9784]
 [ 2499  6444 10065]
 [ 2284  6367 10754]]
training model: results/PCAR/W6/deepOF_L1/h300
Epoch 1/50
617/617 - 44s - loss: 3.3216 - accuracy300: 0.3513 - val_loss: 3.3039 - val_accuracy300: 0.3442 - 44s/epoch - 71ms/step
Epoch 2/50
617/617 - 36s - loss: 3.2964 - accuracy300: 0.3555 - val_loss: 3.2986 - val_accuracy300: 0.3447 - 36s/epoch - 58ms/step
Epoch 3/50
617/617 - 39s - loss: 3.2849 - accuracy300: 0.3593 - val_loss: 3.2997 - val_accuracy300: 0.3448 - 39s/epoch - 63ms/step
Epoch 4/50
617/617 - 38s - loss: 3.2765 - accuracy300: 0.3623 - val_loss: 3.2976 - val_accuracy300: 0.3456 - 38s/epoch - 62ms/step
Epoch 5/50
617/617 - 35s - loss: 3.2703 - accuracy300: 0.3642 - val_loss: 3.2984 - val_accuracy300: 0.3468 - 35s/epoch - 57ms/step
Epoch 6/50
617/617 - 40s - loss: 3.2675 - accuracy300: 0.3653 - val_loss: 3.2978 - val_accuracy300: 0.3453 - 40s/epoch - 65ms/step
Epoch 7/50
617/617 - 41s - loss: 3.2654 - accuracy300: 0.3650 - val_loss: 3.2975 - val_accuracy300: 0.3447 - 41s/epoch - 66ms/step
Epoch 8/50
617/617 - 37s - loss: 3.2621 - accuracy300: 0.3665 - val_loss: 3.2967 - val_accuracy300: 0.3481 - 37s/epoch - 59ms/step
Epoch 9/50
617/617 - 36s - loss: 3.2603 - accuracy300: 0.3693 - val_loss: 3.2960 - val_accuracy300: 0.3485 - 36s/epoch - 58ms/step
Epoch 10/50
617/617 - 41s - loss: 3.2590 - accuracy300: 0.3688 - val_loss: 3.2969 - val_accuracy300: 0.3472 - 41s/epoch - 67ms/step
Epoch 11/50
617/617 - 39s - loss: 3.2568 - accuracy300: 0.3714 - val_loss: 3.2968 - val_accuracy300: 0.3459 - 39s/epoch - 63ms/step
Epoch 12/50
617/617 - 41s - loss: 3.2563 - accuracy300: 0.3703 - val_loss: 3.2967 - val_accuracy300: 0.3476 - 41s/epoch - 67ms/step
Epoch 13/50
617/617 - 40s - loss: 3.2543 - accuracy300: 0.3732 - val_loss: 3.2973 - val_accuracy300: 0.3483 - 40s/epoch - 64ms/step
Epoch 14/50
617/617 - 37s - loss: 3.2535 - accuracy300: 0.3736 - val_loss: 3.2970 - val_accuracy300: 0.3477 - 37s/epoch - 61ms/step
Epoch 15/50
617/617 - 38s - loss: 3.2521 - accuracy300: 0.3742 - val_loss: 3.2972 - val_accuracy300: 0.3457 - 38s/epoch - 62ms/step
Epoch 16/50
617/617 - 38s - loss: 3.2508 - accuracy300: 0.3757 - val_loss: 3.2973 - val_accuracy300: 0.3468 - 38s/epoch - 62ms/step
Epoch 17/50
617/617 - 40s - loss: 3.2502 - accuracy300: 0.3769 - val_loss: 3.2968 - val_accuracy300: 0.3468 - 40s/epoch - 65ms/step
Epoch 18/50
617/617 - 39s - loss: 3.2490 - accuracy300: 0.3762 - val_loss: 3.2962 - val_accuracy300: 0.3480 - 39s/epoch - 64ms/step
Epoch 19/50
617/617 - 39s - loss: 3.2482 - accuracy300: 0.3768 - val_loss: 3.2981 - val_accuracy300: 0.3450 - 39s/epoch - 63ms/step
testing model: results/PCAR/W6/deepOF_L1/h300
Evaluating performance on  test set...
1722/1722 - 47s - 47s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097568
{'0': {'precision': 0.3554366141342056, 'recall': 0.09837527175963075, 'f1-score': 0.15409985765315715, 'support': 145809}, '1': {'precision': 0.3096675062174278, 'recall': 0.1443636229368977, 'f1-score': 0.19692360383592553, 'support': 135415}, '2': {'precision': 0.3674079256705276, 'recall': 0.7766497461928934, 'f1-score': 0.498833720080744, 'support': 159570}, 'accuracy': 0.3580425323393694, 'macro avg': {'precision': 0.34417068200738693, 'recall': 0.3397962136298072, 'f1-score': 0.2832857271899422, 'support': 440794}, 'weighted avg': {'precision': 0.3457097086711104, 'recall': 0.3580425323393694, 'f1-score': 0.292051281712717, 'support': 440794}}
[[ 14344  21521 109944]
 [ 12431  19549 103435]
 [ 13581  22059 123930]]
Evaluating performance on  train set...
617/617 - 19s - 19s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947353
{'0': {'precision': 0.38842187364589653, 'recall': 0.08295698526689864, 'f1-score': 0.13671511583571003, 'support': 54028}, '1': {'precision': 0.374620382116634, 'recall': 0.19079037531569984, 'f1-score': 0.25282137761058504, 'support': 51077}, '2': {'precision': 0.3447425249169435, 'recall': 0.7854182829678128, 'f1-score': 0.47916558439684387, 'support': 52847}, 'accuracy': 0.3528540316045381, 'macro avg': {'precision': 0.3692615935598247, 'recall': 0.3530552145168038, 'f1-score': 0.2895673592810463, 'support': 157952}, 'weighted avg': {'precision': 0.3693448038707805, 'recall': 0.3528540316045381, 'f1-score': 0.28883626304958215, 'support': 157952}}
[[ 4482  8478 41068]
 [ 3507  9745 37825]
 [ 3550  7790 41507]]
Evaluating performance on  val set...
225/225 - 6s - 6s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996116
{'0': {'precision': 0.3484573502722323, 'recall': 0.08003751758636861, 'f1-score': 0.13017500741556845, 'support': 19191}, '1': {'precision': 0.3231357552581262, 'recall': 0.15602259150646247, 'f1-score': 0.21043764878227433, 'support': 18414}, '2': {'precision': 0.35076790649209444, 'recall': 0.7804939516129032, 'f1-score': 0.4840121276529242, 'support': 19840}, 'accuracy': 0.3463138654365045, 'macro avg': {'precision': 0.3407870040074843, 'recall': 0.33885135356857815, 'f1-score': 0.27487492795025564, 'support': 57445}, 'weighted avg': {'precision': 0.34113851634085995, 'recall': 0.3463138654365045, 'f1-score': 0.2781092879210199, 'support': 57445}}
[[ 1536  3102 14553]
 [ 1433  2873 14108]
 [ 1439  2916 15485]]
training model: results/PCAR/W6/deepOF_L1/h500
Epoch 1/50
617/617 - 41s - loss: 3.3299 - accuracy500: 0.3487 - val_loss: 3.3123 - val_accuracy500: 0.3320 - 41s/epoch - 67ms/step
Epoch 2/50
617/617 - 39s - loss: 3.3061 - accuracy500: 0.3503 - val_loss: 3.3103 - val_accuracy500: 0.3334 - 39s/epoch - 63ms/step
Epoch 3/50
617/617 - 37s - loss: 3.2946 - accuracy500: 0.3502 - val_loss: 3.3109 - val_accuracy500: 0.3370 - 37s/epoch - 60ms/step
Epoch 4/50
617/617 - 39s - loss: 3.2880 - accuracy500: 0.3544 - val_loss: 3.3088 - val_accuracy500: 0.3372 - 39s/epoch - 63ms/step
Epoch 5/50
617/617 - 37s - loss: 3.2833 - accuracy500: 0.3567 - val_loss: 3.3075 - val_accuracy500: 0.3371 - 37s/epoch - 60ms/step
Epoch 6/50
617/617 - 39s - loss: 3.2810 - accuracy500: 0.3562 - val_loss: 3.3063 - val_accuracy500: 0.3389 - 39s/epoch - 64ms/step
Epoch 7/50
617/617 - 37s - loss: 3.2778 - accuracy500: 0.3579 - val_loss: 3.3057 - val_accuracy500: 0.3400 - 37s/epoch - 60ms/step
Epoch 8/50
617/617 - 39s - loss: 3.2759 - accuracy500: 0.3599 - val_loss: 3.3041 - val_accuracy500: 0.3400 - 39s/epoch - 62ms/step
Epoch 9/50
617/617 - 38s - loss: 3.2741 - accuracy500: 0.3617 - val_loss: 3.3030 - val_accuracy500: 0.3411 - 38s/epoch - 62ms/step
Epoch 10/50
617/617 - 38s - loss: 3.2717 - accuracy500: 0.3629 - val_loss: 3.3022 - val_accuracy500: 0.3404 - 38s/epoch - 62ms/step
Epoch 11/50
617/617 - 38s - loss: 3.2707 - accuracy500: 0.3645 - val_loss: 3.3033 - val_accuracy500: 0.3395 - 38s/epoch - 62ms/step
Epoch 12/50
617/617 - 40s - loss: 3.2689 - accuracy500: 0.3656 - val_loss: 3.3032 - val_accuracy500: 0.3427 - 40s/epoch - 64ms/step
Epoch 13/50
617/617 - 39s - loss: 3.2674 - accuracy500: 0.3669 - val_loss: 3.3018 - val_accuracy500: 0.3414 - 39s/epoch - 63ms/step
Epoch 14/50
617/617 - 37s - loss: 3.2667 - accuracy500: 0.3690 - val_loss: 3.3031 - val_accuracy500: 0.3398 - 37s/epoch - 60ms/step
Epoch 15/50
617/617 - 39s - loss: 3.2653 - accuracy500: 0.3702 - val_loss: 3.3033 - val_accuracy500: 0.3405 - 39s/epoch - 63ms/step
Epoch 16/50
617/617 - 38s - loss: 3.2646 - accuracy500: 0.3697 - val_loss: 3.3031 - val_accuracy500: 0.3419 - 38s/epoch - 62ms/step
Epoch 17/50
617/617 - 36s - loss: 3.2636 - accuracy500: 0.3712 - val_loss: 3.3040 - val_accuracy500: 0.3416 - 36s/epoch - 58ms/step
Epoch 18/50
617/617 - 38s - loss: 3.2625 - accuracy500: 0.3715 - val_loss: 3.3043 - val_accuracy500: 0.3389 - 38s/epoch - 61ms/step
Epoch 19/50
617/617 - 40s - loss: 3.2610 - accuracy500: 0.3742 - val_loss: 3.3049 - val_accuracy500: 0.3417 - 40s/epoch - 65ms/step
Epoch 20/50
617/617 - 36s - loss: 3.2602 - accuracy500: 0.3749 - val_loss: 3.3038 - val_accuracy500: 0.3415 - 36s/epoch - 59ms/step
Epoch 21/50
617/617 - 37s - loss: 3.2587 - accuracy500: 0.3755 - val_loss: 3.3029 - val_accuracy500: 0.3457 - 37s/epoch - 60ms/step
Epoch 22/50
617/617 - 36s - loss: 3.2573 - accuracy500: 0.3758 - val_loss: 3.3047 - val_accuracy500: 0.3425 - 36s/epoch - 58ms/step
Epoch 23/50
617/617 - 37s - loss: 3.2557 - accuracy500: 0.3777 - val_loss: 3.3054 - val_accuracy500: 0.3421 - 37s/epoch - 60ms/step
testing model: results/PCAR/W6/deepOF_L1/h500
Evaluating performance on  test set...
1722/1722 - 40s - 40s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012934
{'0': {'precision': 0.3600335852225021, 'recall': 0.028742450749730204, 'f1-score': 0.053235007479965485, 'support': 149187}, '1': {'precision': 0.29645755613978575, 'recall': 0.4409598516171413, 'f1-score': 0.3545505668596071, 'support': 129395}, '2': {'precision': 0.3741466385808187, 'recall': 0.5453049096244421, 'f1-score': 0.4437949978676969, 'support': 162212}, 'accuracy': 0.3398435550393154, 'macro avg': {'precision': 0.34354592664770217, 'recall': 0.33833573733043787, 'f1-score': 0.2838601907357565, 'support': 440794}, 'weighted avg': {'precision': 0.3465644507247575, 'recall': 0.3398435550393154, 'f1-score': 0.28541204248203766, 'support': 440794}}
[[ 4288 65914 78985]
 [ 3359 57058 68978]
 [ 4263 69494 88455]]
Evaluating performance on  train set...
617/617 - 19s - 19s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997089
{'0': {'precision': 0.37100875953659224, 'recall': 0.024221070301979376, 'f1-score': 0.04547343630948258, 'support': 54209}, '1': {'precision': 0.34540888349036475, 'recall': 0.4103229077295063, 'f1-score': 0.37507798156961303, 'support': 51284}, '2': {'precision': 0.3479158421666257, 'recall': 0.620046131264416, 'f1-score': 0.44572798903734157, 'support': 52459}, 'accuracy': 0.34746631888168555, 'macro avg': {'precision': 0.3547778283978609, 'recall': 0.3515300364319673, 'f1-score': 0.2887598023054791, 'support': 157952}, 'weighted avg': {'precision': 0.35502735128936647, 'recall': 0.34746631888168555, 'f1-score': 0.28542223772175523, 'support': 157952}}
[[ 1313 20920 31976]
 [ 1253 21043 28988]
 [  973 18959 32527]]
Evaluating performance on  val set...
225/225 - 6s - 6s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021094
{'0': {'precision': 0.3663522012578616, 'recall': 0.024083931986149155, 'f1-score': 0.045196644197662575, 'support': 19349}, '1': {'precision': 0.32450980392156864, 'recall': 0.4011900170789488, 'f1-score': 0.3587987484910448, 'support': 18151}, '2': {'precision': 0.35517149378946433, 'recall': 0.600701930308348, 'f1-score': 0.4464026230485488, 'support': 19945}, 'accuracy': 0.34344155278962485, 'macro avg': {'precision': 0.34867783298963156, 'recall': 0.34199195979114866, 'f1-score': 0.28346600524575205, 'support': 57445}, 'weighted avg': {'precision': 0.34924922337452563, 'recall': 0.34344155278962485, 'f1-score': 0.28358545163451704, 'support': 57445}}
[[  466  7579 11304]
 [  421  7282 10448]
 [  385  7579 11981]]
training model: results/PCAR/W6/deepOF_L1/h1000
Epoch 1/50
617/617 - 41s - loss: 3.3282 - accuracy1000: 0.3543 - val_loss: 3.3125 - val_accuracy1000: 0.3449 - 41s/epoch - 66ms/step
Epoch 2/50
617/617 - 35s - loss: 3.3024 - accuracy1000: 0.3580 - val_loss: 3.3179 - val_accuracy1000: 0.3459 - 35s/epoch - 56ms/step
Epoch 3/50
617/617 - 36s - loss: 3.2918 - accuracy1000: 0.3601 - val_loss: 3.3191 - val_accuracy1000: 0.3450 - 36s/epoch - 59ms/step
Epoch 4/50
617/617 - 37s - loss: 3.2849 - accuracy1000: 0.3634 - val_loss: 3.3142 - val_accuracy1000: 0.3488 - 37s/epoch - 59ms/step
Epoch 5/50
617/617 - 34s - loss: 3.2812 - accuracy1000: 0.3636 - val_loss: 3.3128 - val_accuracy1000: 0.3498 - 34s/epoch - 55ms/step
Epoch 6/50
617/617 - 37s - loss: 3.2790 - accuracy1000: 0.3658 - val_loss: 3.3110 - val_accuracy1000: 0.3463 - 37s/epoch - 61ms/step
Epoch 7/50
617/617 - 37s - loss: 3.2772 - accuracy1000: 0.3649 - val_loss: 3.3097 - val_accuracy1000: 0.3481 - 37s/epoch - 60ms/step
Epoch 8/50
617/617 - 39s - loss: 3.2751 - accuracy1000: 0.3679 - val_loss: 3.3078 - val_accuracy1000: 0.3473 - 39s/epoch - 63ms/step
Epoch 9/50
617/617 - 36s - loss: 3.2739 - accuracy1000: 0.3678 - val_loss: 3.3076 - val_accuracy1000: 0.3451 - 36s/epoch - 59ms/step
Epoch 10/50
617/617 - 38s - loss: 3.2712 - accuracy1000: 0.3703 - val_loss: 3.3082 - val_accuracy1000: 0.3445 - 38s/epoch - 62ms/step
Epoch 11/50
617/617 - 34s - loss: 3.2697 - accuracy1000: 0.3710 - val_loss: 3.3074 - val_accuracy1000: 0.3431 - 34s/epoch - 55ms/step
Epoch 12/50
617/617 - 35s - loss: 3.2682 - accuracy1000: 0.3714 - val_loss: 3.3079 - val_accuracy1000: 0.3453 - 35s/epoch - 57ms/step
Epoch 13/50
617/617 - 38s - loss: 3.2669 - accuracy1000: 0.3740 - val_loss: 3.3062 - val_accuracy1000: 0.3471 - 38s/epoch - 61ms/step
Epoch 14/50
617/617 - 40s - loss: 3.2667 - accuracy1000: 0.3741 - val_loss: 3.3077 - val_accuracy1000: 0.3438 - 40s/epoch - 64ms/step
Epoch 15/50
617/617 - 34s - loss: 3.2645 - accuracy1000: 0.3753 - val_loss: 3.3078 - val_accuracy1000: 0.3430 - 34s/epoch - 55ms/step
Epoch 16/50
617/617 - 35s - loss: 3.2635 - accuracy1000: 0.3767 - val_loss: 3.3073 - val_accuracy1000: 0.3407 - 35s/epoch - 57ms/step
Epoch 17/50
617/617 - 34s - loss: 3.2623 - accuracy1000: 0.3779 - val_loss: 3.3086 - val_accuracy1000: 0.3434 - 34s/epoch - 55ms/step
Epoch 18/50
617/617 - 39s - loss: 3.2620 - accuracy1000: 0.3774 - val_loss: 3.3083 - val_accuracy1000: 0.3425 - 39s/epoch - 64ms/step
Epoch 19/50
617/617 - 39s - loss: 3.2597 - accuracy1000: 0.3786 - val_loss: 3.3088 - val_accuracy1000: 0.3434 - 39s/epoch - 63ms/step
Epoch 20/50
617/617 - 37s - loss: 3.2589 - accuracy1000: 0.3803 - val_loss: 3.3092 - val_accuracy1000: 0.3426 - 37s/epoch - 60ms/step
Epoch 21/50
617/617 - 38s - loss: 3.2579 - accuracy1000: 0.3819 - val_loss: 3.3104 - val_accuracy1000: 0.3410 - 38s/epoch - 61ms/step
Epoch 22/50
617/617 - 36s - loss: 3.2565 - accuracy1000: 0.3819 - val_loss: 3.3109 - val_accuracy1000: 0.3424 - 36s/epoch - 59ms/step
Epoch 23/50
617/617 - 37s - loss: 3.2567 - accuracy1000: 0.3823 - val_loss: 3.3106 - val_accuracy1000: 0.3422 - 37s/epoch - 60ms/step
testing model: results/PCAR/W6/deepOF_L1/h1000
Evaluating performance on  test set...
1722/1722 - 44s - 44s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993701
{'0': {'precision': 0.30351170568561875, 'recall': 0.0025336246187348628, 'f1-score': 0.005025299545231157, 'support': 143273}, '1': {'precision': 0.30031621916863105, 'recall': 0.19943644333124608, 'f1-score': 0.23969456541191908, 'support': 130954}, '2': {'precision': 0.3797716039054768, 'recall': 0.8040007924738994, 'f1-score': 0.5158705701078582, 'support': 166567}, 'accuracy': 0.3638888006642559, 'macro avg': {'precision': 0.32786650958657554, 'recall': 0.33532362014129347, 'f1-score': 0.2535301450216695, 'support': 440794}, 'weighted avg': {'precision': 0.33137941877935756, 'recall': 0.3638888006642559, 'f1-score': 0.2677803352855347, 'support': 440794}}
[[   363  28630 114280]
 [   404  26117 104433]
 [   429  32218 133920]]
Evaluating performance on  train set...
617/617 - 16s - 16s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031759
{'0': {'precision': 0.39944521497919555, 'recall': 0.005268356931182087, 'f1-score': 0.010399552241500713, 'support': 54666}, '1': {'precision': 0.3542751026600058, 'recall': 0.26702809265648103, 'f1-score': 0.3045257312439578, 'support': 50725}, '2': {'precision': 0.34087967865006136, 'recall': 0.7717509179810126, 'f1-score': 0.4728868785665573, 'support': 52561}, 'accuracy': 0.3443894347649919, 'macro avg': {'precision': 0.36486666542975427, 'recall': 0.34801578918955856, 'f1-score': 0.2626040540173386, 'support': 157952}, 'weighted avg': {'precision': 0.36545060204370555, 'recall': 0.3443894347649919, 'f1-score': 0.2587556780827116, 'support': 157952}}
[[  288 12883 41495]
 [  241 13545 36939]
 [  192 11805 40564]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050137
{'0': {'precision': 0.3602693602693603, 'recall': 0.005424313089323735, 'f1-score': 0.01068770913449533, 'support': 19726}, '1': {'precision': 0.31912192936608674, 'recall': 0.24321402151027144, 'f1-score': 0.27604469418071437, 'support': 17573}, '2': {'precision': 0.3540395383384756, 'recall': 0.7689367616400278, 'f1-score': 0.4848437426644341, 'support': 20146}, 'accuracy': 0.34593089041692054, 'macro avg': {'precision': 0.3444769426579742, 'recall': 0.3391916987465409, 'f1-score': 0.25719204865988127, 'support': 57445}, 'weighted avg': {'precision': 0.34549714691949823, 'recall': 0.34593089041692054, 'f1-score': 0.25814990340225324, 'support': 57445}}
[[  107  4552 15067]
 [  102  4274 13197]
 [   88  4567 15491]]
training model: results/PCAR/W6/deepLOB_L2/h10
Epoch 1/50
618/618 - 76s - loss: 3.3107 - accuracy10: 0.3668 - val_loss: 3.3400 - val_accuracy10: 0.3649 - 76s/epoch - 122ms/step
Epoch 2/50
618/618 - 72s - loss: 3.2401 - accuracy10: 0.4042 - val_loss: 3.2858 - val_accuracy10: 0.3816 - 72s/epoch - 117ms/step
Epoch 3/50
618/618 - 72s - loss: 3.1951 - accuracy10: 0.4283 - val_loss: 3.2611 - val_accuracy10: 0.3941 - 72s/epoch - 117ms/step
Epoch 4/50
618/618 - 71s - loss: 3.1608 - accuracy10: 0.4423 - val_loss: 3.2689 - val_accuracy10: 0.3985 - 71s/epoch - 114ms/step
Epoch 5/50
618/618 - 71s - loss: 3.1378 - accuracy10: 0.4521 - val_loss: 3.2194 - val_accuracy10: 0.4138 - 71s/epoch - 114ms/step
Epoch 6/50
618/618 - 69s - loss: 3.1195 - accuracy10: 0.4595 - val_loss: 3.2023 - val_accuracy10: 0.4237 - 69s/epoch - 111ms/step
Epoch 7/50
618/618 - 69s - loss: 3.1074 - accuracy10: 0.4642 - val_loss: 3.1705 - val_accuracy10: 0.4356 - 69s/epoch - 112ms/step
Epoch 8/50
618/618 - 74s - loss: 3.0941 - accuracy10: 0.4705 - val_loss: 3.1768 - val_accuracy10: 0.4365 - 74s/epoch - 120ms/step
Epoch 9/50
618/618 - 69s - loss: 3.0818 - accuracy10: 0.4746 - val_loss: 3.1895 - val_accuracy10: 0.4374 - 69s/epoch - 112ms/step
Epoch 10/50
618/618 - 70s - loss: 3.0734 - accuracy10: 0.4757 - val_loss: 3.1664 - val_accuracy10: 0.4413 - 70s/epoch - 113ms/step
Epoch 11/50
618/618 - 71s - loss: 3.0660 - accuracy10: 0.4778 - val_loss: 3.1837 - val_accuracy10: 0.4387 - 71s/epoch - 115ms/step
Epoch 12/50
618/618 - 69s - loss: 3.0562 - accuracy10: 0.4816 - val_loss: 3.1911 - val_accuracy10: 0.4359 - 69s/epoch - 112ms/step
Epoch 13/50
618/618 - 70s - loss: 3.0476 - accuracy10: 0.4830 - val_loss: 3.2269 - val_accuracy10: 0.4308 - 70s/epoch - 113ms/step
Epoch 14/50
618/618 - 69s - loss: 3.0426 - accuracy10: 0.4848 - val_loss: 3.2170 - val_accuracy10: 0.4304 - 69s/epoch - 112ms/step
Epoch 15/50
618/618 - 72s - loss: 3.0349 - accuracy10: 0.4879 - val_loss: 3.2248 - val_accuracy10: 0.4318 - 72s/epoch - 116ms/step
Epoch 16/50
618/618 - 71s - loss: 3.0286 - accuracy10: 0.4898 - val_loss: 3.2153 - val_accuracy10: 0.4335 - 71s/epoch - 115ms/step
Epoch 17/50
618/618 - 70s - loss: 3.0202 - accuracy10: 0.4923 - val_loss: 3.2242 - val_accuracy10: 0.4284 - 70s/epoch - 114ms/step
Epoch 18/50
618/618 - 72s - loss: 3.0143 - accuracy10: 0.4930 - val_loss: 3.2560 - val_accuracy10: 0.4275 - 72s/epoch - 116ms/step
Epoch 19/50
618/618 - 71s - loss: 3.0087 - accuracy10: 0.4951 - val_loss: 3.2367 - val_accuracy10: 0.4283 - 71s/epoch - 115ms/step
Epoch 20/50
618/618 - 70s - loss: 3.0011 - accuracy10: 0.4972 - val_loss: 3.2600 - val_accuracy10: 0.4255 - 70s/epoch - 113ms/step
testing model: results/PCAR/W6/deepLOB_L2/h10
Evaluating performance on  test set...
1722/1722 - 85s - 85s/epoch - 49ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0488065
{'0': {'precision': 0.4661959100666591, 'recall': 0.5134353244200008, 'f1-score': 0.48867663647695203, 'support': 160733}, '1': {'precision': 0.3760667249025669, 'recall': 0.3860639976546265, 'f1-score': 0.3809997915150896, 'support': 115973}, '2': {'precision': 0.48196209310199484, 'recall': 0.4250699298568495, 'f1-score': 0.45173177555567073, 'support': 164093}, 'accuracy': 0.4470291448029601, 'macro avg': {'precision': 0.4414082426904069, 'recall': 0.44152308397715895, 'f1-score': 0.4404694011825708, 'support': 440799}, 'weighted avg': {'precision': 0.44835233120595863, 'recall': 0.4470291448029601, 'f1-score': 0.4465939643204411, 'support': 440799}}
[[82526 36553 41654]
 [37882 44773 33318]
 [56612 37730 69751]]
Evaluating performance on  train set...
618/618 - 35s - 35s/epoch - 57ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0479081
{'0': {'precision': 0.45102785782901056, 'recall': 0.4538266736260125, 'f1-score': 0.45242293720309507, 'support': 51729}, '1': {'precision': 0.49748198114951026, 'recall': 0.40168245915093637, 'f1-score': 0.4444788441692466, 'support': 53612}, '2': {'precision': 0.4301844605925098, 'recall': 0.5119744544970729, 'f1-score': 0.46752931170645773, 'support': 52612}, 'accuracy': 0.45549625521515896, 'macro avg': {'precision': 0.45956476652367684, 'recall': 0.45582786242467394, 'f1-score': 0.4548103643595998, 'support': 157953}, 'weighted avg': {'precision': 0.45985254393216696, 'recall': 0.45549625521515896, 'f1-score': 0.4547583018979108, 'support': 157953}}
[[23476 10890 17363]
 [13761 21535 18316]
 [14813 10863 26936]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 48ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0559199
{'0': {'precision': 0.42414340397721967, 'recall': 0.4903929188255613, 'f1-score': 0.4548685857321652, 'support': 18528}, '1': {'precision': 0.492243546508063, 'recall': 0.3848329418532189, 'f1-score': 0.4319612590799031, 'support': 20861}, '2': {'precision': 0.41587623636824755, 'recall': 0.45406213656753613, 'f1-score': 0.4341311024038971, 'support': 18057}, 'accuracy': 0.4406399053023709, 'macro avg': {'precision': 0.4440877289511767, 'recall': 0.44309599908210545, 'f1-score': 0.4403203157386552, 'support': 57446}, 'weighted avg': {'precision': 0.44627474171737064, 'recall': 0.4406399053023709, 'f1-score': 0.4400315826727463, 'support': 57446}}
[[9086 4221 5221]
 [6538 8028 6295]
 [5798 4060 8199]]
training model: results/PCAR/W6/deepLOB_L2/h20
Epoch 1/50
618/618 - 83s - loss: 3.3163 - accuracy20: 0.3641 - val_loss: 3.3474 - val_accuracy20: 0.3474 - 83s/epoch - 134ms/step
Epoch 2/50
618/618 - 74s - loss: 3.2697 - accuracy20: 0.3857 - val_loss: 3.2983 - val_accuracy20: 0.3601 - 74s/epoch - 120ms/step
Epoch 3/50
618/618 - 75s - loss: 3.2372 - accuracy20: 0.4065 - val_loss: 3.2635 - val_accuracy20: 0.3845 - 75s/epoch - 121ms/step
Epoch 4/50
618/618 - 73s - loss: 3.2136 - accuracy20: 0.4209 - val_loss: 3.2509 - val_accuracy20: 0.3968 - 73s/epoch - 118ms/step
Epoch 5/50
618/618 - 73s - loss: 3.1991 - accuracy20: 0.4286 - val_loss: 3.2563 - val_accuracy20: 0.3946 - 73s/epoch - 118ms/step
Epoch 6/50
618/618 - 74s - loss: 3.1887 - accuracy20: 0.4332 - val_loss: 3.2393 - val_accuracy20: 0.4056 - 74s/epoch - 119ms/step
Epoch 7/50
618/618 - 66s - loss: 3.1784 - accuracy20: 0.4379 - val_loss: 3.2392 - val_accuracy20: 0.4028 - 66s/epoch - 106ms/step
Epoch 8/50
618/618 - 71s - loss: 3.1706 - accuracy20: 0.4401 - val_loss: 3.2467 - val_accuracy20: 0.4039 - 71s/epoch - 115ms/step
Epoch 9/50
618/618 - 76s - loss: 3.1618 - accuracy20: 0.4427 - val_loss: 3.2479 - val_accuracy20: 0.4034 - 76s/epoch - 123ms/step
Epoch 10/50
618/618 - 76s - loss: 3.1565 - accuracy20: 0.4448 - val_loss: 3.2470 - val_accuracy20: 0.4008 - 76s/epoch - 122ms/step
Epoch 11/50
618/618 - 74s - loss: 3.1498 - accuracy20: 0.4477 - val_loss: 3.2616 - val_accuracy20: 0.3976 - 74s/epoch - 120ms/step
Epoch 12/50
618/618 - 76s - loss: 3.1429 - accuracy20: 0.4503 - val_loss: 3.2578 - val_accuracy20: 0.4018 - 76s/epoch - 123ms/step
Epoch 13/50
618/618 - 72s - loss: 3.1384 - accuracy20: 0.4521 - val_loss: 3.2764 - val_accuracy20: 0.3994 - 72s/epoch - 117ms/step
Epoch 14/50
618/618 - 76s - loss: 3.1327 - accuracy20: 0.4536 - val_loss: 3.2961 - val_accuracy20: 0.3977 - 76s/epoch - 123ms/step
Epoch 15/50
618/618 - 75s - loss: 3.1278 - accuracy20: 0.4552 - val_loss: 3.2997 - val_accuracy20: 0.3936 - 75s/epoch - 121ms/step
Epoch 16/50
618/618 - 72s - loss: 3.1225 - accuracy20: 0.4566 - val_loss: 3.3185 - val_accuracy20: 0.3939 - 72s/epoch - 116ms/step
Epoch 17/50
618/618 - 72s - loss: 3.1167 - accuracy20: 0.4597 - val_loss: 3.3286 - val_accuracy20: 0.3896 - 72s/epoch - 117ms/step
testing model: results/PCAR/W6/deepLOB_L2/h20
Evaluating performance on  test set...
1722/1722 - 80s - 80s/epoch - 46ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0722646
{'0': {'precision': 0.421036661272252, 'recall': 0.669740099009901, 'f1-score': 0.517035465871742, 'support': 161600}, '1': {'precision': 0.3904341671310031, 'recall': 0.2273253367003367, 'f1-score': 0.28734670353724834, 'support': 114048}, '2': {'precision': 0.4650758479631839, 'recall': 0.33043699402365106, 'f1-score': 0.38636275137969, 'support': 165151}, 'accuracy': 0.4281497916283839, 'macro avg': {'precision': 0.42551555878881303, 'recall': 0.40916747657796293, 'f1-score': 0.3969149735962268, 'support': 440799}, 'weighted avg': {'precision': 0.42961871901143234, 'recall': 0.4281497916283839, 'f1-score': 0.4086498446752302, 'support': 440799}}
[[108230  19116  34254]
 [ 59608  25926  28514]
 [ 89218  21361  54572]]
Evaluating performance on  train set...
618/618 - 35s - 35s/epoch - 57ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0720668
{'0': {'precision': 0.42299679796304157, 'recall': 0.4173613490160253, 'f1-score': 0.4201601778050276, 'support': 52542}, '1': {'precision': 0.429930966469428, 'recall': 0.33159656195329734, 'f1-score': 0.37441490960621804, 'support': 52588}, '2': {'precision': 0.40608076154444633, 'recall': 0.5039282130889953, 'f1-score': 0.449744031628567, 'support': 52823}, 'accuracy': 0.41775718093356884, 'macro avg': {'precision': 0.41966950865897196, 'recall': 0.41762870801943935, 'f1-score': 0.41477303967993756, 'support': 157953}, 'weighted avg': {'precision': 0.4196483225410768, 'recall': 0.41775718093356884, 'f1-score': 0.41482350010015223, 'support': 157953}}
[[21929 11684 18929]
 [15147 17438 20003]
 [14766 11438 26619]]
Evaluating performance on  val set...
225/225 - 12s - 12s/epoch - 53ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079306
{'0': {'precision': 0.42931231898700073, 'recall': 0.3355443251210781, 'f1-score': 0.37668055432438025, 'support': 18996}, '1': {'precision': 0.4197656302919461, 'recall': 0.31198711171524945, 'f1-score': 0.35793912089181545, 'support': 19863}, '2': {'precision': 0.38155625808305793, 'recall': 0.57142088556518, 'f1-score': 0.4575749089890787, 'support': 18587}, 'accuracy': 0.40371827455349374, 'macro avg': {'precision': 0.41021140245400156, 'recall': 0.4063174408005025, 'f1-score': 0.3973981947350915, 'support': 57446}, 'weighted avg': {'precision': 0.41055961589938006, 'recall': 0.40371827455349374, 'f1-score': 0.39637421929464306, 'support': 57446}}
[[ 6374  4430  8192]
 [ 4643  6197  9023]
 [ 3830  4136 10621]]
training model: results/PCAR/W6/deepLOB_L2/h30
Epoch 1/50
618/618 - 74s - loss: 3.3227 - accuracy30: 0.3601 - val_loss: 3.3581 - val_accuracy30: 0.3420 - 74s/epoch - 120ms/step
Epoch 2/50
618/618 - 68s - loss: 3.2784 - accuracy30: 0.3751 - val_loss: 3.3315 - val_accuracy30: 0.3496 - 68s/epoch - 110ms/step
Epoch 3/50
618/618 - 69s - loss: 3.2548 - accuracy30: 0.3923 - val_loss: 3.2906 - val_accuracy30: 0.3698 - 69s/epoch - 112ms/step
Epoch 4/50
618/618 - 69s - loss: 3.2348 - accuracy30: 0.4071 - val_loss: 3.2779 - val_accuracy30: 0.3755 - 69s/epoch - 112ms/step
Epoch 5/50
618/618 - 66s - loss: 3.2220 - accuracy30: 0.4160 - val_loss: 3.2652 - val_accuracy30: 0.3876 - 66s/epoch - 107ms/step
Epoch 6/50
618/618 - 66s - loss: 3.2140 - accuracy30: 0.4203 - val_loss: 3.2514 - val_accuracy30: 0.3951 - 66s/epoch - 107ms/step
Epoch 7/50
618/618 - 66s - loss: 3.2079 - accuracy30: 0.4233 - val_loss: 3.2543 - val_accuracy30: 0.3953 - 66s/epoch - 107ms/step
Epoch 8/50
618/618 - 67s - loss: 3.2010 - accuracy30: 0.4265 - val_loss: 3.2607 - val_accuracy30: 0.3886 - 67s/epoch - 109ms/step
Epoch 9/50
618/618 - 68s - loss: 3.1953 - accuracy30: 0.4288 - val_loss: 3.2607 - val_accuracy30: 0.3933 - 68s/epoch - 110ms/step
Epoch 10/50
618/618 - 66s - loss: 3.1894 - accuracy30: 0.4313 - val_loss: 3.2859 - val_accuracy30: 0.3858 - 66s/epoch - 107ms/step
Epoch 11/50
618/618 - 70s - loss: 3.1848 - accuracy30: 0.4319 - val_loss: 3.2965 - val_accuracy30: 0.3857 - 70s/epoch - 113ms/step
Epoch 12/50
618/618 - 67s - loss: 3.1787 - accuracy30: 0.4350 - val_loss: 3.3160 - val_accuracy30: 0.3832 - 67s/epoch - 108ms/step
Epoch 13/50
618/618 - 67s - loss: 3.1763 - accuracy30: 0.4351 - val_loss: 3.3536 - val_accuracy30: 0.3823 - 67s/epoch - 109ms/step
Epoch 14/50
618/618 - 71s - loss: 3.1689 - accuracy30: 0.4363 - val_loss: 3.3591 - val_accuracy30: 0.3805 - 71s/epoch - 114ms/step
Epoch 15/50
618/618 - 71s - loss: 3.1669 - accuracy30: 0.4390 - val_loss: 3.3637 - val_accuracy30: 0.3825 - 71s/epoch - 114ms/step
Epoch 16/50
618/618 - 68s - loss: 3.1589 - accuracy30: 0.4408 - val_loss: 3.3607 - val_accuracy30: 0.3798 - 68s/epoch - 110ms/step
testing model: results/PCAR/W6/deepLOB_L2/h30
Evaluating performance on  test set...
1722/1722 - 86s - 86s/epoch - 50ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081326
{'0': {'precision': 0.42117387562422376, 'recall': 0.5170668438201892, 'f1-score': 0.4642199854585114, 'support': 158055}, '1': {'precision': 0.33980302747783636, 'recall': 0.3285663943091763, 'f1-score': 0.33409025570087536, 'support': 122021}, '2': {'precision': 0.45609293945888857, 'recall': 0.3654237414682404, 'f1-score': 0.4057548489611219, 'support': 160723}, 'accuracy': 0.4095948493531065, 'macro avg': {'precision': 0.40568994752031623, 'recall': 0.40368565986586863, 'f1-score': 0.4013550300401696, 'support': 440799}, 'weighted avg': {'precision': 0.41138107762565407, 'recall': 0.4095948493531065, 'f1-score': 0.40688035472426193, 'support': 440799}}
[[81725 37832 38498]
 [50387 40092 31542]
 [61929 40062 58732]]
Evaluating performance on  train set...
618/618 - 32s - 32s/epoch - 52ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0812259
{'0': {'precision': 0.41556425485961124, 'recall': 0.3511596958174905, 'f1-score': 0.38065699447695983, 'support': 52600}, '1': {'precision': 0.4073896122615673, 'recall': 0.3239907529470205, 'f1-score': 0.36093522193961713, 'support': 52341}, '2': {'precision': 0.3929520444079634, 'recall': 0.532803893458085, 'f1-score': 0.45231441817264656, 'support': 53012}, 'accuracy': 0.40311991541787745, 'macro avg': {'precision': 0.4053019705097139, 'recall': 0.402651447407532, 'f1-score': 0.39796887819640786, 'support': 157953}, 'weighted avg': {'precision': 0.4052663341573329, 'recall': 0.40311991541787745, 'f1-score': 0.3981713566516491, 'support': 157953}}
[[18471 12337 21792]
 [13541 16958 21842]
 [12436 12331 28245]]
Evaluating performance on  val set...
225/225 - 12s - 12s/epoch - 52ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0829765
{'0': {'precision': 0.40940248710949345, 'recall': 0.352870438147025, 'f1-score': 0.3790401842127432, 'support': 19126}, '1': {'precision': 0.39337899543378996, 'recall': 0.35410779427631917, 'f1-score': 0.37271178649649833, 'support': 19463}, '2': {'precision': 0.3827055159762809, 'recall': 0.4757384525640346, 'f1-score': 0.4241808123315523, 'support': 18857}, 'accuracy': 0.39362183615917556, 'macro avg': {'precision': 0.3951623328398548, 'recall': 0.39423889499579295, 'f1-score': 0.39197759434693125, 'support': 57446}, 'weighted avg': {'precision': 0.3952102021263231, 'recall': 0.39362183615917556, 'f1-score': 0.39171377714671785, 'support': 57446}}
[[6749 5255 7122]
 [5223 6892 7348]
 [4513 5373 8971]]
training model: results/PCAR/W6/deepLOB_L2/h50
Epoch 1/50
618/618 - 74s - loss: 3.2902 - accuracy50: 0.3806 - val_loss: 3.3804 - val_accuracy50: 0.3559 - 74s/epoch - 120ms/step
Epoch 2/50
618/618 - 69s - loss: 3.2626 - accuracy50: 0.3848 - val_loss: 3.3449 - val_accuracy50: 0.3513 - 69s/epoch - 111ms/step
Epoch 3/50
618/618 - 70s - loss: 3.2594 - accuracy50: 0.3852 - val_loss: 3.3235 - val_accuracy50: 0.3488 - 70s/epoch - 113ms/step
Epoch 4/50
618/618 - 71s - loss: 3.2410 - accuracy50: 0.3939 - val_loss: 3.3516 - val_accuracy50: 0.3571 - 71s/epoch - 115ms/step
Epoch 5/50
618/618 - 66s - loss: 3.2178 - accuracy50: 0.4089 - val_loss: 3.3532 - val_accuracy50: 0.3599 - 66s/epoch - 107ms/step
Epoch 6/50
618/618 - 73s - loss: 3.2088 - accuracy50: 0.4153 - val_loss: 3.3631 - val_accuracy50: 0.3599 - 73s/epoch - 118ms/step
Epoch 7/50
618/618 - 66s - loss: 3.2003 - accuracy50: 0.4228 - val_loss: 3.3840 - val_accuracy50: 0.3625 - 66s/epoch - 108ms/step
Epoch 8/50
618/618 - 68s - loss: 3.1948 - accuracy50: 0.4260 - val_loss: 3.3943 - val_accuracy50: 0.3566 - 68s/epoch - 109ms/step
Epoch 9/50
618/618 - 70s - loss: 3.1896 - accuracy50: 0.4285 - val_loss: 3.3687 - val_accuracy50: 0.3612 - 70s/epoch - 114ms/step
Epoch 10/50
618/618 - 69s - loss: 3.1811 - accuracy50: 0.4325 - val_loss: 3.3880 - val_accuracy50: 0.3596 - 69s/epoch - 112ms/step
Epoch 11/50
618/618 - 70s - loss: 3.1754 - accuracy50: 0.4357 - val_loss: 3.3852 - val_accuracy50: 0.3596 - 70s/epoch - 114ms/step
Epoch 12/50
618/618 - 69s - loss: 3.1704 - accuracy50: 0.4360 - val_loss: 3.3871 - val_accuracy50: 0.3531 - 69s/epoch - 112ms/step
Epoch 13/50
618/618 - 70s - loss: 3.1640 - accuracy50: 0.4408 - val_loss: 3.4235 - val_accuracy50: 0.3576 - 70s/epoch - 113ms/step
testing model: results/PCAR/W6/deepLOB_L2/h50
Evaluating performance on  test set...
1722/1722 - 86s - 86s/epoch - 50ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1162066
{'0': {'precision': 0.35839895619241163, 'recall': 0.4021389889358174, 'f1-score': 0.3790111849174563, 'support': 154372}, '1': {'precision': 0.29453245470663997, 'recall': 0.39357293346813094, 'f1-score': 0.33692514022581477, 'support': 129577}, '2': {'precision': 0.3655731802875961, 'recall': 0.22010838380618425, 'f1-score': 0.27477635223329405, 'support': 156850}, 'accuracy': 0.3348487632685192, 'macro avg': {'precision': 0.33950153039554926, 'recall': 0.33860676873671086, 'f1-score': 0.3302375591255217, 'support': 440799}, 'weighted avg': {'precision': 0.34217761128534024, 'recall': 0.3348487632685192, 'f1-score': 0.32954960056830923, 'support': 440799}}
[[62079 59961 32332]
 [50997 50998 27582]
 [60136 62190 34524]]
Evaluating performance on  train set...
618/618 - 32s - 32s/epoch - 52ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1075664
{'0': {'precision': 0.3215111581645446, 'recall': 0.21991005411997866, 'f1-score': 0.2611775622673109, 'support': 52476}, '1': {'precision': 0.3620861201702504, 'recall': 0.24882245688672794, 'f1-score': 0.2949546344867956, 'support': 52652}, '2': {'precision': 0.35294254640303685, 'recall': 0.5737813535257927, 'f1-score': 0.4370489463097409, 'support': 52825}, 'accuracy': 0.3478946268826803, 'macro avg': {'precision': 0.34551327491261064, 'recall': 0.3475046215108331, 'f1-score': 0.3310603810212825, 'support': 157953}, 'weighted avg': {'precision': 0.3455481564059378, 'recall': 0.3478946268826803, 'f1-score': 0.3312543336394385, 'support': 157953}}
[[11540 11443 29493]
 [13476 13101 26075]
 [10877 11638 30310]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084042
{'0': {'precision': 0.31685074475630765, 'recall': 0.16503061009077474, 'f1-score': 0.2170246729361141, 'support': 18948}, '1': {'precision': 0.3659574468085106, 'recall': 0.253202479338843, 'f1-score': 0.29931308197221795, 'support': 19360}, '2': {'precision': 0.3486630390263882, 'recall': 0.6227400982338802, 'f1-score': 0.44703675918979746, 'support': 19138}, 'accuracy': 0.3472304425025241, 'macro avg': {'precision': 0.3438237435304021, 'recall': 0.34699106255449935, 'f1-score': 0.32112483803270986, 'support': 57446}, 'weighted avg': {'precision': 0.34399849115242664, 'recall': 0.3472304425025241, 'f1-score': 0.3213848530298014, 'support': 57446}}
[[ 3127  4234 11587]
 [ 3781  4902 10677]
 [ 2961  4259 11918]]
training model: results/PCAR/W6/deepLOB_L2/h100
Epoch 1/50
618/618 - 77s - loss: 3.3160 - accuracy100: 0.3629 - val_loss: 3.3853 - val_accuracy100: 0.3341 - 77s/epoch - 124ms/step
Epoch 2/50
618/618 - 75s - loss: 3.2968 - accuracy100: 0.3639 - val_loss: 3.3494 - val_accuracy100: 0.3302 - 75s/epoch - 121ms/step
Epoch 3/50
618/618 - 67s - loss: 3.2775 - accuracy100: 0.3711 - val_loss: 3.3701 - val_accuracy100: 0.3312 - 67s/epoch - 109ms/step
Epoch 4/50
618/618 - 69s - loss: 3.2723 - accuracy100: 0.3760 - val_loss: 3.3594 - val_accuracy100: 0.3429 - 69s/epoch - 112ms/step
Epoch 5/50
618/618 - 69s - loss: 3.2625 - accuracy100: 0.3848 - val_loss: 3.3623 - val_accuracy100: 0.3408 - 69s/epoch - 112ms/step
Epoch 6/50
618/618 - 69s - loss: 3.2549 - accuracy100: 0.3903 - val_loss: 3.3932 - val_accuracy100: 0.3401 - 69s/epoch - 112ms/step
Epoch 7/50
618/618 - 68s - loss: 3.2486 - accuracy100: 0.3948 - val_loss: 3.4093 - val_accuracy100: 0.3428 - 68s/epoch - 110ms/step
Epoch 8/50
618/618 - 69s - loss: 3.2446 - accuracy100: 0.3990 - val_loss: 3.4203 - val_accuracy100: 0.3420 - 69s/epoch - 112ms/step
Epoch 9/50
618/618 - 71s - loss: 3.2358 - accuracy100: 0.4045 - val_loss: 3.4398 - val_accuracy100: 0.3387 - 71s/epoch - 115ms/step
Epoch 10/50
618/618 - 69s - loss: 3.2291 - accuracy100: 0.4070 - val_loss: 3.4461 - val_accuracy100: 0.3402 - 69s/epoch - 112ms/step
Epoch 11/50
618/618 - 72s - loss: 3.2227 - accuracy100: 0.4112 - val_loss: 3.4559 - val_accuracy100: 0.3446 - 72s/epoch - 117ms/step
Epoch 12/50
618/618 - 69s - loss: 3.2163 - accuracy100: 0.4144 - val_loss: 3.5113 - val_accuracy100: 0.3407 - 69s/epoch - 111ms/step
testing model: results/PCAR/W6/deepLOB_L2/h100
Evaluating performance on  test set...
1722/1722 - 83s - 83s/epoch - 48ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.13351
{'0': {'precision': 0.34906717138553056, 'recall': 0.05685829154581317, 'f1-score': 0.09778821390698378, 'support': 158939}, '1': {'precision': 0.26724889881394026, 'recall': 0.608961353852244, 'f1-score': 0.3714730585314441, 'support': 121254}, '2': {'precision': 0.35800803653231567, 'recall': 0.3089921920725253, 'f1-score': 0.3316991006707372, 'support': 160606}, 'accuracy': 0.30059505579640605, 'macro avg': {'precision': 0.32477470224392885, 'recall': 0.3249372791568608, 'f1-score': 0.26698679103638834, 'support': 440799}, 'weighted avg': {'precision': 0.3298184066772825, 'recall': 0.30059505579640605, 'f1-score': 0.258298727836629, 'support': 440799}}
[[  9037 100389  49513]
 [  7937  73839  39478]
 [  8915 102065  49626]]
Evaluating performance on  train set...
618/618 - 35s - 35s/epoch - 57ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.118307
{'0': {'precision': 0.34957414829659317, 'recall': 0.0524545181175763, 'f1-score': 0.09122107465028108, 'support': 53208}, '1': {'precision': 0.3245180397899303, 'recall': 0.5701491382478674, 'f1-score': 0.4136145491285678, 'support': 51697}, '2': {'precision': 0.33793243380338844, 'recall': 0.3767531292414417, 'f1-score': 0.35628843925483555, 'support': 53048}, 'accuracy': 0.3308072654523814, 'macro avg': {'precision': 0.3373415406299706, 'recall': 0.33311892853562847, 'f1-score': 0.2870413543445615, 'support': 157953}, 'weighted avg': {'precision': 0.33746361344189285, 'recall': 0.3308072654523814, 'f1-score': 0.2857603933567723, 'support': 157953}}
[[ 2791 30854 19563]
 [ 2629 29475 19593]
 [ 2564 30498 19986]]
Evaluating performance on  val set...
225/225 - 12s - 12s/epoch - 53ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1185718
{'0': {'precision': 0.3290198897675533, 'recall': 0.07179460363940598, 'f1-score': 0.11786925355195949, 'support': 19124}, '1': {'precision': 0.3281048055457643, 'recall': 0.5912242629545335, 'f1-score': 0.4220110697621702, 'support': 18893}, '2': {'precision': 0.3345467783036039, 'recall': 0.3311029903752123, 'f1-score': 0.3328159759946195, 'support': 19429}, 'accuracy': 0.33032761201824323, 'macro avg': {'precision': 0.33055715787230716, 'recall': 0.33137395232305056, 'f1-score': 0.2908987664362497, 'support': 57446}, 'weighted avg': {'precision': 0.33058820141962075, 'recall': 0.33032761201824323, 'f1-score': 0.29059409434153494, 'support': 57446}}
[[ 1373 11279  6472]
 [ 1399 11170  6324]
 [ 1401 11595  6433]]
training model: results/PCAR/W6/deepLOB_L2/h200
Epoch 1/50
618/618 - 77s - loss: 3.3154 - accuracy200: 0.3659 - val_loss: 3.4450 - val_accuracy200: 0.3411 - 77s/epoch - 124ms/step
Epoch 2/50
618/618 - 67s - loss: 3.2747 - accuracy200: 0.3773 - val_loss: 3.3798 - val_accuracy200: 0.3435 - 67s/epoch - 108ms/step
Epoch 3/50
618/618 - 67s - loss: 3.2560 - accuracy200: 0.3885 - val_loss: 3.3855 - val_accuracy200: 0.3558 - 67s/epoch - 109ms/step
Epoch 4/50
618/618 - 68s - loss: 3.2453 - accuracy200: 0.4010 - val_loss: 3.4089 - val_accuracy200: 0.3513 - 68s/epoch - 111ms/step
Epoch 5/50
618/618 - 69s - loss: 3.2345 - accuracy200: 0.4095 - val_loss: 3.3911 - val_accuracy200: 0.3527 - 69s/epoch - 112ms/step
Epoch 6/50
618/618 - 67s - loss: 3.2225 - accuracy200: 0.4154 - val_loss: 3.4318 - val_accuracy200: 0.3528 - 67s/epoch - 109ms/step
Epoch 7/50
618/618 - 69s - loss: 3.2193 - accuracy200: 0.4153 - val_loss: 3.4500 - val_accuracy200: 0.3513 - 69s/epoch - 112ms/step
Epoch 8/50
618/618 - 70s - loss: 3.2084 - accuracy200: 0.4221 - val_loss: 3.4817 - val_accuracy200: 0.3444 - 70s/epoch - 113ms/step
Epoch 9/50
618/618 - 71s - loss: 3.2009 - accuracy200: 0.4251 - val_loss: 3.4665 - val_accuracy200: 0.3395 - 71s/epoch - 115ms/step
Epoch 10/50
618/618 - 66s - loss: 3.1958 - accuracy200: 0.4264 - val_loss: 3.5033 - val_accuracy200: 0.3461 - 66s/epoch - 107ms/step
Epoch 11/50
618/618 - 69s - loss: 3.1861 - accuracy200: 0.4299 - val_loss: 3.4610 - val_accuracy200: 0.3473 - 69s/epoch - 112ms/step
Epoch 12/50
618/618 - 68s - loss: 3.1796 - accuracy200: 0.4335 - val_loss: 3.4895 - val_accuracy200: 0.3455 - 68s/epoch - 109ms/step
testing model: results/PCAR/W6/deepLOB_L2/h200
Evaluating performance on  test set...
1722/1722 - 80s - 80s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.149804
{'0': {'precision': 0.34973376252218646, 'recall': 0.15216822209714786, 'f1-score': 0.21206676395476104, 'support': 152798}, '1': {'precision': 0.29831528201416535, 'recall': 0.7233234095894704, 'f1-score': 0.422416317417324, 'support': 127640}, '2': {'precision': 0.38522883277545544, 'recall': 0.15573612037839624, 'f1-score': 0.22180381011590214, 'support': 160361}, 'accuracy': 0.31885281046463354, 'macro avg': {'precision': 0.34442595910393575, 'recall': 0.3437425840216715, 'f1-score': 0.28542896382932903, 'support': 440799}, 'weighted avg': {'precision': 0.34775773741514365, 'recall': 0.31885281046463354, 'f1-score': 0.27651895069612903, 'support': 440799}}
[[ 23251 107196  22351]
 [ 17811  92325  17504]
 [ 25420 109967  24974]]
Evaluating performance on  train set...
618/618 - 31s - 31s/epoch - 50ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185127
{'0': {'precision': 0.359906269427574, 'recall': 0.14151936818352764, 'f1-score': 0.2031555789502099, 'support': 53180}, '1': {'precision': 0.3559493383313455, 'recall': 0.6009166394998754, 'f1-score': 0.44707594412977414, 'support': 52147}, '2': {'precision': 0.35268431040463605, 'recall': 0.3284308136662486, 'f1-score': 0.3401257465586965, 'support': 52626}, 'accuracy': 0.3554601685311453, 'macro avg': {'precision': 0.3561799727211852, 'recall': 0.3569556071165505, 'f1-score': 0.3301190898795601, 'support': 157953}, 'weighted avg': {'precision': 0.35619374164135814, 'recall': 0.3554601685311453, 'f1-score': 0.3293191043253718, 'support': 157953}}
[[ 7526 28689 16965]
 [ 6053 31336 14758]
 [ 7332 28010 17284]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269917
{'0': {'precision': 0.3338500563697858, 'recall': 0.1246514075243357, 'f1-score': 0.18152561204551554, 'support': 19005}, '1': {'precision': 0.3476127320954907, 'recall': 0.5526038372338182, 'f1-score': 0.4267687047138321, 'support': 18972}, '2': {'precision': 0.3384843982169391, 'recall': 0.3510195695721403, 'f1-score': 0.34463803928490383, 'support': 19469}, 'accuracy': 0.34270445287748497, 'macro avg': {'precision': 0.33998239556073856, 'recall': 0.3427582714434314, 'f1-score': 0.3176441186814172, 'support': 57446}, 'weighted avg': {'precision': 0.3399659127442993, 'recall': 0.34270445287748497, 'f1-score': 0.31779946575207385, 'support': 57446}}
[[ 2369  9647  6989]
 [ 2121 10484  6367]
 [ 2606 10029  6834]]
training model: results/PCAR/W6/deepLOB_L2/h300
Epoch 1/50
618/618 - 77s - loss: 3.3136 - accuracy300: 0.3657 - val_loss: 3.3765 - val_accuracy300: 0.3360 - 77s/epoch - 124ms/step
Epoch 2/50
618/618 - 70s - loss: 3.2814 - accuracy300: 0.3756 - val_loss: 3.3606 - val_accuracy300: 0.3236 - 70s/epoch - 114ms/step
Epoch 3/50
618/618 - 68s - loss: 3.2654 - accuracy300: 0.3795 - val_loss: 3.3120 - val_accuracy300: 0.3433 - 68s/epoch - 110ms/step
Epoch 4/50
618/618 - 71s - loss: 3.2500 - accuracy300: 0.3955 - val_loss: 3.3620 - val_accuracy300: 0.3331 - 71s/epoch - 116ms/step
Epoch 5/50
618/618 - 69s - loss: 3.2367 - accuracy300: 0.4095 - val_loss: 3.4390 - val_accuracy300: 0.3368 - 69s/epoch - 112ms/step
Epoch 6/50
618/618 - 72s - loss: 3.2300 - accuracy300: 0.4130 - val_loss: 3.4626 - val_accuracy300: 0.3320 - 72s/epoch - 117ms/step
Epoch 7/50
618/618 - 73s - loss: 3.2204 - accuracy300: 0.4183 - val_loss: 3.4340 - val_accuracy300: 0.3363 - 73s/epoch - 117ms/step
Epoch 8/50
618/618 - 72s - loss: 3.2077 - accuracy300: 0.4246 - val_loss: 3.4187 - val_accuracy300: 0.3319 - 72s/epoch - 116ms/step
Epoch 9/50
618/618 - 72s - loss: 3.1972 - accuracy300: 0.4299 - val_loss: 3.4073 - val_accuracy300: 0.3411 - 72s/epoch - 117ms/step
Epoch 10/50
618/618 - 69s - loss: 3.1885 - accuracy300: 0.4340 - val_loss: 3.4349 - val_accuracy300: 0.3388 - 69s/epoch - 111ms/step
Epoch 11/50
618/618 - 75s - loss: 3.1822 - accuracy300: 0.4368 - val_loss: 3.4292 - val_accuracy300: 0.3400 - 75s/epoch - 121ms/step
Epoch 12/50
618/618 - 71s - loss: 3.1741 - accuracy300: 0.4387 - val_loss: 3.4241 - val_accuracy300: 0.3376 - 71s/epoch - 114ms/step
Epoch 13/50
618/618 - 71s - loss: 3.1662 - accuracy300: 0.4409 - val_loss: 3.4177 - val_accuracy300: 0.3486 - 71s/epoch - 115ms/step
testing model: results/PCAR/W6/deepLOB_L2/h300
Evaluating performance on  test set...
1722/1722 - 93s - 93s/epoch - 54ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162577
{'0': {'precision': 0.3332678615271299, 'recall': 0.32582366334732393, 'f1-score': 0.32950372268671524, 'support': 145812}, '1': {'precision': 0.3093799510298142, 'recall': 0.6344966621374136, 'f1-score': 0.4159453545563689, 'support': 135416}, '2': {'precision': 0.3841356460728903, 'recall': 0.04940747378909702, 'f1-score': 0.08755379105472111, 'support': 159571}, 'accuracy': 0.3205860267378102, 'macro avg': {'precision': 0.3422611528766115, 'recall': 0.33657593309127815, 'f1-score': 0.2776676227659351, 'support': 440799}, 'weighted avg': {'precision': 0.34434369872242077, 'recall': 0.3205860267378102, 'f1-score': 0.2684722491144342, 'support': 440799}}
[[ 47509  91369   6934]
 [ 43789  85921   5706]
 [ 51257 100430   7884]]
Evaluating performance on  train set...
618/618 - 35s - 35s/epoch - 56ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1099747
{'0': {'precision': 0.33738848337388483, 'recall': 0.14631076228203324, 'f1-score': 0.20410851011633463, 'support': 54022}, '1': {'precision': 0.3333116002503651, 'recall': 0.5009112465460817, 'f1-score': 0.40027560935505846, 'support': 51029}, '2': {'precision': 0.3475223901241398, 'recall': 0.37994782805943067, 'f1-score': 0.3630124616218169, 'support': 52902}, 'accuracy': 0.3391198647698999, 'macro avg': {'precision': 0.3394074912494633, 'recall': 0.34238994562918185, 'f1-score': 0.32246552703106995, 'support': 157953}, 'weighted avg': {'precision': 0.3394654598541789, 'recall': 0.3391198647698999, 'f1-score': 0.32070362226739135, 'support': 157953}}
[[ 7904 26019 20099]
 [ 7829 25561 17639]
 [ 7694 25108 20100]]
Evaluating performance on  val set...
225/225 - 12s - 12s/epoch - 54ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047689
{'0': {'precision': 0.33310321021746636, 'recall': 0.100604670558799, 'f1-score': 0.15453599167267196, 'support': 19184}, '1': {'precision': 0.33418647166361976, 'recall': 0.3967013888888889, 'f1-score': 0.36277039095058544, 'support': 18432}, '2': {'precision': 0.35137041515517936, 'recall': 0.527534039334342, 'f1-score': 0.4217975081649934, 'support': 19830}, 'accuracy': 0.3429829753159489, 'macro avg': {'precision': 0.3395533656787551, 'recall': 0.3416133662606766, 'f1-score': 0.31303463026275025, 'support': 57446}, 'weighted avg': {'precision': 0.33975650807789787, 'recall': 0.3429829753159489, 'f1-score': 0.3136066374884509, 'support': 57446}}
[[ 1930  7102 10152]
 [ 1961  7312  9159]
 [ 1903  7466 10461]]
training model: results/PCAR/W6/deepLOB_L2/h500
Epoch 1/50
618/618 - 74s - loss: 3.3181 - accuracy500: 0.3694 - val_loss: 3.4696 - val_accuracy500: 0.3353 - 74s/epoch - 120ms/step
Epoch 2/50
618/618 - 73s - loss: 3.2779 - accuracy500: 0.3795 - val_loss: 3.4559 - val_accuracy500: 0.3442 - 73s/epoch - 118ms/step
Epoch 3/50
618/618 - 72s - loss: 3.2542 - accuracy500: 0.3941 - val_loss: 3.4713 - val_accuracy500: 0.3449 - 72s/epoch - 117ms/step
Epoch 4/50
618/618 - 74s - loss: 3.2324 - accuracy500: 0.4153 - val_loss: 3.4889 - val_accuracy500: 0.3466 - 74s/epoch - 119ms/step
Epoch 5/50
618/618 - 71s - loss: 3.2113 - accuracy500: 0.4261 - val_loss: 3.5254 - val_accuracy500: 0.3471 - 71s/epoch - 115ms/step
Epoch 6/50
618/618 - 74s - loss: 3.2028 - accuracy500: 0.4280 - val_loss: 3.5712 - val_accuracy500: 0.3463 - 74s/epoch - 120ms/step
Epoch 7/50
618/618 - 73s - loss: 3.2104 - accuracy500: 0.4273 - val_loss: 3.5633 - val_accuracy500: 0.3469 - 73s/epoch - 118ms/step
Epoch 8/50
618/618 - 70s - loss: 3.1932 - accuracy500: 0.4336 - val_loss: 3.6609 - val_accuracy500: 0.3466 - 70s/epoch - 113ms/step
Epoch 9/50
618/618 - 70s - loss: 3.1871 - accuracy500: 0.4356 - val_loss: 3.6147 - val_accuracy500: 0.3496 - 70s/epoch - 114ms/step
Epoch 10/50
618/618 - 72s - loss: 3.1779 - accuracy500: 0.4381 - val_loss: 3.6852 - val_accuracy500: 0.3493 - 72s/epoch - 117ms/step
Epoch 11/50
618/618 - 72s - loss: 3.1669 - accuracy500: 0.4447 - val_loss: 3.6667 - val_accuracy500: 0.3461 - 72s/epoch - 116ms/step
Epoch 12/50
618/618 - 70s - loss: 3.1527 - accuracy500: 0.4507 - val_loss: 3.6984 - val_accuracy500: 0.3486 - 70s/epoch - 114ms/step
testing model: results/PCAR/W6/deepLOB_L2/h500
Evaluating performance on  test set...
1722/1722 - 87s - 87s/epoch - 51ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1396298
{'0': {'precision': 0.315660542432196, 'recall': 0.012091882218096267, 'f1-score': 0.023291544549597823, 'support': 149191}, '1': {'precision': 0.2978753228548808, 'recall': 0.8868348854283395, 'f1-score': 0.4459592328468997, 'support': 129395}, '2': {'precision': 0.40875443840398, 'recall': 0.12561262044349097, 'f1-score': 0.19217021437126883, 'support': 162213}, 'accuracy': 0.3106449878516058, 'macro avg': {'precision': 0.34076343456368563, 'recall': 0.3415131293633089, 'f1-score': 0.2204736639225888, 'support': 440799}, 'weighted avg': {'precision': 0.3446980893868495, 'recall': 0.3106449878516058, 'f1-score': 0.20951111672424452, 'support': 440799}}
[[  1804 130763  16624]
 [  1794 114752  12849]
 [  2117 139720  20376]]
Evaluating performance on  train set...
618/618 - 30s - 30s/epoch - 49ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1380749
{'0': {'precision': 0.3631790744466801, 'recall': 0.026648458117260597, 'f1-score': 0.04965355982325534, 'support': 54187}, '1': {'precision': 0.3499657214085385, 'recall': 0.5470665029909784, 'f1-score': 0.42686208626640115, 'support': 51321}, '2': {'precision': 0.3491159561774596, 'recall': 0.4909524263514158, 'f1-score': 0.40806041348051064, 'support': 52445}, 'accuracy': 0.34990155299361203, 'macro avg': {'precision': 0.35408691734422604, 'recall': 0.3548891291532182, 'f1-score': 0.29485868652338904, 'support': 157953}, 'weighted avg': {'precision': 0.35421651768042856, 'recall': 0.34990155299361203, 'f1-score': 0.2912150763860521, 'support': 157953}}
[[ 1444 26851 25892]
 [ 1133 28076 22112]
 [ 1399 25298 25748]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 45ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1570872
{'0': {'precision': 0.366412213740458, 'recall': 0.017366136034732273, 'f1-score': 0.033160621761658036, 'support': 19348}, '1': {'precision': 0.33200226164393243, 'recall': 0.5180304367004852, 'f1-score': 0.4046603781711677, 'support': 18136}, '2': {'precision': 0.3548227126208778, 'recall': 0.5018034265103697, 'f1-score': 0.4157035254082543, 'support': 19962}, 'accuracy': 0.34376631967412874, 'macro avg': {'precision': 0.35107906266842276, 'recall': 0.3457333330818624, 'f1-score': 0.2845081751136933, 'support': 57446}, 'weighted avg': {'precision': 0.35152155969019083, 'recall': 0.34376631967412874, 'f1-score': 0.283375450032316, 'support': 57446}}
[[  336  9294  9718]
 [  245  9395  8496]
 [  336  9609 10017]]
training model: results/PCAR/W6/deepLOB_L2/h1000
Epoch 1/50
618/618 - 76s - loss: 3.2917 - accuracy1000: 0.3881 - val_loss: 3.4666 - val_accuracy1000: 0.3471 - 76s/epoch - 123ms/step
Epoch 2/50
618/618 - 66s - loss: 3.2377 - accuracy1000: 0.4112 - val_loss: 3.4593 - val_accuracy1000: 0.3380 - 66s/epoch - 107ms/step
Epoch 3/50
618/618 - 70s - loss: 3.2087 - accuracy1000: 0.4227 - val_loss: 3.5375 - val_accuracy1000: 0.3272 - 70s/epoch - 114ms/step
Epoch 4/50
618/618 - 68s - loss: 3.1751 - accuracy1000: 0.4364 - val_loss: 3.5744 - val_accuracy1000: 0.3406 - 68s/epoch - 109ms/step
Epoch 5/50
618/618 - 68s - loss: 3.1627 - accuracy1000: 0.4463 - val_loss: 3.6075 - val_accuracy1000: 0.3477 - 68s/epoch - 109ms/step
Epoch 6/50
618/618 - 65s - loss: 3.1386 - accuracy1000: 0.4552 - val_loss: 3.5312 - val_accuracy1000: 0.3508 - 65s/epoch - 105ms/step
Epoch 7/50
618/618 - 70s - loss: 3.1221 - accuracy1000: 0.4605 - val_loss: 3.5905 - val_accuracy1000: 0.3453 - 70s/epoch - 113ms/step
Epoch 8/50
618/618 - 70s - loss: 3.1077 - accuracy1000: 0.4661 - val_loss: 3.6920 - val_accuracy1000: 0.3481 - 70s/epoch - 114ms/step
Epoch 9/50
618/618 - 69s - loss: 3.0908 - accuracy1000: 0.4695 - val_loss: 3.6797 - val_accuracy1000: 0.3493 - 69s/epoch - 112ms/step
Epoch 10/50
618/618 - 67s - loss: 3.0713 - accuracy1000: 0.4754 - val_loss: 3.7912 - val_accuracy1000: 0.3484 - 67s/epoch - 109ms/step
Epoch 11/50
618/618 - 71s - loss: 3.0580 - accuracy1000: 0.4796 - val_loss: 3.7812 - val_accuracy1000: 0.3481 - 71s/epoch - 115ms/step
Epoch 12/50
618/618 - 70s - loss: 3.0427 - accuracy1000: 0.4840 - val_loss: 3.7714 - val_accuracy1000: 0.3467 - 70s/epoch - 114ms/step
testing model: results/PCAR/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
1722/1722 - 84s - 84s/epoch - 49ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1609106
{'0': {'precision': 0.32185074463124985, 'recall': 0.16380970993048383, 'f1-score': 0.21711579200547645, 'support': 143276}, '1': {'precision': 0.3007910850681557, 'recall': 0.7581001107250582, 'f1-score': 0.43069534585083125, 'support': 130955}, '2': {'precision': 0.3853373519458545, 'recall': 0.0875018010662312, 'f1-score': 0.1426181063838115, 'support': 166568}, 'accuracy': 0.3115297448496934, 'macro avg': {'precision': 0.33599306054842004, 'recall': 0.3364705405739244, 'f1-score': 0.2634764147467064, 'support': 440799}, 'weighted avg': {'precision': 0.33958438170641125, 'recall': 0.3115297448496934, 'f1-score': 0.2524161896361175, 'support': 440799}}
[[ 23470 107423  12383]
 [ 20812  99277  10866]
 [ 28640 123353  14575]]
Evaluating performance on  train set...
618/618 - 33s - 33s/epoch - 54ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525334
{'0': {'precision': 0.3479523671216962, 'recall': 0.06569303039719242, 'f1-score': 0.11052000369015037, 'support': 54709}, '1': {'precision': 0.3290180752320469, 'recall': 0.5055707004859548, 'f1-score': 0.3986200236745374, 'support': 50622}, '2': {'precision': 0.35049686417136805, 'recall': 0.46516666033218046, 'f1-score': 0.39977135391148133, 'support': 52622}, 'accuracy': 0.3397529644894367, 'macro avg': {'precision': 0.3424891021750371, 'recall': 0.34547679707177587, 'f1-score': 0.3029704604253897, 'support': 157953}, 'weighted avg': {'precision': 0.34273185722134614, 'recall': 0.3397529644894367, 'f1-score': 0.2992165385011164, 'support': 157953}}
[[ 3594 27253 23862]
 [ 3531 25593 21498]
 [ 3204 24940 24478]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 45ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1589397
{'0': {'precision': 0.332870627429206, 'recall': 0.060835151453650614, 'f1-score': 0.10286988975161941, 'support': 19709}, '1': {'precision': 0.31599173553719007, 'recall': 0.4350571769926609, 'f1-score': 0.36608660267611365, 'support': 17577}, '2': {'precision': 0.3527863985966806, 'recall': 0.51875, 'f1-score': 0.41996626776965706, 'support': 20160}, 'accuracy': 0.3360373220067542, 'macro avg': {'precision': 0.3338829205210256, 'recall': 0.33821410948210384, 'f1-score': 0.2963075867324634, 'support': 57446}, 'weighted avg': {'precision': 0.3346953265196618, 'recall': 0.3360373220067542, 'f1-score': 0.29468869600301156, 'support': 57446}}
[[ 1199  8097 10413]
 [ 1157  7647  8773]
 [ 1246  8456 10458]]
training model: results/PCAR/W6/deepOF_L2/h10
Epoch 1/50
617/617 - 58s - loss: 3.2506 - accuracy10: 0.3994 - val_loss: 3.2114 - val_accuracy10: 0.4254 - 58s/epoch - 94ms/step
Epoch 2/50
617/617 - 50s - loss: 3.1661 - accuracy10: 0.4409 - val_loss: 3.1814 - val_accuracy10: 0.4398 - 50s/epoch - 80ms/step
Epoch 3/50
617/617 - 51s - loss: 3.1276 - accuracy10: 0.4554 - val_loss: 3.1599 - val_accuracy10: 0.4471 - 51s/epoch - 83ms/step
Epoch 4/50
617/617 - 52s - loss: 3.1020 - accuracy10: 0.4653 - val_loss: 3.1453 - val_accuracy10: 0.4548 - 52s/epoch - 84ms/step
Epoch 5/50
617/617 - 53s - loss: 3.0810 - accuracy10: 0.4734 - val_loss: 3.1308 - val_accuracy10: 0.4593 - 53s/epoch - 85ms/step
Epoch 6/50
617/617 - 51s - loss: 3.0644 - accuracy10: 0.4795 - val_loss: 3.1173 - val_accuracy10: 0.4635 - 51s/epoch - 82ms/step
Epoch 7/50
617/617 - 54s - loss: 3.0507 - accuracy10: 0.4834 - val_loss: 3.1091 - val_accuracy10: 0.4670 - 54s/epoch - 88ms/step
Epoch 8/50
617/617 - 49s - loss: 3.0380 - accuracy10: 0.4872 - val_loss: 3.0969 - val_accuracy10: 0.4704 - 49s/epoch - 80ms/step
Epoch 9/50
617/617 - 52s - loss: 3.0259 - accuracy10: 0.4901 - val_loss: 3.0925 - val_accuracy10: 0.4729 - 52s/epoch - 84ms/step
Epoch 10/50
617/617 - 52s - loss: 3.0164 - accuracy10: 0.4954 - val_loss: 3.0888 - val_accuracy10: 0.4733 - 52s/epoch - 84ms/step
Epoch 11/50
617/617 - 52s - loss: 3.0067 - accuracy10: 0.4958 - val_loss: 3.0819 - val_accuracy10: 0.4767 - 52s/epoch - 84ms/step
Epoch 12/50
617/617 - 50s - loss: 2.9996 - accuracy10: 0.4986 - val_loss: 3.0794 - val_accuracy10: 0.4768 - 50s/epoch - 81ms/step
Epoch 13/50
617/617 - 49s - loss: 2.9890 - accuracy10: 0.5022 - val_loss: 3.0777 - val_accuracy10: 0.4765 - 49s/epoch - 79ms/step
Epoch 14/50
617/617 - 52s - loss: 2.9816 - accuracy10: 0.5042 - val_loss: 3.0757 - val_accuracy10: 0.4787 - 52s/epoch - 84ms/step
Epoch 15/50
617/617 - 51s - loss: 2.9752 - accuracy10: 0.5058 - val_loss: 3.0713 - val_accuracy10: 0.4799 - 51s/epoch - 83ms/step
Epoch 16/50
617/617 - 52s - loss: 2.9653 - accuracy10: 0.5085 - val_loss: 3.0696 - val_accuracy10: 0.4799 - 52s/epoch - 85ms/step
Epoch 17/50
617/617 - 48s - loss: 2.9604 - accuracy10: 0.5105 - val_loss: 3.0717 - val_accuracy10: 0.4782 - 48s/epoch - 78ms/step
Epoch 18/50
617/617 - 51s - loss: 2.9532 - accuracy10: 0.5124 - val_loss: 3.0746 - val_accuracy10: 0.4769 - 51s/epoch - 82ms/step
Epoch 19/50
617/617 - 53s - loss: 2.9462 - accuracy10: 0.5148 - val_loss: 3.0738 - val_accuracy10: 0.4784 - 53s/epoch - 86ms/step
Epoch 20/50
617/617 - 51s - loss: 2.9389 - accuracy10: 0.5174 - val_loss: 3.0742 - val_accuracy10: 0.4787 - 51s/epoch - 82ms/step
Epoch 21/50
617/617 - 52s - loss: 2.9327 - accuracy10: 0.5178 - val_loss: 3.0750 - val_accuracy10: 0.4801 - 52s/epoch - 84ms/step
Epoch 22/50
617/617 - 49s - loss: 2.9267 - accuracy10: 0.5205 - val_loss: 3.0762 - val_accuracy10: 0.4773 - 49s/epoch - 79ms/step
Epoch 23/50
617/617 - 53s - loss: 2.9201 - accuracy10: 0.5232 - val_loss: 3.0779 - val_accuracy10: 0.4778 - 53s/epoch - 85ms/step
Epoch 24/50
617/617 - 53s - loss: 2.9111 - accuracy10: 0.5255 - val_loss: 3.0773 - val_accuracy10: 0.4788 - 53s/epoch - 86ms/step
Epoch 25/50
617/617 - 48s - loss: 2.9074 - accuracy10: 0.5258 - val_loss: 3.0859 - val_accuracy10: 0.4761 - 48s/epoch - 77ms/step
Epoch 26/50
617/617 - 51s - loss: 2.8984 - accuracy10: 0.5282 - val_loss: 3.0873 - val_accuracy10: 0.4771 - 51s/epoch - 83ms/step
testing model: results/PCAR/W6/deepOF_L2/h10
Evaluating performance on  test set...
1722/1722 - 61s - 61s/epoch - 35ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0478497
{'0': {'precision': 0.49153851980910535, 'recall': 0.40370557017625724, 'f1-score': 0.44331337257165887, 'support': 160731}, '1': {'precision': 0.3677350269551732, 'recall': 0.5152450591522092, 'f1-score': 0.4291685819351873, 'support': 115972}, '2': {'precision': 0.49959669701692505, 'recall': 0.4454052934042696, 'f1-score': 0.4709471846074044, 'support': 164091}, 'accuracy': 0.448574617621837, 'macro avg': {'precision': 0.4529567479270678, 'recall': 0.4547853075775787, 'f1-score': 0.44780971303808353, 'support': 440794}, 'weighted avg': {'precision': 0.4619658298064105, 'recall': 0.448574617621837, 'f1-score': 0.44987893424233644, 'support': 440794}}
[[64888 51505 44338]
 [27351 59754 28867]
 [39771 51233 73087]]
Evaluating performance on  train set...
617/617 - 24s - 24s/epoch - 39ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99658245
{'0': {'precision': 0.5199003760316453, 'recall': 0.41071738585289636, 'f1-score': 0.45890403577778976, 'support': 51841}, '1': {'precision': 0.4881315956578271, 'recall': 0.60180059274171, 'f1-score': 0.5390388259552054, 'support': 53649}, '2': {'precision': 0.5049748308950763, 'recall': 0.48951622126491556, 'f1-score': 0.4971253798950812, 'support': 52462}, 'accuracy': 0.5017916835494327, 'macro avg': {'precision': 0.5043356008615162, 'recall': 0.5006780666198406, 'f1-score': 0.4983560805426921, 'support': 157952}, 'weighted avg': {'precision': 0.504152634646733, 'recall': 0.5017916835494327, 'f1-score': 0.4988169176236006, 'support': 157952}}
[[21292 17375 13174]
 [ 9362 32286 12001]
 [10300 16481 25681]]
Evaluating performance on  val set...
225/225 - 9s - 9s/epoch - 40ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0230786
{'0': {'precision': 0.48182852553376615, 'recall': 0.3879398609689066, 'f1-score': 0.42981670547495376, 'support': 18557}, '1': {'precision': 0.49040160169591335, 'recall': 0.5980180956484275, 'f1-score': 0.538889607868513, 'support': 20889}, '2': {'precision': 0.45957371851329926, 'recall': 0.4348574920828935, 'f1-score': 0.44687410790750787, 'support': 17999}, 'accuracy': 0.47903211767777876, 'macro avg': {'precision': 0.4772679485809929, 'recall': 0.47360514956674243, 'f1-score': 0.47186014041699154, 'support': 57445}, 'weighted avg': {'precision': 0.4779729892188512, 'recall': 0.47903211767777876, 'f1-score': 0.4748239305508107, 'support': 57445}}
[[ 7199  6709  4649]
 [ 3842 12492  4555]
 [ 3900  6272  7827]]
training model: results/PCAR/W6/deepOF_L2/h20
Epoch 1/50
617/617 - 56s - loss: 3.2882 - accuracy20: 0.3759 - val_loss: 3.2666 - val_accuracy20: 0.3878 - 56s/epoch - 90ms/step
Epoch 2/50
617/617 - 51s - loss: 3.2300 - accuracy20: 0.4084 - val_loss: 3.2460 - val_accuracy20: 0.3972 - 51s/epoch - 82ms/step
Epoch 3/50
617/617 - 52s - loss: 3.2038 - accuracy20: 0.4195 - val_loss: 3.2345 - val_accuracy20: 0.4064 - 52s/epoch - 84ms/step
Epoch 4/50
617/617 - 53s - loss: 3.1888 - accuracy20: 0.4283 - val_loss: 3.2251 - val_accuracy20: 0.4122 - 53s/epoch - 87ms/step
Epoch 5/50
617/617 - 53s - loss: 3.1759 - accuracy20: 0.4349 - val_loss: 3.2225 - val_accuracy20: 0.4151 - 53s/epoch - 86ms/step
Epoch 6/50
617/617 - 53s - loss: 3.1645 - accuracy20: 0.4385 - val_loss: 3.2139 - val_accuracy20: 0.4195 - 53s/epoch - 86ms/step
Epoch 7/50
617/617 - 50s - loss: 3.1544 - accuracy20: 0.4434 - val_loss: 3.2126 - val_accuracy20: 0.4197 - 50s/epoch - 81ms/step
Epoch 8/50
617/617 - 52s - loss: 3.1441 - accuracy20: 0.4486 - val_loss: 3.2094 - val_accuracy20: 0.4216 - 52s/epoch - 84ms/step
Epoch 9/50
617/617 - 51s - loss: 3.1354 - accuracy20: 0.4515 - val_loss: 3.2084 - val_accuracy20: 0.4222 - 51s/epoch - 82ms/step
Epoch 10/50
617/617 - 48s - loss: 3.1266 - accuracy20: 0.4548 - val_loss: 3.2059 - val_accuracy20: 0.4240 - 48s/epoch - 78ms/step
Epoch 11/50
617/617 - 50s - loss: 3.1193 - accuracy20: 0.4569 - val_loss: 3.2027 - val_accuracy20: 0.4283 - 50s/epoch - 81ms/step
Epoch 12/50
617/617 - 50s - loss: 3.1135 - accuracy20: 0.4598 - val_loss: 3.2042 - val_accuracy20: 0.4274 - 50s/epoch - 82ms/step
Epoch 13/50
617/617 - 48s - loss: 3.1048 - accuracy20: 0.4634 - val_loss: 3.2013 - val_accuracy20: 0.4277 - 48s/epoch - 77ms/step
Epoch 14/50
617/617 - 50s - loss: 3.0969 - accuracy20: 0.4666 - val_loss: 3.1970 - val_accuracy20: 0.4303 - 50s/epoch - 82ms/step
Epoch 15/50
617/617 - 54s - loss: 3.0900 - accuracy20: 0.4680 - val_loss: 3.1990 - val_accuracy20: 0.4291 - 54s/epoch - 88ms/step
Epoch 16/50
617/617 - 54s - loss: 3.0834 - accuracy20: 0.4707 - val_loss: 3.2021 - val_accuracy20: 0.4289 - 54s/epoch - 87ms/step
Epoch 17/50
617/617 - 51s - loss: 3.0756 - accuracy20: 0.4741 - val_loss: 3.2021 - val_accuracy20: 0.4287 - 51s/epoch - 83ms/step
Epoch 18/50
617/617 - 53s - loss: 3.0713 - accuracy20: 0.4749 - val_loss: 3.2077 - val_accuracy20: 0.4286 - 53s/epoch - 86ms/step
Epoch 19/50
617/617 - 51s - loss: 3.0638 - accuracy20: 0.4774 - val_loss: 3.2084 - val_accuracy20: 0.4295 - 51s/epoch - 82ms/step
Epoch 20/50
617/617 - 50s - loss: 3.0574 - accuracy20: 0.4801 - val_loss: 3.2054 - val_accuracy20: 0.4291 - 50s/epoch - 82ms/step
Epoch 21/50
617/617 - 51s - loss: 3.0511 - accuracy20: 0.4817 - val_loss: 3.2067 - val_accuracy20: 0.4304 - 51s/epoch - 82ms/step
Epoch 22/50
617/617 - 52s - loss: 3.0427 - accuracy20: 0.4849 - val_loss: 3.2154 - val_accuracy20: 0.4274 - 52s/epoch - 84ms/step
Epoch 23/50
617/617 - 52s - loss: 3.0384 - accuracy20: 0.4856 - val_loss: 3.2127 - val_accuracy20: 0.4304 - 52s/epoch - 84ms/step
Epoch 24/50
617/617 - 50s - loss: 3.0294 - accuracy20: 0.4896 - val_loss: 3.2263 - val_accuracy20: 0.4272 - 50s/epoch - 81ms/step
testing model: results/PCAR/W6/deepOF_L2/h20
Evaluating performance on  test set...
1722/1722 - 64s - 64s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0851198
{'0': {'precision': 0.46412394636589976, 'recall': 0.3829874132105595, 'f1-score': 0.4196700412956948, 'support': 161598}, '1': {'precision': 0.30179213064421034, 'recall': 0.47575122537199577, 'f1-score': 0.369311819979376, 'support': 114047}, '2': {'precision': 0.48057339808867305, 'recall': 0.3714827216634675, 'f1-score': 0.4190444965830968, 'support': 165149}, 'accuracy': 0.40267789488967637, 'macro avg': {'precision': 0.4154964916995944, 'recall': 0.4100737867486743, 'f1-score': 0.4026754526193892, 'support': 440794}, 'weighted avg': {'precision': 0.4282866933972858, 'recall': 0.40267789488967637, 'f1-score': 0.4064064484377996, 'support': 440794}}
[[61890 61643 38065]
 [31544 54258 28245]
 [39914 63885 61350]]
Evaluating performance on  train set...
617/617 - 25s - 25s/epoch - 41ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0427824
{'0': {'precision': 0.4813002696961741, 'recall': 0.3832601630651691, 'f1-score': 0.42672140166744255, 'support': 52617}, '1': {'precision': 0.41876704699615863, 'recall': 0.5570012156207264, 'f1-score': 0.4780925208885266, 'support': 52648}, '2': {'precision': 0.47564420110372396, 'recall': 0.41551046747774595, 'f1-score': 0.4435484687933706, 'support': 52687}, 'accuracy': 0.4519284339546191, 'macro avg': {'precision': 0.45857050593201887, 'recall': 0.45192394872121383, 'f1-score': 0.44945413044977994, 'support': 157952}, 'weighted avg': {'precision': 0.45857026061340944, 'recall': 0.4519284339546191, 'f1-score': 0.4494571338545336, 'support': 157952}}
[[20166 20348 12103]
 [11292 29325 12031]
 [10441 20354 21892]]
Evaluating performance on  val set...
225/225 - 9s - 9s/epoch - 42ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0671104
{'0': {'precision': 0.4391604844334538, 'recall': 0.3657390294133178, 'f1-score': 0.39910107179900883, 'support': 18937}, '1': {'precision': 0.41492210780430766, 'recall': 0.5522088353413654, 'f1-score': 0.4738213693437574, 'support': 19920}, '2': {'precision': 0.4381718657257799, 'recall': 0.3574349042392942, 'f1-score': 0.39370685313027765, 'support': 18588}, 'accuracy': 0.4277134650535295, 'macro avg': {'precision': 0.4307514859878471, 'recall': 0.42512758966465913, 'f1-score': 0.4222097647576813, 'support': 57445}, 'weighted avg': {'precision': 0.4304355317484362, 'recall': 0.4277134650535295, 'f1-score': 0.4232661094955363, 'support': 57445}}
[[ 6926  7815  4196]
 [ 4597 11000  4323]
 [ 4248  7696  6644]]
training model: results/PCAR/W6/deepOF_L2/h30
Epoch 1/50
617/617 - 54s - loss: 3.2956 - accuracy30: 0.3673 - val_loss: 3.2839 - val_accuracy30: 0.3716 - 54s/epoch - 88ms/step
Epoch 2/50
617/617 - 53s - loss: 3.2470 - accuracy30: 0.3956 - val_loss: 3.2637 - val_accuracy30: 0.3845 - 53s/epoch - 86ms/step
Epoch 3/50
617/617 - 52s - loss: 3.2241 - accuracy30: 0.4077 - val_loss: 3.2536 - val_accuracy30: 0.3922 - 52s/epoch - 84ms/step
Epoch 4/50
617/617 - 47s - loss: 3.2133 - accuracy30: 0.4134 - val_loss: 3.2493 - val_accuracy30: 0.3949 - 47s/epoch - 76ms/step
Epoch 5/50
617/617 - 52s - loss: 3.2018 - accuracy30: 0.4202 - val_loss: 3.2460 - val_accuracy30: 0.3991 - 52s/epoch - 85ms/step
Epoch 6/50
617/617 - 52s - loss: 3.1946 - accuracy30: 0.4240 - val_loss: 3.2437 - val_accuracy30: 0.3991 - 52s/epoch - 84ms/step
Epoch 7/50
617/617 - 52s - loss: 3.1864 - accuracy30: 0.4276 - val_loss: 3.2401 - val_accuracy30: 0.4025 - 52s/epoch - 85ms/step
Epoch 8/50
617/617 - 52s - loss: 3.1791 - accuracy30: 0.4302 - val_loss: 3.2400 - val_accuracy30: 0.4027 - 52s/epoch - 84ms/step
Epoch 9/50
617/617 - 49s - loss: 3.1718 - accuracy30: 0.4335 - val_loss: 3.2413 - val_accuracy30: 0.4007 - 49s/epoch - 79ms/step
Epoch 10/50
617/617 - 52s - loss: 3.1649 - accuracy30: 0.4370 - val_loss: 3.2396 - val_accuracy30: 0.4036 - 52s/epoch - 83ms/step
Epoch 11/50
617/617 - 51s - loss: 3.1595 - accuracy30: 0.4411 - val_loss: 3.2400 - val_accuracy30: 0.4024 - 51s/epoch - 83ms/step
Epoch 12/50
617/617 - 52s - loss: 3.1542 - accuracy30: 0.4428 - val_loss: 3.2426 - val_accuracy30: 0.4043 - 52s/epoch - 84ms/step
Epoch 13/50
617/617 - 52s - loss: 3.1461 - accuracy30: 0.4461 - val_loss: 3.2444 - val_accuracy30: 0.4040 - 52s/epoch - 84ms/step
Epoch 14/50
617/617 - 50s - loss: 3.1402 - accuracy30: 0.4501 - val_loss: 3.2438 - val_accuracy30: 0.4049 - 50s/epoch - 80ms/step
Epoch 15/50
617/617 - 51s - loss: 3.1358 - accuracy30: 0.4490 - val_loss: 3.2473 - val_accuracy30: 0.4045 - 51s/epoch - 83ms/step
Epoch 16/50
617/617 - 53s - loss: 3.1297 - accuracy30: 0.4531 - val_loss: 3.2518 - val_accuracy30: 0.4031 - 53s/epoch - 85ms/step
Epoch 17/50
617/617 - 49s - loss: 3.1227 - accuracy30: 0.4549 - val_loss: 3.2518 - val_accuracy30: 0.4037 - 49s/epoch - 80ms/step
Epoch 18/50
617/617 - 53s - loss: 3.1163 - accuracy30: 0.4579 - val_loss: 3.2558 - val_accuracy30: 0.4018 - 53s/epoch - 87ms/step
Epoch 19/50
617/617 - 55s - loss: 3.1098 - accuracy30: 0.4617 - val_loss: 3.2529 - val_accuracy30: 0.4040 - 55s/epoch - 89ms/step
Epoch 20/50
617/617 - 50s - loss: 3.1044 - accuracy30: 0.4633 - val_loss: 3.2556 - val_accuracy30: 0.4063 - 50s/epoch - 82ms/step
testing model: results/PCAR/W6/deepOF_L2/h30
Evaluating performance on  test set...
1722/1722 - 62s - 62s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941365
{'0': {'precision': 0.4457599712540424, 'recall': 0.31395797612193377, 'f1-score': 0.3684259372691398, 'support': 158053}, '1': {'precision': 0.2942891487499605, 'recall': 0.45745404479556795, 'f1-score': 0.3581642310592085, 'support': 122021}, '2': {'precision': 0.45216022889842633, 'recall': 0.3933051269288203, 'f1-score': 0.42068414747770533, 'support': 160720}, 'accuracy': 0.3826118322844685, 'macro avg': {'precision': 0.39740311630080977, 'recall': 0.38823904928210734, 'f1-score': 0.38242477193535124, 'support': 440794}, 'weighted avg': {'precision': 0.4061633074515288, 'recall': 0.3826118322844685, 'f1-score': 0.38463939727830193, 'support': 440794}}
[[49622 67825 40606]
 [30220 55819 35982]
 [31478 66030 63212]]
Evaluating performance on  train set...
617/617 - 24s - 24s/epoch - 40ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0682044
{'0': {'precision': 0.46363041561175433, 'recall': 0.3089961133756754, 'f1-score': 0.3708389269380418, 'support': 52745}, '1': {'precision': 0.38549275919518133, 'recall': 0.5178964283664607, 'f1-score': 0.4419918367346939, 'support': 52273}, '2': {'precision': 0.43928326866012324, 'recall': 0.43627914006120827, 'f1-score': 0.4377760506511478, 'support': 52934}, 'accuracy': 0.42078606158833065, 'macro avg': {'precision': 0.4294688144890196, 'recall': 0.42105722726778144, 'f1-score': 0.4168689381079611, 'support': 157952}, 'weighted avg': {'precision': 0.4296119695610481, 'recall': 0.42078606158833065, 'f1-score': 0.41681888135729545, 'support': 157952}}
[[16298 22209 14238]
 [ 9961 27072 15240]
 [ 8894 20946 23094]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.080835
{'0': {'precision': 0.432743757431629, 'recall': 0.30437509800846796, 'f1-score': 0.3573817780096358, 'support': 19131}, '1': {'precision': 0.37724461105904405, 'recall': 0.515998359142652, 'f1-score': 0.43584468458323405, 'support': 19502}, '2': {'precision': 0.4209310384659813, 'recall': 0.38741229002764194, 'f1-score': 0.4034767203676023, 'support': 18812}, 'accuracy': 0.40341195926538426, 'macro avg': {'precision': 0.4103064689855514, 'recall': 0.40259524905958727, 'f1-score': 0.398901060986824, 'support': 57445}, 'weighted avg': {'precision': 0.4100339441887024, 'recall': 0.40341195926538426, 'f1-score': 0.39911424662546624, 'support': 57445}}
[[ 5823  8645  4663]
 [ 4076 10063  5363]
 [ 3557  7967  7288]]
training model: results/PCAR/W6/deepOF_L2/h50
Epoch 1/50
617/617 - 57s - loss: 3.2827 - accuracy50: 0.3779 - val_loss: 3.3024 - val_accuracy50: 0.3591 - 57s/epoch - 92ms/step
Epoch 2/50
617/617 - 49s - loss: 3.2456 - accuracy50: 0.3957 - val_loss: 3.2821 - val_accuracy50: 0.3711 - 49s/epoch - 80ms/step
Epoch 3/50
617/617 - 51s - loss: 3.2278 - accuracy50: 0.4043 - val_loss: 3.2738 - val_accuracy50: 0.3775 - 51s/epoch - 83ms/step
Epoch 4/50
617/617 - 51s - loss: 3.2186 - accuracy50: 0.4075 - val_loss: 3.2712 - val_accuracy50: 0.3782 - 51s/epoch - 83ms/step
Epoch 5/50
617/617 - 52s - loss: 3.2089 - accuracy50: 0.4134 - val_loss: 3.2683 - val_accuracy50: 0.3816 - 52s/epoch - 84ms/step
Epoch 6/50
617/617 - 52s - loss: 3.2029 - accuracy50: 0.4150 - val_loss: 3.2650 - val_accuracy50: 0.3838 - 52s/epoch - 85ms/step
Epoch 7/50
617/617 - 53s - loss: 3.1965 - accuracy50: 0.4196 - val_loss: 3.2640 - val_accuracy50: 0.3832 - 53s/epoch - 85ms/step
Epoch 8/50
617/617 - 53s - loss: 3.1901 - accuracy50: 0.4215 - val_loss: 3.2647 - val_accuracy50: 0.3850 - 53s/epoch - 86ms/step
Epoch 9/50
617/617 - 52s - loss: 3.1848 - accuracy50: 0.4245 - val_loss: 3.2614 - val_accuracy50: 0.3879 - 52s/epoch - 85ms/step
Epoch 10/50
617/617 - 51s - loss: 3.1792 - accuracy50: 0.4270 - val_loss: 3.2624 - val_accuracy50: 0.3871 - 51s/epoch - 83ms/step
Epoch 11/50
617/617 - 51s - loss: 3.1736 - accuracy50: 0.4289 - val_loss: 3.2649 - val_accuracy50: 0.3855 - 51s/epoch - 83ms/step
Epoch 12/50
617/617 - 50s - loss: 3.1686 - accuracy50: 0.4327 - val_loss: 3.2657 - val_accuracy50: 0.3853 - 50s/epoch - 81ms/step
Epoch 13/50
617/617 - 54s - loss: 3.1623 - accuracy50: 0.4355 - val_loss: 3.2693 - val_accuracy50: 0.3854 - 54s/epoch - 88ms/step
Epoch 14/50
617/617 - 53s - loss: 3.1565 - accuracy50: 0.4377 - val_loss: 3.2691 - val_accuracy50: 0.3863 - 53s/epoch - 86ms/step
Epoch 15/50
617/617 - 48s - loss: 3.1522 - accuracy50: 0.4392 - val_loss: 3.2675 - val_accuracy50: 0.3879 - 48s/epoch - 78ms/step
Epoch 16/50
617/617 - 52s - loss: 3.1463 - accuracy50: 0.4421 - val_loss: 3.2722 - val_accuracy50: 0.3877 - 52s/epoch - 84ms/step
Epoch 17/50
617/617 - 52s - loss: 3.1393 - accuracy50: 0.4449 - val_loss: 3.2757 - val_accuracy50: 0.3866 - 52s/epoch - 84ms/step
Epoch 18/50
617/617 - 53s - loss: 3.1354 - accuracy50: 0.4467 - val_loss: 3.2736 - val_accuracy50: 0.3888 - 53s/epoch - 85ms/step
Epoch 19/50
617/617 - 51s - loss: 3.1294 - accuracy50: 0.4488 - val_loss: 3.2795 - val_accuracy50: 0.3881 - 51s/epoch - 82ms/step
testing model: results/PCAR/W6/deepOF_L2/h50
Evaluating performance on  test set...
1722/1722 - 69s - 69s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799956
{'0': {'precision': 0.408614899246896, 'recall': 0.5201852691585153, 'f1-score': 0.4576989939867195, 'support': 154370}, '1': {'precision': 0.35015994881637874, 'recall': 0.0844748682250708, 'f1-score': 0.1361129590827981, 'support': 129577}, '2': {'precision': 0.4154609556179406, 'recall': 0.5642377603651967, 'f1-score': 0.47855275360202887, 'support': 156847}, 'accuracy': 0.40777778281918536, 'macro avg': {'precision': 0.3914119345604051, 'recall': 0.3896326325829276, 'f1-score': 0.35745490222384885, 'support': 440794}, 'weighted avg': {'precision': 0.3938673443611536, 'recall': 0.40777778281918536, 'f1-score': 0.37058504958102656, 'support': 440794}}
[[80301 10166 63903]
 [58019 10946 60612]
 [58200 10148 88499]]
Evaluating performance on  train set...
617/617 - 24s - 24s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744885
{'0': {'precision': 0.4124624770020335, 'recall': 0.48686491532204296, 'f1-score': 0.4465859944956533, 'support': 52493}, '1': {'precision': 0.4478258485496518, 'recall': 0.15487161982781508, 'f1-score': 0.23015034309788507, 'support': 52734}, '2': {'precision': 0.39688500765243784, 'recall': 0.5852821242294927, 'f1-score': 0.47301460782660676, 'support': 52725}, 'accuracy': 0.4088773804700162, 'macro avg': {'precision': 0.41905777773470776, 'recall': 0.40900621979311697, 'f1-score': 0.38325031514004837, 'support': 157952}, 'weighted avg': {'precision': 0.419069104102258, 'recall': 0.4088773804700162, 'f1-score': 0.3831485641184793, 'support': 157952}}
[[25557  5046 21890]
 [19563  8167 25004]
 [16842  5024 30859]]
Evaluating performance on  val set...
225/225 - 9s - 9s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875818
{'0': {'precision': 0.3860995850622407, 'recall': 0.4914958799915487, 'f1-score': 0.4324688603829708, 'support': 18932}, '1': {'precision': 0.3832150570811478, 'recall': 0.12824616655480406, 'f1-score': 0.192178252291981, 'support': 19369}, '2': {'precision': 0.3849905073893459, 'recall': 0.5402214793146678, 'f1-score': 0.4495837589931967, 'support': 19144}, 'accuracy': 0.38525546174601794, 'macro avg': {'precision': 0.38476838317757817, 'recall': 0.3866545086203402, 'f1-score': 0.3580769572227161, 'support': 57445}, 'weighted avg': {'precision': 0.384757386342845, 'recall': 0.38525546174601794, 'f1-score': 0.3571526245204899, 'support': 57445}}
[[ 9305  2003  7624]
 [ 7988  2484  8897]
 [ 6807  1995 10342]]
training model: results/PCAR/W6/deepOF_L2/h100
Epoch 1/50
617/617 - 56s - loss: 3.3141 - accuracy100: 0.3539 - val_loss: 3.3060 - val_accuracy100: 0.3467 - 56s/epoch - 90ms/step
Epoch 2/50
617/617 - 51s - loss: 3.2802 - accuracy100: 0.3681 - val_loss: 3.2934 - val_accuracy100: 0.3528 - 51s/epoch - 82ms/step
Epoch 3/50
617/617 - 52s - loss: 3.2642 - accuracy100: 0.3778 - val_loss: 3.2897 - val_accuracy100: 0.3565 - 52s/epoch - 84ms/step
Epoch 4/50
617/617 - 53s - loss: 3.2534 - accuracy100: 0.3869 - val_loss: 3.2857 - val_accuracy100: 0.3600 - 53s/epoch - 86ms/step
Epoch 5/50
617/617 - 52s - loss: 3.2462 - accuracy100: 0.3913 - val_loss: 3.2850 - val_accuracy100: 0.3621 - 52s/epoch - 84ms/step
Epoch 6/50
617/617 - 51s - loss: 3.2390 - accuracy100: 0.3964 - val_loss: 3.2853 - val_accuracy100: 0.3646 - 51s/epoch - 83ms/step
Epoch 7/50
617/617 - 53s - loss: 3.2333 - accuracy100: 0.4002 - val_loss: 3.2818 - val_accuracy100: 0.3657 - 53s/epoch - 87ms/step
Epoch 8/50
617/617 - 51s - loss: 3.2276 - accuracy100: 0.4033 - val_loss: 3.2848 - val_accuracy100: 0.3649 - 51s/epoch - 82ms/step
Epoch 9/50
617/617 - 53s - loss: 3.2224 - accuracy100: 0.4065 - val_loss: 3.2864 - val_accuracy100: 0.3640 - 53s/epoch - 86ms/step
Epoch 10/50
617/617 - 51s - loss: 3.2167 - accuracy100: 0.4090 - val_loss: 3.2885 - val_accuracy100: 0.3633 - 51s/epoch - 83ms/step
Epoch 11/50
617/617 - 52s - loss: 3.2140 - accuracy100: 0.4104 - val_loss: 3.2908 - val_accuracy100: 0.3626 - 52s/epoch - 84ms/step
Epoch 12/50
617/617 - 51s - loss: 3.2088 - accuracy100: 0.4138 - val_loss: 3.2878 - val_accuracy100: 0.3638 - 51s/epoch - 83ms/step
Epoch 13/50
617/617 - 52s - loss: 3.2039 - accuracy100: 0.4172 - val_loss: 3.2911 - val_accuracy100: 0.3607 - 52s/epoch - 84ms/step
Epoch 14/50
617/617 - 53s - loss: 3.2001 - accuracy100: 0.4186 - val_loss: 3.2920 - val_accuracy100: 0.3617 - 53s/epoch - 85ms/step
Epoch 15/50
617/617 - 55s - loss: 3.1967 - accuracy100: 0.4211 - val_loss: 3.2924 - val_accuracy100: 0.3620 - 55s/epoch - 89ms/step
Epoch 16/50
617/617 - 53s - loss: 3.1921 - accuracy100: 0.4229 - val_loss: 3.2964 - val_accuracy100: 0.3636 - 53s/epoch - 86ms/step
Epoch 17/50
617/617 - 52s - loss: 3.1869 - accuracy100: 0.4261 - val_loss: 3.2984 - val_accuracy100: 0.3598 - 52s/epoch - 85ms/step
testing model: results/PCAR/W6/deepOF_L2/h100
Evaluating performance on  test set...
1722/1722 - 66s - 66s/epoch - 38ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976214
{'0': {'precision': 0.4086624698664412, 'recall': 0.22505001950446085, 'f1-score': 0.29025622299312276, 'support': 158938}, '1': {'precision': 0.2938272968752354, 'recall': 0.48259026506342056, 'f1-score': 0.36526271437711644, 'support': 121254}, '2': {'precision': 0.40779023592618546, 'recall': 0.39132140322038333, 'f1-score': 0.39938611709530436, 'support': 160602}, 'accuracy': 0.3564749066457347, 'macro avg': {'precision': 0.3700933342226207, 'recall': 0.3663205625960882, 'f1-score': 0.3516350181551812, 'support': 440794}, 'weighted avg': {'precision': 0.3767557139188816, 'recall': 0.3564749066457347, 'f1-score': 0.35065023098523096, 'support': 440794}}
[[35769 71472 51697]
 [23166 58516 39572]
 [28592 69163 62847]]
Evaluating performance on  train set...
617/617 - 22s - 22s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0855824
{'0': {'precision': 0.4196751231976638, 'recall': 0.21596288226012472, 'f1-score': 0.28517567684885464, 'support': 53236}, '1': {'precision': 0.36756962590438175, 'recall': 0.5409170837278506, 'f1-score': 0.43770522563092223, 'support': 51751}, '2': {'precision': 0.3905330882352941, 'recall': 0.4011139431700179, 'f1-score': 0.39575280584920597, 'support': 52965}, 'accuracy': 0.3845155490275527, 'macro avg': {'precision': 0.3925926124457799, 'recall': 0.38599796971933104, 'f1-score': 0.3728779027763276, 'support': 157952}, 'weighted avg': {'precision': 0.39283140186329285, 'recall': 0.3845155490275527, 'f1-score': 0.3722291761177743, 'support': 157952}}
[[11497 24493 17246]
 [ 7849 27993 15909]
 [ 8049 23671 21245]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0950572
{'0': {'precision': 0.3862578702436354, 'recall': 0.22158823221483537, 'f1-score': 0.2816179894883907, 'support': 19103}, '1': {'precision': 0.3485686288234059, 'recall': 0.525926708205724, 'f1-score': 0.4192625021047315, 'support': 18938}, '2': {'precision': 0.3795779365788298, 'recall': 0.3503916718202432, 'f1-score': 0.36440132918855184, 'support': 19404}, 'accuracy': 0.3654278005048307, 'macro avg': {'precision': 0.37146814521529037, 'recall': 0.3659688707469342, 'f1-score': 0.35509394026055796, 'support': 57445}, 'weighted avg': {'precision': 0.3715764134267115, 'recall': 0.3654278005048307, 'f1-score': 0.3549583968949568, 'support': 57445}}
[[4233 9316 5554]
 [3419 9960 5559]
 [3307 9298 6799]]
training model: results/PCAR/W6/deepOF_L2/h200
Epoch 1/50
617/617 - 60s - loss: 3.3193 - accuracy200: 0.3520 - val_loss: 3.3080 - val_accuracy200: 0.3477 - 60s/epoch - 97ms/step
Epoch 2/50
617/617 - 51s - loss: 3.2878 - accuracy200: 0.3609 - val_loss: 3.3010 - val_accuracy200: 0.3513 - 51s/epoch - 83ms/step
Epoch 3/50
617/617 - 53s - loss: 3.2708 - accuracy200: 0.3705 - val_loss: 3.2941 - val_accuracy200: 0.3574 - 53s/epoch - 85ms/step
Epoch 4/50
617/617 - 54s - loss: 3.2581 - accuracy200: 0.3805 - val_loss: 3.2928 - val_accuracy200: 0.3585 - 54s/epoch - 87ms/step
Epoch 5/50
617/617 - 53s - loss: 3.2488 - accuracy200: 0.3874 - val_loss: 3.2921 - val_accuracy200: 0.3612 - 53s/epoch - 85ms/step
Epoch 6/50
617/617 - 53s - loss: 3.2404 - accuracy200: 0.3922 - val_loss: 3.2945 - val_accuracy200: 0.3617 - 53s/epoch - 86ms/step
Epoch 7/50
617/617 - 54s - loss: 3.2338 - accuracy200: 0.3964 - val_loss: 3.2979 - val_accuracy200: 0.3610 - 54s/epoch - 87ms/step
Epoch 8/50
617/617 - 53s - loss: 3.2268 - accuracy200: 0.4001 - val_loss: 3.2986 - val_accuracy200: 0.3641 - 53s/epoch - 86ms/step
Epoch 9/50
617/617 - 51s - loss: 3.2214 - accuracy200: 0.4039 - val_loss: 3.3046 - val_accuracy200: 0.3621 - 51s/epoch - 83ms/step
Epoch 10/50
617/617 - 53s - loss: 3.2165 - accuracy200: 0.4073 - val_loss: 3.3059 - val_accuracy200: 0.3617 - 53s/epoch - 86ms/step
Epoch 11/50
617/617 - 51s - loss: 3.2130 - accuracy200: 0.4095 - val_loss: 3.3118 - val_accuracy200: 0.3617 - 51s/epoch - 82ms/step
Epoch 12/50
617/617 - 53s - loss: 3.2083 - accuracy200: 0.4109 - val_loss: 3.3077 - val_accuracy200: 0.3627 - 53s/epoch - 86ms/step
Epoch 13/50
617/617 - 53s - loss: 3.2042 - accuracy200: 0.4123 - val_loss: 3.3073 - val_accuracy200: 0.3628 - 53s/epoch - 86ms/step
Epoch 14/50
617/617 - 55s - loss: 3.2004 - accuracy200: 0.4158 - val_loss: 3.3098 - val_accuracy200: 0.3612 - 55s/epoch - 90ms/step
Epoch 15/50
617/617 - 54s - loss: 3.1958 - accuracy200: 0.4187 - val_loss: 3.3114 - val_accuracy200: 0.3635 - 54s/epoch - 88ms/step
testing model: results/PCAR/W6/deepOF_L2/h200
Evaluating performance on  test set...
1722/1722 - 67s - 67s/epoch - 39ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979145
{'0': {'precision': 0.37341492185196107, 'recall': 0.09944697143231127, 'f1-score': 0.1570648157240538, 'support': 152795}, '1': {'precision': 0.3247372736081091, 'recall': 0.5461610780319649, 'f1-score': 0.40730094183084437, 'support': 127640}, '2': {'precision': 0.39201315860432506, 'recall': 0.45330165441291104, 'f1-score': 0.4204355835495056, 'support': 160359}, 'accuracy': 0.3575320898197344, 'macro avg': {'precision': 0.36338845135479847, 'recall': 0.36630323462572906, 'f1-score': 0.32826711370146794, 'support': 440794}, 'weighted avg': {'precision': 0.36608537477447606, 'recall': 0.3575320898197344, 'f1-score': 0.3253384585004808, 'support': 440794}}
[[15195 72163 65437]
 [10626 69712 47302]
 [14871 72797 72691]]
Evaluating performance on  train set...
617/617 - 27s - 27s/epoch - 44ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0900851
{'0': {'precision': 0.3972733971997052, 'recall': 0.10132887243200571, 'f1-score': 0.16147245143995329, 'support': 53203}, '1': {'precision': 0.37230820004478965, 'recall': 0.6057648051549555, 'f1-score': 0.461174581158521, 'support': 52144}, '2': {'precision': 0.3698123981794058, 'recall': 0.418572379051421, 'f1-score': 0.39268453622955796, 'support': 52605}, 'accuracy': 0.37351220623987036, 'macro avg': {'precision': 0.3797979984746336, 'recall': 0.3752220188794608, 'f1-score': 0.33844385627601076, 'support': 157952}, 'weighted avg': {'precision': 0.37988601942728856, 'recall': 0.37351220623987036, 'f1-score': 0.33741564666636475, 'support': 157952}}
[[ 5391 27043 20769]
 [ 3804 31587 16753]
 [ 4375 26211 22019]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 44ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098028
{'0': {'precision': 0.36951754385964913, 'recall': 0.1062421185372005, 'f1-score': 0.16503428011753185, 'support': 19032}, '1': {'precision': 0.3595916550057245, 'recall': 0.594854797979798, 'f1-score': 0.4482280187108539, 'support': 19008}, '2': {'precision': 0.3625115689999513, 'recall': 0.3835094047925792, 'f1-score': 0.37271497971653234, 'support': 19405}, 'accuracy': 0.3615806423535556, 'macro avg': {'precision': 0.36387358928844166, 'recall': 0.36153544043652586, 'f1-score': 0.328659092848306, 'support': 57445}, 'weighted avg': {'precision': 0.36386653441604505, 'recall': 0.3615806423535556, 'f1-score': 0.3288952002829156, 'support': 57445}}
[[ 2022 10010  7000]
 [ 1614 11307  6087]
 [ 1836 10127  7442]]
training model: results/PCAR/W6/deepOF_L2/h300
Epoch 1/50
617/617 - 53s - loss: 3.3208 - accuracy300: 0.3523 - val_loss: 3.3092 - val_accuracy300: 0.3433 - 53s/epoch - 86ms/step
Epoch 2/50
617/617 - 49s - loss: 3.2910 - accuracy300: 0.3608 - val_loss: 3.3032 - val_accuracy300: 0.3457 - 49s/epoch - 80ms/step
Epoch 3/50
617/617 - 51s - loss: 3.2776 - accuracy300: 0.3646 - val_loss: 3.2998 - val_accuracy300: 0.3499 - 51s/epoch - 82ms/step
Epoch 4/50
617/617 - 50s - loss: 3.2695 - accuracy300: 0.3690 - val_loss: 3.2971 - val_accuracy300: 0.3513 - 50s/epoch - 81ms/step
Epoch 5/50
617/617 - 49s - loss: 3.2618 - accuracy300: 0.3750 - val_loss: 3.2977 - val_accuracy300: 0.3536 - 49s/epoch - 80ms/step
Epoch 6/50
617/617 - 47s - loss: 3.2555 - accuracy300: 0.3794 - val_loss: 3.2959 - val_accuracy300: 0.3558 - 47s/epoch - 75ms/step
Epoch 7/50
617/617 - 48s - loss: 3.2497 - accuracy300: 0.3850 - val_loss: 3.2976 - val_accuracy300: 0.3558 - 48s/epoch - 78ms/step
Epoch 8/50
617/617 - 48s - loss: 3.2435 - accuracy300: 0.3881 - val_loss: 3.2976 - val_accuracy300: 0.3543 - 48s/epoch - 77ms/step
Epoch 9/50
617/617 - 47s - loss: 3.2393 - accuracy300: 0.3909 - val_loss: 3.2973 - val_accuracy300: 0.3555 - 47s/epoch - 75ms/step
Epoch 10/50
617/617 - 48s - loss: 3.2336 - accuracy300: 0.3946 - val_loss: 3.2995 - val_accuracy300: 0.3572 - 48s/epoch - 77ms/step
Epoch 11/50
617/617 - 48s - loss: 3.2294 - accuracy300: 0.3964 - val_loss: 3.3000 - val_accuracy300: 0.3574 - 48s/epoch - 79ms/step
Epoch 12/50
617/617 - 48s - loss: 3.2245 - accuracy300: 0.4009 - val_loss: 3.3031 - val_accuracy300: 0.3564 - 48s/epoch - 78ms/step
Epoch 13/50
617/617 - 52s - loss: 3.2200 - accuracy300: 0.4036 - val_loss: 3.3044 - val_accuracy300: 0.3540 - 52s/epoch - 84ms/step
Epoch 14/50
617/617 - 51s - loss: 3.2158 - accuracy300: 0.4056 - val_loss: 3.3043 - val_accuracy300: 0.3581 - 51s/epoch - 83ms/step
Epoch 15/50
617/617 - 50s - loss: 3.2125 - accuracy300: 0.4086 - val_loss: 3.3066 - val_accuracy300: 0.3529 - 50s/epoch - 80ms/step
Epoch 16/50
617/617 - 49s - loss: 3.2082 - accuracy300: 0.4085 - val_loss: 3.3098 - val_accuracy300: 0.3559 - 49s/epoch - 80ms/step
testing model: results/PCAR/W6/deepOF_L2/h300
Evaluating performance on  test set...
1722/1722 - 63s - 63s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941969
{'0': {'precision': 0.3414286054090055, 'recall': 0.09844385463174427, 'f1-score': 0.1528240617513974, 'support': 145809}, '1': {'precision': 0.36034834547299066, 'recall': 0.23345271941808515, 'f1-score': 0.28334169863406583, 'support': 135415}, '2': {'precision': 0.37387790009774163, 'recall': 0.7287397380459987, 'f1-score': 0.49420519598634916, 'support': 159570}, 'accuracy': 0.36809030975920726, 'macro avg': {'precision': 0.35855161699324595, 'recall': 0.353545437365276, 'f1-score': 0.31012365212393744, 'support': 440794}, 'weighted avg': {'precision': 0.35898771591016065, 'recall': 0.36809030975920726, 'f1-score': 0.3165019552534364, 'support': 440794}}
[[ 14354  27919 103536]
 [ 12599  31613  91203]
 [ 15088  28197 116285]]
Evaluating performance on  train set...
617/617 - 25s - 25s/epoch - 41ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090558
{'0': {'precision': 0.391290527654164, 'recall': 0.11392241060191012, 'f1-score': 0.17646721522979442, 'support': 54028}, '1': {'precision': 0.3929077270104391, 'recall': 0.293282690839321, 'f1-score': 0.3358631436162461, 'support': 51077}, '2': {'precision': 0.3540385797725177, 'recall': 0.6973716578046057, 'f1-score': 0.4696482162313706, 'support': 52847}, 'accuracy': 0.3671305206645057, 'macro avg': {'precision': 0.37941227814570694, 'recall': 0.36819225308194564, 'f1-score': 0.32732619169247035, 'support': 157952}, 'weighted avg': {'precision': 0.37934986214704225, 'recall': 0.3671305206645057, 'f1-score': 0.3261025613737184, 'support': 157952}}
[[ 6155 12076 35797]
 [ 4652 14980 31445]
 [ 4923 11070 36854]]
Evaluating performance on  val set...
225/225 - 9s - 9s/epoch - 40ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989715
{'0': {'precision': 0.36609829488465395, 'recall': 0.11411599187118962, 'f1-score': 0.1739959480395662, 'support': 19191}, '1': {'precision': 0.3562738463753509, 'recall': 0.2687628977951559, 'f1-score': 0.3063921993499458, 'support': 18414}, '2': {'precision': 0.3564622591291387, 'recall': 0.6750504032258065, 'f1-score': 0.46655751410854873, 'support': 19840}, 'accuracy': 0.35742014100443903, 'macro avg': {'precision': 0.3596114667963812, 'recall': 0.35264309763071733, 'f1-score': 0.3156485538326869, 'support': 57445}, 'weighted avg': {'precision': 0.35962103238592075, 'recall': 0.35742014100443903, 'f1-score': 0.3174786887905096, 'support': 57445}}
[[ 2190  4473 12528]
 [ 1814  4949 11651]
 [ 1978  4469 13393]]
training model: results/PCAR/W6/deepOF_L2/h500
Epoch 1/50
617/617 - 52s - loss: 3.3293 - accuracy500: 0.3481 - val_loss: 3.3168 - val_accuracy500: 0.3382 - 52s/epoch - 85ms/step
Epoch 2/50
617/617 - 48s - loss: 3.3008 - accuracy500: 0.3540 - val_loss: 3.3115 - val_accuracy500: 0.3454 - 48s/epoch - 79ms/step
Epoch 3/50
617/617 - 50s - loss: 3.2872 - accuracy500: 0.3601 - val_loss: 3.3106 - val_accuracy500: 0.3478 - 50s/epoch - 81ms/step
Epoch 4/50
617/617 - 50s - loss: 3.2791 - accuracy500: 0.3658 - val_loss: 3.3074 - val_accuracy500: 0.3512 - 50s/epoch - 80ms/step
Epoch 5/50
617/617 - 53s - loss: 3.2717 - accuracy500: 0.3725 - val_loss: 3.3087 - val_accuracy500: 0.3532 - 53s/epoch - 87ms/step
Epoch 6/50
617/617 - 53s - loss: 3.2666 - accuracy500: 0.3756 - val_loss: 3.3091 - val_accuracy500: 0.3540 - 53s/epoch - 86ms/step
Epoch 7/50
617/617 - 48s - loss: 3.2614 - accuracy500: 0.3803 - val_loss: 3.3081 - val_accuracy500: 0.3540 - 48s/epoch - 78ms/step
Epoch 8/50
617/617 - 48s - loss: 3.2565 - accuracy500: 0.3845 - val_loss: 3.3095 - val_accuracy500: 0.3564 - 48s/epoch - 78ms/step
Epoch 9/50
617/617 - 50s - loss: 3.2522 - accuracy500: 0.3879 - val_loss: 3.3104 - val_accuracy500: 0.3578 - 50s/epoch - 82ms/step
Epoch 10/50
617/617 - 49s - loss: 3.2474 - accuracy500: 0.3915 - val_loss: 3.3142 - val_accuracy500: 0.3562 - 49s/epoch - 80ms/step
Epoch 11/50
617/617 - 52s - loss: 3.2438 - accuracy500: 0.3939 - val_loss: 3.3162 - val_accuracy500: 0.3564 - 52s/epoch - 84ms/step
Epoch 12/50
617/617 - 49s - loss: 3.2387 - accuracy500: 0.3952 - val_loss: 3.3187 - val_accuracy500: 0.3548 - 49s/epoch - 80ms/step
Epoch 13/50
617/617 - 52s - loss: 3.2349 - accuracy500: 0.3990 - val_loss: 3.3215 - val_accuracy500: 0.3565 - 52s/epoch - 85ms/step
Epoch 14/50
617/617 - 52s - loss: 3.2304 - accuracy500: 0.4008 - val_loss: 3.3244 - val_accuracy500: 0.3574 - 52s/epoch - 84ms/step
testing model: results/PCAR/W6/deepOF_L2/h500
Evaluating performance on  test set...
1722/1722 - 64s - 64s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013582
{'0': {'precision': 0.34364913613062464, 'recall': 0.012132424406952348, 'f1-score': 0.023437398837194246, 'support': 149187}, '1': {'precision': 0.3273032730327303, 'recall': 0.42157734070095443, 'f1-score': 0.3685063838411132, 'support': 129395}, '2': {'precision': 0.38629854721009294, 'recall': 0.6402793874682514, 'f1-score': 0.4818708620793646, 'support': 162212}, 'accuracy': 0.36348271528196846, 'macro avg': {'precision': 0.3524169854578159, 'recall': 0.35799638419205276, 'f1-score': 0.29127154825255736, 'support': 440794}, 'weighted avg': {'precision': 0.35454577563676737, 'recall': 0.36348271528196846, 'f1-score': 0.293435652565741, 'support': 440794}}
[[  1810  55675  91702]
 [  1546  54550  73299]
 [  1911  56440 103861]]
Evaluating performance on  train set...
617/617 - 24s - 24s/epoch - 39ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007881
{'0': {'precision': 0.4146341463414634, 'recall': 0.014739249940046856, 'f1-score': 0.0284665811600399, 'support': 54209}, '1': {'precision': 0.36360520904729265, 'recall': 0.4758404180641136, 'f1-score': 0.4122198010101522, 'support': 51284}, '2': {'precision': 0.3537245110278818, 'recall': 0.5995158123486913, 'f1-score': 0.4449317394072293, 'support': 52459}, 'accuracy': 0.3586659238249595, 'macro avg': {'precision': 0.37732128880554594, 'recall': 0.36336516011761727, 'f1-score': 0.2952060405258072, 'support': 157952}, 'weighted avg': {'precision': 0.3778367232058942, 'recall': 0.3586659238249595, 'f1-score': 0.29138028825638856, 'support': 157952}}
[[  799 22282 31128]
 [  548 24403 26333]
 [  580 20429 31450]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044205
{'0': {'precision': 0.362400906002265, 'recall': 0.016538322393922167, 'f1-score': 0.03163305654408857, 'support': 19349}, '1': {'precision': 0.3434772065955383, 'recall': 0.4682386645363892, 'f1-score': 0.39626996153397837, 'support': 18151}, '2': {'precision': 0.3621849267710101, 'recall': 0.5777889195287039, 'f1-score': 0.44526012789057823, 'support': 19945}, 'accuracy': 0.3541300374271042, 'macro avg': {'precision': 0.3560210131229378, 'recall': 0.3541886354863384, 'f1-score': 0.2910543819895484, 'support': 57445}, 'weighted avg': {'precision': 0.35634656230483486, 'recall': 0.3541300374271042, 'f1-score': 0.29046004584650353, 'support': 57445}}
[[  320  8113 10916]
 [  274  8499  9378]
 [  289  8132 11524]]
training model: results/PCAR/W6/deepOF_L2/h1000
Epoch 1/50
617/617 - 53s - loss: 3.3295 - accuracy1000: 0.3544 - val_loss: 3.3190 - val_accuracy1000: 0.3476 - 53s/epoch - 87ms/step
Epoch 2/50
617/617 - 48s - loss: 3.2969 - accuracy1000: 0.3637 - val_loss: 3.3153 - val_accuracy1000: 0.3485 - 48s/epoch - 78ms/step
Epoch 3/50
617/617 - 51s - loss: 3.2808 - accuracy1000: 0.3710 - val_loss: 3.3178 - val_accuracy1000: 0.3506 - 51s/epoch - 83ms/step
Epoch 4/50
617/617 - 49s - loss: 3.2711 - accuracy1000: 0.3757 - val_loss: 3.3147 - val_accuracy1000: 0.3546 - 49s/epoch - 80ms/step
Epoch 5/50
617/617 - 49s - loss: 3.2625 - accuracy1000: 0.3825 - val_loss: 3.3156 - val_accuracy1000: 0.3522 - 49s/epoch - 80ms/step
Epoch 6/50
617/617 - 51s - loss: 3.2553 - accuracy1000: 0.3874 - val_loss: 3.3183 - val_accuracy1000: 0.3537 - 51s/epoch - 83ms/step
Epoch 7/50
617/617 - 49s - loss: 3.2485 - accuracy1000: 0.3905 - val_loss: 3.3170 - val_accuracy1000: 0.3542 - 49s/epoch - 80ms/step
Epoch 8/50
617/617 - 49s - loss: 3.2431 - accuracy1000: 0.3940 - val_loss: 3.3188 - val_accuracy1000: 0.3564 - 49s/epoch - 79ms/step
Epoch 9/50
617/617 - 49s - loss: 3.2383 - accuracy1000: 0.3961 - val_loss: 3.3232 - val_accuracy1000: 0.3564 - 49s/epoch - 79ms/step
Epoch 10/50
617/617 - 50s - loss: 3.2331 - accuracy1000: 0.3996 - val_loss: 3.3261 - val_accuracy1000: 0.3525 - 50s/epoch - 81ms/step
Epoch 11/50
617/617 - 51s - loss: 3.2285 - accuracy1000: 0.4026 - val_loss: 3.3246 - val_accuracy1000: 0.3564 - 51s/epoch - 83ms/step
Epoch 12/50
617/617 - 52s - loss: 3.2243 - accuracy1000: 0.4049 - val_loss: 3.3298 - val_accuracy1000: 0.3553 - 52s/epoch - 85ms/step
Epoch 13/50
617/617 - 50s - loss: 3.2211 - accuracy1000: 0.4057 - val_loss: 3.3270 - val_accuracy1000: 0.3565 - 50s/epoch - 81ms/step
Epoch 14/50
617/617 - 51s - loss: 3.2179 - accuracy1000: 0.4083 - val_loss: 3.3295 - val_accuracy1000: 0.3565 - 51s/epoch - 83ms/step
testing model: results/PCAR/W6/deepOF_L2/h1000
Evaluating performance on  test set...
1722/1722 - 66s - 66s/epoch - 38ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0946289
{'0': {'precision': 0.3128264654672084, 'recall': 0.003762048676303281, 'f1-score': 0.007434687853458027, 'support': 143273}, '1': {'precision': 0.35954381206367697, 'recall': 0.3016479068986056, 'f1-score': 0.3280610910178099, 'support': 130954}, '2': {'precision': 0.39452740549932563, 'recall': 0.7797462882803917, 'f1-score': 0.5239515824846552, 'support': 166567}, 'accuracy': 0.3854884594617894, 'macro avg': {'precision': 0.35563256101007035, 'recall': 0.3617187479517669, 'f1-score': 0.28648245378530773, 'support': 440794}, 'weighted avg': {'precision': 0.35757867145123634, 'recall': 0.3854884594617894, 'f1-score': 0.2978696293182219, 'support': 440794}}
[[   539  34351 108383]
 [   511  39502  90941]
 [   673  36014 129880]]
Evaluating performance on  train set...
617/617 - 24s - 24s/epoch - 39ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103231
{'0': {'precision': 0.4030054644808743, 'recall': 0.00539640727325943, 'f1-score': 0.010650203978482977, 'support': 54666}, '1': {'precision': 0.3833196758626969, 'recall': 0.3319862000985707, 'f1-score': 0.35581098069873335, 'support': 50725}, '2': {'precision': 0.3467445801850152, 'recall': 0.7473602100416659, 'f1-score': 0.4737080115044408, 'support': 52561}, 'accuracy': 0.35717813006482985, 'macro avg': {'precision': 0.37768990684286213, 'recall': 0.36158093913783196, 'f1-score': 0.28005639872721905, 'support': 157952}, 'weighted avg': {'precision': 0.37796184384212517, 'recall': 0.35717813006482985, 'f1-score': 0.2755855123032055, 'support': 157952}}
[[  295 14022 40349]
 [  228 16840 33657]
 [  209 13070 39282]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 36ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081816
{'0': {'precision': 0.3614864864864865, 'recall': 0.005424313089323735, 'f1-score': 0.010688242932773947, 'support': 19726}, '1': {'precision': 0.34176674998475887, 'recall': 0.3190121208672395, 'f1-score': 0.32999764539675064, 'support': 17573}, '2': {'precision': 0.35971629116968534, 'recall': 0.7275389655514742, 'f1-score': 0.48140970899297114, 'support': 20146}, 'accuracy': 0.3546000522238663, 'macro avg': {'precision': 0.35432317588031026, 'recall': 0.3506584665026791, 'f1-score': 0.2740318657741652, 'support': 57445}, 'weighted avg': {'precision': 0.35483321319208083, 'recall': 0.3546000522238663, 'f1-score': 0.2734505161462511, 'support': 57445}}
[[  107  5409 14210]
 [   88  5606 11879]
 [  101  5388 14657]]
training model: results/PCAR/W6/deepVOL_L2/h10
Epoch 1/50
618/618 - 55s - loss: 3.2915 - accuracy10: 0.3832 - val_loss: 3.2824 - val_accuracy10: 0.3712 - 55s/epoch - 89ms/step
Epoch 2/50
618/618 - 42s - loss: 3.2252 - accuracy10: 0.4130 - val_loss: 3.2372 - val_accuracy10: 0.3971 - 42s/epoch - 69ms/step
Epoch 3/50
618/618 - 44s - loss: 3.1940 - accuracy10: 0.4288 - val_loss: 3.2180 - val_accuracy10: 0.4102 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 44s - loss: 3.1606 - accuracy10: 0.4440 - val_loss: 3.1858 - val_accuracy10: 0.4258 - 44s/epoch - 71ms/step
Epoch 5/50
618/618 - 43s - loss: 3.1376 - accuracy10: 0.4535 - val_loss: 3.1892 - val_accuracy10: 0.4232 - 43s/epoch - 70ms/step
Epoch 6/50
618/618 - 45s - loss: 3.1178 - accuracy10: 0.4609 - val_loss: 3.2128 - val_accuracy10: 0.4151 - 45s/epoch - 73ms/step
Epoch 7/50
618/618 - 46s - loss: 3.1079 - accuracy10: 0.4642 - val_loss: 3.1957 - val_accuracy10: 0.4234 - 46s/epoch - 74ms/step
Epoch 8/50
618/618 - 46s - loss: 3.0909 - accuracy10: 0.4700 - val_loss: 3.1739 - val_accuracy10: 0.4329 - 46s/epoch - 75ms/step
Epoch 9/50
618/618 - 46s - loss: 3.0797 - accuracy10: 0.4750 - val_loss: 3.1801 - val_accuracy10: 0.4325 - 46s/epoch - 74ms/step
Epoch 10/50
618/618 - 47s - loss: 3.0707 - accuracy10: 0.4776 - val_loss: 3.1758 - val_accuracy10: 0.4324 - 47s/epoch - 75ms/step
Epoch 11/50
618/618 - 47s - loss: 3.0659 - accuracy10: 0.4774 - val_loss: 3.1812 - val_accuracy10: 0.4328 - 47s/epoch - 76ms/step
Epoch 12/50
618/618 - 45s - loss: 3.0566 - accuracy10: 0.4818 - val_loss: 3.1708 - val_accuracy10: 0.4356 - 45s/epoch - 72ms/step
Epoch 13/50
618/618 - 45s - loss: 3.0496 - accuracy10: 0.4842 - val_loss: 3.1902 - val_accuracy10: 0.4336 - 45s/epoch - 73ms/step
Epoch 14/50
618/618 - 44s - loss: 3.0456 - accuracy10: 0.4844 - val_loss: 3.1952 - val_accuracy10: 0.4308 - 44s/epoch - 70ms/step
Epoch 15/50
618/618 - 47s - loss: 3.0396 - accuracy10: 0.4869 - val_loss: 3.1778 - val_accuracy10: 0.4344 - 47s/epoch - 76ms/step
Epoch 16/50
618/618 - 43s - loss: 3.0353 - accuracy10: 0.4872 - val_loss: 3.1644 - val_accuracy10: 0.4411 - 43s/epoch - 70ms/step
Epoch 17/50
618/618 - 43s - loss: 3.0291 - accuracy10: 0.4893 - val_loss: 3.1736 - val_accuracy10: 0.4366 - 43s/epoch - 70ms/step
Epoch 18/50
618/618 - 45s - loss: 3.0272 - accuracy10: 0.4894 - val_loss: 3.1682 - val_accuracy10: 0.4386 - 45s/epoch - 72ms/step
Epoch 19/50
618/618 - 46s - loss: 3.0194 - accuracy10: 0.4912 - val_loss: 3.1568 - val_accuracy10: 0.4432 - 46s/epoch - 75ms/step
Epoch 20/50
618/618 - 46s - loss: 3.0155 - accuracy10: 0.4927 - val_loss: 3.1538 - val_accuracy10: 0.4447 - 46s/epoch - 74ms/step
Epoch 21/50
618/618 - 47s - loss: 3.0129 - accuracy10: 0.4933 - val_loss: 3.1599 - val_accuracy10: 0.4449 - 47s/epoch - 76ms/step
Epoch 22/50
618/618 - 46s - loss: 3.0073 - accuracy10: 0.4952 - val_loss: 3.1533 - val_accuracy10: 0.4461 - 46s/epoch - 74ms/step
Epoch 23/50
618/618 - 46s - loss: 3.0023 - accuracy10: 0.4973 - val_loss: 3.1606 - val_accuracy10: 0.4439 - 46s/epoch - 75ms/step
Epoch 24/50
618/618 - 46s - loss: 2.9985 - accuracy10: 0.4981 - val_loss: 3.1575 - val_accuracy10: 0.4461 - 46s/epoch - 75ms/step
Epoch 25/50
618/618 - 46s - loss: 2.9949 - accuracy10: 0.4995 - val_loss: 3.1515 - val_accuracy10: 0.4498 - 46s/epoch - 75ms/step
Epoch 26/50
618/618 - 45s - loss: 2.9898 - accuracy10: 0.5002 - val_loss: 3.1578 - val_accuracy10: 0.4453 - 45s/epoch - 73ms/step
Epoch 27/50
618/618 - 45s - loss: 2.9852 - accuracy10: 0.5015 - val_loss: 3.1534 - val_accuracy10: 0.4486 - 45s/epoch - 73ms/step
Epoch 28/50
618/618 - 45s - loss: 2.9828 - accuracy10: 0.5027 - val_loss: 3.1747 - val_accuracy10: 0.4420 - 45s/epoch - 73ms/step
Epoch 29/50
618/618 - 47s - loss: 2.9786 - accuracy10: 0.5036 - val_loss: 3.1593 - val_accuracy10: 0.4467 - 47s/epoch - 77ms/step
Epoch 30/50
618/618 - 45s - loss: 2.9751 - accuracy10: 0.5045 - val_loss: 3.1592 - val_accuracy10: 0.4471 - 45s/epoch - 72ms/step
Epoch 31/50
618/618 - 45s - loss: 2.9694 - accuracy10: 0.5060 - val_loss: 3.1728 - val_accuracy10: 0.4431 - 45s/epoch - 72ms/step
Epoch 32/50
618/618 - 45s - loss: 2.9669 - accuracy10: 0.5072 - val_loss: 3.1723 - val_accuracy10: 0.4455 - 45s/epoch - 73ms/step
Epoch 33/50
618/618 - 46s - loss: 2.9646 - accuracy10: 0.5077 - val_loss: 3.1618 - val_accuracy10: 0.4458 - 46s/epoch - 75ms/step
Epoch 34/50
618/618 - 46s - loss: 2.9598 - accuracy10: 0.5086 - val_loss: 3.1740 - val_accuracy10: 0.4445 - 46s/epoch - 75ms/step
Epoch 35/50
618/618 - 46s - loss: 2.9556 - accuracy10: 0.5098 - val_loss: 3.1827 - val_accuracy10: 0.4469 - 46s/epoch - 74ms/step
testing model: results/PCAR/W6/deepVOL_L2/h10
Evaluating performance on  test set...
1722/1722 - 60s - 60s/epoch - 35ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0376252
{'0': {'precision': 0.4595002224876461, 'recall': 0.6103351520845128, 'f1-score': 0.5242846606881366, 'support': 160733}, '1': {'precision': 0.4377837845035352, 'recall': 0.28349702085830325, 'f1-score': 0.34413891999958135, 'support': 115973}, '2': {'precision': 0.4981636367220094, 'recall': 0.46206724235646857, 'f1-score': 0.47943698307914107, 'support': 164093}, 'accuracy': 0.4691503383628366, 'macro avg': {'precision': 0.4651492145710636, 'recall': 0.45196647176642823, 'f1-score': 0.449286854588953, 'support': 440799}, 'weighted avg': {'precision': 0.46817963230851256, 'recall': 0.4691503383628366, 'f1-score': 0.46019369871506793, 'support': 440799}}
[[98101 20643 41989]
 [48703 32878 34392]
 [66691 21580 75822]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 36ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0224494
{'0': {'precision': 0.4583481321235995, 'recall': 0.5488410756055597, 'f1-score': 0.49952934345611455, 'support': 51729}, '1': {'precision': 0.5463835515848733, 'recall': 0.3330970678206372, 'f1-score': 0.4138778158894966, 'support': 53612}, '2': {'precision': 0.4577036651033524, 'recall': 0.5509199422185053, 'f1-score': 0.500004312612667, 'support': 52612}, 'accuracy': 0.47630624299633434, 'macro avg': {'precision': 0.4874784496039417, 'recall': 0.4776193618815674, 'f1-score': 0.47113715731942607, 'support': 157953}, 'weighted avg': {'precision': 0.4880142239945267, 'recall': 0.47630624299633434, 'f1-score': 0.47061592858816653, 'support': 157953}}
[[28391  7384 15954]
 [17366 17858 18388]
 [16185  7442 28985]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 37ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0526773
{'0': {'precision': 0.4246504401864319, 'recall': 0.5753454231433506, 'f1-score': 0.4886433957507276, 'support': 18528}, '1': {'precision': 0.5283110966482265, 'recall': 0.3112985954652222, 'f1-score': 0.3917594184538353, 'support': 20861}, '2': {'precision': 0.43489102787890876, 'recall': 0.4829152129368112, 'f1-score': 0.4576466883593996, 'support': 18057}, 'accuracy': 0.4504055983010131, 'macro avg': {'precision': 0.462617521571189, 'recall': 0.45651974384846133, 'f1-score': 0.44601650085465416, 'support': 57446}, 'weighted avg': {'precision': 0.46551280216833757, 'recall': 0.4504055983010131, 'f1-score': 0.44371765338823627, 'support': 57446}}
[[10660  2884  4984]
 [ 8020  6494  6347]
 [ 6423  2914  8720]]
training model: results/PCAR/W6/deepVOL_L2/h20
Epoch 1/50
618/618 - 49s - loss: 3.3053 - accuracy20: 0.3748 - val_loss: 3.2994 - val_accuracy20: 0.3614 - 49s/epoch - 79ms/step
Epoch 2/50
618/618 - 45s - loss: 3.2551 - accuracy20: 0.3964 - val_loss: 3.2748 - val_accuracy20: 0.3788 - 45s/epoch - 73ms/step
Epoch 3/50
618/618 - 47s - loss: 3.2301 - accuracy20: 0.4109 - val_loss: 3.2642 - val_accuracy20: 0.3821 - 47s/epoch - 75ms/step
Epoch 4/50
618/618 - 44s - loss: 3.2129 - accuracy20: 0.4202 - val_loss: 3.2584 - val_accuracy20: 0.3908 - 44s/epoch - 70ms/step
Epoch 5/50
618/618 - 45s - loss: 3.1986 - accuracy20: 0.4262 - val_loss: 3.2504 - val_accuracy20: 0.3954 - 45s/epoch - 74ms/step
Epoch 6/50
618/618 - 46s - loss: 3.1865 - accuracy20: 0.4323 - val_loss: 3.2498 - val_accuracy20: 0.3976 - 46s/epoch - 74ms/step
Epoch 7/50
618/618 - 45s - loss: 3.1754 - accuracy20: 0.4385 - val_loss: 3.2523 - val_accuracy20: 0.4022 - 45s/epoch - 73ms/step
Epoch 8/50
618/618 - 46s - loss: 3.1704 - accuracy20: 0.4394 - val_loss: 3.2396 - val_accuracy20: 0.4079 - 46s/epoch - 75ms/step
Epoch 9/50
618/618 - 44s - loss: 3.1633 - accuracy20: 0.4420 - val_loss: 3.2434 - val_accuracy20: 0.4084 - 44s/epoch - 71ms/step
Epoch 10/50
618/618 - 46s - loss: 3.1566 - accuracy20: 0.4454 - val_loss: 3.2313 - val_accuracy20: 0.4127 - 46s/epoch - 74ms/step
Epoch 11/50
618/618 - 46s - loss: 3.1513 - accuracy20: 0.4469 - val_loss: 3.2307 - val_accuracy20: 0.4126 - 46s/epoch - 74ms/step
Epoch 12/50
618/618 - 44s - loss: 3.1448 - accuracy20: 0.4491 - val_loss: 3.2240 - val_accuracy20: 0.4170 - 44s/epoch - 72ms/step
Epoch 13/50
618/618 - 43s - loss: 3.1389 - accuracy20: 0.4518 - val_loss: 3.2211 - val_accuracy20: 0.4192 - 43s/epoch - 69ms/step
Epoch 14/50
618/618 - 47s - loss: 3.1367 - accuracy20: 0.4527 - val_loss: 3.2145 - val_accuracy20: 0.4203 - 47s/epoch - 75ms/step
Epoch 15/50
618/618 - 48s - loss: 3.1311 - accuracy20: 0.4555 - val_loss: 3.2176 - val_accuracy20: 0.4175 - 48s/epoch - 78ms/step
Epoch 16/50
618/618 - 44s - loss: 3.1257 - accuracy20: 0.4558 - val_loss: 3.2208 - val_accuracy20: 0.4203 - 44s/epoch - 71ms/step
Epoch 17/50
618/618 - 48s - loss: 3.1232 - accuracy20: 0.4570 - val_loss: 3.2189 - val_accuracy20: 0.4221 - 48s/epoch - 77ms/step
Epoch 18/50
618/618 - 46s - loss: 3.1193 - accuracy20: 0.4593 - val_loss: 3.2218 - val_accuracy20: 0.4213 - 46s/epoch - 74ms/step
Epoch 19/50
618/618 - 47s - loss: 3.1153 - accuracy20: 0.4609 - val_loss: 3.2224 - val_accuracy20: 0.4198 - 47s/epoch - 75ms/step
Epoch 20/50
618/618 - 44s - loss: 3.1123 - accuracy20: 0.4615 - val_loss: 3.2181 - val_accuracy20: 0.4212 - 44s/epoch - 72ms/step
Epoch 21/50
618/618 - 46s - loss: 3.1074 - accuracy20: 0.4638 - val_loss: 3.2198 - val_accuracy20: 0.4190 - 46s/epoch - 74ms/step
Epoch 22/50
618/618 - 48s - loss: 3.1036 - accuracy20: 0.4649 - val_loss: 3.2212 - val_accuracy20: 0.4215 - 48s/epoch - 77ms/step
Epoch 23/50
618/618 - 45s - loss: 3.1006 - accuracy20: 0.4661 - val_loss: 3.2176 - val_accuracy20: 0.4237 - 45s/epoch - 73ms/step
Epoch 24/50
618/618 - 45s - loss: 3.0974 - accuracy20: 0.4651 - val_loss: 3.2217 - val_accuracy20: 0.4220 - 45s/epoch - 73ms/step
testing model: results/PCAR/W6/deepVOL_L2/h20
Evaluating performance on  test set...
1722/1722 - 59s - 59s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.072305
{'0': {'precision': 0.45524387361122054, 'recall': 0.5005259900990099, 'f1-score': 0.4768122520440706, 'support': 161600}, '1': {'precision': 0.34117433319779567, 'recall': 0.34578423120089785, 'f1-score': 0.34346381462917563, 'support': 114048}, '2': {'precision': 0.4778630300401258, 'recall': 0.4268941756332084, 'f1-score': 0.45094295573528803, 'support': 165151}, 'accuracy': 0.43290252473349533, 'macro avg': {'precision': 0.42476041228304734, 'recall': 0.42440146564437203, 'f1-score': 0.4237396741361781, 'support': 440799}, 'weighted avg': {'precision': 0.4342051992002529, 'recall': 0.43290252473349533, 'f1-score': 0.43261872450660865, 'support': 440799}}
[[80885 37568 43147]
 [40725 39436 33887]
 [56064 38585 70502]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0565592
{'0': {'precision': 0.4560209952558797, 'recall': 0.4299227284838796, 'f1-score': 0.4425874584872205, 'support': 52542}, '1': {'precision': 0.4257985602855367, 'recall': 0.40379934585837074, 'f1-score': 0.41450726632116264, 'support': 52588}, '2': {'precision': 0.43978342186619296, 'recall': 0.48743918368892336, 'f1-score': 0.46238663913082517, 'support': 52823}, 'accuracy': 0.44046013687615937, 'macro avg': {'precision': 0.44053432580253643, 'recall': 0.4403870860103913, 'f1-score': 0.4398271213130694, 'support': 157953}, 'weighted avg': {'precision': 0.4405286985006182, 'recall': 0.44046013687615937, 'f1-score': 0.4398598811288194, 'support': 157953}}
[[22589 14393 15560]
 [14114 21235 17239]
 [12832 14243 25748]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0715606
{'0': {'precision': 0.42200515668385563, 'recall': 0.44804169298799745, 'f1-score': 0.43463384741088756, 'support': 18996}, '1': {'precision': 0.42182036713286714, 'recall': 0.3887126818708151, 'f1-score': 0.4045903529226819, 'support': 19863}, '2': {'precision': 0.4186781912090229, 'recall': 0.4273954914725346, 'f1-score': 0.4229919331221214, 'support': 18587}, 'accuracy': 0.4208474045190266, 'macro avg': {'precision': 0.42083457167524857, 'recall': 0.42138328877711567, 'f1-score': 0.420738711151897, 'support': 57446}, 'weighted avg': {'precision': 0.4208648025750926, 'recall': 0.4208474045190266, 'f1-score': 0.4204789507791895, 'support': 57446}}
[[8511 5391 5094]
 [6206 7721 5936]
 [5451 5192 7944]]
training model: results/PCAR/W6/deepVOL_L2/h30
Epoch 1/50
618/618 - 49s - loss: 3.3083 - accuracy30: 0.3721 - val_loss: 3.3274 - val_accuracy30: 0.3565 - 49s/epoch - 79ms/step
Epoch 2/50
618/618 - 47s - loss: 3.2629 - accuracy30: 0.3910 - val_loss: 3.2818 - val_accuracy30: 0.3662 - 47s/epoch - 76ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2465 - accuracy30: 0.3982 - val_loss: 3.2739 - val_accuracy30: 0.3634 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 44s - loss: 3.2311 - accuracy30: 0.4079 - val_loss: 3.2563 - val_accuracy30: 0.3806 - 44s/epoch - 72ms/step
Epoch 5/50
618/618 - 45s - loss: 3.2188 - accuracy30: 0.4153 - val_loss: 3.2502 - val_accuracy30: 0.3844 - 45s/epoch - 73ms/step
Epoch 6/50
618/618 - 46s - loss: 3.2114 - accuracy30: 0.4193 - val_loss: 3.2438 - val_accuracy30: 0.3920 - 46s/epoch - 74ms/step
Epoch 7/50
618/618 - 45s - loss: 3.2065 - accuracy30: 0.4222 - val_loss: 3.2537 - val_accuracy30: 0.3941 - 45s/epoch - 72ms/step
Epoch 8/50
618/618 - 46s - loss: 3.2065 - accuracy30: 0.4217 - val_loss: 3.2362 - val_accuracy30: 0.3985 - 46s/epoch - 75ms/step
Epoch 9/50
618/618 - 46s - loss: 3.1965 - accuracy30: 0.4272 - val_loss: 3.2357 - val_accuracy30: 0.3988 - 46s/epoch - 74ms/step
Epoch 10/50
618/618 - 46s - loss: 3.1909 - accuracy30: 0.4307 - val_loss: 3.2342 - val_accuracy30: 0.4025 - 46s/epoch - 74ms/step
Epoch 11/50
618/618 - 44s - loss: 3.1861 - accuracy30: 0.4312 - val_loss: 3.2399 - val_accuracy30: 0.4037 - 44s/epoch - 71ms/step
Epoch 12/50
618/618 - 45s - loss: 3.1813 - accuracy30: 0.4344 - val_loss: 3.2412 - val_accuracy30: 0.4048 - 45s/epoch - 73ms/step
Epoch 13/50
618/618 - 45s - loss: 3.1778 - accuracy30: 0.4344 - val_loss: 3.2452 - val_accuracy30: 0.4039 - 45s/epoch - 73ms/step
Epoch 14/50
618/618 - 45s - loss: 3.1754 - accuracy30: 0.4361 - val_loss: 3.2390 - val_accuracy30: 0.4043 - 45s/epoch - 73ms/step
Epoch 15/50
618/618 - 44s - loss: 3.1699 - accuracy30: 0.4383 - val_loss: 3.2378 - val_accuracy30: 0.4082 - 44s/epoch - 71ms/step
Epoch 16/50
618/618 - 47s - loss: 3.1659 - accuracy30: 0.4396 - val_loss: 3.2447 - val_accuracy30: 0.4051 - 47s/epoch - 76ms/step
Epoch 17/50
618/618 - 47s - loss: 3.1618 - accuracy30: 0.4417 - val_loss: 3.2499 - val_accuracy30: 0.4045 - 47s/epoch - 76ms/step
Epoch 18/50
618/618 - 48s - loss: 3.1583 - accuracy30: 0.4422 - val_loss: 3.2493 - val_accuracy30: 0.4049 - 48s/epoch - 77ms/step
Epoch 19/50
618/618 - 48s - loss: 3.1552 - accuracy30: 0.4422 - val_loss: 3.2618 - val_accuracy30: 0.4031 - 48s/epoch - 78ms/step
Epoch 20/50
618/618 - 46s - loss: 3.1511 - accuracy30: 0.4446 - val_loss: 3.2523 - val_accuracy30: 0.4041 - 46s/epoch - 74ms/step
testing model: results/PCAR/W6/deepVOL_L2/h30
Evaluating performance on  test set...
1722/1722 - 60s - 60s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0836931
{'0': {'precision': 0.4228417142801141, 'recall': 0.5459555218120274, 'f1-score': 0.476576026774989, 'support': 158055}, '1': {'precision': 0.32696723246282267, 'recall': 0.37461584481359766, 'f1-score': 0.349173490589098, 'support': 122021}, '2': {'precision': 0.46500278574523846, 'recall': 0.2804141286561351, 'f1-score': 0.3498534805643424, 'support': 160723}, 'accuracy': 0.4017046318163154, 'macro avg': {'precision': 0.40493724416272503, 'recall': 0.40032849842725343, 'f1-score': 0.3918676659761431, 'support': 440799}, 'weighted avg': {'precision': 0.411674614861244, 'recall': 0.4017046318163154, 'f1-score': 0.39510349017088514, 'support': 440799}}
[[86291 45231 26533]
 [50990 45711 25320]
 [66793 48861 45069]]
Evaluating performance on  train set...
618/618 - 23s - 23s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0711032
{'0': {'precision': 0.4319871370471957, 'recall': 0.4341634980988593, 'f1-score': 0.4330725833214811, 'support': 52600}, '1': {'precision': 0.38762107486428066, 'recall': 0.44880686268890546, 'f1-score': 0.41597605893186, 'support': 52341}, '2': {'precision': 0.4359447004608295, 'recall': 0.3658228325662114, 'f1-score': 0.397817368739551, 'support': 53012}, 'accuracy': 0.41607946667679624, 'macro avg': {'precision': 0.4185176374574353, 'recall': 0.41626439778465874, 'f1-score': 0.4156220036642974, 'support': 157953}, 'weighted avg': {'precision': 0.41861375566771947, 'recall': 0.41607946667679624, 'f1-score': 0.4155749820192301, 'support': 157953}}
[[22837 18404 11359]
 [15117 23491 13733]
 [14911 18708 19393]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0778506
{'0': {'precision': 0.4036523132723209, 'recall': 0.5004182787828088, 'f1-score': 0.44685668931064265, 'support': 19126}, '1': {'precision': 0.38617010864245865, 'recall': 0.4054359554025587, 'f1-score': 0.39556858911697623, 'support': 19463}, '2': {'precision': 0.4263589203819262, 'recall': 0.3007371267964151, 'f1-score': 0.3526960631880092, 'support': 18857}, 'accuracy': 0.4026912230616579, 'macro avg': {'precision': 0.4053937807655686, 'recall': 0.4021971203272609, 'f1-score': 0.3983737805385427, 'support': 57446}, 'weighted avg': {'precision': 0.4051828348326526, 'recall': 0.4026912230616579, 'f1-score': 0.39857121737414875, 'support': 57446}}
[[9571 6039 3516]
 [7458 7891 4114]
 [6682 6504 5671]]
training model: results/PCAR/W6/deepVOL_L2/h50
Epoch 1/50
618/618 - 48s - loss: 3.2874 - accuracy50: 0.3831 - val_loss: 3.3156 - val_accuracy50: 0.3476 - 48s/epoch - 78ms/step
Epoch 2/50
618/618 - 46s - loss: 3.2447 - accuracy50: 0.4016 - val_loss: 3.2948 - val_accuracy50: 0.3638 - 46s/epoch - 75ms/step
Epoch 3/50
618/618 - 43s - loss: 3.2362 - accuracy50: 0.4057 - val_loss: 3.2797 - val_accuracy50: 0.3742 - 43s/epoch - 70ms/step
Epoch 4/50
618/618 - 47s - loss: 3.2317 - accuracy50: 0.4086 - val_loss: 3.2772 - val_accuracy50: 0.3712 - 47s/epoch - 76ms/step
Epoch 5/50
618/618 - 44s - loss: 3.2263 - accuracy50: 0.4097 - val_loss: 3.2747 - val_accuracy50: 0.3738 - 44s/epoch - 71ms/step
Epoch 6/50
618/618 - 45s - loss: 3.2178 - accuracy50: 0.4167 - val_loss: 3.2842 - val_accuracy50: 0.3714 - 45s/epoch - 73ms/step
Epoch 7/50
618/618 - 49s - loss: 3.2100 - accuracy50: 0.4198 - val_loss: 3.2891 - val_accuracy50: 0.3723 - 49s/epoch - 79ms/step
Epoch 8/50
618/618 - 48s - loss: 3.2034 - accuracy50: 0.4235 - val_loss: 3.2898 - val_accuracy50: 0.3734 - 48s/epoch - 77ms/step
Epoch 9/50
618/618 - 46s - loss: 3.1996 - accuracy50: 0.4244 - val_loss: 3.3103 - val_accuracy50: 0.3728 - 46s/epoch - 75ms/step
Epoch 10/50
618/618 - 44s - loss: 3.1958 - accuracy50: 0.4268 - val_loss: 3.3018 - val_accuracy50: 0.3748 - 44s/epoch - 72ms/step
Epoch 11/50
618/618 - 48s - loss: 3.1896 - accuracy50: 0.4296 - val_loss: 3.3120 - val_accuracy50: 0.3727 - 48s/epoch - 78ms/step
Epoch 12/50
618/618 - 44s - loss: 3.1858 - accuracy50: 0.4317 - val_loss: 3.3244 - val_accuracy50: 0.3721 - 44s/epoch - 71ms/step
Epoch 13/50
618/618 - 47s - loss: 3.1806 - accuracy50: 0.4340 - val_loss: 3.3249 - val_accuracy50: 0.3726 - 47s/epoch - 75ms/step
Epoch 14/50
618/618 - 46s - loss: 3.1769 - accuracy50: 0.4364 - val_loss: 3.3368 - val_accuracy50: 0.3721 - 46s/epoch - 74ms/step
Epoch 15/50
618/618 - 45s - loss: 3.1743 - accuracy50: 0.4362 - val_loss: 3.3464 - val_accuracy50: 0.3716 - 45s/epoch - 73ms/step
testing model: results/PCAR/W6/deepVOL_L2/h50
Evaluating performance on  test set...
1722/1722 - 58s - 58s/epoch - 34ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0849457
{'0': {'precision': 0.4081341525933741, 'recall': 0.3558417329567538, 'f1-score': 0.3801982939110273, 'support': 154372}, '1': {'precision': 0.39773759392288005, 'recall': 0.07434961451492163, 'f1-score': 0.12528039844212252, 'support': 129577}, '2': {'precision': 0.3910505560599183, 'recall': 0.7030283710551483, 'f1-score': 0.5025590542209583, 'support': 156850}, 'accuracy': 0.39663429363496744, 'macro avg': {'precision': 0.39897410085872415, 'recall': 0.37773990617560793, 'f1-score': 0.33601258219136937, 'support': 440799}, 'weighted avg': {'precision': 0.39899911145417194, 'recall': 0.39663429363496744, 'f1-score': 0.34880255370616836, 'support': 440799}}
[[ 54932   7344  92096]
 [ 40325   9634  79618]
 [ 39336   7244 110270]]
Evaluating performance on  train set...
618/618 - 23s - 23s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0881597
{'0': {'precision': 0.4017744849191649, 'recall': 0.33481972711334707, 'f1-score': 0.3652540875404076, 'support': 52476}, '1': {'precision': 0.42397260273972603, 'recall': 0.08229506951302895, 'f1-score': 0.13783560249395596, 'support': 52652}, '2': {'precision': 0.3670794792407838, 'recall': 0.7227070515854236, 'f1-score': 0.48686769497599264, 'support': 52825}, 'accuracy': 0.380366311497724, 'macro avg': {'precision': 0.3976088556332249, 'recall': 0.37994061607059987, 'f1-score': 0.3299857950034521, 'support': 157953}, 'weighted avg': {'precision': 0.3975707763762926, 'recall': 0.380366311497724, 'f1-score': 0.33011832397858226, 'support': 157953}}
[[17570  2983 31923]
 [14417  4333 33902]
 [11744  2904 38177]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091218
{'0': {'precision': 0.38111471861471863, 'recall': 0.3717014988389276, 'f1-score': 0.37634925724056856, 'support': 18948}, '1': {'precision': 0.44005979073243645, 'recall': 0.07603305785123966, 'f1-score': 0.12966306980841225, 'support': 19360}, '2': {'precision': 0.36812554392072094, 'recall': 0.6851813146619291, 'f1-score': 0.47893496959403936, 'support': 19138}, 'accuracy': 0.3764927061936427, 'macro avg': {'precision': 0.39643335108929206, 'recall': 0.3776386237840321, 'f1-score': 0.3283157655476734, 'support': 57446}, 'weighted avg': {'precision': 0.39665261108600103, 'recall': 0.3764927061936427, 'f1-score': 0.3273892038745235, 'support': 57446}}
[[ 7043   921 10984]
 [ 6364  1472 11524]
 [ 5073   952 13113]]
training model: results/PCAR/W6/deepVOL_L2/h100
Epoch 1/50
618/618 - 52s - loss: 3.3179 - accuracy100: 0.3650 - val_loss: 3.3241 - val_accuracy100: 0.3412 - 52s/epoch - 84ms/step
Epoch 2/50
618/618 - 45s - loss: 3.2893 - accuracy100: 0.3654 - val_loss: 3.3083 - val_accuracy100: 0.3512 - 45s/epoch - 73ms/step
Epoch 3/50
618/618 - 46s - loss: 3.2794 - accuracy100: 0.3703 - val_loss: 3.3028 - val_accuracy100: 0.3532 - 46s/epoch - 75ms/step
Epoch 4/50
618/618 - 45s - loss: 3.2691 - accuracy100: 0.3821 - val_loss: 3.3065 - val_accuracy100: 0.3570 - 45s/epoch - 72ms/step
Epoch 5/50
618/618 - 46s - loss: 3.2610 - accuracy100: 0.3902 - val_loss: 3.3077 - val_accuracy100: 0.3608 - 46s/epoch - 74ms/step
Epoch 6/50
618/618 - 46s - loss: 3.2545 - accuracy100: 0.3924 - val_loss: 3.3019 - val_accuracy100: 0.3592 - 46s/epoch - 74ms/step
Epoch 7/50
618/618 - 47s - loss: 3.2469 - accuracy100: 0.3985 - val_loss: 3.2895 - val_accuracy100: 0.3643 - 47s/epoch - 75ms/step
Epoch 8/50
618/618 - 44s - loss: 3.2415 - accuracy100: 0.4018 - val_loss: 3.2900 - val_accuracy100: 0.3659 - 44s/epoch - 71ms/step
Epoch 9/50
618/618 - 46s - loss: 3.2364 - accuracy100: 0.4043 - val_loss: 3.2949 - val_accuracy100: 0.3619 - 46s/epoch - 74ms/step
Epoch 10/50
618/618 - 46s - loss: 3.2318 - accuracy100: 0.4056 - val_loss: 3.2966 - val_accuracy100: 0.3651 - 46s/epoch - 75ms/step
Epoch 11/50
618/618 - 46s - loss: 3.2274 - accuracy100: 0.4086 - val_loss: 3.2953 - val_accuracy100: 0.3631 - 46s/epoch - 74ms/step
Epoch 12/50
618/618 - 45s - loss: 3.2246 - accuracy100: 0.4083 - val_loss: 3.3028 - val_accuracy100: 0.3616 - 45s/epoch - 73ms/step
Epoch 13/50
618/618 - 45s - loss: 3.2212 - accuracy100: 0.4093 - val_loss: 3.2962 - val_accuracy100: 0.3649 - 45s/epoch - 72ms/step
Epoch 14/50
618/618 - 45s - loss: 3.2169 - accuracy100: 0.4121 - val_loss: 3.2963 - val_accuracy100: 0.3655 - 45s/epoch - 73ms/step
Epoch 15/50
618/618 - 43s - loss: 3.2132 - accuracy100: 0.4144 - val_loss: 3.3001 - val_accuracy100: 0.3606 - 43s/epoch - 70ms/step
Epoch 16/50
618/618 - 44s - loss: 3.2103 - accuracy100: 0.4152 - val_loss: 3.3073 - val_accuracy100: 0.3607 - 44s/epoch - 71ms/step
Epoch 17/50
618/618 - 44s - loss: 3.2078 - accuracy100: 0.4154 - val_loss: 3.3079 - val_accuracy100: 0.3630 - 44s/epoch - 71ms/step
testing model: results/PCAR/W6/deepVOL_L2/h100
Evaluating performance on  test set...
1722/1722 - 60s - 60s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975323
{'0': {'precision': 0.3990920069776804, 'recall': 0.11227577875788824, 'f1-score': 0.17524907563355316, 'support': 158939}, '1': {'precision': 0.3077137523938814, 'recall': 0.418740825044947, 'f1-score': 0.35474292421521847, 'support': 121254}, '2': {'precision': 0.39430329624677063, 'recall': 0.5673262518212271, 'f1-score': 0.4652490381350415, 'support': 160606}, 'accuracy': 0.3623760489474795, 'macro avg': {'precision': 0.36703635187277744, 'recall': 0.3661142852080208, 'f1-score': 0.33174701266127105, 'support': 440799}, 'weighted avg': {'precision': 0.37221110534915475, 'recall': 0.3623760489474795, 'f1-score': 0.3302859089599338, 'support': 440799}}
[[17845 59225 81869]
 [12384 50774 58096]
 [14485 55005 91116]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0942575
{'0': {'precision': 0.4114146832048274, 'recall': 0.09226056232145542, 'f1-score': 0.15072152287381024, 'support': 53208}, '1': {'precision': 0.3643394581328511, 'recall': 0.43648567615142075, 'f1-score': 0.39716274608161506, 'support': 51697}, '2': {'precision': 0.3681900888365621, 'recall': 0.5836223797315638, 'f1-score': 0.4515258686695592, 'support': 53048}, 'accuracy': 0.3699454901141479, 'macro avg': {'precision': 0.3813147433914135, 'recall': 0.37078953940148, 'f1-score': 0.3331367125416615, 'support': 157953}, 'weighted avg': {'precision': 0.38149042603596267, 'recall': 0.3699454901141479, 'f1-score': 0.33240430732201176, 'support': 157953}}
[[ 4909 20520 27779]
 [ 3784 22565 25348]
 [ 3239 18849 30960]]
Evaluating performance on  val set...
225/225 - 7s - 7s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965598
{'0': {'precision': 0.379536812996889, 'recall': 0.11482953357038277, 'f1-score': 0.17631473303894019, 'support': 19124}, '1': {'precision': 0.35822125813449024, 'recall': 0.4370401736092733, 'f1-score': 0.39372481701356604, 'support': 18893}, '2': {'precision': 0.36892694861936387, 'recall': 0.5432600751454012, 'f1-score': 0.4394346260330148, 'support': 19429}, 'accuracy': 0.3656999617031647, 'macro avg': {'precision': 0.36889500658358104, 'recall': 0.3650432607750191, 'f1-score': 0.33649139202850703, 'support': 57446}, 'weighted avg': {'precision': 0.3689380971070753, 'recall': 0.3656999617031647, 'f1-score': 0.3368078068389347, 'support': 57446}}
[[ 2196  7600  9328]
 [ 1909  8257  8727]
 [ 1681  7193 10555]]
training model: results/PCAR/W6/deepVOL_L2/h200
Epoch 1/50
618/618 - 52s - loss: 3.3106 - accuracy200: 0.3686 - val_loss: 3.3215 - val_accuracy200: 0.3562 - 52s/epoch - 84ms/step
Epoch 2/50
618/618 - 46s - loss: 3.2764 - accuracy200: 0.3788 - val_loss: 3.3108 - val_accuracy200: 0.3619 - 46s/epoch - 74ms/step
Epoch 3/50
618/618 - 43s - loss: 3.2546 - accuracy200: 0.3889 - val_loss: 3.3246 - val_accuracy200: 0.3644 - 43s/epoch - 69ms/step
Epoch 4/50
618/618 - 43s - loss: 3.2434 - accuracy200: 0.3957 - val_loss: 3.3158 - val_accuracy200: 0.3685 - 43s/epoch - 69ms/step
Epoch 5/50
618/618 - 45s - loss: 3.2364 - accuracy200: 0.4005 - val_loss: 3.3076 - val_accuracy200: 0.3665 - 45s/epoch - 72ms/step
Epoch 6/50
618/618 - 44s - loss: 3.2308 - accuracy200: 0.4054 - val_loss: 3.3116 - val_accuracy200: 0.3665 - 44s/epoch - 71ms/step
Epoch 7/50
618/618 - 45s - loss: 3.2240 - accuracy200: 0.4073 - val_loss: 3.3196 - val_accuracy200: 0.3633 - 45s/epoch - 73ms/step
Epoch 8/50
618/618 - 45s - loss: 3.2197 - accuracy200: 0.4113 - val_loss: 3.3409 - val_accuracy200: 0.3590 - 45s/epoch - 73ms/step
Epoch 9/50
618/618 - 44s - loss: 3.2155 - accuracy200: 0.4134 - val_loss: 3.3371 - val_accuracy200: 0.3595 - 44s/epoch - 72ms/step
Epoch 10/50
618/618 - 45s - loss: 3.2142 - accuracy200: 0.4139 - val_loss: 3.3505 - val_accuracy200: 0.3595 - 45s/epoch - 72ms/step
Epoch 11/50
618/618 - 45s - loss: 3.2081 - accuracy200: 0.4181 - val_loss: 3.3371 - val_accuracy200: 0.3611 - 45s/epoch - 73ms/step
Epoch 12/50
618/618 - 45s - loss: 3.2031 - accuracy200: 0.4195 - val_loss: 3.3538 - val_accuracy200: 0.3599 - 45s/epoch - 72ms/step
Epoch 13/50
618/618 - 42s - loss: 3.1981 - accuracy200: 0.4203 - val_loss: 3.3552 - val_accuracy200: 0.3604 - 42s/epoch - 68ms/step
Epoch 14/50
618/618 - 43s - loss: 3.1927 - accuracy200: 0.4245 - val_loss: 3.3608 - val_accuracy200: 0.3623 - 43s/epoch - 69ms/step
Epoch 15/50
618/618 - 46s - loss: 3.1876 - accuracy200: 0.4261 - val_loss: 3.3563 - val_accuracy200: 0.3578 - 46s/epoch - 74ms/step
testing model: results/PCAR/W6/deepVOL_L2/h200
Evaluating performance on  test set...
1722/1722 - 61s - 61s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102301
{'0': {'precision': 0.3746650046743534, 'recall': 0.07868558488985458, 'f1-score': 0.1300571156592099, 'support': 152798}, '1': {'precision': 0.34501340530175245, 'recall': 0.6089470385459104, 'f1-score': 0.4404687694801147, 'support': 127640}, '2': {'precision': 0.40133024396892464, 'recall': 0.45905176445644513, 'f1-score': 0.4282547864078235, 'support': 160361}, 'accuracy': 0.3706065576373812, 'macro avg': {'precision': 0.3736695513150101, 'recall': 0.3822281292974033, 'f1-score': 0.33292689051571606, 'support': 440799}, 'weighted avg': {'precision': 0.3757796494321635, 'recall': 0.3706065576373812, 'f1-score': 0.3284246713311119, 'support': 440799}}
[[12023 72556 68219]
 [ 8322 77726 41592]
 [11745 75002 73614]]
Evaluating performance on  train set...
618/618 - 23s - 23s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094663
{'0': {'precision': 0.3852030282174811, 'recall': 0.10524633320797293, 'f1-score': 0.16532269974892924, 'support': 53180}, '1': {'precision': 0.38243928476114225, 'recall': 0.6595202025044585, 'f1-score': 0.4841386591588949, 'support': 52147}, '2': {'precision': 0.3747453032993738, 'recall': 0.3809333789381674, 'f1-score': 0.37781400476814203, 'support': 52626}, 'accuracy': 0.3800877476211278, 'macro avg': {'precision': 0.3807958720926657, 'recall': 0.3818999715501996, 'f1-score': 0.34242512122532204, 'support': 157953}, 'weighted avg': {'precision': 0.3808063459033876, 'recall': 0.3800877476211278, 'f1-score': 0.34137420401470814, 'support': 157953}}
[[ 5597 27947 19636]
 [ 3943 34392 13812]
 [ 4990 27589 20047]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029235
{'0': {'precision': 0.35336696644000876, 'recall': 0.08476716653512234, 'f1-score': 0.1367340010185028, 'support': 19005}, '1': {'precision': 0.37030003797949107, 'recall': 0.6166982922201139, 'f1-score': 0.4627432368296156, 'support': 18972}, '2': {'precision': 0.3686064534310272, 'recall': 0.40310236786686526, 'f1-score': 0.38508341511285576, 'support': 19469}, 'accuracy': 0.3683285172161682, 'macro avg': {'precision': 0.3640911526168424, 'recall': 0.3681892755407005, 'f1-score': 0.32818688432032467, 'support': 57446}, 'weighted avg': {'precision': 0.3641240566721432, 'recall': 0.3683285172161682, 'f1-score': 0.3285691499376859, 'support': 57446}}
[[ 1611  9828  7566]
 [ 1395 11700  5877]
 [ 1553 10068  7848]]
training model: results/PCAR/W6/deepVOL_L2/h300
Epoch 1/50
618/618 - 51s - loss: 3.3132 - accuracy300: 0.3683 - val_loss: 3.3063 - val_accuracy300: 0.3535 - 51s/epoch - 82ms/step
Epoch 2/50
618/618 - 46s - loss: 3.2799 - accuracy300: 0.3727 - val_loss: 3.2931 - val_accuracy300: 0.3614 - 46s/epoch - 74ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2631 - accuracy300: 0.3798 - val_loss: 3.3052 - val_accuracy300: 0.3644 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 46s - loss: 3.2582 - accuracy300: 0.3831 - val_loss: 3.3010 - val_accuracy300: 0.3647 - 46s/epoch - 75ms/step
Epoch 5/50
618/618 - 46s - loss: 3.2480 - accuracy300: 0.3877 - val_loss: 3.3050 - val_accuracy300: 0.3641 - 46s/epoch - 74ms/step
Epoch 6/50
618/618 - 44s - loss: 3.2415 - accuracy300: 0.3917 - val_loss: 3.3060 - val_accuracy300: 0.3653 - 44s/epoch - 71ms/step
Epoch 7/50
618/618 - 44s - loss: 3.2380 - accuracy300: 0.3939 - val_loss: 3.3117 - val_accuracy300: 0.3692 - 44s/epoch - 71ms/step
Epoch 8/50
618/618 - 44s - loss: 3.2350 - accuracy300: 0.3946 - val_loss: 3.3175 - val_accuracy300: 0.3700 - 44s/epoch - 71ms/step
Epoch 9/50
618/618 - 45s - loss: 3.2302 - accuracy300: 0.3986 - val_loss: 3.3264 - val_accuracy300: 0.3653 - 45s/epoch - 72ms/step
Epoch 10/50
618/618 - 46s - loss: 3.2278 - accuracy300: 0.3988 - val_loss: 3.3396 - val_accuracy300: 0.3676 - 46s/epoch - 74ms/step
Epoch 11/50
618/618 - 44s - loss: 3.2243 - accuracy300: 0.4012 - val_loss: 3.3367 - val_accuracy300: 0.3654 - 44s/epoch - 70ms/step
Epoch 12/50
618/618 - 44s - loss: 3.2197 - accuracy300: 0.4036 - val_loss: 3.3497 - val_accuracy300: 0.3666 - 44s/epoch - 71ms/step
testing model: results/PCAR/W6/deepVOL_L2/h300
Evaluating performance on  test set...
1722/1722 - 58s - 58s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095107
{'0': {'precision': 0.3503277169240389, 'recall': 0.21517433407401312, 'f1-score': 0.26660038832311544, 'support': 145812}, '1': {'precision': 0.3682519236171539, 'recall': 0.396895492408578, 'f1-score': 0.38203756686155, 'support': 135416}, '2': {'precision': 0.37804872108372994, 'recall': 0.486366570366796, 'f1-score': 0.42542111812137196, 'support': 159571}, 'accuracy': 0.3691727975789419, 'macro avg': {'precision': 0.36554278720830763, 'recall': 0.3661454656164624, 'f1-score': 0.3580196911020124, 'support': 440799}, 'weighted avg': {'precision': 0.3658692511115505, 'recall': 0.3691727975789419, 'f1-score': 0.35955709567408095, 'support': 440799}}
[[31375 44463 69974]
 [23963 53746 57707]
 [34221 47740 77610]]
Evaluating performance on  train set...
618/618 - 23s - 23s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966096
{'0': {'precision': 0.36120890995921495, 'recall': 0.19181074377105622, 'f1-score': 0.25056523473866205, 'support': 54022}, '1': {'precision': 0.3794438811973341, 'recall': 0.44739265907621156, 'f1-score': 0.41062628152091807, 'support': 51029}, '2': {'precision': 0.35206008770025615, 'recall': 0.4598502892140184, 'f1-score': 0.3988000098359849, 'support': 52902}, 'accuracy': 0.3641526276803859, 'macro avg': {'precision': 0.36423762628560175, 'recall': 0.36635123068709535, 'f1-score': 0.3533305086985217, 'support': 157953}, 'weighted avg': {'precision': 0.36403583538745343, 'recall': 0.3641526276803859, 'f1-score': 0.3519224183847486, 'support': 157953}}
[[10362 19158 24502]
 [ 7929 22830 20270]
 [10396 18179 24327]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976921
{'0': {'precision': 0.3539942425332854, 'recall': 0.20511884904086738, 'f1-score': 0.2597359735973597, 'support': 19184}, '1': {'precision': 0.3675610345661107, 'recall': 0.4124891493055556, 'f1-score': 0.3887312421709232, 'support': 18432}, '2': {'precision': 0.35714564242542407, 'recall': 0.46187594553706507, 'f1-score': 0.4028147333699835, 'support': 19830}, 'accuracy': 0.3602861818055217, 'macro avg': {'precision': 0.35956697317494, 'recall': 0.359827981294496, 'f1-score': 0.3504273163794222, 'support': 57446}, 'weighted avg': {'precision': 0.3594350977818692, 'recall': 0.3602861818055217, 'f1-score': 0.3505150112438286, 'support': 57446}}
[[3935 6426 8823]
 [3166 7603 7663]
 [4015 6656 9159]]
training model: results/PCAR/W6/deepVOL_L2/h500
Epoch 1/50
618/618 - 53s - loss: 3.3154 - accuracy500: 0.3680 - val_loss: 3.3536 - val_accuracy500: 0.3191 - 53s/epoch - 86ms/step
Epoch 2/50
618/618 - 42s - loss: 3.2840 - accuracy500: 0.3714 - val_loss: 3.3250 - val_accuracy500: 0.3441 - 42s/epoch - 67ms/step
Epoch 3/50
618/618 - 44s - loss: 3.2700 - accuracy500: 0.3796 - val_loss: 3.3220 - val_accuracy500: 0.3498 - 44s/epoch - 71ms/step
Epoch 4/50
618/618 - 46s - loss: 3.2602 - accuracy500: 0.3865 - val_loss: 3.3291 - val_accuracy500: 0.3481 - 46s/epoch - 75ms/step
Epoch 5/50
618/618 - 45s - loss: 3.2537 - accuracy500: 0.3899 - val_loss: 3.3510 - val_accuracy500: 0.3400 - 45s/epoch - 72ms/step
Epoch 6/50
618/618 - 45s - loss: 3.2493 - accuracy500: 0.3916 - val_loss: 3.3825 - val_accuracy500: 0.3258 - 45s/epoch - 73ms/step
Epoch 7/50
618/618 - 47s - loss: 3.2450 - accuracy500: 0.3939 - val_loss: 3.3763 - val_accuracy500: 0.3311 - 47s/epoch - 76ms/step
Epoch 8/50
618/618 - 44s - loss: 3.2404 - accuracy500: 0.3982 - val_loss: 3.4050 - val_accuracy500: 0.3259 - 44s/epoch - 72ms/step
Epoch 9/50
618/618 - 44s - loss: 3.2364 - accuracy500: 0.4010 - val_loss: 3.4163 - val_accuracy500: 0.3238 - 44s/epoch - 71ms/step
Epoch 10/50
618/618 - 43s - loss: 3.2324 - accuracy500: 0.4035 - val_loss: 3.4136 - val_accuracy500: 0.3199 - 43s/epoch - 69ms/step
Epoch 11/50
618/618 - 44s - loss: 3.2281 - accuracy500: 0.4059 - val_loss: 3.4082 - val_accuracy500: 0.3205 - 44s/epoch - 71ms/step
Epoch 12/50
618/618 - 44s - loss: 3.2236 - accuracy500: 0.4076 - val_loss: 3.4275 - val_accuracy500: 0.3157 - 44s/epoch - 71ms/step
Epoch 13/50
618/618 - 45s - loss: 3.2207 - accuracy500: 0.4091 - val_loss: 3.4358 - val_accuracy500: 0.3151 - 45s/epoch - 73ms/step
testing model: results/PCAR/W6/deepVOL_L2/h500
Evaluating performance on  test set...
1722/1722 - 60s - 60s/epoch - 35ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1133025
{'0': {'precision': 0.34370937948963537, 'recall': 0.033674953582990934, 'f1-score': 0.06134010548935339, 'support': 149191}, '1': {'precision': 0.31818530435449527, 'recall': 0.6733026778469029, 'f1-score': 0.4321484905903711, 'support': 129395}, '2': {'precision': 0.38504853222027524, 'recall': 0.3616911098370661, 'f1-score': 0.3730045202265835, 'support': 162213}, 'accuracy': 0.3421446055912105, 'macro avg': {'precision': 0.3489810720214686, 'recall': 0.35622291375565335, 'f1-score': 0.2888310387687693, 'support': 440799}, 'weighted avg': {'precision': 0.3514295882010522, 'recall': 0.3421446055912105, 'f1-score': 0.28488138098661286, 'support': 440799}}
[[ 5024 89584 54583]
 [ 3154 87122 39119]
 [ 6439 97103 58671]]
Evaluating performance on  train set...
618/618 - 21s - 21s/epoch - 35ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107285
{'0': {'precision': 0.3969094922737307, 'recall': 0.03318139037038404, 'f1-score': 0.06124291091166102, 'support': 54187}, '1': {'precision': 0.3533043520734626, 'recall': 0.7047017789988503, 'f1-score': 0.4706479445102351, 'support': 51321}, '2': {'precision': 0.3581808923185397, 'recall': 0.3487081704642959, 'f1-score': 0.35338106141850956, 'support': 52445}, 'accuracy': 0.3561312542338544, 'macro avg': {'precision': 0.36946491222191097, 'recall': 0.36219711327784343, 'f1-score': 0.29509063894680193, 'support': 157953}, 'weighted avg': {'precision': 0.3698825866444109, 'recall': 0.3561312542338544, 'f1-score': 0.2912623536107177, 'support': 157953}}
[[ 1798 33737 18652]
 [ 1037 36166 14118]
 [ 1695 32462 18288]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1107467
{'0': {'precision': 0.37448559670781895, 'recall': 0.0329232995658466, 'f1-score': 0.06052544063851015, 'support': 19348}, '1': {'precision': 0.3396849252569711, 'recall': 0.6978936921041023, 'f1-score': 0.45695615286026314, 'support': 18136}, '2': {'precision': 0.36647911707422637, 'recall': 0.3393447550345657, 'f1-score': 0.35239036570774596, 'support': 19962}, 'accuracy': 0.3493367684434077, 'macro avg': {'precision': 0.36021654634633876, 'recall': 0.3567205822348382, 'f1-score': 0.2899573197355064, 'support': 57446}, 'weighted avg': {'precision': 0.36071666024786786, 'recall': 0.3493367684434077, 'f1-score': 0.2871012689135127, 'support': 57446}}
[[  637 12076  6635]
 [  404 12657  5075]
 [  660 12528  6774]]
training model: results/PCAR/W6/deepVOL_L2/h1000
Epoch 1/50
618/618 - 53s - loss: 3.3239 - accuracy1000: 0.3691 - val_loss: 3.3601 - val_accuracy1000: 0.3474 - 53s/epoch - 86ms/step
Epoch 2/50
618/618 - 44s - loss: 3.2901 - accuracy1000: 0.3742 - val_loss: 3.3220 - val_accuracy1000: 0.3603 - 44s/epoch - 71ms/step
Epoch 3/50
618/618 - 45s - loss: 3.2674 - accuracy1000: 0.3816 - val_loss: 3.3270 - val_accuracy1000: 0.3487 - 45s/epoch - 72ms/step
Epoch 4/50
618/618 - 47s - loss: 3.2565 - accuracy1000: 0.3885 - val_loss: 3.3317 - val_accuracy1000: 0.3554 - 47s/epoch - 76ms/step
Epoch 5/50
618/618 - 44s - loss: 3.2467 - accuracy1000: 0.3943 - val_loss: 3.3221 - val_accuracy1000: 0.3571 - 44s/epoch - 70ms/step
Epoch 6/50
618/618 - 44s - loss: 3.2390 - accuracy1000: 0.3984 - val_loss: 3.3198 - val_accuracy1000: 0.3561 - 44s/epoch - 71ms/step
Epoch 7/50
618/618 - 43s - loss: 3.2362 - accuracy1000: 0.3978 - val_loss: 3.3237 - val_accuracy1000: 0.3557 - 43s/epoch - 70ms/step
Epoch 8/50
618/618 - 43s - loss: 3.2324 - accuracy1000: 0.3995 - val_loss: 3.3230 - val_accuracy1000: 0.3565 - 43s/epoch - 70ms/step
Epoch 9/50
618/618 - 45s - loss: 3.2267 - accuracy1000: 0.4012 - val_loss: 3.3231 - val_accuracy1000: 0.3558 - 45s/epoch - 73ms/step
Epoch 10/50
618/618 - 43s - loss: 3.2205 - accuracy1000: 0.4042 - val_loss: 3.3354 - val_accuracy1000: 0.3569 - 43s/epoch - 70ms/step
Epoch 11/50
618/618 - 45s - loss: 3.2187 - accuracy1000: 0.4045 - val_loss: 3.3506 - val_accuracy1000: 0.3545 - 45s/epoch - 73ms/step
Epoch 12/50
618/618 - 46s - loss: 3.2113 - accuracy1000: 0.4060 - val_loss: 3.3477 - val_accuracy1000: 0.3561 - 46s/epoch - 74ms/step
Epoch 13/50
618/618 - 45s - loss: 3.2071 - accuracy1000: 0.4082 - val_loss: 3.3579 - val_accuracy1000: 0.3550 - 45s/epoch - 73ms/step
Epoch 14/50
618/618 - 45s - loss: 3.2025 - accuracy1000: 0.4124 - val_loss: 3.3736 - val_accuracy1000: 0.3542 - 45s/epoch - 73ms/step
Epoch 15/50
618/618 - 45s - loss: 3.1994 - accuracy1000: 0.4136 - val_loss: 3.3686 - val_accuracy1000: 0.3567 - 45s/epoch - 72ms/step
Epoch 16/50
618/618 - 43s - loss: 3.1924 - accuracy1000: 0.4150 - val_loss: 3.3883 - val_accuracy1000: 0.3553 - 43s/epoch - 70ms/step
testing model: results/PCAR/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
1722/1722 - 60s - 60s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939324
{'0': {'precision': 0.35409392949656493, 'recall': 0.043887322370808786, 'f1-score': 0.07809530906516636, 'support': 143276}, '1': {'precision': 0.3911951305916074, 'recall': 0.0927570539498301, 'f1-score': 0.14995740898485244, 'support': 130955}, '2': {'precision': 0.38558636699915816, 'recall': 0.9074131886076557, 'f1-score': 0.5412007347491219, 'support': 166568}, 'accuracy': 0.3847127602376593, 'macro avg': {'precision': 0.37695847569577684, 'recall': 0.3480191883094315, 'f1-score': 0.25641781759971355, 'support': 440799}, 'weighted avg': {'precision': 0.3770164409345066, 'recall': 0.3847127602376593, 'f1-score': 0.27444159351750763, 'support': 440799}}
[[  6288   9026 127962]
 [  5926  12147 112882]
 [  5544   9878 151146]]
Evaluating performance on  train set...
618/618 - 22s - 22s/epoch - 36ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080586
{'0': {'precision': 0.36366336633663365, 'recall': 0.06713703412601217, 'f1-score': 0.11334845468993504, 'support': 54709}, '1': {'precision': 0.41555276567461785, 'recall': 0.11115720437754337, 'f1-score': 0.17539703567476583, 'support': 50622}, '2': {'precision': 0.339664363571386, 'recall': 0.8669567861350765, 'f1-score': 0.4880974033616142, 'support': 52622}, 'accuracy': 0.34770469696681927, 'macro avg': {'precision': 0.3729601651942125, 'recall': 0.3484170082128773, 'f1-score': 0.258947631242105, 'support': 157953}, 'weighted avg': {'precision': 0.3722980212642044, 'recall': 0.34770469696681927, 'f1-score': 0.2580817769036012, 'support': 157953}}
[[ 3673  4057 46979]
 [ 3283  5627 41712]
 [ 3144  3857 45621]]
Evaluating performance on  val set...
225/225 - 8s - 8s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065613
{'0': {'precision': 0.35063480209111275, 'recall': 0.04764320868638693, 'f1-score': 0.08388797069727968, 'support': 19709}, '1': {'precision': 0.38124470787468245, 'recall': 0.10246344654946805, 'f1-score': 0.16151742074346442, 'support': 17577}, '2': {'precision': 0.3533090880025577, 'recall': 0.8770337301587302, 'f1-score': 0.5037034926784798, 'support': 20160}, 'accuracy': 0.3554816697420186, 'macro avg': {'precision': 0.3617295326561176, 'recall': 0.34238012846486177, 'f1-score': 0.24970296137307466, 'support': 57446}, 'weighted avg': {'precision': 0.3609391560571423, 'recall': 0.3554816697420186, 'f1-score': 0.2549699218619001, 'support': 57446}}
[[  939  1334 17436]
 [  849  1801 14927]
 [  890  1589 17681]]
training model: results/PCAR/W6/deepVOL_L3/h10
Epoch 1/50
618/618 - 67s - loss: 3.3029 - accuracy10: 0.3684 - val_loss: 3.2974 - val_accuracy10: 0.3701 - 67s/epoch - 109ms/step
Epoch 2/50
618/618 - 61s - loss: 3.2778 - accuracy10: 0.3774 - val_loss: 3.2769 - val_accuracy10: 0.3717 - 61s/epoch - 99ms/step
Epoch 3/50
618/618 - 64s - loss: 3.2604 - accuracy10: 0.3882 - val_loss: 3.2756 - val_accuracy10: 0.3713 - 64s/epoch - 104ms/step
Epoch 4/50
618/618 - 62s - loss: 3.2345 - accuracy10: 0.4067 - val_loss: 3.2459 - val_accuracy10: 0.3925 - 62s/epoch - 100ms/step
Epoch 5/50
618/618 - 64s - loss: 3.2047 - accuracy10: 0.4222 - val_loss: 3.2408 - val_accuracy10: 0.4001 - 64s/epoch - 104ms/step
Epoch 6/50
618/618 - 59s - loss: 3.1789 - accuracy10: 0.4328 - val_loss: 3.2166 - val_accuracy10: 0.4111 - 59s/epoch - 95ms/step
Epoch 7/50
618/618 - 56s - loss: 3.1561 - accuracy10: 0.4420 - val_loss: 3.2074 - val_accuracy10: 0.4164 - 56s/epoch - 91ms/step
Epoch 8/50
618/618 - 59s - loss: 3.1390 - accuracy10: 0.4505 - val_loss: 3.1900 - val_accuracy10: 0.4246 - 59s/epoch - 95ms/step
Epoch 9/50
618/618 - 60s - loss: 3.1231 - accuracy10: 0.4566 - val_loss: 3.1694 - val_accuracy10: 0.4339 - 60s/epoch - 97ms/step
Epoch 10/50
618/618 - 62s - loss: 3.1122 - accuracy10: 0.4606 - val_loss: 3.1810 - val_accuracy10: 0.4350 - 62s/epoch - 101ms/step
Epoch 11/50
618/618 - 63s - loss: 3.1036 - accuracy10: 0.4627 - val_loss: 3.1518 - val_accuracy10: 0.4404 - 63s/epoch - 102ms/step
Epoch 12/50
618/618 - 63s - loss: 3.0923 - accuracy10: 0.4675 - val_loss: 3.1564 - val_accuracy10: 0.4418 - 63s/epoch - 103ms/step
Epoch 13/50
618/618 - 61s - loss: 3.0843 - accuracy10: 0.4706 - val_loss: 3.1356 - val_accuracy10: 0.4482 - 61s/epoch - 99ms/step
Epoch 14/50
618/618 - 63s - loss: 3.0747 - accuracy10: 0.4730 - val_loss: 3.1470 - val_accuracy10: 0.4423 - 63s/epoch - 101ms/step
Epoch 15/50
618/618 - 63s - loss: 3.0673 - accuracy10: 0.4757 - val_loss: 3.1594 - val_accuracy10: 0.4360 - 63s/epoch - 102ms/step
Epoch 16/50
618/618 - 60s - loss: 3.0608 - accuracy10: 0.4785 - val_loss: 3.1613 - val_accuracy10: 0.4377 - 60s/epoch - 97ms/step
Epoch 17/50
618/618 - 60s - loss: 3.0533 - accuracy10: 0.4808 - val_loss: 3.1484 - val_accuracy10: 0.4423 - 60s/epoch - 98ms/step
Epoch 18/50
618/618 - 60s - loss: 3.0457 - accuracy10: 0.4829 - val_loss: 3.1531 - val_accuracy10: 0.4413 - 60s/epoch - 98ms/step
Epoch 19/50
618/618 - 62s - loss: 3.0423 - accuracy10: 0.4839 - val_loss: 3.1558 - val_accuracy10: 0.4411 - 62s/epoch - 100ms/step
Epoch 20/50
618/618 - 59s - loss: 3.0362 - accuracy10: 0.4854 - val_loss: 3.1444 - val_accuracy10: 0.4449 - 59s/epoch - 96ms/step
Epoch 21/50
618/618 - 61s - loss: 3.0293 - accuracy10: 0.4881 - val_loss: 3.1308 - val_accuracy10: 0.4509 - 61s/epoch - 99ms/step
Epoch 22/50
618/618 - 62s - loss: 3.0248 - accuracy10: 0.4908 - val_loss: 3.1373 - val_accuracy10: 0.4492 - 62s/epoch - 100ms/step
Epoch 23/50
618/618 - 63s - loss: 3.0200 - accuracy10: 0.4912 - val_loss: 3.1381 - val_accuracy10: 0.4486 - 63s/epoch - 102ms/step
Epoch 24/50
618/618 - 60s - loss: 3.0156 - accuracy10: 0.4913 - val_loss: 3.1509 - val_accuracy10: 0.4436 - 60s/epoch - 97ms/step
Epoch 25/50
618/618 - 61s - loss: 3.0118 - accuracy10: 0.4929 - val_loss: 3.1501 - val_accuracy10: 0.4457 - 61s/epoch - 99ms/step
Epoch 26/50
618/618 - 61s - loss: 3.0059 - accuracy10: 0.4956 - val_loss: 3.1377 - val_accuracy10: 0.4504 - 61s/epoch - 99ms/step
Epoch 27/50
618/618 - 62s - loss: 3.0017 - accuracy10: 0.4957 - val_loss: 3.1361 - val_accuracy10: 0.4483 - 62s/epoch - 100ms/step
Epoch 28/50
618/618 - 61s - loss: 2.9983 - accuracy10: 0.4975 - val_loss: 3.1606 - val_accuracy10: 0.4411 - 61s/epoch - 98ms/step
Epoch 29/50
618/618 - 63s - loss: 2.9938 - accuracy10: 0.4982 - val_loss: 3.1483 - val_accuracy10: 0.4454 - 63s/epoch - 102ms/step
Epoch 30/50
618/618 - 59s - loss: 2.9871 - accuracy10: 0.5009 - val_loss: 3.1416 - val_accuracy10: 0.4482 - 59s/epoch - 96ms/step
Epoch 31/50
618/618 - 58s - loss: 2.9839 - accuracy10: 0.5012 - val_loss: 3.1424 - val_accuracy10: 0.4485 - 58s/epoch - 94ms/step
testing model: results/PCAR/W6/deepVOL_L3/h10
Evaluating performance on  test set...
1722/1722 - 81s - 81s/epoch - 47ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0376122
{'0': {'precision': 0.44681006168064574, 'recall': 0.6863867407439667, 'f1-score': 0.5412731509873666, 'support': 160733}, '1': {'precision': 0.432374553290592, 'recall': 0.27854759297422677, 'f1-score': 0.33881879110160157, 'support': 115973}, '2': {'precision': 0.5136067265815775, 'recall': 0.37299580116153647, 'f1-score': 0.4321511533491961, 'support': 164093}, 'accuracy': 0.4624216479619963, 'macro avg': {'precision': 0.4642637805176051, 'recall': 0.44597671162657665, 'f1-score': 0.43741436514605475, 'support': 440799}, 'weighted avg': {'precision': 0.4678780221775363, 'recall': 0.4624216479619963, 'f1-score': 0.4473859247516625, 'support': 440799}}
[[110325  19006  31402]
 [ 57108  32304  26561]
 [ 79484  23403  61206]]
Evaluating performance on  train set...
618/618 - 29s - 29s/epoch - 47ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0218706
{'0': {'precision': 0.44168669009291794, 'recall': 0.614761545748033, 'f1-score': 0.5140469416785206, 'support': 51729}, '1': {'precision': 0.5337792098778804, 'recall': 0.36769753040364095, 'f1-score': 0.43543951492660943, 'support': 53612}, '2': {'precision': 0.47695979438222874, 'recall': 0.44442332547707747, 'f1-score': 0.46011708564962855, 'support': 52612}, 'accuracy': 0.4741663659442999, 'macro avg': {'precision': 0.4841418981176757, 'recall': 0.47562746720958377, 'f1-score': 0.4698678474182529, 'support': 157953}, 'weighted avg': {'precision': 0.4846934878972055, 'recall': 0.4741663659442999, 'f1-score': 0.4694029086534085, 'support': 157953}}
[[31801  8054 11874]
 [20132 19713 13767]
 [20066  9164 23382]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 49ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0459118
{'0': {'precision': 0.41249913055574877, 'recall': 0.6401662348877375, 'f1-score': 0.5017131255023053, 'support': 18528}, '1': {'precision': 0.51288715616201, 'recall': 0.3405397631944777, 'f1-score': 0.40931090112929247, 'support': 20861}, '2': {'precision': 0.4578532443905397, 'recall': 0.37630835686991193, 'f1-score': 0.41309502097391937, 'support': 18057}, 'accuracy': 0.4484211259269575, 'macro avg': {'precision': 0.4610798437027661, 'recall': 0.45233811831737575, 'f1-score': 0.4413730158685057, 'support': 57446}, 'weighted avg': {'precision': 0.4632102999267587, 'recall': 0.4484211259269575, 'f1-score': 0.4403027589647833, 'support': 57446}}
[[11861  3130  3537]
 [ 9248  7104  4509]
 [ 7645  3617  6795]]
training model: results/PCAR/W6/deepVOL_L3/h20
Epoch 1/50
618/618 - 65s - loss: 3.3175 - accuracy20: 0.3631 - val_loss: 3.3424 - val_accuracy20: 0.3436 - 65s/epoch - 106ms/step
Epoch 2/50
618/618 - 58s - loss: 3.2895 - accuracy20: 0.3690 - val_loss: 3.3064 - val_accuracy20: 0.3538 - 58s/epoch - 94ms/step
Epoch 3/50
618/618 - 61s - loss: 3.2789 - accuracy20: 0.3748 - val_loss: 3.2797 - val_accuracy20: 0.3670 - 61s/epoch - 99ms/step
Epoch 4/50
618/618 - 60s - loss: 3.2547 - accuracy20: 0.3929 - val_loss: 3.2677 - val_accuracy20: 0.3777 - 60s/epoch - 97ms/step
Epoch 5/50
618/618 - 62s - loss: 3.2354 - accuracy20: 0.4052 - val_loss: 3.2597 - val_accuracy20: 0.3842 - 62s/epoch - 101ms/step
Epoch 6/50
618/618 - 61s - loss: 3.2218 - accuracy20: 0.4130 - val_loss: 3.2604 - val_accuracy20: 0.3880 - 61s/epoch - 99ms/step
Epoch 7/50
618/618 - 61s - loss: 3.2072 - accuracy20: 0.4205 - val_loss: 3.2581 - val_accuracy20: 0.3905 - 61s/epoch - 99ms/step
Epoch 8/50
618/618 - 60s - loss: 3.1991 - accuracy20: 0.4256 - val_loss: 3.2544 - val_accuracy20: 0.3902 - 60s/epoch - 97ms/step
Epoch 9/50
618/618 - 61s - loss: 3.1912 - accuracy20: 0.4299 - val_loss: 3.2399 - val_accuracy20: 0.3941 - 61s/epoch - 98ms/step
Epoch 10/50
618/618 - 60s - loss: 3.1860 - accuracy20: 0.4330 - val_loss: 3.2548 - val_accuracy20: 0.3929 - 60s/epoch - 97ms/step
Epoch 11/50
618/618 - 59s - loss: 3.1786 - accuracy20: 0.4352 - val_loss: 3.2557 - val_accuracy20: 0.3966 - 59s/epoch - 96ms/step
Epoch 12/50
618/618 - 62s - loss: 3.1728 - accuracy20: 0.4383 - val_loss: 3.2609 - val_accuracy20: 0.3988 - 62s/epoch - 100ms/step
Epoch 13/50
618/618 - 59s - loss: 3.1665 - accuracy20: 0.4416 - val_loss: 3.2779 - val_accuracy20: 0.3939 - 59s/epoch - 96ms/step
Epoch 14/50
618/618 - 61s - loss: 3.1611 - accuracy20: 0.4441 - val_loss: 3.2484 - val_accuracy20: 0.4023 - 61s/epoch - 99ms/step
Epoch 15/50
618/618 - 61s - loss: 3.1586 - accuracy20: 0.4446 - val_loss: 3.2724 - val_accuracy20: 0.4016 - 61s/epoch - 99ms/step
Epoch 16/50
618/618 - 60s - loss: 3.1533 - accuracy20: 0.4477 - val_loss: 3.2682 - val_accuracy20: 0.4028 - 60s/epoch - 96ms/step
Epoch 17/50
618/618 - 60s - loss: 3.1483 - accuracy20: 0.4484 - val_loss: 3.2566 - val_accuracy20: 0.4039 - 60s/epoch - 98ms/step
Epoch 18/50
618/618 - 59s - loss: 3.1418 - accuracy20: 0.4512 - val_loss: 3.2584 - val_accuracy20: 0.4042 - 59s/epoch - 96ms/step
Epoch 19/50
618/618 - 59s - loss: 3.1398 - accuracy20: 0.4515 - val_loss: 3.2642 - val_accuracy20: 0.4054 - 59s/epoch - 95ms/step
testing model: results/PCAR/W6/deepVOL_L3/h20
Evaluating performance on  test set...
1722/1722 - 86s - 86s/epoch - 50ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.08682
{'0': {'precision': 0.4166748520268771, 'recall': 0.7087623762376237, 'f1-score': 0.5248155131609394, 'support': 161600}, '1': {'precision': 0.33495655983061984, 'recall': 0.4022779882154882, 'f1-score': 0.36554350684014697, 'support': 114048}, '2': {'precision': 0.5006563493160149, 'recall': 0.08775605355099272, 'f1-score': 0.14933616350419116, 'support': 165151}, 'accuracy': 0.3967976333884605, 'macro avg': {'precision': 0.4174292537245039, 'recall': 0.3995988060013682, 'f1-score': 0.3465650611684259, 'support': 440799}, 'weighted avg': {'precision': 0.42699660972233383, 'recall': 0.3967976333884605, 'f1-score': 0.34292888489718343, 'support': 440799}}
[[114536  39741   7323]
 [ 61037  45879   7132]
 [ 99308  51350  14493]]
Evaluating performance on  train set...
618/618 - 33s - 33s/epoch - 53ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743709
{'0': {'precision': 0.4029648956356736, 'recall': 0.6466826538768985, 'f1-score': 0.496529350732855, 'support': 52542}, '1': {'precision': 0.4002821311221593, 'recall': 0.4424583555183692, 'f1-score': 0.4203148567970591, 'support': 52588}, '2': {'precision': 0.4519478844169247, 'recall': 0.13265054994983247, 'f1-score': 0.2051019362770208, 'support': 52823}, 'accuracy': 0.4067855627939957, 'macro avg': {'precision': 0.4183983037249192, 'recall': 0.40726385311503344, 'f1-score': 0.373982047935645, 'support': 157953}, 'weighted avg': {'precision': 0.41845271287343005, 'recall': 0.4067855627939957, 'f1-score': 0.3736951018050336, 'support': 157953}}
[[33978 14968  3596]
 [24419 23268  4901]
 [25923 19893  7007]]
Evaluating performance on  val set...
225/225 - 12s - 12s/epoch - 52ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798126
{'0': {'precision': 0.3852422972061798, 'recall': 0.6917772162560539, 'f1-score': 0.49488767959026114, 'support': 18996}, '1': {'precision': 0.4063969896519285, 'recall': 0.3914816492976892, 'f1-score': 0.3987999076852065, 'support': 19863}, '2': {'precision': 0.45274934539395384, 'recall': 0.10232958519395276, 'f1-score': 0.16692996313849393, 'support': 18587}, 'accuracy': 0.3972252202068029, 'macro avg': {'precision': 0.41479621075068734, 'recall': 0.395196150249232, 'f1-score': 0.3535391834713206, 'support': 57446}, 'weighted avg': {'precision': 0.41439922999029116, 'recall': 0.3972252202068029, 'f1-score': 0.35555088522617834, 'support': 57446}}
[[13141  4889   966]
 [10754  7776  1333]
 [10216  6469  1902]]
training model: results/PCAR/W6/deepVOL_L3/h30
Epoch 1/50
618/618 - 64s - loss: 3.3123 - accuracy30: 0.3602 - val_loss: 3.3405 - val_accuracy30: 0.3372 - 64s/epoch - 104ms/step
Epoch 2/50
618/618 - 62s - loss: 3.2894 - accuracy30: 0.3656 - val_loss: 3.3313 - val_accuracy30: 0.3397 - 62s/epoch - 100ms/step
Epoch 3/50
618/618 - 62s - loss: 3.2819 - accuracy30: 0.3715 - val_loss: 3.3038 - val_accuracy30: 0.3398 - 62s/epoch - 100ms/step
Epoch 4/50
618/618 - 61s - loss: 3.2644 - accuracy30: 0.3839 - val_loss: 3.2909 - val_accuracy30: 0.3443 - 61s/epoch - 99ms/step
Epoch 5/50
618/618 - 60s - loss: 3.2553 - accuracy30: 0.3912 - val_loss: 3.2824 - val_accuracy30: 0.3495 - 60s/epoch - 98ms/step
Epoch 6/50
618/618 - 60s - loss: 3.2430 - accuracy30: 0.3987 - val_loss: 3.2841 - val_accuracy30: 0.3479 - 60s/epoch - 98ms/step
Epoch 7/50
618/618 - 60s - loss: 3.2307 - accuracy30: 0.4093 - val_loss: 3.2814 - val_accuracy30: 0.3509 - 60s/epoch - 97ms/step
Epoch 8/50
618/618 - 59s - loss: 3.2196 - accuracy30: 0.4147 - val_loss: 3.2697 - val_accuracy30: 0.3600 - 59s/epoch - 96ms/step
Epoch 9/50
618/618 - 61s - loss: 3.2126 - accuracy30: 0.4179 - val_loss: 3.2769 - val_accuracy30: 0.3576 - 61s/epoch - 99ms/step
Epoch 10/50
618/618 - 59s - loss: 3.2062 - accuracy30: 0.4210 - val_loss: 3.2648 - val_accuracy30: 0.3651 - 59s/epoch - 95ms/step
Epoch 11/50
618/618 - 59s - loss: 3.2000 - accuracy30: 0.4240 - val_loss: 3.2567 - val_accuracy30: 0.3807 - 59s/epoch - 95ms/step
Epoch 12/50
618/618 - 61s - loss: 3.1960 - accuracy30: 0.4273 - val_loss: 3.2607 - val_accuracy30: 0.3719 - 61s/epoch - 98ms/step
Epoch 13/50
618/618 - 60s - loss: 3.1912 - accuracy30: 0.4300 - val_loss: 3.2600 - val_accuracy30: 0.3771 - 60s/epoch - 97ms/step
Epoch 14/50
618/618 - 60s - loss: 3.1884 - accuracy30: 0.4306 - val_loss: 3.2539 - val_accuracy30: 0.3848 - 60s/epoch - 98ms/step
Epoch 15/50
618/618 - 59s - loss: 3.1855 - accuracy30: 0.4303 - val_loss: 3.2491 - val_accuracy30: 0.3911 - 59s/epoch - 95ms/step
Epoch 16/50
618/618 - 60s - loss: 3.1807 - accuracy30: 0.4336 - val_loss: 3.2522 - val_accuracy30: 0.3892 - 60s/epoch - 96ms/step
Epoch 17/50
618/618 - 59s - loss: 3.1755 - accuracy30: 0.4359 - val_loss: 3.2595 - val_accuracy30: 0.3831 - 59s/epoch - 96ms/step
Epoch 18/50
618/618 - 60s - loss: 3.1699 - accuracy30: 0.4393 - val_loss: 3.2487 - val_accuracy30: 0.3949 - 60s/epoch - 97ms/step
Epoch 19/50
618/618 - 58s - loss: 3.1667 - accuracy30: 0.4400 - val_loss: 3.2517 - val_accuracy30: 0.3960 - 58s/epoch - 95ms/step
Epoch 20/50
618/618 - 59s - loss: 3.1619 - accuracy30: 0.4414 - val_loss: 3.2583 - val_accuracy30: 0.3879 - 59s/epoch - 96ms/step
Epoch 21/50
618/618 - 58s - loss: 3.1581 - accuracy30: 0.4438 - val_loss: 3.2605 - val_accuracy30: 0.3882 - 58s/epoch - 95ms/step
Epoch 22/50
618/618 - 58s - loss: 3.1563 - accuracy30: 0.4460 - val_loss: 3.2590 - val_accuracy30: 0.3943 - 58s/epoch - 94ms/step
Epoch 23/50
618/618 - 58s - loss: 3.1498 - accuracy30: 0.4469 - val_loss: 3.2773 - val_accuracy30: 0.3864 - 58s/epoch - 94ms/step
Epoch 24/50
618/618 - 60s - loss: 3.1457 - accuracy30: 0.4484 - val_loss: 3.2854 - val_accuracy30: 0.3858 - 60s/epoch - 96ms/step
Epoch 25/50
618/618 - 60s - loss: 3.1426 - accuracy30: 0.4477 - val_loss: 3.2747 - val_accuracy30: 0.3906 - 60s/epoch - 96ms/step
Epoch 26/50
618/618 - 60s - loss: 3.1404 - accuracy30: 0.4496 - val_loss: 3.2846 - val_accuracy30: 0.3874 - 60s/epoch - 97ms/step
Epoch 27/50
618/618 - 60s - loss: 3.1370 - accuracy30: 0.4513 - val_loss: 3.2864 - val_accuracy30: 0.3885 - 60s/epoch - 96ms/step
Epoch 28/50
618/618 - 58s - loss: 3.1337 - accuracy30: 0.4530 - val_loss: 3.2760 - val_accuracy30: 0.3917 - 58s/epoch - 94ms/step
testing model: results/PCAR/W6/deepVOL_L3/h30
Evaluating performance on  test set...
1722/1722 - 82s - 82s/epoch - 48ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0897391
{'0': {'precision': 0.43634211646855897, 'recall': 0.38252507038689065, 'f1-score': 0.4076651293254579, 'support': 158055}, '1': {'precision': 0.30800855209973194, 'recall': 0.47461502528253335, 'f1-score': 0.3735780289957909, 'support': 122021}, '2': {'precision': 0.45938326299753096, 'recall': 0.3264498547189886, 'f1-score': 0.38167289233533497, 'support': 160723}, 'accuracy': 0.3875712059237884, 'macro avg': {'precision': 0.401244643855274, 'recall': 0.39452998346280416, 'f1-score': 0.3876386835521946, 'support': 440799}, 'weighted avg': {'precision': 0.4092183079656525, 'recall': 0.3875712059237884, 'f1-score': 0.3887519911942693, 'support': 440799}}
[[60460 64549 33046]
 [35408 57913 28700]
 [42693 65562 52468]]
Evaluating performance on  train set...
618/618 - 31s - 31s/epoch - 50ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0760638
{'0': {'precision': 0.44812911514372894, 'recall': 0.3183079847908745, 'f1-score': 0.3722238278384206, 'support': 52600}, '1': {'precision': 0.36954842426384904, 'recall': 0.5392522114594677, 'f1-score': 0.43855560216908274, 'support': 52341}, '2': {'precision': 0.43113041118197853, 'recall': 0.35957896325360295, 'f1-score': 0.39211733486927364, 'support': 53012}, 'accuracy': 0.4053737504194286, 'macro avg': {'precision': 0.41626931686318547, 'recall': 0.40571305316798173, 'f1-score': 0.400965588292259, 'support': 157953}, 'weighted avg': {'precision': 0.4163846896768868, 'recall': 0.4053737504194286, 'f1-score': 0.40088087135744693, 'support': 157953}}
[[16743 24088 11769]
 [10733 28225 13383]
 [ 9886 24064 19062]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 47ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0832622
{'0': {'precision': 0.4180050718512257, 'recall': 0.36196800167311516, 'f1-score': 0.38797354853171934, 'support': 19126}, '1': {'precision': 0.36892541949168595, 'recall': 0.5004367260956687, 'f1-score': 0.4247339961625677, 'support': 19463}, '2': {'precision': 0.4159359248774425, 'recall': 0.31945696558307257, 'f1-score': 0.361367726454709, 'support': 18857}, 'accuracy': 0.39492741008947535, 'macro avg': {'precision': 0.4009554720734514, 'recall': 0.3939538977839521, 'f1-score': 0.39135842371633206, 'support': 57446}, 'weighted avg': {'precision': 0.4006974233054897, 'recall': 0.39492741008947535, 'f1-score': 0.3916946536623292, 'support': 57446}}
[[6923 8264 3939]
 [5203 9740 4520]
 [4436 8397 6024]]
training model: results/PCAR/W6/deepVOL_L3/h50
Epoch 1/50
618/618 - 66s - loss: 3.2784 - accuracy50: 0.3843 - val_loss: 3.3225 - val_accuracy50: 0.3383 - 66s/epoch - 107ms/step
Epoch 2/50
618/618 - 59s - loss: 3.2518 - accuracy50: 0.3881 - val_loss: 3.3134 - val_accuracy50: 0.3356 - 59s/epoch - 95ms/step
Epoch 3/50
618/618 - 60s - loss: 3.2533 - accuracy50: 0.3861 - val_loss: 3.3068 - val_accuracy50: 0.3415 - 60s/epoch - 97ms/step
Epoch 4/50
618/618 - 60s - loss: 3.2504 - accuracy50: 0.3847 - val_loss: 3.3021 - val_accuracy50: 0.3412 - 60s/epoch - 97ms/step
Epoch 5/50
618/618 - 63s - loss: 3.2456 - accuracy50: 0.3872 - val_loss: 3.3008 - val_accuracy50: 0.3393 - 63s/epoch - 101ms/step
Epoch 6/50
618/618 - 61s - loss: 3.2394 - accuracy50: 0.3962 - val_loss: 3.2958 - val_accuracy50: 0.3528 - 61s/epoch - 98ms/step
Epoch 7/50
618/618 - 60s - loss: 3.2216 - accuracy50: 0.4104 - val_loss: 3.2915 - val_accuracy50: 0.3601 - 60s/epoch - 97ms/step
Epoch 8/50
618/618 - 58s - loss: 3.2139 - accuracy50: 0.4121 - val_loss: 3.2942 - val_accuracy50: 0.3608 - 58s/epoch - 94ms/step
Epoch 9/50
618/618 - 61s - loss: 3.2068 - accuracy50: 0.4178 - val_loss: 3.2878 - val_accuracy50: 0.3678 - 61s/epoch - 98ms/step
Epoch 10/50
618/618 - 59s - loss: 3.2042 - accuracy50: 0.4181 - val_loss: 3.2894 - val_accuracy50: 0.3659 - 59s/epoch - 95ms/step
Epoch 11/50
618/618 - 61s - loss: 3.1987 - accuracy50: 0.4217 - val_loss: 3.2863 - val_accuracy50: 0.3690 - 61s/epoch - 99ms/step
Epoch 12/50
618/618 - 61s - loss: 3.1933 - accuracy50: 0.4238 - val_loss: 3.2912 - val_accuracy50: 0.3693 - 61s/epoch - 98ms/step
Epoch 13/50
618/618 - 57s - loss: 3.1883 - accuracy50: 0.4274 - val_loss: 3.2917 - val_accuracy50: 0.3697 - 57s/epoch - 92ms/step
Epoch 14/50
618/618 - 62s - loss: 3.1835 - accuracy50: 0.4283 - val_loss: 3.2924 - val_accuracy50: 0.3687 - 62s/epoch - 100ms/step
Epoch 15/50
618/618 - 60s - loss: 3.1787 - accuracy50: 0.4314 - val_loss: 3.3052 - val_accuracy50: 0.3679 - 60s/epoch - 97ms/step
Epoch 16/50
618/618 - 60s - loss: 3.1754 - accuracy50: 0.4333 - val_loss: 3.2925 - val_accuracy50: 0.3722 - 60s/epoch - 96ms/step
Epoch 17/50
618/618 - 59s - loss: 3.1731 - accuracy50: 0.4340 - val_loss: 3.2981 - val_accuracy50: 0.3672 - 59s/epoch - 96ms/step
Epoch 18/50
618/618 - 60s - loss: 3.1677 - accuracy50: 0.4369 - val_loss: 3.2959 - val_accuracy50: 0.3716 - 60s/epoch - 97ms/step
Epoch 19/50
618/618 - 60s - loss: 3.1652 - accuracy50: 0.4368 - val_loss: 3.3023 - val_accuracy50: 0.3699 - 60s/epoch - 97ms/step
Epoch 20/50
618/618 - 60s - loss: 3.1618 - accuracy50: 0.4395 - val_loss: 3.3106 - val_accuracy50: 0.3728 - 60s/epoch - 97ms/step
Epoch 21/50
618/618 - 61s - loss: 3.1583 - accuracy50: 0.4406 - val_loss: 3.3084 - val_accuracy50: 0.3703 - 61s/epoch - 98ms/step
testing model: results/PCAR/W6/deepVOL_L3/h50
Evaluating performance on  test set...
1722/1722 - 81s - 81s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0844219
{'0': {'precision': 0.40122267816765766, 'recall': 0.3413896302438266, 'f1-score': 0.3688957486796653, 'support': 154372}, '1': {'precision': 0.4174140200756952, 'recall': 0.1566095834908973, 'f1-score': 0.2277642780580606, 'support': 129577}, '2': {'precision': 0.38836875843454793, 'recall': 0.6458335989799171, 'f1-score': 0.4850532223078802, 'support': 156850}, 'accuracy': 0.39540243966070704, 'macro avg': {'precision': 0.4023351522259669, 'recall': 0.3812776042382137, 'f1-score': 0.360571083015202, 'support': 440799}, 'weighted avg': {'precision': 0.40140845036831946, 'recall': 0.39540243966070704, 'f1-score': 0.3687412727617295, 'support': 440799}}
[[ 52701  14648  87023]
 [ 36774  20293  72510]
 [ 41876  13675 101299]]
Evaluating performance on  train set...
618/618 - 28s - 28s/epoch - 45ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0894198
{'0': {'precision': 0.4056940463959336, 'recall': 0.2859402393475112, 'f1-score': 0.33544968813574483, 'support': 52476}, '1': {'precision': 0.4603597122302158, 'recall': 0.12153384486819115, 'f1-score': 0.1923007573025604, 'support': 52652}, '2': {'precision': 0.36276350322695133, 'recall': 0.7352579271178419, 'f1-score': 0.4858279338553524, 'support': 52825}, 'accuracy': 0.3814045950377644, 'macro avg': {'precision': 0.4096057539510336, 'recall': 0.3809106704445147, 'f1-score': 0.33785945976455256, 'support': 157953}, 'weighted avg': {'precision': 0.40955880803138933, 'recall': 0.3814045950377644, 'f1-score': 0.3380242091889027, 'support': 157953}}
[[15005  3950 33521]
 [11547  6399 34706]
 [10434  3551 38840]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950618
{'0': {'precision': 0.36941762690750546, 'recall': 0.3130145661811273, 'f1-score': 0.3388852384081364, 'support': 18948}, '1': {'precision': 0.4267981014968967, 'recall': 0.12076446280991736, 'f1-score': 0.1882599243095257, 'support': 19360}, '2': {'precision': 0.36167961462423076, 'recall': 0.6787020587313198, 'f1-score': 0.4718897022760712, 'support': 19138}, 'accuracy': 0.3700518748041639, 'macro avg': {'precision': 0.38596511434287767, 'recall': 0.3708270292407882, 'f1-score': 0.33301162166457776, 'support': 57446}, 'weighted avg': {'precision': 0.3861776434269028, 'recall': 0.3700518748041639, 'f1-score': 0.33243280218203597, 'support': 57446}}
[[ 5931  1621 11396]
 [ 5494  2338 11528]
 [ 4630  1519 12989]]
training model: results/PCAR/W6/deepVOL_L3/h100
Epoch 1/50
618/618 - 70s - loss: 3.3060 - accuracy100: 0.3662 - val_loss: 3.3132 - val_accuracy100: 0.3383 - 70s/epoch - 113ms/step
Epoch 2/50
618/618 - 64s - loss: 3.2890 - accuracy100: 0.3653 - val_loss: 3.3235 - val_accuracy100: 0.3366 - 64s/epoch - 103ms/step
Epoch 3/50
618/618 - 62s - loss: 3.2911 - accuracy100: 0.3604 - val_loss: 3.2982 - val_accuracy100: 0.3419 - 62s/epoch - 101ms/step
Epoch 4/50
618/618 - 63s - loss: 3.2823 - accuracy100: 0.3632 - val_loss: 3.3003 - val_accuracy100: 0.3433 - 63s/epoch - 102ms/step
Epoch 5/50
618/618 - 63s - loss: 3.2775 - accuracy100: 0.3663 - val_loss: 3.3021 - val_accuracy100: 0.3440 - 63s/epoch - 103ms/step
Epoch 6/50
618/618 - 65s - loss: 3.2706 - accuracy100: 0.3762 - val_loss: 3.3012 - val_accuracy100: 0.3539 - 65s/epoch - 105ms/step
Epoch 7/50
618/618 - 63s - loss: 3.2593 - accuracy100: 0.3864 - val_loss: 3.2983 - val_accuracy100: 0.3480 - 63s/epoch - 103ms/step
Epoch 8/50
618/618 - 64s - loss: 3.2558 - accuracy100: 0.3890 - val_loss: 3.3074 - val_accuracy100: 0.3424 - 64s/epoch - 103ms/step
Epoch 9/50
618/618 - 60s - loss: 3.2547 - accuracy100: 0.3912 - val_loss: 3.3029 - val_accuracy100: 0.3506 - 60s/epoch - 97ms/step
Epoch 10/50
618/618 - 62s - loss: 3.2452 - accuracy100: 0.3978 - val_loss: 3.3084 - val_accuracy100: 0.3430 - 62s/epoch - 100ms/step
Epoch 11/50
618/618 - 64s - loss: 3.2428 - accuracy100: 0.4015 - val_loss: 3.3010 - val_accuracy100: 0.3552 - 64s/epoch - 103ms/step
Epoch 12/50
618/618 - 65s - loss: 3.2394 - accuracy100: 0.4032 - val_loss: 3.3045 - val_accuracy100: 0.3533 - 65s/epoch - 105ms/step
Epoch 13/50
618/618 - 62s - loss: 3.2355 - accuracy100: 0.4067 - val_loss: 3.3061 - val_accuracy100: 0.3573 - 62s/epoch - 100ms/step
testing model: results/PCAR/W6/deepVOL_L3/h100
Evaluating performance on  test set...
1722/1722 - 83s - 83s/epoch - 48ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102791
{'0': {'precision': 0.365611125380692, 'recall': 0.06269071782256086, 'f1-score': 0.10702930308498755, 'support': 158939}, '1': {'precision': 0.28583757626920625, 'recall': 0.6255051379748297, 'f1-score': 0.3923724188237363, 'support': 121254}, '2': {'precision': 0.3768142345296654, 'recall': 0.3477142821563329, 'f1-score': 0.36167987331975426, 'support': 160606}, 'accuracy': 0.32135735335152754, 'macro avg': {'precision': 0.34275431205985457, 'recall': 0.34530337931790783, 'f1-score': 0.2870271984094927, 'support': 440799}, 'weighted avg': {'precision': 0.3477490717553796, 'recall': 0.32135735335152754, 'f1-score': 0.2783032933592649, 'support': 440799}}
[[ 9964 94910 54065]
 [ 7116 75845 38293]
 [10173 94588 55845]]
Evaluating performance on  train set...
618/618 - 30s - 30s/epoch - 48ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991985
{'0': {'precision': 0.3443333333333333, 'recall': 0.05824312133513757, 'f1-score': 0.09963348765432099, 'support': 53208}, '1': {'precision': 0.33882158128615747, 'recall': 0.6253554364856762, 'f1-score': 0.4395124836010414, 'support': 51697}, '2': {'precision': 0.3519061583577713, 'recall': 0.35515005278238576, 'f1-score': 0.353520664258573, 'support': 53048}, 'accuracy': 0.3435705557982438, 'macro avg': {'precision': 0.3450203576590874, 'recall': 0.3462495368677332, 'f1-score': 0.2975555451713118, 'support': 157953}, 'weighted avg': {'precision': 0.3450726809640433, 'recall': 0.3435705557982438, 'f1-score': 0.2961408752820328, 'support': 157953}}
[[ 3099 31879 18230]
 [ 2901 32329 16467]
 [ 3000 31208 18840]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 50ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998316
{'0': {'precision': 0.3234509338867477, 'recall': 0.05704873457435683, 'f1-score': 0.09699070987242743, 'support': 19124}, '1': {'precision': 0.33994610400779773, 'recall': 0.6276398666172657, 'f1-score': 0.4410227801022781, 'support': 18893}, '2': {'precision': 0.3466729195977281, 'recall': 0.3424262700087498, 'f1-score': 0.3445365095805282, 'support': 19429}, 'accuracy': 0.34122480242314523, 'macro avg': {'precision': 0.3366899858307579, 'recall': 0.3423716237334575, 'f1-score': 0.2941833331850779, 'support': 57446}, 'weighted avg': {'precision': 0.33672989516300084, 'recall': 0.34122480242314523, 'f1-score': 0.29386020897386633, 'support': 57446}}
[[ 1091 11448  6585]
 [ 1082 11858  5953]
 [ 1200 11576  6653]]
training model: results/PCAR/W6/deepVOL_L3/h200
Epoch 1/50
618/618 - 66s - loss: 3.3107 - accuracy200: 0.3674 - val_loss: 3.3606 - val_accuracy200: 0.3341 - 66s/epoch - 106ms/step
Epoch 2/50
618/618 - 63s - loss: 3.2825 - accuracy200: 0.3718 - val_loss: 3.3662 - val_accuracy200: 0.3323 - 63s/epoch - 101ms/step
Epoch 3/50
618/618 - 60s - loss: 3.2849 - accuracy200: 0.3665 - val_loss: 3.3385 - val_accuracy200: 0.3328 - 60s/epoch - 98ms/step
Epoch 4/50
618/618 - 63s - loss: 3.2724 - accuracy200: 0.3753 - val_loss: 3.3317 - val_accuracy200: 0.3559 - 63s/epoch - 102ms/step
Epoch 5/50
618/618 - 59s - loss: 3.2659 - accuracy200: 0.3807 - val_loss: 3.3869 - val_accuracy200: 0.3386 - 59s/epoch - 95ms/step
Epoch 6/50
618/618 - 59s - loss: 3.2546 - accuracy200: 0.3878 - val_loss: 3.3939 - val_accuracy200: 0.3405 - 59s/epoch - 96ms/step
Epoch 7/50
618/618 - 61s - loss: 3.2449 - accuracy200: 0.3929 - val_loss: 3.3811 - val_accuracy200: 0.3355 - 61s/epoch - 99ms/step
Epoch 8/50
618/618 - 61s - loss: 3.2386 - accuracy200: 0.3963 - val_loss: 3.3815 - val_accuracy200: 0.3351 - 61s/epoch - 98ms/step
Epoch 9/50
618/618 - 56s - loss: 3.2327 - accuracy200: 0.3990 - val_loss: 3.3679 - val_accuracy200: 0.3386 - 56s/epoch - 91ms/step
Epoch 10/50
618/618 - 56s - loss: 3.2297 - accuracy200: 0.4011 - val_loss: 3.3573 - val_accuracy200: 0.3484 - 56s/epoch - 90ms/step
Epoch 11/50
618/618 - 58s - loss: 3.2263 - accuracy200: 0.4024 - val_loss: 3.3496 - val_accuracy200: 0.3511 - 58s/epoch - 94ms/step
Epoch 12/50
618/618 - 58s - loss: 3.2232 - accuracy200: 0.4056 - val_loss: 3.3319 - val_accuracy200: 0.3566 - 58s/epoch - 94ms/step
Epoch 13/50
618/618 - 58s - loss: 3.2191 - accuracy200: 0.4072 - val_loss: 3.3346 - val_accuracy200: 0.3540 - 58s/epoch - 93ms/step
Epoch 14/50
618/618 - 59s - loss: 3.2154 - accuracy200: 0.4087 - val_loss: 3.3255 - val_accuracy200: 0.3588 - 59s/epoch - 96ms/step
Epoch 15/50
618/618 - 59s - loss: 3.2116 - accuracy200: 0.4141 - val_loss: 3.3301 - val_accuracy200: 0.3610 - 59s/epoch - 95ms/step
Epoch 16/50
618/618 - 58s - loss: 3.2096 - accuracy200: 0.4135 - val_loss: 3.3267 - val_accuracy200: 0.3608 - 58s/epoch - 93ms/step
Epoch 17/50
618/618 - 59s - loss: 3.2056 - accuracy200: 0.4152 - val_loss: 3.3225 - val_accuracy200: 0.3664 - 59s/epoch - 96ms/step
Epoch 18/50
618/618 - 60s - loss: 3.2026 - accuracy200: 0.4163 - val_loss: 3.3273 - val_accuracy200: 0.3637 - 60s/epoch - 97ms/step
Epoch 19/50
618/618 - 58s - loss: 3.1998 - accuracy200: 0.4190 - val_loss: 3.3359 - val_accuracy200: 0.3560 - 58s/epoch - 94ms/step
Epoch 20/50
618/618 - 59s - loss: 3.1957 - accuracy200: 0.4208 - val_loss: 3.3454 - val_accuracy200: 0.3557 - 59s/epoch - 95ms/step
Epoch 21/50
618/618 - 58s - loss: 3.1938 - accuracy200: 0.4214 - val_loss: 3.3479 - val_accuracy200: 0.3524 - 58s/epoch - 93ms/step
Epoch 22/50
618/618 - 58s - loss: 3.1928 - accuracy200: 0.4210 - val_loss: 3.3285 - val_accuracy200: 0.3545 - 58s/epoch - 94ms/step
Epoch 23/50
618/618 - 59s - loss: 3.1877 - accuracy200: 0.4250 - val_loss: 3.3238 - val_accuracy200: 0.3577 - 59s/epoch - 96ms/step
Epoch 24/50
618/618 - 60s - loss: 3.1839 - accuracy200: 0.4255 - val_loss: 3.3321 - val_accuracy200: 0.3573 - 60s/epoch - 97ms/step
Epoch 25/50
618/618 - 59s - loss: 3.1809 - accuracy200: 0.4278 - val_loss: 3.3334 - val_accuracy200: 0.3556 - 59s/epoch - 95ms/step
Epoch 26/50
618/618 - 58s - loss: 3.1772 - accuracy200: 0.4280 - val_loss: 3.3374 - val_accuracy200: 0.3566 - 58s/epoch - 94ms/step
Epoch 27/50
618/618 - 59s - loss: 3.1717 - accuracy200: 0.4292 - val_loss: 3.3337 - val_accuracy200: 0.3608 - 59s/epoch - 95ms/step
testing model: results/PCAR/W6/deepVOL_L3/h200
Evaluating performance on  test set...
1722/1722 - 80s - 80s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138673
{'0': {'precision': 0.3641350024328748, 'recall': 0.323250304323355, 'f1-score': 0.342476771598946, 'support': 152798}, '1': {'precision': 0.34024007465218864, 'recall': 0.628447195236603, 'f1-score': 0.44146945514584474, 'support': 127640}, '2': {'precision': 0.39004567920803496, 'recall': 0.168794158180605, 'f1-score': 0.23562182818443753, 'support': 160361}, 'accuracy': 0.3554341094240232, 'macro avg': {'precision': 0.3648069187643661, 'recall': 0.37349721924685436, 'f1-score': 0.33985601830974277, 'support': 440799}, 'weighted avg': {'precision': 0.3666420713155507, 'recall': 0.3554341094240232, 'f1-score': 0.33226817436309053, 'support': 440799}}
[[49392 77991 25415]
 [30511 80215 16914]
 [55739 77554 27068]]
Evaluating performance on  train set...
618/618 - 32s - 32s/epoch - 52ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023177
{'0': {'precision': 0.371788096136907, 'recall': 0.2777924031590824, 'f1-score': 0.31798956035085835, 'support': 53180}, '1': {'precision': 0.3808034510649771, 'recall': 0.6771242832761233, 'f1-score': 0.48746479651002267, 'support': 52147}, '2': {'precision': 0.3570391872278665, 'recall': 0.17295633337133737, 'f1-score': 0.23302909663462154, 'support': 52626}, 'accuracy': 0.37470006900786945, 'macro avg': {'precision': 0.36987691147658347, 'recall': 0.37595767326884766, 'f1-score': 0.3461611511651675, 'support': 157953}, 'weighted avg': {'precision': 0.3698504794609775, 'recall': 0.37470006900786945, 'f1-score': 0.3456338328652219, 'support': 157953}}
[[14773 28981  9426]
 [ 9872 35310  6965]
 [15090 28434  9102]]
Evaluating performance on  val set...
225/225 - 13s - 13s/epoch - 58ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091034
{'0': {'precision': 0.3592140518011313, 'recall': 0.3174427782162589, 'f1-score': 0.3370391061452514, 'support': 19005}, '1': {'precision': 0.3729635073016667, 'recall': 0.6286632932742989, 'f1-score': 0.4681753056858551, 'support': 18972}, '2': {'precision': 0.3519372693726937, 'recall': 0.15676203194822538, 'f1-score': 0.2169077147222913, 'support': 19469}, 'accuracy': 0.3657695923127807, 'macro avg': {'precision': 0.3613716094918306, 'recall': 0.3676227011462611, 'f1-score': 0.3407073755177992, 'support': 57446}, 'weighted avg': {'precision': 0.3612887479097708, 'recall': 0.3657695923127807, 'f1-score': 0.339634202724138, 'support': 57446}}
[[ 6033  9844  3128]
 [ 4553 11927  2492]
 [ 6209 10208  3052]]
training model: results/PCAR/W6/deepVOL_L3/h300
Epoch 1/50
618/618 - 66s - loss: 3.3116 - accuracy300: 0.3644 - val_loss: 3.3099 - val_accuracy300: 0.3343 - 66s/epoch - 107ms/step
Epoch 2/50
618/618 - 60s - loss: 3.2917 - accuracy300: 0.3625 - val_loss: 3.3003 - val_accuracy300: 0.3491 - 60s/epoch - 97ms/step
Epoch 3/50
618/618 - 59s - loss: 3.2809 - accuracy300: 0.3659 - val_loss: 3.3065 - val_accuracy300: 0.3486 - 59s/epoch - 96ms/step
Epoch 4/50
618/618 - 59s - loss: 3.2764 - accuracy300: 0.3672 - val_loss: 3.3105 - val_accuracy300: 0.3532 - 59s/epoch - 95ms/step
Epoch 5/50
618/618 - 59s - loss: 3.2691 - accuracy300: 0.3752 - val_loss: 3.3107 - val_accuracy300: 0.3597 - 59s/epoch - 96ms/step
Epoch 6/50
618/618 - 60s - loss: 3.2590 - accuracy300: 0.3821 - val_loss: 3.3192 - val_accuracy300: 0.3578 - 60s/epoch - 98ms/step
Epoch 7/50
618/618 - 61s - loss: 3.2462 - accuracy300: 0.3906 - val_loss: 3.3149 - val_accuracy300: 0.3600 - 61s/epoch - 98ms/step
Epoch 8/50
618/618 - 59s - loss: 3.2400 - accuracy300: 0.3936 - val_loss: 3.3144 - val_accuracy300: 0.3623 - 59s/epoch - 95ms/step
Epoch 9/50
618/618 - 58s - loss: 3.2316 - accuracy300: 0.3975 - val_loss: 3.3196 - val_accuracy300: 0.3583 - 58s/epoch - 94ms/step
Epoch 10/50
618/618 - 61s - loss: 3.2275 - accuracy300: 0.4001 - val_loss: 3.3206 - val_accuracy300: 0.3584 - 61s/epoch - 98ms/step
Epoch 11/50
618/618 - 60s - loss: 3.2227 - accuracy300: 0.4026 - val_loss: 3.3233 - val_accuracy300: 0.3551 - 60s/epoch - 96ms/step
Epoch 12/50
618/618 - 60s - loss: 3.2178 - accuracy300: 0.4043 - val_loss: 3.3232 - val_accuracy300: 0.3566 - 60s/epoch - 97ms/step
testing model: results/PCAR/W6/deepVOL_L3/h300
Evaluating performance on  test set...
1722/1722 - 77s - 77s/epoch - 44ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981888
{'0': {'precision': 0.32032622899112334, 'recall': 0.09750912133432091, 'f1-score': 0.14950735549269709, 'support': 145812}, '1': {'precision': 0.35451027365705334, 'recall': 0.22729958055178118, 'f1-score': 0.2769978401727861, 'support': 135416}, '2': {'precision': 0.37148606701142484, 'recall': 0.7207324639188825, 'f1-score': 0.49027197544547707, 'support': 159571}, 'accuracy': 0.36299084163076595, 'macro avg': {'precision': 0.3487741898865338, 'recall': 0.3485137219349948, 'f1-score': 0.3055923903703201, 'support': 440799}, 'weighted avg': {'precision': 0.34934783091222366, 'recall': 0.36299084163076595, 'f1-score': 0.31203132365942154, 'support': 440799}}
[[ 14218  27382 104212]
 [ 14267  30780  90369]
 [ 15901  28662 115008]]
Evaluating performance on  train set...
618/618 - 29s - 29s/epoch - 47ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997036
{'0': {'precision': 0.3466690269664247, 'recall': 0.1087519899300285, 'f1-score': 0.1655652467978977, 'support': 54022}, '1': {'precision': 0.3699740492743408, 'recall': 0.22630269062689842, 'f1-score': 0.2808297463583084, 'support': 51029}, '2': {'precision': 0.3465612561820881, 'recall': 0.7192544705304147, 'f1-score': 0.46774639663173423, 'support': 52902}, 'accuracy': 0.3511994074186625, 'macro avg': {'precision': 0.35440144414095115, 'recall': 0.35143638369578056, 'f1-score': 0.3047137965959801, 'support': 157953}, 'weighted avg': {'precision': 0.3541619564664511, 'recall': 0.3511994074186625, 'f1-score': 0.3040103496865913, 'support': 157953}}
[[ 5875 10247 37900]
 [ 5638 11548 33843]
 [ 5434  9418 38050]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003755
{'0': {'precision': 0.3310657596371882, 'recall': 0.09893661384487072, 'f1-score': 0.15234578801621382, 'support': 19184}, '1': {'precision': 0.3615127919911012, 'recall': 0.21158854166666666, 'f1-score': 0.26694045174537984, 'support': 18432}, '2': {'precision': 0.3488087965791081, 'recall': 0.7198688855269794, 'f1-score': 0.46992017117932683, 'support': 19830}, 'accuracy': 0.3494238067054277, 'macro avg': {'precision': 0.3471291160691325, 'recall': 0.3434646803461723, 'f1-score': 0.2964021369803068, 'support': 57446}, 'weighted avg': {'precision': 0.34695971435824097, 'recall': 0.3494238067054277, 'f1-score': 0.2987390766695669, 'support': 57446}}
[[ 1898  3350 13936]
 [ 1818  3900 12714]
 [ 2017  3538 14275]]
training model: results/PCAR/W6/deepVOL_L3/h500
Epoch 1/50
618/618 - 68s - loss: 3.3194 - accuracy500: 0.3617 - val_loss: 3.3154 - val_accuracy500: 0.3268 - 68s/epoch - 110ms/step
Epoch 2/50
618/618 - 61s - loss: 3.2958 - accuracy500: 0.3607 - val_loss: 3.3232 - val_accuracy500: 0.3275 - 61s/epoch - 98ms/step
Epoch 3/50
618/618 - 61s - loss: 3.2913 - accuracy500: 0.3567 - val_loss: 3.3091 - val_accuracy500: 0.3453 - 61s/epoch - 98ms/step
Epoch 4/50
618/618 - 60s - loss: 3.2832 - accuracy500: 0.3675 - val_loss: 3.3193 - val_accuracy500: 0.3525 - 60s/epoch - 97ms/step
Epoch 5/50
618/618 - 61s - loss: 3.2767 - accuracy500: 0.3729 - val_loss: 3.3222 - val_accuracy500: 0.3577 - 61s/epoch - 99ms/step
Epoch 6/50
618/618 - 61s - loss: 3.2644 - accuracy500: 0.3847 - val_loss: 3.3241 - val_accuracy500: 0.3632 - 61s/epoch - 99ms/step
Epoch 7/50
618/618 - 60s - loss: 3.2546 - accuracy500: 0.3924 - val_loss: 3.3439 - val_accuracy500: 0.3601 - 60s/epoch - 97ms/step
Epoch 8/50
618/618 - 60s - loss: 3.2488 - accuracy500: 0.3967 - val_loss: 3.3546 - val_accuracy500: 0.3564 - 60s/epoch - 97ms/step
Epoch 9/50
618/618 - 61s - loss: 3.2423 - accuracy500: 0.4003 - val_loss: 3.3683 - val_accuracy500: 0.3544 - 61s/epoch - 99ms/step
Epoch 10/50
618/618 - 59s - loss: 3.2379 - accuracy500: 0.4015 - val_loss: 3.3913 - val_accuracy500: 0.3450 - 59s/epoch - 95ms/step
Epoch 11/50
618/618 - 59s - loss: 3.2324 - accuracy500: 0.4040 - val_loss: 3.3977 - val_accuracy500: 0.3395 - 59s/epoch - 95ms/step
Epoch 12/50
618/618 - 59s - loss: 3.2297 - accuracy500: 0.4061 - val_loss: 3.4000 - val_accuracy500: 0.3391 - 59s/epoch - 96ms/step
Epoch 13/50
618/618 - 60s - loss: 3.2242 - accuracy500: 0.4083 - val_loss: 3.4057 - val_accuracy500: 0.3295 - 60s/epoch - 97ms/step
testing model: results/PCAR/W6/deepVOL_L3/h500
Evaluating performance on  test set...
1722/1722 - 80s - 80s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037047
{'0': {'precision': 0.3006134969325153, 'recall': 0.00032843804250926663, 'f1-score': 0.0006561591922546433, 'support': 149191}, '1': {'precision': 0.31188111506279237, 'recall': 0.32665868078364696, 'f1-score': 0.31909890118186174, 'support': 129395}, '2': {'precision': 0.3756579594244699, 'recall': 0.7065833194626818, 'f1-score': 0.4905258247507613, 'support': 162213}, 'accuracy': 0.35602167881506086, 'macro avg': {'precision': 0.3293841904732592, 'recall': 0.34452347942961264, 'f1-score': 0.27009362837495926, 'support': 440799}, 'weighted avg': {'precision': 0.3315372532073132, 'recall': 0.35602167881506086, 'f1-score': 0.2744047989554738, 'support': 440799}}
[[    49  45715 103427]
 [    61  42268  87066]
 [    53  47543 114617]]
Evaluating performance on  train set...
618/618 - 30s - 30s/epoch - 48ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044104
{'0': {'precision': 0.36633663366336633, 'recall': 0.0006828206027275915, 'f1-score': 0.0013631005010315354, 'support': 54187}, '1': {'precision': 0.34019236569590133, 'recall': 0.39558855049589836, 'f1-score': 0.36580509734321937, 'support': 51321}, '2': {'precision': 0.34412369873897364, 'recall': 0.644179616741348, 'f1-score': 0.4486021019924445, 'support': 52445}, 'accuracy': 0.3426525612049154, 'macro avg': {'precision': 0.3502175660327471, 'recall': 0.34681699594665805, 'f1-score': 0.27192343327889845, 'support': 157953}, 'weighted avg': {'precision': 0.35046667647060614, 'recall': 0.3426525612049154, 'f1-score': 0.26827146661725015, 'support': 157953}}
[[   37 20739 33411]
 [   40 20302 30979]
 [   24 18637 33784]]
Evaluating performance on  val set...
225/225 - 11s - 11s/epoch - 49ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050271
{'0': {'precision': 0.5, 'recall': 0.0005685342154227827, 'f1-score': 0.0011357769747031492, 'support': 19348}, '1': {'precision': 0.3325048627620488, 'recall': 0.3393250992501103, 'f1-score': 0.3358803624058509, 'support': 18136}, '2': {'precision': 0.3543272689896187, 'recall': 0.6907624486524396, 'f1-score': 0.46839226875912904, 'support': 19962}, 'accuracy': 0.3473522960693521, 'macro avg': {'precision': 0.39561071058388914, 'recall': 0.34355202737265755, 'f1-score': 0.26846946937989435, 'support': 57446}, 'weighted avg': {'precision': 0.3965008727260956, 'recall': 0.3473522960693521, 'f1-score': 0.2691840638942451, 'support': 57446}}
[[   11  6187 13150]
 [    5  6154 11977]
 [    6  6167 13789]]
training model: results/PCAR/W6/deepVOL_L3/h1000
Epoch 1/50
618/618 - 68s - loss: 3.3149 - accuracy1000: 0.3730 - val_loss: 3.3252 - val_accuracy1000: 0.3343 - 68s/epoch - 110ms/step
Epoch 2/50
618/618 - 62s - loss: 3.2904 - accuracy1000: 0.3733 - val_loss: 3.2989 - val_accuracy1000: 0.3471 - 62s/epoch - 101ms/step
Epoch 3/50
618/618 - 58s - loss: 3.2853 - accuracy1000: 0.3665 - val_loss: 3.3096 - val_accuracy1000: 0.3550 - 58s/epoch - 94ms/step
Epoch 4/50
618/618 - 59s - loss: 3.2769 - accuracy1000: 0.3769 - val_loss: 3.3069 - val_accuracy1000: 0.3547 - 59s/epoch - 95ms/step
Epoch 5/50
618/618 - 60s - loss: 3.2699 - accuracy1000: 0.3844 - val_loss: 3.3066 - val_accuracy1000: 0.3597 - 60s/epoch - 97ms/step
Epoch 6/50
618/618 - 60s - loss: 3.2631 - accuracy1000: 0.3928 - val_loss: 3.3104 - val_accuracy1000: 0.3605 - 60s/epoch - 97ms/step
Epoch 7/50
618/618 - 61s - loss: 3.2552 - accuracy1000: 0.3981 - val_loss: 3.3109 - val_accuracy1000: 0.3582 - 61s/epoch - 99ms/step
Epoch 8/50
618/618 - 60s - loss: 3.2442 - accuracy1000: 0.4028 - val_loss: 3.3267 - val_accuracy1000: 0.3568 - 60s/epoch - 98ms/step
Epoch 9/50
618/618 - 59s - loss: 3.2344 - accuracy1000: 0.4114 - val_loss: 3.3380 - val_accuracy1000: 0.3586 - 59s/epoch - 95ms/step
Epoch 10/50
618/618 - 58s - loss: 3.2236 - accuracy1000: 0.4144 - val_loss: 3.3375 - val_accuracy1000: 0.3592 - 58s/epoch - 94ms/step
Epoch 11/50
618/618 - 59s - loss: 3.2164 - accuracy1000: 0.4170 - val_loss: 3.3599 - val_accuracy1000: 0.3555 - 59s/epoch - 95ms/step
Epoch 12/50
618/618 - 59s - loss: 3.2118 - accuracy1000: 0.4204 - val_loss: 3.3714 - val_accuracy1000: 0.3555 - 59s/epoch - 96ms/step
testing model: results/PCAR/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
1722/1722 - 83s - 83s/epoch - 48ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974096
{'0': {'precision': 0.33005671706335343, 'recall': 0.13850191239286413, 'f1-score': 0.19512386983220176, 'support': 143276}, '1': {'precision': 0.31361290663472885, 'recall': 0.13597037150166089, 'f1-score': 0.1896959495450962, 'support': 130955}, '2': {'precision': 0.3769076162630944, 'recall': 0.7329138850199318, 'f1-score': 0.49781126966748024, 'support': 166568}, 'accuracy': 0.36236470590904246, 'macro avg': {'precision': 0.34019241332039224, 'recall': 0.3357953896381523, 'f1-score': 0.29421036301492604, 'support': 440799}, 'weighted avg': {'precision': 0.34287539719471016, 'recall': 0.36236470590904246, 'f1-score': 0.30789005467963737, 'support': 440799}}
[[ 19844  17644 105788]
 [ 17118  17806  96031]
 [ 23161  21327 122080]]
Evaluating performance on  train set...
618/618 - 29s - 29s/epoch - 47ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012487
{'0': {'precision': 0.3510743150009856, 'recall': 0.1302162349887587, 'f1-score': 0.18997080038932815, 'support': 54709}, '1': {'precision': 0.35344727805856707, 'recall': 0.18096874876535893, 'f1-score': 0.239374975503325, 'support': 50622}, '2': {'precision': 0.3378675878362657, 'recall': 0.7174565770970317, 'f1-score': 0.4593950013384926, 'support': 52622}, 'accuracy': 0.34212075744050446, 'macro avg': {'precision': 0.34746306029860613, 'recall': 0.34288052028371646, 'f1-score': 0.29624692574371525, 'support': 157953}, 'weighted avg': {'precision': 0.3474350029210568, 'recall': 0.34212075744050446, 'f1-score': 0.2955628338104578, 'support': 157953}}
[[ 7124  8816 38769]
 [ 6242  9161 35219]
 [ 6926  7942 37754]]
Evaluating performance on  val set...
225/225 - 10s - 10s/epoch - 47ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004118
{'0': {'precision': 0.34761416110826066, 'recall': 0.13750063422801767, 'f1-score': 0.19705508089438284, 'support': 19709}, '1': {'precision': 0.3333333333333333, 'recall': 0.1562268874096831, 'f1-score': 0.2127445283749758, 'support': 17577}, '2': {'precision': 0.34924659518980006, 'recall': 0.7174107142857142, 'f1-score': 0.4697914636523095, 'support': 20160}, 'accuracy': 0.3467430282352122, 'macro avg': {'precision': 0.34339802987713136, 'recall': 0.3370460786411383, 'f1-score': 0.2931970243072227, 'support': 57446}, 'weighted avg': {'precision': 0.3438174783328531, 'recall': 0.3467430282352122, 'f1-score': 0.2975692837068708, 'support': 57446}}
[[ 2710  2588 14411]
 [ 2293  2746 12538]
 [ 2793  2904 14463]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  16.76 (ave)

============================================
