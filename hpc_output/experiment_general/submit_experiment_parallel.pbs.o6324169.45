This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-06-26.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-18.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-05.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-06.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-14.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-10.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-12.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-07.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-28.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-24.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-13.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-04.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-06-19.csv
training model: results/EXC/W4/deepLOB_L1/h10
Epoch 1/50
1601/1601 - 36s - loss: 2.6484 - accuracy10: 0.4828 - val_loss: 2.4808 - val_accuracy10: 0.4659 - 36s/epoch - 22ms/step
Epoch 2/50
1601/1601 - 25s - loss: 2.3481 - accuracy10: 0.5790 - val_loss: 2.2329 - val_accuracy10: 0.6382 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 2.2065 - accuracy10: 0.6224 - val_loss: 2.1770 - val_accuracy10: 0.7048 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 2.1527 - accuracy10: 0.6330 - val_loss: 2.1847 - val_accuracy10: 0.7273 - 25s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 2.1168 - accuracy10: 0.6406 - val_loss: 2.1659 - val_accuracy10: 0.7324 - 25s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 25s - loss: 2.0908 - accuracy10: 0.6443 - val_loss: 2.1682 - val_accuracy10: 0.7377 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 2.0704 - accuracy10: 0.6469 - val_loss: 2.1222 - val_accuracy10: 0.7347 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 25s - loss: 2.0549 - accuracy10: 0.6493 - val_loss: 2.1236 - val_accuracy10: 0.7383 - 25s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 26s - loss: 2.0419 - accuracy10: 0.6513 - val_loss: 2.1262 - val_accuracy10: 0.7337 - 26s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 25s - loss: 2.0327 - accuracy10: 0.6520 - val_loss: 2.0949 - val_accuracy10: 0.7420 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 2.0232 - accuracy10: 0.6543 - val_loss: 2.0875 - val_accuracy10: 0.7373 - 25s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 26s - loss: 2.0149 - accuracy10: 0.6556 - val_loss: 2.0502 - val_accuracy10: 0.7327 - 26s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 25s - loss: 2.0075 - accuracy10: 0.6570 - val_loss: 2.0548 - val_accuracy10: 0.7359 - 25s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 26s - loss: 2.0004 - accuracy10: 0.6587 - val_loss: 2.0642 - val_accuracy10: 0.7427 - 26s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 1.9949 - accuracy10: 0.6581 - val_loss: 2.0428 - val_accuracy10: 0.7419 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 25s - loss: 1.9890 - accuracy10: 0.6596 - val_loss: 2.0270 - val_accuracy10: 0.7355 - 25s/epoch - 16ms/step
Epoch 17/50
1601/1601 - 25s - loss: 1.9826 - accuracy10: 0.6600 - val_loss: 2.0371 - val_accuracy10: 0.7382 - 25s/epoch - 16ms/step
Epoch 18/50
1601/1601 - 26s - loss: 1.9781 - accuracy10: 0.6616 - val_loss: 2.0216 - val_accuracy10: 0.7362 - 26s/epoch - 16ms/step
Epoch 19/50
1601/1601 - 26s - loss: 1.9733 - accuracy10: 0.6616 - val_loss: 2.0269 - val_accuracy10: 0.7306 - 26s/epoch - 16ms/step
Epoch 20/50
1601/1601 - 25s - loss: 1.9708 - accuracy10: 0.6621 - val_loss: 2.0160 - val_accuracy10: 0.7276 - 25s/epoch - 16ms/step
Epoch 21/50
1601/1601 - 25s - loss: 1.9654 - accuracy10: 0.6628 - val_loss: 2.0463 - val_accuracy10: 0.7351 - 25s/epoch - 16ms/step
Epoch 22/50
1601/1601 - 25s - loss: 1.9633 - accuracy10: 0.6631 - val_loss: 2.0157 - val_accuracy10: 0.7245 - 25s/epoch - 16ms/step
Epoch 23/50
1601/1601 - 26s - loss: 1.9559 - accuracy10: 0.6647 - val_loss: 2.0264 - val_accuracy10: 0.7247 - 26s/epoch - 16ms/step
Epoch 24/50
1601/1601 - 25s - loss: 1.9537 - accuracy10: 0.6641 - val_loss: 2.0211 - val_accuracy10: 0.7278 - 25s/epoch - 16ms/step
Epoch 25/50
1601/1601 - 26s - loss: 1.9509 - accuracy10: 0.6642 - val_loss: 2.0104 - val_accuracy10: 0.7188 - 26s/epoch - 16ms/step
Epoch 26/50
1601/1601 - 25s - loss: 1.9464 - accuracy10: 0.6653 - val_loss: 2.0209 - val_accuracy10: 0.7247 - 25s/epoch - 16ms/step
Epoch 27/50
1601/1601 - 25s - loss: 1.9424 - accuracy10: 0.6657 - val_loss: 2.0293 - val_accuracy10: 0.7297 - 25s/epoch - 16ms/step
Epoch 28/50
1601/1601 - 25s - loss: 1.9398 - accuracy10: 0.6660 - val_loss: 2.0359 - val_accuracy10: 0.7307 - 25s/epoch - 16ms/step
Epoch 29/50
1601/1601 - 25s - loss: 1.9358 - accuracy10: 0.6669 - val_loss: 2.0393 - val_accuracy10: 0.7310 - 25s/epoch - 16ms/step
Epoch 30/50
1601/1601 - 26s - loss: 1.9342 - accuracy10: 0.6673 - val_loss: 2.0415 - val_accuracy10: 0.7223 - 26s/epoch - 16ms/step
Epoch 31/50
1601/1601 - 26s - loss: 1.9301 - accuracy10: 0.6672 - val_loss: 2.0385 - val_accuracy10: 0.7279 - 26s/epoch - 16ms/step
Epoch 32/50
1601/1601 - 26s - loss: 1.9261 - accuracy10: 0.6674 - val_loss: 2.0224 - val_accuracy10: 0.7184 - 26s/epoch - 16ms/step
Epoch 33/50
1601/1601 - 25s - loss: 1.9230 - accuracy10: 0.6686 - val_loss: 2.0792 - val_accuracy10: 0.7214 - 25s/epoch - 16ms/step
Epoch 34/50
1601/1601 - 25s - loss: 1.9231 - accuracy10: 0.6682 - val_loss: 2.0585 - val_accuracy10: 0.7234 - 25s/epoch - 16ms/step
Epoch 35/50
1601/1601 - 25s - loss: 1.9189 - accuracy10: 0.6685 - val_loss: 2.0621 - val_accuracy10: 0.7177 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h10
Evaluating performance on  test set...
3782/3782 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70414054
{'0': {'precision': 0.3755773642358218, 'recall': 0.627769419249452, 'f1-score': 0.46997904953770603, 'support': 116315}, '1': {'precision': 0.9154828638466332, 'recall': 0.6577737180294821, 'f1-score': 0.7655211159855122, 'support': 730204}, '2': {'precision': 0.3311756929963075, 'recall': 0.6787611275353487, 'f1-score': 0.445154948746476, 'support': 121433}, 'accuracy': 0.6568011636940675, 'macro avg': {'precision': 0.5407453070262541, 'recall': 0.6547680882714276, 'f1-score': 0.5602183714232315, 'support': 967952}, 'weighted avg': {'precision': 0.7773011349333201, 'recall': 0.6568011636940675, 'f1-score': 0.6898159154743149, 'support': 967952}}
[[ 73019  25349  17947]
 [101383 480309 148512]
 [ 20016  18993  82424]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64025664
{'0': {'precision': 0.4368370413484267, 'recall': 0.6210798304426393, 'f1-score': 0.5129149232914922, 'support': 59213}, '1': {'precision': 0.8897935678586291, 'recall': 0.7259293552812072, 'f1-score': 0.7995520293711602, 'support': 291600}, '2': {'precision': 0.42381310884493417, 'recall': 0.6303805629549195, 'f1-score': 0.5068585655332356, 'support': 58939}, 'accuracy': 0.697033815576251, 'macro avg': {'precision': 0.5834812393506633, 'recall': 0.6591299162262553, 'f1-score': 0.6064418393986294, 'support': 409752}, 'weighted avg': {'precision': 0.7573101703936824, 'recall': 0.697033815576251, 'f1-score': 0.7160290617530917, 'support': 409752}}
[[ 36776  13957   8480]
 [ 37887 211681  42032]
 [  9524  12261  37154]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60358024
{'0': {'precision': 0.42254689042448174, 'recall': 0.6254237288135593, 'f1-score': 0.5043478260869565, 'support': 17110}, '1': {'precision': 0.9118126468191189, 'recall': 0.7452052110882554, 'f1-score': 0.8201330271767838, 'support': 102090}, '2': {'precision': 0.4053728510420849, 'recall': 0.6549121358650785, 'f1-score': 0.5007778153533988, 'support': 16958}, 'accuracy': 0.7189074457615418, 'macro avg': {'precision': 0.5799107960952284, 'recall': 0.6751803585889644, 'f1-score': 0.6084195562057131, 'support': 136158}, 'weighted avg': {'precision': 0.7872548305417119, 'recall': 0.7189074457615418, 'f1-score': 0.7406759958400434, 'support': 136158}}
[[10701  4005  2404]
 [12125 76078 13887]
 [ 2499  3353 11106]]
training model: results/EXC/W4/deepLOB_L1/h20
Epoch 1/50
1601/1601 - 28s - loss: 2.7817 - accuracy20: 0.4819 - val_loss: 2.9211 - val_accuracy20: 0.4212 - 28s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 26s - loss: 2.5749 - accuracy20: 0.5371 - val_loss: 2.5389 - val_accuracy20: 0.6585 - 26s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 26s - loss: 2.3746 - accuracy20: 0.6008 - val_loss: 2.4390 - val_accuracy20: 0.6913 - 26s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 26s - loss: 2.2975 - accuracy20: 0.6171 - val_loss: 2.4699 - val_accuracy20: 0.7004 - 26s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 2.2596 - accuracy20: 0.6229 - val_loss: 2.3742 - val_accuracy20: 0.7121 - 25s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 25s - loss: 2.2333 - accuracy20: 0.6273 - val_loss: 2.3530 - val_accuracy20: 0.7071 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 26s - loss: 2.2154 - accuracy20: 0.6310 - val_loss: 2.3490 - val_accuracy20: 0.7075 - 26s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 25s - loss: 2.2014 - accuracy20: 0.6328 - val_loss: 2.3484 - val_accuracy20: 0.7094 - 25s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 25s - loss: 2.1902 - accuracy20: 0.6350 - val_loss: 2.3495 - val_accuracy20: 0.7080 - 25s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 26s - loss: 2.1818 - accuracy20: 0.6369 - val_loss: 2.3452 - val_accuracy20: 0.7089 - 26s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 2.1761 - accuracy20: 0.6379 - val_loss: 2.3223 - val_accuracy20: 0.7129 - 25s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 25s - loss: 2.1693 - accuracy20: 0.6391 - val_loss: 2.3015 - val_accuracy20: 0.7143 - 25s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 26s - loss: 2.1627 - accuracy20: 0.6403 - val_loss: 2.3344 - val_accuracy20: 0.7112 - 26s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 25s - loss: 2.1579 - accuracy20: 0.6406 - val_loss: 2.3379 - val_accuracy20: 0.7127 - 25s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 2.1541 - accuracy20: 0.6407 - val_loss: 2.3244 - val_accuracy20: 0.7143 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 25s - loss: 2.1492 - accuracy20: 0.6420 - val_loss: 2.3609 - val_accuracy20: 0.7122 - 25s/epoch - 16ms/step
Epoch 17/50
1601/1601 - 25s - loss: 2.1449 - accuracy20: 0.6431 - val_loss: 2.3244 - val_accuracy20: 0.7129 - 25s/epoch - 15ms/step
Epoch 18/50
1601/1601 - 25s - loss: 2.1419 - accuracy20: 0.6438 - val_loss: 2.3738 - val_accuracy20: 0.7102 - 25s/epoch - 16ms/step
Epoch 19/50
1601/1601 - 25s - loss: 2.1375 - accuracy20: 0.6441 - val_loss: 2.3418 - val_accuracy20: 0.7110 - 25s/epoch - 16ms/step
Epoch 20/50
1601/1601 - 25s - loss: 2.1337 - accuracy20: 0.6448 - val_loss: 2.3484 - val_accuracy20: 0.7084 - 25s/epoch - 16ms/step
Epoch 21/50
1601/1601 - 25s - loss: 2.1307 - accuracy20: 0.6448 - val_loss: 2.3460 - val_accuracy20: 0.7120 - 25s/epoch - 16ms/step
Epoch 22/50
1601/1601 - 26s - loss: 2.1274 - accuracy20: 0.6454 - val_loss: 2.3406 - val_accuracy20: 0.7116 - 26s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h20
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70017064
{'0': {'precision': 0.5067810010338746, 'recall': 0.43144589775617587, 'f1-score': 0.46608892633286375, 'support': 154513}, '1': {'precision': 0.7916529805654817, 'recall': 0.796984825693887, 'f1-score': 0.7943099556614944, 'support': 650178}, '2': {'precision': 0.46018443670917397, 'recall': 0.5125841444068088, 'f1-score': 0.48497299427432256, 'support': 163261}, 'accuracy': 0.6906654462204738, 'macro avg': {'precision': 0.5862061394361767, 'recall': 0.5803382892856238, 'f1-score': 0.5817906254228936, 'support': 967952}, 'weighted avg': {'precision': 0.6902715999682084, 'recall': 0.6906654462204738, 'f1-score': 0.6897416738069336, 'support': 967952}}
[[ 66664  74176  13673]
 [ 47503 518182  84493]
 [ 17377  62199  83685]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7046175
{'0': {'precision': 0.5446207621875774, 'recall': 0.4508418155047692, 'f1-score': 0.49331400032221684, 'support': 78105}, '1': {'precision': 0.7507231378974564, 'recall': 0.8228193575828227, 'f1-score': 0.7851196034700132, 'support': 253916}, '2': {'precision': 0.5347555954787035, 'recall': 0.4595206545651027, 'f1-score': 0.4942916845411898, 'support': 77731}, 'accuracy': 0.6829960561510378, 'macro avg': {'precision': 0.6100331651879124, 'recall': 0.5777272758842316, 'f1-score': 0.5909084294444733, 'support': 409752}, 'weighted avg': {'precision': 0.6704672780247232, 'recall': 0.6829960561510378, 'f1-score': 0.6743261928213402, 'support': 409752}}
[[ 35213  36186   6706]
 [ 20619 208927  24370]
 [  8824  33188  35719]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6454931
{'0': {'precision': 0.5313289415027985, 'recall': 0.4673055979089523, 'f1-score': 0.497264973113295, 'support': 22955}, '1': {'precision': 0.794906632121078, 'recall': 0.8338562842496022, 'f1-score': 0.8139157441806545, 'support': 90512}, '2': {'precision': 0.5256398059176102, 'recall': 0.4869772156361553, 'f1-score': 0.505570425273946, 'support': 22691}, 'accuracy': 0.7142510906446922, 'macro avg': {'precision': 0.6172917931804955, 'recall': 0.59604636593157, 'f1-score': 0.6055837141892985, 'support': 136158}, 'weighted avg': {'precision': 0.7055959824234804, 'recall': 0.7142510906446922, 'f1-score': 0.7091449478913189, 'support': 136158}}
[[10727 10304  1924]
 [ 6990 75474  8048]
 [ 2472  9169 11050]]
training model: results/EXC/W4/deepLOB_L1/h30
Epoch 1/50
1601/1601 - 27s - loss: 2.7955 - accuracy30: 0.5028 - val_loss: 2.6987 - val_accuracy30: 0.5097 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 2.6102 - accuracy30: 0.5620 - val_loss: 2.5361 - val_accuracy30: 0.6394 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 2.4682 - accuracy30: 0.5941 - val_loss: 2.4850 - val_accuracy30: 0.6602 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 27s - loss: 2.4153 - accuracy30: 0.6027 - val_loss: 2.4852 - val_accuracy30: 0.6740 - 27s/epoch - 17ms/step
Epoch 5/50
1601/1601 - 26s - loss: 2.3857 - accuracy30: 0.6074 - val_loss: 2.4713 - val_accuracy30: 0.6751 - 26s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 25s - loss: 2.3673 - accuracy30: 0.6098 - val_loss: 2.4735 - val_accuracy30: 0.6772 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 2.3517 - accuracy30: 0.6120 - val_loss: 2.4705 - val_accuracy30: 0.6775 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 26s - loss: 2.3413 - accuracy30: 0.6137 - val_loss: 2.4623 - val_accuracy30: 0.6749 - 26s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 25s - loss: 2.3335 - accuracy30: 0.6148 - val_loss: 2.4733 - val_accuracy30: 0.6769 - 25s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 26s - loss: 2.3253 - accuracy30: 0.6162 - val_loss: 2.4496 - val_accuracy30: 0.6759 - 26s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 2.3191 - accuracy30: 0.6171 - val_loss: 2.4504 - val_accuracy30: 0.6771 - 25s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 25s - loss: 2.3148 - accuracy30: 0.6179 - val_loss: 2.4517 - val_accuracy30: 0.6779 - 25s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 25s - loss: 2.3092 - accuracy30: 0.6190 - val_loss: 2.4434 - val_accuracy30: 0.6750 - 25s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 25s - loss: 2.3041 - accuracy30: 0.6197 - val_loss: 2.4548 - val_accuracy30: 0.6742 - 25s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 2.3001 - accuracy30: 0.6206 - val_loss: 2.4770 - val_accuracy30: 0.6744 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 25s - loss: 2.2956 - accuracy30: 0.6220 - val_loss: 2.4638 - val_accuracy30: 0.6740 - 25s/epoch - 16ms/step
Epoch 17/50
1601/1601 - 25s - loss: 2.2916 - accuracy30: 0.6222 - val_loss: 2.4678 - val_accuracy30: 0.6743 - 25s/epoch - 16ms/step
Epoch 18/50
1601/1601 - 26s - loss: 2.2877 - accuracy30: 0.6227 - val_loss: 2.4510 - val_accuracy30: 0.6741 - 26s/epoch - 16ms/step
Epoch 19/50
1601/1601 - 25s - loss: 2.2842 - accuracy30: 0.6239 - val_loss: 2.4595 - val_accuracy30: 0.6733 - 25s/epoch - 15ms/step
Epoch 20/50
1601/1601 - 25s - loss: 2.2818 - accuracy30: 0.6244 - val_loss: 2.4665 - val_accuracy30: 0.6711 - 25s/epoch - 16ms/step
Epoch 21/50
1601/1601 - 25s - loss: 2.2772 - accuracy30: 0.6254 - val_loss: 2.4794 - val_accuracy30: 0.6692 - 25s/epoch - 16ms/step
Epoch 22/50
1601/1601 - 26s - loss: 2.2731 - accuracy30: 0.6255 - val_loss: 2.4444 - val_accuracy30: 0.6683 - 26s/epoch - 16ms/step
Epoch 23/50
1601/1601 - 25s - loss: 2.2693 - accuracy30: 0.6258 - val_loss: 2.4589 - val_accuracy30: 0.6714 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h30
Evaluating performance on  test set...
3782/3782 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7649384
{'0': {'precision': 0.5165678506122902, 'recall': 0.4108841888370402, 'f1-score': 0.45770466450027153, 'support': 181511}, '1': {'precision': 0.7585097747924128, 'recall': 0.7599375687156632, 'f1-score': 0.7592230004777188, 'support': 593933}, '2': {'precision': 0.47088502352040257, 'recall': 0.5589845616805535, 'f1-score': 0.511166583141939, 'support': 192508}, 'accuracy': 0.6545169595186539, 'macro avg': {'precision': 0.5819875496417019, 'recall': 0.5766021064110857, 'f1-score': 0.5760314160399764, 'support': 967952}, 'weighted avg': {'precision': 0.6559373474223258, 'recall': 0.6545169595186539, 'f1-score': 0.6533481849186015, 'support': 967952}}
[[ 74580  75734  31197]
 [ 52862 451352  89719]
 [ 16934  67965 107609]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.790568
{'0': {'precision': 0.5658205296097212, 'recall': 0.4063026220832331, 'f1-score': 0.4729737470167064, 'support': 91454}, '1': {'precision': 0.6922854710211032, 'recall': 0.801672608829614, 'f1-score': 0.7429743941192547, 'support': 227190}, '2': {'precision': 0.5378983368933118, 'recall': 0.47817974272292224, 'f1-score': 0.5062841006153364, 'support': 91108}, 'accuracy': 0.6415002245260548, 'macro avg': {'precision': 0.5986681125080454, 'recall': 0.5620516578785898, 'f1-score': 0.5740774139170992, 'support': 409752}, 'weighted avg': {'precision': 0.6297314681902412, 'recall': 0.6415002245260548, 'f1-score': 0.6300841130695675, 'support': 409752}}
[[ 37158  42160  12136]
 [ 19767 182132  25291]
 [  8746  38796  43566]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7207729
{'0': {'precision': 0.5669192579043637, 'recall': 0.39941089837997057, 'f1-score': 0.468646722108219, 'support': 27160}, '1': {'precision': 0.7457228064668027, 'recall': 0.8099215819979543, 'f1-score': 0.7764975075590423, 'support': 82124}, '2': {'precision': 0.5221172158539653, 'recall': 0.5406712807918435, 'f1-score': 0.5312322907335978, 'support': 26874}, 'accuracy': 0.6748924044125207, 'macro avg': {'precision': 0.6115864267417106, 'recall': 0.5833345870565895, 'f1-score': 0.5921255068002864, 'support': 136158}, 'weighted avg': {'precision': 0.6659222731078724, 'recall': 0.6748924044125207, 'f1-score': 0.6666803483042696, 'support': 136158}}
[[10848 12619  3693]
 [ 6004 66514  9606]
 [ 2283 10061 14530]]
training model: results/EXC/W4/deepLOB_L1/h50
Epoch 1/50
1601/1601 - 27s - loss: 2.9705 - accuracy50: 0.4771 - val_loss: 2.9064 - val_accuracy50: 0.4733 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 2.8424 - accuracy50: 0.5179 - val_loss: 2.8700 - val_accuracy50: 0.5623 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 2.7288 - accuracy50: 0.5527 - val_loss: 2.8611 - val_accuracy50: 0.5849 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 26s - loss: 2.6687 - accuracy50: 0.5651 - val_loss: 2.8431 - val_accuracy50: 0.5865 - 26s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 26s - loss: 2.6372 - accuracy50: 0.5698 - val_loss: 2.8014 - val_accuracy50: 0.5925 - 26s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 26s - loss: 2.6173 - accuracy50: 0.5734 - val_loss: 2.7719 - val_accuracy50: 0.5975 - 26s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 2.6056 - accuracy50: 0.5749 - val_loss: 2.7870 - val_accuracy50: 0.5958 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 25s - loss: 2.5951 - accuracy50: 0.5768 - val_loss: 2.7970 - val_accuracy50: 0.5950 - 25s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 26s - loss: 2.5878 - accuracy50: 0.5782 - val_loss: 2.8311 - val_accuracy50: 0.5903 - 26s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 26s - loss: 2.5813 - accuracy50: 0.5788 - val_loss: 2.8052 - val_accuracy50: 0.5933 - 26s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 26s - loss: 2.5762 - accuracy50: 0.5795 - val_loss: 2.8129 - val_accuracy50: 0.5909 - 26s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 25s - loss: 2.5703 - accuracy50: 0.5802 - val_loss: 2.8331 - val_accuracy50: 0.5900 - 25s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 25s - loss: 2.5669 - accuracy50: 0.5815 - val_loss: 2.8219 - val_accuracy50: 0.5929 - 25s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 25s - loss: 2.5617 - accuracy50: 0.5819 - val_loss: 2.8318 - val_accuracy50: 0.5909 - 25s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 2.5584 - accuracy50: 0.5824 - val_loss: 2.8215 - val_accuracy50: 0.5917 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 26s - loss: 2.5537 - accuracy50: 0.5828 - val_loss: 2.8313 - val_accuracy50: 0.5926 - 26s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h50
Evaluating performance on  test set...
3782/3782 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88074577
{'0': {'precision': 0.5638553553737203, 'recall': 0.27642141145044, 'f1-score': 0.37097703837599844, 'support': 222367}, '1': {'precision': 0.6246853845633701, 'recall': 0.8185383756623028, 'f1-score': 0.7085927685953934, 'support': 507887}, '2': {'precision': 0.5162966217788002, 'recall': 0.42017602167456186, 'f1-score': 0.463303358746402, 'support': 237698}, 'accuracy': 0.5961731573466453, 'macro avg': {'precision': 0.5682791205719635, 'recall': 0.5050452695957682, 'f1-score': 0.5142910552392647, 'support': 967952}, 'weighted avg': {'precision': 0.5840941328926451, 'recall': 0.5961731573466453, 'f1-score': 0.5707973002002853, 'support': 967952}}
[[ 61467 135691  25209]
 [ 23801 415725  68361]
 [ 23744 114079  99875]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92300516
{'0': {'precision': 0.5902559111467338, 'recall': 0.2780899634068493, 'f1-score': 0.3780618980100719, 'support': 111223}, '1': {'precision': 0.5509836082627949, 'recall': 0.8482284420860449, 'f1-score': 0.6680330798111408, 'support': 187321}, '2': {'precision': 0.5791457650708963, 'recall': 0.35920077692252356, 'f1-score': 0.44339612169917086, 'support': 111208}, 'accuracy': 0.5607465003221461, 'macro avg': {'precision': 0.573461761493475, 'recall': 0.4951730608051393, 'f1-score': 0.4964970331734612, 'support': 409752}, 'weighted avg': {'precision': 0.5692869734153156, 'recall': 0.5607465003221461, 'f1-score': 0.5283561738017101, 'support': 409752}}
[[ 30930  69597  10696]
 [ 10098 158891  18332]
 [ 11373  59889  39946]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8600562
{'0': {'precision': 0.5983001426887524, 'recall': 0.28554509385918164, 'f1-score': 0.3865872968151845, 'support': 33774}, '1': {'precision': 0.604227247973202, 'recall': 0.8507523148148148, 'f1-score': 0.7066047428217807, 'support': 69120}, '2': {'precision': 0.5666872083810195, 'recall': 0.38702501202501205, 'f1-score': 0.45993355006966524, 'support': 33264}, 'accuracy': 0.5972620044360228, 'macro avg': {'precision': 0.5897381996809913, 'recall': 0.5077741402330028, 'f1-score': 0.5177085299022102, 'support': 136158}, 'weighted avg': {'precision': 0.5935858318913606, 'recall': 0.5972620044360228, 'f1-score': 0.5669615358333324, 'support': 136158}}
[[ 9644 21028  3102]
 [ 3574 58804  6742]
 [ 2901 17489 12874]]
training model: results/EXC/W4/deepLOB_L1/h100
Epoch 1/50
1601/1601 - 27s - loss: 3.1386 - accuracy100: 0.4503 - val_loss: 3.2589 - val_accuracy100: 0.4024 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 3.0841 - accuracy100: 0.4690 - val_loss: 3.2705 - val_accuracy100: 0.3980 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.0492 - accuracy100: 0.4794 - val_loss: 3.3438 - val_accuracy100: 0.3832 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 3.0139 - accuracy100: 0.4892 - val_loss: 3.2943 - val_accuracy100: 0.4042 - 25s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 2.9840 - accuracy100: 0.4956 - val_loss: 3.2771 - val_accuracy100: 0.4285 - 25s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 25s - loss: 2.9620 - accuracy100: 0.4990 - val_loss: 3.2679 - val_accuracy100: 0.4330 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 2.9476 - accuracy100: 0.5020 - val_loss: 3.2692 - val_accuracy100: 0.4360 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 25s - loss: 2.9377 - accuracy100: 0.5034 - val_loss: 3.2064 - val_accuracy100: 0.4518 - 25s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 25s - loss: 2.9312 - accuracy100: 0.5045 - val_loss: 3.2117 - val_accuracy100: 0.4582 - 25s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 25s - loss: 2.9236 - accuracy100: 0.5062 - val_loss: 3.2213 - val_accuracy100: 0.4580 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 2.9195 - accuracy100: 0.5074 - val_loss: 3.2394 - val_accuracy100: 0.4562 - 25s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 25s - loss: 2.9136 - accuracy100: 0.5086 - val_loss: 3.2263 - val_accuracy100: 0.4534 - 25s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 25s - loss: 2.9108 - accuracy100: 0.5092 - val_loss: 3.2274 - val_accuracy100: 0.4565 - 25s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 25s - loss: 2.9074 - accuracy100: 0.5103 - val_loss: 3.2599 - val_accuracy100: 0.4442 - 25s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 2.9044 - accuracy100: 0.5103 - val_loss: 3.2473 - val_accuracy100: 0.4505 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 25s - loss: 2.9014 - accuracy100: 0.5121 - val_loss: 3.2504 - val_accuracy100: 0.4554 - 25s/epoch - 16ms/step
Epoch 17/50
1601/1601 - 25s - loss: 2.8981 - accuracy100: 0.5126 - val_loss: 3.2618 - val_accuracy100: 0.4461 - 25s/epoch - 16ms/step
Epoch 18/50
1601/1601 - 25s - loss: 2.8949 - accuracy100: 0.5135 - val_loss: 3.2503 - val_accuracy100: 0.4528 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h100
Evaluating performance on  test set...
3782/3782 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008536
{'0': {'precision': 0.46493232052087496, 'recall': 0.33925346595171285, 'f1-score': 0.39227229285295506, 'support': 287944}, '1': {'precision': 0.43203717555159193, 'recall': 0.6998985662198097, 'f1-score': 0.5342744973296949, 'support': 364770}, '2': {'precision': 0.4820930037503445, 'recall': 0.2552674487212836, 'f1-score': 0.33379238254838683, 'support': 315238}, 'accuracy': 0.4478093955072152, 'macro avg': {'precision': 0.4596874999409371, 'recall': 0.4314731602976021, 'f1-score': 0.4201130575770122, 'support': 967952}, 'weighted avg': {'precision': 0.45812468690830543, 'recall': 0.4478093955072152, 'f1-score': 0.4267399670376139, 'support': 967952}}
[[ 97686 147680  42578]
 [ 65598 255302  43870]
 [ 46824 187944  80470]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1269414
{'0': {'precision': 0.49706121043700663, 'recall': 0.2941253510673904, 'f1-score': 0.36956720484174727, 'support': 137438}, '1': {'precision': 0.37285104111051787, 'recall': 0.7280383644473568, 'f1-score': 0.49314647008531926, 'support': 134291}, '2': {'precision': 0.5067214451862369, 'recall': 0.24306093911884252, 'f1-score': 0.3285331662006865, 'support': 138023}, 'accuracy': 0.4191340127686991, 'macro avg': {'precision': 0.4588778989112538, 'recall': 0.4217415515445299, 'f1-score': 0.3970822803759177, 'support': 409752}, 'weighted avg': {'precision': 0.45960691303704154, 'recall': 0.4191340127686991, 'f1-score': 0.3962466157865856, 'support': 409752}}
[[40424 81120 15894]
 [19758 97769 16764]
 [21144 83331 33548]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0710531
{'0': {'precision': 0.5447696819828627, 'recall': 0.2163674569457768, 'f1-score': 0.3097219270569388, 'support': 43782}, '1': {'precision': 0.42230736953689185, 'recall': 0.7692075623491552, 'f1-score': 0.5452588357736559, 'support': 49720}, '2': {'precision': 0.4975360726060907, 'recall': 0.32900412603150786, 'f1-score': 0.39608822657804493, 'support': 42656}, 'accuracy': 0.4535319261446261, 'macro avg': {'precision': 0.48820437470861505, 'recall': 0.4381930484421466, 'f1-score': 0.4170229964695465, 'support': 136158}, 'weighted avg': {'precision': 0.48525336258635826, 'recall': 0.4535319261446261, 'f1-score': 0.42278862878410484, 'support': 136158}}
[[ 9473 27594  6715]
 [ 4017 38245  7458]
 [ 3899 24723 14034]]
training model: results/EXC/W4/deepLOB_L1/h200
Epoch 1/50
1601/1601 - 28s - loss: 3.2383 - accuracy200: 0.4104 - val_loss: 3.3250 - val_accuracy200: 0.3860 - 28s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 3.2098 - accuracy200: 0.4195 - val_loss: 3.4003 - val_accuracy200: 0.3642 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.1987 - accuracy200: 0.4244 - val_loss: 3.3368 - val_accuracy200: 0.3731 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 3.1908 - accuracy200: 0.4269 - val_loss: 3.3898 - val_accuracy200: 0.3614 - 25s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 3.1853 - accuracy200: 0.4285 - val_loss: 3.3839 - val_accuracy200: 0.3590 - 25s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 25s - loss: 3.1813 - accuracy200: 0.4316 - val_loss: 3.3750 - val_accuracy200: 0.3641 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 3.1755 - accuracy200: 0.4338 - val_loss: 3.3762 - val_accuracy200: 0.3644 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 26s - loss: 3.1713 - accuracy200: 0.4353 - val_loss: 3.3448 - val_accuracy200: 0.3722 - 26s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 26s - loss: 3.1671 - accuracy200: 0.4367 - val_loss: 3.3489 - val_accuracy200: 0.3659 - 26s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 25s - loss: 3.1642 - accuracy200: 0.4375 - val_loss: 3.3479 - val_accuracy200: 0.3722 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 3.1620 - accuracy200: 0.4392 - val_loss: 3.3367 - val_accuracy200: 0.3742 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h200
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1385114
{'0': {'precision': 0.36557167497955007, 'recall': 0.5031312228546341, 'f1-score': 0.423460136560028, 'support': 318885}, '1': {'precision': 0.3319963729786912, 'recall': 0.3693661581090669, 'f1-score': 0.34968570277940936, 'support': 297377}, '2': {'precision': 0.4366351368394501, 'recall': 0.24610310216383746, 'f1-score': 0.3147831937663093, 'support': 351690}, 'accuracy': 0.3686484453774567, 'macro avg': {'precision': 0.37806772826589713, 'recall': 0.3728668277091795, 'f1-score': 0.36264301103524893, 'support': 967952}, 'weighted avg': {'precision': 0.38107635529262224, 'recall': 0.3686484453774567, 'f1-score': 0.3613088999227754, 'support': 967952}}
[[160441 106077  52367]
 [128230 109841  59306]
 [150206 114932  86552]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1315815
{'0': {'precision': 0.3696698257821143, 'recall': 0.40589233966572025, 'f1-score': 0.38693519920193653, 'support': 136652}, '1': {'precision': 0.3468787176757874, 'recall': 0.3677072501604018, 'f1-score': 0.35698943208179396, 'support': 135597}, '2': {'precision': 0.39789257659242394, 'recall': 0.3355854054093365, 'f1-score': 0.3640925696521142, 'support': 137503}, 'accuracy': 0.36966262519768056, 'macro avg': {'precision': 0.3714803733501086, 'recall': 0.3697283317451529, 'f1-score': 0.3693390669786149, 'support': 409752}, 'weighted avg': {'precision': 0.3715985705320518, 'recall': 0.36966262519768056, 'f1-score': 0.36935996765900525, 'support': 409752}}
[[55466 48120 33066]
 [48976 49860 36761]
 [45600 45759 46144]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1084499
{'0': {'precision': 0.4263081905802474, 'recall': 0.23855795265962093, 'f1-score': 0.3059238620612407, 'support': 45796}, '1': {'precision': 0.35483751846381095, 'recall': 0.4185013392565493, 'f1-score': 0.3840489203744967, 'support': 45921}, '2': {'precision': 0.3994607156161856, 'recall': 0.5066942688058325, 'f1-score': 0.44673253184144746, 'support': 44441}, 'accuracy': 0.3867639066378766, 'macro avg': {'precision': 0.39353547488674795, 'recall': 0.3879178535740009, 'f1-score': 0.3789017714257283, 'support': 136158}, 'weighted avg': {'precision': 0.39344098212289086, 'recall': 0.3867639066378766, 'f1-score': 0.37823146717078404, 'support': 136158}}
[[10925 19396 15475]
 [ 8325 19218 18378]
 [ 6377 15546 22518]]
training model: results/EXC/W4/deepLOB_L1/h300
Epoch 1/50
1601/1601 - 28s - loss: 3.2697 - accuracy300: 0.3920 - val_loss: 3.3279 - val_accuracy300: 0.3687 - 28s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 26s - loss: 3.2432 - accuracy300: 0.4054 - val_loss: 3.3367 - val_accuracy300: 0.3672 - 26s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.2361 - accuracy300: 0.4100 - val_loss: 3.3467 - val_accuracy300: 0.3688 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 3.2289 - accuracy300: 0.4122 - val_loss: 3.3844 - val_accuracy300: 0.3641 - 25s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 3.2222 - accuracy300: 0.4150 - val_loss: 3.4280 - val_accuracy300: 0.3619 - 25s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 25s - loss: 3.2183 - accuracy300: 0.4171 - val_loss: 3.3573 - val_accuracy300: 0.3714 - 25s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 26s - loss: 3.2131 - accuracy300: 0.4184 - val_loss: 3.3775 - val_accuracy300: 0.3679 - 26s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 26s - loss: 3.2090 - accuracy300: 0.4208 - val_loss: 3.3786 - val_accuracy300: 0.3696 - 26s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 26s - loss: 3.2052 - accuracy300: 0.4227 - val_loss: 3.3934 - val_accuracy300: 0.3728 - 26s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 25s - loss: 3.2031 - accuracy300: 0.4238 - val_loss: 3.4019 - val_accuracy300: 0.3725 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 25s - loss: 3.2007 - accuracy300: 0.4249 - val_loss: 3.4053 - val_accuracy300: 0.3725 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h300
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1127459
{'0': {'precision': 0.35674287182121756, 'recall': 0.5386442748683739, 'f1-score': 0.42921658238459665, 'support': 309399}, '1': {'precision': 0.39561854252170375, 'recall': 0.11374169200059472, 'f1-score': 0.17668565138552408, 'support': 316111}, '2': {'precision': 0.3932458179742333, 'recall': 0.47072204928133815, 'f1-score': 0.4285100970158875, 'support': 342442}, 'accuracy': 0.3758512818817462, 'macro avg': {'precision': 0.3818690774390516, 'recall': 0.37436933871676886, 'f1-score': 0.34480411026200275, 'support': 967952}, 'weighted avg': {'precision': 0.38235278742378087, 'recall': 0.3758512818817462, 'f1-score': 0.34649581173514366, 'support': 967952}}
[[166656  24067 118676]
 [150118  35955 130038]
 [150386  30861 161195]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116345
{'0': {'precision': 0.3665718464035147, 'recall': 0.43258574237238767, 'f1-score': 0.3968522767885474, 'support': 137330}, '1': {'precision': 0.3802691778083774, 'recall': 0.126744194653974, 'f1-score': 0.1901208658816214, 'support': 135091}, '2': {'precision': 0.3655984013026423, 'recall': 0.5395285842235183, 'f1-score': 0.43585218649631174, 'support': 137331}, 'accuracy': 0.3675955211933072, 'macro avg': {'precision': 0.37081314183817815, 'recall': 0.36628617374996003, 'f1-score': 0.3409417763888268, 'support': 409752}, 'weighted avg': {'precision': 0.37076145867548993, 'recall': 0.3675955211933072, 'f1-score': 0.3417661358282823, 'support': 409752}}
[[59407 14431 63492]
 [52890 17122 65079]
 [49764 13473 74094]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091636
{'0': {'precision': 0.4106862410378969, 'recall': 0.2605258598284675, 'f1-score': 0.31880946701651164, 'support': 46172}, '1': {'precision': 0.3887384948565241, 'recall': 0.10963266730651776, 'f1-score': 0.171030915556463, 'support': 45844}, '2': {'precision': 0.3532505136311862, 'recall': 0.7517556975216347, 'f1-score': 0.48064541826898705, 'support': 44142}, 'accuracy': 0.36897574876246714, 'macro avg': {'precision': 0.3842250831752024, 'recall': 0.37397140821887337, 'f1-score': 0.32349526694732056, 'support': 136158}, 'weighted avg': {'precision': 0.3846760150127946, 'recall': 0.36897574876246714, 'f1-score': 0.3215195732684564, 'support': 136158}}
[[12029  4362 29781]
 [ 9844  5026 30974]
 [ 7417  3541 33184]]
training model: results/EXC/W4/deepLOB_L1/h500
Epoch 1/50
1601/1601 - 28s - loss: 3.2582 - accuracy500: 0.4034 - val_loss: 3.3794 - val_accuracy500: 0.3376 - 28s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 3.2418 - accuracy500: 0.4079 - val_loss: 3.4237 - val_accuracy500: 0.3304 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.2278 - accuracy500: 0.4164 - val_loss: 3.3972 - val_accuracy500: 0.3481 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 3.2188 - accuracy500: 0.4197 - val_loss: 3.3664 - val_accuracy500: 0.3344 - 25s/epoch - 16ms/step
Epoch 5/50
1601/1601 - 25s - loss: 3.2111 - accuracy500: 0.4238 - val_loss: 3.3796 - val_accuracy500: 0.3237 - 25s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 26s - loss: 3.2024 - accuracy500: 0.4264 - val_loss: 3.3665 - val_accuracy500: 0.3234 - 26s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 3.1961 - accuracy500: 0.4306 - val_loss: 3.3743 - val_accuracy500: 0.3138 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 26s - loss: 3.1921 - accuracy500: 0.4325 - val_loss: 3.3486 - val_accuracy500: 0.3273 - 26s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 25s - loss: 3.1892 - accuracy500: 0.4356 - val_loss: 3.3487 - val_accuracy500: 0.3326 - 25s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 25s - loss: 3.1743 - accuracy500: 0.4415 - val_loss: 3.3328 - val_accuracy500: 0.3464 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 26s - loss: 3.1702 - accuracy500: 0.4426 - val_loss: 3.3460 - val_accuracy500: 0.3463 - 26s/epoch - 16ms/step
Epoch 12/50
1601/1601 - 26s - loss: 3.1682 - accuracy500: 0.4437 - val_loss: 3.3426 - val_accuracy500: 0.3398 - 26s/epoch - 16ms/step
Epoch 13/50
1601/1601 - 26s - loss: 3.1592 - accuracy500: 0.4469 - val_loss: 3.3982 - val_accuracy500: 0.3314 - 26s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 25s - loss: 3.1582 - accuracy500: 0.4464 - val_loss: 3.4133 - val_accuracy500: 0.3373 - 25s/epoch - 16ms/step
Epoch 15/50
1601/1601 - 25s - loss: 3.1542 - accuracy500: 0.4486 - val_loss: 3.3803 - val_accuracy500: 0.3418 - 25s/epoch - 16ms/step
Epoch 16/50
1601/1601 - 26s - loss: 3.1539 - accuracy500: 0.4487 - val_loss: 3.3992 - val_accuracy500: 0.3436 - 26s/epoch - 16ms/step
Epoch 17/50
1601/1601 - 25s - loss: 3.1484 - accuracy500: 0.4502 - val_loss: 3.4106 - val_accuracy500: 0.3442 - 25s/epoch - 16ms/step
Epoch 18/50
1601/1601 - 25s - loss: 3.1493 - accuracy500: 0.4500 - val_loss: 3.4278 - val_accuracy500: 0.3381 - 25s/epoch - 16ms/step
Epoch 19/50
1601/1601 - 25s - loss: 3.1461 - accuracy500: 0.4514 - val_loss: 3.3944 - val_accuracy500: 0.3437 - 25s/epoch - 16ms/step
Epoch 20/50
1601/1601 - 25s - loss: 3.1441 - accuracy500: 0.4524 - val_loss: 3.3948 - val_accuracy500: 0.3481 - 25s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h500
Evaluating performance on  test set...
3782/3782 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.170859
{'0': {'precision': 0.34101345738494765, 'recall': 0.47476915675135545, 'f1-score': 0.39692601631361746, 'support': 324246}, '1': {'precision': 0.2796046975597907, 'recall': 0.367060307268975, 'f1-score': 0.31741871118361226, 'support': 279104}, '2': {'precision': 0.3530548080253657, 'recall': 0.1453694713687802, 'f1-score': 0.2059425791586203, 'support': 364602}, 'accuracy': 0.31963568441410317, 'macro avg': {'precision': 0.32455765432336803, 'recall': 0.3290663117963702, 'f1-score': 0.30676243555195, 'support': 967952}, 'weighted avg': {'precision': 0.32784221544728664, 'recall': 0.31963568441410317, 'f1-score': 0.30206206640226724, 'support': 967952}}
[[153942 121535  48769]
 [128303 102448  48353]
 [169180 142420  53002]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1317432
{'0': {'precision': 0.3435647521147399, 'recall': 0.44737888216714733, 'f1-score': 0.3886588325416535, 'support': 138357}, '1': {'precision': 0.3424688156659364, 'recall': 0.34398622857570543, 'f1-score': 0.34322584499574327, 'support': 133610}, '2': {'precision': 0.36293586060847505, 'recall': 0.2512537649236129, 'f1-score': 0.2969408717207543, 'support': 137785}, 'accuracy': 0.3477152033425096, 'macro avg': {'precision': 0.3496564761297171, 'recall': 0.3475396252221552, 'f1-score': 0.342941849752717, 'support': 409752}, 'weighted avg': {'precision': 0.3497212080072911, 'recall': 0.3477152033425096, 'f1-score': 0.34300277546879804, 'support': 409752}}
[[61898 43657 32802]
 [59685 45960 27965]
 [58581 44585 34619]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111354
{'0': {'precision': 0.36089290025442455, 'recall': 0.4054623602069771, 'f1-score': 0.3818816015720953, 'support': 47928}, '1': {'precision': 0.3294731240021288, 'recall': 0.360466741196199, 'f1-score': 0.34427378185094154, 'support': 42936}, '2': {'precision': 0.3521621009735114, 'recall': 0.2747383759438336, 'f1-score': 0.3086692298152053, 'support': 45294}, 'accuracy': 0.3477871296581912, 'macro avg': {'precision': 0.3475093750766883, 'recall': 0.3468891591156699, 'f1-score': 0.34494153774608066, 'support': 136158}, 'weighted avg': {'precision': 0.3480806355634167, 'recall': 0.3477871296581912, 'f1-score': 0.34566771392756446, 'support': 136158}}
[[19433 16166 12329]
 [16896 15477 10563]
 [17518 15332 12444]]
training model: results/EXC/W4/deepLOB_L1/h1000
Epoch 1/50
1601/1601 - 27s - loss: 3.2342 - accuracy1000: 0.4200 - val_loss: 3.3073 - val_accuracy1000: 0.3579 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 3.2125 - accuracy1000: 0.4277 - val_loss: 3.3596 - val_accuracy1000: 0.3002 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.1852 - accuracy1000: 0.4417 - val_loss: 3.4077 - val_accuracy1000: 0.2999 - 25s/epoch - 16ms/step
Epoch 4/50
1601/1601 - 25s - loss: 3.1750 - accuracy1000: 0.4422 - val_loss: 3.4604 - val_accuracy1000: 0.2752 - 25s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 25s - loss: 3.1661 - accuracy1000: 0.4480 - val_loss: 3.4709 - val_accuracy1000: 0.2581 - 25s/epoch - 16ms/step
Epoch 6/50
1601/1601 - 26s - loss: 3.1620 - accuracy1000: 0.4484 - val_loss: 3.4136 - val_accuracy1000: 0.2705 - 26s/epoch - 16ms/step
Epoch 7/50
1601/1601 - 25s - loss: 3.1464 - accuracy1000: 0.4554 - val_loss: 3.4286 - val_accuracy1000: 0.2849 - 25s/epoch - 16ms/step
Epoch 8/50
1601/1601 - 25s - loss: 3.1375 - accuracy1000: 0.4598 - val_loss: 3.4783 - val_accuracy1000: 0.2834 - 25s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 25s - loss: 3.1362 - accuracy1000: 0.4594 - val_loss: 3.4282 - val_accuracy1000: 0.2809 - 25s/epoch - 16ms/step
Epoch 10/50
1601/1601 - 26s - loss: 3.1257 - accuracy1000: 0.4657 - val_loss: 3.3776 - val_accuracy1000: 0.3270 - 26s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 26s - loss: 3.1238 - accuracy1000: 0.4642 - val_loss: 3.3907 - val_accuracy1000: 0.3264 - 26s/epoch - 16ms/step
testing model: results/EXC/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1245795
{'0': {'precision': 0.36035625344637784, 'recall': 0.5145902091381757, 'f1-score': 0.4238791920535384, 'support': 351777}, '1': {'precision': 0.24385121097418674, 'recall': 0.20211546354788335, 'f1-score': 0.22103041934951298, 'support': 211963}, '2': {'precision': 0.40437970806545076, 'recall': 0.29004829149060396, 'f1-score': 0.33780217247241195, 'support': 404212}, 'accuracy': 0.35239660644329474, 'macro avg': {'precision': 0.3361957241620051, 'recall': 0.3355846547255543, 'f1-score': 0.3275705946251544, 'support': 967952}, 'weighted avg': {'precision': 0.3532278527828652, 'recall': 0.3523966064432948, 'f1-score': 0.34351384475574925, 'support': 967952}}
[[181021  63050 107706]
 [104141  42841  64981]
 [217177  69794 117241]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110669
{'0': {'precision': 0.31855376313511397, 'recall': 0.36403679794347443, 'f1-score': 0.3397799457446629, 'support': 138486}, '1': {'precision': 0.35891876394326827, 'recall': 0.2981098377734782, 'f1-score': 0.3257003248059904, 'support': 134380}, '2': {'precision': 0.3787174721189591, 'recall': 0.3870008620311792, 'f1-score': 0.38281436303592203, 'support': 136886}, 'accuracy': 0.3500873699213183, 'macro avg': {'precision': 0.35206333306578047, 'recall': 0.3497158325827106, 'f1-score': 0.34943154452885844, 'support': 409752}, 'weighted avg': {'precision': 0.3518905577732424, 'recall': 0.3500873699213183, 'f1-score': 0.3495389945927283, 'support': 409752}}
[[50414 36687 51385]
 [58800 40060 35520]
 [49045 34866 52975]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043732
{'0': {'precision': 0.29080844027463243, 'recall': 0.16183560383284323, 'f1-score': 0.20794776886695454, 'support': 49989}, '1': {'precision': 0.4015827212311997, 'recall': 0.22776868521549373, 'f1-score': 0.29067375549859176, 'support': 40326}, '2': {'precision': 0.36877391273824983, 'recall': 0.6875204502323147, 'f1-score': 0.48005483207676486, 'support': 45843}, 'accuracy': 0.3583557337798734, 'macro avg': {'precision': 0.35372169141469395, 'recall': 0.3590415797602173, 'f1-score': 0.32622545214743703, 'support': 136158}, 'weighted avg': {'precision': 0.34986670205876663, 'recall': 0.3583557337798734, 'f1-score': 0.32406442918536943, 'support': 136158}}
[[ 8090  7075 34824]
 [12016  9185 19125]
 [ 7713  6612 31518]]
training model: results/EXC/W4/deepOF_L1/h10
Epoch 1/50
1601/1601 - 26s - loss: 3.1380 - accuracy10: 0.3603 - val_loss: 2.8413 - val_accuracy10: 0.4708 - 26s/epoch - 16ms/step
Epoch 2/50
1601/1601 - 23s - loss: 3.0414 - accuracy10: 0.3818 - val_loss: 2.8009 - val_accuracy10: 0.4985 - 23s/epoch - 15ms/step
Epoch 3/50
1601/1601 - 23s - loss: 2.9919 - accuracy10: 0.4042 - val_loss: 2.7712 - val_accuracy10: 0.5287 - 23s/epoch - 14ms/step
Epoch 4/50
1601/1601 - 23s - loss: 2.9548 - accuracy10: 0.4244 - val_loss: 2.7552 - val_accuracy10: 0.5319 - 23s/epoch - 14ms/step
Epoch 5/50
1601/1601 - 23s - loss: 2.9272 - accuracy10: 0.4368 - val_loss: 2.7319 - val_accuracy10: 0.5368 - 23s/epoch - 14ms/step
Epoch 6/50
1601/1601 - 23s - loss: 2.8998 - accuracy10: 0.4516 - val_loss: 2.7085 - val_accuracy10: 0.5434 - 23s/epoch - 14ms/step
Epoch 7/50
1601/1601 - 23s - loss: 2.8728 - accuracy10: 0.4664 - val_loss: 2.6912 - val_accuracy10: 0.5342 - 23s/epoch - 14ms/step
Epoch 8/50
1601/1601 - 23s - loss: 2.8470 - accuracy10: 0.4805 - val_loss: 2.6751 - val_accuracy10: 0.5289 - 23s/epoch - 14ms/step
Epoch 9/50
1601/1601 - 23s - loss: 2.8211 - accuracy10: 0.4907 - val_loss: 2.6620 - val_accuracy10: 0.5507 - 23s/epoch - 14ms/step
Epoch 10/50
1601/1601 - 23s - loss: 2.7958 - accuracy10: 0.5023 - val_loss: 2.6360 - val_accuracy10: 0.5594 - 23s/epoch - 14ms/step
Epoch 11/50
1601/1601 - 23s - loss: 2.7759 - accuracy10: 0.5082 - val_loss: 2.6306 - val_accuracy10: 0.5619 - 23s/epoch - 14ms/step
Epoch 12/50
1601/1601 - 23s - loss: 2.7570 - accuracy10: 0.5117 - val_loss: 2.6319 - val_accuracy10: 0.5497 - 23s/epoch - 14ms/step
Epoch 13/50
1601/1601 - 23s - loss: 2.7412 - accuracy10: 0.5148 - val_loss: 2.6177 - val_accuracy10: 0.5714 - 23s/epoch - 14ms/step
Epoch 14/50
1601/1601 - 23s - loss: 2.7282 - accuracy10: 0.5191 - val_loss: 2.6264 - val_accuracy10: 0.5672 - 23s/epoch - 14ms/step
Epoch 15/50
1601/1601 - 23s - loss: 2.7168 - accuracy10: 0.5190 - val_loss: 2.6025 - val_accuracy10: 0.5798 - 23s/epoch - 14ms/step
Epoch 16/50
1601/1601 - 22s - loss: 2.7011 - accuracy10: 0.5231 - val_loss: 2.6131 - val_accuracy10: 0.5541 - 22s/epoch - 14ms/step
Epoch 17/50
1601/1601 - 23s - loss: 2.6918 - accuracy10: 0.5267 - val_loss: 2.6058 - val_accuracy10: 0.5797 - 23s/epoch - 14ms/step
Epoch 18/50
1601/1601 - 23s - loss: 2.6802 - accuracy10: 0.5279 - val_loss: 2.6014 - val_accuracy10: 0.5691 - 23s/epoch - 14ms/step
Epoch 19/50
1601/1601 - 23s - loss: 2.6659 - accuracy10: 0.5320 - val_loss: 2.5830 - val_accuracy10: 0.5772 - 23s/epoch - 14ms/step
Epoch 20/50
1601/1601 - 23s - loss: 2.6596 - accuracy10: 0.5324 - val_loss: 2.5851 - val_accuracy10: 0.5767 - 23s/epoch - 14ms/step
Epoch 21/50
1601/1601 - 23s - loss: 2.6491 - accuracy10: 0.5359 - val_loss: 2.5781 - val_accuracy10: 0.5658 - 23s/epoch - 14ms/step
Epoch 22/50
1601/1601 - 23s - loss: 2.6455 - accuracy10: 0.5354 - val_loss: 2.5945 - val_accuracy10: 0.5833 - 23s/epoch - 14ms/step
Epoch 23/50
1601/1601 - 23s - loss: 2.6344 - accuracy10: 0.5391 - val_loss: 2.5913 - val_accuracy10: 0.5964 - 23s/epoch - 14ms/step
Epoch 24/50
1601/1601 - 23s - loss: 2.6243 - accuracy10: 0.5411 - val_loss: 2.5728 - val_accuracy10: 0.5922 - 23s/epoch - 14ms/step
Epoch 25/50
1601/1601 - 23s - loss: 2.6143 - accuracy10: 0.5434 - val_loss: 2.6037 - val_accuracy10: 0.5977 - 23s/epoch - 14ms/step
Epoch 26/50
1601/1601 - 23s - loss: 2.6078 - accuracy10: 0.5444 - val_loss: 2.6024 - val_accuracy10: 0.6071 - 23s/epoch - 14ms/step
Epoch 27/50
1601/1601 - 23s - loss: 2.5999 - accuracy10: 0.5466 - val_loss: 2.6271 - val_accuracy10: 0.6213 - 23s/epoch - 14ms/step
Epoch 28/50
1601/1601 - 23s - loss: 2.5906 - accuracy10: 0.5490 - val_loss: 2.6118 - val_accuracy10: 0.6163 - 23s/epoch - 15ms/step
Epoch 29/50
1601/1601 - 23s - loss: 2.5866 - accuracy10: 0.5498 - val_loss: 2.5923 - val_accuracy10: 0.5996 - 23s/epoch - 14ms/step
Epoch 30/50
1601/1601 - 23s - loss: 2.5791 - accuracy10: 0.5514 - val_loss: 2.5980 - val_accuracy10: 0.6202 - 23s/epoch - 14ms/step
Epoch 31/50
1601/1601 - 23s - loss: 2.5693 - accuracy10: 0.5527 - val_loss: 2.5790 - val_accuracy10: 0.5992 - 23s/epoch - 14ms/step
Epoch 32/50
1601/1601 - 23s - loss: 2.5664 - accuracy10: 0.5539 - val_loss: 2.5844 - val_accuracy10: 0.6207 - 23s/epoch - 14ms/step
Epoch 33/50
1601/1601 - 22s - loss: 2.5574 - accuracy10: 0.5557 - val_loss: 2.6182 - val_accuracy10: 0.6264 - 22s/epoch - 14ms/step
Epoch 34/50
1601/1601 - 23s - loss: 2.5499 - accuracy10: 0.5566 - val_loss: 2.6113 - val_accuracy10: 0.6193 - 23s/epoch - 14ms/step
testing model: results/EXC/W4/deepOF_L1/h10
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88327193
{'0': {'precision': 0.23679057194145067, 'recall': 0.5738567486007583, 'f1-score': 0.3352478057233265, 'support': 116313}, '1': {'precision': 0.8491597184124897, 'recall': 0.5553805659255932, 'f1-score': 0.6715461425093975, 'support': 730202}, '2': {'precision': 0.27243774222017575, 'recall': 0.4677476468505266, 'f1-score': 0.34432485352554093, 'support': 121433}, 'accuracy': 0.5466068425163335, 'macro avg': {'precision': 0.4527960108580387, 'recall': 0.5323283204589594, 'f1-score': 0.4503729339194216, 'support': 967948}, 'weighted avg': {'precision': 0.703222568618857, 'recall': 0.5466068425163335, 'f1-score': 0.5900837796223674, 'support': 967948}}
[[ 66747  33886  15680]
 [188654 405540 136008]
 [ 26481  38152  56800]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8536605
{'0': {'precision': 0.30813436475076733, 'recall': 0.5429746078282701, 'f1-score': 0.39315561520161046, 'support': 59349}, '1': {'precision': 0.8347059192465974, 'recall': 0.593612758014932, 'f1-score': 0.6938116692632672, 'support': 291456}, '2': {'precision': 0.3100943858788919, 'recall': 0.5150055136143863, 'f1-score': 0.38710541248780617, 'support': 58945}, 'accuracy': 0.5749701037217816, 'macro avg': {'precision': 0.48431155662541886, 'recall': 0.5505309598191961, 'f1-score': 0.4913575656508946, 'support': 409750}, 'weighted avg': {'precision': 0.6829677324933762, 'recall': 0.5749701037217816, 'f1-score': 0.6061425137827674, 'support': 409750}}
[[ 32225  17212   9912]
 [ 60817 173012  57627]
 [ 11539  17049  30357]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8283531
{'0': {'precision': 0.27768786833185743, 'recall': 0.5327787216591482, 'f1-score': 0.3650889236822032, 'support': 17069}, '1': {'precision': 0.8579088839518363, 'recall': 0.6124273099289252, 'f1-score': 0.7146757757163094, 'support': 102146}, '2': {'precision': 0.28962644714833885, 'recall': 0.5212182022074013, 'f1-score': 0.3723489480119745, 'support': 16943}, 'accuracy': 0.5910927011266323, 'macro avg': {'precision': 0.4750743998106775, 'recall': 0.5554747445984916, 'f1-score': 0.4840378824701624, 'support': 136158}, 'weighted avg': {'precision': 0.7144564107781772, 'recall': 0.5910927011266323, 'f1-score': 0.628253079883786, 'support': 136158}}
[[ 9094  5265  2710]
 [20639 62557 18950]
 [ 3016  5096  8831]]
training model: results/EXC/W4/deepOF_L1/h20
Epoch 1/50
1601/1601 - 25s - loss: 3.1578 - accuracy20: 0.3871 - val_loss: 2.9137 - val_accuracy20: 0.4984 - 25s/epoch - 16ms/step
Epoch 2/50
1601/1601 - 22s - loss: 3.0636 - accuracy20: 0.4145 - val_loss: 2.8745 - val_accuracy20: 0.5067 - 22s/epoch - 14ms/step
Epoch 3/50
1601/1601 - 23s - loss: 3.0198 - accuracy20: 0.4301 - val_loss: 2.8549 - val_accuracy20: 0.5205 - 23s/epoch - 14ms/step
Epoch 4/50
1601/1601 - 24s - loss: 2.9871 - accuracy20: 0.4449 - val_loss: 2.8349 - val_accuracy20: 0.5272 - 24s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 23s - loss: 2.9604 - accuracy20: 0.4556 - val_loss: 2.8160 - val_accuracy20: 0.5385 - 23s/epoch - 14ms/step
Epoch 6/50
1601/1601 - 23s - loss: 2.9383 - accuracy20: 0.4656 - val_loss: 2.8022 - val_accuracy20: 0.5311 - 23s/epoch - 14ms/step
Epoch 7/50
1601/1601 - 23s - loss: 2.9179 - accuracy20: 0.4752 - val_loss: 2.7908 - val_accuracy20: 0.5391 - 23s/epoch - 14ms/step
Epoch 8/50
1601/1601 - 23s - loss: 2.8979 - accuracy20: 0.4821 - val_loss: 2.7831 - val_accuracy20: 0.5376 - 23s/epoch - 14ms/step
Epoch 9/50
1601/1601 - 23s - loss: 2.8804 - accuracy20: 0.4895 - val_loss: 2.7724 - val_accuracy20: 0.5403 - 23s/epoch - 14ms/step
Epoch 10/50
1601/1601 - 23s - loss: 2.8617 - accuracy20: 0.4962 - val_loss: 2.7559 - val_accuracy20: 0.5464 - 23s/epoch - 14ms/step
Epoch 11/50
1601/1601 - 23s - loss: 2.8460 - accuracy20: 0.5032 - val_loss: 2.7535 - val_accuracy20: 0.5481 - 23s/epoch - 14ms/step
Epoch 12/50
1601/1601 - 23s - loss: 2.8284 - accuracy20: 0.5099 - val_loss: 2.7395 - val_accuracy20: 0.5595 - 23s/epoch - 14ms/step
Epoch 13/50
1601/1601 - 23s - loss: 2.8123 - accuracy20: 0.5149 - val_loss: 2.7348 - val_accuracy20: 0.5644 - 23s/epoch - 14ms/step
Epoch 14/50
1601/1601 - 23s - loss: 2.7976 - accuracy20: 0.5204 - val_loss: 2.7213 - val_accuracy20: 0.5573 - 23s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 23s - loss: 2.7840 - accuracy20: 0.5250 - val_loss: 2.7095 - val_accuracy20: 0.5777 - 23s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 23s - loss: 2.7693 - accuracy20: 0.5300 - val_loss: 2.7068 - val_accuracy20: 0.5810 - 23s/epoch - 14ms/step
Epoch 17/50
1601/1601 - 23s - loss: 2.7560 - accuracy20: 0.5339 - val_loss: 2.6982 - val_accuracy20: 0.5830 - 23s/epoch - 14ms/step
Epoch 18/50
1601/1601 - 23s - loss: 2.7420 - accuracy20: 0.5374 - val_loss: 2.6928 - val_accuracy20: 0.5800 - 23s/epoch - 14ms/step
Epoch 19/50
1601/1601 - 23s - loss: 2.7322 - accuracy20: 0.5401 - val_loss: 2.6878 - val_accuracy20: 0.5880 - 23s/epoch - 14ms/step
Epoch 20/50
1601/1601 - 23s - loss: 2.7211 - accuracy20: 0.5417 - val_loss: 2.6924 - val_accuracy20: 0.5979 - 23s/epoch - 14ms/step
Epoch 21/50
1601/1601 - 23s - loss: 2.7113 - accuracy20: 0.5446 - val_loss: 2.6854 - val_accuracy20: 0.6008 - 23s/epoch - 14ms/step
Epoch 22/50
1601/1601 - 22s - loss: 2.7004 - accuracy20: 0.5471 - val_loss: 2.6944 - val_accuracy20: 0.5952 - 22s/epoch - 14ms/step
Epoch 23/50
1601/1601 - 23s - loss: 2.6916 - accuracy20: 0.5495 - val_loss: 2.6954 - val_accuracy20: 0.6008 - 23s/epoch - 14ms/step
Epoch 24/50
1601/1601 - 22s - loss: 2.6813 - accuracy20: 0.5521 - val_loss: 2.6832 - val_accuracy20: 0.5946 - 22s/epoch - 14ms/step
Epoch 25/50
1601/1601 - 23s - loss: 2.6763 - accuracy20: 0.5528 - val_loss: 2.6904 - val_accuracy20: 0.6023 - 23s/epoch - 14ms/step
Epoch 26/50
1601/1601 - 23s - loss: 2.6685 - accuracy20: 0.5542 - val_loss: 2.6952 - val_accuracy20: 0.6065 - 23s/epoch - 14ms/step
Epoch 27/50
1601/1601 - 22s - loss: 2.6603 - accuracy20: 0.5557 - val_loss: 2.7109 - val_accuracy20: 0.6084 - 22s/epoch - 14ms/step
Epoch 28/50
1601/1601 - 22s - loss: 2.6516 - accuracy20: 0.5586 - val_loss: 2.7051 - val_accuracy20: 0.6076 - 22s/epoch - 14ms/step
Epoch 29/50
1601/1601 - 22s - loss: 2.6425 - accuracy20: 0.5598 - val_loss: 2.7081 - val_accuracy20: 0.6062 - 22s/epoch - 14ms/step
Epoch 30/50
1601/1601 - 22s - loss: 2.6382 - accuracy20: 0.5609 - val_loss: 2.7107 - val_accuracy20: 0.6112 - 22s/epoch - 14ms/step
Epoch 31/50
1601/1601 - 23s - loss: 2.6295 - accuracy20: 0.5628 - val_loss: 2.7067 - val_accuracy20: 0.6081 - 23s/epoch - 14ms/step
Epoch 32/50
1601/1601 - 23s - loss: 2.6218 - accuracy20: 0.5642 - val_loss: 2.7112 - val_accuracy20: 0.6110 - 23s/epoch - 14ms/step
Epoch 33/50
1601/1601 - 23s - loss: 2.6141 - accuracy20: 0.5664 - val_loss: 2.7137 - val_accuracy20: 0.6098 - 23s/epoch - 15ms/step
Epoch 34/50
1601/1601 - 22s - loss: 2.6089 - accuracy20: 0.5669 - val_loss: 2.7067 - val_accuracy20: 0.6090 - 22s/epoch - 14ms/step
testing model: results/EXC/W4/deepOF_L1/h20
Evaluating performance on  test set...
3782/3782 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8993225
{'0': {'precision': 0.33605944380936104, 'recall': 0.40716194963465385, 'f1-score': 0.36820957938386895, 'support': 154511}, '1': {'precision': 0.7566300847784342, 'recall': 0.633900666896348, 'f1-score': 0.6898492748286453, 'support': 650176}, '2': {'precision': 0.3379202819956616, 'recall': 0.4885428853186003, 'f1-score': 0.39950612707961314, 'support': 163261}, 'accuracy': 0.5731898821011046, 'macro avg': {'precision': 0.47686993686115225, 'recall': 0.5098685006165341, 'f1-score': 0.48585499376404245, 'support': 967948}, 'weighted avg': {'precision': 0.6188729207377103, 'recall': 0.5731898821011046, 'f1-score': 0.5895354319078246, 'support': 967948}}
[[ 62911  69137  22463]
 [104220 412147 133809]
 [ 20071  63430  79760]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89413565
{'0': {'precision': 0.3939494968203988, 'recall': 0.40791694369150516, 'f1-score': 0.40081157308240734, 'support': 78212}, '1': {'precision': 0.7372929311367681, 'recall': 0.6364957924926723, 'f1-score': 0.6831965358739179, 'support': 253832}, '2': {'precision': 0.3730742919688056, 'recall': 0.5263686201837696, 'f1-score': 0.43665828622672026, 'support': 77706}, 'accuracy': 0.571980475899939, 'macro avg': {'precision': 0.5014389066419908, 'recall': 0.5235937854559823, 'f1-score': 0.5068887983943485, 'support': 409750}, 'weighted avg': {'precision': 0.6026851208623628, 'recall': 0.571980475899939, 'f1-score': 0.5825415171138575, 'support': 409750}}
[[ 31904  31434  14874]
 [ 38410 161563  53859]
 [ 10671  26133  40902]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8678198
{'0': {'precision': 0.3733523334520841, 'recall': 0.41173389209009953, 'f1-score': 0.39160490751697086, 'support': 22908}, '1': {'precision': 0.7715862675146062, 'recall': 0.6590813735232417, 'f1-score': 0.7109102385460956, 'support': 90570}, '2': {'precision': 0.35045182070322983, 'recall': 0.5181216931216931, 'f1-score': 0.4181032182313071, 'support': 22680}, 'accuracy': 0.5939863981550846, 'macro avg': {'precision': 0.4984634738899734, 'recall': 0.5296456529116781, 'f1-score': 0.5068727880981245, 'support': 136158}, 'weighted avg': {'precision': 0.6344362490420503, 'recall': 0.5939863981550846, 'f1-score': 0.6084152713465583, 'support': 136158}}
[[ 9432  9518  3958]
 [13055 59693 17822]
 [ 2776  8153 11751]]
training model: results/EXC/W4/deepOF_L1/h30
Epoch 1/50
1601/1601 - 25s - loss: 3.1779 - accuracy30: 0.3966 - val_loss: 2.9677 - val_accuracy30: 0.4857 - 25s/epoch - 16ms/step
Epoch 2/50
1601/1601 - 22s - loss: 3.0949 - accuracy30: 0.4207 - val_loss: 2.9376 - val_accuracy30: 0.4923 - 22s/epoch - 14ms/step
Epoch 3/50
1601/1601 - 23s - loss: 3.0576 - accuracy30: 0.4372 - val_loss: 2.9239 - val_accuracy30: 0.5103 - 23s/epoch - 14ms/step
Epoch 4/50
1601/1601 - 23s - loss: 3.0300 - accuracy30: 0.4487 - val_loss: 2.9098 - val_accuracy30: 0.5084 - 23s/epoch - 14ms/step
Epoch 5/50
1601/1601 - 23s - loss: 3.0089 - accuracy30: 0.4590 - val_loss: 2.8924 - val_accuracy30: 0.5144 - 23s/epoch - 14ms/step
Epoch 6/50
1601/1601 - 22s - loss: 2.9895 - accuracy30: 0.4675 - val_loss: 2.8780 - val_accuracy30: 0.5229 - 22s/epoch - 14ms/step
Epoch 7/50
1601/1601 - 23s - loss: 2.9731 - accuracy30: 0.4736 - val_loss: 2.8690 - val_accuracy30: 0.5237 - 23s/epoch - 14ms/step
Epoch 8/50
1601/1601 - 23s - loss: 2.9556 - accuracy30: 0.4806 - val_loss: 2.8490 - val_accuracy30: 0.5249 - 23s/epoch - 14ms/step
Epoch 9/50
1601/1601 - 23s - loss: 2.9398 - accuracy30: 0.4865 - val_loss: 2.8446 - val_accuracy30: 0.5311 - 23s/epoch - 14ms/step
Epoch 10/50
1601/1601 - 23s - loss: 2.9238 - accuracy30: 0.4921 - val_loss: 2.8248 - val_accuracy30: 0.5325 - 23s/epoch - 14ms/step
Epoch 11/50
1601/1601 - 23s - loss: 2.9078 - accuracy30: 0.4976 - val_loss: 2.8160 - val_accuracy30: 0.5371 - 23s/epoch - 14ms/step
Epoch 12/50
1601/1601 - 22s - loss: 2.8928 - accuracy30: 0.5038 - val_loss: 2.8079 - val_accuracy30: 0.5351 - 22s/epoch - 14ms/step
Epoch 13/50
1601/1601 - 23s - loss: 2.8768 - accuracy30: 0.5095 - val_loss: 2.7932 - val_accuracy30: 0.5430 - 23s/epoch - 14ms/step
Epoch 14/50
1601/1601 - 23s - loss: 2.8621 - accuracy30: 0.5151 - val_loss: 2.7822 - val_accuracy30: 0.5464 - 23s/epoch - 14ms/step
Epoch 15/50
1601/1601 - 23s - loss: 2.8484 - accuracy30: 0.5187 - val_loss: 2.7873 - val_accuracy30: 0.5396 - 23s/epoch - 14ms/step
Epoch 16/50
1601/1601 - 22s - loss: 2.8362 - accuracy30: 0.5226 - val_loss: 2.7717 - val_accuracy30: 0.5449 - 22s/epoch - 14ms/step
Epoch 17/50
1601/1601 - 23s - loss: 2.8240 - accuracy30: 0.5254 - val_loss: 2.7713 - val_accuracy30: 0.5523 - 23s/epoch - 14ms/step
Epoch 18/50
1601/1601 - 22s - loss: 2.8128 - accuracy30: 0.5273 - val_loss: 2.7719 - val_accuracy30: 0.5524 - 22s/epoch - 14ms/step
Epoch 19/50
1601/1601 - 23s - loss: 2.8056 - accuracy30: 0.5286 - val_loss: 2.7665 - val_accuracy30: 0.5493 - 23s/epoch - 14ms/step
Epoch 20/50
1601/1601 - 23s - loss: 2.7940 - accuracy30: 0.5323 - val_loss: 2.7702 - val_accuracy30: 0.5558 - 23s/epoch - 15ms/step
Epoch 21/50
1601/1601 - 22s - loss: 2.7840 - accuracy30: 0.5332 - val_loss: 2.7663 - val_accuracy30: 0.5593 - 22s/epoch - 14ms/step
Epoch 22/50
1601/1601 - 23s - loss: 2.7744 - accuracy30: 0.5361 - val_loss: 2.7668 - val_accuracy30: 0.5658 - 23s/epoch - 14ms/step
Epoch 23/50
1601/1601 - 23s - loss: 2.7684 - accuracy30: 0.5379 - val_loss: 2.7714 - val_accuracy30: 0.5619 - 23s/epoch - 14ms/step
Epoch 24/50
1601/1601 - 22s - loss: 2.7589 - accuracy30: 0.5393 - val_loss: 2.7784 - val_accuracy30: 0.5626 - 22s/epoch - 14ms/step
Epoch 25/50
1601/1601 - 22s - loss: 2.7505 - accuracy30: 0.5415 - val_loss: 2.7721 - val_accuracy30: 0.5683 - 22s/epoch - 14ms/step
Epoch 26/50
1601/1601 - 22s - loss: 2.7425 - accuracy30: 0.5436 - val_loss: 2.7759 - val_accuracy30: 0.5665 - 22s/epoch - 14ms/step
Epoch 27/50
1601/1601 - 22s - loss: 2.7355 - accuracy30: 0.5452 - val_loss: 2.7758 - val_accuracy30: 0.5616 - 22s/epoch - 14ms/step
Epoch 28/50
1601/1601 - 22s - loss: 2.7289 - accuracy30: 0.5468 - val_loss: 2.7783 - val_accuracy30: 0.5634 - 22s/epoch - 14ms/step
Epoch 29/50
1601/1601 - 23s - loss: 2.7218 - accuracy30: 0.5486 - val_loss: 2.7934 - val_accuracy30: 0.5662 - 23s/epoch - 14ms/step
Epoch 30/50
1601/1601 - 22s - loss: 2.7141 - accuracy30: 0.5518 - val_loss: 2.8059 - val_accuracy30: 0.5697 - 22s/epoch - 14ms/step
Epoch 31/50
1601/1601 - 23s - loss: 2.7073 - accuracy30: 0.5522 - val_loss: 2.8015 - val_accuracy30: 0.5600 - 23s/epoch - 14ms/step
testing model: results/EXC/W4/deepOF_L1/h30
Evaluating performance on  test set...
3782/3782 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92657393
{'0': {'precision': 0.3550949447716679, 'recall': 0.3916004165082723, 'f1-score': 0.37245531573734925, 'support': 181509}, '1': {'precision': 0.7058166193099911, 'recall': 0.5976610116983089, 'f1-score': 0.6472517283537539, 'support': 593932}, '2': {'precision': 0.37487257322791834, 'recall': 0.5157630631613396, 'f1-score': 0.4341740185628546, 'support': 192507}, 'accuracy': 0.5427326674573427, 'macro avg': {'precision': 0.4785947124365258, 'recall': 0.5016748304559736, 'f1-score': 0.4846270208846526, 'support': 967948}, 'weighted avg': {'precision': 0.5742308462076157, 'recall': 0.5427326674573427, 'f1-score': 0.5533448524303494, 'support': 967948}}
[[ 71079  77964  32466]
 [105858 354970 133104]
 [ 23232  69987  99288]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93621653
{'0': {'precision': 0.4072546681689401, 'recall': 0.4067563285953086, 'f1-score': 0.407005345839756, 'support': 91529}, '1': {'precision': 0.6859641411456843, 'recall': 0.5910149765070083, 'f1-score': 0.6349596092206886, 'support': 227089}, '2': {'precision': 0.40410997986582653, 'recall': 0.5439911337400694, 'f1-score': 0.46373164834034114, 'support': 91132}, 'accuracy': 0.5393971934106162, 'macro avg': {'precision': 0.4991095963934837, 'recall': 0.5139208129474621, 'f1-score': 0.5018988678002619, 'support': 409750}, 'weighted avg': {'precision': 0.5610198268617442, 'recall': 0.5393971934106162, 'f1-score': 0.5459571142751335, 'support': 409750}}
[[ 37230  34364  19935]
 [ 39709 134213  53167]
 [ 14478  27079  49575]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9106796
{'0': {'precision': 0.3863911255486056, 'recall': 0.4122939636417272, 'f1-score': 0.3989225060653632, 'support': 27119}, '1': {'precision': 0.724674988495168, 'recall': 0.613432181725221, 'f1-score': 0.6644295302013424, 'support': 82146}, '2': {'precision': 0.38609526336738753, 'recall': 0.5410329825605176, 'f1-score': 0.45061785747468175, 'support': 26893}, 'accuracy': 0.5590710791874146, 'macro avg': {'precision': 0.49905379247038706, 'recall': 0.5222530426424886, 'f1-score': 0.5046566312471291, 'support': 136158}, 'weighted avg': {'precision': 0.5904240107552685, 'recall': 0.5590710791874146, 'f1-score': 0.5693170703959567, 'support': 136158}}
[[11181 10583  5355]
 [13975 50391 17780]
 [ 3781  8562 14550]]
training model: results/EXC/W4/deepOF_L1/h50
Epoch 1/50
1601/1601 - 25s - loss: 3.2202 - accuracy50: 0.4014 - val_loss: 3.0811 - val_accuracy50: 0.4622 - 25s/epoch - 15ms/step
Epoch 2/50
1601/1601 - 22s - loss: 3.1539 - accuracy50: 0.4223 - val_loss: 3.0572 - val_accuracy50: 0.4741 - 22s/epoch - 14ms/step
Epoch 3/50
1601/1601 - 22s - loss: 3.1211 - accuracy50: 0.4374 - val_loss: 3.0422 - val_accuracy50: 0.4870 - 22s/epoch - 14ms/step
Epoch 4/50
1601/1601 - 22s - loss: 3.1014 - accuracy50: 0.4474 - val_loss: 3.0373 - val_accuracy50: 0.4872 - 22s/epoch - 14ms/step
Epoch 5/50
1601/1601 - 22s - loss: 3.0855 - accuracy50: 0.4546 - val_loss: 3.0224 - val_accuracy50: 0.4967 - 22s/epoch - 14ms/step
Epoch 6/50
1601/1601 - 23s - loss: 3.0707 - accuracy50: 0.4604 - val_loss: 3.0088 - val_accuracy50: 0.5022 - 23s/epoch - 14ms/step
Epoch 7/50
1601/1601 - 23s - loss: 3.0574 - accuracy50: 0.4658 - val_loss: 3.0052 - val_accuracy50: 0.5027 - 23s/epoch - 14ms/step
Epoch 8/50
1601/1601 - 23s - loss: 3.0429 - accuracy50: 0.4722 - val_loss: 2.9989 - val_accuracy50: 0.5130 - 23s/epoch - 14ms/step
Epoch 9/50
1601/1601 - 22s - loss: 3.0315 - accuracy50: 0.4762 - val_loss: 3.0010 - val_accuracy50: 0.5160 - 22s/epoch - 14ms/step
Epoch 10/50
1601/1601 - 23s - loss: 3.0199 - accuracy50: 0.4817 - val_loss: 2.9905 - val_accuracy50: 0.5157 - 23s/epoch - 14ms/step
Epoch 11/50
1601/1601 - 23s - loss: 3.0073 - accuracy50: 0.4858 - val_loss: 2.9847 - val_accuracy50: 0.5198 - 23s/epoch - 15ms/step
Epoch 12/50
1601/1601 - 23s - loss: 2.9981 - accuracy50: 0.4893 - val_loss: 2.9743 - val_accuracy50: 0.5216 - 23s/epoch - 14ms/step
Epoch 13/50
1601/1601 - 22s - loss: 2.9855 - accuracy50: 0.4934 - val_loss: 2.9625 - val_accuracy50: 0.5220 - 22s/epoch - 14ms/step
Epoch 14/50
1601/1601 - 23s - loss: 2.9756 - accuracy50: 0.4959 - val_loss: 2.9665 - val_accuracy50: 0.5174 - 23s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 23s - loss: 2.9655 - accuracy50: 0.4993 - val_loss: 2.9554 - val_accuracy50: 0.5185 - 23s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 23s - loss: 2.9565 - accuracy50: 0.5018 - val_loss: 2.9600 - val_accuracy50: 0.5207 - 23s/epoch - 14ms/step
Epoch 17/50
1601/1601 - 24s - loss: 2.9476 - accuracy50: 0.5044 - val_loss: 2.9627 - val_accuracy50: 0.5185 - 24s/epoch - 15ms/step
Epoch 18/50
1601/1601 - 24s - loss: 2.9371 - accuracy50: 0.5068 - val_loss: 2.9489 - val_accuracy50: 0.5215 - 24s/epoch - 15ms/step
Epoch 19/50
1601/1601 - 23s - loss: 2.9297 - accuracy50: 0.5097 - val_loss: 2.9623 - val_accuracy50: 0.5213 - 23s/epoch - 15ms/step
Epoch 20/50
1601/1601 - 23s - loss: 2.9200 - accuracy50: 0.5127 - val_loss: 2.9454 - val_accuracy50: 0.5239 - 23s/epoch - 14ms/step
Epoch 21/50
1601/1601 - 24s - loss: 2.9125 - accuracy50: 0.5136 - val_loss: 2.9460 - val_accuracy50: 0.5246 - 24s/epoch - 15ms/step
Epoch 22/50
1601/1601 - 23s - loss: 2.9038 - accuracy50: 0.5165 - val_loss: 2.9384 - val_accuracy50: 0.5264 - 23s/epoch - 14ms/step
Epoch 23/50
1601/1601 - 23s - loss: 2.8959 - accuracy50: 0.5189 - val_loss: 2.9464 - val_accuracy50: 0.5270 - 23s/epoch - 14ms/step
Epoch 24/50
1601/1601 - 23s - loss: 2.8900 - accuracy50: 0.5209 - val_loss: 2.9355 - val_accuracy50: 0.5333 - 23s/epoch - 14ms/step
Epoch 25/50
1601/1601 - 23s - loss: 2.8804 - accuracy50: 0.5228 - val_loss: 2.9421 - val_accuracy50: 0.5368 - 23s/epoch - 14ms/step
Epoch 26/50
1601/1601 - 22s - loss: 2.8744 - accuracy50: 0.5245 - val_loss: 2.9454 - val_accuracy50: 0.5346 - 22s/epoch - 14ms/step
Epoch 27/50
1601/1601 - 23s - loss: 2.8669 - accuracy50: 0.5269 - val_loss: 2.9581 - val_accuracy50: 0.5356 - 23s/epoch - 14ms/step
Epoch 28/50
1601/1601 - 23s - loss: 2.8604 - accuracy50: 0.5289 - val_loss: 2.9633 - val_accuracy50: 0.5361 - 23s/epoch - 14ms/step
Epoch 29/50
1601/1601 - 23s - loss: 2.8518 - accuracy50: 0.5309 - val_loss: 2.9725 - val_accuracy50: 0.5376 - 23s/epoch - 14ms/step
Epoch 30/50
1601/1601 - 23s - loss: 2.8460 - accuracy50: 0.5325 - val_loss: 2.9625 - val_accuracy50: 0.5349 - 23s/epoch - 15ms/step
Epoch 31/50
1601/1601 - 23s - loss: 2.8394 - accuracy50: 0.5341 - val_loss: 2.9643 - val_accuracy50: 0.5372 - 23s/epoch - 15ms/step
Epoch 32/50
1601/1601 - 24s - loss: 2.8339 - accuracy50: 0.5355 - val_loss: 2.9838 - val_accuracy50: 0.5346 - 24s/epoch - 15ms/step
Epoch 33/50
1601/1601 - 23s - loss: 2.8311 - accuracy50: 0.5363 - val_loss: 2.9744 - val_accuracy50: 0.5379 - 23s/epoch - 14ms/step
Epoch 34/50
1601/1601 - 23s - loss: 2.8240 - accuracy50: 0.5379 - val_loss: 2.9953 - val_accuracy50: 0.5350 - 23s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h50
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95728326
{'0': {'precision': 0.424047091233885, 'recall': 0.3544188807540789, 'f1-score': 0.3861191134105474, 'support': 222364}, '1': {'precision': 0.6080044891955428, 'recall': 0.6421369320340942, 'f1-score': 0.6246047538701083, 'support': 507887}, '2': {'precision': 0.43961871736325636, 'recall': 0.4544146539501971, 'f1-score': 0.4468942518939002, 'support': 237697}, 'accuracy': 0.5299416910825788, 'macro avg': {'precision': 0.49055676593089476, 'recall': 0.48365682224612333, 'f1-score': 0.4858727063915187, 'support': 967948}, 'weighted avg': {'precision': 0.5243943204183306, 'recall': 0.5299416910825788, 'f1-score': 0.5261781089022086, 'support': 967948}}
[[ 78810 107361  36193]
 [ 80263 326133 101491]
 [ 26779 102905 108013]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9824499
{'0': {'precision': 0.46165708833514546, 'recall': 0.3741558990405798, 'f1-score': 0.4133262477215951, 'support': 111213}, '1': {'precision': 0.5629116398065501, 'recall': 0.6320069194915028, 'f1-score': 0.5954615879914684, 'support': 187297}, '2': {'precision': 0.46397570635421526, 'recall': 0.45600503416037397, 'f1-score': 0.4599558414827106, 'support': 111240}, 'accuracy': 0.5142403904820012, 'macro avg': {'precision': 0.4961814781653036, 'recall': 0.4873892842308189, 'f1-score': 0.4895812257319247, 'support': 409750}, 'weighted avg': {'precision': 0.5085700762433358, 'recall': 0.5142403904820012, 'f1-score': 0.5092395578778195, 'support': 409750}}
[[ 41611  48550  21052]
 [ 31373 118373  37551]
 [ 17150  43364  50726]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95855296
{'0': {'precision': 0.4430159463010974, 'recall': 0.3694029850746269, 'f1-score': 0.4028744448930157, 'support': 33768}, '1': {'precision': 0.6071184853147789, 'recall': 0.6562861606109697, 'f1-score': 0.630745598487534, 'support': 69136}, '2': {'precision': 0.44568027415379063, 'recall': 0.44584110182233716, 'f1-score': 0.4457606734816596, 'support': 33254}, 'accuracy': 0.533740213575405, 'macro avg': {'precision': 0.4986049019232223, 'recall': 0.49051008250264455, 'f1-score': 0.4931269056207365, 'support': 136158}, 'weighted avg': {'precision': 0.5269918617497918, 'recall': 0.533740213575405, 'f1-score': 0.5290531396476198, 'support': 136158}}
[[12474 15501  5793]
 [11116 45373 12647]
 [ 4567 13861 14826]]
training model: results/EXC/W4/deepOF_L1/h100
Epoch 1/50
1601/1601 - 25s - loss: 3.2817 - accuracy100: 0.3879 - val_loss: 3.2452 - val_accuracy100: 0.3995 - 25s/epoch - 16ms/step
Epoch 2/50
1601/1601 - 24s - loss: 3.2433 - accuracy100: 0.4050 - val_loss: 3.2318 - val_accuracy100: 0.4088 - 24s/epoch - 15ms/step
Epoch 3/50
1601/1601 - 25s - loss: 3.2240 - accuracy100: 0.4143 - val_loss: 3.2246 - val_accuracy100: 0.4130 - 25s/epoch - 15ms/step
Epoch 4/50
1601/1601 - 23s - loss: 3.2114 - accuracy100: 0.4217 - val_loss: 3.2240 - val_accuracy100: 0.4125 - 23s/epoch - 14ms/step
Epoch 5/50
1601/1601 - 24s - loss: 3.2004 - accuracy100: 0.4285 - val_loss: 3.2220 - val_accuracy100: 0.4144 - 24s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 24s - loss: 3.1902 - accuracy100: 0.4343 - val_loss: 3.2302 - val_accuracy100: 0.4135 - 24s/epoch - 15ms/step
Epoch 7/50
1601/1601 - 23s - loss: 3.1819 - accuracy100: 0.4383 - val_loss: 3.2325 - val_accuracy100: 0.4137 - 23s/epoch - 15ms/step
Epoch 8/50
1601/1601 - 24s - loss: 3.1728 - accuracy100: 0.4422 - val_loss: 3.2342 - val_accuracy100: 0.4155 - 24s/epoch - 15ms/step
Epoch 9/50
1601/1601 - 23s - loss: 3.1655 - accuracy100: 0.4462 - val_loss: 3.2401 - val_accuracy100: 0.4145 - 23s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 23s - loss: 3.1588 - accuracy100: 0.4485 - val_loss: 3.2414 - val_accuracy100: 0.4159 - 23s/epoch - 14ms/step
Epoch 11/50
1601/1601 - 23s - loss: 3.1521 - accuracy100: 0.4514 - val_loss: 3.2340 - val_accuracy100: 0.4166 - 23s/epoch - 14ms/step
Epoch 12/50
1601/1601 - 23s - loss: 3.1466 - accuracy100: 0.4534 - val_loss: 3.2470 - val_accuracy100: 0.4160 - 23s/epoch - 15ms/step
Epoch 13/50
1601/1601 - 23s - loss: 3.1393 - accuracy100: 0.4565 - val_loss: 3.2504 - val_accuracy100: 0.4172 - 23s/epoch - 14ms/step
Epoch 14/50
1601/1601 - 24s - loss: 3.1345 - accuracy100: 0.4580 - val_loss: 3.2463 - val_accuracy100: 0.4180 - 24s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 23s - loss: 3.1290 - accuracy100: 0.4598 - val_loss: 3.2442 - val_accuracy100: 0.4168 - 23s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h100
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0630493
{'0': {'precision': 0.4799538153929916, 'recall': 0.17756762670130338, 'f1-score': 0.2592288386949578, 'support': 287941}, '1': {'precision': 0.396484375, 'recall': 0.7713298791018999, 'f1-score': 0.5237480942887299, 'support': 364770}, '2': {'precision': 0.5066310026550364, 'recall': 0.2439434457249625, 'f1-score': 0.32931926410634144, 'support': 315237}, 'accuracy': 0.4229431746333481, 'macro avg': {'precision': 0.4610230643493427, 'recall': 0.39761365050938857, 'f1-score': 0.3707653990300097, 'support': 967948}, 'weighted avg': {'precision': 0.45718656829787246, 'recall': 0.4229431746333481, 'f1-score': 0.38173932923613213, 'support': 967948}}
[[ 51129 209245  27567]
 [ 36092 281358  47320]
 [ 19308 219029  76900]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0923508
{'0': {'precision': 0.46481739939520816, 'recall': 0.23266916034756283, 'f1-score': 0.31010970038506674, 'support': 137414}, '1': {'precision': 0.3504165328598145, 'recall': 0.690684876421396, 'f1-score': 0.46494490841462555, 'support': 134287}, '2': {'precision': 0.470484131041806, 'recall': 0.25997290817028734, 'f1-score': 0.33489478841039516, 'support': 138049}, 'accuracy': 0.3919731543624161, 'macro avg': {'precision': 0.42857268776560953, 'recall': 0.3944423149797487, 'f1-score': 0.3699831324033625, 'support': 409750}, 'weighted avg': {'precision': 0.4292340863327134, 'recall': 0.3919731543624161, 'f1-score': 0.3692040559615742, 'support': 409750}}
[[31972 86730 18712]
 [19857 92750 21680]
 [16955 85205 35889]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.07467
{'0': {'precision': 0.4729835552075176, 'recall': 0.23438106325184324, 'f1-score': 0.31344058121432283, 'support': 43809}, '1': {'precision': 0.38931070582401234, 'recall': 0.710796346223492, 'f1-score': 0.503079453459312, 'support': 49702}, '2': {'precision': 0.46692541343233207, 'recall': 0.2595258752081037, 'f1-score': 0.33361968922849694, 'support': 42647}, 'accuracy': 0.4161635746706033, 'macro avg': {'precision': 0.44307322482128736, 'recall': 0.4015677615611463, 'f1-score': 0.38337990796737725, 'support': 136158}, 'weighted avg': {'precision': 0.44054279129834356, 'recall': 0.4161635746706033, 'f1-score': 0.38898523997694373, 'support': 136158}}
[[10268 28329  5212]
 [ 6950 35328  7424]
 [ 4491 27088 11068]]
training model: results/EXC/W4/deepOF_L1/h200
Epoch 1/50
1601/1601 - 27s - loss: 3.2987 - accuracy200: 0.3687 - val_loss: 3.2860 - val_accuracy200: 0.3665 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 23s - loss: 3.2755 - accuracy200: 0.3773 - val_loss: 3.2755 - val_accuracy200: 0.3741 - 23s/epoch - 14ms/step
Epoch 3/50
1601/1601 - 24s - loss: 3.2678 - accuracy200: 0.3805 - val_loss: 3.2723 - val_accuracy200: 0.3779 - 24s/epoch - 15ms/step
Epoch 4/50
1601/1601 - 24s - loss: 3.2636 - accuracy200: 0.3838 - val_loss: 3.2704 - val_accuracy200: 0.3783 - 24s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 24s - loss: 3.2604 - accuracy200: 0.3861 - val_loss: 3.2695 - val_accuracy200: 0.3799 - 24s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 24s - loss: 3.2581 - accuracy200: 0.3876 - val_loss: 3.2692 - val_accuracy200: 0.3807 - 24s/epoch - 15ms/step
Epoch 7/50
1601/1601 - 23s - loss: 3.2554 - accuracy200: 0.3901 - val_loss: 3.2673 - val_accuracy200: 0.3825 - 23s/epoch - 14ms/step
Epoch 8/50
1601/1601 - 24s - loss: 3.2527 - accuracy200: 0.3919 - val_loss: 3.2673 - val_accuracy200: 0.3825 - 24s/epoch - 15ms/step
Epoch 9/50
1601/1601 - 24s - loss: 3.2504 - accuracy200: 0.3930 - val_loss: 3.2687 - val_accuracy200: 0.3831 - 24s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 24s - loss: 3.2477 - accuracy200: 0.3957 - val_loss: 3.2687 - val_accuracy200: 0.3818 - 24s/epoch - 15ms/step
Epoch 11/50
1601/1601 - 24s - loss: 3.2460 - accuracy200: 0.3967 - val_loss: 3.2671 - val_accuracy200: 0.3845 - 24s/epoch - 15ms/step
Epoch 12/50
1601/1601 - 23s - loss: 3.2437 - accuracy200: 0.3981 - val_loss: 3.2663 - val_accuracy200: 0.3846 - 23s/epoch - 15ms/step
Epoch 13/50
1601/1601 - 24s - loss: 3.2415 - accuracy200: 0.3998 - val_loss: 3.2697 - val_accuracy200: 0.3835 - 24s/epoch - 15ms/step
Epoch 14/50
1601/1601 - 25s - loss: 3.2387 - accuracy200: 0.4014 - val_loss: 3.2736 - val_accuracy200: 0.3830 - 25s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 24s - loss: 3.2366 - accuracy200: 0.4032 - val_loss: 3.2730 - val_accuracy200: 0.3835 - 24s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 24s - loss: 3.2350 - accuracy200: 0.4045 - val_loss: 3.2764 - val_accuracy200: 0.3843 - 24s/epoch - 15ms/step
Epoch 17/50
1601/1601 - 25s - loss: 3.2325 - accuracy200: 0.4051 - val_loss: 3.2802 - val_accuracy200: 0.3818 - 25s/epoch - 15ms/step
Epoch 18/50
1601/1601 - 24s - loss: 3.2307 - accuracy200: 0.4065 - val_loss: 3.2777 - val_accuracy200: 0.3816 - 24s/epoch - 15ms/step
Epoch 19/50
1601/1601 - 24s - loss: 3.2311 - accuracy200: 0.4067 - val_loss: 3.2761 - val_accuracy200: 0.3841 - 24s/epoch - 15ms/step
Epoch 20/50
1601/1601 - 24s - loss: 3.2267 - accuracy200: 0.4095 - val_loss: 3.2833 - val_accuracy200: 0.3822 - 24s/epoch - 15ms/step
Epoch 21/50
1601/1601 - 24s - loss: 3.2227 - accuracy200: 0.4119 - val_loss: 3.2874 - val_accuracy200: 0.3807 - 24s/epoch - 15ms/step
Epoch 22/50
1601/1601 - 24s - loss: 3.2201 - accuracy200: 0.4137 - val_loss: 3.2875 - val_accuracy200: 0.3805 - 24s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h200
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851054
{'0': {'precision': 0.422700256944865, 'recall': 0.3064405865455777, 'f1-score': 0.35530176598274377, 'support': 318884}, '1': {'precision': 0.3239631098661989, 'recall': 0.3589786701728782, 'f1-score': 0.3405732370281514, 'support': 297377}, '2': {'precision': 0.44147466795661644, 'recall': 0.5112244694856506, 'f1-score': 0.4737962784838814, 'support': 351687}, 'accuracy': 0.3969862017381099, 'macro avg': {'precision': 0.3960460115892268, 'recall': 0.39221457540136884, 'f1-score': 0.3898904271649255, 'support': 967948}, 'weighted avg': {'precision': 0.3991871753523387, 'recall': 0.3969862017381099, 'f1-score': 0.3938297177560392, 'support': 967948}}
[[ 97719 112844 108321]
 [ 71486 106752 119139]
 [ 61973 109923 179791]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911298
{'0': {'precision': 0.4066095195127453, 'recall': 0.36919723193515824, 'f1-score': 0.3870012958830792, 'support': 136702}, '1': {'precision': 0.34212659406274326, 'recall': 0.3145916507390653, 'f1-score': 0.32778187857538293, 'support': 135509}, '2': {'precision': 0.4007936754376704, 'recall': 0.4692269101854747, 'f1-score': 0.4323189153341685, 'support': 137539}, 'accuracy': 0.3847150701647346, 'macro avg': {'precision': 0.38317659633771967, 'recall': 0.3843385976198994, 'f1-score': 0.38236736326421017, 'support': 409750}, 'weighted avg': {'precision': 0.383332101274683, 'recall': 0.3847150701647346, 'f1-score': 0.3826283271014679, 'support': 409750}}
[[50470 42067 44165]
 [40558 42630 52321]
 [33096 39906 64537]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0883617
{'0': {'precision': 0.41580858578321644, 'recall': 0.3648545426769385, 'f1-score': 0.38866867378846176, 'support': 45821}, '1': {'precision': 0.34713786121847967, 'recall': 0.3289654420582143, 'f1-score': 0.33780743095747184, 'support': 45865}, '2': {'precision': 0.3957285474775187, 'recall': 0.46705792408706603, 'f1-score': 0.4284447194719472, 'support': 44472}, 'accuracy': 0.3861469763069375, 'macro avg': {'precision': 0.38622499815973826, 'recall': 0.38695930294073966, 'f1-score': 0.3849736080726269, 'support': 136158}, 'weighted avg': {'precision': 0.3861182095607937, 'recall': 0.3861469763069375, 'f1-score': 0.3845276714323212, 'support': 136158}}
[[16718 14823 14280]
 [13340 15088 17437]
 [10148 13553 20771]]
training model: results/EXC/W4/deepOF_L1/h300
Epoch 1/50
1601/1601 - 27s - loss: 3.3093 - accuracy300: 0.3575 - val_loss: 3.3044 - val_accuracy300: 0.3494 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 25s - loss: 3.2879 - accuracy300: 0.3644 - val_loss: 3.2889 - val_accuracy300: 0.3554 - 25s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 23s - loss: 3.2807 - accuracy300: 0.3683 - val_loss: 3.2825 - val_accuracy300: 0.3596 - 23s/epoch - 15ms/step
Epoch 4/50
1601/1601 - 24s - loss: 3.2770 - accuracy300: 0.3706 - val_loss: 3.2804 - val_accuracy300: 0.3638 - 24s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 24s - loss: 3.2741 - accuracy300: 0.3746 - val_loss: 3.2790 - val_accuracy300: 0.3646 - 24s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 24s - loss: 3.2716 - accuracy300: 0.3766 - val_loss: 3.2777 - val_accuracy300: 0.3670 - 24s/epoch - 15ms/step
Epoch 7/50
1601/1601 - 24s - loss: 3.2701 - accuracy300: 0.3780 - val_loss: 3.2773 - val_accuracy300: 0.3687 - 24s/epoch - 15ms/step
Epoch 8/50
1601/1601 - 24s - loss: 3.2680 - accuracy300: 0.3791 - val_loss: 3.2768 - val_accuracy300: 0.3701 - 24s/epoch - 15ms/step
Epoch 9/50
1601/1601 - 24s - loss: 3.2662 - accuracy300: 0.3808 - val_loss: 3.2773 - val_accuracy300: 0.3695 - 24s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 25s - loss: 3.2643 - accuracy300: 0.3828 - val_loss: 3.2779 - val_accuracy300: 0.3709 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 23s - loss: 3.2629 - accuracy300: 0.3836 - val_loss: 3.2780 - val_accuracy300: 0.3731 - 23s/epoch - 15ms/step
Epoch 12/50
1601/1601 - 24s - loss: 3.2615 - accuracy300: 0.3848 - val_loss: 3.2795 - val_accuracy300: 0.3704 - 24s/epoch - 15ms/step
Epoch 13/50
1601/1601 - 24s - loss: 3.2605 - accuracy300: 0.3857 - val_loss: 3.2784 - val_accuracy300: 0.3702 - 24s/epoch - 15ms/step
Epoch 14/50
1601/1601 - 24s - loss: 3.2588 - accuracy300: 0.3874 - val_loss: 3.2778 - val_accuracy300: 0.3726 - 24s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 24s - loss: 3.2577 - accuracy300: 0.3883 - val_loss: 3.2814 - val_accuracy300: 0.3715 - 24s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 24s - loss: 3.2560 - accuracy300: 0.3900 - val_loss: 3.2808 - val_accuracy300: 0.3703 - 24s/epoch - 15ms/step
Epoch 17/50
1601/1601 - 24s - loss: 3.2553 - accuracy300: 0.3894 - val_loss: 3.2834 - val_accuracy300: 0.3713 - 24s/epoch - 15ms/step
Epoch 18/50
1601/1601 - 24s - loss: 3.2531 - accuracy300: 0.3919 - val_loss: 3.2845 - val_accuracy300: 0.3708 - 24s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h300
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0853608
{'0': {'precision': 0.3855718000085248, 'recall': 0.29237099140912354, 'f1-score': 0.3325649622799665, 'support': 309398}, '1': {'precision': 0.38457776703832836, 'recall': 0.211461200215115, 'f1-score': 0.27287905879279234, 'support': 316110}, '2': {'precision': 0.398115183620363, 'recall': 0.6504935171124868, 'f1-score': 0.49393323902062614, 'support': 342440}, 'accuracy': 0.392644026331993, 'macro avg': {'precision': 0.3894215835557387, 'recall': 0.38477523624557514, 'f1-score': 0.36645908669779503, 'support': 967948}, 'weighted avg': {'precision': 0.38968476116122003, 'recall': 0.392644026331993, 'f1-score': 0.3701616531515225, 'support': 967948}}
[[ 90459  55143 163796]
 [ 76292  66845 172973]
 [ 67859  51826 222755]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946003
{'0': {'precision': 0.3875279083884642, 'recall': 0.2742244322939039, 'f1-score': 0.3211764103963435, 'support': 137351}, '1': {'precision': 0.3492196049069861, 'recall': 0.2693931046738937, 'f1-score': 0.3041559027864864, 'support': 135048}, '2': {'precision': 0.37257113240777623, 'recall': 0.565237966960561, 'f1-score': 0.4491134700488821, 'support': 137351}, 'accuracy': 0.37018181818181817, 'macro avg': {'precision': 0.3697728819010755, 'recall': 0.36961850130945284, 'f1-score': 0.3581485944105707, 'support': 409750}, 'weighted avg': {'precision': 0.36988840160069086, 'recall': 0.37018181818181817, 'f1-score': 0.358452060350315, 'support': 409750}}
[[37665 35875 63811]
 [31735 36381 66932]
 [27793 31922 77636]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923114
{'0': {'precision': 0.39747217506130916, 'recall': 0.27383195789200077, 'f1-score': 0.32426609210880686, 'support': 46167}, '1': {'precision': 0.35665271489991746, 'recall': 0.2729035490969302, 'f1-score': 0.30920760306097256, 'support': 45899}, '2': {'precision': 0.3635654547818174, 'recall': 0.5708518552118298, 'f1-score': 0.44421697272398364, 'support': 44092}, 'accuracy': 0.36970284522393104, 'macro avg': {'precision': 0.37256344824768134, 'recall': 0.37252912073358696, 'f1-score': 0.3592302226312543, 'support': 136158}, 'weighted avg': {'precision': 0.37273189162213505, 'recall': 0.36970284522393104, 'f1-score': 0.35803351406916045, 'support': 136158}}
[[12642 12174 21351]
 [10663 12526 22710]
 [ 8501 10421 25170]]
training model: results/EXC/W4/deepOF_L1/h500
Epoch 1/50
1601/1601 - 26s - loss: 3.2946 - accuracy500: 0.3713 - val_loss: 3.3315 - val_accuracy500: 0.3395 - 26s/epoch - 16ms/step
Epoch 2/50
1601/1601 - 24s - loss: 3.2823 - accuracy500: 0.3756 - val_loss: 3.2994 - val_accuracy500: 0.3536 - 24s/epoch - 15ms/step
Epoch 3/50
1601/1601 - 24s - loss: 3.2807 - accuracy500: 0.3768 - val_loss: 3.2908 - val_accuracy500: 0.3601 - 24s/epoch - 15ms/step
Epoch 4/50
1601/1601 - 24s - loss: 3.2825 - accuracy500: 0.3742 - val_loss: 3.2880 - val_accuracy500: 0.3619 - 24s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 24s - loss: 3.2815 - accuracy500: 0.3740 - val_loss: 3.2862 - val_accuracy500: 0.3649 - 24s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 24s - loss: 3.2810 - accuracy500: 0.3749 - val_loss: 3.2860 - val_accuracy500: 0.3645 - 24s/epoch - 15ms/step
Epoch 7/50
1601/1601 - 24s - loss: 3.2791 - accuracy500: 0.3770 - val_loss: 3.2852 - val_accuracy500: 0.3651 - 24s/epoch - 15ms/step
Epoch 8/50
1601/1601 - 26s - loss: 3.2796 - accuracy500: 0.3754 - val_loss: 3.2846 - val_accuracy500: 0.3655 - 26s/epoch - 16ms/step
Epoch 9/50
1601/1601 - 24s - loss: 3.2789 - accuracy500: 0.3754 - val_loss: 3.2845 - val_accuracy500: 0.3658 - 24s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 25s - loss: 3.2784 - accuracy500: 0.3762 - val_loss: 3.2837 - val_accuracy500: 0.3677 - 25s/epoch - 16ms/step
Epoch 11/50
1601/1601 - 24s - loss: 3.2774 - accuracy500: 0.3767 - val_loss: 3.2835 - val_accuracy500: 0.3687 - 24s/epoch - 15ms/step
Epoch 12/50
1601/1601 - 24s - loss: 3.2764 - accuracy500: 0.3778 - val_loss: 3.2847 - val_accuracy500: 0.3669 - 24s/epoch - 15ms/step
Epoch 13/50
1601/1601 - 25s - loss: 3.2751 - accuracy500: 0.3790 - val_loss: 3.2843 - val_accuracy500: 0.3688 - 25s/epoch - 15ms/step
Epoch 14/50
1601/1601 - 25s - loss: 3.2746 - accuracy500: 0.3791 - val_loss: 3.2836 - val_accuracy500: 0.3705 - 25s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 24s - loss: 3.2738 - accuracy500: 0.3789 - val_loss: 3.2836 - val_accuracy500: 0.3704 - 24s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 25s - loss: 3.2723 - accuracy500: 0.3804 - val_loss: 3.2838 - val_accuracy500: 0.3710 - 25s/epoch - 15ms/step
Epoch 17/50
1601/1601 - 25s - loss: 3.2715 - accuracy500: 0.3815 - val_loss: 3.2835 - val_accuracy500: 0.3710 - 25s/epoch - 15ms/step
Epoch 18/50
1601/1601 - 25s - loss: 3.2709 - accuracy500: 0.3814 - val_loss: 3.2833 - val_accuracy500: 0.3711 - 25s/epoch - 15ms/step
Epoch 19/50
1601/1601 - 25s - loss: 3.2701 - accuracy500: 0.3825 - val_loss: 3.2845 - val_accuracy500: 0.3706 - 25s/epoch - 15ms/step
Epoch 20/50
1601/1601 - 25s - loss: 3.2695 - accuracy500: 0.3829 - val_loss: 3.2841 - val_accuracy500: 0.3725 - 25s/epoch - 15ms/step
Epoch 21/50
1601/1601 - 25s - loss: 3.2676 - accuracy500: 0.3849 - val_loss: 3.2847 - val_accuracy500: 0.3709 - 25s/epoch - 16ms/step
Epoch 22/50
1601/1601 - 25s - loss: 3.2674 - accuracy500: 0.3836 - val_loss: 3.2837 - val_accuracy500: 0.3726 - 25s/epoch - 15ms/step
Epoch 23/50
1601/1601 - 25s - loss: 3.2662 - accuracy500: 0.3854 - val_loss: 3.2843 - val_accuracy500: 0.3720 - 25s/epoch - 15ms/step
Epoch 24/50
1601/1601 - 24s - loss: 3.2650 - accuracy500: 0.3867 - val_loss: 3.2851 - val_accuracy500: 0.3723 - 24s/epoch - 15ms/step
Epoch 25/50
1601/1601 - 24s - loss: 3.2638 - accuracy500: 0.3876 - val_loss: 3.2858 - val_accuracy500: 0.3715 - 24s/epoch - 15ms/step
Epoch 26/50
1601/1601 - 24s - loss: 3.2616 - accuracy500: 0.3897 - val_loss: 3.2891 - val_accuracy500: 0.3705 - 24s/epoch - 15ms/step
Epoch 27/50
1601/1601 - 25s - loss: 3.2610 - accuracy500: 0.3904 - val_loss: 3.2877 - val_accuracy500: 0.3715 - 25s/epoch - 15ms/step
Epoch 28/50
1601/1601 - 25s - loss: 3.2595 - accuracy500: 0.3927 - val_loss: 3.2900 - val_accuracy500: 0.3704 - 25s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h500
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0872145
{'0': {'precision': 0.3798251268574073, 'recall': 0.3543596797473508, 'f1-score': 0.36665076450062145, 'support': 324244}, '1': {'precision': 0.4739893834218048, 'recall': 0.020795190306087716, 'f1-score': 0.03984238779741065, 'support': 279103}, '2': {'precision': 0.40507319373298756, 'recall': 0.7257056343784027, 'f1-score': 0.5199317350478827, 'support': 364601}, 'accuracy': 0.3980544409410423, 'macro avg': {'precision': 0.41962923467073326, 'recall': 0.3669535014772804, 'f1-score': 0.3088082957819716, 'support': 967948}, 'weighted avg': {'precision': 0.4164872171048137, 'recall': 0.3980544409410423, 'f1-score': 0.33015417251376444, 'support': 967948}}
[[114899   2971 206374]
 [ 91068   5804 182231]
 [ 96538   3470 264593]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952052
{'0': {'precision': 0.37821412854418573, 'recall': 0.3912393146953198, 'f1-score': 0.3846164774745337, 'support': 138391}, '1': {'precision': 0.40042194092827005, 'recall': 0.021307009534643536, 'f1-score': 0.04046103120914103, 'support': 133618}, '2': {'precision': 0.3597345490841404, 'recall': 0.6776849304128764, 'f1-score': 0.4699867077517975, 'support': 137741}, 'accuracy': 0.36689688834655276, 'macro avg': {'precision': 0.37945687285219876, 'recall': 0.3634104182142799, 'f1-score': 0.2983547388118241, 'support': 409750}, 'weighted avg': {'precision': 0.37924394604444317, 'recall': 0.36689688834655276, 'f1-score': 0.30108656525862487, 'support': 409750}}
[[54144  2041 82206]
 [46839  2847 83932]
 [42174  2222 93345]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942494
{'0': {'precision': 0.39781295563424285, 'recall': 0.3986016904935824, 'f1-score': 0.3982069324993485, 'support': 47915}, '1': {'precision': 0.34264773247824093, 'recall': 0.01741357234314981, 'f1-score': 0.033142806504497316, 'support': 42955}, '2': {'precision': 0.3585412667946257, 'recall': 0.6805776364599894, 'f1-score': 0.469657836392311, 'support': 45288}, 'accuracy': 0.37213384450417897, 'macro avg': {'precision': 0.3663339849690365, 'recall': 0.36553096643224053, 'f1-score': 0.30033585846538563, 'support': 136158}, 'weighted avg': {'precision': 0.3673471849499302, 'recall': 0.37213384450417897, 'f1-score': 0.30680238045977426, 'support': 136158}}
[[19099   755 28061]
 [15125   748 27082]
 [13786   680 30822]]
training model: results/EXC/W4/deepOF_L1/h1000
Epoch 1/50
1601/1601 - 27s - loss: 3.2799 - accuracy1000: 0.3874 - val_loss: 3.3221 - val_accuracy1000: 0.3119 - 27s/epoch - 17ms/step
Epoch 2/50
1601/1601 - 26s - loss: 3.2849 - accuracy1000: 0.3751 - val_loss: 3.2983 - val_accuracy1000: 0.3309 - 26s/epoch - 16ms/step
Epoch 3/50
1601/1601 - 24s - loss: 3.2899 - accuracy1000: 0.3645 - val_loss: 3.2991 - val_accuracy1000: 0.3209 - 24s/epoch - 15ms/step
Epoch 4/50
1601/1601 - 23s - loss: 3.2909 - accuracy1000: 0.3623 - val_loss: 3.2986 - val_accuracy1000: 0.3190 - 23s/epoch - 15ms/step
Epoch 5/50
1601/1601 - 25s - loss: 3.2904 - accuracy1000: 0.3632 - val_loss: 3.2977 - val_accuracy1000: 0.3236 - 25s/epoch - 15ms/step
Epoch 6/50
1601/1601 - 24s - loss: 3.2901 - accuracy1000: 0.3624 - val_loss: 3.2977 - val_accuracy1000: 0.3252 - 24s/epoch - 15ms/step
Epoch 7/50
1601/1601 - 24s - loss: 3.2895 - accuracy1000: 0.3626 - val_loss: 3.2976 - val_accuracy1000: 0.3273 - 24s/epoch - 15ms/step
Epoch 8/50
1601/1601 - 24s - loss: 3.2888 - accuracy1000: 0.3640 - val_loss: 3.2970 - val_accuracy1000: 0.3311 - 24s/epoch - 15ms/step
Epoch 9/50
1601/1601 - 24s - loss: 3.2881 - accuracy1000: 0.3641 - val_loss: 3.2967 - val_accuracy1000: 0.3336 - 24s/epoch - 15ms/step
Epoch 10/50
1601/1601 - 24s - loss: 3.2877 - accuracy1000: 0.3646 - val_loss: 3.2967 - val_accuracy1000: 0.3348 - 24s/epoch - 15ms/step
Epoch 11/50
1601/1601 - 24s - loss: 3.2868 - accuracy1000: 0.3659 - val_loss: 3.2961 - val_accuracy1000: 0.3369 - 24s/epoch - 15ms/step
Epoch 12/50
1601/1601 - 25s - loss: 3.2865 - accuracy1000: 0.3661 - val_loss: 3.2967 - val_accuracy1000: 0.3364 - 25s/epoch - 15ms/step
Epoch 13/50
1601/1601 - 25s - loss: 3.2852 - accuracy1000: 0.3670 - val_loss: 3.2962 - val_accuracy1000: 0.3402 - 25s/epoch - 16ms/step
Epoch 14/50
1601/1601 - 24s - loss: 3.2840 - accuracy1000: 0.3679 - val_loss: 3.2965 - val_accuracy1000: 0.3390 - 24s/epoch - 15ms/step
Epoch 15/50
1601/1601 - 24s - loss: 3.2832 - accuracy1000: 0.3697 - val_loss: 3.2964 - val_accuracy1000: 0.3428 - 24s/epoch - 15ms/step
Epoch 16/50
1601/1601 - 23s - loss: 3.2818 - accuracy1000: 0.3716 - val_loss: 3.2955 - val_accuracy1000: 0.3451 - 23s/epoch - 14ms/step
Epoch 17/50
1601/1601 - 23s - loss: 3.2809 - accuracy1000: 0.3718 - val_loss: 3.2959 - val_accuracy1000: 0.3460 - 23s/epoch - 14ms/step
Epoch 18/50
1601/1601 - 23s - loss: 3.2783 - accuracy1000: 0.3749 - val_loss: 3.2955 - val_accuracy1000: 0.3473 - 23s/epoch - 14ms/step
Epoch 19/50
1601/1601 - 23s - loss: 3.2769 - accuracy1000: 0.3767 - val_loss: 3.2982 - val_accuracy1000: 0.3394 - 23s/epoch - 15ms/step
Epoch 20/50
1601/1601 - 23s - loss: 3.2733 - accuracy1000: 0.3803 - val_loss: 3.2958 - val_accuracy1000: 0.3411 - 23s/epoch - 14ms/step
Epoch 21/50
1601/1601 - 23s - loss: 3.2706 - accuracy1000: 0.3827 - val_loss: 3.2950 - val_accuracy1000: 0.3438 - 23s/epoch - 14ms/step
Epoch 22/50
1601/1601 - 23s - loss: 3.2695 - accuracy1000: 0.3847 - val_loss: 3.2943 - val_accuracy1000: 0.3473 - 23s/epoch - 14ms/step
Epoch 23/50
1601/1601 - 23s - loss: 3.2681 - accuracy1000: 0.3857 - val_loss: 3.2946 - val_accuracy1000: 0.3440 - 23s/epoch - 15ms/step
Epoch 24/50
1601/1601 - 24s - loss: 3.2640 - accuracy1000: 0.3880 - val_loss: 3.2924 - val_accuracy1000: 0.3513 - 24s/epoch - 15ms/step
Epoch 25/50
1601/1601 - 23s - loss: 3.2626 - accuracy1000: 0.3894 - val_loss: 3.2948 - val_accuracy1000: 0.3470 - 23s/epoch - 14ms/step
Epoch 26/50
1601/1601 - 23s - loss: 3.2609 - accuracy1000: 0.3907 - val_loss: 3.2933 - val_accuracy1000: 0.3504 - 23s/epoch - 15ms/step
Epoch 27/50
1601/1601 - 23s - loss: 3.2597 - accuracy1000: 0.3909 - val_loss: 3.2905 - val_accuracy1000: 0.3589 - 23s/epoch - 15ms/step
Epoch 28/50
1601/1601 - 23s - loss: 3.2603 - accuracy1000: 0.3896 - val_loss: 3.2907 - val_accuracy1000: 0.3589 - 23s/epoch - 15ms/step
Epoch 29/50
1601/1601 - 23s - loss: 3.2578 - accuracy1000: 0.3918 - val_loss: 3.2910 - val_accuracy1000: 0.3586 - 23s/epoch - 14ms/step
Epoch 30/50
1601/1601 - 23s - loss: 3.2558 - accuracy1000: 0.3934 - val_loss: 3.2926 - val_accuracy1000: 0.3552 - 23s/epoch - 14ms/step
Epoch 31/50
1601/1601 - 23s - loss: 3.2545 - accuracy1000: 0.3951 - val_loss: 3.2903 - val_accuracy1000: 0.3622 - 23s/epoch - 15ms/step
Epoch 32/50
1601/1601 - 23s - loss: 3.2540 - accuracy1000: 0.3948 - val_loss: 3.2935 - val_accuracy1000: 0.3491 - 23s/epoch - 14ms/step
Epoch 33/50
1601/1601 - 23s - loss: 3.2502 - accuracy1000: 0.3971 - val_loss: 3.2920 - val_accuracy1000: 0.3569 - 23s/epoch - 14ms/step
Epoch 34/50
1601/1601 - 23s - loss: 3.2488 - accuracy1000: 0.3984 - val_loss: 3.2929 - val_accuracy1000: 0.3557 - 23s/epoch - 14ms/step
Epoch 35/50
1601/1601 - 24s - loss: 3.2474 - accuracy1000: 0.3986 - val_loss: 3.2925 - val_accuracy1000: 0.3542 - 24s/epoch - 15ms/step
Epoch 36/50
1601/1601 - 24s - loss: 3.2461 - accuracy1000: 0.4003 - val_loss: 3.2931 - val_accuracy1000: 0.3506 - 24s/epoch - 15ms/step
Epoch 37/50
1601/1601 - 23s - loss: 3.2450 - accuracy1000: 0.4008 - val_loss: 3.2924 - val_accuracy1000: 0.3523 - 23s/epoch - 14ms/step
Epoch 38/50
1601/1601 - 23s - loss: 3.2431 - accuracy1000: 0.4023 - val_loss: 3.2948 - val_accuracy1000: 0.3502 - 23s/epoch - 14ms/step
Epoch 39/50
1601/1601 - 23s - loss: 3.2407 - accuracy1000: 0.4033 - val_loss: 3.2944 - val_accuracy1000: 0.3487 - 23s/epoch - 14ms/step
Epoch 40/50
1601/1601 - 24s - loss: 3.2420 - accuracy1000: 0.4030 - val_loss: 3.2940 - val_accuracy1000: 0.3533 - 24s/epoch - 15ms/step
Epoch 41/50
1601/1601 - 24s - loss: 3.2444 - accuracy1000: 0.4008 - val_loss: 3.2944 - val_accuracy1000: 0.3449 - 24s/epoch - 15ms/step
testing model: results/EXC/W4/deepOF_L1/h1000
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094728
{'0': {'precision': 0.3915917915942357, 'recall': 0.3643721128562291, 'f1-score': 0.37749190838435687, 'support': 351775}, '1': {'precision': 0.23484600083065557, 'recall': 0.10137146577468709, 'f1-score': 0.14161479221108755, 'support': 211963}, '2': {'precision': 0.43880786187631005, 'recall': 0.5961331980901017, 'f1-score': 0.5055127179047162, 'support': 404210}, 'accuracy': 0.4035619682049036, 'macro avg': {'precision': 0.3550818847670671, 'recall': 0.35395892557367264, 'f1-score': 0.34153980616672025, 'support': 967948}, 'weighted avg': {'precision': 0.3769844983523431, 'recall': 0.4035619682049036, 'f1-score': 0.3792999293119168, 'support': 967948}}
[[128177  32961 190637]
 [ 72945  21487 117531]
 [126201  37046 240963]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971673
{'0': {'precision': 0.3616426904455049, 'recall': 0.37488626023657873, 'f1-score': 0.36814540864268014, 'support': 138474}, '1': {'precision': 0.3476529810057566, 'recall': 0.10205008337303478, 'f1-score': 0.15778418475102002, 'support': 134336}, '2': {'precision': 0.35067380452613195, 'recall': 0.580714181393311, 'f1-score': 0.4372855446067218, 'support': 136940}, 'accuracy': 0.35422574740695545, 'macro avg': {'precision': 0.35332315865913116, 'recall': 0.3525501750009748, 'f1-score': 0.3210717126668073, 'support': 409750}, 'weighted avg': {'precision': 0.35339033938974657, 'recall': 0.35422574740695545, 'f1-score': 0.3222856523185943, 'support': 409750}}
[[51912 12970 73592]
 [46970 13709 73657]
 [44663 12754 79523]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977602
{'0': {'precision': 0.3927911275415896, 'recall': 0.37426947402129535, 'f1-score': 0.3833066863444431, 'support': 49964}, '1': {'precision': 0.29728728135191224, 'recall': 0.0992944671370219, 'f1-score': 0.14886707369124277, 'support': 40395}, '2': {'precision': 0.3547789709291481, 'recall': 0.5814319089936462, 'f1-score': 0.44066955161885535, 'support': 45799}, 'accuracy': 0.3623731253396789, 'macro avg': {'precision': 0.3482857932742167, 'recall': 0.3516652833839878, 'f1-score': 0.32428110388484704, 'support': 136158}, 'weighted avg': {'precision': 0.3516712768715943, 'recall': 0.3623731253396789, 'f1-score': 0.33304870454077956, 'support': 136158}}
[[18700  5038 26226]
 [14181  4011 22203]
 [14727  4443 26629]]
training model: results/EXC/W4/deepLOB_L2/h10
Epoch 1/50
1601/1601 - 69s - loss: 2.6847 - accuracy10: 0.4765 - val_loss: 2.5615 - val_accuracy10: 0.6138 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 66s - loss: 2.4024 - accuracy10: 0.5499 - val_loss: 2.3099 - val_accuracy10: 0.6292 - 66s/epoch - 41ms/step
Epoch 3/50
1601/1601 - 66s - loss: 2.2072 - accuracy10: 0.6230 - val_loss: 2.2080 - val_accuracy10: 0.6192 - 66s/epoch - 41ms/step
Epoch 4/50
1601/1601 - 66s - loss: 2.1145 - accuracy10: 0.6446 - val_loss: 2.1408 - val_accuracy10: 0.6297 - 66s/epoch - 41ms/step
Epoch 5/50
1601/1601 - 66s - loss: 2.0702 - accuracy10: 0.6519 - val_loss: 2.1474 - val_accuracy10: 0.6362 - 66s/epoch - 41ms/step
Epoch 6/50
1601/1601 - 66s - loss: 2.0378 - accuracy10: 0.6574 - val_loss: 2.1269 - val_accuracy10: 0.6310 - 66s/epoch - 41ms/step
Epoch 7/50
1601/1601 - 67s - loss: 2.0162 - accuracy10: 0.6592 - val_loss: 2.0772 - val_accuracy10: 0.6471 - 67s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 66s - loss: 1.9973 - accuracy10: 0.6613 - val_loss: 2.0304 - val_accuracy10: 0.6527 - 66s/epoch - 41ms/step
Epoch 9/50
1601/1601 - 66s - loss: 1.9820 - accuracy10: 0.6624 - val_loss: 2.0485 - val_accuracy10: 0.6584 - 66s/epoch - 41ms/step
Epoch 10/50
1601/1601 - 66s - loss: 1.9716 - accuracy10: 0.6644 - val_loss: 2.0111 - val_accuracy10: 0.6799 - 66s/epoch - 41ms/step
Epoch 11/50
1601/1601 - 67s - loss: 1.9617 - accuracy10: 0.6654 - val_loss: 2.0144 - val_accuracy10: 0.6711 - 67s/epoch - 42ms/step
Epoch 12/50
1601/1601 - 67s - loss: 1.9522 - accuracy10: 0.6669 - val_loss: 1.9712 - val_accuracy10: 0.6850 - 67s/epoch - 42ms/step
Epoch 13/50
1601/1601 - 66s - loss: 1.9433 - accuracy10: 0.6676 - val_loss: 1.9826 - val_accuracy10: 0.6836 - 66s/epoch - 41ms/step
Epoch 14/50
1601/1601 - 67s - loss: 1.9359 - accuracy10: 0.6686 - val_loss: 1.9408 - val_accuracy10: 0.6808 - 67s/epoch - 42ms/step
Epoch 15/50
1601/1601 - 67s - loss: 1.9306 - accuracy10: 0.6701 - val_loss: 1.9836 - val_accuracy10: 0.6804 - 67s/epoch - 42ms/step
Epoch 16/50
1601/1601 - 67s - loss: 1.9236 - accuracy10: 0.6705 - val_loss: 1.9808 - val_accuracy10: 0.6811 - 67s/epoch - 42ms/step
Epoch 17/50
1601/1601 - 66s - loss: 1.9163 - accuracy10: 0.6714 - val_loss: 1.9675 - val_accuracy10: 0.6860 - 66s/epoch - 41ms/step
Epoch 18/50
1601/1601 - 66s - loss: 1.9102 - accuracy10: 0.6723 - val_loss: 1.9907 - val_accuracy10: 0.6742 - 66s/epoch - 41ms/step
Epoch 19/50
1601/1601 - 67s - loss: 1.9050 - accuracy10: 0.6730 - val_loss: 1.9535 - val_accuracy10: 0.6808 - 67s/epoch - 42ms/step
Epoch 20/50
1601/1601 - 65s - loss: 1.9009 - accuracy10: 0.6739 - val_loss: 1.9627 - val_accuracy10: 0.6850 - 65s/epoch - 41ms/step
Epoch 21/50
1601/1601 - 65s - loss: 1.8936 - accuracy10: 0.6746 - val_loss: 1.9658 - val_accuracy10: 0.6820 - 65s/epoch - 41ms/step
Epoch 22/50
1601/1601 - 66s - loss: 1.8892 - accuracy10: 0.6754 - val_loss: 1.9709 - val_accuracy10: 0.6765 - 66s/epoch - 41ms/step
Epoch 23/50
1601/1601 - 65s - loss: 1.8843 - accuracy10: 0.6757 - val_loss: 1.9922 - val_accuracy10: 0.6782 - 65s/epoch - 41ms/step
Epoch 24/50
1601/1601 - 65s - loss: 1.8780 - accuracy10: 0.6764 - val_loss: 1.9819 - val_accuracy10: 0.6810 - 65s/epoch - 41ms/step
testing model: results/EXC/W4/deepLOB_L2/h10
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8204738
{'0': {'precision': 0.3503304603801356, 'recall': 0.6384559171216094, 'f1-score': 0.45241431408624033, 'support': 116315}, '1': {'precision': 0.9333904939887663, 'recall': 0.6142256136641268, 'f1-score': 0.7408973661149018, 'support': 730204}, '2': {'precision': 0.32687378838153186, 'recall': 0.7414788401834757, 'f1-score': 0.4537265899201544, 'support': 121433}, 'accuracy': 0.633101641403706, 'macro avg': {'precision': 0.5368649142501446, 'recall': 0.6647201236564039, 'f1-score': 0.5490127567070988, 'support': 967952}, 'weighted avg': {'precision': 0.7872367891344023, 'recall': 0.633101641403706, 'f1-score': 0.6702048988620105, 'support': 967952}}
[[ 74262  15987  26066]
 [122342 448510 159352]
 [ 15373  16020  90040]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7381036
{'0': {'precision': 0.4263286028145597, 'recall': 0.6062688936551095, 'f1-score': 0.5006205636670432, 'support': 59213}, '1': {'precision': 0.9188927498906414, 'recall': 0.6411419753086419, 'f1-score': 0.7552917935034006, 'support': 291600}, '2': {'precision': 0.37586003538431295, 'recall': 0.7785676716605304, 'f1-score': 0.506974097786518, 'support': 58939}, 'accuracy': 0.6558698920322537, 'macro avg': {'precision': 0.5736937960298379, 'recall': 0.675326180208094, 'f1-score': 0.5876288183189873, 'support': 409752}, 'weighted avg': {'precision': 0.7696024328181084, 'recall': 0.6558698920322537, 'f1-score': 0.6827712342378995, 'support': 409752}}
[[ 35899   9469  13845]
 [ 42288 186957  62355]
 [  6018   7033  45888]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69835603
{'0': {'precision': 0.41281371148745155, 'recall': 0.5912331969608416, 'f1-score': 0.48617085185630177, 'support': 17110}, '1': {'precision': 0.9276690082534256, 'recall': 0.6803996473699677, 'f1-score': 0.7850232810451608, 'support': 102090}, '2': {'precision': 0.35978246091094496, 'recall': 0.7802217242599363, 'f1-score': 0.4924720376677275, 'support': 16958}, 'accuracy': 0.6816272271919388, 'macro avg': {'precision': 0.5667550602172741, 'recall': 0.6839515228635819, 'f1-score': 0.5878887235230633, 'support': 136158}, 'weighted avg': {'precision': 0.7922425610560548, 'recall': 0.6816272271919388, 'f1-score': 0.7110324097881221, 'support': 136158}}
[[10116  3221  3773]
 [12857 69462 19771]
 [ 1532  2195 13231]]
training model: results/EXC/W4/deepLOB_L2/h20
Epoch 1/50
1601/1601 - 68s - loss: 2.7951 - accuracy20: 0.4793 - val_loss: 2.6168 - val_accuracy20: 0.5629 - 68s/epoch - 42ms/step
Epoch 2/50
1601/1601 - 66s - loss: 2.5898 - accuracy20: 0.5295 - val_loss: 2.5844 - val_accuracy20: 0.6152 - 66s/epoch - 41ms/step
Epoch 3/50
1601/1601 - 66s - loss: 2.4556 - accuracy20: 0.5789 - val_loss: 2.4611 - val_accuracy20: 0.6314 - 66s/epoch - 41ms/step
Epoch 4/50
1601/1601 - 66s - loss: 2.3461 - accuracy20: 0.6105 - val_loss: 2.3327 - val_accuracy20: 0.6643 - 66s/epoch - 41ms/step
Epoch 5/50
1601/1601 - 67s - loss: 2.2769 - accuracy20: 0.6292 - val_loss: 2.2791 - val_accuracy20: 0.6605 - 67s/epoch - 42ms/step
Epoch 6/50
1601/1601 - 66s - loss: 2.2430 - accuracy20: 0.6347 - val_loss: 2.2634 - val_accuracy20: 0.6473 - 66s/epoch - 41ms/step
Epoch 7/50
1601/1601 - 66s - loss: 2.2165 - accuracy20: 0.6364 - val_loss: 2.2481 - val_accuracy20: 0.6545 - 66s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 67s - loss: 2.1944 - accuracy20: 0.6393 - val_loss: 2.2234 - val_accuracy20: 0.6594 - 67s/epoch - 42ms/step
Epoch 9/50
1601/1601 - 66s - loss: 2.1766 - accuracy20: 0.6399 - val_loss: 2.2061 - val_accuracy20: 0.6637 - 66s/epoch - 41ms/step
Epoch 10/50
1601/1601 - 66s - loss: 2.1638 - accuracy20: 0.6412 - val_loss: 2.2226 - val_accuracy20: 0.6707 - 66s/epoch - 41ms/step
Epoch 11/50
1601/1601 - 66s - loss: 2.1528 - accuracy20: 0.6425 - val_loss: 2.1820 - val_accuracy20: 0.6737 - 66s/epoch - 41ms/step
Epoch 12/50
1601/1601 - 66s - loss: 2.1400 - accuracy20: 0.6447 - val_loss: 2.1784 - val_accuracy20: 0.6732 - 66s/epoch - 41ms/step
Epoch 13/50
1601/1601 - 66s - loss: 2.1314 - accuracy20: 0.6455 - val_loss: 2.2156 - val_accuracy20: 0.6784 - 66s/epoch - 41ms/step
Epoch 14/50
1601/1601 - 66s - loss: 2.1218 - accuracy20: 0.6466 - val_loss: 2.1912 - val_accuracy20: 0.6787 - 66s/epoch - 41ms/step
Epoch 15/50
1601/1601 - 66s - loss: 2.1143 - accuracy20: 0.6476 - val_loss: 2.1911 - val_accuracy20: 0.6798 - 66s/epoch - 41ms/step
Epoch 16/50
1601/1601 - 66s - loss: 2.1066 - accuracy20: 0.6489 - val_loss: 2.2088 - val_accuracy20: 0.6771 - 66s/epoch - 41ms/step
Epoch 17/50
1601/1601 - 66s - loss: 2.0990 - accuracy20: 0.6496 - val_loss: 2.2422 - val_accuracy20: 0.6769 - 66s/epoch - 41ms/step
Epoch 18/50
1601/1601 - 66s - loss: 2.0944 - accuracy20: 0.6498 - val_loss: 2.1873 - val_accuracy20: 0.6799 - 66s/epoch - 41ms/step
Epoch 19/50
1601/1601 - 65s - loss: 2.0864 - accuracy20: 0.6511 - val_loss: 2.2341 - val_accuracy20: 0.6725 - 65s/epoch - 41ms/step
Epoch 20/50
1601/1601 - 66s - loss: 2.0815 - accuracy20: 0.6517 - val_loss: 2.2064 - val_accuracy20: 0.6733 - 66s/epoch - 41ms/step
Epoch 21/50
1601/1601 - 66s - loss: 2.0751 - accuracy20: 0.6528 - val_loss: 2.2309 - val_accuracy20: 0.6683 - 66s/epoch - 41ms/step
Epoch 22/50
1601/1601 - 66s - loss: 2.0712 - accuracy20: 0.6532 - val_loss: 2.2157 - val_accuracy20: 0.6634 - 66s/epoch - 41ms/step
testing model: results/EXC/W4/deepLOB_L2/h20
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8602502
{'0': {'precision': 0.4514678437880906, 'recall': 0.4242943959407946, 'f1-score': 0.4374595463856989, 'support': 154513}, '1': {'precision': 0.8590318261752768, 'recall': 0.6295983561424717, 'f1-score': 0.726634502052003, 'support': 650178}, '2': {'precision': 0.35540548737337996, 'recall': 0.7536766282210693, 'f1-score': 0.4830315187821164, 'support': 163261}, 'accuracy': 0.6177537729143594, 'macro avg': {'precision': 0.5553017191122492, 'recall': 0.6025231267681118, 'f1-score': 0.5490418557399394, 'support': 967952}, 'weighted avg': {'precision': 0.7090280312456442, 'recall': 0.6177537729143594, 'f1-score': 0.6393862122850593, 'support': 967952}}
[[ 65559  38256  50698]
 [ 68358 409351 172469]
 [ 11296  28919 123046]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7724262
{'0': {'precision': 0.5334430886435535, 'recall': 0.4231483259714487, 'f1-score': 0.47193722735093996, 'support': 78105}, '1': {'precision': 0.8266129226907388, 'recall': 0.6743844420989619, 'f1-score': 0.7427793116461456, 'support': 253916}, '2': {'precision': 0.4118073676950534, 'recall': 0.7450952644376118, 'f1-score': 0.5304434634476948, 'support': 77731}, 'accuracy': 0.6399090181378004, 'macro avg': {'precision': 0.5906211263431153, 'recall': 0.6142093441693408, 'f1-score': 0.5817200008149267, 'support': 409752}, 'weighted avg': {'precision': 0.692040594834804, 'recall': 0.6399090181378004, 'f1-score': 0.6508720145244944, 'support': 409752}}
[[ 33050  21472  23583]
 [ 23538 171237  59141]
 [  5368  14446  57917]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7171177
{'0': {'precision': 0.5192135390741662, 'recall': 0.4544108037464605, 'f1-score': 0.48465559298408645, 'support': 22955}, '1': {'precision': 0.8548308059068935, 'recall': 0.7130988156266572, 'f1-score': 0.7775589246884355, 'support': 90512}, '2': {'precision': 0.4104232921628085, 'recall': 0.7336829580009695, 'f1-score': 0.5263856831188541, 'support': 22691}, 'accuracy': 0.6729167584717755, 'macro avg': {'precision': 0.5948225457146227, 'recall': 0.6337308591246957, 'f1-score': 0.5962000669304587, 'support': 136158}, 'weighted avg': {'precision': 0.7241873971133427, 'recall': 0.6729167584717755, 'f1-score': 0.6863195703814635, 'support': 136158}}
[[10431  6522  6002]
 [ 8055 64544 17913]
 [ 1604  4439 16648]]
training model: results/EXC/W4/deepLOB_L2/h30
Epoch 1/50
1601/1601 - 69s - loss: 2.8601 - accuracy30: 0.4844 - val_loss: 2.8224 - val_accuracy30: 0.4424 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 66s - loss: 2.6954 - accuracy30: 0.5231 - val_loss: 2.7156 - val_accuracy30: 0.5216 - 66s/epoch - 41ms/step
Epoch 3/50
1601/1601 - 66s - loss: 2.6114 - accuracy30: 0.5538 - val_loss: 2.6023 - val_accuracy30: 0.5943 - 66s/epoch - 41ms/step
Epoch 4/50
1601/1601 - 66s - loss: 2.4995 - accuracy30: 0.5859 - val_loss: 2.4452 - val_accuracy30: 0.6131 - 66s/epoch - 41ms/step
Epoch 5/50
1601/1601 - 66s - loss: 2.4128 - accuracy30: 0.6044 - val_loss: 2.4088 - val_accuracy30: 0.6116 - 66s/epoch - 42ms/step
Epoch 6/50
1601/1601 - 66s - loss: 2.3713 - accuracy30: 0.6118 - val_loss: 2.3606 - val_accuracy30: 0.6300 - 66s/epoch - 41ms/step
Epoch 7/50
1601/1601 - 67s - loss: 2.3434 - accuracy30: 0.6166 - val_loss: 2.3442 - val_accuracy30: 0.6312 - 67s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 66s - loss: 2.3237 - accuracy30: 0.6192 - val_loss: 2.3455 - val_accuracy30: 0.6327 - 66s/epoch - 41ms/step
Epoch 9/50
1601/1601 - 67s - loss: 2.3065 - accuracy30: 0.6217 - val_loss: 2.3297 - val_accuracy30: 0.6343 - 67s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 68s - loss: 2.2933 - accuracy30: 0.6236 - val_loss: 2.3128 - val_accuracy30: 0.6366 - 68s/epoch - 42ms/step
Epoch 11/50
1601/1601 - 66s - loss: 2.2830 - accuracy30: 0.6246 - val_loss: 2.3091 - val_accuracy30: 0.6392 - 66s/epoch - 41ms/step
Epoch 12/50
1601/1601 - 66s - loss: 2.2753 - accuracy30: 0.6264 - val_loss: 2.2946 - val_accuracy30: 0.6400 - 66s/epoch - 41ms/step
Epoch 13/50
1601/1601 - 66s - loss: 2.2678 - accuracy30: 0.6270 - val_loss: 2.3101 - val_accuracy30: 0.6400 - 66s/epoch - 41ms/step
Epoch 14/50
1601/1601 - 67s - loss: 2.2600 - accuracy30: 0.6282 - val_loss: 2.3156 - val_accuracy30: 0.6328 - 67s/epoch - 42ms/step
Epoch 15/50
1601/1601 - 66s - loss: 2.2539 - accuracy30: 0.6288 - val_loss: 2.3372 - val_accuracy30: 0.6276 - 66s/epoch - 41ms/step
Epoch 16/50
1601/1601 - 67s - loss: 2.2480 - accuracy30: 0.6291 - val_loss: 2.3359 - val_accuracy30: 0.6257 - 67s/epoch - 42ms/step
Epoch 17/50
1601/1601 - 67s - loss: 2.2428 - accuracy30: 0.6312 - val_loss: 2.3395 - val_accuracy30: 0.6338 - 67s/epoch - 42ms/step
Epoch 18/50
1601/1601 - 66s - loss: 2.2369 - accuracy30: 0.6320 - val_loss: 2.3550 - val_accuracy30: 0.6299 - 66s/epoch - 41ms/step
Epoch 19/50
1601/1601 - 65s - loss: 2.2326 - accuracy30: 0.6331 - val_loss: 2.4139 - val_accuracy30: 0.6183 - 65s/epoch - 41ms/step
Epoch 20/50
1601/1601 - 66s - loss: 2.2276 - accuracy30: 0.6331 - val_loss: 2.3980 - val_accuracy30: 0.6235 - 66s/epoch - 41ms/step
Epoch 21/50
1601/1601 - 66s - loss: 2.2230 - accuracy30: 0.6342 - val_loss: 2.3741 - val_accuracy30: 0.6272 - 66s/epoch - 41ms/step
Epoch 22/50
1601/1601 - 65s - loss: 2.2178 - accuracy30: 0.6349 - val_loss: 2.4161 - val_accuracy30: 0.6214 - 65s/epoch - 41ms/step
testing model: results/EXC/W4/deepLOB_L2/h30
Evaluating performance on  test set...
3782/3782 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91327155
{'0': {'precision': 0.4152313001101603, 'recall': 0.6271465641200809, 'f1-score': 0.49964776136435957, 'support': 181511}, '1': {'precision': 0.8349350396240451, 'recall': 0.5121217376370736, 'f1-score': 0.6348483457033369, 'support': 593933}, '2': {'precision': 0.3948960113138719, 'recall': 0.6759251563571385, 'f1-score': 0.49853356704309265, 'support': 192508}, 'accuracy': 0.5662687819230706, 'macro avg': {'precision': 0.5483541170160258, 'recall': 0.6050644860380976, 'f1-score': 0.5443432247035963, 'support': 967952}, 'weighted avg': {'precision': 0.6687161788490898, 'recall': 0.5662687819230706, 'f1-score': 0.5823849191343765, 'support': 967952}}
[[113834  31319  36358]
 [126739 304166 163028]
 [ 33573  28814 130121]]
Evaluating performance on  train set...
1601/1601 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84278846
{'0': {'precision': 0.48686855764310255, 'recall': 0.5825770332626238, 'f1-score': 0.5304401501349023, 'support': 91454}, '1': {'precision': 0.7817043723978992, 'recall': 0.5942074915269158, 'f1-score': 0.6751807385586428, 'support': 227190}, '2': {'precision': 0.46029320733723544, 'recall': 0.6447732361592835, 'f1-score': 0.5371346539813744, 'support': 91108}, 'accuracy': 0.602854897596595, 'macro avg': {'precision': 0.5762887124594124, 'recall': 0.6071859203162743, 'f1-score': 0.5809185142249732, 'support': 409752}, 'weighted avg': {'precision': 0.6444334303916804, 'recall': 0.602854897596595, 'f1-score': 0.6121811474709347, 'support': 409752}}
[[ 53279  21165  17010]
 [ 40323 134998  51869]
 [ 15830  16534  58744]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77661926
{'0': {'precision': 0.49315610673175236, 'recall': 0.5505154639175258, 'f1-score': 0.5202595730614659, 'support': 27160}, '1': {'precision': 0.805071804058618, 'recall': 0.6676123910184599, 'f1-score': 0.7299269101220828, 'support': 82124}, '2': {'precision': 0.4592574926464743, 'recall': 0.6448984148247376, 'f1-score': 0.5364721177508475, 'support': 26874}, 'accuracy': 0.6397714420012045, 'macro avg': {'precision': 0.5858284678122816, 'recall': 0.6210087565869078, 'f1-score': 0.595552866978132, 'support': 136158}, 'weighted avg': {'precision': 0.6745980592600191, 'recall': 0.6397714420012045, 'f1-score': 0.6499208218661527, 'support': 136158}}
[[14952  7662  4546]
 [11437 54827 15860]
 [ 3930  5613 17331]]
training model: results/EXC/W4/deepLOB_L2/h50
Epoch 1/50
1601/1601 - 70s - loss: 2.9868 - accuracy50: 0.4785 - val_loss: 2.9479 - val_accuracy50: 0.5184 - 70s/epoch - 44ms/step
Epoch 2/50
1601/1601 - 68s - loss: 2.8281 - accuracy50: 0.5202 - val_loss: 2.7986 - val_accuracy50: 0.5497 - 68s/epoch - 43ms/step
Epoch 3/50
1601/1601 - 67s - loss: 2.7713 - accuracy50: 0.5376 - val_loss: 2.7723 - val_accuracy50: 0.5609 - 67s/epoch - 42ms/step
Epoch 4/50
1601/1601 - 67s - loss: 2.7116 - accuracy50: 0.5525 - val_loss: 2.7518 - val_accuracy50: 0.5566 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 67s - loss: 2.6526 - accuracy50: 0.5670 - val_loss: 2.7064 - val_accuracy50: 0.5757 - 67s/epoch - 42ms/step
Epoch 6/50
1601/1601 - 68s - loss: 2.6184 - accuracy50: 0.5735 - val_loss: 2.6854 - val_accuracy50: 0.5756 - 68s/epoch - 42ms/step
Epoch 7/50
1601/1601 - 67s - loss: 2.5939 - accuracy50: 0.5781 - val_loss: 2.6517 - val_accuracy50: 0.5822 - 67s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 67s - loss: 2.5759 - accuracy50: 0.5809 - val_loss: 2.6515 - val_accuracy50: 0.5781 - 67s/epoch - 42ms/step
Epoch 9/50
1601/1601 - 67s - loss: 2.5620 - accuracy50: 0.5828 - val_loss: 2.6249 - val_accuracy50: 0.5780 - 67s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 67s - loss: 2.5493 - accuracy50: 0.5852 - val_loss: 2.6325 - val_accuracy50: 0.5783 - 67s/epoch - 42ms/step
Epoch 11/50
1601/1601 - 67s - loss: 2.5403 - accuracy50: 0.5869 - val_loss: 2.6402 - val_accuracy50: 0.5757 - 67s/epoch - 42ms/step
Epoch 12/50
1601/1601 - 67s - loss: 2.5319 - accuracy50: 0.5882 - val_loss: 2.6457 - val_accuracy50: 0.5769 - 67s/epoch - 42ms/step
Epoch 13/50
1601/1601 - 67s - loss: 2.5241 - accuracy50: 0.5900 - val_loss: 2.6137 - val_accuracy50: 0.5790 - 67s/epoch - 42ms/step
Epoch 14/50
1601/1601 - 67s - loss: 2.5163 - accuracy50: 0.5909 - val_loss: 2.6505 - val_accuracy50: 0.5726 - 67s/epoch - 42ms/step
Epoch 15/50
1601/1601 - 67s - loss: 2.5095 - accuracy50: 0.5927 - val_loss: 2.6668 - val_accuracy50: 0.5689 - 67s/epoch - 42ms/step
Epoch 16/50
1601/1601 - 66s - loss: 2.5031 - accuracy50: 0.5930 - val_loss: 2.6824 - val_accuracy50: 0.5647 - 66s/epoch - 41ms/step
Epoch 17/50
1601/1601 - 66s - loss: 2.4955 - accuracy50: 0.5950 - val_loss: 2.6739 - val_accuracy50: 0.5630 - 66s/epoch - 41ms/step
Epoch 18/50
1601/1601 - 66s - loss: 2.4899 - accuracy50: 0.5957 - val_loss: 2.6615 - val_accuracy50: 0.5694 - 66s/epoch - 42ms/step
Epoch 19/50
1601/1601 - 66s - loss: 2.4852 - accuracy50: 0.5968 - val_loss: 2.6299 - val_accuracy50: 0.5742 - 66s/epoch - 41ms/step
Epoch 20/50
1601/1601 - 67s - loss: 2.4792 - accuracy50: 0.5975 - val_loss: 2.6919 - val_accuracy50: 0.5630 - 67s/epoch - 42ms/step
Epoch 21/50
1601/1601 - 67s - loss: 2.4730 - accuracy50: 0.5992 - val_loss: 2.6780 - val_accuracy50: 0.5690 - 67s/epoch - 42ms/step
Epoch 22/50
1601/1601 - 67s - loss: 2.4667 - accuracy50: 0.5997 - val_loss: 2.6914 - val_accuracy50: 0.5704 - 67s/epoch - 42ms/step
Epoch 23/50
1601/1601 - 67s - loss: 2.4618 - accuracy50: 0.6012 - val_loss: 2.6791 - val_accuracy50: 0.5714 - 67s/epoch - 42ms/step
testing model: results/EXC/W4/deepLOB_L2/h50
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9761161
{'0': {'precision': 0.41210381541493324, 'recall': 0.5416855918369182, 'f1-score': 0.46809221711632065, 'support': 222367}, '1': {'precision': 0.7250713624440672, 'recall': 0.4441165062307167, 'f1-score': 0.5508373271467384, 'support': 507887}, '2': {'precision': 0.43083472307557275, 'recall': 0.6608048868732593, 'f1-score': 0.5215964826640366, 'support': 237698}, 'accuracy': 0.5197427145147693, 'macro avg': {'precision': 0.522669966978191, 'recall': 0.5488689949802982, 'f1-score': 0.5135086756423651, 'support': 967952}, 'weighted avg': {'precision': 0.5809184341636981, 'recall': 0.5197427145147693, 'f1-score': 0.5246477308299963, 'support': 967952}}
[[120453  45742  56172]
 [130994 225561 151332]
 [ 40841  39785 157072]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9362185
{'0': {'precision': 0.5038550719173563, 'recall': 0.4806200156442462, 'f1-score': 0.4919633530740807, 'support': 111223}, '1': {'precision': 0.6603151583512935, 'recall': 0.5250238894731504, 'f1-score': 0.5849486412380822, 'support': 187321}, '2': {'precision': 0.46033079752063444, 'recall': 0.6404305445651391, 'f1-score': 0.5356472689668139, 'support': 111208}, 'accuracy': 0.5442926453074055, 'macro avg': {'precision': 0.5415003425964281, 'recall': 0.5486914832275119, 'f1-score': 0.5375197544263256, 'support': 409752}, 'weighted avg': {'precision': 0.5635692706126181, 'recall': 0.5442926453074055, 'f1-score': 0.5463281837100947, 'support': 409752}}
[[53456 28975 28792]
 [34269 98348 54704]
 [18369 21618 71221]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87550807
{'0': {'precision': 0.5549596757686167, 'recall': 0.40137383786344527, 'f1-score': 0.46583392037937493, 'support': 33774}, '1': {'precision': 0.6841601406173983, 'recall': 0.6307002314814815, 'f1-score': 0.6563433931300297, 'support': 69120}, '2': {'precision': 0.4505748562859285, 'recall': 0.6503427128427128, 'f1-score': 0.5323342684187213, 'support': 33264}, 'accuracy': 0.5786145507425198, 'macro avg': {'precision': 0.5632315575573145, 'recall': 0.5608055940625466, 'f1-score': 0.5515038606427086, 'support': 136158}, 'weighted avg': {'precision': 0.5950460423065773, 'recall': 0.5786145507425198, 'f1-score': 0.5787915309032228, 'support': 136158}}
[[13556 12196  8022]
 [ 7169 43594 18357]
 [ 3702  7929 21633]]
training model: results/EXC/W4/deepLOB_L2/h100
Epoch 1/50
1601/1601 - 69s - loss: 3.1414 - accuracy100: 0.4465 - val_loss: 3.1824 - val_accuracy100: 0.4408 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 67s - loss: 3.0544 - accuracy100: 0.4733 - val_loss: 3.1741 - val_accuracy100: 0.4359 - 67s/epoch - 42ms/step
Epoch 3/50
1601/1601 - 66s - loss: 3.0257 - accuracy100: 0.4821 - val_loss: 3.1189 - val_accuracy100: 0.4565 - 66s/epoch - 41ms/step
Epoch 4/50
1601/1601 - 67s - loss: 2.9981 - accuracy100: 0.4894 - val_loss: 3.1112 - val_accuracy100: 0.4588 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 66s - loss: 2.9726 - accuracy100: 0.4958 - val_loss: 3.1173 - val_accuracy100: 0.4559 - 66s/epoch - 41ms/step
Epoch 6/50
1601/1601 - 67s - loss: 2.9507 - accuracy100: 0.5007 - val_loss: 3.1399 - val_accuracy100: 0.4526 - 67s/epoch - 42ms/step
Epoch 7/50
1601/1601 - 67s - loss: 2.9296 - accuracy100: 0.5057 - val_loss: 3.1174 - val_accuracy100: 0.4606 - 67s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 66s - loss: 2.9136 - accuracy100: 0.5088 - val_loss: 3.1317 - val_accuracy100: 0.4599 - 66s/epoch - 41ms/step
Epoch 9/50
1601/1601 - 67s - loss: 2.8978 - accuracy100: 0.5124 - val_loss: 3.1622 - val_accuracy100: 0.4593 - 67s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 66s - loss: 2.8864 - accuracy100: 0.5149 - val_loss: 3.1436 - val_accuracy100: 0.4599 - 66s/epoch - 41ms/step
Epoch 11/50
1601/1601 - 66s - loss: 2.8768 - accuracy100: 0.5179 - val_loss: 3.1612 - val_accuracy100: 0.4579 - 66s/epoch - 41ms/step
Epoch 12/50
1601/1601 - 67s - loss: 2.8667 - accuracy100: 0.5204 - val_loss: 3.1565 - val_accuracy100: 0.4617 - 67s/epoch - 42ms/step
Epoch 13/50
1601/1601 - 66s - loss: 2.8568 - accuracy100: 0.5225 - val_loss: 3.1615 - val_accuracy100: 0.4626 - 66s/epoch - 41ms/step
Epoch 14/50
1601/1601 - 66s - loss: 2.8480 - accuracy100: 0.5248 - val_loss: 3.2059 - val_accuracy100: 0.4555 - 66s/epoch - 41ms/step
testing model: results/EXC/W4/deepLOB_L2/h100
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0422539
{'0': {'precision': 0.4278023519608896, 'recall': 0.45646028394410026, 'f1-score': 0.4416669326939717, 'support': 287944}, '1': {'precision': 0.4723109839980374, 'recall': 0.41696137291992214, 'f1-score': 0.44291365811823946, 'support': 364770}, '2': {'precision': 0.445913149254789, 'recall': 0.4790951598474803, 'f1-score': 0.46190899999082474, 'support': 315238}, 'accuracy': 0.44894684860406303, 'macro avg': {'precision': 0.44867549507123866, 'recall': 0.45083893890383425, 'f1-score': 0.44882986360101196, 'support': 967952}, 'weighted avg': {'precision': 0.45047354353394764, 'recall': 0.44894684860406303, 'f1-score': 0.44872909780498493, 'support': 967952}}
[[131435  81628  74881]
 [ 99889 152095 112786]
 [ 75909  88300 151029]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0533748
{'0': {'precision': 0.4798200091268957, 'recall': 0.3289628778067201, 'f1-score': 0.3903222325340471, 'support': 137438}, '1': {'precision': 0.41776909491988123, 'recall': 0.48089596473330304, 'f1-score': 0.44711535132964547, 'support': 134291}, '2': {'precision': 0.4439549651427222, 'recall': 0.5176745904668063, 'f1-score': 0.47798906226481364, 'support': 138023}, 'accuracy': 0.44232364942697044, 'macro avg': {'precision': 0.4471813563964997, 'recall': 0.4425111443356098, 'f1-score': 0.43847554870950206, 'support': 409752}, 'weighted avg': {'precision': 0.44740264378004746, 'recall': 0.44232364942697044, 'f1-score': 0.43846560597971496, 'support': 409752}}
[[45212 47994 44232]
 [24452 64580 45259]
 [24563 42009 71451]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0367179
{'0': {'precision': 0.5234803219594094, 'recall': 0.24213146955369785, 'f1-score': 0.3311105211375384, 'support': 43782}, '1': {'precision': 0.45564245810055864, 'recall': 0.5741351568785197, 'f1-score': 0.5080715493459108, 'support': 49720}, '2': {'precision': 0.44193251591340105, 'recall': 0.5517629407351838, 'f1-score': 0.4907781009873531, 'support': 42656}, 'accuracy': 0.4603695706458673, 'macro avg': {'precision': 0.4736850986577897, 'recall': 0.45600985572246716, 'f1-score': 0.44332005715693407, 'support': 136158}, 'weighted avg': {'precision': 0.4731608269186436, 'recall': 0.4603695706458673, 'f1-score': 0.4457514721546947, 'support': 136158}}
[[10601 19688 13493]
 [ 4946 28546 16228]
 [ 4704 14416 23536]]
training model: results/EXC/W4/deepLOB_L2/h200
Epoch 1/50
1601/1601 - 68s - loss: 3.2578 - accuracy200: 0.3949 - val_loss: 3.2536 - val_accuracy200: 0.3877 - 68s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 66s - loss: 3.2071 - accuracy200: 0.4189 - val_loss: 3.3556 - val_accuracy200: 0.3755 - 66s/epoch - 41ms/step
Epoch 3/50
1601/1601 - 66s - loss: 3.1890 - accuracy200: 0.4275 - val_loss: 3.3817 - val_accuracy200: 0.3739 - 66s/epoch - 41ms/step
Epoch 4/50
1601/1601 - 67s - loss: 3.1783 - accuracy200: 0.4318 - val_loss: 3.4435 - val_accuracy200: 0.3702 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 66s - loss: 3.1658 - accuracy200: 0.4381 - val_loss: 3.4139 - val_accuracy200: 0.3718 - 66s/epoch - 41ms/step
Epoch 6/50
1601/1601 - 67s - loss: 3.1558 - accuracy200: 0.4425 - val_loss: 3.3848 - val_accuracy200: 0.3778 - 67s/epoch - 42ms/step
Epoch 7/50
1601/1601 - 66s - loss: 3.1464 - accuracy200: 0.4466 - val_loss: 3.3369 - val_accuracy200: 0.3822 - 66s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 66s - loss: 3.1391 - accuracy200: 0.4490 - val_loss: 3.3775 - val_accuracy200: 0.3766 - 66s/epoch - 41ms/step
Epoch 9/50
1601/1601 - 67s - loss: 3.1276 - accuracy200: 0.4539 - val_loss: 3.2947 - val_accuracy200: 0.3886 - 67s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 67s - loss: 3.1192 - accuracy200: 0.4561 - val_loss: 3.3105 - val_accuracy200: 0.3894 - 67s/epoch - 42ms/step
Epoch 11/50
1601/1601 - 67s - loss: 3.1102 - accuracy200: 0.4589 - val_loss: 3.2983 - val_accuracy200: 0.3919 - 67s/epoch - 42ms/step
testing model: results/EXC/W4/deepLOB_L2/h200
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029751
{'0': {'precision': 0.37972131320595376, 'recall': 0.33840726280634087, 'f1-score': 0.3578758860838204, 'support': 318885}, '1': {'precision': 0.3139115951190084, 'recall': 0.43919670990022763, 'f1-score': 0.36613310159228524, 'support': 297377}, '2': {'precision': 0.41626976566965135, 'recall': 0.31685575364667745, 'f1-score': 0.35982234104900146, 'support': 351690}, 'accuracy': 0.3615416880175876, 'macro avg': {'precision': 0.36996755799820447, 'recall': 0.3648199087844153, 'f1-score': 0.3612771095750357, 'support': 967952}, 'weighted avg': {'precision': 0.37278236242266727, 'recall': 0.3615416880175876, 'f1-score': 0.36111990512915043, 'support': 967952}}
[[107913 138208  72764]
 [ 83270 130607  83500]
 [ 93007 147248 111435]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094348
{'0': {'precision': 0.3898863057865264, 'recall': 0.25220267540906827, 'f1-score': 0.30628268761636457, 'support': 136652}, '1': {'precision': 0.33832154467972936, 'recall': 0.4543389603014816, 'f1-score': 0.3878398327945532, 'support': 135597}, '2': {'precision': 0.3969237618572321, 'recall': 0.4019985018508687, 'f1-score': 0.3994450145250105, 'support': 137503}, 'accuracy': 0.36936244362443627, 'macro avg': {'precision': 0.3750438707744959, 'recall': 0.3695133791871395, 'f1-score': 0.36452251164530947, 'support': 409752}, 'weighted avg': {'precision': 0.37518386238244755, 'recall': 0.36936244362443627, 'f1-score': 0.36453500524177307, 'support': 409752}}
[[34464 64104 38084]
 [28089 61607 45901]
 [25842 56385 55276]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0845107
{'0': {'precision': 0.415688318057812, 'recall': 0.2961175648528256, 'f1-score': 0.3458600594243742, 'support': 45796}, '1': {'precision': 0.35647306977424137, 'recall': 0.3717035778837569, 'f1-score': 0.36392904353758904, 'support': 45921}, '2': {'precision': 0.3967871774599296, 'recall': 0.4968835084719066, 'f1-score': 0.4412296564195299, 'support': 44441}, 'accuracy': 0.38713847148166103, 'macro avg': {'precision': 0.3896495217639943, 'recall': 0.38823488373616305, 'f1-score': 0.38367291979383106, 'support': 136158}, 'weighted avg': {'precision': 0.38954803246504227, 'recall': 0.38713847148166103, 'f1-score': 0.3830820080393998, 'support': 136158}}
[[13561 17373 14862]
 [10144 17069 18708]
 [ 8918 13441 22082]]
training model: results/EXC/W4/deepLOB_L2/h300
Epoch 1/50
1601/1601 - 69s - loss: 3.2803 - accuracy300: 0.3797 - val_loss: 3.3624 - val_accuracy300: 0.3489 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 67s - loss: 3.2380 - accuracy300: 0.4033 - val_loss: 3.3749 - val_accuracy300: 0.3438 - 67s/epoch - 42ms/step
Epoch 3/50
1601/1601 - 67s - loss: 3.2182 - accuracy300: 0.4143 - val_loss: 3.4213 - val_accuracy300: 0.3340 - 67s/epoch - 42ms/step
Epoch 4/50
1601/1601 - 67s - loss: 3.2064 - accuracy300: 0.4221 - val_loss: 3.4082 - val_accuracy300: 0.3396 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 67s - loss: 3.1947 - accuracy300: 0.4274 - val_loss: 3.4004 - val_accuracy300: 0.3408 - 67s/epoch - 42ms/step
Epoch 6/50
1601/1601 - 67s - loss: 3.1837 - accuracy300: 0.4328 - val_loss: 3.4056 - val_accuracy300: 0.3485 - 67s/epoch - 42ms/step
Epoch 7/50
1601/1601 - 67s - loss: 3.1765 - accuracy300: 0.4358 - val_loss: 3.4232 - val_accuracy300: 0.3535 - 67s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 67s - loss: 3.1682 - accuracy300: 0.4389 - val_loss: 3.4050 - val_accuracy300: 0.3565 - 67s/epoch - 42ms/step
Epoch 9/50
1601/1601 - 68s - loss: 3.1583 - accuracy300: 0.4437 - val_loss: 3.4017 - val_accuracy300: 0.3471 - 68s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 68s - loss: 3.1493 - accuracy300: 0.4472 - val_loss: 3.3940 - val_accuracy300: 0.3507 - 68s/epoch - 42ms/step
Epoch 11/50
1601/1601 - 67s - loss: 3.1381 - accuracy300: 0.4505 - val_loss: 3.4320 - val_accuracy300: 0.3582 - 67s/epoch - 42ms/step
testing model: results/EXC/W4/deepLOB_L2/h300
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311986
{'0': {'precision': 0.3315064089268677, 'recall': 0.6199082737823974, 'f1-score': 0.4319957836270943, 'support': 309399}, '1': {'precision': 0.32678150147044566, 'recall': 0.15993749031194737, 'f1-score': 0.21476299099879784, 'support': 316111}, '2': {'precision': 0.36984433393417965, 'recall': 0.2534472991046659, 'f1-score': 0.3007774934111462, 'support': 342442}, 'accuracy': 0.34004578739441627, 'macro avg': {'precision': 0.3427107481104977, 'recall': 0.3444310210663369, 'f1-score': 0.3158454226790128, 'support': 967952}, 'weighted avg': {'precision': 0.3435265509322532, 'recall': 0.34004578739441627, 'f1-score': 0.31463011978358435, 'support': 967952}}
[[191799  48641  68959]
 [186634  50558  78919]
 [200135  55516  86791]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227056
{'0': {'precision': 0.3580502638798603, 'recall': 0.47326876865943346, 'f1-score': 0.4076750341851392, 'support': 137330}, '1': {'precision': 0.33320020448590965, 'recall': 0.15439222450052187, 'f1-score': 0.21101033451870888, 'support': 135091}, '2': {'precision': 0.35082169119866696, 'recall': 0.4231236938491673, 'f1-score': 0.3835954648226693, 'support': 137331}, 'accuracy': 0.35133202522501417, 'macro avg': {'precision': 0.34735738652147896, 'recall': 0.35026156233637423, 'f1-score': 0.3340936111755058, 'support': 409752}, 'weighted avg': {'precision': 0.3474347537945669, 'recall': 0.35133202522501417, 'f1-score': 0.3347662935743427, 'support': 409752}}
[[64994 20833 51503]
 [58211 20857 56023]
 [58317 20906 58108]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209358
{'0': {'precision': 0.36719499781881637, 'recall': 0.27345577406220223, 'f1-score': 0.3134674826520352, 'support': 46172}, '1': {'precision': 0.3456649923564097, 'recall': 0.1726289154524038, 'f1-score': 0.23026229651289662, 'support': 45844}, '2': {'precision': 0.3394102284540683, 'recall': 0.6064972135381269, 'f1-score': 0.4352463014144042, 'support': 44142}, 'accuracy': 0.3474786644927217, 'macro avg': {'precision': 0.3507567395430981, 'recall': 0.350860634350911, 'f1-score': 0.326325360193112, 'support': 136158}, 'weighted avg': {'precision': 0.35093817222122176, 'recall': 0.3474786644927217, 'f1-score': 0.32493285423832335, 'support': 136158}}
[[12626  8013 25533]
 [11357  7914 26573]
 [10402  6968 26772]]
training model: results/EXC/W4/deepLOB_L2/h500
Epoch 1/50
1601/1601 - 69s - loss: 3.2638 - accuracy500: 0.3936 - val_loss: 3.3651 - val_accuracy500: 0.3418 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 67s - loss: 3.2347 - accuracy500: 0.4090 - val_loss: 3.4508 - val_accuracy500: 0.3397 - 67s/epoch - 42ms/step
Epoch 3/50
1601/1601 - 67s - loss: 3.2067 - accuracy500: 0.4269 - val_loss: 3.4544 - val_accuracy500: 0.3353 - 67s/epoch - 42ms/step
Epoch 4/50
1601/1601 - 67s - loss: 3.1923 - accuracy500: 0.4338 - val_loss: 3.4865 - val_accuracy500: 0.3365 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 68s - loss: 3.1767 - accuracy500: 0.4402 - val_loss: 3.4572 - val_accuracy500: 0.3394 - 68s/epoch - 42ms/step
Epoch 6/50
1601/1601 - 67s - loss: 3.1603 - accuracy500: 0.4463 - val_loss: 3.4051 - val_accuracy500: 0.3232 - 67s/epoch - 42ms/step
Epoch 7/50
1601/1601 - 68s - loss: 3.1458 - accuracy500: 0.4517 - val_loss: 3.4262 - val_accuracy500: 0.3205 - 68s/epoch - 42ms/step
Epoch 8/50
1601/1601 - 67s - loss: 3.1400 - accuracy500: 0.4545 - val_loss: 3.3832 - val_accuracy500: 0.3335 - 67s/epoch - 42ms/step
Epoch 9/50
1601/1601 - 67s - loss: 3.1286 - accuracy500: 0.4588 - val_loss: 3.3981 - val_accuracy500: 0.3257 - 67s/epoch - 42ms/step
Epoch 10/50
1601/1601 - 68s - loss: 3.1175 - accuracy500: 0.4624 - val_loss: 3.4115 - val_accuracy500: 0.3280 - 68s/epoch - 42ms/step
Epoch 11/50
1601/1601 - 68s - loss: 3.1044 - accuracy500: 0.4666 - val_loss: 3.3945 - val_accuracy500: 0.3206 - 68s/epoch - 42ms/step
testing model: results/EXC/W4/deepLOB_L2/h500
Evaluating performance on  test set...
3782/3782 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125195
{'0': {'precision': 0.34316824178872396, 'recall': 0.5417923428507985, 'f1-score': 0.4201902975971221, 'support': 324246}, '1': {'precision': 0.29451785947926207, 'recall': 0.040325470075670715, 'f1-score': 0.07093807808545974, 'support': 279104}, '2': {'precision': 0.38165569301539665, 'recall': 0.4373618356454435, 'f1-score': 0.4076143150554497, 'support': 364602}, 'accuracy': 0.3578607203662992, 'macro avg': {'precision': 0.3397805980944609, 'recall': 0.3398265495239709, 'f1-score': 0.2995808969126772, 'support': 967952}, 'weighted avg': {'precision': 0.3436373615261151, 'recall': 0.3578607203662992, 'f1-score': 0.31474816837868785, 'support': 967952}}
[[175674  13721 134851]
 [144344  11255 123505]
 [191900  13239 159463]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1207669
{'0': {'precision': 0.3320720602494842, 'recall': 0.3292063285558374, 'f1-score': 0.33063298490127757, 'support': 138357}, '1': {'precision': 0.34031060094530724, 'recall': 0.045266072898735125, 'f1-score': 0.07990381947655599, 'support': 133610}, '2': {'precision': 0.349721564887743, 'recall': 0.6467685161664912, 'f1-score': 0.45397119729395163, 'support': 137785}, 'accuracy': 0.34340527929088815, 'macro avg': {'precision': 0.34070140869417814, 'recall': 0.3404136392070212, 'f1-score': 0.28816933389059507, 'support': 409752}, 'weighted avg': {'precision': 0.3406933443895284, 'recall': 0.34340527929088815, 'f1-score': 0.2903506477854796, 'support': 409752}}
[[45548  5957 86852]
 [48712  6048 78850]
 [42903  5767 89115]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217643
{'0': {'precision': 0.33704374838208645, 'recall': 0.1901602403605408, 'f1-score': 0.24314049807253665, 'support': 47928}, '1': {'precision': 0.3528705260629354, 'recall': 0.034213713433948204, 'f1-score': 0.06237924372067348, 'support': 42936}, '2': {'precision': 0.3421880061741334, 'recall': 0.7929085530092286, 'f1-score': 0.4780629359459028, 'support': 45294}, 'accuracy': 0.34149297140087254, 'macro avg': {'precision': 0.3440340935397184, 'recall': 0.3390941689345725, 'f1-score': 0.26119422591303765, 'support': 136158}, 'weighted avg': {'precision': 0.34374583374569273, 'recall': 0.34149297140087254, 'f1-score': 0.26428807430151074, 'support': 136158}}
[[ 9114  1363 37451]
 [ 9878  1469 31589]
 [ 8049  1331 35914]]
training model: results/EXC/W4/deepLOB_L2/h1000
Epoch 1/50
1601/1601 - 69s - loss: 3.2264 - accuracy1000: 0.4243 - val_loss: 3.4173 - val_accuracy1000: 0.3665 - 69s/epoch - 43ms/step
Epoch 2/50
1601/1601 - 67s - loss: 3.2086 - accuracy1000: 0.4243 - val_loss: 3.3825 - val_accuracy1000: 0.3480 - 67s/epoch - 42ms/step
Epoch 3/50
1601/1601 - 68s - loss: 3.1794 - accuracy1000: 0.4388 - val_loss: 3.3872 - val_accuracy1000: 0.3371 - 68s/epoch - 42ms/step
Epoch 4/50
1601/1601 - 67s - loss: 3.1505 - accuracy1000: 0.4525 - val_loss: 3.4469 - val_accuracy1000: 0.3260 - 67s/epoch - 42ms/step
Epoch 5/50
1601/1601 - 66s - loss: 3.1335 - accuracy1000: 0.4606 - val_loss: 3.3953 - val_accuracy1000: 0.3286 - 66s/epoch - 41ms/step
Epoch 6/50
1601/1601 - 66s - loss: 3.1000 - accuracy1000: 0.4759 - val_loss: 3.4362 - val_accuracy1000: 0.3278 - 66s/epoch - 41ms/step
Epoch 7/50
1601/1601 - 66s - loss: 3.0768 - accuracy1000: 0.4851 - val_loss: 3.4913 - val_accuracy1000: 0.2923 - 66s/epoch - 41ms/step
Epoch 8/50
1601/1601 - 66s - loss: 3.0665 - accuracy1000: 0.4875 - val_loss: 3.4009 - val_accuracy1000: 0.3158 - 66s/epoch - 41ms/step
Epoch 9/50
1601/1601 - 66s - loss: 3.0448 - accuracy1000: 0.4951 - val_loss: 3.3667 - val_accuracy1000: 0.3151 - 66s/epoch - 41ms/step
Epoch 10/50
1601/1601 - 66s - loss: 3.0271 - accuracy1000: 0.5011 - val_loss: 3.3420 - val_accuracy1000: 0.3053 - 66s/epoch - 41ms/step
Epoch 11/50
1601/1601 - 66s - loss: 3.0046 - accuracy1000: 0.5074 - val_loss: 3.3718 - val_accuracy1000: 0.3065 - 66s/epoch - 41ms/step
Epoch 12/50
1601/1601 - 66s - loss: 2.9894 - accuracy1000: 0.5119 - val_loss: 3.3971 - val_accuracy1000: 0.3213 - 66s/epoch - 41ms/step
Epoch 13/50
1601/1601 - 66s - loss: 2.9754 - accuracy1000: 0.5157 - val_loss: 3.3646 - val_accuracy1000: 0.3466 - 66s/epoch - 41ms/step
Epoch 14/50
1601/1601 - 66s - loss: 2.9579 - accuracy1000: 0.5211 - val_loss: 3.3727 - val_accuracy1000: 0.3279 - 66s/epoch - 41ms/step
Epoch 15/50
1601/1601 - 66s - loss: 2.9399 - accuracy1000: 0.5261 - val_loss: 3.3929 - val_accuracy1000: 0.3516 - 66s/epoch - 41ms/step
Epoch 16/50
1601/1601 - 67s - loss: 2.9312 - accuracy1000: 0.5291 - val_loss: 3.4328 - val_accuracy1000: 0.3684 - 67s/epoch - 42ms/step
Epoch 17/50
1601/1601 - 66s - loss: 2.9175 - accuracy1000: 0.5315 - val_loss: 3.4840 - val_accuracy1000: 0.3800 - 66s/epoch - 41ms/step
Epoch 18/50
1601/1601 - 66s - loss: 2.9003 - accuracy1000: 0.5361 - val_loss: 3.3781 - val_accuracy1000: 0.3626 - 66s/epoch - 41ms/step
Epoch 19/50
1601/1601 - 66s - loss: 2.8820 - accuracy1000: 0.5425 - val_loss: 3.5251 - val_accuracy1000: 0.3683 - 66s/epoch - 41ms/step
Epoch 20/50
1601/1601 - 66s - loss: 2.8744 - accuracy1000: 0.5421 - val_loss: 3.4875 - val_accuracy1000: 0.3678 - 66s/epoch - 41ms/step
testing model: results/EXC/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1475242
{'0': {'precision': 0.2950470640968176, 'recall': 0.0074848554624094244, 'f1-score': 0.014599349599807044, 'support': 351777}, '1': {'precision': 0.216494751150863, 'recall': 0.8941466199289498, 'f1-score': 0.3485878610585133, 'support': 211963}, '2': {'precision': 0.4039331084475705, 'recall': 0.08354032042591511, 'f1-score': 0.13844734630286382, 'support': 404212}, 'accuracy': 0.23340723506950758, 'macro avg': {'precision': 0.305158307898417, 'recall': 0.3283905986057581, 'f1-score': 0.1672115189870614, 'support': 967952}, 'weighted avg': {'precision': 0.32331588512321474, 'recall': 0.23340723506950758, 'f1-score': 0.1394547693909307, 'support': 967952}}
[[  2633 320106  29038]
 [  1645 189526  20792]
 [  4646 365798  33768]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1174673
{'0': {'precision': 0.3188572200459273, 'recall': 0.03409008852880436, 'f1-score': 0.061594864702658986, 'support': 138486}, '1': {'precision': 0.3293840934280549, 'recall': 0.8691323113558566, 'f1-score': 0.477721218169882, 'support': 134380}, '2': {'precision': 0.36077595817952085, 'recall': 0.1063804917960931, 'f1-score': 0.1643112231944891, 'support': 136886}, 'accuracy': 0.3320959995314239, 'macro avg': {'precision': 0.3363390905511677, 'recall': 0.336534297226918, 'f1-score': 0.23454243535567668, 'support': 409752}, 'weighted avg': {'precision': 0.3363133633551616, 'recall': 0.3320959995314239, 'f1-score': 0.23237985373855896, 'support': 409752}}
[[  4721 119724  14041]
 [  5826 116794  11760]
 [  4259 118065  14562]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1165142
{'0': {'precision': 0.2398005439709882, 'recall': 0.01058232811218468, 'f1-score': 0.02027014081808602, 'support': 49989}, '1': {'precision': 0.29885451505016725, 'recall': 0.8863512374150672, 'f1-score': 0.44699423483361056, 'support': 40326}, '2': {'precision': 0.3641304347826087, 'recall': 0.11399777501472416, 'f1-score': 0.17363568402691254, 'support': 45843}, 'accuracy': 0.304778272301297, 'macro avg': {'precision': 0.30092849793458804, 'recall': 0.336977113513992, 'f1-score': 0.21363335322620305, 'support': 136158}, 'weighted avg': {'precision': 0.29915119264544066, 'recall': 0.304778272301297, 'f1-score': 0.19828988561892236, 'support': 136158}}
[[  529 43928  5532]
 [  989 35743  3594]
 [  688 39929  5226]]
training model: results/EXC/W4/deepOF_L2/h10
Epoch 1/50
1601/1601 - 39s - loss: 2.5910 - accuracy10: 0.5362 - val_loss: 2.2723 - val_accuracy10: 0.7466 - 39s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 2.1905 - accuracy10: 0.6300 - val_loss: 2.1159 - val_accuracy10: 0.7303 - 36s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 36s - loss: 2.1153 - accuracy10: 0.6411 - val_loss: 2.0847 - val_accuracy10: 0.7370 - 36s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 36s - loss: 2.0818 - accuracy10: 0.6453 - val_loss: 2.0387 - val_accuracy10: 0.7229 - 36s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 36s - loss: 2.0605 - accuracy10: 0.6483 - val_loss: 2.0202 - val_accuracy10: 0.7260 - 36s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 36s - loss: 2.0419 - accuracy10: 0.6508 - val_loss: 2.0161 - val_accuracy10: 0.7265 - 36s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 37s - loss: 2.0295 - accuracy10: 0.6529 - val_loss: 1.9938 - val_accuracy10: 0.7250 - 37s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 36s - loss: 2.0194 - accuracy10: 0.6543 - val_loss: 1.9949 - val_accuracy10: 0.7260 - 36s/epoch - 22ms/step
Epoch 9/50
1601/1601 - 36s - loss: 2.0102 - accuracy10: 0.6552 - val_loss: 1.9729 - val_accuracy10: 0.7220 - 36s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 36s - loss: 2.0008 - accuracy10: 0.6575 - val_loss: 1.9661 - val_accuracy10: 0.7184 - 36s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 36s - loss: 1.9948 - accuracy10: 0.6573 - val_loss: 1.9727 - val_accuracy10: 0.7162 - 36s/epoch - 22ms/step
Epoch 12/50
1601/1601 - 36s - loss: 1.9876 - accuracy10: 0.6581 - val_loss: 1.9724 - val_accuracy10: 0.7221 - 36s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 36s - loss: 1.9820 - accuracy10: 0.6594 - val_loss: 1.9669 - val_accuracy10: 0.7217 - 36s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 36s - loss: 1.9774 - accuracy10: 0.6601 - val_loss: 1.9667 - val_accuracy10: 0.7233 - 36s/epoch - 22ms/step
Epoch 15/50
1601/1601 - 36s - loss: 1.9715 - accuracy10: 0.6609 - val_loss: 1.9702 - val_accuracy10: 0.7212 - 36s/epoch - 22ms/step
Epoch 16/50
1601/1601 - 36s - loss: 1.9665 - accuracy10: 0.6611 - val_loss: 1.9736 - val_accuracy10: 0.7273 - 36s/epoch - 22ms/step
Epoch 17/50
1601/1601 - 36s - loss: 1.9613 - accuracy10: 0.6622 - val_loss: 1.9758 - val_accuracy10: 0.7258 - 36s/epoch - 23ms/step
Epoch 18/50
1601/1601 - 36s - loss: 1.9572 - accuracy10: 0.6630 - val_loss: 1.9716 - val_accuracy10: 0.7257 - 36s/epoch - 23ms/step
Epoch 19/50
1601/1601 - 36s - loss: 1.9522 - accuracy10: 0.6631 - val_loss: 1.9706 - val_accuracy10: 0.7267 - 36s/epoch - 22ms/step
Epoch 20/50
1601/1601 - 36s - loss: 1.9463 - accuracy10: 0.6638 - val_loss: 1.9706 - val_accuracy10: 0.7194 - 36s/epoch - 22ms/step
testing model: results/EXC/W4/deepOF_L2/h10
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69791377
{'0': {'precision': 0.3838363136410992, 'recall': 0.5796600551958938, 'f1-score': 0.4618482974044923, 'support': 116313}, '1': {'precision': 0.9101669950390162, 'recall': 0.7218482009087897, 'f1-score': 0.8051425127986185, 'support': 730202}, '2': {'precision': 0.37040285960896163, 'recall': 0.6502433440662753, 'f1-score': 0.47195980980786534, 'support': 121433}, 'accuracy': 0.6957791121010632, 'macro avg': {'precision': 0.554802056096359, 'recall': 0.6505838667236529, 'f1-score': 0.5796502066703253, 'support': 967948}, 'weighted avg': {'precision': 0.7792051264230226, 'recall': 0.6957791121010632, 'f1-score': 0.722091610015191, 'support': 967948}}
[[ 67422  25314  23577]
 [ 92469 527095 110638]
 [ 15762  26710  78961]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6859896
{'0': {'precision': 0.4445398416686658, 'recall': 0.5932366172976798, 'f1-score': 0.508235294117647, 'support': 59349}, '1': {'precision': 0.8991901108269394, 'recall': 0.70930432037769, 'f1-score': 0.7930390283947492, 'support': 291456}, '2': {'precision': 0.40738863882513093, 'recall': 0.6955636610399525, 'f1-score': 0.5138295339190154, 'support': 58945}, 'accuracy': 0.690516168395363, 'macro avg': {'precision': 0.5837061971069121, 'recall': 0.6660348662384408, 'f1-score': 0.6050346188104706, 'support': 409750}, 'weighted avg': {'precision': 0.7625890697252409, 'recall': 0.690516168395363, 'f1-score': 0.7116215287547641, 'support': 409750}}
[[ 35208  12735  11406]
 [ 36490 206731  48235]
 [  7503  10442  41000]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63299173
{'0': {'precision': 0.4314254624591948, 'recall': 0.5807018571679653, 'f1-score': 0.49505543901708116, 'support': 17069}, '1': {'precision': 0.9108002532522608, 'recall': 0.7464217884204961, 'f1-score': 0.8204587397838122, 'support': 102146}, '2': {'precision': 0.3923384907709012, 'recall': 0.6824647346986956, 'f1-score': 0.4982441021221588, 'support': 16943}, 'accuracy': 0.7176882739170669, 'macro avg': {'precision': 0.5781880688274522, 'recall': 0.6698627934290524, 'f1-score': 0.6045860936410175, 'support': 136158}, 'weighted avg': {'precision': 0.7861895366893814, 'recall': 0.7176882739170669, 'f1-score': 0.7395704221918329, 'support': 136158}}
[[ 9912  4127  3030]
 [11023 76244 14879]
 [ 2040  3340 11563]]
training model: results/EXC/W4/deepOF_L2/h20
Epoch 1/50
1601/1601 - 39s - loss: 2.6763 - accuracy20: 0.5391 - val_loss: 2.4865 - val_accuracy20: 0.7099 - 39s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 2.3170 - accuracy20: 0.6181 - val_loss: 2.2948 - val_accuracy20: 0.7152 - 36s/epoch - 22ms/step
Epoch 3/50
1601/1601 - 36s - loss: 2.2505 - accuracy20: 0.6286 - val_loss: 2.2517 - val_accuracy20: 0.7134 - 36s/epoch - 22ms/step
Epoch 4/50
1601/1601 - 36s - loss: 2.2194 - accuracy20: 0.6335 - val_loss: 2.2035 - val_accuracy20: 0.7102 - 36s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 36s - loss: 2.1980 - accuracy20: 0.6373 - val_loss: 2.1956 - val_accuracy20: 0.7122 - 36s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 37s - loss: 2.1831 - accuracy20: 0.6389 - val_loss: 2.1865 - val_accuracy20: 0.7097 - 37s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 36s - loss: 2.1705 - accuracy20: 0.6398 - val_loss: 2.1774 - val_accuracy20: 0.7080 - 36s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 36s - loss: 2.1607 - accuracy20: 0.6417 - val_loss: 2.1700 - val_accuracy20: 0.7103 - 36s/epoch - 22ms/step
Epoch 9/50
1601/1601 - 36s - loss: 2.1521 - accuracy20: 0.6429 - val_loss: 2.1641 - val_accuracy20: 0.7110 - 36s/epoch - 22ms/step
Epoch 10/50
1601/1601 - 36s - loss: 2.1435 - accuracy20: 0.6440 - val_loss: 2.1512 - val_accuracy20: 0.7070 - 36s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 36s - loss: 2.1374 - accuracy20: 0.6444 - val_loss: 2.1469 - val_accuracy20: 0.7074 - 36s/epoch - 22ms/step
Epoch 12/50
1601/1601 - 36s - loss: 2.1309 - accuracy20: 0.6464 - val_loss: 2.1486 - val_accuracy20: 0.7076 - 36s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 36s - loss: 2.1264 - accuracy20: 0.6460 - val_loss: 2.1376 - val_accuracy20: 0.7058 - 36s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 36s - loss: 2.1223 - accuracy20: 0.6463 - val_loss: 2.1424 - val_accuracy20: 0.7075 - 36s/epoch - 23ms/step
Epoch 15/50
1601/1601 - 36s - loss: 2.1161 - accuracy20: 0.6469 - val_loss: 2.1366 - val_accuracy20: 0.7065 - 36s/epoch - 23ms/step
Epoch 16/50
1601/1601 - 36s - loss: 2.1118 - accuracy20: 0.6484 - val_loss: 2.1400 - val_accuracy20: 0.7059 - 36s/epoch - 23ms/step
Epoch 17/50
1601/1601 - 36s - loss: 2.1072 - accuracy20: 0.6486 - val_loss: 2.1304 - val_accuracy20: 0.7068 - 36s/epoch - 22ms/step
Epoch 18/50
1601/1601 - 36s - loss: 2.1030 - accuracy20: 0.6492 - val_loss: 2.1498 - val_accuracy20: 0.7018 - 36s/epoch - 22ms/step
Epoch 19/50
1601/1601 - 36s - loss: 2.0985 - accuracy20: 0.6493 - val_loss: 2.1405 - val_accuracy20: 0.7054 - 36s/epoch - 23ms/step
Epoch 20/50
1601/1601 - 36s - loss: 2.0933 - accuracy20: 0.6507 - val_loss: 2.1490 - val_accuracy20: 0.7008 - 36s/epoch - 22ms/step
Epoch 21/50
1601/1601 - 36s - loss: 2.0902 - accuracy20: 0.6514 - val_loss: 2.1480 - val_accuracy20: 0.7030 - 36s/epoch - 23ms/step
Epoch 22/50
1601/1601 - 37s - loss: 2.0860 - accuracy20: 0.6516 - val_loss: 2.1496 - val_accuracy20: 0.7018 - 37s/epoch - 23ms/step
Epoch 23/50
1601/1601 - 36s - loss: 2.0815 - accuracy20: 0.6526 - val_loss: 2.1547 - val_accuracy20: 0.7018 - 36s/epoch - 23ms/step
Epoch 24/50
1601/1601 - 36s - loss: 2.0788 - accuracy20: 0.6519 - val_loss: 2.1507 - val_accuracy20: 0.7020 - 36s/epoch - 23ms/step
Epoch 25/50
1601/1601 - 36s - loss: 2.0750 - accuracy20: 0.6530 - val_loss: 2.1641 - val_accuracy20: 0.7018 - 36s/epoch - 23ms/step
Epoch 26/50
1601/1601 - 36s - loss: 2.0693 - accuracy20: 0.6540 - val_loss: 2.1593 - val_accuracy20: 0.6983 - 36s/epoch - 22ms/step
Epoch 27/50
1601/1601 - 36s - loss: 2.0664 - accuracy20: 0.6542 - val_loss: 2.1692 - val_accuracy20: 0.6951 - 36s/epoch - 22ms/step
testing model: results/EXC/W4/deepOF_L2/h20
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72320575
{'0': {'precision': 0.4429179740026894, 'recall': 0.5116270039026347, 'f1-score': 0.47479961920892755, 'support': 154511}, '1': {'precision': 0.8453805205976107, 'recall': 0.7452274461069003, 'f1-score': 0.7921509002104918, 'support': 650176}, '2': {'precision': 0.45712581881388137, 'recall': 0.6056865999840746, 'f1-score': 0.5210232362084409, 'support': 163261}, 'accuracy': 0.6844024679011682, 'macro avg': {'precision': 0.5818081044713937, 'recall': 0.6208470166645366, 'f1-score': 0.5959912518759535, 'support': 967948}, 'weighted avg': {'precision': 0.7156506782870307, 'recall': 0.6844024679011682, 'f1-score': 0.6957626259111788, 'support': 967948}}
[[ 79052  42257  33202]
 [ 81415 484529  84232]
 [ 18013  46363  98885]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70329225
{'0': {'precision': 0.5166929233095974, 'recall': 0.5241778755178234, 'f1-score': 0.520408487087213, 'support': 78212}, '1': {'precision': 0.8244821917808219, 'recall': 0.7409822244634247, 'f1-score': 0.7805053147894937, 'support': 253832}, '2': {'precision': 0.4948963629253031, 'recall': 0.6514040099863588, 'f1-score': 0.5624659695754114, 'support': 77706}, 'accuracy': 0.6826113483831605, 'macro avg': {'precision': 0.6120238260052407, 'recall': 0.6388547033225356, 'f1-score': 0.6211265904840394, 'support': 409750}, 'weighted avg': {'precision': 0.7032287184855971, 'recall': 0.6826113483831605, 'f1-score': 0.6895091989933833, 'support': 409750}}
[[ 40997  21429  15786]
 [ 29871 188085  35876]
 [  8477  18611  50618]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6595378
{'0': {'precision': 0.509541901393074, 'recall': 0.5093417146848263, 'f1-score': 0.5094417883729561, 'support': 22908}, '1': {'precision': 0.8431715318853421, 'recall': 0.7775201501600971, 'f1-score': 0.809016129773448, 'support': 90570}, '2': {'precision': 0.47637940889680913, 'recall': 0.6246913580246913, 'f1-score': 0.5405467274565536, 'support': 22680}, 'accuracy': 0.7069434039865451, 'macro avg': {'precision': 0.6096976140584084, 'recall': 0.6371844076232048, 'f1-score': 0.6196682152009859, 'support': 136158}, 'weighted avg': {'precision': 0.725942776140569, 'recall': 0.7069434039865451, 'f1-score': 0.713894762998454, 'support': 136158}}
[[11668  7078  4162]
 [ 8739 70420 11411]
 [ 2492  6020 14168]]
training model: results/EXC/W4/deepOF_L2/h30
Epoch 1/50
1601/1601 - 39s - loss: 2.7624 - accuracy30: 0.5278 - val_loss: 2.5648 - val_accuracy30: 0.6743 - 39s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 2.4592 - accuracy30: 0.5965 - val_loss: 2.4578 - val_accuracy30: 0.6838 - 36s/epoch - 22ms/step
Epoch 3/50
1601/1601 - 36s - loss: 2.3952 - accuracy30: 0.6072 - val_loss: 2.3940 - val_accuracy30: 0.6825 - 36s/epoch - 22ms/step
Epoch 4/50
1601/1601 - 36s - loss: 2.3651 - accuracy30: 0.6126 - val_loss: 2.3525 - val_accuracy30: 0.6805 - 36s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 37s - loss: 2.3456 - accuracy30: 0.6154 - val_loss: 2.3389 - val_accuracy30: 0.6796 - 37s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 37s - loss: 2.3315 - accuracy30: 0.6174 - val_loss: 2.3215 - val_accuracy30: 0.6803 - 37s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 36s - loss: 2.3206 - accuracy30: 0.6197 - val_loss: 2.3184 - val_accuracy30: 0.6779 - 36s/epoch - 22ms/step
Epoch 8/50
1601/1601 - 36s - loss: 2.3105 - accuracy30: 0.6212 - val_loss: 2.3065 - val_accuracy30: 0.6779 - 36s/epoch - 23ms/step
Epoch 9/50
1601/1601 - 36s - loss: 2.3019 - accuracy30: 0.6217 - val_loss: 2.2985 - val_accuracy30: 0.6779 - 36s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 36s - loss: 2.2959 - accuracy30: 0.6222 - val_loss: 2.2992 - val_accuracy30: 0.6806 - 36s/epoch - 22ms/step
Epoch 11/50
1601/1601 - 36s - loss: 2.2901 - accuracy30: 0.6234 - val_loss: 2.2950 - val_accuracy30: 0.6762 - 36s/epoch - 22ms/step
Epoch 12/50
1601/1601 - 36s - loss: 2.2842 - accuracy30: 0.6243 - val_loss: 2.2823 - val_accuracy30: 0.6788 - 36s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 36s - loss: 2.2770 - accuracy30: 0.6256 - val_loss: 2.2833 - val_accuracy30: 0.6778 - 36s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 36s - loss: 2.2720 - accuracy30: 0.6265 - val_loss: 2.2862 - val_accuracy30: 0.6768 - 36s/epoch - 23ms/step
Epoch 15/50
1601/1601 - 36s - loss: 2.2669 - accuracy30: 0.6269 - val_loss: 2.2869 - val_accuracy30: 0.6776 - 36s/epoch - 22ms/step
Epoch 16/50
1601/1601 - 36s - loss: 2.2619 - accuracy30: 0.6271 - val_loss: 2.2890 - val_accuracy30: 0.6778 - 36s/epoch - 23ms/step
Epoch 17/50
1601/1601 - 36s - loss: 2.2571 - accuracy30: 0.6280 - val_loss: 2.3016 - val_accuracy30: 0.6798 - 36s/epoch - 23ms/step
Epoch 18/50
1601/1601 - 36s - loss: 2.2517 - accuracy30: 0.6287 - val_loss: 2.2843 - val_accuracy30: 0.6782 - 36s/epoch - 22ms/step
Epoch 19/50
1601/1601 - 36s - loss: 2.2465 - accuracy30: 0.6296 - val_loss: 2.2844 - val_accuracy30: 0.6776 - 36s/epoch - 23ms/step
Epoch 20/50
1601/1601 - 36s - loss: 2.2418 - accuracy30: 0.6303 - val_loss: 2.2883 - val_accuracy30: 0.6769 - 36s/epoch - 23ms/step
Epoch 21/50
1601/1601 - 36s - loss: 2.2366 - accuracy30: 0.6306 - val_loss: 2.2946 - val_accuracy30: 0.6762 - 36s/epoch - 23ms/step
Epoch 22/50
1601/1601 - 36s - loss: 2.2319 - accuracy30: 0.6308 - val_loss: 2.3187 - val_accuracy30: 0.6796 - 36s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h30
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7743557
{'0': {'precision': 0.48726188786373315, 'recall': 0.4728085108727391, 'f1-score': 0.4799264052075586, 'support': 181509}, '1': {'precision': 0.7853459802336907, 'recall': 0.7575277977950338, 'f1-score': 0.771186106583158, 'support': 593932}, '2': {'precision': 0.48561405752549913, 'recall': 0.5522656318990997, 'f1-score': 0.5167996966721433, 'support': 192507}, 'accuracy': 0.6633145582200697, 'macro avg': {'precision': 0.586073975207641, 'recall': 0.5942006468556242, 'f1-score': 0.5893040694876199, 'support': 967948}, 'weighted avg': {'precision': 0.6698382889457657, 'recall': 0.6633145582200697, 'f1-score': 0.6659765067392373, 'support': 967948}}
[[ 85819  59847  35843]
 [ 67241 449920  76771]
 [ 23065  63127 106315]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7671857
{'0': {'precision': 0.551707995951417, 'recall': 0.47642823585967287, 'f1-score': 0.5113121376099994, 'support': 91529}, '1': {'precision': 0.7520277067993839, 'recall': 0.7439109776343196, 'f1-score': 0.7479473221658214, 'support': 227089}, '2': {'precision': 0.516092842597481, 'recall': 0.6007000833955142, 'f1-score': 0.5551915782641326, 'support': 91132}, 'accuracy': 0.6523099450884686, 'macro avg': {'precision': 0.606609515116094, 'recall': 0.6070130989631689, 'f1-score': 0.6048170126799844, 'support': 409750}, 'weighted avg': {'precision': 0.6548067699875441, 'recall': 0.6523099450884686, 'f1-score': 0.6522177351970391, 'support': 409750}}
[[ 43607  30413  17509]
 [ 24335 168934  33820]
 [ 11098  25291  54743]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7204679
{'0': {'precision': 0.5466243610082848, 'recall': 0.45739149673660534, 'f1-score': 0.4980426010319006, 'support': 27119}, '1': {'precision': 0.7789097949059229, 'recall': 0.7836413215494363, 'f1-score': 0.7812683945118362, 'support': 82146}, '2': {'precision': 0.507835566659096, 'recall': 0.582010188524895, 'f1-score': 0.5423987247461621, 'support': 26893}, 'accuracy': 0.6788363518853097, 'macro avg': {'precision': 0.6111232408577679, 'recall': 0.6076810022703122, 'f1-score': 0.6072365734299663, 'support': 136158}, 'weighted avg': {'precision': 0.6791040699238289, 'recall': 0.6788363518853097, 'f1-score': 0.6776775491528367, 'support': 136158}}
[[12404 10078  4637]
 [ 7241 64373 10532]
 [ 3047  8194 15652]]
training model: results/EXC/W4/deepOF_L2/h50
Epoch 1/50
1601/1601 - 38s - loss: 2.9201 - accuracy50: 0.5037 - val_loss: 2.8499 - val_accuracy50: 0.5941 - 38s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 2.6767 - accuracy50: 0.5615 - val_loss: 2.7127 - val_accuracy50: 0.6084 - 36s/epoch - 22ms/step
Epoch 3/50
1601/1601 - 36s - loss: 2.6238 - accuracy50: 0.5715 - val_loss: 2.6672 - val_accuracy50: 0.6125 - 36s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 36s - loss: 2.5954 - accuracy50: 0.5778 - val_loss: 2.6226 - val_accuracy50: 0.6136 - 36s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 36s - loss: 2.5794 - accuracy50: 0.5810 - val_loss: 2.6076 - val_accuracy50: 0.6161 - 36s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 36s - loss: 2.5670 - accuracy50: 0.5825 - val_loss: 2.5795 - val_accuracy50: 0.6180 - 36s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 36s - loss: 2.5586 - accuracy50: 0.5838 - val_loss: 2.5699 - val_accuracy50: 0.6190 - 36s/epoch - 22ms/step
Epoch 8/50
1601/1601 - 36s - loss: 2.5498 - accuracy50: 0.5854 - val_loss: 2.5703 - val_accuracy50: 0.6197 - 36s/epoch - 23ms/step
Epoch 9/50
1601/1601 - 37s - loss: 2.5420 - accuracy50: 0.5871 - val_loss: 2.5582 - val_accuracy50: 0.6189 - 37s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 36s - loss: 2.5357 - accuracy50: 0.5879 - val_loss: 2.5627 - val_accuracy50: 0.6199 - 36s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 36s - loss: 2.5310 - accuracy50: 0.5886 - val_loss: 2.5534 - val_accuracy50: 0.6185 - 36s/epoch - 23ms/step
Epoch 12/50
1601/1601 - 36s - loss: 2.5268 - accuracy50: 0.5898 - val_loss: 2.5460 - val_accuracy50: 0.6182 - 36s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 36s - loss: 2.5202 - accuracy50: 0.5900 - val_loss: 2.5500 - val_accuracy50: 0.6183 - 36s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 36s - loss: 2.5157 - accuracy50: 0.5910 - val_loss: 2.5538 - val_accuracy50: 0.6186 - 36s/epoch - 22ms/step
Epoch 15/50
1601/1601 - 36s - loss: 2.5112 - accuracy50: 0.5917 - val_loss: 2.5495 - val_accuracy50: 0.6194 - 36s/epoch - 22ms/step
Epoch 16/50
1601/1601 - 36s - loss: 2.5062 - accuracy50: 0.5926 - val_loss: 2.5527 - val_accuracy50: 0.6186 - 36s/epoch - 22ms/step
Epoch 17/50
1601/1601 - 36s - loss: 2.5012 - accuracy50: 0.5936 - val_loss: 2.5584 - val_accuracy50: 0.6191 - 36s/epoch - 22ms/step
Epoch 18/50
1601/1601 - 36s - loss: 2.4966 - accuracy50: 0.5941 - val_loss: 2.5587 - val_accuracy50: 0.6198 - 36s/epoch - 22ms/step
Epoch 19/50
1601/1601 - 36s - loss: 2.4911 - accuracy50: 0.5955 - val_loss: 2.5635 - val_accuracy50: 0.6169 - 36s/epoch - 23ms/step
Epoch 20/50
1601/1601 - 36s - loss: 2.4882 - accuracy50: 0.5957 - val_loss: 2.5690 - val_accuracy50: 0.6163 - 36s/epoch - 23ms/step
Epoch 21/50
1601/1601 - 36s - loss: 2.4819 - accuracy50: 0.5968 - val_loss: 2.5836 - val_accuracy50: 0.6154 - 36s/epoch - 22ms/step
Epoch 22/50
1601/1601 - 36s - loss: 2.4790 - accuracy50: 0.5969 - val_loss: 2.5875 - val_accuracy50: 0.6160 - 36s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h50
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85189533
{'0': {'precision': 0.5120390461840965, 'recall': 0.3958329585724308, 'f1-score': 0.4464989106256484, 'support': 222364}, '1': {'precision': 0.6771015033557519, 'recall': 0.7574145429987379, 'f1-score': 0.7150098139804612, 'support': 507887}, '2': {'precision': 0.5130703755703756, 'recall': 0.4919666634412719, 'f1-score': 0.5022969522160917, 'support': 237697}, 'accuracy': 0.6091639220288693, 'macro avg': {'precision': 0.567403641703408, 'recall': 0.5484047216708136, 'f1-score': 0.5546018922740671, 'support': 967948}, 'weighted avg': {'precision': 0.5989013777211946, 'recall': 0.6091639220288693, 'f1-score': 0.6010900914164443, 'support': 967948}}
[[ 88019  90316  44029]
 [ 56254 384681  66952]
 [ 27626  93132 116939]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85426754
{'0': {'precision': 0.5828526199994634, 'recall': 0.3906647604146997, 'f1-score': 0.4677882156604129, 'support': 111213}, '1': {'precision': 0.6285074930494338, 'recall': 0.7422916544311975, 'f1-score': 0.6806772059867516, 'support': 187297}, '2': {'precision': 0.5357753743322544, 'recall': 0.5490830636461704, 'f1-score': 0.5423475979275716, 'support': 111240}, 'accuracy': 0.5944014643075046, 'macro avg': {'precision': 0.5823784957937171, 'recall': 0.5606798261640226, 'f1-score': 0.5636043398582454, 'support': 409750}, 'weighted avg': {'precision': 0.590940839522636, 'recall': 0.5944014643075046, 'f1-score': 0.5853414918155099, 'support': 409750}}
[[ 43447  45336  22430]
 [ 17775 139029  30493]
 [ 13320  36840  61080]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8220559
{'0': {'precision': 0.5866729456086649, 'recall': 0.3689291637052831, 'f1-score': 0.4529934730832864, 'support': 33768}, '1': {'precision': 0.6631369144422299, 'recall': 0.7844249016431382, 'f1-score': 0.7186996826069959, 'support': 69136}, '2': {'precision': 0.5289964395630922, 'recall': 0.5272147711553498, 'f1-score': 0.5281041026567865, 'support': 33254}, 'accuracy': 0.6185607896708236, 'macro avg': {'precision': 0.5929354332046624, 'recall': 0.5601896121679237, 'f1-score': 0.5665990861156897, 'support': 136158}, 'weighted avg': {'precision': 0.6114121340312172, 'recall': 0.6185607896708236, 'f1-score': 0.6062536074673722, 'support': 136158}}
[[12458 15310  6000]
 [ 5294 54232  9610]
 [ 3483 12239 17532]]
training model: results/EXC/W4/deepOF_L2/h100
Epoch 1/50
1601/1601 - 38s - loss: 3.1096 - accuracy100: 0.4507 - val_loss: 3.1890 - val_accuracy100: 0.4487 - 38s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 2.9815 - accuracy100: 0.4876 - val_loss: 3.1263 - val_accuracy100: 0.4630 - 36s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 36s - loss: 2.9403 - accuracy100: 0.4970 - val_loss: 3.0653 - val_accuracy100: 0.4723 - 36s/epoch - 22ms/step
Epoch 4/50
1601/1601 - 36s - loss: 2.9207 - accuracy100: 0.5017 - val_loss: 3.0443 - val_accuracy100: 0.4771 - 36s/epoch - 22ms/step
Epoch 5/50
1601/1601 - 36s - loss: 2.9099 - accuracy100: 0.5040 - val_loss: 3.0400 - val_accuracy100: 0.4822 - 36s/epoch - 22ms/step
Epoch 6/50
1601/1601 - 36s - loss: 2.9011 - accuracy100: 0.5063 - val_loss: 3.0188 - val_accuracy100: 0.4842 - 36s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 36s - loss: 2.8936 - accuracy100: 0.5094 - val_loss: 3.0095 - val_accuracy100: 0.4873 - 36s/epoch - 22ms/step
Epoch 8/50
1601/1601 - 36s - loss: 2.8876 - accuracy100: 0.5108 - val_loss: 2.9979 - val_accuracy100: 0.4889 - 36s/epoch - 22ms/step
Epoch 9/50
1601/1601 - 36s - loss: 2.8831 - accuracy100: 0.5121 - val_loss: 2.9979 - val_accuracy100: 0.4920 - 36s/epoch - 22ms/step
Epoch 10/50
1601/1601 - 36s - loss: 2.8771 - accuracy100: 0.5139 - val_loss: 2.9955 - val_accuracy100: 0.4950 - 36s/epoch - 22ms/step
Epoch 11/50
1601/1601 - 36s - loss: 2.8728 - accuracy100: 0.5146 - val_loss: 2.9894 - val_accuracy100: 0.4944 - 36s/epoch - 22ms/step
Epoch 12/50
1601/1601 - 36s - loss: 2.8685 - accuracy100: 0.5163 - val_loss: 2.9769 - val_accuracy100: 0.4984 - 36s/epoch - 22ms/step
Epoch 13/50
1601/1601 - 36s - loss: 2.8632 - accuracy100: 0.5179 - val_loss: 2.9973 - val_accuracy100: 0.4981 - 36s/epoch - 22ms/step
Epoch 14/50
1601/1601 - 36s - loss: 2.8586 - accuracy100: 0.5190 - val_loss: 2.9780 - val_accuracy100: 0.4982 - 36s/epoch - 22ms/step
Epoch 15/50
1601/1601 - 36s - loss: 2.8540 - accuracy100: 0.5204 - val_loss: 2.9815 - val_accuracy100: 0.4991 - 36s/epoch - 22ms/step
Epoch 16/50
1601/1601 - 36s - loss: 2.8493 - accuracy100: 0.5219 - val_loss: 2.9842 - val_accuracy100: 0.4984 - 36s/epoch - 22ms/step
Epoch 17/50
1601/1601 - 36s - loss: 2.8446 - accuracy100: 0.5226 - val_loss: 2.9901 - val_accuracy100: 0.4985 - 36s/epoch - 22ms/step
Epoch 18/50
1601/1601 - 36s - loss: 2.8391 - accuracy100: 0.5240 - val_loss: 3.0259 - val_accuracy100: 0.4948 - 36s/epoch - 23ms/step
Epoch 19/50
1601/1601 - 36s - loss: 2.8343 - accuracy100: 0.5256 - val_loss: 3.0266 - val_accuracy100: 0.4961 - 36s/epoch - 23ms/step
Epoch 20/50
1601/1601 - 36s - loss: 2.8289 - accuracy100: 0.5261 - val_loss: 3.0271 - val_accuracy100: 0.4947 - 36s/epoch - 23ms/step
Epoch 21/50
1601/1601 - 36s - loss: 2.8254 - accuracy100: 0.5278 - val_loss: 3.0511 - val_accuracy100: 0.4922 - 36s/epoch - 22ms/step
Epoch 22/50
1601/1601 - 36s - loss: 2.8179 - accuracy100: 0.5299 - val_loss: 3.0590 - val_accuracy100: 0.4903 - 36s/epoch - 22ms/step
testing model: results/EXC/W4/deepOF_L2/h100
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9734711
{'0': {'precision': 0.5584463039427047, 'recall': 0.2653842280189344, 'f1-score': 0.35978963029926364, 'support': 287941}, '1': {'precision': 0.485187160294815, 'recall': 0.7657263481097678, 'f1-score': 0.5939988494906178, 'support': 364770}, '2': {'precision': 0.5216458520925498, 'recall': 0.4226788099112731, 'f1-score': 0.4669763627474517, 'support': 315237}, 'accuracy': 0.505164533631972, 'macro avg': {'precision': 0.5217597721100232, 'recall': 0.4845964620133251, 'f1-score': 0.4735882808457777, 'support': 967948}, 'weighted avg': {'precision': 0.5188536792683132, 'recall': 0.505164533631972, 'f1-score': 0.4829591816193755, 'support': 967948}}
[[ 76415 145217  66309]
 [ 29579 279314  55877]
 [ 30841 151152 133244]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0009855
{'0': {'precision': 0.5834173228346456, 'recall': 0.2696013506629601, 'f1-score': 0.36878465413062306, 'support': 137414}, '1': {'precision': 0.43653984529591655, 'recall': 0.7228473344404149, 'f1-score': 0.5443421646614159, 'support': 134287}, '2': {'precision': 0.521704738074098, 'recall': 0.468196075306594, 'f1-score': 0.4935042128129068, 'support': 138049}, 'accuracy': 0.48505186089078706, 'macro avg': {'precision': 0.5138873020682201, 'recall': 0.486881586803323, 'f1-score': 0.46887701053498193, 'support': 409750}, 'weighted avg': {'precision': 0.5144896927190822, 'recall': 0.48505186089078706, 'f1-score': 0.46833926492544714, 'support': 409750}}
[[37047 66914 33453]
 [11415 97069 25803]
 [15038 58377 64634]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99374086
{'0': {'precision': 0.6031823878807694, 'recall': 0.2526649775160355, 'f1-score': 0.3561454311454311, 'support': 43809}, '1': {'precision': 0.46407891396588613, 'recall': 0.772403525009054, 'f1-score': 0.5797998867283368, 'support': 49702}, '2': {'precision': 0.5216052901607571, 'recall': 0.4291040401435037, 'f1-score': 0.4708546139892707, 'support': 42647}, 'accuracy': 0.49764978921547026, 'macro avg': {'precision': 0.5296221973358042, 'recall': 0.484724180889531, 'f1-score': 0.4689333106210129, 'support': 136158}, 'weighted avg': {'precision': 0.5268538625867514, 'recall': 0.49764978921547026, 'f1-score': 0.4737152858151737, 'support': 136158}}
[[11069 23696  9044]
 [ 3572 38390  7740]
 [ 3710 20637 18300]]
training model: results/EXC/W4/deepOF_L2/h200
Epoch 1/50
1601/1601 - 38s - loss: 3.2632 - accuracy200: 0.3889 - val_loss: 3.2536 - val_accuracy200: 0.3897 - 38s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 3.2239 - accuracy200: 0.4086 - val_loss: 3.2384 - val_accuracy200: 0.3974 - 36s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 36s - loss: 3.2072 - accuracy200: 0.4152 - val_loss: 3.2350 - val_accuracy200: 0.4015 - 36s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 36s - loss: 3.1974 - accuracy200: 0.4200 - val_loss: 3.2323 - val_accuracy200: 0.4030 - 36s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 36s - loss: 3.1912 - accuracy200: 0.4214 - val_loss: 3.2265 - val_accuracy200: 0.4038 - 36s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 36s - loss: 3.1861 - accuracy200: 0.4238 - val_loss: 3.2276 - val_accuracy200: 0.4062 - 36s/epoch - 22ms/step
Epoch 7/50
1601/1601 - 36s - loss: 3.1813 - accuracy200: 0.4259 - val_loss: 3.2259 - val_accuracy200: 0.4066 - 36s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 36s - loss: 3.1773 - accuracy200: 0.4272 - val_loss: 3.2265 - val_accuracy200: 0.4082 - 36s/epoch - 22ms/step
Epoch 9/50
1601/1601 - 36s - loss: 3.1739 - accuracy200: 0.4288 - val_loss: 3.2234 - val_accuracy200: 0.4078 - 36s/epoch - 22ms/step
Epoch 10/50
1601/1601 - 36s - loss: 3.1693 - accuracy200: 0.4307 - val_loss: 3.2249 - val_accuracy200: 0.4096 - 36s/epoch - 22ms/step
Epoch 11/50
1601/1601 - 36s - loss: 3.1665 - accuracy200: 0.4319 - val_loss: 3.2336 - val_accuracy200: 0.4088 - 36s/epoch - 22ms/step
Epoch 12/50
1601/1601 - 36s - loss: 3.1618 - accuracy200: 0.4342 - val_loss: 3.2346 - val_accuracy200: 0.4091 - 36s/epoch - 22ms/step
Epoch 13/50
1601/1601 - 36s - loss: 3.1583 - accuracy200: 0.4354 - val_loss: 3.2339 - val_accuracy200: 0.4092 - 36s/epoch - 22ms/step
Epoch 14/50
1601/1601 - 36s - loss: 3.1543 - accuracy200: 0.4369 - val_loss: 3.2360 - val_accuracy200: 0.4099 - 36s/epoch - 23ms/step
Epoch 15/50
1601/1601 - 37s - loss: 3.1503 - accuracy200: 0.4381 - val_loss: 3.2399 - val_accuracy200: 0.4114 - 37s/epoch - 23ms/step
Epoch 16/50
1601/1601 - 37s - loss: 3.1453 - accuracy200: 0.4402 - val_loss: 3.2559 - val_accuracy200: 0.4082 - 37s/epoch - 23ms/step
Epoch 17/50
1601/1601 - 37s - loss: 3.1410 - accuracy200: 0.4423 - val_loss: 3.2634 - val_accuracy200: 0.4078 - 37s/epoch - 23ms/step
Epoch 18/50
1601/1601 - 37s - loss: 3.1362 - accuracy200: 0.4434 - val_loss: 3.2693 - val_accuracy200: 0.4071 - 37s/epoch - 23ms/step
Epoch 19/50
1601/1601 - 37s - loss: 3.1323 - accuracy200: 0.4448 - val_loss: 3.2721 - val_accuracy200: 0.4086 - 37s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h200
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0768276
{'0': {'precision': 0.47630410566938197, 'recall': 0.28293047001417443, 'f1-score': 0.35499158969516337, 'support': 318884}, '1': {'precision': 0.3390830132431348, 'recall': 0.6364580986424639, 'f1-score': 0.4424459969166142, 'support': 297377}, '2': {'precision': 0.5006920776397656, 'recall': 0.31371077122554997, 'f1-score': 0.38573661190340497, 'support': 351687}, 'accuracy': 0.40272617950551065, 'macro avg': {'precision': 0.4386930655174275, 'recall': 0.4110331132940628, 'f1-score': 0.3943913995050608, 'support': 967948}, 'weighted avg': {'precision': 0.4430074160702591, 'recall': 0.40272617950551065, 'f1-score': 0.3930303623168778, 'support': 967948}}
[[ 90222 176057  52605]
 [ 50691 189268  57418]
 [ 48508 192851 110328]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0798898
{'0': {'precision': 0.4647491349480969, 'recall': 0.2829658673611213, 'f1-score': 0.35176007347658844, 'support': 136702}, '1': {'precision': 0.35031627530662157, 'recall': 0.5623611715826993, 'f1-score': 0.4317062324205971, 'support': 135509}, '2': {'precision': 0.4493879947883214, 'recall': 0.35609536204276604, 'f1-score': 0.39733901227056073, 'support': 137539}, 'accuracy': 0.39991214154972543, 'macro avg': {'precision': 0.42148446834767994, 'recall': 0.40047413366219553, 'f1-score': 0.39360177272258207, 'support': 409750}, 'weighted avg': {'precision': 0.4217486755616612, 'recall': 0.39991214154972543, 'f1-score': 0.39349846448361187, 'support': 409750}}
[[38682 72032 25988]
 [25283 76205 34021]
 [19267 69295 48977]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.074918
{'0': {'precision': 0.4883351848912871, 'recall': 0.26861046245171427, 'f1-score': 0.3465821893699401, 'support': 45821}, '1': {'precision': 0.35981082528774677, 'recall': 0.6004796685926087, 'f1-score': 0.4499869289588916, 'support': 45865}, '2': {'precision': 0.45598791084246315, 'recall': 0.35282874617737003, 'f1-score': 0.3978296971464067, 'support': 44472}, 'accuracy': 0.40790845928994257, 'macro avg': {'precision': 0.4347113070071657, 'recall': 0.40730629240723104, 'f1-score': 0.3981329384917462, 'support': 136158}, 'weighted avg': {'precision': 0.4344763023818813, 'recall': 0.40790845928994257, 'f1-score': 0.3981526997114719, 'support': 136158}}
[[12308 25544  7969]
 [ 7573 27541 10751]
 [ 5323 23458 15691]]
training model: results/EXC/W4/deepOF_L2/h300
Epoch 1/50
1601/1601 - 39s - loss: 3.2763 - accuracy300: 0.3791 - val_loss: 3.2729 - val_accuracy300: 0.3768 - 39s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 36s - loss: 3.2435 - accuracy300: 0.3980 - val_loss: 3.2590 - val_accuracy300: 0.3845 - 36s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 36s - loss: 3.2296 - accuracy300: 0.4052 - val_loss: 3.2470 - val_accuracy300: 0.3927 - 36s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 37s - loss: 3.2200 - accuracy300: 0.4107 - val_loss: 3.2416 - val_accuracy300: 0.3953 - 37s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 36s - loss: 3.2126 - accuracy300: 0.4142 - val_loss: 3.2385 - val_accuracy300: 0.3972 - 36s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 37s - loss: 3.2067 - accuracy300: 0.4180 - val_loss: 3.2371 - val_accuracy300: 0.3987 - 37s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 37s - loss: 3.2021 - accuracy300: 0.4210 - val_loss: 3.2410 - val_accuracy300: 0.3976 - 37s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 37s - loss: 3.1980 - accuracy300: 0.4230 - val_loss: 3.2434 - val_accuracy300: 0.3974 - 37s/epoch - 23ms/step
Epoch 9/50
1601/1601 - 37s - loss: 3.1941 - accuracy300: 0.4251 - val_loss: 3.2465 - val_accuracy300: 0.3971 - 37s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 36s - loss: 3.1895 - accuracy300: 0.4273 - val_loss: 3.2512 - val_accuracy300: 0.3970 - 36s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 37s - loss: 3.1872 - accuracy300: 0.4286 - val_loss: 3.2544 - val_accuracy300: 0.3959 - 37s/epoch - 23ms/step
Epoch 12/50
1601/1601 - 37s - loss: 3.1831 - accuracy300: 0.4317 - val_loss: 3.2580 - val_accuracy300: 0.3944 - 37s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 37s - loss: 3.1794 - accuracy300: 0.4329 - val_loss: 3.2607 - val_accuracy300: 0.3956 - 37s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 37s - loss: 3.1762 - accuracy300: 0.4338 - val_loss: 3.2649 - val_accuracy300: 0.3969 - 37s/epoch - 23ms/step
Epoch 15/50
1601/1601 - 37s - loss: 3.1721 - accuracy300: 0.4362 - val_loss: 3.2805 - val_accuracy300: 0.3912 - 37s/epoch - 23ms/step
Epoch 16/50
1601/1601 - 37s - loss: 3.1687 - accuracy300: 0.4379 - val_loss: 3.2815 - val_accuracy300: 0.3952 - 37s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h300
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0737088
{'0': {'precision': 0.42568727734902506, 'recall': 0.2251630585847355, 'f1-score': 0.2945348387383179, 'support': 309398}, '1': {'precision': 0.41877595118087885, 'recall': 0.28938344247255704, 'f1-score': 0.3422586142710959, 'support': 316110}, '2': {'precision': 0.40521049541184184, 'recall': 0.6932455320640112, 'f1-score': 0.5114640157880677, 'support': 342440}, 'accuracy': 0.4117338947960014, 'macro avg': {'precision': 0.4165579079805819, 'recall': 0.4025973443737679, 'f1-score': 0.3827524895991605, 'support': 967948}, 'weighted avg': {'precision': 0.4161859316965915, 'recall': 0.4117338947960014, 'f1-score': 0.3868654082240576, 'support': 967948}}
[[ 69665  65625 174108]
 [ 50280  91477 174353]
 [ 43708  61337 237395]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0800132
{'0': {'precision': 0.4407484407484408, 'recall': 0.24232805003239874, 'f1-score': 0.31271961967040607, 'support': 137351}, '1': {'precision': 0.4026214232868769, 'recall': 0.29819767786268586, 'f1-score': 0.3426298549368273, 'support': 135048}, '2': {'precision': 0.38800910290293794, 'recall': 0.6616333335760206, 'f1-score': 0.48915658759507163, 'support': 137351}, 'accuracy': 0.40129591214154975, 'macro avg': {'precision': 0.41045965564608516, 'recall': 0.40071968715703504, 'f1-score': 0.3815020207341016, 'support': 409750}, 'weighted avg': {'precision': 0.4105037104334513, 'recall': 0.40129591214154975, 'f1-score': 0.38172050175382377, 'support': 409750}}
[[33284 32306 71761]
 [23203 40271 71574]
 [19030 27445 90876]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0792987
{'0': {'precision': 0.4542958185978781, 'recall': 0.23651092771893345, 'f1-score': 0.31107375858237657, 'support': 46167}, '1': {'precision': 0.40886179814793105, 'recall': 0.3039717640907209, 'f1-score': 0.3486997488222136, 'support': 45899}, '2': {'precision': 0.3767740612059129, 'recall': 0.6665154676585322, 'f1-score': 0.48141140624616063, 'support': 44092}, 'accuracy': 0.39850027174312197, 'macro avg': {'precision': 0.41331055931724064, 'recall': 0.4023327198227289, 'f1-score': 0.38039497121691696, 'support': 136158}, 'weighted avg': {'precision': 0.41387611919307893, 'recall': 0.39850027174312197, 'f1-score': 0.378917902054004, 'support': 136158}}
[[10919 11161 24087]
 [ 7423 13952 24524]
 [ 5693  9011 29388]]
training model: results/EXC/W4/deepOF_L2/h500
Epoch 1/50
1601/1601 - 39s - loss: 3.2741 - accuracy500: 0.3836 - val_loss: 3.3239 - val_accuracy500: 0.3556 - 39s/epoch - 24ms/step
Epoch 2/50
1601/1601 - 37s - loss: 3.2588 - accuracy500: 0.3933 - val_loss: 3.3033 - val_accuracy500: 0.3629 - 37s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 37s - loss: 3.2522 - accuracy500: 0.3972 - val_loss: 3.2927 - val_accuracy500: 0.3692 - 37s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 38s - loss: 3.2480 - accuracy500: 0.4000 - val_loss: 3.2917 - val_accuracy500: 0.3703 - 38s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 37s - loss: 3.2456 - accuracy500: 0.4015 - val_loss: 3.2946 - val_accuracy500: 0.3710 - 37s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 37s - loss: 3.2412 - accuracy500: 0.4029 - val_loss: 3.2902 - val_accuracy500: 0.3749 - 37s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 37s - loss: 3.2373 - accuracy500: 0.4052 - val_loss: 3.2897 - val_accuracy500: 0.3749 - 37s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 37s - loss: 3.2330 - accuracy500: 0.4083 - val_loss: 3.2879 - val_accuracy500: 0.3777 - 37s/epoch - 23ms/step
Epoch 9/50
1601/1601 - 37s - loss: 3.2298 - accuracy500: 0.4096 - val_loss: 3.2999 - val_accuracy500: 0.3746 - 37s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 37s - loss: 3.2264 - accuracy500: 0.4121 - val_loss: 3.3100 - val_accuracy500: 0.3718 - 37s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 37s - loss: 3.2241 - accuracy500: 0.4131 - val_loss: 3.3274 - val_accuracy500: 0.3703 - 37s/epoch - 23ms/step
Epoch 12/50
1601/1601 - 37s - loss: 3.2215 - accuracy500: 0.4151 - val_loss: 3.3226 - val_accuracy500: 0.3727 - 37s/epoch - 23ms/step
Epoch 13/50
1601/1601 - 37s - loss: 3.2176 - accuracy500: 0.4173 - val_loss: 3.3254 - val_accuracy500: 0.3758 - 37s/epoch - 23ms/step
Epoch 14/50
1601/1601 - 37s - loss: 3.2164 - accuracy500: 0.4184 - val_loss: 3.3576 - val_accuracy500: 0.3703 - 37s/epoch - 23ms/step
Epoch 15/50
1601/1601 - 37s - loss: 3.2139 - accuracy500: 0.4201 - val_loss: 3.3581 - val_accuracy500: 0.3735 - 37s/epoch - 23ms/step
Epoch 16/50
1601/1601 - 37s - loss: 3.2107 - accuracy500: 0.4207 - val_loss: 3.3701 - val_accuracy500: 0.3722 - 37s/epoch - 23ms/step
Epoch 17/50
1601/1601 - 37s - loss: 3.2088 - accuracy500: 0.4223 - val_loss: 3.3652 - val_accuracy500: 0.3747 - 37s/epoch - 23ms/step
Epoch 18/50
1601/1601 - 37s - loss: 3.2053 - accuracy500: 0.4245 - val_loss: 3.3841 - val_accuracy500: 0.3735 - 37s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h500
Evaluating performance on  test set...
3782/3782 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0882537
{'0': {'precision': 0.4144334835068096, 'recall': 0.19745932075844116, 'f1-score': 0.26747741951655624, 'support': 324244}, '1': {'precision': 0.38808333863882344, 'recall': 0.17472044370716186, 'f1-score': 0.2409581998176693, 'support': 279103}, '2': {'precision': 0.40758704514658245, 'recall': 0.7688953129585492, 'f1-score': 0.5327606767356674, 'support': 364601}, 'accuracy': 0.4061478509176113, 'macro avg': {'precision': 0.40336795576407186, 'recall': 0.3803583591413841, 'f1-score': 0.3470654320232976, 'support': 967948}, 'weighted avg': {'precision': 0.4042566736413347, 'recall': 0.4061478509176113, 'f1-score': 0.3597560823060105, 'support': 967948}}
[[ 64025  38580 221639]
 [ 44513  48765 185825]
 [ 45950  38311 280340]]
Evaluating performance on  train set...
1601/1601 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956869
{'0': {'precision': 0.4239429871840939, 'recall': 0.20460868120036707, 'f1-score': 0.27600727155758514, 'support': 138391}, '1': {'precision': 0.39246326591810216, 'recall': 0.17630858117918244, 'f1-score': 0.24331247030633535, 'support': 133618}, '2': {'precision': 0.36234501576350503, 'recall': 0.7442881930579857, 'f1-score': 0.48740470626828913, 'support': 137741}, 'accuracy': 0.3767980475899939, 'macro avg': {'precision': 0.39291708962190036, 'recall': 0.375068485145845, 'f1-score': 0.3355748160440699, 'support': 409750}, 'weighted avg': {'precision': 0.39297087351096976, 'recall': 0.3767980475899939, 'f1-score': 0.33640868730108137, 'support': 409750}}
[[ 28316  19022  91053]
 [ 20700  23558  89360]
 [ 17776  17446 102519]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972136
{'0': {'precision': 0.4453335904357887, 'recall': 0.1927997495565063, 'f1-score': 0.26909800608805834, 'support': 47915}, '1': {'precision': 0.38752061005770816, 'recall': 0.1750902106856012, 'f1-score': 0.24120071196061765, 'support': 42955}, '2': {'precision': 0.36189404828864863, 'recall': 0.7671789436495319, 'f1-score': 0.49179724545982134, 'support': 45288}, 'accuracy': 0.3782590813613596, 'macro avg': {'precision': 0.39824941626071514, 'recall': 0.3783563012972131, 'f1-score': 0.3340319878361658, 'support': 136158}, 'weighted avg': {'precision': 0.3993416798840757, 'recall': 0.3782590813613596, 'f1-score': 0.3343697850758827, 'support': 136158}}
[[ 9238  6553 32124]
 [ 6296  7521 29138]
 [ 5210  5334 34744]]
training model: results/EXC/W4/deepOF_L2/h1000
Epoch 1/50
1601/1601 - 41s - loss: 3.2607 - accuracy1000: 0.3983 - val_loss: 3.4114 - val_accuracy1000: 0.3049 - 41s/epoch - 25ms/step
Epoch 2/50
1601/1601 - 37s - loss: 3.2560 - accuracy1000: 0.3925 - val_loss: 3.3020 - val_accuracy1000: 0.3352 - 37s/epoch - 23ms/step
Epoch 3/50
1601/1601 - 37s - loss: 3.2601 - accuracy1000: 0.3919 - val_loss: 3.3707 - val_accuracy1000: 0.3011 - 37s/epoch - 23ms/step
Epoch 4/50
1601/1601 - 37s - loss: 3.2695 - accuracy1000: 0.3819 - val_loss: 3.3192 - val_accuracy1000: 0.3278 - 37s/epoch - 23ms/step
Epoch 5/50
1601/1601 - 37s - loss: 3.2630 - accuracy1000: 0.3874 - val_loss: 3.3222 - val_accuracy1000: 0.3065 - 37s/epoch - 23ms/step
Epoch 6/50
1601/1601 - 37s - loss: 3.2550 - accuracy1000: 0.3932 - val_loss: 3.3419 - val_accuracy1000: 0.3050 - 37s/epoch - 23ms/step
Epoch 7/50
1601/1601 - 37s - loss: 3.2484 - accuracy1000: 0.3988 - val_loss: 3.3556 - val_accuracy1000: 0.3038 - 37s/epoch - 23ms/step
Epoch 8/50
1601/1601 - 37s - loss: 3.2410 - accuracy1000: 0.4028 - val_loss: 3.4211 - val_accuracy1000: 0.3031 - 37s/epoch - 23ms/step
Epoch 9/50
1601/1601 - 37s - loss: 3.2356 - accuracy1000: 0.4068 - val_loss: 3.4431 - val_accuracy1000: 0.3023 - 37s/epoch - 23ms/step
Epoch 10/50
1601/1601 - 37s - loss: 3.2320 - accuracy1000: 0.4095 - val_loss: 3.4682 - val_accuracy1000: 0.3018 - 37s/epoch - 23ms/step
Epoch 11/50
1601/1601 - 37s - loss: 3.2296 - accuracy1000: 0.4104 - val_loss: 3.4816 - val_accuracy1000: 0.3013 - 37s/epoch - 23ms/step
Epoch 12/50
1601/1601 - 37s - loss: 3.2283 - accuracy1000: 0.4102 - val_loss: 3.4889 - val_accuracy1000: 0.3016 - 37s/epoch - 23ms/step
testing model: results/EXC/W4/deepOF_L2/h1000
Evaluating performance on  test set...
3782/3782 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999821
{'0': {'precision': 0.3928841965722943, 'recall': 0.04718072631653756, 'f1-score': 0.08424466840431552, 'support': 351775}, '1': {'precision': 0.21375444472233399, 'recall': 0.3709609696031855, 'f1-score': 0.27122444227900283, 'support': 211963}, '2': {'precision': 0.43024135433770966, 'recall': 0.5937779866900869, 'f1-score': 0.4989512110446105, 'support': 404210}, 'accuracy': 0.3463388529135863, 'macro avg': {'precision': 0.34562666521077934, 'recall': 0.3373065608699366, 'f1-score': 0.2848067739093096, 'support': 967948}, 'weighted avg': {'precision': 0.3692581930565945, 'recall': 0.3463388529135863, 'f1-score': 0.2983691104305752, 'support': 967948}}
[[ 16597 140536 194642]
 [ 10134  78630 123199]
 [ 15513 148686 240011]]
Evaluating performance on  train set...
1601/1601 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986857
{'0': {'precision': 0.37143356490584173, 'recall': 0.061390585958374856, 'f1-score': 0.1053662285186631, 'support': 138474}, '1': {'precision': 0.3365425789073831, 'recall': 0.3627322534540257, 'f1-score': 0.3491469802168196, 'support': 134336}, '2': {'precision': 0.3513444291597989, 'recall': 0.6210822257923178, 'f1-score': 0.4488025476698688, 'support': 136940}, 'accuracy': 0.34723611958511286, 'macro avg': {'precision': 0.3531068576576746, 'recall': 0.34840168840157276, 'f1-score': 0.3011052521351172, 'support': 409750}, 'weighted avg': {'precision': 0.35328073575598934, 'recall': 0.34723611958511286, 'f1-score': 0.30006714518660615, 'support': 409750}}
[[ 8501 51080 78893]
 [ 7479 48728 78129]
 [ 6907 44982 85051]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102422
{'0': {'precision': 0.3992595756799089, 'recall': 0.05612040669281883, 'f1-score': 0.09840840893537123, 'support': 49964}, '1': {'precision': 0.2971648092198724, 'recall': 0.3676692659982671, 'f1-score': 0.3286786022528604, 'support': 40395}, '2': {'precision': 0.3507251503360453, 'recall': 0.6061704404026289, 'f1-score': 0.44435196670801486, 'support': 45799}, 'accuracy': 0.3335683544117863, 'macro avg': {'precision': 0.34904984507860887, 'recall': 0.3433200376979049, 'f1-score': 0.2904796592987488, 'support': 136158}, 'weighted avg': {'precision': 0.3526450085044452, 'recall': 0.3335683544117863, 'f1-score': 0.28308821813857105, 'support': 136158}}
[[ 2804 19126 28034]
 [ 2183 14852 23360]
 [ 2036 16001 27762]]
training model: results/EXC/W4/deepVOL_L2/h10
Epoch 1/50
1601/1601 - 43s - loss: 2.3983 - accuracy10: 0.5870 - val_loss: 2.2841 - val_accuracy10: 0.7357 - 43s/epoch - 27ms/step
Epoch 2/50
1601/1601 - 39s - loss: 2.1870 - accuracy10: 0.6272 - val_loss: 2.1614 - val_accuracy10: 0.7359 - 39s/epoch - 24ms/step
Epoch 3/50
1601/1601 - 40s - loss: 2.1301 - accuracy10: 0.6422 - val_loss: 2.1123 - val_accuracy10: 0.7432 - 40s/epoch - 25ms/step
Epoch 4/50
1601/1601 - 40s - loss: 2.0997 - accuracy10: 0.6489 - val_loss: 2.1326 - val_accuracy10: 0.7559 - 40s/epoch - 25ms/step
Epoch 5/50
1601/1601 - 40s - loss: 2.0740 - accuracy10: 0.6520 - val_loss: 2.0790 - val_accuracy10: 0.7505 - 40s/epoch - 25ms/step
Epoch 6/50
1601/1601 - 39s - loss: 2.0514 - accuracy10: 0.6541 - val_loss: 2.0778 - val_accuracy10: 0.7525 - 39s/epoch - 24ms/step
Epoch 7/50
1601/1601 - 40s - loss: 2.0340 - accuracy10: 0.6568 - val_loss: 2.0463 - val_accuracy10: 0.7471 - 40s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 40s - loss: 2.0201 - accuracy10: 0.6590 - val_loss: 2.0622 - val_accuracy10: 0.7511 - 40s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 40s - loss: 2.0093 - accuracy10: 0.6604 - val_loss: 2.0302 - val_accuracy10: 0.7504 - 40s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 40s - loss: 2.0013 - accuracy10: 0.6619 - val_loss: 2.0336 - val_accuracy10: 0.7520 - 40s/epoch - 25ms/step
Epoch 11/50
1601/1601 - 40s - loss: 1.9947 - accuracy10: 0.6623 - val_loss: 2.0229 - val_accuracy10: 0.7500 - 40s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 40s - loss: 1.9886 - accuracy10: 0.6632 - val_loss: 2.0172 - val_accuracy10: 0.7467 - 40s/epoch - 25ms/step
Epoch 13/50
1601/1601 - 41s - loss: 1.9807 - accuracy10: 0.6647 - val_loss: 2.0319 - val_accuracy10: 0.7505 - 41s/epoch - 26ms/step
Epoch 14/50
1601/1601 - 39s - loss: 1.9759 - accuracy10: 0.6651 - val_loss: 2.0317 - val_accuracy10: 0.7525 - 39s/epoch - 25ms/step
Epoch 15/50
1601/1601 - 39s - loss: 1.9696 - accuracy10: 0.6652 - val_loss: 2.0116 - val_accuracy10: 0.7536 - 39s/epoch - 24ms/step
Epoch 16/50
1601/1601 - 40s - loss: 1.9647 - accuracy10: 0.6665 - val_loss: 2.0005 - val_accuracy10: 0.7522 - 40s/epoch - 25ms/step
Epoch 17/50
1601/1601 - 40s - loss: 1.9623 - accuracy10: 0.6667 - val_loss: 2.0054 - val_accuracy10: 0.7510 - 40s/epoch - 25ms/step
Epoch 18/50
1601/1601 - 39s - loss: 1.9562 - accuracy10: 0.6674 - val_loss: 1.9906 - val_accuracy10: 0.7452 - 39s/epoch - 25ms/step
Epoch 19/50
1601/1601 - 39s - loss: 1.9526 - accuracy10: 0.6678 - val_loss: 1.9816 - val_accuracy10: 0.7488 - 39s/epoch - 25ms/step
Epoch 20/50
1601/1601 - 40s - loss: 1.9495 - accuracy10: 0.6683 - val_loss: 1.9928 - val_accuracy10: 0.7448 - 40s/epoch - 25ms/step
Epoch 21/50
1601/1601 - 40s - loss: 1.9441 - accuracy10: 0.6695 - val_loss: 2.0017 - val_accuracy10: 0.7486 - 40s/epoch - 25ms/step
Epoch 22/50
1601/1601 - 41s - loss: 1.9402 - accuracy10: 0.6694 - val_loss: 1.9960 - val_accuracy10: 0.7412 - 41s/epoch - 25ms/step
Epoch 23/50
1601/1601 - 39s - loss: 1.9387 - accuracy10: 0.6696 - val_loss: 1.9860 - val_accuracy10: 0.7444 - 39s/epoch - 24ms/step
Epoch 24/50
1601/1601 - 40s - loss: 1.9326 - accuracy10: 0.6703 - val_loss: 1.9963 - val_accuracy10: 0.7465 - 40s/epoch - 25ms/step
Epoch 25/50
1601/1601 - 40s - loss: 1.9313 - accuracy10: 0.6706 - val_loss: 1.9889 - val_accuracy10: 0.7459 - 40s/epoch - 25ms/step
Epoch 26/50
1601/1601 - 40s - loss: 1.9277 - accuracy10: 0.6711 - val_loss: 1.9804 - val_accuracy10: 0.7421 - 40s/epoch - 25ms/step
Epoch 27/50
1601/1601 - 40s - loss: 1.9224 - accuracy10: 0.6715 - val_loss: 1.9958 - val_accuracy10: 0.7431 - 40s/epoch - 25ms/step
Epoch 28/50
1601/1601 - 40s - loss: 1.9206 - accuracy10: 0.6715 - val_loss: 1.9745 - val_accuracy10: 0.7378 - 40s/epoch - 25ms/step
Epoch 29/50
1601/1601 - 39s - loss: 1.9164 - accuracy10: 0.6725 - val_loss: 1.9845 - val_accuracy10: 0.7367 - 39s/epoch - 24ms/step
Epoch 30/50
1601/1601 - 40s - loss: 1.9134 - accuracy10: 0.6725 - val_loss: 1.9882 - val_accuracy10: 0.7385 - 40s/epoch - 25ms/step
Epoch 31/50
1601/1601 - 39s - loss: 1.9100 - accuracy10: 0.6727 - val_loss: 2.0120 - val_accuracy10: 0.7422 - 39s/epoch - 24ms/step
Epoch 32/50
1601/1601 - 40s - loss: 1.9074 - accuracy10: 0.6734 - val_loss: 2.0061 - val_accuracy10: 0.7414 - 40s/epoch - 25ms/step
Epoch 33/50
1601/1601 - 40s - loss: 1.9046 - accuracy10: 0.6728 - val_loss: 2.0010 - val_accuracy10: 0.7356 - 40s/epoch - 25ms/step
Epoch 34/50
1601/1601 - 40s - loss: 1.9018 - accuracy10: 0.6736 - val_loss: 2.0050 - val_accuracy10: 0.7380 - 40s/epoch - 25ms/step
Epoch 35/50
1601/1601 - 39s - loss: 1.8973 - accuracy10: 0.6739 - val_loss: 2.0008 - val_accuracy10: 0.7447 - 39s/epoch - 25ms/step
Epoch 36/50
1601/1601 - 39s - loss: 1.8952 - accuracy10: 0.6743 - val_loss: 2.0087 - val_accuracy10: 0.7366 - 39s/epoch - 25ms/step
Epoch 37/50
1601/1601 - 40s - loss: 1.8918 - accuracy10: 0.6752 - val_loss: 2.0025 - val_accuracy10: 0.7373 - 40s/epoch - 25ms/step
Epoch 38/50
1601/1601 - 40s - loss: 1.8902 - accuracy10: 0.6749 - val_loss: 2.0104 - val_accuracy10: 0.7395 - 40s/epoch - 25ms/step
testing model: results/EXC/W4/deepVOL_L2/h10
Evaluating performance on  test set...
3782/3782 - 41s - 41s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59043926
{'0': {'precision': 0.43166436647380435, 'recall': 0.5593173709323819, 'f1-score': 0.4872690776588135, 'support': 116315}, '1': {'precision': 0.9074979828546673, 'recall': 0.771688459663327, 'f1-score': 0.8341012085430651, 'support': 730204}, '2': {'precision': 0.40586206720899787, 'recall': 0.6561313646208197, 'f1-score': 0.5015074934066834, 'support': 121433}, 'accuracy': 0.7316716118154619, 'macro avg': {'precision': 0.5816748055124898, 'recall': 0.6623790650721761, 'f1-score': 0.6076259265361873, 'support': 967952}, 'weighted avg': {'precision': 0.7873869223537947, 'recall': 0.7316716118154619, 'f1-score': 0.7506986928047249, 'support': 967952}}
[[ 65057  30009  21249]
 [ 71326 563490  95388]
 [ 14329  27428  79676]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.591001
{'0': {'precision': 0.4902729033038848, 'recall': 0.5473291338050766, 'f1-score': 0.517232298890015, 'support': 59213}, '1': {'precision': 0.8876265861455923, 'recall': 0.772201646090535, 'f1-score': 0.8259007740962917, 'support': 291600}, '2': {'precision': 0.44711949937199197, 'recall': 0.6825022480870052, 'f1-score': 0.5402871610277624, 'support': 58939}, 'accuracy': 0.7268030418399422, 'macro avg': {'precision': 0.6083396629404897, 'recall': 0.6673443426608722, 'f1-score': 0.6278067446713563, 'support': 409752}, 'weighted avg': {'precision': 0.766842426923782, 'recall': 0.7268030418399422, 'f1-score': 0.74021243782695, 'support': 409752}}
[[ 32409  16110  10694]
 [ 27379 225174  39047]
 [  6316  12397  40226]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5720705
{'0': {'precision': 0.4486216730038023, 'recall': 0.5516656925774401, 'f1-score': 0.49483617300131066, 'support': 17110}, '1': {'precision': 0.9032042193614246, 'recall': 0.7800078362229406, 'f1-score': 0.837097579564269, 'support': 102090}, '2': {'precision': 0.4247764627314214, 'recall': 0.6751385776624602, 'f1-score': 0.5214638701008859, 'support': 16958}, 'accuracy': 0.7382526182817022, 'macro avg': {'precision': 0.5922007850322161, 'recall': 0.6689373688209469, 'f1-score': 0.6177992075554886, 'support': 136158}, 'weighted avg': {'precision': 0.7864935944615986, 'recall': 0.7382526182817022, 'f1-score': 0.7547769732732521, 'support': 136158}}
[[ 9439  4818  2853]
 [ 9808 79631 12651]
 [ 1793  3716 11449]]
training model: results/EXC/W4/deepVOL_L2/h20
Epoch 1/50
1601/1601 - 42s - loss: 2.5489 - accuracy20: 0.5735 - val_loss: 2.3730 - val_accuracy20: 0.6988 - 42s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 40s - loss: 2.3458 - accuracy20: 0.6157 - val_loss: 2.3276 - val_accuracy20: 0.7048 - 40s/epoch - 25ms/step
Epoch 3/50
1601/1601 - 41s - loss: 2.2892 - accuracy20: 0.6260 - val_loss: 2.2941 - val_accuracy20: 0.7127 - 41s/epoch - 25ms/step
Epoch 4/50
1601/1601 - 39s - loss: 2.2597 - accuracy20: 0.6315 - val_loss: 2.2774 - val_accuracy20: 0.7204 - 39s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 40s - loss: 2.2331 - accuracy20: 0.6343 - val_loss: 2.2742 - val_accuracy20: 0.7236 - 40s/epoch - 25ms/step
Epoch 6/50
1601/1601 - 41s - loss: 2.2110 - accuracy20: 0.6350 - val_loss: 2.2230 - val_accuracy20: 0.7196 - 41s/epoch - 26ms/step
Epoch 7/50
1601/1601 - 39s - loss: 2.1926 - accuracy20: 0.6375 - val_loss: 2.2007 - val_accuracy20: 0.7195 - 39s/epoch - 24ms/step
Epoch 8/50
1601/1601 - 40s - loss: 2.1826 - accuracy20: 0.6382 - val_loss: 2.2067 - val_accuracy20: 0.7212 - 40s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 40s - loss: 2.1722 - accuracy20: 0.6399 - val_loss: 2.1882 - val_accuracy20: 0.7201 - 40s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 41s - loss: 2.1652 - accuracy20: 0.6403 - val_loss: 2.1866 - val_accuracy20: 0.7155 - 41s/epoch - 26ms/step
Epoch 11/50
1601/1601 - 39s - loss: 2.1572 - accuracy20: 0.6414 - val_loss: 2.1826 - val_accuracy20: 0.7171 - 39s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 39s - loss: 2.1497 - accuracy20: 0.6417 - val_loss: 2.1680 - val_accuracy20: 0.7158 - 39s/epoch - 25ms/step
Epoch 13/50
1601/1601 - 39s - loss: 2.1438 - accuracy20: 0.6430 - val_loss: 2.1703 - val_accuracy20: 0.7151 - 39s/epoch - 25ms/step
Epoch 14/50
1601/1601 - 40s - loss: 2.1400 - accuracy20: 0.6430 - val_loss: 2.1694 - val_accuracy20: 0.7124 - 40s/epoch - 25ms/step
Epoch 15/50
1601/1601 - 40s - loss: 2.1341 - accuracy20: 0.6439 - val_loss: 2.1508 - val_accuracy20: 0.7066 - 40s/epoch - 25ms/step
Epoch 16/50
1601/1601 - 41s - loss: 2.1303 - accuracy20: 0.6449 - val_loss: 2.1590 - val_accuracy20: 0.7119 - 41s/epoch - 26ms/step
Epoch 17/50
1601/1601 - 40s - loss: 2.1258 - accuracy20: 0.6452 - val_loss: 2.1483 - val_accuracy20: 0.7109 - 40s/epoch - 25ms/step
Epoch 18/50
1601/1601 - 40s - loss: 2.1217 - accuracy20: 0.6468 - val_loss: 2.1469 - val_accuracy20: 0.7063 - 40s/epoch - 25ms/step
Epoch 19/50
1601/1601 - 40s - loss: 2.1190 - accuracy20: 0.6466 - val_loss: 2.1694 - val_accuracy20: 0.7108 - 40s/epoch - 25ms/step
Epoch 20/50
1601/1601 - 40s - loss: 2.1149 - accuracy20: 0.6470 - val_loss: 2.1515 - val_accuracy20: 0.7092 - 40s/epoch - 25ms/step
Epoch 21/50
1601/1601 - 40s - loss: 2.1093 - accuracy20: 0.6478 - val_loss: 2.1550 - val_accuracy20: 0.7076 - 40s/epoch - 25ms/step
Epoch 22/50
1601/1601 - 39s - loss: 2.1072 - accuracy20: 0.6479 - val_loss: 2.1511 - val_accuracy20: 0.7078 - 39s/epoch - 24ms/step
Epoch 23/50
1601/1601 - 39s - loss: 2.1050 - accuracy20: 0.6485 - val_loss: 2.1383 - val_accuracy20: 0.7060 - 39s/epoch - 24ms/step
Epoch 24/50
1601/1601 - 40s - loss: 2.1000 - accuracy20: 0.6499 - val_loss: 2.1437 - val_accuracy20: 0.7016 - 40s/epoch - 25ms/step
Epoch 25/50
1601/1601 - 40s - loss: 2.0981 - accuracy20: 0.6506 - val_loss: 2.1534 - val_accuracy20: 0.7044 - 40s/epoch - 25ms/step
Epoch 26/50
1601/1601 - 39s - loss: 2.0944 - accuracy20: 0.6514 - val_loss: 2.1401 - val_accuracy20: 0.7054 - 39s/epoch - 24ms/step
Epoch 27/50
1601/1601 - 38s - loss: 2.0914 - accuracy20: 0.6520 - val_loss: 2.1497 - val_accuracy20: 0.7036 - 38s/epoch - 24ms/step
Epoch 28/50
1601/1601 - 38s - loss: 2.0884 - accuracy20: 0.6518 - val_loss: 2.1427 - val_accuracy20: 0.7048 - 38s/epoch - 24ms/step
Epoch 29/50
1601/1601 - 39s - loss: 2.0857 - accuracy20: 0.6523 - val_loss: 2.1494 - val_accuracy20: 0.7036 - 39s/epoch - 24ms/step
Epoch 30/50
1601/1601 - 41s - loss: 2.0819 - accuracy20: 0.6530 - val_loss: 2.1611 - val_accuracy20: 0.7045 - 41s/epoch - 26ms/step
Epoch 31/50
1601/1601 - 39s - loss: 2.0805 - accuracy20: 0.6534 - val_loss: 2.1487 - val_accuracy20: 0.7034 - 39s/epoch - 24ms/step
Epoch 32/50
1601/1601 - 40s - loss: 2.0767 - accuracy20: 0.6549 - val_loss: 2.1394 - val_accuracy20: 0.7028 - 40s/epoch - 25ms/step
Epoch 33/50
1601/1601 - 39s - loss: 2.0733 - accuracy20: 0.6549 - val_loss: 2.1467 - val_accuracy20: 0.7026 - 39s/epoch - 24ms/step
testing model: results/EXC/W4/deepVOL_L2/h20
Evaluating performance on  test set...
3782/3782 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65613306
{'0': {'precision': 0.4778160441778992, 'recall': 0.5207911308433595, 'f1-score': 0.49837887050473334, 'support': 154513}, '1': {'precision': 0.8398813495497757, 'recall': 0.7821365841354214, 'f1-score': 0.8099810935178002, 'support': 650178}, '2': {'precision': 0.4887512495748869, 'recall': 0.5809715731252412, 'f1-score': 0.5308862750365911, 'support': 163261}, 'accuracy': 0.7064885448865234, 'macro avg': {'precision': 0.6021495477675206, 'recall': 0.6279664293680074, 'f1-score': 0.6130820796863748, 'support': 967952}, 'weighted avg': {'precision': 0.7228614479627908, 'recall': 0.7064885448865234, 'f1-score': 0.7131664855160826, 'support': 967952}}
[[ 80469  49345  24699]
 [ 67133 508528  74517]
 [ 20808  47603  94850]]
Evaluating performance on  train set...
1601/1601 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66857016
{'0': {'precision': 0.539851368897975, 'recall': 0.5003776966903527, 'f1-score': 0.5193655771799148, 'support': 78105}, '1': {'precision': 0.8058786884311419, 'recall': 0.7794821909607902, 'f1-score': 0.7924606868662603, 'support': 253916}, '2': {'precision': 0.5127017513268454, 'recall': 0.6052282872985039, 'f1-score': 0.5551359962239661, 'support': 77731}, 'accuracy': 0.6932241941467033, 'macro avg': {'precision': 0.6194772695519873, 'recall': 0.6283627249832157, 'f1-score': 0.6223207534233804, 'support': 409752}, 'weighted avg': {'precision': 0.6995533982795574, 'recall': 0.6932241941467033, 'f1-score': 0.6953834814581885, 'support': 409752}}
[[ 39082  26372  12651]
 [ 23930 197923  32063]
 [  9382  21304  47045]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6452703
{'0': {'precision': 0.5092133238837704, 'recall': 0.5008059246351557, 'f1-score': 0.5049746326678527, 'support': 22955}, '1': {'precision': 0.8314704261033767, 'recall': 0.7832331624535973, 'f1-score': 0.806631280116969, 'support': 90512}, '2': {'precision': 0.4855054553158434, 'recall': 0.6059671235291525, 'f1-score': 0.5390888418411354, 'support': 22691}, 'accuracy': 0.7060767637597497, 'macro avg': {'precision': 0.6087297351009968, 'recall': 0.6300020702059684, 'f1-score': 0.6168982515419857, 'support': 136158}, 'weighted avg': {'precision': 0.7194850639976541, 'recall': 0.7060767637597497, 'f1-score': 0.7111882374084142, 'support': 136158}}
[[11496  7996  3463]
 [ 8512 70892 11108]
 [ 2568  6373 13750]]
training model: results/EXC/W4/deepVOL_L2/h30
Epoch 1/50
1601/1601 - 41s - loss: 2.6856 - accuracy30: 0.5536 - val_loss: 2.4930 - val_accuracy30: 0.6519 - 41s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 2.4833 - accuracy30: 0.5966 - val_loss: 2.5042 - val_accuracy30: 0.6746 - 39s/epoch - 24ms/step
Epoch 3/50
1601/1601 - 38s - loss: 2.4395 - accuracy30: 0.6056 - val_loss: 2.4738 - val_accuracy30: 0.6727 - 38s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 39s - loss: 2.4092 - accuracy30: 0.6097 - val_loss: 2.4850 - val_accuracy30: 0.6733 - 39s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 38s - loss: 2.3838 - accuracy30: 0.6126 - val_loss: 2.4652 - val_accuracy30: 0.6765 - 38s/epoch - 24ms/step
Epoch 6/50
1601/1601 - 38s - loss: 2.3620 - accuracy30: 0.6141 - val_loss: 2.4240 - val_accuracy30: 0.6773 - 38s/epoch - 24ms/step
Epoch 7/50
1601/1601 - 41s - loss: 2.3468 - accuracy30: 0.6151 - val_loss: 2.4168 - val_accuracy30: 0.6796 - 41s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 40s - loss: 2.3337 - accuracy30: 0.6171 - val_loss: 2.4176 - val_accuracy30: 0.6811 - 40s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 39s - loss: 2.3247 - accuracy30: 0.6177 - val_loss: 2.3931 - val_accuracy30: 0.6808 - 39s/epoch - 24ms/step
Epoch 10/50
1601/1601 - 39s - loss: 2.3163 - accuracy30: 0.6193 - val_loss: 2.3805 - val_accuracy30: 0.6809 - 39s/epoch - 24ms/step
Epoch 11/50
1601/1601 - 38s - loss: 2.3072 - accuracy30: 0.6193 - val_loss: 2.3647 - val_accuracy30: 0.6771 - 38s/epoch - 24ms/step
Epoch 12/50
1601/1601 - 39s - loss: 2.3008 - accuracy30: 0.6207 - val_loss: 2.3673 - val_accuracy30: 0.6801 - 39s/epoch - 24ms/step
Epoch 13/50
1601/1601 - 38s - loss: 2.2956 - accuracy30: 0.6213 - val_loss: 2.3661 - val_accuracy30: 0.6789 - 38s/epoch - 24ms/step
Epoch 14/50
1601/1601 - 38s - loss: 2.2898 - accuracy30: 0.6223 - val_loss: 2.3671 - val_accuracy30: 0.6803 - 38s/epoch - 24ms/step
Epoch 15/50
1601/1601 - 39s - loss: 2.2861 - accuracy30: 0.6229 - val_loss: 2.3609 - val_accuracy30: 0.6815 - 39s/epoch - 24ms/step
Epoch 16/50
1601/1601 - 38s - loss: 2.2828 - accuracy30: 0.6232 - val_loss: 2.3593 - val_accuracy30: 0.6812 - 38s/epoch - 24ms/step
Epoch 17/50
1601/1601 - 39s - loss: 2.2777 - accuracy30: 0.6245 - val_loss: 2.3491 - val_accuracy30: 0.6776 - 39s/epoch - 24ms/step
Epoch 18/50
1601/1601 - 39s - loss: 2.2726 - accuracy30: 0.6250 - val_loss: 2.3471 - val_accuracy30: 0.6774 - 39s/epoch - 24ms/step
Epoch 19/50
1601/1601 - 39s - loss: 2.2701 - accuracy30: 0.6250 - val_loss: 2.3510 - val_accuracy30: 0.6786 - 39s/epoch - 24ms/step
Epoch 20/50
1601/1601 - 39s - loss: 2.2650 - accuracy30: 0.6262 - val_loss: 2.3470 - val_accuracy30: 0.6767 - 39s/epoch - 25ms/step
Epoch 21/50
1601/1601 - 39s - loss: 2.2615 - accuracy30: 0.6265 - val_loss: 2.3592 - val_accuracy30: 0.6760 - 39s/epoch - 24ms/step
Epoch 22/50
1601/1601 - 39s - loss: 2.2591 - accuracy30: 0.6269 - val_loss: 2.3340 - val_accuracy30: 0.6734 - 39s/epoch - 24ms/step
Epoch 23/50
1601/1601 - 39s - loss: 2.2553 - accuracy30: 0.6276 - val_loss: 2.3592 - val_accuracy30: 0.6781 - 39s/epoch - 24ms/step
Epoch 24/50
1601/1601 - 41s - loss: 2.2501 - accuracy30: 0.6282 - val_loss: 2.3481 - val_accuracy30: 0.6754 - 41s/epoch - 26ms/step
Epoch 25/50
1601/1601 - 40s - loss: 2.2467 - accuracy30: 0.6291 - val_loss: 2.3502 - val_accuracy30: 0.6739 - 40s/epoch - 25ms/step
Epoch 26/50
1601/1601 - 39s - loss: 2.2440 - accuracy30: 0.6293 - val_loss: 2.3519 - val_accuracy30: 0.6738 - 39s/epoch - 25ms/step
Epoch 27/50
1601/1601 - 39s - loss: 2.2414 - accuracy30: 0.6299 - val_loss: 2.3649 - val_accuracy30: 0.6755 - 39s/epoch - 24ms/step
Epoch 28/50
1601/1601 - 38s - loss: 2.2390 - accuracy30: 0.6311 - val_loss: 2.3771 - val_accuracy30: 0.6726 - 38s/epoch - 24ms/step
Epoch 29/50
1601/1601 - 40s - loss: 2.2342 - accuracy30: 0.6315 - val_loss: 2.3827 - val_accuracy30: 0.6768 - 40s/epoch - 25ms/step
Epoch 30/50
1601/1601 - 39s - loss: 2.2329 - accuracy30: 0.6322 - val_loss: 2.3750 - val_accuracy30: 0.6763 - 39s/epoch - 25ms/step
Epoch 31/50
1601/1601 - 38s - loss: 2.2287 - accuracy30: 0.6321 - val_loss: 2.3794 - val_accuracy30: 0.6733 - 38s/epoch - 24ms/step
Epoch 32/50
1601/1601 - 40s - loss: 2.2252 - accuracy30: 0.6333 - val_loss: 2.3901 - val_accuracy30: 0.6727 - 40s/epoch - 25ms/step
testing model: results/EXC/W4/deepVOL_L2/h30
Evaluating performance on  test set...
3782/3782 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71800286
{'0': {'precision': 0.5193705979721353, 'recall': 0.4269768774344255, 'f1-score': 0.4686634495603691, 'support': 181511}, '1': {'precision': 0.7775637376743783, 'recall': 0.7842719633359319, 'f1-score': 0.7809034442870435, 'support': 593933}, '2': {'precision': 0.501757149230223, 'recall': 0.5725632181519729, 'f1-score': 0.5348268483339883, 'support': 192508}, 'accuracy': 0.6751667438054779, 'macro avg': {'precision': 0.5995638282922454, 'recall': 0.5946040196407767, 'f1-score': 0.594797914060467, 'support': 967952}, 'weighted avg': {'precision': 0.6742942886637855, 'recall': 0.6751667438054779, 'f1-score': 0.6734118465460769, 'support': 967952}}
[[ 77501  70276  33734]
 [ 52411 465805  75717]
 [ 19309  62976 110223]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74739075
{'0': {'precision': 0.5710364270346465, 'recall': 0.4208126489820019, 'f1-score': 0.4845482187486229, 'support': 91454}, '1': {'precision': 0.7336538260560583, 'recall': 0.77248558475285, 'f1-score': 0.752569119113217, 'support': 227190}, '2': {'precision': 0.5224156987454189, 'recall': 0.5914189752820828, 'f1-score': 0.5547799227799228, 'support': 91108}, 'accuracy': 0.6537344540112068, 'macro avg': {'precision': 0.6090353172787079, 'recall': 0.5949057363389781, 'f1-score': 0.5972990868805875, 'support': 409752}, 'weighted avg': {'precision': 0.6503900594042251, 'recall': 0.6537344540112068, 'f1-score': 0.6487703297931469, 'support': 409752}}
[[ 38485  36037  16932]
 [ 19362 175501  32327]
 [  9548  27677  53883]]
Evaluating performance on  val set...
532/532 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71535736
{'0': {'precision': 0.552738141149248, 'recall': 0.42216494845360825, 'f1-score': 0.47870741482965934, 'support': 27160}, '1': {'precision': 0.7672263903775158, 'recall': 0.7844722614582826, 'f1-score': 0.7757534889881633, 'support': 82124}, '2': {'precision': 0.501621931052029, 'recall': 0.5869241646200789, 'f1-score': 0.5409307589423505, 'support': 26874}, 'accuracy': 0.6732105348198416, 'macro avg': {'precision': 0.6071954875262643, 'recall': 0.5978537915106567, 'f1-score': 0.5984638875867244, 'support': 136158}, 'weighted avg': {'precision': 0.6720182124595611, 'recall': 0.6732105348198416, 'f1-score': 0.6701526618506015, 'support': 136158}}
[[11466 11141  4553]
 [ 6582 64424 11118]
 [ 2696  8405 15773]]
training model: results/EXC/W4/deepVOL_L2/h50
Epoch 1/50
1601/1601 - 41s - loss: 2.8532 - accuracy50: 0.5268 - val_loss: 2.7680 - val_accuracy50: 0.5993 - 41s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 2.6878 - accuracy50: 0.5600 - val_loss: 2.7729 - val_accuracy50: 0.6017 - 39s/epoch - 24ms/step
Epoch 3/50
1601/1601 - 38s - loss: 2.6534 - accuracy50: 0.5677 - val_loss: 2.7322 - val_accuracy50: 0.6053 - 38s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 39s - loss: 2.6352 - accuracy50: 0.5720 - val_loss: 2.7417 - val_accuracy50: 0.6069 - 39s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 38s - loss: 2.6214 - accuracy50: 0.5746 - val_loss: 2.7148 - val_accuracy50: 0.6067 - 38s/epoch - 24ms/step
Epoch 6/50
1601/1601 - 39s - loss: 2.6081 - accuracy50: 0.5763 - val_loss: 2.6949 - val_accuracy50: 0.6098 - 39s/epoch - 24ms/step
Epoch 7/50
1601/1601 - 39s - loss: 2.5951 - accuracy50: 0.5776 - val_loss: 2.6768 - val_accuracy50: 0.6100 - 39s/epoch - 24ms/step
Epoch 8/50
1601/1601 - 39s - loss: 2.5798 - accuracy50: 0.5787 - val_loss: 2.6712 - val_accuracy50: 0.6089 - 39s/epoch - 24ms/step
Epoch 9/50
1601/1601 - 40s - loss: 2.5680 - accuracy50: 0.5807 - val_loss: 2.6789 - val_accuracy50: 0.6089 - 40s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 41s - loss: 2.5604 - accuracy50: 0.5816 - val_loss: 2.6632 - val_accuracy50: 0.6101 - 41s/epoch - 25ms/step
Epoch 11/50
1601/1601 - 40s - loss: 2.5539 - accuracy50: 0.5829 - val_loss: 2.6518 - val_accuracy50: 0.6115 - 40s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 39s - loss: 2.5481 - accuracy50: 0.5832 - val_loss: 2.6546 - val_accuracy50: 0.6097 - 39s/epoch - 24ms/step
Epoch 13/50
1601/1601 - 41s - loss: 2.5440 - accuracy50: 0.5846 - val_loss: 2.6653 - val_accuracy50: 0.6093 - 41s/epoch - 26ms/step
Epoch 14/50
1601/1601 - 38s - loss: 2.5397 - accuracy50: 0.5851 - val_loss: 2.6502 - val_accuracy50: 0.6097 - 38s/epoch - 24ms/step
Epoch 15/50
1601/1601 - 39s - loss: 2.5359 - accuracy50: 0.5861 - val_loss: 2.6653 - val_accuracy50: 0.6083 - 39s/epoch - 24ms/step
Epoch 16/50
1601/1601 - 38s - loss: 2.5310 - accuracy50: 0.5869 - val_loss: 2.6534 - val_accuracy50: 0.6093 - 38s/epoch - 24ms/step
Epoch 17/50
1601/1601 - 38s - loss: 2.5276 - accuracy50: 0.5874 - val_loss: 2.6543 - val_accuracy50: 0.6088 - 38s/epoch - 24ms/step
Epoch 18/50
1601/1601 - 39s - loss: 2.5240 - accuracy50: 0.5873 - val_loss: 2.6603 - val_accuracy50: 0.6100 - 39s/epoch - 24ms/step
Epoch 19/50
1601/1601 - 39s - loss: 2.5210 - accuracy50: 0.5878 - val_loss: 2.6673 - val_accuracy50: 0.6087 - 39s/epoch - 24ms/step
Epoch 20/50
1601/1601 - 38s - loss: 2.5178 - accuracy50: 0.5887 - val_loss: 2.6556 - val_accuracy50: 0.6093 - 38s/epoch - 24ms/step
Epoch 21/50
1601/1601 - 38s - loss: 2.5129 - accuracy50: 0.5892 - val_loss: 2.6554 - val_accuracy50: 0.6064 - 38s/epoch - 24ms/step
Epoch 22/50
1601/1601 - 38s - loss: 2.5118 - accuracy50: 0.5897 - val_loss: 2.6740 - val_accuracy50: 0.6068 - 38s/epoch - 24ms/step
Epoch 23/50
1601/1601 - 39s - loss: 2.5093 - accuracy50: 0.5904 - val_loss: 2.6676 - val_accuracy50: 0.6088 - 39s/epoch - 24ms/step
Epoch 24/50
1601/1601 - 39s - loss: 2.5052 - accuracy50: 0.5903 - val_loss: 2.6566 - val_accuracy50: 0.6069 - 39s/epoch - 24ms/step
testing model: results/EXC/W4/deepVOL_L2/h50
Evaluating performance on  test set...
3782/3782 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82290184
{'0': {'precision': 0.570843545907105, 'recall': 0.33725327948841327, 'f1-score': 0.42400513369951465, 'support': 222367}, '1': {'precision': 0.651418884566904, 'recall': 0.8526995178061262, 'f1-score': 0.7385915468937201, 'support': 507887}, '2': {'precision': 0.5659583139264089, 'recall': 0.4089601090459322, 'f1-score': 0.4748179300441071, 'support': 237698}, 'accuracy': 0.625318197596575, 'macro avg': {'precision': 0.596073581466806, 'recall': 0.5329709687801573, 'f1-score': 0.5458048702124473, 'support': 967952}, 'weighted avg': {'precision': 0.6119219848736671, 'recall': 0.625318197596575, 'f1-score': 0.6015474598721785, 'support': 967952}}
[[ 74994 112551  34822]
 [ 35083 433075  39729]
 [ 21297 119192  97209]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8717338
{'0': {'precision': 0.6217356013551666, 'recall': 0.31679598644165324, 'f1-score': 0.41972661484856605, 'support': 111223}, '1': {'precision': 0.5832181886697652, 'recall': 0.8427351978688988, 'f1-score': 0.6893612375680958, 'support': 187321}, '2': {'precision': 0.5760138824842851, 'recall': 0.42683080353931374, 'f1-score': 0.4903261127811005, 'support': 111208}, 'accuracy': 0.5870965852515668, 'macro avg': {'precision': 0.5936558908364057, 'recall': 0.5287873292832886, 'f1-score': 0.5331379883992541, 'support': 409752}, 'weighted avg': {'precision': 0.5917180756961459, 'recall': 0.5870965852515668, 'f1-score': 0.5621529022822487, 'support': 409752}}
[[ 35235  58558  17430]
 [ 11950 157862  17509]
 [  9487  54254  47467]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8351785
{'0': {'precision': 0.5940727921691634, 'recall': 0.32525019245573517, 'f1-score': 0.42035779202142926, 'support': 33774}, '1': {'precision': 0.6258403247631935, 'recall': 0.836400462962963, 'f1-score': 0.7159602464472584, 'support': 69120}, '2': {'precision': 0.5589909852917919, 'recall': 0.42502405002405, 'f1-score': 0.48288817542181844, 'support': 33264}, 'accuracy': 0.609108535671793, 'macro avg': {'precision': 0.5929680340747163, 'recall': 0.5288915684809161, 'f1-score': 0.5397354046301687, 'support': 136158}, 'weighted avg': {'precision': 0.601628797904636, 'recall': 0.609108535671793, 'f1-score': 0.5856955049971182, 'support': 136158}}
[[10985 18160  4629]
 [ 4783 57812  6525]
 [ 2723 16403 14138]]
training model: results/EXC/W4/deepVOL_L2/h100
Epoch 1/50
1601/1601 - 42s - loss: 3.0756 - accuracy100: 0.4629 - val_loss: 3.1315 - val_accuracy100: 0.4620 - 42s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 2.9624 - accuracy100: 0.4910 - val_loss: 3.1392 - val_accuracy100: 0.4572 - 39s/epoch - 25ms/step
Epoch 3/50
1601/1601 - 38s - loss: 2.9365 - accuracy100: 0.4958 - val_loss: 3.1344 - val_accuracy100: 0.4661 - 38s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 39s - loss: 2.9255 - accuracy100: 0.4987 - val_loss: 3.0997 - val_accuracy100: 0.4659 - 39s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 40s - loss: 2.9170 - accuracy100: 0.5011 - val_loss: 3.0756 - val_accuracy100: 0.4683 - 40s/epoch - 25ms/step
Epoch 6/50
1601/1601 - 38s - loss: 2.9107 - accuracy100: 0.5031 - val_loss: 3.0788 - val_accuracy100: 0.4702 - 38s/epoch - 24ms/step
Epoch 7/50
1601/1601 - 39s - loss: 2.9056 - accuracy100: 0.5048 - val_loss: 3.0760 - val_accuracy100: 0.4692 - 39s/epoch - 24ms/step
Epoch 8/50
1601/1601 - 39s - loss: 2.9015 - accuracy100: 0.5055 - val_loss: 3.0905 - val_accuracy100: 0.4696 - 39s/epoch - 24ms/step
Epoch 9/50
1601/1601 - 40s - loss: 2.8985 - accuracy100: 0.5065 - val_loss: 3.0682 - val_accuracy100: 0.4716 - 40s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 41s - loss: 2.8946 - accuracy100: 0.5068 - val_loss: 3.0691 - val_accuracy100: 0.4738 - 41s/epoch - 26ms/step
Epoch 11/50
1601/1601 - 40s - loss: 2.8908 - accuracy100: 0.5085 - val_loss: 3.0625 - val_accuracy100: 0.4733 - 40s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 41s - loss: 2.8877 - accuracy100: 0.5092 - val_loss: 3.0598 - val_accuracy100: 0.4749 - 41s/epoch - 25ms/step
Epoch 13/50
1601/1601 - 39s - loss: 2.8848 - accuracy100: 0.5108 - val_loss: 3.0648 - val_accuracy100: 0.4721 - 39s/epoch - 24ms/step
Epoch 14/50
1601/1601 - 39s - loss: 2.8827 - accuracy100: 0.5112 - val_loss: 3.0733 - val_accuracy100: 0.4723 - 39s/epoch - 24ms/step
Epoch 15/50
1601/1601 - 39s - loss: 2.8791 - accuracy100: 0.5121 - val_loss: 3.0718 - val_accuracy100: 0.4707 - 39s/epoch - 24ms/step
Epoch 16/50
1601/1601 - 39s - loss: 2.8762 - accuracy100: 0.5137 - val_loss: 3.0710 - val_accuracy100: 0.4719 - 39s/epoch - 24ms/step
Epoch 17/50
1601/1601 - 39s - loss: 2.8729 - accuracy100: 0.5148 - val_loss: 3.0917 - val_accuracy100: 0.4671 - 39s/epoch - 25ms/step
Epoch 18/50
1601/1601 - 39s - loss: 2.8692 - accuracy100: 0.5147 - val_loss: 3.0742 - val_accuracy100: 0.4728 - 39s/epoch - 24ms/step
Epoch 19/50
1601/1601 - 39s - loss: 2.8666 - accuracy100: 0.5161 - val_loss: 3.0697 - val_accuracy100: 0.4761 - 39s/epoch - 24ms/step
Epoch 20/50
1601/1601 - 39s - loss: 2.8635 - accuracy100: 0.5171 - val_loss: 3.0666 - val_accuracy100: 0.4715 - 39s/epoch - 24ms/step
Epoch 21/50
1601/1601 - 39s - loss: 2.8599 - accuracy100: 0.5179 - val_loss: 3.0693 - val_accuracy100: 0.4705 - 39s/epoch - 24ms/step
Epoch 22/50
1601/1601 - 40s - loss: 2.8569 - accuracy100: 0.5190 - val_loss: 3.0911 - val_accuracy100: 0.4656 - 40s/epoch - 25ms/step
testing model: results/EXC/W4/deepVOL_L2/h100
Evaluating performance on  test set...
3782/3782 - 36s - 36s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.000567
{'0': {'precision': 0.5635339513017252, 'recall': 0.26475981440835716, 'f1-score': 0.36026142061215516, 'support': 287944}, '1': {'precision': 0.46168433755710714, 'recall': 0.8809935027551608, 'f1-score': 0.6058652187438138, 'support': 364770}, '2': {'precision': 0.6013176195007686, 'recall': 0.26058406664171196, 'f1-score': 0.3636001487225793, 'support': 315238}, 'accuracy': 0.495625816156173, 'macro avg': {'precision': 0.5421786361198669, 'recall': 0.46877912793507664, 'f1-score': 0.4432422626928494, 'support': 967952}, 'weighted avg': {'precision': 0.5374574148516799, 'recall': 0.495625816156173, 'f1-score': 0.4539038650893183, 'support': 967952}}
[[ 76236 180852  30856]
 [ 19802 321360  23608]
 [ 39244 193848  82146]]
Evaluating performance on  train set...
1601/1601 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0496194
{'0': {'precision': 0.5587164734891055, 'recall': 0.2423565535004875, 'f1-score': 0.3380680520666819, 'support': 137438}, '1': {'precision': 0.40326325587930517, 'recall': 0.8548823078240537, 'f1-score': 0.5480170701901779, 'support': 134291}, '2': {'precision': 0.572864782276547, 'recall': 0.2716503771110612, 'f1-score': 0.3685402977299199, 'support': 138023}, 'accuracy': 0.4529715535250591, 'macro avg': {'precision': 0.5116148372149859, 'recall': 0.45629641281186745, 'f1-score': 0.4182084733289266, 'support': 409752}, 'weighted avg': {'precision': 0.5125344511383454, 'recall': 0.4529715535250591, 'f1-score': 0.4171405992562002, 'support': 409752}}
[[ 33309  87866  16263]
 [  7795 114803  11693]
 [ 18513  82016  37494]]
Evaluating performance on  val set...
532/532 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0224167
{'0': {'precision': 0.5771206821163096, 'recall': 0.24117217121191356, 'f1-score': 0.34018492863816485, 'support': 43782}, '1': {'precision': 0.43641690047862686, 'recall': 0.8509251810136765, 'f1-score': 0.5769377625047728, 'support': 49720}, '2': {'precision': 0.5632947700544986, 'recall': 0.2762331207801951, 'f1-score': 0.370686129549816, 'support': 42656}, 'accuracy': 0.47481602256202354, 'macro avg': {'precision': 0.5256107842164783, 'recall': 0.4561101576685951, 'f1-score': 0.42926960689758453, 'support': 136158}, 'weighted avg': {'precision': 0.5214093017498662, 'recall': 0.47481602256202354, 'f1-score': 0.43619405131869143, 'support': 136158}}
[[10559 28573  4650]
 [ 2927 42308  4485]
 [ 4810 26063 11783]]
training model: results/EXC/W4/deepVOL_L2/h200
Epoch 1/50
1601/1601 - 43s - loss: 3.2513 - accuracy200: 0.3994 - val_loss: 3.2765 - val_accuracy200: 0.3779 - 43s/epoch - 27ms/step
Epoch 2/50
1601/1601 - 39s - loss: 3.2055 - accuracy200: 0.4181 - val_loss: 3.3036 - val_accuracy200: 0.3621 - 39s/epoch - 24ms/step
Epoch 3/50
1601/1601 - 39s - loss: 3.1911 - accuracy200: 0.4248 - val_loss: 3.3034 - val_accuracy200: 0.3734 - 39s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 38s - loss: 3.1821 - accuracy200: 0.4272 - val_loss: 3.3166 - val_accuracy200: 0.3717 - 38s/epoch - 24ms/step
Epoch 5/50
1601/1601 - 38s - loss: 3.1742 - accuracy200: 0.4314 - val_loss: 3.3131 - val_accuracy200: 0.3770 - 38s/epoch - 24ms/step
Epoch 6/50
1601/1601 - 40s - loss: 3.1695 - accuracy200: 0.4329 - val_loss: 3.3103 - val_accuracy200: 0.3709 - 40s/epoch - 25ms/step
Epoch 7/50
1601/1601 - 39s - loss: 3.1675 - accuracy200: 0.4344 - val_loss: 3.3231 - val_accuracy200: 0.3685 - 39s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 40s - loss: 3.1636 - accuracy200: 0.4354 - val_loss: 3.3208 - val_accuracy200: 0.3679 - 40s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 40s - loss: 3.1591 - accuracy200: 0.4369 - val_loss: 3.3324 - val_accuracy200: 0.3663 - 40s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 40s - loss: 3.1574 - accuracy200: 0.4374 - val_loss: 3.3548 - val_accuracy200: 0.3676 - 40s/epoch - 25ms/step
Epoch 11/50
1601/1601 - 39s - loss: 3.1557 - accuracy200: 0.4381 - val_loss: 3.4014 - val_accuracy200: 0.3679 - 39s/epoch - 24ms/step
testing model: results/EXC/W4/deepVOL_L2/h200
Evaluating performance on  test set...
3782/3782 - 36s - 36s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945379
{'0': {'precision': 0.46376975071367216, 'recall': 0.16761214858020917, 'f1-score': 0.246232729986594, 'support': 318885}, '1': {'precision': 0.31964643357375677, 'recall': 0.656910251969722, 'f1-score': 0.43003959182011203, 'support': 297377}, '2': {'precision': 0.46659408260507784, 'recall': 0.3204811055190651, 'f1-score': 0.37997535604779786, 'support': 351690}, 'accuracy': 0.3734782303254707, 'macro avg': {'precision': 0.41667008896416896, 'recall': 0.3816678353563321, 'f1-score': 0.3520825592848347, 'support': 967952}, 'weighted avg': {'precision': 0.42051794649380575, 'recall': 0.3734782303254707, 'f1-score': 0.35129566421363306, 'support': 967952}}
[[ 53449 204256  61180]
 [ 34358 195350  67669]
 [ 27442 211538 112710]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035215
{'0': {'precision': 0.4654908197195316, 'recall': 0.11781020402189503, 'f1-score': 0.18803179219444394, 'support': 136652}, '1': {'precision': 0.3370825137968568, 'recall': 0.6508993561804465, 'f1-score': 0.4441514523239195, 'support': 135597}, '2': {'precision': 0.41588430452122965, 'recall': 0.3427779757532563, 'f1-score': 0.3758087986126337, 'support': 137503}, 'accuracy': 0.36971631621078116, 'macro avg': {'precision': 0.4061525460125393, 'recall': 0.3704958453185326, 'f1-score': 0.3359973477103324, 'support': 409752}, 'weighted avg': {'precision': 0.4063505941257357, 'recall': 0.36971631621078116, 'f1-score': 0.3358015633440585, 'support': 409752}}
[[16099 90393 30160]
 [11298 88260 36039]
 [ 7188 83182 47133]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928384
{'0': {'precision': 0.4967652893987751, 'recall': 0.12575334090313564, 'f1-score': 0.2007004826708951, 'support': 45796}, '1': {'precision': 0.3421975552453267, 'recall': 0.6565623570915268, 'f1-score': 0.44990598979317753, 'support': 45921}, '2': {'precision': 0.4191124033134017, 'recall': 0.3438266465651088, 'f1-score': 0.3777549784298941, 'support': 44441}, 'accuracy': 0.3759529370290398, 'macro avg': {'precision': 0.4193584159858345, 'recall': 0.3753807815199237, 'f1-score': 0.3427871502979889, 'support': 136158}, 'weighted avg': {'precision': 0.41929002661156767, 'recall': 0.3759529370290398, 'f1-score': 0.3425375024463619, 'support': 136158}}
[[ 5759 30836  9201]
 [ 3794 30150 11977]
 [ 2040 27121 15280]]
training model: results/EXC/W4/deepVOL_L2/h300
Epoch 1/50
1601/1601 - 41s - loss: 3.2783 - accuracy300: 0.3836 - val_loss: 3.3103 - val_accuracy300: 0.3636 - 41s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 3.2355 - accuracy300: 0.4062 - val_loss: 3.3023 - val_accuracy300: 0.3817 - 39s/epoch - 24ms/step
Epoch 3/50
1601/1601 - 39s - loss: 3.2126 - accuracy300: 0.4173 - val_loss: 3.2858 - val_accuracy300: 0.3887 - 39s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 40s - loss: 3.2033 - accuracy300: 0.4216 - val_loss: 3.2987 - val_accuracy300: 0.3836 - 40s/epoch - 25ms/step
Epoch 5/50
1601/1601 - 39s - loss: 3.1953 - accuracy300: 0.4245 - val_loss: 3.2928 - val_accuracy300: 0.3855 - 39s/epoch - 24ms/step
Epoch 6/50
1601/1601 - 39s - loss: 3.1891 - accuracy300: 0.4274 - val_loss: 3.2819 - val_accuracy300: 0.3908 - 39s/epoch - 24ms/step
Epoch 7/50
1601/1601 - 39s - loss: 3.1841 - accuracy300: 0.4297 - val_loss: 3.2938 - val_accuracy300: 0.3895 - 39s/epoch - 24ms/step
Epoch 8/50
1601/1601 - 40s - loss: 3.1816 - accuracy300: 0.4300 - val_loss: 3.2971 - val_accuracy300: 0.3913 - 40s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 39s - loss: 3.1773 - accuracy300: 0.4330 - val_loss: 3.2827 - val_accuracy300: 0.3911 - 39s/epoch - 24ms/step
Epoch 10/50
1601/1601 - 39s - loss: 3.1741 - accuracy300: 0.4343 - val_loss: 3.2914 - val_accuracy300: 0.3908 - 39s/epoch - 24ms/step
Epoch 11/50
1601/1601 - 40s - loss: 3.1704 - accuracy300: 0.4362 - val_loss: 3.2935 - val_accuracy300: 0.3917 - 40s/epoch - 25ms/step
Epoch 12/50
1601/1601 - 41s - loss: 3.1673 - accuracy300: 0.4375 - val_loss: 3.2989 - val_accuracy300: 0.3891 - 41s/epoch - 26ms/step
Epoch 13/50
1601/1601 - 39s - loss: 3.1636 - accuracy300: 0.4395 - val_loss: 3.2995 - val_accuracy300: 0.3868 - 39s/epoch - 24ms/step
Epoch 14/50
1601/1601 - 41s - loss: 3.1588 - accuracy300: 0.4410 - val_loss: 3.2976 - val_accuracy300: 0.3862 - 41s/epoch - 26ms/step
Epoch 15/50
1601/1601 - 40s - loss: 3.1556 - accuracy300: 0.4426 - val_loss: 3.3234 - val_accuracy300: 0.3866 - 40s/epoch - 25ms/step
Epoch 16/50
1601/1601 - 39s - loss: 3.1525 - accuracy300: 0.4445 - val_loss: 3.3184 - val_accuracy300: 0.3850 - 39s/epoch - 25ms/step
testing model: results/EXC/W4/deepVOL_L2/h300
Evaluating performance on  test set...
3782/3782 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0836036
{'0': {'precision': 0.42459942502161196, 'recall': 0.27304548495631853, 'f1-score': 0.3323609310669738, 'support': 309399}, '1': {'precision': 0.37975849673906026, 'recall': 0.279066530427603, 'f1-score': 0.321717851372888, 'support': 316111}, '2': {'precision': 0.40366093837631567, 'recall': 0.6326385198077339, 'f1-score': 0.49285263355457354, 'support': 342442}, 'accuracy': 0.402228622906921, 'macro avg': {'precision': 0.40267295337899595, 'recall': 0.39491684506388514, 'f1-score': 0.3823104719981451, 'support': 967952}, 'weighted avg': {'precision': 0.4025477861757661, 'recall': 0.402228622906921, 'f1-score': 0.385663889290193, 'support': 967952}}
[[ 84480  74886 150033]
 [ 57877  88216 170018]
 [ 56607  69193 216642]]
Evaluating performance on  train set...
1601/1601 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015443
{'0': {'precision': 0.42495334978631194, 'recall': 0.20562877739750965, 'f1-score': 0.27714911032377737, 'support': 137330}, '1': {'precision': 0.38811630847029077, 'recall': 0.27497760768667046, 'f1-score': 0.32189495758268993, 'support': 135091}, '2': {'precision': 0.3717935772590866, 'recall': 0.6702929418703716, 'f1-score': 0.4782915930582978, 'support': 137331}, 'accuracy': 0.384227532751518, 'macro avg': {'precision': 0.3949544118385631, 'recall': 0.3836331089848506, 'f1-score': 0.359111886988255, 'support': 409752}, 'weighted avg': {'precision': 0.3949917206317038, 'recall': 0.384227532751518, 'f1-score': 0.3593155416004232, 'support': 409752}}
[[28239 32259 76832]
 [19239 37147 78705]
 [18974 26305 92052]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938001
{'0': {'precision': 0.44510525415026525, 'recall': 0.22530971151347137, 'f1-score': 0.29917749913723685, 'support': 46172}, '1': {'precision': 0.40014311938023084, 'recall': 0.2805383474391414, 'f1-score': 0.32983266012694745, 'support': 45844}, '2': {'precision': 0.3727819455638911, 'recall': 0.6810520592632867, 'f1-score': 0.48182903667850013, 'support': 44142}, 'accuracy': 0.3916552828331791, 'macro avg': {'precision': 0.4060101063647957, 'recall': 0.39563337273863314, 'f1-score': 0.3702797319808948, 'support': 136158}, 'weighted avg': {'precision': 0.4065196433597338, 'recall': 0.3916552828331791, 'f1-score': 0.3687140623252885, 'support': 136158}}
[[10403 10982 24787]
 [ 7188 12861 25795]
 [ 5781  8298 30063]]
training model: results/EXC/W4/deepVOL_L2/h500
Epoch 1/50
1601/1601 - 42s - loss: 3.2689 - accuracy500: 0.3899 - val_loss: 3.3327 - val_accuracy500: 0.3510 - 42s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 3.2475 - accuracy500: 0.4023 - val_loss: 3.3590 - val_accuracy500: 0.3588 - 39s/epoch - 25ms/step
Epoch 3/50
1601/1601 - 39s - loss: 3.2366 - accuracy500: 0.4089 - val_loss: 3.3660 - val_accuracy500: 0.3616 - 39s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 41s - loss: 3.2288 - accuracy500: 0.4140 - val_loss: 3.4005 - val_accuracy500: 0.3558 - 41s/epoch - 25ms/step
Epoch 5/50
1601/1601 - 40s - loss: 3.2196 - accuracy500: 0.4180 - val_loss: 3.4096 - val_accuracy500: 0.3560 - 40s/epoch - 25ms/step
Epoch 6/50
1601/1601 - 41s - loss: 3.2169 - accuracy500: 0.4191 - val_loss: 3.3843 - val_accuracy500: 0.3593 - 41s/epoch - 25ms/step
Epoch 7/50
1601/1601 - 40s - loss: 3.2083 - accuracy500: 0.4233 - val_loss: 3.3930 - val_accuracy500: 0.3671 - 40s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 39s - loss: 3.2066 - accuracy500: 0.4243 - val_loss: 3.4047 - val_accuracy500: 0.3668 - 39s/epoch - 25ms/step
Epoch 9/50
1601/1601 - 39s - loss: 3.1979 - accuracy500: 0.4299 - val_loss: 3.4390 - val_accuracy500: 0.3614 - 39s/epoch - 24ms/step
Epoch 10/50
1601/1601 - 39s - loss: 3.1963 - accuracy500: 0.4293 - val_loss: 3.4414 - val_accuracy500: 0.3621 - 39s/epoch - 24ms/step
Epoch 11/50
1601/1601 - 39s - loss: 3.1917 - accuracy500: 0.4312 - val_loss: 3.4254 - val_accuracy500: 0.3643 - 39s/epoch - 24ms/step
testing model: results/EXC/W4/deepVOL_L2/h500
Evaluating performance on  test set...
3782/3782 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943955
{'0': {'precision': 0.41202057563118394, 'recall': 0.17761514405728984, 'f1-score': 0.24822476472071428, 'support': 324246}, '1': {'precision': 0.29202920292029205, 'recall': 0.02092409997706948, 'f1-score': 0.03905022366951743, 'support': 279104}, '2': {'precision': 0.3920193224998979, 'recall': 0.8689502526042095, 'f1-score': 0.5402910522783917, 'support': 364602}, 'accuracy': 0.3928417938079574, 'macro avg': {'precision': 0.36535636701712465, 'recall': 0.3558298322128563, 'f1-score': 0.2758553468895411, 'support': 967952}, 'weighted avg': {'precision': 0.36988773331743907, 'recall': 0.3928417938079574, 'f1-score': 0.2979240281868273, 'support': 967952}}
[[ 57591   7639 259016]
 [ 40924   5840 232340]
 [ 41262   6519 316821]]
Evaluating performance on  train set...
1601/1601 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125447
{'0': {'precision': 0.39859962881727684, 'recall': 0.10245235152540168, 'f1-score': 0.16300691701309228, 'support': 138357}, '1': {'precision': 0.3268200089325592, 'recall': 0.021907042886011526, 'f1-score': 0.04106168371140384, 'support': 133610}, '2': {'precision': 0.3432812936364084, 'recall': 0.9099539137061363, 'f1-score': 0.4985020446543768, 'support': 137785}, 'accuracy': 0.34772252484429605, 'macro avg': {'precision': 0.35623364379541483, 'recall': 0.3447711027058498, 'f1-score': 0.23419021512629098, 'support': 409752}, 'weighted avg': {'precision': 0.3565924834569294, 'recall': 0.34772252484429605, 'f1-score': 0.23605864962358786, 'support': 409752}}
[[ 14175   3395 120787]
 [ 11614   2927 119069]
 [  9773   2634 125378]]
Evaluating performance on  val set...
532/532 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1110598
{'0': {'precision': 0.4367527225649227, 'recall': 0.11965865464863963, 'f1-score': 0.18785109484269313, 'support': 47928}, '1': {'precision': 0.3011440107671602, 'recall': 0.020844978572759455, 'f1-score': 0.038991025529319503, 'support': 42936}, '2': {'precision': 0.34398400732997375, 'recall': 0.9117543162449773, 'f1-score': 0.4995131509715813, 'support': 45294}, 'accuracy': 0.3519954758442398, 'macro avg': {'precision': 0.36062691355401894, 'recall': 0.35075264982212545, 'f1-score': 0.24211842378119797, 'support': 136158}, 'weighted avg': {'precision': 0.36312971225630686, 'recall': 0.3519954758442398, 'f1-score': 0.2445863967291989, 'support': 136158}}
[[ 5735  1254 40939]
 [ 4222   895 37819]
 [ 3174   823 41297]]
training model: results/EXC/W4/deepVOL_L2/h1000
Epoch 1/50
1601/1601 - 41s - loss: 3.2420 - accuracy1000: 0.4133 - val_loss: 3.3224 - val_accuracy1000: 0.3523 - 41s/epoch - 26ms/step
Epoch 2/50
1601/1601 - 39s - loss: 3.2360 - accuracy1000: 0.4131 - val_loss: 3.4818 - val_accuracy1000: 0.3023 - 39s/epoch - 25ms/step
Epoch 3/50
1601/1601 - 38s - loss: 3.2330 - accuracy1000: 0.4130 - val_loss: 3.4628 - val_accuracy1000: 0.3169 - 38s/epoch - 24ms/step
Epoch 4/50
1601/1601 - 40s - loss: 3.2150 - accuracy1000: 0.4208 - val_loss: 3.5044 - val_accuracy1000: 0.3250 - 40s/epoch - 25ms/step
Epoch 5/50
1601/1601 - 40s - loss: 3.2101 - accuracy1000: 0.4230 - val_loss: 3.5497 - val_accuracy1000: 0.3319 - 40s/epoch - 25ms/step
Epoch 6/50
1601/1601 - 40s - loss: 3.2021 - accuracy1000: 0.4258 - val_loss: 3.5284 - val_accuracy1000: 0.3311 - 40s/epoch - 25ms/step
Epoch 7/50
1601/1601 - 40s - loss: 3.1992 - accuracy1000: 0.4282 - val_loss: 3.5629 - val_accuracy1000: 0.3238 - 40s/epoch - 25ms/step
Epoch 8/50
1601/1601 - 39s - loss: 3.1904 - accuracy1000: 0.4320 - val_loss: 3.6179 - val_accuracy1000: 0.3270 - 39s/epoch - 24ms/step
Epoch 9/50
1601/1601 - 41s - loss: 3.1829 - accuracy1000: 0.4383 - val_loss: 3.5938 - val_accuracy1000: 0.3284 - 41s/epoch - 25ms/step
Epoch 10/50
1601/1601 - 40s - loss: 3.1781 - accuracy1000: 0.4404 - val_loss: 3.5543 - val_accuracy1000: 0.3232 - 40s/epoch - 25ms/step
Epoch 11/50
1601/1601 - 42s - loss: 3.1696 - accuracy1000: 0.4446 - val_loss: 3.5100 - val_accuracy1000: 0.3287 - 42s/epoch - 26ms/step
testing model: results/EXC/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
3782/3782 - 41s - 41s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013103
{'0': {'precision': 0.3956921402798725, 'recall': 0.2356805589904968, 'f1-score': 0.295410127542976, 'support': 351777}, '1': {'precision': 0.2156379835776337, 'recall': 0.196623939083708, 'f1-score': 0.20569248536655182, 'support': 211963}, '2': {'precision': 0.4313949270554096, 'recall': 0.6031612124330796, 'f1-score': 0.5030189804274336, 'support': 404212}, 'accuracy': 0.38058602079441956, 'macro avg': {'precision': 0.34757501697097193, 'recall': 0.3451552368357615, 'f1-score': 0.3347071977789871, 'support': 967952}, 'weighted avg': {'precision': 0.3711730273807171, 'recall': 0.38058602079441956, 'f1-score': 0.36246011458106364, 'support': 967952}}
[[ 82907  71505 197365]
 [ 46301  41677 123985]
 [ 80316  80091 243805]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084821
{'0': {'precision': 0.3496130014812342, 'recall': 0.12100862181014688, 'f1-score': 0.17978854086761542, 'support': 138486}, '1': {'precision': 0.3512567979838175, 'recall': 0.157649947908915, 'f1-score': 0.21762578842479402, 'support': 134380}, '2': {'precision': 0.34259237762307343, 'recall': 0.7545987171807197, 'f1-score': 0.47123927617457395, 'support': 136886}, 'accuracy': 0.34468898260411174, 'macro avg': {'precision': 0.3478207256960417, 'recall': 0.3444190956332605, 'f1-score': 0.2895512018223278, 'support': 409752}, 'weighted avg': {'precision': 0.34780670952065545, 'recall': 0.34468898260411174, 'f1-score': 0.2895624887189059, 'support': 409752}}
[[ 16758  19913 101815]
 [ 16797  21185  96398]
 [ 14378  19214 103294]]
Evaluating performance on  val set...
532/532 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108998
{'0': {'precision': 0.4029539432887987, 'recall': 0.14299145812078656, 'f1-score': 0.2110796125679187, 'support': 49989}, '1': {'precision': 0.3200447819314642, 'recall': 0.16304617368447155, 'f1-score': 0.21603417118449156, 'support': 40326}, '2': {'precision': 0.35086590038314175, 'recall': 0.7491001897781558, 'f1-score': 0.4778942094935917, 'support': 45843}, 'accuracy': 0.35300165983636655, 'macro avg': {'precision': 0.35795487520113484, 'recall': 0.35171260719447134, 'f1-score': 0.30166933108200067, 'support': 136158}, 'weighted avg': {'precision': 0.3608611761225661, 'recall': 0.35300165983636655, 'f1-score': 0.3023807413861706, 'support': 136158}}
[[ 7148  7536 35305]
 [ 5522  6575 28229]
 [ 5069  6433 34341]]
training model: results/EXC/W4/deepVOL_L3/h10
Epoch 1/50
1601/1601 - 62s - loss: 2.6994 - accuracy10: 0.5027 - val_loss: 2.2710 - val_accuracy10: 0.6833 - 62s/epoch - 39ms/step
Epoch 2/50
1601/1601 - 58s - loss: 2.2133 - accuracy10: 0.6220 - val_loss: 2.0497 - val_accuracy10: 0.7199 - 58s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 59s - loss: 2.1254 - accuracy10: 0.6423 - val_loss: 1.9929 - val_accuracy10: 0.7061 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 59s - loss: 2.0830 - accuracy10: 0.6521 - val_loss: 1.9774 - val_accuracy10: 0.7219 - 59s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 58s - loss: 2.0584 - accuracy10: 0.6554 - val_loss: 1.9775 - val_accuracy10: 0.7259 - 58s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 59s - loss: 2.0370 - accuracy10: 0.6577 - val_loss: 1.9637 - val_accuracy10: 0.7173 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 2.0211 - accuracy10: 0.6595 - val_loss: 1.9284 - val_accuracy10: 0.7242 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 59s - loss: 2.0082 - accuracy10: 0.6608 - val_loss: 1.9221 - val_accuracy10: 0.7247 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 58s - loss: 1.9973 - accuracy10: 0.6621 - val_loss: 1.9176 - val_accuracy10: 0.7145 - 58s/epoch - 36ms/step
Epoch 10/50
1601/1601 - 59s - loss: 1.9888 - accuracy10: 0.6631 - val_loss: 1.8940 - val_accuracy10: 0.7160 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 1.9807 - accuracy10: 0.6645 - val_loss: 1.9009 - val_accuracy10: 0.6995 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 59s - loss: 1.9741 - accuracy10: 0.6657 - val_loss: 1.9029 - val_accuracy10: 0.7002 - 59s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 1.9673 - accuracy10: 0.6666 - val_loss: 1.9014 - val_accuracy10: 0.6997 - 59s/epoch - 37ms/step
Epoch 14/50
1601/1601 - 59s - loss: 1.9613 - accuracy10: 0.6668 - val_loss: 1.9004 - val_accuracy10: 0.6973 - 59s/epoch - 37ms/step
Epoch 15/50
1601/1601 - 59s - loss: 1.9564 - accuracy10: 0.6679 - val_loss: 1.8846 - val_accuracy10: 0.6860 - 59s/epoch - 37ms/step
Epoch 16/50
1601/1601 - 59s - loss: 1.9515 - accuracy10: 0.6684 - val_loss: 1.8941 - val_accuracy10: 0.6942 - 59s/epoch - 37ms/step
Epoch 17/50
1601/1601 - 59s - loss: 1.9461 - accuracy10: 0.6688 - val_loss: 1.8813 - val_accuracy10: 0.6914 - 59s/epoch - 37ms/step
Epoch 18/50
1601/1601 - 59s - loss: 1.9416 - accuracy10: 0.6695 - val_loss: 1.8713 - val_accuracy10: 0.6992 - 59s/epoch - 37ms/step
Epoch 19/50
1601/1601 - 59s - loss: 1.9374 - accuracy10: 0.6703 - val_loss: 1.8812 - val_accuracy10: 0.6998 - 59s/epoch - 37ms/step
Epoch 20/50
1601/1601 - 59s - loss: 1.9344 - accuracy10: 0.6702 - val_loss: 1.8711 - val_accuracy10: 0.7027 - 59s/epoch - 37ms/step
Epoch 21/50
1601/1601 - 59s - loss: 1.9299 - accuracy10: 0.6709 - val_loss: 1.8570 - val_accuracy10: 0.6969 - 59s/epoch - 37ms/step
Epoch 22/50
1601/1601 - 59s - loss: 1.9267 - accuracy10: 0.6705 - val_loss: 1.8694 - val_accuracy10: 0.6986 - 59s/epoch - 37ms/step
Epoch 23/50
1601/1601 - 58s - loss: 1.9229 - accuracy10: 0.6715 - val_loss: 1.8544 - val_accuracy10: 0.7027 - 58s/epoch - 36ms/step
Epoch 24/50
1601/1601 - 59s - loss: 1.9197 - accuracy10: 0.6723 - val_loss: 1.8661 - val_accuracy10: 0.6952 - 59s/epoch - 37ms/step
Epoch 25/50
1601/1601 - 59s - loss: 1.9165 - accuracy10: 0.6724 - val_loss: 1.8781 - val_accuracy10: 0.7074 - 59s/epoch - 37ms/step
Epoch 26/50
1601/1601 - 59s - loss: 1.9115 - accuracy10: 0.6728 - val_loss: 1.8713 - val_accuracy10: 0.7010 - 59s/epoch - 37ms/step
Epoch 27/50
1601/1601 - 59s - loss: 1.9088 - accuracy10: 0.6739 - val_loss: 1.8563 - val_accuracy10: 0.7014 - 59s/epoch - 37ms/step
Epoch 28/50
1601/1601 - 59s - loss: 1.9041 - accuracy10: 0.6732 - val_loss: 1.8597 - val_accuracy10: 0.7102 - 59s/epoch - 37ms/step
Epoch 29/50
1601/1601 - 59s - loss: 1.9028 - accuracy10: 0.6744 - val_loss: 1.8766 - val_accuracy10: 0.7045 - 59s/epoch - 37ms/step
Epoch 30/50
1601/1601 - 59s - loss: 1.8973 - accuracy10: 0.6742 - val_loss: 1.8712 - val_accuracy10: 0.7021 - 59s/epoch - 37ms/step
Epoch 31/50
1601/1601 - 59s - loss: 1.8964 - accuracy10: 0.6753 - val_loss: 1.8603 - val_accuracy10: 0.7101 - 59s/epoch - 37ms/step
Epoch 32/50
1601/1601 - 59s - loss: 1.8938 - accuracy10: 0.6748 - val_loss: 1.8642 - val_accuracy10: 0.7131 - 59s/epoch - 37ms/step
Epoch 33/50
1601/1601 - 59s - loss: 1.8906 - accuracy10: 0.6749 - val_loss: 1.8815 - val_accuracy10: 0.7131 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h10
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7196342
{'0': {'precision': 0.3600509193010333, 'recall': 0.6857327085930448, 'f1-score': 0.47217930275099007, 'support': 116315}, '1': {'precision': 0.9357627955609135, 'recall': 0.6410016926776627, 'f1-score': 0.7608308537813406, 'support': 730204}, '2': {'precision': 0.35356899184508916, 'recall': 0.7169385587113881, 'f1-score': 0.4735832891354901, 'support': 121433}, 'accuracy': 0.6559033919037308, 'macro avg': {'precision': 0.5497942355690121, 'recall': 0.6812243199940319, 'f1-score': 0.5688644818892736, 'support': 967952}, 'weighted avg': {'precision': 0.793543484010556, 'recall': 0.6559033919037308, 'f1-score': 0.6901085052808625, 'support': 967952}}
[[ 79761  16497  20057]
 [123027 468062 139115]
 [ 18739  15634  87060]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6848889
{'0': {'precision': 0.432654108824711, 'recall': 0.6547717562021853, 'f1-score': 0.5210280530824795, 'support': 59213}, '1': {'precision': 0.9212642362502146, 'recall': 0.6624382716049383, 'f1-score': 0.7707011706125968, 'support': 291600}, '2': {'precision': 0.40185942931633833, 'recall': 0.753168530175266, 'f1-score': 0.524087530917398, 'support': 58939}, 'accuracy': 0.6743810890489857, 'macro avg': {'precision': 0.5852592581304213, 'recall': 0.6901261859941298, 'f1-score': 0.6052722515374914, 'support': 409752}, 'weighted avg': {'precision': 0.7759439659620352, 'recall': 0.6743810890489857, 'f1-score': 0.6991479979171467, 'support': 409752}}
[[ 38771   9662  10780]
 [ 43140 193167  55293]
 [  7701   6847  44391]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6374396
{'0': {'precision': 0.41926367247173846, 'recall': 0.6416130917592051, 'f1-score': 0.5071372476555643, 'support': 17110}, '1': {'precision': 0.928820001797799, 'recall': 0.7084925066118131, 'f1-score': 0.8038318987791936, 'support': 102090}, '2': {'precision': 0.3893959689729292, 'recall': 0.7371152258521052, 'f1-score': 0.5095904930797611, 'support': 16958}, 'accuracy': 0.7036531088882034, 'macro avg': {'precision': 0.5791598810808222, 'recall': 0.6957402747410412, 'f1-score': 0.6068532131715063, 'support': 136158}, 'weighted avg': {'precision': 0.7976043439340449, 'recall': 0.7036531088882034, 'f1-score': 0.7299016762540663, 'support': 136158}}
[[10978  3296  2836]
 [12995 72330 16765]
 [ 2211  2247 12500]]
training model: results/EXC/W4/deepVOL_L3/h20
Epoch 1/50
1601/1601 - 61s - loss: 2.6652 - accuracy20: 0.5492 - val_loss: 2.4507 - val_accuracy20: 0.6665 - 61s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 58s - loss: 2.3337 - accuracy20: 0.6213 - val_loss: 2.2613 - val_accuracy20: 0.6794 - 58s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 58s - loss: 2.2632 - accuracy20: 0.6328 - val_loss: 2.2702 - val_accuracy20: 0.6802 - 58s/epoch - 36ms/step
Epoch 4/50
1601/1601 - 60s - loss: 2.2287 - accuracy20: 0.6362 - val_loss: 2.2247 - val_accuracy20: 0.6945 - 60s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 2.2035 - accuracy20: 0.6393 - val_loss: 2.1901 - val_accuracy20: 0.7044 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 59s - loss: 2.1836 - accuracy20: 0.6409 - val_loss: 2.1363 - val_accuracy20: 0.7100 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 2.1685 - accuracy20: 0.6425 - val_loss: 2.1381 - val_accuracy20: 0.7078 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 58s - loss: 2.1572 - accuracy20: 0.6438 - val_loss: 2.1408 - val_accuracy20: 0.7106 - 58s/epoch - 36ms/step
Epoch 9/50
1601/1601 - 58s - loss: 2.1485 - accuracy20: 0.6440 - val_loss: 2.1336 - val_accuracy20: 0.7168 - 58s/epoch - 36ms/step
Epoch 10/50
1601/1601 - 58s - loss: 2.1394 - accuracy20: 0.6456 - val_loss: 2.0985 - val_accuracy20: 0.7172 - 58s/epoch - 36ms/step
Epoch 11/50
1601/1601 - 59s - loss: 2.1319 - accuracy20: 0.6462 - val_loss: 2.0984 - val_accuracy20: 0.7080 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 59s - loss: 2.1253 - accuracy20: 0.6472 - val_loss: 2.0958 - val_accuracy20: 0.7134 - 59s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 2.1188 - accuracy20: 0.6476 - val_loss: 2.0839 - val_accuracy20: 0.7109 - 59s/epoch - 37ms/step
Epoch 14/50
1601/1601 - 58s - loss: 2.1152 - accuracy20: 0.6482 - val_loss: 2.0621 - val_accuracy20: 0.7069 - 58s/epoch - 36ms/step
Epoch 15/50
1601/1601 - 59s - loss: 2.1082 - accuracy20: 0.6490 - val_loss: 2.0592 - val_accuracy20: 0.7079 - 59s/epoch - 37ms/step
Epoch 16/50
1601/1601 - 58s - loss: 2.1035 - accuracy20: 0.6497 - val_loss: 2.0586 - val_accuracy20: 0.7054 - 58s/epoch - 36ms/step
Epoch 17/50
1601/1601 - 59s - loss: 2.1004 - accuracy20: 0.6496 - val_loss: 2.0707 - val_accuracy20: 0.7090 - 59s/epoch - 37ms/step
Epoch 18/50
1601/1601 - 59s - loss: 2.0977 - accuracy20: 0.6498 - val_loss: 2.0686 - val_accuracy20: 0.7016 - 59s/epoch - 37ms/step
Epoch 19/50
1601/1601 - 59s - loss: 2.0918 - accuracy20: 0.6507 - val_loss: 2.0753 - val_accuracy20: 0.7047 - 59s/epoch - 37ms/step
Epoch 20/50
1601/1601 - 58s - loss: 2.0888 - accuracy20: 0.6509 - val_loss: 2.0734 - val_accuracy20: 0.7007 - 58s/epoch - 36ms/step
Epoch 21/50
1601/1601 - 59s - loss: 2.0848 - accuracy20: 0.6508 - val_loss: 2.0704 - val_accuracy20: 0.7037 - 59s/epoch - 37ms/step
Epoch 22/50
1601/1601 - 59s - loss: 2.0810 - accuracy20: 0.6514 - val_loss: 2.0719 - val_accuracy20: 0.6913 - 59s/epoch - 37ms/step
Epoch 23/50
1601/1601 - 59s - loss: 2.0786 - accuracy20: 0.6521 - val_loss: 2.0739 - val_accuracy20: 0.7020 - 59s/epoch - 37ms/step
Epoch 24/50
1601/1601 - 59s - loss: 2.0759 - accuracy20: 0.6530 - val_loss: 2.0766 - val_accuracy20: 0.7033 - 59s/epoch - 37ms/step
Epoch 25/50
1601/1601 - 58s - loss: 2.0721 - accuracy20: 0.6532 - val_loss: 2.0754 - val_accuracy20: 0.6941 - 58s/epoch - 36ms/step
Epoch 26/50
1601/1601 - 59s - loss: 2.0686 - accuracy20: 0.6539 - val_loss: 2.0758 - val_accuracy20: 0.6966 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h20
Evaluating performance on  test set...
3782/3782 - 63s - 63s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.680893
{'0': {'precision': 0.4572700450333868, 'recall': 0.5717318283898443, 'f1-score': 0.5081348162080856, 'support': 154513}, '1': {'precision': 0.8609559053190887, 'recall': 0.7249660862102378, 'f1-score': 0.7871305605351775, 'support': 650178}, '2': {'precision': 0.45990205956503183, 'recall': 0.6402447614555834, 'f1-score': 0.535291978839664, 'support': 163261}, 'accuracy': 0.6862158454138222, 'macro avg': {'precision': 0.5927093366391691, 'recall': 0.6456475586852218, 'f1-score': 0.610185785194309, 'support': 967952}, 'weighted avg': {'precision': 0.7288717056459875, 'recall': 0.6862158454138222, 'f1-score': 0.7001180969735513, 'support': 967952}}
[[ 88340  39140  27033]
 [ 83100 471357  95721]
 [ 21750  36984 104527]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6858553
{'0': {'precision': 0.5263204015973761, 'recall': 0.5382882017796556, 'f1-score': 0.5322370336612107, 'support': 78105}, '1': {'precision': 0.8288957060701733, 'recall': 0.7299894453283763, 'f1-score': 0.7763049332612966, 'support': 253916}, '2': {'precision': 0.4884944425098585, 'recall': 0.6677387400136368, 'f1-score': 0.5642229759109487, 'support': 77731}, 'accuracy': 0.6816391378199497, 'macro avg': {'precision': 0.6145701833924694, 'recall': 0.6453387957072229, 'f1-score': 0.6242549809444854, 'support': 409752}, 'weighted avg': {'precision': 0.7066452356059544, 'recall': 0.6816391378199497, 'f1-score': 0.6895493691028188, 'support': 409752}}
[[ 42043  21393  14669]
 [ 28880 185356  39680]
 [  8958  16869  51904]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6508052
{'0': {'precision': 0.5123422459893048, 'recall': 0.5217164016554128, 'f1-score': 0.51698683358515, 'support': 22955}, '1': {'precision': 0.8504736296807933, 'recall': 0.7618105886512285, 'f1-score': 0.8037042217404481, 'support': 90512}, '2': {'precision': 0.47815939697858517, 'recall': 0.6681503679873078, 'f1-score': 0.5574101989043715, 'support': 22691}, 'accuracy': 0.7057242321420703, 'macro avg': {'precision': 0.6136584242162277, 'recall': 0.6505591194313164, 'f1-score': 0.6260337514099898, 'support': 136158}, 'weighted avg': {'precision': 0.7314208515341997, 'recall': 0.7057242321420703, 'f1-score': 0.7143208926868614, 'support': 136158}}
[[11976  6973  4006]
 [ 9019 68953 12540]
 [ 2380  5150 15161]]
training model: results/EXC/W4/deepVOL_L3/h30
Epoch 1/50
1601/1601 - 62s - loss: 2.9518 - accuracy30: 0.4805 - val_loss: 2.6816 - val_accuracy30: 0.6359 - 62s/epoch - 39ms/step
Epoch 2/50
1601/1601 - 60s - loss: 2.5542 - accuracy30: 0.5866 - val_loss: 2.4511 - val_accuracy30: 0.6594 - 60s/epoch - 38ms/step
Epoch 3/50
1601/1601 - 59s - loss: 2.4401 - accuracy30: 0.6086 - val_loss: 2.4364 - val_accuracy30: 0.6720 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 60s - loss: 2.4035 - accuracy30: 0.6149 - val_loss: 2.3603 - val_accuracy30: 0.6651 - 60s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 58s - loss: 2.3749 - accuracy30: 0.6167 - val_loss: 2.3116 - val_accuracy30: 0.6653 - 58s/epoch - 36ms/step
Epoch 6/50
1601/1601 - 59s - loss: 2.3486 - accuracy30: 0.6186 - val_loss: 2.3171 - val_accuracy30: 0.6661 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 2.3310 - accuracy30: 0.6192 - val_loss: 2.3018 - val_accuracy30: 0.6626 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 59s - loss: 2.3176 - accuracy30: 0.6211 - val_loss: 2.2943 - val_accuracy30: 0.6537 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 59s - loss: 2.3072 - accuracy30: 0.6218 - val_loss: 2.2846 - val_accuracy30: 0.6629 - 59s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 60s - loss: 2.2971 - accuracy30: 0.6230 - val_loss: 2.2881 - val_accuracy30: 0.6682 - 60s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 2.2908 - accuracy30: 0.6234 - val_loss: 2.2688 - val_accuracy30: 0.6668 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 60s - loss: 2.2855 - accuracy30: 0.6233 - val_loss: 2.2696 - val_accuracy30: 0.6614 - 60s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 2.2793 - accuracy30: 0.6242 - val_loss: 2.2649 - val_accuracy30: 0.6629 - 59s/epoch - 37ms/step
Epoch 14/50
1601/1601 - 59s - loss: 2.2740 - accuracy30: 0.6254 - val_loss: 2.2547 - val_accuracy30: 0.6594 - 59s/epoch - 37ms/step
Epoch 15/50
1601/1601 - 58s - loss: 2.2703 - accuracy30: 0.6256 - val_loss: 2.2538 - val_accuracy30: 0.6606 - 58s/epoch - 36ms/step
Epoch 16/50
1601/1601 - 60s - loss: 2.2650 - accuracy30: 0.6265 - val_loss: 2.2584 - val_accuracy30: 0.6587 - 60s/epoch - 37ms/step
Epoch 17/50
1601/1601 - 59s - loss: 2.2622 - accuracy30: 0.6263 - val_loss: 2.2557 - val_accuracy30: 0.6585 - 59s/epoch - 37ms/step
Epoch 18/50
1601/1601 - 59s - loss: 2.2588 - accuracy30: 0.6270 - val_loss: 2.2524 - val_accuracy30: 0.6587 - 59s/epoch - 37ms/step
Epoch 19/50
1601/1601 - 58s - loss: 2.2550 - accuracy30: 0.6277 - val_loss: 2.2590 - val_accuracy30: 0.6538 - 58s/epoch - 36ms/step
Epoch 20/50
1601/1601 - 59s - loss: 2.2517 - accuracy30: 0.6278 - val_loss: 2.2590 - val_accuracy30: 0.6557 - 59s/epoch - 37ms/step
Epoch 21/50
1601/1601 - 59s - loss: 2.2487 - accuracy30: 0.6285 - val_loss: 2.2516 - val_accuracy30: 0.6544 - 59s/epoch - 37ms/step
Epoch 22/50
1601/1601 - 59s - loss: 2.2462 - accuracy30: 0.6287 - val_loss: 2.2513 - val_accuracy30: 0.6604 - 59s/epoch - 37ms/step
Epoch 23/50
1601/1601 - 59s - loss: 2.2425 - accuracy30: 0.6296 - val_loss: 2.2647 - val_accuracy30: 0.6607 - 59s/epoch - 37ms/step
Epoch 24/50
1601/1601 - 60s - loss: 2.2395 - accuracy30: 0.6294 - val_loss: 2.2452 - val_accuracy30: 0.6655 - 60s/epoch - 37ms/step
Epoch 25/50
1601/1601 - 60s - loss: 2.2361 - accuracy30: 0.6299 - val_loss: 2.2520 - val_accuracy30: 0.6620 - 60s/epoch - 37ms/step
Epoch 26/50
1601/1601 - 60s - loss: 2.2331 - accuracy30: 0.6301 - val_loss: 2.2662 - val_accuracy30: 0.6560 - 60s/epoch - 37ms/step
Epoch 27/50
1601/1601 - 59s - loss: 2.2306 - accuracy30: 0.6306 - val_loss: 2.2665 - val_accuracy30: 0.6476 - 59s/epoch - 37ms/step
Epoch 28/50
1601/1601 - 61s - loss: 2.2274 - accuracy30: 0.6313 - val_loss: 2.2455 - val_accuracy30: 0.6564 - 61s/epoch - 38ms/step
Epoch 29/50
1601/1601 - 59s - loss: 2.2258 - accuracy30: 0.6307 - val_loss: 2.2501 - val_accuracy30: 0.6630 - 59s/epoch - 37ms/step
Epoch 30/50
1601/1601 - 60s - loss: 2.2226 - accuracy30: 0.6321 - val_loss: 2.2480 - val_accuracy30: 0.6562 - 60s/epoch - 38ms/step
Epoch 31/50
1601/1601 - 59s - loss: 2.2203 - accuracy30: 0.6323 - val_loss: 2.2488 - val_accuracy30: 0.6620 - 59s/epoch - 37ms/step
Epoch 32/50
1601/1601 - 60s - loss: 2.2152 - accuracy30: 0.6337 - val_loss: 2.2499 - val_accuracy30: 0.6599 - 60s/epoch - 37ms/step
Epoch 33/50
1601/1601 - 59s - loss: 2.2137 - accuracy30: 0.6337 - val_loss: 2.2564 - val_accuracy30: 0.6588 - 59s/epoch - 37ms/step
Epoch 34/50
1601/1601 - 60s - loss: 2.2093 - accuracy30: 0.6341 - val_loss: 2.2586 - val_accuracy30: 0.6573 - 60s/epoch - 38ms/step
testing model: results/EXC/W4/deepVOL_L3/h30
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7576334
{'0': {'precision': 0.46921311812279526, 'recall': 0.5283536534975841, 'f1-score': 0.4970303187354237, 'support': 181511}, '1': {'precision': 0.8066755853106388, 'recall': 0.6893521659850522, 'f1-score': 0.7434134313344543, 'support': 593933}, '2': {'precision': 0.4636032685967845, 'recall': 0.6165354167099549, 'f1-score': 0.5292428431285116, 'support': 192508}, 'accuracy': 0.6446796948609022, 'macro avg': {'precision': 0.5798306573434062, 'recall': 0.6114137453975305, 'f1-score': 0.5898955310661299, 'support': 967952}, 'weighted avg': {'precision': 0.6751635729095246, 'recall': 0.6446796948609022, 'f1-score': 0.6546168828017664, 'support': 967952}}
[[ 95902  50727  34882]
 [ 82062 409429 102442]
 [ 26425  47395 118688]]
Evaluating performance on  train set...
1601/1601 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75719976
{'0': {'precision': 0.5394039001760091, 'recall': 0.5060030179106436, 'f1-score': 0.5221698778526898, 'support': 91454}, '1': {'precision': 0.7675788149331011, 'recall': 0.6981997447070734, 'f1-score': 0.7312473348776637, 'support': 227190}, '2': {'precision': 0.4942969669070636, 'recall': 0.636431487904465, 'f1-score': 0.5564309499361847, 'support': 91108}, 'accuracy': 0.6415685585427283, 'macro avg': {'precision': 0.6004265606720579, 'recall': 0.6135447501740606, 'f1-score': 0.603282720888846, 'support': 409752}, 'weighted avg': {'precision': 0.6558876669602998, 'recall': 0.6415685585427283, 'f1-score': 0.6457123260088596, 'support': 409752}}
[[ 46276  26626  18552]
 [ 27796 158624  40770]
 [ 11719  21405  57984]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7230397
{'0': {'precision': 0.5297269201551318, 'recall': 0.48781296023564064, 'f1-score': 0.5079066914569397, 'support': 27160}, '1': {'precision': 0.7934729919165717, 'recall': 0.7374823437728313, 'f1-score': 0.7644538128025344, 'support': 82124}, '2': {'precision': 0.48408868975817104, 'recall': 0.6271861278559202, 'f1-score': 0.5464241716916294, 'support': 26874}, 'accuracy': 0.6659101925703962, 'macro avg': {'precision': 0.6024295339432916, 'recall': 0.6174938106214641, 'f1-score': 0.6062615586503678, 'support': 136158}, 'weighted avg': {'precision': 0.6797981652795356, 'recall': 0.6659101925703962, 'f1-score': 0.6702459925425364, 'support': 136158}}
[[13249  8846  5065]
 [ 8661 60565 12898]
 [ 3101  6918 16855]]
training model: results/EXC/W4/deepVOL_L3/h50
Epoch 1/50
1601/1601 - 62s - loss: 3.0827 - accuracy50: 0.4528 - val_loss: 2.9183 - val_accuracy50: 0.5607 - 62s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 59s - loss: 2.7706 - accuracy50: 0.5477 - val_loss: 2.6653 - val_accuracy50: 0.5969 - 59s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 59s - loss: 2.6645 - accuracy50: 0.5688 - val_loss: 2.6199 - val_accuracy50: 0.5976 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 58s - loss: 2.6293 - accuracy50: 0.5746 - val_loss: 2.5847 - val_accuracy50: 0.6016 - 58s/epoch - 36ms/step
Epoch 5/50
1601/1601 - 58s - loss: 2.6122 - accuracy50: 0.5770 - val_loss: 2.5952 - val_accuracy50: 0.5994 - 58s/epoch - 36ms/step
Epoch 6/50
1601/1601 - 59s - loss: 2.5978 - accuracy50: 0.5786 - val_loss: 2.5840 - val_accuracy50: 0.6052 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 58s - loss: 2.5852 - accuracy50: 0.5805 - val_loss: 2.5642 - val_accuracy50: 0.6090 - 58s/epoch - 36ms/step
Epoch 8/50
1601/1601 - 59s - loss: 2.5747 - accuracy50: 0.5820 - val_loss: 2.5545 - val_accuracy50: 0.6098 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 58s - loss: 2.5649 - accuracy50: 0.5830 - val_loss: 2.5540 - val_accuracy50: 0.6113 - 58s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 59s - loss: 2.5577 - accuracy50: 0.5834 - val_loss: 2.5516 - val_accuracy50: 0.6127 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 61s - loss: 2.5504 - accuracy50: 0.5837 - val_loss: 2.5520 - val_accuracy50: 0.6140 - 61s/epoch - 38ms/step
Epoch 12/50
1601/1601 - 61s - loss: 2.5427 - accuracy50: 0.5853 - val_loss: 2.5432 - val_accuracy50: 0.6137 - 61s/epoch - 38ms/step
Epoch 13/50
1601/1601 - 61s - loss: 2.5384 - accuracy50: 0.5861 - val_loss: 2.5470 - val_accuracy50: 0.6112 - 61s/epoch - 38ms/step
Epoch 14/50
1601/1601 - 61s - loss: 2.5339 - accuracy50: 0.5859 - val_loss: 2.5434 - val_accuracy50: 0.6122 - 61s/epoch - 38ms/step
Epoch 15/50
1601/1601 - 60s - loss: 2.5285 - accuracy50: 0.5871 - val_loss: 2.5454 - val_accuracy50: 0.6119 - 60s/epoch - 38ms/step
Epoch 16/50
1601/1601 - 59s - loss: 2.5251 - accuracy50: 0.5877 - val_loss: 2.5566 - val_accuracy50: 0.6092 - 59s/epoch - 37ms/step
Epoch 17/50
1601/1601 - 58s - loss: 2.5204 - accuracy50: 0.5884 - val_loss: 2.5485 - val_accuracy50: 0.6104 - 58s/epoch - 37ms/step
Epoch 18/50
1601/1601 - 59s - loss: 2.5170 - accuracy50: 0.5888 - val_loss: 2.5497 - val_accuracy50: 0.6102 - 59s/epoch - 37ms/step
Epoch 19/50
1601/1601 - 58s - loss: 2.5136 - accuracy50: 0.5896 - val_loss: 2.5567 - val_accuracy50: 0.6124 - 58s/epoch - 37ms/step
Epoch 20/50
1601/1601 - 59s - loss: 2.5099 - accuracy50: 0.5902 - val_loss: 2.5535 - val_accuracy50: 0.6134 - 59s/epoch - 37ms/step
Epoch 21/50
1601/1601 - 58s - loss: 2.5064 - accuracy50: 0.5909 - val_loss: 2.5567 - val_accuracy50: 0.6096 - 58s/epoch - 36ms/step
Epoch 22/50
1601/1601 - 58s - loss: 2.5042 - accuracy50: 0.5908 - val_loss: 2.5519 - val_accuracy50: 0.6100 - 58s/epoch - 36ms/step
testing model: results/EXC/W4/deepVOL_L3/h50
Evaluating performance on  test set...
3782/3782 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8344349
{'0': {'precision': 0.5099539834904254, 'recall': 0.42311134296006153, 'f1-score': 0.4624913362138886, 'support': 222367}, '1': {'precision': 0.6955108565339017, 'recall': 0.7196167651465779, 'f1-score': 0.7073584954958355, 'support': 507887}, '2': {'precision': 0.502994615506875, 'recall': 0.545877542091225, 'f1-score': 0.5235594488975328, 'support': 237698}, 'accuracy': 0.60883597533762, 'macro avg': {'precision': 0.5694864851770673, 'recall': 0.5628685500659548, 'f1-score': 0.564469760202419, 'support': 967952}, 'weighted avg': {'precision': 0.6056071726242648, 'recall': 0.60883597533762, 'f1-score': 0.6059701607577782, 'support': 967952}}
[[ 94086  84748  43533]
 [ 57727 365484  84676]
 [ 32686  75258 129754]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8554223
{'0': {'precision': 0.5687894623628703, 'recall': 0.4041610098630679, 'f1-score': 0.4725472263395251, 'support': 111223}, '1': {'precision': 0.6307186244104748, 'recall': 0.733921984187571, 'f1-score': 0.6784178359853242, 'support': 187321}, '2': {'precision': 0.5357386761745115, 'recall': 0.5431623624199697, 'f1-score': 0.5394249789021999, 'support': 111208}, 'accuracy': 0.5926389621039068, 'macro avg': {'precision': 0.5784155876492856, 'recall': 0.5604151188235362, 'f1-score': 0.563463347075683, 'support': 409752}, 'weighted avg': {'precision': 0.5881307242322067, 'recall': 0.5926389621039068, 'f1-score': 0.5848132545137639, 'support': 409752}}
[[ 44952  44663  21608]
 [ 19105 137479  30737]
 [ 14974  35830  60404]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8272265
{'0': {'precision': 0.5670435492885086, 'recall': 0.39053709954402793, 'f1-score': 0.4625230121855001, 'support': 33774}, '1': {'precision': 0.666065960101322, 'recall': 0.7646556712962963, 'f1-score': 0.7119639525563916, 'support': 69120}, '2': {'precision': 0.5264711142908245, 'recall': 0.5309343434343434, 'f1-score': 0.5286933093848226, 'support': 33264}, 'accuracy': 0.6147563859633661, 'macro avg': {'precision': 0.5865268745602183, 'recall': 0.5620423714248892, 'f1-score': 0.5677267580422382, 'support': 136158}, 'weighted avg': {'precision': 0.6073998086167794, 'recall': 0.6147563859633661, 'f1-score': 0.6053162859150958, 'support': 136158}}
[[13190 14990  5594]
 [ 5976 52853 10291]
 [ 4095 11508 17661]]
training model: results/EXC/W4/deepVOL_L3/h100
Epoch 1/50
1601/1601 - 61s - loss: 3.2191 - accuracy100: 0.4137 - val_loss: 3.2087 - val_accuracy100: 0.4057 - 61s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 59s - loss: 3.1619 - accuracy100: 0.4414 - val_loss: 3.2330 - val_accuracy100: 0.4089 - 59s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 59s - loss: 3.0337 - accuracy100: 0.4823 - val_loss: 3.1080 - val_accuracy100: 0.4736 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 58s - loss: 2.9511 - accuracy100: 0.4968 - val_loss: 3.1136 - val_accuracy100: 0.4727 - 58s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 2.9243 - accuracy100: 0.5017 - val_loss: 3.0707 - val_accuracy100: 0.4782 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 59s - loss: 2.9103 - accuracy100: 0.5042 - val_loss: 3.0640 - val_accuracy100: 0.4792 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 58s - loss: 2.9034 - accuracy100: 0.5064 - val_loss: 3.0401 - val_accuracy100: 0.4805 - 58s/epoch - 36ms/step
Epoch 8/50
1601/1601 - 59s - loss: 2.8977 - accuracy100: 0.5082 - val_loss: 3.0115 - val_accuracy100: 0.4839 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 58s - loss: 2.8944 - accuracy100: 0.5086 - val_loss: 3.0259 - val_accuracy100: 0.4851 - 58s/epoch - 36ms/step
Epoch 10/50
1601/1601 - 59s - loss: 2.8907 - accuracy100: 0.5099 - val_loss: 3.0063 - val_accuracy100: 0.4876 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 2.8861 - accuracy100: 0.5110 - val_loss: 3.0062 - val_accuracy100: 0.4894 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 59s - loss: 2.8822 - accuracy100: 0.5130 - val_loss: 3.0068 - val_accuracy100: 0.4893 - 59s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 2.8790 - accuracy100: 0.5127 - val_loss: 3.0102 - val_accuracy100: 0.4899 - 59s/epoch - 37ms/step
Epoch 14/50
1601/1601 - 60s - loss: 2.8756 - accuracy100: 0.5147 - val_loss: 3.0078 - val_accuracy100: 0.4899 - 60s/epoch - 37ms/step
Epoch 15/50
1601/1601 - 59s - loss: 2.8728 - accuracy100: 0.5151 - val_loss: 3.0034 - val_accuracy100: 0.4912 - 59s/epoch - 37ms/step
Epoch 16/50
1601/1601 - 59s - loss: 2.8688 - accuracy100: 0.5155 - val_loss: 2.9947 - val_accuracy100: 0.4929 - 59s/epoch - 37ms/step
Epoch 17/50
1601/1601 - 59s - loss: 2.8662 - accuracy100: 0.5167 - val_loss: 2.9934 - val_accuracy100: 0.4934 - 59s/epoch - 37ms/step
Epoch 18/50
1601/1601 - 59s - loss: 2.8634 - accuracy100: 0.5179 - val_loss: 2.9937 - val_accuracy100: 0.4940 - 59s/epoch - 37ms/step
Epoch 19/50
1601/1601 - 58s - loss: 2.8599 - accuracy100: 0.5183 - val_loss: 2.9958 - val_accuracy100: 0.4948 - 58s/epoch - 36ms/step
Epoch 20/50
1601/1601 - 58s - loss: 2.8571 - accuracy100: 0.5200 - val_loss: 2.9979 - val_accuracy100: 0.4940 - 58s/epoch - 37ms/step
Epoch 21/50
1601/1601 - 59s - loss: 2.8521 - accuracy100: 0.5208 - val_loss: 2.9945 - val_accuracy100: 0.4955 - 59s/epoch - 37ms/step
Epoch 22/50
1601/1601 - 59s - loss: 2.8488 - accuracy100: 0.5220 - val_loss: 3.0016 - val_accuracy100: 0.4952 - 59s/epoch - 37ms/step
Epoch 23/50
1601/1601 - 59s - loss: 2.8456 - accuracy100: 0.5235 - val_loss: 3.0110 - val_accuracy100: 0.4941 - 59s/epoch - 37ms/step
Epoch 24/50
1601/1601 - 59s - loss: 2.8404 - accuracy100: 0.5245 - val_loss: 2.9912 - val_accuracy100: 0.4959 - 59s/epoch - 37ms/step
Epoch 25/50
1601/1601 - 59s - loss: 2.8376 - accuracy100: 0.5248 - val_loss: 3.0141 - val_accuracy100: 0.4942 - 59s/epoch - 37ms/step
Epoch 26/50
1601/1601 - 59s - loss: 2.8347 - accuracy100: 0.5264 - val_loss: 3.0048 - val_accuracy100: 0.4944 - 59s/epoch - 37ms/step
Epoch 27/50
1601/1601 - 59s - loss: 2.8310 - accuracy100: 0.5263 - val_loss: 3.0044 - val_accuracy100: 0.4947 - 59s/epoch - 37ms/step
Epoch 28/50
1601/1601 - 59s - loss: 2.8273 - accuracy100: 0.5281 - val_loss: 2.9999 - val_accuracy100: 0.4956 - 59s/epoch - 37ms/step
Epoch 29/50
1601/1601 - 59s - loss: 2.8237 - accuracy100: 0.5288 - val_loss: 3.0319 - val_accuracy100: 0.4933 - 59s/epoch - 37ms/step
Epoch 30/50
1601/1601 - 59s - loss: 2.8196 - accuracy100: 0.5291 - val_loss: 3.0276 - val_accuracy100: 0.4946 - 59s/epoch - 37ms/step
Epoch 31/50
1601/1601 - 59s - loss: 2.8204 - accuracy100: 0.5302 - val_loss: 3.0165 - val_accuracy100: 0.4945 - 59s/epoch - 37ms/step
Epoch 32/50
1601/1601 - 59s - loss: 2.8164 - accuracy100: 0.5309 - val_loss: 3.0292 - val_accuracy100: 0.4923 - 59s/epoch - 37ms/step
Epoch 33/50
1601/1601 - 59s - loss: 2.8112 - accuracy100: 0.5326 - val_loss: 3.0328 - val_accuracy100: 0.4929 - 59s/epoch - 37ms/step
Epoch 34/50
1601/1601 - 60s - loss: 2.8064 - accuracy100: 0.5333 - val_loss: 3.0268 - val_accuracy100: 0.4915 - 60s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h100
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98244894
{'0': {'precision': 0.5160584449283349, 'recall': 0.3349852749145667, 'f1-score': 0.40625875267186823, 'support': 287944}, '1': {'precision': 0.5007843051056764, 'recall': 0.6870466321243524, 'f1-score': 0.5793116839437227, 'support': 364770}, '2': {'precision': 0.5056308312960178, 'recall': 0.45006947132008196, 'f1-score': 0.4762350713954847, 'support': 315238}, 'accuracy': 0.5051386845628709, 'macro avg': {'precision': 0.5074911937766764, 'recall': 0.4907004594530003, 'f1-score': 0.4872685026703585, 'support': 967952}, 'weighted avg': {'precision': 0.5069064125451842, 'recall': 0.5051386845628709, 'f1-score': 0.49426281950765116, 'support': 967952}}
[[ 96457 123738  67749]
 [ 43186 250614  70970]
 [ 47268 126091 141879]]
Evaluating performance on  train set...
1601/1601 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0027885
{'0': {'precision': 0.5594376826396573, 'recall': 0.28694393108165134, 'f1-score': 0.37932593347825244, 'support': 137438}, '1': {'precision': 0.44792369396829773, 'recall': 0.6773573806137418, 'f1-score': 0.5392509070214128, 'support': 134291}, '2': {'precision': 0.5064216006638224, 'recall': 0.49966309962832284, 'f1-score': 0.5030196496039445, 'support': 138023}, 'accuracy': 0.4865504012182979, 'macro avg': {'precision': 0.504594325757259, 'recall': 0.48798813710790534, 'f1-score': 0.47386549670120326, 'support': 409752}, 'weighted avg': {'precision': 0.5050321794689194, 'recall': 0.4865504012182979, 'f1-score': 0.4734049432278105, 'support': 409752}}
[[39437 60479 37522]
 [13634 90963 29694]
 [17423 51635 68965]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9981513
{'0': {'precision': 0.5673049712291294, 'recall': 0.2747247727376547, 'f1-score': 0.3701834297673273, 'support': 43782}, '1': {'precision': 0.4733101790008015, 'recall': 0.7126307320997587, 'f1-score': 0.5688232461069193, 'support': 49720}, '2': {'precision': 0.501321827613727, 'recall': 0.4712349962490623, 'f1-score': 0.48581303170920337, 'support': 42656}, 'accuracy': 0.4961955962925425, 'macro avg': {'precision': 0.5139789926145527, 'recall': 0.4861968336954919, 'f1-score': 0.47493990252781665, 'support': 136158}, 'weighted avg': {'precision': 0.5123100532393596, 'recall': 0.4961955962925425, 'f1-score': 0.4789443396575811, 'support': 136158}}
[[12028 21673 10081]
 [ 4374 35432  9914]
 [ 4800 17755 20101]]
training model: results/EXC/W4/deepVOL_L3/h200
Epoch 1/50
1601/1601 - 62s - loss: 3.2812 - accuracy200: 0.3792 - val_loss: 3.3029 - val_accuracy200: 0.3671 - 62s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 58s - loss: 3.2303 - accuracy200: 0.4077 - val_loss: 3.3007 - val_accuracy200: 0.3673 - 58s/epoch - 36ms/step
Epoch 3/50
1601/1601 - 59s - loss: 3.2056 - accuracy200: 0.4208 - val_loss: 3.3031 - val_accuracy200: 0.3783 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 59s - loss: 3.1908 - accuracy200: 0.4283 - val_loss: 3.2969 - val_accuracy200: 0.3781 - 59s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 3.1827 - accuracy200: 0.4309 - val_loss: 3.3231 - val_accuracy200: 0.3778 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 59s - loss: 3.1765 - accuracy200: 0.4322 - val_loss: 3.3251 - val_accuracy200: 0.3812 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 3.1715 - accuracy200: 0.4342 - val_loss: 3.3251 - val_accuracy200: 0.3850 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 58s - loss: 3.1679 - accuracy200: 0.4346 - val_loss: 3.3319 - val_accuracy200: 0.3826 - 58s/epoch - 36ms/step
Epoch 9/50
1601/1601 - 59s - loss: 3.1610 - accuracy200: 0.4369 - val_loss: 3.3107 - val_accuracy200: 0.3825 - 59s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 58s - loss: 3.1557 - accuracy200: 0.4388 - val_loss: 3.3163 - val_accuracy200: 0.3789 - 58s/epoch - 36ms/step
Epoch 11/50
1601/1601 - 58s - loss: 3.1541 - accuracy200: 0.4393 - val_loss: 3.3302 - val_accuracy200: 0.3749 - 58s/epoch - 36ms/step
Epoch 12/50
1601/1601 - 59s - loss: 3.1484 - accuracy200: 0.4416 - val_loss: 3.3467 - val_accuracy200: 0.3693 - 59s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 3.1448 - accuracy200: 0.4424 - val_loss: 3.3622 - val_accuracy200: 0.3681 - 59s/epoch - 37ms/step
Epoch 14/50
1601/1601 - 59s - loss: 3.1401 - accuracy200: 0.4442 - val_loss: 3.3798 - val_accuracy200: 0.3630 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h200
Evaluating performance on  test set...
3782/3782 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109729
{'0': {'precision': 0.49943113480479795, 'recall': 0.04818037850635809, 'f1-score': 0.08788267057154622, 'support': 318885}, '1': {'precision': 0.3203988191256612, 'recall': 0.7273561842375167, 'f1-score': 0.44484457104075187, 'support': 297377}, '2': {'precision': 0.4818730541480984, 'recall': 0.35911456111916745, 'f1-score': 0.4115343132622771, 'support': 351690}, 'accuracy': 0.36981172620129926, 'macro avg': {'precision': 0.43390100269285253, 'recall': 0.3782170412876808, 'f1-score': 0.3147538516248584, 'support': 967952}, 'weighted avg': {'precision': 0.4380488613802177, 'recall': 0.36981172620129926, 'f1-score': 0.3151432220180375, 'support': 967952}}
[[ 15364 239074  64447]
 [  9726 216299  71352]
 [  5673 219720 126297]]
Evaluating performance on  train set...
1601/1601 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086411
{'0': {'precision': 0.5182461103253182, 'recall': 0.02681263355091766, 'f1-score': 0.05098732274808311, 'support': 136652}, '1': {'precision': 0.34102495696759505, 'recall': 0.6881789420119914, 'f1-score': 0.45605383795830196, 'support': 135597}, '2': {'precision': 0.4357347095334403, 'recall': 0.40895107743103787, 'f1-score': 0.4219182604650465, 'support': 137503}, 'accuracy': 0.37391153673441496, 'macro avg': {'precision': 0.43166859227545124, 'recall': 0.3746475509979823, 'f1-score': 0.3096531403904772, 'support': 409752}, 'weighted avg': {'precision': 0.43191041977363626, 'recall': 0.37391153673441496, 'f1-score': 0.30950935800808344, 'support': 409752}}
[[  3664 100102  32886]
 [  2349  93315  39933]
 [  1057  80214  56232]]
Evaluating performance on  val set...
532/532 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999213
{'0': {'precision': 0.5304906006419073, 'recall': 0.025264215215302647, 'f1-score': 0.04823144423369532, 'support': 45796}, '1': {'precision': 0.346876843968642, 'recall': 0.7168833431327715, 'f1-score': 0.4675306231137937, 'support': 45921}, '2': {'precision': 0.44501318045709315, 'recall': 0.3912603226750073, 'f1-score': 0.4164092248006322, 'support': 44441}, 'accuracy': 0.3779799938306967, 'macro avg': {'precision': 0.44079354168921414, 'recall': 0.3778026270076938, 'f1-score': 0.3107237640493737, 'support': 136158}, 'weighted avg': {'precision': 0.44066532889418525, 'recall': 0.3779799938306967, 'f1-score': 0.3098159735270768, 'support': 136158}}
[[ 1157 35180  9459]
 [  775 32920 12226]
 [  249 26804 17388]]
training model: results/EXC/W4/deepVOL_L3/h300
Epoch 1/50
1601/1601 - 61s - loss: 3.2990 - accuracy300: 0.3687 - val_loss: 3.3158 - val_accuracy300: 0.3308 - 61s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 59s - loss: 3.2844 - accuracy300: 0.3619 - val_loss: 3.3004 - val_accuracy300: 0.3629 - 59s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 59s - loss: 3.2619 - accuracy300: 0.3878 - val_loss: 3.2892 - val_accuracy300: 0.3675 - 59s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 59s - loss: 3.2468 - accuracy300: 0.3973 - val_loss: 3.2961 - val_accuracy300: 0.3697 - 59s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 3.2277 - accuracy300: 0.4099 - val_loss: 3.3162 - val_accuracy300: 0.3694 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 60s - loss: 3.2160 - accuracy300: 0.4169 - val_loss: 3.3067 - val_accuracy300: 0.3737 - 60s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 3.2035 - accuracy300: 0.4242 - val_loss: 3.3133 - val_accuracy300: 0.3842 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 59s - loss: 3.1921 - accuracy300: 0.4281 - val_loss: 3.3406 - val_accuracy300: 0.3746 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 59s - loss: 3.1843 - accuracy300: 0.4321 - val_loss: 3.3178 - val_accuracy300: 0.3838 - 59s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 59s - loss: 3.1774 - accuracy300: 0.4343 - val_loss: 3.3308 - val_accuracy300: 0.3800 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 3.1715 - accuracy300: 0.4362 - val_loss: 3.3070 - val_accuracy300: 0.3884 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 60s - loss: 3.1654 - accuracy300: 0.4397 - val_loss: 3.3199 - val_accuracy300: 0.3833 - 60s/epoch - 37ms/step
Epoch 13/50
1601/1601 - 59s - loss: 3.1607 - accuracy300: 0.4416 - val_loss: 3.3125 - val_accuracy300: 0.3871 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h300
Evaluating performance on  test set...
3782/3782 - 63s - 63s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0874635
{'0': {'precision': 0.40704438652479963, 'recall': 0.20240854042837889, 'f1-score': 0.2703712018512602, 'support': 309399}, '1': {'precision': 0.330318602878052, 'recall': 0.34811506084887905, 'f1-score': 0.33898341632614715, 'support': 316111}, '2': {'precision': 0.41304732023860763, 'recall': 0.5801215972339842, 'f1-score': 0.4825315551755589, 'support': 342442}, 'accuracy': 0.3836202621617601, 'macro avg': {'precision': 0.38347010321381975, 'recall': 0.37688173283708065, 'f1-score': 0.3639620577843221, 'support': 967952}, 'weighted avg': {'precision': 0.38411121673173837, 'recall': 0.3836202621617601, 'f1-score': 0.36783645988363217, 'support': 967952}}
[[ 62625 119745 127029]
 [ 50798 110043 155270]
 [ 40430 103354 198658]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1012154
{'0': {'precision': 0.42921122574974363, 'recall': 0.14934100342241316, 'f1-score': 0.22158357327686334, 'support': 137330}, '1': {'precision': 0.3278160580714101, 'recall': 0.32928174341740013, 'f1-score': 0.32854726610681495, 'support': 135091}, '2': {'precision': 0.3737548282171173, 'recall': 0.6158187153665232, 'f1-score': 0.4651806218286327, 'support': 137331}, 'accuracy': 0.3650085905620961, 'macro avg': {'precision': 0.37692737067942367, 'recall': 0.3648138207354455, 'f1-score': 0.33843715373743705, 'support': 409752}, 'weighted avg': {'precision': 0.37719572094101333, 'recall': 0.3650085905620961, 'f1-score': 0.3384915041783697, 'support': 409752}}
[[20509 50658 66163]
 [15068 44483 75540]
 [12206 40554 84571]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965124
{'0': {'precision': 0.4367279011713499, 'recall': 0.14777354240665339, 'f1-score': 0.2208269277449632, 'support': 46172}, '1': {'precision': 0.3351662682025647, 'recall': 0.33637989704214294, 'f1-score': 0.3357719859777473, 'support': 45844}, '2': {'precision': 0.3730828581013083, 'recall': 0.6298763082778306, 'f1-score': 0.4686054252656594, 'support': 44142}, 'accuracy': 0.3675729667004509, 'macro avg': {'precision': 0.3816590091584076, 'recall': 0.3713432492422089, 'f1-score': 0.3417347796627899, 'support': 136158}, 'weighted avg': {'precision': 0.3818988717127888, 'recall': 0.3675729667004509, 'f1-score': 0.33985761038705786, 'support': 136158}}
[[ 6823 17977 21372]
 [ 5074 15421 25349]
 [ 3726 12612 27804]]
training model: results/EXC/W4/deepVOL_L3/h500
Epoch 1/50
1601/1601 - 63s - loss: 3.2712 - accuracy500: 0.3878 - val_loss: 3.3555 - val_accuracy500: 0.3381 - 63s/epoch - 40ms/step
Epoch 2/50
1601/1601 - 60s - loss: 3.2516 - accuracy500: 0.3974 - val_loss: 3.3520 - val_accuracy500: 0.3457 - 60s/epoch - 38ms/step
Epoch 3/50
1601/1601 - 60s - loss: 3.2477 - accuracy500: 0.4017 - val_loss: 3.3780 - val_accuracy500: 0.3428 - 60s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 59s - loss: 3.2395 - accuracy500: 0.4078 - val_loss: 3.3713 - val_accuracy500: 0.3496 - 59s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 3.2333 - accuracy500: 0.4104 - val_loss: 3.3609 - val_accuracy500: 0.3467 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 58s - loss: 3.2287 - accuracy500: 0.4130 - val_loss: 3.4003 - val_accuracy500: 0.3457 - 58s/epoch - 36ms/step
Epoch 7/50
1601/1601 - 59s - loss: 3.2141 - accuracy500: 0.4207 - val_loss: 3.3982 - val_accuracy500: 0.3440 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 59s - loss: 3.2154 - accuracy500: 0.4195 - val_loss: 3.3900 - val_accuracy500: 0.3466 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 59s - loss: 3.2089 - accuracy500: 0.4228 - val_loss: 3.4064 - val_accuracy500: 0.3458 - 59s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 59s - loss: 3.2010 - accuracy500: 0.4257 - val_loss: 3.4270 - val_accuracy500: 0.3445 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 3.2001 - accuracy500: 0.4257 - val_loss: 3.4172 - val_accuracy500: 0.3407 - 59s/epoch - 37ms/step
Epoch 12/50
1601/1601 - 59s - loss: 3.1958 - accuracy500: 0.4274 - val_loss: 3.4499 - val_accuracy500: 0.3430 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h500
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945431
{'0': {'precision': 0.41377029739098703, 'recall': 0.11190885932285981, 'f1-score': 0.17617043175981087, 'support': 324246}, '1': {'precision': 0.31285551763367464, 'recall': 0.0009852958037147442, 'f1-score': 0.0019644049817310336, 'support': 279104}, '2': {'precision': 0.38722641142536135, 'recall': 0.9339444106176049, 'f1-score': 0.5474658334264484, 'support': 364602}, 'accuracy': 0.38956373869778665, 'macro avg': {'precision': 0.371284075483341, 'recall': 0.34894618858139315, 'f1-score': 0.24186689005599674, 'support': 967952}, 'weighted avg': {'precision': 0.37467365561513044, 'recall': 0.38956373869778665, 'f1-score': 0.2657962057037566, 'support': 967952}}
[[ 36286    393 287567]
 [ 27537    275 251292]
 [ 23873    211 340518]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1170517
{'0': {'precision': 0.4229326374164084, 'recall': 0.07496548783220221, 'f1-score': 0.12735678194510106, 'support': 138357}, '1': {'precision': 0.34627831715210355, 'recall': 0.0008008382606092358, 'f1-score': 0.0015979808690327734, 'support': 133610}, '2': {'precision': 0.3419290811833139, 'recall': 0.9552200892695141, 'f1-score': 0.5035928556123542, 'support': 137785}, 'accuracy': 0.34678049161443997, 'macro avg': {'precision': 0.37038001191727526, 'recall': 0.34366213845410853, 'f1-score': 0.21084920614216265, 'support': 409752}, 'weighted avg': {'precision': 0.3706989479503638, 'recall': 0.34678049161443997, 'f1-score': 0.21286473309230472, 'support': 409752}}
[[ 10372    115 127870]
 [  8069    107 125434]
 [  6083     87 131615]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174566
{'0': {'precision': 0.45777715329492763, 'recall': 0.06797696544817226, 'f1-score': 0.11837587428467619, 'support': 47928}, '1': {'precision': 0.36363636363636365, 'recall': 0.000931619154089808, 'f1-score': 0.0018584769781164335, 'support': 42936}, '2': {'precision': 0.3396622999899171, 'recall': 0.9668609528855919, 'f1-score': 0.5027177500358732, 'support': 45294}, 'accuracy': 0.34585555016965586, 'macro avg': {'precision': 0.38702527230706946, 'recall': 0.3452565124959513, 'f1-score': 0.20765070043288858, 'support': 136158}, 'weighted avg': {'precision': 0.38879903147779427, 'recall': 0.34585555016965586, 'f1-score': 0.20948759705910194, 'support': 136158}}
[[ 3258    51 44619]
 [ 2377    40 40519]
 [ 1482    19 43793]]
training model: results/EXC/W4/deepVOL_L3/h1000
Epoch 1/50
1601/1601 - 61s - loss: 3.2318 - accuracy1000: 0.4206 - val_loss: 3.4195 - val_accuracy1000: 0.2981 - 61s/epoch - 38ms/step
Epoch 2/50
1601/1601 - 59s - loss: 3.2485 - accuracy1000: 0.4065 - val_loss: 3.4724 - val_accuracy1000: 0.2995 - 59s/epoch - 37ms/step
Epoch 3/50
1601/1601 - 60s - loss: 3.2352 - accuracy1000: 0.4100 - val_loss: 3.4814 - val_accuracy1000: 0.2996 - 60s/epoch - 37ms/step
Epoch 4/50
1601/1601 - 59s - loss: 3.2182 - accuracy1000: 0.4205 - val_loss: 3.4674 - val_accuracy1000: 0.3199 - 59s/epoch - 37ms/step
Epoch 5/50
1601/1601 - 59s - loss: 3.2095 - accuracy1000: 0.4245 - val_loss: 3.5193 - val_accuracy1000: 0.3095 - 59s/epoch - 37ms/step
Epoch 6/50
1601/1601 - 59s - loss: 3.2124 - accuracy1000: 0.4189 - val_loss: 3.5200 - val_accuracy1000: 0.3193 - 59s/epoch - 37ms/step
Epoch 7/50
1601/1601 - 59s - loss: 3.1929 - accuracy1000: 0.4339 - val_loss: 3.4954 - val_accuracy1000: 0.3255 - 59s/epoch - 37ms/step
Epoch 8/50
1601/1601 - 59s - loss: 3.1969 - accuracy1000: 0.4261 - val_loss: 3.5158 - val_accuracy1000: 0.3287 - 59s/epoch - 37ms/step
Epoch 9/50
1601/1601 - 59s - loss: 3.1880 - accuracy1000: 0.4312 - val_loss: 3.5008 - val_accuracy1000: 0.3331 - 59s/epoch - 37ms/step
Epoch 10/50
1601/1601 - 59s - loss: 3.1738 - accuracy1000: 0.4383 - val_loss: 3.4639 - val_accuracy1000: 0.3392 - 59s/epoch - 37ms/step
Epoch 11/50
1601/1601 - 59s - loss: 3.1611 - accuracy1000: 0.4445 - val_loss: 3.5283 - val_accuracy1000: 0.3351 - 59s/epoch - 37ms/step
testing model: results/EXC/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1597947
{'0': {'precision': 0.07692307692307693, 'recall': 2.8427100123089343e-06, 'f1-score': 5.685209926376531e-06, 'support': 351777}, '1': {'precision': 0.21906525126586468, 'recall': 0.9836103470888787, 'f1-score': 0.3583257997875712, 'support': 211963}, '2': {'precision': 0.45246022937476876, 'recall': 0.018153840064124765, 'f1-score': 0.03490711890207644, 'support': 404212}, 'accuracy': 0.22297386647271766, 'macro avg': {'precision': 0.24948285252123678, 'recall': 0.3339223432876719, 'f1-score': 0.13107953463319133, 'support': 967952}, 'weighted avg': {'precision': 0.2648719681563443, 'recall': 0.22297386647271766, 'f1-score': 0.093045613596657, 'support': 967952}}
[[     1 346366   5410]
 [     4 208489   3470]
 [     8 396866   7338]]
Evaluating performance on  train set...
1601/1601 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1275008
{'0': {'precision': 0.125, 'recall': 7.220946521670061e-06, 'f1-score': 1.4441058818432568e-05, 'support': 138486}, '1': {'precision': 0.3277715389844351, 'recall': 0.9795802946867094, 'f1-score': 0.4911891848526742, 'support': 134380}, '2': {'precision': 0.33902888752304855, 'recall': 0.020148152477243837, 'f1-score': 0.038035870667006845, 'support': 136886}, 'accuracy': 0.3279910775298229, 'macro avg': {'precision': 0.2639334755024945, 'recall': 0.33324522270349166, 'f1-score': 0.17641316552616648, 'support': 409752}, 'weighted avg': {'precision': 0.2630005410741337, 'recall': 0.3279910775298229, 'f1-score': 0.17379922669589845, 'support': 409752}}
[[     1 135849   2636]
 [     3 131636   2741]
 [     4 134124   2758]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1438079
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 49989}, '1': {'precision': 0.29575920516074766, 'recall': 0.9766155829985618, 'f1-score': 0.454021961552872, 'support': 40326}, '2': {'precision': 0.373497997329773, 'recall': 0.024409397290753223, 'f1-score': 0.04582403407113168, 'support': 45843}, 'accuracy': 0.29746324123444823, 'macro avg': {'precision': 0.22308573416350688, 'recall': 0.33367499342977164, 'f1-score': 0.1666153318746679, 'support': 136158}, 'weighted avg': {'precision': 0.2133481279021511, 'recall': 0.29746324123444823, 'f1-score': 0.14989644982670136, 'support': 136158}}
[[    0 49053   936]
 [    2 39383   941]
 [    1 44723  1119]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        21 (peak)  16.92 (ave)

============================================
