This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-14.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-02.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-10.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-08.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-03.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-09.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-12-31.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2020-01-15.csv
training model: results/XRAY/W10/deepLOB_L1/h10
Epoch 1/50
220/220 - 15s - loss: 3.3218 - accuracy10: 0.3636 - val_loss: 3.4943 - val_accuracy10: 0.3281 - 15s/epoch - 68ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2519 - accuracy10: 0.3992 - val_loss: 3.4019 - val_accuracy10: 0.3571 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2360 - accuracy10: 0.4047 - val_loss: 3.3107 - val_accuracy10: 0.3906 - 5s/epoch - 25ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2153 - accuracy10: 0.4172 - val_loss: 3.2769 - val_accuracy10: 0.3941 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2030 - accuracy10: 0.4214 - val_loss: 3.3198 - val_accuracy10: 0.3702 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.1928 - accuracy10: 0.4270 - val_loss: 3.2857 - val_accuracy10: 0.3744 - 5s/epoch - 25ms/step
Epoch 7/50
220/220 - 5s - loss: 3.1804 - accuracy10: 0.4354 - val_loss: 3.3081 - val_accuracy10: 0.4003 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.1747 - accuracy10: 0.4335 - val_loss: 3.3591 - val_accuracy10: 0.3812 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.1668 - accuracy10: 0.4371 - val_loss: 3.3103 - val_accuracy10: 0.3837 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.1627 - accuracy10: 0.4410 - val_loss: 3.2479 - val_accuracy10: 0.4096 - 5s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.1571 - accuracy10: 0.4454 - val_loss: 3.2801 - val_accuracy10: 0.3946 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 6s - loss: 3.1549 - accuracy10: 0.4450 - val_loss: 3.2875 - val_accuracy10: 0.3962 - 6s/epoch - 25ms/step
Epoch 13/50
220/220 - 6s - loss: 3.1447 - accuracy10: 0.4496 - val_loss: 3.2762 - val_accuracy10: 0.4024 - 6s/epoch - 25ms/step
Epoch 14/50
220/220 - 6s - loss: 3.1383 - accuracy10: 0.4530 - val_loss: 3.2942 - val_accuracy10: 0.3953 - 6s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.1338 - accuracy10: 0.4536 - val_loss: 3.2942 - val_accuracy10: 0.4000 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.1319 - accuracy10: 0.4550 - val_loss: 3.2573 - val_accuracy10: 0.4106 - 5s/epoch - 25ms/step
Epoch 17/50
220/220 - 5s - loss: 3.1277 - accuracy10: 0.4560 - val_loss: 3.2663 - val_accuracy10: 0.4099 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.1231 - accuracy10: 0.4580 - val_loss: 3.3172 - val_accuracy10: 0.3905 - 5s/epoch - 25ms/step
Epoch 19/50
220/220 - 6s - loss: 3.1176 - accuracy10: 0.4596 - val_loss: 3.2686 - val_accuracy10: 0.4046 - 6s/epoch - 26ms/step
Epoch 20/50
220/220 - 5s - loss: 3.1146 - accuracy10: 0.4594 - val_loss: 3.3048 - val_accuracy10: 0.3952 - 5s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h10
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1050338
{'0': {'precision': 0.4466924934327487, 'recall': 0.3759295236819187, 'f1-score': 0.408267449192414, 'support': 89562}, '1': {'precision': 0.291640925085283, 'recall': 0.31336132877325135, 'f1-score': 0.30211123091370734, 'support': 69297}, '2': {'precision': 0.4297952040283705, 'recall': 0.4735453315290934, 'f1-score': 0.45061082586231865, 'support': 88680}, 'accuracy': 0.393384476789516, 'macro avg': {'precision': 0.3893762075154674, 'recall': 0.3876120613280878, 'f1-score': 0.38699650198948005, 'support': 247539}, 'weighted avg': {'precision': 0.39723337726861063, 'recall': 0.393384476789516, 'f1-score': 0.3937190474659289, 'support': 247539}}
[[33669 27582 28311]
 [20180 21715 27402]
 [21525 25161 41994]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074163
{'0': {'precision': 0.4315295783372417, 'recall': 0.5195503942041338, 'f1-score': 0.4714668987020521, 'support': 18772}, '1': {'precision': 0.374313012598292, 'recall': 0.239660025985275, 'f1-score': 0.2922208653750949, 'support': 18472}, '2': {'precision': 0.4367816091954023, 'recall': 0.5014457704642238, 'f1-score': 0.46688531009838957, 'support': 19021}, 'accuracy': 0.4215409224206878, 'macro avg': {'precision': 0.414208066710312, 'recall': 0.42021873021787753, 'f1-score': 0.4101910247251788, 'support': 56265}, 'weighted avg': {'precision': 0.4145206825160952, 'recall': 0.4215409224206878, 'f1-score': 0.4110709309699661, 'support': 56265}}
[[9753 3831 5188]
 [6934 4427 7111]
 [5914 3569 9538]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0823616
{'0': {'precision': 0.45628257093225244, 'recall': 0.4479818078453667, 'f1-score': 0.4520940906483075, 'support': 7036}, '1': {'precision': 0.3157994323557237, 'recall': 0.2728015691402419, 'f1-score': 0.2927299833377181, 'support': 6118}, '2': {'precision': 0.43459376596831883, 'recall': 0.4954128440366973, 'f1-score': 0.4630146308268118, 'support': 6867}, 'accuracy': 0.4107187453174167, 'macro avg': {'precision': 0.402225256418765, 'recall': 0.4053987403407686, 'f1-score': 0.4026129016042792, 'support': 20021}, 'weighted avg': {'precision': 0.4059148138023122, 'recall': 0.4107187453174167, 'f1-score': 0.40714137804052586, 'support': 20021}}
[[3152 1876 2008]
 [2031 1669 2418]
 [1725 1740 3402]]
training model: results/XRAY/W10/deepLOB_L1/h20
Epoch 1/50
220/220 - 8s - loss: 3.3222 - accuracy20: 0.3612 - val_loss: 3.3515 - val_accuracy20: 0.3500 - 8s/epoch - 35ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2741 - accuracy20: 0.3885 - val_loss: 3.3308 - val_accuracy20: 0.3662 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2598 - accuracy20: 0.3953 - val_loss: 3.3312 - val_accuracy20: 0.3659 - 6s/epoch - 26ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2500 - accuracy20: 0.3993 - val_loss: 3.3042 - val_accuracy20: 0.3623 - 6s/epoch - 25ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2399 - accuracy20: 0.4042 - val_loss: 3.2808 - val_accuracy20: 0.3764 - 5s/epoch - 25ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2291 - accuracy20: 0.4132 - val_loss: 3.2749 - val_accuracy20: 0.3771 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2312 - accuracy20: 0.4073 - val_loss: 3.2526 - val_accuracy20: 0.4040 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2229 - accuracy20: 0.4115 - val_loss: 3.2701 - val_accuracy20: 0.3899 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2118 - accuracy20: 0.4204 - val_loss: 3.2540 - val_accuracy20: 0.3977 - 5s/epoch - 25ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2104 - accuracy20: 0.4207 - val_loss: 3.2628 - val_accuracy20: 0.3941 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2051 - accuracy20: 0.4245 - val_loss: 3.2536 - val_accuracy20: 0.3970 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 6s - loss: 3.1983 - accuracy20: 0.4277 - val_loss: 3.2526 - val_accuracy20: 0.4016 - 6s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.1927 - accuracy20: 0.4297 - val_loss: 3.2544 - val_accuracy20: 0.3942 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 6s - loss: 3.1922 - accuracy20: 0.4302 - val_loss: 3.2707 - val_accuracy20: 0.3880 - 6s/epoch - 26ms/step
Epoch 15/50
220/220 - 5s - loss: 3.1890 - accuracy20: 0.4301 - val_loss: 3.2506 - val_accuracy20: 0.3986 - 5s/epoch - 25ms/step
Epoch 16/50
220/220 - 5s - loss: 3.1861 - accuracy20: 0.4339 - val_loss: 3.2637 - val_accuracy20: 0.3886 - 5s/epoch - 25ms/step
Epoch 17/50
220/220 - 5s - loss: 3.1802 - accuracy20: 0.4342 - val_loss: 3.2599 - val_accuracy20: 0.3890 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.1794 - accuracy20: 0.4371 - val_loss: 3.2645 - val_accuracy20: 0.3881 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.1712 - accuracy20: 0.4392 - val_loss: 3.2734 - val_accuracy20: 0.3830 - 5s/epoch - 24ms/step
Epoch 20/50
220/220 - 5s - loss: 3.1684 - accuracy20: 0.4405 - val_loss: 3.2666 - val_accuracy20: 0.3878 - 5s/epoch - 24ms/step
Epoch 21/50
220/220 - 5s - loss: 3.1623 - accuracy20: 0.4425 - val_loss: 3.2723 - val_accuracy20: 0.3839 - 5s/epoch - 25ms/step
Epoch 22/50
220/220 - 5s - loss: 3.1618 - accuracy20: 0.4431 - val_loss: 3.2795 - val_accuracy20: 0.3859 - 5s/epoch - 24ms/step
Epoch 23/50
220/220 - 5s - loss: 3.1578 - accuracy20: 0.4445 - val_loss: 3.2720 - val_accuracy20: 0.3951 - 5s/epoch - 24ms/step
Epoch 24/50
220/220 - 5s - loss: 3.1538 - accuracy20: 0.4455 - val_loss: 3.2930 - val_accuracy20: 0.3797 - 5s/epoch - 24ms/step
Epoch 25/50
220/220 - 5s - loss: 3.1498 - accuracy20: 0.4475 - val_loss: 3.3128 - val_accuracy20: 0.3713 - 5s/epoch - 24ms/step
testing model: results/XRAY/W10/deepLOB_L1/h20
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1037909
{'0': {'precision': 0.41188773773043436, 'recall': 0.29037788903367395, 'f1-score': 0.3406206633012208, 'support': 87486}, '1': {'precision': 0.30999063441648345, 'recall': 0.40560232297938087, 'f1-score': 0.35140905209222884, 'support': 75076}, '2': {'precision': 0.39297044391190233, 'recall': 0.40523906468809207, 'f1-score': 0.3990104688685859, 'support': 84977}, 'accuracy': 0.3647546447226498, 'macro avg': {'precision': 0.37161627201960673, 'recall': 0.3670730922337156, 'f1-score': 0.3636800614206785, 'support': 247539}, 'weighted avg': {'precision': 0.37448934068909717, 'recall': 0.3647546447226498, 'f1-score': 0.3639371491259664, 'support': 247539}}
[[25404 35460 26622]
 [18053 30451 26572]
 [18220 32321 34436]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777469
{'0': {'precision': 0.41588699321225464, 'recall': 0.486846343820466, 'f1-score': 0.4485777887707148, 'support': 18626}, '1': {'precision': 0.3744618563802308, 'recall': 0.23472582037996545, 'f1-score': 0.2885674474155663, 'support': 18528}, '2': {'precision': 0.4183481419880072, 'recall': 0.5001308147140391, 'f1-score': 0.4555984555984556, 'support': 19111}, 'accuracy': 0.40833555496312096, 'macro avg': {'precision': 0.40289899719349753, 'recall': 0.4072343263048235, 'f1-score': 0.39758123059491224, 'support': 56265}, 'weighted avg': {'precision': 0.4030816982514383, 'recall': 0.40833555496312096, 'f1-score': 0.39827121024262024, 'support': 56265}}
[[9068 3670 5888]
 [6778 4349 7401]
 [5958 3595 9558]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830035
{'0': {'precision': 0.41997761611639617, 'recall': 0.4336270403004478, 'f1-score': 0.42669319877762774, 'support': 6923}, '1': {'precision': 0.3268464243845252, 'recall': 0.2208491761723701, 'f1-score': 0.2635908102486527, 'support': 6312}, '2': {'precision': 0.4088057620817844, 'recall': 0.5185676392572944, 'f1-score': 0.45719111342081326, 'support': 6786}, 'accuracy': 0.3953348983567254, 'macro avg': {'precision': 0.38520993419423527, 'recall': 0.3910146185767041, 'f1-score': 0.3824917074823646, 'support': 20021}, 'weighted avg': {'precision': 0.386829607341088, 'recall': 0.3953348983567254, 'f1-score': 0.38560916563111985, 'support': 20021}}
[[3002 1561 2360]
 [2189 1394 2729]
 [1957 1310 3519]]
training model: results/XRAY/W10/deepLOB_L1/h30
Epoch 1/50
220/220 - 8s - loss: 3.3370 - accuracy30: 0.3519 - val_loss: 3.3697 - val_accuracy30: 0.3392 - 8s/epoch - 35ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2943 - accuracy30: 0.3702 - val_loss: 3.3542 - val_accuracy30: 0.3493 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2745 - accuracy30: 0.3807 - val_loss: 3.3828 - val_accuracy30: 0.3385 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2641 - accuracy30: 0.3871 - val_loss: 3.3329 - val_accuracy30: 0.3508 - 5s/epoch - 25ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2534 - accuracy30: 0.3932 - val_loss: 3.3765 - val_accuracy30: 0.3333 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2533 - accuracy30: 0.3913 - val_loss: 3.2934 - val_accuracy30: 0.3677 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2429 - accuracy30: 0.3999 - val_loss: 3.3328 - val_accuracy30: 0.3566 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2400 - accuracy30: 0.3997 - val_loss: 3.2951 - val_accuracy30: 0.3615 - 6s/epoch - 25ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2377 - accuracy30: 0.4010 - val_loss: 3.3063 - val_accuracy30: 0.3526 - 6s/epoch - 25ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2300 - accuracy30: 0.4044 - val_loss: 3.2871 - val_accuracy30: 0.3691 - 6s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2264 - accuracy30: 0.4066 - val_loss: 3.2928 - val_accuracy30: 0.3616 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2237 - accuracy30: 0.4077 - val_loss: 3.3131 - val_accuracy30: 0.3546 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2200 - accuracy30: 0.4092 - val_loss: 3.2972 - val_accuracy30: 0.3593 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2167 - accuracy30: 0.4133 - val_loss: 3.2994 - val_accuracy30: 0.3586 - 5s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2141 - accuracy30: 0.4151 - val_loss: 3.3042 - val_accuracy30: 0.3580 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2098 - accuracy30: 0.4172 - val_loss: 3.3041 - val_accuracy30: 0.3550 - 5s/epoch - 24ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2073 - accuracy30: 0.4170 - val_loss: 3.3051 - val_accuracy30: 0.3609 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2019 - accuracy30: 0.4208 - val_loss: 3.3296 - val_accuracy30: 0.3470 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2031 - accuracy30: 0.4190 - val_loss: 3.3335 - val_accuracy30: 0.3422 - 5s/epoch - 24ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2017 - accuracy30: 0.4211 - val_loss: 3.3247 - val_accuracy30: 0.3530 - 5s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h30
Evaluating performance on  test set...
967/967 - 11s - 11s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.116895
{'0': {'precision': 0.37392048119636895, 'recall': 0.3109790378282869, 'f1-score': 0.3395576379797423, 'support': 87157}, '1': {'precision': 0.3108003239084958, 'recall': 0.4818738229755179, 'f1-score': 0.37787668704106325, 'support': 76464}, '2': {'precision': 0.37440045308932585, 'recall': 0.2520794108534522, 'f1-score': 0.3012982573583347, 'support': 83918}, 'accuracy': 0.34380037085065385, 'macro avg': {'precision': 0.3530404193980636, 'recall': 0.3483107572190856, 'f1-score': 0.3395775274597134, 'support': 247539}, 'weighted avg': {'precision': 0.35458558275391433, 'recall': 0.34380037085065385, 'f1-score': 0.33842398657304507, 'support': 247539}}
[[27104 42206 17847]
 [22118 36846 17500]
 [23264 39500 21154]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0953935
{'0': {'precision': 0.3841626538255752, 'recall': 0.38714547611344763, 'f1-score': 0.3856482973466538, 'support': 18546}, '1': {'precision': 0.3433833116036506, 'recall': 0.3408098344745781, 'f1-score': 0.34209173318901365, 'support': 18547}, '2': {'precision': 0.4022017008399854, 'recall': 0.40209680784477364, 'f1-score': 0.4021492475025431, 'support': 19172}, 'accuracy': 0.3769661423620368, 'macro avg': {'precision': 0.3765825554230704, 'recall': 0.3766840394775997, 'f1-score': 0.3766297593460702, 'support': 56265}, 'weighted avg': {'precision': 0.37686700198464806, 'recall': 0.3769661423620368, 'f1-score': 0.37691307333451407, 'support': 56265}}
[[7180 6067 5299]
 [6067 6321 6159]
 [5443 6020 7709]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0949491
{'0': {'precision': 0.4019873532068654, 'recall': 0.3211605080831409, 'f1-score': 0.35705688838963334, 'support': 6928}, '1': {'precision': 0.32467915621773125, 'recall': 0.3472156491560183, 'f1-score': 0.33556944656197596, 'support': 6339}, '2': {'precision': 0.3900350330868042, 'recall': 0.44506958839206395, 'f1-score': 0.41573888389461305, 'support': 6754}, 'accuracy': 0.37121022925927777, 'macro avg': {'precision': 0.3722338475038003, 'recall': 0.3711485818770744, 'f1-score': 0.36945507294874075, 'support': 20021}, 'weighted avg': {'precision': 0.37347815632334236, 'recall': 0.37121022925927777, 'f1-score': 0.37004971112052154, 'support': 20021}}
[[2225 2422 2281]
 [1718 2201 2420]
 [1592 2156 3006]]
training model: results/XRAY/W10/deepLOB_L1/h50
Epoch 1/50
220/220 - 8s - loss: 3.3436 - accuracy50: 0.3512 - val_loss: 3.4474 - val_accuracy50: 0.3453 - 8s/epoch - 35ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3133 - accuracy50: 0.3601 - val_loss: 3.3633 - val_accuracy50: 0.3388 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3024 - accuracy50: 0.3640 - val_loss: 3.3510 - val_accuracy50: 0.3456 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2906 - accuracy50: 0.3692 - val_loss: 3.3654 - val_accuracy50: 0.3491 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2847 - accuracy50: 0.3709 - val_loss: 3.3366 - val_accuracy50: 0.3425 - 5s/epoch - 25ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2785 - accuracy50: 0.3758 - val_loss: 3.3216 - val_accuracy50: 0.3526 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2656 - accuracy50: 0.3810 - val_loss: 3.3078 - val_accuracy50: 0.3570 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2643 - accuracy50: 0.3826 - val_loss: 3.3099 - val_accuracy50: 0.3562 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2595 - accuracy50: 0.3872 - val_loss: 3.3210 - val_accuracy50: 0.3601 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2566 - accuracy50: 0.3895 - val_loss: 3.3271 - val_accuracy50: 0.3609 - 5s/epoch - 25ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2475 - accuracy50: 0.3967 - val_loss: 3.3317 - val_accuracy50: 0.3574 - 6s/epoch - 25ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2441 - accuracy50: 0.3996 - val_loss: 3.3509 - val_accuracy50: 0.3606 - 6s/epoch - 26ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2413 - accuracy50: 0.4015 - val_loss: 3.3310 - val_accuracy50: 0.3614 - 6s/epoch - 26ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2383 - accuracy50: 0.4032 - val_loss: 3.3371 - val_accuracy50: 0.3557 - 6s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2351 - accuracy50: 0.4063 - val_loss: 3.3541 - val_accuracy50: 0.3625 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2282 - accuracy50: 0.4090 - val_loss: 3.3482 - val_accuracy50: 0.3558 - 5s/epoch - 25ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2261 - accuracy50: 0.4114 - val_loss: 3.3654 - val_accuracy50: 0.3583 - 5s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h50
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084744
{'0': {'precision': 0.36788201274008436, 'recall': 0.5904146914181915, 'f1-score': 0.45331042898873636, 'support': 90284}, '1': {'precision': 0.2912350882205872, 'recall': 0.11178744756107592, 'f1-score': 0.16156132355854963, 'support': 72942}, '2': {'precision': 0.35542039547719845, 'recall': 0.31466084708170744, 'f1-score': 0.3338009650408601, 'support': 84313}, 'accuracy': 0.35545510000444375, 'macro avg': {'precision': 0.33817916547929, 'recall': 0.3389543286869916, 'f1-score': 0.3162242391960487, 'support': 247539}, 'weighted avg': {'precision': 0.34105207360085027, 'recall': 0.35545510000444375, 'f1-score': 0.32663558307707813, 'support': 247539}}
[[53305 10539 26440]
 [43114  8154 21674]
 [48478  9305 26530]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104032
{'0': {'precision': 0.34641920619160366, 'recall': 0.7342038525872767, 'f1-score': 0.4707327198505501, 'support': 18533}, '1': {'precision': 0.3586079741876008, 'recall': 0.0837324436312759, 'f1-score': 0.13576476747229735, 'support': 18583}, '2': {'precision': 0.38388550644421604, 'recall': 0.25353804376207634, 'f1-score': 0.30538432507233615, 'support': 19149}, 'accuracy': 0.3557806807073669, 'macro avg': {'precision': 0.3629708956078068, 'recall': 0.35715811332687625, 'f1-score': 0.3039606041317279, 'support': 56265}, 'weighted avg': {'precision': 0.36319599565586896, 'recall': 0.3557806807073669, 'f1-score': 0.3038267237490111, 'support': 56265}}
[[13607  1323  3603]
 [12838  1556  4189]
 [12834  1460  4855]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1029891
{'0': {'precision': 0.35576145304801826, 'recall': 0.7010578177075786, 'f1-score': 0.47200000000000003, 'support': 6901}, '1': {'precision': 0.3285356695869837, 'recall': 0.08280757097791798, 'f1-score': 0.13227513227513227, 'support': 6340}, '2': {'precision': 0.3752072968490879, 'recall': 0.2669616519174041, 'f1-score': 0.31196139262323336, 'support': 6780}, 'accuracy': 0.3582738124968783, 'macro avg': {'precision': 0.35316813982802997, 'recall': 0.35027568020096694, 'f1-score': 0.3054121749661219, 'support': 20021}, 'weighted avg': {'precision': 0.35372515884834255, 'recall': 0.3582738124968783, 'f1-score': 0.31022399383696425, 'support': 20021}}
[[4838  529 1534]
 [4335  525 1480]
 [4426  544 1810]]
training model: results/XRAY/W10/deepLOB_L1/h100
Epoch 1/50
220/220 - 8s - loss: 3.3644 - accuracy100: 0.3401 - val_loss: 3.4293 - val_accuracy100: 0.3320 - 8s/epoch - 35ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3227 - accuracy100: 0.3489 - val_loss: 3.3975 - val_accuracy100: 0.3323 - 6s/epoch - 26ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3094 - accuracy100: 0.3545 - val_loss: 3.3596 - val_accuracy100: 0.3356 - 6s/epoch - 25ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3017 - accuracy100: 0.3557 - val_loss: 3.3638 - val_accuracy100: 0.3349 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2940 - accuracy100: 0.3596 - val_loss: 3.3522 - val_accuracy100: 0.3314 - 5s/epoch - 25ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2844 - accuracy100: 0.3650 - val_loss: 3.3705 - val_accuracy100: 0.3321 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2818 - accuracy100: 0.3718 - val_loss: 3.3633 - val_accuracy100: 0.3352 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2788 - accuracy100: 0.3716 - val_loss: 3.3493 - val_accuracy100: 0.3391 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2732 - accuracy100: 0.3751 - val_loss: 3.3530 - val_accuracy100: 0.3289 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2688 - accuracy100: 0.3805 - val_loss: 3.3636 - val_accuracy100: 0.3249 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2660 - accuracy100: 0.3838 - val_loss: 3.3526 - val_accuracy100: 0.3266 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2626 - accuracy100: 0.3860 - val_loss: 3.3882 - val_accuracy100: 0.3223 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2557 - accuracy100: 0.3888 - val_loss: 3.3765 - val_accuracy100: 0.3190 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2539 - accuracy100: 0.3895 - val_loss: 3.3990 - val_accuracy100: 0.3237 - 6s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2486 - accuracy100: 0.3947 - val_loss: 3.3968 - val_accuracy100: 0.3210 - 5s/epoch - 25ms/step
Epoch 16/50
220/220 - 6s - loss: 3.2471 - accuracy100: 0.3958 - val_loss: 3.3883 - val_accuracy100: 0.3249 - 6s/epoch - 25ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2400 - accuracy100: 0.4008 - val_loss: 3.4090 - val_accuracy100: 0.3256 - 5s/epoch - 25ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2418 - accuracy100: 0.4001 - val_loss: 3.4966 - val_accuracy100: 0.3233 - 5s/epoch - 24ms/step
testing model: results/XRAY/W10/deepLOB_L1/h100
Evaluating performance on  test set...
967/967 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1385723
{'0': {'precision': 0.3707413333333333, 'recall': 0.37895918968130227, 'f1-score': 0.3748052214140521, 'support': 91717}, '1': {'precision': 0.2883081993330574, 'recall': 0.5089402649682231, 'f1-score': 0.3680951621265904, 'support': 72537}, '2': {'precision': 0.3349390101779193, 'recall': 0.10352404394548838, 'f1-score': 0.1581626569565337, 'support': 83285}, 'accuracy': 0.324377168850161, 'macro avg': {'precision': 0.3313295142814367, 'recall': 0.33047449953167124, 'f1-score': 0.3003543468323921, 'support': 247539}, 'weighted avg': {'precision': 0.3345399722347724, 'recall': 0.324377168850161, 'f1-score': 0.29994912378346045, 'support': 247539}}
[[34757 47699  9261]
 [27761 36917  7859]
 [31232 43431  8622]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1172154
{'0': {'precision': 0.3405279760916487, 'recall': 0.3361193051458538, 'f1-score': 0.3383092783505155, 'support': 18306}, '1': {'precision': 0.3270450751252087, 'recall': 0.5336129875789932, 'f1-score': 0.40553968451124084, 'support': 18356}, '2': {'precision': 0.35253456221198154, 'recall': 0.14829362852624597, 'f1-score': 0.2087687170095874, 'support': 19603}, 'accuracy': 0.3351106371634231, 'macro avg': {'precision': 0.3400358711429463, 'recall': 0.3393419737503643, 'f1-score': 0.31753922662378126, 'support': 56265}, 'weighted avg': {'precision': 0.3403124420576473, 'recall': 0.3351106371634231, 'f1-score': 0.31511009078311236, 'support': 56265}}
[[ 6153  9517  2636]
 [ 5858  9795  2703]
 [ 6058 10638  2907]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.12182
{'0': {'precision': 0.3622436954984681, 'recall': 0.22362869198312235, 'f1-score': 0.27653832313781934, 'support': 6873}, '1': {'precision': 0.31863193174893356, 'recall': 0.650342039800995, 'f1-score': 0.42770961145194275, 'support': 6432}, '2': {'precision': 0.3267924528301887, 'recall': 0.1289458010720667, 'f1-score': 0.18492419389280376, 'support': 6716}, 'accuracy': 0.32895459767244395, 'macro avg': {'precision': 0.33588936002586345, 'recall': 0.3343055109520614, 'f1-score': 0.2963907094941886, 'support': 20021}, 'weighted avg': {'precision': 0.336340823004728, 'recall': 0.32895459767244395, 'f1-score': 0.2943722592262723, 'support': 20021}}
[[1537 4469  867]
 [1332 4183  917]
 [1374 4476  866]]
training model: results/XRAY/W10/deepLOB_L1/h200
Epoch 1/50
220/220 - 7s - loss: 3.3735 - accuracy200: 0.3381 - val_loss: 3.4230 - val_accuracy200: 0.3437 - 7s/epoch - 34ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3424 - accuracy200: 0.3447 - val_loss: 3.3796 - val_accuracy200: 0.3379 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3259 - accuracy200: 0.3472 - val_loss: 3.3796 - val_accuracy200: 0.3289 - 6s/epoch - 25ms/step
Epoch 4/50
220/220 - 6s - loss: 3.3134 - accuracy200: 0.3485 - val_loss: 3.3555 - val_accuracy200: 0.3350 - 6s/epoch - 25ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2983 - accuracy200: 0.3565 - val_loss: 3.3673 - val_accuracy200: 0.3287 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2890 - accuracy200: 0.3646 - val_loss: 3.3783 - val_accuracy200: 0.3182 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2816 - accuracy200: 0.3710 - val_loss: 3.3923 - val_accuracy200: 0.3146 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2777 - accuracy200: 0.3771 - val_loss: 3.3754 - val_accuracy200: 0.3245 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2705 - accuracy200: 0.3816 - val_loss: 3.3819 - val_accuracy200: 0.3200 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2662 - accuracy200: 0.3884 - val_loss: 3.3805 - val_accuracy200: 0.3192 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2561 - accuracy200: 0.3924 - val_loss: 3.4300 - val_accuracy200: 0.3150 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2578 - accuracy200: 0.3931 - val_loss: 3.4038 - val_accuracy200: 0.3185 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2510 - accuracy200: 0.3975 - val_loss: 3.4399 - val_accuracy200: 0.3155 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2473 - accuracy200: 0.3966 - val_loss: 3.4437 - val_accuracy200: 0.3206 - 5s/epoch - 24ms/step
testing model: results/XRAY/W10/deepLOB_L1/h200
Evaluating performance on  test set...
967/967 - 11s - 11s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1372099
{'0': {'precision': 0.39176963812886145, 'recall': 0.21991247264770242, 'f1-score': 0.28169870693074545, 'support': 96884}, '1': {'precision': 0.27327989803171804, 'recall': 0.3307278147758117, 'f1-score': 0.29927188538066635, 'support': 67421}, '2': {'precision': 0.34071942703991537, 'recall': 0.45667635821899705, 'f1-score': 0.39026669062347596, 'support': 83234}, 'accuracy': 0.32970562214438937, 'macro avg': {'precision': 0.3352563210668316, 'recall': 0.3357722152141704, 'f1-score': 0.32374576097829594, 'support': 247539}, 'weighted avg': {'precision': 0.34233173122584076, 'recall': 0.32970562214438937, 'f1-score': 0.32299057939913567, 'support': 247539}}
[[21306 32384 43194]
 [14767 22298 30356]
 [18311 26912 38011]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161872
{'0': {'precision': 0.3283197548917206, 'recall': 0.526727364128917, 'f1-score': 0.4045040214477212, 'support': 17903}, '1': {'precision': 0.3345056961541402, 'recall': 0.23550627119556442, 'f1-score': 0.27640889562800103, 'support': 18577}, '2': {'precision': 0.351908185840708, 'recall': 0.25726560525650743, 'f1-score': 0.29723495576513176, 'support': 19785}, 'accuracy': 0.335821558695459, 'macro avg': {'precision': 0.3382445456288563, 'recall': 0.33983308019366293, 'f1-score': 0.3260492909469513, 'support': 56265}, 'weighted avg': {'precision': 0.338656791009337, 'recall': 0.335821558695459, 'f1-score': 0.3244908406624555, 'support': 56265}}
[[ 9430  4065  4408]
 [ 9236  4375  4966]
 [10056  4639  5090]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152917
{'0': {'precision': 0.35229334024358644, 'recall': 0.3932600520682673, 'f1-score': 0.37165117550574084, 'support': 6914}, '1': {'precision': 0.3283173734610123, 'recall': 0.3344688758129452, 'f1-score': 0.33136457774027767, 'support': 6458}, '2': {'precision': 0.32354996505939904, 'recall': 0.2785381260339901, 'f1-score': 0.2993615129717934, 'support': 6649}, 'accuracy': 0.33619699315718493, 'macro avg': {'precision': 0.33472022625466585, 'recall': 0.33542235130506753, 'f1-score': 0.3341257554059373, 'support': 20021}, 'weighted avg': {'precision': 0.3350139088924288, 'recall': 0.33619699315718493, 'f1-score': 0.3346487872854932, 'support': 20021}}
[[2719 2197 1998]
 [2424 2160 1874]
 [2575 2222 1852]]
training model: results/XRAY/W10/deepLOB_L1/h300
Epoch 1/50
220/220 - 8s - loss: 3.3599 - accuracy300: 0.3474 - val_loss: 3.3967 - val_accuracy300: 0.3422 - 8s/epoch - 36ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3280 - accuracy300: 0.3524 - val_loss: 3.3881 - val_accuracy300: 0.3338 - 6s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3148 - accuracy300: 0.3593 - val_loss: 3.3600 - val_accuracy300: 0.3307 - 5s/epoch - 25ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3012 - accuracy300: 0.3597 - val_loss: 3.3779 - val_accuracy300: 0.3331 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.3009 - accuracy300: 0.3603 - val_loss: 3.3356 - val_accuracy300: 0.3331 - 5s/epoch - 25ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2889 - accuracy300: 0.3709 - val_loss: 3.3606 - val_accuracy300: 0.3366 - 5s/epoch - 25ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2733 - accuracy300: 0.3820 - val_loss: 3.3467 - val_accuracy300: 0.3451 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2657 - accuracy300: 0.3902 - val_loss: 3.3854 - val_accuracy300: 0.3306 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2623 - accuracy300: 0.3931 - val_loss: 3.4925 - val_accuracy300: 0.3361 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2556 - accuracy300: 0.4017 - val_loss: 3.4584 - val_accuracy300: 0.3346 - 5s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2438 - accuracy300: 0.4058 - val_loss: 3.4995 - val_accuracy300: 0.3352 - 5s/epoch - 25ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2373 - accuracy300: 0.4091 - val_loss: 3.5122 - val_accuracy300: 0.3375 - 5s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2317 - accuracy300: 0.4118 - val_loss: 3.4744 - val_accuracy300: 0.3330 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2235 - accuracy300: 0.4161 - val_loss: 3.5265 - val_accuracy300: 0.3337 - 6s/epoch - 26ms/step
Epoch 15/50
220/220 - 6s - loss: 3.2213 - accuracy300: 0.4167 - val_loss: 3.5019 - val_accuracy300: 0.3234 - 6s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h300
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1143484
{'0': {'precision': 0.3806955732318866, 'recall': 0.3641316145838717, 'f1-score': 0.37222941378490476, 'support': 96737}, '1': {'precision': 0.27960969542621084, 'recall': 0.274309287934691, 'f1-score': 0.2769341320877848, 'support': 68842}, '2': {'precision': 0.33343622104854015, 'recall': 0.3558687164470473, 'f1-score': 0.344287451160924, 'support': 81960}, 'accuracy': 0.3364156759136944, 'macro avg': {'precision': 0.33124716323554587, 'recall': 0.3314365396552033, 'f1-score': 0.3311503323445379, 'support': 247539}, 'weighted avg': {'precision': 0.3369354768234604, 'recall': 0.3364156759136944, 'f1-score': 0.3364756899706589, 'support': 247539}}
[[35225 27309 34203]
 [25854 18884 24104]
 [31449 21344 29167]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133354
{'0': {'precision': 0.3186861543297187, 'recall': 0.5847848656131042, 'f1-score': 0.41254857282363233, 'support': 17338}, '1': {'precision': 0.35599169113960316, 'recall': 0.25642348570838924, 'f1-score': 0.29811354707134935, 'support': 19382}, '2': {'precision': 0.35398989417484983, 'recall': 0.18997185981069328, 'f1-score': 0.2472531131384431, 'support': 19545}, 'accuracy': 0.33452412689949346, 'macro avg': {'precision': 0.34288924654805725, 'recall': 0.3437267370440622, 'f1-score': 0.31930507767780825, 'support': 56265}, 'weighted avg': {'precision': 0.34380065730176645, 'recall': 0.33452412689949346, 'f1-score': 0.3157089846484297, 'support': 56265}}
[[10139  4136  3063]
 [10699  4970  3713]
 [10977  4855  3713]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081878
{'0': {'precision': 0.3409207423356916, 'recall': 0.4914277268696423, 'f1-score': 0.40256674132816755, 'support': 6766}, '1': {'precision': 0.34125371267781773, 'recall': 0.3203698268271206, 'f1-score': 0.33048217394595414, 'support': 6814}, '2': {'precision': 0.325497287522604, 'recall': 0.19562179785747555, 'f1-score': 0.24437548487199376, 'support': 6441}, 'accuracy': 0.3380450526946706, 'macro avg': {'precision': 0.3358905808453711, 'recall': 0.3358064505180795, 'f1-score': 0.3258081333820385, 'support': 20021}, 'weighted avg': {'precision': 0.3360721527277874, 'recall': 0.3380450526946706, 'f1-score': 0.32714123186427374, 'support': 20021}}
[[3325 2138 1303]
 [3323 2183 1308]
 [3105 2076 1260]]
training model: results/XRAY/W10/deepLOB_L1/h500
Epoch 1/50
220/220 - 8s - loss: 3.3717 - accuracy500: 0.3452 - val_loss: 3.4354 - val_accuracy500: 0.3281 - 8s/epoch - 36ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3328 - accuracy500: 0.3562 - val_loss: 3.3935 - val_accuracy500: 0.3422 - 6s/epoch - 26ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3187 - accuracy500: 0.3540 - val_loss: 3.4055 - val_accuracy500: 0.3397 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3019 - accuracy500: 0.3666 - val_loss: 3.4316 - val_accuracy500: 0.3228 - 5s/epoch - 25ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2896 - accuracy500: 0.3679 - val_loss: 3.4515 - val_accuracy500: 0.3277 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2711 - accuracy500: 0.3857 - val_loss: 3.4421 - val_accuracy500: 0.3178 - 5s/epoch - 25ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2629 - accuracy500: 0.3924 - val_loss: 3.4718 - val_accuracy500: 0.3174 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2565 - accuracy500: 0.3980 - val_loss: 3.5245 - val_accuracy500: 0.3187 - 5s/epoch - 25ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2423 - accuracy500: 0.4045 - val_loss: 3.5935 - val_accuracy500: 0.3191 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2290 - accuracy500: 0.4136 - val_loss: 3.6533 - val_accuracy500: 0.3200 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2135 - accuracy500: 0.4249 - val_loss: 3.7069 - val_accuracy500: 0.3246 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2120 - accuracy500: 0.4232 - val_loss: 3.5647 - val_accuracy500: 0.3238 - 5s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h500
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1367966
{'0': {'precision': 0.4012944429700275, 'recall': 0.4621634146100983, 'f1-score': 0.4295834669843743, 'support': 101423}, '1': {'precision': 0.2552854720180893, 'recall': 0.27933012726344925, 'f1-score': 0.266767088289805, 'support': 64669}, '2': {'precision': 0.33058760755019007, 'recall': 0.24342210271710438, 'f1-score': 0.28038665243001293, 'support': 81447}, 'accuracy': 0.34242684991051914, 'macro avg': {'precision': 0.32905584084610234, 'recall': 0.32830521486355063, 'f1-score': 0.32557906923473073, 'support': 247539}, 'weighted avg': {'precision': 0.3398854780516494, 'recall': 0.34242684991051914, 'f1-score': 0.3379582873205307, 'support': 247539}}
[[46874 30187 24362]
 [30821 18064 15784]
 [39112 22509 19826]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1423954
{'0': {'precision': 0.32608035931051227, 'recall': 0.6013880338053395, 'f1-score': 0.4228733347763632, 'support': 17867}, '1': {'precision': 0.3180774278215223, 'recall': 0.2198911317759129, 'f1-score': 0.2600241383934558, 'support': 17636}, '2': {'precision': 0.3649851632047478, 'recall': 0.19550139678258358, 'f1-score': 0.2546184487030706, 'support': 20762}, 'accuracy': 0.33203590153736784, 'macro avg': {'precision': 0.33638098344559414, 'recall': 0.33892685412127865, 'f1-score': 0.3125053072909632, 'support': 56265}, 'weighted avg': {'precision': 0.3379278993213945, 'recall': 0.33203590153736784, 'f1-score': 0.30974232309836347, 'support': 56265}}
[[10745  3687  3435]
 [10131  3878  3627]
 [12076  4627  4059]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1290933
{'0': {'precision': 0.3688768256430141, 'recall': 0.40882395072339206, 'f1-score': 0.387824432667482, 'support': 6981}, '1': {'precision': 0.33127629733520336, 'recall': 0.3787684413085311, 'f1-score': 0.3534340864881041, 'support': 6236}, '2': {'precision': 0.3461389212262321, 'recall': 0.2621987066431511, 'f1-score': 0.2983776551262753, 'support': 6804}, 'accuracy': 0.3496328854702562, 'macro avg': {'precision': 0.3487640147348165, 'recall': 0.34993036622502477, 'f1-score': 0.34654539142728713, 'support': 20021}, 'weighted avg': {'precision': 0.3494379566464958, 'recall': 0.3496328854702562, 'f1-score': 0.3467148940248082, 'support': 20021}}
[[2854 2418 1709]
 [2213 2362 1661]
 [2670 2350 1784]]
training model: results/XRAY/W10/deepLOB_L1/h1000
Epoch 1/50
220/220 - 8s - loss: 3.3867 - accuracy1000: 0.3400 - val_loss: 3.4994 - val_accuracy1000: 0.3192 - 8s/epoch - 34ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3562 - accuracy1000: 0.3462 - val_loss: 3.4246 - val_accuracy1000: 0.3312 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3304 - accuracy1000: 0.3535 - val_loss: 3.4455 - val_accuracy1000: 0.3380 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3221 - accuracy1000: 0.3528 - val_loss: 3.3946 - val_accuracy1000: 0.3357 - 5s/epoch - 25ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2984 - accuracy1000: 0.3700 - val_loss: 3.3493 - val_accuracy1000: 0.3427 - 6s/epoch - 25ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2765 - accuracy1000: 0.3795 - val_loss: 3.3837 - val_accuracy1000: 0.3273 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2606 - accuracy1000: 0.3919 - val_loss: 3.3815 - val_accuracy1000: 0.3341 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2424 - accuracy1000: 0.4013 - val_loss: 3.3944 - val_accuracy1000: 0.3327 - 5s/epoch - 25ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2241 - accuracy1000: 0.4119 - val_loss: 3.4665 - val_accuracy1000: 0.3228 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2179 - accuracy1000: 0.4132 - val_loss: 3.5285 - val_accuracy1000: 0.3234 - 6s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.1956 - accuracy1000: 0.4270 - val_loss: 3.5339 - val_accuracy1000: 0.3233 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 6s - loss: 3.1837 - accuracy1000: 0.4305 - val_loss: 3.5567 - val_accuracy1000: 0.3148 - 6s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.1713 - accuracy1000: 0.4396 - val_loss: 3.5006 - val_accuracy1000: 0.3264 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.1564 - accuracy1000: 0.4456 - val_loss: 3.4539 - val_accuracy1000: 0.3198 - 5s/epoch - 25ms/step
Epoch 15/50
220/220 - 6s - loss: 3.1434 - accuracy1000: 0.4531 - val_loss: 3.4633 - val_accuracy1000: 0.3252 - 6s/epoch - 25ms/step
testing model: results/XRAY/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.116631
{'0': {'precision': 0.40763640910922455, 'recall': 0.28011648446078197, 'f1-score': 0.3320543728000181, 'support': 104735}, '1': {'precision': 0.24707910772229302, 'recall': 0.366355971227591, 'f1-score': 0.29512138964926193, 'support': 62977}, '2': {'precision': 0.3181325968195257, 'recall': 0.3275458178310597, 'f1-score': 0.3227705905589571, 'support': 79827}, 'accuracy': 0.3173520132181192, 'macro avg': {'precision': 0.32428270455034774, 'recall': 0.3246727578398109, 'f1-score': 0.316648784336079, 'support': 247539}, 'weighted avg': {'precision': 0.33792522019315646, 'recall': 0.3173520132181192, 'f1-score': 0.319664305114351, 'support': 247539}}
[[29338 40589 34808]
 [18671 23072 21234]
 [23962 29718 26147]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1117
{'0': {'precision': 0.31402752105155063, 'recall': 0.44190751445086707, 'f1-score': 0.36715091847760833, 'support': 17300}, '1': {'precision': 0.32566334991708124, 'recall': 0.1715065502183406, 'f1-score': 0.2246853546910755, 'support': 18320}, '2': {'precision': 0.3692528735632184, 'recall': 0.39835311213368857, 'f1-score': 0.38325139222219634, 'support': 20645}, 'accuracy': 0.3378832311383631, 'macro avg': {'precision': 0.3363145815106168, 'recall': 0.3372557256009654, 'f1-score': 0.3250292217969601, 'support': 56265}, 'weighted avg': {'precision': 0.33807969891380785, 'recall': 0.3378832311383631, 'f1-score': 0.32667149346894825, 'support': 56265}}
[[7645 2895 6760]
 [7890 3142 7288]
 [8810 3611 8224]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1083055
{'0': {'precision': 0.34900542495479203, 'recall': 0.34275566079621134, 'f1-score': 0.3458523109086836, 'support': 6757}, '1': {'precision': 0.3387096774193548, 'recall': 0.2041274113952445, 'f1-score': 0.2547354670150228, 'support': 6687}, '2': {'precision': 0.32752538749331905, 'recall': 0.4658658963053064, 'f1-score': 0.38463469746422296, 'support': 6577}, 'accuracy': 0.33689625892812547, 'macro avg': {'precision': 0.3384134966224886, 'recall': 0.3375829894989207, 'f1-score': 0.32840749179597645, 'support': 20021}, 'weighted avg': {'precision': 0.33851035127447754, 'recall': 0.33689625892812547, 'f1-score': 0.3281595593607526, 'support': 20021}}
[[2316 1331 3110]
 [2141 1365 3181]
 [2179 1334 3064]]
training model: results/XRAY/W10/deepOF_L1/h10
Epoch 1/50
220/220 - 8s - loss: 3.3154 - accuracy10: 0.3604 - val_loss: 3.3193 - val_accuracy10: 0.3772 - 8s/epoch - 36ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2782 - accuracy10: 0.3814 - val_loss: 3.3020 - val_accuracy10: 0.3835 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2623 - accuracy10: 0.3892 - val_loss: 3.2904 - val_accuracy10: 0.3858 - 5s/epoch - 23ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2525 - accuracy10: 0.3924 - val_loss: 3.2899 - val_accuracy10: 0.3852 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2460 - accuracy10: 0.3960 - val_loss: 3.2828 - val_accuracy10: 0.3831 - 5s/epoch - 23ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2428 - accuracy10: 0.3969 - val_loss: 3.2804 - val_accuracy10: 0.3903 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2356 - accuracy10: 0.4018 - val_loss: 3.2723 - val_accuracy10: 0.3853 - 5s/epoch - 23ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2335 - accuracy10: 0.4033 - val_loss: 3.2696 - val_accuracy10: 0.3889 - 5s/epoch - 23ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2311 - accuracy10: 0.4019 - val_loss: 3.2639 - val_accuracy10: 0.3913 - 5s/epoch - 23ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2261 - accuracy10: 0.4046 - val_loss: 3.2652 - val_accuracy10: 0.3892 - 5s/epoch - 23ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2234 - accuracy10: 0.4078 - val_loss: 3.2616 - val_accuracy10: 0.3879 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2226 - accuracy10: 0.4085 - val_loss: 3.2635 - val_accuracy10: 0.3878 - 5s/epoch - 23ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2203 - accuracy10: 0.4072 - val_loss: 3.2593 - val_accuracy10: 0.3918 - 5s/epoch - 23ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2162 - accuracy10: 0.4091 - val_loss: 3.2595 - val_accuracy10: 0.3905 - 5s/epoch - 23ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2142 - accuracy10: 0.4133 - val_loss: 3.2624 - val_accuracy10: 0.3873 - 5s/epoch - 23ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2117 - accuracy10: 0.4113 - val_loss: 3.2588 - val_accuracy10: 0.3891 - 5s/epoch - 23ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2075 - accuracy10: 0.4153 - val_loss: 3.2617 - val_accuracy10: 0.3873 - 5s/epoch - 25ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2048 - accuracy10: 0.4159 - val_loss: 3.2636 - val_accuracy10: 0.3855 - 5s/epoch - 25ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2039 - accuracy10: 0.4155 - val_loss: 3.2649 - val_accuracy10: 0.3870 - 5s/epoch - 25ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2016 - accuracy10: 0.4168 - val_loss: 3.2617 - val_accuracy10: 0.3860 - 5s/epoch - 25ms/step
Epoch 21/50
220/220 - 5s - loss: 3.1972 - accuracy10: 0.4181 - val_loss: 3.2629 - val_accuracy10: 0.3871 - 5s/epoch - 24ms/step
Epoch 22/50
220/220 - 5s - loss: 3.1927 - accuracy10: 0.4212 - val_loss: 3.2658 - val_accuracy10: 0.3865 - 5s/epoch - 23ms/step
Epoch 23/50
220/220 - 5s - loss: 3.1914 - accuracy10: 0.4207 - val_loss: 3.2627 - val_accuracy10: 0.3866 - 5s/epoch - 24ms/step
Epoch 24/50
220/220 - 5s - loss: 3.1848 - accuracy10: 0.4247 - val_loss: 3.2691 - val_accuracy10: 0.3851 - 5s/epoch - 24ms/step
Epoch 25/50
220/220 - 5s - loss: 3.1832 - accuracy10: 0.4240 - val_loss: 3.2712 - val_accuracy10: 0.3850 - 5s/epoch - 24ms/step
Epoch 26/50
220/220 - 5s - loss: 3.1825 - accuracy10: 0.4235 - val_loss: 3.2687 - val_accuracy10: 0.3885 - 5s/epoch - 23ms/step
testing model: results/XRAY/W10/deepOF_L1/h10
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0866729
{'0': {'precision': 0.39902640815644325, 'recall': 0.6397539107423991, 'f1-score': 0.4914969998241498, 'support': 89561}, '1': {'precision': 0.30822851947264734, 'recall': 0.05870383999307329, 'f1-score': 0.09862415903994182, 'support': 69297}, '2': {'precision': 0.40909591818742835, 'recall': 0.41863638414001536, 'f1-score': 0.4138111693233753, 'support': 88676}, 'accuracy': 0.3978766553281569, 'macro avg': {'precision': 0.3721169486055063, 'recall': 0.37236471162516255, 'f1-score': 0.3346441093958223, 'support': 247534}, 'weighted avg': {'precision': 0.3772148694562511, 'recall': 0.3978766553281569, 'f1-score': 0.3536824856430274, 'support': 247534}}
[[57297  4217 28047]
 [39655  4068 25574]
 [46640  4913 37123]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0744725
{'0': {'precision': 0.3866364527192553, 'recall': 0.6765982530411018, 'f1-score': 0.49207864840111465, 'support': 18661}, '1': {'precision': 0.4110054347826087, 'recall': 0.06559332140727489, 'f1-score': 0.11313169089804123, 'support': 18447}, '2': {'precision': 0.4256812351773874, 'recall': 0.459196992638229, 'f1-score': 0.44180439041543174, 'support': 19153}, 'accuracy': 0.4022502266223494, 'macro avg': {'precision': 0.4077743742264171, 'recall': 0.40046285569553525, 'f1-score': 0.3490049099048626, 'support': 56261}, 'weighted avg': {'precision': 0.40791867896022654, 'recall': 0.4022502266223494, 'f1-score': 0.3507136284359704, 'support': 56261}}
[[12626   799  5236]
 [10607  1210  6630]
 [ 9423   935  8795]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0865798
{'0': {'precision': 0.3859449809299684, 'recall': 0.6714668925596499, 'f1-score': 0.4901576831907657, 'support': 7083}, '1': {'precision': 0.32962588473205257, 'recall': 0.05306853328992349, 'f1-score': 0.09141895681435781, 'support': 6143}, '2': {'precision': 0.4051274407512297, 'recall': 0.4, 'f1-score': 0.40254739336492895, 'support': 6795}, 'accuracy': 0.3895909295239998, 'macro avg': {'precision': 0.37356610213775027, 'recall': 0.37484514194985774, 'f1-score': 0.32804134445668415, 'support': 20021}, 'weighted avg': {'precision': 0.37517511961143657, 'recall': 0.3895909295239998, 'f1-score': 0.3380791698549266, 'support': 20021}}
[[4756  312 2015]
 [3841  326 1976]
 [3726  351 2718]]
training model: results/XRAY/W10/deepOF_L1/h20
Epoch 1/50
220/220 - 7s - loss: 3.3221 - accuracy20: 0.3545 - val_loss: 3.3156 - val_accuracy20: 0.3709 - 7s/epoch - 34ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2873 - accuracy20: 0.3730 - val_loss: 3.3021 - val_accuracy20: 0.3789 - 5s/epoch - 23ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2744 - accuracy20: 0.3798 - val_loss: 3.2973 - val_accuracy20: 0.3798 - 5s/epoch - 23ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2664 - accuracy20: 0.3841 - val_loss: 3.2960 - val_accuracy20: 0.3812 - 5s/epoch - 23ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2599 - accuracy20: 0.3851 - val_loss: 3.2825 - val_accuracy20: 0.3824 - 5s/epoch - 23ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2544 - accuracy20: 0.3898 - val_loss: 3.2798 - val_accuracy20: 0.3867 - 5s/epoch - 23ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2484 - accuracy20: 0.3909 - val_loss: 3.2789 - val_accuracy20: 0.3836 - 5s/epoch - 23ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2451 - accuracy20: 0.3934 - val_loss: 3.2720 - val_accuracy20: 0.3909 - 5s/epoch - 23ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2436 - accuracy20: 0.3951 - val_loss: 3.2757 - val_accuracy20: 0.3843 - 5s/epoch - 22ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2396 - accuracy20: 0.3969 - val_loss: 3.2738 - val_accuracy20: 0.3845 - 5s/epoch - 22ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2391 - accuracy20: 0.3953 - val_loss: 3.2678 - val_accuracy20: 0.3888 - 5s/epoch - 23ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2334 - accuracy20: 0.4003 - val_loss: 3.2747 - val_accuracy20: 0.3830 - 5s/epoch - 23ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2305 - accuracy20: 0.4007 - val_loss: 3.2704 - val_accuracy20: 0.3859 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2281 - accuracy20: 0.4045 - val_loss: 3.2726 - val_accuracy20: 0.3834 - 5s/epoch - 23ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2276 - accuracy20: 0.4028 - val_loss: 3.2745 - val_accuracy20: 0.3824 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2231 - accuracy20: 0.4047 - val_loss: 3.2719 - val_accuracy20: 0.3832 - 5s/epoch - 24ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2174 - accuracy20: 0.4073 - val_loss: 3.2757 - val_accuracy20: 0.3888 - 5s/epoch - 23ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2148 - accuracy20: 0.4102 - val_loss: 3.2745 - val_accuracy20: 0.3804 - 5s/epoch - 23ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2127 - accuracy20: 0.4112 - val_loss: 3.2756 - val_accuracy20: 0.3855 - 5s/epoch - 23ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2108 - accuracy20: 0.4094 - val_loss: 3.2748 - val_accuracy20: 0.3845 - 5s/epoch - 23ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2057 - accuracy20: 0.4152 - val_loss: 3.2758 - val_accuracy20: 0.3843 - 5s/epoch - 23ms/step
testing model: results/XRAY/W10/deepOF_L1/h20
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901958
{'0': {'precision': 0.39799988050070206, 'recall': 0.6091215636966337, 'f1-score': 0.48143212709540745, 'support': 87485}, '1': {'precision': 0.3139016085476107, 'recall': 0.07122116255527731, 'f1-score': 0.11610031484095104, 'support': 75076}, '2': {'precision': 0.39750331235508446, 'recall': 0.45193179009803114, 'f1-score': 0.42297376928202846, 'support': 84973}, 'accuracy': 0.3920188741748608, 'macro avg': {'precision': 0.3698016004677991, 'recall': 0.37742483878331406, 'f1-score': 0.34016873707279566, 'support': 247534}, 'weighted avg': {'precision': 0.3723227745266224, 'recall': 0.3920188741748608, 'f1-score': 0.35056108240945794, 'support': 247534}}
[[53289  5479 28717]
 [40240  5347 29489]
 [40363  6208 38402]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801022
{'0': {'precision': 0.38583474964047587, 'recall': 0.6366970497815652, 'f1-score': 0.48049331461017153, 'support': 18541}, '1': {'precision': 0.4056710775047259, 'recall': 0.05758909403177329, 'f1-score': 0.10086008365841048, 'support': 18632}, '2': {'precision': 0.4129452649869679, 'recall': 0.4980092204526404, 'f1-score': 0.45150565213261135, 'support': 19088}, 'accuracy': 0.3978599740495192, 'macro avg': {'precision': 0.40148369737738987, 'recall': 0.3974317880886596, 'f1-score': 0.34428635013373116, 'support': 56261}, 'weighted avg': {'precision': 0.4016019058890414, 'recall': 0.3978599740495192, 'f1-score': 0.34493506181578676, 'support': 56261}}
[[11805   738  5998]
 [10043  1073  7516]
 [ 8748   834  9506]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0897458
{'0': {'precision': 0.3852739726027397, 'recall': 0.6476683937823834, 'f1-score': 0.48314365471333476, 'support': 6948}, '1': {'precision': 0.3263546798029557, 'recall': 0.04226475279106858, 'f1-score': 0.07483761649251625, 'support': 6270}, '2': {'precision': 0.4011156860140789, 'recall': 0.44392179920623254, 'f1-score': 0.4214345520513536, 'support': 6803}, 'accuracy': 0.3888417161979921, 'macro avg': {'precision': 0.37091477947325807, 'recall': 0.37795164859322816, 'f1-score': 0.32647194108573485, 'support': 20021}, 'weighted avg': {'precision': 0.372205055489843, 'recall': 0.3888417161979921, 'f1-score': 0.3343056403756898, 'support': 20021}}
[[4500  273 2175]
 [3671  265 2334]
 [3509  274 3020]]
training model: results/XRAY/W10/deepOF_L1/h30
Epoch 1/50
220/220 - 7s - loss: 3.3219 - accuracy30: 0.3549 - val_loss: 3.3031 - val_accuracy30: 0.3709 - 7s/epoch - 33ms/step
Epoch 2/50
220/220 - 5s - loss: 3.2903 - accuracy30: 0.3721 - val_loss: 3.2923 - val_accuracy30: 0.3769 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2780 - accuracy30: 0.3799 - val_loss: 3.2887 - val_accuracy30: 0.3782 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2694 - accuracy30: 0.3822 - val_loss: 3.2837 - val_accuracy30: 0.3811 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2587 - accuracy30: 0.3887 - val_loss: 3.2809 - val_accuracy30: 0.3845 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2566 - accuracy30: 0.3895 - val_loss: 3.2767 - val_accuracy30: 0.3865 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2502 - accuracy30: 0.3921 - val_loss: 3.2783 - val_accuracy30: 0.3837 - 5s/epoch - 24ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2485 - accuracy30: 0.3934 - val_loss: 3.2720 - val_accuracy30: 0.3879 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2430 - accuracy30: 0.3968 - val_loss: 3.2718 - val_accuracy30: 0.3851 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2406 - accuracy30: 0.3972 - val_loss: 3.2710 - val_accuracy30: 0.3869 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2373 - accuracy30: 0.4004 - val_loss: 3.2713 - val_accuracy30: 0.3861 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2342 - accuracy30: 0.4020 - val_loss: 3.2751 - val_accuracy30: 0.3845 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2323 - accuracy30: 0.4013 - val_loss: 3.2702 - val_accuracy30: 0.3893 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2304 - accuracy30: 0.4029 - val_loss: 3.2678 - val_accuracy30: 0.3825 - 5s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2294 - accuracy30: 0.4049 - val_loss: 3.2681 - val_accuracy30: 0.3899 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2236 - accuracy30: 0.4073 - val_loss: 3.2723 - val_accuracy30: 0.3850 - 5s/epoch - 23ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2224 - accuracy30: 0.4072 - val_loss: 3.2718 - val_accuracy30: 0.3904 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2180 - accuracy30: 0.4086 - val_loss: 3.2713 - val_accuracy30: 0.3859 - 5s/epoch - 23ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2160 - accuracy30: 0.4094 - val_loss: 3.2719 - val_accuracy30: 0.3854 - 5s/epoch - 23ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2128 - accuracy30: 0.4128 - val_loss: 3.2696 - val_accuracy30: 0.3852 - 5s/epoch - 23ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2107 - accuracy30: 0.4118 - val_loss: 3.2699 - val_accuracy30: 0.3899 - 5s/epoch - 23ms/step
Epoch 22/50
220/220 - 5s - loss: 3.2077 - accuracy30: 0.4168 - val_loss: 3.2719 - val_accuracy30: 0.3871 - 5s/epoch - 23ms/step
Epoch 23/50
220/220 - 5s - loss: 3.2060 - accuracy30: 0.4169 - val_loss: 3.2773 - val_accuracy30: 0.3831 - 5s/epoch - 23ms/step
Epoch 24/50
220/220 - 5s - loss: 3.2011 - accuracy30: 0.4175 - val_loss: 3.2748 - val_accuracy30: 0.3885 - 5s/epoch - 24ms/step
testing model: results/XRAY/W10/deepOF_L1/h30
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0906581
{'0': {'precision': 0.40326226454150277, 'recall': 0.5588140804993346, 'f1-score': 0.46846309593086166, 'support': 87156}, '1': {'precision': 0.3316431295310732, 'recall': 0.10349968612680477, 'f1-score': 0.1577641113558663, 'support': 76464}, '2': {'precision': 0.3943982273363396, 'recall': 0.4836141764187144, 'f1-score': 0.43447352925432253, 'support': 83914}, 'accuracy': 0.3926733297244015, 'macro avg': {'precision': 0.37643454046963853, 'recall': 0.3819759810149512, 'f1-score': 0.3535669121803502, 'support': 247534}, 'weighted avg': {'precision': 0.3781339898096617, 'recall': 0.3926733297244015, 'f1-score': 0.3609647819431365, 'support': 247534}}
[[48704  7909 30543]
 [36779  7914 31771]
 [35292  8040 40582]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0772468
{'0': {'precision': 0.39213353522243855, 'recall': 0.5867724011436586, 'f1-score': 0.4701026472177201, 'support': 18537}, '1': {'precision': 0.4316742081447964, 'recall': 0.07717614065365117, 'f1-score': 0.1309420323008647, 'support': 18542}, '2': {'precision': 0.41415423675023805, 'recall': 0.5442602439787301, 'f1-score': 0.47037621085830145, 'support': 19182}, 'accuracy': 0.4043298199463216, 'macro avg': {'precision': 0.41265399337249103, 'recall': 0.40273626192534656, 'f1-score': 0.3571402967922954, 'support': 56261}, 'weighted avg': {'precision': 0.41267288315497813, 'recall': 0.4043298199463216, 'f1-score': 0.35841837882514443, 'support': 56261}}
[[10877   965  6695]
 [ 9038  1431  8073]
 [ 7823   919 10440]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089154
{'0': {'precision': 0.3926815431164902, 'recall': 0.5981564165346392, 'f1-score': 0.4741138192819225, 'support': 6943}, '1': {'precision': 0.3244575936883629, 'recall': 0.051966513978834304, 'f1-score': 0.08958475153165418, 'support': 6331}, '2': {'precision': 0.38987071521764916, 'recall': 0.48717948717948717, 'f1-score': 0.4331268941889577, 'support': 6747}, 'accuracy': 0.3880425553169172, 'macro avg': {'precision': 0.36900328400750076, 'recall': 0.37910080589765355, 'f1-score': 0.33227515500084476, 'support': 20021}, 'weighted avg': {'precision': 0.3701606660542578, 'recall': 0.3880425553169172, 'f1-score': 0.3387063815151185, 'support': 20021}}
[[4153  335 2455]
 [3313  329 2689]
 [3110  350 3287]]
training model: results/XRAY/W10/deepOF_L1/h50
Epoch 1/50
220/220 - 7s - loss: 3.3302 - accuracy50: 0.3528 - val_loss: 3.3165 - val_accuracy50: 0.3600 - 7s/epoch - 33ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3014 - accuracy50: 0.3628 - val_loss: 3.3033 - val_accuracy50: 0.3748 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.2905 - accuracy50: 0.3686 - val_loss: 3.2997 - val_accuracy50: 0.3725 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2780 - accuracy50: 0.3755 - val_loss: 3.2898 - val_accuracy50: 0.3754 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2715 - accuracy50: 0.3785 - val_loss: 3.2917 - val_accuracy50: 0.3736 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2673 - accuracy50: 0.3810 - val_loss: 3.2873 - val_accuracy50: 0.3795 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2612 - accuracy50: 0.3862 - val_loss: 3.2827 - val_accuracy50: 0.3766 - 5s/epoch - 23ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2596 - accuracy50: 0.3863 - val_loss: 3.2811 - val_accuracy50: 0.3806 - 5s/epoch - 23ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2561 - accuracy50: 0.3877 - val_loss: 3.2808 - val_accuracy50: 0.3771 - 5s/epoch - 23ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2537 - accuracy50: 0.3887 - val_loss: 3.2809 - val_accuracy50: 0.3767 - 5s/epoch - 23ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2481 - accuracy50: 0.3922 - val_loss: 3.2805 - val_accuracy50: 0.3759 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2478 - accuracy50: 0.3926 - val_loss: 3.2809 - val_accuracy50: 0.3789 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2444 - accuracy50: 0.3936 - val_loss: 3.2791 - val_accuracy50: 0.3812 - 5s/epoch - 24ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2436 - accuracy50: 0.3943 - val_loss: 3.2800 - val_accuracy50: 0.3755 - 5s/epoch - 24ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2393 - accuracy50: 0.3995 - val_loss: 3.2818 - val_accuracy50: 0.3769 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2361 - accuracy50: 0.4002 - val_loss: 3.2845 - val_accuracy50: 0.3769 - 5s/epoch - 24ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2341 - accuracy50: 0.4013 - val_loss: 3.2832 - val_accuracy50: 0.3773 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2324 - accuracy50: 0.4011 - val_loss: 3.2843 - val_accuracy50: 0.3765 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2278 - accuracy50: 0.4058 - val_loss: 3.2846 - val_accuracy50: 0.3728 - 5s/epoch - 23ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2273 - accuracy50: 0.4042 - val_loss: 3.2832 - val_accuracy50: 0.3734 - 5s/epoch - 23ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2250 - accuracy50: 0.4066 - val_loss: 3.2821 - val_accuracy50: 0.3760 - 5s/epoch - 23ms/step
Epoch 22/50
220/220 - 5s - loss: 3.2214 - accuracy50: 0.4051 - val_loss: 3.2880 - val_accuracy50: 0.3734 - 5s/epoch - 23ms/step
Epoch 23/50
220/220 - 5s - loss: 3.2173 - accuracy50: 0.4098 - val_loss: 3.2927 - val_accuracy50: 0.3694 - 5s/epoch - 23ms/step
testing model: results/XRAY/W10/deepOF_L1/h50
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0942305
{'0': {'precision': 0.400875823464453, 'recall': 0.5830222744038192, 'f1-score': 0.47508890373124907, 'support': 90283}, '1': {'precision': 0.2964246625319227, 'recall': 0.1113898714046777, 'f1-score': 0.161930006377551, 'support': 72942}, '2': {'precision': 0.3926074375978113, 'recall': 0.41360946043720126, 'f1-score': 0.40283489672381123, 'support': 84309}, 'accuracy': 0.3863428862297705, 'macro avg': {'precision': 0.36330264119806227, 'recall': 0.36934053541523265, 'f1-score': 0.34661793561087045, 'support': 247534}, 'weighted avg': {'precision': 0.3672805358483222, 'recall': 0.3863428862297705, 'f1-score': 0.3581995092740694, 'support': 247534}}
[[52637  9791 27855]
 [38724  8125 26093]
 [39944  9494 34871]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825009
{'0': {'precision': 0.38095082289042304, 'recall': 0.629181302350716, 'f1-score': 0.4745659085350941, 'support': 18505}, '1': {'precision': 0.4052763247668865, 'recall': 0.09580645161290323, 'f1-score': 0.15497673609601254, 'support': 18600}, '2': {'precision': 0.40627200600910757, 'recall': 0.4517644602213406, 'f1-score': 0.42781224509973553, 'support': 19156}, 'accuracy': 0.39243881196566005, 'macro avg': {'precision': 0.3974997178888057, 'recall': 0.3922507380616533, 'f1-score': 0.35245162991028073, 'support': 56261}, 'weighted avg': {'precision': 0.3976143539105567, 'recall': 0.39243881196566005, 'f1-score': 0.3529901849586442, 'support': 56261}}
[[11643  1241  5621]
 [ 9792  1782  7026]
 [ 9128  1374  8654]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930626
{'0': {'precision': 0.3784156538229463, 'recall': 0.6337519849862856, 'f1-score': 0.47387737478411046, 'support': 6927}, '1': {'precision': 0.332013201320132, 'recall': 0.07975265577929284, 'f1-score': 0.12861160828432625, 'support': 6307}, '2': {'precision': 0.3878349022447502, 'recall': 0.39457786945631357, 'f1-score': 0.3911773298276366, 'support': 6787}, 'accuracy': 0.3781529394136157, 'macro avg': {'precision': 0.36608791912927613, 'recall': 0.36936083674063064, 'f1-score': 0.3312221042986911, 'support': 20021}, 'weighted avg': {'precision': 0.3669910582035233, 'recall': 0.3781529394136157, 'f1-score': 0.33707719525093394, 'support': 20021}}
[[4390  519 2018]
 [3595  503 2209]
 [3616  493 2678]]
training model: results/XRAY/W10/deepOF_L1/h100
Epoch 1/50
220/220 - 8s - loss: 3.3408 - accuracy100: 0.3429 - val_loss: 3.3153 - val_accuracy100: 0.3503 - 8s/epoch - 34ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3135 - accuracy100: 0.3524 - val_loss: 3.3065 - val_accuracy100: 0.3558 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3011 - accuracy100: 0.3593 - val_loss: 3.3031 - val_accuracy100: 0.3584 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.2940 - accuracy100: 0.3613 - val_loss: 3.3001 - val_accuracy100: 0.3609 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.2872 - accuracy100: 0.3671 - val_loss: 3.2992 - val_accuracy100: 0.3562 - 5s/epoch - 23ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2827 - accuracy100: 0.3677 - val_loss: 3.2963 - val_accuracy100: 0.3601 - 5s/epoch - 24ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2779 - accuracy100: 0.3701 - val_loss: 3.2933 - val_accuracy100: 0.3622 - 5s/epoch - 25ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2760 - accuracy100: 0.3723 - val_loss: 3.2958 - val_accuracy100: 0.3607 - 5s/epoch - 24ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2726 - accuracy100: 0.3759 - val_loss: 3.2977 - val_accuracy100: 0.3599 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2693 - accuracy100: 0.3782 - val_loss: 3.2958 - val_accuracy100: 0.3601 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2664 - accuracy100: 0.3820 - val_loss: 3.2965 - val_accuracy100: 0.3617 - 5s/epoch - 25ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2643 - accuracy100: 0.3802 - val_loss: 3.2978 - val_accuracy100: 0.3583 - 6s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2636 - accuracy100: 0.3828 - val_loss: 3.2936 - val_accuracy100: 0.3575 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2604 - accuracy100: 0.3844 - val_loss: 3.2956 - val_accuracy100: 0.3636 - 5s/epoch - 24ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2573 - accuracy100: 0.3879 - val_loss: 3.2987 - val_accuracy100: 0.3573 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2542 - accuracy100: 0.3878 - val_loss: 3.3008 - val_accuracy100: 0.3596 - 5s/epoch - 24ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2526 - accuracy100: 0.3884 - val_loss: 3.2991 - val_accuracy100: 0.3601 - 5s/epoch - 23ms/step
testing model: results/XRAY/W10/deepOF_L1/h100
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968289
{'0': {'precision': 0.39629106068955605, 'recall': 0.5410238238019953, 'f1-score': 0.4574831970349336, 'support': 91715}, '1': {'precision': 0.2967640649530192, 'recall': 0.17460054868549843, 'f1-score': 0.2198517541271026, 'support': 72537}, '2': {'precision': 0.37531075006905557, 'recall': 0.3589250978602819, 'f1-score': 0.36693508789158397, 'support': 83282}, 'accuracy': 0.37238116783956954, 'macro avg': {'precision': 0.3561219585705436, 'recall': 0.3581831567825919, 'f1-score': 0.3480900130178734, 'support': 247534}, 'weighted avg': {'precision': 0.3600670594661375, 'recall': 0.37238116783956954, 'f1-score': 0.3573834143792912, 'support': 247534}}
[[49620 15612 26483]
 [36601 12665 23271]
 [38990 14400 29892]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908357
{'0': {'precision': 0.35993535742530003, 'recall': 0.571615792060285, 'f1-score': 0.44172504008777114, 'support': 18313}, '1': {'precision': 0.36327726809378186, 'recall': 0.15538478308262482, 'f1-score': 0.21766681936173465, 'support': 18348}, '2': {'precision': 0.40181065700982926, 'recall': 0.39627551020408164, 'f1-score': 0.39902388903159514, 'support': 19600}, 'accuracy': 0.3747889301647678, 'macro avg': {'precision': 0.37500776084297033, 'recall': 0.3744253617823305, 'f1-score': 0.35280524949370035, 'support': 56261}, 'weighted avg': {'precision': 0.37561359366002883, 'recall': 0.3747889301647678, 'f1-score': 0.3537784555161786, 'support': 56261}}
[[10468  2360  5485]
 [ 9419  2851  6078]
 [ 9196  2637  7767]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985082
{'0': {'precision': 0.36026141417808843, 'recall': 0.5804328751096812, 'f1-score': 0.4445813497619715, 'support': 6838}, '1': {'precision': 0.3241017964071856, 'recall': 0.13405572755417958, 'f1-score': 0.1896627244853263, 'support': 6460}, '2': {'precision': 0.3681301326595073, 'recall': 0.3467202141900937, 'f1-score': 0.35710455764075066, 'support': 6723}, 'accuracy': 0.35792417961140804, 'macro avg': {'precision': 0.35083111441492715, 'recall': 0.3537362722846515, 'f1-score': 0.33044954396268283, 'support': 20021}, 'weighted avg': {'precision': 0.3512364036167052, 'recall': 0.35792417961140804, 'f1-score': 0.3329545182991027, 'support': 20021}}
[[3969  896 1973]
 [3566  866 2028]
 [3482  910 2331]]
training model: results/XRAY/W10/deepOF_L1/h200
Epoch 1/50
220/220 - 7s - loss: 3.3553 - accuracy200: 0.3356 - val_loss: 3.3322 - val_accuracy200: 0.3450 - 7s/epoch - 33ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3323 - accuracy200: 0.3376 - val_loss: 3.3217 - val_accuracy200: 0.3457 - 5s/epoch - 24ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3182 - accuracy200: 0.3436 - val_loss: 3.3164 - val_accuracy200: 0.3477 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3080 - accuracy200: 0.3474 - val_loss: 3.3126 - val_accuracy200: 0.3525 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 5s - loss: 3.3012 - accuracy200: 0.3493 - val_loss: 3.3110 - val_accuracy200: 0.3504 - 5s/epoch - 24ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2985 - accuracy200: 0.3502 - val_loss: 3.3118 - val_accuracy200: 0.3476 - 5s/epoch - 25ms/step
Epoch 7/50
220/220 - 5s - loss: 3.2930 - accuracy200: 0.3583 - val_loss: 3.3077 - val_accuracy200: 0.3499 - 5s/epoch - 25ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2912 - accuracy200: 0.3582 - val_loss: 3.3054 - val_accuracy200: 0.3510 - 5s/epoch - 25ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2870 - accuracy200: 0.3604 - val_loss: 3.3055 - val_accuracy200: 0.3526 - 5s/epoch - 25ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2839 - accuracy200: 0.3626 - val_loss: 3.3062 - val_accuracy200: 0.3499 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2819 - accuracy200: 0.3665 - val_loss: 3.3055 - val_accuracy200: 0.3514 - 5s/epoch - 24ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2791 - accuracy200: 0.3682 - val_loss: 3.3054 - val_accuracy200: 0.3484 - 5s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2777 - accuracy200: 0.3679 - val_loss: 3.3065 - val_accuracy200: 0.3527 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2757 - accuracy200: 0.3716 - val_loss: 3.3061 - val_accuracy200: 0.3512 - 5s/epoch - 24ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2715 - accuracy200: 0.3717 - val_loss: 3.3100 - val_accuracy200: 0.3444 - 5s/epoch - 25ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2683 - accuracy200: 0.3765 - val_loss: 3.3088 - val_accuracy200: 0.3506 - 5s/epoch - 25ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2683 - accuracy200: 0.3765 - val_loss: 3.3082 - val_accuracy200: 0.3489 - 5s/epoch - 25ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2636 - accuracy200: 0.3820 - val_loss: 3.3083 - val_accuracy200: 0.3482 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2617 - accuracy200: 0.3808 - val_loss: 3.3107 - val_accuracy200: 0.3506 - 5s/epoch - 24ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2603 - accuracy200: 0.3822 - val_loss: 3.3113 - val_accuracy200: 0.3486 - 5s/epoch - 25ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2568 - accuracy200: 0.3840 - val_loss: 3.3120 - val_accuracy200: 0.3474 - 5s/epoch - 25ms/step
Epoch 22/50
220/220 - 6s - loss: 3.2538 - accuracy200: 0.3869 - val_loss: 3.3163 - val_accuracy200: 0.3487 - 6s/epoch - 25ms/step
testing model: results/XRAY/W10/deepOF_L1/h200
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095668
{'0': {'precision': 0.4033461390443654, 'recall': 0.6166264115109101, 'f1-score': 0.4876874033135641, 'support': 96882}, '1': {'precision': 0.2695020832473908, 'recall': 0.09690002966478789, 'f1-score': 0.14254699381416305, 'support': 67420}, '2': {'precision': 0.3620414460908196, 'recall': 0.32702566320645904, 'f1-score': 0.3436438698599871, 'support': 83232}, 'accuracy': 0.3776935693682484, 'macro avg': {'precision': 0.34496322279419195, 'recall': 0.346850701460719, 'f1-score': 0.3246260889959047, 'support': 247534}, 'weighted avg': {'precision': 0.3530030005432239, 'recall': 0.3776935693682484, 'f1-score': 0.34524879776904194, 'support': 247534}}
[[59740  9433 27709]
 [40633  6533 20254]
 [47738  8275 27219]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0932033
{'0': {'precision': 0.3403926823584246, 'recall': 0.6543285922275731, 'f1-score': 0.44782125474265133, 'support': 17858}, '1': {'precision': 0.3871260199456029, 'recall': 0.09185264856144125, 'f1-score': 0.1484765506150302, 'support': 18595}, '2': {'precision': 0.4003196164602477, 'recall': 0.35409935379644586, 'f1-score': 0.37579361890219404, 'support': 19808}, 'accuracy': 0.3627201791649633, 'macro avg': {'precision': 0.3759461062547584, 'recall': 0.3667601981951534, 'f1-score': 0.32403047475329183, 'support': 56261}, 'weighted avg': {'precision': 0.3769373424804006, 'recall': 0.3627201791649633, 'f1-score': 0.3235248827624005, 'support': 56261}}
[[11685  1270  4903]
 [11283  1708  5604]
 [11360  1434  7014]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008029
{'0': {'precision': 0.3545390679884474, 'recall': 0.6563583815028902, 'f1-score': 0.4603922761137296, 'support': 6920}, '1': {'precision': 0.32008670520231214, 'recall': 0.06870347394540943, 'f1-score': 0.11312563840653729, 'support': 6448}, '2': {'precision': 0.3410573292138689, 'recall': 0.2986622576281377, 'f1-score': 0.3184550044074045, 'support': 6653}, 'accuracy': 0.3482343539283752, 'macro avg': {'precision': 0.33856103413487615, 'recall': 0.3412413710254791, 'f1-score': 0.2973243063092238, 'support': 20021}, 'weighted avg': {'precision': 0.3389632803998019, 'recall': 0.3482343539283752, 'f1-score': 0.3013850362856413, 'support': 20021}}
[[4542  465 1913]
 [4079  443 1926]
 [4190  476 1987]]
training model: results/XRAY/W10/deepOF_L1/h300
Epoch 1/50
220/220 - 7s - loss: 3.3541 - accuracy300: 0.3321 - val_loss: 3.3327 - val_accuracy300: 0.3359 - 7s/epoch - 32ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3358 - accuracy300: 0.3347 - val_loss: 3.3282 - val_accuracy300: 0.3409 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3196 - accuracy300: 0.3396 - val_loss: 3.3218 - val_accuracy300: 0.3414 - 5s/epoch - 25ms/step
Epoch 4/50
220/220 - 12s - loss: 3.3106 - accuracy300: 0.3459 - val_loss: 3.3207 - val_accuracy300: 0.3398 - 12s/epoch - 56ms/step
Epoch 5/50
220/220 - 6s - loss: 3.3038 - accuracy300: 0.3478 - val_loss: 3.3154 - val_accuracy300: 0.3406 - 6s/epoch - 28ms/step
Epoch 6/50
220/220 - 5s - loss: 3.2998 - accuracy300: 0.3502 - val_loss: 3.3158 - val_accuracy300: 0.3398 - 5s/epoch - 25ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2961 - accuracy300: 0.3505 - val_loss: 3.3148 - val_accuracy300: 0.3441 - 6s/epoch - 26ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2935 - accuracy300: 0.3517 - val_loss: 3.3127 - val_accuracy300: 0.3404 - 6s/epoch - 26ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2893 - accuracy300: 0.3567 - val_loss: 3.3111 - val_accuracy300: 0.3413 - 6s/epoch - 25ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2871 - accuracy300: 0.3596 - val_loss: 3.3114 - val_accuracy300: 0.3462 - 5s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2848 - accuracy300: 0.3601 - val_loss: 3.3105 - val_accuracy300: 0.3434 - 5s/epoch - 25ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2813 - accuracy300: 0.3622 - val_loss: 3.3153 - val_accuracy300: 0.3407 - 6s/epoch - 26ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2801 - accuracy300: 0.3641 - val_loss: 3.3100 - val_accuracy300: 0.3473 - 6s/epoch - 25ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2768 - accuracy300: 0.3653 - val_loss: 3.3112 - val_accuracy300: 0.3443 - 6s/epoch - 25ms/step
Epoch 15/50
220/220 - 6s - loss: 3.2737 - accuracy300: 0.3706 - val_loss: 3.3113 - val_accuracy300: 0.3417 - 6s/epoch - 25ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2736 - accuracy300: 0.3680 - val_loss: 3.3140 - val_accuracy300: 0.3393 - 5s/epoch - 23ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2710 - accuracy300: 0.3729 - val_loss: 3.3157 - val_accuracy300: 0.3371 - 5s/epoch - 25ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2670 - accuracy300: 0.3753 - val_loss: 3.3140 - val_accuracy300: 0.3436 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2670 - accuracy300: 0.3741 - val_loss: 3.3156 - val_accuracy300: 0.3417 - 5s/epoch - 24ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2641 - accuracy300: 0.3760 - val_loss: 3.3191 - val_accuracy300: 0.3414 - 5s/epoch - 24ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2642 - accuracy300: 0.3760 - val_loss: 3.3164 - val_accuracy300: 0.3403 - 5s/epoch - 23ms/step
Epoch 22/50
220/220 - 5s - loss: 3.2587 - accuracy300: 0.3817 - val_loss: 3.3149 - val_accuracy300: 0.3441 - 5s/epoch - 23ms/step
Epoch 23/50
220/220 - 5s - loss: 3.2566 - accuracy300: 0.3825 - val_loss: 3.3194 - val_accuracy300: 0.3419 - 5s/epoch - 25ms/step
testing model: results/XRAY/W10/deepOF_L1/h300
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987364
{'0': {'precision': 0.39754216470652814, 'recall': 0.5989248979169897, 'f1-score': 0.47788413555323683, 'support': 96735}, '1': {'precision': 0.2755448627228984, 'recall': 0.1414107666831295, 'f1-score': 0.1869024305955535, 'support': 68842}, '2': {'precision': 0.3483134234044474, 'recall': 0.28247739668362676, 'f1-score': 0.31195973669849014, 'support': 81957}, 'accuracy': 0.3669112121971123, 'macro avg': {'precision': 0.3404668169446246, 'recall': 0.34093768709458194, 'f1-score': 0.3255821009490935, 'support': 247534}, 'weighted avg': {'precision': 0.34731400124594625, 'recall': 0.3669112121971123, 'f1-score': 0.34202228025402415, 'support': 247534}}
[[57937 13999 24799]
 [40591  9735 18516]
 [47210 11596 23151]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953287
{'0': {'precision': 0.3279719298245614, 'recall': 0.6745179540468768, 'f1-score': 0.4413470073847432, 'support': 17322}, '1': {'precision': 0.40702274975272007, 'recall': 0.12746515229736707, 'f1-score': 0.19413429784557323, 'support': 19370}, '2': {'precision': 0.4002745367192862, 'recall': 0.29802238233941436, 'f1-score': 0.3416620287647559, 'support': 19569}, 'accuracy': 0.35521942375713195, 'macro avg': {'precision': 0.3784230720988559, 'recall': 0.3666684962278861, 'f1-score': 0.32571444466502414, 'support': 56261}, 'weighted avg': {'precision': 0.38033687350368733, 'recall': 0.35521942375713195, 'f1-score': 0.32156162265307736, 'support': 56261}}
[[11684  1644  3994]
 [12157  2469  4744]
 [11784  1953  5832]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031951
{'0': {'precision': 0.3421092109210921, 'recall': 0.6733097136108651, 'f1-score': 0.4536954143041878, 'support': 6774}, '1': {'precision': 0.3372872614749871, 'recall': 0.09596478356566397, 'f1-score': 0.14941740918437285, 'support': 6815}, '2': {'precision': 0.3336842105263158, 'recall': 0.24642412935323382, 'f1-score': 0.2834913253443033, 'support': 6432}, 'accuracy': 0.33964337445682036, 'macro avg': {'precision': 0.33769356097413167, 'recall': 0.33856620884325433, 'f1-score': 0.29553471627762135, 'support': 20021}, 'weighted avg': {'precision': 0.3377612169140791, 'recall': 0.33964337445682036, 'f1-score': 0.2954412159583751, 'support': 20021}}
[[4561  677 1536]
 [4532  654 1629]
 [4239  608 1585]]
training model: results/XRAY/W10/deepOF_L1/h500
Epoch 1/50
220/220 - 8s - loss: 3.3507 - accuracy500: 0.3377 - val_loss: 3.3477 - val_accuracy500: 0.3453 - 8s/epoch - 35ms/step
Epoch 2/50
220/220 - 5s - loss: 3.3335 - accuracy500: 0.3400 - val_loss: 3.3441 - val_accuracy500: 0.3485 - 5s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3202 - accuracy500: 0.3430 - val_loss: 3.3394 - val_accuracy500: 0.3473 - 5s/epoch - 24ms/step
Epoch 4/50
220/220 - 5s - loss: 3.3152 - accuracy500: 0.3423 - val_loss: 3.3328 - val_accuracy500: 0.3473 - 5s/epoch - 24ms/step
Epoch 5/50
220/220 - 6s - loss: 3.3073 - accuracy500: 0.3481 - val_loss: 3.3290 - val_accuracy500: 0.3472 - 6s/epoch - 25ms/step
Epoch 6/50
220/220 - 6s - loss: 3.3025 - accuracy500: 0.3511 - val_loss: 3.3282 - val_accuracy500: 0.3463 - 6s/epoch - 26ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2995 - accuracy500: 0.3523 - val_loss: 3.3240 - val_accuracy500: 0.3478 - 6s/epoch - 25ms/step
Epoch 8/50
220/220 - 5s - loss: 3.2972 - accuracy500: 0.3519 - val_loss: 3.3233 - val_accuracy500: 0.3500 - 5s/epoch - 25ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2928 - accuracy500: 0.3572 - val_loss: 3.3243 - val_accuracy500: 0.3485 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2912 - accuracy500: 0.3601 - val_loss: 3.3213 - val_accuracy500: 0.3528 - 6s/epoch - 25ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2884 - accuracy500: 0.3597 - val_loss: 3.3205 - val_accuracy500: 0.3488 - 5s/epoch - 25ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2853 - accuracy500: 0.3637 - val_loss: 3.3224 - val_accuracy500: 0.3466 - 6s/epoch - 25ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2836 - accuracy500: 0.3654 - val_loss: 3.3201 - val_accuracy500: 0.3495 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2818 - accuracy500: 0.3649 - val_loss: 3.3216 - val_accuracy500: 0.3454 - 5s/epoch - 25ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2803 - accuracy500: 0.3673 - val_loss: 3.3220 - val_accuracy500: 0.3443 - 5s/epoch - 24ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2775 - accuracy500: 0.3703 - val_loss: 3.3221 - val_accuracy500: 0.3461 - 5s/epoch - 25ms/step
Epoch 17/50
220/220 - 6s - loss: 3.2737 - accuracy500: 0.3727 - val_loss: 3.3210 - val_accuracy500: 0.3481 - 6s/epoch - 25ms/step
Epoch 18/50
220/220 - 6s - loss: 3.2724 - accuracy500: 0.3723 - val_loss: 3.3223 - val_accuracy500: 0.3492 - 6s/epoch - 25ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2714 - accuracy500: 0.3734 - val_loss: 3.3234 - val_accuracy500: 0.3481 - 5s/epoch - 25ms/step
Epoch 20/50
220/220 - 6s - loss: 3.2691 - accuracy500: 0.3766 - val_loss: 3.3261 - val_accuracy500: 0.3479 - 6s/epoch - 26ms/step
Epoch 21/50
220/220 - 6s - loss: 3.2661 - accuracy500: 0.3769 - val_loss: 3.3238 - val_accuracy500: 0.3490 - 6s/epoch - 25ms/step
Epoch 22/50
220/220 - 6s - loss: 3.2650 - accuracy500: 0.3786 - val_loss: 3.3285 - val_accuracy500: 0.3531 - 6s/epoch - 25ms/step
Epoch 23/50
220/220 - 6s - loss: 3.2610 - accuracy500: 0.3810 - val_loss: 3.3290 - val_accuracy500: 0.3467 - 6s/epoch - 25ms/step
testing model: results/XRAY/W10/deepOF_L1/h500
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091452
{'0': {'precision': 0.41619668406041543, 'recall': 0.7007030102247069, 'f1-score': 0.5222138941551666, 'support': 101421}, '1': {'precision': 0.27853648593558905, 'recall': 0.08452272340688738, 'f1-score': 0.1296904843818585, 'support': 64669}, '2': {'precision': 0.341118633985899, 'recall': 0.2394037620941997, 'f1-score': 0.28135033152240574, 'support': 81444}, 'accuracy': 0.3879467063110522, 'macro avg': {'precision': 0.34528393466063445, 'recall': 0.34154316524193135, 'f1-score': 0.3110849033531436, 'support': 247534}, 'weighted avg': {'precision': 0.35553025414451167, 'recall': 0.3879467063110522, 'f1-score': 0.34041669303656213, 'support': 247534}}
[[71066  7825 22530]
 [44072  5466 15131]
 [55613  6333 19498]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955523
{'0': {'precision': 0.3328151566674763, 'recall': 0.7669745312062692, 'f1-score': 0.4641992038621157, 'support': 17865}, '1': {'precision': 0.3941475067184234, 'recall': 0.07480448826929616, 'f1-score': 0.12574422481543224, 'support': 17646}, '2': {'precision': 0.4194345086016011, 'recall': 0.23734939759036144, 'f1-score': 0.3031515449956913, 'support': 20750}, 'accuracy': 0.3545440002843888, 'macro avg': {'precision': 0.38213239066250027, 'recall': 0.359709472355309, 'f1-score': 0.2976983245577464, 'support': 56261}, 'weighted avg': {'precision': 0.3839984310783844, 'recall': 0.3545440002843888, 'f1-score': 0.29864730322515437, 'support': 56261}}
[[13702   908  3255]
 [12764  1320  3562]
 [14704  1121  4925]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102251
{'0': {'precision': 0.3525032938076416, 'recall': 0.7660701503221188, 'f1-score': 0.48283329573652156, 'support': 6985}, '1': {'precision': 0.3065989847715736, 'recall': 0.048639072314382345, 'f1-score': 0.08395885460105643, 'support': 6209}, '2': {'precision': 0.33895228215767637, 'recall': 0.1914457301889556, 'f1-score': 0.2446878217729102, 'support': 6827}, 'accuracy': 0.34763498326756903, 'macro avg': {'precision': 0.3326848535789639, 'recall': 0.33538498427515223, 'f1-score': 0.2704933240368294, 'support': 20021}, 'weighted avg': {'precision': 0.33364646291311784, 'recall': 0.34763498326756903, 'f1-score': 0.27792691964343536, 'support': 20021}}
[[5351  340 1294]
 [4652  302 1255]
 [5177  343 1307]]
training model: results/XRAY/W10/deepOF_L1/h1000
Epoch 1/50
220/220 - 7s - loss: 3.3673 - accuracy1000: 0.3342 - val_loss: 3.3546 - val_accuracy1000: 0.3364 - 7s/epoch - 33ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3441 - accuracy1000: 0.3327 - val_loss: 3.3447 - val_accuracy1000: 0.3337 - 6s/epoch - 25ms/step
Epoch 3/50
220/220 - 5s - loss: 3.3317 - accuracy1000: 0.3340 - val_loss: 3.3412 - val_accuracy1000: 0.3386 - 5s/epoch - 25ms/step
Epoch 4/50
220/220 - 6s - loss: 3.3203 - accuracy1000: 0.3388 - val_loss: 3.3375 - val_accuracy1000: 0.3364 - 6s/epoch - 25ms/step
Epoch 5/50
220/220 - 6s - loss: 3.3166 - accuracy1000: 0.3401 - val_loss: 3.3336 - val_accuracy1000: 0.3388 - 6s/epoch - 25ms/step
Epoch 6/50
220/220 - 6s - loss: 3.3096 - accuracy1000: 0.3430 - val_loss: 3.3314 - val_accuracy1000: 0.3384 - 6s/epoch - 25ms/step
Epoch 7/50
220/220 - 5s - loss: 3.3045 - accuracy1000: 0.3471 - val_loss: 3.3309 - val_accuracy1000: 0.3358 - 5s/epoch - 25ms/step
Epoch 8/50
220/220 - 6s - loss: 3.3019 - accuracy1000: 0.3462 - val_loss: 3.3310 - val_accuracy1000: 0.3389 - 6s/epoch - 25ms/step
Epoch 9/50
220/220 - 5s - loss: 3.2992 - accuracy1000: 0.3479 - val_loss: 3.3279 - val_accuracy1000: 0.3364 - 5s/epoch - 24ms/step
Epoch 10/50
220/220 - 5s - loss: 3.2958 - accuracy1000: 0.3533 - val_loss: 3.3287 - val_accuracy1000: 0.3418 - 5s/epoch - 24ms/step
Epoch 11/50
220/220 - 5s - loss: 3.2925 - accuracy1000: 0.3560 - val_loss: 3.3291 - val_accuracy1000: 0.3418 - 5s/epoch - 25ms/step
Epoch 12/50
220/220 - 5s - loss: 3.2909 - accuracy1000: 0.3555 - val_loss: 3.3278 - val_accuracy1000: 0.3378 - 5s/epoch - 24ms/step
Epoch 13/50
220/220 - 5s - loss: 3.2877 - accuracy1000: 0.3559 - val_loss: 3.3261 - val_accuracy1000: 0.3462 - 5s/epoch - 25ms/step
Epoch 14/50
220/220 - 5s - loss: 3.2848 - accuracy1000: 0.3586 - val_loss: 3.3283 - val_accuracy1000: 0.3433 - 5s/epoch - 24ms/step
Epoch 15/50
220/220 - 5s - loss: 3.2838 - accuracy1000: 0.3618 - val_loss: 3.3282 - val_accuracy1000: 0.3408 - 5s/epoch - 25ms/step
Epoch 16/50
220/220 - 5s - loss: 3.2804 - accuracy1000: 0.3640 - val_loss: 3.3280 - val_accuracy1000: 0.3423 - 5s/epoch - 24ms/step
Epoch 17/50
220/220 - 5s - loss: 3.2782 - accuracy1000: 0.3705 - val_loss: 3.3266 - val_accuracy1000: 0.3430 - 5s/epoch - 24ms/step
Epoch 18/50
220/220 - 5s - loss: 3.2788 - accuracy1000: 0.3642 - val_loss: 3.3288 - val_accuracy1000: 0.3412 - 5s/epoch - 24ms/step
Epoch 19/50
220/220 - 5s - loss: 3.2774 - accuracy1000: 0.3672 - val_loss: 3.3290 - val_accuracy1000: 0.3372 - 5s/epoch - 24ms/step
Epoch 20/50
220/220 - 5s - loss: 3.2727 - accuracy1000: 0.3699 - val_loss: 3.3308 - val_accuracy1000: 0.3402 - 5s/epoch - 24ms/step
Epoch 21/50
220/220 - 5s - loss: 3.2732 - accuracy1000: 0.3667 - val_loss: 3.3329 - val_accuracy1000: 0.3389 - 5s/epoch - 25ms/step
Epoch 22/50
220/220 - 5s - loss: 3.2690 - accuracy1000: 0.3742 - val_loss: 3.3333 - val_accuracy1000: 0.3421 - 5s/epoch - 24ms/step
Epoch 23/50
220/220 - 5s - loss: 3.2684 - accuracy1000: 0.3736 - val_loss: 3.3324 - val_accuracy1000: 0.3430 - 5s/epoch - 24ms/step
testing model: results/XRAY/W10/deepOF_L1/h1000
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0925691
{'0': {'precision': 0.4239258299272256, 'recall': 0.6090402169346523, 'f1-score': 0.4998961586539026, 'support': 104732}, '1': {'precision': 0.26064148681055155, 'recall': 0.11045302253203551, 'f1-score': 0.15515530028439192, 'support': 62977}, '2': {'precision': 0.3256134468109291, 'recall': 0.2870905104917006, 'f1-score': 0.30514093977604095, 'support': 79825}, 'accuracy': 0.37836822416314525, 'macro avg': {'precision': 0.33672692118290204, 'recall': 0.3355279166527961, 'f1-score': 0.3200641329047785, 'support': 247534}, 'weighted avg': {'precision': 0.35067955241093635, 'recall': 0.37836822416314525, 'f1-score': 0.3493831770656683, 'support': 247534}}
[[63786 11242 29704]
 [38261  6956 17760]
 [48418  8490 22917]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961583
{'0': {'precision': 0.3239714285714286, 'recall': 0.655736756881795, 'f1-score': 0.4336801040312094, 'support': 17292}, '1': {'precision': 0.38722150616829315, 'recall': 0.11467989966190424, 'f1-score': 0.17695317430266314, 'support': 18338}, '2': {'precision': 0.3983575489576753, 'recall': 0.30565653628035483, 'f1-score': 0.34590384246180855, 'support': 20631}, 'accuracy': 0.35100691420344465, 'macro avg': {'precision': 0.3698501612324656, 'recall': 0.3586910642746847, 'f1-score': 0.3188457069318937, 'support': 56261}, 'weighted avg': {'precision': 0.37186499556561564, 'recall': 0.35100691420344465, 'f1-score': 0.31781350923551804, 'support': 56261}}
[[11339  1465  4488]
 [11199  2103  5036]
 [12462  1863  6306]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042309
{'0': {'precision': 0.3396401985111663, 'recall': 0.6466853683744279, 'f1-score': 0.44537088819970516, 'support': 6773}, '1': {'precision': 0.3325046612802983, 'recall': 0.08010181164845037, 'f1-score': 0.1291023166023166, 'support': 6679}, '2': {'precision': 0.32704858593183467, 'recall': 0.2746232303242503, 'f1-score': 0.2985519238725693, 'support': 6569}, 'accuracy': 0.3355976224963788, 'macro avg': {'precision': 0.3330644819077664, 'recall': 0.33380347011570954, 'f1-score': 0.2910083762248637, 'support': 20021}, 'weighted avg': {'precision': 0.33312840808118793, 'recall': 0.3355976224963788, 'f1-score': 0.2916916730574089, 'support': 20021}}
[[4380  548 1845]
 [4277  535 1867]
 [4239  526 1804]]
training model: results/XRAY/W10/deepLOB_L2/h10
Epoch 1/50
220/220 - 14s - loss: 3.3559 - accuracy10: 0.3443 - val_loss: 3.4025 - val_accuracy10: 0.3375 - 14s/epoch - 63ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3117 - accuracy10: 0.3613 - val_loss: 3.3446 - val_accuracy10: 0.3541 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.2787 - accuracy10: 0.3771 - val_loss: 3.3008 - val_accuracy10: 0.3757 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2443 - accuracy10: 0.4011 - val_loss: 3.2926 - val_accuracy10: 0.3790 - 11s/epoch - 51ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2090 - accuracy10: 0.4209 - val_loss: 3.2853 - val_accuracy10: 0.3956 - 11s/epoch - 50ms/step
Epoch 6/50
220/220 - 11s - loss: 3.1819 - accuracy10: 0.4327 - val_loss: 3.2796 - val_accuracy10: 0.3991 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.1669 - accuracy10: 0.4393 - val_loss: 3.3067 - val_accuracy10: 0.3823 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.1504 - accuracy10: 0.4460 - val_loss: 3.3253 - val_accuracy10: 0.3807 - 11s/epoch - 49ms/step
Epoch 9/50
220/220 - 11s - loss: 3.1442 - accuracy10: 0.4508 - val_loss: 3.2725 - val_accuracy10: 0.4006 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1276 - accuracy10: 0.4575 - val_loss: 3.2561 - val_accuracy10: 0.4145 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1190 - accuracy10: 0.4606 - val_loss: 3.2625 - val_accuracy10: 0.4137 - 11s/epoch - 49ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1120 - accuracy10: 0.4622 - val_loss: 3.2932 - val_accuracy10: 0.4049 - 11s/epoch - 49ms/step
Epoch 13/50
220/220 - 11s - loss: 3.0962 - accuracy10: 0.4684 - val_loss: 3.2822 - val_accuracy10: 0.4113 - 11s/epoch - 49ms/step
Epoch 14/50
220/220 - 11s - loss: 3.0915 - accuracy10: 0.4685 - val_loss: 3.2418 - val_accuracy10: 0.4217 - 11s/epoch - 50ms/step
Epoch 15/50
220/220 - 11s - loss: 3.0810 - accuracy10: 0.4729 - val_loss: 3.2572 - val_accuracy10: 0.4108 - 11s/epoch - 50ms/step
Epoch 16/50
220/220 - 11s - loss: 3.0685 - accuracy10: 0.4777 - val_loss: 3.2401 - val_accuracy10: 0.4240 - 11s/epoch - 49ms/step
Epoch 17/50
220/220 - 11s - loss: 3.0620 - accuracy10: 0.4784 - val_loss: 3.2649 - val_accuracy10: 0.4134 - 11s/epoch - 50ms/step
Epoch 18/50
220/220 - 11s - loss: 3.0509 - accuracy10: 0.4825 - val_loss: 3.2620 - val_accuracy10: 0.4155 - 11s/epoch - 50ms/step
Epoch 19/50
220/220 - 11s - loss: 3.0469 - accuracy10: 0.4837 - val_loss: 3.3142 - val_accuracy10: 0.3939 - 11s/epoch - 50ms/step
Epoch 20/50
220/220 - 11s - loss: 3.0381 - accuracy10: 0.4858 - val_loss: 3.3382 - val_accuracy10: 0.3923 - 11s/epoch - 49ms/step
Epoch 21/50
220/220 - 11s - loss: 3.0248 - accuracy10: 0.4899 - val_loss: 3.2809 - val_accuracy10: 0.4036 - 11s/epoch - 50ms/step
Epoch 22/50
220/220 - 11s - loss: 3.0178 - accuracy10: 0.4917 - val_loss: 3.3326 - val_accuracy10: 0.3948 - 11s/epoch - 50ms/step
Epoch 23/50
220/220 - 11s - loss: 3.0058 - accuracy10: 0.4978 - val_loss: 3.2972 - val_accuracy10: 0.3964 - 11s/epoch - 50ms/step
Epoch 24/50
220/220 - 11s - loss: 3.0026 - accuracy10: 0.5007 - val_loss: 3.2895 - val_accuracy10: 0.4029 - 11s/epoch - 50ms/step
Epoch 25/50
220/220 - 11s - loss: 2.9860 - accuracy10: 0.5039 - val_loss: 3.2906 - val_accuracy10: 0.4083 - 11s/epoch - 50ms/step
Epoch 26/50
220/220 - 11s - loss: 2.9806 - accuracy10: 0.5054 - val_loss: 3.3420 - val_accuracy10: 0.3878 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h10
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1152023
{'0': {'precision': 0.44240533749241834, 'recall': 0.2850427636720931, 'f1-score': 0.34670360637481584, 'support': 89562}, '1': {'precision': 0.2930493022877644, 'recall': 0.4160930487611296, 'f1-score': 0.34389647563957304, 'support': 69297}, '2': {'precision': 0.42868078870528536, 'recall': 0.4420275146594497, 'f1-score': 0.4352518584729154, 'support': 88680}, 'accuracy': 0.37796872412023963, 'macro avg': {'precision': 0.3880451428284893, 'recall': 0.38105444236422414, 'f1-score': 0.3752839801624348, 'support': 247539}, 'weighted avg': {'precision': 0.39567727380136414, 'recall': 0.37796872412023963, 'f1-score': 0.3776398760434311, 'support': 247539}}
[[25529 36493 27540]
 [15761 28834 24702]
 [16415 33066 39199]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0583668
{'0': {'precision': 0.44260511753298964, 'recall': 0.49850841679096525, 'f1-score': 0.4688964048603282, 'support': 18772}, '1': {'precision': 0.420545874114745, 'recall': 0.28610870506712865, 'f1-score': 0.3405393214987596, 'support': 18472}, '2': {'precision': 0.44535579694081134, 'recall': 0.5281005204773671, 'f1-score': 0.48321146815470456, 'support': 19021}, 'accuracy': 0.4387807695725584, 'macro avg': {'precision': 0.4361689295295153, 'recall': 0.43757254744515367, 'f1-score': 0.4308823981712641, 'support': 56265}, 'weighted avg': {'precision': 0.43629288663623966, 'recall': 0.4387807695725584, 'f1-score': 0.43159568105454194, 'support': 56265}}
[[ 9358  3766  5648]
 [ 6325  5285  6862]
 [ 5460  3516 10045]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0803496
{'0': {'precision': 0.4349848802046988, 'recall': 0.5315520181921546, 'f1-score': 0.4784444160163745, 'support': 7036}, '1': {'precision': 0.3551377118644068, 'recall': 0.2191892775416803, 'f1-score': 0.2710733778047302, 'support': 6118}, '2': {'precision': 0.44357264286648357, 'recall': 0.4939566040483472, 'f1-score': 0.46741077580267326, 'support': 6867}, 'accuracy': 0.4232056340842116, 'macro avg': {'precision': 0.4112317449785297, 'recall': 0.414899299927394, 'f1-score': 0.4056428565412593, 'support': 20021}, 'weighted avg': {'precision': 0.41353076653867654, 'recall': 0.4232056340842116, 'f1-score': 0.4112917253852209, 'support': 20021}}
[[3740 1309 1987]
 [2509 1341 2268]
 [2349 1126 3392]]
training model: results/XRAY/W10/deepLOB_L2/h20
Epoch 1/50
220/220 - 14s - loss: 3.3666 - accuracy20: 0.3421 - val_loss: 3.3500 - val_accuracy20: 0.3393 - 14s/epoch - 62ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3099 - accuracy20: 0.3577 - val_loss: 3.3618 - val_accuracy20: 0.3316 - 11s/epoch - 51ms/step
Epoch 3/50
220/220 - 11s - loss: 3.2909 - accuracy20: 0.3671 - val_loss: 3.3493 - val_accuracy20: 0.3319 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2732 - accuracy20: 0.3794 - val_loss: 3.3316 - val_accuracy20: 0.3457 - 11s/epoch - 50ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2590 - accuracy20: 0.3906 - val_loss: 3.3438 - val_accuracy20: 0.3451 - 11s/epoch - 50ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2395 - accuracy20: 0.4024 - val_loss: 3.3142 - val_accuracy20: 0.3541 - 11s/epoch - 49ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2256 - accuracy20: 0.4109 - val_loss: 3.3064 - val_accuracy20: 0.3620 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2080 - accuracy20: 0.4193 - val_loss: 3.2988 - val_accuracy20: 0.3730 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.1905 - accuracy20: 0.4276 - val_loss: 3.2974 - val_accuracy20: 0.3810 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1808 - accuracy20: 0.4318 - val_loss: 3.3026 - val_accuracy20: 0.3758 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1703 - accuracy20: 0.4368 - val_loss: 3.2984 - val_accuracy20: 0.3838 - 11s/epoch - 49ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1645 - accuracy20: 0.4384 - val_loss: 3.2897 - val_accuracy20: 0.3891 - 11s/epoch - 50ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1489 - accuracy20: 0.4468 - val_loss: 3.2928 - val_accuracy20: 0.3899 - 11s/epoch - 50ms/step
Epoch 14/50
220/220 - 11s - loss: 3.1398 - accuracy20: 0.4493 - val_loss: 3.3069 - val_accuracy20: 0.3855 - 11s/epoch - 50ms/step
Epoch 15/50
220/220 - 11s - loss: 3.1327 - accuracy20: 0.4535 - val_loss: 3.3018 - val_accuracy20: 0.3820 - 11s/epoch - 50ms/step
Epoch 16/50
220/220 - 11s - loss: 3.1228 - accuracy20: 0.4574 - val_loss: 3.2979 - val_accuracy20: 0.3887 - 11s/epoch - 52ms/step
Epoch 17/50
220/220 - 11s - loss: 3.1130 - accuracy20: 0.4616 - val_loss: 3.3091 - val_accuracy20: 0.3883 - 11s/epoch - 52ms/step
Epoch 18/50
220/220 - 11s - loss: 3.1002 - accuracy20: 0.4666 - val_loss: 3.3335 - val_accuracy20: 0.3701 - 11s/epoch - 50ms/step
Epoch 19/50
220/220 - 11s - loss: 3.0925 - accuracy20: 0.4683 - val_loss: 3.3235 - val_accuracy20: 0.3757 - 11s/epoch - 49ms/step
Epoch 20/50
220/220 - 11s - loss: 3.0818 - accuracy20: 0.4701 - val_loss: 3.3500 - val_accuracy20: 0.3697 - 11s/epoch - 50ms/step
Epoch 21/50
220/220 - 11s - loss: 3.0726 - accuracy20: 0.4750 - val_loss: 3.4046 - val_accuracy20: 0.3576 - 11s/epoch - 50ms/step
Epoch 22/50
220/220 - 11s - loss: 3.0607 - accuracy20: 0.4793 - val_loss: 3.4051 - val_accuracy20: 0.3591 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h20
Evaluating performance on  test set...
967/967 - 17s - 17s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1179842
{'0': {'precision': 0.4052081063412508, 'recall': 0.3400772695059781, 'f1-score': 0.36979678080914796, 'support': 87486}, '1': {'precision': 0.3199011594753849, 'recall': 0.2241728381906335, 'f1-score': 0.26361543160565765, 'support': 75076}, '2': {'precision': 0.37380354717912845, 'recall': 0.5344858020405522, 'f1-score': 0.4399318100367102, 'support': 84977}, 'accuracy': 0.37166264709803304, 'macro avg': {'precision': 0.36630427099858803, 'recall': 0.3662453032457213, 'f1-score': 0.35778134081717194, 'support': 247539}, 'weighted avg': {'precision': 0.3685546110664803, 'recall': 0.37166264709803304, 'f1-score': 0.361669549972267, 'support': 247539}}
[[29752 18164 39570]
 [21730 16830 36516]
 [21942 17616 45419]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0835638
{'0': {'precision': 0.40037810290974846, 'recall': 0.5230323204123268, 'f1-score': 0.4535592904697612, 'support': 18626}, '1': {'precision': 0.36287106778910055, 'recall': 0.265220207253886, 'f1-score': 0.30645463049579047, 'support': 18528}, '2': {'precision': 0.4259148496547224, 'recall': 0.4098686620271048, 'f1-score': 0.41773772065489834, 'support': 19111}, 'accuracy': 0.3996978583488847, 'macro avg': {'precision': 0.3963880067845238, 'recall': 0.3993737298977726, 'f1-score': 0.39258388054015, 'support': 56265}, 'weighted avg': {'precision': 0.396700904301872, 'recall': 0.3996978583488847, 'f1-score': 0.3929507210086473, 'support': 56265}}
[[9742 4143 4741]
 [7797 4914 5817]
 [6793 4485 7833]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0960622
{'0': {'precision': 0.41361256544502617, 'recall': 0.4792719919110212, 'f1-score': 0.44402810304449647, 'support': 6923}, '1': {'precision': 0.33856644465588326, 'recall': 0.3382446134347275, 'f1-score': 0.33840545252813437, 'support': 6312}, '2': {'precision': 0.4054101528192517, 'recall': 0.34011199528440905, 'f1-score': 0.3699014344098085, 'support': 6786}, 'accuracy': 0.3876429748763798, 'macro avg': {'precision': 0.38586305430672035, 'recall': 0.38587620021005264, 'f1-score': 0.38411166332747976, 'support': 20021}, 'weighted avg': {'precision': 0.3871726929861293, 'recall': 0.3876429748763798, 'f1-score': 0.38560376143247554, 'support': 20021}}
[[3318 1995 1610]
 [2402 2135 1775]
 [2302 2176 2308]]
training model: results/XRAY/W10/deepLOB_L2/h30
Epoch 1/50
220/220 - 13s - loss: 3.3706 - accuracy30: 0.3353 - val_loss: 3.3684 - val_accuracy30: 0.3408 - 13s/epoch - 59ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3223 - accuracy30: 0.3467 - val_loss: 3.3609 - val_accuracy30: 0.3355 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.2954 - accuracy30: 0.3633 - val_loss: 3.3375 - val_accuracy30: 0.3352 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2800 - accuracy30: 0.3746 - val_loss: 3.3079 - val_accuracy30: 0.3521 - 11s/epoch - 50ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2666 - accuracy30: 0.3850 - val_loss: 3.3111 - val_accuracy30: 0.3558 - 11s/epoch - 51ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2507 - accuracy30: 0.3963 - val_loss: 3.3014 - val_accuracy30: 0.3669 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2402 - accuracy30: 0.4037 - val_loss: 3.3131 - val_accuracy30: 0.3608 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2258 - accuracy30: 0.4124 - val_loss: 3.2831 - val_accuracy30: 0.3774 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.2109 - accuracy30: 0.4204 - val_loss: 3.2857 - val_accuracy30: 0.3792 - 11s/epoch - 49ms/step
Epoch 10/50
220/220 - 11s - loss: 3.2009 - accuracy30: 0.4239 - val_loss: 3.2972 - val_accuracy30: 0.3702 - 11s/epoch - 49ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1919 - accuracy30: 0.4297 - val_loss: 3.2959 - val_accuracy30: 0.3698 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1820 - accuracy30: 0.4344 - val_loss: 3.2979 - val_accuracy30: 0.3728 - 11s/epoch - 50ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1732 - accuracy30: 0.4366 - val_loss: 3.3118 - val_accuracy30: 0.3650 - 11s/epoch - 50ms/step
Epoch 14/50
220/220 - 11s - loss: 3.1659 - accuracy30: 0.4422 - val_loss: 3.3070 - val_accuracy30: 0.3652 - 11s/epoch - 50ms/step
Epoch 15/50
220/220 - 11s - loss: 3.1541 - accuracy30: 0.4447 - val_loss: 3.3155 - val_accuracy30: 0.3659 - 11s/epoch - 50ms/step
Epoch 16/50
220/220 - 11s - loss: 3.1444 - accuracy30: 0.4505 - val_loss: 3.3359 - val_accuracy30: 0.3641 - 11s/epoch - 50ms/step
Epoch 17/50
220/220 - 11s - loss: 3.1370 - accuracy30: 0.4545 - val_loss: 3.3339 - val_accuracy30: 0.3590 - 11s/epoch - 49ms/step
Epoch 18/50
220/220 - 11s - loss: 3.1227 - accuracy30: 0.4585 - val_loss: 3.3473 - val_accuracy30: 0.3601 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h30
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0978967
{'0': {'precision': 0.3906908944222377, 'recall': 0.4889452367566575, 'f1-score': 0.4343306171744814, 'support': 87157}, '1': {'precision': 0.37077398318174015, 'recall': 0.1130205063820883, 'f1-score': 0.17323497574469793, 'support': 76464}, '2': {'precision': 0.36707047023576916, 'recall': 0.5037059987130293, 'f1-score': 0.42466833774545015, 'support': 83918}, 'accuracy': 0.3778273322587552, 'macro avg': {'precision': 0.37617844927991567, 'recall': 0.3685572472839251, 'f1-score': 0.34407797688820985, 'support': 247539}, 'weighted avg': {'precision': 0.3765310834107467, 'recall': 0.3778273322587552, 'f1-score': 0.35040341260707014, 'support': 247539}}
[[42615  7614 36928]
 [31865  8642 35957]
 [34596  7052 42270]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0868131
{'0': {'precision': 0.3794582803126704, 'recall': 0.5627628599158848, 'f1-score': 0.4532800590649498, 'support': 18546}, '1': {'precision': 0.39765264775744025, 'recall': 0.15344799698064376, 'f1-score': 0.2214441332088391, 'support': 18547}, '2': {'precision': 0.40179604684534553, 'recall': 0.45274358439390777, 'f1-score': 0.4257510729613734, 'support': 19172}, 'accuracy': 0.39034924020261264, 'macro avg': {'precision': 0.3929689916384855, 'recall': 0.38965148043014547, 'f1-score': 0.36682508841172073, 'support': 56265}, 'weighted avg': {'precision': 0.39306728400879754, 'recall': 0.39034924020261264, 'f1-score': 0.3674781104569155, 'support': 56265}}
[[10437  2050  6059]
 [ 8837  2846  6864]
 [ 8231  2261  8680]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927982
{'0': {'precision': 0.38416618801455105, 'recall': 0.579243648960739, 'f1-score': 0.4619546448716473, 'support': 6928}, '1': {'precision': 0.34331419196062346, 'recall': 0.1320397539044013, 'f1-score': 0.19072576051042495, 'support': 6339}, '2': {'precision': 0.38643687824015693, 'recall': 0.40835060704767545, 'f1-score': 0.3970916420704053, 'support': 6754}, 'accuracy': 0.38000099895110134, 'macro avg': {'precision': 0.37130575273844385, 'recall': 0.37321133663760525, 'f1-score': 0.34992401581749255, 'support': 20021}, 'weighted avg': {'precision': 0.3719977368281915, 'recall': 0.3800009989511013, 'f1-score': 0.35419755886768256, 'support': 20021}}
[[4013  760 2155]
 [3278  837 2224]
 [3155  841 2758]]
training model: results/XRAY/W10/deepLOB_L2/h50
Epoch 1/50
220/220 - 13s - loss: 3.3652 - accuracy50: 0.3413 - val_loss: 3.4126 - val_accuracy50: 0.3415 - 13s/epoch - 60ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3271 - accuracy50: 0.3506 - val_loss: 3.3971 - val_accuracy50: 0.3372 - 11s/epoch - 51ms/step
Epoch 3/50
220/220 - 11s - loss: 3.3102 - accuracy50: 0.3499 - val_loss: 3.3828 - val_accuracy50: 0.3374 - 11s/epoch - 51ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2950 - accuracy50: 0.3613 - val_loss: 3.3374 - val_accuracy50: 0.3473 - 11s/epoch - 51ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2794 - accuracy50: 0.3717 - val_loss: 3.3553 - val_accuracy50: 0.3437 - 11s/epoch - 50ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2662 - accuracy50: 0.3847 - val_loss: 3.3391 - val_accuracy50: 0.3451 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2528 - accuracy50: 0.3946 - val_loss: 3.3572 - val_accuracy50: 0.3385 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2416 - accuracy50: 0.4011 - val_loss: 3.3814 - val_accuracy50: 0.3373 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.2306 - accuracy50: 0.4081 - val_loss: 3.3525 - val_accuracy50: 0.3488 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.2183 - accuracy50: 0.4147 - val_loss: 3.3479 - val_accuracy50: 0.3465 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.2033 - accuracy50: 0.4226 - val_loss: 3.3400 - val_accuracy50: 0.3589 - 11s/epoch - 49ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1971 - accuracy50: 0.4251 - val_loss: 3.3527 - val_accuracy50: 0.3533 - 11s/epoch - 49ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1796 - accuracy50: 0.4371 - val_loss: 3.3546 - val_accuracy50: 0.3525 - 11s/epoch - 49ms/step
Epoch 14/50
220/220 - 11s - loss: 3.1660 - accuracy50: 0.4414 - val_loss: 3.3471 - val_accuracy50: 0.3557 - 11s/epoch - 49ms/step
testing model: results/XRAY/W10/deepLOB_L2/h50
Evaluating performance on  test set...
967/967 - 17s - 17s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1211803
{'0': {'precision': 0.37084095063985373, 'recall': 0.2246798989854238, 'f1-score': 0.2798239805771672, 'support': 90284}, '1': {'precision': 0.3054374729458251, 'recall': 0.37727235337665543, 'f1-score': 0.3375756720784598, 'support': 72942}, '2': {'precision': 0.34413384983745693, 'recall': 0.4193540735117953, 'f1-score': 0.3780385448130229, 'support': 84313}, 'accuracy': 0.3359511026545312, 'macro avg': {'precision': 0.3401374244743786, 'recall': 0.3404354419579582, 'f1-score': 0.33181273248954996, 'support': 247539}, 'weighted avg': {'precision': 0.34247202186535625, 'recall': 0.3359511026545312, 'f1-score': 0.33029396080616136, 'support': 247539}}
[[20285 32246 37753]
 [15791 27519 29632]
 [18624 30332 35357]]
Evaluating performance on  train set...
220/220 - 13s - 13s/epoch - 60ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1122224
{'0': {'precision': 0.3465518048597781, 'recall': 0.3993956725840393, 'f1-score': 0.3711019753334002, 'support': 18533}, '1': {'precision': 0.3542881524676433, 'recall': 0.2680944949685196, 'f1-score': 0.30522285189156073, 'support': 18583}, '2': {'precision': 0.34148915755133374, 'recall': 0.3717165387226487, 'f1-score': 0.3559622934013453, 'support': 19149}, 'accuracy': 0.34660979294410377, 'macro avg': {'precision': 0.34744303829291834, 'recall': 0.34640223542506915, 'f1-score': 0.3440957068754354, 'support': 56265}, 'weighted avg': {'precision': 0.3473839369896556, 'recall': 0.34660979294410377, 'f1-score': 0.34419108010125543, 'support': 56265}}
[[7402 4323 6808]
 [6683 4982 6918]
 [7274 4757 7118]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1137081
{'0': {'precision': 0.36650035637918743, 'recall': 0.37255470221707, 'f1-score': 0.36950273066973266, 'support': 6901}, '1': {'precision': 0.3386963012108144, 'recall': 0.3220820189274448, 'f1-score': 0.33018028943326055, 'support': 6340}, '2': {'precision': 0.3438440590511681, 'recall': 0.353834808259587, 'f1-score': 0.3487678999781929, 'support': 6780}, 'accuracy': 0.3502322561310624, 'macro avg': {'precision': 0.34968023888038996, 'recall': 0.34949050980136726, 'f1-score': 0.34948364002706206, 'support': 20021}, 'weighted avg': {'precision': 0.35002328701944235, 'recall': 0.3502322561310624, 'f1-score': 0.3500288567609433, 'support': 20021}}
[[2571 1995 2335]
 [2055 2042 2243]
 [2389 1992 2399]]
training model: results/XRAY/W10/deepLOB_L2/h100
Epoch 1/50
220/220 - 13s - loss: 3.3726 - accuracy100: 0.3370 - val_loss: 3.3736 - val_accuracy100: 0.3368 - 13s/epoch - 61ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3367 - accuracy100: 0.3453 - val_loss: 3.3408 - val_accuracy100: 0.3449 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.3126 - accuracy100: 0.3522 - val_loss: 3.3745 - val_accuracy100: 0.3326 - 11s/epoch - 49ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2937 - accuracy100: 0.3629 - val_loss: 3.3440 - val_accuracy100: 0.3366 - 11s/epoch - 51ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2807 - accuracy100: 0.3727 - val_loss: 3.3262 - val_accuracy100: 0.3493 - 11s/epoch - 51ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2644 - accuracy100: 0.3821 - val_loss: 3.3452 - val_accuracy100: 0.3429 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2501 - accuracy100: 0.3949 - val_loss: 3.3372 - val_accuracy100: 0.3472 - 11s/epoch - 49ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2441 - accuracy100: 0.3980 - val_loss: 3.3307 - val_accuracy100: 0.3501 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.2301 - accuracy100: 0.4066 - val_loss: 3.3213 - val_accuracy100: 0.3554 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.2175 - accuracy100: 0.4141 - val_loss: 3.3374 - val_accuracy100: 0.3514 - 11s/epoch - 49ms/step
Epoch 11/50
220/220 - 11s - loss: 3.2120 - accuracy100: 0.4168 - val_loss: 3.3327 - val_accuracy100: 0.3557 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.2008 - accuracy100: 0.4213 - val_loss: 3.3370 - val_accuracy100: 0.3550 - 11s/epoch - 50ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1843 - accuracy100: 0.4316 - val_loss: 3.3357 - val_accuracy100: 0.3636 - 11s/epoch - 50ms/step
Epoch 14/50
220/220 - 11s - loss: 3.1716 - accuracy100: 0.4376 - val_loss: 3.3527 - val_accuracy100: 0.3526 - 11s/epoch - 50ms/step
Epoch 15/50
220/220 - 11s - loss: 3.1662 - accuracy100: 0.4391 - val_loss: 3.3595 - val_accuracy100: 0.3566 - 11s/epoch - 50ms/step
Epoch 16/50
220/220 - 11s - loss: 3.1477 - accuracy100: 0.4484 - val_loss: 3.3782 - val_accuracy100: 0.3570 - 11s/epoch - 50ms/step
Epoch 17/50
220/220 - 11s - loss: 3.1357 - accuracy100: 0.4531 - val_loss: 3.3857 - val_accuracy100: 0.3636 - 11s/epoch - 50ms/step
Epoch 18/50
220/220 - 11s - loss: 3.1195 - accuracy100: 0.4583 - val_loss: 3.4361 - val_accuracy100: 0.3589 - 11s/epoch - 49ms/step
Epoch 19/50
220/220 - 11s - loss: 3.1058 - accuracy100: 0.4643 - val_loss: 3.4612 - val_accuracy100: 0.3568 - 11s/epoch - 51ms/step
testing model: results/XRAY/W10/deepLOB_L2/h100
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1109252
{'0': {'precision': 0.3811475766516105, 'recall': 0.47750144466129507, 'f1-score': 0.4239183041331913, 'support': 91717}, '1': {'precision': 0.3191740546922003, 'recall': 0.38762286832926646, 'f1-score': 0.35008404407644894, 'support': 72537}, '2': {'precision': 0.33778595963451047, 'recall': 0.1806567809329411, 'f1-score': 0.23541008229808807, 'support': 83285}, 'accuracy': 0.3512900997418589, 'macro avg': {'precision': 0.34603586365944045, 'recall': 0.34859369797450085, 'f1-score': 0.3364708101692428, 'support': 247539}, 'weighted avg': {'precision': 0.3483982093372119, 'recall': 0.3512900997418589, 'f1-score': 0.3388584833482948, 'support': 247539}}
[[43795 30625 17297]
 [32220 28117 12200]
 [38888 29351 15046]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014575
{'0': {'precision': 0.3536404710762166, 'recall': 0.5216322517207473, 'f1-score': 0.42151496424472507, 'support': 18306}, '1': {'precision': 0.37682408364931635, 'recall': 0.3573218566136413, 'f1-score': 0.36681393658072814, 'support': 18356}, '2': {'precision': 0.3879564814033904, 'recall': 0.23465796051624752, 'f1-score': 0.2924348378893834, 'support': 19603}, 'accuracy': 0.3680440771349862, 'macro avg': {'precision': 0.37280701204297445, 'recall': 0.37120402295021204, 'f1-score': 0.36025457957161217, 'support': 56265}, 'weighted avg': {'precision': 0.373159801793988, 'recall': 0.3680440771349862, 'f1-score': 0.3586970529189615, 'support': 56265}}
[[9549 5089 3668]
 [8208 6559 3589]
 [9245 5758 4600]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105184
{'0': {'precision': 0.36058791507893306, 'recall': 0.4818856394587516, 'f1-score': 0.4125046705691867, 'support': 6873}, '1': {'precision': 0.36807763091852097, 'recall': 0.3420398009950249, 'f1-score': 0.35458135224433873, 'support': 6432}, '2': {'precision': 0.3457501543527475, 'recall': 0.25014889815366287, 'f1-score': 0.290280777537797, 'support': 6716}, 'accuracy': 0.3592228160431547, 'macro avg': {'precision': 0.3581385667834005, 'recall': 0.35802477953581313, 'f1-score': 0.3524556001171075, 'support': 20021}, 'weighted avg': {'precision': 0.35801678732523284, 'recall': 0.3592228160431547, 'f1-score': 0.35289633686636296, 'support': 20021}}
[[3312 1911 1650]
 [2703 2200 1529]
 [3170 1866 1680]]
training model: results/XRAY/W10/deepLOB_L2/h200
Epoch 1/50
220/220 - 13s - loss: 3.3691 - accuracy200: 0.3404 - val_loss: 3.3951 - val_accuracy200: 0.3432 - 13s/epoch - 60ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3299 - accuracy200: 0.3423 - val_loss: 3.3821 - val_accuracy200: 0.3378 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.3032 - accuracy200: 0.3619 - val_loss: 3.4002 - val_accuracy200: 0.3507 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2838 - accuracy200: 0.3739 - val_loss: 3.4602 - val_accuracy200: 0.3253 - 11s/epoch - 50ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2641 - accuracy200: 0.3881 - val_loss: 3.5486 - val_accuracy200: 0.3269 - 11s/epoch - 50ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2524 - accuracy200: 0.3953 - val_loss: 3.5021 - val_accuracy200: 0.3326 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2389 - accuracy200: 0.4015 - val_loss: 3.6470 - val_accuracy200: 0.3216 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2254 - accuracy200: 0.4116 - val_loss: 3.6124 - val_accuracy200: 0.3271 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.2113 - accuracy200: 0.4182 - val_loss: 3.7011 - val_accuracy200: 0.3232 - 11s/epoch - 51ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1983 - accuracy200: 0.4239 - val_loss: 3.6156 - val_accuracy200: 0.3376 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1858 - accuracy200: 0.4311 - val_loss: 3.7721 - val_accuracy200: 0.3294 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1813 - accuracy200: 0.4328 - val_loss: 3.7745 - val_accuracy200: 0.3269 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h200
Evaluating performance on  test set...
967/967 - 17s - 17s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1530951
{'0': {'precision': 0.3879340419099007, 'recall': 0.1721646505098881, 'f1-score': 0.23848842945074739, 'support': 96884}, '1': {'precision': 0.27328975497451075, 'recall': 0.5915812580649946, 'f1-score': 0.3738663792093361, 'support': 67421}, '2': {'precision': 0.3387487627564081, 'recall': 0.23848427325371843, 'f1-score': 0.2799086242878899, 'support': 83234}, 'accuracy': 0.30869883129527065, 'macro avg': {'precision': 0.33332418654693985, 'recall': 0.3340767272762004, 'f1-score': 0.2974211443159911, 'support': 247539}, 'weighted avg': {'precision': 0.34017057839694825, 'recall': 0.30869883129527065, 'f1-score': 0.28928804182596307, 'support': 247539}}
[[16680 57309 22895]
 [11683 39885 15853]
 [14634 48750 19850]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221012
{'0': {'precision': 0.3320387370120044, 'recall': 0.3677037368038876, 'f1-score': 0.34896233666410453, 'support': 17903}, '1': {'precision': 0.34143121204119353, 'recall': 0.41761317758518596, 'f1-score': 0.3756991694714158, 'support': 18577}, '2': {'precision': 0.35379456149303784, 'recall': 0.24528683345969168, 'f1-score': 0.2897140469225718, 'support': 19785}, 'accuracy': 0.34113569714742736, 'macro avg': {'precision': 0.3424215035154119, 'recall': 0.3435345826162551, 'f1-score': 0.3381251843526974, 'support': 56265}, 'weighted avg': {'precision': 0.34279005658855277, 'recall': 0.34113569714742736, 'f1-score': 0.3369559869000451, 'support': 56265}}
[[6583 6986 4334]
 [6289 7758 4530]
 [6954 7978 4853]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1250181
{'0': {'precision': 0.3498322147651007, 'recall': 0.1809372288111079, 'f1-score': 0.23851286939942806, 'support': 6914}, '1': {'precision': 0.3257544439851178, 'recall': 0.48807680396407555, 'f1-score': 0.3907276558819884, 'support': 6458}, '2': {'precision': 0.34022750775594623, 'recall': 0.34636787486840126, 'f1-score': 0.343270234014011, 'support': 6649}, 'accuracy': 0.3349483042805055, 'macro avg': {'precision': 0.33860472216872156, 'recall': 0.33846063588119496, 'f1-score': 0.3241702530984758, 'support': 20021}, 'weighted avg': {'precision': 0.33887592184261933, 'recall': 0.3349483042805055, 'f1-score': 0.3224015267305672, 'support': 20021}}
[[1251 3344 2319]
 [1159 3152 2147]
 [1166 3180 2303]]
training model: results/XRAY/W10/deepLOB_L2/h300
Epoch 1/50
220/220 - 13s - loss: 3.3652 - accuracy300: 0.3441 - val_loss: 3.4868 - val_accuracy300: 0.3333 - 13s/epoch - 60ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3272 - accuracy300: 0.3535 - val_loss: 3.3806 - val_accuracy300: 0.3362 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.2967 - accuracy300: 0.3673 - val_loss: 3.3846 - val_accuracy300: 0.3361 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2771 - accuracy300: 0.3815 - val_loss: 3.4191 - val_accuracy300: 0.3337 - 11s/epoch - 49ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2524 - accuracy300: 0.3952 - val_loss: 3.4141 - val_accuracy300: 0.3404 - 11s/epoch - 49ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2431 - accuracy300: 0.3975 - val_loss: 3.4533 - val_accuracy300: 0.3402 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2324 - accuracy300: 0.4057 - val_loss: 3.4733 - val_accuracy300: 0.3374 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2182 - accuracy300: 0.4142 - val_loss: 3.4349 - val_accuracy300: 0.3391 - 11s/epoch - 50ms/step
Epoch 9/50
220/220 - 11s - loss: 3.2126 - accuracy300: 0.4184 - val_loss: 3.4280 - val_accuracy300: 0.3446 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1921 - accuracy300: 0.4301 - val_loss: 3.3907 - val_accuracy300: 0.3510 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1728 - accuracy300: 0.4376 - val_loss: 3.4364 - val_accuracy300: 0.3401 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1563 - accuracy300: 0.4453 - val_loss: 3.4256 - val_accuracy300: 0.3365 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h300
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1353797
{'0': {'precision': 0.3894002694654846, 'recall': 0.3555309757383421, 'f1-score': 0.3716956662703988, 'support': 96737}, '1': {'precision': 0.2900918827178557, 'recall': 0.36001278289416344, 'f1-score': 0.32129222113471223, 'support': 68842}, '2': {'precision': 0.33038316097640313, 'recall': 0.2974133723767692, 'f1-score': 0.3130325347853166, 'support': 81960}, 'accuracy': 0.33753469150315707, 'macro avg': {'precision': 0.33662510438658116, 'recall': 0.33765237700309153, 'f1-score': 0.33534014073014257, 'support': 247539}, 'weighted avg': {'precision': 0.34224151802734604, 'recall': 0.33753469150315707, 'f1-score': 0.33825485804806504, 'support': 247539}}
[[34393 33072 29272]
 [23925 24784 20133]
 [30005 27579 24376]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1271253
{'0': {'precision': 0.32588919072588285, 'recall': 0.5950513323336025, 'f1-score': 0.42113641929953466, 'support': 17338}, '1': {'precision': 0.40001667083437525, 'recall': 0.24760086678361365, 'f1-score': 0.305873354791421, 'support': 19382}, '2': {'precision': 0.35384615384615387, 'recall': 0.22829368124840113, 'f1-score': 0.2775307106204323, 'support': 19545}, 'accuracy': 0.347960543854972, 'macro avg': {'precision': 0.35991733846880397, 'recall': 0.35698196012187244, 'f1-score': 0.3348468282371293, 'support': 56265}, 'weighted avg': {'precision': 0.3611359278386261, 'recall': 0.347960543854972, 'f1-score': 0.33154604708893637, 'support': 56265}}
[[10317  3300  3721]
 [10156  4799  4427]
 [11185  3898  4462]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.124583
{'0': {'precision': 0.3390645023494233, 'recall': 0.46925805498078627, 'f1-score': 0.393676379417235, 'support': 6766}, '1': {'precision': 0.3477119279819955, 'recall': 0.2720868799530379, 'f1-score': 0.3052856907623909, 'support': 6814}, '2': {'precision': 0.3265727699530516, 'recall': 0.26998913212234127, 'f1-score': 0.29559748427672955, 'support': 6441}, 'accuracy': 0.3380450526946706, 'macro avg': {'precision': 0.3377830667614901, 'recall': 0.33711135568538847, 'f1-score': 0.3315198514854518, 'support': 20021}, 'weighted avg': {'precision': 0.33798884728200995, 'recall': 0.3380450526946706, 'f1-score': 0.3320400817251066, 'support': 20021}}
[[3175 1832 1759]
 [3133 1854 1827]
 [3056 1646 1739]]
training model: results/XRAY/W10/deepLOB_L2/h500
Epoch 1/50
220/220 - 13s - loss: 3.3692 - accuracy500: 0.3386 - val_loss: 3.3862 - val_accuracy500: 0.3407 - 13s/epoch - 60ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3279 - accuracy500: 0.3515 - val_loss: 3.3912 - val_accuracy500: 0.3410 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.3107 - accuracy500: 0.3594 - val_loss: 3.3859 - val_accuracy500: 0.3460 - 11s/epoch - 50ms/step
Epoch 4/50
220/220 - 11s - loss: 3.2879 - accuracy500: 0.3733 - val_loss: 3.3546 - val_accuracy500: 0.3445 - 11s/epoch - 50ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2720 - accuracy500: 0.3895 - val_loss: 3.4084 - val_accuracy500: 0.3304 - 11s/epoch - 50ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2521 - accuracy500: 0.4012 - val_loss: 3.3902 - val_accuracy500: 0.3325 - 11s/epoch - 50ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2405 - accuracy500: 0.4064 - val_loss: 3.4426 - val_accuracy500: 0.3332 - 11s/epoch - 51ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2138 - accuracy500: 0.4222 - val_loss: 3.4229 - val_accuracy500: 0.3236 - 11s/epoch - 51ms/step
Epoch 9/50
220/220 - 11s - loss: 3.1947 - accuracy500: 0.4306 - val_loss: 3.4105 - val_accuracy500: 0.3310 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1760 - accuracy500: 0.4421 - val_loss: 3.4179 - val_accuracy500: 0.3292 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1559 - accuracy500: 0.4503 - val_loss: 3.4008 - val_accuracy500: 0.3295 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1359 - accuracy500: 0.4571 - val_loss: 3.4431 - val_accuracy500: 0.3186 - 11s/epoch - 49ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1219 - accuracy500: 0.4628 - val_loss: 3.4749 - val_accuracy500: 0.3270 - 11s/epoch - 49ms/step
Epoch 14/50
220/220 - 11s - loss: 3.1070 - accuracy500: 0.4655 - val_loss: 3.4818 - val_accuracy500: 0.3259 - 11s/epoch - 49ms/step
testing model: results/XRAY/W10/deepLOB_L2/h500
Evaluating performance on  test set...
967/967 - 17s - 17s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1358465
{'0': {'precision': 0.3952077058420064, 'recall': 0.26133125622393344, 'f1-score': 0.31461994551573097, 'support': 101423}, '1': {'precision': 0.25146719823602126, 'recall': 0.3491781224388811, 'f1-score': 0.29237502104022894, 'support': 64669}, '2': {'precision': 0.3343442586792536, 'recall': 0.37222979360811326, 'f1-score': 0.35227134084346656, 'support': 81447}, 'accuracy': 0.3207696564985719, 'macro avg': {'precision': 0.32700638758576045, 'recall': 0.3275797240903093, 'f1-score': 0.31975543579980886, 'support': 247539}, 'weighted avg': {'precision': 0.337630111735881, 'recall': 0.3207696564985719, 'f1-score': 0.3211968330944634, 'support': 247539}}
[[26505 37986 36932]
 [18661 22581 23427]
 [21900 29230 30317]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1192051
{'0': {'precision': 0.3329052726998036, 'recall': 0.4933116919460458, 'f1-score': 0.3975373790677221, 'support': 17867}, '1': {'precision': 0.33037553478054194, 'recall': 0.23644817418915853, 'f1-score': 0.27562958556414835, 'support': 17636}, '2': {'precision': 0.37333255664938547, 'recall': 0.30868895096811483, 'f1-score': 0.3379472171689209, 'support': 20762}, 'accuracy': 0.34467253176930596, 'macro avg': {'precision': 0.3455377880432437, 'recall': 0.34614960570110637, 'f1-score': 0.3370380606002638, 'support': 56265}, 'weighted avg': {'precision': 0.3470301604882532, 'recall': 0.34467253176930596, 'f1-score': 0.337336956290295, 'support': 56265}}
[[8814 3819 5234]
 [7942 4170 5524]
 [9720 4633 6409]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123545
{'0': {'precision': 0.36977018267530937, 'recall': 0.3595473427875662, 'f1-score': 0.36458711598518406, 'support': 6981}, '1': {'precision': 0.3168565360108129, 'recall': 0.2631494547787043, 'f1-score': 0.2875164257555847, 'support': 6236}, '2': {'precision': 0.34318351129873353, 'recall': 0.4062316284538507, 'f1-score': 0.372055458338942, 'support': 6804}, 'accuracy': 0.34538734328954596, 'macro avg': {'precision': 0.3432700766616186, 'recall': 0.34297614200670706, 'f1-score': 0.3413863333599036, 'support': 20021}, 'weighted avg': {'precision': 0.3442537143347658, 'recall': 0.34538734328954596, 'f1-score': 0.34311974557926966, 'support': 20021}}
[[2510 1754 2717]
 [2022 1641 2573]
 [2256 1784 2764]]
training model: results/XRAY/W10/deepLOB_L2/h1000
Epoch 1/50
220/220 - 14s - loss: 3.3803 - accuracy1000: 0.3409 - val_loss: 3.4381 - val_accuracy1000: 0.3257 - 14s/epoch - 62ms/step
Epoch 2/50
220/220 - 11s - loss: 3.3435 - accuracy1000: 0.3582 - val_loss: 3.5759 - val_accuracy1000: 0.3311 - 11s/epoch - 50ms/step
Epoch 3/50
220/220 - 11s - loss: 3.3306 - accuracy1000: 0.3592 - val_loss: 3.4098 - val_accuracy1000: 0.3288 - 11s/epoch - 51ms/step
Epoch 4/50
220/220 - 11s - loss: 3.3077 - accuracy1000: 0.3695 - val_loss: 3.4145 - val_accuracy1000: 0.3315 - 11s/epoch - 50ms/step
Epoch 5/50
220/220 - 11s - loss: 3.2844 - accuracy1000: 0.3764 - val_loss: 3.5008 - val_accuracy1000: 0.3351 - 11s/epoch - 49ms/step
Epoch 6/50
220/220 - 11s - loss: 3.2546 - accuracy1000: 0.3995 - val_loss: 3.6660 - val_accuracy1000: 0.3314 - 11s/epoch - 49ms/step
Epoch 7/50
220/220 - 11s - loss: 3.2266 - accuracy1000: 0.4147 - val_loss: 3.6385 - val_accuracy1000: 0.3284 - 11s/epoch - 50ms/step
Epoch 8/50
220/220 - 11s - loss: 3.2031 - accuracy1000: 0.4280 - val_loss: 3.6840 - val_accuracy1000: 0.3319 - 11s/epoch - 49ms/step
Epoch 9/50
220/220 - 11s - loss: 3.1856 - accuracy1000: 0.4367 - val_loss: 3.7839 - val_accuracy1000: 0.3347 - 11s/epoch - 50ms/step
Epoch 10/50
220/220 - 11s - loss: 3.1642 - accuracy1000: 0.4473 - val_loss: 3.8004 - val_accuracy1000: 0.3337 - 11s/epoch - 50ms/step
Epoch 11/50
220/220 - 11s - loss: 3.1398 - accuracy1000: 0.4565 - val_loss: 3.8444 - val_accuracy1000: 0.3249 - 11s/epoch - 50ms/step
Epoch 12/50
220/220 - 11s - loss: 3.1200 - accuracy1000: 0.4633 - val_loss: 3.9534 - val_accuracy1000: 0.3321 - 11s/epoch - 50ms/step
Epoch 13/50
220/220 - 11s - loss: 3.1045 - accuracy1000: 0.4664 - val_loss: 3.9982 - val_accuracy1000: 0.3269 - 11s/epoch - 50ms/step
testing model: results/XRAY/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.135573
{'0': {'precision': 0.4247906130689428, 'recall': 0.20290256361292786, 'f1-score': 0.2746281386903762, 'support': 104735}, '1': {'precision': 0.25698541878602915, 'recall': 0.24067516712450576, 'f1-score': 0.24856301811294143, 'support': 62977}, '2': {'precision': 0.3209872087315566, 'recall': 0.5570421035489246, 'f1-score': 0.40728341859048633, 'support': 79827}, 'accuracy': 0.32671619421586096, 'macro avg': {'precision': 0.33425441352884283, 'recall': 0.3335399447621194, 'f1-score': 0.31015819179793463, 'support': 247539}, 'weighted avg': {'precision': 0.3486241016166239, 'recall': 0.32671619421586096, 'f1-score': 0.3107758565448597, 'support': 247539}}
[[21251 24580 58904]
 [12659 15157 35161]
 [16117 19243 44467]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1183726
{'0': {'precision': 0.32024575213593165, 'recall': 0.38566473988439304, 'f1-score': 0.34992395237845486, 'support': 17300}, '1': {'precision': 0.33746537396121884, 'recall': 0.2659934497816594, 'f1-score': 0.29749694749694755, 'support': 18320}, '2': {'precision': 0.37163546281739795, 'recall': 0.3778638895616372, 'f1-score': 0.3747237967143818, 'support': 20645}, 'accuracy': 0.34383719896916376, 'macro avg': {'precision': 0.34311552963818276, 'recall': 0.34317402640922995, 'f1-score': 0.3407148988632614, 'support': 56265}, 'weighted avg': {'precision': 0.3447086340137977, 'recall': 0.34383719896916376, 'f1-score': 0.34195327890268834, 'support': 56265}}
[[6672 4374 6254]
 [6511 4873 6936]
 [7651 5193 7801]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125162
{'0': {'precision': 0.326101849737383, 'recall': 0.21133639188989195, 'f1-score': 0.2564655172413793, 'support': 6757}, '1': {'precision': 0.3254847645429363, 'recall': 0.28114251532824885, 'f1-score': 0.3016930113134879, 'support': 6687}, '2': {'precision': 0.322825866612609, 'recall': 0.48426334194921694, 'f1-score': 0.3873988931460196, 'support': 6577}, 'accuracy': 0.3243094750511962, 'macro avg': {'precision': 0.32480416029764275, 'recall': 0.3255807497224526, 'f1-score': 0.31518580723362893, 'support': 20021}, 'weighted avg': {'precision': 0.3248195666492803, 'recall': 0.3243094750511962, 'f1-score': 0.31458374641000275, 'support': 20021}}
[[1428 1999 3330]
 [1456 1880 3351]
 [1495 1897 3185]]
training model: results/XRAY/W10/deepOF_L2/h10
Epoch 1/50
220/220 - 9s - loss: 3.3163 - accuracy10: 0.3614 - val_loss: 3.3020 - val_accuracy10: 0.3740 - 9s/epoch - 42ms/step
Epoch 2/50
220/220 - 7s - loss: 3.2523 - accuracy10: 0.3933 - val_loss: 3.2718 - val_accuracy10: 0.3891 - 7s/epoch - 33ms/step
Epoch 3/50
220/220 - 7s - loss: 3.2127 - accuracy10: 0.4157 - val_loss: 3.2438 - val_accuracy10: 0.4049 - 7s/epoch - 32ms/step
Epoch 4/50
220/220 - 7s - loss: 3.1906 - accuracy10: 0.4241 - val_loss: 3.2438 - val_accuracy10: 0.4043 - 7s/epoch - 32ms/step
Epoch 5/50
220/220 - 7s - loss: 3.1721 - accuracy10: 0.4335 - val_loss: 3.2321 - val_accuracy10: 0.4113 - 7s/epoch - 33ms/step
Epoch 6/50
220/220 - 7s - loss: 3.1546 - accuracy10: 0.4402 - val_loss: 3.2250 - val_accuracy10: 0.4133 - 7s/epoch - 33ms/step
Epoch 7/50
220/220 - 7s - loss: 3.1431 - accuracy10: 0.4462 - val_loss: 3.2217 - val_accuracy10: 0.4166 - 7s/epoch - 33ms/step
Epoch 8/50
220/220 - 7s - loss: 3.1354 - accuracy10: 0.4482 - val_loss: 3.2201 - val_accuracy10: 0.4162 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.1220 - accuracy10: 0.4537 - val_loss: 3.2228 - val_accuracy10: 0.4193 - 7s/epoch - 31ms/step
Epoch 10/50
220/220 - 7s - loss: 3.1110 - accuracy10: 0.4586 - val_loss: 3.2223 - val_accuracy10: 0.4216 - 7s/epoch - 32ms/step
Epoch 11/50
220/220 - 7s - loss: 3.1030 - accuracy10: 0.4634 - val_loss: 3.2213 - val_accuracy10: 0.4215 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.0931 - accuracy10: 0.4670 - val_loss: 3.2267 - val_accuracy10: 0.4202 - 7s/epoch - 31ms/step
Epoch 13/50
220/220 - 7s - loss: 3.0805 - accuracy10: 0.4709 - val_loss: 3.2256 - val_accuracy10: 0.4260 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.0755 - accuracy10: 0.4731 - val_loss: 3.2299 - val_accuracy10: 0.4241 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.0622 - accuracy10: 0.4754 - val_loss: 3.2367 - val_accuracy10: 0.4204 - 7s/epoch - 32ms/step
Epoch 16/50
220/220 - 7s - loss: 3.0511 - accuracy10: 0.4824 - val_loss: 3.2328 - val_accuracy10: 0.4254 - 7s/epoch - 32ms/step
Epoch 17/50
220/220 - 7s - loss: 3.0419 - accuracy10: 0.4848 - val_loss: 3.2375 - val_accuracy10: 0.4260 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.0308 - accuracy10: 0.4881 - val_loss: 3.2372 - val_accuracy10: 0.4279 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h10
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0694253
{'0': {'precision': 0.42234103494367004, 'recall': 0.617400430991168, 'f1-score': 0.5015737960686847, 'support': 89561}, '1': {'precision': 0.3675104133290612, 'recall': 0.049655829256677775, 'f1-score': 0.08749046529366894, 'support': 69297}, '2': {'precision': 0.432920575126345, 'recall': 0.523580224638008, 'f1-score': 0.47395392043772516, 'support': 88676}, 'accuracy': 0.42485072757681774, 'macro avg': {'precision': 0.4075906744663587, 'recall': 0.3968788282952846, 'f1-score': 0.3543393939333596, 'support': 247534}, 'weighted avg': {'precision': 0.41078122384382654, 'recall': 0.42485072757681774, 'f1-score': 0.37575692782364667, 'support': 247534}}
[[55295  2731 31535]
 [36574  3441 29282]
 [39056  3191 46429]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0544431
{'0': {'precision': 0.40934275571480705, 'recall': 0.6611649965167997, 'f1-score': 0.5056350149584032, 'support': 18661}, '1': {'precision': 0.46395971041863393, 'recall': 0.07990459153249851, 'f1-score': 0.13633000369959306, 'support': 18447}, '2': {'precision': 0.4545177178224295, 'recall': 0.544457787291808, 'f1-score': 0.49543899657924745, 'support': 19153}, 'accuracy': 0.43084907840244574, 'macro avg': {'precision': 0.44260672798529016, 'recall': 0.4285091251137021, 'f1-score': 0.37913467174574794, 'support': 56261}, 'weighted avg': {'precision': 0.4426296687214864, 'recall': 0.43084907840244574, 'f1-score': 0.381075304275919, 'support': 56261}}
[[12338   768  5555]
 [10013  1474  6960]
 [ 7790   935 10428]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0723399
{'0': {'precision': 0.4107997265892003, 'recall': 0.6788084145136242, 'f1-score': 0.5118432958960983, 'support': 7083}, '1': {'precision': 0.42290748898678415, 'recall': 0.06251017418199577, 'f1-score': 0.10892072046518225, 'support': 6143}, '2': {'precision': 0.43595626940207854, 'recall': 0.4753495217071376, 'f1-score': 0.45480146437623203, 'support': 6795}, 'accuracy': 0.4206583087757854, 'macro avg': {'precision': 0.42322116165935436, 'recall': 0.4055560368009192, 'f1-score': 0.35852182691250417, 'support': 20021}, 'weighted avg': {'precision': 0.4230526956128188, 'recall': 0.4206583087757854, 'f1-score': 0.36885580146277286, 'support': 20021}}
[[4808  217 2058]
 [3638  384 2121]
 [3258  307 3230]]
training model: results/XRAY/W10/deepOF_L2/h20
Epoch 1/50
220/220 - 9s - loss: 3.3344 - accuracy20: 0.3424 - val_loss: 3.3019 - val_accuracy20: 0.3697 - 9s/epoch - 42ms/step
Epoch 2/50
220/220 - 7s - loss: 3.2814 - accuracy20: 0.3752 - val_loss: 3.2899 - val_accuracy20: 0.3805 - 7s/epoch - 32ms/step
Epoch 3/50
220/220 - 7s - loss: 3.2569 - accuracy20: 0.3880 - val_loss: 3.2745 - val_accuracy20: 0.3917 - 7s/epoch - 32ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2376 - accuracy20: 0.3999 - val_loss: 3.2693 - val_accuracy20: 0.3912 - 7s/epoch - 32ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2219 - accuracy20: 0.4079 - val_loss: 3.2575 - val_accuracy20: 0.3962 - 7s/epoch - 32ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2069 - accuracy20: 0.4176 - val_loss: 3.2581 - val_accuracy20: 0.3996 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.1982 - accuracy20: 0.4200 - val_loss: 3.2573 - val_accuracy20: 0.4010 - 7s/epoch - 32ms/step
Epoch 8/50
220/220 - 7s - loss: 3.1907 - accuracy20: 0.4268 - val_loss: 3.2535 - val_accuracy20: 0.4038 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.1799 - accuracy20: 0.4316 - val_loss: 3.2513 - val_accuracy20: 0.4039 - 7s/epoch - 32ms/step
Epoch 10/50
220/220 - 7s - loss: 3.1720 - accuracy20: 0.4349 - val_loss: 3.2533 - val_accuracy20: 0.4063 - 7s/epoch - 32ms/step
Epoch 11/50
220/220 - 7s - loss: 3.1665 - accuracy20: 0.4389 - val_loss: 3.2585 - val_accuracy20: 0.4043 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.1552 - accuracy20: 0.4423 - val_loss: 3.2567 - val_accuracy20: 0.4072 - 7s/epoch - 32ms/step
Epoch 13/50
220/220 - 7s - loss: 3.1480 - accuracy20: 0.4444 - val_loss: 3.2552 - val_accuracy20: 0.4084 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.1394 - accuracy20: 0.4500 - val_loss: 3.2601 - val_accuracy20: 0.4079 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.1284 - accuracy20: 0.4526 - val_loss: 3.2634 - val_accuracy20: 0.4068 - 7s/epoch - 33ms/step
Epoch 16/50
220/220 - 7s - loss: 3.1214 - accuracy20: 0.4555 - val_loss: 3.2672 - val_accuracy20: 0.4019 - 7s/epoch - 32ms/step
Epoch 17/50
220/220 - 7s - loss: 3.1102 - accuracy20: 0.4586 - val_loss: 3.2729 - val_accuracy20: 0.4054 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.1043 - accuracy20: 0.4620 - val_loss: 3.2667 - val_accuracy20: 0.4071 - 7s/epoch - 31ms/step
Epoch 19/50
220/220 - 7s - loss: 3.0971 - accuracy20: 0.4641 - val_loss: 3.2732 - val_accuracy20: 0.4049 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h20
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0874132
{'0': {'precision': 0.40700002283609016, 'recall': 0.6111676287363548, 'f1-score': 0.48861351756406035, 'support': 87485}, '1': {'precision': 0.32846583738957996, 'recall': 0.0728062230273323, 'f1-score': 0.1191927341714186, 'support': 75076}, '2': {'precision': 0.40800024115270994, 'recall': 0.47785767243712707, 'f1-score': 0.4401745304750806, 'support': 84973}, 'accuracy': 0.4021225367020288, 'macro avg': {'precision': 0.3811553671261267, 'recall': 0.38727717473360473, 'f1-score': 0.34932692740351984, 'support': 247534}, 'weighted avg': {'precision': 0.38352429442882463, 'recall': 0.4021225367020288, 'f1-score': 0.35994173597487317, 'support': 247534}}
[[53468  5313 28704]
 [39397  5466 30213]
 [38506  5862 40605]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.068027
{'0': {'precision': 0.40109377513270067, 'recall': 0.6724556388544307, 'f1-score': 0.5024785394752751, 'support': 18541}, '1': {'precision': 0.44337227018791264, 'recall': 0.09370974667239158, 'f1-score': 0.15471865307930882, 'support': 18632}, '2': {'precision': 0.44844147283171676, 'recall': 0.49895222129086336, 'f1-score': 0.47235034469077025, 'support': 19088}, 'accuracy': 0.421926378841471, 'macro avg': {'precision': 0.43096917271744334, 'recall': 0.42170586893922857, 'f1-score': 0.37651584574845137, 'support': 56261}, 'weighted avg': {'precision': 0.431159109441503, 'recall': 0.421926378841471, 'f1-score': 0.37708885238517237, 'support': 56261}}
[[12468  1102  4971]
 [10143  1746  6743]
 [ 8474  1090  9524]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0836128
{'0': {'precision': 0.3947346972043361, 'recall': 0.697035118019574, 'f1-score': 0.5040328875474839, 'support': 6948}, '1': {'precision': 0.3588850174216028, 'recall': 0.0657097288676236, 'f1-score': 0.11108115394985171, 'support': 6270}, '2': {'precision': 0.4315566323440339, 'recall': 0.4189328237542261, 'f1-score': 0.4251510405012307, 'support': 6803}, 'accuracy': 0.40482493381948953, 'macro avg': {'precision': 0.39505878232332425, 'recall': 0.39389255688047453, 'f1-score': 0.34675502733285546, 'support': 20021}, 'weighted avg': {'precision': 0.3960194548347056, 'recall': 0.40482493381948953, 'f1-score': 0.354168216696237, 'support': 20021}}
[[4843  353 1752]
 [3856  412 2002]
 [3570  383 2850]]
training model: results/XRAY/W10/deepOF_L2/h30
Epoch 1/50
220/220 - 9s - loss: 3.3358 - accuracy30: 0.3451 - val_loss: 3.3073 - val_accuracy30: 0.3652 - 9s/epoch - 43ms/step
Epoch 2/50
220/220 - 7s - loss: 3.2892 - accuracy30: 0.3721 - val_loss: 3.2923 - val_accuracy30: 0.3812 - 7s/epoch - 33ms/step
Epoch 3/50
220/220 - 7s - loss: 3.2664 - accuracy30: 0.3854 - val_loss: 3.2773 - val_accuracy30: 0.3849 - 7s/epoch - 33ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2510 - accuracy30: 0.3932 - val_loss: 3.2719 - val_accuracy30: 0.3877 - 7s/epoch - 32ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2371 - accuracy30: 0.4010 - val_loss: 3.2690 - val_accuracy30: 0.3877 - 7s/epoch - 32ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2243 - accuracy30: 0.4114 - val_loss: 3.2631 - val_accuracy30: 0.3959 - 7s/epoch - 33ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2178 - accuracy30: 0.4134 - val_loss: 3.2567 - val_accuracy30: 0.3937 - 7s/epoch - 32ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2112 - accuracy30: 0.4166 - val_loss: 3.2566 - val_accuracy30: 0.3999 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2024 - accuracy30: 0.4208 - val_loss: 3.2511 - val_accuracy30: 0.4002 - 7s/epoch - 32ms/step
Epoch 10/50
220/220 - 7s - loss: 3.1957 - accuracy30: 0.4250 - val_loss: 3.2586 - val_accuracy30: 0.3976 - 7s/epoch - 31ms/step
Epoch 11/50
220/220 - 7s - loss: 3.1878 - accuracy30: 0.4281 - val_loss: 3.2556 - val_accuracy30: 0.4026 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.1800 - accuracy30: 0.4325 - val_loss: 3.2571 - val_accuracy30: 0.4001 - 7s/epoch - 33ms/step
Epoch 13/50
220/220 - 7s - loss: 3.1750 - accuracy30: 0.4333 - val_loss: 3.2594 - val_accuracy30: 0.4004 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.1645 - accuracy30: 0.4389 - val_loss: 3.2613 - val_accuracy30: 0.4006 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.1591 - accuracy30: 0.4429 - val_loss: 3.2661 - val_accuracy30: 0.3975 - 7s/epoch - 31ms/step
Epoch 16/50
220/220 - 7s - loss: 3.1502 - accuracy30: 0.4445 - val_loss: 3.2741 - val_accuracy30: 0.3957 - 7s/epoch - 32ms/step
Epoch 17/50
220/220 - 7s - loss: 3.1433 - accuracy30: 0.4478 - val_loss: 3.2711 - val_accuracy30: 0.4018 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.1322 - accuracy30: 0.4520 - val_loss: 3.2821 - val_accuracy30: 0.3978 - 7s/epoch - 32ms/step
Epoch 19/50
220/220 - 7s - loss: 3.1239 - accuracy30: 0.4579 - val_loss: 3.2854 - val_accuracy30: 0.3945 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h30
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0883914
{'0': {'precision': 0.4084630165681157, 'recall': 0.5682798659874249, 'f1-score': 0.4752966465623546, 'support': 87156}, '1': {'precision': 0.3452605631090398, 'recall': 0.1172316384180791, 'f1-score': 0.1750319739912328, 'support': 76464}, '2': {'precision': 0.39942580297864705, 'recall': 0.47748885763996474, 'f1-score': 0.4349827387802071, 'support': 83914}, 'accuracy': 0.3981715643103574, 'macro avg': {'precision': 0.3843831275519342, 'recall': 0.3876667873484896, 'f1-score': 0.3617704531112649, 'support': 247534}, 'weighted avg': {'precision': 0.3858759734045848, 'recall': 0.3981715643103574, 'f1-score': 0.36887757208729505, 'support': 247534}}
[[49529  8441 29186]
 [36440  8964 31060]
 [35288  8558 40068]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0694413
{'0': {'precision': 0.40299447281886236, 'recall': 0.6214597831364298, 'f1-score': 0.48893321732487327, 'support': 18537}, '1': {'precision': 0.4251464128843338, 'recall': 0.12528314097724086, 'f1-score': 0.19353494959593434, 'support': 18542}, '2': {'precision': 0.43649543019224707, 'recall': 0.5054217495568762, 'f1-score': 0.4684366921943324, 'support': 19182}, 'accuracy': 0.41837151845861253, 'macro avg': {'precision': 0.42154543863181443, 'recall': 0.417388224556849, 'f1-score': 0.38363495303838, 'support': 56261}, 'weighted avg': {'precision': 0.42171715170886137, 'recall': 0.41837151845861253, 'f1-score': 0.3845902617200312, 'support': 56261}}
[[11520  1534  5483]
 [ 9186  2323  7033]
 [ 7880  1607  9695]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843266
{'0': {'precision': 0.39834918356361027, 'recall': 0.6394930145470258, 'f1-score': 0.4909060755155067, 'support': 6943}, '1': {'precision': 0.36896762370189373, 'recall': 0.09540356973621861, 'f1-score': 0.15160642570281127, 'support': 6331}, '2': {'precision': 0.4137883393202542, 'recall': 0.44390099303394104, 'f1-score': 0.4283160529138363, 'support': 6747}, 'accuracy': 0.4015283951850557, 'macro avg': {'precision': 0.39370171552858607, 'recall': 0.3929325257723952, 'f1-score': 0.35694285137738474, 'support': 20021}, 'weighted avg': {'precision': 0.3942611424270811, 'recall': 0.4015283951850557, 'f1-score': 0.36252083174857974, 'support': 20021}}
[[4440  497 2006]
 [3490  604 2237]
 [3216  536 2995]]
training model: results/XRAY/W10/deepOF_L2/h50
Epoch 1/50
220/220 - 9s - loss: 3.3373 - accuracy50: 0.3456 - val_loss: 3.3139 - val_accuracy50: 0.3560 - 9s/epoch - 41ms/step
Epoch 2/50
220/220 - 7s - loss: 3.2982 - accuracy50: 0.3666 - val_loss: 3.2974 - val_accuracy50: 0.3711 - 7s/epoch - 31ms/step
Epoch 3/50
220/220 - 7s - loss: 3.2820 - accuracy50: 0.3759 - val_loss: 3.2865 - val_accuracy50: 0.3808 - 7s/epoch - 31ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2653 - accuracy50: 0.3861 - val_loss: 3.2875 - val_accuracy50: 0.3768 - 7s/epoch - 31ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2508 - accuracy50: 0.3930 - val_loss: 3.2828 - val_accuracy50: 0.3805 - 7s/epoch - 31ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2451 - accuracy50: 0.3983 - val_loss: 3.2803 - val_accuracy50: 0.3853 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2356 - accuracy50: 0.4040 - val_loss: 3.2750 - val_accuracy50: 0.3860 - 7s/epoch - 31ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2289 - accuracy50: 0.4083 - val_loss: 3.2748 - val_accuracy50: 0.3887 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2198 - accuracy50: 0.4126 - val_loss: 3.2754 - val_accuracy50: 0.3891 - 7s/epoch - 33ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2132 - accuracy50: 0.4153 - val_loss: 3.2748 - val_accuracy50: 0.3886 - 7s/epoch - 32ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2017 - accuracy50: 0.4225 - val_loss: 3.2757 - val_accuracy50: 0.3914 - 7s/epoch - 31ms/step
Epoch 12/50
220/220 - 7s - loss: 3.1970 - accuracy50: 0.4247 - val_loss: 3.2760 - val_accuracy50: 0.3891 - 7s/epoch - 31ms/step
Epoch 13/50
220/220 - 7s - loss: 3.1900 - accuracy50: 0.4308 - val_loss: 3.2823 - val_accuracy50: 0.3881 - 7s/epoch - 31ms/step
Epoch 14/50
220/220 - 7s - loss: 3.1830 - accuracy50: 0.4307 - val_loss: 3.2796 - val_accuracy50: 0.3851 - 7s/epoch - 31ms/step
Epoch 15/50
220/220 - 7s - loss: 3.1740 - accuracy50: 0.4346 - val_loss: 3.2908 - val_accuracy50: 0.3875 - 7s/epoch - 31ms/step
Epoch 16/50
220/220 - 7s - loss: 3.1640 - accuracy50: 0.4382 - val_loss: 3.2947 - val_accuracy50: 0.3847 - 7s/epoch - 31ms/step
Epoch 17/50
220/220 - 7s - loss: 3.1581 - accuracy50: 0.4441 - val_loss: 3.2955 - val_accuracy50: 0.3854 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.1473 - accuracy50: 0.4477 - val_loss: 3.2967 - val_accuracy50: 0.3844 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h50
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094086
{'0': {'precision': 0.39808020508536823, 'recall': 0.6123079649546426, 'f1-score': 0.4824832425638877, 'support': 90283}, '1': {'precision': 0.33052808752366925, 'recall': 0.10768830029338379, 'f1-score': 0.16244946074224204, 'support': 72942}, '2': {'precision': 0.38977620730270907, 'recall': 0.39250851036069695, 'f1-score': 0.39113758724417735, 'support': 84309}, 'accuracy': 0.3887465964271575, 'macro avg': {'precision': 0.3727948333039155, 'recall': 0.3708349252029078, 'f1-score': 0.34535676351676897, 'support': 247534}, 'weighted avg': {'precision': 0.37534600166990345, 'recall': 0.3887465964271575, 'f1-score': 0.35706546170152564, 'support': 247534}}
[[55281  8028 26974]
 [40253  7855 24834]
 [43335  7882 33092]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814949
{'0': {'precision': 0.37705772355231293, 'recall': 0.6646852202107538, 'f1-score': 0.48116418260767513, 'support': 18505}, '1': {'precision': 0.43242271746944644, 'recall': 0.12935483870967743, 'f1-score': 0.1991392153616951, 'support': 18600}, '2': {'precision': 0.42763885815445896, 'recall': 0.4035289204426811, 'f1-score': 0.41523420713364845, 'support': 19156}, 'accuracy': 0.3987842377490624, 'macro avg': {'precision': 0.4123730997254061, 'recall': 0.3991896597877041, 'f1-score': 0.3651792017010062, 'support': 56261}, 'weighted avg': {'precision': 0.4125835958492397, 'recall': 0.3987842377490624, 'f1-score': 0.3654780234395892, 'support': 56261}}
[[12300  1540  4665]
 [10513  2406  5681]
 [ 9808  1618  7730]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922712
{'0': {'precision': 0.38064309197337826, 'recall': 0.6852894470910929, 'f1-score': 0.4894319001958965, 'support': 6927}, '1': {'precision': 0.35611510791366907, 'recall': 0.09418106865387664, 'f1-score': 0.1489655172413793, 'support': 6307}, '2': {'precision': 0.3976538592315539, 'recall': 0.34462943863268014, 'f1-score': 0.36924777014760446, 'support': 6787}, 'accuracy': 0.3835972229159383, 'macro avg': {'precision': 0.3781373530395338, 'recall': 0.37469998479254985, 'f1-score': 0.33588172919496007, 'support': 20021}, 'weighted avg': {'precision': 0.3786828543187482, 'recall': 0.3835972229159383, 'f1-score': 0.34143673672095026, 'support': 20021}}
[[4747  470 1710]
 [3880  594 1833]
 [3844  604 2339]]
training model: results/XRAY/W10/deepOF_L2/h100
Epoch 1/50
220/220 - 9s - loss: 3.3402 - accuracy100: 0.3395 - val_loss: 3.3218 - val_accuracy100: 0.3458 - 9s/epoch - 42ms/step
Epoch 2/50
220/220 - 7s - loss: 3.3129 - accuracy100: 0.3508 - val_loss: 3.3064 - val_accuracy100: 0.3524 - 7s/epoch - 32ms/step
Epoch 3/50
220/220 - 7s - loss: 3.2953 - accuracy100: 0.3608 - val_loss: 3.2995 - val_accuracy100: 0.3606 - 7s/epoch - 30ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2796 - accuracy100: 0.3746 - val_loss: 3.2989 - val_accuracy100: 0.3598 - 7s/epoch - 31ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2719 - accuracy100: 0.3802 - val_loss: 3.2949 - val_accuracy100: 0.3643 - 7s/epoch - 31ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2646 - accuracy100: 0.3849 - val_loss: 3.2939 - val_accuracy100: 0.3643 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2594 - accuracy100: 0.3874 - val_loss: 3.2878 - val_accuracy100: 0.3743 - 7s/epoch - 33ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2528 - accuracy100: 0.3925 - val_loss: 3.2912 - val_accuracy100: 0.3720 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2456 - accuracy100: 0.3987 - val_loss: 3.2939 - val_accuracy100: 0.3660 - 7s/epoch - 31ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2378 - accuracy100: 0.4005 - val_loss: 3.2937 - val_accuracy100: 0.3711 - 7s/epoch - 32ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2327 - accuracy100: 0.4048 - val_loss: 3.2904 - val_accuracy100: 0.3754 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.2259 - accuracy100: 0.4093 - val_loss: 3.2924 - val_accuracy100: 0.3778 - 7s/epoch - 32ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2213 - accuracy100: 0.4090 - val_loss: 3.2959 - val_accuracy100: 0.3755 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2135 - accuracy100: 0.4149 - val_loss: 3.2903 - val_accuracy100: 0.3752 - 7s/epoch - 31ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2067 - accuracy100: 0.4182 - val_loss: 3.2997 - val_accuracy100: 0.3746 - 7s/epoch - 32ms/step
Epoch 16/50
220/220 - 7s - loss: 3.2007 - accuracy100: 0.4209 - val_loss: 3.3065 - val_accuracy100: 0.3720 - 7s/epoch - 31ms/step
Epoch 17/50
220/220 - 7s - loss: 3.1963 - accuracy100: 0.4261 - val_loss: 3.3037 - val_accuracy100: 0.3748 - 7s/epoch - 31ms/step
testing model: results/XRAY/W10/deepOF_L2/h100
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978534
{'0': {'precision': 0.39447453394119864, 'recall': 0.5820967126424249, 'f1-score': 0.47026231876398356, 'support': 91715}, '1': {'precision': 0.311540575971582, 'recall': 0.20312392296345314, 'f1-score': 0.24591299413340453, 'support': 72537}, '2': {'precision': 0.37107683774247724, 'recall': 0.28918613866141546, 'f1-score': 0.32505314303067107, 'support': 83282}, 'accuracy': 0.3724942836135642, 'macro avg': {'precision': 0.3590306492184194, 'recall': 0.3581355914224312, 'f1-score': 0.3470761519760197, 'support': 247534}, 'weighted avg': {'precision': 0.3622996107223116, 'recall': 0.3724942836135642, 'f1-score': 0.35566417251276133, 'support': 247534}}
[[53387 16638 21690]
 [38674 14734 19129]
 [43276 15922 24084]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0859946
{'0': {'precision': 0.36437383809362855, 'recall': 0.588652869546224, 'f1-score': 0.4501231784208109, 'support': 18313}, '1': {'precision': 0.386634460547504, 'recall': 0.26171789840854587, 'f1-score': 0.312142485699428, 'support': 18348}, '2': {'precision': 0.4230499438832772, 'recall': 0.30770408163265306, 'f1-score': 0.35627362948960306, 'support': 19600}, 'accuracy': 0.38415598727359984, 'macro avg': {'precision': 0.39135274750813664, 'recall': 0.3860249498624743, 'f1-score': 0.37284643120328065, 'support': 56261}, 'weighted avg': {'precision': 0.39207490231681724, 'recall': 0.38415598727359984, 'f1-score': 0.3724295556785275, 'support': 56261}}
[[10780  3542  3991]
 [ 9312  4802  4234]
 [ 9493  4076  6031]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963361
{'0': {'precision': 0.3714336503421918, 'recall': 0.6111436092424686, 'f1-score': 0.4620487589142573, 'support': 6838}, '1': {'precision': 0.35388349514563106, 'recall': 0.22569659442724457, 'f1-score': 0.2756143667296786, 'support': 6460}, '2': {'precision': 0.3851612903225806, 'recall': 0.26639892904953144, 'f1-score': 0.31495647586388814, 'support': 6723}, 'accuracy': 0.37101043903900904, 'macro avg': {'precision': 0.3701594786034678, 'recall': 0.36774637757308154, 'f1-score': 0.350873200502608, 'support': 20021}, 'weighted avg': {'precision': 0.37038060209377116, 'recall': 0.37101043903900904, 'f1-score': 0.35250040506280084, 'support': 20021}}
[[4179 1214 1445]
 [3588 1458 1414]
 [3484 1448 1791]]
training model: results/XRAY/W10/deepOF_L2/h200
Epoch 1/50
220/220 - 9s - loss: 3.3464 - accuracy200: 0.3359 - val_loss: 3.3325 - val_accuracy200: 0.3422 - 9s/epoch - 42ms/step
Epoch 2/50
220/220 - 7s - loss: 3.3197 - accuracy200: 0.3443 - val_loss: 3.3236 - val_accuracy200: 0.3455 - 7s/epoch - 32ms/step
Epoch 3/50
220/220 - 7s - loss: 3.3054 - accuracy200: 0.3547 - val_loss: 3.3131 - val_accuracy200: 0.3515 - 7s/epoch - 31ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2930 - accuracy200: 0.3618 - val_loss: 3.3129 - val_accuracy200: 0.3505 - 7s/epoch - 31ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2845 - accuracy200: 0.3673 - val_loss: 3.3099 - val_accuracy200: 0.3501 - 7s/epoch - 31ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2735 - accuracy200: 0.3756 - val_loss: 3.3025 - val_accuracy200: 0.3576 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2685 - accuracy200: 0.3788 - val_loss: 3.3054 - val_accuracy200: 0.3605 - 7s/epoch - 32ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2623 - accuracy200: 0.3845 - val_loss: 3.3016 - val_accuracy200: 0.3602 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2549 - accuracy200: 0.3896 - val_loss: 3.3022 - val_accuracy200: 0.3615 - 7s/epoch - 31ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2477 - accuracy200: 0.3963 - val_loss: 3.3038 - val_accuracy200: 0.3554 - 7s/epoch - 31ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2418 - accuracy200: 0.4000 - val_loss: 3.3065 - val_accuracy200: 0.3606 - 7s/epoch - 31ms/step
Epoch 12/50
220/220 - 7s - loss: 3.2345 - accuracy200: 0.4003 - val_loss: 3.3071 - val_accuracy200: 0.3583 - 7s/epoch - 32ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2306 - accuracy200: 0.4061 - val_loss: 3.3084 - val_accuracy200: 0.3623 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2232 - accuracy200: 0.4078 - val_loss: 3.3085 - val_accuracy200: 0.3619 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2152 - accuracy200: 0.4133 - val_loss: 3.3091 - val_accuracy200: 0.3645 - 7s/epoch - 31ms/step
Epoch 16/50
220/220 - 7s - loss: 3.2072 - accuracy200: 0.4157 - val_loss: 3.3162 - val_accuracy200: 0.3596 - 7s/epoch - 32ms/step
Epoch 17/50
220/220 - 7s - loss: 3.2042 - accuracy200: 0.4197 - val_loss: 3.3183 - val_accuracy200: 0.3622 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.1946 - accuracy200: 0.4228 - val_loss: 3.3193 - val_accuracy200: 0.3639 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h200
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955298
{'0': {'precision': 0.39819740136783227, 'recall': 0.6598645775273012, 'f1-score': 0.4966747983902295, 'support': 96882}, '1': {'precision': 0.2890213073311665, 'recall': 0.1187036487689113, 'f1-score': 0.1682893491746399, 'support': 67420}, '2': {'precision': 0.3600627339876556, 'recall': 0.2565239331026528, 'f1-score': 0.2996000841928015, 'support': 83232}, 'accuracy': 0.3768492409123595, 'macro avg': {'precision': 0.3490938142288848, 'recall': 0.3450307197996218, 'f1-score': 0.3215214105858903, 'support': 247534}, 'weighted avg': {'precision': 0.35563889669639775, 'recall': 0.3768492409123595, 'f1-score': 0.34096823041089985, 'support': 247534}}
[[63929 10588 22365]
 [43835  8003 15582]
 [52782  9099 21351]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908408
{'0': {'precision': 0.339159019312423, 'recall': 0.6933027214693694, 'f1-score': 0.4554936261795707, 'support': 17858}, '1': {'precision': 0.42490283176013327, 'recall': 0.16461414358698576, 'f1-score': 0.23729601922555138, 'support': 18595}, '2': {'precision': 0.420729764181007, 'recall': 0.266609450726979, 'f1-score': 0.3263906056860321, 'support': 19808}, 'accuracy': 0.3683368585698797, 'macro avg': {'precision': 0.39493053841785447, 'recall': 0.37484210526111145, 'f1-score': 0.3397267503637181, 'support': 56261}, 'weighted avg': {'precision': 0.39621736357971443, 'recall': 0.3683368585698797, 'f1-score': 0.3379227132692776, 'support': 56261}}
[[12381  1940  3537]
 [11800  3061  3734]
 [12324  2203  5281]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994505
{'0': {'precision': 0.355391976444608, 'recall': 0.6976878612716763, 'f1-score': 0.4709095342599366, 'support': 6920}, '1': {'precision': 0.3712522045855379, 'recall': 0.13058312655086848, 'f1-score': 0.19320789352914178, 'support': 6448}, '2': {'precision': 0.3673224568138196, 'recall': 0.23012174958665263, 'f1-score': 0.2829683023750116, 'support': 6653}, 'accuracy': 0.3596723440387593, 'macro avg': {'precision': 0.36465554594798855, 'recall': 0.3527975791363991, 'f1-score': 0.31569524338802996, 'support': 20021}, 'weighted avg': {'precision': 0.36446446218203776, 'recall': 0.3596723440387593, 'f1-score': 0.31901935918563606, 'support': 20021}}
[[4828  733 1359]
 [4328  842 1278]
 [4429  693 1531]]
training model: results/XRAY/W10/deepOF_L2/h300
Epoch 1/50
220/220 - 9s - loss: 3.3551 - accuracy300: 0.3297 - val_loss: 3.3358 - val_accuracy300: 0.3369 - 9s/epoch - 40ms/step
Epoch 2/50
220/220 - 7s - loss: 3.3280 - accuracy300: 0.3386 - val_loss: 3.3290 - val_accuracy300: 0.3355 - 7s/epoch - 31ms/step
Epoch 3/50
220/220 - 7s - loss: 3.3108 - accuracy300: 0.3499 - val_loss: 3.3250 - val_accuracy300: 0.3388 - 7s/epoch - 31ms/step
Epoch 4/50
220/220 - 7s - loss: 3.2966 - accuracy300: 0.3565 - val_loss: 3.3220 - val_accuracy300: 0.3382 - 7s/epoch - 31ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2902 - accuracy300: 0.3597 - val_loss: 3.3197 - val_accuracy300: 0.3412 - 7s/epoch - 32ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2799 - accuracy300: 0.3670 - val_loss: 3.3125 - val_accuracy300: 0.3461 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2735 - accuracy300: 0.3771 - val_loss: 3.3159 - val_accuracy300: 0.3463 - 7s/epoch - 31ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2678 - accuracy300: 0.3804 - val_loss: 3.3158 - val_accuracy300: 0.3465 - 7s/epoch - 31ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2608 - accuracy300: 0.3880 - val_loss: 3.3154 - val_accuracy300: 0.3471 - 7s/epoch - 32ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2572 - accuracy300: 0.3870 - val_loss: 3.3170 - val_accuracy300: 0.3464 - 7s/epoch - 31ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2504 - accuracy300: 0.3925 - val_loss: 3.3200 - val_accuracy300: 0.3457 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.2439 - accuracy300: 0.3978 - val_loss: 3.3240 - val_accuracy300: 0.3441 - 7s/epoch - 32ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2411 - accuracy300: 0.3987 - val_loss: 3.3236 - val_accuracy300: 0.3495 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2326 - accuracy300: 0.4053 - val_loss: 3.3220 - val_accuracy300: 0.3480 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2267 - accuracy300: 0.4061 - val_loss: 3.3269 - val_accuracy300: 0.3517 - 7s/epoch - 32ms/step
Epoch 16/50
220/220 - 7s - loss: 3.2212 - accuracy300: 0.4092 - val_loss: 3.3296 - val_accuracy300: 0.3492 - 7s/epoch - 32ms/step
testing model: results/XRAY/W10/deepOF_L2/h300
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952142
{'0': {'precision': 0.39326933763871097, 'recall': 0.6949811340259472, 'f1-score': 0.502301220842486, 'support': 96735}, '1': {'precision': 0.3015273512077696, 'recall': 0.10553150692890968, 'f1-score': 0.15634415081346303, 'support': 68842}, '2': {'precision': 0.34560210321769447, 'recall': 0.2213477799333797, 'f1-score': 0.26985897893609423, 'support': 81957}, 'accuracy': 0.37423141871419685, 'macro avg': {'precision': 0.34679959735472493, 'recall': 0.34062014029607884, 'f1-score': 0.30950145019734776, 'support': 247534}, 'weighted avg': {'precision': 0.35197252442791116, 'recall': 0.37423141871419685, 'f1-score': 0.3291264430953476, 'support': 247534}}
[[67229  9140 20366]
 [47593  7265 13984]
 [56127  7689 18141]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988673
{'0': {'precision': 0.3223157462533361, 'recall': 0.7250894815841127, 'f1-score': 0.44626043702256174, 'support': 17322}, '1': {'precision': 0.4333276421376131, 'recall': 0.13102736189984512, 'f1-score': 0.20121298608633606, 'support': 19370}, '2': {'precision': 0.40075201119272474, 'recall': 0.23419694414635392, 'f1-score': 0.29562973713917107, 'support': 19569}, 'accuracy': 0.34981603597518707, 'macro avg': {'precision': 0.385465133194558, 'recall': 0.3634379292101039, 'f1-score': 0.3143677200826896, 'support': 56261}, 'weighted avg': {'precision': 0.3878179536772593, 'recall': 0.34981603597518707, 'f1-score': 0.30950031383504706, 'support': 56261}}
[[12560  1528  3234]
 [13213  2538  3619]
 [13195  1791  4583]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1058582
{'0': {'precision': 0.3387142252925419, 'recall': 0.7093297903749631, 'f1-score': 0.45849236641221375, 'support': 6774}, '1': {'precision': 0.3656798245614035, 'recall': 0.09787234042553192, 'f1-score': 0.15441602037272834, 'support': 6815}, '2': {'precision': 0.33582647718773373, 'recall': 0.20942164179104478, 'f1-score': 0.2579718471703533, 'support': 6432}, 'accuracy': 0.3405923780030968, 'macro avg': {'precision': 0.3467401756805597, 'recall': 0.33887459086384664, 'f1-score': 0.29029341131843184, 'support': 20021}, 'weighted avg': {'precision': 0.3469653897302406, 'recall': 0.3405923780030968, 'f1-score': 0.2905672738582584, 'support': 20021}}
[[4805  609 1360]
 [4844  667 1304]
 [4537  548 1347]]
training model: results/XRAY/W10/deepOF_L2/h500
Epoch 1/50
220/220 - 9s - loss: 3.3541 - accuracy500: 0.3324 - val_loss: 3.3407 - val_accuracy500: 0.3435 - 9s/epoch - 42ms/step
Epoch 2/50
220/220 - 7s - loss: 3.3284 - accuracy500: 0.3420 - val_loss: 3.3312 - val_accuracy500: 0.3476 - 7s/epoch - 32ms/step
Epoch 3/50
220/220 - 7s - loss: 3.3147 - accuracy500: 0.3452 - val_loss: 3.3290 - val_accuracy500: 0.3459 - 7s/epoch - 31ms/step
Epoch 4/50
220/220 - 7s - loss: 3.3044 - accuracy500: 0.3527 - val_loss: 3.3253 - val_accuracy500: 0.3436 - 7s/epoch - 31ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2936 - accuracy500: 0.3589 - val_loss: 3.3222 - val_accuracy500: 0.3453 - 7s/epoch - 32ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2880 - accuracy500: 0.3617 - val_loss: 3.3192 - val_accuracy500: 0.3500 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2827 - accuracy500: 0.3660 - val_loss: 3.3208 - val_accuracy500: 0.3487 - 7s/epoch - 32ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2783 - accuracy500: 0.3713 - val_loss: 3.3205 - val_accuracy500: 0.3429 - 7s/epoch - 32ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2707 - accuracy500: 0.3758 - val_loss: 3.3183 - val_accuracy500: 0.3526 - 7s/epoch - 33ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2666 - accuracy500: 0.3782 - val_loss: 3.3203 - val_accuracy500: 0.3525 - 7s/epoch - 32ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2608 - accuracy500: 0.3824 - val_loss: 3.3258 - val_accuracy500: 0.3463 - 7s/epoch - 32ms/step
Epoch 12/50
220/220 - 7s - loss: 3.2548 - accuracy500: 0.3857 - val_loss: 3.3276 - val_accuracy500: 0.3486 - 7s/epoch - 32ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2498 - accuracy500: 0.3889 - val_loss: 3.3280 - val_accuracy500: 0.3499 - 7s/epoch - 32ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2466 - accuracy500: 0.3909 - val_loss: 3.3346 - val_accuracy500: 0.3470 - 7s/epoch - 31ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2378 - accuracy500: 0.3979 - val_loss: 3.3310 - val_accuracy500: 0.3526 - 7s/epoch - 32ms/step
Epoch 16/50
220/220 - 7s - loss: 3.2326 - accuracy500: 0.3993 - val_loss: 3.3322 - val_accuracy500: 0.3496 - 7s/epoch - 31ms/step
Epoch 17/50
220/220 - 7s - loss: 3.2284 - accuracy500: 0.4020 - val_loss: 3.3363 - val_accuracy500: 0.3497 - 7s/epoch - 31ms/step
Epoch 18/50
220/220 - 7s - loss: 3.2229 - accuracy500: 0.4059 - val_loss: 3.3412 - val_accuracy500: 0.3542 - 7s/epoch - 31ms/step
Epoch 19/50
220/220 - 7s - loss: 3.2151 - accuracy500: 0.4058 - val_loss: 3.3509 - val_accuracy500: 0.3472 - 7s/epoch - 31ms/step
testing model: results/XRAY/W10/deepOF_L2/h500
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0907514
{'0': {'precision': 0.41284553762834253, 'recall': 0.7215566795831239, 'f1-score': 0.5251954743954558, 'support': 101421}, '1': {'precision': 0.27879110637731325, 'recall': 0.0647605498770663, 'f1-score': 0.10510597181613983, 'support': 64669}, '2': {'precision': 0.33300152030695723, 'recall': 0.22590982761161044, 'f1-score': 0.26919587990870253, 'support': 81444}, 'accuracy': 0.3868882658543877, 'macro avg': {'precision': 0.341546054770871, 'recall': 0.33740901902393355, 'f1-score': 0.29983244204009935, 'support': 247534}, 'weighted avg': {'precision': 0.351553019585182, 'recall': 0.3868882658543877, 'f1-score': 0.3312164694277305, 'support': 247534}}
[[73181  5795 22445]
 [46073  4188 14408]
 [58006  5039 18399]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917628
{'0': {'precision': 0.3366572294741062, 'recall': 0.7521410579345088, 'f1-score': 0.4651251341340995, 'support': 17865}, '1': {'precision': 0.41792522901708345, 'recall': 0.09565907287770599, 'f1-score': 0.1556836522942126, 'support': 17646}, '2': {'precision': 0.4283044926476562, 'recall': 0.2540722891566265, 'f1-score': 0.31894491666414587, 'support': 20750}, 'accuracy': 0.3625424361458204, 'macro avg': {'precision': 0.3942956503796153, 'recall': 0.3672908066562804, 'f1-score': 0.31325123436415264, 'support': 56261}, 'weighted avg': {'precision': 0.3959476052368288, 'recall': 0.3625424361458204, 'f1-score': 0.3141565430843815, 'support': 56261}}
[[13437   978  3450]
 [12371  1688  3587]
 [14105  1373  5272]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029093
{'0': {'precision': 0.34599098483813684, 'recall': 0.7252684323550466, 'f1-score': 0.4684884634947056, 'support': 6985}, '1': {'precision': 0.3500424808836024, 'recall': 0.06635529070703818, 'f1-score': 0.1115624153804495, 'support': 6209}, '2': {'precision': 0.33912422655878155, 'recall': 0.2087300424783946, 'f1-score': 0.25840964729349897, 'support': 6827}, 'accuracy': 0.34478797262873984, 'macro avg': {'precision': 0.34505256409350693, 'recall': 0.3334512551801598, 'f1-score': 0.279486842056218, 'support': 20021}, 'weighted avg': {'precision': 0.34490594314057615, 'recall': 0.34478797262873984, 'f1-score': 0.28616181093254317, 'support': 20021}}
[[5066  372 1547]
 [4567  412 1230]
 [5009  393 1425]]
training model: results/XRAY/W10/deepOF_L2/h1000
Epoch 1/50
220/220 - 9s - loss: 3.3651 - accuracy1000: 0.3300 - val_loss: 3.3556 - val_accuracy1000: 0.3343 - 9s/epoch - 40ms/step
Epoch 2/50
220/220 - 7s - loss: 3.3359 - accuracy1000: 0.3379 - val_loss: 3.3422 - val_accuracy1000: 0.3374 - 7s/epoch - 31ms/step
Epoch 3/50
220/220 - 7s - loss: 3.3206 - accuracy1000: 0.3442 - val_loss: 3.3362 - val_accuracy1000: 0.3367 - 7s/epoch - 31ms/step
Epoch 4/50
220/220 - 7s - loss: 3.3067 - accuracy1000: 0.3512 - val_loss: 3.3328 - val_accuracy1000: 0.3358 - 7s/epoch - 32ms/step
Epoch 5/50
220/220 - 7s - loss: 3.2992 - accuracy1000: 0.3543 - val_loss: 3.3271 - val_accuracy1000: 0.3435 - 7s/epoch - 32ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2903 - accuracy1000: 0.3613 - val_loss: 3.3260 - val_accuracy1000: 0.3447 - 7s/epoch - 32ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2829 - accuracy1000: 0.3640 - val_loss: 3.3306 - val_accuracy1000: 0.3397 - 7s/epoch - 31ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2779 - accuracy1000: 0.3670 - val_loss: 3.3263 - val_accuracy1000: 0.3400 - 7s/epoch - 31ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2730 - accuracy1000: 0.3721 - val_loss: 3.3229 - val_accuracy1000: 0.3469 - 7s/epoch - 31ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2668 - accuracy1000: 0.3731 - val_loss: 3.3280 - val_accuracy1000: 0.3479 - 7s/epoch - 31ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2606 - accuracy1000: 0.3797 - val_loss: 3.3279 - val_accuracy1000: 0.3469 - 7s/epoch - 31ms/step
Epoch 12/50
220/220 - 7s - loss: 3.2572 - accuracy1000: 0.3796 - val_loss: 3.3303 - val_accuracy1000: 0.3432 - 7s/epoch - 31ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2535 - accuracy1000: 0.3811 - val_loss: 3.3331 - val_accuracy1000: 0.3458 - 7s/epoch - 31ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2472 - accuracy1000: 0.3879 - val_loss: 3.3319 - val_accuracy1000: 0.3455 - 7s/epoch - 32ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2406 - accuracy1000: 0.3910 - val_loss: 3.3343 - val_accuracy1000: 0.3448 - 7s/epoch - 31ms/step
Epoch 16/50
220/220 - 7s - loss: 3.2348 - accuracy1000: 0.3919 - val_loss: 3.3359 - val_accuracy1000: 0.3475 - 7s/epoch - 31ms/step
Epoch 17/50
220/220 - 7s - loss: 3.2305 - accuracy1000: 0.3956 - val_loss: 3.3365 - val_accuracy1000: 0.3486 - 7s/epoch - 32ms/step
Epoch 18/50
220/220 - 7s - loss: 3.2257 - accuracy1000: 0.3975 - val_loss: 3.3395 - val_accuracy1000: 0.3470 - 7s/epoch - 32ms/step
Epoch 19/50
220/220 - 7s - loss: 3.2184 - accuracy1000: 0.3994 - val_loss: 3.3493 - val_accuracy1000: 0.3441 - 7s/epoch - 33ms/step
testing model: results/XRAY/W10/deepOF_L2/h1000
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0918177
{'0': {'precision': 0.4264245910479957, 'recall': 0.6795057861971509, 'f1-score': 0.5240076282480801, 'support': 104732}, '1': {'precision': 0.27781608204774627, 'recall': 0.10237070676596217, 'f1-score': 0.14961187241103233, 'support': 62977}, '2': {'precision': 0.31996239423378253, 'recall': 0.2302286251174444, 'f1-score': 0.2677779153887064, 'support': 79825}, 'accuracy': 0.3877891521972739, 'macro avg': {'precision': 0.3414010224431749, 'recall': 0.3373683726935191, 'f1-score': 0.3137991386826063, 'support': 247534}, 'weighted avg': {'precision': 0.354283943977277, 'recall': 0.3877891521972739, 'f1-score': 0.34612556621074675, 'support': 247534}}
[[71166  8961 24605]
 [42075  6447 14455]
 [53649  7798 18378]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0907395
{'0': {'precision': 0.33316420014094433, 'recall': 0.6834952579227388, 'f1-score': 0.447969374798643, 'support': 17292}, '1': {'precision': 0.41868987631699495, 'recall': 0.1495255753081034, 'f1-score': 0.22035600916140957, 'support': 18338}, '2': {'precision': 0.4165203343400997, 'recall': 0.2874315350685861, 'f1-score': 0.34013995640702077, 'support': 20631}, 'accuracy': 0.3642132205257638, 'macro avg': {'precision': 0.3894581369326797, 'recall': 0.3734841227664761, 'f1-score': 0.3361551134556911, 'support': 56261}, 'weighted avg': {'precision': 0.3916077090437223, 'recall': 0.3642132205257638, 'f1-score': 0.3342386798253374, 'support': 56261}}
[[11819  1638  3835]
 [11124  2742  4472]
 [12532  2169  5930]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032566
{'0': {'precision': 0.34222638271316014, 'recall': 0.6477188838033368, 'f1-score': 0.4478358513679052, 'support': 6773}, '1': {'precision': 0.38210986874088476, 'recall': 0.11768228776762989, 'f1-score': 0.17994505494505494, 'support': 6679}, '2': {'precision': 0.3383867832847425, 'recall': 0.2650327294869843, 'f1-score': 0.29725115246713335, 'support': 6569}, 'accuracy': 0.3453373957344788, 'macro avg': {'precision': 0.3542410115795958, 'recall': 0.34347796701931693, 'f1-score': 0.3083440195933645, 'support': 20021}, 'weighted avg': {'precision': 0.3542717088474141, 'recall': 0.3453373957344788, 'f1-score': 0.30905989030764913, 'support': 20021}}
[[4387  660 1726]
 [4215  786 1678]
 [4217  611 1741]]
training model: results/XRAY/W10/deepVOL_L2/h10
Epoch 1/50
220/220 - 9s - loss: 3.3207 - accuracy10: 0.3712 - val_loss: 3.3407 - val_accuracy10: 0.3650 - 9s/epoch - 43ms/step
Epoch 2/50
220/220 - 7s - loss: 3.2593 - accuracy10: 0.3942 - val_loss: 3.3049 - val_accuracy10: 0.3764 - 7s/epoch - 30ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2317 - accuracy10: 0.4064 - val_loss: 3.2840 - val_accuracy10: 0.3878 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.1993 - accuracy10: 0.4257 - val_loss: 3.2595 - val_accuracy10: 0.4031 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.1790 - accuracy10: 0.4332 - val_loss: 3.2404 - val_accuracy10: 0.4080 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 3.1653 - accuracy10: 0.4382 - val_loss: 3.2382 - val_accuracy10: 0.4188 - 6s/epoch - 29ms/step
Epoch 7/50
220/220 - 6s - loss: 3.1469 - accuracy10: 0.4502 - val_loss: 3.2357 - val_accuracy10: 0.4211 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.1342 - accuracy10: 0.4532 - val_loss: 3.2228 - val_accuracy10: 0.4245 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 7s - loss: 3.1291 - accuracy10: 0.4559 - val_loss: 3.2207 - val_accuracy10: 0.4265 - 7s/epoch - 30ms/step
Epoch 10/50
220/220 - 6s - loss: 3.1216 - accuracy10: 0.4591 - val_loss: 3.2208 - val_accuracy10: 0.4263 - 6s/epoch - 29ms/step
Epoch 11/50
220/220 - 6s - loss: 3.1123 - accuracy10: 0.4608 - val_loss: 3.2182 - val_accuracy10: 0.4321 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 3.1065 - accuracy10: 0.4650 - val_loss: 3.2102 - val_accuracy10: 0.4306 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 3.0995 - accuracy10: 0.4667 - val_loss: 3.2152 - val_accuracy10: 0.4290 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.0925 - accuracy10: 0.4703 - val_loss: 3.2166 - val_accuracy10: 0.4333 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 6s - loss: 3.0897 - accuracy10: 0.4689 - val_loss: 3.2165 - val_accuracy10: 0.4300 - 6s/epoch - 29ms/step
Epoch 16/50
220/220 - 6s - loss: 3.0875 - accuracy10: 0.4696 - val_loss: 3.2140 - val_accuracy10: 0.4341 - 6s/epoch - 29ms/step
Epoch 17/50
220/220 - 6s - loss: 3.0810 - accuracy10: 0.4736 - val_loss: 3.2127 - val_accuracy10: 0.4302 - 6s/epoch - 29ms/step
Epoch 18/50
220/220 - 6s - loss: 3.0762 - accuracy10: 0.4751 - val_loss: 3.2226 - val_accuracy10: 0.4315 - 6s/epoch - 28ms/step
Epoch 19/50
220/220 - 6s - loss: 3.0704 - accuracy10: 0.4761 - val_loss: 3.2281 - val_accuracy10: 0.4322 - 6s/epoch - 29ms/step
Epoch 20/50
220/220 - 6s - loss: 3.0656 - accuracy10: 0.4784 - val_loss: 3.2360 - val_accuracy10: 0.4306 - 6s/epoch - 29ms/step
Epoch 21/50
220/220 - 6s - loss: 3.0624 - accuracy10: 0.4791 - val_loss: 3.2310 - val_accuracy10: 0.4290 - 6s/epoch - 29ms/step
Epoch 22/50
220/220 - 6s - loss: 3.0551 - accuracy10: 0.4824 - val_loss: 3.2171 - val_accuracy10: 0.4350 - 6s/epoch - 29ms/step
testing model: results/XRAY/W10/deepVOL_L2/h10
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685761
{'0': {'precision': 0.44517120894479384, 'recall': 0.5334628525490721, 'f1-score': 0.4853342272471011, 'support': 89562}, '1': {'precision': 0.4133311943530922, 'recall': 0.07436108345238611, 'f1-score': 0.12604569248079842, 'support': 69297}, '2': {'precision': 0.4268906510524709, 'recall': 0.6149526387009472, 'f1-score': 0.5039482134853784, 'support': 88680}, 'accuracy': 0.43413361126933536, 'macro avg': {'precision': 0.428464351450119, 'recall': 0.40759219156746845, 'f1-score': 0.371776044404426, 'support': 247539}, 'weighted avg': {'precision': 0.42970884800347814, 'recall': 0.43413361126933536, 'f1-score': 0.39142203848456253, 'support': 247539}}
[[47778  3576 38208]
 [29139  5153 35005]
 [30408  3738 54534]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0464871
{'0': {'precision': 0.4350284735773167, 'recall': 0.581930534839122, 'f1-score': 0.49786933436638325, 'support': 18772}, '1': {'precision': 0.550625110054587, 'recall': 0.169283239497618, 'f1-score': 0.25895408057637365, 'support': 18472}, '2': {'precision': 0.44416094210009816, 'recall': 0.5948688291887914, 'f1-score': 0.5085850413520318, 'support': 19021}, 'accuracy': 0.45083088954056694, 'macro avg': {'precision': 0.47660484191066727, 'recall': 0.4486942011751771, 'f1-score': 0.4218028187649295, 'support': 56265}, 'weighted avg': {'precision': 0.47606659235062093, 'recall': 0.45083088954056694, 'f1-score': 0.4230551673809565, 'support': 56265}}
[[10924  1252  6596]
 [ 7781  3127  7564]
 [ 6406  1300 11315]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0684274
{'0': {'precision': 0.43084760459570776, 'recall': 0.5649516770892553, 'f1-score': 0.48886975771737795, 'support': 7036}, '1': {'precision': 0.46085232903865214, 'recall': 0.07600523046747303, 'f1-score': 0.13048968710537395, 'support': 6118}, '2': {'precision': 0.4260167586347844, 'recall': 0.6071064511431484, 'f1-score': 0.5006905662643367, 'support': 6867}, 'accuracy': 0.42999850157334796, 'macro avg': {'precision': 0.43923889742304806, 'recall': 0.4160211195666255, 'f1-score': 0.3733500036956962, 'support': 20021}, 'weighted avg': {'precision': 0.4383594913610178, 'recall': 0.42999850157334796, 'f1-score': 0.3834107007415888, 'support': 20021}}
[[3975  271 2790]
 [2826  465 2827]
 [2425  273 4169]]
training model: results/XRAY/W10/deepVOL_L2/h20
Epoch 1/50
220/220 - 9s - loss: 3.3395 - accuracy20: 0.3625 - val_loss: 3.3325 - val_accuracy20: 0.3556 - 9s/epoch - 39ms/step
Epoch 2/50
220/220 - 6s - loss: 3.2830 - accuracy20: 0.3784 - val_loss: 3.2972 - val_accuracy20: 0.3773 - 6s/epoch - 29ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2543 - accuracy20: 0.3937 - val_loss: 3.2672 - val_accuracy20: 0.3952 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2359 - accuracy20: 0.4076 - val_loss: 3.2630 - val_accuracy20: 0.3958 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2198 - accuracy20: 0.4157 - val_loss: 3.2440 - val_accuracy20: 0.4048 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2125 - accuracy20: 0.4163 - val_loss: 3.2387 - val_accuracy20: 0.4087 - 6s/epoch - 29ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2017 - accuracy20: 0.4244 - val_loss: 3.2390 - val_accuracy20: 0.4150 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.1935 - accuracy20: 0.4257 - val_loss: 3.2283 - val_accuracy20: 0.4226 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 6s - loss: 3.1881 - accuracy20: 0.4304 - val_loss: 3.2216 - val_accuracy20: 0.4222 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 6s - loss: 3.1780 - accuracy20: 0.4374 - val_loss: 3.2183 - val_accuracy20: 0.4220 - 6s/epoch - 29ms/step
Epoch 11/50
220/220 - 6s - loss: 3.1731 - accuracy20: 0.4374 - val_loss: 3.2221 - val_accuracy20: 0.4249 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 3.1675 - accuracy20: 0.4395 - val_loss: 3.2185 - val_accuracy20: 0.4260 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 7s - loss: 3.1631 - accuracy20: 0.4414 - val_loss: 3.2189 - val_accuracy20: 0.4265 - 7s/epoch - 30ms/step
Epoch 14/50
220/220 - 6s - loss: 3.1580 - accuracy20: 0.4448 - val_loss: 3.2211 - val_accuracy20: 0.4265 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 7s - loss: 3.1527 - accuracy20: 0.4471 - val_loss: 3.2306 - val_accuracy20: 0.4212 - 7s/epoch - 30ms/step
Epoch 16/50
220/220 - 7s - loss: 3.1488 - accuracy20: 0.4482 - val_loss: 3.2281 - val_accuracy20: 0.4243 - 7s/epoch - 30ms/step
Epoch 17/50
220/220 - 7s - loss: 3.1468 - accuracy20: 0.4477 - val_loss: 3.2320 - val_accuracy20: 0.4216 - 7s/epoch - 30ms/step
Epoch 18/50
220/220 - 7s - loss: 3.1376 - accuracy20: 0.4538 - val_loss: 3.2310 - val_accuracy20: 0.4240 - 7s/epoch - 30ms/step
Epoch 19/50
220/220 - 7s - loss: 3.1323 - accuracy20: 0.4540 - val_loss: 3.2366 - val_accuracy20: 0.4166 - 7s/epoch - 30ms/step
Epoch 20/50
220/220 - 7s - loss: 3.1319 - accuracy20: 0.4543 - val_loss: 3.2342 - val_accuracy20: 0.4172 - 7s/epoch - 30ms/step
testing model: results/XRAY/W10/deepVOL_L2/h20
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845995
{'0': {'precision': 0.4209554644088144, 'recall': 0.5290789383444208, 'f1-score': 0.4688644317600522, 'support': 87486}, '1': {'precision': 0.36023892420225506, 'recall': 0.1502211092759337, 'f1-score': 0.21202635759472846, 'support': 75076}, '2': {'precision': 0.40382968713243944, 'recall': 0.505042540922838, 'f1-score': 0.4488005354192374, 'support': 84977}, 'accuracy': 0.40592391501945146, 'macro avg': {'precision': 0.3950080252478363, 'recall': 0.3947808628477308, 'f1-score': 0.3765637749246727, 'support': 247539}, 'weighted avg': {'precision': 0.3966617080788536, 'recall': 0.40592391501945146, 'f1-score': 0.3840804382261474, 'support': 247539}}
[[46287  9828 31371]
 [31811 11278 31987]
 [31859 10201 42917]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0605221
{'0': {'precision': 0.42630385487528344, 'recall': 0.5450445613658327, 'f1-score': 0.47841658812441096, 'support': 18626}, '1': {'precision': 0.4327354260089686, 'recall': 0.2604166666666667, 'f1-score': 0.3251566817170969, 'support': 18528}, '2': {'precision': 0.4421858128726351, 'recall': 0.49285751661346866, 'f1-score': 0.4661486687122637, 'support': 19111}, 'accuracy': 0.43359104238869633, 'macro avg': {'precision': 0.43374169791896233, 'recall': 0.4327729148819894, 'f1-score': 0.42324064618459056, 'support': 56265}, 'weighted avg': {'precision': 0.4338162382264308, 'recall': 0.43359104238869633, 'f1-score': 0.4237813485651777, 'support': 56265}}
[[10152  3084  5390]
 [ 7211  4825  6492]
 [ 6451  3241  9419]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0733957
{'0': {'precision': 0.42860250135943445, 'recall': 0.5692618806875632, 'f1-score': 0.489018488646234, 'support': 6923}, '1': {'precision': 0.39695431472081216, 'recall': 0.18583650190114068, 'f1-score': 0.2531563612819682, 'support': 6312}, '2': {'precision': 0.424469571846017, 'recall': 0.49233716475095785, 'f1-score': 0.4558913829569489, 'support': 6786}, 'accuracy': 0.42230657809300237, 'macro avg': {'precision': 0.4166754626420879, 'recall': 0.41581184911322056, 'f1-score': 0.399355410961717, 'support': 20021}, 'weighted avg': {'precision': 0.4172239781217823, 'recall': 0.42230657809300237, 'f1-score': 0.4034302419487297, 'support': 20021}}
[[3941  859 2123]
 [2732 1173 2407]
 [2522  923 3341]]
training model: results/XRAY/W10/deepVOL_L2/h30
Epoch 1/50
220/220 - 9s - loss: 3.3531 - accuracy30: 0.3461 - val_loss: 3.3150 - val_accuracy30: 0.3505 - 9s/epoch - 41ms/step
Epoch 2/50
220/220 - 6s - loss: 3.2992 - accuracy30: 0.3652 - val_loss: 3.2921 - val_accuracy30: 0.3641 - 6s/epoch - 29ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2765 - accuracy30: 0.3797 - val_loss: 3.2772 - val_accuracy30: 0.3774 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2628 - accuracy30: 0.3855 - val_loss: 3.2674 - val_accuracy30: 0.3881 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2515 - accuracy30: 0.3930 - val_loss: 3.2581 - val_accuracy30: 0.3959 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2463 - accuracy30: 0.3972 - val_loss: 3.2521 - val_accuracy30: 0.4028 - 6s/epoch - 29ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2375 - accuracy30: 0.4022 - val_loss: 3.2557 - val_accuracy30: 0.4026 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2315 - accuracy30: 0.4090 - val_loss: 3.2497 - val_accuracy30: 0.4039 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2255 - accuracy30: 0.4118 - val_loss: 3.2509 - val_accuracy30: 0.4024 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2185 - accuracy30: 0.4148 - val_loss: 3.2532 - val_accuracy30: 0.4020 - 6s/epoch - 29ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2126 - accuracy30: 0.4183 - val_loss: 3.2517 - val_accuracy30: 0.4035 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2065 - accuracy30: 0.4188 - val_loss: 3.2554 - val_accuracy30: 0.4016 - 6s/epoch - 28ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2032 - accuracy30: 0.4223 - val_loss: 3.2511 - val_accuracy30: 0.4067 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.1976 - accuracy30: 0.4271 - val_loss: 3.2471 - val_accuracy30: 0.4042 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 6s - loss: 3.1904 - accuracy30: 0.4292 - val_loss: 3.2534 - val_accuracy30: 0.4031 - 6s/epoch - 28ms/step
Epoch 16/50
220/220 - 6s - loss: 3.1851 - accuracy30: 0.4310 - val_loss: 3.2553 - val_accuracy30: 0.4037 - 6s/epoch - 29ms/step
Epoch 17/50
220/220 - 6s - loss: 3.1832 - accuracy30: 0.4302 - val_loss: 3.2496 - val_accuracy30: 0.4088 - 6s/epoch - 29ms/step
Epoch 18/50
220/220 - 6s - loss: 3.1784 - accuracy30: 0.4347 - val_loss: 3.2548 - val_accuracy30: 0.4051 - 6s/epoch - 29ms/step
Epoch 19/50
220/220 - 6s - loss: 3.1721 - accuracy30: 0.4356 - val_loss: 3.2600 - val_accuracy30: 0.4037 - 6s/epoch - 29ms/step
Epoch 20/50
220/220 - 7s - loss: 3.1676 - accuracy30: 0.4379 - val_loss: 3.2607 - val_accuracy30: 0.4070 - 7s/epoch - 30ms/step
Epoch 21/50
220/220 - 6s - loss: 3.1633 - accuracy30: 0.4411 - val_loss: 3.2606 - val_accuracy30: 0.3999 - 6s/epoch - 29ms/step
Epoch 22/50
220/220 - 6s - loss: 3.1570 - accuracy30: 0.4406 - val_loss: 3.2596 - val_accuracy30: 0.4005 - 6s/epoch - 29ms/step
Epoch 23/50
220/220 - 6s - loss: 3.1542 - accuracy30: 0.4420 - val_loss: 3.2628 - val_accuracy30: 0.4012 - 6s/epoch - 30ms/step
Epoch 24/50
220/220 - 6s - loss: 3.1483 - accuracy30: 0.4440 - val_loss: 3.2680 - val_accuracy30: 0.3970 - 6s/epoch - 29ms/step
testing model: results/XRAY/W10/deepVOL_L2/h30
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0946304
{'0': {'precision': 0.41081403778090486, 'recall': 0.4421446355427562, 'f1-score': 0.4259039240499334, 'support': 87157}, '1': {'precision': 0.34989425838830845, 'recall': 0.14497018204645323, 'f1-score': 0.20500254288224143, 'support': 76464}, '2': {'precision': 0.37741491470988253, 'recall': 0.5489287161276484, 'f1-score': 0.44729380692521314, 'support': 83918}, 'accuracy': 0.38654919022861045, 'macro avg': {'precision': 0.37937440362636526, 'recall': 0.3786811779056192, 'f1-score': 0.359400091285796, 'support': 247539}, 'weighted avg': {'precision': 0.38067350387978405, 'recall': 0.38654919022861045, 'f1-score': 0.36491956595493147, 'support': 247539}}
[[38536 10830 37791]
 [27181 11085 38198]
 [28087  9766 46065]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.068717
{'0': {'precision': 0.4287894451828878, 'recall': 0.4696430497142241, 'f1-score': 0.4482873980287707, 'support': 18546}, '1': {'precision': 0.41435272045028143, 'recall': 0.23815172265056345, 'f1-score': 0.3024617386243024, 'support': 18547}, '2': {'precision': 0.417365174758817, 'recall': 0.5505946171500105, 'f1-score': 0.47481108312342574, 'support': 19172}, 'accuracy': 0.4209188660801564, 'macro avg': {'precision': 0.4201691134639954, 'recall': 0.419463129838266, 'f1-score': 0.408520073258833, 'support': 56265}, 'weighted avg': {'precision': 0.4201378136857593, 'recall': 0.4209188660801564, 'f1-score': 0.40925573688347705, 'support': 56265}}
[[ 8710  3163  6673]
 [ 6067  4417  8063]
 [ 5536  3080 10556]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0829582
{'0': {'precision': 0.42203689663886784, 'recall': 0.4821016166281755, 'f1-score': 0.4500741140008085, 'support': 6928}, '1': {'precision': 0.3760711931443639, 'recall': 0.17999684492822213, 'f1-score': 0.2434652725914862, 'support': 6339}, '2': {'precision': 0.3963407913589772, 'recall': 0.5324252294936334, 'f1-score': 0.45441334428508245, 'support': 6754}, 'accuracy': 0.4034264022776085, 'macro avg': {'precision': 0.398149627047403, 'recall': 0.39817456368334364, 'f1-score': 0.38265091029245907, 'support': 20021}, 'weighted avg': {'precision': 0.3988148752856866, 'recall': 0.4034264022776085, 'f1-score': 0.3861219495557904, 'support': 20021}}
[[3340  992 2596]
 [2317 1141 2881]
 [2257  901 3596]]
training model: results/XRAY/W10/deepVOL_L2/h50
Epoch 1/50
220/220 - 8s - loss: 3.3468 - accuracy50: 0.3513 - val_loss: 3.3293 - val_accuracy50: 0.3458 - 8s/epoch - 38ms/step
Epoch 2/50
220/220 - 6s - loss: 3.2986 - accuracy50: 0.3693 - val_loss: 3.3070 - val_accuracy50: 0.3608 - 6s/epoch - 28ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2836 - accuracy50: 0.3750 - val_loss: 3.3122 - val_accuracy50: 0.3588 - 6s/epoch - 28ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2700 - accuracy50: 0.3824 - val_loss: 3.3027 - val_accuracy50: 0.3672 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2603 - accuracy50: 0.3887 - val_loss: 3.2897 - val_accuracy50: 0.3712 - 6s/epoch - 28ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2505 - accuracy50: 0.3926 - val_loss: 3.2931 - val_accuracy50: 0.3740 - 6s/epoch - 28ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2495 - accuracy50: 0.3948 - val_loss: 3.2829 - val_accuracy50: 0.3764 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2439 - accuracy50: 0.3989 - val_loss: 3.2798 - val_accuracy50: 0.3813 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2356 - accuracy50: 0.4033 - val_loss: 3.2787 - val_accuracy50: 0.3810 - 7s/epoch - 30ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2288 - accuracy50: 0.4090 - val_loss: 3.2820 - val_accuracy50: 0.3829 - 6s/epoch - 28ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2228 - accuracy50: 0.4111 - val_loss: 3.2815 - val_accuracy50: 0.3831 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2128 - accuracy50: 0.4165 - val_loss: 3.2847 - val_accuracy50: 0.3827 - 6s/epoch - 30ms/step
Epoch 13/50
220/220 - 7s - loss: 3.2091 - accuracy50: 0.4198 - val_loss: 3.2913 - val_accuracy50: 0.3772 - 7s/epoch - 30ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2046 - accuracy50: 0.4231 - val_loss: 3.2909 - val_accuracy50: 0.3801 - 7s/epoch - 30ms/step
Epoch 15/50
220/220 - 6s - loss: 3.1964 - accuracy50: 0.4277 - val_loss: 3.2949 - val_accuracy50: 0.3819 - 6s/epoch - 30ms/step
Epoch 16/50
220/220 - 6s - loss: 3.1910 - accuracy50: 0.4314 - val_loss: 3.2907 - val_accuracy50: 0.3793 - 6s/epoch - 29ms/step
Epoch 17/50
220/220 - 6s - loss: 3.1847 - accuracy50: 0.4323 - val_loss: 3.3037 - val_accuracy50: 0.3772 - 6s/epoch - 28ms/step
Epoch 18/50
220/220 - 6s - loss: 3.1790 - accuracy50: 0.4359 - val_loss: 3.3043 - val_accuracy50: 0.3783 - 6s/epoch - 29ms/step
Epoch 19/50
220/220 - 6s - loss: 3.1774 - accuracy50: 0.4353 - val_loss: 3.3068 - val_accuracy50: 0.3784 - 6s/epoch - 29ms/step
testing model: results/XRAY/W10/deepVOL_L2/h50
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948972
{'0': {'precision': 0.40539797011171264, 'recall': 0.4570134243055248, 'f1-score': 0.42966110078463843, 'support': 90284}, '1': {'precision': 0.35184287099903006, 'recall': 0.09946258671273066, 'f1-score': 0.15508432910797118, 'support': 72942}, '2': {'precision': 0.3630094294390283, 'recall': 0.5387899849370796, 'f1-score': 0.43376795748926966, 'support': 84313}, 'accuracy': 0.3795078755266847, 'macro avg': {'precision': 0.37341675684992365, 'recall': 0.365088665318445, 'f1-score': 0.33950446246062643, 'support': 247539}, 'weighted avg': {'precision': 0.3751792123837856, 'recall': 0.3795078755266847, 'f1-score': 0.3501507308215139, 'support': 247539}}
[[41261  7135 41888]
 [27862  7255 37825]
 [32656  6230 45427]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.083469
{'0': {'precision': 0.3953204653392009, 'recall': 0.4895591647331787, 'f1-score': 0.4374216565422814, 'support': 18533}, '1': {'precision': 0.4343976388516233, 'recall': 0.17424527794220523, 'f1-score': 0.24872297115643122, 'support': 18583}, '2': {'precision': 0.38727764887857696, 'recall': 0.5230038122095149, 'f1-score': 0.44502210668977316, 'support': 19149}, 'accuracy': 0.39680085310583846, 'macro avg': {'precision': 0.4056652510231337, 'recall': 0.3956027516282996, 'f1-score': 0.3770555781294953, 'support': 56265}, 'weighted avg': {'precision': 0.4054894731233804, 'recall': 0.39680085310583846, 'f1-score': 0.377685645689159, 'support': 56265}}
[[ 9073  2033  7427]
 [ 6927  3238  8418]
 [ 6951  2183 10015]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090778
{'0': {'precision': 0.3921202937405292, 'recall': 0.4874655846978699, 'f1-score': 0.434625322997416, 'support': 6901}, '1': {'precision': 0.39458751636839806, 'recall': 0.14258675078864352, 'f1-score': 0.20947746495191746, 'support': 6340}, '2': {'precision': 0.37219975958911594, 'recall': 0.5023598820058998, 'f1-score': 0.42759399912121027, 'support': 6780}, 'accuracy': 0.3832975375855352, 'macro avg': {'precision': 0.3863025232326811, 'recall': 0.3774707391641377, 'f1-score': 0.35723226235684796, 'support': 20021}, 'weighted avg': {'precision': 0.3861556051592449, 'recall': 0.3832975375855352, 'f1-score': 0.3609471952371076, 'support': 20021}}
[[3364  683 2854]
 [2545  904 2891]
 [2670  704 3406]]
training model: results/XRAY/W10/deepVOL_L2/h100
Epoch 1/50
220/220 - 8s - loss: 3.3587 - accuracy100: 0.3469 - val_loss: 3.3398 - val_accuracy100: 0.3436 - 8s/epoch - 38ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3193 - accuracy100: 0.3549 - val_loss: 3.3103 - val_accuracy100: 0.3607 - 6s/epoch - 28ms/step
Epoch 3/50
220/220 - 6s - loss: 3.2923 - accuracy100: 0.3632 - val_loss: 3.3181 - val_accuracy100: 0.3521 - 6s/epoch - 28ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2869 - accuracy100: 0.3661 - val_loss: 3.3183 - val_accuracy100: 0.3554 - 6s/epoch - 28ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2757 - accuracy100: 0.3748 - val_loss: 3.3175 - val_accuracy100: 0.3627 - 6s/epoch - 28ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2726 - accuracy100: 0.3766 - val_loss: 3.3113 - val_accuracy100: 0.3567 - 6s/epoch - 28ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2682 - accuracy100: 0.3799 - val_loss: 3.3047 - val_accuracy100: 0.3531 - 6s/epoch - 28ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2614 - accuracy100: 0.3825 - val_loss: 3.3074 - val_accuracy100: 0.3628 - 6s/epoch - 28ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2559 - accuracy100: 0.3888 - val_loss: 3.2996 - val_accuracy100: 0.3670 - 6s/epoch - 28ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2468 - accuracy100: 0.3955 - val_loss: 3.3084 - val_accuracy100: 0.3628 - 6s/epoch - 28ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2409 - accuracy100: 0.4002 - val_loss: 3.3213 - val_accuracy100: 0.3600 - 6s/epoch - 28ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2357 - accuracy100: 0.4041 - val_loss: 3.3212 - val_accuracy100: 0.3636 - 6s/epoch - 28ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2314 - accuracy100: 0.4080 - val_loss: 3.3228 - val_accuracy100: 0.3623 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2209 - accuracy100: 0.4109 - val_loss: 3.3381 - val_accuracy100: 0.3601 - 6s/epoch - 28ms/step
Epoch 15/50
220/220 - 6s - loss: 3.2187 - accuracy100: 0.4114 - val_loss: 3.3422 - val_accuracy100: 0.3640 - 6s/epoch - 28ms/step
Epoch 16/50
220/220 - 6s - loss: 3.2136 - accuracy100: 0.4166 - val_loss: 3.3362 - val_accuracy100: 0.3617 - 6s/epoch - 28ms/step
Epoch 17/50
220/220 - 6s - loss: 3.2085 - accuracy100: 0.4175 - val_loss: 3.3457 - val_accuracy100: 0.3601 - 6s/epoch - 28ms/step
Epoch 18/50
220/220 - 6s - loss: 3.1995 - accuracy100: 0.4271 - val_loss: 3.3476 - val_accuracy100: 0.3587 - 6s/epoch - 28ms/step
Epoch 19/50
220/220 - 6s - loss: 3.1910 - accuracy100: 0.4280 - val_loss: 3.3634 - val_accuracy100: 0.3515 - 6s/epoch - 28ms/step
testing model: results/XRAY/W10/deepVOL_L2/h100
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025158
{'0': {'precision': 0.38987091314349737, 'recall': 0.3566296324563603, 'f1-score': 0.3725101643376951, 'support': 91717}, '1': {'precision': 0.3164216116023345, 'recall': 0.3483050029640046, 'f1-score': 0.3315986691428834, 'support': 72537}, '2': {'precision': 0.3504105207885818, 'recall': 0.3525604850813472, 'f1-score': 0.3514822152129805, 'support': 83285}, 'accuracy': 0.35282117161336196, 'macro avg': {'precision': 0.35223434851147123, 'recall': 0.35249837350057067, 'f1-score': 0.351863682897853, 'support': 247539}, 'weighted avg': {'precision': 0.355071343123539, 'recall': 0.35282117161336196, 'f1-score': 0.3534468657471785, 'support': 247539}}
[[32709 29079 29929]
 [22768 25265 24504]
 [28420 25502 29363]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.087012
{'0': {'precision': 0.38360973247790825, 'recall': 0.34622528132852615, 'f1-score': 0.36396003215803374, 'support': 18306}, '1': {'precision': 0.37944121816269605, 'recall': 0.4520592721725866, 'f1-score': 0.4125792417650715, 'support': 18356}, '2': {'precision': 0.39688933646637575, 'recall': 0.36188338519614344, 'f1-score': 0.37857886170184374, 'support': 19603}, 'accuracy': 0.3862081222785035, 'macro avg': {'precision': 0.3866467623689933, 'recall': 0.3867226462324187, 'f1-score': 0.38503937854164966, 'support': 56265}, 'weighted avg': {'precision': 0.38687646718360263, 'recall': 0.3862081222785035, 'f1-score': 0.3849149264456742, 'support': 56265}}
[[6338 6583 5385]
 [4663 8298 5395]
 [5521 6988 7094]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988942
{'0': {'precision': 0.3780487804878049, 'recall': 0.342790630001455, 'f1-score': 0.3595574208317436, 'support': 6873}, '1': {'precision': 0.36961295635465274, 'recall': 0.41868781094527363, 'f1-score': 0.39262283131651843, 'support': 6432}, '2': {'precision': 0.3546055666615408, 'recall': 0.3433591423466349, 'f1-score': 0.34889174672819423, 'support': 6716}, 'accuracy': 0.36736426751910495, 'macro avg': {'precision': 0.36742243450133283, 'recall': 0.36827919443112117, 'f1-score': 0.36702399962548543, 'support': 20021}, 'weighted avg': {'precision': 0.36747469103764635, 'recall': 0.36736426751910495, 'f1-score': 0.3666023263289033, 'support': 20021}}
[[2356 2318 2199]
 [1741 2693 1998]
 [2135 2275 2306]]
training model: results/XRAY/W10/deepVOL_L2/h200
Epoch 1/50
220/220 - 9s - loss: 3.3660 - accuracy200: 0.3491 - val_loss: 3.3665 - val_accuracy200: 0.3346 - 9s/epoch - 41ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3252 - accuracy200: 0.3520 - val_loss: 3.3385 - val_accuracy200: 0.3443 - 6s/epoch - 29ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3137 - accuracy200: 0.3577 - val_loss: 3.3322 - val_accuracy200: 0.3445 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.2929 - accuracy200: 0.3627 - val_loss: 3.3326 - val_accuracy200: 0.3464 - 6s/epoch - 28ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2785 - accuracy200: 0.3747 - val_loss: 3.3104 - val_accuracy200: 0.3543 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 7s - loss: 3.2764 - accuracy200: 0.3748 - val_loss: 3.3023 - val_accuracy200: 0.3556 - 7s/epoch - 30ms/step
Epoch 7/50
220/220 - 7s - loss: 3.2670 - accuracy200: 0.3817 - val_loss: 3.3023 - val_accuracy200: 0.3594 - 7s/epoch - 30ms/step
Epoch 8/50
220/220 - 7s - loss: 3.2582 - accuracy200: 0.3885 - val_loss: 3.2975 - val_accuracy200: 0.3618 - 7s/epoch - 31ms/step
Epoch 9/50
220/220 - 7s - loss: 3.2489 - accuracy200: 0.3918 - val_loss: 3.2983 - val_accuracy200: 0.3661 - 7s/epoch - 30ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2393 - accuracy200: 0.3984 - val_loss: 3.3030 - val_accuracy200: 0.3635 - 7s/epoch - 30ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2343 - accuracy200: 0.4002 - val_loss: 3.3103 - val_accuracy200: 0.3603 - 6s/epoch - 29ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2231 - accuracy200: 0.4066 - val_loss: 3.3126 - val_accuracy200: 0.3567 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2160 - accuracy200: 0.4119 - val_loss: 3.3162 - val_accuracy200: 0.3612 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 7s - loss: 3.2115 - accuracy200: 0.4144 - val_loss: 3.3225 - val_accuracy200: 0.3599 - 7s/epoch - 31ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2027 - accuracy200: 0.4197 - val_loss: 3.3286 - val_accuracy200: 0.3610 - 7s/epoch - 30ms/step
Epoch 16/50
220/220 - 6s - loss: 3.1962 - accuracy200: 0.4242 - val_loss: 3.3309 - val_accuracy200: 0.3622 - 6s/epoch - 29ms/step
Epoch 17/50
220/220 - 6s - loss: 3.1893 - accuracy200: 0.4274 - val_loss: 3.3355 - val_accuracy200: 0.3615 - 6s/epoch - 29ms/step
Epoch 18/50
220/220 - 6s - loss: 3.1807 - accuracy200: 0.4320 - val_loss: 3.3441 - val_accuracy200: 0.3613 - 6s/epoch - 28ms/step
testing model: results/XRAY/W10/deepVOL_L2/h200
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914603
{'0': {'precision': 0.41031428752730864, 'recall': 0.4671875645101358, 'f1-score': 0.43690787028769723, 'support': 96884}, '1': {'precision': 0.33116794929832505, 'recall': 0.21700953708785098, 'f1-score': 0.2622019515954158, 'support': 67421}, '2': {'precision': 0.3397781742363992, 'recall': 0.37983276065069566, 'f1-score': 0.3586907193101883, 'support': 83234}, 'accuracy': 0.3696750815023087, 'macro avg': {'precision': 0.36042013702067766, 'recall': 0.35467662074956086, 'f1-score': 0.35260018039776714, 'support': 247539}, 'weighted avg': {'precision': 0.3650400958912761, 'recall': 0.3696750815023087, 'f1-score': 0.363023859733343, 'support': 247539}}
[[45263 16076 35545]
 [26904 14631 25886]
 [38146 13473 31615]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0883752
{'0': {'precision': 0.3525966755662734, 'recall': 0.4573535161704742, 'f1-score': 0.3982006079027356, 'support': 17903}, '1': {'precision': 0.42595130866131453, 'recall': 0.35129461161651504, 'f1-score': 0.3850374653371881, 'support': 18577}, '2': {'precision': 0.3776661776323214, 'recall': 0.3382865807429871, 'f1-score': 0.35689337990241826, 'support': 19785}, 'accuracy': 0.3804674309073136, 'macro avg': {'precision': 0.3854047206199698, 'recall': 0.3823115695099921, 'f1-score': 0.38004381771411394, 'support': 56265}, 'weighted avg': {'precision': 0.38563158389975494, 'recall': 0.3804674309073136, 'f1-score': 0.37932928104898184, 'support': 56265}}
[[8188 4153 5562]
 [6584 6526 5467]
 [8450 4642 6693]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958318
{'0': {'precision': 0.37, 'recall': 0.43346832513740235, 'f1-score': 0.3992273877714133, 'support': 6914}, '1': {'precision': 0.39966344131257886, 'recall': 0.29420873335397957, 'f1-score': 0.3389225829468427, 'support': 6458}, '2': {'precision': 0.3453327752197572, 'recall': 0.3722364265303053, 'f1-score': 0.35828025477707004, 'support': 6649}, 'accuracy': 0.368213375955247, 'macro avg': {'precision': 0.3716654055107787, 'recall': 0.3666378283405624, 'f1-score': 0.3654767418317753, 'support': 20021}, 'weighted avg': {'precision': 0.37137626124733036, 'recall': 0.368213375955247, 'f1-score': 0.36617679505194545, 'support': 20021}}
[[2997 1494 2423]
 [2289 1900 2269]
 [2814 1360 2475]]
training model: results/XRAY/W10/deepVOL_L2/h300
Epoch 1/50
220/220 - 9s - loss: 3.3623 - accuracy300: 0.3467 - val_loss: 3.3668 - val_accuracy300: 0.3375 - 9s/epoch - 39ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3282 - accuracy300: 0.3532 - val_loss: 3.3382 - val_accuracy300: 0.3411 - 6s/epoch - 29ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3140 - accuracy300: 0.3509 - val_loss: 3.3401 - val_accuracy300: 0.3423 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.3019 - accuracy300: 0.3577 - val_loss: 3.3042 - val_accuracy300: 0.3519 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2939 - accuracy300: 0.3626 - val_loss: 3.3013 - val_accuracy300: 0.3594 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2846 - accuracy300: 0.3661 - val_loss: 3.2965 - val_accuracy300: 0.3578 - 6s/epoch - 28ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2748 - accuracy300: 0.3741 - val_loss: 3.2928 - val_accuracy300: 0.3656 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2683 - accuracy300: 0.3817 - val_loss: 3.2962 - val_accuracy300: 0.3696 - 6s/epoch - 28ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2607 - accuracy300: 0.3860 - val_loss: 3.2956 - val_accuracy300: 0.3682 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2519 - accuracy300: 0.3923 - val_loss: 3.2983 - val_accuracy300: 0.3671 - 6s/epoch - 28ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2466 - accuracy300: 0.3959 - val_loss: 3.3048 - val_accuracy300: 0.3674 - 6s/epoch - 28ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2402 - accuracy300: 0.4017 - val_loss: 3.3045 - val_accuracy300: 0.3648 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2271 - accuracy300: 0.4079 - val_loss: 3.3136 - val_accuracy300: 0.3644 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2253 - accuracy300: 0.4080 - val_loss: 3.3177 - val_accuracy300: 0.3661 - 6s/epoch - 28ms/step
Epoch 15/50
220/220 - 6s - loss: 3.2159 - accuracy300: 0.4166 - val_loss: 3.3256 - val_accuracy300: 0.3666 - 6s/epoch - 28ms/step
Epoch 16/50
220/220 - 6s - loss: 3.2135 - accuracy300: 0.4141 - val_loss: 3.3335 - val_accuracy300: 0.3631 - 6s/epoch - 28ms/step
Epoch 17/50
220/220 - 6s - loss: 3.2088 - accuracy300: 0.4178 - val_loss: 3.3345 - val_accuracy300: 0.3678 - 6s/epoch - 28ms/step
testing model: results/XRAY/W10/deepVOL_L2/h300
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938239
{'0': {'precision': 0.40868835859692604, 'recall': 0.5590932114909497, 'f1-score': 0.47220342682527555, 'support': 96737}, '1': {'precision': 0.33983098591549293, 'recall': 0.306673251793963, 'f1-score': 0.3224018264142876, 'support': 68842}, '2': {'precision': 0.3108372899238827, 'recall': 0.20129331381161542, 'f1-score': 0.24434965490683966, 'support': 81960}, 'accuracy': 0.37042647825191183, 'macro avg': {'precision': 0.3531188781454339, 'recall': 0.3556865923655093, 'f1-score': 0.34631830271546754, 'support': 247539}, 'weighted avg': {'precision': 0.3571403082348504, 'recall': 0.37042647825191183, 'f1-score': 0.3551005181041115, 'support': 247539}}
[[54085 21764 20888]
 [32040 21112 15690]
 [46213 19249 16498]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910633
{'0': {'precision': 0.3473430497495575, 'recall': 0.5319529357480678, 'f1-score': 0.42026839215328887, 'support': 17338}, '1': {'precision': 0.4187574983047311, 'recall': 0.41419874109998966, 'f1-score': 0.4164656446969107, 'support': 19382}, '2': {'precision': 0.36476615121904943, 'recall': 0.196725505244308, 'f1-score': 0.25560061158013697, 'support': 19545}, 'accuracy': 0.37494001599573445, 'macro avg': {'precision': 0.376955566424446, 'recall': 0.38095906069745517, 'f1-score': 0.3641115494767789, 'support': 56265}, 'weighted avg': {'precision': 0.37799601980407793, 'recall': 0.37494001599573445, 'f1-score': 0.3617571218697773, 'support': 56265}}
[[9223 5067 3048]
 [7706 8028 3648]
 [9624 6076 3845]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969385
{'0': {'precision': 0.35942885278188086, 'recall': 0.5394620159621638, 'f1-score': 0.4314165829442705, 'support': 6766}, '1': {'precision': 0.40083073727933544, 'recall': 0.3398884649251541, 'f1-score': 0.36785260482846255, 'support': 6814}, '2': {'precision': 0.31947162426614484, 'recall': 0.20276354603322466, 'f1-score': 0.24807674043119005, 'support': 6441}, 'accuracy': 0.36321862044852904, 'macro avg': {'precision': 0.35991040477578706, 'recall': 0.3607046756401808, 'f1-score': 0.3491153094013077, 'support': 20021}, 'weighted avg': {'precision': 0.3606649514830346, 'recall': 0.36321862044852904, 'f1-score': 0.35080038632532706, 'support': 20021}}
[[3650 1792 1324]
 [3040 2316 1458]
 [3465 1670 1306]]
training model: results/XRAY/W10/deepVOL_L2/h500
Epoch 1/50
220/220 - 8s - loss: 3.3560 - accuracy500: 0.3530 - val_loss: 3.3741 - val_accuracy500: 0.3381 - 8s/epoch - 38ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3300 - accuracy500: 0.3465 - val_loss: 3.3397 - val_accuracy500: 0.3453 - 6s/epoch - 28ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3125 - accuracy500: 0.3486 - val_loss: 3.3222 - val_accuracy500: 0.3518 - 6s/epoch - 28ms/step
Epoch 4/50
220/220 - 6s - loss: 3.3057 - accuracy500: 0.3456 - val_loss: 3.3123 - val_accuracy500: 0.3504 - 6s/epoch - 28ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2917 - accuracy500: 0.3534 - val_loss: 3.3075 - val_accuracy500: 0.3431 - 6s/epoch - 28ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2826 - accuracy500: 0.3624 - val_loss: 3.3136 - val_accuracy500: 0.3433 - 6s/epoch - 28ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2778 - accuracy500: 0.3682 - val_loss: 3.3062 - val_accuracy500: 0.3505 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2669 - accuracy500: 0.3744 - val_loss: 3.3074 - val_accuracy500: 0.3528 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2655 - accuracy500: 0.3774 - val_loss: 3.3105 - val_accuracy500: 0.3507 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 6s - loss: 3.2612 - accuracy500: 0.3823 - val_loss: 3.3109 - val_accuracy500: 0.3508 - 6s/epoch - 29ms/step
Epoch 11/50
220/220 - 6s - loss: 3.2578 - accuracy500: 0.3869 - val_loss: 3.3089 - val_accuracy500: 0.3545 - 6s/epoch - 28ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2546 - accuracy500: 0.3894 - val_loss: 3.3157 - val_accuracy500: 0.3512 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2497 - accuracy500: 0.3932 - val_loss: 3.3157 - val_accuracy500: 0.3491 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2458 - accuracy500: 0.3922 - val_loss: 3.3168 - val_accuracy500: 0.3526 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 7s - loss: 3.2424 - accuracy500: 0.3973 - val_loss: 3.3210 - val_accuracy500: 0.3504 - 7s/epoch - 30ms/step
Epoch 16/50
220/220 - 6s - loss: 3.2360 - accuracy500: 0.4003 - val_loss: 3.3121 - val_accuracy500: 0.3538 - 6s/epoch - 28ms/step
Epoch 17/50
220/220 - 6s - loss: 3.2308 - accuracy500: 0.4066 - val_loss: 3.3123 - val_accuracy500: 0.3573 - 6s/epoch - 29ms/step
testing model: results/XRAY/W10/deepVOL_L2/h500
Evaluating performance on  test set...
967/967 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0861692
{'0': {'precision': 0.41286858519988656, 'recall': 0.6891632075564714, 'f1-score': 0.5163804535329991, 'support': 101423}, '1': {'precision': 0.32227675483382195, 'recall': 0.1512935100279887, 'f1-score': 0.2059182556720125, 'support': 64669}, '2': {'precision': 0.3157630941441818, 'recall': 0.18564219676599505, 'f1-score': 0.23381865136742158, 'support': 81447}, 'accuracy': 0.3829739960167893, 'macro avg': {'precision': 0.3503028113926301, 'recall': 0.34203297145015177, 'f1-score': 0.3187057868574777, 'support': 247539}, 'weighted avg': {'precision': 0.35725135313561784, 'recall': 0.3829739960167893, 'f1-score': 0.34230246592518, 'support': 247539}}
[[69897 11954 19572]
 [41693  9784 13192]
 [57706  8621 15120]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933803
{'0': {'precision': 0.34553251483287317, 'recall': 0.6584205518553758, 'f1-score': 0.4532198100668426, 'support': 17867}, '1': {'precision': 0.3888733052828425, 'recall': 0.23582444998865956, 'f1-score': 0.29360064946525005, 'support': 17636}, '2': {'precision': 0.38719194724054146, 'recall': 0.21491185820248532, 'f1-score': 0.2764046335873134, 'support': 20762}, 'accuracy': 0.36230338576379634, 'macro avg': {'precision': 0.3738659224520857, 'recall': 0.36971895334884025, 'f1-score': 0.341075031039802, 'support': 56265}, 'weighted avg': {'precision': 0.37448997179588156, 'recall': 0.36230338576379634, 'f1-score': 0.3379424580640403, 'support': 56265}}
[[11764  2879  3224]
 [ 9639  4159  3838]
 [12643  3657  4462]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978289
{'0': {'precision': 0.349119283065513, 'recall': 0.6473284629709211, 'f1-score': 0.45360100376411544, 'support': 6981}, '1': {'precision': 0.3721565059144677, 'recall': 0.19676074406670943, 'f1-score': 0.25742158816741845, 'support': 6236}, '2': {'precision': 0.3380952380952381, 'recall': 0.18783068783068782, 'f1-score': 0.24149659863945577, 'support': 6804}, 'accuracy': 0.3508316267918685, 'macro avg': {'precision': 0.3531236756917396, 'recall': 0.34397329828943946, 'f1-score': 0.3175063968569965, 'support': 20021}, 'weighted avg': {'precision': 0.3525483085741455, 'recall': 0.3508316267918685, 'f1-score': 0.3204141895126202, 'support': 20021}}
[[4519 1166 1296]
 [3803 1227 1206]
 [4622  904 1278]]
training model: results/XRAY/W10/deepVOL_L2/h1000
Epoch 1/50
220/220 - 9s - loss: 3.3724 - accuracy1000: 0.3545 - val_loss: 3.3772 - val_accuracy1000: 0.3327 - 9s/epoch - 39ms/step
Epoch 2/50
220/220 - 6s - loss: 3.3405 - accuracy1000: 0.3515 - val_loss: 3.3387 - val_accuracy1000: 0.3370 - 6s/epoch - 28ms/step
Epoch 3/50
220/220 - 6s - loss: 3.3247 - accuracy1000: 0.3484 - val_loss: 3.3184 - val_accuracy1000: 0.3430 - 6s/epoch - 29ms/step
Epoch 4/50
220/220 - 6s - loss: 3.3097 - accuracy1000: 0.3480 - val_loss: 3.3235 - val_accuracy1000: 0.3396 - 6s/epoch - 29ms/step
Epoch 5/50
220/220 - 6s - loss: 3.2905 - accuracy1000: 0.3531 - val_loss: 3.3070 - val_accuracy1000: 0.3550 - 6s/epoch - 29ms/step
Epoch 6/50
220/220 - 6s - loss: 3.2817 - accuracy1000: 0.3571 - val_loss: 3.3044 - val_accuracy1000: 0.3593 - 6s/epoch - 29ms/step
Epoch 7/50
220/220 - 6s - loss: 3.2786 - accuracy1000: 0.3648 - val_loss: 3.3045 - val_accuracy1000: 0.3550 - 6s/epoch - 29ms/step
Epoch 8/50
220/220 - 6s - loss: 3.2738 - accuracy1000: 0.3684 - val_loss: 3.3049 - val_accuracy1000: 0.3523 - 6s/epoch - 29ms/step
Epoch 9/50
220/220 - 6s - loss: 3.2692 - accuracy1000: 0.3731 - val_loss: 3.3083 - val_accuracy1000: 0.3564 - 6s/epoch - 29ms/step
Epoch 10/50
220/220 - 7s - loss: 3.2604 - accuracy1000: 0.3812 - val_loss: 3.3183 - val_accuracy1000: 0.3540 - 7s/epoch - 30ms/step
Epoch 11/50
220/220 - 7s - loss: 3.2570 - accuracy1000: 0.3830 - val_loss: 3.3186 - val_accuracy1000: 0.3511 - 7s/epoch - 30ms/step
Epoch 12/50
220/220 - 6s - loss: 3.2514 - accuracy1000: 0.3866 - val_loss: 3.3266 - val_accuracy1000: 0.3436 - 6s/epoch - 29ms/step
Epoch 13/50
220/220 - 6s - loss: 3.2493 - accuracy1000: 0.3892 - val_loss: 3.3316 - val_accuracy1000: 0.3554 - 6s/epoch - 29ms/step
Epoch 14/50
220/220 - 6s - loss: 3.2465 - accuracy1000: 0.3921 - val_loss: 3.3249 - val_accuracy1000: 0.3600 - 6s/epoch - 29ms/step
Epoch 15/50
220/220 - 6s - loss: 3.2394 - accuracy1000: 0.3936 - val_loss: 3.3310 - val_accuracy1000: 0.3527 - 6s/epoch - 29ms/step
Epoch 16/50
220/220 - 6s - loss: 3.2294 - accuracy1000: 0.3998 - val_loss: 3.3332 - val_accuracy1000: 0.3539 - 6s/epoch - 29ms/step
testing model: results/XRAY/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
967/967 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0833026
{'0': {'precision': 0.43308021040981914, 'recall': 0.6202224662242803, 'f1-score': 0.5100263810809963, 'support': 104735}, '1': {'precision': 0.3013961718564554, 'recall': 0.22177937977356812, 'f1-score': 0.25552973892680075, 'support': 62977}, '2': {'precision': 0.3219607460208964, 'recall': 0.20652160296641486, 'f1-score': 0.25163318883936747, 'support': 79827}, 'accuracy': 0.3854422939415607, 'macro avg': {'precision': 0.352145709429057, 'recall': 0.34950781632142114, 'f1-score': 0.3390631029490548, 'support': 247539}, 'weighted avg': {'precision': 0.3637440687119464, 'recall': 0.3854422939415607, 'f1-score': 0.3619519831476715, 'support': 247539}}
[[64959 18236 21540]
 [35831 13967 13179]
 [49203 14138 16486]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0929089
{'0': {'precision': 0.3300331195828342, 'recall': 0.5414450867052023, 'f1-score': 0.41009588021540216, 'support': 17300}, '1': {'precision': 0.381333505454076, 'recall': 0.3224890829694323, 'f1-score': 0.34945139443409334, 'support': 18320}, '2': {'precision': 0.39693301049233254, 'recall': 0.23821748607410995, 'f1-score': 0.29774481610413195, 'support': 20645}, 'accuracy': 0.358890962410024, 'macro avg': {'precision': 0.3694332118430809, 'recall': 0.3673838852495815, 'f1-score': 0.3524306969178759, 'support': 56265}, 'weighted avg': {'precision': 0.37128383169494195, 'recall': 0.358890962410024, 'f1-score': 0.34912556655520927, 'support': 56265}}
[[ 9367  4342  3591]
 [ 8531  5908  3881]
 [10484  5243  4918]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955842
{'0': {'precision': 0.3472995668699726, 'recall': 0.5814710670415865, 'f1-score': 0.43486441615938015, 'support': 6757}, '1': {'precision': 0.388272921108742, 'recall': 0.27231942575145807, 'f1-score': 0.3201195394216402, 'support': 6687}, '2': {'precision': 0.3320059731209557, 'recall': 0.2028280370989813, 'f1-score': 0.25181689476168, 'support': 6577}, 'accuracy': 0.3538284800958993, 'macro avg': {'precision': 0.35585948703322345, 'recall': 0.35220617663067527, 'f1-score': 0.3356002834475668, 'support': 20021}, 'weighted avg': {'precision': 0.35596061545432733, 'recall': 0.3538284800958993, 'f1-score': 0.33640766879521544, 'support': 20021}}
[[3929 1509 1319]
 [3501 1821 1365]
 [3883 1360 1334]]
training model: results/XRAY/W10/deepVOL_L3/h10
Epoch 1/50
220/220 - 12s - loss: 3.3365 - accuracy10: 0.3538 - val_loss: 3.3405 - val_accuracy10: 0.3461 - 12s/epoch - 53ms/step
Epoch 2/50
220/220 - 9s - loss: 3.2912 - accuracy10: 0.3687 - val_loss: 3.3283 - val_accuracy10: 0.3522 - 9s/epoch - 40ms/step
Epoch 3/50
220/220 - 9s - loss: 3.2655 - accuracy10: 0.3830 - val_loss: 3.3011 - val_accuracy10: 0.3570 - 9s/epoch - 41ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2481 - accuracy10: 0.3924 - val_loss: 3.3192 - val_accuracy10: 0.3618 - 9s/epoch - 41ms/step
Epoch 5/50
220/220 - 10s - loss: 3.2369 - accuracy10: 0.3996 - val_loss: 3.2989 - val_accuracy10: 0.3733 - 10s/epoch - 43ms/step
Epoch 6/50
220/220 - 10s - loss: 3.2221 - accuracy10: 0.4092 - val_loss: 3.2825 - val_accuracy10: 0.3846 - 10s/epoch - 44ms/step
Epoch 7/50
220/220 - 10s - loss: 3.2045 - accuracy10: 0.4214 - val_loss: 3.2791 - val_accuracy10: 0.3873 - 10s/epoch - 44ms/step
Epoch 8/50
220/220 - 9s - loss: 3.1914 - accuracy10: 0.4284 - val_loss: 3.2585 - val_accuracy10: 0.4049 - 9s/epoch - 43ms/step
Epoch 9/50
220/220 - 10s - loss: 3.1783 - accuracy10: 0.4366 - val_loss: 3.2510 - val_accuracy10: 0.4071 - 10s/epoch - 43ms/step
Epoch 10/50
220/220 - 9s - loss: 3.1618 - accuracy10: 0.4421 - val_loss: 3.2522 - val_accuracy10: 0.4123 - 9s/epoch - 43ms/step
Epoch 11/50
220/220 - 9s - loss: 3.1499 - accuracy10: 0.4472 - val_loss: 3.2371 - val_accuracy10: 0.4263 - 9s/epoch - 43ms/step
Epoch 12/50
220/220 - 9s - loss: 3.1388 - accuracy10: 0.4522 - val_loss: 3.2182 - val_accuracy10: 0.4328 - 9s/epoch - 43ms/step
Epoch 13/50
220/220 - 10s - loss: 3.1287 - accuracy10: 0.4560 - val_loss: 3.2237 - val_accuracy10: 0.4350 - 10s/epoch - 44ms/step
Epoch 14/50
220/220 - 9s - loss: 3.1229 - accuracy10: 0.4558 - val_loss: 3.2232 - val_accuracy10: 0.4334 - 9s/epoch - 43ms/step
Epoch 15/50
220/220 - 9s - loss: 3.1152 - accuracy10: 0.4597 - val_loss: 3.2110 - val_accuracy10: 0.4391 - 9s/epoch - 43ms/step
Epoch 16/50
220/220 - 9s - loss: 3.1078 - accuracy10: 0.4635 - val_loss: 3.2066 - val_accuracy10: 0.4367 - 9s/epoch - 43ms/step
Epoch 17/50
220/220 - 10s - loss: 3.1040 - accuracy10: 0.4642 - val_loss: 3.2054 - val_accuracy10: 0.4409 - 10s/epoch - 44ms/step
Epoch 18/50
220/220 - 10s - loss: 3.0971 - accuracy10: 0.4672 - val_loss: 3.2051 - val_accuracy10: 0.4389 - 10s/epoch - 43ms/step
Epoch 19/50
220/220 - 9s - loss: 3.0928 - accuracy10: 0.4706 - val_loss: 3.2067 - val_accuracy10: 0.4406 - 9s/epoch - 43ms/step
Epoch 20/50
220/220 - 9s - loss: 3.0876 - accuracy10: 0.4705 - val_loss: 3.1991 - val_accuracy10: 0.4388 - 9s/epoch - 43ms/step
Epoch 21/50
220/220 - 9s - loss: 3.0811 - accuracy10: 0.4733 - val_loss: 3.2052 - val_accuracy10: 0.4347 - 9s/epoch - 43ms/step
Epoch 22/50
220/220 - 9s - loss: 3.0753 - accuracy10: 0.4748 - val_loss: 3.2014 - val_accuracy10: 0.4378 - 9s/epoch - 43ms/step
Epoch 23/50
220/220 - 10s - loss: 3.0683 - accuracy10: 0.4779 - val_loss: 3.2101 - val_accuracy10: 0.4322 - 10s/epoch - 43ms/step
Epoch 24/50
220/220 - 9s - loss: 3.0612 - accuracy10: 0.4778 - val_loss: 3.2232 - val_accuracy10: 0.4310 - 9s/epoch - 43ms/step
Epoch 25/50
220/220 - 10s - loss: 3.0562 - accuracy10: 0.4815 - val_loss: 3.2056 - val_accuracy10: 0.4336 - 10s/epoch - 43ms/step
Epoch 26/50
220/220 - 9s - loss: 3.0511 - accuracy10: 0.4828 - val_loss: 3.2062 - val_accuracy10: 0.4334 - 9s/epoch - 43ms/step
Epoch 27/50
220/220 - 9s - loss: 3.0476 - accuracy10: 0.4834 - val_loss: 3.2134 - val_accuracy10: 0.4325 - 9s/epoch - 42ms/step
Epoch 28/50
220/220 - 9s - loss: 3.0393 - accuracy10: 0.4864 - val_loss: 3.2184 - val_accuracy10: 0.4302 - 9s/epoch - 43ms/step
Epoch 29/50
220/220 - 9s - loss: 3.0330 - accuracy10: 0.4893 - val_loss: 3.2233 - val_accuracy10: 0.4307 - 9s/epoch - 43ms/step
Epoch 30/50
220/220 - 9s - loss: 3.0285 - accuracy10: 0.4899 - val_loss: 3.2224 - val_accuracy10: 0.4313 - 9s/epoch - 42ms/step
testing model: results/XRAY/W10/deepVOL_L3/h10
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0672421
{'0': {'precision': 0.4573557567917206, 'recall': 0.4934235501663652, 'f1-score': 0.47470553798063236, 'support': 89562}, '1': {'precision': 0.4294810569882203, 'recall': 0.09733466095213357, 'f1-score': 0.1587021481847486, 'support': 69297}, '2': {'precision': 0.42383273302812685, 'recall': 0.6462110960757781, 'f1-score': 0.5119143861467066, 'support': 88680}, 'accuracy': 0.43727655036176116, 'macro avg': {'precision': 0.4368898489360226, 'recall': 0.4123231023980923, 'f1-score': 0.3817740241040292, 'support': 247539}, 'weighted avg': {'precision': 0.43754289974843186, 'recall': 0.43727655036176116, 'f1-score': 0.39957230141056505, 'support': 247539}}
[[44192  4417 40953]
 [25602  6745 36950]
 [26831  4543 57306]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0383329
{'0': {'precision': 0.45708174462940576, 'recall': 0.5236522480289794, 'f1-score': 0.48810765181985205, 'support': 18772}, '1': {'precision': 0.5344944582673603, 'recall': 0.2558466868774361, 'f1-score': 0.34604964487076223, 'support': 18472}, '2': {'precision': 0.44052166531620174, 'recall': 0.6002313232742758, 'f1-score': 0.5081223018380882, 'support': 19021}, 'accuracy': 0.46161912378921177, 'macro avg': {'precision': 0.4773659560709893, 'recall': 0.45991008606023037, 'f1-score': 0.44742653284290085, 'support': 56265}, 'weighted avg': {'precision': 0.4768982980410088, 'recall': 0.46161912378921177, 'f1-score': 0.44823567374526363, 'support': 56265}}
[[ 9830  1989  6953]
 [ 6199  4726  7547]
 [ 5477  2127 11417]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0655811
{'0': {'precision': 0.45063478368051274, 'recall': 0.519613416714042, 'f1-score': 0.48267212357251305, 'support': 7036}, '1': {'precision': 0.45705705705705707, 'recall': 0.12438705459300425, 'f1-score': 0.1955544134652448, 'support': 6118}, '2': {'precision': 0.42380162061895926, 'recall': 0.6321537789427698, 'f1-score': 0.5074225599064874, 'support': 6867}, 'accuracy': 0.4374406872783577, 'macro avg': {'precision': 0.4438311537855097, 'recall': 0.425384750083272, 'f1-score': 0.39521636564808177, 'support': 20021}, 'weighted avg': {'precision': 0.44339379360878856, 'recall': 0.4374406872783577, 'f1-score': 0.4034240888024783, 'support': 20021}}
[[3656  449 2931]
 [2386  761 2971]
 [2071  455 4341]]
training model: results/XRAY/W10/deepVOL_L3/h20
Epoch 1/50
220/220 - 11s - loss: 3.3482 - accuracy20: 0.3524 - val_loss: 3.3361 - val_accuracy20: 0.3421 - 11s/epoch - 51ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3100 - accuracy20: 0.3597 - val_loss: 3.2985 - val_accuracy20: 0.3548 - 9s/epoch - 41ms/step
Epoch 3/50
220/220 - 9s - loss: 3.2965 - accuracy20: 0.3635 - val_loss: 3.3096 - val_accuracy20: 0.3588 - 9s/epoch - 41ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2832 - accuracy20: 0.3716 - val_loss: 3.2903 - val_accuracy20: 0.3710 - 9s/epoch - 41ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2705 - accuracy20: 0.3841 - val_loss: 3.2998 - val_accuracy20: 0.3700 - 9s/epoch - 41ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2574 - accuracy20: 0.3919 - val_loss: 3.3064 - val_accuracy20: 0.3732 - 9s/epoch - 41ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2442 - accuracy20: 0.4028 - val_loss: 3.3001 - val_accuracy20: 0.3802 - 9s/epoch - 41ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2322 - accuracy20: 0.4081 - val_loss: 3.2866 - val_accuracy20: 0.3880 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2225 - accuracy20: 0.4131 - val_loss: 3.2703 - val_accuracy20: 0.3977 - 9s/epoch - 41ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2145 - accuracy20: 0.4173 - val_loss: 3.2694 - val_accuracy20: 0.4002 - 9s/epoch - 40ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2113 - accuracy20: 0.4199 - val_loss: 3.2665 - val_accuracy20: 0.4048 - 9s/epoch - 41ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2011 - accuracy20: 0.4236 - val_loss: 3.2626 - val_accuracy20: 0.4066 - 9s/epoch - 42ms/step
Epoch 13/50
220/220 - 9s - loss: 3.1929 - accuracy20: 0.4275 - val_loss: 3.2457 - val_accuracy20: 0.4166 - 9s/epoch - 42ms/step
Epoch 14/50
220/220 - 9s - loss: 3.1885 - accuracy20: 0.4318 - val_loss: 3.2586 - val_accuracy20: 0.4060 - 9s/epoch - 41ms/step
Epoch 15/50
220/220 - 9s - loss: 3.1799 - accuracy20: 0.4353 - val_loss: 3.2471 - val_accuracy20: 0.4133 - 9s/epoch - 41ms/step
Epoch 16/50
220/220 - 9s - loss: 3.1764 - accuracy20: 0.4351 - val_loss: 3.2561 - val_accuracy20: 0.4077 - 9s/epoch - 40ms/step
Epoch 17/50
220/220 - 9s - loss: 3.1702 - accuracy20: 0.4380 - val_loss: 3.2524 - val_accuracy20: 0.4107 - 9s/epoch - 41ms/step
Epoch 18/50
220/220 - 9s - loss: 3.1643 - accuracy20: 0.4400 - val_loss: 3.2669 - val_accuracy20: 0.4061 - 9s/epoch - 41ms/step
Epoch 19/50
220/220 - 9s - loss: 3.1568 - accuracy20: 0.4454 - val_loss: 3.2570 - val_accuracy20: 0.4126 - 9s/epoch - 40ms/step
Epoch 20/50
220/220 - 9s - loss: 3.1527 - accuracy20: 0.4454 - val_loss: 3.2747 - val_accuracy20: 0.4111 - 9s/epoch - 41ms/step
Epoch 21/50
220/220 - 9s - loss: 3.1474 - accuracy20: 0.4489 - val_loss: 3.2733 - val_accuracy20: 0.4052 - 9s/epoch - 40ms/step
Epoch 22/50
220/220 - 9s - loss: 3.1436 - accuracy20: 0.4501 - val_loss: 3.2719 - val_accuracy20: 0.4128 - 9s/epoch - 40ms/step
Epoch 23/50
220/220 - 9s - loss: 3.1373 - accuracy20: 0.4530 - val_loss: 3.2732 - val_accuracy20: 0.4091 - 9s/epoch - 41ms/step
testing model: results/XRAY/W10/deepVOL_L3/h20
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0889173
{'0': {'precision': 0.4113941892629984, 'recall': 0.5337882632649795, 'f1-score': 0.4646666666666667, 'support': 87486}, '1': {'precision': 0.40125659713495854, 'recall': 0.10633224998668016, 'f1-score': 0.16811447705088925, 'support': 75076}, '2': {'precision': 0.3974239901866293, 'recall': 0.5337679607423185, 'f1-score': 0.4556143179295555, 'support': 84977}, 'accuracy': 0.40413833779727637, 'macro avg': {'precision': 0.40335825886152876, 'recall': 0.3912961579979927, 'f1-score': 0.3627984872157038, 'support': 247539}, 'weighted avg': {'precision': 0.40352377097126524, 'recall': 0.40413833779727637, 'f1-score': 0.3716179203025478, 'support': 247539}}
[[46699  6075 34712]
 [33033  7983 34060]
 [33782  5837 45358]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735013
{'0': {'precision': 0.41125643140489376, 'recall': 0.5621711585955117, 'f1-score': 0.47501531063578833, 'support': 18626}, '1': {'precision': 0.4578495709237759, 'recall': 0.19581174438687393, 'f1-score': 0.27430818085588987, 'support': 18528}, '2': {'precision': 0.4188811188811189, 'recall': 0.501491287740045, 'f1-score': 0.4564787692600796, 'support': 19111}, 'accuracy': 0.4209188660801564, 'macro avg': {'precision': 0.42932904040326286, 'recall': 0.41982473024081024, 'f1-score': 0.4019340869172526, 'support': 56265}, 'weighted avg': {'precision': 0.4291893042630469, 'recall': 0.4209188660801564, 'f1-score': 0.4026265513219497, 'support': 56265}}
[[10471  2001  6154]
 [ 7758  3628  7142]
 [ 7232  2295  9584]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081258
{'0': {'precision': 0.41181313027371885, 'recall': 0.5780730897009967, 'f1-score': 0.48098071029385253, 'support': 6923}, '1': {'precision': 0.43779342723004694, 'recall': 0.11818757921419519, 'f1-score': 0.18612774451097808, 'support': 6312}, '2': {'precision': 0.41074543551575765, 'recall': 0.520483348069555, 'f1-score': 0.45914852128696787, 'support': 6786}, 'accuracy': 0.41356575595624595, 'macro avg': {'precision': 0.42011733100650783, 'recall': 0.4055813389949156, 'f1-score': 0.3754189920305995, 'support': 20021}, 'weighted avg': {'precision': 0.41964202282458135, 'recall': 0.41356575595624595, 'f1-score': 0.3806228283387942, 'support': 20021}}
[[4002  477 2444]
 [2943  746 2623]
 [2773  481 3532]]
training model: results/XRAY/W10/deepVOL_L3/h30
Epoch 1/50
220/220 - 12s - loss: 3.3493 - accuracy30: 0.3472 - val_loss: 3.3165 - val_accuracy30: 0.3529 - 12s/epoch - 54ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3188 - accuracy30: 0.3531 - val_loss: 3.3112 - val_accuracy30: 0.3485 - 9s/epoch - 42ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3053 - accuracy30: 0.3559 - val_loss: 3.3010 - val_accuracy30: 0.3499 - 9s/epoch - 41ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2904 - accuracy30: 0.3687 - val_loss: 3.2897 - val_accuracy30: 0.3617 - 9s/epoch - 40ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2841 - accuracy30: 0.3674 - val_loss: 3.2820 - val_accuracy30: 0.3695 - 9s/epoch - 40ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2755 - accuracy30: 0.3749 - val_loss: 3.2792 - val_accuracy30: 0.3767 - 9s/epoch - 41ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2649 - accuracy30: 0.3847 - val_loss: 3.2750 - val_accuracy30: 0.3827 - 9s/epoch - 40ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2538 - accuracy30: 0.3946 - val_loss: 3.2739 - val_accuracy30: 0.3822 - 9s/epoch - 39ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2483 - accuracy30: 0.3986 - val_loss: 3.2707 - val_accuracy30: 0.3891 - 9s/epoch - 40ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2403 - accuracy30: 0.4055 - val_loss: 3.2692 - val_accuracy30: 0.3901 - 9s/epoch - 40ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2385 - accuracy30: 0.4055 - val_loss: 3.2634 - val_accuracy30: 0.3943 - 9s/epoch - 40ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2306 - accuracy30: 0.4089 - val_loss: 3.2644 - val_accuracy30: 0.3941 - 9s/epoch - 40ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2232 - accuracy30: 0.4158 - val_loss: 3.2598 - val_accuracy30: 0.3976 - 9s/epoch - 40ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2152 - accuracy30: 0.4198 - val_loss: 3.2669 - val_accuracy30: 0.3936 - 9s/epoch - 39ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2092 - accuracy30: 0.4232 - val_loss: 3.2668 - val_accuracy30: 0.3980 - 9s/epoch - 40ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2092 - accuracy30: 0.4215 - val_loss: 3.2587 - val_accuracy30: 0.4005 - 9s/epoch - 40ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2002 - accuracy30: 0.4269 - val_loss: 3.2590 - val_accuracy30: 0.4037 - 9s/epoch - 40ms/step
Epoch 18/50
220/220 - 9s - loss: 3.1960 - accuracy30: 0.4292 - val_loss: 3.2590 - val_accuracy30: 0.4024 - 9s/epoch - 39ms/step
Epoch 19/50
220/220 - 9s - loss: 3.1881 - accuracy30: 0.4320 - val_loss: 3.2630 - val_accuracy30: 0.4049 - 9s/epoch - 42ms/step
Epoch 20/50
220/220 - 9s - loss: 3.1868 - accuracy30: 0.4331 - val_loss: 3.2808 - val_accuracy30: 0.3961 - 9s/epoch - 42ms/step
Epoch 21/50
220/220 - 9s - loss: 3.1803 - accuracy30: 0.4353 - val_loss: 3.2623 - val_accuracy30: 0.4038 - 9s/epoch - 40ms/step
Epoch 22/50
220/220 - 9s - loss: 3.1719 - accuracy30: 0.4384 - val_loss: 3.2757 - val_accuracy30: 0.4030 - 9s/epoch - 40ms/step
Epoch 23/50
220/220 - 9s - loss: 3.1693 - accuracy30: 0.4411 - val_loss: 3.2773 - val_accuracy30: 0.3998 - 9s/epoch - 40ms/step
Epoch 24/50
220/220 - 9s - loss: 3.1618 - accuracy30: 0.4441 - val_loss: 3.2730 - val_accuracy30: 0.4038 - 9s/epoch - 40ms/step
Epoch 25/50
220/220 - 9s - loss: 3.1534 - accuracy30: 0.4476 - val_loss: 3.2767 - val_accuracy30: 0.4042 - 9s/epoch - 41ms/step
Epoch 26/50
220/220 - 9s - loss: 3.1488 - accuracy30: 0.4483 - val_loss: 3.2827 - val_accuracy30: 0.4021 - 9s/epoch - 41ms/step
testing model: results/XRAY/W10/deepVOL_L3/h30
Evaluating performance on  test set...
967/967 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0943265
{'0': {'precision': 0.4070138375409317, 'recall': 0.4420987413518134, 'f1-score': 0.42383144417495755, 'support': 87157}, '1': {'precision': 0.36563807735930226, 'recall': 0.12226668759154635, 'f1-score': 0.1832544372898964, 'support': 76464}, '2': {'precision': 0.3754202670856245, 'recall': 0.5694964131652327, 'f1-score': 0.4525277201753638, 'support': 83918}, 'accuracy': 0.38649263348401663, 'macro avg': {'precision': 0.3826907273286195, 'recall': 0.3779539473695308, 'f1-score': 0.3532045338800726, 'support': 247539}, 'weighted avg': {'precision': 0.3835224872001911, 'recall': 0.38649263348401663, 'f1-score': 0.3592462831899927, 'support': 247539}}
[[38532  8496 40129]
 [27735  9349 39380]
 [28403  7724 47791]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0729839
{'0': {'precision': 0.41757254939030153, 'recall': 0.4763830475574248, 'f1-score': 0.4450433205722345, 'support': 18546}, '1': {'precision': 0.4243970779545682, 'recall': 0.2286623173559066, 'f1-score': 0.2971969166082691, 'support': 18547}, '2': {'precision': 0.41454965357967666, 'recall': 0.5430315042770707, 'f1-score': 0.4701711601860633, 'support': 19172}, 'accuracy': 0.4174353505731805, 'macro avg': {'precision': 0.41883976030818215, 'recall': 0.41602562306346735, 'f1-score': 0.4041371324555223, 'support': 56265}, 'weighted avg': {'precision': 0.4187921276858699, 'recall': 0.4174353505731805, 'f1-score': 0.4048699212432851, 'support': 56265}}
[[ 8835  2891  6820]
 [ 6423  4241  7883]
 [ 5900  2861 10411]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.085897
{'0': {'precision': 0.41163421247227017, 'recall': 0.4821016166281755, 'f1-score': 0.4440898816646722, 'support': 6928}, '1': {'precision': 0.38644688644688646, 'recall': 0.16643003628332545, 'f1-score': 0.23266071231668323, 'support': 6339}, '2': {'precision': 0.38781736951073337, 'recall': 0.5269469943737045, 'f1-score': 0.4468018329044003, 'support': 6754}, 'accuracy': 0.39728285300434546, 'macro avg': {'precision': 0.39529948947663, 'recall': 0.39182621576173515, 'f1-score': 0.37451747562858523, 'support': 20021}, 'weighted avg': {'precision': 0.39562495134459785, 'recall': 0.39728285300434546, 'f1-score': 0.37806256106011804, 'support': 20021}}
[[3340  840 2748]
 [2414 1055 2870]
 [2360  835 3559]]
training model: results/XRAY/W10/deepVOL_L3/h50
Epoch 1/50
220/220 - 11s - loss: 3.3448 - accuracy50: 0.3535 - val_loss: 3.3269 - val_accuracy50: 0.3492 - 11s/epoch - 52ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3184 - accuracy50: 0.3568 - val_loss: 3.3143 - val_accuracy50: 0.3519 - 9s/epoch - 41ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3047 - accuracy50: 0.3602 - val_loss: 3.3208 - val_accuracy50: 0.3445 - 9s/epoch - 43ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2980 - accuracy50: 0.3600 - val_loss: 3.3130 - val_accuracy50: 0.3424 - 9s/epoch - 42ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2949 - accuracy50: 0.3581 - val_loss: 3.3031 - val_accuracy50: 0.3536 - 9s/epoch - 42ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2881 - accuracy50: 0.3619 - val_loss: 3.2963 - val_accuracy50: 0.3508 - 9s/epoch - 42ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2816 - accuracy50: 0.3695 - val_loss: 3.2988 - val_accuracy50: 0.3566 - 9s/epoch - 41ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2761 - accuracy50: 0.3722 - val_loss: 3.2991 - val_accuracy50: 0.3557 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2736 - accuracy50: 0.3745 - val_loss: 3.2879 - val_accuracy50: 0.3719 - 9s/epoch - 41ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2660 - accuracy50: 0.3806 - val_loss: 3.2801 - val_accuracy50: 0.3740 - 9s/epoch - 42ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2614 - accuracy50: 0.3850 - val_loss: 3.2815 - val_accuracy50: 0.3771 - 9s/epoch - 41ms/step
Epoch 12/50
220/220 - 10s - loss: 3.2560 - accuracy50: 0.3892 - val_loss: 3.2843 - val_accuracy50: 0.3804 - 10s/epoch - 44ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2479 - accuracy50: 0.3972 - val_loss: 3.2839 - val_accuracy50: 0.3771 - 9s/epoch - 41ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2429 - accuracy50: 0.3976 - val_loss: 3.2869 - val_accuracy50: 0.3828 - 9s/epoch - 41ms/step
Epoch 15/50
220/220 - 10s - loss: 3.2384 - accuracy50: 0.4036 - val_loss: 3.2845 - val_accuracy50: 0.3813 - 10s/epoch - 44ms/step
Epoch 16/50
220/220 - 10s - loss: 3.2343 - accuracy50: 0.4031 - val_loss: 3.2833 - val_accuracy50: 0.3783 - 10s/epoch - 44ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2294 - accuracy50: 0.4074 - val_loss: 3.2909 - val_accuracy50: 0.3823 - 9s/epoch - 42ms/step
Epoch 18/50
220/220 - 9s - loss: 3.2224 - accuracy50: 0.4129 - val_loss: 3.2867 - val_accuracy50: 0.3829 - 9s/epoch - 41ms/step
Epoch 19/50
220/220 - 10s - loss: 3.2167 - accuracy50: 0.4152 - val_loss: 3.2884 - val_accuracy50: 0.3863 - 10s/epoch - 44ms/step
Epoch 20/50
220/220 - 9s - loss: 3.2111 - accuracy50: 0.4181 - val_loss: 3.2900 - val_accuracy50: 0.3826 - 9s/epoch - 42ms/step
testing model: results/XRAY/W10/deepVOL_L3/h50
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091527
{'0': {'precision': 0.3901476884591331, 'recall': 0.4491382747773692, 'f1-score': 0.41756985670814906, 'support': 90284}, '1': {'precision': 0.38574527424852806, 'recall': 0.17065613775328342, 'f1-score': 0.23662700072235104, 'support': 72942}, '2': {'precision': 0.35382722259148147, 'recall': 0.4672233226192877, 'f1-score': 0.4026946490362745, 'support': 84313}, 'accuracy': 0.3732381564117169, 'macro avg': {'precision': 0.37657339509971416, 'recall': 0.3623392450499801, 'f1-score': 0.3522971688222582, 'support': 247539}, 'weighted avg': {'precision': 0.37647950552210396, 'recall': 0.3732381564117169, 'f1-score': 0.3591850883049688, 'support': 247539}}
[[40550 10223 39511]
 [28064 12448 32430]
 [35321  9599 39393]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898843
{'0': {'precision': 0.38238620299689, 'recall': 0.4378675875465386, 'f1-score': 0.4082505345239592, 'support': 18533}, '1': {'precision': 0.419012214551248, 'recall': 0.2122908034224829, 'f1-score': 0.2818058432745196, 'support': 18583}, '2': {'precision': 0.364757296706727, 'recall': 0.48817170609431304, 'f1-score': 0.41753578846282685, 'support': 19149}, 'accuracy': 0.3804852039456145, 'macro avg': {'precision': 0.38871857141828836, 'recall': 0.3794433656877782, 'f1-score': 0.3691973887537685, 'support': 56265}, 'weighted avg': {'precision': 0.388483159295909, 'recall': 0.3804852039456145, 'f1-score': 0.36964894615085053, 'support': 56265}}
[[8115 2729 7689]
 [6047 3945 8591]
 [7060 2741 9348]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932271
{'0': {'precision': 0.38683232996029204, 'recall': 0.43761773655991887, 'f1-score': 0.4106608648354637, 'support': 6901}, '1': {'precision': 0.4096296296296296, 'recall': 0.1744479495268139, 'f1-score': 0.24469026548672565, 'support': 6340}, '2': {'precision': 0.3476981290729451, 'recall': 0.487905604719764, 'f1-score': 0.4060390327727998, 'support': 6780}, 'accuracy': 0.37131012436941213, 'macro avg': {'precision': 0.38138669622095556, 'recall': 0.3666570969354989, 'f1-score': 0.35379672103166304, 'support': 20021}, 'weighted avg': {'precision': 0.38079891494043233, 'recall': 0.37131012436941213, 'f1-score': 0.35653821255756246, 'support': 20021}}
[[3020  760 3121]
 [2149 1106 3085]
 [2638  834 3308]]
training model: results/XRAY/W10/deepVOL_L3/h100
Epoch 1/50
220/220 - 11s - loss: 3.3685 - accuracy100: 0.3360 - val_loss: 3.3302 - val_accuracy100: 0.3449 - 11s/epoch - 52ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3211 - accuracy100: 0.3476 - val_loss: 3.3176 - val_accuracy100: 0.3484 - 9s/epoch - 41ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3034 - accuracy100: 0.3542 - val_loss: 3.3123 - val_accuracy100: 0.3506 - 9s/epoch - 40ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2988 - accuracy100: 0.3531 - val_loss: 3.2919 - val_accuracy100: 0.3650 - 9s/epoch - 40ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2908 - accuracy100: 0.3584 - val_loss: 3.2869 - val_accuracy100: 0.3641 - 9s/epoch - 41ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2837 - accuracy100: 0.3651 - val_loss: 3.2829 - val_accuracy100: 0.3640 - 9s/epoch - 40ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2766 - accuracy100: 0.3697 - val_loss: 3.2915 - val_accuracy100: 0.3664 - 9s/epoch - 41ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2734 - accuracy100: 0.3737 - val_loss: 3.2852 - val_accuracy100: 0.3667 - 9s/epoch - 40ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2622 - accuracy100: 0.3815 - val_loss: 3.2880 - val_accuracy100: 0.3654 - 9s/epoch - 40ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2559 - accuracy100: 0.3877 - val_loss: 3.2852 - val_accuracy100: 0.3696 - 9s/epoch - 41ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2514 - accuracy100: 0.3900 - val_loss: 3.2846 - val_accuracy100: 0.3729 - 9s/epoch - 40ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2458 - accuracy100: 0.3938 - val_loss: 3.2878 - val_accuracy100: 0.3694 - 9s/epoch - 40ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2378 - accuracy100: 0.3978 - val_loss: 3.2923 - val_accuracy100: 0.3663 - 9s/epoch - 40ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2315 - accuracy100: 0.4042 - val_loss: 3.2962 - val_accuracy100: 0.3635 - 9s/epoch - 41ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2209 - accuracy100: 0.4107 - val_loss: 3.3009 - val_accuracy100: 0.3675 - 9s/epoch - 42ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2121 - accuracy100: 0.4146 - val_loss: 3.2999 - val_accuracy100: 0.3692 - 9s/epoch - 41ms/step
testing model: results/XRAY/W10/deepVOL_L3/h100
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925137
{'0': {'precision': 0.3818246923352368, 'recall': 0.6626906680331891, 'f1-score': 0.4844958150657633, 'support': 91717}, '1': {'precision': 0.35518727614884965, 'recall': 0.2419868480913189, 'f1-score': 0.287857915969694, 'support': 72537}, '2': {'precision': 0.3533143282738783, 'recall': 0.16517980428648615, 'f1-score': 0.2251149547544632, 'support': 83285}, 'accuracy': 0.37202218640295065, 'macro avg': {'precision': 0.3634420989193216, 'recall': 0.35661910680366465, 'f1-score': 0.33248956192997353, 'support': 247539}, 'weighted avg': {'precision': 0.36442669069201206, 'recall': 0.37202218640295065, 'f1-score': 0.33960527968443666, 'support': 247539}}
[[60780 16711 14226]
 [44030 17553 10954]
 [54373 15155 13757]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091976
{'0': {'precision': 0.35006896551724137, 'recall': 0.6238938053097345, 'f1-score': 0.4484891323555399, 'support': 18306}, '1': {'precision': 0.3990694582917913, 'recall': 0.32708651122248855, 'f1-score': 0.3595101943055597, 'support': 18356}, '2': {'precision': 0.387434554973822, 'recall': 0.1698719583737183, 'f1-score': 0.23618696361444075, 'support': 19603}, 'accuracy': 0.3688794099351284, 'macro avg': {'precision': 0.3788576595942849, 'recall': 0.3736174249686471, 'f1-score': 0.34806209675851346, 'support': 56265}, 'weighted avg': {'precision': 0.379073332272542, 'recall': 0.3688794099351284, 'f1-score': 0.3454933658812272, 'support': 56265}}
[[11421  4224  2661]
 [ 9748  6004  2604]
 [11456  4817  3330]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933697
{'0': {'precision': 0.36857668025253737, 'recall': 0.6710315728211843, 'f1-score': 0.4758072836067265, 'support': 6873}, '1': {'precision': 0.3966189856957087, 'recall': 0.28451492537313433, 'f1-score': 0.3313416621401412, 'support': 6432}, '2': {'precision': 0.35003455425017277, 'recall': 0.1508338296605122, 'f1-score': 0.2108220603537981, 'support': 6716}, 'accuracy': 0.3723590230258229, 'macro avg': {'precision': 0.37174340673280626, 'recall': 0.368793442618277, 'f1-score': 0.3393236687002219, 'support': 20021}, 'weighted avg': {'precision': 0.3713657112888791, 'recall': 0.3723590230258229, 'f1-score': 0.3405071668972843, 'support': 20021}}
[[4612 1307  954]
 [3675 1830  927]
 [4226 1477 1013]]
training model: results/XRAY/W10/deepVOL_L3/h200
Epoch 1/50
220/220 - 12s - loss: 3.3524 - accuracy200: 0.3468 - val_loss: 3.3396 - val_accuracy200: 0.3420 - 12s/epoch - 53ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3271 - accuracy200: 0.3608 - val_loss: 3.3502 - val_accuracy200: 0.3483 - 9s/epoch - 40ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3105 - accuracy200: 0.3573 - val_loss: 3.3193 - val_accuracy200: 0.3498 - 9s/epoch - 40ms/step
Epoch 4/50
220/220 - 9s - loss: 3.2912 - accuracy200: 0.3657 - val_loss: 3.3161 - val_accuracy200: 0.3541 - 9s/epoch - 40ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2849 - accuracy200: 0.3671 - val_loss: 3.3060 - val_accuracy200: 0.3550 - 9s/epoch - 40ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2705 - accuracy200: 0.3763 - val_loss: 3.3027 - val_accuracy200: 0.3605 - 9s/epoch - 40ms/step
Epoch 7/50
220/220 - 10s - loss: 3.2599 - accuracy200: 0.3856 - val_loss: 3.3033 - val_accuracy200: 0.3613 - 10s/epoch - 43ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2571 - accuracy200: 0.3858 - val_loss: 3.2908 - val_accuracy200: 0.3711 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2512 - accuracy200: 0.3901 - val_loss: 3.3024 - val_accuracy200: 0.3613 - 9s/epoch - 41ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2441 - accuracy200: 0.3951 - val_loss: 3.2960 - val_accuracy200: 0.3622 - 9s/epoch - 42ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2368 - accuracy200: 0.4000 - val_loss: 3.2957 - val_accuracy200: 0.3638 - 9s/epoch - 41ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2294 - accuracy200: 0.4023 - val_loss: 3.2953 - val_accuracy200: 0.3677 - 9s/epoch - 40ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2234 - accuracy200: 0.4064 - val_loss: 3.2897 - val_accuracy200: 0.3673 - 9s/epoch - 41ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2201 - accuracy200: 0.4083 - val_loss: 3.2871 - val_accuracy200: 0.3686 - 9s/epoch - 40ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2086 - accuracy200: 0.4139 - val_loss: 3.3075 - val_accuracy200: 0.3630 - 9s/epoch - 40ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2097 - accuracy200: 0.4132 - val_loss: 3.3078 - val_accuracy200: 0.3643 - 9s/epoch - 40ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2018 - accuracy200: 0.4197 - val_loss: 3.3073 - val_accuracy200: 0.3632 - 9s/epoch - 40ms/step
Epoch 18/50
220/220 - 9s - loss: 3.1921 - accuracy200: 0.4231 - val_loss: 3.3197 - val_accuracy200: 0.3569 - 9s/epoch - 40ms/step
Epoch 19/50
220/220 - 9s - loss: 3.1882 - accuracy200: 0.4268 - val_loss: 3.3232 - val_accuracy200: 0.3601 - 9s/epoch - 40ms/step
Epoch 20/50
220/220 - 9s - loss: 3.1820 - accuracy200: 0.4274 - val_loss: 3.3339 - val_accuracy200: 0.3572 - 9s/epoch - 42ms/step
Epoch 21/50
220/220 - 9s - loss: 3.1799 - accuracy200: 0.4293 - val_loss: 3.3311 - val_accuracy200: 0.3560 - 9s/epoch - 43ms/step
Epoch 22/50
220/220 - 9s - loss: 3.1672 - accuracy200: 0.4355 - val_loss: 3.3395 - val_accuracy200: 0.3608 - 9s/epoch - 40ms/step
Epoch 23/50
220/220 - 9s - loss: 3.1611 - accuracy200: 0.4375 - val_loss: 3.3421 - val_accuracy200: 0.3570 - 9s/epoch - 40ms/step
Epoch 24/50
220/220 - 9s - loss: 3.1490 - accuracy200: 0.4398 - val_loss: 3.3589 - val_accuracy200: 0.3570 - 9s/epoch - 40ms/step
testing model: results/XRAY/W10/deepVOL_L3/h200
Evaluating performance on  test set...
967/967 - 21s - 21s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901109
{'0': {'precision': 0.4045405580887453, 'recall': 0.5659241980099913, 'f1-score': 0.47181371494462565, 'support': 96884}, '1': {'precision': 0.3375639778688394, 'recall': 0.3140119547322051, 'f1-score': 0.3253623077041295, 'support': 67421}, '2': {'precision': 0.34868527836390195, 'recall': 0.20647812192133022, 'f1-score': 0.2593682558367667, 'support': 83234}, 'accuracy': 0.3764497715511495, 'macro avg': {'precision': 0.3635966047738289, 'recall': 0.3621380915545089, 'f1-score': 0.3521814261618406, 'support': 247539}, 'weighted avg': {'precision': 0.3675173562190444, 'recall': 0.3764497715511495, 'f1-score': 0.360491516539748, 'support': 247539}}
[[54829 22799 19256]
 [33404 21171 12846]
 [47301 18747 17186]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0805522
{'0': {'precision': 0.3627493030238044, 'recall': 0.5668882310227337, 'f1-score': 0.44240535297835704, 'support': 17903}, '1': {'precision': 0.43103179145637127, 'recall': 0.4459277601334984, 'f1-score': 0.43835326489575616, 'support': 18577}, '2': {'precision': 0.41872518747243054, 'recall': 0.1919130654536265, 'f1-score': 0.2631962014348595, 'support': 19785}, 'accuracy': 0.3950946414289523, 'macro avg': {'precision': 0.40416876065086876, 'recall': 0.4015763522032862, 'f1-score': 0.3813182731029909, 'support': 56265}, 'weighted avg': {'precision': 0.4049774494990175, 'recall': 0.3950946414289523, 'f1-score': 0.3780504484444803, 'support': 56265}}
[[10149  5165  2589]
 [ 7611  8284  2682]
 [10218  5770  3797]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094708
{'0': {'precision': 0.3668192835981686, 'recall': 0.5909748336708128, 'f1-score': 0.4526671467346147, 'support': 6914}, '1': {'precision': 0.40349558353692916, 'recall': 0.3324558686899969, 'f1-score': 0.3645470753035062, 'support': 6458}, '2': {'precision': 0.3459702330805953, 'recall': 0.18529102120619642, 'f1-score': 0.24133202742409404, 'support': 6649}, 'accuracy': 0.37285849857649467, 'macro avg': {'precision': 0.37209503340523103, 'recall': 0.36957390785566874, 'f1-score': 0.35284874982073827, 'support': 20021}, 'weighted avg': {'precision': 0.3717256423271617, 'recall': 0.37285849857649467, 'f1-score': 0.3540583544865876, 'support': 20021}}
[[4086 1632 1196]
 [3178 2147 1133]
 [3875 1542 1232]]
training model: results/XRAY/W10/deepVOL_L3/h300
Epoch 1/50
220/220 - 11s - loss: 3.3584 - accuracy300: 0.3545 - val_loss: 3.4180 - val_accuracy300: 0.3393 - 11s/epoch - 51ms/step
Epoch 2/50
220/220 - 9s - loss: 3.3315 - accuracy300: 0.3360 - val_loss: 3.3402 - val_accuracy300: 0.3369 - 9s/epoch - 41ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3085 - accuracy300: 0.3418 - val_loss: 3.3063 - val_accuracy300: 0.3391 - 9s/epoch - 42ms/step
Epoch 4/50
220/220 - 9s - loss: 3.3015 - accuracy300: 0.3458 - val_loss: 3.2989 - val_accuracy300: 0.3456 - 9s/epoch - 42ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2928 - accuracy300: 0.3572 - val_loss: 3.3084 - val_accuracy300: 0.3429 - 9s/epoch - 42ms/step
Epoch 6/50
220/220 - 10s - loss: 3.2848 - accuracy300: 0.3693 - val_loss: 3.2965 - val_accuracy300: 0.3606 - 10s/epoch - 43ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2769 - accuracy300: 0.3747 - val_loss: 3.2855 - val_accuracy300: 0.3649 - 9s/epoch - 41ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2736 - accuracy300: 0.3775 - val_loss: 3.2926 - val_accuracy300: 0.3637 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2745 - accuracy300: 0.3786 - val_loss: 3.3000 - val_accuracy300: 0.3592 - 9s/epoch - 40ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2622 - accuracy300: 0.3857 - val_loss: 3.3015 - val_accuracy300: 0.3612 - 9s/epoch - 41ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2558 - accuracy300: 0.3887 - val_loss: 3.3126 - val_accuracy300: 0.3634 - 9s/epoch - 40ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2507 - accuracy300: 0.3937 - val_loss: 3.3096 - val_accuracy300: 0.3591 - 9s/epoch - 40ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2435 - accuracy300: 0.3999 - val_loss: 3.3136 - val_accuracy300: 0.3591 - 9s/epoch - 40ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2342 - accuracy300: 0.4045 - val_loss: 3.3154 - val_accuracy300: 0.3623 - 9s/epoch - 40ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2310 - accuracy300: 0.4060 - val_loss: 3.3203 - val_accuracy300: 0.3565 - 9s/epoch - 41ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2175 - accuracy300: 0.4133 - val_loss: 3.3417 - val_accuracy300: 0.3462 - 9s/epoch - 42ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2059 - accuracy300: 0.4222 - val_loss: 3.3355 - val_accuracy300: 0.3430 - 9s/epoch - 40ms/step
testing model: results/XRAY/W10/deepVOL_L3/h300
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0856236
{'0': {'precision': 0.3973626611181668, 'recall': 0.7600607833610717, 'f1-score': 0.5218829408173985, 'support': 96737}, '1': {'precision': 0.3573402621944018, 'recall': 0.2197495714825252, 'f1-score': 0.27214261942667994, 'support': 68842}, '2': {'precision': 0.34052258416381576, 'recall': 0.08379697413372376, 'f1-score': 0.13449656806587745, 'support': 81960}, 'accuracy': 0.385886668363369, 'macro avg': {'precision': 0.3650751691587948, 'recall': 0.35453577632577354, 'f1-score': 0.30950737610331863, 'support': 247539}, 'weighted avg': {'precision': 0.3674124928865409, 'recall': 0.385886668363369, 'f1-score': 0.32416536776468957, 'support': 247539}}
[[73526 14932  8279]
 [48692 15128  5022]
 [62817 12275  6868]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0916082
{'0': {'precision': 0.32703690359771476, 'recall': 0.7329565117083862, 'f1-score': 0.4522741832158872, 'support': 17338}, '1': {'precision': 0.45378027170702895, 'recall': 0.31709833866474046, 'f1-score': 0.37332199477616473, 'support': 19382}, '2': {'precision': 0.38338079213046855, 'recall': 0.07577385520593502, 'f1-score': 0.1265379357484621, 'support': 19545}, 'accuracy': 0.36141473384875145, 'macro avg': {'precision': 0.3880659891450708, 'recall': 0.37527623519302056, 'f1-score': 0.31737803791350466, 'support': 56265}, 'weighted avg': {'precision': 0.39026948623465424, 'recall': 0.36141473384875145, 'f1-score': 0.3119246537910311, 'support': 56265}}
[[12708  3355  1275]
 [12129  6146  1107]
 [14021  4043  1481]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957963
{'0': {'precision': 0.3498233215547703, 'recall': 0.7608631392255395, 'f1-score': 0.47928498277627785, 'support': 6766}, '1': {'precision': 0.4403356936795174, 'recall': 0.24640446140299382, 'f1-score': 0.3159875788086948, 'support': 6814}, '2': {'precision': 0.31501340482573725, 'recall': 0.07297003570874087, 'f1-score': 0.11849237362914408, 'support': 6441}, 'accuracy': 0.36446730932520854, 'macro avg': {'precision': 0.368390806686675, 'recall': 0.3600792121124247, 'f1-score': 0.30458831173803896, 'support': 20021}, 'weighted avg': {'precision': 0.3694297662881165, 'recall': 0.36446730932520854, 'f1-score': 0.3076365283458398, 'support': 20021}}
[[5148 1058  560]
 [4673 1679  462]
 [4895 1076  470]]
training model: results/XRAY/W10/deepVOL_L3/h500
Epoch 1/50
220/220 - 11s - loss: 3.3534 - accuracy500: 0.3518 - val_loss: 3.4305 - val_accuracy500: 0.3468 - 11s/epoch - 51ms/step
Epoch 2/50
220/220 - 10s - loss: 3.3292 - accuracy500: 0.3501 - val_loss: 3.3604 - val_accuracy500: 0.3487 - 10s/epoch - 44ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3115 - accuracy500: 0.3367 - val_loss: 3.3379 - val_accuracy500: 0.3429 - 9s/epoch - 40ms/step
Epoch 4/50
220/220 - 9s - loss: 3.3030 - accuracy500: 0.3436 - val_loss: 3.3194 - val_accuracy500: 0.3486 - 9s/epoch - 40ms/step
Epoch 5/50
220/220 - 9s - loss: 3.2987 - accuracy500: 0.3525 - val_loss: 3.3215 - val_accuracy500: 0.3460 - 9s/epoch - 41ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2916 - accuracy500: 0.3555 - val_loss: 3.3118 - val_accuracy500: 0.3521 - 9s/epoch - 41ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2872 - accuracy500: 0.3616 - val_loss: 3.3133 - val_accuracy500: 0.3530 - 9s/epoch - 40ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2816 - accuracy500: 0.3640 - val_loss: 3.3100 - val_accuracy500: 0.3533 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2763 - accuracy500: 0.3709 - val_loss: 3.3071 - val_accuracy500: 0.3608 - 9s/epoch - 40ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2705 - accuracy500: 0.3764 - val_loss: 3.3231 - val_accuracy500: 0.3527 - 9s/epoch - 41ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2684 - accuracy500: 0.3798 - val_loss: 3.3182 - val_accuracy500: 0.3494 - 9s/epoch - 41ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2610 - accuracy500: 0.3838 - val_loss: 3.3314 - val_accuracy500: 0.3530 - 9s/epoch - 41ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2579 - accuracy500: 0.3884 - val_loss: 3.3394 - val_accuracy500: 0.3558 - 9s/epoch - 43ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2448 - accuracy500: 0.3976 - val_loss: 3.3620 - val_accuracy500: 0.3473 - 9s/epoch - 43ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2402 - accuracy500: 0.4008 - val_loss: 3.3700 - val_accuracy500: 0.3372 - 9s/epoch - 43ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2375 - accuracy500: 0.4006 - val_loss: 3.3766 - val_accuracy500: 0.3475 - 9s/epoch - 42ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2254 - accuracy500: 0.4062 - val_loss: 3.4016 - val_accuracy500: 0.3426 - 9s/epoch - 42ms/step
Epoch 18/50
220/220 - 9s - loss: 3.2107 - accuracy500: 0.4143 - val_loss: 3.4069 - val_accuracy500: 0.3444 - 9s/epoch - 42ms/step
Epoch 19/50
220/220 - 9s - loss: 3.2022 - accuracy500: 0.4181 - val_loss: 3.4143 - val_accuracy500: 0.3400 - 9s/epoch - 40ms/step
testing model: results/XRAY/W10/deepVOL_L3/h500
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0867386
{'0': {'precision': 0.4128891110716916, 'recall': 0.757333149285665, 'f1-score': 0.5344191806746076, 'support': 101423}, '1': {'precision': 0.3240272373540856, 'recall': 0.10301690145200947, 'f1-score': 0.15633176500956247, 'support': 64669}, '2': {'precision': 0.3056953060127973, 'recall': 0.1536827630238069, 'f1-score': 0.20453784121640944, 'support': 81447}, 'accuracy': 0.3877772795397897, 'macro avg': {'precision': 0.34753721814619154, 'recall': 0.3380109379204938, 'f1-score': 0.2984295956335265, 'support': 247539}, 'weighted avg': {'precision': 0.35440449914356864, 'recall': 0.3877772795397897, 'f1-score': 0.32710485631159947, 'support': 247539}}
[[76811  7356 17256]
 [46834  6662 11173]
 [62388  6542 12517]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0913805
{'0': {'precision': 0.33781915156304015, 'recall': 0.7657133262439133, 'f1-score': 0.4688083611753619, 'support': 17867}, '1': {'precision': 0.41808415398388543, 'recall': 0.1853594919482876, 'f1-score': 0.2568454134747594, 'support': 17636}, '2': {'precision': 0.4336940110719678, 'recall': 0.16602446777767074, 'f1-score': 0.2401253918495298, 'support': 20762}, 'accuracy': 0.3625166622234071, 'macro avg': {'precision': 0.39653243887296447, 'recall': 0.3723657619899572, 'f1-score': 0.32192638883321706, 'support': 56265}, 'weighted avg': {'precision': 0.39835602912135143, 'recall': 0.3625166622234071, 'f1-score': 0.31798468118263545, 'support': 56265}}
[[13681  2088  2098]
 [11964  3269  2403]
 [14853  2462  3447]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973109
{'0': {'precision': 0.3555280474298, 'recall': 0.7816931671680275, 'f1-score': 0.48875951634572323, 'support': 6981}, '1': {'precision': 0.41744402985074625, 'recall': 0.14352148813341886, 'f1-score': 0.2136038186157518, 'support': 6236}, '2': {'precision': 0.317246835443038, 'recall': 0.11787184009406232, 'f1-score': 0.1718816973853408, 'support': 6804}, 'accuracy': 0.35732480895060187, 'macro avg': {'precision': 0.36340630424119474, 'recall': 0.3476954984651696, 'f1-score': 0.29141501078227194, 'support': 20021}, 'weighted avg': {'precision': 0.3618035931077927, 'recall': 0.35732480895060187, 'f1-score': 0.29536719771775544, 'support': 20021}}
[[5457  663  861]
 [4476  895  865]
 [5416  586  802]]
training model: results/XRAY/W10/deepVOL_L3/h1000
Epoch 1/50
220/220 - 13s - loss: 3.3649 - accuracy1000: 0.3559 - val_loss: 3.4186 - val_accuracy1000: 0.3374 - 13s/epoch - 57ms/step
Epoch 2/50
220/220 - 10s - loss: 3.3347 - accuracy1000: 0.3555 - val_loss: 3.3639 - val_accuracy1000: 0.3383 - 10s/epoch - 45ms/step
Epoch 3/50
220/220 - 9s - loss: 3.3268 - accuracy1000: 0.3442 - val_loss: 3.3564 - val_accuracy1000: 0.3354 - 9s/epoch - 42ms/step
Epoch 4/50
220/220 - 10s - loss: 3.3114 - accuracy1000: 0.3331 - val_loss: 3.3206 - val_accuracy1000: 0.3354 - 10s/epoch - 44ms/step
Epoch 5/50
220/220 - 9s - loss: 3.3031 - accuracy1000: 0.3381 - val_loss: 3.3143 - val_accuracy1000: 0.3384 - 9s/epoch - 42ms/step
Epoch 6/50
220/220 - 9s - loss: 3.2977 - accuracy1000: 0.3397 - val_loss: 3.3142 - val_accuracy1000: 0.3382 - 9s/epoch - 41ms/step
Epoch 7/50
220/220 - 9s - loss: 3.2949 - accuracy1000: 0.3474 - val_loss: 3.3142 - val_accuracy1000: 0.3399 - 9s/epoch - 41ms/step
Epoch 8/50
220/220 - 9s - loss: 3.2889 - accuracy1000: 0.3532 - val_loss: 3.3094 - val_accuracy1000: 0.3456 - 9s/epoch - 41ms/step
Epoch 9/50
220/220 - 9s - loss: 3.2834 - accuracy1000: 0.3610 - val_loss: 3.3150 - val_accuracy1000: 0.3421 - 9s/epoch - 41ms/step
Epoch 10/50
220/220 - 9s - loss: 3.2773 - accuracy1000: 0.3694 - val_loss: 3.3142 - val_accuracy1000: 0.3471 - 9s/epoch - 41ms/step
Epoch 11/50
220/220 - 9s - loss: 3.2714 - accuracy1000: 0.3748 - val_loss: 3.3108 - val_accuracy1000: 0.3529 - 9s/epoch - 41ms/step
Epoch 12/50
220/220 - 9s - loss: 3.2668 - accuracy1000: 0.3772 - val_loss: 3.3152 - val_accuracy1000: 0.3564 - 9s/epoch - 41ms/step
Epoch 13/50
220/220 - 9s - loss: 3.2572 - accuracy1000: 0.3797 - val_loss: 3.3228 - val_accuracy1000: 0.3581 - 9s/epoch - 40ms/step
Epoch 14/50
220/220 - 9s - loss: 3.2525 - accuracy1000: 0.3852 - val_loss: 3.3320 - val_accuracy1000: 0.3619 - 9s/epoch - 40ms/step
Epoch 15/50
220/220 - 9s - loss: 3.2446 - accuracy1000: 0.3870 - val_loss: 3.3285 - val_accuracy1000: 0.3629 - 9s/epoch - 40ms/step
Epoch 16/50
220/220 - 9s - loss: 3.2353 - accuracy1000: 0.3943 - val_loss: 3.3529 - val_accuracy1000: 0.3565 - 9s/epoch - 40ms/step
Epoch 17/50
220/220 - 9s - loss: 3.2281 - accuracy1000: 0.3968 - val_loss: 3.3334 - val_accuracy1000: 0.3614 - 9s/epoch - 40ms/step
Epoch 18/50
220/220 - 9s - loss: 3.2170 - accuracy1000: 0.4019 - val_loss: 3.3411 - val_accuracy1000: 0.3651 - 9s/epoch - 40ms/step
testing model: results/XRAY/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
967/967 - 18s - 18s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0858587
{'0': {'precision': 0.425217610261626, 'recall': 0.8223039098677615, 'f1-score': 0.5605644436923157, 'support': 104735}, '1': {'precision': 0.3283297731077882, 'recall': 0.090302808962002, 'f1-score': 0.14164736357069915, 'support': 62977}, '2': {'precision': 0.32561332514362107, 'recall': 0.11289413356383178, 'f1-score': 0.16765887780919778, 'support': 79827}, 'accuracy': 0.40730147572705716, 'macro avg': {'precision': 0.35972023617101173, 'recall': 0.3418336174645318, 'f1-score': 0.2899568950240709, 'support': 247539}, 'weighted avg': {'precision': 0.3684474989314832, 'recall': 0.40730147572705716, 'f1-score': 0.3272815526627378, 'support': 247539}}
[[86124  6772 11839]
 [50464  5687  6826]
 [65953  4862  9012]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956256
{'0': {'precision': 0.3134731068648266, 'recall': 0.8193063583815029, 'f1-score': 0.4534519163094248, 'support': 17300}, '1': {'precision': 0.4168572361973211, 'recall': 0.1393013100436681, 'f1-score': 0.2088208820882088, 'support': 18320}, '2': {'precision': 0.40836208646235034, 'recall': 0.09745701138290143, 'f1-score': 0.15735961207570778, 'support': 20645}, 'accuracy': 0.33303119168221806, 'macro avg': {'precision': 0.37956414317483267, 'recall': 0.35202155993602413, 'f1-score': 0.27321080349111376, 'support': 56265}, 'weighted avg': {'precision': 0.38195227212141913, 'recall': 0.33303119168221806, 'f1-score': 0.265156063330881, 'support': 56265}}
[[14174  1594  1532]
 [14385  2552  1383]
 [16657  1976  2012]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978707
{'0': {'precision': 0.33909846932626253, 'recall': 0.8327660204232648, 'f1-score': 0.48194938118281866, 'support': 6757}, '1': {'precision': 0.39010282776349614, 'recall': 0.09077314191715269, 'f1-score': 0.14727647701079705, 'support': 6687}, '2': {'precision': 0.3388562266167825, 'recall': 0.09639653337387867, 'f1-score': 0.150094696969697, 'support': 6577}, 'accuracy': 0.3430398082013885, 'macro avg': {'precision': 0.3560191745688471, 'recall': 0.3399785652380987, 'f1-score': 0.2597735183877709, 'support': 20021}, 'weighted avg': {'precision': 0.3560543114205401, 'recall': 0.3430398082013885, 'f1-score': 0.26115291905465277, 'support': 20021}}
[[5627  502  628]
 [5471  607  609]
 [5496  447  634]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  12.32 (ave)

============================================
